(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}})();const Jf=!1,Xf=(t,e)=>t===e,Xr=Symbol("solid-proxy"),Tm=typeof Proxy=="function",ql=Symbol("solid-track"),ua={equals:Xf};let km=Fm;const lo=1,ha=2,Rm={owned:null,cleanups:null,context:null,owner:null};var Ft=null;let ul=null,Zf=null,Wt=null,$r=null,In=null,Fa=0;function qi(t,e){const r=Wt,n=Ft,o=t.length===0,i=e===void 0?n:e,a=o?Rm:{owned:null,cleanups:null,context:i?i.context:null,owner:i},c=o?t:()=>t(()=>Br(()=>Ji(a)));Ft=a,Wt=null;try{return co(c,!0)}finally{Wt=r,Ft=n}}function fe(t,e){e=e?Object.assign({},ua,e):ua;const r={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},n=o=>(typeof o=="function"&&(o=o(r.value)),Vm(r,o));return[Om.bind(r),n]}function le(t,e,r){const n=Tc(t,e,!1,lo);us(n)}function Nn(t,e,r){km=ng;const n=Tc(t,e,!1,lo);n.user=!0,In?In.push(n):us(n)}function ze(t,e,r){r=r?Object.assign({},ua,r):ua;const n=Tc(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,us(n),Om.bind(n)}function Dm(t){return co(t,!1)}function Br(t){if(Wt===null)return t();const e=Wt;Wt=null;try{return t()}finally{Wt=e}}function Ic(t,e,r){const n=Array.isArray(t);let o,i=r&&r.defer;return a=>{let c;if(n){c=Array(t.length);for(let h=0;h<t.length;h++)c[h]=t[h]()}else c=t();if(i)return i=!1,a;const u=Br(()=>e(c,o,a));return o=c,u}}function Hr(t){Nn(()=>Br(t))}function yi(t){return Ft===null||(Ft.cleanups===null?Ft.cleanups=[t]:Ft.cleanups.push(t)),t}function Gl(){return Wt}function Nm(){return Ft}function Lm(t,e){const r=Ft,n=Wt;Ft=t,Wt=null;try{return co(e,!0)}catch(o){kc(o)}finally{Ft=r,Wt=n}}function eg(t){const e=Wt,r=Ft;return Promise.resolve().then(()=>{Wt=e,Ft=r;let n;return co(t,!1),Wt=Ft=null,n?n.done:void 0})}const[OE,VE]=fe(!1);function Mm(t,e){const r=Symbol("context");return{id:r,Provider:ig(r),defaultValue:t}}function $c(t){let e;return Ft&&Ft.context&&(e=Ft.context[t.id])!==void 0?e:t.defaultValue}function Ec(t){const e=ze(t),r=ze(()=>Hl(e()));return r.toArray=()=>{const n=r();return Array.isArray(n)?n:n!=null?[n]:[]},r}function Om(){if(this.sources&&this.state)if(this.state===lo)us(this);else{const t=$r;$r=null,co(()=>ya(this),!1),$r=t}if(Wt){const t=this.observers?this.observers.length:0;Wt.sources?(Wt.sources.push(this),Wt.sourceSlots.push(t)):(Wt.sources=[this],Wt.sourceSlots=[t]),this.observers?(this.observers.push(Wt),this.observerSlots.push(Wt.sources.length-1)):(this.observers=[Wt],this.observerSlots=[Wt.sources.length-1])}return this.value}function Vm(t,e,r){let n=t.value;return(!t.comparator||!t.comparator(n,e))&&(t.value=e,t.observers&&t.observers.length&&co(()=>{for(let o=0;o<t.observers.length;o+=1){const i=t.observers[o],a=ul&&ul.running;a&&ul.disposed.has(i),(a?!i.tState:!i.state)&&(i.pure?$r.push(i):In.push(i),i.observers&&Bm(i)),a||(i.state=lo)}if($r.length>1e6)throw $r=[],new Error},!1)),e}function us(t){if(!t.fn)return;Ji(t);const e=Fa;tg(t,t.value,e)}function tg(t,e,r){let n;const o=Ft,i=Wt;Wt=Ft=t;try{n=t.fn(e)}catch(a){return t.pure&&(t.state=lo,t.owned&&t.owned.forEach(Ji),t.owned=null),t.updatedAt=r+1,kc(a)}finally{Wt=i,Ft=o}(!t.updatedAt||t.updatedAt<=r)&&(t.updatedAt!=null&&"observers"in t?Vm(t,n):t.value=n,t.updatedAt=r)}function Tc(t,e,r,n=lo,o){const i={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:Ft,context:Ft?Ft.context:null,pure:r};return Ft===null||Ft!==Rm&&(Ft.owned?Ft.owned.push(i):Ft.owned=[i]),i}function ma(t){if(t.state===0)return;if(t.state===ha)return ya(t);if(t.suspense&&Br(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<Fa);)t.state&&e.push(t);for(let r=e.length-1;r>=0;r--)if(t=e[r],t.state===lo)us(t);else if(t.state===ha){const n=$r;$r=null,co(()=>ya(t,e[0]),!1),$r=n}}function co(t,e){if($r)return t();let r=!1;e||($r=[]),In?r=!0:In=[],Fa++;try{const n=t();return rg(r),n}catch(n){r||(In=null),$r=null,kc(n)}}function rg(t){if($r&&(Fm($r),$r=null),t)return;const e=In;In=null,e.length&&co(()=>km(e),!1)}function Fm(t){for(let e=0;e<t.length;e++)ma(t[e])}function ng(t){let e,r=0;for(e=0;e<t.length;e++){const n=t[e];n.user?t[r++]=n:ma(n)}for(e=0;e<r;e++)ma(t[e])}function ya(t,e){t.state=0;for(let r=0;r<t.sources.length;r+=1){const n=t.sources[r];if(n.sources){const o=n.state;o===lo?n!==e&&(!n.updatedAt||n.updatedAt<Fa)&&ma(n):o===ha&&ya(n,e)}}}function Bm(t){for(let e=0;e<t.observers.length;e+=1){const r=t.observers[e];r.state||(r.state=ha,r.pure?$r.push(r):In.push(r),r.observers&&Bm(r))}}function Ji(t){let e;if(t.sources)for(;t.sources.length;){const r=t.sources.pop(),n=t.sourceSlots.pop(),o=r.observers;if(o&&o.length){const i=o.pop(),a=r.observerSlots.pop();n<o.length&&(i.sourceSlots[a]=n,o[n]=i,r.observerSlots[n]=a)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)Ji(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)Ji(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function og(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function kc(t,e=Ft){throw og(t)}function Hl(t){if(typeof t=="function"&&!t.length)return Hl(t());if(Array.isArray(t)){const e=[];for(let r=0;r<t.length;r++){const n=Hl(t[r]);Array.isArray(n)?e.push.apply(e,n):e.push(n)}return e}return t}function ig(t,e){return function(n){let o;return le(()=>o=Br(()=>(Ft.context={...Ft.context,[t]:n.value},Ec(()=>n.children))),void 0),o}}const sg=Symbol("fallback");function su(t){for(let e=0;e<t.length;e++)t[e]()}function ag(t,e,r={}){let n=[],o=[],i=[],a=0,c=e.length>1?[]:null;return yi(()=>su(i)),()=>{let u=t()||[],h=u.length,y,b;return u[ql],Br(()=>{let A,E,R,P,k,K,oe,O,M;if(h===0)a!==0&&(su(i),i=[],n=[],o=[],a=0,c&&(c=[])),r.fallback&&(n=[sg],o[0]=qi(N=>(i[0]=N,r.fallback())),a=1);else if(a===0){for(o=new Array(h),b=0;b<h;b++)n[b]=u[b],o[b]=qi(_);a=h}else{for(R=new Array(h),P=new Array(h),c&&(k=new Array(h)),K=0,oe=Math.min(a,h);K<oe&&n[K]===u[K];K++);for(oe=a-1,O=h-1;oe>=K&&O>=K&&n[oe]===u[O];oe--,O--)R[O]=o[oe],P[O]=i[oe],c&&(k[O]=c[oe]);for(A=new Map,E=new Array(O+1),b=O;b>=K;b--)M=u[b],y=A.get(M),E[b]=y===void 0?-1:y,A.set(M,b);for(y=K;y<=oe;y++)M=n[y],b=A.get(M),b!==void 0&&b!==-1?(R[b]=o[y],P[b]=i[y],c&&(k[b]=c[y]),b=E[b],A.set(M,b)):i[y]();for(b=K;b<h;b++)b in R?(o[b]=R[b],i[b]=P[b],c&&(c[b]=k[b],c[b](b))):o[b]=qi(_);o=o.slice(0,a=h),n=u.slice(0)}return o});function _(A){if(i[b]=A,c){const[E,R]=fe(b);return c[b]=R,e(u[b],E)}return e(u[b])}}}function w(t,e){return Br(()=>t(e||{}))}function Ls(){return!0}const Wl={get(t,e,r){return e===Xr?r:t.get(e)},has(t,e){return e===Xr?!0:t.has(e)},set:Ls,deleteProperty:Ls,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:Ls,deleteProperty:Ls}},ownKeys(t){return t.keys()}};function hl(t){return(t=typeof t=="function"?t():t)?t:{}}function lg(){for(let t=0,e=this.length;t<e;++t){const r=this[t]();if(r!==void 0)return r}}function Yl(...t){let e=!1;for(let a=0;a<t.length;a++){const c=t[a];e=e||!!c&&Xr in c,t[a]=typeof c=="function"?(e=!0,ze(c)):c}if(Tm&&e)return new Proxy({get(a){for(let c=t.length-1;c>=0;c--){const u=hl(t[c])[a];if(u!==void 0)return u}},has(a){for(let c=t.length-1;c>=0;c--)if(a in hl(t[c]))return!0;return!1},keys(){const a=[];for(let c=0;c<t.length;c++)a.push(...Object.keys(hl(t[c])));return[...new Set(a)]}},Wl);const r={},n=Object.create(null);for(let a=t.length-1;a>=0;a--){const c=t[a];if(!c)continue;const u=Object.getOwnPropertyNames(c);for(let h=u.length-1;h>=0;h--){const y=u[h];if(y==="__proto__"||y==="constructor")continue;const b=Object.getOwnPropertyDescriptor(c,y);if(!n[y])n[y]=b.get?{enumerable:!0,configurable:!0,get:lg.bind(r[y]=[b.get.bind(c)])}:b.value!==void 0?b:void 0;else{const _=r[y];_&&(b.get?_.push(b.get.bind(c)):b.value!==void 0&&_.push(()=>b.value))}}}const o={},i=Object.keys(n);for(let a=i.length-1;a>=0;a--){const c=i[a],u=n[c];u&&u.get?Object.defineProperty(o,c,u):o[c]=u?u.value:void 0}return o}function cg(t,...e){if(Tm&&Xr in t){const o=new Set(e.length>1?e.flat():e[0]),i=e.map(a=>new Proxy({get(c){return a.includes(c)?t[c]:void 0},has(c){return a.includes(c)&&c in t},keys(){return a.filter(c=>c in t)}},Wl));return i.push(new Proxy({get(a){return o.has(a)?void 0:t[a]},has(a){return o.has(a)?!1:a in t},keys(){return Object.keys(t).filter(a=>!o.has(a))}},Wl)),i}const r={},n=e.map(()=>({}));for(const o of Object.getOwnPropertyNames(t)){const i=Object.getOwnPropertyDescriptor(t,o),a=!i.get&&!i.set&&i.enumerable&&i.writable&&i.configurable;let c=!1,u=0;for(const h of e)h.includes(o)&&(c=!0,a?n[u][o]=i.value:Object.defineProperty(n[u],o,i)),++u;c||(a?r[o]=i.value:Object.defineProperty(r,o,i))}return[...n,r]}const dg=t=>`Stale read from <${t}>.`;function nt(t){const e="fallback"in t&&{fallback:()=>t.fallback};return ze(ag(()=>t.each,t.children,e||void 0))}function Re(t){const e=t.keyed,r=ze(()=>t.when,void 0,void 0),n=e?r:ze(r,void 0,{equals:(o,i)=>!o==!i});return ze(()=>{const o=n();if(o){const i=t.children;return typeof i=="function"&&i.length>0?Br(()=>i(e?o:()=>{if(!Br(n))throw dg("Show");return r()})):i}return t.fallback},void 0,void 0)}const ug=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],hg=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline",...ug]),mg=new Set(["innerHTML","textContent","innerText","children"]),yg=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),pg=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function fg(t,e){const r=pg[t];return typeof r=="object"?r[e]?r.$:void 0:r}const gg=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),ge=t=>ze(()=>t());function vg(t,e,r){let n=r.length,o=e.length,i=n,a=0,c=0,u=e[o-1].nextSibling,h=null;for(;a<o||c<i;){if(e[a]===r[c]){a++,c++;continue}for(;e[o-1]===r[i-1];)o--,i--;if(o===a){const y=i<n?c?r[c-1].nextSibling:r[i-c]:u;for(;c<i;)t.insertBefore(r[c++],y)}else if(i===c)for(;a<o;)(!h||!h.has(e[a]))&&e[a].remove(),a++;else if(e[a]===r[i-1]&&r[c]===e[o-1]){const y=e[--o].nextSibling;t.insertBefore(r[c++],e[a++].nextSibling),t.insertBefore(r[--i],y),e[o]=r[i]}else{if(!h){h=new Map;let b=c;for(;b<i;)h.set(r[b],b++)}const y=h.get(e[a]);if(y!=null)if(c<y&&y<i){let b=a,_=1,A;for(;++b<o&&b<i&&!((A=h.get(e[b]))==null||A!==y+_);)_++;if(_>y-c){const E=e[a];for(;c<y;)t.insertBefore(r[c++],E)}else t.replaceChild(r[c++],e[a++])}else a++;else e[a++].remove()}}}const au="_$DX_DELEGATE";function bg(t,e,r,n={}){let o;return qi(i=>{o=i,e===document?t():s(e,t(),e.firstChild?null:void 0,r)},n.owner),()=>{o(),e.textContent=""}}function z(t,e,r,n){let o;const i=()=>{const c=n?document.createElementNS("http://www.w3.org/1998/Math/MathML","template"):document.createElement("template");return c.innerHTML=t,r?c.content.firstChild.firstChild:n?c.firstChild:c.content.firstChild},a=e?()=>Br(()=>document.importNode(o||(o=i()),!0)):()=>(o||(o=i())).cloneNode(!0);return a.cloneNode=a,a}function ft(t,e=window.document){const r=e[au]||(e[au]=new Set);for(let n=0,o=t.length;n<o;n++){const i=t[n];r.has(i)||(r.add(i),e.addEventListener(i,xg))}}function ct(t,e,r){r==null?t.removeAttribute(e):t.setAttribute(e,r)}function _g(t,e,r){r?t.setAttribute(e,""):t.removeAttribute(e)}function Rc(t,e){e==null?t.removeAttribute("class"):t.className=e}function Ln(t,e,r,n){if(n)Array.isArray(r)?(t[`$$${e}`]=r[0],t[`$$${e}Data`]=r[1]):t[`$$${e}`]=r;else if(Array.isArray(r)){const o=r[0];t.addEventListener(e,r[0]=i=>o.call(t,r[1],i))}else t.addEventListener(e,r,typeof r!="function"&&r)}function Pg(t,e,r={}){const n=Object.keys(e||{}),o=Object.keys(r);let i,a;for(i=0,a=o.length;i<a;i++){const c=o[i];!c||c==="undefined"||e[c]||(lu(t,c,!1),delete r[c])}for(i=0,a=n.length;i<a;i++){const c=n[i],u=!!e[c];!c||c==="undefined"||r[c]===u||!u||(lu(t,c,!0),r[c]=u)}return r}function d(t,e,r){if(!e)return r?ct(t,"style"):e;const n=t.style;if(typeof e=="string")return n.cssText=e;typeof r=="string"&&(n.cssText=r=void 0),r||(r={}),e||(e={});let o,i;for(i in r)e[i]==null&&n.removeProperty(i),delete r[i];for(i in e)o=e[i],o!==r[i]&&(n.setProperty(i,o),r[i]=o);return r}function Sg(t,e={},r,n){const o={};return le(()=>o.children=Xi(t,e.children,o.children)),le(()=>typeof e.ref=="function"&&wg(e.ref,t)),le(()=>Cg(t,e,r,!0,o,!0)),o}function wg(t,e,r){return Br(()=>t(e,r))}function s(t,e,r,n){if(r!==void 0&&!n&&(n=[]),typeof e!="function")return Xi(t,e,n,r);le(o=>Xi(t,e(),o,r),n)}function Cg(t,e,r,n,o={},i=!1){e||(e={});for(const a in o)if(!(a in e)){if(a==="children")continue;o[a]=cu(t,a,null,o[a],r,i,e)}for(const a in e){if(a==="children")continue;const c=e[a];o[a]=cu(t,a,c,o[a],r,i,e)}}function Ag(t){return t.toLowerCase().replace(/-([a-z])/g,(e,r)=>r.toUpperCase())}function lu(t,e,r){const n=e.trim().split(/\s+/);for(let o=0,i=n.length;o<i;o++)t.classList.toggle(n[o],r)}function cu(t,e,r,n,o,i,a){let c,u,h,y,b;if(e==="style")return d(t,r,n);if(e==="classList")return Pg(t,r,n);if(r===n)return n;if(e==="ref")i||r(t);else if(e.slice(0,3)==="on:"){const _=e.slice(3);n&&t.removeEventListener(_,n,typeof n!="function"&&n),r&&t.addEventListener(_,r,typeof r!="function"&&r)}else if(e.slice(0,10)==="oncapture:"){const _=e.slice(10);n&&t.removeEventListener(_,n,!0),r&&t.addEventListener(_,r,!0)}else if(e.slice(0,2)==="on"){const _=e.slice(2).toLowerCase(),A=gg.has(_);if(!A&&n){const E=Array.isArray(n)?n[0]:n;t.removeEventListener(_,E)}(A||r)&&(Ln(t,_,r,A),A&&ft([_]))}else e.slice(0,5)==="attr:"?ct(t,e.slice(5),r):e.slice(0,5)==="bool:"?_g(t,e.slice(5),r):(b=e.slice(0,5)==="prop:")||(h=mg.has(e))||(y=fg(e,t.tagName))||(u=hg.has(e))||(c=t.nodeName.includes("-")||"is"in a)?(b&&(e=e.slice(5),u=!0),e==="class"||e==="className"?Rc(t,r):c&&!u&&!h?t[Ag(e)]=r:t[y||e]=r):ct(t,yg[e]||e,r);return r}function xg(t){let e=t.target;const r=`$$${t.type}`,n=t.target,o=t.currentTarget,i=u=>Object.defineProperty(t,"target",{configurable:!0,value:u}),a=()=>{const u=e[r];if(u&&!e.disabled){const h=e[`${r}Data`];if(h!==void 0?u.call(e,h,t):u.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&i(e.host),!0},c=()=>{for(;a()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const u=t.composedPath();i(u[0]);for(let h=0;h<u.length-2&&(e=u[h],!!a());h++){if(e._$host){e=e._$host,c();break}if(e.parentNode===o)break}}else c();i(n)}function Xi(t,e,r,n,o){for(;typeof r=="function";)r=r();if(e===r)return r;const i=typeof e,a=n!==void 0;if(t=a&&r[0]&&r[0].parentNode||t,i==="string"||i==="number"){if(i==="number"&&(e=e.toString(),e===r))return r;if(a){let c=r[0];c&&c.nodeType===3?c.data!==e&&(c.data=e):c=document.createTextNode(e),r=zo(t,r,n,c)}else r!==""&&typeof r=="string"?r=t.firstChild.data=e:r=t.textContent=e}else if(e==null||i==="boolean")r=zo(t,r,n);else{if(i==="function")return le(()=>{let c=e();for(;typeof c=="function";)c=c();r=Xi(t,c,r,n)}),()=>r;if(Array.isArray(e)){const c=[],u=r&&Array.isArray(r);if(Kl(c,e,r,o))return le(()=>r=Xi(t,c,r,n,!0)),()=>r;if(c.length===0){if(r=zo(t,r,n),a)return r}else u?r.length===0?du(t,c,n):vg(t,r,c):(r&&zo(t),du(t,c));r=c}else if(e.nodeType){if(Array.isArray(r)){if(a)return r=zo(t,r,n,e);zo(t,r,null,e)}else r==null||r===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);r=e}}return r}function Kl(t,e,r,n){let o=!1;for(let i=0,a=e.length;i<a;i++){let c=e[i],u=r&&r[t.length],h;if(!(c==null||c===!0||c===!1))if((h=typeof c)=="object"&&c.nodeType)t.push(c);else if(Array.isArray(c))o=Kl(t,c,u)||o;else if(h==="function")if(n){for(;typeof c=="function";)c=c();o=Kl(t,Array.isArray(c)?c:[c],Array.isArray(u)?u:[u])||o}else t.push(c),o=!0;else{const y=String(c);u&&u.nodeType===3&&u.data===y?t.push(u):t.push(document.createTextNode(y))}}return o}function du(t,e,r=null){for(let n=0,o=e.length;n<o;n++)t.insertBefore(e[n],r)}function zo(t,e,r,n){if(r===void 0)return t.textContent="";const o=n||document.createTextNode("");if(e.length){let i=!1;for(let a=e.length-1;a>=0;a--){const c=e[a];if(o!==c){const u=c.parentNode===t;!i&&!a?u?t.replaceChild(o,c):t.insertBefore(o,r):u&&c.remove()}else i=!0}}else t.insertBefore(o,r);return[o]}const Ig=!1;function Um(){let t=new Set;function e(o){return t.add(o),()=>t.delete(o)}let r=!1;function n(o,i){if(r)return!(r=!1);const a={to:o,options:i,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const c of t)c.listener({...a,from:c.location,retry:u=>{u&&(r=!0),c.navigate(o,{...i,resolve:!1})}});return!a.defaultPrevented}return{subscribe:e,confirm:n}}let Ql;function Dc(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Ql=window.history.state._depth}Dc();function $g(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function Eg(t,e){let r=!1;return()=>{const n=Ql;Dc();const o=n==null?null:Ql-n;if(r){r=!1;return}o&&e(o)?(r=!0,window.history.go(-o)):t()}}const Tg=/^(?:[a-z0-9]+:)?\/\//i,kg=/^\/+|(\/)\/+$/g,jm="http://sr";function Io(t,e=!1){const r=t.replace(kg,"$1");return r?e||/^[?#]/.test(r)?r:"/"+r:""}function ea(t,e,r){if(Tg.test(e))return;const n=Io(t),o=r&&Io(r);let i="";return!o||e.startsWith("/")?i=n:o.toLowerCase().indexOf(n.toLowerCase())!==0?i=n+o:i=o,(i||"/")+Io(e,!i)}function Rg(t,e){if(t==null)throw new Error(e);return t}function Dg(t,e){return Io(t).replace(/\/*(\*.*)?$/g,"")+Io(e)}function zm(t){const e={};return t.searchParams.forEach((r,n)=>{n in e?Array.isArray(e[n])?e[n].push(r):e[n]=[e[n],r]:e[n]=r}),e}function Ng(t,e,r){const[n,o]=t.split("/*",2),i=n.split("/").filter(Boolean),a=i.length;return c=>{const u=c.split("/").filter(Boolean),h=u.length-a;if(h<0||h>0&&o===void 0&&!e)return null;const y={path:a?"":"/",params:{}},b=_=>r===void 0?void 0:r[_];for(let _=0;_<a;_++){const A=i[_],E=A[0]===":",R=E?u[_]:u[_].toLowerCase(),P=E?A.slice(1):A.toLowerCase();if(E&&ml(R,b(P)))y.params[P]=R;else if(E||!ml(R,P))return null;y.path+=`/${R}`}if(o){const _=h?u.slice(-h).join("/"):"";if(ml(_,b(o)))y.params[o]=_;else return null}return y}}function ml(t,e){const r=n=>n===t;return e===void 0?!0:typeof e=="string"?r(e):typeof e=="function"?e(t):Array.isArray(e)?e.some(r):e instanceof RegExp?e.test(t):!1}function Lg(t){const[e,r]=t.pattern.split("/*",2),n=e.split("/").filter(Boolean);return n.reduce((o,i)=>o+(i.startsWith(":")?2:3),n.length-(r===void 0?0:1))}function qm(t){const e=new Map,r=Nm();return new Proxy({},{get(n,o){return e.has(o)||Lm(r,()=>e.set(o,ze(()=>t()[o]))),e.get(o)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function Gm(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let r=t.slice(0,e.index),n=t.slice(e.index+e[0].length);const o=[r,r+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(n);)o.push(r+=e[1]),n=n.slice(e[0].length);return Gm(n).reduce((i,a)=>[...i,...o.map(c=>c+a)],[])}const Mg=100,Hm=Mm(),Nc=Mm(),hs=()=>Rg($c(Hm),"<A> and 'use' router primitives can be only used inside a Route."),Og=()=>$c(Nc)||hs().base,Vg=t=>{const e=Og();return ze(()=>e.resolvePath(t()))},Fg=t=>{const e=hs();return ze(()=>{const r=t();return r!==void 0?e.renderPath(r):r})},Lc=()=>hs().navigatorFactory(),Bg=()=>hs().location,Ug=()=>hs().params;function jg(t,e=""){const{component:r,preload:n,load:o,children:i,info:a}=t,c=!i||Array.isArray(i)&&!i.length,u={key:t,component:r,preload:n||o,info:a};return Wm(t.path).reduce((h,y)=>{for(const b of Gm(y)){const _=Dg(e,b);let A=c?_:_.split("/*",1)[0];A=A.split("/").map(E=>E.startsWith(":")||E.startsWith("*")?E:encodeURIComponent(E)).join("/"),h.push({...u,originalPath:y,pattern:A,matcher:Ng(A,!c,t.matchFilters)})}return h},[])}function zg(t,e=0){return{routes:t,score:Lg(t[t.length-1])*1e4-e,matcher(r){const n=[];for(let o=t.length-1;o>=0;o--){const i=t[o],a=i.matcher(r);if(!a)return null;n.unshift({...a,route:i})}return n}}}function Wm(t){return Array.isArray(t)?t:[t]}function Ym(t,e="",r=[],n=[]){const o=Wm(t);for(let i=0,a=o.length;i<a;i++){const c=o[i];if(c&&typeof c=="object"){c.hasOwnProperty("path")||(c.path="");const u=jg(c,e);for(const h of u){r.push(h);const y=Array.isArray(c.children)&&c.children.length===0;if(c.children&&!y)Ym(c.children,h.pattern,r,n);else{const b=zg([...r],n.length);n.push(b)}r.pop()}}}return r.length?n:n.sort((i,a)=>a.score-i.score)}function yl(t,e){for(let r=0,n=t.length;r<n;r++){const o=t[r].matcher(e);if(o)return o}return[]}function qg(t,e,r){const n=new URL(jm),o=ze(y=>{const b=t();try{return new URL(b,n)}catch{return console.error(`Invalid path ${b}`),y}},n,{equals:(y,b)=>y.href===b.href}),i=ze(()=>o().pathname),a=ze(()=>o().search,!0),c=ze(()=>o().hash),u=()=>"",h=Ic(a,()=>zm(o()));return{get pathname(){return i()},get search(){return a()},get hash(){return c()},get state(){return e()},get key(){return u()},query:r?r(h):qm(h)}}let So;function Gg(){return So}function Hg(t,e,r,n={}){const{signal:[o,i],utils:a={}}=t,c=a.parsePath||(re=>re),u=a.renderPath||(re=>re),h=a.beforeLeave||Um(),y=ea("",n.base||"");if(y===void 0)throw new Error(`${y} is not a valid base path`);y&&!o().value&&i({value:y,replace:!0,scroll:!1});const[b,_]=fe(!1);let A;const E=(re,Y)=>{Y.value===R()&&Y.state===k()||(A===void 0&&_(!0),So=re,A=Y,eg(()=>{A===Y&&(P(A.value),K(A.state),M[1]($=>$.filter(V=>V.pending)))}).finally(()=>{A===Y&&Dm(()=>{So=void 0,re==="navigate"&&x(A),_(!1),A=void 0})}))},[R,P]=fe(o().value),[k,K]=fe(o().state),oe=qg(R,k,a.queryWrapper),O=[],M=fe([]),N=ze(()=>typeof n.transformUrl=="function"?yl(e(),n.transformUrl(oe.pathname)):yl(e(),oe.pathname)),g=()=>{const re=N(),Y={};for(let $=0;$<re.length;$++)Object.assign(Y,re[$].params);return Y},v=a.paramsWrapper?a.paramsWrapper(g,e):qm(g),f={pattern:y,path:()=>y,outlet:()=>null,resolvePath(re){return ea(y,re)}};return le(Ic(o,re=>E("native",re),{defer:!0})),{base:f,location:oe,params:v,isRouting:b,renderPath:u,parsePath:c,navigatorFactory:S,matches:N,beforeLeave:h,preloadRoute:m,singleFlight:n.singleFlight===void 0?!0:n.singleFlight,submissions:M};function C(re,Y,$){Br(()=>{if(typeof Y=="number"){Y&&(a.go?a.go(Y):console.warn("Router integration does not support relative routing"));return}const V=!Y||Y[0]==="?",{replace:Q,resolve:L,scroll:D,state:j}={replace:!1,resolve:!V,scroll:!0,...$},ue=L?re.resolvePath(Y):ea(V&&oe.pathname||"",Y);if(ue===void 0)throw new Error(`Path '${Y}' is not a routable path`);if(O.length>=Mg)throw new Error("Too many redirects");const W=R();(ue!==W||j!==k())&&(Ig||h.confirm(ue,$)&&(O.push({value:W,replace:Q,scroll:D,state:k()}),E("navigate",{value:ue,state:j})))})}function S(re){return re=re||$c(Nc)||f,(Y,$)=>C(re,Y,$)}function x(re){const Y=O[0];Y&&(i({...re,replace:Y.replace,scroll:Y.scroll}),O.length=0)}function m(re,Y){const $=yl(e(),re.pathname),V=So;So="preload";for(let Q in $){const{route:L,params:D}=$[Q];L.component&&L.component.preload&&L.component.preload();const{preload:j}=L;Y&&j&&Lm(r(),()=>j({params:D,location:{pathname:re.pathname,search:re.search,hash:re.hash,query:zm(re),state:null,key:""},intent:"preload"}))}So=V}}function Wg(t,e,r,n){const{base:o,location:i,params:a}=t,{pattern:c,component:u,preload:h}=n().route,y=ze(()=>n().path);u&&u.preload&&u.preload();const b=h?h({params:a,location:i,intent:So||"initial"}):void 0;return{parent:e,pattern:c,path:y,outlet:()=>u?w(u,{params:a,location:i,data:b,get children(){return r()}}):r(),resolvePath(A){return ea(o.path(),A,y())}}}const Yg=t=>e=>{const{base:r}=e,n=Ec(()=>e.children),o=ze(()=>Ym(n(),e.base||""));let i;const a=Hg(t,o,()=>i,{base:r,singleFlight:e.singleFlight,transformUrl:e.transformUrl});return t.create&&t.create(a),w(Hm.Provider,{value:a,get children(){return w(Kg,{routerState:a,get root(){return e.root},get preload(){return e.rootPreload||e.rootLoad},get children(){return[ge(()=>(i=Nm())&&null),w(Qg,{routerState:a,get branches(){return o()}})]}})}})};function Kg(t){const e=t.routerState.location,r=t.routerState.params,n=ze(()=>t.preload&&Br(()=>{t.preload({params:r,location:e,intent:Gg()||"initial"})}));return w(Re,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:o=>w(o,{params:r,location:e,get data(){return n()},get children(){return t.children}})})}function Qg(t){const e=[];let r;const n=ze(Ic(t.routerState.matches,(o,i,a)=>{let c=i&&o.length===i.length;const u=[];for(let h=0,y=o.length;h<y;h++){const b=i&&i[h],_=o[h];a&&b&&_.route.key===b.route.key?u[h]=a[h]:(c=!1,e[h]&&e[h](),qi(A=>{e[h]=A,u[h]=Wg(t.routerState,u[h-1]||t.routerState.base,uu(()=>n()[h+1]),()=>t.routerState.matches()[h])}))}return e.splice(o.length).forEach(h=>h()),a&&c?a:(r=u[0],u)}));return uu(()=>n()&&r)()}const uu=t=>()=>w(Re,{get when(){return t()},keyed:!0,children:e=>w(Nc.Provider,{value:e,get children(){return e.outlet()}})}),Kr=t=>{const e=Ec(()=>t.children);return Yl(t,{get children(){return e()}})};function Jg([t,e],r,n){return[t,n?o=>e(n(o)):e]}function Xg(t){let e=!1;const r=o=>typeof o=="string"?{value:o}:o,n=Jg(fe(r(t.get()),{equals:(o,i)=>o.value===i.value&&o.state===i.state}),void 0,o=>(!e&&t.set(o),o));return t.init&&yi(t.init((o=t.get())=>{e=!0,n[1](r(o)),e=!1})),Yg({signal:n,create:t.create,utils:t.utils})}function Zg(t,e,r){return t.addEventListener(e,r),()=>t.removeEventListener(e,r)}function ev(t,e){const r=t&&document.getElementById(t);r?r.scrollIntoView():e&&window.scrollTo(0,0)}const tv=new Map;function rv(t=!0,e=!1,r="/_server",n){return o=>{const i=o.base.path(),a=o.navigatorFactory(o.base);let c,u;function h(R){return R.namespaceURI==="http://www.w3.org/2000/svg"}function y(R){if(R.defaultPrevented||R.button!==0||R.metaKey||R.altKey||R.ctrlKey||R.shiftKey)return;const P=R.composedPath().find(N=>N instanceof Node&&N.nodeName.toUpperCase()==="A");if(!P||e&&!P.hasAttribute("link"))return;const k=h(P),K=k?P.href.baseVal:P.href;if((k?P.target.baseVal:P.target)||!K&&!P.hasAttribute("state"))return;const O=(P.getAttribute("rel")||"").split(/\s+/);if(P.hasAttribute("download")||O&&O.includes("external"))return;const M=k?new URL(K,document.baseURI):new URL(K);if(!(M.origin!==window.location.origin||i&&M.pathname&&!M.pathname.toLowerCase().startsWith(i.toLowerCase())))return[P,M]}function b(R){const P=y(R);if(!P)return;const[k,K]=P,oe=o.parsePath(K.pathname+K.search+K.hash),O=k.getAttribute("state");R.preventDefault(),a(oe,{resolve:!1,replace:k.hasAttribute("replace"),scroll:!k.hasAttribute("noscroll"),state:O?JSON.parse(O):void 0})}function _(R){const P=y(R);if(!P)return;const[k,K]=P;o.preloadRoute(K,k.getAttribute("preload")!=="false")}function A(R){clearTimeout(c);const P=y(R);if(!P)return u=null;const[k,K]=P;u!==k&&(c=setTimeout(()=>{o.preloadRoute(K,k.getAttribute("preload")!=="false"),u=k},20))}function E(R){if(R.defaultPrevented)return;let P=R.submitter&&R.submitter.hasAttribute("formaction")?R.submitter.getAttribute("formaction"):R.target.getAttribute("action");if(!P)return;if(!P.startsWith("https://action/")){const K=new URL(P,jm);if(P=o.parsePath(K.pathname+K.search),!P.startsWith(r))return}if(R.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const k=tv.get(P);if(k){R.preventDefault();const K=new FormData(R.target,R.submitter);k.call({r:o,f:R.target},R.target.enctype==="multipart/form-data"?K:new URLSearchParams(K))}}ft(["click","submit"]),document.addEventListener("click",b),t&&(document.addEventListener("mousemove",A,{passive:!0}),document.addEventListener("focusin",_,{passive:!0}),document.addEventListener("touchstart",_,{passive:!0})),document.addEventListener("submit",E),yi(()=>{document.removeEventListener("click",b),t&&(document.removeEventListener("mousemove",A),document.removeEventListener("focusin",_),document.removeEventListener("touchstart",_)),document.removeEventListener("submit",E)})}}function nv(t){const e=t.replace(/^.*?#/,"");if(!e.startsWith("/")){const[,r="/"]=window.location.hash.split("#",2);return`${r}#${e}`}return e}function ov(t){const e=()=>window.location.hash.slice(1),r=Um();return Xg({get:e,set({value:n,replace:o,scroll:i,state:a}){o?window.history.replaceState($g(a),"","#"+n):window.history.pushState(a,"","#"+n);const c=n.indexOf("#"),u=c>=0?n.slice(c+1):"";ev(u,i),Dc()},init:n=>Zg(window,"hashchange",Eg(n,o=>!r.confirm(o&&o<0?o:e()))),create:rv(t.preload,t.explicitLinks,t.actionBase),utils:{go:n=>window.history.go(n),renderPath:n=>`#${n}`,parsePath:nv,beforeLeave:r}})(t)}var iv=z("<a>");function Yo(t){t=Yl({inactiveClass:"inactive",activeClass:"active"},t);const[,e]=cg(t,["href","state","class","activeClass","inactiveClass","end"]),r=Vg(()=>t.href),n=Fg(r),o=Bg(),i=ze(()=>{const a=r();if(a===void 0)return[!1,!1];const c=Io(a.split(/[?#]/,1)[0]).toLowerCase(),u=decodeURI(Io(o.pathname).toLowerCase());return[t.end?c===u:u.startsWith(c+"/")||u===c,c===u]});return(()=>{var a=iv();return Sg(a,Yl(e,{get href(){return n()||t.href},get state(){return JSON.stringify(t.state)},get classList(){return{...t.class&&{[t.class]:!0},[t.inactiveClass]:!i()[0],[t.activeClass]:i()[0],...e.classList}},link:"",get"aria-current"(){return i()[1]?"page":void 0}}),!1),a})()}const Jl=Symbol("store-raw"),ei=Symbol("store-node"),Sn=Symbol("store-has"),Km=Symbol("store-self");function Qm(t){let e=t[Xr];if(!e&&(Object.defineProperty(t,Xr,{value:e=new Proxy(t,lv)}),!Array.isArray(t))){const r=Object.keys(t),n=Object.getOwnPropertyDescriptors(t);for(let o=0,i=r.length;o<i;o++){const a=r[o];n[a].get&&Object.defineProperty(t,a,{enumerable:n[a].enumerable,get:n[a].get.bind(e)})}}return e}function pa(t){let e;return t!=null&&typeof t=="object"&&(t[Xr]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function Zi(t,e=new Set){let r,n,o,i;if(r=t!=null&&t[Jl])return r;if(!pa(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let a=0,c=t.length;a<c;a++)o=t[a],(n=Zi(o,e))!==o&&(t[a]=n)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const a=Object.keys(t),c=Object.getOwnPropertyDescriptors(t);for(let u=0,h=a.length;u<h;u++)i=a[u],!c[i].get&&(o=t[i],(n=Zi(o,e))!==o&&(t[i]=n))}return t}function fa(t,e){let r=t[e];return r||Object.defineProperty(t,e,{value:r=Object.create(null)}),r}function es(t,e,r){if(t[e])return t[e];const[n,o]=fe(r,{equals:!1,internal:!0});return n.$=o,t[e]=n}function sv(t,e){const r=Reflect.getOwnPropertyDescriptor(t,e);return!r||r.get||!r.configurable||e===Xr||e===ei||(delete r.value,delete r.writable,r.get=()=>t[Xr][e]),r}function Jm(t){Gl()&&es(fa(t,ei),Km)()}function av(t){return Jm(t),Reflect.ownKeys(t)}const lv={get(t,e,r){if(e===Jl)return t;if(e===Xr)return r;if(e===ql)return Jm(t),r;const n=fa(t,ei),o=n[e];let i=o?o():t[e];if(e===ei||e===Sn||e==="__proto__")return i;if(!o){const a=Object.getOwnPropertyDescriptor(t,e);Gl()&&(typeof i!="function"||t.hasOwnProperty(e))&&!(a&&a.get)&&(i=es(n,e,i)())}return pa(i)?Qm(i):i},has(t,e){return e===Jl||e===Xr||e===ql||e===ei||e===Sn||e==="__proto__"?!0:(Gl()&&es(fa(t,Sn),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:av,getOwnPropertyDescriptor:sv};function ga(t,e,r,n=!1){if(!n&&t[e]===r)return;const o=t[e],i=t.length;r===void 0?(delete t[e],t[Sn]&&t[Sn][e]&&o!==void 0&&t[Sn][e].$()):(t[e]=r,t[Sn]&&t[Sn][e]&&o===void 0&&t[Sn][e].$());let a=fa(t,ei),c;if((c=es(a,e,o))&&c.$(()=>r),Array.isArray(t)&&t.length!==i){for(let u=t.length;u<i;u++)(c=a[u])&&c.$();(c=es(a,"length",i))&&c.$(t.length)}(c=a[Km])&&c.$()}function Xm(t,e){const r=Object.keys(e);for(let n=0;n<r.length;n+=1){const o=r[n];ga(t,o,e[o])}}function cv(t,e){if(typeof e=="function"&&(e=e(t)),e=Zi(e),Array.isArray(e)){if(t===e)return;let r=0,n=e.length;for(;r<n;r++){const o=e[r];t[r]!==o&&ga(t,r,o)}ga(t,"length",n)}else Xm(t,e)}function Oi(t,e,r=[]){let n,o=t;if(e.length>1){n=e.shift();const a=typeof n,c=Array.isArray(t);if(Array.isArray(n)){for(let u=0;u<n.length;u++)Oi(t,[n[u]].concat(e),r);return}else if(c&&a==="function"){for(let u=0;u<t.length;u++)n(t[u],u)&&Oi(t,[u].concat(e),r);return}else if(c&&a==="object"){const{from:u=0,to:h=t.length-1,by:y=1}=n;for(let b=u;b<=h;b+=y)Oi(t,[b].concat(e),r);return}else if(e.length>1){Oi(t[n],e,[n].concat(r));return}o=t[n],r=[n].concat(r)}let i=e[0];typeof i=="function"&&(i=i(o,r),i===o)||n===void 0&&i==null||(i=Zi(i),n===void 0||pa(o)&&pa(i)&&!Array.isArray(i)?Xm(o,i):ga(t,n,i))}function Ba(...[t,e]){const r=Zi(t||{}),n=Array.isArray(r),o=Qm(r);function i(...a){Dm(()=>{n&&a.length===1?cv(r,a[0]):Oi(r,a)})}return[o,i]}const Vt=(t=300+Math.random()*700)=>new Promise(e=>setTimeout(e,t)),fo=(t="")=>`${t}${Date.now()}-${Math.random().toString(36).substr(2,9)}`;let qe={products:[{id:"prod-001",name:"Wireless Headphones",sku:"WH-001",productCode:"WH-001",productName:"Wireless Headphones",description:"High-quality wireless bluetooth headphones",category:"Electronics",unitOfMeasure:"pcs",unitCost:45,sellingPrice:89.99,minStockLevel:10,maxStockLevel:100,isActive:!0,createdDate:"2024-01-15T10:00:00Z",lastModified:"2024-01-15T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-002",name:"USB-C Cable",sku:"USB-001",description:"3ft USB-C charging cable",category:"Accessories",unitOfMeasure:"pcs",unitCost:8.5,sellingPrice:19.99,minStockLevel:25,maxStockLevel:200,isActive:!0,createdDate:"2024-01-16T10:00:00Z",lastModified:"2024-01-16T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-003",name:"Laptop Stand",sku:"LS-001",description:"Adjustable aluminum laptop stand",category:"Office",unitOfMeasure:"pcs",unitCost:25,sellingPrice:49.99,minStockLevel:5,maxStockLevel:50,isActive:!0,createdDate:"2024-01-17T10:00:00Z",lastModified:"2024-01-17T10:00:00Z",businessId:"YB100423253156428"}],locations:[{id:"loc-001",name:"Main Warehouse",code:"WH-001",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-002",name:"Retail Store - Downtown",code:"ST-001",type:"store",address:"456 Main St, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-003",name:"Retail Store - Mall",code:"ST-002",type:"store",address:"789 Mall Blvd, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"}],movements:[{id:"mov-001",productId:"prod-001",productName:"Wireless Headphones",productSku:"WH-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:50,unitCost:45,totalCost:2250,referenceNumber:"PO-001",notes:"Initial stock purchase",createdBy:"admin",createdDate:"2024-01-15T10:00:00Z",invoiceId:"INV-1000001"},{id:"mov-002",productId:"prod-002",productName:"USB-C Cable",productSku:"USB-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:100,unitCost:8.5,totalCost:850,referenceNumber:"PO-001",notes:"Bulk purchase",createdBy:"admin",createdDate:"2024-01-15T10:05:00Z",invoiceId:"INV-1000001"}],accounts:[{id:"acc-001",accountNumber:"1000",accountName:"Cash",accountType:"asset",category:"currentAssets",balance:5e4,parentAccountId:null,description:"Cash and cash equivalents",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"},{id:"acc-002",accountNumber:"1100",accountName:"Accounts Receivable",accountType:"asset",category:"currentAssets",balance:25e3,parentAccountId:null,description:"Money owed by customers",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"}],journalEntries:[{id:"je-001",entryNumber:"JE-001",date:"2024-01-15",description:"Initial cash deposit",reference:"DEP-001",status:"posted",createdBy:"admin",createdAt:"2024-01-15T10:00:00Z",postedAt:"2024-01-15T10:05:00Z",lines:[{id:"jel-001",accountId:"acc-001",accountName:"Cash",description:"Initial deposit",debitAmount:5e4,creditAmount:0},{id:"jel-002",accountId:"acc-003",accountName:"Owner Equity",description:"Initial capital",debitAmount:0,creditAmount:5e4}]}]};const or=(t=.05)=>Math.random()<t,ir=()=>{const t=["Network timeout","Connection refused","Server temporarily unavailable","Invalid request"];throw new Error(t[Math.floor(Math.random()*t.length)])},Vr={products:{async getAll(t,e){await Vt(),or()&&ir();let r=[...qe.products];if(t&&t.trim()){const n=t.toLowerCase();r=r.filter(o=>o.name.toLowerCase().includes(n)||o.sku.toLowerCase().includes(n)||o.category.toLowerCase().includes(n)||o.description.toLowerCase().includes(n))}return e?.category&&(r=r.filter(n=>n.category===e.category)),e?.isActive!==void 0&&(r=r.filter(n=>n.isActive===e.isActive)),r},async getById(t){return await Vt(),or()&&ir(),qe.products.find(e=>e.id===t)||null},async create(t){if(await Vt(),or()&&ir(),qe.products.some(r=>r.sku===t.sku))throw new Error("SKU already exists");const e={...t,id:fo("prod-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return qe.products.push(e),e},async update(t,e){await Vt(),or()&&ir();const r=qe.products.findIndex(o=>o.id===t);if(r===-1)throw new Error("Product not found");if(e.sku&&qe.products.some(o=>o.id!==t&&o.sku===e.sku))throw new Error("SKU already exists");const n={...qe.products[r],...e,lastModified:new Date().toISOString()};return qe.products[r]=n,n},async delete(t){await Vt(),or()&&ir();const e=qe.products.findIndex(n=>n.id===t);if(e===-1)throw new Error("Product not found");return qe.movements.some(n=>n.productId===t)?{success:!1,message:"Cannot delete product with existing movements"}:(qe.products.splice(e,1),{success:!0,message:"Product deleted successfully"})}},locations:{async getAll(t){await Vt(),or()&&ir();let e=[...qe.locations];return t?.type&&(e=e.filter(r=>r.type===t.type)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Vt(),qe.locations.find(e=>e.id===t)||null},async create(t){if(await Vt(),or()&&ir(),qe.locations.some(r=>r.code===t.code))throw new Error("Location code already exists");const e={...t,id:fo("loc-"),createdDate:new Date().toISOString()};return qe.locations.push(e),e},async update(t,e){await Vt(),or()&&ir();const r=qe.locations.findIndex(n=>n.id===t);if(r===-1)throw new Error("Location not found");if(e.code&&qe.locations.some(n=>n.id!==t&&n.code===e.code))throw new Error("Location code already exists");return qe.locations[r]={...qe.locations[r],...e},qe.locations[r]}},movements:{async getAll(t){await Vt(),or()&&ir();let e=[...qe.movements];if(t?.productId&&(e=e.filter(r=>r.productId===t.productId)),t?.locationId&&(e=e.filter(r=>r.locationId===t.locationId)),t?.movementType&&(e=e.filter(r=>r.movementType===t.movementType)),t?.dateFrom&&(e=e.filter(r=>r.createdDate>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.createdDate<=t.dateTo)),t?.search){const r=t.search.toLowerCase();e=e.filter(n=>n.productName.toLowerCase().includes(r)||n.productSku.toLowerCase().includes(r)||n.referenceNumber.toLowerCase().includes(r)||n.notes.toLowerCase().includes(r))}return e.sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime()),e},async getById(t){return await Vt(),qe.movements.find(e=>e.id===t)||null},async create(t){if(await Vt(),or()&&ir(),!qe.products.find(o=>o.id===t.productId))throw new Error("Product not found");if(!qe.locations.find(o=>o.id===t.locationId))throw new Error("Location not found");if(t.movementType==="out"){const o=await this.getStockLevel(t.productId,t.locationId);if(o<t.quantity)throw new Error(`Insufficient stock. Available: ${o}, Requested: ${t.quantity}`)}const n={...t,id:fo("mov-"),createdDate:new Date().toISOString()};return qe.movements.push(n),n},async update(t,e){await Vt(),or()&&ir();const r=qe.movements.findIndex(o=>o.id===t);if(r===-1)throw new Error("Movement not found");const n={...qe.movements[r],...e,lastModified:new Date().toISOString()};return qe.movements[r]=n,n},async delete(t){await Vt(),or()&&ir();const e=qe.movements.findIndex(r=>r.id===t);if(e===-1)throw new Error("Movement not found");return qe.movements.splice(e,1),{success:!0,message:"Movement deleted successfully"}},async createBulk(t){await Vt(),or()&&ir();const e=[],r=[],n=new Date().toISOString(),o=qe.locations.find(i=>i.id===t.locationId);if(!o)return{success:!1,movements:[],errors:["Invalid location"]};for(let i=0;i<t.items.length;i++){const a=t.items[i],c=qe.products.find(y=>y.id===a.productId);if(!c){e.push(`Item ${i+1}: Product not found`);continue}if(a.quantity<=0){e.push(`Item ${i+1}: Quantity must be greater than 0`);continue}if(t.movementType==="out"){const y=await this.getStockLevel(a.productId,t.locationId);if(a.quantity>y){e.push(`Item ${i+1}: Insufficient stock. Available: ${y}, Requested: ${a.quantity}`);continue}}const u=a.unitCost||c.unitCost,h={id:fo("mov-"),productId:c.id,productName:c.name,productSku:c.sku,locationId:t.locationId,locationName:o.name,movementType:t.movementType,quantity:a.quantity,unitCost:u,totalCost:a.quantity*u,referenceNumber:t.referenceNumber,notes:a.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:t.fromLocationId?qe.locations.find(y=>y.id===t.fromLocationId)?.name:void 0};r.push(h)}return e.length>0?{success:!1,movements:[],errors:e}:(qe.movements.push(...r),{success:!0,movements:r,errors:[]})},async getStockLevel(t,e){return await Vt(50),qe.movements.filter(r=>r.productId===t&&r.locationId===e).reduce((r,n)=>{switch(n.movementType){case"in":case"adjustment":return r+n.quantity;case"out":return r-n.quantity;case"transfer":return n.locationId===e?r+n.quantity:r;default:return r}},0)},async getStockLevels(){await Vt();const t=new Map;for(const e of qe.movements){const r=`${e.productId}-${e.locationId}`;let n=t.get(r);switch(n||(n={id:r,productId:e.productId,locationId:e.locationId,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType){case"in":case"adjustment":n.quantity+=e.quantity;break;case"out":n.quantity-=e.quantity;break;case"transfer":e.locationId===e.locationId&&(n.quantity+=e.quantity);break}new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost,n.availableQuantity=n.quantity-n.reservedQuantity}return Array.from(t.values())}},accounts:{async getAll(t){await Vt(),or()&&ir();let e=[...qe.accounts];return t?.accountType&&(e=e.filter(r=>r.accountType===t.accountType)),t?.category&&(e=e.filter(r=>r.category===t.category)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Vt(),qe.accounts.find(e=>e.id===t)||null},async create(t){if(await Vt(),or()&&ir(),qe.accounts.some(r=>r.accountNumber===t.accountNumber))throw new Error("Account number already exists");const e={...t,id:fo("acc-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return qe.accounts.push(e),e},async update(t,e){await Vt(),or()&&ir();const r=qe.accounts.findIndex(n=>n.id===t);if(r===-1)throw new Error("Account not found");if(e.accountNumber&&qe.accounts.some(n=>n.id!==t&&n.accountNumber===e.accountNumber))throw new Error("Account number already exists");return qe.accounts[r]={...qe.accounts[r],...e,lastModified:new Date().toISOString()},qe.accounts[r]}},journal:{async getAll(t){await Vt(),or()&&ir();let e=[...qe.journalEntries];return t?.status&&(e=e.filter(r=>r.status===t.status)),t?.accountId&&(e=e.filter(r=>r.lines.some(n=>n.accountId===t.accountId))),t?.dateFrom&&(e=e.filter(r=>r.date>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.date<=t.dateTo)),e.sort((r,n)=>new Date(n.createdAt).getTime()-new Date(r.createdAt).getTime())},async getById(t){return await Vt(),qe.journalEntries.find(e=>e.id===t)||null},async create(t){await Vt(),or()&&ir();const e=t.lines.reduce((c,u)=>c+(u.debitAmount||0),0),r=t.lines.reduce((c,u)=>c+(u.creditAmount||0),0);if(Math.abs(e-r)>.01)throw new Error(`Entry is not balanced. Debit: ${e}, Credit: ${r}`);const n=qe.journalEntries.sort((c,u)=>u.entryNumber.localeCompare(c.entryNumber))[0],i=`JE-${((n?parseInt(n.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`,a={...t,id:fo("je-"),entryNumber:i,createdAt:new Date().toISOString(),lines:t.lines.map(c=>({...c,id:fo("jel-")}))};return qe.journalEntries.push(a),a},async update(t,e){await Vt(),or()&&ir();const r=qe.journalEntries.findIndex(n=>n.id===t);if(r===-1)throw new Error("Journal entry not found");if(qe.journalEntries[r].status==="posted")throw new Error("Cannot modify posted entries");return qe.journalEntries[r]={...qe.journalEntries[r],...e},qe.journalEntries[r]},async post(t){await Vt(),or()&&ir();const e=qe.journalEntries.findIndex(i=>i.id===t);if(e===-1)throw new Error("Journal entry not found");const r=qe.journalEntries[e];if(r.status==="posted")throw new Error("Entry is already posted");const n=r.lines.reduce((i,a)=>i+(a.debitAmount||0),0),o=r.lines.reduce((i,a)=>i+(a.creditAmount||0),0);if(Math.abs(n-o)>.01)throw new Error("Entry must be balanced before posting");return qe.journalEntries[e]={...r,status:"posted",postedAt:new Date().toISOString()},r.lines.forEach(i=>{const a=qe.accounts.findIndex(c=>c.id===i.accountId);if(a!==-1){const c=qe.accounts[a],u=i.debitAmount||0,h=i.creditAmount||0;["asset","expense"].includes(c.accountType)?c.balance+=u-h:c.balance+=h-u}}),qe.journalEntries[e]}},utils:{async getNextEntryNumber(){await Vt(100);const t=qe.journalEntries.sort((r,n)=>n.entryNumber.localeCompare(r.entryNumber))[0];return`JE-${((t?parseInt(t.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`},async getNextProductCode(t){await Vt(100);const e=t.toUpperCase().slice(0,3),r=qe.products.filter(o=>o.productCode?.startsWith(e)).sort((o,i)=>(i.productCode||"").localeCompare(o.productCode||""));if(r.length===0)return`${e}001`;const n=parseInt(r[0].productCode?.slice(-3)||"0");return`${e}${(n+1).toString().padStart(3,"0")}`},async healthCheck(){return await Vt(50),{status:"healthy",timestamp:new Date().toISOString(),version:"1.0.0"}},async resetDatabase(){return await Vt(200),qe={products:[...qe.products.slice(0,3)],locations:[...qe.locations.slice(0,3)],movements:[...qe.movements.slice(0,2)],accounts:[...qe.accounts.slice(0,2)],journalEntries:[...qe.journalEntries.slice(0,1)]},{success:!0,message:"Database reset to initial state"}},async getStats(){return await Vt(100),{products:qe.products.length,locations:qe.locations.length,movements:qe.movements.length,accounts:qe.accounts.length,journalEntries:qe.journalEntries.length,totalStockValue:qe.movements.reduce((t,e)=>e.movementType==="in"?t+e.totalCost:e.movementType==="out"?t-e.totalCost:t,0)}}}},Zm=(t=16)=>{const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},hu=(t=16)=>{const e="123456789";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},pl=t=>typeof t=="string"&&t.trim().length>0,wn=async t=>{const n=await fetch("https://qvamarkets.com/gql_api",{method:"POST",headers:{"Content-Type":"application/json","Accept-Encoding":"gzip, deflate, br",Authorization:"eyJhbGciOiJSUzI1NiIsImtpZCI6IjhlOGZjOGU1NTZmN2E3NmQwOGQzNTgyOWQ2ZjkwYWUyZTEyY2ZkMGQiLCJ0eXAiOiJKV1QifQ"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const o=await n.json();if(o.errors)throw new Error(o.errors[0]?.message||"GraphQL error");return o.data},dv=t=>({ENTRY:"in",in:"in",TRANSFER:"transfer",transfer:"transfer",SALES:"out",out:"out",adjustment:"adjustment"})[t],Xl=t=>({ENTRY:"ENTRY",in:"ENTRY",TRANSFER:"TRANSFER",transfer:"TRANSFER",SALES:"SALES",out:"SALES",adjustment:"adjustment"})[t];function Zl(t){var e=[];return t&&Object.keys(t).map(r=>{e.push(t[r])}),e}function uv(t){if(!/^[a-z0-9+/]+={0,2}$/i.test(t)||t.length%4!=0)throw Error("Not base64 string");for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,n,o,i,a,c,u,h,y=[],b=0;b<t.length;b+=4)i=e.indexOf(t.charAt(b)),a=e.indexOf(t.charAt(b+1)),c=e.indexOf(t.charAt(b+2)),u=e.indexOf(t.charAt(b+3)),h=i<<18|a<<12|c<<6|u,r=h>>>16&255,n=h>>>8&255,o=h&255,y[b/4]=String.fromCharCode(r,n,o),u==64&&(y[b/4]=String.fromCharCode(r,n)),c==64&&(y[b/4]=String.fromCharCode(r));return t=y.join(""),t}const hv=async()=>({}),mv=()=>(typeof window<"u"&&localStorage.getItem("hrmfinance-api-mode"),"real");let wo=mv();const ts={getMode(){return wo},setMode(t){wo=t,typeof window<"u"&&localStorage.setItem("hrmfinance-api-mode",t)},isFakeMode(){return wo==="fake"},isRealMode(){return wo==="real"},isHybridMode(){return wo==="hybrid"}},Gr=async(t,e,r=!0)=>{if(wo==="fake")return e();if(wo==="real")return t();try{return await t()}catch(n){if(console.warn("Real API failed, falling back to fake server:",n),r)return e();throw n}},mu={async getAll(t,e){const r=await wn({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:{businessId:"YB100423253156428",":search0":"produ"}});return Zl(r)},async getById(t){return Gr(async()=>(await this.getAll()).find(r=>r.id===t)||null,()=>Vr.products.getById(t))},async create(t){return Gr(async()=>{throw console.log("Creating product via real API:",t),new Error("Real API not implemented yet")},()=>Vr.products.create(t))},async update(t,e){return Gr(async()=>{throw console.log("Updating product via real API:",t,e),new Error("Real API not implemented yet")},()=>Vr.products.update(t,e))},async delete(t){return Gr(async()=>{throw console.log("Deleting product via real API:",t),new Error("Real API not implemented yet")},()=>Vr.products.delete(t))}},ln={async getInventory(t,e){if(!(t&&t?.trim()))return[];let r={businessId:"YB100423253156428"};return t&&t.split(" ").map((i,a)=>{i&&(r[":search"+a]=i.trim())}),await wn({query:"getScanYabaInventory",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async getProducts(t){if(!(t&&t?.trim()))return[];let e={businessId:"YB100423253156428"};return t&&t.split(" ").map((o,i)=>{o&&(e[":search"+i]=o.trim())}),await wn({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getInvoice(t,e){if(!(t&&t?.trim()))return[];let r={businessId:"YB100423253156428"};return t&&t.split(" ").map((i,a)=>{i&&(r[":search"+a]=i.trim())}),await wn({query:"getScanYabaSalesOrders",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async addInventory(t){let r={query:"addYabaInventory",params:{businessId:"YB100423253156428"},form:t};const n=await wn(r);return console.log(r),console.log(n),n},async updInventory(t){return await hv()}},yu={async getAll(t){return Gr(async()=>{throw console.log("Getting accounts via real API:",t),new Error("Real API not implemented yet")},()=>Vr.accounts.getAll(t))},async getById(t){return Gr(async()=>{throw console.log("Getting account by ID via real API:",t),new Error("Real API not implemented yet")},()=>Vr.accounts.getById(t))},async create(t){return Gr(async()=>{throw console.log("Creating account via real API:",t),new Error("Real API not implemented yet")},()=>Vr.accounts.create(t))},async update(t,e){return Gr(async()=>{throw console.log("Updating account via real API:",t,e),new Error("Real API not implemented yet")},()=>Vr.accounts.update(t,e))}},pu={async getNextEntryNumber(){return Gr(async()=>{throw console.log("Getting next entry number via real API"),new Error("Real API not implemented yet")},()=>Vr.utils.getNextEntryNumber())},async getNextProductCode(t){return Gr(async()=>{throw console.log("Getting next product code via real API:",t),new Error("Real API not implemented yet")},()=>Vr.utils.getNextProductCode(t))},async healthCheck(){return Gr(async()=>{const t=await fetch("/api/health");if(!t.ok)throw new Error("Health check failed");return t.json()},()=>Vr.utils.healthCheck())},async getStats(){return Gr(async()=>{throw console.log("Getting stats via real API"),new Error("Real API not implemented yet")},()=>Vr.utils.getStats())}},yv=()=>{ts.setMode("real"),console.log("🚀 HRM Finance initialized in REAL API mode for production")};yv();const pv=()=>{};var fu={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ey=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let o=t.charCodeAt(n);o<128?e[r++]=o:o<2048?(e[r++]=o>>6|192,e[r++]=o&63|128):(o&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(o=65536+((o&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=o>>18|240,e[r++]=o>>12&63|128,e[r++]=o>>6&63|128,e[r++]=o&63|128):(e[r++]=o>>12|224,e[r++]=o>>6&63|128,e[r++]=o&63|128)}return e},fv=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const o=t[r++];if(o<128)e[n++]=String.fromCharCode(o);else if(o>191&&o<224){const i=t[r++];e[n++]=String.fromCharCode((o&31)<<6|i&63)}else if(o>239&&o<365){const i=t[r++],a=t[r++],c=t[r++],u=((o&7)<<18|(i&63)<<12|(a&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const i=t[r++],a=t[r++];e[n++]=String.fromCharCode((o&15)<<12|(i&63)<<6|a&63)}}return e.join("")},ty={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let o=0;o<t.length;o+=3){const i=t[o],a=o+1<t.length,c=a?t[o+1]:0,u=o+2<t.length,h=u?t[o+2]:0,y=i>>2,b=(i&3)<<4|c>>4;let _=(c&15)<<2|h>>6,A=h&63;u||(A=64,a||(_=64)),n.push(r[y],r[b],r[_],r[A])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(ey(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):fv(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let o=0;o<t.length;){const i=r[t.charAt(o++)],c=o<t.length?r[t.charAt(o)]:0;++o;const h=o<t.length?r[t.charAt(o)]:64;++o;const b=o<t.length?r[t.charAt(o)]:64;if(++o,i==null||c==null||h==null||b==null)throw new gv;const _=i<<2|c>>4;if(n.push(_),h!==64){const A=c<<4&240|h>>2;if(n.push(A),b!==64){const E=h<<6&192|b;n.push(E)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class gv extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const vv=function(t){const e=ey(t);return ty.encodeByteArray(e,!0)},va=function(t){return vv(t).replace(/\./g,"")},ry=function(t){try{return ty.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bv(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _v=()=>bv().__FIREBASE_DEFAULTS__,Pv=()=>{if(typeof process>"u"||typeof fu>"u")return;const t=fu.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Sv=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&ry(t[1]);return e&&JSON.parse(e)},Ua=()=>{try{return pv()||_v()||Pv()||Sv()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},ny=t=>Ua()?.emulatorHosts?.[t],wv=t=>{const e=ny(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},oy=()=>Ua()?.config,iy=t=>Ua()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pi(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function sy(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Av(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",o=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:o,exp:o+3600,auth_time:o,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[va(JSON.stringify(r)),va(JSON.stringify(a)),""].join(".")}const Gi={};function xv(){const t={prod:[],emulator:[]};for(const e of Object.keys(Gi))Gi[e]?t.emulator.push(e):t.prod.push(e);return t}function Iv(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let gu=!1;function ay(t,e){if(typeof window>"u"||typeof document>"u"||!pi(window.location.host)||Gi[t]===e||Gi[t]||gu)return;Gi[t]=e;function r(_){return`__firebase__banner__${_}`}const n="__firebase__banner",i=xv().prod.length>0;function a(){const _=document.getElementById(n);_&&_.remove()}function c(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function u(_,A){_.setAttribute("width","24"),_.setAttribute("id",A),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function h(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{gu=!0,a()},_}function y(_,A){_.setAttribute("id",A),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function b(){const _=Iv(n),A=r("text"),E=document.getElementById(A)||document.createElement("span"),R=r("learnmore"),P=document.getElementById(R)||document.createElement("a"),k=r("preprendIcon"),K=document.getElementById(k)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const oe=_.element;c(oe),y(P,R);const O=h();u(K,k),oe.append(K,E,P,O),document.body.appendChild(oe)}i?(E.innerText="Preview backend disconnected.",K.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(K.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",b):b()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Er(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function $v(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Er())}function Ev(){const t=Ua()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Tv(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function kv(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Rv(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Dv(){const t=Er();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Nv(){return!Ev()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Lv(){try{return typeof indexedDB=="object"}catch{return!1}}function Mv(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(n);o.onsuccess=()=>{o.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},o.onupgradeneeded=()=>{r=!1},o.onerror=()=>{e(o.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ov="FirebaseError";class Mn extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=Ov,Object.setPrototypeOf(this,Mn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ms.prototype.create)}}class ms{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},o=`${this.service}/${e}`,i=this.errors[e],a=i?Vv(i,n):"Error",c=`${this.serviceName}: ${a} (${o}).`;return new Mn(o,c,n)}}function Vv(t,e){return t.replace(Fv,(r,n)=>{const o=e[n];return o!=null?String(o):`<${n}?>`})}const Fv=/\{\$([^}]+)}/g;function Bv(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Eo(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const o of r){if(!n.includes(o))return!1;const i=t[o],a=e[o];if(vu(i)&&vu(a)){if(!Eo(i,a))return!1}else if(i!==a)return!1}for(const o of n)if(!r.includes(o))return!1;return!0}function vu(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ys(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(o=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Uv(t,e){const r=new jv(t,e);return r.subscribe.bind(r)}class jv{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let o;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");zv(e,["next","error","complete"])?o=e:o={next:e,error:r,complete:n},o.next===void 0&&(o.next=fl),o.error===void 0&&(o.error=fl),o.complete===void 0&&(o.complete=fl);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function zv(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function fl(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function br(t){return t&&t._delegate?t._delegate:t}class To{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Po="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qv{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new Cv;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:r});o&&n.resolve(o)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(n)return null;throw o}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Hv(e))try{this.getOrInitializeService({instanceIdentifier:Po})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:o});n.resolve(i)}catch{}}}}clearInstance(e=Po){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Po){return this.instances.has(e)}getOptions(e=Po){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);n===c&&a.resolve(o)}return o}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),o=this.onInitCallbacks.get(n)??new Set;o.add(e),this.onInitCallbacks.set(n,o);const i=this.instances.get(n);return i&&e(i,n),()=>{o.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const o of n)try{o(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Gv(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Po){return this.component?this.component.multipleInstances?e:Po:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Gv(t){return t===Po?void 0:t}function Hv(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wv{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new qv(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var It;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(It||(It={}));const Yv={debug:It.DEBUG,verbose:It.VERBOSE,info:It.INFO,warn:It.WARN,error:It.ERROR,silent:It.SILENT},Kv=It.INFO,Qv={[It.DEBUG]:"log",[It.VERBOSE]:"log",[It.INFO]:"info",[It.WARN]:"warn",[It.ERROR]:"error"},Jv=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),o=Qv[e];if(o)console[o](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Mc{constructor(e){this.name=e,this._logLevel=Kv,this._logHandler=Jv,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in It))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Yv[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,It.DEBUG,...e),this._logHandler(this,It.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,It.VERBOSE,...e),this._logHandler(this,It.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,It.INFO,...e),this._logHandler(this,It.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,It.WARN,...e),this._logHandler(this,It.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,It.ERROR,...e),this._logHandler(this,It.ERROR,...e)}}const Xv=(t,e)=>e.some(r=>t instanceof r);let bu,_u;function Zv(){return bu||(bu=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function eb(){return _u||(_u=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ly=new WeakMap,ec=new WeakMap,cy=new WeakMap,gl=new WeakMap,Oc=new WeakMap;function tb(t){const e=new Promise((r,n)=>{const o=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{r(Qn(t.result)),o()},a=()=>{n(t.error),o()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&ly.set(r,t)}).catch(()=>{}),Oc.set(e,t),e}function rb(t){if(ec.has(t))return;const e=new Promise((r,n)=>{const o=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{r(),o()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),o()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});ec.set(t,e)}let tc={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return ec.get(t);if(e==="objectStoreNames")return t.objectStoreNames||cy.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Qn(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function nb(t){tc=t(tc)}function ob(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(vl(this),e,...r);return cy.set(n,e.sort?e.sort():[e]),Qn(n)}:eb().includes(t)?function(...e){return t.apply(vl(this),e),Qn(ly.get(this))}:function(...e){return Qn(t.apply(vl(this),e))}}function ib(t){return typeof t=="function"?ob(t):(t instanceof IDBTransaction&&rb(t),Xv(t,Zv())?new Proxy(t,tc):t)}function Qn(t){if(t instanceof IDBRequest)return tb(t);if(gl.has(t))return gl.get(t);const e=ib(t);return e!==t&&(gl.set(t,e),Oc.set(e,t)),e}const vl=t=>Oc.get(t);function sb(t,e,{blocked:r,upgrade:n,blocking:o,terminated:i}={}){const a=indexedDB.open(t,e),c=Qn(a);return n&&a.addEventListener("upgradeneeded",u=>{n(Qn(a.result),u.oldVersion,u.newVersion,Qn(a.transaction),u)}),r&&a.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),c.then(u=>{i&&u.addEventListener("close",()=>i()),o&&u.addEventListener("versionchange",h=>o(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const ab=["get","getKey","getAll","getAllKeys","count"],lb=["put","add","delete","clear"],bl=new Map;function Pu(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(bl.get(e))return bl.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,o=lb.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(o||ab.includes(r)))return;const i=async function(a,...c){const u=this.transaction(a,o?"readwrite":"readonly");let h=u.store;return n&&(h=h.index(c.shift())),(await Promise.all([h[r](...c),o&&u.done]))[0]};return bl.set(e,i),i}nb(t=>({...t,get:(e,r,n)=>Pu(e,r)||t.get(e,r,n),has:(e,r)=>!!Pu(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cb{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(db(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function db(t){return t.getComponent()?.type==="VERSION"}const rc="@firebase/app",Su="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const En=new Mc("@firebase/app"),ub="@firebase/app-compat",hb="@firebase/analytics-compat",mb="@firebase/analytics",yb="@firebase/app-check-compat",pb="@firebase/app-check",fb="@firebase/auth",gb="@firebase/auth-compat",vb="@firebase/database",bb="@firebase/data-connect",_b="@firebase/database-compat",Pb="@firebase/functions",Sb="@firebase/functions-compat",wb="@firebase/installations",Cb="@firebase/installations-compat",Ab="@firebase/messaging",xb="@firebase/messaging-compat",Ib="@firebase/performance",$b="@firebase/performance-compat",Eb="@firebase/remote-config",Tb="@firebase/remote-config-compat",kb="@firebase/storage",Rb="@firebase/storage-compat",Db="@firebase/firestore",Nb="@firebase/ai",Lb="@firebase/firestore-compat",Mb="firebase",Ob="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nc="[DEFAULT]",Vb={[rc]:"fire-core",[ub]:"fire-core-compat",[mb]:"fire-analytics",[hb]:"fire-analytics-compat",[pb]:"fire-app-check",[yb]:"fire-app-check-compat",[fb]:"fire-auth",[gb]:"fire-auth-compat",[vb]:"fire-rtdb",[bb]:"fire-data-connect",[_b]:"fire-rtdb-compat",[Pb]:"fire-fn",[Sb]:"fire-fn-compat",[wb]:"fire-iid",[Cb]:"fire-iid-compat",[Ab]:"fire-fcm",[xb]:"fire-fcm-compat",[Ib]:"fire-perf",[$b]:"fire-perf-compat",[Eb]:"fire-rc",[Tb]:"fire-rc-compat",[kb]:"fire-gcs",[Rb]:"fire-gcs-compat",[Db]:"fire-fst",[Lb]:"fire-fst-compat",[Nb]:"fire-vertex","fire-js":"fire-js",[Mb]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ba=new Map,Fb=new Map,oc=new Map;function wu(t,e){try{t.container.addComponent(e)}catch(r){En.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function si(t){const e=t.name;if(oc.has(e))return En.debug(`There were multiple attempts to register component ${e}.`),!1;oc.set(e,t);for(const r of ba.values())wu(r,t);for(const r of Fb.values())wu(r,t);return!0}function Vc(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function zr(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bb={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Jn=new ms("app","Firebase",Bb);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new To("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Jn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fi=Ob;function dy(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:nc,automaticDataCollectionEnabled:!0,...e},o=n.name;if(typeof o!="string"||!o)throw Jn.create("bad-app-name",{appName:String(o)});if(r||(r=oy()),!r)throw Jn.create("no-options");const i=ba.get(o);if(i){if(Eo(r,i.options)&&Eo(n,i.config))return i;throw Jn.create("duplicate-app",{appName:o})}const a=new Wv(o);for(const u of oc.values())a.addComponent(u);const c=new Ub(r,n,a);return ba.set(o,c),c}function uy(t=nc){const e=ba.get(t);if(!e&&t===nc&&oy())return dy();if(!e)throw Jn.create("no-app",{appName:t});return e}function Xn(t,e,r){let n=Vb[t]??t;r&&(n+=`-${r}`);const o=n.match(/\s|\//),i=e.match(/\s|\//);if(o||i){const a=[`Unable to register library "${n}" with version "${e}":`];o&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),o&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),En.warn(a.join(" "));return}si(new To(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jb="firebase-heartbeat-database",zb=1,rs="firebase-heartbeat-store";let _l=null;function hy(){return _l||(_l=sb(jb,zb,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(rs)}catch(r){console.warn(r)}}}}).catch(t=>{throw Jn.create("idb-open",{originalErrorMessage:t.message})})),_l}async function qb(t){try{const r=(await hy()).transaction(rs),n=await r.objectStore(rs).get(my(t));return await r.done,n}catch(e){if(e instanceof Mn)En.warn(e.message);else{const r=Jn.create("idb-get",{originalErrorMessage:e?.message});En.warn(r.message)}}}async function Cu(t,e){try{const n=(await hy()).transaction(rs,"readwrite");await n.objectStore(rs).put(e,my(t)),await n.done}catch(r){if(r instanceof Mn)En.warn(r.message);else{const n=Jn.create("idb-set",{originalErrorMessage:r?.message});En.warn(n.message)}}}function my(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gb=1024,Hb=30;class Wb{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Kb(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Au();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(o=>o.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>Hb){const o=Qb(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){En.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Au(),{heartbeatsToSend:r,unsentEntries:n}=Yb(this._heartbeatsCache.heartbeats),o=va(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return En.warn(e),""}}}function Au(){return new Date().toISOString().substring(0,10)}function Yb(t,e=Gb){const r=[];let n=t.slice();for(const o of t){const i=r.find(a=>a.agent===o.agent);if(i){if(i.dates.push(o.date),xu(r)>e){i.dates.pop();break}}else if(r.push({agent:o.agent,dates:[o.date]}),xu(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class Kb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Lv()?Mv().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await qb(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Cu(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Cu(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function xu(t){return va(JSON.stringify({version:2,heartbeats:t})).length}function Qb(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jb(t){si(new To("platform-logger",e=>new cb(e),"PRIVATE")),si(new To("heartbeat",e=>new Wb(e),"PRIVATE")),Xn(rc,Su,t),Xn(rc,Su,"esm2020"),Xn("fire-js","")}Jb("");function yy(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Xb=yy,py=new ms("auth","Firebase",yy());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _a=new Mc("@firebase/auth");function Zb(t,...e){_a.logLevel<=It.WARN&&_a.warn(`Auth (${fi}): ${t}`,...e)}function ta(t,...e){_a.logLevel<=It.ERROR&&_a.error(`Auth (${fi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(t,...e){throw Bc(t,...e)}function Jr(t,...e){return Bc(t,...e)}function Fc(t,e,r){const n={...Xb(),[e]:r};return new ms("auth","Firebase",n).create(e,{appName:t.name})}function Zn(t){return Fc(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function fy(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&pn(t,"argument-error"),Fc(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Bc(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return py.create(t,...e)}function st(t,e,...r){if(!t)throw Bc(e,...r)}function Cn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ta(e),new Error(e)}function Tn(t,e){t||Cn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ic(){return typeof self<"u"&&self.location?.href||""}function e0(){return Iu()==="http:"||Iu()==="https:"}function Iu(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t0(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(e0()||kv()||"connection"in navigator)?navigator.onLine:!0}function r0(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(e,r){this.shortDelay=e,this.longDelay=r,Tn(r>e,"Short delay should be less than long delay!"),this.isMobile=$v()||Rv()}get(){return t0()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uc(t,e){Tn(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Cn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Cn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Cn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n0={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o0=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],i0=new ps(3e4,6e4);function jc(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function gi(t,e,r,n,o={}){return vy(t,o,async()=>{let i={},a={};n&&(e==="GET"?a=n:i={body:JSON.stringify(n)});const c=ys({key:t.config.apiKey,...a}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const h={method:e,headers:u,...i};return Tv()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&pi(t.emulatorConfig.host)&&(h.credentials="include"),gy.fetch()(await by(t,t.config.apiHost,r,c),h)})}async function vy(t,e,r){t._canInitEmulator=!1;const n={...n0,...e};try{const o=new a0(t),i=await Promise.race([r(),o.promise]);o.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw Ms(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const c=i.ok?a.errorMessage:a.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ms(t,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw Ms(t,"email-already-in-use",a);if(u==="USER_DISABLED")throw Ms(t,"user-disabled",a);const y=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Fc(t,y,h);pn(t,y)}}catch(o){if(o instanceof Mn)throw o;pn(t,"network-request-failed",{message:String(o)})}}async function s0(t,e,r,n,o={}){const i=await gi(t,e,r,n,o);return"mfaPendingCredential"in i&&pn(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function by(t,e,r,n){const o=`${e}${r}?${n}`,i=t,a=i.config.emulator?Uc(t.config,o):`${t.config.apiScheme}://${o}`;return o0.includes(r)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(a).toString():a}class a0{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Jr(this.auth,"network-request-failed")),i0.get())})}}function Ms(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const o=Jr(t,e,n);return o.customData._tokenResponse=r,o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l0(t,e){return gi(t,"POST","/v1/accounts:delete",e)}async function Pa(t,e){return gi(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hi(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function c0(t,e=!1){const r=br(t),n=await r.getIdToken(e),o=zc(n);st(o&&o.exp&&o.auth_time&&o.iat,r.auth,"internal-error");const i=typeof o.firebase=="object"?o.firebase:void 0,a=i?.sign_in_provider;return{claims:o,token:n,authTime:Hi(Pl(o.auth_time)),issuedAtTime:Hi(Pl(o.iat)),expirationTime:Hi(Pl(o.exp)),signInProvider:a||null,signInSecondFactor:i?.sign_in_second_factor||null}}function Pl(t){return Number(t)*1e3}function zc(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return ta("JWT malformed, contained fewer than 3 sections"),null;try{const o=ry(r);return o?JSON.parse(o):(ta("Failed to decode base64 JWT payload"),null)}catch(o){return ta("Caught error parsing JWT payload as JSON",o?.toString()),null}}function $u(t){const e=zc(t);return st(e,"internal-error"),st(typeof e.exp<"u","internal-error"),st(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ns(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Mn&&d0(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function d0({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u0{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Hi(this.lastLoginAt),this.creationTime=Hi(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sa(t){const e=t.auth,r=await t.getIdToken(),n=await ns(t,Pa(e,{idToken:r}));st(n?.users.length,e,"internal-error");const o=n.users[0];t._notifyReloadListener(o);const i=o.providerUserInfo?.length?_y(o.providerUserInfo):[],a=m0(t.providerData,i),c=t.isAnonymous,u=!(t.email&&o.passwordHash)&&!a?.length,h=c?u:!1,y={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new sc(o.createdAt,o.lastLoginAt),isAnonymous:h};Object.assign(t,y)}async function h0(t){const e=br(t);await Sa(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function m0(t,e){return[...t.filter(n=>!e.some(o=>o.providerId===n.providerId)),...e]}function _y(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y0(t,e){const r=await vy(t,{},async()=>{const n=ys({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:i}=t.config,a=await by(t,o,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:n};return t.emulatorConfig&&pi(t.emulatorConfig.host)&&(u.credentials="include"),gy.fetch()(a,u)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function p0(t,e){return gi(t,"POST","/v2/accounts:revokeToken",jc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){st(e.idToken,"internal-error"),st(typeof e.idToken<"u","internal-error"),st(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):$u(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){st(e.length!==0,"internal-error");const r=$u(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(st(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:o,expiresIn:i}=await y0(e,r);this.updateTokensAndExpiration(n,o,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:o,expirationTime:i}=r,a=new ti;return n&&(st(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),o&&(st(typeof o=="string","internal-error",{appName:e}),a.accessToken=o),i&&(st(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ti,this.toJSON())}_performRefresh(){return Cn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jn(t,e){st(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Qr{constructor({uid:e,auth:r,stsTokenManager:n,...o}){this.providerId="firebase",this.proactiveRefresh=new u0(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new sc(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const r=await ns(this,this.stsTokenManager.getToken(this.auth,e));return st(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return c0(this,e)}reload(){return h0(this)}_assign(e){this!==e&&(st(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Qr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){st(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Sa(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(zr(this.auth.app))return Promise.reject(Zn(this.auth));const e=await this.getIdToken();return await ns(this,l0(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,o=r.email??void 0,i=r.phoneNumber??void 0,a=r.photoURL??void 0,c=r.tenantId??void 0,u=r._redirectEventId??void 0,h=r.createdAt??void 0,y=r.lastLoginAt??void 0,{uid:b,emailVerified:_,isAnonymous:A,providerData:E,stsTokenManager:R}=r;st(b&&R,e,"internal-error");const P=ti.fromJSON(this.name,R);st(typeof b=="string",e,"internal-error"),jn(n,e.name),jn(o,e.name),st(typeof _=="boolean",e,"internal-error"),st(typeof A=="boolean",e,"internal-error"),jn(i,e.name),jn(a,e.name),jn(c,e.name),jn(u,e.name),jn(h,e.name),jn(y,e.name);const k=new Qr({uid:b,auth:e,email:o,emailVerified:_,displayName:n,isAnonymous:A,photoURL:a,phoneNumber:i,tenantId:c,stsTokenManager:P,createdAt:h,lastLoginAt:y});return E&&Array.isArray(E)&&(k.providerData=E.map(K=>({...K}))),u&&(k._redirectEventId=u),k}static async _fromIdTokenResponse(e,r,n=!1){const o=new ti;o.updateFromServerResponse(r);const i=new Qr({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:n});return await Sa(i),i}static async _fromGetAccountInfoResponse(e,r,n){const o=r.users[0];st(o.localId!==void 0,"internal-error");const i=o.providerUserInfo!==void 0?_y(o.providerUserInfo):[],a=!(o.email&&o.passwordHash)&&!i?.length,c=new ti;c.updateFromIdToken(n);const u=new Qr({uid:o.localId,auth:e,stsTokenManager:c,isAnonymous:a}),h={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:i,metadata:new sc(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!i?.length};return Object.assign(u,h),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eu=new Map;function An(t){Tn(t instanceof Function,"Expected a class definition");let e=Eu.get(t);return e?(Tn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Eu.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}Py.type="NONE";const Tu=Py;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ra(t,e,r){return`firebase:${t}:${e}:${r}`}class ri{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:o,name:i}=this.auth;this.fullUserKey=ra(this.userKey,o.apiKey,i),this.fullPersistenceKey=ra("persistence",o.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await Pa(this.auth,{idToken:e}).catch(()=>{});return r?Qr._fromGetAccountInfoResponse(this.auth,r,e):null}return Qr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new ri(An(Tu),e,n);const o=(await Promise.all(r.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=o[0]||An(Tu);const a=ra(n,e.config.apiKey,e.name);let c=null;for(const h of r)try{const y=await h._get(a);if(y){let b;if(typeof y=="string"){const _=await Pa(e,{idToken:y}).catch(()=>{});if(!_)break;b=await Qr._fromGetAccountInfoResponse(e,_,y)}else b=Qr._fromJSON(e,y);h!==i&&(c=b),i=h;break}}catch{}const u=o.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new ri(i,e,n):(i=u[0],c&&await i._set(a,c.toJSON()),await Promise.all(r.map(async h=>{if(h!==i)try{await h._remove(a)}catch{}})),new ri(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ku(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ay(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Sy(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Iy(e))return"Blackberry";if($y(e))return"Webos";if(wy(e))return"Safari";if((e.includes("chrome/")||Cy(e))&&!e.includes("edge/"))return"Chrome";if(xy(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function Sy(t=Er()){return/firefox\//i.test(t)}function wy(t=Er()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Cy(t=Er()){return/crios\//i.test(t)}function Ay(t=Er()){return/iemobile/i.test(t)}function xy(t=Er()){return/android/i.test(t)}function Iy(t=Er()){return/blackberry/i.test(t)}function $y(t=Er()){return/webos/i.test(t)}function qc(t=Er()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function f0(t=Er()){return qc(t)&&!!window.navigator?.standalone}function g0(){return Dv()&&document.documentMode===10}function Ey(t=Er()){return qc(t)||xy(t)||$y(t)||Iy(t)||/windows phone/i.test(t)||Ay(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ty(t,e=[]){let r;switch(t){case"Browser":r=ku(Er());break;case"Worker":r=`${ku(Er())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${fi}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v0{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((a,c)=>{try{const u=e(i);a(u)}catch(u){c(u)}});n.onAbort=r,this.queue.push(n);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const o of r)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b0(t,e={}){return gi(t,"GET","/v2/passwordPolicy",jc(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _0=6;class P0{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??_0,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),o&&(r.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let o=0;o<e.length;o++)n=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,o,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0{constructor(e,r,n,o){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ru(this),this.idTokenSubscription=new Ru(this),this.beforeStateQueue=new v0(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=py,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=An(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await ri.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Pa(this,{idToken:e}),n=await Qr._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(zr(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,a=n?._redirectEventId,c=await this.tryRedirectSignIn(e);(!i||i===a)&&c?.user&&(n=c.user,o=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(n)}catch(i){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return st(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Sa(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=r0()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(zr(this.app))return Promise.reject(Zn(this));const r=e?br(e):null;return r&&st(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&st(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return zr(this.app)?Promise.reject(Zn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return zr(this.app)?Promise.reject(Zn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(An(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await b0(this),r=new P0(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ms("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await p0(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&An(e)||this._popupRedirectResolver;st(r,this,"argument-error"),this.redirectPersistenceManager=await ri.create(this,[An(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,o){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(st(c,this,"internal-error"),c.then(()=>{a||i(this.currentUser)}),typeof r=="function"){const u=e.addObserver(r,n,o);return()=>{a=!0,u()}}else{const u=e.addObserver(r);return()=>{a=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return st(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ty(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(zr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Zb(`Error while retrieving App Check token: ${e.error}`),e?.token}}function No(t){return br(t)}class Ru{constructor(e){this.auth=e,this.observer=null,this.addObserver=Uv(r=>this.observer=r)}get next(){return st(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function w0(t){Gc=t}function C0(t){return Gc.loadJS(t)}function A0(){return Gc.gapiScript}function x0(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I0(t,e){const r=Vc(t,"auth");if(r.isInitialized()){const o=r.getImmediate(),i=r.getOptions();if(Eo(i,e??{}))return o;pn(o,"already-initialized")}return r.initialize({options:e})}function $0(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(An);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function E0(t,e,r){const n=No(t);st(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const o=!1,i=ky(e),{host:a,port:c}=T0(e),u=c===null?"":`:${c}`,h={url:`${i}//${a}${u}/`},y=Object.freeze({host:a,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!n._canInitEmulator){st(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),st(Eo(h,n.config.emulator)&&Eo(y,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=y,n.settings.appVerificationDisabledForTesting=!0,pi(a)?(sy(`${i}//${a}${u}`),ay("Auth",!0)):k0()}function ky(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function T0(t){const e=ky(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(n);if(o){const i=o[1];return{host:i,port:Du(n.substr(i.length+1))}}else{const[i,a]=n.split(":");return{host:i,port:Du(a)}}}function Du(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function k0(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Cn("not implemented")}_getIdTokenResponse(e){return Cn("not implemented")}_linkToIdToken(e,r){return Cn("not implemented")}_getReauthenticationResolver(e){return Cn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ni(t,e){return s0(t,"POST","/v1/accounts:signInWithIdp",jc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R0="http://localhost";class ko extends Ry{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new ko(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):pn("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:o,...i}=r;if(!n||!o)return null;const a=new ko(n,o);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return ni(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,ni(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,ni(e,r)}buildRequest(){const e={requestUri:R0,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=ys(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs extends ja{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn extends fs{constructor(){super("facebook.com")}static credential(e){return ko._fromParams({providerId:Hn.PROVIDER_ID,signInMethod:Hn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Hn.credentialFromTaggedObject(e)}static credentialFromError(e){return Hn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Hn.credential(e.oauthAccessToken)}catch{return null}}}Hn.FACEBOOK_SIGN_IN_METHOD="facebook.com";Hn.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an extends fs{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return ko._fromParams({providerId:an.PROVIDER_ID,signInMethod:an.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return an.credentialFromTaggedObject(e)}static credentialFromError(e){return an.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return an.credential(r,n)}catch{return null}}}an.GOOGLE_SIGN_IN_METHOD="google.com";an.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn extends fs{constructor(){super("github.com")}static credential(e){return ko._fromParams({providerId:Wn.PROVIDER_ID,signInMethod:Wn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Wn.credentialFromTaggedObject(e)}static credentialFromError(e){return Wn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Wn.credential(e.oauthAccessToken)}catch{return null}}}Wn.GITHUB_SIGN_IN_METHOD="github.com";Wn.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn extends fs{constructor(){super("twitter.com")}static credential(e,r){return ko._fromParams({providerId:Yn.PROVIDER_ID,signInMethod:Yn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Yn.credentialFromTaggedObject(e)}static credentialFromError(e){return Yn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Yn.credential(r,n)}catch{return null}}}Yn.TWITTER_SIGN_IN_METHOD="twitter.com";Yn.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,o=!1){const i=await Qr._fromIdTokenResponse(e,n,o),a=Nu(n);return new ai({user:i,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const o=Nu(n);return new ai({user:e,providerId:o,_tokenResponse:n,operationType:r})}}function Nu(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa extends Mn{constructor(e,r,n,o){super(r.code,r.message),this.operationType=n,this.user=o,Object.setPrototypeOf(this,wa.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,o){return new wa(e,r,n,o)}}function Dy(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?wa._fromErrorAndOperation(t,i,e,n):i})}async function D0(t,e,r=!1){const n=await ns(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return ai._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N0(t,e,r=!1){const{auth:n}=t;if(zr(n.app))return Promise.reject(Zn(n));const o="reauthenticate";try{const i=await ns(t,Dy(n,o,e,t),r);st(i.idToken,n,"internal-error");const a=zc(i.idToken);st(a,n,"internal-error");const{sub:c}=a;return st(t.uid===c,n,"user-mismatch"),ai._forOperation(t,o,i)}catch(i){throw i?.code==="auth/user-not-found"&&pn(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ny(t,e,r=!1){if(zr(t.app))return Promise.reject(Zn(t));const n="signIn",o=await Dy(t,n,e),i=await ai._fromIdTokenResponse(t,n,o);return r||await t._updateCurrentUser(i.user),i}async function L0(t,e){return Ny(No(t),e)}function M0(t,e,r,n){return br(t).onIdTokenChanged(e,r,n)}function O0(t,e,r){return br(t).beforeAuthStateChanged(e,r)}function V0(t,e,r,n){return br(t).onAuthStateChanged(e,r,n)}function F0(t){return br(t).signOut()}const Ca="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ly{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Ca,"1"),this.storage.removeItem(Ca),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B0=1e3,U0=10;class My extends Ly{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Ey(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),o=this.localCache[r];n!==o&&e(r,o,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,c,u)=>{this.notifyListeners(a,u)});return}const n=e.key;r?this.detachListener():this.stopPolling();const o=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},i=this.storage.getItem(n);g0()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,U0):o()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const o of Array.from(n))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},B0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}My.type="LOCAL";const j0=My;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oy extends Ly{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}Oy.type="SESSION";const Vy=Oy;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z0(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(o=>o.isListeningto(e));if(r)return r;const n=new za(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:o,data:i}=r.data,a=this.handlersMap[o];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:o});const c=Array.from(a).map(async h=>h(r.origin,i)),u=await z0(c);r.ports[0].postMessage({status:"done",eventId:n,eventType:o,response:u})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}za.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hc(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q0{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let i,a;return new Promise((c,u)=>{const h=Hc("",20);o.port1.start();const y=setTimeout(()=>{u(new Error("unsupported_event"))},n);a={messageChannel:o,onMessage(b){const _=b;if(_.data.eventId===h)switch(_.data.status){case"ack":clearTimeout(y),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(_.data.response);break;default:clearTimeout(y),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(a),o.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:r},[o.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cn(){return window}function G0(t){cn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fy(){return typeof cn().WorkerGlobalScope<"u"&&typeof cn().importScripts=="function"}async function H0(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function W0(){return navigator?.serviceWorker?.controller||null}function Y0(){return Fy()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const By="firebaseLocalStorageDb",K0=1,Aa="firebaseLocalStorage",Uy="fbase_key";class gs{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function qa(t,e){return t.transaction([Aa],e?"readwrite":"readonly").objectStore(Aa)}function Q0(){const t=indexedDB.deleteDatabase(By);return new gs(t).toPromise()}function ac(){const t=indexedDB.open(By,K0);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Aa,{keyPath:Uy})}catch(o){r(o)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Aa)?e(n):(n.close(),await Q0(),e(await ac()))})})}async function Lu(t,e,r){const n=qa(t,!0).put({[Uy]:e,value:r});return new gs(n).toPromise()}async function J0(t,e){const r=qa(t,!1).get(e),n=await new gs(r).toPromise();return n===void 0?null:n.value}function Mu(t,e){const r=qa(t,!0).delete(e);return new gs(r).toPromise()}const X0=800,Z0=3;class jy{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ac(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>Z0)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Fy()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=za._getInstance(Y0()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await H0(),!this.activeServiceWorker)return;this.sender=new q0(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||W0()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ac();return await Lu(e,Ca,"1"),await Mu(e,Ca),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>Lu(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>J0(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>Mu(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const i=qa(o,!1).getAll();return new gs(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:o,value:i}of e)n.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(i)&&(this.notifyListeners(o,i),r.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!n.has(o)&&(this.notifyListeners(o,null),r.push(o));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const o of Array.from(n))o(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),X0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}jy.type="LOCAL";const e_=jy;new ps(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wc(t,e){return e?An(e):(st(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc extends Ry{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ni(e,this._buildIdpRequest())}_linkToIdToken(e,r){return ni(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return ni(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function t_(t){return Ny(t.auth,new Yc(t),t.bypassAuthState)}function r_(t){const{auth:e,user:r}=t;return st(r,e,"internal-error"),N0(r,new Yc(t),t.bypassAuthState)}async function n_(t){const{auth:e,user:r}=t;return st(r,e,"internal-error"),D0(r,new Yc(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zy{constructor(e,r,n,o,i=!1){this.auth=e,this.resolver=n,this.user=o,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:o,tenantId:i,error:a,type:c}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return t_;case"linkViaPopup":case"linkViaRedirect":return n_;case"reauthViaPopup":case"reauthViaRedirect":return r_;default:pn(this.auth,"internal-error")}}resolve(e){Tn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Tn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o_=new ps(2e3,1e4);async function i_(t,e,r){if(zr(t.app))return Promise.reject(Jr(t,"operation-not-supported-in-this-environment"));const n=No(t);fy(t,e,ja);const o=Wc(n,r);return new Ao(n,"signInViaPopup",e,o).executeNotNull()}class Ao extends zy{constructor(e,r,n,o,i){super(e,r,o,i),this.provider=n,this.authWindow=null,this.pollId=null,Ao.currentPopupAction&&Ao.currentPopupAction.cancel(),Ao.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return st(e,this.auth,"internal-error"),e}async onExecution(){Tn(this.filter.length===1,"Popup operations only handle one event");const e=Hc();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Jr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Jr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ao.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Jr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,o_.get())};e()}}Ao.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s_="pendingRedirect",na=new Map;class a_ extends zy{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=na.get(this.auth._key());if(!e){try{const n=await l_(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}na.set(this.auth._key(),e)}return this.bypassAuthState||na.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function l_(t,e){const r=Gy(e),n=qy(t);if(!await n._isAvailable())return!1;const o=await n._get(r)==="true";return await n._remove(r),o}async function c_(t,e){return qy(t)._set(Gy(e),"true")}function d_(t,e){na.set(t._key(),e)}function qy(t){return An(t._redirectPersistence)}function Gy(t){return ra(s_,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u_(t,e,r){return h_(t,e,r)}async function h_(t,e,r){if(zr(t.app))return Promise.reject(Zn(t));const n=No(t);fy(t,e,ja),await n._initializationPromise;const o=Wc(n,r);return await c_(o,n),o._openRedirect(n,e,"signInViaRedirect")}async function m_(t,e){return await No(t)._initializationPromise,Hy(t,e,!1)}async function Hy(t,e,r=!1){if(zr(t.app))return Promise.reject(Zn(t));const n=No(t),o=Wc(n,e),a=await new a_(n,o,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y_=10*60*1e3;class p_{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!f_(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!Wy(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Jr(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=y_&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ou(e))}saveEventToCache(e){this.cachedEventUids.add(Ou(e)),this.lastProcessedEventTime=Date.now()}}function Ou(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Wy({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function f_(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Wy(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g_(t,e={}){return gi(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v_=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,b_=/^https?/;async function __(t){if(t.config.emulator)return;const{authorizedDomains:e}=await g_(t);for(const r of e)try{if(P_(r))return}catch{}pn(t,"unauthorized-domain")}function P_(t){const e=ic(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!b_.test(r))return!1;if(v_.test(t))return n===t;const o=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S_=new ps(3e4,6e4);function Vu(){const t=cn().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function w_(t){return new Promise((e,r)=>{function n(){Vu(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Vu(),r(Jr(t,"network-request-failed"))},timeout:S_.get()})}if(cn().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(cn().gapi?.load)n();else{const o=x0("iframefcb");return cn()[o]=()=>{gapi.load?n():r(Jr(t,"network-request-failed"))},C0(`${A0()}?onload=${o}`).catch(i=>r(i))}}).catch(e=>{throw oa=null,e})}let oa=null;function C_(t){return oa=oa||w_(t),oa}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A_=new ps(5e3,15e3),x_="__/auth/iframe",I_="emulator/auth/iframe",$_={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},E_=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function T_(t){const e=t.config;st(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Uc(e,I_):`https://${t.config.authDomain}/${x_}`,n={apiKey:e.apiKey,appName:t.name,v:fi},o=E_.get(t.config.apiHost);o&&(n.eid=o);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${ys(n).slice(1)}`}async function k_(t){const e=await C_(t),r=cn().gapi;return st(r,t,"internal-error"),e.open({where:document.body,url:T_(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:$_,dontclear:!0},n=>new Promise(async(o,i)=>{await n.restyle({setHideOnLeave:!1});const a=Jr(t,"network-request-failed"),c=cn().setTimeout(()=>{i(a)},A_.get());function u(){cn().clearTimeout(c),o(n)}n.ping(u).then(u,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R_={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},D_=500,N_=600,L_="_blank",M_="http://localhost";class Fu{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function O_(t,e,r,n=D_,o=N_){const i=Math.max((window.screen.availHeight-o)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const u={...R_,width:n.toString(),height:o.toString(),top:i,left:a},h=Er().toLowerCase();r&&(c=Cy(h)?L_:r),Sy(h)&&(e=e||M_,u.scrollbars="yes");const y=Object.entries(u).reduce((_,[A,E])=>`${_}${A}=${E},`,"");if(f0(h)&&c!=="_self")return V_(e||"",c),new Fu(null);const b=window.open(e||"",c,y);st(b,t,"popup-blocked");try{b.focus()}catch{}return new Fu(b)}function V_(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F_="__/auth/handler",B_="emulator/auth/handler",U_=encodeURIComponent("fac");async function Bu(t,e,r,n,o,i){st(t.config.authDomain,t,"auth-domain-config-required"),st(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:fi,eventId:o};if(e instanceof ja){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",Bv(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[y,b]of Object.entries({}))a[y]=b}if(e instanceof fs){const y=e.getScopes().filter(b=>b!=="");y.length>0&&(a.scopes=y.join(","))}t.tenantId&&(a.tid=t.tenantId);const c=a;for(const y of Object.keys(c))c[y]===void 0&&delete c[y];const u=await t._getAppCheckToken(),h=u?`#${U_}=${encodeURIComponent(u)}`:"";return`${j_(t)}?${ys(c).slice(1)}${h}`}function j_({config:t}){return t.emulator?Uc(t,B_):`https://${t.authDomain}/${F_}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sl="webStorageSupport";class z_{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Vy,this._completeRedirectFn=Hy,this._overrideRedirectResult=d_}async _openPopup(e,r,n,o){Tn(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await Bu(e,r,n,ic(),o);return O_(e,i,Hc())}async _openRedirect(e,r,n,o){await this._originValidation(e);const i=await Bu(e,r,n,ic(),o);return G0(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:o,promise:i}=this.eventManagers[r];return o?Promise.resolve(o):(Tn(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await k_(e),n=new p_(e);return r.register("authEvent",o=>(st(o?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Sl,{type:Sl},o=>{const i=o?.[0]?.[Sl];i!==void 0&&r(!!i),pn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=__(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return Ey()||wy()||qc()}}const q_=z_;var Uu="@firebase/auth",ju="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G_{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){st(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H_(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function W_(t){si(new To("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=n.options;st(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:a,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ty(t)},h=new S0(n,o,i,u);return $0(h,r),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),si(new To("auth-internal",e=>{const r=No(e.getProvider("auth").getImmediate());return(n=>new G_(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Xn(Uu,ju,H_(t)),Xn(Uu,ju,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y_=5*60,K_=iy("authIdTokenMaxAge")||Y_;let zu=null;const Q_=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>K_)return;const o=r?.token;zu!==o&&(zu=o,await fetch(t,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function J_(t=uy()){const e=Vc(t,"auth");if(e.isInitialized())return e.getImmediate();const r=I0(t,{popupRedirectResolver:q_,persistence:[e_,j0,Vy]}),n=iy("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const a=Q_(i.toString());O0(r,a,()=>a(r.currentUser)),M0(r,c=>a(c))}}const o=ny("auth");return o&&E0(r,`http://${o}`),r}function X_(){return document.getElementsByTagName("head")?.[0]??document}w0({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=o=>{const i=Jr("internal-error");i.customData=o,r(i)},n.type="text/javascript",n.charset="UTF-8",X_().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});W_("Browser");var Z_="firebase",eP="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xn(Z_,eP,"app");var qu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var eo,Yy;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(g,v){function f(){}f.prototype=v.prototype,g.D=v.prototype,g.prototype=new f,g.prototype.constructor=g,g.C=function(C,S,x){for(var m=Array(arguments.length-2),re=2;re<arguments.length;re++)m[re-2]=arguments[re];return v.prototype[S].apply(C,m)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(g,v,f){f||(f=0);var C=Array(16);if(typeof v=="string")for(var S=0;16>S;++S)C[S]=v.charCodeAt(f++)|v.charCodeAt(f++)<<8|v.charCodeAt(f++)<<16|v.charCodeAt(f++)<<24;else for(S=0;16>S;++S)C[S]=v[f++]|v[f++]<<8|v[f++]<<16|v[f++]<<24;v=g.g[0],f=g.g[1],S=g.g[2];var x=g.g[3],m=v+(x^f&(S^x))+C[0]+3614090360&4294967295;v=f+(m<<7&4294967295|m>>>25),m=x+(S^v&(f^S))+C[1]+3905402710&4294967295,x=v+(m<<12&4294967295|m>>>20),m=S+(f^x&(v^f))+C[2]+606105819&4294967295,S=x+(m<<17&4294967295|m>>>15),m=f+(v^S&(x^v))+C[3]+3250441966&4294967295,f=S+(m<<22&4294967295|m>>>10),m=v+(x^f&(S^x))+C[4]+4118548399&4294967295,v=f+(m<<7&4294967295|m>>>25),m=x+(S^v&(f^S))+C[5]+1200080426&4294967295,x=v+(m<<12&4294967295|m>>>20),m=S+(f^x&(v^f))+C[6]+2821735955&4294967295,S=x+(m<<17&4294967295|m>>>15),m=f+(v^S&(x^v))+C[7]+4249261313&4294967295,f=S+(m<<22&4294967295|m>>>10),m=v+(x^f&(S^x))+C[8]+1770035416&4294967295,v=f+(m<<7&4294967295|m>>>25),m=x+(S^v&(f^S))+C[9]+2336552879&4294967295,x=v+(m<<12&4294967295|m>>>20),m=S+(f^x&(v^f))+C[10]+4294925233&4294967295,S=x+(m<<17&4294967295|m>>>15),m=f+(v^S&(x^v))+C[11]+2304563134&4294967295,f=S+(m<<22&4294967295|m>>>10),m=v+(x^f&(S^x))+C[12]+1804603682&4294967295,v=f+(m<<7&4294967295|m>>>25),m=x+(S^v&(f^S))+C[13]+4254626195&4294967295,x=v+(m<<12&4294967295|m>>>20),m=S+(f^x&(v^f))+C[14]+2792965006&4294967295,S=x+(m<<17&4294967295|m>>>15),m=f+(v^S&(x^v))+C[15]+1236535329&4294967295,f=S+(m<<22&4294967295|m>>>10),m=v+(S^x&(f^S))+C[1]+4129170786&4294967295,v=f+(m<<5&4294967295|m>>>27),m=x+(f^S&(v^f))+C[6]+3225465664&4294967295,x=v+(m<<9&4294967295|m>>>23),m=S+(v^f&(x^v))+C[11]+643717713&4294967295,S=x+(m<<14&4294967295|m>>>18),m=f+(x^v&(S^x))+C[0]+3921069994&4294967295,f=S+(m<<20&4294967295|m>>>12),m=v+(S^x&(f^S))+C[5]+3593408605&4294967295,v=f+(m<<5&4294967295|m>>>27),m=x+(f^S&(v^f))+C[10]+38016083&4294967295,x=v+(m<<9&4294967295|m>>>23),m=S+(v^f&(x^v))+C[15]+3634488961&4294967295,S=x+(m<<14&4294967295|m>>>18),m=f+(x^v&(S^x))+C[4]+3889429448&4294967295,f=S+(m<<20&4294967295|m>>>12),m=v+(S^x&(f^S))+C[9]+568446438&4294967295,v=f+(m<<5&4294967295|m>>>27),m=x+(f^S&(v^f))+C[14]+3275163606&4294967295,x=v+(m<<9&4294967295|m>>>23),m=S+(v^f&(x^v))+C[3]+4107603335&4294967295,S=x+(m<<14&4294967295|m>>>18),m=f+(x^v&(S^x))+C[8]+1163531501&4294967295,f=S+(m<<20&4294967295|m>>>12),m=v+(S^x&(f^S))+C[13]+2850285829&4294967295,v=f+(m<<5&4294967295|m>>>27),m=x+(f^S&(v^f))+C[2]+4243563512&4294967295,x=v+(m<<9&4294967295|m>>>23),m=S+(v^f&(x^v))+C[7]+1735328473&4294967295,S=x+(m<<14&4294967295|m>>>18),m=f+(x^v&(S^x))+C[12]+2368359562&4294967295,f=S+(m<<20&4294967295|m>>>12),m=v+(f^S^x)+C[5]+4294588738&4294967295,v=f+(m<<4&4294967295|m>>>28),m=x+(v^f^S)+C[8]+2272392833&4294967295,x=v+(m<<11&4294967295|m>>>21),m=S+(x^v^f)+C[11]+1839030562&4294967295,S=x+(m<<16&4294967295|m>>>16),m=f+(S^x^v)+C[14]+4259657740&4294967295,f=S+(m<<23&4294967295|m>>>9),m=v+(f^S^x)+C[1]+2763975236&4294967295,v=f+(m<<4&4294967295|m>>>28),m=x+(v^f^S)+C[4]+1272893353&4294967295,x=v+(m<<11&4294967295|m>>>21),m=S+(x^v^f)+C[7]+4139469664&4294967295,S=x+(m<<16&4294967295|m>>>16),m=f+(S^x^v)+C[10]+3200236656&4294967295,f=S+(m<<23&4294967295|m>>>9),m=v+(f^S^x)+C[13]+681279174&4294967295,v=f+(m<<4&4294967295|m>>>28),m=x+(v^f^S)+C[0]+3936430074&4294967295,x=v+(m<<11&4294967295|m>>>21),m=S+(x^v^f)+C[3]+3572445317&4294967295,S=x+(m<<16&4294967295|m>>>16),m=f+(S^x^v)+C[6]+76029189&4294967295,f=S+(m<<23&4294967295|m>>>9),m=v+(f^S^x)+C[9]+3654602809&4294967295,v=f+(m<<4&4294967295|m>>>28),m=x+(v^f^S)+C[12]+3873151461&4294967295,x=v+(m<<11&4294967295|m>>>21),m=S+(x^v^f)+C[15]+530742520&4294967295,S=x+(m<<16&4294967295|m>>>16),m=f+(S^x^v)+C[2]+3299628645&4294967295,f=S+(m<<23&4294967295|m>>>9),m=v+(S^(f|~x))+C[0]+4096336452&4294967295,v=f+(m<<6&4294967295|m>>>26),m=x+(f^(v|~S))+C[7]+1126891415&4294967295,x=v+(m<<10&4294967295|m>>>22),m=S+(v^(x|~f))+C[14]+2878612391&4294967295,S=x+(m<<15&4294967295|m>>>17),m=f+(x^(S|~v))+C[5]+4237533241&4294967295,f=S+(m<<21&4294967295|m>>>11),m=v+(S^(f|~x))+C[12]+1700485571&4294967295,v=f+(m<<6&4294967295|m>>>26),m=x+(f^(v|~S))+C[3]+2399980690&4294967295,x=v+(m<<10&4294967295|m>>>22),m=S+(v^(x|~f))+C[10]+4293915773&4294967295,S=x+(m<<15&4294967295|m>>>17),m=f+(x^(S|~v))+C[1]+2240044497&4294967295,f=S+(m<<21&4294967295|m>>>11),m=v+(S^(f|~x))+C[8]+1873313359&4294967295,v=f+(m<<6&4294967295|m>>>26),m=x+(f^(v|~S))+C[15]+4264355552&4294967295,x=v+(m<<10&4294967295|m>>>22),m=S+(v^(x|~f))+C[6]+2734768916&4294967295,S=x+(m<<15&4294967295|m>>>17),m=f+(x^(S|~v))+C[13]+1309151649&4294967295,f=S+(m<<21&4294967295|m>>>11),m=v+(S^(f|~x))+C[4]+4149444226&4294967295,v=f+(m<<6&4294967295|m>>>26),m=x+(f^(v|~S))+C[11]+3174756917&4294967295,x=v+(m<<10&4294967295|m>>>22),m=S+(v^(x|~f))+C[2]+718787259&4294967295,S=x+(m<<15&4294967295|m>>>17),m=f+(x^(S|~v))+C[9]+3951481745&4294967295,g.g[0]=g.g[0]+v&4294967295,g.g[1]=g.g[1]+(S+(m<<21&4294967295|m>>>11))&4294967295,g.g[2]=g.g[2]+S&4294967295,g.g[3]=g.g[3]+x&4294967295}n.prototype.u=function(g,v){v===void 0&&(v=g.length);for(var f=v-this.blockSize,C=this.B,S=this.h,x=0;x<v;){if(S==0)for(;x<=f;)o(this,g,x),x+=this.blockSize;if(typeof g=="string"){for(;x<v;)if(C[S++]=g.charCodeAt(x++),S==this.blockSize){o(this,C),S=0;break}}else for(;x<v;)if(C[S++]=g[x++],S==this.blockSize){o(this,C),S=0;break}}this.h=S,this.o+=v},n.prototype.v=function(){var g=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);g[0]=128;for(var v=1;v<g.length-8;++v)g[v]=0;var f=8*this.o;for(v=g.length-8;v<g.length;++v)g[v]=f&255,f/=256;for(this.u(g),g=Array(16),v=f=0;4>v;++v)for(var C=0;32>C;C+=8)g[f++]=this.g[v]>>>C&255;return g};function i(g,v){var f=c;return Object.prototype.hasOwnProperty.call(f,g)?f[g]:f[g]=v(g)}function a(g,v){this.h=v;for(var f=[],C=!0,S=g.length-1;0<=S;S--){var x=g[S]|0;C&&x==v||(f[S]=x,C=!1)}this.g=f}var c={};function u(g){return-128<=g&&128>g?i(g,function(v){return new a([v|0],0>v?-1:0)}):new a([g|0],0>g?-1:0)}function h(g){if(isNaN(g)||!isFinite(g))return b;if(0>g)return P(h(-g));for(var v=[],f=1,C=0;g>=f;C++)v[C]=g/f|0,f*=4294967296;return new a(v,0)}function y(g,v){if(g.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(g.charAt(0)=="-")return P(y(g.substring(1),v));if(0<=g.indexOf("-"))throw Error('number format error: interior "-" character');for(var f=h(Math.pow(v,8)),C=b,S=0;S<g.length;S+=8){var x=Math.min(8,g.length-S),m=parseInt(g.substring(S,S+x),v);8>x?(x=h(Math.pow(v,x)),C=C.j(x).add(h(m))):(C=C.j(f),C=C.add(h(m)))}return C}var b=u(0),_=u(1),A=u(16777216);t=a.prototype,t.m=function(){if(R(this))return-P(this).m();for(var g=0,v=1,f=0;f<this.g.length;f++){var C=this.i(f);g+=(0<=C?C:4294967296+C)*v,v*=4294967296}return g},t.toString=function(g){if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(E(this))return"0";if(R(this))return"-"+P(this).toString(g);for(var v=h(Math.pow(g,6)),f=this,C="";;){var S=O(f,v).g;f=k(f,S.j(v));var x=((0<f.g.length?f.g[0]:f.h)>>>0).toString(g);if(f=S,E(f))return x+C;for(;6>x.length;)x="0"+x;C=x+C}},t.i=function(g){return 0>g?0:g<this.g.length?this.g[g]:this.h};function E(g){if(g.h!=0)return!1;for(var v=0;v<g.g.length;v++)if(g.g[v]!=0)return!1;return!0}function R(g){return g.h==-1}t.l=function(g){return g=k(this,g),R(g)?-1:E(g)?0:1};function P(g){for(var v=g.g.length,f=[],C=0;C<v;C++)f[C]=~g.g[C];return new a(f,~g.h).add(_)}t.abs=function(){return R(this)?P(this):this},t.add=function(g){for(var v=Math.max(this.g.length,g.g.length),f=[],C=0,S=0;S<=v;S++){var x=C+(this.i(S)&65535)+(g.i(S)&65535),m=(x>>>16)+(this.i(S)>>>16)+(g.i(S)>>>16);C=m>>>16,x&=65535,m&=65535,f[S]=m<<16|x}return new a(f,f[f.length-1]&-2147483648?-1:0)};function k(g,v){return g.add(P(v))}t.j=function(g){if(E(this)||E(g))return b;if(R(this))return R(g)?P(this).j(P(g)):P(P(this).j(g));if(R(g))return P(this.j(P(g)));if(0>this.l(A)&&0>g.l(A))return h(this.m()*g.m());for(var v=this.g.length+g.g.length,f=[],C=0;C<2*v;C++)f[C]=0;for(C=0;C<this.g.length;C++)for(var S=0;S<g.g.length;S++){var x=this.i(C)>>>16,m=this.i(C)&65535,re=g.i(S)>>>16,Y=g.i(S)&65535;f[2*C+2*S]+=m*Y,K(f,2*C+2*S),f[2*C+2*S+1]+=x*Y,K(f,2*C+2*S+1),f[2*C+2*S+1]+=m*re,K(f,2*C+2*S+1),f[2*C+2*S+2]+=x*re,K(f,2*C+2*S+2)}for(C=0;C<v;C++)f[C]=f[2*C+1]<<16|f[2*C];for(C=v;C<2*v;C++)f[C]=0;return new a(f,0)};function K(g,v){for(;(g[v]&65535)!=g[v];)g[v+1]+=g[v]>>>16,g[v]&=65535,v++}function oe(g,v){this.g=g,this.h=v}function O(g,v){if(E(v))throw Error("division by zero");if(E(g))return new oe(b,b);if(R(g))return v=O(P(g),v),new oe(P(v.g),P(v.h));if(R(v))return v=O(g,P(v)),new oe(P(v.g),v.h);if(30<g.g.length){if(R(g)||R(v))throw Error("slowDivide_ only works with positive integers.");for(var f=_,C=v;0>=C.l(g);)f=M(f),C=M(C);var S=N(f,1),x=N(C,1);for(C=N(C,2),f=N(f,2);!E(C);){var m=x.add(C);0>=m.l(g)&&(S=S.add(f),x=m),C=N(C,1),f=N(f,1)}return v=k(g,S.j(v)),new oe(S,v)}for(S=b;0<=g.l(v);){for(f=Math.max(1,Math.floor(g.m()/v.m())),C=Math.ceil(Math.log(f)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),x=h(f),m=x.j(v);R(m)||0<m.l(g);)f-=C,x=h(f),m=x.j(v);E(x)&&(x=_),S=S.add(x),g=k(g,m)}return new oe(S,g)}t.A=function(g){return O(this,g).h},t.and=function(g){for(var v=Math.max(this.g.length,g.g.length),f=[],C=0;C<v;C++)f[C]=this.i(C)&g.i(C);return new a(f,this.h&g.h)},t.or=function(g){for(var v=Math.max(this.g.length,g.g.length),f=[],C=0;C<v;C++)f[C]=this.i(C)|g.i(C);return new a(f,this.h|g.h)},t.xor=function(g){for(var v=Math.max(this.g.length,g.g.length),f=[],C=0;C<v;C++)f[C]=this.i(C)^g.i(C);return new a(f,this.h^g.h)};function M(g){for(var v=g.g.length+1,f=[],C=0;C<v;C++)f[C]=g.i(C)<<1|g.i(C-1)>>>31;return new a(f,g.h)}function N(g,v){var f=v>>5;v%=32;for(var C=g.g.length-f,S=[],x=0;x<C;x++)S[x]=0<v?g.i(x+f)>>>v|g.i(x+f+1)<<32-v:g.i(x+f);return new a(S,g.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Yy=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=y,eo=a}).apply(typeof qu<"u"?qu:typeof self<"u"?self:typeof window<"u"?window:{});var Os=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ky,Vi,Qy,ia,lc,Jy,Xy,Zy;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,p,I){return l==Array.prototype||l==Object.prototype||(l[p]=I.value),l};function r(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Os=="object"&&Os];for(var p=0;p<l.length;++p){var I=l[p];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var n=r(this);function o(l,p){if(p)e:{var I=n;l=l.split(".");for(var J=0;J<l.length-1;J++){var Se=l[J];if(!(Se in I))break e;I=I[Se]}l=l[l.length-1],J=I[l],p=p(J),p!=J&&p!=null&&e(I,l,{configurable:!0,writable:!0,value:p})}}function i(l,p){l instanceof String&&(l+="");var I=0,J=!1,Se={next:function(){if(!J&&I<l.length){var Ae=I++;return{value:p(Ae,l[Ae]),done:!1}}return J=!0,{done:!0,value:void 0}}};return Se[Symbol.iterator]=function(){return Se},Se}o("Array.prototype.values",function(l){return l||function(){return i(this,function(p,I){return I})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},c=this||self;function u(l){var p=typeof l;return p=p!="object"?p:l?Array.isArray(l)?"array":p:"null",p=="array"||p=="object"&&typeof l.length=="number"}function h(l){var p=typeof l;return p=="object"&&l!=null||p=="function"}function y(l,p,I){return l.call.apply(l.bind,arguments)}function b(l,p,I){if(!l)throw Error();if(2<arguments.length){var J=Array.prototype.slice.call(arguments,2);return function(){var Se=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Se,J),l.apply(p,Se)}}return function(){return l.apply(p,arguments)}}function _(l,p,I){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?y:b,_.apply(null,arguments)}function A(l,p){var I=Array.prototype.slice.call(arguments,1);return function(){var J=I.slice();return J.push.apply(J,arguments),l.apply(this,J)}}function E(l,p){function I(){}I.prototype=p.prototype,l.aa=p.prototype,l.prototype=new I,l.prototype.constructor=l,l.Qb=function(J,Se,Ae){for(var Ue=Array(arguments.length-2),Ht=2;Ht<arguments.length;Ht++)Ue[Ht-2]=arguments[Ht];return p.prototype[Se].apply(J,Ue)}}function R(l){const p=l.length;if(0<p){const I=Array(p);for(let J=0;J<p;J++)I[J]=l[J];return I}return[]}function P(l,p){for(let I=1;I<arguments.length;I++){const J=arguments[I];if(u(J)){const Se=l.length||0,Ae=J.length||0;l.length=Se+Ae;for(let Ue=0;Ue<Ae;Ue++)l[Se+Ue]=J[Ue]}else l.push(J)}}class k{constructor(p,I){this.i=p,this.j=I,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function K(l){return/^[\s\xa0]*$/.test(l)}function oe(){var l=c.navigator;return l&&(l=l.userAgent)?l:""}function O(l){return O[" "](l),l}O[" "]=function(){};var M=oe().indexOf("Gecko")!=-1&&!(oe().toLowerCase().indexOf("webkit")!=-1&&oe().indexOf("Edge")==-1)&&!(oe().indexOf("Trident")!=-1||oe().indexOf("MSIE")!=-1)&&oe().indexOf("Edge")==-1;function N(l,p,I){for(const J in l)p.call(I,l[J],J,l)}function g(l,p){for(const I in l)p.call(void 0,l[I],I,l)}function v(l){const p={};for(const I in l)p[I]=l[I];return p}const f="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(l,p){let I,J;for(let Se=1;Se<arguments.length;Se++){J=arguments[Se];for(I in J)l[I]=J[I];for(let Ae=0;Ae<f.length;Ae++)I=f[Ae],Object.prototype.hasOwnProperty.call(J,I)&&(l[I]=J[I])}}function S(l){var p=1;l=l.split(":");const I=[];for(;0<p&&l.length;)I.push(l.shift()),p--;return l.length&&I.push(l.join(":")),I}function x(l){c.setTimeout(()=>{throw l},0)}function m(){var l=L;let p=null;return l.g&&(p=l.g,l.g=l.g.next,l.g||(l.h=null),p.next=null),p}class re{constructor(){this.h=this.g=null}add(p,I){const J=Y.get();J.set(p,I),this.h?this.h.next=J:this.g=J,this.h=J}}var Y=new k(()=>new $,l=>l.reset());class ${constructor(){this.next=this.g=this.h=null}set(p,I){this.h=p,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let V,Q=!1,L=new re,D=()=>{const l=c.Promise.resolve(void 0);V=()=>{l.then(j)}};var j=()=>{for(var l;l=m();){try{l.h.call(l.g)}catch(I){x(I)}var p=Y;p.j(l),100>p.h&&(p.h++,l.next=p.g,p.g=l)}Q=!1};function ue(){this.s=this.s,this.C=this.C}ue.prototype.s=!1,ue.prototype.ma=function(){this.s||(this.s=!0,this.N())},ue.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function W(l,p){this.type=l,this.g=this.target=p,this.defaultPrevented=!1}W.prototype.h=function(){this.defaultPrevented=!0};var ce=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var l=!1,p=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const I=()=>{};c.addEventListener("test",I,p),c.removeEventListener("test",I,p)}catch{}return l}();function T(l,p){if(W.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var I=this.type=l.type,J=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=p,p=l.relatedTarget){if(M){e:{try{O(p.nodeName);var Se=!0;break e}catch{}Se=!1}Se||(p=null)}}else I=="mouseover"?p=l.fromElement:I=="mouseout"&&(p=l.toElement);this.relatedTarget=p,J?(this.clientX=J.clientX!==void 0?J.clientX:J.pageX,this.clientY=J.clientY!==void 0?J.clientY:J.pageY,this.screenX=J.screenX||0,this.screenY=J.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:G[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&T.aa.h.call(this)}}E(T,W);var G={2:"touch",3:"pen",4:"mouse"};T.prototype.h=function(){T.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Z="closure_listenable_"+(1e6*Math.random()|0),F=0;function ne(l,p,I,J,Se){this.listener=l,this.proxy=null,this.src=p,this.type=I,this.capture=!!J,this.ha=Se,this.key=++F,this.da=this.fa=!1}function H(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function U(l){this.src=l,this.g={},this.h=0}U.prototype.add=function(l,p,I,J,Se){var Ae=l.toString();l=this.g[Ae],l||(l=this.g[Ae]=[],this.h++);var Ue=se(l,p,J,Se);return-1<Ue?(p=l[Ue],I||(p.fa=!1)):(p=new ne(p,this.src,Ae,!!J,Se),p.fa=I,l.push(p)),p};function ae(l,p){var I=p.type;if(I in l.g){var J=l.g[I],Se=Array.prototype.indexOf.call(J,p,void 0),Ae;(Ae=0<=Se)&&Array.prototype.splice.call(J,Se,1),Ae&&(H(p),l.g[I].length==0&&(delete l.g[I],l.h--))}}function se(l,p,I,J){for(var Se=0;Se<l.length;++Se){var Ae=l[Se];if(!Ae.da&&Ae.listener==p&&Ae.capture==!!I&&Ae.ha==J)return Se}return-1}var pe="closure_lm_"+(1e6*Math.random()|0),de={};function ye(l,p,I,J,Se){if(Array.isArray(p)){for(var Ae=0;Ae<p.length;Ae++)ye(l,p[Ae],I,J,Se);return null}return I=we(I),l&&l[Z]?l.K(p,I,h(J)?!!J.capture:!1,Se):X(l,p,I,!1,J,Se)}function X(l,p,I,J,Se,Ae){if(!p)throw Error("Invalid event type");var Ue=h(Se)?!!Se.capture:!!Se,Ht=te(l);if(Ht||(l[pe]=Ht=new U(l)),I=Ht.add(p,I,J,Ue,Ae),I.proxy)return I;if(J=ee(),I.proxy=J,J.src=l,J.listener=I,l.addEventListener)ce||(Se=Ue),Se===void 0&&(Se=!1),l.addEventListener(p.toString(),J,Se);else if(l.attachEvent)l.attachEvent(ve(p.toString()),J);else if(l.addListener&&l.removeListener)l.addListener(J);else throw Error("addEventListener and attachEvent are unavailable.");return I}function ee(){function l(I){return p.call(l.src,l.listener,I)}const p=B;return l}function q(l,p,I,J,Se){if(Array.isArray(p))for(var Ae=0;Ae<p.length;Ae++)q(l,p[Ae],I,J,Se);else J=h(J)?!!J.capture:!!J,I=we(I),l&&l[Z]?(l=l.i,p=String(p).toString(),p in l.g&&(Ae=l.g[p],I=se(Ae,I,J,Se),-1<I&&(H(Ae[I]),Array.prototype.splice.call(Ae,I,1),Ae.length==0&&(delete l.g[p],l.h--)))):l&&(l=te(l))&&(p=l.g[p.toString()],l=-1,p&&(l=se(p,I,J,Se)),(I=-1<l?p[l]:null)&&he(I))}function he(l){if(typeof l!="number"&&l&&!l.da){var p=l.src;if(p&&p[Z])ae(p.i,l);else{var I=l.type,J=l.proxy;p.removeEventListener?p.removeEventListener(I,J,l.capture):p.detachEvent?p.detachEvent(ve(I),J):p.addListener&&p.removeListener&&p.removeListener(J),(I=te(p))?(ae(I,l),I.h==0&&(I.src=null,p[pe]=null)):H(l)}}}function ve(l){return l in de?de[l]:de[l]="on"+l}function B(l,p){if(l.da)l=!0;else{p=new T(p,this);var I=l.listener,J=l.ha||l.src;l.fa&&he(l),l=I.call(J,p)}return l}function te(l){return l=l[pe],l instanceof U?l:null}var _e="__closure_events_fn_"+(1e9*Math.random()>>>0);function we(l){return typeof l=="function"?l:(l[_e]||(l[_e]=function(p){return l.handleEvent(p)}),l[_e])}function me(){ue.call(this),this.i=new U(this),this.M=this,this.F=null}E(me,ue),me.prototype[Z]=!0,me.prototype.removeEventListener=function(l,p,I,J){q(this,l,p,I,J)};function be(l,p){var I,J=l.F;if(J)for(I=[];J;J=J.F)I.push(J);if(l=l.M,J=p.type||p,typeof p=="string")p=new W(p,l);else if(p instanceof W)p.target=p.target||l;else{var Se=p;p=new W(J,l),C(p,Se)}if(Se=!0,I)for(var Ae=I.length-1;0<=Ae;Ae--){var Ue=p.g=I[Ae];Se=ie(Ue,J,!0,p)&&Se}if(Ue=p.g=l,Se=ie(Ue,J,!0,p)&&Se,Se=ie(Ue,J,!1,p)&&Se,I)for(Ae=0;Ae<I.length;Ae++)Ue=p.g=I[Ae],Se=ie(Ue,J,!1,p)&&Se}me.prototype.N=function(){if(me.aa.N.call(this),this.i){var l=this.i,p;for(p in l.g){for(var I=l.g[p],J=0;J<I.length;J++)H(I[J]);delete l.g[p],l.h--}}this.F=null},me.prototype.K=function(l,p,I,J){return this.i.add(String(l),p,!1,I,J)},me.prototype.L=function(l,p,I,J){return this.i.add(String(l),p,!0,I,J)};function ie(l,p,I,J){if(p=l.i.g[String(p)],!p)return!0;p=p.concat();for(var Se=!0,Ae=0;Ae<p.length;++Ae){var Ue=p[Ae];if(Ue&&!Ue.da&&Ue.capture==I){var Ht=Ue.listener,pr=Ue.ha||Ue.src;Ue.fa&&ae(l.i,Ue),Se=Ht.call(pr,J)!==!1&&Se}}return Se&&!J.defaultPrevented}function Pe(l,p,I){if(typeof l=="function")I&&(l=_(l,I));else if(l&&typeof l.handleEvent=="function")l=_(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:c.setTimeout(l,p||0)}function Te(l){l.g=Pe(()=>{l.g=null,l.i&&(l.i=!1,Te(l))},l.l);const p=l.h;l.h=null,l.m.apply(null,p)}class $e extends ue{constructor(p,I){super(),this.m=p,this.l=I,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:Te(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ee(l){ue.call(this),this.h=l,this.g={}}E(Ee,ue);var Ve=[];function Ke(l){N(l.g,function(p,I){this.g.hasOwnProperty(I)&&he(p)},l),l.g={}}Ee.prototype.N=function(){Ee.aa.N.call(this),Ke(this)},Ee.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var je=c.JSON.stringify,Ce=c.JSON.parse,Be=class{stringify(l){return c.JSON.stringify(l,void 0)}parse(l){return c.JSON.parse(l,void 0)}};function Je(){}Je.prototype.h=null;function Qe(l){return l.h||(l.h=l.i())}function We(){}var xe={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function at(){W.call(this,"d")}E(at,W);function et(){W.call(this,"c")}E(et,W);var bt={},ht=null;function Nt(){return ht=ht||new me}bt.La="serverreachability";function jt(l){W.call(this,bt.La,l)}E(jt,W);function Tt(l){const p=Nt();be(p,new jt(p))}bt.STAT_EVENT="statevent";function Bt(l,p){W.call(this,bt.STAT_EVENT,l),this.stat=p}E(Bt,W);function gt(l){const p=Nt();be(p,new Bt(p,l))}bt.Ma="timingevent";function er(l,p){W.call(this,bt.Ma,l),this.size=p}E(er,W);function Ie(l,p){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){l()},p)}function St(){this.g=!0}St.prototype.xa=function(){this.g=!1};function Oe(l,p,I,J,Se,Ae){l.info(function(){if(l.g)if(Ae)for(var Ue="",Ht=Ae.split("&"),pr=0;pr<Ht.length;pr++){var Mt=Ht[pr].split("=");if(1<Mt.length){var Sr=Mt[0];Mt=Mt[1];var wr=Sr.split("_");Ue=2<=wr.length&&wr[1]=="type"?Ue+(Sr+"="+Mt+"&"):Ue+(Sr+"=redacted&")}}else Ue=null;else Ue=Ae;return"XMLHTTP REQ ("+J+") [attempt "+Se+"]: "+p+`
`+I+`
`+Ue})}function Fe(l,p,I,J,Se,Ae,Ue){l.info(function(){return"XMLHTTP RESP ("+J+") [ attempt "+Se+"]: "+p+`
`+I+`
`+Ae+" "+Ue})}function Ze(l,p,I,J){l.info(function(){return"XMLHTTP TEXT ("+p+"): "+Ct(l,I)+(J?" "+J:"")})}function rt(l,p){l.info(function(){return"TIMEOUT: "+p})}St.prototype.info=function(){};function Ct(l,p){if(!l.g)return p;if(!p)return null;try{var I=JSON.parse(p);if(I){for(l=0;l<I.length;l++)if(Array.isArray(I[l])){var J=I[l];if(!(2>J.length)){var Se=J[1];if(Array.isArray(Se)&&!(1>Se.length)){var Ae=Se[0];if(Ae!="noop"&&Ae!="stop"&&Ae!="close")for(var Ue=1;Ue<Se.length;Ue++)Se[Ue]=""}}}}return je(I)}catch{return p}}var Xe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},lt={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},mt;function At(){}E(At,Je),At.prototype.g=function(){return new XMLHttpRequest},At.prototype.i=function(){return{}},mt=new At;function Me(l,p,I,J){this.j=l,this.i=p,this.l=I,this.R=J||1,this.U=new Ee(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Jt}function Jt(){this.i=null,this.g="",this.h=!1}var vt={},_t={};function kt(l,p,I){l.L=1,l.v=Fo(kr(p)),l.m=I,l.P=!0,yt(l,null)}function yt(l,p){l.F=Date.now(),Rt(l),l.A=kr(l.v);var I=l.A,J=l.R;Array.isArray(J)||(J=[String(J)]),Vd(I.i,"t",J),l.C=0,I=l.j.J,l.h=new Jt,l.g=ru(l.j,I?p:null,!l.m),0<l.O&&(l.M=new $e(_(l.Y,l,l.g),l.O)),p=l.U,I=l.g,J=l.ca;var Se="readystatechange";Array.isArray(Se)||(Se&&(Ve[0]=Se.toString()),Se=Ve);for(var Ae=0;Ae<Se.length;Ae++){var Ue=ye(I,Se[Ae],J||p.handleEvent,!1,p.h||p);if(!Ue)break;p.g[Ue.key]=Ue}p=l.H?v(l.H):{},l.m?(l.u||(l.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,p)):(l.u="GET",l.g.ea(l.A,l.u,null,p)),Tt(),Oe(l.i,l.u,l.A,l.l,l.R,l.m)}Me.prototype.ca=function(l){l=l.target;const p=this.M;p&&bn(l)==3?p.j():this.Y(l)},Me.prototype.Y=function(l){try{if(l==this.g)e:{const wr=bn(this.g);var p=this.g.Ba();const jo=this.g.Z();if(!(3>wr)&&(wr!=3||this.g&&(this.h.h||this.g.oa()||Gd(this.g)))){this.J||wr!=4||p==7||(p==8||0>=jo?Tt(3):Tt(2)),ur(this);var I=this.g.Z();this.X=I;t:if(Lt(this)){var J=Gd(this.g);l="";var Se=J.length,Ae=bn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){hr(this),Tr(this);var Ue="";break t}this.h.i=new c.TextDecoder}for(p=0;p<Se;p++)this.h.h=!0,l+=this.h.i.decode(J[p],{stream:!(Ae&&p==Se-1)});J.length=0,this.h.g+=l,this.C=0,Ue=this.h.g}else Ue=this.g.oa();if(this.o=I==200,Fe(this.i,this.u,this.A,this.l,this.R,wr,I),this.o){if(this.T&&!this.K){t:{if(this.g){var Ht,pr=this.g;if((Ht=pr.g?pr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(Ht)){var Mt=Ht;break t}}Mt=null}if(I=Mt)Ze(this.i,this.l,I,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,gn(this,I);else{this.o=!1,this.s=3,gt(12),hr(this),Tr(this);break e}}if(this.P){I=!0;let Yr;for(;!this.J&&this.C<Ue.length;)if(Yr=pt(this,Ue),Yr==_t){wr==4&&(this.s=4,gt(14),I=!1),Ze(this.i,this.l,null,"[Incomplete Response]");break}else if(Yr==vt){this.s=4,gt(15),Ze(this.i,this.l,Ue,"[Invalid Chunk]"),I=!1;break}else Ze(this.i,this.l,Yr,null),gn(this,Yr);if(Lt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),wr!=4||Ue.length!=0||this.h.h||(this.s=1,gt(16),I=!1),this.o=this.o&&I,!I)Ze(this.i,this.l,Ue,"[Invalid Chunked Response]"),hr(this),Tr(this);else if(0<Ue.length&&!this.W){this.W=!0;var Sr=this.j;Sr.g==this&&Sr.ba&&!Sr.M&&(Sr.j.info("Great, no buffering proxy detected. Bytes received: "+Ue.length),cl(Sr),Sr.M=!0,gt(11))}}else Ze(this.i,this.l,Ue,null),gn(this,Ue);wr==4&&hr(this),this.o&&!this.J&&(wr==4?Xd(this.j,this):(this.o=!1,Rt(this)))}else Kf(this.g),I==400&&0<Ue.indexOf("Unknown SID")?(this.s=3,gt(12)):(this.s=0,gt(13)),hr(this),Tr(this)}}}catch{}finally{}};function Lt(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function pt(l,p){var I=l.C,J=p.indexOf(`
`,I);return J==-1?_t:(I=Number(p.substring(I,J)),isNaN(I)?vt:(J+=1,J+I>p.length?_t:(p=p.slice(J,J+I),l.C=J+I,p)))}Me.prototype.cancel=function(){this.J=!0,hr(this)};function Rt(l){l.S=Date.now()+l.I,Xt(l,l.I)}function Xt(l,p){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Ie(_(l.ba,l),p)}function ur(l){l.B&&(c.clearTimeout(l.B),l.B=null)}Me.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(rt(this.i,this.A),this.L!=2&&(Tt(),gt(17)),hr(this),this.s=2,Tr(this)):Xt(this,this.S-l)};function Tr(l){l.j.G==0||l.J||Xd(l.j,l)}function hr(l){ur(l);var p=l.M;p&&typeof p.ma=="function"&&p.ma(),l.M=null,Ke(l.U),l.g&&(p=l.g,l.g=null,p.abort(),p.ma())}function gn(l,p){try{var I=l.j;if(I.G!=0&&(I.g==l||Vn(I.h,l))){if(!l.K&&Vn(I.h,l)&&I.G==3){try{var J=I.Da.g.parse(p)}catch{J=null}if(Array.isArray(J)&&J.length==3){var Se=J;if(Se[0]==0){e:if(!I.u){if(I.g)if(I.g.F+3e3<l.F)Rs(I),Ts(I);else break e;ll(I),gt(18)}}else I.za=Se[1],0<I.za-I.T&&37500>Se[2]&&I.F&&I.v==0&&!I.C&&(I.C=Ie(_(I.Za,I),6e3));if(1>=yo(I.h)&&I.ca){try{I.ca()}catch{}I.ca=void 0}}else po(I,11)}else if((l.K||I.g==l)&&Rs(I),!K(p))for(Se=I.Da.g.parse(p),p=0;p<Se.length;p++){let Mt=Se[p];if(I.T=Mt[0],Mt=Mt[1],I.G==2)if(Mt[0]=="c"){I.K=Mt[1],I.ia=Mt[2];const Sr=Mt[3];Sr!=null&&(I.la=Sr,I.j.info("VER="+I.la));const wr=Mt[4];wr!=null&&(I.Aa=wr,I.j.info("SVER="+I.Aa));const jo=Mt[5];jo!=null&&typeof jo=="number"&&0<jo&&(J=1.5*jo,I.L=J,I.j.info("backChannelRequestTimeoutMs_="+J)),J=I;const Yr=l.g;if(Yr){const Ns=Yr.g?Yr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ns){var Ae=J.h;Ae.g||Ns.indexOf("spdy")==-1&&Ns.indexOf("quic")==-1&&Ns.indexOf("h2")==-1||(Ae.j=Ae.l,Ae.g=new Set,Ae.h&&(Fn(Ae,Ae.h),Ae.h=null))}if(J.D){const dl=Yr.g?Yr.g.getResponseHeader("X-HTTP-Session-Id"):null;dl&&(J.ya=dl,Gt(J.I,J.D,dl))}}I.G=3,I.l&&I.l.ua(),I.ba&&(I.R=Date.now()-l.F,I.j.info("Handshake RTT: "+I.R+"ms")),J=I;var Ue=l;if(J.qa=tu(J,J.J?J.ia:null,J.W),Ue.K){As(J.h,Ue);var Ht=Ue,pr=J.L;pr&&(Ht.I=pr),Ht.B&&(ur(Ht),Rt(Ht)),J.g=Ue}else Qd(J);0<I.i.length&&ks(I)}else Mt[0]!="stop"&&Mt[0]!="close"||po(I,7);else I.G==3&&(Mt[0]=="stop"||Mt[0]=="close"?Mt[0]=="stop"?po(I,7):al(I):Mt[0]!="noop"&&I.l&&I.l.ta(Mt),I.v=0)}}Tt(4)}catch{}}var On=class{constructor(l,p){this.g=l,this.map=p}};function Vo(l){this.l=l||10,c.PerformanceNavigationTiming?(l=c.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function mo(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function yo(l){return l.h?1:l.g?l.g.size:0}function Vn(l,p){return l.h?l.h==p:l.g?l.g.has(p):!1}function Fn(l,p){l.g?l.g.add(p):l.h=p}function As(l,p){l.h&&l.h==p?l.h=null:l.g&&l.g.has(p)&&l.g.delete(p)}Vo.prototype.cancel=function(){if(this.i=wi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function wi(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let p=l.i;for(const I of l.g.values())p=p.concat(I.D);return p}return R(l.i)}function Pt(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var p=[],I=l.length,J=0;J<I;J++)p.push(l[J]);return p}p=[],I=0;for(J in l)p[I++]=l[J];return p}function qt(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var p=[];l=l.length;for(var I=0;I<l;I++)p.push(I);return p}p=[],I=0;for(const J in l)p[I++]=J;return p}}}function Pr(l,p){if(l.forEach&&typeof l.forEach=="function")l.forEach(p,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,p,void 0);else for(var I=qt(l),J=Pt(l),Se=J.length,Ae=0;Ae<Se;Ae++)p.call(void 0,J[Ae],I&&I[Ae],l)}var Wr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function vn(l,p){if(l){l=l.split("&");for(var I=0;I<l.length;I++){var J=l[I].indexOf("="),Se=null;if(0<=J){var Ae=l[I].substring(0,J);Se=l[I].substring(J+1)}else Ae=l[I];p(Ae,Se?decodeURIComponent(Se.replace(/\+/g," ")):"")}}}function Kt(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Kt){this.h=l.h,en(this,l.j),this.o=l.o,this.g=l.g,tn(this,l.s),this.l=l.l;var p=l.i,I=new xi;I.i=p.i,p.g&&(I.g=new Map(p.g),I.h=p.h),xs(this,I),this.m=l.m}else l&&(p=String(l).match(Wr))?(this.h=!1,en(this,p[1]||"",!0),this.o=Ci(p[2]||""),this.g=Ci(p[3]||"",!0),tn(this,p[4]),this.l=Ci(p[5]||"",!0),xs(this,p[6]||"",!0),this.m=Ci(p[7]||"")):(this.h=!1,this.i=new xi(null,this.h))}Kt.prototype.toString=function(){var l=[],p=this.j;p&&l.push(Ai(p,Ld,!0),":");var I=this.g;return(I||p=="file")&&(l.push("//"),(p=this.o)&&l.push(Ai(p,Ld,!0),"@"),l.push(encodeURIComponent(String(I)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.s,I!=null&&l.push(":",String(I))),(I=this.l)&&(this.g&&I.charAt(0)!="/"&&l.push("/"),l.push(Ai(I,I.charAt(0)=="/"?Ff:Vf,!0))),(I=this.i.toString())&&l.push("?",I),(I=this.m)&&l.push("#",Ai(I,Uf)),l.join("")};function kr(l){return new Kt(l)}function en(l,p,I){l.j=I?Ci(p,!0):p,l.j&&(l.j=l.j.replace(/:$/,""))}function tn(l,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);l.s=p}else l.s=null}function xs(l,p,I){p instanceof xi?(l.i=p,jf(l.i,l.h)):(I||(p=Ai(p,Bf)),l.i=new xi(p,l.h))}function Gt(l,p,I){l.i.set(p,I)}function Fo(l){return Gt(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function Ci(l,p){return l?p?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Ai(l,p,I){return typeof l=="string"?(l=encodeURI(l).replace(p,Of),I&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function Of(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Ld=/[#\/\?@]/g,Vf=/[#\?:]/g,Ff=/[#\?]/g,Bf=/[#\?@]/g,Uf=/#/g;function xi(l,p){this.h=this.g=null,this.i=l||null,this.j=!!p}function Bn(l){l.g||(l.g=new Map,l.h=0,l.i&&vn(l.i,function(p,I){l.add(decodeURIComponent(p.replace(/\+/g," ")),I)}))}t=xi.prototype,t.add=function(l,p){Bn(this),this.i=null,l=Bo(this,l);var I=this.g.get(l);return I||this.g.set(l,I=[]),I.push(p),this.h+=1,this};function Md(l,p){Bn(l),p=Bo(l,p),l.g.has(p)&&(l.i=null,l.h-=l.g.get(p).length,l.g.delete(p))}function Od(l,p){return Bn(l),p=Bo(l,p),l.g.has(p)}t.forEach=function(l,p){Bn(this),this.g.forEach(function(I,J){I.forEach(function(Se){l.call(p,Se,J,this)},this)},this)},t.na=function(){Bn(this);const l=Array.from(this.g.values()),p=Array.from(this.g.keys()),I=[];for(let J=0;J<p.length;J++){const Se=l[J];for(let Ae=0;Ae<Se.length;Ae++)I.push(p[J])}return I},t.V=function(l){Bn(this);let p=[];if(typeof l=="string")Od(this,l)&&(p=p.concat(this.g.get(Bo(this,l))));else{l=Array.from(this.g.values());for(let I=0;I<l.length;I++)p=p.concat(l[I])}return p},t.set=function(l,p){return Bn(this),this.i=null,l=Bo(this,l),Od(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[p]),this.h+=1,this},t.get=function(l,p){return l?(l=this.V(l),0<l.length?String(l[0]):p):p};function Vd(l,p,I){Md(l,p),0<I.length&&(l.i=null,l.g.set(Bo(l,p),R(I)),l.h+=I.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],p=Array.from(this.g.keys());for(var I=0;I<p.length;I++){var J=p[I];const Ae=encodeURIComponent(String(J)),Ue=this.V(J);for(J=0;J<Ue.length;J++){var Se=Ae;Ue[J]!==""&&(Se+="="+encodeURIComponent(String(Ue[J]))),l.push(Se)}}return this.i=l.join("&")};function Bo(l,p){return p=String(p),l.j&&(p=p.toLowerCase()),p}function jf(l,p){p&&!l.j&&(Bn(l),l.i=null,l.g.forEach(function(I,J){var Se=J.toLowerCase();J!=Se&&(Md(this,J),Vd(this,Se,I))},l)),l.j=p}function zf(l,p){const I=new St;if(c.Image){const J=new Image;J.onload=A(Un,I,"TestLoadImage: loaded",!0,p,J),J.onerror=A(Un,I,"TestLoadImage: error",!1,p,J),J.onabort=A(Un,I,"TestLoadImage: abort",!1,p,J),J.ontimeout=A(Un,I,"TestLoadImage: timeout",!1,p,J),c.setTimeout(function(){J.ontimeout&&J.ontimeout()},1e4),J.src=l}else p(!1)}function qf(l,p){const I=new St,J=new AbortController,Se=setTimeout(()=>{J.abort(),Un(I,"TestPingServer: timeout",!1,p)},1e4);fetch(l,{signal:J.signal}).then(Ae=>{clearTimeout(Se),Ae.ok?Un(I,"TestPingServer: ok",!0,p):Un(I,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(Se),Un(I,"TestPingServer: error",!1,p)})}function Un(l,p,I,J,Se){try{Se&&(Se.onload=null,Se.onerror=null,Se.onabort=null,Se.ontimeout=null),J(I)}catch{}}function Gf(){this.g=new Be}function Hf(l,p,I){const J=I||"";try{Pr(l,function(Se,Ae){let Ue=Se;h(Se)&&(Ue=je(Se)),p.push(J+Ae+"="+encodeURIComponent(Ue))})}catch(Se){throw p.push(J+"type="+encodeURIComponent("_badmap")),Se}}function Is(l){this.l=l.Ub||null,this.j=l.eb||!1}E(Is,Je),Is.prototype.g=function(){return new $s(this.l,this.j)},Is.prototype.i=function(l){return function(){return l}}({});function $s(l,p){me.call(this),this.D=l,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E($s,me),t=$s.prototype,t.open=function(l,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=p,this.readyState=1,$i(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(p.body=l),(this.D||c).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ii(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,$i(this)),this.g&&(this.readyState=3,$i(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Fd(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function Fd(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var p=l.value?l.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!l.done}))&&(this.response=this.responseText+=p)}l.done?Ii(this):$i(this),this.readyState==3&&Fd(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,Ii(this))},t.Qa=function(l){this.g&&(this.response=l,Ii(this))},t.ga=function(){this.g&&Ii(this)};function Ii(l){l.readyState=4,l.l=null,l.j=null,l.v=null,$i(l)}t.setRequestHeader=function(l,p){this.u.append(l,p)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],p=this.h.entries();for(var I=p.next();!I.done;)I=I.value,l.push(I[0]+": "+I[1]),I=p.next();return l.join(`\r
`)};function $i(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty($s.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Bd(l){let p="";return N(l,function(I,J){p+=J,p+=":",p+=I,p+=`\r
`}),p}function sl(l,p,I){e:{for(J in I){var J=!1;break e}J=!0}J||(I=Bd(I),typeof l=="string"?I!=null&&encodeURIComponent(String(I)):Gt(l,p,I))}function tr(l){me.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(tr,me);var Wf=/^https?$/i,Yf=["POST","PUT"];t=tr.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,p,I,J){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);p=p?p.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():mt.g(),this.v=this.o?Qe(this.o):Qe(mt),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(p,String(l),!0),this.B=!1}catch(Ae){Ud(this,Ae);return}if(l=I||"",I=new Map(this.headers),J)if(Object.getPrototypeOf(J)===Object.prototype)for(var Se in J)I.set(Se,J[Se]);else if(typeof J.keys=="function"&&typeof J.get=="function")for(const Ae of J.keys())I.set(Ae,J.get(Ae));else throw Error("Unknown input type for opt_headers: "+String(J));J=Array.from(I.keys()).find(Ae=>Ae.toLowerCase()=="content-type"),Se=c.FormData&&l instanceof c.FormData,!(0<=Array.prototype.indexOf.call(Yf,p,void 0))||J||Se||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ae,Ue]of I)this.g.setRequestHeader(Ae,Ue);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{qd(this),this.u=!0,this.g.send(l),this.u=!1}catch(Ae){Ud(this,Ae)}};function Ud(l,p){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=p,l.m=5,jd(l),Es(l)}function jd(l){l.A||(l.A=!0,be(l,"complete"),be(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,be(this,"complete"),be(this,"abort"),Es(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Es(this,!0)),tr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?zd(this):this.bb())},t.bb=function(){zd(this)};function zd(l){if(l.h&&typeof a<"u"&&(!l.v[1]||bn(l)!=4||l.Z()!=2)){if(l.u&&bn(l)==4)Pe(l.Ea,0,l);else if(be(l,"readystatechange"),bn(l)==4){l.h=!1;try{const Ue=l.Z();e:switch(Ue){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var I;if(!(I=p)){var J;if(J=Ue===0){var Se=String(l.D).match(Wr)[1]||null;!Se&&c.self&&c.self.location&&(Se=c.self.location.protocol.slice(0,-1)),J=!Wf.test(Se?Se.toLowerCase():"")}I=J}if(I)be(l,"complete"),be(l,"success");else{l.m=6;try{var Ae=2<bn(l)?l.g.statusText:""}catch{Ae=""}l.l=Ae+" ["+l.Z()+"]",jd(l)}}finally{Es(l)}}}}function Es(l,p){if(l.g){qd(l);const I=l.g,J=l.v[0]?()=>{}:null;l.g=null,l.v=null,p||be(l,"ready");try{I.onreadystatechange=J}catch{}}}function qd(l){l.I&&(c.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function bn(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<bn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var p=this.g.responseText;return l&&p.indexOf(l)==0&&(p=p.substring(l.length)),Ce(p)}};function Gd(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function Kf(l){const p={};l=(l.g&&2<=bn(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let J=0;J<l.length;J++){if(K(l[J]))continue;var I=S(l[J]);const Se=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const Ae=p[Se]||[];p[Se]=Ae,Ae.push(I)}g(p,function(J){return J.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ei(l,p,I){return I&&I.internalChannelParams&&I.internalChannelParams[l]||p}function Hd(l){this.Aa=0,this.i=[],this.j=new St,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ei("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ei("baseRetryDelayMs",5e3,l),this.cb=Ei("retryDelaySeedMs",1e4,l),this.Wa=Ei("forwardChannelMaxRetries",2,l),this.wa=Ei("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new Vo(l&&l.concurrentRequestLimit),this.Da=new Gf,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Hd.prototype,t.la=8,t.G=1,t.connect=function(l,p,I,J){gt(0),this.W=l,this.H=p||{},I&&J!==void 0&&(this.H.OSID=I,this.H.OAID=J),this.F=this.X,this.I=tu(this,null,this.W),ks(this)};function al(l){if(Wd(l),l.G==3){var p=l.U++,I=kr(l.I);if(Gt(I,"SID",l.K),Gt(I,"RID",p),Gt(I,"TYPE","terminate"),Ti(l,I),p=new Me(l,l.j,p),p.L=2,p.v=Fo(kr(I)),I=!1,c.navigator&&c.navigator.sendBeacon)try{I=c.navigator.sendBeacon(p.v.toString(),"")}catch{}!I&&c.Image&&(new Image().src=p.v,I=!0),I||(p.g=ru(p.j,null),p.g.ea(p.v)),p.F=Date.now(),Rt(p)}eu(l)}function Ts(l){l.g&&(cl(l),l.g.cancel(),l.g=null)}function Wd(l){Ts(l),l.u&&(c.clearTimeout(l.u),l.u=null),Rs(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&c.clearTimeout(l.s),l.s=null)}function ks(l){if(!mo(l.h)&&!l.s){l.s=!0;var p=l.Ga;V||D(),Q||(V(),Q=!0),L.add(p,l),l.B=0}}function Qf(l,p){return yo(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=p.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Ie(_(l.Ga,l,p),Zd(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const Se=new Me(this,this.j,l);let Ae=this.o;if(this.S&&(Ae?(Ae=v(Ae),C(Ae,this.S)):Ae=this.S),this.m!==null||this.O||(Se.H=Ae,Ae=null),this.P)e:{for(var p=0,I=0;I<this.i.length;I++){t:{var J=this.i[I];if("__data__"in J.map&&(J=J.map.__data__,typeof J=="string")){J=J.length;break t}J=void 0}if(J===void 0)break;if(p+=J,4096<p){p=I;break e}if(p===4096||I===this.i.length-1){p=I+1;break e}}p=1e3}else p=1e3;p=Kd(this,Se,p),I=kr(this.I),Gt(I,"RID",l),Gt(I,"CVER",22),this.D&&Gt(I,"X-HTTP-Session-Id",this.D),Ti(this,I),Ae&&(this.O?p="headers="+encodeURIComponent(String(Bd(Ae)))+"&"+p:this.m&&sl(I,this.m,Ae)),Fn(this.h,Se),this.Ua&&Gt(I,"TYPE","init"),this.P?(Gt(I,"$req",p),Gt(I,"SID","null"),Se.T=!0,kt(Se,I,null)):kt(Se,I,p),this.G=2}}else this.G==3&&(l?Yd(this,l):this.i.length==0||mo(this.h)||Yd(this))};function Yd(l,p){var I;p?I=p.l:I=l.U++;const J=kr(l.I);Gt(J,"SID",l.K),Gt(J,"RID",I),Gt(J,"AID",l.T),Ti(l,J),l.m&&l.o&&sl(J,l.m,l.o),I=new Me(l,l.j,I,l.B+1),l.m===null&&(I.H=l.o),p&&(l.i=p.D.concat(l.i)),p=Kd(l,I,1e3),I.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Fn(l.h,I),kt(I,J,p)}function Ti(l,p){l.H&&N(l.H,function(I,J){Gt(p,J,I)}),l.l&&Pr({},function(I,J){Gt(p,J,I)})}function Kd(l,p,I){I=Math.min(l.i.length,I);var J=l.l?_(l.l.Na,l.l,l):null;e:{var Se=l.i;let Ae=-1;for(;;){const Ue=["count="+I];Ae==-1?0<I?(Ae=Se[0].g,Ue.push("ofs="+Ae)):Ae=0:Ue.push("ofs="+Ae);let Ht=!0;for(let pr=0;pr<I;pr++){let Mt=Se[pr].g;const Sr=Se[pr].map;if(Mt-=Ae,0>Mt)Ae=Math.max(0,Se[pr].g-100),Ht=!1;else try{Hf(Sr,Ue,"req"+Mt+"_")}catch{J&&J(Sr)}}if(Ht){J=Ue.join("&");break e}}}return l=l.i.splice(0,I),p.D=l,J}function Qd(l){if(!l.g&&!l.u){l.Y=1;var p=l.Fa;V||D(),Q||(V(),Q=!0),L.add(p,l),l.v=0}}function ll(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Ie(_(l.Fa,l),Zd(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Jd(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Ie(_(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,gt(10),Ts(this),Jd(this))};function cl(l){l.A!=null&&(c.clearTimeout(l.A),l.A=null)}function Jd(l){l.g=new Me(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var p=kr(l.qa);Gt(p,"RID","rpc"),Gt(p,"SID",l.K),Gt(p,"AID",l.T),Gt(p,"CI",l.F?"0":"1"),!l.F&&l.ja&&Gt(p,"TO",l.ja),Gt(p,"TYPE","xmlhttp"),Ti(l,p),l.m&&l.o&&sl(p,l.m,l.o),l.L&&(l.g.I=l.L);var I=l.g;l=l.ia,I.L=1,I.v=Fo(kr(p)),I.m=null,I.P=!0,yt(I,l)}t.Za=function(){this.C!=null&&(this.C=null,Ts(this),ll(this),gt(19))};function Rs(l){l.C!=null&&(c.clearTimeout(l.C),l.C=null)}function Xd(l,p){var I=null;if(l.g==p){Rs(l),cl(l),l.g=null;var J=2}else if(Vn(l.h,p))I=p.D,As(l.h,p),J=1;else return;if(l.G!=0){if(p.o)if(J==1){I=p.m?p.m.length:0,p=Date.now()-p.F;var Se=l.B;J=Nt(),be(J,new er(J,I)),ks(l)}else Qd(l);else if(Se=p.s,Se==3||Se==0&&0<p.X||!(J==1&&Qf(l,p)||J==2&&ll(l)))switch(I&&0<I.length&&(p=l.h,p.i=p.i.concat(I)),Se){case 1:po(l,5);break;case 4:po(l,10);break;case 3:po(l,6);break;default:po(l,2)}}}function Zd(l,p){let I=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(I*=2),I*p}function po(l,p){if(l.j.info("Error code "+p),p==2){var I=_(l.fb,l),J=l.Xa;const Se=!J;J=new Kt(J||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||en(J,"https"),Fo(J),Se?zf(J.toString(),I):qf(J.toString(),I)}else gt(2);l.G=0,l.l&&l.l.sa(p),eu(l),Wd(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),gt(2)):(this.j.info("Failed to ping google.com"),gt(1))};function eu(l){if(l.G=0,l.ka=[],l.l){const p=wi(l.h);(p.length!=0||l.i.length!=0)&&(P(l.ka,p),P(l.ka,l.i),l.h.i.length=0,R(l.i),l.i.length=0),l.l.ra()}}function tu(l,p,I){var J=I instanceof Kt?kr(I):new Kt(I);if(J.g!="")p&&(J.g=p+"."+J.g),tn(J,J.s);else{var Se=c.location;J=Se.protocol,p=p?p+"."+Se.hostname:Se.hostname,Se=+Se.port;var Ae=new Kt(null);J&&en(Ae,J),p&&(Ae.g=p),Se&&tn(Ae,Se),I&&(Ae.l=I),J=Ae}return I=l.D,p=l.ya,I&&p&&Gt(J,I,p),Gt(J,"VER",l.la),Ti(l,J),J}function ru(l,p,I){if(p&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=l.Ca&&!l.pa?new tr(new Is({eb:I})):new tr(l.pa),p.Ha(l.J),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function nu(){}t=nu.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Ds(){}Ds.prototype.g=function(l,p){return new Mr(l,p)};function Mr(l,p){me.call(this),this.g=new Hd(p),this.l=l,this.h=p&&p.messageUrlParams||null,l=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(l?l["X-WebChannel-Content-Type"]=p.messageContentType:l={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(l?l["X-WebChannel-Client-Profile"]=p.va:l={"X-WebChannel-Client-Profile":p.va}),this.g.S=l,(l=p&&p.Sb)&&!K(l)&&(this.g.m=l),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!K(p)&&(this.g.D=p,l=this.h,l!==null&&p in l&&(l=this.h,p in l&&delete l[p])),this.j=new Uo(this)}E(Mr,me),Mr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Mr.prototype.close=function(){al(this.g)},Mr.prototype.o=function(l){var p=this.g;if(typeof l=="string"){var I={};I.__data__=l,l=I}else this.u&&(I={},I.__data__=je(l),l=I);p.i.push(new On(p.Ya++,l)),p.G==3&&ks(p)},Mr.prototype.N=function(){this.g.l=null,delete this.j,al(this.g),delete this.g,Mr.aa.N.call(this)};function ou(l){at.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var p=l.__sm__;if(p){e:{for(const I in p){l=I;break e}l=void 0}(this.i=l)&&(l=this.i,p=p!==null&&l in p?p[l]:void 0),this.data=p}else this.data=l}E(ou,at);function iu(){et.call(this),this.status=1}E(iu,et);function Uo(l){this.g=l}E(Uo,nu),Uo.prototype.ua=function(){be(this.g,"a")},Uo.prototype.ta=function(l){be(this.g,new ou(l))},Uo.prototype.sa=function(l){be(this.g,new iu)},Uo.prototype.ra=function(){be(this.g,"b")},Ds.prototype.createWebChannel=Ds.prototype.g,Mr.prototype.send=Mr.prototype.o,Mr.prototype.open=Mr.prototype.m,Mr.prototype.close=Mr.prototype.close,Zy=function(){return new Ds},Xy=function(){return Nt()},Jy=bt,lc={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Xe.NO_ERROR=0,Xe.TIMEOUT=8,Xe.HTTP_ERROR=6,ia=Xe,lt.COMPLETE="complete",Qy=lt,We.EventType=xe,xe.OPEN="a",xe.CLOSE="b",xe.ERROR="c",xe.MESSAGE="d",me.prototype.listen=me.prototype.K,Vi=We,tr.prototype.listenOnce=tr.prototype.L,tr.prototype.getLastError=tr.prototype.Ka,tr.prototype.getLastErrorCode=tr.prototype.Ba,tr.prototype.getStatus=tr.prototype.Z,tr.prototype.getResponseJson=tr.prototype.Oa,tr.prototype.getResponseText=tr.prototype.oa,tr.prototype.send=tr.prototype.ea,tr.prototype.setWithCredentials=tr.prototype.Ha,Ky=tr}).apply(typeof Os<"u"?Os:typeof self<"u"?self:typeof window<"u"?window:{});const Gu="@firebase/firestore",Hu="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}xr.UNAUTHENTICATED=new xr(null),xr.GOOGLE_CREDENTIALS=new xr("google-credentials-uid"),xr.FIRST_PARTY=new xr("first-party-uid"),xr.MOCK_USER=new xr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vi="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ro=new Mc("@firebase/firestore");function Ko(){return Ro.logLevel}function Ye(t,...e){if(Ro.logLevel<=It.DEBUG){const r=e.map(Kc);Ro.debug(`Firestore (${vi}): ${t}`,...r)}}function kn(t,...e){if(Ro.logLevel<=It.ERROR){const r=e.map(Kc);Ro.error(`Firestore (${vi}): ${t}`,...r)}}function li(t,...e){if(Ro.logLevel<=It.WARN){const r=e.map(Kc);Ro.warn(`Firestore (${vi}): ${t}`,...r)}}function Kc(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ot(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,ep(t,n,r)}function ep(t,e,r){let n=`FIRESTORE (${vi}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw kn(n),new Error(n)}function Ut(t,e,r,n){let o="Unexpected state";typeof r=="string"?o=r:n=r,t||ep(e,o,n)}function ut(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ke={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class He extends Mn{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class tP{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(xr.UNAUTHENTICATED))}shutdown(){}}class rP{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class nP{constructor(e){this.t=e,this.currentUser=xr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Ut(this.o===void 0,42304);let n=this.i;const o=u=>this.i!==n?(n=this.i,r(u)):Promise.resolve();let i=new $n;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new $n,e.enqueueRetryable(()=>o(this.currentUser))};const a=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await o(this.currentUser)})},c=u=>{Ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(Ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new $n)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Ut(typeof n.accessToken=="string",31837,{l:n}),new tp(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ut(e===null||typeof e=="string",2055,{h:e}),new xr(e)}}class oP{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=xr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class iP{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new oP(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(xr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Wu{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class sP{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,zr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Ut(this.o===void 0,3512);const n=i=>{i.error!=null&&Ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,Ye("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const o=i=>{Ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>o(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?o(i):Ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Wu(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Ut(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new Wu(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aP(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const o=aP(40);for(let i=0;i<o.length;++i)n.length<20&&o[i]<r&&(n+=e.charAt(o[i]%62))}return n}}function $t(t,e){return t<e?-1:t>e?1:0}function cc(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const o=t.charAt(n),i=e.charAt(n);if(o!==i)return wl(o)===wl(i)?$t(o,i):wl(o)?1:-1}return $t(t.length,e.length)}const lP=55296,cP=57343;function wl(t){const e=t.charCodeAt(0);return e>=lP&&e<=cP}function ci(t,e,r){return t.length===e.length&&t.every((n,o)=>r(n,e[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yu="__name__";class sn{constructor(e,r,n){r===void 0?r=0:r>e.length&&ot(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&ot(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return sn.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof sn?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let o=0;o<n;o++){const i=sn.compareSegments(e.get(o),r.get(o));if(i!==0)return i}return $t(e.length,r.length)}static compareSegments(e,r){const n=sn.isNumericId(e),o=sn.isNumericId(r);return n&&!o?-1:!n&&o?1:n&&o?sn.extractNumericId(e).compare(sn.extractNumericId(r)):cc(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return eo.fromString(e.substring(4,e.length-2))}}class Yt extends sn{construct(e,r,n){return new Yt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new He(ke.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(o=>o.length>0))}return new Yt(r)}static emptyPath(){return new Yt([])}}const dP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class gr extends sn{construct(e,r,n){return new gr(e,r,n)}static isValidIdentifier(e){return dP.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),gr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Yu}static keyField(){return new gr([Yu])}static fromServerFormat(e){const r=[];let n="",o=0;const i=()=>{if(n.length===0)throw new He(ke.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;o<e.length;){const c=e[o];if(c==="\\"){if(o+1===e.length)throw new He(ke.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[o+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new He(ke.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,o+=2}else c==="`"?(a=!a,o++):c!=="."||a?(n+=c,o++):(i(),o++)}if(i(),a)throw new He(ke.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new gr(r)}static emptyPath(){return new gr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e){this.path=e}static fromPath(e){return new tt(Yt.fromString(e))}static fromName(e){return new tt(Yt.fromString(e).popFirst(5))}static empty(){return new tt(Yt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Yt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Yt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new tt(new Yt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rp(t,e,r){if(!r)throw new He(ke.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function uP(t,e,r,n){if(e===!0&&n===!0)throw new He(ke.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function Ku(t){if(!tt.isDocumentKey(t))throw new He(ke.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Qu(t){if(tt.isDocumentKey(t))throw new He(ke.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function np(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Ga(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ot(12329,{type:typeof t})}function Rn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new He(ke.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Ga(t);throw new He(ke.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lr(t,e){const r={typeString:t};return e&&(r.value=e),r}function vs(t,e){if(!np(t))throw new He(ke.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const o=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const a=t[n];if(o&&typeof a!==o){r=`JSON field '${n}' must be a ${o}.`;break}if(i!==void 0&&a!==i.value){r=`Expected '${n}' field to equal '${i.value}'`;break}}if(r)throw new He(ke.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ju=-62135596800,Xu=1e6;class Qt{static now(){return Qt.fromMillis(Date.now())}static fromDate(e){return Qt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*Xu);return new Qt(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new He(ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new He(ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<Ju)throw new He(ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new He(ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Xu}_compareTo(e){return this.seconds===e.seconds?$t(this.nanoseconds,e.nanoseconds):$t(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Qt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(vs(e,Qt._jsonSchema))return new Qt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Ju;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Qt._jsonSchemaVersion="firestore/timestamp/1.0",Qt._jsonSchema={type:lr("string",Qt._jsonSchemaVersion),seconds:lr("number"),nanoseconds:lr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{static fromTimestamp(e){return new dt(e)}static min(){return new dt(new Qt(0,0))}static max(){return new dt(new Qt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const os=-1;function hP(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,o=dt.fromTimestamp(n===1e9?new Qt(r+1,0):new Qt(r,n));return new ro(o,tt.empty(),e)}function mP(t){return new ro(t.readTime,t.key,os)}class ro{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new ro(dt.min(),tt.empty(),os)}static max(){return new ro(dt.max(),tt.empty(),os)}}function yP(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=tt.comparator(t.documentKey,e.documentKey),r!==0?r:$t(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pP="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class fP{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bi(t){if(t.code!==ke.FAILED_PRECONDITION||t.message!==pP)throw t;Ye("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ot(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Ne((n,o)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,o)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,o)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Ne?r:Ne.resolve(r)}catch(r){return Ne.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Ne.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Ne.reject(r)}static resolve(e){return new Ne((r,n)=>{r(e)})}static reject(e){return new Ne((r,n)=>{n(e)})}static waitFor(e){return new Ne((r,n)=>{let o=0,i=0,a=!1;e.forEach(c=>{++o,c.next(()=>{++i,a&&i===o&&r()},u=>n(u))}),a=!0,i===o&&r()})}static or(e){let r=Ne.resolve(!1);for(const n of e)r=r.next(o=>o?Ne.resolve(o):n());return r}static forEach(e,r){const n=[];return e.forEach((o,i)=>{n.push(r.call(this,o,i))}),this.waitFor(n)}static mapArray(e,r){return new Ne((n,o)=>{const i=e.length,a=new Array(i);let c=0;for(let u=0;u<i;u++){const h=u;r(e[h]).next(y=>{a[h]=y,++c,c===i&&n(a)},y=>o(y))}})}static doWhile(e,r){return new Ne((n,o)=>{const i=()=>{e()===!0?r().next(()=>{i()},o):n()};i()})}}function gP(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function _i(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ha.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jc=-1;function Wa(t){return t==null}function xa(t){return t===0&&1/t==-1/0}function vP(t){return typeof t=="number"&&Number.isInteger(t)&&!xa(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const op="";function bP(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=Zu(e)),e=_P(t.get(r),e);return Zu(e)}function _P(t,e){let r=e;const n=t.length;for(let o=0;o<n;o++){const i=t.charAt(o);switch(i){case"\0":r+="";break;case op:r+="";break;default:r+=i}}return r}function Zu(t){return t+op+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eh(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function uo(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function ip(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e,r){this.comparator=e,this.root=r||fr.EMPTY}insert(e,r){return new Zt(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,fr.BLACK,null,null))}remove(e){return new Zt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,fr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const o=this.comparator(e,n.key);if(o===0)return r+n.left.size;o<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vs(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vs(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vs(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vs(this.root,e,this.comparator,!0)}}class Vs{constructor(e,r,n,o){this.isReverse=o,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&o&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class fr{constructor(e,r,n,o,i){this.key=e,this.value=r,this.color=n??fr.RED,this.left=o??fr.EMPTY,this.right=i??fr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,o,i){return new fr(e??this.key,r??this.value,n??this.color,o??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let o=this;const i=n(e,o.key);return o=i<0?o.copy(null,null,null,o.left.insert(e,r,n),null):i===0?o.copy(null,r,null,null,null):o.copy(null,null,null,null,o.right.insert(e,r,n)),o.fixUp()}removeMin(){if(this.left.isEmpty())return fr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,o=this;if(r(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,r),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),r(e,o.key)===0){if(o.right.isEmpty())return fr.EMPTY;n=o.right.min(),o=o.copy(n.key,n.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,r))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,fr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,fr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ot(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ot(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ot(27949);return e+(this.isRed()?0:1)}}fr.EMPTY=null,fr.RED=!0,fr.BLACK=!1;fr.EMPTY=new class{constructor(){this.size=0}get key(){throw ot(57766)}get value(){throw ot(16141)}get color(){throw ot(16727)}get left(){throw ot(29726)}get right(){throw ot(36894)}copy(e,r,n,o,i){return this}insert(e,r,n){return new fr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e){this.comparator=e,this.data=new Zt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const o=n.getNext();if(this.comparator(o.key,e[1])>=0)return;r(o.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new th(this.data.getIterator())}getIteratorFrom(e){return new th(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof dr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const o=r.getNext().key,i=n.getNext().key;if(this.comparator(o,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new dr(this.comparator);return r.data=e,r}}class th{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e){this.fields=e,e.sort(gr.comparator)}static empty(){return new Fr([])}unionWith(e){let r=new dr(gr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Fr(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return ci(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(o){try{return atob(o)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new sp("Invalid base64 string: "+i):i}}(e);return new _r(r)}static fromUint8Array(e){const r=function(o){let i="";for(let a=0;a<o.length;++a)i+=String.fromCharCode(o[a]);return i}(e);return new _r(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let o=0;o<r.length;o++)n[o]=r.charCodeAt(o);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $t(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}_r.EMPTY_BYTE_STRING=new _r("");const PP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function no(t){if(Ut(!!t,39018),typeof t=="string"){let e=0;const r=PP.exec(t);if(Ut(!!r,46558,{timestamp:t}),r[1]){let o=r[1];o=(o+"000000000").substr(0,9),e=Number(o)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:rr(t.seconds),nanos:rr(t.nanos)}}function rr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function oo(t){return typeof t=="string"?_r.fromBase64String(t):_r.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ap="server_timestamp",lp="__type__",cp="__previous_value__",dp="__local_write_time__";function Xc(t){return(t?.mapValue?.fields||{})[lp]?.stringValue===ap}function Ya(t){const e=t.mapValue.fields[cp];return Xc(e)?Ya(e):e}function is(t){const e=no(t.mapValue.fields[dp].timestampValue);return new Qt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SP{constructor(e,r,n,o,i,a,c,u,h,y){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=o,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=y}}const Ia="(default)";class ss{constructor(e,r){this.projectId=e,this.database=r||Ia}static empty(){return new ss("","")}get isDefaultDatabase(){return this.database===Ia}isEqual(e){return e instanceof ss&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const up="__type__",wP="__max__",Fs={mapValue:{}},hp="__vector__",$a="value";function io(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Xc(t)?4:AP(t)?9007199254740991:CP(t)?10:11:ot(28295,{value:t})}function fn(t,e){if(t===e)return!0;const r=io(t);if(r!==io(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return is(t).isEqual(is(e));case 3:return function(o,i){if(typeof o.timestampValue=="string"&&typeof i.timestampValue=="string"&&o.timestampValue.length===i.timestampValue.length)return o.timestampValue===i.timestampValue;const a=no(o.timestampValue),c=no(i.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(o,i){return oo(o.bytesValue).isEqual(oo(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(o,i){return rr(o.geoPointValue.latitude)===rr(i.geoPointValue.latitude)&&rr(o.geoPointValue.longitude)===rr(i.geoPointValue.longitude)}(t,e);case 2:return function(o,i){if("integerValue"in o&&"integerValue"in i)return rr(o.integerValue)===rr(i.integerValue);if("doubleValue"in o&&"doubleValue"in i){const a=rr(o.doubleValue),c=rr(i.doubleValue);return a===c?xa(a)===xa(c):isNaN(a)&&isNaN(c)}return!1}(t,e);case 9:return ci(t.arrayValue.values||[],e.arrayValue.values||[],fn);case 10:case 11:return function(o,i){const a=o.mapValue.fields||{},c=i.mapValue.fields||{};if(eh(a)!==eh(c))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(c[u]===void 0||!fn(a[u],c[u])))return!1;return!0}(t,e);default:return ot(52216,{left:t})}}function as(t,e){return(t.values||[]).find(r=>fn(r,e))!==void 0}function di(t,e){if(t===e)return 0;const r=io(t),n=io(e);if(r!==n)return $t(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return $t(t.booleanValue,e.booleanValue);case 2:return function(i,a){const c=rr(i.integerValue||i.doubleValue),u=rr(a.integerValue||a.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return rh(t.timestampValue,e.timestampValue);case 4:return rh(is(t),is(e));case 5:return cc(t.stringValue,e.stringValue);case 6:return function(i,a){const c=oo(i),u=oo(a);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const c=i.split("/"),u=a.split("/");for(let h=0;h<c.length&&h<u.length;h++){const y=$t(c[h],u[h]);if(y!==0)return y}return $t(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const c=$t(rr(i.latitude),rr(a.latitude));return c!==0?c:$t(rr(i.longitude),rr(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return nh(t.arrayValue,e.arrayValue);case 10:return function(i,a){const c=i.fields||{},u=a.fields||{},h=c[$a]?.arrayValue,y=u[$a]?.arrayValue,b=$t(h?.values?.length||0,y?.values?.length||0);return b!==0?b:nh(h,y)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===Fs.mapValue&&a===Fs.mapValue)return 0;if(i===Fs.mapValue)return 1;if(a===Fs.mapValue)return-1;const c=i.fields||{},u=Object.keys(c),h=a.fields||{},y=Object.keys(h);u.sort(),y.sort();for(let b=0;b<u.length&&b<y.length;++b){const _=cc(u[b],y[b]);if(_!==0)return _;const A=di(c[u[b]],h[y[b]]);if(A!==0)return A}return $t(u.length,y.length)}(t.mapValue,e.mapValue);default:throw ot(23264,{he:r})}}function rh(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return $t(t,e);const r=no(t),n=no(e),o=$t(r.seconds,n.seconds);return o!==0?o:$t(r.nanos,n.nanos)}function nh(t,e){const r=t.values||[],n=e.values||[];for(let o=0;o<r.length&&o<n.length;++o){const i=di(r[o],n[o]);if(i)return i}return $t(r.length,n.length)}function ui(t){return dc(t)}function dc(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=no(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return oo(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return tt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",o=!0;for(const i of r.values||[])o?o=!1:n+=",",n+=dc(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let o="{",i=!0;for(const a of n)i?i=!1:o+=",",o+=`${a}:${dc(r.fields[a])}`;return o+"}"}(t.mapValue):ot(61005,{value:t})}function sa(t){switch(io(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ya(t);return e?16+sa(e):16;case 5:return 2*t.stringValue.length;case 6:return oo(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((o,i)=>o+sa(i),0)}(t.arrayValue);case 10:case 11:return function(n){let o=0;return uo(n.fields,(i,a)=>{o+=i.length+sa(a)}),o}(t.mapValue);default:throw ot(13486,{value:t})}}function oh(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function uc(t){return!!t&&"integerValue"in t}function Zc(t){return!!t&&"arrayValue"in t}function ih(t){return!!t&&"nullValue"in t}function sh(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function aa(t){return!!t&&"mapValue"in t}function CP(t){return(t?.mapValue?.fields||{})[up]?.stringValue===hp}function Wi(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return uo(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Wi(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Wi(t.arrayValue.values[r]);return e}return{...t}}function AP(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===wP}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e){this.value=e}static empty(){return new Lr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!aa(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Wi(r)}setAll(e){let r=gr.emptyPath(),n={},o=[];e.forEach((a,c)=>{if(!r.isImmediateParentOf(c)){const u=this.getFieldsMap(r);this.applyChanges(u,n,o),n={},o=[],r=c.popLast()}a?n[c.lastSegment()]=Wi(a):o.push(c.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,n,o)}delete(e){const r=this.field(e.popLast());aa(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return fn(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let o=r.mapValue.fields[e.get(n)];aa(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=o),r=o}return r.mapValue.fields}applyChanges(e,r,n){uo(r,(o,i)=>e[o]=i);for(const o of n)delete e[o]}clone(){return new Lr(Wi(this.value))}}function mp(t){const e=[];return uo(t.fields,(r,n)=>{const o=new gr([r]);if(aa(n)){const i=mp(n.mapValue).fields;if(i.length===0)e.push(o);else for(const a of i)e.push(o.child(a))}else e.push(o)}),new Fr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e,r,n,o,i,a,c){this.key=e,this.documentType=r,this.version=n,this.readTime=o,this.createTime=i,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Ir(e,0,dt.min(),dt.min(),dt.min(),Lr.empty(),0)}static newFoundDocument(e,r,n,o){return new Ir(e,1,r,dt.min(),n,o,0)}static newNoDocument(e,r){return new Ir(e,2,r,dt.min(),dt.min(),Lr.empty(),0)}static newUnknownDocument(e,r){return new Ir(e,3,r,dt.min(),dt.min(),Lr.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(dt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Lr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Lr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=dt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ir&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ir(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(e,r){this.position=e,this.inclusive=r}}function ah(t,e,r){let n=0;for(let o=0;o<t.position.length;o++){const i=e[o],a=t.position[o];if(i.field.isKeyField()?n=tt.comparator(tt.fromName(a.referenceValue),r.key):n=di(a,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function lh(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!fn(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e,r="asc"){this.field=e,this.dir=r}}function xP(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{}class ar extends yp{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new $P(e,r,n):r==="array-contains"?new kP(e,n):r==="in"?new RP(e,n):r==="not-in"?new DP(e,n):r==="array-contains-any"?new NP(e,n):new ar(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new EP(e,n):new TP(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(di(r,this.value)):r!==null&&io(this.value)===io(r)&&this.matchesComparison(di(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ot(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Zr extends yp{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Zr(e,r)}matches(e){return pp(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function pp(t){return t.op==="and"}function fp(t){return IP(t)&&pp(t)}function IP(t){for(const e of t.filters)if(e instanceof Zr)return!1;return!0}function hc(t){if(t instanceof ar)return t.field.canonicalString()+t.op.toString()+ui(t.value);if(fp(t))return t.filters.map(e=>hc(e)).join(",");{const e=t.filters.map(r=>hc(r)).join(",");return`${t.op}(${e})`}}function gp(t,e){return t instanceof ar?function(n,o){return o instanceof ar&&n.op===o.op&&n.field.isEqual(o.field)&&fn(n.value,o.value)}(t,e):t instanceof Zr?function(n,o){return o instanceof Zr&&n.op===o.op&&n.filters.length===o.filters.length?n.filters.reduce((i,a,c)=>i&&gp(a,o.filters[c]),!0):!1}(t,e):void ot(19439)}function vp(t){return t instanceof ar?function(r){return`${r.field.canonicalString()} ${r.op} ${ui(r.value)}`}(t):t instanceof Zr?function(r){return r.op.toString()+" {"+r.getFilters().map(vp).join(" ,")+"}"}(t):"Filter"}class $P extends ar{constructor(e,r,n){super(e,r,n),this.key=tt.fromName(n.referenceValue)}matches(e){const r=tt.comparator(e.key,this.key);return this.matchesComparison(r)}}class EP extends ar{constructor(e,r){super(e,"in",r),this.keys=bp("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class TP extends ar{constructor(e,r){super(e,"not-in",r),this.keys=bp("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function bp(t,e){return(e.arrayValue?.values||[]).map(r=>tt.fromName(r.referenceValue))}class kP extends ar{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Zc(r)&&as(r.arrayValue,this.value)}}class RP extends ar{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&as(this.value.arrayValue,r)}}class DP extends ar{constructor(e,r){super(e,"not-in",r)}matches(e){if(as(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!as(this.value.arrayValue,r)}}class NP extends ar{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Zc(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>as(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LP{constructor(e,r=null,n=[],o=[],i=null,a=null,c=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=o,this.limit=i,this.startAt=a,this.endAt=c,this.Te=null}}function ch(t,e=null,r=[],n=[],o=null,i=null,a=null){return new LP(t,e,r,n,o,i,a)}function ed(t){const e=ut(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>hc(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),Wa(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>ui(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>ui(n)).join(",")),e.Te=r}return e.Te}function td(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!xP(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!gp(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!lh(t.startAt,e.startAt)&&lh(t.endAt,e.endAt)}function mc(t){return tt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi{constructor(e,r=null,n=[],o=[],i=null,a="F",c=null,u=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=o,this.limit=i,this.limitType=a,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function MP(t,e,r,n,o,i,a,c){return new Pi(t,e,r,n,o,i,a,c)}function rd(t){return new Pi(t)}function dh(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function _p(t){return t.collectionGroup!==null}function Yi(t){const e=ut(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new dr(gr.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new ls(i,n))}),r.has(gr.keyField().canonicalString())||e.Ie.push(new ls(gr.keyField(),n))}return e.Ie}function dn(t){const e=ut(t);return e.Ee||(e.Ee=OP(e,Yi(t))),e.Ee}function OP(t,e){if(t.limitType==="F")return ch(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(o=>{const i=o.dir==="desc"?"asc":"desc";return new ls(o.field,i)});const r=t.endAt?new Ea(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Ea(t.startAt.position,t.startAt.inclusive):null;return ch(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function yc(t,e){const r=t.filters.concat([e]);return new Pi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function pc(t,e,r){return new Pi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Ka(t,e){return td(dn(t),dn(e))&&t.limitType===e.limitType}function Pp(t){return`${ed(dn(t))}|lt:${t.limitType}`}function Qo(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(o=>vp(o)).join(", ")}]`),Wa(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(o=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(o)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(o=>ui(o)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(o=>ui(o)).join(",")),`Target(${n})`}(dn(t))}; limitType=${t.limitType})`}function Qa(t,e){return e.isFoundDocument()&&function(n,o){const i=o.key.path;return n.collectionGroup!==null?o.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):tt.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,o){for(const i of Yi(n))if(!i.field.isKeyField()&&o.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,o){for(const i of n.filters)if(!i.matches(o))return!1;return!0}(t,e)&&function(n,o){return!(n.startAt&&!function(a,c,u){const h=ah(a,c,u);return a.inclusive?h<=0:h<0}(n.startAt,Yi(n),o)||n.endAt&&!function(a,c,u){const h=ah(a,c,u);return a.inclusive?h>=0:h>0}(n.endAt,Yi(n),o))}(t,e)}function VP(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Sp(t){return(e,r)=>{let n=!1;for(const o of Yi(t)){const i=FP(o,e,r);if(i!==0)return i;n=n||o.field.isKeyField()}return 0}}function FP(t,e,r){const n=t.field.isKeyField()?tt.comparator(e.key,r.key):function(i,a,c){const u=a.data.field(i),h=c.data.field(i);return u!==null&&h!==null?di(u,h):ot(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ot(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[o,i]of n)if(this.equalsFn(o,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),o=this.inner[n];if(o===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<o.length;i++)if(this.equalsFn(o[i][0],e))return void(o[i]=[e,r]);o.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let o=0;o<n.length;o++)if(this.equalsFn(n[o][0],e))return n.length===1?delete this.inner[r]:n.splice(o,1),this.innerSize--,!0;return!1}forEach(e){uo(this.inner,(r,n)=>{for(const[o,i]of n)e(o,i)})}isEmpty(){return ip(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BP=new Zt(tt.comparator);function Dn(){return BP}const wp=new Zt(tt.comparator);function Fi(...t){let e=wp;for(const r of t)e=e.insert(r.key,r);return e}function Cp(t){let e=wp;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function xo(){return Ki()}function Ap(){return Ki()}function Ki(){return new Lo(t=>t.toString(),(t,e)=>t.isEqual(e))}const UP=new Zt(tt.comparator),jP=new dr(tt.comparator);function Et(...t){let e=jP;for(const r of t)e=e.add(r);return e}const zP=new dr($t);function qP(){return zP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nd(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xa(e)?"-0":e}}function xp(t){return{integerValue:""+t}}function GP(t,e){return vP(e)?xp(e):nd(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja{constructor(){this._=void 0}}function HP(t,e,r){return t instanceof Ta?function(o,i){const a={fields:{[lp]:{stringValue:ap},[dp]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return i&&Xc(i)&&(i=Ya(i)),i&&(a.fields[cp]=i),{mapValue:a}}(r,e):t instanceof cs?$p(t,e):t instanceof ds?Ep(t,e):function(o,i){const a=Ip(o,i),c=uh(a)+uh(o.Ae);return uc(a)&&uc(o.Ae)?xp(c):nd(o.serializer,c)}(t,e)}function WP(t,e,r){return t instanceof cs?$p(t,e):t instanceof ds?Ep(t,e):r}function Ip(t,e){return t instanceof ka?function(n){return uc(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class Ta extends Ja{}class cs extends Ja{constructor(e){super(),this.elements=e}}function $p(t,e){const r=Tp(e);for(const n of t.elements)r.some(o=>fn(o,n))||r.push(n);return{arrayValue:{values:r}}}class ds extends Ja{constructor(e){super(),this.elements=e}}function Ep(t,e){let r=Tp(e);for(const n of t.elements)r=r.filter(o=>!fn(o,n));return{arrayValue:{values:r}}}class ka extends Ja{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function uh(t){return rr(t.integerValue||t.doubleValue)}function Tp(t){return Zc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function YP(t,e){return t.field.isEqual(e.field)&&function(n,o){return n instanceof cs&&o instanceof cs||n instanceof ds&&o instanceof ds?ci(n.elements,o.elements,fn):n instanceof ka&&o instanceof ka?fn(n.Ae,o.Ae):n instanceof Ta&&o instanceof Ta}(t.transform,e.transform)}class KP{constructor(e,r){this.version=e,this.transformResults=r}}class un{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new un}static exists(e){return new un(void 0,e)}static updateTime(e){return new un(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function la(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Xa{}function kp(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Dp(t.key,un.none()):new bs(t.key,t.data,un.none());{const r=t.data,n=Lr.empty();let o=new dr(gr.comparator);for(let i of e.fields)if(!o.has(i)){let a=r.field(i);a===null&&i.length>1&&(i=i.popLast(),a=r.field(i)),a===null?n.delete(i):n.set(i,a),o=o.add(i)}return new ho(t.key,n,new Fr(o.toArray()),un.none())}}function QP(t,e,r){t instanceof bs?function(o,i,a){const c=o.value.clone(),u=mh(o.fieldTransforms,i,a.transformResults);c.setAll(u),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,r):t instanceof ho?function(o,i,a){if(!la(o.precondition,i))return void i.convertToUnknownDocument(a.version);const c=mh(o.fieldTransforms,i,a.transformResults),u=i.data;u.setAll(Rp(o)),u.setAll(c),i.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,r):function(o,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Qi(t,e,r,n){return t instanceof bs?function(i,a,c,u){if(!la(i.precondition,a))return c;const h=i.value.clone(),y=yh(i.fieldTransforms,u,a);return h.setAll(y),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(t,e,r,n):t instanceof ho?function(i,a,c,u){if(!la(i.precondition,a))return c;const h=yh(i.fieldTransforms,u,a),y=a.data;return y.setAll(Rp(i)),y.setAll(h),a.convertToFoundDocument(a.version,y).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(b=>b.field))}(t,e,r,n):function(i,a,c){return la(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(t,e,r)}function JP(t,e){let r=null;for(const n of t.fieldTransforms){const o=e.data.field(n.field),i=Ip(n.transform,o||null);i!=null&&(r===null&&(r=Lr.empty()),r.set(n.field,i))}return r||null}function hh(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,o){return n===void 0&&o===void 0||!(!n||!o)&&ci(n,o,(i,a)=>YP(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class bs extends Xa{constructor(e,r,n,o=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class ho extends Xa{constructor(e,r,n,o,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=o,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Rp(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function mh(t,e,r){const n=new Map;Ut(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let o=0;o<r.length;o++){const i=t[o],a=i.transform,c=e.data.field(i.field);n.set(i.field,WP(a,c,r[o]))}return n}function yh(t,e,r){const n=new Map;for(const o of t){const i=o.transform,a=r.data.field(o.field);n.set(o.field,HP(i,a,e))}return n}class Dp extends Xa{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class XP extends Xa{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{constructor(e,r,n,o){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=o}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let o=0;o<this.mutations.length;o++){const i=this.mutations[o];i.key.isEqual(e.key)&&QP(i,e,n[o])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Qi(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Qi(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=Ap();return this.mutations.forEach(o=>{const i=e.get(o.key),a=i.overlayedDocument;let c=this.applyToLocalView(a,i.mutatedFields);c=r.has(o.key)?null:c;const u=kp(a,c);u!==null&&n.set(o.key,u),a.isValidDocument()||a.convertToNoDocument(dt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Et())}isEqual(e){return this.batchId===e.batchId&&ci(this.mutations,e.mutations,(r,n)=>hh(r,n))&&ci(this.baseMutations,e.baseMutations,(r,n)=>hh(r,n))}}class od{constructor(e,r,n,o){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=o}static from(e,r,n){Ut(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let o=function(){return UP}();const i=e.mutations;for(let a=0;a<i.length;a++)o=o.insert(i[a].key,n[a].version);return new od(e,r,n,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t1{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var sr,Dt;function r1(t){switch(t){case ke.OK:return ot(64938);case ke.CANCELLED:case ke.UNKNOWN:case ke.DEADLINE_EXCEEDED:case ke.RESOURCE_EXHAUSTED:case ke.INTERNAL:case ke.UNAVAILABLE:case ke.UNAUTHENTICATED:return!1;case ke.INVALID_ARGUMENT:case ke.NOT_FOUND:case ke.ALREADY_EXISTS:case ke.PERMISSION_DENIED:case ke.FAILED_PRECONDITION:case ke.ABORTED:case ke.OUT_OF_RANGE:case ke.UNIMPLEMENTED:case ke.DATA_LOSS:return!0;default:return ot(15467,{code:t})}}function Np(t){if(t===void 0)return kn("GRPC error has no .code"),ke.UNKNOWN;switch(t){case sr.OK:return ke.OK;case sr.CANCELLED:return ke.CANCELLED;case sr.UNKNOWN:return ke.UNKNOWN;case sr.DEADLINE_EXCEEDED:return ke.DEADLINE_EXCEEDED;case sr.RESOURCE_EXHAUSTED:return ke.RESOURCE_EXHAUSTED;case sr.INTERNAL:return ke.INTERNAL;case sr.UNAVAILABLE:return ke.UNAVAILABLE;case sr.UNAUTHENTICATED:return ke.UNAUTHENTICATED;case sr.INVALID_ARGUMENT:return ke.INVALID_ARGUMENT;case sr.NOT_FOUND:return ke.NOT_FOUND;case sr.ALREADY_EXISTS:return ke.ALREADY_EXISTS;case sr.PERMISSION_DENIED:return ke.PERMISSION_DENIED;case sr.FAILED_PRECONDITION:return ke.FAILED_PRECONDITION;case sr.ABORTED:return ke.ABORTED;case sr.OUT_OF_RANGE:return ke.OUT_OF_RANGE;case sr.UNIMPLEMENTED:return ke.UNIMPLEMENTED;case sr.DATA_LOSS:return ke.DATA_LOSS;default:return ot(39323,{code:t})}}(Dt=sr||(sr={}))[Dt.OK=0]="OK",Dt[Dt.CANCELLED=1]="CANCELLED",Dt[Dt.UNKNOWN=2]="UNKNOWN",Dt[Dt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Dt[Dt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Dt[Dt.NOT_FOUND=5]="NOT_FOUND",Dt[Dt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Dt[Dt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Dt[Dt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Dt[Dt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Dt[Dt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Dt[Dt.ABORTED=10]="ABORTED",Dt[Dt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Dt[Dt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Dt[Dt.INTERNAL=13]="INTERNAL",Dt[Dt.UNAVAILABLE=14]="UNAVAILABLE",Dt[Dt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n1(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o1=new eo([4294967295,4294967295],0);function ph(t){const e=n1().encode(t),r=new Yy;return r.update(e),new Uint8Array(r.digest())}function fh(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),o=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new eo([r,n],0),new eo([o,i],0)]}class id{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Bi(`Invalid padding: ${r}`);if(n<0)throw new Bi(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Bi(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Bi(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=eo.fromNumber(this.ge)}ye(e,r,n){let o=e.add(r.multiply(eo.fromNumber(n)));return o.compare(o1)===1&&(o=new eo([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=ph(e),[n,o]=fh(r);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,o,i);if(!this.we(a))return!1}return!0}static create(e,r,n){const o=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new id(i,o,r);return n.forEach(c=>a.insert(c)),a}insert(e){if(this.ge===0)return;const r=ph(e),[n,o]=fh(r);for(let i=0;i<this.hashCount;i++){const a=this.ye(n,o,i);this.Se(a)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Bi extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za{constructor(e,r,n,o,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=o,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const o=new Map;return o.set(e,_s.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Za(dt.min(),o,new Zt($t),Dn(),Et())}}class _s{constructor(e,r,n,o,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=o,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new _s(n,r,Et(),Et(),Et())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e,r,n,o){this.be=e,this.removedTargetIds=r,this.key=n,this.De=o}}class Lp{constructor(e,r){this.targetId=e,this.Ce=r}}class Mp{constructor(e,r,n=_r.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=o}}class gh{constructor(){this.ve=0,this.Fe=vh(),this.Me=_r.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Et(),r=Et(),n=Et();return this.Fe.forEach((o,i)=>{switch(i){case 0:e=e.add(o);break;case 2:r=r.add(o);break;case 1:n=n.add(o);break;default:ot(38017,{changeType:i})}}),new _s(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=vh()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ut(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class i1{constructor(e){this.Ge=e,this.ze=new Map,this.je=Dn(),this.Je=Bs(),this.He=Bs(),this.Ye=new Zt($t)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:ot(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,o)=>{this.rt(o)&&r(o)})}st(e){const r=e.targetId,n=e.Ce.count,o=this.ot(r);if(o){const i=o.target;if(mc(i))if(n===0){const a=new tt(i.path);this.et(r,a,Ir.newNoDocument(a,dt.min()))}else Ut(n===1,20013,{expectedCount:n});else{const a=this._t(r);if(a!==n){const c=this.ut(e),u=c?this.ct(c,e,a):1;if(u!==0){this.it(r);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,h)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:o=0},hashCount:i=0}=r;let a,c;try{a=oo(n).toUint8Array()}catch(u){if(u instanceof sp)return li("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new id(a,o,i)}catch(u){return li(u instanceof Bi?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let o=0;return n.forEach(i=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(r,i,null),o++)}),o}Tt(e){const r=new Map;this.ze.forEach((i,a)=>{const c=this.ot(a);if(c){if(i.current&&mc(c.target)){const u=new tt(c.target.path);this.It(u).has(a)||this.Et(a,u)||this.et(a,u,Ir.newNoDocument(u,e))}i.Be&&(r.set(a,i.ke()),i.qe())}});let n=Et();this.He.forEach((i,a)=>{let c=!0;a.forEachWhile(u=>{const h=this.ot(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(i))}),this.je.forEach((i,a)=>a.setReadTime(e));const o=new Za(e,r,this.Ye,this.je,n);return this.je=Dn(),this.Je=Bs(),this.He=Bs(),this.Ye=new Zt($t),o}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,r)?o.Qe(r,1):o.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new gh,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new dr($t),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new dr($t),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Ye("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new gh),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Bs(){return new Zt(tt.comparator)}function vh(){return new Zt(tt.comparator)}const s1={asc:"ASCENDING",desc:"DESCENDING"},a1={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},l1={and:"AND",or:"OR"};class c1{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function fc(t,e){return t.useProto3Json||Wa(e)?e:{value:e}}function Ra(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Op(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function d1(t,e){return Ra(t,e.toTimestamp())}function hn(t){return Ut(!!t,49232),dt.fromTimestamp(function(r){const n=no(r);return new Qt(n.seconds,n.nanos)}(t))}function sd(t,e){return gc(t,e).canonicalString()}function gc(t,e){const r=function(o){return new Yt(["projects",o.projectId,"databases",o.database])}(t).child("documents");return e===void 0?r:r.child(e)}function Vp(t){const e=Yt.fromString(t);return Ut(zp(e),10190,{key:e.toString()}),e}function vc(t,e){return sd(t.databaseId,e.path)}function Cl(t,e){const r=Vp(e);if(r.get(1)!==t.databaseId.projectId)throw new He(ke.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new He(ke.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new tt(Bp(r))}function Fp(t,e){return sd(t.databaseId,e)}function u1(t){const e=Vp(t);return e.length===4?Yt.emptyPath():Bp(e)}function bc(t){return new Yt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Bp(t){return Ut(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function bh(t,e,r){return{name:vc(t,e),fields:r.value.mapValue.fields}}function h1(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:ot(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],i=function(h,y){return h.useProto3Json?(Ut(y===void 0||typeof y=="string",58123),_r.fromBase64String(y||"")):(Ut(y===void 0||y instanceof Buffer||y instanceof Uint8Array,16193),_r.fromUint8Array(y||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(h){const y=h.code===void 0?ke.UNKNOWN:Np(h.code);return new He(y,h.message||"")}(a);r=new Mp(n,o,i,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const o=Cl(t,n.document.name),i=hn(n.document.updateTime),a=n.document.createTime?hn(n.document.createTime):dt.min(),c=new Lr({mapValue:{fields:n.document.fields}}),u=Ir.newFoundDocument(o,i,a,c),h=n.targetIds||[],y=n.removedTargetIds||[];r=new ca(h,y,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const o=Cl(t,n.document),i=n.readTime?hn(n.readTime):dt.min(),a=Ir.newNoDocument(o,i),c=n.removedTargetIds||[];r=new ca([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const o=Cl(t,n.document),i=n.removedTargetIds||[];r=new ca([],i,o,null)}else{if(!("filter"in e))return ot(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:o=0,unchangedNames:i}=n,a=new t1(o,i),c=n.targetId;r=new Lp(c,a)}}return r}function m1(t,e){let r;if(e instanceof bs)r={update:bh(t,e.key,e.value)};else if(e instanceof Dp)r={delete:vc(t,e.key)};else if(e instanceof ho)r={update:bh(t,e.key,e.data),updateMask:S1(e.fieldMask)};else{if(!(e instanceof XP))return ot(16599,{Vt:e.type});r={verify:vc(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(i,a){const c=a.transform;if(c instanceof Ta)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof cs)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof ds)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof ka)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw ot(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(o,i){return i.updateTime!==void 0?{updateTime:d1(o,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ot(27497)}(t,e.precondition)),r}function y1(t,e){return t&&t.length>0?(Ut(e!==void 0,14353),t.map(r=>function(o,i){let a=o.updateTime?hn(o.updateTime):hn(i);return a.isEqual(dt.min())&&(a=hn(i)),new KP(a,o.transformResults||[])}(r,e))):[]}function p1(t,e){return{documents:[Fp(t,e.path)]}}function f1(t,e){const r={structuredQuery:{}},n=e.path;let o;e.collectionGroup!==null?(o=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Fp(t,o);const i=function(h){if(h.length!==0)return jp(Zr.create(h,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const a=function(h){if(h.length!==0)return h.map(y=>function(_){return{field:Jo(_.field),direction:b1(_.dir)}}(y))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const c=fc(t,e.limit);return c!==null&&(r.structuredQuery.limit=c),e.startAt&&(r.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ft:r,parent:o}}function g1(t){let e=u1(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let o=null;if(n>0){Ut(n===1,65062);const y=r.from[0];y.allDescendants?o=y.collectionId:e=e.child(y.collectionId)}let i=[];r.where&&(i=function(b){const _=Up(b);return _ instanceof Zr&&fp(_)?_.getFilters():[_]}(r.where));let a=[];r.orderBy&&(a=function(b){return b.map(_=>function(E){return new ls(Xo(E.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(_))}(r.orderBy));let c=null;r.limit&&(c=function(b){let _;return _=typeof b=="object"?b.value:b,Wa(_)?null:_}(r.limit));let u=null;r.startAt&&(u=function(b){const _=!!b.before,A=b.values||[];return new Ea(A,_)}(r.startAt));let h=null;return r.endAt&&(h=function(b){const _=!b.before,A=b.values||[];return new Ea(A,_)}(r.endAt)),MP(e,o,a,i,c,"F",u,h)}function v1(t,e){const r=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ot(28987,{purpose:o})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Up(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Xo(r.unaryFilter.field);return ar.create(n,"==",{doubleValue:NaN});case"IS_NULL":const o=Xo(r.unaryFilter.field);return ar.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Xo(r.unaryFilter.field);return ar.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Xo(r.unaryFilter.field);return ar.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ot(61313);default:return ot(60726)}}(t):t.fieldFilter!==void 0?function(r){return ar.create(Xo(r.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ot(58110);default:return ot(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Zr.create(r.compositeFilter.filters.map(n=>Up(n)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return ot(1026)}}(r.compositeFilter.op))}(t):ot(30097,{filter:t})}function b1(t){return s1[t]}function _1(t){return a1[t]}function P1(t){return l1[t]}function Jo(t){return{fieldPath:t.canonicalString()}}function Xo(t){return gr.fromServerFormat(t.fieldPath)}function jp(t){return t instanceof ar?function(r){if(r.op==="=="){if(sh(r.value))return{unaryFilter:{field:Jo(r.field),op:"IS_NAN"}};if(ih(r.value))return{unaryFilter:{field:Jo(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(sh(r.value))return{unaryFilter:{field:Jo(r.field),op:"IS_NOT_NAN"}};if(ih(r.value))return{unaryFilter:{field:Jo(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Jo(r.field),op:_1(r.op),value:r.value}}}(t):t instanceof Zr?function(r){const n=r.getFilters().map(o=>jp(o));return n.length===1?n[0]:{compositeFilter:{op:P1(r.op),filters:n}}}(t):ot(54877,{filter:t})}function S1(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function zp(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e,r,n,o,i=dt.min(),a=dt.min(),c=_r.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=o,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Kn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Kn(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Kn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Kn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{constructor(e){this.yt=e}}function C1(t){const e=g1({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?pc(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1{constructor(){this.Cn=new x1}addToCollectionParentIndex(e,r){return this.Cn.add(r),Ne.resolve()}getCollectionParents(e,r){return Ne.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return Ne.resolve()}deleteFieldIndex(e,r){return Ne.resolve()}deleteAllFieldIndexes(e){return Ne.resolve()}createTargetIndexes(e,r){return Ne.resolve()}getDocumentsMatchingTarget(e,r){return Ne.resolve(null)}getIndexType(e,r){return Ne.resolve(0)}getFieldIndexes(e,r){return Ne.resolve([])}getNextCollectionGroupToUpdate(e){return Ne.resolve(null)}getMinOffset(e,r){return Ne.resolve(ro.min())}getMinOffsetFromCollectionGroup(e,r){return Ne.resolve(ro.min())}updateCollectionGroup(e,r,n){return Ne.resolve()}updateIndexEntries(e,r){return Ne.resolve()}}class x1{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),o=this.index[r]||new dr(Yt.comparator),i=!o.has(n);return this.index[r]=o.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),o=this.index[r];return o&&o.has(n)}getEntries(e){return(this.index[e]||new dr(Yt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _h={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},qp=41943040;class Nr{static withCacheSize(e){return new Nr(e,Nr.DEFAULT_COLLECTION_PERCENTILE,Nr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Nr.DEFAULT_COLLECTION_PERCENTILE=10,Nr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Nr.DEFAULT=new Nr(qp,Nr.DEFAULT_COLLECTION_PERCENTILE,Nr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Nr.DISABLED=new Nr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new hi(0)}static cr(){return new hi(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ph="LruGarbageCollector",I1=1048576;function Sh([t,e],[r,n]){const o=$t(t,r);return o===0?$t(e,n):o}class $1{constructor(e){this.Ir=e,this.buffer=new dr(Sh),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();Sh(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class E1{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ye(Ph,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){_i(r)?Ye(Ph,"Ignoring IndexedDB error during garbage collection: ",r):await bi(r)}await this.Vr(3e5)})}}class T1{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Ne.resolve(Ha.ce);const n=new $1(r);return this.mr.forEachTarget(e,o=>n.Ar(o.sequenceNumber)).next(()=>this.mr.pr(e,o=>n.Ar(o))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Ye("LruGarbageCollector","Garbage collection skipped; disabled"),Ne.resolve(_h)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ye("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),_h):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,o,i,a,c,u,h;const y=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(b=>(b>this.params.maximumSequenceNumbersToCollect?(Ye("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),o=this.params.maximumSequenceNumbersToCollect):o=b,a=Date.now(),this.nthSequenceNumber(e,o))).next(b=>(n=b,c=Date.now(),this.removeTargets(e,n,r))).next(b=>(i=b,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(b=>(h=Date.now(),Ko()<=It.DEBUG&&Ye("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-y}ms
	Determined least recently used ${o} in `+(c-a)+`ms
	Removed ${i} targets in `+(u-c)+`ms
	Removed ${b} documents in `+(h-u)+`ms
Total Duration: ${h-y}ms`),Ne.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:i,documentsRemoved:b})))}}function k1(t,e){return new T1(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R1{constructor(){this.changes=new Lo(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Ir.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Ne.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N1{constructor(e,r,n,o){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=o}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(o=>(n=o,this.remoteDocumentCache.getEntry(e,r))).next(o=>(n!==null&&Qi(n.mutation,o,Fr.empty(),Qt.now()),o))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Et()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Et()){const o=xo();return this.populateOverlays(e,o,r).next(()=>this.computeViews(e,r,o,n).next(i=>{let a=Fi();return i.forEach((c,u)=>{a=a.insert(c,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=xo();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Et()))}populateOverlays(e,r,n){const o=[];return n.forEach(i=>{r.has(i)||o.push(i)}),this.documentOverlayCache.getOverlays(e,o).next(i=>{i.forEach((a,c)=>{r.set(a,c)})})}computeViews(e,r,n,o){let i=Dn();const a=Ki(),c=function(){return Ki()}();return r.forEach((u,h)=>{const y=n.get(h.key);o.has(h.key)&&(y===void 0||y.mutation instanceof ho)?i=i.insert(h.key,h):y!==void 0?(a.set(h.key,y.mutation.getFieldMask()),Qi(y.mutation,h,y.mutation.getFieldMask(),Qt.now())):a.set(h.key,Fr.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((h,y)=>a.set(h,y)),r.forEach((h,y)=>c.set(h,new D1(y,a.get(h)??null))),c))}recalculateAndSaveOverlays(e,r){const n=Ki();let o=new Zt((a,c)=>a-c),i=Et();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const c of a)c.keys().forEach(u=>{const h=r.get(u);if(h===null)return;let y=n.get(u)||Fr.empty();y=c.applyToLocalView(h,y),n.set(u,y);const b=(o.get(c.batchId)||Et()).add(u);o=o.insert(c.batchId,b)})}).next(()=>{const a=[],c=o.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,y=u.value,b=Ap();y.forEach(_=>{if(!i.has(_)){const A=kp(r.get(_),n.get(_));A!==null&&b.set(_,A),i=i.add(_)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,b))}return Ne.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,o){return function(a){return tt.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):_p(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,o):this.getDocumentsMatchingCollectionQuery(e,r,n,o)}getNextDocuments(e,r,n,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,o).next(i=>{const a=o-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,o-i.size):Ne.resolve(xo());let c=os,u=i;return a.next(h=>Ne.forEach(h,(y,b)=>(c<b.largestBatchId&&(c=b.largestBatchId),i.get(y)?Ne.resolve():this.remoteDocumentCache.getEntry(e,y).next(_=>{u=u.insert(y,_)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,u,h,Et())).next(y=>({batchId:c,changes:Cp(y)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new tt(r)).next(n=>{let o=Fi();return n.isFoundDocument()&&(o=o.insert(n.key,n)),o})}getDocumentsMatchingCollectionGroupQuery(e,r,n,o){const i=r.collectionGroup;let a=Fi();return this.indexManager.getCollectionParents(e,i).next(c=>Ne.forEach(c,u=>{const h=function(b,_){return new Pi(_,null,b.explicitOrderBy.slice(),b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt)}(r,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,n,o).next(y=>{y.forEach((b,_)=>{a=a.insert(b,_)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,o){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,o))).next(a=>{i.forEach((u,h)=>{const y=h.getKey();a.get(y)===null&&(a=a.insert(y,Ir.newInvalidDocument(y)))});let c=Fi();return a.forEach((u,h)=>{const y=i.get(u);y!==void 0&&Qi(y.mutation,h,Fr.empty(),Qt.now()),Qa(r,h)&&(c=c.insert(u,h))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L1{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return Ne.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(o){return{id:o.id,version:o.version,createTime:hn(o.createTime)}}(r)),Ne.resolve()}getNamedQuery(e,r){return Ne.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(o){return{name:o.name,query:C1(o.bundledQuery),readTime:hn(o.readTime)}}(r)),Ne.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M1{constructor(){this.overlays=new Zt(tt.comparator),this.qr=new Map}getOverlay(e,r){return Ne.resolve(this.overlays.get(r))}getOverlays(e,r){const n=xo();return Ne.forEach(r,o=>this.getOverlay(e,o).next(i=>{i!==null&&n.set(o,i)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((o,i)=>{this.St(e,r,i)}),Ne.resolve()}removeOverlaysForBatchId(e,r,n){const o=this.qr.get(n);return o!==void 0&&(o.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(n)),Ne.resolve()}getOverlaysForCollection(e,r,n){const o=xo(),i=r.length+1,a=new tt(r.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!r.isPrefixOf(h.path))break;h.path.length===i&&u.largestBatchId>n&&o.set(u.getKey(),u)}return Ne.resolve(o)}getOverlaysForCollectionGroup(e,r,n,o){let i=new Zt((h,y)=>h-y);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===r&&h.largestBatchId>n){let y=i.get(h.largestBatchId);y===null&&(y=xo(),i=i.insert(h.largestBatchId,y)),y.set(h.getKey(),h)}}const c=xo(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,y)=>c.set(h,y)),!(c.size()>=o)););return Ne.resolve(c)}St(e,r,n){const o=this.overlays.get(n.key);if(o!==null){const a=this.qr.get(o.largestBatchId).delete(n.key);this.qr.set(o.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new e1(r,n));let i=this.qr.get(r);i===void 0&&(i=Et(),this.qr.set(r,i)),this.qr.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{constructor(){this.sessionToken=_r.EMPTY_BYTE_STRING}getSessionToken(e){return Ne.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Ne.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(){this.Qr=new dr(mr.$r),this.Ur=new dr(mr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new mr(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new mr(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new tt(new Yt([])),n=new mr(r,e),o=new mr(r,e+1),i=[];return this.Ur.forEachInRange([n,o],a=>{this.Gr(a),i.push(a.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new tt(new Yt([])),n=new mr(r,e),o=new mr(r,e+1);let i=Et();return this.Ur.forEachInRange([n,o],a=>{i=i.add(a.key)}),i}containsKey(e){const r=new mr(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class mr{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return tt.comparator(e.key,r.key)||$t(e.Yr,r.Yr)}static Kr(e,r){return $t(e.Yr,r.Yr)||tt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new dr(mr.$r)}checkEmpty(e){return Ne.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,o){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new ZP(i,r,n,o);this.mutationQueue.push(a);for(const c of o)this.Zr=this.Zr.add(new mr(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return Ne.resolve(a)}lookupMutationBatch(e,r){return Ne.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,o=this.ei(n),i=o<0?0:o;return Ne.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Ne.resolve(this.mutationQueue.length===0?Jc:this.tr-1)}getAllMutationBatches(e){return Ne.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new mr(r,0),o=new mr(r,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,o],a=>{const c=this.Xr(a.Yr);i.push(c)}),Ne.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new dr($t);return r.forEach(o=>{const i=new mr(o,0),a=new mr(o,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],c=>{n=n.add(c.Yr)})}),Ne.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,o=n.length+1;let i=n;tt.isDocumentKey(i)||(i=i.child(""));const a=new mr(new tt(i),0);let c=new dr($t);return this.Zr.forEachWhile(u=>{const h=u.key.path;return!!n.isPrefixOf(h)&&(h.length===o&&(c=c.add(u.Yr)),!0)},a),Ne.resolve(this.ti(c))}ti(e){const r=[];return e.forEach(n=>{const o=this.Xr(n);o!==null&&r.push(o)}),r}removeMutationBatch(e,r){Ut(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return Ne.forEach(r.mutations,o=>{const i=new mr(o.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new mr(r,0),o=this.Zr.firstAfterOrEqual(n);return Ne.resolve(r.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ne.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F1{constructor(e){this.ri=e,this.docs=function(){return new Zt(tt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,o=this.docs.get(n),i=o?o.size:0,a=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Ne.resolve(n?n.document.mutableCopy():Ir.newInvalidDocument(r))}getEntries(e,r){let n=Dn();return r.forEach(o=>{const i=this.docs.get(o);n=n.insert(o,i?i.document.mutableCopy():Ir.newInvalidDocument(o))}),Ne.resolve(n)}getDocumentsMatchingQuery(e,r,n,o){let i=Dn();const a=r.path,c=new tt(a.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:h,value:{document:y}}=u.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||yP(mP(y),n)<=0||(o.has(y.key)||Qa(r,y))&&(i=i.insert(y.key,y.mutableCopy()))}return Ne.resolve(i)}getAllFromCollectionGroup(e,r,n,o){ot(9500)}ii(e,r){return Ne.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new B1(this)}getSize(e){return Ne.resolve(this.size)}}class B1 extends R1{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,o)=>{o.isValidDocument()?r.push(this.Nr.addEntry(e,o)):this.Nr.removeEntry(n)}),Ne.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1{constructor(e){this.persistence=e,this.si=new Lo(r=>ed(r),td),this.lastRemoteSnapshotVersion=dt.min(),this.highestTargetId=0,this.oi=0,this._i=new ad,this.targetCount=0,this.ai=hi.ur()}forEachTarget(e,r){return this.si.forEach((n,o)=>r(o)),Ne.resolve()}getLastRemoteSnapshotVersion(e){return Ne.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ne.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Ne.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),Ne.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new hi(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,Ne.resolve()}updateTargetData(e,r){return this.Pr(r),Ne.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,Ne.resolve()}removeTargets(e,r,n){let o=0;const i=[];return this.si.forEach((a,c)=>{c.sequenceNumber<=r&&n.get(c.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),o++)}),Ne.waitFor(i).next(()=>o)}getTargetCount(e){return Ne.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return Ne.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),Ne.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const o=this.persistence.referenceDelegate,i=[];return o&&r.forEach(a=>{i.push(o.markPotentiallyOrphaned(e,a))}),Ne.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),Ne.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return Ne.resolve(n)}containsKey(e,r){return Ne.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{constructor(e,r){this.ui={},this.overlays={},this.ci=new Ha(0),this.li=!1,this.li=!0,this.hi=new O1,this.referenceDelegate=e(this),this.Pi=new U1(this),this.indexManager=new A1,this.remoteDocumentCache=function(o){return new F1(o)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new w1(r),this.Ii=new L1(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new M1,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new V1(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Ye("MemoryPersistence","Starting transaction:",e);const o=new j1(this.ci.next());return this.referenceDelegate.Ei(),n(o).next(i=>this.referenceDelegate.di(o).next(()=>i)).toPromise().then(i=>(o.raiseOnCommittedEvent(),i))}Ai(e,r){return Ne.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class j1 extends fP{constructor(e){super(),this.currentSequenceNumber=e}}class ld{constructor(e){this.persistence=e,this.Ri=new ad,this.Vi=null}static mi(e){return new ld(e)}get fi(){if(this.Vi)return this.Vi;throw ot(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),Ne.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),Ne.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),Ne.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(o=>this.fi.add(o.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(o=>{o.forEach(i=>this.fi.add(i.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ne.forEach(this.fi,n=>{const o=tt.fromPath(n);return this.gi(e,o).next(i=>{i||r.removeEntry(o,dt.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return Ne.or([()=>Ne.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Da{constructor(e,r){this.persistence=e,this.pi=new Lo(n=>bP(n.path),(n,o)=>n.isEqual(o)),this.garbageCollector=k1(this,r)}static mi(e,r){return new Da(e,r)}Ei(){}di(e){return Ne.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(o=>n+o))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return Ne.forEach(this.pi,(n,o)=>this.br(e,n,o).next(i=>i?Ne.resolve():r(o)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const o=this.persistence.getRemoteDocumentCache(),i=o.newChangeBuffer();return o.ii(e,a=>this.br(e,a,r).next(c=>{c||(n++,i.removeEntry(a,dt.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),Ne.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Ne.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Ne.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),Ne.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=sa(e.data.value)),r}br(e,r,n){return Ne.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const o=this.pi.get(r);return Ne.resolve(o!==void 0&&o>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(e,r,n,o){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=o}static As(e,r){let n=Et(),o=Et();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:o=o.add(i.doc.key)}return new cd(e,r.fromCache,n,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z1{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q1{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Nv()?8:gP(Er())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,o){const i={result:null};return this.ys(e,r).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.ws(e,r,o,n).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new z1;return this.Ss(e,r,a).next(c=>{if(i.result=c,this.Vs)return this.bs(e,r,a,c.size)})}).next(()=>i.result)}bs(e,r,n,o){return n.documentReadCount<this.fs?(Ko()<=It.DEBUG&&Ye("QueryEngine","SDK will not create cache indexes for query:",Qo(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Ne.resolve()):(Ko()<=It.DEBUG&&Ye("QueryEngine","Query:",Qo(r),"scans",n.documentReadCount,"local documents and returns",o,"documents as results."),n.documentReadCount>this.gs*o?(Ko()<=It.DEBUG&&Ye("QueryEngine","The SDK decides to create cache indexes for query:",Qo(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,dn(r))):Ne.resolve())}ys(e,r){if(dh(r))return Ne.resolve(null);let n=dn(r);return this.indexManager.getIndexType(e,n).next(o=>o===0?null:(r.limit!==null&&o===1&&(r=pc(r,null,"F"),n=dn(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const a=Et(...i);return this.ps.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,n).next(u=>{const h=this.Ds(r,c);return this.Cs(r,h,a,u.readTime)?this.ys(e,pc(r,null,"F")):this.vs(e,h,r,u)}))})))}ws(e,r,n,o){return dh(r)||o.isEqual(dt.min())?Ne.resolve(null):this.ps.getDocuments(e,n).next(i=>{const a=this.Ds(r,i);return this.Cs(r,a,n,o)?Ne.resolve(null):(Ko()<=It.DEBUG&&Ye("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Qo(r)),this.vs(e,a,r,hP(o,os)).next(c=>c))})}Ds(e,r){let n=new dr(Sp(e));return r.forEach((o,i)=>{Qa(e,i)&&(n=n.add(i))}),n}Cs(e,r,n,o){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(o)>0)}Ss(e,r,n){return Ko()<=It.DEBUG&&Ye("QueryEngine","Using full collection scan to execute query:",Qo(r)),this.ps.getDocumentsMatchingQuery(e,r,ro.min(),n)}vs(e,r,n,o){return this.ps.getDocumentsMatchingQuery(e,n,o).next(i=>(r.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dd="LocalStore",G1=3e8;class H1{constructor(e,r,n,o){this.persistence=e,this.Fs=r,this.serializer=o,this.Ms=new Zt($t),this.xs=new Lo(i=>ed(i),td),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new N1(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function W1(t,e,r,n){return new H1(t,e,r,n)}async function Hp(t,e){const r=ut(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let o;return r.mutationQueue.getAllMutationBatches(n).next(i=>(o=i,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(i=>{const a=[],c=[];let u=Et();for(const h of o){a.push(h.batchId);for(const y of h.mutations)u=u.add(y.key)}for(const h of i){c.push(h.batchId);for(const y of h.mutations)u=u.add(y.key)}return r.localDocuments.getDocuments(n,u).next(h=>({Ls:h,removedBatchIds:a,addedBatchIds:c}))})})}function Y1(t,e){const r=ut(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const o=e.batch.keys(),i=r.Ns.newChangeBuffer({trackRemovals:!0});return function(c,u,h,y){const b=h.batch,_=b.keys();let A=Ne.resolve();return _.forEach(E=>{A=A.next(()=>y.getEntry(u,E)).next(R=>{const P=h.docVersions.get(E);Ut(P!==null,48541),R.version.compareTo(P)<0&&(b.applyToRemoteDocument(R,h),R.isValidDocument()&&(R.setReadTime(h.commitVersion),y.addEntry(R)))})}),A.next(()=>c.mutationQueue.removeMutationBatch(u,b))}(r,n,e,i).next(()=>i.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,o,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let u=Et();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u}(e))).next(()=>r.localDocuments.getDocuments(n,o))})}function Wp(t){const e=ut(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function K1(t,e){const r=ut(t),n=e.snapshotVersion;let o=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=r.Ns.newChangeBuffer({trackRemovals:!0});o=r.Ms;const c=[];e.targetChanges.forEach((y,b)=>{const _=o.get(b);if(!_)return;c.push(r.Pi.removeMatchingKeys(i,y.removedDocuments,b).next(()=>r.Pi.addMatchingKeys(i,y.addedDocuments,b)));let A=_.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(b)!==null?A=A.withResumeToken(_r.EMPTY_BYTE_STRING,dt.min()).withLastLimboFreeSnapshotVersion(dt.min()):y.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(y.resumeToken,n)),o=o.insert(b,A),function(R,P,k){return R.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=G1?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(_,A,y)&&c.push(r.Pi.updateTargetData(i,A))});let u=Dn(),h=Et();if(e.documentUpdates.forEach(y=>{e.resolvedLimboDocuments.has(y)&&c.push(r.persistence.referenceDelegate.updateLimboDocument(i,y))}),c.push(Q1(i,a,e.documentUpdates).next(y=>{u=y.ks,h=y.qs})),!n.isEqual(dt.min())){const y=r.Pi.getLastRemoteSnapshotVersion(i).next(b=>r.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n));c.push(y)}return Ne.waitFor(c).next(()=>a.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,u,h)).next(()=>u)}).then(i=>(r.Ms=o,i))}function Q1(t,e,r){let n=Et(),o=Et();return r.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let a=Dn();return r.forEach((c,u)=>{const h=i.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(o=o.add(c)),u.isNoDocument()&&u.version.isEqual(dt.min())?(e.removeEntry(c,u.readTime),a=a.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),a=a.insert(c,u)):Ye(dd,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{ks:a,qs:o}})}function J1(t,e){const r=ut(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Jc),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function X1(t,e){const r=ut(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let o;return r.Pi.getTargetData(n,e).next(i=>i?(o=i,Ne.resolve(o)):r.Pi.allocateTargetId(n).next(a=>(o=new Kn(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,o).next(()=>o))))}).then(n=>{const o=r.Ms.get(n.targetId);return(o===null||n.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function _c(t,e,r){const n=ut(t),o=n.Ms.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,a=>n.persistence.referenceDelegate.removeTarget(a,o))}catch(a){if(!_i(a))throw a;Ye(dd,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ms=n.Ms.remove(e),n.xs.delete(o.target)}function wh(t,e,r){const n=ut(t);let o=dt.min(),i=Et();return n.persistence.runTransaction("Execute query","readwrite",a=>function(u,h,y){const b=ut(u),_=b.xs.get(y);return _!==void 0?Ne.resolve(b.Ms.get(_)):b.Pi.getTargetData(h,y)}(n,a,dn(e)).next(c=>{if(c)return o=c.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,c.targetId).next(u=>{i=u})}).next(()=>n.Fs.getDocumentsMatchingQuery(a,e,r?o:dt.min(),r?i:Et())).next(c=>(Z1(n,VP(e),c),{documents:c,Qs:i})))}function Z1(t,e,r){let n=t.Os.get(e)||dt.min();r.forEach((o,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.Os.set(e,n)}class Ch{constructor(){this.activeTargetIds=qP()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class eS{constructor(){this.Mo=new Ch,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Ch,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tS{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ah="ConnectivityMonitor";class xh{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ye(Ah,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ye(Ah,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Us=null;function Pc(){return Us===null?Us=function(){return 268435456+Math.round(2147483648*Math.random())}():Us++,"0x"+Us.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Al="RestConnection",rS={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class nS{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${o}`,this.Wo=this.databaseId.database===Ia?`project_id=${n}`:`project_id=${n}&database_id=${o}`}Go(e,r,n,o,i){const a=Pc(),c=this.zo(e,r.toUriEncodedString());Ye(Al,`Sending RPC '${e}' ${a}:`,c,n);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,o,i);const{host:h}=new URL(c),y=pi(h);return this.Jo(e,c,u,n,y).then(b=>(Ye(Al,`Received RPC '${e}' ${a}: `,b),b),b=>{throw li(Al,`RPC '${e}' ${a} failed with error: `,b,"url: ",c,"request:",n),b})}Ho(e,r,n,o,i,a){return this.Go(e,r,n,o,i)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+vi}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,i)=>e[i]=o),n&&n.headers.forEach((o,i)=>e[i]=o)}zo(e,r){const n=rS[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oS{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cr="WebChannelConnection";class iS extends nS{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,o,i){const a=Pc();return new Promise((c,u)=>{const h=new Ky;h.setWithCredentials(!0),h.listenOnce(Qy.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case ia.NO_ERROR:const b=h.getResponseJson();Ye(Cr,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(b)),c(b);break;case ia.TIMEOUT:Ye(Cr,`RPC '${e}' ${a} timed out`),u(new He(ke.DEADLINE_EXCEEDED,"Request time out"));break;case ia.HTTP_ERROR:const _=h.getStatus();if(Ye(Cr,`RPC '${e}' ${a} failed with status:`,_,"response text:",h.getResponseText()),_>0){let A=h.getResponseJson();Array.isArray(A)&&(A=A[0]);const E=A?.error;if(E&&E.status&&E.message){const R=function(k){const K=k.toLowerCase().replace(/_/g,"-");return Object.values(ke).indexOf(K)>=0?K:ke.UNKNOWN}(E.status);u(new He(R,E.message))}else u(new He(ke.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new He(ke.UNAVAILABLE,"Connection failed."));break;default:ot(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{Ye(Cr,`RPC '${e}' ${a} completed.`)}});const y=JSON.stringify(o);Ye(Cr,`RPC '${e}' ${a} sending request:`,o),h.send(r,"POST",y,n,15)})}T_(e,r,n){const o=Pc(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Zy(),c=Xy(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,r,n),u.encodeInitMessageHeaders=!0;const y=i.join("");Ye(Cr,`Creating RPC '${e}' stream ${o}: ${y}`,u);const b=a.createWebChannel(y,u);this.I_(b);let _=!1,A=!1;const E=new oS({Yo:P=>{A?Ye(Cr,`Not sending because RPC '${e}' stream ${o} is closed:`,P):(_||(Ye(Cr,`Opening RPC '${e}' stream ${o} transport.`),b.open(),_=!0),Ye(Cr,`RPC '${e}' stream ${o} sending:`,P),b.send(P))},Zo:()=>b.close()}),R=(P,k,K)=>{P.listen(k,oe=>{try{K(oe)}catch(O){setTimeout(()=>{throw O},0)}})};return R(b,Vi.EventType.OPEN,()=>{A||(Ye(Cr,`RPC '${e}' stream ${o} transport opened.`),E.o_())}),R(b,Vi.EventType.CLOSE,()=>{A||(A=!0,Ye(Cr,`RPC '${e}' stream ${o} transport closed`),E.a_(),this.E_(b))}),R(b,Vi.EventType.ERROR,P=>{A||(A=!0,li(Cr,`RPC '${e}' stream ${o} transport errored. Name:`,P.name,"Message:",P.message),E.a_(new He(ke.UNAVAILABLE,"The operation could not be completed")))}),R(b,Vi.EventType.MESSAGE,P=>{if(!A){const k=P.data[0];Ut(!!k,16349);const K=k,oe=K?.error||K[0]?.error;if(oe){Ye(Cr,`RPC '${e}' stream ${o} received error:`,oe);const O=oe.status;let M=function(v){const f=sr[v];if(f!==void 0)return Np(f)}(O),N=oe.message;M===void 0&&(M=ke.INTERNAL,N="Unknown error status: "+O+" with message "+oe.message),A=!0,E.a_(new He(M,N)),b.close()}else Ye(Cr,`RPC '${e}' stream ${o} received:`,k),E.u_(k)}}),R(c,Jy.STAT_EVENT,P=>{P.stat===lc.PROXY?Ye(Cr,`RPC '${e}' stream ${o} detected buffering proxy`):P.stat===lc.NOPROXY&&Ye(Cr,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{E.__()},0),E}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function xl(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function el(t){return new c1(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yp{constructor(e,r,n=1e3,o=1.5,i=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=o,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),o=Math.max(0,r-n);o>0&&Ye("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,o,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ih="PersistentStream";class Kp{constructor(e,r,n,o,i,a,c,u){this.Mi=e,this.S_=n,this.b_=o,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Yp(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===ke.RESOURCE_EXHAUSTED?(kn(r.toString()),kn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===ke.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,o])=>{this.D_===r&&this.G_(n,o)},n=>{e(()=>{const o=new He(ke.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(o)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(o=>{n(()=>this.z_(o))}),this.stream.onMessage(o=>{n(()=>++this.F_==1?this.J_(o):this.onNext(o))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Ye(Ih,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(Ye(Ih,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class sS extends Kp{constructor(e,r,n,o,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,o,a),this.serializer=i}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=h1(this.serializer,e),n=function(i){if(!("targetChange"in i))return dt.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?dt.min():a.readTime?hn(a.readTime):dt.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=bc(this.serializer),r.addTarget=function(i,a){let c;const u=a.target;if(c=mc(u)?{documents:p1(i,u)}:{query:f1(i,u).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Op(i,a.resumeToken);const h=fc(i,a.expectedCount);h!==null&&(c.expectedCount=h)}else if(a.snapshotVersion.compareTo(dt.min())>0){c.readTime=Ra(i,a.snapshotVersion.toTimestamp());const h=fc(i,a.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);const n=v1(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=bc(this.serializer),r.removeTarget=e,this.q_(r)}}class aS extends Kp{constructor(e,r,n,o,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,o,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Ut(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ut(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ut(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=y1(e.writeResults,e.commitTime),n=hn(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=bc(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>m1(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{}class cS extends lS{constructor(e,r,n,o){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new He(ke.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Go(e,gc(r,n),o,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new He(ke.UNKNOWN,i.toString())})}Ho(e,r,n,o,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Ho(e,gc(r,n),o,a,c,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new He(ke.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class dS{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(kn(r),this.aa=!1):Ye("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Do="RemoteStore";class uS{constructor(e,r,n,o,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(a=>{n.enqueueAndForget(async()=>{Mo(this)&&(Ye(Do,"Restarting streams for network reachability change."),await async function(u){const h=ut(u);h.Ea.add(4),await Ps(h),h.Ra.set("Unknown"),h.Ea.delete(4),await tl(h)}(this))})}),this.Ra=new dS(n,o)}}async function tl(t){if(Mo(t))for(const e of t.da)await e(!0)}async function Ps(t){for(const e of t.da)await e(!1)}function Qp(t,e){const r=ut(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),yd(r)?md(r):Si(r).O_()&&hd(r,e))}function ud(t,e){const r=ut(t),n=Si(r);r.Ia.delete(e),n.O_()&&Jp(r,e),r.Ia.size===0&&(n.O_()?n.L_():Mo(r)&&r.Ra.set("Unknown"))}function hd(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(dt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Si(t).Y_(e)}function Jp(t,e){t.Va.Ue(e),Si(t).Z_(e)}function md(t){t.Va=new i1({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Si(t).start(),t.Ra.ua()}function yd(t){return Mo(t)&&!Si(t).x_()&&t.Ia.size>0}function Mo(t){return ut(t).Ea.size===0}function Xp(t){t.Va=void 0}async function hS(t){t.Ra.set("Online")}async function mS(t){t.Ia.forEach((e,r)=>{hd(t,e)})}async function yS(t,e){Xp(t),yd(t)?(t.Ra.ha(e),md(t)):t.Ra.set("Unknown")}async function pS(t,e,r){if(t.Ra.set("Online"),e instanceof Mp&&e.state===2&&e.cause)try{await async function(o,i){const a=i.cause;for(const c of i.targetIds)o.Ia.has(c)&&(await o.remoteSyncer.rejectListen(c,a),o.Ia.delete(c),o.Va.removeTarget(c))}(t,e)}catch(n){Ye(Do,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Na(t,n)}else if(e instanceof ca?t.Va.Ze(e):e instanceof Lp?t.Va.st(e):t.Va.tt(e),!r.isEqual(dt.min()))try{const n=await Wp(t.localStore);r.compareTo(n)>=0&&await function(i,a){const c=i.Va.Tt(a);return c.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const y=i.Ia.get(h);y&&i.Ia.set(h,y.withResumeToken(u.resumeToken,a))}}),c.targetMismatches.forEach((u,h)=>{const y=i.Ia.get(u);if(!y)return;i.Ia.set(u,y.withResumeToken(_r.EMPTY_BYTE_STRING,y.snapshotVersion)),Jp(i,u);const b=new Kn(y.target,u,h,y.sequenceNumber);hd(i,b)}),i.remoteSyncer.applyRemoteEvent(c)}(t,r)}catch(n){Ye(Do,"Failed to raise snapshot:",n),await Na(t,n)}}async function Na(t,e,r){if(!_i(e))throw e;t.Ea.add(1),await Ps(t),t.Ra.set("Offline"),r||(r=()=>Wp(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ye(Do,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await tl(t)})}function Zp(t,e){return e().catch(r=>Na(t,r,e))}async function rl(t){const e=ut(t),r=so(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Jc;for(;fS(e);)try{const o=await J1(e.localStore,n);if(o===null){e.Ta.length===0&&r.L_();break}n=o.batchId,gS(e,o)}catch(o){await Na(e,o)}ef(e)&&tf(e)}function fS(t){return Mo(t)&&t.Ta.length<10}function gS(t,e){t.Ta.push(e);const r=so(t);r.O_()&&r.X_&&r.ea(e.mutations)}function ef(t){return Mo(t)&&!so(t).x_()&&t.Ta.length>0}function tf(t){so(t).start()}async function vS(t){so(t).ra()}async function bS(t){const e=so(t);for(const r of t.Ta)e.ea(r.mutations)}async function _S(t,e,r){const n=t.Ta.shift(),o=od.from(n,e,r);await Zp(t,()=>t.remoteSyncer.applySuccessfulWrite(o)),await rl(t)}async function PS(t,e){e&&so(t).X_&&await async function(n,o){if(function(a){return r1(a)&&a!==ke.ABORTED}(o.code)){const i=n.Ta.shift();so(n).B_(),await Zp(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,o)),await rl(n)}}(t,e),ef(t)&&tf(t)}async function $h(t,e){const r=ut(t);r.asyncQueue.verifyOperationInProgress(),Ye(Do,"RemoteStore received new credentials");const n=Mo(r);r.Ea.add(3),await Ps(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await tl(r)}async function SS(t,e){const r=ut(t);e?(r.Ea.delete(2),await tl(r)):e||(r.Ea.add(2),await Ps(r),r.Ra.set("Unknown"))}function Si(t){return t.ma||(t.ma=function(r,n,o){const i=ut(r);return i.sa(),new sS(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,o)}(t.datastore,t.asyncQueue,{Xo:hS.bind(null,t),t_:mS.bind(null,t),r_:yS.bind(null,t),H_:pS.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),yd(t)?md(t):t.Ra.set("Unknown")):(await t.ma.stop(),Xp(t))})),t.ma}function so(t){return t.fa||(t.fa=function(r,n,o){const i=ut(r);return i.sa(),new aS(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,o)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:vS.bind(null,t),r_:PS.bind(null,t),ta:bS.bind(null,t),na:_S.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await rl(t)):(await t.fa.stop(),t.Ta.length>0&&(Ye(Do,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(e,r,n,o,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=o,this.removalCallback=i,this.deferred=new $n,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,o,i){const a=Date.now()+n,c=new pd(e,r,a,o,i);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new He(ke.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fd(t,e){if(kn("AsyncQueue",`${e}: ${t}`),_i(t))return new He(ke.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{static emptySet(e){return new oi(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||tt.comparator(r.key,n.key):(r,n)=>tt.comparator(r.key,n.key),this.keyedMap=Fi(),this.sortedSet=new Zt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof oi)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const o=r.getNext().key,i=n.getNext().key;if(!o.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new oi;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(){this.ga=new Zt(tt.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):ot(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class mi{constructor(e,r,n,o,i,a,c,u,h){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=o,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,r,n,o,i){const a=[];return r.forEach(c=>{a.push({type:0,doc:c})}),new mi(e,r,oi.emptySet(r),a,n,o,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ka(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let o=0;o<r.length;o++)if(r[o].type!==n[o].type||!r[o].doc.isEqual(n[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class CS{constructor(){this.queries=Th(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const o=ut(r),i=o.queries;o.queries=Th(),i.forEach((a,c)=>{for(const u of c.Sa)u.onError(n)})})(this,new He(ke.ABORTED,"Firestore shutting down"))}}function Th(){return new Lo(t=>Pp(t),Ka)}async function rf(t,e){const r=ut(t);let n=3;const o=e.query;let i=r.queries.get(o);i?!i.ba()&&e.Da()&&(n=2):(i=new wS,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await r.onListen(o,!0);break;case 1:i.wa=await r.onListen(o,!1);break;case 2:await r.onFirstRemoteStoreListen(o)}}catch(a){const c=fd(a,`Initialization of query '${Qo(e.query)}' failed`);return void e.onError(c)}r.queries.set(o,i),i.Sa.push(e),e.va(r.onlineState),i.wa&&e.Fa(i.wa)&&gd(r)}async function nf(t,e){const r=ut(t),n=e.query;let o=3;const i=r.queries.get(n);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?o=e.Da()?0:1:!i.ba()&&e.Da()&&(o=2))}switch(o){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function AS(t,e){const r=ut(t);let n=!1;for(const o of e){const i=o.query,a=r.queries.get(i);if(a){for(const c of a.Sa)c.Fa(o)&&(n=!0);a.wa=o}}n&&gd(r)}function xS(t,e,r){const n=ut(t),o=n.queries.get(e);if(o)for(const i of o.Sa)i.onError(r);n.queries.delete(e)}function gd(t){t.Ca.forEach(e=>{e.next()})}var Sc,kh;(kh=Sc||(Sc={})).Ma="default",kh.Cache="cache";class of{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const o of e.docChanges)o.type!==3&&n.push(o);e=new mi(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=mi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Sc.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf{constructor(e){this.key=e}}class af{constructor(e){this.key=e}}class IS{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Et(),this.mutatedKeys=Et(),this.eu=Sp(e),this.tu=new oi(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new Eh,o=r?r.tu:this.tu;let i=r?r.mutatedKeys:this.mutatedKeys,a=o,c=!1;const u=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,h=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((y,b)=>{const _=o.get(y),A=Qa(this.query,b)?b:null,E=!!_&&this.mutatedKeys.has(_.key),R=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let P=!1;_&&A?_.data.isEqual(A.data)?E!==R&&(n.track({type:3,doc:A}),P=!0):this.su(_,A)||(n.track({type:2,doc:A}),P=!0,(u&&this.eu(A,u)>0||h&&this.eu(A,h)<0)&&(c=!0)):!_&&A?(n.track({type:0,doc:A}),P=!0):_&&!A&&(n.track({type:1,doc:_}),P=!0,(u||h)&&(c=!0)),P&&(A?(a=a.add(A),i=R?i.add(y):i.delete(y)):(a=a.delete(y),i=i.delete(y)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const y=this.query.limitType==="F"?a.last():a.first();a=a.delete(y.key),i=i.delete(y.key),n.track({type:1,doc:y})}return{tu:a,iu:n,Cs:c,mutatedKeys:i}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,o){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((y,b)=>function(A,E){const R=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ot(20277,{Rt:P})}};return R(A)-R(E)}(y.type,b.type)||this.eu(y.doc,b.doc)),this.ou(n),o=o??!1;const c=r&&!o?this._u():[],u=this.Xa.size===0&&this.current&&!o?1:0,h=u!==this.Za;return this.Za=u,a.length!==0||h?{snapshot:new mi(this.query,e.tu,i,a,e.mutatedKeys,u===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Eh,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Et(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new af(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new sf(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=Et();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return mi.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const vd="SyncEngine";class $S{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class ES{constructor(e){this.key=e,this.hu=!1}}class TS{constructor(e,r,n,o,i,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=o,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Lo(c=>Pp(c),Ka),this.Iu=new Map,this.Eu=new Set,this.du=new Zt(tt.comparator),this.Au=new Map,this.Ru=new ad,this.Vu={},this.mu=new Map,this.fu=hi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function kS(t,e,r=!0){const n=mf(t);let o;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),o=i.view.lu()):o=await lf(n,e,r,!0),o}async function RS(t,e){const r=mf(t);await lf(r,e,!0,!1)}async function lf(t,e,r,n){const o=await X1(t.localStore,dn(e)),i=o.targetId,a=t.sharedClientState.addLocalQueryTarget(i,r);let c;return n&&(c=await DS(t,e,i,a==="current",o.resumeToken)),t.isPrimaryClient&&r&&Qp(t.remoteStore,o),c}async function DS(t,e,r,n,o){t.pu=(b,_,A)=>async function(R,P,k,K){let oe=P.view.ru(k);oe.Cs&&(oe=await wh(R.localStore,P.query,!1).then(({documents:g})=>P.view.ru(g,oe)));const O=K&&K.targetChanges.get(P.targetId),M=K&&K.targetMismatches.get(P.targetId)!=null,N=P.view.applyChanges(oe,R.isPrimaryClient,O,M);return Dh(R,P.targetId,N.au),N.snapshot}(t,b,_,A);const i=await wh(t.localStore,e,!0),a=new IS(e,i.Qs),c=a.ru(i.documents),u=_s.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",o),h=a.applyChanges(c,t.isPrimaryClient,u);Dh(t,r,h.au);const y=new $S(e,r,a);return t.Tu.set(e,y),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),h.snapshot}async function NS(t,e,r){const n=ut(t),o=n.Tu.get(e),i=n.Iu.get(o.targetId);if(i.length>1)return n.Iu.set(o.targetId,i.filter(a=>!Ka(a,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(o.targetId),n.sharedClientState.isActiveQueryTarget(o.targetId)||await _c(n.localStore,o.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(o.targetId),r&&ud(n.remoteStore,o.targetId),wc(n,o.targetId)}).catch(bi)):(wc(n,o.targetId),await _c(n.localStore,o.targetId,!0))}async function LS(t,e){const r=ut(t),n=r.Tu.get(e),o=r.Iu.get(n.targetId);r.isPrimaryClient&&o.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),ud(r.remoteStore,n.targetId))}async function MS(t,e,r){const n=zS(t);try{const o=await function(a,c){const u=ut(a),h=Qt.now(),y=c.reduce((A,E)=>A.add(E.key),Et());let b,_;return u.persistence.runTransaction("Locally write mutations","readwrite",A=>{let E=Dn(),R=Et();return u.Ns.getEntries(A,y).next(P=>{E=P,E.forEach((k,K)=>{K.isValidDocument()||(R=R.add(k))})}).next(()=>u.localDocuments.getOverlayedDocuments(A,E)).next(P=>{b=P;const k=[];for(const K of c){const oe=JP(K,b.get(K.key).overlayedDocument);oe!=null&&k.push(new ho(K.key,oe,mp(oe.value.mapValue),un.exists(!0)))}return u.mutationQueue.addMutationBatch(A,h,k,c)}).next(P=>{_=P;const k=P.applyToLocalDocumentSet(b,R);return u.documentOverlayCache.saveOverlays(A,P.batchId,k)})}).then(()=>({batchId:_.batchId,changes:Cp(b)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(o.batchId),function(a,c,u){let h=a.Vu[a.currentUser.toKey()];h||(h=new Zt($t)),h=h.insert(c,u),a.Vu[a.currentUser.toKey()]=h}(n,o.batchId,r),await Ss(n,o.changes),await rl(n.remoteStore)}catch(o){const i=fd(o,"Failed to persist write");r.reject(i)}}async function cf(t,e){const r=ut(t);try{const n=await K1(r.localStore,e);e.targetChanges.forEach((o,i)=>{const a=r.Au.get(i);a&&(Ut(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?a.hu=!0:o.modifiedDocuments.size>0?Ut(a.hu,14607):o.removedDocuments.size>0&&(Ut(a.hu,42227),a.hu=!1))}),await Ss(r,n,e)}catch(n){await bi(n)}}function Rh(t,e,r){const n=ut(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const o=[];n.Tu.forEach((i,a)=>{const c=a.view.va(e);c.snapshot&&o.push(c.snapshot)}),function(a,c){const u=ut(a);u.onlineState=c;let h=!1;u.queries.forEach((y,b)=>{for(const _ of b.Sa)_.va(c)&&(h=!0)}),h&&gd(u)}(n.eventManager,e),o.length&&n.Pu.H_(o),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function OS(t,e,r){const n=ut(t);n.sharedClientState.updateQueryState(e,"rejected",r);const o=n.Au.get(e),i=o&&o.key;if(i){let a=new Zt(tt.comparator);a=a.insert(i,Ir.newNoDocument(i,dt.min()));const c=Et().add(i),u=new Za(dt.min(),new Map,new Zt($t),a,c);await cf(n,u),n.du=n.du.remove(i),n.Au.delete(e),bd(n)}else await _c(n.localStore,e,!1).then(()=>wc(n,e,r)).catch(bi)}async function VS(t,e){const r=ut(t),n=e.batch.batchId;try{const o=await Y1(r.localStore,e);uf(r,n,null),df(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Ss(r,o)}catch(o){await bi(o)}}async function FS(t,e,r){const n=ut(t);try{const o=await function(a,c){const u=ut(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let y;return u.mutationQueue.lookupMutationBatch(h,c).next(b=>(Ut(b!==null,37113),y=b.keys(),u.mutationQueue.removeMutationBatch(h,b))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,y,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,y)).next(()=>u.localDocuments.getDocuments(h,y))})}(n.localStore,e);uf(n,e,r),df(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Ss(n,o)}catch(o){await bi(o)}}function df(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function uf(t,e,r){const n=ut(t);let o=n.Vu[n.currentUser.toKey()];if(o){const i=o.get(e);i&&(r?i.reject(r):i.resolve(),o=o.remove(e)),n.Vu[n.currentUser.toKey()]=o}}function wc(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||hf(t,n)})}function hf(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(ud(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),bd(t))}function Dh(t,e,r){for(const n of r)n instanceof sf?(t.Ru.addReference(n.key,e),BS(t,n)):n instanceof af?(Ye(vd,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||hf(t,n.key)):ot(19791,{wu:n})}function BS(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Ye(vd,"New document in limbo: "+r),t.Eu.add(n),bd(t))}function bd(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new tt(Yt.fromString(e)),n=t.fu.next();t.Au.set(n,new ES(r)),t.du=t.du.insert(r,n),Qp(t.remoteStore,new Kn(dn(rd(r.path)),n,"TargetPurposeLimboResolution",Ha.ce))}}async function Ss(t,e,r){const n=ut(t),o=[],i=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach((c,u)=>{a.push(n.pu(u,e,r).then(h=>{if((h||r)&&n.isPrimaryClient){const y=h?!h.fromCache:r?.targetChanges.get(u.targetId)?.current;n.sharedClientState.updateQueryState(u.targetId,y?"current":"not-current")}if(h){o.push(h);const y=cd.As(u.targetId,h);i.push(y)}}))}),await Promise.all(a),n.Pu.H_(o),await async function(u,h){const y=ut(u);try{await y.persistence.runTransaction("notifyLocalViewChanges","readwrite",b=>Ne.forEach(h,_=>Ne.forEach(_.Es,A=>y.persistence.referenceDelegate.addReference(b,_.targetId,A)).next(()=>Ne.forEach(_.ds,A=>y.persistence.referenceDelegate.removeReference(b,_.targetId,A)))))}catch(b){if(!_i(b))throw b;Ye(dd,"Failed to update sequence numbers: "+b)}for(const b of h){const _=b.targetId;if(!b.fromCache){const A=y.Ms.get(_),E=A.snapshotVersion,R=A.withLastLimboFreeSnapshotVersion(E);y.Ms=y.Ms.insert(_,R)}}}(n.localStore,i))}async function US(t,e){const r=ut(t);if(!r.currentUser.isEqual(e)){Ye(vd,"User change. New user:",e.toKey());const n=await Hp(r.localStore,e);r.currentUser=e,function(i,a){i.mu.forEach(c=>{c.forEach(u=>{u.reject(new He(ke.CANCELLED,a))})}),i.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Ss(r,n.Ls)}}function jS(t,e){const r=ut(t),n=r.Au.get(e);if(n&&n.hu)return Et().add(n.key);{let o=Et();const i=r.Iu.get(e);if(!i)return o;for(const a of i){const c=r.Tu.get(a);o=o.unionWith(c.view.nu)}return o}}function mf(t){const e=ut(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=cf.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=jS.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=OS.bind(null,e),e.Pu.H_=AS.bind(null,e.eventManager),e.Pu.yu=xS.bind(null,e.eventManager),e}function zS(t){const e=ut(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=VS.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=FS.bind(null,e),e}class La{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=el(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return W1(this.persistence,new q1,e.initialUser,this.serializer)}Cu(e){return new Gp(ld.mi,this.serializer)}Du(e){return new eS}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}La.provider={build:()=>new La};class qS extends La{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Ut(this.persistence.referenceDelegate instanceof Da,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new E1(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?Nr.withCacheSize(this.cacheSizeBytes):Nr.DEFAULT;return new Gp(n=>Da.mi(n,r),this.serializer)}}class Cc{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Rh(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=US.bind(null,this.syncEngine),await SS(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new CS}()}createDatastore(e){const r=el(e.databaseInfo.databaseId),n=function(i){return new iS(i)}(e.databaseInfo);return function(i,a,c,u){return new cS(i,a,c,u)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,o,i,a,c){return new uS(n,o,i,a,c)}(this.localStore,this.datastore,e.asyncQueue,r=>Rh(this.syncEngine,r,0),function(){return xh.v()?new xh:new tS}())}createSyncEngine(e,r){return function(o,i,a,c,u,h,y){const b=new TS(o,i,a,c,u,h);return y&&(b.gu=!0),b}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(r){const n=ut(r);Ye(Do,"RemoteStore shutting down."),n.Ea.add(5),await Ps(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Cc.provider={build:()=>new Cc};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):kn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ao="FirestoreClient";class GS{constructor(e,r,n,o,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=o,this.user=xr.UNAUTHENTICATED,this.clientId=Qc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async a=>{Ye(ao,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Ye(ao,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new $n;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=fd(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Il(t,e){t.asyncQueue.verifyOperationInProgress(),Ye(ao,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async o=>{n.isEqual(o)||(await Hp(e.localStore,o),n=o)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Nh(t,e){t.asyncQueue.verifyOperationInProgress();const r=await HS(t);Ye(ao,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>$h(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,o)=>$h(e.remoteStore,o)),t._onlineComponents=e}async function HS(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ye(ao,"Using user provided OfflineComponentProvider");try{await Il(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(o){return o.name==="FirebaseError"?o.code===ke.FAILED_PRECONDITION||o.code===ke.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(r))throw r;li("Error using user provided cache. Falling back to memory cache: "+r),await Il(t,new La)}}else Ye(ao,"Using default OfflineComponentProvider"),await Il(t,new qS(void 0));return t._offlineComponents}async function pf(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ye(ao,"Using user provided OnlineComponentProvider"),await Nh(t,t._uninitializedComponentsProvider._online)):(Ye(ao,"Using default OnlineComponentProvider"),await Nh(t,new Cc))),t._onlineComponents}function WS(t){return pf(t).then(e=>e.syncEngine)}async function ff(t){const e=await pf(t),r=e.eventManager;return r.onListen=kS.bind(null,e.syncEngine),r.onUnlisten=NS.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=RS.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=LS.bind(null,e.syncEngine),r}function YS(t,e,r={}){const n=new $n;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,u,h){const y=new yf({next:_=>{y.Nu(),a.enqueueAndForget(()=>nf(i,b));const A=_.docs.has(c);!A&&_.fromCache?h.reject(new He(ke.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&_.fromCache&&u&&u.source==="server"?h.reject(new He(ke.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(_)},error:_=>h.reject(_)}),b=new of(rd(c.path),y,{includeMetadataChanges:!0,qa:!0});return rf(i,b)}(await ff(t),t.asyncQueue,e,r,n)),n.promise}function KS(t,e,r={}){const n=new $n;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,c,u,h){const y=new yf({next:_=>{y.Nu(),a.enqueueAndForget(()=>nf(i,b)),_.fromCache&&u.source==="server"?h.reject(new He(ke.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(_)},error:_=>h.reject(_)}),b=new of(c,y,{includeMetadataChanges:!0,qa:!0});return rf(i,b)}(await ff(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gf(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lh=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vf="firestore.googleapis.com",Mh=!0;class Oh{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new He(ke.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=vf,this.ssl=Mh}else this.host=e.host,this.ssl=e.ssl??Mh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=qp;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<I1)throw new He(ke.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}uP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=gf(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new He(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new He(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new He(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,o){return n.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class nl{constructor(e,r,n,o){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Oh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new He(ke.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new He(ke.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Oh(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new tP;switch(n.type){case"firstParty":return new iP(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new He(ke.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=Lh.get(r);n&&(Ye("ComponentProvider","Removing Datastore"),Lh.delete(r),n.terminate())}(this),Promise.resolve()}}function QS(t,e,r,n={}){t=Rn(t,nl);const o=pi(e),i=t._getSettings(),a={...i,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${r}`;o&&(sy(`https://${c}`),ay("Firestore",!0)),i.host!==vf&&i.host!==c&&li("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:c,ssl:o,emulatorOptions:n};if(!Eo(u,a)&&(t._setSettings(u),n.mockUserToken)){let h,y;if(typeof n.mockUserToken=="string")h=n.mockUserToken,y=xr.MOCK_USER;else{h=Av(n.mockUserToken,t._app?.options.projectId);const b=n.mockUserToken.sub||n.mockUserToken.user_id;if(!b)throw new He(ke.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new xr(b)}t._authCredentials=new rP(new tp(h,y))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Oo(this.firestore,e,this._query)}}class nr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new to(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new nr(this.firestore,e,this._key)}toJSON(){return{type:nr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(vs(r,nr._jsonSchema))return new nr(e,n||null,new tt(Yt.fromString(r.referencePath)))}}nr._jsonSchemaVersion="firestore/documentReference/1.0",nr._jsonSchema={type:lr("string",nr._jsonSchemaVersion),referencePath:lr("string")};class to extends Oo{constructor(e,r,n){super(e,r,rd(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new nr(this.firestore,null,new tt(e))}withConverter(e){return new to(this.firestore,e,this._path)}}function JS(t,e,...r){if(t=br(t),rp("collection","path",e),t instanceof nl){const n=Yt.fromString(e,...r);return Qu(n),new to(t,null,n)}{if(!(t instanceof nr||t instanceof to))throw new He(ke.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Yt.fromString(e,...r));return Qu(n),new to(t.firestore,null,n)}}function bf(t,e,...r){if(t=br(t),arguments.length===1&&(e=Qc.newId()),rp("doc","path",e),t instanceof nl){const n=Yt.fromString(e,...r);return Ku(n),new nr(t,null,new tt(n))}{if(!(t instanceof nr||t instanceof to))throw new He(ke.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Yt.fromString(e,...r));return Ku(n),new nr(t.firestore,t instanceof to?t.converter:null,new tt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vh="AsyncQueue";class Fh{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Yp(this,"async_queue_retry"),this._c=()=>{const n=xl();n&&Ye(Vh,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=xl();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=xl();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new $n;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!_i(e))throw e;Ye(Vh,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,kn("INTERNAL UNHANDLED ERROR: ",Bh(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const o=pd.createAndSchedule(this,e,r,n,i=>this.hc(i));return this.tc.push(o),o}uc(){this.nc&&ot(47125,{Pc:Bh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function Bh(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class ws extends nl{constructor(e,r,n,o){super(e,r,n,o),this.type="firestore",this._queue=new Fh,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Fh(e),this._firestoreClient=void 0,await e}}}function XS(t,e){const r=typeof t=="object"?t:uy(),n=typeof t=="string"?t:Ia,o=Vc(r,"firestore").getImmediate({identifier:n});if(!o._initialized){const i=wv("firestore");i&&QS(o,...i)}return o}function _d(t){if(t._terminated)throw new He(ke.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||ZS(t),t._firestoreClient}function ZS(t){const e=t._freezeSettings(),r=function(o,i,a,c){return new SP(o,i,a,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,gf(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new GS(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(o){const i=o?._online.build();return{_offline:o?._offline.build(i),_online:i}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new qr(_r.fromBase64String(e))}catch(r){throw new He(ke.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new qr(_r.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:qr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(vs(e,qr._jsonSchema))return qr.fromBase64String(e.bytes)}}qr._jsonSchemaVersion="firestore/bytes/1.0",qr._jsonSchema={type:lr("string",qr._jsonSchemaVersion),bytes:lr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new He(ke.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new gr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new He(ke.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new He(ke.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return $t(this._lat,e._lat)||$t(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:mn._jsonSchemaVersion}}static fromJSON(e){if(vs(e,mn._jsonSchema))return new mn(e.latitude,e.longitude)}}mn._jsonSchemaVersion="firestore/geoPoint/1.0",mn._jsonSchema={type:lr("string",mn._jsonSchemaVersion),latitude:lr("number"),longitude:lr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,o){if(n.length!==o.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==o[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:yn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(vs(e,yn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new yn(e.vectorValues);throw new He(ke.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}yn._jsonSchemaVersion="firestore/vectorValue/1.0",yn._jsonSchema={type:lr("string",yn._jsonSchemaVersion),vectorValues:lr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ew=/^__.*__$/;class tw{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new ho(e,this.data,this.fieldMask,r,this.fieldTransforms):new bs(e,this.data,r,this.fieldTransforms)}}class _f{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new ho(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function Pf(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ot(40011,{Ac:t})}}class Sd{constructor(e,r,n,o,i,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=o,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Sd({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Ma(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Pf(this.Ac)&&ew.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class rw{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||el(e)}Cc(e,r,n,o=!1){return new Sd({Ac:e,methodName:r,Dc:n,path:gr.emptyPath(),fc:!1,bc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function wd(t){const e=t._freezeSettings(),r=el(t._databaseId);return new rw(t._databaseId,!!e.ignoreUndefinedProperties,r)}function nw(t,e,r,n,o,i={}){const a=t.Cc(i.merge||i.mergeFields?2:0,e,r,o);Cd("Data must be an object, but it was:",a,n);const c=Sf(n,a);let u,h;if(i.merge)u=new Fr(a.fieldMask),h=a.fieldTransforms;else if(i.mergeFields){const y=[];for(const b of i.mergeFields){const _=Ac(e,b,r);if(!a.contains(_))throw new He(ke.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);Cf(y,_)||y.push(_)}u=new Fr(y),h=a.fieldTransforms.filter(b=>u.covers(b.field))}else u=null,h=a.fieldTransforms;return new tw(new Lr(c),u,h)}class il extends Pd{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof il}}function ow(t,e,r,n){const o=t.Cc(1,e,r);Cd("Data must be an object, but it was:",o,n);const i=[],a=Lr.empty();uo(n,(u,h)=>{const y=Ad(e,u,r);h=br(h);const b=o.yc(y);if(h instanceof il)i.push(y);else{const _=Cs(h,b);_!=null&&(i.push(y),a.set(y,_))}});const c=new Fr(i);return new _f(a,c,o.fieldTransforms)}function iw(t,e,r,n,o,i){const a=t.Cc(1,e,r),c=[Ac(e,n,r)],u=[o];if(i.length%2!=0)throw new He(ke.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<i.length;_+=2)c.push(Ac(e,i[_])),u.push(i[_+1]);const h=[],y=Lr.empty();for(let _=c.length-1;_>=0;--_)if(!Cf(h,c[_])){const A=c[_];let E=u[_];E=br(E);const R=a.yc(A);if(E instanceof il)h.push(A);else{const P=Cs(E,R);P!=null&&(h.push(A),y.set(A,P))}}const b=new Fr(h);return new _f(y,b,a.fieldTransforms)}function sw(t,e,r,n=!1){return Cs(r,t.Cc(n?4:3,e))}function Cs(t,e){if(wf(t=br(t)))return Cd("Unsupported field value:",e,t),Sf(t,e);if(t instanceof Pd)return function(n,o){if(!Pf(o.Ac))throw o.Sc(`${n._methodName}() can only be used with update() and set()`);if(!o.path)throw o.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(o);i&&o.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,o){const i=[];let a=0;for(const c of n){let u=Cs(c,o.wc(a));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),a++}return{arrayValue:{values:i}}}(t,e)}return function(n,o){if((n=br(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return GP(o.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=Qt.fromDate(n);return{timestampValue:Ra(o.serializer,i)}}if(n instanceof Qt){const i=new Qt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Ra(o.serializer,i)}}if(n instanceof mn)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof qr)return{bytesValue:Op(o.serializer,n._byteString)};if(n instanceof nr){const i=o.databaseId,a=n.firestore._databaseId;if(!a.isEqual(i))throw o.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:sd(n.firestore._databaseId||o.databaseId,n._key.path)}}if(n instanceof yn)return function(a,c){return{mapValue:{fields:{[up]:{stringValue:hp},[$a]:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return nd(c.serializer,h)})}}}}}}(n,o);throw o.Sc(`Unsupported field value: ${Ga(n)}`)}(t,e)}function Sf(t,e){const r={};return ip(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):uo(t,(n,o)=>{const i=Cs(o,e.mc(n));i!=null&&(r[n]=i)}),{mapValue:{fields:r}}}function wf(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Qt||t instanceof mn||t instanceof qr||t instanceof nr||t instanceof Pd||t instanceof yn)}function Cd(t,e,r){if(!wf(r)||!np(r)){const n=Ga(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function Ac(t,e,r){if((e=br(e))instanceof ol)return e._internalPath;if(typeof e=="string")return Ad(t,e);throw Ma("Field path arguments must be of type string or ",t,!1,void 0,r)}const aw=new RegExp("[~\\*/\\[\\]]");function Ad(t,e,r){if(e.search(aw)>=0)throw Ma(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new ol(...e.split("."))._internalPath}catch{throw Ma(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Ma(t,e,r,n,o){const i=n&&!n.isEmpty(),a=o!==void 0;let c=`Function ${e}() called with invalid data`;r&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||a)&&(u+=" (found",i&&(u+=` in field ${n}`),a&&(u+=` in document ${o}`),u+=")"),new He(ke.INVALID_ARGUMENT,c+t+u)}function Cf(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af{constructor(e,r,n,o,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=o,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new nr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new lw(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(xd("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class lw extends Af{data(){return super.data()}}function xd(t,e){return typeof e=="string"?Ad(t,e):e instanceof ol?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cw(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new He(ke.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Id{}class xf extends Id{}function dw(t,e,...r){let n=[];e instanceof Id&&n.push(e),n=n.concat(r),function(i){const a=i.filter(u=>u instanceof Ed).length,c=i.filter(u=>u instanceof $d).length;if(a>1||a>0&&c>0)throw new He(ke.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const o of n)t=o._apply(t);return t}class $d extends xf{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new $d(e,r,n)}_apply(e){const r=this._parse(e);return If(e._query,r),new Oo(e.firestore,e.converter,yc(e._query,r))}_parse(e){const r=wd(e.firestore);return function(i,a,c,u,h,y,b){let _;if(h.isKeyField()){if(y==="array-contains"||y==="array-contains-any")throw new He(ke.INVALID_ARGUMENT,`Invalid Query. You can't perform '${y}' queries on documentId().`);if(y==="in"||y==="not-in"){jh(b,y);const E=[];for(const R of b)E.push(Uh(u,i,R));_={arrayValue:{values:E}}}else _=Uh(u,i,b)}else y!=="in"&&y!=="not-in"&&y!=="array-contains-any"||jh(b,y),_=sw(c,a,b,y==="in"||y==="not-in");return ar.create(h,y,_)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}class Ed extends Id{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Ed(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Zr.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(o,i){let a=o;const c=i.getFlattenedFilters();for(const u of c)If(a,u),a=yc(a,u)}(e._query,r),new Oo(e.firestore,e.converter,yc(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Td extends xf{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new Td(e,r)}_apply(e){const r=function(o,i,a){if(o.startAt!==null)throw new He(ke.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new He(ke.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ls(i,a)}(e._query,this._field,this._direction);return new Oo(e.firestore,e.converter,function(o,i){const a=o.explicitOrderBy.concat([i]);return new Pi(o.path,o.collectionGroup,a,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)}(e._query,r))}}function uw(t,e="asc"){const r=e,n=xd("orderBy",t);return Td._create(n,r)}function Uh(t,e,r){if(typeof(r=br(r))=="string"){if(r==="")throw new He(ke.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!_p(e)&&r.indexOf("/")!==-1)throw new He(ke.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Yt.fromString(r));if(!tt.isDocumentKey(n))throw new He(ke.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return oh(t,new tt(n))}if(r instanceof nr)return oh(t,r._key);throw new He(ke.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ga(r)}.`)}function jh(t,e){if(!Array.isArray(t)||t.length===0)throw new He(ke.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function If(t,e){const r=function(o,i){for(const a of o)for(const c of a.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new He(ke.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new He(ke.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class hw{convertValue(e,r="none"){switch(io(e)){case 0:return null;case 1:return e.booleanValue;case 2:return rr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(oo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ot(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return uo(e,(o,i)=>{n[o]=this.convertValue(i,r)}),n}convertVectorValue(e){const r=e.fields?.[$a].arrayValue?.values?.map(n=>rr(n.doubleValue));return new yn(r)}convertGeoPoint(e){return new mn(rr(e.latitude),rr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Ya(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(is(e));default:return null}}convertTimestamp(e){const r=no(e);return new Qt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Yt.fromString(e);Ut(zp(n),9688,{name:e});const o=new ss(n.get(1),n.get(3)),i=new tt(n.popFirst(5));return o.isEqual(r)||kn(`Document ${i} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mw(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class Ui{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class $o extends Af{constructor(e,r,n,o,i,a){super(e,r,n,o,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new da(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(xd("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new He(ke.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=$o._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}$o._jsonSchemaVersion="firestore/documentSnapshot/1.0",$o._jsonSchema={type:lr("string",$o._jsonSchemaVersion),bundleSource:lr("string","DocumentSnapshot"),bundleName:lr("string"),bundle:lr("string")};class da extends $o{data(e={}){return super.data(e)}}class ii{constructor(e,r,n,o){this._firestore=e,this._userDataWriter=r,this._snapshot=o,this.metadata=new Ui(o.hasPendingWrites,o.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new da(this._firestore,this._userDataWriter,n.key,n,new Ui(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new He(ke.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(o,i){if(o._snapshot.oldDocs.isEmpty()){let a=0;return o._snapshot.docChanges.map(c=>{const u=new da(o._firestore,o._userDataWriter,c.doc.key,c.doc,new Ui(o._snapshot.mutatedKeys.has(c.doc.key),o._snapshot.fromCache),o.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const u=new da(o._firestore,o._userDataWriter,c.doc.key,c.doc,new Ui(o._snapshot.mutatedKeys.has(c.doc.key),o._snapshot.fromCache),o.query.converter);let h=-1,y=-1;return c.type!==0&&(h=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),y=a.indexOf(c.doc.key)),{type:yw(c.type),doc:u,oldIndex:h,newIndex:y}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new He(ke.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ii._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Qc.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],o=[];return this.docs.forEach(i=>{i._document!==null&&(r.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),o.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function yw(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ot(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pw(t){t=Rn(t,nr);const e=Rn(t.firestore,ws);return YS(_d(e),t._key).then(r=>vw(e,t,r))}ii._jsonSchemaVersion="firestore/querySnapshot/1.0",ii._jsonSchema={type:lr("string",ii._jsonSchemaVersion),bundleSource:lr("string","QuerySnapshot"),bundleName:lr("string"),bundle:lr("string")};class $f extends hw{constructor(e){super(),this.firestore=e}convertBytes(e){return new qr(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new nr(this.firestore,null,r)}}function fw(t){t=Rn(t,Oo);const e=Rn(t.firestore,ws),r=_d(e),n=new $f(e);return cw(t._query),KS(r,t._query).then(o=>new ii(e,n,t,o))}function gw(t,e,r){t=Rn(t,nr);const n=Rn(t.firestore,ws),o=mw(t.converter,e);return Tf(n,[nw(wd(n),"setDoc",t._key,o,t.converter!==null,r).toMutation(t._key,un.none())])}function Ef(t,e,r,...n){t=Rn(t,nr);const o=Rn(t.firestore,ws),i=wd(o);let a;return a=typeof(e=br(e))=="string"||e instanceof ol?iw(i,"updateDoc",t._key,e,r,n):ow(i,"updateDoc",t._key,e),Tf(o,[a.toMutation(t._key,un.exists(!0))])}function Tf(t,e){return function(n,o){const i=new $n;return n.asyncQueue.enqueueAndForget(async()=>MS(await WS(n),o,i)),i.promise}(_d(t),e)}function vw(t,e,r){const n=r.docs.get(e._key),o=new $f(t);return new $o(t,o,e._key,n,new Ui(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(o){vi=o})(fi),si(new To("firestore",(n,{instanceIdentifier:o,options:i})=>{const a=n.getProvider("app").getImmediate(),c=new ws(new nP(n.getProvider("auth-internal")),new sP(a,n.getProvider("app-check-internal")),function(h,y){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new He(ke.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ss(h.options.projectId,y)}(a,o),a);return i={useFetchStreams:r,...i},c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),Xn(Gu,Hu,e),Xn(Gu,Hu,"esm2020")})();let bw="eyAiYXBpS2V5IjogIkFJemFTeUJBbGN2WlRMMXRsQ05LRExENEJpTWJhR01iTnhCRjQtTSIsICAiYXV0aERvbWFpbiI6ICJocm0tMTEyOC5maXJlYmFzZWFwcC5jb20iLCAgImRhdGFiYXNlVVJMIjogImh0dHBzOi8vaHJtLTExMjguZmlyZWJhc2Vpby5jb20iLCAgInByb2plY3RJZCI6ICJocm0tMTEyOCIsICAic3RvcmFnZUJ1Y2tldCI6ICJocm0tMTEyOC5hcHBzcG90LmNvbSIsICAibWVzc2FnaW5nU2VuZGVySWQiOiAiMTA0OTI1MDU4NTI0NSIsICAiYXBwSWQiOiAiMToxMDQ5MjUwNTg1MjQ1OndlYjowZGFkMDAyMDI3MjM1MTRjY2M1Mjc0In0=";const kf=dy(JSON.parse(uv(bw))),Co=J_(kf),Oa=new an,xc=XS(kf);Oa.addScope("profile");Oa.addScope("email");class ji extends Error{}ji.prototype.name="InvalidTokenError";function _w(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function Pw(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return _w(e)}catch{return atob(e)}}function Sw(t,e){if(typeof t!="string")throw new ji("Invalid token specified: must be a string");e||(e={});const r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new ji(`Invalid token specified: missing part #${r+1}`);let o;try{o=Pw(n)}catch(i){throw new ji(`Invalid token specified: invalid base64 for part #${r+1} (${i.message})`)}try{return JSON.parse(o)}catch(i){throw new ji(`Invalid token specified: invalid json for part #${r+1} (${i.message})`)}}const ww={clientId:"195275085181-8ccjpgp8v1g80qhnlk6v4lpgid7n81gr.apps.googleusercontent.com"},Cw=t=>{const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>{window.google&&window.google.accounts.id.initialize({client_id:ww.clientId,callback:r=>{t(r.credential)},auto_select:!1,cancel_on_tap_outside:!0})},document.head.appendChild(e)},Aw=t=>Sw(t),xw=()=>{window.google&&window.google.accounts.id.disableAutoSelect()},[Iw,$w]=Ba({}),Ew=async()=>{const e=await wn({query:"qcm42351987"});if(e&&!e.error){let n=Object.assign({},{},e);$w(n)}return 1},Tw=async t=>{let e=Iw?.[992002];e&&(e.params={tkn:t},await wn(e))},[qo,Ar]=Ba({user:null,loading:!0,error:null,authMethod:null}),[Rf,zh]=fe(null);V0(Co,t=>{t?Ar({user:t,loading:!1,error:null,authMethod:"firebase"}):Rf()||Ar({user:null,loading:!1,error:null,authMethod:null})});m_(Co).then(t=>{t&&Ar({user:t.user,loading:!1,error:null,authMethod:"firebase"})}).catch(t=>{console.error("Redirect sign-in error:",t),Ar({loading:!1,error:t.message})});const wt={get state(){return qo},async getUserProfile(t){try{const e=bf(xc,"users",t),r=await pw(e);if(r.exists()){Ar("profile",r.data());let n={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1},o=r.data(),i={};return Object.keys(n).map(a=>{let c=n?.[a];o.hasOwnProperty(a)||(i[a]=c)}),Object.keys(i).length>0&&Ef(e,i),r.data()}else{let n=wt?.state?.user,o={uid:n?.uid,email:n?.email,displayName:n?.displayName,createdAt:new Date,stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};return await gw(e,o),console.log("No such user profile!"),null}}catch(e){return console.error("Error fetching user profile:",e),null}},hasPermission:t=>{const e=wt.state?.profile;return e?.isAdmin?!0:e?e?.[t]===!0:!1},async signInWithGoogle(){try{Ar("loading",!0),Ar("error",null);try{const t=await i_(Co,Oa);Ar({user:t.user,loading:!1,error:null,authMethod:"firebase"});try{wt.getUserProfile(t.user.uid)}catch(e){console.error("firestore error:",e)}}catch(t){if(t.code==="auth/popup-blocked")await u_(Co,Oa);else throw t}}catch(t){console.error("Sign-in error:",t),Ar({loading:!1,error:t.message||"Failed to sign in with Google"})}},async signInWithGoogleP(t){const r=await wn({params:{id_token:t},query:"getGoogleUserbyToken"});if(r&&r){let n=new Date().getTime(),o=new Date(n+6e4*60*24*365),i="hrm_tkn_acc";document.cookie=`${i}=${r.data}; expires=${o}; path=/;g_state = {"i_l":1,"i_p":${o}}; ssgl_access_tkn = ${t}`,document.cookie=`ssgl_access_tkn = ${t}; expires=${o};`,await Ew(),Tw(r.data)}},async signInWithGoogleCloud(t){try{Ar("loading",!0),Ar("error",null);const e=Aw(t),r={uid:e.sub,email:e.email,displayName:e.name,photoURL:e.picture};zh(r);const n={uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,emailVerified:!0};Ar({user:n,loading:!1,error:null,authMethod:"google-cloud"});try{const o=an.credential(t);await L0(Co,o)}catch{console.log("Firebase sign-in optional, continuing with Google Cloud auth")}}catch(e){console.error("Google Cloud sign-in error:",e),Ar({loading:!1,error:e.message||"Failed to sign in with Google Cloud"})}},async signOut(){try{Ar("loading",!0),(qo.authMethod==="firebase"||Co.currentUser)&&await F0(Co),qo.authMethod==="google-cloud"&&(xw(),zh(null)),Ar({user:null,loading:!1,error:null,authMethod:null})}catch(t){console.error("Sign-out error:",t),Ar({loading:!1,error:t.message||"Failed to sign out"})}},get isAuthenticated(){return!!qo.user||!!Rf()},get currentUser(){return qo.user},get authMethod(){return qo.authMethod}};var kw=z("<p>"),Rw=z('<div><div><div><h1>HRM Finance</h1><p>Complete Business Management Solution</p><div><div><button><svg width=24 height=24 viewBox="0 0 24 24"><path fill=#4285F4 d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path><path fill=#34A853 d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path><path fill=#FBBC05 d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path><path fill=#EA4335 d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path></svg></button><p>Firebase Authentication</p></div></div></div><div><div><div>💰</div><h3>Financial Management</h3><p>Complete chart of accounts, balance sheets, journal entries, and invoice management in one place.</p></div><div><div>👥</div><h3>HR Management</h3><p>Track employees, manage onboarding, and monitor your workforce with powerful analytics.</p></div><div><div>📦</div><h3>Inventory Control</h3><p>Real-time inventory tracking, product management, and movement history across multiple locations.</p></div><div><div>🏦</div><h3>Banking Integration</h3><p>Streamline bank reconciliation with CSV imports and automated consolidation features.</p></div><div><div>📊</div><h3>Real-time Analytics</h3><p>Get instant insights with dashboards showing revenue, cash flow, and business performance.</p></div><div><div>🌐</div><h3>Multi-language Support</h3><p>Available in multiple languages to support your global business operations.</p></div></div><div><p>Secure authentication powered by Google • Your data is encrypted and protected</p><p>Choose your preferred authentication method above');const Dw=()=>{Hr(()=>{Cw(P=>{wt.signInWithGoogleP(P)}),setTimeout(()=>{},100)});const t={"min-height":"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},e={background:"white","border-radius":"1rem","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","max-width":"1200px",width:"100%",overflow:"hidden"},r={padding:"3rem","text-align":"center","border-bottom":"1px solid #e2e8f0"},n={"font-size":"2.5rem","font-weight":"800",color:"#1a202c","margin-bottom":"1rem"},o={"font-size":"1.125rem",color:"#718096","margin-bottom":"2rem"},i={display:"flex","flex-direction":"column",gap:"1rem","align-items":"center","margin-bottom":"1rem"},a={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"2rem",padding:"3rem"},c={"text-align":"center",padding:"2rem","border-radius":"0.5rem",background:"#f7fafc",transition:"transform 0.2s",cursor:"default"},u={"font-size":"3rem","margin-bottom":"1rem"},h={"font-size":"1.25rem","font-weight":"600",color:"#2d3748","margin-bottom":"0.5rem"},y={color:"#718096","line-height":"1.6"},b={display:"inline-flex","align-items":"center",gap:"0.75rem",background:"white",color:"#4285f4",border:"2px solid #4285f4",padding:"0.75rem 2rem","font-size":"1.125rem","font-weight":"500","border-radius":"0.5rem",cursor:"pointer",transition:"all 0.2s","min-width":"250px","justify-content":"center"},_={color:"#e53e3e","margin-top":"1rem","font-size":"0.875rem"},A={background:"#f7fafc",padding:"2rem","text-align":"center",color:"#718096","font-size":"0.875rem"},E={"font-size":"0.75rem",color:"#718096","margin-top":"0.25rem","font-style":"italic"},R=()=>{wt.signInWithGoogle()};return(()=>{var P=Rw(),k=P.firstChild,K=k.firstChild,oe=K.firstChild,O=oe.nextSibling,M=O.nextSibling,N=M.firstChild,g=N.firstChild;g.firstChild;var v=g.nextSibling,f=K.nextSibling,C=f.firstChild,S=C.firstChild,x=S.nextSibling,m=x.nextSibling,re=C.nextSibling,Y=re.firstChild,$=Y.nextSibling,V=$.nextSibling,Q=re.nextSibling,L=Q.firstChild,D=L.nextSibling,j=D.nextSibling,ue=Q.nextSibling,W=ue.firstChild,ce=W.nextSibling,T=ce.nextSibling,G=ue.nextSibling,Z=G.firstChild,F=Z.nextSibling,ne=F.nextSibling,H=G.nextSibling,U=H.firstChild,ae=U.nextSibling,se=ae.nextSibling,pe=f.nextSibling,de=pe.firstChild,ye=de.nextSibling;return d(P,t),d(k,e),d(K,r),d(oe,n),d(O,o),d(M,i),g.addEventListener("mouseleave",X=>{X.currentTarget.style.background="white",X.currentTarget.style.color="#4285f4"}),g.addEventListener("mouseenter",X=>{X.currentTarget.style.background="#4285f4",X.currentTarget.style.color="white"}),g.$$click=R,d(g,b),s(g,w(Re,{get when(){return wt.state.loading},fallback:"Sign in with Google",children:"Signing in..."}),null),d(v,E),s(K,w(Re,{get when(){return wt.state.error},get children(){var X=kw();return d(X,_),s(X,()=>wt.state.error),X}}),null),d(f,a),d(pe,A),ye.style.setProperty("margin-top","0.5rem"),ye.style.setProperty("font-size","0.75rem"),le(X=>{var ee=wt.state.loading,q=c,he=u,ve=h,B=y,te=c,_e=u,we=h,me=y,be=c,ie=u,Pe=h,Te=y,$e=c,Ee=u,Ve=h,Ke=y,je=c,Ce=u,Be=h,Je=y,Qe=c,We=u,xe=h,at=y;return ee!==X.e&&(g.disabled=X.e=ee),X.t=d(C,q,X.t),X.a=d(S,he,X.a),X.o=d(x,ve,X.o),X.i=d(m,B,X.i),X.n=d(re,te,X.n),X.s=d(Y,_e,X.s),X.h=d($,we,X.h),X.r=d(V,me,X.r),X.d=d(Q,be,X.d),X.l=d(L,ie,X.l),X.u=d(D,Pe,X.u),X.c=d(j,Te,X.c),X.w=d(ue,$e,X.w),X.m=d(W,Ee,X.m),X.f=d(ce,Ve,X.f),X.y=d(T,Ke,X.y),X.g=d(G,je,X.g),X.p=d(Z,Ce,X.p),X.b=d(F,Be,X.b),X.T=d(ne,Je,X.T),X.A=d(H,Qe,X.A),X.O=d(U,We,X.O),X.I=d(ae,xe,X.I),X.S=d(se,at,X.S),X},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0}),P})()};ft(["click"]);var Nw=z("<div><div>");const Lw=t=>{const e={"min-height":"100vh",display:"flex","align-items":"center","justify-content":"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},r={width:"50px",height:"50px",border:"3px solid rgba(255, 255, 255, 0.3)","border-top-color":"white","border-radius":"50%",animation:"spin 1s linear infinite"},n=document.createElement("style");return n.textContent=`
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  `,document.head.appendChild(n),Nn(()=>{wt.state?.user?.uid&&wt.getUserProfile(wt.state?.user?.uid)}),Hr(()=>{}),w(Re,{get when(){return!wt.state.loading},get fallback(){return(()=>{var o=Nw(),i=o.firstChild;return d(o,e),d(i,r),o})()},get children(){return w(Re,{get when(){return wt.isAuthenticated},get fallback(){return w(Dw,{})},get children(){return t.children}})}})};var Mw=z("<button>");const Le=t=>{const e=()=>{const r={"font-family":"inherit",cursor:t.disabled?"not-allowed":"pointer",border:"none","border-radius":"var(--border-radius-sm)","font-weight":"500",transition:"all 0.2s ease","text-decoration":"none",display:"inline-flex","align-items":"center","justify-content":"center",gap:"0.5rem",opacity:t.disabled?"0.6":"1"},n={sm:{padding:"0.5rem 1rem","font-size":"0.875rem"},md:{padding:"0.75rem 1.5rem","font-size":"1rem"},lg:{padding:"1rem 2rem","font-size":"1.125rem"}},o={primary:{background:"linear-gradient(135deg, var(--primary-color), var(--primary-dark))",color:"white","box-shadow":"var(--shadow-sm)"},secondary:{background:"var(--surface-color)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},outline:{background:"transparent",color:"var(--primary-color)",border:"1px solid var(--primary-color)"}};return{...r,...n[t.size||"md"],...o[t.variant||"primary"]}};return(()=>{var r=Mw();return Ln(r,"click",t.onClick,!0),s(r,()=>t.children),le(n=>{var o=e(),i=t.disabled,a=t.type||"button",c=`btn btn-${t.variant||"primary"} ${t.className||""}`;return n.e=d(r,o,n.e),i!==n.t&&(r.disabled=n.t=i),a!==n.a&&ct(r,"type",n.a=a),c!==n.o&&Rc(r,n.o=c),n},{e:void 0,t:void 0,a:void 0,o:void 0}),r})()};ft(["click"]);var Ow=z("<div><div><div><h2></h2><button>×</button></div><div>");const yr=t=>{const e={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},r={background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","max-width":"920px",width:"90%","max-height":"80vh",overflow:"auto",position:"relative"},n={padding:"1.5rem","border-bottom":"1px solid var(--border-color)",display:"flex","justify-content":"space-between","align-items":"center"},o={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},i={background:"none",border:"none","font-size":"1.5rem",cursor:"pointer",color:"var(--text-muted)",padding:"0.5rem","border-radius":"var(--border-radius-sm)"},a={padding:"1.5rem"},c=u=>{u.target===u.currentTarget&&t.onClose()};return w(Re,{get when(){return t.isOpen},get children(){var u=Ow(),h=u.firstChild,y=h.firstChild,b=y.firstChild,_=b.nextSibling,A=y.nextSibling;return u.$$click=c,d(y,n),d(b,o),s(b,()=>t.title),_.addEventListener("mouseleave",E=>E.target.style.background="none"),_.addEventListener("mouseenter",E=>E.target.style.background="var(--background-color)"),Ln(_,"click",t.onClose,!0),d(_,i),d(A,a),s(A,()=>t.children),le(E=>{var R=e,P=r;return E.e=d(u,R,E.e),E.t=d(h,P,E.t),E},{e:void 0,t:void 0}),u}})};ft(["click"]);var qh=z("<div>"),Vw=z("<h3>"),Fw=z("<p>");const Ge=t=>{const e={background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"1.5rem","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",transition:"all 0.2s ease",cursor:t.onClick?"pointer":"default"},r={"margin-bottom":"1rem"},n={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0 0 0.5rem 0"},o={"font-size":"0.875rem",color:"var(--text-muted)",margin:"0"};return(()=>{var i=qh();return Ln(i,"click",t.onClick,!0),s(i,(()=>{var a=ge(()=>!!(t.title||t.subtitle));return()=>a()&&(()=>{var c=qh();return d(c,r),s(c,(()=>{var u=ge(()=>!!t.title);return()=>u()&&(()=>{var h=Vw();return d(h,n),s(h,()=>t.title),h})()})(),null),s(c,(()=>{var u=ge(()=>!!t.subtitle);return()=>u()&&(()=>{var h=Fw();return d(h,o),s(h,()=>t.subtitle),h})()})(),null),c})()})(),null),s(i,()=>t.children,null),le(a=>{var c=e,u=`card ${t.className||""}`;return a.e=d(i,c,a.e),u!==a.t&&Rc(i,a.t=u),a},{e:void 0,t:void 0}),i})()};ft(["click"]);var Bw=z("<div><label></label><input>"),Uw=z("<span>*");const Ot=t=>{const e={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},r={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},n={"margin-bottom":"1rem"};return(()=>{var o=Bw(),i=o.firstChild,a=i.nextSibling;return d(o,n),d(i,e),s(i,()=>t.label,null),s(i,(()=>{var c=ge(()=>!!t.required);return()=>c()&&(()=>{var u=Uw();return u.style.setProperty("color","var(--primary-color)"),u})()})(),null),a.addEventListener("blur",c=>c.target.style.borderColor="var(--border-color)"),a.addEventListener("focus",c=>c.target.style.borderColor="var(--primary-color)"),a.$$input=c=>t.onChange(c.target.value),d(a,r),le(c=>{var u=t.type||"text",h=t.placeholder,y=t.required,b=t.disabled;return u!==c.e&&ct(a,"type",c.e=u),h!==c.t&&ct(a,"placeholder",c.t=h),y!==c.a&&(a.required=c.a=y),b!==c.o&&(a.disabled=c.o=b),c},{e:void 0,t:void 0,a:void 0,o:void 0}),le(()=>a.value=t.value),o})()};ft(["input"]);const jw={en:{common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",close:"Close",search:"Search",filter:"Filter",reset:"Reset",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",actions:"Actions",status:"Status",active:"Active",inactive:"Inactive",date:"Date",time:"Time",description:"Description",notes:"Notes",amount:"Amount",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Language",english:"English",spanish:"Spanish",noDataFound:"No data found",required:"Required",optional:"Optional",all:"All",none:"None",select:"Select",clear:"Clear",searching:"Searching...",refresh:"Refresh",showAll:"Show All",products:"products",filtered:"Filtered",view:"View",suggested:"Suggested",clearFilters:"Clear Filters",enhanced:"Enhanced",legacy:"Legacy",email:"Email",phone:"Phone",address:"Address",name:"Name",code:"Code",category:"Category",type:"Type",quantity:"Quantity",price:"Price",cost:"Cost",value:"Value",balance:"Balance",created:"Created",modified:"Modified",details:"Details",summary:"Summary",history:"History",new:"New",addNew:"Add New",unknown:"Unknown",notAvailable:"N/A",remove:"Remove",startDate:"Start Date",endDate:"End Date",from:"From",invoice:"Invoice",invoices:"invoices",reference:"Reference",createdBy:"Created By",units:"units",invoiceDocumentId:"Invoice/Document ID",referenceNumber:"Reference Number",referenceNumberPlaceholder:"Enter reference number...",generalNotes:"General Notes",auto:"Auto",optionalNotes:"Optional notes...",showPerPage:"Show per page",first:"First",last:"Last",pageOfPages:"Page {{current}} of {{total}}",showingXofY:"Showing {{start}}-{{end}} of {{total}}",page:"Page",of:"of",print:"Print",export:"Export",pending:"Pending",completed:"Completed",customer:"Customer",store:"Store",location:"Location",reservations:"Reservations",backToDashboard:"Back to Dashboard",lbs:"pounds"},forms:{referenceNumberRequired:"Reference number is required",locationRequired:"Location is required",fromLocationRequired:"From location is required for transfers",atLeastOneProduct:"At least one product is required",itemProductRequired:"Product is required for item {{index}}",itemQuantityRequired:"Quantity must be greater than 0 for item {{index}}"},navigation:{dashboard:"Dashboard",accounts:"Chart of Accounts",balanceSheet:"Balance Sheet",inventory:"Inventory",employees:"Employees",entryBooks:"Entry Books",consolidate:"Bank Consolidation",reports:"Reports",settings:"Settings"},dashboard:{title:"Dashboard",welcome:"Welcome to HRM Finance",totalRevenue:"Total Revenue",overview:"Overview",recentActivity:"Recent Activity",quickActions:"Quick Actions",employeeCount:"Employee Count",pendingInvoices:"Pending Invoices",cashBalance:"Cash Balance",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalExpenses:"Total Expenses",netIncome:"Net Income",netLoss:"Net Loss",monthlyPayroll:"Monthly Payroll",current:"Current",newHires:"+3 new hires",outstanding:"Outstanding",totalOutstanding:"$23,450 total",lastUpdatedToday:"Last updated today",commonTasks:"Common tasks",generateReport:"Generate Report",latestUpdates:"Latest updates",invoicePaid:"Invoice #1234 paid",hoursAgo:"2 hours ago",newEmployeeOnboarded:"New employee onboarded",dayAgo:"1 day ago",monthlyReportGenerated:"Monthly report generated",daysAgo:"2 days ago"},accounts:{title:"Chart of Accounts",accountNumber:"Account Number",accountName:"Account Name",accountType:"Account Type",category:"Category",balance:"Balance",parentAccount:"Parent Account",subAccounts:"Sub-accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",transactions:"Transactions",accountHistory:"Account History",backToAccounts:"Back to Accounts",accountNotFound:"Account not found",accountInformation:"Account Information",accountPurpose:"Account purpose",transactionHistory:"Transaction History",noTransactions:"No transactions found for this account",createdDate:"Created Date",lastModified:"Last Modified",noDescription:"No description provided.",totalCount:"Total count",basicDetails:"Basic details",currentBalance:"Current balance",classification:"Classification",allTransactions:"All account transactions",reference:"Reference",allAccounts:"All Accounts",types:{asset:"Asset",liability:"Liability",equity:"Equity",revenue:"Revenue",expense:"Expense"},categories:{currentAssets:"Current Assets",fixedAssets:"Fixed Assets",currentLiabilities:"Current Liabilities",longTermLiabilities:"Long-term Liabilities",ownersEquity:"Owner's Equity",operatingRevenue:"Operating Revenue",operatingExpenses:"Operating Expenses"}},inventory:{title:"Inventory Management",overview:"Overview",products:"Products & Stock",movements:"Movements",locations:"Locations",bulkMovement:"Bulk Movement",addMovement:"Add Movement",addProduct:"Add Product",addLocation:"Add Location",singleMovement:"Add Single Movement",addNewItem:"Add New Item",activeProducts:"Active Products",lowStockAlert:"Low Stock Items",totalValue:"Total Stock Value",activeLocations:"Active Locations",productsNeedRestocking:"products need restocking",recentMovements:"Recent Movements",noProducts:"No products at this location",productName:"Product Name",productCode:"Product Code",sku:"SKU",unitOfMeasure:"Unit of Measure",unitCost:"Unit Cost",minStockLevel:"Min Stock Level",maxStockLevel:"Max Stock Level",locationName:"Location Name",locationType:"Location Type",locationCode:"Location Code",movementType:"Movement Type",referenceNumber:"Reference Number",invoiceNumber:"Invoice Number",fromLocation:"From Location",toLocation:"To Location",stockIn:"Stock In",stockOut:"Stock Out",transfer:"Transfer",adjustment:"Adjustment",inStock:"In Stock",lowStock:"Low Stock",outOfStock:"Out of Stock",stockLevels:"Stock Levels",stockByLocation:"Stock by Location",searchProducts:"Search products by name, SKU, or category...",searchProductsStock:"Search products and check stock levels...",searchResult:"Search Result",searchResults:"Search Results",searchFallback:"Showing local results",tryDifferentTerm:"Try a different search term or check spelling.",showingTopResults:"Showing top {{count}} results",searchLocations:"Search locations...",noMovements:"No movements found",productDetails:"Product Details",locationDetails:"Location Details",movementDetails:"Movement Details",totalProducts:"Total Products",totalLocations:"Total Locations",lastSeen:"Last seen",warehouseType:"Warehouse",storeType:"Store",supplierType:"Supplier",customerType:"Customer",currentlyManaged:"Currently managed",needAttention:"Need attention",currentWorth:"Current worth",warehousesStores:"Warehouses & stores",thisMonth:"This Month",latestActivities:"Latest inventory activities",searchMovements:"Search Movements",countingSheet:"Counting Sheet",physicalCount:"Physical Count",physicalInventoryCount:"Physical Inventory Count",setupPhysicalCount:"Setup Physical Inventory Count",setupDescription:"Configure your physical inventory count settings and begin the counting process.",countWillInclude:"This count will include {{count}} products from {{location}} in {{category}} category.",startCounting:"Start Physical Count",counted:"Counted",remaining:"Remaining",variances:"Variances",complete:"Complete",systemQty:"System Qty",variance:"Variance",addNotes:"Add notes...",reviewAndConfirm:"Review and Confirm Adjustments",reviewDescription:"Review the inventory adjustments below and confirm to update your system.",stockIncreases:"Stock Increases",stockDecreases:"Stock Decreases",totalAdjustments:"Total Adjustments",confirmAdjustments:"Confirm Adjustments",perfectCount:"Perfect Count!",noVariances:"No variances found. Your physical count matches the system exactly.",physicalCountAdjustment:"Physical count adjustment",inventoryCountingSheetTitle:"INVENTORY COUNTING SHEET",location:"Location",allCategories:"All Categories",countedBy:"Counted by",verifiedBy:"Verified by",instructions:"Instructions",countInstructions:["Count all items physically present at this location",'Write the actual count in the "Physical Count" column',"Leave blank if item is not found",'Note any discrepancies in the "Notes" column',"Sign and date when complete"],productName:"Product Name",unit:"Unit",totalProductsListed:"Total Products Listed",itemsCounted:"Items Counted",summaryFor:"SUMMARY FOR",discrepanciesFound:"Discrepancies Found",counterSignature:"Counter Signature",supervisorSignature:"Supervisor Signature",downloadCSV:"Download CSV",noAdjustmentsToDownload:"No adjustments to download",stockIncrease:"Stock Increase",stockDecrease:"Stock Decrease",purchaseReceive:"Purchase/Receive",saleIssue:"Sale/Issue",transfer:"Transfer",adjustment:"Adjustment",movementType:"Movement Type",fromLocation:"From Location",toLocation:"To Location",searchSourceLocation:"Search source location...",searchDestinationLocation:"Search destination location...",searchLocation:"Search location...",addProduct:"Add Product",searchProduct:"Search product...",unitCost:"Unit Cost",noProductsAdded:'No products added yet. Click "Add Product" to get started.',createMovement:"Create Movement",generalNotesPlaceholder:"Enter general notes for this movement...",sortBy:"Sort By",allLocations:"All Locations",searchByProduct:"Search by product, location, reference, notes, invoice...",allProducts:"All Products",bulkMovementReport:"Bulk Movement Report",movementDetails:"Movement Details",referenceNumber:"Reference Number",invoiceId:"Invoice ID",totalItems:"Total Items",totalQuantity:"Total Quantity",estimatedValue:"Estimated Value",viewHistoricalReports:"View Historical Reports",noBulkReportsFound:"No bulk movement reports found",bulkReportsAppearHere:"Bulk movement reports will appear here after you create bulk movements",allTypes:"All Types",startDate:"Start Date",endDate:"End Date",totalMovements:"Total Movements",totalItems:"Total Items",adjustMovements:"Try adjusting your filters or check back later.",inventoryMovements:"Inventory Movements",createdBy:"Created By",view:"View",enhanced:"Enhanced",legacy:"Legacy",addSingleMovement:"Add Single Movement",inStockSubtitle:"In stock",itemsBelowThreshold:"Items below threshold",inventoryWorth:"Inventory worth",quantity:"Quantity",units:"units",normal:"Normal",productsAndStock:"Products & Stock",lowStockItems:"Low Stock Items",totalStockValue:"Total Stock Value",warehousesAndStores:"Warehouses & stores",andMore:"...and {count} more",latestInventoryActivities:"Latest inventory activities",min:"Min",max:"Max",cost:"Cost",noProductsFound:"No products found matching your search.",noProductsAvailable:"No products available.",noLocationsFound:"No locations found matching your search.",noLocationsAvailable:"No locations available.",searchPlaceholder:"Search by product, location, reference, notes, invoice...",noMovementsFound:"No movements found",tryAdjustingFilters:"Try adjusting your filters or check back later.",transfers:"Transfers",adjustments:"Adjustments",bulk:"Bulk",product:"Product",location:"Location",store:"Store",supplier:"Supplier",warehouse:"Warehouse",movement:"Movement",editMovement:"Edit Movement",updateMovement:"Update Movement",movementInformation:"Movement Information",locationInformation:"Location Information",searchProductsImages:"Search products to view images...",searchForProducts:"Search for Products",startTypingToSearch:"Start typing to search and view product images",tryDifferentSearch:"Try a different search term"},employees:{title:"Employee Management",employeeList:"Employee List",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",payrollInfo:"Payroll Information",firstName:"First Name",lastName:"Last Name",fullName:"Full Name",email:"Email",phone:"Phone",address:"Address",dateOfBirth:"Date of Birth",employeeId:"Employee ID",department:"Department",position:"Position",hireDate:"Hire Date",employmentStatus:"Employment Status",salary:"Salary",payFrequency:"Pay Frequency",taxId:"Tax ID",bankAccount:"Bank Account",emergencyContact:"Emergency Contact",activeEmployees:"Active Employees",inactiveEmployees:"Inactive Employees",totalPayroll:"Total Payroll",searchEmployees:"Search employees...",enterFullName:"Enter employee's full name",enterPosition:"Enter job position",enterEmail:"Enter email address",enterPhone:"Enter phone number",enterSalary:"Enter annual salary",departments:{engineering:"Engineering",product:"Product",design:"Design",marketing:"Marketing",sales:"Sales",humanResources:"Human Resources",finance:"Finance",operations:"Operations",analytics:"Analytics"}},entryBooks:{title:"Entry Books",bookName:"Book Name",bookType:"Book Type",createBook:"Create Book",editBook:"Edit Book",salesBook:"Sales Book",purchaseBook:"Purchase Book",cashBook:"Cash Book",generalBook:"General Book",entries:"Entries",addEntry:"Add Entry",period:"Period",startDate:"Start Date",endDate:"End Date",bookBalance:"Book Balance",reconciledBalance:"Reconciled Balance",difference:"Difference",reconcile:"Reconcile",isReconciled:"Is Reconciled",noBooks:"No entry books found",createFirst:"Create your first entry book to get started",bookDetails:"Book Details",entriesCount:"entries",bookOverview:"Book overview and details",bookEntries:"Book Entries",allEntries:"All entries in this book",noEntries:"No entries found",addFirst:"Add your first entry to this book",entryDate:"Entry Date",entryDescription:"Entry Description",entryAmount:"Entry Amount",entryReference:"Entry Reference",subtitle:"Manage accounting entries and general ledger records",viewReconciliation:"View Reconciliation",totalEntries:"Total Entries",allJournalEntries:"All journal entries",postedEntriesOnly:"Posted entries only",fromPostedEntries:"From {count} posted entries",needBankReconciliation:"Need bank reconciliation",allReconciled:"All reconciled",sortBy:"Sort By",fromDate:"From Date",toDate:"To Date",order:"Order",newest:"Newest",oldest:"Oldest",resetFilters:"Reset Filters",activeFilters:"Active filters",from:"From",to:"To",entriesFound:"{count} entries found",noJournalEntries:"No Journal Entries",startByCreating:"Start by creating your first entry",noEntriesMatch:"No journal entries match your current filters.",createFirstEntry:"Create First Entry",void:"Void",confirmVoid:"Are you sure you want to void this journal entry?",entryBookRecords:"Entry Book Records"},banking:{title:"Bank Consolidation",bankAccount:"Bank Account",statementDate:"Statement Date",beginningBalance:"Beginning Balance",endingBalance:"Ending Balance",deposits:"Deposits",withdrawals:"Withdrawals",bankCharges:"Bank Charges",interest:"Interest",reconcile:"Reconcile",matched:"Matched",unmatched:"Unmatched",importStatement:"Import Statement",manualEntry:"Manual Entry",autoMatch:"Auto Match",clearAll:"Clear All",reconciliationStatus:"Reconciliation Status",difference:"Difference",bookBalance:"Book Balance",statementBalance:"Statement Balance",outstandingChecks:"Outstanding Checks",depositsInTransit:"Deposits in Transit",reconciled:"Reconciled",notReconciled:"Not Reconciled",unreconciled:"Unreconciled",reconciliation:"Reconciliation",compareStatements:"Compare bank statements with entry book records",importCSV:"Import CSV",startNewReconciliation:"Start New Reconciliation",bankAccountInfo:"Bank Account Info",currentAccountDetails:"Current account details",lastReconciled:"Last reconciled",bankTransactions:"Bank Transactions",selectedPeriod:"Selected period",pending:"pending",bookEntriesForComparison:"Book entries for comparison",reconciliationRate:"Reconciliation Rate",completionStatus:"Completion status",recentReconciliationSessions:"Recent Reconciliation Sessions",latestActivity:"Latest activity",noRecentSessions:"No recent reconciliation sessions found.",startFirstReconciliation:"Start First Reconciliation",entryBookRecords:"Entry Book Records",pleaseUploadCSV:"Please upload a CSV file",csvRequiresHeaderAndData:"CSV file must have at least a header and one data row",successfullyParsed:"Successfully parsed {count} rows",errorParsingCSV:"Error parsing CSV file. Please check the format.",dateDescriptionRequired:"Date and Description columns are required",importedTransaction:"Imported transaction",successfullyImported:"Successfully imported {count} bank transactions",errorImportingTransactions:"Error importing transactions. Please check your data.",importBankStatementCSV:"Import Bank Statement CSV",dropCSVHere:"Drop CSV file here",clickToUploadCSV:"Click to upload or drag and drop CSV file",supportedFormat:"Supported format: CSV with Date, Description, and Amount columns",mapCSVColumns:"Map CSV Columns",dateColumn:"Date Column",selectColumn:"Select column...",descriptionColumn:"Description Column",referenceColumn:"Reference Column",amountDebitColumn:"Amount/Debit Column",creditColumn:"Credit Column",balanceColumn:"Balance Column",andMoreRows:"... and {count} more rows",importing:"Importing...",importTransactions:"Import {count} Transactions",reconciliationComparison:"Reconciliation Comparison",bankStatements:"Bank Statements",totalTransactions:"Total transactions",totalEntries:"Total entries",unreconciledBank:"Unreconciled Bank",unreconciledBooks:"Unreconciled Books",needAttention:"Need attention",unreconcile:"Unreconcile",clickToReconcile:"Click to reconcile",potentialMatchesFound:"Potential Matches Found",clickRecordToReconcile:"Click on a record below to reconcile",exactMatch:"Exact Match",possibleMatch:"Possible Match",selected:"Selected",clearSelection:"Clear Selection"},journal:{title:"Journal Entries",entryNumber:"Entry Number",entryDate:"Entry Date",debit:"Debit",credit:"Credit",account:"Account",memo:"Memo",reference:"Reference",createEntry:"Create Entry",editEntry:"Edit Entry",deleteEntry:"Delete Entry",posted:"Posted",draft:"Draft",reversed:"Reversed",recurringEntry:"Recurring Entry",attachments:"Attachments",totalDebits:"Total Debits",totalCredits:"Total Credits",outOfBalance:"Out of Balance",balanced:"Balanced",addEntry:"Add Journal Entry",allEntries:"All Entries",totalDebit:"Total Debit",totalCredit:"Total Credit",debitShort:"Dr.",creditShort:"Cr.",noReference:"No reference",createdBy:"By",totalAmount:"Total Amount",lines:"Lines",entryNotBalancedShort:"Entry is not balanced",accountLines:"Account Lines",noDescription:"No description",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryLines:"Journal Entry Lines",addLine:"Add Line",lineDescription:"Line description",notBalanced:"Not Balanced",updateEntry:"Update Entry",saveAsDraft:"Save as Draft",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",editEntryTooltip:"Edit this journal entry",post:"Post",entryMustBeBalanced:"Entry must be balanced to post",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",journalLines:"Journal Lines",balanceStatus:"Balance Status",unbalanced:"Unbalanced",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",postEntry:"Post Entry",fixBalance:"Fix Balance",voidEntry:"Void Entry",draftEntry:"Draft Entry",draftEntryDescription:"This entry can be edited and posted.",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",postedEntry:"Posted Entry",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",minTwoLinesRequired:"At least 2 line items are required",entryNotBalanced:"Entry is not balanced. Debit: ${debit}, Credit: ${credit}",lineAccountRequired:"Line {lineNumber}: Account is required",lineAmountRequired:"Line {lineNumber}: Either debit or credit amount must be provided",lineBothAmounts:"Line {lineNumber}: Cannot have both debit and credit amounts",enterEntryDescription:"Enter journal entry description",enterReferenceNumber:"Enter reference number"},invoices:{title:"Invoice Dashboard",invoice:"Invoice",invoiceNumber:"Invoice Number",invoiceDetails:"Invoice Details",customerInformation:"Customer Information",customerName:"Customer Name",legalName:"Legal Name",contactInformation:"Contact Information",idPassport:"ID/Passport",phoneNumber:"Phone Number",altPhone:"Alt Phone",address:"Address",between:"Between",and:"and",products:"Products",reservations:"Reservations",unitPrice:"Unit Price",total:"Total",subtotal:"Subtotal",totalRevenue:"Total Revenue",totalProducts:"Total Products",totalReservations:"Total Reservations",aranceles:"Aranceles (Customs)",uniqueCustomers:"Unique Customers",averageInvoice:"Average Invoice",completed:"Completed",pending:"Pending",storesActive:"Stores Active",topProducts:"Top Products",mostSoldProducts:"Most sold products by quantity",reservationsByType:"Reservations by Type",distributionOfCategories:"Distribution of reservation categories",recentInvoices:"Recent Invoices",showingInvoices:"Showing {{count}} invoices",date:"Date",customer:"Customer",store:"Store",actions:"Actions",view:"View",status:"Status",printInvoice:"Print Invoice",exportPdf:"Export PDF",backToDashboard:"Back to Dashboard",fromInvoices:"From {{count}} invoices",value:"value",activeCustomers:"Active customers",perInvoiceValue:"Per invoice value",locations:"Locations",mostRecentActivity:"Most recent activity",storeLocation:"Store Location",allStores:"All Stores",fromDate:"From Date",toDate:"To Date",clearFilters:"Clear Filters",customsFees:"Total customs fees",salesType:"SALES",packagesOrder:"Packages Order",businessId:"Business ID",orderKey:"Order Key",reservationType:"Reservation Type",arancel:"Arancel",key:"Key",noInvoicesFound:"No invoices found",loadingInvoices:"Loading invoices...",errorLoadingInvoices:"Error loading invoices",refreshData:"Refresh Data",currentStockValue:"Current Stock Value",filterByStore:"Filter by store",filterByDate:"Filter by date range",totalCustomsFees:"Total customs fees",averageValue:"Average value",senderInformation:"Sender Information",receiptInformation:"Receipt Information",productsSubtotal:"Products Subtotal",reservationsSubtotal:"Reservations Subtotal",code:"Code",description:"Description",qty:"Qty",type:"Type",id:"ID",passport:"Passport"},forms:{requiredField:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",selectOption:"Please select an option",enterValue:"Please enter a value",confirmDelete:"Are you sure you want to delete this item?",unsavedChanges:"You have unsaved changes. Do you want to continue?",saveSuccess:"Saved successfully",saveError:"Error saving data",deleteSuccess:"Deleted successfully",deleteError:"Error deleting item",duplicateAccountNumber:"Account number already exists",descriptionRequired:"Description is required",errorOccurred:"An error occurred",errorPostingEntry:"An error occurred while posting the entry"},modals:{addInventory:"Add Inventory Movement",bulkMovement:"Bulk Inventory Movement",addProduct:"Add New Product",addLocation:"Add New Location",inventoryDetail:"Inventory Item Details",quickAdd:"Quick Add",selectProduct:"Select Product",selectLocation:"Select Location",enterQuantity:"Enter quantity",enterCost:"Enter unit cost",enterReference:"Enter reference number",addNotes:"Add notes (optional)",generalInformation:"General Information",stockInformation:"Stock Information",locationInformation:"Location Information",movementInformation:"Movement Information",addToInventory:"Add to Inventory",createProduct:"Create Product",createLocation:"Create Location",processing:"Processing...",addingMovement:"Adding movement...",creatingProduct:"Creating product...",creatingLocation:"Creating location..."},products:{title:"Products",addNew:"Add New Product",totalProducts:"Total Products",inCatalog:"In catalog",activeProducts:"Active Products",currentlyAvailable:"Currently available",outOfStock:"Out of Stock",needsRestock:"Needs restock",productCatalog:"Product Catalog",manageYourProducts:"Manage your products and pricing",inStock:"In Stock",furniture:"Furniture",electronics:"Electronics",supplies:"Supplies",lighting:"Lighting",searchPlaceholder:"Search products by name, SKU, or category...",allCategories:"All Categories",clearFilters:"Clear filters",noResults:"No products found matching your criteria.",noProducts:"No products available.",showing:"Showing",filtered:"Filtered results",allProducts:"All products",searchResult:"Search Result",stock:"Stock",lowStock:"Low Stock"},invoices:{title:"Invoices",createNew:"Create New Invoice",totalOutstanding:"Total Outstanding",unpaidInvoices:"Unpaid invoices",thisMonth:"This Month",revenueCollected:"Revenue collected",overdue:"Overdue",pastDueInvoices:"Past due invoices",recentInvoices:"Recent Invoices",latestBillingActivity:"Latest billing activity",paid:"Paid",pending:"Pending"},unauthorized:{title:"Access Restricted",accessDenied:"Access Denied",noPermission:"You don't have permission to access",thisFeature:"this feature",whySeeing:"Why am I seeing this?",explanation:"Your account doesn't have the necessary permissions to view this content.",requiredPermission:"Required permission:",goToDashboard:"Go to Dashboard",goBack:"Go Back",featuresCanAccess:"Features you can access:",dashboardAccess:"Dashboard and overview statistics",profileAccess:"Your profile and settings",roleBasedAccess:"Features enabled for your role",needAccess:"Need access? Contact your administrator or manager to request the appropriate permissions.",permissions:{accountAccess:"Account Management Access",inventoryAccess:"Inventory Access",employeeAccess:"HR Access",bankingAccess:"Banking Access",journalAccess:"Journal Entry Access",adminAccess:"Administrative Access",financialReporting:"Financial Reporting Access",invoiceManagement:"Invoice Management Access",productManagement:"Product Management Access"}}},es:{common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",add:"Agregar",close:"Cerrar",search:"Buscar",filter:"Filtrar",reset:"Restablecer",back:"Atrás",next:"Siguiente",previous:"Anterior",yes:"Sí",no:"No",loading:"Cargando...",error:"Error",success:"Éxito",warning:"Advertencia",info:"Información",confirm:"Confirmar",actions:"Acciones",status:"Estado",active:"Activo",inactive:"Inactivo",date:"Fecha",time:"Hora",description:"Descripción",notes:"Notas",amount:"Monto",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Idioma",english:"Inglés",spanish:"Español",noDataFound:"No se encontraron datos",required:"Requerido",optional:"Opcional",all:"Todos",none:"Ninguno",select:"Seleccionar",clear:"Limpiar",view:"Ver",suggested:"Sugerido",clearFilters:"Limpiar Filtros",enhanced:"Mejorado",legacy:"Clásico",email:"Correo Electrónico",phone:"Teléfono",address:"Dirección",name:"Nombre",code:"Código",category:"Categoría",type:"Tipo",quantity:"Cantidad",price:"Precio",cost:"Costo",value:"Valor",balance:"Saldo",created:"Creado",modified:"Modificado",details:"Detalles",summary:"Resumen",history:"Historial",new:"Nuevo",addNew:"Agregar Nuevo",unknown:"Desconocido",notAvailable:"N/A",remove:"Remover",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",from:"De",invoice:"Factura",invoices:"facturas",reference:"Referencia",createdBy:"Creado Por",units:"unidades",invoiceDocumentId:"ID de Factura/Documento",referenceNumber:"Número de Referencia",referenceNumberPlaceholder:"Ingrese número de referencia...",generalNotes:"Notas Generales",auto:"Auto",optionalNotes:"Notas opcionales...",showPerPage:"Mostrar por página",first:"Primera",last:"Última",pageOfPages:"Página {{current}} de {{total}}",showingXofY:"Mostrando {{start}}-{{end}} de {{total}}",page:"Página",of:"de",lbs:"libras"},forms:{referenceNumberRequired:"El número de referencia es requerido",locationRequired:"La ubicación es requerida",fromLocationRequired:"La ubicación de origen es requerida para transferencias",atLeastOneProduct:"Al menos un producto es requerido",itemProductRequired:"El producto es requerido para el artículo {{index}}",itemQuantityRequired:"La cantidad debe ser mayor que 0 para el artículo {{index}}"},navigation:{dashboard:"Panel de Control",accounts:"Plan de Cuentas",balanceSheet:"Balance General",inventory:"Inventario",employees:"Empleados",entryBooks:"Libros de Entrada",consolidate:"Consolidación Bancaria",reports:"Reportes",settings:"Configuración"},dashboard:{title:"Panel de Control",welcome:"Bienvenido a HRM Finance",totalRevenue:"Ingresos Totales",overview:"Resumen",recentActivity:"Actividad Reciente",quickActions:"Acciones Rápidas",employeeCount:"Número de Empleados",pendingInvoices:"Facturas Pendientes",cashBalance:"Saldo en Efectivo",totalAssets:"Activos Totales",totalLiabilities:"Pasivos Totales",totalExpenses:"Gastos Totales",netIncome:"Ingreso Neto",netLoss:"Pérdida Neta",monthlyPayroll:"Nómina Mensual",current:"Actual",newHires:"+3 nuevas contrataciones",outstanding:"Pendiente",totalOutstanding:"$23,450 total",lastUpdatedToday:"Última actualización hoy",commonTasks:"Tareas comunes",generateReport:"Generar Reporte",latestUpdates:"Últimas actualizaciones",invoicePaid:"Factura #1234 pagada",hoursAgo:"hace 2 horas",newEmployeeOnboarded:"Nuevo empleado incorporado",dayAgo:"hace 1 día",monthlyReportGenerated:"Reporte mensual generado",daysAgo:"hace 2 días"},accounts:{title:"Plan de Cuentas",accountNumber:"Número de Cuenta",accountName:"Nombre de Cuenta",accountType:"Tipo de Cuenta",category:"Categoría",balance:"Saldo",parentAccount:"Cuenta Padre",subAccounts:"Subcuentas",addAccount:"Agregar Cuenta",editAccount:"Editar Cuenta",deleteAccount:"Eliminar Cuenta",accountDetails:"Detalles de Cuenta",transactions:"Transacciones",accountHistory:"Historial de Cuenta",backToAccounts:"Volver a Cuentas",accountNotFound:"Cuenta no encontrada",accountInformation:"Información de Cuenta",accountPurpose:"Propósito de la cuenta",transactionHistory:"Historial de Transacciones",noTransactions:"No se encontraron transacciones para esta cuenta",createdDate:"Fecha de Creación",lastModified:"Última Modificación",noDescription:"No se proporcionó descripción.",totalCount:"Conteo total",basicDetails:"Detalles básicos",currentBalance:"Saldo actual",classification:"Clasificación",allTransactions:"Todas las transacciones de la cuenta",reference:"Referencia",types:{asset:"Activo",liability:"Pasivo",equity:"Patrimonio",revenue:"Ingreso",expense:"Gasto"},categories:{currentAssets:"Activos Corrientes",fixedAssets:"Activos Fijos",currentLiabilities:"Pasivos Corrientes",longTermLiabilities:"Pasivos a Largo Plazo",ownersEquity:"Patrimonio del Propietario",operatingRevenue:"Ingresos Operacionales",operatingExpenses:"Gastos Operacionales"}},inventory:{title:"Gestión de Inventario",overview:"Resumen",products:"Productos y Stock",movements:"Movimientos",locations:"Ubicaciones",bulkMovement:"Movimiento Masivo",addMovement:"Agregar Movimiento",addProduct:"Agregar Producto",addLocation:"Agregar Ubicación",singleMovement:"Agregar Movimiento Individual",addNewItem:"Agregar Nuevo Artículo",activeProducts:"Productos Activos",lowStockAlert:"Artículos con Stock Bajo",totalValue:"Valor Total del Stock",activeLocations:"Ubicaciones Activas",productsNeedRestocking:"productos necesitan reabastecimiento",recentMovements:"Movimientos Recientes",noProducts:"No hay productos en esta ubicación",productName:"Nombre del Producto",productCode:"Código del Producto",sku:"SKU",category:"Categoria",unitOfMeasure:"Unidad de Medida",unitCost:"Costo Unitario",minStockLevel:"Nivel Mínimo de Stock",maxStockLevel:"Nivel Máximo de Stock",locationName:"Nombre de Ubicación",locationType:"Tipo de Ubicación",locationCode:"Código de Ubicación",movementType:"Tipo de Movimiento",referenceNumber:"Número de Referencia",invoiceNumber:"Número de Factura",fromLocation:"Desde Ubicación",toLocation:"Hacia Ubicación",stockIn:"Entrada de Stock",stockOut:"Salida de Stock",transfer:"Transferencia",adjustment:"Ajuste",inStock:"En Stock",lowStock:"Stock Bajo",outOfStock:"Sin Stock",stockLevels:"Niveles de Stock",stockByLocation:"Stock por Ubicación",searchProducts:"Buscar productos...",searchLocations:"Buscar ubicaciones...",noMovements:"No se encontraron movimientos",productDetails:"Detalles del Producto",locationDetails:"Detalles de Ubicación",movementDetails:"Detalles del Movimiento",totalProducts:"Total de Productos",totalLocations:"Total de Ubicaciones",lastSeen:"Visto por última vez",warehouseType:"Almacén",storeType:"Tienda",supplierType:"Proveedor",customerType:"Cliente",currentlyManaged:"Gestionados actualmente",needAttention:"Necesitan atención",currentWorth:"Valor actual",warehousesStores:"Almacenes y tiendas",thisMonth:"Este Mes",latestActivities:"Últimas actividades de inventario",searchMovements:"Buscar Movimientos",countingSheet:"Hoja de Conteo",physicalCount:"Conteo Físico",physicalInventoryCount:"Conteo Físico de Inventario",setupPhysicalCount:"Configurar Conteo Físico de Inventario",setupDescription:"Configure los ajustes de su conteo físico de inventario y comience el proceso de conteo.",countWillInclude:"Este conteo incluirá {{count}} productos de {{location}} en la categoría {{category}}.",startCounting:"Iniciar Conteo Físico",counted:"Contado",remaining:"Restante",variances:"Variaciones",complete:"Completo",systemQty:"Cant. Sistema",variance:"Variación",addNotes:"Agregar notas...",reviewAndConfirm:"Revisar y Confirmar Ajustes",reviewDescription:"Revise los ajustes de inventario a continuación y confirme para actualizar su sistema.",stockIncreases:"Aumentos de Stock",stockDecreases:"Disminuciones de Stock",totalAdjustments:"Ajustes Totales",confirmAdjustments:"Confirmar Ajustes",adjustment:"Ajuste",perfectCount:"¡Conteo Perfecto!",noVariances:"No se encontraron variaciones. Su conteo físico coincide exactamente con el sistema.",physicalCountAdjustment:"Ajuste de conteo físico",inventoryCountingSheetTitle:"HOJA DE CONTEO DE INVENTARIO",location:"Ubicación",allCategories:"Todas las Categorías",countedBy:"Contado por",verifiedBy:"Verificado por",instructions:"Instrucciones",countInstructions:["Contar todos los artículos físicamente presentes en esta ubicación",'Escribir el conteo real en la columna "Conteo Físico"',"Dejar en blanco si el artículo no se encuentra",'Anotar cualquier discrepancia en la columna "Notas"',"Firmar y fechar cuando esté completo"],productName:"Nombre del Producto",unit:"Unidad",totalProductsListed:"Total de Productos Listados",itemsCounted:"Artículos Contados",summaryFor:"RESUMEN PARA",discrepanciesFound:"Discrepancias Encontradas",counterSignature:"Firma del Contador",supervisorSignature:"Firma del Supervisor",downloadCSV:"Descargar CSV",noAdjustmentsToDownload:"No hay ajustes para descargar",stockIncrease:"Aumento de Stock",stockDecrease:"Disminución de Stock",purchaseReceive:"Compra/Recepción",saleIssue:"Venta/Emisión",transfer:"Transferencia",adjustment:"Ajuste",movementType:"Tipo de Movimiento",fromLocation:"Ubicación de Origen",toLocation:"Ubicación de Destino",searchSourceLocation:"Buscar ubicación de origen...",searchDestinationLocation:"Buscar ubicación de destino...",searchLocation:"Buscar ubicación...",addProduct:"Agregar Producto",searchProduct:"Buscar producto...",unitCost:"Costo Unitario",noProductsAdded:'No se han agregado productos aún. Haga clic en "Agregar Producto" para comenzar.',createMovement:"Crear Movimiento",generalNotesPlaceholder:"Ingrese notas generales para este movimiento...",sortBy:"Ordenar Por",allLocations:"Todas las Ubicaciones",searchByProduct:"Buscar por producto, ubicación, referencia, notas, factura...",allProducts:"Todos los Productos",bulkMovementReport:"Reporte de Movimiento en Lote",movementDetails:"Detalles del Movimiento",referenceNumber:"Número de Referencia",invoiceId:"ID de Factura",totalItems:"Total de Artículos",totalQuantity:"Cantidad Total",estimatedValue:"Valor Estimado",viewHistoricalReports:"Ver Reportes Históricos",noBulkReportsFound:"No se encontraron reportes de movimientos en lote",bulkReportsAppearHere:"Los reportes de movimientos en lote aparecerán aquí después de crear movimientos en lote",allTypes:"Todos los Tipos",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",totalMovements:"Movimientos Totales",totalItems:"Artículos Totales",adjustMovements:"Intenta ajustar tus filtros o revisa más tarde.",inventoryMovements:"Movimientos de Inventario",createdBy:"Creado Por",view:"Ver",enhanced:"Mejorado",legacy:"Clásico",addSingleMovement:"Agregar Movimiento Individual",inStockSubtitle:"En stock",itemsBelowThreshold:"Artículos bajo el umbral",inventoryWorth:"Valor del inventario",quantity:"Cantidad",units:"unidades",normal:"Normal",productsAndStock:"Productos y Stock",lowStockItems:"Artículos con Stock Bajo",totalStockValue:"Valor Total del Stock",warehousesAndStores:"Almacenes y tiendas",andMore:"...y {count} más",latestInventoryActivities:"Últimas actividades de inventario",min:"Mín",max:"Máx",cost:"Costo",noProductsFound:"No se encontraron productos que coincidan con su búsqueda.",noProductsAvailable:"No hay productos disponibles.",noLocationsFound:"No se encontraron ubicaciones que coincidan con su búsqueda.",noLocationsAvailable:"No hay ubicaciones disponibles.",searchPlaceholder:"Buscar por producto, ubicación, referencia, notas, factura...",noMovementsFound:"No se encontraron movimientos",tryAdjustingFilters:"Intenta ajustar tus filtros o revisa más tarde.",transfers:"Transferencias",adjustments:"Ajustes",bulk:"Masivo",product:"Producto",location:"Ubicación",store:"Tienda",supplier:"Proveedor",warehouse:"Almacén",movement:"Movimiento",editMovement:"Editar Movimiento",updateMovement:"Actualizar Movimiento",movementInformation:"Información del Movimiento",locationInformation:"Información de Ubicación",searchProductsImages:"Buscar productos para ver imágenes...",searchForProducts:"Buscar Productos",startTypingToSearch:"Comienza a escribir para buscar y ver imágenes de productos",tryDifferentSearch:"Prueba con un término de búsqueda diferente"},employees:{title:"Gestión de Empleados",employeeList:"Lista de Empleados",addEmployee:"Agregar Empleado",editEmployee:"Editar Empleado",employeeDetails:"Detalles del Empleado",personalInfo:"Información Personal",employmentInfo:"Información Laboral",payrollInfo:"Información de Nómina",firstName:"Nombre",lastName:"Apellido",fullName:"Nombre Completo",email:"Correo Electrónico",phone:"Teléfono",address:"Dirección",dateOfBirth:"Fecha de Nacimiento",employeeId:"ID de Empleado",department:"Departamento",position:"Puesto",hireDate:"Fecha de Contratación",employmentStatus:"Estado Laboral",salary:"Salario",payFrequency:"Frecuencia de Pago",taxId:"ID Fiscal",bankAccount:"Cuenta Bancaria",emergencyContact:"Contacto de Emergencia",activeEmployees:"Empleados Activos",inactiveEmployees:"Empleados Inactivos",totalPayroll:"Nómina Total",searchEmployees:"Buscar empleados...",enterFullName:"Ingrese el nombre completo del empleado",enterPosition:"Ingrese el puesto de trabajo",enterEmail:"Ingrese la dirección de correo electrónico",enterPhone:"Ingrese el número de teléfono",enterSalary:"Ingrese el salario anual",departments:{engineering:"Ingeniería",product:"Producto",design:"Diseño",marketing:"Marketing",sales:"Ventas",humanResources:"Recursos Humanos",finance:"Finanzas",operations:"Operaciones",analytics:"Analítica"}},entryBooks:{title:"Libros de Entrada",bookName:"Nombre del Libro",bookType:"Tipo de Libro",createBook:"Crear Libro",editBook:"Editar Libro",salesBook:"Libro de Ventas",purchaseBook:"Libro de Compras",cashBook:"Libro de Caja",generalBook:"Libro General",entries:"Entradas",addEntry:"Agregar Entrada",period:"Período",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",bookBalance:"Saldo del Libro",reconciledBalance:"Saldo Conciliado",difference:"Diferencia",reconcile:"Conciliar",isReconciled:"Está Conciliado",noBooks:"No se encontraron libros de entrada",createFirst:"Crea tu primer libro de entrada para comenzar",bookDetails:"Detalles del Libro",entriesCount:"entradas",bookOverview:"Resumen y detalles del libro",bookEntries:"Entradas del Libro",allEntries:"Todas las entradas en este libro",noEntries:"No se encontraron entradas",addFirst:"Agrega tu primera entrada a este libro",entryDate:"Fecha de Entrada",entryDescription:"Descripción de Entrada",entryAmount:"Monto de Entrada",entryReference:"Referencia de Entrada"},banking:{title:"Consolidación Bancaria",bankAccount:"Cuenta Bancaria",statementDate:"Fecha del Estado",beginningBalance:"Saldo Inicial",endingBalance:"Saldo Final",deposits:"Depósitos",withdrawals:"Retiros",bankCharges:"Cargos Bancarios",interest:"Intereses",reconcile:"Conciliar",matched:"Conciliado",unmatched:"No Conciliado",importStatement:"Importar Estado",manualEntry:"Entrada Manual",autoMatch:"Coincidencia Automática",clearAll:"Limpiar Todo",reconciliationStatus:"Estado de Conciliación",difference:"Diferencia",bookBalance:"Saldo en Libros",statementBalance:"Saldo del Estado",outstandingChecks:"Cheques Pendientes",depositsInTransit:"Depósitos en Tránsito",reconciled:"Conciliado",notReconciled:"No Conciliado",unreconciled:"No Conciliado",reconciliation:"Conciliación",compareStatements:"Comparar estados bancarios con registros de libros de entrada",importCSV:"Importar CSV",startNewReconciliation:"Iniciar Nueva Conciliación",bankAccountInfo:"Información de Cuenta Bancaria",currentAccountDetails:"Detalles de cuenta actual",lastReconciled:"Última conciliación",bankTransactions:"Transacciones Bancarias",selectedPeriod:"Período seleccionado",pending:"pendiente",bookEntriesForComparison:"Entradas de libros para comparación",reconciliationRate:"Tasa de Conciliación",completionStatus:"Estado de finalización",recentReconciliationSessions:"Sesiones de Conciliación Recientes",latestActivity:"Actividad reciente",noRecentSessions:"No se encontraron sesiones de conciliación recientes.",startFirstReconciliation:"Iniciar Primera Conciliación",entryBookRecords:"Registros de Libros de Entrada",pleaseUploadCSV:"Por favor suba un archivo CSV",csvRequiresHeaderAndData:"El archivo CSV debe tener al menos un encabezado y una fila de datos",successfullyParsed:"Se analizaron exitosamente {count} filas",errorParsingCSV:"Error al analizar el archivo CSV. Verifique el formato.",dateDescriptionRequired:"Las columnas de Fecha y Descripción son requeridas",importedTransaction:"Transacción importada",successfullyImported:"Se importaron exitosamente {count} transacciones bancarias",errorImportingTransactions:"Error al importar transacciones. Verifique sus datos.",importBankStatementCSV:"Importar CSV de Estado Bancario",dropCSVHere:"Suelte el archivo CSV aquí",clickToUploadCSV:"Haga clic para cargar o arrastre y suelte el archivo CSV",supportedFormat:"Formato soportado: CSV con columnas de Fecha, Descripción y Monto",mapCSVColumns:"Mapear Columnas CSV",dateColumn:"Columna de Fecha",selectColumn:"Seleccionar columna...",descriptionColumn:"Columna de Descripción",referenceColumn:"Columna de Referencia",amountDebitColumn:"Columna de Monto/Débito",creditColumn:"Columna de Crédito",balanceColumn:"Columna de Saldo",andMoreRows:"... y {count} filas más",importing:"Importando...",importTransactions:"Importar {count} Transacciones",reconciliationComparison:"Comparación de Conciliación",bankStatements:"Estados Bancarios",totalTransactions:"Transacciones totales",totalEntries:"Entradas totales",unreconciledBank:"Banco No Conciliado",unreconciledBooks:"Libros No Conciliados",needAttention:"Necesitan atención",unreconcile:"Desconciliar",clickToReconcile:"Hacer clic para conciliar",potentialMatchesFound:"Coincidencias Potenciales Encontradas",clickRecordToReconcile:"Haga clic en un registro a continuación para conciliar",exactMatch:"Coincidencia Exacta",possibleMatch:"Posible Coincidencia",selected:"Seleccionado",clearSelection:"Limpiar Selección"},journal:{title:"Asientos Contables",entryNumber:"Número de Asiento",entryDate:"Fecha del Asiento",debit:"Débito",credit:"Crédito",account:"Cuenta",memo:"Memo",reference:"Referencia",createEntry:"Crear Asiento",editEntry:"Editar Asiento",deleteEntry:"Eliminar Asiento",posted:"Registrado",draft:"Borrador",reversed:"Revertido",recurringEntry:"Asiento Recurrente",attachments:"Adjuntos",totalDebits:"Débitos Totales",totalCredits:"Créditos Totales",outOfBalance:"Desbalanceado",balanced:"Balanceado"},forms:{requiredField:"Este campo es requerido",invalidEmail:"Dirección de correo inválida",invalidNumber:"Número inválido",invalidDate:"Fecha inválida",selectOption:"Por favor seleccione una opción",enterValue:"Por favor ingrese un valor",confirmDelete:"¿Está seguro de que desea eliminar este elemento?",unsavedChanges:"Tiene cambios sin guardar. ¿Desea continuar?",saveSuccess:"Guardado exitosamente",saveError:"Error al guardar datos",deleteSuccess:"Eliminado exitosamente",deleteError:"Error al eliminar elemento",duplicateAccountNumber:"El número de cuenta ya existe"},modals:{addInventory:"Agregar Movimiento de Inventario",bulkMovement:"Movimiento Masivo de Inventario",addProduct:"Agregar Nuevo Producto",addLocation:"Agregar Nueva Ubicación",inventoryDetail:"Detalles del Artículo de Inventario",quickAdd:"Agregar Rápido",selectProduct:"Seleccionar Producto",selectLocation:"Seleccionar Ubicación",enterQuantity:"Ingresar cantidad",enterCost:"Ingresar costo unitario",enterReference:"Ingresar número de referencia",addNotes:"Agregar notas (opcional)",generalInformation:"Información General",stockInformation:"Información de Stock",locationInformation:"Información de Ubicación",movementInformation:"Información de Movimiento",addToInventory:"Agregar al Inventario",createProduct:"Crear Producto",createLocation:"Crear Ubicación",processing:"Procesando...",addingMovement:"Agregando movimiento...",creatingProduct:"Creando producto...",creatingLocation:"Creando ubicación..."},products:{title:"Productos",addNew:"Agregar Nuevo Producto",totalProducts:"Total de Productos",inCatalog:"En catálogo",activeProducts:"Productos Activos",currentlyAvailable:"Actualmente disponibles",outOfStock:"Sin Stock",needsRestock:"Necesita reabastecimiento",productCatalog:"Catálogo de Productos",manageYourProducts:"Gestiona tus productos y precios",inStock:"En Stock",furniture:"Muebles",electronics:"Electrónicos",supplies:"Suministros",lighting:"Iluminación"},invoices:{title:"Panel de Facturas",invoice:"Factura",invoiceNumber:"Número de Factura",invoiceDetails:"Detalles de Factura",customerInformation:"Información del Cliente",customerName:"Nombre del Cliente",legalName:"Nombre Legal",contactInformation:"Información de Contacto",idPassport:"ID/Pasaporte",phoneNumber:"Número de Teléfono",altPhone:"Teléfono Alt.",address:"Dirección",between:"Entre",and:"y",products:"Productos",reservations:"Reservaciones",unitPrice:"Precio Unitario",total:"Total",subtotal:"Subtotal",category:"Categoria",totalRevenue:"Ingresos Totales",totalProducts:"Total de Productos",totalReservations:"Total de Reservaciones",aranceles:"Aranceles (Aduanas)",uniqueCustomers:"Clientes Únicos",averageInvoice:"Factura Promedio",completed:"Completada",pending:"Pendiente",storesActive:"Tiendas Activas",topProducts:"Productos Principales",mostSoldProducts:"Productos más vendidos por cantidad",reservationsByType:"Reservaciones por Tipo",distributionOfCategories:"Distribución de categorías de reservaciones",recentInvoices:"Facturas Recientes",showingInvoices:"Mostrando {{count}} facturas",date:"Fecha",customer:"Cliente",store:"Tienda",actions:"Acciones",view:"Ver",status:"Estado",printInvoice:"Imprimir Factura",exportPdf:"Exportar PDF",backToDashboard:"Volver al Panel",fromInvoices:"De {{count}} facturas",value:"valor",activeCustomers:"Clientes activos",perInvoiceValue:"Valor por factura",locations:"Ubicaciones",mostRecentActivity:"Actividad más reciente",storeLocation:"Ubicación de Tienda",allStores:"Todas las Tiendas",fromDate:"Fecha Desde",toDate:"Fecha Hasta",clearFilters:"Limpiar Filtros",customsFees:"Aranceles totales",salesType:"VENTAS",packagesOrder:"Orden de Paquetes",businessId:"ID de Negocio",orderKey:"Clave de Orden",reservationType:"Tipo de Reservación",arancel:"Arancel",key:"Clave",noInvoicesFound:"No se encontraron facturas",loadingInvoices:"Cargando facturas...",errorLoadingInvoices:"Error al cargar facturas",refreshData:"Actualizar Datos",currentStockValue:"Valor de Stock Actual",filterByStore:"Filtrar por tienda",filterByDate:"Filtrar por rango de fechas",totalCustomsFees:"Aranceles totales",averageValue:"Valor promedio",senderInformation:"Información del Remitente",receiptInformation:"Información del Destinatario",productsSubtotal:"Subtotal de Productos",reservationsSubtotal:"Subtotal de Reservaciones",code:"Código",description:"Descripción",qty:"Cant.",type:"Tipo",id:"ID",passport:"Pasaporte"},unauthorized:{title:"Acceso Restringido",accessDenied:"Acceso Denegado",noPermission:"No tienes permisos para acceder a",thisFeature:"esta funcionalidad",whySeeing:"¿Por qué veo esto?",explanation:"Tu cuenta no tiene los permisos necesarios para ver este contenido.",requiredPermission:"Permiso requerido:",goToDashboard:"Ir al Panel de Control",goBack:"Regresar",featuresCanAccess:"Funcionalidades a las que puedes acceder:",dashboardAccess:"Panel de control y estadísticas generales",profileAccess:"Tu perfil y configuraciones",roleBasedAccess:"Funcionalidades habilitadas para tu rol",needAccess:"¿Necesitas acceso? Contacta a tu administrador o gerente para solicitar los permisos apropiados.",permissions:{accountAccess:"Acceso a Gestión de Cuentas",inventoryAccess:"Acceso a Inventario",employeeAccess:"Acceso a Recursos Humanos",bankingAccess:"Acceso Bancario",journalAccess:"Acceso a Asientos Contables",adminAccess:"Acceso Administrativo",financialReporting:"Acceso a Reportes Financieros",invoiceManagement:"Acceso a Gestión de Facturas",productManagement:"Acceso a Gestión de Productos"}}}},zw=()=>{if(typeof window<"u"){const t=localStorage.getItem("hrmfinance-language");if(t&&["en","es"].includes(t))return t}return"en"},[Gh,qw]=fe(zw()),it=()=>({t:(n,o,i)=>{const a=Gh(),c=n.split(".");let u=jw[a];for(const y of c)if(u&&typeof u=="object"&&y in u)u=u[y];else return o||n;let h=typeof u=="string"?u:o||n;return i&&typeof h=="string"&&Object.keys(i).forEach(y=>{const b=i[y],_=`{{${y}}}`;h=h.replace(new RegExp(_,"g"),String(b))}),h},language:()=>Gh(),setLanguage:n=>{qw(n),typeof window<"u"&&localStorage.setItem("hrmfinance-language",n)}});var Gw=z("<div><label></label><select><option value>"),Hw=z("<span>*"),Ww=z("<option>");const vr=t=>{const{t:e}=it(),r={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},n={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},o={"margin-bottom":"1rem"};return(()=>{var i=Gw(),a=i.firstChild,c=a.nextSibling,u=c.firstChild;return d(i,o),d(a,r),s(a,()=>t.label,null),s(a,(()=>{var h=ge(()=>!!t.required);return()=>h()&&(()=>{var y=Hw();return y.style.setProperty("color","var(--primary-color)"),y})()})(),null),c.addEventListener("blur",h=>h.target.style.borderColor="var(--border-color)"),c.addEventListener("focus",h=>h.target.style.borderColor="var(--primary-color)"),c.addEventListener("change",h=>t.onChange(h.target.value)),d(c,n),s(u,()=>e("forms.selectOption")),s(c,()=>t.options.map(h=>(()=>{var y=Ww();return s(y,()=>h.label),le(()=>y.value=h.value),y})()),null),le(h=>{var y=t.required,b=t.disabled;return y!==h.e&&(c.required=h.e=y),b!==h.t&&(c.disabled=h.t=b),h},{e:void 0,t:void 0}),le(()=>c.value=t.value),i})()};var Yw=z("<main><div>"),Kw=z("<header><h1>");const Ur=t=>{const e={"min-height":"100vh",background:"var(--background-color)"},r={"max-width":"1200px",margin:"0 auto",padding:"2rem"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},o={"font-size":"2rem","font-weight":"700",color:"var(--text-primary)",margin:"0"};return(()=>{var i=Yw(),a=i.firstChild;return d(i,e),d(a,r),s(a,(()=>{var c=ge(()=>!!t.title);return()=>c()&&(()=>{var u=Kw(),h=u.firstChild;return d(u,n),d(h,o),s(h,()=>t.title),u})()})(),null),s(a,()=>t.children,null),i})()};var Qw=z("<div><span></span><select><option value=en>🇺🇸 </option><option value=es>🇪🇸 ");const Jw=()=>{const{t,language:e,setLanguage:r}=it(),n={display:"flex","align-items":"center",gap:"0.5rem","margin-left":"auto"},o={padding:"0.5rem 1rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",background:"var(--surface-color)",color:"var(--text-primary)",cursor:"pointer","font-size":"0.875rem","font-weight":"500",transition:"all 0.2s ease","min-width":"120px"},i={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},a=c=>{const u=c.target;r(u.value)};return(()=>{var c=Qw(),u=c.firstChild,h=u.nextSibling,y=h.firstChild;y.firstChild;var b=y.nextSibling;return b.firstChild,d(c,n),d(u,i),h.addEventListener("change",a),d(h,o),s(y,()=>t("common.english"),null),s(b,()=>t("common.spanish"),null),le(()=>h.value=e()),c})()};var Hh=z('<img alt="User avatar">'),Xw=z("<div class=user-info-desktop><span>"),Zw=z("<button class=sign-out-desktop>Sign Out"),eC=z("<div><div><span></span></div><button>Sign Out"),tC=z(`<nav><div><div class=desktop-nav></div><div><button class=mobile-menu-button><svg width=24 height=24 viewBox="0 0 24 24"fill=currentColor><path></path></svg></button></div></div><div class=mobile-nav></div><style>
        .nav-active {
          background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)) !important;
          color: white !important;
          box-shadow: var(--shadow-sm);
        }
        
        .desktop-nav a:hover:not(.nav-active),
        .nav-group button:hover {
          background: var(--background-color);
          color: var(--text-primary);
        }
        
        .mobile-nav a:hover:not(.nav-active) {
          background: var(--background-color);
          color: var(--text-primary);
        }

        /* Create invisible bridge to prevent gap issues */
        .nav-group::before {
          content: '';
          position: absolute;
          top: 100%;
          left: 0;
          right: 0;
          height: 0.5rem;
          z-index: 9;
        }
        
        @media (max-width: 768px) {
          .desktop-nav {
            display: none !important;
          }
          
          .mobile-menu-button {
            display: block !important;
          }
          
          .user-info-desktop,
          .sign-out-desktop {
            display: none !important;
          }
          
          nav > div:first-child {
            padding: 1rem;
          }
        }
        
        @media (min-width: 769px) {
          .mobile-nav {
            display: none !important;
          }
        }
      `),rC=z("<div class=nav-group><button> <span>▼</span></button><div>"),nC=z("<div>"),oC=z("<div><div><span> </span><span>▼");const iC=()=>{const{t}=it(),[e,r]=fe(!1),[n,o]=fe(null),[i,a]=fe(null),c={background:"var(--surface-color)","border-bottom":"1px solid var(--border-color)","box-shadow":"var(--shadow-sm)","backdrop-filter":"blur(10px)",position:"sticky",top:"0","z-index":"100"},u={display:"flex","align-items":"center","justify-content":"space-between",padding:"1rem 2rem",margin:"0 auto",position:"relative"},h={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","text-decoration":"none"},y={display:"flex",gap:"1rem","align-items":"center",flex:"1","margin-left":"2rem"},b={display:"none",position:"absolute",top:"100%",left:"0",right:"0",background:"var(--surface-color)","border-top":"1px solid var(--border-color)","box-shadow":"var(--shadow-md)","max-height":"70vh","overflow-y":"auto"},_={position:"relative",display:"flex","align-items":"center"},A={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem",background:"transparent",border:"none",color:"var(--text-secondary)","font-weight":"500","font-size":"0.875rem",cursor:"pointer","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease","white-space":"nowrap"},E={position:"absolute",top:"100%",left:"0",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","min-width":"200px","margin-top":"0.25rem","z-index":"10",display:"none","padding-top":"0.25rem"},R={"border-bottom":"1px solid var(--border-color)"},P={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",cursor:"pointer","font-weight":"600",color:"var(--text-primary)"},k={display:"block","text-decoration":"none",color:"var(--text-secondary)",padding:"0.75rem 1rem","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease","white-space":"nowrap"},K={...k,padding:"0.75rem 1.5rem","border-bottom":"1px solid var(--border-light)"},oe={display:"none",background:"transparent",border:"none",padding:"0.5rem",cursor:"pointer",color:"var(--text-primary)"},O={display:"flex","align-items":"center",gap:"1rem"},M={display:"flex","align-items":"center",gap:"0.75rem",padding:"0.5rem 1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",color:"var(--text-primary)"},N={width:"32px",height:"32px","border-radius":"50%","object-fit":"cover"},g={...k,cursor:"pointer",border:"1px solid var(--border-color)",background:"transparent","border-radius":"var(--border-radius-sm)"},v=()=>{wt.signOut()},f=$=>{const V=wt.state?.profile;return V?V[$]===!0||V.isAdmin===!0:!1},C=()=>{r(!e())},S=$=>{o(n()===$?null:$)},x=$=>{const V=i();V&&(clearTimeout(V),a(null)),o($)},m=()=>{const $=setTimeout(()=>{o(null)},300);a($)},re=[{name:"Finance",icon:"💰",items:[{path:"/accounts",label:t("navigation.accounts"),permission:"AccountAccess",icon:"📊"},{path:"/entry-books",label:t("navigation.entryBooks"),permission:"JournalAccess",icon:"📚"},{path:"/balance-sheet",label:t("navigation.balanceSheet"),permission:"AccountAccess",icon:"📈"},{path:"/bank-consolidations",label:t("navigation.consolidate"),permission:"BankingAccess",icon:"🏦"}]},{name:"Operations",icon:"📦",items:[{path:"/inventory",label:t("navigation.inventory"),permission:"InventoryAccess",icon:"📦"},{path:"/invoices",label:t("navigation.invoice"),permission:"invoiceAccess",icon:"📚"}]},{name:"Management",icon:"👥",items:[{path:"/employees",label:t("navigation.employees"),permission:"EmployeeAccess",icon:"👷"},{path:"/admin/users",label:"Admin",permission:"isAdmin",icon:"👑",adminOnly:!0}]}],Y=()=>re.map($=>({...$,items:$.items.filter(V=>V.adminOnly?wt.state?.profile?.isAdmin:f(V.permission))})).filter($=>$.items.length>0);return(()=>{var $=tC(),V=$.firstChild,Q=V.firstChild,L=Q.nextSibling,D=L.firstChild,j=D.firstChild,ue=j.firstChild,W=V.nextSibling;return s(V,w(Yo,{href:"/",style:h,children:"HRM Finance"}),Q),d(Q,y),s(Q,w(Yo,{href:"/",style:k,activeClass:"nav-active",get children(){return["🏠 ",ge(()=>t("navigation.dashboard"))]}}),null),s(Q,w(nt,{get each(){return Y()},children:ce=>(()=>{var T=rC(),G=T.firstChild,Z=G.firstChild,F=Z.nextSibling,ne=G.nextSibling;return T.addEventListener("mouseleave",m),T.addEventListener("mouseenter",()=>x(ce.name)),s(G,()=>ce.icon,Z),s(G,()=>ce.name,F),F.style.setProperty("font-size","0.75rem"),ne.addEventListener("mouseleave",m),ne.addEventListener("mouseenter",()=>x(ce.name)),s(ne,w(nt,{get each(){return ce.items},children:H=>w(Yo,{get href(){return H.path},style:k,activeClass:"nav-active",onClick:()=>o(null),get children(){return[ge(()=>H.icon)," ",ge(()=>H.label)]}})})),le(H=>{var U=_,ae=A,se={...E,display:n()===ce.name?"block":"none"};return H.e=d(T,U,H.e),H.t=d(G,ae,H.t),H.a=d(ne,se,H.a),H},{e:void 0,t:void 0,a:void 0}),T})()}),null),d(L,O),s(L,w(Jw,{}),D),s(L,w(Re,{get when(){return wt.currentUser},get children(){return[(()=>{var ce=Xw(),T=ce.firstChild;return s(ce,w(Re,{get when(){return wt.currentUser?.photoURL},get children(){var G=Hh();return le(Z=>{var F=wt.currentUser.photoURL,ne=N;return F!==Z.e&&ct(G,"src",Z.e=F),Z.t=d(G,ne,Z.t),Z},{e:void 0,t:void 0}),G}}),T),s(T,()=>wt.currentUser?.displayName||wt.currentUser?.email),le(G=>d(ce,M,G)),ce})(),(()=>{var ce=Zw();return ce.addEventListener("mouseleave",T=>{T.currentTarget.style.background="transparent",T.currentTarget.style.color="var(--text-secondary)"}),ce.addEventListener("mouseenter",T=>{T.currentTarget.style.background="var(--background-color)",T.currentTarget.style.color="var(--text-primary)"}),ce.$$click=v,le(T=>d(ce,g,T)),ce})()]}}),D),D.$$click=C,d(D,oe),s(W,w(Yo,{href:"/",style:K,activeClass:"nav-active",onClick:()=>r(!1),get children(){return["🏠 ",ge(()=>t("navigation.dashboard"))]}}),null),s(W,w(nt,{get each(){return Y()},children:ce=>(()=>{var T=oC(),G=T.firstChild,Z=G.firstChild,F=Z.firstChild,ne=Z.nextSibling;return d(T,R),G.$$click=()=>S(ce.name),d(G,P),s(Z,()=>ce.icon,F),s(Z,()=>ce.name,null),ne.style.setProperty("transition","transform 0.2s"),s(T,w(Re,{get when(){return n()===ce.name},get children(){var H=nC();return H.style.setProperty("background","var(--background-color)"),s(H,w(nt,{get each(){return ce.items},children:U=>w(Yo,{get href(){return U.path},get style(){return{...K,"padding-left":"3rem"}},activeClass:"nav-active",onClick:()=>r(!1),get children(){return[ge(()=>U.icon)," ",ge(()=>U.label)]}})})),H}}),null),le(H=>(H=n()===ce.name?"rotate(180deg)":"none")!=null?ne.style.setProperty("transform",H):ne.style.removeProperty("transform")),T})()}),null),s(W,w(Re,{get when(){return wt.currentUser},get children(){var ce=eC(),T=ce.firstChild,G=T.firstChild,Z=T.nextSibling;return ce.style.setProperty("padding","1rem"),ce.style.setProperty("border-top","2px solid var(--border-color)"),s(T,w(Re,{get when(){return wt.currentUser?.photoURL},get children(){var F=Hh();return le(ne=>{var H=wt.currentUser.photoURL,U=N;return H!==ne.e&&ct(F,"src",ne.e=H),ne.t=d(F,U,ne.t),ne},{e:void 0,t:void 0}),F}}),G),s(G,()=>wt.currentUser?.displayName||wt.currentUser?.email),Z.$$click=()=>{v(),r(!1)},le(F=>{var ne={...M,"margin-bottom":"1rem"},H={...g,width:"100%"};return F.e=d(T,ne,F.e),F.t=d(Z,H,F.t),F},{e:void 0,t:void 0}),ce}}),null),le(ce=>{var T=c,G=u,Z=e()?"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z":"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z",F={...b,display:e()?"block":"none"};return ce.e=d($,T,ce.e),ce.t=d(V,G,ce.t),Z!==ce.a&&ct(ue,"d",ce.a=Z),ce.o=d(W,F,ce.o),ce},{e:void 0,t:void 0,a:void 0,o:void 0}),$})()};ft(["click"]);var sC=z("<div><div><div>🔒</div><h1></h1><p>.</p><div><p><strong></strong><br></p></div><div><button></button></div><div><h3></h3><div><span>✓</span><span></span></div><div><span>✓</span><span></span></div><div><span>✓</span><span></span></div></div><div><p>"),Wh=z("<br>"),aC=z("<strong>");const lC=t=>{const{t:e}=it(),r={"min-height":"calc(100vh - 200px)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},n={"text-align":"center","max-width":"600px",width:"100%"},o={"font-size":"5rem",color:"#e53e3e","margin-bottom":"2rem"},i={"font-size":"2.5rem","font-weight":"700",color:"#1a202c","margin-bottom":"1rem"},a={"font-size":"1.25rem",color:"#718096","margin-bottom":"2rem","line-height":"1.6"},c={background:"#f7fafc",border:"1px solid #e2e8f0","border-radius":"0.5rem",padding:"1.5rem","margin-bottom":"2rem"},u={color:"#4a5568","font-size":"1rem","line-height":"1.6"},h={display:"flex",gap:"1rem","justify-content":"center","flex-wrap":"wrap"},y={padding:"0.75rem 2rem","border-radius":"0.5rem","text-decoration":"none","font-weight":"500",transition:"all 0.2s",display:"inline-block"},b={...y,background:"var(--primary-color)",color:"white",border:"2px solid var(--primary-color)"},_={...y,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},A={"text-align":"left","margin-top":"2rem",padding:"0 2rem"},E={display:"flex","align-items":"center",gap:"0.75rem","margin-bottom":"1rem",color:"#4a5568"},R={color:"#48bb78","font-size":"1.25rem"};return w(Ur,{get title(){return e("unauthorized.title")},get children(){var P=sC(),k=P.firstChild,K=k.firstChild,oe=K.nextSibling,O=oe.nextSibling,M=O.firstChild,N=O.nextSibling,g=N.firstChild,v=g.firstChild;v.nextSibling;var f=N.nextSibling,C=f.firstChild,S=f.nextSibling,x=S.firstChild,m=x.nextSibling,re=m.firstChild,Y=re.nextSibling,$=m.nextSibling,V=$.firstChild,Q=V.nextSibling,L=$.nextSibling,D=L.firstChild,j=D.nextSibling,ue=S.nextSibling,W=ue.firstChild;return d(P,r),d(k,n),d(K,o),d(oe,i),s(oe,()=>e("unauthorized.accessDenied")),d(O,a),s(O,()=>e("unauthorized.noPermission"),M),s(O,(()=>{var ce=ge(()=>!!t.featureName);return()=>ce()?` ${t.featureName}`:` ${e("unauthorized.thisFeature")}`})(),M),d(N,c),d(g,u),s(v,()=>e("unauthorized.whySeeing")),s(g,()=>e("unauthorized.explanation"),null),s(g,(()=>{var ce=ge(()=>!!t.requiredPermission);return()=>ce()&&[Wh(),Wh(),(()=>{var T=aC();return s(T,()=>e("unauthorized.requiredPermission")),T})()," ",ge(()=>t.requiredPermission)]})(),null),d(f,h),s(f,w(Yo,{href:"/",style:b,get children(){return e("unauthorized.goToDashboard")}}),C),C.$$click=()=>window.history.back(),s(C,()=>e("unauthorized.goBack")),d(S,A),x.style.setProperty("margin-bottom","1rem"),x.style.setProperty("color","#2d3748"),s(x,()=>e("unauthorized.featuresCanAccess")),s(Y,()=>e("unauthorized.dashboardAccess")),s(Q,()=>e("unauthorized.profileAccess")),s(j,()=>e("unauthorized.roleBasedAccess")),ue.style.setProperty("margin-top","3rem"),ue.style.setProperty("padding","1.5rem"),ue.style.setProperty("background","#edf2f7"),ue.style.setProperty("border-radius","0.5rem"),W.style.setProperty("color","#4a5568"),W.style.setProperty("font-size","0.875rem"),s(W,()=>e("unauthorized.needAccess")),le(ce=>{var T=_,G=E,Z=R,F=E,ne=R,H=E,U=R;return ce.e=d(C,T,ce.e),ce.t=d(m,G,ce.t),ce.a=d(re,Z,ce.a),ce.o=d($,F,ce.o),ce.i=d(V,ne,ce.i),ce.n=d(L,H,ce.n),ce.s=d(D,U,ce.s),ce},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),P}})};ft(["click"]);const rn=t=>{const{t:e}=it(),r=()=>{if(!t.permission)return!0;const o=wt.state?.profile;if(!o)return!1;if(o.isAdmin)return!0;switch(t.permission){case"AccountAccess":return o.AccountAccess===!0;case"InventoryAccess":return o.InventoryAccess===!0;case"EmployeeAccess":return o.EmployeeAccess===!0;case"BankingAccess":return o.BankingAccess===!0;case"JournalAccess":return o.JournalAccess===!0;case"AdminAccess":return o.isAdmin===!0;default:return o[t.permission]===!0}},n=()=>{if(t.requiredPermission)return t.requiredPermission;switch(t.permission){case"AccountAccess":return e("unauthorized.permissions.accountAccess");case"InventoryAccess":return e("unauthorized.permissions.inventoryAccess");case"EmployeeAccess":return e("unauthorized.permissions.employeeAccess");case"BankingAccess":return e("unauthorized.permissions.bankingAccess");case"JournalAccess":return e("unauthorized.permissions.journalAccess");case"AdminAccess":return e("unauthorized.permissions.adminAccess");default:return t.permission}};return w(Re,{get when(){return r()},get fallback(){return t.fallback||w(lC,{get featureName(){return t.featureName},get requiredPermission(){return n()}})},get children(){return t.children}})};var cC=z('<button title="Open Dev Tools">🛠️'),dC=z("<span>(<!>)"),uC=z("<div><span></span><span>"),Yh=z("<div>"),hC=z("<div>Database reset only available in fake mode"),mC=z("<div><div>Loading..."),yC=z("<div><div><h3>🛠️ Dev Tools</h3><button>✕</button></div><div><div>API Mode</div><div><button>Fake Server</button><button>Real API</button><button>Hybrid</button></div><div>Current: <strong></strong></div></div><div><div>Health Status</div></div><div><div>Database Stats</div></div><div><div>Actions</div><div><button>🔄 Refresh Stats</button><button>💊 Health Check</button></div><div><button>🗑️ Reset DB</button></div></div><div><div>Info</div><div>• <strong>Fake Server:</strong> Uses local mock data<br>• <strong>Real API:</strong> Connects to actual backend<br>• <strong>Hybrid:</strong> Real API with fake fallback<br>• Settings are saved in localStorage"),pC=z("<div>Loading..."),fC=z("<div><span>:</span><span>");const gC=()=>{const[t,e]=fe(!1),[r,n]=fe(ts.getMode()),[o,i]=fe({}),[a,c]=fe(null),[u,h]=fe(!1);Hr(async()=>{await y(),await b()});const y=async()=>{try{const g=await pu.getStats();i(g)}catch(g){console.error("Failed to load stats:",g)}},b=async()=>{try{const g=await pu.healthCheck();c(g)}catch(g){console.error("Health check failed:",g),c({status:"error",error:g.message})}},_=async g=>{h(!0);try{ts.setMode(g),n(g),await y(),await b()}catch(v){console.error("Failed to change API mode:",v)}finally{h(!1)}},A=async()=>{if(confirm("Are you sure you want to reset the fake database to its initial state?")){h(!0);try{const g=await Vr.utils.resetDatabase();alert(g.message),await y()}catch(g){console.error("Failed to reset database:",g),alert("Failed to reset database")}finally{h(!1)}}},E={position:"fixed",bottom:"20px",right:"20px","z-index":"10000","font-family":"monospace"},R={background:"#1a1a1a",color:"#fff",border:"1px solid #333","border-radius":"8px",padding:"16px","min-width":"300px","max-width":"400px","box-shadow":"0 4px 20px rgba(0,0,0,0.3)"},P={background:"#007acc",color:"#fff",border:"none","border-radius":"50%",width:"50px",height:"50px",cursor:"pointer","font-size":"20px","box-shadow":"0 2px 10px rgba(0,0,0,0.2)",display:"flex","align-items":"center","justify-content":"center"},k={background:"#333",color:"#fff",border:"1px solid #555","border-radius":"4px",padding:"6px 12px",cursor:"pointer","font-size":"12px","margin-right":"8px","margin-bottom":"8px"},K={...k,background:"#007acc","border-color":"#007acc"},oe={"margin-bottom":"16px","padding-bottom":"12px","border-bottom":"1px solid #333"},O={"font-size":"14px","font-weight":"bold","margin-bottom":"8px",color:"#007acc"},M={display:"flex","justify-content":"space-between","font-size":"12px","margin-bottom":"4px"},N=g=>({display:"inline-block",width:"8px",height:"8px","border-radius":"50%","margin-right":"8px",background:g==="healthy"?"#00ff00":g==="error"?"#ff0000":"#ffff00"});return(()=>{var g=Yh();return s(g,w(Re,{get when(){return!t()},get children(){var v=cC();return v.$$click=()=>e(!0),d(v,P),v}}),null),s(g,w(Re,{get when(){return t()},get children(){var v=yC(),f=v.firstChild,C=f.firstChild,S=C.nextSibling,x=f.nextSibling,m=x.firstChild,re=m.nextSibling,Y=re.firstChild,$=Y.nextSibling,V=$.nextSibling,Q=re.nextSibling,L=Q.firstChild,D=L.nextSibling,j=x.nextSibling,ue=j.firstChild,W=j.nextSibling,ce=W.firstChild,T=W.nextSibling,G=T.firstChild,Z=G.nextSibling,F=Z.firstChild,ne=F.nextSibling,H=Z.nextSibling,U=H.firstChild,ae=T.nextSibling,se=ae.firstChild,pe=se.nextSibling;return d(v,R),f.style.setProperty("display","flex"),f.style.setProperty("justify-content","space-between"),f.style.setProperty("align-items","center"),f.style.setProperty("margin-bottom","16px"),C.style.setProperty("margin","0"),C.style.setProperty("color","#007acc"),C.style.setProperty("font-size","16px"),S.$$click=()=>e(!1),Y.$$click=()=>_("fake"),$.$$click=()=>_("real"),V.$$click=()=>_("hybrid"),Q.style.setProperty("font-size","11px"),Q.style.setProperty("color","#888"),Q.style.setProperty("margin-top","4px"),s(D,r),s(Q,()=>r()==="fake"&&" (Using fake server)",null),s(Q,()=>r()==="real"&&" (Using real API)",null),s(Q,()=>r()==="hybrid"&&" (Real API with fallback)",null),s(j,w(Re,{get when(){return a()},get fallback(){return(()=>{var de=pC();return de.style.setProperty("font-size","12px"),de})()},get children(){return[(()=>{var de=uC(),ye=de.firstChild,X=ye.nextSibling;return de.style.setProperty("display","flex"),de.style.setProperty("align-items","center"),de.style.setProperty("font-size","12px"),s(X,()=>a()?.status||"Unknown"),s(de,w(Re,{get when(){return a()?.timestamp},get children(){var ee=dC(),q=ee.firstChild,he=q.nextSibling;return he.nextSibling,ee.style.setProperty("margin-left","8px"),ee.style.setProperty("color","#888"),s(ee,()=>new Date(a().timestamp).toLocaleTimeString(),he),ee}}),null),le(ee=>d(ye,N(a()?.status||"unknown"),ee)),de})(),w(Re,{get when(){return a()?.error},get children(){var de=Yh();return de.style.setProperty("font-size","11px"),de.style.setProperty("color","#ff6666"),de.style.setProperty("margin-top","4px"),s(de,()=>a().error),de}})]}}),null),s(W,w(nt,{get each(){return Object.entries(o())},children:([de,ye])=>(()=>{var X=fC(),ee=X.firstChild,q=ee.firstChild,he=ee.nextSibling;return d(X,M),ee.style.setProperty("text-transform","capitalize"),s(ee,de,q),he.style.setProperty("color","#00ff00"),s(he,ye),X})()}),null),F.$$click=y,ne.$$click=b,H.style.setProperty("margin-top","8px"),U.$$click=A,s(T,w(Re,{get when(){return r()!=="fake"},get children(){var de=hC();return de.style.setProperty("font-size","11px"),de.style.setProperty("color","#888"),de.style.setProperty("margin-top","4px"),de}}),null),pe.style.setProperty("font-size","11px"),pe.style.setProperty("color","#888"),pe.style.setProperty("line-height","1.4"),s(v,w(Re,{get when(){return u()},get children(){var de=mC(),ye=de.firstChild;return de.style.setProperty("position","absolute"),de.style.setProperty("top","0"),de.style.setProperty("left","0"),de.style.setProperty("right","0"),de.style.setProperty("bottom","0"),de.style.setProperty("background","rgba(0,0,0,0.7)"),de.style.setProperty("display","flex"),de.style.setProperty("align-items","center"),de.style.setProperty("justify-content","center"),de.style.setProperty("border-radius","8px"),ye.style.setProperty("color","#fff"),ye.style.setProperty("font-size","14px"),de}}),null),le(de=>{var ye={...k,padding:"4px 8px"},X=oe,ee=O,q=r()==="fake"?K:k,he=u(),ve=r()==="real"?K:k,B=u(),te=r()==="hybrid"?K:k,_e=u(),we=oe,me=O,be=oe,ie=O,Pe=oe,Te=O,$e=k,Ee=u(),Ve=k,Ke=u(),je={...k,background:"#cc4400","border-color":"#cc4400"},Ce=u()||r()!=="fake",Be=O;return de.e=d(S,ye,de.e),de.t=d(x,X,de.t),de.a=d(m,ee,de.a),de.o=d(Y,q,de.o),he!==de.i&&(Y.disabled=de.i=he),de.n=d($,ve,de.n),B!==de.s&&($.disabled=de.s=B),de.h=d(V,te,de.h),_e!==de.r&&(V.disabled=de.r=_e),de.d=d(j,we,de.d),de.l=d(ue,me,de.l),de.u=d(W,be,de.u),de.c=d(ce,ie,de.c),de.w=d(T,Pe,de.w),de.m=d(G,Te,de.m),de.f=d(F,$e,de.f),Ee!==de.y&&(F.disabled=de.y=Ee),de.g=d(ne,Ve,de.g),Ke!==de.p&&(ne.disabled=de.p=Ke),de.b=d(U,je,de.b),Ce!==de.T&&(U.disabled=de.T=Ce),de.A=d(se,Be,de.A),de},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),v}}),null),le(v=>d(g,E,v)),g})()};ft(["click"]);const vC=[{id:"1",accountNumber:"1000",name:"Cash and Cash Equivalents",type:"Asset",category:"Current Assets",description:"Cash on hand and in bank accounts",balance:45230.5,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1001",accountNumber:"1001",name:"Petty Cash",type:"Asset",category:"Current Assets",description:"Small amounts of cash for minor expenses",balance:500,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1002",accountNumber:"1002",name:"Bank - Checking Account",type:"Asset",category:"Current Assets",description:"Main operating checking account",balance:32730.5,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1003",accountNumber:"1003",name:"Bank - Savings Account",type:"Asset",category:"Current Assets",description:"Interest-bearing savings account",balance:12e3,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"2",accountNumber:"1100",name:"Accounts Receivable",type:"Asset",category:"Current Assets",description:"Money owed by customers",balance:23450.75,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2001",accountNumber:"1101",name:"Trade Receivables",type:"Asset",category:"Current Assets",description:"Receivables from regular customers",balance:18450.75,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2002",accountNumber:"1102",name:"Employee Advances",type:"Asset",category:"Current Assets",description:"Money advanced to employees",balance:5e3,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"3",accountNumber:"1200",name:"Inventory",type:"Asset",category:"Current Assets",description:"Products held for sale",balance:78920.25,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-13"},{id:"4",accountNumber:"1500",name:"Equipment",type:"Asset",category:"Fixed Assets",description:"Office equipment and machinery",balance:125e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-12"},{id:"5",accountNumber:"2000",name:"Accounts Payable",type:"Liability",category:"Current Liabilities",description:"Money owed to suppliers",balance:15670.3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-11"},{id:"6",accountNumber:"2100",name:"Accrued Expenses",type:"Liability",category:"Current Liabilities",description:"Expenses incurred but not yet paid",balance:8945.6,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-10"},{id:"7",accountNumber:"2500",name:"Long-term Debt",type:"Liability",category:"Long-term Liabilities",description:"Long-term loans and mortgages",balance:85e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-09"},{id:"8",accountNumber:"3000",name:"Owner's Equity",type:"Equity",category:"Owner's Equity",description:"Owner's investment in the business",balance:15e4,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-08"},{id:"9",accountNumber:"3100",name:"Retained Earnings",type:"Equity",category:"Owner's Equity",description:"Accumulated profits retained in business",balance:32450.8,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-07"},{id:"10",accountNumber:"4000",name:"Sales Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from product sales",balance:245678.9,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-06"},{id:"11",accountNumber:"4100",name:"Service Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from services provided",balance:89432.15,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-05"},{id:"12",accountNumber:"5000",name:"Cost of Goods Sold",type:"Expense",category:"Operating Expenses",description:"Direct costs of producing goods",balance:125678.45,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-04"},{id:"13",accountNumber:"5100",name:"Salaries Expense",type:"Expense",category:"Operating Expenses",description:"Employee salary expenses",balance:98765.32,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-03"},{id:"14",accountNumber:"5200",name:"Rent Expense",type:"Expense",category:"Operating Expenses",description:"Office rent expenses",balance:24e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-02"}],bC=[{id:"1",accountId:"1",date:"2024-01-15",description:"Customer payment received",debitAmount:5e3,creditAmount:0,reference:"INV-2024-001",type:"debit"},{id:"2",accountId:"2",date:"2024-01-15",description:"Customer payment received",debitAmount:0,creditAmount:5e3,reference:"INV-2024-001",type:"credit"},{id:"3",accountId:"5",date:"2024-01-14",description:"Office supplies purchased",debitAmount:0,creditAmount:1250,reference:"PO-2024-001",type:"credit"}],[nn,js]=fe(vC),[$l,_C]=fe(bC),xt={get accounts(){return nn()},get transactions(){return $l()},fetchAllAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return js([...nn(),e]),e},addAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return js([...nn(),e]),e},updateAccount(t,e){js(nn().map(r=>r.id===t?{...r,...e,lastModified:new Date().toISOString().split("T")[0]}:r))},deleteAccount(t){js(nn().filter(e=>e.id!==t))},getAccountById(t){return nn().find(e=>e.id===t)},getAccountsByType(t){return nn().filter(e=>e.type===t)},getAccountTransactions(t){return $l().filter(e=>e.accountId===t)},addTransaction(t){const e={...t,id:Date.now().toString()};_C([...$l(),e]);const r=this.getAccountById(t.accountId);if(r){const n=t.type==="debit"?t.debitAmount:-t.creditAmount;this.updateAccount(t.accountId,{balance:r.balance+n})}return e},getTotalByType(t){return nn().filter(e=>e.type===t&&e.isActive).reduce((e,r)=>e+r.balance,0)},getAccountCategories(t){const e=this.getAccountsByType(t);return[...new Set(e.map(r=>r.category))]},getSubAccounts(t){return nn().filter(e=>e.parentAccountId===t)},getParentAccounts(){return nn().filter(t=>!t.parentAccountId)},getAccountHierarchy(){return this.getParentAccounts().map(e=>({...e,subAccounts:this.getSubAccounts(e.id)}))},getAccountWithSubAccounts(t){const e=this.getAccountById(t);return e?{...e,subAccounts:this.getSubAccounts(t),parentAccount:e.parentAccountId?this.getAccountById(e.parentAccountId):null}:null},getAccountPath(t){const e=this.getAccountById(t);if(!e)return[];const r=[e];let n=e;for(;n.parentAccountId;){const o=this.getAccountById(n.parentAccountId);if(o)r.unshift(o),n=o;else break}return r},getTotalBalanceWithSubAccounts(t){const e=this.getAccountById(t);if(!e)return 0;const n=this.getSubAccounts(t).reduce((o,i)=>o+this.getTotalBalanceWithSubAccounts(i.id),0);return e.balance+n},canDeleteAccount(t){const e=this.getSubAccounts(t);if(e.length>0)return{canDelete:!1,reason:`Account has ${e.length} sub-account(s). Delete or move sub-accounts first.`};const r=this.getAccountTransactions(t);return r.length>0?{canDelete:!1,reason:`Account has ${r.length} transaction(s). Cannot delete account with transaction history.`}:{canDelete:!0}}};var zn=z("<div>"),ki=z("<div> ");const PC=()=>{const{t}=it(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},n={"font-size":"0.875rem",color:"var(--text-muted)"},o=R=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(R),i=xt.getTotalByType("Asset"),a=xt.getTotalByType("Liability"),c=xt.getTotalByType("Equity"),u=xt.getTotalByType("Revenue"),h=xt.getTotalByType("Expense"),y=xt.getAccountsByType("Asset").length,b=xt.getAccountsByType("Liability").length,_=xt.getAccountsByType("Equity").length,A=xt.getAccountsByType("Revenue").length,E=xt.getAccountsByType("Expense").length;return(()=>{var R=zn();return d(R,e),s(R,w(Ge,{get title(){return t("dashboard.totalAssets")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var P=zn();return s(P,()=>o(i)),le(k=>d(P,r,k)),P})(),(()=>{var P=ki(),k=P.firstChild;return s(P,y,k),s(P,()=>t("navigation.accounts"),null),le(K=>d(P,n,K)),P})()]}}),null),s(R,w(Ge,{get title(){return t("dashboard.totalLiabilities")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var P=zn();return s(P,()=>o(a)),le(k=>d(P,r,k)),P})(),(()=>{var P=ki(),k=P.firstChild;return s(P,b,k),s(P,()=>t("navigation.accounts"),null),le(K=>d(P,n,K)),P})()]}}),null),s(R,w(Ge,{get title(){return t("dashboard.totalEquity")},get subtitle(){return t("accounts.categories.ownersEquity")},get children(){return[(()=>{var P=zn();return s(P,()=>o(c)),le(k=>d(P,r,k)),P})(),(()=>{var P=ki(),k=P.firstChild;return s(P,_,k),s(P,()=>t("navigation.accounts"),null),le(K=>d(P,n,K)),P})()]}}),null),s(R,w(Ge,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("accounts.categories.operatingRevenue")},get children(){return[(()=>{var P=zn();return s(P,()=>o(u)),le(k=>d(P,r,k)),P})(),(()=>{var P=ki(),k=P.firstChild;return s(P,A,k),s(P,()=>t("navigation.accounts"),null),le(K=>d(P,n,K)),P})()]}}),null),s(R,w(Ge,{get title(){return t("dashboard.totalExpenses")},get subtitle(){return t("accounts.categories.operatingExpenses")},get children(){return[(()=>{var P=zn();return s(P,()=>o(h)),le(k=>d(P,r,k)),P})(),(()=>{var P=ki(),k=P.firstChild;return s(P,E,k),s(P,()=>t("navigation.accounts"),null),le(K=>d(P,n,K)),P})()]}}),null),s(R,w(Ge,{get title(){return t("dashboard.netIncome")},get subtitle(){return`${t("dashboard.totalRevenue")} - ${t("dashboard.totalExpenses")}`},get children(){return[(()=>{var P=zn();return s(P,()=>o(u-h)),le(k=>d(P,{...r,color:u-h>=0?"#4caf50":"#f44336"},k)),P})(),(()=>{var P=zn();return s(P,()=>u-h>=0?t("dashboard.netIncome"):t("dashboard.netLoss")),le(k=>d(P,n,k)),P})()]}}),null),R})()};var SC=z("<div><div></div><div>"),wC=z("<h3>"),Ri=z("<div>");const CC=t=>{const{t:e}=it();Lc();const r={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},o={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"},i={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},a={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},c={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem"},u={"font-size":"0.875rem",color:"var(--text-secondary)","line-height":"1.4"},h=_=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[_]||{bg:"#f5f5f5",color:"#666"},y=_=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(_),b=h(t.account.type);return w(Ge,{get children(){return[(()=>{var _=SC(),A=_.firstChild,E=A.nextSibling;return d(_,n),d(A,o),s(A,()=>t.account.accountNumber),s(E,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),le(R=>d(E,{...i,background:b.bg,color:b.color},R)),_})(),(()=>{var _=wC();return _.style.setProperty("margin","0 0 0.5rem 0"),_.style.setProperty("font-size","1.1rem"),s(_,()=>t.account.name),_})(),(()=>{var _=Ri();return d(_,c),s(_,()=>t.account.category),_})(),(()=>{var _=Ri();return d(_,a),s(_,()=>y(t.account.balance)),_})(),(()=>{var _=Ri();return d(_,u),s(_,()=>t.account.description),_})(),ge(()=>ge(()=>!t.account.isActive)()&&(()=>{var _=Ri();return _.style.setProperty("margin-top","0.5rem"),_.style.setProperty("padding","0.25rem 0.75rem"),_.style.setProperty("border-radius","9999px"),_.style.setProperty("font-size","0.75rem"),_.style.setProperty("font-weight","500"),_.style.setProperty("background","#ffebee"),_.style.setProperty("color","#d32f2f"),_.style.setProperty("text-align","center"),s(_,()=>e("common.inactive")),_})()),(()=>{var _=Ri();return d(_,r),s(_,w(Le,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.account),get children(){return[ge(()=>e("common.view"))," ",ge(()=>e("accounts.accountDetails"))]}})),_})()]}})};var AC=z("<div><div><div><div></div><h3></h3></div></div><div><div></div><div>"),xC=z("<div>"),IC=z("<button>"),$C=z("<div><h4> (<!>)"),EC=z("<div><div><div></div><div> • </div></div><div>");const TC=t=>{const{t:e}=it(),r=Lc(),[n,o]=fe(!0),i={"margin-bottom":"1rem"},a={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},c={display:"flex","align-items":"center",gap:"1rem"},u={background:"none",border:"none",cursor:"pointer","font-size":"1.2rem",color:"var(--text-muted)",padding:"0.25rem","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease"},h={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},y={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},b={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},_={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},A={"margin-left":"1rem","border-left":"2px solid var(--border-color)","padding-left":"1rem","margin-top":"1rem"},E={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem","margin-bottom":"0.5rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},R={flex:"1"},P={"font-weight":"500","margin-bottom":"0.25rem"},k={"font-size":"0.875rem",color:"var(--text-muted)"},K={"font-weight":"600",color:"var(--primary-color)"},oe={display:"flex",gap:"0.5rem"},O=C=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[C]||{bg:"#f5f5f5",color:"#666"},M=C=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(C),N=C=>{t.onViewDetails?t.onViewDetails(C):r(`/accounts/${C.id}`)},g=()=>{t.onAddSubAccount&&t.onAddSubAccount(t.account)},v=t.account.balance+t.account.subAccounts.reduce((C,S)=>C+S.balance,0),f=O(t.account.type);return w(Ge,{className:"account-hierarchy-card",style:i,get children(){return[(()=>{var C=AC(),S=C.firstChild,x=S.firstChild,m=x.firstChild,re=m.nextSibling,Y=S.nextSibling,$=Y.firstChild,V=$.nextSibling;return d(C,a),d(S,c),s(S,(()=>{var Q=ge(()=>t.account.subAccounts.length>0);return()=>Q()&&(()=>{var L=IC();return L.addEventListener("mouseleave",D=>D.target.style.background="none"),L.addEventListener("mouseenter",D=>D.target.style.background="var(--background-color)"),L.$$click=()=>o(!n()),d(L,u),s(L,()=>n()?"▼":"▶"),L})()})(),x),x.$$click=()=>N(t.account),x.style.setProperty("cursor","pointer"),d(m,h),s(m,()=>t.account.accountNumber),d(re,y),s(re,()=>t.account.name),Y.style.setProperty("text-align","right"),d($,b),s($,()=>M(v)),s(V,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),le(Q=>d(V,{..._,background:f.bg,color:f.color},Q)),C})(),(()=>{var C=xC();return d(C,oe),s(C,w(Le,{variant:"secondary",size:"sm",onClick:()=>N(t.account),get children(){return[ge(()=>e("common.view"))," ",ge(()=>e("accounts.accountDetails"))]}}),null),s(C,w(Le,{variant:"outline",size:"sm",onClick:g,get children(){return[ge(()=>e("common.add"))," ",ge(()=>e("accounts.subAccounts"))]}}),null),C})(),ge(()=>ge(()=>!!(n()&&t.account.subAccounts.length>0))()&&(()=>{var C=$C(),S=C.firstChild,x=S.firstChild,m=x.nextSibling;return m.nextSibling,d(C,A),S.style.setProperty("margin","0 0 1rem 0"),S.style.setProperty("font-size","1rem"),S.style.setProperty("color","var(--text-muted)"),s(S,()=>e("accounts.subAccounts"),x),s(S,()=>t.account.subAccounts.length,m),s(C,()=>t.account.subAccounts.map(re=>(()=>{var Y=EC(),$=Y.firstChild,V=$.firstChild,Q=V.nextSibling,L=Q.firstChild,D=$.nextSibling;return Y.addEventListener("mouseleave",j=>{j.currentTarget.style.background="var(--background-color)",j.currentTarget.style.transform="translateY(0)"}),Y.addEventListener("mouseenter",j=>{j.currentTarget.style.background="var(--surface-color)",j.currentTarget.style.transform="translateY(-1px)"}),Y.$$click=()=>N(re),d(Y,E),d($,R),d(V,P),s(V,()=>re.name),d(Q,k),s(Q,()=>re.accountNumber,L),s(Q,()=>re.description,null),d(D,K),s(D,()=>M(re.balance)),Y})()),null),C})())]}})};ft(["click"]);var kC=z("<form><div>");const RC=t=>{const{t:e}=it(),[r,n]=fe({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),o=[{value:"Asset",label:e("accounts.types.asset"),type:"debit",classification:"real"},{value:"Liability",label:e("accounts.types.liability"),type:"credit",classification:"real"},{value:"Equity",label:e("accounts.types.equity"),type:"credit",classification:"real"},{value:"Revenue",label:e("accounts.types.revenue"),type:"credit",classification:"nominal"},{value:"Expense",label:e("accounts.types.expense"),type:"debit",classification:"nominal"}],i=()=>{const y=r().type;return y?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")},{value:"Sales Revenue",label:e("accounts.categories.salesRevenue")},{value:"Service Revenue",label:e("accounts.categories.servicesRevenue")},{value:"Subscription Revenue",label:e("accounts.categories.subscriptionRevenue")},{value:"Rental Revenue",label:e("accounts.categories.rentalRevenue")},{value:"Commission Revenue",label:e("accounts.categories.commissionRevenue")},{value:"Franchise Revenue",label:e("accounts.categories.franchiseRevenue")},{value:"Licensing Revenue",label:e("accounts.categories.licensingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[y]||[]:[]},a=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],c={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},u=y=>{y.preventDefault();const b=r();if(!b.accountNumber||!b.name||!b.type||!b.category){alert(e("forms.requiredField"));return}if(xt.accounts.find(E=>E.accountNumber===b.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const A={accountNumber:b.accountNumber,name:b.name,type:b.type,category:b.category,description:b.description,balance:parseFloat(b.balance)||0,isActive:b.isActive==="true"};xt.addAccount(A),n({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},h=(y,b)=>{n(_=>{const A={..._,[y]:b};return y==="type"&&(A.category=""),A})};return w(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.addAccount")},get children(){var y=kC(),b=y.firstChild;return y.addEventListener("submit",u),s(y,w(Ot,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:_=>h("accountNumber",_),get placeholder(){return e("accounts.accountNumber")},required:!0}),b),s(y,w(Ot,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:_=>h("name",_),get placeholder(){return e("accounts.accountName")},required:!0}),b),s(y,w(vr,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:_=>h("type",_),options:o,required:!0}),b),s(y,w(vr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:_=>h("category",_),get options(){return i()},required:!0}),b),s(y,w(Ot,{get label(){return e("common.description")},get value(){return r().description},onChange:_=>h("description",_),get placeholder(){return e("common.description")}}),b),s(y,w(Ot,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:_=>h("balance",_),get placeholder(){return e("accounts.balance")}}),b),s(y,w(vr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:_=>h("isActive",_),options:a,required:!0}),b),d(b,c),s(b,w(Le,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(b,w(Le,{variant:"primary",type:"submit",get children(){return e("accounts.addAccount")}}),null),y}})};var DC=z("<form><div>"),NC=z("<div><div></div><div> - </div><div> • ");const LC=t=>{const{t:e}=it(),[r,n]=fe({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),o=()=>t.parentAccount?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[t.parentAccount.type]||[]:[],i=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],a={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},c={background:"var(--background-color)",padding:"1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1.5rem",border:"1px solid var(--border-color)"},u={"font-size":"0.875rem","font-weight":"500",color:"var(--text-muted)","margin-bottom":"0.5rem"},h={"font-weight":"600",color:"var(--text-primary)"},y={"font-size":"0.875rem",color:"var(--text-secondary)"},b=R=>{R.preventDefault();const P=r();if(!P.accountNumber||!P.name||!P.category||!t.parentAccount){alert(e("forms.requiredField"));return}if(xt.accounts.find(oe=>oe.accountNumber===P.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const K={accountNumber:P.accountNumber,name:P.name,type:t.parentAccount.type,category:P.category,description:P.description,balance:parseFloat(P.balance)||0,isActive:P.isActive==="true",parentAccountId:t.parentAccount.id};xt.addAccount(K),n({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},_=(R,P)=>{n(k=>({...k,[R]:P}))},A=()=>{if(!t.parentAccount)return"";const R=t.parentAccount.accountNumber,k=xt.getSubAccounts(t.parentAccount.id).length+1;return(parseInt(R)+k).toString()},E=()=>r().accountNumber===""&&t.parentAccount?A():r().accountNumber;return w(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return`${e("common.add")} ${e("accounts.subAccounts")}`},get children(){return[ge(()=>ge(()=>!!t.parentAccount)()&&(()=>{var R=NC(),P=R.firstChild,k=P.nextSibling,K=k.firstChild,oe=k.nextSibling,O=oe.firstChild;return d(R,c),d(P,u),s(P,()=>e("accounts.parentAccount")),d(k,h),s(k,()=>t.parentAccount.accountNumber,K),s(k,()=>t.parentAccount.name,null),d(oe,y),s(oe,()=>e(`accounts.types.${t.parentAccount.type.toLowerCase()}`),O),s(oe,()=>t.parentAccount.category,null),R})()),(()=>{var R=DC(),P=R.firstChild;return R.addEventListener("submit",b),s(R,w(Ot,{get label(){return e("accounts.accountNumber")},get value(){return E()},onChange:k=>_("accountNumber",k),get placeholder(){return`${e("common.suggested")}: ${A()}`},required:!0}),P),s(R,w(Ot,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:k=>_("name",k),get placeholder(){return e("accounts.accountName")},required:!0}),P),s(R,w(vr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:k=>_("category",k),get options(){return o()},required:!0}),P),s(R,w(Ot,{get label(){return e("common.description")},get value(){return r().description},onChange:k=>_("description",k),get placeholder(){return e("common.description")}}),P),s(R,w(Ot,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:k=>_("balance",k),get placeholder(){return e("accounts.balance")}}),P),s(R,w(vr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:k=>_("isActive",k),options:i,required:!0}),P),d(P,a),s(P,w(Le,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(P,w(Le,{variant:"primary",type:"submit",get children(){return[ge(()=>e("common.add"))," ",ge(()=>e("accounts.subAccounts"))]}}),null),R})()]}})};var MC=z("<form><div>"),OC=z("<div>");const VC=t=>{const{t:e}=it(),[r,n]=fe({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),[o,i]=fe(null);Nn(()=>{t.account&&(n({accountNumber:t.account.accountNumber,name:t.account.name,type:t.account.type,category:t.account.category,description:t.account.description,balance:t.account.balance.toString(),isActive:t.account.isActive.toString()}),i(null))});const a=[{value:"Asset",label:e("accounts.types.asset")},{value:"Liability",label:e("accounts.types.liability")},{value:"Equity",label:e("accounts.types.equity")},{value:"Revenue",label:e("accounts.types.revenue")},{value:"Expense",label:e("accounts.types.expense")}],c=()=>{const A=r().type;return A?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[A]||[]:[]},u=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},y=A=>{if(A.preventDefault(),i(null),!t.account)return;const E=r();if(!E.accountNumber||!E.name||!E.type||!E.category){i(e("forms.requiredField"));return}if(xt.accounts.find(k=>k.accountNumber===E.accountNumber&&k.id!==t.account.id)){i(e("forms.duplicateAccountNumber"));return}const P={accountNumber:E.accountNumber,name:E.name,type:E.type,category:E.category,description:E.description,balance:parseFloat(E.balance)||0,isActive:E.isActive==="true"};try{xt.updateAccount(t.account.id,P),t.onClose()}catch(k){i(k instanceof Error?k.message:e("forms.saveError"))}},b=()=>{if(!t.account)return;const A=xt.canDeleteAccount(t.account.id);if(!A.canDelete){i(A.reason||e("forms.deleteError"));return}const E=e("forms.confirmDelete");if(confirm(E))try{xt.deleteAccount(t.account.id),t.onClose()}catch(R){i(R instanceof Error?R.message:e("forms.deleteError"))}},_=(A,E)=>{n(R=>{const P={...R,[A]:E};return A==="type"&&(P.category=""),P}),o()&&i(null)};return t.account?w(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.editAccount")},get children(){var A=MC(),E=A.firstChild;return A.addEventListener("submit",y),s(A,w(Ot,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:R=>_("accountNumber",R),get placeholder(){return e("accounts.accountNumber")},required:!0}),E),s(A,w(Ot,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:R=>_("name",R),get placeholder(){return e("accounts.accountName")},required:!0}),E),s(A,w(vr,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:R=>_("type",R),options:a,required:!0}),E),s(A,w(vr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:R=>_("category",R),get options(){return c()},required:!0}),E),s(A,w(Ot,{get label(){return e("common.description")},get value(){return r().description},onChange:R=>_("description",R),get placeholder(){return e("common.description")}}),E),s(A,w(Ot,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:R=>_("balance",R),get placeholder(){return e("accounts.balance")}}),E),s(A,w(vr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:R=>_("isActive",R),options:u,required:!0}),E),s(A,(()=>{var R=ge(()=>!!o());return()=>R()&&(()=>{var P=OC();return P.style.setProperty("padding","1rem"),P.style.setProperty("border-radius","var(--border-radius-sm)"),P.style.setProperty("margin-top","1rem"),P.style.setProperty("background","#f8d7da"),P.style.setProperty("color","#721c24"),P.style.setProperty("border","1px solid #f5c6cb"),s(P,o),P})()})(),E),d(E,h),s(E,w(Le,{variant:"outline",type:"button",onClick:b,style:{color:"#dc3545","border-color":"#dc3545","margin-right":"auto"},get children(){return e("accounts.deleteAccount")}}),null),s(E,w(Le,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(E,w(Le,{variant:"primary",type:"submit",get children(){return e("common.save")}}),null),A}}):null};var FC=z("<div><div>⚠️</div><div></div><div></div><div>"),BC=z("<div><div></div><div></div><div>"),UC=z("<div><button></button><button> (<!>)"),El=z("<div>"),jC=z("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),zC=z("<div><div><div></div><div> • </div></div><div>");const qC=t=>{const{t:e}=it(),[r,n]=fe("details"),[o,i]=fe(!1),a=ze(()=>t.account?xt.getAccountById(t.account.id)||t.account:null),c={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},u={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},h={"font-weight":"600",color:"var(--text-primary)"},y={"text-align":"center","margin-bottom":"2rem"},b={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},_={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},A={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem"},E={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},R=f=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:f?"var(--primary-color)":"var(--text-muted)","border-bottom":f?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),P={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},k={flex:"1"},K={"font-size":"0.875rem",color:"var(--text-muted)"},oe={"font-weight":"500","margin-bottom":"0.25rem"},O=f=>({"font-weight":"600",color:f==="debit"?"#4caf50":"#f44336"}),M={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},N=f=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[f]||{bg:"#f5f5f5",color:"#666"},g=f=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(f),v=f=>new Date(f).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return w(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.accountDetails")},get children(){return[ge(()=>ge(()=>!a())()?(()=>{var f=FC(),C=f.firstChild,S=C.nextSibling,x=S.nextSibling,m=x.nextSibling;return f.style.setProperty("text-align","center"),f.style.setProperty("padding","3rem"),f.style.setProperty("color","var(--text-muted)"),C.style.setProperty("font-size","1.5rem"),C.style.setProperty("margin-bottom","1rem"),S.style.setProperty("font-size","1.1rem"),S.style.setProperty("margin-bottom","0.5rem"),s(S,()=>e("common.error")),x.style.setProperty("font-size","0.875rem"),s(x,()=>e("common.noDataFound")),m.style.setProperty("margin-top","2rem"),s(m,w(Le,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),f})():(()=>{const f=ze(()=>N(a().type)),C=ze(()=>xt.getAccountTransactions(a().id));return[(()=>{var S=BC(),x=S.firstChild,m=x.nextSibling,re=m.nextSibling;return d(S,y),d(x,b),s(x,()=>a().name),d(m,_),s(m,()=>g(a().balance)),s(re,()=>e(`accounts.types.${a().type.toLowerCase()}`)),le(Y=>d(re,{...A,background:f().bg,color:f().color},Y)),S})(),(()=>{var S=UC(),x=S.firstChild,m=x.nextSibling,re=m.firstChild,Y=re.nextSibling;return Y.nextSibling,d(S,E),x.$$click=()=>n("details"),s(x,()=>e("accounts.accountDetails")),m.$$click=()=>n("transactions"),s(m,()=>e("accounts.transactions"),re),s(m,()=>C().length,Y),le($=>{var V=R(r()==="details"),Q=R(r()==="transactions");return $.e=d(x,V,$.e),$.t=d(m,Q,$.t),$},{e:void 0,t:void 0}),S})(),ge(()=>ge(()=>r()==="details")()&&(()=>{var S=jC(),x=S.firstChild,m=x.firstChild,re=m.nextSibling,Y=x.nextSibling,$=Y.firstChild,V=$.nextSibling,Q=Y.nextSibling,L=Q.firstChild,D=L.nextSibling,j=Q.nextSibling,ue=j.firstChild,W=ue.nextSibling,ce=j.nextSibling,T=ce.firstChild,G=T.nextSibling,Z=ce.nextSibling,F=Z.firstChild,ne=F.nextSibling;return s(m,()=>e("accounts.accountNumber")),s(re,()=>a().accountNumber),s($,()=>e("accounts.category")),s(V,()=>a().category),s(L,()=>e("common.description")),s(D,()=>a().description),s(ue,()=>e("common.status")),s(W,(()=>{var H=ge(()=>!!a().isActive);return()=>H()?e("common.active"):e("common.inactive")})()),s(T,()=>e("accounts.createdDate")),s(G,()=>v(a().createdDate)),s(F,()=>e("accounts.lastModified")),s(ne,()=>v(a().lastModified)),le(H=>{var U=c,ae=u,se=h,pe=c,de=u,ye=h,X=c,ee=u,q=h,he=c,ve=u,B=h,te=c,_e=u,we=h,me=c,be=u,ie=h;return H.e=d(x,U,H.e),H.t=d(m,ae,H.t),H.a=d(re,se,H.a),H.o=d(Y,pe,H.o),H.i=d($,de,H.i),H.n=d(V,ye,H.n),H.s=d(Q,X,H.s),H.h=d(L,ee,H.h),H.r=d(D,q,H.r),H.d=d(j,he,H.d),H.l=d(ue,ve,H.l),H.u=d(W,B,H.u),H.c=d(ce,te,H.c),H.w=d(T,_e,H.w),H.m=d(G,we,H.m),H.f=d(Z,me,H.f),H.y=d(F,be,H.y),H.g=d(ne,ie,H.g),H},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),S})()),ge(()=>ge(()=>r()==="transactions")()&&(()=>{var S=El();return s(S,(()=>{var x=ge(()=>C().length===0);return()=>x()?(()=>{var m=El();return m.style.setProperty("text-align","center"),m.style.setProperty("color","var(--text-muted)"),m.style.setProperty("padding","2rem"),s(m,()=>e("common.noDataFound")),m})():C().map(m=>(()=>{var re=zC(),Y=re.firstChild,$=Y.firstChild,V=$.nextSibling,Q=V.firstChild,L=Y.nextSibling;return d(re,P),d(Y,k),d($,oe),s($,()=>m.description),d(V,K),s(V,()=>v(m.date),Q),s(V,()=>m.reference,null),s(L,()=>m.type==="debit"?"+":"-",null),s(L,()=>g(m.type==="debit"?m.debitAmount:m.creditAmount),null),le(D=>d(L,O(m.type),D)),re})())})()),S})()),(()=>{var S=El();return d(S,M),s(S,w(Le,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(S,w(Le,{variant:"primary",onClick:()=>i(!0),get children(){return e("accounts.editAccount")}}),null),S})()]})()),ge(()=>ge(()=>!!a())()&&w(VC,{get isOpen(){return o()},onClose:()=>{i(!1)},get account(){return a()}}))]}})};ft(["click"]);const GC="https://qvamarkets.com/gql_api",[HC,Kh]=fe(!1),[WC,Tl]=fe(null);class YC{baseUrl;constructor(e=GC){this.baseUrl=e}async request(e,r,n,o){Kh(!0),Tl(null);try{const i=r.startsWith("http")?r:`${this.baseUrl}${r}`,a={method:e,headers:{"Content-Type":"application/json",Accept:"application/json",...o}};n&&(e==="POST"||e==="PUT"||e==="PATCH")&&(a.body=JSON.stringify(n));const c=await fetch(i,a);if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);const u=await c.json();if(u.errors&&u.errors.length>0)throw new Error(u.errors[0].message);return u.data||u}catch(i){const a=i instanceof Error?i.message:"Unknown error occurred";throw Tl(a),i}finally{Kh(!1)}}async graphql(e){return this.request("POST","",e)}async get(e,r){return this.request("GET",e,void 0,r)}async post(e,r,n){return this.request("POST",e,r,n)}async put(e,r,n){return this.request("PUT",e,r,n)}async patch(e,r,n){return this.request("PATCH",e,r,n)}async delete(e,r){return this.request("DELETE",e,void 0,r)}getLoadingState(){return HC()}getErrorState(){return WC()}clearError(){Tl(null)}}const zs=new YC,kd=`
  fragment AccountFields on Account {
    id
    accountNumber
    name
    type
    category
    description
    balance
    isActive
    parentAccountId
    createdDate
    lastModified
  }
`,KC=`
  query GetAccountById($id: ID!) {
    account(id: $id) {
      ...AccountFields
    }
  }
  ${kd}
`,QC=`
  mutation CreateAccount($input: CreateAccountInput!) {
    createAccount(input: $input) {
      ...AccountFields
    }
  }
  ${kd}
`,JC=`
  mutation UpdateAccount($id: ID!, $input: UpdateAccountInput!) {
    updateAccount(id: $id, input: $input) {
      ...AccountFields
    }
  }
  ${kd}
`,XC=`
  mutation DeleteAccount($id: ID!) {
    deleteAccount(id: $id) {
      success
      message
    }
  }
`;class ZC{async getAccounts(e,r){try{if(ts.isFakeMode())return await yu.getAll(e);const n=await wn({query:"getAllYabaProducts",params:{businessId:"YB100423253156428"}});return console.log("Real API accounts response:",n),n?.accounts||[]}catch(n){if(console.error("Error fetching accounts:",n),ts.isHybridMode())return console.warn("Falling back to fake API for accounts"),await yu.getAll(e);throw n}}async getAccountById(e){try{return(await zs.graphql({query:KC,variables:{id:e}})).account}catch(r){throw console.error("Error fetching account:",r),r}}async createAccount(e){try{return(await zs.graphql({query:QC,variables:{input:e}})).createAccount}catch(r){throw console.error("Error creating account:",r),r}}async updateAccount(e,r){try{return(await zs.graphql({query:JC,variables:{id:e,input:r}})).updateAccount}catch(n){throw console.error("Error updating account:",n),n}}async deleteAccount(e){try{return(await zs.graphql({query:XC,variables:{id:e}})).deleteAccount}catch(r){throw console.error("Error deleting account:",r),r}}async getAccountsByType(e){return this.getAccounts({type:e})}async getAccountHierarchy(){const e=await this.getAccounts();return this.buildHierarchy(e)}buildHierarchy(e){const r=new Map,n=[];return e.forEach(o=>{r.set(o.id,{...o,subAccounts:[]})}),e.forEach(o=>{const i=r.get(o.id);if(o.parentAccountId){const a=r.get(o.parentAccountId);a&&(a.subAccounts=a.subAccounts||[],a.subAccounts.push(i))}else n.push(i)}),n}async getAccountBalance(e){const r=await this.getAccountById(e);return r?r.balance:0}async searchAccounts(e){return this.getAccounts({search:e})}}const eA=new ZC;var tA=z("<div><h2></h2><div><span>:</span><button></button><button>"),rA=z("<div><span>:"),Qh=z("<div>"),nA=z("<button>");const oA=()=>{const{t}=it(),[e,r]=fe(!1),[n,o]=fe(!1),[i,a]=fe(!1),[c,u]=fe(null),[h,y]=fe(null),[b,_]=fe("All"),[A,E]=fe("hierarchy"),R=v=>{u(v),a(!0)},P=v=>{y(v),o(!0)},k=()=>b()==="All"?A()==="hierarchy"?xt.getAccountHierarchy():xt.accounts:A()==="hierarchy"?xt.getAccountHierarchy().filter(v=>v.type===b()):xt.getAccountsByType(b()),K={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},oe={display:"flex",gap:"1rem","margin-bottom":"2rem","align-items":"center"},O=v=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:v?"var(--primary-color)":"var(--surface-color)",color:v?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500",transition:"all 0.2s ease"}),M={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},N={display:"flex",gap:"0.5rem","align-items":"center","margin-left":"auto","margin-right":"1rem"},g=v=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:v?"var(--primary-color)":"var(--surface-color)",color:v?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"});return w(Ur,{get title(){return t("accounts.title")},get children(){return[w(PC,{}),(()=>{var v=tA(),f=v.firstChild,C=f.nextSibling,S=C.firstChild,x=S.firstChild,m=S.nextSibling,re=m.nextSibling;return d(v,M),f.style.setProperty("margin","0"),f.style.setProperty("font-size","1.5rem"),s(f,()=>t("accounts.title")),d(C,N),S.style.setProperty("font-weight","500"),S.style.setProperty("color","var(--text-muted)"),S.style.setProperty("font-size","0.875rem"),s(S,()=>t("common.view"),x),m.$$click=()=>E("hierarchy"),s(m,()=>t("accounts.accountHierarchy")),re.$$click=()=>{E("flat"),eA.getAccounts()},s(re,()=>t("common.all")),s(v,w(Le,{variant:"primary",onClick:()=>r(!0),get children(){return t("accounts.addAccount")}}),null),le(Y=>{var $=g(A()==="hierarchy"),V=g(A()==="flat");return Y.e=d(m,$,Y.e),Y.t=d(re,V,Y.t),Y},{e:void 0,t:void 0}),v})(),(()=>{var v=rA(),f=v.firstChild,C=f.firstChild;return d(v,oe),f.style.setProperty("font-weight","500"),f.style.setProperty("color","var(--text-muted)"),s(f,()=>t("common.filter"),C),s(v,()=>[t("common.all"),t("accounts.types.asset"),t("accounts.types.liability"),t("accounts.types.equity"),t("accounts.types.revenue"),t("accounts.types.expense")].map((S,x)=>{const re=["All","Asset","Liability","Equity","Revenue","Expense"][x];return(()=>{var Y=nA();return Y.$$click=()=>_(re),s(Y,S),le($=>d(Y,O(b()===re),$)),Y})()}),null),v})(),(()=>{var v=Qh();return s(v,(()=>{var f=ge(()=>A()==="hierarchy");return()=>f()?k().map(C=>w(TC,{account:C,onAddSubAccount:P,onViewDetails:R})):k().map(C=>w(CC,{account:C,onViewDetails:R}))})()),le(f=>d(v,A()==="hierarchy"?{display:"flex","flex-direction":"column",gap:"1rem"}:K,f)),v})(),ge(()=>ge(()=>k().length===0)()&&(()=>{var v=Qh();return v.style.setProperty("text-align","center"),v.style.setProperty("color","var(--text-muted)"),v.style.setProperty("padding","3rem"),v.style.setProperty("font-size","1.1rem"),s(v,()=>t("common.noDataFound")),v})()),w(RC,{get isOpen(){return e()},onClose:()=>r(!1)}),w(LC,{get isOpen(){return n()},onClose:()=>o(!1),get parentAccount(){return h()}}),w(qC,{get isOpen(){return i()},onClose:()=>a(!1),get account(){return c()}})]}})};ft(["click"]);var iA=z("<div><h2>"),Go=z("<div>"),sA=z("<div><div><div></div><h1></h1><div></div></div><div>"),aA=z("<div><button></button><button> (<!>)"),qs=z("<div><span></span><span>"),lA=z("<p>"),cA=z("<div><div></div><div>"),dA=z("<div><div><div></div><div> • </div></div><div>");const uA=()=>{const{t}=it(),e=Ug(),r=Lc(),[n,o]=fe(null),[i,a]=fe("overview");Hr(()=>{const m=xt.getAccountById(e.id);m?o(m):r("/accounts")});const c={display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"1rem"},u={display:"flex","align-items":"center",gap:"1rem","margin-bottom":"2rem"},h={"font-size":"1rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},y={"font-size":"2.5rem","font-weight":"700",color:"var(--primary-color)"},b={padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},_={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},A=m=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:m?"var(--primary-color)":"var(--text-muted)","border-bottom":m?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),E={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},R={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},P={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},k={"font-weight":"500",color:"var(--text-muted)"},K={"font-weight":"600",color:"var(--text-primary)"},oe={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},O={flex:"1"},M={"font-weight":"500","margin-bottom":"0.25rem"},N={"font-size":"0.875rem",color:"var(--text-muted)"},g=m=>({"font-weight":"600",color:m==="debit"?"#4caf50":"#f44336"});if(!n())return w(Ur,{get title(){return t("accounts.accountDetails")},get children(){var m=iA(),re=m.firstChild;return m.style.setProperty("text-align","center"),m.style.setProperty("padding","3rem"),s(re,()=>t("common.error")),s(m,w(Le,{variant:"primary",onClick:()=>r("/accounts"),get children(){return[ge(()=>t("common.back"))," ",ge(()=>t("navigation.accounts"))]}}),null),m}});const v=m=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[m]||{bg:"#f5f5f5",color:"#666"},f=m=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(m),C=m=>new Date(m).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),S=v(n().type),x=xt.getAccountTransactions(n().id);return w(Ur,{get title(){return n().name},get children(){return[(()=>{var m=Go();return d(m,c),s(m,w(Le,{variant:"secondary",onClick:()=>r("/accounts"),get children(){return["← ",ge(()=>t("common.back"))," ",ge(()=>t("navigation.accounts"))]}})),m})(),(()=>{var m=sA(),re=m.firstChild,Y=re.firstChild,$=Y.nextSibling,V=$.nextSibling,Q=re.nextSibling;return d(m,u),d(Y,h),s(Y,()=>n().accountNumber),$.style.setProperty("margin","0.5rem 0"),$.style.setProperty("font-size","2rem"),s($,()=>n().name),d(V,y),s(V,()=>f(n().balance)),s(Q,()=>n().type),le(L=>d(Q,{...b,background:S.bg,color:S.color},L)),m})(),(()=>{var m=aA(),re=m.firstChild,Y=re.nextSibling,$=Y.firstChild,V=$.nextSibling;return V.nextSibling,d(m,_),re.$$click=()=>a("overview"),s(re,()=>t("dashboard.overview")),Y.$$click=()=>a("transactions"),s(Y,()=>t("accounts.transactions"),$),s(Y,()=>x.length,V),le(Q=>{var L=A(i()==="overview"),D=A(i()==="transactions");return Q.e=d(re,L,Q.e),Q.t=d(Y,D,Q.t),Q},{e:void 0,t:void 0}),m})(),ge(()=>ge(()=>i()==="overview")()&&(()=>{var m=cA(),re=m.firstChild,Y=re.nextSibling;return d(re,E),s(re,w(Ge,{get title(){return t("accounts.balance")},get subtitle(){return t("dashboard.overview")},get children(){var $=Go();return $.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","600"),$.style.setProperty("color","var(--primary-color)"),s($,()=>f(n().balance)),$}}),null),s(re,w(Ge,{get title(){return t("accounts.accountType")},get subtitle(){return t("accounts.category")},get children(){var $=Go();return $.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","600"),$.style.setProperty("color","var(--primary-color)"),s($,()=>t(`accounts.types.${n().type.toLowerCase()}`)),$}}),null),s(re,w(Ge,{get title(){return t("common.status")},get subtitle(){return t("accounts.accountDetails")},get children(){var $=Go();return $.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","600"),s($,(()=>{var V=ge(()=>!!n().isActive);return()=>V()?t("common.active"):t("common.inactive")})()),le(V=>(V=n().isActive?"#4caf50":"#f44336")!=null?$.style.setProperty("color",V):$.style.removeProperty("color")),$}}),null),s(re,w(Ge,{get title(){return t("accounts.transactions")},get subtitle(){return t("common.total")},get children(){var $=Go();return $.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","600"),$.style.setProperty("color","var(--primary-color)"),s($,()=>x.length),$}}),null),d(Y,R),s(Y,w(Ge,{get title(){return t("accounts.accountDetails")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var $=qs(),V=$.firstChild,Q=V.nextSibling;return s(V,()=>t("accounts.accountNumber")),s(Q,()=>n().accountNumber),le(L=>{var D=P,j=k,ue=K;return L.e=d($,D,L.e),L.t=d(V,j,L.t),L.a=d(Q,ue,L.a),L},{e:void 0,t:void 0,a:void 0}),$})(),(()=>{var $=qs(),V=$.firstChild,Q=V.nextSibling;return s(V,()=>t("accounts.category")),s(Q,()=>n().category),le(L=>{var D=P,j=k,ue=K;return L.e=d($,D,L.e),L.t=d(V,j,L.t),L.a=d(Q,ue,L.a),L},{e:void 0,t:void 0,a:void 0}),$})(),(()=>{var $=qs(),V=$.firstChild,Q=V.nextSibling;return s(V,()=>t("common.date")),s(Q,()=>C(n().createdDate)),le(L=>{var D=P,j=k,ue=K;return L.e=d($,D,L.e),L.t=d(V,j,L.t),L.a=d(Q,ue,L.a),L},{e:void 0,t:void 0,a:void 0}),$})(),(()=>{var $=qs(),V=$.firstChild,Q=V.nextSibling;return s(V,()=>t("common.date")),s(Q,()=>C(n().lastModified)),le(L=>{var D=P,j=k,ue=K;return L.e=d($,D,L.e),L.t=d(V,j,L.t),L.a=d(Q,ue,L.a),L},{e:void 0,t:void 0,a:void 0}),$})()]}}),null),s(Y,w(Ge,{get title(){return t("common.description")},get subtitle(){return t("accounts.accountDetails")},get children(){var $=lA();return $.style.setProperty("margin","0"),$.style.setProperty("color","var(--text-secondary)"),s($,()=>n().description||t("common.noDataFound")),$}}),null),m})()),ge(()=>ge(()=>i()==="transactions")()&&w(Ge,{get title(){return t("accounts.accountHistory")},get subtitle(){return t("accounts.transactions")},get children(){return ge(()=>x.length===0)()?(()=>{var m=Go();return m.style.setProperty("text-align","center"),m.style.setProperty("color","var(--text-muted)"),m.style.setProperty("padding","2rem"),s(m,()=>t("common.noDataFound")),m})():x.map(m=>(()=>{var re=dA(),Y=re.firstChild,$=Y.firstChild,V=$.nextSibling,Q=V.firstChild,L=Y.nextSibling;return d(re,oe),d(Y,O),d($,M),s($,()=>m.description),d(V,N),s(V,()=>C(m.date),Q),s(V,()=>m.reference,null),s(L,()=>m.type==="debit"?"+":"-",null),s(L,()=>f(m.type==="debit"?m.debitAmount:m.creditAmount),null),le(D=>d(L,g(m.type),D)),re})())}}))]}})};ft(["click"]);var hA=z("<div><div><h1></h1><p> </p></div><div><input type=date>"),_n=z("<div><span></span><span>"),mA=z("<div><div></div><div>"),yA=z("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),pA=z("<div><div> (<!> = <!> + <!>)</div><div> = "),fA=z("<span>(<!>: <!>)");const gA=()=>{const{t}=it(),[e,r]=fe(new Date().toISOString().split("T")[0]),[n,o]=fe(0),[i,a]=fe(0),[c,u]=fe(0);Hr(()=>{h()});const h=()=>{const E=xt.getAccountsByType("Asset"),R=xt.getAccountsByType("Liability"),P=xt.getAccountsByType("Equity"),k=E.reduce((O,M)=>O+M.balance,0),K=R.reduce((O,M)=>O+M.balance,0),oe=P.reduce((O,M)=>O+M.balance,0);o(k),a(K),u(oe)},y=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E),b={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},_={"margin-bottom":"2rem"},A={"font-weight":"bold","font-size":"1.1rem","border-top":"2px solid var(--border-color)","padding-top":"0.5rem","margin-top":"1rem"};return w(Ur,{get title(){return t("balanceSheet.title")},get children(){return[(()=>{var E=hA(),R=E.firstChild,P=R.firstChild,k=P.nextSibling,K=k.firstChild,oe=R.nextSibling,O=oe.firstChild;return d(E,b),P.style.setProperty("margin","0"),s(P,()=>t("balanceSheet.title")),k.style.setProperty("margin","0.5rem 0 0 0"),k.style.setProperty("color","var(--text-muted)"),s(k,()=>t("balanceSheet.asOf"),K),s(k,()=>new Date(e()).toLocaleDateString(),null),oe.style.setProperty("display","flex"),oe.style.setProperty("gap","1rem"),O.addEventListener("change",M=>r(M.target.value)),O.style.setProperty("padding","0.5rem"),O.style.setProperty("border","1px solid var(--border-color)"),O.style.setProperty("border-radius","var(--border-radius-sm)"),s(oe,w(Le,{variant:"primary",onClick:h,get children(){return t("balanceSheet.generateReport")}}),null),le(()=>O.value=e()),E})(),(()=>{var E=mA(),R=E.firstChild,P=R.nextSibling;return E.style.setProperty("display","grid"),E.style.setProperty("grid-template-columns","1fr 1fr"),E.style.setProperty("gap","2rem"),s(R,w(Ge,{get title(){return t("balanceSheet.assets")},style:_,get children(){return[(()=>{var k=_n(),K=k.firstChild,oe=K.nextSibling;return k.style.setProperty("display","flex"),k.style.setProperty("justify-content","space-between"),k.style.setProperty("align-items","center"),s(K,()=>t("balanceSheet.currentAssets")),s(oe,()=>y(n()*.6)),k})(),(()=>{var k=_n(),K=k.firstChild,oe=K.nextSibling;return k.style.setProperty("display","flex"),k.style.setProperty("justify-content","space-between"),k.style.setProperty("align-items","center"),s(K,()=>t("balanceSheet.nonCurrentAssets")),s(oe,()=>y(n()*.4)),k})(),(()=>{var k=_n(),K=k.firstChild,oe=K.nextSibling;return s(K,()=>t("balanceSheet.totalAssets")),s(oe,()=>y(n())),le(O=>d(k,{...A,display:"flex","justify-content":"space-between"},O)),k})()]}})),s(P,w(Ge,{get title(){return t("balanceSheet.liabilities")},style:_,get children(){return[(()=>{var k=_n(),K=k.firstChild,oe=K.nextSibling;return k.style.setProperty("display","flex"),k.style.setProperty("justify-content","space-between"),k.style.setProperty("align-items","center"),s(K,()=>t("balanceSheet.currentLiabilities")),s(oe,()=>y(i()*.7)),k})(),(()=>{var k=_n(),K=k.firstChild,oe=K.nextSibling;return k.style.setProperty("display","flex"),k.style.setProperty("justify-content","space-between"),k.style.setProperty("align-items","center"),s(K,()=>t("balanceSheet.nonCurrentLiabilities")),s(oe,()=>y(i()*.3)),k})(),(()=>{var k=_n(),K=k.firstChild,oe=K.nextSibling;return s(K,()=>t("balanceSheet.totalLiabilities")),s(oe,()=>y(i())),le(O=>d(k,{...A,display:"flex","justify-content":"space-between"},O)),k})()]}}),null),s(P,w(Ge,{get title(){return t("balanceSheet.equity")},get children(){return[(()=>{var k=_n(),K=k.firstChild,oe=K.nextSibling;return k.style.setProperty("display","flex"),k.style.setProperty("justify-content","space-between"),k.style.setProperty("align-items","center"),s(K,()=>t("balanceSheet.commonStock")),s(oe,()=>y(c()*.8)),k})(),(()=>{var k=_n(),K=k.firstChild,oe=K.nextSibling;return k.style.setProperty("display","flex"),k.style.setProperty("justify-content","space-between"),k.style.setProperty("align-items","center"),s(K,()=>t("balanceSheet.retainedEarnings")),s(oe,()=>y(c()*.2)),k})(),(()=>{var k=_n(),K=k.firstChild,oe=K.nextSibling;return s(K,()=>t("balanceSheet.totalEquity")),s(oe,()=>y(c())),le(O=>d(k,{...A,display:"flex","justify-content":"space-between"},O)),k})()]}}),null),E})(),w(Ge,{get title(){return t("dashboard.overview")},style:{"margin-top":"2rem"},get children(){return[(()=>{var E=yA(),R=E.firstChild,P=R.firstChild,k=P.nextSibling,K=R.nextSibling,oe=K.firstChild,O=oe.nextSibling,M=K.nextSibling,N=M.firstChild,g=N.nextSibling;return E.style.setProperty("display","grid"),E.style.setProperty("grid-template-columns","repeat(3, 1fr)"),E.style.setProperty("gap","2rem"),R.style.setProperty("text-align","center"),P.style.setProperty("font-size","0.875rem"),P.style.setProperty("color","var(--text-muted)"),P.style.setProperty("margin-bottom","0.5rem"),s(P,()=>t("balanceSheet.totalAssets")),k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","bold"),k.style.setProperty("color","var(--primary-color)"),s(k,()=>y(n())),K.style.setProperty("text-align","center"),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),oe.style.setProperty("margin-bottom","0.5rem"),s(oe,()=>t("balanceSheet.totalLiabilities")),O.style.setProperty("font-size","1.5rem"),O.style.setProperty("font-weight","bold"),O.style.setProperty("color","#f44336"),s(O,()=>y(i())),M.style.setProperty("text-align","center"),N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),N.style.setProperty("margin-bottom","0.5rem"),s(N,()=>t("balanceSheet.totalEquity")),g.style.setProperty("font-size","1.5rem"),g.style.setProperty("font-weight","bold"),g.style.setProperty("color","#4caf50"),s(g,()=>y(c())),E})(),(()=>{var E=pA(),R=E.firstChild,P=R.firstChild,k=P.nextSibling,K=k.nextSibling,oe=K.nextSibling,O=oe.nextSibling,M=O.nextSibling;M.nextSibling;var N=R.nextSibling,g=N.firstChild;return E.style.setProperty("margin-top","2rem"),E.style.setProperty("text-align","center"),R.style.setProperty("font-size","0.875rem"),R.style.setProperty("color","var(--text-muted)"),R.style.setProperty("margin-bottom","0.5rem"),s(R,()=>t("common.total"),P),s(R,()=>t("balanceSheet.totalAssets"),k),s(R,()=>t("balanceSheet.totalLiabilities"),oe),s(R,()=>t("balanceSheet.totalEquity"),M),N.style.setProperty("font-size","1.2rem"),N.style.setProperty("font-weight","bold"),s(N,()=>y(n()),g),s(N,()=>y(i()+c()),null),s(N,(()=>{var v=ge(()=>Math.abs(n()-(i()+c()))>.01);return()=>v()&&(()=>{var f=fA(),C=f.firstChild,S=C.nextSibling,x=S.nextSibling,m=x.nextSibling;return m.nextSibling,f.style.setProperty("font-size","0.875rem"),f.style.setProperty("color","#f44336"),f.style.setProperty("display","block"),s(f,()=>t("common.error"),S),s(f,()=>y(n()-(i()+c())),m),f})()})(),null),le(v=>(v=Math.abs(n()-(i()+c()))<.01?"#4caf50":"#f44336")!=null?N.style.setProperty("color",v):N.style.removeProperty("color")),E})()]}})]}})};ft(["click"]);const vA="modulepreload",bA=function(t){return"/"+t},Jh={},Zo=function(e,r,n){let o=Promise.resolve();if(r&&r.length>0){let a=function(h){return Promise.all(h.map(y=>Promise.resolve(y).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),u=c?.nonce||c?.getAttribute("nonce");o=a(r.map(h=>{if(h=bA(h),h in Jh)return;Jh[h]=!0;const y=h.endsWith(".css"),b=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${b}`))return;const _=document.createElement("link");if(_.rel=y?"stylesheet":vA,y||(_.as="script"),_.crossOrigin="",_.href=h,u&&_.setAttribute("nonce",u),document.head.appendChild(_),y)return new Promise((A,E)=>{_.addEventListener("load",A),_.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${h}`)))})}))}function i(a){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=a,window.dispatchEvent(c),!c.defaultPrevented)throw a}return o.then(a=>{for(const c of a||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})},_A=[{id:"YY_8802",code:"YY_8802",name:"CENTER",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8803",code:"YY_8803",name:"BISSONNET",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8804",code:"YY_8804",name:"IRVIN",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8805",code:"YY_8805",name:"KATTY",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8816",code:"YY_8816",type:"store",name:"YABA GLOBAL",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8818",code:"YY_8818",type:"store",name:"YABASURAUSTIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8847",code:"YY_8847",type:"store",name:"YABAOFICINA AZ",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_3251",code:"YY_3251",type:"store",name:"YABA FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_32",code:"YY_32",type:"store",name:"YABA MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_76",code:"YY_76",type:"store",name:"YABA DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_79",code:"YY_79",type:"warehouse",name:"ALMACEN DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8635",code:"YY_8635",type:"store",name:"FASHION MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8665",code:"YY_8665",name:"IRVIN FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,type:"store",createdDate:"2024-01-01"},{id:"YY_8901",code:"YY_8901",name:"ALMACEN CENTRAL YABA",bussinesId:"YB100423253156428",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01"}],PA=[{id:"1",name:'MacBook Pro 16"',price:2399,quantity:75,category:"Electronics",description:"Apple MacBook Pro 16-inch with M2 Pro chip",sku:"MBP-16-M2P",supplier:"Apple Inc.",minStock:10,location:"Warehouse A",lastUpdated:"2024-01-15"},{id:"2",name:'Dell Monitor 27"',price:299,quantity:35,category:"Electronics",description:"Dell 27-inch 4K UHD Monitor",sku:"DELL-MON-27-4K",supplier:"Dell Technologies",minStock:15,location:"Warehouse B",lastUpdated:"2024-01-14"},{id:"3",name:"Wireless Mouse",price:49.99,quantity:12,category:"Accessories",description:"Ergonomic wireless mouse with precision tracking",sku:"MOUSE-WL-001",supplier:"Logitech",minStock:25,location:"Warehouse A",lastUpdated:"2024-01-13"}],Gs=()=>{const t=new Map;return Dr().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=De.getLocationById(e.locationId),o=t.get(r);o||(o={id:r,productId:e.productId,locationId:e.locationId,locationName:n?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,o)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(o.quantity+=e.quantity*1):e.movementType==="out"?o.quantity-=e.quantity*1:e.movementType==="adjustment"&&(o.quantity=e.quantity*1),new Date(e.createdDate)>new Date(o.lastMovementDate)&&(o.lastMovementDate=e.createdDate,o.lastMovementType=e.movementType),o.averageCost=e.unitCost*1,o.availableQuantity=o.quantity*1-o.reservedQuantity*1}),Array.from(t.values())},[go,kl]=fe([]),[vo,Xh]=fe(_A),[Dr,Hs]=fe([]),[qn,zi]=fe([]),SA=()=>{const t=new Map;return Dr().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=t.get(r),o=De.getLocationById(e.locationId);n||(n={id:r,productId:e.productId,locationId:e.locationId,locationName:o?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(n.quantity+=e.quantity*1):e.movementType==="out"?n.quantity-=e.quantity*1:e.movementType==="adjustment"&&(n.quantity=e.quantity*1),new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost*1,n.availableQuantity=n.quantity*1-n.reservedQuantity*1}),Array.from(t.values())};zi(SA());const[Ws,Rl]=fe(PA),wA={TRANSFER:1,transfer:1},Zh=173442384e4,De={get products(){return go()},get locations(){return vo()},get movements(){return Dr()},get stockLevels(){return qn()},parseInventoryData:t=>{const e=Object.keys(t).slice(0,900),r=[],n=o=>{let i=t;i[o]?.products&&i[o]?.products?.map(a=>{let c=dv(i[o]?.type),u=a?.price*1||a?.unitCost*1,h=a?.qty*1||a?.quantity*1;u=isNaN(u)?0:u,h=isNaN(h)?0:h;let y={id:i[o]?.ssg_inventory_key,productId:a?.product?.id,productName:a?.product?.label,productSku:a?.product?.code,locationId:i[o]?.store,locationName:i[o]?.store,location:i[o]?.store,movementType:c,quantity:h,unitCost:u,totalCost:u*1*h,minStock:10,referenceNumber:"PO-001",notes:i[o]?.description||i[o]?.notes,createdBy:"admin",createdDate:i[o]?.createDate?new Date(i[o]?.createDate).toISOString():new Date(Zh).toISOString(),invoiceId:i[o]?.invoice};if(r.push(y),wA[i[o].movementType]&&i[o]?.fromLocationId){let b=De.getLocationById(i[o]?.fromLocationId);const _={id:i[o]?.ssg_inventory_key,productId:a?.product?.id,productName:a?.product?.label,productSku:a?.product?.code,locationId:i[o]?.fromLocationId,locationName:b?.name||"",movementType:"out",quantity:h*-1,unitCost:u,totalCost:u*-1*h,minStock:10,referenceNumber:i[o]?.referenceNumber,notes:`Transfer to ${i[o]?.locationName}`+(i[o].notes?` - ${i[o].notes}`:""),createdBy:i[o].createdBy,createdDate:i[o]?.createDate?new Date(i[o]?.createDate).toISOString():new Date(Zh).toISOString(),invoiceId:i[o]?.invoiceId,toLocationId:i[o]?.locationId,toLocationName:i[o]?.locationName};r.push(_)}})};return e.map(n),r},fecthInventory:async t=>{const e=await ln.getInventory(t),r=De.parseInventoryData(e);De.updMovements(r)},fecthProduct:async t=>{const e=await ln.getProducts(t),r=Object.keys(e),n=i=>{let a=e;return{id:i,name:a[i].name,businessId:a[i].businessId,sku:a[i].code,UPC:a[i].UPC,numCode:a[i].codeN,category:a[i].category,unitCost:a[i].unitCost||0,unitOfMeasure:a[i].unitOfMeasure||a[i].unit,minStockLevel:a[i].minStockLevel,maxStockLevel:a[i].maxStockLevel,isActive:a[i].isActive,productImageUrl:a[i].productImageUrl,description:a[i].description||"",createdDate:a[i].createdAt||new Date().toISOString(),lastModified:a[i].updatedAt||new Date().toISOString()}},o=r.map(n);return De.updProduct(o),o},getProductById:t=>go().find(e=>e.id===t),updProduct:t=>{kl(t)},getProductsBySku:t=>go().filter(e=>e.sku.toLowerCase().includes(t.toLowerCase())),getProductsByCategory:t=>go().filter(e=>e.category===t),getActiveProducts:()=>go().filter(t=>t.name),getLocationById:t=>vo().find(e=>e.id===t),getLocationsByType:t=>vo().filter(e=>e.type===t),getActiveLocations:()=>{let t=wt?.state?.profile?.stores;return vo().filter(e=>t?.[e?.id])},getMovementsByProduct:t=>Dr().filter(e=>e.productId===t),updMovements:t=>{Hs([...t]),zi(Gs())},getMovementsByLocation:t=>Dr().filter(e=>e.locationId===t),getMovementsByDateRange:(t,e)=>Dr().filter(r=>r.createdDate>=t&&r.createdDate<=e),getStockByProduct:t=>qn().filter(e=>e.productId===t),getStockByLocation:t=>qn().filter(e=>e.locationId===t),getStockByProductAndLocation:(t,e)=>qn().find(r=>r.productId===t&&r.locationId===e),getTotalStockByProduct:t=>qn().filter(e=>e.productId===t).reduce((e,r)=>e*1+r.quantity*1,0),getLastLocationByProduct:t=>{const e=Dr().filter(r=>r.productId===t).sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime());if(e.length>0)return vo().find(r=>r.id===e[0].locationId)},getLowStockProducts:()=>(go()||[])?.map(t=>{const e=qn().filter(r=>r.productId===t.id).reduce((r,n)=>r+n.quantity,0);return{...t,currentStock:e}}).filter(t=>t.currentStock<=t.minStockLevel),generateMovementInvoice:async(t,e,r,n="compact")=>{try{const{getUserLanguage:o}=await Zo(async()=>{const{getUserLanguage:y}=await import("./languageUtils-BVmHbHaj.js");return{getUserLanguage:y}},[]),i=r||o();let a;switch(n){case"compact":const{generateCompactModernInvoicePDF:y}=await Zo(async()=>{const{generateCompactModernInvoicePDF:A}=await import("./compactModernInvoicePdfGenerator-CgdAH4CA.js");return{generateCompactModernInvoicePDF:A}},[]);a=y;break;case"modern":const{generateModernMovementInvoicePDF:b}=await Zo(async()=>{const{generateModernMovementInvoicePDF:A}=await import("./modernMovementInvoicePdfGenerator-D57bpWVk.js");return{generateModernMovementInvoicePDF:A}},[]);a=b;break;case"classic":default:const{generateMovementInvoicePDF:_}=await Zo(async()=>{const{generateMovementInvoicePDF:A}=await import("./movementInvoicePdfGenerator-C1xj9j4N.js");return{generateMovementInvoicePDF:A}},[]);a=_;break}const c=Dr().filter(y=>y.invoiceId===t||y.id===t);if(c.length===0)throw new Error(`No movements found with ID: ${t}`);const u=c.reduce((y,b)=>{const _=b.invoiceId||b.id;return y[_]||(y[_]={invoiceId:_,movementType:b.movementType,referenceNumber:b.referenceNumber,createdBy:b.createdBy,createdDate:b.createdDate,locationName:b.locationName,fromLocationName:b.fromLocationName,toLocationName:b.toLocationName,notes:b.notes,items:[]}),y[_].items.push({productSku:b.productSku,productName:b.productName,quantity:b.quantity,unitCost:b.unitCost,totalCost:b.totalCost,receivedQuantity:b.movementType==="transfer"?null:void 0}),y},{}),h=[];for(const[y,b]of Object.entries(u)){const _=await a(b,e,i);h.push(_)}return h}catch(o){throw console.error("Error generating movement invoice:",o),o}},getMovementsByInvoiceId:t=>Dr().filter(e=>e.invoiceId===t),generateCompactMovementInvoice:async(t,e,r)=>De.generateMovementInvoice(t,e,r,"compact"),generateModernMovementInvoice:async(t,e,r)=>De.generateMovementInvoice(t,e,r,"modern"),generateClassicMovementInvoice:async(t,e,r)=>De.generateMovementInvoice(t,e,r,"classic"),getMovementInvoiceData:t=>{const e=Dr().filter(o=>o.invoiceId===t||o.id===t);if(e.length===0)return null;const r=e[0],n=e.reduce((o,i)=>o+(i.totalCost||i.quantity*i.unitCost),0);return{invoiceId:r.invoiceId||r.id,movementType:r.movementType,referenceNumber:r.referenceNumber,createdBy:r.createdBy,createdDate:r.createdDate,locationName:r.locationName,fromLocationName:r.fromLocationName,toLocationName:r.toLocationName,notes:r.notes,totalValue:n,itemCount:e.length,items:e.map(o=>({productSku:o.productSku,productName:o.productName,quantity:o.quantity,unitCost:o.unitCost,totalCost:o.totalCost||o.quantity*o.unitCost}))}},addInventoryMovement:t=>{const e={...t,id:`mov-${Date.now()}`,createdDate:new Date().toISOString()};Hs(r=>[...r,e]),zi(Gs())},addBulkInventoryMovements:async t=>{const e=[],r=[],n=new Date().toISOString(),o=vo().find(c=>c.id===t.locationId);if(!o)return{success:!1,errors:["Invalid location"]};let i;if(t.movementType==="transfer"){if(!t.fromLocationId)return{success:!1,errors:["From location required for transfers"]};if(i=vo().find(c=>c.id===t.fromLocationId),!i)return{success:!1,errors:["Invalid from location"]};if(t.fromLocationId===t.locationId)return{success:!1,errors:["From and to locations cannot be the same"]}}if(t.items.forEach((c,u)=>{const h=go().find(A=>A.id===c.productId);if(!h){e.push(`Item ${u+1}: Product not found`);return}if(c.quantity<=0){e.push(`Item ${u+1}: Quantity must be greater than 0`);return}if(t.movementType==="out"){const A=qn().filter(E=>E.productId===c.productId&&E.locationId===t.locationId).reduce((E,R)=>E+R.quantity,0);if(c.quantity>A){e.push(`Item ${u+1}: Insufficient stock. Available: ${A}, Requested: ${c.quantity}`);return}}if(t.movementType==="transfer"){const A=qn().filter(E=>E.productId===c.productId&&E.locationId===t.fromLocationId).reduce((E,R)=>E+R.quantity,0);if(c.quantity>A){e.push(`Item ${u+1}: Insufficient stock at ${i?.name}. Available: ${A}, Requested: ${c.quantity}`);return}}const y=c.unitCost||h.unitCost,b=c.quantity*y,_={id:`mov-${Date.now()}-${u}`,productId:h.id,productName:h.name,productSku:h.sku,locationId:t.locationId,locationName:o.name,movementType:t.movementType,quantity:c.quantity,unitCost:y,totalCost:b,minStock:10,referenceNumber:t.referenceNumber||"",notes:c.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:i?.name};if(r.push(_),t.movementType==="transfer"&&i){const A={id:`mov-${Date.now()}-${u}-out`,productId:h.id,productName:h.name,productSku:h.sku,locationId:t.fromLocationId,locationName:i.name,movementType:"out",quantity:c.quantity,unitCost:y,totalCost:b,minStock:10,referenceNumber:t.referenceNumber||"",notes:`Transfer to ${o.name}`+(c.notes?` - ${c.notes}`:""),createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,toLocationId:t.locationId,toLocationName:o.name};r.push(A)}}),e.length>0)return{success:!1,errors:e};Hs(c=>[...c,...r]),zi(Gs()),console.log({bulkRequest:t});const a=await ln.addInventory(t);return console.log({prodResults:a}),{success:!0,errors:[]}},getMovementsByInvoice:t=>Dr().filter(e=>e.invoiceId===t),getInvoiceSummary:t=>{const e=Dr().filter(i=>i.invoiceId===t);if(e.length===0)return null;const r=e.reduce((i,a)=>i+a.totalCost,0),n=new Set(e.map(i=>i.productId)).size,o=e[0];return{invoiceId:t,referenceNumber:o.referenceNumber,movementType:o.movementType,location:o.locationName,fromLocation:o.fromLocationName,productCount:n,totalItems:e.reduce((i,a)=>i+a.quantity,0),totalValue:r,createdDate:o.createdDate,createdBy:o.createdBy}},addProduct:t=>{const e={...t,id:`prod-${Date.now()}`,createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};kl(r=>[...r,e])},addLocation:t=>{const e={...t,id:`loc-${Date.now()}`,createdDate:new Date().toISOString()};Xh(r=>[...r,e])},updateProduct:(t,e)=>{kl(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n))},updateLocation:(t,e)=>{Xh(r=>r.map(n=>n.id===t?{...n,...e}:n))},updateMovement:(t,e)=>{Hs(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n)),zi(Gs())},get inventory(){return Ws()},addItem(t){const e={...t,id:Date.now().toString(),lastUpdated:new Date().toISOString().split("T")[0]};return Rl([...Ws(),e]),e},updateItem(t,e){Rl(Ws().map(r=>r.id===t?{...r,...e,lastUpdated:new Date().toISOString().split("T")[0]}:r))},deleteItem(t){Rl(Ws().filter(e=>e.id!==t))},getItemById(t){return Dr().find(e=>e.id===t)},getLowStockItems(){return Dr().filter(t=>t.quantity*1<=t.minStock*1)},getTotalValue(){return Dr().reduce((t,e)=>t*1+e.unitCost*1*e.quantity*1,0)}};var em=z("<div>"),CA=z("<div><div><input type=text autocomplete=off>"),AA=z("<button type=button>+"),xA=z("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>");const Rd=t=>{const{t:e}=it(),[r,n]=fe(!1),[o,i]=fe(""),[a,c]=fe(-1),u=ze(()=>t.value?De.getProductById(t.value):null),h=ze(()=>{const Y=o().toLowerCase();return Y?De.getActiveProducts().filter($=>$.name.toLowerCase().includes(Y)||$.sku.toLowerCase().includes(Y)||$?.UPC?.toLowerCase().includes(Y)||$.category.toLowerCase().includes(Y)):De.getActiveProducts()}),y=()=>{n(!0),i(""),c(-1)},b=Y=>{const $=Y.target;i($.value),n(!0),c(-1)},_=Y=>{t.onChange(Y),n(!1),i(""),c(-1)},A=Y=>{const $=h();switch(Y.key){case"ArrowDown":Y.preventDefault(),c(V=>Math.min(V+1,$.length-1));break;case"ArrowUp":Y.preventDefault(),c(V=>Math.max(V-1,-1));break;case"Enter":Y.preventDefault(),a()>=0&&$[a()]&&_($[a()]);break;case"Escape":n(!1),i(""),c(-1);break}},E=Y=>{setTimeout(()=>{n(!1),i(""),c(-1)},150)},R=Y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Y),P=Y=>De.stockLevels.filter($=>$.productId===Y).reduce(($,V)=>$+V.quantity,0),k={position:"relative",width:"100%",...t.style},K={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},oe={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},O=Y=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid "+Y?"var(--primary-color)":"var(--border-color)",background:Y?"var(--strip-color)":"transparent",color:Y?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),M={display:"flex","justify-content":"space-between","align-items":"center"},N={flex:"1"},g={"font-weight":"500","margin-bottom":"0.25rem"},v={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},f={"text-align":"right","font-size":"0.875rem"},C={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},S=()=>r()&&o()?o():u()?`${u().name} (${u().sku})`:"",x={display:"flex","align-items":"stretch",width:"100%"},m={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},re={...K,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"};return(()=>{var Y=CA(),$=Y.firstChild,V=$.firstChild;return d($,x),V.addEventListener("blur",E),V.$$keydown=A,V.$$click=y,V.$$input=b,s($,(()=>{var Q=ge(()=>!!t.onAddNew);return()=>Q()&&(()=>{var L=AA();return L.addEventListener("mouseleave",D=>{D.currentTarget.style.background="var(--surface-color)",D.currentTarget.style.color="var(--primary-color)"}),L.addEventListener("mouseenter",D=>{D.currentTarget.style.background="var(--primary-color)",D.currentTarget.style.color="white"}),Ln(L,"click",t.onAddNew,!0),d(L,m),le(()=>ct(L,"title",e("inventory.addProduct","Add new product"))),L})()})(),null),s(Y,w(Re,{get when(){return r()},get children(){var Q=em();return s(Q,w(Re,{get when(){return h().length>0},get fallback(){return(()=>{var L=em();return d(L,C),s(L,(()=>{var D=ge(()=>!!o());return()=>D()?e("inventory.noProductsFound","No products found matching your search."):e("inventory.noProductsAvailable","No products available.")})()),L})()},get children(){return w(nt,{get each(){return h()},children:(L,D)=>{const j=P(L.id),ue=j<=L.minStockLevel;return(()=>{var W=xA(),ce=W.firstChild,T=ce.firstChild,G=T.firstChild,Z=G.nextSibling,F=Z.firstChild,ne=F.firstChild,H=F.nextSibling,U=H.nextSibling,ae=U.nextSibling,se=ae.nextSibling,pe=T.nextSibling,de=pe.firstChild,ye=de.firstChild,X=de.nextSibling;return W.addEventListener("mouseenter",()=>c(D())),W.$$click=()=>_(L),d(ce,M),d(T,N),d(G,g),s(G,()=>L.name),d(Z,v),s(F,()=>e("inventory.sku","SKU"),ne),s(F,()=>L.sku,null),s(U,()=>L.category),s(se,()=>R(L.unitCost)),d(pe,f),de.style.setProperty("font-weight","600"),(ue?"#f44336":"var(--text-primary)")!=null?de.style.setProperty("color",ue?"#f44336":"var(--text-primary)"):de.style.removeProperty("color"),s(de,j,ye),s(de,()=>L.unitOfMeasure,null),X.style.setProperty("color","var(--text-muted)"),s(X,()=>ue?e("inventory.lowStock","Low Stock"):e("inventory.inStock","In Stock")),le(ee=>d(W,O(D()===a()),ee)),W})()}})}})),le(L=>d(Q,oe,L)),Q}}),null),le(Q=>{var L=k,D=re,j=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),ue=t.disabled,W=t.required;return Q.e=d(Y,L,Q.e),Q.t=d(V,D,Q.t),j!==Q.a&&ct(V,"placeholder",Q.a=j),ue!==Q.o&&(V.disabled=Q.o=ue),W!==Q.i&&(V.required=Q.i=W),Q},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),le(()=>V.value=S()),Y})()};ft(["input","click","keydown"]);var tm=z("<div>"),IA=z("<div><div><input type=text autocomplete=off>"),$A=z("<button type=button>+"),EA=z("<div><div><div><div> </div><div><span>: </span><span></span></div><div>");const Va=t=>{const{t:e}=it(),[r,n]=fe(!1),[o,i]=fe(""),[a,c]=fe(-1),u=ze(()=>t.value?De.getLocationById(t.value):null),h=ze(()=>{let Y=De.getActiveLocations();t.filterType&&(Y=Y.filter(V=>V.type===t.filterType));const $=o().toLowerCase();return $?Y.filter(V=>V.name.toLowerCase().includes($)||V?.code?.toLowerCase().includes($)||V?.type?.toLowerCase().includes($)||V?.address?.toLowerCase().includes($)):Y}),y=()=>{n(!0),i(""),c(-1)},b=Y=>{const $=Y.target;i($.value),n(!0),c(-1)},_=Y=>{t.onChange(Y.id),n(!1),i(""),c(-1)},A=Y=>{const $=h();switch(Y.key){case"ArrowDown":Y.preventDefault(),c(V=>Math.min(V+1,$.length-1));break;case"ArrowUp":Y.preventDefault(),c(V=>Math.max(V-1,-1));break;case"Enter":Y.preventDefault(),a()>=0&&$[a()]&&_($[a()]);break;case"Escape":n(!1),i(""),c(-1);break}},E=Y=>{setTimeout(()=>{n(!1),i(""),c(-1)},150)},R=Y=>({warehouse:"🏭",store:"🏪",supplier:"🚚",customer:"👥"})[Y]||"📍",P=Y=>({warehouse:"#2196F3",store:"#4CAF50",supplier:"#FF9800",customer:"#9C27B0"})[Y]||"#757575",k={position:"relative",width:"100%",...t.style},K={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},oe={display:"flex","align-items":"stretch",width:"100%"},O={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},M={...K,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},N={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},g=Y=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:Y?"var(--strip-color)":"transparent",color:Y?"var(--primary-dark)":"var(--text-primary)",transition:"all 0.2s ease"}),v={display:"flex","justify-content":"space-between","align-items":"center"},f={flex:"1"},C={"font-weight":"500","margin-bottom":"0.25rem"},S={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","align-items":"center"},x=Y=>({padding:"0.2rem 0.5rem","border-radius":"var(--border-radius-sm)","font-size":"0.7rem","font-weight":"500",background:P(Y),color:"white","text-transform":"uppercase"}),m={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},re=()=>r()&&o()?o():u()?`${u().name} (${u().code})`:"";return(()=>{var Y=IA(),$=Y.firstChild,V=$.firstChild;return d($,oe),V.addEventListener("blur",E),V.$$keydown=A,V.$$click=y,V.$$input=b,s($,(()=>{var Q=ge(()=>!!t.onAddNew);return()=>Q()&&(()=>{var L=$A();return L.addEventListener("mouseleave",D=>{D.currentTarget.style.background="var(--surface-color)",D.currentTarget.style.color="var(--primary-color)"}),L.addEventListener("mouseenter",D=>{D.currentTarget.style.background="var(--primary-color)",D.currentTarget.style.color="white"}),Ln(L,"click",t.onAddNew,!0),d(L,O),le(()=>ct(L,"title",e("inventory.addLocation","Add new location"))),L})()})(),null),s(Y,w(Re,{get when(){return r()},get children(){var Q=tm();return s(Q,w(Re,{get when(){return h().length>0},get fallback(){return(()=>{var L=tm();return d(L,m),s(L,(()=>{var D=ge(()=>!!o());return()=>D()?e("inventory.noLocationsFound","No locations found matching your search."):e("inventory.noLocationsAvailable","No locations available.")})()),L})()},get children(){return w(nt,{get each(){return h()},children:(L,D)=>(()=>{var j=EA(),ue=j.firstChild,W=ue.firstChild,ce=W.firstChild,T=ce.firstChild,G=ce.nextSibling,Z=G.firstChild,F=Z.firstChild,ne=Z.nextSibling,H=G.nextSibling;return j.addEventListener("mouseenter",()=>c(D())),j.$$click=()=>_(L),d(ue,v),d(W,f),d(ce,C),s(ce,()=>R(L.type),T),s(ce,()=>L.name,null),d(G,S),s(Z,()=>e("inventory.locationCode","Code"),F),s(Z,()=>L.code,null),s(ne,()=>L.type),H.style.setProperty("font-size","0.75rem"),H.style.setProperty("color","var(--text-muted)"),H.style.setProperty("margin-top","0.25rem"),s(H,()=>L.address),le(U=>{var ae=g(D()===a()),se=x(L.type);return U.e=d(j,ae,U.e),U.t=d(ne,se,U.t),U},{e:void 0,t:void 0}),j})()})}})),le(L=>d(Q,N,L)),Q}}),null),le(Q=>{var L=k,D=M,j=t.placeholder||e("inventory.searchLocations","Search locations by name, code, or type..."),ue=t.disabled,W=t.required;return Q.e=d(Y,L,Q.e),Q.t=d(V,D,Q.t),j!==Q.a&&ct(V,"placeholder",Q.a=j),ue!==Q.o&&(V.disabled=Q.o=ue),W!==Q.i&&(V.required=Q.i=W),Q},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),le(()=>V.value=re()),Y})()};ft(["input","click","keydown"]);var TA=z("<form><div><label> *</label><input type=text required></div><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text list=categories required><datalist id=categories><option value=Electronics></option><option value=Accessories></option><option value=Office></option><option value=Furniture></option><option value=Software></option><option value=Hardware></option></datalist></div></div><div><label></label><textarea></textarea></div><div><div><label></label><select><option value=pcs></option><option value=kg></option><option value=lbs></option><option value=m></option><option value=ft></option><option value=l></option><option value=gal></option><option value=box></option><option value=pack></option></select></div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div></div><div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div><div></div></div><div><div><label></label><input type=number min=0 step=1></div><div><label></label><input type=number min=1 step=1></div></div><div>"),kA=z("<div>");const Dd=t=>{const{t:e}=it(),[r,n]=fe(""),[o,i]=fe(""),[a,c]=fe(""),[u,h]=fe(""),[y,b]=fe("pcs"),[_,A]=fe(0),[E,R]=fe(0),[P,k]=fe(10),[K,oe]=fe(100),[O,M]=fe(""),N=()=>{n(""),i(""),c(""),h(""),b("pcs"),A(0),R(0),k(10),oe(100),M("")},g=$=>{if($.preventDefault(),M(""),!r().trim()){M(e("forms.productNameRequired"));return}if(!o().trim()){M(e("forms.skuRequired"));return}if(!u().trim()){M(e("forms.categoryRequired"));return}if(_()<0){M(e("forms.unitCostNotNegative"));return}if(E()<0){M(e("forms.sellingPriceNotNegative"));return}if(P()<0){M(e("forms.minStockNotNegative"));return}if(K()<=P()){M(e("forms.maxStockGreaterThanMin"));return}if(De.getProductsBySku(o()).length>0){M(e("forms.skuAlreadyExists"));return}const Q={name:r().trim(),sku:o().trim().toUpperCase(),description:a().trim(),category:u().trim(),unitOfMeasure:y(),unitCost:_(),sellingPrice:E(),minStockLevel:P(),maxStockLevel:K(),isActive:!0,businessId:"default-business"};De.addProduct(Q);const L=`prod-${Date.now()}`;t.onProductAdded&&t.onProductAdded(L),N(),t.onClose()},v=()=>{N(),t.onClose()},f={"margin-bottom":"1.5rem"},C={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},S={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},x={...S,cursor:"pointer"},m={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},re={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},Y={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"};return w(yr,{get isOpen(){return t.isOpen},onClose:v,get title(){return e("inventory.addNewProduct")},get children(){var $=TA(),V=$.firstChild,Q=V.firstChild,L=Q.firstChild,D=Q.nextSibling,j=V.nextSibling,ue=j.firstChild,W=ue.firstChild,ce=W.firstChild,T=W.nextSibling,G=ue.nextSibling,Z=G.firstChild,F=Z.firstChild,ne=Z.nextSibling,H=j.nextSibling,U=H.firstChild,ae=U.nextSibling,se=H.nextSibling,pe=se.firstChild,de=pe.firstChild,ye=de.nextSibling,X=ye.firstChild,ee=X.nextSibling,q=ee.nextSibling,he=q.nextSibling,ve=he.nextSibling,B=ve.nextSibling,te=B.nextSibling,_e=te.nextSibling,we=_e.nextSibling,me=pe.nextSibling,be=me.firstChild,ie=be.nextSibling,Pe=se.nextSibling,Te=Pe.firstChild,$e=Te.firstChild,Ee=$e.nextSibling,Ve=Pe.nextSibling,Ke=Ve.firstChild,je=Ke.firstChild,Ce=je.nextSibling,Be=Ke.nextSibling,Je=Be.firstChild,Qe=Je.nextSibling,We=Ve.nextSibling;return $.addEventListener("submit",g),s(Q,()=>e("inventory.productName"),L),D.addEventListener("change",xe=>n(xe.target.value)),s(W,()=>e("inventory.sku"),ce),T.addEventListener("change",xe=>i(xe.target.value)),s(Z,()=>e("inventory.category"),F),ne.addEventListener("change",xe=>h(xe.target.value)),s(U,()=>e("common.description")),ae.addEventListener("change",xe=>c(xe.target.value)),s(de,()=>e("inventory.unitOfMeasure")),ye.addEventListener("change",xe=>b(xe.target.value)),s(X,()=>e("inventory.pieces")),s(ee,()=>e("inventory.kilograms")),s(q,()=>e("inventory.pounds")),s(he,()=>e("inventory.meters")),s(ve,()=>e("inventory.feet")),s(B,()=>e("inventory.liters")),s(te,()=>e("inventory.gallons")),s(_e,()=>e("inventory.boxes")),s(we,()=>e("inventory.packs")),s(be,()=>e("inventory.unitCost")),ie.addEventListener("change",xe=>A(Number(xe.target.value))),s($e,()=>e("inventory.sellingPrice")),Ee.addEventListener("change",xe=>R(Number(xe.target.value))),s(je,()=>e("inventory.minimumStockLevel")),Ce.addEventListener("change",xe=>k(Number(xe.target.value))),s(Je,()=>e("inventory.maximumStockLevel")),Qe.addEventListener("change",xe=>oe(Number(xe.target.value))),s($,(()=>{var xe=ge(()=>!!O());return()=>xe()&&(()=>{var at=kA();return d(at,m),s(at,O),at})()})(),We),d(We,re),s(We,w(Le,{variant:"secondary",type:"button",onClick:v,get children(){return e("common.cancel")}}),null),s(We,w(Le,{variant:"primary",type:"submit",get children(){return e("inventory.addProduct")}}),null),le(xe=>{var at=f,et=C,bt=S,ht=e("inventory.enterProductName"),Nt=Y,jt=C,Tt=S,Bt=e("inventory.enterSkuCode"),gt=C,er=S,Ie=e("inventory.enterCategory"),St=f,Oe=C,Fe={...S,"min-height":"80px",resize:"vertical"},Ze=e("inventory.enterProductDescription"),rt=Y,Ct=C,Xe=x,lt=C,mt=S,At=Y,Me=C,Jt=S,vt=Y,_t=C,kt=S,yt=C,Lt=S;return xe.e=d(V,at,xe.e),xe.t=d(Q,et,xe.t),xe.a=d(D,bt,xe.a),ht!==xe.o&&ct(D,"placeholder",xe.o=ht),xe.i=d(j,Nt,xe.i),xe.n=d(W,jt,xe.n),xe.s=d(T,Tt,xe.s),Bt!==xe.h&&ct(T,"placeholder",xe.h=Bt),xe.r=d(Z,gt,xe.r),xe.d=d(ne,er,xe.d),Ie!==xe.l&&ct(ne,"placeholder",xe.l=Ie),xe.u=d(H,St,xe.u),xe.c=d(U,Oe,xe.c),xe.w=d(ae,Fe,xe.w),Ze!==xe.m&&ct(ae,"placeholder",xe.m=Ze),xe.f=d(se,rt,xe.f),xe.y=d(de,Ct,xe.y),xe.g=d(ye,Xe,xe.g),xe.p=d(be,lt,xe.p),xe.b=d(ie,mt,xe.b),xe.T=d(Pe,At,xe.T),xe.A=d($e,Me,xe.A),xe.O=d(Ee,Jt,xe.O),xe.I=d(Ve,vt,xe.I),xe.S=d(je,_t,xe.S),xe.W=d(Ce,kt,xe.W),xe.C=d(Je,yt,xe.C),xe.B=d(Qe,Lt,xe.B),xe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),le(()=>D.value=r()),le(()=>T.value=o()),le(()=>ne.value=u()),le(()=>ae.value=a()),le(()=>ye.value=y()),le(()=>ie.value=_()),le(()=>Ee.value=E()),le(()=>Ce.value=P()),le(()=>Qe.value=K()),$}})};var RA=z('<form><div><label> *</label><input type=text required></div><div><div><label> *<button type=button title="Generate code automatically"></button></label><input type=text required><div></div></div><div><label> *</label><select required><option value=warehouse> </option><option value=store> </option><option value=supplier> </option><option value=customer> </option></select><div></div></div></div><div><label> *</label><textarea required></textarea></div><div>'),DA=z("<div><div>:</div><div><span></span><div><div></div><div>"),NA=z("<div>");const Nd=t=>{const{t:e}=it(),[r,n]=fe(""),[o,i]=fe(""),[a,c]=fe("warehouse"),[u,h]=fe(""),[y,b]=fe(""),_=()=>{n(""),i(""),c("warehouse"),h(""),b("")},A=()=>{if(r()){const S=a()==="warehouse"?"WH":a()==="store"?"ST":a()==="supplier"?"SUP":"CUST",x=r().toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,3),m=String(Math.floor(Math.random()*1e3)).padStart(3,"0");i(`${S}-${x}-${m}`)}},E=S=>{if(S.preventDefault(),b(""),!r().trim()){b(e("forms.locationNameRequired"));return}if(!o().trim()){b(e("forms.locationCodeRequired"));return}if(!u().trim()){b(e("forms.addressRequired"));return}if(De.locations.filter(Y=>Y.code.toLowerCase()===o().toLowerCase()).length>0){b(e("forms.locationCodeExists"));return}const m={name:r().trim(),code:o().trim().toUpperCase(),type:a(),address:u().trim(),isActive:!0};De.addLocation(m);const re=`loc-${Date.now()}`;t.onLocationAdded&&t.onLocationAdded(re),_(),t.onClose()},R=()=>{_(),t.onClose()},P={"margin-bottom":"1.5rem"},k={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},K={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},oe={...K,cursor:"pointer"},O={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},M={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},N={display:"grid","grid-template-columns":"2fr 1fr",gap:"1rem"},g={"font-size":"0.875rem",color:"var(--text-muted)","margin-top":"0.25rem"},v={padding:"0.25rem 0.5rem","font-size":"0.75rem","margin-left":"0.5rem",background:"var(--background-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",color:"var(--text-muted)"},f=S=>({warehouse:"🏭",store:"🏪",supplier:"🚚",customer:"👥"})[S]||"📍",C=S=>({warehouse:e("inventory.warehouseDescription"),store:e("inventory.storeDescription"),supplier:e("inventory.supplierDescription"),customer:e("inventory.customerDescription")})[S]||"";return w(yr,{get isOpen(){return t.isOpen},onClose:R,get title(){return e("inventory.addNewLocation")},get children(){var S=RA(),x=S.firstChild,m=x.firstChild,re=m.firstChild,Y=m.nextSibling,$=x.nextSibling,V=$.firstChild,Q=V.firstChild,L=Q.firstChild,D=L.nextSibling,j=Q.nextSibling,ue=j.nextSibling,W=V.nextSibling,ce=W.firstChild,T=ce.firstChild,G=ce.nextSibling,Z=G.firstChild,F=Z.firstChild,ne=Z.nextSibling,H=ne.firstChild,U=ne.nextSibling,ae=U.firstChild,se=U.nextSibling,pe=se.firstChild,de=G.nextSibling,ye=$.nextSibling,X=ye.firstChild,ee=X.firstChild,q=X.nextSibling,he=ye.nextSibling;return S.addEventListener("submit",E),s(m,()=>e("inventory.locationName"),re),Y.addEventListener("change",ve=>n(ve.target.value)),d($,N),s(Q,()=>e("inventory.locationCode"),L),D.$$click=A,d(D,v),s(D,()=>e("common.generate")),j.addEventListener("change",ve=>i(ve.target.value)),s(ue,()=>e("inventory.uniqueIdentifierHelp")),s(ce,()=>e("inventory.locationType"),T),G.addEventListener("change",ve=>c(ve.target.value)),s(Z,()=>f("warehouse"),F),s(Z,()=>e("inventory.warehouse"),null),s(ne,()=>f("store"),H),s(ne,()=>e("inventory.store"),null),s(U,()=>f("supplier"),ae),s(U,()=>e("inventory.supplier"),null),s(se,()=>f("customer"),pe),s(se,()=>e("inventory.customer"),null),s(de,()=>C(a())),s(X,()=>e("common.address"),ee),q.addEventListener("change",ve=>h(ve.target.value)),s(S,(()=>{var ve=ge(()=>!!r());return()=>ve()&&(()=>{var B=DA(),te=B.firstChild,_e=te.firstChild,we=te.nextSibling,me=we.firstChild,be=me.nextSibling,ie=be.firstChild,Pe=ie.nextSibling;return B.style.setProperty("padding","1rem"),B.style.setProperty("background","var(--background-color)"),B.style.setProperty("border-radius","var(--border-radius-sm)"),B.style.setProperty("border","1px solid var(--border-color)"),B.style.setProperty("margin-bottom","1rem"),te.style.setProperty("font-weight","500"),te.style.setProperty("margin-bottom","0.5rem"),s(te,()=>e("common.preview"),_e),we.style.setProperty("display","flex"),we.style.setProperty("align-items","center"),we.style.setProperty("gap","0.5rem"),me.style.setProperty("font-size","1.2rem"),s(me,()=>f(a())),ie.style.setProperty("font-weight","600"),s(ie,r),Pe.style.setProperty("font-size","0.875rem"),Pe.style.setProperty("color","var(--text-muted)"),s(Pe,(()=>{var Te=ge(()=>!!o());return()=>Te()&&`${o()} • `})(),null),s(Pe,a,null),B})()})(),he),s(S,(()=>{var ve=ge(()=>!!y());return()=>ve()&&(()=>{var B=NA();return d(B,O),s(B,y),B})()})(),he),d(he,M),s(he,w(Le,{variant:"secondary",type:"button",onClick:R,get children(){return e("common.cancel")}}),null),s(he,w(Le,{variant:"primary",type:"submit",get children(){return e("inventory.addLocation")}}),null),le(ve=>{var B=P,te=k,_e=K,we=e("inventory.enterLocationName"),me=k,be=K,ie=e("inventory.enterUniqueCode"),Pe=g,Te=k,$e=oe,Ee=g,Ve=P,Ke=k,je={...K,"min-height":"100px",resize:"vertical"},Ce=e("inventory.enterCompleteAddress");return ve.e=d(x,B,ve.e),ve.t=d(m,te,ve.t),ve.a=d(Y,_e,ve.a),we!==ve.o&&ct(Y,"placeholder",ve.o=we),ve.i=d(Q,me,ve.i),ve.n=d(j,be,ve.n),ie!==ve.s&&ct(j,"placeholder",ve.s=ie),ve.h=d(ue,Pe,ve.h),ve.r=d(ce,Te,ve.r),ve.d=d(G,$e,ve.d),ve.l=d(de,Ee,ve.l),ve.u=d(ye,Ve,ve.u),ve.c=d(X,Ke,ve.c),ve.w=d(q,je,ve.w),Ce!==ve.m&&ct(q,"placeholder",ve.m=Ce),ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),le(()=>Y.value=r()),le(()=>j.value=o()),le(()=>G.value=a()),le(()=>q.value=u()),S}})};ft(["click"]);var LA=z("<form><div>"),rm=z("<div><label> *"),MA=z("<div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment>"),OA=z("<div><label>"),VA=z("<div><label> *</label><input type=number min=0 step=1 required>"),FA=z("<div><label></label><input type=number min=0 step=0.01>"),BA=z("<div><label></label><input type=text>"),UA=z("<div><label></label><textarea>"),jA=z("<div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span>:</span><span> "),zA=z("<div><div><span>:</span><span>"),qA=z("<div>");const GA=t=>{const{t:e}=it(),[r,n]=fe({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""}),[o,i]=fe(""),[a,c]=fe(""),[u,h]=fe("in"),[y,b]=fe(0),[_,A]=fe(0),[E,R]=fe(""),[P,k]=fe(""),[K,oe]=fe(""),[O,M]=fe(""),[N,g]=fe(!1),[v,f]=fe(!1),C=()=>t.mode==="movement",S=ze(()=>o()?De.getProductById(o()):null),x=ze(()=>a()?De.getLocationById(a()):null),m=ze(()=>K()?De.getLocationById(K()):null),re=ze(()=>y()*_()),Y=ze(()=>!o()||!a()?0:De.getStockByProductAndLocation(o(),a())?.quantity||0),$=[{value:"Electronics",label:"Electronics"},{value:"Accessories",label:"Accessories"},{value:"Furniture",label:"Furniture"},{value:"Office Supplies",label:"Office Supplies"},{value:"Software",label:"Software"},{value:"Hardware",label:"Hardware"},{value:"Consumables",label:"Consumables"}],V=[{value:"Warehouse A",label:"Warehouse A"},{value:"Warehouse B",label:"Warehouse B"},{value:"Warehouse C",label:"Warehouse C"},{value:"Storage Room",label:"Storage Room"},{value:"Main Office",label:"Main Office"}],Q={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},L=()=>{i(""),c(""),h("in"),b(0),A(0),R(""),k(""),oe(""),M("")},D=()=>{n({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""})},j=se=>{if(se.preventDefault(),C()){if(M(""),!o()){M(e("forms.selectProduct"));return}if(!a()){M(e("forms.selectLocation"));return}if(y()<=0){M(e("forms.quantityGreaterThanZero"));return}if(_()<0){M(e("forms.unitCostNotNegative"));return}if(u()==="transfer"&&!K()){M(e("forms.selectFromLocation"));return}if(u()==="transfer"&&K()===a()){M(e("forms.sameLocationError"));return}if(u()==="out"&&y()>Y()){M(e("forms.insufficientStock",{currentStock:Y()}));return}const pe=S(),de=x(),ye={productId:pe.id,productName:pe.name,productSku:pe.sku,locationId:de.id,locationName:de.name,movementType:u(),quantity:y(),unitCost:_()||pe.unitCost,totalCost:re()||y()*pe.unitCost,referenceNumber:E()||`AUTO-${Date.now()}`,notes:P(),createdBy:"admin",fromLocationId:u()==="transfer"?K():void 0,fromLocationName:u()==="transfer"?m()?.name:void 0};De.addInventoryMovement(ye),L()}else{const pe=r();if(!pe.name||!pe.price||!pe.quantity||!pe.category||!pe.sku||!pe.supplier||!pe.minStock||!pe.location){alert(e("forms.fillAllRequired"));return}const de={name:pe.name,price:parseFloat(pe.price),quantity:parseInt(pe.quantity),category:pe.category,description:pe.description,sku:pe.sku,supplier:pe.supplier,minStock:parseInt(pe.minStock),location:pe.location};De.addItem(de),D()}t.onClose()},ue=(se,pe)=>{n(de=>({...de,[se]:pe}))},W=()=>{C()?L():D(),t.onClose()},ce=se=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(se),T={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},G={...T,cursor:"pointer"},Z={color:"#f44336","font-size":"0.875rem","margin-top":"0.5rem"},F={padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},ne={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},H={"font-weight":"500",color:"var(--text-muted)"},U={"font-weight":"600",color:"var(--text-primary)"},ae=()=>C()?e("inventory.addMovement"):e("inventory.addNewItem");return w(yr,{get isOpen(){return t.isOpen},onClose:W,get title(){return ae()},get children(){return[(()=>{var se=LA(),pe=se.firstChild;return se.addEventListener("submit",j),s(se,(()=>{var de=ge(()=>!!C());return()=>de()?[(()=>{var ye=rm(),X=ye.firstChild,ee=X.firstChild;return ye.style.setProperty("margin-bottom","1.5rem"),X.style.setProperty("display","block"),X.style.setProperty("margin-bottom","0.5rem"),X.style.setProperty("font-weight","500"),s(X,()=>e("inventory.product"),ee),s(ye,w(Rd,{get value(){return o()},onChange:q=>{i(q);const he=De.getProductById(q);he&&A(he.unitCost)},get placeholder(){return e("inventory.searchProductsPlaceholder")},onAddNew:()=>g(!0),required:!0}),null),ye})(),(()=>{var ye=MA(),X=ye.firstChild,ee=X.firstChild,q=X.nextSibling,he=q.firstChild,ve=he.nextSibling,B=ve.nextSibling,te=B.nextSibling;return ye.style.setProperty("margin-bottom","1.5rem"),X.style.setProperty("display","block"),X.style.setProperty("margin-bottom","0.5rem"),X.style.setProperty("font-weight","500"),s(X,()=>e("inventory.movementType"),ee),q.addEventListener("change",_e=>h(_e.target.value)),s(he,()=>e("inventory.stockInPurchase")),s(ve,()=>e("inventory.stockOutSale")),s(B,()=>e("inventory.transferBetween")),s(te,()=>e("inventory.stockAdjustment")),le(_e=>d(q,G,_e)),le(()=>q.value=u()),ye})(),ge(()=>ge(()=>u()==="transfer")()&&(()=>{var ye=rm(),X=ye.firstChild,ee=X.firstChild;return ye.style.setProperty("margin-bottom","1.5rem"),X.style.setProperty("display","block"),X.style.setProperty("margin-bottom","0.5rem"),X.style.setProperty("font-weight","500"),s(X,()=>e("inventory.fromLocation"),ee),s(ye,w(Va,{get value(){return K()},onChange:q=>oe(q),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>f(!0),required:!0}),null),ye})()),(()=>{var ye=OA(),X=ye.firstChild;return ye.style.setProperty("margin-bottom","1.5rem"),X.style.setProperty("display","block"),X.style.setProperty("margin-bottom","0.5rem"),X.style.setProperty("font-weight","500"),s(X,(()=>{var ee=ge(()=>u()==="transfer");return()=>ee()?e("inventory.toLocation")+" *":e("inventory.locationName")+" *"})()),s(ye,w(Va,{get value(){return a()},onChange:ee=>c(ee),get placeholder(){return ge(()=>u()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>f(!0),required:!0}),null),ye})(),ge(()=>ge(()=>!!(S()&&x()))()&&(()=>{var ye=jA(),X=ye.firstChild,ee=X.firstChild,q=ee.firstChild,he=ee.nextSibling,ve=he.firstChild,B=X.nextSibling,te=B.firstChild,_e=te.firstChild,we=te.nextSibling,me=B.nextSibling,be=me.firstChild,ie=be.firstChild,Pe=be.nextSibling,Te=Pe.firstChild;return s(ee,()=>e("inventory.currentStockAt",{location:x()?.name}),q),s(he,Y,ve),s(he,()=>S()?.unitOfMeasure,null),s(te,()=>e("inventory.productCost"),_e),s(we,()=>ce(S()?.unitCost||0)),s(be,()=>e("inventory.minStockLevel"),ie),s(Pe,()=>S()?.minStockLevel,Te),s(Pe,()=>S()?.unitOfMeasure,null),le($e=>{var Ee=F,Ve=ne,Ke=H,je=U,Ce=ne,Be=H,Je=U,Qe=ne,We=H,xe=U;return $e.e=d(ye,Ee,$e.e),$e.t=d(X,Ve,$e.t),$e.a=d(ee,Ke,$e.a),$e.o=d(he,je,$e.o),$e.i=d(B,Ce,$e.i),$e.n=d(te,Be,$e.n),$e.s=d(we,Je,$e.s),$e.h=d(me,Qe,$e.h),$e.r=d(be,We,$e.r),$e.d=d(Pe,xe,$e.d),$e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),ye})()),(()=>{var ye=VA(),X=ye.firstChild,ee=X.firstChild,q=X.nextSibling;return ye.style.setProperty("margin-bottom","1.5rem"),X.style.setProperty("display","block"),X.style.setProperty("margin-bottom","0.5rem"),X.style.setProperty("font-weight","500"),s(X,()=>e("inventory.quantity"),ee),q.addEventListener("change",he=>b(Number(he.target.value))),le(he=>d(q,T,he)),le(()=>q.value=y()),ye})(),(()=>{var ye=FA(),X=ye.firstChild,ee=X.nextSibling;return ye.style.setProperty("margin-bottom","1.5rem"),X.style.setProperty("display","block"),X.style.setProperty("margin-bottom","0.5rem"),X.style.setProperty("font-weight","500"),s(X,()=>e("inventory.unitCost")),ee.addEventListener("change",q=>A(Number(q.target.value))),le(q=>{var he=T,ve=e("inventory.willUseDefaultCost");return q.e=d(ee,he,q.e),ve!==q.t&&ct(ee,"placeholder",q.t=ve),q},{e:void 0,t:void 0}),le(()=>ee.value=_()),ye})(),ge(()=>ge(()=>y()>0&&_()>0)()&&(()=>{var ye=zA(),X=ye.firstChild,ee=X.firstChild,q=ee.firstChild,he=ee.nextSibling;return s(ee,()=>e("inventory.totalCost"),q),s(he,()=>ce(re())),le(ve=>{var B=F,te=ne,_e=H,we={...U,"font-size":"1.2rem",color:"var(--primary-color)"};return ve.e=d(ye,B,ve.e),ve.t=d(X,te,ve.t),ve.a=d(ee,_e,ve.a),ve.o=d(he,we,ve.o),ve},{e:void 0,t:void 0,a:void 0,o:void 0}),ye})()),(()=>{var ye=BA(),X=ye.firstChild,ee=X.nextSibling;return ye.style.setProperty("margin-bottom","1.5rem"),X.style.setProperty("display","block"),X.style.setProperty("margin-bottom","0.5rem"),X.style.setProperty("font-weight","500"),s(X,()=>e("common.referenceNumber")),ee.addEventListener("change",q=>R(q.target.value)),le(q=>{var he=T,ve=e("common.referenceNumberPlaceholder");return q.e=d(ee,he,q.e),ve!==q.t&&ct(ee,"placeholder",q.t=ve),q},{e:void 0,t:void 0}),le(()=>ee.value=E()),ye})(),(()=>{var ye=UA(),X=ye.firstChild,ee=X.nextSibling;return ye.style.setProperty("margin-bottom","1.5rem"),X.style.setProperty("display","block"),X.style.setProperty("margin-bottom","0.5rem"),X.style.setProperty("font-weight","500"),s(X,()=>e("common.notes")),ee.addEventListener("change",q=>k(q.target.value)),le(q=>{var he={...T,"min-height":"100px",resize:"vertical"},ve=e("inventory.additionalNotesPlaceholder");return q.e=d(ee,he,q.e),ve!==q.t&&ct(ee,"placeholder",q.t=ve),q},{e:void 0,t:void 0}),le(()=>ee.value=P()),ye})(),ge(()=>ge(()=>!!O())()&&(()=>{var ye=qA();return d(ye,Z),s(ye,O),ye})())]:[w(Ot,{get label(){return e("inventory.itemName")},get value(){return r().name},onChange:ye=>ue("name",ye),get placeholder(){return e("inventory.enterItemName")},required:!0}),w(Ot,{get label(){return e("inventory.sku")},get value(){return r().sku},onChange:ye=>ue("sku",ye),get placeholder(){return e("inventory.enterSkuCode")},required:!0}),w(vr,{get label(){return e("inventory.category")},get value(){return r().category},onChange:ye=>ue("category",ye),options:$,required:!0}),w(Ot,{get label(){return e("common.description")},get value(){return r().description},onChange:ye=>ue("description",ye),get placeholder(){return e("inventory.enterItemDescription")}}),w(Ot,{get label(){return e("common.price")},type:"number",get value(){return r().price},onChange:ye=>ue("price",ye),get placeholder(){return e("common.enterPrice")},required:!0}),w(Ot,{get label(){return e("inventory.quantity")},type:"number",get value(){return r().quantity},onChange:ye=>ue("quantity",ye),get placeholder(){return e("inventory.enterQuantity")},required:!0}),w(Ot,{get label(){return e("inventory.minimumStock")},type:"number",get value(){return r().minStock},onChange:ye=>ue("minStock",ye),get placeholder(){return e("inventory.enterMinStockLevel")},required:!0}),w(Ot,{get label(){return e("inventory.supplier")},get value(){return r().supplier},onChange:ye=>ue("supplier",ye),get placeholder(){return e("inventory.enterSupplierName")},required:!0}),w(vr,{get label(){return e("inventory.location")},get value(){return r().location},onChange:ye=>ue("location",ye),options:V,required:!0})]})(),pe),d(pe,Q),s(pe,w(Le,{variant:"secondary",type:"button",onClick:W,get children(){return e("common.cancel")}}),null),s(pe,w(Le,{variant:"primary",type:"submit",get children(){return ge(()=>!!C())()?e("inventory.addMovement"):e("inventory.addItem")}}),null),se})(),w(Dd,{get isOpen(){return N()},onClose:()=>g(!1),onProductAdded:se=>{i(se),g(!1)}}),w(Nd,{get isOpen(){return v()},onClose:()=>f(!1),onLocationAdded:se=>{u()==="transfer"&&!K()?oe(se):c(se),f(!1)}})]}})};ft(["input","keydown"]);var HA=z("<form><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text required></div></div><div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><div><label></label></div></div><div><div><h3></h3></div></div><div><label></label><textarea></textarea></div><div>"),WA=z("<div><label> *"),YA=z("<div><div></div><div></div><div></div><div></div><div>"),Dl=z("<div>"),KA=z("<div><input type=number min=0 step=1 required><input type=number min=0 step=0.01><input type=text>"),QA=z("<div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span>"),JA=z("<div>• ");const XA=t=>{const{t:e}=it(),[r,n]=fe(`INV-${Date.now()}`),[o,i]=fe(""),[a,c]=fe("in"),[u,h]=fe(""),[y,b]=fe(""),[_,A]=fe(""),[E,R]=fe([]),[P,k]=fe([]),[K,oe]=fe(!1),[O,M]=fe(!1),N=()=>{R(F=>[...F,{productId:"",quantity:0,unitCost:0,notes:""}])},g=F=>{R(ne=>ne.filter((H,U)=>U!==F))},v=(F,ne,H)=>{R(U=>U.map((ae,se)=>se===F?{...ae,[ne]:H}:ae))},f=()=>{n(`INV-${Date.now()}`),i(""),c("in"),h(""),b(""),A(""),R([]),k([])},C=async F=>{F.preventDefault(),k([]);const ne=[];if(o()||ne.push(e("forms.referenceNumberRequired")),u()||ne.push(e("forms.locationRequired")),a()==="transfer"&&!y()&&ne.push(e("forms.fromLocationRequired")),E().length===0&&ne.push(e("forms.atLeastOneProduct")),E().forEach((ae,se)=>{ae.productId||ne.push(e("forms.itemProductRequired","Product is required for item {{index}}",{index:se+1})),ae.quantity<=0&&ne.push(e("forms.itemQuantityRequired","Quantity must be greater than 0 for item {{index}}",{index:se+1}))}),ne.length>0){k(ne);return}const H={ssg_inventory_key:Zm(),invoiceId:r(),referenceNumber:o(),movementType:a(),type:Xl(a()),locationId:u(),fromLocationId:a()==="transfer"?y():void 0,items:E(),products:E(),generalNotes:_(),description:_(),invoice:o(),store:u(),createdBy:"admin",createDate:new Date().toISOString()};console.log(H);const U=await De.addBulkInventoryMovements(H);console.log(U),U.success?t.onMovementComplete?t.onMovementComplete(o()):(f(),t.onClose()):k(U.errors)},S=()=>{f(),t.onClose()},x=ze(()=>E().reduce((F,ne)=>{const H=De.getProductById(ne.productId),U=ne.unitCost||H?.unitCost||0;return F+ne.quantity*U},0)),m=ze(()=>E().reduce((F,ne)=>F+ne.quantity,0)),re={"margin-bottom":"1.5rem"},Y={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},$={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},V={...$,cursor:"pointer"},Q={display:"grid",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},L={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},D={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem","padding-left":"0.75rem"},j={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},ue={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},W={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},ce={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},T=F=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(F),G=F=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[F]||F,Z=async F=>{await De.fecthInventory(F),await De.fecthProduct(F)};return Hr(()=>{Z("prod")}),w(yr,{get isOpen(){return t.isOpen},onClose:S,get title(){return e("inventory.bulkMovement")},get children(){return[(()=>{var F=HA(),ne=F.firstChild,H=ne.firstChild,U=H.firstChild,ae=U.firstChild,se=U.nextSibling,pe=H.nextSibling,de=pe.firstChild,ye=de.firstChild,X=de.nextSibling,ee=ne.nextSibling,q=ee.firstChild,he=q.firstChild,ve=q.nextSibling,B=ve.firstChild,te=B.nextSibling,_e=te.nextSibling,we=_e.nextSibling,me=ee.nextSibling,be=me.firstChild,ie=be.firstChild,Pe=me.nextSibling,Te=Pe.firstChild,$e=Te.firstChild,Ee=Pe.nextSibling,Ve=Ee.firstChild,Ke=Ve.nextSibling,je=Ee.nextSibling;return F.addEventListener("submit",C),ne.style.setProperty("display","grid"),ne.style.setProperty("grid-template-columns","1fr 1fr"),ne.style.setProperty("gap","1rem"),ne.style.setProperty("margin-bottom","1.5rem"),s(U,()=>e("common.invoiceDocumentId"),ae),se.addEventListener("change",Ce=>n(Ce.target.value)),s(de,()=>e("common.referenceNumber"),ye),X.addEventListener("change",Ce=>i(Ce.target.value)),s(q,()=>e("inventory.movementType"),he),ve.addEventListener("change",Ce=>c(Ce.target.value)),s(B,()=>e("inventory.purchaseReceive")),s(te,()=>e("inventory.saleIssue")),s(_e,()=>e("inventory.transfer")),s(we,()=>e("inventory.adjustment")),me.style.setProperty("display","grid"),me.style.setProperty("gap","1rem"),me.style.setProperty("margin-bottom","1.5rem"),s(me,(()=>{var Ce=ge(()=>a()==="transfer");return()=>Ce()&&(()=>{var Be=WA(),Je=Be.firstChild,Qe=Je.firstChild;return s(Je,()=>e("inventory.fromLocation"),Qe),s(Be,w(Va,{get value(){return y()},onChange:We=>b(We),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>M(!0),required:!0}),null),le(We=>d(Je,Y,We)),Be})()})(),be),s(ie,(()=>{var Ce=ge(()=>a()==="transfer");return()=>Ce()?e("inventory.toLocation")+" *":e("inventory.location")+" *"})()),s(be,w(Va,{get value(){return u()},onChange:Ce=>h(Ce),get placeholder(){return ge(()=>a()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>M(!0),required:!0}),null),Te.style.setProperty("display","flex"),Te.style.setProperty("justify-content","space-between"),Te.style.setProperty("align-items","center"),Te.style.setProperty("margin-bottom","1rem"),$e.style.setProperty("margin","0"),$e.style.setProperty("font-size","1.1rem"),s($e,()=>e("inventory.products")),s(Te,w(Le,{variant:"outline",type:"button",onClick:N,get children(){return e("inventory.addProduct")}}),null),s(Pe,(()=>{var Ce=ge(()=>E().length>0);return()=>Ce()&&[(()=>{var Be=YA(),Je=Be.firstChild,Qe=Je.nextSibling,We=Qe.nextSibling,xe=We.nextSibling;return d(Be,D),s(Je,()=>e("inventory.product")),s(Qe,()=>e("inventory.quantity")),s(We,()=>e("inventory.unitCost")),s(xe,()=>e("common.notes")),Be})(),w(nt,{get each(){return E()},children:(Be,Je)=>[(()=>{var Qe=Dl();return d(Qe,Q),s(Qe,w(Rd,{get value(){return Be.productId},onChange:We=>{v(Je(),"productId",We.id);let xe={id:We.id,label:We.name,code:We.sku};v(Je(),"product",xe);const at=De.getProductById(We.id);at&&!Be.unitCost&&v(Je(),"unitCost",at.unitCost)},get placeholder(){return e("inventory.searchProduct")},onAddNew:()=>oe(!0),required:!0})),Qe})(),(()=>{var Qe=KA(),We=Qe.firstChild,xe=We.nextSibling,at=xe.nextSibling;return d(Qe,L),We.addEventListener("change",et=>v(Je(),"quantity",Number(et.target.value))),xe.addEventListener("change",et=>v(Je(),"unitCost",Number(et.target.value))),at.addEventListener("change",et=>v(Je(),"notes",et.target.value)),s(Qe,w(Le,{variant:"outline",size:"sm",type:"button",onClick:()=>g(Je()),style:{color:"#f44336","border-color":"#f44336"},get children(){return e("common.remove")}}),null),le(et=>{var bt=$,ht=$,Nt=e("common.auto"),jt=$,Tt=e("common.optionalNotes");return et.e=d(We,bt,et.e),et.t=d(xe,ht,et.t),Nt!==et.a&&ct(xe,"placeholder",et.a=Nt),et.o=d(at,jt,et.o),Tt!==et.i&&ct(at,"placeholder",et.i=Tt),et},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),le(()=>We.value=Be.quantity),le(()=>xe.value=Be.unitCost),le(()=>at.value=Be.notes),Qe})()]})]})(),null),s(Pe,(()=>{var Ce=ge(()=>E().length===0);return()=>Ce()&&(()=>{var Be=Dl();return Be.style.setProperty("text-align","center"),Be.style.setProperty("padding","2rem"),Be.style.setProperty("background","var(--background-color)"),Be.style.setProperty("border-radius","var(--border-radius-sm)"),Be.style.setProperty("border","1px solid var(--border-color)"),Be.style.setProperty("color","var(--text-muted)"),s(Be,()=>e("inventory.noProductsAdded")),Be})()})(),null),s(F,(()=>{var Ce=ge(()=>E().length>0);return()=>Ce()&&(()=>{var Be=QA(),Je=Be.firstChild,Qe=Je.nextSibling,We=Qe.firstChild,xe=We.firstChild,at=We.nextSibling,et=Qe.nextSibling,bt=et.firstChild,ht=bt.firstChild,Nt=bt.nextSibling,jt=et.nextSibling,Tt=jt.firstChild,Bt=Tt.firstChild,gt=Tt.nextSibling,er=jt.nextSibling,Ie=er.firstChild,St=Ie.firstChild,Oe=Ie.nextSibling;return d(Be,j),Je.style.setProperty("margin","0 0 1rem 0"),Je.style.setProperty("font-size","1rem"),s(Je,()=>e("common.summary")),s(We,()=>e("inventory.totalProducts"),xe),at.style.setProperty("font-weight","600"),s(at,()=>E().length),s(bt,()=>e("inventory.totalItems"),ht),Nt.style.setProperty("font-weight","600"),s(Nt,m),s(Tt,()=>e("inventory.totalValue"),Bt),gt.style.setProperty("font-weight","600"),gt.style.setProperty("color","var(--primary-color)"),s(gt,()=>T(x())),s(Ie,()=>e("inventory.movementType"),St),Oe.style.setProperty("font-weight","600"),s(Oe,()=>G(a())),le(Fe=>{var Ze=ue,rt=ue,Ct=ue,Xe=ue;return Fe.e=d(Qe,Ze,Fe.e),Fe.t=d(et,rt,Fe.t),Fe.a=d(jt,Ct,Fe.a),Fe.o=d(er,Xe,Fe.o),Fe},{e:void 0,t:void 0,a:void 0,o:void 0}),Be})()})(),Ee),s(Ve,()=>e("common.generalNotes")),Ke.addEventListener("change",Ce=>A(Ce.target.value)),s(F,(()=>{var Ce=ge(()=>P().length>0);return()=>Ce()&&(()=>{var Be=Dl();return d(Be,W),s(Be,w(nt,{get each(){return P()},children:Je=>(()=>{var Qe=JA();return Qe.firstChild,s(Qe,Je,null),Qe})()})),Be})()})(),je),d(je,ce),s(je,w(Le,{variant:"secondary",type:"button",onClick:S,get children(){return e("common.cancel")}}),null),s(je,w(Le,{variant:"primary",type:"submit",get children(){return e("inventory.createMovement")}}),null),le(Ce=>{var Be=Y,Je=$,Qe=Y,We=$,xe=e("common.referenceNumberPlaceholder"),at=re,et=Y,bt=V,ht=a()==="transfer"?"1fr 1fr":"1fr",Nt=Y,jt=re,Tt=re,Bt=Y,gt={...$,"min-height":"80px",resize:"vertical"},er=e("inventory.generalNotesPlaceholder");return Ce.e=d(U,Be,Ce.e),Ce.t=d(se,Je,Ce.t),Ce.a=d(de,Qe,Ce.a),Ce.o=d(X,We,Ce.o),xe!==Ce.i&&ct(X,"placeholder",Ce.i=xe),Ce.n=d(ee,at,Ce.n),Ce.s=d(q,et,Ce.s),Ce.h=d(ve,bt,Ce.h),ht!==Ce.r&&((Ce.r=ht)!=null?me.style.setProperty("grid-template-columns",ht):me.style.removeProperty("grid-template-columns")),Ce.d=d(ie,Nt,Ce.d),Ce.l=d(Pe,jt,Ce.l),Ce.u=d(Ee,Tt,Ce.u),Ce.c=d(Ve,Bt,Ce.c),Ce.w=d(Ke,gt,Ce.w),er!==Ce.m&&ct(Ke,"placeholder",Ce.m=er),Ce},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),le(()=>se.value=r()),le(()=>X.value=o()),le(()=>ve.value=a()),le(()=>Ke.value=_()),F})(),w(Dd,{get isOpen(){return K()},onClose:()=>oe(!1),onProductAdded:F=>{oe(!1)}}),w(Nd,{get isOpen(){return O()},onClose:()=>M(!1),onLocationAdded:F=>{a()==="transfer"&&!y()?b(F):h(F),M(!1)}})]}})};var ZA=z("<button>"),ex=z("<div><h3></h3><button>🖨️ "),tx=z("<div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),Nl=z("<div><strong>:</strong> "),rx=z("<div>"),nx=z("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),ox=z("<div><div><h2></h2><div><select><option value=date></option><option value=quantity></option><option value=value></option></select></div></div><div>"),ix=z("<div><div><h3></h3><div></div></div><div><span></span><div>"),sx=z("<div><div><strong>:</strong> "),ax=z("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),lx=z("<div><button></button><button>🖨️"),cx=z("<tr><td></td><td></td><td></td><td></td><td></td><td>");const Df=t=>{const{t:e}=it(),[r,n]=fe(null),[o,i]=fe("date"),a=ze(()=>{const _=t.movements||De.movements,A=new Map;return _.forEach(E=>{const R=E.referenceNumber||E.ssg_inventory_key||E.invoiceId||"UNKNOWN";if(!A.has(R)){const K=De.getLocationById(E.locationId);A.set(R,{referenceNumber:E.referenceNumber||"",invoiceId:E.invoiceId||"",ssg_inventory_key:E.ssg_inventory_key||"",movementType:E.movementType||"unknown",locationId:E.locationId||"",locationName:K?.name||"Unknown Location",totalItems:0,totalQuantity:0,createDate:E.createDate||new Date().toISOString(),description:E.description||"",generalNotes:E.generalNotes||"",movements:[],totalValue:0})}const P=A.get(R);P.movements.push(E),P.totalItems++,P.totalQuantity+=Math.abs(E.quantity||0);const k=De.getProductById(E.productId);k&&k.unitCost&&(P.totalValue+=Math.abs(E.quantity||0)*k.unitCost)}),Array.from(A.values()).sort((E,R)=>{switch(o()){case"quantity":return R.totalQuantity-E.totalQuantity;case"value":return R.totalValue-E.totalValue;case"date":default:return new Date(R.createDate).getTime()-new Date(E.createDate).getTime()}})}),c=_=>new Date(_).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),u=_=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(_),h=_=>{switch(_.toLowerCase()){case"in":case"stock_in":return"#22c55e";case"out":case"stock_out":return"#ef4444";case"transfer":return"#3b82f6";case"adjustment":return"#f59e0b";default:return"#6b7280"}},y=_=>{switch(_.toLowerCase()){case"in":case"stock_in":return"↗️";case"out":case"stock_out":return"↙️";case"transfer":return"↔️";case"adjustment":return"⚖️";default:return"📦"}},b=_=>{const A=_||r();if(!A)return;const E=window.open("","_blank");if(!E)return;const R=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Bulk Movement Report - ${A.referenceNumber||A.invoiceId}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 20px; }
          .group-info { background: #f8f9fa; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
          .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
          table { width: 100%; border-collapse: collapse; margin-top: 15px; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background-color: #f2f2f2; font-weight: bold; }
          .summary { background: #e8f4fd; padding: 15px; margin-top: 20px; border-radius: 5px; }
          @media print { body { margin: 0; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>BULK MOVEMENT REPORT</h1>
          <h2>${A.referenceNumber||A.invoiceId}</h2>
          <p>Generated: ${c(new Date().toISOString())}</p>
        </div>
        
        <div class="group-info">
          <div class="info-grid">
            <div>
              <strong>Reference Number:</strong> ${A.referenceNumber||"N/A"}<br>
              <strong>Invoice ID:</strong> ${A.invoiceId||"N/A"}<br>
              <strong>Movement Type:</strong> ${A.movementType.toUpperCase()}<br>
              <strong>Location:</strong> ${A.locationName}
            </div>
            <div>
              <strong>Date:</strong> ${c(A.createDate)}<br>
              <strong>Total Items:</strong> ${A.totalItems}<br>
              <strong>Total Quantity:</strong> ${A.totalQuantity}<br>
              <strong>Estimated Value:</strong> ${u(A.totalValue)}
            </div>
          </div>
          ${A.description?`<p><strong>Description:</strong> ${A.description}</p>`:""}
          ${A.generalNotes?`<p><strong>Notes:</strong> ${A.generalNotes}</p>`:""}
        </div>
        
        <table>
          <thead>
            <tr>
              <th>Product Code</th>
              <th>Product Name</th>
              <th>Quantity</th>
              <th>Unit Cost</th>
              <th>Total Value</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody>
            ${A.movements.map(P=>{const k=De.getProductById(P.productId),K=k?.unitCost||0,oe=Math.abs(P.quantity||0)*K;return`
                <tr>
                  <td>${k?.code||P.productId}</td>
                  <td>${k?.name||"Unknown Product"}</td>
                  <td>${P.quantity||0}</td>
                  <td>${u(K)}</td>
                  <td>${u(oe)}</td>
                  <td>${P.notes||"-"}</td>
                </tr>
              `}).join("")}
          </tbody>
        </table>
        
        <div class="summary">
          <h3>SUMMARY</h3>
          <p><strong>Total Products:</strong> ${A.totalItems}</p>
          <p><strong>Total Quantity Moved:</strong> ${A.totalQuantity}</p>
          <p><strong>Total Estimated Value:</strong> ${u(A.totalValue)}</p>
          <p><strong>Movement Impact:</strong> ${A.movementType==="in"?"Increased":A.movementType==="out"?"Decreased":"Adjusted"} inventory</p>
        </div>
      </body>
      </html>
    `;E.document.write(R),E.document.close(),E.print()};return(()=>{var _=ox(),A=_.firstChild,E=A.firstChild,R=E.nextSibling,P=R.firstChild,k=P.firstChild,K=k.nextSibling,oe=K.nextSibling,O=A.nextSibling;return _.style.setProperty("padding","1rem"),A.style.setProperty("display","flex"),A.style.setProperty("justify-content","space-between"),A.style.setProperty("align-items","center"),A.style.setProperty("margin-bottom","2rem"),s(E,()=>e("inventory.bulkMovementReport","Bulk Movement Report")),R.style.setProperty("display","flex"),R.style.setProperty("gap","1rem"),P.addEventListener("change",M=>i(M.currentTarget.value)),P.style.setProperty("padding","0.5rem"),s(k,()=>e("common.sortByDate","Sort by Date")),s(K,()=>e("common.sortByQuantity","Sort by Quantity")),s(oe,()=>e("common.sortByValue","Sort by Value")),s(R,w(Re,{get when(){return t.onClose},get children(){var M=ZA();return Ln(M,"click",t.onClose,!0),M.style.setProperty("padding","0.5rem 1rem"),M.style.setProperty("background","#6c757d"),M.style.setProperty("color","white"),M.style.setProperty("border","none"),M.style.setProperty("border-radius","var(--border-radius-sm)"),M.style.setProperty("cursor","pointer"),s(M,()=>e("common.close","Close")),M}}),null),O.style.setProperty("display","grid"),O.style.setProperty("grid-template-columns","repeat(auto-fill, minmax(400px, 1fr))"),O.style.setProperty("gap","1rem"),O.style.setProperty("margin-bottom","2rem"),s(O,w(nt,{get each(){return a()},children:M=>w(Ge,{get style(){return{cursor:"pointer",border:r()===M?"2px solid var(--primary-color)":"1px solid #e9ecef",transition:"all 0.2s"}},onClick:()=>n(M),get children(){return[(()=>{var N=ix(),g=N.firstChild,v=g.firstChild,f=v.nextSibling,C=g.nextSibling,S=C.firstChild,x=S.nextSibling;return N.style.setProperty("display","flex"),N.style.setProperty("justify-content","space-between"),N.style.setProperty("align-items","flex-start"),N.style.setProperty("margin-bottom","1rem"),v.style.setProperty("margin","0 0 0.5rem 0"),v.style.setProperty("font-size","1.1rem"),s(v,()=>M.referenceNumber||M.invoiceId||"No Reference"),f.style.setProperty("font-size","0.875rem"),f.style.setProperty("color","#6c757d"),s(f,()=>c(M.createDate)),C.style.setProperty("text-align","center"),S.style.setProperty("font-size","1.5rem"),s(S,()=>y(M.movementType)),x.style.setProperty("font-size","0.75rem"),x.style.setProperty("font-weight","bold"),s(x,()=>M.movementType.toUpperCase()),le(m=>(m=h(M.movementType))!=null?x.style.setProperty("color",m):x.style.removeProperty("color")),N})(),(()=>{var N=sx(),g=N.firstChild,v=g.firstChild,f=v.firstChild;return v.nextSibling,N.style.setProperty("margin-bottom","1rem"),g.style.setProperty("font-size","0.875rem"),g.style.setProperty("margin-bottom","0.25rem"),s(v,()=>e("inventory.location","Location"),f),s(g,()=>M.locationName,null),s(N,w(Re,{get when(){return M.description},get children(){var C=Nl(),S=C.firstChild,x=S.firstChild;return S.nextSibling,C.style.setProperty("font-size","0.875rem"),C.style.setProperty("margin-bottom","0.25rem"),s(S,()=>e("common.description","Description"),x),s(C,()=>M.description,null),C}}),null),N})(),(()=>{var N=ax(),g=N.firstChild,v=g.firstChild,f=v.nextSibling,C=g.nextSibling,S=C.firstChild,x=S.nextSibling,m=C.nextSibling,re=m.firstChild,Y=re.nextSibling;return N.style.setProperty("display","grid"),N.style.setProperty("grid-template-columns","repeat(3, 1fr)"),N.style.setProperty("gap","0.5rem"),N.style.setProperty("margin-bottom","1rem"),g.style.setProperty("text-align","center"),g.style.setProperty("padding","0.5rem"),g.style.setProperty("background","#f8f9fa"),g.style.setProperty("border-radius","var(--border-radius-sm)"),v.style.setProperty("font-weight","bold"),v.style.setProperty("color","#3b82f6"),s(v,()=>M.totalItems),f.style.setProperty("font-size","0.75rem"),f.style.setProperty("color","#6c757d"),s(f,()=>e("inventory.items","Items")),C.style.setProperty("text-align","center"),C.style.setProperty("padding","0.5rem"),C.style.setProperty("background","#f8f9fa"),C.style.setProperty("border-radius","var(--border-radius-sm)"),S.style.setProperty("font-weight","bold"),S.style.setProperty("color","#22c55e"),s(S,()=>M.totalQuantity),x.style.setProperty("font-size","0.75rem"),x.style.setProperty("color","#6c757d"),s(x,()=>e("inventory.quantity","Quantity")),m.style.setProperty("text-align","center"),m.style.setProperty("padding","0.5rem"),m.style.setProperty("background","#f8f9fa"),m.style.setProperty("border-radius","var(--border-radius-sm)"),re.style.setProperty("font-weight","bold"),re.style.setProperty("color","#f59e0b"),s(re,()=>u(M.totalValue)),Y.style.setProperty("font-size","0.75rem"),Y.style.setProperty("color","#6c757d"),s(Y,()=>e("common.value","Value")),N})(),(()=>{var N=lx(),g=N.firstChild,v=g.nextSibling;return N.style.setProperty("display","flex"),N.style.setProperty("gap","0.5rem"),g.$$click=f=>{f.stopPropagation(),n(M)},g.style.setProperty("flex","1"),g.style.setProperty("padding","0.5rem"),g.style.setProperty("background","var(--primary-color)"),g.style.setProperty("color","white"),g.style.setProperty("border","none"),g.style.setProperty("border-radius","var(--border-radius-sm)"),g.style.setProperty("cursor","pointer"),g.style.setProperty("font-size","0.875rem"),s(g,()=>e("common.viewDetails","View Details")),v.$$click=f=>{f.stopPropagation(),b(M)},v.style.setProperty("padding","0.5rem"),v.style.setProperty("background","#22c55e"),v.style.setProperty("color","white"),v.style.setProperty("border","none"),v.style.setProperty("border-radius","var(--border-radius-sm)"),v.style.setProperty("cursor","pointer"),v.style.setProperty("font-size","0.875rem"),N})()]}})})),s(_,w(Re,{get when(){return r()},get children(){return w(Ge,{get children(){return[(()=>{var M=ex(),N=M.firstChild,g=N.nextSibling;return g.firstChild,M.style.setProperty("display","flex"),M.style.setProperty("justify-content","space-between"),M.style.setProperty("align-items","center"),M.style.setProperty("margin-bottom","1rem"),s(N,()=>e("inventory.movementDetails","Movement Details")),g.$$click=()=>b(),g.style.setProperty("padding","0.5rem 1rem"),g.style.setProperty("background","#22c55e"),g.style.setProperty("color","white"),g.style.setProperty("border","none"),g.style.setProperty("border-radius","var(--border-radius-sm)"),g.style.setProperty("cursor","pointer"),s(g,()=>e("common.print","Print Report"),null),M})(),(()=>{var M=tx(),N=M.firstChild,g=N.firstChild,v=g.firstChild,f=v.firstChild;v.nextSibling;var C=g.nextSibling,S=C.firstChild,x=S.firstChild;S.nextSibling;var m=C.nextSibling,re=m.firstChild,Y=re.firstChild;re.nextSibling;var $=m.nextSibling,V=$.firstChild,Q=V.firstChild;V.nextSibling;var L=N.nextSibling,D=L.firstChild,j=D.firstChild,ue=j.firstChild;j.nextSibling;var W=D.nextSibling,ce=W.firstChild,T=ce.firstChild;ce.nextSibling;var G=W.nextSibling,Z=G.firstChild,F=Z.firstChild;Z.nextSibling;var ne=G.nextSibling,H=ne.firstChild,U=H.firstChild;return H.nextSibling,M.style.setProperty("display","grid"),M.style.setProperty("grid-template-columns","repeat(2, 1fr)"),M.style.setProperty("gap","1rem"),M.style.setProperty("margin-bottom","2rem"),M.style.setProperty("padding","1rem"),M.style.setProperty("background","#f8f9fa"),M.style.setProperty("border-radius","var(--border-radius-sm)"),s(v,()=>e("inventory.referenceNumber","Reference"),f),s(g,()=>r()?.referenceNumber||"N/A",null),s(S,()=>e("inventory.invoiceId","Invoice ID"),x),s(C,()=>r()?.invoiceId||"N/A",null),s(re,()=>e("inventory.movementType","Type"),Y),s(m,()=>r()?.movementType.toUpperCase(),null),s(V,()=>e("inventory.location","Location"),Q),s($,()=>r()?.locationName,null),s(j,()=>e("common.date","Date"),ue),s(D,(()=>{var ae=ge(()=>!!r());return()=>ae()?c(r().createDate):""})(),null),s(ce,()=>e("inventory.totalItems","Total Items"),T),s(W,()=>r()?.totalItems,null),s(Z,()=>e("inventory.totalQuantity","Total Quantity"),F),s(G,()=>r()?.totalQuantity,null),s(H,()=>e("common.estimatedValue","Estimated Value"),U),s(ne,(()=>{var ae=ge(()=>!!r());return()=>ae()?u(r().totalValue):""})(),null),M})(),w(Re,{get when(){return r()?.description||r()?.generalNotes},get children(){var M=rx();return M.style.setProperty("margin-bottom","2rem"),M.style.setProperty("padding","1rem"),M.style.setProperty("background","#e8f4fd"),M.style.setProperty("border-radius","var(--border-radius-sm)"),s(M,w(Re,{get when(){return r()?.description},get children(){var N=Nl(),g=N.firstChild,v=g.firstChild;return g.nextSibling,s(g,()=>e("common.description","Description"),v),s(N,()=>r()?.description,null),N}}),null),s(M,w(Re,{get when(){return r()?.generalNotes},get children(){var N=Nl(),g=N.firstChild,v=g.firstChild;return g.nextSibling,s(g,()=>e("common.notes","Notes"),v),s(N,()=>r()?.generalNotes,null),N}}),null),M}}),(()=>{var M=nx(),N=M.firstChild,g=N.firstChild,v=g.firstChild,f=v.firstChild,C=f.nextSibling,S=C.nextSibling,x=S.nextSibling,m=x.nextSibling,re=m.nextSibling,Y=g.nextSibling;return M.style.setProperty("overflow-x","auto"),N.style.setProperty("width","100%"),N.style.setProperty("border-collapse","collapse"),v.style.setProperty("border-bottom","2px solid #dee2e6"),f.style.setProperty("padding","0.75rem"),f.style.setProperty("text-align","left"),s(f,()=>e("inventory.productCode","Code")),C.style.setProperty("padding","0.75rem"),C.style.setProperty("text-align","left"),s(C,()=>e("inventory.productName","Product")),S.style.setProperty("padding","0.75rem"),S.style.setProperty("text-align","center"),s(S,()=>e("inventory.quantity","Quantity")),x.style.setProperty("padding","0.75rem"),x.style.setProperty("text-align","right"),s(x,()=>e("inventory.unitCost","Unit Cost")),m.style.setProperty("padding","0.75rem"),m.style.setProperty("text-align","right"),s(m,()=>e("common.totalValue","Total Value")),re.style.setProperty("padding","0.75rem"),re.style.setProperty("text-align","left"),s(re,()=>e("common.notes","Notes")),s(Y,w(nt,{get each(){return r()?.movements||[]},children:$=>{const V=De.getProductById($.productId),Q=V?.unitCost||0,L=Math.abs($.quantity||0)*Q;return(()=>{var D=cx(),j=D.firstChild,ue=j.nextSibling,W=ue.nextSibling,ce=W.nextSibling,T=ce.nextSibling,G=T.nextSibling;return D.style.setProperty("border-bottom","1px solid #dee2e6"),j.style.setProperty("padding","0.75rem"),j.style.setProperty("font-family","monospace"),s(j,()=>V?.code||$.productId),ue.style.setProperty("padding","0.75rem"),s(ue,()=>V?.name||"Unknown Product"),W.style.setProperty("padding","0.75rem"),W.style.setProperty("text-align","center"),W.style.setProperty("font-weight","bold"),s(W,()=>$.quantity||0),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("text-align","right"),s(ce,()=>u(Q)),T.style.setProperty("padding","0.75rem"),T.style.setProperty("text-align","right"),T.style.setProperty("font-weight","bold"),s(T,()=>u(L)),G.style.setProperty("padding","0.75rem"),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","#6c757d"),s(G,()=>$.notes||"-"),le(Z=>(Z=($.quantity||0)>=0?"#22c55e":"#ef4444")!=null?W.style.setProperty("color",Z):W.style.removeProperty("color")),D})()}})),M})()]}})}}),null),le(()=>P.value=o()),_})()};ft(["click"]);var dx=z("<div><div><div><h2>Bulk Movement Report - </h2><button>×</button></div><div>");const ux=t=>{const[e,r]=fe(!0),[n,o]=fe(!1),[i,a]=fe([]),[c,u]=fe(""),h=_=>{const A=De.movements.filter(E=>E.referenceNumber===_||E.invoiceId===_||E.ssg_inventory_key===_);a(A),u(_),r(!1),o(!0)},y=()=>{r(!1),t.onClose()},b=()=>{o(!1),t.onClose()};return[w(Re,{get when(){return e()},get children(){return w(XA,{get isOpen(){return ge(()=>!!t.isOpen)()&&e()},onClose:y,onMovementComplete:h})}}),w(Re,{get when(){return n()},get children(){var _=dx(),A=_.firstChild,E=A.firstChild,R=E.firstChild;R.firstChild;var P=R.nextSibling,k=E.nextSibling;return _.style.setProperty("position","fixed"),_.style.setProperty("top","0"),_.style.setProperty("left","0"),_.style.setProperty("right","0"),_.style.setProperty("bottom","0"),_.style.setProperty("background","rgba(0, 0, 0, 0.5)"),_.style.setProperty("z-index","1000"),_.style.setProperty("display","flex"),_.style.setProperty("align-items","center"),_.style.setProperty("justify-content","center"),_.style.setProperty("padding","2rem"),A.style.setProperty("background","white"),A.style.setProperty("border-radius","var(--border-radius)"),A.style.setProperty("width","95%"),A.style.setProperty("max-width","1200px"),A.style.setProperty("max-height","90vh"),A.style.setProperty("overflow-y","auto"),A.style.setProperty("position","relative"),E.style.setProperty("padding","1rem 2rem"),E.style.setProperty("border-bottom","1px solid #e9ecef"),E.style.setProperty("display","flex"),E.style.setProperty("justify-content","space-between"),E.style.setProperty("align-items","center"),E.style.setProperty("background","#f8f9fa"),R.style.setProperty("margin","0"),s(R,c,null),P.$$click=b,P.style.setProperty("background","none"),P.style.setProperty("border","none"),P.style.setProperty("font-size","1.5rem"),P.style.setProperty("cursor","pointer"),P.style.setProperty("padding","0.5rem"),P.style.setProperty("line-height","1"),k.style.setProperty("padding","1rem"),s(k,w(Df,{get movements(){return i()},onClose:b})),_}})]};ft(["click"]);var hx=z("<div><div></div><div></div><div></div><div>"),mx=z("<div><strong>:</strong> "),yx=z("<div><div><span></span><span></span></div><div><span></span><span> </span></div><div><span></span><span> </span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),px=z("<div>");const fx=t=>{const{t:e}=it(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},o={"font-weight":"600",color:"var(--text-primary)"},i={"text-align":"center","margin-bottom":"2rem"},a={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},c={color:"var(--text-muted)","font-size":"1rem"},u={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"1rem"},h=(R,P)=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:R>P?"#d4edda":"#f8d7da",color:R>P?"#155724":"#721c24"}),y={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},b={"margin-bottom":"1.5rem",padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",color:"var(--text-secondary)"};if(!t.item)return null;const _=R=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(R),A=R=>new Date(R).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),E=t.item.price*t.item.quantity;return w(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.itemDetails")},get children(){return[(()=>{var R=hx(),P=R.firstChild,k=P.nextSibling,K=k.nextSibling,oe=K.nextSibling;return d(R,i),d(P,a),s(P,()=>t.item.name),d(k,c),s(k,()=>t.item.category),d(K,u),s(K,()=>_(t.item.price)),s(oe,(()=>{var O=ge(()=>t.item.quantity>t.item.minStock);return()=>O()?e("inventory.inStock"):e("inventory.lowStockAlert")})()),le(O=>d(oe,h(t.item.quantity,t.item.minStock),O)),R})(),(()=>{var R=mx(),P=R.firstChild,k=P.firstChild;return P.nextSibling,d(R,b),s(P,()=>e("common.description"),k),s(R,()=>t.item.description,null),R})(),(()=>{var R=yx(),P=R.firstChild,k=P.firstChild,K=k.nextSibling,oe=P.nextSibling,O=oe.firstChild,M=O.nextSibling,N=M.firstChild,g=oe.nextSibling,v=g.firstChild,f=v.nextSibling,C=f.firstChild,S=g.nextSibling,x=S.firstChild,m=x.nextSibling,re=S.nextSibling,Y=re.firstChild,$=Y.nextSibling,V=re.nextSibling,Q=V.firstChild,L=Q.nextSibling,D=V.nextSibling,j=D.firstChild,ue=j.nextSibling;return s(k,()=>e("inventory.sku")),s(K,()=>t.item.sku),s(O,()=>e("inventory.quantity")),s(M,()=>t.item.quantity,N),s(M,()=>e("common.units"),null),s(v,()=>e("inventory.minimumStock")),s(f,()=>t.item.minStock,C),s(f,()=>e("common.units"),null),s(x,()=>e("inventory.totalValue")),s(m,()=>_(E)),s(Y,()=>e("inventory.supplier")),s($,()=>t.item.supplier),s(Q,()=>e("inventory.location")),s(L,()=>t.item.location),s(j,()=>e("common.lastUpdated")),s(ue,()=>A(t.item.lastUpdated)),le(W=>{var ce=r,T=n,G=o,Z=r,F=n,ne=o,H=r,U=n,ae=o,se=r,pe=n,de=o,ye=r,X=n,ee=o,q=r,he=n,ve=o,B=r,te=n,_e=o;return W.e=d(P,ce,W.e),W.t=d(k,T,W.t),W.a=d(K,G,W.a),W.o=d(oe,Z,W.o),W.i=d(O,F,W.i),W.n=d(M,ne,W.n),W.s=d(g,H,W.s),W.h=d(v,U,W.h),W.r=d(f,ae,W.r),W.d=d(S,se,W.d),W.l=d(x,pe,W.l),W.u=d(m,de,W.u),W.c=d(re,ye,W.c),W.w=d(Y,X,W.w),W.m=d($,ee,W.m),W.f=d(V,q,W.f),W.y=d(Q,he,W.y),W.g=d(L,ve,W.g),W.p=d(D,B,W.p),W.b=d(j,te,W.b),W.T=d(ue,_e,W.T),W},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),R})(),(()=>{var R=px();return d(R,y),s(R,w(Le,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(R,w(Le,{variant:"primary",onClick:()=>{console.log("Edit item:",t.item.id)},get children(){return e("common.editItem")}}),null),R})()]}})};var gx=z("<div>🔄"),vx=z("<button type=button>×"),bx=z("<div>⚠️ "),nm=z("<div>"),_x=z("<div><div><input type=text autocomplete=off>"),Px=z("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>"),Sx=z("<span>⚠️ ");const wx=t=>{const{t:e}=it(),[r,n]=fe(""),[o,i]=fe(!1),[a,c]=fe(null),[u,h]=fe([]),[y,b]=fe(!1),[_,A]=fe(-1),[E,R]=fe(null),P=t.searchDelay||300;t.maxResults;const k=async ce=>{if(!ce.trim()||ce.trim().length<3){h([]),t.onSearchResults?.([]);return}try{i(!0),c(null);try{console.log("apiResults",ce),t.onSearchResults?.(ce)}catch(T){console.warn("API search failed, using local fallback:",T),c("API search failed, showing local results")}}catch(T){const G=T instanceof Error?T.message:"Search failed";c(G),h([]),t.onSearchResults?.([])}finally{i(!1)}},K=ce=>{const G=ce.target.value;n(G),c(null),console.log(),t.showResults,E()&&clearTimeout(E());const Z=setTimeout(()=>{k(G)},P);R(Z)},oe=ce=>{n(ce.name),b(!1),A(-1),t.onInventorySelect?.(ce)},O=ce=>{if(!(!y()||u().length===0))switch(ce.key){case"ArrowDown":ce.preventDefault(),A(T=>Math.min(T+1,u().length-1));break;case"ArrowUp":ce.preventDefault(),A(T=>Math.max(T-1,-1));break;case"Enter":ce.preventDefault(),_()>=0&&u()[_()]&&oe(u()[_()]);break;case"Escape":b(!1),A(-1);break}},M=()=>{t.showResults!==!1&&u().length>0&&b(!0)},N=()=>{setTimeout(()=>{b(!1),A(-1)},150)},g=()=>{n(""),h([]),c(null),b(!1),A(-1),t.onSearchResults?.([]),E()&&(clearTimeout(E()),R(null))},v=ce=>De.stockLevels.filter(T=>T.inventoryId===ce).reduce((T,G)=>T+G.quantity,0),f=ce=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ce),C={position:"relative",width:"100%",...t.style},S={position:"relative",display:"flex","align-items":"center"},x={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},m={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},re={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},Y={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},$=ce=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:ce?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),V={display:"flex","justify-content":"space-between","align-items":"center"},Q={flex:"1"},L={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},D={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},j={"text-align":"right","font-size":"0.875rem"},ue={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},W={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var ce=_x(),T=ce.firstChild,G=T.firstChild;return G.addEventListener("blur",N),G.addEventListener("focus",M),G.$$keydown=O,G.$$input=K,s(T,w(Re,{get when(){return o()},get children(){var Z=gx();return le(F=>d(Z,re,F)),Z}}),null),s(T,w(Re,{get when(){return ge(()=>!!r())()&&!o()},get children(){var Z=vx();return Z.addEventListener("mouseleave",F=>{F.currentTarget.style.background="none",F.currentTarget.style.color="var(--text-muted)"}),Z.addEventListener("mouseenter",F=>{F.currentTarget.style.background="var(--border-color)",F.currentTarget.style.color="var(--text-primary)"}),Z.$$click=g,le(F=>{var ne=m,H=e("common.clear","Clear search");return F.e=d(Z,ne,F.e),H!==F.t&&ct(Z,"title",F.t=H),F},{e:void 0,t:void 0}),Z}}),null),s(ce,w(Re,{get when(){return y()&&t.showResults!==!1},get children(){var Z=nm();return s(Z,w(Re,{get when(){return a()},get children(){var F=bx();return F.firstChild,d(F,W),s(F,a,null),F}}),null),s(Z,w(Re,{get when(){return u().length>0},get fallback(){return ge(()=>!!(r()&&!o()))()&&(()=>{var F=nm();return d(F,ue),s(F,()=>e("inventory.noInventorysFound","No inventorys found matching your search.")),F})()},get children(){return w(nt,{get each(){return u()},children:(F,ne)=>{const H=v(F.id),U=H<=F.minStockLevel;return(()=>{var ae=Px(),se=ae.firstChild,pe=se.firstChild,de=pe.firstChild,ye=de.nextSibling,X=ye.firstChild,ee=X.firstChild,q=X.nextSibling,he=q.nextSibling,ve=he.nextSibling,B=ve.nextSibling,te=pe.nextSibling,_e=te.firstChild,we=_e.firstChild,me=_e.nextSibling;return ae.addEventListener("mouseenter",()=>A(ne())),ae.$$click=()=>oe(F),d(se,V),d(pe,Q),d(de,L),s(de,()=>F.name),d(ye,D),s(X,()=>e("inventory.sku","SKU"),ee),s(X,()=>F.sku,null),s(he,()=>F.category),s(B,()=>f(F.unitCost)),d(te,j),_e.style.setProperty("font-weight","600"),(U?"#f44336":"var(--text-primary)")!=null?_e.style.setProperty("color",U?"#f44336":"var(--text-primary)"):_e.style.removeProperty("color"),s(_e,H,we),s(_e,()=>F.unitOfMeasure,null),me.style.setProperty("color","var(--text-muted)"),s(me,()=>U?(()=>{var be=Sx();return be.firstChild,be.style.setProperty("color","#f44336"),s(be,()=>e("inventory.lowStock","Low Stock"),null),be})():e("inventory.inStock","In Stock")),le(be=>d(ae,$(ne()===_()),be)),ae})()}})}}),null),le(F=>d(Z,Y,F)),Z}}),null),le(Z=>{var F=C,ne=S,H=x,U=t.placeholder||e("inventory.searchInventorys","Search inventorys by name, SKU, or category..."),ae=t.disabled;return Z.e=d(ce,F,Z.e),Z.t=d(T,ne,Z.t),Z.a=d(G,H,Z.a),U!==Z.o&&ct(G,"placeholder",Z.o=U),ae!==Z.i&&(G.disabled=Z.i=ae),Z},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),le(()=>G.value=r()),ce})()};ft(["input","keydown","click"]);var Cx=z("<div>"),Ll=z("<div><span>:</span><span>"),Ax=z("<div><button> "),xx=z("<div><div><div><h3></h3><div>: </div></div><div><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span> <!>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span>");const Ix=t=>{const{t:e}=it(),r=A=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(A),n=A=>new Date(A).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),o=A=>({in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}})[A]||{bg:"#f5f5f5",color:"#666"},i=A=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[A]||"📋",a=()=>t.movement,c={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},u={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},h={"font-weight":"600",color:"var(--text-primary)","text-align":"right"},y={"margin-bottom":"1.5rem"},b={"font-weight":"600","margin-bottom":"0.75rem","padding-bottom":"0.5rem","border-bottom":"2px solid var(--border-color)"},_=A=>({display:"inline-flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"600","text-transform":"uppercase","letter-spacing":"0.5px",background:o(A).bg,color:o(A).color});return w(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.movementDetails")},size:"lg",get children(){return w(Re,{get when(){return a()},get fallback(){return(()=>{var A=Cx();return s(A,()=>e("common.noDataFound")),A})()},children:A=>(()=>{var E=xx(),R=E.firstChild,P=R.firstChild,k=P.firstChild,K=k.nextSibling,oe=K.firstChild,O=P.nextSibling,M=O.firstChild,N=R.nextSibling,g=N.firstChild,v=g.nextSibling,f=v.firstChild,C=f.firstChild,S=f.nextSibling,x=v.nextSibling,m=x.firstChild,re=m.firstChild,Y=m.nextSibling,$=Y.firstChild,V=x.nextSibling,Q=V.firstChild,L=Q.firstChild,D=Q.nextSibling,j=V.nextSibling,ue=j.firstChild,W=ue.firstChild,ce=W.nextSibling;ce.nextSibling;var T=ue.nextSibling,G=N.nextSibling,Z=G.firstChild,F=Z.nextSibling,ne=F.firstChild,H=ne.firstChild,U=ne.nextSibling,ae=G.nextSibling,se=ae.firstChild,pe=se.nextSibling,de=pe.firstChild,ye=de.firstChild,X=de.nextSibling,ee=pe.nextSibling,q=ee.firstChild,he=q.firstChild,ve=q.nextSibling;return R.style.setProperty("display","flex"),R.style.setProperty("justify-content","space-between"),R.style.setProperty("align-items","center"),R.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("padding-bottom","1rem"),R.style.setProperty("border-bottom","2px solid var(--border-color)"),k.style.setProperty("margin","0 0 0.5rem 0"),k.style.setProperty("font-size","1.25rem"),s(k,()=>A().productName),K.style.setProperty("font-size","0.875rem"),K.style.setProperty("color","var(--text-muted)"),s(K,()=>e("inventory.sku"),oe),s(K,()=>A().productSku,null),O.$$click=()=>De.generateMovementInvoice(A().id,e),M.style.setProperty("font-size","1.2rem"),s(M,()=>i(A().movementType)),s(O,()=>A().movementType,null),s(g,()=>e("inventory.movementInformation")),s(f,()=>e("inventory.referenceNumber"),C),s(S,()=>A().referenceNumber),s(m,()=>e("common.quantity"),re),s(Y,()=>A().quantity,$),s(Y,()=>e("common.units"),null),s(Q,()=>e("inventory.unitCost"),L),s(D,()=>r(A().unitCost)),s(ue,()=>e("common.total"),W),s(ue,()=>e("common.value"),ce),s(T,()=>r(A().totalCost)),s(Z,()=>e("inventory.locationInformation")),s(ne,()=>e("inventory.location"),H),s(U,()=>A().locationName),s(G,w(Re,{get when(){return A().fromLocationName},get children(){var B=Ll(),te=B.firstChild,_e=te.firstChild,we=te.nextSibling;return s(te,()=>e("common.from"),_e),s(we,()=>A().fromLocationName),le(me=>{var be=c,ie=u,Pe=h;return me.e=d(B,be,me.e),me.t=d(te,ie,me.t),me.a=d(we,Pe,me.a),me},{e:void 0,t:void 0,a:void 0}),B}}),null),s(G,w(Re,{get when(){return A().invoiceId},get children(){var B=Ll(),te=B.firstChild,_e=te.firstChild,we=te.nextSibling;return s(te,()=>e("common.invoice"),_e),s(we,()=>A().invoiceId),le(me=>{var be=c,ie=u,Pe={...h,color:"var(--primary-color)"};return me.e=d(B,be,me.e),me.t=d(te,ie,me.t),me.a=d(we,Pe,me.a),me},{e:void 0,t:void 0,a:void 0}),B}}),null),s(se,()=>e("common.details")),s(de,()=>e("common.createdBy"),ye),s(X,()=>A().createdBy),s(q,()=>e("common.created"),he),s(ve,()=>n(A().createdDate)),s(ae,w(Re,{get when(){return A().notes},get children(){var B=Ll(),te=B.firstChild,_e=te.firstChild,we=te.nextSibling;return s(te,()=>e("common.notes"),_e),s(we,()=>A().notes),le(me=>{var be={...c,"border-bottom":"none"},ie=u,Pe={...h,"font-style":"italic","max-width":"60%","white-space":"pre-wrap"};return me.e=d(B,be,me.e),me.t=d(te,ie,me.t),me.a=d(we,Pe,me.a),me},{e:void 0,t:void 0,a:void 0}),B}}),null),s(E,w(Re,{get when(){return t.onEdit},get children(){var B=Ax(),te=B.firstChild,_e=te.firstChild;return B.style.setProperty("display","flex"),B.style.setProperty("justify-content","flex-end"),B.style.setProperty("margin-top","1.5rem"),B.style.setProperty("padding-top","1rem"),B.style.setProperty("border-top","1px solid var(--border-color)"),te.addEventListener("mouseleave",we=>{we.currentTarget.style.transform="translateY(0)",we.currentTarget.style.boxShadow="none"}),te.addEventListener("mouseenter",we=>{we.currentTarget.style.transform="translateY(-1px)",we.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)"}),te.$$click=()=>t.onEdit?.(A()),te.style.setProperty("padding","0.5rem 1.5rem"),te.style.setProperty("border-radius","var(--border-radius-sm)"),te.style.setProperty("border","1px solid var(--primary-color)"),te.style.setProperty("background","var(--primary-color)"),te.style.setProperty("color","white"),te.style.setProperty("cursor","pointer"),te.style.setProperty("font-weight","500"),te.style.setProperty("transition","all 0.2s ease"),s(te,()=>e("common.edit"),_e),s(te,()=>e("inventory.movement"),null),B}}),null),le(B=>{var te=_(A().movementType),_e=y,we=b,me=c,be=u,ie=h,Pe=c,Te=u,$e={...h,"font-size":"1.1rem",color:"var(--primary-color)"},Ee=c,Ve=u,Ke=h,je=c,Ce=u,Be={...h,"font-size":"1.1rem",color:"var(--primary-color)"},Je=y,Qe=b,We=c,xe=u,at=h,et=y,bt=b,ht=c,Nt=u,jt=h,Tt=c,Bt=u,gt=h;return B.e=d(O,te,B.e),B.t=d(N,_e,B.t),B.a=d(g,we,B.a),B.o=d(v,me,B.o),B.i=d(f,be,B.i),B.n=d(S,ie,B.n),B.s=d(x,Pe,B.s),B.h=d(m,Te,B.h),B.r=d(Y,$e,B.r),B.d=d(V,Ee,B.d),B.l=d(Q,Ve,B.l),B.u=d(D,Ke,B.u),B.c=d(j,je,B.c),B.w=d(ue,Ce,B.w),B.m=d(T,Be,B.m),B.f=d(G,Je,B.f),B.y=d(Z,Qe,B.y),B.g=d(F,We,B.g),B.p=d(ne,xe,B.p),B.b=d(U,at,B.b),B.T=d(ae,et,B.T),B.A=d(se,bt,B.A),B.O=d(pe,ht,B.O),B.I=d(de,Nt,B.I),B.S=d(X,jt,B.S),B.W=d(ee,Tt,B.W),B.C=d(q,Bt,B.C),B.B=d(ve,gt,B.B),B},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),E})()})}})};ft(["click"]);var bo=z("<div>"),$x=z("<div><label></label><select><option value>"),Ex=z("<div><div><span>:</span><span>$"),Tx=z("<form><div><label></label><select><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><input type=number min=0.01 step=0.01></div><div><label></label><input type=number min=0 step=0.01></div><div><label></label><input type=text></div><div><label> (<!>)</label><input type=text></div><div><label> (<!>)</label><textarea></textarea></div><div><button type=button></button><button type=submit>"),om=z("<option> (<!>)");const kx=t=>{const{t:e}=it(),[r,n]=fe("in"),[o,i]=fe(""),[a,c]=fe(""),[u,h]=fe(""),[y,b]=fe(""),[_,A]=fe(""),[E,R]=fe(""),[P,k]=fe(""),[K,oe]=fe(!1),[O,M]=fe({});Nn(()=>{const re=t.movement;re&&t.isOpen&&(n(re.movementType),i(re.quantity.toString()),c(re.unitCost.toString()),h(re.referenceNumber),b(re.notes),R(re.locationId),A(re.fromLocationId||""),k(re.invoiceId||""),M({}))});const N=()=>{const re={};return(!o()||parseFloat(o())<=0)&&(re.quantity=e("forms.requiredField")),(!a()||parseFloat(a())<0)&&(re.unitCost=e("forms.requiredField")),u().trim()||(re.referenceNumber=e("forms.requiredField")),E()||(re.locationId=e("forms.requiredField")),r()==="transfer"&&!_()&&(re.fromLocationId=e("forms.requiredField")),M(re),Object.keys(re).length===0},g=async re=>{if(re.preventDefault(),!(!N()||!t.movement)){oe(!0);try{const Y=t.movement,$=De.getProductById(Y.productId),V=De.getLocationById(E()),Q=_()?De.getLocationById(_()):null;if(!$||!V)throw new Error("Product or location not found");const L={...Y,movementType:r(),quantity:parseFloat(o()),unitCost:parseFloat(a()),totalCost:parseFloat(o())*parseFloat(a()),referenceNumber:u().trim(),notes:y().trim(),locationId:E(),locationName:V.name,fromLocationId:_()||void 0,fromLocationName:Q?.name,invoiceId:P().trim()||void 0,lastModified:new Date().toISOString()};De.updateMovement(Y.id,L),t.onMovementUpdated?.(),t.onClose(),v()}catch(Y){console.error("Error updating movement:",Y),M({submit:e("forms.saveError")})}finally{oe(!1)}}},v=()=>{n("in"),i(""),c(""),h(""),b(""),A(""),R(""),k(""),M({})},f=()=>{v(),t.onClose()},C={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",transition:"border-color 0.2s ease"},S={display:"block","margin-bottom":"0.25rem","font-weight":"500","font-size":"0.875rem"},x={color:"#d32f2f","font-size":"0.75rem","margin-top":"0.25rem"},m={"margin-bottom":"1rem"};return w(yr,{get isOpen(){return t.isOpen},onClose:f,get title(){return e("inventory.editMovement","Edit Movement")},get children(){return w(Re,{get when(){return t.movement},get fallback(){return(()=>{var re=bo();return s(re,()=>e("common.loading")),re})()},get children(){var re=Tx(),Y=re.firstChild,$=Y.firstChild,V=$.nextSibling,Q=V.firstChild,L=Q.nextSibling,D=L.nextSibling,j=D.nextSibling,ue=Y.nextSibling,W=ue.firstChild,ce=W.nextSibling,T=ce.firstChild,G=ue.nextSibling,Z=G.firstChild,F=Z.nextSibling,ne=G.nextSibling,H=ne.firstChild,U=H.nextSibling,ae=ne.nextSibling,se=ae.firstChild,pe=se.nextSibling,de=ae.nextSibling,ye=de.firstChild,X=ye.firstChild,ee=X.nextSibling;ee.nextSibling;var q=ye.nextSibling,he=de.nextSibling,ve=he.firstChild,B=ve.firstChild,te=B.nextSibling;te.nextSibling;var _e=ve.nextSibling,we=he.nextSibling,me=we.firstChild,be=me.nextSibling;return re.addEventListener("submit",g),s($,()=>e("inventory.movementType")),V.addEventListener("change",ie=>n(ie.target.value)),s(Q,()=>e("inventory.stockIn")),s(L,()=>e("inventory.stockOut")),s(D,()=>e("inventory.transfer")),s(j,()=>e("inventory.adjustment")),s(W,(()=>{var ie=ge(()=>r()==="transfer");return()=>ie()?e("inventory.toLocation"):e("inventory.location")})()),ce.addEventListener("change",ie=>R(ie.target.value)),s(T,()=>e("modals.selectLocation")),s(ce,w(nt,{get each(){return De.getActiveLocations()},children:ie=>(()=>{var Pe=om(),Te=Pe.firstChild,$e=Te.nextSibling;return $e.nextSibling,s(Pe,()=>ie.name,Te),s(Pe,()=>ie.type,$e),le(()=>Pe.value=ie.id),Pe})()}),null),s(ue,w(Re,{get when(){return O().locationId},get children(){var ie=bo();return s(ie,()=>O().locationId),le(Pe=>d(ie,x,Pe)),ie}}),null),s(re,w(Re,{get when(){return r()==="transfer"},get children(){var ie=$x(),Pe=ie.firstChild,Te=Pe.nextSibling,$e=Te.firstChild;return s(Pe,()=>e("inventory.fromLocation")),Te.addEventListener("change",Ee=>A(Ee.target.value)),s($e,()=>e("modals.selectLocation")),s(Te,w(nt,{get each(){return De.getActiveLocations().filter(Ee=>Ee.id!==E())},children:Ee=>(()=>{var Ve=om(),Ke=Ve.firstChild,je=Ke.nextSibling;return je.nextSibling,s(Ve,()=>Ee.name,Ke),s(Ve,()=>Ee.type,je),le(()=>Ve.value=Ee.id),Ve})()}),null),s(ie,w(Re,{get when(){return O().fromLocationId},get children(){var Ee=bo();return s(Ee,()=>O().fromLocationId),le(Ve=>d(Ee,x,Ve)),Ee}}),null),le(Ee=>{var Ve=m,Ke=S,je={...C,"border-color":O().fromLocationId?"#d32f2f":"var(--border-color)"},Ce=K();return Ee.e=d(ie,Ve,Ee.e),Ee.t=d(Pe,Ke,Ee.t),Ee.a=d(Te,je,Ee.a),Ce!==Ee.o&&(Te.disabled=Ee.o=Ce),Ee},{e:void 0,t:void 0,a:void 0,o:void 0}),le(()=>Te.value=_()),ie}}),G),s(Z,()=>e("common.quantity")),F.$$input=ie=>i(ie.target.value),s(G,w(Re,{get when(){return O().quantity},get children(){var ie=bo();return s(ie,()=>O().quantity),le(Pe=>d(ie,x,Pe)),ie}}),null),s(H,()=>e("inventory.unitCost")),U.$$input=ie=>c(ie.target.value),s(ne,w(Re,{get when(){return O().unitCost},get children(){var ie=bo();return s(ie,()=>O().unitCost),le(Pe=>d(ie,x,Pe)),ie}}),null),s(re,w(Re,{get when(){return ge(()=>!!o())()&&a()},get children(){var ie=Ex(),Pe=ie.firstChild,Te=Pe.firstChild,$e=Te.firstChild,Ee=Te.nextSibling;return Ee.firstChild,Pe.style.setProperty("display","flex"),Pe.style.setProperty("justify-content","space-between"),Te.style.setProperty("font-weight","500"),s(Te,()=>e("common.total"),$e),Ee.style.setProperty("font-weight","600"),Ee.style.setProperty("color","var(--primary-color)"),s(Ee,()=>(parseFloat(o()||"0")*parseFloat(a()||"0")).toFixed(2),null),le(Ve=>d(ie,{...m,padding:"0.75rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)"},Ve)),ie}}),ae),s(se,()=>e("inventory.referenceNumber")),pe.$$input=ie=>h(ie.target.value),s(ae,w(Re,{get when(){return O().referenceNumber},get children(){var ie=bo();return s(ie,()=>O().referenceNumber),le(Pe=>d(ie,x,Pe)),ie}}),null),s(ye,()=>e("inventory.invoiceNumber"),X),s(ye,()=>e("common.optional"),ee),q.$$input=ie=>k(ie.target.value),s(ve,()=>e("common.notes"),B),s(ve,()=>e("common.optional"),te),_e.$$input=ie=>b(ie.target.value),s(re,w(Re,{get when(){return O().submit},get children(){var ie=bo();return s(ie,()=>O().submit),le(Pe=>d(ie,{...x,"margin-bottom":"1rem"},Pe)),ie}}),we),we.style.setProperty("display","flex"),we.style.setProperty("gap","1rem"),we.style.setProperty("justify-content","flex-end"),me.$$click=f,me.style.setProperty("padding","0.5rem 1rem"),me.style.setProperty("border","1px solid var(--border-color)"),me.style.setProperty("border-radius","var(--border-radius-sm)"),me.style.setProperty("background","white"),me.style.setProperty("cursor","pointer"),s(me,()=>e("common.cancel")),be.style.setProperty("padding","0.5rem 1rem"),be.style.setProperty("border","none"),be.style.setProperty("border-radius","var(--border-radius-sm)"),be.style.setProperty("background","var(--primary-color)"),be.style.setProperty("color","white"),be.style.setProperty("cursor","pointer"),be.style.setProperty("font-weight","500"),s(be,(()=>{var ie=ge(()=>!!K());return()=>ie()?e("modals.processing"):e("inventory.updateMovement","Update Movement")})()),le(ie=>{var Pe=m,Te=S,$e=C,Ee=K(),Ve=m,Ke=S,je={...C,"border-color":O().locationId?"#d32f2f":"var(--border-color)"},Ce=K(),Be=m,Je=S,Qe={...C,"border-color":O().quantity?"#d32f2f":"var(--border-color)"},We=e("modals.enterQuantity"),xe=K(),at=m,et=S,bt={...C,"border-color":O().unitCost?"#d32f2f":"var(--border-color)"},ht=e("modals.enterCost"),Nt=K(),jt=m,Tt=S,Bt={...C,"border-color":O().referenceNumber?"#d32f2f":"var(--border-color)"},gt=e("modals.enterReference"),er=K(),Ie=m,St=S,Oe=C,Fe=e("inventory.invoiceNumber"),Ze=K(),rt=m,Ct=S,Xe={...C,resize:"vertical","min-height":"80px"},lt=e("modals.addNotes"),mt=K(),At=K(),Me=K();return ie.e=d(Y,Pe,ie.e),ie.t=d($,Te,ie.t),ie.a=d(V,$e,ie.a),Ee!==ie.o&&(V.disabled=ie.o=Ee),ie.i=d(ue,Ve,ie.i),ie.n=d(W,Ke,ie.n),ie.s=d(ce,je,ie.s),Ce!==ie.h&&(ce.disabled=ie.h=Ce),ie.r=d(G,Be,ie.r),ie.d=d(Z,Je,ie.d),ie.l=d(F,Qe,ie.l),We!==ie.u&&ct(F,"placeholder",ie.u=We),xe!==ie.c&&(F.disabled=ie.c=xe),ie.w=d(ne,at,ie.w),ie.m=d(H,et,ie.m),ie.f=d(U,bt,ie.f),ht!==ie.y&&ct(U,"placeholder",ie.y=ht),Nt!==ie.g&&(U.disabled=ie.g=Nt),ie.p=d(ae,jt,ie.p),ie.b=d(se,Tt,ie.b),ie.T=d(pe,Bt,ie.T),gt!==ie.A&&ct(pe,"placeholder",ie.A=gt),er!==ie.O&&(pe.disabled=ie.O=er),ie.I=d(de,Ie,ie.I),ie.S=d(ye,St,ie.S),ie.W=d(q,Oe,ie.W),Fe!==ie.C&&ct(q,"placeholder",ie.C=Fe),Ze!==ie.B&&(q.disabled=ie.B=Ze),ie.v=d(he,rt,ie.v),ie.k=d(ve,Ct,ie.k),ie.x=d(_e,Xe,ie.x),lt!==ie.j&&ct(_e,"placeholder",ie.j=lt),mt!==ie.q&&(_e.disabled=ie.q=mt),At!==ie.z&&(me.disabled=ie.z=At),Me!==ie.P&&(be.disabled=ie.P=Me),ie},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0,z:void 0,P:void 0}),le(()=>V.value=r()),le(()=>ce.value=E()),le(()=>F.value=o()),le(()=>U.value=a()),le(()=>pe.value=u()),le(()=>q.value=P()),le(()=>_e.value=y()),re}})}})};ft(["input","click"]);var Rx=z("<div><div></div><div><div><label></label><select><option value=all></option><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),Dx=z("<div><h2>"),im=z("<div><label></label><select><option value>"),Nx=z("<option> (<!>)"),Lx=z("<option>"),Mx=z("<div><div>📦</div><div></div><div>"),Ox=z("<div><div><div><div><span></span><h3></h3><span></span></div><div> • </div></div><div><div></div><div> <!> @ </div></div></div><div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div><span>:</span><span>"),Vx=z("<span>"),Fx=z("<span>• <!>: "),sm=z("<div><span>:</span><span>"),Bx=z("<div><div><span>:</span><select><option value=10>10</option><option value=25>25</option><option value=50>50</option><option value=100>100</option></select><span></span></div><div><div><span>:</span><input type=number min=1><span> "),Ux=z("<span>..."),jx=z("<button>");const zx=t=>{const{t:e}=it(),[r,n]=fe(""),[o,i]=fe(""),[a,c]=fe("all"),[u,h]=fe({start:"",end:""}),[y,b]=fe(""),[_,A]=fe(""),[E,R]=fe(1),[P,k]=fe(25),[K,oe]=fe(null),[O,M]=fe(!1),[N,g]=fe(!1),v=ze(()=>{let ee=De.movements;if(t.filterBy==="product"&&t.filterId?ee=ee.filter(q=>q.productId===t.filterId):t.filterBy==="location"&&t.filterId&&(ee=ee.filter(q=>q.locationId===t.filterId)),r()&&(ee=ee.filter(q=>q.productId===r())),o()&&(ee=ee.filter(q=>q.locationId===o())),a()!=="all"&&(ee=ee.filter(q=>q.movementType===a())),u().start&&(ee=ee.filter(q=>q.createdDate>=u().start)),u().end&&(ee=ee.filter(q=>q.createdDate<=u().end+"T23:59:59Z")),y()){const q=y().toLowerCase();ee=ee.filter(he=>he.productName.toLowerCase().includes(q)||he.productSku.toLowerCase().includes(q)||he.locationName.toLowerCase().includes(q)||he.referenceNumber.toLowerCase().includes(q)||he.notes.toLowerCase().includes(q)||he.createdBy.toLowerCase().includes(q)||he.invoiceId&&he.invoiceId.toLowerCase().includes(q)||he.fromLocationName&&he.fromLocationName.toLowerCase().includes(q)||he.movementType.toLowerCase().includes(q))}return ee.sort((q,he)=>new Date(he.createdDate).getTime()-new Date(q.createdDate).getTime())});Nn(()=>{r(),o(),a(),u(),y(),R(1)});const f=ze(()=>{const ee=(E()-1)*P(),q=ee+P();return v().slice(ee,q)}),C=ze(()=>Math.ceil(v().length/P())),S=ze(()=>{const ee=v();return{total:ee.length,stockIn:ee.filter(q=>q.movementType==="in").length,stockOut:ee.filter(q=>q.movementType==="out").length,transfers:ee.filter(q=>q.movementType==="transfer").length,adjustments:ee.filter(q=>q.movementType==="adjustment").length,totalValue:ee.reduce((q,he)=>q+he.totalCost,0)}}),x={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},m={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},re={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)",cursor:"pointer"},Y={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},$={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem","margin-bottom":"2rem"},V={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","text-align":"center"},Q={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},L={"font-size":"0.875rem",color:"var(--text-muted)","font-weight":"500"},D={padding:"1.5rem","margin-bottom":"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",transition:"all 0.2s ease"},j={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"1rem"};function ue(ee){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[ee]||{bg:"#f5f5f5",color:"#666"}}const W=ee=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:ue(ee).bg,color:ue(ee).color}),ce={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"1rem"},T={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.5rem 0","border-bottom":"1px solid var(--border-color)"},G={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},Z={"font-weight":"600",color:"var(--text-primary)"},F={display:"flex","justify-content":"space-between","align-items":"center","margin-top":"2rem",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},ne=ee=>({padding:"0.25rem 0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:ee?"var(--primary-color)":"var(--surface-color)",color:ee?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),H=ee=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ee),U=ee=>new Date(ee).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),ae=ee=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[ee]||"📋",se=()=>{n(""),i(""),c("all"),h({start:"",end:""}),b(""),R(1)},pe=ee=>{oe(ee),M(!0)},de=ee=>{oe(ee),M(!1),g(!0)},ye=()=>{g(!1),oe(null)},X=async ee=>{o()&&(ee+=" "+o()),Xl(a())&&(ee+=" "+Xl(a()));const q=await ln.getInventory(ee),he=De.parseInventoryData(q);De.updMovements(he)};return(()=>{var ee=Rx(),q=ee.firstChild,he=q.nextSibling,ve=he.firstChild,B=ve.firstChild,te=B.nextSibling,_e=te.firstChild,we=_e.nextSibling,me=we.nextSibling,be=me.nextSibling,ie=be.nextSibling,Pe=ve.nextSibling,Te=Pe.firstChild,$e=Te.nextSibling,Ee=Pe.nextSibling,Ve=Ee.firstChild,Ke=Ve.nextSibling,je=he.nextSibling,Ce=je.firstChild,Be=Ce.firstChild,Je=Be.nextSibling,Qe=Ce.nextSibling,We=Qe.firstChild,xe=We.nextSibling,at=Qe.nextSibling,et=at.firstChild,bt=et.nextSibling,ht=at.nextSibling,Nt=ht.firstChild,jt=Nt.nextSibling,Tt=ht.nextSibling,Bt=Tt.firstChild,gt=Bt.nextSibling,er=Tt.nextSibling,Ie=er.firstChild,St=Ie.nextSibling;return s(ee,(()=>{var Oe=ge(()=>!t.filterBy);return()=>Oe()&&(()=>{var Fe=Dx(),Ze=Fe.firstChild;return d(Fe,x),Ze.style.setProperty("margin","0"),Ze.style.setProperty("font-size","1.5rem"),s(Ze,()=>e("inventory.movements")),s(Fe,w(Le,{variant:"outline",onClick:se,get children(){return e("common.clearFilters")}}),null),Fe})()})(),q),s(ee,w(wx,{filters:{selectedLocation:o,movementType:a},onSearchResults:Oe=>{A(Oe),X(Oe)},get placeholder(){return e("inventory.searchProductsStock","Search inventories...")},showResults:!1,maxResults:20}),q),q.style.setProperty("margin","20px"),d(he,m),s(he,(()=>{var Oe=ge(()=>!t.filterBy);return()=>Oe()&&[(()=>{var Fe=im(),Ze=Fe.firstChild,rt=Ze.nextSibling,Ct=rt.firstChild;return Ze.style.setProperty("display","block"),Ze.style.setProperty("margin-bottom","0.5rem"),Ze.style.setProperty("font-weight","500"),s(Ze,()=>e("inventory.product")),rt.addEventListener("change",Xe=>n(Xe.target.value)),s(Ct,()=>e("inventory.allProducts")),s(rt,w(nt,{get each(){return De.products},children:Xe=>(()=>{var lt=Nx(),mt=lt.firstChild,At=mt.nextSibling;return At.nextSibling,s(lt,()=>Xe.name,mt),s(lt,()=>Xe.sku,At),le(()=>lt.value=Xe.id),lt})()}),null),le(Xe=>d(rt,re,Xe)),le(()=>rt.value=r()),Fe})(),(()=>{var Fe=im(),Ze=Fe.firstChild,rt=Ze.nextSibling,Ct=rt.firstChild;return Ze.style.setProperty("display","block"),Ze.style.setProperty("margin-bottom","0.5rem"),Ze.style.setProperty("font-weight","500"),s(Ze,()=>e("inventory.location")),rt.addEventListener("change",Xe=>i(Xe.target.value)),s(Ct,()=>e("inventory.allLocations")),s(rt,w(nt,{get each(){return De.locations},children:Xe=>(()=>{var lt=Lx();return s(lt,()=>Xe.name),le(()=>lt.value=Xe.id),lt})()}),null),le(Xe=>d(rt,re,Xe)),le(()=>rt.value=o()),Fe})()]})(),ve),B.style.setProperty("display","block"),B.style.setProperty("margin-bottom","0.5rem"),B.style.setProperty("font-weight","500"),s(B,()=>e("inventory.movementType")),te.addEventListener("change",Oe=>{c(Oe.target.value),X(_())}),s(_e,()=>e("inventory.allTypes")),s(we,()=>e("inventory.stockIn")),s(me,()=>e("inventory.stockOut")),s(be,()=>e("inventory.transfer")),s(ie,()=>e("inventory.adjustment")),Te.style.setProperty("display","block"),Te.style.setProperty("margin-bottom","0.5rem"),Te.style.setProperty("font-weight","500"),s(Te,()=>e("common.startDate")),$e.addEventListener("change",Oe=>h(Fe=>({...Fe,start:Oe.target.value}))),Ve.style.setProperty("display","block"),Ve.style.setProperty("margin-bottom","0.5rem"),Ve.style.setProperty("font-weight","500"),s(Ve,()=>e("common.endDate")),Ke.addEventListener("change",Oe=>h(Fe=>({...Fe,end:Oe.target.value}))),d(je,$),s(Be,()=>S().total),s(Je,()=>e("inventory.totalMovements")),s(We,()=>S().stockIn),s(xe,()=>e("inventory.stockIn")),s(et,()=>S().stockOut),s(bt,()=>e("inventory.stockOut")),s(Nt,()=>S().transfers),s(jt,()=>e("inventory.transfers")),s(Bt,()=>S().adjustments),s(gt,()=>e("inventory.adjustments")),s(Ie,()=>H(S().totalValue)),s(St,()=>e("inventory.totalValue")),s(ee,(()=>{var Oe=ge(()=>f().length===0);return()=>Oe()?(()=>{var Fe=Mx(),Ze=Fe.firstChild,rt=Ze.nextSibling,Ct=rt.nextSibling;return Fe.style.setProperty("text-align","center"),Fe.style.setProperty("padding","3rem"),Fe.style.setProperty("color","var(--text-muted)"),Fe.style.setProperty("background","var(--surface-color)"),Fe.style.setProperty("border-radius","var(--border-radius)"),Fe.style.setProperty("border","1px solid var(--border-color)"),Ze.style.setProperty("font-size","1.5rem"),Ze.style.setProperty("margin-bottom","1rem"),rt.style.setProperty("font-size","1.1rem"),rt.style.setProperty("margin-bottom","0.5rem"),s(rt,()=>e("inventory.noMovementsFound")),Ct.style.setProperty("font-size","0.875rem"),s(Ct,()=>e("inventory.tryAdjustingFilters")),Fe})():[w(nt,{get each(){return f()},children:Fe=>(()=>{var Ze=Ox(),rt=Ze.firstChild,Ct=rt.firstChild,Xe=Ct.firstChild,lt=Xe.firstChild,mt=lt.nextSibling,At=mt.nextSibling,Me=Xe.nextSibling,Jt=Me.firstChild,vt=Ct.nextSibling,_t=vt.firstChild,kt=_t.nextSibling,yt=kt.firstChild,Lt=yt.nextSibling;Lt.nextSibling;var pt=rt.nextSibling,Rt=pt.firstChild,Xt=Rt.firstChild,ur=Xt.firstChild,Tr=ur.firstChild,hr=ur.nextSibling,gn=Xt.nextSibling,On=gn.firstChild,Vo=On.firstChild,mo=On.nextSibling,yo=Rt.nextSibling,Vn=yo.firstChild,Fn=Vn.firstChild,As=Fn.firstChild,wi=Fn.nextSibling;return Ze.addEventListener("mouseleave",Pt=>{Pt.currentTarget.style.transform="translateY(0)",Pt.currentTarget.style.boxShadow="none"}),Ze.addEventListener("mouseenter",Pt=>{Pt.currentTarget.style.transform="translateY(-2px)",Pt.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),Ze.$$click=()=>pe(Fe),d(rt,j),Xe.style.setProperty("display","flex"),Xe.style.setProperty("align-items","center"),Xe.style.setProperty("gap","0.5rem"),Xe.style.setProperty("margin-bottom","0.5rem"),lt.style.setProperty("font-size","1.2rem"),s(lt,()=>ae(Fe.movementType)),mt.style.setProperty("margin","0"),mt.style.setProperty("font-size","1.1rem"),s(mt,()=>Fe.productName),s(At,()=>Fe.movementType),s(Xe,(()=>{var Pt=ge(()=>!!Fe.invoiceId);return()=>Pt()&&(()=>{var qt=Vx();return qt.style.setProperty("padding","0.2rem 0.5rem"),qt.style.setProperty("border-radius","var(--border-radius-sm)"),qt.style.setProperty("font-size","0.7rem"),qt.style.setProperty("font-weight","500"),qt.style.setProperty("background","var(--primary-color)"),qt.style.setProperty("color","white"),s(qt,()=>e("inventory.bulk")),qt})()})(),null),Me.style.setProperty("font-size","0.875rem"),Me.style.setProperty("color","var(--text-muted)"),s(Me,()=>Fe.productSku,Jt),s(Me,()=>U(Fe.createdDate),null),s(Me,(()=>{var Pt=ge(()=>!!Fe.invoiceId);return()=>Pt()&&(()=>{var qt=Fx(),Pr=qt.firstChild,Wr=Pr.nextSibling;return Wr.nextSibling,qt.style.setProperty("margin-left","0.5rem"),qt.style.setProperty("font-weight","500"),s(qt,()=>e("common.invoice"),Wr),s(qt,()=>Fe.invoiceId,null),qt})()})(),null),vt.style.setProperty("text-align","right"),_t.style.setProperty("font-size","1.25rem"),_t.style.setProperty("font-weight","700"),_t.style.setProperty("color","var(--primary-color)"),s(_t,()=>H(Fe.totalCost)),kt.style.setProperty("font-size","0.875rem"),kt.style.setProperty("color","var(--text-muted)"),s(kt,()=>Fe.quantity,yt),s(kt,()=>e("common.units"),Lt),s(kt,()=>H(Fe.unitCost),null),d(pt,ce),s(ur,()=>e("inventory.location"),Tr),s(hr,()=>Fe.locationName),s(Rt,(()=>{var Pt=ge(()=>!!Fe.fromLocationName);return()=>Pt()&&(()=>{var qt=sm(),Pr=qt.firstChild,Wr=Pr.firstChild,vn=Pr.nextSibling;return s(Pr,()=>e("common.from"),Wr),s(vn,()=>Fe.fromLocationName),le(Kt=>{var kr=T,en=G,tn=Z;return Kt.e=d(qt,kr,Kt.e),Kt.t=d(Pr,en,Kt.t),Kt.a=d(vn,tn,Kt.a),Kt},{e:void 0,t:void 0,a:void 0}),qt})()})(),gn),s(On,()=>e("common.reference"),Vo),s(mo,()=>Fe.referenceNumber),s(Fn,()=>e("common.createdBy"),As),s(wi,()=>Fe.createdBy),s(yo,(()=>{var Pt=ge(()=>!!Fe.notes);return()=>Pt()&&(()=>{var qt=sm(),Pr=qt.firstChild,Wr=Pr.firstChild,vn=Pr.nextSibling;return s(Pr,()=>e("common.notes"),Wr),s(vn,()=>Fe.notes),le(Kt=>{var kr={...T,"border-bottom":"none"},en=G,tn={...Z,"max-width":"200px","text-align":"right","font-style":"italic"};return Kt.e=d(qt,kr,Kt.e),Kt.t=d(Pr,en,Kt.t),Kt.a=d(vn,tn,Kt.a),Kt},{e:void 0,t:void 0,a:void 0}),qt})()})(),null),le(Pt=>{var qt={...D,"border-left":Fe.invoiceId?"4px solid var(--primary-color)":"1px solid var(--border-color)",cursor:"pointer"},Pr=W(Fe.movementType),Wr=T,vn=G,Kt=Z,kr=T,en=G,tn=Z,xs=T,Gt=G,Fo=Z;return Pt.e=d(Ze,qt,Pt.e),Pt.t=d(At,Pr,Pt.t),Pt.a=d(Xt,Wr,Pt.a),Pt.o=d(ur,vn,Pt.o),Pt.i=d(hr,Kt,Pt.i),Pt.n=d(gn,kr,Pt.n),Pt.s=d(On,en,Pt.s),Pt.h=d(mo,tn,Pt.h),Pt.r=d(Vn,xs,Pt.r),Pt.d=d(Fn,Gt,Pt.d),Pt.l=d(wi,Fo,Pt.l),Pt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),Ze})()}),ge(()=>ge(()=>C()>1)()&&(()=>{var Fe=Bx(),Ze=Fe.firstChild,rt=Ze.firstChild,Ct=rt.firstChild,Xe=rt.nextSibling,lt=Xe.nextSibling,mt=Ze.nextSibling,At=mt.firstChild,Me=At.firstChild,Jt=Me.firstChild,vt=Me.nextSibling,_t=vt.nextSibling,kt=_t.firstChild;return d(Fe,F),Ze.style.setProperty("display","flex"),Ze.style.setProperty("align-items","center"),Ze.style.setProperty("gap","0.5rem"),rt.style.setProperty("font-size","0.875rem"),rt.style.setProperty("color","var(--text-muted)"),s(rt,()=>e("common.showPerPage","Show per page"),Ct),Xe.addEventListener("change",yt=>{k(Number(yt.target.value)),R(1)}),Xe.style.setProperty("padding","0.25rem 0.5rem"),Xe.style.setProperty("border","1px solid var(--border-color)"),Xe.style.setProperty("border-radius","var(--border-radius-sm)"),Xe.style.setProperty("background","var(--surface-color)"),Xe.style.setProperty("cursor","pointer"),Xe.style.setProperty("font-size","0.875rem"),lt.style.setProperty("font-size","0.875rem"),lt.style.setProperty("color","var(--text-muted)"),lt.style.setProperty("margin-left","1rem"),s(lt,()=>e("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:(E()-1)*P()+1,end:Math.min(E()*P(),v().length),total:v().length})),mt.style.setProperty("display","flex"),mt.style.setProperty("align-items","center"),mt.style.setProperty("gap","0.5rem"),s(mt,w(Le,{variant:"outline",size:"sm",onClick:()=>R(1),get disabled(){return E()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.first","First")}}),At),s(mt,w(Le,{variant:"outline",size:"sm",onClick:()=>R(yt=>Math.max(1,yt-1)),get disabled(){return E()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.previous")}}),At),s(mt,()=>{const yt=[],Lt=C(),pt=E();if(Lt<=7)for(let Rt=1;Rt<=Lt;Rt++)yt.push(Rt);else{yt.push(1),pt>3&&yt.push("...");for(let Rt=Math.max(2,pt-1);Rt<=Math.min(Lt-1,pt+1);Rt++)yt.includes(Rt)||yt.push(Rt);pt<Lt-2&&yt.push("..."),yt.includes(Lt)||yt.push(Lt)}return w(nt,{each:yt,children:Rt=>Rt==="..."?(()=>{var Xt=Ux();return Xt.style.setProperty("padding","0 0.5rem"),Xt.style.setProperty("color","var(--text-muted)"),Xt})():(()=>{var Xt=jx();return Xt.$$click=()=>R(Rt),s(Xt,Rt),le(ur=>d(Xt,ne(Rt===E()),ur)),Xt})()})},At),s(mt,w(Le,{variant:"outline",size:"sm",onClick:()=>R(yt=>Math.min(C(),yt+1)),get disabled(){return E()===C()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.next")}}),At),s(mt,w(Le,{variant:"outline",size:"sm",onClick:()=>R(C()),get disabled(){return E()===C()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.last","Last")}}),At),At.style.setProperty("display","flex"),At.style.setProperty("align-items","center"),At.style.setProperty("gap","0.5rem"),At.style.setProperty("margin-left","1rem"),Me.style.setProperty("font-size","0.875rem"),Me.style.setProperty("color","var(--text-muted)"),s(Me,()=>e("common.page","Page"),Jt),vt.addEventListener("change",yt=>{const Lt=Number(yt.target.value);Lt>=1&&Lt<=C()&&R(Lt)}),vt.style.setProperty("width","4rem"),vt.style.setProperty("padding","0.25rem 0.5rem"),vt.style.setProperty("border","1px solid var(--border-color)"),vt.style.setProperty("border-radius","var(--border-radius-sm)"),vt.style.setProperty("background","var(--surface-color)"),vt.style.setProperty("text-align","center"),vt.style.setProperty("font-size","0.875rem"),_t.style.setProperty("font-size","0.875rem"),_t.style.setProperty("color","var(--text-muted)"),s(_t,()=>e("common.of","of"),kt),s(_t,C,null),le(()=>ct(vt,"max",C())),le(()=>Xe.value=P()),le(()=>vt.value=E()),Fe})())]})(),null),s(ee,w(Ix,{get isOpen(){return O()},onClose:()=>{M(!1),oe(null)},get movement(){return K()},onEdit:de}),null),s(ee,w(Re,{get when(){return wt.hasPermission("read_write")},get children(){return w(kx,{get isOpen(){return N()},onClose:()=>{g(!1),oe(null)},get movement(){return K()},onMovementUpdated:ye})}}),null),le(Oe=>{var Fe=re,Ze=Y,rt=Y,Ct=V,Xe=Q,lt=L,mt=V,At={...Q,color:"#2d7d32"},Me=L,Jt=V,vt={...Q,color:"#d32f2f"},_t=L,kt=V,yt={...Q,color:"#1976d2"},Lt=L,pt=V,Rt={...Q,color:"#f57c00"},Xt=L,ur=V,Tr=Q,hr=L;return Oe.e=d(te,Fe,Oe.e),Oe.t=d($e,Ze,Oe.t),Oe.a=d(Ke,rt,Oe.a),Oe.o=d(Ce,Ct,Oe.o),Oe.i=d(Be,Xe,Oe.i),Oe.n=d(Je,lt,Oe.n),Oe.s=d(Qe,mt,Oe.s),Oe.h=d(We,At,Oe.h),Oe.r=d(xe,Me,Oe.r),Oe.d=d(at,Jt,Oe.d),Oe.l=d(et,vt,Oe.l),Oe.u=d(bt,_t,Oe.u),Oe.c=d(ht,kt,Oe.c),Oe.w=d(Nt,yt,Oe.w),Oe.m=d(jt,Lt,Oe.m),Oe.f=d(Tt,pt,Oe.f),Oe.y=d(Bt,Rt,Oe.y),Oe.g=d(gt,Xt,Oe.g),Oe.p=d(er,ur,Oe.p),Oe.b=d(Ie,Tr,Oe.b),Oe.T=d(St,hr,Oe.T),Oe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),le(()=>te.value=a()),le(()=>$e.value=u().start),le(()=>Ke.value=u().end),ee})()};ft(["click"]);var qx=z("<div><p>📋 "),Gx=z("<div>"),Hx=z("<div><div>📊</div><h3></h3><p></p><div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=name></option><option value=sku></option><option value=category>"),Wx=z("<div><div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div>%</div><div></div></div></div><div></div><div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),Yx=z("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),Kx=z("<div><div>✅</div><h3></h3><p>"),Qx=z("<div><div><h3>📋 </h3><p></p></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div></div><div>"),Jx=z("<div><div><div><h2>📋 </h2><button>×"),am=z("<option>"),Xx=z("<div>..."),Zx=z("<tr><td><div></div><div> • </div></td><td><div></div></td><td><div></div></td><td><div></div></td><td><div>"),eI=z("<tr><td><div></div></td><td><div></div><div> • <!> • </div></td><td><div></div></td><td><input type=number placeholder=0 min=0 step=0.01></td><td><div></div></td><td><input type=text>");const tI=t=>{const{t:e}=it(),[r,n]=fe([]),[o,i]=fe(!1),[a,c]=fe(!1),[u,h]=fe("all"),[y,b]=fe("all"),[_,A]=fe("name"),[E,R]=fe([]),[P,k]=fe("setup"),K=async()=>{try{i(!0);const L=await ln.getProducts("prod");if(!L||typeof L!="object"){console.warn("No API results, using local store"),n(De.products);return}const D=Object.keys(L),j=W=>{let T=L[W];return{id:W,name:T.name||"Unknown Product",businessId:T.businessId||"",sku:T.code||T.sku||"",UPC:T.UPC||"",numCode:T.codeN||"",category:T.category||"General",unitCost:T.unitCost||0,unitOfMeasure:T.unitOfMeasure||"pcs",minStockLevel:T.minStockLevel||0,maxStockLevel:T.maxStockLevel||100,isActive:T.isActive!==!1,description:T.description||"",createdDate:T.createdAt||new Date().toISOString(),lastModified:T.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(T.sellingPrice||T.price||"0")}},ue=D.map(j);n(ue)}catch(L){console.error("Failed to load products from API:",L),n(De.products)}finally{i(!1)}},oe=ze(()=>[...new Set(r().map(D=>D.category).filter(D=>D))].sort()),O=ze(()=>{let L=r().filter(D=>D.isActive);return y()!=="all"&&(L=L.filter(D=>D.category===y())),L.sort((D,j)=>{switch(_()){case"name":return D.name.localeCompare(j.name);case"sku":return D.sku.localeCompare(j.sku);case"category":return D.category.localeCompare(j.category)||D.name.localeCompare(j.name);default:return 0}}),L}),M=ze(()=>De.getActiveLocations()),N=(L,D)=>D&&D!=="all"?De.getStockByProductAndLocation(L,D)?.quantity||0:De.getTotalStockByProduct(L),g=()=>{const L=O().map(D=>{const j=N(D.id,u()!=="all"?u():void 0);return{productId:D.id,systemQuantity:j,physicalCount:null,notes:"",variance:0,product:D}});R(L),k("counting")},v=(L,D)=>{R(j=>j.map(ue=>{if(ue.productId===L){const W=D,ce=W!==null?W-ue.systemQuantity:0;return{...ue,physicalCount:W,variance:ce}}return ue}))},f=(L,D)=>{R(j=>j.map(ue=>ue.productId===L?{...ue,notes:D}:ue))},C=ze(()=>{const L=E(),D=L.length,j=L.filter(T=>T.physicalCount!==null).length,ue=L.filter(T=>T.variance!==0).length,W=L.filter(T=>T.variance>0).length,ce=L.filter(T=>T.variance<0).length;return{totalProducts:D,countedProducts:j,remainingProducts:D-j,variances:ue,positiveVariances:W,negativeVariances:ce,isComplete:j===D}}),S=()=>{const L=E().filter(W=>W.physicalCount!==null&&W.variance!==0);if(L.length===0)return null;const D=[e("inventory.product","Product"),e("inventory.sku","SKU"),e("inventory.category","Category"),e("inventory.location","Location"),e("inventory.systemQty","System Qty"),e("inventory.physicalCount","Physical Count"),e("inventory.variance","Variance"),e("inventory.adjustment","Adjustment"),e("common.notes","Notes"),e("common.date","Date")],j=L.map(W=>[`"${W.product.name}"`,`"${W.product.sku}"`,`"${W.product.category}"`,`"${re()}"`,W.systemQuantity,W.physicalCount,W.variance,W.variance>0?e("inventory.stockIncrease","Stock Increase"):e("inventory.stockDecrease","Stock Decrease"),`"${W.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")}"`,`"${Y()}"`]);return[D.join(","),...j.map(W=>W.join(","))].join(`
`)},x=()=>{const L=S();if(!L){alert(e("inventory.noAdjustmentsToDownload","No adjustments to download"));return}const D=new Blob([L],{type:"text/csv;charset=utf-8;"}),j=document.createElement("a");if(j.download!==void 0){const ue=URL.createObjectURL(D);j.setAttribute("href",ue),j.setAttribute("download",`inventory-adjustments-${Y().replace(/[/:,\s]/g,"-")}.csv`),j.style.visibility="hidden",document.body.appendChild(j),j.click(),document.body.removeChild(j)}},m=async(L=!0)=>{try{c(!0),console.log(E());const D=G=>{let Z=De.getProductById(G.productId),F=De.getStockByProductAndLocation(G.productId,u()),ne=parseFloat(F?.averageCost+""),H=parseFloat(F?.quantity+"");return{product:{id:G.productId,label:Z?.name,code:Z?.code},productId:G?.productId,reason:"Physical Count Adjustment",notes:G?.notes||"Physical inventory adjustment",quantity:G?.variance,unitCost:ne}},j=E().filter(G=>G.physicalCount!==null&&G.variance!==0).map(D);let ue="ADJ_"+hu();const W=new Date().toISOString(),ce={ssg_inventory_key:Zm(),invoiceId:ue,referenceNumber:hu(),movementType:"adjustment",type:"adjustment",locationId:u(),items:j,products:j,generalNotes:"Physical inventory adjustment",description:"Physical Count Adjustment",invoice:ue,store:u(),createdBy:"admin",createDate:W};console.log("Saving inventory bulkRequest:",ce);const T=await ln.addInventory(ce);L&&j.length>0&&x(),console.log("Saving inventory adjustments:",j),await new Promise(G=>setTimeout(G,1e3)),t.onClose()}catch(D){console.error("Failed to save inventory adjustments:",D)}finally{c(!1)}},re=ze(()=>u()==="all"?"All Locations":M().find(D=>D.id===u())?.name||"Unknown Location"),Y=()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),$=async()=>{await De.fecthInventory("prod"),await K()};Hr(async()=>{t.selectedLocationId&&h(t.selectedLocationId),$()});const V=()=>{const L=window.open("","_blank");if(!L){alert("Please allow pop-ups to print the counting sheet");return}const D=Q();L.document.write(D),L.document.close(),L.onload=()=>{L.print(),L.onafterprint=()=>{L.close()}}},Q=()=>{const L=O().map((D,j)=>{const ue=N(D.id,u()!=="all"?u():void 0);return`
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${j+1}</td>
          <td style="border: 1px solid #000; padding: 8px; font-family: monospace;">${D.sku}</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 500;">${D.name}</div>
            ${D.UPC?`<div style="font-size: 0.8em; color: #666;">UPC: ${D.UPC}</div>`:""}
          </td>
         
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${D.unitOfMeasure}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">${ue}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; background-color: #f9f9f9;"></td>
          <td style="border: 1px solid #000; padding: 8px;"></td>
        </tr>
      `}).join("");return`
      <!DOCTYPE html>
      <html>
      <head>
        <title> ${re()}_${y()}_${e("inventory.countingSheet","Inventory Counting Sheet")} - ${Y()}</title>
        <style>
          @page {
            size: letter;
            margin: 0.5in 0.8in 0.5in 0.8in;
            @top-center {
              content: "${re()} | ${y()==="all"?e("inventory.allCategories","All Categories"):y()} | Page " counter(page);
              font-size: 10px;
              font-weight: bold;
              border-bottom: 1px solid #ccc;
              padding-bottom: 5px;
            }
          }
          body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            margin: 0;
            padding: 0;
            position: relative;
          }
          .page-identifier {
            position: fixed;
            left: 5px;
            top: 50%;
            transform: rotate(-90deg) translateX(-50%);
            transform-origin: left center;
            background: #f0f0f0;
            padding: 5px 15px;
            border: 1px solid #ccc;
            font-weight: bold;
            font-size: 10px;
            color: #333;
            z-index: 100;
          }
          .page-identifier-right {
            position: fixed;
            right: 5px;
            top: 50%;
            transform: rotate(90deg) translateX(50%);
            transform-origin: right center;
            background: #f0f0f0;
            padding: 5px 15px;
            border: 1px solid #ccc;
            font-weight: bold;
            font-size: 10px;
            color: #333;
            z-index: 100;
          }
          h1 {
            text-align: center;
            margin: 0 0 10px 0;
            font-size: 22px;
            page-break-after: avoid;
          }
          .header-info {
            text-align: center;
            margin-bottom: 20px;
            background: #f8f8f8;
            padding: 10px;
            border: 2px solid #333;
            page-break-after: avoid;
          }
          .page-header {
            display: none;
            text-align: center;
            background: #e0e0e0;
            padding: 8px;
            border: 1px solid #333;
            margin-bottom: 10px;
            font-weight: bold;
            font-size: 11px;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
          }
          th {
            background-color: #333;
            color: white;
            padding: 8px;
            text-align: left;
            font-weight: bold;
            border: 1px solid #000;
          }
          .summary-table {
            width: 50%;
            margin: 20px auto;
            /*page-break-before: auto;*/
          }
          .signature-section {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
            page-break-before: auto;
          }
          .signature-box {
            width: 45%;
            text-align: center;
          }
          .signature-line {
            border-bottom: 1px solid #000;
            margin-bottom: 5px;
            height: 30px;
          }
          @media print {
            body { margin: 0; }
            .page-identifier, .page-identifier-right { display: block; }
            .page-header { display: block; }
            tr { page-break-inside: avoid; }
            thead { display: table-header-group; }
            tfoot { display: table-footer-group; }
            .header-info { page-break-after: avoid; }
            h1 { page-break-after: avoid; }
            table { page-break-before: auto; }
            /*.summary-table { page-break-before: always; }*/
            .signature-section { page-break-before: avoid; }
            
            /* Repeat headers on each page */
            @page :first {
              @top-center { content: none; }
            }
            
            /* Force page headers to show on continuation pages */
            tbody::before {
              content: "";
              display: block;
              height: 0;
            }
          }
        </style>
      </head>
      <body>
        <!-- Page identifiers for multi-page documents -->
        <div class="page-identifier-right">
          ${re()} - ${y()==="all"?e("inventory.allCategories","All Categories"):y()} - ${Y()} 
        </div>
       
        
        <h1>${e("inventory.inventoryCountingSheetTitle","INVENTORY COUNTING SHEET")}</h1>
        <div class="header-info">
          <p><strong>${e("inventory.location","Location")}:</strong> ${re()}</p>
          <p><strong>${e("common.category","Category")}:</strong> ${y()==="all"?e("inventory.allCategories","All Categories"):y()}</p>
          <p><strong>${e("common.date","Date")}:</strong> ${Y()}</p>
          <p style="margin-top: 10px;">
            <span style="margin-right: 30px;">${e("inventory.countedBy","Counted by")}: _________________________</span>
            <span>${e("inventory.verifiedBy","Verified by")}: _________________________</span>
          </p>
        </div>

        <!-- Page header for continuation pages (hidden on first page) -->
        <div class="page-header">
          ${re()} | ${y()==="all"?e("inventory.allCategories","All Categories"):y()} | ${Y()} 
        </div>

        <table>
          <thead>
            <tr>
              <th style="width: 5%; text-align: center;">#</th>
              <th style="width: 12%;">${e("inventory.sku","SKU")}</th>
              <th style="width: 25%;">${e("inventory.productName","Product Name")}</th>
              <th style="width: 8%; text-align: center;">${e("inventory.unit","Unit")}</th>
              <th style="width: 10%; text-align: center;">${e("inventory.systemQty","System Qty")}</th>
              <th style="width: 12%; text-align: center; background-color: #f0f0f0;">${e("inventory.physicalCount","Physical Count")}</th>
              <th style="width: 28%;">${e("common.notes","Notes")}</th>
            </tr>
            <!-- Repeat header info row for clarity -->
            <tr style="background-color: #f8f8f8; font-size: 10px;">
              <td colspan="8" style="text-align: center; padding: 4px; border: 1px solid #000; font-weight: bold;">
                📍 ${re()} | 📂 ${y()==="all"?e("inventory.allCategories","All Categories"):y()} | 📅 ${Y()}
              </td>
            </tr>
          </thead>
          <tbody>
            ${L}
          </tbody>
        </table>
        
        <!-- Summary section with location/category context -->
        <div style="margin: 30px 0; padding: 15px; background: #f8f8f8;">
          <h3 style="text-align: center; margin: 0 0 15px 0; font-size: 16px;">
            ${e("inventory.summaryFor","SUMMARY FOR")}: ${re()} - ${y()==="all"?e("inventory.allCategories","All Categories"):y()}
          </h3>
          
          <table class="summary-table">
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.totalProductsListed","Total Products Listed")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">
                ${O().length}
              </td>
            </tr>
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.itemsCounted","Items Counted")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center;">
                ___________
              </td>
            </tr>
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.discrepanciesFound","Discrepancies Found")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center;">
                ___________
              </td>
            </tr>
          </table>
        </div>
        
        <div class="signature-section">
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.counterSignature","Counter Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.supervisorSignature","Supervisor Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
        </div>
      </body>
      </html>
    `};return w(Re,{get when(){return t.isOpen},get children(){var L=Jx(),D=L.firstChild,j=D.firstChild,ue=j.firstChild;ue.firstChild;var W=ue.nextSibling;return L.style.setProperty("position","fixed"),L.style.setProperty("top","0"),L.style.setProperty("left","0"),L.style.setProperty("right","0"),L.style.setProperty("bottom","0"),L.style.setProperty("background","rgba(0, 0, 0, 0.5)"),L.style.setProperty("z-index","1000"),L.style.setProperty("display","flex"),L.style.setProperty("align-items","center"),L.style.setProperty("justify-content","center"),D.style.setProperty("background","white"),D.style.setProperty("border-radius","var(--border-radius)"),D.style.setProperty("padding","2rem"),D.style.setProperty("width","95%"),D.style.setProperty("height","95%"),D.style.setProperty("max-width","1400px"),D.style.setProperty("overflow-y","auto"),D.style.setProperty("position","relative"),j.style.setProperty("display","flex"),j.style.setProperty("justify-content","space-between"),j.style.setProperty("align-items","center"),j.style.setProperty("margin-bottom","2rem"),j.style.setProperty("border-bottom","1px solid var(--border-color)"),j.style.setProperty("padding-bottom","1rem"),ue.style.setProperty("margin","0"),ue.style.setProperty("font-size","1.5rem"),s(ue,()=>e("inventory.physicalInventoryCount","Physical Inventory Count"),null),Ln(W,"click",t.onClose,!0),W.style.setProperty("background","none"),W.style.setProperty("border","none"),W.style.setProperty("font-size","1.5rem"),W.style.setProperty("cursor","pointer"),W.style.setProperty("padding","0.5rem"),s(D,w(Re,{get when(){return P()==="setup"},get children(){var ce=Hx(),T=ce.firstChild,G=T.nextSibling,Z=G.nextSibling,F=Z.nextSibling,ne=F.firstChild,H=ne.firstChild,U=H.firstChild,ae=H.nextSibling,se=ae.firstChild,pe=ne.nextSibling,de=pe.firstChild,ye=de.firstChild,X=de.nextSibling,ee=X.firstChild,q=pe.nextSibling,he=q.firstChild,ve=he.firstChild,B=he.nextSibling,te=B.firstChild,_e=te.nextSibling,we=_e.nextSibling;return ce.style.setProperty("text-align","center"),ce.style.setProperty("padding","2rem"),ce.style.setProperty("max-width","600px"),ce.style.setProperty("margin","0 auto"),T.style.setProperty("font-size","3rem"),T.style.setProperty("margin-bottom","1rem"),G.style.setProperty("margin-bottom","1rem"),s(G,()=>e("inventory.setupPhysicalCount","Setup Physical Inventory Count")),Z.style.setProperty("margin-bottom","2rem"),Z.style.setProperty("color","var(--text-muted)"),s(Z,()=>e("inventory.setupDescription","Configure your physical inventory count settings and begin the counting process.")),F.style.setProperty("display","grid"),F.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),F.style.setProperty("gap","1rem"),F.style.setProperty("margin-bottom","2rem"),F.style.setProperty("padding","1rem"),F.style.setProperty("background","var(--surface-color)"),F.style.setProperty("border-radius","var(--border-radius)"),F.style.setProperty("text-align","left"),H.style.setProperty("display","block"),H.style.setProperty("margin-bottom","0.5rem"),H.style.setProperty("font-weight","500"),s(H,()=>e("inventory.location","Location"),U),ae.addEventListener("change",me=>h(me.target.value)),ae.style.setProperty("width","100%"),ae.style.setProperty("padding","0.5rem"),ae.style.setProperty("border","1px solid var(--border-color)"),ae.style.setProperty("border-radius","var(--border-radius-sm)"),s(se,()=>e("inventory.allLocations","All Locations")),s(ae,w(nt,{get each(){return M()},children:me=>(()=>{var be=am();return s(be,()=>me.name),le(()=>be.value=me.id),be})()}),null),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),s(de,()=>e("inventory.category","Category"),ye),X.addEventListener("change",me=>b(me.target.value)),X.style.setProperty("width","100%"),X.style.setProperty("padding","0.5rem"),X.style.setProperty("border","1px solid var(--border-color)"),X.style.setProperty("border-radius","var(--border-radius-sm)"),s(ee,()=>e("products.allCategories","All Categories")),s(X,w(nt,{get each(){return oe()},children:me=>(()=>{var be=am();return be.value=me,s(be,me),be})()}),null),he.style.setProperty("display","block"),he.style.setProperty("margin-bottom","0.5rem"),he.style.setProperty("font-weight","500"),s(he,()=>e("inventory.sortBy","Sort By"),ve),B.addEventListener("change",me=>A(me.target.value)),B.style.setProperty("width","100%"),B.style.setProperty("padding","0.5rem"),B.style.setProperty("border","1px solid var(--border-color)"),B.style.setProperty("border-radius","var(--border-radius-sm)"),s(te,()=>e("inventory.productName","Product Name")),s(_e,()=>e("inventory.sku","SKU")),s(we,()=>e("inventory.category","Category")),s(ce,w(Re,{get when(){return!o()},get fallback(){return(()=>{var me=Xx(),be=me.firstChild;return me.style.setProperty("padding","2rem"),s(me,()=>e("common.loading","Loading"),be),me})()},get children(){return[(()=>{var me=qx(),be=me.firstChild;return be.firstChild,me.style.setProperty("padding","1rem"),me.style.setProperty("background","#fff3cd"),me.style.setProperty("border-radius","var(--border-radius-sm)"),me.style.setProperty("margin-bottom","2rem"),be.style.setProperty("margin","0"),be.style.setProperty("color","#856404"),s(be,()=>e("inventory.countWillInclude","This count will include {{count}} products from {{location}} in {{category}} category.",{count:O().length,location:re(),category:y()==="all"?e("inventory.allCategories","all categories"):y()}),null),me})(),w(Re,{get when(){return ge(()=>y()!=="all")()&&u()!=="all"},get children(){var me=Gx();return me.style.setProperty("display","grid"),me.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),me.style.setProperty("gap","1rem"),me.style.setProperty("margin-bottom","2rem"),me.style.setProperty("padding","1rem"),me.style.setProperty("background","var(--surface-color)"),me.style.setProperty("border-radius","var(--border-radius)"),s(me,w(Re,{get when(){return wt.hasPermission("physicalInventoryCountingForm")},get children(){return w(Le,{variant:"primary",size:"large",onClick:g,get disabled(){return o()||O().length===0},get children(){return["🚀 ",ge(()=>e("inventory.startCounting","Start Physical Count"))]}})}}),null),s(me,w(Le,{variant:"primary",onClick:V,get disabled(){return o()},get children(){return["🖨️ ",ge(()=>e("common.print","Print"))]}}),null),me}})]}}),null),le(()=>ae.value=u()),le(()=>X.value=y()),le(()=>B.value=_()),ce}}),null),s(D,w(Re,{get when(){return P()==="counting"},get children(){var ce=Wx(),T=ce.firstChild,G=T.nextSibling,Z=G.firstChild,F=Z.firstChild,ne=F.nextSibling,H=Z.nextSibling,U=H.firstChild,ae=U.nextSibling,se=H.nextSibling,pe=se.firstChild,de=pe.nextSibling,ye=se.nextSibling,X=ye.firstChild,ee=X.firstChild,q=X.nextSibling,he=G.nextSibling,ve=he.nextSibling,B=ve.firstChild,te=B.firstChild,_e=te.firstChild,we=_e.firstChild,me=we.nextSibling,be=me.nextSibling,ie=be.nextSibling,Pe=ie.nextSibling,Te=Pe.nextSibling,$e=te.nextSibling;return T.style.setProperty("display","grid"),T.style.setProperty("grid-template-columns","repeat(auto-fit)"),T.style.setProperty("gap","1rem"),T.style.setProperty("margin-bottom","2rem"),T.style.setProperty("padding","1rem"),T.style.setProperty("background","var(--surface-color)"),T.style.setProperty("border-radius","var(--border-radius)"),s(T,re),G.style.setProperty("display","grid"),G.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),G.style.setProperty("gap","1rem"),G.style.setProperty("margin-bottom","2rem"),G.style.setProperty("padding","1rem"),G.style.setProperty("background","var(--surface-color)"),G.style.setProperty("border-radius","var(--border-radius)"),Z.style.setProperty("text-align","center"),F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","700"),F.style.setProperty("color","var(--primary-color)"),s(F,()=>C().countedProducts),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-muted)"),s(ne,()=>e("inventory.counted","Counted")),H.style.setProperty("text-align","center"),U.style.setProperty("font-size","1.5rem"),U.style.setProperty("font-weight","700"),U.style.setProperty("color","#ff9800"),s(U,()=>C().remainingProducts),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),s(ae,()=>e("inventory.remaining","Remaining")),se.style.setProperty("text-align","center"),pe.style.setProperty("font-size","1.5rem"),pe.style.setProperty("font-weight","700"),pe.style.setProperty("color","#f44336"),s(pe,()=>C().variances),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("color","var(--text-muted)"),s(de,()=>e("inventory.variances","Variances")),ye.style.setProperty("text-align","center"),X.style.setProperty("font-size","1.5rem"),X.style.setProperty("font-weight","700"),s(X,()=>Math.round(C().countedProducts/C().totalProducts*100),ee),q.style.setProperty("font-size","0.875rem"),q.style.setProperty("color","var(--text-muted)"),s(q,()=>e("inventory.complete","Complete")),he.style.setProperty("display","flex"),he.style.setProperty("gap","1rem"),he.style.setProperty("margin-bottom","2rem"),he.style.setProperty("justify-content","center"),s(he,w(Le,{variant:"outline",onClick:()=>k("setup"),get children(){return["⬅️ ",ge(()=>e("common.back","Back to Setup"))]}}),null),s(he,w(Le,{variant:"primary",onClick:()=>k("review"),get children(){return["📋 ",ge(()=>e("inventory.reviewAdjustments","Review Adjustments"))]}}),null),ve.style.setProperty("border","1px solid var(--border-color)"),ve.style.setProperty("border-radius","var(--border-radius)"),ve.style.setProperty("overflow-x","auto"),B.style.setProperty("width","100%"),B.style.setProperty("border-collapse","collapse"),_e.style.setProperty("background","var(--surface-color)"),we.style.setProperty("padding","1rem"),we.style.setProperty("text-align","left"),we.style.setProperty("border-bottom","1px solid var(--border-color)"),s(we,()=>e("inventory.no","No")),me.style.setProperty("padding","1rem"),me.style.setProperty("text-align","left"),me.style.setProperty("border-bottom","1px solid var(--border-color)"),s(me,()=>e("inventory.product","Product")),be.style.setProperty("padding","1rem"),be.style.setProperty("text-align","center"),be.style.setProperty("border-bottom","1px solid var(--border-color)"),s(be,()=>e("inventory.systemQty","System Qty")),ie.style.setProperty("padding","1rem"),ie.style.setProperty("text-align","center"),ie.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ie,()=>e("inventory.physicalCount","Physical Count")),Pe.style.setProperty("padding","1rem"),Pe.style.setProperty("text-align","center"),Pe.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Pe,()=>e("inventory.variance","Variance")),Te.style.setProperty("padding","1rem"),Te.style.setProperty("text-align","left"),Te.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Te,()=>e("common.notes","Notes")),s($e,w(nt,{get each(){return E()},children:(Ee,Ve)=>w(rI,{get index(){return Ve()},updatePhysicalCount:v,entry:Ee,updateNotes:f})})),le(Ee=>(Ee=C().isComplete?"#4caf50":"#ff9800")!=null?X.style.setProperty("color",Ee):X.style.removeProperty("color")),ce}}),null),s(D,w(Re,{get when(){return P()==="review"},get children(){var ce=Qx(),T=ce.firstChild,G=T.firstChild;G.firstChild;var Z=G.nextSibling,F=T.nextSibling,ne=F.firstChild,H=ne.firstChild,U=H.nextSibling,ae=ne.nextSibling,se=ae.firstChild,pe=se.nextSibling,de=ae.nextSibling,ye=de.firstChild,X=ye.nextSibling,ee=F.nextSibling;return T.style.setProperty("text-align","center"),T.style.setProperty("margin-bottom","2rem"),G.style.setProperty("margin-bottom","1rem"),s(G,()=>e("inventory.reviewAndConfirm","Review and Confirm Adjustments"),null),Z.style.setProperty("color","var(--text-muted)"),s(Z,()=>e("inventory.reviewDescription","Review the inventory adjustments below and confirm to update your system.")),F.style.setProperty("display","grid"),F.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),F.style.setProperty("gap","1rem"),F.style.setProperty("margin-bottom","2rem"),F.style.setProperty("padding","1rem"),F.style.setProperty("background","var(--surface-color)"),F.style.setProperty("border-radius","var(--border-radius)"),ne.style.setProperty("text-align","center"),H.style.setProperty("font-size","1.5rem"),H.style.setProperty("font-weight","700"),H.style.setProperty("color","#4caf50"),s(H,()=>C().positiveVariances),U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-muted)"),s(U,()=>e("inventory.stockIncreases","Stock Increases")),ae.style.setProperty("text-align","center"),se.style.setProperty("font-size","1.5rem"),se.style.setProperty("font-weight","700"),se.style.setProperty("color","#f44336"),s(se,()=>C().negativeVariances),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),s(pe,()=>e("inventory.stockDecreases","Stock Decreases")),de.style.setProperty("text-align","center"),ye.style.setProperty("font-size","1.5rem"),ye.style.setProperty("font-weight","700"),ye.style.setProperty("color","var(--primary-color)"),s(ye,()=>C().variances),X.style.setProperty("font-size","0.875rem"),X.style.setProperty("color","var(--text-muted)"),s(X,()=>e("inventory.totalAdjustments","Total Adjustments")),ee.style.setProperty("display","flex"),ee.style.setProperty("gap","1rem"),ee.style.setProperty("margin-bottom","2rem"),ee.style.setProperty("justify-content","center"),ee.style.setProperty("flex-wrap","wrap"),s(ee,w(Le,{variant:"outline",onClick:()=>k("counting"),get children(){return["⬅️ ",ge(()=>e("common.back","Back to Counting"))]}}),null),s(ee,w(Le,{variant:"outline",onClick:x,get disabled(){return C().variances===0},get children(){return["📥 ",ge(()=>e("inventory.downloadCSV","Download CSV"))]}}),null),s(ee,w(Le,{variant:"primary",onClick:m,get disabled(){return a()||C().variances===0},get children(){return ge(()=>!!a())()?"💾 "+e("common.saving","Saving")+"...":"✅ "+e("inventory.confirmAdjustments","Confirm Adjustments")}}),null),s(ce,w(Re,{get when(){return C().variances>0},get children(){var q=Yx(),he=q.firstChild,ve=he.firstChild,B=ve.firstChild,te=B.firstChild,_e=te.nextSibling,we=_e.nextSibling,me=we.nextSibling,be=me.nextSibling,ie=ve.nextSibling;return q.style.setProperty("border","1px solid var(--border-color)"),q.style.setProperty("border-radius","var(--border-radius)"),q.style.setProperty("overflow-x","auto"),he.style.setProperty("width","100%"),he.style.setProperty("border-collapse","collapse"),B.style.setProperty("background","var(--surface-color)"),te.style.setProperty("padding","1rem"),te.style.setProperty("text-align","left"),te.style.setProperty("border-bottom","1px solid var(--border-color)"),s(te,()=>e("inventory.product","Product")),_e.style.setProperty("padding","1rem"),_e.style.setProperty("text-align","center"),_e.style.setProperty("border-bottom","1px solid var(--border-color)"),s(_e,()=>e("inventory.systemQty","System Qty")),we.style.setProperty("padding","1rem"),we.style.setProperty("text-align","center"),we.style.setProperty("border-bottom","1px solid var(--border-color)"),s(we,()=>e("inventory.physicalCount","Physical Count")),me.style.setProperty("padding","1rem"),me.style.setProperty("text-align","center"),me.style.setProperty("border-bottom","1px solid var(--border-color)"),s(me,()=>e("inventory.adjustment","Adjustment")),be.style.setProperty("padding","1rem"),be.style.setProperty("text-align","left"),be.style.setProperty("border-bottom","1px solid var(--border-color)"),s(be,()=>e("common.notes","Notes")),s(ie,w(nt,{get each(){return E().filter(Pe=>Pe.variance!==0)},children:Pe=>(()=>{var Te=Zx(),$e=Te.firstChild,Ee=$e.firstChild,Ve=Ee.nextSibling,Ke=Ve.firstChild,je=$e.nextSibling,Ce=je.firstChild,Be=je.nextSibling,Je=Be.firstChild,Qe=Be.nextSibling,We=Qe.firstChild,xe=Qe.nextSibling,at=xe.firstChild;return Te.style.setProperty("border-bottom","1px solid var(--border-color)"),$e.style.setProperty("padding","1rem"),Ee.style.setProperty("font-weight","500"),s(Ee,()=>Pe.product.name),Ve.style.setProperty("font-size","0.875rem"),Ve.style.setProperty("color","var(--text-muted)"),s(Ve,()=>Pe.product.sku,Ke),s(Ve,()=>Pe.product.category,null),je.style.setProperty("padding","1rem"),je.style.setProperty("text-align","center"),Ce.style.setProperty("font-weight","600"),s(Ce,()=>Pe.systemQuantity),Be.style.setProperty("padding","1rem"),Be.style.setProperty("text-align","center"),Je.style.setProperty("font-weight","600"),s(Je,()=>Pe.physicalCount),Qe.style.setProperty("padding","1rem"),Qe.style.setProperty("text-align","center"),We.style.setProperty("font-weight","700"),s(We,()=>Pe.variance>0?"+":"",null),s(We,()=>Pe.variance,null),xe.style.setProperty("padding","1rem"),at.style.setProperty("font-size","0.875rem"),s(at,()=>Pe.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")),le(et=>{var bt=Pe.variance>0?"#d4edda":"#f8d7da",ht=Pe.variance>0?"#4caf50":"#f44336";return bt!==et.e&&((et.e=bt)!=null?Te.style.setProperty("background",bt):Te.style.removeProperty("background")),ht!==et.t&&((et.t=ht)!=null?We.style.setProperty("color",ht):We.style.removeProperty("color")),et},{e:void 0,t:void 0}),Te})()})),q}}),null),s(ce,w(Re,{get when(){return C().variances===0},get children(){var q=Kx(),he=q.firstChild,ve=he.nextSibling,B=ve.nextSibling;return q.style.setProperty("text-align","center"),q.style.setProperty("padding","3rem"),q.style.setProperty("background","var(--surface-color)"),q.style.setProperty("border-radius","var(--border-radius)"),he.style.setProperty("font-size","3rem"),he.style.setProperty("margin-bottom","1rem"),ve.style.setProperty("margin-bottom","0.5rem"),s(ve,()=>e("inventory.perfectCount","Perfect Count!")),B.style.setProperty("color","var(--text-muted)"),s(B,()=>e("inventory.noVariances","No variances found. Your physical count matches the system exactly.")),q}}),null),ce}}),null),L}})},rI=t=>{const{t:e}=it(),[r,n]=fe(""),[o,i]=fe("");let{entry:a,updatePhysicalCount:c,updateNotes:u,index:h}=t;Hr(()=>{i(a?.notes),n(a?.physicalCount)});const y=()=>{let b=document.getElementById(`physicalCountInput_${h+2}`);if(console.log(pl(r()),!b),pl(r())&&!b){c(a?.productId,r()===""?null:parseFloat(r()));return}if(pl(r())&&b){b.focus(),c(a?.productId,r()===""?null:parseFloat(r()));return}};return(()=>{var b=eI(),_=b.firstChild,A=_.firstChild,E=_.nextSibling,R=E.firstChild,P=R.nextSibling,k=P.firstChild,K=k.nextSibling;K.nextSibling;var oe=E.nextSibling,O=oe.firstChild,M=oe.nextSibling,N=M.firstChild,g=M.nextSibling,v=g.firstChild,f=g.nextSibling,C=f.firstChild;return b.style.setProperty("border-bottom","1px solid var(--border-color)"),_.style.setProperty("padding","1rem"),_.style.setProperty("text-align","center"),A.style.setProperty("font-weight","600"),s(A,h+1),E.style.setProperty("padding","1rem"),R.style.setProperty("font-weight","500"),s(R,()=>a?.product.name),P.style.setProperty("font-size","0.875rem"),P.style.setProperty("color","var(--text-muted)"),s(P,()=>a?.product.sku,k),s(P,()=>a?.product.category,K),s(P,()=>a?.product.unitOfMeasure,null),oe.style.setProperty("padding","1rem"),oe.style.setProperty("text-align","center"),O.style.setProperty("font-weight","600"),s(O,()=>a?.systemQuantity),M.style.setProperty("padding","1rem"),M.style.setProperty("text-align","center"),N.addEventListener("blur",()=>{y()}),N.$$keydown=S=>{S.keyCode===13&&y(),S.keyCode===27&&y(),S.keyCode},N.$$input=S=>{const x=S.target.value;n(x)},ct(N,"id",`physicalCountInput_${h+1}`),ct(N,"tabindex",h),N.style.setProperty("width","100px"),N.style.setProperty("padding","0.5rem"),N.style.setProperty("border","1px solid var(--border-color)"),N.style.setProperty("border-radius","var(--border-radius-sm)"),N.style.setProperty("text-align","center"),g.style.setProperty("padding","1rem"),g.style.setProperty("text-align","center"),v.style.setProperty("font-weight","600"),s(v,()=>a?.variance>0?"+":"",null),s(v,()=>a?.variance||"—",null),f.style.setProperty("padding","1rem"),C.addEventListener("blur",S=>{u(a?.productId,o())}),C.$$keydown=S=>{S.keyCode===13&&u(a?.productId,o()),S.keyCode===27&&u(a?.productId,o()),S.keyCode===9&&u(a?.productId,o())},C.$$input=S=>{const x=S.target.value;i(x)},C.style.setProperty("width","200px"),C.style.setProperty("padding","0.5rem"),C.style.setProperty("border","1px solid var(--border-color)"),C.style.setProperty("border-radius","var(--border-radius-sm)"),le(S=>{var x=a?.physicalCount!==null?a?.variance!==0?"#fff3cd":"#d4edda":"transparent",m=a?.variance>0?"#4caf50":a?.variance<0?"#f44336":"var(--text-muted)",re=e("inventory.addNotes","Add notes...");return x!==S.e&&((S.e=x)!=null?b.style.setProperty("background",x):b.style.removeProperty("background")),m!==S.t&&((S.t=m)!=null?v.style.setProperty("color",m):v.style.removeProperty("color")),re!==S.a&&ct(C,"placeholder",S.a=re),S},{e:void 0,t:void 0,a:void 0}),le(()=>N.value=r()||""),le(()=>C.value=o()||""),b})()};ft(["click","input","keydown"]);function nI(t,e=300,r=!1){let n,o;const i=()=>{n!==void 0&&(clearTimeout(n),n=void 0),o=void 0},a=()=>{n!==void 0&&o!==void 0&&(clearTimeout(n),n=void 0,t(...o),o=void 0)},c=(...u)=>{o=u,n!==void 0&&clearTimeout(n),r&&n===void 0&&t(...u),n=window.setTimeout(()=>{r||t(...u),n=void 0,o=void 0},e)};return yi(()=>{i()}),{debounced:c,cancel:i,flush:a}}function oI(t,e=300){const[r,n]=fe(!1);let o;const i=async h=>{if(o&&o.abort(),!h.trim()){n(!1);return}o=new AbortController,n(!0);try{await t(h)}catch(y){y instanceof Error&&y.name!=="AbortError"&&console.error("Search error:",y)}finally{o.signal.aborted||n(!1)}},{debounced:a,cancel:c}=nI(i,e,!1),u=()=>{c(),o&&o.abort(),n(!1)};return yi(()=>{u()}),{search:a,isSearching:r,cancel:u}}var lm=z("<div>"),iI=z("<div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),sI=z("<div><h3></h3><div><div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><div><span></span><span></span></div><div><span></span><span>%"),aI=z("<div><h4>"),lI=z("<div><h3></h3><div><div><div><span></span><span> </span></div><div><span></span><span> </span></div></div><div><div><span></span><span> </span></div><div><span></span><span>"),cI=z("<div><h3></h3><div><span></span><span></span></div><div><span></span><span>"),cm=z("<div><h3>"),dI=z("<div><div><div><h2></h2><div>SKU: <!> • </div></div><div></div></div><div><button></button><button></button><button></button></div><div>"),uI=z("<span>✓ "),hI=z("<span>✗ "),mI=z("<div><div><span><span> • </span></span><span> </span></div><div>: <!> • <!>: "),yI=z("<div>📦 "),pI=z("<div>Ref: "),fI=z("<div><div><div><span></span><span></span><span></span></div><div><span></span></div></div><div><div> </div><div>"),gI=z("<div><h4></h4><div></div><div>"),vI=z("<div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div> <!> × </div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div>Min: <!> • Max: ");const bI=t=>{const{t:e}=it(),[r,n]=fe("details"),o=ze(()=>{if(!t.product)return null;const f=De.getTotalStockByProduct(t.product.id),C=De.getStockByProduct(t.product.id),S=f<=t.product.minStockLevel,x=f===0,m=f>=t.product.maxStockLevel;return{total:f,byLocation:C,status:x?"out":S?"low":m?"over":"good",statusText:x?e("products.outOfStock","Out of Stock"):S?e("products.lowStock","Low Stock"):m?e("products.overStock","Over Stock"):e("products.inStock","In Stock")}}),i=f=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(f),a=f=>new Date(f).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),c=ze(()=>!t.product||t.product.unitCost===0?0:((t.product.sellingPrice-t.product.unitCost)/t.product.unitCost*100).toFixed(2)),u=ze(()=>t.product?De.movements.filter(f=>f.productId===t.product.id).sort((f,C)=>new Date(C.createdDate).getTime()-new Date(f.createdDate).getTime()):[]),h=ze(()=>{if(!t.product)return null;const f=u(),C=o(),S=new Date;S.setDate(S.getDate()-30);const x=f.filter(re=>new Date(re.createdDate)>=S),m=f.reduce((re,Y)=>{const $=Y.productId===t.product.id?Y:null;return re+($?$.quantity*$.unitCost:0)},0);return{recentMovements:f.length,movements30Days:x.length,totalValue:(C?.total||0)*t.product.unitCost,averageMovementValue:f.length>0?m/f.length:0,lastMovementDate:f.length>0?f[0].createdDate:null}}),y={"margin-bottom":"2rem"},b={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},_={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},A={"font-weight":"400",color:"var(--text-primary)","font-size":"1rem"},E=f=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[f]||"📋";function R(f){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[f]||{bg:"#f5f5f5",color:"#666"}}const P=f=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:R(f).bg,color:R(f).color}),k=f=>{const C={good:{background:"#d4edda",color:"#155724"},low:{background:"#fff3cd",color:"#856404"},out:{background:"#f8d7da",color:"#721c24"},over:{background:"#cce5ff",color:"#004085"}};return{display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500",...C[f]||C.good}},K={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"},oe={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-bottom":"0.75rem"},O={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem","padding-bottom":"1rem","border-bottom":"2px solid var(--border-color)"},M={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},N=f=>({padding:"0.75rem 1.5rem",background:"none",border:"none","border-bottom":f?"2px solid var(--primary-color)":"2px solid transparent",color:f?"var(--primary-color)":"var(--text-muted)","font-weight":f?"600":"400",cursor:"pointer",transition:"all 0.2s","font-size":"0.875rem"}),g={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-bottom":"0.5rem"},v={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1.5rem","margin-bottom":"1rem"};return w(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("products.productDetails","Product Details")},size:"large",get children(){return w(Re,{get when(){return t.product},get fallback(){return(()=>{var f=lm();return f.style.setProperty("text-align","center"),f.style.setProperty("padding","2rem"),f.style.setProperty("color","var(--text-muted)"),s(f,()=>e("products.noProductSelected","No product selected")),f})()},children:f=>(()=>{var C=dI(),S=C.firstChild,x=S.firstChild,m=x.firstChild,re=m.nextSibling,Y=re.firstChild,$=Y.nextSibling;$.nextSibling;var V=x.nextSibling,Q=S.nextSibling,L=Q.firstChild,D=L.nextSibling,j=D.nextSibling,ue=Q.nextSibling;return s(C,()=>JSON.stringify(f),S),d(S,O),m.style.setProperty("margin","0"),m.style.setProperty("font-size","1.5rem"),m.style.setProperty("margin-bottom","0.25rem"),s(m,()=>f().name),re.style.setProperty("color","var(--text-muted)"),s(re,()=>f().sku,$),s(re,()=>f().category,null),s(V,()=>o()?.statusText),d(Q,M),L.$$click=()=>n("details"),s(L,()=>e("products.details","Details")),D.$$click=()=>n("movements"),s(D,()=>e("products.movements","Movements")),j.$$click=()=>n("analytics"),s(j,()=>e("products.analytics","Analytics")),s(C,w(Re,{get when(){return r()==="details"},get children(){return[(()=>{var W=iI(),ce=W.firstChild,T=ce.nextSibling,G=T.firstChild,Z=G.nextSibling,F=T.nextSibling,ne=F.firstChild,H=ne.nextSibling,U=F.nextSibling,ae=U.firstChild,se=ae.nextSibling;return ce.style.setProperty("margin-bottom","1rem"),ce.style.setProperty("font-size","1.1rem"),s(ce,()=>e("products.basicInformation","Basic Information")),s(G,()=>e("products.description","Description")),s(Z,()=>f().description||e("common.notAvailable","N/A")),s(ne,()=>e("products.unitOfMeasure","Unit of Measure")),s(H,()=>f().unitOfMeasure),s(ae,()=>e("products.status","Status")),s(se,(()=>{var pe=ge(()=>!!f().isActive);return()=>pe()?(()=>{var de=uI();return de.firstChild,de.style.setProperty("color","#2e7d32"),s(de,()=>e("common.active","Active"),null),de})():(()=>{var de=hI();return de.firstChild,de.style.setProperty("color","#d32f2f"),s(de,()=>e("common.inactive","Inactive"),null),de})()})()),le(pe=>{var de=y,ye=b,X=_,ee=A,q=b,he=_,ve=A,B=b,te=_,_e=A;return pe.e=d(W,de,pe.e),pe.t=d(T,ye,pe.t),pe.a=d(G,X,pe.a),pe.o=d(Z,ee,pe.o),pe.i=d(F,q,pe.i),pe.n=d(ne,he,pe.n),pe.s=d(H,ve,pe.s),pe.h=d(U,B,pe.h),pe.r=d(ae,te,pe.r),pe.d=d(se,_e,pe.d),pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),W})(),(()=>{var W=sI(),ce=W.firstChild,T=ce.nextSibling,G=T.firstChild,Z=G.firstChild,F=Z.firstChild,ne=F.nextSibling,H=Z.nextSibling,U=H.firstChild,ae=U.nextSibling,se=G.nextSibling,pe=se.firstChild,de=pe.firstChild,ye=de.nextSibling,X=pe.nextSibling,ee=X.firstChild,q=ee.nextSibling,he=q.firstChild;return ce.style.setProperty("margin-bottom","1rem"),ce.style.setProperty("font-size","1.1rem"),s(ce,()=>e("products.pricingInformation","Pricing Information")),s(F,()=>e("products.unitCost","Unit Cost")),s(ne,()=>i(f().unitCost)),s(U,()=>e("products.sellingPrice","Selling Price")),s(ae,()=>i(f().sellingPrice)),s(de,()=>e("products.profit","Profit")),s(ye,()=>i(f().sellingPrice-f().unitCost)),s(ee,()=>e("products.profitMargin","Profit Margin")),s(q,c,he),le(ve=>{var B=y,te=K,_e=b,we=_,me=A,be=b,ie=_,Pe=A,Te=b,$e=_,Ee=A,Ve=b,Ke=_,je=A;return ve.e=d(W,B,ve.e),ve.t=d(T,te,ve.t),ve.a=d(Z,_e,ve.a),ve.o=d(F,we,ve.o),ve.i=d(ne,me,ve.i),ve.n=d(H,be,ve.n),ve.s=d(U,ie,ve.s),ve.h=d(ae,Pe,ve.h),ve.r=d(pe,Te,ve.r),ve.d=d(de,$e,ve.d),ve.l=d(ye,Ee,ve.l),ve.u=d(X,Ve,ve.u),ve.c=d(ee,Ke,ve.c),ve.w=d(q,je,ve.w),ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),W})(),(()=>{var W=lI(),ce=W.firstChild,T=ce.nextSibling,G=T.firstChild,Z=G.firstChild,F=Z.firstChild,ne=F.nextSibling,H=ne.firstChild,U=Z.nextSibling,ae=U.firstChild,se=ae.nextSibling,pe=se.firstChild,de=G.nextSibling,ye=de.firstChild,X=ye.firstChild,ee=X.nextSibling,q=ee.firstChild,he=ye.nextSibling,ve=he.firstChild,B=ve.nextSibling;return ce.style.setProperty("margin-bottom","1rem"),ce.style.setProperty("font-size","1.1rem"),s(ce,()=>e("products.stockInformation","Stock Information")),s(F,()=>e("products.totalStock","Total Stock")),s(ne,()=>o()?.total||0,H),s(ne,()=>f().unitOfMeasure,null),s(ae,()=>e("products.minStockLevel","Min Stock Level")),s(se,()=>f().minStockLevel,pe),s(se,()=>f().unitOfMeasure,null),s(X,()=>e("products.maxStockLevel","Max Stock Level")),s(ee,()=>f().maxStockLevel,q),s(ee,()=>f().unitOfMeasure,null),s(ve,()=>e("products.stockValue","Stock Value")),s(B,()=>i((o()?.total||0)*f().unitCost)),s(W,w(Re,{get when(){return ge(()=>!!o()?.byLocation)()&&o().byLocation.length>0},get children(){var te=aI(),_e=te.firstChild;return te.style.setProperty("margin-top","1.5rem"),_e.style.setProperty("margin-bottom","1rem"),_e.style.setProperty("font-size","1rem"),s(_e,()=>e("products.stockByLocation","Stock by Location")),s(te,()=>o().byLocation.map(we=>(()=>{var me=mI(),be=me.firstChild,ie=be.firstChild,Pe=ie.firstChild;Pe.firstChild;var Te=ie.nextSibling,$e=Te.firstChild,Ee=be.nextSibling,Ve=Ee.firstChild,Ke=Ve.nextSibling,je=Ke.nextSibling,Ce=je.nextSibling;return Ce.nextSibling,d(me,oe),be.style.setProperty("display","flex"),be.style.setProperty("justify-content","space-between"),be.style.setProperty("align-items","center"),ie.style.setProperty("font-weight","500"),ie.style.setProperty("color","var(--primary-color)"),s(ie,()=>we.locationId,Pe),Pe.style.setProperty("font-weight","500"),Pe.style.setProperty("color","var(--text-muted)"),s(Pe,()=>we.locationName,null),Te.style.setProperty("font-weight","600"),s(Te,()=>we.quantity,$e),s(Te,()=>f().unitOfMeasure,null),Ee.style.setProperty("margin-top","0.5rem"),Ee.style.setProperty("font-size","0.875rem"),Ee.style.setProperty("color","var(--text-muted)"),s(Ee,()=>e("products.available","Available"),Ve),s(Ee,()=>we.availableQuantity,Ke),s(Ee,()=>e("products.reserved","Reserved"),Ce),s(Ee,()=>we.reservedQuantity,null),le(Be=>(Be=we.quantity>0?"var(--primary-color)":"var(--text-muted)")!=null?Te.style.setProperty("color",Be):Te.style.removeProperty("color")),me})()),null),te}}),null),le(te=>{var _e=y,we=K,me=b,be=_,ie=A,Pe=b,Te=_,$e=A,Ee=b,Ve=_,Ke=A,je=b,Ce=_,Be=A;return te.e=d(W,_e,te.e),te.t=d(T,we,te.t),te.a=d(Z,me,te.a),te.o=d(F,be,te.o),te.i=d(ne,ie,te.i),te.n=d(U,Pe,te.n),te.s=d(ae,Te,te.s),te.h=d(se,$e,te.h),te.r=d(ye,Ee,te.r),te.d=d(X,Ve,te.d),te.l=d(ee,Ke,te.l),te.u=d(he,je,te.u),te.c=d(ve,Ce,te.c),te.w=d(B,Be,te.w),te},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),W})(),(()=>{var W=cI(),ce=W.firstChild,T=ce.nextSibling,G=T.firstChild,Z=G.nextSibling,F=T.nextSibling,ne=F.firstChild,H=ne.nextSibling;return ce.style.setProperty("margin-bottom","1rem"),ce.style.setProperty("font-size","1.1rem"),s(ce,()=>e("products.timestamps","Timestamps")),s(G,()=>e("common.createdDate","Created Date")),s(Z,()=>a(f().createdDate)),s(ne,()=>e("common.lastModified","Last Modified")),s(H,()=>a(f().lastModified)),le(U=>{var ae=y,se=b,pe=_,de=A,ye=b,X=_,ee=A;return U.e=d(W,ae,U.e),U.t=d(T,se,U.t),U.a=d(G,pe,U.a),U.o=d(Z,de,U.o),U.i=d(F,ye,U.i),U.n=d(ne,X,U.n),U.s=d(H,ee,U.s),U},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),W})()]}}),ue),s(C,w(Re,{get when(){return r()==="movements"},get children(){var W=cm(),ce=W.firstChild;return ce.style.setProperty("margin-bottom","1rem"),ce.style.setProperty("font-size","1.1rem"),s(ce,()=>e("products.recentMovements","Recent Movements")),s(W,w(Re,{get when(){return u().length>0},get fallback(){return(()=>{var T=yI();return T.firstChild,T.style.setProperty("text-align","center"),T.style.setProperty("padding","2rem"),T.style.setProperty("color","var(--text-muted)"),T.style.setProperty("background","var(--surface-color)"),T.style.setProperty("border-radius","var(--border-radius-sm)"),T.style.setProperty("border","1px solid var(--border-color)"),s(T,()=>e("products.noMovements","No movements found for this product"),null),T})()},get children(){return w(nt,{get each(){return u()},children:T=>{const G=T.productId===f().id?T:null;if(!G)return null;let Z=De.getLocationById(T.locationId);return(()=>{var F=fI(),ne=F.firstChild,H=ne.firstChild,U=H.firstChild,ae=U.nextSibling,se=ae.nextSibling,pe=H.nextSibling,de=pe.firstChild,ye=ne.nextSibling,X=ye.firstChild,ee=X.firstChild,q=X.nextSibling;return d(F,g),H.style.setProperty("font-weight","600"),H.style.setProperty("margin-bottom","0.25rem"),U.style.setProperty("font-size","1.2rem"),s(U,()=>E(T.movementType)),ae.style.setProperty("padding","0 6px"),s(se,()=>T.movementType),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),s(pe,()=>` ${a(T?.createdDate)} • `,de),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("font-weight","600"),de.style.setProperty("color","var(--primary-color)"),s(de,()=>T?.locationId),s(pe,()=>` • ${Z?.name}`,null),s(ne,w(Re,{get when(){return T.referenceNumber},get children(){var he=pI();return he.firstChild,he.style.setProperty("font-size","0.75rem"),he.style.setProperty("color","var(--text-muted)"),he.style.setProperty("margin-top","0.25rem"),s(he,()=>T?.referenceNumber,null),he}}),null),ye.style.setProperty("text-align","right"),X.style.setProperty("font-weight","600"),X.style.setProperty("font-size","1rem"),s(X,()=>T?.movementType==="in"?"+":"",ee),s(X,()=>G.quantity,ee),s(X,()=>f().unitOfMeasure,null),q.style.setProperty("font-size","0.875rem"),q.style.setProperty("color","var(--text-muted)"),s(q,()=>i(G.unitCost)),le(he=>{var ve=P(T.movementType),B=T?.movementType==="in"?"#2e7d32":"#d32f2f";return he.e=d(se,ve,he.e),B!==he.t&&((he.t=B)!=null?X.style.setProperty("color",B):X.style.removeProperty("color")),he},{e:void 0,t:void 0}),F})()}})}}),null),le(T=>d(W,y,T)),W}}),ue),s(C,w(Re,{get when(){return r()==="analytics"},get children(){var W=cm(),ce=W.firstChild;return ce.style.setProperty("margin-bottom","1rem"),ce.style.setProperty("font-size","1.1rem"),s(ce,()=>e("products.analytics","Analytics")),s(W,w(Re,{get when(){return h()},get fallback(){return(()=>{var T=lm();return T.style.setProperty("text-align","center"),T.style.setProperty("padding","2rem"),T.style.setProperty("color","var(--text-muted)"),s(T,()=>e("products.noAnalytics","No analytics data available")),T})()},children:T=>(()=>{var G=vI(),Z=G.firstChild,F=Z.firstChild,ne=F.nextSibling,H=ne.nextSibling,U=Z.nextSibling,ae=U.firstChild,se=ae.nextSibling,pe=se.nextSibling,de=U.nextSibling,ye=de.firstChild,X=ye.nextSibling,ee=X.nextSibling,q=ee.firstChild,he=q.nextSibling;he.nextSibling;var ve=de.nextSibling,B=ve.firstChild,te=B.nextSibling,_e=te.nextSibling,we=ve.nextSibling,me=we.firstChild,be=me.nextSibling,ie=be.nextSibling,Pe=ie.firstChild,Te=Pe.nextSibling;return Te.nextSibling,F.style.setProperty("margin","0 0 0.5rem 0"),F.style.setProperty("color","var(--primary-color)"),s(F,()=>e("products.totalMovements","Total Movements")),ne.style.setProperty("font-size","1.5rem"),ne.style.setProperty("font-weight","600"),s(ne,()=>T().recentMovements),H.style.setProperty("font-size","0.875rem"),H.style.setProperty("color","var(--text-muted)"),H.style.setProperty("margin-top","0.25rem"),s(H,()=>e("products.allTime","All time")),ae.style.setProperty("margin","0 0 0.5rem 0"),ae.style.setProperty("color","var(--primary-color)"),s(ae,()=>e("products.last30Days","Last 30 Days")),se.style.setProperty("font-size","1.5rem"),se.style.setProperty("font-weight","600"),s(se,()=>T().movements30Days),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),pe.style.setProperty("margin-top","0.25rem"),s(pe,()=>e("products.movements","movements")),ye.style.setProperty("margin","0 0 0.5rem 0"),ye.style.setProperty("color","var(--primary-color)"),s(ye,()=>e("products.currentValue","Current Stock Value")),X.style.setProperty("font-size","1.5rem"),X.style.setProperty("font-weight","600"),s(X,()=>i(T().totalValue)),ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),ee.style.setProperty("margin-top","0.25rem"),s(ee,()=>o()?.total||0,q),s(ee,()=>f().unitOfMeasure,he),s(ee,()=>i(f().unitCost),null),B.style.setProperty("margin","0 0 0.5rem 0"),B.style.setProperty("color","var(--primary-color)"),s(B,()=>e("products.avgMovementValue","Avg Movement Value")),te.style.setProperty("font-size","1.5rem"),te.style.setProperty("font-weight","600"),s(te,()=>i(T().averageMovementValue)),_e.style.setProperty("font-size","0.875rem"),_e.style.setProperty("color","var(--text-muted)"),_e.style.setProperty("margin-top","0.25rem"),s(_e,()=>e("products.perMovement","per movement")),s(G,w(Re,{get when(){return T().lastMovementDate},get children(){var $e=gI(),Ee=$e.firstChild,Ve=Ee.nextSibling,Ke=Ve.nextSibling;return Ee.style.setProperty("margin","0 0 0.5rem 0"),Ee.style.setProperty("color","var(--primary-color)"),s(Ee,()=>e("products.lastMovement","Last Movement")),Ve.style.setProperty("font-size","1.25rem"),Ve.style.setProperty("font-weight","600"),s(Ve,()=>a(T().lastMovementDate)),Ke.style.setProperty("font-size","0.875rem"),Ke.style.setProperty("color","var(--text-muted)"),Ke.style.setProperty("margin-top","0.25rem"),s(Ke,()=>e("products.mostRecent","Most recent activity")),le(je=>d($e,v,je)),$e}}),we),me.style.setProperty("margin","0 0 0.5rem 0"),me.style.setProperty("color","var(--primary-color)"),s(me,()=>e("products.stockStatus","Stock Status")),be.style.setProperty("font-size","1.25rem"),be.style.setProperty("font-weight","600"),s(be,()=>o()?.statusText),ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-muted)"),ie.style.setProperty("margin-top","0.25rem"),s(ie,()=>f().minStockLevel,Te),s(ie,()=>f().maxStockLevel,null),le($e=>{var Ee=K,Ve=v,Ke=v,je=v,Ce=v,Be=v;return $e.e=d(G,Ee,$e.e),$e.t=d(Z,Ve,$e.t),$e.a=d(U,Ke,$e.a),$e.o=d(de,je,$e.o),$e.i=d(ve,Ce,$e.i),$e.n=d(we,Be,$e.n),$e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),G})()}),null),le(T=>d(W,y,T)),W}}),ue),ue.style.setProperty("display","flex"),ue.style.setProperty("gap","1rem"),ue.style.setProperty("justify-content","flex-end"),ue.style.setProperty("margin-top","2rem"),s(ue,w(Le,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close","Close")}}),null),s(ue,w(Re,{get when(){return t.onEdit},get children(){return w(Le,{variant:"primary",get onClick(){return t.onEdit},get children(){return e("common.edit","Edit")}})}}),null),le(W=>{var ce=k(o()?.status||"good"),T=N(r()==="details"),G=N(r()==="movements"),Z=N(r()==="analytics");return W.e=d(V,ce,W.e),W.t=d(L,T,W.t),W.a=d(D,G,W.a),W.o=d(j,Z,W.o),W},{e:void 0,t:void 0,a:void 0,o:void 0}),C})()})}})};ft(["click"]);var _I=z("<div>🔄"),PI=z("<button type=button>×"),SI=z("<div>⚠️ "),dm=z("<div>"),wI=z("<div><div><input type=text autocomplete=off>"),CI=z("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>"),AI=z("<span>⚠️ ");const xI=t=>{const{t:e}=it(),[r,n]=fe(""),[o,i]=fe(!1),[a,c]=fe(null),[u,h]=fe([]),[y,b]=fe(!1),[_,A]=fe(-1),[E,R]=fe(null),P=t.searchDelay||300,k=t.maxResults||900,K=async T=>{if(!T.trim()||T.trim().length<3){h([]),t.onSearchResults?.([]);return}try{i(!0),c(null);try{const G=await ln.getProducts(T),Z=Object.keys(G),F=H=>{let U=G;return{id:H,name:U[H].name,businessId:U[H].businessId,sku:U[H].code,UPC:U[H].UPC,numCode:U[H].codeN,category:U[H].category,unitCost:U[H].unitCost||0,unitOfMeasure:U[H].unitOfMeasure,minStockLevel:U[H].minStockLevel,maxStockLevel:U[H].maxStockLevel,isActive:U[H].isActive,description:U[H].description||"",createdDate:U[H].createdAt||new Date().toISOString(),lastModified:U[H].updatedAt||new Date().toISOString()}},ne=Z.map(F);h(ne),De.updProduct(ne),t.onSearchResults?.(ne)}catch(G){console.warn("API search failed, using local fallback:",G),c("API search failed, showing local results");const Z=De.getActiveProducts().filter(F=>F.name.toLowerCase().includes(T.toLowerCase())||F.sku.toLowerCase().includes(T.toLowerCase())||F.category.toLowerCase().includes(T.toLowerCase())).slice(0,k);h(Z),t.onSearchResults?.(Z)}}catch(G){const Z=G instanceof Error?G.message:"Search failed";c(Z),h([]),t.onSearchResults?.([])}finally{i(!1)}},oe=T=>{const Z=T.target.value;n(Z),c(null),t.showResults!==!1&&b(!0),E()&&clearTimeout(E());const F=setTimeout(()=>{K(Z)},P);R(F)},O=T=>{n(T.name),b(!1),A(-1),t.onProductSelect?.(T)},M=T=>{if(!(!y()||u().length===0))switch(T.key){case"ArrowDown":T.preventDefault(),A(G=>Math.min(G+1,u().length-1));break;case"ArrowUp":T.preventDefault(),A(G=>Math.max(G-1,-1));break;case"Enter":T.preventDefault(),_()>=0&&u()[_()]&&O(u()[_()]);break;case"Escape":b(!1),A(-1);break}},N=()=>{t.showResults!==!1&&u().length>0&&b(!0)},g=()=>{setTimeout(()=>{b(!1),A(-1)},150)},v=()=>{n(""),h([]),c(null),b(!1),A(-1),t.onSearchResults?.([]),E()&&(clearTimeout(E()),R(null))},f=T=>De.stockLevels.filter(G=>G.productId===T).reduce((G,Z)=>G+Z.quantity,0),C=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T),S={position:"relative",width:"100%",...t.style},x={position:"relative",display:"flex","align-items":"center"},m={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},re={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},Y={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},$={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},V=T=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:T?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),Q={display:"flex","justify-content":"space-between","align-items":"center"},L={flex:"1"},D={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},j={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},ue={"text-align":"right","font-size":"0.875rem"},W={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},ce={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var T=wI(),G=T.firstChild,Z=G.firstChild;return Z.addEventListener("blur",g),Z.addEventListener("focus",N),Z.$$keydown=M,Z.$$input=oe,s(G,w(Re,{get when(){return o()},get children(){var F=_I();return le(ne=>d(F,Y,ne)),F}}),null),s(G,w(Re,{get when(){return ge(()=>!!r())()&&!o()},get children(){var F=PI();return F.addEventListener("mouseleave",ne=>{ne.currentTarget.style.background="none",ne.currentTarget.style.color="var(--text-muted)"}),F.addEventListener("mouseenter",ne=>{ne.currentTarget.style.background="var(--border-color)",ne.currentTarget.style.color="var(--text-primary)"}),F.$$click=v,le(ne=>{var H=re,U=e("common.clear","Clear search");return ne.e=d(F,H,ne.e),U!==ne.t&&ct(F,"title",ne.t=U),ne},{e:void 0,t:void 0}),F}}),null),s(T,w(Re,{get when(){return y()&&t.showResults!==!1},get children(){var F=dm();return s(F,w(Re,{get when(){return a()},get children(){var ne=SI();return ne.firstChild,d(ne,ce),s(ne,a,null),ne}}),null),s(F,w(Re,{get when(){return u().length>0},get fallback(){return ge(()=>!!(r()&&!o()))()&&(()=>{var ne=dm();return d(ne,W),s(ne,()=>e("inventory.noProductsFound","No products found matching your search.")),ne})()},get children(){return w(nt,{get each(){return u()},children:(ne,H)=>{const U=f(ne.id),ae=U<=ne.minStockLevel;return(()=>{var se=CI(),pe=se.firstChild,de=pe.firstChild,ye=de.firstChild,X=ye.nextSibling,ee=X.firstChild,q=ee.firstChild,he=ee.nextSibling,ve=he.nextSibling,B=ve.nextSibling,te=B.nextSibling,_e=de.nextSibling,we=_e.firstChild,me=we.firstChild,be=we.nextSibling;return se.addEventListener("mouseenter",()=>A(H())),se.$$click=()=>O(ne),d(pe,Q),d(de,L),d(ye,D),s(ye,()=>ne.name),d(X,j),s(ee,()=>e("inventory.sku","SKU"),q),s(ee,()=>ne.sku,null),s(ve,()=>ne.category),s(te,()=>C(ne.unitCost)),d(_e,ue),we.style.setProperty("font-weight","600"),(ae?"#f44336":"var(--text-primary)")!=null?we.style.setProperty("color",ae?"#f44336":"var(--text-primary)"):we.style.removeProperty("color"),s(we,U,me),s(we,()=>ne.unitOfMeasure,null),be.style.setProperty("color","var(--text-muted)"),s(be,()=>ae?(()=>{var ie=AI();return ie.firstChild,ie.style.setProperty("color","#f44336"),s(ie,()=>e("inventory.lowStock","Low Stock"),null),ie})():e("inventory.inStock","In Stock")),le(ie=>d(se,V(H()===_()),ie)),se})()}})}}),null),le(ne=>d(F,$,ne)),F}}),null),le(F=>{var ne=S,H=x,U=m,ae=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),se=t.disabled;return F.e=d(T,ne,F.e),F.t=d(G,H,F.t),F.a=d(Z,U,F.a),ae!==F.o&&ct(Z,"placeholder",F.o=ae),se!==F.i&&(Z.disabled=F.i=se),F},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),le(()=>Z.value=r()),T})()};ft(["input","keydown","click"]);var II=z("<div><div><h2></h2><div><div>"),$I=z("<div><span>"),EI=z("<span>🔍 "),TI=z("<div><div><div><div><h3></h3><span></span></div><div></div><div>: </div></div><div><div></div><div> • <!>: </div><div>: "),kI=z("<div><div>:</div><div>"),RI=z("<div>: "),DI=z("<div><div><span>:</span><select><option value=10>10</option><option value=20>20</option><option value=50>50</option><option value=100>100</option></select></div><div><div><span></span><input type=number min=1><span> </span></div></div><div>");const Nf=()=>{const{t}=it(),[e,r]=fe(""),[n,o]=fe(""),[i,a]=fe([]),[c,u]=fe(!1),[h,y]=fe(null),[b,_]=fe(!1),[A,E]=fe(!1),[R,P]=fe(!1),[k,K]=fe(null),[oe,O]=fe(!1),[M,N]=fe([]),[g,v]=fe(!1),[f,C]=fe(1),[S,x]=fe(20);Hr(async()=>{await m()});const m=async()=>{try{u(!0),y(null);try{const T=await mu.getAll();a(T.map(G=>({id:G.id||`prod-${Date.now()}-${Math.random()}`,name:G.productName||G.name||"Unknown Product",sku:G.sku||G.productCode||"",description:G.description||"",category:G.category||"General",unitOfMeasure:G.unitOfMeasure||"pcs",unitCost:parseFloat(G.unitCost||G.cost||"0"),sellingPrice:parseFloat(G.sellingPrice||G.price||"0"),minStockLevel:parseInt(G.minStockLevel||"0"),maxStockLevel:parseInt(G.maxStockLevel||"100"),isActive:G.isActive!==!1,createdDate:G.createdDate||new Date().toISOString(),lastModified:G.lastModified||new Date().toISOString(),businessId:G.businessId||"YB100423253156428"})))}catch(T){console.warn("API failed, using local store:",T),a(De.products)}}catch(T){y(T instanceof Error?T.message:"Failed to load products")}finally{u(!1)}},re=async()=>{try{u(!0),y(null);try{const T=await ln.getProducts("prod"),G=Object.keys(T),Z=ne=>{let U=T[ne];return{id:U.id,name:U.name,businessId:U.businessId,sku:U.code,numCode:U.codeN,category:U.category,unitCost:U.unitCost||0,unitOfMeasure:U.unitOfMeasure,minStockLevel:U.minStockLevel,maxStockLevel:U.maxStockLevel,isActive:U.isActive,description:U.description||"",createdDate:U.createdAt||new Date().toISOString(),lastModified:U.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(U.sellingPrice||U.price||"0")}},F=G.map(Z);a(F)}catch(T){console.warn("API failed, using local store:",T),a(De.products)}}catch(T){y(T instanceof Error?T.message:"Failed to load products")}finally{u(!1)}},{cancel:Y}=oI(async T=>{if(!T.trim()){await m();return}try{y(null);const G=await mu.getAll(T);a(G.map(Z=>({id:Z.id||`prod-${Date.now()}-${Math.random()}`,name:Z.productName||Z.name||"Unknown Product",sku:Z.sku||Z.productCode||"",description:Z.description||"",category:Z.category||"General",unitOfMeasure:Z.unitOfMeasure||"pcs",unitCost:parseFloat(Z.unitCost||Z.cost||"0"),sellingPrice:parseFloat(Z.sellingPrice||Z.price||"0"),minStockLevel:parseInt(Z.minStockLevel||"0"),maxStockLevel:parseInt(Z.maxStockLevel||"100"),isActive:Z.isActive!==!1,createdDate:Z.createdDate||new Date().toISOString(),lastModified:Z.lastModified||new Date().toISOString(),businessId:Z.businessId||"YB100423253156428"})))}catch(G){y(G instanceof Error?G.message:"Search failed");const Z=De.products.filter(F=>F.name.toLowerCase().includes(T.toLowerCase())||F.sku.toLowerCase().includes(T.toLowerCase())||F.category.toLowerCase().includes(T.toLowerCase()));a(Z)}},300);yi(()=>{Y()}),ze(()=>{let T=i();return n()&&(T=T.filter(G=>G.category===n())),T}),ze(()=>[...new Set(i().map(G=>G.category))].sort()),ze(()=>{const T=i().filter(F=>F.isActive),G=i().length,Z=i().filter(F=>De.getTotalStockByProduct(F.id)===0);return{total:G,active:T.length,outOfStock:Z.length}});const $=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T),V={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},Q={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},L=T=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:T?"#ffebee":"#e8f5e8",color:T?"#d32f2f":"#2d7d32"});ze(()=>{const T=De.products||[],G=De.movements||[],Z=De.stockLevels||[],F=De.getLowStockProducts(),ne=T?.length||0,H=T?.filter(se=>se.isActive).length,U=Z.reduce((se,pe)=>se*1+pe.quantity*1*pe.averageCost*1,0),ae=G?.filter(se=>{const pe=new Date(se.createdDate),de=new Date;return pe.getMonth()===de.getMonth()&&pe.getFullYear()===de.getFullYear()}).length;return{totalProducts:ne,activeProducts:H,lowStockProducts:F.length,totalStockValue:U,totalMovementsThisMonth:ae,totalLocations:De.locations.length,activeLocations:De.getActiveLocations().length}});const D=ze(()=>De.products.map(T=>{const G=De.getStockByProduct(T.id),Z=De.getTotalStockByProduct(T.id),F=De.getLastLocationByProduct(T.id);return{...T,totalStock:Z,stockByLocation:G,lastLocation:F,isLowStock:Z<=T.minStockLevel}})),j=ze(()=>M().map(T=>{const G=De.getStockByProduct(T.id),Z=De.getTotalStockByProduct(T.id),F=De.getLastLocationByProduct(T.id);return{...T,totalStock:Z,stockByLocation:G,lastLocation:F,isLowStock:Z<=T.minStockLevel}})),ue=ze(()=>{const T=g()?j():D(),G=(f()-1)*S(),Z=G+S();return T.slice(G,Z)}),W=ze(()=>{const T=g()?j():D();return Math.ceil(T.length/S())}),ce=T=>{K(T),E(!0)};return w(Ur,{get title(){return t("products.title","Products")},get children(){return[(()=>{var T=II(),G=T.firstChild,Z=G.firstChild,F=Z.nextSibling,ne=F.firstChild;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","flex-start"),T.style.setProperty("margin-bottom","1.5rem"),T.style.setProperty("flex-wrap","wrap"),T.style.setProperty("gap","1rem"),G.style.setProperty("flex","1"),G.style.setProperty("min-width","300px"),Z.style.setProperty("margin","0 0 1rem 0"),Z.style.setProperty("font-size","1.5rem"),s(Z,()=>t("inventory.products")),F.style.setProperty("display","flex"),F.style.setProperty("gap","1rem"),F.style.setProperty("align-items","center"),F.style.setProperty("flex-wrap","wrap"),ne.style.setProperty("flex","1"),ne.style.setProperty("min-width","250px"),s(ne,w(xI,{onSearchResults:H=>{N(H),v(H.length>0)},get placeholder(){return t("inventory.searchProductsStock","Search products and check stock levels...")},showResults:!1,maxResults:20})),s(F,w(Le,{variant:"outline",onClick:()=>{re(),v(!1)},get children(){return["🔄 ",ge(()=>t("common.showAll","Show All"))]}}),null),s(T,w(Re,{get when(){return wt.hasPermission("read_write")},get children(){return w(Le,{variant:"primary",onClick:()=>O(!0),get children(){return["➕ ",ge(()=>t("inventory.addProduct"))]}})}}),null),T})(),(()=>{var T=$I(),G=T.firstChild;return T.style.setProperty("margin-bottom","1rem"),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","var(--text-muted)"),T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),s(G,(()=>{var Z=ge(()=>!!g());return()=>Z()?`${t("inventory.searchResults","Search Results")}: ${j().length} ${t("common.products","products")}`:`${t("inventory.totalProducts","Total Products")}: ${D().length} ${t("common.products","products")}`})()),s(T,(()=>{var Z=ge(()=>!!g());return()=>Z()&&(()=>{var F=EI();return F.firstChild,F.style.setProperty("color","var(--primary-color)"),s(F,()=>t("inventory.filtered","Filtered view"),null),F})()})(),null),T})(),w(nt,{get each(){return ue()},children:T=>(()=>{var G=TI(),Z=G.firstChild,F=Z.firstChild,ne=F.firstChild,H=ne.firstChild,U=H.nextSibling,ae=ne.nextSibling,se=ae.nextSibling,pe=se.firstChild,de=F.nextSibling,ye=de.firstChild,X=ye.nextSibling,ee=X.firstChild,q=ee.nextSibling;q.nextSibling;var he=X.nextSibling,ve=he.firstChild;return G.$$click=()=>ce(T),G.addEventListener("mouseleave",B=>{B.currentTarget.style.transform="translateY(0)",B.currentTarget.style.boxShadow="none"}),G.addEventListener("mouseenter",B=>{B.currentTarget.style.transform="translateY(-2px)",B.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),d(G,V),d(Z,Q),ne.style.setProperty("display","flex"),ne.style.setProperty("align-items","center"),ne.style.setProperty("gap","0.5rem"),ne.style.setProperty("margin-bottom","0.5rem"),H.style.setProperty("margin","0"),H.style.setProperty("font-size","1.1rem"),s(H,()=>T.name),s(U,(()=>{var B=ge(()=>!!T.isLowStock);return()=>B()?t("inventory.lowStockAlert"):t("inventory.inStock")})()),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),s(ae,()=>T.sku,null),s(ae,()=>T.UPC?" • "+T.UPC:"",null),s(ae,()=>T.category?" • "+T.category:"",null),se.style.setProperty("font-size","0.875rem"),se.style.setProperty("color","var(--text-muted)"),s(se,()=>t("inventory.lastSeen"),pe),s(se,()=>T.lastLocation?.name||t("inventory.noMovements"),null),de.style.setProperty("text-align","right"),ye.style.setProperty("font-size","1.25rem"),ye.style.setProperty("font-weight","700"),ye.style.setProperty("color","var(--primary-color)"),s(ye,()=>T.totalStock),X.style.setProperty("font-size","0.875rem"),X.style.setProperty("color","var(--text-muted)"),s(X,()=>T.unitOfMeasure,ee),s(X,()=>t("inventory.min"),q),s(X,()=>T.minStockLevel,null),he.style.setProperty("font-size","0.875rem"),he.style.setProperty("color","var(--text-muted)"),s(he,()=>t("inventory.cost"),ve),s(he,()=>$(T.unitCost),null),s(G,(()=>{var B=ge(()=>T.stockByLocation.length>0);return()=>B()&&(()=>{var te=kI(),_e=te.firstChild,we=_e.firstChild,me=_e.nextSibling;return te.style.setProperty("margin-top","1rem"),_e.style.setProperty("font-weight","500"),_e.style.setProperty("margin-bottom","0.5rem"),_e.style.setProperty("font-size","0.875rem"),s(_e,()=>t("inventory.stockByLocation"),we),me.style.setProperty("display","flex"),me.style.setProperty("flex-wrap","wrap"),me.style.setProperty("gap","0.5rem"),s(me,w(nt,{get each(){return T.stockByLocation},children:be=>{const ie=De.getLocationById(be.locationId);return(()=>{var Pe=RI(),Te=Pe.firstChild;return Pe.style.setProperty("padding","0.25rem 0.5rem"),Pe.style.setProperty("background","var(--background-color)"),Pe.style.setProperty("border-radius","var(--border-radius-sm)"),Pe.style.setProperty("font-size","0.75rem"),Pe.style.setProperty("border","1px solid var(--border-color)"),s(Pe,()=>ie?.name,Te),s(Pe,()=>be.quantity,null),Pe})()}})),te})()})(),null),le(B=>d(U,L(T.isLowStock),B)),G})()}),ge(()=>ge(()=>W()>1)()&&(()=>{var T=DI(),G=T.firstChild,Z=G.firstChild,F=Z.firstChild,ne=Z.nextSibling,H=G.nextSibling,U=H.firstChild,ae=U.firstChild,se=ae.nextSibling,pe=se.nextSibling,de=pe.firstChild,ye=H.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),T.style.setProperty("margin-top","2rem"),T.style.setProperty("padding","1rem"),T.style.setProperty("background","var(--surface-color)"),T.style.setProperty("border-radius","var(--border-radius)"),T.style.setProperty("border","1px solid var(--border-color)"),G.style.setProperty("display","flex"),G.style.setProperty("align-items","center"),G.style.setProperty("gap","0.5rem"),Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-muted)"),s(Z,()=>t("common.showPerPage","Show per page"),F),ne.addEventListener("change",X=>{x(parseInt(X.target.value)),C(1)}),ne.style.setProperty("padding","0.25rem 0.5rem"),ne.style.setProperty("border","1px solid var(--border-color)"),ne.style.setProperty("border-radius","var(--border-radius-sm)"),ne.style.setProperty("background","var(--background-color)"),ne.style.setProperty("cursor","pointer"),H.style.setProperty("display","flex"),H.style.setProperty("align-items","center"),H.style.setProperty("gap","0.5rem"),s(H,w(Le,{variant:"outline",size:"sm",onClick:()=>C(1),get disabled(){return f()===1},get children(){return t("common.first","First")}}),U),s(H,w(Le,{variant:"outline",size:"sm",onClick:()=>C(X=>Math.max(1,X-1)),get disabled(){return f()===1},get children(){return t("common.previous","Previous")}}),U),U.style.setProperty("display","flex"),U.style.setProperty("align-items","center"),U.style.setProperty("gap","0.25rem"),ae.style.setProperty("font-size","0.875rem"),s(ae,()=>t("common.page","Page")),se.addEventListener("change",X=>{const ee=parseInt(X.target.value);ee>=1&&ee<=W()&&C(ee)}),se.style.setProperty("width","60px"),se.style.setProperty("padding","0.25rem 0.5rem"),se.style.setProperty("border","1px solid var(--border-color)"),se.style.setProperty("border-radius","var(--border-radius-sm)"),se.style.setProperty("text-align","center"),se.style.setProperty("font-size","0.875rem"),pe.style.setProperty("font-size","0.875rem"),s(pe,()=>t("common.of","of"),de),s(pe,W,null),s(H,w(Le,{variant:"outline",size:"sm",onClick:()=>C(X=>Math.min(W(),X+1)),get disabled(){return f()===W()},get children(){return t("common.next","Next")}}),null),s(H,w(Le,{variant:"outline",size:"sm",onClick:()=>C(W()),get disabled(){return f()===W()},get children(){return t("common.last","Last")}}),null),ye.style.setProperty("font-size","0.875rem"),ye.style.setProperty("color","var(--text-muted)"),s(ye,()=>{const X=g()?j():D(),ee=(f()-1)*S()+1,q=Math.min(f()*S(),X.length);return t("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:ee,end:q,total:X.length})}),le(()=>ct(se,"max",W())),le(()=>ne.value=S()),le(()=>se.value=f()),T})()),w(Dd,{get isOpen(){return b()},onClose:()=>_(!1),onProductAdded:()=>{m()}}),w(bI,{get isOpen(){return A()},onClose:()=>{E(!1),K(null)},get product(){return k()},onEdit:()=>{E(!1),P(!0)}})]}})};ft(["click"]);var NI=z("<div><div></div><div>"),LI=z("<div><div><img></div><div>X</div><div><div><h2></h2><div></div></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),MI=z("<div>"),OI=z("<div><div>📦</div><h3></h3><p>"),VI=z("<div><div>"),FI=z("<div>✓"),BI=z("<div><div><img loading=lazy></div><div><div></div><div> • </div><div></div><div>",!0,!1,!1);const UI=t=>{const{t:e}=it(),[r,n]=fe(null),[o,i]=fe([]),[a,c]=fe(!1),u=V=>{n(V),t.onProductSelect?.(V)},h=()=>{n(null),t.onProductSelect?.(null),i([]),c(!1)},y=V=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(V),b=()=>"YABABYSSolution",_=()=>"https://qvamarkets.s3.us-east-2.amazonaws.com/V2_images/7258/",A=V=>{if(V.productImageUrl)return _()+b()+"/"+V?.productImageUrl;const Q={Electronics:"https://via.placeholder.com/400x300/4F46E5/FFFFFF?text=Electronics",Furniture:"https://via.placeholder.com/400x300/059669/FFFFFF?text=Furniture",Food:"https://via.placeholder.com/400x300/DC2626/FFFFFF?text=Food",Clothing:"https://via.placeholder.com/400x300/7C3AED/FFFFFF?text=Clothing",Tools:"https://via.placeholder.com/400x300/EA580C/FFFFFF?text=Tools",General:"https://via.placeholder.com/400x300/6B7280/FFFFFF?text=Product"};return Q[V.category]||Q.General},E={padding:"2rem"},R={"max-width":"600px",margin:"0 auto 2rem",position:"relative"},P={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},k={background:"var(--surface-color)","border-radius":"var(--border-radius)",overflow:"hidden","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.3s ease"},K={position:"relative",width:"100%",height:"200px",overflow:"hidden",background:"#f5f5f5"},oe={width:"100%",height:"100%","object-fit":"cover",transition:"transform 0.3s ease"},O={padding:"1rem"},M={"font-size":"1rem","font-weight":"600","margin-bottom":"0.5rem",color:"var(--text-primary)",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},N={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.25rem"},g={"font-size":"1.25rem","font-weight":"700",color:"var(--primary-color)","margin-top":"0.5rem"},v={display:"flex",gap:"2rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"2rem","box-shadow":"var(--shadow-md)","margin-bottom":"2rem",position:"relative"},f={width:"400px",height:"300px","border-radius":"var(--border-radius)",overflow:"hidden",background:"#f5f5f5"},C={flex:"1",display:"flex","flex-direction":"column",gap:"1rem"},S={display:"flex","justify-content":"space-between","padding-bottom":"0.5rem","border-bottom":"1px solid var(--border-light)"},x={"font-weight":"500",color:"var(--text-muted)"},m={"font-weight":"600",color:"var(--text-primary)"},re=V=>({display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600",background:"#d4edda",color:"#155724"}),Y={"text-align":"center",padding:"4rem 2rem",color:"var(--text-muted)"},$={"font-size":"3rem","margin-bottom":"1rem",opacity:"0.5"};return(()=>{var V=VI(),Q=V.firstChild;return d(V,E),s(Q,w(Rd,{onChange:L=>{console.log(L);let D=L;c(!0),u(D)},get placeholder(){return e("inventory.searchProductsImages","Search products to view images...")}})),s(V,w(Re,{get when(){return r()&&t.showDetails!==!1},get children(){var L=LI(),D=L.firstChild,j=D.firstChild,ue=D.nextSibling,W=ue.nextSibling,ce=W.firstChild,T=ce.firstChild,G=T.nextSibling,Z=ce.nextSibling,F=Z.firstChild,ne=F.nextSibling,H=Z.nextSibling,U=H.firstChild,ae=U.nextSibling,se=H.nextSibling,pe=se.firstChild,de=pe.nextSibling,ye=se.nextSibling,X=ye.firstChild,ee=X.nextSibling,q=ye.nextSibling,he=q.firstChild,ve=he.nextSibling;return d(L,v),d(D,f),j.style.setProperty("width","100%"),j.style.setProperty("height","100%"),j.style.setProperty("object-fit","contain"),j.style.setProperty("aspect-ratio","1 / 1"),ue.$$click=()=>{h()},ue.style.setProperty("position","absolute"),ue.style.setProperty("top","0.5rem"),ue.style.setProperty("right","0.5rem"),ue.style.setProperty("color","#3d3d3d"),ue.style.setProperty("border-radius","50%"),ue.style.setProperty("width","2rem"),ue.style.setProperty("height","2rem"),ue.style.setProperty("display","flex"),ue.style.setProperty("align-items","center"),ue.style.setProperty("justify-content","center"),ue.style.setProperty("font-size","1.25rem"),ue.style.setProperty("box-shadow","var(--shadow-sm)"),ue.style.setProperty("cursor","pointer"),d(W,C),T.style.setProperty("margin","0 0 0.5rem 0"),T.style.setProperty("font-size","1.5rem"),s(T,()=>r().name),s(G,()=>e("products.inStock","In Stock")),s(F,()=>e("products.sku","SKU")),s(ne,()=>r().sku),s(U,()=>e("inventory.category","Category")),s(ae,()=>r().category),s(pe,()=>e("inventory.unitOfMeasure","Unit")),s(de,()=>r().unitOfMeasure),s(X,()=>e("inventory.unitCost","Cost")),s(ee,()=>y(r().unitCost)),s(he,()=>e("inventory.UPC","UPC")),s(ve,()=>r().UPC),s(W,w(Re,{get when(){return r().description},get children(){var B=NI(),te=B.firstChild,_e=te.nextSibling;return B.style.setProperty("margin-top","1rem"),s(te,()=>e("common.description","Description")),_e.style.setProperty("margin-top","0.5rem"),_e.style.setProperty("color","var(--text-primary)"),s(_e,()=>r().description),le(we=>d(te,x,we)),B}}),null),le(B=>{var te=A(r()),_e=r().name,we=re(),me=S,be=x,ie=m,Pe=S,Te=x,$e=m,Ee=S,Ve=x,Ke=m,je=S,Ce=x,Be=m,Je=S,Qe=x,We=m;return te!==B.e&&ct(j,"src",B.e=te),_e!==B.t&&ct(j,"alt",B.t=_e),B.a=d(G,we,B.a),B.o=d(Z,me,B.o),B.i=d(F,be,B.i),B.n=d(ne,ie,B.n),B.s=d(H,Pe,B.s),B.h=d(U,Te,B.h),B.r=d(ae,$e,B.r),B.d=d(se,Ee,B.d),B.l=d(pe,Ve,B.l),B.u=d(de,Ke,B.u),B.c=d(ye,je,B.c),B.w=d(X,Ce,B.w),B.m=d(ee,Be,B.m),B.f=d(q,Je,B.f),B.y=d(he,Qe,B.y),B.g=d(ve,We,B.g),B},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),L}}),null),s(V,w(Re,{get when(){return o().length>0},get children(){var L=MI();return d(L,P),s(L,w(nt,{get each(){return o()},children:D=>(()=>{var j=BI(),ue=j.firstChild,W=ue.firstChild,ce=ue.nextSibling,T=ce.firstChild,G=T.nextSibling,Z=G.firstChild,F=G.nextSibling,ne=F.nextSibling;return j.addEventListener("mouseleave",H=>{H.currentTarget.style.transform="translateY(0)",H.currentTarget.style.boxShadow="var(--shadow-sm)";const U=H.currentTarget.querySelector("img");U&&(U.style.transform="scale(1)")}),j.addEventListener("mouseenter",H=>{H.currentTarget.style.transform="translateY(-4px)",H.currentTarget.style.boxShadow="var(--shadow-lg)";const U=H.currentTarget.querySelector("img");U&&(U.style.transform="scale(1.05)")}),j.$$click=()=>u(D),d(j,k),s(ue,w(Re,{get when(){return D===r()},get children(){var H=FI();return H.style.setProperty("position","absolute"),H.style.setProperty("top","0.5rem"),H.style.setProperty("right","0.5rem"),H.style.setProperty("background","var(--primary-color)"),H.style.setProperty("color","white"),H.style.setProperty("border-radius","50%"),H.style.setProperty("width","2rem"),H.style.setProperty("height","2rem"),H.style.setProperty("display","flex"),H.style.setProperty("align-items","center"),H.style.setProperty("justify-content","center"),H.style.setProperty("font-size","1.25rem"),H}}),null),d(ce,O),s(T,()=>D.name),s(G,()=>D.sku,Z),s(G,()=>D.category,null),s(F,()=>D.unitOfMeasure),d(ne,g),s(ne,()=>y(D.sellingPrice)),le(H=>{var U=K,ae=A(D),se=D.name,pe=oe,de=M,ye=D.name,X=N,ee=N;return H.e=d(ue,U,H.e),ae!==H.t&&ct(W,"src",H.t=ae),se!==H.a&&ct(W,"alt",H.a=se),H.o=d(W,pe,H.o),H.i=d(T,de,H.i),ye!==H.n&&ct(T,"title",H.n=ye),H.s=d(G,X,H.s),H.h=d(F,ee,H.h),H},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),j})()})),L}}),null),s(V,w(Re,{get when(){return!r()},get children(){var L=OI(),D=L.firstChild,j=D.nextSibling,ue=j.nextSibling;return d(D,$),j.style.setProperty("margin-bottom","0.5rem"),s(j,()=>e("inventory.noProductsFound","No Products Found")),s(ue,()=>e("inventory.tryDifferentSearch","Try a different search term")),le(W=>d(L,Y,W)),L}}),null),le(L=>d(Q,R,L)),V})()};ft(["click"]);var jI=z("<div><div>📊</div><div></div><div>"),um=z("<div>"),zI=z("<div><div><div><h2> - </h2><button>×</button></div><div>"),qI=z("<div><div><div><div><h3></h3><span></span></div><div></div></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const GI=t=>{const{t:e}=it(),[r,n]=fe(""),[o,i]=fe(!1),a=ze(()=>{const E=De.movements,R=new Map;return E.forEach(P=>{const k=P.referenceNumber||P.invoiceId||P.ssg_inventory_key||"UNKNOWN";R.has(k)||R.set(k,{referenceNumber:k,movements:[],totalItems:0,totalValue:0,createdDate:P.createdDate,movementType:P.movementType});const K=R.get(k);K.movements.push(P),K.totalItems+=P.quantity,K.totalValue+=P.totalCost,new Date(P.createdDate)<new Date(K.createdDate)&&(K.createdDate=P.createdDate)}),Array.from(R.values()).filter(P=>P.movements.length>1).sort((P,k)=>new Date(k.createdDate).getTime()-new Date(P.createdDate).getTime())}),c=ze(()=>{const E=a().find(R=>R.referenceNumber===r());return E?E.movements:[]}),u=E=>{n(E),i(!0)},h=()=>{i(!1),n("")},y=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E),b=E=>new Date(E).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),_=E=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[E]||E,A=E=>({in:"#4caf50",out:"#f44336",transfer:"#2196f3",adjustment:"#ff9800"})[E]||"#666";return[w(yr,{get isOpen(){return ge(()=>!!t.isOpen)()&&!o()},get onClose(){return t.onClose},get title(){return e("inventory.viewHistoricalReports")},size:"large",get children(){var E=um();return E.style.setProperty("max-height","70vh"),E.style.setProperty("overflow-y","auto"),s(E,w(Re,{get when(){return a().length===0},get children(){var R=jI(),P=R.firstChild,k=P.nextSibling,K=k.nextSibling;return R.style.setProperty("text-align","center"),R.style.setProperty("padding","3rem"),R.style.setProperty("color","var(--text-muted)"),P.style.setProperty("font-size","2rem"),P.style.setProperty("margin-bottom","1rem"),k.style.setProperty("font-size","1.1rem"),k.style.setProperty("margin-bottom","0.5rem"),s(k,()=>e("inventory.noBulkReportsFound","No bulk movement reports found")),K.style.setProperty("font-size","0.9rem"),s(K,()=>e("inventory.bulkReportsAppearHere","Bulk movement reports will appear here after you create bulk movements")),R}}),null),s(E,w(Re,{get when(){return a().length>0},get children(){var R=um();return R.style.setProperty("display","grid"),R.style.setProperty("gap","1rem"),s(R,w(nt,{get each(){return a()},children:P=>(()=>{var k=qI(),K=k.firstChild,oe=K.firstChild,O=oe.firstChild,M=O.firstChild,N=M.nextSibling,g=O.nextSibling,v=K.nextSibling,f=v.firstChild,C=f.firstChild,S=C.nextSibling,x=f.nextSibling,m=x.firstChild,re=m.nextSibling,Y=x.nextSibling,$=Y.firstChild,V=$.nextSibling;return k.style.setProperty("padding","1.5rem"),k.style.setProperty("border","1px solid var(--border-color)"),k.style.setProperty("border-radius","var(--border-radius)"),k.style.setProperty("background","var(--surface-color)"),k.style.setProperty("transition","all 0.2s ease"),K.style.setProperty("display","flex"),K.style.setProperty("justify-content","space-between"),K.style.setProperty("align-items","flex-start"),K.style.setProperty("margin-bottom","1rem"),oe.style.setProperty("flex","1"),O.style.setProperty("display","flex"),O.style.setProperty("align-items","center"),O.style.setProperty("gap","1rem"),O.style.setProperty("margin-bottom","0.5rem"),M.style.setProperty("margin","0"),M.style.setProperty("font-size","1.1rem"),M.style.setProperty("color","var(--text-primary)"),s(M,()=>P.referenceNumber),N.style.setProperty("padding","0.25rem 0.75rem"),N.style.setProperty("border-radius","1rem"),N.style.setProperty("font-size","0.75rem"),N.style.setProperty("font-weight","500"),s(N,()=>_(P.movementType)),g.style.setProperty("color","var(--text-muted)"),g.style.setProperty("font-size","0.875rem"),s(g,()=>b(P.createdDate)),s(K,w(Le,{variant:"outline",size:"sm",onClick:()=>u(P.referenceNumber),get children(){return e("common.view")}}),null),v.style.setProperty("display","grid"),v.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),v.style.setProperty("gap","1rem"),v.style.setProperty("margin-bottom","1rem"),C.style.setProperty("font-size","0.75rem"),C.style.setProperty("font-weight","500"),C.style.setProperty("text-transform","uppercase"),C.style.setProperty("color","var(--text-muted)"),C.style.setProperty("margin-bottom","0.25rem"),s(C,()=>e("inventory.totalProducts")),S.style.setProperty("font-size","1.25rem"),S.style.setProperty("font-weight","600"),S.style.setProperty("color","var(--primary-color)"),s(S,()=>P.movements.length),m.style.setProperty("font-size","0.75rem"),m.style.setProperty("font-weight","500"),m.style.setProperty("text-transform","uppercase"),m.style.setProperty("color","var(--text-muted)"),m.style.setProperty("margin-bottom","0.25rem"),s(m,()=>e("inventory.totalItems")),re.style.setProperty("font-size","1.25rem"),re.style.setProperty("font-weight","600"),re.style.setProperty("color","var(--primary-color)"),s(re,()=>P.totalItems),$.style.setProperty("font-size","0.75rem"),$.style.setProperty("font-weight","500"),$.style.setProperty("text-transform","uppercase"),$.style.setProperty("color","var(--text-muted)"),$.style.setProperty("margin-bottom","0.25rem"),s($,()=>e("inventory.estimatedValue")),V.style.setProperty("font-size","1.25rem"),V.style.setProperty("font-weight","600"),V.style.setProperty("color","var(--primary-color)"),s(V,()=>y(P.totalValue)),le(Q=>{var L=A(P.movementType)+"20",D=A(P.movementType);return L!==Q.e&&((Q.e=L)!=null?N.style.setProperty("background",L):N.style.removeProperty("background")),D!==Q.t&&((Q.t=D)!=null?N.style.setProperty("color",D):N.style.removeProperty("color")),Q},{e:void 0,t:void 0}),k})()})),R}}),null),E}}),w(Re,{get when(){return o()},get children(){var E=zI(),R=E.firstChild,P=R.firstChild,k=P.firstChild,K=k.firstChild,oe=k.nextSibling,O=P.nextSibling;return E.style.setProperty("position","fixed"),E.style.setProperty("top","0"),E.style.setProperty("left","0"),E.style.setProperty("right","0"),E.style.setProperty("bottom","0"),E.style.setProperty("background","rgba(0, 0, 0, 0.5)"),E.style.setProperty("z-index","1000"),E.style.setProperty("display","flex"),E.style.setProperty("align-items","center"),E.style.setProperty("justify-content","center"),E.style.setProperty("padding","2rem"),R.style.setProperty("background","white"),R.style.setProperty("border-radius","var(--border-radius)"),R.style.setProperty("width","95%"),R.style.setProperty("max-width","1200px"),R.style.setProperty("max-height","90vh"),R.style.setProperty("overflow-y","auto"),R.style.setProperty("position","relative"),P.style.setProperty("padding","1rem 2rem"),P.style.setProperty("border-bottom","1px solid #e9ecef"),P.style.setProperty("display","flex"),P.style.setProperty("justify-content","space-between"),P.style.setProperty("align-items","center"),P.style.setProperty("background","#f8f9fa"),k.style.setProperty("margin","0"),s(k,()=>e("inventory.bulkMovementReport"),K),s(k,r,null),oe.$$click=h,oe.style.setProperty("background","none"),oe.style.setProperty("border","none"),oe.style.setProperty("font-size","1.5rem"),oe.style.setProperty("cursor","pointer"),oe.style.setProperty("padding","0.5rem"),oe.style.setProperty("line-height","1"),O.style.setProperty("padding","1rem"),s(O,w(Df,{get movements(){return c()},onClose:h})),E}})]};ft(["click"]);var HI=z("<div><h1></h1><div>"),Rr=z("<div>"),WI=z("<div><h3></h3><div>"),YI=z("<div>: <!> "),KI=z("<div><button></button><button></button><button></button><button>"),QI=z("<div><div>"),JI=z("<div><span> (<!>)</span><span> / <!> "),XI=z("<div><div><h2></h2></div><div>"),ZI=z("<div><div><div><span></span><h3></h3></div><div> • </div><div></div></div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div>:"),e$=z("<div><div><div><div></div><div></div></div><div><div> </div><div></div><div>Min: "),t$=z("<span>⚠️ LOW");const r$=()=>{const{t}=it(),[e,r]=fe(!1),[n,o]=fe(!1),[i,a]=fe(!1),[c,u]=fe(null),[h,y]=fe("overview"),[b,_]=fe("new"),[A,E]=fe(""),[R,P]=fe(""),[k,K]=fe([]),[oe,O]=fe(!1),[M,N]=fe(!1),[g,v]=fe(!1),[f,C]=fe(!1),[S,x]=fe(!1),[m,re]=fe(!1),[Y,$]=fe(1),[V,Q]=fe(20),L=ee=>{u(ee),a(!0)},D=ze(()=>{const ee=De.products||[],q=De.movements||[],he=De.stockLevels||[],ve=De.getLowStockProducts(),B=ee?.length||0,te=ee?.filter(me=>me.isActive).length,_e=he.reduce((me,be)=>me*1+be.quantity*1*be.averageCost*1,0),we=q?.filter(me=>{const be=new Date(me.createdDate),ie=new Date;return be.getMonth()===ie.getMonth()&&be.getFullYear()===ie.getFullYear()}).length;return{totalProducts:B,activeProducts:te,lowStockProducts:ve.length,totalStockValue:_e,totalMovementsThisMonth:we,totalLocations:De.locations.length,activeLocations:De.getActiveLocations().length}});ze(()=>De.products.map(ee=>{const q=De.getStockByProduct(ee.id),he=De.getTotalStockByProduct(ee.id),ve=De.getLastLocationByProduct(ee.id);return{...ee,totalStock:he,stockByLocation:q,lastLocation:ve,isLowStock:he<=ee.minStockLevel}})),ze(()=>{M(),$(1)});const j=(ee,q)=>ee<=q?t("inventory.lowStockAlert"):ee<=q*2?t("inventory.normalStock"):t("inventory.inStock"),ue=ee=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ee),W=ee=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ee),ce=ee=>{switch(ee){case"warehouse":return t("inventory.warehouse");case"store":return t("inventory.store");case"supplier":return t("inventory.supplier");case"customer":return t("inventory.customer");default:return ee}},T={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},G={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},Z=ee=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500",background:ee>50?"#d4edda":ee>20?"#fff3cd":"#f8d7da",color:ee>50?"#155724":ee>20?"#856404":"#721c24"}),F={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},ne={color:"var(--text-muted)","font-size":"0.875rem"},H={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},U={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},ae={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},se=ee=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:ee?"var(--primary-color)":"var(--text-muted)","border-bottom":ee?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),pe={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem","margin-bottom":"2rem"},de={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},ye=ze(()=>{const ee=De.movements;return{total:ee.length,stockIn:ee.filter(q=>q.movementType==="in").length,stockOut:ee.filter(q=>q.movementType==="out").length,transfers:ee.filter(q=>q.movementType==="transfer").length,adjustments:ee.filter(q=>q.movementType==="adjustment").length,totalValue:ee.reduce((q,he)=>q+he.totalCost,0)}}),X=async()=>{let ee="prod";await De.fecthInventory(ee),await De.fecthProduct(ee)};return Hr(()=>{X()}),w(Ur,{get title(){return t("inventory.title")},get children(){return[(()=>{var ee=HI(),q=ee.firstChild,he=q.nextSibling;return d(ee,U),q.style.setProperty("margin","0"),q.style.setProperty("font-size","1.75rem"),he.style.setProperty("display","flex"),he.style.setProperty("align-items","center"),he.style.setProperty("gap","1rem"),s(he,(()=>{var ve=ge(()=>b()==="new");return()=>ve()&&[w(Le,{variant:"outline",onClick:()=>x(!0),get children(){return["🔢 ",ge(()=>t("inventory.physicalCount","Physical Count"))]}}),w(Le,{variant:"outline",onClick:()=>re(!0),get children(){return["📊 ",ge(()=>t("inventory.viewHistoricalReports"))]}})]})(),null),s(he,w(Re,{get when(){return wt.hasPermission("read_write")},get children(){return w(Le,{variant:"primary",onClick:()=>o(!0),get children(){return ge(()=>b()==="new")()?t("inventory.addMovement"):t("common.add")}})}}),null),ee})(),w(UI,{}),w(Re,{get when(){return wt.hasPermission("inventoryDownsection")},get children(){return ge(()=>b()==="legacy")()?[(()=>{var ee=Rr();return s(ee,w(Ge,{get title(){return t("inventory.totalItems")},get subtitle(){return t("inventory.inStock")},get children(){var q=Rr();return q.style.setProperty("font-size","1.5rem"),q.style.setProperty("font-weight","600"),q.style.setProperty("color","var(--primary-color)"),s(q,()=>De.inventory.length),q}}),null),s(ee,w(Ge,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.itemsBelowThreshold")},get children(){var q=Rr();return q.style.setProperty("font-size","1.5rem"),q.style.setProperty("font-weight","600"),q.style.setProperty("color","var(--primary-color)"),s(q,()=>De.getLowStockItems().length),q}}),null),s(ee,w(Ge,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.inventoryWorth")},get children(){var q=Rr();return q.style.setProperty("font-size","1.5rem"),q.style.setProperty("font-weight","600"),q.style.setProperty("color","var(--primary-color)"),s(q,()=>ue(De.getTotalValue())),q}}),null),le(q=>d(ee,H,q)),ee})(),(()=>{var ee=Rr();return d(ee,T),s(ee,w(nt,{get each(){return De.inventory},children:q=>{const he=j(q.quantity,q.minStock),ve=q.quantity<=q.minStock?8:q.quantity<=q.minStock*2?35:75;return w(Ge,{onClick:()=>L(q),get children(){return[(()=>{var B=WI(),te=B.firstChild,_e=te.nextSibling;return d(B,G),te.style.setProperty("margin","0"),te.style.setProperty("font-size","1.1rem"),s(te,()=>q.name),s(_e,he),le(we=>d(_e,Z(ve),we)),B})(),(()=>{var B=Rr();return d(B,F),s(B,()=>ue(q.price)),B})(),(()=>{var B=YI(),te=B.firstChild,_e=te.nextSibling;return _e.nextSibling,d(B,ne),s(B,()=>t("inventory.quantity"),te),s(B,()=>q.quantity,_e),s(B,()=>t("common.units"),null),B})()]}})}})),ee})()]:[(()=>{var ee=KI(),q=ee.firstChild,he=q.nextSibling,ve=he.nextSibling,B=ve.nextSibling;return d(ee,ae),q.$$click=()=>y("overview"),s(q,()=>t("inventory.overview")),he.$$click=()=>y("products"),s(he,()=>t("inventory.products")),ve.$$click=()=>y("movements"),s(ve,()=>t("inventory.movements")),B.$$click=()=>y("locations"),s(B,()=>t("inventory.locations")),le(te=>{var _e=se(h()==="overview"),we=se(h()==="products"),me=se(h()==="movements"),be=se(h()==="locations");return te.e=d(q,_e,te.e),te.t=d(he,we,te.t),te.a=d(ve,me,te.a),te.o=d(B,be,te.o),te},{e:void 0,t:void 0,a:void 0,o:void 0}),ee})(),ge(()=>ge(()=>h()==="overview")()&&(()=>{var ee=QI(),q=ee.firstChild;return s(q,w(Ge,{get title(){return t("inventory.activeProducts")},get subtitle(){return t("inventory.currentlyManaged")},get children(){var he=Rr();return he.style.setProperty("font-size","1.5rem"),he.style.setProperty("font-weight","600"),he.style.setProperty("color","var(--primary-color)"),s(he,()=>D().activeProducts),he}}),null),s(q,w(Ge,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.needAttention")},get children(){var he=Rr();return he.style.setProperty("font-size","1.5rem"),he.style.setProperty("font-weight","600"),he.style.setProperty("color","#d32f2f"),s(he,()=>D().lowStockProducts),he}}),null),s(q,w(Ge,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.currentWorth")},get children(){var he=Rr();return he.style.setProperty("font-size","1.5rem"),he.style.setProperty("font-weight","600"),he.style.setProperty("color","var(--primary-color)"),s(he,()=>W(ye().totalValue)),he}}),null),s(q,w(Ge,{get title(){return t("inventory.movements")},get subtitle(){return t("inventory.thisMonth")},get children(){var he=Rr();return he.style.setProperty("font-size","1.5rem"),he.style.setProperty("font-weight","600"),he.style.setProperty("color","var(--primary-color)"),s(he,()=>D().totalMovementsThisMonth),he}}),null),s(q,w(Ge,{get title(){return t("inventory.activeLocations")},get subtitle(){return t("inventory.warehousesStores")},get children(){var he=Rr();return he.style.setProperty("font-size","1.5rem"),he.style.setProperty("font-weight","600"),he.style.setProperty("color","var(--primary-color)"),s(he,()=>D().activeLocations),he}}),null),s(ee,(()=>{var he=ge(()=>D().lowStockProducts>0);return()=>he()&&w(Ge,{get title(){return`⚠️ ${t("inventory.lowStockAlert")}`},get subtitle(){return`${D().lowStockProducts} ${t("inventory.productsNeedRestocking")}`},style:{"margin-bottom":"2rem","border-color":"#ffcdd2",background:"#ffebee"},get children(){var ve=Rr();return ve.style.setProperty("margin-top","1rem"),s(ve,w(nt,{get each(){return De.getLowStockProducts().slice(0,9)},children:B=>(()=>{var te=JI(),_e=te.firstChild,we=_e.firstChild,me=we.nextSibling;me.nextSibling;var be=_e.nextSibling,ie=be.firstChild,Pe=ie.nextSibling;return Pe.nextSibling,te.style.setProperty("display","flex"),te.style.setProperty("justify-content","space-between"),te.style.setProperty("margin-bottom","0.5rem"),te.style.setProperty("font-size","0.875rem"),s(_e,()=>B.name,we),s(_e,()=>B?.sku,me),be.style.setProperty("color","#d32f2f"),be.style.setProperty("font-weight","600"),s(be,()=>B.currentStock,ie),s(be,()=>B.minStockLevel,Pe),s(be,()=>t("inventory.min"),null),te})()}),null),s(ve,(()=>{var B=ge(()=>De.getLowStockProducts().length>5);return()=>B()&&(()=>{var te=Rr();return te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),te.style.setProperty("font-style","italic"),s(te,()=>t("common.andMore",{count:De.getLowStockProducts().length-9})),te})()})(),null),ve}})})(),null),le(he=>d(q,H,he)),ee})()),ge(()=>ge(()=>h()==="products")()&&w(Nf,{})),ge(()=>ge(()=>h()==="movements")()&&w(zx,{})),ge(()=>ge(()=>h()==="locations")()&&(()=>{var ee=XI(),q=ee.firstChild,he=q.firstChild,ve=q.nextSibling;return q.style.setProperty("display","flex"),q.style.setProperty("justify-content","space-between"),q.style.setProperty("align-items","center"),q.style.setProperty("margin-bottom","1.5rem"),he.style.setProperty("margin","0"),he.style.setProperty("font-size","1.5rem"),s(he,()=>t("inventory.locations")),s(q,w(Re,{get when(){return wt.hasPermission("read_write")},get children(){return w(Le,{variant:"primary",onClick:()=>v(!0),get children(){return["🏭 ",ge(()=>t("inventory.addLocation"))]}})}}),null),d(ve,pe),s(ve,w(nt,{get each(){return De.getActiveLocations()},children:B=>{const te=De.getStockByLocation(B.id),_e=te.length,we=te.reduce((be,ie)=>be*1+ie.quantity*1,0),me=te.reduce((be,ie)=>(De.getProductById(ie.productId),be+(ie?.averageCost||0)),0);return(()=>{var be=ZI(),ie=be.firstChild,Pe=ie.firstChild,Te=Pe.firstChild,$e=Te.nextSibling,Ee=Pe.nextSibling,Ve=Ee.firstChild,Ke=Ee.nextSibling,je=ie.nextSibling,Ce=je.firstChild,Be=Ce.firstChild,Je=Be.firstChild,Qe=Be.nextSibling,We=Ce.nextSibling,xe=We.firstChild,at=xe.firstChild,et=xe.nextSibling,bt=We.nextSibling,ht=bt.firstChild,Nt=ht.firstChild,jt=ht.nextSibling,Tt=je.nextSibling,Bt=Tt.firstChild,gt=Bt.firstChild;return ie.style.setProperty("margin-bottom","1rem"),ie.style.setProperty("padding-bottom","1rem"),ie.style.setProperty("border-bottom","1px solid var(--border-color)"),Pe.style.setProperty("display","flex"),Pe.style.setProperty("align-items","center"),Pe.style.setProperty("gap","0.5rem"),Pe.style.setProperty("margin-bottom","0.5rem"),Te.style.setProperty("font-size","1.2rem"),s(Te,()=>B.type==="warehouse"?"🏭":B.type==="store"?"🏪":B.type==="supplier"?"🚚":"👥"),$e.style.setProperty("margin","0"),$e.style.setProperty("font-size","1.1rem"),s($e,()=>B.name),Ee.style.setProperty("font-size","0.875rem"),Ee.style.setProperty("color","var(--text-muted)"),s(Ee,()=>B.code,Ve),s(Ee,()=>ce(B.type),null),Ke.style.setProperty("font-size","0.75rem"),Ke.style.setProperty("color","var(--text-muted)"),Ke.style.setProperty("margin-top","0.25rem"),s(Ke,()=>B.address),je.style.setProperty("margin-bottom","1rem"),Ce.style.setProperty("display","flex"),Ce.style.setProperty("justify-content","space-between"),Ce.style.setProperty("margin-bottom","0.5rem"),Be.style.setProperty("font-size","0.875rem"),Be.style.setProperty("font-weight","500"),s(Be,()=>t("inventory.products"),Je),Qe.style.setProperty("font-weight","600"),s(Qe,_e),We.style.setProperty("display","flex"),We.style.setProperty("justify-content","space-between"),We.style.setProperty("margin-bottom","0.5rem"),xe.style.setProperty("font-size","0.875rem"),xe.style.setProperty("font-weight","500"),s(xe,()=>t("inventory.totalItems"),at),et.style.setProperty("font-weight","600"),et.style.setProperty("color","var(--primary-color)"),s(et,we),bt.style.setProperty("display","flex"),bt.style.setProperty("justify-content","space-between"),bt.style.setProperty("margin-bottom","1rem"),ht.style.setProperty("font-size","0.875rem"),ht.style.setProperty("font-weight","500"),s(ht,()=>t("inventory.totalValue"),Nt),jt.style.setProperty("font-weight","600"),jt.style.setProperty("color","var(--primary-color)"),s(jt,()=>W(me)),Bt.style.setProperty("font-weight","600"),Bt.style.setProperty("margin-bottom","0.75rem"),Bt.style.setProperty("font-size","0.875rem"),Bt.style.setProperty("color","var(--text-primary)"),Bt.style.setProperty("border-bottom","1px solid var(--border-color)"),Bt.style.setProperty("padding-bottom","0.5rem"),s(Bt,()=>t("inventory.productDetails"),gt),s(Tt,(()=>{var er=ge(()=>te.length===0);return()=>er()?(()=>{var Ie=Rr();return Ie.style.setProperty("text-align","center"),Ie.style.setProperty("color","var(--text-muted)"),Ie.style.setProperty("font-style","italic"),Ie.style.setProperty("padding","1rem"),s(Ie,()=>t("inventory.noProducts")),Ie})():(()=>{var Ie=Rr();return Ie.style.setProperty("max-height","200px"),Ie.style.setProperty("overflow-y","auto"),Ie.style.setProperty("border","1px solid var(--border-color)"),Ie.style.setProperty("border-radius","var(--border-radius-sm)"),s(Ie,w(nt,{each:te,children:St=>{const Oe=De.getProductById(St.productId);if(!Oe)return null;const Fe=St.quantity<=Oe.minStockLevel,Ze=St.averageCost;return St.quantity?(()=>{var rt=e$(),Ct=rt.firstChild,Xe=Ct.firstChild,lt=Xe.firstChild,mt=lt.nextSibling,At=Xe.nextSibling,Me=At.firstChild,Jt=Me.firstChild,vt=Me.nextSibling,_t=vt.nextSibling;return _t.firstChild,rt.style.setProperty("padding","0.75rem"),rt.style.setProperty("border-bottom","1px solid var(--border-color)"),(Fe?"#fff5f5":"transparent")!=null?rt.style.setProperty("background",Fe?"#fff5f5":"transparent"):rt.style.removeProperty("background"),rt.style.setProperty("transition","background-color 0.2s ease"),Ct.style.setProperty("display","flex"),Ct.style.setProperty("justify-content","space-between"),Ct.style.setProperty("align-items","flex-start"),Ct.style.setProperty("margin-bottom","0.25rem"),Xe.style.setProperty("flex","1"),lt.style.setProperty("font-weight","500"),lt.style.setProperty("font-size","0.875rem"),(Fe?"#d32f2f":"var(--text-primary)")!=null?lt.style.setProperty("color",Fe?"#d32f2f":"var(--text-primary)"):lt.style.removeProperty("color"),s(lt,()=>Oe.name,null),s(lt,Fe&&(()=>{var kt=t$();return kt.style.setProperty("margin-left","0.5rem"),kt.style.setProperty("font-size","0.7rem"),kt.style.setProperty("color","#d32f2f"),kt})(),null),mt.style.setProperty("font-size","0.75rem"),mt.style.setProperty("color","var(--text-muted)"),mt.style.setProperty("margin-top","0.1rem"),s(mt,()=>Oe.sku,null),s(mt,()=>Oe.UPC?" • "+Oe.UPC:"",null),s(mt,()=>Oe.category?" • "+Oe.category:"",null),At.style.setProperty("text-align","right"),Me.style.setProperty("font-weight","600"),Me.style.setProperty("font-size","0.875rem"),(Fe?"#d32f2f":"var(--primary-color)")!=null?Me.style.setProperty("color",Fe?"#d32f2f":"var(--primary-color)"):Me.style.removeProperty("color"),s(Me,()=>St.quantity,Jt),s(Me,()=>Oe.unitOfMeasure,null),vt.style.setProperty("font-size","0.75rem"),vt.style.setProperty("color","var(--text-muted)"),s(vt,()=>W(Ze)),_t.style.setProperty("font-size","0.7rem"),_t.style.setProperty("color","var(--text-muted)"),_t.style.setProperty("margin-top","0.1rem"),s(_t,()=>Oe.minStockLevel,null),rt})():null}})),Ie})()})(),null),le(er=>d(be,{...de,"min-height":"400px"},er)),be})()}})),ee})())]}}),w(Re,{get when(){return wt.hasPermission("read_write")},get children(){return[w(GA,{get isOpen(){return e()},onClose:()=>r(!1),get mode(){return b()==="new"?"movement":"legacy"}}),w(ux,{get isOpen(){return n()},onClose:()=>o(!1)}),w(fx,{get isOpen(){return i()},onClose:()=>a(!1),get item(){return c()}}),w(Nd,{get isOpen(){return g()},onClose:()=>v(!1),onLocationAdded:()=>{v(!1)}})]}}),w(tI,{get isOpen(){return S()},onClose:()=>x(!1)}),w(GI,{get isOpen(){return m()},onClose:()=>re(!1)})]}})};ft(["click"]);const n$=[{id:"1",name:"John Doe",position:"Software Engineer",salary:85e3,email:"john.doe@company.com",phone:"+1 (555) 123-4567",department:"Engineering",startDate:"2023-01-15"},{id:"2",name:"Jane Smith",position:"Product Manager",salary:95e3,email:"jane.smith@company.com",phone:"+1 (555) 234-5678",department:"Product",startDate:"2022-08-20"},{id:"3",name:"Mike Brown",position:"Designer",salary:7e4,email:"mike.brown@company.com",phone:"+1 (555) 345-6789",department:"Design",startDate:"2023-03-10"},{id:"4",name:"Sarah Kim",position:"HR Manager",salary:78e3,email:"sarah.kim@company.com",phone:"+1 (555) 456-7890",department:"Human Resources",startDate:"2022-11-05"},{id:"5",name:"Alex Lee",position:"Data Analyst",salary:72e3,email:"alex.lee@company.com",phone:"+1 (555) 567-8901",department:"Analytics",startDate:"2023-02-28"},{id:"6",name:"Emma Wilson",position:"Marketing Manager",salary:82e3,email:"emma.wilson@company.com",phone:"+1 (555) 678-9012",department:"Marketing",startDate:"2022-09-15"}],[Di,Ml]=fe(n$),Lf={get employees(){return Di()},addEmployee(t){const e={...t,id:Date.now().toString()};return Ml([...Di(),e]),e},updateEmployee(t,e){Ml(Di().map(r=>r.id===t?{...r,...e}:r))},deleteEmployee(t){Ml(Di().filter(e=>e.id!==t))},getEmployeeById(t){return Di().find(e=>e.id===t)}};var o$=z("<form><div>");const i$=t=>{const{t:e}=it(),[r,n]=fe({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),o=[{value:"Engineering",label:e("employees.departments.engineering","Engineering")},{value:"Product",label:e("employees.departments.product","Product")},{value:"Design",label:e("employees.departments.design","Design")},{value:"Marketing",label:e("employees.departments.marketing","Marketing")},{value:"Sales",label:e("employees.departments.sales","Sales")},{value:"Human Resources",label:e("employees.departments.humanResources","Human Resources")},{value:"Finance",label:e("employees.departments.finance","Finance")},{value:"Operations",label:e("employees.departments.operations","Operations")},{value:"Analytics",label:e("employees.departments.analytics","Analytics")}],i={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},a=u=>{u.preventDefault();const h=r();if(!h.name||!h.position||!h.salary||!h.email||!h.department||!h.startDate){alert(e("forms.requiredField"));return}const y={name:h.name,position:h.position,salary:parseFloat(h.salary),email:h.email,phone:h.phone,department:h.department,startDate:h.startDate};Lf.addEmployee(y),n({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),t.onClose()},c=(u,h)=>{n(y=>({...y,[u]:h}))};return w(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.addEmployee")},get children(){var u=o$(),h=u.firstChild;return u.addEventListener("submit",a),s(u,w(Ot,{get label(){return e("employees.fullName")},get value(){return r().name},onChange:y=>c("name",y),get placeholder(){return e("employees.enterFullName","Enter employee's full name")},required:!0}),h),s(u,w(Ot,{get label(){return e("employees.position")},get value(){return r().position},onChange:y=>c("position",y),get placeholder(){return e("employees.enterPosition","Enter job position")},required:!0}),h),s(u,w(vr,{get label(){return e("employees.department")},get value(){return r().department},onChange:y=>c("department",y),options:o,required:!0}),h),s(u,w(Ot,{get label(){return e("employees.email")},type:"email",get value(){return r().email},onChange:y=>c("email",y),get placeholder(){return e("employees.enterEmail","Enter email address")},required:!0}),h),s(u,w(Ot,{get label(){return e("employees.phone")},type:"tel",get value(){return r().phone},onChange:y=>c("phone",y),get placeholder(){return e("employees.enterPhone","Enter phone number")}}),h),s(u,w(Ot,{get label(){return e("employees.salary")},type:"number",get value(){return r().salary},onChange:y=>c("salary",y),get placeholder(){return e("employees.enterSalary","Enter annual salary")},required:!0}),h),s(u,w(Ot,{get label(){return e("employees.hireDate")},type:"date",get value(){return r().startDate},onChange:y=>c("startDate",y),required:!0}),h),d(h,i),s(h,w(Le,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(h,w(Le,{variant:"primary",type:"submit",get children(){return e("employees.addEmployee")}}),null),u}})};var s$=z("<div><div></div><div></div><div>"),a$=z("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),l$=z("<div>");const c$=t=>{const{t:e}=it(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},o={"font-weight":"600",color:"var(--text-primary)"},i={width:"80px",height:"80px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.5rem",margin:"0 auto 1.5rem auto"},a={"text-align":"center","margin-bottom":"2rem"},c={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},u={color:"var(--text-muted)","font-size":"1rem"},h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"};if(!t.employee)return null;const y=A=>A.split(" ").map(E=>E[0]).join("").toUpperCase(),b=A=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(A),_=A=>new Date(A).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return w(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.employeeDetails")},get children(){return[(()=>{var A=s$(),E=A.firstChild,R=E.nextSibling,P=R.nextSibling;return d(A,a),d(E,i),s(E,()=>y(t.employee.name)),d(R,c),s(R,()=>t.employee.name),d(P,u),s(P,()=>t.employee.position),A})(),(()=>{var A=a$(),E=A.firstChild,R=E.firstChild,P=R.nextSibling,k=E.nextSibling,K=k.firstChild,oe=K.nextSibling,O=k.nextSibling,M=O.firstChild,N=M.nextSibling,g=O.nextSibling,v=g.firstChild,f=v.nextSibling,C=g.nextSibling,S=C.firstChild,x=S.nextSibling,m=C.nextSibling,re=m.firstChild,Y=re.nextSibling;return s(R,()=>e("employees.employeeId")),s(P,()=>t.employee.id),s(K,()=>e("employees.department")),s(oe,()=>t.employee.department),s(M,()=>e("employees.email")),s(N,()=>t.employee.email),s(v,()=>e("employees.phone")),s(f,()=>t.employee.phone),s(S,()=>e("employees.salary")),s(x,()=>b(t.employee.salary)),s(re,()=>e("employees.hireDate")),s(Y,()=>_(t.employee.startDate)),le($=>{var V=r,Q=n,L=o,D=r,j=n,ue=o,W=r,ce=n,T=o,G=r,Z=n,F=o,ne=r,H=n,U=o,ae=r,se=n,pe=o;return $.e=d(E,V,$.e),$.t=d(R,Q,$.t),$.a=d(P,L,$.a),$.o=d(k,D,$.o),$.i=d(K,j,$.i),$.n=d(oe,ue,$.n),$.s=d(O,W,$.s),$.h=d(M,ce,$.h),$.r=d(N,T,$.r),$.d=d(g,G,$.d),$.l=d(v,Z,$.l),$.u=d(f,F,$.u),$.c=d(C,ne,$.c),$.w=d(S,H,$.w),$.m=d(x,U,$.m),$.f=d(m,ae,$.f),$.y=d(re,se,$.y),$.g=d(Y,pe,$.g),$},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),A})(),(()=>{var A=l$();return d(A,h),s(A,w(Le,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(A,w(Le,{variant:"primary",onClick:()=>{console.log("Edit employee:",t.employee.id)},get children(){return e("employees.editEmployee")}}),null),A})()]}})};var hm=z("<div>"),d$=z("<div><div></div><div><div></div><div></div><div>/year");const u$=()=>{const{t}=it(),[e,r]=fe(!1),[n,o]=fe(!1),[i,a]=fe(null),c=R=>{a(R),o(!0)},u={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},h={display:"flex","align-items":"center",gap:"1rem"},y={width:"60px",height:"60px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.2rem"},b={flex:"1"},_={"font-weight":"600","margin-bottom":"0.25rem"},A={color:"var(--text-muted)","font-size":"0.875rem","margin-bottom":"0.5rem"},E={color:"var(--primary-color)","font-weight":"500"};return w(Ur,{get title(){return t("employees.title")},get children(){return[(()=>{var R=hm();return R.style.setProperty("margin-bottom","2rem"),s(R,w(Le,{variant:"primary",onClick:()=>r(!0),get children(){return t("employees.addEmployee")}})),R})(),(()=>{var R=hm();return d(R,u),s(R,()=>Lf.employees.map(P=>{const k=oe=>oe.split(" ").map(O=>O[0]).join("").toUpperCase(),K=oe=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(oe);return w(Ge,{onClick:()=>c(P),get children(){var oe=d$(),O=oe.firstChild,M=O.nextSibling,N=M.firstChild,g=N.nextSibling,v=g.nextSibling,f=v.firstChild;return d(oe,h),d(O,y),s(O,()=>k(P.name)),d(M,b),d(N,_),s(N,()=>P.name),d(g,A),s(g,()=>P.position),d(v,E),s(v,()=>K(P.salary),f),oe}})})),R})(),w(i$,{get isOpen(){return e()},onClose:()=>r(!1)}),w(c$,{get isOpen(){return n()},onClose:()=>o(!1),get employee(){return i()}})]}})},h$=[{id:"1",accountId:"1002",bankName:"First National Bank",accountNumber:"****1234",accountType:"checking",currency:"USD",currentBalance:32730.5,lastReconciledDate:"2024-01-01",lastReconciledBalance:3e4,isActive:!0},{id:"2",accountId:"1003",bankName:"First National Bank",accountNumber:"****5678",accountType:"savings",currency:"USD",currentBalance:12e3,lastReconciledDate:"2024-01-01",lastReconciledBalance:1e4,isActive:!0}],m$=[{id:"1",accountId:"1002",date:"2024-01-15",description:"Customer Payment - ABC Corp",reference:"CHK001234",debitAmount:5e3,creditAmount:0,balance:35730.5,category:"Customer Payment",isReconciled:!0,reconciledWith:"eb1",importedAt:"2024-01-16",source:"csv_import"},{id:"2",accountId:"1002",date:"2024-01-14",description:"Office Supplies - Staples",reference:"CHK001235",debitAmount:0,creditAmount:250,balance:30730.5,category:"Office Expenses",isReconciled:!0,reconciledWith:"eb2",importedAt:"2024-01-16",source:"csv_import"},{id:"3",accountId:"1002",date:"2024-01-13",description:"Monthly Rent Payment",reference:"CHK001236",debitAmount:0,creditAmount:2e3,balance:28730.5,category:"Rent",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"},{id:"4",accountId:"1002",date:"2024-01-12",description:"Wire Transfer In",reference:"WIRE001",debitAmount:1e4,creditAmount:0,balance:38730.5,category:"Wire Transfer",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"}],y$=[{id:"eb1",accountId:"1002",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",debitAmount:5e3,creditAmount:0,category:"Accounts Receivable",isReconciled:!0,reconciledWith:"1",createdAt:"2024-01-15"},{id:"eb2",accountId:"1002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",debitAmount:0,creditAmount:250,category:"Office Expenses",isReconciled:!0,reconciledWith:"2",createdAt:"2024-01-14"},{id:"eb3",accountId:"1002",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",debitAmount:0,creditAmount:3500,category:"Salary Expense",isReconciled:!1,createdAt:"2024-01-11"}],p$=[{id:"1",bankAccountId:"1",periodStart:"2024-01-01",periodEnd:"2024-01-15",startingBalance:3e4,endingBalance:35730.5,status:"in_progress",totalBankTransactions:4,totalEntryBookRecords:3,reconciledTransactions:2,unreconciledTransactions:2,discrepancyAmount:1500,createdAt:"2024-01-16",notes:"Wire transfer and rent payment need investigation"}],[Ys,mm]=fe(h$),[Gn,Ol]=fe(m$),[Ni,ym]=fe(y$),[Ks,pm]=fe(p$),cr={get bankAccounts(){return Ys()},addBankAccount(t){const e={...t,id:Date.now().toString()};return mm([...Ys(),e]),e},updateBankAccount(t,e){mm(Ys().map(r=>r.id===t?{...r,...e}:r))},getBankAccountById(t){return Ys().find(e=>e.id===t)},get bankStatements(){return Gn()},addBankStatement(t){const e={...t,id:Date.now().toString(),importedAt:new Date().toISOString()};return Ol([...Gn(),e]),e},addBankStatementsFromCSV(t){const e=t.map(r=>({...r,id:`csv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,importedAt:new Date().toISOString(),source:"csv_import",isReconciled:!1}));return Ol([...Gn(),...e]),e},updateBankStatement(t,e){Ol(Gn().map(r=>r.id===t?{...r,...e}:r))},getBankStatementsByAccount(t){return Gn().filter(e=>e.accountId===t)},getUnreconciledBankStatements(t){return(t?this.getBankStatementsByAccount(t):Gn()).filter(r=>!r.isReconciled)},get entryBookRecords(){return Ni()},addEntryBookRecord(t){const e={...t,id:Date.now().toString(),createdAt:new Date().toISOString()};return ym([...Ni(),e]),e},updateEntryBookRecord(t,e){ym(Ni().map(r=>r.id===t?{...r,...e}:r))},getEntryBookRecordsByAccount(t){return Ni().filter(e=>e.accountId===t)},getUnreconciledEntryBookRecords(t){return(t?this.getEntryBookRecordsByAccount(t):Ni()).filter(r=>!r.isReconciled)},reconcileTransaction(t,e){this.updateBankStatement(t,{isReconciled:!0,reconciledWith:e}),this.updateEntryBookRecord(e,{isReconciled:!0,reconciledWith:t})},unreconciledTransaction(t){const e=Gn().find(r=>r.id===t);e?.reconciledWith&&this.updateEntryBookRecord(e.reconciledWith,{isReconciled:!1,reconciledWith:void 0}),this.updateBankStatement(t,{isReconciled:!1,reconciledWith:void 0})},findPotentialMatches(t){const e=Gn().find(n=>n.id===t);return e?this.getUnreconciledEntryBookRecords(e.accountId).filter(n=>{const o=Math.abs(e.debitAmount-n.debitAmount)<.01||Math.abs(e.creditAmount-n.creditAmount)<.01,i=new Date(e.date),a=new Date(n.date),u=Math.abs((i.getTime()-a.getTime())/(1e3*60*60*24))<=3,h=e.reference===n.reference||e.description.toLowerCase().includes(n.description.toLowerCase())||n.description.toLowerCase().includes(e.description.toLowerCase());return o&&(u||h)}).sort((n,o)=>{const i=(n.date===e.date?2:0)+(n.reference===e.reference?1:0);return(o.date===e.date?2:0)+(o.reference===e.reference?1:0)-i}):[]},get reconciliationSessions(){return Ks()},startReconciliationSession(t,e,r){const n=this.getBankStatementsByAccount(t).filter(h=>h.date>=e&&h.date<=r),o=this.getEntryBookRecordsByAccount(t).filter(h=>h.date>=e&&h.date<=r),i=n.filter(h=>h.isReconciled).length,a=this.getBankAccountById(t)?.lastReconciledBalance||0,c=this.getBankAccountById(t)?.currentBalance||0,u={id:Date.now().toString(),bankAccountId:t,periodStart:e,periodEnd:r,startingBalance:a,endingBalance:c,status:"in_progress",totalBankTransactions:n.length,totalEntryBookRecords:o.length,reconciledTransactions:i,unreconciledTransactions:n.length-i,discrepancyAmount:0,createdAt:new Date().toISOString()};return pm([...Ks(),u]),u},updateReconciliationSession(t,e){pm(Ks().map(r=>r.id===t?{...r,...e}:r))},getReconciliationSessionsByAccount(t){return Ks().filter(e=>e.bankAccountId===t)}};var Vl=z("<div>"),f$=z("<div><strong>:</strong> <!> - "),g$=z("<div><div><div>📄</div><div></div><div></div></div><input id=csvFileInput type=file accept=.csv>"),v$=z("<div><h4></h4><div><div><label> *</label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value>"),Ho=z("<option>"),b$=z("<div><table><thead><tr></tr></thead><tbody>"),_$=z("<th>"),P$=z("<tr>"),S$=z("<td>");const w$=t=>{const{t:e}=it(),[r,n]=fe(!1),[o,i]=fe(!1),[a,c]=fe(null),[u,h]=fe([]),[y,b]=fe({date:"",description:"",reference:"",debit:"",credit:"",balance:""}),_={border:`2px dashed ${r()?"var(--primary-color)":"var(--border-color)"}`,"border-radius":"var(--border-radius)",padding:"2rem","text-align":"center","background-color":r()?"var(--background-color)":"transparent",transition:"all 0.2s ease",cursor:"pointer"},A={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem","margin-top":"1.5rem"},E={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-family":"inherit"},R={"max-height":"200px","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},P={width:"100%","border-collapse":"collapse","font-size":"0.875rem"},k={padding:"0.5rem","border-bottom":"1px solid var(--border-color)","text-align":"left"},K={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},oe=x=>{x.preventDefault(),n(!0)},O=x=>{x.preventDefault(),n(!1)},M=x=>{x.preventDefault(),n(!1);const m=x.dataTransfer?.files;m&&m.length>0&&g(m[0])},N=x=>{const m=x.target;m.files&&m.files.length>0&&g(m.files[0])},g=x=>{if(!x.name.toLowerCase().endsWith(".csv")){c({success:!1,message:e("banking.pleaseUploadCSV")});return}i(!0);const m=new FileReader;m.onload=re=>{try{const $=(re.target?.result).split(`
`).filter(D=>D.trim());if($.length<2){c({success:!1,message:e("banking.csvRequiresHeaderAndData")}),i(!1);return}const V=$[0].split(",").map(D=>D.trim().replace(/[\"\']/g,"")),Q=$.slice(1).map(D=>{const j=D.split(",").map(W=>W.trim().replace(/[\"\']/g,"")),ue={};return V.forEach((W,ce)=>{ue[W]=j[ce]||""}),ue});h(Q),c({success:!0,message:e("banking.successfullyParsed").replace("{count}",Q.length.toString()),count:Q.length});const L={...y()};V.forEach(D=>{const j=D.toLowerCase();j.includes("date")&&(L.date=D),(j.includes("description")||j.includes("memo"))&&(L.description=D),(j.includes("reference")||j.includes("check")||j.includes("ref"))&&(L.reference=D),(j.includes("debit")||j.includes("deposit"))&&(L.debit=D),(j.includes("credit")||j.includes("withdrawal")||j.includes("amount"))&&(L.debit?L.credit=D:L.debit=D),j.includes("balance")&&(L.balance=D)}),b(L)}catch{c({success:!1,message:e("banking.errorParsingCSV")})}i(!1)},m.readAsText(x)},v=(x,m)=>{b(re=>({...re,[x]:m}))},f=()=>u().length===0?[]:Object.keys(u()[0]),C=()=>{if(!t.bankAccount||u().length===0)return;const x=y();if(!x.date||!x.description){c({success:!1,message:e("banking.dateDescriptionRequired")});return}i(!0);try{const m=u().map(Y=>{const $=D=>D&&parseFloat(D.replace(/[^0-9.-]/g,""))||0,V=D=>{const j=new Date(D);if(isNaN(j.getTime())){const ue=D.split("/");if(ue.length===3)return new Date(parseInt(ue[2]),parseInt(ue[0])-1,parseInt(ue[1])).toISOString().split("T")[0]}return j.toISOString().split("T")[0]};let Q=0,L=0;if(x.debit&&x.credit)Q=$(Y[x.debit]),L=$(Y[x.credit]);else if(x.debit){const D=$(Y[x.debit]);D>0?Q=D:L=Math.abs(D)}return{accountId:t.bankAccount.accountId,date:V(Y[x.date]),description:Y[x.description]||e("banking.importedTransaction"),reference:Y[x.reference]||"",debitAmount:Q,creditAmount:L,balance:x.balance?$(Y[x.balance]):0,isReconciled:!1}}),re=cr.addBankStatementsFromCSV(m);c({success:!0,message:e("banking.successfullyImported").replace("{count}",re.length.toString()),count:re.length}),h([]),b({date:"",description:"",reference:"",debit:"",credit:"",balance:""})}catch{c({success:!1,message:e("banking.errorImportingTransactions")})}i(!1)},S=()=>{h([]),c(null),b({date:"",description:"",reference:"",debit:"",credit:"",balance:""})};return w(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("banking.importBankStatementCSV")},get children(){return[ge(()=>ge(()=>!!t.bankAccount)()&&(()=>{var x=f$(),m=x.firstChild,re=m.firstChild,Y=m.nextSibling,$=Y.nextSibling;return $.nextSibling,x.style.setProperty("margin-bottom","1.5rem"),x.style.setProperty("padding","1rem"),x.style.setProperty("background","var(--background-color)"),x.style.setProperty("border-radius","var(--border-radius-sm)"),x.style.setProperty("border","1px solid var(--border-color)"),s(m,()=>e("banking.bankAccount"),re),s(x,()=>t.bankAccount.bankName,$),s(x,()=>t.bankAccount.accountNumber,null),x})()),ge(()=>ge(()=>u().length===0)()?(()=>{var x=g$(),m=x.firstChild,re=m.firstChild,Y=re.nextSibling,$=Y.nextSibling,V=m.nextSibling;return m.$$click=()=>document.getElementById("csvFileInput")?.click(),m.addEventListener("drop",M),m.addEventListener("dragleave",O),m.addEventListener("dragover",oe),re.style.setProperty("font-size","2rem"),re.style.setProperty("margin-bottom","1rem"),Y.style.setProperty("font-weight","500"),Y.style.setProperty("margin-bottom","0.5rem"),s(Y,(()=>{var Q=ge(()=>!!r());return()=>Q()?e("banking.dropCSVHere"):e("banking.clickToUploadCSV")})()),$.style.setProperty("font-size","0.875rem"),$.style.setProperty("color","var(--text-muted)"),s($,()=>e("banking.supportedFormat")),V.addEventListener("change",N),V.style.setProperty("display","none"),le(Q=>d(m,_,Q)),x})():(()=>{var x=v$(),m=x.firstChild,re=m.nextSibling,Y=re.firstChild,$=Y.firstChild,V=$.firstChild,Q=$.nextSibling,L=Q.firstChild,D=Y.nextSibling,j=D.firstChild,ue=j.firstChild,W=j.nextSibling,ce=W.firstChild,T=D.nextSibling,G=T.firstChild,Z=G.nextSibling,F=Z.firstChild,ne=T.nextSibling,H=ne.firstChild,U=H.firstChild,ae=H.nextSibling,se=ae.firstChild,pe=ne.nextSibling,de=pe.firstChild,ye=de.nextSibling,X=ye.firstChild,ee=pe.nextSibling,q=ee.firstChild,he=q.nextSibling,ve=he.firstChild;return m.style.setProperty("margin","0 0 1rem 0"),s(m,()=>e("banking.mapCSVColumns")),d(re,A),$.style.setProperty("display","block"),$.style.setProperty("margin-bottom","0.5rem"),$.style.setProperty("font-weight","500"),s($,()=>e("banking.dateColumn"),V),Q.addEventListener("change",B=>v("date",B.target.value)),s(L,()=>e("banking.selectColumn")),s(Q,()=>f().map(B=>(()=>{var te=Ho();return te.value=B,s(te,B),te})()),null),j.style.setProperty("display","block"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-weight","500"),s(j,()=>e("banking.descriptionColumn"),ue),W.addEventListener("change",B=>v("description",B.target.value)),s(ce,()=>e("banking.selectColumn")),s(W,()=>f().map(B=>(()=>{var te=Ho();return te.value=B,s(te,B),te})()),null),G.style.setProperty("display","block"),G.style.setProperty("margin-bottom","0.5rem"),G.style.setProperty("font-weight","500"),s(G,()=>e("banking.referenceColumn")),Z.addEventListener("change",B=>v("reference",B.target.value)),s(F,()=>e("banking.selectColumn")),s(Z,()=>f().map(B=>(()=>{var te=Ho();return te.value=B,s(te,B),te})()),null),H.style.setProperty("display","block"),H.style.setProperty("margin-bottom","0.5rem"),H.style.setProperty("font-weight","500"),s(H,()=>e("banking.amountDebitColumn"),U),ae.addEventListener("change",B=>v("debit",B.target.value)),s(se,()=>e("banking.selectColumn")),s(ae,()=>f().map(B=>(()=>{var te=Ho();return te.value=B,s(te,B),te})()),null),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),s(de,()=>e("banking.creditColumn")),ye.addEventListener("change",B=>v("credit",B.target.value)),s(X,()=>e("banking.selectColumn")),s(ye,()=>f().map(B=>(()=>{var te=Ho();return te.value=B,s(te,B),te})()),null),q.style.setProperty("display","block"),q.style.setProperty("margin-bottom","0.5rem"),q.style.setProperty("font-weight","500"),s(q,()=>e("banking.balanceColumn")),he.addEventListener("change",B=>v("balance",B.target.value)),s(ve,()=>e("banking.selectColumn")),s(he,()=>f().map(B=>(()=>{var te=Ho();return te.value=B,s(te,B),te})()),null),s(x,(()=>{var B=ge(()=>u().length>0);return()=>B()&&(()=>{var te=b$(),_e=te.firstChild,we=_e.firstChild,me=we.firstChild,be=we.nextSibling;return d(te,R),me.style.setProperty("background-color","var(--background-color)"),s(me,()=>f().slice(0,6).map(ie=>(()=>{var Pe=_$();return s(Pe,ie),le(Te=>d(Pe,k,Te)),Pe})())),s(be,()=>u().slice(0,3).map(ie=>(()=>{var Pe=P$();return s(Pe,()=>f().slice(0,6).map(Te=>(()=>{var $e=S$();return s($e,()=>ie[Te]),le(Ee=>d($e,k,Ee)),$e})())),Pe})())),s(te,(()=>{var ie=ge(()=>u().length>3);return()=>ie()&&(()=>{var Pe=Vl();return Pe.style.setProperty("padding","0.5rem"),Pe.style.setProperty("text-align","center"),Pe.style.setProperty("color","var(--text-muted)"),s(Pe,()=>e("banking.andMoreRows").replace("{count}",(u().length-3).toString())),Pe})()})(),null),le(ie=>d(_e,P,ie)),te})()})(),null),le(B=>{var te=E,_e=E,we=E,me=E,be=E,ie=E;return B.e=d(Q,te,B.e),B.t=d(W,_e,B.t),B.a=d(Z,we,B.a),B.o=d(ae,me,B.o),B.i=d(ye,be,B.i),B.n=d(he,ie,B.n),B},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),le(()=>Q.value=y().date),le(()=>W.value=y().description),le(()=>Z.value=y().reference),le(()=>ae.value=y().debit),le(()=>ye.value=y().credit),le(()=>he.value=y().balance),x})()),ge(()=>ge(()=>!!a())()&&(()=>{var x=Vl();return x.style.setProperty("padding","1rem"),x.style.setProperty("border-radius","var(--border-radius-sm)"),x.style.setProperty("margin-top","1rem"),s(x,()=>a().message),le(m=>{var re=a().success?"#d4edda":"#f8d7da",Y=a().success?"#155724":"#721c24",$=`1px solid ${a().success?"#c3e6cb":"#f5c6cb"}`;return re!==m.e&&((m.e=re)!=null?x.style.setProperty("background",re):x.style.removeProperty("background")),Y!==m.t&&((m.t=Y)!=null?x.style.setProperty("color",Y):x.style.removeProperty("color")),$!==m.a&&((m.a=$)!=null?x.style.setProperty("border",$):x.style.removeProperty("border")),m},{e:void 0,t:void 0,a:void 0}),x})()),(()=>{var x=Vl();return d(x,K),s(x,w(Le,{variant:"secondary",onClick:()=>{S(),t.onClose()},get children(){return e("common.cancel")}}),null),s(x,(()=>{var m=ge(()=>u().length>0);return()=>m()&&w(Le,{variant:"outline",onClick:S,get children(){return e("common.reset")}})})(),null),s(x,(()=>{var m=ge(()=>u().length>0);return()=>m()&&w(Le,{variant:"primary",onClick:C,get disabled(){return o()||!y().date||!y().description},get children(){return ge(()=>!!o())()?e("banking.importing"):e("banking.importTransactions").replace("{count}",u().length.toString())}})})(),null),x})()]}})};ft(["click"]);var fm=z("<span>"),Qs=z("<div>"),gm=z("<div> "),C$=z("<div><div><h3></h3><div><button></button><button></button><button></button></div></div><div></div><div><div><h4></h4><div></div></div><div><h4></h4><div>"),A$=z("<div><div><div></div><div> • </div></div><div><div>"),Fl=z("<span>✓ "),x$=z("<span>(<!>)"),I$=z("<div><strong>:</strong> "),vm=z("<div><div><div></div><div> • </div></div><div>"),$$=z("<div><div>:</div><div></div><div>");const E$=t=>{const{t:e}=it(),[r,n]=fe([]),[o,i]=fe([]),[a,c]=fe(null),[u,h]=fe([]),[y,b]=fe("unreconciled");Nn(()=>{const $=cr.getBankAccountById(t.bankAccountId);if($){const V=cr.getBankStatementsByAccount($.accountId).filter(L=>L.date>=t.selectedPeriod.start&&L.date<=t.selectedPeriod.end),Q=cr.getEntryBookRecordsByAccount($.accountId).filter(L=>L.date>=t.selectedPeriod.start&&L.date<=t.selectedPeriod.end);n(V),i(Q)}});const _=()=>{const $=r();switch(y()){case"reconciled":return $.filter(V=>V.isReconciled);case"unreconciled":return $.filter(V=>!V.isReconciled);default:return $}},A=()=>{const $=o();switch(y()){case"reconciled":return $.filter(V=>V.isReconciled);case"unreconciled":return $.filter(V=>!V.isReconciled);default:return $}},E=$=>{if(c($),$.isReconciled)h([]);else{const V=cr.findPotentialMatches($.id);h(V)}},R=$=>{const V=a();if(V){cr.reconcileTransaction(V.id,$.id);const Q=cr.getBankAccountById(t.bankAccountId);if(Q){const L=cr.getBankStatementsByAccount(Q.accountId).filter(j=>j.date>=t.selectedPeriod.start&&j.date<=t.selectedPeriod.end),D=cr.getEntryBookRecordsByAccount(Q.accountId).filter(j=>j.date>=t.selectedPeriod.start&&j.date<=t.selectedPeriod.end);n(L),i(D)}c(null),h([])}},P=$=>{cr.unreconciledTransaction($.id);const V=cr.getBankAccountById(t.bankAccountId);if(V){const Q=cr.getBankStatementsByAccount(V.accountId).filter(D=>D.date>=t.selectedPeriod.start&&D.date<=t.selectedPeriod.end),L=cr.getEntryBookRecordsByAccount(V.accountId).filter(D=>D.date>=t.selectedPeriod.start&&D.date<=t.selectedPeriod.end);n(Q),i(L)}},k={display:"grid","grid-template-columns":"1fr 1fr",gap:"2rem","margin-top":"2rem"},K={height:"600px","overflow-y":"auto"},oe={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},O=$=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:$?"var(--primary-color)":"var(--surface-color)",color:$?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),M=($,V)=>({display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem","margin-bottom":"0.5rem",background:$?"var(--primary-color)":V?"#e8f5e8":"var(--surface-color)",color:$?"white":"var(--text-primary)","border-radius":"var(--border-radius-sm)",border:`1px solid ${$?"var(--primary-color)":V?"#c3e6cb":"var(--border-color)"}`,cursor:"pointer",transition:"all 0.2s ease"}),N={flex:"1"},g={"font-weight":"500","margin-bottom":"0.25rem"},v={"font-size":"0.875rem",opacity:"0.8"},f=$=>({"font-weight":"600",color:$?"#4caf50":"#f44336"}),C={padding:"0.25rem 0.5rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","margin-left":"0.5rem"},S=$=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format($),x=$=>new Date($).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),m=$=>{if(!a())return null;const V=a();return(Math.abs(V.debitAmount-$.debitAmount)<.01||Math.abs(V.creditAmount-$.creditAmount)<.01)&&V.date===$.date?(()=>{var D=fm();return s(D,()=>e("banking.exactMatch")),le(j=>d(D,{...C,background:"#d4edda",color:"#155724"},j)),D})():u().includes($)?(()=>{var D=fm();return s(D,()=>e("banking.possibleMatch")),le(j=>d(D,{...C,background:"#fff3cd",color:"#856404"},j)),D})():null},Y=(()=>{const $=r(),V=o(),Q=$.filter(D=>D.isReconciled).length,L=V.filter(D=>D.isReconciled).length;return{totalStatements:$.length,totalRecords:V.length,reconciledStatements:Q,reconciledRecords:L,unreconciledStatements:$.length-Q,unreconciledRecords:V.length-L}})();return(()=>{var $=C$(),V=$.firstChild,Q=V.firstChild,L=Q.nextSibling,D=L.firstChild,j=D.nextSibling,ue=j.nextSibling,W=V.nextSibling,ce=W.nextSibling,T=ce.firstChild,G=T.firstChild,Z=G.nextSibling,F=T.nextSibling,ne=F.firstChild,H=ne.nextSibling;return d(V,oe),Q.style.setProperty("margin","0"),Q.style.setProperty("font-size","1.25rem"),s(Q,()=>e("banking.reconciliationComparison")),L.style.setProperty("display","flex"),L.style.setProperty("gap","0.5rem"),D.$$click=()=>b("all"),s(D,()=>e("common.all")),j.$$click=()=>b("unreconciled"),s(j,()=>e("banking.unreconciled")),ue.$$click=()=>b("reconciled"),s(ue,()=>e("banking.reconciled")),W.style.setProperty("display","grid"),W.style.setProperty("grid-template-columns","repeat(4, 1fr)"),W.style.setProperty("gap","1rem"),W.style.setProperty("margin-bottom","2rem"),s(W,w(Ge,{get title(){return e("banking.bankStatements")},get subtitle(){return e("banking.totalTransactions")},get children(){return[(()=>{var U=Qs();return U.style.setProperty("font-size","1.5rem"),U.style.setProperty("font-weight","600"),U.style.setProperty("color","var(--primary-color)"),s(U,()=>Y.totalStatements),U})(),(()=>{var U=gm(),ae=U.firstChild;return U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-muted)"),s(U,()=>Y.reconciledStatements,ae),s(U,()=>e("banking.reconciled"),null),U})()]}}),null),s(W,w(Ge,{get title(){return e("banking.entryBookRecords")},get subtitle(){return e("banking.totalEntries")},get children(){return[(()=>{var U=Qs();return U.style.setProperty("font-size","1.5rem"),U.style.setProperty("font-weight","600"),U.style.setProperty("color","var(--primary-color)"),s(U,()=>Y.totalRecords),U})(),(()=>{var U=gm(),ae=U.firstChild;return U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-muted)"),s(U,()=>Y.reconciledRecords,ae),s(U,()=>e("banking.reconciled"),null),U})()]}}),null),s(W,w(Ge,{get title(){return e("banking.unreconciledBank")},get subtitle(){return e("banking.needAttention")},get children(){var U=Qs();return U.style.setProperty("font-size","1.5rem"),U.style.setProperty("font-weight","600"),U.style.setProperty("color","#f44336"),s(U,()=>Y.unreconciledStatements),U}}),null),s(W,w(Ge,{get title(){return e("banking.unreconciledBooks")},get subtitle(){return e("banking.needAttention")},get children(){var U=Qs();return U.style.setProperty("font-size","1.5rem"),U.style.setProperty("font-weight","600"),U.style.setProperty("color","#f44336"),s(U,()=>Y.unreconciledRecords),U}}),null),d(ce,k),G.style.setProperty("margin","0 0 1rem 0"),s(G,()=>e("banking.bankStatements")),s(Z,()=>_().map(U=>(()=>{var ae=A$(),se=ae.firstChild,pe=se.firstChild,de=pe.nextSibling,ye=de.firstChild,X=se.nextSibling,ee=X.firstChild;return ae.$$click=()=>E(U),s(pe,()=>U.description),s(de,()=>x(U.date),ye),s(de,()=>U.reference,null),s(de,(()=>{var q=ge(()=>!!U.isReconciled);return()=>q()&&(()=>{var he=Fl();return he.firstChild,he.style.setProperty("color","#4caf50"),he.style.setProperty("margin-left","0.5rem"),s(he,()=>e("banking.reconciled"),null),he})()})(),null),s(ee,()=>U.debitAmount>0?"+":"-",null),s(ee,()=>S(U.debitAmount||U.creditAmount),null),s(X,(()=>{var q=ge(()=>!!U.isReconciled);return()=>q()&&w(Le,{variant:"outline",size:"sm",onClick:he=>{he.stopPropagation(),P(U)},style:{"margin-top":"0.5rem"},get children(){return e("banking.unreconcile")}})})(),null),le(q=>{var he=M(a()?.id===U.id,U.isReconciled),ve=N,B=g,te=v,_e=f(U.debitAmount>0);return q.e=d(ae,he,q.e),q.t=d(se,ve,q.t),q.a=d(pe,B,q.a),q.o=d(de,te,q.o),q.i=d(ee,_e,q.i),q},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ae})())),ne.style.setProperty("margin","0 0 1rem 0"),s(ne,()=>e("banking.entryBookRecords"),null),s(ne,(()=>{var U=ge(()=>!!(a()&&!a().isReconciled));return()=>U()&&(()=>{var ae=x$(),se=ae.firstChild,pe=se.nextSibling;return pe.nextSibling,ae.style.setProperty("font-weight","400"),ae.style.setProperty("color","var(--text-muted)"),ae.style.setProperty("margin-left","0.5rem"),s(ae,()=>e("banking.clickToReconcile"),pe),ae})()})(),null),s(H,(()=>{var U=ge(()=>!!(a()&&!a().isReconciled));return()=>U()?[ge(()=>ge(()=>u().length>0)()&&(()=>{var ae=I$(),se=ae.firstChild,pe=se.firstChild;return se.nextSibling,ae.style.setProperty("margin-bottom","1rem"),ae.style.setProperty("padding","0.75rem"),ae.style.setProperty("background","#fff3cd"),ae.style.setProperty("border-radius","var(--border-radius-sm)"),s(se,()=>e("banking.potentialMatchesFound"),pe),s(ae,()=>e("banking.clickRecordToReconcile"),null),ae})()),ge(()=>A().map(ae=>(u().includes(ae),(()=>{var se=vm(),pe=se.firstChild,de=pe.firstChild,ye=de.nextSibling,X=ye.firstChild,ee=pe.nextSibling;return se.$$click=()=>{ae.isReconciled||R(ae)},s(de,()=>ae.description,null),s(de,()=>m(ae),null),s(ye,()=>x(ae.date),X),s(ye,()=>ae.reference,null),s(ye,(()=>{var q=ge(()=>!!ae.isReconciled);return()=>q()&&(()=>{var he=Fl();return he.firstChild,he.style.setProperty("color","#4caf50"),he.style.setProperty("margin-left","0.5rem"),s(he,()=>e("banking.reconciled"),null),he})()})(),null),s(ee,()=>ae.debitAmount>0?"+":"-",null),s(ee,()=>S(ae.debitAmount||ae.creditAmount),null),le(q=>{var he={...M(!1,ae.isReconciled),opacity:ae.isReconciled?.6:1,cursor:ae.isReconciled?"not-allowed":"pointer"},ve=N,B=g,te=v,_e=f(ae.debitAmount>0);return q.e=d(se,he,q.e),q.t=d(pe,ve,q.t),q.a=d(de,B,q.a),q.o=d(ye,te,q.o),q.i=d(ee,_e,q.i),q},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),se})())))]:A().map(ae=>(()=>{var se=vm(),pe=se.firstChild,de=pe.firstChild,ye=de.nextSibling,X=ye.firstChild,ee=pe.nextSibling;return s(de,()=>ae.description),s(ye,()=>x(ae.date),X),s(ye,()=>ae.reference,null),s(ye,(()=>{var q=ge(()=>!!ae.isReconciled);return()=>q()&&(()=>{var he=Fl();return he.firstChild,he.style.setProperty("color","#4caf50"),he.style.setProperty("margin-left","0.5rem"),s(he,()=>e("banking.reconciled"),null),he})()})(),null),s(ee,()=>ae.debitAmount>0?"+":"-",null),s(ee,()=>S(ae.debitAmount||ae.creditAmount),null),le(q=>{var he=M(!1,ae.isReconciled),ve=N,B=g,te=v,_e=f(ae.debitAmount>0);return q.e=d(se,he,q.e),q.t=d(pe,ve,q.t),q.a=d(de,B,q.a),q.o=d(ye,te,q.o),q.i=d(ee,_e,q.i),q},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),se})())})()),s($,(()=>{var U=ge(()=>!!(a()&&!a().isReconciled));return()=>U()&&(()=>{var ae=$$(),se=ae.firstChild,pe=se.firstChild,de=se.nextSibling,ye=de.nextSibling;return ae.style.setProperty("position","fixed"),ae.style.setProperty("bottom","2rem"),ae.style.setProperty("right","2rem"),ae.style.setProperty("background","var(--surface-color)"),ae.style.setProperty("padding","1rem"),ae.style.setProperty("border-radius","var(--border-radius)"),ae.style.setProperty("box-shadow","var(--shadow-lg)"),ae.style.setProperty("border","1px solid var(--border-color)"),ae.style.setProperty("max-width","300px"),se.style.setProperty("font-weight","500"),se.style.setProperty("margin-bottom","0.5rem"),s(se,()=>e("banking.selected"),pe),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("margin-bottom","0.5rem"),s(de,()=>a().description),ye.style.setProperty("font-weight","600"),ye.style.setProperty("color","var(--primary-color)"),s(ye,()=>S(a().debitAmount||a().creditAmount)),s(ae,w(Le,{variant:"secondary",size:"sm",onClick:()=>{c(null),h([])},style:{"margin-top":"0.5rem"},get children(){return e("banking.clearSelection")}}),null),ae})()})(),null),le(U=>{var ae=O(y()==="all"),se=O(y()==="unreconciled"),pe=O(y()==="reconciled"),de=K,ye=K;return U.e=d(D,ae,U.e),U.t=d(j,se,U.t),U.a=d(ue,pe,U.a),U.o=d(Z,de,U.o),U.i=d(H,ye,U.i),U},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),$})()};ft(["click"]);var T$=z("<div><div><h2></h2><p></p></div><div>"),k$=z("<div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date>"),R$=z("<div><button></button><button>"),D$=z("<div><br>"),Li=z("<div>"),N$=z("<div><div></div><div> • </div><div>"),L$=z("<div>: "),M$=z("<div> <!> • <!> "),O$=z("<div>%"),V$=z("<div> of <!> transactions");const F$=()=>{const{t}=it(),[e,r]=fe(null),[n,o]=fe({start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[i,a]=fe(!1),[c,u]=fe("overview");Nn(()=>{!e()&&cr.bankAccounts.length>0&&r(cr.bankAccounts[0])});const h={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},y={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},b={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},_=oe=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:oe?"var(--primary-color)":"var(--text-muted)","border-bottom":oe?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),A={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},E=oe=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(oe),R=oe=>new Date(oe).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),P=()=>cr.bankAccounts.map(oe=>({value:oe.id,label:`${oe.bankName} - ${oe.accountNumber} (${oe.accountType})`})),K=(()=>{if(!e())return null;const oe=cr.getBankStatementsByAccount(e().accountId).filter(N=>N.date>=n().start&&N.date<=n().end),O=cr.getEntryBookRecordsByAccount(e().accountId).filter(N=>N.date>=n().start&&N.date<=n().end),M=oe.filter(N=>N.isReconciled).length;return O.filter(N=>N.isReconciled).length,{totalBankTransactions:oe.length,totalEntryBookRecords:O.length,reconciledTransactions:M,unreconciledTransactions:oe.length-M,reconciliationRate:oe.length>0?M/oe.length*100:0}})();return w(Ur,{get title(){return t("banking.title")},get children(){return[(()=>{var oe=T$(),O=oe.firstChild,M=O.firstChild,N=M.nextSibling,g=O.nextSibling;return d(oe,h),M.style.setProperty("margin","0 0 0.5rem 0"),M.style.setProperty("font-size","1.5rem"),s(M,()=>t("banking.reconciliation")),N.style.setProperty("margin","0"),N.style.setProperty("color","var(--text-muted)"),s(N,()=>t("banking.compareStatements")),g.style.setProperty("display","flex"),g.style.setProperty("gap","1rem"),s(g,w(Le,{variant:"secondary",onClick:()=>a(!0),get disabled(){return!e()},get children(){return t("banking.importCSV")}}),null),s(g,w(Le,{variant:"primary",get children(){return t("banking.startNewReconciliation")}}),null),oe})(),(()=>{var oe=k$(),O=oe.firstChild,M=O.firstChild,N=O.nextSibling,g=N.firstChild,v=g.nextSibling,f=N.nextSibling,C=f.firstChild,S=C.nextSibling;return d(oe,y),O.style.setProperty("flex","1"),M.style.setProperty("display","block"),M.style.setProperty("margin-bottom","0.5rem"),M.style.setProperty("font-weight","500"),s(M,()=>t("banking.bankAccount")),s(O,w(vr,{label:"",get value(){return e()?.id||""},onChange:x=>{const m=cr.getBankAccountById(x);r(m||null)},get options(){return P()}}),null),g.style.setProperty("display","block"),g.style.setProperty("margin-bottom","0.5rem"),g.style.setProperty("font-weight","500"),s(g,()=>t("entryBooks.startDate")),v.addEventListener("change",x=>o(m=>({...m,start:x.target.value}))),v.style.setProperty("padding","0.75rem"),v.style.setProperty("border","1px solid var(--border-color)"),v.style.setProperty("border-radius","var(--border-radius-sm)"),v.style.setProperty("font-family","inherit"),C.style.setProperty("display","block"),C.style.setProperty("margin-bottom","0.5rem"),C.style.setProperty("font-weight","500"),s(C,()=>t("entryBooks.endDate")),S.addEventListener("change",x=>o(m=>({...m,end:x.target.value}))),S.style.setProperty("padding","0.75rem"),S.style.setProperty("border","1px solid var(--border-color)"),S.style.setProperty("border-radius","var(--border-radius-sm)"),S.style.setProperty("font-family","inherit"),le(()=>v.value=n().start),le(()=>S.value=n().end),oe})(),(()=>{var oe=R$(),O=oe.firstChild,M=O.nextSibling;return d(oe,b),O.$$click=()=>u("overview"),s(O,()=>t("common.overview")),M.$$click=()=>u("reconciliation"),s(M,()=>t("banking.reconciliation")),le(N=>{var g=_(c()==="overview"),v=_(c()==="reconciliation");return N.e=d(O,g,N.e),N.t=d(M,v,N.t),N},{e:void 0,t:void 0}),oe})(),ge(()=>ge(()=>c()==="overview")()&&(()=>{var oe=Li();return s(oe,(()=>{var O=ge(()=>!!e());return()=>O()&&(()=>{var M=Li();return d(M,A),s(M,w(Ge,{get title(){return t("banking.bankAccountInfo")},get subtitle(){return t("banking.currentAccountDetails")},get children(){return[(()=>{var N=N$(),g=N.firstChild,v=g.nextSibling,f=v.firstChild,C=v.nextSibling;return N.style.setProperty("margin-bottom","1rem"),g.style.setProperty("font-weight","600"),g.style.setProperty("margin-bottom","0.5rem"),s(g,()=>e().bankName),v.style.setProperty("color","var(--text-muted)"),v.style.setProperty("margin-bottom","0.5rem"),s(v,()=>e().accountNumber,f),s(v,()=>e().accountType,null),C.style.setProperty("font-size","1.25rem"),C.style.setProperty("font-weight","600"),C.style.setProperty("color","var(--primary-color)"),s(C,()=>E(e().currentBalance)),N})(),ge(()=>ge(()=>!!e().lastReconciledDate)()&&(()=>{var N=L$(),g=N.firstChild;return N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),s(N,()=>t("banking.lastReconciled"),g),s(N,()=>R(e().lastReconciledDate),null),N})())]}}),null),s(M,K&&[w(Ge,{get title(){return t("banking.bankTransactions")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var N=Li();return N.style.setProperty("font-size","1.5rem"),N.style.setProperty("font-weight","600"),N.style.setProperty("color","var(--primary-color)"),N.style.setProperty("margin-bottom","0.5rem"),s(N,()=>K.totalBankTransactions),N})(),(()=>{var N=M$(),g=N.firstChild,v=g.nextSibling,f=v.nextSibling,C=f.nextSibling;return C.nextSibling,N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),s(N,()=>K.reconciledTransactions,g),s(N,()=>t("banking.reconciled"),v),s(N,()=>K.unreconciledTransactions,C),s(N,()=>t("banking.pending"),null),N})()]}}),w(Ge,{get title(){return t("entryBooks.entryBookRecords")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var N=Li();return N.style.setProperty("font-size","1.5rem"),N.style.setProperty("font-weight","600"),N.style.setProperty("color","var(--primary-color)"),N.style.setProperty("margin-bottom","0.5rem"),s(N,()=>K.totalEntryBookRecords),N})(),(()=>{var N=Li();return N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),s(N,()=>t("banking.bookEntriesForComparison")),N})()]}}),w(Ge,{get title(){return t("banking.reconciliationRate")},get subtitle(){return t("banking.completionStatus")},get children(){return[(()=>{var N=O$(),g=N.firstChild;return N.style.setProperty("font-size","1.5rem"),N.style.setProperty("font-weight","600"),N.style.setProperty("margin-bottom","0.5rem"),s(N,()=>Math.round(K.reconciliationRate),g),le(v=>(v=K.reconciliationRate>80?"#4caf50":K.reconciliationRate>50?"#ff9800":"#f44336")!=null?N.style.setProperty("color",v):N.style.removeProperty("color")),N})(),(()=>{var N=V$(),g=N.firstChild,v=g.nextSibling;return v.nextSibling,N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),s(N,()=>K.reconciledTransactions,g),s(N,()=>K.totalBankTransactions,v),N})()]}})],null),M})()})(),null),s(oe,w(Ge,{get title(){return t("banking.recentReconciliationSessions")},get subtitle(){return t("banking.latestActivity")},get children(){var O=D$(),M=O.firstChild;return O.style.setProperty("text-align","center"),O.style.setProperty("color","var(--text-muted)"),O.style.setProperty("padding","2rem"),s(O,()=>t("banking.noRecentSessions"),M),s(O,w(Le,{variant:"primary",style:{"margin-top":"1rem"},onClick:()=>u("reconciliation"),get children(){return t("banking.startFirstReconciliation")}}),null),O}}),null),oe})()),ge(()=>ge(()=>!!(c()==="reconciliation"&&e()))()&&w(E$,{get bankAccountId(){return e().id},get selectedPeriod(){return n()}})),w(w$,{get isOpen(){return i()},onClose:()=>a(!1),get bankAccount(){return e()}})]}})};ft(["click"]);ft(["input","click"]);var B$=z("<h2>Upload Bank Statement CSV"),U$=z("<input type=file accept=.csv>"),j$=z("<h3>Filters"),z$=z('<div><input type=text placeholder="Search transactions..."><input type=date placeholder="Start Date"><input type=date placeholder="End Date"><button>Download Detailed Report'),q$=z("<div><button>Summary</button><button>Deposits</button><button>Payments</button><button>Timeline"),G$=z("<h3>Total Deposits"),Js=z("<p>"),bm=z("<p> transactions"),H$=z("<h3>Total Payments"),W$=z("<h3>Net Cash Flow"),Y$=z("<h3>Check Payments"),K$=z("<p> checks"),Mi=z("<div>"),Q$=z("<h3>Accounts & Payment Methods Used"),J$=z("<h3>Monthly Cash Flow Trend"),X$=z("<div><table><thead><tr><th>Month</th><th>Deposits</th><th>Payments</th><th>Net</th></tr></thead><tbody>"),Z$=z("<h2>Deposits by Type"),e2=z("<h2>Top Depositors"),t2=z("<div><table><thead><tr><th>Depositor</th><th>Total Amount</th><th>Count</th><th>Actions</th></tr></thead><tbody>"),r2=z("<h2>Payments by Category"),n2=z("<h2>Top Payees"),o2=z("<div><table><thead><tr><th>Payee</th><th>Category</th><th>Total Amount</th><th>Count</th></tr></thead><tbody>"),i2=z("<h2>Transaction Timeline"),s2=z("<div><h1>Detailed Bank Statement Analyzer"),a2=z("<span>"),l2=z("<tr><td></td><td></td><td></td><td>"),_m=z("<div><h4></h4><p></p><p> transactions"),c2=z("<tr><td></td><td></td><td></td><td><details><summary>View</summary><div>"),d2=z("<div> - "),u2=z("<tr><td></td><td><span></span></td><td></td><td>"),h2=z("<div><div><div></div><div> • </div></div><div><div>");const m2=()=>{const[t,e]=fe(""),[r,n]=fe("summary"),[o,i]=fe(""),[a,c]=fe({start:"",end:""}),[u,h]=Ba({list:[]}),y={Utilities:["AT&T","METRO BY T-MOBILE","COMCAST","STREAM ENERGY","NETFLIX","SPECTRUM"],checks:["CHECK"],JPM:["JPM","POVBR"],Transportation:["DRIVE AWAY","TRANPORT","QUICKQUACK","EXXON","SHELL","CHEVRON","UBER","LYFT","U-HAUL","UHAL","LOVE'S"],Lodging:["HOLIDAY INN","MARRIOTT","HILTON","AIRBNB","HOTEL","MOTEL"],"Food & Dining":["GOLDEN CORRAL","MOCTEZUMA","CHINA STAR","RESTAURANT","CAFE","STARBUCKS","BUFFET","GRILL","MARKET","SEAFOOD"],Shopping:["BURLINGTON","WALMART","TARGET","AMAZON","ROSS","KROGER","PUBLIC","AMZN","AMZ"],Financial:["AMERICANFIRSTFIN","LOAN","CREDIT"],Insurance:["INSURANCE","GEICO","STATE FARM"],Rent:["SHAFAII INVESTME"],Medical:["PHARMACY","CVS","WALGREENS","HOSPITAL","CLINIC"],Entertainment:["CINEMA","THEATER","CONCERT"],"Other Services":["BARBER","SALON","SPA","GYM"],Return:["RETURN ITEM "]},b=O=>{const M=O.toUpperCase();for(const[N,g]of Object.entries(y))for(const v of g)if(M.includes(v.toUpperCase()))return N;return"Other"},_=O=>{const M=O.match(/Zelle payment from ([^0-9]+)/i);if(M)return M[1].trim().replace(/[A-Z0-9]{10,}$/,"").trim();if(O.includes("CHECK"))return"Check Payment";const N=O.match(/^([^0-9]+)/);return N?N[1].trim():O.substring(0,30)},A=O=>{const M=O.trim().split(`
`),N=[];console.log(M);for(let g=1;g<M.length;g++){const v=M[g].split(",");if(console.log(v),v.length>=3){const f=parseFloat(v[2]);let C={postingDate:v[0],description:v[1],amount:f};N.push(C)}}return console.log({transactions:N}),h("list",N),N};ze(()=>t()?A(t()):[]);const E=ze(()=>{let O=u?.list;if((a().start||a().end)&&(O=O.filter(M=>{const N=new Date(M.postingDate),g=a().start?new Date(a().start):new Date("2024-01-01"),v=a().end?new Date(a().end):new Date("2024-12-31");return N>=g&&N<=v})),o()){const M=o().toLowerCase();O=O.filter(N=>N.description.toLowerCase().includes(M)||Math.abs(N.amount).toString().includes(M))}return O}),R=ze(()=>{const O={deposits:{total:0,count:0,byType:new Map,byPayee:new Map},payments:{total:0,count:0,byType:new Map,byPayee:new Map},checks:{total:0,count:0,transactions:[]},transfers:{total:0,count:0,transactions:[]},dailyBalances:new Map,accountsAffected:new Set};return E().forEach(M=>{const N=_(M.description);if(console.log({transaction:M}),O.dailyBalances.set(M.postingDate,M.amount),(M.description.includes("ZELLE")||M.description.includes("QUICKPAY"))&&O.accountsAffected.add("Zelle Account"),M.description.includes("ACH")&&O.accountsAffected.add("ACH Network"),M?.description.includes("DEBIT_CARD")&&O.accountsAffected.add("Debit Card"),M?.description.includes("CHECK")&&O.accountsAffected.add("Checking Account"),M?.description.includes("TRANSFER")&&O.accountsAffected.add("Savings Account"),M.amount>0){O.deposits.total+=M.amount,O.deposits.count++,O.deposits.byType.has(M.description)||O.deposits.byType.set(M.description,{total:0,count:0,transactions:[]});const g=O.deposits.byType.get(M.description);g.total+=M.amount,g.count++,g.transactions.push(M),O.deposits.byPayee.has(N)||O.deposits.byPayee.set(N,{name:N,totalAmount:0,transactionCount:0,transactions:[]});const v=O.deposits.byPayee.get(N);v.totalAmount+=M.amount,v.transactionCount++,v.transactions.push(M)}if(M.amount<0){O.payments.total+=Math.abs(M.amount),O.payments.count++,O.payments.byType.has(M.description)||O.payments.byType.set(M.description,{total:0,count:0,transactions:[]});const g=O.payments.byType.get(M.description);g.total+=Math.abs(M.amount),g.count++,g.transactions.push(M);const v=b(M.description);O.payments.byPayee.has(N)||O.payments.byPayee.set(N,{name:N,totalAmount:0,transactionCount:0,transactions:[],category:v});const f=O.payments.byPayee.get(N);f.totalAmount+=Math.abs(M.amount),f.transactionCount++,f.transactions.push(M)}(M.type==="CHECK_PAID"||M.checkNumber)&&(O.checks.total+=Math.abs(M.amount),O.checks.count++,O.checks.transactions.push(M)),(M.description.includes("TRANSFER")||M.description==="ACCT_XFER")&&(O.transfers.total+=Math.abs(M.amount),O.transfers.count++,O.transfers.transactions.push(M))}),console.log(O),O}),P=ze(()=>{const O=new Map;return E().forEach(M=>{const N=M.postingDate.substring(0,7);O.has(N)||O.set(N,{deposits:0,payments:0,net:0});const g=O.get(N);M.amount>0?g.deposits+=M.amount:g.payments+=Math.abs(M.amount),g.net=g.deposits-g.payments}),Array.from(O.entries()).sort((M,N)=>M[0].localeCompare(N[0]))}),k=O=>{const N=O.target.files?.[0];if(N){const g=new FileReader;g.onload=v=>{console.log(v.target?.result),A(v.target?.result)},g.readAsText(N)}},K=()=>{const O=R();let M=`# DETAILED BANK STATEMENT ANALYSIS
`;M+=`Generated: ${new Date().toLocaleDateString()}

`,M+=`## EXECUTIVE SUMMARY

`,M+=`- **Total Deposits:** $${O.deposits.total.toFixed(2)} (${O.deposits.count} transactions)
`,M+=`- **Total Payments:** $${O.payments.total.toFixed(2)} (${O.payments.count} transactions)
`,M+=`- **Net Cash Flow:** $${(O.deposits.total-O.payments.total).toFixed(2)}
`,M+=`- **Check Payments:** $${O.checks.total.toFixed(2)} (${O.checks.count} checks)
`,M+=`- **Transfers:** $${O.transfers.total.toFixed(2)} (${O.transfers.count} transfers)

`,M+=`## ACCOUNTS AFFECTED

`,O.accountsAffected.forEach(x=>{M+=`- ${x}
`}),M+=`
`,M+=`## DEPOSITS DETAIL

`,M+=`### By Type
`,O.deposits.byType.forEach((x,m)=>{M+=`- **${m}**: $${x.total.toFixed(2)} (${x.count} transactions)
`}),M+=`
### Top Depositors
`,Array.from(O.deposits.byPayee.entries()).sort((x,m)=>m[1].totalAmount-x[1].totalAmount).slice(0,20).forEach(([x,m])=>{M+=`- **${x}**: $${m.totalAmount.toFixed(2)} (${m.transactionCount} transactions)
`}),M+=`
## PAYMENTS DETAIL

`,M+=`### By Type
`,O.payments.byType.forEach((x,m)=>{M+=`- **${m}**: $${x.total.toFixed(2)} (${x.count} transactions)
`}),M+=`
### By Category
`;const g=new Map;O.payments.byPayee.forEach(x=>{const m=x.category||"Other";g.set(m,(g.get(m)||0)+x.totalAmount)}),Array.from(g.entries()).sort((x,m)=>m[1]-x[1]).forEach(([x,m])=>{M+=`- **${x}**: $${m.toFixed(2)}
`}),M+=`
### Top Payees
`,Array.from(O.payments.byPayee.entries()).sort((x,m)=>m[1].totalAmount-x[1].totalAmount).slice(0,20).forEach(([x,m])=>{M+=`- **${x}** (${m.category}): $${m.totalAmount.toFixed(2)} (${m.transactionCount} transactions)
`}),M+=`
## MONTHLY CASH FLOW TREND

`,P().forEach(([x,m])=>{M+=`- **${x}**: Deposits: $${m.deposits.toFixed(2)} | Payments: $${m.payments.toFixed(2)} | Net: $${m.net.toFixed(2)}
`}),O.checks.transactions.length>0&&(M+=`
## CHECK PAYMENTS DETAIL

`,O.checks.transactions.forEach(x=>{M+=`- Check #${x.checkNumber||"N/A"} - ${x.postingDate} - $${Math.abs(x.amount).toFixed(2)}
`}));const f=new Blob([M],{type:"text/markdown"}),C=URL.createObjectURL(f),S=document.createElement("a");S.href=C,S.download=`detailed_bank_analysis_${new Date().toISOString().split("T")[0]}.md`,S.click(),URL.revokeObjectURL(C)},oe=O=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(O);return(()=>{var O=s2(),M=O.firstChild;return O.style.setProperty("padding","2rem"),M.style.setProperty("margin-bottom","2rem"),s(O,w(Ge,{style:{"margin-bottom":"2rem"},get children(){return[B$(),(()=>{var N=U$();return N.addEventListener("change",k),N.style.setProperty("margin-top","1rem"),N})()]}}),null),s(O,w(Re,{get when(){return u?.list},get children(){return[w(Ge,{style:{"margin-bottom":"2rem"},get children(){return[j$(),(()=>{var N=z$(),g=N.firstChild,v=g.nextSibling,f=v.nextSibling,C=f.nextSibling;return N.style.setProperty("display","flex"),N.style.setProperty("gap","1rem"),N.style.setProperty("margin-top","1rem"),N.style.setProperty("flex-wrap","wrap"),g.$$input=S=>i(S.currentTarget.value),g.style.setProperty("flex","1"),g.style.setProperty("min-width","200px"),g.style.setProperty("padding","0.5rem"),v.$$input=S=>c({...a(),start:S.currentTarget.value}),f.$$input=S=>c({...a(),end:S.currentTarget.value}),C.$$click=K,C.style.setProperty("padding","0.5rem 1rem"),C.style.setProperty("background","var(--primary-color)"),C.style.setProperty("color","white"),C.style.setProperty("border","none"),C.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("cursor","pointer"),le(()=>g.value=o()),le(()=>v.value=a().start),le(()=>f.value=a().end),N})()]}}),(()=>{var N=q$(),g=N.firstChild,v=g.nextSibling,f=v.nextSibling,C=f.nextSibling;return N.style.setProperty("display","flex"),N.style.setProperty("gap","1rem"),N.style.setProperty("margin-bottom","2rem"),g.$$click=()=>n("summary"),g.style.setProperty("padding","0.5rem 1rem"),g.style.setProperty("border","none"),g.style.setProperty("border-radius","var(--border-radius-sm)"),g.style.setProperty("cursor","pointer"),v.$$click=()=>n("deposits"),v.style.setProperty("padding","0.5rem 1rem"),v.style.setProperty("border","none"),v.style.setProperty("border-radius","var(--border-radius-sm)"),v.style.setProperty("cursor","pointer"),f.$$click=()=>n("payments"),f.style.setProperty("padding","0.5rem 1rem"),f.style.setProperty("border","none"),f.style.setProperty("border-radius","var(--border-radius-sm)"),f.style.setProperty("cursor","pointer"),C.$$click=()=>n("timeline"),C.style.setProperty("padding","0.5rem 1rem"),C.style.setProperty("border","none"),C.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("cursor","pointer"),le(S=>{var x=r()==="summary"?"var(--primary-color)":"#e9ecef",m=r()==="summary"?"white":"black",re=r()==="deposits"?"var(--primary-color)":"#e9ecef",Y=r()==="deposits"?"white":"black",$=r()==="payments"?"var(--primary-color)":"#e9ecef",V=r()==="payments"?"white":"black",Q=r()==="timeline"?"var(--primary-color)":"#e9ecef",L=r()==="timeline"?"white":"black";return x!==S.e&&((S.e=x)!=null?g.style.setProperty("background",x):g.style.removeProperty("background")),m!==S.t&&((S.t=m)!=null?g.style.setProperty("color",m):g.style.removeProperty("color")),re!==S.a&&((S.a=re)!=null?v.style.setProperty("background",re):v.style.removeProperty("background")),Y!==S.o&&((S.o=Y)!=null?v.style.setProperty("color",Y):v.style.removeProperty("color")),$!==S.i&&((S.i=$)!=null?f.style.setProperty("background",$):f.style.removeProperty("background")),V!==S.n&&((S.n=V)!=null?f.style.setProperty("color",V):f.style.removeProperty("color")),Q!==S.s&&((S.s=Q)!=null?C.style.setProperty("background",Q):C.style.removeProperty("background")),L!==S.h&&((S.h=L)!=null?C.style.setProperty("color",L):C.style.removeProperty("color")),S},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),N})(),w(Re,{get when(){return r()==="summary"},get children(){return[(()=>{var N=Mi();return N.style.setProperty("display","grid"),N.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),N.style.setProperty("gap","1rem"),N.style.setProperty("margin-bottom","2rem"),s(N,w(Ge,{get children(){return[G$(),(()=>{var g=Js();return g.style.setProperty("font-size","2rem"),g.style.setProperty("font-weight","bold"),g.style.setProperty("color","#22c55e"),s(g,()=>oe(R().deposits.total)),g})(),(()=>{var g=bm(),v=g.firstChild;return g.style.setProperty("color","#6c757d"),s(g,()=>R().deposits.count,v),g})()]}}),null),s(N,w(Ge,{get children(){return[H$(),(()=>{var g=Js();return g.style.setProperty("font-size","2rem"),g.style.setProperty("font-weight","bold"),g.style.setProperty("color","#ef4444"),s(g,()=>oe(R().payments.total)),g})(),(()=>{var g=bm(),v=g.firstChild;return g.style.setProperty("color","#6c757d"),s(g,()=>R().payments.count,v),g})()]}}),null),s(N,w(Ge,{get children(){return[W$(),(()=>{var g=Js();return g.style.setProperty("font-size","2rem"),g.style.setProperty("font-weight","bold"),s(g,()=>oe(R().deposits.total-R().payments.total)),le(v=>(v=R().deposits.total-R().payments.total>=0?"#22c55e":"#ef4444")!=null?g.style.setProperty("color",v):g.style.removeProperty("color")),g})()]}}),null),s(N,w(Ge,{get children(){return[Y$(),(()=>{var g=Js();return g.style.setProperty("font-size","2rem"),g.style.setProperty("font-weight","bold"),g.style.setProperty("color","#3b82f6"),s(g,()=>oe(R().checks.total)),g})(),(()=>{var g=K$(),v=g.firstChild;return g.style.setProperty("color","#6c757d"),s(g,()=>R().checks.count,v),g})()]}}),null),N})(),w(Ge,{style:{"margin-bottom":"2rem"},get children(){return[Q$(),(()=>{var N=Mi();return N.style.setProperty("display","flex"),N.style.setProperty("flex-wrap","wrap"),N.style.setProperty("gap","0.5rem"),N.style.setProperty("margin-top","1rem"),s(N,w(nt,{get each(){return Array.from(R().accountsAffected)},children:g=>(()=>{var v=a2();return v.style.setProperty("padding","0.25rem 0.75rem"),v.style.setProperty("background","#e9ecef"),v.style.setProperty("border-radius","9999px"),v.style.setProperty("font-size","0.875rem"),s(v,g),v})()})),N})()]}}),w(Ge,{get children(){return[J$(),(()=>{var N=X$(),g=N.firstChild,v=g.firstChild,f=v.firstChild,C=f.firstChild,S=C.nextSibling,x=S.nextSibling,m=x.nextSibling,re=v.nextSibling;return N.style.setProperty("overflow-x","auto"),g.style.setProperty("width","100%"),g.style.setProperty("border-collapse","collapse"),g.style.setProperty("margin-top","1rem"),f.style.setProperty("border-bottom","2px solid #dee2e6"),C.style.setProperty("padding","0.75rem"),C.style.setProperty("text-align","left"),S.style.setProperty("padding","0.75rem"),S.style.setProperty("text-align","right"),x.style.setProperty("padding","0.75rem"),x.style.setProperty("text-align","right"),m.style.setProperty("padding","0.75rem"),m.style.setProperty("text-align","right"),s(re,w(nt,{get each(){return P()},children:([Y,$])=>(()=>{var V=l2(),Q=V.firstChild,L=Q.nextSibling,D=L.nextSibling,j=D.nextSibling;return V.style.setProperty("border-bottom","1px solid #dee2e6"),Q.style.setProperty("padding","0.75rem"),s(Q,Y),L.style.setProperty("padding","0.75rem"),L.style.setProperty("text-align","right"),L.style.setProperty("color","#22c55e"),s(L,()=>oe(isNaN($.deposits)?0:$.deposits)),D.style.setProperty("padding","0.75rem"),D.style.setProperty("text-align","right"),D.style.setProperty("color","#ef4444"),s(D,()=>oe(isNaN($.payments)?0:$.payments)),j.style.setProperty("padding","0.75rem"),j.style.setProperty("text-align","right"),j.style.setProperty("font-weight","bold"),s(j,()=>oe($.net)),le(ue=>(ue=$.net>=0?"#22c55e":"#ef4444")!=null?j.style.setProperty("color",ue):j.style.removeProperty("color")),V})()})),N})()]}})]}}),w(Re,{get when(){return r()==="deposits"},get children(){return[w(Ge,{style:{"margin-bottom":"2rem"},get children(){return[Z$(),(()=>{var N=Mi();return N.style.setProperty("display","grid"),N.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(300px, 1fr))"),N.style.setProperty("gap","1rem"),N.style.setProperty("margin-top","1rem"),s(N,w(nt,{get each(){return Array.from(R().deposits.byType.entries())},children:([g,v])=>(()=>{var f=_m(),C=f.firstChild,S=C.nextSibling,x=S.nextSibling,m=x.firstChild;return f.style.setProperty("padding","1rem"),f.style.setProperty("background","#f8f9fa"),f.style.setProperty("border-radius","var(--border-radius-sm)"),f.style.setProperty("border","1px solid #e9ecef"),s(C,g),S.style.setProperty("font-size","1.5rem"),S.style.setProperty("font-weight","bold"),S.style.setProperty("color","#22c55e"),s(S,()=>oe(v.total)),x.style.setProperty("color","#6c757d"),s(x,()=>v.count,m),f})()})),N})()]}}),w(Ge,{get children(){return[e2(),(()=>{var N=t2(),g=N.firstChild,v=g.firstChild,f=v.firstChild,C=f.firstChild,S=C.nextSibling,x=S.nextSibling,m=x.nextSibling,re=v.nextSibling;return N.style.setProperty("overflow-x","auto"),g.style.setProperty("width","100%"),g.style.setProperty("border-collapse","collapse"),g.style.setProperty("margin-top","1rem"),f.style.setProperty("border-bottom","2px solid #dee2e6"),C.style.setProperty("padding","0.75rem"),C.style.setProperty("text-align","left"),S.style.setProperty("padding","0.75rem"),S.style.setProperty("text-align","right"),x.style.setProperty("padding","0.75rem"),x.style.setProperty("text-align","center"),m.style.setProperty("padding","0.75rem"),m.style.setProperty("text-align","center"),s(re,w(nt,{get each(){return Array.from(R().deposits.byPayee.entries()).sort((Y,$)=>$[1].totalAmount-Y[1].totalAmount).slice(0,20)},children:([Y,$])=>(()=>{var V=c2(),Q=V.firstChild,L=Q.nextSibling,D=L.nextSibling,j=D.nextSibling,ue=j.firstChild,W=ue.firstChild,ce=W.nextSibling;return V.style.setProperty("border-bottom","1px solid #dee2e6"),Q.style.setProperty("padding","0.75rem"),s(Q,Y),L.style.setProperty("padding","0.75rem"),L.style.setProperty("text-align","right"),L.style.setProperty("color","#22c55e"),L.style.setProperty("font-weight","bold"),s(L,()=>oe($.totalAmount)),D.style.setProperty("padding","0.75rem"),D.style.setProperty("text-align","center"),s(D,()=>$.transactionCount),j.style.setProperty("padding","0.75rem"),j.style.setProperty("text-align","center"),W.style.setProperty("cursor","pointer"),ce.style.setProperty("margin-top","0.5rem"),ce.style.setProperty("font-size","0.875rem"),s(ce,w(nt,{get each(){return $.transactions.slice(0,5)},children:T=>(()=>{var G=d2(),Z=G.firstChild;return G.style.setProperty("padding","0.25rem"),s(G,()=>T.postingDate,Z),s(G,()=>oe(T.amount),null),G})()})),V})()})),N})()]}})]}}),w(Re,{get when(){return r()==="payments"},get children(){return[w(Ge,{style:{"margin-bottom":"2rem"},get children(){return[r2(),(()=>{var N=Mi();return N.style.setProperty("display","grid"),N.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),N.style.setProperty("gap","1rem"),N.style.setProperty("margin-top","1rem"),s(N,()=>{const g=new Map;return R().payments.byPayee.forEach(v=>{const f=v.category||"Other";g.has(f)||g.set(f,{total:0,count:0});const C=g.get(f);C.total+=v.totalAmount,C.count+=v.transactionCount}),Array.from(g.entries()).sort((v,f)=>f[1].total-v[1].total).map(([v,f])=>(()=>{var C=_m(),S=C.firstChild,x=S.nextSibling,m=x.nextSibling,re=m.firstChild;return C.style.setProperty("padding","1rem"),C.style.setProperty("background","#f8f9fa"),C.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("border","1px solid #e9ecef"),s(S,v),x.style.setProperty("font-size","1.5rem"),x.style.setProperty("font-weight","bold"),x.style.setProperty("color","#ef4444"),s(x,()=>oe(f.total)),m.style.setProperty("color","#6c757d"),s(m,()=>f.count,re),C})())}),N})()]}}),w(Ge,{get children(){return[n2(),(()=>{var N=o2(),g=N.firstChild,v=g.firstChild,f=v.firstChild,C=f.firstChild,S=C.nextSibling,x=S.nextSibling,m=x.nextSibling,re=v.nextSibling;return N.style.setProperty("overflow-x","auto"),g.style.setProperty("width","100%"),g.style.setProperty("border-collapse","collapse"),g.style.setProperty("margin-top","1rem"),f.style.setProperty("border-bottom","2px solid #dee2e6"),C.style.setProperty("padding","0.75rem"),C.style.setProperty("text-align","left"),S.style.setProperty("padding","0.75rem"),S.style.setProperty("text-align","left"),x.style.setProperty("padding","0.75rem"),x.style.setProperty("text-align","right"),m.style.setProperty("padding","0.75rem"),m.style.setProperty("text-align","center"),s(re,w(nt,{get each(){return Array.from(R().payments.byPayee.entries()).sort((Y,$)=>$[1].totalAmount-Y[1].totalAmount).slice(0,130)},children:([Y,$])=>(()=>{var V=u2(),Q=V.firstChild,L=Q.nextSibling,D=L.firstChild,j=L.nextSibling,ue=j.nextSibling;return V.style.setProperty("border-bottom","1px solid #dee2e6"),Q.style.setProperty("padding","0.75rem"),s(Q,Y),L.style.setProperty("padding","0.75rem"),D.style.setProperty("padding","0.25rem 0.5rem"),D.style.setProperty("background","#e9ecef"),D.style.setProperty("border-radius","4px"),D.style.setProperty("font-size","0.875rem"),s(D,()=>$.category),j.style.setProperty("padding","0.75rem"),j.style.setProperty("text-align","right"),j.style.setProperty("color","#ef4444"),j.style.setProperty("font-weight","bold"),s(j,()=>oe($.totalAmount)),ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("text-align","center"),s(ue,()=>$.transactionCount),V})()})),N})()]}})]}}),w(Re,{get when(){return r()==="timeline"},get children(){return w(Ge,{get children(){return[i2(),(()=>{var N=Mi();return N.style.setProperty("max-height","600px"),N.style.setProperty("overflow-y","auto"),N.style.setProperty("margin-top","1rem"),s(N,w(nt,{get each(){return E().slice(0,100)},children:g=>(()=>{var v=h2(),f=v.firstChild,C=f.firstChild,S=C.nextSibling,x=S.firstChild,m=f.nextSibling,re=m.firstChild;return v.style.setProperty("padding","1rem"),v.style.setProperty("border-bottom","1px solid #e9ecef"),v.style.setProperty("display","flex"),v.style.setProperty("justify-content","space-between"),v.style.setProperty("align-items","center"),f.style.setProperty("flex","1"),C.style.setProperty("font-weight","bold"),s(C,()=>g.description),S.style.setProperty("font-size","0.875rem"),S.style.setProperty("color","#6c757d"),s(S,()=>g.postingDate,x),s(S,()=>g.type,null),s(S,()=>g.checkNumber&&` • Check #${g.checkNumber}`,null),m.style.setProperty("text-align","right"),re.style.setProperty("font-weight","bold"),re.style.setProperty("font-size","1.1rem"),s(re,()=>oe(Math.abs(g.amount)),null),s(re,()=>g.amount>=0?" ↓":" ↑",null),le(Y=>(Y=g.amount>=0?"#22c55e":"#ef4444")!=null?re.style.setProperty("color",Y):re.style.removeProperty("color")),v})()})),N})()]}})}})]}}),null),O})()};ft(["input","click"]);var y2=z("<div><div></div><div>"),Bl=z("<div>"),p2=z("<div> • <!> • <!> "),f2=z("<div><div><div></div><div></div></div><div><div></div><div>"),g2=z("<div><div>:"),v2=z("<div>⚠️ <!>: <!> <!>, <!> "),b2=z("<div><div><div></div><div></div></div><div>"),Pm=z("<div> "),_2=z("<div>✓ ");const P2=t=>{const{t:e}=it(),r={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},n={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},o={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},i={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"0.5rem"},a={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"1rem"},c={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},u={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},h={"max-height":"100px","overflow-y":"auto","border-top":"1px solid var(--border-color)","padding-top":"1rem"},y={display:"flex","justify-content":"space-between","align-items":"center","font-size":"0.875rem","margin-bottom":"0.5rem"},b={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},_=k=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[k],A=k=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(k),E=k=>new Date(k).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),R=_(t.entry.status),P=Math.abs(t.entry.totalDebit-t.entry.totalCredit)<.01;return w(Ge,{get children(){return[(()=>{var k=y2(),K=k.firstChild,oe=K.nextSibling;return d(k,r),d(K,n),s(K,()=>t.entry.entryNumber),s(oe,()=>t.entry.status),le(O=>d(oe,{...o,background:R.bg,color:R.color},O)),k})(),(()=>{var k=Bl();return d(k,i),s(k,()=>t.entry.description),k})(),(()=>{var k=p2(),K=k.firstChild,oe=K.nextSibling,O=oe.nextSibling,M=O.nextSibling;return M.nextSibling,d(k,a),s(k,()=>E(t.entry.date),K),s(k,()=>t.entry.reference||e("journal.noReference","No reference"),oe),s(k,()=>e("journal.createdBy","By"),M),s(k,()=>t.entry.createdBy,null),k})(),(()=>{var k=f2(),K=k.firstChild,oe=K.firstChild,O=oe.nextSibling,M=K.nextSibling,N=M.firstChild,g=N.nextSibling;return d(k,c),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),s(oe,()=>e("journal.totalAmount","Total Amount")),d(O,u),s(O,()=>A(t.entry.totalDebit)),M.style.setProperty("text-align","right"),N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),s(N,()=>e("journal.lines","Lines")),g.style.setProperty("font-weight","600"),s(g,()=>t.entry.lines.length),k})(),ge(()=>!P&&(()=>{var k=v2(),K=k.firstChild,oe=K.nextSibling,O=oe.nextSibling,M=O.nextSibling,N=M.nextSibling,g=N.nextSibling,v=g.nextSibling,f=v.nextSibling;return f.nextSibling,k.style.setProperty("padding","0.5rem"),k.style.setProperty("border-radius","var(--border-radius-sm)"),k.style.setProperty("background","#f8d7da"),k.style.setProperty("color","#721c24"),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("margin-bottom","1rem"),s(k,()=>e("journal.entryNotBalancedShort","Entry is not balanced"),oe),s(k,()=>e("journal.debit"),M),s(k,()=>A(t.entry.totalDebit),g),s(k,()=>e("journal.credit"),f),s(k,()=>A(t.entry.totalCredit),null),k})()),(()=>{var k=g2(),K=k.firstChild,oe=K.firstChild;return d(k,h),K.style.setProperty("font-weight","500"),K.style.setProperty("margin-bottom","0.5rem"),K.style.setProperty("font-size","0.875rem"),s(K,()=>e("journal.accountLines","Account Lines"),oe),s(k,()=>t.entry.lines.slice(0,3).map(O=>(()=>{var M=b2(),N=M.firstChild,g=N.firstChild,v=g.nextSibling,f=N.nextSibling;return d(M,y),N.style.setProperty("flex","1"),g.style.setProperty("font-weight","500"),s(g,()=>O.accountName),v.style.setProperty("font-size","0.75rem"),v.style.setProperty("color","var(--text-muted)"),s(v,()=>O.description||e("journal.noDescription","No description")),f.style.setProperty("text-align","right"),s(f,(()=>{var C=ge(()=>O.debitAmount>0);return()=>C()&&(()=>{var S=Pm(),x=S.firstChild;return S.style.setProperty("color","#4caf50"),S.style.setProperty("font-weight","500"),s(S,()=>e("journal.debitShort","Dr."),x),s(S,()=>A(O.debitAmount),null),S})()})(),null),s(f,(()=>{var C=ge(()=>O.creditAmount>0);return()=>C()&&(()=>{var S=Pm(),x=S.firstChild;return S.style.setProperty("color","#f44336"),S.style.setProperty("font-weight","500"),s(S,()=>e("journal.creditShort","Cr."),x),s(S,()=>A(O.creditAmount),null),S})()})(),null),s(f,(()=>{var C=ge(()=>!!O.reconciled);return()=>C()&&(()=>{var S=_2();return S.firstChild,S.style.setProperty("font-size","0.75rem"),S.style.setProperty("color","#4caf50"),s(S,()=>e("banking.reconciled","Reconciled"),null),S})()})(),null),M})()),null),s(k,(()=>{var O=ge(()=>t.entry.lines.length>3);return()=>O()&&(()=>{var M=Bl();return M.style.setProperty("text-align","center"),M.style.setProperty("color","var(--text-muted)"),M.style.setProperty("font-size","0.875rem"),s(M,()=>e("journal.andMoreLines","... and {count} more lines").replace("{count}",(t.entry.lines.length-3).toString())),M})()})(),null),k})(),(()=>{var k=Bl();return d(k,b),s(k,w(Le,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.entry),get children(){return e("journal.viewDetails","View Details")}})),k})()]}})},S2=[{id:"je1",entryNumber:"JE-2024-001",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",status:"posted",createdBy:"John Doe",createdAt:"2024-01-15T09:00:00Z",postedAt:"2024-01-15T09:05:00Z",totalDebit:5e3,totalCredit:5e3,lines:[{id:"jel1",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment from ABC Corp",debitAmount:5e3,creditAmount:0,reconciled:!0,reconciledWith:"eb1"},{id:"jel2",accountId:"2001",accountName:"Trade Receivables",description:"Payment received for INV-2024-001",debitAmount:0,creditAmount:5e3}]},{id:"je2",entryNumber:"JE-2024-002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",status:"posted",createdBy:"Jane Smith",createdAt:"2024-01-14T10:00:00Z",postedAt:"2024-01-14T10:15:00Z",totalDebit:250,totalCredit:250,lines:[{id:"jel3",accountId:"5200",accountName:"Office Expenses",description:"Office supplies from Staples",debitAmount:250,creditAmount:0},{id:"jel4",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment to Staples",debitAmount:0,creditAmount:250,reconciled:!0,reconciledWith:"eb2"}]},{id:"je3",entryNumber:"JE-2024-003",date:"2024-01-13",description:"Monthly Rent Payment",reference:"RENT-2024-01",status:"posted",createdBy:"John Doe",createdAt:"2024-01-13T08:00:00Z",postedAt:"2024-01-13T08:30:00Z",totalDebit:2e3,totalCredit:2e3,lines:[{id:"jel5",accountId:"5200",accountName:"Rent Expense",description:"January office rent",debitAmount:2e3,creditAmount:0},{id:"jel6",accountId:"1002",accountName:"Bank - Checking Account",description:"Rent payment",debitAmount:0,creditAmount:2e3,reconciled:!1}]},{id:"je4",entryNumber:"JE-2024-004",date:"2024-01-12",description:"Wire Transfer - Capital Investment",reference:"WIRE-001",status:"posted",createdBy:"Admin",createdAt:"2024-01-12T14:00:00Z",postedAt:"2024-01-12T14:30:00Z",totalDebit:1e4,totalCredit:1e4,lines:[{id:"jel7",accountId:"1002",accountName:"Bank - Checking Account",description:"Wire transfer received",debitAmount:1e4,creditAmount:0,reconciled:!1},{id:"jel8",accountId:"8",accountName:"Owner's Equity",description:"Capital investment",debitAmount:0,creditAmount:1e4}]},{id:"je5",entryNumber:"JE-2024-005",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",status:"posted",createdBy:"HR Manager",createdAt:"2024-01-11T16:00:00Z",postedAt:"2024-01-11T16:30:00Z",totalDebit:3500,totalCredit:3500,lines:[{id:"jel9",accountId:"13",accountName:"Salaries Expense",description:"Monthly salary - John Doe",debitAmount:3500,creditAmount:0},{id:"jel10",accountId:"1002",accountName:"Bank - Checking Account",description:"Salary payment",debitAmount:0,creditAmount:3500,reconciled:!1}]},{id:"je6",entryNumber:"JE-2024-006",date:"2024-01-10",description:"Product Sales - Multiple Customers",reference:"SALES-2024-010",status:"posted",createdBy:"Sales Manager",createdAt:"2024-01-10T11:00:00Z",postedAt:"2024-01-10T11:30:00Z",totalDebit:8500,totalCredit:8500,lines:[{id:"jel11",accountId:"1001",accountName:"Petty Cash",description:"Cash sales",debitAmount:1500,creditAmount:0},{id:"jel12",accountId:"2001",accountName:"Trade Receivables",description:"Credit sales",debitAmount:7e3,creditAmount:0},{id:"jel13",accountId:"10",accountName:"Sales Revenue",description:"Product sales revenue",debitAmount:0,creditAmount:8500}]},{id:"je7",entryNumber:"JE-2024-007",date:"2024-01-09",description:"Inventory Purchase",reference:"PO-2024-002",status:"draft",createdBy:"Warehouse Manager",createdAt:"2024-01-09T15:00:00Z",totalDebit:15e3,totalCredit:15e3,lines:[{id:"jel14",accountId:"3",accountName:"Inventory",description:"Product inventory purchase",debitAmount:15e3,creditAmount:0},{id:"jel15",accountId:"5",accountName:"Accounts Payable",description:"Amount owed to supplier",debitAmount:0,creditAmount:15e3}]},{id:"je8",entryNumber:"JE-2024-008",date:"2024-01-08",description:"Utility Bills Payment",reference:"UTIL-2024-01",status:"posted",createdBy:"Admin",createdAt:"2024-01-08T09:00:00Z",postedAt:"2024-01-08T09:30:00Z",totalDebit:450,totalCredit:450,lines:[{id:"jel16",accountId:"14",accountName:"Operating Expenses",description:"Electricity and water bills",debitAmount:450,creditAmount:0},{id:"jel17",accountId:"1003",accountName:"Bank - Savings Account",description:"Utility payment",debitAmount:0,creditAmount:450}]}],[Or,Ul]=fe(S2),Sm=()=>Or().filter(e=>e.status==="posted").flatMap(e=>e.lines.filter(r=>["1001","1002","1003"].includes(r.accountId))).map(e=>{const r=Or().find(n=>n.lines.some(o=>o.id===e.id));return r?{id:`eb_${e.id}`,accountId:e.accountId,date:r.date,description:r.description,reference:r.reference,debitAmount:e.debitAmount,creditAmount:e.creditAmount,category:e.accountName,isReconciled:e.reconciled||!1,reconciledWith:e.reconciledWith,createdAt:r.createdAt}:null}).filter(e=>e!==null),xn={get journalEntries(){return Or()},addJournalEntry(t){const e={...t,id:Date.now().toString()};return Ul([...Or(),e]),e},updateJournalEntry(t,e){Ul(Or().map(r=>r.id===t?{...r,...e}:r))},deleteJournalEntry(t){const e=Or().find(r=>r.id===t);if(e&&e.status==="posted")throw new Error("Cannot delete posted journal entries. Void them instead.");Ul(Or().filter(r=>r.id!==t))},voidJournalEntry(t){this.updateJournalEntry(t,{status:"void"})},postJournalEntry(t){const e=Or().find(r=>r.id===t);if(!e)throw new Error("Journal entry not found");if(Math.abs(e.totalDebit-e.totalCredit)>.01)throw new Error("Journal entry is not balanced. Debits must equal credits.");this.updateJournalEntry(t,{status:"posted",postedAt:new Date().toISOString()}),Sm()},getJournalEntryById(t){return Or().find(e=>e.id===t)},getJournalEntriesByStatus(t){return Or().filter(e=>e.status===t)},getJournalEntriesByDateRange(t,e){return Or().filter(r=>r.date>=t&&r.date<=e)},getJournalEntriesByAccount(t){return Or().filter(e=>e.lines.some(r=>r.accountId===t))},getNextEntryNumber(){const t=new Date().getFullYear(),r=Or().filter(n=>n.entryNumber.includes(t.toString())).reduce((n,o)=>{const i=parseInt(o.entryNumber.split("-").pop()||"0");return i>n?i:n},0);return`JE-${t}-${String(r+1).padStart(3,"0")}`},validateJournalEntry(t){const e=[];if(t.date||e.push("Date is required"),t.description||e.push("Description is required"),(!t.lines||t.lines.length===0)&&e.push("At least one line item is required"),t.lines){const r=t.lines.reduce((o,i)=>o+(i.debitAmount||0),0),n=t.lines.reduce((o,i)=>o+(i.creditAmount||0),0);Math.abs(r-n)>.01&&e.push(`Entry is not balanced. Debit: ${r}, Credit: ${n}`),t.lines.forEach((o,i)=>{o.accountId||e.push(`Line ${i+1}: Account is required`),o.debitAmount===0&&o.creditAmount===0&&e.push(`Line ${i+1}: Either debit or credit amount must be provided`),o.debitAmount>0&&o.creditAmount>0&&e.push(`Line ${i+1}: Cannot have both debit and credit amounts`)})}return{isValid:e.length===0,errors:e}},getBankRelatedEntries(){return Sm()}};var w2=z("<form><div></div><div><div><h4></h4></div><div><div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div></div></div><div><div><strong>: </strong></div><div><strong>: </strong></div><div></div></div></div><div>"),wm=z("<div>");const Mf=t=>{const{t:e}=it(),[r,n]=fe({entryNumber:"",date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),[o,i]=fe([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),[a,c]=fe(null);Nn(()=>{if(t.isOpen){if(t.editEntry)n({entryNumber:t.editEntry.entryNumber,date:t.editEntry.date,description:t.editEntry.description,reference:t.editEntry.reference,createdBy:t.editEntry.createdBy}),i(t.editEntry.lines.map((O,M)=>({...O,tempId:`line_${Date.now()}_${M}`})));else{const O=xn.getNextEntryNumber();n({entryNumber:O,date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),i([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])}c(null)}});const u={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},h={display:"grid","grid-template-columns":"2fr 2fr 1fr 1fr 1fr",gap:"1rem","align-items":"end","margin-bottom":"1rem",padding:"1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},y={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},b=()=>xt.accounts.map(O=>({value:O.id,label:`${O.accountNumber} - ${O.name}`})),_=(O,M)=>{n(N=>({...N,[O]:M}))},A=(O,M,N)=>{i(g=>g.map(v=>{if(v.tempId===O){const f={...v,[M]:N};if(M==="accountId"&&typeof N=="string"){const C=xt.getAccountById(N);C&&(f.accountName=C.name)}return f}return v}))},E=()=>{i(O=>[...O,{tempId:`line_${Date.now()}_${O.length}`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])},R=O=>{o().length>2&&i(M=>M.filter(N=>N.tempId!==O))},P=()=>{const O=o().reduce((N,g)=>N+(g.debitAmount||0),0),M=o().reduce((N,g)=>N+(g.creditAmount||0),0);return{totalDebit:O,totalCredit:M,isBalanced:Math.abs(O-M)<.01}},k=O=>{O.preventDefault(),c(null);const M=r(),N=o(),{totalDebit:g,totalCredit:v,isBalanced:f}=P();if(!M.description){c(e("forms.descriptionRequired","Description is required"));return}if(N.length<2){c(e("journal.minTwoLinesRequired","At least 2 line items are required"));return}if(!f){c(e("journal.entryNotBalanced","Entry is not balanced. Debit: ${debit}, Credit: ${credit}").replace("${debit}",`$${g.toFixed(2)}`).replace("${credit}",`$${v.toFixed(2)}`));return}for(let S=0;S<N.length;S++){const x=N[S];if(!x.accountId){c(e("journal.lineAccountRequired","Line {lineNumber}: Account is required").replace("{lineNumber}",(S+1).toString()));return}if(x.debitAmount===0&&x.creditAmount===0){c(e("journal.lineAmountRequired","Line {lineNumber}: Either debit or credit amount must be provided").replace("{lineNumber}",(S+1).toString()));return}if((x.debitAmount||0)>0&&(x.creditAmount||0)>0){c(e("journal.lineBothAmounts","Line {lineNumber}: Cannot have both debit and credit amounts").replace("{lineNumber}",(S+1).toString()));return}}const C={entryNumber:M.entryNumber,date:M.date,description:M.description,reference:M.reference,status:"draft",createdBy:M.createdBy,createdAt:new Date().toISOString(),totalDebit:g,totalCredit:v,lines:N.map((S,x)=>{const{tempId:m,...re}=S;return{id:`jel_${Date.now()}_${x}`,...re}})};try{t.editEntry?xn.updateJournalEntry(t.editEntry.id,C):xn.addJournalEntry(C),n({entryNumber:xn.getNextEntryNumber(),date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),i([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),t.onClose()}catch(S){c(S instanceof Error?S.message:e("forms.errorOccurred","An error occurred"))}},K=O=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(O),oe=P();return w(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return ge(()=>!!t.editEntry)()?e("journal.editEntry"):e("journal.addEntry","Add Journal Entry")},get children(){var O=w2(),M=O.firstChild,N=M.nextSibling,g=N.firstChild,v=g.firstChild,f=g.nextSibling,C=f.firstChild,S=C.firstChild,x=S.firstChild,m=S.nextSibling,re=m.firstChild,Y=m.nextSibling,$=Y.firstChild,V=Y.nextSibling,Q=V.firstChild,L=V.nextSibling,D=L.firstChild,j=f.nextSibling,ue=j.firstChild,W=ue.firstChild,ce=W.firstChild,T=ue.nextSibling,G=T.firstChild,Z=G.firstChild,F=T.nextSibling,ne=N.nextSibling;return O.addEventListener("submit",k),M.style.setProperty("display","grid"),M.style.setProperty("grid-template-columns","1fr 1fr"),M.style.setProperty("gap","1rem"),s(M,w(Ot,{get label(){return e("journal.entryNumber")},get value(){return r().entryNumber},onChange:H=>_("entryNumber",H),get disabled(){return!!t.editEntry},required:!0}),null),s(M,w(Ot,{get label(){return e("common.date")},type:"date",get value(){return r().date},onChange:H=>_("date",H),required:!0}),null),s(O,w(Ot,{get label(){return e("common.description")},get value(){return r().description},onChange:H=>_("description",H),get placeholder(){return e("journal.enterEntryDescription","Enter journal entry description")},required:!0}),N),s(O,w(Ot,{get label(){return e("journal.reference")},get value(){return r().reference},onChange:H=>_("reference",H),get placeholder(){return e("journal.enterReferenceNumber","Enter reference number")}}),N),N.style.setProperty("margin-top","2rem"),g.style.setProperty("display","flex"),g.style.setProperty("justify-content","space-between"),g.style.setProperty("align-items","center"),g.style.setProperty("margin-bottom","1rem"),v.style.setProperty("margin","0"),s(v,()=>e("journal.entryLines","Journal Entry Lines")),s(g,w(Le,{type:"button",variant:"secondary",size:"sm",onClick:E,get children(){return e("journal.addLine","Add Line")}}),null),f.style.setProperty("margin-bottom","1rem"),f.style.setProperty("font-size","0.875rem"),f.style.setProperty("color","var(--text-muted)"),C.style.setProperty("display","grid"),C.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1fr"),C.style.setProperty("gap","1rem"),s(x,()=>e("journal.account")),s(re,()=>e("common.description")),s($,()=>e("journal.debit")),s(Q,()=>e("journal.credit")),s(D,()=>e("common.actions")),s(N,w(nt,{get each(){return o()},children:H=>(()=>{var U=wm();return d(U,h),s(U,w(vr,{label:"",get value(){return H.accountId||""},onChange:ae=>A(H.tempId,"accountId",ae),get options(){return b()}}),null),s(U,w(Ot,{label:"",get value(){return H.description||""},onChange:ae=>A(H.tempId,"description",ae),get placeholder(){return e("journal.lineDescription","Line description")}}),null),s(U,w(Ot,{label:"",type:"number",get value(){return H.debitAmount?.toString()||"0"},onChange:ae=>{A(H.tempId,"debitAmount",parseFloat(ae)||0),parseFloat(ae)>0&&A(H.tempId,"creditAmount",0)},placeholder:"0.00"}),null),s(U,w(Ot,{label:"",type:"number",get value(){return H.creditAmount?.toString()||"0"},onChange:ae=>{A(H.tempId,"creditAmount",parseFloat(ae)||0),parseFloat(ae)>0&&A(H.tempId,"debitAmount",0)},placeholder:"0.00"}),null),s(U,w(Le,{type:"button",variant:"outline",size:"sm",onClick:()=>R(H.tempId),get disabled(){return o().length<=2},get children(){return e("common.remove","Remove")}}),null),U})()}),j),d(j,y),s(W,()=>e("journal.totalDebit","Total Debit"),ce),s(W,()=>K(oe.totalDebit),null),s(G,()=>e("journal.totalCredit","Total Credit"),Z),s(G,()=>K(oe.totalCredit),null),F.style.setProperty("font-weight","600"),s(F,(()=>{var H=ge(()=>!!oe.isBalanced);return()=>H()?`✓ ${e("journal.balanced")}`:`⚠️ ${e("journal.notBalanced","Not Balanced")}`})()),s(O,(()=>{var H=ge(()=>!!a());return()=>H()&&(()=>{var U=wm();return U.style.setProperty("padding","1rem"),U.style.setProperty("border-radius","var(--border-radius-sm)"),U.style.setProperty("margin-top","1rem"),U.style.setProperty("background","#f8d7da"),U.style.setProperty("color","#721c24"),U.style.setProperty("border","1px solid #f5c6cb"),s(U,a),U})()})(),ne),d(ne,u),s(ne,w(Le,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(ne,w(Le,{variant:"primary",type:"submit",get disabled(){return!oe.isBalanced},get children(){return ge(()=>!!t.editEntry)()?e("journal.updateEntry","Update Entry"):e("journal.saveAsDraft","Save as Draft")}}),null),le(H=>(H=oe.isBalanced?"#4caf50":"#f44336")!=null?F.style.setProperty("color",H):F.style.removeProperty("color")),O}})};var C2=z("<div><div>⚠️</div><div></div><div></div><div>"),A2=z("<div><div></div><div></div><div></div><div></div><div>"),x2=z("<div><button></button><button> (<!>)</button><button> (<!>/<!>)"),Cm=z("<div>"),I2=z("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><div><h4></h4><div></div></div><div>"),jl=z("<div><span></span><span>"),zl=z("<div><strong>:</strong> "),$2=z("<div><div><div></div><div></div><div></div><div></div><div></div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div></div></div><div><div><strong>🔗 Reconciliation Summary</strong></div><div><div><div><strong>Total Lines:</strong> </div><div><strong>Reconciled:</strong> </div><div><strong>Unreconciled:</strong> </div></div><div><div><strong>Bank Accounts:</strong> </div><div><strong>Bank Reconciled:</strong> "),E2=z("<div><div><div></div><div></div></div><div></div><div></div><div></div><div>"),T2=z("<div><span>✓ "),k2=z("<span>(<!>)"),R2=z("<div><strong>Bank Pending:</strong> "),D2=z("<div><div>Reconciled Lines:"),N2=z("<div><div>⚠️ Pending Bank Reconciliation:</div><div>Visit Bank Consolidations to reconcile these transactions"),L2=z("<div><div><div><span></span><h3></h3></div><div><div><div></div><div>Total Lines</div></div><div><div></div><div>Reconciled</div></div><div><div></div><div>Pending"),M2=z("<div><h4>✅ Reconciled Lines (<!>)"),O2=z("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div>✓ Matched"),V2=z("<div>→ "),F2=z("<div><h4>⏳ Unreconciled Lines (<!>)"),B2=z("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div>⏳ Pending"),U2=z("<div>Bank account"),j2=z("<div><div>💡 Reconciliation Tip</div><div>This entry has unreconciled bank account transactions. Visit <strong>Bank Consolidations</strong> to match these with bank statements.");const z2=t=>{const{t:e}=it(),[r,n]=fe("details"),[o,i]=fe(!1),a=ze(()=>t.entryId?xn.getJournalEntryById(t.entryId):null),c={"text-align":"center","margin-bottom":"2rem",position:"relative"},u={position:"absolute",top:"0",right:"0",display:"flex",gap:"0.5rem"},h={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","margin-bottom":"0.5rem"},y={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},b={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},_={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem",display:"inline-block"},A={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},E={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},R={"font-weight":"600",color:"var(--text-primary)"},P={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},k=m=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:m?"var(--primary-color)":"var(--text-muted)","border-bottom":m?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),K={display:"grid","grid-template-columns":"2fr 2.5fr 1fr 1fr 1.5fr",gap:"1rem",padding:"1rem 0","border-bottom":"1px solid var(--border-color)","align-items":"center"},oe={...K,"font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","border-bottom":"2px solid var(--border-color)"},O={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},M={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},N=m=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[m],g=m=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(m),v=m=>new Date(m).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),f=m=>new Date(m).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),C=()=>{entry.status==="posted"&&!confirm(e("journal.confirmEditPosted","This entry has been posted. Editing will create a new draft copy. Continue?"))||i(!0)},S=()=>{if(a()&&confirm(e("journal.confirmPost","Are you sure you want to post this journal entry? This action cannot be undone.")))try{xn.postJournalEntry(a().id)}catch(m){alert(m instanceof Error?m.message:e("forms.errorPostingEntry","An error occurred while posting the entry"))}},x=()=>{a()&&confirm(e("journal.confirmVoid","Are you sure you want to void this journal entry?"))&&xn.voidJournalEntry(a().id)};return[w(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.entryDetails","Journal Entry Details")},get children(){return ge(()=>!a())()?(()=>{var m=C2(),re=m.firstChild,Y=re.nextSibling,$=Y.nextSibling,V=$.nextSibling;return m.style.setProperty("text-align","center"),m.style.setProperty("padding","3rem"),m.style.setProperty("color","var(--text-muted)"),re.style.setProperty("font-size","1.5rem"),re.style.setProperty("margin-bottom","1rem"),Y.style.setProperty("font-size","1.1rem"),Y.style.setProperty("margin-bottom","0.5rem"),s(Y,()=>e("journal.entryNotFound","Entry Not Found")),$.style.setProperty("font-size","0.875rem"),s($,()=>e("journal.entryNotFoundMessage","The journal entry you're looking for could not be found or may have been deleted.")),V.style.setProperty("margin-top","2rem"),s(V,w(Le,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),m})():(()=>{const m=a(),re=N(m.status),Y=Math.abs(m.totalDebit-m.totalCredit)<.01;return[(()=>{var $=A2(),V=$.firstChild,Q=V.nextSibling,L=Q.nextSibling,D=L.nextSibling,j=D.nextSibling;return d($,c),s(V,w(Le,{variant:"outline",size:"sm",onClick:C,get title(){return e("journal.editEntryTooltip","Edit this journal entry")},get children(){return e("common.edit")}}),null),s(V,(()=>{var ue=ge(()=>m.status==="draft");return()=>ue()&&w(Le,{variant:"primary",size:"sm",onClick:S,disabled:!Y,get title(){return Y?e("journal.postEntryTooltip","Post this journal entry"):e("journal.entryMustBeBalanced","Entry must be balanced to post")},get children(){return e("journal.post","Post")}})})(),null),s(V,(()=>{var ue=ge(()=>m.status==="posted");return()=>ue()&&w(Le,{variant:"outline",size:"sm",onClick:x,style:{color:"#dc3545","border-color":"#dc3545"},get title(){return e("journal.voidEntryTooltip","Void this journal entry")},get children(){return e("entryBooks.void","Void")}})})(),null),d(Q,h),s(Q,()=>m.entryNumber),d(L,y),s(L,()=>m.description),d(D,b),s(D,()=>g(m.totalDebit)),s(j,()=>m.status),le(ue=>{var W=u,ce={..._,background:re.bg,color:re.color};return ue.e=d(V,W,ue.e),ue.t=d(j,ce,ue.t),ue},{e:void 0,t:void 0}),$})(),(()=>{var $=x2(),V=$.firstChild,Q=V.nextSibling,L=Q.firstChild,D=L.nextSibling;D.nextSibling;var j=Q.nextSibling,ue=j.firstChild,W=ue.nextSibling,ce=W.nextSibling,T=ce.nextSibling;return T.nextSibling,d($,P),V.$$click=()=>n("details"),s(V,()=>e("common.details")),Q.$$click=()=>n("lines"),s(Q,()=>e("journal.journalLines","Journal Lines"),L),s(Q,()=>m.lines.length,D),j.$$click=()=>n("reconciliation"),s(j,()=>e("banking.reconciliation","Reconciliation"),ue),s(j,()=>m.lines.filter(G=>G.reconciled).length,W),s(j,()=>m.lines.length,T),le(G=>{var Z=k(r()==="details"),F=k(r()==="lines"),ne=k(r()==="reconciliation");return G.e=d(V,Z,G.e),G.t=d(Q,F,G.t),G.a=d(j,ne,G.a),G},{e:void 0,t:void 0,a:void 0}),$})(),ge(()=>ge(()=>r()==="details")()&&(()=>{var $=I2(),V=$.firstChild,Q=V.firstChild,L=Q.nextSibling,D=V.nextSibling,j=D.firstChild,ue=j.nextSibling,W=D.nextSibling,ce=W.firstChild,T=ce.nextSibling,G=W.nextSibling,Z=G.firstChild,F=Z.nextSibling,ne=G.nextSibling,H=ne.firstChild,U=H.nextSibling,ae=ne.nextSibling,se=ae.firstChild,pe=se.nextSibling,de=ae.nextSibling,ye=de.firstChild,X=ye.nextSibling,ee=de.nextSibling,q=ee.firstChild,he=q.firstChild,ve=he.nextSibling,B=q.nextSibling;return s(Q,()=>e("common.date")),s(L,()=>v(m.date)),s(j,()=>e("journal.reference")),s(ue,()=>m.reference||e("common.notAvailable","N/A")),s(ce,()=>e("journal.totalDebit")),s(T,()=>g(m.totalDebit)),s(Z,()=>e("journal.totalCredit")),s(F,()=>g(m.totalCredit)),s(H,()=>e("journal.balanceStatus","Balance Status")),s(U,()=>Y?`${e("journal.balanced")} ✓`:`${e("journal.unbalanced","Unbalanced")} (${g(Math.abs(m.totalDebit-m.totalCredit))} ${e("journal.difference","difference")})`),s(se,()=>e("journal.createdBy")),s(pe,()=>m.createdBy),s(ye,()=>e("journal.createdAt","Created At")),s(X,()=>f(m.createdAt)),s($,(()=>{var te=ge(()=>!!m.postedAt);return()=>te()&&(()=>{var _e=jl(),we=_e.firstChild,me=we.nextSibling;return s(we,()=>e("journal.postedAt","Posted At")),s(me,()=>f(m.postedAt)),le(be=>{var ie=A,Pe=E,Te=R;return be.e=d(_e,ie,be.e),be.t=d(we,Pe,be.t),be.a=d(me,Te,be.a),be},{e:void 0,t:void 0,a:void 0}),_e})()})(),ee),ee.style.setProperty("margin-top","2rem"),ee.style.setProperty("padding-top","1rem"),ee.style.setProperty("border-top","2px solid var(--border-color)"),q.style.setProperty("display","flex"),q.style.setProperty("justify-content","space-between"),q.style.setProperty("align-items","center"),q.style.setProperty("margin-bottom","1rem"),he.style.setProperty("margin","0"),he.style.setProperty("font-size","1rem"),s(he,()=>e("journal.quickActions","Quick Actions")),ve.style.setProperty("display","flex"),ve.style.setProperty("gap","0.5rem"),s(ve,w(Le,{variant:"primary",size:"sm",onClick:C,get children(){return["✏️ ",ge(()=>e("journal.editEntry"))]}}),null),s(ve,(()=>{var te=ge(()=>m.status==="draft");return()=>te()&&w(Le,{variant:"outline",size:"sm",onClick:S,disabled:!Y,style:{"border-color":Y?"#4caf50":"#f44336",color:Y?"#4caf50":"#f44336"},get children(){return Y?`✓ ${e("journal.postEntry","Post Entry")}`:`⚠️ ${e("journal.fixBalance","Fix Balance")}`}})})(),null),s(ve,(()=>{var te=ge(()=>m.status==="posted");return()=>te()&&w(Le,{variant:"outline",size:"sm",onClick:x,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return["🗑️ ",ge(()=>e("journal.voidEntry","Void Entry"))]}})})(),null),B.style.setProperty("padding","1rem"),B.style.setProperty("border-radius","var(--border-radius-sm)"),B.style.setProperty("font-size","0.875rem"),s(B,(()=>{var te=ge(()=>m.status==="draft");return()=>te()&&(()=>{var _e=zl(),we=_e.firstChild,me=we.firstChild;return we.nextSibling,s(we,()=>e("journal.draftEntry","Draft Entry"),me),s(_e,()=>e("journal.draftEntryDescription","This entry can be edited and posted."),null),s(_e,()=>!Y&&` ⚠️ ${e("journal.entryMustBeBalancedBeforePosting","Entry must be balanced before posting.")}`,null),_e})()})(),null),s(B,(()=>{var te=ge(()=>m.status==="posted");return()=>te()&&(()=>{var _e=zl(),we=_e.firstChild,me=we.firstChild;return we.nextSibling,s(we,()=>e("journal.postedEntry","Posted Entry"),me),s(_e,()=>e("journal.postedEntryDescription","This entry has been posted to the general ledger. Editing will create a new draft copy."),null),_e})()})(),null),s(B,(()=>{var te=ge(()=>m.status==="void");return()=>te()&&(()=>{var _e=zl(),we=_e.firstChild,me=we.firstChild;return we.nextSibling,s(we,()=>e("journal.voidEntry"),me),s(_e,()=>e("journal.voidEntryDescription","This entry has been voided and cannot be modified."),null),_e})()})(),null),le(te=>{var _e=A,we=E,me=R,be=A,ie=E,Pe=R,Te=A,$e=E,Ee=R,Ve=A,Ke=E,je=R,Ce=A,Be=E,Je={...R,color:Y?"#4caf50":"#f44336"},Qe=A,We=E,xe=R,at=A,et=E,bt=R,ht=m.status==="draft"?"#fff3cd":m.status==="posted"?"#d4edda":"#f8d7da";return te.e=d(V,_e,te.e),te.t=d(Q,we,te.t),te.a=d(L,me,te.a),te.o=d(D,be,te.o),te.i=d(j,ie,te.i),te.n=d(ue,Pe,te.n),te.s=d(W,Te,te.s),te.h=d(ce,$e,te.h),te.r=d(T,Ee,te.r),te.d=d(G,Ve,te.d),te.l=d(Z,Ke,te.l),te.u=d(F,je,te.u),te.c=d(ne,Ce,te.c),te.w=d(H,Be,te.w),te.m=d(U,Je,te.m),te.f=d(ae,Qe,te.f),te.y=d(se,We,te.y),te.g=d(pe,xe,te.g),te.p=d(de,at,te.p),te.b=d(ye,et,te.b),te.T=d(X,bt,te.T),ht!==te.A&&((te.A=ht)!=null?B.style.setProperty("background",ht):B.style.removeProperty("background")),te},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),$})()),ge(()=>ge(()=>r()==="lines")()&&(()=>{var $=$2(),V=$.firstChild,Q=V.firstChild,L=Q.nextSibling,D=L.nextSibling,j=D.nextSibling,ue=j.nextSibling,W=V.nextSibling,ce=W.firstChild,T=ce.firstChild,G=T.firstChild;T.nextSibling;var Z=ce.nextSibling,F=Z.firstChild,ne=F.firstChild;F.nextSibling;var H=Z.nextSibling,U=W.nextSibling,ae=U.firstChild,se=ae.nextSibling,pe=se.firstChild,de=pe.firstChild,ye=de.firstChild;ye.nextSibling;var X=de.nextSibling,ee=X.firstChild;ee.nextSibling;var q=X.nextSibling,he=q.firstChild;he.nextSibling;var ve=pe.nextSibling,B=ve.firstChild,te=B.firstChild;te.nextSibling;var _e=B.nextSibling,we=_e.firstChild;return we.nextSibling,s(Q,()=>e("journal.account")),s(L,()=>e("common.description")),s(D,()=>e("journal.debit")),s(j,()=>e("journal.credit")),s(ue,()=>e("banking.reconciliation")),s($,w(nt,{get each(){return m.lines},children:me=>(()=>{var be=E2(),ie=be.firstChild,Pe=ie.firstChild,Te=Pe.nextSibling,$e=ie.nextSibling,Ee=$e.nextSibling,Ve=Ee.nextSibling,Ke=Ve.nextSibling;return Pe.style.setProperty("font-weight","500"),s(Pe,()=>me.accountName),Te.style.setProperty("font-size","0.75rem"),Te.style.setProperty("color","var(--text-muted)"),s(Te,()=>xt.getAccountById(me.accountId)?.accountNumber||me.accountId),$e.style.setProperty("font-size","0.875rem"),s($e,()=>me.description||"-"),Ee.style.setProperty("font-weight","600"),s(Ee,(()=>{var je=ge(()=>me.debitAmount>0);return()=>je()?g(me.debitAmount):"-"})()),Ve.style.setProperty("font-weight","600"),s(Ve,(()=>{var je=ge(()=>me.creditAmount>0);return()=>je()?g(me.creditAmount):"-"})()),s(Ke,(()=>{var je=ge(()=>!!me.reconciled);return()=>je()?(()=>{var Ce=T2(),Be=Ce.firstChild;return Be.firstChild,Ce.style.setProperty("display","flex"),Ce.style.setProperty("align-items","center"),Ce.style.setProperty("gap","0.5rem"),Ce.style.setProperty("color","#4caf50"),Ce.style.setProperty("font-size","0.875rem"),Be.style.setProperty("font-weight","600"),s(Be,()=>e("banking.reconciled"),null),s(Ce,(()=>{var Je=ge(()=>!!me.reconciledWith);return()=>Je()&&(()=>{var Qe=k2(),We=Qe.firstChild,xe=We.nextSibling;return xe.nextSibling,Qe.style.setProperty("font-size","0.75rem"),Qe.style.setProperty("color","var(--text-muted)"),Qe.style.setProperty("font-style","italic"),s(Qe,()=>me.reconciledWith,xe),Qe})()})(),null),Ce})():(()=>{var Ce=Cm();return Ce.style.setProperty("color","var(--text-muted)"),Ce.style.setProperty("font-size","0.875rem"),s(Ce,()=>e("banking.notReconciled","Not Reconciled")),Ce})()})()),le(je=>{var Ce=K,Be=me.debitAmount>0?"#4caf50":"var(--text-muted)",Je=me.creditAmount>0?"#f44336":"var(--text-muted)";return je.e=d(be,Ce,je.e),Be!==je.t&&((je.t=Be)!=null?Ee.style.setProperty("color",Be):Ee.style.removeProperty("color")),Je!==je.a&&((je.a=Je)!=null?Ve.style.setProperty("color",Je):Ve.style.removeProperty("color")),je},{e:void 0,t:void 0,a:void 0}),be})()}),W),d(W,O),s(T,()=>e("journal.totalDebit"),G),s(ce,()=>g(m.totalDebit),null),s(F,()=>e("journal.totalCredit"),ne),s(Z,()=>g(m.totalCredit),null),(Y?"#4caf50":"#f44336")!=null?H.style.setProperty("color",Y?"#4caf50":"#f44336"):H.style.removeProperty("color"),H.style.setProperty("font-weight","600"),s(H,()=>Y?`✓ ${e("journal.balanced")}`:`⚠️ ${e("journal.notBalanced","Not Balanced")}`),U.style.setProperty("margin-top","1rem"),U.style.setProperty("padding","1rem"),U.style.setProperty("border-radius","var(--border-radius-sm)"),U.style.setProperty("font-size","0.875rem"),ae.style.setProperty("margin-bottom","0.5rem"),se.style.setProperty("display","grid"),se.style.setProperty("grid-template-columns","1fr 1fr"),se.style.setProperty("gap","1rem"),de.style.setProperty("margin-bottom","0.25rem"),s(de,()=>m.lines.length,null),X.style.setProperty("margin-bottom","0.25rem"),X.style.setProperty("color","#4caf50"),s(X,()=>m.lines.filter(me=>me.reconciled).length,null),q.style.setProperty("color","#f44336"),s(q,()=>m.lines.filter(me=>!me.reconciled).length,null),B.style.setProperty("margin-bottom","0.25rem"),s(B,()=>m.lines.filter(me=>["1001","1002","1003"].includes(me.accountId)).length,null),_e.style.setProperty("margin-bottom","0.25rem"),_e.style.setProperty("color","#4caf50"),s(_e,()=>m.lines.filter(me=>["1001","1002","1003"].includes(me.accountId)&&me.reconciled).length,null),s(ve,(()=>{var me=ge(()=>m.lines.filter(be=>["1001","1002","1003"].includes(be.accountId)&&!be.reconciled).length>0);return()=>me()&&(()=>{var be=R2(),ie=be.firstChild;return ie.nextSibling,be.style.setProperty("color","#f44336"),s(be,()=>m.lines.filter(Pe=>["1001","1002","1003"].includes(Pe.accountId)&&!Pe.reconciled).length,null),be})()})(),null),s(U,(()=>{var me=ge(()=>m.lines.filter(be=>be.reconciled).length>0);return()=>me()&&(()=>{var be=D2(),ie=be.firstChild;return be.style.setProperty("margin-top","0.75rem"),be.style.setProperty("padding-top","0.75rem"),be.style.setProperty("border-top","1px solid var(--border-color)"),ie.style.setProperty("margin-bottom","0.5rem"),ie.style.setProperty("font-weight","500"),s(be,()=>m.lines.filter(Pe=>Pe.reconciled).map(Pe=>(()=>{var Te=jl(),$e=Te.firstChild,Ee=$e.nextSibling;return Te.style.setProperty("display","flex"),Te.style.setProperty("justify-content","space-between"),Te.style.setProperty("margin-bottom","0.25rem"),Te.style.setProperty("font-size","0.8rem"),s($e,()=>Pe.accountName),Ee.style.setProperty("color","var(--text-muted)"),s(Ee,()=>Pe.reconciledWith?`→ ${Pe.reconciledWith}`:"Manual"),Te})()),null),be})()})(),null),s(U,(()=>{var me=ge(()=>m.lines.filter(be=>!be.reconciled&&["1001","1002","1003"].includes(be.accountId)).length>0);return()=>me()&&(()=>{var be=N2(),ie=be.firstChild,Pe=ie.nextSibling;return be.style.setProperty("margin-top","0.75rem"),be.style.setProperty("padding-top","0.75rem"),be.style.setProperty("border-top","1px solid var(--border-color)"),ie.style.setProperty("margin-bottom","0.5rem"),ie.style.setProperty("font-weight","500"),ie.style.setProperty("color","#f44336"),s(be,()=>m.lines.filter(Te=>!Te.reconciled&&["1001","1002","1003"].includes(Te.accountId)).map(Te=>(()=>{var $e=jl(),Ee=$e.firstChild,Ve=Ee.nextSibling;return $e.style.setProperty("display","flex"),$e.style.setProperty("justify-content","space-between"),$e.style.setProperty("margin-bottom","0.25rem"),$e.style.setProperty("font-size","0.8rem"),$e.style.setProperty("color","#f44336"),s(Ee,()=>Te.accountName),s(Ve,()=>g(Te.debitAmount||Te.creditAmount)),$e})()),Pe),Pe.style.setProperty("margin-top","0.5rem"),Pe.style.setProperty("font-size","0.75rem"),Pe.style.setProperty("color","var(--text-muted)"),Pe.style.setProperty("font-style","italic"),be})()})(),null),le(me=>{var be=oe,ie=m.lines.some(Pe=>Pe.reconciled)?"#e8f5e8":"#fff3cd";return me.e=d(V,be,me.e),ie!==me.t&&((me.t=ie)!=null?U.style.setProperty("background",ie):U.style.removeProperty("background")),me},{e:void 0,t:void 0}),$})()),ge(()=>ge(()=>r()==="reconciliation")()&&(()=>{var $=L2(),V=$.firstChild,Q=V.firstChild,L=Q.firstChild,D=L.nextSibling,j=Q.nextSibling,ue=j.firstChild,W=ue.firstChild,ce=W.nextSibling,T=ue.nextSibling,G=T.firstChild,Z=G.nextSibling,F=T.nextSibling,ne=F.firstChild,H=ne.nextSibling;return V.style.setProperty("margin-bottom","1.5rem"),V.style.setProperty("padding","1rem"),V.style.setProperty("border-radius","var(--border-radius)"),V.style.setProperty("border","1px solid var(--border-color)"),Q.style.setProperty("display","flex"),Q.style.setProperty("align-items","center"),Q.style.setProperty("gap","0.5rem"),Q.style.setProperty("margin-bottom","1rem"),L.style.setProperty("font-size","1.5rem"),s(L,(()=>{var U=ge(()=>!!m.lines.every(ae=>ae.reconciled));return()=>U()?"✅":m.lines.some(ae=>ae.reconciled)?"🔄":"⏳"})()),D.style.setProperty("margin","0"),D.style.setProperty("font-size","1.2rem"),s(D,(()=>{var U=ge(()=>!!m.lines.every(ae=>ae.reconciled));return()=>U()?"Fully Reconciled":m.lines.some(ae=>ae.reconciled)?"Partially Reconciled":"Unreconciled"})()),j.style.setProperty("display","grid"),j.style.setProperty("grid-template-columns","1fr 1fr 1fr"),j.style.setProperty("gap","1rem"),ue.style.setProperty("text-align","center"),W.style.setProperty("font-size","2rem"),W.style.setProperty("font-weight","700"),W.style.setProperty("color","var(--primary-color)"),s(W,()=>m.lines.length),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("color","var(--text-muted)"),T.style.setProperty("text-align","center"),G.style.setProperty("font-size","2rem"),G.style.setProperty("font-weight","700"),G.style.setProperty("color","#4caf50"),s(G,()=>m.lines.filter(U=>U.reconciled).length),Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-muted)"),F.style.setProperty("text-align","center"),ne.style.setProperty("font-size","2rem"),ne.style.setProperty("font-weight","700"),ne.style.setProperty("color","#f44336"),s(ne,()=>m.lines.filter(U=>!U.reconciled).length),H.style.setProperty("font-size","0.875rem"),H.style.setProperty("color","var(--text-muted)"),s($,(()=>{var U=ge(()=>m.lines.filter(ae=>ae.reconciled).length>0);return()=>U()&&(()=>{var ae=M2(),se=ae.firstChild,pe=se.firstChild,de=pe.nextSibling;return de.nextSibling,ae.style.setProperty("margin-bottom","1.5rem"),se.style.setProperty("margin","0 0 1rem 0"),se.style.setProperty("font-size","1.1rem"),se.style.setProperty("color","#4caf50"),se.style.setProperty("display","flex"),se.style.setProperty("align-items","center"),se.style.setProperty("gap","0.5rem"),s(se,()=>m.lines.filter(ye=>ye.reconciled).length,de),s(ae,()=>m.lines.filter(ye=>ye.reconciled).map(ye=>(()=>{var X=O2(),ee=X.firstChild,q=ee.firstChild,he=q.nextSibling,ve=ee.nextSibling,B=ve.nextSibling,te=B.nextSibling,_e=te.nextSibling,we=_e.firstChild;return X.style.setProperty("display","grid"),X.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),X.style.setProperty("gap","1rem"),X.style.setProperty("padding","0.75rem"),X.style.setProperty("margin-bottom","0.5rem"),X.style.setProperty("background","#f0f9f0"),X.style.setProperty("border-radius","var(--border-radius-sm)"),X.style.setProperty("align-items","center"),X.style.setProperty("font-size","0.875rem"),q.style.setProperty("font-weight","500"),s(q,()=>ye.accountName),he.style.setProperty("font-size","0.75rem"),he.style.setProperty("color","var(--text-muted)"),s(he,()=>xt.getAccountById(ye.accountId)?.accountNumber),ve.style.setProperty("color","var(--text-muted)"),s(ve,()=>ye.description||"No description"),B.style.setProperty("font-weight","600"),s(B,(()=>{var me=ge(()=>ye.debitAmount>0);return()=>me()?g(ye.debitAmount):"-"})()),te.style.setProperty("font-weight","600"),s(te,(()=>{var me=ge(()=>ye.creditAmount>0);return()=>me()?g(ye.creditAmount):"-"})()),_e.style.setProperty("color","#4caf50"),we.style.setProperty("font-weight","500"),s(_e,(()=>{var me=ge(()=>!!ye.reconciledWith);return()=>me()&&(()=>{var be=V2();return be.firstChild,be.style.setProperty("font-size","0.75rem"),be.style.setProperty("font-style","italic"),s(be,()=>ye.reconciledWith,null),be})()})(),null),le(me=>{var be=ye.debitAmount>0?"#4caf50":"var(--text-muted)",ie=ye.creditAmount>0?"#f44336":"var(--text-muted)";return be!==me.e&&((me.e=be)!=null?B.style.setProperty("color",be):B.style.removeProperty("color")),ie!==me.t&&((me.t=ie)!=null?te.style.setProperty("color",ie):te.style.removeProperty("color")),me},{e:void 0,t:void 0}),X})()),null),ae})()})(),null),s($,(()=>{var U=ge(()=>m.lines.filter(ae=>!ae.reconciled).length>0);return()=>U()&&(()=>{var ae=F2(),se=ae.firstChild,pe=se.firstChild,de=pe.nextSibling;return de.nextSibling,ae.style.setProperty("margin-bottom","1.5rem"),se.style.setProperty("margin","0 0 1rem 0"),se.style.setProperty("font-size","1.1rem"),se.style.setProperty("color","#f44336"),se.style.setProperty("display","flex"),se.style.setProperty("align-items","center"),se.style.setProperty("gap","0.5rem"),s(se,()=>m.lines.filter(ye=>!ye.reconciled).length,de),s(ae,()=>m.lines.filter(ye=>!ye.reconciled).map(ye=>(()=>{var X=B2(),ee=X.firstChild,q=ee.firstChild,he=q.nextSibling,ve=ee.nextSibling,B=ve.nextSibling,te=B.nextSibling,_e=te.nextSibling,we=_e.firstChild;return X.style.setProperty("display","grid"),X.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),X.style.setProperty("gap","1rem"),X.style.setProperty("padding","0.75rem"),X.style.setProperty("margin-bottom","0.5rem"),X.style.setProperty("background","#fff9f0"),X.style.setProperty("border-radius","var(--border-radius-sm)"),X.style.setProperty("align-items","center"),X.style.setProperty("font-size","0.875rem"),X.style.setProperty("border","1px solid #ffe0b3"),q.style.setProperty("font-weight","500"),s(q,()=>ye.accountName),he.style.setProperty("font-size","0.75rem"),he.style.setProperty("color","var(--text-muted)"),s(he,()=>xt.getAccountById(ye.accountId)?.accountNumber),ve.style.setProperty("color","var(--text-muted)"),s(ve,()=>ye.description||"No description"),B.style.setProperty("font-weight","600"),s(B,(()=>{var me=ge(()=>ye.debitAmount>0);return()=>me()?g(ye.debitAmount):"-"})()),te.style.setProperty("font-weight","600"),s(te,(()=>{var me=ge(()=>ye.creditAmount>0);return()=>me()?g(ye.creditAmount):"-"})()),_e.style.setProperty("color","#f44336"),we.style.setProperty("font-weight","500"),s(_e,(()=>{var me=ge(()=>!!["1001","1002","1003"].includes(ye.accountId));return()=>me()&&(()=>{var be=U2();return be.style.setProperty("font-size","0.75rem"),be.style.setProperty("font-style","italic"),be})()})(),null),le(me=>{var be=ye.debitAmount>0?"#4caf50":"var(--text-muted)",ie=ye.creditAmount>0?"#f44336":"var(--text-muted)";return be!==me.e&&((me.e=be)!=null?B.style.setProperty("color",be):B.style.removeProperty("color")),ie!==me.t&&((me.t=ie)!=null?te.style.setProperty("color",ie):te.style.removeProperty("color")),me},{e:void 0,t:void 0}),X})()),null),s(ae,(()=>{var ye=ge(()=>m.lines.filter(X=>!X.reconciled&&["1001","1002","1003"].includes(X.accountId)).length>0);return()=>ye()&&(()=>{var X=j2(),ee=X.firstChild,q=ee.nextSibling;return X.style.setProperty("padding","0.75rem"),X.style.setProperty("background","#ffebee"),X.style.setProperty("border-radius","var(--border-radius-sm)"),X.style.setProperty("margin-top","1rem"),X.style.setProperty("border","1px solid #ffcdd2"),ee.style.setProperty("font-weight","500"),ee.style.setProperty("margin-bottom","0.5rem"),ee.style.setProperty("color","#f44336"),q.style.setProperty("font-size","0.875rem"),q.style.setProperty("color","var(--text-muted)"),X})()})(),null),ae})()})(),null),le(U=>(U=m.lines.every(ae=>ae.reconciled)?"#e8f5e8":m.lines.some(ae=>ae.reconciled)?"#fff3cd":"#ffebee")!=null?V.style.setProperty("background",U):V.style.removeProperty("background")),$})()),(()=>{var $=Cm();return d($,M),s($,w(Le,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s($,w(Le,{variant:"primary",onClick:C,get children(){return e("journal.editEntry")}}),null),s($,(()=>{var V=ge(()=>m.status==="draft");return()=>V()&&w(Le,{variant:"outline",onClick:S,disabled:!Y,style:{"border-color":"#4caf50",color:Y?"#4caf50":"var(--text-muted)"},get children(){return Y?e("journal.postEntry","Post Entry"):e("journal.entryNotBalanced","Entry Not Balanced")}})})(),null),s($,(()=>{var V=ge(()=>m.status==="posted");return()=>V()&&w(Le,{variant:"outline",onClick:x,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return e("journal.voidEntry","Void Entry")}})})(),null),$})()]})()}}),ge(()=>ge(()=>!!a())()&&w(Mf,{get isOpen(){return o()},onClose:()=>{i(!1)},get editEntry(){return a()}}))]};ft(["click"]);var q2=z("<div><div><h2></h2><p></p></div><div>"),Pn=z("<div>"),G2=z("<div> <!> • <!> "),H2=z("<div><div><label></label></div><div><label></label></div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label></div><div>"),W2=z("<div><span>:</span><span> "),Xs=z("<span>: "),Y2=z("<div><br>");const K2=()=>{const{t}=it(),[e,r]=fe(!1),[n,o]=fe(null),[i,a]=fe(!1),[c,u]=fe(null),[h,y]=fe("all"),[b,_]=fe("all"),[A,E]=fe(""),[R,P]=fe(""),[k,K]=fe("date"),[oe,O]=fe("desc"),M={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},N={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)","flex-wrap":"wrap"},g={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem"},v={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(400px, 1fr))",gap:"1.5rem"},f=()=>[{value:"all",label:t("journal.allEntries","All Entries")},{value:"draft",label:t("journal.draft")},{value:"posted",label:t("journal.posted")},{value:"void",label:t("entryBooks.void","Void")}],C=()=>[{value:"all",label:t("accounts.allAccounts","All Accounts")},...xt.accounts.map(D=>({value:D.id,label:`${D.accountNumber} - ${D.name}`}))],S=()=>[{value:"date",label:t("common.date")},{value:"entryNumber",label:t("journal.entryNumber")},{value:"amount",label:t("common.amount")}],x=()=>{let D=xn.journalEntries;return h()!=="all"&&(D=D.filter(j=>j.status===h())),b()!=="all"&&(D=D.filter(j=>j.lines.some(ue=>ue.accountId===b()))),A()&&(D=D.filter(j=>j.date>=A())),R()&&(D=D.filter(j=>j.date<=R())),D=[...D].sort((j,ue)=>{let W=0;switch(k()){case"date":W=new Date(j.date).getTime()-new Date(ue.date).getTime();break;case"entryNumber":W=j.entryNumber.localeCompare(ue.entryNumber);break;case"amount":W=j.totalDebit-ue.totalDebit;break}return oe()==="asc"?W:-W}),D},m=()=>{const D=xn.journalEntries,j=D.filter(Z=>Z.status==="draft"),ue=D.filter(Z=>Z.status==="posted"),W=D.filter(Z=>Z.status==="void"),ce=ue.reduce((Z,F)=>Z+F.totalDebit,0),T=ue.reduce((Z,F)=>Z+F.totalCredit,0),G=D.filter(Z=>Z.lines.some(F=>["1001","1002","1003"].includes(F.accountId)&&!F.reconciled)).length;return{totalEntries:D.length,draftEntries:j.length,postedEntries:ue.length,voidEntries:W.length,totalDebit:ce,totalCredit:T,unreconciledEntries:G}},re=D=>{u(D.id),a(!0)},Y=()=>{o(null),r(!0)},$=()=>{r(!1),o(null)},V=D=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(D),Q=m(),L=x();return w(Ur,{get title(){return t("entryBooks.title")},get children(){return[(()=>{var D=q2(),j=D.firstChild,ue=j.firstChild,W=ue.nextSibling,ce=j.nextSibling;return d(D,M),ue.style.setProperty("margin","0 0 0.5rem 0"),ue.style.setProperty("font-size","1.5rem"),s(ue,()=>t("journal.title")),W.style.setProperty("margin","0"),W.style.setProperty("color","var(--text-muted)"),s(W,()=>t("entryBooks.subtitle","Manage accounting entries and general ledger records")),ce.style.setProperty("display","flex"),ce.style.setProperty("gap","1rem"),s(ce,w(Le,{variant:"secondary",onClick:()=>window.location.href="/bank-consolidations",get children(){return t("entryBooks.viewReconciliation","View Reconciliation")}}),null),s(ce,w(Le,{variant:"primary",onClick:Y,get children(){return t("journal.addEntry","Add Journal Entry")}}),null),D})(),(()=>{var D=Pn();return d(D,g),s(D,w(Ge,{get title(){return t("entryBooks.totalEntries","Total Entries")},get subtitle(){return t("entryBooks.allJournalEntries","All journal entries")},get children(){return[(()=>{var j=Pn();return j.style.setProperty("font-size","1.5rem"),j.style.setProperty("font-weight","600"),j.style.setProperty("color","var(--primary-color)"),j.style.setProperty("margin-bottom","0.5rem"),s(j,()=>Q.totalEntries),j})(),(()=>{var j=G2(),ue=j.firstChild,W=ue.nextSibling,ce=W.nextSibling,T=ce.nextSibling;return T.nextSibling,j.style.setProperty("font-size","0.875rem"),j.style.setProperty("color","var(--text-muted)"),s(j,()=>Q.postedEntries,ue),s(j,()=>t("journal.posted").toLowerCase(),W),s(j,()=>Q.draftEntries,T),s(j,()=>t("journal.draft").toLowerCase(),null),s(j,(()=>{var G=ge(()=>Q.voidEntries>0);return()=>G()&&` • ${Q.voidEntries} ${t("entryBooks.void","void").toLowerCase()}`})(),null),j})()]}}),null),s(D,w(Ge,{get title(){return t("journal.totalDebits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var j=Pn();return j.style.setProperty("font-size","1.5rem"),j.style.setProperty("font-weight","600"),j.style.setProperty("color","#4caf50"),j.style.setProperty("margin-bottom","0.5rem"),s(j,()=>V(Q.totalDebit)),j})(),(()=>{var j=Pn();return j.style.setProperty("font-size","0.875rem"),j.style.setProperty("color","var(--text-muted)"),s(j,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",Q.postedEntries.toString())),j})()]}}),null),s(D,w(Ge,{get title(){return t("journal.totalCredits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var j=Pn();return j.style.setProperty("font-size","1.5rem"),j.style.setProperty("font-weight","600"),j.style.setProperty("color","#f44336"),j.style.setProperty("margin-bottom","0.5rem"),s(j,()=>V(Q.totalCredit)),j})(),(()=>{var j=Pn();return j.style.setProperty("font-size","0.875rem"),j.style.setProperty("color","var(--text-muted)"),s(j,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",Q.postedEntries.toString())),j})()]}}),null),s(D,w(Ge,{get title(){return t("banking.unreconciled","Unreconciled")},get subtitle(){return t("banking.title")},get children(){return[(()=>{var j=Pn();return j.style.setProperty("font-size","1.5rem"),j.style.setProperty("font-weight","600"),j.style.setProperty("margin-bottom","0.5rem"),s(j,()=>Q.unreconciledEntries),le(ue=>(ue=Q.unreconciledEntries>0?"#ff9800":"#4caf50")!=null?j.style.setProperty("color",ue):j.style.removeProperty("color")),j})(),(()=>{var j=Pn();return j.style.setProperty("font-size","0.875rem"),j.style.setProperty("color","var(--text-muted)"),s(j,(()=>{var ue=ge(()=>Q.unreconciledEntries>0);return()=>ue()?t("entryBooks.needBankReconciliation","Need bank reconciliation"):t("entryBooks.allReconciled","All reconciled")})()),j})()]}}),null),D})(),(()=>{var D=H2(),j=D.firstChild,ue=j.firstChild,W=j.nextSibling,ce=W.firstChild,T=W.nextSibling,G=T.firstChild,Z=T.nextSibling,F=Z.firstChild,ne=F.nextSibling,H=Z.nextSibling,U=H.firstChild,ae=U.nextSibling,se=H.nextSibling,pe=se.firstChild,de=se.nextSibling;return d(D,N),j.style.setProperty("min-width","150px"),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("font-weight","500"),ue.style.setProperty("font-size","0.875rem"),s(ue,()=>t("common.status")),s(j,w(vr,{label:"",get value(){return h()},onChange:y,get options(){return f()}}),null),W.style.setProperty("min-width","200px"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),ce.style.setProperty("font-size","0.875rem"),s(ce,()=>t("journal.account")),s(W,w(vr,{label:"",get value(){return b()},onChange:_,get options(){return C()}}),null),T.style.setProperty("min-width","120px"),G.style.setProperty("display","block"),G.style.setProperty("margin-bottom","0.5rem"),G.style.setProperty("font-weight","500"),G.style.setProperty("font-size","0.875rem"),s(G,()=>t("entryBooks.sortBy","Sort By")),s(T,w(vr,{label:"",get value(){return k()},onChange:K,get options(){return S()}}),null),Z.style.setProperty("min-width","130px"),F.style.setProperty("display","block"),F.style.setProperty("margin-bottom","0.5rem"),F.style.setProperty("font-weight","500"),F.style.setProperty("font-size","0.875rem"),s(F,()=>t("entryBooks.fromDate","From Date")),ne.addEventListener("change",ye=>E(ye.target.value)),ne.style.setProperty("padding","0.75rem"),ne.style.setProperty("border","1px solid var(--border-color)"),ne.style.setProperty("border-radius","var(--border-radius-sm)"),ne.style.setProperty("font-family","inherit"),ne.style.setProperty("width","100%"),H.style.setProperty("min-width","130px"),U.style.setProperty("display","block"),U.style.setProperty("margin-bottom","0.5rem"),U.style.setProperty("font-weight","500"),U.style.setProperty("font-size","0.875rem"),s(U,()=>t("entryBooks.toDate","To Date")),ae.addEventListener("change",ye=>P(ye.target.value)),ae.style.setProperty("padding","0.75rem"),ae.style.setProperty("border","1px solid var(--border-color)"),ae.style.setProperty("border-radius","var(--border-radius-sm)"),ae.style.setProperty("font-family","inherit"),ae.style.setProperty("width","100%"),se.style.setProperty("min-width","100px"),pe.style.setProperty("display","block"),pe.style.setProperty("margin-bottom","0.5rem"),pe.style.setProperty("font-weight","500"),pe.style.setProperty("font-size","0.875rem"),s(pe,()=>t("entryBooks.order","Order")),s(se,w(vr,{label:"",get value(){return oe()},onChange:O,get options(){return[{value:"desc",label:t("entryBooks.newest","Newest")},{value:"asc",label:t("entryBooks.oldest","Oldest")}]}}),null),de.style.setProperty("display","flex"),de.style.setProperty("align-items","end"),de.style.setProperty("gap","0.5rem"),s(de,w(Le,{variant:"outline",size:"sm",onClick:()=>{y("all"),_("all"),E(""),P(""),K("date"),O("desc")},get children(){return t("entryBooks.resetFilters","Reset Filters")}})),le(()=>ne.value=A()),le(()=>ae.value=R()),D})(),ge(()=>ge(()=>!!(h()!=="all"||b()!=="all"||A()||R()))()&&(()=>{var D=W2(),j=D.firstChild,ue=j.firstChild,W=j.nextSibling,ce=W.firstChild;return D.style.setProperty("display","flex"),D.style.setProperty("gap","0.5rem"),D.style.setProperty("align-items","center"),D.style.setProperty("margin-bottom","1rem"),D.style.setProperty("padding","0.75rem"),D.style.setProperty("background","var(--surface-color)"),D.style.setProperty("border-radius","var(--border-radius-sm)"),D.style.setProperty("border","1px solid var(--border-color)"),j.style.setProperty("font-size","0.875rem"),j.style.setProperty("font-weight","500"),s(j,()=>t("entryBooks.activeFilters","Active filters"),ue),s(D,(()=>{var T=ge(()=>h()!=="all");return()=>T()&&(()=>{var G=Xs(),Z=G.firstChild;return G.style.setProperty("padding","0.25rem 0.5rem"),G.style.setProperty("background","var(--primary-color)"),G.style.setProperty("color","white"),G.style.setProperty("border-radius","12px"),G.style.setProperty("font-size","0.75rem"),s(G,()=>t("common.status"),Z),s(G,h,null),G})()})(),W),s(D,(()=>{var T=ge(()=>b()!=="all");return()=>T()&&(()=>{var G=Xs(),Z=G.firstChild;return G.style.setProperty("padding","0.25rem 0.5rem"),G.style.setProperty("background","var(--primary-color)"),G.style.setProperty("color","white"),G.style.setProperty("border-radius","12px"),G.style.setProperty("font-size","0.75rem"),s(G,()=>t("journal.account"),Z),s(G,()=>xt.getAccountById(b())?.name||t("common.unknown","Unknown"),null),G})()})(),W),s(D,(()=>{var T=ge(()=>!!A());return()=>T()&&(()=>{var G=Xs(),Z=G.firstChild;return G.style.setProperty("padding","0.25rem 0.5rem"),G.style.setProperty("background","var(--primary-color)"),G.style.setProperty("color","white"),G.style.setProperty("border-radius","12px"),G.style.setProperty("font-size","0.75rem"),s(G,()=>t("entryBooks.from","From"),Z),s(G,A,null),G})()})(),W),s(D,(()=>{var T=ge(()=>!!R());return()=>T()&&(()=>{var G=Xs(),Z=G.firstChild;return G.style.setProperty("padding","0.25rem 0.5rem"),G.style.setProperty("background","var(--primary-color)"),G.style.setProperty("color","white"),G.style.setProperty("border-radius","12px"),G.style.setProperty("font-size","0.75rem"),s(G,()=>t("entryBooks.to","To"),Z),s(G,R,null),G})()})(),W),W.style.setProperty("margin-left","auto"),W.style.setProperty("font-size","0.875rem"),W.style.setProperty("color","var(--text-muted)"),s(W,()=>L.length,ce),s(W,()=>t("entryBooks.entriesFound","{count} entries found").replace("{count}",L.length.toString()),null),D})()),ge(()=>ge(()=>L.length===0)()?w(Ge,{get title(){return t("entryBooks.noJournalEntries","No Journal Entries")},get subtitle(){return t("entryBooks.startByCreating","Start by creating your first entry")},get children(){var D=Y2(),j=D.firstChild;return D.style.setProperty("text-align","center"),D.style.setProperty("color","var(--text-muted)"),D.style.setProperty("padding","2rem"),s(D,()=>t("entryBooks.noEntriesMatch","No journal entries match your current filters."),j),s(D,w(Le,{variant:"primary",style:{"margin-top":"1rem"},onClick:Y,get children(){return t("entryBooks.createFirstEntry","Create First Entry")}}),null),D}}):(()=>{var D=Pn();return d(D,v),s(D,w(nt,{each:L,children:j=>w(P2,{entry:j,onViewDetails:re})})),D})()),w(Mf,{get isOpen(){return e()},onClose:$,get editEntry(){return n()}}),w(z2,{get isOpen(){return i()},onClose:()=>{a(!1),u(null)},get entryId(){return c()}})]}})};var Q2=z("<div>$124,350"),J2=z("<div>+12% from last month"),X2=z("<div>247"),Wo=z("<div>"),Z2=z("<div>18"),eE=z("<div>$89,250"),tE=z("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const rE=()=>{const{t}=it(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},n={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)",margin:"0.5rem 0"},o={"font-size":"0.875rem",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"};return w(Ur,{get title(){return t("dashboard.title")},get children(){return[(()=>{var i=Wo();return d(i,e),s(i,w(Ge,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var a=Q2();return le(c=>d(a,n,c)),a})(),(()=>{var a=J2();return le(c=>d(a,o,c)),a})()]}}),null),s(i,w(Ge,{get title(){return t("dashboard.employeeCount")},get subtitle(){return t("dashboard.current")},get children(){return[(()=>{var a=X2();return le(c=>d(a,n,c)),a})(),(()=>{var a=Wo();return s(a,()=>t("dashboard.newHires")),le(c=>d(a,o,c)),a})()]}}),null),s(i,w(Ge,{get title(){return t("dashboard.pendingInvoices")},get subtitle(){return t("dashboard.outstanding")},get children(){return[(()=>{var a=Z2();return le(c=>d(a,n,c)),a})(),(()=>{var a=Wo();return s(a,()=>t("dashboard.totalOutstanding")),le(c=>d(a,o,c)),a})()]}}),null),s(i,w(Ge,{get title(){return t("dashboard.cashBalance")},get subtitle(){return t("accounts.title")},get children(){return[(()=>{var a=eE();return le(c=>d(a,n,c)),a})(),(()=>{var a=Wo();return s(a,()=>t("dashboard.lastUpdatedToday")),le(c=>d(a,o,c)),a})()]}}),null),i})(),(()=>{var i=Wo();return d(i,r),s(i,w(Ge,{get title(){return t("dashboard.quickActions")},get subtitle(){return t("dashboard.commonTasks")},get children(){var a=Wo();return a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("gap","1rem"),s(a,w(Le,{variant:"primary",get children(){return t("invoices.createNew")}}),null),s(a,w(Le,{variant:"secondary",get children(){return t("employees.addEmployee")}}),null),s(a,w(Le,{variant:"outline",get children(){return t("dashboard.generateReport")}}),null),a}}),null),s(i,w(Ge,{get title(){return t("dashboard.recentActivity")},get subtitle(){return t("dashboard.latestUpdates")},get children(){var a=tE(),c=a.firstChild,u=c.firstChild,h=u.nextSibling,y=c.nextSibling,b=y.firstChild,_=b.nextSibling,A=y.nextSibling,E=A.firstChild,R=E.nextSibling;return a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("gap","0.75rem"),c.style.setProperty("border-bottom","1px solid var(--border-color)"),c.style.setProperty("padding-bottom","0.5rem"),u.style.setProperty("font-weight","500"),s(u,()=>t("dashboard.invoicePaid")),h.style.setProperty("font-size","0.875rem"),h.style.setProperty("color","var(--text-muted)"),s(h,()=>t("dashboard.hoursAgo")),y.style.setProperty("border-bottom","1px solid var(--border-color)"),y.style.setProperty("padding-bottom","0.5rem"),b.style.setProperty("font-weight","500"),s(b,()=>t("dashboard.newEmployeeOnboarded")),_.style.setProperty("font-size","0.875rem"),_.style.setProperty("color","var(--text-muted)"),s(_,()=>t("dashboard.dayAgo")),E.style.setProperty("font-weight","500"),s(E,()=>t("dashboard.monthlyReportGenerated")),R.style.setProperty("font-size","0.875rem"),R.style.setProperty("color","var(--text-muted)"),s(R,()=>t("dashboard.daysAgo")),a}}),null),i})(),w(Re,{get when(){return wt.hasPermission("invoiceAccess")},get children(){return w(m2,{})}})]}})};var Am=z("<div>"),nE=z("<div><div><div><strong>Display Name:</strong> </div><div><strong>UID:</strong> </div></div><div><strong>Created:</strong> "),oE=z("<div><h3>Store Access</h3><div></div><div>No store access granted"),iE=z("<div><h3>Permissions</h3><div>"),sE=z('<div><div><input type=text placeholder="Search users..."></div><div>'),aE=z("<div>⚠️ You need administrator privileges to access this page."),lE=z("<div>Loading users..."),cE=z("<div><div></div><div></div><div> stores"),dE=z("<div>Select a user to view and edit their profile"),uE=z("<div><input type=checkbox><label>"),hE=z("<div><input type=checkbox><div><div></div><div>");const mE=()=>{const[t,e]=fe([]),[r,n]=fe(null),[o,i]=fe(!1),[a,c]=fe(!1),[u,h]=fe(""),[y,b]=fe(null),_=[{id:"YY_8802",name:"Store 8802"},{id:"YY_8803",name:"Store 8803"},{id:"YY_8804",name:"Store 8804"},{id:"YY_8805",name:"Store 8805"},{id:"YY_8816",name:"Store 8816"},{id:"YY_8818",name:"Store 8818"},{id:"YY_8847",name:"Store 8847"},{id:"YY_3251",name:"Store 3251"},{id:"YY_32",name:"Store 32"},{id:"YY_76",name:"Store 76"},{id:"YY_79",name:"Store 79"},{id:"YY_8635",name:"Store 8635"},{id:"YY_8665",name:"Store 8665"},{id:"YY_8901",name:"Store 8901"}],A=[{key:"AccountAccess",label:"Account Access",description:"Access to accounting features"},{key:"BankingAccess",label:"Banking Access",description:"Access to banking operations"},{key:"InventoryAccess",label:"Inventory Access",description:"Access to inventory management"},{key:"JournalAccess",label:"Journal Access",description:"Access to journal entries"},{key:"inventoryDownsection",label:"Inventory Downsection",description:"Access to inventory downsection"},{key:"onlyRead",label:"Read Only",description:"Limited to read-only access"},{key:"read_write",label:"Read/Write",description:"Full read and write permissions"},{key:"isAdmin",label:"Administrator",description:"Full system administration rights"}];let E={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,invoiceAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};Hr(async()=>{await R()});const R=async()=>{try{i(!0);const m=JS(xc,"users"),re=dw(m,uw("createdAt","desc")),Y=await fw(re),$=[];Y.forEach(V=>{let Q=V.data();Object.keys(E).map(L=>{let D=E?.[L];Q.hasOwnProperty(L)||(Q[L]=D)}),$.push({uid:V.id,...Q})}),e($)}catch(m){console.error("Error loading users:",m),b({type:"error",text:"Failed to load users"})}finally{i(!1)}},P=ze(()=>{const m=u().toLowerCase();return m?t().filter(re=>re.email?.toLowerCase().includes(m)||re.displayName?.toLowerCase().includes(m)||re.uid?.toLowerCase().includes(m)):t()}),k=m=>{r()&&n(re=>({...re,stores:{...re.stores,[m]:!re.stores[m]}}))},K=m=>{r()&&n(re=>({...re,[m]:!re[m]}))};ze(()=>r()?r().stores&&Object.values(r().stores).some(m=>m):!1);const oe=async()=>{if(r())try{c(!0),b(null);const m=bf(xc,"users",r().uid);let re={stores:r().stores,AccountAccess:r().AccountAccess,BankingAccess:r().BankingAccess,InventoryAccess:r().InventoryAccess,JournalAccess:r().JournalAccess,inventoryDownsection:r().inventoryDownsection,onlyRead:r().onlyRead,read_write:r().read_write,isAdmin:r().isAdmin||!1};await Ef(m,re),e(Y=>Y.map($=>$.uid===r().uid?r():$)),b({type:"success",text:"User profile updated successfully"})}catch(m){console.error("Error saving user profile:",m),b({type:"error",text:"Failed to save user profile"})}finally{c(!1)}},O={display:"grid","grid-template-columns":"350px 1fr",gap:"2rem",height:"calc(100vh - 200px)"},M={"max-height":"100%","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)",background:"var(--surface-color)"},N=m=>({padding:"1rem","border-bottom":"1px solid var(--border-color)",cursor:"pointer",background:m?"var(--primary-color-light)":"transparent",transition:"background 0.2s"}),g={padding:"0.75rem",border:"none","border-bottom":"1px solid var(--border-color)",background:"var(--surface-color)",width:"100%","font-size":"1rem"},v={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem"},f={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.75rem"},C={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",transition:"all 0.2s"},S=m=>({padding:"1rem","margin-bottom":"1rem","border-radius":"var(--border-radius)",background:m==="success"?"#d4edda":"#f8d7da",color:m==="success"?"#155724":"#721c24",border:`1px solid ${m==="success"?"#c3e6cb":"#f5c6cb"}`}),x=ze(()=>wt.state.profile?.isAdmin===!0);return w(Ur,{title:"User Profile Administration",get children(){return w(Re,{get when(){return x()},get fallback(){return w(Ge,{get children(){var m=aE();return m.style.setProperty("text-align","center"),m.style.setProperty("padding","2rem"),m.style.setProperty("color","var(--text-muted)"),m}})},get children(){var m=sE(),re=m.firstChild,Y=re.firstChild,$=re.nextSibling;return d(m,O),d(re,M),Y.$$input=V=>h(V.currentTarget.value),d(Y,g),s(re,w(Re,{get when(){return!o()},get fallback(){return(()=>{var V=lE();return V.style.setProperty("padding","2rem"),V.style.setProperty("text-align","center"),V})()},get children(){return w(nt,{get each(){return P()},children:V=>(()=>{var Q=cE(),L=Q.firstChild,D=L.nextSibling,j=D.nextSibling,ue=j.firstChild;return Q.$$click=()=>n(V),L.style.setProperty("font-weight","600"),s(L,()=>V.displayName||"No Name"),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("color","var(--text-muted)"),s(D,()=>V.email),j.style.setProperty("font-size","0.75rem"),j.style.setProperty("color","var(--text-muted)"),j.style.setProperty("margin-top","0.25rem"),s(j,()=>V.isAdmin&&"👑 Admin • ",ue),s(j,()=>Object.values(V.stores||{}).filter(Boolean).length,ue),le(W=>d(Q,N(r()?.uid===V.uid),W)),Q})()})}}),null),s($,w(Re,{get when(){return r()},get fallback(){return w(Ge,{get children(){var V=dE();return V.style.setProperty("text-align","center"),V.style.setProperty("padding","2rem"),V.style.setProperty("color","var(--text-muted)"),V}})},get children(){return[w(Re,{get when(){return y()},get children(){var V=Am();return s(V,()=>y().text),le(Q=>d(V,S(y().type),Q)),V}}),w(Ge,{title:"User Information",get subtitle(){return r().email},get children(){return[(()=>{var V=nE(),Q=V.firstChild,L=Q.firstChild,D=L.firstChild;D.nextSibling;var j=L.nextSibling,ue=j.firstChild;ue.nextSibling;var W=Q.nextSibling,ce=W.firstChild;return ce.nextSibling,V.style.setProperty("margin-bottom","2rem"),Q.style.setProperty("display","flex"),Q.style.setProperty("justify-content","space-between"),Q.style.setProperty("margin-bottom","1rem"),s(L,()=>r().displayName||"Not set",null),s(j,()=>r().uid,null),s(W,()=>new Date(r().createdAt?.toDate?.()||r().createdAt).toLocaleDateString(),null),V})(),(()=>{var V=oE(),Q=V.firstChild,L=Q.nextSibling,D=L.nextSibling;return V.style.setProperty("margin-bottom","2rem"),Q.style.setProperty("margin-bottom","1rem"),d(L,f),s(L,w(nt,{each:_,children:j=>{let ue=De.getLocationById(j?.id);return(()=>{var W=uE(),ce=W.firstChild,T=ce.nextSibling;return W.$$click=()=>k(j?.id),ce.style.setProperty("cursor","pointer"),T.style.setProperty("cursor","pointer"),T.style.setProperty("user-select","none"),s(T,()=>ue?.name),le(G=>d(W,{...C,background:r().stores?.[j?.id]?"var(--primary-color-light)":"transparent"},G)),le(()=>ce.checked=r().stores?.[j?.id]||!1),W})()}})),D.style.setProperty("margin-top","0.5rem"),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("color","var(--text-muted)"),V})(),(()=>{var V=iE(),Q=V.firstChild,L=Q.nextSibling;return V.style.setProperty("margin-bottom","2rem"),Q.style.setProperty("margin-bottom","1rem"),d(L,v),s(L,w(nt,{each:A,children:D=>(()=>{var j=hE(),ue=j.firstChild,W=ue.nextSibling,ce=W.firstChild,T=ce.nextSibling;return j.$$click=()=>K(D.key),ue.style.setProperty("cursor","pointer"),W.style.setProperty("flex","1"),W.style.setProperty("cursor","pointer"),W.style.setProperty("user-select","none"),ce.style.setProperty("font-weight","500"),s(ce,()=>D.label),T.style.setProperty("font-size","0.75rem"),T.style.setProperty("color","var(--text-muted)"),s(T,()=>D.description),le(G=>d(j,{...C,background:r()[D.key]?"var(--primary-color-light)":"transparent"},G)),le(()=>ue.checked=!!r()[D.key]),j})()})),V})(),(()=>{var V=Am();return V.style.setProperty("display","flex"),V.style.setProperty("gap","1rem"),V.style.setProperty("justify-content","flex-end"),s(V,w(Le,{variant:"secondary",onClick:()=>n(null),children:"Cancel"}),null),s(V,w(Le,{variant:"primary",onClick:oe,get disabled(){return a()},get children(){return a()?"Saving...":"Save Changes"}}),null),V})()]}})]}})),le(()=>Y.value=u()),m}})}})};ft(["input","click"]);const yE=async()=>{try{console.log("Testing PDF generation...");const e=(await Zo(()=>import("./jspdf.es.min-br-kbRzc.js").then(n=>n.j),[])).default;console.log("jsPDF imported successfully");const r=new e;console.log("PDF document created"),r.setFontSize(20),r.text("Test PDF",20,20),r.setFontSize(12),r.text("This is a test PDF to verify the library works.",20,40),console.log("Text added to PDF"),r.save("test.pdf"),console.log("PDF saved successfully"),alert("Test PDF generated successfully!")}catch(t){console.error("Test PDF generation failed:",t),alert(`Test PDF failed: ${t.message}`)}},pE=(t,e)=>{try{console.log("Generating printable PDF...");const r=window.open("","_blank","width=800,height=600");if(!r){alert("Please allow popups to generate PDF");return}const n=t.shipper_consignee||{},o=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Invoice ${t.invoice||"N/A"}</title>
        <style>
          body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
          }
          .header {
            display: flex;
            justify-content: space-between;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
            margin-bottom: 20px;
          }
          .company {
            font-size: 24px;
            font-weight: bold;
            color: #2563eb;
          }
          .invoice-info {
            text-align: right;
          }
          .section {
            margin: 20px 0;
          }
          .section-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
          }
          .customer-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
          }
          th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
          }
          th {
            background-color: #f2f2f2;
            font-weight: bold;
          }
          .total-row {
            font-weight: bold;
            font-size: 16px;
            background-color: #e8f4fd;
          }
          @media print {
            body { margin: 0; }
            .no-print { display: none; }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <div>
            <div class="company">HRM FINANCE</div>
            <div>Store: ${t.storeName||t.store||"N/A"}</div>
            <div>Order ID: ${t.ssg_sorder_key||"N/A"}</div>
          </div>
          <div class="invoice-info">
            <div style="font-size: 18px; font-weight: bold;">INVOICE</div>
            <div style="font-size: 16px; margin: 5px 0;">${t.invoice||"N/A"}</div>
            <div>${t.createDate?new Date(t.createDate).toLocaleDateString():"N/A"}</div>
            <div style="margin-top: 10px;">
              <span style="padding: 4px 8px; background: ${t.isCompleted?"#d4edda":"#fff3cd"}; border-radius: 10px; font-size: 12px;">
                ${t.isCompleted?"COMPLETED":"PENDING"}
              </span>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="section-title">Customer Information</div>
          <div class="customer-info">
            <div><strong>Name:</strong> ${n.name||"N/A"}</div>
            <div><strong>Full Name:</strong> ${[n.firstName,n.lastName].filter(Boolean).join(" ")||"N/A"}</div>
            <div><strong>Phone:</strong> ${n.phoneNumber||"N/A"}</div>
            <div><strong>ID:</strong> ${n.cid||"N/A"}</div>
            ${n.passport?`<div><strong>Passport:</strong> ${n.passport}</div>`:""}
          </div>
        </div>

        ${t.products&&t.products.length>0?`
        <div class="section">
          <div class="section-title">Products</div>
          <table>
            <thead>
              <tr>
                <th>Code</th>
                <th>Description</th>
                <th>Quantity</th>
                <th>Unit Price</th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody>
              ${t.products.map(i=>`
                <tr>
                  <td>${i.product?.code||"N/A"}</td>
                  <td>${i.product?.label||"N/A"}</td>
                  <td>${Math.abs(i.qty||0)}</td>
                  <td>$${parseFloat(i.salePrice||0).toFixed(2)}</td>
                  <td>$${(Math.abs(i.qty||0)*parseFloat(i.salePrice||0)).toFixed(2)}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </div>
        `:""}

        ${t.reservas&&t.reservas.length>0?`
        <div class="section">
          <div class="section-title">Reservations</div>
          <table>
            <thead>
              <tr>
                <th>Type</th>
                <th>Quantity</th>
                <th>Unit Price</th>
                <th>Arancel</th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody>
              ${t.reservas.map(i=>{const a=parseInt(i.qty||0),c=parseFloat(i.price||0),u=parseFloat(i.arancel||0),h=a*c+u;return`
                  <tr>
                    <td>${i.type||"N/A"}</td>
                    <td>${i.qty||0}</td>
                    <td>$${c.toFixed(2)}</td>
                    <td>${i.arancel||"-"}</td>
                    <td>$${h.toFixed(2)}</td>
                  </tr>
                `}).join("")}
            </tbody>
          </table>
        </div>
        `:""}

        <div class="section">
          <table style="margin-left: auto; width: 300px;">
            ${t.productSubtotal?`
            <tr>
              <td><strong>Products Subtotal:</strong></td>
              <td style="text-align: right;"><strong>$${t.productSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            ${t.reservaSubtotal?`
            <tr>
              <td><strong>Reservations Subtotal:</strong></td>
              <td style="text-align: right;"><strong>$${t.reservaSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            <tr class="total-row">
              <td><strong>TOTAL:</strong></td>
              <td style="text-align: right;"><strong>$${(t.total||0).toFixed(2)}</strong></td>
            </tr>
          </table>
        </div>

        <div style="margin-top: 40px; text-align: center; color: #666; font-size: 12px;">
          <p>Thank you for your business!</p>
          <p>Generated on ${new Date().toLocaleDateString()}</p>
        </div>

        <div class="no-print" style="margin-top: 30px; text-align: center;">
          <button onclick="window.print()" style="padding: 10px 20px; font-size: 16px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
            Print / Save as PDF
          </button>
          <button onclick="window.close()" style="padding: 10px 20px; font-size: 16px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer; margin-left: 10px;">
            Close
          </button>
        </div>
      </body>
      </html>
    `;r.document.write(o),r.document.close(),r.focus(),console.log("Printable PDF window opened")}catch(r){console.error("Error generating printable PDF:",r),alert("Error generating printable PDF: "+r.message)}},fE=async(t,e)=>{try{console.log("Starting professional PDF generation...");const n=(await Zo(()=>import("./jspdf.es.min-br-kbRzc.js").then(se=>se.j),[])).default,o=new n,i=210,a=297,c=15,u=i-c*2,h={r:180,g:180,b:180},y={r:80,g:80,b:80},b={r:130,g:130,b:130},_={r:248,g:248,b:248},A={r:252,g:252,b:252},E={r:120,g:120,b:120},R={r:150,g:150,b:150};let P=c;const k=se=>{o.setTextColor(se.r,se.g,se.b)},K=se=>{o.setFillColor(se.r,se.g,se.b)},oe=(se,pe,de,ye,X,ee=!1)=>{o.roundedRect(se,pe,de,ye,X,X,ee?"F":"S")};K(A),o.rect(0,0,i,50,"F"),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.5),o.line(0,50,i,50),k(y),o.setFontSize(32),o.setFont("helvetica","bold"),o.text("HRM",c,25),k(b),o.setFontSize(32),o.setFont("helvetica","normal");const O=o.getTextWidth("HRM ");o.text("FINANCE",c+O,25),k(b),o.setFontSize(9),o.setFont("helvetica","normal"),o.text("Professional Business Solutions",c,35);const M=70,N=i-c-M;o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.5),oe(N,12,M,26,2,!1),k(y),o.setFontSize(14),o.setFont("helvetica","bold");const g=e("common.invoice").toUpperCase(),v=o.getTextWidth(g);o.text(g,N+(M-v)/2,22),o.setFontSize(11),o.setFont("helvetica","normal");const f=t.invoice||"N/A",C=o.getTextWidth(f);o.text(f,N+(M-C)/2,32),P=60,K(A),o.rect(0,50,i,20,"F");const S=t.isCompleted,x=S?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase();k(S?y:b),o.setFontSize(8),o.setFont("helvetica","bold"),o.text(`STATUS: ${x}`,c,58),k(b),o.setFontSize(9),o.setFont("helvetica","normal");const re=t.createDate?new Date(t.createDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A";o.text(re,i-c-o.getTextWidth(re),58),P=58,o.text(`${e(`inventory.${t?.storeType}Type`)}: ${t.storeName||t.store||"N/A"}`,c+60,P),P+=5,o.text(`Order ID: ${t.ssg_sorder_key||"N/A"}`,c+60,P),P=80,k(y),o.setFontSize(14),o.setFont("helvetica","bold"),o.text(e("invoices.customerInformation"),c,P),P+=10;const Y=45,$=10,V=(u-$)/2;K(A),oe(c,P,V,Y,3,!0),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),oe(c,P,V,Y,3);const Q=t.shipper_consignee||{};let L=P+8;k(b),o.setFontSize(9),o.text(e("invoices.senderInformation"),c+5,L),L+=7,k(y),o.setFontSize(11),o.setFont("helvetica","bold"),o.text(Q.name||"N/A",c+5,L),Q.phoneNumberS&&(L+=6,o.setFont("helvetica","normal"),o.setFontSize(9),k(b),o.text(`${e("invoices.altPhone")}: ${Q.phoneNumberS}`,c+5,L)),K(A),oe(c+V+$,P,V,Y,3,!0),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),oe(c+V+$,P,V,Y,3),L=P+8,k(b),o.setFontSize(9),o.text(e("invoices.receiptInformation"),c+V+$+5,L),L+=7;const D=[Q.firstName,Q.middleName,Q.lastName,Q.lastName2].filter(Boolean).join(" ")||"N/A";k(y),o.setFontSize(11),o.setFont("helvetica","bold"),o.text(D,c+V+$+5,L),L+=6,o.setFont("helvetica","normal"),o.setFontSize(9),k(b),o.text(`${e("invoices.phoneNumber")}: ${Q.phoneNumber||"N/A"}`,c+V+$+5,L),console.log(Q),L+=5,o.text(`${e("invoices.id")}: ${Q.cid||"N/A"}`,c+V+$+5,L);let j=`${Q.ybstreet} #${Q.ybstreetNo} ${e("invoices.between")} ${Q.ybbetwen1} ${e("invoices.and")} ${Q.ybbetwen2}`,ue=`${Q.ybreparto}, ${Q.ybcity}, ${Q.ybestate}`;if(L+=5,o.text(j,c+V+$+5,L),L+=5,o.text(ue,c+V+$+5,L),P+=Y+15,t?.products&&t?.products?.length>0){k(y),o.setFontSize(14),o.setFont("helvetica","bold"),o.text(e("invoices.products"),c,P),P+=10,K(_),o.rect(c,P-6,u,10,"F"),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),o.line(c,P+4,i-c,P+4),o.setFontSize(9),o.setFont("helvetica","bold"),k(y);const se={code:c+5,description:c+35,qty:c+115,price:c+135,total:c+160};o.text(e("invoices.code"),se.code,P),o.text(e("invoices.description"),se.description,P),o.text(e("invoices.qty"),se.qty,P),o.text(e("invoices.unitPrice"),se.price,P),o.text(e("invoices.total"),se.total,P),P+=10,o.setFont("helvetica","normal"),o.setFontSize(9),t.products.forEach((pe,de)=>{P>250&&(o.addPage(),P=c),de%2===0&&(K(A),o.rect(c,P-4,u,8,"F")),k(y),o.text(pe.product?.code||"N/A",se.code,P);let ye=pe.product?.label||"N/A";o.getTextWidth(ye)>70&&(ye=ye.substring(0,40)+"..."),o.text(ye,se.description,P);const X=Math.abs(pe.qty||0),ee=parseFloat(pe.salePrice||0),q=X*ee;o.text(X.toString(),se.qty,P),o.text(`$${ee.toFixed(2)}`,se.price,P),o.setFont("helvetica","bold"),o.text(`$${q.toFixed(2)}`,se.total,P),o.setFont("helvetica","normal"),P+=8}),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),o.line(c,P,i-c,P),P+=15}if(t.reservas&&t.reservas.length>0){P>200&&(o.addPage(),P=c),k(y),o.setFontSize(14),o.setFont("helvetica","bold"),o.text(e("invoices.reservations"),c,P),P+=10,K(_),o.rect(c,P-6,u,10,"F"),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),o.line(c,P+4,i-c,P+4),o.setFontSize(9),o.setFont("helvetica","bold"),k(y);const se={type:c+5,qty:c+65,price:c+95,arancel:c+125,total:c+160};o.text(e("invoices.type"),se.type,P),o.text(e("invoices.qty"),se.qty,P),o.text(e("invoices.unitPrice"),se.price,P),o.text(e("invoices.arancel"),se.arancel,P),o.text(e("invoices.total"),se.total,P),P+=10,o.setFont("helvetica","normal"),o.setFontSize(9),t.reservas.forEach((pe,de)=>{P>250&&(o.addPage(),P=c),de%2===0&&(K(A),o.rect(c,P-4,u,8,"F")),k(y),o.text(pe.type||"N/A",se.type,P);const ye=parseInt(pe.qty||0),X=parseFloat(pe.price||0),ee=parseFloat(pe.arancel||0),q=ye*X+ee;o.text(ye.toString(),se.qty,P),o.text(`$${X.toFixed(2)}`,se.price,P),o.text(pe.arancel||"-",se.arancel,P),o.setFont("helvetica","bold"),o.text(`$${q.toFixed(2)}`,se.total,P),o.setFont("helvetica","normal"),P+=8}),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),o.line(c,P,i-c,P),P+=15}P>210&&(o.addPage(),P=c);const W=i-c-80,ce=80;K(A),oe(W-10,P,ce+10,60,3,!0),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),oe(W-10,P,ce+10,60,3);let T=P+10;o.setFontSize(10),k(b),t.productSubtotal!==void 0&&t.productSubtotal>0&&(o.text(e("invoices.productsSubtotal"),W,T),o.text(`$${t.productSubtotal.toFixed(2)}`,W+ce-15,T,{align:"right"}),T+=8),t.reservaSubtotal!==void 0&&t.reservaSubtotal>0&&(o.text(e("invoices.reservationsSubtotal"),W,T),o.text(`$${t.reservaSubtotal.toFixed(2)}`,W+ce-15,T,{align:"right"}),T+=8),o.setDrawColor(h.r,h.g,h.b),o.setLineWidth(.3),o.line(W,T+2,W+ce-10,T+2),T+=10,o.setFontSize(14),o.setFont("helvetica","bold"),k(y),o.text(e("invoices.total"),W,T),o.text(`$${(t.total||0).toFixed(2)}`,W+ce-15,T,{align:"right"}),P=a-30,K(A),o.rect(0,P-10,i,40,"F"),o.setFontSize(12),o.setFont("helvetica","italic"),k(b);const G="Thank you for your business!",Z=o.getTextWidth(G);o.text(G,(i-Z)/2,P),P+=8,o.setFontSize(9),o.setFont("helvetica","normal");const F="www.hrmfinance.com | info@hrmfinance.com | +1 (555) 123-4567",ne=o.getTextWidth(F);o.text(F,(i-ne)/2,P),P+=8,o.setFontSize(8);const H=`Generated on ${new Date().toLocaleString("en-US")}`,U=o.getTextWidth(H);o.text(H,(i-U)/2,P);const ae=`invoice-${t.invoice||"unknown"}.pdf`;o.save(ae),console.log("Professional PDF saved successfully:",ae)}catch(r){throw console.error("Error in generateProfessionalInvoicePDF:",r),r}};var gE=z("<br>"),xm=z("<div><h3></h3><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),Im=z("<div><span>:</span><span>"),vE=z("<div class=invoice-display><div><div><div>:<span></span></div><div>: <span></span></div></div><div><div></div><h2></h2><div></div><div></div></div></div><div><h3></h3><div><div><div></div><div></div></div></div><div></div><h3></h3><div><div><div></div><div> <!> <!> </div><div></div><div></div><div></div><div></div></div><div><div></div><div></div><div></div><div></div><div> #<br> <!> <!> <br>, <br>, </div></div></div></div><div><div><div><span>:</span><span></span></div></div></div><div></div><div><button>🖨️ </button><button>🧪 Test PDF</button><button>📥 </button></div><style>"),$m=z("<tr><td></td><td></td><td></td><td></td><td>");const bE=t=>{const{t:e}=it(),r=f=>new Date(f).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),n=f=>{const C=typeof f=="string"?parseFloat(f):f;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(C)},o=ze(()=>{let f=0,C=0,S=0,x=0;t.invoice?.products?.forEach($=>{const V=Math.abs($?.qty),Q=parseFloat($?.salePrice)||1;f+=V*Q}),t.invoice?.reservas?.forEach($=>{let V=parseInt($?.qty);isNaN(V)&&(V=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[$.type]||$?.onlyTariff?(V=parseFloat($.arancel)||parseFloat($.qty)*parseFloat($.price),S+=V):($?.arancel&&(x+=parseFloat($?.arancel)),C+=V*parseFloat($?.price))});const m=f+C+x+S,re=0,Y=m+re;return{productSubtotal:f,reservaSubtotal:C,tariffSubtotal:x,subtotal:m,tax:re,total:Y}}),i={"max-width":"800px",margin:"0 auto",padding:"2rem",background:"white","box-shadow":"0 0 20px rgba(0,0,0,0.1)","border-radius":"var(--border-radius)"},a={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"2rem","padding-bottom":"2rem","border-bottom":"2px solid #e0e0e0"},c={"text-align":"right",flex:"1"},u={display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600","text-transform":"uppercase",background:t.invoice.isCompleted?"#d4edda":"#fff3cd",color:t.invoice.isCompleted?"#155724":"#856404","margin-bottom":"0.5rem"},h={"margin-bottom":"2rem"},y={"font-size":"1.1rem","font-weight":"600","margin-bottom":"1rem",color:"#333"},b={display:"grid","grid-template-columns":"1fr 1fr",gap:"1.5rem"},_={background:"#f8f9fa",padding:"1rem","border-radius":"var(--border-radius-sm)",border:"1px solid #e9ecef"},A={"font-size":"0.875rem",color:"#666","margin-bottom":"0.25rem"},E={"font-size":"1rem",color:"#333","font-weight":"500"},R={width:"100%","border-collapse":"collapse","margin-top":"1rem"},P={"text-align":"left",padding:"0.75rem","border-bottom":"2px solid #dee2e6","font-weight":"600",color:"#495057","font-size":"0.875rem","text-transform":"uppercase"},k={padding:"0.75rem","border-bottom":"1px solid #dee2e6",color:"#212529"},K={"font-weight":"600","font-size":"1.1rem"},oe={display:"flex",gap:"1rem","justify-content":"center","margin-top":"2rem","padding-top":"2rem","border-top":"2px solid #e0e0e0"},O={padding:"0.75rem 1.5rem","border-radius":"var(--border-radius-sm)",border:"none","font-weight":"500",cursor:"pointer",transition:"all 0.2s",display:"flex","align-items":"center",gap:"0.5rem"},M={...O,background:"var(--primary-color)",color:"white"},N={...O,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},g=ze(()=>De.getLocationById(t.invoice.store)),v=async()=>{console.log("Starting PDF export...");try{if(!t.invoice){console.error("No invoice data available"),alert("No invoice data available");return}console.log("Invoice data:",t.invoice),console.log("Store info:",g()),console.log("Totals:",o());const f={...t.invoice,storeName:g()?.name||t.invoice.store,storeType:g()?.type,productSubtotal:o().productSubtotal,reservaSubtotal:o().reservaSubtotal,total:o().total};console.log("Prepared invoice data:",f),console.log("Using minimal ink PDF generator...");try{await fE(f,e),console.log("Minimal ink PDF generation completed successfully")}catch(C){console.error("PDF generation failed:",C),console.log("Trying printable PDF fallback..."),pE(f,e),console.log("Printable PDF fallback completed")}}catch(f){console.error("Error in handleExportPDF:",f),console.error("Error stack:",f.stack),alert(`Error generating PDF: ${f.message}`)}};return(()=>{var f=vE(),C=f.firstChild,S=C.firstChild,x=S.firstChild,m=x.firstChild,re=m.nextSibling,Y=x.nextSibling,$=Y.firstChild,V=$.nextSibling,Q=S.nextSibling,L=Q.firstChild,D=L.nextSibling,j=D.nextSibling,ue=j.nextSibling,W=C.nextSibling,ce=W.firstChild,T=ce.nextSibling,G=T.firstChild,Z=G.firstChild,F=Z.nextSibling,ne=T.nextSibling,H=ne.nextSibling,U=H.nextSibling,ae=U.firstChild,se=ae.firstChild,pe=se.nextSibling,de=pe.firstChild,ye=de.nextSibling,X=ye.nextSibling,ee=X.nextSibling;ee.nextSibling;var q=pe.nextSibling,he=q.nextSibling,ve=he.nextSibling,B=ve.nextSibling,te=ae.nextSibling,_e=te.firstChild,we=_e.nextSibling,me=we.nextSibling,be=me.nextSibling,ie=be.nextSibling,Pe=ie.firstChild,Te=Pe.nextSibling,$e=Te.nextSibling,Ee=$e.nextSibling,Ve=Ee.nextSibling,Ke=Ve.nextSibling,je=Ke.nextSibling,Ce=je.nextSibling,Be=Ce.nextSibling,Je=Be.nextSibling,Qe=Je.nextSibling,We=W.nextSibling,xe=We.firstChild,at=xe.firstChild,et=at.firstChild,bt=et.firstChild,ht=et.nextSibling,Nt=We.nextSibling,jt=Nt.nextSibling,Tt=jt.firstChild;Tt.firstChild;var Bt=Tt.nextSibling,gt=Bt.nextSibling;gt.firstChild;var er=jt.nextSibling;return d(f,i),d(C,a),x.style.setProperty("color","#666"),x.style.setProperty("margin-top","0.25rem"),s(x,()=>e(`inventory.${g()?.type}Type`),m),re.style.setProperty("font-size","1.1rem"),re.style.setProperty("font-weight","600"),re.style.setProperty("color","#444"),s(re,()=>g()?.name),Y.style.setProperty("font-size",".91rem"),Y.style.setProperty("font-weight","400"),Y.style.setProperty("color","#666"),s(Y,()=>e("invoices.id"),$),V.style.setProperty("font-size","1.1rem"),V.style.setProperty("font-weight","600"),V.style.setProperty("color","#444"),s(V,()=>t.invoice.ssg_sorder_key),d(Q,c),s(L,(()=>{var Ie=ge(()=>!!t.invoice.isCompleted);return()=>Ie()?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase()})()),D.style.setProperty("margin","0 0 0.5rem 0"),D.style.setProperty("font-size","1.5rem"),s(D,()=>e("common.invoice").toUpperCase()),j.style.setProperty("font-size","1.1rem"),j.style.setProperty("font-weight","600"),j.style.setProperty("color","#333"),s(j,()=>t.invoice.invoice),ue.style.setProperty("color","#666"),ue.style.setProperty("margin-top","0.5rem"),s(ue,()=>r(t.invoice.createDate)),s(ce,()=>e("invoices.senderInformation")),s(Z,()=>e("invoices.customerName")),s(F,()=>t.invoice.shipper_consignee.name),s(G,w(Re,{get when(){return t.invoice.shipper_consignee.phoneNumberS},get children(){return[gE(),ge(()=>e("invoices.altPhone")),": ",ge(()=>t.invoice.shipper_consignee.phoneNumberS)]}}),null),ne.style.setProperty("margin","20px"),s(H,()=>e("invoices.receiptInformation")),s(se,()=>e("invoices.customerName")),s(pe,()=>t.invoice.shipper_consignee.firstName,de),s(pe,()=>t.invoice.shipper_consignee.middleName,ye),s(pe,()=>t.invoice.shipper_consignee.lastName,ee),s(pe,()=>t.invoice.shipper_consignee.lastName2,null),s(q,()=>e("invoices.id")),s(he,()=>t.invoice.shipper_consignee.cid),s(ve,()=>e("invoices.passport")),s(B,()=>t.invoice.shipper_consignee.passport),s(_e,()=>e("invoices.contactInformation")),s(we,()=>e("invoices.phoneNumber")),s(me,()=>t.invoice.shipper_consignee.phoneNumber),s(be,()=>e("invoices.address")),s(ie,()=>t.invoice.shipper_consignee.ybstreet,Pe),s(ie,()=>t.invoice.shipper_consignee.ybstreetNo,Te),s(ie,()=>e("invoices.between"),$e),s(ie,()=>t.invoice.shipper_consignee.ybbetwen1,Ee),s(ie,()=>e("invoices.and"),Ke),s(ie,()=>t.invoice.shipper_consignee.ybbetwen2,Ce),s(ie,()=>t.invoice.shipper_consignee.ybreparto,Be),s(ie,()=>t.invoice.shipper_consignee.ybcity,Je),s(ie,()=>t.invoice.shipper_consignee.ybestate,Qe),s(ie,()=>t.invoice.shipper_consignee.nacionality,null),s(f,w(Re,{get when(){return t.invoice?.products?.length>0},get children(){var Ie=xm(),St=Ie.firstChild,Oe=St.nextSibling,Fe=Oe.firstChild,Ze=Fe.firstChild,rt=Ze.firstChild,Ct=rt.nextSibling,Xe=Ct.nextSibling,lt=Xe.nextSibling,mt=lt.nextSibling,At=Fe.nextSibling;return s(St,()=>e("invoices.products")),s(rt,()=>e("invoices.code")),s(Ct,()=>e("invoices.description")),s(Xe,()=>e("invoices.qty")),s(lt,()=>e("invoices.unitPrice")),s(mt,()=>e("invoices.total")),s(At,w(nt,{get each(){return t.invoice?.products},children:Me=>(()=>{var Jt=$m(),vt=Jt.firstChild,_t=vt.nextSibling,kt=_t.nextSibling,yt=kt.nextSibling,Lt=yt.nextSibling;return s(vt,()=>Me.product.code),s(_t,()=>Me.product.label),s(kt,()=>Math.abs(Me.qty)),s(yt,()=>n(Me.salePrice)),s(Lt,()=>n(Math.abs(Me.qty)*parseFloat(Me.salePrice))),le(pt=>{var Rt=k,Xt=k,ur={...k,"text-align":"center"},Tr={...k,"text-align":"right"},hr={...k,"text-align":"right"};return pt.e=d(vt,Rt,pt.e),pt.t=d(_t,Xt,pt.t),pt.a=d(kt,ur,pt.a),pt.o=d(yt,Tr,pt.o),pt.i=d(Lt,hr,pt.i),pt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Jt})()})),le(Me=>{var Jt=h,vt=y,_t=R,kt=P,yt=P,Lt={...P,"text-align":"center"},pt={...P,"text-align":"right"},Rt={...P,"text-align":"right"};return Me.e=d(Ie,Jt,Me.e),Me.t=d(St,vt,Me.t),Me.a=d(Oe,_t,Me.a),Me.o=d(rt,kt,Me.o),Me.i=d(Ct,yt,Me.i),Me.n=d(Xe,Lt,Me.n),Me.s=d(lt,pt,Me.s),Me.h=d(mt,Rt,Me.h),Me},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),Ie}}),We),s(f,w(Re,{get when(){return t.invoice?.reservas?.length>0},get children(){var Ie=xm(),St=Ie.firstChild,Oe=St.nextSibling,Fe=Oe.firstChild,Ze=Fe.firstChild,rt=Ze.firstChild,Ct=rt.nextSibling,Xe=Ct.nextSibling,lt=Xe.nextSibling,mt=lt.nextSibling,At=Fe.nextSibling;return s(St,()=>e("invoices.reservations")),s(rt,()=>e("invoices.type")),s(Ct,()=>e("invoices.qty")),s(Xe,()=>e("invoices.unitPrice")),s(lt,()=>e("invoices.arancel")),s(mt,()=>e("invoices.total")),s(At,w(nt,{get each(){return t.invoice?.reservas},children:Me=>(()=>{var Jt=$m(),vt=Jt.firstChild,_t=vt.nextSibling,kt=_t.nextSibling,yt=kt.nextSibling,Lt=yt.nextSibling;return s(vt,()=>Me.type),s(_t,()=>Me.qty),s(kt,()=>n(Me.price)),s(yt,()=>Me.arancel||"-"),s(Lt,()=>n(parseInt(Me.qty)*parseFloat(Me.price)+(Me.arancel?parseFloat(Me.arancel):0))),le(pt=>{var Rt=k,Xt={...k,"text-align":"center"},ur={...k,"text-align":"right"},Tr={...k,"text-align":"right"},hr={...k,"text-align":"right"};return pt.e=d(vt,Rt,pt.e),pt.t=d(_t,Xt,pt.t),pt.a=d(kt,ur,pt.a),pt.o=d(yt,Tr,pt.o),pt.i=d(Lt,hr,pt.i),pt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Jt})()})),le(Me=>{var Jt=h,vt=y,_t=R,kt=P,yt={...P,"text-align":"center"},Lt={...P,"text-align":"right"},pt={...P,"text-align":"right"},Rt={...P,"text-align":"right"};return Me.e=d(Ie,Jt,Me.e),Me.t=d(St,vt,Me.t),Me.a=d(Oe,_t,Me.a),Me.o=d(rt,kt,Me.o),Me.i=d(Ct,yt,Me.i),Me.n=d(Xe,Lt,Me.n),Me.s=d(lt,pt,Me.s),Me.h=d(mt,Rt,Me.h),Me},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),Ie}}),We),xe.style.setProperty("display","inline-block"),xe.style.setProperty("min-width","250px"),s(xe,w(Re,{get when(){return t.invoice?.products?.length>0},get children(){var Ie=Im(),St=Ie.firstChild,Oe=St.firstChild,Fe=St.nextSibling;return Ie.style.setProperty("display","flex"),Ie.style.setProperty("justify-content","space-between"),Ie.style.setProperty("margin-bottom","0.5rem"),s(St,()=>e("invoices.productsSubtotal"),Oe),s(Fe,()=>n(o().productSubtotal)),Ie}}),at),s(xe,w(Re,{get when(){return t.invoice?.reservas?.length>0},get children(){var Ie=Im(),St=Ie.firstChild,Oe=St.firstChild,Fe=St.nextSibling;return Ie.style.setProperty("display","flex"),Ie.style.setProperty("justify-content","space-between"),Ie.style.setProperty("margin-bottom","0.5rem"),s(St,()=>e("invoices.subtotal"),Oe),s(Fe,()=>n(o().reservaSubtotal)),Ie}}),at),s(et,()=>e("invoices.total"),bt),ht.style.setProperty("color","var(--primary-color)"),s(ht,()=>n(o().total)),Tt.addEventListener("mouseleave",Ie=>Ie.currentTarget.style.opacity="1"),Tt.addEventListener("mouseenter",Ie=>Ie.currentTarget.style.opacity="0.9"),Tt.$$click=()=>t.onPrint?.(),s(Tt,()=>e("invoices.printInvoice"),null),Ln(Bt,"click",yE,!0),gt.addEventListener("mouseleave",Ie=>{Ie.currentTarget.style.background="white",Ie.currentTarget.style.color="var(--primary-color)"}),gt.addEventListener("mouseenter",Ie=>{Ie.currentTarget.style.background="var(--primary-color)",Ie.currentTarget.style.color="white"}),gt.$$click=v,s(gt,()=>e("invoices.exportPdf"),null),s(er,`
        @media print {
          .invoice-display {
            box-shadow: none !important;
            padding: 0 !important;
          }
          
          ${oe} {
            display: none !important;
          }
        }
      `),le(Ie=>{var St=u,Oe=h,Fe=y,Ze=b,rt=_,Ct=A,Xe=E,lt=y,mt=b,At=_,Me=A,Jt=E,vt={...A,"margin-top":"0.75rem"},_t=E,kt={...A,"margin-top":"0.75rem"},yt=E,Lt=_,pt=A,Rt={...A,"margin-top":"0.75rem"},Xt=E,ur={...A,"margin-top":"0.75rem"},Tr=E,hr={...h,"text-align":"right"},gn={...K,display:"flex","justify-content":"space-between","padding-top":"0.75rem","border-top":"2px solid #dee2e6"},On={...h,"text-align":"center",color:"#666","font-size":"0.875rem"},Vo=oe,mo=M,yo={...M,background:"#28a745"},Vn=N;return Ie.e=d(L,St,Ie.e),Ie.t=d(W,Oe,Ie.t),Ie.a=d(ce,Fe,Ie.a),Ie.o=d(T,Ze,Ie.o),Ie.i=d(G,rt,Ie.i),Ie.n=d(Z,Ct,Ie.n),Ie.s=d(F,Xe,Ie.s),Ie.h=d(H,lt,Ie.h),Ie.r=d(U,mt,Ie.r),Ie.d=d(ae,At,Ie.d),Ie.l=d(se,Me,Ie.l),Ie.u=d(pe,Jt,Ie.u),Ie.c=d(q,vt,Ie.c),Ie.w=d(he,_t,Ie.w),Ie.m=d(ve,kt,Ie.m),Ie.f=d(B,yt,Ie.f),Ie.y=d(te,Lt,Ie.y),Ie.g=d(_e,pt,Ie.g),Ie.p=d(we,Rt,Ie.p),Ie.b=d(me,Xt,Ie.b),Ie.T=d(be,ur,Ie.T),Ie.A=d(ie,Tr,Ie.A),Ie.O=d(We,hr,Ie.O),Ie.I=d(at,gn,Ie.I),Ie.S=d(Nt,On,Ie.S),Ie.W=d(jt,Vo,Ie.W),Ie.C=d(Tt,mo,Ie.C),Ie.B=d(Bt,yo,Ie.B),Ie.v=d(gt,Vn,Ie.v),Ie},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0}),f})()};ft(["click"]);const[Zs,zt]=Ba({invoices:[],selectedInvoice:null,loading:!1,error:null,lastUpdated:null}),[_E,on]=fe({fetchAll:!1,fetchById:!1,create:!1,update:!1,delete:!1}),jr={get state(){return Zs},get loadingStates(){return _E()},async fetchInvoices(t){try{on(a=>({...a,fetchAll:!0})),zt("loading",!0),zt("error",null);let e="SALES";t?.store&&t.store!=="all"&&(e+=" "+t.store),t?.status&&t.status!=="all"&&(e+=" "+t.status);const r=e.toString(),n=await ln.getInvoice(r);let o=[];if(t?.dateFrom&&t?.dateTo){const a=c=>{let u=new Date(n[c].createDate).getTime(),h=new Date(t?.dateFrom).getTime(),y=new Date(t?.dateTo).getTime();u>=h&&u<=y&&o.push(n[c])};Object.keys(n).map(a)}else o=Zl(n);const i=Array.isArray(o)?o:o||[];return zt("invoices",i),zt("lastUpdated",new Date),i}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoices";throw zt("error",r),console.error("Error fetching invoices:",e),e}finally{zt("loading",!1),on(e=>({...e,fetchAll:!1}))}},fecthInventory:async t=>{},async fetchInvoiceById(t){try{on(n=>({...n,fetchById:!0})),zt("error",null);const e=await ln.getInvoice(t),r=Zl(e);return zt("selectedInvoice",r[0]),r}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice";throw zt("error",r),console.error("Error fetching invoice:",e),e}finally{on(e=>({...e,fetchById:!1}))}},async createInvoice(t){try{on(r=>({...r,create:!0})),zt("error",null);const e={};return zt("invoices",r=>[e,...r]),zt("lastUpdated",new Date),e}catch(e){const r=e instanceof Error?e.message:"Failed to create invoice";throw zt("error",r),console.error("Error creating invoice:",e),e}finally{on(e=>({...e,create:!1}))}},async updateInvoice(t,e){try{on(n=>({...n,update:!0})),zt("error",null);const r={};return zt("invoices",n=>n.map(o=>o.invoice===t?r:o)),Zs.selectedInvoice?.invoice===t&&zt("selectedInvoice",r),zt("lastUpdated",new Date),r}catch(r){const n=r instanceof Error?r.message:"Failed to update invoice";throw zt("error",n),console.error("Error updating invoice:",r),r}finally{on(r=>({...r,update:!1}))}},async deleteInvoice(t){try{return on(e=>({...e,delete:!0})),zt("error",null),zt("invoices",e=>e.filter(r=>r.invoice!==t)),Zs.selectedInvoice?.invoice===t&&zt("selectedInvoice",null),zt("lastUpdated",new Date),!0}catch(e){const r=e instanceof Error?e.message:"Failed to delete invoice";throw zt("error",r),console.error("Error deleting invoice:",e),e}finally{on(e=>({...e,delete:!1}))}},async fetchInvoiceStats(t){try{zt("error",null);const e=new URLSearchParams;t?.store&&t.store!=="all"&&e.append("store",t.store),t?.dateFrom&&e.append("dateFrom",t.dateFrom),t?.dateTo&&e.append("dateTo",t.dateTo);const r=e.toString();return[]}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice statistics";throw zt("error",r),console.error("Error fetching invoice stats:",e),e}},async fetchStores(){try{return zt("error",null),[]}catch(t){const e=t instanceof Error?t.message:"Failed to fetch stores";throw zt("error",e),console.error("Error fetching stores:",t),t}},setSelectedInvoice(t){zt("selectedInvoice",t)},clearError(){zt("error",null)},getFilteredInvoices(t){let e=Zs.invoices;if(t.store&&t.store!=="all"&&(e=e.filter(r=>r.store===t.store)),t.dateFrom){const r=new Date(t.dateFrom).getTime();e=e.filter(n=>n.createDate>=r)}if(t.dateTo){const r=new Date(t.dateTo).setHours(23,59,59,999);e=e.filter(n=>n.createDate<=r)}if(t.status&&t.status!=="all"){const r=t.status==="completed";e=e.filter(n=>n.isCompleted===r)}return e},calculateSummary(t){let e=t.length,r=t.filter(_=>_.isCompleted).length,n=0,o=0,i=0,a=0,c=0,u=0,h=new Set,y=new Set;t?.forEach(_=>{h.add(_?.shipper_consignee?.cid),y.add(_.store),_?.products?.forEach(A=>{const E=Math.abs(A?.qty);n+=E,i+=E*(parseFloat(A?.salePrice)||1)}),_?.reservas?.forEach(A=>{let E=parseInt(A?.qty);isNaN(E)&&(E=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[A.type]||A?.onlyTariff?(E=parseFloat(A.arancel)||parseFloat(A.qty)*parseFloat(A.price),u+=E):(A?.arancel&&(c+=parseFloat(A?.arancel)),o+=E,a+=E*parseFloat(A?.price))})});const b=i+a+u;return{totalInvoices:e,completedInvoices:r,pendingInvoices:e-r,totalProducts:n,totalReservas:o,totalProductAmount:i,totalReservaAmount:a,totalAranceles:c,grandTotal:b,totalOther:u,uniqueCustomers:h.size,uniqueStores:y.size,avgInvoiceValue:e>0?b/e:0}},async refreshData(t){return console.log(" fetchInvoices {queryString}"),this.fetchInvoices(t)}};var PE=z("<div><div>"),SE=z("<div>⚠️ "),wE=z("<div><div><label></label><select><option value=all></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date>"),CE=z("<div><button></button><button>"),_o=z("<div>"),AE=z("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),xE=z("<button>← "),IE=z("<option>"),$E=z("<div><div></div><div></div><div></div><div>"),Em=z("<div><span></span><span> "),EE=z("<div><span></span><span> $"),TE=z("<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td><span></span></td><td><button>");const kE=t=>{const{t:e}=it(),[r,n]=fe(!1),[o,i]=fe("all"),[a,c]=fe(""),[u,h]=fe(""),[y,b]=fe(null),[_,A]=fe("dashboard"),[E,R]=fe([]),[P,k]=fe("overview");Hr(async()=>{try{t.invoices||console.log("fetchInvoices"),await jr.fetchInvoices();try{const Z=await jr.fetchStores();let F=Array.isArray(Z)?Z:Object.keys(Z)||[];console.log(F)}catch{const F=jr.state.invoices||t.invoices,ne=[...new Set(F.map(H=>H.store))];R(ne.sort())}}catch(Z){console.error("Error loading dashboard data:",Z)}}),ze(()=>jr.state.invoices||t.invoices);const K=ze(()=>t.invoices?jr.getFilteredInvoices({store:o(),dateFrom:a(),dateTo:u()}):jr.getFilteredInvoices({store:o(),dateFrom:a(),dateTo:u()})),oe=async()=>{try{t.invoices,n(!0),await jr.refreshData({store:o()!=="all"?o():void 0,dateFrom:a()||void 0,dateTo:u()||void 0}),n(!1)}catch(Z){console.error("Error refreshing data:",Z)}},O=ze(()=>{console.log("summary",r()),r();const Z=K(),F=jr.calculateSummary(Z);let ne=new Map,H=new Map,U=new Map;return Z.forEach(ae=>{ae?.products?.forEach(se=>{const pe=Math.abs(se.qty),de=se.product.label;ne.set(de,(ne.get(de)||0)+pe)}),ae?.reservas?.forEach(se=>{let pe=parseInt(se.qty);isNaN(pe)&&(pe=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[se.type]||se?.onlyTariff?(pe=parseFloat(se.arancel)||parseFloat(se.qty)*parseFloat(se.price),U.set(se.type,(H.get(se.type)||0)+pe)):H.set(se.type,(H.get(se.type)||0)+pe)})}),{...F,productsByCategory:ne,reservasByType:H,othersByType:U}}),M=Z=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Z),N=Z=>new Date(Z).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),g={padding:"2rem"},v={display:"flex",gap:"1rem","align-items":"flex-end","margin-bottom":"2rem","flex-wrap":"wrap",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)"},f={display:"flex","flex-direction":"column",gap:"0.5rem",flex:"1","min-width":"200px"},C={"font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)"},S={padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--background-color)"},x={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(280px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},m={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)"},re={width:"48px",height:"48px","border-radius":"12px",display:"flex","align-items":"center","justify-content":"center","font-size":"1.5rem","margin-bottom":"1rem"},Y={"font-size":"0.875rem",color:"var(--text-secondary)","margin-bottom":"0.5rem"},$={"font-size":"1.75rem","font-weight":"700",color:"var(--text-primary)","margin-bottom":"0.25rem"},V={"font-size":"0.75rem",color:"var(--text-muted)"},Q={width:"100%",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",overflow:"hidden"},L={padding:"1rem","text-align":"left",background:"var(--background-color)","font-weight":"600",color:"var(--text-secondary)","font-size":"0.875rem","border-bottom":"2px solid var(--border-color)"},D={padding:"1rem","border-bottom":"1px solid var(--border-color)"},j={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},ue=Z=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:Z?"var(--primary-color)":"var(--text-muted)","border-bottom":Z?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),W={padding:"0.5rem 1rem",background:"var(--primary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","font-size":"0.875rem",transition:"opacity 0.2s"},ce={padding:"0.75rem 1.5rem",background:"var(--secondary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","margin-bottom":"1rem",display:"flex","align-items":"center",gap:"0.5rem"},T=()=>[{title:e("invoices.totalRevenue"),value:O().grandTotal,icon:"💰",color:"#4CAF50",subtext:`${e("common.of")} ${O().totalInvoices} ${e("common.invoice")} `},{title:e("invoices.totalProducts"),value:O().totalProducts,icon:"📦",color:"#2196F3",subtext:`${M(O().totalProductAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.totalReservations"),value:O().totalReservas,icon:"🎫",color:"#FF9800",subtext:`${M(O().totalReservaAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.aranceles"),value:O().totalAranceles,icon:"🏛️",color:"#9C27B0",subtext:e("invoices.customsFees")},{title:e("invoices.uniqueCustomers"),value:O().uniqueCustomers,icon:"👥",color:"#00BCD4",subtext:e("invoices.activeCustomers"),isNumber:!0},{title:e("invoices.averageInvoice"),value:O().avgInvoiceValue,icon:"📊",color:"#FF5722",subtext:e("invoices.perInvoiceValue")},{title:e("invoices.completed"),value:O().completedInvoices,icon:"✅",color:"#4CAF50",subtext:`${O().pendingInvoices} ${e("invoices.pending")}`,isNumber:!0},{title:e("invoices.storesActive"),value:E().length,icon:"🏪",color:"#795548",subtext:e("invoices.locations"),isNumber:!0}],G=()=>De.getActiveLocations();return Nn(()=>{}),w(Ur,{get title(){return e("invoices.title")},get children(){var Z=_o();return d(Z,g),s(Z,w(Re,{get when(){return _()==="dashboard"},get children(){return[w(Re,{get when(){return!t.invoices&&jr.state.loading},get children(){var F=PE(),ne=F.firstChild;return F.style.setProperty("text-align","center"),F.style.setProperty("padding","2rem"),ne.style.setProperty("font-size","1.25rem"),ne.style.setProperty("margin-bottom","1rem"),s(ne,()=>e("invoices.loadingInvoices")),F}}),w(Re,{get when(){return jr.state.error},get children(){var F=SE();return F.firstChild,F.style.setProperty("padding","1rem"),F.style.setProperty("margin-bottom","1rem"),F.style.setProperty("background","#ffebee"),F.style.setProperty("border","1px solid #ffcdd2"),F.style.setProperty("border-radius","var(--border-radius)"),F.style.setProperty("color","#d32f2f"),s(F,()=>jr.state.error,null),s(F,w(Le,{variant:"outline",size:"sm",onClick:oe,style:{"margin-left":"1rem"},get children(){return e("invoices.refreshData")}}),null),F}}),(()=>{var F=wE(),ne=F.firstChild,H=ne.firstChild,U=H.nextSibling,ae=U.firstChild,se=ne.nextSibling,pe=se.firstChild,de=pe.nextSibling,ye=se.nextSibling,X=ye.firstChild,ee=X.nextSibling;return d(F,v),s(H,()=>e("invoices.storeLocation")),U.addEventListener("change",q=>i(q.currentTarget.value)),s(ae,()=>e("invoices.allStores")),s(U,w(nt,{get each(){return G()},children:q=>(()=>{var he=IE();return s(he,()=>q.name),le(()=>he.value=q.id),he})()}),null),s(pe,()=>e("invoices.fromDate")),de.addEventListener("change",q=>c(q.currentTarget.value)),s(X,()=>e("invoices.toDate")),ee.addEventListener("change",q=>h(q.currentTarget.value)),s(F,w(Le,{variant:"secondary",onClick:()=>{i("all"),c(""),h("")},get children(){return e("invoices.clearFilters")}}),null),s(F,w(Le,{variant:"primary",onClick:oe,get disabled(){return!t.invoices&&jr.state.loading},get children(){return["🔄 ",ge(()=>e("invoices.refreshData"))]}}),null),le(q=>{var he=f,ve=C,B=S,te=f,_e=C,we=S,me=f,be=C,ie=S;return q.e=d(ne,he,q.e),q.t=d(H,ve,q.t),q.a=d(U,B,q.a),q.o=d(se,te,q.o),q.i=d(pe,_e,q.i),q.n=d(de,we,q.n),q.s=d(ye,me,q.s),q.h=d(X,be,q.h),q.r=d(ee,ie,q.r),q},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),le(()=>U.value=o()),le(()=>de.value=a()),le(()=>ee.value=u()),F})(),(()=>{var F=CE(),ne=F.firstChild,H=ne.nextSibling;return d(F,j),ne.$$click=()=>k("overview"),s(ne,()=>e("inventory.overview")),H.$$click=()=>k("invoices"),s(H,()=>e("common.invoices")),le(U=>{var ae=ue(P()==="overview"),se=ue(P()==="invoices");return U.e=d(ne,ae,U.e),U.t=d(H,se,U.t),U},{e:void 0,t:void 0}),F})(),w(Re,{get when(){return P()==="overview"},get children(){return[(()=>{var F=_o();return d(F,x),s(F,w(nt,{get each(){return T()},children:ne=>(()=>{var H=$E(),U=H.firstChild,ae=U.nextSibling,se=ae.nextSibling,pe=se.nextSibling;return d(H,m),s(U,()=>ne?.icon),d(ae,Y),s(ae,()=>ne?.title),d(se,$),s(se,(()=>{var de=ge(()=>!!ne.isNumber);return()=>de()?ne.value:M(ne.value)})()),d(pe,V),s(pe,()=>ne.subtext),le(de=>d(U,{...re,background:`${ne?.color}20`,color:ne?.color},de)),H})()})),F})(),w(Re,{get when(){return O()?.productsByCategory?.size>0},get children(){return w(Ge,{get title(){return e("invoices.topProducts")},get subtitle(){return e("invoices.mostSoldProducts")},get children(){var F=_o();return F.style.setProperty("max-height","300px"),F.style.setProperty("overflow-y","auto"),s(F,()=>Array.from(O().productsByCategory.entries()).sort((ne,H)=>H[1]-ne[1]).slice(0,10).map(([ne,H])=>(()=>{var U=Em(),ae=U.firstChild,se=ae.nextSibling,pe=se.firstChild;return U.style.setProperty("display","flex"),U.style.setProperty("justify-content","space-between"),U.style.setProperty("padding","0.75rem"),U.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ae,ne),se.style.setProperty("font-weight","600"),s(se,H,pe),s(se,()=>e("common.units"),null),U})())),F}})}}),(()=>{var F=_o();return F.style.setProperty("margin","19px"),F})(),w(Re,{get when(){return O()?.reservasByType?.size>0},get children(){return w(Ge,{get title(){return e("invoices.reservationsByType")},get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var F=_o();return F.style.setProperty("max-height","300px"),F.style.setProperty("overflow-y","auto"),s(F,()=>Array.from(O().reservasByType.entries()).sort((ne,H)=>H[1]-ne[1]).map(([ne,H])=>(()=>{var U=Em(),ae=U.firstChild,se=ae.nextSibling,pe=se.firstChild;return U.style.setProperty("display","flex"),U.style.setProperty("justify-content","space-between"),U.style.setProperty("padding","0.75rem"),U.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ae,ne),se.style.setProperty("font-weight","600"),s(se,H,pe),s(se,()=>e("common.lbs"),null),U})())),F}})}}),(()=>{var F=_o();return F.style.setProperty("margin","19px"),F})(),w(Re,{get when(){return O()?.othersByType?.size>0},get children(){return w(Ge,{title:"Aranceles y otros servicios",get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var F=_o();return F.style.setProperty("max-height","300px"),F.style.setProperty("overflow-y","auto"),s(F,()=>Array.from(O().othersByType.entries()).sort((ne,H)=>H[1]-ne[1]).map(([ne,H])=>(()=>{var U=EE(),ae=U.firstChild,se=ae.nextSibling,pe=se.firstChild;return U.style.setProperty("display","flex"),U.style.setProperty("justify-content","space-between"),U.style.setProperty("padding","0.75rem"),U.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ae,ne),se.style.setProperty("font-weight","600"),s(se,H,pe),U})())),F}})}})]}})]}}),null),s(Z,w(Re,{get when(){return P()==="invoices"},get children(){return[w(Re,{get when(){return _()!=="detail"},get children(){return w(Ge,{get title(){return e("invoices.recentInvoices")},get subtitle(){return e("invoices.showingInvoices",{count:K().length})},style:{"margin-top":"1.5rem"},get children(){var F=AE(),ne=F.firstChild,H=ne.firstChild,U=H.firstChild,ae=U.firstChild,se=ae.nextSibling,pe=se.nextSibling,de=pe.nextSibling,ye=de.nextSibling,X=ye.nextSibling,ee=X.nextSibling,q=ee.nextSibling,he=q.nextSibling,ve=H.nextSibling;return F.style.setProperty("overflow-x","auto"),d(ne,Q),s(ae,()=>e("invoices.invoiceNumber")),s(se,()=>e("invoices.date")),s(pe,()=>e("invoices.customer")),s(de,()=>e("invoices.store")),s(ye,()=>e("invoices.products")),s(X,()=>e("invoices.reservations")),s(ee,()=>e("invoices.total")),s(q,()=>e("invoices.status")),s(he,()=>e("invoices.actions")),s(ve,w(nt,{get each(){return K().slice(0,50)},children:B=>{const te=()=>{console.log(B);let _e=0,we=0,me=0,be=0;B?.products?.forEach(ie=>{const Pe=Math.abs(ie?.qty),Te=parseFloat(ie?.salePrice)||1;_e+=Pe*Te}),B?.reservas?.forEach(ie=>{let Pe=parseInt(ie?.qty);return isNaN(Pe)&&(Pe=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[ie.type]||ie?.onlyTariff?(Pe=parseFloat(ie.arancel)||parseFloat(ie.qty)*parseFloat(ie.price),be+=Pe):(ie?.arancel&&(me+=parseFloat(ie?.arancel)),we+=Pe*parseFloat(ie?.price)),{total:_e+we+me+be,totalProductAmount:_e,totalReservaAmount:we,totalAranceles:me,totalOther:be}})};return(()=>{var _e=TE(),we=_e.firstChild,me=we.nextSibling,be=me.nextSibling,ie=be.nextSibling,Pe=ie.nextSibling,Te=Pe.nextSibling,$e=Te.nextSibling,Ee=$e.nextSibling,Ve=Ee.firstChild,Ke=Ee.nextSibling,je=Ke.firstChild;return s(we,()=>B?.invoice),s(me,()=>N(B?.createDate)),s(be,()=>B?.shipper_consignee?.name),s(ie,()=>B?.store),s(Pe,()=>te()?.totalProductAmount),s(Te,()=>te()?.totalReservaAmount),s($e,()=>M(te()?.total)),Ve.style.setProperty("padding","0.25rem 0.75rem"),Ve.style.setProperty("border-radius","9999px"),Ve.style.setProperty("font-size","0.75rem"),Ve.style.setProperty("font-weight","600"),s(Ve,(()=>{var Ce=ge(()=>!!B.isCompleted);return()=>Ce()?e("invoices.completed"):e("invoices.pending")})()),je.addEventListener("mouseleave",Ce=>Ce.currentTarget.style.opacity="1"),je.addEventListener("mouseenter",Ce=>Ce.currentTarget.style.opacity="0.8"),je.$$click=()=>{b(B),A("detail")},d(je,W),s(je,()=>e("invoices.view")),le(Ce=>{var Be=D,Je=D,Qe=D,We=D,xe=D,at=D,et={...D,"text-align":"right","font-weight":"600"},bt=D,ht=B.isCompleted?"#d4edda":"#fff3cd",Nt=B.isCompleted?"#155724":"#856404",jt=D;return Ce.e=d(we,Be,Ce.e),Ce.t=d(me,Je,Ce.t),Ce.a=d(be,Qe,Ce.a),Ce.o=d(ie,We,Ce.o),Ce.i=d(Pe,xe,Ce.i),Ce.n=d(Te,at,Ce.n),Ce.s=d($e,et,Ce.s),Ce.h=d(Ee,bt,Ce.h),ht!==Ce.r&&((Ce.r=ht)!=null?Ve.style.setProperty("background",ht):Ve.style.removeProperty("background")),Nt!==Ce.d&&((Ce.d=Nt)!=null?Ve.style.setProperty("color",Nt):Ve.style.removeProperty("color")),Ce.l=d(Ke,jt,Ce.l),Ce},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),_e})()}})),le(B=>{var te=L,_e=L,we=L,me=L,be=L,ie=L,Pe={...L,"text-align":"right"},Te=L,$e=L;return B.e=d(ae,te,B.e),B.t=d(se,_e,B.t),B.a=d(pe,we,B.a),B.o=d(de,me,B.o),B.i=d(ye,be,B.i),B.n=d(X,ie,B.n),B.s=d(ee,Pe,B.s),B.h=d(q,Te,B.h),B.r=d(he,$e,B.r),B},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),F}})}}),w(Re,{get when(){return ge(()=>_()==="detail")()&&y()},get children(){return[(()=>{var F=xE();return F.firstChild,F.$$click=()=>{A("dashboard"),b(null)},d(F,ce),s(F,()=>e("invoices.backToDashboard"),null),F})(),w(bE,{get invoice(){return y()},onPrint:()=>window.print()})]}})]}}),null),Z}})};ft(["click"]);const RE=()=>w(kE,{invoices:[{type:"SALES",invoice:"20255FK6S4B43SSS",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCim",ssg_sorder_key:"JqdrRwGBpdBfRCim",createDate:1736132690425,shipper_consignee:{name:"Yudith Perez Medero",phoneNumberS:"5022408378",dob:"1982-07-23",firstName:"RAUL",lastName:"BATISTA",lastName2:"ESPOSITO",middleName:"",email:"",phoneNumber:"52393232",altPhoneNumber:"",cid:"48121007305",ybstreetNo:"9",ybstreet:"10",ybbetwen1:"CARRALERO",ybbetwen2:"3RA",ybapt:"",ybreparto:"PUEBLO NUEVO",consigneeId:"26144",ssg_consignee_key:"26144",passport:"NA",nacionality:"CUB",ybcity:"HOLGUIN",ybestate:"HOLGUIN",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534800",reservas:[{type:"UTILES DEL HOGAR",qty:"15",arancel:"10",price:"5",key:"1GB16SD80"},{type:"MISCELANEAS",qty:"19",arancel:"",price:"4",key:"0DS6K14Y2"}],products:[{product:{id:"CmrhMfVjLR9HxT6P",label:"FOGONES ELECTRICO DOBLE RESISTENCIA DE ALAMBRE",code:"978Y82K94"},qty:-1,price:23.696296296296296,salePrice:"34"},{product:{id:"ov56aPYGbXIq4XGy",label:"Caramelos",code:"C852CSKB5"},qty:-2,price:5.990000000000001,salePrice:"10"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43TTT",description:"",store:"YY_8803",ssg_inventory_key:"JqdrRwGBpdBfRCin",ssg_sorder_key:"JqdrRwGBpdBfRCin",createDate:1736032690425,shipper_consignee:{name:"Maria Rodriguez Santos",phoneNumberS:"5024567890",dob:"1990-03-15",firstName:"MARIA",lastName:"RODRIGUEZ",lastName2:"SANTOS",middleName:"ELENA",email:"maria@email.com",phoneNumber:"52987654",altPhoneNumber:"",cid:"90031507890",ybstreetNo:"15",ybstreet:"23",ybbetwen1:"MARTI",ybbetwen2:"CESPEDES",ybapt:"2A",ybreparto:"CENTRO",consigneeId:"26145",ssg_consignee_key:"26145",passport:"A1234567",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534801",reservas:[{type:"ELECTRONICOS",qty:"5",arancel:"15",price:"12",key:"2GB16SD81"},{type:"ROPA Y CALZADO",qty:"8",arancel:"8",price:"7",key:"0DS6K14Y3"}],products:[{product:{id:"XmrhMfVjLR9HxT6Q",label:"TELEVISOR LED 32 PULGADAS",code:"TV32LED01"},qty:-1,price:150.5,salePrice:"220"},{product:{id:"Yv56aPYGbXIq4XGz",label:"Zapatos Deportivos Nike",code:"ZAP001"},qty:-1,price:45.99,salePrice:"75"}],isCompleted:!1},{type:"SALES",invoice:"20255FK6S4B43UUU",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCio",ssg_sorder_key:"JqdrRwGBpdBfRCio",createDate:1735932690425,shipper_consignee:{name:"Carlos Mendez Perez",phoneNumberS:"5025678901",dob:"1975-12-08",firstName:"CARLOS",lastName:"MENDEZ",lastName2:"PEREZ",middleName:"ANTONIO",email:"",phoneNumber:"52876543",altPhoneNumber:"",cid:"75120878901",ybstreetNo:"7",ybstreet:"45",ybbetwen1:"LINEA",ybbetwen2:"PASEO",ybapt:"",ybreparto:"VEDADO",consigneeId:"26146",ssg_consignee_key:"26146",passport:"NA",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534802",reservas:[{type:"ALIMENTOS",qty:"25",arancel:"5",price:"3",key:"3GB16SD82"}],products:[{product:{id:"ZmrhMfVjLR9HxT6R",label:"ARROZ ESPECIAL 5LB",code:"ARZ005"},qty:-5,price:2.5,salePrice:"4"},{product:{id:"Av56aPYGbXIq4XG1",label:"ACEITE DE COCINA 1L",code:"ACE001"},qty:-3,price:3.75,salePrice:"6"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43VVV",description:"",store:"YY_8802",ssg_inventory_key:"JqdrRwGBpdBfRCip",ssg_sorder_key:"JqdrRwGBpdBfRCip",createDate:1735832690425,shipper_consignee:{name:"Ana Lucia Fernandez",phoneNumberS:"5026789012",dob:"1988-06-20",firstName:"ANA",lastName:"FERNANDEZ",lastName2:"LOPEZ",middleName:"LUCIA",email:"ana.lucia@email.com",phoneNumber:"52765432",altPhoneNumber:"52111222",cid:"88062076789",ybstreetNo:"12",ybstreet:"18",ybbetwen1:"CALZADA",ybbetwen2:"SAN LAZARO",ybapt:"3B",ybreparto:"CENTRO HABANA",consigneeId:"26147",ssg_consignee_key:"26147",passport:"B9876543",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:"Entrega en horario de oficina"},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534803",reservas:[{type:"MEDICINA Y SALUD",qty:"10",arancel:"12",price:"8",key:"4GB16SD83"},{type:"UTILES DEL HOGAR",qty:"6",arancel:"6",price:"4",key:"5GB16SD84"}],products:[{product:{id:"BmrhMfVjLR9HxT6S",label:"VITAMINAS MULTIPLES 60 CAP",code:"VIT001"},qty:-2,price:12.5,salePrice:"18"}],isCompleted:!0}]});var DE=z("<div><main>");const NE=t=>[w(iC,{}),ge(()=>t.children)],LE=()=>w(Lw,{get children(){var t=DE(),e=t.firstChild;return s(e,w(ov,{root:NE,get children(){return[w(Kr,{path:"/",component:rE}),w(Kr,{path:"/accounts",component:()=>w(rn,{permission:"AccountAccess",featureName:"Accounts",get children(){return w(oA,{})}})}),w(Kr,{path:"/accounts/:id",component:()=>w(rn,{permission:"AccountAccess",featureName:"Account Details",get children(){return w(uA,{})}})}),w(Kr,{path:"/entry-books",component:()=>w(rn,{permission:"JournalAccess",featureName:"Entry Books",get children(){return w(K2,{})}})}),w(Kr,{path:"/employees",component:()=>w(rn,{permission:"EmployeeAccess",featureName:"Employee Management",get children(){return w(u$,{})}})}),w(Kr,{path:"/bank-consolidations",component:()=>w(rn,{permission:"BankingAccess",featureName:"Bank Consolidations",get children(){return w(F$,{})}})}),w(Kr,{path:"/balance-sheet",component:()=>w(rn,{permission:"AccountAccess",featureName:"Balance Sheet",get children(){return w(gA,{})}})}),w(Kr,{path:"/invoices",component:()=>w(rn,{permission:"invoiceAccess",featureName:"Invoices",get children(){return w(RE,{})}})}),w(Kr,{path:"/inventory",component:()=>w(rn,{permission:"InventoryAccess",featureName:"Inventory Management",get children(){return w(r$,{})}})}),w(Kr,{path:"/products",component:()=>w(rn,{permission:"InventoryAccess",featureName:"Product Management",get children(){return w(Nf,{})}})}),w(Kr,{path:"/admin/users",component:()=>w(rn,{permission:"isAdmin",featureName:"User Administration",get children(){return w(mE,{})}})})]}})),s(t,(()=>{var r=ge(()=>!1);return()=>r()&&w(gC,{})})(),null),t}}),ME=document.getElementById("root");bg(()=>w(LE,{}),ME);export{Zo as _};
