import{c as u,A as Xe,a as t,t as v,i as r,S as g,b as se,V as Ne,I as G,x as Re,v as ze,B as z,ac as Ye,ad as Ze,d as Fe,ae as et,E as tt,o as rt,af as st,g as ae,F as lt,j as it,r as xe,ag as ot,ah as nt,ai as ge,aj as at,ak as dt,al as yt,am as pt,an as ct,L as gt}from"./index-YmMNRf0g.js";var mt=v("<div><h4>Firma a Exportar:</h4><img alt=Signature>"),ut=v("<div><p>Cargando aplicaciones de pasaporte..."),Pt=v("<div><strong>‚ö† Error:</strong> "),ht=v("<div><strong>‚úì √âxito:</strong> Firma exportada exitosamente a la aplicaci√≥n de pasaporte"),vt=v("<div><div>Se muestran aplicaciones sin firma o que coinciden con el nombre del cliente"),bt=v("<div><p>No se encontraron aplicaciones de pasaporte compatibles.</p><p>Busque aplicaciones sin firma o que coincidan con el nombre del cliente: <strong>"),ft=v("<div><div><div><h2>üìã Exportar Firma a Aplicaci√≥n de Pasaporte</h2><button>‚úï</button></div><div><div><h3>Solicitud de Firma</h3><p><strong>Cliente:</strong> </p><p><strong>ID:</strong> </p><p><strong>Firmado:</strong> </p></div></div><div>");const xt=n=>{const[K,R]=u([]),[I,D]=u(""),[L,le]=u(!1),[ee,te]=u(!1),[j,A]=u(""),[P,Q]=u(!1),C=new Ze,q=async()=>{if(n.isOpen){te(!0),A("");try{console.log("loadPassportApplications");const y=await C.getPassportApplications(n.signatureRequest.clientName);console.log(y);const N=y.filter(w=>{const $=!w.applicationData.firmaBase64&&!w.applicationData.firmaUrl,U=w.applicationData.primerNombre?.toLowerCase().includes(n.signatureRequest.clientName.toLowerCase())||w.applicationData.primerApellido?.toLowerCase().includes(n.signatureRequest.clientName.toLowerCase())||n.signatureRequest.clientName.toLowerCase().includes(w.applicationData.primerNombre?.toLowerCase()||"")||n.signatureRequest.clientName.toLowerCase().includes(w.applicationData.primerApellido?.toLowerCase()||"");return $||U});R(N)}catch(y){console.error("Error loading passport applications:",y),A(y instanceof Error?y.message:"Error loading passport applications")}finally{te(!1)}}},X=async()=>{if(!I()||!n.signatureRequest.signatureUrl){A("Please select a passport application");return}le(!0),A("");try{let y=K().filter(w=>w.id===I())?.[0],N={signatureBase64:n.signatureRequest.signatureUrl,signatureRequestId:n.signatureRequest.id,...y.applicationData};await Ye(I(),N),Q(!0),setTimeout(()=>{Q(!1),n.onClose()},2e3)}catch(y){console.error("Error exporting signature:",y),A(y instanceof Error?y.message:"Error exporting signature")}finally{le(!1)}},J=()=>{n.isOpen&&(q(),D(""),A(""),Q(!1))},T=()=>{D(""),A(""),Q(!1),n.onClose()};return Xe(()=>{n.isOpen&&J()}),t(g,{get when(){return n.isOpen},get children(){var y=ft(),N=y.firstChild,w=N.firstChild,$=w.firstChild,U=$.nextSibling,M=w.nextSibling,V=M.firstChild,k=V.firstChild,B=k.nextSibling,de=B.firstChild;de.nextSibling;var O=B.nextSibling,F=O.firstChild;F.nextSibling;var W=O.nextSibling,ie=W.firstChild;ie.nextSibling;var H=M.nextSibling;return y.style.setProperty("position","fixed"),y.style.setProperty("top","0"),y.style.setProperty("left","0"),y.style.setProperty("right","0"),y.style.setProperty("bottom","0"),y.style.setProperty("background","rgba(0, 0, 0, 0.5)"),y.style.setProperty("display","flex"),y.style.setProperty("align-items","center"),y.style.setProperty("justify-content","center"),y.style.setProperty("z-index","1000"),N.style.setProperty("background","#ffffff"),N.style.setProperty("border-radius","var(--border-radius)"),N.style.setProperty("box-shadow","0 4px 20px rgba(0, 0, 0, 0.2)"),N.style.setProperty("max-width","600px"),N.style.setProperty("width","90%"),N.style.setProperty("max-height","80vh"),N.style.setProperty("overflow","auto"),w.style.setProperty("padding","1.5rem"),w.style.setProperty("border-bottom","1px solid var(--border-color)"),w.style.setProperty("display","flex"),w.style.setProperty("justify-content","space-between"),w.style.setProperty("align-items","center"),$.style.setProperty("margin","0"),$.style.setProperty("font-size","1.25rem"),$.style.setProperty("color","var(--text-primary)"),U.$$click=T,U.style.setProperty("background","none"),U.style.setProperty("border","none"),U.style.setProperty("font-size","1.5rem"),U.style.setProperty("cursor","pointer"),U.style.setProperty("color","var(--text-muted)"),M.style.setProperty("padding","1.5rem"),V.style.setProperty("padding","1rem"),V.style.setProperty("background","var(--info-light)"),V.style.setProperty("border-radius","var(--border-radius-sm)"),V.style.setProperty("margin-bottom","1.5rem"),V.style.setProperty("border","1px solid var(--info-color)"),k.style.setProperty("margin","0 0 0.5rem 0"),k.style.setProperty("font-size","1rem"),k.style.setProperty("color","var(--info-dark)"),B.style.setProperty("margin","0.25rem 0"),B.style.setProperty("font-size","0.875rem"),r(B,()=>n.signatureRequest.clientName,null),O.style.setProperty("margin","0.25rem 0"),O.style.setProperty("font-size","0.875rem"),r(O,()=>n.signatureRequest.id,null),W.style.setProperty("margin","0.25rem 0"),W.style.setProperty("font-size","0.875rem"),r(W,()=>n.signatureRequest.signedAt?.toDate().toLocaleDateString(),null),r(M,t(g,{get when(){return n.signatureRequest.signatureUrl},get children(){var o=mt(),f=o.firstChild,_=f.nextSibling;return o.style.setProperty("text-align","center"),o.style.setProperty("margin-bottom","1.5rem"),f.style.setProperty("margin","0 0 0.5rem 0"),f.style.setProperty("font-size","0.875rem"),f.style.setProperty("color","var(--text-muted)"),_.style.setProperty("max-width","300px"),_.style.setProperty("max-height","100px"),_.style.setProperty("border","1px solid var(--border-color)"),_.style.setProperty("border-radius","var(--border-radius-sm)"),_.style.setProperty("background","white"),_.style.setProperty("padding","0.5rem"),se(()=>Ne(_,"src",n.signatureRequest.signatureUrl)),o}}),null),r(M,t(g,{get when(){return ee()},get children(){var o=ut(),f=o.firstChild;return o.style.setProperty("text-align","center"),o.style.setProperty("padding","2rem"),o.style.setProperty("color","var(--text-muted)"),r(o,t(G,{name:"loading",size:"2rem"}),f),o}}),null),r(M,t(g,{get when(){return j()},get children(){var o=Pt(),f=o.firstChild;return f.nextSibling,o.style.setProperty("padding","1rem"),o.style.setProperty("background","var(--error-light)"),o.style.setProperty("color","var(--error-dark)"),o.style.setProperty("border-radius","var(--border-radius-sm)"),o.style.setProperty("margin-bottom","1rem"),o.style.setProperty("border","1px solid var(--error-color)"),r(o,j,null),o}}),null),r(M,t(g,{get when(){return P()},get children(){var o=ht();return o.style.setProperty("padding","1rem"),o.style.setProperty("background","var(--success-light)"),o.style.setProperty("color","var(--success-dark)"),o.style.setProperty("border-radius","var(--border-radius-sm)"),o.style.setProperty("margin-bottom","1rem"),o.style.setProperty("border","1px solid var(--success-color)"),o}}),null),r(M,t(g,{get when(){return ze(()=>!ee())()&&K().length>0},get children(){var o=vt(),f=o.firstChild;return r(o,t(Re,{label:"Seleccionar Aplicaci√≥n de Pasaporte",get value(){return I()},onChange:D,get options(){return[{value:"",label:"-- Seleccione una aplicaci√≥n --"},...K().map(_=>({value:_.id,label:`${_.applicationData.primerNombre} ${_.applicationData.primerApellido} (${_.applicationNumber}) - ${_.status}`}))]},required:!0}),f),f.style.setProperty("margin-top","0.5rem"),f.style.setProperty("font-size","0.75rem"),f.style.setProperty("color","var(--text-muted)"),o}}),null),r(M,I,null),r(M,t(g,{get when(){return ze(()=>!ee())()&&K().length===0},get children(){var o=bt(),f=o.firstChild,_=f.nextSibling,pe=_.firstChild,ue=pe.nextSibling;return o.style.setProperty("padding","2rem"),o.style.setProperty("text-align","center"),o.style.setProperty("color","var(--text-muted)"),r(o,t(G,{name:"search",size:"3rem",style:{"margin-bottom":"1rem"}}),f),_.style.setProperty("font-size","0.875rem"),r(ue,()=>n.signatureRequest.clientName),o}}),null),H.style.setProperty("padding","1rem 1.5rem"),H.style.setProperty("border-top","1px solid var(--border-color)"),H.style.setProperty("display","flex"),H.style.setProperty("gap","0.75rem"),H.style.setProperty("justify-content","flex-end"),r(H,t(z,{variant:"outline",onClick:T,get disabled(){return L()},children:"Cancelar"}),null),r(H,t(z,{variant:"primary",onClick:X,get disabled(){return!I()||L()||P()},get children(){return t(g,{get when(){return L()},fallback:"üìã Exportar Firma",children:"Exportando..."})}}),null),y}})};Fe(["click"]);var me=v("<div>"),$t=v('<div><div><div><label>Tienda/Ubicaci√≥n *</label><select required><option value>Seleccionar tienda...</option></select></div><div><label>D√≠as hasta expiraci√≥n *</label><select><option value=1>1 d√≠a</option><option value=3>3 d√≠as</option><option value=7>7 d√≠as</option><option value=14>14 d√≠as</option><option value=30>30 d√≠as</option></select></div><div><label>Notas</label><textarea placeholder="Notas adicionales para el cliente..."rows=3></textarea></div></div><div>'),_t=v("<option>"),St=v("<div><div><div>üìã</div><p>Comparta este enlace con <strong></strong></p></div><div></div><div></div><p>El enlace expirar√° el "),wt=v("<div>sending..."),Ct=v("<div><p>Esta solicitud no tiene firma disponible."),kt=v('<div><div><h3></h3><p>Firmado el: </p><div><span>üìÅ </span><span>üóÉÔ∏è Base64 (PNG)</span><span>üö´ No CORS Issues</span></div></div><div><img alt="Firma del cliente"></div><div>'),Et=v("<span>"),zt=v("<div><div><div><p>Env√≠e solicitudes de firma a sus clientes por email o SMS</p></div><div></div></div><div>"),Nt=v("<div><div>‚è≥</div><p>Cargando solicitudes..."),Rt=v("<div><p>No hay solicitudes de firma. Cree una nueva para empezar."),Ft=v("<input type=checkbox>"),At=v("<span> ‚Ä¢ "),Mt=v("<div><strong>Documento:</strong> "),It=v("<div><strong>Tienda:</strong> "),Dt=v("<div><strong>Firmado el:</strong> "),Lt=v("<div><strong>Notas:</strong> "),Tt=v("<div><div><div><div><h4></h4><p></p></div></div></div><div><div><strong>ID:</strong> </div><div><strong>Creado:</strong> </div><div><strong>Expira:</strong> </div></div><div>");const jt=()=>{const n=et(),K=tt(),[R,I]=u([]),[D,L]=u(!1),[le,ee]=u(null),[te,j]=u(!1),[A,P]=u(""),[Q,C]=u(""),[q,X]=u(new Set),[J,T]=u(!1),[y,N]=u(!1),[w,$]=u(!1),[U,M]=u(!1),[V,k]=u(null),[B,de]=u("all"),[O,F]=u(""),[W,ie]=u(""),[H,o]=u(""),[f,_]=u(""),[pe,ue]=u(""),[Pe,$e]=u(""),[ce,_e]=u("7"),[he,Se]=u(""),[Ae,we]=u("");rt(()=>{oe()});const oe=async()=>{L(!0);try{let e=await st();B()!=="all"&&(e=e.filter(i=>i.storeId===B())),console.log(`Loaded signature requests filtered by store ${B()}:`,e),I(e)}catch{P("Error al cargar las solicitudes")}finally{L(!1)}},Me=async()=>{if(console.log("handleCreateRequest called"),console.log("Form values:",{clientId:O(),clientName:W(),clientEmail:H(),clientPhone:f(),documentType:pe(),notes:Pe(),expirationDays:ce()}),!O()||!W()||!ce()||!he()){P("Por favor complete todos los campos requeridos (incluyendo la tienda)");return}j(!0),P(""),C("");try{console.log("Creating signature request...");const e=await ct({clientId:O(),clientName:W(),clientEmail:H(),clientPhone:f(),documentType:pe(),notes:Pe(),storeId:he(),businessId:ae.getBusinessId(),storeName:Ae()},parseInt(ce()));console.log("Request created successfully:",e),C("Solicitud creada exitosamente"),n.hideModal(),ve(),await oe(),Ce(e)}catch(e){console.error("Error creating request:",e),P(e.message||"Error al crear la solicitud")}finally{j(!1)}},Ie=async e=>{if(confirm("¬øEst√° seguro de cancelar esta solicitud?"))try{await dt(e),await oe(),C("Solicitud cancelada")}catch(i){P(i.message||"Error al cancelar la solicitud")}},De=async e=>{if(confirm("¬øEst√° seguro de ELIMINAR permanentemente esta solicitud? Esta acci√≥n no se puede deshacer."))try{await pt(e),await oe(),C("Solicitud eliminada permanentemente"),setTimeout(()=>C(""),3e3)}catch(i){P(i.message||"Error al eliminar la solicitud"),setTimeout(()=>P(""),5e3)}},ve=()=>{F(""),ie(""),o(""),_(""),ue(""),$e(""),_e("7"),Se(""),we("")},Le=e=>{k(e),M(!0),n.hideModal()},Te=()=>{M(!1),k(null)},be=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),je=()=>{n.showModal({title:"Nueva Solicitud de Firma",children:(()=>{var e=$t(),i=e.firstChild,p=i.firstChild,d=p.firstChild,c=d.nextSibling;c.firstChild;var b=p.nextSibling,s=b.firstChild,l=s.nextSibling,E=b.nextSibling,m=E.firstChild,x=m.nextSibling,S=i.nextSibling;return e.style.setProperty("padding","1.5rem"),r(e,t(g,{get when(){return A()},get children(){var h=me();return h.style.setProperty("padding","1rem"),h.style.setProperty("margin-bottom","1rem"),h.style.setProperty("background","var(--error-light)"),h.style.setProperty("color","var(--error-dark)"),h.style.setProperty("border-radius","var(--border-radius-sm)"),r(h,A),h}}),i),i.style.setProperty("display","grid"),i.style.setProperty("gap","1rem"),d.style.setProperty("display","block"),d.style.setProperty("margin-bottom","0.5rem"),d.style.setProperty("font-weight","500"),d.style.setProperty("color","var(--text-primary)"),c.addEventListener("change",h=>{const Y=h.target.value;Se(Y);const Z=ae.allowedStores.find(ye=>ye.id===Y);we(Z?.name||"")}),c.style.setProperty("width","100%"),c.style.setProperty("padding","0.75rem"),c.style.setProperty("border","1px solid var(--border-color)"),c.style.setProperty("border-radius","var(--border-radius-sm)"),c.style.setProperty("background","white"),r(c,()=>ae.allowedStores.map(h=>(()=>{var Y=_t();return r(Y,()=>h.name),se(()=>Y.value=h.id),Y})()),null),r(i,t(xe,{label:"Pasaporte",get value(){return O()},onChange:F,placeholder:"CLI-001",required:!0}),b),r(i,t(xe,{label:"Nombre del Cliente",get value(){return W()},onChange:ie,placeholder:"Juan P√©rez",required:!0}),b),r(i,t(xe,{label:"Tel√©fono del Cliente",get value(){return f()},onChange:_,placeholder:"+1 234 567 8900"}),b),s.style.setProperty("display","block"),s.style.setProperty("margin-bottom","0.5rem"),s.style.setProperty("font-weight","500"),s.style.setProperty("color","var(--text-primary)"),l.addEventListener("change",h=>_e(h.target.value)),l.style.setProperty("width","100%"),l.style.setProperty("padding","0.75rem"),l.style.setProperty("border","1px solid var(--border-color)"),l.style.setProperty("border-radius","var(--border-radius-sm)"),l.style.setProperty("background","white"),m.style.setProperty("display","block"),m.style.setProperty("margin-bottom","0.5rem"),m.style.setProperty("font-weight","500"),m.style.setProperty("color","var(--text-primary)"),x.$$input=h=>$e(h.target.value),x.style.setProperty("width","100%"),x.style.setProperty("padding","0.75rem"),x.style.setProperty("border","1px solid var(--border-color)"),x.style.setProperty("border-radius","var(--border-radius-sm)"),x.style.setProperty("resize","vertical"),x.style.setProperty("font-family","inherit"),S.style.setProperty("display","flex"),S.style.setProperty("gap","1rem"),S.style.setProperty("margin-top","2rem"),S.style.setProperty("justify-content","flex-end"),r(S,t(z,{variant:"outline",onClick:()=>{n.hideModal(),ve(),P("")},children:"Cancelar"}),null),r(S,t(z,{variant:"primary",onClick:Me,get disabled(){return te()},get children(){return t(g,{get when(){return te()},fallback:"Crear Solicitud",children:"Creando..."})}}),null),se(()=>c.value=he()),se(()=>l.value=ce()),se(()=>x.value=Pe()),e})(),onClose:()=>{ve(),P("")}})},Ce=e=>{n.showModal({title:"Enlace de Firma Generado",children:(()=>{var i=St(),p=i.firstChild,d=p.firstChild,c=d.nextSibling,b=c.firstChild,s=b.nextSibling,l=p.nextSibling,E=l.nextSibling,m=E.nextSibling;return m.firstChild,i.style.setProperty("padding","1.5rem"),p.style.setProperty("text-align","center"),p.style.setProperty("margin-bottom","2rem"),d.style.setProperty("font-size","4rem"),d.style.setProperty("margin-bottom","1rem"),c.style.setProperty("color","var(--text-muted)"),r(s,()=>e.clientName),l.style.setProperty("padding","1rem"),l.style.setProperty("background","var(--background-secondary)"),l.style.setProperty("border-radius","var(--border-radius-sm)"),l.style.setProperty("word-break","break-all"),l.style.setProperty("font-family","monospace"),l.style.setProperty("font-size","0.875rem"),l.style.setProperty("text-align","center"),l.style.setProperty("margin-bottom","1rem"),r(l,()=>ge(e?.accessToken||"",e.id)),E.style.setProperty("display","grid"),E.style.setProperty("gap","0.75rem"),r(E,t(z,{variant:"primary",onClick:()=>{Ue(e.id,e?.accessToken||"")},style:{width:"100%"},get children(){return[t(G,{name:"copy",size:"1rem",style:{"margin-right":"0.5rem"}}),"Copiar Enlace"]}}),null),r(E,t(z,{variant:"secondary",onClick:()=>{const S=`Por favor firme el documento usando este enlace: ${ge(e?.accessToken||"",e.id)}`;window.open(`mailto:${e.clientEmail}?subject=Solicitud de Firma&body=${encodeURIComponent(S)}`)},style:{width:"100%"},get children(){return[t(G,{name:"email",size:"1rem",style:{"margin-right":"0.5rem"}}),"Enviar por Email"]}}),null),r(E,t(g,{get when(){return e.clientPhone},get children(){return t(z,{variant:"secondary",onClick:async()=>{$(!0);const S=`Por favor firme el documento: 
${ge(e?.accessToken||"",e.id)}`;let h=await at(e.clientPhone,S);console.log(h),$(!1)},style:{width:"100%"},get children(){return t(g,{get when(){return!w()},get fallback(){return wt()},get children(){return[t(G,{name:"whatsapp",size:"1rem",style:{"margin-right":"0.5rem"}}),"Enviar por WhatsApp"]}})}})}}),null),m.style.setProperty("margin-top","1rem"),m.style.setProperty("font-size","0.8rem"),m.style.setProperty("color","var(--text-muted)"),m.style.setProperty("text-align","center"),r(m,()=>e.expiresAt,null),i})()})},Ue=(e,i)=>{const p=ge(i,e);navigator.clipboard.writeText(p),C("Enlace copiado al portapapeles"),setTimeout(()=>C(""),3e3)},Be=e=>{if(!e.signatureUrl)return;const i={imageData:e.signatureUrl,clientName:e.clientName,requestId:e.id,signedAt:e.signedAt};sessionStorage.setItem("pendingSignature",JSON.stringify(i)),n.hideModal(),K("/pdf-signature")},Oe=e=>{if(!e.signatureUrl){n.showModal({title:"Error",children:(()=>{var p=Ct();return p.style.setProperty("padding","1.5rem"),p.style.setProperty("text-align","center"),p})()});return}const i=Math.round(e.signatureUrl.length*3/4);n.showModal({title:"Firma del Cliente",children:(()=>{var p=kt(),d=p.firstChild,c=d.firstChild,b=c.nextSibling;b.firstChild;var s=b.nextSibling,l=s.firstChild;l.firstChild;var E=l.nextSibling,m=d.nextSibling,x=m.firstChild,S=m.nextSibling;return p.style.setProperty("padding","1.5rem"),p.style.setProperty("text-align","center"),d.style.setProperty("margin-bottom","1.5rem"),c.style.setProperty("margin-bottom","0.5rem"),r(c,()=>e.clientName),b.style.setProperty("color","var(--text-muted)"),b.style.setProperty("font-size","0.875rem"),r(b,()=>e.signedAt,null),s.style.setProperty("margin-top","0.5rem"),s.style.setProperty("padding","0.5rem"),s.style.setProperty("background","var(--background-secondary)"),s.style.setProperty("border-radius","var(--border-radius-sm)"),s.style.setProperty("font-size","0.75rem"),s.style.setProperty("color","var(--text-muted)"),l.style.setProperty("margin-right","1rem"),r(l,()=>yt(i),null),E.style.setProperty("margin-right","1rem"),m.style.setProperty("border","2px solid var(--border-color)"),m.style.setProperty("border-radius","var(--border-radius)"),m.style.setProperty("padding","1rem"),m.style.setProperty("background","white"),m.style.setProperty("max-width","100%"),m.style.setProperty("overflow","hidden"),x.style.setProperty("max-width","100%"),x.style.setProperty("max-height","400px"),x.style.setProperty("height","auto"),x.style.setProperty("display","block"),x.style.setProperty("margin","0 auto"),S.style.setProperty("margin-top","1.5rem"),S.style.setProperty("display","flex"),S.style.setProperty("gap","1rem"),S.style.setProperty("justify-content","center"),S.style.setProperty("flex-wrap","wrap"),r(S,t(g,{get when(){return ae.state?.profile?.AdminPassportAccess},get children(){return[t(z,{variant:"primary",onClick:()=>Be(e),get children(){return[t(G,{name:"document",size:"1rem",style:{"margin-right":"0.5rem"}}),"Usar en PDF"]}}),t(z,{variant:"secondary",onClick:()=>Le(e),get children(){return[t(G,{name:"card",size:"1rem",style:{"margin-right":"0.5rem"}}),"Exportar a Pasaporte"]}})]}}),null),r(S,t(z,{variant:"outline",onClick:()=>{const h=document.createElement("a");h.download=`firma-${e.clientName}-${e.id}.png`,h.href=e.signatureUrl,h.click()},get children(){return[t(G,{name:"download",size:"1rem",style:{"margin-right":"0.5rem"}}),"Descargar"]}}),null),r(S,t(z,{variant:"outline",onClick:()=>n.hideModal(),children:"Cerrar"}),null),se(()=>Ne(x,"src",e.signatureUrl)),p})()})},Ge=e=>{const i=new Set(q());i.has(e)?i.delete(e):i.add(e),X(i)},qe=()=>{const e=R().filter(i=>i.status==="signed");X(new Set(e.map(i=>i.id)))},ke=()=>{X(new Set)},Je=async()=>{if(q().size===0){P("No hay solicitudes seleccionadas para exportar");return}T(!0),P(""),C("");try{const e=Array.from(q()),i=await ot(e);if(i.success.length>0&&C(`${i.success.length} solicitudes exportadas exitosamente`),i.errors.length>0){const p=i.errors.map(d=>`${d.id}: ${d.error}`).join(", ");P(`Errores en exportaci√≥n: ${p}`)}ke(),await oe()}catch(e){P(e.message||"Error al exportar solicitudes")}finally{T(!1)}},Ve=async()=>{const e=R().filter(i=>i.status==="exported");if(e.length===0){P("No hay solicitudes exportadas para limpiar");return}if(confirm(`¬øEst√° seguro de eliminar ${e.length} solicitudes exportadas de Firestore? Esta acci√≥n no se puede deshacer.`)){T(!0),P(""),C("");try{const i=e.map(d=>d.id),p=await nt(i);if(p.success.length>0&&C(`${p.success.length} solicitudes limpiadas exitosamente`),p.errors.length>0){const d=p.errors.map(c=>`${c.id}: ${c.error}`).join(", ");P(`Errores en limpieza: ${d}`)}await oe()}catch(i){P(i.message||"Error al limpiar solicitudes")}finally{T(!1)}}},We=e=>{const i={pending:{color:"var(--warning-color)",bg:"var(--warning-light)",text:"Pendiente"},signed:{color:"var(--success-color)",bg:"var(--success-light)",text:"Firmado"},expired:{color:"var(--error-color)",bg:"var(--error-light)",text:"Expirado"},cancelled:{color:"var(--text-muted)",bg:"var(--background-secondary)",text:"Cancelado"},exported:{color:"var(--info-color)",bg:"var(--info-light)",text:"Exportado"}},p=i[e]||i.pending;return(()=>{var d=Et();return d.style.setProperty("padding","0.25rem 0.75rem"),d.style.setProperty("border-radius","var(--border-radius-sm)"),d.style.setProperty("font-size","0.8rem"),d.style.setProperty("font-weight","500"),r(d,()=>p.text),se(c=>{var b=p.bg,s=p.color;return b!==c.e&&((c.e=b)!=null?d.style.setProperty("background",b):d.style.removeProperty("background")),s!==c.t&&((c.t=s)!=null?d.style.setProperty("color",s):d.style.removeProperty("color")),c},{e:void 0,t:void 0}),d})()};return[t(it,{title:"Gesti√≥n de Solicitudes de Firma",get children(){var e=zt(),i=e.firstChild,p=i.firstChild,d=p.firstChild,c=p.nextSibling,b=i.nextSibling;return e.style.setProperty("padding","1.5rem"),i.style.setProperty("display","flex"),i.style.setProperty("justify-content","space-between"),i.style.setProperty("align-items","center"),i.style.setProperty("margin-bottom","2rem"),i.style.setProperty("flex-wrap","wrap"),i.style.setProperty("gap","1rem"),d.style.setProperty("color","var(--text-muted)"),d.style.setProperty("font-size","0.875rem"),c.style.setProperty("display","flex"),c.style.setProperty("gap","0.5rem"),c.style.setProperty("flex-wrap","wrap"),r(c,t(z,{variant:"primary",onClick:je,get children(){return[t(G,{name:"add",size:"1rem",style:{"margin-right":"0.5rem"}}),"Nueva Solicitud"]}}),null),r(c,t(g,{get when(){return R().some(s=>s.status==="signed")},get children(){return[t(z,{variant:"secondary",onClick:qe,get disabled(){return J()},children:"Seleccionar Firmadas"}),t(g,{get when(){return q().size>0},get children(){return[t(z,{variant:"success",onClick:Je,get disabled(){return J()},get children(){return t(g,{get when(){return J()},get fallback(){return`Exportar (${q().size})`},children:"Exportando..."})}}),t(z,{variant:"outline",onClick:ke,get disabled(){return J()},children:"Limpiar Selecci√≥n"})]}})]}}),null),r(c,t(g,{get when(){return R().some(s=>s.status==="exported")},get children(){return t(z,{variant:"warning",onClick:Ve,get disabled(){return J()},get children(){return t(g,{get when(){return J()},fallback:"Limpiar Exportadas",children:"Limpiando..."})}})}}),null),b.style.setProperty("margin-bottom","2rem"),b.style.setProperty("padding","1.5rem"),b.style.setProperty("background","var(--bg-secondary)"),b.style.setProperty("border-radius","var(--border-radius)"),b.style.setProperty("border","1px solid var(--border-color)"),r(b,t(Re,{get value(){return B()},onChange:s=>{de(s),oe()},get options(){return[{value:"all",label:"Todas las Tiendas"},...ae.allowedStores.map(s=>({value:s.id,label:s.name,disabled:!s.isActive}))]},style:{"min-width":"250px"},get disabled(){return D()},label:"Filtrar Solicitudes de Firma por Tienda"})),r(e,t(g,{get when(){return A()},get children(){var s=me();return s.style.setProperty("padding","1rem"),s.style.setProperty("margin-bottom","1rem"),s.style.setProperty("background","var(--error-light)"),s.style.setProperty("color","var(--error-dark)"),s.style.setProperty("border-radius","var(--border-radius-sm)"),r(s,A),s}}),null),r(e,t(g,{get when(){return Q()},get children(){var s=me();return s.style.setProperty("padding","1rem"),s.style.setProperty("margin-bottom","1rem"),s.style.setProperty("background","var(--success-light)"),s.style.setProperty("color","var(--success-dark)"),s.style.setProperty("border-radius","var(--border-radius-sm)"),r(s,Q),s}}),null),r(e,t(g,{get when(){return!D()},get fallback(){return(()=>{var s=Nt(),l=s.firstChild;return s.style.setProperty("text-align","center"),s.style.setProperty("padding","2rem"),l.style.setProperty("font-size","1.5rem"),l.style.setProperty("margin-bottom","0.5rem"),s})()},get children(){return t(g,{get when(){return R().length>0},get fallback(){return(()=>{var s=Rt(),l=s.firstChild;return s.style.setProperty("text-align","center"),s.style.setProperty("padding","3rem"),s.style.setProperty("background","var(--background-secondary)"),s.style.setProperty("border-radius","var(--border-radius)"),r(s,t(G,{name:"document",size:"3rem",style:{opacity:"0.3","margin-bottom":"1rem"}}),l),l.style.setProperty("color","var(--text-muted)"),s})()},get children(){var s=me();return s.style.setProperty("display","grid"),s.style.setProperty("gap","1rem"),r(s,t(lt,{get each(){return R()},children:l=>(()=>{var E=Tt(),m=E.firstChild,x=m.firstChild,S=x.firstChild,h=S.firstChild,Y=h.nextSibling,Z=m.nextSibling,ye=Z.firstChild,He=ye.firstChild;He.nextSibling;var fe=ye.nextSibling,Ke=fe.firstChild;Ke.nextSibling;var Ee=fe.nextSibling,Qe=Ee.firstChild;Qe.nextSibling;var re=Z.nextSibling;return E.style.setProperty("padding","1.5rem"),E.style.setProperty("border","1px solid var(--border-color)"),E.style.setProperty("border-radius","var(--border-radius)"),E.style.setProperty("background","var(--surface-color)"),E.style.setProperty("transition","all 0.2s ease"),m.style.setProperty("display","flex"),m.style.setProperty("justify-content","space-between"),m.style.setProperty("align-items","flex-start"),m.style.setProperty("margin-bottom","1rem"),x.style.setProperty("display","flex"),x.style.setProperty("align-items","flex-start"),x.style.setProperty("gap","1rem"),r(x,t(g,{get when(){return l.status==="signed"},get children(){var a=Ft();return a.addEventListener("change",()=>Ge(l.id)),a.style.setProperty("margin-top","0.25rem"),a.style.setProperty("width","1.125rem"),a.style.setProperty("height","1.125rem"),se(()=>a.checked=q().has(l.id)),a}}),S),h.style.setProperty("margin-bottom","0.5rem"),r(h,()=>l.signerName),Y.style.setProperty("font-size","0.875rem"),Y.style.setProperty("color","var(--text-muted)"),r(Y,()=>l.signerEmail,null),r(Y,t(g,{get when(){return l.signerPhone},get children(){var a=At();return a.firstChild,r(a,()=>l.signerPhone,null),a}}),null),r(m,()=>We(l.status),null),Z.style.setProperty("display","grid"),Z.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),Z.style.setProperty("gap","0.75rem"),Z.style.setProperty("font-size","0.8rem"),Z.style.setProperty("color","var(--text-muted)"),r(ye,()=>l?.id,null),r(fe,()=>be(l?.createdAt),null),r(Ee,()=>be(l?.expiresAt),null),r(Z,t(g,{get when(){return l?.documentType},get children(){var a=Mt(),ne=a.firstChild;return ne.nextSibling,r(a,()=>l?.documentType,null),a}}),null),r(Z,t(g,{get when(){return l?.storeName||l?.storeId},get children(){var a=It(),ne=a.firstChild;return ne.nextSibling,r(a,()=>l?.storeName||l?.storeId,null),a}}),null),r(E,t(g,{get when(){return l?.signedAt},get children(){var a=Dt(),ne=a.firstChild;return ne.nextSibling,a.style.setProperty("margin-top","0.75rem"),a.style.setProperty("padding","0.75rem"),a.style.setProperty("background","var(--success-light)"),a.style.setProperty("border-radius","var(--border-radius-sm)"),a.style.setProperty("font-size","0.875rem"),r(a,()=>be(l?.signedAt),null),a}}),re),r(E,t(g,{get when(){return l.notes},get children(){var a=Lt(),ne=a.firstChild;return ne.nextSibling,a.style.setProperty("margin-top","0.75rem"),a.style.setProperty("padding","0.75rem"),a.style.setProperty("background","var(--background-secondary)"),a.style.setProperty("border-radius","var(--border-radius-sm)"),a.style.setProperty("font-size","0.875rem"),r(a,()=>l.notes,null),a}}),re),re.style.setProperty("display","flex"),re.style.setProperty("gap","0.5rem"),re.style.setProperty("margin-top","1rem"),re.style.setProperty("flex-wrap","wrap"),r(re,t(g,{get when(){return l.status==="pending"},get children(){return[t(z,{variant:"secondary",size:"sm",onClick:()=>{Ce(l)},get children(){return[t(G,{name:"copy",size:"0.875rem",style:{"margin-right":"0.25rem"}}),"Copiar Enlace"]}}),t(z,{variant:"outline",size:"sm",onClick:()=>Ie(l.id),children:"Cancelar"})]}}),null),r(re,t(g,{get when(){return l.status==="signed"&&l.signatureUrl},get children(){return t(z,{variant:"primary",size:"sm",onClick:()=>Oe(l),get children(){return[t(G,{name:"signature",size:"0.875rem",style:{"margin-right":"0.25rem"}}),"Ver Firma"]}})}}),null),r(re,t(g,{get when(){return ae.isAdmin()||l.requestedBy===ae.state.user?.uid},get children(){return t(z,{variant:"error",size:"sm",onClick:()=>De(l.id),title:"Eliminar solicitud permanentemente",get children(){return[t(G,{name:"delete",size:"0.875rem",style:{"margin-right":"0.25rem"}}),"Eliminar"]}})}}),null),E})()})),s}})}}),null),e}}),t(g,{get when(){return V()},get children(){return t(xt,{get isOpen(){return U()},onClose:Te,get signatureRequest(){return V()}})}})]};Fe(["input"]);var Ut=v("<div><div><h1>‚úçÔ∏è Firmas Digitales</h1><p>Solicite firmas digitales de sus clientes de forma remota. Env√≠e enlaces por email o SMS para que firmen desde cualquier dispositivo.</p></div><div><div><div>üì±</div><h3>Firma M√≥vil</h3><p>Los clientes pueden firmar desde cualquier dispositivo m√≥vil usando su dedo en la pantalla t√°ctil.</p></div><div><div>üîó</div><h3>Enlaces Seguros</h3><p>Genere enlaces √∫nicos con fecha de expiraci√≥n para asegurar la validez de las solicitudes.</p></div><div><div>‚òÅÔ∏è</div><h3>Almacenamiento Seguro</h3><p>Las firmas se guardan de forma segura en Firebase con acceso controlado y trazabilidad completa.</p></div></div><div><h3>¬øC√≥mo Funciona?</h3><div><div><div>1</div><h4>Crear Solicitud</h4><p>Complete los datos del cliente y cree una nueva solicitud de firma</p></div><div><div>2</div><h4>Enviar Enlace</h4><p>Env√≠e el enlace √∫nico al cliente por email, SMS o cualquier medio</p></div><div><div>3</div><h4>Cliente Firma</h4><p>El cliente abre el enlace y firma usando su dedo o mouse</p></div><div><div>‚úì</div><h4>Firma Guardada</h4><p>La firma se guarda autom√°ticamente y usted recibe notificaci√≥n");const Ot=()=>t(gt,{title:"Gesti√≥n de Firmas Digitales",get children(){var n=Ut(),K=n.firstChild,R=K.firstChild,I=R.nextSibling,D=K.nextSibling,L=D.firstChild,le=L.firstChild,ee=le.nextSibling,te=ee.nextSibling,j=L.nextSibling,A=j.firstChild,P=A.nextSibling,Q=P.nextSibling,C=j.nextSibling,q=C.firstChild,X=q.nextSibling,J=X.nextSibling,T=D.nextSibling,y=T.firstChild,N=y.nextSibling,w=N.firstChild,$=w.firstChild,U=$.nextSibling,M=U.nextSibling,V=w.nextSibling,k=V.firstChild,B=k.nextSibling,de=B.nextSibling,O=V.nextSibling,F=O.firstChild,W=F.nextSibling,ie=W.nextSibling,H=O.nextSibling,o=H.firstChild,f=o.nextSibling,_=f.nextSibling;return n.style.setProperty("max-width","1200px"),n.style.setProperty("margin","0 auto"),n.style.setProperty("padding","2rem 1rem"),K.style.setProperty("text-align","center"),K.style.setProperty("margin-bottom","3rem"),R.style.setProperty("font-size","2.5rem"),R.style.setProperty("font-weight","700"),R.style.setProperty("margin-bottom","1rem"),R.style.setProperty("color","var(--text-primary)"),R.style.setProperty("background","linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%)"),R.style.setProperty("-webkit-background-clip","text"),R.style.setProperty("-webkit-text-fill-color","transparent"),R.style.setProperty("background-clip","text"),I.style.setProperty("font-size","1.125rem"),I.style.setProperty("color","var(--text-muted)"),I.style.setProperty("max-width","600px"),I.style.setProperty("margin","0 auto"),I.style.setProperty("line-height","1.6"),r(n,t(jt,{}),D),D.style.setProperty("margin-top","4rem"),D.style.setProperty("display","grid"),D.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(300px, 1fr))"),D.style.setProperty("gap","2rem"),L.style.setProperty("padding","2rem"),L.style.setProperty("background","white"),L.style.setProperty("border-radius","var(--border-radius)"),L.style.setProperty("box-shadow","var(--shadow-sm)"),L.style.setProperty("text-align","center"),le.style.setProperty("font-size","2.5rem"),le.style.setProperty("margin-bottom","1rem"),ee.style.setProperty("font-size","1.25rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("margin-bottom","0.5rem"),ee.style.setProperty("color","var(--text-primary)"),te.style.setProperty("color","var(--text-muted)"),te.style.setProperty("line-height","1.5"),te.style.setProperty("margin","0"),j.style.setProperty("padding","2rem"),j.style.setProperty("background","white"),j.style.setProperty("border-radius","var(--border-radius)"),j.style.setProperty("box-shadow","var(--shadow-sm)"),j.style.setProperty("text-align","center"),A.style.setProperty("font-size","2.5rem"),A.style.setProperty("margin-bottom","1rem"),P.style.setProperty("font-size","1.25rem"),P.style.setProperty("font-weight","600"),P.style.setProperty("margin-bottom","0.5rem"),P.style.setProperty("color","var(--text-primary)"),Q.style.setProperty("color","var(--text-muted)"),Q.style.setProperty("line-height","1.5"),Q.style.setProperty("margin","0"),C.style.setProperty("padding","2rem"),C.style.setProperty("background","white"),C.style.setProperty("border-radius","var(--border-radius)"),C.style.setProperty("box-shadow","var(--shadow-sm)"),C.style.setProperty("text-align","center"),q.style.setProperty("font-size","2.5rem"),q.style.setProperty("margin-bottom","1rem"),X.style.setProperty("font-size","1.25rem"),X.style.setProperty("font-weight","600"),X.style.setProperty("margin-bottom","0.5rem"),X.style.setProperty("color","var(--text-primary)"),J.style.setProperty("color","var(--text-muted)"),J.style.setProperty("line-height","1.5"),J.style.setProperty("margin","0"),T.style.setProperty("margin-top","4rem"),T.style.setProperty("padding","3rem 2rem"),T.style.setProperty("background","linear-gradient(135deg, var(--primary-color)10, var(--secondary-color)10)"),T.style.setProperty("border-radius","var(--border-radius)"),T.style.setProperty("text-align","center"),y.style.setProperty("font-size","2rem"),y.style.setProperty("font-weight","600"),y.style.setProperty("margin-bottom","2rem"),y.style.setProperty("color","var(--text-primary)"),N.style.setProperty("display","grid"),N.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),N.style.setProperty("gap","2rem"),N.style.setProperty("margin-top","2rem"),$.style.setProperty("width","60px"),$.style.setProperty("height","60px"),$.style.setProperty("border-radius","50%"),$.style.setProperty("background","var(--primary-color)"),$.style.setProperty("color","white"),$.style.setProperty("display","flex"),$.style.setProperty("align-items","center"),$.style.setProperty("justify-content","center"),$.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","600"),$.style.setProperty("margin","0 auto 1rem"),U.style.setProperty("margin-bottom","0.5rem"),M.style.setProperty("color","var(--text-muted)"),M.style.setProperty("font-size","0.875rem"),k.style.setProperty("width","60px"),k.style.setProperty("height","60px"),k.style.setProperty("border-radius","50%"),k.style.setProperty("background","var(--secondary-color)"),k.style.setProperty("color","white"),k.style.setProperty("display","flex"),k.style.setProperty("align-items","center"),k.style.setProperty("justify-content","center"),k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","600"),k.style.setProperty("margin","0 auto 1rem"),B.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("color","var(--text-muted)"),de.style.setProperty("font-size","0.875rem"),F.style.setProperty("width","60px"),F.style.setProperty("height","60px"),F.style.setProperty("border-radius","50%"),F.style.setProperty("background","var(--accent-color)"),F.style.setProperty("color","white"),F.style.setProperty("display","flex"),F.style.setProperty("align-items","center"),F.style.setProperty("justify-content","center"),F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("margin","0 auto 1rem"),W.style.setProperty("margin-bottom","0.5rem"),ie.style.setProperty("color","var(--text-muted)"),ie.style.setProperty("font-size","0.875rem"),o.style.setProperty("width","60px"),o.style.setProperty("height","60px"),o.style.setProperty("border-radius","50%"),o.style.setProperty("background","var(--success-color)"),o.style.setProperty("color","white"),o.style.setProperty("display","flex"),o.style.setProperty("align-items","center"),o.style.setProperty("justify-content","center"),o.style.setProperty("font-size","1.5rem"),o.style.setProperty("font-weight","600"),o.style.setProperty("margin","0 auto 1rem"),f.style.setProperty("margin-bottom","0.5rem"),_.style.setProperty("color","var(--text-muted)"),_.style.setProperty("font-size","0.875rem"),n}});export{Ot as default};
