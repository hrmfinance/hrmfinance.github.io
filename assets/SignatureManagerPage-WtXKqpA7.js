import{c as u,D as Ye,a as t,t as v,i as r,S as g,b as le,W as Re,I as G,y as Fe,w as Ne,B as z,ad as Ze,e as te,ae as et,d as Ae,af as tt,G as rt,o as st,ag as lt,h as de,F as it,k as ot,v as $e,ah as at,ai as nt,aj as me,ak as dt,al as yt,am as pt,an as ct,ao as gt,L as mt}from"./index-iYm-i8vd.js";var ut=v("<div><h4>Firma a Exportar:</h4><img alt=Signature>"),Pt=v("<div><p>Cargando aplicaciones de pasaporte..."),ht=v("<div><strong>‚ö† Error:</strong> "),vt=v("<div><strong>‚úì √âxito:</strong> Firma exportada exitosamente a la aplicaci√≥n de pasaporte"),bt=v("<div><div>Se muestran aplicaciones sin firma o que coinciden con el nombre del cliente"),ft=v("<div><p>No se encontraron aplicaciones de pasaporte compatibles.</p><p>Busque aplicaciones sin firma o que coincidan con el nombre del cliente: <strong>"),xt=v("<div><div><div><h2>üìã Exportar Firma a Aplicaci√≥n de Pasaporte</h2><button>‚úï</button></div><div><div><h3>Solicitud de Firma</h3><p><strong>Cliente:</strong> </p><p><strong>ID:</strong> </p><p><strong>Firmado:</strong> </p></div></div><div>");const $t=a=>{const[K,R]=u([]),[D,I]=u(""),[L,ie]=u(!1),[ee,re]=u(!1),[U,A]=u(""),[P,Q]=u(!1),C=new et,q=async()=>{if(a.isOpen){re(!0),A("");try{te("loadPassportApplications");const y=await C.getPassportApplications(a.signatureRequest.clientName);te(y);const N=y.filter(S=>{const $=!S.applicationData.firmaBase64&&!S.applicationData.firmaUrl,j=S.applicationData.primerNombre?.toLowerCase().includes(a.signatureRequest.clientName.toLowerCase())||S.applicationData.primerApellido?.toLowerCase().includes(a.signatureRequest.clientName.toLowerCase())||a.signatureRequest.clientName.toLowerCase().includes(S.applicationData.primerNombre?.toLowerCase()||"")||a.signatureRequest.clientName.toLowerCase().includes(S.applicationData.primerApellido?.toLowerCase()||"");return $||j});R(N)}catch(y){te("Error loading passport applications:",y),A(y instanceof Error?y.message:"Error loading passport applications")}finally{re(!1)}}},X=async()=>{if(!D()||!a.signatureRequest.signatureUrl){A("Please select a passport application");return}ie(!0),A("");try{let y=K().filter(S=>S.id===D())?.[0],N={signatureBase64:a.signatureRequest.signatureUrl,signatureRequestId:a.signatureRequest.id,...y.applicationData};await Ze(D(),N),Q(!0),setTimeout(()=>{Q(!1),a.onClose()},2e3)}catch(y){te("Error exporting signature:",y),A(y instanceof Error?y.message:"Error exporting signature")}finally{ie(!1)}},W=()=>{a.isOpen&&(q(),I(""),A(""),Q(!1))},T=()=>{I(""),A(""),Q(!1),a.onClose()};return Ye(()=>{a.isOpen&&W()}),t(g,{get when(){return a.isOpen},get children(){var y=xt(),N=y.firstChild,S=N.firstChild,$=S.firstChild,j=$.nextSibling,M=S.nextSibling,J=M.firstChild,k=J.firstChild,B=k.nextSibling,ye=B.firstChild;ye.nextSibling;var O=B.nextSibling,F=O.firstChild;F.nextSibling;var V=O.nextSibling,oe=V.firstChild;oe.nextSibling;var H=M.nextSibling;return y.style.setProperty("position","fixed"),y.style.setProperty("top","0"),y.style.setProperty("left","0"),y.style.setProperty("right","0"),y.style.setProperty("bottom","0"),y.style.setProperty("background","rgba(0, 0, 0, 0.5)"),y.style.setProperty("display","flex"),y.style.setProperty("align-items","center"),y.style.setProperty("justify-content","center"),y.style.setProperty("z-index","1000"),N.style.setProperty("background","#ffffff"),N.style.setProperty("border-radius","var(--border-radius)"),N.style.setProperty("box-shadow","0 4px 20px rgba(0, 0, 0, 0.2)"),N.style.setProperty("max-width","600px"),N.style.setProperty("width","90%"),N.style.setProperty("max-height","80vh"),N.style.setProperty("overflow","auto"),S.style.setProperty("padding","1.5rem"),S.style.setProperty("border-bottom","1px solid var(--border-color)"),S.style.setProperty("display","flex"),S.style.setProperty("justify-content","space-between"),S.style.setProperty("align-items","center"),$.style.setProperty("margin","0"),$.style.setProperty("font-size","1.25rem"),$.style.setProperty("color","var(--text-primary)"),j.$$click=T,j.style.setProperty("background","none"),j.style.setProperty("border","none"),j.style.setProperty("font-size","1.5rem"),j.style.setProperty("cursor","pointer"),j.style.setProperty("color","var(--text-muted)"),M.style.setProperty("padding","1.5rem"),J.style.setProperty("padding","1rem"),J.style.setProperty("background","var(--info-light)"),J.style.setProperty("border-radius","var(--border-radius-sm)"),J.style.setProperty("margin-bottom","1.5rem"),J.style.setProperty("border","1px solid var(--info-color)"),k.style.setProperty("margin","0 0 0.5rem 0"),k.style.setProperty("font-size","1rem"),k.style.setProperty("color","var(--info-dark)"),B.style.setProperty("margin","0.25rem 0"),B.style.setProperty("font-size","0.875rem"),r(B,()=>a.signatureRequest.clientName,null),O.style.setProperty("margin","0.25rem 0"),O.style.setProperty("font-size","0.875rem"),r(O,()=>a.signatureRequest.id,null),V.style.setProperty("margin","0.25rem 0"),V.style.setProperty("font-size","0.875rem"),r(V,()=>a.signatureRequest.signedAt?.toDate().toLocaleDateString(),null),r(M,t(g,{get when(){return a.signatureRequest.signatureUrl},get children(){var o=ut(),f=o.firstChild,_=f.nextSibling;return o.style.setProperty("text-align","center"),o.style.setProperty("margin-bottom","1.5rem"),f.style.setProperty("margin","0 0 0.5rem 0"),f.style.setProperty("font-size","0.875rem"),f.style.setProperty("color","var(--text-muted)"),_.style.setProperty("max-width","300px"),_.style.setProperty("max-height","100px"),_.style.setProperty("border","1px solid var(--border-color)"),_.style.setProperty("border-radius","var(--border-radius-sm)"),_.style.setProperty("background","white"),_.style.setProperty("padding","0.5rem"),le(()=>Re(_,"src",a.signatureRequest.signatureUrl)),o}}),null),r(M,t(g,{get when(){return ee()},get children(){var o=Pt(),f=o.firstChild;return o.style.setProperty("text-align","center"),o.style.setProperty("padding","2rem"),o.style.setProperty("color","var(--text-muted)"),r(o,t(G,{name:"loading",size:"2rem"}),f),o}}),null),r(M,t(g,{get when(){return U()},get children(){var o=ht(),f=o.firstChild;return f.nextSibling,o.style.setProperty("padding","1rem"),o.style.setProperty("background","var(--error-light)"),o.style.setProperty("color","var(--error-dark)"),o.style.setProperty("border-radius","var(--border-radius-sm)"),o.style.setProperty("margin-bottom","1rem"),o.style.setProperty("border","1px solid var(--error-color)"),r(o,U,null),o}}),null),r(M,t(g,{get when(){return P()},get children(){var o=vt();return o.style.setProperty("padding","1rem"),o.style.setProperty("background","var(--success-light)"),o.style.setProperty("color","var(--success-dark)"),o.style.setProperty("border-radius","var(--border-radius-sm)"),o.style.setProperty("margin-bottom","1rem"),o.style.setProperty("border","1px solid var(--success-color)"),o}}),null),r(M,t(g,{get when(){return Ne(()=>!ee())()&&K().length>0},get children(){var o=bt(),f=o.firstChild;return r(o,t(Fe,{label:"Seleccionar Aplicaci√≥n de Pasaporte",get value(){return D()},onChange:I,get options(){return[{value:"",label:"-- Seleccione una aplicaci√≥n --"},...K().map(_=>({value:_.id,label:`${_.applicationData.primerNombre} ${_.applicationData.primerApellido} (${_.applicationNumber}) - ${_.status}`}))]},required:!0}),f),f.style.setProperty("margin-top","0.5rem"),f.style.setProperty("font-size","0.75rem"),f.style.setProperty("color","var(--text-muted)"),o}}),null),r(M,D,null),r(M,t(g,{get when(){return Ne(()=>!ee())()&&K().length===0},get children(){var o=ft(),f=o.firstChild,_=f.nextSibling,ce=_.firstChild,Pe=ce.nextSibling;return o.style.setProperty("padding","2rem"),o.style.setProperty("text-align","center"),o.style.setProperty("color","var(--text-muted)"),r(o,t(G,{name:"search",size:"3rem",style:{"margin-bottom":"1rem"}}),f),_.style.setProperty("font-size","0.875rem"),r(Pe,()=>a.signatureRequest.clientName),o}}),null),H.style.setProperty("padding","1rem 1.5rem"),H.style.setProperty("border-top","1px solid var(--border-color)"),H.style.setProperty("display","flex"),H.style.setProperty("gap","0.75rem"),H.style.setProperty("justify-content","flex-end"),r(H,t(z,{variant:"outline",onClick:T,get disabled(){return L()},children:"Cancelar"}),null),r(H,t(z,{variant:"primary",onClick:X,get disabled(){return!D()||L()||P()},get children(){return t(g,{get when(){return L()},fallback:"üìã Exportar Firma",children:"Exportando..."})}}),null),y}})};Ae(["click"]);var ue=v("<div>"),_t=v('<div><div><div><label>Tienda/Ubicaci√≥n *</label><select required><option value>Seleccionar tienda...</option></select></div><div><label>D√≠as hasta expiraci√≥n *</label><select><option value=1>1 d√≠a</option><option value=3>3 d√≠as</option><option value=7>7 d√≠as</option><option value=14>14 d√≠as</option><option value=30>30 d√≠as</option></select></div><div><label>Notas</label><textarea placeholder="Notas adicionales para el cliente..."rows=3></textarea></div></div><div>'),wt=v("<option>"),St=v("<div><div><div>üìã</div><p>Comparta este enlace con <strong></strong></p></div><div></div><div></div><p>El enlace expirar√° el "),Ct=v("<div>sending..."),kt=v("<div><p>Esta solicitud no tiene firma disponible."),Et=v('<div><div><h3></h3><p>Firmado el: </p><div><span>üìÅ </span><span>üóÉÔ∏è Base64 (PNG)</span><span>üö´ No CORS Issues</span></div></div><div><img alt="Firma del cliente"></div><div>'),zt=v("<span>"),Nt=v("<div><div><div><p>Env√≠e solicitudes de firma a sus clientes por email o SMS</p></div><div></div></div><div>"),Rt=v("<div><div>‚è≥</div><p>Cargando solicitudes..."),Ft=v("<div><p>No hay solicitudes de firma. Cree una nueva para empezar."),At=v("<input type=checkbox>"),Mt=v("<span> ‚Ä¢ "),Dt=v("<div><strong>Documento:</strong> "),It=v("<div><strong>Tienda:</strong> "),Lt=v("<div><strong>Firmado el:</strong> "),Tt=v("<div><strong>Notas:</strong> "),Ut=v("<div><div><div><div><h4></h4><p></p></div></div></div><div><div><strong>ID:</strong> </div><div><strong>Creado:</strong> </div><div><strong>Expira:</strong> </div></div><div>");const jt=()=>{const a=tt(),K=rt(),[R,D]=u([]),[I,L]=u(!1),[ie,ee]=u(null),[re,U]=u(!1),[A,P]=u(""),[Q,C]=u(""),[q,X]=u(new Set),[W,T]=u(!1),[y,N]=u(!1),[S,$]=u(!1),[j,M]=u(!1),[J,k]=u(null),[B,ye]=u("all"),[O,F]=u(""),[V,oe]=u(""),[H,o]=u(""),[f,_]=u(""),[ce,Pe]=u(""),[he,_e]=u(""),[ge,we]=u("7"),[ve,Se]=u(""),[Me,Ce]=u("");st(()=>{ae()});const ae=async()=>{L(!0);try{let e=await lt();B()!=="all"&&(e=e.filter(i=>i.storeId===B())),te(`Loaded signature requests filtered by store ${B()}:`,e),D(e)}catch{P("Error al cargar las solicitudes")}finally{L(!1)}},De=async()=>{if(te("handleCreateRequest called"),te("Form values:",{clientId:O(),clientName:V(),clientEmail:H(),clientPhone:f(),documentType:ce(),notes:he(),expirationDays:ge()}),!O()||!V()||!ge()||!ve()){P("Por favor complete todos los campos requeridos (incluyendo la tienda)");return}U(!0),P(""),C("");try{te("Creating signature request...");const e=await gt({clientId:O(),clientName:V(),clientEmail:H(),clientPhone:f(),documentType:ce(),notes:he(),storeId:ve(),businessId:de.getBusinessId(),storeName:Me()},parseInt(ge()));te("Request created successfully:",e),C("Solicitud creada exitosamente"),a.hideModal(),be(),await ae(),ke(e)}catch(e){console.error("Error creating request:",e),P(e.message||"Error al crear la solicitud")}finally{U(!1)}},Ie=async e=>{if(confirm("¬øEst√° seguro de cancelar esta solicitud?"))try{await yt(e),await ae(),C("Solicitud cancelada")}catch(i){P(i.message||"Error al cancelar la solicitud")}},Le=async e=>{if(confirm("¬øEst√° seguro de ELIMINAR permanentemente esta solicitud? Esta acci√≥n no se puede deshacer."))try{await ct(e),await ae(),C("Solicitud eliminada permanentemente"),setTimeout(()=>C(""),3e3)}catch(i){P(i.message||"Error al eliminar la solicitud"),setTimeout(()=>P(""),5e3)}},be=()=>{F(""),oe(""),o(""),_(""),Pe(""),_e(""),we("7"),Se(""),Ce("")},Te=e=>{k(e),M(!0),a.hideModal()},Ue=()=>{M(!1),k(null)},fe=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),je=()=>{a.showModal({title:"Nueva Solicitud de Firma",children:(()=>{var e=_t(),i=e.firstChild,p=i.firstChild,d=p.firstChild,c=d.nextSibling;c.firstChild;var b=p.nextSibling,s=b.firstChild,l=s.nextSibling,E=b.nextSibling,m=E.firstChild,x=m.nextSibling,w=i.nextSibling;return e.style.setProperty("padding","1.5rem"),r(e,t(g,{get when(){return A()},get children(){var h=ue();return h.style.setProperty("padding","1rem"),h.style.setProperty("margin-bottom","1rem"),h.style.setProperty("background","var(--error-light)"),h.style.setProperty("color","var(--error-dark)"),h.style.setProperty("border-radius","var(--border-radius-sm)"),r(h,A),h}}),i),i.style.setProperty("display","grid"),i.style.setProperty("gap","1rem"),d.style.setProperty("display","block"),d.style.setProperty("margin-bottom","0.5rem"),d.style.setProperty("font-weight","500"),d.style.setProperty("color","var(--text-primary)"),c.addEventListener("change",h=>{const Y=h.target.value;Se(Y);const Z=de.allowedStores.find(pe=>pe.id===Y);Ce(Z?.name||"")}),c.style.setProperty("width","100%"),c.style.setProperty("padding","0.75rem"),c.style.setProperty("border","1px solid var(--border-color)"),c.style.setProperty("border-radius","var(--border-radius-sm)"),c.style.setProperty("background","white"),r(c,()=>de.allowedStores.map(h=>(()=>{var Y=wt();return r(Y,()=>h.name),le(()=>Y.value=h.id),Y})()),null),r(i,t($e,{label:"Pasaporte",get value(){return O()},onChange:F,placeholder:"CLI-001",required:!0}),b),r(i,t($e,{label:"Nombre del Cliente",get value(){return V()},onChange:oe,placeholder:"Juan P√©rez",required:!0}),b),r(i,t($e,{label:"Tel√©fono del Cliente",get value(){return f()},onChange:_,placeholder:"+1 234 567 8900"}),b),s.style.setProperty("display","block"),s.style.setProperty("margin-bottom","0.5rem"),s.style.setProperty("font-weight","500"),s.style.setProperty("color","var(--text-primary)"),l.addEventListener("change",h=>we(h.target.value)),l.style.setProperty("width","100%"),l.style.setProperty("padding","0.75rem"),l.style.setProperty("border","1px solid var(--border-color)"),l.style.setProperty("border-radius","var(--border-radius-sm)"),l.style.setProperty("background","white"),m.style.setProperty("display","block"),m.style.setProperty("margin-bottom","0.5rem"),m.style.setProperty("font-weight","500"),m.style.setProperty("color","var(--text-primary)"),x.$$input=h=>_e(h.target.value),x.style.setProperty("width","100%"),x.style.setProperty("padding","0.75rem"),x.style.setProperty("border","1px solid var(--border-color)"),x.style.setProperty("border-radius","var(--border-radius-sm)"),x.style.setProperty("resize","vertical"),x.style.setProperty("font-family","inherit"),w.style.setProperty("display","flex"),w.style.setProperty("gap","1rem"),w.style.setProperty("margin-top","2rem"),w.style.setProperty("justify-content","flex-end"),r(w,t(z,{variant:"outline",onClick:()=>{a.hideModal(),be(),P("")},children:"Cancelar"}),null),r(w,t(z,{variant:"primary",onClick:De,get disabled(){return re()},get children(){return t(g,{get when(){return re()},fallback:"Crear Solicitud",children:"Creando..."})}}),null),le(()=>c.value=ve()),le(()=>l.value=ge()),le(()=>x.value=he()),e})(),onClose:()=>{be(),P("")}})},ke=e=>{a.showModal({title:"Enlace de Firma Generado",children:(()=>{var i=St(),p=i.firstChild,d=p.firstChild,c=d.nextSibling,b=c.firstChild,s=b.nextSibling,l=p.nextSibling,E=l.nextSibling,m=E.nextSibling;return m.firstChild,i.style.setProperty("padding","1.5rem"),p.style.setProperty("text-align","center"),p.style.setProperty("margin-bottom","2rem"),d.style.setProperty("font-size","4rem"),d.style.setProperty("margin-bottom","1rem"),c.style.setProperty("color","var(--text-muted)"),r(s,()=>e.clientName),l.style.setProperty("padding","1rem"),l.style.setProperty("background","var(--background-secondary)"),l.style.setProperty("border-radius","var(--border-radius-sm)"),l.style.setProperty("word-break","break-all"),l.style.setProperty("font-family","monospace"),l.style.setProperty("font-size","0.875rem"),l.style.setProperty("text-align","center"),l.style.setProperty("margin-bottom","1rem"),r(l,()=>me(e?.accessToken||"",e.id)),E.style.setProperty("display","grid"),E.style.setProperty("gap","0.75rem"),r(E,t(z,{variant:"primary",onClick:()=>{Be(e.id,e?.accessToken||"")},style:{width:"100%"},get children(){return[t(G,{name:"copy",size:"1rem",style:{"margin-right":"0.5rem"}}),"Copiar Enlace"]}}),null),r(E,t(z,{variant:"secondary",onClick:()=>{const w=`Por favor firme el documento usando este enlace: ${me(e?.accessToken||"",e.id)}`;window.open(`mailto:${e.clientEmail}?subject=Solicitud de Firma&body=${encodeURIComponent(w)}`)},style:{width:"100%"},get children(){return[t(G,{name:"email",size:"1rem",style:{"margin-right":"0.5rem"}}),"Enviar por Email"]}}),null),r(E,t(g,{get when(){return e.clientPhone},get children(){return t(z,{variant:"secondary",onClick:async()=>{$(!0);const w=`Por favor firme el documento: 
${me(e?.accessToken||"",e.id)}`;let h=await dt(e.clientPhone,w);te(h),$(!1)},style:{width:"100%"},get children(){return t(g,{get when(){return!S()},get fallback(){return Ct()},get children(){return[t(G,{name:"whatsapp",size:"1rem",style:{"margin-right":"0.5rem"}}),"Enviar por WhatsApp"]}})}})}}),null),m.style.setProperty("margin-top","1rem"),m.style.setProperty("font-size","0.8rem"),m.style.setProperty("color","var(--text-muted)"),m.style.setProperty("text-align","center"),r(m,()=>e.expiresAt,null),i})()})},Be=(e,i)=>{const p=me(i,e);navigator.clipboard.writeText(p),C("Enlace copiado al portapapeles"),setTimeout(()=>C(""),3e3)},Oe=e=>{if(!e.signatureUrl)return;const i={imageData:e.signatureUrl,clientName:e.clientName,requestId:e.id,signedAt:e.signedAt};sessionStorage.setItem("pendingSignature",JSON.stringify(i)),a.hideModal(),K("/pdf-signature")},Ge=e=>{if(!e.signatureUrl){a.showModal({title:"Error",children:(()=>{var p=kt();return p.style.setProperty("padding","1.5rem"),p.style.setProperty("text-align","center"),p})()});return}const i=Math.round(e.signatureUrl.length*3/4);a.showModal({title:"Firma del Cliente",children:(()=>{var p=Et(),d=p.firstChild,c=d.firstChild,b=c.nextSibling;b.firstChild;var s=b.nextSibling,l=s.firstChild;l.firstChild;var E=l.nextSibling,m=d.nextSibling,x=m.firstChild,w=m.nextSibling;return p.style.setProperty("padding","1.5rem"),p.style.setProperty("text-align","center"),d.style.setProperty("margin-bottom","1.5rem"),c.style.setProperty("margin-bottom","0.5rem"),r(c,()=>e.clientName),b.style.setProperty("color","var(--text-muted)"),b.style.setProperty("font-size","0.875rem"),r(b,()=>e.signedAt,null),s.style.setProperty("margin-top","0.5rem"),s.style.setProperty("padding","0.5rem"),s.style.setProperty("background","var(--background-secondary)"),s.style.setProperty("border-radius","var(--border-radius-sm)"),s.style.setProperty("font-size","0.75rem"),s.style.setProperty("color","var(--text-muted)"),l.style.setProperty("margin-right","1rem"),r(l,()=>pt(i),null),E.style.setProperty("margin-right","1rem"),m.style.setProperty("border","2px solid var(--border-color)"),m.style.setProperty("border-radius","var(--border-radius)"),m.style.setProperty("padding","1rem"),m.style.setProperty("background","white"),m.style.setProperty("max-width","100%"),m.style.setProperty("overflow","hidden"),x.style.setProperty("max-width","100%"),x.style.setProperty("max-height","400px"),x.style.setProperty("height","auto"),x.style.setProperty("display","block"),x.style.setProperty("margin","0 auto"),w.style.setProperty("margin-top","1.5rem"),w.style.setProperty("display","flex"),w.style.setProperty("gap","1rem"),w.style.setProperty("justify-content","center"),w.style.setProperty("flex-wrap","wrap"),r(w,t(g,{get when(){return de.state?.profile?.AdminPassportAccess},get children(){return[t(z,{variant:"primary",onClick:()=>Oe(e),get children(){return[t(G,{name:"document",size:"1rem",style:{"margin-right":"0.5rem"}}),"Usar en PDF"]}}),t(z,{variant:"secondary",onClick:()=>Te(e),get children(){return[t(G,{name:"card",size:"1rem",style:{"margin-right":"0.5rem"}}),"Exportar a Pasaporte"]}})]}}),null),r(w,t(z,{variant:"outline",onClick:()=>{const h=document.createElement("a");h.download=`firma-${e.clientName}-${e.id}.png`,h.href=e.signatureUrl,h.click()},get children(){return[t(G,{name:"download",size:"1rem",style:{"margin-right":"0.5rem"}}),"Descargar"]}}),null),r(w,t(z,{variant:"outline",onClick:()=>a.hideModal(),children:"Cerrar"}),null),le(()=>Re(x,"src",e.signatureUrl)),p})()})},qe=e=>{const i=new Set(q());i.has(e)?i.delete(e):i.add(e),X(i)},We=()=>{const e=R().filter(i=>i.status==="signed");X(new Set(e.map(i=>i.id)))},Ee=()=>{X(new Set)},Je=async()=>{if(q().size===0){P("No hay solicitudes seleccionadas para exportar");return}T(!0),P(""),C("");try{const e=Array.from(q()),i=await at(e);if(i.success.length>0&&C(`${i.success.length} solicitudes exportadas exitosamente`),i.errors.length>0){const p=i.errors.map(d=>`${d.id}: ${d.error}`).join(", ");P(`Errores en exportaci√≥n: ${p}`)}Ee(),await ae()}catch(e){P(e.message||"Error al exportar solicitudes")}finally{T(!1)}},Ve=async()=>{const e=R().filter(i=>i.status==="exported");if(e.length===0){P("No hay solicitudes exportadas para limpiar");return}if(confirm(`¬øEst√° seguro de eliminar ${e.length} solicitudes exportadas de Firestore? Esta acci√≥n no se puede deshacer.`)){T(!0),P(""),C("");try{const i=e.map(d=>d.id),p=await nt(i);if(p.success.length>0&&C(`${p.success.length} solicitudes limpiadas exitosamente`),p.errors.length>0){const d=p.errors.map(c=>`${c.id}: ${c.error}`).join(", ");P(`Errores en limpieza: ${d}`)}await ae()}catch(i){P(i.message||"Error al limpiar solicitudes")}finally{T(!1)}}},He=e=>{const i={pending:{color:"var(--warning-color)",bg:"var(--warning-light)",text:"Pendiente"},signed:{color:"var(--success-color)",bg:"var(--success-light)",text:"Firmado"},expired:{color:"var(--error-color)",bg:"var(--error-light)",text:"Expirado"},cancelled:{color:"var(--text-muted)",bg:"var(--background-secondary)",text:"Cancelado"},exported:{color:"var(--info-color)",bg:"var(--info-light)",text:"Exportado"}},p=i[e]||i.pending;return(()=>{var d=zt();return d.style.setProperty("padding","0.25rem 0.75rem"),d.style.setProperty("border-radius","var(--border-radius-sm)"),d.style.setProperty("font-size","0.8rem"),d.style.setProperty("font-weight","500"),r(d,()=>p.text),le(c=>{var b=p.bg,s=p.color;return b!==c.e&&((c.e=b)!=null?d.style.setProperty("background",b):d.style.removeProperty("background")),s!==c.t&&((c.t=s)!=null?d.style.setProperty("color",s):d.style.removeProperty("color")),c},{e:void 0,t:void 0}),d})()};return[t(ot,{title:"Gesti√≥n de Solicitudes de Firma",get children(){var e=Nt(),i=e.firstChild,p=i.firstChild,d=p.firstChild,c=p.nextSibling,b=i.nextSibling;return e.style.setProperty("padding","1.5rem"),i.style.setProperty("display","flex"),i.style.setProperty("justify-content","space-between"),i.style.setProperty("align-items","center"),i.style.setProperty("margin-bottom","2rem"),i.style.setProperty("flex-wrap","wrap"),i.style.setProperty("gap","1rem"),d.style.setProperty("color","var(--text-muted)"),d.style.setProperty("font-size","0.875rem"),c.style.setProperty("display","flex"),c.style.setProperty("gap","0.5rem"),c.style.setProperty("flex-wrap","wrap"),r(c,t(z,{variant:"primary",onClick:je,get children(){return[t(G,{name:"add",size:"1rem",style:{"margin-right":"0.5rem"}}),"Nueva Solicitud"]}}),null),r(c,t(g,{get when(){return R().some(s=>s.status==="signed")},get children(){return[t(z,{variant:"secondary",onClick:We,get disabled(){return W()},children:"Seleccionar Firmadas"}),t(g,{get when(){return q().size>0},get children(){return[t(z,{variant:"success",onClick:Je,get disabled(){return W()},get children(){return t(g,{get when(){return W()},get fallback(){return`Exportar (${q().size})`},children:"Exportando..."})}}),t(z,{variant:"outline",onClick:Ee,get disabled(){return W()},children:"Limpiar Selecci√≥n"})]}})]}}),null),r(c,t(g,{get when(){return R().some(s=>s.status==="exported")},get children(){return t(z,{variant:"warning",onClick:Ve,get disabled(){return W()},get children(){return t(g,{get when(){return W()},fallback:"Limpiar Exportadas",children:"Limpiando..."})}})}}),null),b.style.setProperty("margin-bottom","2rem"),b.style.setProperty("padding","1.5rem"),b.style.setProperty("background","var(--bg-secondary)"),b.style.setProperty("border-radius","var(--border-radius)"),b.style.setProperty("border","1px solid var(--border-color)"),r(b,t(Fe,{get value(){return B()},onChange:s=>{ye(s),ae()},get options(){return[{value:"all",label:"Todas las Tiendas"},...de.allowedStores.map(s=>({value:s.id,label:s.name,disabled:!s.isActive}))]},style:{"min-width":"250px"},get disabled(){return I()},label:"Filtrar Solicitudes de Firma por Tienda"})),r(e,t(g,{get when(){return A()},get children(){var s=ue();return s.style.setProperty("padding","1rem"),s.style.setProperty("margin-bottom","1rem"),s.style.setProperty("background","var(--error-light)"),s.style.setProperty("color","var(--error-dark)"),s.style.setProperty("border-radius","var(--border-radius-sm)"),r(s,A),s}}),null),r(e,t(g,{get when(){return Q()},get children(){var s=ue();return s.style.setProperty("padding","1rem"),s.style.setProperty("margin-bottom","1rem"),s.style.setProperty("background","var(--success-light)"),s.style.setProperty("color","var(--success-dark)"),s.style.setProperty("border-radius","var(--border-radius-sm)"),r(s,Q),s}}),null),r(e,t(g,{get when(){return!I()},get fallback(){return(()=>{var s=Rt(),l=s.firstChild;return s.style.setProperty("text-align","center"),s.style.setProperty("padding","2rem"),l.style.setProperty("font-size","1.5rem"),l.style.setProperty("margin-bottom","0.5rem"),s})()},get children(){return t(g,{get when(){return R().length>0},get fallback(){return(()=>{var s=Ft(),l=s.firstChild;return s.style.setProperty("text-align","center"),s.style.setProperty("padding","3rem"),s.style.setProperty("background","var(--background-secondary)"),s.style.setProperty("border-radius","var(--border-radius)"),r(s,t(G,{name:"document",size:"3rem",style:{opacity:"0.3","margin-bottom":"1rem"}}),l),l.style.setProperty("color","var(--text-muted)"),s})()},get children(){var s=ue();return s.style.setProperty("display","grid"),s.style.setProperty("gap","1rem"),r(s,t(it,{get each(){return R()},children:l=>(()=>{var E=Ut(),m=E.firstChild,x=m.firstChild,w=x.firstChild,h=w.firstChild,Y=h.nextSibling,Z=m.nextSibling,pe=Z.firstChild,Ke=pe.firstChild;Ke.nextSibling;var xe=pe.nextSibling,Qe=xe.firstChild;Qe.nextSibling;var ze=xe.nextSibling,Xe=ze.firstChild;Xe.nextSibling;var se=Z.nextSibling;return E.style.setProperty("padding","1.5rem"),E.style.setProperty("border","1px solid var(--border-color)"),E.style.setProperty("border-radius","var(--border-radius)"),E.style.setProperty("background","var(--surface-color)"),E.style.setProperty("transition","all 0.2s ease"),m.style.setProperty("display","flex"),m.style.setProperty("justify-content","space-between"),m.style.setProperty("align-items","flex-start"),m.style.setProperty("margin-bottom","1rem"),x.style.setProperty("display","flex"),x.style.setProperty("align-items","flex-start"),x.style.setProperty("gap","1rem"),r(x,t(g,{get when(){return l.status==="signed"},get children(){var n=At();return n.addEventListener("change",()=>qe(l.id)),n.style.setProperty("margin-top","0.25rem"),n.style.setProperty("width","1.125rem"),n.style.setProperty("height","1.125rem"),le(()=>n.checked=q().has(l.id)),n}}),w),h.style.setProperty("margin-bottom","0.5rem"),r(h,()=>l.signerName),Y.style.setProperty("font-size","0.875rem"),Y.style.setProperty("color","var(--text-muted)"),r(Y,()=>l.signerEmail,null),r(Y,t(g,{get when(){return l.signerPhone},get children(){var n=Mt();return n.firstChild,r(n,()=>l.signerPhone,null),n}}),null),r(m,()=>He(l.status),null),Z.style.setProperty("display","grid"),Z.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),Z.style.setProperty("gap","0.75rem"),Z.style.setProperty("font-size","0.8rem"),Z.style.setProperty("color","var(--text-muted)"),r(pe,()=>l?.id,null),r(xe,()=>fe(l?.createdAt),null),r(ze,()=>fe(l?.expiresAt),null),r(Z,t(g,{get when(){return l?.documentType},get children(){var n=Dt(),ne=n.firstChild;return ne.nextSibling,r(n,()=>l?.documentType,null),n}}),null),r(Z,t(g,{get when(){return l?.storeName||l?.storeId},get children(){var n=It(),ne=n.firstChild;return ne.nextSibling,r(n,()=>l?.storeName||l?.storeId,null),n}}),null),r(E,t(g,{get when(){return l?.signedAt},get children(){var n=Lt(),ne=n.firstChild;return ne.nextSibling,n.style.setProperty("margin-top","0.75rem"),n.style.setProperty("padding","0.75rem"),n.style.setProperty("background","var(--success-light)"),n.style.setProperty("border-radius","var(--border-radius-sm)"),n.style.setProperty("font-size","0.875rem"),r(n,()=>fe(l?.signedAt),null),n}}),se),r(E,t(g,{get when(){return l.notes},get children(){var n=Tt(),ne=n.firstChild;return ne.nextSibling,n.style.setProperty("margin-top","0.75rem"),n.style.setProperty("padding","0.75rem"),n.style.setProperty("background","var(--background-secondary)"),n.style.setProperty("border-radius","var(--border-radius-sm)"),n.style.setProperty("font-size","0.875rem"),r(n,()=>l.notes,null),n}}),se),se.style.setProperty("display","flex"),se.style.setProperty("gap","0.5rem"),se.style.setProperty("margin-top","1rem"),se.style.setProperty("flex-wrap","wrap"),r(se,t(g,{get when(){return l.status==="pending"},get children(){return[t(z,{variant:"secondary",size:"sm",onClick:()=>{ke(l)},get children(){return[t(G,{name:"copy",size:"0.875rem",style:{"margin-right":"0.25rem"}}),"Copiar Enlace"]}}),t(z,{variant:"outline",size:"sm",onClick:()=>Ie(l.id),children:"Cancelar"})]}}),null),r(se,t(g,{get when(){return l.status==="signed"&&l.signatureUrl},get children(){return t(z,{variant:"primary",size:"sm",onClick:()=>Ge(l),get children(){return[t(G,{name:"signature",size:"0.875rem",style:{"margin-right":"0.25rem"}}),"Ver Firma"]}})}}),null),r(se,t(g,{get when(){return de.isAdmin()||l.requestedBy===de.state.user?.uid},get children(){return t(z,{variant:"error",size:"sm",onClick:()=>Le(l.id),title:"Eliminar solicitud permanentemente",get children(){return[t(G,{name:"delete",size:"0.875rem",style:{"margin-right":"0.25rem"}}),"Eliminar"]}})}}),null),E})()})),s}})}}),null),e}}),t(g,{get when(){return J()},get children(){return t($t,{get isOpen(){return j()},onClose:Ue,get signatureRequest(){return J()}})}})]};Ae(["input"]);var Bt=v("<div><div><h1>‚úçÔ∏è Firmas Digitales</h1><p>Solicite firmas digitales de sus clientes de forma remota. Env√≠e enlaces por email o SMS para que firmen desde cualquier dispositivo.</p></div><div><div><div>üì±</div><h3>Firma M√≥vil</h3><p>Los clientes pueden firmar desde cualquier dispositivo m√≥vil usando su dedo en la pantalla t√°ctil.</p></div><div><div>üîó</div><h3>Enlaces Seguros</h3><p>Genere enlaces √∫nicos con fecha de expiraci√≥n para asegurar la validez de las solicitudes.</p></div><div><div>‚òÅÔ∏è</div><h3>Almacenamiento Seguro</h3><p>Las firmas se guardan de forma segura en Firebase con acceso controlado y trazabilidad completa.</p></div></div><div><h3>¬øC√≥mo Funciona?</h3><div><div><div>1</div><h4>Crear Solicitud</h4><p>Complete los datos del cliente y cree una nueva solicitud de firma</p></div><div><div>2</div><h4>Enviar Enlace</h4><p>Env√≠e el enlace √∫nico al cliente por email, SMS o cualquier medio</p></div><div><div>3</div><h4>Cliente Firma</h4><p>El cliente abre el enlace y firma usando su dedo o mouse</p></div><div><div>‚úì</div><h4>Firma Guardada</h4><p>La firma se guarda autom√°ticamente y usted recibe notificaci√≥n");const Gt=()=>t(mt,{title:"Gesti√≥n de Firmas Digitales",get children(){var a=Bt(),K=a.firstChild,R=K.firstChild,D=R.nextSibling,I=K.nextSibling,L=I.firstChild,ie=L.firstChild,ee=ie.nextSibling,re=ee.nextSibling,U=L.nextSibling,A=U.firstChild,P=A.nextSibling,Q=P.nextSibling,C=U.nextSibling,q=C.firstChild,X=q.nextSibling,W=X.nextSibling,T=I.nextSibling,y=T.firstChild,N=y.nextSibling,S=N.firstChild,$=S.firstChild,j=$.nextSibling,M=j.nextSibling,J=S.nextSibling,k=J.firstChild,B=k.nextSibling,ye=B.nextSibling,O=J.nextSibling,F=O.firstChild,V=F.nextSibling,oe=V.nextSibling,H=O.nextSibling,o=H.firstChild,f=o.nextSibling,_=f.nextSibling;return a.style.setProperty("max-width","1200px"),a.style.setProperty("margin","0 auto"),a.style.setProperty("padding","2rem 1rem"),K.style.setProperty("text-align","center"),K.style.setProperty("margin-bottom","3rem"),R.style.setProperty("font-size","2.5rem"),R.style.setProperty("font-weight","700"),R.style.setProperty("margin-bottom","1rem"),R.style.setProperty("color","var(--text-primary)"),R.style.setProperty("background","linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%)"),R.style.setProperty("-webkit-background-clip","text"),R.style.setProperty("-webkit-text-fill-color","transparent"),R.style.setProperty("background-clip","text"),D.style.setProperty("font-size","1.125rem"),D.style.setProperty("color","var(--text-muted)"),D.style.setProperty("max-width","600px"),D.style.setProperty("margin","0 auto"),D.style.setProperty("line-height","1.6"),r(a,t(jt,{}),I),I.style.setProperty("margin-top","4rem"),I.style.setProperty("display","grid"),I.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(300px, 1fr))"),I.style.setProperty("gap","2rem"),L.style.setProperty("padding","2rem"),L.style.setProperty("background","white"),L.style.setProperty("border-radius","var(--border-radius)"),L.style.setProperty("box-shadow","var(--shadow-sm)"),L.style.setProperty("text-align","center"),ie.style.setProperty("font-size","2.5rem"),ie.style.setProperty("margin-bottom","1rem"),ee.style.setProperty("font-size","1.25rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("margin-bottom","0.5rem"),ee.style.setProperty("color","var(--text-primary)"),re.style.setProperty("color","var(--text-muted)"),re.style.setProperty("line-height","1.5"),re.style.setProperty("margin","0"),U.style.setProperty("padding","2rem"),U.style.setProperty("background","white"),U.style.setProperty("border-radius","var(--border-radius)"),U.style.setProperty("box-shadow","var(--shadow-sm)"),U.style.setProperty("text-align","center"),A.style.setProperty("font-size","2.5rem"),A.style.setProperty("margin-bottom","1rem"),P.style.setProperty("font-size","1.25rem"),P.style.setProperty("font-weight","600"),P.style.setProperty("margin-bottom","0.5rem"),P.style.setProperty("color","var(--text-primary)"),Q.style.setProperty("color","var(--text-muted)"),Q.style.setProperty("line-height","1.5"),Q.style.setProperty("margin","0"),C.style.setProperty("padding","2rem"),C.style.setProperty("background","white"),C.style.setProperty("border-radius","var(--border-radius)"),C.style.setProperty("box-shadow","var(--shadow-sm)"),C.style.setProperty("text-align","center"),q.style.setProperty("font-size","2.5rem"),q.style.setProperty("margin-bottom","1rem"),X.style.setProperty("font-size","1.25rem"),X.style.setProperty("font-weight","600"),X.style.setProperty("margin-bottom","0.5rem"),X.style.setProperty("color","var(--text-primary)"),W.style.setProperty("color","var(--text-muted)"),W.style.setProperty("line-height","1.5"),W.style.setProperty("margin","0"),T.style.setProperty("margin-top","4rem"),T.style.setProperty("padding","3rem 2rem"),T.style.setProperty("background","linear-gradient(135deg, var(--primary-color)10, var(--secondary-color)10)"),T.style.setProperty("border-radius","var(--border-radius)"),T.style.setProperty("text-align","center"),y.style.setProperty("font-size","2rem"),y.style.setProperty("font-weight","600"),y.style.setProperty("margin-bottom","2rem"),y.style.setProperty("color","var(--text-primary)"),N.style.setProperty("display","grid"),N.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),N.style.setProperty("gap","2rem"),N.style.setProperty("margin-top","2rem"),$.style.setProperty("width","60px"),$.style.setProperty("height","60px"),$.style.setProperty("border-radius","50%"),$.style.setProperty("background","var(--primary-color)"),$.style.setProperty("color","white"),$.style.setProperty("display","flex"),$.style.setProperty("align-items","center"),$.style.setProperty("justify-content","center"),$.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","600"),$.style.setProperty("margin","0 auto 1rem"),j.style.setProperty("margin-bottom","0.5rem"),M.style.setProperty("color","var(--text-muted)"),M.style.setProperty("font-size","0.875rem"),k.style.setProperty("width","60px"),k.style.setProperty("height","60px"),k.style.setProperty("border-radius","50%"),k.style.setProperty("background","var(--secondary-color)"),k.style.setProperty("color","white"),k.style.setProperty("display","flex"),k.style.setProperty("align-items","center"),k.style.setProperty("justify-content","center"),k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","600"),k.style.setProperty("margin","0 auto 1rem"),B.style.setProperty("margin-bottom","0.5rem"),ye.style.setProperty("color","var(--text-muted)"),ye.style.setProperty("font-size","0.875rem"),F.style.setProperty("width","60px"),F.style.setProperty("height","60px"),F.style.setProperty("border-radius","50%"),F.style.setProperty("background","var(--accent-color)"),F.style.setProperty("color","white"),F.style.setProperty("display","flex"),F.style.setProperty("align-items","center"),F.style.setProperty("justify-content","center"),F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("margin","0 auto 1rem"),V.style.setProperty("margin-bottom","0.5rem"),oe.style.setProperty("color","var(--text-muted)"),oe.style.setProperty("font-size","0.875rem"),o.style.setProperty("width","60px"),o.style.setProperty("height","60px"),o.style.setProperty("border-radius","50%"),o.style.setProperty("background","var(--success-color)"),o.style.setProperty("color","white"),o.style.setProperty("display","flex"),o.style.setProperty("align-items","center"),o.style.setProperty("justify-content","center"),o.style.setProperty("font-size","1.5rem"),o.style.setProperty("font-weight","600"),o.style.setProperty("margin","0 auto 1rem"),f.style.setProperty("margin-bottom","0.5rem"),_.style.setProperty("color","var(--text-muted)"),_.style.setProperty("font-size","0.875rem"),a}});export{Gt as default};
