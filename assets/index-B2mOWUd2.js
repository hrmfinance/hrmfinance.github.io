(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const cS=!1,dS=(t,e)=>t===e,Bo=Symbol("solid-proxy"),Eb=typeof Proxy=="function",vy=Symbol("solid-track"),Mh={equals:dS};let Ib=Mb;const qs=1,Fh=2,Tb={owned:null,cleanups:null,context:null,owner:null},um={};var Vr=null;let hm=null,uS=null,Xr=null,_i=null,Ds=null,mp=0;function kd(t,e){const r=Xr,n=Vr,i=t.length===0,o=e===void 0?n:e,s=i?Tb:{owned:null,cleanups:null,context:o?o.context:null,owner:o},l=i?t:()=>t(()=>Ni(()=>Ud(s)));Vr=s,Xr=null;try{return us(l,!0)}finally{Xr=r,Vr=n}}function Se(t,e){e=e?Object.assign({},Mh,e):Mh;const r={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},n=i=>(typeof i=="function"&&(i=i(r.value)),Db(r,i));return[Rb.bind(r),n]}function hS(t,e,r){const n=yp(t,e,!0,qs);Oc(n)}function ge(t,e,r){const n=yp(t,e,!1,qs);Oc(n)}function Un(t,e,r){Ib=bS;const n=yp(t,e,!1,qs);n.user=!0,Ds?Ds.push(n):Oc(n)}function Nt(t,e,r){r=r?Object.assign({},Mh,r):Mh;const n=yp(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,Oc(n),Rb.bind(n)}function pS(t){return t&&typeof t=="object"&&"then"in t}function mS(t,e,r){let n,i,o;typeof e=="function"?(n=t,i=e,o={}):(n=!0,i=t,o=e||{});let s=null,l=um,c=!1,d="initialValue"in o,u=typeof n=="function"&&Nt(n);const h=new Set,[g,m]=(o.storage||Se)(o.initialValue),[S,N]=Se(void 0),[x,b]=Se(void 0,{equals:!1}),[K,te]=Se(d?"ready":"unresolved");function F(L,M,P,w){return s===L&&(s=null,w!==void 0&&(d=!0),(L===l||M===l)&&o.onHydrated&&queueMicrotask(()=>o.onHydrated(w,{value:M})),l=um,V(M,P)),M}function V(L,M){us(()=>{M===void 0&&m(()=>L),te(M!==void 0?"errored":d?"ready":"unresolved"),N(M);for(const P of h.keys())P.decrement();h.clear()},!1)}function W(){const L=fS,M=g(),P=S();if(P!==void 0&&!s)throw P;return Xr&&Xr.user,M}function I(L=!0){if(L!==!1&&c)return;c=!1;const M=u?u():n;if(M==null||M===!1){F(s,Ni(g));return}let P;const w=l!==um?l:Ni(()=>{try{return i(M,{value:g(),refetching:L})}catch(v){P=v}});if(P!==void 0){F(s,void 0,Ph(P),M);return}else if(!pS(w))return F(s,w,void 0,M),w;return s=w,"v"in w?(w.s===1?F(s,w.v,void 0,M):F(s,void 0,Ph(w.v),M),w):(c=!0,queueMicrotask(()=>c=!1),us(()=>{te(d?"refreshing":"pending"),b()},!1),w.then(v=>F(w,v,void 0,M),v=>F(w,void 0,Ph(v),M)))}Object.defineProperties(W,{state:{get:()=>K()},error:{get:()=>S()},loading:{get(){const L=K();return L==="pending"||L==="refreshing"}},latest:{get(){if(!d)return W();const L=S();if(L&&!s)throw L;return g()}}});let E=Vr;return u?hS(()=>(E=Vr,I(!1))):I(!1),[W,{refetch:L=>_f(E,()=>I(L)),mutate:m}]}function kb(t){return us(t,!1)}function Ni(t){if(Xr===null)return t();const e=Xr;Xr=null;try{return t()}finally{Xr=e}}function Pf(t,e,r){const n=Array.isArray(t);let i,o=r&&r.defer;return s=>{let l;if(n){l=Array(t.length);for(let d=0;d<t.length;d++)l[d]=t[d]()}else l=t();if(o)return o=!1,s;const c=Ni(()=>e(l,i,s));return i=l,c}}function Ln(t){Un(()=>Ni(t))}function Ll(t){return Vr===null||(Vr.cleanups===null?Vr.cleanups=[t]:Vr.cleanups.push(t)),t}function by(){return Xr}function Nb(){return Vr}function _f(t,e){const r=Vr,n=Xr;Vr=t,Xr=null;try{return us(e,!0)}catch(i){xf(i)}finally{Vr=r,Xr=n}}function yS(t){const e=Xr,r=Vr;return Promise.resolve().then(()=>{Xr=e,Vr=r;let n;return us(t,!1),Xr=Vr=null,n?n.done:void 0})}const[iB,oB]=Se(!1);function Lb(t,e){const r=Symbol("context");return{id:r,Provider:PS(r),defaultValue:t}}function Sf(t){let e;return Vr&&Vr.context&&(e=Vr.context[t.id])!==void 0?e:t.defaultValue}function wf(t){const e=Nt(t),r=Nt(()=>Py(e()));return r.toArray=()=>{const n=r();return Array.isArray(n)?n:n!=null?[n]:[]},r}let fS;function Rb(){if(this.sources&&this.state)if(this.state===qs)Oc(this);else{const t=_i;_i=null,us(()=>Bh(this),!1),_i=t}if(Xr){const t=this.observers?this.observers.length:0;Xr.sources?(Xr.sources.push(this),Xr.sourceSlots.push(t)):(Xr.sources=[this],Xr.sourceSlots=[t]),this.observers?(this.observers.push(Xr),this.observerSlots.push(Xr.sources.length-1)):(this.observers=[Xr],this.observerSlots=[Xr.sources.length-1])}return this.value}function Db(t,e,r){let n=t.value;return(!t.comparator||!t.comparator(n,e))&&(t.value=e,t.observers&&t.observers.length&&us(()=>{for(let i=0;i<t.observers.length;i+=1){const o=t.observers[i],s=hm&&hm.running;s&&hm.disposed.has(o),(s?!o.tState:!o.state)&&(o.pure?_i.push(o):Ds.push(o),o.observers&&Fb(o)),s||(o.state=qs)}if(_i.length>1e6)throw _i=[],new Error},!1)),e}function Oc(t){if(!t.fn)return;Ud(t);const e=mp;gS(t,t.value,e)}function gS(t,e,r){let n;const i=Vr,o=Xr;Xr=Vr=t;try{n=t.fn(e)}catch(s){return t.pure&&(t.state=qs,t.owned&&t.owned.forEach(Ud),t.owned=null),t.updatedAt=r+1,xf(s)}finally{Xr=o,Vr=i}(!t.updatedAt||t.updatedAt<=r)&&(t.updatedAt!=null&&"observers"in t?Db(t,n):t.value=n,t.updatedAt=r)}function yp(t,e,r,n=qs,i){const o={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:Vr,context:Vr?Vr.context:null,pure:r};return Vr===null||Vr!==Tb&&(Vr.owned?Vr.owned.push(o):Vr.owned=[o]),o}function Oh(t){if(t.state===0)return;if(t.state===Fh)return Bh(t);if(t.suspense&&Ni(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<mp);)t.state&&e.push(t);for(let r=e.length-1;r>=0;r--)if(t=e[r],t.state===qs)Oc(t);else if(t.state===Fh){const n=_i;_i=null,us(()=>Bh(t,e[0]),!1),_i=n}}function us(t,e){if(_i)return t();let r=!1;e||(_i=[]),Ds?r=!0:Ds=[],mp++;try{const n=t();return vS(r),n}catch(n){r||(Ds=null),_i=null,xf(n)}}function vS(t){if(_i&&(Mb(_i),_i=null),t)return;const e=Ds;Ds=null,e.length&&us(()=>Ib(e),!1)}function Mb(t){for(let e=0;e<t.length;e++)Oh(t[e])}function bS(t){let e,r=0;for(e=0;e<t.length;e++){const n=t[e];n.user?t[r++]=n:Oh(n)}for(e=0;e<r;e++)Oh(t[e])}function Bh(t,e){t.state=0;for(let r=0;r<t.sources.length;r+=1){const n=t.sources[r];if(n.sources){const i=n.state;i===qs?n!==e&&(!n.updatedAt||n.updatedAt<mp)&&Oh(n):i===Fh&&Bh(n,e)}}}function Fb(t){for(let e=0;e<t.observers.length;e+=1){const r=t.observers[e];r.state||(r.state=Fh,r.pure?_i.push(r):Ds.push(r),r.observers&&Fb(r))}}function Ud(t){let e;if(t.sources)for(;t.sources.length;){const r=t.sources.pop(),n=t.sourceSlots.pop(),i=r.observers;if(i&&i.length){const o=i.pop(),s=r.observerSlots.pop();n<i.length&&(o.sourceSlots[s]=n,i[n]=o,r.observerSlots[n]=s)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)Ud(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)Ud(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function Ph(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function xf(t,e=Vr){throw Ph(t)}function Py(t){if(typeof t=="function"&&!t.length)return Py(t());if(Array.isArray(t)){const e=[];for(let r=0;r<t.length;r++){const n=Py(t[r]);Array.isArray(n)?e.push.apply(e,n):e.push(n)}return e}return t}function PS(t,e){return function(n){let i;return ge(()=>i=Ni(()=>(Vr.context={...Vr.context,[t]:n.value},wf(()=>n.children))),void 0),i}}const _S=Symbol("fallback");function av(t){for(let e=0;e<t.length;e++)t[e]()}function SS(t,e,r={}){let n=[],i=[],o=[],s=0,l=e.length>1?[]:null;return Ll(()=>av(o)),()=>{let c=t()||[],d=c.length,u,h;return c[vy],Ni(()=>{let m,S,N,x,b,K,te,F,V;if(d===0)s!==0&&(av(o),o=[],n=[],i=[],s=0,l&&(l=[])),r.fallback&&(n=[_S],i[0]=kd(W=>(o[0]=W,r.fallback())),s=1);else if(s===0){for(i=new Array(d),h=0;h<d;h++)n[h]=c[h],i[h]=kd(g);s=d}else{for(N=new Array(d),x=new Array(d),l&&(b=new Array(d)),K=0,te=Math.min(s,d);K<te&&n[K]===c[K];K++);for(te=s-1,F=d-1;te>=K&&F>=K&&n[te]===c[F];te--,F--)N[F]=i[te],x[F]=o[te],l&&(b[F]=l[te]);for(m=new Map,S=new Array(F+1),h=F;h>=K;h--)V=c[h],u=m.get(V),S[h]=u===void 0?-1:u,m.set(V,h);for(u=K;u<=te;u++)V=n[u],h=m.get(V),h!==void 0&&h!==-1?(N[h]=i[u],x[h]=o[u],l&&(b[h]=l[u]),h=S[h],m.set(V,h)):o[u]();for(h=K;h<d;h++)h in N?(i[h]=N[h],o[h]=x[h],l&&(l[h]=b[h],l[h](h))):i[h]=kd(g);i=i.slice(0,s=d),n=c.slice(0)}return i});function g(m){if(o[h]=m,l){const[S,N]=Se(h);return l[h]=N,e(c[h],S)}return e(c[h])}}}function A(t,e){return Ni(()=>t(e||{}))}function Uu(){return!0}const _y={get(t,e,r){return e===Bo?r:t.get(e)},has(t,e){return e===Bo?!0:t.has(e)},set:Uu,deleteProperty:Uu,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:Uu,deleteProperty:Uu}},ownKeys(t){return t.keys()}};function pm(t){return(t=typeof t=="function"?t():t)?t:{}}function wS(){for(let t=0,e=this.length;t<e;++t){const r=this[t]();if(r!==void 0)return r}}function Sy(...t){let e=!1;for(let s=0;s<t.length;s++){const l=t[s];e=e||!!l&&Bo in l,t[s]=typeof l=="function"?(e=!0,Nt(l)):l}if(Eb&&e)return new Proxy({get(s){for(let l=t.length-1;l>=0;l--){const c=pm(t[l])[s];if(c!==void 0)return c}},has(s){for(let l=t.length-1;l>=0;l--)if(s in pm(t[l]))return!0;return!1},keys(){const s=[];for(let l=0;l<t.length;l++)s.push(...Object.keys(pm(t[l])));return[...new Set(s)]}},_y);const r={},n=Object.create(null);for(let s=t.length-1;s>=0;s--){const l=t[s];if(!l)continue;const c=Object.getOwnPropertyNames(l);for(let d=c.length-1;d>=0;d--){const u=c[d];if(u==="__proto__"||u==="constructor")continue;const h=Object.getOwnPropertyDescriptor(l,u);if(!n[u])n[u]=h.get?{enumerable:!0,configurable:!0,get:wS.bind(r[u]=[h.get.bind(l)])}:h.value!==void 0?h:void 0;else{const g=r[u];g&&(h.get?g.push(h.get.bind(l)):h.value!==void 0&&g.push(()=>h.value))}}}const i={},o=Object.keys(n);for(let s=o.length-1;s>=0;s--){const l=o[s],c=n[l];c&&c.get?Object.defineProperty(i,l,c):i[l]=c?c.value:void 0}return i}function xS(t,...e){if(Eb&&Bo in t){const i=new Set(e.length>1?e.flat():e[0]),o=e.map(s=>new Proxy({get(l){return s.includes(l)?t[l]:void 0},has(l){return s.includes(l)&&l in t},keys(){return s.filter(l=>l in t)}},_y));return o.push(new Proxy({get(s){return i.has(s)?void 0:t[s]},has(s){return i.has(s)?!1:s in t},keys(){return Object.keys(t).filter(s=>!i.has(s))}},_y)),o}const r={},n=e.map(()=>({}));for(const i of Object.getOwnPropertyNames(t)){const o=Object.getOwnPropertyDescriptor(t,i),s=!o.get&&!o.set&&o.enumerable&&o.writable&&o.configurable;let l=!1,c=0;for(const d of e)d.includes(i)&&(l=!0,s?n[c][i]=o.value:Object.defineProperty(n[c],i,o)),++c;l||(s?r[i]=o.value:Object.defineProperty(r,i,o))}return[...n,r]}const CS=t=>`Stale read from <${t}>.`;function vt(t){const e="fallback"in t&&{fallback:()=>t.fallback};return Nt(SS(()=>t.each,t.children,e||void 0))}function Me(t){const e=t.keyed,r=Nt(()=>t.when,void 0,void 0),n=e?r:Nt(r,void 0,{equals:(i,o)=>!i==!o});return Nt(()=>{const i=n();if(i){const o=t.children;return typeof o=="function"&&o.length>0?Ni(()=>o(e?i:()=>{if(!Ni(n))throw CS("Show");return r()})):o}return t.fallback},void 0,void 0)}const AS=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],$S=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline",...AS]),ES=new Set(["innerHTML","textContent","innerText","children"]),IS=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),TS=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function kS(t,e){const r=TS[t];return typeof r=="object"?r[e]?r.$:void 0:r}const NS=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),ke=t=>Nt(()=>t());function LS(t,e,r){let n=r.length,i=e.length,o=n,s=0,l=0,c=e[i-1].nextSibling,d=null;for(;s<i||l<o;){if(e[s]===r[l]){s++,l++;continue}for(;e[i-1]===r[o-1];)i--,o--;if(i===s){const u=o<n?l?r[l-1].nextSibling:r[o-l]:c;for(;l<o;)t.insertBefore(r[l++],u)}else if(o===l)for(;s<i;)(!d||!d.has(e[s]))&&e[s].remove(),s++;else if(e[s]===r[o-1]&&r[l]===e[i-1]){const u=e[--i].nextSibling;t.insertBefore(r[l++],e[s++].nextSibling),t.insertBefore(r[--o],u),e[i]=r[o]}else{if(!d){d=new Map;let h=l;for(;h<o;)d.set(r[h],h++)}const u=d.get(e[s]);if(u!=null)if(l<u&&u<o){let h=s,g=1,m;for(;++h<i&&h<o&&!((m=d.get(e[h]))==null||m!==u+g);)g++;if(g>u-l){const S=e[s];for(;l<u;)t.insertBefore(r[l++],S)}else t.replaceChild(r[l++],e[s++])}else s++;else e[s++].remove()}}}const lv="_$DX_DELEGATE";function RS(t,e,r,n={}){let i;return kd(o=>{i=o,e===document?t():a(e,t(),e.firstChild?null:void 0,r)},n.owner),()=>{i(),e.textContent=""}}function le(t,e,r,n){let i;const o=()=>{const l=n?document.createElementNS("http://www.w3.org/1998/Math/MathML","template"):document.createElement("template");return l.innerHTML=t,r?l.content.firstChild.firstChild:n?l.firstChild:l.content.firstChild},s=e?()=>Ni(()=>document.importNode(i||(i=o()),!0)):()=>(i||(i=o())).cloneNode(!0);return s.cloneNode=s,s}function Wt(t,e=window.document){const r=e[lv]||(e[lv]=new Set);for(let n=0,i=t.length;n<i;n++){const o=t[n];r.has(o)||(r.add(o),e.addEventListener(o,jS))}}function Jt(t,e,r){r==null?t.removeAttribute(e):t.setAttribute(e,r)}function DS(t,e,r){r?t.setAttribute(e,""):t.removeAttribute(e)}function fp(t,e){e==null?t.removeAttribute("class"):t.className=e}function Cn(t,e,r,n){if(n)Array.isArray(r)?(t[`$$${e}`]=r[0],t[`$$${e}Data`]=r[1]):t[`$$${e}`]=r;else if(Array.isArray(r)){const i=r[0];t.addEventListener(e,r[0]=o=>i.call(t,r[1],o))}else t.addEventListener(e,r,typeof r!="function"&&r)}function MS(t,e,r={}){const n=Object.keys(e||{}),i=Object.keys(r);let o,s;for(o=0,s=i.length;o<s;o++){const l=i[o];!l||l==="undefined"||e[l]||(cv(t,l,!1),delete r[l])}for(o=0,s=n.length;o<s;o++){const l=n[o],c=!!e[l];!l||l==="undefined"||r[l]===c||!c||(cv(t,l,!0),r[l]=c)}return r}function p(t,e,r){if(!e)return r?Jt(t,"style"):e;const n=t.style;if(typeof e=="string")return n.cssText=e;typeof r=="string"&&(n.cssText=r=void 0),r||(r={}),e||(e={});let i,o;for(o in r)e[o]==null&&n.removeProperty(o),delete r[o];for(o in e)i=e[o],i!==r[o]&&(n.setProperty(o,i),r[o]=i);return r}function FS(t,e={},r,n){const i={};return ge(()=>i.children=Hd(t,e.children,i.children)),ge(()=>typeof e.ref=="function"&&OS(e.ref,t)),ge(()=>BS(t,e,r,!0,i,!0)),i}function OS(t,e,r){return Ni(()=>t(e,r))}function a(t,e,r,n){if(r!==void 0&&!n&&(n=[]),typeof e!="function")return Hd(t,e,n,r);ge(i=>Hd(t,e(),i,r),n)}function BS(t,e,r,n,i={},o=!1){e||(e={});for(const s in i)if(!(s in e)){if(s==="children")continue;i[s]=dv(t,s,null,i[s],r,o,e)}for(const s in e){if(s==="children")continue;const l=e[s];i[s]=dv(t,s,l,i[s],r,o,e)}}function VS(t){return t.toLowerCase().replace(/-([a-z])/g,(e,r)=>r.toUpperCase())}function cv(t,e,r){const n=e.trim().split(/\s+/);for(let i=0,o=n.length;i<o;i++)t.classList.toggle(n[i],r)}function dv(t,e,r,n,i,o,s){let l,c,d,u,h;if(e==="style")return p(t,r,n);if(e==="classList")return MS(t,r,n);if(r===n)return n;if(e==="ref")o||r(t);else if(e.slice(0,3)==="on:"){const g=e.slice(3);n&&t.removeEventListener(g,n,typeof n!="function"&&n),r&&t.addEventListener(g,r,typeof r!="function"&&r)}else if(e.slice(0,10)==="oncapture:"){const g=e.slice(10);n&&t.removeEventListener(g,n,!0),r&&t.addEventListener(g,r,!0)}else if(e.slice(0,2)==="on"){const g=e.slice(2).toLowerCase(),m=NS.has(g);if(!m&&n){const S=Array.isArray(n)?n[0]:n;t.removeEventListener(g,S)}(m||r)&&(Cn(t,g,r,m),m&&Wt([g]))}else e.slice(0,5)==="attr:"?Jt(t,e.slice(5),r):e.slice(0,5)==="bool:"?DS(t,e.slice(5),r):(h=e.slice(0,5)==="prop:")||(d=ES.has(e))||(u=kS(e,t.tagName))||(c=$S.has(e))||(l=t.nodeName.includes("-")||"is"in s)?(h&&(e=e.slice(5),c=!0),e==="class"||e==="className"?fp(t,r):l&&!c&&!d?t[VS(e)]=r:t[u||e]=r):Jt(t,IS[e]||e,r);return r}function jS(t){let e=t.target;const r=`$$${t.type}`,n=t.target,i=t.currentTarget,o=c=>Object.defineProperty(t,"target",{configurable:!0,value:c}),s=()=>{const c=e[r];if(c&&!e.disabled){const d=e[`${r}Data`];if(d!==void 0?c.call(e,d,t):c.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&o(e.host),!0},l=()=>{for(;s()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const c=t.composedPath();o(c[0]);for(let d=0;d<c.length-2&&(e=c[d],!!s());d++){if(e._$host){e=e._$host,l();break}if(e.parentNode===i)break}}else l();o(n)}function Hd(t,e,r,n,i){for(;typeof r=="function";)r=r();if(e===r)return r;const o=typeof e,s=n!==void 0;if(t=s&&r[0]&&r[0].parentNode||t,o==="string"||o==="number"){if(o==="number"&&(e=e.toString(),e===r))return r;if(s){let l=r[0];l&&l.nodeType===3?l.data!==e&&(l.data=e):l=document.createTextNode(e),r=ic(t,r,n,l)}else r!==""&&typeof r=="string"?r=t.firstChild.data=e:r=t.textContent=e}else if(e==null||o==="boolean")r=ic(t,r,n);else{if(o==="function")return ge(()=>{let l=e();for(;typeof l=="function";)l=l();r=Hd(t,l,r,n)}),()=>r;if(Array.isArray(e)){const l=[],c=r&&Array.isArray(r);if(wy(l,e,r,i))return ge(()=>r=Hd(t,l,r,n,!0)),()=>r;if(l.length===0){if(r=ic(t,r,n),s)return r}else c?r.length===0?uv(t,l,n):LS(t,r,l):(r&&ic(t),uv(t,l));r=l}else if(e.nodeType){if(Array.isArray(r)){if(s)return r=ic(t,r,n,e);ic(t,r,null,e)}else r==null||r===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);r=e}}return r}function wy(t,e,r,n){let i=!1;for(let o=0,s=e.length;o<s;o++){let l=e[o],c=r&&r[t.length],d;if(!(l==null||l===!0||l===!1))if((d=typeof l)=="object"&&l.nodeType)t.push(l);else if(Array.isArray(l))i=wy(t,l,c)||i;else if(d==="function")if(n){for(;typeof l=="function";)l=l();i=wy(t,Array.isArray(l)?l:[l],Array.isArray(c)?c:[c])||i}else t.push(l),i=!0;else{const u=String(l);c&&c.nodeType===3&&c.data===u?t.push(c):t.push(document.createTextNode(u))}}return i}function uv(t,e,r=null){for(let n=0,i=e.length;n<i;n++)t.insertBefore(e[n],r)}function ic(t,e,r,n){if(r===void 0)return t.textContent="";const i=n||document.createTextNode("");if(e.length){let o=!1;for(let s=e.length-1;s>=0;s--){const l=e[s];if(i!==l){const c=l.parentNode===t;!o&&!s?c?t.replaceChild(i,l):t.insertBefore(i,r):c&&l.remove()}else o=!0}}else t.insertBefore(i,r);return[i]}const zS=!1;function Ob(){let t=new Set;function e(i){return t.add(i),()=>t.delete(i)}let r=!1;function n(i,o){if(r)return!(r=!1);const s={to:i,options:o,defaultPrevented:!1,preventDefault:()=>s.defaultPrevented=!0};for(const l of t)l.listener({...s,from:l.location,retry:c=>{c&&(r=!0),l.navigate(i,{...o,resolve:!1})}});return!s.defaultPrevented}return{subscribe:e,confirm:n}}let xy;function Cf(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),xy=window.history.state._depth}Cf();function qS(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function US(t,e){let r=!1;return()=>{const n=xy;Cf();const i=n==null?null:xy-n;if(r){r=!1;return}i&&e(i)?(r=!0,window.history.go(-i)):t()}}const HS=/^(?:[a-z0-9]+:)?\/\//i,GS=/^\/+|(\/)\/+$/g,Bb="http://sr";function _l(t,e=!1){const r=t.replace(GS,"$1");return r?e||/^[?#]/.test(r)?r:"/"+r:""}function _h(t,e,r){if(HS.test(e))return;const n=_l(t),i=r&&_l(r);let o="";return!i||e.startsWith("/")?o=n:i.toLowerCase().indexOf(n.toLowerCase())!==0?o=n+i:o=i,(o||"/")+_l(e,!o)}function WS(t,e){if(t==null)throw new Error(e);return t}function YS(t,e){return _l(t).replace(/\/*(\*.*)?$/g,"")+_l(e)}function Vb(t){const e={};return t.searchParams.forEach((r,n)=>{n in e?Array.isArray(e[n])?e[n].push(r):e[n]=[e[n],r]:e[n]=r}),e}function KS(t,e,r){const[n,i]=t.split("/*",2),o=n.split("/").filter(Boolean),s=o.length;return l=>{const c=l.split("/").filter(Boolean),d=c.length-s;if(d<0||d>0&&i===void 0&&!e)return null;const u={path:s?"":"/",params:{}},h=g=>r===void 0?void 0:r[g];for(let g=0;g<s;g++){const m=o[g],S=m[0]===":",N=S?c[g]:c[g].toLowerCase(),x=S?m.slice(1):m.toLowerCase();if(S&&mm(N,h(x)))u.params[x]=N;else if(S||!mm(N,x))return null;u.path+=`/${N}`}if(i){const g=d?c.slice(-d).join("/"):"";if(mm(g,h(i)))u.params[i]=g;else return null}return u}}function mm(t,e){const r=n=>n===t;return e===void 0?!0:typeof e=="string"?r(e):typeof e=="function"?e(t):Array.isArray(e)?e.some(r):e instanceof RegExp?e.test(t):!1}function QS(t){const[e,r]=t.pattern.split("/*",2),n=e.split("/").filter(Boolean);return n.reduce((i,o)=>i+(o.startsWith(":")?2:3),n.length-(r===void 0?0:1))}function jb(t){const e=new Map,r=Nb();return new Proxy({},{get(n,i){return e.has(i)||_f(r,()=>e.set(i,Nt(()=>t()[i]))),e.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function zb(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let r=t.slice(0,e.index),n=t.slice(e.index+e[0].length);const i=[r,r+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(n);)i.push(r+=e[1]),n=n.slice(e[0].length);return zb(n).reduce((o,s)=>[...o,...i.map(l=>l+s)],[])}const JS=100,qb=Lb(),Af=Lb(),au=()=>WS(Sf(qb),"<A> and 'use' router primitives can be only used inside a Route."),XS=()=>Sf(Af)||au().base,ZS=t=>{const e=XS();return Nt(()=>e.resolvePath(t()))},ew=t=>{const e=au();return Nt(()=>{const r=t();return r!==void 0?e.renderPath(r):r})},$f=()=>au().navigatorFactory(),tw=()=>au().location,rw=()=>au().params;function nw(t,e=""){const{component:r,preload:n,load:i,children:o,info:s}=t,l=!o||Array.isArray(o)&&!o.length,c={key:t,component:r,preload:n||i,info:s};return Ub(t.path).reduce((d,u)=>{for(const h of zb(u)){const g=YS(e,h);let m=l?g:g.split("/*",1)[0];m=m.split("/").map(S=>S.startsWith(":")||S.startsWith("*")?S:encodeURIComponent(S)).join("/"),d.push({...c,originalPath:u,pattern:m,matcher:KS(m,!l,t.matchFilters)})}return d},[])}function iw(t,e=0){return{routes:t,score:QS(t[t.length-1])*1e4-e,matcher(r){const n=[];for(let i=t.length-1;i>=0;i--){const o=t[i],s=o.matcher(r);if(!s)return null;n.unshift({...s,route:o})}return n}}}function Ub(t){return Array.isArray(t)?t:[t]}function Hb(t,e="",r=[],n=[]){const i=Ub(t);for(let o=0,s=i.length;o<s;o++){const l=i[o];if(l&&typeof l=="object"){l.hasOwnProperty("path")||(l.path="");const c=nw(l,e);for(const d of c){r.push(d);const u=Array.isArray(l.children)&&l.children.length===0;if(l.children&&!u)Hb(l.children,d.pattern,r,n);else{const h=iw([...r],n.length);n.push(h)}r.pop()}}}return r.length?n:n.sort((o,s)=>s.score-o.score)}function ym(t,e){for(let r=0,n=t.length;r<n;r++){const i=t[r].matcher(e);if(i)return i}return[]}function ow(t,e,r){const n=new URL(Bb),i=Nt(u=>{const h=t();try{return new URL(h,n)}catch{return console.error(`Invalid path ${h}`),u}},n,{equals:(u,h)=>u.href===h.href}),o=Nt(()=>i().pathname),s=Nt(()=>i().search,!0),l=Nt(()=>i().hash),c=()=>"",d=Pf(s,()=>Vb(i()));return{get pathname(){return o()},get search(){return s()},get hash(){return l()},get state(){return e()},get key(){return c()},query:r?r(d):jb(d)}}let pl;function sw(){return pl}function aw(t,e,r,n={}){const{signal:[i,o],utils:s={}}=t,l=s.parsePath||(j=>j),c=s.renderPath||(j=>j),d=s.beforeLeave||Ob(),u=_h("",n.base||"");if(u===void 0)throw new Error(`${u} is not a valid base path`);u&&!i().value&&o({value:u,replace:!0,scroll:!1});const[h,g]=Se(!1);let m;const S=(j,z)=>{z.value===N()&&z.state===b()||(m===void 0&&g(!0),pl=j,m=z,yS(()=>{m===z&&(x(m.value),K(m.state),V[1](T=>T.filter(R=>R.pending)))}).finally(()=>{m===z&&kb(()=>{pl=void 0,j==="navigate"&&w(m),g(!1),m=void 0})}))},[N,x]=Se(i().value),[b,K]=Se(i().state),te=ow(N,b,s.queryWrapper),F=[],V=Se([]),W=Nt(()=>typeof n.transformUrl=="function"?ym(e(),n.transformUrl(te.pathname)):ym(e(),te.pathname)),I=()=>{const j=W(),z={};for(let T=0;T<j.length;T++)Object.assign(z,j[T].params);return z},E=s.paramsWrapper?s.paramsWrapper(I,e):jb(I),L={pattern:u,path:()=>u,outlet:()=>null,resolvePath(j){return _h(u,j)}};return ge(Pf(i,j=>S("native",j),{defer:!0})),{base:L,location:te,params:E,isRouting:h,renderPath:c,parsePath:l,navigatorFactory:P,matches:W,beforeLeave:d,preloadRoute:v,singleFlight:n.singleFlight===void 0?!0:n.singleFlight,submissions:V};function M(j,z,T){Ni(()=>{if(typeof z=="number"){z&&(s.go?s.go(z):console.warn("Router integration does not support relative routing"));return}const R=!z||z[0]==="?",{replace:J,resolve:X,scroll:H,state:se}={replace:!1,resolve:!R,scroll:!0,...T},O=X?j.resolvePath(z):_h(R&&te.pathname||"",z);if(O===void 0)throw new Error(`Path '${z}' is not a routable path`);if(F.length>=JS)throw new Error("Too many redirects");const _=N();(O!==_||se!==b())&&(zS||d.confirm(O,T)&&(F.push({value:_,replace:J,scroll:H,state:b()}),S("navigate",{value:O,state:se})))})}function P(j){return j=j||Sf(Af)||L,(z,T)=>M(j,z,T)}function w(j){const z=F[0];z&&(o({...j,replace:z.replace,scroll:z.scroll}),F.length=0)}function v(j,z){const T=ym(e(),j.pathname),R=pl;pl="preload";for(let J in T){const{route:X,params:H}=T[J];X.component&&X.component.preload&&X.component.preload();const{preload:se}=X;z&&se&&_f(r(),()=>se({params:H,location:{pathname:j.pathname,search:j.search,hash:j.hash,query:Vb(j),state:null,key:""},intent:"preload"}))}pl=R}}function lw(t,e,r,n){const{base:i,location:o,params:s}=t,{pattern:l,component:c,preload:d}=n().route,u=Nt(()=>n().path);c&&c.preload&&c.preload();const h=d?d({params:s,location:o,intent:pl||"initial"}):void 0;return{parent:e,pattern:l,path:u,outlet:()=>c?A(c,{params:s,location:o,data:h,get children(){return r()}}):r(),resolvePath(m){return _h(i.path(),m,u())}}}const cw=t=>e=>{const{base:r}=e,n=wf(()=>e.children),i=Nt(()=>Hb(n(),e.base||""));let o;const s=aw(t,i,()=>o,{base:r,singleFlight:e.singleFlight,transformUrl:e.transformUrl});return t.create&&t.create(s),A(qb.Provider,{value:s,get children(){return A(dw,{routerState:s,get root(){return e.root},get preload(){return e.rootPreload||e.rootLoad},get children(){return[ke(()=>(o=Nb())&&null),A(uw,{routerState:s,get branches(){return i()}})]}})}})};function dw(t){const e=t.routerState.location,r=t.routerState.params,n=Nt(()=>t.preload&&Ni(()=>{t.preload({params:r,location:e,intent:sw()||"initial"})}));return A(Me,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:i=>A(i,{params:r,location:e,get data(){return n()},get children(){return t.children}})})}function uw(t){const e=[];let r;const n=Nt(Pf(t.routerState.matches,(i,o,s)=>{let l=o&&i.length===o.length;const c=[];for(let d=0,u=i.length;d<u;d++){const h=o&&o[d],g=i[d];s&&h&&g.route.key===h.route.key?c[d]=s[d]:(l=!1,e[d]&&e[d](),kd(m=>{e[d]=m,c[d]=lw(t.routerState,c[d-1]||t.routerState.base,hv(()=>n()[d+1]),()=>t.routerState.matches()[d])}))}return e.splice(i.length).forEach(d=>d()),s&&l?s:(r=c[0],c)}));return hv(()=>n()&&r)()}const hv=t=>()=>A(Me,{get when(){return t()},keyed:!0,children:e=>A(Af.Provider,{value:e,get children(){return e.outlet()}})}),$i=t=>{const e=wf(()=>t.children);return Sy(t,{get children(){return e()}})};function hw([t,e],r,n){return[t,n?i=>e(n(i)):e]}function pw(t){let e=!1;const r=i=>typeof i=="string"?{value:i}:i,n=hw(Se(r(t.get()),{equals:(i,o)=>i.value===o.value&&i.state===o.state}),void 0,i=>(!e&&t.set(i),i));return t.init&&Ll(t.init((i=t.get())=>{e=!0,n[1](r(i)),e=!1})),cw({signal:n,create:t.create,utils:t.utils})}function mw(t,e,r){return t.addEventListener(e,r),()=>t.removeEventListener(e,r)}function yw(t,e){const r=t&&document.getElementById(t);r?r.scrollIntoView():e&&window.scrollTo(0,0)}const fw=new Map;function gw(t=!0,e=!1,r="/_server",n){return i=>{const o=i.base.path(),s=i.navigatorFactory(i.base);let l,c;function d(N){return N.namespaceURI==="http://www.w3.org/2000/svg"}function u(N){if(N.defaultPrevented||N.button!==0||N.metaKey||N.altKey||N.ctrlKey||N.shiftKey)return;const x=N.composedPath().find(W=>W instanceof Node&&W.nodeName.toUpperCase()==="A");if(!x||e&&!x.hasAttribute("link"))return;const b=d(x),K=b?x.href.baseVal:x.href;if((b?x.target.baseVal:x.target)||!K&&!x.hasAttribute("state"))return;const F=(x.getAttribute("rel")||"").split(/\s+/);if(x.hasAttribute("download")||F&&F.includes("external"))return;const V=b?new URL(K,document.baseURI):new URL(K);if(!(V.origin!==window.location.origin||o&&V.pathname&&!V.pathname.toLowerCase().startsWith(o.toLowerCase())))return[x,V]}function h(N){const x=u(N);if(!x)return;const[b,K]=x,te=i.parsePath(K.pathname+K.search+K.hash),F=b.getAttribute("state");N.preventDefault(),s(te,{resolve:!1,replace:b.hasAttribute("replace"),scroll:!b.hasAttribute("noscroll"),state:F?JSON.parse(F):void 0})}function g(N){const x=u(N);if(!x)return;const[b,K]=x;i.preloadRoute(K,b.getAttribute("preload")!=="false")}function m(N){clearTimeout(l);const x=u(N);if(!x)return c=null;const[b,K]=x;c!==b&&(l=setTimeout(()=>{i.preloadRoute(K,b.getAttribute("preload")!=="false"),c=b},20))}function S(N){if(N.defaultPrevented)return;let x=N.submitter&&N.submitter.hasAttribute("formaction")?N.submitter.getAttribute("formaction"):N.target.getAttribute("action");if(!x)return;if(!x.startsWith("https://action/")){const K=new URL(x,Bb);if(x=i.parsePath(K.pathname+K.search),!x.startsWith(r))return}if(N.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const b=fw.get(x);if(b){N.preventDefault();const K=new FormData(N.target,N.submitter);b.call({r:i,f:N.target},N.target.enctype==="multipart/form-data"?K:new URLSearchParams(K))}}Wt(["click","submit"]),document.addEventListener("click",h),t&&(document.addEventListener("mousemove",m,{passive:!0}),document.addEventListener("focusin",g,{passive:!0}),document.addEventListener("touchstart",g,{passive:!0})),document.addEventListener("submit",S),Ll(()=>{document.removeEventListener("click",h),t&&(document.removeEventListener("mousemove",m),document.removeEventListener("focusin",g),document.removeEventListener("touchstart",g)),document.removeEventListener("submit",S)})}}function vw(t){const e=t.replace(/^.*?#/,"");if(!e.startsWith("/")){const[,r="/"]=window.location.hash.split("#",2);return`${r}#${e}`}return e}function bw(t){const e=()=>window.location.hash.slice(1),r=Ob();return pw({get:e,set({value:n,replace:i,scroll:o,state:s}){i?window.history.replaceState(qS(s),"","#"+n):window.history.pushState(s,"","#"+n);const l=n.indexOf("#"),c=l>=0?n.slice(l+1):"";yw(c,o),Cf()},init:n=>mw(window,"hashchange",US(n,i=>!r.confirm(i&&i<0?i:e()))),create:gw(t.preload,t.explicitLinks,t.actionBase),utils:{go:n=>window.history.go(n),renderPath:n=>`#${n}`,parsePath:vw,beforeLeave:r}})(t)}var Pw=le("<a>");function hc(t){t=Sy({inactiveClass:"inactive",activeClass:"active"},t);const[,e]=xS(t,["href","state","class","activeClass","inactiveClass","end"]),r=ZS(()=>t.href),n=ew(r),i=tw(),o=Nt(()=>{const s=r();if(s===void 0)return[!1,!1];const l=_l(s.split(/[?#]/,1)[0]).toLowerCase(),c=decodeURI(_l(i.pathname).toLowerCase());return[t.end?l===c:c.startsWith(l+"/")||c===l,l===c]});return(()=>{var s=Pw();return FS(s,Sy(e,{get href(){return n()||t.href},get state(){return JSON.stringify(t.state)},get classList(){return{...t.class&&{[t.class]:!0},[t.inactiveClass]:!o()[0],[t.activeClass]:o()[0],...e.classList}},link:"",get"aria-current"(){return o()[1]?"page":void 0}}),!1),s})()}const Cy=Symbol("store-raw"),bc=Symbol("store-node"),ks=Symbol("store-has"),Gb=Symbol("store-self");function Wb(t){let e=t[Bo];if(!e&&(Object.defineProperty(t,Bo,{value:e=new Proxy(t,ww)}),!Array.isArray(t))){const r=Object.keys(t),n=Object.getOwnPropertyDescriptors(t);for(let i=0,o=r.length;i<o;i++){const s=r[i];n[s].get&&Object.defineProperty(t,s,{enumerable:n[s].enumerable,get:n[s].get.bind(e)})}}return e}function Vh(t){let e;return t!=null&&typeof t=="object"&&(t[Bo]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function Gd(t,e=new Set){let r,n,i,o;if(r=t!=null&&t[Cy])return r;if(!Vh(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let s=0,l=t.length;s<l;s++)i=t[s],(n=Gd(i,e))!==i&&(t[s]=n)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const s=Object.keys(t),l=Object.getOwnPropertyDescriptors(t);for(let c=0,d=s.length;c<d;c++)o=s[c],!l[o].get&&(i=t[o],(n=Gd(i,e))!==i&&(t[o]=n))}return t}function jh(t,e){let r=t[e];return r||Object.defineProperty(t,e,{value:r=Object.create(null)}),r}function Wd(t,e,r){if(t[e])return t[e];const[n,i]=Se(r,{equals:!1,internal:!0});return n.$=i,t[e]=n}function _w(t,e){const r=Reflect.getOwnPropertyDescriptor(t,e);return!r||r.get||!r.configurable||e===Bo||e===bc||(delete r.value,delete r.writable,r.get=()=>t[Bo][e]),r}function Yb(t){by()&&Wd(jh(t,bc),Gb)()}function Sw(t){return Yb(t),Reflect.ownKeys(t)}const ww={get(t,e,r){if(e===Cy)return t;if(e===Bo)return r;if(e===vy)return Yb(t),r;const n=jh(t,bc),i=n[e];let o=i?i():t[e];if(e===bc||e===ks||e==="__proto__")return o;if(!i){const s=Object.getOwnPropertyDescriptor(t,e);by()&&(typeof o!="function"||t.hasOwnProperty(e))&&!(s&&s.get)&&(o=Wd(n,e,o)())}return Vh(o)?Wb(o):o},has(t,e){return e===Cy||e===Bo||e===vy||e===bc||e===ks||e==="__proto__"?!0:(by()&&Wd(jh(t,ks),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:Sw,getOwnPropertyDescriptor:_w};function zh(t,e,r,n=!1){if(!n&&t[e]===r)return;const i=t[e],o=t.length;r===void 0?(delete t[e],t[ks]&&t[ks][e]&&i!==void 0&&t[ks][e].$()):(t[e]=r,t[ks]&&t[ks][e]&&i===void 0&&t[ks][e].$());let s=jh(t,bc),l;if((l=Wd(s,e,i))&&l.$(()=>r),Array.isArray(t)&&t.length!==o){for(let c=t.length;c<o;c++)(l=s[c])&&l.$();(l=Wd(s,"length",o))&&l.$(t.length)}(l=s[Gb])&&l.$()}function Kb(t,e){const r=Object.keys(e);for(let n=0;n<r.length;n+=1){const i=r[n];zh(t,i,e[i])}}function xw(t,e){if(typeof e=="function"&&(e=e(t)),e=Gd(e),Array.isArray(e)){if(t===e)return;let r=0,n=e.length;for(;r<n;r++){const i=e[r];t[r]!==i&&zh(t,r,i)}zh(t,"length",n)}else Kb(t,e)}function Sd(t,e,r=[]){let n,i=t;if(e.length>1){n=e.shift();const s=typeof n,l=Array.isArray(t);if(Array.isArray(n)){for(let c=0;c<n.length;c++)Sd(t,[n[c]].concat(e),r);return}else if(l&&s==="function"){for(let c=0;c<t.length;c++)n(t[c],c)&&Sd(t,[c].concat(e),r);return}else if(l&&s==="object"){const{from:c=0,to:d=t.length-1,by:u=1}=n;for(let h=c;h<=d;h+=u)Sd(t,[h].concat(e),r);return}else if(e.length>1){Sd(t[n],e,[n].concat(r));return}i=t[n],r=[n].concat(r)}let o=e[0];typeof o=="function"&&(o=o(i,r),o===i)||n===void 0&&o==null||(o=Gd(o),n===void 0||Vh(i)&&Vh(o)&&!Array.isArray(o)?Kb(i,o):zh(t,n,o))}function Bc(...[t,e]){const r=Gd(t||{}),n=Array.isArray(r),i=Wb(r);function o(...s){kb(()=>{n&&s.length===1?xw(r,s[0]):Sd(r,s)})}return[i,o]}const Ar=(t=300+Math.random()*700)=>new Promise(e=>setTimeout(e,t)),As=(t="")=>`${t}${Date.now()}-${Math.random().toString(36).substr(2,9)}`,Ef=(t,e)=>e.split(".").reduce((r,n)=>r?.[n],t),fm=(t,e)=>t.replace(/\{([^}]+)\}/g,(r,n)=>{const i=Ef(e,n);return String(i||r)}),Cw=(t,e)=>{try{if(!isNaN(Number(t)))return Number(t);const r=Ef(e,t);return Number(r)||0}catch{return 0}};let Ft={products:[{id:"prod-001",name:"Wireless Headphones",sku:"WH-001",productCode:"WH-001",productName:"Wireless Headphones",description:"High-quality wireless bluetooth headphones",category:"Electronics",unitOfMeasure:"pcs",unitCost:45,sellingPrice:89.99,minStockLevel:10,maxStockLevel:100,isActive:!0,createdDate:"2024-01-15T10:00:00Z",lastModified:"2024-01-15T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-002",name:"USB-C Cable",sku:"USB-001",description:"3ft USB-C charging cable",category:"Accessories",unitOfMeasure:"pcs",unitCost:8.5,sellingPrice:19.99,minStockLevel:25,maxStockLevel:200,isActive:!0,createdDate:"2024-01-16T10:00:00Z",lastModified:"2024-01-16T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-003",name:"Laptop Stand",sku:"LS-001",description:"Adjustable aluminum laptop stand",category:"Office",unitOfMeasure:"pcs",unitCost:25,sellingPrice:49.99,minStockLevel:5,maxStockLevel:50,isActive:!0,createdDate:"2024-01-17T10:00:00Z",lastModified:"2024-01-17T10:00:00Z",businessId:"YB100423253156428"}],locations:[{id:"loc-001",name:"Main Warehouse",code:"WH-001",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-002",name:"Retail Store - Downtown",code:"ST-001",type:"store",address:"456 Main St, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-003",name:"Retail Store - Mall",code:"ST-002",type:"store",address:"789 Mall Blvd, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"}],movements:[{id:"mov-001",productId:"prod-001",productName:"Wireless Headphones",productSku:"WH-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:50,unitCost:45,totalCost:2250,referenceNumber:"PO-001",notes:"Initial stock purchase",createdBy:"admin",createdDate:"2024-01-15T10:00:00Z",invoiceId:"INV-1000001"},{id:"mov-002",productId:"prod-002",productName:"USB-C Cable",productSku:"USB-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:100,unitCost:8.5,totalCost:850,referenceNumber:"PO-001",notes:"Bulk purchase",createdBy:"admin",createdDate:"2024-01-15T10:05:00Z",invoiceId:"INV-1000001"}],accounts:[{id:"acc-001",accountNumber:"1000",accountName:"Cash",accountType:"asset",category:"currentAssets",balance:5e4,parentAccountId:null,description:"Cash and cash equivalents",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"},{id:"acc-002",accountNumber:"1100",accountName:"Accounts Receivable",accountType:"asset",category:"currentAssets",balance:25e3,parentAccountId:null,description:"Money owed by customers",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"}],journalEntries:[{id:"je-001",entryNumber:"JE-001",date:"2024-01-15",description:"Initial cash deposit",reference:"DEP-001",status:"posted",createdBy:"admin",createdAt:"2024-01-15T10:00:00Z",postedAt:"2024-01-15T10:05:00Z",lines:[{id:"jel-001",accountId:"acc-001",accountName:"Cash",description:"Initial deposit",debitAmount:5e4,creditAmount:0},{id:"jel-002",accountId:"acc-003",accountName:"Owner Equity",description:"Initial capital",debitAmount:0,creditAmount:5e4}]}],eventRules:[{id:"rule-001",name:"Auto-post completed invoices",description:"Automatically create journal entries for completed invoices",eventType:"invoice_completed",conditions:[{field:"data.isCompleted",operator:"equals",value:!0,dataType:"boolean"},{field:"data.total",operator:"greaterThan",value:0,dataType:"number"}],journalEntryTemplate:{description:"Invoice {data.invoice} - {data.shipper_consignee.name}",reference:"{data.invoice}",lines:[{accountExpression:"1101",descriptionTemplate:"Invoice {data.invoice} - Customer: {data.shipper_consignee.name}",amountExpression:"data.total",isDebit:!0},{accountExpression:"4001",descriptionTemplate:"Sales revenue for invoice {data.invoice}",amountExpression:"data.productSubtotal",isDebit:!1},{accountExpression:"4201",descriptionTemplate:"Transport services",amountExpression:"data.serviceSubtotal",isDebit:!1},{accountExpression:"2301",descriptionTemplate:"Sales tax",amountExpression:"data.taxAmount",isDebit:!1}]},isActive:!0,priority:100,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01"),businessId:"YB100423253156428"},{id:"rule-002",name:"Record cash payments",description:"Create journal entries for cash payments received",eventType:"payment_received",conditions:[{field:"data.paymentMethod",operator:"equals",value:"cash",dataType:"string"}],journalEntryTemplate:{description:"Payment received - {data.customerName}",reference:"{data.reference}",lines:[{accountExpression:"1001",descriptionTemplate:"Cash payment from {data.customerName}",amountExpression:"data.amount",isDebit:!0},{accountExpression:"1101",descriptionTemplate:"Payment for invoice {data.invoiceId}",amountExpression:"data.amount",isDebit:!1}]},isActive:!0,priority:90,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01"),businessId:"YB100423253156428"}],eventRuleHistory:[]};const vn=(t=.05)=>Math.random()<t,bn=()=>{const t=["Network timeout","Connection refused","Server temporarily unavailable","Invalid request"];throw new Error(t[Math.floor(Math.random()*t.length)])},cn={products:{async getAll(t,e){await Ar(),vn()&&bn();let r=[...Ft.products];if(t&&t.trim()){const n=t.toLowerCase();r=r.filter(i=>i.name.toLowerCase().includes(n)||i.sku.toLowerCase().includes(n)||i.category.toLowerCase().includes(n)||i.description.toLowerCase().includes(n))}return e?.category&&(r=r.filter(n=>n.category===e.category)),e?.isActive!==void 0&&(r=r.filter(n=>n.isActive===e.isActive)),r},async getById(t){return await Ar(),vn()&&bn(),Ft.products.find(e=>e.id===t)||null},async create(t){if(await Ar(),vn()&&bn(),Ft.products.some(r=>r.sku===t.sku))throw new Error("SKU already exists");const e={...t,id:As("prod-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return Ft.products.push(e),e},async update(t,e){await Ar(),vn()&&bn();const r=Ft.products.findIndex(i=>i.id===t);if(r===-1)throw new Error("Product not found");if(e.sku&&Ft.products.some(i=>i.id!==t&&i.sku===e.sku))throw new Error("SKU already exists");const n={...Ft.products[r],...e,lastModified:new Date().toISOString()};return Ft.products[r]=n,n},async delete(t){await Ar(),vn()&&bn();const e=Ft.products.findIndex(n=>n.id===t);if(e===-1)throw new Error("Product not found");return Ft.movements.some(n=>n.productId===t)?{success:!1,message:"Cannot delete product with existing movements"}:(Ft.products.splice(e,1),{success:!0,message:"Product deleted successfully"})}},locations:{async getAll(t){await Ar(),vn()&&bn();let e=[...Ft.locations];return t?.type&&(e=e.filter(r=>r.type===t.type)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Ar(),Ft.locations.find(e=>e.id===t)||null},async create(t){if(await Ar(),vn()&&bn(),Ft.locations.some(r=>r.code===t.code))throw new Error("Location code already exists");const e={...t,id:As("loc-"),createdDate:new Date().toISOString()};return Ft.locations.push(e),e},async update(t,e){await Ar(),vn()&&bn();const r=Ft.locations.findIndex(n=>n.id===t);if(r===-1)throw new Error("Location not found");if(e.code&&Ft.locations.some(n=>n.id!==t&&n.code===e.code))throw new Error("Location code already exists");return Ft.locations[r]={...Ft.locations[r],...e},Ft.locations[r]}},movements:{async getAll(t){await Ar(),vn()&&bn();let e=[...Ft.movements];if(t?.productId&&(e=e.filter(r=>r.productId===t.productId)),t?.locationId&&(e=e.filter(r=>r.locationId===t.locationId)),t?.movementType&&(e=e.filter(r=>r.movementType===t.movementType)),t?.dateFrom&&(e=e.filter(r=>r.createdDate>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.createdDate<=t.dateTo)),t?.search){const r=t.search.toLowerCase();e=e.filter(n=>n.productName.toLowerCase().includes(r)||n.productSku.toLowerCase().includes(r)||n.referenceNumber.toLowerCase().includes(r)||n.notes.toLowerCase().includes(r))}return e.sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime()),e},async getById(t){return await Ar(),Ft.movements.find(e=>e.id===t)||null},async create(t){if(await Ar(),vn()&&bn(),!Ft.products.find(i=>i.id===t.productId))throw new Error("Product not found");if(!Ft.locations.find(i=>i.id===t.locationId))throw new Error("Location not found");if(t.movementType==="out"){const i=await this.getStockLevel(t.productId,t.locationId);if(i<t.quantity)throw new Error(`Insufficient stock. Available: ${i}, Requested: ${t.quantity}`)}const n={...t,id:As("mov-"),createdDate:new Date().toISOString()};return Ft.movements.push(n),n},async update(t,e){await Ar(),vn()&&bn();const r=Ft.movements.findIndex(i=>i.id===t);if(r===-1)throw new Error("Movement not found");const n={...Ft.movements[r],...e,lastModified:new Date().toISOString()};return Ft.movements[r]=n,n},async delete(t){await Ar(),vn()&&bn();const e=Ft.movements.findIndex(r=>r.id===t);if(e===-1)throw new Error("Movement not found");return Ft.movements.splice(e,1),{success:!0,message:"Movement deleted successfully"}},async createBulk(t){await Ar(),vn()&&bn();const e=[],r=[],n=new Date().toISOString(),i=Ft.locations.find(o=>o.id===t.locationId);if(!i)return{success:!1,movements:[],errors:["Invalid location"]};for(let o=0;o<t.items.length;o++){const s=t.items[o],l=Ft.products.find(u=>u.id===s.productId);if(!l){e.push(`Item ${o+1}: Product not found`);continue}if(s.quantity<=0){e.push(`Item ${o+1}: Quantity must be greater than 0`);continue}if(t.movementType==="out"){const u=await this.getStockLevel(s.productId,t.locationId);if(s.quantity>u){e.push(`Item ${o+1}: Insufficient stock. Available: ${u}, Requested: ${s.quantity}`);continue}}const c=s.unitCost||l.unitCost,d={id:As("mov-"),productId:l.id,productName:l.name,productSku:l.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:s.quantity,unitCost:c,totalCost:s.quantity*c,referenceNumber:t.referenceNumber,notes:s.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:t.fromLocationId?Ft.locations.find(u=>u.id===t.fromLocationId)?.name:void 0};r.push(d)}return e.length>0?{success:!1,movements:[],errors:e}:(Ft.movements.push(...r),{success:!0,movements:r,errors:[]})},async getStockLevel(t,e){return await Ar(50),Ft.movements.filter(r=>r.productId===t&&r.locationId===e).reduce((r,n)=>{switch(n.movementType){case"in":case"adjustment":return r+n.quantity;case"out":return r-n.quantity;case"transfer":return n.locationId===e?r+n.quantity:r;default:return r}},0)},async getStockLevels(){await Ar();const t=new Map;for(const e of Ft.movements){const r=`${e.productId}-${e.locationId}`;let n=t.get(r);switch(n||(n={id:r,productId:e.productId,locationId:e.locationId,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType){case"in":case"adjustment":n.quantity+=e.quantity;break;case"out":n.quantity-=e.quantity;break;case"transfer":e.locationId===e.locationId&&(n.quantity+=e.quantity);break}new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost,n.availableQuantity=n.quantity-n.reservedQuantity}return Array.from(t.values())}},accounts:{async getAll(t){await Ar(),vn()&&bn();let e=[...Ft.accounts];return t?.accountType&&(e=e.filter(r=>r.accountType===t.accountType)),t?.category&&(e=e.filter(r=>r.category===t.category)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Ar(),Ft.accounts.find(e=>e.id===t)||null},async create(t){if(await Ar(),vn()&&bn(),Ft.accounts.some(r=>r.accountNumber===t.accountNumber))throw new Error("Account number already exists");const e={...t,id:As("acc-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return Ft.accounts.push(e),e},async update(t,e){await Ar(),vn()&&bn();const r=Ft.accounts.findIndex(n=>n.id===t);if(r===-1)throw new Error("Account not found");if(e.accountNumber&&Ft.accounts.some(n=>n.id!==t&&n.accountNumber===e.accountNumber))throw new Error("Account number already exists");return Ft.accounts[r]={...Ft.accounts[r],...e,lastModified:new Date().toISOString()},Ft.accounts[r]}},journal:{async getAll(t){await Ar(),vn()&&bn();let e=[...Ft.journalEntries];return t?.status&&(e=e.filter(r=>r.status===t.status)),t?.accountId&&(e=e.filter(r=>r.lines.some(n=>n.accountId===t.accountId))),t?.dateFrom&&(e=e.filter(r=>r.date>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.date<=t.dateTo)),e.sort((r,n)=>new Date(n.createdAt).getTime()-new Date(r.createdAt).getTime())},async getById(t){return await Ar(),Ft.journalEntries.find(e=>e.id===t)||null},async create(t){await Ar(),vn()&&bn();const e=t.lines.reduce((l,c)=>l+(c.debitAmount||0),0),r=t.lines.reduce((l,c)=>l+(c.creditAmount||0),0);if(Math.abs(e-r)>.01)throw new Error(`Entry is not balanced. Debit: ${e}, Credit: ${r}`);const n=Ft.journalEntries.sort((l,c)=>c.entryNumber.localeCompare(l.entryNumber))[0],o=`JE-${((n?parseInt(n.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`,s={...t,id:As("je-"),entryNumber:o,createdAt:new Date().toISOString(),lines:t.lines.map(l=>({...l,id:As("jel-")}))};return Ft.journalEntries.push(s),s},async update(t,e){await Ar(),vn()&&bn();const r=Ft.journalEntries.findIndex(n=>n.id===t);if(r===-1)throw new Error("Journal entry not found");if(Ft.journalEntries[r].status==="posted")throw new Error("Cannot modify posted entries");return Ft.journalEntries[r]={...Ft.journalEntries[r],...e},Ft.journalEntries[r]},async post(t){await Ar(),vn()&&bn();const e=Ft.journalEntries.findIndex(o=>o.id===t);if(e===-1)throw new Error("Journal entry not found");const r=Ft.journalEntries[e];if(r.status==="posted")throw new Error("Entry is already posted");const n=r.lines.reduce((o,s)=>o+(s.debitAmount||0),0),i=r.lines.reduce((o,s)=>o+(s.creditAmount||0),0);if(Math.abs(n-i)>.01)throw new Error("Entry must be balanced before posting");return Ft.journalEntries[e]={...r,status:"posted",postedAt:new Date().toISOString()},r.lines.forEach(o=>{const s=Ft.accounts.findIndex(l=>l.id===o.accountId);if(s!==-1){const l=Ft.accounts[s],c=o.debitAmount||0,d=o.creditAmount||0;["asset","expense"].includes(l.accountType)?l.balance+=c-d:l.balance+=d-c}}),Ft.journalEntries[e]}},eventRules:{async getAll(){return await Ar(),vn()&&bn(),[...Ft.eventRules]},async getById(t){return await Ar(),Ft.eventRules.find(e=>e.id===t)||null},async getByEventType(t){return await Ar(),Ft.eventRules.filter(e=>e.eventType===t&&e.isActive).sort((e,r)=>r.priority-e.priority)},async create(t){await Ar(),vn()&&bn();const e={...t,id:As("rule-"),createdAt:new Date,updatedAt:new Date,businessId:"YB100423253156428"};return Ft.eventRules.push(e),e},async update(t,e){await Ar(),vn()&&bn();const r=Ft.eventRules.findIndex(n=>n.id===t);if(r===-1)throw new Error("Event rule not found");return Ft.eventRules[r]={...Ft.eventRules[r],...e,id:t,updatedAt:new Date},Ft.eventRules[r]},async delete(t){await Ar(),vn()&&bn();const e=Ft.eventRules.findIndex(r=>r.id===t);if(e===-1)throw new Error("Event rule not found");return Ft.eventRules.splice(e,1),{success:!0,message:"Event rule deleted successfully"}},async testRule(t,e){await Ar();try{return t.conditions.length===0||t.conditions.every(n=>{const i=Ef(e,n.field);switch(n.operator){case"equals":return i===n.value;case"notEquals":return i!==n.value;case"greaterThan":return Number(i)>Number(n.value);case"lessThan":return Number(i)<Number(n.value);case"contains":return String(i).includes(String(n.value));case"exists":return i!=null;case"notExists":return i==null;default:return!1}})?{success:!0,result:{wouldTrigger:!0,estimatedJournalEntry:{description:fm(t.journalEntryTemplate.description,e),reference:fm(t.journalEntryTemplate.reference,e),lines:t.journalEntryTemplate.lines.map(i=>({accountId:i.accountExpression,description:fm(i.descriptionTemplate,e),amount:Cw(i.amountExpression,e),isDebit:i.isDebit}))}}}:{success:!0,result:{wouldTrigger:!1,reason:"Conditions not met"}}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Unknown error"}}},async getExecutionHistory(t,e=100){await Ar();let r=[...Ft.eventRuleHistory];return t&&(r=r.filter(n=>n.ruleId===t)),r.sort((n,i)=>i.executedAt.getTime()-n.executedAt.getTime()).slice(0,e)},async bulkToggle(t,e){await Ar();const r=[],n=[];for(const i of t){const o=Ft.eventRules.findIndex(s=>s.id===i);o!==-1?(Ft.eventRules[o].isActive=e,Ft.eventRules[o].updatedAt=new Date,r.push(i)):n.push(i)}return{success:n.length===0,updated:r.length,failed:n}},async importRules(t){await Ar();const e=[];let r=0;for(const n of t)try{const i={...n,id:As("rule-"),createdAt:new Date,updatedAt:new Date,businessId:"YB100423253156428"};Ft.eventRules.push(i),r++}catch(i){e.push(`Failed to import rule ${n.name}: ${i instanceof Error?i.message:"Unknown error"}`)}return{success:e.length===0,imported:r,failed:t.length-r,errors:e}}},utils:{async getNextEntryNumber(){await Ar(100);const t=Ft.journalEntries.sort((r,n)=>n.entryNumber.localeCompare(r.entryNumber))[0];return`JE-${((t?parseInt(t.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`},async getNextProductCode(t){await Ar(100);const e=t.toUpperCase().slice(0,3),r=Ft.products.filter(i=>i.productCode?.startsWith(e)).sort((i,o)=>(o.productCode||"").localeCompare(i.productCode||""));if(r.length===0)return`${e}001`;const n=parseInt(r[0].productCode?.slice(-3)||"0");return`${e}${(n+1).toString().padStart(3,"0")}`},async healthCheck(){return await Ar(50),{status:"healthy",timestamp:new Date().toISOString(),version:"1.0.0"}},async resetDatabase(){return await Ar(200),Ft={products:[...Ft.products.slice(0,3)],locations:[...Ft.locations.slice(0,3)],movements:[...Ft.movements.slice(0,2)],accounts:[...Ft.accounts.slice(0,2)],journalEntries:[...Ft.journalEntries.slice(0,1)],eventRules:[...Ft.eventRules.slice(0,2)],eventRuleHistory:[]},{success:!0,message:"Database reset to initial state"}},async getStats(){return await Ar(100),{products:Ft.products.length,locations:Ft.locations.length,movements:Ft.movements.length,accounts:Ft.accounts.length,journalEntries:Ft.journalEntries.length,eventRules:Ft.eventRules.length,eventRuleHistory:Ft.eventRuleHistory.length,totalStockValue:Ft.movements.reduce((t,e)=>e.movementType==="in"?t+e.totalCost:e.movementType==="out"?t-e.totalCost:t,0)}}}},Qb=t=>t===null||typeof t!="object"?t:t instanceof Date?new Date(t.getTime()):Array.isArray(t)?t.map(e=>Qb(e)):JSON.parse(JSON.stringify(t)),ki=(t=16)=>{const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},pv=(t=16)=>{const e="123456789";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},mv=(t=4)=>{const e="0123456789BCDFGKSY";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},Sl=t=>typeof t=="string"&&t.trim().length>0,Zr=async t=>{const n=await fetch("https://qvamarkets.com/gql_api",{method:"POST",headers:{"Content-Type":"application/json","Accept-Encoding":"gzip, deflate, br",Authorization:"eyJhbGciOiJSUzI1NiIsImtpZCI6IjhlOGZjOGU1NTZmN2E3NmQwOGQzNTgyOWQ2ZjkwYWUyZTEyY2ZkMGQiLCJ0eXAiOiJKV1QifQ"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const i=await n.json();if(i.errors)throw new Error(i.errors[0]?.message||"GraphQL error");return i.data},Ay=async t=>{const n=await fetch("https://ssgloghr.com/api/query",{method:"POST",headers:{"Content-Type":"application/json","Accept-Encoding":"gzip, deflate, br",Authorization:"eyJhbGciOiJSUzI1NiIsImtpZCI6IjhlOGZjOGU1NTZmN2E3NmQwOGQzNTgyOWQ2ZjkwYWUyZTEyY2ZkMGQiLCJ0eXAiOiJKV1QifQ"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const i=await n.json();if(i.errors)throw new Error(i.errors[0]?.message||"GraphQL error");return i.data},Aw=t=>({ENTRY:"in",in:"in",TRANSFER:"transfer",transfer:"transfer",SALES:"out",out:"out",adjustment:"adjustment"})[t],$y=t=>({ENTRY:"ENTRY",in:"ENTRY",TRANSFER:"TRANSFER",transfer:"TRANSFER",SALES:"SALES",out:"SALES",adjustment:"adjustment"})[t];function gl(t){var e=[];return t&&Object.keys(t).map(r=>{e.push(t[r])}),e}function $w(t){if(!/^[a-z0-9+/]+={0,2}$/i.test(t)||t.length%4!=0)throw Error("Not base64 string");for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,n,i,o,s,l,c,d,u=[],h=0;h<t.length;h+=4)o=e.indexOf(t.charAt(h)),s=e.indexOf(t.charAt(h+1)),l=e.indexOf(t.charAt(h+2)),c=e.indexOf(t.charAt(h+3)),d=o<<18|s<<12|l<<6|c,r=d>>>16&255,n=d>>>8&255,i=d&255,u[h/4]=String.fromCharCode(r,n,i),c==64&&(u[h/4]=String.fromCharCode(r,n)),l==64&&(u[h/4]=String.fromCharCode(r));return t=u.join(""),t}const Jb=(t,e,r,n)=>{let i=0,o={};return t.map(s=>{n?.[s]||Xb(e?.[s],r?.[s])||(i=1,o[s]=e[s])}),{hasChange:i,data:o}},Xb=(t,e)=>Object.prototype.toString.call(t)===Object.prototype.toString.call(e)?Object.prototype.toString.call(t)==="[object Object]"||Object.prototype.toString.call(t)==="[object Array]"?Object.keys(t).length!==Object.keys(e).length?!1:Object.keys(t).every(function(r){return Xb(t[r],e[r])}):t===e:!1,Ew=()=>{};var yv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zb=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},Iw=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[r++];e[n++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[r++],s=t[r++],l=t[r++],c=((i&7)<<18|(o&63)<<12|(s&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const o=t[r++],s=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(o&63)<<6|s&63)}}return e.join("")},e2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const o=t[i],s=i+1<t.length,l=s?t[i+1]:0,c=i+2<t.length,d=c?t[i+2]:0,u=o>>2,h=(o&3)<<4|l>>4;let g=(l&15)<<2|d>>6,m=d&63;c||(m=64,s||(g=64)),n.push(r[u],r[h],r[g],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Zb(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Iw(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const o=r[t.charAt(i++)],l=i<t.length?r[t.charAt(i)]:0;++i;const d=i<t.length?r[t.charAt(i)]:64;++i;const h=i<t.length?r[t.charAt(i)]:64;if(++i,o==null||l==null||d==null||h==null)throw new Tw;const g=o<<2|l>>4;if(n.push(g),d!==64){const m=l<<4&240|d>>2;if(n.push(m),h!==64){const S=d<<6&192|h;n.push(S)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Tw extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const kw=function(t){const e=Zb(t);return e2.encodeByteArray(e,!0)},qh=function(t){return kw(t).replace(/\./g,"")},t2=function(t){try{return e2.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nw(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lw=()=>Nw().__FIREBASE_DEFAULTS__,Rw=()=>{if(typeof process>"u"||typeof yv>"u")return;const t=yv.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Dw=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&t2(t[1]);return e&&JSON.parse(e)},gp=()=>{try{return Ew()||Lw()||Rw()||Dw()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},r2=t=>gp()?.emulatorHosts?.[t],Mw=t=>{const e=r2(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},n2=()=>gp()?.config,i2=t=>gp()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fw{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vc(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function o2(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ow(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[qh(JSON.stringify(r)),qh(JSON.stringify(s)),""].join(".")}const Nd={};function Bw(){const t={prod:[],emulator:[]};for(const e of Object.keys(Nd))Nd[e]?t.emulator.push(e):t.prod.push(e);return t}function Vw(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let fv=!1;function s2(t,e){if(typeof window>"u"||typeof document>"u"||!Vc(window.location.host)||Nd[t]===e||Nd[t]||fv)return;Nd[t]=e;function r(g){return`__firebase__banner__${g}`}const n="__firebase__banner",o=Bw().prod.length>0;function s(){const g=document.getElementById(n);g&&g.remove()}function l(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function c(g,m){g.setAttribute("width","24"),g.setAttribute("id",m),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function d(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{fv=!0,s()},g}function u(g,m){g.setAttribute("id",m),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function h(){const g=Vw(n),m=r("text"),S=document.getElementById(m)||document.createElement("span"),N=r("learnmore"),x=document.getElementById(N)||document.createElement("a"),b=r("preprendIcon"),K=document.getElementById(b)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const te=g.element;l(te),u(x,N);const F=d();c(K,b),te.append(K,S,x,F),document.body.appendChild(te)}o?(S.innerText="Preview backend disconnected.",K.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(K.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Si(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function jw(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Si())}function zw(){const t=gp()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function qw(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Uw(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Hw(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Gw(){const t=Si();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Ww(){return!zw()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Yw(){try{return typeof indexedDB=="object"}catch{return!1}}function Kw(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qw="FirebaseError";class Us extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=Qw,Object.setPrototypeOf(this,Us.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,lu.prototype.create)}}class lu{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,o=this.errors[e],s=o?Jw(o,n):"Error",l=`${this.serviceName}: ${s} (${i}).`;return new Us(i,l,n)}}function Jw(t,e){return t.replace(Xw,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const Xw=/\{\$([^}]+)}/g;function Zw(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function El(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const o=t[i],s=e[i];if(gv(o)&&gv(s)){if(!El(o,s))return!1}else if(o!==s)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function gv(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cu(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function ex(t,e){const r=new tx(t,e);return r.subscribe.bind(r)}class tx{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");rx(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=gm),i.error===void 0&&(i.error=gm),i.complete===void 0&&(i.complete=gm);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function rx(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function gm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xn(t){return t&&t._delegate?t._delegate:t}class Il{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ul="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nx{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new Fw;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ox(e))try{this.getOrInitializeService({instanceIdentifier:ul})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=ul){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ul){return this.instances.has(e)}getOptions(e=ul){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,s]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(o);n===l&&s.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const o=this.instances.get(n);return o&&e(o,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:ix(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ul){return this.component?this.component.multipleInstances?e:ul:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ix(t){return t===ul?void 0:t}function ox(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sx{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new nx(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nr;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Nr||(Nr={}));const ax={debug:Nr.DEBUG,verbose:Nr.VERBOSE,info:Nr.INFO,warn:Nr.WARN,error:Nr.ERROR,silent:Nr.SILENT},lx=Nr.INFO,cx={[Nr.DEBUG]:"log",[Nr.VERBOSE]:"log",[Nr.INFO]:"info",[Nr.WARN]:"warn",[Nr.ERROR]:"error"},dx=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=cx[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class If{constructor(e){this.name=e,this._logLevel=lx,this._logHandler=dx,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Nr))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?ax[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Nr.DEBUG,...e),this._logHandler(this,Nr.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Nr.VERBOSE,...e),this._logHandler(this,Nr.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Nr.INFO,...e),this._logHandler(this,Nr.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Nr.WARN,...e),this._logHandler(this,Nr.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Nr.ERROR,...e),this._logHandler(this,Nr.ERROR,...e)}}const ux=(t,e)=>e.some(r=>t instanceof r);let vv,bv;function hx(){return vv||(vv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function px(){return bv||(bv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const a2=new WeakMap,Ey=new WeakMap,l2=new WeakMap,vm=new WeakMap,Tf=new WeakMap;function mx(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",s)},o=()=>{r(ka(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",s)});return e.then(r=>{r instanceof IDBCursor&&a2.set(r,t)}).catch(()=>{}),Tf.set(e,t),e}function yx(t){if(Ey.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",s),t.removeEventListener("abort",s)},o=()=>{r(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",s),t.addEventListener("abort",s)});Ey.set(t,e)}let Iy={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Ey.get(t);if(e==="objectStoreNames")return t.objectStoreNames||l2.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ka(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function fx(t){Iy=t(Iy)}function gx(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(bm(this),e,...r);return l2.set(n,e.sort?e.sort():[e]),ka(n)}:px().includes(t)?function(...e){return t.apply(bm(this),e),ka(a2.get(this))}:function(...e){return ka(t.apply(bm(this),e))}}function vx(t){return typeof t=="function"?gx(t):(t instanceof IDBTransaction&&yx(t),ux(t,hx())?new Proxy(t,Iy):t)}function ka(t){if(t instanceof IDBRequest)return mx(t);if(vm.has(t))return vm.get(t);const e=vx(t);return e!==t&&(vm.set(t,e),Tf.set(e,t)),e}const bm=t=>Tf.get(t);function bx(t,e,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const s=indexedDB.open(t,e),l=ka(s);return n&&s.addEventListener("upgradeneeded",c=>{n(ka(s.result),c.oldVersion,c.newVersion,ka(s.transaction),c)}),r&&s.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const Px=["get","getKey","getAll","getAllKeys","count"],_x=["put","add","delete","clear"],Pm=new Map;function Pv(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Pm.get(e))return Pm.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=_x.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||Px.includes(r)))return;const o=async function(s,...l){const c=this.transaction(s,i?"readwrite":"readonly");let d=c.store;return n&&(d=d.index(l.shift())),(await Promise.all([d[r](...l),i&&c.done]))[0]};return Pm.set(e,o),o}fx(t=>({...t,get:(e,r,n)=>Pv(e,r)||t.get(e,r,n),has:(e,r)=>!!Pv(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sx{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(wx(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function wx(t){return t.getComponent()?.type==="VERSION"}const Ty="@firebase/app",_v="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fs=new If("@firebase/app"),xx="@firebase/app-compat",Cx="@firebase/analytics-compat",Ax="@firebase/analytics",$x="@firebase/app-check-compat",Ex="@firebase/app-check",Ix="@firebase/auth",Tx="@firebase/auth-compat",kx="@firebase/database",Nx="@firebase/data-connect",Lx="@firebase/database-compat",Rx="@firebase/functions",Dx="@firebase/functions-compat",Mx="@firebase/installations",Fx="@firebase/installations-compat",Ox="@firebase/messaging",Bx="@firebase/messaging-compat",Vx="@firebase/performance",jx="@firebase/performance-compat",zx="@firebase/remote-config",qx="@firebase/remote-config-compat",Ux="@firebase/storage",Hx="@firebase/storage-compat",Gx="@firebase/firestore",Wx="@firebase/ai",Yx="@firebase/firestore-compat",Kx="firebase",Qx="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ky="[DEFAULT]",Jx={[Ty]:"fire-core",[xx]:"fire-core-compat",[Ax]:"fire-analytics",[Cx]:"fire-analytics-compat",[Ex]:"fire-app-check",[$x]:"fire-app-check-compat",[Ix]:"fire-auth",[Tx]:"fire-auth-compat",[kx]:"fire-rtdb",[Nx]:"fire-data-connect",[Lx]:"fire-rtdb-compat",[Rx]:"fire-fn",[Dx]:"fire-fn-compat",[Mx]:"fire-iid",[Fx]:"fire-iid-compat",[Ox]:"fire-fcm",[Bx]:"fire-fcm-compat",[Vx]:"fire-perf",[jx]:"fire-perf-compat",[zx]:"fire-rc",[qx]:"fire-rc-compat",[Ux]:"fire-gcs",[Hx]:"fire-gcs-compat",[Gx]:"fire-fst",[Yx]:"fire-fst-compat",[Wx]:"fire-vertex","fire-js":"fire-js",[Kx]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uh=new Map,Xx=new Map,Ny=new Map;function Sv(t,e){try{t.container.addComponent(e)}catch(r){Fs.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Ec(t){const e=t.name;if(Ny.has(e))return Fs.debug(`There were multiple attempts to register component ${e}.`),!1;Ny.set(e,t);for(const r of Uh.values())Sv(r,t);for(const r of Xx.values())Sv(r,t);return!0}function kf(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function vo(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zx={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Na=new lu("app","Firebase",Zx);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Il("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Na.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jc=Qx;function c2(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:ky,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw Na.create("bad-app-name",{appName:String(i)});if(r||(r=n2()),!r)throw Na.create("no-options");const o=Uh.get(i);if(o){if(El(r,o.options)&&El(n,o.config))return o;throw Na.create("duplicate-app",{appName:i})}const s=new sx(i);for(const c of Ny.values())s.addComponent(c);const l=new eC(r,n,s);return Uh.set(i,l),l}function d2(t=ky){const e=Uh.get(t);if(!e&&t===ky&&n2())return c2();if(!e)throw Na.create("no-app",{appName:t});return e}function La(t,e,r){let n=Jx[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const s=[`Unable to register library "${n}" with version "${e}":`];i&&s.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&o&&s.push("and"),o&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Fs.warn(s.join(" "));return}Ec(new Il(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tC="firebase-heartbeat-database",rC=1,Yd="firebase-heartbeat-store";let _m=null;function u2(){return _m||(_m=bx(tC,rC,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Yd)}catch(r){console.warn(r)}}}}).catch(t=>{throw Na.create("idb-open",{originalErrorMessage:t.message})})),_m}async function nC(t){try{const r=(await u2()).transaction(Yd),n=await r.objectStore(Yd).get(h2(t));return await r.done,n}catch(e){if(e instanceof Us)Fs.warn(e.message);else{const r=Na.create("idb-get",{originalErrorMessage:e?.message});Fs.warn(r.message)}}}async function wv(t,e){try{const n=(await u2()).transaction(Yd,"readwrite");await n.objectStore(Yd).put(e,h2(t)),await n.done}catch(r){if(r instanceof Us)Fs.warn(r.message);else{const n=Na.create("idb-set",{originalErrorMessage:r?.message});Fs.warn(n.message)}}}function h2(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iC=1024,oC=30;class sC{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new lC(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=xv();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>oC){const i=cC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Fs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=xv(),{heartbeatsToSend:r,unsentEntries:n}=aC(this._heartbeatsCache.heartbeats),i=qh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Fs.warn(e),""}}}function xv(){return new Date().toISOString().substring(0,10)}function aC(t,e=iC){const r=[];let n=t.slice();for(const i of t){const o=r.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),Cv(r)>e){o.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Cv(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class lC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Yw()?Kw().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await nC(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return wv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return wv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Cv(t){return qh(JSON.stringify({version:2,heartbeats:t})).length}function cC(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dC(t){Ec(new Il("platform-logger",e=>new Sx(e),"PRIVATE")),Ec(new Il("heartbeat",e=>new sC(e),"PRIVATE")),La(Ty,_v,t),La(Ty,_v,"esm2020"),La("fire-js","")}dC("");function p2(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const uC=p2,m2=new lu("auth","Firebase",p2());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hh=new If("@firebase/auth");function hC(t,...e){Hh.logLevel<=Nr.WARN&&Hh.warn(`Auth (${jc}): ${t}`,...e)}function Sh(t,...e){Hh.logLevel<=Nr.ERROR&&Hh.error(`Auth (${jc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hs(t,...e){throw Lf(t,...e)}function Oo(t,...e){return Lf(t,...e)}function Nf(t,e,r){const n={...uC(),[e]:r};return new lu("auth","Firebase",n).create(e,{appName:t.name})}function Ra(t){return Nf(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function y2(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&hs(t,"argument-error"),Nf(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Lf(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return m2.create(t,...e)}function yr(t,e,...r){if(!t)throw Lf(e,...r)}function Ns(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Sh(e),new Error(e)}function Os(t,e){t||Ns(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ly(){return typeof self<"u"&&self.location?.href||""}function pC(){return Av()==="http:"||Av()==="https:"}function Av(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mC(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(pC()||Uw()||"connection"in navigator)?navigator.onLine:!0}function yC(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(e,r){this.shortDelay=e,this.longDelay=r,Os(r>e,"Short delay should be less than long delay!"),this.isMobile=jw()||Hw()}get(){return mC()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rf(t,e){Os(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f2{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ns("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ns("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ns("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gC=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],vC=new du(3e4,6e4);function Df(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function zc(t,e,r,n,i={}){return g2(t,i,async()=>{let o={},s={};n&&(e==="GET"?s=n:o={body:JSON.stringify(n)});const l=cu({key:t.config.apiKey,...s}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:c,...o};return qw()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Vc(t.emulatorConfig.host)&&(d.credentials="include"),f2.fetch()(await v2(t,t.config.apiHost,r,l),d)})}async function g2(t,e,r){t._canInitEmulator=!1;const n={...fC,...e};try{const i=new PC(t),o=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const s=await o.json();if("needConfirmation"in s)throw Hu(t,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{const l=o.ok?s.errorMessage:s.error.message,[c,d]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Hu(t,"credential-already-in-use",s);if(c==="EMAIL_EXISTS")throw Hu(t,"email-already-in-use",s);if(c==="USER_DISABLED")throw Hu(t,"user-disabled",s);const u=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Nf(t,u,d);hs(t,u)}}catch(i){if(i instanceof Us)throw i;hs(t,"network-request-failed",{message:String(i)})}}async function bC(t,e,r,n,i={}){const o=await zc(t,e,r,n,i);return"mfaPendingCredential"in o&&hs(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function v2(t,e,r,n){const i=`${e}${r}?${n}`,o=t,s=o.config.emulator?Rf(t.config,i):`${t.config.apiScheme}://${i}`;return gC.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(s).toString():s}class PC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Oo(this.auth,"network-request-failed")),vC.get())})}}function Hu(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Oo(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _C(t,e){return zc(t,"POST","/v1/accounts:delete",e)}async function Gh(t,e){return zc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ld(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function SC(t,e=!1){const r=Xn(t),n=await r.getIdToken(e),i=Mf(n);yr(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,s=o?.sign_in_provider;return{claims:i,token:n,authTime:Ld(Sm(i.auth_time)),issuedAtTime:Ld(Sm(i.iat)),expirationTime:Ld(Sm(i.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}}function Sm(t){return Number(t)*1e3}function Mf(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Sh("JWT malformed, contained fewer than 3 sections"),null;try{const i=t2(r);return i?JSON.parse(i):(Sh("Failed to decode base64 JWT payload"),null)}catch(i){return Sh("Caught error parsing JWT payload as JSON",i?.toString()),null}}function $v(t){const e=Mf(t);return yr(e,"internal-error"),yr(typeof e.exp<"u","internal-error"),yr(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kd(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Us&&wC(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function wC({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ld(this.lastLoginAt),this.creationTime=Ld(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wh(t){const e=t.auth,r=await t.getIdToken(),n=await Kd(t,Gh(e,{idToken:r}));yr(n?.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const o=i.providerUserInfo?.length?b2(i.providerUserInfo):[],s=AC(t.providerData,o),l=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!s?.length,d=l?c:!1,u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Ry(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,u)}async function CC(t){const e=Xn(t);await Wh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function AC(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function b2(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $C(t,e){const r=await g2(t,{},async()=>{const n=cu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,s=await v2(t,i,"/v1/token",`key=${o}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:l,body:n};return t.emulatorConfig&&Vc(t.emulatorConfig.host)&&(c.credentials="include"),f2.fetch()(s,c)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function EC(t,e){return zc(t,"POST","/v2/accounts:revokeToken",Df(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){yr(e.idToken,"internal-error"),yr(typeof e.idToken<"u","internal-error"),yr(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):$v(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){yr(e.length!==0,"internal-error");const r=$v(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(yr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:o}=await $C(e,r);this.updateTokensAndExpiration(n,i,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:o}=r,s=new Pc;return n&&(yr(typeof n=="string","internal-error",{appName:e}),s.refreshToken=n),i&&(yr(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),o&&(yr(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Pc,this.toJSON())}_performRefresh(){return Ns("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ga(t,e){yr(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Fo{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new xC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Ry(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Kd(this,this.stsTokenManager.getToken(this.auth,e));return yr(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return SC(this,e)}reload(){return CC(this)}_assign(e){this!==e&&(yr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Fo({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){yr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Wh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(vo(this.auth.app))return Promise.reject(Ra(this.auth));const e=await this.getIdToken();return await Kd(this,_C(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,o=r.phoneNumber??void 0,s=r.photoURL??void 0,l=r.tenantId??void 0,c=r._redirectEventId??void 0,d=r.createdAt??void 0,u=r.lastLoginAt??void 0,{uid:h,emailVerified:g,isAnonymous:m,providerData:S,stsTokenManager:N}=r;yr(h&&N,e,"internal-error");const x=Pc.fromJSON(this.name,N);yr(typeof h=="string",e,"internal-error"),ga(n,e.name),ga(i,e.name),yr(typeof g=="boolean",e,"internal-error"),yr(typeof m=="boolean",e,"internal-error"),ga(o,e.name),ga(s,e.name),ga(l,e.name),ga(c,e.name),ga(d,e.name),ga(u,e.name);const b=new Fo({uid:h,auth:e,email:i,emailVerified:g,displayName:n,isAnonymous:m,photoURL:s,phoneNumber:o,tenantId:l,stsTokenManager:x,createdAt:d,lastLoginAt:u});return S&&Array.isArray(S)&&(b.providerData=S.map(K=>({...K}))),c&&(b._redirectEventId=c),b}static async _fromIdTokenResponse(e,r,n=!1){const i=new Pc;i.updateFromServerResponse(r);const o=new Fo({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Wh(o),o}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];yr(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?b2(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!o?.length,l=new Pc;l.updateFromIdToken(n);const c=new Fo({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:s}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Ry(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ev=new Map;function Ls(t){Os(t instanceof Function,"Expected a class definition");let e=Ev.get(t);return e?(Os(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Ev.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P2{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}P2.type="NONE";const Iv=P2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wh(t,e,r){return`firebase:${t}:${e}:${r}`}class _c{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:o}=this.auth;this.fullUserKey=wh(this.userKey,i.apiKey,o),this.fullPersistenceKey=wh("persistence",i.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await Gh(this.auth,{idToken:e}).catch(()=>{});return r?Fo._fromGetAccountInfoResponse(this.auth,r,e):null}return Fo._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new _c(Ls(Iv),e,n);const i=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let o=i[0]||Ls(Iv);const s=wh(n,e.config.apiKey,e.name);let l=null;for(const d of r)try{const u=await d._get(s);if(u){let h;if(typeof u=="string"){const g=await Gh(e,{idToken:u}).catch(()=>{});if(!g)break;h=await Fo._fromGetAccountInfoResponse(e,g,u)}else h=Fo._fromJSON(e,u);d!==o&&(l=h),o=d;break}}catch{}const c=i.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!c.length?new _c(o,e,n):(o=c[0],l&&await o._set(s,l.toJSON()),await Promise.all(r.map(async d=>{if(d!==o)try{await d._remove(s)}catch{}})),new _c(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tv(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(x2(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(_2(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(A2(e))return"Blackberry";if($2(e))return"Webos";if(S2(e))return"Safari";if((e.includes("chrome/")||w2(e))&&!e.includes("edge/"))return"Chrome";if(C2(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function _2(t=Si()){return/firefox\//i.test(t)}function S2(t=Si()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function w2(t=Si()){return/crios\//i.test(t)}function x2(t=Si()){return/iemobile/i.test(t)}function C2(t=Si()){return/android/i.test(t)}function A2(t=Si()){return/blackberry/i.test(t)}function $2(t=Si()){return/webos/i.test(t)}function Ff(t=Si()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function IC(t=Si()){return Ff(t)&&!!window.navigator?.standalone}function TC(){return Gw()&&document.documentMode===10}function E2(t=Si()){return Ff(t)||C2(t)||$2(t)||A2(t)||/windows phone/i.test(t)||x2(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I2(t,e=[]){let r;switch(t){case"Browser":r=Tv(Si());break;case"Worker":r=`${Tv(Si())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${jc}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((s,l)=>{try{const c=e(o);s(c)}catch(c){l(c)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NC(t,e={}){return zc(t,"GET","/v2/passwordPolicy",Df(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LC=6;class RC{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??LC,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new kv(this),this.idTokenSubscription=new kv(this),this.beforeStateQueue=new kC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=m2,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ls(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await _c.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Gh(this,{idToken:e}),n=await Fo._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(vo(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(s,s))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,s=n?._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===s)&&l?.user&&(n=l.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return yr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Wh(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=yC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(vo(this.app))return Promise.reject(Ra(this));const r=e?Xn(e):null;return r&&yr(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&yr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return vo(this.app)?Promise.reject(Ra(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return vo(this.app)?Promise.reject(Ra(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ls(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await NC(this),r=new RC(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new lu("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await EC(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ls(e)||this._popupRedirectResolver;yr(r,this,"argument-error"),this.redirectPersistenceManager=await _c.create(this,[Ls(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let s=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(yr(l,this,"internal-error"),l.then(()=>{s||o(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,i);return()=>{s=!0,c()}}else{const c=e.addObserver(r);return()=>{s=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return yr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=I2(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(vo(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&hC(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Rl(t){return Xn(t)}class kv{constructor(e){this.auth=e,this.observer=null,this.addObserver=ex(r=>this.observer=r)}get next(){return yr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Of={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function MC(t){Of=t}function FC(t){return Of.loadJS(t)}function OC(){return Of.gapiScript}function BC(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VC(t,e){const r=kf(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),o=r.getOptions();if(El(o,e??{}))return i;hs(i,"already-initialized")}return r.initialize({options:e})}function jC(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(Ls);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function zC(t,e,r){const n=Rl(t);yr(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,o=T2(e),{host:s,port:l}=qC(e),c=l===null?"":`:${l}`,d={url:`${o}//${s}${c}/`},u=Object.freeze({host:s,port:l,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){yr(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),yr(El(d,n.config.emulator)&&El(u,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=u,n.settings.appVerificationDisabledForTesting=!0,Vc(s)?(o2(`${o}//${s}${c}`),s2("Auth",!0)):UC()}function T2(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function qC(t){const e=T2(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const o=i[1];return{host:o,port:Nv(n.substr(o.length+1))}}else{const[o,s]=n.split(":");return{host:o,port:Nv(s)}}}function Nv(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function UC(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k2{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ns("not implemented")}_getIdTokenResponse(e){return Ns("not implemented")}_linkToIdToken(e,r){return Ns("not implemented")}_getReauthenticationResolver(e){return Ns("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sc(t,e){return bC(t,"POST","/v1/accounts:signInWithIdp",Df(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HC="http://localhost";class Tl extends k2{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Tl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):hs("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...o}=r;if(!n||!i)return null;const s=new Tl(n,i);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){const r=this.buildRequest();return Sc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Sc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Sc(e,r)}buildRequest(){const e={requestUri:HC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=cu(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu extends vp{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca extends uu{constructor(){super("facebook.com")}static credential(e){return Tl._fromParams({providerId:Ca.PROVIDER_ID,signInMethod:Ca.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ca.credentialFromTaggedObject(e)}static credentialFromError(e){return Ca.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ca.credential(e.oauthAccessToken)}catch{return null}}}Ca.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ca.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs extends uu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Tl._fromParams({providerId:rs.PROVIDER_ID,signInMethod:rs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return rs.credentialFromTaggedObject(e)}static credentialFromError(e){return rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return rs.credential(r,n)}catch{return null}}}rs.GOOGLE_SIGN_IN_METHOD="google.com";rs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa extends uu{constructor(){super("github.com")}static credential(e){return Tl._fromParams({providerId:Aa.PROVIDER_ID,signInMethod:Aa.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Aa.credentialFromTaggedObject(e)}static credentialFromError(e){return Aa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Aa.credential(e.oauthAccessToken)}catch{return null}}}Aa.GITHUB_SIGN_IN_METHOD="github.com";Aa.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a extends uu{constructor(){super("twitter.com")}static credential(e,r){return Tl._fromParams({providerId:$a.PROVIDER_ID,signInMethod:$a.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return $a.credentialFromTaggedObject(e)}static credentialFromError(e){return $a.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return $a.credential(r,n)}catch{return null}}}$a.TWITTER_SIGN_IN_METHOD="twitter.com";$a.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ic{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const o=await Fo._fromIdTokenResponse(e,n,i),s=Lv(n);return new Ic({user:o,providerId:s,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=Lv(n);return new Ic({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function Lv(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh extends Us{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Yh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new Yh(e,r,n,i)}}function N2(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Yh._fromErrorAndOperation(t,o,e,n):o})}async function GC(t,e,r=!1){const n=await Kd(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Ic._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WC(t,e,r=!1){const{auth:n}=t;if(vo(n.app))return Promise.reject(Ra(n));const i="reauthenticate";try{const o=await Kd(t,N2(n,i,e,t),r);yr(o.idToken,n,"internal-error");const s=Mf(o.idToken);yr(s,n,"internal-error");const{sub:l}=s;return yr(t.uid===l,n,"user-mismatch"),Ic._forOperation(t,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&hs(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L2(t,e,r=!1){if(vo(t.app))return Promise.reject(Ra(t));const n="signIn",i=await N2(t,n,e),o=await Ic._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(o.user),o}async function YC(t,e){return L2(Rl(t),e)}function KC(t,e,r,n){return Xn(t).onIdTokenChanged(e,r,n)}function QC(t,e,r){return Xn(t).beforeAuthStateChanged(e,r)}function JC(t,e,r,n){return Xn(t).onAuthStateChanged(e,r,n)}function XC(t){return Xn(t).signOut()}const Kh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R2{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Kh,"1"),this.storage.removeItem(Kh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZC=1e3,eA=10;class D2 extends R2{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=E2(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((s,l,c)=>{this.notifyListeners(s,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const s=this.storage.getItem(n);!r&&this.localCache[n]===s||this.notifyListeners(n,s)},o=this.storage.getItem(n);TC()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,eA):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},ZC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}D2.type="LOCAL";const tA=D2;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M2 extends R2{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}M2.type="SESSION";const F2=M2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rA(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new bp(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:o}=r.data,s=this.handlersMap[i];if(!s?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const l=Array.from(s).map(async d=>d(r.origin,o)),c=await rA(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}bp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bf(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nA{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,s;return new Promise((l,c)=>{const d=Bf("",20);i.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},n);s={messageChannel:i,onMessage(h){const g=h;if(g.data.eventId===d)switch(g.data.status){case"ack":clearTimeout(u),o=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),l(g.data.response);break;default:clearTimeout(u),clearTimeout(o),c(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function is(){return window}function iA(t){is().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O2(){return typeof is().WorkerGlobalScope<"u"&&typeof is().importScripts=="function"}async function oA(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function sA(){return navigator?.serviceWorker?.controller||null}function aA(){return O2()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B2="firebaseLocalStorageDb",lA=1,Qh="firebaseLocalStorage",V2="fbase_key";class hu{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Pp(t,e){return t.transaction([Qh],e?"readwrite":"readonly").objectStore(Qh)}function cA(){const t=indexedDB.deleteDatabase(B2);return new hu(t).toPromise()}function Dy(){const t=indexedDB.open(B2,lA);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Qh,{keyPath:V2})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Qh)?e(n):(n.close(),await cA(),e(await Dy()))})})}async function Rv(t,e,r){const n=Pp(t,!0).put({[V2]:e,value:r});return new hu(n).toPromise()}async function dA(t,e){const r=Pp(t,!1).get(e),n=await new hu(r).toPromise();return n===void 0?null:n.value}function Dv(t,e){const r=Pp(t,!0).delete(e);return new hu(r).toPromise()}const uA=800,hA=3;class j2{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Dy(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>hA)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return O2()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=bp._getInstance(aA()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await oA(),!this.activeServiceWorker)return;this.sender=new nA(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||sA()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Dy();return await Rv(e,Kh,"1"),await Dv(e,Kh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>Rv(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>dA(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>Dv(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=Pp(i,!1).getAll();return new hu(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),uA)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}j2.type="LOCAL";const pA=j2;new du(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vf(t,e){return e?Ls(e):(yr(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf extends k2{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Sc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Sc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Sc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function mA(t){return L2(t.auth,new jf(t),t.bypassAuthState)}function yA(t){const{auth:e,user:r}=t;return yr(r,e,"internal-error"),WC(r,new jf(t),t.bypassAuthState)}async function fA(t){const{auth:e,user:r}=t;return yr(r,e,"internal-error"),GC(r,new jf(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z2{constructor(e,r,n,i,o=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:o,error:s,type:l}=e;if(s){this.reject(s);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return mA;case"linkViaPopup":case"linkViaRedirect":return fA;case"reauthViaPopup":case"reauthViaRedirect":return yA;default:hs(this.auth,"internal-error")}}resolve(e){Os(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Os(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gA=new du(2e3,1e4);async function vA(t,e,r){if(vo(t.app))return Promise.reject(Oo(t,"operation-not-supported-in-this-environment"));const n=Rl(t);y2(t,e,vp);const i=Vf(n,r);return new vl(n,"signInViaPopup",e,i).executeNotNull()}class vl extends z2{constructor(e,r,n,i,o){super(e,r,i,o),this.provider=n,this.authWindow=null,this.pollId=null,vl.currentPopupAction&&vl.currentPopupAction.cancel(),vl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return yr(e,this.auth,"internal-error"),e}async onExecution(){Os(this.filter.length===1,"Popup operations only handle one event");const e=Bf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Oo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Oo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,vl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Oo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,gA.get())};e()}}vl.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bA="pendingRedirect",xh=new Map;class PA extends z2{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=xh.get(this.auth._key());if(!e){try{const n=await _A(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}xh.set(this.auth._key(),e)}return this.bypassAuthState||xh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _A(t,e){const r=U2(e),n=q2(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}async function SA(t,e){return q2(t)._set(U2(e),"true")}function wA(t,e){xh.set(t._key(),e)}function q2(t){return Ls(t._redirectPersistence)}function U2(t){return wh(bA,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xA(t,e,r){return CA(t,e,r)}async function CA(t,e,r){if(vo(t.app))return Promise.reject(Ra(t));const n=Rl(t);y2(t,e,vp),await n._initializationPromise;const i=Vf(n,r);return await SA(i,n),i._openRedirect(n,e,"signInViaRedirect")}async function AA(t,e){return await Rl(t)._initializationPromise,H2(t,e,!1)}async function H2(t,e,r=!1){if(vo(t.app))return Promise.reject(Ra(t));const n=Rl(t),i=Vf(n,e),s=await new PA(n,i,r).execute();return s&&!r&&(delete s.user._redirectEventId,await n._persistUserIfCurrent(s.user),await n._setRedirectUser(null,e)),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $A=10*60*1e3;class EA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!IA(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!G2(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Oo(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=$A&&this.cachedEventUids.clear(),this.cachedEventUids.has(Mv(e))}saveEventToCache(e){this.cachedEventUids.add(Mv(e)),this.lastProcessedEventTime=Date.now()}}function Mv(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function G2({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function IA(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return G2(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TA(t,e={}){return zc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kA=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,NA=/^https?/;async function LA(t){if(t.config.emulator)return;const{authorizedDomains:e}=await TA(t);for(const r of e)try{if(RA(r))return}catch{}hs(t,"unauthorized-domain")}function RA(t){const e=Ly(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return s.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&s.hostname===n}if(!NA.test(r))return!1;if(kA.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DA=new du(3e4,6e4);function Fv(){const t=is().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function MA(t){return new Promise((e,r)=>{function n(){Fv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Fv(),r(Oo(t,"network-request-failed"))},timeout:DA.get()})}if(is().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(is().gapi?.load)n();else{const i=BC("iframefcb");return is()[i]=()=>{gapi.load?n():r(Oo(t,"network-request-failed"))},FC(`${OC()}?onload=${i}`).catch(o=>r(o))}}).catch(e=>{throw Ch=null,e})}let Ch=null;function FA(t){return Ch=Ch||MA(t),Ch}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OA=new du(5e3,15e3),BA="__/auth/iframe",VA="emulator/auth/iframe",jA={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},zA=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function qA(t){const e=t.config;yr(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Rf(e,VA):`https://${t.config.authDomain}/${BA}`,n={apiKey:e.apiKey,appName:t.name,v:jc},i=zA.get(t.config.apiHost);i&&(n.eid=i);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${cu(n).slice(1)}`}async function UA(t){const e=await FA(t),r=is().gapi;return yr(r,t,"internal-error"),e.open({where:document.body,url:qA(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:jA,dontclear:!0},n=>new Promise(async(i,o)=>{await n.restyle({setHideOnLeave:!1});const s=Oo(t,"network-request-failed"),l=is().setTimeout(()=>{o(s)},OA.get());function c(){is().clearTimeout(l),i(n)}n.ping(c).then(c,()=>{o(s)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HA={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},GA=500,WA=600,YA="_blank",KA="http://localhost";class Ov{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function QA(t,e,r,n=GA,i=WA){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const c={...HA,width:n.toString(),height:i.toString(),top:o,left:s},d=Si().toLowerCase();r&&(l=w2(d)?YA:r),_2(d)&&(e=e||KA,c.scrollbars="yes");const u=Object.entries(c).reduce((g,[m,S])=>`${g}${m}=${S},`,"");if(IC(d)&&l!=="_self")return JA(e||"",l),new Ov(null);const h=window.open(e||"",l,u);yr(h,t,"popup-blocked");try{h.focus()}catch{}return new Ov(h)}function JA(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XA="__/auth/handler",ZA="emulator/auth/handler",e3=encodeURIComponent("fac");async function Bv(t,e,r,n,i,o){yr(t.config.authDomain,t,"auth-domain-config-required"),yr(t.config.apiKey,t,"invalid-api-key");const s={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:jc,eventId:i};if(e instanceof vp){e.setDefaultLanguage(t.languageCode),s.providerId=e.providerId||"",Zw(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))s[u]=h}if(e instanceof uu){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(s.scopes=u.join(","))}t.tenantId&&(s.tid=t.tenantId);const l=s;for(const u of Object.keys(l))l[u]===void 0&&delete l[u];const c=await t._getAppCheckToken(),d=c?`#${e3}=${encodeURIComponent(c)}`:"";return`${t3(t)}?${cu(l).slice(1)}${d}`}function t3({config:t}){return t.emulator?Rf(t,ZA):`https://${t.authDomain}/${XA}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wm="webStorageSupport";class r3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=F2,this._completeRedirectFn=H2,this._overrideRedirectResult=wA}async _openPopup(e,r,n,i){Os(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await Bv(e,r,n,Ly(),i);return QA(e,o,Bf())}async _openRedirect(e,r,n,i){await this._originValidation(e);const o=await Bv(e,r,n,Ly(),i);return iA(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:o}=this.eventManagers[r];return i?Promise.resolve(i):(Os(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await UA(e),n=new EA(e);return r.register("authEvent",i=>(yr(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(wm,{type:wm},i=>{const o=i?.[0]?.[wm];o!==void 0&&r(!!o),hs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=LA(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return E2()||S2()||Ff()}}const n3=r3;var Vv="@firebase/auth",jv="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i3{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){yr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o3(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function s3(t){Ec(new Il("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:l}=n.options;yr(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:s,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:I2(t)},d=new DC(n,i,o,c);return jC(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Ec(new Il("auth-internal",e=>{const r=Rl(e.getProvider("auth").getImmediate());return(n=>new i3(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),La(Vv,jv,o3(t)),La(Vv,jv,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a3=5*60,l3=i2("authIdTokenMaxAge")||a3;let zv=null;const c3=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>l3)return;const i=r?.token;zv!==i&&(zv=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function d3(t=d2()){const e=kf(t,"auth");if(e.isInitialized())return e.getImmediate();const r=VC(t,{popupRedirectResolver:n3,persistence:[pA,tA,F2]}),n=i2("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const s=c3(o.toString());QC(r,s,()=>s(r.currentUser)),KC(r,l=>s(l))}}const i=r2("auth");return i&&zC(r,`http://${i}`),r}function u3(){return document.getElementsByTagName("head")?.[0]??document}MC({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const o=Oo("internal-error");o.customData=i,r(o)},n.type="text/javascript",n.charset="UTF-8",u3().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});s3("Browser");var h3="firebase",p3="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */La(h3,p3,"app");var qv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Da,W2;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,E){function L(){}L.prototype=E.prototype,I.D=E.prototype,I.prototype=new L,I.prototype.constructor=I,I.C=function(M,P,w){for(var v=Array(arguments.length-2),j=2;j<arguments.length;j++)v[j-2]=arguments[j];return E.prototype[P].apply(M,v)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,E,L){L||(L=0);var M=Array(16);if(typeof E=="string")for(var P=0;16>P;++P)M[P]=E.charCodeAt(L++)|E.charCodeAt(L++)<<8|E.charCodeAt(L++)<<16|E.charCodeAt(L++)<<24;else for(P=0;16>P;++P)M[P]=E[L++]|E[L++]<<8|E[L++]<<16|E[L++]<<24;E=I.g[0],L=I.g[1],P=I.g[2];var w=I.g[3],v=E+(w^L&(P^w))+M[0]+3614090360&4294967295;E=L+(v<<7&4294967295|v>>>25),v=w+(P^E&(L^P))+M[1]+3905402710&4294967295,w=E+(v<<12&4294967295|v>>>20),v=P+(L^w&(E^L))+M[2]+606105819&4294967295,P=w+(v<<17&4294967295|v>>>15),v=L+(E^P&(w^E))+M[3]+3250441966&4294967295,L=P+(v<<22&4294967295|v>>>10),v=E+(w^L&(P^w))+M[4]+4118548399&4294967295,E=L+(v<<7&4294967295|v>>>25),v=w+(P^E&(L^P))+M[5]+1200080426&4294967295,w=E+(v<<12&4294967295|v>>>20),v=P+(L^w&(E^L))+M[6]+2821735955&4294967295,P=w+(v<<17&4294967295|v>>>15),v=L+(E^P&(w^E))+M[7]+4249261313&4294967295,L=P+(v<<22&4294967295|v>>>10),v=E+(w^L&(P^w))+M[8]+1770035416&4294967295,E=L+(v<<7&4294967295|v>>>25),v=w+(P^E&(L^P))+M[9]+2336552879&4294967295,w=E+(v<<12&4294967295|v>>>20),v=P+(L^w&(E^L))+M[10]+4294925233&4294967295,P=w+(v<<17&4294967295|v>>>15),v=L+(E^P&(w^E))+M[11]+2304563134&4294967295,L=P+(v<<22&4294967295|v>>>10),v=E+(w^L&(P^w))+M[12]+1804603682&4294967295,E=L+(v<<7&4294967295|v>>>25),v=w+(P^E&(L^P))+M[13]+4254626195&4294967295,w=E+(v<<12&4294967295|v>>>20),v=P+(L^w&(E^L))+M[14]+2792965006&4294967295,P=w+(v<<17&4294967295|v>>>15),v=L+(E^P&(w^E))+M[15]+1236535329&4294967295,L=P+(v<<22&4294967295|v>>>10),v=E+(P^w&(L^P))+M[1]+4129170786&4294967295,E=L+(v<<5&4294967295|v>>>27),v=w+(L^P&(E^L))+M[6]+3225465664&4294967295,w=E+(v<<9&4294967295|v>>>23),v=P+(E^L&(w^E))+M[11]+643717713&4294967295,P=w+(v<<14&4294967295|v>>>18),v=L+(w^E&(P^w))+M[0]+3921069994&4294967295,L=P+(v<<20&4294967295|v>>>12),v=E+(P^w&(L^P))+M[5]+3593408605&4294967295,E=L+(v<<5&4294967295|v>>>27),v=w+(L^P&(E^L))+M[10]+38016083&4294967295,w=E+(v<<9&4294967295|v>>>23),v=P+(E^L&(w^E))+M[15]+3634488961&4294967295,P=w+(v<<14&4294967295|v>>>18),v=L+(w^E&(P^w))+M[4]+3889429448&4294967295,L=P+(v<<20&4294967295|v>>>12),v=E+(P^w&(L^P))+M[9]+568446438&4294967295,E=L+(v<<5&4294967295|v>>>27),v=w+(L^P&(E^L))+M[14]+3275163606&4294967295,w=E+(v<<9&4294967295|v>>>23),v=P+(E^L&(w^E))+M[3]+4107603335&4294967295,P=w+(v<<14&4294967295|v>>>18),v=L+(w^E&(P^w))+M[8]+1163531501&4294967295,L=P+(v<<20&4294967295|v>>>12),v=E+(P^w&(L^P))+M[13]+2850285829&4294967295,E=L+(v<<5&4294967295|v>>>27),v=w+(L^P&(E^L))+M[2]+4243563512&4294967295,w=E+(v<<9&4294967295|v>>>23),v=P+(E^L&(w^E))+M[7]+1735328473&4294967295,P=w+(v<<14&4294967295|v>>>18),v=L+(w^E&(P^w))+M[12]+2368359562&4294967295,L=P+(v<<20&4294967295|v>>>12),v=E+(L^P^w)+M[5]+4294588738&4294967295,E=L+(v<<4&4294967295|v>>>28),v=w+(E^L^P)+M[8]+2272392833&4294967295,w=E+(v<<11&4294967295|v>>>21),v=P+(w^E^L)+M[11]+1839030562&4294967295,P=w+(v<<16&4294967295|v>>>16),v=L+(P^w^E)+M[14]+4259657740&4294967295,L=P+(v<<23&4294967295|v>>>9),v=E+(L^P^w)+M[1]+2763975236&4294967295,E=L+(v<<4&4294967295|v>>>28),v=w+(E^L^P)+M[4]+1272893353&4294967295,w=E+(v<<11&4294967295|v>>>21),v=P+(w^E^L)+M[7]+4139469664&4294967295,P=w+(v<<16&4294967295|v>>>16),v=L+(P^w^E)+M[10]+3200236656&4294967295,L=P+(v<<23&4294967295|v>>>9),v=E+(L^P^w)+M[13]+681279174&4294967295,E=L+(v<<4&4294967295|v>>>28),v=w+(E^L^P)+M[0]+3936430074&4294967295,w=E+(v<<11&4294967295|v>>>21),v=P+(w^E^L)+M[3]+3572445317&4294967295,P=w+(v<<16&4294967295|v>>>16),v=L+(P^w^E)+M[6]+76029189&4294967295,L=P+(v<<23&4294967295|v>>>9),v=E+(L^P^w)+M[9]+3654602809&4294967295,E=L+(v<<4&4294967295|v>>>28),v=w+(E^L^P)+M[12]+3873151461&4294967295,w=E+(v<<11&4294967295|v>>>21),v=P+(w^E^L)+M[15]+530742520&4294967295,P=w+(v<<16&4294967295|v>>>16),v=L+(P^w^E)+M[2]+3299628645&4294967295,L=P+(v<<23&4294967295|v>>>9),v=E+(P^(L|~w))+M[0]+4096336452&4294967295,E=L+(v<<6&4294967295|v>>>26),v=w+(L^(E|~P))+M[7]+1126891415&4294967295,w=E+(v<<10&4294967295|v>>>22),v=P+(E^(w|~L))+M[14]+2878612391&4294967295,P=w+(v<<15&4294967295|v>>>17),v=L+(w^(P|~E))+M[5]+4237533241&4294967295,L=P+(v<<21&4294967295|v>>>11),v=E+(P^(L|~w))+M[12]+1700485571&4294967295,E=L+(v<<6&4294967295|v>>>26),v=w+(L^(E|~P))+M[3]+2399980690&4294967295,w=E+(v<<10&4294967295|v>>>22),v=P+(E^(w|~L))+M[10]+4293915773&4294967295,P=w+(v<<15&4294967295|v>>>17),v=L+(w^(P|~E))+M[1]+2240044497&4294967295,L=P+(v<<21&4294967295|v>>>11),v=E+(P^(L|~w))+M[8]+1873313359&4294967295,E=L+(v<<6&4294967295|v>>>26),v=w+(L^(E|~P))+M[15]+4264355552&4294967295,w=E+(v<<10&4294967295|v>>>22),v=P+(E^(w|~L))+M[6]+2734768916&4294967295,P=w+(v<<15&4294967295|v>>>17),v=L+(w^(P|~E))+M[13]+1309151649&4294967295,L=P+(v<<21&4294967295|v>>>11),v=E+(P^(L|~w))+M[4]+4149444226&4294967295,E=L+(v<<6&4294967295|v>>>26),v=w+(L^(E|~P))+M[11]+3174756917&4294967295,w=E+(v<<10&4294967295|v>>>22),v=P+(E^(w|~L))+M[2]+718787259&4294967295,P=w+(v<<15&4294967295|v>>>17),v=L+(w^(P|~E))+M[9]+3951481745&4294967295,I.g[0]=I.g[0]+E&4294967295,I.g[1]=I.g[1]+(P+(v<<21&4294967295|v>>>11))&4294967295,I.g[2]=I.g[2]+P&4294967295,I.g[3]=I.g[3]+w&4294967295}n.prototype.u=function(I,E){E===void 0&&(E=I.length);for(var L=E-this.blockSize,M=this.B,P=this.h,w=0;w<E;){if(P==0)for(;w<=L;)i(this,I,w),w+=this.blockSize;if(typeof I=="string"){for(;w<E;)if(M[P++]=I.charCodeAt(w++),P==this.blockSize){i(this,M),P=0;break}}else for(;w<E;)if(M[P++]=I[w++],P==this.blockSize){i(this,M),P=0;break}}this.h=P,this.o+=E},n.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var E=1;E<I.length-8;++E)I[E]=0;var L=8*this.o;for(E=I.length-8;E<I.length;++E)I[E]=L&255,L/=256;for(this.u(I),I=Array(16),E=L=0;4>E;++E)for(var M=0;32>M;M+=8)I[L++]=this.g[E]>>>M&255;return I};function o(I,E){var L=l;return Object.prototype.hasOwnProperty.call(L,I)?L[I]:L[I]=E(I)}function s(I,E){this.h=E;for(var L=[],M=!0,P=I.length-1;0<=P;P--){var w=I[P]|0;M&&w==E||(L[P]=w,M=!1)}this.g=L}var l={};function c(I){return-128<=I&&128>I?o(I,function(E){return new s([E|0],0>E?-1:0)}):new s([I|0],0>I?-1:0)}function d(I){if(isNaN(I)||!isFinite(I))return h;if(0>I)return x(d(-I));for(var E=[],L=1,M=0;I>=L;M++)E[M]=I/L|0,L*=4294967296;return new s(E,0)}function u(I,E){if(I.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(I.charAt(0)=="-")return x(u(I.substring(1),E));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var L=d(Math.pow(E,8)),M=h,P=0;P<I.length;P+=8){var w=Math.min(8,I.length-P),v=parseInt(I.substring(P,P+w),E);8>w?(w=d(Math.pow(E,w)),M=M.j(w).add(d(v))):(M=M.j(L),M=M.add(d(v)))}return M}var h=c(0),g=c(1),m=c(16777216);t=s.prototype,t.m=function(){if(N(this))return-x(this).m();for(var I=0,E=1,L=0;L<this.g.length;L++){var M=this.i(L);I+=(0<=M?M:4294967296+M)*E,E*=4294967296}return I},t.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(S(this))return"0";if(N(this))return"-"+x(this).toString(I);for(var E=d(Math.pow(I,6)),L=this,M="";;){var P=F(L,E).g;L=b(L,P.j(E));var w=((0<L.g.length?L.g[0]:L.h)>>>0).toString(I);if(L=P,S(L))return w+M;for(;6>w.length;)w="0"+w;M=w+M}},t.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function S(I){if(I.h!=0)return!1;for(var E=0;E<I.g.length;E++)if(I.g[E]!=0)return!1;return!0}function N(I){return I.h==-1}t.l=function(I){return I=b(this,I),N(I)?-1:S(I)?0:1};function x(I){for(var E=I.g.length,L=[],M=0;M<E;M++)L[M]=~I.g[M];return new s(L,~I.h).add(g)}t.abs=function(){return N(this)?x(this):this},t.add=function(I){for(var E=Math.max(this.g.length,I.g.length),L=[],M=0,P=0;P<=E;P++){var w=M+(this.i(P)&65535)+(I.i(P)&65535),v=(w>>>16)+(this.i(P)>>>16)+(I.i(P)>>>16);M=v>>>16,w&=65535,v&=65535,L[P]=v<<16|w}return new s(L,L[L.length-1]&-2147483648?-1:0)};function b(I,E){return I.add(x(E))}t.j=function(I){if(S(this)||S(I))return h;if(N(this))return N(I)?x(this).j(x(I)):x(x(this).j(I));if(N(I))return x(this.j(x(I)));if(0>this.l(m)&&0>I.l(m))return d(this.m()*I.m());for(var E=this.g.length+I.g.length,L=[],M=0;M<2*E;M++)L[M]=0;for(M=0;M<this.g.length;M++)for(var P=0;P<I.g.length;P++){var w=this.i(M)>>>16,v=this.i(M)&65535,j=I.i(P)>>>16,z=I.i(P)&65535;L[2*M+2*P]+=v*z,K(L,2*M+2*P),L[2*M+2*P+1]+=w*z,K(L,2*M+2*P+1),L[2*M+2*P+1]+=v*j,K(L,2*M+2*P+1),L[2*M+2*P+2]+=w*j,K(L,2*M+2*P+2)}for(M=0;M<E;M++)L[M]=L[2*M+1]<<16|L[2*M];for(M=E;M<2*E;M++)L[M]=0;return new s(L,0)};function K(I,E){for(;(I[E]&65535)!=I[E];)I[E+1]+=I[E]>>>16,I[E]&=65535,E++}function te(I,E){this.g=I,this.h=E}function F(I,E){if(S(E))throw Error("division by zero");if(S(I))return new te(h,h);if(N(I))return E=F(x(I),E),new te(x(E.g),x(E.h));if(N(E))return E=F(I,x(E)),new te(x(E.g),E.h);if(30<I.g.length){if(N(I)||N(E))throw Error("slowDivide_ only works with positive integers.");for(var L=g,M=E;0>=M.l(I);)L=V(L),M=V(M);var P=W(L,1),w=W(M,1);for(M=W(M,2),L=W(L,2);!S(M);){var v=w.add(M);0>=v.l(I)&&(P=P.add(L),w=v),M=W(M,1),L=W(L,1)}return E=b(I,P.j(E)),new te(P,E)}for(P=h;0<=I.l(E);){for(L=Math.max(1,Math.floor(I.m()/E.m())),M=Math.ceil(Math.log(L)/Math.LN2),M=48>=M?1:Math.pow(2,M-48),w=d(L),v=w.j(E);N(v)||0<v.l(I);)L-=M,w=d(L),v=w.j(E);S(w)&&(w=g),P=P.add(w),I=b(I,v)}return new te(P,I)}t.A=function(I){return F(this,I).h},t.and=function(I){for(var E=Math.max(this.g.length,I.g.length),L=[],M=0;M<E;M++)L[M]=this.i(M)&I.i(M);return new s(L,this.h&I.h)},t.or=function(I){for(var E=Math.max(this.g.length,I.g.length),L=[],M=0;M<E;M++)L[M]=this.i(M)|I.i(M);return new s(L,this.h|I.h)},t.xor=function(I){for(var E=Math.max(this.g.length,I.g.length),L=[],M=0;M<E;M++)L[M]=this.i(M)^I.i(M);return new s(L,this.h^I.h)};function V(I){for(var E=I.g.length+1,L=[],M=0;M<E;M++)L[M]=I.i(M)<<1|I.i(M-1)>>>31;return new s(L,I.h)}function W(I,E){var L=E>>5;E%=32;for(var M=I.g.length-L,P=[],w=0;w<M;w++)P[w]=0<E?I.i(w+L)>>>E|I.i(w+L+1)<<32-E:I.i(w+L);return new s(P,I.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,W2=n,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=d,s.fromString=u,Da=s}).apply(typeof qv<"u"?qv:typeof self<"u"?self:typeof window<"u"?window:{});var Gu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Y2,wd,K2,Ah,My,Q2,J2,X2;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,ie,fe){return f==Array.prototype||f==Object.prototype||(f[ie]=fe.value),f};function r(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof Gu=="object"&&Gu];for(var ie=0;ie<f.length;++ie){var fe=f[ie];if(fe&&fe.Math==Math)return fe}throw Error("Cannot find global object")}var n=r(this);function i(f,ie){if(ie)e:{var fe=n;f=f.split(".");for(var Ae=0;Ae<f.length-1;Ae++){var Je=f[Ae];if(!(Je in fe))break e;fe=fe[Je]}f=f[f.length-1],Ae=fe[f],ie=ie(Ae),ie!=Ae&&ie!=null&&e(fe,f,{configurable:!0,writable:!0,value:ie})}}function o(f,ie){f instanceof String&&(f+="");var fe=0,Ae=!1,Je={next:function(){if(!Ae&&fe<f.length){var st=fe++;return{value:ie(st,f[st]),done:!1}}return Ae=!0,{done:!0,value:void 0}}};return Je[Symbol.iterator]=function(){return Je},Je}i("Array.prototype.values",function(f){return f||function(){return o(this,function(ie,fe){return fe})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},l=this||self;function c(f){var ie=typeof f;return ie=ie!="object"?ie:f?Array.isArray(f)?"array":ie:"null",ie=="array"||ie=="object"&&typeof f.length=="number"}function d(f){var ie=typeof f;return ie=="object"&&f!=null||ie=="function"}function u(f,ie,fe){return f.call.apply(f.bind,arguments)}function h(f,ie,fe){if(!f)throw Error();if(2<arguments.length){var Ae=Array.prototype.slice.call(arguments,2);return function(){var Je=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Je,Ae),f.apply(ie,Je)}}return function(){return f.apply(ie,arguments)}}function g(f,ie,fe){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:h,g.apply(null,arguments)}function m(f,ie){var fe=Array.prototype.slice.call(arguments,1);return function(){var Ae=fe.slice();return Ae.push.apply(Ae,arguments),f.apply(this,Ae)}}function S(f,ie){function fe(){}fe.prototype=ie.prototype,f.aa=ie.prototype,f.prototype=new fe,f.prototype.constructor=f,f.Qb=function(Ae,Je,st){for(var Tt=Array(arguments.length-2),Pr=2;Pr<arguments.length;Pr++)Tt[Pr-2]=arguments[Pr];return ie.prototype[Je].apply(Ae,Tt)}}function N(f){const ie=f.length;if(0<ie){const fe=Array(ie);for(let Ae=0;Ae<ie;Ae++)fe[Ae]=f[Ae];return fe}return[]}function x(f,ie){for(let fe=1;fe<arguments.length;fe++){const Ae=arguments[fe];if(c(Ae)){const Je=f.length||0,st=Ae.length||0;f.length=Je+st;for(let Tt=0;Tt<st;Tt++)f[Je+Tt]=Ae[Tt]}else f.push(Ae)}}class b{constructor(ie,fe){this.i=ie,this.j=fe,this.h=0,this.g=null}get(){let ie;return 0<this.h?(this.h--,ie=this.g,this.g=ie.next,ie.next=null):ie=this.i(),ie}}function K(f){return/^[\s\xa0]*$/.test(f)}function te(){var f=l.navigator;return f&&(f=f.userAgent)?f:""}function F(f){return F[" "](f),f}F[" "]=function(){};var V=te().indexOf("Gecko")!=-1&&!(te().toLowerCase().indexOf("webkit")!=-1&&te().indexOf("Edge")==-1)&&!(te().indexOf("Trident")!=-1||te().indexOf("MSIE")!=-1)&&te().indexOf("Edge")==-1;function W(f,ie,fe){for(const Ae in f)ie.call(fe,f[Ae],Ae,f)}function I(f,ie){for(const fe in f)ie.call(void 0,f[fe],fe,f)}function E(f){const ie={};for(const fe in f)ie[fe]=f[fe];return ie}const L="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(f,ie){let fe,Ae;for(let Je=1;Je<arguments.length;Je++){Ae=arguments[Je];for(fe in Ae)f[fe]=Ae[fe];for(let st=0;st<L.length;st++)fe=L[st],Object.prototype.hasOwnProperty.call(Ae,fe)&&(f[fe]=Ae[fe])}}function P(f){var ie=1;f=f.split(":");const fe=[];for(;0<ie&&f.length;)fe.push(f.shift()),ie--;return f.length&&fe.push(f.join(":")),fe}function w(f){l.setTimeout(()=>{throw f},0)}function v(){var f=X;let ie=null;return f.g&&(ie=f.g,f.g=f.g.next,f.g||(f.h=null),ie.next=null),ie}class j{constructor(){this.h=this.g=null}add(ie,fe){const Ae=z.get();Ae.set(ie,fe),this.h?this.h.next=Ae:this.g=Ae,this.h=Ae}}var z=new b(()=>new T,f=>f.reset());class T{constructor(){this.next=this.g=this.h=null}set(ie,fe){this.h=ie,this.g=fe,this.next=null}reset(){this.next=this.g=this.h=null}}let R,J=!1,X=new j,H=()=>{const f=l.Promise.resolve(void 0);R=()=>{f.then(se)}};var se=()=>{for(var f;f=v();){try{f.h.call(f.g)}catch(fe){w(fe)}var ie=z;ie.j(f),100>ie.h&&(ie.h++,f.next=ie.g,ie.g=f)}J=!1};function O(){this.s=this.s,this.C=this.C}O.prototype.s=!1,O.prototype.ma=function(){this.s||(this.s=!0,this.N())},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function _(f,ie){this.type=f,this.g=this.target=ie,this.defaultPrevented=!1}_.prototype.h=function(){this.defaultPrevented=!0};var k=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var f=!1,ie=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const fe=()=>{};l.addEventListener("test",fe,ie),l.removeEventListener("test",fe,ie)}catch{}return f}();function $(f,ie){if(_.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var fe=this.type=f.type,Ae=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=ie,ie=f.relatedTarget){if(V){e:{try{F(ie.nodeName);var Je=!0;break e}catch{}Je=!1}Je||(ie=null)}}else fe=="mouseover"?ie=f.fromElement:fe=="mouseout"&&(ie=f.toElement);this.relatedTarget=ie,Ae?(this.clientX=Ae.clientX!==void 0?Ae.clientX:Ae.pageX,this.clientY=Ae.clientY!==void 0?Ae.clientY:Ae.pageY,this.screenX=Ae.screenX||0,this.screenY=Ae.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:G[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&$.aa.h.call(this)}}S($,_);var G={2:"touch",3:"pen",4:"mouse"};$.prototype.h=function(){$.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var ne="closure_listenable_"+(1e6*Math.random()|0),U=0;function D(f,ie,fe,Ae,Je){this.listener=f,this.proxy=null,this.src=ie,this.type=fe,this.capture=!!Ae,this.ha=Je,this.key=++U,this.da=this.fa=!1}function B(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Q(f){this.src=f,this.g={},this.h=0}Q.prototype.add=function(f,ie,fe,Ae,Je){var st=f.toString();f=this.g[st],f||(f=this.g[st]=[],this.h++);var Tt=oe(f,ie,Ae,Je);return-1<Tt?(ie=f[Tt],fe||(ie.fa=!1)):(ie=new D(ie,this.src,st,!!Ae,Je),ie.fa=fe,f.push(ie)),ie};function Z(f,ie){var fe=ie.type;if(fe in f.g){var Ae=f.g[fe],Je=Array.prototype.indexOf.call(Ae,ie,void 0),st;(st=0<=Je)&&Array.prototype.splice.call(Ae,Je,1),st&&(B(ie),f.g[fe].length==0&&(delete f.g[fe],f.h--))}}function oe(f,ie,fe,Ae){for(var Je=0;Je<f.length;++Je){var st=f[Je];if(!st.da&&st.listener==ie&&st.capture==!!fe&&st.ha==Ae)return Je}return-1}var de="closure_lm_"+(1e6*Math.random()|0),re={};function Y(f,ie,fe,Ae,Je){if(Array.isArray(ie)){for(var st=0;st<ie.length;st++)Y(f,ie[st],fe,Ae,Je);return null}return fe=Ie(fe),f&&f[ne]?f.K(ie,fe,d(Ae)?!!Ae.capture:!1,Je):ce(f,ie,fe,!1,Ae,Je)}function ce(f,ie,fe,Ae,Je,st){if(!ie)throw Error("Invalid event type");var Tt=d(Je)?!!Je.capture:!!Je,Pr=ve(f);if(Pr||(f[de]=Pr=new Q(f)),fe=Pr.add(ie,fe,Ae,Tt,st),fe.proxy)return fe;if(Ae=ue(),fe.proxy=Ae,Ae.src=f,Ae.listener=fe,f.addEventListener)k||(Je=Tt),Je===void 0&&(Je=!1),f.addEventListener(ie.toString(),Ae,Je);else if(f.attachEvent)f.attachEvent(me(ie.toString()),Ae);else if(f.addListener&&f.removeListener)f.addListener(Ae);else throw Error("addEventListener and attachEvent are unavailable.");return fe}function ue(){function f(fe){return ie.call(f.src,f.listener,fe)}const ie=pe;return f}function ae(f,ie,fe,Ae,Je){if(Array.isArray(ie))for(var st=0;st<ie.length;st++)ae(f,ie[st],fe,Ae,Je);else Ae=d(Ae)?!!Ae.capture:!!Ae,fe=Ie(fe),f&&f[ne]?(f=f.i,ie=String(ie).toString(),ie in f.g&&(st=f.g[ie],fe=oe(st,fe,Ae,Je),-1<fe&&(B(st[fe]),Array.prototype.splice.call(st,fe,1),st.length==0&&(delete f.g[ie],f.h--)))):f&&(f=ve(f))&&(ie=f.g[ie.toString()],f=-1,ie&&(f=oe(ie,fe,Ae,Je)),(fe=-1<f?ie[f]:null)&&ye(fe))}function ye(f){if(typeof f!="number"&&f&&!f.da){var ie=f.src;if(ie&&ie[ne])Z(ie.i,f);else{var fe=f.type,Ae=f.proxy;ie.removeEventListener?ie.removeEventListener(fe,Ae,f.capture):ie.detachEvent?ie.detachEvent(me(fe),Ae):ie.addListener&&ie.removeListener&&ie.removeListener(Ae),(fe=ve(ie))?(Z(fe,f),fe.h==0&&(fe.src=null,ie[de]=null)):B(f)}}}function me(f){return f in re?re[f]:re[f]="on"+f}function pe(f,ie){if(f.da)f=!0;else{ie=new $(ie,this);var fe=f.listener,Ae=f.ha||f.src;f.fa&&ye(f),f=fe.call(Ae,ie)}return f}function ve(f){return f=f[de],f instanceof Q?f:null}var Ne="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ie(f){return typeof f=="function"?f:(f[Ne]||(f[Ne]=function(ie){return f.handleEvent(ie)}),f[Ne])}function Ce(){O.call(this),this.i=new Q(this),this.M=this,this.F=null}S(Ce,O),Ce.prototype[ne]=!0,Ce.prototype.removeEventListener=function(f,ie,fe,Ae){ae(this,f,ie,fe,Ae)};function Ee(f,ie){var fe,Ae=f.F;if(Ae)for(fe=[];Ae;Ae=Ae.F)fe.push(Ae);if(f=f.M,Ae=ie.type||ie,typeof ie=="string")ie=new _(ie,f);else if(ie instanceof _)ie.target=ie.target||f;else{var Je=ie;ie=new _(Ae,f),M(ie,Je)}if(Je=!0,fe)for(var st=fe.length-1;0<=st;st--){var Tt=ie.g=fe[st];Je=we(Tt,Ae,!0,ie)&&Je}if(Tt=ie.g=f,Je=we(Tt,Ae,!0,ie)&&Je,Je=we(Tt,Ae,!1,ie)&&Je,fe)for(st=0;st<fe.length;st++)Tt=ie.g=fe[st],Je=we(Tt,Ae,!1,ie)&&Je}Ce.prototype.N=function(){if(Ce.aa.N.call(this),this.i){var f=this.i,ie;for(ie in f.g){for(var fe=f.g[ie],Ae=0;Ae<fe.length;Ae++)B(fe[Ae]);delete f.g[ie],f.h--}}this.F=null},Ce.prototype.K=function(f,ie,fe,Ae){return this.i.add(String(f),ie,!1,fe,Ae)},Ce.prototype.L=function(f,ie,fe,Ae){return this.i.add(String(f),ie,!0,fe,Ae)};function we(f,ie,fe,Ae){if(ie=f.i.g[String(ie)],!ie)return!0;ie=ie.concat();for(var Je=!0,st=0;st<ie.length;++st){var Tt=ie[st];if(Tt&&!Tt.da&&Tt.capture==fe){var Pr=Tt.listener,Tr=Tt.ha||Tt.src;Tt.fa&&Z(f.i,Tt),Je=Pr.call(Tr,Ae)!==!1&&Je}}return Je&&!Ae.defaultPrevented}function Re(f,ie,fe){if(typeof f=="function")fe&&(f=g(f,fe));else if(f&&typeof f.handleEvent=="function")f=g(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(ie)?-1:l.setTimeout(f,ie||0)}function He(f){f.g=Re(()=>{f.g=null,f.i&&(f.i=!1,He(f))},f.l);const ie=f.h;f.h=null,f.m.apply(null,ie)}class je extends O{constructor(ie,fe){super(),this.m=ie,this.l=fe,this.h=null,this.i=!1,this.g=null}j(ie){this.h=arguments,this.g?this.i=!0:He(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ve(f){O.call(this),this.h=f,this.g={}}S(Ve,O);var qe=[];function tt(f){W(f.g,function(ie,fe){this.g.hasOwnProperty(fe)&&ye(ie)},f),f.g={}}Ve.prototype.N=function(){Ve.aa.N.call(this),tt(this)},Ve.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var rt=l.JSON.stringify,Be=l.JSON.parse,Ge=class{stringify(f){return l.JSON.stringify(f,void 0)}parse(f){return l.JSON.parse(f,void 0)}};function Fe(){}Fe.prototype.h=null;function at(f){return f.h||(f.h=f.i())}function lt(){}var Xe={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ct(){_.call(this,"d")}S(Ct,_);function Le(){_.call(this,"c")}S(Le,_);var nt={},We=null;function kt(){return We=We||new Ce}nt.La="serverreachability";function Et(f){_.call(this,nt.La,f)}S(Et,_);function Ot(f){const ie=kt();Ee(ie,new Et(ie))}nt.STAT_EVENT="statevent";function jt(f,ie){_.call(this,nt.STAT_EVENT,f),this.stat=ie}S(jt,_);function mt(f){const ie=kt();Ee(ie,new jt(ie,f))}nt.Ma="timingevent";function Zt(f,ie){_.call(this,nt.Ma,f),this.size=ie}S(Zt,_);function rr(f,ie){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){f()},ie)}function Dt(){this.g=!0}Dt.prototype.xa=function(){this.g=!1};function Kt(f,ie,fe,Ae,Je,st){f.info(function(){if(f.g)if(st)for(var Tt="",Pr=st.split("&"),Tr=0;Tr<Pr.length;Tr++){var _r=Pr[Tr].split("=");if(1<_r.length){var Wr=_r[0];_r=_r[1];var sn=Wr.split("_");Tt=2<=sn.length&&sn[1]=="type"?Tt+(Wr+"="+_r+"&"):Tt+(Wr+"=redacted&")}}else Tt=null;else Tt=st;return"XMLHTTP REQ ("+Ae+") [attempt "+Je+"]: "+ie+`
`+fe+`
`+Tt})}function dt(f,ie,fe,Ae,Je,st,Tt){f.info(function(){return"XMLHTTP RESP ("+Ae+") [ attempt "+Je+"]: "+ie+`
`+fe+`
`+st+" "+Tt})}function pt(f,ie,fe,Ae){f.info(function(){return"XMLHTTP TEXT ("+ie+"): "+bt(f,fe)+(Ae?" "+Ae:"")})}function ze(f,ie){f.info(function(){return"TIMEOUT: "+ie})}Dt.prototype.info=function(){};function bt(f,ie){if(!f.g)return ie;if(!ie)return null;try{var fe=JSON.parse(ie);if(fe){for(f=0;f<fe.length;f++)if(Array.isArray(fe[f])){var Ae=fe[f];if(!(2>Ae.length)){var Je=Ae[1];if(Array.isArray(Je)&&!(1>Je.length)){var st=Je[0];if(st!="noop"&&st!="stop"&&st!="close")for(var Tt=1;Tt<Je.length;Tt++)Je[Tt]=""}}}}return rt(fe)}catch{return ie}}var Mt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ft={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},At;function Ht(){}S(Ht,Fe),Ht.prototype.g=function(){return new XMLHttpRequest},Ht.prototype.i=function(){return{}},At=new Ht;function Yt(f,ie,fe,Ae){this.j=f,this.i=ie,this.l=fe,this.R=Ae||1,this.U=new Ve(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new nr}function nr(){this.i=null,this.g="",this.h=!1}var Dr={},vr={};function tr(f,ie,fe){f.L=1,f.v=So(Fr(ie)),f.m=fe,f.P=!0,Bt(f,null)}function Bt(f,ie){f.F=Date.now(),$r(f),f.A=Fr(f.v);var fe=f.A,Ae=f.R;Array.isArray(Ae)||(Ae=[String(Ae)]),pr(fe.i,"t",Ae),f.C=0,fe=f.j.J,f.h=new nr,f.g=be(f.j,fe?ie:null,!f.m),0<f.O&&(f.M=new je(g(f.Y,f,f.g),f.O)),ie=f.U,fe=f.g,Ae=f.ca;var Je="readystatechange";Array.isArray(Je)||(Je&&(qe[0]=Je.toString()),Je=qe);for(var st=0;st<Je.length;st++){var Tt=Y(fe,Je[st],Ae||ie.handleEvent,!1,ie.h||ie);if(!Tt)break;ie.g[Tt.key]=Tt}ie=f.H?E(f.H):{},f.m?(f.u||(f.u="POST"),ie["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,ie)):(f.u="GET",f.g.ea(f.A,f.u,null,ie)),Ot(),Kt(f.i,f.u,f.A,f.l,f.R,f.m)}Yt.prototype.ca=function(f){f=f.target;const ie=this.M;ie&&Vn(f)==3?ie.j():this.Y(f)},Yt.prototype.Y=function(f){try{if(f==this.g)e:{const sn=Vn(this.g);var ie=this.g.Ba();const To=this.g.Z();if(!(3>sn)&&(sn!=3||this.g&&(this.h.h||this.g.oa()||ql(this.g)))){this.J||sn!=4||ie==7||(ie==8||0>=To?Ot(3):Ot(2)),sr(this);var fe=this.g.Z();this.X=fe;t:if(ar(this)){var Ae=ql(this.g);f="";var Je=Ae.length,st=Vn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){dr(this),Ir(this);var Tt="";break t}this.h.i=new l.TextDecoder}for(ie=0;ie<Je;ie++)this.h.h=!0,f+=this.h.i.decode(Ae[ie],{stream:!(st&&ie==Je-1)});Ae.length=0,this.h.g+=f,this.C=0,Tt=this.h.g}else Tt=this.g.oa();if(this.o=fe==200,dt(this.i,this.u,this.A,this.l,this.R,sn,fe),this.o){if(this.T&&!this.K){t:{if(this.g){var Pr,Tr=this.g;if((Pr=Tr.g?Tr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(Pr)){var _r=Pr;break t}}_r=null}if(fe=_r)pt(this.i,this.l,fe,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,rn(this,fe);else{this.o=!1,this.s=3,mt(12),dr(this),Ir(this);break e}}if(this.P){fe=!0;let ri;for(;!this.J&&this.C<Tt.length;)if(ri=br(this,Tt),ri==vr){sn==4&&(this.s=4,mt(14),fe=!1),pt(this.i,this.l,null,"[Incomplete Response]");break}else if(ri==Dr){this.s=4,mt(15),pt(this.i,this.l,Tt,"[Invalid Chunk]"),fe=!1;break}else pt(this.i,this.l,ri,null),rn(this,ri);if(ar(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),sn!=4||Tt.length!=0||this.h.h||(this.s=1,mt(16),fe=!1),this.o=this.o&&fe,!fe)pt(this.i,this.l,Tt,"[Invalid Chunked Response]"),dr(this),Ir(this);else if(0<Tt.length&&!this.W){this.W=!0;var Wr=this.j;Wr.g==this&&Wr.ba&&!Wr.M&&(Wr.j.info("Great, no buffering proxy detected. Bytes received: "+Tt.length),na(Wr),Wr.M=!0,mt(11))}}else pt(this.i,this.l,Tt,null),rn(this,Tt);sn==4&&dr(this),this.o&&!this.J&&(sn==4?Wo(this.j,this):(this.o=!1,$r(this)))}else Ho(this.g),fe==400&&0<Tt.indexOf("Unknown SID")?(this.s=3,mt(12)):(this.s=0,mt(13)),dr(this),Ir(this)}}}catch{}finally{}};function ar(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function br(f,ie){var fe=f.C,Ae=ie.indexOf(`
`,fe);return Ae==-1?vr:(fe=Number(ie.substring(fe,Ae)),isNaN(fe)?Dr:(Ae+=1,Ae+fe>ie.length?vr:(ie=ie.slice(Ae,Ae+fe),f.C=Ae+fe,ie)))}Yt.prototype.cancel=function(){this.J=!0,dr(this)};function $r(f){f.S=Date.now()+f.I,mr(f,f.I)}function mr(f,ie){if(f.B!=null)throw Error("WatchDog timer not null");f.B=rr(g(f.ba,f),ie)}function sr(f){f.B&&(l.clearTimeout(f.B),f.B=null)}Yt.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(ze(this.i,this.A),this.L!=2&&(Ot(),mt(17)),dr(this),this.s=2,Ir(this)):mr(this,this.S-f)};function Ir(f){f.j.G==0||f.J||Wo(f.j,f)}function dr(f){sr(f);var ie=f.M;ie&&typeof ie.ma=="function"&&ie.ma(),f.M=null,tt(f.U),f.g&&(ie=f.g,f.g=null,ie.abort(),ie.ma())}function rn(f,ie){try{var fe=f.j;if(fe.G!=0&&(fe.g==f||so(fe.h,f))){if(!f.K&&so(fe.h,f)&&fe.G==3){try{var Ae=fe.Da.g.parse(ie)}catch{Ae=null}if(Array.isArray(Ae)&&Ae.length==3){var Je=Ae;if(Je[0]==0){e:if(!fe.u){if(fe.g)if(fe.g.F+3e3<f.F)Io(fe),Zs(fe);else break e;vs(fe),mt(18)}}else fe.za=Je[1],0<fe.za-fe.T&&37500>Je[2]&&fe.F&&fe.v==0&&!fe.C&&(fe.C=rr(g(fe.Za,fe),6e3));if(1>=Wn(fe.h)&&fe.ca){try{fe.ca()}catch{}fe.ca=void 0}}else ci(fe,11)}else if((f.K||fe.g==f)&&Io(fe),!K(ie))for(Je=fe.Da.g.parse(ie),ie=0;ie<Je.length;ie++){let _r=Je[ie];if(fe.T=_r[0],_r=_r[1],fe.G==2)if(_r[0]=="c"){fe.K=_r[1],fe.ia=_r[2];const Wr=_r[3];Wr!=null&&(fe.la=Wr,fe.j.info("VER="+fe.la));const sn=_r[4];sn!=null&&(fe.Aa=sn,fe.j.info("SVER="+fe.Aa));const To=_r[5];To!=null&&typeof To=="number"&&0<To&&(Ae=1.5*To,fe.L=Ae,fe.j.info("backChannelRequestTimeoutMs_="+Ae)),Ae=fe;const ri=f.g;if(ri){const Yo=ri.g?ri.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Yo){var st=Ae.h;st.g||Yo.indexOf("spdy")==-1&&Yo.indexOf("quic")==-1&&Yo.indexOf("h2")==-1||(st.j=st.l,st.g=new Set,st.h&&(Ur(st,st.h),st.h=null))}if(Ae.D){const Ko=ri.g?ri.g.getResponseHeader("X-HTTP-Session-Id"):null;Ko&&(Ae.ya=Ko,zr(Ae.I,Ae.D,Ko))}}fe.G=3,fe.l&&fe.l.ua(),fe.ba&&(fe.R=Date.now()-f.F,fe.j.info("Handshake RTT: "+fe.R+"ms")),Ae=fe;var Tt=f;if(Ae.qa=q(Ae,Ae.J?Ae.ia:null,Ae.W),Tt.K){Ri(Ae.h,Tt);var Pr=Tt,Tr=Ae.L;Tr&&(Pr.I=Tr),Pr.B&&(sr(Pr),$r(Pr)),Ae.g=Tt}else ra(Ae);0<fe.i.length&&ea(fe)}else _r[0]!="stop"&&_r[0]!="close"||ci(fe,7);else fe.G==3&&(_r[0]=="stop"||_r[0]=="close"?_r[0]=="stop"?ci(fe,7):Eo(fe):_r[0]!="noop"&&fe.l&&fe.l.ta(_r),fe.v=0)}}Ot(4)}catch{}}var Zn=class{constructor(f,ie){this.g=f,this.map=ie}};function Gn(f){this.l=f||10,l.PerformanceNavigationTiming?(f=l.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Li(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Wn(f){return f.h?1:f.g?f.g.size:0}function so(f,ie){return f.h?f.h==ie:f.g?f.g.has(ie):!1}function Ur(f,ie){f.g?f.g.add(ie):f.h=ie}function Ri(f,ie){f.h&&f.h==ie?f.h=null:f.g&&f.g.has(ie)&&f.g.delete(ie)}Gn.prototype.cancel=function(){if(this.i=Po(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Po(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let ie=f.i;for(const fe of f.g.values())ie=ie.concat(fe.D);return ie}return N(f.i)}function _o(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(c(f)){for(var ie=[],fe=f.length,Ae=0;Ae<fe;Ae++)ie.push(f[Ae]);return ie}ie=[],fe=0;for(Ae in f)ie[fe++]=f[Ae];return ie}function fr(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(c(f)||typeof f=="string"){var ie=[];f=f.length;for(var fe=0;fe<f;fe++)ie.push(fe);return ie}ie=[],fe=0;for(const Ae in f)ie[fe++]=Ae;return ie}}}function jr(f,ie){if(f.forEach&&typeof f.forEach=="function")f.forEach(ie,void 0);else if(c(f)||typeof f=="string")Array.prototype.forEach.call(f,ie,void 0);else for(var fe=fr(f),Ae=_o(f),Je=Ae.length,st=0;st<Je;st++)ie.call(void 0,Ae[st],fe&&fe[st],f)}var nn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ei(f,ie){if(f){f=f.split("&");for(var fe=0;fe<f.length;fe++){var Ae=f[fe].indexOf("="),Je=null;if(0<=Ae){var st=f[fe].substring(0,Ae);Je=f[fe].substring(Ae+1)}else st=f[fe];ie(st,Je?decodeURIComponent(Je.replace(/\+/g," ")):"")}}}function Hr(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof Hr){this.h=f.h,wi(this,f.j),this.o=f.o,this.g=f.g,Di(this,f.s),this.l=f.l;var ie=f.i,fe=new qo;fe.i=ie.i,ie.g&&(fe.g=new Map(ie.g),fe.h=ie.h),Wi(this,fe),this.m=f.m}else f&&(ie=String(f).match(nn))?(this.h=!1,wi(this,ie[1]||"",!0),this.o=wo(ie[2]||""),this.g=wo(ie[3]||"",!0),Di(this,ie[4]),this.l=wo(ie[5]||"",!0),Wi(this,ie[6]||"",!0),this.m=wo(ie[7]||"")):(this.h=!1,this.i=new qo(null,this.h))}Hr.prototype.toString=function(){var f=[],ie=this.j;ie&&f.push(xo(ie,Bl,!0),":");var fe=this.g;return(fe||ie=="file")&&(f.push("//"),(ie=this.o)&&f.push(xo(ie,Bl,!0),"@"),f.push(encodeURIComponent(String(fe)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),fe=this.s,fe!=null&&f.push(":",String(fe))),(fe=this.l)&&(this.g&&fe.charAt(0)!="/"&&f.push("/"),f.push(xo(fe,fe.charAt(0)=="/"?Co:Kc,!0))),(fe=this.i.toString())&&f.push("?",fe),(fe=this.m)&&f.push("#",xo(fe,Ws)),f.join("")};function Fr(f){return new Hr(f)}function wi(f,ie,fe){f.j=fe?wo(ie,!0):ie,f.j&&(f.j=f.j.replace(/:$/,""))}function Di(f,ie){if(ie){if(ie=Number(ie),isNaN(ie)||0>ie)throw Error("Bad port number "+ie);f.s=ie}else f.s=null}function Wi(f,ie,fe){ie instanceof qo?(f.i=ie,Qc(f.i,f.h)):(fe||(ie=xo(ie,Gs)),f.i=new qo(ie,f.h))}function zr(f,ie,fe){f.i.set(ie,fe)}function So(f){return zr(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function wo(f,ie){return f?ie?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function xo(f,ie,fe){return typeof f=="string"?(f=encodeURI(f).replace(ie,Yc),fe&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function Yc(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var Bl=/[#\/\?@]/g,Kc=/[#\?:]/g,Co=/[#\?]/g,Gs=/[#\?@]/g,Ws=/#/g;function qo(f,ie){this.h=this.g=null,this.i=f||null,this.j=!!ie}function yn(f){f.g||(f.g=new Map,f.h=0,f.i&&ei(f.i,function(ie,fe){f.add(decodeURIComponent(ie.replace(/\+/g," ")),fe)}))}t=qo.prototype,t.add=function(f,ie){yn(this),this.i=null,f=Uo(this,f);var fe=this.g.get(f);return fe||this.g.set(f,fe=[]),fe.push(ie),this.h+=1,this};function Vl(f,ie){yn(f),ie=Uo(f,ie),f.g.has(ie)&&(f.i=null,f.h-=f.g.get(ie).length,f.g.delete(ie))}function Ya(f,ie){return yn(f),ie=Uo(f,ie),f.g.has(ie)}t.forEach=function(f,ie){yn(this),this.g.forEach(function(fe,Ae){fe.forEach(function(Je){f.call(ie,Je,Ae,this)},this)},this)},t.na=function(){yn(this);const f=Array.from(this.g.values()),ie=Array.from(this.g.keys()),fe=[];for(let Ae=0;Ae<ie.length;Ae++){const Je=f[Ae];for(let st=0;st<Je.length;st++)fe.push(ie[Ae])}return fe},t.V=function(f){yn(this);let ie=[];if(typeof f=="string")Ya(this,f)&&(ie=ie.concat(this.g.get(Uo(this,f))));else{f=Array.from(this.g.values());for(let fe=0;fe<f.length;fe++)ie=ie.concat(f[fe])}return ie},t.set=function(f,ie){return yn(this),this.i=null,f=Uo(this,f),Ya(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[ie]),this.h+=1,this},t.get=function(f,ie){return f?(f=this.V(f),0<f.length?String(f[0]):ie):ie};function pr(f,ie,fe){Vl(f,ie),0<fe.length&&(f.i=null,f.g.set(Uo(f,ie),N(fe)),f.h+=fe.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],ie=Array.from(this.g.keys());for(var fe=0;fe<ie.length;fe++){var Ae=ie[fe];const st=encodeURIComponent(String(Ae)),Tt=this.V(Ae);for(Ae=0;Ae<Tt.length;Ae++){var Je=st;Tt[Ae]!==""&&(Je+="="+encodeURIComponent(String(Tt[Ae]))),f.push(Je)}}return this.i=f.join("&")};function Uo(f,ie){return ie=String(ie),f.j&&(ie=ie.toLowerCase()),ie}function Qc(f,ie){ie&&!f.j&&(yn(f),f.i=null,f.g.forEach(function(fe,Ae){var Je=Ae.toLowerCase();Ae!=Je&&(Vl(this,Ae),pr(this,Je,fe))},f)),f.j=ie}function ao(f,ie){const fe=new Dt;if(l.Image){const Ae=new Image;Ae.onload=m(Yi,fe,"TestLoadImage: loaded",!0,ie,Ae),Ae.onerror=m(Yi,fe,"TestLoadImage: error",!1,ie,Ae),Ae.onabort=m(Yi,fe,"TestLoadImage: abort",!1,ie,Ae),Ae.ontimeout=m(Yi,fe,"TestLoadImage: timeout",!1,ie,Ae),l.setTimeout(function(){Ae.ontimeout&&Ae.ontimeout()},1e4),Ae.src=f}else ie(!1)}function jl(f,ie){const fe=new Dt,Ae=new AbortController,Je=setTimeout(()=>{Ae.abort(),Yi(fe,"TestPingServer: timeout",!1,ie)},1e4);fetch(f,{signal:Ae.signal}).then(st=>{clearTimeout(Je),st.ok?Yi(fe,"TestPingServer: ok",!0,ie):Yi(fe,"TestPingServer: server error",!1,ie)}).catch(()=>{clearTimeout(Je),Yi(fe,"TestPingServer: error",!1,ie)})}function Yi(f,ie,fe,Ae,Je){try{Je&&(Je.onload=null,Je.onerror=null,Je.onabort=null,Je.ontimeout=null),Ae(fe)}catch{}}function Ys(){this.g=new Ge}function Ka(f,ie,fe){const Ae=fe||"";try{jr(f,function(Je,st){let Tt=Je;d(Je)&&(Tt=rt(Je)),ie.push(Ae+st+"="+encodeURIComponent(Tt))})}catch(Je){throw ie.push(Ae+"type="+encodeURIComponent("_badmap")),Je}}function Ks(f){this.l=f.Ub||null,this.j=f.eb||!1}S(Ks,Fe),Ks.prototype.g=function(){return new Qs(this.l,this.j)},Ks.prototype.i=function(f){return function(){return f}}({});function Qs(f,ie){Ce.call(this),this.D=f,this.o=ie,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}S(Qs,Ce),t=Qs.prototype,t.open=function(f,ie){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=ie,this.readyState=1,Ki(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const ie={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(ie.body=f),(this.D||l).fetch(new Request(this.A,ie)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ao(this)),this.readyState=0},t.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Ki(this)),this.g&&(this.readyState=3,Ki(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;zl(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function zl(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}t.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var ie=f.value?f.value:new Uint8Array(0);(ie=this.v.decode(ie,{stream:!f.done}))&&(this.response=this.responseText+=ie)}f.done?Ao(this):Ki(this),this.readyState==3&&zl(this)}},t.Ra=function(f){this.g&&(this.response=this.responseText=f,Ao(this))},t.Qa=function(f){this.g&&(this.response=f,Ao(this))},t.ga=function(){this.g&&Ao(this)};function Ao(f){f.readyState=4,f.l=null,f.j=null,f.v=null,Ki(f)}t.setRequestHeader=function(f,ie){this.u.append(f,ie)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],ie=this.h.entries();for(var fe=ie.next();!fe.done;)fe=fe.value,f.push(fe[0]+": "+fe[1]),fe=ie.next();return f.join(`\r
`)};function Ki(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Qs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function $o(f){let ie="";return W(f,function(fe,Ae){ie+=Ae,ie+=":",ie+=fe,ie+=`\r
`}),ie}function Qa(f,ie,fe){e:{for(Ae in fe){var Ae=!1;break e}Ae=!0}Ae||(fe=$o(fe),typeof f=="string"?fe!=null&&encodeURIComponent(String(fe)):zr(f,ie,fe))}function Gr(f){Ce.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}S(Gr,Ce);var Ja=/^https?$/i,Js=["POST","PUT"];t=Gr.prototype,t.Ha=function(f){this.J=f},t.ea=function(f,ie,fe,Ae){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);ie=ie?ie.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():At.g(),this.v=this.o?at(this.o):at(At),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(ie,String(f),!0),this.B=!1}catch(st){Xa(this,st);return}if(f=fe||"",fe=new Map(this.headers),Ae)if(Object.getPrototypeOf(Ae)===Object.prototype)for(var Je in Ae)fe.set(Je,Ae[Je]);else if(typeof Ae.keys=="function"&&typeof Ae.get=="function")for(const st of Ae.keys())fe.set(st,Ae.get(st));else throw Error("Unknown input type for opt_headers: "+String(Ae));Ae=Array.from(fe.keys()).find(st=>st.toLowerCase()=="content-type"),Je=l.FormData&&f instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Js,ie,void 0))||Ae||Je||fe.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[st,Tt]of fe)this.g.setRequestHeader(st,Tt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Qi(this),this.u=!0,this.g.send(f),this.u=!1}catch(st){Xa(this,st)}};function Xa(f,ie){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=ie,f.m=5,Za(f),ys(f)}function Za(f){f.A||(f.A=!0,Ee(f,"complete"),Ee(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,Ee(this,"complete"),Ee(this,"abort"),ys(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ys(this,!0)),Gr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?el(this):this.bb())},t.bb=function(){el(this)};function el(f){if(f.h&&typeof s<"u"&&(!f.v[1]||Vn(f)!=4||f.Z()!=2)){if(f.u&&Vn(f)==4)Re(f.Ea,0,f);else if(Ee(f,"readystatechange"),Vn(f)==4){f.h=!1;try{const Tt=f.Z();e:switch(Tt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var ie=!0;break e;default:ie=!1}var fe;if(!(fe=ie)){var Ae;if(Ae=Tt===0){var Je=String(f.D).match(nn)[1]||null;!Je&&l.self&&l.self.location&&(Je=l.self.location.protocol.slice(0,-1)),Ae=!Ja.test(Je?Je.toLowerCase():"")}fe=Ae}if(fe)Ee(f,"complete"),Ee(f,"success");else{f.m=6;try{var st=2<Vn(f)?f.g.statusText:""}catch{st=""}f.l=st+" ["+f.Z()+"]",Za(f)}}finally{ys(f)}}}}function ys(f,ie){if(f.g){Qi(f);const fe=f.g,Ae=f.v[0]?()=>{}:null;f.g=null,f.v=null,ie||Ee(f,"ready");try{fe.onreadystatechange=Ae}catch{}}}function Qi(f){f.I&&(l.clearTimeout(f.I),f.I=null)}t.isActive=function(){return!!this.g};function Vn(f){return f.g?f.g.readyState:0}t.Z=function(){try{return 2<Vn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(f){if(this.g){var ie=this.g.responseText;return f&&ie.indexOf(f)==0&&(ie=ie.substring(f.length)),Be(ie)}};function ql(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function Ho(f){const ie={};f=(f.g&&2<=Vn(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let Ae=0;Ae<f.length;Ae++){if(K(f[Ae]))continue;var fe=P(f[Ae]);const Je=fe[0];if(fe=fe[1],typeof fe!="string")continue;fe=fe.trim();const st=ie[Je]||[];ie[Je]=st,st.push(fe)}I(ie,function(Ae){return Ae.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ti(f,ie,fe){return fe&&fe.internalChannelParams&&fe.internalChannelParams[f]||ie}function Xs(f){this.Aa=0,this.i=[],this.j=new Dt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ti("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ti("baseRetryDelayMs",5e3,f),this.cb=ti("retryDelaySeedMs",1e4,f),this.Wa=ti("forwardChannelMaxRetries",2,f),this.wa=ti("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new Gn(f&&f.concurrentRequestLimit),this.Da=new Ys,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Xs.prototype,t.la=8,t.G=1,t.connect=function(f,ie,fe,Ae){mt(0),this.W=f,this.H=ie||{},fe&&Ae!==void 0&&(this.H.OSID=fe,this.H.OAID=Ae),this.F=this.X,this.I=q(this,null,this.W),ea(this)};function Eo(f){if(fs(f),f.G==3){var ie=f.U++,fe=Fr(f.I);if(zr(fe,"SID",f.K),zr(fe,"RID",ie),zr(fe,"TYPE","terminate"),Go(f,fe),ie=new Yt(f,f.j,ie),ie.L=2,ie.v=So(Fr(fe)),fe=!1,l.navigator&&l.navigator.sendBeacon)try{fe=l.navigator.sendBeacon(ie.v.toString(),"")}catch{}!fe&&l.Image&&(new Image().src=ie.v,fe=!0),fe||(ie.g=be(ie.j,null),ie.g.ea(ie.v)),ie.F=Date.now(),$r(ie)}oa(f)}function Zs(f){f.g&&(na(f),f.g.cancel(),f.g=null)}function fs(f){Zs(f),f.u&&(l.clearTimeout(f.u),f.u=null),Io(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&l.clearTimeout(f.s),f.s=null)}function ea(f){if(!Li(f.h)&&!f.s){f.s=!0;var ie=f.Ga;R||H(),J||(R(),J=!0),X.add(ie,f),f.B=0}}function tl(f,ie){return Wn(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=ie.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=rr(g(f.Ga,f,ie),ia(f,f.B)),f.B++,!0)}t.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const Je=new Yt(this,this.j,f);let st=this.o;if(this.S&&(st?(st=E(st),M(st,this.S)):st=this.S),this.m!==null||this.O||(Je.H=st,st=null),this.P)e:{for(var ie=0,fe=0;fe<this.i.length;fe++){t:{var Ae=this.i[fe];if("__data__"in Ae.map&&(Ae=Ae.map.__data__,typeof Ae=="string")){Ae=Ae.length;break t}Ae=void 0}if(Ae===void 0)break;if(ie+=Ae,4096<ie){ie=fe;break e}if(ie===4096||fe===this.i.length-1){ie=fe+1;break e}}ie=1e3}else ie=1e3;ie=gs(this,Je,ie),fe=Fr(this.I),zr(fe,"RID",f),zr(fe,"CVER",22),this.D&&zr(fe,"X-HTTP-Session-Id",this.D),Go(this,fe),st&&(this.O?ie="headers="+encodeURIComponent(String($o(st)))+"&"+ie:this.m&&Qa(fe,this.m,st)),Ur(this.h,Je),this.Ua&&zr(fe,"TYPE","init"),this.P?(zr(fe,"$req",ie),zr(fe,"SID","null"),Je.T=!0,tr(Je,fe,null)):tr(Je,fe,ie),this.G=2}}else this.G==3&&(f?ta(this,f):this.i.length==0||Li(this.h)||ta(this))};function ta(f,ie){var fe;ie?fe=ie.l:fe=f.U++;const Ae=Fr(f.I);zr(Ae,"SID",f.K),zr(Ae,"RID",fe),zr(Ae,"AID",f.T),Go(f,Ae),f.m&&f.o&&Qa(Ae,f.m,f.o),fe=new Yt(f,f.j,fe,f.B+1),f.m===null&&(fe.H=f.o),ie&&(f.i=ie.D.concat(f.i)),ie=gs(f,fe,1e3),fe.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),Ur(f.h,fe),tr(fe,Ae,ie)}function Go(f,ie){f.H&&W(f.H,function(fe,Ae){zr(ie,Ae,fe)}),f.l&&jr({},function(fe,Ae){zr(ie,Ae,fe)})}function gs(f,ie,fe){fe=Math.min(f.i.length,fe);var Ae=f.l?g(f.l.Na,f.l,f):null;e:{var Je=f.i;let st=-1;for(;;){const Tt=["count="+fe];st==-1?0<fe?(st=Je[0].g,Tt.push("ofs="+st)):st=0:Tt.push("ofs="+st);let Pr=!0;for(let Tr=0;Tr<fe;Tr++){let _r=Je[Tr].g;const Wr=Je[Tr].map;if(_r-=st,0>_r)st=Math.max(0,Je[Tr].g-100),Pr=!1;else try{Ka(Wr,Tt,"req"+_r+"_")}catch{Ae&&Ae(Wr)}}if(Pr){Ae=Tt.join("&");break e}}}return f=f.i.splice(0,fe),ie.D=f,Ae}function ra(f){if(!f.g&&!f.u){f.Y=1;var ie=f.Fa;R||H(),J||(R(),J=!0),X.add(ie,f),f.v=0}}function vs(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=rr(g(f.Fa,f),ia(f,f.v)),f.v++,!0)}t.Fa=function(){if(this.u=null,Ul(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=rr(g(this.ab,this),f)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,mt(10),Zs(this),Ul(this))};function na(f){f.A!=null&&(l.clearTimeout(f.A),f.A=null)}function Ul(f){f.g=new Yt(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var ie=Fr(f.qa);zr(ie,"RID","rpc"),zr(ie,"SID",f.K),zr(ie,"AID",f.T),zr(ie,"CI",f.F?"0":"1"),!f.F&&f.ja&&zr(ie,"TO",f.ja),zr(ie,"TYPE","xmlhttp"),Go(f,ie),f.m&&f.o&&Qa(ie,f.m,f.o),f.L&&(f.g.I=f.L);var fe=f.g;f=f.ia,fe.L=1,fe.v=So(Fr(ie)),fe.m=null,fe.P=!0,Bt(fe,f)}t.Za=function(){this.C!=null&&(this.C=null,Zs(this),vs(this),mt(19))};function Io(f){f.C!=null&&(l.clearTimeout(f.C),f.C=null)}function Wo(f,ie){var fe=null;if(f.g==ie){Io(f),na(f),f.g=null;var Ae=2}else if(so(f.h,ie))fe=ie.D,Ri(f.h,ie),Ae=1;else return;if(f.G!=0){if(ie.o)if(Ae==1){fe=ie.m?ie.m.length:0,ie=Date.now()-ie.F;var Je=f.B;Ae=kt(),Ee(Ae,new Zt(Ae,fe)),ea(f)}else ra(f);else if(Je=ie.s,Je==3||Je==0&&0<ie.X||!(Ae==1&&tl(f,ie)||Ae==2&&vs(f)))switch(fe&&0<fe.length&&(ie=f.h,ie.i=ie.i.concat(fe)),Je){case 1:ci(f,5);break;case 4:ci(f,10);break;case 3:ci(f,6);break;default:ci(f,2)}}}function ia(f,ie){let fe=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(fe*=2),fe*ie}function ci(f,ie){if(f.j.info("Error code "+ie),ie==2){var fe=g(f.fb,f),Ae=f.Xa;const Je=!Ae;Ae=new Hr(Ae||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||wi(Ae,"https"),So(Ae),Je?ao(Ae.toString(),fe):jl(Ae.toString(),fe)}else mt(2);f.G=0,f.l&&f.l.sa(ie),oa(f),fs(f)}t.fb=function(f){f?(this.j.info("Successfully pinged google.com"),mt(2)):(this.j.info("Failed to ping google.com"),mt(1))};function oa(f){if(f.G=0,f.ka=[],f.l){const ie=Po(f.h);(ie.length!=0||f.i.length!=0)&&(x(f.ka,ie),x(f.ka,f.i),f.h.i.length=0,N(f.i),f.i.length=0),f.l.ra()}}function q(f,ie,fe){var Ae=fe instanceof Hr?Fr(fe):new Hr(fe);if(Ae.g!="")ie&&(Ae.g=ie+"."+Ae.g),Di(Ae,Ae.s);else{var Je=l.location;Ae=Je.protocol,ie=ie?ie+"."+Je.hostname:Je.hostname,Je=+Je.port;var st=new Hr(null);Ae&&wi(st,Ae),ie&&(st.g=ie),Je&&Di(st,Je),fe&&(st.l=fe),Ae=st}return fe=f.D,ie=f.ya,fe&&ie&&zr(Ae,fe,ie),zr(Ae,"VER",f.la),Go(f,Ae),Ae}function be(f,ie,fe){if(ie&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return ie=f.Ca&&!f.pa?new Gr(new Ks({eb:fe})):new Gr(f.pa),ie.Ha(f.J),ie}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Oe(){}t=Oe.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Ue(){}Ue.prototype.g=function(f,ie){return new Ze(f,ie)};function Ze(f,ie){Ce.call(this),this.g=new Xs(ie),this.l=f,this.h=ie&&ie.messageUrlParams||null,f=ie&&ie.messageHeaders||null,ie&&ie.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=ie&&ie.initMessageHeaders||null,ie&&ie.messageContentType&&(f?f["X-WebChannel-Content-Type"]=ie.messageContentType:f={"X-WebChannel-Content-Type":ie.messageContentType}),ie&&ie.va&&(f?f["X-WebChannel-Client-Profile"]=ie.va:f={"X-WebChannel-Client-Profile":ie.va}),this.g.S=f,(f=ie&&ie.Sb)&&!K(f)&&(this.g.m=f),this.v=ie&&ie.supportsCrossDomainXhr||!1,this.u=ie&&ie.sendRawJson||!1,(ie=ie&&ie.httpSessionIdParam)&&!K(ie)&&(this.g.D=ie,f=this.h,f!==null&&ie in f&&(f=this.h,ie in f&&delete f[ie])),this.j=new qt(this)}S(Ze,Ce),Ze.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ze.prototype.close=function(){Eo(this.g)},Ze.prototype.o=function(f){var ie=this.g;if(typeof f=="string"){var fe={};fe.__data__=f,f=fe}else this.u&&(fe={},fe.__data__=rt(f),f=fe);ie.i.push(new Zn(ie.Ya++,f)),ie.G==3&&ea(ie)},Ze.prototype.N=function(){this.g.l=null,delete this.j,Eo(this.g),delete this.g,Ze.aa.N.call(this)};function ht(f){Ct.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var ie=f.__sm__;if(ie){e:{for(const fe in ie){f=fe;break e}f=void 0}(this.i=f)&&(f=this.i,ie=ie!==null&&f in ie?ie[f]:void 0),this.data=ie}else this.data=f}S(ht,Ct);function It(){Le.call(this),this.status=1}S(It,Le);function qt(f){this.g=f}S(qt,Oe),qt.prototype.ua=function(){Ee(this.g,"a")},qt.prototype.ta=function(f){Ee(this.g,new ht(f))},qt.prototype.sa=function(f){Ee(this.g,new It)},qt.prototype.ra=function(){Ee(this.g,"b")},Ue.prototype.createWebChannel=Ue.prototype.g,Ze.prototype.send=Ze.prototype.o,Ze.prototype.open=Ze.prototype.m,Ze.prototype.close=Ze.prototype.close,X2=function(){return new Ue},J2=function(){return kt()},Q2=nt,My={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Mt.NO_ERROR=0,Mt.TIMEOUT=8,Mt.HTTP_ERROR=6,Ah=Mt,ft.COMPLETE="complete",K2=ft,lt.EventType=Xe,Xe.OPEN="a",Xe.CLOSE="b",Xe.ERROR="c",Xe.MESSAGE="d",Ce.prototype.listen=Ce.prototype.K,wd=lt,Gr.prototype.listenOnce=Gr.prototype.L,Gr.prototype.getLastError=Gr.prototype.Ka,Gr.prototype.getLastErrorCode=Gr.prototype.Ba,Gr.prototype.getStatus=Gr.prototype.Z,Gr.prototype.getResponseJson=Gr.prototype.Oa,Gr.prototype.getResponseText=Gr.prototype.oa,Gr.prototype.send=Gr.prototype.ea,Gr.prototype.setWithCredentials=Gr.prototype.Ha,Y2=Gr}).apply(typeof Gu<"u"?Gu:typeof self<"u"?self:typeof window<"u"?window:{});const Uv="@firebase/firestore",Hv="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}vi.UNAUTHENTICATED=new vi(null),vi.GOOGLE_CREDENTIALS=new vi("google-credentials-uid"),vi.FIRST_PARTY=new vi("first-party-uid"),vi.MOCK_USER=new vi("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qc="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kl=new If("@firebase/firestore");function pc(){return kl.logLevel}function Xt(t,...e){if(kl.logLevel<=Nr.DEBUG){const r=e.map(zf);kl.debug(`Firestore (${qc}): ${t}`,...r)}}function Bs(t,...e){if(kl.logLevel<=Nr.ERROR){const r=e.map(zf);kl.error(`Firestore (${qc}): ${t}`,...r)}}function Tc(t,...e){if(kl.logLevel<=Nr.WARN){const r=e.map(zf);kl.warn(`Firestore (${qc}): ${t}`,...r)}}function zf(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hr(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,Z2(t,n,r)}function Z2(t,e,r){let n=`FIRESTORE (${qc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Bs(n),new Error(n)}function Kr(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||Z2(e,i,n)}function wr(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Vt extends Us{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e5{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class m3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(vi.UNAUTHENTICATED))}shutdown(){}}class y3{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class f3{constructor(e){this.t=e,this.currentUser=vi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Kr(this.o===void 0,42304);let n=this.i;const i=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let o=new Ms;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ms,e.enqueueRetryable(()=>i(this.currentUser))};const s=()=>{const c=o;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},l=c=>{Xt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Xt("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ms)}},0),s()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Xt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Kr(typeof n.accessToken=="string",31837,{l:n}),new e5(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Kr(e===null||typeof e=="string",2055,{h:e}),new vi(e)}}class g3{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=vi.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class v3{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new g3(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(vi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Gv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class b3{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,vo(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Kr(this.o===void 0,3512);const n=o=>{o.error!=null&&Xt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const s=o.token!==this.m;return this.m=o.token,Xt("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const i=o=>{Xt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):Xt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Gv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Kr(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new Gv(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P3(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qf{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=P3(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<r&&(n+=e.charAt(i[o]%62))}return n}}function Lr(t,e){return t<e?-1:t>e?1:0}function Fy(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),o=e.charAt(n);if(i!==o)return xm(i)===xm(o)?Lr(i,o):xm(i)?1:-1}return Lr(t.length,e.length)}const _3=55296,S3=57343;function xm(t){const e=t.charCodeAt(0);return e>=_3&&e<=S3}function kc(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wv="__name__";class ts{constructor(e,r,n){r===void 0?r=0:r>e.length&&hr(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&hr(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return ts.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof ts?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const o=ts.compareSegments(e.get(i),r.get(i));if(o!==0)return o}return Lr(e.length,r.length)}static compareSegments(e,r){const n=ts.isNumericId(e),i=ts.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?ts.extractNumericId(e).compare(ts.extractNumericId(r)):Fy(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Da.fromString(e.substring(4,e.length-2))}}class un extends ts{construct(e,r,n){return new un(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Vt(yt.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new un(r)}static emptyPath(){return new un([])}}const w3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class si extends ts{construct(e,r,n){return new si(e,r,n)}static isValidIdentifier(e){return w3.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),si.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Wv}static keyField(){return new si([Wv])}static fromServerFormat(e){const r=[];let n="",i=0;const o=()=>{if(n.length===0)throw new Vt(yt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let s=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new Vt(yt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Vt(yt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else l==="`"?(s=!s,i++):l!=="."||s?(n+=l,i++):(o(),i++)}if(o(),s)throw new Vt(yt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new si(r)}static emptyPath(){return new si([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(e){this.path=e}static fromPath(e){return new ir(un.fromString(e))}static fromName(e){return new ir(un.fromString(e).popFirst(5))}static empty(){return new ir(un.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&un.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return un.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ir(new un(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t5(t,e,r){if(!r)throw new Vt(yt.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function x3(t,e,r,n){if(e===!0&&n===!0)throw new Vt(yt.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function Yv(t){if(!ir.isDocumentKey(t))throw new Vt(yt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Kv(t){if(ir.isDocumentKey(t))throw new Vt(yt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function r5(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function _p(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":hr(12329,{type:typeof t})}function Vs(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Vt(yt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=_p(t);throw new Vt(yt.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function C3(t,e){if(e<=0)throw new Vt(yt.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function On(t,e){const r={typeString:t};return e&&(r.value=e),r}function pu(t,e){if(!r5(t))throw new Vt(yt.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const s=t[n];if(i&&typeof s!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(o!==void 0&&s!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new Vt(yt.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qv=-62135596800,Jv=1e6;class fn{static now(){return fn.fromMillis(Date.now())}static fromDate(e){return fn.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*Jv);return new fn(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Vt(yt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Vt(yt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<Qv)throw new Vt(yt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Vt(yt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Jv}_compareTo(e){return this.seconds===e.seconds?Lr(this.nanoseconds,e.nanoseconds):Lr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:fn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(pu(e,fn._jsonSchema))return new fn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Qv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}fn._jsonSchemaVersion="firestore/timestamp/1.0",fn._jsonSchema={type:On("string",fn._jsonSchemaVersion),seconds:On("number"),nanoseconds:On("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{static fromTimestamp(e){return new gr(e)}static min(){return new gr(new fn(0,0))}static max(){return new gr(new fn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qd=-1;function A3(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=gr.fromTimestamp(n===1e9?new fn(r+1,0):new fn(r,n));return new Oa(i,ir.empty(),e)}function $3(t){return new Oa(t.readTime,t.key,Qd)}class Oa{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Oa(gr.min(),ir.empty(),Qd)}static max(){return new Oa(gr.max(),ir.empty(),Qd)}}function E3(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=ir.comparator(t.documentKey,e.documentKey),r!==0?r:Lr(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I3="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class T3{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uc(t){if(t.code!==yt.FAILED_PRECONDITION||t.message!==I3)throw t;Xt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&hr(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new xt((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof xt?r:xt.resolve(r)}catch(r){return xt.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):xt.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):xt.reject(r)}static resolve(e){return new xt((r,n)=>{r(e)})}static reject(e){return new xt((r,n)=>{n(e)})}static waitFor(e){return new xt((r,n)=>{let i=0,o=0,s=!1;e.forEach(l=>{++i,l.next(()=>{++o,s&&o===i&&r()},c=>n(c))}),s=!0,o===i&&r()})}static or(e){let r=xt.resolve(!1);for(const n of e)r=r.next(i=>i?xt.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,o)=>{n.push(r.call(this,i,o))}),this.waitFor(n)}static mapArray(e,r){return new xt((n,i)=>{const o=e.length,s=new Array(o);let l=0;for(let c=0;c<o;c++){const d=c;r(e[d]).next(u=>{s[d]=u,++l,l===o&&n(s)},u=>i(u))}})}static doWhile(e,r){return new xt((n,i)=>{const o=()=>{e()===!0?r().next(()=>{o()},i):n()};o()})}}function k3(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Hc(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Sp.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uf=-1;function wp(t){return t==null}function Jh(t){return t===0&&1/t==-1/0}function N3(t){return typeof t=="number"&&Number.isInteger(t)&&!Jh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n5="";function L3(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=Xv(e)),e=R3(t.get(r),e);return Xv(e)}function R3(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const o=t.charAt(i);switch(o){case"\0":r+="";break;case n5:r+="";break;default:r+=o}}return r}function Xv(t){return t+n5+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zv(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Ga(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function i5(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e,r){this.comparator=e,this.root=r||oi.EMPTY}insert(e,r){return new _n(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,oi.BLACK,null,null))}remove(e){return new _n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,oi.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Wu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Wu(this.root,e,this.comparator,!1)}getReverseIterator(){return new Wu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Wu(this.root,e,this.comparator,!0)}}class Wu{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class oi{constructor(e,r,n,i,o){this.key=e,this.value=r,this.color=n??oi.RED,this.left=i??oi.EMPTY,this.right=o??oi.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,o){return new oi(e??this.key,r??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,r,n),null):o===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return oi.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return oi.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,oi.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,oi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw hr(43730,{key:this.key,value:this.value});if(this.right.isRed())throw hr(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw hr(27949);return e+(this.isRed()?0:1)}}oi.EMPTY=null,oi.RED=!0,oi.BLACK=!1;oi.EMPTY=new class{constructor(){this.size=0}get key(){throw hr(57766)}get value(){throw hr(16141)}get color(){throw hr(16727)}get left(){throw hr(29726)}get right(){throw hr(36894)}copy(e,r,n,i,o){return this}insert(e,r,n){return new oi(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e){this.comparator=e,this.data=new _n(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new e0(this.data.getIterator())}getIteratorFrom(e){return new e0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Hn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Hn(this.comparator);return r.data=e,r}}class e0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(e){this.fields=e,e.sort(si.comparator)}static empty(){return new ro([])}unionWith(e){let r=new Hn(si.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new ro(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return kc(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o5 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new o5("Invalid base64 string: "+o):o}}(e);return new li(r)}static fromUint8Array(e){const r=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new li(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Lr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}li.EMPTY_BYTE_STRING=new li("");const D3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ba(t){if(Kr(!!t,39018),typeof t=="string"){let e=0;const r=D3.exec(t);if(Kr(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:En(t.seconds),nanos:En(t.nanos)}}function En(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Va(t){return typeof t=="string"?li.fromBase64String(t):li.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s5="server_timestamp",a5="__type__",l5="__previous_value__",c5="__local_write_time__";function xp(t){return(t?.mapValue?.fields||{})[a5]?.stringValue===s5}function Cp(t){const e=t.mapValue.fields[l5];return xp(e)?Cp(e):e}function Jd(t){const e=Ba(t.mapValue.fields[c5].timestampValue);return new fn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M3{constructor(e,r,n,i,o,s,l,c,d,u){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=d,this.isUsingEmulator=u}}const Xh="(default)";class Xd{constructor(e,r){this.projectId=e,this.database=r||Xh}static empty(){return new Xd("","")}get isDefaultDatabase(){return this.database===Xh}isEqual(e){return e instanceof Xd&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d5="__type__",F3="__max__",Yu={mapValue:{}},u5="__vector__",Zh="value";function ja(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?xp(t)?4:B3(t)?9007199254740991:O3(t)?10:11:hr(28295,{value:t})}function ps(t,e){if(t===e)return!0;const r=ja(t);if(r!==ja(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Jd(t).isEqual(Jd(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const s=Ba(i.timestampValue),l=Ba(o.timestampValue);return s.seconds===l.seconds&&s.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return Va(i.bytesValue).isEqual(Va(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return En(i.geoPointValue.latitude)===En(o.geoPointValue.latitude)&&En(i.geoPointValue.longitude)===En(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return En(i.integerValue)===En(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const s=En(i.doubleValue),l=En(o.doubleValue);return s===l?Jh(s)===Jh(l):isNaN(s)&&isNaN(l)}return!1}(t,e);case 9:return kc(t.arrayValue.values||[],e.arrayValue.values||[],ps);case 10:case 11:return function(i,o){const s=i.mapValue.fields||{},l=o.mapValue.fields||{};if(Zv(s)!==Zv(l))return!1;for(const c in s)if(s.hasOwnProperty(c)&&(l[c]===void 0||!ps(s[c],l[c])))return!1;return!0}(t,e);default:return hr(52216,{left:t})}}function Zd(t,e){return(t.values||[]).find(r=>ps(r,e))!==void 0}function Nc(t,e){if(t===e)return 0;const r=ja(t),n=ja(e);if(r!==n)return Lr(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Lr(t.booleanValue,e.booleanValue);case 2:return function(o,s){const l=En(o.integerValue||o.doubleValue),c=En(s.integerValue||s.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return t0(t.timestampValue,e.timestampValue);case 4:return t0(Jd(t),Jd(e));case 5:return Fy(t.stringValue,e.stringValue);case 6:return function(o,s){const l=Va(o),c=Va(s);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(o,s){const l=o.split("/"),c=s.split("/");for(let d=0;d<l.length&&d<c.length;d++){const u=Lr(l[d],c[d]);if(u!==0)return u}return Lr(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,s){const l=Lr(En(o.latitude),En(s.latitude));return l!==0?l:Lr(En(o.longitude),En(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return r0(t.arrayValue,e.arrayValue);case 10:return function(o,s){const l=o.fields||{},c=s.fields||{},d=l[Zh]?.arrayValue,u=c[Zh]?.arrayValue,h=Lr(d?.values?.length||0,u?.values?.length||0);return h!==0?h:r0(d,u)}(t.mapValue,e.mapValue);case 11:return function(o,s){if(o===Yu.mapValue&&s===Yu.mapValue)return 0;if(o===Yu.mapValue)return 1;if(s===Yu.mapValue)return-1;const l=o.fields||{},c=Object.keys(l),d=s.fields||{},u=Object.keys(d);c.sort(),u.sort();for(let h=0;h<c.length&&h<u.length;++h){const g=Fy(c[h],u[h]);if(g!==0)return g;const m=Nc(l[c[h]],d[u[h]]);if(m!==0)return m}return Lr(c.length,u.length)}(t.mapValue,e.mapValue);default:throw hr(23264,{he:r})}}function t0(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Lr(t,e);const r=Ba(t),n=Ba(e),i=Lr(r.seconds,n.seconds);return i!==0?i:Lr(r.nanos,n.nanos)}function r0(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const o=Nc(r[i],n[i]);if(o)return o}return Lr(r.length,n.length)}function Lc(t){return Oy(t)}function Oy(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Ba(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Va(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return ir.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const o of r.values||[])i?i=!1:n+=",",n+=Oy(o);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const s of n)o?o=!1:i+=",",i+=`${s}:${Oy(r.fields[s])}`;return i+"}"}(t.mapValue):hr(61005,{value:t})}function $h(t){switch(ja(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Cp(t);return e?16+$h(e):16;case 5:return 2*t.stringValue.length;case 6:return Va(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,o)=>i+$h(o),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return Ga(n.fields,(o,s)=>{i+=o.length+$h(s)}),i}(t.mapValue);default:throw hr(13486,{value:t})}}function ep(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function By(t){return!!t&&"integerValue"in t}function Hf(t){return!!t&&"arrayValue"in t}function n0(t){return!!t&&"nullValue"in t}function i0(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Eh(t){return!!t&&"mapValue"in t}function O3(t){return(t?.mapValue?.fields||{})[d5]?.stringValue===u5}function Rd(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Ga(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Rd(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Rd(t.arrayValue.values[r]);return e}return{...t}}function B3(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===F3}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(e){this.value=e}static empty(){return new Hi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Eh(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Rd(r)}setAll(e){let r=si.emptyPath(),n={},i=[];e.forEach((s,l)=>{if(!r.isImmediateParentOf(l)){const c=this.getFieldsMap(r);this.applyChanges(c,n,i),n={},i=[],r=l.popLast()}s?n[l.lastSegment()]=Rd(s):i.push(l.lastSegment())});const o=this.getFieldsMap(r);this.applyChanges(o,n,i)}delete(e){const r=this.field(e.popLast());Eh(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ps(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];Eh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Ga(r,(i,o)=>e[i]=o);for(const i of n)delete e[i]}clone(){return new Hi(Rd(this.value))}}function h5(t){const e=[];return Ga(t.fields,(r,n)=>{const i=new si([r]);if(Eh(n)){const o=h5(n.mapValue).fields;if(o.length===0)e.push(i);else for(const s of o)e.push(i.child(s))}else e.push(i)}),new ro(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e,r,n,i,o,s,l){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=o,this.data=s,this.documentState=l}static newInvalidDocument(e){return new bi(e,0,gr.min(),gr.min(),gr.min(),Hi.empty(),0)}static newFoundDocument(e,r,n,i){return new bi(e,1,r,gr.min(),n,i,0)}static newNoDocument(e,r){return new bi(e,2,r,gr.min(),gr.min(),Hi.empty(),0)}static newUnknownDocument(e,r){return new bi(e,3,r,gr.min(),gr.min(),Hi.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(gr.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Hi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Hi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=gr.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof bi&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new bi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rc{constructor(e,r){this.position=e,this.inclusive=r}}function o0(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const o=e[i],s=t.position[i];if(o.field.isKeyField()?n=ir.comparator(ir.fromName(s.referenceValue),r.key):n=Nc(s,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function s0(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ps(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(e,r="asc"){this.field=e,this.dir=r}}function V3(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p5{}class Fn extends p5{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new z3(e,r,n):r==="array-contains"?new H3(e,n):r==="in"?new G3(e,n):r==="not-in"?new W3(e,n):r==="array-contains-any"?new Y3(e,n):new Fn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new q3(e,n):new U3(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Nc(r,this.value)):r!==null&&ja(this.value)===ja(r)&&this.matchesComparison(Nc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return hr(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Vo extends p5{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Vo(e,r)}matches(e){return m5(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function m5(t){return t.op==="and"}function y5(t){return j3(t)&&m5(t)}function j3(t){for(const e of t.filters)if(e instanceof Vo)return!1;return!0}function Vy(t){if(t instanceof Fn)return t.field.canonicalString()+t.op.toString()+Lc(t.value);if(y5(t))return t.filters.map(e=>Vy(e)).join(",");{const e=t.filters.map(r=>Vy(r)).join(",");return`${t.op}(${e})`}}function f5(t,e){return t instanceof Fn?function(n,i){return i instanceof Fn&&n.op===i.op&&n.field.isEqual(i.field)&&ps(n.value,i.value)}(t,e):t instanceof Vo?function(n,i){return i instanceof Vo&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((o,s,l)=>o&&f5(s,i.filters[l]),!0):!1}(t,e):void hr(19439)}function g5(t){return t instanceof Fn?function(r){return`${r.field.canonicalString()} ${r.op} ${Lc(r.value)}`}(t):t instanceof Vo?function(r){return r.op.toString()+" {"+r.getFilters().map(g5).join(" ,")+"}"}(t):"Filter"}class z3 extends Fn{constructor(e,r,n){super(e,r,n),this.key=ir.fromName(n.referenceValue)}matches(e){const r=ir.comparator(e.key,this.key);return this.matchesComparison(r)}}class q3 extends Fn{constructor(e,r){super(e,"in",r),this.keys=v5("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class U3 extends Fn{constructor(e,r){super(e,"not-in",r),this.keys=v5("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function v5(t,e){return(e.arrayValue?.values||[]).map(r=>ir.fromName(r.referenceValue))}class H3 extends Fn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Hf(r)&&Zd(r.arrayValue,this.value)}}class G3 extends Fn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Zd(this.value.arrayValue,r)}}class W3 extends Fn{constructor(e,r){super(e,"not-in",r)}matches(e){if(Zd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Zd(this.value.arrayValue,r)}}class Y3 extends Fn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Hf(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Zd(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K3{constructor(e,r=null,n=[],i=[],o=null,s=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=s,this.endAt=l,this.Te=null}}function a0(t,e=null,r=[],n=[],i=null,o=null,s=null){return new K3(t,e,r,n,i,o,s)}function Gf(t){const e=wr(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Vy(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),wp(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Lc(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Lc(n)).join(",")),e.Te=r}return e.Te}function Wf(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!V3(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!f5(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!s0(t.startAt,e.startAt)&&s0(t.endAt,e.endAt)}function jy(t){return ir.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(e,r=null,n=[],i=[],o=null,s="F",l=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=s,this.startAt=l,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Q3(t,e,r,n,i,o,s,l){return new Dl(t,e,r,n,i,o,s,l)}function Yf(t){return new Dl(t)}function l0(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Kf(t){return t.collectionGroup!==null}function wc(t){const e=wr(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let l=new Hn(si.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(o=>{r.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new eu(o,n))}),r.has(si.keyField().canonicalString())||e.Ie.push(new eu(si.keyField(),n))}return e.Ie}function os(t){const e=wr(t);return e.Ee||(e.Ee=J3(e,wc(t))),e.Ee}function J3(t,e){if(t.limitType==="F")return a0(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new eu(i.field,o)});const r=t.endAt?new Rc(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Rc(t.startAt.position,t.startAt.inclusive):null;return a0(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function zy(t,e){const r=t.filters.concat([e]);return new Dl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function tp(t,e,r){return new Dl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Ap(t,e){return Wf(os(t),os(e))&&t.limitType===e.limitType}function b5(t){return`${Gf(os(t))}|lt:${t.limitType}`}function mc(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>g5(i)).join(", ")}]`),wp(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Lc(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Lc(i)).join(",")),`Target(${n})`}(os(t))}; limitType=${t.limitType})`}function $p(t,e){return e.isFoundDocument()&&function(n,i){const o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):ir.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(t,e)&&function(n,i){for(const o of wc(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(s,l,c){const d=o0(s,l,c);return s.inclusive?d<=0:d<0}(n.startAt,wc(n),i)||n.endAt&&!function(s,l,c){const d=o0(s,l,c);return s.inclusive?d>=0:d>0}(n.endAt,wc(n),i))}(t,e)}function X3(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function P5(t){return(e,r)=>{let n=!1;for(const i of wc(t)){const o=Z3(i,e,r);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function Z3(t,e,r){const n=t.field.isKeyField()?ir.comparator(e.key,r.key):function(o,s,l){const c=s.data.field(o),d=l.data.field(o);return c!==null&&d!==null?Nc(c,d):hr(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return hr(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,o]of n)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ga(this.inner,(r,n)=>{for(const[i,o]of n)e(i,o)})}isEmpty(){return i5(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e4=new _n(ir.comparator);function js(){return e4}const _5=new _n(ir.comparator);function xd(...t){let e=_5;for(const r of t)e=e.insert(r.key,r);return e}function S5(t){let e=_5;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function bl(){return Dd()}function w5(){return Dd()}function Dd(){return new Ml(t=>t.toString(),(t,e)=>t.isEqual(e))}const t4=new _n(ir.comparator),r4=new Hn(ir.comparator);function Rr(...t){let e=r4;for(const r of t)e=e.add(r);return e}const n4=new Hn(Lr);function i4(){return n4}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qf(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Jh(e)?"-0":e}}function x5(t){return{integerValue:""+t}}function o4(t,e){return N3(e)?x5(e):Qf(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{constructor(){this._=void 0}}function s4(t,e,r){return t instanceof rp?function(i,o){const s={fields:{[a5]:{stringValue:s5},[c5]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&xp(o)&&(o=Cp(o)),o&&(s.fields[l5]=o),{mapValue:s}}(r,e):t instanceof tu?A5(t,e):t instanceof ru?$5(t,e):function(i,o){const s=C5(i,o),l=c0(s)+c0(i.Ae);return By(s)&&By(i.Ae)?x5(l):Qf(i.serializer,l)}(t,e)}function a4(t,e,r){return t instanceof tu?A5(t,e):t instanceof ru?$5(t,e):r}function C5(t,e){return t instanceof np?function(n){return By(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}class rp extends Ep{}class tu extends Ep{constructor(e){super(),this.elements=e}}function A5(t,e){const r=E5(e);for(const n of t.elements)r.some(i=>ps(i,n))||r.push(n);return{arrayValue:{values:r}}}class ru extends Ep{constructor(e){super(),this.elements=e}}function $5(t,e){let r=E5(e);for(const n of t.elements)r=r.filter(i=>!ps(i,n));return{arrayValue:{values:r}}}class np extends Ep{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function c0(t){return En(t.integerValue||t.doubleValue)}function E5(t){return Hf(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function l4(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof tu&&i instanceof tu||n instanceof ru&&i instanceof ru?kc(n.elements,i.elements,ps):n instanceof np&&i instanceof np?ps(n.Ae,i.Ae):n instanceof rp&&i instanceof rp}(t.transform,e.transform)}class c4{constructor(e,r){this.version=e,this.transformResults=r}}class ss{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new ss}static exists(e){return new ss(void 0,e)}static updateTime(e){return new ss(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ih(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ip{}function I5(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new k5(t.key,ss.none()):new mu(t.key,t.data,ss.none());{const r=t.data,n=Hi.empty();let i=new Hn(si.comparator);for(let o of e.fields)if(!i.has(o)){let s=r.field(o);s===null&&o.length>1&&(o=o.popLast(),s=r.field(o)),s===null?n.delete(o):n.set(o,s),i=i.add(o)}return new Wa(t.key,n,new ro(i.toArray()),ss.none())}}function d4(t,e,r){t instanceof mu?function(i,o,s){const l=i.value.clone(),c=u0(i.fieldTransforms,o,s.transformResults);l.setAll(c),o.convertToFoundDocument(s.version,l).setHasCommittedMutations()}(t,e,r):t instanceof Wa?function(i,o,s){if(!Ih(i.precondition,o))return void o.convertToUnknownDocument(s.version);const l=u0(i.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(T5(i)),c.setAll(l),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(t,e,r):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,r)}function Md(t,e,r,n){return t instanceof mu?function(o,s,l,c){if(!Ih(o.precondition,s))return l;const d=o.value.clone(),u=h0(o.fieldTransforms,c,s);return d.setAll(u),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),null}(t,e,r,n):t instanceof Wa?function(o,s,l,c){if(!Ih(o.precondition,s))return l;const d=h0(o.fieldTransforms,c,s),u=s.data;return u.setAll(T5(o)),u.setAll(d),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),l===null?null:l.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(o,s,l){return Ih(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):l}(t,e,r)}function u4(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),o=C5(n.transform,i||null);o!=null&&(r===null&&(r=Hi.empty()),r.set(n.field,o))}return r||null}function d0(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&kc(n,i,(o,s)=>l4(o,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class mu extends Ip{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Wa extends Ip{constructor(e,r,n,i,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function T5(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function u0(t,e,r){const n=new Map;Kr(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const o=t[i],s=o.transform,l=e.data.field(o.field);n.set(o.field,a4(s,l,r[i]))}return n}function h0(t,e,r){const n=new Map;for(const i of t){const o=i.transform,s=r.data.field(i.field);n.set(i.field,s4(o,s,e))}return n}class k5 extends Ip{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class h4 extends Ip{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p4{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&d4(o,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Md(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Md(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=w5();return this.mutations.forEach(i=>{const o=e.get(i.key),s=o.overlayedDocument;let l=this.applyToLocalView(s,o.mutatedFields);l=r.has(i.key)?null:l;const c=I5(s,l);c!==null&&n.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(gr.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Rr())}isEqual(e){return this.batchId===e.batchId&&kc(this.mutations,e.mutations,(r,n)=>d0(r,n))&&kc(this.baseMutations,e.baseMutations,(r,n)=>d0(r,n))}}class Jf{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Kr(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return t4}();const o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,n[s].version);return new Jf(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m4{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y4{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mn,Mr;function f4(t){switch(t){case yt.OK:return hr(64938);case yt.CANCELLED:case yt.UNKNOWN:case yt.DEADLINE_EXCEEDED:case yt.RESOURCE_EXHAUSTED:case yt.INTERNAL:case yt.UNAVAILABLE:case yt.UNAUTHENTICATED:return!1;case yt.INVALID_ARGUMENT:case yt.NOT_FOUND:case yt.ALREADY_EXISTS:case yt.PERMISSION_DENIED:case yt.FAILED_PRECONDITION:case yt.ABORTED:case yt.OUT_OF_RANGE:case yt.UNIMPLEMENTED:case yt.DATA_LOSS:return!0;default:return hr(15467,{code:t})}}function N5(t){if(t===void 0)return Bs("GRPC error has no .code"),yt.UNKNOWN;switch(t){case Mn.OK:return yt.OK;case Mn.CANCELLED:return yt.CANCELLED;case Mn.UNKNOWN:return yt.UNKNOWN;case Mn.DEADLINE_EXCEEDED:return yt.DEADLINE_EXCEEDED;case Mn.RESOURCE_EXHAUSTED:return yt.RESOURCE_EXHAUSTED;case Mn.INTERNAL:return yt.INTERNAL;case Mn.UNAVAILABLE:return yt.UNAVAILABLE;case Mn.UNAUTHENTICATED:return yt.UNAUTHENTICATED;case Mn.INVALID_ARGUMENT:return yt.INVALID_ARGUMENT;case Mn.NOT_FOUND:return yt.NOT_FOUND;case Mn.ALREADY_EXISTS:return yt.ALREADY_EXISTS;case Mn.PERMISSION_DENIED:return yt.PERMISSION_DENIED;case Mn.FAILED_PRECONDITION:return yt.FAILED_PRECONDITION;case Mn.ABORTED:return yt.ABORTED;case Mn.OUT_OF_RANGE:return yt.OUT_OF_RANGE;case Mn.UNIMPLEMENTED:return yt.UNIMPLEMENTED;case Mn.DATA_LOSS:return yt.DATA_LOSS;default:return hr(39323,{code:t})}}(Mr=Mn||(Mn={}))[Mr.OK=0]="OK",Mr[Mr.CANCELLED=1]="CANCELLED",Mr[Mr.UNKNOWN=2]="UNKNOWN",Mr[Mr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Mr[Mr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Mr[Mr.NOT_FOUND=5]="NOT_FOUND",Mr[Mr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Mr[Mr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Mr[Mr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Mr[Mr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Mr[Mr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Mr[Mr.ABORTED=10]="ABORTED",Mr[Mr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Mr[Mr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Mr[Mr.INTERNAL=13]="INTERNAL",Mr[Mr.UNAVAILABLE=14]="UNAVAILABLE",Mr[Mr.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g4(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v4=new Da([4294967295,4294967295],0);function p0(t){const e=g4().encode(t),r=new W2;return r.update(e),new Uint8Array(r.digest())}function m0(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Da([r,n],0),new Da([i,o],0)]}class Xf{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Cd(`Invalid padding: ${r}`);if(n<0)throw new Cd(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Cd(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Cd(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Da.fromNumber(this.ge)}ye(e,r,n){let i=e.add(r.multiply(Da.fromNumber(n)));return i.compare(v4)===1&&(i=new Da([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=p0(e),[n,i]=m0(r);for(let o=0;o<this.hashCount;o++){const s=this.ye(n,i,o);if(!this.we(s))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new Xf(o,i,r);return n.forEach(l=>s.insert(l)),s}insert(e){if(this.ge===0)return;const r=p0(e),[n,i]=m0(r);for(let o=0;o<this.hashCount;o++){const s=this.ye(n,i,o);this.Se(s)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Cd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp{constructor(e,r,n,i,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,yu.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Tp(gr.min(),i,new _n(Lr),js(),Rr())}}class yu{constructor(e,r,n,i,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new yu(n,r,Rr(),Rr(),Rr())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th{constructor(e,r,n,i){this.be=e,this.removedTargetIds=r,this.key=n,this.De=i}}class L5{constructor(e,r){this.targetId=e,this.Ce=r}}class R5{constructor(e,r,n=li.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class y0{constructor(){this.ve=0,this.Fe=f0(),this.Me=li.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Rr(),r=Rr(),n=Rr();return this.Fe.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:hr(38017,{changeType:o})}}),new yu(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=f0()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Kr(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class b4{constructor(e){this.Ge=e,this.ze=new Map,this.je=js(),this.Je=Ku(),this.He=Ku(),this.Ye=new _n(Lr)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:hr(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,i)=>{this.rt(i)&&r(i)})}st(e){const r=e.targetId,n=e.Ce.count,i=this.ot(r);if(i){const o=i.target;if(jy(o))if(n===0){const s=new ir(o.path);this.et(r,s,bi.newNoDocument(s,gr.min()))}else Kr(n===1,20013,{expectedCount:n});else{const s=this._t(r);if(s!==n){const l=this.ut(e),c=l?this.ct(l,e,s):1;if(c!==0){this.it(r);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,d)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=r;let s,l;try{s=Va(n).toUint8Array()}catch(c){if(c instanceof o5)return Tc("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new Xf(s,i,o)}catch(c){return Tc(c instanceof Cd?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.ge===0?null:l}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let i=0;return n.forEach(o=>{const s=this.Ge.ht(),l=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(l)||(this.et(r,o,null),i++)}),i}Tt(e){const r=new Map;this.ze.forEach((o,s)=>{const l=this.ot(s);if(l){if(o.current&&jy(l.target)){const c=new ir(l.target.path);this.It(c).has(s)||this.Et(s,c)||this.et(s,c,bi.newNoDocument(c,e))}o.Be&&(r.set(s,o.ke()),o.qe())}});let n=Rr();this.He.forEach((o,s)=>{let l=!0;s.forEachWhile(c=>{const d=this.ot(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(o))}),this.je.forEach((o,s)=>s.setReadTime(e));const i=new Tp(e,r,this.Ye,this.je,n);return this.je=js(),this.Je=Ku(),this.He=Ku(),this.Ye=new _n(Lr),i}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,r)?i.Qe(r,1):i.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new y0,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new Hn(Lr),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new Hn(Lr),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Xt("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new y0),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Ku(){return new _n(ir.comparator)}function f0(){return new _n(ir.comparator)}const P4={asc:"ASCENDING",desc:"DESCENDING"},_4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},S4={and:"AND",or:"OR"};class w4{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function qy(t,e){return t.useProto3Json||wp(e)?e:{value:e}}function ip(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function D5(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function x4(t,e){return ip(t,e.toTimestamp())}function as(t){return Kr(!!t,49232),gr.fromTimestamp(function(r){const n=Ba(r);return new fn(n.seconds,n.nanos)}(t))}function Zf(t,e){return Uy(t,e).canonicalString()}function Uy(t,e){const r=function(i){return new un(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function M5(t){const e=un.fromString(t);return Kr(j5(e),10190,{key:e.toString()}),e}function Hy(t,e){return Zf(t.databaseId,e.path)}function Cm(t,e){const r=M5(e);if(r.get(1)!==t.databaseId.projectId)throw new Vt(yt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Vt(yt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new ir(O5(r))}function F5(t,e){return Zf(t.databaseId,e)}function C4(t){const e=M5(t);return e.length===4?un.emptyPath():O5(e)}function Gy(t){return new un(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function O5(t){return Kr(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function g0(t,e,r){return{name:Hy(t,e),fields:r.value.mapValue.fields}}function A4(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:hr(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(d,u){return d.useProto3Json?(Kr(u===void 0||typeof u=="string",58123),li.fromBase64String(u||"")):(Kr(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),li.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,l=s&&function(d){const u=d.code===void 0?yt.UNKNOWN:N5(d.code);return new Vt(u,d.message||"")}(s);r=new R5(n,i,o,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Cm(t,n.document.name),o=as(n.document.updateTime),s=n.document.createTime?as(n.document.createTime):gr.min(),l=new Hi({mapValue:{fields:n.document.fields}}),c=bi.newFoundDocument(i,o,s,l),d=n.targetIds||[],u=n.removedTargetIds||[];r=new Th(d,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Cm(t,n.document),o=n.readTime?as(n.readTime):gr.min(),s=bi.newNoDocument(i,o),l=n.removedTargetIds||[];r=new Th([],l,s.key,s)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Cm(t,n.document),o=n.removedTargetIds||[];r=new Th([],o,i,null)}else{if(!("filter"in e))return hr(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:o}=n,s=new y4(i,o),l=n.targetId;r=new L5(l,s)}}return r}function $4(t,e){let r;if(e instanceof mu)r={update:g0(t,e.key,e.value)};else if(e instanceof k5)r={delete:Hy(t,e.key)};else if(e instanceof Wa)r={update:g0(t,e.key,e.data),updateMask:M4(e.fieldMask)};else{if(!(e instanceof h4))return hr(16599,{Vt:e.type});r={verify:Hy(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(o,s){const l=s.transform;if(l instanceof rp)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof tu)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof ru)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof np)return{fieldPath:s.field.canonicalString(),increment:l.Ae};throw hr(20930,{transform:s.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:x4(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:hr(27497)}(t,e.precondition)),r}function E4(t,e){return t&&t.length>0?(Kr(e!==void 0,14353),t.map(r=>function(i,o){let s=i.updateTime?as(i.updateTime):as(o);return s.isEqual(gr.min())&&(s=as(o)),new c4(s,i.transformResults||[])}(r,e))):[]}function I4(t,e){return{documents:[F5(t,e.path)]}}function T4(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=F5(t,i);const o=function(d){if(d.length!==0)return V5(Vo.create(d,"and"))}(e.filters);o&&(r.structuredQuery.where=o);const s=function(d){if(d.length!==0)return d.map(u=>function(g){return{field:yc(g.field),direction:L4(g.dir)}}(u))}(e.orderBy);s&&(r.structuredQuery.orderBy=s);const l=qy(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:r,parent:i}}function k4(t){let e=C4(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Kr(n===1,65062);const u=r.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let o=[];r.where&&(o=function(h){const g=B5(h);return g instanceof Vo&&y5(g)?g.getFilters():[g]}(r.where));let s=[];r.orderBy&&(s=function(h){return h.map(g=>function(S){return new eu(fc(S.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(g))}(r.orderBy));let l=null;r.limit&&(l=function(h){let g;return g=typeof h=="object"?h.value:h,wp(g)?null:g}(r.limit));let c=null;r.startAt&&(c=function(h){const g=!!h.before,m=h.values||[];return new Rc(m,g)}(r.startAt));let d=null;return r.endAt&&(d=function(h){const g=!h.before,m=h.values||[];return new Rc(m,g)}(r.endAt)),Q3(e,i,s,o,l,"F",c,d)}function N4(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return hr(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function B5(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=fc(r.unaryFilter.field);return Fn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=fc(r.unaryFilter.field);return Fn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=fc(r.unaryFilter.field);return Fn.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=fc(r.unaryFilter.field);return Fn.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return hr(61313);default:return hr(60726)}}(t):t.fieldFilter!==void 0?function(r){return Fn.create(fc(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return hr(58110);default:return hr(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Vo.create(r.compositeFilter.filters.map(n=>B5(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return hr(1026)}}(r.compositeFilter.op))}(t):hr(30097,{filter:t})}function L4(t){return P4[t]}function R4(t){return _4[t]}function D4(t){return S4[t]}function yc(t){return{fieldPath:t.canonicalString()}}function fc(t){return si.fromServerFormat(t.fieldPath)}function V5(t){return t instanceof Fn?function(r){if(r.op==="=="){if(i0(r.value))return{unaryFilter:{field:yc(r.field),op:"IS_NAN"}};if(n0(r.value))return{unaryFilter:{field:yc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(i0(r.value))return{unaryFilter:{field:yc(r.field),op:"IS_NOT_NAN"}};if(n0(r.value))return{unaryFilter:{field:yc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:yc(r.field),op:R4(r.op),value:r.value}}}(t):t instanceof Vo?function(r){const n=r.getFilters().map(i=>V5(i));return n.length===1?n[0]:{compositeFilter:{op:D4(r.op),filters:n}}}(t):hr(54877,{filter:t})}function M4(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function j5(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{constructor(e,r,n,i,o=gr.min(),s=gr.min(),l=li.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Ia(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Ia(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ia(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ia(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F4{constructor(e){this.yt=e}}function O4(t){const e=k4({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?tp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B4{constructor(){this.Cn=new V4}addToCollectionParentIndex(e,r){return this.Cn.add(r),xt.resolve()}getCollectionParents(e,r){return xt.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return xt.resolve()}deleteFieldIndex(e,r){return xt.resolve()}deleteAllFieldIndexes(e){return xt.resolve()}createTargetIndexes(e,r){return xt.resolve()}getDocumentsMatchingTarget(e,r){return xt.resolve(null)}getIndexType(e,r){return xt.resolve(0)}getFieldIndexes(e,r){return xt.resolve([])}getNextCollectionGroupToUpdate(e){return xt.resolve(null)}getMinOffset(e,r){return xt.resolve(Oa.min())}getMinOffsetFromCollectionGroup(e,r){return xt.resolve(Oa.min())}updateCollectionGroup(e,r,n){return xt.resolve()}updateIndexEntries(e,r){return xt.resolve()}}class V4{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Hn(un.comparator),o=!i.has(n);return this.index[r]=i.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Hn(un.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},z5=41943040;class Ui{static withCacheSize(e){return new Ui(e,Ui.DEFAULT_COLLECTION_PERCENTILE,Ui.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ui.DEFAULT_COLLECTION_PERCENTILE=10,Ui.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ui.DEFAULT=new Ui(z5,Ui.DEFAULT_COLLECTION_PERCENTILE,Ui.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ui.DISABLED=new Ui(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Dc(0)}static cr(){return new Dc(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b0="LruGarbageCollector",j4=1048576;function P0([t,e],[r,n]){const i=Lr(t,r);return i===0?Lr(e,n):i}class z4{constructor(e){this.Ir=e,this.buffer=new Hn(P0),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();P0(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class q4{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Xt(b0,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Hc(r)?Xt(b0,"Ignoring IndexedDB error during garbage collection: ",r):await Uc(r)}await this.Vr(3e5)})}}class U4{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return xt.resolve(Sp.ce);const n=new z4(r);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Xt("LruGarbageCollector","Garbage collection skipped; disabled"),xt.resolve(v0)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Xt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),v0):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,o,s,l,c,d;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Xt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,s=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(n=h,l=Date.now(),this.removeTargets(e,n,r))).next(h=>(o=h,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(h=>(d=Date.now(),pc()<=Nr.DEBUG&&Xt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-u}ms
	Determined least recently used ${i} in `+(l-s)+`ms
	Removed ${o} targets in `+(c-l)+`ms
	Removed ${h} documents in `+(d-c)+`ms
Total Duration: ${d-u}ms`),xt.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:h})))}}function H4(t,e){return new U4(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G4{constructor(){this.changes=new Ml(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,bi.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?xt.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W4{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Md(n.mutation,i,ro.empty(),fn.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Rr()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Rr()){const i=bl();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(o=>{let s=xd();return o.forEach((l,c)=>{s=s.insert(l,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,r){const n=bl();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Rr()))}populateOverlays(e,r,n){const i=[];return n.forEach(o=>{r.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,l)=>{r.set(s,l)})})}computeViews(e,r,n,i){let o=js();const s=Dd(),l=function(){return Dd()}();return r.forEach((c,d)=>{const u=n.get(d.key);i.has(d.key)&&(u===void 0||u.mutation instanceof Wa)?o=o.insert(d.key,d):u!==void 0?(s.set(d.key,u.mutation.getFieldMask()),Md(u.mutation,d,u.mutation.getFieldMask(),fn.now())):s.set(d.key,ro.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((d,u)=>s.set(d,u)),r.forEach((d,u)=>l.set(d,new W4(u,s.get(d)??null))),l))}recalculateAndSaveOverlays(e,r){const n=Dd();let i=new _n((s,l)=>s-l),o=Rr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(s=>{for(const l of s)l.keys().forEach(c=>{const d=r.get(c);if(d===null)return;let u=n.get(c)||ro.empty();u=l.applyToLocalView(d,u),n.set(c,u);const h=(i.get(l.batchId)||Rr()).add(c);i=i.insert(l.batchId,h)})}).next(()=>{const s=[],l=i.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),d=c.key,u=c.value,h=w5();u.forEach(g=>{if(!o.has(g)){const m=I5(r.get(g),n.get(g));m!==null&&h.set(g,m),o=o.add(g)}}),s.push(this.documentOverlayCache.saveOverlays(e,d,h))}return xt.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(s){return ir.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):Kf(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(o=>{const s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-o.size):xt.resolve(bl());let l=Qd,c=o;return s.next(d=>xt.forEach(d,(u,h)=>(l<h.largestBatchId&&(l=h.largestBatchId),o.get(u)?xt.resolve():this.remoteDocumentCache.getEntry(e,u).next(g=>{c=c.insert(u,g)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,c,d,Rr())).next(u=>({batchId:l,changes:S5(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new ir(r)).next(n=>{let i=xd();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const o=r.collectionGroup;let s=xd();return this.indexManager.getCollectionParents(e,o).next(l=>xt.forEach(l,c=>{const d=function(h,g){return new Dl(g,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,n,i).next(u=>{u.forEach((h,g)=>{s=s.insert(h,g)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,r,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,i))).next(s=>{o.forEach((c,d)=>{const u=d.getKey();s.get(u)===null&&(s=s.insert(u,bi.newInvalidDocument(u)))});let l=xd();return s.forEach((c,d)=>{const u=o.get(c);u!==void 0&&Md(u.mutation,d,ro.empty(),fn.now()),$p(r,d)&&(l=l.insert(c,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K4{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return xt.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:as(i.createTime)}}(r)),xt.resolve()}getNamedQuery(e,r){return xt.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(i){return{name:i.name,query:O4(i.bundledQuery),readTime:as(i.readTime)}}(r)),xt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{constructor(){this.overlays=new _n(ir.comparator),this.qr=new Map}getOverlay(e,r){return xt.resolve(this.overlays.get(r))}getOverlays(e,r){const n=bl();return xt.forEach(r,i=>this.getOverlay(e,i).next(o=>{o!==null&&n.set(i,o)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,o)=>{this.St(e,r,o)}),xt.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.qr.delete(n)),xt.resolve()}getOverlaysForCollection(e,r,n){const i=bl(),o=r.length+1,s=new ir(r.child("")),l=this.overlays.getIteratorFrom(s);for(;l.hasNext();){const c=l.getNext().value,d=c.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===o&&c.largestBatchId>n&&i.set(c.getKey(),c)}return xt.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let o=new _n((d,u)=>d-u);const s=this.overlays.getIterator();for(;s.hasNext();){const d=s.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>n){let u=o.get(d.largestBatchId);u===null&&(u=bl(),o=o.insert(d.largestBatchId,u)),u.set(d.getKey(),d)}}const l=bl(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,u)=>l.set(d,u)),!(l.size()>=i)););return xt.resolve(l)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const s=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(n.key,new m4(r,n));let o=this.qr.get(r);o===void 0&&(o=Rr(),this.qr.set(r,o)),this.qr.set(r,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(){this.sessionToken=li.EMPTY_BYTE_STRING}getSessionToken(e){return xt.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,xt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg{constructor(){this.Qr=new Hn(Jn.$r),this.Ur=new Hn(Jn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new Jn(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new Jn(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new ir(new un([])),n=new Jn(r,e),i=new Jn(r,e+1),o=[];return this.Ur.forEachInRange([n,i],s=>{this.Gr(s),o.push(s.key)}),o}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new ir(new un([])),n=new Jn(r,e),i=new Jn(r,e+1);let o=Rr();return this.Ur.forEachInRange([n,i],s=>{o=o.add(s.key)}),o}containsKey(e){const r=new Jn(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Jn{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return ir.comparator(e.key,r.key)||Lr(e.Yr,r.Yr)}static Kr(e,r){return Lr(e.Yr,r.Yr)||ir.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X4{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new Hn(Jn.$r)}checkEmpty(e){return xt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new p4(o,r,n,i);this.mutationQueue.push(s);for(const l of i)this.Zr=this.Zr.add(new Jn(l.key,o)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return xt.resolve(s)}lookupMutationBatch(e,r){return xt.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),o=i<0?0:i;return xt.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return xt.resolve(this.mutationQueue.length===0?Uf:this.tr-1)}getAllMutationBatches(e){return xt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Jn(r,0),i=new Jn(r,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,i],s=>{const l=this.Xr(s.Yr);o.push(l)}),xt.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Hn(Lr);return r.forEach(i=>{const o=new Jn(i,0),s=new Jn(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,s],l=>{n=n.add(l.Yr)})}),xt.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let o=n;ir.isDocumentKey(o)||(o=o.child(""));const s=new Jn(new ir(o),0);let l=new Hn(Lr);return this.Zr.forEachWhile(c=>{const d=c.key.path;return!!n.isPrefixOf(d)&&(d.length===i&&(l=l.add(c.Yr)),!0)},s),xt.resolve(this.ti(l))}ti(e){const r=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Kr(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return xt.forEach(r.mutations,i=>{const o=new Jn(i.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new Jn(r,0),i=this.Zr.firstAfterOrEqual(n);return xt.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,xt.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z4{constructor(e){this.ri=e,this.docs=function(){return new _n(ir.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),o=i?i.size:0,s=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return xt.resolve(n?n.document.mutableCopy():bi.newInvalidDocument(r))}getEntries(e,r){let n=js();return r.forEach(i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():bi.newInvalidDocument(i))}),xt.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let o=js();const s=r.path,l=new ir(s.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:d,value:{document:u}}=c.getNext();if(!s.isPrefixOf(d.path))break;d.path.length>s.length+1||E3($3(u),n)<=0||(i.has(u.key)||$p(r,u))&&(o=o.insert(u.key,u.mutableCopy()))}return xt.resolve(o)}getAllFromCollectionGroup(e,r,n,i){hr(9500)}ii(e,r){return xt.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new e$(this)}getSize(e){return xt.resolve(this.size)}}class e$ extends G4{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),xt.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t${constructor(e){this.persistence=e,this.si=new Ml(r=>Gf(r),Wf),this.lastRemoteSnapshotVersion=gr.min(),this.highestTargetId=0,this.oi=0,this._i=new eg,this.targetCount=0,this.ai=Dc.ur()}forEachTarget(e,r){return this.si.forEach((n,i)=>r(i)),xt.resolve()}getLastRemoteSnapshotVersion(e){return xt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return xt.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),xt.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),xt.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Dc(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,xt.resolve()}updateTargetData(e,r){return this.Pr(r),xt.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,xt.resolve()}removeTargets(e,r,n){let i=0;const o=[];return this.si.forEach((s,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.si.delete(s),o.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),xt.waitFor(o).next(()=>i)}getTargetCount(e){return xt.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return xt.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),xt.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,o=[];return i&&r.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),xt.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),xt.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return xt.resolve(n)}containsKey(e,r){return xt.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q5{constructor(e,r){this.ui={},this.overlays={},this.ci=new Sp(0),this.li=!1,this.li=!0,this.hi=new J4,this.referenceDelegate=e(this),this.Pi=new t$(this),this.indexManager=new B4,this.remoteDocumentCache=function(i){return new Z4(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new F4(r),this.Ii=new K4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new Q4,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new X4(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Xt("MemoryPersistence","Starting transaction:",e);const i=new r$(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ai(e,r){return xt.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class r$ extends T3{constructor(e){super(),this.currentSequenceNumber=e}}class tg{constructor(e){this.persistence=e,this.Ri=new eg,this.Vi=null}static mi(e){return new tg(e)}get fi(){if(this.Vi)return this.Vi;throw hr(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),xt.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),xt.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),xt.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(o=>this.fi.add(o.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return xt.forEach(this.fi,n=>{const i=ir.fromPath(n);return this.gi(e,i).next(o=>{o||r.removeEntry(i,gr.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return xt.or([()=>xt.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class op{constructor(e,r){this.persistence=e,this.pi=new Ml(n=>L3(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=H4(this,r)}static mi(e,r){return new op(e,r)}Ei(){}di(e){return xt.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return xt.forEach(this.pi,(n,i)=>this.br(e,n,i).next(o=>o?xt.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(e,s=>this.br(e,s,r).next(l=>{l||(n++,o.removeEntry(s,gr.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),xt.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),xt.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),xt.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),xt.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=$h(e.data.value)),r}br(e,r,n){return xt.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.pi.get(r);return xt.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=Rr(),i=Rr();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new rg(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n${constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i${constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Ww()?8:k3(Si())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const o={result:null};return this.ys(e,r).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.ws(e,r,i,n).next(s=>{o.result=s})}).next(()=>{if(o.result)return;const s=new n$;return this.Ss(e,r,s).next(l=>{if(o.result=l,this.Vs)return this.bs(e,r,s,l.size)})}).next(()=>o.result)}bs(e,r,n,i){return n.documentReadCount<this.fs?(pc()<=Nr.DEBUG&&Xt("QueryEngine","SDK will not create cache indexes for query:",mc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),xt.resolve()):(pc()<=Nr.DEBUG&&Xt("QueryEngine","Query:",mc(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(pc()<=Nr.DEBUG&&Xt("QueryEngine","The SDK decides to create cache indexes for query:",mc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,os(r))):xt.resolve())}ys(e,r){if(l0(r))return xt.resolve(null);let n=os(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=tp(r,null,"F"),n=os(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const s=Rr(...o);return this.ps.getDocuments(e,s).next(l=>this.indexManager.getMinOffset(e,n).next(c=>{const d=this.Ds(r,l);return this.Cs(r,d,s,c.readTime)?this.ys(e,tp(r,null,"F")):this.vs(e,d,r,c)}))})))}ws(e,r,n,i){return l0(r)||i.isEqual(gr.min())?xt.resolve(null):this.ps.getDocuments(e,n).next(o=>{const s=this.Ds(r,o);return this.Cs(r,s,n,i)?xt.resolve(null):(pc()<=Nr.DEBUG&&Xt("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),mc(r)),this.vs(e,s,r,A3(i,Qd)).next(l=>l))})}Ds(e,r){let n=new Hn(P5(e));return r.forEach((i,o)=>{$p(e,o)&&(n=n.add(o))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(e,r,n){return pc()<=Nr.DEBUG&&Xt("QueryEngine","Using full collection scan to execute query:",mc(r)),this.ps.getDocumentsMatchingQuery(e,r,Oa.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(o=>(r.forEach(s=>{o=o.insert(s.key,s)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ng="LocalStore",o$=3e8;class s${constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new _n(Lr),this.xs=new Ml(o=>Gf(o),Wf),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Y4(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function a$(t,e,r,n){return new s$(t,e,r,n)}async function U5(t,e){const r=wr(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(o=>{const s=[],l=[];let c=Rr();for(const d of i){s.push(d.batchId);for(const u of d.mutations)c=c.add(u.key)}for(const d of o){l.push(d.batchId);for(const u of d.mutations)c=c.add(u.key)}return r.localDocuments.getDocuments(n,c).next(d=>({Ls:d,removedBatchIds:s,addedBatchIds:l}))})})}function l$(t,e){const r=wr(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),o=r.Ns.newChangeBuffer({trackRemovals:!0});return function(l,c,d,u){const h=d.batch,g=h.keys();let m=xt.resolve();return g.forEach(S=>{m=m.next(()=>u.getEntry(c,S)).next(N=>{const x=d.docVersions.get(S);Kr(x!==null,48541),N.version.compareTo(x)<0&&(h.applyToRemoteDocument(N,d),N.isValidDocument()&&(N.setReadTime(d.commitVersion),u.addEntry(N)))})}),m.next(()=>l.mutationQueue.removeMutationBatch(c,h))}(r,n,e,o).next(()=>o.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let c=Rr();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(c=c.add(l.batch.mutations[d].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function H5(t){const e=wr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function c$(t,e){const r=wr(t),n=e.snapshotVersion;let i=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const s=r.Ns.newChangeBuffer({trackRemovals:!0});i=r.Ms;const l=[];e.targetChanges.forEach((u,h)=>{const g=i.get(h);if(!g)return;l.push(r.Pi.removeMatchingKeys(o,u.removedDocuments,h).next(()=>r.Pi.addMatchingKeys(o,u.addedDocuments,h)));let m=g.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(li.EMPTY_BYTE_STRING,gr.min()).withLastLimboFreeSnapshotVersion(gr.min()):u.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(u.resumeToken,n)),i=i.insert(h,m),function(N,x,b){return N.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-N.snapshotVersion.toMicroseconds()>=o$?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(g,m,u)&&l.push(r.Pi.updateTargetData(o,m))});let c=js(),d=Rr();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(o,u))}),l.push(d$(o,s,e.documentUpdates).next(u=>{c=u.ks,d=u.qs})),!n.isEqual(gr.min())){const u=r.Pi.getLastRemoteSnapshotVersion(o).next(h=>r.Pi.setTargetsMetadata(o,o.currentSequenceNumber,n));l.push(u)}return xt.waitFor(l).next(()=>s.apply(o)).next(()=>r.localDocuments.getLocalViewOfDocuments(o,c,d)).next(()=>c)}).then(o=>(r.Ms=i,o))}function d$(t,e,r){let n=Rr(),i=Rr();return r.forEach(o=>n=n.add(o)),e.getEntries(t,n).next(o=>{let s=js();return r.forEach((l,c)=>{const d=o.get(l);c.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(l)),c.isNoDocument()&&c.version.isEqual(gr.min())?(e.removeEntry(l,c.readTime),s=s.insert(l,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),s=s.insert(l,c)):Xt(ng,"Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",c.version)}),{ks:s,qs:i}})}function u$(t,e){const r=wr(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Uf),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function h$(t,e){const r=wr(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Pi.getTargetData(n,e).next(o=>o?(i=o,xt.resolve(i)):r.Pi.allocateTargetId(n).next(s=>(i=new Ia(e,s,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function Wy(t,e,r){const n=wr(t),i=n.Ms.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,s=>n.persistence.referenceDelegate.removeTarget(s,i))}catch(s){if(!Hc(s))throw s;Xt(ng,`Failed to update sequence numbers for target ${e}: ${s}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function _0(t,e,r){const n=wr(t);let i=gr.min(),o=Rr();return n.persistence.runTransaction("Execute query","readwrite",s=>function(c,d,u){const h=wr(c),g=h.xs.get(u);return g!==void 0?xt.resolve(h.Ms.get(g)):h.Pi.getTargetData(d,u)}(n,s,os(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(s,l.targetId).next(c=>{o=c})}).next(()=>n.Fs.getDocumentsMatchingQuery(s,e,r?i:gr.min(),r?o:Rr())).next(l=>(p$(n,X3(e),l),{documents:l,Qs:o})))}function p$(t,e,r){let n=t.Os.get(e)||gr.min();r.forEach((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),t.Os.set(e,n)}class S0{constructor(){this.activeTargetIds=i4()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class m${constructor(){this.Mo=new S0,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new S0,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y${Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w0="ConnectivityMonitor";class x0{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Xt(w0,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Xt(w0,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qu=null;function Yy(){return Qu===null?Qu=function(){return 268435456+Math.round(2147483648*Math.random())}():Qu++,"0x"+Qu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Am="RestConnection",f$={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class g${get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===Xh?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,o){const s=Yy(),l=this.zo(e,r.toUriEncodedString());Xt(Am,`Sending RPC '${e}' ${s}:`,l,n);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,i,o);const{host:d}=new URL(l),u=Vc(d);return this.Jo(e,l,c,n,u).then(h=>(Xt(Am,`Received RPC '${e}' ${s}: `,h),h),h=>{throw Tc(Am,`RPC '${e}' ${s} failed with error: `,h,"url: ",l,"request:",n),h})}Ho(e,r,n,i,o,s){return this.Go(e,r,n,i,o)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+qc}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>e[o]=i),n&&n.headers.forEach((i,o)=>e[o]=i)}zo(e,r){const n=f$[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v${constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const di="WebChannelConnection";class b$ extends g${constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,o){const s=Yy();return new Promise((l,c)=>{const d=new Y2;d.setWithCredentials(!0),d.listenOnce(K2.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Ah.NO_ERROR:const h=d.getResponseJson();Xt(di,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),l(h);break;case Ah.TIMEOUT:Xt(di,`RPC '${e}' ${s} timed out`),c(new Vt(yt.DEADLINE_EXCEEDED,"Request time out"));break;case Ah.HTTP_ERROR:const g=d.getStatus();if(Xt(di,`RPC '${e}' ${s} failed with status:`,g,"response text:",d.getResponseText()),g>0){let m=d.getResponseJson();Array.isArray(m)&&(m=m[0]);const S=m?.error;if(S&&S.status&&S.message){const N=function(b){const K=b.toLowerCase().replace(/_/g,"-");return Object.values(yt).indexOf(K)>=0?K:yt.UNKNOWN}(S.status);c(new Vt(N,S.message))}else c(new Vt(yt.UNKNOWN,"Server responded with status "+d.getStatus()))}else c(new Vt(yt.UNAVAILABLE,"Connection failed."));break;default:hr(9055,{l_:e,streamId:s,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{Xt(di,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);Xt(di,`RPC '${e}' ${s} sending request:`,i),d.send(r,"POST",u,n,15)})}T_(e,r,n){const i=Yy(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=X2(),l=J2(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const u=o.join("");Xt(di,`Creating RPC '${e}' stream ${i}: ${u}`,c);const h=s.createWebChannel(u,c);this.I_(h);let g=!1,m=!1;const S=new v$({Yo:x=>{m?Xt(di,`Not sending because RPC '${e}' stream ${i} is closed:`,x):(g||(Xt(di,`Opening RPC '${e}' stream ${i} transport.`),h.open(),g=!0),Xt(di,`RPC '${e}' stream ${i} sending:`,x),h.send(x))},Zo:()=>h.close()}),N=(x,b,K)=>{x.listen(b,te=>{try{K(te)}catch(F){setTimeout(()=>{throw F},0)}})};return N(h,wd.EventType.OPEN,()=>{m||(Xt(di,`RPC '${e}' stream ${i} transport opened.`),S.o_())}),N(h,wd.EventType.CLOSE,()=>{m||(m=!0,Xt(di,`RPC '${e}' stream ${i} transport closed`),S.a_(),this.E_(h))}),N(h,wd.EventType.ERROR,x=>{m||(m=!0,Tc(di,`RPC '${e}' stream ${i} transport errored. Name:`,x.name,"Message:",x.message),S.a_(new Vt(yt.UNAVAILABLE,"The operation could not be completed")))}),N(h,wd.EventType.MESSAGE,x=>{if(!m){const b=x.data[0];Kr(!!b,16349);const K=b,te=K?.error||K[0]?.error;if(te){Xt(di,`RPC '${e}' stream ${i} received error:`,te);const F=te.status;let V=function(E){const L=Mn[E];if(L!==void 0)return N5(L)}(F),W=te.message;V===void 0&&(V=yt.INTERNAL,W="Unknown error status: "+F+" with message "+te.message),m=!0,S.a_(new Vt(V,W)),h.close()}else Xt(di,`RPC '${e}' stream ${i} received:`,b),S.u_(b)}}),N(l,Q2.STAT_EVENT,x=>{x.stat===My.PROXY?Xt(di,`RPC '${e}' stream ${i} detected buffering proxy`):x.stat===My.NOPROXY&&Xt(di,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{S.__()},0),S}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function $m(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kp(t){return new w4(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G5{constructor(e,r,n=1e3,i=1.5,o=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&Xt("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C0="PersistentStream";class W5{constructor(e,r,n,i,o,s,l,c){this.Mi=e,this.S_=n,this.b_=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new G5(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===yt.RESOURCE_EXHAUSTED?(Bs(r.toString()),Bs("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===yt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===r&&this.G_(n,i)},n=>{e(()=>{const i=new Vt(yt.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Xt(C0,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(Xt(C0,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class P$ extends W5{constructor(e,r,n,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,s),this.serializer=o}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=A4(this.serializer,e),n=function(o){if(!("targetChange"in o))return gr.min();const s=o.targetChange;return s.targetIds&&s.targetIds.length?gr.min():s.readTime?as(s.readTime):gr.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=Gy(this.serializer),r.addTarget=function(o,s){let l;const c=s.target;if(l=jy(c)?{documents:I4(o,c)}:{query:T4(o,c).ft},l.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){l.resumeToken=D5(o,s.resumeToken);const d=qy(o,s.expectedCount);d!==null&&(l.expectedCount=d)}else if(s.snapshotVersion.compareTo(gr.min())>0){l.readTime=ip(o,s.snapshotVersion.toTimestamp());const d=qy(o,s.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const n=N4(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=Gy(this.serializer),r.removeTarget=e,this.q_(r)}}class _$ extends W5{constructor(e,r,n,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,s),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Kr(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Kr(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Kr(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=E4(e.writeResults,e.commitTime),n=as(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=Gy(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>$4(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S${}class w$ extends S${constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Vt(yt.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Go(e,Uy(r,n),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===yt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Vt(yt.UNKNOWN,o.toString())})}Ho(e,r,n,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,l])=>this.connection.Ho(e,Uy(r,n),i,s,l,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===yt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Vt(yt.UNKNOWN,s.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class x${constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Bs(r),this.aa=!1):Xt("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nl="RemoteStore";class C${constructor(e,r,n,i,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo(s=>{n.enqueueAndForget(async()=>{Fl(this)&&(Xt(Nl,"Restarting streams for network reachability change."),await async function(c){const d=wr(c);d.Ea.add(4),await fu(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Np(d)}(this))})}),this.Ra=new x$(n,i)}}async function Np(t){if(Fl(t))for(const e of t.da)await e(!0)}async function fu(t){for(const e of t.da)await e(!1)}function Y5(t,e){const r=wr(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),ag(r)?sg(r):Gc(r).O_()&&og(r,e))}function ig(t,e){const r=wr(t),n=Gc(r);r.Ia.delete(e),n.O_()&&K5(r,e),r.Ia.size===0&&(n.O_()?n.L_():Fl(r)&&r.Ra.set("Unknown"))}function og(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(gr.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Gc(t).Y_(e)}function K5(t,e){t.Va.Ue(e),Gc(t).Z_(e)}function sg(t){t.Va=new b4({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Gc(t).start(),t.Ra.ua()}function ag(t){return Fl(t)&&!Gc(t).x_()&&t.Ia.size>0}function Fl(t){return wr(t).Ea.size===0}function Q5(t){t.Va=void 0}async function A$(t){t.Ra.set("Online")}async function $$(t){t.Ia.forEach((e,r)=>{og(t,e)})}async function E$(t,e){Q5(t),ag(t)?(t.Ra.ha(e),sg(t)):t.Ra.set("Unknown")}async function I$(t,e,r){if(t.Ra.set("Online"),e instanceof R5&&e.state===2&&e.cause)try{await async function(i,o){const s=o.cause;for(const l of o.targetIds)i.Ia.has(l)&&(await i.remoteSyncer.rejectListen(l,s),i.Ia.delete(l),i.Va.removeTarget(l))}(t,e)}catch(n){Xt(Nl,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await sp(t,n)}else if(e instanceof Th?t.Va.Ze(e):e instanceof L5?t.Va.st(e):t.Va.tt(e),!r.isEqual(gr.min()))try{const n=await H5(t.localStore);r.compareTo(n)>=0&&await function(o,s){const l=o.Va.Tt(s);return l.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const u=o.Ia.get(d);u&&o.Ia.set(d,u.withResumeToken(c.resumeToken,s))}}),l.targetMismatches.forEach((c,d)=>{const u=o.Ia.get(c);if(!u)return;o.Ia.set(c,u.withResumeToken(li.EMPTY_BYTE_STRING,u.snapshotVersion)),K5(o,c);const h=new Ia(u.target,c,d,u.sequenceNumber);og(o,h)}),o.remoteSyncer.applyRemoteEvent(l)}(t,r)}catch(n){Xt(Nl,"Failed to raise snapshot:",n),await sp(t,n)}}async function sp(t,e,r){if(!Hc(e))throw e;t.Ea.add(1),await fu(t),t.Ra.set("Offline"),r||(r=()=>H5(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Xt(Nl,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await Np(t)})}function J5(t,e){return e().catch(r=>sp(t,r,e))}async function Lp(t){const e=wr(t),r=za(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Uf;for(;T$(e);)try{const i=await u$(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,k$(e,i)}catch(i){await sp(e,i)}X5(e)&&Z5(e)}function T$(t){return Fl(t)&&t.Ta.length<10}function k$(t,e){t.Ta.push(e);const r=za(t);r.O_()&&r.X_&&r.ea(e.mutations)}function X5(t){return Fl(t)&&!za(t).x_()&&t.Ta.length>0}function Z5(t){za(t).start()}async function N$(t){za(t).ra()}async function L$(t){const e=za(t);for(const r of t.Ta)e.ea(r.mutations)}async function R$(t,e,r){const n=t.Ta.shift(),i=Jf.from(n,e,r);await J5(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Lp(t)}async function D$(t,e){e&&za(t).X_&&await async function(n,i){if(function(s){return f4(s)&&s!==yt.ABORTED}(i.code)){const o=n.Ta.shift();za(n).B_(),await J5(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i)),await Lp(n)}}(t,e),X5(t)&&Z5(t)}async function A0(t,e){const r=wr(t);r.asyncQueue.verifyOperationInProgress(),Xt(Nl,"RemoteStore received new credentials");const n=Fl(r);r.Ea.add(3),await fu(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await Np(r)}async function M$(t,e){const r=wr(t);e?(r.Ea.delete(2),await Np(r)):e||(r.Ea.add(2),await fu(r),r.Ra.set("Unknown"))}function Gc(t){return t.ma||(t.ma=function(r,n,i){const o=wr(r);return o.sa(),new P$(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:A$.bind(null,t),t_:$$.bind(null,t),r_:E$.bind(null,t),H_:I$.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),ag(t)?sg(t):t.Ra.set("Unknown")):(await t.ma.stop(),Q5(t))})),t.ma}function za(t){return t.fa||(t.fa=function(r,n,i){const o=wr(r);return o.sa(),new _$(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:N$.bind(null,t),r_:D$.bind(null,t),ta:L$.bind(null,t),na:R$.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Lp(t)):(await t.fa.stop(),t.Ta.length>0&&(Xt(Nl,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lg{constructor(e,r,n,i,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new Ms,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,o){const s=Date.now()+n,l=new lg(e,r,s,i,o);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Vt(yt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function cg(t,e){if(Bs("AsyncQueue",`${e}: ${t}`),Hc(t))return new Vt(yt.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc{static emptySet(e){return new xc(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||ir.comparator(r.key,n.key):(r,n)=>ir.comparator(r.key,n.key),this.keyedMap=xd(),this.sortedSet=new _n(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof xc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new xc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $0{constructor(){this.ga=new _n(ir.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):hr(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class Mc{constructor(e,r,n,i,o,s,l,c,d){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,r,n,i,o){const s=[];return r.forEach(l=>{s.push({type:0,doc:l})}),new Mc(e,r,xc.emptySet(r),s,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ap(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F${constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class O${constructor(){this.queries=E0(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=wr(r),o=i.queries;i.queries=E0(),o.forEach((s,l)=>{for(const c of l.Sa)c.onError(n)})})(this,new Vt(yt.ABORTED,"Firestore shutting down"))}}function E0(){return new Ml(t=>b5(t),Ap)}async function eP(t,e){const r=wr(t);let n=3;const i=e.query;let o=r.queries.get(i);o?!o.ba()&&e.Da()&&(n=2):(o=new F$,n=e.Da()?0:1);try{switch(n){case 0:o.wa=await r.onListen(i,!0);break;case 1:o.wa=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(s){const l=cg(s,`Initialization of query '${mc(e.query)}' failed`);return void e.onError(l)}r.queries.set(i,o),o.Sa.push(e),e.va(r.onlineState),o.wa&&e.Fa(o.wa)&&dg(r)}async function tP(t,e){const r=wr(t),n=e.query;let i=3;const o=r.queries.get(n);if(o){const s=o.Sa.indexOf(e);s>=0&&(o.Sa.splice(s,1),o.Sa.length===0?i=e.Da()?0:1:!o.ba()&&e.Da()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function B$(t,e){const r=wr(t);let n=!1;for(const i of e){const o=i.query,s=r.queries.get(o);if(s){for(const l of s.Sa)l.Fa(i)&&(n=!0);s.wa=i}}n&&dg(r)}function V$(t,e,r){const n=wr(t),i=n.queries.get(e);if(i)for(const o of i.Sa)o.onError(r);n.queries.delete(e)}function dg(t){t.Ca.forEach(e=>{e.next()})}var Ky,I0;(I0=Ky||(Ky={})).Ma="default",I0.Cache="cache";class rP{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Mc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=Mc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Ky.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{constructor(e){this.key=e}}class iP{constructor(e){this.key=e}}class j${constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Rr(),this.mutatedKeys=Rr(),this.eu=P5(e),this.tu=new xc(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new $0,i=r?r.tu:this.tu;let o=r?r.mutatedKeys:this.mutatedKeys,s=i,l=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,h)=>{const g=i.get(u),m=$p(this.query,h)?h:null,S=!!g&&this.mutatedKeys.has(g.key),N=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let x=!1;g&&m?g.data.isEqual(m.data)?S!==N&&(n.track({type:3,doc:m}),x=!0):this.su(g,m)||(n.track({type:2,doc:m}),x=!0,(c&&this.eu(m,c)>0||d&&this.eu(m,d)<0)&&(l=!0)):!g&&m?(n.track({type:0,doc:m}),x=!0):g&&!m&&(n.track({type:1,doc:g}),x=!0,(c||d)&&(l=!0)),x&&(m?(s=s.add(m),o=N?o.add(u):o.delete(u)):(s=s.delete(u),o=o.delete(u)))}),this.query.limit!==null)for(;s.size>this.query.limit;){const u=this.query.limitType==="F"?s.last():s.first();s=s.delete(u.key),o=o.delete(u.key),n.track({type:1,doc:u})}return{tu:s,iu:n,Cs:l,mutatedKeys:o}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort((u,h)=>function(m,S){const N=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return hr(20277,{Rt:x})}};return N(m)-N(S)}(u.type,h.type)||this.eu(u.doc,h.doc)),this.ou(n),i=i??!1;const l=r&&!i?this._u():[],c=this.Xa.size===0&&this.current&&!i?1:0,d=c!==this.Za;return this.Za=c,s.length!==0||d?{snapshot:new Mc(this.query,e.tu,o,s,e.mutatedKeys,c===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new $0,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Rr(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new iP(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new nP(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=Rr();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return Mc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const ug="SyncEngine";class z${constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class q${constructor(e){this.key=e,this.hu=!1}}class U${constructor(e,r,n,i,o,s){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new Ml(l=>b5(l),Ap),this.Iu=new Map,this.Eu=new Set,this.du=new _n(ir.comparator),this.Au=new Map,this.Ru=new eg,this.Vu={},this.mu=new Map,this.fu=Dc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function H$(t,e,r=!0){const n=dP(t);let i;const o=n.Tu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await oP(n,e,r,!0),i}async function G$(t,e){const r=dP(t);await oP(r,e,!0,!1)}async function oP(t,e,r,n){const i=await h$(t.localStore,os(e)),o=i.targetId,s=t.sharedClientState.addLocalQueryTarget(o,r);let l;return n&&(l=await W$(t,e,o,s==="current",i.resumeToken)),t.isPrimaryClient&&r&&Y5(t.remoteStore,i),l}async function W$(t,e,r,n,i){t.pu=(h,g,m)=>async function(N,x,b,K){let te=x.view.ru(b);te.Cs&&(te=await _0(N.localStore,x.query,!1).then(({documents:I})=>x.view.ru(I,te)));const F=K&&K.targetChanges.get(x.targetId),V=K&&K.targetMismatches.get(x.targetId)!=null,W=x.view.applyChanges(te,N.isPrimaryClient,F,V);return k0(N,x.targetId,W.au),W.snapshot}(t,h,g,m);const o=await _0(t.localStore,e,!0),s=new j$(e,o.Qs),l=s.ru(o.documents),c=yu.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),d=s.applyChanges(l,t.isPrimaryClient,c);k0(t,r,d.au);const u=new z$(e,r,s);return t.Tu.set(e,u),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),d.snapshot}async function Y$(t,e,r){const n=wr(t),i=n.Tu.get(e),o=n.Iu.get(i.targetId);if(o.length>1)return n.Iu.set(i.targetId,o.filter(s=>!Ap(s,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Wy(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&ig(n.remoteStore,i.targetId),Qy(n,i.targetId)}).catch(Uc)):(Qy(n,i.targetId),await Wy(n.localStore,i.targetId,!0))}async function K$(t,e){const r=wr(t),n=r.Tu.get(e),i=r.Iu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),ig(r.remoteStore,n.targetId))}async function Q$(t,e,r){const n=nE(t);try{const i=await function(s,l){const c=wr(s),d=fn.now(),u=l.reduce((m,S)=>m.add(S.key),Rr());let h,g;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let S=js(),N=Rr();return c.Ns.getEntries(m,u).next(x=>{S=x,S.forEach((b,K)=>{K.isValidDocument()||(N=N.add(b))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,S)).next(x=>{h=x;const b=[];for(const K of l){const te=u4(K,h.get(K.key).overlayedDocument);te!=null&&b.push(new Wa(K.key,te,h5(te.value.mapValue),ss.exists(!0)))}return c.mutationQueue.addMutationBatch(m,d,b,l)}).next(x=>{g=x;const b=x.applyToLocalDocumentSet(h,N);return c.documentOverlayCache.saveOverlays(m,x.batchId,b)})}).then(()=>({batchId:g.batchId,changes:S5(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(s,l,c){let d=s.Vu[s.currentUser.toKey()];d||(d=new _n(Lr)),d=d.insert(l,c),s.Vu[s.currentUser.toKey()]=d}(n,i.batchId,r),await gu(n,i.changes),await Lp(n.remoteStore)}catch(i){const o=cg(i,"Failed to persist write");r.reject(o)}}async function sP(t,e){const r=wr(t);try{const n=await c$(r.localStore,e);e.targetChanges.forEach((i,o)=>{const s=r.Au.get(o);s&&(Kr(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.hu=!0:i.modifiedDocuments.size>0?Kr(s.hu,14607):i.removedDocuments.size>0&&(Kr(s.hu,42227),s.hu=!1))}),await gu(r,n,e)}catch(n){await Uc(n)}}function T0(t,e,r){const n=wr(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach((o,s)=>{const l=s.view.va(e);l.snapshot&&i.push(l.snapshot)}),function(s,l){const c=wr(s);c.onlineState=l;let d=!1;c.queries.forEach((u,h)=>{for(const g of h.Sa)g.va(l)&&(d=!0)}),d&&dg(c)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function J$(t,e,r){const n=wr(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Au.get(e),o=i&&i.key;if(o){let s=new _n(ir.comparator);s=s.insert(o,bi.newNoDocument(o,gr.min()));const l=Rr().add(o),c=new Tp(gr.min(),new Map,new _n(Lr),s,l);await sP(n,c),n.du=n.du.remove(o),n.Au.delete(e),hg(n)}else await Wy(n.localStore,e,!1).then(()=>Qy(n,e,r)).catch(Uc)}async function X$(t,e){const r=wr(t),n=e.batch.batchId;try{const i=await l$(r.localStore,e);lP(r,n,null),aP(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await gu(r,i)}catch(i){await Uc(i)}}async function Z$(t,e,r){const n=wr(t);try{const i=await function(s,l){const c=wr(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let u;return c.mutationQueue.lookupMutationBatch(d,l).next(h=>(Kr(h!==null,37113),u=h.keys(),c.mutationQueue.removeMutationBatch(d,h))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,u,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,u)).next(()=>c.localDocuments.getDocuments(d,u))})}(n.localStore,e);lP(n,e,r),aP(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await gu(n,i)}catch(i){await Uc(i)}}function aP(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function lP(t,e,r){const n=wr(t);let i=n.Vu[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(r?o.reject(r):o.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function Qy(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||cP(t,n)})}function cP(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(ig(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),hg(t))}function k0(t,e,r){for(const n of r)n instanceof nP?(t.Ru.addReference(n.key,e),eE(t,n)):n instanceof iP?(Xt(ug,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||cP(t,n.key)):hr(19791,{wu:n})}function eE(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Xt(ug,"New document in limbo: "+r),t.Eu.add(n),hg(t))}function hg(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new ir(un.fromString(e)),n=t.fu.next();t.Au.set(n,new q$(r)),t.du=t.du.insert(r,n),Y5(t.remoteStore,new Ia(os(Yf(r.path)),n,"TargetPurposeLimboResolution",Sp.ce))}}async function gu(t,e,r){const n=wr(t),i=[],o=[],s=[];n.Tu.isEmpty()||(n.Tu.forEach((l,c)=>{s.push(n.pu(c,e,r).then(d=>{if((d||r)&&n.isPrimaryClient){const u=d?!d.fromCache:r?.targetChanges.get(c.targetId)?.current;n.sharedClientState.updateQueryState(c.targetId,u?"current":"not-current")}if(d){i.push(d);const u=rg.As(c.targetId,d);o.push(u)}}))}),await Promise.all(s),n.Pu.H_(i),await async function(c,d){const u=wr(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>xt.forEach(d,g=>xt.forEach(g.Es,m=>u.persistence.referenceDelegate.addReference(h,g.targetId,m)).next(()=>xt.forEach(g.ds,m=>u.persistence.referenceDelegate.removeReference(h,g.targetId,m)))))}catch(h){if(!Hc(h))throw h;Xt(ng,"Failed to update sequence numbers: "+h)}for(const h of d){const g=h.targetId;if(!h.fromCache){const m=u.Ms.get(g),S=m.snapshotVersion,N=m.withLastLimboFreeSnapshotVersion(S);u.Ms=u.Ms.insert(g,N)}}}(n.localStore,o))}async function tE(t,e){const r=wr(t);if(!r.currentUser.isEqual(e)){Xt(ug,"User change. New user:",e.toKey());const n=await U5(r.localStore,e);r.currentUser=e,function(o,s){o.mu.forEach(l=>{l.forEach(c=>{c.reject(new Vt(yt.CANCELLED,s))})}),o.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await gu(r,n.Ls)}}function rE(t,e){const r=wr(t),n=r.Au.get(e);if(n&&n.hu)return Rr().add(n.key);{let i=Rr();const o=r.Iu.get(e);if(!o)return i;for(const s of o){const l=r.Tu.get(s);i=i.unionWith(l.view.nu)}return i}}function dP(t){const e=wr(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=sP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rE.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=J$.bind(null,e),e.Pu.H_=B$.bind(null,e.eventManager),e.Pu.yu=V$.bind(null,e.eventManager),e}function nE(t){const e=wr(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=X$.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Z$.bind(null,e),e}class ap{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=kp(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return a$(this.persistence,new i$,e.initialUser,this.serializer)}Cu(e){return new q5(tg.mi,this.serializer)}Du(e){return new m$}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ap.provider={build:()=>new ap};class iE extends ap{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Kr(this.persistence.referenceDelegate instanceof op,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new q4(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?Ui.withCacheSize(this.cacheSizeBytes):Ui.DEFAULT;return new q5(n=>op.mi(n,r),this.serializer)}}class Jy{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>T0(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=tE.bind(null,this.syncEngine),await M$(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new O$}()}createDatastore(e){const r=kp(e.databaseInfo.databaseId),n=function(o){return new b$(o)}(e.databaseInfo);return function(o,s,l,c){return new w$(o,s,l,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,o,s,l){return new C$(n,i,o,s,l)}(this.localStore,this.datastore,e.asyncQueue,r=>T0(this.syncEngine,r,0),function(){return x0.v()?new x0:new y$}())}createSyncEngine(e,r){return function(i,o,s,l,c,d,u){const h=new U$(i,o,s,l,c,d);return u&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(r){const n=wr(r);Xt(Nl,"RemoteStore shutting down."),n.Ea.add(5),await fu(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Jy.provider={build:()=>new Jy};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uP{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Bs("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qa="FirestoreClient";class oE{constructor(e,r,n,i,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=vi.UNAUTHENTICATED,this.clientId=qf.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,async s=>{Xt(qa,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(n,s=>(Xt(qa,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ms;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=cg(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Em(t,e){t.asyncQueue.verifyOperationInProgress(),Xt(qa,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await U5(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function N0(t,e){t.asyncQueue.verifyOperationInProgress();const r=await sE(t);Xt(qa,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>A0(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>A0(e.remoteStore,i)),t._onlineComponents=e}async function sE(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Xt(qa,"Using user provided OfflineComponentProvider");try{await Em(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===yt.FAILED_PRECONDITION||i.code===yt.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Tc("Error using user provided cache. Falling back to memory cache: "+r),await Em(t,new ap)}}else Xt(qa,"Using default OfflineComponentProvider"),await Em(t,new iE(void 0));return t._offlineComponents}async function hP(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Xt(qa,"Using user provided OnlineComponentProvider"),await N0(t,t._uninitializedComponentsProvider._online)):(Xt(qa,"Using default OnlineComponentProvider"),await N0(t,new Jy))),t._onlineComponents}function aE(t){return hP(t).then(e=>e.syncEngine)}async function pP(t){const e=await hP(t),r=e.eventManager;return r.onListen=H$.bind(null,e.syncEngine),r.onUnlisten=Y$.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=G$.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=K$.bind(null,e.syncEngine),r}function lE(t,e,r={}){const n=new Ms;return t.asyncQueue.enqueueAndForget(async()=>function(o,s,l,c,d){const u=new uP({next:g=>{u.Nu(),s.enqueueAndForget(()=>tP(o,h));const m=g.docs.has(l);!m&&g.fromCache?d.reject(new Vt(yt.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&g.fromCache&&c&&c.source==="server"?d.reject(new Vt(yt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(g)},error:g=>d.reject(g)}),h=new rP(Yf(l.path),u,{includeMetadataChanges:!0,qa:!0});return eP(o,h)}(await pP(t),t.asyncQueue,e,r,n)),n.promise}function cE(t,e,r={}){const n=new Ms;return t.asyncQueue.enqueueAndForget(async()=>function(o,s,l,c,d){const u=new uP({next:g=>{u.Nu(),s.enqueueAndForget(()=>tP(o,h)),g.fromCache&&c.source==="server"?d.reject(new Vt(yt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(g)},error:g=>d.reject(g)}),h=new rP(l,u,{includeMetadataChanges:!0,qa:!0});return eP(o,h)}(await pP(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mP(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L0=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yP="firestore.googleapis.com",R0=!0;class D0{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Vt(yt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=yP,this.ssl=R0}else this.host=e.host,this.ssl=e.ssl??R0;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=z5;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<j4)throw new Vt(yt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}x3("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=mP(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Vt(yt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Vt(yt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Vt(yt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Rp{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new D0({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Vt(yt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Vt(yt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new D0(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new m3;switch(n.type){case"firstParty":return new v3(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Vt(yt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=L0.get(r);n&&(Xt("ComponentProvider","Removing Datastore"),L0.delete(r),n.terminate())}(this),Promise.resolve()}}function dE(t,e,r,n={}){t=Vs(t,Rp);const i=Vc(e),o=t._getSettings(),s={...o,emulatorOptions:t._getEmulatorOptions()},l=`${e}:${r}`;i&&(o2(`https://${l}`),s2("Firestore",!0)),o.host!==yP&&o.host!==l&&Tc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...o,host:l,ssl:i,emulatorOptions:n};if(!El(c,s)&&(t._setSettings(c),n.mockUserToken)){let d,u;if(typeof n.mockUserToken=="string")d=n.mockUserToken,u=vi.MOCK_USER;else{d=Ow(n.mockUserToken,t._app?.options.projectId);const h=n.mockUserToken.sub||n.mockUserToken.user_id;if(!h)throw new Vt(yt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new vi(h)}t._authCredentials=new y3(new e5(d,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Hs(this.firestore,e,this._query)}}class Nn{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ma(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Nn(this.firestore,e,this._key)}toJSON(){return{type:Nn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(pu(r,Nn._jsonSchema))return new Nn(e,n||null,new ir(un.fromString(r.referencePath)))}}Nn._jsonSchemaVersion="firestore/documentReference/1.0",Nn._jsonSchema={type:On("string",Nn._jsonSchemaVersion),referencePath:On("string")};class Ma extends Hs{constructor(e,r,n){super(e,r,Yf(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Nn(this.firestore,null,new ir(e))}withConverter(e){return new Ma(this.firestore,e,this._path)}}function fP(t,e,...r){if(t=Xn(t),t5("collection","path",e),t instanceof Rp){const n=un.fromString(e,...r);return Kv(n),new Ma(t,null,n)}{if(!(t instanceof Nn||t instanceof Ma))throw new Vt(yt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(un.fromString(e,...r));return Kv(n),new Ma(t.firestore,null,n)}}function Dp(t,e,...r){if(t=Xn(t),arguments.length===1&&(e=qf.newId()),t5("doc","path",e),t instanceof Rp){const n=un.fromString(e,...r);return Yv(n),new Nn(t,null,new ir(n))}{if(!(t instanceof Nn||t instanceof Ma))throw new Vt(yt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(un.fromString(e,...r));return Yv(n),new Nn(t.firestore,t instanceof Ma?t.converter:null,new ir(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M0="AsyncQueue";class F0{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new G5(this,"async_queue_retry"),this._c=()=>{const n=$m();n&&Xt(M0,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=$m();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=$m();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Ms;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Hc(e))throw e;Xt(M0,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Bs("INTERNAL UNHANDLED ERROR: ",O0(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=lg.createAndSchedule(this,e,r,n,o=>this.hc(o));return this.tc.push(i),i}uc(){this.nc&&hr(47125,{Pc:O0(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function O0(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class vu extends Rp{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new F0,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new F0(e),this._firestoreClient=void 0,await e}}}function uE(t,e){const r=typeof t=="object"?t:d2(),n=typeof t=="string"?t:Xh,i=kf(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const o=Mw("firestore");o&&dE(i,...o)}return i}function pg(t){if(t._terminated)throw new Vt(yt.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||hE(t),t._firestoreClient}function hE(t){const e=t._freezeSettings(),r=function(i,o,s,l){return new M3(i,o,s,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,mP(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new oE(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(i){const o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e){this._byteString=e}static fromBase64String(e){try{return new bo(li.fromBase64String(e))}catch(r){throw new Vt(yt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new bo(li.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:bo._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(pu(e,bo._jsonSchema))return bo.fromBase64String(e.bytes)}}bo._jsonSchemaVersion="firestore/bytes/1.0",bo._jsonSchema={type:On("string",bo._jsonSchemaVersion),bytes:On("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Vt(yt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new si(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mg{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Vt(yt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Vt(yt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Lr(this._lat,e._lat)||Lr(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ls._jsonSchemaVersion}}static fromJSON(e){if(pu(e,ls._jsonSchema))return new ls(e.latitude,e.longitude)}}ls._jsonSchemaVersion="firestore/geoPoint/1.0",ls._jsonSchema={type:On("string",ls._jsonSchemaVersion),latitude:On("number"),longitude:On("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:cs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(pu(e,cs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new cs(e.vectorValues);throw new Vt(yt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}cs._jsonSchemaVersion="firestore/vectorValue/1.0",cs._jsonSchema={type:On("string",cs._jsonSchemaVersion),vectorValues:On("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pE=/^__.*__$/;class mE{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Wa(e,this.data,this.fieldMask,r,this.fieldTransforms):new mu(e,this.data,r,this.fieldTransforms)}}class gP{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Wa(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function vP(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw hr(40011,{Ac:t})}}class yg{constructor(e,r,n,i,o,s){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new yg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return lp(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(vP(this.Ac)&&pE.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class yE{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||kp(e)}Cc(e,r,n,i=!1){return new yg({Ac:e,methodName:r,Dc:n,path:si.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Fp(t){const e=t._freezeSettings(),r=kp(t._databaseId);return new yE(t._databaseId,!!e.ignoreUndefinedProperties,r)}function fE(t,e,r,n,i,o={}){const s=t.Cc(o.merge||o.mergeFields?2:0,e,r,i);fg("Data must be an object, but it was:",s,n);const l=PP(n,s);let c,d;if(o.merge)c=new ro(s.fieldMask),d=s.fieldTransforms;else if(o.mergeFields){const u=[];for(const h of o.mergeFields){const g=Xy(e,h,r);if(!s.contains(g))throw new Vt(yt.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);SP(u,g)||u.push(g)}c=new ro(u),d=s.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,d=s.fieldTransforms;return new mE(new Hi(l),c,d)}class Op extends mg{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Op}}function gE(t,e,r,n){const i=t.Cc(1,e,r);fg("Data must be an object, but it was:",i,n);const o=[],s=Hi.empty();Ga(n,(c,d)=>{const u=gg(e,c,r);d=Xn(d);const h=i.yc(u);if(d instanceof Op)o.push(u);else{const g=bu(d,h);g!=null&&(o.push(u),s.set(u,g))}});const l=new ro(o);return new gP(s,l,i.fieldTransforms)}function vE(t,e,r,n,i,o){const s=t.Cc(1,e,r),l=[Xy(e,n,r)],c=[i];if(o.length%2!=0)throw new Vt(yt.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<o.length;g+=2)l.push(Xy(e,o[g])),c.push(o[g+1]);const d=[],u=Hi.empty();for(let g=l.length-1;g>=0;--g)if(!SP(d,l[g])){const m=l[g];let S=c[g];S=Xn(S);const N=s.yc(m);if(S instanceof Op)d.push(m);else{const x=bu(S,N);x!=null&&(d.push(m),u.set(m,x))}}const h=new ro(d);return new gP(u,h,s.fieldTransforms)}function bP(t,e,r,n=!1){return bu(r,t.Cc(n?4:3,e))}function bu(t,e){if(_P(t=Xn(t)))return fg("Unsupported field value:",e,t),PP(t,e);if(t instanceof mg)return function(n,i){if(!vP(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const o=[];let s=0;for(const l of n){let c=bu(l,i.wc(s));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),s++}return{arrayValue:{values:o}}}(t,e)}return function(n,i){if((n=Xn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return o4(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=fn.fromDate(n);return{timestampValue:ip(i.serializer,o)}}if(n instanceof fn){const o=new fn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:ip(i.serializer,o)}}if(n instanceof ls)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof bo)return{bytesValue:D5(i.serializer,n._byteString)};if(n instanceof Nn){const o=i.databaseId,s=n.firestore._databaseId;if(!s.isEqual(o))throw i.Sc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Zf(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof cs)return function(s,l){return{mapValue:{fields:{[d5]:{stringValue:u5},[Zh]:{arrayValue:{values:s.toArray().map(d=>{if(typeof d!="number")throw l.Sc("VectorValues must only contain numeric values.");return Qf(l.serializer,d)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${_p(n)}`)}(t,e)}function PP(t,e){const r={};return i5(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ga(t,(n,i)=>{const o=bu(i,e.mc(n));o!=null&&(r[n]=o)}),{mapValue:{fields:r}}}function _P(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof fn||t instanceof ls||t instanceof bo||t instanceof Nn||t instanceof mg||t instanceof cs)}function fg(t,e,r){if(!_P(r)||!r5(r)){const n=_p(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function Xy(t,e,r){if((e=Xn(e))instanceof Mp)return e._internalPath;if(typeof e=="string")return gg(t,e);throw lp("Field path arguments must be of type string or ",t,!1,void 0,r)}const bE=new RegExp("[~\\*/\\[\\]]");function gg(t,e,r){if(e.search(bE)>=0)throw lp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Mp(...e.split("."))._internalPath}catch{throw lp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function lp(t,e,r,n,i){const o=n&&!n.isEmpty(),s=i!==void 0;let l=`Function ${e}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${n}`),s&&(c+=` in document ${i}`),c+=")"),new Vt(yt.INVALID_ARGUMENT,l+t+c)}function SP(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{constructor(e,r,n,i,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Nn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new PE(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Bp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class PE extends vg{data(){return super.data()}}function Bp(t,e){return typeof e=="string"?gg(t,e):e instanceof Mp?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _E(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Vt(yt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class bg{}class Vp extends bg{}function wP(t,e,...r){let n=[];e instanceof bg&&n.push(e),n=n.concat(r),function(o){const s=o.filter(c=>c instanceof Pg).length,l=o.filter(c=>c instanceof jp).length;if(s>1||s>0&&l>0)throw new Vt(yt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class jp extends Vp{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new jp(e,r,n)}_apply(e){const r=this._parse(e);return CP(e._query,r),new Hs(e.firestore,e.converter,zy(e._query,r))}_parse(e){const r=Fp(e.firestore);return function(o,s,l,c,d,u,h){let g;if(d.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Vt(yt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){V0(h,u);const S=[];for(const N of h)S.push(B0(c,o,N));g={arrayValue:{values:S}}}else g=B0(c,o,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||V0(h,u),g=bP(l,s,h,u==="in"||u==="not-in");return Fn.create(d,u,g)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function Ad(t,e,r){const n=e,i=Bp("where",t);return jp._create(i,n,r)}class Pg extends bg{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Pg(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Vo.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,o){let s=i;const l=o.getFlattenedFilters();for(const c of l)CP(s,c),s=zy(s,c)}(e._query,r),new Hs(e.firestore,e.converter,zy(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class _g extends Vp{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new _g(e,r)}_apply(e){const r=function(i,o,s){if(i.startAt!==null)throw new Vt(yt.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Vt(yt.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new eu(o,s)}(e._query,this._field,this._direction);return new Hs(e.firestore,e.converter,function(i,o){const s=i.explicitOrderBy.concat([o]);return new Dl(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}function xP(t,e="asc"){const r=e,n=Bp("orderBy",t);return _g._create(n,r)}class Sg extends Vp{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new Sg(e,r,n)}_apply(e){return new Hs(e.firestore,e.converter,tp(e._query,this._limit,this._limitType))}}function SE(t){return C3("limit",t),Sg._create("limit",t,"F")}class wg extends Vp{constructor(e,r,n){super(),this.type=e,this._docOrFields=r,this._inclusive=n}static _create(e,r,n){return new wg(e,r,n)}_apply(e){const r=xE(e,this.type,this._docOrFields,this._inclusive);return new Hs(e.firestore,e.converter,function(i,o){return new Dl(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,o,i.endAt)}(e._query,r))}}function wE(...t){return wg._create("startAfter",t,!1)}function xE(t,e,r,n){if(r[0]=Xn(r[0]),r[0]instanceof vg)return function(o,s,l,c,d){if(!c)throw new Vt(yt.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const u=[];for(const h of wc(o))if(h.field.isKeyField())u.push(ep(s,c.key));else{const g=c.data.field(h.field);if(xp(g))throw new Vt(yt.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){const m=h.field.canonicalString();throw new Vt(yt.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${m}' (used as the orderBy) does not exist.`)}u.push(g)}return new Rc(u,d)}(t._query,t.firestore._databaseId,e,r[0]._document,n);{const i=Fp(t.firestore);return function(s,l,c,d,u,h){const g=s.explicitOrderBy;if(u.length>g.length)throw new Vt(yt.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const m=[];for(let S=0;S<u.length;S++){const N=u[S];if(g[S].field.isKeyField()){if(typeof N!="string")throw new Vt(yt.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof N}`);if(!Kf(s)&&N.indexOf("/")!==-1)throw new Vt(yt.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${N}' contains a slash.`);const x=s.path.child(un.fromString(N));if(!ir.isDocumentKey(x))throw new Vt(yt.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${x}' is not because it contains an odd number of segments.`);const b=new ir(x);m.push(ep(l,b))}else{const x=bP(c,d,N);m.push(x)}}return new Rc(m,h)}(t._query,t.firestore._databaseId,i,e,r,n)}}function B0(t,e,r){if(typeof(r=Xn(r))=="string"){if(r==="")throw new Vt(yt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Kf(e)&&r.indexOf("/")!==-1)throw new Vt(yt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(un.fromString(r));if(!ir.isDocumentKey(n))throw new Vt(yt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return ep(t,new ir(n))}if(r instanceof Nn)return ep(t,r._key);throw new Vt(yt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${_p(r)}.`)}function V0(t,e){if(!Array.isArray(t)||t.length===0)throw new Vt(yt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function CP(t,e){const r=function(i,o){for(const s of i)for(const l of s.getFlattenedFilters())if(o.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Vt(yt.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Vt(yt.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class CE{convertValue(e,r="none"){switch(ja(e)){case 0:return null;case 1:return e.booleanValue;case 2:return En(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Va(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw hr(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Ga(e,(i,o)=>{n[i]=this.convertValue(o,r)}),n}convertVectorValue(e){const r=e.fields?.[Zh].arrayValue?.values?.map(n=>En(n.doubleValue));return new cs(r)}convertGeoPoint(e){return new ls(En(e.latitude),En(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Cp(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Jd(e));default:return null}}convertTimestamp(e){const r=Ba(e);return new fn(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=un.fromString(e);Kr(j5(n),9688,{name:e});const i=new Xd(n.get(1),n.get(3)),o=new ir(n.popFirst(5));return i.isEqual(r)||Bs(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AE(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class $d{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class wl extends vg{constructor(e,r,n,i,o,s){super(e,r,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new kh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Bp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Vt(yt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=wl._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}wl._jsonSchemaVersion="firestore/documentSnapshot/1.0",wl._jsonSchema={type:On("string",wl._jsonSchemaVersion),bundleSource:On("string","DocumentSnapshot"),bundleName:On("string"),bundle:On("string")};class kh extends wl{data(e={}){return super.data(e)}}class Cc{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new $d(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new kh(this._firestore,this._userDataWriter,n.key,n,new $d(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Vt(yt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(l=>{const c=new kh(i._firestore,i._userDataWriter,l.doc.key,l.doc,new $d(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>o||l.type!==3).map(l=>{const c=new kh(i._firestore,i._userDataWriter,l.doc.key,l.doc,new $d(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,u=-1;return l.type!==0&&(d=s.indexOf(l.doc.key),s=s.delete(l.doc.key)),l.type!==1&&(s=s.add(l.doc),u=s.indexOf(l.doc.key)),{type:$E(l.type),doc:c,oldIndex:d,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Vt(yt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Cc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=qf.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function $E(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return hr(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AP(t){t=Vs(t,Nn);const e=Vs(t.firestore,vu);return lE(pg(e),t._key).then(r=>IE(e,t,r))}Cc._jsonSchemaVersion="firestore/querySnapshot/1.0",Cc._jsonSchema={type:On("string",Cc._jsonSchemaVersion),bundleSource:On("string","QuerySnapshot"),bundleName:On("string"),bundle:On("string")};class $P extends CE{constructor(e){super(),this.firestore=e}convertBytes(e){return new bo(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Nn(this.firestore,null,r)}}function EP(t){t=Vs(t,Hs);const e=Vs(t.firestore,vu),r=pg(e),n=new $P(e);return _E(t._query),cE(r,t._query).then(i=>new Cc(e,n,t,i))}function EE(t,e,r){t=Vs(t,Nn);const n=Vs(t.firestore,vu),i=AE(t.converter,e);return TP(n,[fE(Fp(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,ss.none())])}function IP(t,e,r,...n){t=Vs(t,Nn);const i=Vs(t.firestore,vu),o=Fp(i);let s;return s=typeof(e=Xn(e))=="string"||e instanceof Mp?vE(o,"updateDoc",t._key,e,r,n):gE(o,"updateDoc",t._key,e),TP(i,[s.toMutation(t._key,ss.exists(!0))])}function TP(t,e){return function(n,i){const o=new Ms;return n.asyncQueue.enqueueAndForget(async()=>Q$(await aE(n),i,o)),o.promise}(pg(t),e)}function IE(t,e,r){const n=r.docs.get(e._key),i=new $P(t);return new wl(t,i,e._key,n,new $d(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){qc=i})(jc),Ec(new Il("firestore",(n,{instanceIdentifier:i,options:o})=>{const s=n.getProvider("app").getImmediate(),l=new vu(new f3(n.getProvider("auth-internal")),new b3(s,n.getProvider("app-check-internal")),function(d,u){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Vt(yt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xd(d.options.projectId,u)}(s,i),s);return o={useFetchStreams:r,...o},l._setSettings(o),l},"PUBLIC").setMultipleInstances(!0)),La(Uv,Hv,e),La(Uv,Hv,"esm2020")})();let TE="eyAiYXBpS2V5IjogIkFJemFTeUJBbGN2WlRMMXRsQ05LRExENEJpTWJhR01iTnhCRjQtTSIsICAiYXV0aERvbWFpbiI6ICJocm0tMTEyOC5maXJlYmFzZWFwcC5jb20iLCAgImRhdGFiYXNlVVJMIjogImh0dHBzOi8vaHJtLTExMjguZmlyZWJhc2Vpby5jb20iLCAgInByb2plY3RJZCI6ICJocm0tMTEyOCIsICAic3RvcmFnZUJ1Y2tldCI6ICJocm0tMTEyOC5hcHBzcG90LmNvbSIsICAibWVzc2FnaW5nU2VuZGVySWQiOiAiMTA0OTI1MDU4NTI0NSIsICAiYXBwSWQiOiAiMToxMDQ5MjUwNTg1MjQ1OndlYjowZGFkMDAyMDI3MjM1MTRjY2M1Mjc0In0=";const kP=c2(JSON.parse($w(TE))),ml=d3(kP),cp=new rs,Fc=uE(kP);cp.addScope("profile");cp.addScope("email");class Ed extends Error{}Ed.prototype.name="InvalidTokenError";function kE(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function NE(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return kE(e)}catch{return atob(e)}}function LE(t,e){if(typeof t!="string")throw new Ed("Invalid token specified: must be a string");e||(e={});const r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new Ed(`Invalid token specified: missing part #${r+1}`);let i;try{i=NE(n)}catch(o){throw new Ed(`Invalid token specified: invalid base64 for part #${r+1} (${o.message})`)}try{return JSON.parse(i)}catch(o){throw new Ed(`Invalid token specified: invalid json for part #${r+1} (${o.message})`)}}const RE={clientId:"195275085181-8ccjpgp8v1g80qhnlk6v4lpgid7n81gr.apps.googleusercontent.com"},DE=t=>{const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>{window.google&&window.google.accounts.id.initialize({client_id:RE.clientId,callback:r=>{t(r.credential)},auto_select:!1,cancel_on_tap_outside:!0})},document.head.appendChild(e)},ME=t=>LE(t),FE=()=>{window.google&&window.google.accounts.id.disableAutoSelect()},[OE,BE]=Bc({}),VE=async()=>{const e=await Zr({query:"qcm42351987"});if(e&&!e.error){let n=Object.assign({},{},e);BE(n)}return 1},jE=async t=>{let e=OE?.[992002];e&&(e.params={tkn:t})},[oc,fi]=Bc({user:null,loading:!0,error:null,authMethod:null}),[NP,j0]=Se(null);JC(ml,t=>{t?fi({user:t,loading:!1,error:null,authMethod:"firebase"}):NP()||fi({user:null,loading:!1,error:null,authMethod:null})});AA(ml).then(t=>{t&&fi({user:t.user,loading:!1,error:null,authMethod:"firebase"})}).catch(t=>{console.error("Redirect sign-in error:",t),fi({loading:!1,error:t.message})});const Gt={get state(){return oc},async getUserProfile(t){try{const e=Dp(Fc,"users",t),r=await AP(e);if(r.exists()){fi("profile",r.data());let n={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_2376:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,HBLAccess:!1,PassportAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1},i=r.data(),o={};return Object.keys(n).map(s=>{let l=n?.[s];i.hasOwnProperty(s)||(o[s]=l)}),Object.keys(o).length>0&&IP(e,o),r.data()}else{let n=Gt?.state?.user,i={uid:n?.uid,email:n?.email,displayName:n?.displayName,createdAt:new Date,stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_2376:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,HBLAccess:!1,PassportAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};return await EE(e,i),console.log("No such user profile!"),null}}catch(e){return console.error("Error fetching user profile:",e),null}},getBusinessId:()=>Gt.state?.profile?.businessId,hasPermission:t=>{const e=Gt.state?.profile;return e?.isAdmin?!0:e?e?.[t]===!0:!1},async signInWithGoogle(){try{fi("loading",!0),fi("error",null);try{const t=await vA(ml,cp);fi({user:t.user,loading:!1,error:null,authMethod:"firebase"});try{Gt.getUserProfile(t.user.uid)}catch(e){console.error("firestore error:",e)}}catch(t){if(t.code==="auth/popup-blocked")await xA(ml,cp);else throw t}}catch(t){console.error("Sign-in error:",t),fi({loading:!1,error:t.message||"Failed to sign in with Google"})}},async signInWithGoogleP(t){const r=await Zr({params:{id_token:t},query:"getGoogleUserbyToken"});if(r&&r){let n=new Date().getTime(),i=new Date(n+6e4*60*24*365),o="hrm_tkn_acc";document.cookie=`${o}=${r.data}; expires=${i}; path=/;g_state = {"i_l":1,"i_p":${i}}; ssgl_access_tkn = ${t}`,document.cookie=`ssgl_access_tkn = ${t}; expires=${i};`,await VE(),jE(r.data)}},async signInWithGoogleCloud(t){try{fi("loading",!0),fi("error",null);const e=ME(t),r={uid:e.sub,email:e.email,displayName:e.name,photoURL:e.picture};j0(r);const n={uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,emailVerified:!0};fi({user:n,loading:!1,error:null,authMethod:"google-cloud"});try{const i=rs.credential(t);await YC(ml,i)}catch{console.log("Firebase sign-in optional, continuing with Google Cloud auth")}}catch(e){console.error("Google Cloud sign-in error:",e),fi({loading:!1,error:e.message||"Failed to sign in with Google Cloud"})}},async signOut(){try{fi("loading",!0),(oc.authMethod==="firebase"||ml.currentUser)&&await XC(ml),oc.authMethod==="google-cloud"&&(FE(),j0(null)),fi({user:null,loading:!1,error:null,authMethod:null})}catch(t){console.error("Sign-out error:",t),fi({loading:!1,error:t.message||"Failed to sign out"})}},get isAuthenticated(){return!!oc.user||!!NP()},get currentUser(){return oc.user},get authMethod(){return oc.authMethod}},zE=async()=>({}),qE=()=>(typeof window<"u"&&localStorage.getItem("hrmfinance-api-mode"),"real");let yl=qE();const Zy={getMode(){return yl},setMode(t){yl=t,typeof window<"u"&&localStorage.setItem("hrmfinance-api-mode",t)},isFakeMode(){return yl==="fake"},isRealMode(){return yl==="real"},isHybridMode(){return yl==="hybrid"}},mn=async(t,e,r=!0)=>{if(yl==="fake")return e();if(yl==="real")return t();try{return await t()}catch(n){if(console.warn("Real API failed, falling back to fake server:",n),r)return e();throw n}},z0={async getAll(t,e){const r=await Zr({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:{businessId:Gt.getBusinessId(),":search0":"produ"}});return gl(r)},async getById(t){return mn(async()=>(await this.getAll()).find(r=>r.id===t)||null,()=>cn.products.getById(t))},async create(t){return mn(async()=>{throw console.log("Creating product via real API:",t),new Error("Real API not implemented yet")},()=>cn.products.create(t))},async update(t,e){return mn(async()=>{throw console.log("Updating product via real API:",t,e),new Error("Real API not implemented yet")},()=>cn.products.update(t,e))},async delete(t){return mn(async()=>{throw console.log("Deleting product via real API:",t),new Error("Real API not implemented yet")},()=>cn.products.delete(t))}},ai={async getInventory(t,e){if(!(t&&t?.trim()))return[];let r={businessId:Gt.getBusinessId()};return t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())}),await Zr({query:"getScanYabaInventory",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async getProducts(t){if(!(t&&t?.trim()))return[];let e={businessId:Gt.getBusinessId()};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await Zr({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getConsigee(t){if(!(t&&t?.trim()))return[];let e={businessId:"all"};t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())});const n=await Ay({query:"getConsigneeYabaExpress",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e});return console.log({response:n}),n.data},async getShipper(t){if(!(t&&t?.trim()))return[];let e={businessId:"all"};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),(await Ay({query:"getShipperYabaExpress",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})).data},async getInvoice(t,e){if(!(t&&t?.trim()))return[];let r={businessId:Gt.getBusinessId()};return t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())}),await Zr({query:"getScanYabaSalesOrders",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async addInventory(t){let r={query:"addYabaInventory",params:{businessId:Gt.getBusinessId()},form:t};return await Zr(r)},async updInventory(t){return Gt.getBusinessId(),await zE()},async addInvoice(t){let r={query:"addYabaSalesOrders",params:{businessId:Gt.getBusinessId()},form:t};return await Zr(r)},async getHBLS(t,e){if(!(t&&t?.trim()))return[];let r={businessId:Gt.getBusinessId()};e?.search,e?.guia&&e.guia!=="all"&&(r.guia=e.guia),t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())});let n={query:"getScanYabaHbls",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4 AND guia = guia",params:r};const i=await Zr(n);return console.log(n),console.log(i),i},async updateHBLStatus(t,e){let r={businessId:Gt.getBusinessId(),":search0":t},n={timeStamp:new Date().getTime(),statusId:e?.idguidestate,userId:"107024974104054421738",userName:"Rrynier Moplesi"};const o=await Zr({query:"updateScanLocationBagsLocation",params:r,form:n});return console.log(o),o}},xg={async getAll(t){return ai.getInventory("ref")},async getById(t){return mn(async()=>{throw console.log("Getting movement by ID via real API:",t),new Error("Real API not implemented yet")},()=>cn.movements.getById(t))},async create(t){return mn(async()=>{throw console.log("Creating movement via real API:",t),new Error("Real API not implemented yet")},()=>cn.movements.create(t))},async update(t,e){return mn(async()=>{throw console.log("Updating movement via real API:",t,e),new Error("Real API not implemented yet")},()=>cn.movements.update(t,e))},async createBulk(t){return mn(async()=>{throw console.log("Creating bulk movements via real API:",t),new Error("Real API not implemented yet")},()=>cn.movements.createBulk(t))},async getStockLevels(t){return await Zr({query:"calculateInventoryStock",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:t})},async calcStockLevels(){return[]}},Fd={async getAlls(t,e){if(console.log("getAlls",t),!(t&&t?.trim()))return[];let r={businessId:"hcPiDPfZFS8ymqoh"};e?.search,t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())});const i=await Zr({query:"getAllAccountsByUserId",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4 AND guia = guia",params:r});return console.log(i),i},async getAll(t){return mn(async()=>{throw console.log("Getting accounts via real API:",t),new Error("Real API not implemented yet")},()=>cn.accounts.getAll(t))},async getById(t){return mn(async()=>{throw console.log("Getting account by ID via real API:",t),new Error("Real API not implemented yet")},()=>cn.accounts.getById(t))},async create(t){let r={query:"addAccounts",params:{businessId:"hcPiDPfZFS8ymqoh"},form:t};console.log(r);const n=await Zr(r);return console.log(n),n},async update(t,e){let n={query:"updateAccounts",params:{businessId:"hcPiDPfZFS8ymqoh",accountId:t},data2update:e};console.log(n);const i=await Zr(n);return console.log(i),i},async delete(t){let r={query:"deleteAccounts",params:{businessId:"hcPiDPfZFS8ymqoh",accountId:t}};console.log(r);const n=await Zr(r);return console.log(n),n}},Im={async getAll(t,e){if(console.log("getAlls",t),!(t&&t?.trim()))return[];let r={businessId:"hcPiDPfZFS8ymqoh"};return e?.search,t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())}),await Zr({query:"getScanSSGEntryBooks",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4 AND createdTimeStamp > :date1 AND createdTimeStamp < :date2 AND account contain :account AND subAccount contain :subAccount AND status = :status",params:r})},async getById(t){return mn(async()=>{throw console.log("Getting journal entry by ID via real API:",t),new Error("Real API not implemented yet")},()=>cn.journal.getById(t))},async create(t){return await Zr({query:"addSSGEntryBooks",params:{businessId:"hcPiDPfZFS8ymqoh"},form:t})},async update(t,e){return await Zr({query:"updateSSGEntryBooks",params:{businessId:"hcPiDPfZFS8ymqoh",id:t},form:e})},async post(t){return mn(async()=>{throw console.log("Posting journal entry via real API:",t),new Error("Real API not implemented yet")},()=>cn.journal.post(t))}},q0={async getNextEntryNumber(){return mn(async()=>{throw console.log("Getting next entry number via real API"),new Error("Real API not implemented yet")},()=>cn.utils.getNextEntryNumber())},async getNextProductCode(t){return mn(async()=>{throw console.log("Getting next product code via real API:",t),new Error("Real API not implemented yet")},()=>cn.utils.getNextProductCode(t))},async healthCheck(){return mn(async()=>{const t=await fetch("/api/health");if(!t.ok)throw new Error("Health check failed");return t.json()},()=>cn.utils.healthCheck())},async getStats(){return mn(async()=>{throw console.log("Getting stats via real API"),new Error("Real API not implemented yet")},()=>cn.utils.getStats())}},UE=()=>{Zy.setMode("real"),console.log("🚀 HRM Finance initialized in REAL API mode for production")};UE();var HE=le("<p>"),GE=le('<div><div><div><h1>HRM Finance</h1><p>Complete Business Management Solution</p><div><div><button><svg width=24 height=24 viewBox="0 0 24 24"><path fill=#4285F4 d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path><path fill=#34A853 d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path><path fill=#FBBC05 d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path><path fill=#EA4335 d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path></svg></button><p>Firebase Authentication</p></div></div></div><div><div><div>💰</div><h3>Financial Management</h3><p>Complete chart of accounts, balance sheets, journal entries, and invoice management in one place.</p></div><div><div>👥</div><h3>HR Management</h3><p>Track employees, manage onboarding, and monitor your workforce with powerful analytics.</p></div><div><div>📦</div><h3>Inventory Control</h3><p>Real-time inventory tracking, product management, and movement history across multiple locations.</p></div><div><div>🏦</div><h3>Banking Integration</h3><p>Streamline bank reconciliation with CSV imports and automated consolidation features.</p></div><div><div>📊</div><h3>Real-time Analytics</h3><p>Get instant insights with dashboards showing revenue, cash flow, and business performance.</p></div><div><div>🌐</div><h3>Multi-language Support</h3><p>Available in multiple languages to support your global business operations.</p></div></div><div><p>Secure authentication powered by Google • Your data is encrypted and protected</p><p>Choose your preferred authentication method above');const WE=()=>{Ln(()=>{DE(x=>{Gt.signInWithGoogleP(x)}),setTimeout(()=>{},100)});const t={"min-height":"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},e={background:"white","border-radius":"1rem","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","max-width":"1200px",width:"100%",overflow:"hidden"},r={padding:"3rem","text-align":"center","border-bottom":"1px solid #e2e8f0"},n={"font-size":"2.5rem","font-weight":"800",color:"#1a202c","margin-bottom":"1rem"},i={"font-size":"1.125rem",color:"#718096","margin-bottom":"2rem"},o={display:"flex","flex-direction":"column",gap:"1rem","align-items":"center","margin-bottom":"1rem"},s={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"2rem",padding:"3rem"},l={"text-align":"center",padding:"2rem","border-radius":"0.5rem",background:"#f7fafc",transition:"transform 0.2s",cursor:"default"},c={"font-size":"3rem","margin-bottom":"1rem"},d={"font-size":"1.25rem","font-weight":"600",color:"#2d3748","margin-bottom":"0.5rem"},u={color:"#718096","line-height":"1.6"},h={display:"inline-flex","align-items":"center",gap:"0.75rem",background:"white",color:"#4285f4",border:"2px solid #4285f4",padding:"0.75rem 2rem","font-size":"1.125rem","font-weight":"500","border-radius":"0.5rem",cursor:"pointer",transition:"all 0.2s","min-width":"250px","justify-content":"center"},g={color:"#e53e3e","margin-top":"1rem","font-size":"0.875rem"},m={background:"#f7fafc",padding:"2rem","text-align":"center",color:"#718096","font-size":"0.875rem"},S={"font-size":"0.75rem",color:"#718096","margin-top":"0.25rem","font-style":"italic"},N=()=>{Gt.signInWithGoogle()};return(()=>{var x=GE(),b=x.firstChild,K=b.firstChild,te=K.firstChild,F=te.nextSibling,V=F.nextSibling,W=V.firstChild,I=W.firstChild;I.firstChild;var E=I.nextSibling,L=K.nextSibling,M=L.firstChild,P=M.firstChild,w=P.nextSibling,v=w.nextSibling,j=M.nextSibling,z=j.firstChild,T=z.nextSibling,R=T.nextSibling,J=j.nextSibling,X=J.firstChild,H=X.nextSibling,se=H.nextSibling,O=J.nextSibling,_=O.firstChild,k=_.nextSibling,$=k.nextSibling,G=O.nextSibling,ne=G.firstChild,U=ne.nextSibling,D=U.nextSibling,B=G.nextSibling,Q=B.firstChild,Z=Q.nextSibling,oe=Z.nextSibling,de=L.nextSibling,re=de.firstChild,Y=re.nextSibling;return p(x,t),p(b,e),p(K,r),p(te,n),p(F,i),p(V,o),I.addEventListener("mouseleave",ce=>{ce.currentTarget.style.background="white",ce.currentTarget.style.color="#4285f4"}),I.addEventListener("mouseenter",ce=>{ce.currentTarget.style.background="#4285f4",ce.currentTarget.style.color="white"}),I.$$click=N,p(I,h),a(I,A(Me,{get when(){return Gt.state.loading},fallback:"Sign in with Google",children:"Signing in..."}),null),p(E,S),a(K,A(Me,{get when(){return Gt.state.error},get children(){var ce=HE();return p(ce,g),a(ce,()=>Gt.state.error),ce}}),null),p(L,s),p(de,m),Y.style.setProperty("margin-top","0.5rem"),Y.style.setProperty("font-size","0.75rem"),ge(ce=>{var ue=Gt.state.loading,ae=l,ye=c,me=d,pe=u,ve=l,Ne=c,Ie=d,Ce=u,Ee=l,we=c,Re=d,He=u,je=l,Ve=c,qe=d,tt=u,rt=l,Be=c,Ge=d,Fe=u,at=l,lt=c,Xe=d,Ct=u;return ue!==ce.e&&(I.disabled=ce.e=ue),ce.t=p(M,ae,ce.t),ce.a=p(P,ye,ce.a),ce.o=p(w,me,ce.o),ce.i=p(v,pe,ce.i),ce.n=p(j,ve,ce.n),ce.s=p(z,Ne,ce.s),ce.h=p(T,Ie,ce.h),ce.r=p(R,Ce,ce.r),ce.d=p(J,Ee,ce.d),ce.l=p(X,we,ce.l),ce.u=p(H,Re,ce.u),ce.c=p(se,He,ce.c),ce.w=p(O,je,ce.w),ce.m=p(_,Ve,ce.m),ce.f=p(k,qe,ce.f),ce.y=p($,tt,ce.y),ce.g=p(G,rt,ce.g),ce.p=p(ne,Be,ce.p),ce.b=p(U,Ge,ce.b),ce.T=p(D,Fe,ce.T),ce.A=p(B,at,ce.A),ce.O=p(Q,lt,ce.O),ce.I=p(Z,Xe,ce.I),ce.S=p(oe,Ct,ce.S),ce},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0}),x})()};Wt(["click"]);var YE=le("<div><div>");const KE=t=>{const e={"min-height":"100vh",display:"flex","align-items":"center","justify-content":"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},r={width:"50px",height:"50px",border:"3px solid rgba(255, 255, 255, 0.3)","border-top-color":"white","border-radius":"50%",animation:"spin 1s linear infinite"},n=document.createElement("style");return n.textContent=`
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  `,document.head.appendChild(n),Un(async()=>{Gt.state?.user?.uid&&Gt.getUserProfile(Gt.state?.user?.uid)}),Ln(()=>{}),A(Me,{get when(){return!Gt.state.loading},get fallback(){return(()=>{var i=YE(),o=i.firstChild;return p(i,e),p(o,r),i})()},get children(){return A(Me,{get when(){return Gt.isAuthenticated},get fallback(){return A(WE,{})},get children(){return t.children}})}})};var QE=le("<button>");const ct=t=>{const e=()=>{const r={"font-family":"inherit",cursor:t.disabled?"not-allowed":"pointer",border:"none","border-radius":"var(--border-radius-sm)","font-weight":"500",transition:"all 0.2s ease","text-decoration":"none",display:"inline-flex","align-items":"center","justify-content":"center",gap:"0.5rem",opacity:t.disabled?"0.6":"1"},n={sm:{padding:"0.5rem 1rem","font-size":"0.875rem"},md:{padding:"0.75rem 1.5rem","font-size":"1rem"},lg:{padding:"1rem 2rem","font-size":"1.125rem"}},i={primary:{background:"linear-gradient(135deg, var(--primary-color), var(--primary-dark))",color:"white","box-shadow":"var(--shadow-sm)"},secondary:{background:"var(--surface-color)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},outline:{background:"transparent",color:"var(--primary-color)",border:"1px solid var(--primary-color)"}};return{...r,...n[t.size||"md"],...i[t.variant||"primary"]}};return(()=>{var r=QE();return Cn(r,"click",t.onClick,!0),a(r,()=>t.children),ge(n=>{var i=e(),o=t.disabled,s=t.type||"button",l=`btn btn-${t.variant||"primary"} ${t.className||""}`;return n.e=p(r,i,n.e),o!==n.t&&(r.disabled=n.t=o),s!==n.a&&Jt(r,"type",n.a=s),l!==n.o&&fp(r,n.o=l),n},{e:void 0,t:void 0,a:void 0,o:void 0}),r})()};Wt(["click"]);var JE=le("<div><div><div><h2></h2><button>×</button></div><div>");const Bn=t=>{const e={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},r={background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)",width:"90%","max-height":"80vh",overflow:"auto",position:"relative"},n={padding:"1.5rem","border-bottom":"1px solid var(--border-color)",display:"flex","justify-content":"space-between","align-items":"center"},i={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},o={background:"none",border:"none","font-size":"1.5rem",cursor:"pointer",color:"var(--text-muted)",padding:"0.5rem","border-radius":"var(--border-radius-sm)"},s={padding:"1.5rem"},l=c=>{c.target===c.currentTarget&&t.onClose()};return A(Me,{get when(){return t.isOpen},get children(){var c=JE(),d=c.firstChild,u=d.firstChild,h=u.firstChild,g=h.nextSibling,m=u.nextSibling;return c.$$click=l,p(u,n),p(h,i),a(h,()=>t.title),g.addEventListener("mouseleave",S=>S.target.style.background="none"),g.addEventListener("mouseenter",S=>S.target.style.background="var(--background-color)"),Cn(g,"click",t.onClose,!0),p(g,o),p(m,s),a(m,()=>t.children),ge(S=>{var N=e,x=r;return S.e=p(c,N,S.e),S.t=p(d,x,S.t),S},{e:void 0,t:void 0}),c}})};Wt(["click"]);var U0=le("<div>"),XE=le("<h3>"),ZE=le("<p>");const Rt=t=>{const e={background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"1.5rem","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",transition:"all 0.2s ease",cursor:t.onClick?"pointer":"default",margin:"9px"},r={"margin-bottom":"1rem"},n={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0 0 0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)",margin:"0"};return(()=>{var o=U0();return Cn(o,"click",t.onClick,!0),a(o,(()=>{var s=ke(()=>!!(t.title||t.subtitle));return()=>s()&&(()=>{var l=U0();return p(l,r),a(l,(()=>{var c=ke(()=>!!t.title);return()=>c()&&(()=>{var d=XE();return p(d,n),a(d,()=>t.title),d})()})(),null),a(l,(()=>{var c=ke(()=>!!t.subtitle);return()=>c()&&(()=>{var d=ZE();return p(d,i),a(d,()=>t.subtitle),d})()})(),null),l})()})(),null),a(o,()=>t.children,null),ge(s=>{var l=e,c=`card ${t.className||""}`;return s.e=p(o,l,s.e),c!==s.t&&fp(o,s.t=c),s},{e:void 0,t:void 0}),o})()};Wt(["click"]);var eI=le("<div><label></label><input>"),tI=le("<span>*");const Lt=t=>{const e={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},r={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},n={"margin-bottom":"1rem"},[i,o]=Se("");Un(()=>{t?.value!==void 0&&o(t.value.toString())});const s=c=>{(c.key==="Enter"||c.key==="Escape"||c.key==="Tab")&&t.onChange&&Sl(i())&&t.onChange(i())},l=()=>{Sl(i())&&t.onChange(i())};return(()=>{var c=eI(),d=c.firstChild,u=d.nextSibling;return p(c,n),p(d,e),a(d,()=>t.label,null),a(d,(()=>{var h=ke(()=>!!t.required);return()=>h()&&(()=>{var g=tI();return g.style.setProperty("color","var(--primary-color)"),g})()})(),null),u.addEventListener("blur",h=>{l(),h.target.style.borderColor="var(--border-color)"}),u.addEventListener("focus",h=>{h.target.style.borderColor="var(--primary-color)"}),u.$$keydown=s,u.$$input=h=>o(h.target.value),ge(h=>{var g=t.type||"text",m=t.placeholder,S=t.required,N=t.disabled||t.readOnly,x=t.readOnly,b={...r,...t?.style};return g!==h.e&&Jt(u,"type",h.e=g),m!==h.t&&Jt(u,"placeholder",h.t=m),S!==h.a&&(u.required=h.a=S),N!==h.o&&(u.disabled=h.o=N),x!==h.i&&(u.readOnly=h.i=x),h.n=p(u,b,h.n),h},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),ge(()=>u.value=i()),c})()};Wt(["input","keydown"]);const rI={en:{common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",close:"Close",search:"Search",filter:"Filter",reset:"Reset",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",actions:"Actions",status:"Status",active:"Active",inactive:"Inactive",date:"Date",time:"Time",description:"Description",notes:"Notes",amount:"Amount",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Language",english:"English",spanish:"Spanish",noDataFound:"No data found",required:"Required",optional:"Optional",all:"All",none:"None",select:"Select",clear:"Clear",searching:"Searching...",refresh:"Refresh",showAll:"Show All",products:"products",filtered:"Filtered",view:"View",suggested:"Suggested",clearFilters:"Clear Filters",enhanced:"Enhanced",legacy:"Legacy",email:"Email",phone:"Phone",address:"Address",name:"Name",code:"Code",category:"Category",type:"Type",quantity:"Quantity",price:"Price",cost:"Cost",value:"Value",balance:"Balance",created:"Created",modified:"Modified",details:"Details",summary:"Summary",history:"History",new:"New",addNew:"Add New",unknown:"Unknown",notAvailable:"N/A",remove:"Remove",startDate:"Start Date",endDate:"End Date",from:"From",invoice:"Invoice",invoices:"invoices",reference:"Reference",createdBy:"Created By",units:"units",invoiceDocumentId:"Invoice/Document ID",referenceNumber:"Reference Number",referenceNumberPlaceholder:"Enter reference number...",generalNotes:"General Notes",auto:"Auto",optionalNotes:"Optional notes...",showPerPage:"Show per page",first:"First",last:"Last",store:"Store",orderId:"Order ID",tax:"Tax",paymentMethods:"Payment Methods",cash:"Cash",creditCard:"Credit Card",shipping:"Shipping",air:"Air",sea:"Sea",thankYouBusiness:"Thank you for your business!",thankForChoosingUs:"Thank you for choosing us!",taxExemptNote:"Tax exempted on cash payment.",youSaved:"You saved",generatedOn:"Generated on",printSavePDF:"Print / Save as PDF",pageOfPages:"Page {{current}} of {{total}}",showingXofY:"Showing {{start}}-{{end}} of {{total}}",page:"Page",of:"of",print:"Print",export:"Export",pending:"Pending",completed:"Completed",customer:"Customer",location:"Location",reservations:"Reservations",backToDashboard:"Back to Dashboard",lbs:"pounds"},navigation:{dashboard:"Dashboard",accounts:"Chart of Accounts",balanceSheet:"Balance Sheet",inventory:"Inventory",employees:"Employees",entryBooks:"Entry Books",consolidate:"Bank Consolidation",reports:"Reports",settings:"Settings"},dashboard:{title:"Dashboard",welcome:"Welcome to HRM Finance",totalRevenue:"Total Revenue",overview:"Overview",recentActivity:"Recent Activity",quickActions:"Quick Actions",employeeCount:"Employee Count",pendingInvoices:"Pending Invoices",cashBalance:"Cash Balance",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalExpenses:"Total Expenses",netIncome:"Net Income",netLoss:"Net Loss",monthlyPayroll:"Monthly Payroll",current:"Current",newHires:"+3 new hires",outstanding:"Outstanding",totalOutstanding:"$23,450 total",lastUpdatedToday:"Last updated today",commonTasks:"Common tasks",generateReport:"Generate Report",latestUpdates:"Latest updates",invoicePaid:"Invoice #1234 paid",hoursAgo:"2 hours ago",newEmployeeOnboarded:"New employee onboarded",dayAgo:"1 day ago",monthlyReportGenerated:"Monthly report generated",daysAgo:"2 days ago"},accounts:{title:"Chart of Accounts",accountNumber:"Account Number",accountName:"Account Name",accountType:"Account Type",category:"Category",balance:"Balance",parentAccount:"Parent Account",subAccounts:"Sub-accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",transactions:"Transactions",accountHistory:"Account History",backToAccounts:"Back to Accounts",accountNotFound:"Account not found",accountInformation:"Account Information",accountPurpose:"Account purpose",transactionHistory:"Transaction History",noTransactions:"No transactions found for this account",createdDate:"Created Date",lastModified:"Last Modified",noDescription:"No description provided.",totalCount:"Total count",basicDetails:"Basic details",currentBalance:"Current balance",classification:"Classification",allTransactions:"All account transactions",reference:"Reference",allAccounts:"All Accounts",types:{asset:"Asset",liability:"Liability",equity:"Equity",revenue:"Revenue",expense:"Expense"},categories:{currentAssets:"Current Assets",fixedAssets:"Fixed Assets",currentLiabilities:"Current Liabilities",longTermLiabilities:"Long-term Liabilities",ownersEquity:"Owner's Equity",operatingRevenue:"Operating Revenue",operatingExpenses:"Operating Expenses"}},inventory:{title:"Inventory Management",overview:"Overview",products:"Products & Stock",movements:"Movements",locations:"Locations",bulkMovement:"Bulk Movement",addMovement:"Add Movement",addProduct:"Add Product",addLocation:"Add Location",singleMovement:"Add Single Movement",addNewItem:"Add New Item",activeProducts:"Active Products",lowStockAlert:"Low Stock Items",totalValue:"Total Stock Value",activeLocations:"Active Locations",productsNeedRestocking:"products need restocking",recentMovements:"Recent Movements",noProducts:"No products at this location",productName:"Product Name",productCode:"Product Code",sku:"SKU",unitOfMeasure:"Unit of Measure",unitCost:"Unit Cost",minStockLevel:"Min Stock Level",maxStockLevel:"Max Stock Level",locationName:"Location Name",locationType:"Location Type",locationCode:"Location Code",movementType:"Movement Type",referenceNumber:"Reference Number",invoiceNumber:"Invoice Number",fromLocation:"From Location",toLocation:"To Location",stockIn:"Stock In",stockOut:"Stock Out",transfer:"Transfer",adjustment:"Adjustment",inStock:"In Stock",lowStock:"Low Stock",outOfStock:"Out of Stock",stockLevels:"Stock Levels",stockByLocation:"Stock by Location",searchProducts:"Search products by name, SKU, or category...",searchProductsStock:"Search products and check stock levels...",searchResult:"Search Result",searchResults:"Search Results",searchFallback:"Showing local results",tryDifferentTerm:"Try a different search term or check spelling.",showingTopResults:"Showing top {{count}} results",searchLocations:"Search locations...",noMovements:"No movements found",productDetails:"Product Details",locationDetails:"Location Details",movementDetails:"Movement Details",totalProducts:"Total Products",totalLocations:"Total Locations",lastSeen:"Last seen",warehouseType:"Warehouse",storeType:"Store",supplierType:"Supplier",customerType:"Customer",currentlyManaged:"Currently managed",needAttention:"Need attention",currentWorth:"Current worth",warehousesStores:"Warehouses & stores",thisMonth:"This Month",latestActivities:"Latest inventory activities",searchMovements:"Search Movements",countingSheet:"Counting Sheet",physicalCount:"Physical Count",physicalInventoryCount:"Physical Inventory Count",setupPhysicalCount:"Setup Physical Inventory Count",setupDescription:"Configure your physical inventory count settings and begin the counting process.",countWillInclude:"This count will include {{count}} products from {{location}} in {{category}} category.",startCounting:"Start Physical Count",counted:"Counted",remaining:"Remaining",variances:"Variances",complete:"Complete",systemQty:"System Qty",variance:"Variance",addNotes:"Add notes...",reviewAndConfirm:"Review and Confirm Adjustments",reviewDescription:"Review the inventory adjustments below and confirm to update your system.",stockIncreases:"Stock Increases",stockDecreases:"Stock Decreases",totalAdjustments:"Total Adjustments",confirmAdjustments:"Confirm Adjustments",perfectCount:"Perfect Count!",noVariances:"No variances found. Your physical count matches the system exactly.",physicalCountAdjustment:"Physical count adjustment",inventoryCountingSheetTitle:"INVENTORY COUNTING SHEET",location:"Location",allCategories:"All Categories",countedBy:"Counted by",verifiedBy:"Verified by",instructions:"Instructions",countInstructions:["Count all items physically present at this location",'Write the actual count in the "Physical Count" column',"Leave blank if item is not found",'Note any discrepancies in the "Notes" column',"Sign and date when complete"],unit:"Unit",totalProductsListed:"Total Products Listed",itemsCounted:"Items Counted",summaryFor:"SUMMARY FOR",discrepanciesFound:"Discrepancies Found",counterSignature:"Counter Signature",supervisorSignature:"Supervisor Signature",downloadCSV:"Download CSV",noAdjustmentsToDownload:"No adjustments to download",stockIncrease:"Stock Increase",stockDecrease:"Stock Decrease",purchaseReceive:"Purchase/Receive",saleIssue:"Sale/Issue",generalNotesPlaceholder:"Enter general notes for this movement...",sortBy:"Sort By",allLocations:"All Locations",searchByProduct:"Search by product, location, reference, notes, invoice...",allProducts:"All Products",bulkMovementReport:"Bulk Movement Report",totalQuantity:"Total Quantity",estimatedValue:"Estimated Value",viewHistoricalReports:"View Historical Reports",noBulkReportsFound:"No bulk movement reports found",bulkReportsAppearHere:"Bulk movement reports will appear here after you create bulk movements",allTypes:"All Types",startDate:"Start Date",endDate:"End Date",totalMovements:"Total Movements",totalItems:"Total Items",adjustMovements:"Try adjusting your filters or check back later.",inventoryMovements:"Inventory Movements",createdBy:"Created By",view:"View",enhanced:"Enhanced",legacy:"Legacy",addSingleMovement:"Add Single Movement",inStockSubtitle:"In stock",itemsBelowThreshold:"Items below threshold",inventoryWorth:"Inventory worth",quantity:"Quantity",units:"units",normal:"Normal",productsAndStock:"Products & Stock",lowStockItems:"Low Stock Items",totalStockValue:"Total Stock Value",warehousesAndStores:"Warehouses & stores",andMore:"...and {count} more",latestInventoryActivities:"Latest inventory activities",min:"Min",max:"Max",cost:"Cost",noProductsFound:"No products found matching your search.",noProductsAvailable:"No products available.",noLocationsFound:"No locations found matching your search.",noLocationsAvailable:"No locations available.",searchPlaceholder:"Search by product, location, reference, notes, invoice...",noMovementsFound:"No movements found",tryAdjustingFilters:"Try adjusting your filters or check back later.",transfers:"Transfers",adjustments:"Adjustments",bulk:"Bulk",product:"Product",store:"Store",supplier:"Supplier",warehouse:"Warehouse",movement:"Movement",editMovement:"Edit Movement",updateMovement:"Update Movement",movementInformation:"Movement Information",locationInformation:"Location Information",searchProductsImages:"Search products to view images...",searchForProducts:"Search for Products",startTypingToSearch:"Start typing to search and view product images",tryDifferentSearch:"Try a different search term"},employees:{title:"Employee Management",employeeList:"Employee List",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",payrollInfo:"Payroll Information",firstName:"First Name",lastName:"Last Name",fullName:"Full Name",email:"Email",phone:"Phone",address:"Address",dateOfBirth:"Date of Birth",employeeId:"Employee ID",department:"Department",position:"Position",hireDate:"Hire Date",employmentStatus:"Employment Status",salary:"Salary",payFrequency:"Pay Frequency",taxId:"Tax ID",bankAccount:"Bank Account",emergencyContact:"Emergency Contact",activeEmployees:"Active Employees",inactiveEmployees:"Inactive Employees",totalPayroll:"Total Payroll",searchEmployees:"Search employees...",enterFullName:"Enter employee's full name",enterPosition:"Enter job position",enterEmail:"Enter email address",enterPhone:"Enter phone number",enterSalary:"Enter annual salary",departments:{engineering:"Engineering",product:"Product",design:"Design",marketing:"Marketing",sales:"Sales",humanResources:"Human Resources",finance:"Finance",operations:"Operations",analytics:"Analytics"}},entryBooks:{title:"Entry Books",bookName:"Book Name",bookType:"Book Type",createBook:"Create Book",editBook:"Edit Book",salesBook:"Sales Book",purchaseBook:"Purchase Book",cashBook:"Cash Book",generalBook:"General Book",entries:"Entries",addEntry:"Add Entry",period:"Period",startDate:"Start Date",endDate:"End Date",bookBalance:"Book Balance",reconciledBalance:"Reconciled Balance",difference:"Difference",reconcile:"Reconcile",isReconciled:"Is Reconciled",noBooks:"No entry books found",createFirst:"Create your first entry book to get started",bookDetails:"Book Details",entriesCount:"entries",bookOverview:"Book overview and details",bookEntries:"Book Entries",allEntries:"All entries in this book",noEntries:"No entries found",addFirst:"Add your first entry to this book",entryDate:"Entry Date",entryDescription:"Entry Description",entryAmount:"Entry Amount",entryReference:"Entry Reference",subtitle:"Manage accounting entries and general ledger records",viewReconciliation:"View Reconciliation",totalEntries:"Total Entries",allJournalEntries:"All journal entries",postedEntriesOnly:"Posted entries only",fromPostedEntries:"From {count} posted entries",needBankReconciliation:"Need bank reconciliation",allReconciled:"All reconciled",sortBy:"Sort By",fromDate:"From Date",toDate:"To Date",order:"Order",newest:"Newest",oldest:"Oldest",resetFilters:"Reset Filters",activeFilters:"Active filters",from:"From",to:"To",entriesFound:"{count} entries found",noJournalEntries:"No Journal Entries",startByCreating:"Start by creating your first entry",noEntriesMatch:"No journal entries match your current filters.",createFirstEntry:"Create First Entry",void:"Void",confirmVoid:"Are you sure you want to void this journal entry?",entryBookRecords:"Entry Book Records"},banking:{title:"Bank Consolidation",bankAccount:"Bank Account",statementDate:"Statement Date",beginningBalance:"Beginning Balance",endingBalance:"Ending Balance",deposits:"Deposits",withdrawals:"Withdrawals",bankCharges:"Bank Charges",interest:"Interest",reconcile:"Reconcile",matched:"Matched",unmatched:"Unmatched",importStatement:"Import Statement",manualEntry:"Manual Entry",autoMatch:"Auto Match",clearAll:"Clear All",reconciliationStatus:"Reconciliation Status",difference:"Difference",bookBalance:"Book Balance",statementBalance:"Statement Balance",outstandingChecks:"Outstanding Checks",depositsInTransit:"Deposits in Transit",reconciled:"Reconciled",notReconciled:"Not Reconciled",unreconciled:"Unreconciled",reconciliation:"Reconciliation",compareStatements:"Compare bank statements with entry book records",importCSV:"Import CSV",startNewReconciliation:"Start New Reconciliation",bankAccountInfo:"Bank Account Info",currentAccountDetails:"Current account details",lastReconciled:"Last reconciled",bankTransactions:"Bank Transactions",selectedPeriod:"Selected period",pending:"pending",bookEntriesForComparison:"Book entries for comparison",reconciliationRate:"Reconciliation Rate",completionStatus:"Completion status",recentReconciliationSessions:"Recent Reconciliation Sessions",latestActivity:"Latest activity",noRecentSessions:"No recent reconciliation sessions found.",startFirstReconciliation:"Start First Reconciliation",entryBookRecords:"Entry Book Records",pleaseUploadCSV:"Please upload a CSV file",csvRequiresHeaderAndData:"CSV file must have at least a header and one data row",successfullyParsed:"Successfully parsed {count} rows",errorParsingCSV:"Error parsing CSV file. Please check the format.",dateDescriptionRequired:"Date and Description columns are required",importedTransaction:"Imported transaction",successfullyImported:"Successfully imported {count} bank transactions",errorImportingTransactions:"Error importing transactions. Please check your data.",importBankStatementCSV:"Import Bank Statement CSV",dropCSVHere:"Drop CSV file here",clickToUploadCSV:"Click to upload or drag and drop CSV file",supportedFormat:"Supported format: CSV with Date, Description, and Amount columns",mapCSVColumns:"Map CSV Columns",dateColumn:"Date Column",selectColumn:"Select column...",descriptionColumn:"Description Column",referenceColumn:"Reference Column",amountDebitColumn:"Amount/Debit Column",creditColumn:"Credit Column",balanceColumn:"Balance Column",andMoreRows:"... and {count} more rows",importing:"Importing...",importTransactions:"Import {count} Transactions",reconciliationComparison:"Reconciliation Comparison",bankStatements:"Bank Statements",totalTransactions:"Total transactions",totalEntries:"Total entries",unreconciledBank:"Unreconciled Bank",unreconciledBooks:"Unreconciled Books",needAttention:"Need attention",unreconcile:"Unreconcile",clickToReconcile:"Click to reconcile",potentialMatchesFound:"Potential Matches Found",clickRecordToReconcile:"Click on a record below to reconcile",exactMatch:"Exact Match",possibleMatch:"Possible Match",selected:"Selected",clearSelection:"Clear Selection"},journal:{title:"Journal Entries",entryNumber:"Entry Number",entryDate:"Entry Date",debit:"Debit",credit:"Credit",account:"Account",memo:"Memo",reference:"Reference",createEntry:"Create Entry",editEntry:"Edit Entry",deleteEntry:"Delete Entry",posted:"Posted",draft:"Draft",reversed:"Reversed",recurringEntry:"Recurring Entry",attachments:"Attachments",totalDebits:"Total Debits",totalCredits:"Total Credits",outOfBalance:"Out of Balance",balanced:"Balanced",addEntry:"Add Journal Entry",allEntries:"All Entries",totalDebit:"Total Debit",totalCredit:"Total Credit",debitShort:"Dr.",creditShort:"Cr.",noReference:"No reference",createdBy:"By",totalAmount:"Total Amount",lines:"Lines",entryNotBalancedShort:"Entry is not balanced",accountLines:"Account Lines",noDescription:"No description",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryLines:"Journal Entry Lines",addLine:"Add Line",lineDescription:"Line description",notBalanced:"Not Balanced",updateEntry:"Update Entry",saveAsDraft:"Save as Draft",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",editEntryTooltip:"Edit this journal entry",post:"Post",entryMustBeBalanced:"Entry must be balanced to post",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",journalLines:"Journal Lines",balanceStatus:"Balance Status",unbalanced:"Unbalanced",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",postEntry:"Post Entry",fixBalance:"Fix Balance",voidEntry:"Void Entry",draftEntry:"Draft Entry",draftEntryDescription:"This entry can be edited and posted.",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",postedEntry:"Posted Entry",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",minTwoLinesRequired:"At least 2 line items are required",entryNotBalanced:"Entry is not balanced. Debit: ${debit}, Credit: ${credit}",lineAccountRequired:"Line {lineNumber}: Account is required",lineAmountRequired:"Line {lineNumber}: Either debit or credit amount must be provided",lineBothAmounts:"Line {lineNumber}: Cannot have both debit and credit amounts",enterEntryDescription:"Enter journal entry description",enterReferenceNumber:"Enter reference number"},invoices:{title:"Invoice Dashboard",invoice:"Invoice",invoices:"Invoices",invoiceNumber:"Invoice Number",invoiceDetails:"Invoice Details",customerInformation:"Customer Information",customerName:"Customer Name",legalName:"Legal Name",contactInformation:"Contact Information",idPassport:"ID/Passport",phoneNumber:"Phone Number",altPhone:"Alt Phone",address:"Address",between:"Between",and:"and",products:"Products",reservations:"Reservations",services:"Services",unitPrice:"Unit Price",total:"Total",subtotal:"Subtotal",totalRevenue:"Total Revenue",totalProducts:"Total Products",totalReservations:"Total Reservations",aranceles:"Aranceles (Customs)",uniqueCustomers:"Unique Customers",averageInvoice:"Average Invoice",completed:"Completed",pending:"Pending",storesActive:"Stores Active",topProducts:"Top Products",mostSoldProducts:"Most sold products by quantity",reservationsByType:"Reservations by Type",distributionOfCategories:"Distribution of reservation categories",recentInvoices:"Recent Invoices",showingInvoices:"Showing {{count}} invoices",date:"Date",customer:"Customer",store:"Store",actions:"Actions",view:"View",status:"Status",printInvoice:"Print Invoice",exportPdf:"Export PDF",backToDashboard:"Back to Dashboard",fromInvoices:"From {{count}} invoices",value:"value",activeCustomers:"Active customers",perInvoiceValue:"Per invoice value",locations:"Locations",mostRecentActivity:"Most recent activity",storeLocation:"Store Location",allStores:"All Stores",fromDate:"From Date",toDate:"To Date",clearFilters:"Clear Filters",search:"Search",searchPlaceholder:"Search by invoice #, customer, store...",customsFees:"Total customs fees",salesType:"SALES",packagesOrder:"Packages Order",businessId:"Business ID",orderKey:"Order Key",reservationType:"Reservation Type",arancel:"Arancel",key:"Key",noInvoicesFound:"No invoices found",loadingInvoices:"Loading invoices...",errorLoadingInvoices:"Error loading invoices",refreshData:"Refresh Data",currentStockValue:"Current Stock Value",filterByStore:"Filter by store",filterByDate:"Filter by date range",totalCustomsFees:"Total customs fees",averageValue:"Average value",senderInformation:"Sender Information",receiptInformation:"Receipt Information",productsSubtotal:"Products Subtotal",reservationsSubtotal:"Reservations Subtotal",servicesSubtotal:"Services Subtotal",code:"Code",description:"Description",qty:"Qty",type:"Type",id:"ID",passport:"Passport",createNew:"Create New Invoice",totalOutstanding:"Total Outstanding",unpaidInvoices:"Unpaid invoices",thisMonth:"This Month",revenueCollected:"Revenue collected",overdue:"Overdue",pastDueInvoices:"Past due invoices",latestBillingActivity:"Latest billing activity",paid:"Paid"},forms:{requiredField:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",selectOption:"Please select an option",enterValue:"Please enter a value",confirmDelete:"Are you sure you want to delete this item?",unsavedChanges:"You have unsaved changes. Do you want to continue?",saveSuccess:"Saved successfully",saveError:"Error saving data",deleteSuccess:"Deleted successfully",deleteError:"Error deleting item",duplicateAccountNumber:"Account number already exists",descriptionRequired:"Description is required",errorOccurred:"An error occurred",errorPostingEntry:"An error occurred while posting the entry",referenceNumberRequired:"Reference number is required",locationRequired:"Location is required",fromLocationRequired:"From location is required for transfers",atLeastOneProduct:"At least one product is required",itemProductRequired:"Product is required for item {{index}}",itemQuantityRequired:"Quantity must be greater than 0 for item {{index}}"},modals:{addInventory:"Add Inventory Movement",bulkMovement:"Bulk Inventory Movement",addProduct:"Add New Product",addLocation:"Add New Location",inventoryDetail:"Inventory Item Details",quickAdd:"Quick Add",selectProduct:"Select Product",selectLocation:"Select Location",enterQuantity:"Enter quantity",enterCost:"Enter unit cost",enterReference:"Enter reference number",addNotes:"Add notes (optional)",generalInformation:"General Information",stockInformation:"Stock Information",locationInformation:"Location Information",movementInformation:"Movement Information",addToInventory:"Add to Inventory",createProduct:"Create Product",createLocation:"Create Location",processing:"Processing...",addingMovement:"Adding movement...",creatingProduct:"Creating product...",creatingLocation:"Creating location..."},products:{title:"Products",addNew:"Add New Product",totalProducts:"Total Products",inCatalog:"In catalog",activeProducts:"Active Products",currentlyAvailable:"Currently available",outOfStock:"Out of Stock",needsRestock:"Needs restock",productCatalog:"Product Catalog",manageYourProducts:"Manage your products and pricing",inStock:"In Stock",furniture:"Furniture",electronics:"Electronics",supplies:"Supplies",lighting:"Lighting",searchPlaceholder:"Search products by name, SKU, or category...",allCategories:"All Categories",clearFilters:"Clear filters",noResults:"No products found matching your criteria.",noProducts:"No products available.",showing:"Showing",filtered:"Filtered results",allProducts:"All products",searchResult:"Search Result",stock:"Stock",lowStock:"Low Stock"},unauthorized:{title:"Access Restricted",accessDenied:"Access Denied",noPermission:"You don't have permission to access",thisFeature:"this feature",whySeeing:"Why am I seeing this?",explanation:"Your account doesn't have the necessary permissions to view this content.",requiredPermission:"Required permission:",goToDashboard:"Go to Dashboard",goBack:"Go Back",featuresCanAccess:"Features you can access:",dashboardAccess:"Dashboard and overview statistics",profileAccess:"Your profile and settings",roleBasedAccess:"Features enabled for your role",needAccess:"Need access? Contact your administrator or manager to request the appropriate permissions.",permissions:{accountAccess:"Account Management Access",inventoryAccess:"Inventory Access",employeeAccess:"HR Access",bankingAccess:"Banking Access",journalAccess:"Journal Entry Access",adminAccess:"Administrative Access",financialReporting:"Financial Reporting Access",invoiceManagement:"Invoice Management Access",productManagement:"Product Management Access"}}},es:{common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",add:"Agregar",close:"Cerrar",search:"Buscar",filter:"Filtrar",reset:"Restablecer",back:"Atrás",next:"Siguiente",previous:"Anterior",yes:"Sí",no:"No",loading:"Cargando...",error:"Error",success:"Éxito",warning:"Advertencia",info:"Información",confirm:"Confirmar",actions:"Acciones",status:"Estado",active:"Activo",inactive:"Inactivo",date:"Fecha",time:"Hora",description:"Descripción",notes:"Notas",amount:"Monto",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Idioma",english:"Inglés",spanish:"Español",noDataFound:"No se encontraron datos",required:"Requerido",optional:"Opcional",all:"Todos",none:"Ninguno",select:"Seleccionar",clear:"Limpiar",view:"Ver",suggested:"Sugerido",clearFilters:"Limpiar Filtros",enhanced:"Mejorado",legacy:"Clásico",email:"Correo Electrónico",phone:"Teléfono",address:"Dirección",name:"Nombre",code:"Código",category:"Categoría",type:"Tipo",quantity:"Cantidad",price:"Precio",cost:"Costo",value:"Valor",balance:"Saldo",created:"Creado",modified:"Modificado",details:"Detalles",summary:"Resumen",history:"Historial",new:"Nuevo",addNew:"Agregar Nuevo",unknown:"Desconocido",notAvailable:"N/A",remove:"Remover",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",from:"De",invoice:"Factura",invoices:"facturas",reference:"Referencia",createdBy:"Creado Por",units:"unidades",invoiceDocumentId:"ID de Factura/Documento",referenceNumber:"Número de Referencia",referenceNumberPlaceholder:"Ingrese número de referencia...",generalNotes:"Notas Generales",auto:"Auto",optionalNotes:"Notas opcionales...",showPerPage:"Mostrar por página",first:"Primera",last:"Última",store:"Tienda",orderId:"ID de Orden",tax:"Impuesto",paymentMethods:"Métodos de Pago",cash:"Efectivo",creditCard:"Tarjeta de Crédito",shipping:"Envío",air:"Aéreo",sea:"Marítimo",thankYouBusiness:"¡Gracias por su negocio!",thankForChoosingUs:"¡Gracias por elejirnos!",taxExemptNote:"Impuesto exento en pago en efectivo.",youSaved:"Usted ahorró",generatedOn:"Generado el",printSavePDF:"Imprimir / Guardar como PDF",pageOfPages:"Página {{current}} de {{total}}",showingXofY:"Mostrando {{start}}-{{end}} de {{total}}",page:"Página",of:"de",lbs:"libras"},navigation:{dashboard:"Panel de Control",accounts:"Plan de Cuentas",balanceSheet:"Balance General",inventory:"Inventario",employees:"Empleados",entryBooks:"Libros de Entrada",consolidate:"Consolidación Bancaria",reports:"Reportes",settings:"Configuración"},dashboard:{title:"Panel de Control",welcome:"Bienvenido a HRM Finance",totalRevenue:"Ingresos Totales",overview:"Resumen",recentActivity:"Actividad Reciente",quickActions:"Acciones Rápidas",employeeCount:"Número de Empleados",pendingInvoices:"Facturas Pendientes",cashBalance:"Saldo en Efectivo",totalAssets:"Activos Totales",totalLiabilities:"Pasivos Totales",totalExpenses:"Gastos Totales",netIncome:"Ingreso Neto",netLoss:"Pérdida Neta",monthlyPayroll:"Nómina Mensual",current:"Actual",newHires:"+3 nuevas contrataciones",outstanding:"Pendiente",totalOutstanding:"$23,450 total",lastUpdatedToday:"Última actualización hoy",commonTasks:"Tareas comunes",generateReport:"Generar Reporte",latestUpdates:"Últimas actualizaciones",invoicePaid:"Factura #1234 pagada",hoursAgo:"hace 2 horas",newEmployeeOnboarded:"Nuevo empleado incorporado",dayAgo:"hace 1 día",monthlyReportGenerated:"Reporte mensual generado",daysAgo:"hace 2 días"},accounts:{title:"Plan de Cuentas",accountNumber:"Número de Cuenta",accountName:"Nombre de Cuenta",accountType:"Tipo de Cuenta",category:"Categoría",balance:"Saldo",parentAccount:"Cuenta Padre",subAccounts:"Subcuentas",addAccount:"Agregar Cuenta",editAccount:"Editar Cuenta",deleteAccount:"Eliminar Cuenta",accountDetails:"Detalles de Cuenta",transactions:"Transacciones",accountHistory:"Historial de Cuenta",backToAccounts:"Volver a Cuentas",accountNotFound:"Cuenta no encontrada",accountInformation:"Información de Cuenta",accountPurpose:"Propósito de la cuenta",transactionHistory:"Historial de Transacciones",noTransactions:"No se encontraron transacciones para esta cuenta",createdDate:"Fecha de Creación",lastModified:"Última Modificación",noDescription:"No se proporcionó descripción.",totalCount:"Conteo total",basicDetails:"Detalles básicos",currentBalance:"Saldo actual",classification:"Clasificación",allTransactions:"Todas las transacciones de la cuenta",reference:"Referencia",types:{asset:"Activo",liability:"Pasivo",equity:"Patrimonio",revenue:"Ingreso",expense:"Gasto"},categories:{currentAssets:"Activos Corrientes",fixedAssets:"Activos Fijos",currentLiabilities:"Pasivos Corrientes",longTermLiabilities:"Pasivos a Largo Plazo",ownersEquity:"Patrimonio del Propietario",operatingRevenue:"Ingresos Operacionales",operatingExpenses:"Gastos Operacionales"}},inventory:{title:"Gestión de Inventario",overview:"Resumen",products:"Productos y Stock",movements:"Movimientos",locations:"Ubicaciones",bulkMovement:"Movimiento Masivo",addMovement:"Agregar Movimiento",addProduct:"Agregar Producto",addLocation:"Agregar Ubicación",singleMovement:"Agregar Movimiento Individual",addNewItem:"Agregar Nuevo Artículo",activeProducts:"Productos Activos",lowStockAlert:"Artículos con Stock Bajo",totalValue:"Valor Total del Stock",activeLocations:"Ubicaciones Activas",productsNeedRestocking:"productos necesitan reabastecimiento",recentMovements:"Movimientos Recientes",noProducts:"No hay productos en esta ubicación",productName:"Nombre del Producto",productCode:"Código del Producto",sku:"SKU",category:"Categoria",unitOfMeasure:"Unidad de Medida",unitCost:"Costo Unitario",minStockLevel:"Nivel Mínimo de Stock",maxStockLevel:"Nivel Máximo de Stock",locationName:"Nombre de Ubicación",locationType:"Tipo de Ubicación",locationCode:"Código de Ubicación",movementType:"Tipo de Movimiento",referenceNumber:"Número de Referencia",invoiceNumber:"Número de Factura",fromLocation:"Desde Ubicación",toLocation:"Hacia Ubicación",stockIn:"Entrada de Stock",stockOut:"Salida de Stock",transfer:"Transferencia",adjustment:"Ajuste",inStock:"En Stock",lowStock:"Stock Bajo",outOfStock:"Sin Stock",stockLevels:"Niveles de Stock",stockByLocation:"Stock por Ubicación",searchProducts:"Buscar productos...",searchLocations:"Buscar ubicaciones...",noMovements:"No se encontraron movimientos",productDetails:"Detalles del Producto",locationDetails:"Detalles de Ubicación",movementDetails:"Detalles del Movimiento",totalProducts:"Total de Productos",totalLocations:"Total de Ubicaciones",lastSeen:"Visto por última vez",warehouseType:"Almacén",storeType:"Tienda",supplierType:"Proveedor",customerType:"Cliente",currentlyManaged:"Gestionados actualmente",needAttention:"Necesitan atención",currentWorth:"Valor actual",warehousesStores:"Almacenes y tiendas",thisMonth:"Este Mes",latestActivities:"Últimas actividades de inventario",searchMovements:"Buscar Movimientos",countingSheet:"Hoja de Conteo",physicalCount:"Conteo Físico",physicalInventoryCount:"Conteo Físico de Inventario",setupPhysicalCount:"Configurar Conteo Físico de Inventario",setupDescription:"Configure los ajustes de su conteo físico de inventario y comience el proceso de conteo.",countWillInclude:"Este conteo incluirá {{count}} productos de {{location}} en la categoría {{category}}.",startCounting:"Iniciar Conteo Físico",counted:"Contado",remaining:"Restante",variances:"Variaciones",complete:"Completo",systemQty:"Cant. Sistema",variance:"Variación",addNotes:"Agregar notas...",reviewAndConfirm:"Revisar y Confirmar Ajustes",reviewDescription:"Revise los ajustes de inventario a continuación y confirme para actualizar su sistema.",stockIncreases:"Aumentos de Stock",stockDecreases:"Disminuciones de Stock",totalAdjustments:"Ajustes Totales",confirmAdjustments:"Confirmar Ajustes",perfectCount:"¡Conteo Perfecto!",noVariances:"No se encontraron variaciones. Su conteo físico coincide exactamente con el sistema.",physicalCountAdjustment:"Ajuste de conteo físico",inventoryCountingSheetTitle:"HOJA DE CONTEO DE INVENTARIO",location:"Ubicación",allCategories:"Todas las Categorías",countedBy:"Contado por",verifiedBy:"Verificado por",instructions:"Instrucciones",countInstructions:["Contar todos los artículos físicamente presentes en esta ubicación",'Escribir el conteo real en la columna "Conteo Físico"',"Dejar en blanco si el artículo no se encuentra",'Anotar cualquier discrepancia en la columna "Notas"',"Firmar y fechar cuando esté completo"],unit:"Unidad",totalProductsListed:"Total de Productos Listados",itemsCounted:"Artículos Contados",summaryFor:"RESUMEN PARA",discrepanciesFound:"Discrepancias Encontradas",counterSignature:"Firma del Contador",supervisorSignature:"Firma del Supervisor",downloadCSV:"Descargar CSV",noAdjustmentsToDownload:"No hay ajustes para descargar",stockIncrease:"Aumento de Stock",stockDecrease:"Disminución de Stock",purchaseReceive:"Compra/Recepción",saleIssue:"Venta/Emisión",generalNotesPlaceholder:"Ingrese notas generales para este movimiento...",sortBy:"Ordenar Por",allLocations:"Todas las Ubicaciones",searchByProduct:"Buscar por producto, ubicación, referencia, notas, factura...",allProducts:"Todos los Productos",bulkMovementReport:"Reporte de Movimiento en Lote",totalQuantity:"Cantidad Total",estimatedValue:"Valor Estimado",viewHistoricalReports:"Ver Reportes Históricos",noBulkReportsFound:"No se encontraron reportes de movimientos en lote",bulkReportsAppearHere:"Los reportes de movimientos en lote aparecerán aquí después de crear movimientos en lote",allTypes:"Todos los Tipos",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",totalMovements:"Movimientos Totales",adjustMovements:"Intenta ajustar tus filtros o revisa más tarde.",inventoryMovements:"Movimientos de Inventario",createdBy:"Creado Por",view:"Ver",enhanced:"Mejorado",legacy:"Clásico",addSingleMovement:"Agregar Movimiento Individual",inStockSubtitle:"En stock",itemsBelowThreshold:"Artículos bajo el umbral",inventoryWorth:"Valor del inventario",quantity:"Cantidad",units:"unidades",normal:"Normal",productsAndStock:"Productos y Stock",lowStockItems:"Artículos con Stock Bajo",totalStockValue:"Valor Total del Stock",warehousesAndStores:"Almacenes y tiendas",andMore:"...y {count} más",latestInventoryActivities:"Últimas actividades de inventario",min:"Mín",max:"Máx",cost:"Costo",noProductsFound:"No se encontraron productos que coincidan con su búsqueda.",noProductsAvailable:"No hay productos disponibles.",noLocationsFound:"No se encontraron ubicaciones que coincidan con su búsqueda.",noLocationsAvailable:"No hay ubicaciones disponibles.",searchPlaceholder:"Buscar por producto, ubicación, referencia, notas, factura...",noMovementsFound:"No se encontraron movimientos",tryAdjustingFilters:"Intenta ajustar tus filtros o revisa más tarde.",transfers:"Transferencias",adjustments:"Ajustes",bulk:"Masivo",product:"Producto",store:"Tienda",supplier:"Proveedor",warehouse:"Almacén",movement:"Movimiento",editMovement:"Editar Movimiento",updateMovement:"Actualizar Movimiento",movementInformation:"Información del Movimiento",locationInformation:"Información de Ubicación",searchProductsImages:"Buscar productos para ver imágenes...",searchForProducts:"Buscar Productos",startTypingToSearch:"Comienza a escribir para buscar y ver imágenes de productos",tryDifferentSearch:"Prueba con un término de búsqueda diferente"},employees:{title:"Gestión de Empleados",employeeList:"Lista de Empleados",addEmployee:"Agregar Empleado",editEmployee:"Editar Empleado",employeeDetails:"Detalles del Empleado",personalInfo:"Información Personal",employmentInfo:"Información Laboral",payrollInfo:"Información de Nómina",firstName:"Nombre",lastName:"Apellido",fullName:"Nombre Completo",email:"Correo Electrónico",phone:"Teléfono",address:"Dirección",dateOfBirth:"Fecha de Nacimiento",employeeId:"ID de Empleado",department:"Departamento",position:"Puesto",hireDate:"Fecha de Contratación",employmentStatus:"Estado Laboral",salary:"Salario",payFrequency:"Frecuencia de Pago",taxId:"ID Fiscal",bankAccount:"Cuenta Bancaria",emergencyContact:"Contacto de Emergencia",activeEmployees:"Empleados Activos",inactiveEmployees:"Empleados Inactivos",totalPayroll:"Nómina Total",searchEmployees:"Buscar empleados...",enterFullName:"Ingrese el nombre completo del empleado",enterPosition:"Ingrese el puesto de trabajo",enterEmail:"Ingrese la dirección de correo electrónico",enterPhone:"Ingrese el número de teléfono",enterSalary:"Ingrese el salario anual",departments:{engineering:"Ingeniería",product:"Producto",design:"Diseño",marketing:"Marketing",sales:"Ventas",humanResources:"Recursos Humanos",finance:"Finanzas",operations:"Operaciones",analytics:"Analítica"}},entryBooks:{title:"Libros de Entrada",bookName:"Nombre del Libro",bookType:"Tipo de Libro",createBook:"Crear Libro",editBook:"Editar Libro",salesBook:"Libro de Ventas",purchaseBook:"Libro de Compras",cashBook:"Libro de Caja",generalBook:"Libro General",entries:"Entradas",addEntry:"Agregar Entrada",period:"Período",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",bookBalance:"Saldo del Libro",reconciledBalance:"Saldo Conciliado",difference:"Diferencia",reconcile:"Conciliar",isReconciled:"Está Conciliado",noBooks:"No se encontraron libros de entrada",createFirst:"Crea tu primer libro de entrada para comenzar",bookDetails:"Detalles del Libro",entriesCount:"entradas",bookOverview:"Resumen y detalles del libro",bookEntries:"Entradas del Libro",allEntries:"Todas las entradas en este libro",noEntries:"No se encontraron entradas",addFirst:"Agrega tu primera entrada a este libro",entryDate:"Fecha de Entrada",entryDescription:"Descripción de Entrada",entryAmount:"Monto de Entrada",entryReference:"Referencia de Entrada"},banking:{title:"Consolidación Bancaria",bankAccount:"Cuenta Bancaria",statementDate:"Fecha del Estado",beginningBalance:"Saldo Inicial",endingBalance:"Saldo Final",deposits:"Depósitos",withdrawals:"Retiros",bankCharges:"Cargos Bancarios",interest:"Intereses",reconcile:"Conciliar",matched:"Conciliado",unmatched:"No Conciliado",importStatement:"Importar Estado",manualEntry:"Entrada Manual",autoMatch:"Coincidencia Automática",clearAll:"Limpiar Todo",reconciliationStatus:"Estado de Conciliación",difference:"Diferencia",bookBalance:"Saldo en Libros",statementBalance:"Saldo del Estado",outstandingChecks:"Cheques Pendientes",depositsInTransit:"Depósitos en Tránsito",reconciled:"Conciliado",notReconciled:"No Conciliado",unreconciled:"No Conciliado",reconciliation:"Conciliación",compareStatements:"Comparar estados bancarios con registros de libros de entrada",importCSV:"Importar CSV",startNewReconciliation:"Iniciar Nueva Conciliación",bankAccountInfo:"Información de Cuenta Bancaria",currentAccountDetails:"Detalles de cuenta actual",lastReconciled:"Última conciliación",bankTransactions:"Transacciones Bancarias",selectedPeriod:"Período seleccionado",pending:"pendiente",bookEntriesForComparison:"Entradas de libros para comparación",reconciliationRate:"Tasa de Conciliación",completionStatus:"Estado de finalización",recentReconciliationSessions:"Sesiones de Conciliación Recientes",latestActivity:"Actividad reciente",noRecentSessions:"No se encontraron sesiones de conciliación recientes.",startFirstReconciliation:"Iniciar Primera Conciliación",entryBookRecords:"Registros de Libros de Entrada",pleaseUploadCSV:"Por favor suba un archivo CSV",csvRequiresHeaderAndData:"El archivo CSV debe tener al menos un encabezado y una fila de datos",successfullyParsed:"Se analizaron exitosamente {count} filas",errorParsingCSV:"Error al analizar el archivo CSV. Verifique el formato.",dateDescriptionRequired:"Las columnas de Fecha y Descripción son requeridas",importedTransaction:"Transacción importada",successfullyImported:"Se importaron exitosamente {count} transacciones bancarias",errorImportingTransactions:"Error al importar transacciones. Verifique sus datos.",importBankStatementCSV:"Importar CSV de Estado Bancario",dropCSVHere:"Suelte el archivo CSV aquí",clickToUploadCSV:"Haga clic para cargar o arrastre y suelte el archivo CSV",supportedFormat:"Formato soportado: CSV con columnas de Fecha, Descripción y Monto",mapCSVColumns:"Mapear Columnas CSV",dateColumn:"Columna de Fecha",selectColumn:"Seleccionar columna...",descriptionColumn:"Columna de Descripción",referenceColumn:"Columna de Referencia",amountDebitColumn:"Columna de Monto/Débito",creditColumn:"Columna de Crédito",balanceColumn:"Columna de Saldo",andMoreRows:"... y {count} filas más",importing:"Importando...",importTransactions:"Importar {count} Transacciones",reconciliationComparison:"Comparación de Conciliación",bankStatements:"Estados Bancarios",totalTransactions:"Transacciones totales",totalEntries:"Entradas totales",unreconciledBank:"Banco No Conciliado",unreconciledBooks:"Libros No Conciliados",needAttention:"Necesitan atención",unreconcile:"Desconciliar",clickToReconcile:"Hacer clic para conciliar",potentialMatchesFound:"Coincidencias Potenciales Encontradas",clickRecordToReconcile:"Haga clic en un registro a continuación para conciliar",exactMatch:"Coincidencia Exacta",possibleMatch:"Posible Coincidencia",selected:"Seleccionado",clearSelection:"Limpiar Selección"},journal:{title:"Asientos Contables",entryNumber:"Número de Asiento",entryDate:"Fecha del Asiento",debit:"Débito",credit:"Crédito",account:"Cuenta",memo:"Memo",reference:"Referencia",createEntry:"Crear Asiento",editEntry:"Editar Asiento",deleteEntry:"Eliminar Asiento",posted:"Registrado",draft:"Borrador",reversed:"Revertido",recurringEntry:"Asiento Recurrente",attachments:"Adjuntos",totalDebits:"Débitos Totales",totalCredits:"Créditos Totales",outOfBalance:"Desbalanceado",balanced:"Balanceado"},forms:{requiredField:"Este campo es requerido",invalidEmail:"Dirección de correo inválida",invalidNumber:"Número inválido",invalidDate:"Fecha inválida",selectOption:"Por favor seleccione una opción",enterValue:"Por favor ingrese un valor",confirmDelete:"¿Está seguro de que desea eliminar este elemento?",unsavedChanges:"Tiene cambios sin guardar. ¿Desea continuar?",saveSuccess:"Guardado exitosamente",saveError:"Error al guardar datos",deleteSuccess:"Eliminado exitosamente",deleteError:"Error al eliminar elemento",duplicateAccountNumber:"El número de cuenta ya existe",referenceNumberRequired:"El número de referencia es requerido",locationRequired:"La ubicación es requerida",fromLocationRequired:"La ubicación de origen es requerida para transferencias",atLeastOneProduct:"Al menos un producto es requerido",itemProductRequired:"El producto es requerido para el artículo {{index}}",itemQuantityRequired:"La cantidad debe ser mayor que 0 para el artículo {{index}}"},modals:{addInventory:"Agregar Movimiento de Inventario",bulkMovement:"Movimiento Masivo de Inventario",addProduct:"Agregar Nuevo Producto",addLocation:"Agregar Nueva Ubicación",inventoryDetail:"Detalles del Artículo de Inventario",quickAdd:"Agregar Rápido",selectProduct:"Seleccionar Producto",selectLocation:"Seleccionar Ubicación",enterQuantity:"Ingresar cantidad",enterCost:"Ingresar costo unitario",enterReference:"Ingresar número de referencia",addNotes:"Agregar notas (opcional)",generalInformation:"Información General",stockInformation:"Información de Stock",locationInformation:"Información de Ubicación",movementInformation:"Información de Movimiento",addToInventory:"Agregar al Inventario",createProduct:"Crear Producto",createLocation:"Crear Ubicación",processing:"Procesando...",addingMovement:"Agregando movimiento...",creatingProduct:"Creando producto...",creatingLocation:"Creando ubicación..."},products:{title:"Productos",addNew:"Agregar Nuevo Producto",totalProducts:"Total de Productos",inCatalog:"En catálogo",activeProducts:"Productos Activos",currentlyAvailable:"Actualmente disponibles",outOfStock:"Sin Stock",needsRestock:"Necesita reabastecimiento",productCatalog:"Catálogo de Productos",manageYourProducts:"Gestiona tus productos y precios",inStock:"En Stock",furniture:"Muebles",electronics:"Electrónicos",supplies:"Suministros",lighting:"Iluminación"},invoices:{title:"Panel de Facturas",invoice:"Factura",invoices:"Facturas",invoiceNumber:"Número de Factura",invoiceDetails:"Detalles de Factura",customerInformation:"Información del Cliente",customerName:"Nombre del Cliente",legalName:"Nombre Legal",contactInformation:"Información de Contacto",idPassport:"ID/Pasaporte",phoneNumber:"Número de Teléfono",altPhone:"Teléfono Alt.",address:"Dirección",between:"Entre",and:"y",products:"Productos",reservations:"Reservaciones",services:"Servicios",unitPrice:"Precio Unitario",total:"Total",subtotal:"Subtotal",category:"Categoria",totalRevenue:"Ingresos Totales",totalProducts:"Total de Productos",totalReservations:"Total de Reservaciones",aranceles:"Aranceles (Aduanas)",uniqueCustomers:"Clientes Únicos",averageInvoice:"Factura Promedio",completed:"Completada",pending:"Pendiente",storesActive:"Tiendas Activas",topProducts:"Productos Principales",mostSoldProducts:"Productos más vendidos por cantidad",reservationsByType:"Reservaciones por Tipo",distributionOfCategories:"Distribución de categorías de reservaciones",recentInvoices:"Facturas Recientes",showingInvoices:"Mostrando {{count}} facturas",date:"Fecha",customer:"Cliente",store:"Tienda",actions:"Acciones",view:"Ver",status:"Estado",printInvoice:"Imprimir Factura",exportPdf:"Exportar PDF",backToDashboard:"Volver al Panel",fromInvoices:"De {{count}} facturas",value:"valor",activeCustomers:"Clientes activos",perInvoiceValue:"Valor por factura",locations:"Ubicaciones",mostRecentActivity:"Actividad más reciente",storeLocation:"Ubicación de Tienda",allStores:"Todas las Tiendas",fromDate:"Fecha Desde",toDate:"Fecha Hasta",clearFilters:"Limpiar Filtros",search:"Buscar",searchPlaceholder:"Buscar por # factura, cliente, tienda...",customsFees:"Aranceles totales",salesType:"VENTAS",packagesOrder:"Orden de Paquetes",businessId:"ID de Negocio",orderKey:"Clave de Orden",reservationType:"Tipo de Reservación",arancel:"Arancel",key:"Clave",noInvoicesFound:"No se encontraron facturas",loadingInvoices:"Cargando facturas...",errorLoadingInvoices:"Error al cargar facturas",refreshData:"Actualizar Datos",currentStockValue:"Valor de Stock Actual",filterByStore:"Filtrar por tienda",filterByDate:"Filtrar por rango de fechas",totalCustomsFees:"Aranceles totales",averageValue:"Valor promedio",senderInformation:"Información del Remitente",receiptInformation:"Información del Destinatario",productsSubtotal:"Subtotal de Productos",reservationsSubtotal:"Subtotal de Reservaciones",servicesSubtotal:"Subtotal de Servicios",code:"Código",description:"Descripción",qty:"Cant.",type:"Tipo",id:"ID",passport:"Pasaporte"},unauthorized:{title:"Acceso Restringido",accessDenied:"Acceso Denegado",noPermission:"No tienes permisos para acceder a",thisFeature:"esta funcionalidad",whySeeing:"¿Por qué veo esto?",explanation:"Tu cuenta no tiene los permisos necesarios para ver este contenido.",requiredPermission:"Permiso requerido:",goToDashboard:"Ir al Panel de Control",goBack:"Regresar",featuresCanAccess:"Funcionalidades a las que puedes acceder:",dashboardAccess:"Panel de control y estadísticas generales",profileAccess:"Tu perfil y configuraciones",roleBasedAccess:"Funcionalidades habilitadas para tu rol",needAccess:"¿Necesitas acceso? Contacta a tu administrador o gerente para solicitar los permisos apropiados.",permissions:{accountAccess:"Acceso a Gestión de Cuentas",inventoryAccess:"Acceso a Inventario",employeeAccess:"Acceso a Recursos Humanos",bankingAccess:"Acceso Bancario",journalAccess:"Acceso a Asientos Contables",adminAccess:"Acceso Administrativo",financialReporting:"Acceso a Reportes Financieros",invoiceManagement:"Acceso a Gestión de Facturas",productManagement:"Acceso a Gestión de Productos"}}}},nI=()=>{if(typeof window<"u"){const t=localStorage.getItem("hrmfinance-language");if(t&&["en","es"].includes(t))return t}return"en"},[Tm,iI]=Se(nI()),or=()=>({t:(n,i,o)=>{const s=Tm(),l=n.split(".");let c=rI[s];for(const u of l)if(c&&typeof c=="object"&&u in c)c=c[u];else return i||n;let d=typeof c=="string"?c:i||n;return o&&typeof d=="string"&&Object.keys(o).forEach(u=>{const h=o[u],g=`{{${u}}}`;d=d.replace(new RegExp(g,"g"),String(h))}),d},language:()=>Tm(),setLanguage:n=>{iI(n),typeof window<"u"&&localStorage.setItem("hrmfinance-language",n)},currentLanguage:Tm});var oI=le("<div><label></label><select><option value>"),sI=le("<span>*"),aI=le("<option>");const en=t=>{const{t:e}=or(),r={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},n={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},i={"margin-bottom":"1rem"};return(()=>{var o=oI(),s=o.firstChild,l=s.nextSibling,c=l.firstChild;return p(o,i),p(s,r),a(s,()=>t.label,null),a(s,(()=>{var d=ke(()=>!!t.required);return()=>d()&&(()=>{var u=sI();return u.style.setProperty("color","var(--primary-color)"),u})()})(),null),l.addEventListener("blur",d=>d.target.style.borderColor="var(--border-color)"),l.addEventListener("focus",d=>d.target.style.borderColor="var(--primary-color)"),l.addEventListener("change",d=>t.onChange(d.target.value)),p(l,n),a(c,()=>e("forms.selectOption")),a(l,()=>t.options.map(d=>(()=>{var u=aI();return a(u,()=>d.label),ge(()=>u.value=d.value),u})()),null),ge(d=>{var u=t.required,h=t.disabled;return u!==d.e&&(l.required=d.e=u),h!==d.t&&(l.disabled=d.t=h),d},{e:void 0,t:void 0}),ge(()=>l.value=t.value),o})()};var lI=le("<main><div>"),cI=le("<header><h1>");const oo=t=>{const e={"min-height":"100vh",background:"var(--background-color)"},r={"max-width":"1200px",margin:"0 auto",padding:"2rem"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},i={"font-size":"2rem","font-weight":"700",color:"var(--text-primary)",margin:"0"};return(()=>{var o=lI(),s=o.firstChild;return p(o,e),p(s,r),a(s,(()=>{var l=ke(()=>!!t.title);return()=>l()&&(()=>{var c=cI(),d=c.firstChild;return p(c,n),p(d,i),a(d,()=>t.title),c})()})(),null),a(s,()=>t.children,null),o})()};var dI=le("<div><span></span><select><option value=en>🇺🇸 </option><option value=es>🇪🇸 ");const uI=()=>{const{t,language:e,setLanguage:r}=or(),n={display:"flex","align-items":"center",gap:"0.5rem","margin-left":"auto"},i={padding:"0.5rem 1rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",background:"var(--surface-color)",color:"var(--text-primary)",cursor:"pointer","font-size":"0.875rem","font-weight":"500",transition:"all 0.2s ease","min-width":"120px"},o={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},s=l=>{const c=l.target;r(c.value)};return(()=>{var l=dI(),c=l.firstChild,d=c.nextSibling,u=d.firstChild;u.firstChild;var h=u.nextSibling;return h.firstChild,p(l,n),p(c,o),d.addEventListener("change",s),p(d,i),a(u,()=>t("common.english"),null),a(h,()=>t("common.spanish"),null),ge(()=>d.value=e()),l})()},hI={finance:{name:"finance",category:"finance",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L15 1H5C3.89 1 3 1.89 3 3V21C3 22.1 3.9 23 5 23H19C20.1 23 21 22.1 21 21V9M19 21H5V3H13V9H19Z"/></svg>'},accounts:{name:"accounts",category:"finance",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M3 3V21H21V19H5V3H3M9 17H7V10H9V17M13 17H11V7H13V17M17 17H15V13H17V17Z"/></svg>'},books:{name:"books",category:"finance",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 2L14 6.5V17.5L19 13V2M6.5 5C4.55 5 2.45 5.4 1 6.5V21.16C1 21.41 1.25 21.66 1.5 21.66C1.6 21.66 1.65 21.59 1.75 21.59C3.1 20.94 5.05 20.5 6.5 20.5C8.45 20.5 10.55 20.9 12 22C13.35 21.15 15.8 20.5 17.5 20.5C19.15 20.5 20.85 20.81 22.25 21.56C22.35 21.61 22.4 21.59 22.5 21.59C22.75 21.59 23 21.34 23 21.09V6.5C22.4 6.05 21.75 5.75 21 5.5V19C19.9 18.65 18.7 18.5 17.5 18.5C15.8 18.5 13.35 19.15 12 20V6.5C10.55 5.4 8.45 5 6.5 5Z"/></svg>'},"balance-sheet":{name:"balance-sheet",category:"finance",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 14H9V8H7V14M11 14H13V8H11V14M15 14H17V8H15V14M5 21H19V19H5V21M5 7H19V5H5V7Z"/></svg>'},bank:{name:"bank",category:"finance",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M11.5 1L2 6V8H22V6M16 10V17H20V10M4 10V17H8V10M10 10V17H14V10M2 19H22V21H2Z"/></svg>'},"automation-target":{name:"automation-target",category:"finance",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C17.5 2 22 6.5 22 12S17.5 22 12 22 2 17.5 2 12 6.5 2 12 2M12 4C7.58 4 4 7.58 4 12S7.58 20 12 20 20 16.42 20 12 16.42 4 12 4M12 6C15.31 6 18 8.69 18 12S15.31 18 12 18 6 15.31 6 12 8.69 6 12 6M12 8C9.79 8 8 9.79 8 12S9.79 16 12 16 16 14.21 16 12 14.21 8 12 8M12 10C13.1 10 14 10.9 14 12S13.1 14 12 14 10 13.1 10 12 10.9 10 12 10Z"/></svg>'},"automation-bolt":{name:"automation-bolt",category:"finance",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 2V13H10V22L17 10H13L17 2H7Z"/></svg>'},operations:{name:"operations",category:"operations",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L2 7L12 12L22 7L12 2M2 17L12 22L22 17M2 12L12 17L22 12"/></svg>'},inventory:{name:"inventory",category:"operations",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L2 7L12 12L22 7L12 2M2 17L12 22L22 17M2 12L12 17L22 12"/></svg>'},invoice:{name:"invoice",category:"operations",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3M19 19H5V5H19V19M17 17H7V15H17V17M17 13H7V11H17V13M17 9H7V7H17V9Z"/></svg>'},shipping:{name:"shipping",category:"operations",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M3 4H16.5L21 8.5V17H18.5C18.5 18.38 17.38 19.5 16 19.5S13.5 18.38 13.5 17H8.5C8.5 18.38 7.38 19.5 6 19.5S3.5 18.38 3.5 17H1V6C1 4.89 1.89 4 3 4M16 18C16.55 18 17 17.55 17 17S16.55 16 16 16 15 16.45 15 17 15.45 18 16 18M6 18C6.55 18 7 17.55 7 17S6.55 16 6 16 5 16.45 5 17 5.45 18 6 18M15 8.5H19.5L16.5 5.5H15V8.5Z"/></svg>'},passport:{name:"passport",category:"operations",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M14 2H6C4.89 2 4 2.89 4 4V20C4 21.11 4.89 22 6 22H18C19.11 22 20 21.11 20 20V8L14 2M18 20H6V4H13V9H18V20M16 11H8V13H16V11M16 15H8V17H16V15M12 6.5C13.38 6.5 14.5 7.62 14.5 9S13.38 11.5 12 11.5 9.5 10.38 9.5 9 10.62 6.5 12 6.5Z"/></svg>'},management:{name:"management",category:"management",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M16 4C18.2 4 20 5.8 20 8S18.2 12 16 12C13.8 12 12 10.2 12 8S13.8 4 16 4M16 13C18.67 13 22 14.33 22 17V20H10V17C10 14.33 13.33 13 16 13M8 12C10.21 12 12 10.21 12 8S10.21 4 8 4 4 5.79 4 8 5.79 12 8 12M8 13C5.33 13 0 14.33 0 17V20H8V17.5C8 15.5 8.5 13.7 9.5 13.2C9 13.1 8.5 13 8 13Z"/></svg>'},employees:{name:"employees",category:"management",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M16 4C18.2 4 20 5.8 20 8S18.2 12 16 12C13.8 12 12 10.2 12 8S13.8 4 16 4M16 13C18.67 13 22 14.33 22 17V20H10V17C10 14.33 13.33 13 16 13M8 12C10.21 12 12 10.21 12 8S10.21 4 8 4 4 5.79 4 8 5.79 12 8 12M8 13C5.33 13 0 14.33 0 17V20H8V17.5C8 15.5 8.5 13.7 9.5 13.2C9 13.1 8.5 13 8 13Z"/></svg>'},admin:{name:"admin",category:"management",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M5 16L3 14L5 12L10 17L21 6L23 8L10 21L5 16Z"/></svg>'},dashboard:{name:"dashboard",category:"navigation",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M10 20V14H14V20H19V12H22L12 3L2 12H5V20H10Z"/></svg>'},add:{name:"add",category:"actions",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z"/></svg>'},delete:{name:"delete",category:"actions",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 4H15.5L14.5 3H9.5L8.5 4H5V6H19M6 19C6 20.1 6.9 21 8 21H16C17.1 21 18 20.1 18 19V7H6V19Z"/></svg>'},edit:{name:"edit",category:"actions",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M20.71 7.04C21.1 6.65 21.1 6 20.71 5.63L18.37 3.29C18 2.9 17.35 2.9 16.96 3.29L15.12 5.12L18.87 8.87M3 17.25V21H6.75L17.81 9.93L14.06 6.18L3 17.25Z"/></svg>'},save:{name:"save",category:"actions",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M15 9H5V5H15M12 19C9.24 19 7 16.76 7 14S9.24 9 12 9 17 11.24 17 14 14.76 19 12 19M17 3H5C3.89 3 3 3.89 3 5V19C3 20.1 3.89 21 5 21H19C20.1 21 21 20.1 21 19V7L17 3Z"/></svg>'},print:{name:"print",category:"actions",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M18 3H6V7H18M19 12C18.4 12 18 11.6 18 11S18.4 10 19 10 20 10.4 20 11 19.6 12 19 12M16 19H8V14H16M19 8H5C3.9 8 3 8.9 3 10V17H6V21H18V17H21V10C21 8.9 20.1 8 19 8Z"/></svg>'},search:{name:"search",category:"actions",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M9.5 3C13.09 3 16 5.91 16 9.5C16 11.11 15.41 12.59 14.44 13.73L14.71 14H15.5L20.5 19L19 20.5L14 15.5V14.71L13.73 14.44C12.59 15.41 11.11 16 9.5 16C5.91 16 3 13.09 3 9.5S5.91 3 9.5 3M9.5 5C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>'},clear:{name:"clear",category:"actions",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z"/></svg>'},close:{name:"close",category:"actions",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z"/></svg>'},copy:{name:"copy",category:"actions",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 21H8V7H19M19 5H8C6.9 5 6 5.9 6 7V21C6 22.1 6.9 23 8 23H19C20.1 23 21 22.1 21 21V7C21 5.9 20.1 5 19 5M16 1H4C2.9 1 2 1.9 2 3V17H4V3H16V1Z"/></svg>'},file:{name:"file",category:"actions",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.9 22 6 22H18C19.1 22 20 21.1 20 20V8L14 2M18 20H6V4H13V9H18V20Z"/></svg>'},success:{name:"success",category:"status",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L15 1H5C3.89 1 3 1.89 3 3V21C3 22.1 3.9 23 5 23H19C20.1 23 21 22.1 21 21V9M19 21H5V3H13V9H19Z"/></svg>'},warning:{name:"warning",category:"status",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M1 21H23L12 2L1 21M13 18H11V16H13V18M13 14H11V10H13V14Z"/></svg>'},error:{name:"error",category:"status",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C17.5 2 22 6.5 22 12S17.5 22 12 22 2 17.5 2 12 6.5 2 12 2M12 4C7.58 4 4 7.58 4 12S7.58 20 12 20 20 16.42 20 12 16.42 4 12 4M15.59 7L12 10.59L8.41 7L7 8.41L10.59 12L7 15.59L8.41 17L12 13.41L15.59 17L17 15.59L13.41 12L17 8.41L15.59 7Z"/></svg>'},info:{name:"info",category:"status",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM12 8C13.1 8 14 8.9 14 10V20C14 21.1 13.1 22 12 22S10 21.1 10 20V10C10 8.9 10.9 8 12 8Z"/></svg>'},loading:{name:"loading",category:"status",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 4V2C17.5 2 22 6.5 22 12H20C20 7.58 16.42 4 12 4Z"><animateTransform attributeName="transform" type="rotate" values="0 12 12;360 12 12" dur="1s" repeatCount="indefinite"/></path></svg>'},monitor:{name:"monitor",category:"products",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M21 16H3V4H21M21 2H3C1.89 2 1 2.89 1 4V16C1 17.1 1.89 18 3 18H10V20H8V22H16V20H14V18H21C22.1 18 23 17.1 23 16V4C23 2.89 22.1 2 21 2Z"/></svg>'},tv:{name:"tv",category:"products",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M21 17H3V5H21M21 3H3C1.89 3 1 3.89 1 5V17C1 18.1 1.89 19 3 19H8V21H16V19H21C22.1 19 23 18.1 23 17V5C23 3.89 22.1 3 21 3Z"/></svg>'},laptop:{name:"laptop",category:"products",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M4 6H20V16H4M20 18C21.11 18 22 17.11 22 16V6C22 4.89 21.11 4 20 4H4C2.89 4 2 4.89 2 6V16C2 17.11 2.89 18 4 18H0V20H24V18H20Z"/></svg>'},generator:{name:"generator",category:"products",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 2V13H10V22L17 10H13L17 2H7Z"/></svg>'},power:{name:"power",category:"products",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M16.56 5.44L15.11 6.89C16.84 7.94 18 9.83 18 12C18 15.31 15.31 18 12 18S6 15.31 6 12C6 9.83 7.16 7.94 8.88 6.88L7.44 5.44C5.36 6.88 4 9.28 4 12C4 16.42 7.58 20 12 20S20 16.42 20 12C20 9.28 18.64 6.88 16.56 5.44M13 3H11V13H13"/></svg>'},sound:{name:"sound",category:"products",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M14 3.23V5.29C16.89 6.15 19 8.83 19 12C19 15.17 16.89 17.84 14 18.7V20.77C18 19.86 21 16.28 21 12C21 7.72 18 4.14 14 3.23M16.5 12C16.5 10.23 15.5 8.71 14 7.97V16C15.5 15.29 16.5 13.76 16.5 12M3 9V15H7L12 20V4L7 9H3Z"/></svg>'},printer:{name:"printer",category:"products",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M18 3H6V7H18M19 12C18.4 12 18 11.6 18 11S18.4 10 19 10 20 10.4 20 11 19.6 12 19 12M16 19H8V14H16M19 8H5C3.9 8 3 8.9 3 10V17H6V21H18V17H21V10C21 8.9 20.1 8 19 8Z"/></svg>'},fax:{name:"fax",category:"products",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M4 6H2V20C2 21.11 2.89 22 4 22H18V20H4V6M20 2H8C6.89 2 6 2.89 6 4V16C6 17.11 6.89 18 8 18H20C21.11 18 22 17.11 22 16V4C22 2.89 21.11 2 20 2M20 12H8V14H20V12M20 8H8V10H20V8M20 4H8V6H20V4Z"/></svg>'},refrigerator:{name:"refrigerator",category:"products",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 2H15C16.1 2 17 2.9 17 4V9H15V4H9V9H7V4C7 2.9 7.9 2 9 2M7 10V20C7 21.1 7.9 22 9 22H15C16.1 22 17 21.1 17 20V10H7M15 11V13H13V11H15M15 14V17H13V14H15Z"/></svg>'},fan:{name:"fan",category:"products",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 11C12.6 11 13 11.4 13 12S12.6 13 12 13 11 12.6 11 12 11.4 11 12 11M12 2L13.09 8.26L22 9L13.09 9.74L12 16L10.91 9.74L2 9L10.91 8.26L12 2M12 22L10.91 15.74L2 15L10.91 14.26L12 8L13.09 14.26L22 15L13.09 15.74L12 22Z"/></svg>'},coffee:{name:"coffee",category:"products",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M2 19H20L18 17H4L2 19M5 4V7H3V9H4V14H18V9H19V7H17V4H5M7 6H15V7H7V6Z"/></svg>'},microphone:{name:"microphone",category:"products",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C13.1 2 14 2.9 14 4V10C14 11.1 13.1 12 12 12S10 11.1 10 10V4C10 2.9 10.9 2 12 2M19 10V12C19 15.9 15.9 19 12 19S5 15.9 5 12V10H7V12C7 14.8 9.2 17 12 17S17 14.8 17 12V10H19M12 19.9V22H8V24H16V22H12V19.9Z"/></svg>'},robot:{name:"robot",category:"system",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L15 1H5C3.89 1 3 1.89 3 3V21C3 22.1 3.9 23 5 23H19C20.1 23 21 22.1 21 21V9M19 21H5V3H13V9H19Z"/></svg>'},hand:{name:"hand",category:"system",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M23 15C23 18.31 20.31 21 17 21C14.98 21 13.2 20.23 12 18.95C10.8 20.23 9.02 21 7 21C3.69 21 1 18.31 1 15V9C1 8.45 1.45 8 2 8S3 8.45 3 9V15C3 17.21 4.79 19 7 19S11 17.21 11 15V11C11 9.9 11.9 9 13 9S15 9.9 15 11V15C15 17.21 16.79 19 19 19S23 17.21 23 15V9C23 8.45 22.55 8 22 8S21 8.45 21 9V15Z"/></svg>'},"folder-open":{name:"folder-open",category:"system",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 20H4C2.89 20 2 19.1 2 18V6C2 4.89 2.89 4 4 4H10L12 6H19C20.1 6 21 6.89 21 8H21L4 8V18L6.14 10H23.21L20.93 18.5C20.7 19.37 19.92 20 19 20Z"/></svg>'},"folder-closed":{name:"folder-closed",category:"system",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M10 4H4C2.89 4 2 4.89 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V8C22 6.89 21.1 6 20 6H12L10 4Z"/></svg>'},"stock-in":{name:"stock-in",category:"operations",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L2 7L12 12L22 7L12 2M2 17L12 22L22 17M2 12L12 17L22 12"/></svg>'},"stock-out":{name:"stock-out",category:"operations",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 14L5 12L5 10L12 3L19 10V12L17 14H7M12 6.8L9 9.8H15L12 6.8Z"/></svg>'},transfer:{name:"transfer",category:"operations",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M6.99 11L3 15L6.99 19V16H14V14H6.99V11M21 9L17.01 5V8H10V10H17.01V13L21 9Z"/></svg>'},adjustment:{name:"adjustment",category:"operations",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 15.5C10.07 15.5 8.5 13.93 8.5 12S10.07 8.5 12 8.5 15.5 10.07 15.5 12 13.93 15.5 12 15.5M19.43 12.98C19.47 12.66 19.5 12.34 19.5 12S19.47 11.34 19.43 11.02L21.54 9.37C21.73 9.22 21.78 8.95 21.66 8.73L19.66 5.27C19.54 5.05 19.27 4.97 19.05 5.05L16.56 6.05C16.04 5.65 15.48 5.32 14.87 5.07L14.5 2.42C14.46 2.18 14.25 2 14 2H10C9.75 2 9.54 2.18 9.5 2.42L9.13 5.07C8.52 5.32 7.96 5.66 7.44 6.05L4.95 5.05C4.72 4.96 4.46 5.05 4.34 5.27L2.34 8.73C2.21 8.95 2.27 9.22 2.46 9.37L4.57 11.02C4.53 11.34 4.5 11.67 4.5 12S4.53 12.66 4.57 12.98L2.46 14.63C2.27 14.78 2.21 15.05 2.34 15.27L4.34 18.73C4.46 18.95 4.72 19.03 4.95 18.95L7.44 17.95C7.96 18.35 8.52 18.68 9.13 18.93L9.5 21.58C9.54 21.82 9.75 22 10 22H14C14.25 22 14.46 21.82 14.5 21.58L14.87 18.93C15.48 18.68 16.04 18.34 16.56 17.95L19.05 18.95C19.28 19.04 19.54 18.95 19.66 18.73L21.66 15.27C21.78 15.05 21.73 14.78 21.54 14.63L19.43 12.98Z"/></svg>'},maritime:{name:"maritime",category:"operations",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M3 4H16.5L21 8.5V17H18.5C18.5 18.38 17.38 19.5 16 19.5S13.5 18.38 13.5 17H8.5C8.5 18.38 7.38 19.5 6 19.5S3.5 18.38 3.5 17H1V6C1 4.89 1.89 4 3 4M16 18C16.55 18 17 17.55 17 17S16.55 16 16 16 15 16.45 15 17 15.45 18 16 18M6 18C6.55 18 7 17.55 7 17S6.55 16 6 16 5 16.45 5 17 5.45 18 6 18M15 8.5H19.5L16.5 5.5H15V8.5Z"/></svg>'},airplane:{name:"airplane",category:"operations",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M21 16V14L13 9V3.5C13 2.67 12.33 2 11.5 2S10 2.67 10 3.5V9L2 14V16L10 13.5V19L8 20.5V22L11.5 21L15 22V20.5L13 19V13.5L21 16Z"/></svg>'},location:{name:"location",category:"system",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C15.31 2 18 4.66 18 7.95C18 12.41 12 19 12 19S6 12.41 6 7.95C6 4.66 8.69 2 12 2M12 6C10.9 6 10 6.9 10 8S10.9 10 12 10 14 9.1 14 8 13.1 6 12 6Z"/></svg>'},calendar:{name:"calendar",category:"system",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H18V1H16V3H8V1H6V3H5C3.89 3 3 3.89 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.89 20.1 3 19 3M19 19H5V8H19V19M7 10H12V15H7V10Z"/></svg>'},category:{name:"category",category:"system",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M10 4H4C2.89 4 2 4.89 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V8C22 6.89 21.1 6 20 6H12L10 4Z"/></svg>'},lightbulb:{name:"lightbulb",category:"system",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C8.14 2 5 5.14 5 9C5 11.38 6.19 13.47 8 14.74V17C8 17.55 8.45 18 9 18H15C15.55 18 16 17.55 16 17V14.74C17.81 13.47 19 11.38 19 9C19 5.14 15.86 2 12 2M9.5 11.5C9.5 11.78 9.22 12 8.5 12S7.5 11.78 7.5 11.5S7.78 11 8.5 11 9.5 11.22 9.5 11.5M14.5 11.5C14.5 11.78 14.22 12 13.5 12S12.5 11.78 12.5 11.5S12.78 11 13.5 11 14.5 11.22 14.5 11.5M15 20C15 20.55 14.55 21 14 21H10C9.45 21 9 20.55 9 20V19H15V20Z"/></svg>'},cash:{name:"cash",category:"finance",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M3 6H21V18H3V6M12 9C10.89 9 10 9.89 10 11S10.89 13 12 13 14 12.11 14 11 13.11 9 12 9M18 8V10H21V8H18M3 8V10H6V8H3Z"/></svg>'},"credit-card":{name:"credit-card",category:"finance",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M20 4H4C2.89 4 2 4.89 2 6V18C2 19.11 2.89 20 4 20H20C21.11 20 22 19.11 22 18V6C22 4.89 21.11 4 20 4M20 11H4V8H20V11Z"/></svg>'},warehouse:{name:"warehouse",category:"operations",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 3L2 12H5V20H19V12H22L12 3M12 7.7L17 11.9V18H15V13H9V18H7V11.9L12 7.7M11 14H13V16H11V14Z"/></svg>'},store:{name:"store",category:"operations",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 3L4 9V21H20V9L12 3M18 19H6V10L12 5.69L18 10V19M8 12H16V14H8V12Z"/></svg>'},supplier:{name:"supplier",category:"operations",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M18 15H16V17H18M18 11H16V13H18M20 19H12V17H14V15H12V13H14V11H12V9H20M10 7H8V5H10M10 11H8V9H10M10 15H8V13H10M10 19H8V17H10M6 7H4V5H6M6 11H4V9H6M6 15H4V13H6M6 19H4V17H6M12 7V3H2V21H22V7H12Z"/></svg>'},customer:{name:"customer",category:"management",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 4C14.21 4 16 5.79 16 8S14.21 12 12 12 8 10.21 8 8 9.79 4 12 4M12 14C16.42 14 20 15.79 20 18V20H4V18C4 15.79 7.58 14 12 14Z"/></svg>'},quick:{name:"quick",category:"actions",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 2V13H10V22L17 10H13L17 2H7Z"/></svg>'},template:{name:"template",category:"system",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3M19 19H5V5H19V19M17 17H7V15H17V17M17 13H7V11H17V13M17 9H7V7H17V9Z"/></svg>'},check:{name:"check",category:"status",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M21 7L9 19L3.5 13.5L4.91 12.09L9 16.17L19.59 5.59L21 7Z"/></svg>'},uncheck:{name:"uncheck",category:"status",svg:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3M19 19H5V5H19V19Z"/></svg>'}},[pI,aB]=Bc({icons:hI}),mI=t=>pI.icons[t];var yI=le("<span>");const Yr=t=>{const e=Nt(()=>mI(t.name)),r=Nt(()=>typeof t.size=="number"?`${t.size}px`:t.size||"1em"),n=Nt(()=>({width:r(),height:r(),display:"inline-block",color:t.color||"currentColor",cursor:t.onClick?"pointer":"default",...t.style}));return(()=>{var i=yI();return Cn(i,"click",t.onClick,!0),ge(o=>{var s=`icon ${t.class||""}`,l=n(),c=t.title||t.name,d=e()?.svg||`<svg viewBox="0 0 ${r()} ${r()}" fill=${t.color||"currentColor"}><path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM12 8C13.1 8 14 8.9 14 10V20C14 21.1 13.1 22 12 22S10 21.1 10 20V10C10 8.9 10.9 8 12 8Z"/></svg>`;return s!==o.e&&fp(i,o.e=s),o.t=p(i,l,o.t),c!==o.a&&Jt(i,"title",o.a=c),d!==o.o&&(i.innerHTML=o.o=d),o},{e:void 0,t:void 0,a:void 0,o:void 0}),i})()};Wt(["click"]);var H0=le('<img alt="User avatar">'),fI=le("<div class=user-info-desktop><span>"),gI=le("<button class=sign-out-desktop>Sign Out"),vI=le("<div><div><span></span></div><button>Sign Out"),bI=le(`<nav><div><div class=desktop-nav></div><div><button class=mobile-menu-button><svg width=24 height=24 viewBox="0 0 24 24"fill=currentColor><path></path></svg></button></div></div><div class=mobile-nav></div><style>
        .nav-active {
          background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)) !important;
          color: white !important;
          box-shadow: var(--shadow-sm);
        }
        
        .desktop-nav a:hover:not(.nav-active),
        .nav-group button:hover {
          background: var(--background-color);
          color: var(--text-primary);
        }
        
        .mobile-nav a:hover:not(.nav-active) {
          background: var(--background-color);
          color: var(--text-primary);
        }

        /* Create invisible bridge to prevent gap issues */
        .nav-group::before {
          content: '';
          position: absolute;
          top: 100%;
          left: 0;
          right: 0;
          height: 0.5rem;
          z-index: 9;
        }
        
        @media (max-width: 768px) {
          .desktop-nav {
            display: none !important;
          }
          
          .mobile-menu-button {
            display: block !important;
          }
          
          .user-info-desktop,
          .sign-out-desktop {
            display: none !important;
          }
          
          nav > div:first-child {
            padding: 1rem;
          }
        }
        
        @media (min-width: 769px) {
          .mobile-nav {
            display: none !important;
          }
        }
      `),PI=le("<div class=nav-group><button> <span>▼</span></button><div>"),_I=le("<div>"),SI=le("<div><div><span> </span><span>▼");const wI=()=>{const{t}=or(),[e,r]=Se(!1),[n,i]=Se(null),[o,s]=Se(null),l={background:"var(--surface-color)","border-bottom":"1px solid var(--border-color)","box-shadow":"var(--shadow-sm)","backdrop-filter":"blur(10px)",position:"sticky",top:"0","z-index":"100"},c={display:"flex","align-items":"center","justify-content":"space-between",padding:"1rem 2rem",margin:"0 auto",position:"relative"},d={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","text-decoration":"none"},u={display:"flex",gap:"1rem","align-items":"center",flex:"1","margin-left":"2rem"},h={display:"none",position:"absolute",top:"100%",left:"0",right:"0",background:"var(--surface-color)","border-top":"1px solid var(--border-color)","box-shadow":"var(--shadow-md)","max-height":"70vh","overflow-y":"auto"},g={position:"relative",display:"flex","align-items":"center"},m={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem",background:"transparent",border:"none",color:"var(--text-secondary)","font-weight":"500","font-size":"0.875rem",cursor:"pointer","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease","white-space":"nowrap"},S={position:"absolute",top:"100%",left:"0",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","min-width":"200px","margin-top":"0.25rem","z-index":"10",display:"none","padding-top":"0.25rem"},N={"border-bottom":"1px solid var(--border-color)"},x={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",cursor:"pointer","font-weight":"600",color:"var(--text-primary)"},b={display:"block","text-decoration":"none",color:"var(--text-secondary)",padding:"0.75rem 1rem","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease","white-space":"nowrap"},K={...b,padding:"0.75rem 1.5rem","border-bottom":"1px solid var(--border-light)"},te={display:"none",background:"transparent",border:"none",padding:"0.5rem",cursor:"pointer",color:"var(--text-primary)"},F={display:"flex","align-items":"center",gap:"1rem"},V={display:"flex","align-items":"center",gap:"0.75rem",padding:"0.5rem 1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",color:"var(--text-primary)"},W={width:"32px",height:"32px","border-radius":"50%","object-fit":"cover"},I={...b,cursor:"pointer",border:"1px solid var(--border-color)",background:"transparent","border-radius":"var(--border-radius-sm)"},E=()=>{Gt.signOut()},L=T=>{const R=Gt.state?.profile;return R?R[T]===!0||R.isAdmin===!0:!1},M=()=>{r(!e())},P=T=>{i(n()===T?null:T)},w=T=>{const R=o();R&&(clearTimeout(R),s(null)),i(T)},v=()=>{const T=setTimeout(()=>{i(null)},300);s(T)},j=[{name:"Finance",icon:"finance",items:[{path:"/accounts",label:t("navigation.accounts"),permission:"AccountAccess",icon:"accounts"},{path:"/entry-books",label:t("navigation.entryBooks"),permission:"JournalAccess",icon:"books"},{path:"/balance-sheet",label:t("navigation.balanceSheet"),permission:"AccountAccess",icon:"balance-sheet"},{path:"/bank-consolidations",label:t("navigation.consolidate"),permission:"BankingAccess",icon:"bank"},{path:"/automation",label:"Manual Automation",permission:"AccountAccess",icon:"automation-target"},{path:"/event-automation",label:"Event Automation",permission:"AccountAccess",icon:"automation-bolt"}]},{name:"Operations",icon:"operations",items:[{path:"/inventory",label:t("navigation.inventory"),permission:"InventoryAccess",icon:"inventory"},{path:"/invoices",label:t("invoices.invoices"),permission:"invoiceAccess",icon:"invoice"},{path:"/hbl",label:t("navigation.hbl"),permission:"HBLAccess",icon:"shipping"},{path:"/cuban-passport",label:t("navigation.cubanPassport","Cuban Passport"),permission:"PassportAccess",icon:"passport"}]},{name:"Management",icon:"management",items:[{path:"/employees",label:t("navigation.employees"),permission:"EmployeeAccess",icon:"employees"},{path:"/admin/users",label:"Admin",permission:"isAdmin",icon:"admin",adminOnly:!0}]}],z=()=>j.map(T=>({...T,items:T.items.filter(R=>R.adminOnly?Gt.state?.profile?.isAdmin:L(R.permission))})).filter(T=>T.items.length>0);return(()=>{var T=bI(),R=T.firstChild,J=R.firstChild,X=J.nextSibling,H=X.firstChild,se=H.firstChild,O=se.firstChild,_=R.nextSibling;return a(R,A(hc,{href:"/",style:d,children:"HRM Finance"}),J),p(J,u),a(J,A(hc,{href:"/",style:b,activeClass:"nav-active",get children(){return[A(Yr,{name:"dashboard",size:"1em",style:{"margin-right":"0.5rem"}})," ",ke(()=>t("navigation.dashboard"))]}}),null),a(J,A(vt,{get each(){return z()},children:k=>(()=>{var $=PI(),G=$.firstChild,ne=G.firstChild,U=ne.nextSibling,D=G.nextSibling;return $.addEventListener("mouseleave",v),$.addEventListener("mouseenter",()=>w(k.name)),a(G,A(Yr,{get name(){return k.icon},size:"1em",style:{"margin-right":"0.5rem"}}),ne),a(G,()=>k.name,U),U.style.setProperty("font-size","0.75rem"),D.addEventListener("mouseleave",v),D.addEventListener("mouseenter",()=>w(k.name)),a(D,A(vt,{get each(){return k.items},children:B=>A(hc,{get href(){return B.path},style:b,activeClass:"nav-active",onClick:()=>i(null),get children(){return[A(Yr,{get name(){return B.icon},size:"1em",style:{"margin-right":"0.5rem"}})," ",ke(()=>B.label)]}})})),ge(B=>{var Q=g,Z=m,oe={...S,display:n()===k.name?"block":"none"};return B.e=p($,Q,B.e),B.t=p(G,Z,B.t),B.a=p(D,oe,B.a),B},{e:void 0,t:void 0,a:void 0}),$})()}),null),p(X,F),a(X,A(uI,{}),H),a(X,A(Me,{get when(){return Gt.currentUser},get children(){return[(()=>{var k=fI(),$=k.firstChild;return a(k,A(Me,{get when(){return Gt.currentUser?.photoURL},get children(){var G=H0();return ge(ne=>{var U=Gt.currentUser.photoURL,D=W;return U!==ne.e&&Jt(G,"src",ne.e=U),ne.t=p(G,D,ne.t),ne},{e:void 0,t:void 0}),G}}),$),a($,()=>Gt.currentUser?.displayName||Gt.currentUser?.email),ge(G=>p(k,V,G)),k})(),(()=>{var k=gI();return k.addEventListener("mouseleave",$=>{$.currentTarget.style.background="transparent",$.currentTarget.style.color="var(--text-secondary)"}),k.addEventListener("mouseenter",$=>{$.currentTarget.style.background="var(--background-color)",$.currentTarget.style.color="var(--text-primary)"}),k.$$click=E,ge($=>p(k,I,$)),k})()]}}),H),H.$$click=M,p(H,te),a(_,A(hc,{href:"/",style:K,activeClass:"nav-active",onClick:()=>r(!1),get children(){return[A(Yr,{name:"dashboard",size:"1em",style:{"margin-right":"0.5rem"}})," ",ke(()=>t("navigation.dashboard"))]}}),null),a(_,A(vt,{get each(){return z()},children:k=>(()=>{var $=SI(),G=$.firstChild,ne=G.firstChild,U=ne.firstChild,D=ne.nextSibling;return p($,N),G.$$click=()=>P(k.name),p(G,x),a(ne,A(Yr,{get name(){return k.icon},size:"1em",style:{"margin-right":"0.5rem"}}),U),a(ne,()=>k.name,null),D.style.setProperty("transition","transform 0.2s"),a($,A(Me,{get when(){return n()===k.name},get children(){var B=_I();return B.style.setProperty("background","var(--background-color)"),a(B,A(vt,{get each(){return k.items},children:Q=>A(hc,{get href(){return Q.path},get style(){return{...K,"padding-left":"3rem"}},activeClass:"nav-active",onClick:()=>r(!1),get children(){return[A(Yr,{get name(){return Q.icon},size:"1em",style:{"margin-right":"0.5rem"}})," ",ke(()=>Q.label)]}})})),B}}),null),ge(B=>(B=n()===k.name?"rotate(180deg)":"none")!=null?D.style.setProperty("transform",B):D.style.removeProperty("transform")),$})()}),null),a(_,A(Me,{get when(){return Gt.currentUser},get children(){var k=vI(),$=k.firstChild,G=$.firstChild,ne=$.nextSibling;return k.style.setProperty("padding","1rem"),k.style.setProperty("border-top","2px solid var(--border-color)"),a($,A(Me,{get when(){return Gt.currentUser?.photoURL},get children(){var U=H0();return ge(D=>{var B=Gt.currentUser.photoURL,Q=W;return B!==D.e&&Jt(U,"src",D.e=B),D.t=p(U,Q,D.t),D},{e:void 0,t:void 0}),U}}),G),a(G,()=>Gt.currentUser?.displayName||Gt.currentUser?.email),ne.$$click=()=>{E(),r(!1)},ge(U=>{var D={...V,"margin-bottom":"1rem"},B={...I,width:"100%"};return U.e=p($,D,U.e),U.t=p(ne,B,U.t),U},{e:void 0,t:void 0}),k}}),null),ge(k=>{var $=l,G=c,ne=e()?"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z":"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z",U={...h,display:e()?"block":"none"};return k.e=p(T,$,k.e),k.t=p(R,G,k.t),ne!==k.a&&Jt(O,"d",k.a=ne),k.o=p(_,U,k.o),k},{e:void 0,t:void 0,a:void 0,o:void 0}),T})()};Wt(["click"]);var xI=le("<div><div><div>🔒</div><h1></h1><p>.</p><div><p><strong></strong><br></p></div><div><button></button></div><div><h3></h3><div><span>✓</span><span></span></div><div><span>✓</span><span></span></div><div><span>✓</span><span></span></div></div><div><p>"),G0=le("<br>"),CI=le("<strong>");const AI=t=>{const{t:e}=or(),r={"min-height":"calc(100vh - 200px)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},n={"text-align":"center","max-width":"600px",width:"100%"},i={"font-size":"5rem",color:"#e53e3e","margin-bottom":"2rem"},o={"font-size":"2.5rem","font-weight":"700",color:"#1a202c","margin-bottom":"1rem"},s={"font-size":"1.25rem",color:"#718096","margin-bottom":"2rem","line-height":"1.6"},l={background:"#f7fafc",border:"1px solid #e2e8f0","border-radius":"0.5rem",padding:"1.5rem","margin-bottom":"2rem"},c={color:"#4a5568","font-size":"1rem","line-height":"1.6"},d={display:"flex",gap:"1rem","justify-content":"center","flex-wrap":"wrap"},u={padding:"0.75rem 2rem","border-radius":"0.5rem","text-decoration":"none","font-weight":"500",transition:"all 0.2s",display:"inline-block"},h={...u,background:"var(--primary-color)",color:"white",border:"2px solid var(--primary-color)"},g={...u,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},m={"text-align":"left","margin-top":"2rem",padding:"0 2rem"},S={display:"flex","align-items":"center",gap:"0.75rem","margin-bottom":"1rem",color:"#4a5568"},N={color:"#48bb78","font-size":"1.25rem"};return A(oo,{get title(){return e("unauthorized.title")},get children(){var x=xI(),b=x.firstChild,K=b.firstChild,te=K.nextSibling,F=te.nextSibling,V=F.firstChild,W=F.nextSibling,I=W.firstChild,E=I.firstChild;E.nextSibling;var L=W.nextSibling,M=L.firstChild,P=L.nextSibling,w=P.firstChild,v=w.nextSibling,j=v.firstChild,z=j.nextSibling,T=v.nextSibling,R=T.firstChild,J=R.nextSibling,X=T.nextSibling,H=X.firstChild,se=H.nextSibling,O=P.nextSibling,_=O.firstChild;return p(x,r),p(b,n),p(K,i),p(te,o),a(te,()=>e("unauthorized.accessDenied")),p(F,s),a(F,()=>e("unauthorized.noPermission"),V),a(F,(()=>{var k=ke(()=>!!t.featureName);return()=>k()?` ${t.featureName}`:` ${e("unauthorized.thisFeature")}`})(),V),p(W,l),p(I,c),a(E,()=>e("unauthorized.whySeeing")),a(I,()=>e("unauthorized.explanation"),null),a(I,(()=>{var k=ke(()=>!!t.requiredPermission);return()=>k()&&[G0(),G0(),(()=>{var $=CI();return a($,()=>e("unauthorized.requiredPermission")),$})()," ",ke(()=>t.requiredPermission)]})(),null),p(L,d),a(L,A(hc,{href:"/",style:h,get children(){return e("unauthorized.goToDashboard")}}),M),M.$$click=()=>window.history.back(),a(M,()=>e("unauthorized.goBack")),p(P,m),w.style.setProperty("margin-bottom","1rem"),w.style.setProperty("color","#2d3748"),a(w,()=>e("unauthorized.featuresCanAccess")),a(z,()=>e("unauthorized.dashboardAccess")),a(J,()=>e("unauthorized.profileAccess")),a(se,()=>e("unauthorized.roleBasedAccess")),O.style.setProperty("margin-top","3rem"),O.style.setProperty("padding","1.5rem"),O.style.setProperty("background","#edf2f7"),O.style.setProperty("border-radius","0.5rem"),_.style.setProperty("color","#4a5568"),_.style.setProperty("font-size","0.875rem"),a(_,()=>e("unauthorized.needAccess")),ge(k=>{var $=g,G=S,ne=N,U=S,D=N,B=S,Q=N;return k.e=p(M,$,k.e),k.t=p(v,G,k.t),k.a=p(j,ne,k.a),k.o=p(T,U,k.o),k.i=p(R,D,k.i),k.n=p(X,B,k.n),k.s=p(H,Q,k.s),k},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),x}})};Wt(["click"]);const Vi=t=>{const{t:e}=or(),r=()=>{if(!t.permission)return!0;const i=Gt.state?.profile;if(!i)return!1;if(i.isAdmin)return!0;switch(t.permission){case"AccountAccess":return i.AccountAccess===!0;case"InventoryAccess":return i.InventoryAccess===!0;case"EmployeeAccess":return i.EmployeeAccess===!0;case"BankingAccess":return i.BankingAccess===!0;case"JournalAccess":return i.JournalAccess===!0;case"AdminAccess":return i.isAdmin===!0;default:return i[t.permission]===!0}},n=()=>{if(t.requiredPermission)return t.requiredPermission;switch(t.permission){case"AccountAccess":return e("unauthorized.permissions.accountAccess");case"InventoryAccess":return e("unauthorized.permissions.inventoryAccess");case"EmployeeAccess":return e("unauthorized.permissions.employeeAccess");case"BankingAccess":return e("unauthorized.permissions.bankingAccess");case"JournalAccess":return e("unauthorized.permissions.journalAccess");case"AdminAccess":return e("unauthorized.permissions.adminAccess");default:return t.permission}};return A(Me,{get when(){return r()},get fallback(){return t.fallback||A(AI,{get featureName(){return t.featureName},get requiredPermission(){return n()}})},get children(){return t.children}})};var $I=le('<button title="Open Dev Tools">🛠️'),EI=le("<span>(<!>)"),II=le("<div><span></span><span>"),W0=le("<div>"),TI=le("<div>Database reset only available in fake mode"),kI=le("<div><div>Loading..."),NI=le("<div><div><h3>🛠️ Dev Tools</h3><button>✕</button></div><div><div>API Mode</div><div><button>Fake Server</button><button>Real API</button><button>Hybrid</button></div><div>Current: <strong></strong></div></div><div><div>Health Status</div></div><div><div>Database Stats</div></div><div><div>Actions</div><div><button>🔄 Refresh Stats</button><button>💊 Health Check</button></div><div><button>🗑️ Reset DB</button></div></div><div><div>Info</div><div>• <strong>Fake Server:</strong> Uses local mock data<br>• <strong>Real API:</strong> Connects to actual backend<br>• <strong>Hybrid:</strong> Real API with fake fallback<br>• Settings are saved in localStorage"),LI=le("<div>Loading..."),RI=le("<div><span>:</span><span>");const DI=()=>{const[t,e]=Se(!1),[r,n]=Se(Zy.getMode()),[i,o]=Se({}),[s,l]=Se(null),[c,d]=Se(!1);Ln(async()=>{await u(),await h()});const u=async()=>{try{const I=await q0.getStats();o(I)}catch(I){console.error("Failed to load stats:",I)}},h=async()=>{try{const I=await q0.healthCheck();l(I)}catch(I){console.error("Health check failed:",I),l({status:"error",error:I.message})}},g=async I=>{d(!0);try{Zy.setMode(I),n(I),await u(),await h()}catch(E){console.error("Failed to change API mode:",E)}finally{d(!1)}},m=async()=>{if(confirm("Are you sure you want to reset the fake database to its initial state?")){d(!0);try{const I=await cn.utils.resetDatabase();alert(I.message),await u()}catch(I){console.error("Failed to reset database:",I),alert("Failed to reset database")}finally{d(!1)}}},S={position:"fixed",bottom:"20px",right:"20px","z-index":"10000","font-family":"monospace"},N={background:"#1a1a1a",color:"#fff",border:"1px solid #333","border-radius":"8px",padding:"16px","min-width":"300px","max-width":"400px","box-shadow":"0 4px 20px rgba(0,0,0,0.3)"},x={background:"#007acc",color:"#fff",border:"none","border-radius":"50%",width:"50px",height:"50px",cursor:"pointer","font-size":"20px","box-shadow":"0 2px 10px rgba(0,0,0,0.2)",display:"flex","align-items":"center","justify-content":"center"},b={background:"#333",color:"#fff",border:"1px solid #555","border-radius":"4px",padding:"6px 12px",cursor:"pointer","font-size":"12px","margin-right":"8px","margin-bottom":"8px"},K={...b,background:"#007acc","border-color":"#007acc"},te={"margin-bottom":"16px","padding-bottom":"12px","border-bottom":"1px solid #333"},F={"font-size":"14px","font-weight":"bold","margin-bottom":"8px",color:"#007acc"},V={display:"flex","justify-content":"space-between","font-size":"12px","margin-bottom":"4px"},W=I=>({display:"inline-block",width:"8px",height:"8px","border-radius":"50%","margin-right":"8px",background:I==="healthy"?"#00ff00":I==="error"?"#ff0000":"#ffff00"});return(()=>{var I=W0();return a(I,A(Me,{get when(){return!t()},get children(){var E=$I();return E.$$click=()=>e(!0),p(E,x),E}}),null),a(I,A(Me,{get when(){return t()},get children(){var E=NI(),L=E.firstChild,M=L.firstChild,P=M.nextSibling,w=L.nextSibling,v=w.firstChild,j=v.nextSibling,z=j.firstChild,T=z.nextSibling,R=T.nextSibling,J=j.nextSibling,X=J.firstChild,H=X.nextSibling,se=w.nextSibling,O=se.firstChild,_=se.nextSibling,k=_.firstChild,$=_.nextSibling,G=$.firstChild,ne=G.nextSibling,U=ne.firstChild,D=U.nextSibling,B=ne.nextSibling,Q=B.firstChild,Z=$.nextSibling,oe=Z.firstChild,de=oe.nextSibling;return p(E,N),L.style.setProperty("display","flex"),L.style.setProperty("justify-content","space-between"),L.style.setProperty("align-items","center"),L.style.setProperty("margin-bottom","16px"),M.style.setProperty("margin","0"),M.style.setProperty("color","#007acc"),M.style.setProperty("font-size","16px"),P.$$click=()=>e(!1),z.$$click=()=>g("fake"),T.$$click=()=>g("real"),R.$$click=()=>g("hybrid"),J.style.setProperty("font-size","11px"),J.style.setProperty("color","#888"),J.style.setProperty("margin-top","4px"),a(H,r),a(J,()=>r()==="fake"&&" (Using fake server)",null),a(J,()=>r()==="real"&&" (Using real API)",null),a(J,()=>r()==="hybrid"&&" (Real API with fallback)",null),a(se,A(Me,{get when(){return s()},get fallback(){return(()=>{var re=LI();return re.style.setProperty("font-size","12px"),re})()},get children(){return[(()=>{var re=II(),Y=re.firstChild,ce=Y.nextSibling;return re.style.setProperty("display","flex"),re.style.setProperty("align-items","center"),re.style.setProperty("font-size","12px"),a(ce,()=>s()?.status||"Unknown"),a(re,A(Me,{get when(){return s()?.timestamp},get children(){var ue=EI(),ae=ue.firstChild,ye=ae.nextSibling;return ye.nextSibling,ue.style.setProperty("margin-left","8px"),ue.style.setProperty("color","#888"),a(ue,()=>new Date(s().timestamp).toLocaleTimeString(),ye),ue}}),null),ge(ue=>p(Y,W(s()?.status||"unknown"),ue)),re})(),A(Me,{get when(){return s()?.error},get children(){var re=W0();return re.style.setProperty("font-size","11px"),re.style.setProperty("color","#ff6666"),re.style.setProperty("margin-top","4px"),a(re,()=>s().error),re}})]}}),null),a(_,A(vt,{get each(){return Object.entries(i())},children:([re,Y])=>(()=>{var ce=RI(),ue=ce.firstChild,ae=ue.firstChild,ye=ue.nextSibling;return p(ce,V),ue.style.setProperty("text-transform","capitalize"),a(ue,re,ae),ye.style.setProperty("color","#00ff00"),a(ye,Y),ce})()}),null),U.$$click=u,D.$$click=h,B.style.setProperty("margin-top","8px"),Q.$$click=m,a($,A(Me,{get when(){return r()!=="fake"},get children(){var re=TI();return re.style.setProperty("font-size","11px"),re.style.setProperty("color","#888"),re.style.setProperty("margin-top","4px"),re}}),null),de.style.setProperty("font-size","11px"),de.style.setProperty("color","#888"),de.style.setProperty("line-height","1.4"),a(E,A(Me,{get when(){return c()},get children(){var re=kI(),Y=re.firstChild;return re.style.setProperty("position","absolute"),re.style.setProperty("top","0"),re.style.setProperty("left","0"),re.style.setProperty("right","0"),re.style.setProperty("bottom","0"),re.style.setProperty("background","rgba(0,0,0,0.7)"),re.style.setProperty("display","flex"),re.style.setProperty("align-items","center"),re.style.setProperty("justify-content","center"),re.style.setProperty("border-radius","8px"),Y.style.setProperty("color","#fff"),Y.style.setProperty("font-size","14px"),re}}),null),ge(re=>{var Y={...b,padding:"4px 8px"},ce=te,ue=F,ae=r()==="fake"?K:b,ye=c(),me=r()==="real"?K:b,pe=c(),ve=r()==="hybrid"?K:b,Ne=c(),Ie=te,Ce=F,Ee=te,we=F,Re=te,He=F,je=b,Ve=c(),qe=b,tt=c(),rt={...b,background:"#cc4400","border-color":"#cc4400"},Be=c()||r()!=="fake",Ge=F;return re.e=p(P,Y,re.e),re.t=p(w,ce,re.t),re.a=p(v,ue,re.a),re.o=p(z,ae,re.o),ye!==re.i&&(z.disabled=re.i=ye),re.n=p(T,me,re.n),pe!==re.s&&(T.disabled=re.s=pe),re.h=p(R,ve,re.h),Ne!==re.r&&(R.disabled=re.r=Ne),re.d=p(se,Ie,re.d),re.l=p(O,Ce,re.l),re.u=p(_,Ee,re.u),re.c=p(k,we,re.c),re.w=p($,Re,re.w),re.m=p(G,He,re.m),re.f=p(U,je,re.f),Ve!==re.y&&(U.disabled=re.y=Ve),re.g=p(D,qe,re.g),tt!==re.p&&(D.disabled=re.p=tt),re.b=p(Q,rt,re.b),Be!==re.T&&(Q.disabled=re.T=Be),re.A=p(oe,Ge,re.A),re},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),E}}),null),ge(E=>p(I,S,E)),I})()};Wt(["click"]);const MI=[{id:"1",accountNumber:"1000",name:"Cash and Cash Equivalents",accountType:"Asset",category:"Current Assets",description:"Cash on hand and in bank accounts",balance:45230.5,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1001",accountNumber:"1001",name:"Petty Cash",accountType:"Asset",category:"Current Assets",description:"Small amounts of cash for minor expenses",balance:500,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1002",accountNumber:"1002",name:"Bank - Checking Account",accountType:"Asset",category:"Current Assets",description:"Main operating checking account",balance:32730.5,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1003",accountNumber:"1003",name:"Bank - Savings Account",accountType:"Asset",category:"Current Assets",description:"Interest-bearing savings account",balance:12e3,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"2",accountNumber:"1100",name:"Accounts Receivable",accountType:"Asset",category:"Current Assets",description:"Money owed by customers",balance:23450.75,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2001",accountNumber:"1101",name:"Trade Receivables",accountType:"Asset",category:"Current Assets",description:"Receivables from regular customers",balance:18450.75,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2002",accountNumber:"1102",name:"Employee Advances",accountType:"Asset",category:"Current Assets",description:"Money advanced to employees",balance:5e3,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"3",accountNumber:"1200",name:"Inventory",accountType:"Asset",category:"Current Assets",description:"Products held for sale",balance:78920.25,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-13"},{id:"4",accountNumber:"1500",name:"Equipment",accountType:"Asset",category:"Fixed Assets",description:"Office equipment and machinery",balance:125e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-12"},{id:"5",accountNumber:"2000",name:"Accounts Payable",accountType:"Liability",category:"Current Liabilities",description:"Money owed to suppliers",balance:15670.3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-11"},{id:"6",accountNumber:"2100",name:"Accrued Expenses",accountType:"Liability",category:"Current Liabilities",description:"Expenses incurred but not yet paid",balance:8945.6,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-10"},{id:"7",accountNumber:"2500",name:"Long-term Debt",accountType:"Liability",category:"Long-term Liabilities",description:"Long-term loans and mortgages",balance:85e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-09"},{id:"8",accountNumber:"3000",name:"Owner's Equity",accountType:"Equity",category:"Owner's Equity",description:"Owner's investment in the business",balance:15e4,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-08"},{id:"9",accountNumber:"3100",name:"Retained Earnings",accountType:"Equity",category:"Owner's Equity",description:"Accumulated profits retained in business",balance:32450.8,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-07"},{id:"10",accountNumber:"4000",name:"Sales Revenue",accountType:"Revenue",category:"Operating Revenue",description:"Revenue from product sales",balance:245678.9,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-06"},{id:"11",accountNumber:"4100",name:"Service Revenue",accountType:"Revenue",category:"Operating Revenue",description:"Revenue from services provided",balance:89432.15,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-05"},{id:"12",accountNumber:"5000",name:"Cost of Goods Sold",accountType:"Expense",category:"Operating Expenses",description:"Direct costs of producing goods",balance:125678.45,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-04"},{id:"13",accountNumber:"5100",name:"Salaries Expense",accountType:"Expense",category:"Operating Expenses",description:"Employee salary expenses",balance:98765.32,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-03"},{id:"14",accountNumber:"5200",name:"Rent Expense",accountType:"Expense",category:"Operating Expenses",description:"Office rent expenses",balance:24e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-02"}],FI=[{id:"1",accountId:"1",date:"2024-01-15",description:"Customer payment received",debitAmount:5e3,creditAmount:0,reference:"INV-2024-001",type:"debit"},{id:"2",accountId:"2",date:"2024-01-15",description:"Customer payment received",debitAmount:0,creditAmount:5e3,reference:"INV-2024-001",type:"credit"},{id:"3",accountId:"5",date:"2024-01-14",description:"Office supplies purchased",debitAmount:0,creditAmount:1250,reference:"PO-2024-001",type:"credit"}],[Jo,ud]=Se(MI),[km,OI]=Se(FI),xr={get accounts(){return Jo()},get transactions(){return km()},parseAccount(t){let e={id:t?.accountId||t.id||t?.code,accountNumber:t.accountNumber||t?.code,code:t?.code,name:t.name,type:t.type,accountType:t.accountType,classification:t.classification||t.clasification,category:t.category,description:t.description,isActive:!0,accountId:t?.accountId,parentAccountId:t?.parentAccountId,parentAccountNumber:t?.parentAccountNumber};return console.log(e),e},updAccount(t){try{ud(t.map(xr.parseAccount))}catch(e){console.log(e)}},fetchAllAccount(t){const e={...t,createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return ud([...Jo(),e]),e},async addAccount(t){const e={...t,accountId:ki(),id:ki(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};console.log("newAccount",e);let r=await Fd.create(e);return console.log(r),ud([...Jo(),e]),e},async updateAccountServer(t,e){let r=await Fd.update(t,e);xr.updateAccount(t,e),console.log(r,t,e)},updateAccount(t,e){ud(Jo().map(r=>r.id===t?{...r,...e,lastModified:new Date().toISOString().split("T")[0]}:r))},async deleteAccount(t){let e=await Fd.delete(t);console.log("deleteAccount",e),ud(Jo().filter(r=>r.id!==t))},getAccountById(t){return Jo().find(e=>e.id===t)},getAccountsByType(t){return Jo().filter(e=>e.type===t)},getAccountTransactions(t){return km().filter(e=>e.accountId===t)},addTransaction(t){const e={...t,id:Date.now().toString()};OI([...km(),e]);const r=this.getAccountById(t.accountId);if(r){const n=t.type==="debit"?t.debitAmount:-t.creditAmount;this.updateAccount(t.accountId,{balance:r.balance+n})}return e},getTotalByType(t){return Jo().filter(e=>e.type===t&&e.isActive).reduce((e,r)=>e+r.balance,0)},getAccountCategories(t){const e=this.getAccountsByType(t);return[...new Set(e.map(r=>r.category))]},getSubAccounts(t){return Jo().filter(e=>e.parentAccountId===t)},getParentAccounts(){return Jo().filter(t=>!t.parentAccountId)},getAccountHierarchy(){const t=this.getParentAccounts();return console.log(this.getSubAccounts("20110")),console.log(t),t.map(e=>({...e,subAccounts:this.getSubAccounts(e?.id)}))},getAccountWithSubAccounts(t){const e=this.getAccountById(t);return e?{...e,subAccounts:this.getSubAccounts(t),parentAccount:e.parentAccountId?this.getAccountById(e.parentAccountId):null}:null},getAccountPath(t){const e=this.getAccountById(t);if(!e)return[];const r=[e];let n=e;for(;n.parentAccountId;){const i=this.getAccountById(n.parentAccountId);if(i)r.unshift(i),n=i;else break}return r},getTotalBalanceWithSubAccounts(t){const e=this.getAccountById(t);if(!e)return 0;const n=this.getSubAccounts(t).reduce((i,o)=>i+this.getTotalBalanceWithSubAccounts(o.id),0);return e.balance+n},canDeleteAccount(t){const e=this.getSubAccounts(t);if(e.length>0)return{canDelete:!1,reason:`Account has ${e.length} sub-account(s). Delete or move sub-accounts first.`};const r=this.getAccountTransactions(t);return r.length>0?{canDelete:!1,reason:`Account has ${r.length} transaction(s). Cannot delete account with transaction history.`}:{canDelete:!0}}};var va=le("<div>"),hd=le("<div> ");const BI=()=>{const{t}=or(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},n={"font-size":"0.875rem",color:"var(--text-muted)"},i=N=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(N),o=xr.getTotalByType("Asset"),s=xr.getTotalByType("Liability"),l=xr.getTotalByType("Equity"),c=xr.getTotalByType("Revenue"),d=xr.getTotalByType("Expense"),u=xr.getAccountsByType("Asset").length,h=xr.getAccountsByType("Liability").length,g=xr.getAccountsByType("Equity").length,m=xr.getAccountsByType("Revenue").length,S=xr.getAccountsByType("Expense").length;return(()=>{var N=va();return p(N,e),a(N,A(Rt,{get title(){return t("dashboard.totalAssets")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var x=va();return a(x,()=>i(o)),ge(b=>p(x,r,b)),x})(),(()=>{var x=hd(),b=x.firstChild;return a(x,u,b),a(x,()=>t("navigation.accounts"),null),ge(K=>p(x,n,K)),x})()]}}),null),a(N,A(Rt,{get title(){return t("dashboard.totalLiabilities")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var x=va();return a(x,()=>i(s)),ge(b=>p(x,r,b)),x})(),(()=>{var x=hd(),b=x.firstChild;return a(x,h,b),a(x,()=>t("navigation.accounts"),null),ge(K=>p(x,n,K)),x})()]}}),null),a(N,A(Rt,{get title(){return t("dashboard.totalEquity")},get subtitle(){return t("accounts.categories.ownersEquity")},get children(){return[(()=>{var x=va();return a(x,()=>i(l)),ge(b=>p(x,r,b)),x})(),(()=>{var x=hd(),b=x.firstChild;return a(x,g,b),a(x,()=>t("navigation.accounts"),null),ge(K=>p(x,n,K)),x})()]}}),null),a(N,A(Rt,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("accounts.categories.operatingRevenue")},get children(){return[(()=>{var x=va();return a(x,()=>i(c)),ge(b=>p(x,r,b)),x})(),(()=>{var x=hd(),b=x.firstChild;return a(x,m,b),a(x,()=>t("navigation.accounts"),null),ge(K=>p(x,n,K)),x})()]}}),null),a(N,A(Rt,{get title(){return t("dashboard.totalExpenses")},get subtitle(){return t("accounts.categories.operatingExpenses")},get children(){return[(()=>{var x=va();return a(x,()=>i(d)),ge(b=>p(x,r,b)),x})(),(()=>{var x=hd(),b=x.firstChild;return a(x,S,b),a(x,()=>t("navigation.accounts"),null),ge(K=>p(x,n,K)),x})()]}}),null),a(N,A(Rt,{get title(){return t("dashboard.netIncome")},get subtitle(){return`${t("dashboard.totalRevenue")} - ${t("dashboard.totalExpenses")}`},get children(){return[(()=>{var x=va();return a(x,()=>i(c-d)),ge(b=>p(x,{...r,color:c-d>=0?"#4caf50":"#f44336"},b)),x})(),(()=>{var x=va();return a(x,()=>c-d>=0?t("dashboard.netIncome"):t("dashboard.netLoss")),ge(b=>p(x,n,b)),x})()]}}),null),N})()};var VI=le("<div><div></div><div>"),jI=le("<h3>"),pd=le("<div>");const zI=t=>{const{t:e}=or();$f();const r={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},i={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"},o={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},s={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},l={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem"},c={"font-size":"0.875rem",color:"var(--text-secondary)","line-height":"1.4"},d=g=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[g]||{bg:"#f5f5f5",color:"#666"},u=g=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(g),h=d(t.account.accountType);return A(Rt,{get children(){return[(()=>{var g=VI(),m=g.firstChild,S=m.nextSibling;return p(g,n),p(m,i),a(m,()=>t.account.accountNumber),a(S,()=>e(`accounts.types.${t.account.accountType.toLowerCase()}`)),ge(N=>p(S,{...o,background:h.bg,color:h.color},N)),g})(),(()=>{var g=jI();return g.style.setProperty("margin","0 0 0.5rem 0"),g.style.setProperty("font-size","1.1rem"),a(g,()=>t.account.name),g})(),(()=>{var g=pd();return p(g,l),a(g,()=>t.account.category),g})(),(()=>{var g=pd();return p(g,s),a(g,()=>u(t.account.balance)),g})(),(()=>{var g=pd();return p(g,c),a(g,()=>t.account.description),g})(),ke(()=>ke(()=>!t.account.isActive)()&&(()=>{var g=pd();return g.style.setProperty("margin-top","0.5rem"),g.style.setProperty("padding","0.25rem 0.75rem"),g.style.setProperty("border-radius","9999px"),g.style.setProperty("font-size","0.75rem"),g.style.setProperty("font-weight","500"),g.style.setProperty("background","#ffebee"),g.style.setProperty("color","#d32f2f"),g.style.setProperty("text-align","center"),a(g,()=>e("common.inactive")),g})()),(()=>{var g=pd();return p(g,r),a(g,A(ct,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.account),get children(){return[ke(()=>e("common.view"))," ",ke(()=>e("accounts.accountDetails"))]}})),g})()]}})};var qI=le("<div><div></div><div>"),UI=le("<div><div><div><div></div><h3>"),HI=le("<div>"),GI=le("<button>"),WI=le("<div><h4> (<!>)"),YI=le("<div><div><div></div><div> • </div></div><div>");const KI=t=>{const{t:e}=or(),r=$f(),[n,i]=Se(!0),o={"margin-bottom":"1rem"},s={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},l={display:"flex","align-items":"center",gap:"1rem"},c={background:"none",border:"none",cursor:"pointer","font-size":"1.2rem",color:"var(--text-muted)",padding:"0.25rem","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease"},d={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},u={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},h={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},g={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},m={"margin-left":"1rem","border-left":"2px solid var(--border-color)","padding-left":"1rem","margin-top":"1rem"},S={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem","margin-bottom":"0.5rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},N={flex:"1"},x={"font-weight":"500","margin-bottom":"0.25rem"},b={"font-size":"0.875rem",color:"var(--text-muted)"},K={"font-weight":"600",color:"var(--primary-color)"},te={display:"flex",gap:"0.5rem"},F=M=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[M]||{bg:"#f5f5f5",color:"#666"},V=M=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(M),W=M=>{t.onViewDetails?t.onViewDetails(M):r(`/accounts/${M.id}`)},I=()=>{t.onAddSubAccount&&t.onAddSubAccount(t.account)},E=t.account.balance+t.account.subAccounts.reduce((M,P)=>M+P.balance,0),L=F(t.account.accountType);return A(Rt,{className:"account-hierarchy-card",style:o,get children(){return[(()=>{var M=UI(),P=M.firstChild,w=P.firstChild,v=w.firstChild,j=v.nextSibling;return p(M,s),p(P,l),a(P,(()=>{var z=ke(()=>t.account.subAccounts.length>0);return()=>z()&&(()=>{var T=GI();return T.addEventListener("mouseleave",R=>R.target.style.background="none"),T.addEventListener("mouseenter",R=>R.target.style.background="var(--background-color)"),T.$$click=()=>i(!n()),p(T,c),a(T,()=>n()?"▼":"▶"),T})()})(),w),w.$$click=()=>W(t.account),w.style.setProperty("cursor","pointer"),p(v,d),a(v,()=>t.account.accountNumber),p(j,u),a(j,()=>t.account.name),a(M,A(Me,{get when(){return t?.account?.accountType},get children(){var z=qI(),T=z.firstChild,R=T.nextSibling;return z.style.setProperty("text-align","right"),p(T,h),a(T,()=>V(E||0)),a(R,()=>e(`accounts.types.${t?.account?.accountType?.toLowerCase()}`)),ge(J=>p(R,{...g,background:L.bg,color:L.color},J)),z}}),null),M})(),(()=>{var M=HI();return p(M,te),a(M,A(ct,{variant:"secondary",size:"sm",onClick:()=>W(t.account),get children(){return[ke(()=>e("common.view"))," ",ke(()=>e("accounts.accountDetails"))]}}),null),a(M,A(ct,{variant:"outline",size:"sm",onClick:I,get children(){return[ke(()=>e("common.add"))," ",ke(()=>e("accounts.subAccounts"))]}}),null),M})(),ke(()=>ke(()=>!!(n()&&t.account.subAccounts.length>0))()&&(()=>{var M=WI(),P=M.firstChild,w=P.firstChild,v=w.nextSibling;return v.nextSibling,p(M,m),P.style.setProperty("margin","0 0 1rem 0"),P.style.setProperty("font-size","1rem"),P.style.setProperty("color","var(--text-muted)"),a(P,()=>e("accounts.subAccounts"),w),a(P,()=>t.account.subAccounts.length,v),a(M,()=>t.account.subAccounts.map(j=>(()=>{var z=YI(),T=z.firstChild,R=T.firstChild,J=R.nextSibling,X=J.firstChild,H=T.nextSibling;return z.addEventListener("mouseleave",se=>{se.currentTarget.style.background="var(--background-color)",se.currentTarget.style.transform="translateY(0)"}),z.addEventListener("mouseenter",se=>{se.currentTarget.style.background="var(--surface-color)",se.currentTarget.style.transform="translateY(-1px)"}),z.$$click=()=>W(j),p(z,S),p(T,N),p(R,x),a(R,()=>j.name),p(J,b),a(J,()=>j.accountNumber,X),a(J,()=>j.description,null),p(H,K),a(H,()=>V(j.balance)),z})()),null),M})())]}})};Wt(["click"]);var QI=le("<form><div>");const JI=t=>{const{t:e}=or(),[r,n]=Se({accountNumber:"",name:"",accountType:"",category:"",type:"",classification:"",description:"",balance:"0",isActive:"true"}),i=[{value:"Asset",label:e("accounts.types.asset"),type:"debit",classification:"real"},{value:"Liability",label:e("accounts.types.liability"),type:"credit",classification:"real"},{value:"Equity",label:e("accounts.types.equity"),type:"credit",classification:"real"},{value:"Revenue",label:e("accounts.types.revenue"),type:"credit",classification:"nominal"},{value:"Expense",label:e("accounts.types.expense"),type:"debit",classification:"nominal"}],o=()=>{const u=r().accountType;return u?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")},{value:"Sales Revenue",label:e("accounts.categories.salesRevenue")},{value:"Service Revenue",label:e("accounts.categories.servicesRevenue")},{value:"Subscription Revenue",label:e("accounts.categories.subscriptionRevenue")},{value:"Rental Revenue",label:e("accounts.categories.rentalRevenue")},{value:"Commission Revenue",label:e("accounts.categories.commissionRevenue")},{value:"Franchise Revenue",label:e("accounts.categories.franchiseRevenue")},{value:"Licensing Revenue",label:e("accounts.categories.licensingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[u]||[]:[]},s=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],l={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},c=u=>{u.preventDefault();const h=r();if(!h.accountNumber||!h.name||!h.accountType||!h.category){alert(e("forms.requiredField"));return}const g=xr.accounts.find(N=>N.accountNumber===h.accountNumber),m=i.find(N=>N.value===h.accountType);if(g){alert(e("forms.duplicateAccountNumber"));return}const S={accountNumber:h.accountNumber,code:h.accountNumber,name:h.name,accountType:"",classification:m?.classification,type:m?.type,category:h.category,description:h.description,balance:parseFloat(h.balance)||0,isActive:h.isActive==="true"};xr.addAccount(S),n({accountNumber:"",name:"",accountType:"",type:"",category:"",description:"",classification:"",balance:"0",isActive:"true"}),t.onClose()},d=(u,h)=>{n(g=>{const m={...g,[u]:h};return u==="type"&&(m.category=""),m})};return A(Bn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.addAccount")},get children(){var u=QI(),h=u.firstChild;return u.addEventListener("submit",c),a(u,A(Lt,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:g=>d("accountNumber",g),get placeholder(){return e("accounts.accountNumber")},required:!0}),h),a(u,A(Lt,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:g=>d("name",g),get placeholder(){return e("accounts.accountName")},required:!0}),h),a(u,A(en,{get label(){return e("accounts.accountType")},get value(){return r().accountType},onChange:g=>d("accountType",g),options:i,required:!0}),h),a(u,A(en,{get label(){return e("accounts.category")},get value(){return r().category},onChange:g=>d("category",g),get options(){return o()},required:!0}),h),a(u,A(Lt,{get label(){return e("common.description")},get value(){return r().description},onChange:g=>d("description",g),get placeholder(){return e("common.description")}}),h),a(u,A(Lt,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:g=>d("balance",g),get placeholder(){return e("accounts.balance")}}),h),a(u,A(en,{get label(){return e("common.status")},get value(){return r().isActive},onChange:g=>d("isActive",g),options:s,required:!0}),h),p(h,l),a(h,A(ct,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(h,A(ct,{variant:"primary",type:"submit",get children(){return e("accounts.addAccount")}}),null),u}})};var XI=le("<form><div>"),ZI=le("<div><div></div><div> - </div><div> • ");const eT=t=>{const{t:e}=or(),[r,n]=Se({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"});e("accounts.types.asset"),e("accounts.types.liability"),e("accounts.types.equity"),e("accounts.types.revenue"),e("accounts.types.expense");const i=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],o={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},s={background:"var(--background-color)",padding:"1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1.5rem",border:"1px solid var(--border-color)"},l={"font-size":"0.875rem","font-weight":"500",color:"var(--text-muted)","margin-bottom":"0.5rem"},c={"font-weight":"600",color:"var(--text-primary)"},d={"font-size":"0.875rem",color:"var(--text-secondary)"},u=S=>{S.preventDefault();const N=r();if(console.log(N),!N.accountNumber||!N.name||!t.parentAccount){alert(e("forms.requiredField"));return}const x=xr.accounts.find(K=>K.accountNumber===N.accountNumber);if(console.log(x),x){alert(e("forms.duplicateAccountNumber"));return}const b={accountNumber:N.accountNumber,code:N.accountNumber,name:N.name,description:N.description,accountType:t.parentAccount.accountType,category:t.parentAccount.category,classification:t.parentAccount?.classification,type:t.parentAccount?.type,isActive:N.isActive==="true",parentAccountId:t.parentAccount.id,parentAccountNumber:t.parentAccount.accountId};xr.addAccount(b),n({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},h=(S,N)=>{n(x=>({...x,[S]:N}))},g=()=>{if(!t.parentAccount)return"";const S=t.parentAccount.accountNumber,x=xr.getSubAccounts(t.parentAccount.id).length+1;return(parseInt(S)+x).toString()},m=()=>r().accountNumber===""&&t.parentAccount?g():r().accountNumber;return A(Bn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return`${e("common.add")} ${e("accounts.subAccounts")}`},get children(){return[ke(()=>ke(()=>!!t.parentAccount)()&&(()=>{var S=ZI(),N=S.firstChild,x=N.nextSibling,b=x.firstChild,K=x.nextSibling,te=K.firstChild;return p(S,s),p(N,l),a(N,()=>e("accounts.parentAccount")),p(x,c),a(x,()=>t.parentAccount.accountNumber,b),a(x,()=>t.parentAccount.name,null),p(K,d),a(K,()=>e(`accounts.types.${t.parentAccount?.accountType?.toLowerCase()}`),te),a(K,()=>t.parentAccount.category,null),S})()),(()=>{var S=XI(),N=S.firstChild;return S.addEventListener("submit",u),a(S,A(Lt,{get label(){return e("accounts.accountNumber")},get value(){return m()},onChange:x=>h("accountNumber",x),get placeholder(){return`${e("common.suggested")}: ${g()}`},required:!0}),N),a(S,A(Lt,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:x=>h("name",x),get placeholder(){return e("accounts.accountName")},required:!0}),N),a(S,A(Lt,{get label(){return e("common.description")},get value(){return r().description},onChange:x=>h("description",x),get placeholder(){return e("common.description")}}),N),a(S,A(Lt,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:x=>h("balance",x),get placeholder(){return e("accounts.balance")}}),N),a(S,A(en,{get label(){return e("common.status")},get value(){return r().isActive},onChange:x=>h("isActive",x),options:i,required:!0}),N),p(N,o),a(N,A(ct,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(N,A(ct,{variant:"primary",type:"submit",get children(){return[ke(()=>e("common.add"))," ",ke(()=>e("accounts.subAccounts"))]}}),null),S})()]}})};var tT=le("<form><div>"),rT=le("<div>");const nT=t=>{const{t:e}=or(),[r,n]=Se({accountNumber:"",name:"",type:"",accountType:"",category:"",description:"",isActive:"true"}),[i,o]=Se(null);Un(()=>{t.account&&(console.log(t.account),n({accountNumber:t.account.accountNumber,name:t.account.name,type:t.account.type,accountType:t.account.accountType,category:t.account.category,description:t.account.description,isActive:t.account.isActive.toString()}),o(null))});const s=[{value:"Asset",label:e("accounts.types.asset")},{value:"Liability",label:e("accounts.types.liability")},{value:"Equity",label:e("accounts.types.equity")},{value:"Revenue",label:e("accounts.types.revenue")},{value:"Expense",label:e("accounts.types.expense")}],l=()=>{const m=r().accountType;return m?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[m]||[]:[]},c=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],d={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},u=m=>{if(m.preventDefault(),o(null),!t.account)return;const S=r();if(!S.accountNumber||!S.name||!S.type||!S.category){o(e("forms.requiredField"));return}if(xr.accounts.find(K=>K.accountNumber===S.accountNumber&&K.id!==t.account.id)){o(e("forms.duplicateAccountNumber"));return}const x={accountNumber:S.accountNumber,name:S.name,type:S.type,accountType:S.accountType,category:S.category,description:S.description,isActive:S.isActive==="true"};console.log({data:S,updatedAccount:x});let b=Jb(Object.keys(t.account),x,t.account,{accountId:1,id:1});try{xr.updateAccountServer(t.account?.accountId,b.data),t.onClose()}catch(K){o(K instanceof Error?K.message:e("forms.saveError"))}},h=()=>{if(!t.account)return;const m=xr.canDeleteAccount(t.account.id);if(!m.canDelete){o(m.reason||e("forms.deleteError"));return}const S=e("forms.confirmDelete");if(confirm(S))try{xr.deleteAccount(t.account.id),t.onClose()}catch(N){o(N instanceof Error?N.message:e("forms.deleteError"))}},g=(m,S)=>{n(N=>{const x={...N,[m]:S};return m==="type"&&(x.category=""),x}),i()&&o(null)};return t.account?A(Bn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.editAccount")},get children(){var m=tT(),S=m.firstChild;return m.addEventListener("submit",u),a(m,A(Lt,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:N=>g("accountNumber",N),get placeholder(){return e("accounts.accountNumber")},required:!0}),S),a(m,A(Lt,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:N=>g("name",N),get placeholder(){return e("accounts.accountName")},required:!0}),S),a(m,A(en,{get label(){return e("accounts.accountType")},get value(){return r().accountType},onChange:N=>g("accountType",N),options:s,required:!0}),S),a(m,A(en,{get label(){return e("accounts.category")},get value(){return r().category},onChange:N=>g("category",N),get options(){return l()},required:!0}),S),a(m,A(Lt,{get label(){return e("common.description")},get value(){return r().description},onChange:N=>g("description",N),get placeholder(){return e("common.description")}}),S),a(m,A(en,{get label(){return e("common.status")},get value(){return r().isActive},onChange:N=>g("isActive",N),options:c,required:!0}),S),a(m,(()=>{var N=ke(()=>!!i());return()=>N()&&(()=>{var x=rT();return x.style.setProperty("padding","1rem"),x.style.setProperty("border-radius","var(--border-radius-sm)"),x.style.setProperty("margin-top","1rem"),x.style.setProperty("background","#f8d7da"),x.style.setProperty("color","#721c24"),x.style.setProperty("border","1px solid #f5c6cb"),a(x,i),x})()})(),S),p(S,d),a(S,A(ct,{variant:"outline",type:"button",onClick:h,style:{color:"#dc3545","border-color":"#dc3545","margin-right":"auto"},get children(){return e("accounts.deleteAccount")}}),null),a(S,A(ct,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(S,A(ct,{variant:"primary",type:"submit",get children(){return e("common.save")}}),null),m}}):null};var iT=le("<div><div>⚠️</div><div></div><div></div><div>"),Ju=le("<div>"),oT=le("<div><div></div><div>"),sT=le("<div><button></button><button> (<!>)"),aT=le("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),lT=le("<div><div><div></div><div> • </div></div><div>");const cT=t=>{const{t:e}=or(),[r,n]=Se("details"),[i,o]=Se(!1),s=Nt(()=>t.account?xr.getAccountById(t.account.id)||t.account:null),l={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},c={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},d={"font-weight":"600",color:"var(--text-primary)"},u={"text-align":"center","margin-bottom":"2rem"},h={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},g={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},m={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem"},S={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},N=M=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:M?"var(--primary-color)":"var(--text-muted)","border-bottom":M?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),x={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},b={flex:"1"},K={"font-size":"0.875rem",color:"var(--text-muted)"},te={"font-weight":"500","margin-bottom":"0.25rem"},F=M=>({"font-weight":"600",color:M==="debit"?"#4caf50":"#f44336"}),V={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},W=M=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[M]||{bg:"#f5f5f5",color:"#666"},I=M=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(M),E=M=>new Date(M).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),L=M=>{xr.deleteAccount(s()?.accountId),t.onClose()};return A(Bn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.accountDetails")},get children(){return[ke(()=>ke(()=>!s())()?(()=>{var M=iT(),P=M.firstChild,w=P.nextSibling,v=w.nextSibling,j=v.nextSibling;return M.style.setProperty("text-align","center"),M.style.setProperty("padding","3rem"),M.style.setProperty("color","var(--text-muted)"),P.style.setProperty("font-size","1.5rem"),P.style.setProperty("margin-bottom","1rem"),w.style.setProperty("font-size","1.1rem"),w.style.setProperty("margin-bottom","0.5rem"),a(w,()=>e("common.error")),v.style.setProperty("font-size","0.875rem"),a(v,()=>e("common.noDataFound")),j.style.setProperty("margin-top","2rem"),a(j,A(ct,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),M})():(()=>{const M=Nt(()=>W(s().accountType)),P=Nt(()=>xr.getAccountTransactions(s().id));return[(()=>{var w=oT(),v=w.firstChild,j=v.nextSibling;return p(w,u),p(v,h),a(v,()=>s().name),p(j,g),a(j,()=>I(s().balance||0)),a(w,A(Me,{get when(){return s().accountType},get children(){var z=Ju();return a(z,()=>e(`accounts.types.${s().accountType?.toLowerCase()}`)),ge(T=>p(z,{...m,background:M().bg,color:M().color},T)),z}}),null),w})(),(()=>{var w=sT(),v=w.firstChild,j=v.nextSibling,z=j.firstChild,T=z.nextSibling;return T.nextSibling,p(w,S),v.$$click=()=>n("details"),a(v,()=>e("accounts.accountDetails")),j.$$click=()=>n("transactions"),a(j,()=>e("accounts.transactions"),z),a(j,()=>P().length,T),ge(R=>{var J=N(r()==="details"),X=N(r()==="transactions");return R.e=p(v,J,R.e),R.t=p(j,X,R.t),R},{e:void 0,t:void 0}),w})(),ke(()=>ke(()=>r()==="details")()&&(()=>{var w=aT(),v=w.firstChild,j=v.firstChild,z=j.nextSibling,T=v.nextSibling,R=T.firstChild,J=R.nextSibling,X=T.nextSibling,H=X.firstChild,se=H.nextSibling,O=X.nextSibling,_=O.firstChild,k=_.nextSibling,$=O.nextSibling,G=$.firstChild,ne=G.nextSibling,U=$.nextSibling,D=U.firstChild,B=D.nextSibling;return a(j,()=>e("accounts.accountNumber")),a(z,()=>s().accountNumber),a(R,()=>e("accounts.category")),a(J,()=>s().category),a(H,()=>e("common.description")),a(se,()=>s().description),a(_,()=>e("common.status")),a(k,(()=>{var Q=ke(()=>!!s().isActive);return()=>Q()?e("common.active"):e("common.inactive")})()),a(G,()=>e("accounts.createdDate")),a(ne,()=>E(s().createdDate)),a(D,()=>e("accounts.lastModified")),a(B,()=>E(s().lastModified)),ge(Q=>{var Z=l,oe=c,de=d,re=l,Y=c,ce=d,ue=l,ae=c,ye=d,me=l,pe=c,ve=d,Ne=l,Ie=c,Ce=d,Ee=l,we=c,Re=d;return Q.e=p(v,Z,Q.e),Q.t=p(j,oe,Q.t),Q.a=p(z,de,Q.a),Q.o=p(T,re,Q.o),Q.i=p(R,Y,Q.i),Q.n=p(J,ce,Q.n),Q.s=p(X,ue,Q.s),Q.h=p(H,ae,Q.h),Q.r=p(se,ye,Q.r),Q.d=p(O,me,Q.d),Q.l=p(_,pe,Q.l),Q.u=p(k,ve,Q.u),Q.c=p($,Ne,Q.c),Q.w=p(G,Ie,Q.w),Q.m=p(ne,Ce,Q.m),Q.f=p(U,Ee,Q.f),Q.y=p(D,we,Q.y),Q.g=p(B,Re,Q.g),Q},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),w})()),ke(()=>ke(()=>r()==="transactions")()&&(()=>{var w=Ju();return a(w,(()=>{var v=ke(()=>P().length===0);return()=>v()?(()=>{var j=Ju();return j.style.setProperty("text-align","center"),j.style.setProperty("color","var(--text-muted)"),j.style.setProperty("padding","2rem"),a(j,()=>e("common.noDataFound")),j})():P().map(j=>(()=>{var z=lT(),T=z.firstChild,R=T.firstChild,J=R.nextSibling,X=J.firstChild,H=T.nextSibling;return p(z,x),p(T,b),p(R,te),a(R,()=>j.description),p(J,K),a(J,()=>E(j.date),X),a(J,()=>j.reference,null),a(H,()=>j.type==="debit"?"+":"-",null),a(H,()=>I(j.type==="debit"?j.debitAmount:j.creditAmount),null),ge(se=>p(H,F(j.type),se)),z})())})()),w})()),(()=>{var w=Ju();return p(w,V),a(w,A(ct,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),a(w,A(ct,{variant:"primary",onClick:()=>o(!0),get children(){return e("accounts.editAccount")}}),null),a(w,A(Me,{get when(){return Gt.state?.profile?.isAdmin},get children(){return A(ct,{variant:"primary",onClick:L,children:"Remove"})}}),null),w})()]})()),ke(()=>ke(()=>!!s())()&&A(nT,{get isOpen(){return i()},onClose:()=>{o(!1)},get account(){return s()}}))]}})};Wt(["click"]);var dT=le("<div><h2></h2><div><span>:</span><button></button><button>"),uT=le("<div><span>:"),Y0=le("<div>"),hT=le("<button>");const pT=()=>{const{t}=or(),[e,r]=Se(!1),[n,i]=Se(!1),[o,s]=Se(!1),[l,c]=Se(null),[d,u]=Se(null),[h,g]=Se("All"),[m,S]=Se("hierarchy"),N=L=>{c(L),s(!0)},x=L=>{u(L),i(!0)},b=()=>h()==="All"?m()==="hierarchy"?xr.getAccountHierarchy():xr.accounts:m()==="hierarchy"?xr.getAccountHierarchy().filter(L=>L.accountType===h()):xr.getAccountsByType(h()),K={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},te={display:"flex",gap:"1rem","margin-bottom":"2rem","align-items":"center"},F=L=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:L?"var(--primary-color)":"var(--surface-color)",color:L?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500",transition:"all 0.2s ease"}),V={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},W={display:"flex",gap:"0.5rem","align-items":"center","margin-left":"auto","margin-right":"1rem"},I=L=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:L?"var(--primary-color)":"var(--surface-color)",color:L?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),E=async()=>{let L=await Fd.getAlls("acc");xr.updAccount(Object.values(L))};return Ln(()=>{E()}),A(oo,{get title(){return t("accounts.title")},get children(){return[A(BI,{}),(()=>{var L=dT(),M=L.firstChild,P=M.nextSibling,w=P.firstChild,v=w.firstChild,j=w.nextSibling,z=j.nextSibling;return p(L,V),M.style.setProperty("margin","0"),M.style.setProperty("font-size","1.5rem"),a(M,()=>t("accounts.title")),p(P,W),w.style.setProperty("font-weight","500"),w.style.setProperty("color","var(--text-muted)"),w.style.setProperty("font-size","0.875rem"),a(w,()=>t("common.view"),v),j.$$click=()=>S("hierarchy"),a(j,()=>t("accounts.accountHierarchy")),z.$$click=()=>{S("flat"),Fd.getAlls("iDP")},a(z,()=>t("common.all")),a(L,A(ct,{variant:"primary",onClick:()=>r(!0),get children(){return t("accounts.addAccount")}}),null),ge(T=>{var R=I(m()==="hierarchy"),J=I(m()==="flat");return T.e=p(j,R,T.e),T.t=p(z,J,T.t),T},{e:void 0,t:void 0}),L})(),(()=>{var L=uT(),M=L.firstChild,P=M.firstChild;return p(L,te),M.style.setProperty("font-weight","500"),M.style.setProperty("color","var(--text-muted)"),a(M,()=>t("common.filter"),P),a(L,()=>[t("common.all"),t("accounts.types.asset"),t("accounts.types.liability"),t("accounts.types.equity"),t("accounts.types.revenue"),t("accounts.types.expense")].map((w,v)=>{const z=["All","Asset","Liability","Equity","Revenue","Expense"][v];return(()=>{var T=hT();return T.$$click=()=>g(z),a(T,w),ge(R=>p(T,F(h()===z),R)),T})()}),null),L})(),(()=>{var L=Y0();return a(L,(()=>{var M=ke(()=>m()==="hierarchy");return()=>M()?b().map(P=>A(KI,{account:P,onAddSubAccount:x,onViewDetails:N})):b().map(P=>A(zI,{account:P,onViewDetails:N}))})()),ge(M=>p(L,m()==="hierarchy"?{display:"flex","flex-direction":"column",gap:"1rem"}:K,M)),L})(),ke(()=>ke(()=>b().length===0)()&&(()=>{var L=Y0();return L.style.setProperty("text-align","center"),L.style.setProperty("color","var(--text-muted)"),L.style.setProperty("padding","3rem"),L.style.setProperty("font-size","1.1rem"),a(L,()=>t("common.noDataFound")),L})()),A(JI,{get isOpen(){return e()},onClose:()=>r(!1)}),A(eT,{get isOpen(){return n()},onClose:()=>i(!1),get parentAccount(){return d()}}),A(cT,{get isOpen(){return o()},onClose:()=>s(!1),get account(){return l()}})]}})};Wt(["click"]);var mT=le("<div><h2>"),sc=le("<div>"),yT=le("<div><div><div></div><h1></h1><div></div></div><div>"),fT=le("<div><button></button><button> (<!>)"),Xu=le("<div><span></span><span>"),gT=le("<p>"),vT=le("<div><div></div><div>"),bT=le("<div><div><div></div><div> • </div></div><div>");const PT=()=>{const{t}=or(),e=rw(),r=$f(),[n,i]=Se(null),[o,s]=Se("overview");Ln(()=>{const v=xr.getAccountById(e.id);v?i(v):r("/accounts")});const l={display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"1rem"},c={display:"flex","align-items":"center",gap:"1rem","margin-bottom":"2rem"},d={"font-size":"1rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},u={"font-size":"2.5rem","font-weight":"700",color:"var(--primary-color)"},h={padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},g={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},m=v=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:v?"var(--primary-color)":"var(--text-muted)","border-bottom":v?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),S={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},N={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},x={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},b={"font-weight":"500",color:"var(--text-muted)"},K={"font-weight":"600",color:"var(--text-primary)"},te={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},F={flex:"1"},V={"font-weight":"500","margin-bottom":"0.25rem"},W={"font-size":"0.875rem",color:"var(--text-muted)"},I=v=>({"font-weight":"600",color:v==="debit"?"#4caf50":"#f44336"});if(!n())return A(oo,{get title(){return t("accounts.accountDetails")},get children(){var v=mT(),j=v.firstChild;return v.style.setProperty("text-align","center"),v.style.setProperty("padding","3rem"),a(j,()=>t("common.error")),a(v,A(ct,{variant:"primary",onClick:()=>r("/accounts"),get children(){return[ke(()=>t("common.back"))," ",ke(()=>t("navigation.accounts"))]}}),null),v}});const E=v=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[v]||{bg:"#f5f5f5",color:"#666"},L=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(v),M=v=>new Date(v).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),P=E(n().accountType),w=xr.getAccountTransactions(n().id);return A(oo,{get title(){return n().name},get children(){return[(()=>{var v=sc();return p(v,l),a(v,A(ct,{variant:"secondary",onClick:()=>r("/accounts"),get children(){return["← ",ke(()=>t("common.back"))," ",ke(()=>t("navigation.accounts"))]}})),v})(),(()=>{var v=yT(),j=v.firstChild,z=j.firstChild,T=z.nextSibling,R=T.nextSibling,J=j.nextSibling;return p(v,c),p(z,d),a(z,()=>n().accountNumber),T.style.setProperty("margin","0.5rem 0"),T.style.setProperty("font-size","2rem"),a(T,()=>n().name),p(R,u),a(R,()=>L(n().balance)),a(J,()=>n().accountType),ge(X=>p(J,{...h,background:P.bg,color:P.color},X)),v})(),(()=>{var v=fT(),j=v.firstChild,z=j.nextSibling,T=z.firstChild,R=T.nextSibling;return R.nextSibling,p(v,g),j.$$click=()=>s("overview"),a(j,()=>t("dashboard.overview")),z.$$click=()=>s("transactions"),a(z,()=>t("accounts.transactions"),T),a(z,()=>w.length,R),ge(J=>{var X=m(o()==="overview"),H=m(o()==="transactions");return J.e=p(j,X,J.e),J.t=p(z,H,J.t),J},{e:void 0,t:void 0}),v})(),ke(()=>ke(()=>o()==="overview")()&&(()=>{var v=vT(),j=v.firstChild,z=j.nextSibling;return p(j,S),a(j,A(Rt,{get title(){return t("accounts.balance")},get subtitle(){return t("dashboard.overview")},get children(){var T=sc();return T.style.setProperty("font-size","1.5rem"),T.style.setProperty("font-weight","600"),T.style.setProperty("color","var(--primary-color)"),a(T,()=>L(n().balance)),T}}),null),a(j,A(Rt,{get title(){return t("accounts.accountType")},get subtitle(){return t("accounts.category")},get children(){var T=sc();return T.style.setProperty("font-size","1.5rem"),T.style.setProperty("font-weight","600"),T.style.setProperty("color","var(--primary-color)"),a(T,()=>t(`accounts.types.${n().accountType?.toLowerCase()}`)),T}}),null),a(j,A(Rt,{get title(){return t("common.status")},get subtitle(){return t("accounts.accountDetails")},get children(){var T=sc();return T.style.setProperty("font-size","1.5rem"),T.style.setProperty("font-weight","600"),a(T,(()=>{var R=ke(()=>!!n().isActive);return()=>R()?t("common.active"):t("common.inactive")})()),ge(R=>(R=n().isActive?"#4caf50":"#f44336")!=null?T.style.setProperty("color",R):T.style.removeProperty("color")),T}}),null),a(j,A(Rt,{get title(){return t("accounts.transactions")},get subtitle(){return t("common.total")},get children(){var T=sc();return T.style.setProperty("font-size","1.5rem"),T.style.setProperty("font-weight","600"),T.style.setProperty("color","var(--primary-color)"),a(T,()=>w.length),T}}),null),p(z,N),a(z,A(Rt,{get title(){return t("accounts.accountDetails")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var T=Xu(),R=T.firstChild,J=R.nextSibling;return a(R,()=>t("accounts.accountNumber")),a(J,()=>n().accountNumber),ge(X=>{var H=x,se=b,O=K;return X.e=p(T,H,X.e),X.t=p(R,se,X.t),X.a=p(J,O,X.a),X},{e:void 0,t:void 0,a:void 0}),T})(),(()=>{var T=Xu(),R=T.firstChild,J=R.nextSibling;return a(R,()=>t("accounts.category")),a(J,()=>n().category),ge(X=>{var H=x,se=b,O=K;return X.e=p(T,H,X.e),X.t=p(R,se,X.t),X.a=p(J,O,X.a),X},{e:void 0,t:void 0,a:void 0}),T})(),(()=>{var T=Xu(),R=T.firstChild,J=R.nextSibling;return a(R,()=>t("common.date")),a(J,()=>M(n().createdDate)),ge(X=>{var H=x,se=b,O=K;return X.e=p(T,H,X.e),X.t=p(R,se,X.t),X.a=p(J,O,X.a),X},{e:void 0,t:void 0,a:void 0}),T})(),(()=>{var T=Xu(),R=T.firstChild,J=R.nextSibling;return a(R,()=>t("common.date")),a(J,()=>M(n().lastModified)),ge(X=>{var H=x,se=b,O=K;return X.e=p(T,H,X.e),X.t=p(R,se,X.t),X.a=p(J,O,X.a),X},{e:void 0,t:void 0,a:void 0}),T})()]}}),null),a(z,A(Rt,{get title(){return t("common.description")},get subtitle(){return t("accounts.accountDetails")},get children(){var T=gT();return T.style.setProperty("margin","0"),T.style.setProperty("color","var(--text-secondary)"),a(T,()=>n().description||t("common.noDataFound")),T}}),null),v})()),ke(()=>ke(()=>o()==="transactions")()&&A(Rt,{get title(){return t("accounts.accountHistory")},get subtitle(){return t("accounts.transactions")},get children(){return ke(()=>w.length===0)()?(()=>{var v=sc();return v.style.setProperty("text-align","center"),v.style.setProperty("color","var(--text-muted)"),v.style.setProperty("padding","2rem"),a(v,()=>t("common.noDataFound")),v})():w.map(v=>(()=>{var j=bT(),z=j.firstChild,T=z.firstChild,R=T.nextSibling,J=R.firstChild,X=z.nextSibling;return p(j,te),p(z,F),p(T,V),a(T,()=>v.description),p(R,W),a(R,()=>M(v.date),J),a(R,()=>v.reference,null),a(X,()=>v.type==="debit"?"+":"-",null),a(X,()=>L(v.type==="debit"?v.debitAmount:v.creditAmount),null),ge(H=>p(X,I(v.type),H)),j})())}}))]}})};Wt(["click"]);var _T=le("<div><div><h1></h1><p> </p></div><div><input type=date>"),$s=le("<div><span></span><span>"),ST=le("<div><div></div><div>"),wT=le("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),xT=le("<div><div> (<!> = <!> + <!>)</div><div> = "),CT=le("<span>(<!>: <!>)");const AT=()=>{const{t}=or(),[e,r]=Se(new Date().toISOString().split("T")[0]),[n,i]=Se(0),[o,s]=Se(0),[l,c]=Se(0);Ln(()=>{d()});const d=()=>{const S=xr.getAccountsByType("Asset"),N=xr.getAccountsByType("Liability"),x=xr.getAccountsByType("Equity"),b=S.reduce((F,V)=>F+V.balance,0),K=N.reduce((F,V)=>F+V.balance,0),te=x.reduce((F,V)=>F+V.balance,0);i(b),s(K),c(te)},u=S=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(S),h={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},g={"margin-bottom":"2rem"},m={"font-weight":"bold","font-size":"1.1rem","border-top":"2px solid var(--border-color)","padding-top":"0.5rem","margin-top":"1rem"};return A(oo,{get title(){return t("balanceSheet.title")},get children(){return[(()=>{var S=_T(),N=S.firstChild,x=N.firstChild,b=x.nextSibling,K=b.firstChild,te=N.nextSibling,F=te.firstChild;return p(S,h),x.style.setProperty("margin","0"),a(x,()=>t("balanceSheet.title")),b.style.setProperty("margin","0.5rem 0 0 0"),b.style.setProperty("color","var(--text-muted)"),a(b,()=>t("balanceSheet.asOf"),K),a(b,()=>new Date(e()).toLocaleDateString(),null),te.style.setProperty("display","flex"),te.style.setProperty("gap","1rem"),F.addEventListener("change",V=>r(V.target.value)),F.style.setProperty("padding","0.5rem"),F.style.setProperty("border","1px solid var(--border-color)"),F.style.setProperty("border-radius","var(--border-radius-sm)"),a(te,A(ct,{variant:"primary",onClick:d,get children(){return t("balanceSheet.generateReport")}}),null),ge(()=>F.value=e()),S})(),(()=>{var S=ST(),N=S.firstChild,x=N.nextSibling;return S.style.setProperty("display","grid"),S.style.setProperty("grid-template-columns","1fr 1fr"),S.style.setProperty("gap","2rem"),a(N,A(Rt,{get title(){return t("balanceSheet.assets")},style:g,get children(){return[(()=>{var b=$s(),K=b.firstChild,te=K.nextSibling;return b.style.setProperty("display","flex"),b.style.setProperty("justify-content","space-between"),b.style.setProperty("align-items","center"),a(K,()=>t("balanceSheet.currentAssets")),a(te,()=>u(n()*.6)),b})(),(()=>{var b=$s(),K=b.firstChild,te=K.nextSibling;return b.style.setProperty("display","flex"),b.style.setProperty("justify-content","space-between"),b.style.setProperty("align-items","center"),a(K,()=>t("balanceSheet.nonCurrentAssets")),a(te,()=>u(n()*.4)),b})(),(()=>{var b=$s(),K=b.firstChild,te=K.nextSibling;return a(K,()=>t("balanceSheet.totalAssets")),a(te,()=>u(n())),ge(F=>p(b,{...m,display:"flex","justify-content":"space-between"},F)),b})()]}})),a(x,A(Rt,{get title(){return t("balanceSheet.liabilities")},style:g,get children(){return[(()=>{var b=$s(),K=b.firstChild,te=K.nextSibling;return b.style.setProperty("display","flex"),b.style.setProperty("justify-content","space-between"),b.style.setProperty("align-items","center"),a(K,()=>t("balanceSheet.currentLiabilities")),a(te,()=>u(o()*.7)),b})(),(()=>{var b=$s(),K=b.firstChild,te=K.nextSibling;return b.style.setProperty("display","flex"),b.style.setProperty("justify-content","space-between"),b.style.setProperty("align-items","center"),a(K,()=>t("balanceSheet.nonCurrentLiabilities")),a(te,()=>u(o()*.3)),b})(),(()=>{var b=$s(),K=b.firstChild,te=K.nextSibling;return a(K,()=>t("balanceSheet.totalLiabilities")),a(te,()=>u(o())),ge(F=>p(b,{...m,display:"flex","justify-content":"space-between"},F)),b})()]}}),null),a(x,A(Rt,{get title(){return t("balanceSheet.equity")},get children(){return[(()=>{var b=$s(),K=b.firstChild,te=K.nextSibling;return b.style.setProperty("display","flex"),b.style.setProperty("justify-content","space-between"),b.style.setProperty("align-items","center"),a(K,()=>t("balanceSheet.commonStock")),a(te,()=>u(l()*.8)),b})(),(()=>{var b=$s(),K=b.firstChild,te=K.nextSibling;return b.style.setProperty("display","flex"),b.style.setProperty("justify-content","space-between"),b.style.setProperty("align-items","center"),a(K,()=>t("balanceSheet.retainedEarnings")),a(te,()=>u(l()*.2)),b})(),(()=>{var b=$s(),K=b.firstChild,te=K.nextSibling;return a(K,()=>t("balanceSheet.totalEquity")),a(te,()=>u(l())),ge(F=>p(b,{...m,display:"flex","justify-content":"space-between"},F)),b})()]}}),null),S})(),A(Rt,{get title(){return t("dashboard.overview")},style:{"margin-top":"2rem"},get children(){return[(()=>{var S=wT(),N=S.firstChild,x=N.firstChild,b=x.nextSibling,K=N.nextSibling,te=K.firstChild,F=te.nextSibling,V=K.nextSibling,W=V.firstChild,I=W.nextSibling;return S.style.setProperty("display","grid"),S.style.setProperty("grid-template-columns","repeat(3, 1fr)"),S.style.setProperty("gap","2rem"),N.style.setProperty("text-align","center"),x.style.setProperty("font-size","0.875rem"),x.style.setProperty("color","var(--text-muted)"),x.style.setProperty("margin-bottom","0.5rem"),a(x,()=>t("balanceSheet.totalAssets")),b.style.setProperty("font-size","1.5rem"),b.style.setProperty("font-weight","bold"),b.style.setProperty("color","var(--primary-color)"),a(b,()=>u(n())),K.style.setProperty("text-align","center"),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),te.style.setProperty("margin-bottom","0.5rem"),a(te,()=>t("balanceSheet.totalLiabilities")),F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","bold"),F.style.setProperty("color","#f44336"),a(F,()=>u(o())),V.style.setProperty("text-align","center"),W.style.setProperty("font-size","0.875rem"),W.style.setProperty("color","var(--text-muted)"),W.style.setProperty("margin-bottom","0.5rem"),a(W,()=>t("balanceSheet.totalEquity")),I.style.setProperty("font-size","1.5rem"),I.style.setProperty("font-weight","bold"),I.style.setProperty("color","#4caf50"),a(I,()=>u(l())),S})(),(()=>{var S=xT(),N=S.firstChild,x=N.firstChild,b=x.nextSibling,K=b.nextSibling,te=K.nextSibling,F=te.nextSibling,V=F.nextSibling;V.nextSibling;var W=N.nextSibling,I=W.firstChild;return S.style.setProperty("margin-top","2rem"),S.style.setProperty("text-align","center"),N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),N.style.setProperty("margin-bottom","0.5rem"),a(N,()=>t("common.total"),x),a(N,()=>t("balanceSheet.totalAssets"),b),a(N,()=>t("balanceSheet.totalLiabilities"),te),a(N,()=>t("balanceSheet.totalEquity"),V),W.style.setProperty("font-size","1.2rem"),W.style.setProperty("font-weight","bold"),a(W,()=>u(n()),I),a(W,()=>u(o()+l()),null),a(W,(()=>{var E=ke(()=>Math.abs(n()-(o()+l()))>.01);return()=>E()&&(()=>{var L=CT(),M=L.firstChild,P=M.nextSibling,w=P.nextSibling,v=w.nextSibling;return v.nextSibling,L.style.setProperty("font-size","0.875rem"),L.style.setProperty("color","#f44336"),L.style.setProperty("display","block"),a(L,()=>t("common.error"),P),a(L,()=>u(n()-(o()+l())),v),L})()})(),null),ge(E=>(E=Math.abs(n()-(o()+l()))<.01?"#4caf50":"#f44336")!=null?W.style.setProperty("color",E):W.style.removeProperty("color")),S})()]}})]}})};Wt(["click"]);const $T="modulepreload",ET=function(t){return"/"+t},K0={},no=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){let s=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");i=s(r.map(d=>{if(d=ET(d),d in K0)return;K0[d]=!0;const u=d.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${h}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":$T,u||(g.as="script"),g.crossOrigin="",g.href=d,c&&g.setAttribute("nonce",c),document.head.appendChild(g),u)return new Promise((m,S)=>{g.addEventListener("load",m),g.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(s){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s}return i.then(s=>{for(const l of s||[])l.status==="rejected"&&o(l.reason);return e().catch(o)})},IT=[{id:"YY_8802",code:"YY_8802",name:"CENTER",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8803",code:"YY_8803",name:"BISSONNET",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8804",code:"YY_8804",name:"IRVIN",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8805",code:"YY_8805",name:"KATTY",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8816",code:"YY_8816",type:"store",name:"YABA GLOBAL",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8818",code:"YY_8818",type:"store",name:"YABASURAUSTIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8847",code:"YY_8847",type:"store",name:"YABAOFICINA AZ",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_3251",code:"YY_3251",type:"store",name:"YABA FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_32",code:"YY_32",type:"store",name:"YABA MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_76",code:"YY_76",type:"store",name:"YABA DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_2376",code:"YY_2376",type:"store",name:"YABA SAN ANTONIO",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2025-08-14"},{id:"YY_79",code:"YY_79",type:"warehouse",name:"ALMACEN DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8635",code:"YY_8635",type:"store",name:"FASHION MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8665",code:"YY_8665",name:"IRVIN FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,type:"store",createdDate:"2024-01-01"},{id:"YY_3303",code:"YY_3303",name:"YABA MIAMI",bussinesId:"YB100423253156428",address:"Miami",isActive:!0,type:"store",createdDate:"2025-08-01"},{id:"YY_8901",code:"YY_8901",name:"ALMACEN CENTRAL YABA",bussinesId:"YB100423253156428",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"SS_42",code:"SS_42",name:"STEPHANIE SOLUTION",bussinesId:"SS695841584167881",type:"store",address:"5520 Fern Valley Rd, Ste 108, Louisville, KY 40228",isActive:!0,createdDate:"2024-01-01"}],TT=[{id:"1",name:'MacBook Pro 16"',price:2399,quantity:75,category:"Electronics",description:"Apple MacBook Pro 16-inch with M2 Pro chip",sku:"MBP-16-M2P",supplier:"Apple Inc.",minStock:10,location:"Warehouse A",lastUpdated:"2024-01-15"},{id:"2",name:'Dell Monitor 27"',price:299,quantity:35,category:"Electronics",description:"Dell 27-inch 4K UHD Monitor",sku:"DELL-MON-27-4K",supplier:"Dell Technologies",minStock:15,location:"Warehouse B",lastUpdated:"2024-01-14"},{id:"3",name:"Wireless Mouse",price:49.99,quantity:12,category:"Accessories",description:"Ergonomic wireless mouse with precision tracking",sku:"MOUSE-WL-001",supplier:"Logitech",minStock:25,location:"Warehouse A",lastUpdated:"2024-01-13"}],Zu=()=>{const t=new Map;return zi().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=gt.getLocationById(e.locationId),i=t.get(r);i||(i={id:r,productId:e.productId,locationId:e.locationId,locationName:n?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,i)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(i.quantity+=e.quantity*1):e.movementType==="out"?i.quantity-=e.quantity*1:e.movementType==="adjustment"&&(i.quantity=e.quantity*1),new Date(e.createdDate)>new Date(i.lastMovementDate)&&(i.lastMovementDate=e.createdDate,i.lastMovementType=e.movementType),i.averageCost=e.unitCost*1,i.availableQuantity=i.quantity*1-i.reservedQuantity*1}),Array.from(t.values())},[ll,Nm]=Se([]),[ba,Q0]=Se(IT),[zi,eh]=Se([]),[Pa,md]=Se([]),[th,Lm]=Se(TT),kT={TRANSFER:1,transfer:1},J0=173442384e4,gt={get products(){return ll()},get locations(){return ba()},get movements(){return zi()},get stockLevels(){return Pa()},parseInventoryData:t=>{const e=Object.keys(t).slice(0,900),r=[],n=i=>{let o=t;o[i]?.products&&o[i]?.products?.map(s=>{let l=Aw(o[i]?.type),c=s?.price*1||s?.unitCost*1,d=s?.qty*1||s?.quantity*1;c=isNaN(c)?0:c,d=isNaN(d)?0:d;let u={id:o[i]?.ssg_inventory_key,productId:s?.product?.id,productName:s?.product?.label,productSku:s?.product?.code,locationId:o[i]?.store,locationName:o[i]?.store,location:o[i]?.store,movementType:l,quantity:d,unitCost:c,totalCost:c*1*d,minStock:10,referenceNumber:"PO-001",notes:o[i]?.description||o[i]?.notes,createdBy:"admin",createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(J0).toISOString(),invoiceId:o[i]?.invoice};if(r.push(u),kT[o[i].movementType]&&o[i]?.fromLocationId){let h=gt.getLocationById(o[i]?.fromLocationId);const g={id:o[i]?.ssg_inventory_key,productId:s?.product?.id,productName:s?.product?.label,productSku:s?.product?.code,locationId:o[i]?.fromLocationId,locationName:h?.name||"",movementType:"out",quantity:d*-1,unitCost:c,totalCost:c*-1*d,minStock:10,referenceNumber:o[i]?.referenceNumber,notes:`Transfer to ${o[i]?.locationName}`+(o[i].notes?` - ${o[i].notes}`:""),createdBy:o[i].createdBy,createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(J0).toISOString(),invoiceId:o[i]?.invoiceId,toLocationId:o[i]?.locationId,toLocationName:o[i]?.locationName};r.push(g)}})};return e.map(n),r},fecthInventory:async t=>{const e=await ai.getInventory(t),r=gt.parseInventoryData(e);gt.updMovements(r)},getStockLevels:async t=>{const e=await xg.getStockLevels(t);md(e)},fecthProduct:async t=>{const e=await ai.getProducts(t),r=Object.keys(e),n=o=>{let s=e;return{id:o,name:s[o].name,businessId:s[o].businessId,sku:s[o].code,UPC:s[o].UPC,numCode:s[o].codeN,category:s[o].category,unitCost:s[o].unitCost||0,unitOfMeasure:s[o].unitOfMeasure||s[o].unit,minStockLevel:s[o].minStockLevel,maxStockLevel:s[o].maxStockLevel,isActive:s[o].isActive,productImageUrl:s[o].productImageUrl,description:s[o].description||"",createdDate:s[o].createdAt||new Date().toISOString(),lastModified:s[o].updatedAt||new Date().toISOString()}},i=r.map(n);return gt.updProduct(i),i},getProductById:t=>ll().find(e=>e.id===t),updProduct:t=>{Nm(t)},getProductsBySku:t=>ll().filter(e=>e.sku.toLowerCase().includes(t.toLowerCase())),getProductsByCategory:t=>ll().filter(e=>e.category===t),getActiveProducts:()=>ll().filter(t=>t.name),getLocationById:t=>ba().find(e=>e.id===t),getLocationsByType:t=>ba().filter(e=>e.type===t),getActiveLocations:()=>{if(Gt?.state?.profile?.isAdmin)return ba();let t=Gt?.state?.profile?.stores;return ba().filter(e=>t?.[e?.id])},getMovementsByProduct:t=>zi().filter(e=>e.productId===t),updMovements:t=>{eh([...t]),md(Zu())},getMovementsByLocation:t=>zi()?.filter(e=>e.locationId===t),getMovementsByDateRange:(t,e)=>zi()?.filter(r=>r.createdDate>=t&&r.createdDate<=e),getStockByProduct:t=>Pa()?.filter(e=>e.productId===t),getStockByLocation:t=>Pa()?.filter(e=>e.locationId===t),getStockByProductAndLocation:(t,e)=>Pa()?.find(r=>r.productId===t&&r.locationId===e),getTotalStockByProduct:t=>Pa()?.filter(e=>e.productId===t).reduce((e,r)=>e*1+r.quantity*1,0),getLastLocationByProduct:t=>{const e=zi()?.filter(r=>r.productId===t).sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime());if(e.length>0)return ba().find(r=>r.id===e[0].locationId)},getLowStockProducts:()=>(ll()||[])?.map(t=>{const e=Pa()?.filter(r=>r.productId===t.id).reduce((r,n)=>r+n.quantity,0)||0;return{...t,currentStock:e}}).filter(t=>t.currentStock<=t.minStockLevel),generateMovementInvoice:async(t,e,r,n="compact")=>{try{const{getUserLanguage:i}=await no(async()=>{const{getUserLanguage:u}=await import("./languageUtils-BVmHbHaj.js");return{getUserLanguage:u}},[]),o=r||i();let s;switch(n){case"compact":const{generateCompactModernInvoicePDF:u}=await no(async()=>{const{generateCompactModernInvoicePDF:m}=await import("./compactModernInvoicePdfGenerator-gmfkGbyU.js");return{generateCompactModernInvoicePDF:m}},[]);s=u;break;case"modern":const{generateModernMovementInvoicePDF:h}=await no(async()=>{const{generateModernMovementInvoicePDF:m}=await import("./modernMovementInvoicePdfGenerator-CYYTcdQu.js");return{generateModernMovementInvoicePDF:m}},[]);s=h;break;case"classic":default:const{generateMovementInvoicePDF:g}=await no(async()=>{const{generateMovementInvoicePDF:m}=await import("./movementInvoicePdfGenerator-C8-gMnWq.js");return{generateMovementInvoicePDF:m}},[]);s=g;break}const l=zi().filter(u=>u.invoiceId===t||u.id===t);if(l.length===0)throw new Error(`No movements found with ID: ${t}`);const c=l.reduce((u,h)=>{const g=h.invoiceId||h.id;return u[g]||(u[g]={invoiceId:g,movementType:h.movementType,referenceNumber:h.referenceNumber,createdBy:h.createdBy,createdDate:h.createdDate,locationName:h.locationName,fromLocationName:h.fromLocationName,toLocationName:h.toLocationName,notes:h.notes,items:[]}),u[g].items.push({productSku:h.productSku,productName:h.productName,quantity:h.quantity,unitCost:h.unitCost,totalCost:h.totalCost,receivedQuantity:h.movementType==="transfer"?null:void 0}),u},{}),d=[];for(const[u,h]of Object.entries(c)){const g=await s(h,e,o);d.push(g)}return d}catch(i){throw console.error("Error generating movement invoice:",i),i}},getMovementsByInvoiceId:t=>zi().filter(e=>e.invoiceId===t),generateCompactMovementInvoice:async(t,e,r)=>gt.generateMovementInvoice(t,e,r,"compact"),generateModernMovementInvoice:async(t,e,r)=>gt.generateMovementInvoice(t,e,r,"modern"),generateClassicMovementInvoice:async(t,e,r)=>gt.generateMovementInvoice(t,e,r,"classic"),getMovementInvoiceData:t=>{const e=zi().filter(i=>i.invoiceId===t||i.id===t);if(e.length===0)return null;const r=e[0],n=e.reduce((i,o)=>i+(o.totalCost||o.quantity*o.unitCost),0);return{invoiceId:r.invoiceId||r.id,movementType:r.movementType,referenceNumber:r.referenceNumber,createdBy:r.createdBy,createdDate:r.createdDate,locationName:r.locationName,fromLocationName:r.fromLocationName,toLocationName:r.toLocationName,notes:r.notes,totalValue:n,itemCount:e.length,items:e.map(i=>({productSku:i.productSku,productName:i.productName,quantity:i.quantity,unitCost:i.unitCost,totalCost:i.totalCost||i.quantity*i.unitCost}))}},addInventoryMovement:t=>{const e={...t,id:`mov-${Date.now()}`,createdDate:new Date().toISOString()};eh(r=>[...r,e]),md(Zu())},addBulkInventoryMovements:async t=>{const e=[],r=[],n=new Date().toISOString(),i=ba().find(l=>l.id===t.locationId);if(!i)return{success:!1,errors:["Invalid location"]};let o;if(t.movementType==="transfer"){if(!t.fromLocationId)return{success:!1,errors:["From location required for transfers"]};if(o=ba().find(l=>l.id===t.fromLocationId),!o)return{success:!1,errors:["Invalid from location"]};if(t.fromLocationId===t.locationId)return{success:!1,errors:["From and to locations cannot be the same"]}}if(t.items.forEach((l,c)=>{const d=ll().find(m=>m.id===l.productId);if(!d){e.push(`Item ${c+1}: Product not found`);return}if(l.quantity<=0){e.push(`Item ${c+1}: Quantity must be greater than 0`);return}if(t.movementType==="out"){const m=Pa().filter(S=>S.productId===l.productId&&S.locationId===t.locationId).reduce((S,N)=>S+N.quantity,0);if(l.quantity>m){e.push(`Item ${c+1}: Insufficient stock. Available: ${m}, Requested: ${l.quantity}`);return}}if(t.movementType==="transfer"){const m=Pa().filter(S=>S.productId===l.productId&&S.locationId===t.fromLocationId).reduce((S,N)=>S+N.quantity,0);if(l.quantity>m){e.push(`Item ${c+1}: Insufficient stock at ${o?.name}. Available: ${m}, Requested: ${l.quantity}`);return}}const u=l.unitCost||d.unitCost,h=l.quantity*u,g={id:`mov-${Date.now()}-${c}`,productId:d.id,productName:d.name,productSku:d.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:l.quantity,unitCost:u,totalCost:h,minStock:10,referenceNumber:t.referenceNumber||"",notes:l.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:o?.name};if(r.push(g),t.movementType==="transfer"&&o){const m={id:`mov-${Date.now()}-${c}-out`,productId:d.id,productName:d.name,productSku:d.sku,locationId:t.fromLocationId,locationName:o.name,movementType:"out",quantity:l.quantity,unitCost:u,totalCost:h,minStock:10,referenceNumber:t.referenceNumber||"",notes:`Transfer to ${i.name}`+(l.notes?` - ${l.notes}`:""),createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,toLocationId:t.locationId,toLocationName:i.name};r.push(m)}}),e.length>0)return{success:!1,errors:e};eh(l=>[...l,...r]),md(Zu()),console.log({bulkRequest:t});const s=await ai.addInventory(t);return console.log({prodResults:s}),{success:!0,errors:[]}},getMovementsByInvoice:t=>zi().filter(e=>e.invoiceId===t),getInvoiceSummary:t=>{const e=zi().filter(o=>o.invoiceId===t);if(e.length===0)return null;const r=e.reduce((o,s)=>o+s.totalCost,0),n=new Set(e.map(o=>o.productId)).size,i=e[0];return{invoiceId:t,referenceNumber:i.referenceNumber,movementType:i.movementType,location:i.locationName,fromLocation:i.fromLocationName,productCount:n,totalItems:e.reduce((o,s)=>o+s.quantity,0),totalValue:r,createdDate:i.createdDate,createdBy:i.createdBy}},addProduct:t=>{const e={...t,id:`prod-${Date.now()}`,createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};Nm(r=>[...r,e])},addLocation:t=>{const e={...t,id:`loc-${Date.now()}`,createdDate:new Date().toISOString()};Q0(r=>[...r,e])},updateProduct:(t,e)=>{Nm(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n))},updateLocation:(t,e)=>{Q0(r=>r.map(n=>n.id===t?{...n,...e}:n))},updateMovement:(t,e)=>{eh(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n)),md(Zu())},get inventory(){return th()},addItem(t){const e={...t,id:Date.now().toString(),lastUpdated:new Date().toISOString().split("T")[0]};return Lm([...th(),e]),e},updateItem(t,e){Lm(th().map(r=>r.id===t?{...r,...e,lastUpdated:new Date().toISOString().split("T")[0]}:r))},deleteItem(t){Lm(th().filter(e=>e.id!==t))},getItemById(t){return zi().find(e=>e.id===t)},getLowStockItems(){return zi().filter(t=>t.quantity*1<=t.minStock*1)},getTotalValue(){return zi().reduce((t,e)=>t*1+e.unitCost*1*e.quantity*1,0)}};var X0=le("<div>"),NT=le("<div><div><input type=text autocomplete=off>"),LT=le("<button type=button>+"),RT=le("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>");const zp=t=>{const{t:e}=or(),[r,n]=Se(!1),[i,o]=Se(""),[s,l]=Se(-1),c=Nt(()=>t.value?gt.getProductById(t.value):null),d=Nt(()=>{const z=i().toLowerCase();return z?gt.getActiveProducts().filter(T=>T.name.toLowerCase().includes(z)||T.sku.toLowerCase().includes(z)||T?.UPC?.toLowerCase().includes(z)||T.category.toLowerCase().includes(z)):gt.getActiveProducts()}),u=()=>{n(!0),o(""),l(-1)},h=z=>{const T=z.target;o(T.value),n(!0),l(-1)},g=z=>{t.onChange(z),n(!1),o(""),l(-1)},m=z=>{const T=d();switch(z.key){case"ArrowDown":z.preventDefault(),l(R=>Math.min(R+1,T.length-1));break;case"ArrowUp":z.preventDefault(),l(R=>Math.max(R-1,-1));break;case"Enter":z.preventDefault(),s()>=0&&T[s()]&&g(T[s()]);break;case"Escape":n(!1),o(""),l(-1);break}},S=z=>{setTimeout(()=>{n(!1),o(""),l(-1)},150)},N=z=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(z),x=z=>gt.stockLevels?.filter(T=>T.productId===z).reduce((T,R)=>T+R.quantity,0),b={position:"relative",width:"100%",...t.style},K={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},te={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},F=z=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid "+z?"var(--primary-color)":"var(--border-color)",background:z?"var(--strip-color)":"transparent",color:z?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),V={display:"flex","justify-content":"space-between","align-items":"center"},W={flex:"1"},I={"font-weight":"500","margin-bottom":"0.25rem"},E={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},L={"text-align":"right","font-size":"0.875rem"},M={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},P=()=>r()&&i()?i():c()?`${c().name} (${c().sku})`:"",w={display:"flex","align-items":"stretch",width:"100%"},v={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},j={...K,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"};return(()=>{var z=NT(),T=z.firstChild,R=T.firstChild;return p(T,w),R.addEventListener("blur",S),R.$$keydown=m,R.$$click=u,R.$$input=h,a(T,(()=>{var J=ke(()=>!!t.onAddNew);return()=>J()&&(()=>{var X=LT();return X.addEventListener("mouseleave",H=>{H.currentTarget.style.background="var(--surface-color)",H.currentTarget.style.color="var(--primary-color)"}),X.addEventListener("mouseenter",H=>{H.currentTarget.style.background="var(--primary-color)",H.currentTarget.style.color="white"}),Cn(X,"click",t.onAddNew,!0),p(X,v),ge(()=>Jt(X,"title",e("inventory.addProduct","Add new product"))),X})()})(),null),a(z,A(Me,{get when(){return r()},get children(){var J=X0();return a(J,A(Me,{get when(){return d().length>0},get fallback(){return(()=>{var X=X0();return p(X,M),a(X,(()=>{var H=ke(()=>!!i());return()=>H()?e("inventory.noProductsFound","No products found matching your search."):e("inventory.noProductsAvailable","No products available.")})()),X})()},get children(){return A(vt,{get each(){return d()},children:(X,H)=>{const se=x(X.id),O=se<=X.minStockLevel;return(()=>{var _=RT(),k=_.firstChild,$=k.firstChild,G=$.firstChild,ne=G.nextSibling,U=ne.firstChild,D=U.firstChild,B=U.nextSibling,Q=B.nextSibling,Z=Q.nextSibling,oe=Z.nextSibling,de=$.nextSibling,re=de.firstChild,Y=re.firstChild,ce=re.nextSibling;return _.addEventListener("mouseenter",()=>l(H())),_.$$click=()=>g(X),p(k,V),p($,W),p(G,I),a(G,()=>X.name),p(ne,E),a(U,()=>e("inventory.sku","SKU"),D),a(U,()=>X.sku,null),a(Q,()=>X.category),a(oe,()=>N(X.unitCost)),p(de,L),re.style.setProperty("font-weight","600"),(O?"#f44336":"var(--text-primary)")!=null?re.style.setProperty("color",O?"#f44336":"var(--text-primary)"):re.style.removeProperty("color"),a(re,se,Y),a(re,()=>X.unitOfMeasure,null),ce.style.setProperty("color","var(--text-muted)"),a(ce,()=>O?e("inventory.lowStock","Low Stock"):e("inventory.inStock","In Stock")),ge(ue=>p(_,F(H()===s()),ue)),_})()}})}})),ge(X=>p(J,te,X)),J}}),null),ge(J=>{var X=b,H=j,se=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),O=t.disabled,_=t.required;return J.e=p(z,X,J.e),J.t=p(R,H,J.t),se!==J.a&&Jt(R,"placeholder",J.a=se),O!==J.o&&(R.disabled=J.o=O),_!==J.i&&(R.required=J.i=_),J},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ge(()=>R.value=P()),z})()};Wt(["input","click","keydown"]);var Z0=le("<div>"),DT=le("<div><div><input type=text autocomplete=off>"),MT=le("<button type=button>+"),FT=le("<div><div><div><div> </div><div><span>: </span><span></span></div><div>");const nu=t=>{const{t:e}=or(),[r,n]=Se(!1),[i,o]=Se(""),[s,l]=Se(-1),c=Nt(()=>t.value?gt.getLocationById(t.value):null),d=Nt(()=>{let z=gt.getActiveLocations();t.filterType&&(z=z.filter(R=>R.type===t.filterType));const T=i().toLowerCase();return T?z.filter(R=>R.name.toLowerCase().includes(T)||R?.code?.toLowerCase().includes(T)||R?.type?.toLowerCase().includes(T)||R?.address?.toLowerCase().includes(T)):z}),u=()=>{n(!0),o(""),l(-1)},h=z=>{const T=z.target;o(T.value),n(!0),l(-1)},g=z=>{t.onChange(z.id),n(!1),o(""),l(-1)},m=z=>{const T=d();switch(z.key){case"ArrowDown":z.preventDefault(),l(R=>Math.min(R+1,T.length-1));break;case"ArrowUp":z.preventDefault(),l(R=>Math.max(R-1,-1));break;case"Enter":z.preventDefault(),s()>=0&&T[s()]&&g(T[s()]);break;case"Escape":n(!1),o(""),l(-1);break}},S=z=>{setTimeout(()=>{n(!1),o(""),l(-1)},150)},N=z=>({warehouse:"🏭",store:"🏪",supplier:"🚚",customer:"👥"})[z]||"📍",x=z=>({warehouse:"#2196F3",store:"#4CAF50",supplier:"#FF9800",customer:"#9C27B0"})[z]||"#757575",b={position:"relative",width:"100%",...t.style},K={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},te={display:"flex","align-items":"stretch",width:"100%"},F={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},V={...K,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},W={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},I=z=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:z?"var(--strip-color)":"transparent",color:z?"var(--primary-dark)":"var(--text-primary)",transition:"all 0.2s ease"}),E={display:"flex","justify-content":"space-between","align-items":"center"},L={flex:"1"},M={"font-weight":"500","margin-bottom":"0.25rem"},P={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","align-items":"center"},w=z=>({padding:"0.2rem 0.5rem","border-radius":"var(--border-radius-sm)","font-size":"0.7rem","font-weight":"500",background:x(z),color:"white","text-transform":"uppercase"}),v={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},j=()=>r()&&i()?i():c()?`${c().name} (${c().code})`:"";return(()=>{var z=DT(),T=z.firstChild,R=T.firstChild;return p(T,te),R.addEventListener("blur",S),R.$$keydown=m,R.$$click=u,R.$$input=h,a(T,(()=>{var J=ke(()=>!!t.onAddNew);return()=>J()&&(()=>{var X=MT();return X.addEventListener("mouseleave",H=>{H.currentTarget.style.background="var(--surface-color)",H.currentTarget.style.color="var(--primary-color)"}),X.addEventListener("mouseenter",H=>{H.currentTarget.style.background="var(--primary-color)",H.currentTarget.style.color="white"}),Cn(X,"click",t.onAddNew,!0),p(X,F),ge(()=>Jt(X,"title",e("inventory.addLocation","Add new location"))),X})()})(),null),a(z,A(Me,{get when(){return r()},get children(){var J=Z0();return a(J,A(Me,{get when(){return d().length>0},get fallback(){return(()=>{var X=Z0();return p(X,v),a(X,(()=>{var H=ke(()=>!!i());return()=>H()?e("inventory.noLocationsFound","No locations found matching your search."):e("inventory.noLocationsAvailable","No locations available.")})()),X})()},get children(){return A(vt,{get each(){return d()},children:(X,H)=>(()=>{var se=FT(),O=se.firstChild,_=O.firstChild,k=_.firstChild,$=k.firstChild,G=k.nextSibling,ne=G.firstChild,U=ne.firstChild,D=ne.nextSibling,B=G.nextSibling;return se.addEventListener("mouseenter",()=>l(H())),se.$$click=()=>g(X),p(O,E),p(_,L),p(k,M),a(k,()=>N(X.type),$),a(k,()=>X.name,null),p(G,P),a(ne,()=>e("inventory.locationCode","Code"),U),a(ne,()=>X.code,null),a(D,()=>X.type),B.style.setProperty("font-size","0.75rem"),B.style.setProperty("color","var(--text-muted)"),B.style.setProperty("margin-top","0.25rem"),a(B,()=>X.address),ge(Q=>{var Z=I(H()===s()),oe=w(X.type);return Q.e=p(se,Z,Q.e),Q.t=p(D,oe,Q.t),Q},{e:void 0,t:void 0}),se})()})}})),ge(X=>p(J,W,X)),J}}),null),ge(J=>{var X=b,H=V,se=t.placeholder||e("inventory.searchLocations","Search locations by name, code, or type..."),O=t.disabled,_=t.required;return J.e=p(z,X,J.e),J.t=p(R,H,J.t),se!==J.a&&Jt(R,"placeholder",J.a=se),O!==J.o&&(R.disabled=J.o=O),_!==J.i&&(R.required=J.i=_),J},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ge(()=>R.value=j()),z})()};Wt(["input","click","keydown"]);var OT=le("<form><div><label> *</label><input type=text required></div><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text list=categories required><datalist id=categories><option value=Electronics></option><option value=Accessories></option><option value=Office></option><option value=Furniture></option><option value=Software></option><option value=Hardware></option></datalist></div></div><div><label></label><textarea></textarea></div><div><div><label></label><select><option value=pcs></option><option value=kg></option><option value=lbs></option><option value=m></option><option value=ft></option><option value=l></option><option value=gal></option><option value=box></option><option value=pack></option></select></div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div></div><div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div><div></div></div><div><div><label></label><input type=number min=0 step=1></div><div><label></label><input type=number min=1 step=1></div></div><div>"),BT=le("<div>");const Cg=t=>{const{t:e}=or(),[r,n]=Se(""),[i,o]=Se(""),[s,l]=Se(""),[c,d]=Se(""),[u,h]=Se("pcs"),[g,m]=Se(0),[S,N]=Se(0),[x,b]=Se(10),[K,te]=Se(100),[F,V]=Se(""),W=()=>{n(""),o(""),l(""),d(""),h("pcs"),m(0),N(0),b(10),te(100),V("")},I=T=>{if(T.preventDefault(),V(""),!r().trim()){V(e("forms.productNameRequired"));return}if(!i().trim()){V(e("forms.skuRequired"));return}if(!c().trim()){V(e("forms.categoryRequired"));return}if(g()<0){V(e("forms.unitCostNotNegative"));return}if(S()<0){V(e("forms.sellingPriceNotNegative"));return}if(x()<0){V(e("forms.minStockNotNegative"));return}if(K()<=x()){V(e("forms.maxStockGreaterThanMin"));return}if(gt.getProductsBySku(i()).length>0){V(e("forms.skuAlreadyExists"));return}const J={name:r().trim(),sku:i().trim().toUpperCase(),description:s().trim(),category:c().trim(),unitOfMeasure:u(),unitCost:g(),sellingPrice:S(),minStockLevel:x(),maxStockLevel:K(),isActive:!0,businessId:"default-business"};gt.addProduct(J);const X=`prod-${Date.now()}`;t.onProductAdded&&t.onProductAdded(X),W(),t.onClose()},E=()=>{W(),t.onClose()},L={"margin-bottom":"1.5rem"},M={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},P={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},w={...P,cursor:"pointer"},v={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},j={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},z={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"};return A(Bn,{get isOpen(){return t.isOpen},onClose:E,get title(){return e("inventory.addNewProduct")},get children(){var T=OT(),R=T.firstChild,J=R.firstChild,X=J.firstChild,H=J.nextSibling,se=R.nextSibling,O=se.firstChild,_=O.firstChild,k=_.firstChild,$=_.nextSibling,G=O.nextSibling,ne=G.firstChild,U=ne.firstChild,D=ne.nextSibling,B=se.nextSibling,Q=B.firstChild,Z=Q.nextSibling,oe=B.nextSibling,de=oe.firstChild,re=de.firstChild,Y=re.nextSibling,ce=Y.firstChild,ue=ce.nextSibling,ae=ue.nextSibling,ye=ae.nextSibling,me=ye.nextSibling,pe=me.nextSibling,ve=pe.nextSibling,Ne=ve.nextSibling,Ie=Ne.nextSibling,Ce=de.nextSibling,Ee=Ce.firstChild,we=Ee.nextSibling,Re=oe.nextSibling,He=Re.firstChild,je=He.firstChild,Ve=je.nextSibling,qe=Re.nextSibling,tt=qe.firstChild,rt=tt.firstChild,Be=rt.nextSibling,Ge=tt.nextSibling,Fe=Ge.firstChild,at=Fe.nextSibling,lt=qe.nextSibling;return T.addEventListener("submit",I),a(J,()=>e("inventory.productName"),X),H.addEventListener("change",Xe=>n(Xe.target.value)),a(_,()=>e("inventory.sku"),k),$.addEventListener("change",Xe=>o(Xe.target.value)),a(ne,()=>e("inventory.category"),U),D.addEventListener("change",Xe=>d(Xe.target.value)),a(Q,()=>e("common.description")),Z.addEventListener("change",Xe=>l(Xe.target.value)),a(re,()=>e("inventory.unitOfMeasure")),Y.addEventListener("change",Xe=>h(Xe.target.value)),a(ce,()=>e("inventory.pieces")),a(ue,()=>e("inventory.kilograms")),a(ae,()=>e("inventory.pounds")),a(ye,()=>e("inventory.meters")),a(me,()=>e("inventory.feet")),a(pe,()=>e("inventory.liters")),a(ve,()=>e("inventory.gallons")),a(Ne,()=>e("inventory.boxes")),a(Ie,()=>e("inventory.packs")),a(Ee,()=>e("inventory.unitCost")),we.addEventListener("change",Xe=>m(Number(Xe.target.value))),a(je,()=>e("inventory.sellingPrice")),Ve.addEventListener("change",Xe=>N(Number(Xe.target.value))),a(rt,()=>e("inventory.minimumStockLevel")),Be.addEventListener("change",Xe=>b(Number(Xe.target.value))),a(Fe,()=>e("inventory.maximumStockLevel")),at.addEventListener("change",Xe=>te(Number(Xe.target.value))),a(T,(()=>{var Xe=ke(()=>!!F());return()=>Xe()&&(()=>{var Ct=BT();return p(Ct,v),a(Ct,F),Ct})()})(),lt),p(lt,j),a(lt,A(ct,{variant:"secondary",type:"button",onClick:E,get children(){return e("common.cancel")}}),null),a(lt,A(ct,{variant:"primary",type:"submit",get children(){return e("inventory.addProduct")}}),null),ge(Xe=>{var Ct=L,Le=M,nt=P,We=e("inventory.enterProductName"),kt=z,Et=M,Ot=P,jt=e("inventory.enterSkuCode"),mt=M,Zt=P,rr=e("inventory.enterCategory"),Dt=L,Kt=M,dt={...P,"min-height":"80px",resize:"vertical"},pt=e("inventory.enterProductDescription"),ze=z,bt=M,Mt=w,ft=M,At=P,Ht=z,Yt=M,nr=P,Dr=z,vr=M,tr=P,Bt=M,ar=P;return Xe.e=p(R,Ct,Xe.e),Xe.t=p(J,Le,Xe.t),Xe.a=p(H,nt,Xe.a),We!==Xe.o&&Jt(H,"placeholder",Xe.o=We),Xe.i=p(se,kt,Xe.i),Xe.n=p(_,Et,Xe.n),Xe.s=p($,Ot,Xe.s),jt!==Xe.h&&Jt($,"placeholder",Xe.h=jt),Xe.r=p(ne,mt,Xe.r),Xe.d=p(D,Zt,Xe.d),rr!==Xe.l&&Jt(D,"placeholder",Xe.l=rr),Xe.u=p(B,Dt,Xe.u),Xe.c=p(Q,Kt,Xe.c),Xe.w=p(Z,dt,Xe.w),pt!==Xe.m&&Jt(Z,"placeholder",Xe.m=pt),Xe.f=p(oe,ze,Xe.f),Xe.y=p(re,bt,Xe.y),Xe.g=p(Y,Mt,Xe.g),Xe.p=p(Ee,ft,Xe.p),Xe.b=p(we,At,Xe.b),Xe.T=p(Re,Ht,Xe.T),Xe.A=p(je,Yt,Xe.A),Xe.O=p(Ve,nr,Xe.O),Xe.I=p(qe,Dr,Xe.I),Xe.S=p(rt,vr,Xe.S),Xe.W=p(Be,tr,Xe.W),Xe.C=p(Fe,Bt,Xe.C),Xe.B=p(at,ar,Xe.B),Xe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),ge(()=>H.value=r()),ge(()=>$.value=i()),ge(()=>D.value=c()),ge(()=>Z.value=s()),ge(()=>Y.value=u()),ge(()=>we.value=g()),ge(()=>Ve.value=S()),ge(()=>Be.value=x()),ge(()=>at.value=K()),T}})};var VT=le('<form><div><label> *</label><input type=text required></div><div><div><label> *<button type=button title="Generate code automatically"></button></label><input type=text required><div></div></div><div><label> *</label><select required><option value=warehouse> </option><option value=store> </option><option value=supplier> </option><option value=customer> </option></select><div></div></div></div><div><label> *</label><textarea required></textarea></div><div>'),jT=le("<div><div>:</div><div><span></span><div><div></div><div>"),zT=le("<div>");const Ag=t=>{const{t:e}=or(),[r,n]=Se(""),[i,o]=Se(""),[s,l]=Se("warehouse"),[c,d]=Se(""),[u,h]=Se(""),g=()=>{n(""),o(""),l("warehouse"),d(""),h("")},m=()=>{if(r()){const P=s()==="warehouse"?"WH":s()==="store"?"ST":s()==="supplier"?"SUP":"CUST",w=r().toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,3),v=String(Math.floor(Math.random()*1e3)).padStart(3,"0");o(`${P}-${w}-${v}`)}},S=P=>{if(P.preventDefault(),h(""),!r().trim()){h(e("forms.locationNameRequired"));return}if(!i().trim()){h(e("forms.locationCodeRequired"));return}if(!c().trim()){h(e("forms.addressRequired"));return}if(gt.locations.filter(z=>z.code.toLowerCase()===i().toLowerCase()).length>0){h(e("forms.locationCodeExists"));return}const v={name:r().trim(),code:i().trim().toUpperCase(),type:s(),address:c().trim(),isActive:!0};gt.addLocation(v);const j=`loc-${Date.now()}`;t.onLocationAdded&&t.onLocationAdded(j),g(),t.onClose()},N=()=>{g(),t.onClose()},x={"margin-bottom":"1.5rem"},b={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},K={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},te={...K,cursor:"pointer"},F={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},V={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},W={display:"grid","grid-template-columns":"2fr 1fr",gap:"1rem"},I={"font-size":"0.875rem",color:"var(--text-muted)","margin-top":"0.25rem"},E={padding:"0.25rem 0.5rem","font-size":"0.75rem","margin-left":"0.5rem",background:"var(--background-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",color:"var(--text-muted)"},L=P=>({warehouse:"🏭",store:"🏪",supplier:"🚚",customer:"👥"})[P]||"📍",M=P=>({warehouse:e("inventory.warehouseDescription"),store:e("inventory.storeDescription"),supplier:e("inventory.supplierDescription"),customer:e("inventory.customerDescription")})[P]||"";return A(Bn,{get isOpen(){return t.isOpen},onClose:N,get title(){return e("inventory.addNewLocation")},get children(){var P=VT(),w=P.firstChild,v=w.firstChild,j=v.firstChild,z=v.nextSibling,T=w.nextSibling,R=T.firstChild,J=R.firstChild,X=J.firstChild,H=X.nextSibling,se=J.nextSibling,O=se.nextSibling,_=R.nextSibling,k=_.firstChild,$=k.firstChild,G=k.nextSibling,ne=G.firstChild,U=ne.firstChild,D=ne.nextSibling,B=D.firstChild,Q=D.nextSibling,Z=Q.firstChild,oe=Q.nextSibling,de=oe.firstChild,re=G.nextSibling,Y=T.nextSibling,ce=Y.firstChild,ue=ce.firstChild,ae=ce.nextSibling,ye=Y.nextSibling;return P.addEventListener("submit",S),a(v,()=>e("inventory.locationName"),j),z.addEventListener("change",me=>n(me.target.value)),p(T,W),a(J,()=>e("inventory.locationCode"),X),H.$$click=m,p(H,E),a(H,()=>e("common.generate")),se.addEventListener("change",me=>o(me.target.value)),a(O,()=>e("inventory.uniqueIdentifierHelp")),a(k,()=>e("inventory.locationType"),$),G.addEventListener("change",me=>l(me.target.value)),a(ne,()=>L("warehouse"),U),a(ne,()=>e("inventory.warehouse"),null),a(D,()=>L("store"),B),a(D,()=>e("inventory.store"),null),a(Q,()=>L("supplier"),Z),a(Q,()=>e("inventory.supplier"),null),a(oe,()=>L("customer"),de),a(oe,()=>e("inventory.customer"),null),a(re,()=>M(s())),a(ce,()=>e("common.address"),ue),ae.addEventListener("change",me=>d(me.target.value)),a(P,(()=>{var me=ke(()=>!!r());return()=>me()&&(()=>{var pe=jT(),ve=pe.firstChild,Ne=ve.firstChild,Ie=ve.nextSibling,Ce=Ie.firstChild,Ee=Ce.nextSibling,we=Ee.firstChild,Re=we.nextSibling;return pe.style.setProperty("padding","1rem"),pe.style.setProperty("background","var(--background-color)"),pe.style.setProperty("border-radius","var(--border-radius-sm)"),pe.style.setProperty("border","1px solid var(--border-color)"),pe.style.setProperty("margin-bottom","1rem"),ve.style.setProperty("font-weight","500"),ve.style.setProperty("margin-bottom","0.5rem"),a(ve,()=>e("common.preview"),Ne),Ie.style.setProperty("display","flex"),Ie.style.setProperty("align-items","center"),Ie.style.setProperty("gap","0.5rem"),Ce.style.setProperty("font-size","1.2rem"),a(Ce,()=>L(s())),we.style.setProperty("font-weight","600"),a(we,r),Re.style.setProperty("font-size","0.875rem"),Re.style.setProperty("color","var(--text-muted)"),a(Re,(()=>{var He=ke(()=>!!i());return()=>He()&&`${i()} • `})(),null),a(Re,s,null),pe})()})(),ye),a(P,(()=>{var me=ke(()=>!!u());return()=>me()&&(()=>{var pe=zT();return p(pe,F),a(pe,u),pe})()})(),ye),p(ye,V),a(ye,A(ct,{variant:"secondary",type:"button",onClick:N,get children(){return e("common.cancel")}}),null),a(ye,A(ct,{variant:"primary",type:"submit",get children(){return e("inventory.addLocation")}}),null),ge(me=>{var pe=x,ve=b,Ne=K,Ie=e("inventory.enterLocationName"),Ce=b,Ee=K,we=e("inventory.enterUniqueCode"),Re=I,He=b,je=te,Ve=I,qe=x,tt=b,rt={...K,"min-height":"100px",resize:"vertical"},Be=e("inventory.enterCompleteAddress");return me.e=p(w,pe,me.e),me.t=p(v,ve,me.t),me.a=p(z,Ne,me.a),Ie!==me.o&&Jt(z,"placeholder",me.o=Ie),me.i=p(J,Ce,me.i),me.n=p(se,Ee,me.n),we!==me.s&&Jt(se,"placeholder",me.s=we),me.h=p(O,Re,me.h),me.r=p(k,He,me.r),me.d=p(G,je,me.d),me.l=p(re,Ve,me.l),me.u=p(Y,qe,me.u),me.c=p(ce,tt,me.c),me.w=p(ae,rt,me.w),Be!==me.m&&Jt(ae,"placeholder",me.m=Be),me},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),ge(()=>z.value=r()),ge(()=>se.value=i()),ge(()=>G.value=s()),ge(()=>ae.value=c()),P}})};Wt(["click"]);var qT=le("<form><div>"),e1=le("<div><label> *"),UT=le("<div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment>"),HT=le("<div><label>"),GT=le("<div><label> *</label><input type=number min=0 step=1 required>"),WT=le("<div><label></label><input type=number min=0 step=0.01>"),YT=le("<div><label></label><input type=text>"),KT=le("<div><label></label><textarea>"),QT=le("<div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span>:</span><span> "),JT=le("<div><div><span>:</span><span>"),XT=le("<div>");const ZT=t=>{const{t:e}=or(),[r,n]=Se({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""}),[i,o]=Se(""),[s,l]=Se(""),[c,d]=Se("in"),[u,h]=Se(0),[g,m]=Se(0),[S,N]=Se(""),[x,b]=Se(""),[K,te]=Se(""),[F,V]=Se(""),[W,I]=Se(!1),[E,L]=Se(!1),M=()=>t.mode==="movement",P=Nt(()=>i()?gt.getProductById(i()):null),w=Nt(()=>s()?gt.getLocationById(s()):null),v=Nt(()=>K()?gt.getLocationById(K()):null),j=Nt(()=>u()*g()),z=Nt(()=>!i()||!s()?0:gt.getStockByProductAndLocation(i(),s())?.quantity||0),T=[{value:"Electronics",label:"Electronics"},{value:"Accessories",label:"Accessories"},{value:"Furniture",label:"Furniture"},{value:"Office Supplies",label:"Office Supplies"},{value:"Software",label:"Software"},{value:"Hardware",label:"Hardware"},{value:"Consumables",label:"Consumables"}],R=[{value:"Warehouse A",label:"Warehouse A"},{value:"Warehouse B",label:"Warehouse B"},{value:"Warehouse C",label:"Warehouse C"},{value:"Storage Room",label:"Storage Room"},{value:"Main Office",label:"Main Office"}],J={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},X=()=>{o(""),l(""),d("in"),h(0),m(0),N(""),b(""),te(""),V("")},H=()=>{n({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""})},se=oe=>{if(oe.preventDefault(),M()){if(V(""),!i()){V(e("forms.selectProduct"));return}if(!s()){V(e("forms.selectLocation"));return}if(u()<=0){V(e("forms.quantityGreaterThanZero"));return}if(g()<0){V(e("forms.unitCostNotNegative"));return}if(c()==="transfer"&&!K()){V(e("forms.selectFromLocation"));return}if(c()==="transfer"&&K()===s()){V(e("forms.sameLocationError"));return}if(c()==="out"&&u()>z()){V(e("forms.insufficientStock",{currentStock:z()}));return}const de=P(),re=w(),Y={productId:de.id,productName:de.name,productSku:de.sku,locationId:re.id,locationName:re.name,movementType:c(),quantity:u(),unitCost:g()||de.unitCost,totalCost:j()||u()*de.unitCost,referenceNumber:S()||`AUTO-${Date.now()}`,notes:x(),createdBy:"admin",fromLocationId:c()==="transfer"?K():void 0,fromLocationName:c()==="transfer"?v()?.name:void 0};gt.addInventoryMovement(Y),X()}else{const de=r();if(!de.name||!de.price||!de.quantity||!de.category||!de.sku||!de.supplier||!de.minStock||!de.location){alert(e("forms.fillAllRequired"));return}const re={name:de.name,price:parseFloat(de.price),quantity:parseInt(de.quantity),category:de.category,description:de.description,sku:de.sku,supplier:de.supplier,minStock:parseInt(de.minStock),location:de.location};gt.addItem(re),H()}t.onClose()},O=(oe,de)=>{n(re=>({...re,[oe]:de}))},_=()=>{M()?X():H(),t.onClose()},k=oe=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(oe),$={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},G={...$,cursor:"pointer"},ne={color:"#f44336","font-size":"0.875rem","margin-top":"0.5rem"},U={padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},D={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},B={"font-weight":"500",color:"var(--text-muted)"},Q={"font-weight":"600",color:"var(--text-primary)"},Z=()=>M()?e("inventory.addMovement"):e("inventory.addNewItem");return A(Bn,{get isOpen(){return t.isOpen},onClose:_,get title(){return Z()},get children(){return[(()=>{var oe=qT(),de=oe.firstChild;return oe.addEventListener("submit",se),a(oe,(()=>{var re=ke(()=>!!M());return()=>re()?[(()=>{var Y=e1(),ce=Y.firstChild,ue=ce.firstChild;return Y.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),a(ce,()=>e("inventory.product"),ue),a(Y,A(zp,{get value(){return i()},onChange:ae=>{o(ae);const ye=gt.getProductById(ae);ye&&m(ye.unitCost)},get placeholder(){return e("inventory.searchProductsPlaceholder")},onAddNew:()=>I(!0),required:!0}),null),Y})(),(()=>{var Y=UT(),ce=Y.firstChild,ue=ce.firstChild,ae=ce.nextSibling,ye=ae.firstChild,me=ye.nextSibling,pe=me.nextSibling,ve=pe.nextSibling;return Y.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),a(ce,()=>e("inventory.movementType"),ue),ae.addEventListener("change",Ne=>d(Ne.target.value)),a(ye,()=>e("inventory.stockInPurchase")),a(me,()=>e("inventory.stockOutSale")),a(pe,()=>e("inventory.transferBetween")),a(ve,()=>e("inventory.stockAdjustment")),ge(Ne=>p(ae,G,Ne)),ge(()=>ae.value=c()),Y})(),ke(()=>ke(()=>c()==="transfer")()&&(()=>{var Y=e1(),ce=Y.firstChild,ue=ce.firstChild;return Y.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),a(ce,()=>e("inventory.fromLocation"),ue),a(Y,A(nu,{get value(){return K()},onChange:ae=>te(ae),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>L(!0),required:!0}),null),Y})()),(()=>{var Y=HT(),ce=Y.firstChild;return Y.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),a(ce,(()=>{var ue=ke(()=>c()==="transfer");return()=>ue()?e("inventory.toLocation")+" *":e("inventory.locationName")+" *"})()),a(Y,A(nu,{get value(){return s()},onChange:ue=>l(ue),get placeholder(){return ke(()=>c()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>L(!0),required:!0}),null),Y})(),ke(()=>ke(()=>!!(P()&&w()))()&&(()=>{var Y=QT(),ce=Y.firstChild,ue=ce.firstChild,ae=ue.firstChild,ye=ue.nextSibling,me=ye.firstChild,pe=ce.nextSibling,ve=pe.firstChild,Ne=ve.firstChild,Ie=ve.nextSibling,Ce=pe.nextSibling,Ee=Ce.firstChild,we=Ee.firstChild,Re=Ee.nextSibling,He=Re.firstChild;return a(ue,()=>e("inventory.currentStockAt",{location:w()?.name}),ae),a(ye,z,me),a(ye,()=>P()?.unitOfMeasure,null),a(ve,()=>e("inventory.productCost"),Ne),a(Ie,()=>k(P()?.unitCost||0)),a(Ee,()=>e("inventory.minStockLevel"),we),a(Re,()=>P()?.minStockLevel,He),a(Re,()=>P()?.unitOfMeasure,null),ge(je=>{var Ve=U,qe=D,tt=B,rt=Q,Be=D,Ge=B,Fe=Q,at=D,lt=B,Xe=Q;return je.e=p(Y,Ve,je.e),je.t=p(ce,qe,je.t),je.a=p(ue,tt,je.a),je.o=p(ye,rt,je.o),je.i=p(pe,Be,je.i),je.n=p(ve,Ge,je.n),je.s=p(Ie,Fe,je.s),je.h=p(Ce,at,je.h),je.r=p(Ee,lt,je.r),je.d=p(Re,Xe,je.d),je},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),Y})()),(()=>{var Y=GT(),ce=Y.firstChild,ue=ce.firstChild,ae=ce.nextSibling;return Y.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),a(ce,()=>e("inventory.quantity"),ue),ae.addEventListener("change",ye=>h(Number(ye.target.value))),ge(ye=>p(ae,$,ye)),ge(()=>ae.value=u()),Y})(),(()=>{var Y=WT(),ce=Y.firstChild,ue=ce.nextSibling;return Y.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),a(ce,()=>e("inventory.unitCost")),ue.addEventListener("change",ae=>m(Number(ae.target.value))),ge(ae=>{var ye=$,me=e("inventory.willUseDefaultCost");return ae.e=p(ue,ye,ae.e),me!==ae.t&&Jt(ue,"placeholder",ae.t=me),ae},{e:void 0,t:void 0}),ge(()=>ue.value=g()),Y})(),ke(()=>ke(()=>u()>0&&g()>0)()&&(()=>{var Y=JT(),ce=Y.firstChild,ue=ce.firstChild,ae=ue.firstChild,ye=ue.nextSibling;return a(ue,()=>e("inventory.totalCost"),ae),a(ye,()=>k(j())),ge(me=>{var pe=U,ve=D,Ne=B,Ie={...Q,"font-size":"1.2rem",color:"var(--primary-color)"};return me.e=p(Y,pe,me.e),me.t=p(ce,ve,me.t),me.a=p(ue,Ne,me.a),me.o=p(ye,Ie,me.o),me},{e:void 0,t:void 0,a:void 0,o:void 0}),Y})()),(()=>{var Y=YT(),ce=Y.firstChild,ue=ce.nextSibling;return Y.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),a(ce,()=>e("common.referenceNumber")),ue.addEventListener("change",ae=>N(ae.target.value)),ge(ae=>{var ye=$,me=e("common.referenceNumberPlaceholder");return ae.e=p(ue,ye,ae.e),me!==ae.t&&Jt(ue,"placeholder",ae.t=me),ae},{e:void 0,t:void 0}),ge(()=>ue.value=S()),Y})(),(()=>{var Y=KT(),ce=Y.firstChild,ue=ce.nextSibling;return Y.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),a(ce,()=>e("common.notes")),ue.addEventListener("change",ae=>b(ae.target.value)),ge(ae=>{var ye={...$,"min-height":"100px",resize:"vertical"},me=e("inventory.additionalNotesPlaceholder");return ae.e=p(ue,ye,ae.e),me!==ae.t&&Jt(ue,"placeholder",ae.t=me),ae},{e:void 0,t:void 0}),ge(()=>ue.value=x()),Y})(),ke(()=>ke(()=>!!F())()&&(()=>{var Y=XT();return p(Y,ne),a(Y,F),Y})())]:[A(Lt,{get label(){return e("inventory.itemName")},get value(){return r().name},onChange:Y=>O("name",Y),get placeholder(){return e("inventory.enterItemName")},required:!0}),A(Lt,{get label(){return e("inventory.sku")},get value(){return r().sku},onChange:Y=>O("sku",Y),get placeholder(){return e("inventory.enterSkuCode")},required:!0}),A(en,{get label(){return e("inventory.category")},get value(){return r().category},onChange:Y=>O("category",Y),options:T,required:!0}),A(Lt,{get label(){return e("common.description")},get value(){return r().description},onChange:Y=>O("description",Y),get placeholder(){return e("inventory.enterItemDescription")}}),A(Lt,{get label(){return e("common.price")},type:"number",get value(){return r().price},onChange:Y=>O("price",Y),get placeholder(){return e("common.enterPrice")},required:!0}),A(Lt,{get label(){return e("inventory.quantity")},type:"number",get value(){return r().quantity},onChange:Y=>O("quantity",Y),get placeholder(){return e("inventory.enterQuantity")},required:!0}),A(Lt,{get label(){return e("inventory.minimumStock")},type:"number",get value(){return r().minStock},onChange:Y=>O("minStock",Y),get placeholder(){return e("inventory.enterMinStockLevel")},required:!0}),A(Lt,{get label(){return e("inventory.supplier")},get value(){return r().supplier},onChange:Y=>O("supplier",Y),get placeholder(){return e("inventory.enterSupplierName")},required:!0}),A(en,{get label(){return e("inventory.location")},get value(){return r().location},onChange:Y=>O("location",Y),options:R,required:!0})]})(),de),p(de,J),a(de,A(ct,{variant:"secondary",type:"button",onClick:_,get children(){return e("common.cancel")}}),null),a(de,A(ct,{variant:"primary",type:"submit",get children(){return ke(()=>!!M())()?e("inventory.addMovement"):e("inventory.addItem")}}),null),oe})(),A(Cg,{get isOpen(){return W()},onClose:()=>I(!1),onProductAdded:oe=>{o(oe),I(!1)}}),A(Ag,{get isOpen(){return E()},onClose:()=>L(!1),onLocationAdded:oe=>{c()==="transfer"&&!K()?te(oe):l(oe),L(!1)}})]}})};Wt(["input","keydown"]);var ek=le("<div><div></div><div></div><div></div><div>"),tk=le("<div><strong>:</strong> "),rk=le("<div><div><span></span><span></span></div><div><span></span><span> </span></div><div><span></span><span> </span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),nk=le("<div>");const ik=t=>{const{t:e}=or(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={"text-align":"center","margin-bottom":"2rem"},s={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},l={color:"var(--text-muted)","font-size":"1rem"},c={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"1rem"},d=(N,x)=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:N>x?"#d4edda":"#f8d7da",color:N>x?"#155724":"#721c24"}),u={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},h={"margin-bottom":"1.5rem",padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",color:"var(--text-secondary)"};if(!t.item)return null;const g=N=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(N),m=N=>new Date(N).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),S=t.item.price*t.item.quantity;return A(Bn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.itemDetails")},get children(){return[(()=>{var N=ek(),x=N.firstChild,b=x.nextSibling,K=b.nextSibling,te=K.nextSibling;return p(N,o),p(x,s),a(x,()=>t.item.name),p(b,l),a(b,()=>t.item.category),p(K,c),a(K,()=>g(t.item.price)),a(te,(()=>{var F=ke(()=>t.item.quantity>t.item.minStock);return()=>F()?e("inventory.inStock"):e("inventory.lowStockAlert")})()),ge(F=>p(te,d(t.item.quantity,t.item.minStock),F)),N})(),(()=>{var N=tk(),x=N.firstChild,b=x.firstChild;return x.nextSibling,p(N,h),a(x,()=>e("common.description"),b),a(N,()=>t.item.description,null),N})(),(()=>{var N=rk(),x=N.firstChild,b=x.firstChild,K=b.nextSibling,te=x.nextSibling,F=te.firstChild,V=F.nextSibling,W=V.firstChild,I=te.nextSibling,E=I.firstChild,L=E.nextSibling,M=L.firstChild,P=I.nextSibling,w=P.firstChild,v=w.nextSibling,j=P.nextSibling,z=j.firstChild,T=z.nextSibling,R=j.nextSibling,J=R.firstChild,X=J.nextSibling,H=R.nextSibling,se=H.firstChild,O=se.nextSibling;return a(b,()=>e("inventory.sku")),a(K,()=>t.item.sku),a(F,()=>e("inventory.quantity")),a(V,()=>t.item.quantity,W),a(V,()=>e("common.units"),null),a(E,()=>e("inventory.minimumStock")),a(L,()=>t.item.minStock,M),a(L,()=>e("common.units"),null),a(w,()=>e("inventory.totalValue")),a(v,()=>g(S)),a(z,()=>e("inventory.supplier")),a(T,()=>t.item.supplier),a(J,()=>e("inventory.location")),a(X,()=>t.item.location),a(se,()=>e("common.lastUpdated")),a(O,()=>m(t.item.lastUpdated)),ge(_=>{var k=r,$=n,G=i,ne=r,U=n,D=i,B=r,Q=n,Z=i,oe=r,de=n,re=i,Y=r,ce=n,ue=i,ae=r,ye=n,me=i,pe=r,ve=n,Ne=i;return _.e=p(x,k,_.e),_.t=p(b,$,_.t),_.a=p(K,G,_.a),_.o=p(te,ne,_.o),_.i=p(F,U,_.i),_.n=p(V,D,_.n),_.s=p(I,B,_.s),_.h=p(E,Q,_.h),_.r=p(L,Z,_.r),_.d=p(P,oe,_.d),_.l=p(w,de,_.l),_.u=p(v,re,_.u),_.c=p(j,Y,_.c),_.w=p(z,ce,_.w),_.m=p(T,ue,_.m),_.f=p(R,ae,_.f),_.y=p(J,ye,_.y),_.g=p(X,me,_.g),_.p=p(H,pe,_.p),_.b=p(se,ve,_.b),_.T=p(O,Ne,_.T),_},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),N})(),(()=>{var N=nk();return p(N,u),a(N,A(ct,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),a(N,A(ct,{variant:"primary",onClick:()=>{console.log("Edit item:",t.item.id)},get children(){return e("common.editItem")}}),null),N})()]}})};var ok=le("<div>🔄"),sk=le("<button type=button>×"),ak=le("<div>⚠️ "),t1=le("<div>"),lk=le("<div><div><input type=text autocomplete=off>"),ck=le("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>"),dk=le("<span>⚠️ ");const uk=t=>{const{t:e}=or(),[r,n]=Se(""),[i,o]=Se(!1),[s,l]=Se(null),[c,d]=Se([]),[u,h]=Se(!1),[g,m]=Se(-1),[S,N]=Se(null),x=t.searchDelay||300;t.maxResults;const b=async k=>{if(!k.trim()||k.trim().length<3){d([]),t.onSearchResults?.([]);return}try{o(!0),l(null);try{console.log("apiResults",k),t.onSearchResults?.(k)}catch($){console.warn("API search failed, using local fallback:",$),l("API search failed, showing local results")}}catch($){const G=$ instanceof Error?$.message:"Search failed";l(G),d([]),t.onSearchResults?.([])}finally{o(!1)}},K=k=>{const G=k.target.value;n(G),l(null),console.log(),t.showResults,S()&&clearTimeout(S());const ne=setTimeout(()=>{b(G)},x);N(ne)},te=k=>{n(k.name),h(!1),m(-1),t.onInventorySelect?.(k)},F=k=>{if(!(!u()||c().length===0))switch(k.key){case"ArrowDown":k.preventDefault(),m($=>Math.min($+1,c().length-1));break;case"ArrowUp":k.preventDefault(),m($=>Math.max($-1,-1));break;case"Enter":k.preventDefault(),g()>=0&&c()[g()]&&te(c()[g()]);break;case"Escape":h(!1),m(-1);break}},V=()=>{t.showResults!==!1&&c().length>0&&h(!0)},W=()=>{setTimeout(()=>{h(!1),m(-1)},150)},I=()=>{n(""),d([]),l(null),h(!1),m(-1),t.onSearchResults?.([]),S()&&(clearTimeout(S()),N(null))},E=k=>gt.stockLevels.filter($=>$.inventoryId===k).reduce(($,G)=>$+G.quantity,0),L=k=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(k),M={position:"relative",width:"100%",...t.style},P={position:"relative",display:"flex","align-items":"center"},w={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},v={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},j={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},z={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},T=k=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:k?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),R={display:"flex","justify-content":"space-between","align-items":"center"},J={flex:"1"},X={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},H={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},se={"text-align":"right","font-size":"0.875rem"},O={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},_={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var k=lk(),$=k.firstChild,G=$.firstChild;return G.addEventListener("blur",W),G.addEventListener("focus",V),G.$$keydown=F,G.$$input=K,a($,A(Me,{get when(){return i()},get children(){var ne=ok();return ge(U=>p(ne,j,U)),ne}}),null),a($,A(Me,{get when(){return ke(()=>!!r())()&&!i()},get children(){var ne=sk();return ne.addEventListener("mouseleave",U=>{U.currentTarget.style.background="none",U.currentTarget.style.color="var(--text-muted)"}),ne.addEventListener("mouseenter",U=>{U.currentTarget.style.background="var(--border-color)",U.currentTarget.style.color="var(--text-primary)"}),ne.$$click=I,ge(U=>{var D=v,B=e("common.clear","Clear search");return U.e=p(ne,D,U.e),B!==U.t&&Jt(ne,"title",U.t=B),U},{e:void 0,t:void 0}),ne}}),null),a(k,A(Me,{get when(){return u()&&t.showResults!==!1},get children(){var ne=t1();return a(ne,A(Me,{get when(){return s()},get children(){var U=ak();return U.firstChild,p(U,_),a(U,s,null),U}}),null),a(ne,A(Me,{get when(){return c().length>0},get fallback(){return ke(()=>!!(r()&&!i()))()&&(()=>{var U=t1();return p(U,O),a(U,()=>e("inventory.noInventorysFound","No inventorys found matching your search.")),U})()},get children(){return A(vt,{get each(){return c()},children:(U,D)=>{const B=E(U.id),Q=B<=U.minStockLevel;return(()=>{var Z=ck(),oe=Z.firstChild,de=oe.firstChild,re=de.firstChild,Y=re.nextSibling,ce=Y.firstChild,ue=ce.firstChild,ae=ce.nextSibling,ye=ae.nextSibling,me=ye.nextSibling,pe=me.nextSibling,ve=de.nextSibling,Ne=ve.firstChild,Ie=Ne.firstChild,Ce=Ne.nextSibling;return Z.addEventListener("mouseenter",()=>m(D())),Z.$$click=()=>te(U),p(oe,R),p(de,J),p(re,X),a(re,()=>U.name),p(Y,H),a(ce,()=>e("inventory.sku","SKU"),ue),a(ce,()=>U.sku,null),a(ye,()=>U.category),a(pe,()=>L(U.unitCost)),p(ve,se),Ne.style.setProperty("font-weight","600"),(Q?"#f44336":"var(--text-primary)")!=null?Ne.style.setProperty("color",Q?"#f44336":"var(--text-primary)"):Ne.style.removeProperty("color"),a(Ne,B,Ie),a(Ne,()=>U.unitOfMeasure,null),Ce.style.setProperty("color","var(--text-muted)"),a(Ce,()=>Q?(()=>{var Ee=dk();return Ee.firstChild,Ee.style.setProperty("color","#f44336"),a(Ee,()=>e("inventory.lowStock","Low Stock"),null),Ee})():e("inventory.inStock","In Stock")),ge(Ee=>p(Z,T(D()===g()),Ee)),Z})()}})}}),null),ge(U=>p(ne,z,U)),ne}}),null),ge(ne=>{var U=M,D=P,B=w,Q=t.placeholder||e("inventory.searchInventorys","Search inventorys by name, SKU, or category..."),Z=t.disabled;return ne.e=p(k,U,ne.e),ne.t=p($,D,ne.t),ne.a=p(G,B,ne.a),Q!==ne.o&&Jt(G,"placeholder",ne.o=Q),Z!==ne.i&&(G.disabled=ne.i=Z),ne},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ge(()=>G.value=r()),k})()};Wt(["input","keydown","click"]);var hk=le("<div>"),Rm=le("<div><span>:</span><span>"),pk=le("<div><button> "),mk=le("<div><div><div><h3></h3><div>: </div></div><div><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span> <!>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span>");const yk=t=>{const{t:e}=or(),r=m=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(m),n=m=>new Date(m).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),i=m=>({in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}})[m]||{bg:"#f5f5f5",color:"#666"},o=m=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[m]||"📋",s=()=>t.movement,l={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},c={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},d={"font-weight":"600",color:"var(--text-primary)","text-align":"right"},u={"margin-bottom":"1.5rem"},h={"font-weight":"600","margin-bottom":"0.75rem","padding-bottom":"0.5rem","border-bottom":"2px solid var(--border-color)"},g=m=>({display:"inline-flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"600","text-transform":"uppercase","letter-spacing":"0.5px",background:i(m).bg,color:i(m).color});return A(Bn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.movementDetails")},size:"lg",get children(){return A(Me,{get when(){return s()},get fallback(){return(()=>{var m=hk();return a(m,()=>e("common.noDataFound")),m})()},children:m=>(()=>{var S=mk(),N=S.firstChild,x=N.firstChild,b=x.firstChild,K=b.nextSibling,te=K.firstChild,F=x.nextSibling,V=F.firstChild,W=N.nextSibling,I=W.firstChild,E=I.nextSibling,L=E.firstChild,M=L.firstChild,P=L.nextSibling,w=E.nextSibling,v=w.firstChild,j=v.firstChild,z=v.nextSibling,T=z.firstChild,R=w.nextSibling,J=R.firstChild,X=J.firstChild,H=J.nextSibling,se=R.nextSibling,O=se.firstChild,_=O.firstChild,k=_.nextSibling;k.nextSibling;var $=O.nextSibling,G=W.nextSibling,ne=G.firstChild,U=ne.nextSibling,D=U.firstChild,B=D.firstChild,Q=D.nextSibling,Z=G.nextSibling,oe=Z.firstChild,de=oe.nextSibling,re=de.firstChild,Y=re.firstChild,ce=re.nextSibling,ue=de.nextSibling,ae=ue.firstChild,ye=ae.firstChild,me=ae.nextSibling;return N.style.setProperty("display","flex"),N.style.setProperty("justify-content","space-between"),N.style.setProperty("align-items","center"),N.style.setProperty("margin-bottom","1.5rem"),N.style.setProperty("padding-bottom","1rem"),N.style.setProperty("border-bottom","2px solid var(--border-color)"),b.style.setProperty("margin","0 0 0.5rem 0"),b.style.setProperty("font-size","1.25rem"),a(b,()=>m().productName),K.style.setProperty("font-size","0.875rem"),K.style.setProperty("color","var(--text-muted)"),a(K,()=>e("inventory.sku"),te),a(K,()=>m().productSku,null),F.$$click=()=>gt.generateMovementInvoice(m().id,e),V.style.setProperty("font-size","1.2rem"),a(V,()=>o(m().movementType)),a(F,()=>m().movementType,null),a(I,()=>e("inventory.movementInformation")),a(L,()=>e("inventory.referenceNumber"),M),a(P,()=>m().referenceNumber),a(v,()=>e("common.quantity"),j),a(z,()=>m().quantity,T),a(z,()=>e("common.units"),null),a(J,()=>e("inventory.unitCost"),X),a(H,()=>r(m().unitCost)),a(O,()=>e("common.total"),_),a(O,()=>e("common.value"),k),a($,()=>r(m().totalCost)),a(ne,()=>e("inventory.locationInformation")),a(D,()=>e("inventory.location"),B),a(Q,()=>m().locationName),a(G,A(Me,{get when(){return m().fromLocationName},get children(){var pe=Rm(),ve=pe.firstChild,Ne=ve.firstChild,Ie=ve.nextSibling;return a(ve,()=>e("common.from"),Ne),a(Ie,()=>m().fromLocationName),ge(Ce=>{var Ee=l,we=c,Re=d;return Ce.e=p(pe,Ee,Ce.e),Ce.t=p(ve,we,Ce.t),Ce.a=p(Ie,Re,Ce.a),Ce},{e:void 0,t:void 0,a:void 0}),pe}}),null),a(G,A(Me,{get when(){return m().invoiceId},get children(){var pe=Rm(),ve=pe.firstChild,Ne=ve.firstChild,Ie=ve.nextSibling;return a(ve,()=>e("common.invoice"),Ne),a(Ie,()=>m().invoiceId),ge(Ce=>{var Ee=l,we=c,Re={...d,color:"var(--primary-color)"};return Ce.e=p(pe,Ee,Ce.e),Ce.t=p(ve,we,Ce.t),Ce.a=p(Ie,Re,Ce.a),Ce},{e:void 0,t:void 0,a:void 0}),pe}}),null),a(oe,()=>e("common.details")),a(re,()=>e("common.createdBy"),Y),a(ce,()=>m().createdBy),a(ae,()=>e("common.created"),ye),a(me,()=>n(m().createdDate)),a(Z,A(Me,{get when(){return m().notes},get children(){var pe=Rm(),ve=pe.firstChild,Ne=ve.firstChild,Ie=ve.nextSibling;return a(ve,()=>e("common.notes"),Ne),a(Ie,()=>m().notes),ge(Ce=>{var Ee={...l,"border-bottom":"none"},we=c,Re={...d,"font-style":"italic","max-width":"60%","white-space":"pre-wrap"};return Ce.e=p(pe,Ee,Ce.e),Ce.t=p(ve,we,Ce.t),Ce.a=p(Ie,Re,Ce.a),Ce},{e:void 0,t:void 0,a:void 0}),pe}}),null),a(S,A(Me,{get when(){return t.onEdit},get children(){var pe=pk(),ve=pe.firstChild,Ne=ve.firstChild;return pe.style.setProperty("display","flex"),pe.style.setProperty("justify-content","flex-end"),pe.style.setProperty("margin-top","1.5rem"),pe.style.setProperty("padding-top","1rem"),pe.style.setProperty("border-top","1px solid var(--border-color)"),ve.addEventListener("mouseleave",Ie=>{Ie.currentTarget.style.transform="translateY(0)",Ie.currentTarget.style.boxShadow="none"}),ve.addEventListener("mouseenter",Ie=>{Ie.currentTarget.style.transform="translateY(-1px)",Ie.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)"}),ve.$$click=()=>t.onEdit?.(m()),ve.style.setProperty("padding","0.5rem 1.5rem"),ve.style.setProperty("border-radius","var(--border-radius-sm)"),ve.style.setProperty("border","1px solid var(--primary-color)"),ve.style.setProperty("background","var(--primary-color)"),ve.style.setProperty("color","white"),ve.style.setProperty("cursor","pointer"),ve.style.setProperty("font-weight","500"),ve.style.setProperty("transition","all 0.2s ease"),a(ve,()=>e("common.edit"),Ne),a(ve,()=>e("inventory.movement"),null),pe}}),null),ge(pe=>{var ve=g(m().movementType),Ne=u,Ie=h,Ce=l,Ee=c,we=d,Re=l,He=c,je={...d,"font-size":"1.1rem",color:"var(--primary-color)"},Ve=l,qe=c,tt=d,rt=l,Be=c,Ge={...d,"font-size":"1.1rem",color:"var(--primary-color)"},Fe=u,at=h,lt=l,Xe=c,Ct=d,Le=u,nt=h,We=l,kt=c,Et=d,Ot=l,jt=c,mt=d;return pe.e=p(F,ve,pe.e),pe.t=p(W,Ne,pe.t),pe.a=p(I,Ie,pe.a),pe.o=p(E,Ce,pe.o),pe.i=p(L,Ee,pe.i),pe.n=p(P,we,pe.n),pe.s=p(w,Re,pe.s),pe.h=p(v,He,pe.h),pe.r=p(z,je,pe.r),pe.d=p(R,Ve,pe.d),pe.l=p(J,qe,pe.l),pe.u=p(H,tt,pe.u),pe.c=p(se,rt,pe.c),pe.w=p(O,Be,pe.w),pe.m=p($,Ge,pe.m),pe.f=p(G,Fe,pe.f),pe.y=p(ne,at,pe.y),pe.g=p(U,lt,pe.g),pe.p=p(D,Xe,pe.p),pe.b=p(Q,Ct,pe.b),pe.T=p(Z,Le,pe.T),pe.A=p(oe,nt,pe.A),pe.O=p(de,We,pe.O),pe.I=p(re,kt,pe.I),pe.S=p(ce,Et,pe.S),pe.W=p(ue,Ot,pe.W),pe.C=p(ae,jt,pe.C),pe.B=p(me,mt,pe.B),pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),S})()})}})};Wt(["click"]);var cl=le("<div>"),fk=le("<div><label></label><select><option value>"),gk=le("<div><div><span>:</span><span>$"),vk=le("<form><div><label></label><select><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><input type=number min=0.01 step=0.01></div><div><label></label><input type=number min=0 step=0.01></div><div><label></label><input type=text></div><div><label> (<!>)</label><input type=text></div><div><label> (<!>)</label><textarea></textarea></div><div><button type=button></button><button type=submit>"),r1=le("<option> (<!>)");const bk=t=>{const{t:e}=or(),[r,n]=Se("in"),[i,o]=Se(""),[s,l]=Se(""),[c,d]=Se(""),[u,h]=Se(""),[g,m]=Se(""),[S,N]=Se(""),[x,b]=Se(""),[K,te]=Se(!1),[F,V]=Se({});Un(()=>{const j=t.movement;j&&t.isOpen&&(n(j.movementType),o(j.quantity.toString()),l(j.unitCost.toString()),d(j.referenceNumber),h(j.notes),N(j.locationId),m(j.fromLocationId||""),b(j.invoiceId||""),V({}))});const W=()=>{const j={};return(!i()||parseFloat(i())<=0)&&(j.quantity=e("forms.requiredField")),(!s()||parseFloat(s())<0)&&(j.unitCost=e("forms.requiredField")),c().trim()||(j.referenceNumber=e("forms.requiredField")),S()||(j.locationId=e("forms.requiredField")),r()==="transfer"&&!g()&&(j.fromLocationId=e("forms.requiredField")),V(j),Object.keys(j).length===0},I=async j=>{if(j.preventDefault(),!(!W()||!t.movement)){te(!0);try{const z=t.movement,T=gt.getProductById(z.productId),R=gt.getLocationById(S()),J=g()?gt.getLocationById(g()):null;if(!T||!R)throw new Error("Product or location not found");const X={...z,movementType:r(),quantity:parseFloat(i()),unitCost:parseFloat(s()),totalCost:parseFloat(i())*parseFloat(s()),referenceNumber:c().trim(),notes:u().trim(),locationId:S(),locationName:R.name,fromLocationId:g()||void 0,fromLocationName:J?.name,invoiceId:x().trim()||void 0,lastModified:new Date().toISOString()};gt.updateMovement(z.id,X),t.onMovementUpdated?.(),t.onClose(),E()}catch(z){console.error("Error updating movement:",z),V({submit:e("forms.saveError")})}finally{te(!1)}}},E=()=>{n("in"),o(""),l(""),d(""),h(""),m(""),N(""),b(""),V({})},L=()=>{E(),t.onClose()},M={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",transition:"border-color 0.2s ease"},P={display:"block","margin-bottom":"0.25rem","font-weight":"500","font-size":"0.875rem"},w={color:"#d32f2f","font-size":"0.75rem","margin-top":"0.25rem"},v={"margin-bottom":"1rem"};return A(Bn,{get isOpen(){return t.isOpen},onClose:L,get title(){return e("inventory.editMovement","Edit Movement")},get children(){return A(Me,{get when(){return t.movement},get fallback(){return(()=>{var j=cl();return a(j,()=>e("common.loading")),j})()},get children(){var j=vk(),z=j.firstChild,T=z.firstChild,R=T.nextSibling,J=R.firstChild,X=J.nextSibling,H=X.nextSibling,se=H.nextSibling,O=z.nextSibling,_=O.firstChild,k=_.nextSibling,$=k.firstChild,G=O.nextSibling,ne=G.firstChild,U=ne.nextSibling,D=G.nextSibling,B=D.firstChild,Q=B.nextSibling,Z=D.nextSibling,oe=Z.firstChild,de=oe.nextSibling,re=Z.nextSibling,Y=re.firstChild,ce=Y.firstChild,ue=ce.nextSibling;ue.nextSibling;var ae=Y.nextSibling,ye=re.nextSibling,me=ye.firstChild,pe=me.firstChild,ve=pe.nextSibling;ve.nextSibling;var Ne=me.nextSibling,Ie=ye.nextSibling,Ce=Ie.firstChild,Ee=Ce.nextSibling;return j.addEventListener("submit",I),a(T,()=>e("inventory.movementType")),R.addEventListener("change",we=>n(we.target.value)),a(J,()=>e("inventory.stockIn")),a(X,()=>e("inventory.stockOut")),a(H,()=>e("inventory.transfer")),a(se,()=>e("inventory.adjustment")),a(_,(()=>{var we=ke(()=>r()==="transfer");return()=>we()?e("inventory.toLocation"):e("inventory.location")})()),k.addEventListener("change",we=>N(we.target.value)),a($,()=>e("modals.selectLocation")),a(k,A(vt,{get each(){return gt.getActiveLocations()},children:we=>(()=>{var Re=r1(),He=Re.firstChild,je=He.nextSibling;return je.nextSibling,a(Re,()=>we.name,He),a(Re,()=>we.type,je),ge(()=>Re.value=we.id),Re})()}),null),a(O,A(Me,{get when(){return F().locationId},get children(){var we=cl();return a(we,()=>F().locationId),ge(Re=>p(we,w,Re)),we}}),null),a(j,A(Me,{get when(){return r()==="transfer"},get children(){var we=fk(),Re=we.firstChild,He=Re.nextSibling,je=He.firstChild;return a(Re,()=>e("inventory.fromLocation")),He.addEventListener("change",Ve=>m(Ve.target.value)),a(je,()=>e("modals.selectLocation")),a(He,A(vt,{get each(){return gt.getActiveLocations().filter(Ve=>Ve.id!==S())},children:Ve=>(()=>{var qe=r1(),tt=qe.firstChild,rt=tt.nextSibling;return rt.nextSibling,a(qe,()=>Ve.name,tt),a(qe,()=>Ve.type,rt),ge(()=>qe.value=Ve.id),qe})()}),null),a(we,A(Me,{get when(){return F().fromLocationId},get children(){var Ve=cl();return a(Ve,()=>F().fromLocationId),ge(qe=>p(Ve,w,qe)),Ve}}),null),ge(Ve=>{var qe=v,tt=P,rt={...M,"border-color":F().fromLocationId?"#d32f2f":"var(--border-color)"},Be=K();return Ve.e=p(we,qe,Ve.e),Ve.t=p(Re,tt,Ve.t),Ve.a=p(He,rt,Ve.a),Be!==Ve.o&&(He.disabled=Ve.o=Be),Ve},{e:void 0,t:void 0,a:void 0,o:void 0}),ge(()=>He.value=g()),we}}),G),a(ne,()=>e("common.quantity")),U.$$input=we=>o(we.target.value),a(G,A(Me,{get when(){return F().quantity},get children(){var we=cl();return a(we,()=>F().quantity),ge(Re=>p(we,w,Re)),we}}),null),a(B,()=>e("inventory.unitCost")),Q.$$input=we=>l(we.target.value),a(D,A(Me,{get when(){return F().unitCost},get children(){var we=cl();return a(we,()=>F().unitCost),ge(Re=>p(we,w,Re)),we}}),null),a(j,A(Me,{get when(){return ke(()=>!!i())()&&s()},get children(){var we=gk(),Re=we.firstChild,He=Re.firstChild,je=He.firstChild,Ve=He.nextSibling;return Ve.firstChild,Re.style.setProperty("display","flex"),Re.style.setProperty("justify-content","space-between"),He.style.setProperty("font-weight","500"),a(He,()=>e("common.total"),je),Ve.style.setProperty("font-weight","600"),Ve.style.setProperty("color","var(--primary-color)"),a(Ve,()=>(parseFloat(i()||"0")*parseFloat(s()||"0")).toFixed(2),null),ge(qe=>p(we,{...v,padding:"0.75rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)"},qe)),we}}),Z),a(oe,()=>e("inventory.referenceNumber")),de.$$input=we=>d(we.target.value),a(Z,A(Me,{get when(){return F().referenceNumber},get children(){var we=cl();return a(we,()=>F().referenceNumber),ge(Re=>p(we,w,Re)),we}}),null),a(Y,()=>e("inventory.invoiceNumber"),ce),a(Y,()=>e("common.optional"),ue),ae.$$input=we=>b(we.target.value),a(me,()=>e("common.notes"),pe),a(me,()=>e("common.optional"),ve),Ne.$$input=we=>h(we.target.value),a(j,A(Me,{get when(){return F().submit},get children(){var we=cl();return a(we,()=>F().submit),ge(Re=>p(we,{...w,"margin-bottom":"1rem"},Re)),we}}),Ie),Ie.style.setProperty("display","flex"),Ie.style.setProperty("gap","1rem"),Ie.style.setProperty("justify-content","flex-end"),Ce.$$click=L,Ce.style.setProperty("padding","0.5rem 1rem"),Ce.style.setProperty("border","1px solid var(--border-color)"),Ce.style.setProperty("border-radius","var(--border-radius-sm)"),Ce.style.setProperty("background","white"),Ce.style.setProperty("cursor","pointer"),a(Ce,()=>e("common.cancel")),Ee.style.setProperty("padding","0.5rem 1rem"),Ee.style.setProperty("border","none"),Ee.style.setProperty("border-radius","var(--border-radius-sm)"),Ee.style.setProperty("background","var(--primary-color)"),Ee.style.setProperty("color","white"),Ee.style.setProperty("cursor","pointer"),Ee.style.setProperty("font-weight","500"),a(Ee,(()=>{var we=ke(()=>!!K());return()=>we()?e("modals.processing"):e("inventory.updateMovement","Update Movement")})()),ge(we=>{var Re=v,He=P,je=M,Ve=K(),qe=v,tt=P,rt={...M,"border-color":F().locationId?"#d32f2f":"var(--border-color)"},Be=K(),Ge=v,Fe=P,at={...M,"border-color":F().quantity?"#d32f2f":"var(--border-color)"},lt=e("modals.enterQuantity"),Xe=K(),Ct=v,Le=P,nt={...M,"border-color":F().unitCost?"#d32f2f":"var(--border-color)"},We=e("modals.enterCost"),kt=K(),Et=v,Ot=P,jt={...M,"border-color":F().referenceNumber?"#d32f2f":"var(--border-color)"},mt=e("modals.enterReference"),Zt=K(),rr=v,Dt=P,Kt=M,dt=e("inventory.invoiceNumber"),pt=K(),ze=v,bt=P,Mt={...M,resize:"vertical","min-height":"80px"},ft=e("modals.addNotes"),At=K(),Ht=K(),Yt=K();return we.e=p(z,Re,we.e),we.t=p(T,He,we.t),we.a=p(R,je,we.a),Ve!==we.o&&(R.disabled=we.o=Ve),we.i=p(O,qe,we.i),we.n=p(_,tt,we.n),we.s=p(k,rt,we.s),Be!==we.h&&(k.disabled=we.h=Be),we.r=p(G,Ge,we.r),we.d=p(ne,Fe,we.d),we.l=p(U,at,we.l),lt!==we.u&&Jt(U,"placeholder",we.u=lt),Xe!==we.c&&(U.disabled=we.c=Xe),we.w=p(D,Ct,we.w),we.m=p(B,Le,we.m),we.f=p(Q,nt,we.f),We!==we.y&&Jt(Q,"placeholder",we.y=We),kt!==we.g&&(Q.disabled=we.g=kt),we.p=p(Z,Et,we.p),we.b=p(oe,Ot,we.b),we.T=p(de,jt,we.T),mt!==we.A&&Jt(de,"placeholder",we.A=mt),Zt!==we.O&&(de.disabled=we.O=Zt),we.I=p(re,rr,we.I),we.S=p(Y,Dt,we.S),we.W=p(ae,Kt,we.W),dt!==we.C&&Jt(ae,"placeholder",we.C=dt),pt!==we.B&&(ae.disabled=we.B=pt),we.v=p(ye,ze,we.v),we.k=p(me,bt,we.k),we.x=p(Ne,Mt,we.x),ft!==we.j&&Jt(Ne,"placeholder",we.j=ft),At!==we.q&&(Ne.disabled=we.q=At),Ht!==we.z&&(Ce.disabled=we.z=Ht),Yt!==we.P&&(Ee.disabled=we.P=Yt),we},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0,z:void 0,P:void 0}),ge(()=>R.value=r()),ge(()=>k.value=S()),ge(()=>U.value=i()),ge(()=>Q.value=s()),ge(()=>de.value=c()),ge(()=>ae.value=x()),ge(()=>Ne.value=u()),j}})}})};Wt(["input","click"]);var Pk=le("<div><div></div><div><div><label></label><select><option value=all></option><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),_k=le("<div><h2>"),Sk=le("<div><label>"),wk=le("<div><label></label><select><option value>"),xk=le("<option>"),Ck=le("<div><div>📦</div><div></div><div>"),Ak=le("<div><div><div><div><span></span><h3></h3><span></span></div><div> • </div></div><div><div></div><div> <!> @ </div></div></div><div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div><span>:</span><span>"),$k=le("<span>"),Ek=le("<span>• <!>: "),n1=le("<div><span>:</span><span>"),Ik=le("<div><div><span>:</span><select><option value=10>10</option><option value=25>25</option><option value=50>50</option><option value=100>100</option></select><span></span></div><div><div><span>:</span><input type=number min=1><span> "),Tk=le("<span>..."),kk=le("<button>");const Nk=t=>{const{t:e}=or(),[r,n]=Se(""),[i,o]=Se(""),[s,l]=Se("all"),[c,d]=Se({start:"",end:""}),[u,h]=Se(""),[g,m]=Se(""),[S,N]=Se(1),[x,b]=Se(25),[K,te]=Se(null),[F,V]=Se(!1),[W,I]=Se(!1),E=Nt(()=>{let ae=gt.movements;if(t.filterBy==="product"&&t.filterId?ae=ae.filter(ye=>ye.productId===t.filterId):t.filterBy==="location"&&t.filterId&&(ae=ae.filter(ye=>ye.locationId===t.filterId)),r()&&(ae=ae.filter(ye=>ye.productId===r())),i()&&(ae=ae.filter(ye=>ye.locationId===i())),s()!=="all"&&(ae=ae.filter(ye=>ye.movementType===s())),c().start&&(ae=ae.filter(ye=>ye.createdDate>=c().start)),c().end&&(ae=ae.filter(ye=>ye.createdDate<=c().end+"T23:59:59Z")),u()){const ye=u().toLowerCase();ae=ae.filter(me=>me.productName.toLowerCase().includes(ye)||me.productSku.toLowerCase().includes(ye)||me.locationName.toLowerCase().includes(ye)||me.referenceNumber.toLowerCase().includes(ye)||me.notes.toLowerCase().includes(ye)||me.createdBy.toLowerCase().includes(ye)||me.invoiceId&&me.invoiceId.toLowerCase().includes(ye)||me.fromLocationName&&me.fromLocationName.toLowerCase().includes(ye)||me.movementType.toLowerCase().includes(ye))}return ae.sort((ye,me)=>new Date(me.createdDate).getTime()-new Date(ye.createdDate).getTime())});Un(()=>{r(),i(),s(),c(),u(),N(1)});const L=Nt(()=>{const ae=(S()-1)*x(),ye=ae+x();return E().slice(ae,ye)}),M=Nt(()=>Math.ceil(E().length/x())),P=Nt(()=>{const ae=E();return{total:ae.length,stockIn:ae.filter(ye=>ye.movementType==="in").length,stockOut:ae.filter(ye=>ye.movementType==="out").length,transfers:ae.filter(ye=>ye.movementType==="transfer").length,adjustments:ae.filter(ye=>ye.movementType==="adjustment").length,totalValue:ae.reduce((ye,me)=>ye+me.totalCost,0)}}),w={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},v={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},j={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)",cursor:"pointer"},z={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},T={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem","margin-bottom":"2rem"},R={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","text-align":"center"},J={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},X={"font-size":"0.875rem",color:"var(--text-muted)","font-weight":"500"},H={padding:"1.5rem","margin-bottom":"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",transition:"all 0.2s ease"},se={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"1rem"};function O(ae){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[ae]||{bg:"#f5f5f5",color:"#666"}}const _=ae=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:O(ae).bg,color:O(ae).color}),k={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"1rem"},$={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.5rem 0","border-bottom":"1px solid var(--border-color)"},G={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},ne={"font-weight":"600",color:"var(--text-primary)"},U={display:"flex","justify-content":"space-between","align-items":"center","margin-top":"2rem",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},D=ae=>({padding:"0.25rem 0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:ae?"var(--primary-color)":"var(--surface-color)",color:ae?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),B=ae=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ae),Q=ae=>new Date(ae).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),Z=ae=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[ae]||"📋",oe=()=>{n(""),o(""),l("all"),d({start:"",end:""}),h(""),N(1)},de=ae=>{te(ae),V(!0)},re=ae=>{te(ae),V(!1),I(!0)},Y=()=>{I(!1),te(null)},ce=async ae=>{i()&&(ae+=" "+i()),$y(s())&&(ae+=" "+$y(s()));const ye=await ai.getInventory(ae),me=gt.parseInventoryData(ye);gt.updMovements(me)},ue=()=>{};return(()=>{var ae=Pk(),ye=ae.firstChild,me=ye.nextSibling,pe=me.firstChild,ve=pe.firstChild,Ne=ve.nextSibling,Ie=Ne.firstChild,Ce=Ie.nextSibling,Ee=Ce.nextSibling,we=Ee.nextSibling,Re=we.nextSibling,He=pe.nextSibling,je=He.firstChild,Ve=je.nextSibling,qe=He.nextSibling,tt=qe.firstChild,rt=tt.nextSibling,Be=me.nextSibling,Ge=Be.firstChild,Fe=Ge.firstChild,at=Fe.nextSibling,lt=Ge.nextSibling,Xe=lt.firstChild,Ct=Xe.nextSibling,Le=lt.nextSibling,nt=Le.firstChild,We=nt.nextSibling,kt=Le.nextSibling,Et=kt.firstChild,Ot=Et.nextSibling,jt=kt.nextSibling,mt=jt.firstChild,Zt=mt.nextSibling,rr=jt.nextSibling,Dt=rr.firstChild,Kt=Dt.nextSibling;return a(ae,(()=>{var dt=ke(()=>!t.filterBy);return()=>dt()&&(()=>{var pt=_k(),ze=pt.firstChild;return p(pt,w),ze.style.setProperty("margin","0"),ze.style.setProperty("font-size","1.5rem"),a(ze,()=>e("inventory.movements")),a(pt,A(ct,{variant:"outline",onClick:oe,get children(){return e("common.clearFilters")}}),null),pt})()})(),ye),a(ae,A(uk,{filters:{selectedLocation:i,movementType:s},onSearchResults:dt=>{m(dt),ce(dt)},get placeholder(){return e("inventory.searchProductsStock","Search inventories...")},showResults:!1,maxResults:20}),ye),ye.style.setProperty("margin","20px"),p(me,v),a(me,(()=>{var dt=ke(()=>!t.filterBy);return()=>dt()&&[(()=>{var pt=Sk(),ze=pt.firstChild;return ze.style.setProperty("display","block"),ze.style.setProperty("margin-bottom","0.5rem"),ze.style.setProperty("font-weight","500"),a(ze,()=>e("inventory.product")),a(pt,A(zp,{onChange:bt=>{console.log(bt),n(bt.id)},get placeholder(){return e("inventory.searchProductsImages","Search products to view images...")}}),null),pt})(),(()=>{var pt=wk(),ze=pt.firstChild,bt=ze.nextSibling,Mt=bt.firstChild;return ze.style.setProperty("display","block"),ze.style.setProperty("margin-bottom","0.5rem"),ze.style.setProperty("font-weight","500"),a(ze,()=>e("inventory.location")),bt.addEventListener("change",ft=>o(ft.target.value)),a(Mt,()=>e("inventory.allLocations")),a(bt,A(vt,{get each(){return gt.locations},children:ft=>(()=>{var At=xk();return a(At,()=>ft.name),ge(()=>At.value=ft.id),At})()}),null),ge(ft=>p(bt,j,ft)),ge(()=>bt.value=i()),pt})()]})(),pe),ve.style.setProperty("display","block"),ve.style.setProperty("margin-bottom","0.5rem"),ve.style.setProperty("font-weight","500"),a(ve,()=>e("inventory.movementType")),Ne.addEventListener("change",dt=>{l(dt.target.value),ce(g())}),a(Ie,()=>e("inventory.allTypes")),a(Ce,()=>e("inventory.stockIn")),a(Ee,()=>e("inventory.stockOut")),a(we,()=>e("inventory.transfer")),a(Re,()=>e("inventory.adjustment")),je.style.setProperty("display","block"),je.style.setProperty("margin-bottom","0.5rem"),je.style.setProperty("font-weight","500"),a(je,()=>e("common.startDate")),Ve.addEventListener("change",dt=>d(pt=>({...pt,start:dt.target.value}))),tt.style.setProperty("display","block"),tt.style.setProperty("margin-bottom","0.5rem"),tt.style.setProperty("font-weight","500"),a(tt,()=>e("common.endDate")),rt.addEventListener("change",dt=>d(pt=>({...pt,end:dt.target.value}))),p(Be,T),a(Fe,()=>P().total),a(at,()=>e("inventory.totalMovements")),a(Xe,()=>P().stockIn),a(Ct,()=>e("inventory.stockIn")),a(nt,()=>P().stockOut),a(We,()=>e("inventory.stockOut")),a(Et,()=>P().transfers),a(Ot,()=>e("inventory.transfers")),a(mt,()=>P().adjustments),a(Zt,()=>e("inventory.adjustments")),Dt.$$click=ue,a(Dt,()=>B(P().totalValue)),a(Kt,()=>e("inventory.totalValue")),a(ae,(()=>{var dt=ke(()=>L().length===0);return()=>dt()?(()=>{var pt=Ck(),ze=pt.firstChild,bt=ze.nextSibling,Mt=bt.nextSibling;return pt.style.setProperty("text-align","center"),pt.style.setProperty("padding","3rem"),pt.style.setProperty("color","var(--text-muted)"),pt.style.setProperty("background","var(--surface-color)"),pt.style.setProperty("border-radius","var(--border-radius)"),pt.style.setProperty("border","1px solid var(--border-color)"),ze.style.setProperty("font-size","1.5rem"),ze.style.setProperty("margin-bottom","1rem"),bt.style.setProperty("font-size","1.1rem"),bt.style.setProperty("margin-bottom","0.5rem"),a(bt,()=>e("inventory.noMovementsFound")),Mt.style.setProperty("font-size","0.875rem"),a(Mt,()=>e("inventory.tryAdjustingFilters")),pt})():[A(vt,{get each(){return L()},children:pt=>(()=>{var ze=Ak(),bt=ze.firstChild,Mt=bt.firstChild,ft=Mt.firstChild,At=ft.firstChild,Ht=At.nextSibling,Yt=Ht.nextSibling,nr=ft.nextSibling,Dr=nr.firstChild,vr=Mt.nextSibling,tr=vr.firstChild,Bt=tr.nextSibling,ar=Bt.firstChild,br=ar.nextSibling;br.nextSibling;var $r=bt.nextSibling,mr=$r.firstChild,sr=mr.firstChild,Ir=sr.firstChild,dr=Ir.firstChild,rn=Ir.nextSibling,Zn=sr.nextSibling,Gn=Zn.firstChild,Li=Gn.firstChild,Wn=Gn.nextSibling,so=mr.nextSibling,Ur=so.firstChild,Ri=Ur.firstChild,Po=Ri.firstChild,_o=Ri.nextSibling;return ze.addEventListener("mouseleave",fr=>{fr.currentTarget.style.transform="translateY(0)",fr.currentTarget.style.boxShadow="none"}),ze.addEventListener("mouseenter",fr=>{fr.currentTarget.style.transform="translateY(-2px)",fr.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),ze.$$click=()=>de(pt),p(bt,se),ft.style.setProperty("display","flex"),ft.style.setProperty("align-items","center"),ft.style.setProperty("gap","0.5rem"),ft.style.setProperty("margin-bottom","0.5rem"),At.style.setProperty("font-size","1.2rem"),a(At,()=>Z(pt.movementType)),Ht.style.setProperty("margin","0"),Ht.style.setProperty("font-size","1.1rem"),a(Ht,()=>pt.productName),a(Yt,()=>pt.movementType),a(ft,(()=>{var fr=ke(()=>!!pt.invoiceId);return()=>fr()&&(()=>{var jr=$k();return jr.style.setProperty("padding","0.2rem 0.5rem"),jr.style.setProperty("border-radius","var(--border-radius-sm)"),jr.style.setProperty("font-size","0.7rem"),jr.style.setProperty("font-weight","500"),jr.style.setProperty("background","var(--primary-color)"),jr.style.setProperty("color","white"),a(jr,()=>e("inventory.bulk")),jr})()})(),null),nr.style.setProperty("font-size","0.875rem"),nr.style.setProperty("color","var(--text-muted)"),a(nr,()=>pt.productSku,Dr),a(nr,()=>Q(pt.createdDate),null),a(nr,(()=>{var fr=ke(()=>!!pt.invoiceId);return()=>fr()&&(()=>{var jr=Ek(),nn=jr.firstChild,ei=nn.nextSibling;return ei.nextSibling,jr.style.setProperty("margin-left","0.5rem"),jr.style.setProperty("font-weight","500"),a(jr,()=>e("common.invoice"),ei),a(jr,()=>pt.invoiceId,null),jr})()})(),null),vr.style.setProperty("text-align","right"),tr.style.setProperty("font-size","1.25rem"),tr.style.setProperty("font-weight","700"),tr.style.setProperty("color","var(--primary-color)"),a(tr,()=>B(pt.totalCost)),Bt.style.setProperty("font-size","0.875rem"),Bt.style.setProperty("color","var(--text-muted)"),a(Bt,()=>pt.quantity,ar),a(Bt,()=>e("common.units"),br),a(Bt,()=>B(pt.unitCost),null),p($r,k),a(Ir,()=>e("inventory.location"),dr),a(rn,()=>pt.locationName),a(mr,(()=>{var fr=ke(()=>!!pt.fromLocationName);return()=>fr()&&(()=>{var jr=n1(),nn=jr.firstChild,ei=nn.firstChild,Hr=nn.nextSibling;return a(nn,()=>e("common.from"),ei),a(Hr,()=>pt.fromLocationName),ge(Fr=>{var wi=$,Di=G,Wi=ne;return Fr.e=p(jr,wi,Fr.e),Fr.t=p(nn,Di,Fr.t),Fr.a=p(Hr,Wi,Fr.a),Fr},{e:void 0,t:void 0,a:void 0}),jr})()})(),Zn),a(Gn,()=>e("common.reference"),Li),a(Wn,()=>pt.referenceNumber),a(Ri,()=>e("common.createdBy"),Po),a(_o,()=>pt.createdBy),a(so,(()=>{var fr=ke(()=>!!pt.notes);return()=>fr()&&(()=>{var jr=n1(),nn=jr.firstChild,ei=nn.firstChild,Hr=nn.nextSibling;return a(nn,()=>e("common.notes"),ei),a(Hr,()=>pt.notes),ge(Fr=>{var wi={...$,"border-bottom":"none"},Di=G,Wi={...ne,"max-width":"200px","text-align":"right","font-style":"italic"};return Fr.e=p(jr,wi,Fr.e),Fr.t=p(nn,Di,Fr.t),Fr.a=p(Hr,Wi,Fr.a),Fr},{e:void 0,t:void 0,a:void 0}),jr})()})(),null),ge(fr=>{var jr={...H,"border-left":pt.invoiceId?"4px solid var(--primary-color)":"1px solid var(--border-color)",cursor:"pointer"},nn=_(pt.movementType),ei=$,Hr=G,Fr=ne,wi=$,Di=G,Wi=ne,zr=$,So=G,wo=ne;return fr.e=p(ze,jr,fr.e),fr.t=p(Yt,nn,fr.t),fr.a=p(sr,ei,fr.a),fr.o=p(Ir,Hr,fr.o),fr.i=p(rn,Fr,fr.i),fr.n=p(Zn,wi,fr.n),fr.s=p(Gn,Di,fr.s),fr.h=p(Wn,Wi,fr.h),fr.r=p(Ur,zr,fr.r),fr.d=p(Ri,So,fr.d),fr.l=p(_o,wo,fr.l),fr},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),ze})()}),ke(()=>ke(()=>M()>1)()&&(()=>{var pt=Ik(),ze=pt.firstChild,bt=ze.firstChild,Mt=bt.firstChild,ft=bt.nextSibling,At=ft.nextSibling,Ht=ze.nextSibling,Yt=Ht.firstChild,nr=Yt.firstChild,Dr=nr.firstChild,vr=nr.nextSibling,tr=vr.nextSibling,Bt=tr.firstChild;return p(pt,U),ze.style.setProperty("display","flex"),ze.style.setProperty("align-items","center"),ze.style.setProperty("gap","0.5rem"),bt.style.setProperty("font-size","0.875rem"),bt.style.setProperty("color","var(--text-muted)"),a(bt,()=>e("common.showPerPage","Show per page"),Mt),ft.addEventListener("change",ar=>{b(Number(ar.target.value)),N(1)}),ft.style.setProperty("padding","0.25rem 0.5rem"),ft.style.setProperty("border","1px solid var(--border-color)"),ft.style.setProperty("border-radius","var(--border-radius-sm)"),ft.style.setProperty("background","var(--surface-color)"),ft.style.setProperty("cursor","pointer"),ft.style.setProperty("font-size","0.875rem"),At.style.setProperty("font-size","0.875rem"),At.style.setProperty("color","var(--text-muted)"),At.style.setProperty("margin-left","1rem"),a(At,()=>e("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:(S()-1)*x()+1,end:Math.min(S()*x(),E().length),total:E().length})),Ht.style.setProperty("display","flex"),Ht.style.setProperty("align-items","center"),Ht.style.setProperty("gap","0.5rem"),a(Ht,A(ct,{variant:"outline",size:"sm",onClick:()=>N(1),get disabled(){return S()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.first","First")}}),Yt),a(Ht,A(ct,{variant:"outline",size:"sm",onClick:()=>N(ar=>Math.max(1,ar-1)),get disabled(){return S()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.previous")}}),Yt),a(Ht,()=>{const ar=[],br=M(),$r=S();if(br<=7)for(let mr=1;mr<=br;mr++)ar.push(mr);else{ar.push(1),$r>3&&ar.push("...");for(let mr=Math.max(2,$r-1);mr<=Math.min(br-1,$r+1);mr++)ar.includes(mr)||ar.push(mr);$r<br-2&&ar.push("..."),ar.includes(br)||ar.push(br)}return A(vt,{each:ar,children:mr=>mr==="..."?(()=>{var sr=Tk();return sr.style.setProperty("padding","0 0.5rem"),sr.style.setProperty("color","var(--text-muted)"),sr})():(()=>{var sr=kk();return sr.$$click=()=>N(mr),a(sr,mr),ge(Ir=>p(sr,D(mr===S()),Ir)),sr})()})},Yt),a(Ht,A(ct,{variant:"outline",size:"sm",onClick:()=>N(ar=>Math.min(M(),ar+1)),get disabled(){return S()===M()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.next")}}),Yt),a(Ht,A(ct,{variant:"outline",size:"sm",onClick:()=>N(M()),get disabled(){return S()===M()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.last","Last")}}),Yt),Yt.style.setProperty("display","flex"),Yt.style.setProperty("align-items","center"),Yt.style.setProperty("gap","0.5rem"),Yt.style.setProperty("margin-left","1rem"),nr.style.setProperty("font-size","0.875rem"),nr.style.setProperty("color","var(--text-muted)"),a(nr,()=>e("common.page","Page"),Dr),vr.addEventListener("change",ar=>{const br=Number(ar.target.value);br>=1&&br<=M()&&N(br)}),vr.style.setProperty("width","4rem"),vr.style.setProperty("padding","0.25rem 0.5rem"),vr.style.setProperty("border","1px solid var(--border-color)"),vr.style.setProperty("border-radius","var(--border-radius-sm)"),vr.style.setProperty("background","var(--surface-color)"),vr.style.setProperty("text-align","center"),vr.style.setProperty("font-size","0.875rem"),tr.style.setProperty("font-size","0.875rem"),tr.style.setProperty("color","var(--text-muted)"),a(tr,()=>e("common.of","of"),Bt),a(tr,M,null),ge(()=>Jt(vr,"max",M())),ge(()=>ft.value=x()),ge(()=>vr.value=S()),pt})())]})(),null),a(ae,A(yk,{get isOpen(){return F()},onClose:()=>{V(!1),te(null)},get movement(){return K()},onEdit:re}),null),a(ae,A(Me,{get when(){return Gt.hasPermission("read_write")},get children(){return A(bk,{get isOpen(){return W()},onClose:()=>{I(!1),te(null)},get movement(){return K()},onMovementUpdated:Y})}}),null),ge(dt=>{var pt=j,ze=z,bt=z,Mt=R,ft=J,At=X,Ht=R,Yt={...J,color:"#2d7d32"},nr=X,Dr=R,vr={...J,color:"#d32f2f"},tr=X,Bt=R,ar={...J,color:"#1976d2"},br=X,$r=R,mr={...J,color:"#f57c00"},sr=X,Ir=R,dr=J,rn=X;return dt.e=p(Ne,pt,dt.e),dt.t=p(Ve,ze,dt.t),dt.a=p(rt,bt,dt.a),dt.o=p(Ge,Mt,dt.o),dt.i=p(Fe,ft,dt.i),dt.n=p(at,At,dt.n),dt.s=p(lt,Ht,dt.s),dt.h=p(Xe,Yt,dt.h),dt.r=p(Ct,nr,dt.r),dt.d=p(Le,Dr,dt.d),dt.l=p(nt,vr,dt.l),dt.u=p(We,tr,dt.u),dt.c=p(kt,Bt,dt.c),dt.w=p(Et,ar,dt.w),dt.m=p(Ot,br,dt.m),dt.f=p(jt,$r,dt.f),dt.y=p(mt,mr,dt.y),dt.g=p(Zt,sr,dt.g),dt.p=p(rr,Ir,dt.p),dt.b=p(Dt,dr,dt.b),dt.T=p(Kt,rn,dt.T),dt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),ge(()=>Ne.value=s()),ge(()=>Ve.value=c().start),ge(()=>rt.value=c().end),ae})()};Wt(["click"]);var Lk=le("<div><p>📋 "),Rk=le("<div>"),Dk=le("<div><div>📊</div><h3></h3><p></p><div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=name></option><option value=sku></option><option value=category>"),Mk=le("<div><div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div>%</div><div></div></div></div><div></div><div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),Fk=le("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),Ok=le("<div><div>✅</div><h3></h3><p>"),Bk=le("<div><div><h3>📋 </h3><p></p></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div></div><div>"),Vk=le("<div><div><div><h2>📋 </h2><button>×"),i1=le("<option>"),jk=le("<div>..."),zk=le("<tr><td><div></div><div> • </div></td><td><div></div></td><td><div></div></td><td><div></div></td><td><div>"),qk=le("<tr><td><div></div></td><td><div></div><div> • <!> • </div></td><td><div></div></td><td><input type=number placeholder=0 min=0 step=0.01></td><td><div></div></td><td><input type=text>");const Uk=t=>{const{t:e}=or(),[r,n]=Se([]),[i,o]=Se(!1),[s,l]=Se(!1),[c,d]=Se("all"),[u,h]=Se("all"),[g,m]=Se("name"),[S,N]=Se([]),[x,b]=Se("setup"),K=async()=>{try{o(!0);const X=await ai.getProducts("prod");if(!X||typeof X!="object"){console.warn("No API results, using local store"),n(gt.products);return}const H=Object.keys(X),se=_=>{let $=X[_];return{id:_,name:$.name||"Unknown Product",businessId:$.businessId||"",sku:$.code||$.sku||"",UPC:$.UPC||"",numCode:$.codeN||"",category:$.category||"General",unitCost:$.unitCost||0,unitOfMeasure:$.unitOfMeasure||"pcs",minStockLevel:$.minStockLevel||0,maxStockLevel:$.maxStockLevel||100,isActive:$.isActive!==!1,description:$.description||"",createdDate:$.createdAt||new Date().toISOString(),lastModified:$.updatedAt||new Date().toISOString(),sellingPrice:parseFloat($.sellingPrice||$.price||"0")}},O=H.map(se);n(O)}catch(X){console.error("Failed to load products from API:",X),n(gt.products)}finally{o(!1)}},te=Nt(()=>[...new Set(r().map(H=>H.category).filter(H=>H))].sort()),F=Nt(()=>{let X=r().filter(H=>H.isActive);return u()!=="all"&&(X=X.filter(H=>H.category===u())),X.sort((H,se)=>{switch(g()){case"name":return H.name.localeCompare(se.name);case"sku":return H.sku.localeCompare(se.sku);case"category":return H.category.localeCompare(se.category)||H.name.localeCompare(se.name);default:return 0}}),X}),V=Nt(()=>gt.getActiveLocations()),W=(X,H)=>H&&H!=="all"?gt.getStockByProductAndLocation(X,H)?.quantity||0:gt.getTotalStockByProduct(X),I=()=>{const X=F().map(H=>{const se=W(H.id,c()!=="all"?c():void 0);return{productId:H.id,systemQuantity:se,physicalCount:null,notes:"",variance:0,product:H}});N(X),b("counting")},E=(X,H)=>{N(se=>se.map(O=>{if(O.productId===X){const _=H,k=_!==null?_-O.systemQuantity:0;return{...O,physicalCount:_,variance:k}}return O}))},L=(X,H)=>{N(se=>se.map(O=>O.productId===X?{...O,notes:H}:O))},M=Nt(()=>{const X=S(),H=X.length,se=X.filter($=>$.physicalCount!==null).length,O=X.filter($=>$.variance!==0).length,_=X.filter($=>$.variance>0).length,k=X.filter($=>$.variance<0).length;return{totalProducts:H,countedProducts:se,remainingProducts:H-se,variances:O,positiveVariances:_,negativeVariances:k,isComplete:se===H}}),P=()=>{const X=S().filter(_=>_.physicalCount!==null&&_.variance!==0);if(X.length===0)return null;const H=[e("inventory.product","Product"),e("inventory.sku","SKU"),e("inventory.category","Category"),e("inventory.location","Location"),e("inventory.systemQty","System Qty"),e("inventory.physicalCount","Physical Count"),e("inventory.variance","Variance"),e("inventory.adjustment","Adjustment"),e("common.notes","Notes"),e("common.date","Date")],se=X.map(_=>[`"${_.product.name}"`,`"${_.product.sku}"`,`"${_.product.category}"`,`"${j()}"`,_.systemQuantity,_.physicalCount,_.variance,_.variance>0?e("inventory.stockIncrease","Stock Increase"):e("inventory.stockDecrease","Stock Decrease"),`"${_.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")}"`,`"${z()}"`]);return[H.join(","),...se.map(_=>_.join(","))].join(`
`)},w=()=>{const X=P();if(!X){alert(e("inventory.noAdjustmentsToDownload","No adjustments to download"));return}const H=new Blob([X],{type:"text/csv;charset=utf-8;"}),se=document.createElement("a");if(se.download!==void 0){const O=URL.createObjectURL(H);se.setAttribute("href",O),se.setAttribute("download",`inventory-adjustments-${z().replace(/[/:,\s]/g,"-")}.csv`),se.style.visibility="hidden",document.body.appendChild(se),se.click(),document.body.removeChild(se)}},v=async(X=!0)=>{try{l(!0),console.log(S());const H=G=>{let ne=gt.getProductById(G.productId),U=gt.getStockByProductAndLocation(G.productId,c()),D=parseFloat(U?.averageCost+""),B=parseFloat(U?.quantity+"");return{product:{id:G.productId,label:ne?.name,code:ne?.code},productId:G?.productId,reason:"Physical Count Adjustment",notes:G?.notes||"Physical inventory adjustment",quantity:G?.variance,unitCost:D}},se=S().filter(G=>G.physicalCount!==null&&G.variance!==0).map(H);let O="ADJ_"+pv();const _=new Date().toISOString(),k={ssg_inventory_key:ki(),invoiceId:O,referenceNumber:pv(),movementType:"adjustment",type:"adjustment",locationId:c(),items:se,products:se,generalNotes:"Physical inventory adjustment",description:"Physical Count Adjustment",invoice:O,store:c(),createdBy:"admin",createDate:_};console.log("Saving inventory bulkRequest:",k);const $=await ai.addInventory(k);X&&se.length>0&&w(),console.log("Saving inventory adjustments:",se),await new Promise(G=>setTimeout(G,1e3)),t.onClose()}catch(H){console.error("Failed to save inventory adjustments:",H)}finally{l(!1)}},j=Nt(()=>c()==="all"?"All Locations":V().find(H=>H.id===c())?.name||"Unknown Location"),z=()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),T=async()=>{await gt.fecthInventory("prod"),await K()};Ln(async()=>{t.selectedLocationId&&d(t.selectedLocationId),T()});const R=()=>{const X=window.open("","_blank");if(!X){alert("Please allow pop-ups to print the counting sheet");return}const H=J();X.document.write(H),X.document.close(),X.onload=()=>{X.print(),X.onafterprint=()=>{X.close()}}},J=()=>{const X=F().map((H,se)=>{const O=W(H.id,c()!=="all"?c():void 0);return`
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${se+1}</td>
          <td style="border: 1px solid #000; padding: 8px; font-family: monospace;">${H.sku}</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 500;">${H.name}</div>
            ${H.UPC?`<div style="font-size: 0.8em; color: #666;">UPC: ${H.UPC}</div>`:""}
          </td>
         
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${H.unitOfMeasure}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">${O}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; background-color: #f9f9f9;"></td>
          <td style="border: 1px solid #000; padding: 8px;"></td>
        </tr>
      `}).join("");return`
      <!DOCTYPE html>
      <html>
      <head>
        <title> ${j()}_${u()}_${e("inventory.countingSheet","Inventory Counting Sheet")} - ${z()}</title>
        <style>
          @page {
            size: letter;
            margin: 0.5in 0.8in 0.5in 0.8in;
            @top-center {
              content: "${j()} | ${u()==="all"?e("inventory.allCategories","All Categories"):u()} | Page " counter(page);
              font-size: 10px;
              font-weight: bold;
              border-bottom: 1px solid #ccc;
              padding-bottom: 5px;
            }
          }
          body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            margin: 0;
            padding: 0;
            position: relative;
          }
          .page-identifier {
            position: fixed;
            left: 5px;
            top: 50%;
            transform: rotate(-90deg) translateX(-50%);
            transform-origin: left center;
            background: #f0f0f0;
            padding: 5px 15px;
            border: 1px solid #ccc;
            font-weight: bold;
            font-size: 10px;
            color: #333;
            z-index: 100;
          }
          .page-identifier-right {
            position: fixed;
            right: 5px;
            top: 50%;
            transform: rotate(90deg) translateX(50%);
            transform-origin: right center;
            background: #f0f0f0;
            padding: 5px 15px;
            border: 1px solid #ccc;
            font-weight: bold;
            font-size: 10px;
            color: #333;
            z-index: 100;
          }
          h1 {
            text-align: center;
            margin: 0 0 10px 0;
            font-size: 22px;
            page-break-after: avoid;
          }
          .header-info {
            text-align: center;
            margin-bottom: 20px;
            background: #f8f8f8;
            padding: 10px;
            border: 2px solid #333;
            page-break-after: avoid;
          }
          .page-header {
            display: none;
            text-align: center;
            background: #e0e0e0;
            padding: 8px;
            border: 1px solid #333;
            margin-bottom: 10px;
            font-weight: bold;
            font-size: 11px;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
          }
          th {
            background-color: #333;
            color: white;
            padding: 8px;
            text-align: left;
            font-weight: bold;
            border: 1px solid #000;
          }
          .summary-table {
            width: 50%;
            margin: 20px auto;
            /*page-break-before: auto;*/
          }
          .signature-section {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
            page-break-before: auto;
          }
          .signature-box {
            width: 45%;
            text-align: center;
          }
          .signature-line {
            border-bottom: 1px solid #000;
            margin-bottom: 5px;
            height: 30px;
          }
          @media print {
            body { margin: 0; }
            .page-identifier, .page-identifier-right { display: block; }
            .page-header { display: block; }
            tr { page-break-inside: avoid; }
            thead { display: table-header-group; }
            tfoot { display: table-footer-group; }
            .header-info { page-break-after: avoid; }
            h1 { page-break-after: avoid; }
            table { page-break-before: auto; }
            /*.summary-table { page-break-before: always; }*/
            .signature-section { page-break-before: avoid; }
            
            /* Repeat headers on each page */
            @page :first {
              @top-center { content: none; }
            }
            
            /* Force page headers to show on continuation pages */
            tbody::before {
              content: "";
              display: block;
              height: 0;
            }
          }
        </style>
      </head>
      <body>
        <!-- Page identifiers for multi-page documents -->
        <div class="page-identifier-right">
          ${j()} - ${u()==="all"?e("inventory.allCategories","All Categories"):u()} - ${z()} 
        </div>
       
        
        <h1>${e("inventory.inventoryCountingSheetTitle","INVENTORY COUNTING SHEET")}</h1>
        <div class="header-info">
          <p><strong>${e("inventory.location","Location")}:</strong> ${j()}</p>
          <p><strong>${e("common.category","Category")}:</strong> ${u()==="all"?e("inventory.allCategories","All Categories"):u()}</p>
          <p><strong>${e("common.date","Date")}:</strong> ${z()}</p>
          <p style="margin-top: 10px;">
            <span style="margin-right: 30px;">${e("inventory.countedBy","Counted by")}: _________________________</span>
            <span>${e("inventory.verifiedBy","Verified by")}: _________________________</span>
          </p>
        </div>

        <!-- Page header for continuation pages (hidden on first page) -->
        <div class="page-header">
          ${j()} | ${u()==="all"?e("inventory.allCategories","All Categories"):u()} | ${z()} 
        </div>

        <table>
          <thead>
            <tr>
              <th style="width: 5%; text-align: center;">#</th>
              <th style="width: 12%;">${e("inventory.sku","SKU")}</th>
              <th style="width: 25%;">${e("inventory.productName","Product Name")}</th>
              <th style="width: 8%; text-align: center;">${e("inventory.unit","Unit")}</th>
              <th style="width: 10%; text-align: center;">${e("inventory.systemQty","System Qty")}</th>
              <th style="width: 12%; text-align: center; background-color: #f0f0f0;">${e("inventory.physicalCount","Physical Count")}</th>
              <th style="width: 28%;">${e("common.notes","Notes")}</th>
            </tr>
            <!-- Repeat header info row for clarity -->
            <tr style="background-color: #f8f8f8; font-size: 10px;">
              <td colspan="8" style="text-align: center; padding: 4px; border: 1px solid #000; font-weight: bold;">
                📍 ${j()} | 📂 ${u()==="all"?e("inventory.allCategories","All Categories"):u()} | 📅 ${z()}
              </td>
            </tr>
          </thead>
          <tbody>
            ${X}
          </tbody>
        </table>
        
        <!-- Summary section with location/category context -->
        <div style="margin: 30px 0; padding: 15px; background: #f8f8f8;">
          <h3 style="text-align: center; margin: 0 0 15px 0; font-size: 16px;">
            ${e("inventory.summaryFor","SUMMARY FOR")}: ${j()} - ${u()==="all"?e("inventory.allCategories","All Categories"):u()}
          </h3>
          
          <table class="summary-table">
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.totalProductsListed","Total Products Listed")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">
                ${F().length}
              </td>
            </tr>
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.itemsCounted","Items Counted")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center;">
                ___________
              </td>
            </tr>
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.discrepanciesFound","Discrepancies Found")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center;">
                ___________
              </td>
            </tr>
          </table>
        </div>
        
        <div class="signature-section">
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.counterSignature","Counter Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.supervisorSignature","Supervisor Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
        </div>
      </body>
      </html>
    `};return A(Me,{get when(){return t.isOpen},get children(){var X=Vk(),H=X.firstChild,se=H.firstChild,O=se.firstChild;O.firstChild;var _=O.nextSibling;return X.style.setProperty("position","fixed"),X.style.setProperty("top","0"),X.style.setProperty("left","0"),X.style.setProperty("right","0"),X.style.setProperty("bottom","0"),X.style.setProperty("background","rgba(0, 0, 0, 0.5)"),X.style.setProperty("z-index","1000"),X.style.setProperty("display","flex"),X.style.setProperty("align-items","center"),X.style.setProperty("justify-content","center"),H.style.setProperty("background","white"),H.style.setProperty("border-radius","var(--border-radius)"),H.style.setProperty("padding","2rem"),H.style.setProperty("width","95%"),H.style.setProperty("height","95%"),H.style.setProperty("max-width","1400px"),H.style.setProperty("overflow-y","auto"),H.style.setProperty("position","relative"),se.style.setProperty("display","flex"),se.style.setProperty("justify-content","space-between"),se.style.setProperty("align-items","center"),se.style.setProperty("margin-bottom","2rem"),se.style.setProperty("border-bottom","1px solid var(--border-color)"),se.style.setProperty("padding-bottom","1rem"),O.style.setProperty("margin","0"),O.style.setProperty("font-size","1.5rem"),a(O,()=>e("inventory.physicalInventoryCount","Physical Inventory Count"),null),Cn(_,"click",t.onClose,!0),_.style.setProperty("background","none"),_.style.setProperty("border","none"),_.style.setProperty("font-size","1.5rem"),_.style.setProperty("cursor","pointer"),_.style.setProperty("padding","0.5rem"),a(H,A(Me,{get when(){return x()==="setup"},get children(){var k=Dk(),$=k.firstChild,G=$.nextSibling,ne=G.nextSibling,U=ne.nextSibling,D=U.firstChild,B=D.firstChild,Q=B.firstChild,Z=B.nextSibling,oe=Z.firstChild,de=D.nextSibling,re=de.firstChild,Y=re.firstChild,ce=re.nextSibling,ue=ce.firstChild,ae=de.nextSibling,ye=ae.firstChild,me=ye.firstChild,pe=ye.nextSibling,ve=pe.firstChild,Ne=ve.nextSibling,Ie=Ne.nextSibling;return k.style.setProperty("text-align","center"),k.style.setProperty("padding","2rem"),k.style.setProperty("max-width","600px"),k.style.setProperty("margin","0 auto"),$.style.setProperty("font-size","3rem"),$.style.setProperty("margin-bottom","1rem"),G.style.setProperty("margin-bottom","1rem"),a(G,()=>e("inventory.setupPhysicalCount","Setup Physical Inventory Count")),ne.style.setProperty("margin-bottom","2rem"),ne.style.setProperty("color","var(--text-muted)"),a(ne,()=>e("inventory.setupDescription","Configure your physical inventory count settings and begin the counting process.")),U.style.setProperty("display","grid"),U.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),U.style.setProperty("gap","1rem"),U.style.setProperty("margin-bottom","2rem"),U.style.setProperty("padding","1rem"),U.style.setProperty("background","var(--surface-color)"),U.style.setProperty("border-radius","var(--border-radius)"),U.style.setProperty("text-align","left"),B.style.setProperty("display","block"),B.style.setProperty("margin-bottom","0.5rem"),B.style.setProperty("font-weight","500"),a(B,()=>e("inventory.location","Location"),Q),Z.addEventListener("change",Ce=>d(Ce.target.value)),Z.style.setProperty("width","100%"),Z.style.setProperty("padding","0.5rem"),Z.style.setProperty("border","1px solid var(--border-color)"),Z.style.setProperty("border-radius","var(--border-radius-sm)"),a(oe,()=>e("inventory.allLocations","All Locations")),a(Z,A(vt,{get each(){return V()},children:Ce=>(()=>{var Ee=i1();return a(Ee,()=>Ce.name),ge(()=>Ee.value=Ce.id),Ee})()}),null),re.style.setProperty("display","block"),re.style.setProperty("margin-bottom","0.5rem"),re.style.setProperty("font-weight","500"),a(re,()=>e("inventory.category","Category"),Y),ce.addEventListener("change",Ce=>h(Ce.target.value)),ce.style.setProperty("width","100%"),ce.style.setProperty("padding","0.5rem"),ce.style.setProperty("border","1px solid var(--border-color)"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),a(ue,()=>e("products.allCategories","All Categories")),a(ce,A(vt,{get each(){return te()},children:Ce=>(()=>{var Ee=i1();return Ee.value=Ce,a(Ee,Ce),Ee})()}),null),ye.style.setProperty("display","block"),ye.style.setProperty("margin-bottom","0.5rem"),ye.style.setProperty("font-weight","500"),a(ye,()=>e("inventory.sortBy","Sort By"),me),pe.addEventListener("change",Ce=>m(Ce.target.value)),pe.style.setProperty("width","100%"),pe.style.setProperty("padding","0.5rem"),pe.style.setProperty("border","1px solid var(--border-color)"),pe.style.setProperty("border-radius","var(--border-radius-sm)"),a(ve,()=>e("inventory.productName","Product Name")),a(Ne,()=>e("inventory.sku","SKU")),a(Ie,()=>e("inventory.category","Category")),a(k,A(Me,{get when(){return!i()},get fallback(){return(()=>{var Ce=jk(),Ee=Ce.firstChild;return Ce.style.setProperty("padding","2rem"),a(Ce,()=>e("common.loading","Loading"),Ee),Ce})()},get children(){return[(()=>{var Ce=Lk(),Ee=Ce.firstChild;return Ee.firstChild,Ce.style.setProperty("padding","1rem"),Ce.style.setProperty("background","#fff3cd"),Ce.style.setProperty("border-radius","var(--border-radius-sm)"),Ce.style.setProperty("margin-bottom","2rem"),Ee.style.setProperty("margin","0"),Ee.style.setProperty("color","#856404"),a(Ee,()=>e("inventory.countWillInclude","This count will include {{count}} products from {{location}} in {{category}} category.",{count:F().length,location:j(),category:u()==="all"?e("inventory.allCategories","all categories"):u()}),null),Ce})(),A(Me,{get when(){return ke(()=>u()!=="all")()&&c()!=="all"},get children(){var Ce=Rk();return Ce.style.setProperty("display","grid"),Ce.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),Ce.style.setProperty("gap","1rem"),Ce.style.setProperty("margin-bottom","2rem"),Ce.style.setProperty("padding","1rem"),Ce.style.setProperty("background","var(--surface-color)"),Ce.style.setProperty("border-radius","var(--border-radius)"),a(Ce,A(Me,{get when(){return Gt.hasPermission("physicalInventoryCountingForm")},get children(){return A(ct,{variant:"primary",size:"large",onClick:I,get disabled(){return i()||F().length===0},get children(){return["🚀 ",ke(()=>e("inventory.startCounting","Start Physical Count"))]}})}}),null),a(Ce,A(ct,{variant:"primary",onClick:R,get disabled(){return i()},get children(){return["🖨️ ",ke(()=>e("common.print","Print"))]}}),null),Ce}})]}}),null),ge(()=>Z.value=c()),ge(()=>ce.value=u()),ge(()=>pe.value=g()),k}}),null),a(H,A(Me,{get when(){return x()==="counting"},get children(){var k=Mk(),$=k.firstChild,G=$.nextSibling,ne=G.firstChild,U=ne.firstChild,D=U.nextSibling,B=ne.nextSibling,Q=B.firstChild,Z=Q.nextSibling,oe=B.nextSibling,de=oe.firstChild,re=de.nextSibling,Y=oe.nextSibling,ce=Y.firstChild,ue=ce.firstChild,ae=ce.nextSibling,ye=G.nextSibling,me=ye.nextSibling,pe=me.firstChild,ve=pe.firstChild,Ne=ve.firstChild,Ie=Ne.firstChild,Ce=Ie.nextSibling,Ee=Ce.nextSibling,we=Ee.nextSibling,Re=we.nextSibling,He=Re.nextSibling,je=ve.nextSibling;return $.style.setProperty("display","grid"),$.style.setProperty("grid-template-columns","repeat(auto-fit)"),$.style.setProperty("gap","1rem"),$.style.setProperty("margin-bottom","2rem"),$.style.setProperty("padding","1rem"),$.style.setProperty("background","var(--surface-color)"),$.style.setProperty("border-radius","var(--border-radius)"),a($,j),G.style.setProperty("display","grid"),G.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),G.style.setProperty("gap","1rem"),G.style.setProperty("margin-bottom","2rem"),G.style.setProperty("padding","1rem"),G.style.setProperty("background","var(--surface-color)"),G.style.setProperty("border-radius","var(--border-radius)"),ne.style.setProperty("text-align","center"),U.style.setProperty("font-size","1.5rem"),U.style.setProperty("font-weight","700"),U.style.setProperty("color","var(--primary-color)"),a(U,()=>M().countedProducts),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("color","var(--text-muted)"),a(D,()=>e("inventory.counted","Counted")),B.style.setProperty("text-align","center"),Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","700"),Q.style.setProperty("color","#ff9800"),a(Q,()=>M().remainingProducts),Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-muted)"),a(Z,()=>e("inventory.remaining","Remaining")),oe.style.setProperty("text-align","center"),de.style.setProperty("font-size","1.5rem"),de.style.setProperty("font-weight","700"),de.style.setProperty("color","#f44336"),a(de,()=>M().variances),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),a(re,()=>e("inventory.variances","Variances")),Y.style.setProperty("text-align","center"),ce.style.setProperty("font-size","1.5rem"),ce.style.setProperty("font-weight","700"),a(ce,()=>Math.round(M().countedProducts/M().totalProducts*100),ue),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),a(ae,()=>e("inventory.complete","Complete")),ye.style.setProperty("display","flex"),ye.style.setProperty("gap","1rem"),ye.style.setProperty("margin-bottom","2rem"),ye.style.setProperty("justify-content","center"),a(ye,A(ct,{variant:"outline",onClick:()=>b("setup"),get children(){return["⬅️ ",ke(()=>e("common.back","Back to Setup"))]}}),null),a(ye,A(ct,{variant:"primary",onClick:()=>b("review"),get children(){return["📋 ",ke(()=>e("inventory.reviewAdjustments","Review Adjustments"))]}}),null),me.style.setProperty("border","1px solid var(--border-color)"),me.style.setProperty("border-radius","var(--border-radius)"),me.style.setProperty("overflow-x","auto"),pe.style.setProperty("width","100%"),pe.style.setProperty("border-collapse","collapse"),Ne.style.setProperty("background","var(--surface-color)"),Ie.style.setProperty("padding","1rem"),Ie.style.setProperty("text-align","left"),Ie.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Ie,()=>e("inventory.no","No")),Ce.style.setProperty("padding","1rem"),Ce.style.setProperty("text-align","left"),Ce.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Ce,()=>e("inventory.product","Product")),Ee.style.setProperty("padding","1rem"),Ee.style.setProperty("text-align","center"),Ee.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Ee,()=>e("inventory.systemQty","System Qty")),we.style.setProperty("padding","1rem"),we.style.setProperty("text-align","center"),we.style.setProperty("border-bottom","1px solid var(--border-color)"),a(we,()=>e("inventory.physicalCount","Physical Count")),Re.style.setProperty("padding","1rem"),Re.style.setProperty("text-align","center"),Re.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Re,()=>e("inventory.variance","Variance")),He.style.setProperty("padding","1rem"),He.style.setProperty("text-align","left"),He.style.setProperty("border-bottom","1px solid var(--border-color)"),a(He,()=>e("common.notes","Notes")),a(je,A(vt,{get each(){return S()},children:(Ve,qe)=>A(Hk,{get index(){return qe()},updatePhysicalCount:E,entry:Ve,updateNotes:L})})),ge(Ve=>(Ve=M().isComplete?"#4caf50":"#ff9800")!=null?ce.style.setProperty("color",Ve):ce.style.removeProperty("color")),k}}),null),a(H,A(Me,{get when(){return x()==="review"},get children(){var k=Bk(),$=k.firstChild,G=$.firstChild;G.firstChild;var ne=G.nextSibling,U=$.nextSibling,D=U.firstChild,B=D.firstChild,Q=B.nextSibling,Z=D.nextSibling,oe=Z.firstChild,de=oe.nextSibling,re=Z.nextSibling,Y=re.firstChild,ce=Y.nextSibling,ue=U.nextSibling;return $.style.setProperty("text-align","center"),$.style.setProperty("margin-bottom","2rem"),G.style.setProperty("margin-bottom","1rem"),a(G,()=>e("inventory.reviewAndConfirm","Review and Confirm Adjustments"),null),ne.style.setProperty("color","var(--text-muted)"),a(ne,()=>e("inventory.reviewDescription","Review the inventory adjustments below and confirm to update your system.")),U.style.setProperty("display","grid"),U.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),U.style.setProperty("gap","1rem"),U.style.setProperty("margin-bottom","2rem"),U.style.setProperty("padding","1rem"),U.style.setProperty("background","var(--surface-color)"),U.style.setProperty("border-radius","var(--border-radius)"),D.style.setProperty("text-align","center"),B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","700"),B.style.setProperty("color","#4caf50"),a(B,()=>M().positiveVariances),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),a(Q,()=>e("inventory.stockIncreases","Stock Increases")),Z.style.setProperty("text-align","center"),oe.style.setProperty("font-size","1.5rem"),oe.style.setProperty("font-weight","700"),oe.style.setProperty("color","#f44336"),a(oe,()=>M().negativeVariances),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("color","var(--text-muted)"),a(de,()=>e("inventory.stockDecreases","Stock Decreases")),re.style.setProperty("text-align","center"),Y.style.setProperty("font-size","1.5rem"),Y.style.setProperty("font-weight","700"),Y.style.setProperty("color","var(--primary-color)"),a(Y,()=>M().variances),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("color","var(--text-muted)"),a(ce,()=>e("inventory.totalAdjustments","Total Adjustments")),ue.style.setProperty("display","flex"),ue.style.setProperty("gap","1rem"),ue.style.setProperty("margin-bottom","2rem"),ue.style.setProperty("justify-content","center"),ue.style.setProperty("flex-wrap","wrap"),a(ue,A(ct,{variant:"outline",onClick:()=>b("counting"),get children(){return["⬅️ ",ke(()=>e("common.back","Back to Counting"))]}}),null),a(ue,A(ct,{variant:"outline",onClick:w,get disabled(){return M().variances===0},get children(){return["📥 ",ke(()=>e("inventory.downloadCSV","Download CSV"))]}}),null),a(ue,A(ct,{variant:"primary",onClick:v,get disabled(){return s()||M().variances===0},get children(){return ke(()=>!!s())()?"💾 "+e("common.saving","Saving")+"...":"✅ "+e("inventory.confirmAdjustments","Confirm Adjustments")}}),null),a(k,A(Me,{get when(){return M().variances>0},get children(){var ae=Fk(),ye=ae.firstChild,me=ye.firstChild,pe=me.firstChild,ve=pe.firstChild,Ne=ve.nextSibling,Ie=Ne.nextSibling,Ce=Ie.nextSibling,Ee=Ce.nextSibling,we=me.nextSibling;return ae.style.setProperty("border","1px solid var(--border-color)"),ae.style.setProperty("border-radius","var(--border-radius)"),ae.style.setProperty("overflow-x","auto"),ye.style.setProperty("width","100%"),ye.style.setProperty("border-collapse","collapse"),pe.style.setProperty("background","var(--surface-color)"),ve.style.setProperty("padding","1rem"),ve.style.setProperty("text-align","left"),ve.style.setProperty("border-bottom","1px solid var(--border-color)"),a(ve,()=>e("inventory.product","Product")),Ne.style.setProperty("padding","1rem"),Ne.style.setProperty("text-align","center"),Ne.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Ne,()=>e("inventory.systemQty","System Qty")),Ie.style.setProperty("padding","1rem"),Ie.style.setProperty("text-align","center"),Ie.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Ie,()=>e("inventory.physicalCount","Physical Count")),Ce.style.setProperty("padding","1rem"),Ce.style.setProperty("text-align","center"),Ce.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Ce,()=>e("inventory.adjustment","Adjustment")),Ee.style.setProperty("padding","1rem"),Ee.style.setProperty("text-align","left"),Ee.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Ee,()=>e("common.notes","Notes")),a(we,A(vt,{get each(){return S().filter(Re=>Re.variance!==0)},children:Re=>(()=>{var He=zk(),je=He.firstChild,Ve=je.firstChild,qe=Ve.nextSibling,tt=qe.firstChild,rt=je.nextSibling,Be=rt.firstChild,Ge=rt.nextSibling,Fe=Ge.firstChild,at=Ge.nextSibling,lt=at.firstChild,Xe=at.nextSibling,Ct=Xe.firstChild;return He.style.setProperty("border-bottom","1px solid var(--border-color)"),je.style.setProperty("padding","1rem"),Ve.style.setProperty("font-weight","500"),a(Ve,()=>Re.product.name),qe.style.setProperty("font-size","0.875rem"),qe.style.setProperty("color","var(--text-muted)"),a(qe,()=>Re.product.sku,tt),a(qe,()=>Re.product.category,null),rt.style.setProperty("padding","1rem"),rt.style.setProperty("text-align","center"),Be.style.setProperty("font-weight","600"),a(Be,()=>Re.systemQuantity),Ge.style.setProperty("padding","1rem"),Ge.style.setProperty("text-align","center"),Fe.style.setProperty("font-weight","600"),a(Fe,()=>Re.physicalCount),at.style.setProperty("padding","1rem"),at.style.setProperty("text-align","center"),lt.style.setProperty("font-weight","700"),a(lt,()=>Re.variance>0?"+":"",null),a(lt,()=>Re.variance,null),Xe.style.setProperty("padding","1rem"),Ct.style.setProperty("font-size","0.875rem"),a(Ct,()=>Re.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")),ge(Le=>{var nt=Re.variance>0?"#d4edda":"#f8d7da",We=Re.variance>0?"#4caf50":"#f44336";return nt!==Le.e&&((Le.e=nt)!=null?He.style.setProperty("background",nt):He.style.removeProperty("background")),We!==Le.t&&((Le.t=We)!=null?lt.style.setProperty("color",We):lt.style.removeProperty("color")),Le},{e:void 0,t:void 0}),He})()})),ae}}),null),a(k,A(Me,{get when(){return M().variances===0},get children(){var ae=Ok(),ye=ae.firstChild,me=ye.nextSibling,pe=me.nextSibling;return ae.style.setProperty("text-align","center"),ae.style.setProperty("padding","3rem"),ae.style.setProperty("background","var(--surface-color)"),ae.style.setProperty("border-radius","var(--border-radius)"),ye.style.setProperty("font-size","3rem"),ye.style.setProperty("margin-bottom","1rem"),me.style.setProperty("margin-bottom","0.5rem"),a(me,()=>e("inventory.perfectCount","Perfect Count!")),pe.style.setProperty("color","var(--text-muted)"),a(pe,()=>e("inventory.noVariances","No variances found. Your physical count matches the system exactly.")),ae}}),null),k}}),null),X}})},Hk=t=>{const{t:e}=or(),[r,n]=Se(""),[i,o]=Se("");let{entry:s,updatePhysicalCount:l,updateNotes:c,index:d}=t;Ln(()=>{o(s?.notes),n(s?.physicalCount)});const u=()=>{let h=document.getElementById(`physicalCountInput_${d+2}`);if(console.log(Sl(r()),!h),Sl(r())&&!h){l(s?.productId,r()===""?null:parseFloat(r()));return}if(Sl(r())&&h){h.focus(),l(s?.productId,r()===""?null:parseFloat(r()));return}};return(()=>{var h=qk(),g=h.firstChild,m=g.firstChild,S=g.nextSibling,N=S.firstChild,x=N.nextSibling,b=x.firstChild,K=b.nextSibling;K.nextSibling;var te=S.nextSibling,F=te.firstChild,V=te.nextSibling,W=V.firstChild,I=V.nextSibling,E=I.firstChild,L=I.nextSibling,M=L.firstChild;return h.style.setProperty("border-bottom","1px solid var(--border-color)"),g.style.setProperty("padding","1rem"),g.style.setProperty("text-align","center"),m.style.setProperty("font-weight","600"),a(m,d+1),S.style.setProperty("padding","1rem"),N.style.setProperty("font-weight","500"),a(N,()=>s?.product.name),x.style.setProperty("font-size","0.875rem"),x.style.setProperty("color","var(--text-muted)"),a(x,()=>s?.product.sku,b),a(x,()=>s?.product.category,K),a(x,()=>s?.product.unitOfMeasure,null),te.style.setProperty("padding","1rem"),te.style.setProperty("text-align","center"),F.style.setProperty("font-weight","600"),a(F,()=>s?.systemQuantity),V.style.setProperty("padding","1rem"),V.style.setProperty("text-align","center"),W.addEventListener("blur",()=>{u()}),W.$$keydown=P=>{P.keyCode===13&&u(),P.keyCode===27&&u(),P.keyCode},W.$$input=P=>{const w=P.target.value;n(w)},Jt(W,"id",`physicalCountInput_${d+1}`),Jt(W,"tabindex",d),W.style.setProperty("width","100px"),W.style.setProperty("padding","0.5rem"),W.style.setProperty("border","1px solid var(--border-color)"),W.style.setProperty("border-radius","var(--border-radius-sm)"),W.style.setProperty("text-align","center"),I.style.setProperty("padding","1rem"),I.style.setProperty("text-align","center"),E.style.setProperty("font-weight","600"),a(E,()=>s?.variance>0?"+":"",null),a(E,()=>s?.variance||"—",null),L.style.setProperty("padding","1rem"),M.addEventListener("blur",P=>{c(s?.productId,i())}),M.$$keydown=P=>{P.keyCode===13&&c(s?.productId,i()),P.keyCode===27&&c(s?.productId,i()),P.keyCode===9&&c(s?.productId,i())},M.$$input=P=>{const w=P.target.value;o(w)},M.style.setProperty("width","200px"),M.style.setProperty("padding","0.5rem"),M.style.setProperty("border","1px solid var(--border-color)"),M.style.setProperty("border-radius","var(--border-radius-sm)"),ge(P=>{var w=s?.physicalCount!==null?s?.variance!==0?"#fff3cd":"#d4edda":"transparent",v=s?.variance>0?"#4caf50":s?.variance<0?"#f44336":"var(--text-muted)",j=e("inventory.addNotes","Add notes...");return w!==P.e&&((P.e=w)!=null?h.style.setProperty("background",w):h.style.removeProperty("background")),v!==P.t&&((P.t=v)!=null?E.style.setProperty("color",v):E.style.removeProperty("color")),j!==P.a&&Jt(M,"placeholder",P.a=j),P},{e:void 0,t:void 0,a:void 0}),ge(()=>W.value=r()||""),ge(()=>M.value=i()||""),h})()};Wt(["click","input","keydown"]);function Gk(t,e=300,r=!1){let n,i;const o=()=>{n!==void 0&&(clearTimeout(n),n=void 0),i=void 0},s=()=>{n!==void 0&&i!==void 0&&(clearTimeout(n),n=void 0,t(...i),i=void 0)},l=(...c)=>{i=c,n!==void 0&&clearTimeout(n),r&&n===void 0&&t(...c),n=window.setTimeout(()=>{r||t(...c),n=void 0,i=void 0},e)};return Ll(()=>{o()}),{debounced:l,cancel:o,flush:s}}function Wk(t,e=300){const[r,n]=Se(!1);let i;const o=async d=>{if(i&&i.abort(),!d.trim()){n(!1);return}i=new AbortController,n(!0);try{await t(d)}catch(u){u instanceof Error&&u.name!=="AbortError"&&console.error("Search error:",u)}finally{i.signal.aborted||n(!1)}},{debounced:s,cancel:l}=Gk(o,e,!1),c=()=>{l(),i&&i.abort(),n(!1)};return Ll(()=>{c()}),{search:s,isSearching:r,cancel:c}}var o1=le("<div>"),Yk=le("<div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),Kk=le("<div><h3></h3><div><div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><div><span></span><span></span></div><div><span></span><span>%"),Qk=le("<div><h4>"),Jk=le("<div><h3></h3><div><div><div><span></span><span> </span></div><div><span></span><span> </span></div></div><div><div><span></span><span> </span></div><div><span></span><span>"),Xk=le("<div><h3></h3><div><span></span><span></span></div><div><span></span><span>"),s1=le("<div><h3>"),Zk=le("<div><div><div><h2></h2><div>SKU: <!> • </div></div><div></div></div><div><button></button><button></button><button></button></div><div>"),e6=le("<span>✓ "),t6=le("<span>✗ "),r6=le("<div><div><span><span> • </span></span><span> </span></div><div>: <!> • <!>: "),n6=le("<div>📦 "),i6=le("<div>Ref: "),o6=le("<div><div><div><span></span><span></span><span></span></div><div><span></span></div></div><div><div> </div><div>"),s6=le("<div><h4></h4><div></div><div>"),a6=le("<div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div> <!> × </div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div>Min: <!> • Max: ");const l6=t=>{const{t:e}=or(),[r,n]=Se("details"),i=Nt(()=>{if(!t.product)return null;const L=gt.getTotalStockByProduct(t.product.id),M=gt.getStockByProduct(t.product.id),P=L<=t.product.minStockLevel,w=L===0,v=L>=t.product.maxStockLevel;return{total:L,byLocation:M,status:w?"out":P?"low":v?"over":"good",statusText:w?e("products.outOfStock","Out of Stock"):P?e("products.lowStock","Low Stock"):v?e("products.overStock","Over Stock"):e("products.inStock","In Stock")}}),o=L=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(L),s=L=>new Date(L).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),l=Nt(()=>!t.product||t.product.unitCost===0?0:((t.product.sellingPrice-t.product.unitCost)/t.product.unitCost*100).toFixed(2)),c=Nt(()=>t.product?gt.movements.filter(L=>L.productId===t.product.id).sort((L,M)=>new Date(M.createdDate).getTime()-new Date(L.createdDate).getTime()):[]),d=Nt(()=>{if(!t.product)return null;const L=c(),M=i(),P=new Date;P.setDate(P.getDate()-30);const w=L.filter(j=>new Date(j.createdDate)>=P),v=L.reduce((j,z)=>{const T=z.productId===t.product.id?z:null;return j+(T?T.quantity*T.unitCost:0)},0);return{recentMovements:L.length,movements30Days:w.length,totalValue:(M?.total||0)*t.product.unitCost,averageMovementValue:L.length>0?v/L.length:0,lastMovementDate:L.length>0?L[0].createdDate:null}}),u={"margin-bottom":"2rem"},h={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},g={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},m={"font-weight":"400",color:"var(--text-primary)","font-size":"1rem"},S=L=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[L]||"📋";function N(L){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[L]||{bg:"#f5f5f5",color:"#666"}}const x=L=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:N(L).bg,color:N(L).color}),b=L=>{const M={good:{background:"#d4edda",color:"#155724"},low:{background:"#fff3cd",color:"#856404"},out:{background:"#f8d7da",color:"#721c24"},over:{background:"#cce5ff",color:"#004085"}};return{display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500",...M[L]||M.good}},K={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"},te={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-bottom":"0.75rem"},F={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem","padding-bottom":"1rem","border-bottom":"2px solid var(--border-color)"},V={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},W=L=>({padding:"0.75rem 1.5rem",background:"none",border:"none","border-bottom":L?"2px solid var(--primary-color)":"2px solid transparent",color:L?"var(--primary-color)":"var(--text-muted)","font-weight":L?"600":"400",cursor:"pointer",transition:"all 0.2s","font-size":"0.875rem"}),I={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-bottom":"0.5rem"},E={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1.5rem","margin-bottom":"1rem"};return A(Bn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("products.productDetails","Product Details")},size:"large",get children(){return A(Me,{get when(){return t.product},get fallback(){return(()=>{var L=o1();return L.style.setProperty("text-align","center"),L.style.setProperty("padding","2rem"),L.style.setProperty("color","var(--text-muted)"),a(L,()=>e("products.noProductSelected","No product selected")),L})()},children:L=>(()=>{var M=Zk(),P=M.firstChild,w=P.firstChild,v=w.firstChild,j=v.nextSibling,z=j.firstChild,T=z.nextSibling;T.nextSibling;var R=w.nextSibling,J=P.nextSibling,X=J.firstChild,H=X.nextSibling,se=H.nextSibling,O=J.nextSibling;return a(M,()=>JSON.stringify(L),P),p(P,F),v.style.setProperty("margin","0"),v.style.setProperty("font-size","1.5rem"),v.style.setProperty("margin-bottom","0.25rem"),a(v,()=>L().name),j.style.setProperty("color","var(--text-muted)"),a(j,()=>L().sku,T),a(j,()=>L().category,null),a(R,()=>i()?.statusText),p(J,V),X.$$click=()=>n("details"),a(X,()=>e("products.details","Details")),H.$$click=()=>n("movements"),a(H,()=>e("products.movements","Movements")),se.$$click=()=>n("analytics"),a(se,()=>e("products.analytics","Analytics")),a(M,A(Me,{get when(){return r()==="details"},get children(){return[(()=>{var _=Yk(),k=_.firstChild,$=k.nextSibling,G=$.firstChild,ne=G.nextSibling,U=$.nextSibling,D=U.firstChild,B=D.nextSibling,Q=U.nextSibling,Z=Q.firstChild,oe=Z.nextSibling;return k.style.setProperty("margin-bottom","1rem"),k.style.setProperty("font-size","1.1rem"),a(k,()=>e("products.basicInformation","Basic Information")),a(G,()=>e("products.description","Description")),a(ne,()=>L().description||e("common.notAvailable","N/A")),a(D,()=>e("products.unitOfMeasure","Unit of Measure")),a(B,()=>L().unitOfMeasure),a(Z,()=>e("products.status","Status")),a(oe,(()=>{var de=ke(()=>!!L().isActive);return()=>de()?(()=>{var re=e6();return re.firstChild,re.style.setProperty("color","#2e7d32"),a(re,()=>e("common.active","Active"),null),re})():(()=>{var re=t6();return re.firstChild,re.style.setProperty("color","#d32f2f"),a(re,()=>e("common.inactive","Inactive"),null),re})()})()),ge(de=>{var re=u,Y=h,ce=g,ue=m,ae=h,ye=g,me=m,pe=h,ve=g,Ne=m;return de.e=p(_,re,de.e),de.t=p($,Y,de.t),de.a=p(G,ce,de.a),de.o=p(ne,ue,de.o),de.i=p(U,ae,de.i),de.n=p(D,ye,de.n),de.s=p(B,me,de.s),de.h=p(Q,pe,de.h),de.r=p(Z,ve,de.r),de.d=p(oe,Ne,de.d),de},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),_})(),(()=>{var _=Kk(),k=_.firstChild,$=k.nextSibling,G=$.firstChild,ne=G.firstChild,U=ne.firstChild,D=U.nextSibling,B=ne.nextSibling,Q=B.firstChild,Z=Q.nextSibling,oe=G.nextSibling,de=oe.firstChild,re=de.firstChild,Y=re.nextSibling,ce=de.nextSibling,ue=ce.firstChild,ae=ue.nextSibling,ye=ae.firstChild;return k.style.setProperty("margin-bottom","1rem"),k.style.setProperty("font-size","1.1rem"),a(k,()=>e("products.pricingInformation","Pricing Information")),a(U,()=>e("products.unitCost","Unit Cost")),a(D,()=>o(L().unitCost)),a(Q,()=>e("products.sellingPrice","Selling Price")),a(Z,()=>o(L().sellingPrice)),a(re,()=>e("products.profit","Profit")),a(Y,()=>o(L().sellingPrice-L().unitCost)),a(ue,()=>e("products.profitMargin","Profit Margin")),a(ae,l,ye),ge(me=>{var pe=u,ve=K,Ne=h,Ie=g,Ce=m,Ee=h,we=g,Re=m,He=h,je=g,Ve=m,qe=h,tt=g,rt=m;return me.e=p(_,pe,me.e),me.t=p($,ve,me.t),me.a=p(ne,Ne,me.a),me.o=p(U,Ie,me.o),me.i=p(D,Ce,me.i),me.n=p(B,Ee,me.n),me.s=p(Q,we,me.s),me.h=p(Z,Re,me.h),me.r=p(de,He,me.r),me.d=p(re,je,me.d),me.l=p(Y,Ve,me.l),me.u=p(ce,qe,me.u),me.c=p(ue,tt,me.c),me.w=p(ae,rt,me.w),me},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),_})(),(()=>{var _=Jk(),k=_.firstChild,$=k.nextSibling,G=$.firstChild,ne=G.firstChild,U=ne.firstChild,D=U.nextSibling,B=D.firstChild,Q=ne.nextSibling,Z=Q.firstChild,oe=Z.nextSibling,de=oe.firstChild,re=G.nextSibling,Y=re.firstChild,ce=Y.firstChild,ue=ce.nextSibling,ae=ue.firstChild,ye=Y.nextSibling,me=ye.firstChild,pe=me.nextSibling;return k.style.setProperty("margin-bottom","1rem"),k.style.setProperty("font-size","1.1rem"),a(k,()=>e("products.stockInformation","Stock Information")),a(U,()=>e("products.totalStock","Total Stock")),a(D,()=>i()?.total||0,B),a(D,()=>L().unitOfMeasure,null),a(Z,()=>e("products.minStockLevel","Min Stock Level")),a(oe,()=>L().minStockLevel,de),a(oe,()=>L().unitOfMeasure,null),a(ce,()=>e("products.maxStockLevel","Max Stock Level")),a(ue,()=>L().maxStockLevel,ae),a(ue,()=>L().unitOfMeasure,null),a(me,()=>e("products.stockValue","Stock Value")),a(pe,()=>o((i()?.total||0)*L().unitCost)),a(_,A(Me,{get when(){return ke(()=>!!i()?.byLocation)()&&i().byLocation.length>0},get children(){var ve=Qk(),Ne=ve.firstChild;return ve.style.setProperty("margin-top","1.5rem"),Ne.style.setProperty("margin-bottom","1rem"),Ne.style.setProperty("font-size","1rem"),a(Ne,()=>e("products.stockByLocation","Stock by Location")),a(ve,()=>i().byLocation.map(Ie=>(()=>{var Ce=r6(),Ee=Ce.firstChild,we=Ee.firstChild,Re=we.firstChild;Re.firstChild;var He=we.nextSibling,je=He.firstChild,Ve=Ee.nextSibling,qe=Ve.firstChild,tt=qe.nextSibling,rt=tt.nextSibling,Be=rt.nextSibling;return Be.nextSibling,p(Ce,te),Ee.style.setProperty("display","flex"),Ee.style.setProperty("justify-content","space-between"),Ee.style.setProperty("align-items","center"),we.style.setProperty("font-weight","500"),we.style.setProperty("color","var(--primary-color)"),a(we,()=>Ie.locationId,Re),Re.style.setProperty("font-weight","500"),Re.style.setProperty("color","var(--text-muted)"),a(Re,()=>Ie.locationName,null),He.style.setProperty("font-weight","600"),a(He,()=>Ie.quantity,je),a(He,()=>L().unitOfMeasure,null),Ve.style.setProperty("margin-top","0.5rem"),Ve.style.setProperty("font-size","0.875rem"),Ve.style.setProperty("color","var(--text-muted)"),a(Ve,()=>e("products.available","Available"),qe),a(Ve,()=>Ie.availableQuantity,tt),a(Ve,()=>e("products.reserved","Reserved"),Be),a(Ve,()=>Ie.reservedQuantity,null),ge(Ge=>(Ge=Ie.quantity>0?"var(--primary-color)":"var(--text-muted)")!=null?He.style.setProperty("color",Ge):He.style.removeProperty("color")),Ce})()),null),ve}}),null),ge(ve=>{var Ne=u,Ie=K,Ce=h,Ee=g,we=m,Re=h,He=g,je=m,Ve=h,qe=g,tt=m,rt=h,Be=g,Ge=m;return ve.e=p(_,Ne,ve.e),ve.t=p($,Ie,ve.t),ve.a=p(ne,Ce,ve.a),ve.o=p(U,Ee,ve.o),ve.i=p(D,we,ve.i),ve.n=p(Q,Re,ve.n),ve.s=p(Z,He,ve.s),ve.h=p(oe,je,ve.h),ve.r=p(Y,Ve,ve.r),ve.d=p(ce,qe,ve.d),ve.l=p(ue,tt,ve.l),ve.u=p(ye,rt,ve.u),ve.c=p(me,Be,ve.c),ve.w=p(pe,Ge,ve.w),ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),_})(),(()=>{var _=Xk(),k=_.firstChild,$=k.nextSibling,G=$.firstChild,ne=G.nextSibling,U=$.nextSibling,D=U.firstChild,B=D.nextSibling;return k.style.setProperty("margin-bottom","1rem"),k.style.setProperty("font-size","1.1rem"),a(k,()=>e("products.timestamps","Timestamps")),a(G,()=>e("common.createdDate","Created Date")),a(ne,()=>s(L().createdDate)),a(D,()=>e("common.lastModified","Last Modified")),a(B,()=>s(L().lastModified)),ge(Q=>{var Z=u,oe=h,de=g,re=m,Y=h,ce=g,ue=m;return Q.e=p(_,Z,Q.e),Q.t=p($,oe,Q.t),Q.a=p(G,de,Q.a),Q.o=p(ne,re,Q.o),Q.i=p(U,Y,Q.i),Q.n=p(D,ce,Q.n),Q.s=p(B,ue,Q.s),Q},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),_})()]}}),O),a(M,A(Me,{get when(){return r()==="movements"},get children(){var _=s1(),k=_.firstChild;return k.style.setProperty("margin-bottom","1rem"),k.style.setProperty("font-size","1.1rem"),a(k,()=>e("products.recentMovements","Recent Movements")),a(_,A(Me,{get when(){return c().length>0},get fallback(){return(()=>{var $=n6();return $.firstChild,$.style.setProperty("text-align","center"),$.style.setProperty("padding","2rem"),$.style.setProperty("color","var(--text-muted)"),$.style.setProperty("background","var(--surface-color)"),$.style.setProperty("border-radius","var(--border-radius-sm)"),$.style.setProperty("border","1px solid var(--border-color)"),a($,()=>e("products.noMovements","No movements found for this product"),null),$})()},get children(){return A(vt,{get each(){return c()},children:$=>{const G=$.productId===L().id?$:null;if(!G)return null;let ne=gt.getLocationById($.locationId);return(()=>{var U=o6(),D=U.firstChild,B=D.firstChild,Q=B.firstChild,Z=Q.nextSibling,oe=Z.nextSibling,de=B.nextSibling,re=de.firstChild,Y=D.nextSibling,ce=Y.firstChild,ue=ce.firstChild,ae=ce.nextSibling;return p(U,I),B.style.setProperty("font-weight","600"),B.style.setProperty("margin-bottom","0.25rem"),Q.style.setProperty("font-size","1.2rem"),a(Q,()=>S($.movementType)),Z.style.setProperty("padding","0 6px"),a(oe,()=>$.movementType),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("color","var(--text-muted)"),a(de,()=>` ${s($?.createdDate)} • `,re),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("font-weight","600"),re.style.setProperty("color","var(--primary-color)"),a(re,()=>$?.locationId),a(de,()=>` • ${ne?.name}`,null),a(D,A(Me,{get when(){return $.referenceNumber},get children(){var ye=i6();return ye.firstChild,ye.style.setProperty("font-size","0.75rem"),ye.style.setProperty("color","var(--text-muted)"),ye.style.setProperty("margin-top","0.25rem"),a(ye,()=>$?.referenceNumber,null),ye}}),null),Y.style.setProperty("text-align","right"),ce.style.setProperty("font-weight","600"),ce.style.setProperty("font-size","1rem"),a(ce,()=>$?.movementType==="in"?"+":"",ue),a(ce,()=>G.quantity,ue),a(ce,()=>L().unitOfMeasure,null),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),a(ae,()=>o(G.unitCost)),ge(ye=>{var me=x($.movementType),pe=$?.movementType==="in"?"#2e7d32":"#d32f2f";return ye.e=p(oe,me,ye.e),pe!==ye.t&&((ye.t=pe)!=null?ce.style.setProperty("color",pe):ce.style.removeProperty("color")),ye},{e:void 0,t:void 0}),U})()}})}}),null),ge($=>p(_,u,$)),_}}),O),a(M,A(Me,{get when(){return r()==="analytics"},get children(){var _=s1(),k=_.firstChild;return k.style.setProperty("margin-bottom","1rem"),k.style.setProperty("font-size","1.1rem"),a(k,()=>e("products.analytics","Analytics")),a(_,A(Me,{get when(){return d()},get fallback(){return(()=>{var $=o1();return $.style.setProperty("text-align","center"),$.style.setProperty("padding","2rem"),$.style.setProperty("color","var(--text-muted)"),a($,()=>e("products.noAnalytics","No analytics data available")),$})()},children:$=>(()=>{var G=a6(),ne=G.firstChild,U=ne.firstChild,D=U.nextSibling,B=D.nextSibling,Q=ne.nextSibling,Z=Q.firstChild,oe=Z.nextSibling,de=oe.nextSibling,re=Q.nextSibling,Y=re.firstChild,ce=Y.nextSibling,ue=ce.nextSibling,ae=ue.firstChild,ye=ae.nextSibling;ye.nextSibling;var me=re.nextSibling,pe=me.firstChild,ve=pe.nextSibling,Ne=ve.nextSibling,Ie=me.nextSibling,Ce=Ie.firstChild,Ee=Ce.nextSibling,we=Ee.nextSibling,Re=we.firstChild,He=Re.nextSibling;return He.nextSibling,U.style.setProperty("margin","0 0 0.5rem 0"),U.style.setProperty("color","var(--primary-color)"),a(U,()=>e("products.totalMovements","Total Movements")),D.style.setProperty("font-size","1.5rem"),D.style.setProperty("font-weight","600"),a(D,()=>$().recentMovements),B.style.setProperty("font-size","0.875rem"),B.style.setProperty("color","var(--text-muted)"),B.style.setProperty("margin-top","0.25rem"),a(B,()=>e("products.allTime","All time")),Z.style.setProperty("margin","0 0 0.5rem 0"),Z.style.setProperty("color","var(--primary-color)"),a(Z,()=>e("products.last30Days","Last 30 Days")),oe.style.setProperty("font-size","1.5rem"),oe.style.setProperty("font-weight","600"),a(oe,()=>$().movements30Days),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("color","var(--text-muted)"),de.style.setProperty("margin-top","0.25rem"),a(de,()=>e("products.movements","movements")),Y.style.setProperty("margin","0 0 0.5rem 0"),Y.style.setProperty("color","var(--primary-color)"),a(Y,()=>e("products.currentValue","Current Stock Value")),ce.style.setProperty("font-size","1.5rem"),ce.style.setProperty("font-weight","600"),a(ce,()=>o($().totalValue)),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("color","var(--text-muted)"),ue.style.setProperty("margin-top","0.25rem"),a(ue,()=>i()?.total||0,ae),a(ue,()=>L().unitOfMeasure,ye),a(ue,()=>o(L().unitCost),null),pe.style.setProperty("margin","0 0 0.5rem 0"),pe.style.setProperty("color","var(--primary-color)"),a(pe,()=>e("products.avgMovementValue","Avg Movement Value")),ve.style.setProperty("font-size","1.5rem"),ve.style.setProperty("font-weight","600"),a(ve,()=>o($().averageMovementValue)),Ne.style.setProperty("font-size","0.875rem"),Ne.style.setProperty("color","var(--text-muted)"),Ne.style.setProperty("margin-top","0.25rem"),a(Ne,()=>e("products.perMovement","per movement")),a(G,A(Me,{get when(){return $().lastMovementDate},get children(){var je=s6(),Ve=je.firstChild,qe=Ve.nextSibling,tt=qe.nextSibling;return Ve.style.setProperty("margin","0 0 0.5rem 0"),Ve.style.setProperty("color","var(--primary-color)"),a(Ve,()=>e("products.lastMovement","Last Movement")),qe.style.setProperty("font-size","1.25rem"),qe.style.setProperty("font-weight","600"),a(qe,()=>s($().lastMovementDate)),tt.style.setProperty("font-size","0.875rem"),tt.style.setProperty("color","var(--text-muted)"),tt.style.setProperty("margin-top","0.25rem"),a(tt,()=>e("products.mostRecent","Most recent activity")),ge(rt=>p(je,E,rt)),je}}),Ie),Ce.style.setProperty("margin","0 0 0.5rem 0"),Ce.style.setProperty("color","var(--primary-color)"),a(Ce,()=>e("products.stockStatus","Stock Status")),Ee.style.setProperty("font-size","1.25rem"),Ee.style.setProperty("font-weight","600"),a(Ee,()=>i()?.statusText),we.style.setProperty("font-size","0.875rem"),we.style.setProperty("color","var(--text-muted)"),we.style.setProperty("margin-top","0.25rem"),a(we,()=>L().minStockLevel,He),a(we,()=>L().maxStockLevel,null),ge(je=>{var Ve=K,qe=E,tt=E,rt=E,Be=E,Ge=E;return je.e=p(G,Ve,je.e),je.t=p(ne,qe,je.t),je.a=p(Q,tt,je.a),je.o=p(re,rt,je.o),je.i=p(me,Be,je.i),je.n=p(Ie,Ge,je.n),je},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),G})()}),null),ge($=>p(_,u,$)),_}}),O),O.style.setProperty("display","flex"),O.style.setProperty("gap","1rem"),O.style.setProperty("justify-content","flex-end"),O.style.setProperty("margin-top","2rem"),a(O,A(ct,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close","Close")}}),null),a(O,A(Me,{get when(){return t.onEdit},get children(){return A(ct,{variant:"primary",get onClick(){return t.onEdit},get children(){return e("common.edit","Edit")}})}}),null),ge(_=>{var k=b(i()?.status||"good"),$=W(r()==="details"),G=W(r()==="movements"),ne=W(r()==="analytics");return _.e=p(R,k,_.e),_.t=p(X,$,_.t),_.a=p(H,G,_.a),_.o=p(se,ne,_.o),_},{e:void 0,t:void 0,a:void 0,o:void 0}),M})()})}})};Wt(["click"]);var c6=le("<div>🔄"),d6=le("<button type=button>×"),u6=le("<div>⚠️ "),a1=le("<div>"),h6=le("<div><div><input type=text autocomplete=off>"),p6=le("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>"),m6=le("<span>⚠️ ");const y6=t=>{const{t:e}=or(),[r,n]=Se(""),[i,o]=Se(!1),[s,l]=Se(null),[c,d]=Se([]),[u,h]=Se(!1),[g,m]=Se(-1),[S,N]=Se(null),x=t.searchDelay||300,b=t.maxResults||900,K=async $=>{if(!$.trim()||$.trim().length<3){d([]),t.onSearchResults?.([]);return}try{o(!0),l(null);try{const G=await ai.getProducts($),ne=Object.keys(G),U=B=>{let Q=G;return{id:B,name:Q[B].name,businessId:Q[B].businessId,sku:Q[B].code,UPC:Q[B].UPC,numCode:Q[B].codeN,category:Q[B].category,unitCost:Q[B].unitCost||0,unitOfMeasure:Q[B].unitOfMeasure,minStockLevel:Q[B].minStockLevel,maxStockLevel:Q[B].maxStockLevel,isActive:Q[B].isActive,description:Q[B].description||"",createdDate:Q[B].createdAt||new Date().toISOString(),lastModified:Q[B].updatedAt||new Date().toISOString()}},D=ne.map(U);d(D),gt.updProduct(D),t.onSearchResults?.(D)}catch(G){console.warn("API search failed, using local fallback:",G),l("API search failed, showing local results");const ne=gt.getActiveProducts().filter(U=>U.name.toLowerCase().includes($.toLowerCase())||U.sku.toLowerCase().includes($.toLowerCase())||U.category.toLowerCase().includes($.toLowerCase())).slice(0,b);d(ne),t.onSearchResults?.(ne)}}catch(G){const ne=G instanceof Error?G.message:"Search failed";l(ne),d([]),t.onSearchResults?.([])}finally{o(!1)}},te=$=>{const ne=$.target.value;n(ne),l(null),t.showResults!==!1&&h(!0),S()&&clearTimeout(S());const U=setTimeout(()=>{K(ne)},x);N(U)},F=$=>{n($.name),h(!1),m(-1),t.onProductSelect?.($)},V=$=>{if(!(!u()||c().length===0))switch($.key){case"ArrowDown":$.preventDefault(),m(G=>Math.min(G+1,c().length-1));break;case"ArrowUp":$.preventDefault(),m(G=>Math.max(G-1,-1));break;case"Enter":$.preventDefault(),g()>=0&&c()[g()]&&F(c()[g()]);break;case"Escape":h(!1),m(-1);break}},W=()=>{t.showResults!==!1&&c().length>0&&h(!0)},I=()=>{setTimeout(()=>{h(!1),m(-1)},150)},E=()=>{n(""),d([]),l(null),h(!1),m(-1),t.onSearchResults?.([]),S()&&(clearTimeout(S()),N(null))},L=$=>gt.stockLevels.filter(G=>G.productId===$).reduce((G,ne)=>G+ne.quantity,0),M=$=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format($),P={position:"relative",width:"100%",...t.style},w={position:"relative",display:"flex","align-items":"center"},v={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},j={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},z={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},T={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},R=$=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:$?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),J={display:"flex","justify-content":"space-between","align-items":"center"},X={flex:"1"},H={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},se={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},O={"text-align":"right","font-size":"0.875rem"},_={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},k={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var $=h6(),G=$.firstChild,ne=G.firstChild;return ne.addEventListener("blur",I),ne.addEventListener("focus",W),ne.$$keydown=V,ne.$$input=te,a(G,A(Me,{get when(){return i()},get children(){var U=c6();return ge(D=>p(U,z,D)),U}}),null),a(G,A(Me,{get when(){return ke(()=>!!r())()&&!i()},get children(){var U=d6();return U.addEventListener("mouseleave",D=>{D.currentTarget.style.background="none",D.currentTarget.style.color="var(--text-muted)"}),U.addEventListener("mouseenter",D=>{D.currentTarget.style.background="var(--border-color)",D.currentTarget.style.color="var(--text-primary)"}),U.$$click=E,ge(D=>{var B=j,Q=e("common.clear","Clear search");return D.e=p(U,B,D.e),Q!==D.t&&Jt(U,"title",D.t=Q),D},{e:void 0,t:void 0}),U}}),null),a($,A(Me,{get when(){return u()&&t.showResults!==!1},get children(){var U=a1();return a(U,A(Me,{get when(){return s()},get children(){var D=u6();return D.firstChild,p(D,k),a(D,s,null),D}}),null),a(U,A(Me,{get when(){return c().length>0},get fallback(){return ke(()=>!!(r()&&!i()))()&&(()=>{var D=a1();return p(D,_),a(D,()=>e("inventory.noProductsFound","No products found matching your search.")),D})()},get children(){return A(vt,{get each(){return c()},children:(D,B)=>{const Q=L(D.id),Z=Q<=D.minStockLevel;return(()=>{var oe=p6(),de=oe.firstChild,re=de.firstChild,Y=re.firstChild,ce=Y.nextSibling,ue=ce.firstChild,ae=ue.firstChild,ye=ue.nextSibling,me=ye.nextSibling,pe=me.nextSibling,ve=pe.nextSibling,Ne=re.nextSibling,Ie=Ne.firstChild,Ce=Ie.firstChild,Ee=Ie.nextSibling;return oe.addEventListener("mouseenter",()=>m(B())),oe.$$click=()=>F(D),p(de,J),p(re,X),p(Y,H),a(Y,()=>D.name),p(ce,se),a(ue,()=>e("inventory.sku","SKU"),ae),a(ue,()=>D.sku,null),a(me,()=>D.category),a(ve,()=>M(D.unitCost)),p(Ne,O),Ie.style.setProperty("font-weight","600"),(Z?"#f44336":"var(--text-primary)")!=null?Ie.style.setProperty("color",Z?"#f44336":"var(--text-primary)"):Ie.style.removeProperty("color"),a(Ie,Q,Ce),a(Ie,()=>D.unitOfMeasure,null),Ee.style.setProperty("color","var(--text-muted)"),a(Ee,()=>Z?(()=>{var we=m6();return we.firstChild,we.style.setProperty("color","#f44336"),a(we,()=>e("inventory.lowStock","Low Stock"),null),we})():e("inventory.inStock","In Stock")),ge(we=>p(oe,R(B()===g()),we)),oe})()}})}}),null),ge(D=>p(U,T,D)),U}}),null),ge(U=>{var D=P,B=w,Q=v,Z=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),oe=t.disabled;return U.e=p($,D,U.e),U.t=p(G,B,U.t),U.a=p(ne,Q,U.a),Z!==U.o&&Jt(ne,"placeholder",U.o=Z),oe!==U.i&&(ne.disabled=U.i=oe),U},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ge(()=>ne.value=r()),$})()};Wt(["input","keydown","click"]);var f6=le("<div><div><h2></h2><div><div>"),g6=le("<div><span>"),v6=le("<span>🔍 "),b6=le("<div><div><div><div><h3></h3><span></span></div><div></div><div>: </div></div><div><div></div><div> • <!>: </div><div>: "),P6=le("<div><div>:</div><div>"),_6=le("<div>: "),S6=le("<div><div><span>:</span><select><option value=10>10</option><option value=20>20</option><option value=50>50</option><option value=100>100</option></select></div><div><div><span></span><input type=number min=1><span> </span></div></div><div>");const LP=()=>{const{t}=or(),[e,r]=Se(""),[n,i]=Se(""),[o,s]=Se([]),[l,c]=Se(!1),[d,u]=Se(null),[h,g]=Se(!1),[m,S]=Se(!1),[N,x]=Se(!1),[b,K]=Se(null),[te,F]=Se(!1),[V,W]=Se([]),[I,E]=Se(!1),[L,M]=Se(1),[P,w]=Se(20);Ln(async()=>{await v()});const v=async()=>{try{c(!0),u(null);try{const $=await z0.getAll();s($.map(G=>({id:G.id||`prod-${Date.now()}-${Math.random()}`,name:G.productName||G.name||"Unknown Product",sku:G.sku||G.productCode||"",description:G.description||"",category:G.category||"General",unitOfMeasure:G.unitOfMeasure||"pcs",unitCost:parseFloat(G.unitCost||G.cost||"0"),sellingPrice:parseFloat(G.sellingPrice||G.price||"0"),minStockLevel:parseInt(G.minStockLevel||"0"),maxStockLevel:parseInt(G.maxStockLevel||"100"),isActive:G.isActive!==!1,createdDate:G.createdDate||new Date().toISOString(),lastModified:G.lastModified||new Date().toISOString(),businessId:G.businessId||"YB100423253156428"})))}catch($){console.warn("API failed, using local store:",$),s(gt.products)}}catch($){u($ instanceof Error?$.message:"Failed to load products")}finally{c(!1)}},j=async()=>{try{c(!0),u(null);try{const $=await ai.getProducts("prod"),G=Object.keys($),ne=D=>{let Q=$[D];return{id:Q.id,name:Q.name,businessId:Q.businessId,sku:Q.code,numCode:Q.codeN,category:Q.category,unitCost:Q.unitCost||0,unitOfMeasure:Q.unitOfMeasure,minStockLevel:Q.minStockLevel,maxStockLevel:Q.maxStockLevel,isActive:Q.isActive,description:Q.description||"",createdDate:Q.createdAt||new Date().toISOString(),lastModified:Q.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(Q.sellingPrice||Q.price||"0")}},U=G.map(ne);s(U)}catch($){console.warn("API failed, using local store:",$),s(gt.products)}}catch($){u($ instanceof Error?$.message:"Failed to load products")}finally{c(!1)}},{cancel:z}=Wk(async $=>{if(!$.trim()){await v();return}try{u(null);const G=await z0.getAll($);s(G.map(ne=>({id:ne.id||`prod-${Date.now()}-${Math.random()}`,name:ne.productName||ne.name||"Unknown Product",sku:ne.sku||ne.productCode||"",description:ne.description||"",category:ne.category||"General",unitOfMeasure:ne.unitOfMeasure||"pcs",unitCost:parseFloat(ne.unitCost||ne.cost||"0"),sellingPrice:parseFloat(ne.sellingPrice||ne.price||"0"),minStockLevel:parseInt(ne.minStockLevel||"0"),maxStockLevel:parseInt(ne.maxStockLevel||"100"),isActive:ne.isActive!==!1,createdDate:ne.createdDate||new Date().toISOString(),lastModified:ne.lastModified||new Date().toISOString(),businessId:ne.businessId||"YB100423253156428"})))}catch(G){u(G instanceof Error?G.message:"Search failed");const ne=gt.products.filter(U=>U.name.toLowerCase().includes($.toLowerCase())||U.sku.toLowerCase().includes($.toLowerCase())||U.category.toLowerCase().includes($.toLowerCase()));s(ne)}},300);Ll(()=>{z()}),Nt(()=>{let $=o();return n()&&($=$.filter(G=>G.category===n())),$}),Nt(()=>[...new Set(o().map(G=>G.category))].sort()),Nt(()=>{const $=o().filter(U=>U.isActive),G=o().length,ne=o().filter(U=>gt.getTotalStockByProduct(U.id)===0);return{total:G,active:$.length,outOfStock:ne.length}});const T=$=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format($),R={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},J={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},X=$=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:$?"#ffebee":"#e8f5e8",color:$?"#d32f2f":"#2d7d32"});Nt(()=>{const $=gt.products||[],G=gt.movements||[],ne=gt.stockLevels||[],U=gt.getLowStockProducts(),D=$?.length||0,B=$?.filter(oe=>oe.isActive).length,Q=ne.reduce((oe,de)=>oe*1+de.quantity*1*de.averageCost*1,0),Z=G?.filter(oe=>{const de=new Date(oe.createdDate),re=new Date;return de.getMonth()===re.getMonth()&&de.getFullYear()===re.getFullYear()}).length;return{totalProducts:D,activeProducts:B,lowStockProducts:U.length,totalStockValue:Q,totalMovementsThisMonth:Z,totalLocations:gt.locations.length,activeLocations:gt.getActiveLocations().length}});const H=Nt(()=>gt.products.map($=>{const G=gt.getStockByProduct($.id),ne=gt.getTotalStockByProduct($.id),U=gt.getLastLocationByProduct($.id);return{...$,totalStock:ne,stockByLocation:G,lastLocation:U,isLowStock:ne<=$.minStockLevel}})),se=Nt(()=>V().map($=>{const G=gt.getStockByProduct($.id),ne=gt.getTotalStockByProduct($.id),U=gt.getLastLocationByProduct($.id);return{...$,totalStock:ne,stockByLocation:G,lastLocation:U,isLowStock:ne<=$.minStockLevel}})),O=Nt(()=>{const $=I()?se():H(),G=(L()-1)*P(),ne=G+P();return $.slice(G,ne)}),_=Nt(()=>{const $=I()?se():H();return Math.ceil($.length/P())}),k=$=>{K($),S(!0)};return A(oo,{get title(){return t("products.title","Products")},get children(){return[(()=>{var $=f6(),G=$.firstChild,ne=G.firstChild,U=ne.nextSibling,D=U.firstChild;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","flex-start"),$.style.setProperty("margin-bottom","1.5rem"),$.style.setProperty("flex-wrap","wrap"),$.style.setProperty("gap","1rem"),G.style.setProperty("flex","1"),G.style.setProperty("min-width","300px"),ne.style.setProperty("margin","0 0 1rem 0"),ne.style.setProperty("font-size","1.5rem"),a(ne,()=>t("inventory.products")),U.style.setProperty("display","flex"),U.style.setProperty("gap","1rem"),U.style.setProperty("align-items","center"),U.style.setProperty("flex-wrap","wrap"),D.style.setProperty("flex","1"),D.style.setProperty("min-width","250px"),a(D,A(y6,{onSearchResults:B=>{W(B),E(B.length>0)},get placeholder(){return t("inventory.searchProductsStock","Search products and check stock levels...")},showResults:!1,maxResults:20})),a(U,A(ct,{variant:"outline",onClick:()=>{j(),E(!1)},get children(){return["🔄 ",ke(()=>t("common.showAll","Show All"))]}}),null),a($,A(Me,{get when(){return Gt.hasPermission("read_write")},get children(){return A(ct,{variant:"primary",onClick:()=>F(!0),get children(){return["➕ ",ke(()=>t("inventory.addProduct"))]}})}}),null),$})(),(()=>{var $=g6(),G=$.firstChild;return $.style.setProperty("margin-bottom","1rem"),$.style.setProperty("font-size","0.875rem"),$.style.setProperty("color","var(--text-muted)"),$.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),a(G,(()=>{var ne=ke(()=>!!I());return()=>ne()?`${t("inventory.searchResults","Search Results")}: ${se().length} ${t("common.products","products")}`:`${t("inventory.totalProducts","Total Products")}: ${H().length} ${t("common.products","products")}`})()),a($,(()=>{var ne=ke(()=>!!I());return()=>ne()&&(()=>{var U=v6();return U.firstChild,U.style.setProperty("color","var(--primary-color)"),a(U,()=>t("inventory.filtered","Filtered view"),null),U})()})(),null),$})(),A(vt,{get each(){return O()},children:$=>(()=>{var G=b6(),ne=G.firstChild,U=ne.firstChild,D=U.firstChild,B=D.firstChild,Q=B.nextSibling,Z=D.nextSibling,oe=Z.nextSibling,de=oe.firstChild,re=U.nextSibling,Y=re.firstChild,ce=Y.nextSibling,ue=ce.firstChild,ae=ue.nextSibling;ae.nextSibling;var ye=ce.nextSibling,me=ye.firstChild;return G.$$click=()=>k($),G.addEventListener("mouseleave",pe=>{pe.currentTarget.style.transform="translateY(0)",pe.currentTarget.style.boxShadow="none"}),G.addEventListener("mouseenter",pe=>{pe.currentTarget.style.transform="translateY(-2px)",pe.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),p(G,R),p(ne,J),D.style.setProperty("display","flex"),D.style.setProperty("align-items","center"),D.style.setProperty("gap","0.5rem"),D.style.setProperty("margin-bottom","0.5rem"),B.style.setProperty("margin","0"),B.style.setProperty("font-size","1.1rem"),a(B,()=>$.name),a(Q,(()=>{var pe=ke(()=>!!$.isLowStock);return()=>pe()?t("inventory.lowStockAlert"):t("inventory.inStock")})()),Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-muted)"),a(Z,()=>$.sku,null),a(Z,()=>$.UPC?" • "+$.UPC:"",null),a(Z,()=>$.category?" • "+$.category:"",null),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),a(oe,()=>t("inventory.lastSeen"),de),a(oe,()=>$.lastLocation?.name||t("inventory.noMovements"),null),re.style.setProperty("text-align","right"),Y.style.setProperty("font-size","1.25rem"),Y.style.setProperty("font-weight","700"),Y.style.setProperty("color","var(--primary-color)"),a(Y,()=>$.totalStock),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("color","var(--text-muted)"),a(ce,()=>$.unitOfMeasure,ue),a(ce,()=>t("inventory.min"),ae),a(ce,()=>$.minStockLevel,null),ye.style.setProperty("font-size","0.875rem"),ye.style.setProperty("color","var(--text-muted)"),a(ye,()=>t("inventory.cost"),me),a(ye,()=>T($.unitCost),null),a(G,(()=>{var pe=ke(()=>$?.stockByLocation?.length>0);return()=>pe()&&(()=>{var ve=P6(),Ne=ve.firstChild,Ie=Ne.firstChild,Ce=Ne.nextSibling;return ve.style.setProperty("margin-top","1rem"),Ne.style.setProperty("font-weight","500"),Ne.style.setProperty("margin-bottom","0.5rem"),Ne.style.setProperty("font-size","0.875rem"),a(Ne,()=>t("inventory.stockByLocation"),Ie),Ce.style.setProperty("display","flex"),Ce.style.setProperty("flex-wrap","wrap"),Ce.style.setProperty("gap","0.5rem"),a(Ce,A(vt,{get each(){return $.stockByLocation},children:Ee=>{const we=gt.getLocationById(Ee.locationId);return(()=>{var Re=_6(),He=Re.firstChild;return Re.style.setProperty("padding","0.25rem 0.5rem"),Re.style.setProperty("background","var(--background-color)"),Re.style.setProperty("border-radius","var(--border-radius-sm)"),Re.style.setProperty("font-size","0.75rem"),Re.style.setProperty("border","1px solid var(--border-color)"),a(Re,()=>we?.name,He),a(Re,()=>Ee.quantity,null),Re})()}})),ve})()})(),null),ge(pe=>p(Q,X($.isLowStock),pe)),G})()}),ke(()=>ke(()=>_()>1)()&&(()=>{var $=S6(),G=$.firstChild,ne=G.firstChild,U=ne.firstChild,D=ne.nextSibling,B=G.nextSibling,Q=B.firstChild,Z=Q.firstChild,oe=Z.nextSibling,de=oe.nextSibling,re=de.firstChild,Y=B.nextSibling;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),$.style.setProperty("margin-top","2rem"),$.style.setProperty("padding","1rem"),$.style.setProperty("background","var(--surface-color)"),$.style.setProperty("border-radius","var(--border-radius)"),$.style.setProperty("border","1px solid var(--border-color)"),G.style.setProperty("display","flex"),G.style.setProperty("align-items","center"),G.style.setProperty("gap","0.5rem"),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-muted)"),a(ne,()=>t("common.showPerPage","Show per page"),U),D.addEventListener("change",ce=>{w(parseInt(ce.target.value)),M(1)}),D.style.setProperty("padding","0.25rem 0.5rem"),D.style.setProperty("border","1px solid var(--border-color)"),D.style.setProperty("border-radius","var(--border-radius-sm)"),D.style.setProperty("background","var(--background-color)"),D.style.setProperty("cursor","pointer"),B.style.setProperty("display","flex"),B.style.setProperty("align-items","center"),B.style.setProperty("gap","0.5rem"),a(B,A(ct,{variant:"outline",size:"sm",onClick:()=>M(1),get disabled(){return L()===1},get children(){return t("common.first","First")}}),Q),a(B,A(ct,{variant:"outline",size:"sm",onClick:()=>M(ce=>Math.max(1,ce-1)),get disabled(){return L()===1},get children(){return t("common.previous","Previous")}}),Q),Q.style.setProperty("display","flex"),Q.style.setProperty("align-items","center"),Q.style.setProperty("gap","0.25rem"),Z.style.setProperty("font-size","0.875rem"),a(Z,()=>t("common.page","Page")),oe.addEventListener("change",ce=>{const ue=parseInt(ce.target.value);ue>=1&&ue<=_()&&M(ue)}),oe.style.setProperty("width","60px"),oe.style.setProperty("padding","0.25rem 0.5rem"),oe.style.setProperty("border","1px solid var(--border-color)"),oe.style.setProperty("border-radius","var(--border-radius-sm)"),oe.style.setProperty("text-align","center"),oe.style.setProperty("font-size","0.875rem"),de.style.setProperty("font-size","0.875rem"),a(de,()=>t("common.of","of"),re),a(de,_,null),a(B,A(ct,{variant:"outline",size:"sm",onClick:()=>M(ce=>Math.min(_(),ce+1)),get disabled(){return L()===_()},get children(){return t("common.next","Next")}}),null),a(B,A(ct,{variant:"outline",size:"sm",onClick:()=>M(_()),get disabled(){return L()===_()},get children(){return t("common.last","Last")}}),null),Y.style.setProperty("font-size","0.875rem"),Y.style.setProperty("color","var(--text-muted)"),a(Y,()=>{const ce=I()?se():H(),ue=(L()-1)*P()+1,ae=Math.min(L()*P(),ce.length);return t("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:ue,end:ae,total:ce.length})}),ge(()=>Jt(oe,"max",_())),ge(()=>D.value=P()),ge(()=>oe.value=L()),$})()),A(Cg,{get isOpen(){return h()},onClose:()=>g(!1),onProductAdded:()=>{v()}}),A(l6,{get isOpen(){return m()},onClose:()=>{S(!1),K(null)},get product(){return b()},onEdit:()=>{S(!1),x(!0)}})]}})};Wt(["click"]);var w6=le("<div><div></div><div>"),x6=le("<div><div><img></div><div>X</div><div><div><h2></h2><div></div></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),C6=le("<div>"),A6=le("<div><div>📦</div><h3></h3><p>"),$6=le("<div><div>"),E6=le("<div>✓"),I6=le("<div><div><img loading=lazy></div><div><div></div><div> • </div><div></div><div>",!0,!1,!1);const T6=t=>{const{t:e}=or(),[r,n]=Se(null),[i,o]=Se([]),[s,l]=Se(!1),c=R=>{n(R),t.onProductSelect?.(R)},d=()=>{n(null),t.onProductSelect?.(null),o([]),l(!1)},u=R=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(R),h=()=>"YABABYSSolution",g=()=>"https://qvamarkets.s3.us-east-2.amazonaws.com/V2_images/7258/",m=R=>{if(R.productImageUrl)return g()+h()+"/"+R?.productImageUrl;const J={Electronics:"https://via.placeholder.com/400x300/4F46E5/FFFFFF?text=Electronics",Furniture:"https://via.placeholder.com/400x300/059669/FFFFFF?text=Furniture",Food:"https://via.placeholder.com/400x300/DC2626/FFFFFF?text=Food",Clothing:"https://via.placeholder.com/400x300/7C3AED/FFFFFF?text=Clothing",Tools:"https://via.placeholder.com/400x300/EA580C/FFFFFF?text=Tools",General:"https://via.placeholder.com/400x300/6B7280/FFFFFF?text=Product"};return J[R.category]||J.General},S={padding:"2rem"},N={"max-width":"600px",margin:"0 auto 2rem",position:"relative"},x={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},b={background:"var(--surface-color)","border-radius":"var(--border-radius)",overflow:"hidden","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.3s ease"},K={position:"relative",width:"100%",height:"200px",overflow:"hidden",background:"#f5f5f5"},te={width:"100%",height:"100%","object-fit":"cover",transition:"transform 0.3s ease"},F={padding:"1rem"},V={"font-size":"1rem","font-weight":"600","margin-bottom":"0.5rem",color:"var(--text-primary)",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},W={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.25rem"},I={"font-size":"1.25rem","font-weight":"700",color:"var(--primary-color)","margin-top":"0.5rem"},E={display:"flex",gap:"2rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"2rem","box-shadow":"var(--shadow-md)","margin-bottom":"2rem",position:"relative"},L={width:"400px",height:"300px","border-radius":"var(--border-radius)",overflow:"hidden",background:"#f5f5f5"},M={flex:"1",display:"flex","flex-direction":"column",gap:"1rem"},P={display:"flex","justify-content":"space-between","padding-bottom":"0.5rem","border-bottom":"1px solid var(--border-light)"},w={"font-weight":"500",color:"var(--text-muted)"},v={"font-weight":"600",color:"var(--text-primary)"},j=R=>({display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600",background:"#d4edda",color:"#155724"}),z={"text-align":"center",padding:"4rem 2rem",color:"var(--text-muted)"},T={"font-size":"3rem","margin-bottom":"1rem",opacity:"0.5"};return(()=>{var R=$6(),J=R.firstChild;return p(R,S),a(J,A(zp,{onChange:X=>{console.log(X);let H=X;l(!0),c(H)},get placeholder(){return e("inventory.searchProductsImages","Search products to view images...")}})),a(R,A(Me,{get when(){return r()&&t.showDetails!==!1},get children(){var X=x6(),H=X.firstChild,se=H.firstChild,O=H.nextSibling,_=O.nextSibling,k=_.firstChild,$=k.firstChild,G=$.nextSibling,ne=k.nextSibling,U=ne.firstChild,D=U.nextSibling,B=ne.nextSibling,Q=B.firstChild,Z=Q.nextSibling,oe=B.nextSibling,de=oe.firstChild,re=de.nextSibling,Y=oe.nextSibling,ce=Y.firstChild,ue=ce.nextSibling,ae=Y.nextSibling,ye=ae.firstChild,me=ye.nextSibling;return p(X,E),p(H,L),se.style.setProperty("width","100%"),se.style.setProperty("height","100%"),se.style.setProperty("object-fit","contain"),se.style.setProperty("aspect-ratio","1 / 1"),O.$$click=()=>{d()},O.style.setProperty("position","absolute"),O.style.setProperty("top","0.5rem"),O.style.setProperty("right","0.5rem"),O.style.setProperty("color","#3d3d3d"),O.style.setProperty("border-radius","50%"),O.style.setProperty("width","2rem"),O.style.setProperty("height","2rem"),O.style.setProperty("display","flex"),O.style.setProperty("align-items","center"),O.style.setProperty("justify-content","center"),O.style.setProperty("font-size","1.25rem"),O.style.setProperty("box-shadow","var(--shadow-sm)"),O.style.setProperty("cursor","pointer"),p(_,M),$.style.setProperty("margin","0 0 0.5rem 0"),$.style.setProperty("font-size","1.5rem"),a($,()=>r().name),a(G,()=>e("products.inStock","In Stock")),a(U,()=>e("products.sku","SKU")),a(D,()=>r().sku),a(Q,()=>e("inventory.category","Category")),a(Z,()=>r().category),a(de,()=>e("inventory.unitOfMeasure","Unit")),a(re,()=>r().unitOfMeasure),a(ce,()=>e("inventory.unitCost","Cost")),a(ue,()=>u(r().unitCost)),a(ye,()=>e("inventory.UPC","UPC")),a(me,()=>r().UPC),a(_,A(Me,{get when(){return r().description},get children(){var pe=w6(),ve=pe.firstChild,Ne=ve.nextSibling;return pe.style.setProperty("margin-top","1rem"),a(ve,()=>e("common.description","Description")),Ne.style.setProperty("margin-top","0.5rem"),Ne.style.setProperty("color","var(--text-primary)"),a(Ne,()=>r().description),ge(Ie=>p(ve,w,Ie)),pe}}),null),ge(pe=>{var ve=m(r()),Ne=r().name,Ie=j(),Ce=P,Ee=w,we=v,Re=P,He=w,je=v,Ve=P,qe=w,tt=v,rt=P,Be=w,Ge=v,Fe=P,at=w,lt=v;return ve!==pe.e&&Jt(se,"src",pe.e=ve),Ne!==pe.t&&Jt(se,"alt",pe.t=Ne),pe.a=p(G,Ie,pe.a),pe.o=p(ne,Ce,pe.o),pe.i=p(U,Ee,pe.i),pe.n=p(D,we,pe.n),pe.s=p(B,Re,pe.s),pe.h=p(Q,He,pe.h),pe.r=p(Z,je,pe.r),pe.d=p(oe,Ve,pe.d),pe.l=p(de,qe,pe.l),pe.u=p(re,tt,pe.u),pe.c=p(Y,rt,pe.c),pe.w=p(ce,Be,pe.w),pe.m=p(ue,Ge,pe.m),pe.f=p(ae,Fe,pe.f),pe.y=p(ye,at,pe.y),pe.g=p(me,lt,pe.g),pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),X}}),null),a(R,A(Me,{get when(){return i().length>0},get children(){var X=C6();return p(X,x),a(X,A(vt,{get each(){return i()},children:H=>(()=>{var se=I6(),O=se.firstChild,_=O.firstChild,k=O.nextSibling,$=k.firstChild,G=$.nextSibling,ne=G.firstChild,U=G.nextSibling,D=U.nextSibling;return se.addEventListener("mouseleave",B=>{B.currentTarget.style.transform="translateY(0)",B.currentTarget.style.boxShadow="var(--shadow-sm)";const Q=B.currentTarget.querySelector("img");Q&&(Q.style.transform="scale(1)")}),se.addEventListener("mouseenter",B=>{B.currentTarget.style.transform="translateY(-4px)",B.currentTarget.style.boxShadow="var(--shadow-lg)";const Q=B.currentTarget.querySelector("img");Q&&(Q.style.transform="scale(1.05)")}),se.$$click=()=>c(H),p(se,b),a(O,A(Me,{get when(){return H===r()},get children(){var B=E6();return B.style.setProperty("position","absolute"),B.style.setProperty("top","0.5rem"),B.style.setProperty("right","0.5rem"),B.style.setProperty("background","var(--primary-color)"),B.style.setProperty("color","white"),B.style.setProperty("border-radius","50%"),B.style.setProperty("width","2rem"),B.style.setProperty("height","2rem"),B.style.setProperty("display","flex"),B.style.setProperty("align-items","center"),B.style.setProperty("justify-content","center"),B.style.setProperty("font-size","1.25rem"),B}}),null),p(k,F),a($,()=>H.name),a(G,()=>H.sku,ne),a(G,()=>H.category,null),a(U,()=>H.unitOfMeasure),p(D,I),a(D,()=>u(H.sellingPrice)),ge(B=>{var Q=K,Z=m(H),oe=H.name,de=te,re=V,Y=H.name,ce=W,ue=W;return B.e=p(O,Q,B.e),Z!==B.t&&Jt(_,"src",B.t=Z),oe!==B.a&&Jt(_,"alt",B.a=oe),B.o=p(_,de,B.o),B.i=p($,re,B.i),Y!==B.n&&Jt($,"title",B.n=Y),B.s=p(G,ce,B.s),B.h=p(U,ue,B.h),B},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),se})()})),X}}),null),a(R,A(Me,{get when(){return!r()},get children(){var X=A6(),H=X.firstChild,se=H.nextSibling,O=se.nextSibling;return p(H,T),se.style.setProperty("margin-bottom","0.5rem"),a(se,()=>e("inventory.noProductsFound","No Products Found")),a(O,()=>e("inventory.tryDifferentSearch","Try a different search term")),ge(_=>p(X,z,_)),X}}),null),ge(X=>p(J,N,X)),R})()};Wt(["click"]);var k6=le("<button>"),N6=le("<div><h3></h3><button>🖨️ "),L6=le("<div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),Dm=le("<div><strong>:</strong> "),R6=le("<div>"),D6=le("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),M6=le("<div><div><h2></h2><div><select><option value=date></option><option value=quantity></option><option value=value></option></select></div></div><div>"),F6=le("<div><div><h3></h3><div></div></div><div><span></span><div>"),O6=le("<div><div><strong>:</strong> "),B6=le("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),V6=le("<div><button></button><button>🖨️"),j6=le("<tr><td></td><td></td><td></td><td></td><td></td><td>");const z6=t=>{const{t:e}=or(),[r,n]=Se(null),[i,o]=Se("date"),s=Nt(()=>{const g=t.movements||gt.movements,m=new Map;return g.forEach(S=>{const N=S.referenceNumber||S.ssg_inventory_key||S.invoiceId||"UNKNOWN";if(!m.has(N)){const K=gt.getLocationById(S.locationId);m.set(N,{referenceNumber:S.referenceNumber||"",invoiceId:S.invoiceId||"",ssg_inventory_key:S.ssg_inventory_key||"",movementType:S.movementType||"unknown",locationId:S.locationId||"",locationName:K?.name||"Unknown Location",totalItems:0,totalQuantity:0,createDate:S.createDate||new Date().toISOString(),description:S.description||"",generalNotes:S.generalNotes||"",movements:[],totalValue:0})}const x=m.get(N);x.movements.push(S),x.totalItems++,x.totalQuantity+=Math.abs(S.quantity||0);const b=gt.getProductById(S.productId);b&&b.unitCost&&(x.totalValue+=Math.abs(S.quantity||0)*b.unitCost)}),Array.from(m.values()).sort((S,N)=>{switch(i()){case"quantity":return N.totalQuantity-S.totalQuantity;case"value":return N.totalValue-S.totalValue;case"date":default:return new Date(N.createDate).getTime()-new Date(S.createDate).getTime()}})}),l=g=>new Date(g).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),c=g=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(g),d=g=>{switch(g.toLowerCase()){case"in":case"stock_in":return"#22c55e";case"out":case"stock_out":return"#ef4444";case"transfer":return"#3b82f6";case"adjustment":return"#f59e0b";default:return"#6b7280"}},u=g=>{switch(g.toLowerCase()){case"in":case"stock_in":return"↗️";case"out":case"stock_out":return"↙️";case"transfer":return"↔️";case"adjustment":return"⚖️";default:return"📦"}},h=g=>{const m=g||r();if(!m)return;const S=window.open("","_blank");if(!S)return;const N=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Bulk Movement Report - ${m.referenceNumber||m.invoiceId}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 20px; }
          .group-info { background: #f8f9fa; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
          .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
          table { width: 100%; border-collapse: collapse; margin-top: 15px; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background-color: #f2f2f2; font-weight: bold; }
          .summary { background: #e8f4fd; padding: 15px; margin-top: 20px; border-radius: 5px; }
          @media print { body { margin: 0; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>BULK MOVEMENT REPORT</h1>
          <h2>${m.referenceNumber||m.invoiceId}</h2>
          <p>Generated: ${l(new Date().toISOString())}</p>
        </div>
        
        <div class="group-info">
          <div class="info-grid">
            <div>
              <strong>Reference Number:</strong> ${m.referenceNumber||"N/A"}<br>
              <strong>Invoice ID:</strong> ${m.invoiceId||"N/A"}<br>
              <strong>Movement Type:</strong> ${m.movementType.toUpperCase()}<br>
              <strong>Location:</strong> ${m.locationName}
            </div>
            <div>
              <strong>Date:</strong> ${l(m.createDate)}<br>
              <strong>Total Items:</strong> ${m.totalItems}<br>
              <strong>Total Quantity:</strong> ${m.totalQuantity}<br>
              <strong>Estimated Value:</strong> ${c(m.totalValue)}
            </div>
          </div>
          ${m.description?`<p><strong>Description:</strong> ${m.description}</p>`:""}
          ${m.generalNotes?`<p><strong>Notes:</strong> ${m.generalNotes}</p>`:""}
        </div>
        
        <table>
          <thead>
            <tr>
              <th>Product Code</th>
              <th>Product Name</th>
              <th>Quantity</th>
              <th>Unit Cost</th>
              <th>Total Value</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody>
            ${m.movements.map(x=>{const b=gt.getProductById(x.productId),K=b?.unitCost||0,te=Math.abs(x.quantity||0)*K;return`
                <tr>
                  <td>${b?.code||x.productId}</td>
                  <td>${b?.name||"Unknown Product"}</td>
                  <td>${x.quantity||0}</td>
                  <td>${c(K)}</td>
                  <td>${c(te)}</td>
                  <td>${x.notes||"-"}</td>
                </tr>
              `}).join("")}
          </tbody>
        </table>
        
        <div class="summary">
          <h3>SUMMARY</h3>
          <p><strong>Total Products:</strong> ${m.totalItems}</p>
          <p><strong>Total Quantity Moved:</strong> ${m.totalQuantity}</p>
          <p><strong>Total Estimated Value:</strong> ${c(m.totalValue)}</p>
          <p><strong>Movement Impact:</strong> ${m.movementType==="in"?"Increased":m.movementType==="out"?"Decreased":"Adjusted"} inventory</p>
        </div>
      </body>
      </html>
    `;S.document.write(N),S.document.close(),S.print()};return(()=>{var g=M6(),m=g.firstChild,S=m.firstChild,N=S.nextSibling,x=N.firstChild,b=x.firstChild,K=b.nextSibling,te=K.nextSibling,F=m.nextSibling;return g.style.setProperty("padding","1rem"),m.style.setProperty("display","flex"),m.style.setProperty("justify-content","space-between"),m.style.setProperty("align-items","center"),m.style.setProperty("margin-bottom","2rem"),a(S,()=>e("inventory.bulkMovementReport","Bulk Movement Report")),N.style.setProperty("display","flex"),N.style.setProperty("gap","1rem"),x.addEventListener("change",V=>o(V.currentTarget.value)),x.style.setProperty("padding","0.5rem"),a(b,()=>e("common.sortByDate","Sort by Date")),a(K,()=>e("common.sortByQuantity","Sort by Quantity")),a(te,()=>e("common.sortByValue","Sort by Value")),a(N,A(Me,{get when(){return t.onClose},get children(){var V=k6();return Cn(V,"click",t.onClose,!0),V.style.setProperty("padding","0.5rem 1rem"),V.style.setProperty("background","#6c757d"),V.style.setProperty("color","white"),V.style.setProperty("border","none"),V.style.setProperty("border-radius","var(--border-radius-sm)"),V.style.setProperty("cursor","pointer"),a(V,()=>e("common.close","Close")),V}}),null),F.style.setProperty("display","grid"),F.style.setProperty("grid-template-columns","repeat(auto-fill, minmax(400px, 1fr))"),F.style.setProperty("gap","1rem"),F.style.setProperty("margin-bottom","2rem"),a(F,A(vt,{get each(){return s()},children:V=>A(Rt,{get style(){return{cursor:"pointer",border:r()===V?"2px solid var(--primary-color)":"1px solid #e9ecef",transition:"all 0.2s"}},onClick:()=>n(V),get children(){return[(()=>{var W=F6(),I=W.firstChild,E=I.firstChild,L=E.nextSibling,M=I.nextSibling,P=M.firstChild,w=P.nextSibling;return W.style.setProperty("display","flex"),W.style.setProperty("justify-content","space-between"),W.style.setProperty("align-items","flex-start"),W.style.setProperty("margin-bottom","1rem"),E.style.setProperty("margin","0 0 0.5rem 0"),E.style.setProperty("font-size","1.1rem"),a(E,()=>V.referenceNumber||V.invoiceId||"No Reference"),L.style.setProperty("font-size","0.875rem"),L.style.setProperty("color","#6c757d"),a(L,()=>l(V.createDate)),M.style.setProperty("text-align","center"),P.style.setProperty("font-size","1.5rem"),a(P,()=>u(V.movementType)),w.style.setProperty("font-size","0.75rem"),w.style.setProperty("font-weight","bold"),a(w,()=>V.movementType.toUpperCase()),ge(v=>(v=d(V.movementType))!=null?w.style.setProperty("color",v):w.style.removeProperty("color")),W})(),(()=>{var W=O6(),I=W.firstChild,E=I.firstChild,L=E.firstChild;return E.nextSibling,W.style.setProperty("margin-bottom","1rem"),I.style.setProperty("font-size","0.875rem"),I.style.setProperty("margin-bottom","0.25rem"),a(E,()=>e("inventory.location","Location"),L),a(I,()=>V.locationName,null),a(W,A(Me,{get when(){return V.description},get children(){var M=Dm(),P=M.firstChild,w=P.firstChild;return P.nextSibling,M.style.setProperty("font-size","0.875rem"),M.style.setProperty("margin-bottom","0.25rem"),a(P,()=>e("common.description","Description"),w),a(M,()=>V.description,null),M}}),null),W})(),(()=>{var W=B6(),I=W.firstChild,E=I.firstChild,L=E.nextSibling,M=I.nextSibling,P=M.firstChild,w=P.nextSibling,v=M.nextSibling,j=v.firstChild,z=j.nextSibling;return W.style.setProperty("display","grid"),W.style.setProperty("grid-template-columns","repeat(3, 1fr)"),W.style.setProperty("gap","0.5rem"),W.style.setProperty("margin-bottom","1rem"),I.style.setProperty("text-align","center"),I.style.setProperty("padding","0.5rem"),I.style.setProperty("background","#f8f9fa"),I.style.setProperty("border-radius","var(--border-radius-sm)"),E.style.setProperty("font-weight","bold"),E.style.setProperty("color","#3b82f6"),a(E,()=>V.totalItems),L.style.setProperty("font-size","0.75rem"),L.style.setProperty("color","#6c757d"),a(L,()=>e("inventory.items","Items")),M.style.setProperty("text-align","center"),M.style.setProperty("padding","0.5rem"),M.style.setProperty("background","#f8f9fa"),M.style.setProperty("border-radius","var(--border-radius-sm)"),P.style.setProperty("font-weight","bold"),P.style.setProperty("color","#22c55e"),a(P,()=>V.totalQuantity),w.style.setProperty("font-size","0.75rem"),w.style.setProperty("color","#6c757d"),a(w,()=>e("inventory.quantity","Quantity")),v.style.setProperty("text-align","center"),v.style.setProperty("padding","0.5rem"),v.style.setProperty("background","#f8f9fa"),v.style.setProperty("border-radius","var(--border-radius-sm)"),j.style.setProperty("font-weight","bold"),j.style.setProperty("color","#f59e0b"),a(j,()=>c(V.totalValue)),z.style.setProperty("font-size","0.75rem"),z.style.setProperty("color","#6c757d"),a(z,()=>e("common.value","Value")),W})(),(()=>{var W=V6(),I=W.firstChild,E=I.nextSibling;return W.style.setProperty("display","flex"),W.style.setProperty("gap","0.5rem"),I.$$click=L=>{L.stopPropagation(),n(V)},I.style.setProperty("flex","1"),I.style.setProperty("padding","0.5rem"),I.style.setProperty("background","var(--primary-color)"),I.style.setProperty("color","white"),I.style.setProperty("border","none"),I.style.setProperty("border-radius","var(--border-radius-sm)"),I.style.setProperty("cursor","pointer"),I.style.setProperty("font-size","0.875rem"),a(I,()=>e("common.viewDetails","View Details")),E.$$click=L=>{L.stopPropagation(),h(V)},E.style.setProperty("padding","0.5rem"),E.style.setProperty("background","#22c55e"),E.style.setProperty("color","white"),E.style.setProperty("border","none"),E.style.setProperty("border-radius","var(--border-radius-sm)"),E.style.setProperty("cursor","pointer"),E.style.setProperty("font-size","0.875rem"),W})()]}})})),a(g,A(Me,{get when(){return r()},get children(){return A(Rt,{get children(){return[(()=>{var V=N6(),W=V.firstChild,I=W.nextSibling;return I.firstChild,V.style.setProperty("display","flex"),V.style.setProperty("justify-content","space-between"),V.style.setProperty("align-items","center"),V.style.setProperty("margin-bottom","1rem"),a(W,()=>e("inventory.movementDetails","Movement Details")),I.$$click=()=>h(),I.style.setProperty("padding","0.5rem 1rem"),I.style.setProperty("background","#22c55e"),I.style.setProperty("color","white"),I.style.setProperty("border","none"),I.style.setProperty("border-radius","var(--border-radius-sm)"),I.style.setProperty("cursor","pointer"),a(I,()=>e("common.print","Print Report"),null),V})(),(()=>{var V=L6(),W=V.firstChild,I=W.firstChild,E=I.firstChild,L=E.firstChild;E.nextSibling;var M=I.nextSibling,P=M.firstChild,w=P.firstChild;P.nextSibling;var v=M.nextSibling,j=v.firstChild,z=j.firstChild;j.nextSibling;var T=v.nextSibling,R=T.firstChild,J=R.firstChild;R.nextSibling;var X=W.nextSibling,H=X.firstChild,se=H.firstChild,O=se.firstChild;se.nextSibling;var _=H.nextSibling,k=_.firstChild,$=k.firstChild;k.nextSibling;var G=_.nextSibling,ne=G.firstChild,U=ne.firstChild;ne.nextSibling;var D=G.nextSibling,B=D.firstChild,Q=B.firstChild;return B.nextSibling,V.style.setProperty("display","grid"),V.style.setProperty("grid-template-columns","repeat(2, 1fr)"),V.style.setProperty("gap","1rem"),V.style.setProperty("margin-bottom","2rem"),V.style.setProperty("padding","1rem"),V.style.setProperty("background","#f8f9fa"),V.style.setProperty("border-radius","var(--border-radius-sm)"),a(E,()=>e("inventory.referenceNumber","Reference"),L),a(I,()=>r()?.referenceNumber||"N/A",null),a(P,()=>e("inventory.invoiceId","Invoice ID"),w),a(M,()=>r()?.invoiceId||"N/A",null),a(j,()=>e("inventory.movementType","Type"),z),a(v,()=>r()?.movementType.toUpperCase(),null),a(R,()=>e("inventory.location","Location"),J),a(T,()=>r()?.locationName,null),a(se,()=>e("common.date","Date"),O),a(H,(()=>{var Z=ke(()=>!!r());return()=>Z()?l(r().createDate):""})(),null),a(k,()=>e("inventory.totalItems","Total Items"),$),a(_,()=>r()?.totalItems,null),a(ne,()=>e("inventory.totalQuantity","Total Quantity"),U),a(G,()=>r()?.totalQuantity,null),a(B,()=>e("common.estimatedValue","Estimated Value"),Q),a(D,(()=>{var Z=ke(()=>!!r());return()=>Z()?c(r().totalValue):""})(),null),V})(),A(Me,{get when(){return r()?.description||r()?.generalNotes},get children(){var V=R6();return V.style.setProperty("margin-bottom","2rem"),V.style.setProperty("padding","1rem"),V.style.setProperty("background","#e8f4fd"),V.style.setProperty("border-radius","var(--border-radius-sm)"),a(V,A(Me,{get when(){return r()?.description},get children(){var W=Dm(),I=W.firstChild,E=I.firstChild;return I.nextSibling,a(I,()=>e("common.description","Description"),E),a(W,()=>r()?.description,null),W}}),null),a(V,A(Me,{get when(){return r()?.generalNotes},get children(){var W=Dm(),I=W.firstChild,E=I.firstChild;return I.nextSibling,a(I,()=>e("common.notes","Notes"),E),a(W,()=>r()?.generalNotes,null),W}}),null),V}}),(()=>{var V=D6(),W=V.firstChild,I=W.firstChild,E=I.firstChild,L=E.firstChild,M=L.nextSibling,P=M.nextSibling,w=P.nextSibling,v=w.nextSibling,j=v.nextSibling,z=I.nextSibling;return V.style.setProperty("overflow-x","auto"),W.style.setProperty("width","100%"),W.style.setProperty("border-collapse","collapse"),E.style.setProperty("border-bottom","2px solid #dee2e6"),L.style.setProperty("padding","0.75rem"),L.style.setProperty("text-align","left"),a(L,()=>e("inventory.productCode","Code")),M.style.setProperty("padding","0.75rem"),M.style.setProperty("text-align","left"),a(M,()=>e("inventory.productName","Product")),P.style.setProperty("padding","0.75rem"),P.style.setProperty("text-align","center"),a(P,()=>e("inventory.quantity","Quantity")),w.style.setProperty("padding","0.75rem"),w.style.setProperty("text-align","right"),a(w,()=>e("inventory.unitCost","Unit Cost")),v.style.setProperty("padding","0.75rem"),v.style.setProperty("text-align","right"),a(v,()=>e("common.totalValue","Total Value")),j.style.setProperty("padding","0.75rem"),j.style.setProperty("text-align","left"),a(j,()=>e("common.notes","Notes")),a(z,A(vt,{get each(){return r()?.movements||[]},children:T=>{const R=gt.getProductById(T.productId),J=R?.unitCost||0,X=Math.abs(T.quantity||0)*J;return(()=>{var H=j6(),se=H.firstChild,O=se.nextSibling,_=O.nextSibling,k=_.nextSibling,$=k.nextSibling,G=$.nextSibling;return H.style.setProperty("border-bottom","1px solid #dee2e6"),se.style.setProperty("padding","0.75rem"),se.style.setProperty("font-family","monospace"),a(se,()=>R?.code||T.productId),O.style.setProperty("padding","0.75rem"),a(O,()=>R?.name||"Unknown Product"),_.style.setProperty("padding","0.75rem"),_.style.setProperty("text-align","center"),_.style.setProperty("font-weight","bold"),a(_,()=>T.quantity||0),k.style.setProperty("padding","0.75rem"),k.style.setProperty("text-align","right"),a(k,()=>c(J)),$.style.setProperty("padding","0.75rem"),$.style.setProperty("text-align","right"),$.style.setProperty("font-weight","bold"),a($,()=>c(X)),G.style.setProperty("padding","0.75rem"),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","#6c757d"),a(G,()=>T.notes||"-"),ge(ne=>(ne=(T.quantity||0)>=0?"#22c55e":"#ef4444")!=null?_.style.setProperty("color",ne):_.style.removeProperty("color")),H})()}})),V})()]}})}}),null),ge(()=>x.value=i()),g})()};Wt(["click"]);var q6=le("<div><div>📊</div><div></div><div>"),l1=le("<div>"),U6=le("<div><div><div><h2> - </h2><button>×</button></div><div>"),H6=le("<div><div><div><div><h3></h3><span></span></div><div></div></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const G6=t=>{const{t:e}=or(),[r,n]=Se(""),[i,o]=Se(!1),s=Nt(()=>{const S=gt.movements,N=new Map;return S.forEach(x=>{const b=x.referenceNumber||x.invoiceId||x.ssg_inventory_key||"UNKNOWN";N.has(b)||N.set(b,{referenceNumber:b,movements:[],totalItems:0,totalValue:0,createdDate:x.createdDate,movementType:x.movementType});const K=N.get(b);K.movements.push(x),K.totalItems+=x.quantity,K.totalValue+=x.totalCost,new Date(x.createdDate)<new Date(K.createdDate)&&(K.createdDate=x.createdDate)}),Array.from(N.values()).filter(x=>x.movements.length>1).sort((x,b)=>new Date(b.createdDate).getTime()-new Date(x.createdDate).getTime())}),l=Nt(()=>{const S=s().find(N=>N.referenceNumber===r());return S?S.movements:[]}),c=S=>{n(S),o(!0)},d=()=>{o(!1),n("")},u=S=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(S),h=S=>new Date(S).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),g=S=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[S]||S,m=S=>({in:"#4caf50",out:"#f44336",transfer:"#2196f3",adjustment:"#ff9800"})[S]||"#666";return[A(Bn,{get isOpen(){return ke(()=>!!t.isOpen)()&&!i()},get onClose(){return t.onClose},get title(){return e("inventory.viewHistoricalReports")},size:"large",get children(){var S=l1();return S.style.setProperty("max-height","70vh"),S.style.setProperty("overflow-y","auto"),a(S,A(Me,{get when(){return s().length===0},get children(){var N=q6(),x=N.firstChild,b=x.nextSibling,K=b.nextSibling;return N.style.setProperty("text-align","center"),N.style.setProperty("padding","3rem"),N.style.setProperty("color","var(--text-muted)"),x.style.setProperty("font-size","2rem"),x.style.setProperty("margin-bottom","1rem"),b.style.setProperty("font-size","1.1rem"),b.style.setProperty("margin-bottom","0.5rem"),a(b,()=>e("inventory.noBulkReportsFound","No bulk movement reports found")),K.style.setProperty("font-size","0.9rem"),a(K,()=>e("inventory.bulkReportsAppearHere","Bulk movement reports will appear here after you create bulk movements")),N}}),null),a(S,A(Me,{get when(){return s().length>0},get children(){var N=l1();return N.style.setProperty("display","grid"),N.style.setProperty("gap","1rem"),a(N,A(vt,{get each(){return s()},children:x=>(()=>{var b=H6(),K=b.firstChild,te=K.firstChild,F=te.firstChild,V=F.firstChild,W=V.nextSibling,I=F.nextSibling,E=K.nextSibling,L=E.firstChild,M=L.firstChild,P=M.nextSibling,w=L.nextSibling,v=w.firstChild,j=v.nextSibling,z=w.nextSibling,T=z.firstChild,R=T.nextSibling;return b.style.setProperty("padding","1.5rem"),b.style.setProperty("border","1px solid var(--border-color)"),b.style.setProperty("border-radius","var(--border-radius)"),b.style.setProperty("background","var(--surface-color)"),b.style.setProperty("transition","all 0.2s ease"),K.style.setProperty("display","flex"),K.style.setProperty("justify-content","space-between"),K.style.setProperty("align-items","flex-start"),K.style.setProperty("margin-bottom","1rem"),te.style.setProperty("flex","1"),F.style.setProperty("display","flex"),F.style.setProperty("align-items","center"),F.style.setProperty("gap","1rem"),F.style.setProperty("margin-bottom","0.5rem"),V.style.setProperty("margin","0"),V.style.setProperty("font-size","1.1rem"),V.style.setProperty("color","var(--text-primary)"),a(V,()=>x.referenceNumber),W.style.setProperty("padding","0.25rem 0.75rem"),W.style.setProperty("border-radius","1rem"),W.style.setProperty("font-size","0.75rem"),W.style.setProperty("font-weight","500"),a(W,()=>g(x.movementType)),I.style.setProperty("color","var(--text-muted)"),I.style.setProperty("font-size","0.875rem"),a(I,()=>h(x.createdDate)),a(K,A(ct,{variant:"outline",size:"sm",onClick:()=>c(x.referenceNumber),get children(){return e("common.view")}}),null),E.style.setProperty("display","grid"),E.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),E.style.setProperty("gap","1rem"),E.style.setProperty("margin-bottom","1rem"),M.style.setProperty("font-size","0.75rem"),M.style.setProperty("font-weight","500"),M.style.setProperty("text-transform","uppercase"),M.style.setProperty("color","var(--text-muted)"),M.style.setProperty("margin-bottom","0.25rem"),a(M,()=>e("inventory.totalProducts")),P.style.setProperty("font-size","1.25rem"),P.style.setProperty("font-weight","600"),P.style.setProperty("color","var(--primary-color)"),a(P,()=>x.movements.length),v.style.setProperty("font-size","0.75rem"),v.style.setProperty("font-weight","500"),v.style.setProperty("text-transform","uppercase"),v.style.setProperty("color","var(--text-muted)"),v.style.setProperty("margin-bottom","0.25rem"),a(v,()=>e("inventory.totalItems")),j.style.setProperty("font-size","1.25rem"),j.style.setProperty("font-weight","600"),j.style.setProperty("color","var(--primary-color)"),a(j,()=>x.totalItems),T.style.setProperty("font-size","0.75rem"),T.style.setProperty("font-weight","500"),T.style.setProperty("text-transform","uppercase"),T.style.setProperty("color","var(--text-muted)"),T.style.setProperty("margin-bottom","0.25rem"),a(T,()=>e("inventory.estimatedValue")),R.style.setProperty("font-size","1.25rem"),R.style.setProperty("font-weight","600"),R.style.setProperty("color","var(--primary-color)"),a(R,()=>u(x.totalValue)),ge(J=>{var X=m(x.movementType)+"20",H=m(x.movementType);return X!==J.e&&((J.e=X)!=null?W.style.setProperty("background",X):W.style.removeProperty("background")),H!==J.t&&((J.t=H)!=null?W.style.setProperty("color",H):W.style.removeProperty("color")),J},{e:void 0,t:void 0}),b})()})),N}}),null),S}}),A(Me,{get when(){return i()},get children(){var S=U6(),N=S.firstChild,x=N.firstChild,b=x.firstChild,K=b.firstChild,te=b.nextSibling,F=x.nextSibling;return S.style.setProperty("position","fixed"),S.style.setProperty("top","0"),S.style.setProperty("left","0"),S.style.setProperty("right","0"),S.style.setProperty("bottom","0"),S.style.setProperty("background","rgba(0, 0, 0, 0.5)"),S.style.setProperty("z-index","1000"),S.style.setProperty("display","flex"),S.style.setProperty("align-items","center"),S.style.setProperty("justify-content","center"),S.style.setProperty("padding","2rem"),N.style.setProperty("background","white"),N.style.setProperty("border-radius","var(--border-radius)"),N.style.setProperty("width","95%"),N.style.setProperty("max-width","1200px"),N.style.setProperty("max-height","90vh"),N.style.setProperty("overflow-y","auto"),N.style.setProperty("position","relative"),x.style.setProperty("padding","1rem 2rem"),x.style.setProperty("border-bottom","1px solid #e9ecef"),x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),x.style.setProperty("background","#f8f9fa"),b.style.setProperty("margin","0"),a(b,()=>e("inventory.bulkMovementReport"),K),a(b,r,null),te.$$click=d,te.style.setProperty("background","none"),te.style.setProperty("border","none"),te.style.setProperty("font-size","1.5rem"),te.style.setProperty("cursor","pointer"),te.style.setProperty("padding","0.5rem"),te.style.setProperty("line-height","1"),F.style.setProperty("padding","1rem"),a(F,A(z6,{get movements(){return l()},onClose:d})),S}})]};Wt(["click"]);var W6=le("<form><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text required></div></div><div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><div><label></label></div></div><div><div><h3></h3></div></div><div><label></label><textarea></textarea></div><div>"),Y6=le("<div><label> *"),K6=le("<div><div></div><div></div><div></div><div></div><div>"),Mm=le("<div>"),Q6=le("<div><input type=number min=0 step=1 required><input type=number min=0 step=0.01><input type=text>"),J6=le("<div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span>"),X6=le("<div>• ");const Z6=t=>{const{t:e}=or(),[r,n]=Se(`INV-${Date.now()}`),[i,o]=Se(""),[s,l]=Se("in"),[c,d]=Se(""),[u,h]=Se(""),[g,m]=Se(""),[S,N]=Se([]),[x,b]=Se([]),[K,te]=Se(!1),[F,V]=Se(!1),W=()=>{N(U=>[...U,{productId:"",quantity:0,unitCost:0,notes:""}])},I=U=>{N(D=>D.filter((B,Q)=>Q!==U))},E=(U,D,B)=>{N(Q=>Q.map((Z,oe)=>oe===U?{...Z,[D]:B}:Z))},L=()=>{n(`INV-${Date.now()}`),o(""),l("in"),d(""),h(""),m(""),N([]),b([])},M=async U=>{U.preventDefault(),b([]);const D=[];if(i()||D.push(e("forms.referenceNumberRequired")),c()||D.push(e("forms.locationRequired")),s()==="transfer"&&!u()&&D.push(e("forms.fromLocationRequired")),S().length===0&&D.push(e("forms.atLeastOneProduct")),S().forEach((Z,oe)=>{Z.productId||D.push(e("forms.itemProductRequired","Product is required for item {{index}}",{index:oe+1})),Z.quantity<=0&&D.push(e("forms.itemQuantityRequired","Quantity must be greater than 0 for item {{index}}",{index:oe+1}))}),D.length>0){b(D);return}const B={ssg_inventory_key:ki(),invoiceId:r(),referenceNumber:i(),movementType:s(),type:$y(s()),locationId:c(),fromLocationId:s()==="transfer"?u():void 0,items:S(),products:S(),generalNotes:g(),description:g(),invoice:i(),store:c(),createdBy:"admin",createDate:new Date().toISOString()};console.log(B);const Q=await gt.addBulkInventoryMovements(B);console.log(Q),Q.success?t.onMovementComplete?t.onMovementComplete(i()):(L(),t.onClose()):b(Q.errors)},P=()=>{L(),t.onClose()},w=Nt(()=>S().reduce((U,D)=>{const B=gt.getProductById(D.productId),Q=D.unitCost||B?.unitCost||0;return U+D.quantity*Q},0)),v=Nt(()=>S().reduce((U,D)=>U+D.quantity,0)),j={"margin-bottom":"1.5rem"},z={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},T={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},R={...T,cursor:"pointer"},J={display:"grid",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},X={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},H={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem","padding-left":"0.75rem"},se={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},O={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},_={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},k={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},$=U=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(U),G=U=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[U]||U,ne=async U=>{await gt.fecthInventory(U),await gt.fecthProduct(U)};return Ln(()=>{ne("prod")}),A(Bn,{get isOpen(){return t.isOpen},onClose:P,get title(){return e("inventory.bulkMovement")},get children(){return[(()=>{var U=W6(),D=U.firstChild,B=D.firstChild,Q=B.firstChild,Z=Q.firstChild,oe=Q.nextSibling,de=B.nextSibling,re=de.firstChild,Y=re.firstChild,ce=re.nextSibling,ue=D.nextSibling,ae=ue.firstChild,ye=ae.firstChild,me=ae.nextSibling,pe=me.firstChild,ve=pe.nextSibling,Ne=ve.nextSibling,Ie=Ne.nextSibling,Ce=ue.nextSibling,Ee=Ce.firstChild,we=Ee.firstChild,Re=Ce.nextSibling,He=Re.firstChild,je=He.firstChild,Ve=Re.nextSibling,qe=Ve.firstChild,tt=qe.nextSibling,rt=Ve.nextSibling;return U.addEventListener("submit",M),D.style.setProperty("display","grid"),D.style.setProperty("grid-template-columns","1fr 1fr"),D.style.setProperty("gap","1rem"),D.style.setProperty("margin-bottom","1.5rem"),a(Q,()=>e("common.invoiceDocumentId"),Z),oe.addEventListener("change",Be=>n(Be.target.value)),a(re,()=>e("common.referenceNumber"),Y),ce.addEventListener("change",Be=>o(Be.target.value)),a(ae,()=>e("inventory.movementType"),ye),me.addEventListener("change",Be=>l(Be.target.value)),a(pe,()=>e("inventory.purchaseReceive")),a(ve,()=>e("inventory.saleIssue")),a(Ne,()=>e("inventory.transfer")),a(Ie,()=>e("inventory.adjustment")),Ce.style.setProperty("display","grid"),Ce.style.setProperty("gap","1rem"),Ce.style.setProperty("margin-bottom","1.5rem"),a(Ce,(()=>{var Be=ke(()=>s()==="transfer");return()=>Be()&&(()=>{var Ge=Y6(),Fe=Ge.firstChild,at=Fe.firstChild;return a(Fe,()=>e("inventory.fromLocation"),at),a(Ge,A(nu,{get value(){return u()},onChange:lt=>h(lt),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>V(!0),required:!0}),null),ge(lt=>p(Fe,z,lt)),Ge})()})(),Ee),a(we,(()=>{var Be=ke(()=>s()==="transfer");return()=>Be()?e("inventory.toLocation")+" *":e("inventory.location")+" *"})()),a(Ee,A(nu,{get value(){return c()},onChange:Be=>d(Be),get placeholder(){return ke(()=>s()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>V(!0),required:!0}),null),He.style.setProperty("display","flex"),He.style.setProperty("justify-content","space-between"),He.style.setProperty("align-items","center"),He.style.setProperty("margin-bottom","1rem"),je.style.setProperty("margin","0"),je.style.setProperty("font-size","1.1rem"),a(je,()=>e("inventory.products")),a(He,A(ct,{variant:"outline",type:"button",onClick:W,get children(){return e("inventory.addProduct")}}),null),a(Re,(()=>{var Be=ke(()=>S().length>0);return()=>Be()&&[(()=>{var Ge=K6(),Fe=Ge.firstChild,at=Fe.nextSibling,lt=at.nextSibling,Xe=lt.nextSibling;return p(Ge,H),a(Fe,()=>e("inventory.product")),a(at,()=>e("inventory.quantity")),a(lt,()=>e("inventory.unitCost")),a(Xe,()=>e("common.notes")),Ge})(),A(vt,{get each(){return S()},children:(Ge,Fe)=>[(()=>{var at=Mm();return p(at,J),a(at,A(zp,{get value(){return Ge.productId},onChange:lt=>{E(Fe(),"productId",lt.id);let Xe={id:lt.id,label:lt.name,code:lt.sku};E(Fe(),"product",Xe);const Ct=gt.getProductById(lt.id);Ct&&!Ge.unitCost&&E(Fe(),"unitCost",Ct.unitCost)},get placeholder(){return e("inventory.searchProduct")},onAddNew:()=>te(!0),required:!0})),at})(),(()=>{var at=Q6(),lt=at.firstChild,Xe=lt.nextSibling,Ct=Xe.nextSibling;return p(at,X),lt.addEventListener("change",Le=>E(Fe(),"quantity",Number(Le.target.value))),Xe.addEventListener("change",Le=>E(Fe(),"unitCost",Number(Le.target.value))),Ct.addEventListener("change",Le=>E(Fe(),"notes",Le.target.value)),a(at,A(ct,{variant:"outline",size:"sm",type:"button",onClick:()=>I(Fe()),style:{color:"#f44336","border-color":"#f44336"},get children(){return e("common.remove")}}),null),ge(Le=>{var nt=T,We=T,kt=e("common.auto"),Et=T,Ot=e("common.optionalNotes");return Le.e=p(lt,nt,Le.e),Le.t=p(Xe,We,Le.t),kt!==Le.a&&Jt(Xe,"placeholder",Le.a=kt),Le.o=p(Ct,Et,Le.o),Ot!==Le.i&&Jt(Ct,"placeholder",Le.i=Ot),Le},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ge(()=>lt.value=Ge.quantity),ge(()=>Xe.value=Ge.unitCost),ge(()=>Ct.value=Ge.notes),at})()]})]})(),null),a(Re,(()=>{var Be=ke(()=>S().length===0);return()=>Be()&&(()=>{var Ge=Mm();return Ge.style.setProperty("text-align","center"),Ge.style.setProperty("padding","2rem"),Ge.style.setProperty("background","var(--background-color)"),Ge.style.setProperty("border-radius","var(--border-radius-sm)"),Ge.style.setProperty("border","1px solid var(--border-color)"),Ge.style.setProperty("color","var(--text-muted)"),a(Ge,()=>e("inventory.noProductsAdded")),Ge})()})(),null),a(U,(()=>{var Be=ke(()=>S().length>0);return()=>Be()&&(()=>{var Ge=J6(),Fe=Ge.firstChild,at=Fe.nextSibling,lt=at.firstChild,Xe=lt.firstChild,Ct=lt.nextSibling,Le=at.nextSibling,nt=Le.firstChild,We=nt.firstChild,kt=nt.nextSibling,Et=Le.nextSibling,Ot=Et.firstChild,jt=Ot.firstChild,mt=Ot.nextSibling,Zt=Et.nextSibling,rr=Zt.firstChild,Dt=rr.firstChild,Kt=rr.nextSibling;return p(Ge,se),Fe.style.setProperty("margin","0 0 1rem 0"),Fe.style.setProperty("font-size","1rem"),a(Fe,()=>e("common.summary")),a(lt,()=>e("inventory.totalProducts"),Xe),Ct.style.setProperty("font-weight","600"),a(Ct,()=>S().length),a(nt,()=>e("inventory.totalItems"),We),kt.style.setProperty("font-weight","600"),a(kt,v),a(Ot,()=>e("inventory.totalValue"),jt),mt.style.setProperty("font-weight","600"),mt.style.setProperty("color","var(--primary-color)"),a(mt,()=>$(w())),a(rr,()=>e("inventory.movementType"),Dt),Kt.style.setProperty("font-weight","600"),a(Kt,()=>G(s())),ge(dt=>{var pt=O,ze=O,bt=O,Mt=O;return dt.e=p(at,pt,dt.e),dt.t=p(Le,ze,dt.t),dt.a=p(Et,bt,dt.a),dt.o=p(Zt,Mt,dt.o),dt},{e:void 0,t:void 0,a:void 0,o:void 0}),Ge})()})(),Ve),a(qe,()=>e("common.generalNotes")),tt.addEventListener("change",Be=>m(Be.target.value)),a(U,(()=>{var Be=ke(()=>x().length>0);return()=>Be()&&(()=>{var Ge=Mm();return p(Ge,_),a(Ge,A(vt,{get each(){return x()},children:Fe=>(()=>{var at=X6();return at.firstChild,a(at,Fe,null),at})()})),Ge})()})(),rt),p(rt,k),a(rt,A(ct,{variant:"secondary",type:"button",onClick:P,get children(){return e("common.cancel")}}),null),a(rt,A(ct,{variant:"primary",type:"submit",get children(){return e("inventory.createMovement")}}),null),ge(Be=>{var Ge=z,Fe=T,at=z,lt=T,Xe=e("common.referenceNumberPlaceholder"),Ct=j,Le=z,nt=R,We=s()==="transfer"?"1fr 1fr":"1fr",kt=z,Et=j,Ot=j,jt=z,mt={...T,"min-height":"80px",resize:"vertical"},Zt=e("inventory.generalNotesPlaceholder");return Be.e=p(Q,Ge,Be.e),Be.t=p(oe,Fe,Be.t),Be.a=p(re,at,Be.a),Be.o=p(ce,lt,Be.o),Xe!==Be.i&&Jt(ce,"placeholder",Be.i=Xe),Be.n=p(ue,Ct,Be.n),Be.s=p(ae,Le,Be.s),Be.h=p(me,nt,Be.h),We!==Be.r&&((Be.r=We)!=null?Ce.style.setProperty("grid-template-columns",We):Ce.style.removeProperty("grid-template-columns")),Be.d=p(we,kt,Be.d),Be.l=p(Re,Et,Be.l),Be.u=p(Ve,Ot,Be.u),Be.c=p(qe,jt,Be.c),Be.w=p(tt,mt,Be.w),Zt!==Be.m&&Jt(tt,"placeholder",Be.m=Zt),Be},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),ge(()=>oe.value=r()),ge(()=>ce.value=i()),ge(()=>me.value=s()),ge(()=>tt.value=g()),U})(),A(Cg,{get isOpen(){return K()},onClose:()=>te(!1),onProductAdded:U=>{te(!1)}}),A(Ag,{get isOpen(){return F()},onClose:()=>V(!1),onLocationAdded:U=>{s()==="transfer"&&!u()?h(U):d(U),V(!1)}})]}})};var eN=le("<div><h1></h1><div>"),Ei=le("<div>"),tN=le("<div><h3></h3><div>"),rN=le("<div>: <!> "),nN=le("<div><button></button><button></button><button></button><button>"),iN=le("<div><div>"),oN=le("<div><span> (<!>)</span><span> / <!> "),sN=le("<div><div><h2></h2></div><div>"),aN=le("<div><div><div><span></span><h3></h3></div><div> • </div><div></div></div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div>:"),lN=le("<div><div><div><div></div><div></div></div><div><div> </div><div></div><div>Min: "),cN=le("<span>⚠️ LOW");const dN=()=>{const{t}=or(),[e,r]=Se(!1),[n,i]=Se(!1),[o,s]=Se(!1),[l,c]=Se(null),[d,u]=Se("overview"),[h,g]=Se("new"),[m,S]=Se([]),[N,x]=Se(!1),[b,K]=Se(!1),[te,F]=Se(!1),[V,W]=Se(!1),[I,E]=Se(1),L=U=>{c(U),s(!0)},M=Nt(()=>{const U=gt.products||[],D=gt.movements||[],B=gt.stockLevels||[],Q=gt.getLowStockProducts(),Z=U?.length||0,oe=U?.filter(Y=>Y.isActive).length,de=B.reduce((Y,ce)=>Y*1+ce.quantity*1*ce.averageCost*1,0),re=D?.filter(Y=>{const ce=new Date(Y.createdDate),ue=new Date;return ce.getMonth()===ue.getMonth()&&ce.getFullYear()===ue.getFullYear()}).length;return{totalProducts:Z,activeProducts:oe,lowStockProducts:Q.length,totalStockValue:de,totalMovementsThisMonth:re,totalLocations:gt.locations.length,activeLocations:gt.getActiveLocations().length}});Nt(()=>gt.products.map(U=>{const D=gt.getStockByProduct(U.id),B=gt.getTotalStockByProduct(U.id),Q=gt.getLastLocationByProduct(U.id);return{...U,totalStock:B,stockByLocation:D,lastLocation:Q,isLowStock:B<=U.minStockLevel}})),Nt(()=>{N(),E(1)});const P=(U,D)=>U<=D?t("inventory.lowStockAlert"):U<=D*2?t("inventory.normalStock"):t("inventory.inStock"),w=U=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(U),v=U=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(U),j=U=>{switch(U){case"warehouse":return t("inventory.warehouse");case"store":return t("inventory.store");case"supplier":return t("inventory.supplier");case"customer":return t("inventory.customer");default:return U}},z={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},T={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},R=U=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500",background:U>50?"#d4edda":U>20?"#fff3cd":"#f8d7da",color:U>50?"#155724":U>20?"#856404":"#721c24"}),J={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},X={color:"var(--text-muted)","font-size":"0.875rem"},H={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},se={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},O={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},_=U=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:U?"var(--primary-color)":"var(--text-muted)","border-bottom":U?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),k={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem","margin-bottom":"2rem"},$={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},G=Nt(()=>{const U=gt.movements;return{total:U.length,stockIn:U.filter(D=>D.movementType==="in").length,stockOut:U.filter(D=>D.movementType==="out").length,transfers:U.filter(D=>D.movementType==="transfer").length,adjustments:U.filter(D=>D.movementType==="adjustment").length,totalValue:U.reduce((D,B)=>D+B.totalCost,0)}}),ne=async()=>{let U=Gt.state?.profile?.businessId;setTimeout(async()=>{await gt.getStockLevels("YY_")},2300),xg.calcStockLevels(),await gt.fecthProduct(U),await gt.fecthInventory(U)};return Ln(()=>{ne()}),A(oo,{get title(){return t("inventory.title")},get children(){return[(()=>{var U=eN(),D=U.firstChild,B=D.nextSibling;return p(U,se),D.style.setProperty("margin","0"),D.style.setProperty("font-size","1.75rem"),B.style.setProperty("display","flex"),B.style.setProperty("align-items","center"),B.style.setProperty("gap","1rem"),a(B,(()=>{var Q=ke(()=>h()==="new");return()=>Q()&&A(ct,{variant:"outline",onClick:()=>F(!0),get children(){return["🔢 ",ke(()=>t("inventory.physicalCount","Physical Count"))]}})})(),null),a(B,A(Me,{get when(){return Gt.hasPermission("read_write")},get children(){return[A(ct,{variant:"outline",onClick:()=>W(!0),get children(){return["📊 ",ke(()=>t("inventory.viewHistoricalReports"))]}}),ke(()=>n()?"O":"X"),A(ct,{variant:"primary",onClick:()=>i(!0),get children(){return ke(()=>h()==="new")()?t("inventory.addMovement"):t("common.add")}})]}}),null),U})(),A(T6,{}),A(Me,{get when(){return Gt.hasPermission("inventoryDownsection")},get children(){return ke(()=>h()==="legacy")()?[(()=>{var U=Ei();return a(U,A(Rt,{get title(){return t("inventory.totalItems")},get subtitle(){return t("inventory.inStock")},get children(){var D=Ei();return D.style.setProperty("font-size","1.5rem"),D.style.setProperty("font-weight","600"),D.style.setProperty("color","var(--primary-color)"),a(D,()=>gt.inventory.length),D}}),null),a(U,A(Rt,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.itemsBelowThreshold")},get children(){var D=Ei();return D.style.setProperty("font-size","1.5rem"),D.style.setProperty("font-weight","600"),D.style.setProperty("color","var(--primary-color)"),a(D,()=>gt.getLowStockItems().length),D}}),null),a(U,A(Rt,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.inventoryWorth")},get children(){var D=Ei();return D.style.setProperty("font-size","1.5rem"),D.style.setProperty("font-weight","600"),D.style.setProperty("color","var(--primary-color)"),a(D,()=>w(gt.getTotalValue())),D}}),null),ge(D=>p(U,H,D)),U})(),(()=>{var U=Ei();return p(U,z),a(U,A(vt,{get each(){return gt.inventory},children:D=>{const B=P(D.quantity,D.minStock),Q=D.quantity<=D.minStock?8:D.quantity<=D.minStock*2?35:75;return A(Rt,{onClick:()=>L(D),get children(){return[(()=>{var Z=tN(),oe=Z.firstChild,de=oe.nextSibling;return p(Z,T),oe.style.setProperty("margin","0"),oe.style.setProperty("font-size","1.1rem"),a(oe,()=>D.name),a(de,B),ge(re=>p(de,R(Q),re)),Z})(),(()=>{var Z=Ei();return p(Z,J),a(Z,()=>w(D.price)),Z})(),(()=>{var Z=rN(),oe=Z.firstChild,de=oe.nextSibling;return de.nextSibling,p(Z,X),a(Z,()=>t("inventory.quantity"),oe),a(Z,()=>D.quantity,de),a(Z,()=>t("common.units"),null),Z})()]}})}})),U})()]:[(()=>{var U=nN(),D=U.firstChild,B=D.nextSibling,Q=B.nextSibling,Z=Q.nextSibling;return p(U,O),D.$$click=()=>u("overview"),a(D,()=>t("inventory.overview")),B.$$click=()=>u("products"),a(B,()=>t("inventory.products")),Q.$$click=()=>u("movements"),a(Q,()=>t("inventory.movements")),Z.$$click=()=>u("locations"),a(Z,()=>t("inventory.locations")),ge(oe=>{var de=_(d()==="overview"),re=_(d()==="products"),Y=_(d()==="movements"),ce=_(d()==="locations");return oe.e=p(D,de,oe.e),oe.t=p(B,re,oe.t),oe.a=p(Q,Y,oe.a),oe.o=p(Z,ce,oe.o),oe},{e:void 0,t:void 0,a:void 0,o:void 0}),U})(),ke(()=>ke(()=>d()==="overview")()&&(()=>{var U=iN(),D=U.firstChild;return a(D,A(Rt,{get title(){return t("inventory.activeProducts")},get subtitle(){return t("inventory.currentlyManaged")},get children(){var B=Ei();return B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","var(--primary-color)"),a(B,()=>M().activeProducts),B}}),null),a(D,A(Rt,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.needAttention")},get children(){var B=Ei();return B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","#d32f2f"),a(B,()=>M().lowStockProducts),B}}),null),a(D,A(Rt,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.currentWorth")},get children(){var B=Ei();return B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","var(--primary-color)"),a(B,()=>v(G().totalValue)),B}}),null),a(D,A(Rt,{get title(){return t("inventory.movements")},get subtitle(){return t("inventory.thisMonth")},get children(){var B=Ei();return B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","var(--primary-color)"),a(B,()=>M().totalMovementsThisMonth),B}}),null),a(D,A(Rt,{get title(){return t("inventory.activeLocations")},get subtitle(){return t("inventory.warehousesStores")},get children(){var B=Ei();return B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","var(--primary-color)"),a(B,()=>M().activeLocations),B}}),null),a(U,(()=>{var B=ke(()=>M().lowStockProducts>0);return()=>B()&&A(Rt,{get title(){return`⚠️ ${t("inventory.lowStockAlert")}`},get subtitle(){return`${M().lowStockProducts} ${t("inventory.productsNeedRestocking")}`},style:{"margin-bottom":"2rem","border-color":"#ffcdd2",background:"#ffebee"},get children(){var Q=Ei();return Q.style.setProperty("margin-top","1rem"),a(Q,A(vt,{get each(){return gt.getLowStockProducts().slice(0,9)},children:Z=>(()=>{var oe=oN(),de=oe.firstChild,re=de.firstChild,Y=re.nextSibling;Y.nextSibling;var ce=de.nextSibling,ue=ce.firstChild,ae=ue.nextSibling;return ae.nextSibling,oe.style.setProperty("display","flex"),oe.style.setProperty("justify-content","space-between"),oe.style.setProperty("margin-bottom","0.5rem"),oe.style.setProperty("font-size","0.875rem"),a(de,()=>Z.name,re),a(de,()=>Z?.sku,Y),ce.style.setProperty("color","#d32f2f"),ce.style.setProperty("font-weight","600"),a(ce,()=>Z.currentStock,ue),a(ce,()=>Z.minStockLevel,ae),a(ce,()=>t("inventory.min"),null),oe})()}),null),a(Q,(()=>{var Z=ke(()=>gt.getLowStockProducts().length>5);return()=>Z()&&(()=>{var oe=Ei();return oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),oe.style.setProperty("font-style","italic"),a(oe,()=>t("common.andMore",{count:gt.getLowStockProducts().length-9})),oe})()})(),null),Q}})})(),null),ge(B=>p(D,H,B)),U})()),ke(()=>ke(()=>d()==="products")()&&A(LP,{})),ke(()=>ke(()=>d()==="movements")()&&A(Nk,{})),ke(()=>ke(()=>d()==="locations")()&&(()=>{var U=sN(),D=U.firstChild,B=D.firstChild,Q=D.nextSibling;return D.style.setProperty("display","flex"),D.style.setProperty("justify-content","space-between"),D.style.setProperty("align-items","center"),D.style.setProperty("margin-bottom","1.5rem"),B.style.setProperty("margin","0"),B.style.setProperty("font-size","1.5rem"),a(B,()=>t("inventory.locations")),a(D,A(Me,{get when(){return Gt.hasPermission("read_write")},get children(){return A(ct,{variant:"primary",onClick:()=>K(!0),get children(){return["🏭 ",ke(()=>t("inventory.addLocation"))]}})}}),null),p(Q,k),a(Q,A(vt,{get each(){return gt.getActiveLocations()},children:Z=>{const oe=gt.getStockByLocation(Z.id),de=oe?.length,re=oe?.reduce((ce,ue)=>ce*1+ue.quantity*1,0),Y=oe?.reduce((ce,ue)=>(gt?.getProductById(ue.productId),ce+(ue?.averageCost||0)),0);return(()=>{var ce=aN(),ue=ce.firstChild,ae=ue.firstChild,ye=ae.firstChild,me=ye.nextSibling,pe=ae.nextSibling,ve=pe.firstChild,Ne=pe.nextSibling,Ie=ue.nextSibling,Ce=Ie.firstChild,Ee=Ce.firstChild,we=Ee.firstChild,Re=Ee.nextSibling,He=Ce.nextSibling,je=He.firstChild,Ve=je.firstChild,qe=je.nextSibling,tt=He.nextSibling,rt=tt.firstChild,Be=rt.firstChild,Ge=rt.nextSibling,Fe=Ie.nextSibling,at=Fe.firstChild,lt=at.firstChild;return ue.style.setProperty("margin-bottom","1rem"),ue.style.setProperty("padding-bottom","1rem"),ue.style.setProperty("border-bottom","1px solid var(--border-color)"),ae.style.setProperty("display","flex"),ae.style.setProperty("align-items","center"),ae.style.setProperty("gap","0.5rem"),ae.style.setProperty("margin-bottom","0.5rem"),ye.style.setProperty("font-size","1.2rem"),a(ye,()=>Z.type==="warehouse"?"🏭":Z.type==="store"?"🏪":Z.type==="supplier"?"🚚":"👥"),me.style.setProperty("margin","0"),me.style.setProperty("font-size","1.1rem"),a(me,()=>Z.name),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),a(pe,()=>Z.code,ve),a(pe,()=>j(Z.type),null),Ne.style.setProperty("font-size","0.75rem"),Ne.style.setProperty("color","var(--text-muted)"),Ne.style.setProperty("margin-top","0.25rem"),a(Ne,()=>Z.address),Ie.style.setProperty("margin-bottom","1rem"),Ce.style.setProperty("display","flex"),Ce.style.setProperty("justify-content","space-between"),Ce.style.setProperty("margin-bottom","0.5rem"),Ee.style.setProperty("font-size","0.875rem"),Ee.style.setProperty("font-weight","500"),a(Ee,()=>t("inventory.products"),we),Re.style.setProperty("font-weight","600"),a(Re,de),He.style.setProperty("display","flex"),He.style.setProperty("justify-content","space-between"),He.style.setProperty("margin-bottom","0.5rem"),je.style.setProperty("font-size","0.875rem"),je.style.setProperty("font-weight","500"),a(je,()=>t("inventory.totalItems"),Ve),qe.style.setProperty("font-weight","600"),qe.style.setProperty("color","var(--primary-color)"),a(qe,re),tt.style.setProperty("display","flex"),tt.style.setProperty("justify-content","space-between"),tt.style.setProperty("margin-bottom","1rem"),rt.style.setProperty("font-size","0.875rem"),rt.style.setProperty("font-weight","500"),a(rt,()=>t("inventory.totalValue"),Be),Ge.style.setProperty("font-weight","600"),Ge.style.setProperty("color","var(--primary-color)"),a(Ge,()=>v(Y)),at.style.setProperty("font-weight","600"),at.style.setProperty("margin-bottom","0.75rem"),at.style.setProperty("font-size","0.875rem"),at.style.setProperty("color","var(--text-primary)"),at.style.setProperty("border-bottom","1px solid var(--border-color)"),at.style.setProperty("padding-bottom","0.5rem"),a(at,()=>t("inventory.productDetails"),lt),a(Fe,(()=>{var Xe=ke(()=>oe?.length===0);return()=>Xe()?(()=>{var Ct=Ei();return Ct.style.setProperty("text-align","center"),Ct.style.setProperty("color","var(--text-muted)"),Ct.style.setProperty("font-style","italic"),Ct.style.setProperty("padding","1rem"),a(Ct,()=>t("inventory.noProducts")),Ct})():(()=>{var Ct=Ei();return Ct.style.setProperty("max-height","200px"),Ct.style.setProperty("overflow-y","auto"),Ct.style.setProperty("border","1px solid var(--border-color)"),Ct.style.setProperty("border-radius","var(--border-radius-sm)"),a(Ct,A(vt,{each:oe,children:Le=>{const nt=gt.getProductById(Le.productId);if(!nt)return null;const We=Le.quantity<=nt.minStockLevel,kt=Le.averageCost;return Le.quantity?(()=>{var Et=lN(),Ot=Et.firstChild,jt=Ot.firstChild,mt=jt.firstChild,Zt=mt.nextSibling,rr=jt.nextSibling,Dt=rr.firstChild,Kt=Dt.firstChild,dt=Dt.nextSibling,pt=dt.nextSibling;return pt.firstChild,Et.style.setProperty("padding","0.75rem"),Et.style.setProperty("border-bottom","1px solid var(--border-color)"),(We?"#fff5f5":"transparent")!=null?Et.style.setProperty("background",We?"#fff5f5":"transparent"):Et.style.removeProperty("background"),Et.style.setProperty("transition","background-color 0.2s ease"),Ot.style.setProperty("display","flex"),Ot.style.setProperty("justify-content","space-between"),Ot.style.setProperty("align-items","flex-start"),Ot.style.setProperty("margin-bottom","0.25rem"),jt.style.setProperty("flex","1"),mt.style.setProperty("font-weight","500"),mt.style.setProperty("font-size","0.875rem"),(We?"#d32f2f":"var(--text-primary)")!=null?mt.style.setProperty("color",We?"#d32f2f":"var(--text-primary)"):mt.style.removeProperty("color"),a(mt,()=>nt.name,null),a(mt,We&&(()=>{var ze=cN();return ze.style.setProperty("margin-left","0.5rem"),ze.style.setProperty("font-size","0.7rem"),ze.style.setProperty("color","#d32f2f"),ze})(),null),Zt.style.setProperty("font-size","0.75rem"),Zt.style.setProperty("color","var(--text-muted)"),Zt.style.setProperty("margin-top","0.1rem"),a(Zt,()=>nt.sku,null),a(Zt,()=>nt.UPC?" • "+nt.UPC:"",null),a(Zt,()=>nt.category?" • "+nt.category:"",null),rr.style.setProperty("text-align","right"),Dt.style.setProperty("font-weight","600"),Dt.style.setProperty("font-size","0.875rem"),(We?"#d32f2f":"var(--primary-color)")!=null?Dt.style.setProperty("color",We?"#d32f2f":"var(--primary-color)"):Dt.style.removeProperty("color"),a(Dt,()=>Le.quantity,Kt),a(Dt,()=>nt.unitOfMeasure,null),dt.style.setProperty("font-size","0.75rem"),dt.style.setProperty("color","var(--text-muted)"),a(dt,()=>v(kt)),pt.style.setProperty("font-size","0.7rem"),pt.style.setProperty("color","var(--text-muted)"),pt.style.setProperty("margin-top","0.1rem"),a(pt,()=>nt.minStockLevel,null),Et})():null}})),Ct})()})(),null),ge(Xe=>p(ce,{...$,"min-height":"400px"},Xe)),ce})()}})),U})())]}}),A(Me,{get when(){return Gt.hasPermission("read_write")},get children(){return[A(ik,{get isOpen(){return o()},onClose:()=>s(!1),get item(){return l()}}),A(Ag,{get isOpen(){return b()},onClose:()=>K(!1),onLocationAdded:()=>{K(!1)}})]}}),A(Z6,{get isOpen(){return n()},onClose:()=>i(!1)}),A(ZT,{get isOpen(){return e()},onClose:()=>r(!1),get mode(){return h()==="new"?"movement":"legacy"}}),A(Uk,{get isOpen(){return te()},onClose:()=>F(!1)}),A(G6,{get isOpen(){return V()},onClose:()=>W(!1)})]}})};Wt(["click"]);Wt(["click"]);const uN=[{id:"1",name:"John Doe",position:"Software Engineer",salary:85e3,email:"john.doe@company.com",phone:"+1 (555) 123-4567",department:"Engineering",startDate:"2023-01-15"},{id:"2",name:"Jane Smith",position:"Product Manager",salary:95e3,email:"jane.smith@company.com",phone:"+1 (555) 234-5678",department:"Product",startDate:"2022-08-20"},{id:"3",name:"Mike Brown",position:"Designer",salary:7e4,email:"mike.brown@company.com",phone:"+1 (555) 345-6789",department:"Design",startDate:"2023-03-10"},{id:"4",name:"Sarah Kim",position:"HR Manager",salary:78e3,email:"sarah.kim@company.com",phone:"+1 (555) 456-7890",department:"Human Resources",startDate:"2022-11-05"},{id:"5",name:"Alex Lee",position:"Data Analyst",salary:72e3,email:"alex.lee@company.com",phone:"+1 (555) 567-8901",department:"Analytics",startDate:"2023-02-28"},{id:"6",name:"Emma Wilson",position:"Marketing Manager",salary:82e3,email:"emma.wilson@company.com",phone:"+1 (555) 678-9012",department:"Marketing",startDate:"2022-09-15"}],[yd,Fm]=Se(uN),RP={get employees(){return yd()},addEmployee(t){const e={...t,id:Date.now().toString()};return Fm([...yd(),e]),e},updateEmployee(t,e){Fm(yd().map(r=>r.id===t?{...r,...e}:r))},deleteEmployee(t){Fm(yd().filter(e=>e.id!==t))},getEmployeeById(t){return yd().find(e=>e.id===t)}};var hN=le("<form><div>");const pN=t=>{const{t:e}=or(),[r,n]=Se({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),i=[{value:"Engineering",label:e("employees.departments.engineering","Engineering")},{value:"Product",label:e("employees.departments.product","Product")},{value:"Design",label:e("employees.departments.design","Design")},{value:"Marketing",label:e("employees.departments.marketing","Marketing")},{value:"Sales",label:e("employees.departments.sales","Sales")},{value:"Human Resources",label:e("employees.departments.humanResources","Human Resources")},{value:"Finance",label:e("employees.departments.finance","Finance")},{value:"Operations",label:e("employees.departments.operations","Operations")},{value:"Analytics",label:e("employees.departments.analytics","Analytics")}],o={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},s=c=>{c.preventDefault();const d=r();if(!d.name||!d.position||!d.salary||!d.email||!d.department||!d.startDate){alert(e("forms.requiredField"));return}const u={name:d.name,position:d.position,salary:parseFloat(d.salary),email:d.email,phone:d.phone,department:d.department,startDate:d.startDate};RP.addEmployee(u),n({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),t.onClose()},l=(c,d)=>{n(u=>({...u,[c]:d}))};return A(Bn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.addEmployee")},get children(){var c=hN(),d=c.firstChild;return c.addEventListener("submit",s),a(c,A(Lt,{get label(){return e("employees.fullName")},get value(){return r().name},onChange:u=>l("name",u),get placeholder(){return e("employees.enterFullName","Enter employee's full name")},required:!0}),d),a(c,A(Lt,{get label(){return e("employees.position")},get value(){return r().position},onChange:u=>l("position",u),get placeholder(){return e("employees.enterPosition","Enter job position")},required:!0}),d),a(c,A(en,{get label(){return e("employees.department")},get value(){return r().department},onChange:u=>l("department",u),options:i,required:!0}),d),a(c,A(Lt,{get label(){return e("employees.email")},type:"email",get value(){return r().email},onChange:u=>l("email",u),get placeholder(){return e("employees.enterEmail","Enter email address")},required:!0}),d),a(c,A(Lt,{get label(){return e("employees.phone")},type:"tel",get value(){return r().phone},onChange:u=>l("phone",u),get placeholder(){return e("employees.enterPhone","Enter phone number")}}),d),a(c,A(Lt,{get label(){return e("employees.salary")},type:"number",get value(){return r().salary},onChange:u=>l("salary",u),get placeholder(){return e("employees.enterSalary","Enter annual salary")},required:!0}),d),a(c,A(Lt,{get label(){return e("employees.hireDate")},type:"date",get value(){return r().startDate},onChange:u=>l("startDate",u),required:!0}),d),p(d,o),a(d,A(ct,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(d,A(ct,{variant:"primary",type:"submit",get children(){return e("employees.addEmployee")}}),null),c}})};var mN=le("<div><div></div><div></div><div>"),yN=le("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),fN=le("<div>");const gN=t=>{const{t:e}=or(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={width:"80px",height:"80px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.5rem",margin:"0 auto 1.5rem auto"},s={"text-align":"center","margin-bottom":"2rem"},l={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},c={color:"var(--text-muted)","font-size":"1rem"},d={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"};if(!t.employee)return null;const u=m=>m.split(" ").map(S=>S[0]).join("").toUpperCase(),h=m=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(m),g=m=>new Date(m).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return A(Bn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.employeeDetails")},get children(){return[(()=>{var m=mN(),S=m.firstChild,N=S.nextSibling,x=N.nextSibling;return p(m,s),p(S,o),a(S,()=>u(t.employee.name)),p(N,l),a(N,()=>t.employee.name),p(x,c),a(x,()=>t.employee.position),m})(),(()=>{var m=yN(),S=m.firstChild,N=S.firstChild,x=N.nextSibling,b=S.nextSibling,K=b.firstChild,te=K.nextSibling,F=b.nextSibling,V=F.firstChild,W=V.nextSibling,I=F.nextSibling,E=I.firstChild,L=E.nextSibling,M=I.nextSibling,P=M.firstChild,w=P.nextSibling,v=M.nextSibling,j=v.firstChild,z=j.nextSibling;return a(N,()=>e("employees.employeeId")),a(x,()=>t.employee.id),a(K,()=>e("employees.department")),a(te,()=>t.employee.department),a(V,()=>e("employees.email")),a(W,()=>t.employee.email),a(E,()=>e("employees.phone")),a(L,()=>t.employee.phone),a(P,()=>e("employees.salary")),a(w,()=>h(t.employee.salary)),a(j,()=>e("employees.hireDate")),a(z,()=>g(t.employee.startDate)),ge(T=>{var R=r,J=n,X=i,H=r,se=n,O=i,_=r,k=n,$=i,G=r,ne=n,U=i,D=r,B=n,Q=i,Z=r,oe=n,de=i;return T.e=p(S,R,T.e),T.t=p(N,J,T.t),T.a=p(x,X,T.a),T.o=p(b,H,T.o),T.i=p(K,se,T.i),T.n=p(te,O,T.n),T.s=p(F,_,T.s),T.h=p(V,k,T.h),T.r=p(W,$,T.r),T.d=p(I,G,T.d),T.l=p(E,ne,T.l),T.u=p(L,U,T.u),T.c=p(M,D,T.c),T.w=p(P,B,T.w),T.m=p(w,Q,T.m),T.f=p(v,Z,T.f),T.y=p(j,oe,T.y),T.g=p(z,de,T.g),T},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),m})(),(()=>{var m=fN();return p(m,d),a(m,A(ct,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),a(m,A(ct,{variant:"primary",onClick:()=>{console.log("Edit employee:",t.employee.id)},get children(){return e("employees.editEmployee")}}),null),m})()]}})};var c1=le("<div>"),vN=le("<div><div></div><div><div></div><div></div><div>/year");const bN=()=>{const{t}=or(),[e,r]=Se(!1),[n,i]=Se(!1),[o,s]=Se(null),l=N=>{s(N),i(!0)},c={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},d={display:"flex","align-items":"center",gap:"1rem"},u={width:"60px",height:"60px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.2rem"},h={flex:"1"},g={"font-weight":"600","margin-bottom":"0.25rem"},m={color:"var(--text-muted)","font-size":"0.875rem","margin-bottom":"0.5rem"},S={color:"var(--primary-color)","font-weight":"500"};return A(oo,{get title(){return t("employees.title")},get children(){return[(()=>{var N=c1();return N.style.setProperty("margin-bottom","2rem"),a(N,A(ct,{variant:"primary",onClick:()=>r(!0),get children(){return t("employees.addEmployee")}})),N})(),(()=>{var N=c1();return p(N,c),a(N,()=>RP.employees.map(x=>{const b=te=>te.split(" ").map(F=>F[0]).join("").toUpperCase(),K=te=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(te);return A(Rt,{onClick:()=>l(x),get children(){var te=vN(),F=te.firstChild,V=F.nextSibling,W=V.firstChild,I=W.nextSibling,E=I.nextSibling,L=E.firstChild;return p(te,d),p(F,u),a(F,()=>b(x.name)),p(V,h),p(W,g),a(W,()=>x.name),p(I,m),a(I,()=>x.position),p(E,S),a(E,()=>K(x.salary),L),te}})})),N})(),A(pN,{get isOpen(){return e()},onClose:()=>r(!1)}),A(gN,{get isOpen(){return n()},onClose:()=>i(!1),get employee(){return o()}})]}})},PN=[{id:"1",accountId:"1002",bankName:"First National Bank",accountNumber:"****1234",accountType:"checking",currency:"USD",currentBalance:32730.5,lastReconciledDate:"2024-01-01",lastReconciledBalance:3e4,isActive:!0},{id:"2",accountId:"1003",bankName:"First National Bank",accountNumber:"****5678",accountType:"savings",currency:"USD",currentBalance:12e3,lastReconciledDate:"2024-01-01",lastReconciledBalance:1e4,isActive:!0}],_N=[{id:"1",accountId:"1002",date:"2024-01-15",description:"Customer Payment - ABC Corp",reference:"CHK001234",debitAmount:5e3,creditAmount:0,balance:35730.5,category:"Customer Payment",isReconciled:!0,reconciledWith:"eb1",importedAt:"2024-01-16",source:"csv_import"},{id:"2",accountId:"1002",date:"2024-01-14",description:"Office Supplies - Staples",reference:"CHK001235",debitAmount:0,creditAmount:250,balance:30730.5,category:"Office Expenses",isReconciled:!0,reconciledWith:"eb2",importedAt:"2024-01-16",source:"csv_import"},{id:"3",accountId:"1002",date:"2024-01-13",description:"Monthly Rent Payment",reference:"CHK001236",debitAmount:0,creditAmount:2e3,balance:28730.5,category:"Rent",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"},{id:"4",accountId:"1002",date:"2024-01-12",description:"Wire Transfer In",reference:"WIRE001",debitAmount:1e4,creditAmount:0,balance:38730.5,category:"Wire Transfer",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"}],SN=[{id:"eb1",accountId:"1002",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",debitAmount:5e3,creditAmount:0,category:"Accounts Receivable",isReconciled:!0,reconciledWith:"1",createdAt:"2024-01-15"},{id:"eb2",accountId:"1002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",debitAmount:0,creditAmount:250,category:"Office Expenses",isReconciled:!0,reconciledWith:"2",createdAt:"2024-01-14"},{id:"eb3",accountId:"1002",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",debitAmount:0,creditAmount:3500,category:"Salary Expense",isReconciled:!1,createdAt:"2024-01-11"}],wN=[{id:"1",bankAccountId:"1",periodStart:"2024-01-01",periodEnd:"2024-01-15",startingBalance:3e4,endingBalance:35730.5,status:"in_progress",totalBankTransactions:4,totalEntryBookRecords:3,reconciledTransactions:2,unreconciledTransactions:2,discrepancyAmount:1500,createdAt:"2024-01-16",notes:"Wire transfer and rent payment need investigation"}],[rh,d1]=Se(PN),[_a,Om]=Se(_N),[fd,u1]=Se(SN),[nh,h1]=Se(wN),zn={get bankAccounts(){return rh()},addBankAccount(t){const e={...t,id:Date.now().toString()};return d1([...rh(),e]),e},updateBankAccount(t,e){d1(rh().map(r=>r.id===t?{...r,...e}:r))},getBankAccountById(t){return rh().find(e=>e.id===t)},get bankStatements(){return _a()},addBankStatement(t){const e={...t,id:Date.now().toString(),importedAt:new Date().toISOString()};return Om([..._a(),e]),e},addBankStatementsFromCSV(t){const e=t.map(r=>({...r,id:`csv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,importedAt:new Date().toISOString(),source:"csv_import",isReconciled:!1}));return Om([..._a(),...e]),e},updateBankStatement(t,e){Om(_a().map(r=>r.id===t?{...r,...e}:r))},getBankStatementsByAccount(t){return _a().filter(e=>e.accountId===t)},getUnreconciledBankStatements(t){return(t?this.getBankStatementsByAccount(t):_a()).filter(r=>!r.isReconciled)},get entryBookRecords(){return fd()},addEntryBookRecord(t){const e={...t,id:Date.now().toString(),createdAt:new Date().toISOString()};return u1([...fd(),e]),e},updateEntryBookRecord(t,e){u1(fd().map(r=>r.id===t?{...r,...e}:r))},getEntryBookRecordsByAccount(t){return fd().filter(e=>e.accountId===t)},getUnreconciledEntryBookRecords(t){return(t?this.getEntryBookRecordsByAccount(t):fd()).filter(r=>!r.isReconciled)},reconcileTransaction(t,e){this.updateBankStatement(t,{isReconciled:!0,reconciledWith:e}),this.updateEntryBookRecord(e,{isReconciled:!0,reconciledWith:t})},unreconciledTransaction(t){const e=_a().find(r=>r.id===t);e?.reconciledWith&&this.updateEntryBookRecord(e.reconciledWith,{isReconciled:!1,reconciledWith:void 0}),this.updateBankStatement(t,{isReconciled:!1,reconciledWith:void 0})},findPotentialMatches(t){const e=_a().find(n=>n.id===t);return e?this.getUnreconciledEntryBookRecords(e.accountId).filter(n=>{const i=Math.abs(e.debitAmount-n.debitAmount)<.01||Math.abs(e.creditAmount-n.creditAmount)<.01,o=new Date(e.date),s=new Date(n.date),c=Math.abs((o.getTime()-s.getTime())/(1e3*60*60*24))<=3,d=e.reference===n.reference||e.description.toLowerCase().includes(n.description.toLowerCase())||n.description.toLowerCase().includes(e.description.toLowerCase());return i&&(c||d)}).sort((n,i)=>{const o=(n.date===e.date?2:0)+(n.reference===e.reference?1:0);return(i.date===e.date?2:0)+(i.reference===e.reference?1:0)-o}):[]},get reconciliationSessions(){return nh()},startReconciliationSession(t,e,r){const n=this.getBankStatementsByAccount(t).filter(d=>d.date>=e&&d.date<=r),i=this.getEntryBookRecordsByAccount(t).filter(d=>d.date>=e&&d.date<=r),o=n.filter(d=>d.isReconciled).length,s=this.getBankAccountById(t)?.lastReconciledBalance||0,l=this.getBankAccountById(t)?.currentBalance||0,c={id:Date.now().toString(),bankAccountId:t,periodStart:e,periodEnd:r,startingBalance:s,endingBalance:l,status:"in_progress",totalBankTransactions:n.length,totalEntryBookRecords:i.length,reconciledTransactions:o,unreconciledTransactions:n.length-o,discrepancyAmount:0,createdAt:new Date().toISOString()};return h1([...nh(),c]),c},updateReconciliationSession(t,e){h1(nh().map(r=>r.id===t?{...r,...e}:r))},getReconciliationSessionsByAccount(t){return nh().filter(e=>e.bankAccountId===t)}};var Bm=le("<div>"),xN=le("<div><strong>:</strong> <!> - "),CN=le("<div><div><div>📄</div><div></div><div></div></div><input id=csvFileInput type=file accept=.csv>"),AN=le("<div><h4></h4><div><div><label> *</label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value>"),ac=le("<option>"),$N=le("<div><table><thead><tr></tr></thead><tbody>"),EN=le("<th>"),IN=le("<tr>"),TN=le("<td>");const kN=t=>{const{t:e}=or(),[r,n]=Se(!1),[i,o]=Se(!1),[s,l]=Se(null),[c,d]=Se([]),[u,h]=Se({date:"",description:"",reference:"",debit:"",credit:"",balance:""}),g={border:`2px dashed ${r()?"var(--primary-color)":"var(--border-color)"}`,"border-radius":"var(--border-radius)",padding:"2rem","text-align":"center","background-color":r()?"var(--background-color)":"transparent",transition:"all 0.2s ease",cursor:"pointer"},m={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem","margin-top":"1.5rem"},S={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-family":"inherit"},N={"max-height":"200px","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},x={width:"100%","border-collapse":"collapse","font-size":"0.875rem"},b={padding:"0.5rem","border-bottom":"1px solid var(--border-color)","text-align":"left"},K={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},te=w=>{w.preventDefault(),n(!0)},F=w=>{w.preventDefault(),n(!1)},V=w=>{w.preventDefault(),n(!1);const v=w.dataTransfer?.files;v&&v.length>0&&I(v[0])},W=w=>{const v=w.target;v.files&&v.files.length>0&&I(v.files[0])},I=w=>{if(!w.name.toLowerCase().endsWith(".csv")){l({success:!1,message:e("banking.pleaseUploadCSV")});return}o(!0);const v=new FileReader;v.onload=j=>{try{const T=(j.target?.result).split(`
`).filter(H=>H.trim());if(T.length<2){l({success:!1,message:e("banking.csvRequiresHeaderAndData")}),o(!1);return}const R=T[0].split(",").map(H=>H.trim().replace(/[\"\']/g,"")),J=T.slice(1).map(H=>{const se=H.split(",").map(_=>_.trim().replace(/[\"\']/g,"")),O={};return R.forEach((_,k)=>{O[_]=se[k]||""}),O});d(J),l({success:!0,message:e("banking.successfullyParsed").replace("{count}",J.length.toString()),count:J.length});const X={...u()};R.forEach(H=>{const se=H.toLowerCase();se.includes("date")&&(X.date=H),(se.includes("description")||se.includes("memo"))&&(X.description=H),(se.includes("reference")||se.includes("check")||se.includes("ref"))&&(X.reference=H),(se.includes("debit")||se.includes("deposit"))&&(X.debit=H),(se.includes("credit")||se.includes("withdrawal")||se.includes("amount"))&&(X.debit?X.credit=H:X.debit=H),se.includes("balance")&&(X.balance=H)}),h(X)}catch{l({success:!1,message:e("banking.errorParsingCSV")})}o(!1)},v.readAsText(w)},E=(w,v)=>{h(j=>({...j,[w]:v}))},L=()=>c().length===0?[]:Object.keys(c()[0]),M=()=>{if(!t.bankAccount||c().length===0)return;const w=u();if(!w.date||!w.description){l({success:!1,message:e("banking.dateDescriptionRequired")});return}o(!0);try{const v=c().map(z=>{const T=H=>H&&parseFloat(H.replace(/[^0-9.-]/g,""))||0,R=H=>{const se=new Date(H);if(isNaN(se.getTime())){const O=H.split("/");if(O.length===3)return new Date(parseInt(O[2]),parseInt(O[0])-1,parseInt(O[1])).toISOString().split("T")[0]}return se.toISOString().split("T")[0]};let J=0,X=0;if(w.debit&&w.credit)J=T(z[w.debit]),X=T(z[w.credit]);else if(w.debit){const H=T(z[w.debit]);H>0?J=H:X=Math.abs(H)}return{accountId:t.bankAccount.accountId,date:R(z[w.date]),description:z[w.description]||e("banking.importedTransaction"),reference:z[w.reference]||"",debitAmount:J,creditAmount:X,balance:w.balance?T(z[w.balance]):0,isReconciled:!1}}),j=zn.addBankStatementsFromCSV(v);l({success:!0,message:e("banking.successfullyImported").replace("{count}",j.length.toString()),count:j.length}),d([]),h({date:"",description:"",reference:"",debit:"",credit:"",balance:""})}catch{l({success:!1,message:e("banking.errorImportingTransactions")})}o(!1)},P=()=>{d([]),l(null),h({date:"",description:"",reference:"",debit:"",credit:"",balance:""})};return A(Bn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("banking.importBankStatementCSV")},get children(){return[ke(()=>ke(()=>!!t.bankAccount)()&&(()=>{var w=xN(),v=w.firstChild,j=v.firstChild,z=v.nextSibling,T=z.nextSibling;return T.nextSibling,w.style.setProperty("margin-bottom","1.5rem"),w.style.setProperty("padding","1rem"),w.style.setProperty("background","var(--background-color)"),w.style.setProperty("border-radius","var(--border-radius-sm)"),w.style.setProperty("border","1px solid var(--border-color)"),a(v,()=>e("banking.bankAccount"),j),a(w,()=>t.bankAccount.bankName,T),a(w,()=>t.bankAccount.accountNumber,null),w})()),ke(()=>ke(()=>c().length===0)()?(()=>{var w=CN(),v=w.firstChild,j=v.firstChild,z=j.nextSibling,T=z.nextSibling,R=v.nextSibling;return v.$$click=()=>document.getElementById("csvFileInput")?.click(),v.addEventListener("drop",V),v.addEventListener("dragleave",F),v.addEventListener("dragover",te),j.style.setProperty("font-size","2rem"),j.style.setProperty("margin-bottom","1rem"),z.style.setProperty("font-weight","500"),z.style.setProperty("margin-bottom","0.5rem"),a(z,(()=>{var J=ke(()=>!!r());return()=>J()?e("banking.dropCSVHere"):e("banking.clickToUploadCSV")})()),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","var(--text-muted)"),a(T,()=>e("banking.supportedFormat")),R.addEventListener("change",W),R.style.setProperty("display","none"),ge(J=>p(v,g,J)),w})():(()=>{var w=AN(),v=w.firstChild,j=v.nextSibling,z=j.firstChild,T=z.firstChild,R=T.firstChild,J=T.nextSibling,X=J.firstChild,H=z.nextSibling,se=H.firstChild,O=se.firstChild,_=se.nextSibling,k=_.firstChild,$=H.nextSibling,G=$.firstChild,ne=G.nextSibling,U=ne.firstChild,D=$.nextSibling,B=D.firstChild,Q=B.firstChild,Z=B.nextSibling,oe=Z.firstChild,de=D.nextSibling,re=de.firstChild,Y=re.nextSibling,ce=Y.firstChild,ue=de.nextSibling,ae=ue.firstChild,ye=ae.nextSibling,me=ye.firstChild;return v.style.setProperty("margin","0 0 1rem 0"),a(v,()=>e("banking.mapCSVColumns")),p(j,m),T.style.setProperty("display","block"),T.style.setProperty("margin-bottom","0.5rem"),T.style.setProperty("font-weight","500"),a(T,()=>e("banking.dateColumn"),R),J.addEventListener("change",pe=>E("date",pe.target.value)),a(X,()=>e("banking.selectColumn")),a(J,()=>L().map(pe=>(()=>{var ve=ac();return ve.value=pe,a(ve,pe),ve})()),null),se.style.setProperty("display","block"),se.style.setProperty("margin-bottom","0.5rem"),se.style.setProperty("font-weight","500"),a(se,()=>e("banking.descriptionColumn"),O),_.addEventListener("change",pe=>E("description",pe.target.value)),a(k,()=>e("banking.selectColumn")),a(_,()=>L().map(pe=>(()=>{var ve=ac();return ve.value=pe,a(ve,pe),ve})()),null),G.style.setProperty("display","block"),G.style.setProperty("margin-bottom","0.5rem"),G.style.setProperty("font-weight","500"),a(G,()=>e("banking.referenceColumn")),ne.addEventListener("change",pe=>E("reference",pe.target.value)),a(U,()=>e("banking.selectColumn")),a(ne,()=>L().map(pe=>(()=>{var ve=ac();return ve.value=pe,a(ve,pe),ve})()),null),B.style.setProperty("display","block"),B.style.setProperty("margin-bottom","0.5rem"),B.style.setProperty("font-weight","500"),a(B,()=>e("banking.amountDebitColumn"),Q),Z.addEventListener("change",pe=>E("debit",pe.target.value)),a(oe,()=>e("banking.selectColumn")),a(Z,()=>L().map(pe=>(()=>{var ve=ac();return ve.value=pe,a(ve,pe),ve})()),null),re.style.setProperty("display","block"),re.style.setProperty("margin-bottom","0.5rem"),re.style.setProperty("font-weight","500"),a(re,()=>e("banking.creditColumn")),Y.addEventListener("change",pe=>E("credit",pe.target.value)),a(ce,()=>e("banking.selectColumn")),a(Y,()=>L().map(pe=>(()=>{var ve=ac();return ve.value=pe,a(ve,pe),ve})()),null),ae.style.setProperty("display","block"),ae.style.setProperty("margin-bottom","0.5rem"),ae.style.setProperty("font-weight","500"),a(ae,()=>e("banking.balanceColumn")),ye.addEventListener("change",pe=>E("balance",pe.target.value)),a(me,()=>e("banking.selectColumn")),a(ye,()=>L().map(pe=>(()=>{var ve=ac();return ve.value=pe,a(ve,pe),ve})()),null),a(w,(()=>{var pe=ke(()=>c().length>0);return()=>pe()&&(()=>{var ve=$N(),Ne=ve.firstChild,Ie=Ne.firstChild,Ce=Ie.firstChild,Ee=Ie.nextSibling;return p(ve,N),Ce.style.setProperty("background-color","var(--background-color)"),a(Ce,()=>L().slice(0,6).map(we=>(()=>{var Re=EN();return a(Re,we),ge(He=>p(Re,b,He)),Re})())),a(Ee,()=>c().slice(0,3).map(we=>(()=>{var Re=IN();return a(Re,()=>L().slice(0,6).map(He=>(()=>{var je=TN();return a(je,()=>we[He]),ge(Ve=>p(je,b,Ve)),je})())),Re})())),a(ve,(()=>{var we=ke(()=>c().length>3);return()=>we()&&(()=>{var Re=Bm();return Re.style.setProperty("padding","0.5rem"),Re.style.setProperty("text-align","center"),Re.style.setProperty("color","var(--text-muted)"),a(Re,()=>e("banking.andMoreRows").replace("{count}",(c().length-3).toString())),Re})()})(),null),ge(we=>p(Ne,x,we)),ve})()})(),null),ge(pe=>{var ve=S,Ne=S,Ie=S,Ce=S,Ee=S,we=S;return pe.e=p(J,ve,pe.e),pe.t=p(_,Ne,pe.t),pe.a=p(ne,Ie,pe.a),pe.o=p(Z,Ce,pe.o),pe.i=p(Y,Ee,pe.i),pe.n=p(ye,we,pe.n),pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),ge(()=>J.value=u().date),ge(()=>_.value=u().description),ge(()=>ne.value=u().reference),ge(()=>Z.value=u().debit),ge(()=>Y.value=u().credit),ge(()=>ye.value=u().balance),w})()),ke(()=>ke(()=>!!s())()&&(()=>{var w=Bm();return w.style.setProperty("padding","1rem"),w.style.setProperty("border-radius","var(--border-radius-sm)"),w.style.setProperty("margin-top","1rem"),a(w,()=>s().message),ge(v=>{var j=s().success?"#d4edda":"#f8d7da",z=s().success?"#155724":"#721c24",T=`1px solid ${s().success?"#c3e6cb":"#f5c6cb"}`;return j!==v.e&&((v.e=j)!=null?w.style.setProperty("background",j):w.style.removeProperty("background")),z!==v.t&&((v.t=z)!=null?w.style.setProperty("color",z):w.style.removeProperty("color")),T!==v.a&&((v.a=T)!=null?w.style.setProperty("border",T):w.style.removeProperty("border")),v},{e:void 0,t:void 0,a:void 0}),w})()),(()=>{var w=Bm();return p(w,K),a(w,A(ct,{variant:"secondary",onClick:()=>{P(),t.onClose()},get children(){return e("common.cancel")}}),null),a(w,(()=>{var v=ke(()=>c().length>0);return()=>v()&&A(ct,{variant:"outline",onClick:P,get children(){return e("common.reset")}})})(),null),a(w,(()=>{var v=ke(()=>c().length>0);return()=>v()&&A(ct,{variant:"primary",onClick:M,get disabled(){return i()||!u().date||!u().description},get children(){return ke(()=>!!i())()?e("banking.importing"):e("banking.importTransactions").replace("{count}",c().length.toString())}})})(),null),w})()]}})};Wt(["click"]);var p1=le("<span>"),ih=le("<div>"),m1=le("<div> "),NN=le("<div><div><h3></h3><div><button></button><button></button><button></button></div></div><div></div><div><div><h4></h4><div></div></div><div><h4></h4><div>"),LN=le("<div><div><div></div><div> • </div></div><div><div>"),Vm=le("<span>✓ "),RN=le("<span>(<!>)"),DN=le("<div><strong>:</strong> "),y1=le("<div><div><div></div><div> • </div></div><div>"),MN=le("<div><div>:</div><div></div><div>");const FN=t=>{const{t:e}=or(),[r,n]=Se([]),[i,o]=Se([]),[s,l]=Se(null),[c,d]=Se([]),[u,h]=Se("unreconciled");Un(()=>{const T=zn.getBankAccountById(t.bankAccountId);if(T){const R=zn.getBankStatementsByAccount(T.accountId).filter(X=>X.date>=t.selectedPeriod.start&&X.date<=t.selectedPeriod.end),J=zn.getEntryBookRecordsByAccount(T.accountId).filter(X=>X.date>=t.selectedPeriod.start&&X.date<=t.selectedPeriod.end);n(R),o(J)}});const g=()=>{const T=r();switch(u()){case"reconciled":return T.filter(R=>R.isReconciled);case"unreconciled":return T.filter(R=>!R.isReconciled);default:return T}},m=()=>{const T=i();switch(u()){case"reconciled":return T.filter(R=>R.isReconciled);case"unreconciled":return T.filter(R=>!R.isReconciled);default:return T}},S=T=>{if(l(T),T.isReconciled)d([]);else{const R=zn.findPotentialMatches(T.id);d(R)}},N=T=>{const R=s();if(R){zn.reconcileTransaction(R.id,T.id);const J=zn.getBankAccountById(t.bankAccountId);if(J){const X=zn.getBankStatementsByAccount(J.accountId).filter(se=>se.date>=t.selectedPeriod.start&&se.date<=t.selectedPeriod.end),H=zn.getEntryBookRecordsByAccount(J.accountId).filter(se=>se.date>=t.selectedPeriod.start&&se.date<=t.selectedPeriod.end);n(X),o(H)}l(null),d([])}},x=T=>{zn.unreconciledTransaction(T.id);const R=zn.getBankAccountById(t.bankAccountId);if(R){const J=zn.getBankStatementsByAccount(R.accountId).filter(H=>H.date>=t.selectedPeriod.start&&H.date<=t.selectedPeriod.end),X=zn.getEntryBookRecordsByAccount(R.accountId).filter(H=>H.date>=t.selectedPeriod.start&&H.date<=t.selectedPeriod.end);n(J),o(X)}},b={display:"grid","grid-template-columns":"1fr 1fr",gap:"2rem","margin-top":"2rem"},K={height:"600px","overflow-y":"auto"},te={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},F=T=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:T?"var(--primary-color)":"var(--surface-color)",color:T?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),V=(T,R)=>({display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem","margin-bottom":"0.5rem",background:T?"var(--primary-color)":R?"#e8f5e8":"var(--surface-color)",color:T?"white":"var(--text-primary)","border-radius":"var(--border-radius-sm)",border:`1px solid ${T?"var(--primary-color)":R?"#c3e6cb":"var(--border-color)"}`,cursor:"pointer",transition:"all 0.2s ease"}),W={flex:"1"},I={"font-weight":"500","margin-bottom":"0.25rem"},E={"font-size":"0.875rem",opacity:"0.8"},L=T=>({"font-weight":"600",color:T?"#4caf50":"#f44336"}),M={padding:"0.25rem 0.5rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","margin-left":"0.5rem"},P=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T),w=T=>new Date(T).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),v=T=>{if(!s())return null;const R=s();return(Math.abs(R.debitAmount-T.debitAmount)<.01||Math.abs(R.creditAmount-T.creditAmount)<.01)&&R.date===T.date?(()=>{var H=p1();return a(H,()=>e("banking.exactMatch")),ge(se=>p(H,{...M,background:"#d4edda",color:"#155724"},se)),H})():c().includes(T)?(()=>{var H=p1();return a(H,()=>e("banking.possibleMatch")),ge(se=>p(H,{...M,background:"#fff3cd",color:"#856404"},se)),H})():null},z=(()=>{const T=r(),R=i(),J=T.filter(H=>H.isReconciled).length,X=R.filter(H=>H.isReconciled).length;return{totalStatements:T.length,totalRecords:R.length,reconciledStatements:J,reconciledRecords:X,unreconciledStatements:T.length-J,unreconciledRecords:R.length-X}})();return(()=>{var T=NN(),R=T.firstChild,J=R.firstChild,X=J.nextSibling,H=X.firstChild,se=H.nextSibling,O=se.nextSibling,_=R.nextSibling,k=_.nextSibling,$=k.firstChild,G=$.firstChild,ne=G.nextSibling,U=$.nextSibling,D=U.firstChild,B=D.nextSibling;return p(R,te),J.style.setProperty("margin","0"),J.style.setProperty("font-size","1.25rem"),a(J,()=>e("banking.reconciliationComparison")),X.style.setProperty("display","flex"),X.style.setProperty("gap","0.5rem"),H.$$click=()=>h("all"),a(H,()=>e("common.all")),se.$$click=()=>h("unreconciled"),a(se,()=>e("banking.unreconciled")),O.$$click=()=>h("reconciled"),a(O,()=>e("banking.reconciled")),_.style.setProperty("display","grid"),_.style.setProperty("grid-template-columns","repeat(4, 1fr)"),_.style.setProperty("gap","1rem"),_.style.setProperty("margin-bottom","2rem"),a(_,A(Rt,{get title(){return e("banking.bankStatements")},get subtitle(){return e("banking.totalTransactions")},get children(){return[(()=>{var Q=ih();return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","var(--primary-color)"),a(Q,()=>z.totalStatements),Q})(),(()=>{var Q=m1(),Z=Q.firstChild;return Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),a(Q,()=>z.reconciledStatements,Z),a(Q,()=>e("banking.reconciled"),null),Q})()]}}),null),a(_,A(Rt,{get title(){return e("banking.entryBookRecords")},get subtitle(){return e("banking.totalEntries")},get children(){return[(()=>{var Q=ih();return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","var(--primary-color)"),a(Q,()=>z.totalRecords),Q})(),(()=>{var Q=m1(),Z=Q.firstChild;return Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),a(Q,()=>z.reconciledRecords,Z),a(Q,()=>e("banking.reconciled"),null),Q})()]}}),null),a(_,A(Rt,{get title(){return e("banking.unreconciledBank")},get subtitle(){return e("banking.needAttention")},get children(){var Q=ih();return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","#f44336"),a(Q,()=>z.unreconciledStatements),Q}}),null),a(_,A(Rt,{get title(){return e("banking.unreconciledBooks")},get subtitle(){return e("banking.needAttention")},get children(){var Q=ih();return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","#f44336"),a(Q,()=>z.unreconciledRecords),Q}}),null),p(k,b),G.style.setProperty("margin","0 0 1rem 0"),a(G,()=>e("banking.bankStatements")),a(ne,()=>g().map(Q=>(()=>{var Z=LN(),oe=Z.firstChild,de=oe.firstChild,re=de.nextSibling,Y=re.firstChild,ce=oe.nextSibling,ue=ce.firstChild;return Z.$$click=()=>S(Q),a(de,()=>Q.description),a(re,()=>w(Q.date),Y),a(re,()=>Q.reference,null),a(re,(()=>{var ae=ke(()=>!!Q.isReconciled);return()=>ae()&&(()=>{var ye=Vm();return ye.firstChild,ye.style.setProperty("color","#4caf50"),ye.style.setProperty("margin-left","0.5rem"),a(ye,()=>e("banking.reconciled"),null),ye})()})(),null),a(ue,()=>Q.debitAmount>0?"+":"-",null),a(ue,()=>P(Q.debitAmount||Q.creditAmount),null),a(ce,(()=>{var ae=ke(()=>!!Q.isReconciled);return()=>ae()&&A(ct,{variant:"outline",size:"sm",onClick:ye=>{ye.stopPropagation(),x(Q)},style:{"margin-top":"0.5rem"},get children(){return e("banking.unreconcile")}})})(),null),ge(ae=>{var ye=V(s()?.id===Q.id,Q.isReconciled),me=W,pe=I,ve=E,Ne=L(Q.debitAmount>0);return ae.e=p(Z,ye,ae.e),ae.t=p(oe,me,ae.t),ae.a=p(de,pe,ae.a),ae.o=p(re,ve,ae.o),ae.i=p(ue,Ne,ae.i),ae},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Z})())),D.style.setProperty("margin","0 0 1rem 0"),a(D,()=>e("banking.entryBookRecords"),null),a(D,(()=>{var Q=ke(()=>!!(s()&&!s().isReconciled));return()=>Q()&&(()=>{var Z=RN(),oe=Z.firstChild,de=oe.nextSibling;return de.nextSibling,Z.style.setProperty("font-weight","400"),Z.style.setProperty("color","var(--text-muted)"),Z.style.setProperty("margin-left","0.5rem"),a(Z,()=>e("banking.clickToReconcile"),de),Z})()})(),null),a(B,(()=>{var Q=ke(()=>!!(s()&&!s().isReconciled));return()=>Q()?[ke(()=>ke(()=>c().length>0)()&&(()=>{var Z=DN(),oe=Z.firstChild,de=oe.firstChild;return oe.nextSibling,Z.style.setProperty("margin-bottom","1rem"),Z.style.setProperty("padding","0.75rem"),Z.style.setProperty("background","#fff3cd"),Z.style.setProperty("border-radius","var(--border-radius-sm)"),a(oe,()=>e("banking.potentialMatchesFound"),de),a(Z,()=>e("banking.clickRecordToReconcile"),null),Z})()),ke(()=>m().map(Z=>(c().includes(Z),(()=>{var oe=y1(),de=oe.firstChild,re=de.firstChild,Y=re.nextSibling,ce=Y.firstChild,ue=de.nextSibling;return oe.$$click=()=>{Z.isReconciled||N(Z)},a(re,()=>Z.description,null),a(re,()=>v(Z),null),a(Y,()=>w(Z.date),ce),a(Y,()=>Z.reference,null),a(Y,(()=>{var ae=ke(()=>!!Z.isReconciled);return()=>ae()&&(()=>{var ye=Vm();return ye.firstChild,ye.style.setProperty("color","#4caf50"),ye.style.setProperty("margin-left","0.5rem"),a(ye,()=>e("banking.reconciled"),null),ye})()})(),null),a(ue,()=>Z.debitAmount>0?"+":"-",null),a(ue,()=>P(Z.debitAmount||Z.creditAmount),null),ge(ae=>{var ye={...V(!1,Z.isReconciled),opacity:Z.isReconciled?.6:1,cursor:Z.isReconciled?"not-allowed":"pointer"},me=W,pe=I,ve=E,Ne=L(Z.debitAmount>0);return ae.e=p(oe,ye,ae.e),ae.t=p(de,me,ae.t),ae.a=p(re,pe,ae.a),ae.o=p(Y,ve,ae.o),ae.i=p(ue,Ne,ae.i),ae},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),oe})())))]:m().map(Z=>(()=>{var oe=y1(),de=oe.firstChild,re=de.firstChild,Y=re.nextSibling,ce=Y.firstChild,ue=de.nextSibling;return a(re,()=>Z.description),a(Y,()=>w(Z.date),ce),a(Y,()=>Z.reference,null),a(Y,(()=>{var ae=ke(()=>!!Z.isReconciled);return()=>ae()&&(()=>{var ye=Vm();return ye.firstChild,ye.style.setProperty("color","#4caf50"),ye.style.setProperty("margin-left","0.5rem"),a(ye,()=>e("banking.reconciled"),null),ye})()})(),null),a(ue,()=>Z.debitAmount>0?"+":"-",null),a(ue,()=>P(Z.debitAmount||Z.creditAmount),null),ge(ae=>{var ye=V(!1,Z.isReconciled),me=W,pe=I,ve=E,Ne=L(Z.debitAmount>0);return ae.e=p(oe,ye,ae.e),ae.t=p(de,me,ae.t),ae.a=p(re,pe,ae.a),ae.o=p(Y,ve,ae.o),ae.i=p(ue,Ne,ae.i),ae},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),oe})())})()),a(T,(()=>{var Q=ke(()=>!!(s()&&!s().isReconciled));return()=>Q()&&(()=>{var Z=MN(),oe=Z.firstChild,de=oe.firstChild,re=oe.nextSibling,Y=re.nextSibling;return Z.style.setProperty("position","fixed"),Z.style.setProperty("bottom","2rem"),Z.style.setProperty("right","2rem"),Z.style.setProperty("background","var(--surface-color)"),Z.style.setProperty("padding","1rem"),Z.style.setProperty("border-radius","var(--border-radius)"),Z.style.setProperty("box-shadow","var(--shadow-lg)"),Z.style.setProperty("border","1px solid var(--border-color)"),Z.style.setProperty("max-width","300px"),oe.style.setProperty("font-weight","500"),oe.style.setProperty("margin-bottom","0.5rem"),a(oe,()=>e("banking.selected"),de),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("margin-bottom","0.5rem"),a(re,()=>s().description),Y.style.setProperty("font-weight","600"),Y.style.setProperty("color","var(--primary-color)"),a(Y,()=>P(s().debitAmount||s().creditAmount)),a(Z,A(ct,{variant:"secondary",size:"sm",onClick:()=>{l(null),d([])},style:{"margin-top":"0.5rem"},get children(){return e("banking.clearSelection")}}),null),Z})()})(),null),ge(Q=>{var Z=F(u()==="all"),oe=F(u()==="unreconciled"),de=F(u()==="reconciled"),re=K,Y=K;return Q.e=p(H,Z,Q.e),Q.t=p(se,oe,Q.t),Q.a=p(O,de,Q.a),Q.o=p(ne,re,Q.o),Q.i=p(B,Y,Q.i),Q},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),T})()};Wt(["click"]);var ON=le("<div><div><h2></h2><p></p></div><div>"),BN=le("<div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date>"),VN=le("<div><button></button><button>"),jN=le("<div><br>"),gd=le("<div>"),zN=le("<div><div></div><div> • </div><div>"),qN=le("<div>: "),UN=le("<div> <!> • <!> "),HN=le("<div>%"),GN=le("<div> of <!> transactions");const WN=()=>{const{t}=or(),[e,r]=Se(null),[n,i]=Se({start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[o,s]=Se(!1),[l,c]=Se("overview");Un(()=>{!e()&&zn.bankAccounts.length>0&&r(zn.bankAccounts[0])});const d={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},u={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},h={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},g=te=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:te?"var(--primary-color)":"var(--text-muted)","border-bottom":te?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),m={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},S=te=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(te),N=te=>new Date(te).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),x=()=>zn.bankAccounts.map(te=>({value:te.id,label:`${te.bankName} - ${te.accountNumber} (${te.accountType})`})),K=(()=>{if(!e())return null;const te=zn.getBankStatementsByAccount(e().accountId).filter(W=>W.date>=n().start&&W.date<=n().end),F=zn.getEntryBookRecordsByAccount(e().accountId).filter(W=>W.date>=n().start&&W.date<=n().end),V=te.filter(W=>W.isReconciled).length;return F.filter(W=>W.isReconciled).length,{totalBankTransactions:te.length,totalEntryBookRecords:F.length,reconciledTransactions:V,unreconciledTransactions:te.length-V,reconciliationRate:te.length>0?V/te.length*100:0}})();return A(oo,{get title(){return t("banking.title")},get children(){return[(()=>{var te=ON(),F=te.firstChild,V=F.firstChild,W=V.nextSibling,I=F.nextSibling;return p(te,d),V.style.setProperty("margin","0 0 0.5rem 0"),V.style.setProperty("font-size","1.5rem"),a(V,()=>t("banking.reconciliation")),W.style.setProperty("margin","0"),W.style.setProperty("color","var(--text-muted)"),a(W,()=>t("banking.compareStatements")),I.style.setProperty("display","flex"),I.style.setProperty("gap","1rem"),a(I,A(ct,{variant:"secondary",onClick:()=>s(!0),get disabled(){return!e()},get children(){return t("banking.importCSV")}}),null),a(I,A(ct,{variant:"primary",get children(){return t("banking.startNewReconciliation")}}),null),te})(),(()=>{var te=BN(),F=te.firstChild,V=F.firstChild,W=F.nextSibling,I=W.firstChild,E=I.nextSibling,L=W.nextSibling,M=L.firstChild,P=M.nextSibling;return p(te,u),F.style.setProperty("flex","1"),V.style.setProperty("display","block"),V.style.setProperty("margin-bottom","0.5rem"),V.style.setProperty("font-weight","500"),a(V,()=>t("banking.bankAccount")),a(F,A(en,{label:"",get value(){return e()?.id||""},onChange:w=>{const v=zn.getBankAccountById(w);r(v||null)},get options(){return x()}}),null),I.style.setProperty("display","block"),I.style.setProperty("margin-bottom","0.5rem"),I.style.setProperty("font-weight","500"),a(I,()=>t("entryBooks.startDate")),E.addEventListener("change",w=>i(v=>({...v,start:w.target.value}))),E.style.setProperty("padding","0.75rem"),E.style.setProperty("border","1px solid var(--border-color)"),E.style.setProperty("border-radius","var(--border-radius-sm)"),E.style.setProperty("font-family","inherit"),M.style.setProperty("display","block"),M.style.setProperty("margin-bottom","0.5rem"),M.style.setProperty("font-weight","500"),a(M,()=>t("entryBooks.endDate")),P.addEventListener("change",w=>i(v=>({...v,end:w.target.value}))),P.style.setProperty("padding","0.75rem"),P.style.setProperty("border","1px solid var(--border-color)"),P.style.setProperty("border-radius","var(--border-radius-sm)"),P.style.setProperty("font-family","inherit"),ge(()=>E.value=n().start),ge(()=>P.value=n().end),te})(),(()=>{var te=VN(),F=te.firstChild,V=F.nextSibling;return p(te,h),F.$$click=()=>c("overview"),a(F,()=>t("common.overview")),V.$$click=()=>c("reconciliation"),a(V,()=>t("banking.reconciliation")),ge(W=>{var I=g(l()==="overview"),E=g(l()==="reconciliation");return W.e=p(F,I,W.e),W.t=p(V,E,W.t),W},{e:void 0,t:void 0}),te})(),ke(()=>ke(()=>l()==="overview")()&&(()=>{var te=gd();return a(te,(()=>{var F=ke(()=>!!e());return()=>F()&&(()=>{var V=gd();return p(V,m),a(V,A(Rt,{get title(){return t("banking.bankAccountInfo")},get subtitle(){return t("banking.currentAccountDetails")},get children(){return[(()=>{var W=zN(),I=W.firstChild,E=I.nextSibling,L=E.firstChild,M=E.nextSibling;return W.style.setProperty("margin-bottom","1rem"),I.style.setProperty("font-weight","600"),I.style.setProperty("margin-bottom","0.5rem"),a(I,()=>e().bankName),E.style.setProperty("color","var(--text-muted)"),E.style.setProperty("margin-bottom","0.5rem"),a(E,()=>e().accountNumber,L),a(E,()=>e().accountType,null),M.style.setProperty("font-size","1.25rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","var(--primary-color)"),a(M,()=>S(e().currentBalance)),W})(),ke(()=>ke(()=>!!e().lastReconciledDate)()&&(()=>{var W=qN(),I=W.firstChild;return W.style.setProperty("font-size","0.875rem"),W.style.setProperty("color","var(--text-muted)"),a(W,()=>t("banking.lastReconciled"),I),a(W,()=>N(e().lastReconciledDate),null),W})())]}}),null),a(V,K&&[A(Rt,{get title(){return t("banking.bankTransactions")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var W=gd();return W.style.setProperty("font-size","1.5rem"),W.style.setProperty("font-weight","600"),W.style.setProperty("color","var(--primary-color)"),W.style.setProperty("margin-bottom","0.5rem"),a(W,()=>K.totalBankTransactions),W})(),(()=>{var W=UN(),I=W.firstChild,E=I.nextSibling,L=E.nextSibling,M=L.nextSibling;return M.nextSibling,W.style.setProperty("font-size","0.875rem"),W.style.setProperty("color","var(--text-muted)"),a(W,()=>K.reconciledTransactions,I),a(W,()=>t("banking.reconciled"),E),a(W,()=>K.unreconciledTransactions,M),a(W,()=>t("banking.pending"),null),W})()]}}),A(Rt,{get title(){return t("entryBooks.entryBookRecords")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var W=gd();return W.style.setProperty("font-size","1.5rem"),W.style.setProperty("font-weight","600"),W.style.setProperty("color","var(--primary-color)"),W.style.setProperty("margin-bottom","0.5rem"),a(W,()=>K.totalEntryBookRecords),W})(),(()=>{var W=gd();return W.style.setProperty("font-size","0.875rem"),W.style.setProperty("color","var(--text-muted)"),a(W,()=>t("banking.bookEntriesForComparison")),W})()]}}),A(Rt,{get title(){return t("banking.reconciliationRate")},get subtitle(){return t("banking.completionStatus")},get children(){return[(()=>{var W=HN(),I=W.firstChild;return W.style.setProperty("font-size","1.5rem"),W.style.setProperty("font-weight","600"),W.style.setProperty("margin-bottom","0.5rem"),a(W,()=>Math.round(K.reconciliationRate),I),ge(E=>(E=K.reconciliationRate>80?"#4caf50":K.reconciliationRate>50?"#ff9800":"#f44336")!=null?W.style.setProperty("color",E):W.style.removeProperty("color")),W})(),(()=>{var W=GN(),I=W.firstChild,E=I.nextSibling;return E.nextSibling,W.style.setProperty("font-size","0.875rem"),W.style.setProperty("color","var(--text-muted)"),a(W,()=>K.reconciledTransactions,I),a(W,()=>K.totalBankTransactions,E),W})()]}})],null),V})()})(),null),a(te,A(Rt,{get title(){return t("banking.recentReconciliationSessions")},get subtitle(){return t("banking.latestActivity")},get children(){var F=jN(),V=F.firstChild;return F.style.setProperty("text-align","center"),F.style.setProperty("color","var(--text-muted)"),F.style.setProperty("padding","2rem"),a(F,()=>t("banking.noRecentSessions"),V),a(F,A(ct,{variant:"primary",style:{"margin-top":"1rem"},onClick:()=>c("reconciliation"),get children(){return t("banking.startFirstReconciliation")}}),null),F}}),null),te})()),ke(()=>ke(()=>!!(l()==="reconciliation"&&e()))()&&A(FN,{get bankAccountId(){return e().id},get selectedPeriod(){return n()}})),A(kN,{get isOpen(){return o()},onClose:()=>s(!1),get bankAccount(){return e()}})]}})};Wt(["click"]);Wt(["input","click"]);var YN=le("<h2>Upload Bank Statement CSV"),KN=le("<input type=file accept=.csv>"),QN=le("<h3>Filters"),JN=le('<div><input type=text placeholder="Search transactions..."><input type=date placeholder="Start Date"><input type=date placeholder="End Date"><button>Download Detailed Report'),XN=le("<div><button>Summary</button><button>Deposits</button><button>Payments</button><button>Timeline"),ZN=le("<h3>Total Deposits"),oh=le("<p>"),f1=le("<p> transactions"),e7=le("<h3>Total Payments"),t7=le("<h3>Net Cash Flow"),r7=le("<h3>Check Payments"),n7=le("<p> checks"),vd=le("<div>"),i7=le("<h3>Accounts & Payment Methods Used"),o7=le("<h3>Monthly Cash Flow Trend"),s7=le("<div><table><thead><tr><th>Month</th><th>Deposits</th><th>Payments</th><th>Net</th></tr></thead><tbody>"),a7=le("<h2>Deposits by Type"),l7=le("<h2>Top Depositors"),c7=le("<div><table><thead><tr><th>Depositor</th><th>Total Amount</th><th>Count</th><th>Actions</th></tr></thead><tbody>"),d7=le("<h2>Payments by Category"),u7=le("<h2>Top Payees"),h7=le("<div><table><thead><tr><th>Payee</th><th>Category</th><th>Total Amount</th><th>Count</th></tr></thead><tbody>"),p7=le("<h2>Transaction Timeline"),m7=le("<div><h1>Detailed Bank Statement Analyzer"),y7=le("<span>"),f7=le("<tr><td></td><td></td><td></td><td>"),g1=le("<div><h4></h4><p></p><p> transactions"),g7=le("<tr><td></td><td></td><td></td><td><details><summary>View</summary><div>"),v7=le("<div> - "),b7=le("<tr><td></td><td><span></span></td><td></td><td>"),P7=le("<div><div><div></div><div> • </div></div><div><div>");const _7=()=>{const[t,e]=Se(""),[r,n]=Se("summary"),[i,o]=Se(""),[s,l]=Se({start:"",end:""}),[c,d]=Bc({list:[]}),u={Utilities:["AT&T","METRO BY T-MOBILE","COMCAST","STREAM ENERGY","NETFLIX","SPECTRUM"],checks:["CHECK"],JPM:["JPM","POVBR"],Transportation:["DRIVE AWAY","TRANPORT","QUICKQUACK","EXXON","SHELL","CHEVRON","UBER","LYFT","U-HAUL","UHAL","LOVE'S"],Lodging:["HOLIDAY INN","MARRIOTT","HILTON","AIRBNB","HOTEL","MOTEL"],"Food & Dining":["GOLDEN CORRAL","MOCTEZUMA","CHINA STAR","RESTAURANT","CAFE","STARBUCKS","BUFFET","GRILL","MARKET","SEAFOOD"],Shopping:["BURLINGTON","WALMART","TARGET","AMAZON","ROSS","KROGER","PUBLIC","AMZN","AMZ"],Financial:["AMERICANFIRSTFIN","LOAN","CREDIT"],Insurance:["INSURANCE","GEICO","STATE FARM"],Rent:["SHAFAII INVESTME"],Medical:["PHARMACY","CVS","WALGREENS","HOSPITAL","CLINIC"],Entertainment:["CINEMA","THEATER","CONCERT"],"Other Services":["BARBER","SALON","SPA","GYM"],Return:["RETURN ITEM "]},h=F=>{const V=F.toUpperCase();for(const[W,I]of Object.entries(u))for(const E of I)if(V.includes(E.toUpperCase()))return W;return"Other"},g=F=>{const V=F.match(/Zelle payment from ([^0-9]+)/i);if(V)return V[1].trim().replace(/[A-Z0-9]{10,}$/,"").trim();if(F.includes("CHECK"))return"Check Payment";const W=F.match(/^([^0-9]+)/);return W?W[1].trim():F.substring(0,30)},m=F=>{const V=F.trim().split(`
`),W=[];console.log(V);for(let I=1;I<V.length;I++){const E=V[I].split(",");if(console.log(E),E.length>=3){const L=parseFloat(E[2]);let M={postingDate:E[0],description:E[1],amount:L};W.push(M)}}return console.log({transactions:W}),d("list",W),W};Nt(()=>t()?m(t()):[]);const S=Nt(()=>{let F=c?.list;if((s().start||s().end)&&(F=F.filter(V=>{const W=new Date(V.postingDate),I=s().start?new Date(s().start):new Date("2024-01-01"),E=s().end?new Date(s().end):new Date("2024-12-31");return W>=I&&W<=E})),i()){const V=i().toLowerCase();F=F.filter(W=>W.description.toLowerCase().includes(V)||Math.abs(W.amount).toString().includes(V))}return F}),N=Nt(()=>{const F={deposits:{total:0,count:0,byType:new Map,byPayee:new Map},payments:{total:0,count:0,byType:new Map,byPayee:new Map},checks:{total:0,count:0,transactions:[]},transfers:{total:0,count:0,transactions:[]},dailyBalances:new Map,accountsAffected:new Set};return S().forEach(V=>{const W=g(V.description);if(console.log({transaction:V}),F.dailyBalances.set(V.postingDate,V.amount),(V.description.includes("ZELLE")||V.description.includes("QUICKPAY"))&&F.accountsAffected.add("Zelle Account"),V.description.includes("ACH")&&F.accountsAffected.add("ACH Network"),V?.description.includes("DEBIT_CARD")&&F.accountsAffected.add("Debit Card"),V?.description.includes("CHECK")&&F.accountsAffected.add("Checking Account"),V?.description.includes("TRANSFER")&&F.accountsAffected.add("Savings Account"),V.amount>0){F.deposits.total+=V.amount,F.deposits.count++,F.deposits.byType.has(V.description)||F.deposits.byType.set(V.description,{total:0,count:0,transactions:[]});const I=F.deposits.byType.get(V.description);I.total+=V.amount,I.count++,I.transactions.push(V),F.deposits.byPayee.has(W)||F.deposits.byPayee.set(W,{name:W,totalAmount:0,transactionCount:0,transactions:[]});const E=F.deposits.byPayee.get(W);E.totalAmount+=V.amount,E.transactionCount++,E.transactions.push(V)}if(V.amount<0){F.payments.total+=Math.abs(V.amount),F.payments.count++,F.payments.byType.has(V.description)||F.payments.byType.set(V.description,{total:0,count:0,transactions:[]});const I=F.payments.byType.get(V.description);I.total+=Math.abs(V.amount),I.count++,I.transactions.push(V);const E=h(V.description);F.payments.byPayee.has(W)||F.payments.byPayee.set(W,{name:W,totalAmount:0,transactionCount:0,transactions:[],category:E});const L=F.payments.byPayee.get(W);L.totalAmount+=Math.abs(V.amount),L.transactionCount++,L.transactions.push(V)}(V.type==="CHECK_PAID"||V.checkNumber)&&(F.checks.total+=Math.abs(V.amount),F.checks.count++,F.checks.transactions.push(V)),(V.description.includes("TRANSFER")||V.description==="ACCT_XFER")&&(F.transfers.total+=Math.abs(V.amount),F.transfers.count++,F.transfers.transactions.push(V))}),console.log(F),F}),x=Nt(()=>{const F=new Map;return S().forEach(V=>{const W=V.postingDate.substring(0,7);F.has(W)||F.set(W,{deposits:0,payments:0,net:0});const I=F.get(W);V.amount>0?I.deposits+=V.amount:I.payments+=Math.abs(V.amount),I.net=I.deposits-I.payments}),Array.from(F.entries()).sort((V,W)=>V[0].localeCompare(W[0]))}),b=F=>{const W=F.target.files?.[0];if(W){const I=new FileReader;I.onload=E=>{console.log(E.target?.result),m(E.target?.result)},I.readAsText(W)}},K=()=>{const F=N();let V=`# DETAILED BANK STATEMENT ANALYSIS
`;V+=`Generated: ${new Date().toLocaleDateString()}

`,V+=`## EXECUTIVE SUMMARY

`,V+=`- **Total Deposits:** $${F.deposits.total.toFixed(2)} (${F.deposits.count} transactions)
`,V+=`- **Total Payments:** $${F.payments.total.toFixed(2)} (${F.payments.count} transactions)
`,V+=`- **Net Cash Flow:** $${(F.deposits.total-F.payments.total).toFixed(2)}
`,V+=`- **Check Payments:** $${F.checks.total.toFixed(2)} (${F.checks.count} checks)
`,V+=`- **Transfers:** $${F.transfers.total.toFixed(2)} (${F.transfers.count} transfers)

`,V+=`## ACCOUNTS AFFECTED

`,F.accountsAffected.forEach(w=>{V+=`- ${w}
`}),V+=`
`,V+=`## DEPOSITS DETAIL

`,V+=`### By Type
`,F.deposits.byType.forEach((w,v)=>{V+=`- **${v}**: $${w.total.toFixed(2)} (${w.count} transactions)
`}),V+=`
### Top Depositors
`,Array.from(F.deposits.byPayee.entries()).sort((w,v)=>v[1].totalAmount-w[1].totalAmount).slice(0,20).forEach(([w,v])=>{V+=`- **${w}**: $${v.totalAmount.toFixed(2)} (${v.transactionCount} transactions)
`}),V+=`
## PAYMENTS DETAIL

`,V+=`### By Type
`,F.payments.byType.forEach((w,v)=>{V+=`- **${v}**: $${w.total.toFixed(2)} (${w.count} transactions)
`}),V+=`
### By Category
`;const I=new Map;F.payments.byPayee.forEach(w=>{const v=w.category||"Other";I.set(v,(I.get(v)||0)+w.totalAmount)}),Array.from(I.entries()).sort((w,v)=>v[1]-w[1]).forEach(([w,v])=>{V+=`- **${w}**: $${v.toFixed(2)}
`}),V+=`
### Top Payees
`,Array.from(F.payments.byPayee.entries()).sort((w,v)=>v[1].totalAmount-w[1].totalAmount).slice(0,20).forEach(([w,v])=>{V+=`- **${w}** (${v.category}): $${v.totalAmount.toFixed(2)} (${v.transactionCount} transactions)
`}),V+=`
## MONTHLY CASH FLOW TREND

`,x().forEach(([w,v])=>{V+=`- **${w}**: Deposits: $${v.deposits.toFixed(2)} | Payments: $${v.payments.toFixed(2)} | Net: $${v.net.toFixed(2)}
`}),F.checks.transactions.length>0&&(V+=`
## CHECK PAYMENTS DETAIL

`,F.checks.transactions.forEach(w=>{V+=`- Check #${w.checkNumber||"N/A"} - ${w.postingDate} - $${Math.abs(w.amount).toFixed(2)}
`}));const L=new Blob([V],{type:"text/markdown"}),M=URL.createObjectURL(L),P=document.createElement("a");P.href=M,P.download=`detailed_bank_analysis_${new Date().toISOString().split("T")[0]}.md`,P.click(),URL.revokeObjectURL(M)},te=F=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(F);return(()=>{var F=m7(),V=F.firstChild;return F.style.setProperty("padding","2rem"),V.style.setProperty("margin-bottom","2rem"),a(F,A(Rt,{style:{"margin-bottom":"2rem"},get children(){return[YN(),(()=>{var W=KN();return W.addEventListener("change",b),W.style.setProperty("margin-top","1rem"),W})()]}}),null),a(F,A(Me,{get when(){return c?.list},get children(){return[A(Rt,{style:{"margin-bottom":"2rem"},get children(){return[QN(),(()=>{var W=JN(),I=W.firstChild,E=I.nextSibling,L=E.nextSibling,M=L.nextSibling;return W.style.setProperty("display","flex"),W.style.setProperty("gap","1rem"),W.style.setProperty("margin-top","1rem"),W.style.setProperty("flex-wrap","wrap"),I.$$input=P=>o(P.currentTarget.value),I.style.setProperty("flex","1"),I.style.setProperty("min-width","200px"),I.style.setProperty("padding","0.5rem"),E.$$input=P=>l({...s(),start:P.currentTarget.value}),L.$$input=P=>l({...s(),end:P.currentTarget.value}),M.$$click=K,M.style.setProperty("padding","0.5rem 1rem"),M.style.setProperty("background","var(--primary-color)"),M.style.setProperty("color","white"),M.style.setProperty("border","none"),M.style.setProperty("border-radius","var(--border-radius-sm)"),M.style.setProperty("cursor","pointer"),ge(()=>I.value=i()),ge(()=>E.value=s().start),ge(()=>L.value=s().end),W})()]}}),(()=>{var W=XN(),I=W.firstChild,E=I.nextSibling,L=E.nextSibling,M=L.nextSibling;return W.style.setProperty("display","flex"),W.style.setProperty("gap","1rem"),W.style.setProperty("margin-bottom","2rem"),I.$$click=()=>n("summary"),I.style.setProperty("padding","0.5rem 1rem"),I.style.setProperty("border","none"),I.style.setProperty("border-radius","var(--border-radius-sm)"),I.style.setProperty("cursor","pointer"),E.$$click=()=>n("deposits"),E.style.setProperty("padding","0.5rem 1rem"),E.style.setProperty("border","none"),E.style.setProperty("border-radius","var(--border-radius-sm)"),E.style.setProperty("cursor","pointer"),L.$$click=()=>n("payments"),L.style.setProperty("padding","0.5rem 1rem"),L.style.setProperty("border","none"),L.style.setProperty("border-radius","var(--border-radius-sm)"),L.style.setProperty("cursor","pointer"),M.$$click=()=>n("timeline"),M.style.setProperty("padding","0.5rem 1rem"),M.style.setProperty("border","none"),M.style.setProperty("border-radius","var(--border-radius-sm)"),M.style.setProperty("cursor","pointer"),ge(P=>{var w=r()==="summary"?"var(--primary-color)":"#e9ecef",v=r()==="summary"?"white":"black",j=r()==="deposits"?"var(--primary-color)":"#e9ecef",z=r()==="deposits"?"white":"black",T=r()==="payments"?"var(--primary-color)":"#e9ecef",R=r()==="payments"?"white":"black",J=r()==="timeline"?"var(--primary-color)":"#e9ecef",X=r()==="timeline"?"white":"black";return w!==P.e&&((P.e=w)!=null?I.style.setProperty("background",w):I.style.removeProperty("background")),v!==P.t&&((P.t=v)!=null?I.style.setProperty("color",v):I.style.removeProperty("color")),j!==P.a&&((P.a=j)!=null?E.style.setProperty("background",j):E.style.removeProperty("background")),z!==P.o&&((P.o=z)!=null?E.style.setProperty("color",z):E.style.removeProperty("color")),T!==P.i&&((P.i=T)!=null?L.style.setProperty("background",T):L.style.removeProperty("background")),R!==P.n&&((P.n=R)!=null?L.style.setProperty("color",R):L.style.removeProperty("color")),J!==P.s&&((P.s=J)!=null?M.style.setProperty("background",J):M.style.removeProperty("background")),X!==P.h&&((P.h=X)!=null?M.style.setProperty("color",X):M.style.removeProperty("color")),P},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),W})(),A(Me,{get when(){return r()==="summary"},get children(){return[(()=>{var W=vd();return W.style.setProperty("display","grid"),W.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),W.style.setProperty("gap","1rem"),W.style.setProperty("margin-bottom","2rem"),a(W,A(Rt,{get children(){return[ZN(),(()=>{var I=oh();return I.style.setProperty("font-size","2rem"),I.style.setProperty("font-weight","bold"),I.style.setProperty("color","#22c55e"),a(I,()=>te(N().deposits.total)),I})(),(()=>{var I=f1(),E=I.firstChild;return I.style.setProperty("color","#6c757d"),a(I,()=>N().deposits.count,E),I})()]}}),null),a(W,A(Rt,{get children(){return[e7(),(()=>{var I=oh();return I.style.setProperty("font-size","2rem"),I.style.setProperty("font-weight","bold"),I.style.setProperty("color","#ef4444"),a(I,()=>te(N().payments.total)),I})(),(()=>{var I=f1(),E=I.firstChild;return I.style.setProperty("color","#6c757d"),a(I,()=>N().payments.count,E),I})()]}}),null),a(W,A(Rt,{get children(){return[t7(),(()=>{var I=oh();return I.style.setProperty("font-size","2rem"),I.style.setProperty("font-weight","bold"),a(I,()=>te(N().deposits.total-N().payments.total)),ge(E=>(E=N().deposits.total-N().payments.total>=0?"#22c55e":"#ef4444")!=null?I.style.setProperty("color",E):I.style.removeProperty("color")),I})()]}}),null),a(W,A(Rt,{get children(){return[r7(),(()=>{var I=oh();return I.style.setProperty("font-size","2rem"),I.style.setProperty("font-weight","bold"),I.style.setProperty("color","#3b82f6"),a(I,()=>te(N().checks.total)),I})(),(()=>{var I=n7(),E=I.firstChild;return I.style.setProperty("color","#6c757d"),a(I,()=>N().checks.count,E),I})()]}}),null),W})(),A(Rt,{style:{"margin-bottom":"2rem"},get children(){return[i7(),(()=>{var W=vd();return W.style.setProperty("display","flex"),W.style.setProperty("flex-wrap","wrap"),W.style.setProperty("gap","0.5rem"),W.style.setProperty("margin-top","1rem"),a(W,A(vt,{get each(){return Array.from(N().accountsAffected)},children:I=>(()=>{var E=y7();return E.style.setProperty("padding","0.25rem 0.75rem"),E.style.setProperty("background","#e9ecef"),E.style.setProperty("border-radius","9999px"),E.style.setProperty("font-size","0.875rem"),a(E,I),E})()})),W})()]}}),A(Rt,{get children(){return[o7(),(()=>{var W=s7(),I=W.firstChild,E=I.firstChild,L=E.firstChild,M=L.firstChild,P=M.nextSibling,w=P.nextSibling,v=w.nextSibling,j=E.nextSibling;return W.style.setProperty("overflow-x","auto"),I.style.setProperty("width","100%"),I.style.setProperty("border-collapse","collapse"),I.style.setProperty("margin-top","1rem"),L.style.setProperty("border-bottom","2px solid #dee2e6"),M.style.setProperty("padding","0.75rem"),M.style.setProperty("text-align","left"),P.style.setProperty("padding","0.75rem"),P.style.setProperty("text-align","right"),w.style.setProperty("padding","0.75rem"),w.style.setProperty("text-align","right"),v.style.setProperty("padding","0.75rem"),v.style.setProperty("text-align","right"),a(j,A(vt,{get each(){return x()},children:([z,T])=>(()=>{var R=f7(),J=R.firstChild,X=J.nextSibling,H=X.nextSibling,se=H.nextSibling;return R.style.setProperty("border-bottom","1px solid #dee2e6"),J.style.setProperty("padding","0.75rem"),a(J,z),X.style.setProperty("padding","0.75rem"),X.style.setProperty("text-align","right"),X.style.setProperty("color","#22c55e"),a(X,()=>te(isNaN(T.deposits)?0:T.deposits)),H.style.setProperty("padding","0.75rem"),H.style.setProperty("text-align","right"),H.style.setProperty("color","#ef4444"),a(H,()=>te(isNaN(T.payments)?0:T.payments)),se.style.setProperty("padding","0.75rem"),se.style.setProperty("text-align","right"),se.style.setProperty("font-weight","bold"),a(se,()=>te(T.net)),ge(O=>(O=T.net>=0?"#22c55e":"#ef4444")!=null?se.style.setProperty("color",O):se.style.removeProperty("color")),R})()})),W})()]}})]}}),A(Me,{get when(){return r()==="deposits"},get children(){return[A(Rt,{style:{"margin-bottom":"2rem"},get children(){return[a7(),(()=>{var W=vd();return W.style.setProperty("display","grid"),W.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(300px, 1fr))"),W.style.setProperty("gap","1rem"),W.style.setProperty("margin-top","1rem"),a(W,A(vt,{get each(){return Array.from(N().deposits.byType.entries())},children:([I,E])=>(()=>{var L=g1(),M=L.firstChild,P=M.nextSibling,w=P.nextSibling,v=w.firstChild;return L.style.setProperty("padding","1rem"),L.style.setProperty("background","#f8f9fa"),L.style.setProperty("border-radius","var(--border-radius-sm)"),L.style.setProperty("border","1px solid #e9ecef"),a(M,I),P.style.setProperty("font-size","1.5rem"),P.style.setProperty("font-weight","bold"),P.style.setProperty("color","#22c55e"),a(P,()=>te(E.total)),w.style.setProperty("color","#6c757d"),a(w,()=>E.count,v),L})()})),W})()]}}),A(Rt,{get children(){return[l7(),(()=>{var W=c7(),I=W.firstChild,E=I.firstChild,L=E.firstChild,M=L.firstChild,P=M.nextSibling,w=P.nextSibling,v=w.nextSibling,j=E.nextSibling;return W.style.setProperty("overflow-x","auto"),I.style.setProperty("width","100%"),I.style.setProperty("border-collapse","collapse"),I.style.setProperty("margin-top","1rem"),L.style.setProperty("border-bottom","2px solid #dee2e6"),M.style.setProperty("padding","0.75rem"),M.style.setProperty("text-align","left"),P.style.setProperty("padding","0.75rem"),P.style.setProperty("text-align","right"),w.style.setProperty("padding","0.75rem"),w.style.setProperty("text-align","center"),v.style.setProperty("padding","0.75rem"),v.style.setProperty("text-align","center"),a(j,A(vt,{get each(){return Array.from(N().deposits.byPayee.entries()).sort((z,T)=>T[1].totalAmount-z[1].totalAmount).slice(0,20)},children:([z,T])=>(()=>{var R=g7(),J=R.firstChild,X=J.nextSibling,H=X.nextSibling,se=H.nextSibling,O=se.firstChild,_=O.firstChild,k=_.nextSibling;return R.style.setProperty("border-bottom","1px solid #dee2e6"),J.style.setProperty("padding","0.75rem"),a(J,z),X.style.setProperty("padding","0.75rem"),X.style.setProperty("text-align","right"),X.style.setProperty("color","#22c55e"),X.style.setProperty("font-weight","bold"),a(X,()=>te(T.totalAmount)),H.style.setProperty("padding","0.75rem"),H.style.setProperty("text-align","center"),a(H,()=>T.transactionCount),se.style.setProperty("padding","0.75rem"),se.style.setProperty("text-align","center"),_.style.setProperty("cursor","pointer"),k.style.setProperty("margin-top","0.5rem"),k.style.setProperty("font-size","0.875rem"),a(k,A(vt,{get each(){return T.transactions.slice(0,5)},children:$=>(()=>{var G=v7(),ne=G.firstChild;return G.style.setProperty("padding","0.25rem"),a(G,()=>$.postingDate,ne),a(G,()=>te($.amount),null),G})()})),R})()})),W})()]}})]}}),A(Me,{get when(){return r()==="payments"},get children(){return[A(Rt,{style:{"margin-bottom":"2rem"},get children(){return[d7(),(()=>{var W=vd();return W.style.setProperty("display","grid"),W.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),W.style.setProperty("gap","1rem"),W.style.setProperty("margin-top","1rem"),a(W,()=>{const I=new Map;return N().payments.byPayee.forEach(E=>{const L=E.category||"Other";I.has(L)||I.set(L,{total:0,count:0});const M=I.get(L);M.total+=E.totalAmount,M.count+=E.transactionCount}),Array.from(I.entries()).sort((E,L)=>L[1].total-E[1].total).map(([E,L])=>(()=>{var M=g1(),P=M.firstChild,w=P.nextSibling,v=w.nextSibling,j=v.firstChild;return M.style.setProperty("padding","1rem"),M.style.setProperty("background","#f8f9fa"),M.style.setProperty("border-radius","var(--border-radius-sm)"),M.style.setProperty("border","1px solid #e9ecef"),a(P,E),w.style.setProperty("font-size","1.5rem"),w.style.setProperty("font-weight","bold"),w.style.setProperty("color","#ef4444"),a(w,()=>te(L.total)),v.style.setProperty("color","#6c757d"),a(v,()=>L.count,j),M})())}),W})()]}}),A(Rt,{get children(){return[u7(),(()=>{var W=h7(),I=W.firstChild,E=I.firstChild,L=E.firstChild,M=L.firstChild,P=M.nextSibling,w=P.nextSibling,v=w.nextSibling,j=E.nextSibling;return W.style.setProperty("overflow-x","auto"),I.style.setProperty("width","100%"),I.style.setProperty("border-collapse","collapse"),I.style.setProperty("margin-top","1rem"),L.style.setProperty("border-bottom","2px solid #dee2e6"),M.style.setProperty("padding","0.75rem"),M.style.setProperty("text-align","left"),P.style.setProperty("padding","0.75rem"),P.style.setProperty("text-align","left"),w.style.setProperty("padding","0.75rem"),w.style.setProperty("text-align","right"),v.style.setProperty("padding","0.75rem"),v.style.setProperty("text-align","center"),a(j,A(vt,{get each(){return Array.from(N().payments.byPayee.entries()).sort((z,T)=>T[1].totalAmount-z[1].totalAmount).slice(0,130)},children:([z,T])=>(()=>{var R=b7(),J=R.firstChild,X=J.nextSibling,H=X.firstChild,se=X.nextSibling,O=se.nextSibling;return R.style.setProperty("border-bottom","1px solid #dee2e6"),J.style.setProperty("padding","0.75rem"),a(J,z),X.style.setProperty("padding","0.75rem"),H.style.setProperty("padding","0.25rem 0.5rem"),H.style.setProperty("background","#e9ecef"),H.style.setProperty("border-radius","4px"),H.style.setProperty("font-size","0.875rem"),a(H,()=>T.category),se.style.setProperty("padding","0.75rem"),se.style.setProperty("text-align","right"),se.style.setProperty("color","#ef4444"),se.style.setProperty("font-weight","bold"),a(se,()=>te(T.totalAmount)),O.style.setProperty("padding","0.75rem"),O.style.setProperty("text-align","center"),a(O,()=>T.transactionCount),R})()})),W})()]}})]}}),A(Me,{get when(){return r()==="timeline"},get children(){return A(Rt,{get children(){return[p7(),(()=>{var W=vd();return W.style.setProperty("max-height","600px"),W.style.setProperty("overflow-y","auto"),W.style.setProperty("margin-top","1rem"),a(W,A(vt,{get each(){return S().slice(0,100)},children:I=>(()=>{var E=P7(),L=E.firstChild,M=L.firstChild,P=M.nextSibling,w=P.firstChild,v=L.nextSibling,j=v.firstChild;return E.style.setProperty("padding","1rem"),E.style.setProperty("border-bottom","1px solid #e9ecef"),E.style.setProperty("display","flex"),E.style.setProperty("justify-content","space-between"),E.style.setProperty("align-items","center"),L.style.setProperty("flex","1"),M.style.setProperty("font-weight","bold"),a(M,()=>I.description),P.style.setProperty("font-size","0.875rem"),P.style.setProperty("color","#6c757d"),a(P,()=>I.postingDate,w),a(P,()=>I.type,null),a(P,()=>I.checkNumber&&` • Check #${I.checkNumber}`,null),v.style.setProperty("text-align","right"),j.style.setProperty("font-weight","bold"),j.style.setProperty("font-size","1.1rem"),a(j,()=>te(Math.abs(I.amount)),null),a(j,()=>I.amount>=0?" ↓":" ↑",null),ge(z=>(z=I.amount>=0?"#22c55e":"#ef4444")!=null?j.style.setProperty("color",z):j.style.removeProperty("color")),E})()})),W})()]}})}})]}}),null),F})()};Wt(["input","click"]);var S7=le("<div><div></div><div>"),jm=le("<div>"),w7=le("<div> • <!> • <!> "),x7=le("<div><div><div></div><div></div></div><div><div></div><div>"),C7=le("<div><div>:"),A7=le("<div>⚠️ <!>: <!> <!>, <!> "),$7=le("<div><div><div></div><div></div></div><div>"),v1=le("<div> "),E7=le("<div>✓ ");const I7=t=>{const{t:e}=or(),r={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},n={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},i={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},o={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"0.5rem"},s={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"1rem"},l={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},c={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},d={"max-height":"100px","overflow-y":"auto","border-top":"1px solid var(--border-color)","padding-top":"1rem"},u={display:"flex","justify-content":"space-between","align-items":"center","font-size":"0.875rem","margin-bottom":"0.5rem"},h={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},g=b=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[b],m=b=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(b),S=b=>new Date(b).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),N=g(t.entry.status),x=Math.abs(t.entry.totalDebit-t.entry.totalCredit)<.01;return A(Rt,{get children(){return[(()=>{var b=S7(),K=b.firstChild,te=K.nextSibling;return p(b,r),p(K,n),a(K,()=>t.entry.entryNumber),a(te,()=>e(`journal.${t.entry.status}`,t.entry.status)),ge(F=>p(te,{...i,background:N.bg,color:N.color},F)),b})(),(()=>{var b=jm();return p(b,o),a(b,()=>t.entry.description),b})(),(()=>{var b=w7(),K=b.firstChild,te=K.nextSibling,F=te.nextSibling,V=F.nextSibling;return V.nextSibling,p(b,s),a(b,()=>S(t.entry.date),K),a(b,()=>t.entry.reference||e("journal.noReference","No reference"),te),a(b,()=>e("journal.createdBy","By"),V),a(b,()=>t.entry.createdBy,null),b})(),(()=>{var b=x7(),K=b.firstChild,te=K.firstChild,F=te.nextSibling,V=K.nextSibling,W=V.firstChild,I=W.nextSibling;return p(b,l),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),a(te,()=>e("journal.totalAmount","Total Amount")),p(F,c),a(F,()=>m(t.entry.totalDebit)),V.style.setProperty("text-align","right"),W.style.setProperty("font-size","0.875rem"),W.style.setProperty("color","var(--text-muted)"),a(W,()=>e("journal.lines","Lines")),I.style.setProperty("font-weight","600"),a(I,()=>t.entry.lines.length),b})(),ke(()=>!x&&(()=>{var b=A7(),K=b.firstChild,te=K.nextSibling,F=te.nextSibling,V=F.nextSibling,W=V.nextSibling,I=W.nextSibling,E=I.nextSibling,L=E.nextSibling;return L.nextSibling,b.style.setProperty("padding","0.5rem"),b.style.setProperty("border-radius","var(--border-radius-sm)"),b.style.setProperty("background","#f8d7da"),b.style.setProperty("color","#721c24"),b.style.setProperty("font-size","0.875rem"),b.style.setProperty("margin-bottom","1rem"),a(b,()=>e("journal.entryNotBalancedShort","Entry is not balanced"),te),a(b,()=>e("journal.debit"),V),a(b,()=>m(t.entry.totalDebit),I),a(b,()=>e("journal.credit"),L),a(b,()=>m(t.entry.totalCredit),null),b})()),(()=>{var b=C7(),K=b.firstChild,te=K.firstChild;return p(b,d),K.style.setProperty("font-weight","500"),K.style.setProperty("margin-bottom","0.5rem"),K.style.setProperty("font-size","0.875rem"),a(K,()=>e("journal.accountLines","Account Lines"),te),a(b,()=>t.entry.lines.slice(0,3).map(F=>(()=>{var V=$7(),W=V.firstChild,I=W.firstChild,E=I.nextSibling,L=W.nextSibling;return p(V,u),W.style.setProperty("flex","1"),I.style.setProperty("font-weight","500"),a(I,()=>F.accountName),E.style.setProperty("font-size","0.75rem"),E.style.setProperty("color","var(--text-muted)"),a(E,()=>F.description||e("journal.noDescription","No description")),L.style.setProperty("text-align","right"),a(L,(()=>{var M=ke(()=>F.debitAmount>0);return()=>M()&&(()=>{var P=v1(),w=P.firstChild;return P.style.setProperty("color","#4caf50"),P.style.setProperty("font-weight","500"),a(P,()=>e("journal.debitShort","Dr."),w),a(P,()=>m(F.debitAmount),null),P})()})(),null),a(L,(()=>{var M=ke(()=>F.creditAmount>0);return()=>M()&&(()=>{var P=v1(),w=P.firstChild;return P.style.setProperty("color","#f44336"),P.style.setProperty("font-weight","500"),a(P,()=>e("journal.creditShort","Cr."),w),a(P,()=>m(F.creditAmount),null),P})()})(),null),a(L,(()=>{var M=ke(()=>!!F.reconciled);return()=>M()&&(()=>{var P=E7();return P.firstChild,P.style.setProperty("font-size","0.75rem"),P.style.setProperty("color","#4caf50"),a(P,()=>e("banking.reconciled","Reconciled"),null),P})()})(),null),V})()),null),a(b,(()=>{var F=ke(()=>t.entry.lines.length>3);return()=>F()&&(()=>{var V=jm();return V.style.setProperty("text-align","center"),V.style.setProperty("color","var(--text-muted)"),V.style.setProperty("font-size","0.875rem"),a(V,()=>e("journal.andMoreLines","... and {count} more lines").replace("{count}",(t.entry.lines.length-3).toString())),V})()})(),null),b})(),(()=>{var b=jm();return p(b,h),a(b,A(ct,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.entry),get children(){return e("journal.viewDetails","View Details")}})),b})()]}})},[eo,sh]=Se([]),zm=()=>eo()?.map(e=>{const r=eo().find(n=>n.lines.some(i=>i.id===e.id));return r?{id:`eb_${e.id}`,accountId:e.accountId,date:r.date,description:r.description,reference:r.reference,debitAmount:e.debitAmount,creditAmount:e.creditAmount,category:e.accountName,isReconciled:e.reconciled||!1,reconciledWith:e.reconciledWith,createdAt:r.createdAt}:null}).filter(e=>e!==null),dn={get journalEntries(){return eo()},async addJournalEntry(t){const e={...t,createdTimeStamp:new Date(t.createdAt).getTime(),id:ki()};return await Im.create(e),sh([...eo(),e]),e},async updateJournalEntry(t,e){await Im.update(t,e),sh(eo().map(r=>r.id===t?{...r,...e}:r))},deleteJournalEntry(t){const e=eo().find(r=>r.id===t);if(e&&e.status==="posted")throw new Error("Cannot delete posted journal entries. Void them instead.");sh(eo().filter(r=>r.id!==t))},voidJournalEntry(t){this.updateJournalEntry(t,{status:"void"})},postJournalEntry(t){const e=eo().find(r=>r.id===t);if(!e)throw new Error("Journal entry not found");if(Math.abs(e.totalDebit-e.totalCredit)>.01)throw new Error("Journal entry is not balanced. Debits must equal credits.");this.updateJournalEntry(t,{status:"posted",postedAt:new Date().toISOString()}),zm()},getJournalEntryById(t){return eo().find(e=>e.id===t)},getJournalEntriesByStatus(t){return eo().filter(e=>e.status===t)},getJournalEntriesByDateRange(t,e){return eo().filter(r=>r.date>=t&&r.date<=e)},getJournalEntriesByAccount(t){return eo().filter(e=>e.lines.some(r=>r.accountId===t))},getNextEntryNumber(){const t=new Date().getFullYear(),r=eo().filter(n=>n.entryNumber.includes(t.toString())).reduce((n,i)=>{const o=parseInt(i.entryNumber.split("-").pop()||"0");return o>n?o:n},0);return`JE-${t}-${String(r+1).padStart(3,"0")}`},validateJournalEntry(t){const e=[];if(t.date||e.push("Date is required"),t.description||e.push("Description is required"),(!t.lines||t.lines.length===0)&&e.push("At least one line item is required"),t.lines){const r=t.lines.reduce((i,o)=>i+(o.debitAmount||0),0),n=t.lines.reduce((i,o)=>i+(o.creditAmount||0),0);Math.abs(r-n)>.01&&e.push(`Entry is not balanced. Debit: ${r}, Credit: ${n}`),t.lines.forEach((i,o)=>{i.accountId||e.push(`Line ${o+1}: Account is required`),i.debitAmount===0&&i.creditAmount===0&&e.push(`Line ${o+1}: Either debit or credit amount must be provided`),i.debitAmount>0&&i.creditAmount>0&&e.push(`Line ${o+1}: Cannot have both debit and credit amounts`)})}return{isValid:e.length===0,errors:e}},async refreshData(t){return this.fetchInvoices(t)},async fetchInvoices(t){try{let e="";t?.search&&(e+=" "+t.search),t?.status&&t.status!=="all"&&(e+=" "+t.status);const r=e.toString(),n=await Im.getAll(r,t);return sh(Object.values(n)),setTimeout(()=>{zm()},450),[]}catch(e){throw e instanceof Error&&e.message,console.error("Error fetching invoices:",e),e}finally{}},getBankRelatedEntries(){return zm()}};var T7=le("<form><div></div><div><div><h4></h4></div><div><div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div></div></div><div><div><strong>: </strong></div><div><strong>: </strong></div><div></div></div></div><div>"),qm=le("<div>");const DP=t=>{const{t:e}=or(),[r,n]=Se({entryNumber:"",date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),[i,o]=Se([]),[s,l]=Se(null);Un(()=>{if(t.isOpen){if(t.editEntry)n({entryNumber:t.editEntry.entryNumber,date:t.editEntry.date,description:t.editEntry.description,reference:t.editEntry.reference,createdBy:t.editEntry.createdBy}),o(t.editEntry.lines.map((F,V)=>({...F,tempId:`line_${t.editEntry.entryNumber}_${V}`})));else{const F=dn.getNextEntryNumber();n({entryNumber:F,date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),o([{tempId:`line_${F}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${F}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])}l(null)}});const c={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},d={display:"grid","grid-template-columns":"2fr 2fr 1fr 1fr 1fr",gap:"1rem","align-items":"end","margin-bottom":"1rem",padding:"1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},u={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},h=()=>xr.accounts.map(F=>({value:F.id,label:`${F.accountNumber} - ${F.name}`})),g=(F,V)=>{n(W=>({...W,[F]:V}))},m=(F,V,W)=>{o(I=>I.map(E=>{if(E.tempId===F){const L={...E,[V]:W};if(V==="accountId"&&typeof W=="string"){const M=xr.getAccountById(W);M&&(L.accountName=M.name)}return L}return E}))},S=()=>{o(F=>[...F,{tempId:`line_${r()?.entryNumber}_${F.length}`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])},N=F=>{i().length>2&&o(V=>V.filter(W=>W.tempId!==F))},x=()=>{const F=i().reduce((W,I)=>W+(I.debitAmount||0),0),V=i().reduce((W,I)=>W+(I.creditAmount||0),0);return{totalDebit:F,totalCredit:V,isBalanced:Math.abs(F-V)<.01}},b=F=>{F.preventDefault(),l(null);const V=r(),W=i(),{totalDebit:I,totalCredit:E,isBalanced:L}=x();if(!V.description){l(e("forms.descriptionRequired","Description is required"));return}if(W.length<2){l(e("journal.minTwoLinesRequired","At least 2 line items are required"));return}if(!L){l(e("journal.entryNotBalanced","Entry is not balanced. Debit: ${debit}, Credit: ${credit}").replace("${debit}",`$${I.toFixed(2)}`).replace("${credit}",`$${E.toFixed(2)}`));return}for(let w=0;w<W.length;w++){const v=W[w];if(!v.accountId){l(e("journal.lineAccountRequired","Line {lineNumber}: Account is required").replace("{lineNumber}",(w+1).toString()));return}if(v.debitAmount===0&&v.creditAmount===0){l(e("journal.lineAmountRequired","Line {lineNumber}: Either debit or credit amount must be provided").replace("{lineNumber}",(w+1).toString()));return}if((v.debitAmount||0)>0&&(v.creditAmount||0)>0){l(e("journal.lineBothAmounts","Line {lineNumber}: Cannot have both debit and credit amounts").replace("{lineNumber}",(w+1).toString()));return}}const M={entryNumber:V.entryNumber,date:V.date,description:V.description,reference:V.reference,status:"draft",createdBy:V.createdBy,createdAt:new Date().toISOString(),totalDebit:I,totalCredit:E,lines:W.map((w,v)=>{const{tempId:j,...z}=w;return{id:`jel_${V.entryNumber}_${v}`,...z}})};let P=Jb(Object.keys(t.editEntry),M,t.editEntry,{id:1,referenceHId:1,createdBy:1,createdAt:1,createdTimeStamp:1});try{t.editEntry?dn.updateJournalEntry(t.editEntry.id,P.data):dn.addJournalEntry(M);let w=dn.getNextEntryNumber();n({entryNumber:w,date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),o([{tempId:`line_${w}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${w}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),t.onClose()}catch(w){l(w instanceof Error?w.message:e("forms.errorOccurred","An error occurred"))}},K=F=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(F),te=x();return A(Bn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return ke(()=>!!t.editEntry)()?e("journal.editEntry"):e("journal.addEntry","Add Journal Entry")},get children(){var F=T7(),V=F.firstChild,W=V.nextSibling,I=W.firstChild,E=I.firstChild,L=I.nextSibling,M=L.firstChild,P=M.firstChild,w=P.firstChild,v=P.nextSibling,j=v.firstChild,z=v.nextSibling,T=z.firstChild,R=z.nextSibling,J=R.firstChild,X=R.nextSibling,H=X.firstChild,se=L.nextSibling,O=se.firstChild,_=O.firstChild,k=_.firstChild,$=O.nextSibling,G=$.firstChild,ne=G.firstChild,U=$.nextSibling,D=W.nextSibling;return F.addEventListener("submit",b),V.style.setProperty("display","grid"),V.style.setProperty("grid-template-columns","1fr 1fr"),V.style.setProperty("gap","1rem"),a(V,A(Lt,{get label(){return e("journal.entryNumber")},get value(){return r().entryNumber},onChange:B=>g("entryNumber",B),get disabled(){return!!t.editEntry},required:!0}),null),a(V,A(Lt,{get label(){return e("common.date")},type:"date",get value(){return r().date},onChange:B=>g("date",B),required:!0}),null),a(F,A(Lt,{get label(){return e("common.description")},get value(){return r().description},onChange:B=>g("description",B),get placeholder(){return e("journal.enterEntryDescription","Enter journal entry description")},required:!0}),W),a(F,A(Lt,{get label(){return e("journal.reference")},get value(){return r().reference},onChange:B=>g("reference",B),get placeholder(){return e("journal.enterReferenceNumber","Enter reference number")}}),W),W.style.setProperty("margin-top","2rem"),I.style.setProperty("display","flex"),I.style.setProperty("justify-content","space-between"),I.style.setProperty("align-items","center"),I.style.setProperty("margin-bottom","1rem"),E.style.setProperty("margin","0"),a(E,()=>e("journal.entryLines","Journal Entry Lines")),a(I,A(ct,{type:"button",variant:"secondary",size:"sm",onClick:S,get children(){return e("journal.addLine","Add Line")}}),null),L.style.setProperty("margin-bottom","1rem"),L.style.setProperty("font-size","0.875rem"),L.style.setProperty("color","var(--text-muted)"),M.style.setProperty("display","grid"),M.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1fr"),M.style.setProperty("gap","1rem"),a(w,()=>e("journal.account")),a(j,()=>e("common.description")),a(T,()=>e("journal.debit")),a(J,()=>e("journal.credit")),a(H,()=>e("common.actions")),a(W,A(vt,{get each(){return i()},get fallback(){return(()=>{var B=qm();return a(B,()=>e("journal.noLines","No lines")),B})()},children:(B,Q)=>{const Z=B;return(()=>{var oe=qm();return p(oe,d),a(oe,A(en,{label:"",get value(){return Z.accountId||""},onChange:de=>m(Z.tempId,"accountId",de),get options(){return h()}}),null),a(oe,A(Lt,{label:"",get value(){return Z.description||""},onChange:de=>m(Z.tempId,"description",de),get placeholder(){return e("journal.lineDescription","Line description")}}),null),a(oe,A(Lt,{label:"",type:"number",get value(){return Z.debitAmount?.toString()||"0"},onChange:de=>{m(Z.tempId,"debitAmount",parseFloat(de)||0),parseFloat(de)>0&&m(Z.tempId,"creditAmount",0)},placeholder:"0.00"}),null),a(oe,A(Lt,{label:"",type:"number",get value(){return Z.creditAmount?.toString()||"0"},onChange:de=>{m(Z.tempId,"creditAmount",parseFloat(de)||0),parseFloat(de)>0&&m(Z.tempId,"debitAmount",0)},placeholder:"0.00"}),null),a(oe,A(ct,{type:"button",variant:"outline",size:"sm",onClick:()=>N(Z.tempId),get disabled(){return i().length<=2},get children(){return e("common.remove")}}),null),oe})()}}),se),p(se,u),a(_,()=>e("journal.totalDebit","Total Debit"),k),a(_,()=>K(te.totalDebit),null),a(G,()=>e("journal.totalCredit","Total Credit"),ne),a(G,()=>K(te.totalCredit),null),U.style.setProperty("font-weight","600"),a(U,(()=>{var B=ke(()=>!!te.isBalanced);return()=>B()?`✓ ${e("journal.balanced")}`:`⚠️ ${e("journal.notBalanced","Not Balanced")}`})()),a(F,(()=>{var B=ke(()=>!!s());return()=>B()&&(()=>{var Q=qm();return Q.style.setProperty("padding","1rem"),Q.style.setProperty("border-radius","var(--border-radius-sm)"),Q.style.setProperty("margin-top","1rem"),Q.style.setProperty("background","#f8d7da"),Q.style.setProperty("color","#721c24"),Q.style.setProperty("border","1px solid #f5c6cb"),a(Q,s),Q})()})(),D),p(D,c),a(D,A(ct,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(D,A(ct,{variant:"primary",type:"submit",get disabled(){return!te.isBalanced},get children(){return ke(()=>!!t.editEntry)()?e("journal.updateEntry","Update Entry"):e("journal.saveAsDraft","Save as Draft")}}),null),ge(B=>(B=te.isBalanced?"#4caf50":"#f44336")!=null?U.style.setProperty("color",B):U.style.removeProperty("color")),F}})},k7={"Sale Amount":{en:"Sale Amount",es:"Monto de Venta"},"Payment Amount":{en:"Payment Amount",es:"Monto del Pago"},"Expense Amount":{en:"Expense Amount",es:"Monto del Gasto"},"Rent Amount":{en:"Rent Amount",es:"Monto del Alquiler"},"Salary Amount":{en:"Salary Amount",es:"Monto del Salario"},"Utility Amount":{en:"Utility Amount",es:"Monto de Servicios"},"Inventory Cost":{en:"Inventory Cost",es:"Costo del Inventario"},"Investment Amount":{en:"Investment Amount",es:"Monto de Inversión"},"Depreciation Amount":{en:"Depreciation Amount",es:"Monto de Depreciación"},"Interest Amount":{en:"Interest Amount",es:"Monto de Interés"},"Principal Amount":{en:"Principal Amount",es:"Monto Principal"},"Total Payment":{en:"Total Payment",es:"Pago Total"},Amount:{en:"Amount",es:"Monto"},Monto:{en:"Amount",es:"Monto"}},N7={"Cash Sale":{en:"Cash Sale",es:"Venta en Efectivo"},"Credit Sale":{en:"Credit Sale",es:"Venta a Crédito"},"Customer Payment Received":{en:"Customer Payment Received",es:"Pago Recibido del Cliente"},"Office Expenses":{en:"Office Expenses",es:"Gastos de Oficina"},"Rent Payment":{en:"Rent Payment",es:"Pago de Alquiler"},"Salary Payment":{en:"Salary Payment",es:"Pago de Salario"},"Utility Payment":{en:"Utility Payment",es:"Pago de Servicios"},"Inventory Purchase":{en:"Inventory Purchase",es:"Compra de Inventario"},"Supplier Payment":{en:"Supplier Payment",es:"Pago a Proveedor"},"Capital Investment":{en:"Capital Investment",es:"Inversión de Capital"},"Depreciation Expense":{en:"Depreciation Expense",es:"Gasto de Depreciación"},"Loan Payment":{en:"Loan Payment",es:"Pago de Préstamo"}},L7={"Record a cash sale transaction":{en:"Record a cash sale transaction",es:"Registrar una transacción de venta en efectivo"},"Record a sale on credit (accounts receivable)":{en:"Record a sale on credit (accounts receivable)",es:"Registrar una venta a crédito (cuentas por cobrar)"},"Record payment received from customer":{en:"Record payment received from customer",es:"Registrar pago recibido del cliente"},"Record office supplies and expenses":{en:"Record office supplies and expenses",es:"Registrar suministros y gastos de oficina"},"Record monthly rent payment":{en:"Record monthly rent payment",es:"Registrar pago mensual de alquiler"},"Record employee salary payment":{en:"Record employee salary payment",es:"Registrar pago de salario de empleado"},"Record utility bills payment":{en:"Record utility bills payment",es:"Registrar pago de servicios públicos"},"Record inventory purchase on credit":{en:"Record inventory purchase on credit",es:"Registrar compra de inventario a crédito"},"Record payment to supplier":{en:"Record payment to supplier",es:"Registrar pago a proveedor"},"Record owner capital investment":{en:"Record owner capital investment",es:"Registrar inversión de capital del propietario"},"Record monthly depreciation of assets":{en:"Record monthly depreciation of assets",es:"Registrar depreciación mensual de activos"},"Record loan principal and interest payment":{en:"Record loan principal and interest payment",es:"Registrar pago de capital e intereses del préstamo"}},R7={"Cash received from sale":{en:"Cash received from sale",es:"Efectivo recibido de venta"},"Sales revenue":{en:"Sales revenue",es:"Ingresos por ventas"},"Credit sale to customer":{en:"Credit sale to customer",es:"Venta a crédito al cliente"},"Payment received from customer":{en:"Payment received from customer",es:"Pago recibido del cliente"},"Payment applied to receivable":{en:"Payment applied to receivable",es:"Pago aplicado a cuenta por cobrar"},"Office supplies and expenses":{en:"Office supplies and expenses",es:"Suministros y gastos de oficina"},"Payment for office expenses":{en:"Payment for office expenses",es:"Pago por gastos de oficina"},"Monthly rent payment":{en:"Monthly rent payment",es:"Pago mensual de alquiler"},"Rent payment":{en:"Rent payment",es:"Pago de alquiler"},"Employee salary":{en:"Employee salary",es:"Salario de empleado"},"Salary payment":{en:"Salary payment",es:"Pago de salario"},"Utility bills payment":{en:"Utility bills payment",es:"Pago de servicios públicos"},"Utility payment":{en:"Utility payment",es:"Pago de servicios"},"Inventory purchase":{en:"Inventory purchase",es:"Compra de inventario"},"Amount owed to supplier":{en:"Amount owed to supplier",es:"Monto adeudado al proveedor"},"Payment to supplier":{en:"Payment to supplier",es:"Pago al proveedor"},"Capital investment received":{en:"Capital investment received",es:"Inversión de capital recibida"},"Capital investment":{en:"Capital investment",es:"Inversión de capital"},"Monthly depreciation expense":{en:"Monthly depreciation expense",es:"Gasto mensual de depreciación"},"Accumulated depreciation":{en:"Accumulated depreciation",es:"Depreciación acumulada"},"Interest expense":{en:"Interest expense",es:"Gasto por intereses"},"Principal payment":{en:"Principal payment",es:"Pago de capital"},"Total loan payment":{en:"Total loan payment",es:"Pago total del préstamo"}},D7=t=>k7[t]?.["es"]||t,M7=t=>N7[t]?.["es"]||t,F7=t=>L7[t]?.["es"]||t,O7=t=>R7[t]?.["es"]||t,B7=[{id:"cash_sale",name:"Cash Sale",description:"Record a cash sale transaction",category:"revenue",lines:[{id:"cs1",accountId:"1001",accountName:"Petty Cash",description:"Cash received from sale",type:"debit",isAmountField:!0,amountFieldName:"Sale Amount"},{id:"cs2",accountId:"10",accountName:"Sales Revenue",description:"Sales revenue",type:"credit",isAmountField:!0,amountFieldName:"Sale Amount"}]},{id:"credit_sale",name:"Credit Sale",description:"Record a sale on credit (accounts receivable)",category:"revenue",lines:[{id:"crs1",accountId:"2001",accountName:"Trade Receivables",description:"Credit sale to customer",type:"debit",isAmountField:!0,amountFieldName:"Sale Amount"},{id:"crs2",accountId:"10",accountName:"Sales Revenue",description:"Sales revenue",type:"credit",isAmountField:!0,amountFieldName:"Sale Amount"}]},{id:"customer_payment",name:"Customer Payment Received",description:"Record payment received from customer",category:"assets",lines:[{id:"cp1",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment received from customer",type:"debit",isAmountField:!0,amountFieldName:"Payment Amount"},{id:"cp2",accountId:"2001",accountName:"Trade Receivables",description:"Payment applied to receivable",type:"credit",isAmountField:!0,amountFieldName:"Payment Amount"}]},{id:"office_expenses",name:"Office Expenses",description:"Record office supplies and expenses",category:"expenses",lines:[{id:"oe1",accountId:"5200",accountName:"Office Expenses",description:"Office supplies and expenses",type:"debit",isAmountField:!0,amountFieldName:"Expense Amount"},{id:"oe2",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment for office expenses",type:"credit",isAmountField:!0,amountFieldName:"Expense Amount"}]},{id:"rent_payment",name:"Rent Payment",description:"Record monthly rent payment",category:"expenses",lines:[{id:"rp1",accountId:"5200",accountName:"Rent Expense",description:"Monthly rent payment",type:"debit",isAmountField:!0,amountFieldName:"Rent Amount"},{id:"rp2",accountId:"1002",accountName:"Bank - Checking Account",description:"Rent payment",type:"credit",isAmountField:!0,amountFieldName:"Rent Amount"}]},{id:"salary_payment",name:"Salary Payment",description:"Record employee salary payment",category:"expenses",lines:[{id:"sp1",accountId:"13",accountName:"Salaries Expense",description:"Employee salary",type:"debit",isAmountField:!0,amountFieldName:"Salary Amount"},{id:"sp2",accountId:"1002",accountName:"Bank - Checking Account",description:"Salary payment",type:"credit",isAmountField:!0,amountFieldName:"Salary Amount"}]},{id:"utility_payment",name:"Utility Payment",description:"Record utility bills payment",category:"expenses",lines:[{id:"up1",accountId:"14",accountName:"Operating Expenses",description:"Utility bills payment",type:"debit",isAmountField:!0,amountFieldName:"Utility Amount"},{id:"up2",accountId:"1002",accountName:"Bank - Checking Account",description:"Utility payment",type:"credit",isAmountField:!0,amountFieldName:"Utility Amount"}]},{id:"inventory_purchase",name:"Inventory Purchase",description:"Record inventory purchase on credit",category:"assets",lines:[{id:"ip1",accountId:"3",accountName:"Inventory",description:"Inventory purchase",type:"debit",isAmountField:!0,amountFieldName:"Inventory Cost"},{id:"ip2",accountId:"5",accountName:"Accounts Payable",description:"Amount owed to supplier",type:"credit",isAmountField:!0,amountFieldName:"Inventory Cost"}]},{id:"supplier_payment",name:"Supplier Payment",description:"Record payment to supplier",category:"liabilities",lines:[{id:"spp1",accountId:"5",accountName:"Accounts Payable",description:"Payment to supplier",type:"debit",isAmountField:!0,amountFieldName:"Payment Amount"},{id:"spp2",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment to supplier",type:"credit",isAmountField:!0,amountFieldName:"Payment Amount"}]},{id:"capital_investment",name:"Capital Investment",description:"Record owner capital investment",category:"equity",lines:[{id:"ci1",accountId:"1002",accountName:"Bank - Checking Account",description:"Capital investment received",type:"debit",isAmountField:!0,amountFieldName:"Investment Amount"},{id:"ci2",accountId:"8",accountName:"Owner's Equity",description:"Capital investment",type:"credit",isAmountField:!0,amountFieldName:"Investment Amount"}]},{id:"depreciation",name:"Depreciation Expense",description:"Record monthly depreciation of assets",category:"expenses",lines:[{id:"dep1",accountId:"14",accountName:"Operating Expenses",description:"Monthly depreciation expense",type:"debit",isAmountField:!0,amountFieldName:"Depreciation Amount"},{id:"dep2",accountId:"15",accountName:"Accumulated Depreciation",description:"Accumulated depreciation",type:"credit",isAmountField:!0,amountFieldName:"Depreciation Amount"}]},{id:"loan_payment",name:"Loan Payment",description:"Record loan principal and interest payment",category:"liabilities",lines:[{id:"lp1",accountId:"14",accountName:"Operating Expenses",description:"Interest expense",type:"debit",isAmountField:!0,amountFieldName:"Interest Amount"},{id:"lp2",accountId:"6",accountName:"Loans Payable",description:"Principal payment",type:"debit",isAmountField:!0,amountFieldName:"Principal Amount"},{id:"lp3",accountId:"1002",accountName:"Bank - Checking Account",description:"Total loan payment",type:"credit",isAmountField:!0,amountFieldName:"Total Payment"}]}],MP="journal_custom_templates",V7=()=>{try{const t=localStorage.getItem(MP);if(t)return JSON.parse(t)}catch(t){console.warn("Failed to load custom templates:",t)}return[]},Um=t=>{try{localStorage.setItem(MP,JSON.stringify(t))}catch(e){console.warn("Failed to save custom templates:",e)}},j7=()=>{const t=V7();return[...B7,...t]},[Hm,Gm]=Se(j7()),gi={get templates(){return Hm()},getTemplatesByCategory(t){return Hm().filter(e=>e.category===t)},getTemplateById(t){return Hm().find(e=>e.id===t)},addTemplate(t){const e={...t,id:`custom_${Date.now()}`};return Gm(r=>{const n=[...r,e],i=n.filter(o=>o.id.startsWith("custom_"));return Um(i),n}),e},updateTemplate(t,e){Gm(r=>{const n=r.map(o=>o.id===t?{...o,...e}:o),i=n.filter(o=>o.id.startsWith("custom_"));return Um(i),n})},deleteTemplate(t){if(t.startsWith("custom_"))Gm(e=>{const r=e.filter(i=>i.id!==t),n=r.filter(i=>i.id.startsWith("custom_"));return Um(n),r});else throw new Error("Cannot delete default templates")},getAllCategories(){return["revenue","expenses","assets","liabilities","equity"]},getCategoryDisplayName(t){const e="es",r={revenue:{en:"Revenue & Sales",es:"Ingresos y Ventas"},expenses:{en:"Expenses & Costs",es:"Gastos y Costos"},assets:{en:"Assets & Receipts",es:"Activos y Recibos"},liabilities:{en:"Liabilities & Payments",es:"Pasivos y Pagos"},equity:{en:"Equity & Capital",es:"Patrimonio y Capital"}};return r[t][e]||r[t].en},getTranslatedFieldName:D7,getTranslatedTemplateName:M7,getTranslatedTemplateDesc:F7,getTranslatedLineDesc:O7};var b1=le("<div>"),z7=le("<div><h4></h4><div><div><strong>: </strong><span>|</span><strong>: </strong></div><div>"),q7=le("<form><div></div><div>"),U7=le("<div><div><div></div><div></div><div></div></div><div></div><div><div> ");const H7=t=>{const{t:e}=or(),[r,n]=Se(""),[i,o]=Bc({form:{}}),[s,l]=Se(""),[c,d]=Se(""),[u,h]=Se({}),[g,m]=Se({date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),[S,N]=Se(null);Un(()=>{t.isOpen&&(n(""),o("form",null),l(null),d(""),m({date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),N(null))}),Un(()=>{});const x={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},b={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-top":"1rem"},K={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.5rem 0","border-bottom":"1px solid var(--border-color)"},te=j=>{if(n(j),j){const z=gi.getTemplateById(j);o("form",Qb(z)||null),l(z?.lines),z&&!g().description&&m(T=>({...T,description:z.description})),z&&z.lines.forEach((T,R)=>{T.fixedAmount||(o("form","lines",R,"fixedAmount",0),h(J=>({...J,[T.id]:0})))})}},F=()=>gi.getAllCategories().map(j=>({value:j,label:gi.getCategoryDisplayName(j)})),V=()=>{const j=c();return j?gi.getTemplatesByCategory(j).map(z=>({value:z.id,label:gi.getTranslatedTemplateName(z.name)})):[]},W=(j,z)=>{m(T=>({...T,[j]:z}))},I=j=>u()?.[j]||0,E=(j,z)=>{const T=i.form;!T||!T.lines.find(J=>J.id===j)||(h(J=>({...J,[j]:z})),T.lines.findIndex(J=>J.id===j))},L=()=>{const j=i.form;if(!j)return{totalDebit:0,totalCredit:0,isBalanced:!1};let z=0,T=0;return j?.lines?.forEach(R=>{const J=u()?.[R.id]||R.fixedAmount||0;R.type==="debit"?z+=J:T+=J}),{totalDebit:z,totalCredit:T,isBalanced:Math.abs(z-T)<.01}},M=()=>{const j=i.form;if(!j)return[];const z=new Map;return j?.lines?.forEach(T=>{T.isAmountField&&T.amountFieldName&&z.set(T.amountFieldName,T.id)}),Array.from(z.entries()).map(([T,R])=>({fieldName:T,lineId:R}))},P=j=>{j.preventDefault(),N(null);const z=i.form;if(!z){N(e("journal.templateRequired","Please select a template"));return}const T=g(),{totalDebit:R,totalCredit:J,isBalanced:X}=L();if(!T.description){N(e("forms.descriptionRequired","Description is required"));return}if(!X){N(e("journal.entryNotBalanced","Entry is not balanced. Debit: ${debit}, Credit: ${credit}").replace("${debit}",`$${R.toFixed(2)}`).replace("${credit}",`$${J.toFixed(2)}`));return}for(const se of z.lines){const O=u()?.[se.id]||0;if(se.isAmountField&&O<=0){N(e("journal.amountRequired","Amount is required for {field}").replace("{field}",se.amountFieldName||"line"));return}}const H={entryNumber:dn.getNextEntryNumber(),date:T.date,description:T.description,reference:T.reference,status:"draft",createdBy:T.createdBy,createdAt:new Date().toISOString(),totalDebit:R,totalCredit:J,lines:z.lines.map((se,O)=>{const _=u()?.[se.id]||0;return{id:`jel_${Date.now()}_${O}`,accountId:se.accountId,accountName:se.accountName,description:se.description,debitAmount:se.type==="debit"?_:0,creditAmount:se.type==="credit"?_:0}})};try{dn.addJournalEntry(H),t.onClose()}catch(se){N(se instanceof Error?se.message:e("forms.errorOccurred","An error occurred"))}},w=j=>{const z="es-ES";return new Intl.NumberFormat(z,{style:"currency",currency:"USD"}).format(j)};M();const v=()=>i?.form?.lines||[];return A(Bn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.quickEntry","Quick Journal Entry")},get children(){var j=q7(),z=j.firstChild,T=z.nextSibling;return j.addEventListener("submit",P),z.style.setProperty("display","grid"),z.style.setProperty("grid-template-columns","1fr 1fr"),z.style.setProperty("gap","1rem"),z.style.setProperty("margin-bottom","1rem"),a(z,A(en,{get label(){return e("journal.selectCategory","Select Category")},get value(){return c()},onChange:R=>{d(R),te("")},get options(){return[{value:"",label:e("journal.chooseCategory","Choose a category...")},...F()]},required:!0}),null),a(z,A(en,{get label(){return e("journal.selectTemplate","Select Template")},get value(){return r()},onChange:te,get options(){return[{value:"",label:e("journal.chooseTemplate","Choose a template...")},...V()]},get disabled(){return!c()},required:!0}),null),a(j,A(Me,{get when(){return i.form},get children(){return[(()=>{var R=b1();return R.style.setProperty("display","grid"),R.style.setProperty("grid-template-columns","1fr 1fr"),R.style.setProperty("gap","1rem"),a(R,A(Lt,{get label(){return e("common.date")},type:"date",get value(){return g().date},onChange:J=>W("date",J),required:!0}),null),a(R,A(Lt,{get label(){return e("journal.reference")},get value(){return g().reference},onChange:J=>W("reference",J),get placeholder(){return e("journal.enterReferenceNumber","Enter reference number")}}),null),R})(),A(Lt,{get label(){return e("common.description")},get value(){return g().description},onChange:R=>W("description",R),get placeholder(){return i?.form?.description||e("journal.enterEntryDescription","Enter journal entry description")},required:!0}),(()=>{var R=z7(),J=R.firstChild,X=J.nextSibling,H=X.firstChild,se=H.firstChild,O=se.firstChild,_=se.nextSibling,k=_.nextSibling,$=k.firstChild,G=H.nextSibling;return p(R,b),J.style.setProperty("margin","0 0 1rem 0"),J.style.setProperty("color","var(--text-primary)"),a(J,()=>e("journal.entryPreview","Entry Preview")),a(R,A(vt,{get each(){return v()},children:ne=>(()=>{var U=U7(),D=U.firstChild,B=D.firstChild,Q=B.nextSibling,Z=Q.nextSibling,oe=D.nextSibling,de=oe.nextSibling,re=de.firstChild,Y=re.firstChild;return B.style.setProperty("font-weight","500"),a(B,()=>ne.accountName),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),a(Q,()=>gi.getTranslatedLineDesc(ne.description)),Z.style.setProperty("font-size","0.75rem"),Z.style.setProperty("margin-top","0.25rem"),Z.style.setProperty("font-weight","500"),a(Z,(()=>{var ce=ke(()=>ne.type==="debit");return()=>ce()?e("journal.debit"):e("journal.credit")})()),a(oe,A(Lt,{label:"",type:"number",get value(){return I(ne.id).toString()},onChange:ce=>E(ne.id,parseFloat(ce)||0),placeholder:"0.00",step:"0.01",min:"0",style:{"font-size":"0.875rem"}})),de.style.setProperty("text-align","right"),re.style.setProperty("font-weight","600"),a(re,()=>ne.type==="debit"?"DR":"CR",Y),a(re,()=>w(I(ne.id)),null),ge(ce=>{var ue={...K,display:"grid","grid-template-columns":"2fr 1fr 1fr",gap:"1rem","align-items":"center"},ae=ne.type==="debit"?"#d32f2f":"#2e7d32",ye=ne.type==="debit"?"#d32f2f":"#2e7d32";return ce.e=p(U,ue,ce.e),ae!==ce.t&&((ce.t=ae)!=null?Z.style.setProperty("color",ae):Z.style.removeProperty("color")),ye!==ce.a&&((ce.a=ye)!=null?re.style.setProperty("color",ye):re.style.removeProperty("color")),ce},{e:void 0,t:void 0,a:void 0}),U})()}),X),X.style.setProperty("margin-top","1rem"),X.style.setProperty("padding-top","1rem"),X.style.setProperty("border-top","2px solid var(--border-color)"),X.style.setProperty("display","flex"),X.style.setProperty("justify-content","space-between"),X.style.setProperty("align-items","center"),a(se,()=>e("journal.totalDebit"),O),a(se,()=>w(L().totalDebit),null),_.style.setProperty("margin","0 1rem"),_.style.setProperty("color","var(--text-muted)"),a(k,()=>e("journal.totalCredit"),$),a(k,()=>w(L().totalCredit),null),G.style.setProperty("font-weight","600"),a(G,(()=>{var ne=ke(()=>!!L().isBalanced);return()=>ne()?`✓ ${e("journal.balanced","Balanced")}`:`⚠️ ${e("journal.notBalanced","Not Balanced")}`})()),ge(ne=>(ne=L().isBalanced?"#4caf50":"#f44336")!=null?G.style.setProperty("color",ne):G.style.removeProperty("color")),R})()]}}),T),a(j,(()=>{var R=ke(()=>!!S());return()=>R()&&(()=>{var J=b1();return J.style.setProperty("padding","1rem"),J.style.setProperty("border-radius","var(--border-radius-sm)"),J.style.setProperty("margin-top","1rem"),J.style.setProperty("background","#f8d7da"),J.style.setProperty("color","#721c24"),J.style.setProperty("border","1px solid #f5c6cb"),a(J,S),J})()})(),T),p(T,x),a(T,A(ct,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(T,A(ct,{variant:"primary",type:"submit",get disabled(){return!i.form||!L().isBalanced},get children(){return e("journal.createQuickEntry","Create Quick Entry")}}),null),j}})};var G7=le("<div><h3></h3><div>"),W7=le("<div><div></div><div><div><h4></h4></div><div><div><div></div><div></div><div></div><div></div><div></div><div>"),Y7=le("<div><p></p><p>"),P1=le("<div><div></div><div>"),K7=le("<h4>"),Q7=le("<span>"),Wm=le("<div>");const J7=t=>{const{t:e}=or(),[r,n]=Se(""),[i,o]=Se(!1),[s,l]=Se(!1),[c,d]=Se({name:"",description:"",category:"expenses"}),[u,h]=Se([{accountId:"",accountName:"",description:"",type:"debit",isAmountField:!0,amountFieldName:e("common.amount","Amount")},{accountId:"",accountName:"",description:"",type:"credit",isAmountField:!0,amountFieldName:e("common.amount","Amount")}]),[g,m]=Se(null);Un(()=>{t.isOpen&&(n(""),o(!1),l(!1),m(null),V())});const S={display:"flex",gap:"1.5rem",height:"500px"},N={width:"300px","border-right":"1px solid var(--border-color)","padding-right":"1.5rem","overflow-y":"auto"},x={flex:"1","overflow-y":"auto"},b={padding:"0.75rem","margin-bottom":"0.5rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",transition:"all 0.2s"},K={display:"grid","grid-template-columns":"2fr 2fr 1fr 1fr 1fr 80px",gap:"0.5rem","align-items":"end","margin-bottom":"0.75rem",padding:"0.75rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)"},te=()=>xr.accounts.map(R=>({value:R.id,label:`${R.accountNumber} - ${R.name}`})),F=()=>gi.getAllCategories().map(R=>({value:R,label:gi.getCategoryDisplayName(R)})),V=()=>{d({name:"",description:"",category:"expenses"}),h([{accountId:"",accountName:"",description:"",type:"debit",isAmountField:!0,amountFieldName:e("common.amount","Amount")},{accountId:"",accountName:"",description:"",type:"credit",isAmountField:!0,amountFieldName:e("common.amount","Amount")}])},W=R=>{const J=gi.getTemplateById(R);J&&(d({name:J.name,description:J.description,category:J.category}),h(J.lines.map(X=>({accountId:X.accountId,accountName:X.accountName,description:X.description,type:X.type,isAmountField:X.isAmountField,amountFieldName:X.amountFieldName,fixedAmount:X.fixedAmount}))))},I=R=>{n(R),o(!1),l(!1),W(R)},E=()=>{n(""),o(!1),l(!0),V()},L=()=>{r()&&r().startsWith("custom_")&&o(!0)},M=()=>{const R=r();if(R&&R.startsWith("custom_")&&confirm(e("journal.confirmDeleteTemplate","Are you sure you want to delete this template?")))try{gi.deleteTemplate(R),n(""),V()}catch(J){m(J instanceof Error?J.message:e("journal.errorDeletingTemplate","Error deleting template"))}},P=(R,J)=>{d(X=>({...X,[R]:J}))},w=(R,J,X)=>{h(H=>H.map((se,O)=>{if(O===R){const _={...se,[J]:X};if(J==="accountId"&&typeof X=="string"){const k=xr.getAccountById(X);k&&(_.accountName=k.name)}return _}return se}))},v=()=>{h(R=>[...R,{accountId:"",accountName:"",description:"",type:R.length%2===0?"debit":"credit",isAmountField:!0,amountFieldName:e("common.amount","Amount")}])},j=R=>{u().length>2&&h(J=>J.filter((X,H)=>H!==R))},z=()=>{m(null);const R=c(),J=u();if(!R.name.trim()){m(e("journal.templateNameRequired","Template name is required"));return}if(!R.description.trim()){m(e("journal.templateDescriptionRequired","Template description is required"));return}if(J.length<2){m(e("journal.minTwoLinesRequired","At least 2 lines are required"));return}for(let H=0;H<J.length;H++){const se=J[H];if(!se.accountId){m(e("journal.lineAccountRequired","Line {lineNumber}: Account is required").replace("{lineNumber}",(H+1).toString()));return}if(!se.description){m(e("journal.lineDescriptionRequired","Line {lineNumber}: Description is required").replace("{lineNumber}",(H+1).toString()));return}if(se.isAmountField&&!se.amountFieldName){m(e("journal.amountFieldNameRequired","Line {lineNumber}: Amount field name is required").replace("{lineNumber}",(H+1).toString()));return}}const X={name:R.name,description:R.description,category:R.category,lines:J.map((H,se)=>({id:`line_${Date.now()}_${se}`,...H}))};try{if(i()&&r())gi.updateTemplate(r(),X);else{const H=gi.addTemplate(X);n(H.id)}o(!1),l(!1)}catch(H){m(H instanceof Error?H.message:e("journal.errorSavingTemplate","Error saving template"))}},T=()=>{const R=gi.templates,J={};return R.forEach(X=>{J[X.category]||(J[X.category]=[]),J[X.category].push(X)}),J};return A(Bn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.manageTemplates","Manage Journal Templates")},size:"large",get children(){var R=P1(),J=R.firstChild,X=J.nextSibling;return p(R,S),p(J,N),a(J,A(ct,{variant:"primary",onClick:E,style:{width:"100%","margin-bottom":"1rem"},get children(){return["+ ",ke(()=>e("journal.addNewTemplate","Add New Template"))]}}),null),a(J,A(vt,{get each(){return Object.entries(T())},children:([H,se])=>[(()=>{var O=K7();return O.style.setProperty("margin","1rem 0 0.5rem 0"),O.style.setProperty("font-size","0.875rem"),O.style.setProperty("color","var(--text-muted)"),O.style.setProperty("text-transform","uppercase"),a(O,()=>gi.getCategoryDisplayName(H)),O})(),A(vt,{each:se,children:O=>(()=>{var _=P1(),k=_.firstChild,$=k.nextSibling;return _.$$click=()=>I(O.id),k.style.setProperty("font-weight","500"),a(k,()=>gi.getTranslatedTemplateName(O.name)),$.style.setProperty("font-size","0.75rem"),$.style.setProperty("opacity","0.8"),$.style.setProperty("margin-top","0.25rem"),a($,()=>gi.getTranslatedTemplateDesc(O.description)),a(_,(()=>{var G=ke(()=>!!O.id.startsWith("custom_"));return()=>G()&&(()=>{var ne=Q7();return ne.style.setProperty("font-size","0.625rem"),ne.style.setProperty("background","rgba(255,255,255,0.2)"),ne.style.setProperty("padding","0.125rem 0.5rem"),ne.style.setProperty("border-radius","10px"),ne.style.setProperty("margin-top","0.25rem"),ne.style.setProperty("display","inline-block"),a(ne,()=>e("journal.custom","Custom")),ne})()})(),null),ge(G=>p(_,{...b,background:r()===O.id?"var(--primary-color)":"var(--surface-color)",color:r()===O.id?"white":"inherit"},G)),_})()})]}),null),p(X,x),a(X,A(Me,{get when(){return r()||s()},get children(){return[(()=>{var H=G7(),se=H.firstChild,O=se.nextSibling;return H.style.setProperty("display","flex"),H.style.setProperty("justify-content","space-between"),H.style.setProperty("align-items","center"),H.style.setProperty("margin-bottom","1rem"),se.style.setProperty("margin","0"),a(se,(()=>{var _=ke(()=>!!s());return()=>_()?e("journal.newTemplate","New Template"):ke(()=>!!i())()?e("journal.editTemplate","Edit Template"):e("journal.templateDetails","Template Details")})()),O.style.setProperty("display","flex"),O.style.setProperty("gap","0.5rem"),a(O,A(Me,{get when(){return ke(()=>!!(r()&&r().startsWith("custom_")))()&&!i()},get children(){return[A(ct,{variant:"outline",size:"sm",onClick:L,get children(){return e("common.edit")}}),A(ct,{variant:"outline",size:"sm",onClick:M,style:{color:"var(--danger-color)"},get children(){return e("common.delete")}})]}}),null),a(O,A(Me,{get when(){return i()||s()},get children(){return[A(ct,{variant:"secondary",size:"sm",onClick:()=>{o(!1),l(!1),r()&&W(r())},get children(){return e("common.cancel")}}),A(ct,{variant:"primary",size:"sm",onClick:z,get children(){return e("common.save")}})]}}),null),H})(),(()=>{var H=W7(),se=H.firstChild,O=se.nextSibling,_=O.firstChild,k=_.firstChild,$=_.nextSibling,G=$.firstChild,ne=G.firstChild,U=ne.nextSibling,D=U.nextSibling,B=D.nextSibling,Q=B.nextSibling,Z=Q.nextSibling;return H.style.setProperty("background","var(--background-color)"),H.style.setProperty("padding","1rem"),H.style.setProperty("border-radius","var(--border-radius-sm)"),se.style.setProperty("display","grid"),se.style.setProperty("grid-template-columns","2fr 1fr"),se.style.setProperty("gap","1rem"),se.style.setProperty("margin-bottom","1rem"),a(se,A(Lt,{get label(){return e("journal.templateName","Template Name")},get value(){return c().name},onChange:oe=>P("name",oe),get disabled(){return ke(()=>!i())()&&!s()},get placeholder(){return e("journal.enterTemplateName","Enter template name")}}),null),a(se,A(en,{get label(){return e("journal.category","Category")},get value(){return c().category},onChange:oe=>P("category",oe),get options(){return F()},get disabled(){return ke(()=>!i())()&&!s()}}),null),a(H,A(Lt,{get label(){return e("common.description")},get value(){return c().description},onChange:oe=>P("description",oe),get disabled(){return ke(()=>!i())()&&!s()},get placeholder(){return e("journal.enterTemplateDescription","Enter template description")}}),O),O.style.setProperty("margin-top","2rem"),_.style.setProperty("display","flex"),_.style.setProperty("justify-content","space-between"),_.style.setProperty("align-items","center"),_.style.setProperty("margin-bottom","1rem"),k.style.setProperty("margin","0"),a(k,()=>e("journal.templateLines","Template Lines")),a(_,A(Me,{get when(){return i()||s()},get children(){return A(ct,{variant:"secondary",size:"sm",onClick:v,get children(){return["+ ",ke(()=>e("journal.addLine"))]}})}}),null),$.style.setProperty("margin-bottom","0.5rem"),$.style.setProperty("font-size","0.75rem"),$.style.setProperty("color","var(--text-muted)"),G.style.setProperty("display","grid"),G.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1fr 80px"),G.style.setProperty("gap","0.5rem"),a(ne,()=>e("journal.account")),a(U,()=>e("common.description")),a(D,()=>e("journal.type","Type")),a(B,()=>e("journal.amountType","Amount Type")),a(Q,()=>e("journal.fieldName","Field Name")),a(Z,()=>e("common.actions")),a(O,A(vt,{get each(){return u()},get fallback(){return(()=>{var oe=Wm();return a(oe,()=>e("journal.noTemplateLines","No template lines")),oe})()},children:(oe,de)=>{const re=oe,Y=de();return(()=>{var ce=Wm();return p(ce,K),a(ce,A(en,{label:"",get value(){return re.accountId||""},onChange:ue=>w(Y,"accountId",ue),get options(){return[{value:"",label:e("journal.selectAccount","Select account...")},...te()]},get disabled(){return ke(()=>!i())()&&!s()}}),null),a(ce,A(Lt,{label:"",get value(){return re.description||""},onChange:ue=>w(Y,"description",ue),get placeholder(){return e("journal.lineDescription")},get disabled(){return ke(()=>!i())()&&!s()}}),null),a(ce,A(en,{label:"",get value(){return re.type},onChange:ue=>w(Y,"type",ue),get options(){return[{value:"debit",label:e("journal.debit")},{value:"credit",label:e("journal.credit")}]},get disabled(){return ke(()=>!i())()&&!s()}}),null),a(ce,A(en,{label:"",get value(){return re.isAmountField?"variable":"fixed"},onChange:ue=>{w(Y,"isAmountField",ue==="variable"),ue==="fixed"&&w(Y,"fixedAmount",0)},get options(){return[{value:"variable",label:e("journal.variable","Variable")},{value:"fixed",label:e("journal.fixed","Fixed")}]},get disabled(){return ke(()=>!i())()&&!s()}}),null),a(ce,A(Me,{get when(){return re.isAmountField},get fallback(){return A(Lt,{label:"",type:"number",get value(){return re.fixedAmount?.toString()||"0"},onChange:ue=>w(Y,"fixedAmount",parseFloat(ue)||0),placeholder:"0.00",get disabled(){return ke(()=>!i())()&&!s()}})},get children(){return A(Lt,{label:"",get value(){return re.amountFieldName||""},onChange:ue=>w(Y,"amountFieldName",ue),get placeholder(){return e("journal.fieldNamePlaceholder","e.g., Monto")},get disabled(){return ke(()=>!i())()&&!s()}})}}),null),a(ce,A(Me,{get when(){return i()||s()},get children(){return A(ct,{variant:"outline",size:"sm",onClick:()=>j(Y),get disabled(){return u().length<=2},style:{color:"var(--danger-color)"},get children(){return e("common.remove")}})}}),null),ce})()}}),null),H})(),ke(()=>ke(()=>!!g())()&&(()=>{var H=Wm();return H.style.setProperty("padding","1rem"),H.style.setProperty("border-radius","var(--border-radius-sm)"),H.style.setProperty("margin-top","1rem"),H.style.setProperty("background","#f8d7da"),H.style.setProperty("color","#721c24"),H.style.setProperty("border","1px solid #f5c6cb"),a(H,g),H})())]}}),null),a(X,A(Me,{get when(){return ke(()=>!r())()&&!s()},get children(){var H=Y7(),se=H.firstChild,O=se.nextSibling;return H.style.setProperty("text-align","center"),H.style.setProperty("padding","3rem"),H.style.setProperty("color","var(--text-muted)"),a(se,()=>e("journal.selectTemplateToView","Select a template from the list to view details")),a(O,()=>e("journal.orCreateNew","or create a new custom template")),H}}),null),R}})};Wt(["click"]);var X7=le("<div><div>⚠️</div><div></div><div></div><div>"),Z7=le("<div><div></div><div></div><div></div><div></div><div>"),eL=le("<div><button></button><button> (<!>)</button><button> (<!>/<!>)"),Ym=le("<div>"),tL=le("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><div><h4></h4><div></div></div><div>"),Km=le("<div><span></span><span>"),ah=le("<div><strong>:</strong> "),rL=le("<div><div><div></div><div></div><div></div><div></div><div></div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div></div></div><div><div><strong>🔗 </strong></div><div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div></div><div><div><strong>:</strong> </div><div><strong>:</strong> "),nL=le("<div><div><div></div><div></div></div><div></div><div></div><div></div><div>"),iL=le("<div><span>✓ "),oL=le("<span>(<!>)"),sL=le("<div><div>:"),aL=le("<div><div>⚠️ <!>:</div><div>"),lL=le("<div><div><div><span></span><h3></h3></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),cL=le("<div><h4>✅ <!> (<!>)"),dL=le("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div>✓ "),uL=le("<div>→ "),hL=le("<div><h4>⏳ <!> (<!>)"),pL=le("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div>⏳ "),mL=le("<div><div>💡 </div><div> ");const yL=t=>{const{t:e}=or(),[r,n]=Se("details"),[i,o]=Se(!1),s=Nt(()=>t.entryId?dn.getJournalEntryById(t.entryId):null),l={"text-align":"center","margin-bottom":"2rem",position:"relative"},c={position:"absolute",top:"0",right:"0",display:"flex",gap:"0.5rem"},d={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","margin-bottom":"0.5rem"},u={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},h={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},g={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem",display:"inline-block"},m={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},S={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},N={"font-weight":"600",color:"var(--text-primary)"},x={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},b=v=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:v?"var(--primary-color)":"var(--text-muted)","border-bottom":v?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),K={display:"grid","grid-template-columns":"2fr 2.5fr 1fr 1fr 1.5fr",gap:"1rem",padding:"1rem 0","border-bottom":"1px solid var(--border-color)","align-items":"center"},te={...K,"font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","border-bottom":"2px solid var(--border-color)"},F={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},V={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},W=v=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[v],I=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(v),E=v=>new Date(v).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),L=v=>new Date(v).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),M=()=>{s()?.status==="posted"&&!confirm(e("journal.confirmEditPosted","This entry has been posted. Editing will create a new draft copy. Continue?"))||o(!0)},P=()=>{if(s()&&confirm(e("journal.confirmPost","Are you sure you want to post this journal entry? This action cannot be undone.")))try{dn.postJournalEntry(s().id)}catch(v){alert(v instanceof Error?v.message:e("forms.errorPostingEntry","An error occurred while posting the entry"))}},w=()=>{s()&&confirm(e("journal.confirmVoid","Are you sure you want to void this journal entry?"))&&dn.voidJournalEntry(s().id)};return[A(Bn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.entryDetails","Journal Entry Details")},get children(){return ke(()=>!s())()?(()=>{var v=X7(),j=v.firstChild,z=j.nextSibling,T=z.nextSibling,R=T.nextSibling;return v.style.setProperty("text-align","center"),v.style.setProperty("padding","3rem"),v.style.setProperty("color","var(--text-muted)"),j.style.setProperty("font-size","1.5rem"),j.style.setProperty("margin-bottom","1rem"),z.style.setProperty("font-size","1.1rem"),z.style.setProperty("margin-bottom","0.5rem"),a(z,()=>e("journal.entryNotFound","Entry Not Found")),T.style.setProperty("font-size","0.875rem"),a(T,()=>e("journal.entryNotFoundMessage","The journal entry you're looking for could not be found or may have been deleted.")),R.style.setProperty("margin-top","2rem"),a(R,A(ct,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),v})():(()=>{const v=s(),j=W(v.status),z=Math.abs(v.totalDebit-v.totalCredit)<.01;return[(()=>{var T=Z7(),R=T.firstChild,J=R.nextSibling,X=J.nextSibling,H=X.nextSibling,se=H.nextSibling;return p(T,l),a(R,A(ct,{variant:"outline",size:"sm",onClick:M,get title(){return e("journal.editEntryTooltip","Edit this journal entry")},get children(){return e("common.edit")}}),null),a(R,(()=>{var O=ke(()=>v.status==="draft");return()=>O()&&A(ct,{variant:"primary",size:"sm",onClick:P,disabled:!z,get title(){return z?e("journal.postEntryTooltip","Post this journal entry"):e("journal.entryMustBeBalanced","Entry must be balanced to post")},get children(){return e("journal.post","Post")}})})(),null),a(R,(()=>{var O=ke(()=>v.status==="posted");return()=>O()&&A(ct,{variant:"outline",size:"sm",onClick:w,style:{color:"#dc3545","border-color":"#dc3545"},get title(){return e("journal.voidEntryTooltip","Void this journal entry")},get children(){return e("entryBooks.void","Void")}})})(),null),p(J,d),a(J,()=>v.entryNumber),p(X,u),a(X,()=>v.description),p(H,h),a(H,()=>I(v.totalDebit)),a(se,()=>e(`journal.${v.status}`,v.status)),ge(O=>{var _=c,k={...g,background:j.bg,color:j.color};return O.e=p(R,_,O.e),O.t=p(se,k,O.t),O},{e:void 0,t:void 0}),T})(),(()=>{var T=eL(),R=T.firstChild,J=R.nextSibling,X=J.firstChild,H=X.nextSibling;H.nextSibling;var se=J.nextSibling,O=se.firstChild,_=O.nextSibling,k=_.nextSibling,$=k.nextSibling;return $.nextSibling,p(T,x),R.$$click=()=>n("details"),a(R,()=>e("common.details")),J.$$click=()=>n("lines"),a(J,()=>e("journal.journalLines","Journal Lines"),X),a(J,()=>v.lines.length,H),se.$$click=()=>n("reconciliation"),a(se,()=>e("banking.reconciliation","Reconciliation"),O),a(se,()=>v.lines.filter(G=>G.reconciled).length,_),a(se,()=>v.lines.length,$),ge(G=>{var ne=b(r()==="details"),U=b(r()==="lines"),D=b(r()==="reconciliation");return G.e=p(R,ne,G.e),G.t=p(J,U,G.t),G.a=p(se,D,G.a),G},{e:void 0,t:void 0,a:void 0}),T})(),ke(()=>ke(()=>r()==="details")()&&(()=>{var T=tL(),R=T.firstChild,J=R.firstChild,X=J.nextSibling,H=R.nextSibling,se=H.firstChild,O=se.nextSibling,_=H.nextSibling,k=_.firstChild,$=k.nextSibling,G=_.nextSibling,ne=G.firstChild,U=ne.nextSibling,D=G.nextSibling,B=D.firstChild,Q=B.nextSibling,Z=D.nextSibling,oe=Z.firstChild,de=oe.nextSibling,re=Z.nextSibling,Y=re.firstChild,ce=Y.nextSibling,ue=re.nextSibling,ae=ue.firstChild,ye=ae.firstChild,me=ye.nextSibling,pe=ae.nextSibling;return a(J,()=>e("common.date")),a(X,()=>E(v.date)),a(se,()=>e("journal.reference")),a(O,()=>v.reference||e("common.notAvailable","N/A")),a(k,()=>e("journal.totalDebit")),a($,()=>I(v.totalDebit)),a(ne,()=>e("journal.totalCredit")),a(U,()=>I(v.totalCredit)),a(B,()=>e("journal.balanceStatus","Balance Status")),a(Q,()=>z?`${e("journal.balanced")} ✓`:`${e("journal.unbalanced","Unbalanced")} (${I(Math.abs(v.totalDebit-v.totalCredit))} ${e("journal.difference","difference")})`),a(oe,()=>e("journal.createdBy")),a(de,()=>v.createdBy),a(Y,()=>e("journal.createdAt","Created At")),a(ce,()=>L(v.createdAt)),a(T,(()=>{var ve=ke(()=>!!v.postedAt);return()=>ve()&&(()=>{var Ne=Km(),Ie=Ne.firstChild,Ce=Ie.nextSibling;return a(Ie,()=>e("journal.postedAt","Posted At")),a(Ce,()=>L(v.postedAt)),ge(Ee=>{var we=m,Re=S,He=N;return Ee.e=p(Ne,we,Ee.e),Ee.t=p(Ie,Re,Ee.t),Ee.a=p(Ce,He,Ee.a),Ee},{e:void 0,t:void 0,a:void 0}),Ne})()})(),ue),ue.style.setProperty("margin-top","2rem"),ue.style.setProperty("padding-top","1rem"),ue.style.setProperty("border-top","2px solid var(--border-color)"),ae.style.setProperty("display","flex"),ae.style.setProperty("justify-content","space-between"),ae.style.setProperty("align-items","center"),ae.style.setProperty("margin-bottom","1rem"),ye.style.setProperty("margin","0"),ye.style.setProperty("font-size","1rem"),a(ye,()=>e("journal.quickActions","Quick Actions")),me.style.setProperty("display","flex"),me.style.setProperty("gap","0.5rem"),a(me,A(ct,{variant:"primary",size:"sm",onClick:M,get children(){return["✏️ ",ke(()=>e("journal.editEntry"))]}}),null),a(me,(()=>{var ve=ke(()=>v.status==="draft");return()=>ve()&&A(ct,{variant:"outline",size:"sm",onClick:P,disabled:!z,style:{"border-color":z?"#4caf50":"#f44336",color:z?"#4caf50":"#f44336"},get children(){return z?`✓ ${e("journal.postEntry","Post Entry")}`:`⚠️ ${e("journal.fixBalance","Fix Balance")}`}})})(),null),a(me,(()=>{var ve=ke(()=>v.status==="posted");return()=>ve()&&A(ct,{variant:"outline",size:"sm",onClick:w,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return["🗑️ ",ke(()=>e("journal.voidEntry","Void Entry"))]}})})(),null),pe.style.setProperty("padding","1rem"),pe.style.setProperty("border-radius","var(--border-radius-sm)"),pe.style.setProperty("font-size","0.875rem"),a(pe,(()=>{var ve=ke(()=>v.status==="draft");return()=>ve()&&(()=>{var Ne=ah(),Ie=Ne.firstChild,Ce=Ie.firstChild;return Ie.nextSibling,a(Ie,()=>e("journal.draftEntry","Draft Entry"),Ce),a(Ne,()=>e("journal.draftEntryDescription","This entry can be edited and posted."),null),a(Ne,()=>!z&&` ⚠️ ${e("journal.entryMustBeBalancedBeforePosting","Entry must be balanced before posting.")}`,null),Ne})()})(),null),a(pe,(()=>{var ve=ke(()=>v.status==="posted");return()=>ve()&&(()=>{var Ne=ah(),Ie=Ne.firstChild,Ce=Ie.firstChild;return Ie.nextSibling,a(Ie,()=>e("journal.postedEntry","Posted Entry"),Ce),a(Ne,()=>e("journal.postedEntryDescription","This entry has been posted to the general ledger. Editing will create a new draft copy."),null),Ne})()})(),null),a(pe,(()=>{var ve=ke(()=>v.status==="void");return()=>ve()&&(()=>{var Ne=ah(),Ie=Ne.firstChild,Ce=Ie.firstChild;return Ie.nextSibling,a(Ie,()=>e("journal.voidEntry"),Ce),a(Ne,()=>e("journal.voidEntryDescription","This entry has been voided and cannot be modified."),null),Ne})()})(),null),ge(ve=>{var Ne=m,Ie=S,Ce=N,Ee=m,we=S,Re=N,He=m,je=S,Ve=N,qe=m,tt=S,rt=N,Be=m,Ge=S,Fe={...N,color:z?"#4caf50":"#f44336"},at=m,lt=S,Xe=N,Ct=m,Le=S,nt=N,We=v.status==="draft"?"#fff3cd":v.status==="posted"?"#d4edda":"#f8d7da";return ve.e=p(R,Ne,ve.e),ve.t=p(J,Ie,ve.t),ve.a=p(X,Ce,ve.a),ve.o=p(H,Ee,ve.o),ve.i=p(se,we,ve.i),ve.n=p(O,Re,ve.n),ve.s=p(_,He,ve.s),ve.h=p(k,je,ve.h),ve.r=p($,Ve,ve.r),ve.d=p(G,qe,ve.d),ve.l=p(ne,tt,ve.l),ve.u=p(U,rt,ve.u),ve.c=p(D,Be,ve.c),ve.w=p(B,Ge,ve.w),ve.m=p(Q,Fe,ve.m),ve.f=p(Z,at,ve.f),ve.y=p(oe,lt,ve.y),ve.g=p(de,Xe,ve.g),ve.p=p(re,Ct,ve.p),ve.b=p(Y,Le,ve.b),ve.T=p(ce,nt,ve.T),We!==ve.A&&((ve.A=We)!=null?pe.style.setProperty("background",We):pe.style.removeProperty("background")),ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),T})()),ke(()=>ke(()=>r()==="lines")()&&(()=>{var T=rL(),R=T.firstChild,J=R.firstChild,X=J.nextSibling,H=X.nextSibling,se=H.nextSibling,O=se.nextSibling,_=R.nextSibling,k=_.firstChild,$=k.firstChild,G=$.firstChild;$.nextSibling;var ne=k.nextSibling,U=ne.firstChild,D=U.firstChild;U.nextSibling;var B=ne.nextSibling,Q=_.nextSibling,Z=Q.firstChild,oe=Z.firstChild;oe.firstChild;var de=Z.nextSibling,re=de.firstChild,Y=re.firstChild,ce=Y.firstChild,ue=ce.firstChild;ce.nextSibling;var ae=Y.nextSibling,ye=ae.firstChild,me=ye.firstChild;ye.nextSibling;var pe=ae.nextSibling,ve=pe.firstChild,Ne=ve.firstChild;ve.nextSibling;var Ie=re.nextSibling,Ce=Ie.firstChild,Ee=Ce.firstChild,we=Ee.firstChild;Ee.nextSibling;var Re=Ce.nextSibling,He=Re.firstChild,je=He.firstChild;return He.nextSibling,a(J,()=>e("journal.account")),a(X,()=>e("common.description")),a(H,()=>e("journal.debit")),a(se,()=>e("journal.credit")),a(O,()=>e("banking.reconciliation")),a(T,A(vt,{get each(){return v.lines},children:Ve=>(()=>{var qe=nL(),tt=qe.firstChild,rt=tt.firstChild,Be=rt.nextSibling,Ge=tt.nextSibling,Fe=Ge.nextSibling,at=Fe.nextSibling,lt=at.nextSibling;return rt.style.setProperty("font-weight","500"),a(rt,()=>Ve.accountName),Be.style.setProperty("font-size","0.75rem"),Be.style.setProperty("color","var(--text-muted)"),a(Be,()=>xr.getAccountById(Ve.accountId)?.accountNumber||Ve.accountId),Ge.style.setProperty("font-size","0.875rem"),a(Ge,()=>Ve.description||"-"),Fe.style.setProperty("font-weight","600"),a(Fe,(()=>{var Xe=ke(()=>Ve.debitAmount>0);return()=>Xe()?I(Ve.debitAmount):"-"})()),at.style.setProperty("font-weight","600"),a(at,(()=>{var Xe=ke(()=>Ve.creditAmount>0);return()=>Xe()?I(Ve.creditAmount):"-"})()),a(lt,(()=>{var Xe=ke(()=>!!Ve.reconciled);return()=>Xe()?(()=>{var Ct=iL(),Le=Ct.firstChild;return Le.firstChild,Ct.style.setProperty("display","flex"),Ct.style.setProperty("align-items","center"),Ct.style.setProperty("gap","0.5rem"),Ct.style.setProperty("color","#4caf50"),Ct.style.setProperty("font-size","0.875rem"),Le.style.setProperty("font-weight","600"),a(Le,()=>e("banking.reconciled"),null),a(Ct,(()=>{var nt=ke(()=>!!Ve.reconciledWith);return()=>nt()&&(()=>{var We=oL(),kt=We.firstChild,Et=kt.nextSibling;return Et.nextSibling,We.style.setProperty("font-size","0.75rem"),We.style.setProperty("color","var(--text-muted)"),We.style.setProperty("font-style","italic"),a(We,()=>Ve.reconciledWith,Et),We})()})(),null),Ct})():(()=>{var Ct=Ym();return Ct.style.setProperty("color","var(--text-muted)"),Ct.style.setProperty("font-size","0.875rem"),a(Ct,()=>e("banking.notReconciled","Not Reconciled")),Ct})()})()),ge(Xe=>{var Ct=K,Le=Ve.debitAmount>0?"#4caf50":"var(--text-muted)",nt=Ve.creditAmount>0?"#f44336":"var(--text-muted)";return Xe.e=p(qe,Ct,Xe.e),Le!==Xe.t&&((Xe.t=Le)!=null?Fe.style.setProperty("color",Le):Fe.style.removeProperty("color")),nt!==Xe.a&&((Xe.a=nt)!=null?at.style.setProperty("color",nt):at.style.removeProperty("color")),Xe},{e:void 0,t:void 0,a:void 0}),qe})()}),_),p(_,F),a($,()=>e("journal.totalDebit"),G),a(k,()=>I(v.totalDebit),null),a(U,()=>e("journal.totalCredit"),D),a(ne,()=>I(v.totalCredit),null),(z?"#4caf50":"#f44336")!=null?B.style.setProperty("color",z?"#4caf50":"#f44336"):B.style.removeProperty("color"),B.style.setProperty("font-weight","600"),a(B,()=>z?`✓ ${e("journal.balanced")}`:`⚠️ ${e("journal.notBalanced","Not Balanced")}`),Q.style.setProperty("margin-top","1rem"),Q.style.setProperty("padding","1rem"),Q.style.setProperty("border-radius","var(--border-radius-sm)"),Q.style.setProperty("font-size","0.875rem"),Z.style.setProperty("margin-bottom","0.5rem"),a(oe,()=>e("journal.reconciliationSummary","Reconciliation Summary"),null),de.style.setProperty("display","grid"),de.style.setProperty("grid-template-columns","1fr 1fr"),de.style.setProperty("gap","1rem"),Y.style.setProperty("margin-bottom","0.25rem"),a(ce,()=>e("journal.totalLines","Total Lines"),ue),a(Y,()=>v.lines.length,null),ae.style.setProperty("margin-bottom","0.25rem"),ae.style.setProperty("color","#4caf50"),a(ye,()=>e("journal.reconciled","Reconciled"),me),a(ae,()=>v.lines.filter(Ve=>Ve.reconciled).length,null),pe.style.setProperty("color","#f44336"),a(ve,()=>e("journal.unreconciled","Unreconciled"),Ne),a(pe,()=>v.lines.filter(Ve=>!Ve.reconciled).length,null),Ce.style.setProperty("margin-bottom","0.25rem"),a(Ee,()=>e("journal.bankAccounts","Bank Accounts"),we),a(Ce,()=>v.lines.filter(Ve=>["1001","1002","1003"].includes(Ve.accountId)).length,null),Re.style.setProperty("margin-bottom","0.25rem"),Re.style.setProperty("color","#4caf50"),a(He,()=>e("journal.bankReconciled","Bank Reconciled"),je),a(Re,()=>v.lines.filter(Ve=>["1001","1002","1003"].includes(Ve.accountId)&&Ve.reconciled).length,null),a(Ie,(()=>{var Ve=ke(()=>v.lines.filter(qe=>["1001","1002","1003"].includes(qe.accountId)&&!qe.reconciled).length>0);return()=>Ve()&&(()=>{var qe=ah(),tt=qe.firstChild,rt=tt.firstChild;return tt.nextSibling,qe.style.setProperty("color","#f44336"),a(tt,()=>e("journal.bankPending","Bank Pending"),rt),a(qe,()=>v.lines.filter(Be=>["1001","1002","1003"].includes(Be.accountId)&&!Be.reconciled).length,null),qe})()})(),null),a(Q,(()=>{var Ve=ke(()=>v.lines.filter(qe=>qe.reconciled).length>0);return()=>Ve()&&(()=>{var qe=sL(),tt=qe.firstChild,rt=tt.firstChild;return qe.style.setProperty("margin-top","0.75rem"),qe.style.setProperty("padding-top","0.75rem"),qe.style.setProperty("border-top","1px solid var(--border-color)"),tt.style.setProperty("margin-bottom","0.5rem"),tt.style.setProperty("font-weight","500"),a(tt,()=>e("journal.reconciledLines","Reconciled Lines"),rt),a(qe,()=>v.lines.filter(Be=>Be.reconciled).map(Be=>(()=>{var Ge=Km(),Fe=Ge.firstChild,at=Fe.nextSibling;return Ge.style.setProperty("display","flex"),Ge.style.setProperty("justify-content","space-between"),Ge.style.setProperty("margin-bottom","0.25rem"),Ge.style.setProperty("font-size","0.8rem"),a(Fe,()=>Be.accountName),at.style.setProperty("color","var(--text-muted)"),a(at,(()=>{var lt=ke(()=>!!Be.reconciledWith);return()=>lt()?`→ ${Be.reconciledWith}`:e("journal.manual","Manual")})()),Ge})()),null),qe})()})(),null),a(Q,(()=>{var Ve=ke(()=>v.lines.filter(qe=>!qe.reconciled&&["1001","1002","1003"].includes(qe.accountId)).length>0);return()=>Ve()&&(()=>{var qe=aL(),tt=qe.firstChild,rt=tt.firstChild,Be=rt.nextSibling;Be.nextSibling;var Ge=tt.nextSibling;return qe.style.setProperty("margin-top","0.75rem"),qe.style.setProperty("padding-top","0.75rem"),qe.style.setProperty("border-top","1px solid var(--border-color)"),tt.style.setProperty("margin-bottom","0.5rem"),tt.style.setProperty("font-weight","500"),tt.style.setProperty("color","#f44336"),a(tt,()=>e("journal.pendingBankReconciliation","Pending Bank Reconciliation"),Be),a(qe,()=>v.lines.filter(Fe=>!Fe.reconciled&&["1001","1002","1003"].includes(Fe.accountId)).map(Fe=>(()=>{var at=Km(),lt=at.firstChild,Xe=lt.nextSibling;return at.style.setProperty("display","flex"),at.style.setProperty("justify-content","space-between"),at.style.setProperty("margin-bottom","0.25rem"),at.style.setProperty("font-size","0.8rem"),at.style.setProperty("color","#f44336"),a(lt,()=>Fe.accountName),a(Xe,()=>I(Fe.debitAmount||Fe.creditAmount)),at})()),Ge),Ge.style.setProperty("margin-top","0.5rem"),Ge.style.setProperty("font-size","0.75rem"),Ge.style.setProperty("color","var(--text-muted)"),Ge.style.setProperty("font-style","italic"),a(Ge,()=>e("journal.visitBankConsolidations","Visit Bank Consolidations to reconcile these transactions")),qe})()})(),null),ge(Ve=>{var qe=te,tt=v.lines.some(rt=>rt.reconciled)?"#e8f5e8":"#fff3cd";return Ve.e=p(R,qe,Ve.e),tt!==Ve.t&&((Ve.t=tt)!=null?Q.style.setProperty("background",tt):Q.style.removeProperty("background")),Ve},{e:void 0,t:void 0}),T})()),ke(()=>ke(()=>r()==="reconciliation")()&&(()=>{var T=lL(),R=T.firstChild,J=R.firstChild,X=J.firstChild,H=X.nextSibling,se=J.nextSibling,O=se.firstChild,_=O.firstChild,k=_.nextSibling,$=O.nextSibling,G=$.firstChild,ne=G.nextSibling,U=$.nextSibling,D=U.firstChild,B=D.nextSibling;return R.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("padding","1rem"),R.style.setProperty("border-radius","var(--border-radius)"),R.style.setProperty("border","1px solid var(--border-color)"),J.style.setProperty("display","flex"),J.style.setProperty("align-items","center"),J.style.setProperty("gap","0.5rem"),J.style.setProperty("margin-bottom","1rem"),X.style.setProperty("font-size","1.5rem"),a(X,(()=>{var Q=ke(()=>!!v.lines.every(Z=>Z.reconciled));return()=>Q()?"✅":v.lines.some(Z=>Z.reconciled)?"🔄":"⏳"})()),H.style.setProperty("margin","0"),H.style.setProperty("font-size","1.2rem"),a(H,(()=>{var Q=ke(()=>!!v.lines.every(Z=>Z.reconciled));return()=>Q()?e("journal.fullyReconciled","Fully Reconciled"):ke(()=>!!v.lines.some(Z=>Z.reconciled))()?e("journal.partiallyReconciled","Partially Reconciled"):e("journal.unreconciled","Unreconciled")})()),se.style.setProperty("display","grid"),se.style.setProperty("grid-template-columns","1fr 1fr 1fr"),se.style.setProperty("gap","1rem"),O.style.setProperty("text-align","center"),_.style.setProperty("font-size","2rem"),_.style.setProperty("font-weight","700"),_.style.setProperty("color","var(--primary-color)"),a(_,()=>v.lines.length),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("color","var(--text-muted)"),a(k,()=>e("journal.totalLines","Total Lines")),$.style.setProperty("text-align","center"),G.style.setProperty("font-size","2rem"),G.style.setProperty("font-weight","700"),G.style.setProperty("color","#4caf50"),a(G,()=>v.lines.filter(Q=>Q.reconciled).length),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-muted)"),a(ne,()=>e("journal.reconciled","Reconciled")),U.style.setProperty("text-align","center"),D.style.setProperty("font-size","2rem"),D.style.setProperty("font-weight","700"),D.style.setProperty("color","#f44336"),a(D,()=>v.lines.filter(Q=>!Q.reconciled).length),B.style.setProperty("font-size","0.875rem"),B.style.setProperty("color","var(--text-muted)"),a(B,()=>e("journal.pending","Pending")),a(T,(()=>{var Q=ke(()=>v.lines.filter(Z=>Z.reconciled).length>0);return()=>Q()&&(()=>{var Z=cL(),oe=Z.firstChild,de=oe.firstChild,re=de.nextSibling,Y=re.nextSibling,ce=Y.nextSibling;return ce.nextSibling,Z.style.setProperty("margin-bottom","1.5rem"),oe.style.setProperty("margin","0 0 1rem 0"),oe.style.setProperty("font-size","1.1rem"),oe.style.setProperty("color","#4caf50"),oe.style.setProperty("display","flex"),oe.style.setProperty("align-items","center"),oe.style.setProperty("gap","0.5rem"),a(oe,()=>e("journal.reconciledLines","Reconciled Lines"),re),a(oe,()=>v.lines.filter(ue=>ue.reconciled).length,ce),a(Z,()=>v.lines.filter(ue=>ue.reconciled).map(ue=>(()=>{var ae=dL(),ye=ae.firstChild,me=ye.firstChild,pe=me.nextSibling,ve=ye.nextSibling,Ne=ve.nextSibling,Ie=Ne.nextSibling,Ce=Ie.nextSibling,Ee=Ce.firstChild;return Ee.firstChild,ae.style.setProperty("display","grid"),ae.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),ae.style.setProperty("gap","1rem"),ae.style.setProperty("padding","0.75rem"),ae.style.setProperty("margin-bottom","0.5rem"),ae.style.setProperty("background","#f0f9f0"),ae.style.setProperty("border-radius","var(--border-radius-sm)"),ae.style.setProperty("align-items","center"),ae.style.setProperty("font-size","0.875rem"),me.style.setProperty("font-weight","500"),a(me,()=>ue.accountName),pe.style.setProperty("font-size","0.75rem"),pe.style.setProperty("color","var(--text-muted)"),a(pe,()=>xr.getAccountById(ue.accountId)?.accountNumber),ve.style.setProperty("color","var(--text-muted)"),a(ve,()=>ue.description||e("journal.noDescription","No description")),Ne.style.setProperty("font-weight","600"),a(Ne,(()=>{var we=ke(()=>ue.debitAmount>0);return()=>we()?I(ue.debitAmount):"-"})()),Ie.style.setProperty("font-weight","600"),a(Ie,(()=>{var we=ke(()=>ue.creditAmount>0);return()=>we()?I(ue.creditAmount):"-"})()),Ce.style.setProperty("color","#4caf50"),Ee.style.setProperty("font-weight","500"),a(Ee,()=>e("journal.matched","Matched"),null),a(Ce,(()=>{var we=ke(()=>!!ue.reconciledWith);return()=>we()&&(()=>{var Re=uL();return Re.firstChild,Re.style.setProperty("font-size","0.75rem"),Re.style.setProperty("font-style","italic"),a(Re,()=>ue.reconciledWith,null),Re})()})(),null),ge(we=>{var Re=ue.debitAmount>0?"#4caf50":"var(--text-muted)",He=ue.creditAmount>0?"#f44336":"var(--text-muted)";return Re!==we.e&&((we.e=Re)!=null?Ne.style.setProperty("color",Re):Ne.style.removeProperty("color")),He!==we.t&&((we.t=He)!=null?Ie.style.setProperty("color",He):Ie.style.removeProperty("color")),we},{e:void 0,t:void 0}),ae})()),null),Z})()})(),null),a(T,(()=>{var Q=ke(()=>v.lines.filter(Z=>!Z.reconciled).length>0);return()=>Q()&&(()=>{var Z=hL(),oe=Z.firstChild,de=oe.firstChild,re=de.nextSibling,Y=re.nextSibling,ce=Y.nextSibling;return ce.nextSibling,Z.style.setProperty("margin-bottom","1.5rem"),oe.style.setProperty("margin","0 0 1rem 0"),oe.style.setProperty("font-size","1.1rem"),oe.style.setProperty("color","#f44336"),oe.style.setProperty("display","flex"),oe.style.setProperty("align-items","center"),oe.style.setProperty("gap","0.5rem"),a(oe,()=>e("journal.unreconciledLines","Unreconciled Lines"),re),a(oe,()=>v.lines.filter(ue=>!ue.reconciled).length,ce),a(Z,()=>v.lines.filter(ue=>!ue.reconciled).map(ue=>(()=>{var ae=pL(),ye=ae.firstChild,me=ye.firstChild,pe=me.nextSibling,ve=ye.nextSibling,Ne=ve.nextSibling,Ie=Ne.nextSibling,Ce=Ie.nextSibling,Ee=Ce.firstChild;return Ee.firstChild,ae.style.setProperty("display","grid"),ae.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),ae.style.setProperty("gap","1rem"),ae.style.setProperty("padding","0.75rem"),ae.style.setProperty("margin-bottom","0.5rem"),ae.style.setProperty("background","#fff9f0"),ae.style.setProperty("border-radius","var(--border-radius-sm)"),ae.style.setProperty("align-items","center"),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("border","1px solid #ffe0b3"),me.style.setProperty("font-weight","500"),a(me,()=>ue.accountName),pe.style.setProperty("font-size","0.75rem"),pe.style.setProperty("color","var(--text-muted)"),a(pe,()=>xr.getAccountById(ue.accountId)?.accountNumber),ve.style.setProperty("color","var(--text-muted)"),a(ve,()=>ue.description||e("journal.noDescription","No description")),Ne.style.setProperty("font-weight","600"),a(Ne,(()=>{var we=ke(()=>ue.debitAmount>0);return()=>we()?I(ue.debitAmount):"-"})()),Ie.style.setProperty("font-weight","600"),a(Ie,(()=>{var we=ke(()=>ue.creditAmount>0);return()=>we()?I(ue.creditAmount):"-"})()),Ce.style.setProperty("color","#f44336"),Ee.style.setProperty("font-weight","500"),a(Ee,()=>e("journal.pending","Pending"),null),a(Ce,(()=>{var we=ke(()=>!!["1001","1002","1003"].includes(ue.accountId));return()=>we()&&(()=>{var Re=Ym();return Re.style.setProperty("font-size","0.75rem"),Re.style.setProperty("font-style","italic"),a(Re,()=>e("journal.bankAccount","Bank account")),Re})()})(),null),ge(we=>{var Re=ue.debitAmount>0?"#4caf50":"var(--text-muted)",He=ue.creditAmount>0?"#f44336":"var(--text-muted)";return Re!==we.e&&((we.e=Re)!=null?Ne.style.setProperty("color",Re):Ne.style.removeProperty("color")),He!==we.t&&((we.t=He)!=null?Ie.style.setProperty("color",He):Ie.style.removeProperty("color")),we},{e:void 0,t:void 0}),ae})()),null),a(Z,(()=>{var ue=ke(()=>v.lines.filter(ae=>!ae.reconciled&&["1001","1002","1003"].includes(ae.accountId)).length>0);return()=>ue()&&(()=>{var ae=mL(),ye=ae.firstChild;ye.firstChild;var me=ye.nextSibling,pe=me.firstChild;return ae.style.setProperty("padding","0.75rem"),ae.style.setProperty("background","#ffebee"),ae.style.setProperty("border-radius","var(--border-radius-sm)"),ae.style.setProperty("margin-top","1rem"),ae.style.setProperty("border","1px solid #ffcdd2"),ye.style.setProperty("font-weight","500"),ye.style.setProperty("margin-bottom","0.5rem"),ye.style.setProperty("color","#f44336"),a(ye,()=>e("journal.reconciliationTip","Reconciliation Tip"),null),me.style.setProperty("font-size","0.875rem"),me.style.setProperty("color","var(--text-muted)"),a(me,()=>e("journal.unreconciledBankTransactions","This entry has unreconciled bank account transactions."),pe),a(me,()=>e("journal.visitBankConsolidations","Visit Bank Consolidations to reconcile these transactions"),null),ae})()})(),null),Z})()})(),null),ge(Q=>(Q=v.lines.every(Z=>Z.reconciled)?"#e8f5e8":v.lines.some(Z=>Z.reconciled)?"#fff3cd":"#ffebee")!=null?R.style.setProperty("background",Q):R.style.removeProperty("background")),T})()),(()=>{var T=Ym();return p(T,V),a(T,A(ct,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),a(T,A(ct,{variant:"primary",onClick:M,get children(){return e("journal.editEntry")}}),null),a(T,(()=>{var R=ke(()=>v.status==="draft");return()=>R()&&A(ct,{variant:"outline",onClick:P,disabled:!z,style:{"border-color":"#4caf50",color:z?"#4caf50":"var(--text-muted)"},get children(){return z?e("journal.postEntry","Post Entry"):e("journal.entryNotBalanced","Entry Not Balanced")}})})(),null),a(T,(()=>{var R=ke(()=>v.status==="posted");return()=>R()&&A(ct,{variant:"outline",onClick:w,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return e("journal.voidEntry","Void Entry")}})})(),null),T})()]})()}}),ke(()=>ke(()=>!!s())()&&A(DP,{get isOpen(){return i()},onClose:()=>{o(!1)},get editEntry(){return s()}}))]};Wt(["click"]);var fL=le("<div><div><h2></h2><p></p></div><div>"),Es=le("<div>"),gL=le("<div> <!> • <!> "),vL=le("<div><div><label></label></div><div><label></label></div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label></div><div>"),bL=le("<div><span>:</span><span> "),lh=le("<span>: "),PL=le("<div><br>");const _L=()=>{const{t}=or(),[e,r]=Se(!1),[n,i]=Se(!1),[o,s]=Se(!1),[l,c]=Se(null),[d,u]=Se(!1),[h,g]=Se(null),[m,S]=Se("all"),[N,x]=Se("all"),[b,K]=Se(""),[te,F]=Se(""),[V,W]=Se("date"),[I,E]=Se("desc"),L={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},M={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)","flex-wrap":"wrap"},P={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem"},w={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(400px, 1fr))",gap:"1.5rem"},v=()=>[{value:"all",label:t("journal.allEntries","All Entries")},{value:"draft",label:t("journal.draft")},{value:"posted",label:t("journal.posted")},{value:"void",label:t("entryBooks.void","Void")}],j=()=>[{value:"all",label:t("accounts.allAccounts","All Accounts")},...xr.accounts.map(k=>({value:k.id,label:`${k.accountNumber} - ${k.name}`}))],z=()=>[{value:"date",label:t("common.date")},{value:"entryNumber",label:t("journal.entryNumber")},{value:"amount",label:t("common.amount")}],T=()=>{let k=dn.journalEntries;return m()!=="all"&&(k=k.filter($=>$.status===m())),N()!=="all"&&(k=k.filter($=>$.lines.some(G=>G.accountId===N()))),b(),te(),k=[...k].sort(($,G)=>{let ne=0;switch(V()){case"date":ne=new Date($.date).getTime()-new Date(G.date).getTime();break;case"entryNumber":ne=$.entryNumber.localeCompare(G.entryNumber);break;case"amount":ne=$.totalDebit-G.totalDebit;break}return I()==="asc"?ne:-ne}),k},R=()=>{const k=dn.journalEntries,$=k.filter(Q=>Q.status==="draft"),G=k.filter(Q=>Q.status==="posted"),ne=k.filter(Q=>Q.status==="void"),U=G.reduce((Q,Z)=>Q+Z.totalDebit,0),D=G.reduce((Q,Z)=>Q+Z.totalCredit,0),B=k.filter(Q=>Q.lines.some(Z=>["1001","1002","1003"].includes(Z.accountId)&&!Z.reconciled)).length;return{totalEntries:k.length,draftEntries:$.length,postedEntries:G.length,voidEntries:ne.length,totalDebit:U,totalCredit:D,unreconciledEntries:B}},J=k=>{g(k.id),u(!0)},X=()=>{c(null),r(!0)},H=()=>{i(!0)},se=()=>{r(!1),c(null)},O=k=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(k),_=R();return T(),Ln(()=>{dn.refreshData({search:"2025"})}),A(oo,{get title(){return t("entryBooks.title")},get children(){return[(()=>{var k=fL(),$=k.firstChild,G=$.firstChild,ne=G.nextSibling,U=$.nextSibling;return p(k,L),G.style.setProperty("margin","0 0 0.5rem 0"),G.style.setProperty("font-size","1.5rem"),a(G,()=>t("journal.title")),ne.style.setProperty("margin","0"),ne.style.setProperty("color","var(--text-muted)"),a(ne,()=>t("entryBooks.subtitle","Manage accounting entries and general ledger records")),U.style.setProperty("display","flex"),U.style.setProperty("gap","1rem"),a(U,A(ct,{variant:"secondary",onClick:()=>window.location.href="/bank-consolidations",get children(){return t("entryBooks.viewReconciliation","View Reconciliation")}}),null),a(U,A(ct,{variant:"outline",onClick:H,style:{background:"#4caf50",color:"white","border-color":"#4caf50"},get children(){return["⚡ ",ke(()=>t("journal.quickEntry","Quick Entry"))]}}),null),a(U,A(ct,{variant:"outline",onClick:()=>s(!0),get title(){return t("journal.manageTemplates","Manage Templates")},get children(){return["⚙️ ",ke(()=>t("journal.templates","Templates"))]}}),null),a(U,A(ct,{variant:"primary",onClick:X,get children(){return t("journal.addEntry","Add Journal Entry")}}),null),k})(),(()=>{var k=Es();return p(k,P),a(k,A(Rt,{get title(){return t("entryBooks.totalEntries","Total Entries")},get subtitle(){return t("entryBooks.allJournalEntries","All journal entries")},get children(){return[(()=>{var $=Es();return $.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","600"),$.style.setProperty("color","var(--primary-color)"),$.style.setProperty("margin-bottom","0.5rem"),a($,()=>_.totalEntries),$})(),(()=>{var $=gL(),G=$.firstChild,ne=G.nextSibling,U=ne.nextSibling,D=U.nextSibling;return D.nextSibling,$.style.setProperty("font-size","0.875rem"),$.style.setProperty("color","var(--text-muted)"),a($,()=>_.postedEntries,G),a($,()=>t("journal.posted").toLowerCase(),ne),a($,()=>_.draftEntries,D),a($,()=>t("journal.draft").toLowerCase(),null),a($,(()=>{var B=ke(()=>_.voidEntries>0);return()=>B()&&` • ${_.voidEntries} ${t("entryBooks.void","void").toLowerCase()}`})(),null),$})()]}}),null),a(k,A(Rt,{get title(){return t("journal.totalDebits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var $=Es();return $.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","600"),$.style.setProperty("color","#4caf50"),$.style.setProperty("margin-bottom","0.5rem"),a($,()=>O(_.totalDebit)),$})(),(()=>{var $=Es();return $.style.setProperty("font-size","0.875rem"),$.style.setProperty("color","var(--text-muted)"),a($,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",_.postedEntries.toString())),$})()]}}),null),a(k,A(Rt,{get title(){return t("journal.totalCredits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var $=Es();return $.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","600"),$.style.setProperty("color","#f44336"),$.style.setProperty("margin-bottom","0.5rem"),a($,()=>O(_.totalCredit)),$})(),(()=>{var $=Es();return $.style.setProperty("font-size","0.875rem"),$.style.setProperty("color","var(--text-muted)"),a($,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",_.postedEntries.toString())),$})()]}}),null),a(k,A(Rt,{get title(){return t("banking.unreconciled","Unreconciled")},get subtitle(){return t("banking.title")},get children(){return[(()=>{var $=Es();return $.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","600"),$.style.setProperty("margin-bottom","0.5rem"),a($,()=>_.unreconciledEntries),ge(G=>(G=_.unreconciledEntries>0?"#ff9800":"#4caf50")!=null?$.style.setProperty("color",G):$.style.removeProperty("color")),$})(),(()=>{var $=Es();return $.style.setProperty("font-size","0.875rem"),$.style.setProperty("color","var(--text-muted)"),a($,(()=>{var G=ke(()=>_.unreconciledEntries>0);return()=>G()?t("entryBooks.needBankReconciliation","Need bank reconciliation"):t("entryBooks.allReconciled","All reconciled")})()),$})()]}}),null),k})(),(()=>{var k=vL(),$=k.firstChild,G=$.firstChild,ne=$.nextSibling,U=ne.firstChild,D=ne.nextSibling,B=D.firstChild,Q=D.nextSibling,Z=Q.firstChild,oe=Z.nextSibling,de=Q.nextSibling,re=de.firstChild,Y=re.nextSibling,ce=de.nextSibling,ue=ce.firstChild,ae=ce.nextSibling;return p(k,M),$.style.setProperty("min-width","150px"),G.style.setProperty("display","block"),G.style.setProperty("margin-bottom","0.5rem"),G.style.setProperty("font-weight","500"),G.style.setProperty("font-size","0.875rem"),a(G,()=>t("common.status")),a($,A(en,{label:"",get value(){return m()},onChange:S,get options(){return v()}}),null),ne.style.setProperty("min-width","200px"),U.style.setProperty("display","block"),U.style.setProperty("margin-bottom","0.5rem"),U.style.setProperty("font-weight","500"),U.style.setProperty("font-size","0.875rem"),a(U,()=>t("journal.account")),a(ne,A(en,{label:"",get value(){return N()},onChange:x,get options(){return j()}}),null),D.style.setProperty("min-width","120px"),B.style.setProperty("display","block"),B.style.setProperty("margin-bottom","0.5rem"),B.style.setProperty("font-weight","500"),B.style.setProperty("font-size","0.875rem"),a(B,()=>t("entryBooks.sortBy","Sort By")),a(D,A(en,{label:"",get value(){return V()},onChange:W,get options(){return z()}}),null),Q.style.setProperty("min-width","130px"),Z.style.setProperty("display","block"),Z.style.setProperty("margin-bottom","0.5rem"),Z.style.setProperty("font-weight","500"),Z.style.setProperty("font-size","0.875rem"),a(Z,()=>t("entryBooks.fromDate","From Date")),oe.addEventListener("change",ye=>K(ye.target.value)),oe.style.setProperty("padding","0.75rem"),oe.style.setProperty("border","1px solid var(--border-color)"),oe.style.setProperty("border-radius","var(--border-radius-sm)"),oe.style.setProperty("font-family","inherit"),oe.style.setProperty("width","100%"),de.style.setProperty("min-width","130px"),re.style.setProperty("display","block"),re.style.setProperty("margin-bottom","0.5rem"),re.style.setProperty("font-weight","500"),re.style.setProperty("font-size","0.875rem"),a(re,()=>t("entryBooks.toDate","To Date")),Y.addEventListener("change",ye=>F(ye.target.value)),Y.style.setProperty("padding","0.75rem"),Y.style.setProperty("border","1px solid var(--border-color)"),Y.style.setProperty("border-radius","var(--border-radius-sm)"),Y.style.setProperty("font-family","inherit"),Y.style.setProperty("width","100%"),ce.style.setProperty("min-width","100px"),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("font-weight","500"),ue.style.setProperty("font-size","0.875rem"),a(ue,()=>t("entryBooks.order","Order")),a(ce,A(en,{label:"",get value(){return I()},onChange:E,get options(){return[{value:"desc",label:t("entryBooks.newest","Newest")},{value:"asc",label:t("entryBooks.oldest","Oldest")}]}}),null),ae.style.setProperty("display","flex"),ae.style.setProperty("align-items","end"),ae.style.setProperty("gap","0.5rem"),a(ae,A(ct,{variant:"outline",size:"sm",onClick:()=>{S("all"),x("all"),K(""),F(""),W("date"),E("desc")},get children(){return t("entryBooks.resetFilters","Reset Filters")}})),ge(()=>oe.value=b()),ge(()=>Y.value=te()),k})(),ke(()=>ke(()=>!!(m()!=="all"||N()!=="all"||b()||te()))()&&(()=>{var k=bL(),$=k.firstChild,G=$.firstChild,ne=$.nextSibling,U=ne.firstChild;return k.style.setProperty("display","flex"),k.style.setProperty("gap","0.5rem"),k.style.setProperty("align-items","center"),k.style.setProperty("margin-bottom","1rem"),k.style.setProperty("padding","0.75rem"),k.style.setProperty("background","var(--surface-color)"),k.style.setProperty("border-radius","var(--border-radius-sm)"),k.style.setProperty("border","1px solid var(--border-color)"),$.style.setProperty("font-size","0.875rem"),$.style.setProperty("font-weight","500"),a($,()=>t("entryBooks.activeFilters","Active filters"),G),a(k,(()=>{var D=ke(()=>m()!=="all");return()=>D()&&(()=>{var B=lh(),Q=B.firstChild;return B.style.setProperty("padding","0.25rem 0.5rem"),B.style.setProperty("background","var(--primary-color)"),B.style.setProperty("color","white"),B.style.setProperty("border-radius","12px"),B.style.setProperty("font-size","0.75rem"),a(B,()=>t("common.status"),Q),a(B,m,null),B})()})(),ne),a(k,(()=>{var D=ke(()=>N()!=="all");return()=>D()&&(()=>{var B=lh(),Q=B.firstChild;return B.style.setProperty("padding","0.25rem 0.5rem"),B.style.setProperty("background","var(--primary-color)"),B.style.setProperty("color","white"),B.style.setProperty("border-radius","12px"),B.style.setProperty("font-size","0.75rem"),a(B,()=>t("journal.account"),Q),a(B,()=>xr.getAccountById(N())?.name||t("common.unknown","Unknown"),null),B})()})(),ne),a(k,(()=>{var D=ke(()=>!!b());return()=>D()&&(()=>{var B=lh(),Q=B.firstChild;return B.style.setProperty("padding","0.25rem 0.5rem"),B.style.setProperty("background","var(--primary-color)"),B.style.setProperty("color","white"),B.style.setProperty("border-radius","12px"),B.style.setProperty("font-size","0.75rem"),a(B,()=>t("entryBooks.from","From"),Q),a(B,b,null),B})()})(),ne),a(k,(()=>{var D=ke(()=>!!te());return()=>D()&&(()=>{var B=lh(),Q=B.firstChild;return B.style.setProperty("padding","0.25rem 0.5rem"),B.style.setProperty("background","var(--primary-color)"),B.style.setProperty("color","white"),B.style.setProperty("border-radius","12px"),B.style.setProperty("font-size","0.75rem"),a(B,()=>t("entryBooks.to","To"),Q),a(B,te,null),B})()})(),ne),ne.style.setProperty("margin-left","auto"),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-muted)"),a(ne,()=>dn.journalEntries.length,U),a(ne,()=>t("entryBooks.entriesFound","{count} entries found").replace("{count}",dn.journalEntries.length.toString()),null),k})()),ke(()=>ke(()=>dn.journalEntries.length===0)()?A(Rt,{get title(){return t("entryBooks.noJournalEntries","No Journal Entries")},get subtitle(){return t("entryBooks.startByCreating","Start by creating your first entry")},get children(){var k=PL(),$=k.firstChild;return k.style.setProperty("text-align","center"),k.style.setProperty("color","var(--text-muted)"),k.style.setProperty("padding","2rem"),a(k,()=>t("entryBooks.noEntriesMatch","No journal entries match your current filters."),$),a(k,A(ct,{variant:"primary",style:{"margin-top":"1rem"},onClick:X,get children(){return t("entryBooks.createFirstEntry","Create First Entry")}}),null),k}}):(()=>{var k=Es();return p(k,w),a(k,A(vt,{get each(){return dn.journalEntries},children:$=>A(I7,{entry:$,onViewDetails:J})})),k})()),A(DP,{get isOpen(){return e()},onClose:se,get editEntry(){return l()}}),A(H7,{get isOpen(){return n()},onClose:()=>i(!1)}),A(J7,{get isOpen(){return o()},onClose:()=>s(!1)}),A(yL,{get isOpen(){return d()},onClose:()=>{u(!1),g(null)},get entryId(){return h()}})]}})};function tn(t){"@babel/helpers - typeof";return tn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tn(t)}var Pi=Uint8Array,io=Uint16Array,$g=Int32Array,qp=new Pi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Up=new Pi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ef=new Pi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),FP=function(t,e){for(var r=new io(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var i=new $g(r[30]),n=1;n<30;++n)for(var o=r[n];o<r[n+1];++o)i[o]=o-r[n]<<5|n;return{b:r,r:i}},OP=FP(qp,2),BP=OP.b,tf=OP.r;BP[28]=258,tf[258]=28;var VP=FP(Up,0),SL=VP.b,_1=VP.r,rf=new io(32768);for(var gn=0;gn<32768;++gn){var Sa=(gn&43690)>>1|(gn&21845)<<1;Sa=(Sa&52428)>>2|(Sa&13107)<<2,Sa=(Sa&61680)>>4|(Sa&3855)<<4,rf[gn]=((Sa&65280)>>8|(Sa&255)<<8)>>1}var ds=function(t,e,r){for(var n=t.length,i=0,o=new io(e);i<n;++i)t[i]&&++o[t[i]-1];var s=new io(e);for(i=1;i<e;++i)s[i]=s[i-1]+o[i-1]<<1;var l;if(r){l=new io(1<<e);var c=15-e;for(i=0;i<n;++i)if(t[i])for(var d=i<<4|t[i],u=e-t[i],h=s[t[i]-1]++<<u,g=h|(1<<u)-1;h<=g;++h)l[rf[h]>>c]=d}else for(l=new io(n),i=0;i<n;++i)t[i]&&(l[i]=rf[s[t[i]-1]++]>>15-t[i]);return l},Ua=new Pi(288);for(var gn=0;gn<144;++gn)Ua[gn]=8;for(var gn=144;gn<256;++gn)Ua[gn]=9;for(var gn=256;gn<280;++gn)Ua[gn]=7;for(var gn=280;gn<288;++gn)Ua[gn]=8;var iu=new Pi(32);for(var gn=0;gn<32;++gn)iu[gn]=5;var wL=ds(Ua,9,0),xL=ds(Ua,9,1),CL=ds(iu,5,0),AL=ds(iu,5,1),Qm=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},Lo=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Jm=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},Eg=function(t){return(t+7)/8|0},jP=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new Pi(t.subarray(e,r))},$L=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Mo=function(t,e,r){var n=new Error(e||$L[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,Mo),!r)throw n;return n},EL=function(t,e,r,n){var i=t.length,o=0;if(!i||e.f&&!e.l)return r||new Pi(0);var s=!r,l=s||e.i!=2,c=e.i;s&&(r=new Pi(i*3));var d=function(Q){var Z=r.length;if(Q>Z){var oe=new Pi(Math.max(Z*2,Q));oe.set(r),r=oe}},u=e.f||0,h=e.p||0,g=e.b||0,m=e.l,S=e.d,N=e.m,x=e.n,b=i*8;do{if(!m){u=Lo(t,h,1);var K=Lo(t,h+1,3);if(h+=3,K)if(K==1)m=xL,S=AL,N=9,x=5;else if(K==2){var W=Lo(t,h,31)+257,I=Lo(t,h+10,15)+4,E=W+Lo(t,h+5,31)+1;h+=14;for(var L=new Pi(E),M=new Pi(19),P=0;P<I;++P)M[ef[P]]=Lo(t,h+P*3,7);h+=I*3;for(var w=Qm(M),v=(1<<w)-1,j=ds(M,w,1),P=0;P<E;){var z=j[Lo(t,h,v)];h+=z&15;var te=z>>4;if(te<16)L[P++]=te;else{var T=0,R=0;for(te==16?(R=3+Lo(t,h,3),h+=2,T=L[P-1]):te==17?(R=3+Lo(t,h,7),h+=3):te==18&&(R=11+Lo(t,h,127),h+=7);R--;)L[P++]=T}}var J=L.subarray(0,W),X=L.subarray(W);N=Qm(J),x=Qm(X),m=ds(J,N,1),S=ds(X,x,1)}else Mo(1);else{var te=Eg(h)+4,F=t[te-4]|t[te-3]<<8,V=te+F;if(V>i){c&&Mo(0);break}l&&d(g+F),r.set(t.subarray(te,V),g),e.b=g+=F,e.p=h=V*8,e.f=u;continue}if(h>b){c&&Mo(0);break}}l&&d(g+131072);for(var H=(1<<N)-1,se=(1<<x)-1,O=h;;O=h){var T=m[Jm(t,h)&H],_=T>>4;if(h+=T&15,h>b){c&&Mo(0);break}if(T||Mo(2),_<256)r[g++]=_;else if(_==256){O=h,m=null;break}else{var k=_-254;if(_>264){var P=_-257,$=qp[P];k=Lo(t,h,(1<<$)-1)+BP[P],h+=$}var G=S[Jm(t,h)&se],ne=G>>4;G||Mo(3),h+=G&15;var X=SL[ne];if(ne>3){var $=Up[ne];X+=Jm(t,h)&(1<<$)-1,h+=$}if(h>b){c&&Mo(0);break}l&&d(g+131072);var U=g+k;if(g<X){var D=o-X,B=Math.min(X,U);for(D+g<0&&Mo(3);g<B;++g)r[g]=n[D+g]}for(;g<U;++g)r[g]=r[g-X]}}e.l=m,e.p=O,e.b=g,e.f=u,m&&(u=1,e.m=N,e.d=S,e.n=x)}while(!u);return g!=r.length&&s?jP(r,0,g):r.subarray(0,g)},Is=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},bd=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},Xm=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var i=r.length,o=r.slice();if(!i)return{t:qP,l:0};if(i==1){var s=new Pi(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(V,W){return V.f-W.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],d=0,u=1,h=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};u!=i-1;)l=r[r[d].f<r[h].f?d++:h++],c=r[d!=u&&r[d].f<r[h].f?d++:h++],r[u++]={s:-1,f:l.f+c.f,l,r:c};for(var g=o[0].s,n=1;n<i;++n)o[n].s>g&&(g=o[n].s);var m=new io(g+1),S=nf(r[u-1],m,0);if(S>e){var n=0,N=0,x=S-e,b=1<<x;for(o.sort(function(W,I){return m[I.s]-m[W.s]||W.f-I.f});n<i;++n){var K=o[n].s;if(m[K]>e)N+=b-(1<<S-m[K]),m[K]=e;else break}for(N>>=x;N>0;){var te=o[n].s;m[te]<e?N-=1<<e-m[te]++-1:++n}for(;n>=0&&N;--n){var F=o[n].s;m[F]==e&&(--m[F],++N)}S=e}return{t:new Pi(m),l:S}},nf=function(t,e,r){return t.s==-1?Math.max(nf(t.l,e,r+1),nf(t.r,e,r+1)):e[t.s]=r},S1=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new io(++e),n=0,i=t[0],o=1,s=function(c){r[n++]=c},l=1;l<=e;++l)if(t[l]==i&&l!=e)++o;else{if(!i&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(i),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(i);o=1,i=t[l]}return{c:r.subarray(0,n),n:e}},Pd=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},zP=function(t,e,r){var n=r.length,i=Eg(e+2);t[i]=n&255,t[i+1]=n>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var o=0;o<n;++o)t[i+o+4]=r[o];return(i+4+n)*8},w1=function(t,e,r,n,i,o,s,l,c,d,u){Is(e,u++,r),++i[256];for(var h=Xm(i,15),g=h.t,m=h.l,S=Xm(o,15),N=S.t,x=S.l,b=S1(g),K=b.c,te=b.n,F=S1(N),V=F.c,W=F.n,I=new io(19),E=0;E<K.length;++E)++I[K[E]&31];for(var E=0;E<V.length;++E)++I[V[E]&31];for(var L=Xm(I,7),M=L.t,P=L.l,w=19;w>4&&!M[ef[w-1]];--w);var v=d+5<<3,j=Pd(i,Ua)+Pd(o,iu)+s,z=Pd(i,g)+Pd(o,N)+s+14+3*w+Pd(I,M)+2*I[16]+3*I[17]+7*I[18];if(c>=0&&v<=j&&v<=z)return zP(e,u,t.subarray(c,c+d));var T,R,J,X;if(Is(e,u,1+(z<j)),u+=2,z<j){T=ds(g,m,0),R=g,J=ds(N,x,0),X=N;var H=ds(M,P,0);Is(e,u,te-257),Is(e,u+5,W-1),Is(e,u+10,w-4),u+=14;for(var E=0;E<w;++E)Is(e,u+3*E,M[ef[E]]);u+=3*w;for(var se=[K,V],O=0;O<2;++O)for(var _=se[O],E=0;E<_.length;++E){var k=_[E]&31;Is(e,u,H[k]),u+=M[k],k>15&&(Is(e,u,_[E]>>5&127),u+=_[E]>>12)}}else T=wL,R=Ua,J=CL,X=iu;for(var E=0;E<l;++E){var $=n[E];if($>255){var k=$>>18&31;bd(e,u,T[k+257]),u+=R[k+257],k>7&&(Is(e,u,$>>23&31),u+=qp[k]);var G=$&31;bd(e,u,J[G]),u+=X[G],G>3&&(bd(e,u,$>>5&8191),u+=Up[G])}else bd(e,u,T[$]),u+=R[$]}return bd(e,u,T[256]),u+R[256]},IL=new $g([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),qP=new Pi(0),TL=function(t,e,r,n,i,o){var s=o.z||t.length,l=new Pi(n+s+5*(1+Math.ceil(s/7e3))+i),c=l.subarray(n,l.length-i),d=o.l,u=(o.r||0)&7;if(e){u&&(c[0]=o.r>>3);for(var h=IL[e-1],g=h>>13,m=h&8191,S=(1<<r)-1,N=o.p||new io(32768),x=o.h||new io(S+1),b=Math.ceil(r/3),K=2*b,te=function(de){return(t[de]^t[de+1]<<b^t[de+2]<<K)&S},F=new $g(25e3),V=new io(288),W=new io(32),I=0,E=0,L=o.i||0,M=0,P=o.w||0,w=0;L+2<s;++L){var v=te(L),j=L&32767,z=x[v];if(N[j]=z,x[v]=j,P<=L){var T=s-L;if((I>7e3||M>24576)&&(T>423||!d)){u=w1(t,c,0,F,V,W,E,M,w,L-w,u),M=I=E=0,w=L;for(var R=0;R<286;++R)V[R]=0;for(var R=0;R<30;++R)W[R]=0}var J=2,X=0,H=m,se=j-z&32767;if(T>2&&v==te(L-se))for(var O=Math.min(g,T)-1,_=Math.min(32767,L),k=Math.min(258,T);se<=_&&--H&&j!=z;){if(t[L+J]==t[L+J-se]){for(var $=0;$<k&&t[L+$]==t[L+$-se];++$);if($>J){if(J=$,X=se,$>O)break;for(var G=Math.min(se,$-2),ne=0,R=0;R<G;++R){var U=L-se+R&32767,D=N[U],B=U-D&32767;B>ne&&(ne=B,z=U)}}}j=z,z=N[j],se+=j-z&32767}if(X){F[M++]=268435456|tf[J]<<18|_1[X];var Q=tf[J]&31,Z=_1[X]&31;E+=qp[Q]+Up[Z],++V[257+Q],++W[Z],P=L+J,++I}else F[M++]=t[L],++V[t[L]]}}for(L=Math.max(L,P);L<s;++L)F[M++]=t[L],++V[t[L]];u=w1(t,c,d,F,V,W,E,M,w,L-w,u),d||(o.r=u&7|c[u/8|0]<<3,u-=7,o.h=x,o.p=N,o.i=L,o.w=P)}else{for(var L=o.w||0;L<s+d;L+=65535){var oe=L+65535;oe>=s&&(c[u/8|0]=d,oe=s),u=zP(c,u+1,t.subarray(L,oe))}o.i=s}return jP(l,0,n+Eg(u)+i)},UP=function(){var t=1,e=0;return{p:function(r){for(var n=t,i=e,o=r.length|0,s=0;s!=o;){for(var l=Math.min(s+2655,o);s<l;++s)i+=n+=r[s];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}t=n,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},kL=function(t,e,r,n,i){if(!i&&(i={l:1},e.dictionary)){var o=e.dictionary.subarray(-32768),s=new Pi(o.length+t.length);s.set(o),s.set(t,o.length),t=s,i.w=o.length}return TL(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,i)},HP=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},NL=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=UP();i.p(e.dictionary),HP(t,2,i.d())}},LL=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&Mo(6,"invalid zlib data"),(t[1]>>5&1)==1&&Mo(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function of(t,e){e||(e={});var r=UP();r.p(t);var n=kL(t,e,e.dictionary?6:2,4);return NL(n,e),HP(n,n.length-4,r.d()),n}function RL(t,e){return EL(t.subarray(LL(t),-4),{i:2},e,e)}var DL=typeof TextDecoder<"u"&&new TextDecoder,ML=0;try{DL.decode(qP,{stream:!0}),ML=1}catch{}var ur=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Zm(){ur.console&&typeof ur.console.log=="function"&&ur.console.log.apply(ur.console,arguments)}var ln={log:Zm,warn:function(t){ur.console&&(typeof ur.console.warn=="function"?ur.console.warn.apply(ur.console,arguments):Zm.call(null,arguments))},error:function(t){ur.console&&(typeof ur.console.error=="function"?ur.console.error.apply(ur.console,arguments):Zm(t))}};function ey(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){hl(n.response,e,r)},n.onerror=function(){ln.error("could not download file")},n.send()}function x1(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function ch(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var Od,sf,hl=ur.saveAs||((typeof window>"u"?"undefined":tn(window))!=="object"||window!==ur?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=ur.URL||ur.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?x1(i.href)?ey(t,e,r):ch(i,i.target="_blank"):ch(i)):(i.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){ch(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(x1(t))ey(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){ch(n)})}else navigator.msSaveOrOpenBlob(function(i,o){return o===void 0?o={autoBom:!1}:tn(o)!=="object"&&(ln.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return ey(t,e,r);var i=t.type==="application/octet-stream",o=/constructor/i.test(ur.HTMLElement)||ur.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&o)&&(typeof FileReader>"u"?"undefined":tn(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var u=l.result;u=s?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},l.readAsDataURL(t)}else{var c=ur.URL||ur.webkitURL,d=c.createObjectURL(t);n?n.location=d:location.href=d,n=null,setTimeout(function(){c.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function GP(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,o=r[n].process,s=i.exec(t);s&&(e=o(s),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),d=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),"#"+l+c+d}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function ty(t,e){var r=t[0],n=t[1],i=t[2],o=t[3];r=ui(r,n,i,o,e[0],7,-680876936),o=ui(o,r,n,i,e[1],12,-389564586),i=ui(i,o,r,n,e[2],17,606105819),n=ui(n,i,o,r,e[3],22,-1044525330),r=ui(r,n,i,o,e[4],7,-176418897),o=ui(o,r,n,i,e[5],12,1200080426),i=ui(i,o,r,n,e[6],17,-1473231341),n=ui(n,i,o,r,e[7],22,-45705983),r=ui(r,n,i,o,e[8],7,1770035416),o=ui(o,r,n,i,e[9],12,-1958414417),i=ui(i,o,r,n,e[10],17,-42063),n=ui(n,i,o,r,e[11],22,-1990404162),r=ui(r,n,i,o,e[12],7,1804603682),o=ui(o,r,n,i,e[13],12,-40341101),i=ui(i,o,r,n,e[14],17,-1502002290),r=hi(r,n=ui(n,i,o,r,e[15],22,1236535329),i,o,e[1],5,-165796510),o=hi(o,r,n,i,e[6],9,-1069501632),i=hi(i,o,r,n,e[11],14,643717713),n=hi(n,i,o,r,e[0],20,-373897302),r=hi(r,n,i,o,e[5],5,-701558691),o=hi(o,r,n,i,e[10],9,38016083),i=hi(i,o,r,n,e[15],14,-660478335),n=hi(n,i,o,r,e[4],20,-405537848),r=hi(r,n,i,o,e[9],5,568446438),o=hi(o,r,n,i,e[14],9,-1019803690),i=hi(i,o,r,n,e[3],14,-187363961),n=hi(n,i,o,r,e[8],20,1163531501),r=hi(r,n,i,o,e[13],5,-1444681467),o=hi(o,r,n,i,e[2],9,-51403784),i=hi(i,o,r,n,e[7],14,1735328473),r=pi(r,n=hi(n,i,o,r,e[12],20,-1926607734),i,o,e[5],4,-378558),o=pi(o,r,n,i,e[8],11,-2022574463),i=pi(i,o,r,n,e[11],16,1839030562),n=pi(n,i,o,r,e[14],23,-35309556),r=pi(r,n,i,o,e[1],4,-1530992060),o=pi(o,r,n,i,e[4],11,1272893353),i=pi(i,o,r,n,e[7],16,-155497632),n=pi(n,i,o,r,e[10],23,-1094730640),r=pi(r,n,i,o,e[13],4,681279174),o=pi(o,r,n,i,e[0],11,-358537222),i=pi(i,o,r,n,e[3],16,-722521979),n=pi(n,i,o,r,e[6],23,76029189),r=pi(r,n,i,o,e[9],4,-640364487),o=pi(o,r,n,i,e[12],11,-421815835),i=pi(i,o,r,n,e[15],16,530742520),r=mi(r,n=pi(n,i,o,r,e[2],23,-995338651),i,o,e[0],6,-198630844),o=mi(o,r,n,i,e[7],10,1126891415),i=mi(i,o,r,n,e[14],15,-1416354905),n=mi(n,i,o,r,e[5],21,-57434055),r=mi(r,n,i,o,e[12],6,1700485571),o=mi(o,r,n,i,e[3],10,-1894986606),i=mi(i,o,r,n,e[10],15,-1051523),n=mi(n,i,o,r,e[1],21,-2054922799),r=mi(r,n,i,o,e[8],6,1873313359),o=mi(o,r,n,i,e[15],10,-30611744),i=mi(i,o,r,n,e[6],15,-1560198380),n=mi(n,i,o,r,e[13],21,1309151649),r=mi(r,n,i,o,e[4],6,-145523070),o=mi(o,r,n,i,e[11],10,-1120210379),i=mi(i,o,r,n,e[2],15,718787259),n=mi(n,i,o,r,e[9],21,-343485551),t[0]=Ta(r,t[0]),t[1]=Ta(n,t[1]),t[2]=Ta(i,t[2]),t[3]=Ta(o,t[3])}function Hp(t,e,r,n,i,o){return e=Ta(Ta(e,t),Ta(n,o)),Ta(e<<i|e>>>32-i,r)}function ui(t,e,r,n,i,o,s){return Hp(e&r|~e&n,t,e,i,o,s)}function hi(t,e,r,n,i,o,s){return Hp(e&n|r&~n,t,e,i,o,s)}function pi(t,e,r,n,i,o,s){return Hp(e^r^n,t,e,i,o,s)}function mi(t,e,r,n,i,o,s){return Hp(r^(e|~n),t,e,i,o,s)}function WP(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)ty(n,FL(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(ty(n,i),e=0;e<16;e++)i[e]=0;return i[14]=8*r,ty(n,i),n}function FL(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}Od=ur.atob.bind(ur),sf=ur.btoa.bind(ur);var C1="0123456789abcdef".split("");function OL(t){for(var e="",r=0;r<4;r++)e+=C1[t>>8*r+4&15]+C1[t>>8*r&15];return e}function BL(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function af(t){return WP(t).map(BL).join("")}var VL=function(t){for(var e=0;e<t.length;e++)t[e]=OL(t[e]);return t.join("")}(WP("hello"))!="5d41402abc4b2a76b9719d911017c592";function Ta(t,e){if(VL){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function lf(t,e){var r,n,i,o;if(t!==r){for(var s=(i=t,o=1+(256/t.length>>0),new Array(o+1).join(i)),l=[],c=0;c<256;c++)l[c]=c;var d=0;for(c=0;c<256;c++){var u=l[c];d=(d+u+s.charCodeAt(c))%256,l[c]=l[d],l[d]=u}r=t,n=l}else l=n;var h=e.length,g=0,m=0,S="";for(c=0;c<h;c++)m=(m+(u=l[g=(g+1)%256]))%256,l[g]=l[m],l[m]=u,s=l[(l[g]+l[m])%256],S+=String.fromCharCode(e.charCodeAt(c)^s);return S}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var A1={print:4,modify:8,copy:16,"annot-forms":32};function gc(t,e,r,n){this.v=1,this.r=2;var i=192;t.forEach(function(l){if(A1.perm!==void 0)throw new Error("Invalid permission: "+l);i+=A1[l]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var o=(e+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,s),this.P=-(1+(255^i)),this.encryptionKey=af(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=lf(this.encryptionKey,this.padding)}function vc(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var i=t.charCodeAt(n);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?e+="#"+("0"+i.toString(16)).slice(-2):e+=t[n]}return e}function $1(t){if(tn(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var o=Math.random().toString(35);return e[r][o]=[n,!!i],o},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var o in e[r]){var s=e[r][o];try{s[0].apply(t,n)}catch(l){ur.console&&ln.error("jsPDF PubSub Error",l.message,l)}s[1]&&i.push(o)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function ou(t){if(!(this instanceof ou))return new ou(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function YP(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Ea(t,e,r,n,i){if(!(this instanceof Ea))return new Ea(t,e,r,n,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,YP.call(this,n,i)}function Pl(t,e,r,n,i){if(!(this instanceof Pl))return new Pl(t,e,r,n,i);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,YP.call(this,n,i)}function cr(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],o=arguments[3],s=[],l=1,c=16,d="S",u=null;tn(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,i=t.format||i,o=t.compress||t.compressPdf||o,(u=t.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),d=t.defaultPathOperation||"S"),s=t.filters||(o===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var h=t.putOnlyUsedFonts||!1,g={},m={internal:{},__private__:{}};m.__private__.PubSub=$1;var S="1.3",N=m.__private__.getPdfVersion=function(){return S};m.__private__.setPdfVersion=function(q){S=q};var x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return x};var b=m.__private__.getPageFormat=function(q){return x[q]};i=i||"a4";var K={COMPAT:"compat",ADVANCED:"advanced"},te=K.COMPAT;function F(){this.saveGraphicsState(),Y(new mt(je,0,0,-je,0,ci()*je).toString()+" cm"),this.setFontSize(this.getFontSize()/je),d="n",te=K.ADVANCED}function V(){this.restoreGraphicsState(),d="S",te=K.COMPAT}var W=m.__private__.combineFontStyleAndFontWeight=function(q,be){if(q=="bold"&&be=="normal"||q=="bold"&&be==400||q=="normal"&&be=="italic"||q=="bold"&&be=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return be&&(q=be==400||be==="normal"?q==="italic"?"italic":"normal":be!=700&&be!=="bold"||q!=="normal"?(be==700?"bold":be)+""+q:"bold"),q};m.advancedAPI=function(q){var be=te===K.COMPAT;return be&&F.call(this),typeof q!="function"||(q(this),be&&V.call(this)),this},m.compatAPI=function(q){var be=te===K.ADVANCED;return be&&V.call(this),typeof q!="function"||(q(this),be&&F.call(this)),this},m.isAdvancedAPI=function(){return te===K.ADVANCED};var I,E=function(q){if(te!==K.ADVANCED)throw new Error(q+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},L=m.roundToPrecision=m.__private__.roundToPrecision=function(q,be){var Oe=e||be;if(isNaN(q)||isNaN(Oe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return q.toFixed(Oe).replace(/0+$/,"")};I=m.hpf=m.__private__.hpf=typeof c=="number"?function(q){if(isNaN(q))throw new Error("Invalid argument passed to jsPDF.hpf");return L(q,c)}:c==="smart"?function(q){if(isNaN(q))throw new Error("Invalid argument passed to jsPDF.hpf");return L(q,q>-1&&q<1?16:5)}:function(q){if(isNaN(q))throw new Error("Invalid argument passed to jsPDF.hpf");return L(q,16)};var M=m.f2=m.__private__.f2=function(q){if(isNaN(q))throw new Error("Invalid argument passed to jsPDF.f2");return L(q,2)},P=m.__private__.f3=function(q){if(isNaN(q))throw new Error("Invalid argument passed to jsPDF.f3");return L(q,3)},w=m.scale=m.__private__.scale=function(q){if(isNaN(q))throw new Error("Invalid argument passed to jsPDF.scale");return te===K.COMPAT?q*je:te===K.ADVANCED?q:void 0},v=function(q){return te===K.COMPAT?ci()-q:te===K.ADVANCED?q:void 0},j=function(q){return w(v(q))};m.__private__.setPrecision=m.setPrecision=function(q){typeof parseInt(q,10)=="number"&&(e=parseInt(q,10))};var z,T="00000000000000000000000000000000",R=m.__private__.getFileId=function(){return T},J=m.__private__.setFileId=function(q){return T=q!==void 0&&/^[a-fA-F0-9]{32}$/.test(q)?q.toUpperCase():T.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(yn=new gc(u.userPermissions,u.userPassword,u.ownerPassword,T)),T};m.setFileId=function(q){return J(q),this},m.getFileId=function(){return R()};var X=m.__private__.convertDateToPDFDate=function(q){var be=q.getTimezoneOffset(),Oe=be<0?"+":"-",Ue=Math.floor(Math.abs(be/60)),Ze=Math.abs(be%60),ht=[Oe,k(Ue),"'",k(Ze),"'"].join("");return["D:",q.getFullYear(),k(q.getMonth()+1),k(q.getDate()),k(q.getHours()),k(q.getMinutes()),k(q.getSeconds()),ht].join("")},H=m.__private__.convertPDFDateToDate=function(q){var be=parseInt(q.substr(2,4),10),Oe=parseInt(q.substr(6,2),10)-1,Ue=parseInt(q.substr(8,2),10),Ze=parseInt(q.substr(10,2),10),ht=parseInt(q.substr(12,2),10),It=parseInt(q.substr(14,2),10);return new Date(be,Oe,Ue,Ze,ht,It,0)},se=m.__private__.setCreationDate=function(q){var be;if(q===void 0&&(q=new Date),q instanceof Date)be=X(q);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(q))throw new Error("Invalid argument passed to jsPDF.setCreationDate");be=q}return z=be},O=m.__private__.getCreationDate=function(q){var be=z;return q==="jsDate"&&(be=H(z)),be};m.setCreationDate=function(q){return se(q),this},m.getCreationDate=function(q){return O(q)};var _,k=m.__private__.padd2=function(q){return("0"+parseInt(q)).slice(-2)},$=m.__private__.padd2Hex=function(q){return("00"+(q=q.toString())).substr(q.length)},G=0,ne=[],U=[],D=0,B=[],Q=[],Z=!1,oe=U,de=function(){G=0,D=0,U=[],ne=[],B=[],bt=dt(),Mt=dt()};m.__private__.setCustomOutputDestination=function(q){Z=!0,oe=q};var re=function(q){Z||(oe=q)};m.__private__.resetCustomOutputDestination=function(){Z=!1,oe=U};var Y=m.__private__.out=function(q){return q=q.toString(),D+=q.length+1,oe.push(q),oe},ce=m.__private__.write=function(q){return Y(arguments.length===1?q.toString():Array.prototype.join.call(arguments," "))},ue=m.__private__.getArrayBuffer=function(q){for(var be=q.length,Oe=new ArrayBuffer(be),Ue=new Uint8Array(Oe);be--;)Ue[be]=q.charCodeAt(be);return Oe},ae=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return ae};var ye=t.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(q){return ye=te===K.ADVANCED?q/je:q,this};var me,pe=m.__private__.getFontSize=m.getFontSize=function(){return te===K.COMPAT?ye:ye*je},ve=t.R2L||!1;m.__private__.setR2L=m.setR2L=function(q){return ve=q,this},m.__private__.getR2L=m.getR2L=function(){return ve};var Ne,Ie=m.__private__.setZoomMode=function(q){var be=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(q))me=q;else if(isNaN(q)){if(be.indexOf(q)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+q+'" is not recognized.');me=q}else me=parseInt(q,10)};m.__private__.getZoomMode=function(){return me};var Ce,Ee=m.__private__.setPageMode=function(q){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(q)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+q+'" is not recognized.');Ne=q};m.__private__.getPageMode=function(){return Ne};var we=m.__private__.setLayoutMode=function(q){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(q)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+q+'" is not recognized.');Ce=q};m.__private__.getLayoutMode=function(){return Ce},m.__private__.setDisplayMode=m.setDisplayMode=function(q,be,Oe){return Ie(q),we(be),Ee(Oe),this};var Re={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(q){if(Object.keys(Re).indexOf(q)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Re[q]},m.__private__.getDocumentProperties=function(){return Re},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(q){for(var be in Re)Re.hasOwnProperty(be)&&q[be]&&(Re[be]=q[be]);return this},m.__private__.setDocumentProperty=function(q,be){if(Object.keys(Re).indexOf(q)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Re[q]=be};var He,je,Ve,qe,tt,rt={},Be={},Ge=[],Fe={},at={},lt={},Xe={},Ct=null,Le=0,nt=[],We=new $1(m),kt=t.hotfixes||[],Et={},Ot={},jt=[],mt=function q(be,Oe,Ue,Ze,ht,It){if(!(this instanceof q))return new q(be,Oe,Ue,Ze,ht,It);isNaN(be)&&(be=1),isNaN(Oe)&&(Oe=0),isNaN(Ue)&&(Ue=0),isNaN(Ze)&&(Ze=1),isNaN(ht)&&(ht=0),isNaN(It)&&(It=0),this._matrix=[be,Oe,Ue,Ze,ht,It]};Object.defineProperty(mt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(q){this._matrix[0]=q}}),Object.defineProperty(mt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(q){this._matrix[1]=q}}),Object.defineProperty(mt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(q){this._matrix[2]=q}}),Object.defineProperty(mt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(q){this._matrix[3]=q}}),Object.defineProperty(mt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(q){this._matrix[4]=q}}),Object.defineProperty(mt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(q){this._matrix[5]=q}}),Object.defineProperty(mt.prototype,"a",{get:function(){return this._matrix[0]},set:function(q){this._matrix[0]=q}}),Object.defineProperty(mt.prototype,"b",{get:function(){return this._matrix[1]},set:function(q){this._matrix[1]=q}}),Object.defineProperty(mt.prototype,"c",{get:function(){return this._matrix[2]},set:function(q){this._matrix[2]=q}}),Object.defineProperty(mt.prototype,"d",{get:function(){return this._matrix[3]},set:function(q){this._matrix[3]=q}}),Object.defineProperty(mt.prototype,"e",{get:function(){return this._matrix[4]},set:function(q){this._matrix[4]=q}}),Object.defineProperty(mt.prototype,"f",{get:function(){return this._matrix[5]},set:function(q){this._matrix[5]=q}}),Object.defineProperty(mt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(mt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(mt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(mt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),mt.prototype.join=function(q){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(I).join(q)},mt.prototype.multiply=function(q){var be=q.sx*this.sx+q.shy*this.shx,Oe=q.sx*this.shy+q.shy*this.sy,Ue=q.shx*this.sx+q.sy*this.shx,Ze=q.shx*this.shy+q.sy*this.sy,ht=q.tx*this.sx+q.ty*this.shx+this.tx,It=q.tx*this.shy+q.ty*this.sy+this.ty;return new mt(be,Oe,Ue,Ze,ht,It)},mt.prototype.decompose=function(){var q=this.sx,be=this.shy,Oe=this.shx,Ue=this.sy,Ze=this.tx,ht=this.ty,It=Math.sqrt(q*q+be*be),qt=(q/=It)*Oe+(be/=It)*Ue;Oe-=q*qt,Ue-=be*qt;var f=Math.sqrt(Oe*Oe+Ue*Ue);return qt/=f,q*(Ue/=f)<be*(Oe/=f)&&(q=-q,be=-be,qt=-qt,It=-It),{scale:new mt(It,0,0,f,0,0),translate:new mt(1,0,0,1,Ze,ht),rotate:new mt(q,be,-be,q,0,0),skew:new mt(1,0,qt,1,0,0)}},mt.prototype.toString=function(q){return this.join(" ")},mt.prototype.inversed=function(){var q=this.sx,be=this.shy,Oe=this.shx,Ue=this.sy,Ze=this.tx,ht=this.ty,It=1/(q*Ue-be*Oe),qt=Ue*It,f=-be*It,ie=-Oe*It,fe=q*It;return new mt(qt,f,ie,fe,-qt*Ze-ie*ht,-f*Ze-fe*ht)},mt.prototype.applyToPoint=function(q){var be=q.x*this.sx+q.y*this.shx+this.tx,Oe=q.x*this.shy+q.y*this.sy+this.ty;return new gs(be,Oe)},mt.prototype.applyToRectangle=function(q){var be=this.applyToPoint(q),Oe=this.applyToPoint(new gs(q.x+q.w,q.y+q.h));return new ra(be.x,be.y,Oe.x-be.x,Oe.y-be.y)},mt.prototype.clone=function(){var q=this.sx,be=this.shy,Oe=this.shx,Ue=this.sy,Ze=this.tx,ht=this.ty;return new mt(q,be,Oe,Ue,Ze,ht)},m.Matrix=mt;var Zt=m.matrixMult=function(q,be){return be.multiply(q)},rr=new mt(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=rr;var Dt=function(q,be){if(!at[q]){var Oe=(be instanceof Ea?"Sh":"P")+(Object.keys(Fe).length+1).toString(10);be.id=Oe,at[q]=Oe,Fe[Oe]=be,We.publish("addPattern",be)}};m.ShadingPattern=Ea,m.TilingPattern=Pl,m.addShadingPattern=function(q,be){return E("addShadingPattern()"),Dt(q,be),this},m.beginTilingPattern=function(q){E("beginTilingPattern()"),na(q.boundingBox[0],q.boundingBox[1],q.boundingBox[2]-q.boundingBox[0],q.boundingBox[3]-q.boundingBox[1],q.matrix)},m.endTilingPattern=function(q,be){E("endTilingPattern()"),be.stream=Q[_].join(`
`),Dt(q,be),We.publish("endTilingPattern",be),jt.pop().restore()};var Kt=m.__private__.newObject=function(){var q=dt();return pt(q,!0),q},dt=m.__private__.newObjectDeferred=function(){return G++,ne[G]=function(){return D},G},pt=function(q,be){return be=typeof be=="boolean"&&be,ne[q]=D,be&&Y(q+" 0 obj"),q},ze=m.__private__.newAdditionalObject=function(){var q={objId:dt(),content:""};return B.push(q),q},bt=dt(),Mt=dt(),ft=m.__private__.decodeColorString=function(q){var be=q.split(" ");if(be.length!==2||be[1]!=="g"&&be[1]!=="G")be.length===5&&(be[4]==="k"||be[4]==="K")&&(be=[(1-be[0])*(1-be[3]),(1-be[1])*(1-be[3]),(1-be[2])*(1-be[3]),"r"]);else{var Oe=parseFloat(be[0]);be=[Oe,Oe,Oe,"r"]}for(var Ue="#",Ze=0;Ze<3;Ze++)Ue+=("0"+Math.floor(255*parseFloat(be[Ze])).toString(16)).slice(-2);return Ue},At=m.__private__.encodeColorString=function(q){var be;typeof q=="string"&&(q={ch1:q});var Oe=q.ch1,Ue=q.ch2,Ze=q.ch3,ht=q.ch4,It=q.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Oe=="string"&&Oe.charAt(0)!=="#"){var qt=new GP(Oe);if(qt.ok)Oe=qt.toHex();else if(!/^\d*\.?\d*$/.test(Oe))throw new Error('Invalid color "'+Oe+'" passed to jsPDF.encodeColorString.')}if(typeof Oe=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Oe)&&(Oe="#"+Oe[1]+Oe[1]+Oe[2]+Oe[2]+Oe[3]+Oe[3]),typeof Oe=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Oe)){var f=parseInt(Oe.substr(1),16);Oe=f>>16&255,Ue=f>>8&255,Ze=255&f}if(Ue===void 0||ht===void 0&&Oe===Ue&&Ue===Ze)if(typeof Oe=="string")be=Oe+" "+It[0];else switch(q.precision){case 2:be=M(Oe/255)+" "+It[0];break;case 3:default:be=P(Oe/255)+" "+It[0]}else if(ht===void 0||tn(ht)==="object"){if(ht&&!isNaN(ht.a)&&ht.a===0)return be=["1.","1.","1.",It[1]].join(" ");if(typeof Oe=="string")be=[Oe,Ue,Ze,It[1]].join(" ");else switch(q.precision){case 2:be=[M(Oe/255),M(Ue/255),M(Ze/255),It[1]].join(" ");break;default:case 3:be=[P(Oe/255),P(Ue/255),P(Ze/255),It[1]].join(" ")}}else if(typeof Oe=="string")be=[Oe,Ue,Ze,ht,It[2]].join(" ");else switch(q.precision){case 2:be=[M(Oe),M(Ue),M(Ze),M(ht),It[2]].join(" ");break;case 3:default:be=[P(Oe),P(Ue),P(Ze),P(ht),It[2]].join(" ")}return be},Ht=m.__private__.getFilters=function(){return s},Yt=m.__private__.putStream=function(q){var be=(q=q||{}).data||"",Oe=q.filters||Ht(),Ue=q.alreadyAppliedFilters||[],Ze=q.addLength1||!1,ht=be.length,It=q.objectId,qt=function(Pr){return Pr};if(u!==null&&It===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(qt=yn.encryptor(It,0));var f={};Oe===!0&&(Oe=["FlateEncode"]);var ie=q.additionalKeyValues||[],fe=(f=cr.API.processDataByFilters!==void 0?cr.API.processDataByFilters(be,Oe):{data:be,reverseChain:[]}).reverseChain+(Array.isArray(Ue)?Ue.join(" "):Ue.toString());if(f.data.length!==0&&(ie.push({key:"Length",value:f.data.length}),Ze===!0&&ie.push({key:"Length1",value:ht})),fe.length!=0)if(fe.split("/").length-1==1)ie.push({key:"Filter",value:fe});else{ie.push({key:"Filter",value:"["+fe+"]"});for(var Ae=0;Ae<ie.length;Ae+=1)if(ie[Ae].key==="DecodeParms"){for(var Je=[],st=0;st<f.reverseChain.split("/").length-1;st+=1)Je.push("null");Je.push(ie[Ae].value),ie[Ae].value="["+Je.join(" ")+"]"}}Y("<<");for(var Tt=0;Tt<ie.length;Tt++)Y("/"+ie[Tt].key+" "+ie[Tt].value);Y(">>"),f.data.length!==0&&(Y("stream"),Y(qt(f.data)),Y("endstream"))},nr=m.__private__.putPage=function(q){var be=q.number,Oe=q.data,Ue=q.objId,Ze=q.contentsObjId;pt(Ue,!0),Y("<</Type /Page"),Y("/Parent "+q.rootDictionaryObjId+" 0 R"),Y("/Resources "+q.resourceDictionaryObjId+" 0 R"),Y("/MediaBox ["+parseFloat(I(q.mediaBox.bottomLeftX))+" "+parseFloat(I(q.mediaBox.bottomLeftY))+" "+I(q.mediaBox.topRightX)+" "+I(q.mediaBox.topRightY)+"]"),q.cropBox!==null&&Y("/CropBox ["+I(q.cropBox.bottomLeftX)+" "+I(q.cropBox.bottomLeftY)+" "+I(q.cropBox.topRightX)+" "+I(q.cropBox.topRightY)+"]"),q.bleedBox!==null&&Y("/BleedBox ["+I(q.bleedBox.bottomLeftX)+" "+I(q.bleedBox.bottomLeftY)+" "+I(q.bleedBox.topRightX)+" "+I(q.bleedBox.topRightY)+"]"),q.trimBox!==null&&Y("/TrimBox ["+I(q.trimBox.bottomLeftX)+" "+I(q.trimBox.bottomLeftY)+" "+I(q.trimBox.topRightX)+" "+I(q.trimBox.topRightY)+"]"),q.artBox!==null&&Y("/ArtBox ["+I(q.artBox.bottomLeftX)+" "+I(q.artBox.bottomLeftY)+" "+I(q.artBox.topRightX)+" "+I(q.artBox.topRightY)+"]"),typeof q.userUnit=="number"&&q.userUnit!==1&&Y("/UserUnit "+q.userUnit),We.publish("putPage",{objId:Ue,pageContext:nt[be],pageNumber:be,page:Oe}),Y("/Contents "+Ze+" 0 R"),Y(">>"),Y("endobj");var ht=Oe.join(`
`);return te===K.ADVANCED&&(ht+=`
Q`),pt(Ze,!0),Yt({data:ht,filters:Ht(),objectId:Ze}),Y("endobj"),Ue},Dr=m.__private__.putPages=function(){var q,be,Oe=[];for(q=1;q<=Le;q++)nt[q].objId=dt(),nt[q].contentsObjId=dt();for(q=1;q<=Le;q++)Oe.push(nr({number:q,data:Q[q],objId:nt[q].objId,contentsObjId:nt[q].contentsObjId,mediaBox:nt[q].mediaBox,cropBox:nt[q].cropBox,bleedBox:nt[q].bleedBox,trimBox:nt[q].trimBox,artBox:nt[q].artBox,userUnit:nt[q].userUnit,rootDictionaryObjId:bt,resourceDictionaryObjId:Mt}));pt(bt,!0),Y("<</Type /Pages");var Ue="/Kids [";for(be=0;be<Le;be++)Ue+=Oe[be]+" 0 R ";Y(Ue+"]"),Y("/Count "+Le),Y(">>"),Y("endobj"),We.publish("postPutPages")},vr=function(q){We.publish("putFont",{font:q,out:Y,newObject:Kt,putStream:Yt}),q.isAlreadyPutted!==!0&&(q.objectNumber=Kt(),Y("<<"),Y("/Type /Font"),Y("/BaseFont /"+vc(q.postScriptName)),Y("/Subtype /Type1"),typeof q.encoding=="string"&&Y("/Encoding /"+q.encoding),Y("/FirstChar 32"),Y("/LastChar 255"),Y(">>"),Y("endobj"))},tr=function(){for(var q in rt)rt.hasOwnProperty(q)&&(h===!1||h===!0&&g.hasOwnProperty(q))&&vr(rt[q])},Bt=function(q){q.objectNumber=Kt();var be=[];be.push({key:"Type",value:"/XObject"}),be.push({key:"Subtype",value:"/Form"}),be.push({key:"BBox",value:"["+[I(q.x),I(q.y),I(q.x+q.width),I(q.y+q.height)].join(" ")+"]"}),be.push({key:"Matrix",value:"["+q.matrix.toString()+"]"});var Oe=q.pages[1].join(`
`);Yt({data:Oe,additionalKeyValues:be,objectId:q.objectNumber}),Y("endobj")},ar=function(){for(var q in Et)Et.hasOwnProperty(q)&&Bt(Et[q])},br=function(q,be){var Oe,Ue=[],Ze=1/(be-1);for(Oe=0;Oe<1;Oe+=Ze)Ue.push(Oe);if(Ue.push(1),q[0].offset!=0){var ht={offset:0,color:q[0].color};q.unshift(ht)}if(q[q.length-1].offset!=1){var It={offset:1,color:q[q.length-1].color};q.push(It)}for(var qt="",f=0,ie=0;ie<Ue.length;ie++){for(Oe=Ue[ie];Oe>q[f+1].offset;)f++;var fe=q[f].offset,Ae=(Oe-fe)/(q[f+1].offset-fe),Je=q[f].color,st=q[f+1].color;qt+=$(Math.round((1-Ae)*Je[0]+Ae*st[0]).toString(16))+$(Math.round((1-Ae)*Je[1]+Ae*st[1]).toString(16))+$(Math.round((1-Ae)*Je[2]+Ae*st[2]).toString(16))}return qt.trim()},$r=function(q,be){be||(be=21);var Oe=Kt(),Ue=br(q.colors,be),Ze=[];Ze.push({key:"FunctionType",value:"0"}),Ze.push({key:"Domain",value:"[0.0 1.0]"}),Ze.push({key:"Size",value:"["+be+"]"}),Ze.push({key:"BitsPerSample",value:"8"}),Ze.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ze.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Yt({data:Ue,additionalKeyValues:Ze,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Oe}),Y("endobj"),q.objectNumber=Kt(),Y("<< /ShadingType "+q.type),Y("/ColorSpace /DeviceRGB");var ht="/Coords ["+I(parseFloat(q.coords[0]))+" "+I(parseFloat(q.coords[1]))+" ";q.type===2?ht+=I(parseFloat(q.coords[2]))+" "+I(parseFloat(q.coords[3])):ht+=I(parseFloat(q.coords[2]))+" "+I(parseFloat(q.coords[3]))+" "+I(parseFloat(q.coords[4]))+" "+I(parseFloat(q.coords[5])),Y(ht+="]"),q.matrix&&Y("/Matrix ["+q.matrix.toString()+"]"),Y("/Function "+Oe+" 0 R"),Y("/Extend [true true]"),Y(">>"),Y("endobj")},mr=function(q,be){var Oe=dt(),Ue=Kt();be.push({resourcesOid:Oe,objectOid:Ue}),q.objectNumber=Ue;var Ze=[];Ze.push({key:"Type",value:"/Pattern"}),Ze.push({key:"PatternType",value:"1"}),Ze.push({key:"PaintType",value:"1"}),Ze.push({key:"TilingType",value:"1"}),Ze.push({key:"BBox",value:"["+q.boundingBox.map(I).join(" ")+"]"}),Ze.push({key:"XStep",value:I(q.xStep)}),Ze.push({key:"YStep",value:I(q.yStep)}),Ze.push({key:"Resources",value:Oe+" 0 R"}),q.matrix&&Ze.push({key:"Matrix",value:"["+q.matrix.toString()+"]"}),Yt({data:q.stream,additionalKeyValues:Ze,objectId:q.objectNumber}),Y("endobj")},sr=function(q){var be;for(be in Fe)Fe.hasOwnProperty(be)&&(Fe[be]instanceof Ea?$r(Fe[be]):Fe[be]instanceof Pl&&mr(Fe[be],q))},Ir=function(q){for(var be in q.objectNumber=Kt(),Y("<<"),q)switch(be){case"opacity":Y("/ca "+M(q[be]));break;case"stroke-opacity":Y("/CA "+M(q[be]))}Y(">>"),Y("endobj")},dr=function(){var q;for(q in lt)lt.hasOwnProperty(q)&&Ir(lt[q])},rn=function(){for(var q in Y("/XObject <<"),Et)Et.hasOwnProperty(q)&&Et[q].objectNumber>=0&&Y("/"+q+" "+Et[q].objectNumber+" 0 R");We.publish("putXobjectDict"),Y(">>")},Zn=function(){yn.oid=Kt(),Y("<<"),Y("/Filter /Standard"),Y("/V "+yn.v),Y("/R "+yn.r),Y("/U <"+yn.toHexString(yn.U)+">"),Y("/O <"+yn.toHexString(yn.O)+">"),Y("/P "+yn.P),Y(">>"),Y("endobj")},Gn=function(){for(var q in Y("/Font <<"),rt)rt.hasOwnProperty(q)&&(h===!1||h===!0&&g.hasOwnProperty(q))&&Y("/"+q+" "+rt[q].objectNumber+" 0 R");Y(">>")},Li=function(){if(Object.keys(Fe).length>0){for(var q in Y("/Shading <<"),Fe)Fe.hasOwnProperty(q)&&Fe[q]instanceof Ea&&Fe[q].objectNumber>=0&&Y("/"+q+" "+Fe[q].objectNumber+" 0 R");We.publish("putShadingPatternDict"),Y(">>")}},Wn=function(q){if(Object.keys(Fe).length>0){for(var be in Y("/Pattern <<"),Fe)Fe.hasOwnProperty(be)&&Fe[be]instanceof m.TilingPattern&&Fe[be].objectNumber>=0&&Fe[be].objectNumber<q&&Y("/"+be+" "+Fe[be].objectNumber+" 0 R");We.publish("putTilingPatternDict"),Y(">>")}},so=function(){if(Object.keys(lt).length>0){var q;for(q in Y("/ExtGState <<"),lt)lt.hasOwnProperty(q)&&lt[q].objectNumber>=0&&Y("/"+q+" "+lt[q].objectNumber+" 0 R");We.publish("putGStateDict"),Y(">>")}},Ur=function(q){pt(q.resourcesOid,!0),Y("<<"),Y("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Gn(),Li(),Wn(q.objectOid),so(),rn(),Y(">>"),Y("endobj")},Ri=function(){var q=[];tr(),dr(),ar(),sr(q),We.publish("putResources"),q.forEach(Ur),Ur({resourcesOid:Mt,objectOid:Number.MAX_SAFE_INTEGER}),We.publish("postPutResources")},Po=function(){We.publish("putAdditionalObjects");for(var q=0;q<B.length;q++){var be=B[q];pt(be.objId,!0),Y(be.content),Y("endobj")}We.publish("postPutAdditionalObjects")},_o=function(q){Be[q.fontName]=Be[q.fontName]||{},Be[q.fontName][q.fontStyle]=q.id},fr=function(q,be,Oe,Ue,Ze){var ht={id:"F"+(Object.keys(rt).length+1).toString(10),postScriptName:q,fontName:be,fontStyle:Oe,encoding:Ue,isStandardFont:Ze||!1,metadata:{}};return We.publish("addFont",{font:ht,instance:this}),rt[ht.id]=ht,_o(ht),ht.id},jr=function(q){for(var be=0,Oe=ae.length;be<Oe;be++){var Ue=fr.call(this,q[be][0],q[be][1],q[be][2],ae[be][3],!0);h===!1&&(g[Ue]=!0);var Ze=q[be][0].split("-");_o({id:Ue,fontName:Ze[0],fontStyle:Ze[1]||""})}We.publish("addFonts",{fonts:rt,dictionary:Be})},nn=function(q){return q.foo=function(){try{return q.apply(this,arguments)}catch(Ue){var be=Ue.stack||"";~be.indexOf(" at ")&&(be=be.split(" at ")[1]);var Oe="Error in function "+be.split(`
`)[0].split("<")[0]+": "+Ue.message;if(!ur.console)throw new Error(Oe);ur.console.error(Oe,Ue),ur.alert&&alert(Oe)}},q.foo.bar=q,q.foo},ei=function(q,be){var Oe,Ue,Ze,ht,It,qt,f,ie,fe;if(Ze=(be=be||{}).sourceEncoding||"Unicode",It=be.outputEncoding,(be.autoencode||It)&&rt[He].metadata&&rt[He].metadata[Ze]&&rt[He].metadata[Ze].encoding&&(ht=rt[He].metadata[Ze].encoding,!It&&rt[He].encoding&&(It=rt[He].encoding),!It&&ht.codePages&&(It=ht.codePages[0]),typeof It=="string"&&(It=ht[It]),It)){for(f=!1,qt=[],Oe=0,Ue=q.length;Oe<Ue;Oe++)(ie=It[q.charCodeAt(Oe)])?qt.push(String.fromCharCode(ie)):qt.push(q[Oe]),qt[Oe].charCodeAt(0)>>8&&(f=!0);q=qt.join("")}for(Oe=q.length;f===void 0&&Oe!==0;)q.charCodeAt(Oe-1)>>8&&(f=!0),Oe--;if(!f)return q;for(qt=be.noBOM?[]:[254,255],Oe=0,Ue=q.length;Oe<Ue;Oe++){if((fe=(ie=q.charCodeAt(Oe))>>8)>>8)throw new Error("Character at position "+Oe+" of string '"+q+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");qt.push(fe),qt.push(ie-(fe<<8))}return String.fromCharCode.apply(void 0,qt)},Hr=m.__private__.pdfEscape=m.pdfEscape=function(q,be){return ei(q,be).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Fr=m.__private__.beginPage=function(q){Q[++Le]=[],nt[Le]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(q[0]),topRightY:Number(q[1])}},Wi(Le),re(Q[_])},wi=function(q,be){var Oe,Ue,Ze;switch(r=be||r,typeof q=="string"&&(Oe=b(q.toLowerCase()),Array.isArray(Oe)&&(Ue=Oe[0],Ze=Oe[1])),Array.isArray(q)&&(Ue=q[0]*je,Ze=q[1]*je),isNaN(Ue)&&(Ue=i[0],Ze=i[1]),(Ue>14400||Ze>14400)&&(ln.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Ue=Math.min(14400,Ue),Ze=Math.min(14400,Ze)),i=[Ue,Ze],r.substr(0,1)){case"l":Ze>Ue&&(i=[Ze,Ue]);break;case"p":Ue>Ze&&(i=[Ze,Ue])}Fr(i),Xa(Ja),Y(ti),tl!==0&&Y(tl+" J"),ta!==0&&Y(ta+" j"),We.publish("addPage",{pageNumber:Le})},Di=function(q){q>0&&q<=Le&&(Q.splice(q,1),nt.splice(q,1),Le--,_>Le&&(_=Le),this.setPage(_))},Wi=function(q){q>0&&q<=Le&&(_=q)},zr=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return Q.length-1},So=function(q,be,Oe){var Ue,Ze=void 0;return Oe=Oe||{},q=q!==void 0?q:rt[He].fontName,be=be!==void 0?be:rt[He].fontStyle,Ue=q.toLowerCase(),Be[Ue]!==void 0&&Be[Ue][be]!==void 0?Ze=Be[Ue][be]:Be[q]!==void 0&&Be[q][be]!==void 0?Ze=Be[q][be]:Oe.disableWarning===!1&&ln.warn("Unable to look up font label for font '"+q+"', '"+be+"'. Refer to getFontList() for available fonts."),Ze||Oe.noFallback||(Ze=Be.times[be])==null&&(Ze=Be.times.normal),Ze},wo=m.__private__.putInfo=function(){var q=Kt(),be=function(Ue){return Ue};for(var Oe in u!==null&&(be=yn.encryptor(q,0)),Y("<<"),Y("/Producer ("+Hr(be("jsPDF "+cr.version))+")"),Re)Re.hasOwnProperty(Oe)&&Re[Oe]&&Y("/"+Oe.substr(0,1).toUpperCase()+Oe.substr(1)+" ("+Hr(be(Re[Oe]))+")");Y("/CreationDate ("+Hr(be(z))+")"),Y(">>"),Y("endobj")},xo=m.__private__.putCatalog=function(q){var be=(q=q||{}).rootDictionaryObjId||bt;switch(Kt(),Y("<<"),Y("/Type /Catalog"),Y("/Pages "+be+" 0 R"),me||(me="fullwidth"),me){case"fullwidth":Y("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Y("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Y("/OpenAction [3 0 R /Fit]");break;case"original":Y("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Oe=""+me;Oe.substr(Oe.length-1)==="%"&&(me=parseInt(me)/100),typeof me=="number"&&Y("/OpenAction [3 0 R /XYZ null null "+M(me)+"]")}switch(Ce||(Ce="continuous"),Ce){case"continuous":Y("/PageLayout /OneColumn");break;case"single":Y("/PageLayout /SinglePage");break;case"two":case"twoleft":Y("/PageLayout /TwoColumnLeft");break;case"tworight":Y("/PageLayout /TwoColumnRight")}Ne&&Y("/PageMode /"+Ne),We.publish("putCatalog"),Y(">>"),Y("endobj")},Yc=m.__private__.putTrailer=function(){Y("trailer"),Y("<<"),Y("/Size "+(G+1)),Y("/Root "+G+" 0 R"),Y("/Info "+(G-1)+" 0 R"),u!==null&&Y("/Encrypt "+yn.oid+" 0 R"),Y("/ID [ <"+T+"> <"+T+"> ]"),Y(">>")},Bl=m.__private__.putHeader=function(){Y("%PDF-"+S),Y("%ºß¬à")},Kc=m.__private__.putXRef=function(){var q="0000000000";Y("xref"),Y("0 "+(G+1)),Y("0000000000 65535 f ");for(var be=1;be<=G;be++)typeof ne[be]=="function"?Y((q+ne[be]()).slice(-10)+" 00000 n "):ne[be]!==void 0?Y((q+ne[be]).slice(-10)+" 00000 n "):Y("0000000000 00000 n ")},Co=m.__private__.buildDocument=function(){de(),re(U),We.publish("buildDocument"),Bl(),Dr(),Po(),Ri(),u!==null&&Zn(),wo(),xo();var q=D;return Kc(),Yc(),Y("startxref"),Y(""+q),Y("%%EOF"),re(Q[_]),U.join(`
`)},Gs=m.__private__.getBlob=function(q){return new Blob([ue(q)],{type:"application/pdf"})},Ws=m.output=m.__private__.output=nn(function(q,be){switch(typeof(be=be||{})=="string"?be={filename:be}:be.filename=be.filename||"generated.pdf",q){case void 0:return Co();case"save":m.save(be.filename);break;case"arraybuffer":return ue(Co());case"blob":return Gs(Co());case"bloburi":case"bloburl":if(ur.URL!==void 0&&typeof ur.URL.createObjectURL=="function")return ur.URL&&ur.URL.createObjectURL(Gs(Co()))||void 0;ln.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Oe="",Ue=Co();try{Oe=sf(Ue)}catch{Oe=sf(unescape(encodeURIComponent(Ue)))}return"data:application/pdf;filename="+be.filename+";base64,"+Oe;case"pdfobjectnewwindow":if(Object.prototype.toString.call(ur)==="[object Window]"){var Ze="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ht=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';be.pdfObjectUrl&&(Ze=be.pdfObjectUrl,ht="");var It='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ze+'"'+ht+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(be)+");<\/script></body></html>",qt=ur.open();return qt!==null&&qt.document.write(It),qt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(ur)==="[object Window]"){var f='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(be.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+be.filename+'" width="500px" height="400px" /></body></html>',ie=ur.open();if(ie!==null){ie.document.write(f);var fe=this;ie.document.documentElement.querySelector("#pdfViewer").onload=function(){ie.document.title=be.filename,ie.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(fe.output("bloburl"))}}return ie}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(ur)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Ae='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",be)+'"></iframe></body></html>',Je=ur.open();if(Je!==null&&(Je.document.write(Ae),Je.document.title=be.filename),Je||typeof safari>"u")return Je;break;case"datauri":case"dataurl":return ur.document.location.href=this.output("datauristring",be);default:return null}}),qo=function(q){return Array.isArray(kt)===!0&&kt.indexOf(q)>-1};switch(n){case"pt":je=1;break;case"mm":je=72/25.4;break;case"cm":je=72/2.54;break;case"in":je=72;break;case"px":je=qo("px_scaling")==1?.75:96/72;break;case"pc":case"em":je=12;break;case"ex":je=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);je=n}var yn=null;se(),J();var Vl=function(q){return u!==null?yn.encryptor(q,0):function(be){return be}},Ya=m.__private__.getPageInfo=m.getPageInfo=function(q){if(isNaN(q)||q%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:nt[q].objId,pageNumber:q,pageContext:nt[q]}},pr=m.__private__.getPageInfoByObjId=function(q){if(isNaN(q)||q%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var be in nt)if(nt[be].objId===q)break;return Ya(be)},Uo=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:nt[_].objId,pageNumber:_,pageContext:nt[_]}};m.addPage=function(){return wi.apply(this,arguments),this},m.setPage=function(){return Wi.apply(this,arguments),re.call(this,Q[_]),this},m.insertPage=function(q){return this.addPage(),this.movePage(_,q),this},m.movePage=function(q,be){var Oe,Ue;if(q>be){Oe=Q[q],Ue=nt[q];for(var Ze=q;Ze>be;Ze--)Q[Ze]=Q[Ze-1],nt[Ze]=nt[Ze-1];Q[be]=Oe,nt[be]=Ue,this.setPage(be)}else if(q<be){Oe=Q[q],Ue=nt[q];for(var ht=q;ht<be;ht++)Q[ht]=Q[ht+1],nt[ht]=nt[ht+1];Q[be]=Oe,nt[be]=Ue,this.setPage(be)}return this},m.deletePage=function(){return Di.apply(this,arguments),this},m.__private__.text=m.text=function(q,be,Oe,Ue,Ze){var ht,It,qt,f,ie,fe,Ae,Je,st,Tt=(Ue=Ue||{}).scope||this;if(typeof q=="number"&&typeof be=="number"&&(typeof Oe=="string"||Array.isArray(Oe))){var Pr=Oe;Oe=be,be=q,q=Pr}if(arguments[3]instanceof mt?(E("The transform parameter of text() with a Matrix value"),st=Ze):(qt=arguments[4],f=arguments[5],tn(Ae=arguments[3])==="object"&&Ae!==null||(typeof qt=="string"&&(f=qt,qt=null),typeof Ae=="string"&&(f=Ae,Ae=null),typeof Ae=="number"&&(qt=Ae,Ae=null),Ue={flags:Ae,angle:qt,align:f})),isNaN(be)||isNaN(Oe)||q==null)throw new Error("Invalid arguments passed to jsPDF.text");if(q.length===0)return Tt;var Tr="",_r=!1,Wr=typeof Ue.lineHeightFactor=="number"?Ue.lineHeightFactor:Gr,sn=Tt.internal.scaleFactor;function To(hn){return hn=hn.split("	").join(Array(Ue.TabLen||9).join(" ")),Hr(hn,Ae)}function ri(hn){for(var pn,$n=hn.concat(),jn=[],Ss=$n.length;Ss--;)typeof(pn=$n.shift())=="string"?jn.push(pn):Array.isArray(hn)&&(pn.length===1||pn[1]===void 0&&pn[2]===void 0)?jn.push(pn[0]):jn.push([pn[0],pn[1],pn[2]]);return jn}function Yo(hn,pn){var $n;if(typeof hn=="string")$n=pn(hn)[0];else if(Array.isArray(hn)){for(var jn,Ss,id=hn.concat(),Zl=[],xu=id.length;xu--;)typeof(jn=id.shift())=="string"?Zl.push(pn(jn)[0]):Array.isArray(jn)&&typeof jn[0]=="string"&&(Ss=pn(jn[0],jn[1],jn[2]),Zl.push([Ss[0],Ss[1],Ss[2]]));$n=Zl}return $n}var Ko=!1,Jc=!0;if(typeof q=="string")Ko=!0;else if(Array.isArray(q)){var Xc=q.concat();It=[];for(var Hl,ni=Xc.length;ni--;)(typeof(Hl=Xc.shift())!="string"||Array.isArray(Hl)&&typeof Hl[0]!="string")&&(Jc=!1);Ko=Jc}if(Ko===!1)throw new Error('Type of text must be string or Array. "'+q+'" is not recognized.');typeof q=="string"&&(q=q.match(/[\r?\n]/)?q.split(/\r\n|\r|\n/g):[q]);var Gl=ye/Tt.internal.scaleFactor,Wl=Gl*(Wr-1);switch(Ue.baseline){case"bottom":Oe-=Wl;break;case"top":Oe+=Gl-Wl;break;case"hanging":Oe+=Gl-2*Wl;break;case"middle":Oe+=Gl/2-Wl}if((fe=Ue.maxWidth||0)>0&&(typeof q=="string"?q=Tt.splitTextToSize(q,fe):Object.prototype.toString.call(q)==="[object Array]"&&(q=q.reduce(function(hn,pn){return hn.concat(Tt.splitTextToSize(pn,fe))},[]))),ht={text:q,x:be,y:Oe,options:Ue,mutex:{pdfEscape:Hr,activeFontKey:He,fonts:rt,activeFontSize:ye}},We.publish("preProcessText",ht),q=ht.text,qt=(Ue=ht.options).angle,!(st instanceof mt)&&qt&&typeof qt=="number"){qt*=Math.PI/180,Ue.rotationDirection===0&&(qt=-qt),te===K.ADVANCED&&(qt=-qt);var Yl=Math.cos(qt),Zc=Math.sin(qt);st=new mt(Yl,Zc,-Zc,Yl,0,0)}else qt&&qt instanceof mt&&(st=qt);te!==K.ADVANCED||st||(st=rr),(ie=Ue.charSpace||fs)!==void 0&&(Tr+=I(w(ie))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Je=Ue.horizontalScale)!==void 0&&(Tr+=I(100*Je)+` Tz
`),Ue.lang;var Mi=-1,Wp=Ue.renderingMode!==void 0?Ue.renderingMode:Ue.stroke,ed=Tt.internal.getCurrentPageInfo().pageContext;switch(Wp){case 0:case!1:case"fill":Mi=0;break;case 1:case!0:case"stroke":Mi=1;break;case 2:case"fillThenStroke":Mi=2;break;case 3:case"invisible":Mi=3;break;case 4:case"fillAndAddForClipping":Mi=4;break;case 5:case"strokeAndAddPathForClipping":Mi=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Mi=6;break;case 7:case"addToPathForClipping":Mi=7}var Pu=ed.usedRenderingMode!==void 0?ed.usedRenderingMode:-1;Mi!==-1?Tr+=Mi+` Tr
`:Pu!==-1&&(Tr+=`0 Tr
`),Mi!==-1&&(ed.usedRenderingMode=Mi),f=Ue.align||"left";var lo,Kl=ye*Wr,_u=Tt.internal.pageSize.getWidth(),Su=rt[He];ie=Ue.charSpace||fs,fe=Ue.maxWidth||0,Ae=Object.assign({autoencode:!0,noBOM:!0},Ue.flags);var sa=[],rl=function(hn){return Tt.getStringUnitWidth(hn,{font:Su,charSpace:ie,fontSize:ye,doKerning:!1})*ye/sn};if(Object.prototype.toString.call(q)==="[object Array]"){var Fi;It=ri(q),f!=="left"&&(lo=It.map(rl));var xi,aa=0;if(f==="right"){be-=lo[0],q=[],ni=It.length;for(var bs=0;bs<ni;bs++)bs===0?(xi=Qi(be),Fi=Vn(Oe)):(xi=w(aa-lo[bs]),Fi=-Kl),q.push([It[bs],xi,Fi]),aa=lo[bs]}else if(f==="center"){be-=lo[0]/2,q=[],ni=It.length;for(var Ps=0;Ps<ni;Ps++)Ps===0?(xi=Qi(be),Fi=Vn(Oe)):(xi=w((aa-lo[Ps])/2),Fi=-Kl),q.push([It[Ps],xi,Fi]),aa=lo[Ps]}else if(f==="left"){q=[],ni=It.length;for(var Ql=0;Ql<ni;Ql++)q.push(It[Ql])}else if(f==="justify"&&Su.encoding==="Identity-H"){q=[],ni=It.length,fe=fe!==0?fe:_u;for(var _s=0,An=0;An<ni;An++)if(Fi=An===0?Vn(Oe):-Kl,xi=An===0?Qi(be):_s,An<ni-1){var td=w((fe-lo[An])/(It[An].split(" ").length-1)),Ci=It[An].split(" ");q.push([Ci[0]+" ",xi,Fi]),_s=0;for(var co=1;co<Ci.length;co++){var Jl=(rl(Ci[co-1]+" "+Ci[co])-rl(Ci[co]))*sn+td;co==Ci.length-1?q.push([Ci[co],Jl,0]):q.push([Ci[co]+" ",Jl,0]),_s-=Jl}}else q.push([It[An],xi,Fi]);q.push(["",_s,0])}else{if(f!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(q=[],ni=It.length,fe=fe!==0?fe:_u,An=0;An<ni;An++)Fi=An===0?Vn(Oe):-Kl,xi=An===0?Qi(be):0,An<ni-1?sa.push(I(w((fe-lo[An])/(It[An].split(" ").length-1)))):sa.push(0),q.push([It[An],xi,Fi])}}var wu=typeof Ue.R2L=="boolean"?Ue.R2L:ve;wu===!0&&(q=Yo(q,function(hn,pn,$n){return[hn.split("").reverse().join(""),pn,$n]})),ht={text:q,x:be,y:Oe,options:Ue,mutex:{pdfEscape:Hr,activeFontKey:He,fonts:rt,activeFontSize:ye}},We.publish("postProcessText",ht),q=ht.text,_r=ht.mutex.isHex||!1;var rd=rt[He].encoding;rd!=="WinAnsiEncoding"&&rd!=="StandardEncoding"||(q=Yo(q,function(hn,pn,$n){return[To(hn),pn,$n]})),It=ri(q),q=[];for(var nl,il,la,ol=0,Xl=1,sl=Array.isArray(It[0])?Xl:ol,ca="",nd=function(hn,pn,$n){var jn="";return $n instanceof mt?($n=typeof Ue.angle=="number"?Zt($n,new mt(1,0,0,1,hn,pn)):Zt(new mt(1,0,0,1,hn,pn),$n),te===K.ADVANCED&&($n=Zt(new mt(1,0,0,-1,0,0),$n)),jn=$n.join(" ")+` Tm
`):jn=I(hn)+" "+I(pn)+` Td
`,jn},uo=0;uo<It.length;uo++){switch(ca="",sl){case Xl:la=(_r?"<":"(")+It[uo][0]+(_r?">":")"),nl=parseFloat(It[uo][1]),il=parseFloat(It[uo][2]);break;case ol:la=(_r?"<":"(")+It[uo]+(_r?">":")"),nl=Qi(be),il=Vn(Oe)}sa!==void 0&&sa[uo]!==void 0&&(ca=sa[uo]+` Tw
`),uo===0?q.push(ca+nd(nl,il,st)+la):sl===ol?q.push(ca+la):sl===Xl&&q.push(ca+nd(nl,il,st)+la)}q=sl===ol?q.join(` Tj
T* `):q.join(` Tj
`),q+=` Tj
`;var ho=`BT
/`;return ho+=He+" "+ye+` Tf
`,ho+=I(ye*Wr)+` TL
`,ho+=Eo+`
`,ho+=Tr,ho+=q,Y(ho+="ET"),g[He]=!0,Tt};var Qc=m.__private__.clip=m.clip=function(q){return Y(q==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return Qc("evenodd")},m.__private__.discardPath=m.discardPath=function(){return Y("n"),this};var ao=m.__private__.isValidStyle=function(q){var be=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(q)!==-1&&(be=!0),be};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(q){return ao(q)&&(d=q),this};var jl=m.__private__.getStyle=m.getStyle=function(q){var be=d;switch(q){case"D":case"S":be="S";break;case"F":be="f";break;case"FD":case"DF":be="B";break;case"f":case"f*":case"B":case"B*":be=q}return be},Yi=m.close=function(){return Y("h"),this};m.stroke=function(){return Y("S"),this},m.fill=function(q){return Ys("f",q),this},m.fillEvenOdd=function(q){return Ys("f*",q),this},m.fillStroke=function(q){return Ys("B",q),this},m.fillStrokeEvenOdd=function(q){return Ys("B*",q),this};var Ys=function(q,be){tn(be)==="object"?Qs(be,q):Y(q)},Ka=function(q){q===null||te===K.ADVANCED&&q===void 0||(q=jl(q),Y(q))};function Ks(q,be,Oe,Ue,Ze){var ht=new Pl(be||this.boundingBox,Oe||this.xStep,Ue||this.yStep,this.gState,Ze||this.matrix);ht.stream=this.stream;var It=q+"$$"+this.cloneIndex+++"$$";return Dt(It,ht),ht}var Qs=function(q,be){var Oe=at[q.key],Ue=Fe[Oe];if(Ue instanceof Ea)Y("q"),Y(zl(be)),Ue.gState&&m.setGState(Ue.gState),Y(q.matrix.toString()+" cm"),Y("/"+Oe+" sh"),Y("Q");else if(Ue instanceof Pl){var Ze=new mt(1,0,0,-1,0,ci());q.matrix&&(Ze=Ze.multiply(q.matrix||rr),Oe=Ks.call(Ue,q.key,q.boundingBox,q.xStep,q.yStep,Ze).id),Y("q"),Y("/Pattern cs"),Y("/"+Oe+" scn"),Ue.gState&&m.setGState(Ue.gState),Y(be),Y("Q")}},zl=function(q){switch(q){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Ao=m.moveTo=function(q,be){return Y(I(w(q))+" "+I(j(be))+" m"),this},Ki=m.lineTo=function(q,be){return Y(I(w(q))+" "+I(j(be))+" l"),this},$o=m.curveTo=function(q,be,Oe,Ue,Ze,ht){return Y([I(w(q)),I(j(be)),I(w(Oe)),I(j(Ue)),I(w(Ze)),I(j(ht)),"c"].join(" ")),this};m.__private__.line=m.line=function(q,be,Oe,Ue,Ze){if(isNaN(q)||isNaN(be)||isNaN(Oe)||isNaN(Ue)||!ao(Ze))throw new Error("Invalid arguments passed to jsPDF.line");return te===K.COMPAT?this.lines([[Oe-q,Ue-be]],q,be,[1,1],Ze||"S"):this.lines([[Oe-q,Ue-be]],q,be,[1,1]).stroke()},m.__private__.lines=m.lines=function(q,be,Oe,Ue,Ze,ht){var It,qt,f,ie,fe,Ae,Je,st,Tt,Pr,Tr,_r;if(typeof q=="number"&&(_r=Oe,Oe=be,be=q,q=_r),Ue=Ue||[1,1],ht=ht||!1,isNaN(be)||isNaN(Oe)||!Array.isArray(q)||!Array.isArray(Ue)||!ao(Ze)||typeof ht!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Ao(be,Oe),It=Ue[0],qt=Ue[1],ie=q.length,Pr=be,Tr=Oe,f=0;f<ie;f++)(fe=q[f]).length===2?(Pr=fe[0]*It+Pr,Tr=fe[1]*qt+Tr,Ki(Pr,Tr)):(Ae=fe[0]*It+Pr,Je=fe[1]*qt+Tr,st=fe[2]*It+Pr,Tt=fe[3]*qt+Tr,Pr=fe[4]*It+Pr,Tr=fe[5]*qt+Tr,$o(Ae,Je,st,Tt,Pr,Tr));return ht&&Yi(),Ka(Ze),this},m.path=function(q){for(var be=0;be<q.length;be++){var Oe=q[be],Ue=Oe.c;switch(Oe.op){case"m":Ao(Ue[0],Ue[1]);break;case"l":Ki(Ue[0],Ue[1]);break;case"c":$o.apply(this,Ue);break;case"h":Yi()}}return this},m.__private__.rect=m.rect=function(q,be,Oe,Ue,Ze){if(isNaN(q)||isNaN(be)||isNaN(Oe)||isNaN(Ue)||!ao(Ze))throw new Error("Invalid arguments passed to jsPDF.rect");return te===K.COMPAT&&(Ue=-Ue),Y([I(w(q)),I(j(be)),I(w(Oe)),I(w(Ue)),"re"].join(" ")),Ka(Ze),this},m.__private__.triangle=m.triangle=function(q,be,Oe,Ue,Ze,ht,It){if(isNaN(q)||isNaN(be)||isNaN(Oe)||isNaN(Ue)||isNaN(Ze)||isNaN(ht)||!ao(It))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Oe-q,Ue-be],[Ze-Oe,ht-Ue],[q-Ze,be-ht]],q,be,[1,1],It,!0),this},m.__private__.roundedRect=m.roundedRect=function(q,be,Oe,Ue,Ze,ht,It){if(isNaN(q)||isNaN(be)||isNaN(Oe)||isNaN(Ue)||isNaN(Ze)||isNaN(ht)||!ao(It))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var qt=4/3*(Math.SQRT2-1);return Ze=Math.min(Ze,.5*Oe),ht=Math.min(ht,.5*Ue),this.lines([[Oe-2*Ze,0],[Ze*qt,0,Ze,ht-ht*qt,Ze,ht],[0,Ue-2*ht],[0,ht*qt,-Ze*qt,ht,-Ze,ht],[2*Ze-Oe,0],[-Ze*qt,0,-Ze,-ht*qt,-Ze,-ht],[0,2*ht-Ue],[0,-ht*qt,Ze*qt,-ht,Ze,-ht]],q+Ze,be,[1,1],It,!0),this},m.__private__.ellipse=m.ellipse=function(q,be,Oe,Ue,Ze){if(isNaN(q)||isNaN(be)||isNaN(Oe)||isNaN(Ue)||!ao(Ze))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ht=4/3*(Math.SQRT2-1)*Oe,It=4/3*(Math.SQRT2-1)*Ue;return Ao(q+Oe,be),$o(q+Oe,be-It,q+ht,be-Ue,q,be-Ue),$o(q-ht,be-Ue,q-Oe,be-It,q-Oe,be),$o(q-Oe,be+It,q-ht,be+Ue,q,be+Ue),$o(q+ht,be+Ue,q+Oe,be+It,q+Oe,be),Ka(Ze),this},m.__private__.circle=m.circle=function(q,be,Oe,Ue){if(isNaN(q)||isNaN(be)||isNaN(Oe)||!ao(Ue))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(q,be,Oe,Oe,Ue)},m.setFont=function(q,be,Oe){return Oe&&(be=W(be,Oe)),He=So(q,be,{disableWarning:!1}),this};var Qa=m.__private__.getFont=m.getFont=function(){return rt[So.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var q,be,Oe={};for(q in Be)if(Be.hasOwnProperty(q))for(be in Oe[q]=[],Be[q])Be[q].hasOwnProperty(be)&&Oe[q].push(be);return Oe},m.addFont=function(q,be,Oe,Ue,Ze){var ht=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ht.indexOf(arguments[3])!==-1?Ze=arguments[3]:arguments[3]&&ht.indexOf(arguments[3])==-1&&(Oe=W(Oe,Ue)),Ze=Ze||"Identity-H",fr.call(this,q,be,Oe,Ze)};var Gr,Ja=t.lineWidth||.200025,Js=m.__private__.getLineWidth=m.getLineWidth=function(){return Ja},Xa=m.__private__.setLineWidth=m.setLineWidth=function(q){return Ja=q,Y(I(w(q))+" w"),this};m.__private__.setLineDash=cr.API.setLineDash=cr.API.setLineDashPattern=function(q,be){if(q=q||[],be=be||0,isNaN(be)||!Array.isArray(q))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return q=q.map(function(Oe){return I(w(Oe))}).join(" "),be=I(w(be)),Y("["+q+"] "+be+" d"),this};var Za=m.__private__.getLineHeight=m.getLineHeight=function(){return ye*Gr};m.__private__.getLineHeight=m.getLineHeight=function(){return ye*Gr};var el=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(q){return typeof(q=q||1.15)=="number"&&(Gr=q),this},ys=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return Gr};el(t.lineHeight);var Qi=m.__private__.getHorizontalCoordinate=function(q){return w(q)},Vn=m.__private__.getVerticalCoordinate=function(q){return te===K.ADVANCED?q:nt[_].mediaBox.topRightY-nt[_].mediaBox.bottomLeftY-w(q)},ql=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(q){return I(Qi(q))},Ho=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(q){return I(Vn(q))},ti=t.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return ft(ti)},m.__private__.setStrokeColor=m.setDrawColor=function(q,be,Oe,Ue){return ti=At({ch1:q,ch2:be,ch3:Oe,ch4:Ue,pdfColorType:"draw",precision:2}),Y(ti),this};var Xs=t.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return ft(Xs)},m.__private__.setFillColor=m.setFillColor=function(q,be,Oe,Ue){return Xs=At({ch1:q,ch2:be,ch3:Oe,ch4:Ue,pdfColorType:"fill",precision:2}),Y(Xs),this};var Eo=t.textColor||"0 g",Zs=m.__private__.getTextColor=m.getTextColor=function(){return ft(Eo)};m.__private__.setTextColor=m.setTextColor=function(q,be,Oe,Ue){return Eo=At({ch1:q,ch2:be,ch3:Oe,ch4:Ue,pdfColorType:"text",precision:3}),this};var fs=t.charSpace,ea=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(fs||0)};m.__private__.setCharSpace=m.setCharSpace=function(q){if(isNaN(q))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return fs=q,this};var tl=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(q){var be=m.CapJoinStyles[q];if(be===void 0)throw new Error("Line cap style of '"+q+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return tl=be,Y(be+" J"),this};var ta=0;m.__private__.setLineJoin=m.setLineJoin=function(q){var be=m.CapJoinStyles[q];if(be===void 0)throw new Error("Line join style of '"+q+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ta=be,Y(be+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(q){if(q=q||0,isNaN(q))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Y(I(w(q))+" M"),this},m.GState=ou,m.setGState=function(q){(q=typeof q=="string"?lt[Xe[q]]:Go(null,q)).equals(Ct)||(Y("/"+q.id+" gs"),Ct=q)};var Go=function(q,be){if(!q||!Xe[q]){var Oe=!1;for(var Ue in lt)if(lt.hasOwnProperty(Ue)&&lt[Ue].equals(be)){Oe=!0;break}if(Oe)be=lt[Ue];else{var Ze="GS"+(Object.keys(lt).length+1).toString(10);lt[Ze]=be,be.id=Ze}return q&&(Xe[q]=be.id),We.publish("addGState",be),be}};m.addGState=function(q,be){return Go(q,be),this},m.saveGraphicsState=function(){return Y("q"),Ge.push({key:He,size:ye,color:Eo}),this},m.restoreGraphicsState=function(){Y("Q");var q=Ge.pop();return He=q.key,ye=q.size,Eo=q.color,Ct=null,this},m.setCurrentTransformationMatrix=function(q){return Y(q.toString()+" cm"),this},m.comment=function(q){return Y("#"+q),this};var gs=function(q,be){var Oe=q||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Oe},set:function(ht){isNaN(ht)||(Oe=parseFloat(ht))}});var Ue=be||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Ue},set:function(ht){isNaN(ht)||(Ue=parseFloat(ht))}});var Ze="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ze},set:function(ht){Ze=ht.toString()}}),this},ra=function(q,be,Oe,Ue){gs.call(this,q,be),this.type="rect";var Ze=Oe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ze},set:function(It){isNaN(It)||(Ze=parseFloat(It))}});var ht=Ue||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ht},set:function(It){isNaN(It)||(ht=parseFloat(It))}}),this},vs=function(){this.page=Le,this.currentPage=_,this.pages=Q.slice(0),this.pagesContext=nt.slice(0),this.x=Ve,this.y=qe,this.matrix=tt,this.width=Wo(_),this.height=ci(_),this.outputDestination=oe,this.id="",this.objectNumber=-1};vs.prototype.restore=function(){Le=this.page,_=this.currentPage,nt=this.pagesContext,Q=this.pages,Ve=this.x,qe=this.y,tt=this.matrix,ia(_,this.width),oa(_,this.height),oe=this.outputDestination};var na=function(q,be,Oe,Ue,Ze){jt.push(new vs),Le=_=0,Q=[],Ve=q,qe=be,tt=Ze,Fr([Oe,Ue])},Ul=function(q){if(Ot[q])jt.pop().restore();else{var be=new vs,Oe="Xo"+(Object.keys(Et).length+1).toString(10);be.id=Oe,Ot[q]=Oe,Et[Oe]=be,We.publish("addFormObject",be),jt.pop().restore()}};for(var Io in m.beginFormObject=function(q,be,Oe,Ue,Ze){return na(q,be,Oe,Ue,Ze),this},m.endFormObject=function(q){return Ul(q),this},m.doFormObject=function(q,be){var Oe=Et[Ot[q]];return Y("q"),Y(be.toString()+" cm"),Y("/"+Oe.id+" Do"),Y("Q"),this},m.getFormObject=function(q){var be=Et[Ot[q]];return{x:be.x,y:be.y,width:be.width,height:be.height,matrix:be.matrix}},m.save=function(q,be){return q=q||"generated.pdf",(be=be||{}).returnPromise=be.returnPromise||!1,be.returnPromise===!1?(hl(Gs(Co()),q),typeof hl.unload=="function"&&ur.setTimeout&&setTimeout(hl.unload,911),this):new Promise(function(Oe,Ue){try{var Ze=hl(Gs(Co()),q);typeof hl.unload=="function"&&ur.setTimeout&&setTimeout(hl.unload,911),Oe(Ze)}catch(ht){Ue(ht.message)}})},cr.API)cr.API.hasOwnProperty(Io)&&(Io==="events"&&cr.API.events.length?function(q,be){var Oe,Ue,Ze;for(Ze=be.length-1;Ze!==-1;Ze--)Oe=be[Ze][0],Ue=be[Ze][1],q.subscribe.apply(q,[Oe].concat(typeof Ue=="function"?[Ue]:Ue))}(We,cr.API.events):m[Io]=cr.API[Io]);var Wo=m.getPageWidth=function(q){return(nt[q=q||_].mediaBox.topRightX-nt[q].mediaBox.bottomLeftX)/je},ia=m.setPageWidth=function(q,be){nt[q].mediaBox.topRightX=be*je+nt[q].mediaBox.bottomLeftX},ci=m.getPageHeight=function(q){return(nt[q=q||_].mediaBox.topRightY-nt[q].mediaBox.bottomLeftY)/je},oa=m.setPageHeight=function(q,be){nt[q].mediaBox.topRightY=be*je+nt[q].mediaBox.bottomLeftY};return m.internal={pdfEscape:Hr,getStyle:jl,getFont:Qa,getFontSize:pe,getCharSpace:ea,getTextColor:Zs,getLineHeight:Za,getLineHeightFactor:ys,getLineWidth:Js,write:ce,getHorizontalCoordinate:Qi,getVerticalCoordinate:Vn,getCoordinateString:ql,getVerticalCoordinateString:Ho,collections:{},newObject:Kt,newAdditionalObject:ze,newObjectDeferred:dt,newObjectDeferredBegin:pt,getFilters:Ht,putStream:Yt,events:We,scaleFactor:je,pageSize:{getWidth:function(){return Wo(_)},setWidth:function(q){ia(_,q)},getHeight:function(){return ci(_)},setHeight:function(q){oa(_,q)}},encryptionOptions:u,encryption:yn,getEncryptor:Vl,output:Ws,getNumberOfPages:zr,pages:Q,out:Y,f2:M,f3:P,getPageInfo:Ya,getPageInfoByObjId:pr,getCurrentPageInfo:Uo,getPDFVersion:N,Point:gs,Rectangle:ra,Matrix:mt,hasHotfix:qo},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return Wo(_)},set:function(q){ia(_,q)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return ci(_)},set:function(q){oa(_,q)},enumerable:!0,configurable:!0}),jr.call(m,ae),He="F1",wi(i,r),We.publish("initialized"),m}gc.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},gc.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},gc.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},gc.prototype.processOwnerPassword=function(t,e){return lf(af(e).substr(0,5),t)},gc.prototype.encryptor=function(t,e){var r=af(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return lf(r,n)}},ou.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||tn(t)!==tn(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},cr.API={events:[]},cr.version="3.0.1";var xn=cr.API,Ig=1,Ol=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},lc=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Sr=function(t){return t.toFixed(2)},wa=function(t){return t.toFixed(5)};xn.__acroform__={};var Gi=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},E1=function(t){return t*Ig},es=function(t){var e=new QP,r=er.internal.getHeight(t)||0,n=er.internal.getWidth(t)||0;return e.BBox=[0,0,Number(Sr(n)),Number(Sr(r))],e},jL=xn.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<e},zL=xn.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<e)},qL=xn.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(t&1<<e)==0?0:1},In=xn.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return qL(t,e-1)},Tn=xn.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return jL(t,e-1)},kn=xn.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return zL(t,e-1)},UL=xn.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,i=t[0],o=t[1],s=t[2],l=t[3],c={};return c.lowerLeft_X=r(i)||0,c.lowerLeft_Y=n(o+l)||0,c.upperRight_X=r(i+s)||0,c.upperRight_Y=n(o)||0,[Number(Sr(c.lowerLeft_X)),Number(Sr(c.lowerLeft_Y)),Number(Sr(c.upperRight_X)),Number(Sr(c.upperRight_Y))]},HL=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=cf(t,r),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+Sr(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var o=es(t);return o.scope=t.scope,o.stream=e.join(`
`),o}},cf=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(P){return P.split(`
`)}):i.map(function(P){return[P]});var o=r,s=er.internal.getHeight(t)||0;s=s<0?-s:s;var l=er.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(P,w,v){if(P+1<i.length){var j=w+" "+i[P+1][0];return dh(j,t,v).width<=l-4}return!1};o++;e:for(;o>0;){e="",o--;var d,u,h=dh("3",t,o).height,g=t.multiline?s-o:(s-h)/2,m=g+=2,S=0,N=0,x=0;if(o<=0){e=`(...) Tj
`,e+="% Width of Text: "+dh(e,t,o=12).width+", FieldWidth:"+l+`
`;break}for(var b="",K=0,te=0;te<i.length;te++)if(i.hasOwnProperty(te)){var F=!1;if(i[te].length!==1&&x!==i[te].length-1){if((h+2)*(K+2)+2>s)continue e;b+=i[te][x],F=!0,N=te,te--}else{b=(b+=i[te][x]+" ").substr(b.length-1)==" "?b.substr(0,b.length-1):b;var V=parseInt(te),W=c(V,b,o),I=te>=i.length-1;if(W&&!I){b+=" ",x=0;continue}if(W||I){if(I)N=V;else if(t.multiline&&(h+2)*(K+2)+2>s)continue e}else{if(!t.multiline||(h+2)*(K+2)+2>s)continue e;N=V}}for(var E="",L=S;L<=N;L++){var M=i[L];if(t.multiline){if(L===N){E+=M[x]+" ",x=(x+1)%M.length;continue}if(L===S){E+=M[M.length-1]+" ";continue}}E+=M[0]+" "}switch(E=E.substr(E.length-1)==" "?E.substr(0,E.length-1):E,u=dh(E,t,o).width,t.textAlign){case"right":d=l-u-2;break;case"center":d=(l-u)/2;break;case"left":default:d=2}e+=Sr(d)+" "+Sr(m)+` Td
`,e+="("+Ol(E)+`) Tj
`,e+=-Sr(d)+` 0 Td
`,m=-(o+2),u=0,S=F?N:N+1,K++,b=""}break}return n.text=e,n.fontSize=o,n},dh=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},GL={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},WL=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},YL=function(t,e){for(var r in t)if(t.hasOwnProperty(r)){var n=r,i=t[r];e.internal.newObjectDeferredBegin(i.objId,!0),tn(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete t[n]}},KL=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(jo.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(GL)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Ig=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new JP,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var o=n[i];o.objId=void 0,o.hasAnnotation&&WL(o,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,i){var o=!n;for(var s in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var l=n[s],c=[],d=l.Rect;if(l.Rect&&(l.Rect=UL(l.Rect,i)),i.internal.newObjectDeferredBegin(l.objId,!0),l.DA=er.createDefaultAppearanceStream(l),tn(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=d,l.hasAppearanceStream&&!l.appearanceStreamContent){var u=HL(l);c.push({key:"AP",value:"<</N "+u+">>"}),i.internal.acroformPlugin.xForms.push(u)}if(l.appearanceStreamContent){var h="";for(var g in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(g)){var m=l.appearanceStreamContent[g];if(h+="/"+g+" ",h+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var s in m)if(m.hasOwnProperty(s)){var S=m[s];typeof S=="function"&&(S=S.call(i,l)),h+="/"+s+" "+S+" ",i.internal.acroformPlugin.xForms.indexOf(S)>=0||i.internal.acroformPlugin.xForms.push(S)}}else typeof(S=m)=="function"&&(S=S.call(i,l)),h+="/"+s+" "+S,i.internal.acroformPlugin.xForms.indexOf(S)>=0||i.internal.acroformPlugin.xForms.push(S);h+=">>"}c.push({key:"AP",value:`<<
`+h+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:l.objId}),i.internal.out("endobj")}o&&YL(i.internal.acroformPlugin.xForms,i)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},KP=xn.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(s){return s};if(Array.isArray(t)){for(var i="[",o=0;o<t.length;o++)switch(o!==0&&(i+=" "),tn(t[o])){case"boolean":case"number":case"object":i+=t[o].toString();break;case"string":t[o].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),i+="("+Ol(n(t[o].toString()))+")"):i+=t[o].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},ry=function(t,e,r){var n=function(i){return i};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),t="("+Ol(n(t))+")"},ns=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ns.prototype.toString=function(){return this.objId+" 0 R"},ns.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},ns.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],i=this[n];i&&(Array.isArray(i)?t.push({key:n,value:KP(i,this.objId,this.scope)}):i instanceof ns?(i.scope=this.scope,t.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:n,value:i}))}return t};var QP=function(){ns.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};Gi(QP,ns);var JP=function(){ns.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Ol(r(t))+")"}},set:function(r){t=r}})};Gi(JP,ns);var jo=function t(){ns.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute F supplied.');e=b}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!In(e,3)},set:function(b){b?this.F=Tn(e,3):this.F=kn(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute Ff supplied.');r=b}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(b){n=b!==void 0?b:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(b){n[0]=b}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(b){n[1]=b}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(b){n[2]=b}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(b){n[3]=b}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(b){switch(b){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=b;break;default:throw new Error('Invalid value "'+b+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof dp)return;o="FieldObject"+t.FieldNum++}var b=function(K){return K};return this.scope&&(b=this.scope.internal.getEncryptor(this.objId)),"("+Ol(b(o))+")"},set:function(b){o=b.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(b){o=b}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(b){s=b}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(b){l=b}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(b){c=b}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/Ig:d},set:function(b){d=b}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(b){u=b}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof dp||this instanceof Fa))return ry(h,this.objId,this.scope)},set:function(b){b=b.toString(),h=b}});var g=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof qn?g:ry(g,this.objId,this.scope)},set:function(b){b=b.toString(),g=this instanceof qn?b:b.substr(0,1)==="("?lc(b.substr(1,b.length-2)):lc(b)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof qn?lc(g.substr(1,g.length-1)):g},set:function(b){b=b.toString(),g=this instanceof qn?"/"+b:b}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(b){this.V=b}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof qn?m:ry(m,this.objId,this.scope)},set:function(b){b=b.toString(),m=this instanceof qn?b:b.substr(0,1)==="("?lc(b.substr(1,b.length-2)):lc(b)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof qn?lc(m.substr(1,m.length-1)):m},set:function(b){b=b.toString(),m=this instanceof qn?"/"+b:b}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var S,N=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return N},set:function(b){b=!!b,N=b}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(S)return S},set:function(b){S=b}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,1)},set:function(b){b?this.Ff=Tn(this.Ff,1):this.Ff=kn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,2)},set:function(b){b?this.Ff=Tn(this.Ff,2):this.Ff=kn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,3)},set:function(b){b?this.Ff=Tn(this.Ff,3):this.Ff=kn(this.Ff,3)}});var x=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(x!==null)return x},set:function(b){if([0,1,2].indexOf(b)===-1)throw new Error('Invalid value "'+b+'" for attribute Q supplied.');x=b}}),Object.defineProperty(this,"textAlign",{get:function(){var b;switch(x){case 0:default:b="left";break;case 1:b="center";break;case 2:b="right"}return b},configurable:!0,enumerable:!0,set:function(b){switch(b){case"right":case 2:x=2;break;case"center":case 1:x=1;break;case"left":case 0:default:x=0}}})};Gi(jo,ns);var xl=function(){jo.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return KP(e,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=function(o,s,l){l||(l=1);for(var c,d=[];c=s.exec(o);)d.push(c[l]);return d}(n,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,18)},set:function(r){r?this.Ff=Tn(this.Ff,18):this.Ff=kn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Tn(this.Ff,19):this.Ff=kn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,20)},set:function(r){r?(this.Ff=Tn(this.Ff,20),e.sort()):this.Ff=kn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,22)},set:function(r){r?this.Ff=Tn(this.Ff,22):this.Ff=kn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,23)},set:function(r){r?this.Ff=Tn(this.Ff,23):this.Ff=kn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,27)},set:function(r){r?this.Ff=Tn(this.Ff,27):this.Ff=kn(this.Ff,27)}}),this.hasAppearanceStream=!1};Gi(xl,jo);var Cl=function(){xl.call(this),this.fontName="helvetica",this.combo=!1};Gi(Cl,xl);var Al=function(){Cl.call(this),this.combo=!0};Gi(Al,Cl);var Bd=function(){Al.call(this),this.edit=!0};Gi(Bd,Al);var qn=function(){jo.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,15)},set:function(r){r?this.Ff=Tn(this.Ff,15):this.Ff=kn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,16)},set:function(r){r?this.Ff=Tn(this.Ff,16):this.Ff=kn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,17)},set:function(r){r?this.Ff=Tn(this.Ff,17):this.Ff=kn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,26)},set:function(r){r?this.Ff=Tn(this.Ff,26):this.Ff=kn(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(o){return o};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,i=[];for(n in i.push("<<"),e)i.push("/"+n+" ("+Ol(r(e[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){tn(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};Gi(qn,jo);var Vd=function(){qn.call(this),this.pushButton=!0};Gi(Vd,qn);var $l=function(){qn.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Gi($l,qn);var dp=function(){var t,e;jo.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(l){return l};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var o,s=[];for(o in s.push("<<"),n)s.push("/"+o+" ("+Ol(i(n[o]))+")");return s.push(">>"),s.join(`
`)},set:function(i){tn(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=er.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Gi(dp,jo),$l.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},$l.prototype.createOption=function(t){var e=new dp;return e.Parent=this,e.optionName=t,this.Kids.push(e),QL.call(this.scope,e),e};var jd=function(){qn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=er.CheckBox.createAppearanceStream()};Gi(jd,qn);var Fa=function(){jo.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,13)},set:function(e){e?this.Ff=Tn(this.Ff,13):this.Ff=kn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,21)},set:function(e){e?this.Ff=Tn(this.Ff,21):this.Ff=kn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,23)},set:function(e){e?this.Ff=Tn(this.Ff,23):this.Ff=kn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,24)},set:function(e){e?this.Ff=Tn(this.Ff,24):this.Ff=kn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,25)},set:function(e){e?this.Ff=Tn(this.Ff,25):this.Ff=kn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,26)},set:function(e){e?this.Ff=Tn(this.Ff,26):this.Ff=kn(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Gi(Fa,jo);var zd=function(){Fa.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!In(this.Ff,14)},set:function(t){t?this.Ff=Tn(this.Ff,14):this.Ff=kn(this.Ff,14)}}),this.password=!0};Gi(zd,Fa);var er={CheckBox:{createAppearanceStream:function(){return{N:{On:er.CheckBox.YesNormal},D:{On:er.CheckBox.YesPushDown,Off:er.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=es(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),o=cf(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+Sr(er.internal.getWidth(t))+" "+Sr(er.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Sr(o.fontSize)+" Tf "+i),r.push("BT"),r.push(o.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=es(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),i=[],o=er.internal.getHeight(t),s=er.internal.getWidth(t),l=cf(t,t.caption);return i.push("1 g"),i.push("0 0 "+Sr(s)+" "+Sr(o)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Sr(s-1)+" "+Sr(o-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+Sr(l.fontSize)+" Tf "+n),i.push(l.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=es(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Sr(er.internal.getWidth(t))+" "+Sr(er.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:er.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=er.RadioButton.Circle.YesNormal,e.D[t]=er.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=es(t);e.scope=t.scope;var r=[],n=er.internal.getWidth(t)<=er.internal.getHeight(t)?er.internal.getWidth(t)/4:er.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=er.internal.Bezier_C,o=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+wa(er.internal.getWidth(t)/2)+" "+wa(er.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=es(t);e.scope=t.scope;var r=[],n=er.internal.getWidth(t)<=er.internal.getHeight(t)?er.internal.getWidth(t)/4:er.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),o=Number((i*er.internal.Bezier_C).toFixed(5)),s=Number((n*er.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+wa(er.internal.getWidth(t)/2)+" "+wa(er.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),r.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),r.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),r.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+wa(er.internal.getWidth(t)/2)+" "+wa(er.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=es(t);e.scope=t.scope;var r=[],n=er.internal.getWidth(t)<=er.internal.getHeight(t)?er.internal.getWidth(t)/4:er.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),o=Number((i*er.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+wa(er.internal.getWidth(t)/2)+" "+wa(er.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),r.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),r.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),r.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:er.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=er.RadioButton.Cross.YesNormal,e.D[t]=er.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=es(t);e.scope=t.scope;var r=[],n=er.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+Sr(er.internal.getWidth(t)-2)+" "+Sr(er.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(Sr(n.x1.x)+" "+Sr(n.x1.y)+" m"),r.push(Sr(n.x2.x)+" "+Sr(n.x2.y)+" l"),r.push(Sr(n.x4.x)+" "+Sr(n.x4.y)+" m"),r.push(Sr(n.x3.x)+" "+Sr(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=es(t);e.scope=t.scope;var r=er.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+Sr(er.internal.getWidth(t))+" "+Sr(er.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Sr(er.internal.getWidth(t)-2)+" "+Sr(er.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(Sr(r.x1.x)+" "+Sr(r.x1.y)+" m"),n.push(Sr(r.x2.x)+" "+Sr(r.x2.y)+" l"),n.push(Sr(r.x4.x)+" "+Sr(r.x4.y)+" m"),n.push(Sr(r.x3.x)+" "+Sr(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=es(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Sr(er.internal.getWidth(t))+" "+Sr(er.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};er.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=er.internal.getWidth(t),r=er.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},er.internal.getWidth=function(t){var e=0;return tn(t)==="object"&&(e=E1(t.Rect[2])),e},er.internal.getHeight=function(t){var e=0;return tn(t)==="object"&&(e=E1(t.Rect[3])),e};var QL=xn.addField=function(t){if(KL(this,t),!(t instanceof jo))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};xn.AcroFormChoiceField=xl,xn.AcroFormListBox=Cl,xn.AcroFormComboBox=Al,xn.AcroFormEditBox=Bd,xn.AcroFormButton=qn,xn.AcroFormPushButton=Vd,xn.AcroFormRadioButton=$l,xn.AcroFormCheckBox=jd,xn.AcroFormTextField=Fa,xn.AcroFormPasswordField=zd,xn.AcroFormAppearance=er,xn.AcroForm={ChoiceField:xl,ListBox:Cl,ComboBox:Al,EditBox:Bd,Button:qn,PushButton:Vd,RadioButton:$l,CheckBox:jd,TextField:Fa,PasswordField:zd,Appearance:er},cr.AcroForm={ChoiceField:xl,ListBox:Cl,ComboBox:Al,EditBox:Bd,Button:qn,PushButton:Vd,RadioButton:$l,CheckBox:jd,TextField:Fa,PasswordField:zd,Appearance:er};var JL=cr.AcroForm;function XP(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){t.__addimage__={};var e="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=t.__addimage__.getImageFileTypeByImageData=function(P,w){var v,j,z,T,R,J=e;if((w=w||e)==="RGBA"||P.data!==void 0&&P.data instanceof Uint8ClampedArray&&"height"in P&&"width"in P)return"RGBA";if(W(P))for(R in r)for(z=r[R],v=0;v<z.length;v+=1){for(T=!0,j=0;j<z[v].length;j+=1)if(z[v][j]!==void 0&&z[v][j]!==P[j]){T=!1;break}if(T===!0){J=R;break}}else for(R in r)for(z=r[R],v=0;v<z.length;v+=1){for(T=!0,j=0;j<z[v].length;j+=1)if(z[v][j]!==void 0&&z[v][j]!==P.charCodeAt(j)){T=!1;break}if(T===!0){J=R;break}}return J===e&&w!==e&&(J=w),J},i=function P(w){for(var v=this.internal.write,j=this.internal.putStream,z=(0,this.internal.getFilters)();z.indexOf("FlateEncode")!==-1;)z.splice(z.indexOf("FlateEncode"),1);w.objectId=this.internal.newObject();var T=[];if(T.push({key:"Type",value:"/XObject"}),T.push({key:"Subtype",value:"/Image"}),T.push({key:"Width",value:w.width}),T.push({key:"Height",value:w.height}),w.colorSpace===x.INDEXED?T.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(w.palette.length/3-1)+" "+("sMask"in w&&w.sMask!==void 0?w.objectId+2:w.objectId+1)+" 0 R]"}):(T.push({key:"ColorSpace",value:"/"+w.colorSpace}),w.colorSpace===x.DEVICE_CMYK&&T.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),T.push({key:"BitsPerComponent",value:w.bitsPerComponent}),"decodeParameters"in w&&w.decodeParameters!==void 0&&T.push({key:"DecodeParms",value:"<<"+w.decodeParameters+">>"}),"transparency"in w&&Array.isArray(w.transparency)){for(var R="",J=0,X=w.transparency.length;J<X;J++)R+=w.transparency[J]+" "+w.transparency[J]+" ";T.push({key:"Mask",value:"["+R+"]"})}w.sMask!==void 0&&T.push({key:"SMask",value:w.objectId+1+" 0 R"});var H=w.filter!==void 0?["/"+w.filter]:void 0;if(j({data:w.data,additionalKeyValues:T,alreadyAppliedFilters:H,objectId:w.objectId}),v("endobj"),"sMask"in w&&w.sMask!==void 0){var se="/Predictor "+w.predictor+" /Colors 1 /BitsPerComponent "+w.bitsPerComponent+" /Columns "+w.width,O={width:w.width,height:w.height,colorSpace:"DeviceGray",bitsPerComponent:w.bitsPerComponent,decodeParameters:se,data:w.sMask};"filter"in w&&(O.filter=w.filter),P.call(this,O)}if(w.colorSpace===x.INDEXED){var _=this.internal.newObject();j({data:E(new Uint8Array(w.palette)),objectId:_}),v("endobj")}},o=function(){var P=this.internal.collections.addImage_images;for(var w in P)i.call(this,P[w])},s=function(){var P,w=this.internal.collections.addImage_images,v=this.internal.write;for(var j in w)v("/I"+(P=w[j]).index,P.objectId,"0","R")},l=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",s))},c=function(){var P=this.internal.collections.addImage_images;return l.call(this),P},d=function(){return Object.keys(this.internal.collections.addImage_images).length},u=function(P){return typeof t["process"+P.toUpperCase()]=="function"},h=function(P){return tn(P)==="object"&&P.nodeType===1},g=function(P,w){if(P.nodeName==="IMG"&&P.hasAttribute("src")){var v=""+P.getAttribute("src");if(v.indexOf("data:image/")===0)return Od(unescape(v).split("base64,").pop());var j=t.loadFile(v,!0);if(j!==void 0)return j}if(P.nodeName==="CANVAS"){if(P.width===0||P.height===0)throw new Error("Given canvas must have data. Canvas width: "+P.width+", height: "+P.height);var z;switch(w){case"PNG":z="image/png";break;case"WEBP":z="image/webp";break;case"JPEG":case"JPG":default:z="image/jpeg"}return Od(P.toDataURL(z,1).split("base64,").pop())}},m=function(P){var w=this.internal.collections.addImage_images;if(w){for(var v in w)if(P===w[v].alias)return w[v]}},S=function(P,w,v){return P||w||(P=-96,w=-96),P<0&&(P=-1*v.width*72/P/this.internal.scaleFactor),w<0&&(w=-1*v.height*72/w/this.internal.scaleFactor),P===0&&(P=w*v.width/v.height),w===0&&(w=P*v.height/v.width),[P,w]},N=function(P,w,v,j,z,T){var R=S.call(this,v,j,z),J=this.internal.getCoordinateString,X=this.internal.getVerticalCoordinateString,H=c.call(this);if(v=R[0],j=R[1],H[z.index]=z,T){T*=Math.PI/180;var se=Math.cos(T),O=Math.sin(T),_=function($){return $.toFixed(4)},k=[_(se),_(O),_(-1*O),_(se),0,0,"cm"]}this.internal.write("q"),T?(this.internal.write([1,"0","0",1,J(P),X(w+j),"cm"].join(" ")),this.internal.write(k.join(" ")),this.internal.write([J(v),"0","0",J(j),"0","0","cm"].join(" "))):this.internal.write([J(v),"0","0",J(j),J(P),X(w+j),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+z.index+" Do"),this.internal.write("Q")},x=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var b=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},K=t.__addimage__.sHashCode=function(P){var w,v,j=0;if(typeof P=="string")for(v=P.length,w=0;w<v;w++)j=(j<<5)-j+P.charCodeAt(w),j|=0;else if(W(P))for(v=P.byteLength/2,w=0;w<v;w++)j=(j<<5)-j+P[w],j|=0;return j},te=t.__addimage__.validateStringAsBase64=function(P){(P=P||"").toString().trim();var w=!0;return P.length===0&&(w=!1),P.length%4!=0&&(w=!1),/^[A-Za-z0-9+/]+$/.test(P.substr(0,P.length-2))===!1&&(w=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(P.substr(-2))===!1&&(w=!1),w},F=t.__addimage__.extractImageFromDataUrl=function(P){if(P==null||!(P=P.trim()).startsWith("data:"))return null;var w=P.indexOf(",");return w<0?null:P.substring(0,w).trim().endsWith("base64")?P.substring(w+1):null},V=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(P){return V()&&P instanceof ArrayBuffer};var W=t.__addimage__.isArrayBufferView=function(P){return V()&&typeof Uint32Array<"u"&&(P instanceof Int8Array||P instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&P instanceof Uint8ClampedArray||P instanceof Int16Array||P instanceof Uint16Array||P instanceof Int32Array||P instanceof Uint32Array||P instanceof Float32Array||P instanceof Float64Array)},I=t.__addimage__.binaryStringToUint8Array=function(P){for(var w=P.length,v=new Uint8Array(w),j=0;j<w;j++)v[j]=P.charCodeAt(j);return v},E=t.__addimage__.arrayBufferToBinaryString=function(P){for(var w="",v=W(P)?P:new Uint8Array(P),j=0;j<v.length;j+=8192)w+=String.fromCharCode.apply(null,v.subarray(j,j+8192));return w};t.addImage=function(){var P,w,v,j,z,T,R,J,X;if(typeof arguments[1]=="number"?(w=e,v=arguments[1],j=arguments[2],z=arguments[3],T=arguments[4],R=arguments[5],J=arguments[6],X=arguments[7]):(w=arguments[1],v=arguments[2],j=arguments[3],z=arguments[4],T=arguments[5],R=arguments[6],J=arguments[7],X=arguments[8]),tn(P=arguments[0])==="object"&&!h(P)&&"imageData"in P){var H=P;P=H.imageData,w=H.format||w||e,v=H.x||v||0,j=H.y||j||0,z=H.w||H.width||z,T=H.h||H.height||T,R=H.alias||R,J=H.compression||J,X=H.rotation||H.angle||X}var se=this.internal.getFilters();if(J===void 0&&se.indexOf("FlateEncode")!==-1&&(J="SLOW"),isNaN(v)||isNaN(j))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var O=L.call(this,P,w,R,J);return N.call(this,v,j,z,T,O,X),this};var L=function(P,w,v,j){var z,T,R;if(typeof P=="string"&&n(P)===e){P=unescape(P);var J=M(P,!1);(J!==""||(J=t.loadFile(P,!0))!==void 0)&&(P=J)}if(h(P)&&(P=g(P,w)),w=n(P,w),!u(w))throw new Error("addImage does not support files of type '"+w+"', please ensure that a plugin for '"+w+"' support is added.");if(((R=v)==null||R.length===0)&&(v=function(X){return typeof X=="string"||W(X)?K(X):W(X.data)?K(X.data):null}(P)),(z=m.call(this,v))||(V()&&(P instanceof Uint8Array||w==="RGBA"||(T=P,P=I(P))),z=this["process"+w.toUpperCase()](P,d.call(this),v,function(X){return X&&typeof X=="string"&&(X=X.toUpperCase()),X in t.image_compression?X:b.NONE}(j),T)),!z)throw new Error("An unknown error occurred whilst processing the image.");return z},M=t.__addimage__.convertBase64ToBinaryString=function(P,w){w=typeof w!="boolean"||w;var v,j="";if(typeof P=="string"){var z;v=(z=F(P))!==null&&z!==void 0?z:P;try{j=Od(v)}catch(T){if(w)throw te(v)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+T.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return j};t.getImageProperties=function(P){var w,v,j="";if(h(P)&&(P=g(P)),typeof P=="string"&&n(P)===e&&((j=M(P,!1))===""&&(j=t.loadFile(P)||""),P=j),v=n(P),!u(v))throw new Error("addImage does not support files of type '"+v+"', please ensure that a plugin for '"+v+"' support is added.");if(!V()||P instanceof Uint8Array||(P=I(P)),!(w=this["process"+v.toUpperCase()](P)))throw new Error("An unknown error occurred whilst processing the image");return w.fileType=v,w}})(cr.API),function(t){var e=function(r){if(r!==void 0&&r!="")return!0};cr.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,i,o,s=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),d=r.pageContext.annotations,u=!1,h=0;h<d.length&&!u;h++)switch((n=d[h]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var g=0;g<d.length;g++){n=d[g];var m=this.internal.pdfEscape,S=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var N=this.internal.newAdditionalObject(),x=this.internal.newAdditionalObject(),b=this.internal.getEncryptor(N.objId),K=n.title||"Note";o="<</Type /Annot /Subtype /Text "+(i="/Rect ["+s(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+m(b(n.contents))+")",o+=" /Popup "+x.objId+" 0 R",o+=" /P "+c.objId+" 0 R",o+=" /T ("+m(b(K))+") >>",N.content=o;var te=N.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+s(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+te,n.open&&(o+=" /Open true"),o+=" >>",x.content=o,this.internal.write(N.objId,"0 R",x.objId,"0 R");break;case"freetext":i="/Rect ["+s(n.bounds.x)+" "+l(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var F=n.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+m(S(n.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+F+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(n.options.name){var V=this.annotations._nameMap[n.options.name];n.options.pageNumber=V.page,n.options.top=V.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",o="",n.options.url)o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+m(S(n.options.url))+") >>";else if(n.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,o+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var W=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),o+=" /XYZ "+n.options.left+" "+W+" "+n.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,i,o,s){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:d(n),w:c(r+i),h:d(n+o)},options:s,type:"link"})},t.textWithLink=function(r,n,i,o){var s,l,c=this.getTextWidth(r),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){l=o.maxWidth;var u=this.splitTextToSize(r,l).length;s=Math.ceil(d*u)}else l=c,s=d;return this.text(r,n,i,o),i+=.2*d,o.align==="center"&&(n-=c/2),o.align==="right"&&(n-=c),this.link(n,i-d,l,s,o),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(cr.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var o=t.__arabicParser__.isInArabicSubstitutionA=function(N){return e[N.charCodeAt(0)]!==void 0},s=t.__arabicParser__.isArabicLetter=function(N){return typeof N=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(N)},l=t.__arabicParser__.isArabicEndLetter=function(N){return s(N)&&o(N)&&e[N.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(N){return s(N)&&i.indexOf(N.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(N){return s(N)&&o(N)&&e[N.charCodeAt(0)].length>=1};var d=t.__arabicParser__.arabicLetterHasFinalForm=function(N){return s(N)&&o(N)&&e[N.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(N){return s(N)&&o(N)&&e[N.charCodeAt(0)].length>=3};var u=t.__arabicParser__.arabicLetterHasMedialForm=function(N){return s(N)&&o(N)&&e[N.charCodeAt(0)].length==4},h=t.__arabicParser__.resolveLigatures=function(N){var x=0,b=r,K="",te=0;for(x=0;x<N.length;x+=1)b[N.charCodeAt(x)]!==void 0?(te++,typeof(b=b[N.charCodeAt(x)])=="number"&&(K+=String.fromCharCode(b),b=r,te=0),x===N.length-1&&(b=r,K+=N.charAt(x-(te-1)),x-=te-1,te=0)):(b=r,K+=N.charAt(x-te),x-=te,te=0);return K};t.__arabicParser__.isArabicDiacritic=function(N){return N!==void 0&&n[N.charCodeAt(0)]!==void 0};var g=t.__arabicParser__.getCorrectForm=function(N,x,b){return s(N)?o(N)===!1?-1:!d(N)||!s(x)&&!s(b)||!s(b)&&l(x)||l(N)&&!s(x)||l(N)&&c(x)||l(N)&&l(x)?0:u(N)&&s(x)&&!l(x)&&s(b)&&d(b)?3:l(N)||!s(b)?1:2:-1},m=function(N){var x=0,b=0,K=0,te="",F="",V="",W=(N=N||"").split("\\s+"),I=[];for(x=0;x<W.length;x+=1){for(I.push(""),b=0;b<W[x].length;b+=1)te=W[x][b],F=W[x][b-1],V=W[x][b+1],s(te)?(K=g(te,F,V),I[x]+=K!==-1?String.fromCharCode(e[te.charCodeAt(0)][K]):te):I[x]+=te;I[x]=h(I[x])}return I.join(" ")},S=t.__arabicParser__.processArabic=t.processArabic=function(){var N,x=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,b=[];if(Array.isArray(x)){var K=0;for(b=[],K=0;K<x.length;K+=1)Array.isArray(x[K])?b.push([m(x[K][0]),x[K][1],x[K][2]]):b.push([m(x[K])]);N=b}else N=m(x);return typeof arguments[0]=="string"?N:(arguments[0].text=N,arguments[0])};t.events.push(["preProcessText",S])}(cr.API),cr.API.autoPrint=function(t){var e;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(l){i=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(l){o=l}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(l){s=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(cr.API),function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(N){c=N}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(N){d=N}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(N){u=N}});var h=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return h},set:function(N){h=N}});var g=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return g},set:function(N){g=N}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(N){m=N}});var S=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return S},set:function(N){S=N}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,d){n.call(this);var u=(d=d||{}).fontSize||this.getFontSize(),h=d.font||this.getFont(),g=d.scaleFactor||this.internal.scaleFactor,m=0,S=0,N=0,x=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var b=d.maxWidth;b>0?typeof c=="string"?c=this.splitTextToSize(c,b):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(te,F){return te.concat(x.splitTextToSize(F,b))},[])):c=Array.isArray(c)?c:[c];for(var K=0;K<c.length;K++)m<(N=this.getStringUnitWidth(c[K],{font:h})*u)&&(m=N);return m!==0&&(S=c.length),{w:m/=g,h:Math.max((S*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/g,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new o(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=t.cell=function(){var c;c=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var d=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,h=this.internal.__cell__.margins||e,g=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===c.lineNumber?(c.x=(d.x||0)+(d.width||0),c.y=d.y||0):d.y+d.height+c.height+h.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=h.top,m&&g&&(this.printHeaderRow(c.lineNumber,!0),c.y+=g[0].height)):c.y=d.y+d.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};t.table=function(c,d,u,h,g){if(n.call(this),!u)throw new Error("No data for PDF table.");var m,S,N,x,b=[],K=[],te=[],F={},V={},W=[],I=[],E=(g=g||{}).autoSize||!1,L=g.printHeaders!==!1,M=g.css&&g.css["font-size"]!==void 0?16*g.css["font-size"]:g.fontSize||12,P=g.margins||Object.assign({width:this.getPageWidth()},e),w=typeof g.padding=="number"?g.padding:3,v=g.headerBackgroundColor||"#c8c8c8",j=g.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=L,this.internal.__cell__.margins=P,this.internal.__cell__.table_font_size=M,this.internal.__cell__.padding=w,this.internal.__cell__.headerBackgroundColor=v,this.internal.__cell__.headerTextColor=j,this.setFontSize(M),h==null)K=b=Object.keys(u[0]),te=b.map(function(){return"left"});else if(Array.isArray(h)&&tn(h[0])==="object")for(b=h.map(function(H){return H.name}),K=h.map(function(H){return H.prompt||H.name||""}),te=h.map(function(H){return H.align||"left"}),m=0;m<h.length;m+=1)V[h[m].name]=h[m].width*(19.049976/25.4);else Array.isArray(h)&&typeof h[0]=="string"&&(K=b=h,te=b.map(function(){return"left"}));if(E||Array.isArray(h)&&typeof h[0]=="string")for(m=0;m<b.length;m+=1){for(F[x=b[m]]=u.map(function(H){return H[x]}),this.setFont(void 0,"bold"),W.push(this.getTextDimensions(K[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),S=F[x],this.setFont(void 0,"normal"),N=0;N<S.length;N+=1)W.push(this.getTextDimensions(S[N],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);V[x]=Math.max.apply(null,W)+w+w,W=[]}if(L){var z={};for(m=0;m<b.length;m+=1)z[b[m]]={},z[b[m]].text=K[m],z[b[m]].align=te[m];var T=l.call(this,z,V);I=b.map(function(H){return new o(c,d,V[H],T,z[H].text,void 0,z[H].align)}),this.setTableHeaderRow(I),this.printHeaderRow(1,!1)}var R=h.reduce(function(H,se){return H[se.name]=se.align,H},{});for(m=0;m<u.length;m+=1){"rowStart"in g&&g.rowStart instanceof Function&&g.rowStart({row:m,data:u[m]},this);var J=l.call(this,u[m],V);for(N=0;N<b.length;N+=1){var X=u[m][b[N]];"cellStart"in g&&g.cellStart instanceof Function&&g.cellStart({row:m,col:N,data:X},this),s.call(this,new o(c,d,V[b[N]],J,X,m+2,R[b[N]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=d,this};var l=function(c,d){var u=this.internal.__cell__.padding,h=this.internal.__cell__.table_font_size,g=this.internal.scaleFactor;return Object.keys(c).map(function(m){var S=c[m];return this.splitTextToSize(S.hasOwnProperty("text")?S.text:S,d[m]-u-u)},this).map(function(m){return this.getLineHeightFactor()*m.length*h/g+u+u},this).reduce(function(m,S){return Math.max(m,S)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,d){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var h=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(h[0],h[1],h[2],h[3],void 0,-1)}this.setFont(void 0,"bold");for(var g=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){u=this.internal.__cell__.tableHeaderRow[m].clone(),d&&(u.y=this.internal.__cell__.margins.top||0,g.push(u)),u.lineNumber=c;var S=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,u),this.setTextColor(S)}g.length>0&&this.setTableHeaderRow(g),this.setFont(void 0,"normal"),r=!1}}(cr.API);var ZP={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},e_=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],df=XP(e_),t_=[100,200,300,400,500,600,700,800,900],XL=XP(t_);function uf(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=function(o){return ZP[o=o||"normal"]?o:"normal"}(t.style),n=function(o){if(!o)return 400;if(typeof o=="number")return o>=100&&o<=900&&o%100==0?o:400;if(/^\d00$/.test(o))return parseInt(o);switch(o){case"bold":return 700;case"normal":default:return 400}}(t.weight),i=function(o){return typeof df[o=o||"normal"]=="number"?o:"normal"}(t.stretch);return{family:e,style:r,weight:n,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,r,n].join(" ")}}}function I1(t,e,r,n){var i;for(i=r;i>=0&&i<e.length;i+=n)if(t[e[i]])return t[e[i]];for(i=r;i>=0&&i<e.length;i-=n)if(t[e[i]])return t[e[i]]}var ZL={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},T1={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function k1(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function e8(t,e,r){for(var n=(r=r||{}).defaultFontFamily||"times",i=Object.assign({},ZL,r.genericFontFamilies||{}),o=null,s=null,l=0;l<e.length;++l)if(i[(o=uf(e[l])).family]&&(o.family=i[o.family]),t.hasOwnProperty(o.family)){s=t[o.family];break}if(!(s=s||t[n]))throw new Error("Could not find a font-family for the rule '"+k1(o)+"' and default family '"+n+"'.");if(s=function(c,d){if(d[c])return d[c];var u=df[c],h=u<=df.normal?-1:1,g=I1(d,e_,u,h);if(!g)throw new Error("Could not find a matching font-stretch value for "+c);return g}(o.stretch,s),s=function(c,d){if(d[c])return d[c];for(var u=ZP[c],h=0;h<u.length;++h)if(d[u[h]])return d[u[h]];throw new Error("Could not find a matching font-style for "+c)}(o.style,s),!(s=function(c,d){if(d[c])return d[c];if(c===400&&d[500])return d[500];if(c===500&&d[400])return d[400];var u=XL[c],h=I1(d,t_,u,c<400?-1:1);if(!h)throw new Error("Could not find a matching font-weight for value "+c);return h}(o.weight,s)))throw new Error("Failed to resolve a font for the rule '"+k1(o)+"'.");return s}function N1(t){return t.trimLeft()}function t8(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function r8(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var uh,L1,R1,ny=["times"];(function(t){var e,r,n,i,o,s,l,c,d,u=function(O){return O=O||{},this.isStrokeTransparent=O.isStrokeTransparent||!1,this.strokeOpacity=O.strokeOpacity||1,this.strokeStyle=O.strokeStyle||"#000000",this.fillStyle=O.fillStyle||"#000000",this.isFillTransparent=O.isFillTransparent||!1,this.fillOpacity=O.fillOpacity||1,this.font=O.font||"10px sans-serif",this.textBaseline=O.textBaseline||"alphabetic",this.textAlign=O.textAlign||"left",this.lineWidth=O.lineWidth||1,this.lineJoin=O.lineJoin||"miter",this.lineCap=O.lineCap||"butt",this.path=O.path||[],this.transform=O.transform!==void 0?O.transform.clone():new c,this.globalCompositeOperation=O.globalCompositeOperation||"normal",this.globalAlpha=O.globalAlpha||1,this.clip_path=O.clip_path||[],this.currentPoint=O.currentPoint||new s,this.miterLimit=O.miterLimit||10,this.lastPoint=O.lastPoint||new s,this.lineDashOffset=O.lineDashOffset||0,this.lineDash=O.lineDash||[],this.margin=O.margin||[0,0,0,0],this.prevPageLastElemOffset=O.prevPageLastElemOffset||0,this.ignoreClearRect=typeof O.ignoreClearRect!="boolean"||O.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new h(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,s=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,d=new u}]);var h=function(O){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var _=O;Object.defineProperty(this,"pdf",{get:function(){return _}});var k=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return k},set:function(re){k=!!re}});var $=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return $},set:function(re){$=!!re}});var G=0;Object.defineProperty(this,"posX",{get:function(){return G},set:function(re){isNaN(re)||(G=re)}});var ne=0;Object.defineProperty(this,"posY",{get:function(){return ne},set:function(re){isNaN(re)||(ne=re)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(re){var Y;typeof re=="number"?Y=[re,re,re,re]:((Y=new Array(4))[0]=re[0],Y[1]=re.length>=2?re[1]:Y[0],Y[2]=re.length>=3?re[2]:Y[0],Y[3]=re.length>=4?re[3]:Y[1]),d.margin=Y}});var U=!1;Object.defineProperty(this,"autoPaging",{get:function(){return U},set:function(re){U=re}});var D=0;Object.defineProperty(this,"lastBreak",{get:function(){return D},set:function(re){D=re}});var B=[];Object.defineProperty(this,"pageBreaks",{get:function(){return B},set:function(re){B=re}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(re){re instanceof u&&(d=re)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(re){d.path=re}});var Q=[];Object.defineProperty(this,"ctxStack",{get:function(){return Q},set:function(re){Q=re}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(re){var Y;Y=g(re),this.ctx.fillStyle=Y.style,this.ctx.isFillTransparent=Y.a===0,this.ctx.fillOpacity=Y.a,this.pdf.setFillColor(Y.r,Y.g,Y.b,{a:Y.a}),this.pdf.setTextColor(Y.r,Y.g,Y.b,{a:Y.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(re){var Y=g(re);this.ctx.strokeStyle=Y.style,this.ctx.isStrokeTransparent=Y.a===0,this.ctx.strokeOpacity=Y.a,Y.a===0?this.pdf.setDrawColor(255,255,255):(Y.a,this.pdf.setDrawColor(Y.r,Y.g,Y.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(re){["butt","round","square"].indexOf(re)!==-1&&(this.ctx.lineCap=re,this.pdf.setLineCap(re))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(re){isNaN(re)||(this.ctx.lineWidth=re,this.pdf.setLineWidth(re))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(re){["bevel","round","miter"].indexOf(re)!==-1&&(this.ctx.lineJoin=re,this.pdf.setLineJoin(re))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(re){isNaN(re)||(this.ctx.miterLimit=re,this.pdf.setMiterLimit(re))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(re){this.ctx.textBaseline=re}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(re){["right","end","center","left","start"].indexOf(re)!==-1&&(this.ctx.textAlign=re)}});var Z=null;function oe(re,Y){if(Z===null){var ce=function(ue){var ae=[];return Object.keys(ue).forEach(function(ye){ue[ye].forEach(function(me){var pe=null;switch(me){case"bold":pe={family:ye,weight:"bold"};break;case"italic":pe={family:ye,style:"italic"};break;case"bolditalic":pe={family:ye,weight:"bold",style:"italic"};break;case"":case"normal":pe={family:ye}}pe!==null&&(pe.ref={name:ye,style:me},ae.push(pe))})}),ae}(re.getFontList());Z=function(ue){for(var ae={},ye=0;ye<ue.length;++ye){var me=uf(ue[ye]),pe=me.family,ve=me.stretch,Ne=me.style,Ie=me.weight;ae[pe]=ae[pe]||{},ae[pe][ve]=ae[pe][ve]||{},ae[pe][ve][Ne]=ae[pe][ve][Ne]||{},ae[pe][ve][Ne][Ie]=me}return ae}(ce.concat(Y))}return Z}var de=null;Object.defineProperty(this,"fontFaces",{get:function(){return de},set:function(re){Z=null,de=re}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(re){var Y;if(this.ctx.font=re,(Y=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(re))!==null){var ce=Y[1];Y[2];var ue=Y[3],ae=Y[4];Y[5];var ye=Y[6],me=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ae)[2];ae=Math.floor(me==="px"?parseFloat(ae)*this.pdf.internal.scaleFactor:me==="em"?parseFloat(ae)*this.pdf.getFontSize():parseFloat(ae)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ae);var pe=function(Re){var He,je,Ve=[],qe=Re.trim();if(qe==="")return ny;if(qe in T1)return[T1[qe]];for(;qe!=="";){switch(je=null,He=(qe=N1(qe)).charAt(0)){case'"':case"'":je=t8(qe.substring(1),He);break;default:je=r8(qe)}if(je===null||(Ve.push(je[0]),(qe=N1(je[1]))!==""&&qe.charAt(0)!==","))return ny;qe=qe.replace(/^,/,"")}return Ve}(ye);if(this.fontFaces){var ve=e8(oe(this.pdf,this.fontFaces),pe.map(function(Re){return{family:Re,stretch:"normal",weight:ue,style:ce}}));this.pdf.setFont(ve.ref.name,ve.ref.style)}else{var Ne="";(ue==="bold"||parseInt(ue,10)>=700||ce==="bold")&&(Ne="bold"),ce==="italic"&&(Ne+="italic"),Ne.length===0&&(Ne="normal");for(var Ie="",Ce={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ee=0;Ee<pe.length;Ee++){if(this.pdf.internal.getFont(pe[Ee],Ne,{noFallback:!0,disableWarning:!0})!==void 0){Ie=pe[Ee];break}if(Ne==="bolditalic"&&this.pdf.internal.getFont(pe[Ee],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Ie=pe[Ee],Ne="bold";else if(this.pdf.internal.getFont(pe[Ee],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Ie=pe[Ee],Ne="normal";break}}if(Ie===""){for(var we=0;we<pe.length;we++)if(Ce[pe[we]]){Ie=Ce[pe[we]];break}}Ie=Ie===""?"Times":Ie,this.pdf.setFont(Ie,Ne)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(re){this.ctx.globalCompositeOperation=re}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(re){this.ctx.globalAlpha=re}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(re){this.ctx.lineDashOffset=re,se.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(re){this.ctx.lineDash=re,se.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(re){this.ctx.ignoreClearRect=!!re}})};h.prototype.setLineDash=function(O){this.lineDash=O},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){F.call(this,"fill",!1)},h.prototype.stroke=function(){F.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(O,_){if(isNaN(O)||isNaN(_))throw ln.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var k=this.ctx.transform.applyToPoint(new s(O,_));this.path.push({type:"mt",x:k.x,y:k.y}),this.ctx.lastPoint=new s(O,_)},h.prototype.closePath=function(){var O=new s(0,0),_=0;for(_=this.path.length-1;_!==-1;_--)if(this.path[_].type==="begin"&&tn(this.path[_+1])==="object"&&typeof this.path[_+1].x=="number"){O=new s(this.path[_+1].x,this.path[_+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(O.x,O.y)},h.prototype.lineTo=function(O,_){if(isNaN(O)||isNaN(_))throw ln.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var k=this.ctx.transform.applyToPoint(new s(O,_));this.path.push({type:"lt",x:k.x,y:k.y}),this.ctx.lastPoint=new s(k.x,k.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),F.call(this,null,!0)},h.prototype.quadraticCurveTo=function(O,_,k,$){if(isNaN(k)||isNaN($)||isNaN(O)||isNaN(_))throw ln.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var G=this.ctx.transform.applyToPoint(new s(k,$)),ne=this.ctx.transform.applyToPoint(new s(O,_));this.path.push({type:"qct",x1:ne.x,y1:ne.y,x:G.x,y:G.y}),this.ctx.lastPoint=new s(G.x,G.y)},h.prototype.bezierCurveTo=function(O,_,k,$,G,ne){if(isNaN(G)||isNaN(ne)||isNaN(O)||isNaN(_)||isNaN(k)||isNaN($))throw ln.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var U=this.ctx.transform.applyToPoint(new s(G,ne)),D=this.ctx.transform.applyToPoint(new s(O,_)),B=this.ctx.transform.applyToPoint(new s(k,$));this.path.push({type:"bct",x1:D.x,y1:D.y,x2:B.x,y2:B.y,x:U.x,y:U.y}),this.ctx.lastPoint=new s(U.x,U.y)},h.prototype.arc=function(O,_,k,$,G,ne){if(isNaN(O)||isNaN(_)||isNaN(k)||isNaN($)||isNaN(G))throw ln.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ne=!!ne,!this.ctx.transform.isIdentity){var U=this.ctx.transform.applyToPoint(new s(O,_));O=U.x,_=U.y;var D=this.ctx.transform.applyToPoint(new s(0,k)),B=this.ctx.transform.applyToPoint(new s(0,0));k=Math.sqrt(Math.pow(D.x-B.x,2)+Math.pow(D.y-B.y,2))}Math.abs(G-$)>=2*Math.PI&&($=0,G=2*Math.PI),this.path.push({type:"arc",x:O,y:_,radius:k,startAngle:$,endAngle:G,counterclockwise:ne})},h.prototype.arcTo=function(O,_,k,$,G){throw new Error("arcTo not implemented.")},h.prototype.rect=function(O,_,k,$){if(isNaN(O)||isNaN(_)||isNaN(k)||isNaN($))throw ln.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(O,_),this.lineTo(O+k,_),this.lineTo(O+k,_+$),this.lineTo(O,_+$),this.lineTo(O,_),this.lineTo(O+k,_),this.lineTo(O,_)},h.prototype.fillRect=function(O,_,k,$){if(isNaN(O)||isNaN(_)||isNaN(k)||isNaN($))throw ln.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var G={};this.lineCap!=="butt"&&(G.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(G.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(O,_,k,$),this.fill(),G.hasOwnProperty("lineCap")&&(this.lineCap=G.lineCap),G.hasOwnProperty("lineJoin")&&(this.lineJoin=G.lineJoin)}},h.prototype.strokeRect=function(O,_,k,$){if(isNaN(O)||isNaN(_)||isNaN(k)||isNaN($))throw ln.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");S.call(this)||(this.beginPath(),this.rect(O,_,k,$),this.stroke())},h.prototype.clearRect=function(O,_,k,$){if(isNaN(O)||isNaN(_)||isNaN(k)||isNaN($))throw ln.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(O,_,k,$))},h.prototype.save=function(O){O=typeof O!="boolean"||O;for(var _=this.pdf.internal.getCurrentPageInfo().pageNumber,k=0;k<this.pdf.internal.getNumberOfPages();k++)this.pdf.setPage(k+1),this.pdf.internal.out("q");if(this.pdf.setPage(_),O){this.ctx.fontSize=this.pdf.internal.getFontSize();var $=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=$}},h.prototype.restore=function(O){O=typeof O!="boolean"||O;for(var _=this.pdf.internal.getCurrentPageInfo().pageNumber,k=0;k<this.pdf.internal.getNumberOfPages();k++)this.pdf.setPage(k+1),this.pdf.internal.out("Q");this.pdf.setPage(_),O&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var g=function(O){var _,k,$,G;if(O.isCanvasGradient===!0&&(O=O.getColor()),!O)return{r:0,g:0,b:0,a:0,style:O};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(O))_=0,k=0,$=0,G=0;else{var ne=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(O);if(ne!==null)_=parseInt(ne[1]),k=parseInt(ne[2]),$=parseInt(ne[3]),G=1;else if((ne=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(O))!==null)_=parseInt(ne[1]),k=parseInt(ne[2]),$=parseInt(ne[3]),G=parseFloat(ne[4]);else{if(G=1,typeof O=="string"&&O.charAt(0)!=="#"){var U=new GP(O);O=U.ok?U.toHex():"#000000"}O.length===4?(_=O.substring(1,2),_+=_,k=O.substring(2,3),k+=k,$=O.substring(3,4),$+=$):(_=O.substring(1,3),k=O.substring(3,5),$=O.substring(5,7)),_=parseInt(_,16),k=parseInt(k,16),$=parseInt($,16)}}return{r:_,g:k,b:$,a:G,style:O}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},S=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};h.prototype.fillText=function(O,_,k,$){if(isNaN(_)||isNaN(k)||typeof O!="string")throw ln.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if($=isNaN($)?void 0:$,!m.call(this)){var G=J(this.ctx.transform.rotation),ne=this.ctx.transform.scaleX;w.call(this,{text:O,x:_,y:k,scale:ne,angle:G,align:this.textAlign,maxWidth:$})}},h.prototype.strokeText=function(O,_,k,$){if(isNaN(_)||isNaN(k)||typeof O!="string")throw ln.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!S.call(this)){$=isNaN($)?void 0:$;var G=J(this.ctx.transform.rotation),ne=this.ctx.transform.scaleX;w.call(this,{text:O,x:_,y:k,scale:ne,renderingMode:"stroke",angle:G,align:this.textAlign,maxWidth:$})}},h.prototype.measureText=function(O){if(typeof O!="string")throw ln.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var _=this.pdf,k=this.pdf.internal.scaleFactor,$=_.internal.getFontSize(),G=_.getStringUnitWidth(O)*$/_.internal.scaleFactor,ne=function(U){var D=(U=U||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return D}}),this};return new ne({width:G*=Math.round(96*k/72*1e4)/1e4})},h.prototype.scale=function(O,_){if(isNaN(O)||isNaN(_))throw ln.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var k=new c(O,0,0,_,0,0);this.ctx.transform=this.ctx.transform.multiply(k)},h.prototype.rotate=function(O){if(isNaN(O))throw ln.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var _=new c(Math.cos(O),Math.sin(O),-Math.sin(O),Math.cos(O),0,0);this.ctx.transform=this.ctx.transform.multiply(_)},h.prototype.translate=function(O,_){if(isNaN(O)||isNaN(_))throw ln.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var k=new c(1,0,0,1,O,_);this.ctx.transform=this.ctx.transform.multiply(k)},h.prototype.transform=function(O,_,k,$,G,ne){if(isNaN(O)||isNaN(_)||isNaN(k)||isNaN($)||isNaN(G)||isNaN(ne))throw ln.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var U=new c(O,_,k,$,G,ne);this.ctx.transform=this.ctx.transform.multiply(U)},h.prototype.setTransform=function(O,_,k,$,G,ne){O=isNaN(O)?1:O,_=isNaN(_)?0:_,k=isNaN(k)?0:k,$=isNaN($)?1:$,G=isNaN(G)?0:G,ne=isNaN(ne)?0:ne,this.ctx.transform=new c(O,_,k,$,G,ne)};var N=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(O,_,k,$,G,ne,U,D,B){var Q=this.pdf.getImageProperties(O),Z=1,oe=1,de=1,re=1;$!==void 0&&D!==void 0&&(de=D/$,re=B/G,Z=Q.width/$*D/$,oe=Q.height/G*B/G),ne===void 0&&(ne=_,U=k,_=0,k=0),$!==void 0&&D===void 0&&(D=$,B=G),$===void 0&&D===void 0&&(D=Q.width,B=Q.height);for(var Y,ce=this.ctx.transform.decompose(),ue=J(ce.rotate.shx),ae=new c,ye=(ae=(ae=(ae=ae.multiply(ce.translate)).multiply(ce.skew)).multiply(ce.scale)).applyToRectangle(new l(ne-_*de,U-k*re,$*Z,G*oe)),me=x.call(this,ye),pe=[],ve=0;ve<me.length;ve+=1)pe.indexOf(me[ve])===-1&&pe.push(me[ve]);if(te(pe),this.autoPaging)for(var Ne=pe[0],Ie=pe[pe.length-1],Ce=Ne;Ce<Ie+1;Ce++){this.pdf.setPage(Ce);var Ee=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],we=Ce===1?this.posY+this.margin[0]:this.margin[0],Re=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],He=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],je=Ce===1?0:Re+(Ce-2)*He;if(this.ctx.clip_path.length!==0){var Ve=this.path;Y=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=K(Y,this.posX+this.margin[3],-je+we+this.ctx.prevPageLastElemOffset),V.call(this,"fill",!0),this.path=Ve}var qe=JSON.parse(JSON.stringify(ye));qe=K([qe],this.posX+this.margin[3],-je+we+this.ctx.prevPageLastElemOffset)[0];var tt=(Ce>Ne||Ce<Ie)&&N.call(this);tt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ee,He,null).clip().discardPath()),this.pdf.addImage(O,"JPEG",qe.x,qe.y,qe.w,qe.h,null,null,ue),tt&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(O,"JPEG",ye.x,ye.y,ye.w,ye.h,null,null,ue)};var x=function(O,_,k){var $=[];_=_||this.pdf.internal.pageSize.width,k=k||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var G=this.posY+this.ctx.prevPageLastElemOffset;switch(O.type){default:case"mt":case"lt":$.push(Math.floor((O.y+G)/k)+1);break;case"arc":$.push(Math.floor((O.y+G-O.radius)/k)+1),$.push(Math.floor((O.y+G+O.radius)/k)+1);break;case"qct":var ne=X(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x,O.y);$.push(Math.floor((ne.y+G)/k)+1),$.push(Math.floor((ne.y+ne.h+G)/k)+1);break;case"bct":var U=H(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x2,O.y2,O.x,O.y);$.push(Math.floor((U.y+G)/k)+1),$.push(Math.floor((U.y+U.h+G)/k)+1);break;case"rect":$.push(Math.floor((O.y+G)/k)+1),$.push(Math.floor((O.y+O.h+G)/k)+1)}for(var D=0;D<$.length;D+=1)for(;this.pdf.internal.getNumberOfPages()<$[D];)b.call(this);return $},b=function(){var O=this.fillStyle,_=this.strokeStyle,k=this.font,$=this.lineCap,G=this.lineWidth,ne=this.lineJoin;this.pdf.addPage(),this.fillStyle=O,this.strokeStyle=_,this.font=k,this.lineCap=$,this.lineWidth=G,this.lineJoin=ne},K=function(O,_,k){for(var $=0;$<O.length;$++)switch(O[$].type){case"bct":O[$].x2+=_,O[$].y2+=k;case"qct":O[$].x1+=_,O[$].y1+=k;case"mt":case"lt":case"arc":default:O[$].x+=_,O[$].y+=k}return O},te=function(O){return O.sort(function(_,k){return _-k})},F=function(O,_){for(var k,$,G=this.fillStyle,ne=this.strokeStyle,U=this.lineCap,D=this.lineWidth,B=Math.abs(D*this.ctx.transform.scaleX),Q=this.lineJoin,Z=JSON.parse(JSON.stringify(this.path)),oe=JSON.parse(JSON.stringify(this.path)),de=[],re=0;re<oe.length;re++)if(oe[re].x!==void 0)for(var Y=x.call(this,oe[re]),ce=0;ce<Y.length;ce+=1)de.indexOf(Y[ce])===-1&&de.push(Y[ce]);for(var ue=0;ue<de.length;ue++)for(;this.pdf.internal.getNumberOfPages()<de[ue];)b.call(this);if(te(de),this.autoPaging)for(var ae=de[0],ye=de[de.length-1],me=ae;me<ye+1;me++){this.pdf.setPage(me),this.fillStyle=G,this.strokeStyle=ne,this.lineCap=U,this.lineWidth=B,this.lineJoin=Q;var pe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ve=me===1?this.posY+this.margin[0]:this.margin[0],Ne=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ie=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ce=me===1?0:Ne+(me-2)*Ie;if(this.ctx.clip_path.length!==0){var Ee=this.path;k=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=K(k,this.posX+this.margin[3],-Ce+ve+this.ctx.prevPageLastElemOffset),V.call(this,O,!0),this.path=Ee}if($=JSON.parse(JSON.stringify(Z)),this.path=K($,this.posX+this.margin[3],-Ce+ve+this.ctx.prevPageLastElemOffset),_===!1||me===0){var we=(me>ae||me<ye)&&N.call(this);we&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],pe,Ie,null).clip().discardPath()),V.call(this,O,_),we&&this.pdf.restoreGraphicsState()}this.lineWidth=D}else this.lineWidth=B,V.call(this,O,_),this.lineWidth=D;this.path=Z},V=function(O,_){if((O!=="stroke"||_||!S.call(this))&&(O==="stroke"||_||!m.call(this))){for(var k,$,G=[],ne=this.path,U=0;U<ne.length;U++){var D=ne[U];switch(D.type){case"begin":G.push({begin:!0});break;case"close":G.push({close:!0});break;case"mt":G.push({start:D,deltas:[],abs:[]});break;case"lt":var B=G.length;if(ne[U-1]&&!isNaN(ne[U-1].x)&&(k=[D.x-ne[U-1].x,D.y-ne[U-1].y],B>0)){for(;B>=0;B--)if(G[B-1].close!==!0&&G[B-1].begin!==!0){G[B-1].deltas.push(k),G[B-1].abs.push(D);break}}break;case"bct":k=[D.x1-ne[U-1].x,D.y1-ne[U-1].y,D.x2-ne[U-1].x,D.y2-ne[U-1].y,D.x-ne[U-1].x,D.y-ne[U-1].y],G[G.length-1].deltas.push(k);break;case"qct":var Q=ne[U-1].x+2/3*(D.x1-ne[U-1].x),Z=ne[U-1].y+2/3*(D.y1-ne[U-1].y),oe=D.x+2/3*(D.x1-D.x),de=D.y+2/3*(D.y1-D.y),re=D.x,Y=D.y;k=[Q-ne[U-1].x,Z-ne[U-1].y,oe-ne[U-1].x,de-ne[U-1].y,re-ne[U-1].x,Y-ne[U-1].y],G[G.length-1].deltas.push(k);break;case"arc":G.push({deltas:[],abs:[],arc:!0}),Array.isArray(G[G.length-1].abs)&&G[G.length-1].abs.push(D)}}$=_?null:O==="stroke"?"stroke":"fill";for(var ce=!1,ue=0;ue<G.length;ue++)if(G[ue].arc)for(var ae=G[ue].abs,ye=0;ye<ae.length;ye++){var me=ae[ye];me.type==="arc"?E.call(this,me.x,me.y,me.radius,me.startAngle,me.endAngle,me.counterclockwise,void 0,_,!ce):v.call(this,me.x,me.y),ce=!0}else if(G[ue].close===!0)this.pdf.internal.out("h"),ce=!1;else if(G[ue].begin!==!0){var pe=G[ue].start.x,ve=G[ue].start.y;j.call(this,G[ue].deltas,pe,ve),ce=!0}$&&L.call(this,$),_&&M.call(this)}},W=function(O){var _=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,k=_*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return O-k;case"top":return O+_-k;case"hanging":return O+_-2*k;case"middle":return O+_/2-k;case"ideographic":return O;case"alphabetic":default:return O}},I=function(O){return O+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var O=function(){};return O.colorStops=[],O.addColorStop=function(_,k){this.colorStops.push([_,k])},O.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},O.isCanvasGradient=!0,O},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var E=function(O,_,k,$,G,ne,U,D,B){for(var Q=T.call(this,k,$,G,ne),Z=0;Z<Q.length;Z++){var oe=Q[Z];Z===0&&(B?P.call(this,oe.x1+O,oe.y1+_):v.call(this,oe.x1+O,oe.y1+_)),z.call(this,O,_,oe.x2,oe.y2,oe.x3,oe.y3,oe.x4,oe.y4)}D?M.call(this):L.call(this,U)},L=function(O){switch(O){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},M=function(){this.pdf.clip(),this.pdf.discardPath()},P=function(O,_){this.pdf.internal.out(r(O)+" "+n(_)+" m")},w=function(O){var _;switch(O.align){case"right":case"end":_="right";break;case"center":_="center";break;case"left":case"start":default:_="left"}var k=this.pdf.getTextDimensions(O.text),$=W.call(this,O.y),G=I.call(this,$)-k.h,ne=this.ctx.transform.applyToPoint(new s(O.x,$)),U=this.ctx.transform.decompose(),D=new c;D=(D=(D=D.multiply(U.translate)).multiply(U.skew)).multiply(U.scale);for(var B,Q,Z,oe=this.ctx.transform.applyToRectangle(new l(O.x,$,k.w,k.h)),de=D.applyToRectangle(new l(O.x,G,k.w,k.h)),re=x.call(this,de),Y=[],ce=0;ce<re.length;ce+=1)Y.indexOf(re[ce])===-1&&Y.push(re[ce]);if(te(Y),this.autoPaging)for(var ue=Y[0],ae=Y[Y.length-1],ye=ue;ye<ae+1;ye++){this.pdf.setPage(ye);var me=ye===1?this.posY+this.margin[0]:this.margin[0],pe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ve=this.pdf.internal.pageSize.height-this.margin[2],Ne=ve-this.margin[0],Ie=this.pdf.internal.pageSize.width-this.margin[1],Ce=Ie-this.margin[3],Ee=ye===1?0:pe+(ye-2)*Ne;if(this.ctx.clip_path.length!==0){var we=this.path;B=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=K(B,this.posX+this.margin[3],-1*Ee+me),V.call(this,"fill",!0),this.path=we}var Re=K([JSON.parse(JSON.stringify(de))],this.posX+this.margin[3],-Ee+me+this.ctx.prevPageLastElemOffset)[0];O.scale>=.01&&(Q=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Q*O.scale),Z=this.lineWidth,this.lineWidth=Z*O.scale);var He=this.autoPaging!=="text";if(He||Re.y+Re.h<=ve){if(He||Re.y>=me&&Re.x<=Ie){var je=He?O.text:this.pdf.splitTextToSize(O.text,O.maxWidth||Ie-Re.x)[0],Ve=K([JSON.parse(JSON.stringify(oe))],this.posX+this.margin[3],-Ee+me+this.ctx.prevPageLastElemOffset)[0],qe=He&&(ye>ue||ye<ae)&&N.call(this);qe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ce,Ne,null).clip().discardPath()),this.pdf.text(je,Ve.x,Ve.y,{angle:O.angle,align:_,renderingMode:O.renderingMode}),qe&&this.pdf.restoreGraphicsState()}}else Re.y<ve&&(this.ctx.prevPageLastElemOffset+=ve-Re.y);O.scale>=.01&&(this.pdf.setFontSize(Q),this.lineWidth=Z)}else O.scale>=.01&&(Q=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Q*O.scale),Z=this.lineWidth,this.lineWidth=Z*O.scale),this.pdf.text(O.text,ne.x+this.posX,ne.y+this.posY,{angle:O.angle,align:_,renderingMode:O.renderingMode,maxWidth:O.maxWidth}),O.scale>=.01&&(this.pdf.setFontSize(Q),this.lineWidth=Z)},v=function(O,_,k,$){k=k||0,$=$||0,this.pdf.internal.out(r(O+k)+" "+n(_+$)+" l")},j=function(O,_,k){return this.pdf.lines(O,_,k,null,null)},z=function(O,_,k,$,G,ne,U,D){this.pdf.internal.out([e(i(k+O)),e(o($+_)),e(i(G+O)),e(o(ne+_)),e(i(U+O)),e(o(D+_)),"c"].join(" "))},T=function(O,_,k,$){for(var G=2*Math.PI,ne=Math.PI/2;_>k;)_-=G;var U=Math.abs(k-_);U<G&&$&&(U=G-U);for(var D=[],B=$?-1:1,Q=_;U>1e-5;){var Z=Q+B*Math.min(U,ne);D.push(R.call(this,O,Q,Z)),U-=Math.abs(Z-Q),Q=Z}return D},R=function(O,_,k){var $=(k-_)/2,G=O*Math.cos($),ne=O*Math.sin($),U=G,D=-ne,B=U*U+D*D,Q=B+U*G+D*ne,Z=4/3*(Math.sqrt(2*B*Q)-Q)/(U*ne-D*G),oe=U-Z*D,de=D+Z*U,re=oe,Y=-de,ce=$+_,ue=Math.cos(ce),ae=Math.sin(ce);return{x1:O*Math.cos(_),y1:O*Math.sin(_),x2:oe*ue-de*ae,y2:oe*ae+de*ue,x3:re*ue-Y*ae,y3:re*ae+Y*ue,x4:O*Math.cos(k),y4:O*Math.sin(k)}},J=function(O){return 180*O/Math.PI},X=function(O,_,k,$,G,ne){var U=O+.5*(k-O),D=_+.5*($-_),B=G+.5*(k-G),Q=ne+.5*($-ne),Z=Math.min(O,G,U,B),oe=Math.max(O,G,U,B),de=Math.min(_,ne,D,Q),re=Math.max(_,ne,D,Q);return new l(Z,de,oe-Z,re-de)},H=function(O,_,k,$,G,ne,U,D){var B,Q,Z,oe,de,re,Y,ce,ue,ae,ye,me,pe,ve,Ne=k-O,Ie=$-_,Ce=G-k,Ee=ne-$,we=U-G,Re=D-ne;for(Q=0;Q<41;Q++)ue=(Y=(Z=O+(B=Q/40)*Ne)+B*((de=k+B*Ce)-Z))+B*(de+B*(G+B*we-de)-Y),ae=(ce=(oe=_+B*Ie)+B*((re=$+B*Ee)-oe))+B*(re+B*(ne+B*Re-re)-ce),Q==0?(ye=ue,me=ae,pe=ue,ve=ae):(ye=Math.min(ye,ue),me=Math.min(me,ae),pe=Math.max(pe,ue),ve=Math.max(ve,ae));return new l(Math.round(ye),Math.round(me),Math.round(pe-ye),Math.round(ve-me))},se=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var O,_,k=(O=this.ctx.lineDash,_=this.ctx.lineDashOffset,JSON.stringify({lineDash:O,lineDashOffset:_}));this.prevLineDash!==k&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=k)}}})(cr.API),function(t){var e=function(o){var s,l,c,d,u,h,g,m,S,N;for(l=[],c=0,d=(o+=s="\0\0\0\0".slice(o.length%4||4)).length;d>c;c+=4)(u=(o.charCodeAt(c)<<24)+(o.charCodeAt(c+1)<<16)+(o.charCodeAt(c+2)<<8)+o.charCodeAt(c+3))!==0?(h=(u=((u=((u=((u=(u-(N=u%85))/85)-(S=u%85))/85)-(m=u%85))/85)-(g=u%85))/85)%85,l.push(h+33,g+33,m+33,S+33,N+33)):l.push(122);return function(x,b){for(var K=b;K>0;K--)x.pop()}(l,s.length),String.fromCharCode.apply(String,l)+"~>"},r=function(o){var s,l,c,d,u,h=String,g="length",m=255,S="charCodeAt",N="slice",x="replace";for(o[N](-2),o=o[N](0,-2)[x](/\s/g,"")[x]("z","!!!!!"),c=[],d=0,u=(o+=s="uuuuu"[N](o[g]%5||5))[g];u>d;d+=5)l=52200625*(o[S](d)-33)+614125*(o[S](d+1)-33)+7225*(o[S](d+2)-33)+85*(o[S](d+3)-33)+(o[S](d+4)-33),c.push(m&l>>24,m&l>>16,m&l>>8,m&l);return function(b,K){for(var te=K;te>0;te--)b.pop()}(c,s[g]),h.fromCharCode.apply(h,c)},n=function(o){var s=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),s.test(o)===!1)return"";for(var l="",c=0;c<o.length;c+=2)l+=String.fromCharCode("0x"+(o[c]+o[c+1]));return l},i=function(o){for(var s=new Uint8Array(o.length),l=o.length;l--;)s[l]=o.charCodeAt(l);return o=(s=of(s)).reduce(function(c,d){return c+String.fromCharCode(d)},"")};t.processDataByFilters=function(o,s){var l=0,c=o||"",d=[];for(typeof(s=s||[])=="string"&&(s=[s]),l=0;l<s.length;l+=1)switch(s[l]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=n(c),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(u){return("0"+u.charCodeAt().toString(16)).slice(-2)}).join("")+">",d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=i(c),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[l]+'" is not implemented')}return{data:c,reverseChain:d.reverse().join(" ")}}}(cr.API),function(t){t.loadFile=function(e,r,n){return function(i,o,s){o=o!==!1,s=typeof s=="function"?s:function(){};var l=void 0;try{l=function(c,d,u){var h=new XMLHttpRequest,g=0,m=function(S){var N=S.length,x=[],b=String.fromCharCode;for(g=0;g<N;g+=1)x.push(b(255&S.charCodeAt(g)));return x.join("")};if(h.open("GET",c,!d),h.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(h.onload=function(){h.status===200?u(m(this.responseText)):u(void 0)}),h.send(null),d&&h.status===200)return m(h.responseText)}(i,o,s)}catch{}return l}(e,r,n)},t.loadImageFile=t.loadFile}(cr.API),function(t){function e(){return(ur.html2canvas?Promise.resolve(ur.html2canvas):no(()=>import("./html2canvas.esm-BfxBtG_O.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load html2canvas: "+s))}).then(function(s){return s.default?s.default:s})}function r(){return(ur.DOMPurify?Promise.resolve(ur.DOMPurify):no(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load dompurify: "+s))}).then(function(s){return s.default?s.default:s})}var n=function(s){var l=tn(s);return l==="undefined"?"undefined":l==="string"||s instanceof String?"string":l==="number"||s instanceof Number?"number":l==="function"||s instanceof Function?"function":s&&s.constructor===Array?"array":s&&s.nodeType===1?"element":l==="object"?"object":"unknown"},i=function(s,l){var c=document.createElement(s);for(var d in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[d]=l.style[d];return c},o=function s(l){var c=Object.assign(s.convert(Promise.resolve()),JSON.parse(JSON.stringify(s.template))),d=s.convert(Promise.resolve(),c);return d=(d=d.setProgress(1,s,1,[s])).set(l)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(s,l){return s.__proto__=l||o.prototype,s},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(s,l){return this.then(function(){switch(l=l||function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(s)){case"string":return this.then(r).then(function(c){return this.set({src:i("div",{innerHTML:s,dompurify:c})})});case"element":return this.set({src:s});case"canvas":return this.set({canvas:s});case"img":return this.set({img:s});default:return this.error("Unknown source type.")}})},o.prototype.to=function(s){switch(s){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var s={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=function c(d,u){for(var h=d.nodeType===3?document.createTextNode(d.nodeValue):d.cloneNode(!1),g=d.firstChild;g;g=g.nextSibling)u!==!0&&g.nodeType===1&&g.nodeName==="SCRIPT"||h.appendChild(c(g,u));return d.nodeType===1&&(d.nodeName==="CANVAS"?(h.width=d.width,h.height=d.height,h.getContext("2d").drawImage(d,0,0)):d.nodeName!=="TEXTAREA"&&d.nodeName!=="SELECT"||(h.value=d.value),h.addEventListener("load",function(){h.scrollTop=d.scrollTop,h.scrollLeft=d.scrollLeft},!0)),h}(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(s.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:s}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(e).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(e).then(function(l){var c=this.opt.jsPDF,d=this.opt.fontFaces,u=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,h=Object.assign({async:!0,allowTaint:!0,scale:u,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete h.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=d,d)for(var g=0;g<d.length;++g){var m=d[g],S=m.src.find(function(N){return N.format==="truetype"});S&&c.addFont(S.url,m.ref.name,m.ref.style)}return h.windowHeight=h.windowHeight||0,h.windowHeight=h.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):h.windowHeight,c.context2d.save(!0),l(this.prop.container,h)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var s=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=s})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(s,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(s,l):this.outputPdf(s,l)},o.prototype.outputPdf=function(s,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(s,l)})},o.prototype.outputImg=function(s){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(s){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+s+'" is not supported.'}})},o.prototype.save=function(s){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(s?{filename:s}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(s){if(n(s)!=="object")return this;var l=Object.keys(s||{}).map(function(c){if(c in o.template.prop)return function(){this.prop[c]=s[c]};switch(c){case"margin":return this.setMargin.bind(this,s.margin);case"jsPDF":return function(){return this.opt.jsPDF=s.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,s.pageSize);default:return function(){this.opt[c]=s[c]}}},this);return this.then(function(){return this.thenList(l)})},o.prototype.get=function(s,l){return this.then(function(){var c=s in o.template.prop?this.prop[s]:this.opt[s];return l?l(c):c})},o.prototype.setMargin=function(s){return this.then(function(){switch(n(s)){case"number":s=[s,s,s,s];case"array":if(s.length===2&&(s=[s[0],s[1],s[0],s[1]]),s.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=s}).then(this.setPageSize)},o.prototype.setPageSize=function(s){function l(c,d){return Math.floor(c*d/72*96)}return this.then(function(){(s=s||cr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(s.inner={width:s.width-this.opt.margin[1]-this.opt.margin[3],height:s.height-this.opt.margin[0]-this.opt.margin[2]},s.inner.px={width:l(s.inner.width,s.k),height:l(s.inner.height,s.k)},s.inner.ratio=s.inner.height/s.inner.width),this.prop.pageSize=s})},o.prototype.setProgress=function(s,l,c,d){return s!=null&&(this.progress.val=s),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(s,l,c,d){return this.setProgress(s?this.progress.val+s:null,l||null,c?this.progress.n+c:null,d?this.progress.stack.concat(d):null)},o.prototype.then=function(s,l){var c=this;return this.thenCore(s,l,function(d,u){return c.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(h){return c.updateProgress(null,d),h}).then(d,u).then(function(h){return c.updateProgress(1),h})})},o.prototype.thenCore=function(s,l,c){c=c||Promise.prototype.then,s&&(s=s.bind(this)),l&&(l=l.bind(this));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:o.convert(Object.assign({},this),Promise.prototype),u=c.call(d,s,l);return o.convert(u,this.__proto__)},o.prototype.thenExternal=function(s,l){return Promise.prototype.then.call(this,s,l)},o.prototype.thenList=function(s){var l=this;return s.forEach(function(c){l=l.thenCore(c)}),l},o.prototype.catch=function(s){s&&(s=s.bind(this));var l=Promise.prototype.catch.call(this,s);return o.convert(l,this)},o.prototype.catchExternal=function(s){return Promise.prototype.catch.call(this,s)},o.prototype.error=function(s){return this.then(function(){throw new Error(s)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,cr.getPageSize=function(s,l,c){if(tn(s)==="object"){var d=s;s=d.orientation,l=d.unit||l,c=d.format||c}l=l||"mm",c=c||"a4",s=(""+(s||"P")).toLowerCase();var u,h=(""+c).toLowerCase(),g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":u=1;break;case"mm":u=72/25.4;break;case"cm":u=72/2.54;break;case"in":u=72;break;case"px":u=.75;break;case"pc":case"em":u=12;break;case"ex":u=6;break;default:throw"Invalid unit: "+l}var m,S=0,N=0;if(g.hasOwnProperty(h))S=g[h][1]/u,N=g[h][0]/u;else try{S=c[1],N=c[0]}catch{throw new Error("Invalid format: "+c)}if(s==="p"||s==="portrait")s="p",N>S&&(m=N,N=S,S=m);else{if(s!=="l"&&s!=="landscape")throw"Invalid orientation: "+s;s="l",S>N&&(m=N,N=S,S=m)}return{width:N,height:S,unit:l,k:u,orientation:s}},t.html=function(s,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(uf):null;var c=new o(l);return l.worker?c:c.from(s).doCallback()}}(cr.API),cr.API.addJS=function(t){return R1=t,this.internal.events.subscribe("postPutResources",function(){uh=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(uh+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),L1=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+R1+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){uh!==void 0&&L1!==void 0&&this.internal.out("/Names <</JavaScript "+uh+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),o=0;o<i.length;o++){var s=i[o],l=n.exec(s);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,u=[];for(o=0;o<d;o++){var h=r.internal.newObject();u.push(h);var g=r.internal.getPageInfo(o+1);r.internal.write("<< /D["+g.objId+" 0 R /XYZ null null null]>> endobj")}var m=r.internal.newObject();for(r.internal.write("<< /Names [ "),o=0;o<u.length;o++)r.internal.write("(page_"+(o+1)+")"+u[o]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+m+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,o){var s={title:i,options:o,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<n.children.length;o++){var s=n.children[o];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),o>0&&this.line("/Prev "+this.makeRef(n.children[o-1])),o<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[o+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var l=this.count=this.count_r({count:0},s);if(l>0&&this.line("/Count "+l),s.options&&s.options.pageNumber){var c=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var d=0;d<n.children.length;d++)this.renderItems(n.children[d])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var o=0;o<i.children.length;o++)n.count++,this.count_r(n,i.children[o]);return n.count}}])}(cr.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,i,o,s,l){var c,d=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(c=function(h){for(var g,m=256*h.charCodeAt(4)+h.charCodeAt(5),S=h.length,N={width:0,height:0,numcomponents:1},x=4;x<S;x+=2){if(x+=m,e.indexOf(h.charCodeAt(x+1))!==-1){g=256*h.charCodeAt(x+5)+h.charCodeAt(x+6),N={width:256*h.charCodeAt(x+7)+h.charCodeAt(x+8),height:g,numcomponents:h.charCodeAt(x+9)};break}m=256*h.charCodeAt(x+2)+h.charCodeAt(x+3)}return N}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}u={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:d,index:n,alias:i}}return u}}(cr.API);var cc,hh,D1,M1,F1,n8=function(){var t,e,r;function n(o){var s,l,c,d,u,h,g,m,S,N,x,b,K,te;for(this.data=o,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},h=null;;){switch(s=this.readUInt32(),S=function(){var F,V;for(V=[],F=0;F<4;++F)V.push(String.fromCharCode(this.data[this.pos++]));return V}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(s);break;case"fcTL":h&&this.animation.frames.push(h),this.pos+=4,h={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},u=this.readUInt16(),d=this.readUInt16()||100,h.delay=1e3*u/d,h.disposeOp=this.data[this.pos++],h.blendOp=this.data[this.pos++],h.data=[];break;case"IDAT":case"fdAT":for(S==="fdAT"&&(this.pos+=4,s-=4),o=h?.data||this.imgData,b=0;0<=s?b<s:b>s;0<=s?++b:--b)o.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(s),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((N=c-this.transparency.indexed.length)>0)for(K=0;0<=N?K<N:K>N;0<=N?++K:--K)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(s)[0];break;case 2:this.transparency.rgb=this.read(s)}break;case"tEXt":g=(x=this.read(s)).indexOf(0),m=String.fromCharCode.apply(String,x.slice(0,g)),this.text[m]=String.fromCharCode.apply(String,x.slice(g+1));break;case"IEND":return h&&this.animation.frames.push(h),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=(te=this.colorType)===4||te===6,l=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*l,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=s}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(o){var s,l;for(l=[],s=0;0<=o?s<o:s>o;0<=o?++s:--s)l.push(this.data[this.pos++]);return l},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(o){var s=this.pixelBitlength/8,l=new Uint8Array(this.width*this.height*s),c=0,d=this;if(o==null&&(o=this.imgData),o.length===0)return new Uint8Array(0);function u(h,g,m,S){var N,x,b,K,te,F,V,W,I,E,L,M,P,w,v,j,z,T,R,J,X,H=Math.ceil((d.width-h)/m),se=Math.ceil((d.height-g)/S),O=d.width==H&&d.height==se;for(w=s*H,M=O?l:new Uint8Array(w*se),F=o.length,P=0,x=0;P<se&&c<F;){switch(o[c++]){case 0:for(K=z=0;z<w;K=z+=1)M[x++]=o[c++];break;case 1:for(K=T=0;T<w;K=T+=1)N=o[c++],te=K<s?0:M[x-s],M[x++]=(N+te)%256;break;case 2:for(K=R=0;R<w;K=R+=1)N=o[c++],b=(K-K%s)/s,v=P&&M[(P-1)*w+b*s+K%s],M[x++]=(v+N)%256;break;case 3:for(K=J=0;J<w;K=J+=1)N=o[c++],b=(K-K%s)/s,te=K<s?0:M[x-s],v=P&&M[(P-1)*w+b*s+K%s],M[x++]=(N+Math.floor((te+v)/2))%256;break;case 4:for(K=X=0;X<w;K=X+=1)N=o[c++],b=(K-K%s)/s,te=K<s?0:M[x-s],P===0?v=j=0:(v=M[(P-1)*w+b*s+K%s],j=b&&M[(P-1)*w+(b-1)*s+K%s]),V=te+v-j,W=Math.abs(V-te),E=Math.abs(V-v),L=Math.abs(V-j),I=W<=E&&W<=L?te:E<=L?v:j,M[x++]=(N+I)%256;break;default:throw new Error("Invalid filter algorithm: "+o[c-1])}if(!O){var _=((g+P*S)*d.width+h)*s,k=P*w;for(K=0;K<H;K+=1){for(var $=0;$<s;$+=1)l[_++]=M[k++];_+=(m-1)*s}}P++}}return o=RL(o),d.interlaceMethod==1?(u(0,0,8,8),u(4,0,8,8),u(0,4,4,8),u(2,0,4,4),u(0,2,2,4),u(1,0,2,2),u(0,1,1,2)):u(0,0,1,1),l},n.prototype.decodePalette=function(){var o,s,l,c,d,u,h,g,m;for(l=this.palette,u=this.transparency.indexed||[],d=new Uint8Array((u.length||0)+l.length),c=0,o=0,s=h=0,g=l.length;h<g;s=h+=3)d[c++]=l[s],d[c++]=l[s+1],d[c++]=l[s+2],d[c++]=(m=u[o++])!=null?m:255;return d},n.prototype.copyToImageData=function(o,s){var l,c,d,u,h,g,m,S,N,x,b;if(c=this.colors,N=null,l=this.hasAlphaChannel,this.palette.length&&(N=(b=this._decodedPalette)!=null?b:this._decodedPalette=this.decodePalette(),c=4,l=!0),S=(d=o.data||o).length,h=N||s,u=g=0,c===1)for(;u<S;)m=N?4*s[u/4]:g,x=h[m++],d[u++]=x,d[u++]=x,d[u++]=x,d[u++]=l?h[m++]:255,g=m;else for(;u<S;)m=N?4*s[u/4]:g,d[u++]=h[m++],d[u++]=h[m++],d[u++]=h[m++],d[u++]=l?h[m++]:255,g=m},n.prototype.decode=function(){var o;return o=new Uint8Array(this.width*this.height*4),this.copyToImageData(o,this.decodePixels()),o};var i=function(){if(Object.prototype.toString.call(ur)==="[object Window]"){try{e=ur.document.createElement("canvas"),r=e.getContext("2d")}catch{return!1}return!0}return!1};return i(),t=function(o){var s;if(i()===!0)return r.width=o.width,r.height=o.height,r.clearRect(0,0,o.width,o.height),r.putImageData(o,0,0),(s=new Image).src=e.toDataURL(),s;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(o){var s,l,c,d,u,h,g,m;if(this.animation){for(m=[],l=u=0,h=(g=this.animation.frames).length;u<h;l=++u)s=g[l],c=o.createImageData(s.width,s.height),d=this.decodePixels(new Uint8Array(s.data)),this.copyToImageData(c,d),s.imageData=c,m.push(s.image=t(c));return m}},n.prototype.renderFrame=function(o,s){var l,c,d;return l=(c=this.animation.frames)[s],d=c[s-1],s===0&&o.clearRect(0,0,this.width,this.height),d?.disposeOp===1?o.clearRect(d.xOffset,d.yOffset,d.width,d.height):d?.disposeOp===2&&o.putImageData(d.imageData,d.xOffset,d.yOffset),l.blendOp===0&&o.clearRect(l.xOffset,l.yOffset,l.width,l.height),o.drawImage(l.image,l.xOffset,l.yOffset)},n.prototype.animate=function(o){var s,l,c,d,u,h,g=this;return l=0,h=this.animation,d=h.numFrames,c=h.frames,u=h.numPlays,(s=function(){var m,S;if(m=l++%d,S=c[m],g.renderFrame(o,m),d>1&&l/d<u)return g.animation._timeout=setTimeout(s,S.delay)})()},n.prototype.stopAnimation=function(){var o;return clearTimeout((o=this.animation)!=null?o._timeout:void 0)},n.prototype.render=function(o){var s,l;return o._png&&o._png.stopAnimation(),o._png=this,o.width=this.width,o.height=this.height,s=o.getContext("2d"),this.animation?(this.decodeFrames(s),this.animate(s)):(l=s.createImageData(this.width,this.height),this.copyToImageData(l,this.decodePixels()),s.putImageData(l,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function i8(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,i=t[e++],o=i>>7,s=1<<(7&i)+1;t[e++],t[e++];var l=null,c=null;o&&(l=e,c=s,e+=3*s);var d=!0,u=[],h=0,g=null,m=0,S=null;for(this.width=r,this.height=n;d&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,S=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((P=t[e++])>=0))throw Error("Invalid block size");if(P===0)break;e+=P}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var N=t[e++];h=t[e++]|t[e++]<<8,g=t[e++],(1&N)==0&&(g=null),m=N>>2&7,e++;break;case 254:for(;;){if(!((P=t[e++])>=0))throw Error("Invalid block size");if(P===0)break;e+=P}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var x=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,K=t[e++]|t[e++]<<8,te=t[e++]|t[e++]<<8,F=t[e++],V=F>>6&1,W=1<<(7&F)+1,I=l,E=c,L=!1;F>>7&&(L=!0,I=e,E=W,e+=3*W);var M=e;for(e++;;){var P;if(!((P=t[e++])>=0))throw Error("Invalid block size");if(P===0)break;e+=P}u.push({x,y:b,width:K,height:te,has_local_palette:L,palette_offset:I,palette_size:E,data_offset:M,data_length:e-M,transparent_index:g,interlaced:!!V,delay:h,disposal:m});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return S},this.frameInfo=function(w){if(w<0||w>=u.length)throw new Error("Frame index out of range.");return u[w]},this.decodeAndBlitFrameBGRA=function(w,v){var j=this.frameInfo(w),z=j.width*j.height,T=new Uint8Array(z);O1(t,j.data_offset,T,z);var R=j.palette_offset,J=j.transparent_index;J===null&&(J=256);var X=j.width,H=r-X,se=X,O=4*(j.y*r+j.x),_=4*((j.y+j.height)*r+j.x),k=O,$=4*H;j.interlaced===!0&&($+=4*r*7);for(var G=8,ne=0,U=T.length;ne<U;++ne){var D=T[ne];if(se===0&&(se=X,(k+=$)>=_&&($=4*H+4*r*(G-1),k=O+(X+H)*(G<<1),G>>=1)),D===J)k+=4;else{var B=t[R+3*D],Q=t[R+3*D+1],Z=t[R+3*D+2];v[k++]=Z,v[k++]=Q,v[k++]=B,v[k++]=255}--se}},this.decodeAndBlitFrameRGBA=function(w,v){var j=this.frameInfo(w),z=j.width*j.height,T=new Uint8Array(z);O1(t,j.data_offset,T,z);var R=j.palette_offset,J=j.transparent_index;J===null&&(J=256);var X=j.width,H=r-X,se=X,O=4*(j.y*r+j.x),_=4*((j.y+j.height)*r+j.x),k=O,$=4*H;j.interlaced===!0&&($+=4*r*7);for(var G=8,ne=0,U=T.length;ne<U;++ne){var D=T[ne];if(se===0&&(se=X,(k+=$)>=_&&($=4*H+4*r*(G-1),k=O+(X+H)*(G<<1),G>>=1)),D===J)k+=4;else{var B=t[R+3*D],Q=t[R+3*D+1],Z=t[R+3*D+2];v[k++]=B,v[k++]=Q,v[k++]=Z,v[k++]=255}--se}}}function O1(t,e,r,n){for(var i=t[e++],o=1<<i,s=o+1,l=s+1,c=i+1,d=(1<<c)-1,u=0,h=0,g=0,m=t[e++],S=new Int32Array(4096),N=null;;){for(;u<16&&m!==0;)h|=t[e++]<<u,u+=8,m===1?m=t[e++]:--m;if(u<c)break;var x=h&d;if(h>>=c,u-=c,x!==o){if(x===s)break;for(var b=x<l?x:N,K=0,te=b;te>o;)te=S[te]>>8,++K;var F=te;if(g+K+(b!==x?1:0)>n)return void ln.log("Warning, gif stream longer than expected.");r[g++]=F;var V=g+=K;for(b!==x&&(r[g++]=F),te=b;K--;)te=S[te],r[--V]=255&te,te>>=8;N!==null&&l<4096&&(S[l++]=N<<8|F,l>=d+1&&c<12&&(++c,d=d<<1|1)),N=x}else l=s+1,d=(1<<(c=i+1))-1,N=null}return g!==n&&ln.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function iy(t){var e,r,n,i,o,s=Math.floor,l=new Array(64),c=new Array(64),d=new Array(64),u=new Array(64),h=new Array(65535),g=new Array(65535),m=new Array(64),S=new Array(64),N=[],x=0,b=7,K=new Array(64),te=new Array(64),F=new Array(64),V=new Array(256),W=new Array(2048),I=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],E=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],L=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],P=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],w=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],v=[0,1,2,3,4,5,6,7,8,9,10,11],j=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],z=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function T(O,_){for(var k=0,$=0,G=new Array,ne=1;ne<=16;ne++){for(var U=1;U<=O[ne];U++)G[_[$]]=[],G[_[$]][0]=k,G[_[$]][1]=ne,$++,k++;k*=2}return G}function R(O){for(var _=O[0],k=O[1]-1;k>=0;)_&1<<k&&(x|=1<<b),k--,--b<0&&(x==255?(J(255),J(0)):J(x),b=7,x=0)}function J(O){N.push(O)}function X(O){J(O>>8&255),J(255&O)}function H(O,_,k,$,G){for(var ne,U=G[0],D=G[240],B=function(ae,ye){var me,pe,ve,Ne,Ie,Ce,Ee,we,Re,He,je=0;for(Re=0;Re<8;++Re){me=ae[je],pe=ae[je+1],ve=ae[je+2],Ne=ae[je+3],Ie=ae[je+4],Ce=ae[je+5],Ee=ae[je+6];var Ve=me+(we=ae[je+7]),qe=me-we,tt=pe+Ee,rt=pe-Ee,Be=ve+Ce,Ge=ve-Ce,Fe=Ne+Ie,at=Ne-Ie,lt=Ve+Fe,Xe=Ve-Fe,Ct=tt+Be,Le=tt-Be;ae[je]=lt+Ct,ae[je+4]=lt-Ct;var nt=.707106781*(Le+Xe);ae[je+2]=Xe+nt,ae[je+6]=Xe-nt;var We=.382683433*((lt=at+Ge)-(Le=rt+qe)),kt=.5411961*lt+We,Et=1.306562965*Le+We,Ot=.707106781*(Ct=Ge+rt),jt=qe+Ot,mt=qe-Ot;ae[je+5]=mt+kt,ae[je+3]=mt-kt,ae[je+1]=jt+Et,ae[je+7]=jt-Et,je+=8}for(je=0,Re=0;Re<8;++Re){me=ae[je],pe=ae[je+8],ve=ae[je+16],Ne=ae[je+24],Ie=ae[je+32],Ce=ae[je+40],Ee=ae[je+48];var Zt=me+(we=ae[je+56]),rr=me-we,Dt=pe+Ee,Kt=pe-Ee,dt=ve+Ce,pt=ve-Ce,ze=Ne+Ie,bt=Ne-Ie,Mt=Zt+ze,ft=Zt-ze,At=Dt+dt,Ht=Dt-dt;ae[je]=Mt+At,ae[je+32]=Mt-At;var Yt=.707106781*(Ht+ft);ae[je+16]=ft+Yt,ae[je+48]=ft-Yt;var nr=.382683433*((Mt=bt+pt)-(Ht=Kt+rr)),Dr=.5411961*Mt+nr,vr=1.306562965*Ht+nr,tr=.707106781*(At=pt+Kt),Bt=rr+tr,ar=rr-tr;ae[je+40]=ar+Dr,ae[je+24]=ar-Dr,ae[je+8]=Bt+vr,ae[je+56]=Bt-vr,je++}for(Re=0;Re<64;++Re)He=ae[Re]*ye[Re],m[Re]=He>0?He+.5|0:He-.5|0;return m}(O,_),Q=0;Q<64;++Q)S[I[Q]]=B[Q];var Z=S[0]-k;k=S[0],Z==0?R($[0]):(R($[g[ne=32767+Z]]),R(h[ne]));for(var oe=63;oe>0&&S[oe]==0;)oe--;if(oe==0)return R(U),k;for(var de,re=1;re<=oe;){for(var Y=re;S[re]==0&&re<=oe;)++re;var ce=re-Y;if(ce>=16){de=ce>>4;for(var ue=1;ue<=de;++ue)R(D);ce&=15}ne=32767+S[re],R(G[(ce<<4)+g[ne]]),R(h[ne]),re++}return oe!=63&&R(U),k}function se(O){O=Math.min(Math.max(O,1),100),o!=O&&(function(_){for(var k=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],$=0;$<64;$++){var G=s((k[$]*_+50)/100);G=Math.min(Math.max(G,1),255),l[I[$]]=G}for(var ne=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],U=0;U<64;U++){var D=s((ne[U]*_+50)/100);D=Math.min(Math.max(D,1),255),c[I[U]]=D}for(var B=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Q=0,Z=0;Z<8;Z++)for(var oe=0;oe<8;oe++)d[Q]=1/(l[I[Q]]*B[Z]*B[oe]*8),u[Q]=1/(c[I[Q]]*B[Z]*B[oe]*8),Q++}(O<50?Math.floor(5e3/O):Math.floor(200-2*O)),o=O)}this.encode=function(O,_){_&&se(_),N=new Array,x=0,b=7,X(65496),X(65504),X(16),J(74),J(70),J(73),J(70),J(0),J(1),J(1),J(0),X(1),X(1),J(0),J(0),function(){X(65499),X(132),J(0);for(var pe=0;pe<64;pe++)J(l[pe]);J(1);for(var ve=0;ve<64;ve++)J(c[ve])}(),function(pe,ve){X(65472),X(17),J(8),X(ve),X(pe),J(3),J(1),J(17),J(0),J(2),J(17),J(1),J(3),J(17),J(1)}(O.width,O.height),function(){X(65476),X(418),J(0);for(var pe=0;pe<16;pe++)J(E[pe+1]);for(var ve=0;ve<=11;ve++)J(L[ve]);J(16);for(var Ne=0;Ne<16;Ne++)J(M[Ne+1]);for(var Ie=0;Ie<=161;Ie++)J(P[Ie]);J(1);for(var Ce=0;Ce<16;Ce++)J(w[Ce+1]);for(var Ee=0;Ee<=11;Ee++)J(v[Ee]);J(17);for(var we=0;we<16;we++)J(j[we+1]);for(var Re=0;Re<=161;Re++)J(z[Re])}(),X(65498),X(12),J(3),J(1),J(0),J(2),J(17),J(3),J(17),J(0),J(63),J(0);var k=0,$=0,G=0;x=0,b=7,this.encode.displayName="_encode_";for(var ne,U,D,B,Q,Z,oe,de,re,Y=O.data,ce=O.width,ue=O.height,ae=4*ce,ye=0;ye<ue;){for(ne=0;ne<ae;){for(Q=ae*ye+ne,oe=-1,de=0,re=0;re<64;re++)Z=Q+(de=re>>3)*ae+(oe=4*(7&re)),ye+de>=ue&&(Z-=ae*(ye+1+de-ue)),ne+oe>=ae&&(Z-=ne+oe-ae+4),U=Y[Z++],D=Y[Z++],B=Y[Z++],K[re]=(W[U]+W[D+256>>0]+W[B+512>>0]>>16)-128,te[re]=(W[U+768>>0]+W[D+1024>>0]+W[B+1280>>0]>>16)-128,F[re]=(W[U+1280>>0]+W[D+1536>>0]+W[B+1792>>0]>>16)-128;k=H(K,d,k,e,n),$=H(te,u,$,r,i),G=H(F,u,G,r,i),ne+=32}ye+=8}if(b>=0){var me=[];me[1]=b+1,me[0]=(1<<b+1)-1,R(me)}return X(65497),new Uint8Array(N)},t=t||50,function(){for(var O=String.fromCharCode,_=0;_<256;_++)V[_]=O(_)}(),e=T(E,L),r=T(w,v),n=T(M,P),i=T(j,z),function(){for(var O=1,_=2,k=1;k<=15;k++){for(var $=O;$<_;$++)g[32767+$]=k,h[32767+$]=[],h[32767+$][1]=k,h[32767+$][0]=$;for(var G=-(_-1);G<=-O;G++)g[32767+G]=k,h[32767+G]=[],h[32767+G][1]=k,h[32767+G][0]=_-1+G;O<<=1,_<<=1}}(),function(){for(var O=0;O<256;O++)W[O]=19595*O,W[O+256>>0]=38470*O,W[O+512>>0]=7471*O+32768,W[O+768>>0]=-11059*O,W[O+1024>>0]=-21709*O,W[O+1280>>0]=32768*O+8421375,W[O+1536>>0]=-27439*O,W[O+1792>>0]=-5329*O}(),se(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Ro(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function B1(t){function e(E){if(!E)throw Error("assert :P")}function r(E,L,M){for(var P=0;4>P;P++)if(E[L+P]!=M.charCodeAt(P))return!0;return!1}function n(E,L,M,P,w){for(var v=0;v<w;v++)E[L+v]=M[P+v]}function i(E,L,M,P){for(var w=0;w<P;w++)E[L+w]=M}function o(E){return new Int32Array(E)}function s(E,L){for(var M=[],P=0;P<E;P++)M.push(new L);return M}function l(E,L){var M=[];return function P(w,v,j){for(var z=j[v],T=0;T<z&&(w.push(j.length>v+1?[]:new L),!(j.length<v+1));T++)P(w[T],v+1,j)}(M,0,E),M}var c=function(){var E=this;function L(y,C){for(var ee=1<<C-1>>>0;y&ee;)ee>>>=1;return ee?(y&ee-1)+ee:y}function M(y,C,ee,he,Pe){e(!(he%ee));do y[C+(he-=ee)]=Pe;while(0<he)}function P(y,C,ee,he,Pe){if(e(2328>=Pe),512>=Pe)var _e=o(512);else if((_e=o(Pe))==null)return 0;return function(xe,$e,Te,De,Ye,it){var ot,et,St=$e,ut=1<<Te,Ke=o(16),Qe=o(16);for(e(Ye!=0),e(De!=null),e(xe!=null),e(0<Te),et=0;et<Ye;++et){if(15<De[et])return 0;++Ke[De[et]]}if(Ke[0]==Ye)return 0;for(Qe[1]=0,ot=1;15>ot;++ot){if(Ke[ot]>1<<ot)return 0;Qe[ot+1]=Qe[ot]+Ke[ot]}for(et=0;et<Ye;++et)ot=De[et],0<De[et]&&(it[Qe[ot]++]=et);if(Qe[15]==1)return(De=new w).g=0,De.value=it[0],M(xe,St,1,ut,De),ut;var Pt,$t=-1,_t=ut-1,Qt=0,zt=1,lr=1,Ut=1<<Te;for(et=0,ot=1,Ye=2;ot<=Te;++ot,Ye<<=1){if(zt+=lr<<=1,0>(lr-=Ke[ot]))return 0;for(;0<Ke[ot];--Ke[ot])(De=new w).g=ot,De.value=it[et++],M(xe,St+Qt,Ye,Ut,De),Qt=L(Qt,ot)}for(ot=Te+1,Ye=2;15>=ot;++ot,Ye<<=1){if(zt+=lr<<=1,0>(lr-=Ke[ot]))return 0;for(;0<Ke[ot];--Ke[ot]){if(De=new w,(Qt&_t)!=$t){for(St+=Ut,Pt=1<<($t=ot)-Te;15>$t&&!(0>=(Pt-=Ke[$t]));)++$t,Pt<<=1;ut+=Ut=1<<(Pt=$t-Te),xe[$e+($t=Qt&_t)].g=Pt+Te,xe[$e+$t].value=St-$e-$t}De.g=ot-Te,De.value=it[et++],M(xe,St+(Qt>>Te),Ye,Ut,De),Qt=L(Qt,ot)}}return zt!=2*Qe[15]-1?0:ut}(y,C,ee,he,Pe,_e)}function w(){this.value=this.g=0}function v(){this.value=this.g=0}function j(){this.G=s(5,w),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(ni,v)}function z(y,C,ee,he){e(y!=null),e(C!=null),e(2147483648>he),y.Ca=254,y.I=0,y.b=-8,y.Ka=0,y.oa=C,y.pa=ee,y.Jd=C,y.Yc=ee+he,y.Zc=4<=he?ee+he-4+1:ee,ne(y)}function T(y,C){for(var ee=0;0<C--;)ee|=D(y,128)<<C;return ee}function R(y,C){var ee=T(y,C);return U(y)?-ee:ee}function J(y,C,ee,he){var Pe,_e=0;for(e(y!=null),e(C!=null),e(4294967288>he),y.Sb=he,y.Ra=0,y.u=0,y.h=0,4<he&&(he=4),Pe=0;Pe<he;++Pe)_e+=C[ee+Pe]<<8*Pe;y.Ra=_e,y.bb=he,y.oa=C,y.pa=ee}function X(y){for(;8<=y.u&&y.bb<y.Sb;)y.Ra>>>=8,y.Ra+=y.oa[y.pa+y.bb]<<Yl-8>>>0,++y.bb,y.u-=8;k(y)&&(y.h=1,y.u=0)}function H(y,C){if(e(0<=C),!y.h&&C<=Wl){var ee=_(y)&Gl[C];return y.u+=C,X(y),ee}return y.h=1,y.u=0}function se(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function O(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function _(y){return y.Ra>>>(y.u&Yl-1)>>>0}function k(y){return e(y.bb<=y.Sb),y.h||y.bb==y.Sb&&y.u>Yl}function $(y,C){y.u=C,y.h=k(y)}function G(y){y.u>=Zc&&(e(y.u>=Zc),X(y))}function ne(y){e(y!=null&&y.oa!=null),y.pa<y.Zc?(y.I=(y.oa[y.pa++]|y.I<<8)>>>0,y.b+=8):(e(y!=null&&y.oa!=null),y.pa<y.Yc?(y.b+=8,y.I=y.oa[y.pa++]|y.I<<8):y.Ka?y.b=0:(y.I<<=8,y.b+=8,y.Ka=1))}function U(y){return T(y,1)}function D(y,C){var ee=y.Ca;0>y.b&&ne(y);var he=y.b,Pe=ee*C>>>8,_e=(y.I>>>he>Pe)+0;for(_e?(ee-=Pe,y.I-=Pe+1<<he>>>0):ee=Pe+1,he=ee,Pe=0;256<=he;)Pe+=8,he>>=8;return he=7^Pe+Mi[he],y.b-=he,y.Ca=(ee<<he)-1,_e}function B(y,C,ee){y[C+0]=ee>>24&255,y[C+1]=ee>>16&255,y[C+2]=ee>>8&255,y[C+3]=ee>>0&255}function Q(y,C){return y[C+0]<<0|y[C+1]<<8}function Z(y,C){return Q(y,C)|y[C+2]<<16}function oe(y,C){return Q(y,C)|Q(y,C+2)<<16}function de(y,C){var ee=1<<C;return e(y!=null),e(0<C),y.X=o(ee),y.X==null?0:(y.Mb=32-C,y.Xa=C,1)}function re(y,C){e(y!=null),e(C!=null),e(y.Xa==C.Xa),n(C.X,0,y.X,0,1<<C.Xa)}function Y(){this.X=[],this.Xa=this.Mb=0}function ce(y,C,ee,he){e(ee!=null),e(he!=null);var Pe=ee[0],_e=he[0];return Pe==0&&(Pe=(y*_e+C/2)/C),_e==0&&(_e=(C*Pe+y/2)/y),0>=Pe||0>=_e?0:(ee[0]=Pe,he[0]=_e,1)}function ue(y,C){return y+(1<<C)-1>>>C}function ae(y,C){return((4278255360&y)+(4278255360&C)>>>0&4278255360)+((16711935&y)+(16711935&C)>>>0&16711935)>>>0}function ye(y,C){E[C]=function(ee,he,Pe,_e,xe,$e,Te){var De;for(De=0;De<xe;++De){var Ye=E[y]($e[Te+De-1],Pe,_e+De);$e[Te+De]=ae(ee[he+De],Ye)}}}function me(){this.ud=this.hd=this.jd=0}function pe(y,C){return((4278124286&(y^C))>>>1)+(y&C)>>>0}function ve(y){return 0<=y&&256>y?y:0>y?0:255<y?255:void 0}function Ne(y,C){return ve(y+(y-C+.5>>1))}function Ie(y,C,ee){return Math.abs(C-ee)-Math.abs(y-ee)}function Ce(y,C,ee,he,Pe,_e,xe){for(he=_e[xe-1],ee=0;ee<Pe;++ee)_e[xe+ee]=he=ae(y[C+ee],he)}function Ee(y,C,ee,he,Pe){var _e;for(_e=0;_e<ee;++_e){var xe=y[C+_e],$e=xe>>8&255,Te=16711935&(Te=(Te=16711935&xe)+(($e<<16)+$e));he[Pe+_e]=(4278255360&xe)+Te>>>0}}function we(y,C){C.jd=y>>0&255,C.hd=y>>8&255,C.ud=y>>16&255}function Re(y,C,ee,he,Pe,_e){var xe;for(xe=0;xe<he;++xe){var $e=C[ee+xe],Te=$e>>>8,De=$e,Ye=255&(Ye=(Ye=$e>>>16)+((y.jd<<24>>24)*(Te<<24>>24)>>>5));De=255&(De=(De=De+((y.hd<<24>>24)*(Te<<24>>24)>>>5))+((y.ud<<24>>24)*(Ye<<24>>24)>>>5)),Pe[_e+xe]=(4278255360&$e)+(Ye<<16)+De}}function He(y,C,ee,he,Pe){E[C]=function(_e,xe,$e,Te,De,Ye,it,ot,et){for(Te=it;Te<ot;++Te)for(it=0;it<et;++it)De[Ye++]=Pe($e[he(_e[xe++])])},E[y]=function(_e,xe,$e,Te,De,Ye,it){var ot=8>>_e.b,et=_e.Ea,St=_e.K[0],ut=_e.w;if(8>ot)for(_e=(1<<_e.b)-1,ut=(1<<ot)-1;xe<$e;++xe){var Ke,Qe=0;for(Ke=0;Ke<et;++Ke)Ke&_e||(Qe=he(Te[De++])),Ye[it++]=Pe(St[Qe&ut]),Qe>>=ot}else E["VP8LMapColor"+ee](Te,De,St,ut,Ye,it,xe,$e,et)}}function je(y,C,ee,he,Pe){for(ee=C+ee;C<ee;){var _e=y[C++];he[Pe++]=_e>>16&255,he[Pe++]=_e>>8&255,he[Pe++]=_e>>0&255}}function Ve(y,C,ee,he,Pe){for(ee=C+ee;C<ee;){var _e=y[C++];he[Pe++]=_e>>16&255,he[Pe++]=_e>>8&255,he[Pe++]=_e>>0&255,he[Pe++]=_e>>24&255}}function qe(y,C,ee,he,Pe){for(ee=C+ee;C<ee;){var _e=(xe=y[C++])>>16&240|xe>>12&15,xe=xe>>0&240|xe>>28&15;he[Pe++]=_e,he[Pe++]=xe}}function tt(y,C,ee,he,Pe){for(ee=C+ee;C<ee;){var _e=(xe=y[C++])>>16&248|xe>>13&7,xe=xe>>5&224|xe>>3&31;he[Pe++]=_e,he[Pe++]=xe}}function rt(y,C,ee,he,Pe){for(ee=C+ee;C<ee;){var _e=y[C++];he[Pe++]=_e>>0&255,he[Pe++]=_e>>8&255,he[Pe++]=_e>>16&255}}function Be(y,C,ee,he,Pe,_e){if(_e==0)for(ee=C+ee;C<ee;)B(he,((_e=y[C++])[0]>>24|_e[1]>>8&65280|_e[2]<<8&16711680|_e[3]<<24)>>>0),Pe+=32;else n(he,Pe,y,C,ee)}function Ge(y,C){E[C][0]=E[y+"0"],E[C][1]=E[y+"1"],E[C][2]=E[y+"2"],E[C][3]=E[y+"3"],E[C][4]=E[y+"4"],E[C][5]=E[y+"5"],E[C][6]=E[y+"6"],E[C][7]=E[y+"7"],E[C][8]=E[y+"8"],E[C][9]=E[y+"9"],E[C][10]=E[y+"10"],E[C][11]=E[y+"11"],E[C][12]=E[y+"12"],E[C][13]=E[y+"13"],E[C][14]=E[y+"0"],E[C][15]=E[y+"0"]}function Fe(y){return y==Qp||y==Jp||y==Tu||y==Xp}function at(){this.eb=[],this.size=this.A=this.fb=0}function lt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Xe(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new at,this.f.kb=new lt,this.sd=null}function Ct(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Le(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function nt(y){return alert("todo:WebPSamplerProcessPlane"),y.T}function We(y,C){var ee=y.T,he=C.ba.f.RGBA,Pe=he.eb,_e=he.fb+y.ka*he.A,xe=mo[C.ba.S],$e=y.y,Te=y.O,De=y.f,Ye=y.N,it=y.ea,ot=y.W,et=C.cc,St=C.dc,ut=C.Mc,Ke=C.Nc,Qe=y.ka,Pt=y.ka+y.T,$t=y.U,_t=$t+1>>1;for(Qe==0?xe($e,Te,null,null,De,Ye,it,ot,De,Ye,it,ot,Pe,_e,null,null,$t):(xe(C.ec,C.fc,$e,Te,et,St,ut,Ke,De,Ye,it,ot,Pe,_e-he.A,Pe,_e,$t),++ee);Qe+2<Pt;Qe+=2)et=De,St=Ye,ut=it,Ke=ot,Ye+=y.Rc,ot+=y.Rc,_e+=2*he.A,xe($e,(Te+=2*y.fa)-y.fa,$e,Te,et,St,ut,Ke,De,Ye,it,ot,Pe,_e-he.A,Pe,_e,$t);return Te+=y.fa,y.j+Pt<y.o?(n(C.ec,C.fc,$e,Te,$t),n(C.cc,C.dc,De,Ye,_t),n(C.Mc,C.Nc,it,ot,_t),ee--):1&Pt||xe($e,Te,null,null,De,Ye,it,ot,De,Ye,it,ot,Pe,_e+he.A,null,null,$t),ee}function kt(y,C,ee){var he=y.F,Pe=[y.J];if(he!=null){var _e=y.U,xe=C.ba.S,$e=xe==Iu||xe==Tu;C=C.ba.f.RGBA;var Te=[0],De=y.ka;Te[0]=y.T,y.Kb&&(De==0?--Te[0]:(--De,Pe[0]-=y.width),y.j+y.ka+y.T==y.o&&(Te[0]=y.o-y.j-De));var Ye=C.eb;De=C.fb+De*C.A,y=pn(he,Pe[0],y.width,_e,Te,Ye,De+($e?0:3),C.A),e(ee==Te),y&&Fe(xe)&&ho(Ye,De,$e,_e,Te,C.A)}return 0}function Et(y){var C=y.ma,ee=C.ba.S,he=11>ee,Pe=ee==$u||ee==Eu||ee==Iu||ee==Kp||ee==12||Fe(ee);if(C.memory=null,C.Ib=null,C.Jb=null,C.Nd=null,!Jc(C.Oa,y,Pe?11:12))return 0;if(Pe&&Fe(ee)&&It(),y.da)alert("todo:use_scaling");else{if(he){if(C.Ib=nt,y.Kb){if(ee=y.U+1>>1,C.memory=o(y.U+2*ee),C.memory==null)return 0;C.ec=C.memory,C.fc=0,C.cc=C.ec,C.dc=C.fc+y.U,C.Mc=C.cc,C.Nc=C.dc+ee,C.Ib=We,It()}}else alert("todo:EmitYUV");Pe&&(C.Jb=kt,he&&Ze())}if(he&&!qg){for(y=0;256>y;++y)U_[y]=89858*(y-128)+Nu>>ku,W_[y]=-22014*(y-128)+Nu,G_[y]=-45773*(y-128),H_[y]=113618*(y-128)+Nu>>ku;for(y=sd;y<tm;++y)C=76283*(y-16)+Nu>>ku,Y_[y-sd]=Wr(C,255),K_[y-sd]=Wr(C+8>>4,15);qg=1}return 1}function Ot(y){var C=y.ma,ee=y.U,he=y.T;return e(!(1&y.ka)),0>=ee||0>=he?0:(ee=C.Ib(y,C),C.Jb!=null&&C.Jb(y,C,ee),C.Dc+=ee,1)}function jt(y){y.ma.memory=null}function mt(y,C,ee,he){return H(y,8)!=47?0:(C[0]=H(y,14)+1,ee[0]=H(y,14)+1,he[0]=H(y,1),H(y,3)!=0?0:!y.h)}function Zt(y,C){if(4>y)return y+1;var ee=y-2>>1;return(2+(1&y)<<ee)+H(C,ee)+1}function rr(y,C){return 120<C?C-120:1<=(ee=((ee=T_[C-1])>>4)*y+(8-(15&ee)))?ee:1;var ee}function Dt(y,C,ee){var he=_(ee),Pe=y[C+=255&he].g-8;return 0<Pe&&($(ee,ee.u+8),he=_(ee),C+=y[C].value,C+=he&(1<<Pe)-1),$(ee,ee.u+y[C].g),y[C].value}function Kt(y,C,ee){return ee.g+=y.g,ee.value+=y.value<<C>>>0,e(8>=ee.g),y.g}function dt(y,C,ee){var he=y.xc;return e((C=he==0?0:y.vc[y.md*(ee>>he)+(C>>he)])<y.Wb),y.Ya[C]}function pt(y,C,ee,he){var Pe=y.ab,_e=y.c*C,xe=y.C;C=xe+C;var $e=ee,Te=he;for(he=y.Ta,ee=y.Ua;0<Pe--;){var De=y.gc[Pe],Ye=xe,it=C,ot=$e,et=Te,St=(Te=he,$e=ee,De.Ea);switch(e(Ye<it),e(it<=De.nc),De.hc){case 2:Pu(ot,et,(it-Ye)*St,Te,$e);break;case 0:var ut=Ye,Ke=it,Qe=Te,Pt=$e,$t=(Ut=De).Ea;ut==0&&(Wp(ot,et,null,null,1,Qe,Pt),Ce(ot,et+1,0,0,$t-1,Qe,Pt+1),et+=$t,Pt+=$t,++ut);for(var _t=1<<Ut.b,Qt=_t-1,zt=ue($t,Ut.b),lr=Ut.K,Ut=Ut.w+(ut>>Ut.b)*zt;ut<Ke;){var qr=lr,Qr=Ut,Or=1;for(ed(ot,et,Qe,Pt-$t,1,Qe,Pt);Or<$t;){var kr=(Or&~Qt)+_t;kr>$t&&(kr=$t),(0,sa[qr[Qr++]>>8&15])(ot,et+ +Or,Qe,Pt+Or-$t,kr-Or,Qe,Pt+Or),Or=kr}et+=$t,Pt+=$t,++ut&Qt||(Ut+=zt)}it!=De.nc&&n(Te,$e-St,Te,$e+(it-Ye-1)*St,St);break;case 1:for(St=ot,Ke=et,$t=(ot=De.Ea)-(Pt=ot&~(Qe=(et=1<<De.b)-1)),ut=ue(ot,De.b),_t=De.K,De=De.w+(Ye>>De.b)*ut;Ye<it;){for(Qt=_t,zt=De,lr=new me,Ut=Ke+Pt,qr=Ke+ot;Ke<Ut;)we(Qt[zt++],lr),rl(lr,St,Ke,et,Te,$e),Ke+=et,$e+=et;Ke<qr&&(we(Qt[zt++],lr),rl(lr,St,Ke,$t,Te,$e),Ke+=$t,$e+=$t),++Ye&Qe||(De+=ut)}break;case 3:if(ot==Te&&et==$e&&0<De.b){for(Ke=Te,ot=St=$e+(it-Ye)*St-(Pt=(it-Ye)*ue(De.Ea,De.b)),et=Te,Qe=$e,ut=[],Pt=($t=Pt)-1;0<=Pt;--Pt)ut[Pt]=et[Qe+Pt];for(Pt=$t-1;0<=Pt;--Pt)Ke[ot+Pt]=ut[Pt];lo(De,Ye,it,Te,St,Te,$e)}else lo(De,Ye,it,ot,et,Te,$e)}$e=he,Te=ee}Te!=ee&&n(he,ee,$e,Te,_e)}function ze(y,C){var ee=y.V,he=y.Ba+y.c*y.C,Pe=C-y.C;if(e(C<=y.l.o),e(16>=Pe),0<Pe){var _e=y.l,xe=y.Ta,$e=y.Ua,Te=_e.width;if(pt(y,Pe,ee,he),Pe=$e=[$e],e((ee=y.C)<(he=C)),e(_e.v<_e.va),he>_e.o&&(he=_e.o),ee<_e.j){var De=_e.j-ee;ee=_e.j,Pe[0]+=De*Te}if(ee>=he?ee=0:(Pe[0]+=4*_e.v,_e.ka=ee-_e.j,_e.U=_e.va-_e.v,_e.T=he-ee,ee=1),ee){if($e=$e[0],11>(ee=y.ca).S){var Ye=ee.f.RGBA,it=(he=ee.S,Pe=_e.U,_e=_e.T,De=Ye.eb,Ye.A),ot=_e;for(Ye=Ye.fb+y.Ma*Ye.A;0<ot--;){var et=xe,St=$e,ut=Pe,Ke=De,Qe=Ye;switch(he){case Au:Fi(et,St,ut,Ke,Qe);break;case $u:xi(et,St,ut,Ke,Qe);break;case Qp:xi(et,St,ut,Ke,Qe),ho(Ke,Qe,0,ut,1,0);break;case Rg:Ps(et,St,ut,Ke,Qe);break;case Eu:Be(et,St,ut,Ke,Qe,1);break;case Jp:Be(et,St,ut,Ke,Qe,1),ho(Ke,Qe,0,ut,1,0);break;case Iu:Be(et,St,ut,Ke,Qe,0);break;case Tu:Be(et,St,ut,Ke,Qe,0),ho(Ke,Qe,1,ut,1,0);break;case Kp:aa(et,St,ut,Ke,Qe);break;case Xp:aa(et,St,ut,Ke,Qe),hn(Ke,Qe,ut,1,0);break;case Dg:bs(et,St,ut,Ke,Qe);break;default:e(0)}$e+=Te,Ye+=it}y.Ma+=_e}else alert("todo:EmitRescaledRowsYUVA");e(y.Ma<=ee.height)}}y.C=C,e(y.C<=y.i)}function bt(y){var C;if(0<y.ua)return 0;for(C=0;C<y.Wb;++C){var ee=y.Ya[C].G,he=y.Ya[C].H;if(0<ee[1][he[1]+0].g||0<ee[2][he[2]+0].g||0<ee[3][he[3]+0].g)return 0}return 1}function Mt(y,C,ee,he,Pe,_e){if(y.Z!=0){var xe=y.qd,$e=y.rd;for(e(ua[y.Z]!=null);C<ee;++C)ua[y.Z](xe,$e,he,Pe,he,Pe,_e),xe=he,$e=Pe,Pe+=_e;y.qd=xe,y.rd=$e}}function ft(y,C){var ee=y.l.ma,he=ee.Z==0||ee.Z==1?y.l.j:y.C;if(he=y.C<he?he:y.C,e(C<=y.l.o),C>he){var Pe=y.l.width,_e=ee.ca,xe=ee.tb+Pe*he,$e=y.V,Te=y.Ba+y.c*he,De=y.gc;e(y.ab==1),e(De[0].hc==3),_u(De[0],he,C,$e,Te,_e,xe),Mt(ee,he,C,_e,xe,Pe)}y.C=y.Ma=C}function At(y,C,ee,he,Pe,_e,xe){var $e=y.$/he,Te=y.$%he,De=y.m,Ye=y.s,it=ee+y.$,ot=it;Pe=ee+he*Pe;var et=ee+he*_e,St=280+Ye.ua,ut=y.Pb?$e:16777216,Ke=0<Ye.ua?Ye.Wa:null,Qe=Ye.wc,Pt=it<et?dt(Ye,Te,$e):null;e(y.C<_e),e(et<=Pe);var $t=!1;e:for(;;){for(;$t||it<et;){var _t=0;if($e>=ut){var Qt=it-ee;e((ut=y).Pb),ut.wd=ut.m,ut.xd=Qt,0<ut.s.ua&&re(ut.s.Wa,ut.s.vb),ut=$e+N_}if(Te&Qe||(Pt=dt(Ye,Te,$e)),e(Pt!=null),Pt.Qb&&(C[it]=Pt.qb,$t=!0),!$t)if(G(De),Pt.jc){_t=De,Qt=C;var zt=it,lr=Pt.pd[_(_t)&ni-1];e(Pt.jc),256>lr.g?($(_t,_t.u+lr.g),Qt[zt]=lr.value,_t=0):($(_t,_t.u+lr.g-256),e(256<=lr.value),_t=lr.value),_t==0&&($t=!0)}else _t=Dt(Pt.G[0],Pt.H[0],De);if(De.h)break;if($t||256>_t){if(!$t)if(Pt.nd)C[it]=(Pt.qb|_t<<8)>>>0;else{if(G(De),$t=Dt(Pt.G[1],Pt.H[1],De),G(De),Qt=Dt(Pt.G[2],Pt.H[2],De),zt=Dt(Pt.G[3],Pt.H[3],De),De.h)break;C[it]=(zt<<24|$t<<16|_t<<8|Qt)>>>0}if($t=!1,++it,++Te>=he&&(Te=0,++$e,xe!=null&&$e<=_e&&!($e%16)&&xe(y,$e),Ke!=null))for(;ot<it;)_t=C[ot++],Ke.X[(506832829*_t&4294967295)>>>Ke.Mb]=_t}else if(280>_t){if(_t=Zt(_t-256,De),Qt=Dt(Pt.G[4],Pt.H[4],De),G(De),Qt=rr(he,Qt=Zt(Qt,De)),De.h)break;if(it-ee<Qt||Pe-it<_t)break e;for(zt=0;zt<_t;++zt)C[it+zt]=C[it+zt-Qt];for(it+=_t,Te+=_t;Te>=he;)Te-=he,++$e,xe!=null&&$e<=_e&&!($e%16)&&xe(y,$e);if(e(it<=Pe),Te&Qe&&(Pt=dt(Ye,Te,$e)),Ke!=null)for(;ot<it;)_t=C[ot++],Ke.X[(506832829*_t&4294967295)>>>Ke.Mb]=_t}else{if(!(_t<St))break e;for($t=_t-280,e(Ke!=null);ot<it;)_t=C[ot++],Ke.X[(506832829*_t&4294967295)>>>Ke.Mb]=_t;_t=it,e(!($t>>>(Qt=Ke).Xa)),C[_t]=Qt.X[$t],$t=!0}$t||e(De.h==k(De))}if(y.Pb&&De.h&&it<Pe)e(y.m.h),y.a=5,y.m=y.wd,y.$=y.xd,0<y.s.ua&&re(y.s.vb,y.s.Wa);else{if(De.h)break e;xe?.(y,$e>_e?_e:$e),y.a=0,y.$=it-ee}return 1}return y.a=3,0}function Ht(y){e(y!=null),y.vc=null,y.yc=null,y.Ya=null;var C=y.Wa;C!=null&&(C.X=null),y.vb=null,e(y!=null)}function Yt(){var y=new Ul;return y==null?null:(y.a=0,y.xb=Og,Ge("Predictor","VP8LPredictors"),Ge("Predictor","VP8LPredictors_C"),Ge("PredictorAdd","VP8LPredictorsAdd"),Ge("PredictorAdd","VP8LPredictorsAdd_C"),Pu=Ee,rl=Re,Fi=je,xi=Ve,aa=qe,bs=tt,Ps=rt,E.VP8LMapColor32b=Kl,E.VP8LMapColor8b=Su,y)}function nr(y,C,ee,he,Pe){var _e=1,xe=[y],$e=[C],Te=he.m,De=he.s,Ye=null,it=0;e:for(;;){if(ee)for(;_e&&H(Te,1);){var ot=xe,et=$e,St=he,ut=1,Ke=St.m,Qe=St.gc[St.ab],Pt=H(Ke,2);if(St.Oc&1<<Pt)_e=0;else{switch(St.Oc|=1<<Pt,Qe.hc=Pt,Qe.Ea=ot[0],Qe.nc=et[0],Qe.K=[null],++St.ab,e(4>=St.ab),Pt){case 0:case 1:Qe.b=H(Ke,3)+2,ut=nr(ue(Qe.Ea,Qe.b),ue(Qe.nc,Qe.b),0,St,Qe.K),Qe.K=Qe.K[0];break;case 3:var $t,_t=H(Ke,8)+1,Qt=16<_t?0:4<_t?1:2<_t?2:3;if(ot[0]=ue(Qe.Ea,Qt),Qe.b=Qt,$t=ut=nr(_t,1,0,St,Qe.K)){var zt,lr=_t,Ut=Qe,qr=1<<(8>>Ut.b),Qr=o(qr);if(Qr==null)$t=0;else{var Or=Ut.K[0],kr=Ut.w;for(Qr[0]=Ut.K[0][0],zt=1;zt<1*lr;++zt)Qr[zt]=ae(Or[kr+zt],Qr[zt-1]);for(;zt<4*qr;++zt)Qr[zt]=0;Ut.K[0]=null,Ut.K[0]=Qr,$t=1}}ut=$t;break;case 2:break;default:e(0)}_e=ut}}if(xe=xe[0],$e=$e[0],_e&&H(Te,1)&&!(_e=1<=(it=H(Te,4))&&11>=it)){he.a=3;break e}var an;if(an=_e)t:{var on,Cr,Rn,Oi=he,Dn=xe,Bi=$e,Jr=it,Xi=ee,Zi=Oi.m,Yn=Oi.s,ii=[null],Ai=1,yo=0,Qo=k_[Jr];r:for(;;){if(Xi&&H(Zi,1)){var Kn=H(Zi,3)+2,xs=ue(Dn,Kn),al=ue(Bi,Kn),ec=xs*al;if(!nr(xs,al,0,Oi,ii))break r;for(ii=ii[0],Yn.xc=Kn,on=0;on<ec;++on){var ha=ii[on]>>8&65535;ii[on]=ha,ha>=Ai&&(Ai=ha+1)}}if(Zi.h)break r;for(Cr=0;5>Cr;++Cr){var Sn=Mg[Cr];!Cr&&0<Jr&&(Sn+=1<<Jr),yo<Sn&&(yo=Sn)}var rm=s(Ai*Qo,w),Gg=Ai,Wg=s(Gg,j);if(Wg==null)var Ru=null;else e(65536>=Gg),Ru=Wg;var ad=o(yo);if(Ru==null||ad==null||rm==null){Oi.a=1;break r}var Du=rm;for(on=Rn=0;on<Ai;++on){var No=Ru[on],tc=No.G,rc=No.H,Yg=0,Mu=1,Kg=0;for(Cr=0;5>Cr;++Cr){Sn=Mg[Cr],tc[Cr]=Du,rc[Cr]=Rn,!Cr&&0<Jr&&(Sn+=1<<Jr);i:{var Fu,nm=Sn,Ou=Oi,ld=ad,X_=Du,Z_=Rn,im=0,pa=Ou.m,eS=H(pa,1);if(i(ld,0,0,nm),eS){var tS=H(pa,1)+1,rS=H(pa,1),Qg=H(pa,rS==0?1:8);ld[Qg]=1,tS==2&&(ld[Qg=H(pa,8)]=1);var Bu=1}else{var Jg=o(19),Xg=H(pa,4)+4;if(19<Xg){Ou.a=3;var Vu=0;break i}for(Fu=0;Fu<Xg;++Fu)Jg[I_[Fu]]=H(pa,3);var om=void 0,cd=void 0,Zg=Ou,nS=Jg,ju=nm,ev=ld,sm=0,ma=Zg.m,tv=8,rv=s(128,w);n:for(;P(rv,0,7,nS,19);){if(H(ma,1)){var iS=2+2*H(ma,3);if((om=2+H(ma,iS))>ju)break n}else om=ju;for(cd=0;cd<ju&&om--;){G(ma);var nv=rv[0+(127&_(ma))];$(ma,ma.u+nv.g);var nc=nv.value;if(16>nc)ev[cd++]=nc,nc!=0&&(tv=nc);else{var oS=nc==16,iv=nc-16,sS=$_[iv],ov=H(ma,A_[iv])+sS;if(cd+ov>ju)break n;for(var aS=oS?tv:0;0<ov--;)ev[cd++]=aS}}sm=1;break n}sm||(Zg.a=3),Bu=sm}(Bu=Bu&&!pa.h)&&(im=P(X_,Z_,8,ld,nm)),Bu&&im!=0?Vu=im:(Ou.a=3,Vu=0)}if(Vu==0)break r;if(Mu&&E_[Cr]==1&&(Mu=Du[Rn].g==0),Yg+=Du[Rn].g,Rn+=Vu,3>=Cr){var dd,am=ad[0];for(dd=1;dd<Sn;++dd)ad[dd]>am&&(am=ad[dd]);Kg+=am}}if(No.nd=Mu,No.Qb=0,Mu&&(No.qb=(tc[3][rc[3]+0].value<<24|tc[1][rc[1]+0].value<<16|tc[2][rc[2]+0].value)>>>0,Yg==0&&256>tc[0][rc[0]+0].value&&(No.Qb=1,No.qb+=tc[0][rc[0]+0].value<<8)),No.jc=!No.Qb&&6>Kg,No.jc){var zu,Cs=No;for(zu=0;zu<ni;++zu){var ya=zu,fa=Cs.pd[ya],qu=Cs.G[0][Cs.H[0]+ya];256<=qu.value?(fa.g=qu.g+256,fa.value=qu.value):(fa.g=0,fa.value=0,ya>>=Kt(qu,8,fa),ya>>=Kt(Cs.G[1][Cs.H[1]+ya],16,fa),ya>>=Kt(Cs.G[2][Cs.H[2]+ya],0,fa),Kt(Cs.G[3][Cs.H[3]+ya],24,fa))}}}Yn.vc=ii,Yn.Wb=Ai,Yn.Ya=Ru,Yn.yc=rm,an=1;break t}an=0}if(!(_e=an)){he.a=3;break e}if(0<it){if(De.ua=1<<it,!de(De.Wa,it)){he.a=1,_e=0;break e}}else De.ua=0;var lm=he,sv=xe,lS=$e,cm=lm.s,dm=cm.xc;if(lm.c=sv,lm.i=lS,cm.md=ue(sv,dm),cm.wc=dm==0?-1:(1<<dm)-1,ee){he.xb=B_;break e}if((Ye=o(xe*$e))==null){he.a=1,_e=0;break e}_e=(_e=At(he,Ye,0,xe,$e,$e,null))&&!Te.h;break e}return _e?(Pe!=null?Pe[0]=Ye:(e(Ye==null),e(ee)),he.$=0,ee||Ht(De)):Ht(De),_e}function Dr(y,C){var ee=y.c*y.i,he=ee+C+16*C;return e(y.c<=C),y.V=o(he),y.V==null?(y.Ta=null,y.Ua=0,y.a=1,0):(y.Ta=y.V,y.Ua=y.Ba+ee+C,1)}function vr(y,C){var ee=y.C,he=C-ee,Pe=y.V,_e=y.Ba+y.c*ee;for(e(C<=y.l.o);0<he;){var xe=16<he?16:he,$e=y.l.ma,Te=y.l.width,De=Te*xe,Ye=$e.ca,it=$e.tb+Te*ee,ot=y.Ta,et=y.Ua;pt(y,xe,Pe,_e),$n(ot,et,Ye,it,De),Mt($e,ee,ee+xe,Ye,it,Te),he-=xe,Pe+=xe*y.c,ee+=xe}e(ee==C),y.C=y.Ma=C}function tr(){this.ub=this.yd=this.td=this.Rb=0}function Bt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ar(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function br(){this.Yb=function(){var y=[];return function C(ee,he,Pe){for(var _e=Pe[he],xe=0;xe<_e&&(ee.push(Pe.length>he+1?[]:0),!(Pe.length<he+1));xe++)C(ee[xe],he+1,Pe)}(y,0,[3,11]),y}()}function $r(){this.jb=o(3),this.Wc=l([4,8],br),this.Xc=l([4,17],br)}function mr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function sr(){this.ld=this.La=this.dd=this.tc=0}function Ir(){this.Na=this.la=0}function dr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function rn(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Zn(){this.uc=this.M=this.Nb=0,this.wa=Array(new sr),this.Y=0,this.ya=Array(new rn),this.aa=0,this.l=new Wn}function Gn(){this.y=o(16),this.f=o(8),this.ea=o(8)}function Li(){this.cb=this.a=0,this.sc="",this.m=new se,this.Od=new tr,this.Kc=new Bt,this.ed=new mr,this.Qa=new ar,this.Ic=this.$c=this.Aa=0,this.D=new Zn,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,se),this.ia=0,this.pb=s(4,dr),this.Pa=new $r,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Gn),this.Hd=0,this.rb=Array(new Ir),this.sb=0,this.wa=Array(new sr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new rn),this.L=this.aa=0,this.gd=l([4,2],sr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Wn(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function so(){var y=new Li;return y!=null&&(y.a=0,y.sc="OK",y.cb=0,y.Xb=0,od||(od=_o)),y}function Ur(y,C,ee){return y.a==0&&(y.a=C,y.sc=ee,y.cb=0),0}function Ri(y,C,ee){return 3<=ee&&y[C+0]==157&&y[C+1]==1&&y[C+2]==42}function Po(y,C){if(y==null)return 0;if(y.a=0,y.sc="OK",C==null)return Ur(y,2,"null VP8Io passed to VP8GetHeaders()");var ee=C.data,he=C.w,Pe=C.ha;if(4>Pe)return Ur(y,7,"Truncated header.");var _e=ee[he+0]|ee[he+1]<<8|ee[he+2]<<16,xe=y.Od;if(xe.Rb=!(1&_e),xe.td=_e>>1&7,xe.yd=_e>>4&1,xe.ub=_e>>5,3<xe.td)return Ur(y,3,"Incorrect keyframe parameters.");if(!xe.yd)return Ur(y,4,"Frame not displayable.");he+=3,Pe-=3;var $e=y.Kc;if(xe.Rb){if(7>Pe)return Ur(y,7,"cannot parse picture header");if(!Ri(ee,he,Pe))return Ur(y,3,"Bad code word");$e.c=16383&(ee[he+4]<<8|ee[he+3]),$e.Td=ee[he+4]>>6,$e.i=16383&(ee[he+6]<<8|ee[he+5]),$e.Ud=ee[he+6]>>6,he+=7,Pe-=7,y.za=$e.c+15>>4,y.Ub=$e.i+15>>4,C.width=$e.c,C.height=$e.i,C.Da=0,C.j=0,C.v=0,C.va=C.width,C.o=C.height,C.da=0,C.ib=C.width,C.hb=C.height,C.U=C.width,C.T=C.height,i((_e=y.Pa).jb,0,255,_e.jb.length),e((_e=y.Qa)!=null),_e.Cb=0,_e.Bb=0,_e.Fb=1,i(_e.Zb,0,0,_e.Zb.length),i(_e.Lb,0,0,_e.Lb)}if(xe.ub>Pe)return Ur(y,7,"bad partition length");z(_e=y.m,ee,he,xe.ub),he+=xe.ub,Pe-=xe.ub,xe.Rb&&($e.Ld=U(_e),$e.Kd=U(_e)),$e=y.Qa;var Te,De=y.Pa;if(e(_e!=null),e($e!=null),$e.Cb=U(_e),$e.Cb){if($e.Bb=U(_e),U(_e)){for($e.Fb=U(_e),Te=0;4>Te;++Te)$e.Zb[Te]=U(_e)?R(_e,7):0;for(Te=0;4>Te;++Te)$e.Lb[Te]=U(_e)?R(_e,6):0}if($e.Bb)for(Te=0;3>Te;++Te)De.jb[Te]=U(_e)?T(_e,8):255}else $e.Bb=0;if(_e.Ka)return Ur(y,3,"cannot parse segment header");if(($e=y.ed).zd=U(_e),$e.Tb=T(_e,6),$e.wb=T(_e,3),$e.Pc=U(_e),$e.Pc&&U(_e)){for(De=0;4>De;++De)U(_e)&&($e.vd[De]=R(_e,6));for(De=0;4>De;++De)U(_e)&&($e.od[De]=R(_e,6))}if(y.L=$e.Tb==0?0:$e.zd?1:2,_e.Ka)return Ur(y,3,"cannot parse filter header");var Ye=Pe;if(Pe=Te=he,he=Te+Ye,$e=Ye,y.Xb=(1<<T(y.m,2))-1,Ye<3*(De=y.Xb))ee=7;else{for(Te+=3*De,$e-=3*De,Ye=0;Ye<De;++Ye){var it=ee[Pe+0]|ee[Pe+1]<<8|ee[Pe+2]<<16;it>$e&&(it=$e),z(y.Jc[+Ye],ee,Te,it),Te+=it,$e-=it,Pe+=3}z(y.Jc[+De],ee,Te,$e),ee=Te<he?0:5}if(ee!=0)return Ur(y,ee,"cannot parse partitions");for(ee=T(Te=y.m,7),Pe=U(Te)?R(Te,4):0,he=U(Te)?R(Te,4):0,$e=U(Te)?R(Te,4):0,De=U(Te)?R(Te,4):0,Te=U(Te)?R(Te,4):0,Ye=y.Qa,it=0;4>it;++it){if(Ye.Cb){var ot=Ye.Zb[it];Ye.Fb||(ot+=ee)}else{if(0<it){y.pb[it]=y.pb[0];continue}ot=ee}var et=y.pb[it];et.Sc[0]=Zp[Wr(ot+Pe,127)],et.Sc[1]=em[Wr(ot+0,127)],et.Eb[0]=2*Zp[Wr(ot+he,127)],et.Eb[1]=101581*em[Wr(ot+$e,127)]>>16,8>et.Eb[1]&&(et.Eb[1]=8),et.Qc[0]=Zp[Wr(ot+De,117)],et.Qc[1]=em[Wr(ot+Te,127)],et.lc=ot+Te}if(!xe.Rb)return Ur(y,4,"Not a key frame.");for(U(_e),xe=y.Pa,ee=0;4>ee;++ee){for(Pe=0;8>Pe;++Pe)for(he=0;3>he;++he)for($e=0;11>$e;++$e)De=D(_e,F_[ee][Pe][he][$e])?T(_e,8):D_[ee][Pe][he][$e],xe.Wc[ee][Pe].Yb[he][$e]=De;for(Pe=0;17>Pe;++Pe)xe.Xc[ee][Pe]=xe.Wc[ee][O_[Pe]]}return y.kc=U(_e),y.kc&&(y.Bd=T(_e,8)),y.cb=1}function _o(y,C,ee,he,Pe,_e,xe){var $e=C[Pe].Yb[ee];for(ee=0;16>Pe;++Pe){if(!D(y,$e[ee+0]))return Pe;for(;!D(y,$e[ee+1]);)if($e=C[++Pe].Yb[0],ee=0,Pe==16)return 16;var Te=C[Pe+1].Yb;if(D(y,$e[ee+2])){var De=y,Ye=0;if(D(De,(ot=$e)[(it=ee)+3]))if(D(De,ot[it+6])){for($e=0,it=2*(Ye=D(De,ot[it+8]))+(ot=D(De,ot[it+9+Ye])),Ye=0,ot=L_[it];ot[$e];++$e)Ye+=Ye+D(De,ot[$e]);Ye+=3+(8<<it)}else D(De,ot[it+7])?(Ye=7+2*D(De,165),Ye+=D(De,145)):Ye=5+D(De,159);else Ye=D(De,ot[it+4])?3+D(De,ot[it+5]):2;$e=Te[2]}else Ye=1,$e=Te[1];Te=xe+R_[Pe],0>(De=y).b&&ne(De);var it,ot=De.b,et=(it=De.Ca>>1)-(De.I>>ot)>>31;--De.b,De.Ca+=et,De.Ca|=1,De.I-=(it+1&et)<<ot,_e[Te]=((Ye^et)-et)*he[(0<Pe)+0]}return 16}function fr(y){var C=y.rb[y.sb-1];C.la=0,C.Na=0,i(y.zc,0,0,y.zc.length),y.ja=0}function jr(y,C){if(y==null)return 0;if(C==null)return Ur(y,2,"NULL VP8Io parameter in VP8Decode().");if(!y.cb&&!Po(y,C))return 0;if(e(y.cb),C.ac==null||C.ac(C)){C.ob&&(y.L=0);var ee=Lu[y.L];if(y.L==2?(y.yb=0,y.zb=0):(y.yb=C.v-ee>>4,y.zb=C.j-ee>>4,0>y.yb&&(y.yb=0),0>y.zb&&(y.zb=0)),y.Va=C.o+15+ee>>4,y.Hb=C.va+15+ee>>4,y.Hb>y.za&&(y.Hb=y.za),y.Va>y.Ub&&(y.Va=y.Ub),0<y.L){var he=y.ed;for(ee=0;4>ee;++ee){var Pe;if(y.Qa.Cb){var _e=y.Qa.Lb[ee];y.Qa.Fb||(_e+=he.Tb)}else _e=he.Tb;for(Pe=0;1>=Pe;++Pe){var xe=y.gd[ee][Pe],$e=_e;if(he.Pc&&($e+=he.vd[0],Pe&&($e+=he.od[0])),0<($e=0>$e?0:63<$e?63:$e)){var Te=$e;0<he.wb&&(Te=4<he.wb?Te>>2:Te>>1)>9-he.wb&&(Te=9-he.wb),1>Te&&(Te=1),xe.dd=Te,xe.tc=2*$e+Te,xe.ld=40<=$e?2:15<=$e?1:0}else xe.tc=0;xe.La=Pe}}}ee=0}else Ur(y,6,"Frame setup failed"),ee=y.a;if(ee=ee==0){if(ee){y.$c=0,0<y.Aa||(y.Ic=J_);e:{ee=y.Ic,he=4*(Te=y.za);var De=32*Te,Ye=Te+1,it=0<y.L?Te*(0<y.Aa?2:1):0,ot=(y.Aa==2?2:1)*Te;if((xe=he+832+(Pe=3*(16*ee+Lu[y.L])/2*De)+(_e=y.Fa!=null&&0<y.Fa.length?y.Kc.c*y.Kc.i:0))!=xe)ee=0;else{if(xe>y.Vb){if(y.Vb=0,y.Ec=o(xe),y.Fc=0,y.Ec==null){ee=Ur(y,1,"no memory during frame initialization.");break e}y.Vb=xe}xe=y.Ec,$e=y.Fc,y.Ac=xe,y.Bc=$e,$e+=he,y.Gd=s(De,Gn),y.Hd=0,y.rb=s(Ye+1,Ir),y.sb=1,y.wa=it?s(it,sr):null,y.Y=0,y.D.Nb=0,y.D.wa=y.wa,y.D.Y=y.Y,0<y.Aa&&(y.D.Y+=Te),e(!0),y.oc=xe,y.pc=$e,$e+=832,y.ya=s(ot,rn),y.aa=0,y.D.ya=y.ya,y.D.aa=y.aa,y.Aa==2&&(y.D.aa+=Te),y.R=16*Te,y.B=8*Te,Te=(De=Lu[y.L])*y.R,De=De/2*y.B,y.sa=xe,y.ta=$e+Te,y.qa=y.sa,y.ra=y.ta+16*ee*y.R+De,y.Ha=y.qa,y.Ia=y.ra+8*ee*y.B+De,y.$c=0,$e+=Pe,y.mb=_e?xe:null,y.nb=_e?$e:null,e($e+_e<=y.Fc+y.Vb),fr(y),i(y.Ac,y.Bc,0,he),ee=1}}if(ee){if(C.ka=0,C.y=y.sa,C.O=y.ta,C.f=y.qa,C.N=y.ra,C.ea=y.Ha,C.Vd=y.Ia,C.fa=y.R,C.Rc=y.B,C.F=null,C.J=0,!xu){for(ee=-255;255>=ee;++ee)jn[255+ee]=0>ee?-ee:ee;for(ee=-1020;1020>=ee;++ee)Ss[1020+ee]=-128>ee?-128:127<ee?127:ee;for(ee=-112;112>=ee;++ee)id[112+ee]=-16>ee?-16:15<ee?15:ee;for(ee=-255;510>=ee;++ee)Zl[255+ee]=0>ee?0:255<ee?255:ee;xu=1}Ql=wo,_s=Di,td=Wi,Ci=zr,co=So,An=wi,Jl=Xs,wu=Eo,rd=ea,nl=tl,il=Zs,la=fs,ol=ta,Xl=Go,sl=ys,ca=Qi,nd=Vn,uo=ql,ko[0]=ao,ko[1]=Yc,ko[2]=Uo,ko[3]=Qc,ko[4]=jl,ko[5]=Ys,ko[6]=Yi,ko[7]=Ka,ko[8]=Qs,ko[9]=Ks,da[0]=qo,da[1]=Kc,da[2]=Co,da[3]=Gs,da[4]=yn,da[5]=Vl,da[6]=Ya,ws[0]=$o,ws[1]=Bl,ws[2]=zl,ws[3]=Ao,ws[4]=Gr,ws[5]=Qa,ws[6]=Ja,ee=1}else ee=0}ee&&(ee=function(et,St){for(et.M=0;et.M<et.Va;++et.M){var ut,Ke=et.Jc[et.M&et.Xb],Qe=et.m,Pt=et;for(ut=0;ut<Pt.za;++ut){var $t=Qe,_t=Pt,Qt=_t.Ac,zt=_t.Bc+4*ut,lr=_t.zc,Ut=_t.ya[_t.aa+ut];if(_t.Qa.Bb?Ut.$b=D($t,_t.Pa.jb[0])?2+D($t,_t.Pa.jb[2]):D($t,_t.Pa.jb[1]):Ut.$b=0,_t.kc&&(Ut.Ad=D($t,_t.Bd)),Ut.Za=!D($t,145)+0,Ut.Za){var qr=Ut.Ob,Qr=0;for(_t=0;4>_t;++_t){var Or,kr=lr[0+_t];for(Or=0;4>Or;++Or){kr=M_[Qt[zt+Or]][kr];for(var an=Fg[D($t,kr[0])];0<an;)an=Fg[2*an+D($t,kr[an])];kr=-an,Qt[zt+Or]=kr}n(qr,Qr,Qt,zt,4),Qr+=4,lr[0+_t]=kr}}else kr=D($t,156)?D($t,128)?1:3:D($t,163)?2:0,Ut.Ob[0]=kr,i(Qt,zt,kr,4),i(lr,0,kr,4);Ut.Dd=D($t,142)?D($t,114)?D($t,183)?1:3:2:0}if(Pt.m.Ka)return Ur(et,7,"Premature end-of-partition0 encountered.");for(;et.ja<et.za;++et.ja){if(Pt=Ke,$t=(Qe=et).rb[Qe.sb-1],Qt=Qe.rb[Qe.sb+Qe.ja],ut=Qe.ya[Qe.aa+Qe.ja],zt=Qe.kc?ut.Ad:0)$t.la=Qt.la=0,ut.Za||($t.Na=Qt.Na=0),ut.Hc=0,ut.Gc=0,ut.ia=0;else{var on,Cr;if($t=Qt,Qt=Pt,zt=Qe.Pa.Xc,lr=Qe.ya[Qe.aa+Qe.ja],Ut=Qe.pb[lr.$b],_t=lr.ad,qr=0,Qr=Qe.rb[Qe.sb-1],kr=Or=0,i(_t,qr,0,384),lr.Za)var Rn=0,Oi=zt[3];else{an=o(16);var Dn=$t.Na+Qr.Na;if(Dn=od(Qt,zt[1],Dn,Ut.Eb,0,an,0),$t.Na=Qr.Na=(0<Dn)+0,1<Dn)Ql(an,0,_t,qr);else{var Bi=an[0]+3>>3;for(an=0;256>an;an+=16)_t[qr+an]=Bi}Rn=1,Oi=zt[0]}var Jr=15&$t.la,Xi=15&Qr.la;for(an=0;4>an;++an){var Zi=1&Xi;for(Bi=Cr=0;4>Bi;++Bi)Jr=Jr>>1|(Zi=(Dn=od(Qt,Oi,Dn=Zi+(1&Jr),Ut.Sc,Rn,_t,qr))>Rn)<<7,Cr=Cr<<2|(3<Dn?3:1<Dn?2:_t[qr+0]!=0),qr+=16;Jr>>=4,Xi=Xi>>1|Zi<<7,Or=(Or<<8|Cr)>>>0}for(Oi=Jr,Rn=Xi>>4,on=0;4>on;on+=2){for(Cr=0,Jr=$t.la>>4+on,Xi=Qr.la>>4+on,an=0;2>an;++an){for(Zi=1&Xi,Bi=0;2>Bi;++Bi)Dn=Zi+(1&Jr),Jr=Jr>>1|(Zi=0<(Dn=od(Qt,zt[2],Dn,Ut.Qc,0,_t,qr)))<<3,Cr=Cr<<2|(3<Dn?3:1<Dn?2:_t[qr+0]!=0),qr+=16;Jr>>=2,Xi=Xi>>1|Zi<<5}kr|=Cr<<4*on,Oi|=Jr<<4<<on,Rn|=(240&Xi)<<on}$t.la=Oi,Qr.la=Rn,lr.Hc=Or,lr.Gc=kr,lr.ia=43690&kr?0:Ut.ia,zt=!(Or|kr)}if(0<Qe.L&&(Qe.wa[Qe.Y+Qe.ja]=Qe.gd[ut.$b][ut.Za],Qe.wa[Qe.Y+Qe.ja].La|=!zt),Pt.Ka)return Ur(et,7,"Premature end-of-file encountered.")}if(fr(et),Qe=St,Pt=1,ut=(Ke=et).D,$t=0<Ke.L&&Ke.M>=Ke.zb&&Ke.M<=Ke.Va,Ke.Aa==0)e:{if(ut.M=Ke.M,ut.uc=$t,Yo(Ke,ut),Pt=1,ut=(Cr=Ke.D).Nb,$t=(kr=Lu[Ke.L])*Ke.R,Qt=kr/2*Ke.B,an=16*ut*Ke.R,Bi=8*ut*Ke.B,zt=Ke.sa,lr=Ke.ta-$t+an,Ut=Ke.qa,_t=Ke.ra-Qt+Bi,qr=Ke.Ha,Qr=Ke.Ia-Qt+Bi,Xi=(Jr=Cr.M)==0,Or=Jr>=Ke.Va-1,Ke.Aa==2&&Yo(Ke,Cr),Cr.uc)for(Zi=(Dn=Ke).D.M,e(Dn.D.uc),Cr=Dn.yb;Cr<Dn.Hb;++Cr){Rn=Cr,Oi=Zi;var Yn=(ii=(Sn=Dn).D).Nb;on=Sn.R;var ii=ii.wa[ii.Y+Rn],Ai=Sn.sa,yo=Sn.ta+16*Yn*on+16*Rn,Qo=ii.dd,Kn=ii.tc;if(Kn!=0)if(e(3<=Kn),Sn.L==1)0<Rn&&ca(Ai,yo,on,Kn+4),ii.La&&uo(Ai,yo,on,Kn),0<Oi&&sl(Ai,yo,on,Kn+4),ii.La&&nd(Ai,yo,on,Kn);else{var xs=Sn.B,al=Sn.qa,ec=Sn.ra+8*Yn*xs+8*Rn,ha=Sn.Ha,Sn=Sn.Ia+8*Yn*xs+8*Rn;Yn=ii.ld,0<Rn&&(wu(Ai,yo,on,Kn+4,Qo,Yn),nl(al,ec,ha,Sn,xs,Kn+4,Qo,Yn)),ii.La&&(la(Ai,yo,on,Kn,Qo,Yn),Xl(al,ec,ha,Sn,xs,Kn,Qo,Yn)),0<Oi&&(Jl(Ai,yo,on,Kn+4,Qo,Yn),rd(al,ec,ha,Sn,xs,Kn+4,Qo,Yn)),ii.La&&(il(Ai,yo,on,Kn,Qo,Yn),ol(al,ec,ha,Sn,xs,Kn,Qo,Yn))}}if(Ke.ia&&alert("todo:DitherRow"),Qe.put!=null){if(Cr=16*Jr,Jr=16*(Jr+1),Xi?(Qe.y=Ke.sa,Qe.O=Ke.ta+an,Qe.f=Ke.qa,Qe.N=Ke.ra+Bi,Qe.ea=Ke.Ha,Qe.W=Ke.Ia+Bi):(Cr-=kr,Qe.y=zt,Qe.O=lr,Qe.f=Ut,Qe.N=_t,Qe.ea=qr,Qe.W=Qr),Or||(Jr-=kr),Jr>Qe.o&&(Jr=Qe.o),Qe.F=null,Qe.J=null,Ke.Fa!=null&&0<Ke.Fa.length&&Cr<Jr&&(Qe.J=oa(Ke,Qe,Cr,Jr-Cr),Qe.F=Ke.mb,Qe.F==null&&Qe.F.length==0)){Pt=Ur(Ke,3,"Could not decode alpha data.");break e}Cr<Qe.j&&(kr=Qe.j-Cr,Cr=Qe.j,e(!(1&kr)),Qe.O+=Ke.R*kr,Qe.N+=Ke.B*(kr>>1),Qe.W+=Ke.B*(kr>>1),Qe.F!=null&&(Qe.J+=Qe.width*kr)),Cr<Jr&&(Qe.O+=Qe.v,Qe.N+=Qe.v>>1,Qe.W+=Qe.v>>1,Qe.F!=null&&(Qe.J+=Qe.v),Qe.ka=Cr-Qe.j,Qe.U=Qe.va-Qe.v,Qe.T=Jr-Cr,Pt=Qe.put(Qe))}ut+1!=Ke.Ic||Or||(n(Ke.sa,Ke.ta-$t,zt,lr+16*Ke.R,$t),n(Ke.qa,Ke.ra-Qt,Ut,_t+8*Ke.B,Qt),n(Ke.Ha,Ke.Ia-Qt,qr,Qr+8*Ke.B,Qt))}if(!Pt)return Ur(et,6,"Output aborted.")}return 1}(y,C)),C.bc!=null&&C.bc(C),ee&=1}return ee?(y.cb=0,ee):0}function nn(y,C,ee,he,Pe){Pe=y[C+ee+32*he]+(Pe>>3),y[C+ee+32*he]=-256&Pe?0>Pe?0:255:Pe}function ei(y,C,ee,he,Pe,_e){nn(y,C,0,ee,he+Pe),nn(y,C,1,ee,he+_e),nn(y,C,2,ee,he-_e),nn(y,C,3,ee,he-Pe)}function Hr(y){return(20091*y>>16)+y}function Fr(y,C,ee,he){var Pe,_e=0,xe=o(16);for(Pe=0;4>Pe;++Pe){var $e=y[C+0]+y[C+8],Te=y[C+0]-y[C+8],De=(35468*y[C+4]>>16)-Hr(y[C+12]),Ye=Hr(y[C+4])+(35468*y[C+12]>>16);xe[_e+0]=$e+Ye,xe[_e+1]=Te+De,xe[_e+2]=Te-De,xe[_e+3]=$e-Ye,_e+=4,C++}for(Pe=_e=0;4>Pe;++Pe)$e=(y=xe[_e+0]+4)+xe[_e+8],Te=y-xe[_e+8],De=(35468*xe[_e+4]>>16)-Hr(xe[_e+12]),nn(ee,he,0,0,$e+(Ye=Hr(xe[_e+4])+(35468*xe[_e+12]>>16))),nn(ee,he,1,0,Te+De),nn(ee,he,2,0,Te-De),nn(ee,he,3,0,$e-Ye),_e++,he+=32}function wi(y,C,ee,he){var Pe=y[C+0]+4,_e=35468*y[C+4]>>16,xe=Hr(y[C+4]),$e=35468*y[C+1]>>16;ei(ee,he,0,Pe+xe,y=Hr(y[C+1]),$e),ei(ee,he,1,Pe+_e,y,$e),ei(ee,he,2,Pe-_e,y,$e),ei(ee,he,3,Pe-xe,y,$e)}function Di(y,C,ee,he,Pe){Fr(y,C,ee,he),Pe&&Fr(y,C+16,ee,he+4)}function Wi(y,C,ee,he){_s(y,C+0,ee,he,1),_s(y,C+32,ee,he+128,1)}function zr(y,C,ee,he){var Pe;for(y=y[C+0]+4,Pe=0;4>Pe;++Pe)for(C=0;4>C;++C)nn(ee,he,C,Pe,y)}function So(y,C,ee,he){y[C+0]&&Ci(y,C+0,ee,he),y[C+16]&&Ci(y,C+16,ee,he+4),y[C+32]&&Ci(y,C+32,ee,he+128),y[C+48]&&Ci(y,C+48,ee,he+128+4)}function wo(y,C,ee,he){var Pe,_e=o(16);for(Pe=0;4>Pe;++Pe){var xe=y[C+0+Pe]+y[C+12+Pe],$e=y[C+4+Pe]+y[C+8+Pe],Te=y[C+4+Pe]-y[C+8+Pe],De=y[C+0+Pe]-y[C+12+Pe];_e[0+Pe]=xe+$e,_e[8+Pe]=xe-$e,_e[4+Pe]=De+Te,_e[12+Pe]=De-Te}for(Pe=0;4>Pe;++Pe)xe=(y=_e[0+4*Pe]+3)+_e[3+4*Pe],$e=_e[1+4*Pe]+_e[2+4*Pe],Te=_e[1+4*Pe]-_e[2+4*Pe],De=y-_e[3+4*Pe],ee[he+0]=xe+$e>>3,ee[he+16]=De+Te>>3,ee[he+32]=xe-$e>>3,ee[he+48]=De-Te>>3,he+=64}function xo(y,C,ee){var he,Pe=C-32,_e=Ji,xe=255-y[Pe-1];for(he=0;he<ee;++he){var $e,Te=_e,De=xe+y[C-1];for($e=0;$e<ee;++$e)y[C+$e]=Te[De+y[Pe+$e]];C+=32}}function Yc(y,C){xo(y,C,4)}function Bl(y,C){xo(y,C,8)}function Kc(y,C){xo(y,C,16)}function Co(y,C){var ee;for(ee=0;16>ee;++ee)n(y,C+32*ee,y,C-32,16)}function Gs(y,C){var ee;for(ee=16;0<ee;--ee)i(y,C,y[C-1],16),C+=32}function Ws(y,C,ee){var he;for(he=0;16>he;++he)i(C,ee+32*he,y,16)}function qo(y,C){var ee,he=16;for(ee=0;16>ee;++ee)he+=y[C-1+32*ee]+y[C+ee-32];Ws(he>>5,y,C)}function yn(y,C){var ee,he=8;for(ee=0;16>ee;++ee)he+=y[C-1+32*ee];Ws(he>>4,y,C)}function Vl(y,C){var ee,he=8;for(ee=0;16>ee;++ee)he+=y[C+ee-32];Ws(he>>4,y,C)}function Ya(y,C){Ws(128,y,C)}function pr(y,C,ee){return y+2*C+ee+2>>2}function Uo(y,C){var ee,he=C-32;for(he=new Uint8Array([pr(y[he-1],y[he+0],y[he+1]),pr(y[he+0],y[he+1],y[he+2]),pr(y[he+1],y[he+2],y[he+3]),pr(y[he+2],y[he+3],y[he+4])]),ee=0;4>ee;++ee)n(y,C+32*ee,he,0,he.length)}function Qc(y,C){var ee=y[C-1],he=y[C-1+32],Pe=y[C-1+64],_e=y[C-1+96];B(y,C+0,16843009*pr(y[C-1-32],ee,he)),B(y,C+32,16843009*pr(ee,he,Pe)),B(y,C+64,16843009*pr(he,Pe,_e)),B(y,C+96,16843009*pr(Pe,_e,_e))}function ao(y,C){var ee,he=4;for(ee=0;4>ee;++ee)he+=y[C+ee-32]+y[C-1+32*ee];for(he>>=3,ee=0;4>ee;++ee)i(y,C+32*ee,he,4)}function jl(y,C){var ee=y[C-1+0],he=y[C-1+32],Pe=y[C-1+64],_e=y[C-1-32],xe=y[C+0-32],$e=y[C+1-32],Te=y[C+2-32],De=y[C+3-32];y[C+0+96]=pr(he,Pe,y[C-1+96]),y[C+1+96]=y[C+0+64]=pr(ee,he,Pe),y[C+2+96]=y[C+1+64]=y[C+0+32]=pr(_e,ee,he),y[C+3+96]=y[C+2+64]=y[C+1+32]=y[C+0+0]=pr(xe,_e,ee),y[C+3+64]=y[C+2+32]=y[C+1+0]=pr($e,xe,_e),y[C+3+32]=y[C+2+0]=pr(Te,$e,xe),y[C+3+0]=pr(De,Te,$e)}function Yi(y,C){var ee=y[C+1-32],he=y[C+2-32],Pe=y[C+3-32],_e=y[C+4-32],xe=y[C+5-32],$e=y[C+6-32],Te=y[C+7-32];y[C+0+0]=pr(y[C+0-32],ee,he),y[C+1+0]=y[C+0+32]=pr(ee,he,Pe),y[C+2+0]=y[C+1+32]=y[C+0+64]=pr(he,Pe,_e),y[C+3+0]=y[C+2+32]=y[C+1+64]=y[C+0+96]=pr(Pe,_e,xe),y[C+3+32]=y[C+2+64]=y[C+1+96]=pr(_e,xe,$e),y[C+3+64]=y[C+2+96]=pr(xe,$e,Te),y[C+3+96]=pr($e,Te,Te)}function Ys(y,C){var ee=y[C-1+0],he=y[C-1+32],Pe=y[C-1+64],_e=y[C-1-32],xe=y[C+0-32],$e=y[C+1-32],Te=y[C+2-32],De=y[C+3-32];y[C+0+0]=y[C+1+64]=_e+xe+1>>1,y[C+1+0]=y[C+2+64]=xe+$e+1>>1,y[C+2+0]=y[C+3+64]=$e+Te+1>>1,y[C+3+0]=Te+De+1>>1,y[C+0+96]=pr(Pe,he,ee),y[C+0+64]=pr(he,ee,_e),y[C+0+32]=y[C+1+96]=pr(ee,_e,xe),y[C+1+32]=y[C+2+96]=pr(_e,xe,$e),y[C+2+32]=y[C+3+96]=pr(xe,$e,Te),y[C+3+32]=pr($e,Te,De)}function Ka(y,C){var ee=y[C+0-32],he=y[C+1-32],Pe=y[C+2-32],_e=y[C+3-32],xe=y[C+4-32],$e=y[C+5-32],Te=y[C+6-32],De=y[C+7-32];y[C+0+0]=ee+he+1>>1,y[C+1+0]=y[C+0+64]=he+Pe+1>>1,y[C+2+0]=y[C+1+64]=Pe+_e+1>>1,y[C+3+0]=y[C+2+64]=_e+xe+1>>1,y[C+0+32]=pr(ee,he,Pe),y[C+1+32]=y[C+0+96]=pr(he,Pe,_e),y[C+2+32]=y[C+1+96]=pr(Pe,_e,xe),y[C+3+32]=y[C+2+96]=pr(_e,xe,$e),y[C+3+64]=pr(xe,$e,Te),y[C+3+96]=pr($e,Te,De)}function Ks(y,C){var ee=y[C-1+0],he=y[C-1+32],Pe=y[C-1+64],_e=y[C-1+96];y[C+0+0]=ee+he+1>>1,y[C+2+0]=y[C+0+32]=he+Pe+1>>1,y[C+2+32]=y[C+0+64]=Pe+_e+1>>1,y[C+1+0]=pr(ee,he,Pe),y[C+3+0]=y[C+1+32]=pr(he,Pe,_e),y[C+3+32]=y[C+1+64]=pr(Pe,_e,_e),y[C+3+64]=y[C+2+64]=y[C+0+96]=y[C+1+96]=y[C+2+96]=y[C+3+96]=_e}function Qs(y,C){var ee=y[C-1+0],he=y[C-1+32],Pe=y[C-1+64],_e=y[C-1+96],xe=y[C-1-32],$e=y[C+0-32],Te=y[C+1-32],De=y[C+2-32];y[C+0+0]=y[C+2+32]=ee+xe+1>>1,y[C+0+32]=y[C+2+64]=he+ee+1>>1,y[C+0+64]=y[C+2+96]=Pe+he+1>>1,y[C+0+96]=_e+Pe+1>>1,y[C+3+0]=pr($e,Te,De),y[C+2+0]=pr(xe,$e,Te),y[C+1+0]=y[C+3+32]=pr(ee,xe,$e),y[C+1+32]=y[C+3+64]=pr(he,ee,xe),y[C+1+64]=y[C+3+96]=pr(Pe,he,ee),y[C+1+96]=pr(_e,Pe,he)}function zl(y,C){var ee;for(ee=0;8>ee;++ee)n(y,C+32*ee,y,C-32,8)}function Ao(y,C){var ee;for(ee=0;8>ee;++ee)i(y,C,y[C-1],8),C+=32}function Ki(y,C,ee){var he;for(he=0;8>he;++he)i(C,ee+32*he,y,8)}function $o(y,C){var ee,he=8;for(ee=0;8>ee;++ee)he+=y[C+ee-32]+y[C-1+32*ee];Ki(he>>4,y,C)}function Qa(y,C){var ee,he=4;for(ee=0;8>ee;++ee)he+=y[C+ee-32];Ki(he>>3,y,C)}function Gr(y,C){var ee,he=4;for(ee=0;8>ee;++ee)he+=y[C-1+32*ee];Ki(he>>3,y,C)}function Ja(y,C){Ki(128,y,C)}function Js(y,C,ee){var he=y[C-ee],Pe=y[C+0],_e=3*(Pe-he)+Yp[1020+y[C-2*ee]-y[C+ee]],xe=Cu[112+(_e+4>>3)];y[C-ee]=Ji[255+he+Cu[112+(_e+3>>3)]],y[C+0]=Ji[255+Pe-xe]}function Xa(y,C,ee,he){var Pe=y[C+0],_e=y[C+ee];return po[255+y[C-2*ee]-y[C-ee]]>he||po[255+_e-Pe]>he}function Za(y,C,ee,he){return 4*po[255+y[C-ee]-y[C+0]]+po[255+y[C-2*ee]-y[C+ee]]<=he}function el(y,C,ee,he,Pe){var _e=y[C-3*ee],xe=y[C-2*ee],$e=y[C-ee],Te=y[C+0],De=y[C+ee],Ye=y[C+2*ee],it=y[C+3*ee];return 4*po[255+$e-Te]+po[255+xe-De]>he?0:po[255+y[C-4*ee]-_e]<=Pe&&po[255+_e-xe]<=Pe&&po[255+xe-$e]<=Pe&&po[255+it-Ye]<=Pe&&po[255+Ye-De]<=Pe&&po[255+De-Te]<=Pe}function ys(y,C,ee,he){var Pe=2*he+1;for(he=0;16>he;++he)Za(y,C+he,ee,Pe)&&Js(y,C+he,ee)}function Qi(y,C,ee,he){var Pe=2*he+1;for(he=0;16>he;++he)Za(y,C+he*ee,1,Pe)&&Js(y,C+he*ee,1)}function Vn(y,C,ee,he){var Pe;for(Pe=3;0<Pe;--Pe)ys(y,C+=4*ee,ee,he)}function ql(y,C,ee,he){var Pe;for(Pe=3;0<Pe;--Pe)Qi(y,C+=4,ee,he)}function Ho(y,C,ee,he,Pe,_e,xe,$e){for(_e=2*_e+1;0<Pe--;){if(el(y,C,ee,_e,xe))if(Xa(y,C,ee,$e))Js(y,C,ee);else{var Te=y,De=C,Ye=ee,it=Te[De-2*Ye],ot=Te[De-Ye],et=Te[De+0],St=Te[De+Ye],ut=Te[De+2*Ye],Ke=27*(Pt=Yp[1020+3*(et-ot)+Yp[1020+it-St]])+63>>7,Qe=18*Pt+63>>7,Pt=9*Pt+63>>7;Te[De-3*Ye]=Ji[255+Te[De-3*Ye]+Pt],Te[De-2*Ye]=Ji[255+it+Qe],Te[De-Ye]=Ji[255+ot+Ke],Te[De+0]=Ji[255+et-Ke],Te[De+Ye]=Ji[255+St-Qe],Te[De+2*Ye]=Ji[255+ut-Pt]}C+=he}}function ti(y,C,ee,he,Pe,_e,xe,$e){for(_e=2*_e+1;0<Pe--;){if(el(y,C,ee,_e,xe))if(Xa(y,C,ee,$e))Js(y,C,ee);else{var Te=y,De=C,Ye=ee,it=Te[De-Ye],ot=Te[De+0],et=Te[De+Ye],St=Cu[112+((ut=3*(ot-it))+4>>3)],ut=Cu[112+(ut+3>>3)],Ke=St+1>>1;Te[De-2*Ye]=Ji[255+Te[De-2*Ye]+Ke],Te[De-Ye]=Ji[255+it+ut],Te[De+0]=Ji[255+ot-St],Te[De+Ye]=Ji[255+et-Ke]}C+=he}}function Xs(y,C,ee,he,Pe,_e){Ho(y,C,ee,1,16,he,Pe,_e)}function Eo(y,C,ee,he,Pe,_e){Ho(y,C,1,ee,16,he,Pe,_e)}function Zs(y,C,ee,he,Pe,_e){var xe;for(xe=3;0<xe;--xe)ti(y,C+=4*ee,ee,1,16,he,Pe,_e)}function fs(y,C,ee,he,Pe,_e){var xe;for(xe=3;0<xe;--xe)ti(y,C+=4,1,ee,16,he,Pe,_e)}function ea(y,C,ee,he,Pe,_e,xe,$e){Ho(y,C,Pe,1,8,_e,xe,$e),Ho(ee,he,Pe,1,8,_e,xe,$e)}function tl(y,C,ee,he,Pe,_e,xe,$e){Ho(y,C,1,Pe,8,_e,xe,$e),Ho(ee,he,1,Pe,8,_e,xe,$e)}function ta(y,C,ee,he,Pe,_e,xe,$e){ti(y,C+4*Pe,Pe,1,8,_e,xe,$e),ti(ee,he+4*Pe,Pe,1,8,_e,xe,$e)}function Go(y,C,ee,he,Pe,_e,xe,$e){ti(y,C+4,1,Pe,8,_e,xe,$e),ti(ee,he+4,1,Pe,8,_e,xe,$e)}function gs(){this.ba=new Xe,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Le,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ra(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function vs(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function na(){this.ua=0,this.Wa=new Y,this.vb=new Y,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new j,this.yc=new w}function Ul(){this.xb=this.a=0,this.l=new Wn,this.ca=new Xe,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new O,this.Pb=0,this.wd=new O,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new na,this.ab=0,this.gc=s(4,vs),this.Oc=0}function Io(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Wn,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Wo(y,C,ee,he,Pe,_e,xe){for(y=y==null?0:y[C+0],C=0;C<xe;++C)Pe[_e+C]=y+ee[he+C]&255,y=Pe[_e+C]}function ia(y,C,ee,he,Pe,_e,xe){var $e;if(y==null)Wo(null,null,ee,he,Pe,_e,xe);else for($e=0;$e<xe;++$e)Pe[_e+$e]=y[C+$e]+ee[he+$e]&255}function ci(y,C,ee,he,Pe,_e,xe){if(y==null)Wo(null,null,ee,he,Pe,_e,xe);else{var $e,Te=y[C+0],De=Te,Ye=Te;for($e=0;$e<xe;++$e)De=Ye+(Te=y[C+$e])-De,Ye=ee[he+$e]+(-256&De?0>De?0:255:De)&255,De=Te,Pe[_e+$e]=Ye}}function oa(y,C,ee,he){var Pe=C.width,_e=C.o;if(e(y!=null&&C!=null),0>ee||0>=he||ee+he>_e)return null;if(!y.Cc){if(y.ga==null){var xe;if(y.ga=new Io,(xe=y.ga==null)||(xe=C.width*C.o,e(y.Gb.length==0),y.Gb=o(xe),y.Uc=0,y.Gb==null?xe=0:(y.mb=y.Gb,y.nb=y.Uc,y.rc=null,xe=1),xe=!xe),!xe){xe=y.ga;var $e=y.Fa,Te=y.P,De=y.qc,Ye=y.mb,it=y.nb,ot=Te+1,et=De-1,St=xe.l;if(e($e!=null&&Ye!=null&&C!=null),ua[0]=null,ua[1]=Wo,ua[2]=ia,ua[3]=ci,xe.ca=Ye,xe.tb=it,xe.c=C.width,xe.i=C.height,e(0<xe.c&&0<xe.i),1>=De)C=0;else if(xe.$a=$e[Te+0]>>0&3,xe.Z=$e[Te+0]>>2&3,xe.Lc=$e[Te+0]>>4&3,Te=$e[Te+0]>>6&3,0>xe.$a||1<xe.$a||4<=xe.Z||1<xe.Lc||Te)C=0;else if(St.put=Ot,St.ac=Et,St.bc=jt,St.ma=xe,St.width=C.width,St.height=C.height,St.Da=C.Da,St.v=C.v,St.va=C.va,St.j=C.j,St.o=C.o,xe.$a)e:{e(xe.$a==1),C=Yt();t:for(;;){if(C==null){C=0;break e}if(e(xe!=null),xe.mc=C,C.c=xe.c,C.i=xe.i,C.l=xe.l,C.l.ma=xe,C.l.width=xe.c,C.l.height=xe.i,C.a=0,J(C.m,$e,ot,et),!nr(xe.c,xe.i,1,C,null)||(C.ab==1&&C.gc[0].hc==3&&bt(C.s)?(xe.ic=1,$e=C.c*C.i,C.Ta=null,C.Ua=0,C.V=o($e),C.Ba=0,C.V==null?(C.a=1,C=0):C=1):(xe.ic=0,C=Dr(C,xe.c)),!C))break t;C=1;break e}xe.mc=null,C=0}else C=et>=xe.c*xe.i;xe=!C}if(xe)return null;y.ga.Lc!=1?y.Ga=0:he=_e-ee}e(y.ga!=null),e(ee+he<=_e);e:{if(C=($e=y.ga).c,_e=$e.l.o,$e.$a==0){if(ot=y.rc,et=y.Vc,St=y.Fa,Te=y.P+1+ee*C,De=y.mb,Ye=y.nb+ee*C,e(Te<=y.P+y.qc),$e.Z!=0)for(e(ua[$e.Z]!=null),xe=0;xe<he;++xe)ua[$e.Z](ot,et,St,Te,De,Ye,C),ot=De,et=Ye,Ye+=C,Te+=C;else for(xe=0;xe<he;++xe)n(De,Ye,St,Te,C),ot=De,et=Ye,Ye+=C,Te+=C;y.rc=ot,y.Vc=et}else{if(e($e.mc!=null),C=ee+he,e((xe=$e.mc)!=null),e(C<=xe.i),xe.C>=C)C=1;else if($e.ic||Ze(),$e.ic){$e=xe.V,ot=xe.Ba,et=xe.c;var ut=xe.i,Ke=(St=1,Te=xe.$/et,De=xe.$%et,Ye=xe.m,it=xe.s,xe.$),Qe=et*ut,Pt=et*C,$t=it.wc,_t=Ke<Pt?dt(it,De,Te):null;e(Ke<=Qe),e(C<=ut),e(bt(it));t:for(;;){for(;!Ye.h&&Ke<Pt;){if(De&$t||(_t=dt(it,De,Te)),e(_t!=null),G(Ye),256>(ut=Dt(_t.G[0],_t.H[0],Ye)))$e[ot+Ke]=ut,++Ke,++De>=et&&(De=0,++Te<=C&&!(Te%16)&&ft(xe,Te));else{if(!(280>ut)){St=0;break t}ut=Zt(ut-256,Ye);var Qt,zt=Dt(_t.G[4],_t.H[4],Ye);if(G(Ye),!(Ke>=(zt=rr(et,zt=Zt(zt,Ye)))&&Qe-Ke>=ut)){St=0;break t}for(Qt=0;Qt<ut;++Qt)$e[ot+Ke+Qt]=$e[ot+Ke+Qt-zt];for(Ke+=ut,De+=ut;De>=et;)De-=et,++Te<=C&&!(Te%16)&&ft(xe,Te);Ke<Pt&&De&$t&&(_t=dt(it,De,Te))}e(Ye.h==k(Ye))}ft(xe,Te>C?C:Te);break t}!St||Ye.h&&Ke<Qe?(St=0,xe.a=Ye.h?5:3):xe.$=Ke,C=St}else C=At(xe,xe.V,xe.Ba,xe.c,xe.i,C,vr);if(!C){he=0;break e}}ee+he>=_e&&(y.Cc=1),he=1}if(!he)return null;if(y.Cc&&((he=y.ga)!=null&&(he.mc=null),y.ga=null,0<y.Ga))return alert("todo:WebPDequantizeLevels"),null}return y.nb+ee*Pe}function q(y,C,ee,he,Pe,_e){for(;0<Pe--;){var xe,$e=y,Te=C+(ee?1:0),De=y,Ye=C+(ee?0:3);for(xe=0;xe<he;++xe){var it=De[Ye+4*xe];it!=255&&(it*=32897,$e[Te+4*xe+0]=$e[Te+4*xe+0]*it>>23,$e[Te+4*xe+1]=$e[Te+4*xe+1]*it>>23,$e[Te+4*xe+2]=$e[Te+4*xe+2]*it>>23)}C+=_e}}function be(y,C,ee,he,Pe){for(;0<he--;){var _e;for(_e=0;_e<ee;++_e){var xe=y[C+2*_e+0],$e=15&(De=y[C+2*_e+1]),Te=4369*$e,De=(240&De|De>>4)*Te>>16;y[C+2*_e+0]=(240&xe|xe>>4)*Te>>16&240|(15&xe|xe<<4)*Te>>16>>4&15,y[C+2*_e+1]=240&De|$e}C+=Pe}}function Oe(y,C,ee,he,Pe,_e,xe,$e){var Te,De,Ye=255;for(De=0;De<Pe;++De){for(Te=0;Te<he;++Te){var it=y[C+Te];_e[xe+4*Te]=it,Ye&=it}C+=ee,xe+=$e}return Ye!=255}function Ue(y,C,ee,he,Pe){var _e;for(_e=0;_e<Pe;++_e)ee[he+_e]=y[C+_e]>>8}function Ze(){ho=q,hn=be,pn=Oe,$n=Ue}function ht(y,C,ee){E[y]=function(he,Pe,_e,xe,$e,Te,De,Ye,it,ot,et,St,ut,Ke,Qe,Pt,$t){var _t,Qt=$t-1>>1,zt=$e[Te+0]|De[Ye+0]<<16,lr=it[ot+0]|et[St+0]<<16;e(he!=null);var Ut=3*zt+lr+131074>>2;for(C(he[Pe+0],255&Ut,Ut>>16,ut,Ke),_e!=null&&(Ut=3*lr+zt+131074>>2,C(_e[xe+0],255&Ut,Ut>>16,Qe,Pt)),_t=1;_t<=Qt;++_t){var qr=$e[Te+_t]|De[Ye+_t]<<16,Qr=it[ot+_t]|et[St+_t]<<16,Or=zt+qr+lr+Qr+524296,kr=Or+2*(qr+lr)>>3;Ut=kr+zt>>1,zt=(Or=Or+2*(zt+Qr)>>3)+qr>>1,C(he[Pe+2*_t-1],255&Ut,Ut>>16,ut,Ke+(2*_t-1)*ee),C(he[Pe+2*_t-0],255&zt,zt>>16,ut,Ke+(2*_t-0)*ee),_e!=null&&(Ut=Or+lr>>1,zt=kr+Qr>>1,C(_e[xe+2*_t-1],255&Ut,Ut>>16,Qe,Pt+(2*_t-1)*ee),C(_e[xe+2*_t+0],255&zt,zt>>16,Qe,Pt+(2*_t+0)*ee)),zt=qr,lr=Qr}1&$t||(Ut=3*zt+lr+131074>>2,C(he[Pe+$t-1],255&Ut,Ut>>16,ut,Ke+($t-1)*ee),_e!=null&&(Ut=3*lr+zt+131074>>2,C(_e[xe+$t-1],255&Ut,Ut>>16,Qe,Pt+($t-1)*ee)))}}function It(){mo[Au]=V_,mo[$u]=Bg,mo[Rg]=j_,mo[Eu]=Vg,mo[Iu]=jg,mo[Kp]=zg,mo[Dg]=z_,mo[Qp]=Bg,mo[Jp]=Vg,mo[Tu]=jg,mo[Xp]=zg}function qt(y){return y&-16384?0>y?0:255:y>>q_}function f(y,C){return qt((19077*y>>8)+(26149*C>>8)-14234)}function ie(y,C,ee){return qt((19077*y>>8)-(6419*C>>8)-(13320*ee>>8)+8708)}function fe(y,C){return qt((19077*y>>8)+(33050*C>>8)-17685)}function Ae(y,C,ee,he,Pe){he[Pe+0]=f(y,ee),he[Pe+1]=ie(y,C,ee),he[Pe+2]=fe(y,C)}function Je(y,C,ee,he,Pe){he[Pe+0]=fe(y,C),he[Pe+1]=ie(y,C,ee),he[Pe+2]=f(y,ee)}function st(y,C,ee,he,Pe){var _e=ie(y,C,ee);C=_e<<3&224|fe(y,C)>>3,he[Pe+0]=248&f(y,ee)|_e>>5,he[Pe+1]=C}function Tt(y,C,ee,he,Pe){var _e=240&fe(y,C)|15;he[Pe+0]=240&f(y,ee)|ie(y,C,ee)>>4,he[Pe+1]=_e}function Pr(y,C,ee,he,Pe){he[Pe+0]=255,Ae(y,C,ee,he,Pe+1)}function Tr(y,C,ee,he,Pe){Je(y,C,ee,he,Pe),he[Pe+3]=255}function _r(y,C,ee,he,Pe){Ae(y,C,ee,he,Pe),he[Pe+3]=255}function Wr(y,C){return 0>y?0:y>C?C:y}function sn(y,C,ee){E[y]=function(he,Pe,_e,xe,$e,Te,De,Ye,it){for(var ot=Ye+(-2&it)*ee;Ye!=ot;)C(he[Pe+0],_e[xe+0],$e[Te+0],De,Ye),C(he[Pe+1],_e[xe+0],$e[Te+0],De,Ye+ee),Pe+=2,++xe,++Te,Ye+=2*ee;1&it&&C(he[Pe+0],_e[xe+0],$e[Te+0],De,Ye)}}function To(y,C,ee){return ee==0?y==0?C==0?6:5:C==0?4:0:ee}function ri(y,C,ee,he,Pe){switch(y>>>30){case 3:_s(C,ee,he,Pe,0);break;case 2:An(C,ee,he,Pe);break;case 1:Ci(C,ee,he,Pe)}}function Yo(y,C){var ee,he,Pe=C.M,_e=C.Nb,xe=y.oc,$e=y.pc+40,Te=y.oc,De=y.pc+584,Ye=y.oc,it=y.pc+600;for(ee=0;16>ee;++ee)xe[$e+32*ee-1]=129;for(ee=0;8>ee;++ee)Te[De+32*ee-1]=129,Ye[it+32*ee-1]=129;for(0<Pe?xe[$e-1-32]=Te[De-1-32]=Ye[it-1-32]=129:(i(xe,$e-32-1,127,21),i(Te,De-32-1,127,9),i(Ye,it-32-1,127,9)),he=0;he<y.za;++he){var ot=C.ya[C.aa+he];if(0<he){for(ee=-1;16>ee;++ee)n(xe,$e+32*ee-4,xe,$e+32*ee+12,4);for(ee=-1;8>ee;++ee)n(Te,De+32*ee-4,Te,De+32*ee+4,4),n(Ye,it+32*ee-4,Ye,it+32*ee+4,4)}var et=y.Gd,St=y.Hd+he,ut=ot.ad,Ke=ot.Hc;if(0<Pe&&(n(xe,$e-32,et[St].y,0,16),n(Te,De-32,et[St].f,0,8),n(Ye,it-32,et[St].ea,0,8)),ot.Za){var Qe=xe,Pt=$e-32+16;for(0<Pe&&(he>=y.za-1?i(Qe,Pt,et[St].y[15],4):n(Qe,Pt,et[St+1].y,0,4)),ee=0;4>ee;ee++)Qe[Pt+128+ee]=Qe[Pt+256+ee]=Qe[Pt+384+ee]=Qe[Pt+0+ee];for(ee=0;16>ee;++ee,Ke<<=2)Qe=xe,Pt=$e+Ug[ee],ko[ot.Ob[ee]](Qe,Pt),ri(Ke,ut,16*+ee,Qe,Pt)}else if(Qe=To(he,Pe,ot.Ob[0]),da[Qe](xe,$e),Ke!=0)for(ee=0;16>ee;++ee,Ke<<=2)ri(Ke,ut,16*+ee,xe,$e+Ug[ee]);for(ee=ot.Gc,Qe=To(he,Pe,ot.Dd),ws[Qe](Te,De),ws[Qe](Ye,it),Ke=ut,Qe=Te,Pt=De,255&(ot=ee>>0)&&(170&ot?td(Ke,256,Qe,Pt):co(Ke,256,Qe,Pt)),ot=Ye,Ke=it,255&(ee>>=8)&&(170&ee?td(ut,320,ot,Ke):co(ut,320,ot,Ke)),Pe<y.Ub-1&&(n(et[St].y,0,xe,$e+480,16),n(et[St].f,0,Te,De+224,8),n(et[St].ea,0,Ye,it+224,8)),ee=8*_e*y.B,et=y.sa,St=y.ta+16*he+16*_e*y.R,ut=y.qa,ot=y.ra+8*he+ee,Ke=y.Ha,Qe=y.Ia+8*he+ee,ee=0;16>ee;++ee)n(et,St+ee*y.R,xe,$e+32*ee,16);for(ee=0;8>ee;++ee)n(ut,ot+ee*y.B,Te,De+32*ee,8),n(Ke,Qe+ee*y.B,Ye,it+32*ee,8)}}function Ko(y,C,ee,he,Pe,_e,xe,$e,Te){var De=[0],Ye=[0],it=0,ot=Te!=null?Te.kd:0,et=Te??new ra;if(y==null||12>ee)return 7;et.data=y,et.w=C,et.ha=ee,C=[C],ee=[ee],et.gb=[et.gb];e:{var St=C,ut=ee,Ke=et.gb;if(e(y!=null),e(ut!=null),e(Ke!=null),Ke[0]=0,12<=ut[0]&&!r(y,St[0],"RIFF")){if(r(y,St[0]+8,"WEBP")){Ke=3;break e}var Qe=oe(y,St[0]+4);if(12>Qe||4294967286<Qe){Ke=3;break e}if(ot&&Qe>ut[0]-8){Ke=7;break e}Ke[0]=Qe,St[0]+=12,ut[0]-=12}Ke=0}if(Ke!=0)return Ke;for(Qe=0<et.gb[0],ee=ee[0];;){e:{var Pt=y;ut=C,Ke=ee;var $t=De,_t=Ye,Qt=St=[0];if((Ut=it=[it])[0]=0,8>Ke[0])Ke=7;else{if(!r(Pt,ut[0],"VP8X")){if(oe(Pt,ut[0]+4)!=10){Ke=3;break e}if(18>Ke[0]){Ke=7;break e}var zt=oe(Pt,ut[0]+8),lr=1+Z(Pt,ut[0]+12);if(2147483648<=lr*(Pt=1+Z(Pt,ut[0]+15))){Ke=3;break e}Qt!=null&&(Qt[0]=zt),$t!=null&&($t[0]=lr),_t!=null&&(_t[0]=Pt),ut[0]+=18,Ke[0]-=18,Ut[0]=1}Ke=0}}if(it=it[0],St=St[0],Ke!=0)return Ke;if(ut=!!(2&St),!Qe&&it)return 3;if(_e!=null&&(_e[0]=!!(16&St)),xe!=null&&(xe[0]=ut),$e!=null&&($e[0]=0),xe=De[0],St=Ye[0],it&&ut&&Te==null){Ke=0;break}if(4>ee){Ke=7;break}if(Qe&&it||!Qe&&!it&&!r(y,C[0],"ALPH")){ee=[ee],et.na=[et.na],et.P=[et.P],et.Sa=[et.Sa];e:{zt=y,Ke=C,Qe=ee;var Ut=et.gb;$t=et.na,_t=et.P,Qt=et.Sa,lr=22,e(zt!=null),e(Qe!=null),Pt=Ke[0];var qr=Qe[0];for(e($t!=null),e(Qt!=null),$t[0]=null,_t[0]=null,Qt[0]=0;;){if(Ke[0]=Pt,Qe[0]=qr,8>qr){Ke=7;break e}var Qr=oe(zt,Pt+4);if(4294967286<Qr){Ke=3;break e}var Or=8+Qr+1&-2;if(lr+=Or,0<Ut&&lr>Ut){Ke=3;break e}if(!r(zt,Pt,"VP8 ")||!r(zt,Pt,"VP8L")){Ke=0;break e}if(qr[0]<Or){Ke=7;break e}r(zt,Pt,"ALPH")||($t[0]=zt,_t[0]=Pt+8,Qt[0]=Qr),Pt+=Or,qr-=Or}}if(ee=ee[0],et.na=et.na[0],et.P=et.P[0],et.Sa=et.Sa[0],Ke!=0)break}ee=[ee],et.Ja=[et.Ja],et.xa=[et.xa];e:if(Ut=y,Ke=C,Qe=ee,$t=et.gb[0],_t=et.Ja,Qt=et.xa,zt=Ke[0],Pt=!r(Ut,zt,"VP8 "),lr=!r(Ut,zt,"VP8L"),e(Ut!=null),e(Qe!=null),e(_t!=null),e(Qt!=null),8>Qe[0])Ke=7;else{if(Pt||lr){if(Ut=oe(Ut,zt+4),12<=$t&&Ut>$t-12){Ke=3;break e}if(ot&&Ut>Qe[0]-8){Ke=7;break e}_t[0]=Ut,Ke[0]+=8,Qe[0]-=8,Qt[0]=lr}else Qt[0]=5<=Qe[0]&&Ut[zt+0]==47&&!(Ut[zt+4]>>5),_t[0]=Qe[0];Ke=0}if(ee=ee[0],et.Ja=et.Ja[0],et.xa=et.xa[0],C=C[0],Ke!=0)break;if(4294967286<et.Ja)return 3;if($e==null||ut||($e[0]=et.xa?2:1),xe=[xe],St=[St],et.xa){if(5>ee){Ke=7;break}$e=xe,ot=St,ut=_e,y==null||5>ee?y=0:5<=ee&&y[C+0]==47&&!(y[C+4]>>5)?(Qe=[0],Ut=[0],$t=[0],J(_t=new O,y,C,ee),mt(_t,Qe,Ut,$t)?($e!=null&&($e[0]=Qe[0]),ot!=null&&(ot[0]=Ut[0]),ut!=null&&(ut[0]=$t[0]),y=1):y=0):y=0}else{if(10>ee){Ke=7;break}$e=St,y==null||10>ee||!Ri(y,C+3,ee-3)?y=0:(ot=y[C+0]|y[C+1]<<8|y[C+2]<<16,ut=16383&(y[C+7]<<8|y[C+6]),y=16383&(y[C+9]<<8|y[C+8]),1&ot||3<(ot>>1&7)||!(ot>>4&1)||ot>>5>=et.Ja||!ut||!y?y=0:(xe&&(xe[0]=ut),$e&&($e[0]=y),y=1))}if(!y||(xe=xe[0],St=St[0],it&&(De[0]!=xe||Ye[0]!=St)))return 3;Te!=null&&(Te[0]=et,Te.offset=C-Te.w,e(4294967286>C-Te.w),e(Te.offset==Te.ha-ee));break}return Ke==0||Ke==7&&it&&Te==null?(_e!=null&&(_e[0]|=et.na!=null&&0<et.na.length),he!=null&&(he[0]=xe),Pe!=null&&(Pe[0]=St),0):Ke}function Jc(y,C,ee){var he=C.width,Pe=C.height,_e=0,xe=0,$e=he,Te=Pe;if(C.Da=y!=null&&0<y.Da,C.Da&&($e=y.cd,Te=y.bd,_e=y.v,xe=y.j,11>ee||(_e&=-2,xe&=-2),0>_e||0>xe||0>=$e||0>=Te||_e+$e>he||xe+Te>Pe))return 0;if(C.v=_e,C.j=xe,C.va=_e+$e,C.o=xe+Te,C.U=$e,C.T=Te,C.da=y!=null&&0<y.da,C.da){if(!ce($e,Te,ee=[y.ib],_e=[y.hb]))return 0;C.ib=ee[0],C.hb=_e[0]}return C.ob=y!=null&&y.ob,C.Kb=y==null||!y.Sd,C.da&&(C.ob=C.ib<3*he/4&&C.hb<3*Pe/4,C.Kb=0),1}function Xc(y){if(y==null)return 2;if(11>y.S){var C=y.f.RGBA;C.fb+=(y.height-1)*C.A,C.A=-C.A}else C=y.f.kb,y=y.height,C.O+=(y-1)*C.fa,C.fa=-C.fa,C.N+=(y-1>>1)*C.Ab,C.Ab=-C.Ab,C.W+=(y-1>>1)*C.Db,C.Db=-C.Db,C.F!=null&&(C.J+=(y-1)*C.lb,C.lb=-C.lb);return 0}function Hl(y,C,ee,he){if(he==null||0>=y||0>=C)return 2;if(ee!=null){if(ee.Da){var Pe=ee.cd,_e=ee.bd,xe=-2&ee.v,$e=-2&ee.j;if(0>xe||0>$e||0>=Pe||0>=_e||xe+Pe>y||$e+_e>C)return 2;y=Pe,C=_e}if(ee.da){if(!ce(y,C,Pe=[ee.ib],_e=[ee.hb]))return 2;y=Pe[0],C=_e[0]}}he.width=y,he.height=C;e:{var Te=he.width,De=he.height;if(y=he.S,0>=Te||0>=De||!(y>=Au&&13>y))y=2;else{if(0>=he.Rd&&he.sd==null){xe=_e=Pe=C=0;var Ye=($e=Te*Hg[y])*De;if(11>y||(_e=(De+1)/2*(C=(Te+1)/2),y==12&&(xe=(Pe=Te)*De)),(De=o(Ye+2*_e+xe))==null){y=1;break e}he.sd=De,11>y?((Te=he.f.RGBA).eb=De,Te.fb=0,Te.A=$e,Te.size=Ye):((Te=he.f.kb).y=De,Te.O=0,Te.fa=$e,Te.Fd=Ye,Te.f=De,Te.N=0+Ye,Te.Ab=C,Te.Cd=_e,Te.ea=De,Te.W=0+Ye+_e,Te.Db=C,Te.Ed=_e,y==12&&(Te.F=De,Te.J=0+Ye+2*_e),Te.Tc=xe,Te.lb=Pe)}if(C=1,Pe=he.S,_e=he.width,xe=he.height,Pe>=Au&&13>Pe)if(11>Pe)y=he.f.RGBA,C&=($e=Math.abs(y.A))*(xe-1)+_e<=y.size,C&=$e>=_e*Hg[Pe],C&=y.eb!=null;else{y=he.f.kb,$e=(_e+1)/2,Ye=(xe+1)/2,Te=Math.abs(y.fa),De=Math.abs(y.Ab);var it=Math.abs(y.Db),ot=Math.abs(y.lb),et=ot*(xe-1)+_e;C&=Te*(xe-1)+_e<=y.Fd,C&=De*(Ye-1)+$e<=y.Cd,C=(C&=it*(Ye-1)+$e<=y.Ed)&Te>=_e&De>=$e&it>=$e,C&=y.y!=null,C&=y.f!=null,C&=y.ea!=null,Pe==12&&(C&=ot>=_e,C&=et<=y.Tc,C&=y.F!=null)}else C=0;y=C?0:2}}return y!=0||ee!=null&&ee.fd&&(y=Xc(he)),y}var ni=64,Gl=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Wl=24,Yl=32,Zc=8,Mi=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ye("Predictor0","PredictorAdd0"),E.Predictor0=function(){return 4278190080},E.Predictor1=function(y){return y},E.Predictor2=function(y,C,ee){return C[ee+0]},E.Predictor3=function(y,C,ee){return C[ee+1]},E.Predictor4=function(y,C,ee){return C[ee-1]},E.Predictor5=function(y,C,ee){return pe(pe(y,C[ee+1]),C[ee+0])},E.Predictor6=function(y,C,ee){return pe(y,C[ee-1])},E.Predictor7=function(y,C,ee){return pe(y,C[ee+0])},E.Predictor8=function(y,C,ee){return pe(C[ee-1],C[ee+0])},E.Predictor9=function(y,C,ee){return pe(C[ee+0],C[ee+1])},E.Predictor10=function(y,C,ee){return pe(pe(y,C[ee-1]),pe(C[ee+0],C[ee+1]))},E.Predictor11=function(y,C,ee){var he=C[ee+0];return 0>=Ie(he>>24&255,y>>24&255,(C=C[ee-1])>>24&255)+Ie(he>>16&255,y>>16&255,C>>16&255)+Ie(he>>8&255,y>>8&255,C>>8&255)+Ie(255&he,255&y,255&C)?he:y},E.Predictor12=function(y,C,ee){var he=C[ee+0];return(ve((y>>24&255)+(he>>24&255)-((C=C[ee-1])>>24&255))<<24|ve((y>>16&255)+(he>>16&255)-(C>>16&255))<<16|ve((y>>8&255)+(he>>8&255)-(C>>8&255))<<8|ve((255&y)+(255&he)-(255&C)))>>>0},E.Predictor13=function(y,C,ee){var he=C[ee-1];return(Ne((y=pe(y,C[ee+0]))>>24&255,he>>24&255)<<24|Ne(y>>16&255,he>>16&255)<<16|Ne(y>>8&255,he>>8&255)<<8|Ne(y>>0&255,he>>0&255))>>>0};var Wp=E.PredictorAdd0;E.PredictorAdd1=Ce,ye("Predictor2","PredictorAdd2"),ye("Predictor3","PredictorAdd3"),ye("Predictor4","PredictorAdd4"),ye("Predictor5","PredictorAdd5"),ye("Predictor6","PredictorAdd6"),ye("Predictor7","PredictorAdd7"),ye("Predictor8","PredictorAdd8"),ye("Predictor9","PredictorAdd9"),ye("Predictor10","PredictorAdd10"),ye("Predictor11","PredictorAdd11"),ye("Predictor12","PredictorAdd12"),ye("Predictor13","PredictorAdd13");var ed=E.PredictorAdd2;He("ColorIndexInverseTransform","MapARGB","32b",function(y){return y>>8&255},function(y){return y}),He("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(y){return y},function(y){return y>>8&255});var Pu,lo=E.ColorIndexInverseTransform,Kl=E.MapARGB,_u=E.VP8LColorIndexInverseTransformAlpha,Su=E.MapAlpha,sa=E.VP8LPredictorsAdd=[];sa.length=16,(E.VP8LPredictors=[]).length=16,(E.VP8LPredictorsAdd_C=[]).length=16,(E.VP8LPredictors_C=[]).length=16;var rl,Fi,xi,aa,bs,Ps,Ql,_s,An,td,Ci,co,Jl,wu,rd,nl,il,la,ol,Xl,sl,ca,nd,uo,ho,hn,pn,$n,jn=o(511),Ss=o(2041),id=o(225),Zl=o(767),xu=0,Yp=Ss,Cu=id,Ji=Zl,po=jn,Au=0,$u=1,Rg=2,Eu=3,Iu=4,Kp=5,Dg=6,Qp=7,Jp=8,Tu=9,Xp=10,A_=[2,3,7],$_=[3,3,11],Mg=[280,256,256,256,40],E_=[0,1,1,1,0],I_=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],T_=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],k_=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],N_=8,Zp=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],em=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],od=null,L_=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],R_=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Fg=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],D_=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],M_=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],F_=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],O_=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],da=[],ko=[],ws=[],B_=1,Og=2,ua=[],mo=[];ht("UpsampleRgbLinePair",Ae,3),ht("UpsampleBgrLinePair",Je,3),ht("UpsampleRgbaLinePair",_r,4),ht("UpsampleBgraLinePair",Tr,4),ht("UpsampleArgbLinePair",Pr,4),ht("UpsampleRgba4444LinePair",Tt,2),ht("UpsampleRgb565LinePair",st,2);var V_=E.UpsampleRgbLinePair,j_=E.UpsampleBgrLinePair,Bg=E.UpsampleRgbaLinePair,Vg=E.UpsampleBgraLinePair,jg=E.UpsampleArgbLinePair,zg=E.UpsampleRgba4444LinePair,z_=E.UpsampleRgb565LinePair,ku=16,Nu=1<<ku-1,sd=-227,tm=482,q_=6,qg=0,U_=o(256),H_=o(256),G_=o(256),W_=o(256),Y_=o(tm-sd),K_=o(tm-sd);sn("YuvToRgbRow",Ae,3),sn("YuvToBgrRow",Je,3),sn("YuvToRgbaRow",_r,4),sn("YuvToBgraRow",Tr,4),sn("YuvToArgbRow",Pr,4),sn("YuvToRgba4444Row",Tt,2),sn("YuvToRgb565Row",st,2);var Ug=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Lu=[0,2,8],Q_=[8,7,6,4,4,2,2,2,1,1,1,1],J_=1;this.WebPDecodeRGBA=function(y,C,ee,he,Pe){var _e=$u,xe=new gs,$e=new Xe;xe.ba=$e,$e.S=_e,$e.width=[$e.width],$e.height=[$e.height];var Te=$e.width,De=$e.height,Ye=new Ct;if(Ye==null||y==null)var it=2;else e(Ye!=null),it=Ko(y,C,ee,Ye.width,Ye.height,Ye.Pd,Ye.Qd,Ye.format,null);if(it!=0?Te=0:(Te!=null&&(Te[0]=Ye.width[0]),De!=null&&(De[0]=Ye.height[0]),Te=1),Te){$e.width=$e.width[0],$e.height=$e.height[0],he!=null&&(he[0]=$e.width),Pe!=null&&(Pe[0]=$e.height);e:{if(he=new Wn,(Pe=new ra).data=y,Pe.w=C,Pe.ha=ee,Pe.kd=1,C=[0],e(Pe!=null),((y=Ko(Pe.data,Pe.w,Pe.ha,null,null,null,C,null,Pe))==0||y==7)&&C[0]&&(y=4),(C=y)==0){if(e(xe!=null),he.data=Pe.data,he.w=Pe.w+Pe.offset,he.ha=Pe.ha-Pe.offset,he.put=Ot,he.ac=Et,he.bc=jt,he.ma=xe,Pe.xa){if((y=Yt())==null){xe=1;break e}if(function(ot,et){var St=[0],ut=[0],Ke=[0];t:for(;;){if(ot==null)return 0;if(et==null)return ot.a=2,0;if(ot.l=et,ot.a=0,J(ot.m,et.data,et.w,et.ha),!mt(ot.m,St,ut,Ke)){ot.a=3;break t}if(ot.xb=Og,et.width=St[0],et.height=ut[0],!nr(St[0],ut[0],1,ot,null))break t;return 1}return e(ot.a!=0),0}(y,he)){if(he=(C=Hl(he.width,he.height,xe.Oa,xe.ba))==0){t:{he=y;r:for(;;){if(he==null){he=0;break t}if(e(he.s.yc!=null),e(he.s.Ya!=null),e(0<he.s.Wb),e((ee=he.l)!=null),e((Pe=ee.ma)!=null),he.xb!=0){if(he.ca=Pe.ba,he.tb=Pe.tb,e(he.ca!=null),!Jc(Pe.Oa,ee,Eu)){he.a=2;break r}if(!Dr(he,ee.width)||ee.da)break r;if((ee.da||Fe(he.ca.S))&&Ze(),11>he.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),he.ca.f.kb.F!=null&&Ze()),he.Pb&&0<he.s.ua&&he.s.vb.X==null&&!de(he.s.vb,he.s.Wa.Xa)){he.a=1;break r}he.xb=0}if(!At(he,he.V,he.Ba,he.c,he.i,ee.o,ze))break r;Pe.Dc=he.Ma,he=1;break t}e(he.a!=0),he=0}he=!he}he&&(C=y.a)}else C=y.a}else{if((y=new so)==null){xe=1;break e}if(y.Fa=Pe.na,y.P=Pe.P,y.qc=Pe.Sa,Po(y,he)){if((C=Hl(he.width,he.height,xe.Oa,xe.ba))==0){if(y.Aa=0,ee=xe.Oa,e((Pe=y)!=null),ee!=null){if(0<(Te=0>(Te=ee.Md)?0:100<Te?255:255*Te/100)){for(De=Ye=0;4>De;++De)12>(it=Pe.pb[De]).lc&&(it.ia=Te*Q_[0>it.lc?0:it.lc]>>3),Ye|=it.ia;Ye&&(alert("todo:VP8InitRandom"),Pe.ia=1)}Pe.Ga=ee.Id,100<Pe.Ga?Pe.Ga=100:0>Pe.Ga&&(Pe.Ga=0)}jr(y,he)||(C=y.a)}}else C=y.a}C==0&&xe.Oa!=null&&xe.Oa.fd&&(C=Xc(xe.ba))}xe=C}_e=xe!=0?null:11>_e?$e.f.RGBA.eb:$e.f.kb.y}else _e=null;return _e};var Hg=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(E,L){for(var M="",P=0;P<4;P++)M+=String.fromCharCode(E[L++]);return M}function u(E,L){return(E[L+0]<<0|E[L+1]<<8|E[L+2]<<16)>>>0}function h(E,L){return(E[L+0]<<0|E[L+1]<<8|E[L+2]<<16|E[L+3]<<24)>>>0}new c;var g=[0],m=[0],S=[],N=new c,x=t,b=function(E,L){var M={},P=0,w=!1,v=0,j=0;if(M.frames=[],!function(_,k,$,G){for(var ne=0;ne<G;ne++)if(_[k+ne]!=$.charCodeAt(ne))return!0;return!1}(E,L,"RIFF",4)){for(h(E,L+=4),L+=8;L<E.length;){var z=d(E,L),T=h(E,L+=4);L+=4;var R=T+(1&T);switch(z){case"VP8 ":case"VP8L":M.frames[P]===void 0&&(M.frames[P]={}),(H=M.frames[P]).src_off=w?j:L-8,H.src_size=v+T+8,P++,w&&(w=!1,v=0,j=0);break;case"VP8X":(H=M.header={}).feature_flags=E[L];var J=L+4;H.canvas_width=1+u(E,J),J+=3,H.canvas_height=1+u(E,J),J+=3;break;case"ALPH":w=!0,v=R+8,j=L-8;break;case"ANIM":(H=M.header).bgcolor=h(E,L),J=L+4,H.loop_count=(se=E)[(O=J)+0]<<0|se[O+1]<<8,J+=2;break;case"ANMF":var X,H;(H=M.frames[P]={}).offset_x=2*u(E,L),L+=3,H.offset_y=2*u(E,L),L+=3,H.width=1+u(E,L),L+=3,H.height=1+u(E,L),L+=3,H.duration=u(E,L),L+=3,X=E[L++],H.dispose=1&X,H.blend=X>>1&1}z!="ANMF"&&(L+=R)}var se,O;return M}}(x,0);b.response=x,b.rgbaoutput=!0,b.dataurl=!1;var K=b.header?b.header:null,te=b.frames?b.frames:null;if(K){K.loop_counter=K.loop_count,g=[K.canvas_height],m=[K.canvas_width];for(var F=0;F<te.length&&te[F].blend!=0;F++);}var V=te[0],W=N.WebPDecodeRGBA(x,V.src_off,V.src_size,m,g);V.rgba=W,V.imgwidth=m[0],V.imgheight=g[0];for(var I=0;I<m[0]*g[0]*4;I++)S[I]=W[I];return this.width=m,this.height=g,this.data=S,this}(function(t){var e=function(){return typeof of=="function"},r=function(g,m,S,N){var x=4,b=s;switch(N){case t.image_compression.FAST:x=1,b=o;break;case t.image_compression.MEDIUM:x=6,b=l;break;case t.image_compression.SLOW:x=9,b=c}g=n(g,m,S,b);var K=of(g,{level:x});return t.__addimage__.arrayBufferToBinaryString(K)},n=function(g,m,S,N){for(var x,b,K,te=g.length/m,F=new Uint8Array(g.length+te),V=u(),W=0;W<te;W+=1){if(K=W*m,x=g.subarray(K,K+m),N)F.set(N(x,S,b),K+W);else{for(var I,E=V.length,L=[];I<E;I+=1)L[I]=V[I](x,S,b);var M=h(L.concat());F.set(L[M],K+W)}b=x}return F},i=function(g){var m=Array.apply([],g);return m.unshift(0),m},o=function(g,m){var S,N=[],x=g.length;N[0]=1;for(var b=0;b<x;b+=1)S=g[b-m]||0,N[b+1]=g[b]-S+256&255;return N},s=function(g,m,S){var N,x=[],b=g.length;x[0]=2;for(var K=0;K<b;K+=1)N=S&&S[K]||0,x[K+1]=g[K]-N+256&255;return x},l=function(g,m,S){var N,x,b=[],K=g.length;b[0]=3;for(var te=0;te<K;te+=1)N=g[te-m]||0,x=S&&S[te]||0,b[te+1]=g[te]+256-(N+x>>>1)&255;return b},c=function(g,m,S){var N,x,b,K,te=[],F=g.length;te[0]=4;for(var V=0;V<F;V+=1)N=g[V-m]||0,x=S&&S[V]||0,b=S&&S[V-m]||0,K=d(N,x,b),te[V+1]=g[V]-K+256&255;return te},d=function(g,m,S){if(g===m&&m===S)return g;var N=Math.abs(m-S),x=Math.abs(g-S),b=Math.abs(g+m-S-S);return N<=x&&N<=b?g:x<=b?m:S},u=function(){return[i,o,s,l,c]},h=function(g){var m=g.map(function(S){return S.reduce(function(N,x){return N+Math.abs(x)},0)});return m.indexOf(Math.min.apply(null,m))};t.processPNG=function(g,m,S,N){var x,b,K,te,F,V,W,I,E,L,M,P,w,v,j,z=this.decode.FLATE_DECODE,T="";if(this.__addimage__.isArrayBuffer(g)&&(g=new Uint8Array(g)),this.__addimage__.isArrayBufferView(g)){if(g=(K=new n8(g)).imgData,b=K.bits,x=K.colorSpace,F=K.colors,[4,6].indexOf(K.colorType)!==-1){if(K.bits===8){E=(I=K.pixelBitlength==32?new Uint32Array(K.decodePixels().buffer):K.pixelBitlength==16?new Uint16Array(K.decodePixels().buffer):new Uint8Array(K.decodePixels().buffer)).length,M=new Uint8Array(E*K.colors),L=new Uint8Array(E);var R,J=K.pixelBitlength-K.bits;for(v=0,j=0;v<E;v++){for(w=I[v],R=0;R<J;)M[j++]=w>>>R&255,R+=K.bits;L[v]=w>>>R&255}}if(K.bits===16){E=(I=new Uint32Array(K.decodePixels().buffer)).length,M=new Uint8Array(E*(32/K.pixelBitlength)*K.colors),L=new Uint8Array(E*(32/K.pixelBitlength)),P=K.colors>1,v=0,j=0;for(var X=0;v<E;)w=I[v++],M[j++]=w>>>0&255,P&&(M[j++]=w>>>16&255,w=I[v++],M[j++]=w>>>0&255),L[X++]=w>>>16&255;b=8}N!==t.image_compression.NONE&&e()?(g=r(M,K.width*K.colors,K.colors,N),W=r(L,K.width,1,N)):(g=M,W=L,z=void 0)}if(K.colorType===3&&(x=this.color_spaces.INDEXED,V=K.palette,K.transparency.indexed)){var H=K.transparency.indexed,se=0;for(v=0,E=H.length;v<E;++v)se+=H[v];if((se/=255)===E-1&&H.indexOf(0)!==-1)te=[H.indexOf(0)];else if(se!==E){for(I=K.decodePixels(),L=new Uint8Array(I.length),v=0,E=I.length;v<E;v++)L[v]=H[I[v]];W=r(L,K.width,1)}}var O=function(_){var k;switch(_){case t.image_compression.FAST:k=11;break;case t.image_compression.MEDIUM:k=13;break;case t.image_compression.SLOW:k=14;break;default:k=12}return k}(N);return z===this.decode.FLATE_DECODE&&(T="/Predictor "+O+" "),T+="/Colors "+F+" /BitsPerComponent "+b+" /Columns "+K.width,(this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g))&&(g=this.__addimage__.arrayBufferToBinaryString(g)),(W&&this.__addimage__.isArrayBuffer(W)||this.__addimage__.isArrayBufferView(W))&&(W=this.__addimage__.arrayBufferToBinaryString(W)),{alias:S,data:g,index:m,filter:z,decodeParameters:T,transparency:te,palette:V,sMask:W,predictor:O,width:K.width,height:K.height,bitsPerComponent:b,colorSpace:x}}}})(cr.API),function(t){t.processGIF89A=function(e,r,n,i){var o=new i8(e),s=o.width,l=o.height,c=[];o.decodeAndBlitFrameRGBA(0,c);var d={data:c,width:s,height:l},u=new iy(100).encode(d,100);return t.processJPEG.call(this,u,r,n,i)},t.processGIF87A=t.processGIF89A}(cr.API),Ro.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:n,blue:r,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Ro.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){ln.log("bit decode error:"+r)}},Ro.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var o=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*i*4,l=0;l<8&&8*i+l<this.width;l++){var c=this.palette[o>>7-l&1];this.data[s+4*l]=c.blue,this.data[s+4*l+1]=c.green,this.data[s+4*l+2]=c.red,this.data[s+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Ro.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<t;i++){var o=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*i*4,l=o>>4,c=15&o,d=this.palette[l];if(this.data[s]=d.blue,this.data[s+1]=d.green,this.data[s+2]=d.red,this.data[s+3]=255,2*i+1>=this.width)break;d=this.palette[c],this.data[s+4]=d.blue,this.data[s+4+1]=d.green,this.data[s+4+2]=d.red,this.data[s+4+3]=255}e!==0&&(this.pos+=4-e)}},Ro.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+4*n;if(i<this.palette.length){var s=this.palette[i];this.data[o]=s.red,this.data[o+1]=s.green,this.data[o+2]=s.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}t!==0&&(this.pos+=4-t)}},Ro.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(o&e)/e*255|0,l=(o>>5&e)/e*255|0,c=(o>>10&e)/e*255|0,d=o>>15?255:0,u=n*this.width*4+4*i;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=s,this.data[u+3]=d}this.pos+=t}},Ro.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(s&e)/e*255|0,c=(s>>5&r)/r*255|0,d=(s>>11)/e*255|0,u=i*this.width*4+4*o;this.data[u]=d,this.data[u+1]=c,this.data[u+2]=l,this.data[u+3]=255}this.pos+=t}},Ro.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*r;this.data[s]=o,this.data[s+1]=i,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},Ro.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=o,this.data[l+1]=i,this.data[l+2]=n,this.data[l+3]=s}},Ro.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,r,n,i){var o=new Ro(e,!1),s=o.width,l=o.height,c={data:o.getData(),width:s,height:l},d=new iy(100).encode(c,100);return t.processJPEG.call(this,d,r,n,i)}}(cr.API),B1.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,r,n,i){var o=new B1(e),s=o.width,l=o.height,c={data:o.getData(),width:s,height:l},d=new iy(100).encode(c,100);return t.processJPEG.call(this,d,r,n,i)}}(cr.API),cr.API.processRGBA=function(t,e,r){for(var n=t.data,i=n.length,o=new Uint8Array(i/4*3),s=new Uint8Array(i/4),l=0,c=0,d=0;d<i;d+=4){var u=n[d],h=n[d+1],g=n[d+2],m=n[d+3];o[l++]=u,o[l++]=h,o[l++]=g,s[c++]=m}var S=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:S,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},cr.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},cc=cr.API,hh=cc.getCharWidthsArray=function(t,e){var r,n,i=(e=e||{}).font||this.internal.getFont(),o=e.fontSize||this.internal.getFontSize(),s=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:i.metadata.Unicode.widths,c=l.fof?l.fof:1,d=e.kerning?e.kerning:i.metadata.Unicode.kerning,u=d.fof?d.fof:1,h=e.doKerning!==!1,g=0,m=t.length,S=0,N=l[0]||c,x=[];for(r=0;r<m;r++)n=t.charCodeAt(r),typeof i.metadata.widthOfString=="function"?x.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+s*(1e3/o)||0)/1e3):(g=h&&tn(d[n])==="object"&&!isNaN(parseInt(d[n][S],10))?d[n][S]/u:0,x.push((l[n]||N)/c+g)),S=n;return x},D1=cc.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return cc.processArabic&&(t=cc.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,i)/r:hh.apply(this,arguments).reduce(function(o,s){return o+s},0)},M1=function(t,e,r,n){for(var i=[],o=0,s=t.length,l=0;o!==s&&l+e[o]<r;)l+=e[o],o++;i.push(t.slice(0,o));var c=o;for(l=0;o!==s;)l+e[o]>n&&(i.push(t.slice(c,o)),l=0,c=o),l+=e[o],o++;return c!==o&&i.push(t.slice(c,o)),i},F1=function(t,e,r){r||(r={});var n,i,o,s,l,c,d,u=[],h=[u],g=r.textIndent||0,m=0,S=0,N=t.split(" "),x=hh.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?N[0].length+2:r.lineIndent||0){var b=Array(c).join(" "),K=[];N.map(function(F){(F=F.split(/\s*\n/)).length>1?K=K.concat(F.map(function(V,W){return(W&&V.length?`
`:"")+V})):K.push(F[0])}),N=K,c=D1.apply(this,[b,r])}for(o=0,s=N.length;o<s;o++){var te=0;if(n=N[o],c&&n[0]==`
`&&(n=n.substr(1),te=1),g+m+(S=(i=hh.apply(this,[n,r])).reduce(function(F,V){return F+V},0))>e||te){if(S>e){for(l=M1.apply(this,[n,i,e-(g+m),e]),u.push(l.shift()),u=[l.pop()];l.length;)h.push([l.shift()]);S=i.slice(n.length-(u[0]?u[0].length:0)).reduce(function(F,V){return F+V},0)}else u=[n];h.push(u),g=S+c,m=x}else u.push(n),g+=m+S,m=x}return d=c?function(F,V){return(V?b:"")+F.join(" ")}:function(F){return F.join(" ")},h.map(d)},cc.splitTextToSize=function(t,e,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),o=function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var h=this.internal.getFont(u.fontName,u.fontStyle);return h.metadata.Unicode?{widths:h.metadata.Unicode.widths||{0:1},kerning:h.metadata.Unicode.kerning||{}}:{font:h.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var s=1*this.internal.scaleFactor*e/i;o.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,o.lineIndent=r.lineIndent;var l,c,d=[];for(l=0,c=n.length;l<c;l++)d=d.concat(F1.apply(this,[n[l],s,o]));return d},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",r={},n={},i=0;i<e.length;i++)r[e[i]]="0123456789abcdef"[i],n["0123456789abcdef"[i]]=e[i];var o=function(h){return"0x"+parseInt(h,10).toString(16)},s=t.__fontmetrics__.compress=function(h){var g,m,S,N,x=["{"];for(var b in h){if(g=h[b],isNaN(parseInt(b,10))?m="'"+b+"'":(b=parseInt(b,10),m=(m=o(b).slice(2)).slice(0,-1)+n[m.slice(-1)]),typeof g=="number")g<0?(S=o(g).slice(3),N="-"):(S=o(g).slice(2),N=""),S=N+S.slice(0,-1)+n[S.slice(-1)];else{if(tn(g)!=="object")throw new Error("Don't know what to do with value type "+tn(g)+".");S=s(g)}x.push(m+S)}return x.push("}"),x.join("")},l=t.__fontmetrics__.uncompress=function(h){if(typeof h!="string")throw new Error("Invalid argument passed to uncompress.");for(var g,m,S,N,x={},b=1,K=x,te=[],F="",V="",W=h.length-1,I=1;I<W;I+=1)(N=h[I])=="'"?g?(S=g.join(""),g=void 0):g=[]:g?g.push(N):N=="{"?(te.push([K,S]),K={},S=void 0):N=="}"?((m=te.pop())[0][m[1]]=K,S=void 0,K=m[0]):N=="-"?b=-1:S===void 0?r.hasOwnProperty(N)?(F+=r[N],S=parseInt(F,16)*b,b=1,F=""):F+=N:r.hasOwnProperty(N)?(V+=r[N],K[S]=parseInt(V,16)*b,b=1,S=void 0,V=""):V+=N;return x},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},u={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(h){var g=h.font,m=u.Unicode[g.postScriptName];m&&(g.metadata.Unicode={},g.metadata.Unicode.widths=m.widths,g.metadata.Unicode.kerning=m.kerning);var S=d.Unicode[g.postScriptName];S&&(g.metadata.Unicode.encoding=S,g.encoding=S.codePages[0])}])}(cr.API),function(t){var e=function(r){for(var n=r.length,i=new Uint8Array(n),o=0;o<n;o++)i[o]=r.charCodeAt(o);return i};t.API.events.push(["addFont",function(r){var n=void 0,i=r.font,o=r.instance;if(!i.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=o.existsFileInVFS(i.postScriptName)===!1?o.loadFile(i.postScriptName):o.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(s,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(Od(l)),s.metadata=t.API.TTFFont.open(l),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(i,n)}}])}(cr),function(t){function e(){return(ur.canvg?Promise.resolve(ur.canvg):no(()=>import("./index.es-bgQx8sWk.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}cr.API.addSvgAsImage=function(r,n,i,o,s,l,c,d){if(isNaN(n)||isNaN(i))throw ln.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(o)||isNaN(s))throw ln.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=o,u.height=s;var h=u.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,u.width,u.height);var g={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},m=this;return e().then(function(S){return S.fromString(h,r,g)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(S){return S.render(g)}).then(function(){m.addImage(u.toDataURL("image/jpeg",1),n,i,o,s,c,d)})}}(),cr.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(e,r);return this},cr.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,i,o,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(s),c=[],d=0,u=0,h=0;function g(S,N){var x,b=!1;for(x=0;x<S.length;x+=1)S[x]===N&&(b=!0);return b}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var m=l.length;for(h=0;h<m;h+=1)r[l[h]].value=r[l[h]].defaultValue,r[l[h]].explicitSet=!1}if(tn(t)==="object"){for(i in t)if(o=t[i],g(l,i)&&o!==void 0){if(r[i].type==="boolean"&&typeof o=="boolean")r[i].value=o;else if(r[i].type==="name"&&g(r[i].valueSet,o))r[i].value=o;else if(r[i].type==="integer"&&Number.isInteger(o))r[i].value=o;else if(r[i].type==="array"){for(d=0;d<o.length;d+=1)if(n=!0,o[d].length===1&&typeof o[d][0]=="number")c.push(String(o[d]-1));else if(o[d].length>1){for(u=0;u<o[d].length;u+=1)typeof o[d][u]!="number"&&(n=!1);n===!0&&c.push([o[d][0]-1,o[d][1]-1].join(" "))}r[i].value="["+c.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var S,N=[];for(S in r)r[S].explicitSet===!0&&(r[S].type==="name"?N.push("/"+S+" /"+r[S].value):N.push("/"+S+" "+r[S].value));N.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+N.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),d=o.length+s.length+l.length+i.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(i+o+s+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}(cr.API),function(t){var e=t.API,r=e.pdfEscape16=function(o,s){for(var l,c=s.metadata.Unicode.widths,d=["","0","00","000","0000"],u=[""],h=0,g=o.length;h<g;++h){if(l=s.metadata.characterToGlyph(o.charCodeAt(h)),s.metadata.glyIdsUsed.push(l),s.metadata.toUnicode[l]=o.charCodeAt(h),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(s.metadata.widthOfGlyph(l),10)])),l=="0")return u.join("");l=l.toString(16),u.push(d[4-l.length],l)}return u.join("")},n=function(o){var s,l,c,d,u,h,g;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],h=0,g=(l=Object.keys(o).sort(function(m,S){return m-S})).length;h<g;h++)s=l[h],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),o[s]!==void 0&&o[s]!==null&&typeof o[s].toString=="function"&&(d=("0000"+o[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),c.push("<"+s+"><"+d+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(o){(function(s){var l=s.font,c=s.out,d=s.newObject,u=s.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var h=l.metadata.Unicode.widths,g=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),m="",S=0;S<g.length;S++)m+=String.fromCharCode(g[S]);var N=d();u({data:m,addLength1:!0,objectId:N}),c("endobj");var x=d();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:x}),c("endobj");var b=d();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+vc(l.fontName)),c("/FontFile2 "+N+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var K=d();c("<<"),c("/Type /Font"),c("/BaseFont /"+vc(l.fontName)),c("/FontDescriptor "+b+" 0 R"),c("/W "+t.API.PDFObject.convert(h)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=d(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+x+" 0 R"),c("/BaseFont /"+vc(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+K+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(o)}]),e.events.push(["putFont",function(o){(function(s){var l=s.font,c=s.out,d=s.newObject,u=s.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var h=l.metadata.rawData,g="",m=0;m<h.length;m++)g+=String.fromCharCode(h[m]);var S=d();u({data:g,addLength1:!0,objectId:S}),c("endobj");var N=d();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:N}),c("endobj");var x=d();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+S+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+vc(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=d();for(var b=0;b<l.metadata.hmtx.widths.length;b++)l.metadata.hmtx.widths[b]=parseInt(l.metadata.hmtx.widths[b]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+N+" 0 R/BaseFont/"+vc(l.fontName)+"/FontDescriptor "+x+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(o)}]);var i=function(o){var s,l=o.text||"",c=o.x,d=o.y,u=o.options||{},h=o.mutex||{},g=h.pdfEscape,m=h.activeFontKey,S=h.fonts,N=m,x="",b=0,K="",te=S[N].encoding;if(S[N].encoding!=="Identity-H")return{text:l,x:c,y:d,options:u,mutex:h};for(K=l,N=m,Array.isArray(l)&&(K=l[0]),b=0;b<K.length;b+=1)S[N].metadata.hasOwnProperty("cmap")&&(s=S[N].metadata.cmap.unicode.codeMap[K[b].charCodeAt(0)]),s||K[b].charCodeAt(0)<256&&S[N].metadata.hasOwnProperty("Unicode")?x+=K[b]:x+="";var F="";return parseInt(N.slice(1))<14||te==="WinAnsiEncoding"?F=g(x,N).split("").map(function(V){return V.charCodeAt(0).toString(16)}).join(""):te==="Identity-H"&&(F=r(x,S[N])),h.isHex=!0,{text:F,x:c,y:d,options:u,mutex:h}};e.events.push(["postProcessText",function(o){var s=o.text||"",l=[],c={text:s,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(s)){var d=0;for(d=0;d<s.length;d+=1)Array.isArray(s[d])&&s[d].length===3?l.push([i(Object.assign({},c,{text:s[d][0]})).text,s[d][1],s[d][2]]):l.push(i(Object.assign({},c,{text:s[d]})).text);o.text=l}else o.text=i(Object.assign({},c,{text:s})).text}])}(cr),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(cr.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var i,o,s,l,c,d,u,h=e,g=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],S={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},N={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},x=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],b=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),K=!1,te=0;this.__bidiEngine__={};var F=function(P){var w=P.charCodeAt(),v=w>>8,j=N[v];return j!==void 0?h[256*j+(255&w)]:v===252||v===253?"AL":b.test(v)?"L":v===8?"R":"N"},V=function(P){for(var w,v=0;v<P.length;v++){if((w=F(P.charAt(v)))==="L")return!1;if(w==="R")return!0}return!1},W=function(P,w,v,j){var z,T,R,J,X=w[j];switch(X){case"L":case"R":K=!1;break;case"N":case"AN":break;case"EN":K&&(X="AN");break;case"AL":K=!0,X="R";break;case"WS":X="N";break;case"CS":j<1||j+1>=w.length||(z=v[j-1])!=="EN"&&z!=="AN"||(T=w[j+1])!=="EN"&&T!=="AN"?X="N":K&&(T="AN"),X=T===z?T:"N";break;case"ES":X=(z=j>0?v[j-1]:"B")==="EN"&&j+1<w.length&&w[j+1]==="EN"?"EN":"N";break;case"ET":if(j>0&&v[j-1]==="EN"){X="EN";break}if(K){X="N";break}for(R=j+1,J=w.length;R<J&&w[R]==="ET";)R++;X=R<J&&w[R]==="EN"?"EN":"N";break;case"NSM":if(s&&!l){for(J=w.length,R=j+1;R<J&&w[R]==="NSM";)R++;if(R<J){var H=P[j],se=H>=1425&&H<=2303||H===64286;if(z=w[R],se&&(z==="R"||z==="AL")){X="R";break}}}X=j<1||(z=w[j-1])==="B"?"N":v[j-1];break;case"B":K=!1,i=!0,X=te;break;case"S":o=!0,X="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":K=!1;break;case"BN":X="N"}return X},I=function(P,w,v){var j=P.split("");return v&&E(j,v,{hiLevel:te}),j.reverse(),w&&w.reverse(),j.join("")},E=function(P,w,v){var j,z,T,R,J,X=-1,H=P.length,se=0,O=[],_=te?m:g,k=[];for(K=!1,i=!1,o=!1,z=0;z<H;z++)k[z]=F(P[z]);for(T=0;T<H;T++){if(J=se,O[T]=W(P,k,O,T),j=240&(se=_[J][S[O[T]]]),se&=15,w[T]=R=_[se][5],j>0)if(j===16){for(z=X;z<T;z++)w[z]=1;X=-1}else X=-1;if(_[se][6])X===-1&&(X=T);else if(X>-1){for(z=X;z<T;z++)w[z]=R;X=-1}k[T]==="B"&&(w[T]=0),v.hiLevel|=R}o&&function($,G,ne){for(var U=0;U<ne;U++)if($[U]==="S"){G[U]=te;for(var D=U-1;D>=0&&$[D]==="WS";D--)G[D]=te}}(k,w,H)},L=function(P,w,v,j,z){if(!(z.hiLevel<P)){if(P===1&&te===1&&!i)return w.reverse(),void(v&&v.reverse());for(var T,R,J,X,H=w.length,se=0;se<H;){if(j[se]>=P){for(J=se+1;J<H&&j[J]>=P;)J++;for(X=se,R=J-1;X<R;X++,R--)T=w[X],w[X]=w[R],w[R]=T,v&&(T=v[X],v[X]=v[R],v[R]=T);se=J}se++}}},M=function(P,w,v){var j=P.split(""),z={hiLevel:te};return v||(v=[]),E(j,v,z),function(T,R,J){if(J.hiLevel!==0&&u)for(var X,H=0;H<T.length;H++)R[H]===1&&(X=x.indexOf(T[H]))>=0&&(T[H]=x[X+1])}(j,v,z),L(2,j,w,v,z),L(1,j,w,v,z),j.join("")};return this.__bidiEngine__.doBidiReorder=function(P,w,v){if(function(z,T){if(T)for(var R=0;R<z.length;R++)T[R]=R;l===void 0&&(l=V(z)),d===void 0&&(d=V(z))}(P,w),s||!c||d)if(s&&c&&l^d)te=l?1:0,P=I(P,w,v);else if(!s&&c&&d)te=l?1:0,P=M(P,w,v),P=I(P,w);else if(!s||l||c||d){if(s&&!c&&l^d)P=I(P,w),l?(te=0,P=M(P,w,v)):(te=1,P=M(P,w,v),P=I(P,w));else if(s&&l&&!c&&d)te=1,P=M(P,w,v),P=I(P,w);else if(!s&&!c&&l^d){var j=u;l?(te=1,P=M(P,w,v),te=0,u=!1,P=M(P,w,v),u=j):(te=0,P=M(P,w,v),P=I(P,w),te=1,u=!1,P=M(P,w,v),u=j,P=I(P,w))}}else te=0,P=M(P,w,v);else te=l?1:0,P=M(P,w,v);return P},this.__bidiEngine__.setOptions=function(P){P&&(s=P.isInputVisual,c=P.isOutputVisual,l=P.isInputRtl,d=P.isOutputRtl,u=P.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var o=n.options||{};n.mutex,o.lang;var s=[];if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,r.setOptions(o),Object.prototype.toString.call(i)==="[object Array]"){var l=0;for(s=[],l=0;l<i.length;l+=1)Object.prototype.toString.call(i[l])==="[object Array]"?s.push([r.doBidiReorder(i[l][0]),i[l][1],i[l][2]]):s.push([r.doBidiReorder(i[l])]);n.text=s}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])}(cr),cr.API.TTFFont=function(){function t(e){var r;if(this.rawData=e,r=this.contents=new Ha(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new b8(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new o8(this.contents),this.head=new a8(this),this.name=new h8(this),this.cmap=new r_(this),this.toUnicode={},this.hhea=new l8(this),this.maxp=new p8(this),this.hmtx=new m8(this),this.post=new d8(this),this.os2=new c8(this),this.loca=new v8(this),this.glyf=new y8(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,i,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var s,l,c,d;for(d=[],s=0,l=(c=this.bbox).length;s<l;s++)e=c[s],d.push(Math.round(e*this.scaleFactor));return d}.call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),(32768&(r=i>>16))!=0&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var i,o,s,l;for(s=0,o=0,l=(e=""+e).length;0<=l?o<l:o>l;o=0<=l?++o:--o)i=e.charCodeAt(o),s+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return s*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t}();var zo,Ha=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,i;for(i=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(e.charCodeAt(r)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,i,o,s,l,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),o=this.readByte(),s=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^o)+65536*(255^s)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*i+16777216*o+65536*s+256*l+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,i,o;for(o=[],n=0,i=e.length;n<i;n++)r=e[n],o.push(this.writeByte(r));return o},t}(),o8=function(){var t;function e(r){var n,i,o;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,o=this.tableCount;0<=o?i<o:i>o;i=0<=o?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,i,o,s,l,c,d,u,h,g,m,S,N;for(N in m=Object.keys(r).length,c=Math.log(2),h=16*Math.floor(Math.log(m)/c),s=Math.floor(h/c),u=16*m-h,(i=new Ha).writeInt(this.scalarType),i.writeShort(m),i.writeShort(h),i.writeShort(s),i.writeShort(u),o=16*m,d=i.pos+o,l=null,S=[],r)for(g=r[N],i.writeString(N),i.writeInt(t(g)),i.writeInt(d),i.writeInt(g.length),S=S.concat(g),N==="head"&&(l=d),d+=g.length;d%4;)S.push(0),d++;return i.write(S),n=2981146554-t(i.data),i.pos=l+8,i.writeUInt32(n),i.data},t=function(r){var n,i,o,s;for(r=n_.call(r);r.length%4;)r.push(0);for(o=new Ha(r),i=0,n=0,s=r.length;n<s;n=n+=4)i+=o.readUInt32();return 4294967295&i},e}(),s8={}.hasOwnProperty,ms=function(t,e){for(var r in e)s8.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};zo=function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var a8=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ms(e,zo),e.prototype.tag="head",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},e.prototype.encode=function(r){var n;return(n=new Ha).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},e}(),V1=function(){function t(e,r){var n,i,o,s,l,c,d,u,h,g,m,S,N,x,b,K,te;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),h=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(m=e.readUInt16(),g=m/2,e.pos+=6,o=function(){var F,V;for(V=[],c=F=0;0<=g?F<g:F>g;c=0<=g?++F:--F)V.push(e.readUInt16());return V}(),e.pos+=2,N=function(){var F,V;for(V=[],c=F=0;0<=g?F<g:F>g;c=0<=g?++F:--F)V.push(e.readUInt16());return V}(),d=function(){var F,V;for(V=[],c=F=0;0<=g?F<g:F>g;c=0<=g?++F:--F)V.push(e.readUInt16());return V}(),u=function(){var F,V;for(V=[],c=F=0;0<=g?F<g:F>g;c=0<=g?++F:--F)V.push(e.readUInt16());return V}(),i=(this.length-e.pos+this.offset)/2,l=function(){var F,V;for(V=[],c=F=0;0<=i?F<i:F>i;c=0<=i?++F:--F)V.push(e.readUInt16());return V}(),c=b=0,te=o.length;b<te;c=++b)for(x=o[c],n=K=S=N[c];S<=x?K<=x:K>=x;n=S<=x?++K:--K)u[c]===0?s=n+d[c]:(s=l[u[c]/2+(n-S)-(g-c)]||0)!==0&&(s+=d[c]),this.codeMap[n]=65535&s}e.pos=h}return t.encode=function(e,r){var n,i,o,s,l,c,d,u,h,g,m,S,N,x,b,K,te,F,V,W,I,E,L,M,P,w,v,j,z,T,R,J,X,H,se,O,_,k,$,G,ne,U,D,B,Q,Z;switch(j=new Ha,s=Object.keys(e).sort(function(oe,de){return oe-de}),r){case"macroman":for(N=0,x=function(){var oe=[];for(S=0;S<256;++S)oe.push(0);return oe}(),K={0:0},o={},z=0,X=s.length;z<X;z++)K[D=e[i=s[z]]]==null&&(K[D]=++N),o[i]={old:e[i],new:K[e[i]]},x[i]=K[e[i]];return j.writeUInt16(1),j.writeUInt16(0),j.writeUInt32(12),j.writeUInt16(0),j.writeUInt16(262),j.writeUInt16(0),j.write(x),{charMap:o,subtable:j.data,maxGlyphID:N+1};case"unicode":for(w=[],h=[],te=0,K={},n={},b=d=null,T=0,H=s.length;T<H;T++)K[V=e[i=s[T]]]==null&&(K[V]=++te),n[i]={old:V,new:K[V]},l=K[V]-i,b!=null&&l===d||(b&&h.push(b),w.push(i),d=l),b=i;for(b&&h.push(b),h.push(65535),w.push(65535),M=2*(L=w.length),E=2*Math.pow(Math.log(L)/Math.LN2,2),g=Math.log(E/2)/Math.LN2,I=2*L-E,c=[],W=[],m=[],S=R=0,se=w.length;R<se;S=++R){if(P=w[S],u=h[S],P===65535){c.push(0),W.push(0);break}if(P-(v=n[P].new)>=32768)for(c.push(0),W.push(2*(m.length+L-S)),i=J=P;P<=u?J<=u:J>=u;i=P<=u?++J:--J)m.push(n[i].new);else c.push(v-P),W.push(0)}for(j.writeUInt16(3),j.writeUInt16(1),j.writeUInt32(12),j.writeUInt16(4),j.writeUInt16(16+8*L+2*m.length),j.writeUInt16(0),j.writeUInt16(M),j.writeUInt16(E),j.writeUInt16(g),j.writeUInt16(I),ne=0,O=h.length;ne<O;ne++)i=h[ne],j.writeUInt16(i);for(j.writeUInt16(0),U=0,_=w.length;U<_;U++)i=w[U],j.writeUInt16(i);for(B=0,k=c.length;B<k;B++)l=c[B],j.writeUInt16(l);for(Q=0,$=W.length;Q<$;Q++)F=W[Q],j.writeUInt16(F);for(Z=0,G=m.length;Z<G;Z++)N=m[Z],j.writeUInt16(N);return{charMap:n,subtable:j.data,maxGlyphID:te+1}}},t}(),r_=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ms(e,zo),e.prototype.tag="cmap",e.prototype.parse=function(r){var n,i,o;for(r.pos=this.offset,this.version=r.readUInt16(),o=r.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=o?i<o:i>o;i=0<=o?++i:--i)n=new V1(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},e.encode=function(r,n){var i,o;return n==null&&(n="macroman"),i=V1.encode(r,n),(o=new Ha).writeUInt16(0),o.writeUInt16(1),i.table=o.data.concat(i.subtable),i},e}(),l8=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ms(e,zo),e.prototype.tag="hhea",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},e}(),c8=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ms(e,zo),e.prototype.tag="OS/2",e.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var n,i;for(i=[],n=0;n<10;++n)i.push(r.readByte());return i}(),this.charRange=function(){var n,i;for(i=[],n=0;n<4;++n)i.push(r.readInt());return i}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var n,i;for(i=[],n=0;n<2;n=++n)i.push(r.readInt());return i}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},e}(),d8=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ms(e,zo),e.prototype.tag="post",e.prototype.parse=function(r){var n,i,o;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var s;for(i=r.readUInt16(),this.glyphNameIndex=[],s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],o=[];r.pos<this.offset+this.length;)n=r.readByte(),o.push(this.names.push(r.readString(n)));return o;case 151552:return i=r.readUInt16(),this.offsets=r.read(i);case 196608:break;case 262144:return this.map=function(){var l,c,d;for(d=[],s=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;s=0<=c?++l:--l)d.push(r.readUInt32());return d}.call(this)}},e}(),u8=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},h8=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ms(e,zo),e.prototype.tag="name",e.prototype.parse=function(r){var n,i,o,s,l,c,d,u,h,g,m;for(r.pos=this.offset,r.readShort(),n=r.readShort(),c=r.readShort(),i=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)i.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+c+r.readShort()});for(d={},s=h=0,g=i.length;h<g;s=++h)o=i[s],r.pos=o.offset,u=r.readString(o.length),l=new u8(u,o),d[m=o.nameID]==null&&(d[m]=[]),d[o.nameID].push(l);this.strings=d,this.copyright=d[0],this.fontFamily=d[1],this.fontSubfamily=d[2],this.uniqueSubfamily=d[3],this.fontName=d[4],this.version=d[5];try{this.postscriptName=d[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=d[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=d[7],this.manufacturer=d[8],this.designer=d[9],this.description=d[10],this.vendorUrl=d[11],this.designerUrl=d[12],this.license=d[13],this.licenseUrl=d[14],this.preferredFamily=d[15],this.preferredSubfamily=d[17],this.compatibleFull=d[18],this.sampleText=d[19]},e}(),p8=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ms(e,zo),e.prototype.tag="maxp",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},e}(),m8=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ms(e,zo),e.prototype.tag="hmtx",e.prototype.parse=function(r){var n,i,o,s,l,c,d;for(r.pos=this.offset,this.metrics=[],n=0,c=this.file.hhea.numberOfMetrics;0<=c?n<c:n>c;n=0<=c?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(o=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,h;for(h=[],n=u=0;0<=o?u<o:u>o;n=0<=o?++u:--u)h.push(r.readInt16());return h}(),this.widths=function(){var u,h,g,m;for(m=[],u=0,h=(g=this.metrics).length;u<h;u++)s=g[u],m.push(s.advance);return m}.call(this),i=this.widths[this.widths.length-1],d=[],n=l=0;0<=o?l<o:l>o;n=0<=o?++l:--l)d.push(this.widths.push(i));return d},e.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},e}(),n_=[].slice,y8=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ms(e,zo),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(r){var n,i,o,s,l,c,d,u,h,g;return r in this.cache?this.cache[r]:(s=this.file.loca,n=this.file.contents,i=s.indexOf(r),(o=s.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+i,l=(c=new Ha(n.read(o))).readShort(),u=c.readShort(),g=c.readShort(),d=c.readShort(),h=c.readShort(),this.cache[r]=l===-1?new g8(c,u,g,d,h):new f8(c,l,u,g,d,h),this.cache[r]))},e.prototype.encode=function(r,n,i){var o,s,l,c,d;for(l=[],s=[],c=0,d=n.length;c<d;c++)o=r[n[c]],s.push(l.length),o&&(l=l.concat(o.encode(i)));return s.push(l.length),{table:l,offsets:s}},e}(),f8=function(){function t(e,r,n,i,o,s){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=o,this.yMax=s,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),g8=function(){function t(e,r,n,i,o){var s,l;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;l=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&l;)s.pos+=1&l?4:2,128&l?s.pos+=8:64&l?s.pos+=4:8&l&&(s.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new Ha(n_.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t}(),v8=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ms(e,zo),e.prototype.tag="loca",e.prototype.parse=function(r){var n,i;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?function(){var o,s;for(s=[],i=0,o=this.length;i<o;i+=2)s.push(2*r.readUInt16());return s}.call(this):function(){var o,s;for(s=[],i=0,o=this.length;i<o;i+=4)s.push(r.readUInt32());return s}.call(this)},e.prototype.indexOf=function(r){return this.offsets[r]},e.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},e.prototype.encode=function(r,n){for(var i=new Uint32Array(this.offsets.length),o=0,s=0,l=0;l<i.length;++l)if(i[l]=o,s<n.length&&n[s]==l){++s,i[l]=o;var c=this.offsets[l],d=this.offsets[l+1]-c;d>0&&(o+=d)}for(var u=new Array(4*i.length),h=0;h<i.length;++h)u[4*h+3]=255&i[h],u[4*h+2]=(65280&i[h])>>8,u[4*h+1]=(16711680&i[h])>>16,u[4*h]=(4278190080&i[h])>>24;return u},e}(),b8=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,i,o;for(r in i=this.font.cmap.tables[0].codeMap,e={},o=this.subset)n=o[r],e[r]=i[n];return e},t.prototype.glyphsFor=function(e){var r,n,i,o,s,l,c;for(i={},s=0,l=e.length;s<l;s++)i[o=e[s]]=this.font.glyf.glyphFor(o);for(o in r=[],i)(n=i[o])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(o in c=this.glyphsFor(r))n=c[o],i[o]=n;return i},t.prototype.encode=function(e,r){var n,i,o,s,l,c,d,u,h,g,m,S,N,x,b;for(i in n=r_.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),m={0:0},b=n.charMap)m[(c=b[i]).old]=c.new;for(S in g=n.maxGlyphID,s)S in m||(m[S]=g++);return u=function(K){var te,F;for(te in F={},K)F[K[te]]=te;return F}(m),h=Object.keys(u).sort(function(K,te){return K-te}),N=function(){var K,te,F;for(F=[],K=0,te=h.length;K<te;K++)l=h[K],F.push(u[l]);return F}(),o=this.font.glyf.encode(s,N,m),d=this.font.loca.encode(o.offsets,N),x={cmap:this.font.cmap.raw(),glyf:o.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(x["OS/2"]=this.font.os2.raw()),this.font.directory.encode(x)},t}();cr.API.PDFObject=function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,i,o,s;if(Array.isArray(r))return"["+function(){var l,c,d;for(d=[],l=0,c=r.length;l<c;l++)n=r[l],d.push(e.convert(n));return d}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in o=["<<"],r)s=r[i],o.push("/"+i+" "+e.convert(s));return o.push(">>"),o.join(`
`)}return""+r},e}();const i_=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:JL,AcroFormAppearance:er,AcroFormButton:qn,AcroFormCheckBox:jd,AcroFormChoiceField:xl,AcroFormComboBox:Al,AcroFormEditBox:Bd,AcroFormListBox:Cl,AcroFormPasswordField:zd,AcroFormPushButton:Vd,AcroFormRadioButton:$l,AcroFormTextField:Fa,GState:ou,ShadingPattern:Ea,TilingPattern:Pl,default:cr,jsPDF:cr},Symbol.toStringTag,{value:"Module"}));function o_(t,e,r,n,i){n=n||{};var o=1.15,s=i.internal.scaleFactor,l=i.internal.getFontSize()/s,c=i.getLineHeightFactor?i.getLineHeightFactor():o,d=l*c,u=/\r\n|\r|\n/g,h="",g=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(h=typeof t=="string"?t.split(u):t,g=h.length||1),r+=l*(2-o),n.valign==="middle"?r-=g/2*d:n.valign==="bottom"&&(r-=g*d),n.halign==="center"||n.halign==="right"){var m=l;if(n.halign==="center"&&(m*=.5),h&&g>=1){for(var S=0;S<h.length;S++)i.text(h[S],e-i.getStringUnitWidth(h[S])*m,r),r+=d;return i}e-=i.getStringUnitWidth(t)*m}return n.halign==="justify"?i.text(t,e,r,{maxWidth:n.maxWidth||100,align:"justify"}):i.text(t,e,r),i}var j1={},Ac=function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:j1=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var n,i,o;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var s=this.jsPDFDocument.internal.getFont(),l=s.fontStyle,c=s.fontName;if(e.font&&(c=e.font),e.fontStyle){l=e.fontStyle;var d=this.getFontList()[c];d&&d.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(d[0]),l=d[0])}if(this.jsPDFDocument.setFont(c,l),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var u=t.unifyColor(e.fillColor);u&&(n=this.jsPDFDocument).setFillColor.apply(n,u),u=t.unifyColor(e.textColor),u&&(i=this.jsPDFDocument).setTextColor.apply(i,u),u=t.unifyColor(e.lineColor),u&&(o=this.jsPDFDocument).setDrawColor.apply(o,u),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,n){return this.jsPDFDocument.splitTextToSize(e,r,n)},t.prototype.rect=function(e,r,n,i,o){return this.jsPDFDocument.rect(e,r,n,i,o)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return j1||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t}(),hf=function(t,e){return hf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},hf(t,e)};function s_(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");hf(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var a_=function(t){s_(e,t);function e(r){var n=t.call(this)||this;return n._element=r,n}return e}(Array);function P8(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function _8(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function up(t,e,r){r.applyStyles(e,!0);var n=Array.isArray(t)?t:[t],i=n.map(function(o){return r.getTextWidth(o)}).reduce(function(o,s){return Math.max(o,s)},0);return i}function l_(t,e,r,n){var i=e.settings.tableLineWidth,o=e.settings.tableLineColor;t.applyStyles({lineWidth:i,lineColor:o});var s=c_(i,!1);s&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),n.y-r.y,s)}function c_(t,e){var r=t>0,n=e||e===0;return r&&n?"DF":r?"S":n?"F":null}function Gp(t,e){var r,n,i,o;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(n=t.top)!==null&&n!==void 0?n:e,right:(i=t.right)!==null&&i!==void 0?i:e,bottom:(o=t.bottom)!==null&&o!==void 0?o:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function d_(t,e){var r=Gp(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function S8(t,e,r,n,i){var o={},s=1.3333333333333333,l=oy(e,function(te){return i.getComputedStyle(te).backgroundColor});l!=null&&(o.fillColor=l);var c=oy(e,function(te){return i.getComputedStyle(te).color});c!=null&&(o.textColor=c);var d=x8(n,r);d&&(o.cellPadding=d);var u="borderTopColor",h=s*r,g=n.borderTopWidth;if(n.borderBottomWidth===g&&n.borderRightWidth===g&&n.borderLeftWidth===g){var m=(parseFloat(g)||0)/h;m&&(o.lineWidth=m)}else o.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/h,right:(parseFloat(n.borderRightWidth)||0)/h,bottom:(parseFloat(n.borderBottomWidth)||0)/h,left:(parseFloat(n.borderLeftWidth)||0)/h},o.lineWidth.top||(o.lineWidth.right?u="borderRightColor":o.lineWidth.bottom?u="borderBottomColor":o.lineWidth.left&&(u="borderLeftColor"));var S=oy(e,function(te){return i.getComputedStyle(te)[u]});S!=null&&(o.lineColor=S);var N=["left","right","center","justify"];N.indexOf(n.textAlign)!==-1&&(o.halign=n.textAlign),N=["middle","bottom","top"],N.indexOf(n.verticalAlign)!==-1&&(o.valign=n.verticalAlign);var x=parseInt(n.fontSize||"");isNaN(x)||(o.fontSize=x/s);var b=w8(n);b&&(o.fontStyle=b);var K=(n.fontFamily||"").toLowerCase();return t.indexOf(K)!==-1&&(o.font=K),o}function w8(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function oy(t,e){var r=u_(t,e);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var i=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],o=parseInt(n[4]);return o===0||isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function u_(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:u_(t.parentElement,e):r}function x8(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],n=96/(72/e),i=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,o=r.map(function(l){return parseInt(l||"0")/n}),s=Gp(o,0);return i>s.top&&(s.top=i),i>s.bottom&&(s.bottom=i),s}function h_(t,e,r,n,i){var o,s;n===void 0&&(n=!1),i===void 0&&(i=!1);var l;typeof e=="string"?l=r.document.querySelector(e):l=e;var c=Object.keys(t.getFontList()),d=t.scaleFactor(),u=[],h=[],g=[];if(!l)return console.error("Html table could not be found with input: ",e),{head:u,body:h,foot:g};for(var m=0;m<l.rows.length;m++){var S=l.rows[m],N=(s=(o=S?.parentElement)===null||o===void 0?void 0:o.tagName)===null||s===void 0?void 0:s.toLowerCase(),x=C8(c,d,r,S,n,i);x&&(N==="thead"?u.push(x):N==="tfoot"?g.push(x):h.push(x))}return{head:u,body:h,foot:g}}function C8(t,e,r,n,i,o){for(var s=new a_(n),l=0;l<n.cells.length;l++){var c=n.cells[l],d=r.getComputedStyle(c);if(i||d.display!=="none"){var u=void 0;o&&(u=S8(t,c,e,d,r)),s.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:u,_element:c,content:A8(c)})}}var h=r.getComputedStyle(n);if(s.length>0&&(i||h.display!=="none"))return s}function A8(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function $8(t,e,r){for(var n=0,i=[t,e,r];n<i.length;n++){var o=i[n];o&&typeof o!="object"&&console.error("The options parameter should be of type object, is: "+typeof o),o.startY&&typeof o.startY!="number"&&(console.error("Invalid value for startY option",o.startY),delete o.startY)}}function Rs(t,e,r,n,i){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(t),s=1;s<arguments.length;s++){var l=arguments[s];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(o[c]=l[c])}return o}function p_(t,e){var r=new Ac(t),n=r.getDocumentOptions(),i=r.getGlobalOptions();$8(i,n,e);var o=Rs({},i,n,e),s;typeof window<"u"&&(s=window);var l=E8(i,n,e),c=I8(i,n,e),d=T8(r,o),u=N8(r,o,s);return{id:e.tableId,content:u,hooks:c,styles:l,settings:d}}function E8(t,e,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},i=function(c){if(c==="columnStyles"){var d=t[c],u=e[c],h=r[c];n.columnStyles=Rs({},d,u,h)}else{var g=[t,e,r],m=g.map(function(S){return S[c]||{}});n[c]=Rs({},m[0],m[1],m[2])}},o=0,s=Object.keys(n);o<s.length;o++){var l=s[o];i(l)}return n}function I8(t,e,r){for(var n=[t,e,r],i={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},o=0,s=n;o<s.length;o++){var l=s[o];l.didParseCell&&i.didParseCell.push(l.didParseCell),l.willDrawCell&&i.willDrawCell.push(l.willDrawCell),l.didDrawCell&&i.didDrawCell.push(l.didDrawCell),l.willDrawPage&&i.willDrawPage.push(l.willDrawPage),l.didDrawPage&&i.didDrawPage.push(l.didDrawPage)}return i}function T8(t,e){var r,n,i,o,s,l,c,d,u,h,g,m,S=Gp(e.margin,40/t.scaleFactor()),N=(r=k8(t,e.startY))!==null&&r!==void 0?r:S.top,x;e.showFoot===!0?x="everyPage":e.showFoot===!1?x="never":x=(n=e.showFoot)!==null&&n!==void 0?n:"everyPage";var b;e.showHead===!0?b="everyPage":e.showHead===!1?b="never":b=(i=e.showHead)!==null&&i!==void 0?i:"everyPage";var K=(o=e.useCss)!==null&&o!==void 0?o:!1,te=e.theme||(K?"plain":"striped"),F=!!e.horizontalPageBreak,V=(s=e.horizontalPageBreakRepeat)!==null&&s!==void 0?s:null;return{includeHiddenHtml:(l=e.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:K,theme:te,startY:N,margin:S,pageBreak:(c=e.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(d=e.rowPageBreak)!==null&&d!==void 0?d:"auto",tableWidth:(u=e.tableWidth)!==null&&u!==void 0?u:"auto",showHead:b,showFoot:x,tableLineWidth:(h=e.tableLineWidth)!==null&&h!==void 0?h:0,tableLineColor:(g=e.tableLineColor)!==null&&g!==void 0?g:200,horizontalPageBreak:F,horizontalPageBreakRepeat:V,horizontalPageBreakBehaviour:(m=e.horizontalPageBreakBehaviour)!==null&&m!==void 0?m:"afterAllRows"}}function k8(t,e){var r=t.getLastAutoTable(),n=t.scaleFactor(),i=t.pageNumber(),o=!1;if(r&&r.startPageNumber){var s=r.startPageNumber+r.pageNumber-1;o=s===i}return typeof e=="number"?e:(e==null||e===!1)&&o&&r?.finalY!=null?r.finalY+20/n:null}function N8(t,e,r){var n=e.head||[],i=e.body||[],o=e.foot||[];if(e.html){var s=e.includeHiddenHtml;if(r){var l=h_(t,e.html,r,s,e.useCss)||{};n=l.head||n,i=l.body||n,o=l.foot||n}else console.error("Cannot parse html in non browser environment")}var c=e.columns||L8(n,i,o);return{columns:c,head:n,body:i,foot:o}}function L8(t,e,r){var n=t[0]||e[0]||r[0]||[],i=[];return Object.keys(n).filter(function(o){return o!=="_element"}).forEach(function(o){var s=1,l;Array.isArray(n)?l=n[parseInt(o)]:l=n[o],typeof l=="object"&&!Array.isArray(l)&&(s=l?.colSpan||1);for(var c=0;c<s;c++){var d=void 0;Array.isArray(n)?d=i.length:d=o+(c>0?"_".concat(c):"");var u={dataKey:d};i.push(u)}}),i}var pf=function(){function t(e,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=e.getDocument()}return t}(),R8=function(t){s_(e,t);function e(r,n,i,o,s,l){var c=t.call(this,r,n,l)||this;return c.cell=i,c.row=o,c.column=s,c.section=o.section,c}return e}(pf),D8=function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,n,i,o,s){for(var l=0,c=r;l<c.length;l++){var d=c[l],u=new R8(e,this,n,i,o,s),h=d(u)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],h)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var n=0,i=this.hooks.didDrawPage;n<i.length;n++){var o=i[n];o(new pf(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var n=0,i=this.hooks.willDrawPage;n<i.length;n++){var o=i[n];o(new pf(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(i,o){return i+o.wrappedWidth},0);return r}else{var n=this.settings.margin;return e-n.left-n.right}},t}(),m_=function(){function t(e,r,n,i,o){o===void 0&&(o=!1),this.height=0,this.raw=e,e instanceof a_&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=n,this.cells=i,this.spansMultiplePages=o}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(n,i){var o;return Math.max(n,((o=r.cells[i.index])===null||o===void 0?void 0:o.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(n){var i=r.cells[n.index];return i?i.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var n=this;return e.reduce(function(i,o){var s=n.cells[o.index];if(!s)return 0;var l=r.getLineHeight(s.styles.fontSize),c=s.padding("vertical"),d=c+l;return d>i?d:i},0)},t}(),y_=function(){function t(e,r,n){var i;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=e;var o=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,o=(i=e.content)!==null&&i!==void 0?i:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var s=o!=null?""+o:"",l=/\r\n|\r|\n/g;this.text=s.split(l)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var i=this.width-this.padding("horizontal");n=this.x+i/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,i=this.styles.fontSize/e*r,o=n*i+this.padding("vertical");return Math.max(o,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=Gp(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t}(),M8=function(){function t(e,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=n}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,n=0,i=e.allRows();n<i.length;n++){var o=i[n],s=o.cells[this.index];s&&typeof s.styles.cellWidth=="number"&&(r=Math.max(r,s.styles.cellWidth))}return r},t}();function F8(t,e){O8(t,e);var r=[],n=0;e.columns.forEach(function(o){var s=o.getMaxCustomCellWidth(e);s?o.width=s:(o.width=o.wrappedWidth,r.push(o)),n+=o.width});var i=e.getWidth(t.pageSize().width)-n;i&&(i=mf(r,i,function(o){return Math.max(o.minReadableWidth,o.minWidth)})),i&&(i=mf(r,i,function(o){return o.minWidth})),i=Math.abs(i),!e.settings.horizontalPageBreak&&i>.1/t.scaleFactor()&&(i=i<1?i:Math.round(i),console.warn("Of the table content, ".concat(i," units width could not fit page"))),V8(e),j8(e,t),B8(e)}function O8(t,e){var r=t.scaleFactor(),n=e.settings.horizontalPageBreak,i=d_(t,e);e.allRows().forEach(function(o){for(var s=0,l=e.columns;s<l.length;s++){var c=l[s],d=o.cells[c.index];if(d){var u=e.hooks.didParseCell;e.callCellHooks(t,u,d,o,c,null);var h=d.padding("horizontal");d.contentWidth=up(d.text,d.styles,t)+h;var g=up(d.text.join(" ").split(/[^\S\u00A0]+/),d.styles,t);if(d.minReadableWidth=g+d.padding("horizontal"),typeof d.styles.cellWidth=="number")d.minWidth=d.styles.cellWidth,d.wrappedWidth=d.styles.cellWidth;else if(d.styles.cellWidth==="wrap"||n===!0)d.contentWidth>i?(d.minWidth=i,d.wrappedWidth=i):(d.minWidth=d.contentWidth,d.wrappedWidth=d.contentWidth);else{var m=10/r;d.minWidth=d.styles.minCellWidth||m,d.wrappedWidth=d.contentWidth,d.minWidth>d.wrappedWidth&&(d.wrappedWidth=d.minWidth)}}}}),e.allRows().forEach(function(o){for(var s=0,l=e.columns;s<l.length;s++){var c=l[s],d=o.cells[c.index];if(d&&d.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,d.wrappedWidth),c.minWidth=Math.max(c.minWidth,d.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,d.minReadableWidth);else{var u=e.styles.columnStyles[c.dataKey]||e.styles.columnStyles[c.index]||{},h=u.cellWidth||u.minCellWidth;h&&typeof h=="number"&&(c.minWidth=h,c.wrappedWidth=h)}d&&(d.colSpan>1&&!c.minWidth&&(c.minWidth=d.minWidth),d.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=d.minWidth))}})}function mf(t,e,r){for(var n=e,i=t.reduce(function(m,S){return m+S.wrappedWidth},0),o=0;o<t.length;o++){var s=t[o],l=s.wrappedWidth/i,c=n*l,d=s.width+c,u=r(s),h=d<u?u:d;e-=h-s.width,s.width=h}if(e=Math.round(e*1e10)/1e10,e){var g=t.filter(function(m){return e<0?m.width>r(m):!0});g.length&&(e=mf(g,e,r))}return e}function B8(t){for(var e={},r=1,n=t.allRows(),i=0;i<n.length;i++)for(var o=n[i],s=0,l=t.columns;s<l.length;s++){var c=l[s],d=e[c.index];if(r>1)r--,delete o.cells[c.index];else if(d)d.cell.height+=o.height,r=d.cell.colSpan,delete o.cells[c.index],d.left--,d.left<=1&&delete e[c.index];else{var u=o.cells[c.index];if(!u)continue;if(u.height=o.height,u.rowSpan>1){var h=n.length-i,g=u.rowSpan>h?h:u.rowSpan;e[c.index]={cell:u,left:g,row:o}}}}}function V8(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var n=e[r],i=null,o=0,s=0,l=0;l<t.columns.length;l++){var c=t.columns[l];if(s-=1,s>1&&t.columns[l+1])o+=c.width,delete n.cells[c.index];else if(i){var d=i;delete n.cells[c.index],i=null,d.width=c.width+o}else{var d=n.cells[c.index];if(!d)continue;if(s=d.colSpan,o=0,d.colSpan>1){i=d,o+=c.width;continue}d.width=c.width+o}}}function j8(t,e){for(var r={count:0,height:0},n=0,i=t.allRows();n<i.length;n++){for(var o=i[n],s=0,l=t.columns;s<l.length;s++){var c=l[s],d=o.cells[c.index];if(d){e.applyStyles(d.styles,!0);var u=d.width-d.padding("horizontal");if(d.styles.overflow==="linebreak")d.text=e.splitTextToSize(d.text,u+1/e.scaleFactor(),{fontSize:d.styles.fontSize});else if(d.styles.overflow==="ellipsize")d.text=z1(d.text,u,d.styles,e,"...");else if(d.styles.overflow==="hidden")d.text=z1(d.text,u,d.styles,e,"");else if(typeof d.styles.overflow=="function"){var h=d.styles.overflow(d.text,u);typeof h=="string"?d.text=[h]:d.text=h}d.contentHeight=d.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var g=d.contentHeight/d.rowSpan;d.rowSpan>1&&r.count*r.height<g*d.rowSpan?r={height:g,count:d.rowSpan}:r&&r.count>0&&r.height>g&&(g=r.height),g>o.height&&(o.height=g)}}r.count--}}function z1(t,e,r,n,i){return t.map(function(o){return z8(o,e,r,n,i)})}function z8(t,e,r,n,i){var o=1e4*n.scaleFactor();if(e=Math.ceil(e*o)/o,e>=up(t,r,n))return t;for(;e<up(t+i,r,n)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+i}function f_(t,e){var r=new Ac(t),n=q8(e,r.scaleFactor()),i=new D8(e,n);return F8(r,i),r.applyStyles(r.userStyles),i}function q8(t,e){var r=t.content,n=H8(r.columns);if(r.head.length===0){var i=q1(n,"head");i&&r.head.push(i)}if(r.foot.length===0){var i=q1(n,"foot");i&&r.foot.push(i)}var o=t.settings.theme,s=t.styles;return{columns:n,head:sy("head",r.head,n,s,o,e),body:sy("body",r.body,n,s,o,e),foot:sy("foot",r.foot,n,s,o,e)}}function sy(t,e,r,n,i,o){var s={},l=e.map(function(c,d){for(var u=0,h={},g=0,m=0,S=0,N=r;S<N.length;S++){var x=N[S];if(s[x.index]==null||s[x.index].left===0)if(m===0){var b=void 0;Array.isArray(c)?b=c[x.index-g-u]:b=c[x.dataKey];var K={};typeof b=="object"&&!Array.isArray(b)&&(K=b?.styles||{});var te=G8(t,x,d,i,n,o,K),F=new y_(b,te,t);h[x.dataKey]=F,h[x.index]=F,m=F.colSpan-1,s[x.index]={left:F.rowSpan-1,times:m}}else m--,g++;else s[x.index].left--,m=s[x.index].times,u++}return new m_(c,d,t,h)});return l}function q1(t,e){var r={};return t.forEach(function(n){if(n.raw!=null){var i=U8(e,n.raw);i!=null&&(r[n.dataKey]=i)}}),Object.keys(r).length>0?r:null}function U8(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function H8(t){return t.map(function(e,r){var n,i;return typeof e=="object"?i=(n=e.dataKey)!==null&&n!==void 0?n:r:i=r,new M8(i,e,r)})}function G8(t,e,r,n,i,o,s){var l=_8(n),c;t==="head"?c=i.headStyles:t==="body"?c=i.bodyStyles:t==="foot"&&(c=i.footStyles);var d=Rs({},l.table,l[t],i.styles,c),u=i.columnStyles[e.dataKey]||i.columnStyles[e.index]||{},h=t==="body"?u:{},g=t==="body"&&r%2===0?Rs({},l.alternateRow,i.alternateRowStyles):{},m=P8(o),S=Rs({},m,d,g,h);return Rs(S,s)}function W8(t,e,r){var n;r===void 0&&(r={});var i=d_(t,e),o=new Map,s=[],l=[],c=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?c=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(c=[e.settings.horizontalPageBreakRepeat]),c.forEach(function(g){var m=e.columns.find(function(S){return S.dataKey===g||S.index===g});m&&!o.has(m.index)&&(o.set(m.index,!0),s.push(m.index),l.push(e.columns[m.index]),i-=m.wrappedWidth)});for(var d=!0,u=(n=r?.start)!==null&&n!==void 0?n:0;u<e.columns.length;){if(o.has(u)){u++;continue}var h=e.columns[u].wrappedWidth;if(d||i>=h)d=!1,s.push(u),l.push(e.columns[u]),i-=h;else break;u++}return{colIndexes:s,columns:l,lastIndex:u-1}}function Y8(t,e){for(var r=[],n=0;n<e.columns.length;n++){var i=W8(t,e,{start:n});i.columns.length&&(r.push(i),n=i.lastIndex)}return r}function g_(t,e){var r=e.settings,n=r.startY,i=r.margin,o={x:i.left,y:n},s=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),l=n+i.bottom+s;if(r.pageBreak==="avoid"){var c=e.body,d=c.reduce(function(g,m){return g+m.height},0);l+=d}var u=new Ac(t);(r.pageBreak==="always"||r.startY!=null&&l>u.pageSize().height)&&(b_(u),o.y=i.top),e.callWillDrawPageHooks(u,o);var h=Rs({},o);e.startPageNumber=u.pageNumber(),r.horizontalPageBreak?K8(u,e,h,o):(u.applyStyles(u.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(g){return zs(u,e,g,o,e.columns)}),u.applyStyles(u.userStyles),e.body.forEach(function(g,m){var S=m===e.body.length-1;hp(u,e,g,S,h,o,e.columns)}),u.applyStyles(u.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(g){return zs(u,e,g,o,e.columns)})),l_(u,e,h,o),e.callEndPageHooks(u,o),e.finalY=o.y,t.lastAutoTable=e,u.applyStyles(u.userStyles)}function K8(t,e,r,n){var i=Y8(t,e),o=e.settings;if(o.horizontalPageBreakBehaviour==="afterAllRows")i.forEach(function(d,u){t.applyStyles(t.userStyles),u>0?qd(t,e,r,n,d.columns,!0):U1(t,e,n,d.columns),Q8(t,e,r,n,d.columns),ay(t,e,n,d.columns)});else for(var s=-1,l=i[0],c=function(){var d=s;if(l){t.applyStyles(t.userStyles);var u=l.columns;s>=0?qd(t,e,r,n,u,!0):U1(t,e,n,u),d=H1(t,e,s+1,n,u),ay(t,e,n,u)}var h=d-s;i.slice(1).forEach(function(g){t.applyStyles(t.userStyles),qd(t,e,r,n,g.columns,!0),H1(t,e,s+1,n,g.columns,h),ay(t,e,n,g.columns)}),s=d};s<e.body.length-1;)c()}function U1(t,e,r,n){var i=e.settings;t.applyStyles(t.userStyles),(i.showHead==="firstPage"||i.showHead==="everyPage")&&e.head.forEach(function(o){return zs(t,e,o,r,n)})}function Q8(t,e,r,n,i){t.applyStyles(t.userStyles),e.body.forEach(function(o,s){var l=s===e.body.length-1;hp(t,e,o,l,r,n,i)})}function H1(t,e,r,n,i,o){t.applyStyles(t.userStyles),o=o??e.body.length;var s=Math.min(r+o,e.body.length),l=-1;return e.body.slice(r,s).forEach(function(c,d){var u=r+d===e.body.length-1,h=v_(t,e,u,n);c.canEntireRowFit(h,i)&&(zs(t,e,c,n,i),l=r+d)}),l}function ay(t,e,r,n){var i=e.settings;t.applyStyles(t.userStyles),(i.showFoot==="lastPage"||i.showFoot==="everyPage")&&e.foot.forEach(function(o){return zs(t,e,o,r,n)})}function J8(t,e,r){var n=r.getLineHeight(t.styles.fontSize),i=t.padding("vertical"),o=Math.floor((e-i)/n);return Math.max(0,o)}function X8(t,e,r,n){var i={};t.spansMultiplePages=!0,t.height=0;for(var o=0,s=0,l=r.columns;s<l.length;s++){var c=l[s],d=t.cells[c.index];if(d){Array.isArray(d.text)||(d.text=[d.text]);var u=new y_(d.raw,d.styles,d.section);u=Rs(u,d),u.text=[];var h=J8(d,e,n);d.text.length>h&&(u.text=d.text.splice(h,d.text.length));var g=n.scaleFactor(),m=n.getLineHeightFactor();d.contentHeight=d.getContentHeight(g,m),d.contentHeight>=e&&(d.contentHeight=e,u.styles.minCellHeight-=e),d.contentHeight>t.height&&(t.height=d.contentHeight),u.contentHeight=u.getContentHeight(g,m),u.contentHeight>o&&(o=u.contentHeight),i[c.index]=u}}var S=new m_(t.raw,-1,t.section,i,!0);S.height=o;for(var N=0,x=r.columns;N<x.length;N++){var c=x[N],u=S.cells[c.index];u&&(u.height=S.height);var d=t.cells[c.index];d&&(d.height=t.height)}return S}function Z8(t,e,r,n){var i=t.pageSize().height,o=n.settings.margin,s=o.top+o.bottom,l=i-s;e.section==="body"&&(l-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=e.getMinimumRowHeight(n.columns,t),d=c<r;if(c>l)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!d)return!1;var u=e.hasRowSpan(n.columns),h=e.getMaxCellHeight(n.columns)>l;return h?(u&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(u||n.settings.rowPageBreak==="avoid")}function hp(t,e,r,n,i,o,s){var l=v_(t,e,n,o);if(r.canEntireRowFit(l,s))zs(t,e,r,o,s);else if(Z8(t,r,l,e)){var c=X8(r,l,e,t);zs(t,e,r,o,s),qd(t,e,i,o,s),hp(t,e,c,n,i,o,s)}else qd(t,e,i,o,s),hp(t,e,r,n,i,o,s)}function zs(t,e,r,n,i){n.x=e.settings.margin.left;for(var o=0,s=i;o<s.length;o++){var l=s[o],c=r.cells[l.index];if(!c){n.x+=l.width;continue}t.applyStyles(c.styles),c.x=n.x,c.y=n.y;var d=e.callCellHooks(t,e.hooks.willDrawCell,c,r,l,n);if(d===!1){n.x+=l.width;continue}eR(t,c,n);var u=c.getTextPos();o_(c.text,u.x,u.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,c,r,l,n),n.x+=l.width}n.y+=r.height}function eR(t,e,r){var n=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof n.lineWidth=="number"){var i=c_(n.lineWidth,n.fillColor);i&&t.rect(e.x,r.y,e.width,e.height,i)}else typeof n.lineWidth=="object"&&(n.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),tR(t,e,r,n.lineWidth))}function tR(t,e,r,n){var i,o,s,l;n.top&&(i=r.x,o=r.y,s=r.x+e.width,l=r.y,n.right&&(s+=.5*n.right),n.left&&(i-=.5*n.left),c(n.top,i,o,s,l)),n.bottom&&(i=r.x,o=r.y+e.height,s=r.x+e.width,l=r.y+e.height,n.right&&(s+=.5*n.right),n.left&&(i-=.5*n.left),c(n.bottom,i,o,s,l)),n.left&&(i=r.x,o=r.y,s=r.x,l=r.y+e.height,n.top&&(o-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.left,i,o,s,l)),n.right&&(i=r.x+e.width,o=r.y,s=r.x+e.width,l=r.y+e.height,n.top&&(o-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.right,i,o,s,l));function c(d,u,h,g,m){t.getDocument().setLineWidth(d),t.getDocument().line(u,h,g,m,"S")}}function v_(t,e,r,n){var i=e.settings.margin.bottom,o=e.settings.showFoot;return(o==="everyPage"||o==="lastPage"&&r)&&(i+=e.getFootHeight(e.columns)),t.pageSize().height-n.y-i}function qd(t,e,r,n,i,o){i===void 0&&(i=[]),o===void 0&&(o=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!o&&e.foot.forEach(function(l){return zs(t,e,l,n,i)}),e.callEndPageHooks(t,n);var s=e.settings.margin;l_(t,e,r,n),b_(t),e.pageNumber++,n.x=s.left,n.y=s.top,r.y=s.top,e.callWillDrawPageHooks(t,n),e.settings.showHead==="everyPage"&&(e.head.forEach(function(l){return zs(t,e,l,n,i)}),t.applyStyles(t.userStyles))}function b_(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function rR(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e[0],i=p_(this,n),o=f_(this,i);return g_(this,o),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,n,i){o_(e,r,n,i,this)},t.API.autoTableSetDefaults=function(e){return Ac.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){Ac.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var i=new Ac(this),o=h_(i,e,window,r,!1),s=o.head,l=o.body,c=((n=s[0])===null||n===void 0?void 0:n.map(function(d){return d.content}))||[];return{columns:c,rows:l,data:l}}}var ly;function lB(t,e){var r=p_(t,e),n=f_(t,r);g_(t,n)}try{if(typeof window<"u"&&window){var G1=window,W1=G1.jsPDF||((ly=G1.jspdf)===null||ly===void 0?void 0:ly.jsPDF);W1&&rR(W1)}}catch(t){console.error("Could not apply autoTable plugin",t)}var nR=le("<div><div><label></label><select><option value=all></option></select></div><div><label></label><select><option value=all></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label></div><div><label>"),iR=le("<div><div><div></div></div><div><div> <!> <!> <!> </div><div>"),oR=le("<div><div>"),ph=le("<option>"),sR=le("<div><div><div><div></div><div></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div></div><div><div></div><div></div></div></div><div><div><span>: </span><span></span></div><div><span>: </span><span></span></div><div><span>: </span><span></span></div><div><span>: </span><span> kg</span></div><div><span>: </span><span></span></div><div><span>: </span><span>");const aR=t=>{const{t:e}=or(),[r,n]=Se(""),[i,o]=Se("all"),[s,l]=Se({start:"",end:""}),[c,d]=Se(""),[u,h]=Se(""),[g,m]=Se(!1),[S,N]=Se("all"),x=Nt(()=>{let P=t.hbls;var w="";if(r()&&(w+=r().toLowerCase()),r()){const v=r().toLowerCase();P=P.filter(j=>j.hbl.toLowerCase().includes(v)||j.idairguide.toLowerCase().includes(v)||j.nameshipper.toLowerCase().includes(v)||j.consigneeName.toLowerCase().includes(v)||j.namegood.toLowerCase().includes(v)||j.bagnumber.toLowerCase().includes(v)||j.cidentity.toLowerCase().includes(v))}return i()!=="all"&&(P=P.filter(v=>v.idguidestate===i())),S()!=="all"&&(P=P.filter(v=>v.idclasification===S())),(s().start||s().end)&&(P=P.filter(v=>{const j=new Date(v.datereserve),z=s().start?new Date(s().start):new Date("1900-01-01"),T=s().end?new Date(s().end):new Date("2100-12-31");return j>=z&&j<=T})),c()&&(P=P?.filter(v=>v.nameshipper.toLowerCase().includes(c().toLowerCase()))),u()&&(P=P?.filter(v=>v.consigneeName.toLowerCase().includes(u().toLowerCase()))),P=P?.sort((v,j)=>new Date(j.datereserve).getTime()-new Date(v.datereserve).getTime()),t.onFilterChange?.(P),P}),b=Nt(()=>{const P=new Set(t.hbls.map(w=>w.nameshipper));return Array.from(P).sort()}),K=Nt(()=>{const P=new Set(t.hbls.map(w=>w.consigneeName));return Array.from(P).sort()}),te=Nt(()=>{const P=new Set(t.hbls.map(w=>w.idguidestate));return Array.from(P).sort()}),F=Nt(()=>{const P=new Set(t.hbls.map(w=>w.idclasification));return Array.from(P).sort()}),V=()=>{n(""),o("all"),l({start:"",end:""}),d(""),h(""),N("all")},W=()=>{const P=["HBL Number","Air Guide","Status","Classification","Shipper","Consignee","Identity","Phone","City","Commodity","Weight (kg)","Quantity","Bag Number","Reserve Date"],w=x().map(R=>[R.hbl,R.idairguide,R.idguidestate,R.idclasification,R.nameshipper,R.consigneeName,R.cidentity,R.phoneshipper,R.address.city,R.namegood,R.weight,R.quantity,R.bagnumber,new Date(R.datereserve).toLocaleDateString()]),v=[P.join(","),...w.map(R=>R.map(J=>`"${J}"`).join(","))].join(`
`),j=new Blob([v],{type:"text/csv"}),z=URL.createObjectURL(j),T=document.createElement("a");T.href=z,T.download=`HBL_List_${new Date().toISOString().split("T")[0]}.csv`,T.click(),URL.revokeObjectURL(z)},I=()=>{const P=["HBL Number","Air Guide","Air Number","Status","Classification","Shipper","Consignee","Identity","Shipper Phone","Consignee Phone","Street","City","State","Commodity","Weight (kg)","Quantity","Bag Number","Agency","Guide","Reserve Date"];x().map(R=>[R.hbl,R.idairguide,R.idairnumber,R.idguidestate,R.idclasification,R.nameshipper,R.consigneeName,R.cidentity,R.phoneshipper,R.ctelephone,R.street,R.address.city,R.address.estate,R.namegood,R.weight,R.quantity,R.bagnumber,R.agency,R.guia,new Date(R.datereserve).toLocaleDateString()]);const w=x().map(R=>[R.hbl,R.idclasification,R.idairguide,R.idairnumber,R.idguidestate,R.nameshipper,R.consigneeName,R.cidentity,R.phoneshipper,R.ctelephone,R.street,R.address.city,R.address.estate,R.namegood,R.weight,R.quantity,R.bagnumber,R.agency,R.guia,new Date(R.datereserve).toLocaleDateString()]),v=[P.join("	"),...w.map(R=>R.join("	"))].join(`
`),j=new Blob([v],{type:"application/vnd.ms-excel"}),z=URL.createObjectURL(j),T=document.createElement("a");T.href=z,T.download=`HBL_List_${new Date().toISOString().split("T")[0]}.xls`,T.click(),URL.revokeObjectURL(z)},E=()=>{const P=new cr;P.setFontSize(16),P.text("House Bill of Lading List",14,15),P.setFontSize(10),P.text(`Generated: ${new Date().toLocaleString()}`,14,25),P.setFontSize(10);let w=35;r()&&(P.text(`Search: ${r()}`,14,w),w+=5),i()!=="all"&&(P.text(`Status: ${i()}`,14,w),w+=5);const v=["HBL#","Status","Shipper","Consignee","City","Weight","Commodity"],j=x().map(z=>[z.hbl,z.idguidestate,z.nameshipper.substring(0,20)+(z.nameshipper.length>20?"...":""),z.consigneeName.substring(0,20)+(z.consigneeName.length>20?"...":""),z.address.city,z.weight+" kg",z.namegood.substring(0,15)+(z.namegood.length>15?"...":"")]);P.autoTable({head:[v],body:j,startY:w+5,styles:{fontSize:8},headStyles:{fillColor:[0,123,255]}}),P.save(`HBL_List_${new Date().toISOString().split("T")[0]}.pdf`)},L=P=>P?new Date(P).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-",M=P=>({"EN BODEGA":"#17a2b8",ENVIADO:"#007bff",ENTREGADO:"#28a745",CANCELADO:"#dc3545",PENDIENTE:"#ffc107"})[P]||"#6c757d";return(()=>{var P=oR(),w=P.firstChild;return a(P,A(Rt,{get children(){var v=iR(),j=v.firstChild,z=j.firstChild,T=j.nextSibling,R=T.firstChild,J=R.firstChild,X=J.nextSibling,H=X.nextSibling,se=H.nextSibling,O=se.nextSibling,_=O.nextSibling;_.nextSibling;var k=R.nextSibling;return v.style.setProperty("padding","1rem"),j.style.setProperty("display","grid"),j.style.setProperty("grid-template-columns","1fr auto"),j.style.setProperty("gap","1rem"),j.style.setProperty("margin-bottom","1rem"),a(j,A(Lt,{type:"text",get placeholder(){return e("hbl.searchPlaceholder","Search by HBL#, air guide, shipper, consignee, commodity, bag#, identity...")},get value(){return r()},onInput:$=>n($.currentTarget.value)}),z),z.style.setProperty("display","flex"),z.style.setProperty("gap","0.5rem"),a(z,A(ct,{variant:"outline",size:"sm",onClick:()=>m(!g()),get children(){return ke(()=>!!g())()?e("common.hideFilters","Hide Filters"):e("common.showFilters","Show Filters")}}),null),a(z,A(ct,{variant:"outline",size:"sm",onClick:V,get children(){return e("common.clearFilters","Clear Filters")}}),null),a(v,A(Me,{get when(){return g()},get children(){var $=nR(),G=$.firstChild,ne=G.firstChild,U=ne.nextSibling,D=U.firstChild,B=G.nextSibling,Q=B.firstChild,Z=Q.nextSibling,oe=Z.firstChild,de=B.nextSibling,re=de.firstChild,Y=re.nextSibling,ce=Y.firstChild,ue=de.nextSibling,ae=ue.firstChild,ye=ae.nextSibling,me=ye.firstChild,pe=ue.nextSibling,ve=pe.firstChild,Ne=pe.nextSibling,Ie=Ne.firstChild;return $.style.setProperty("display","grid"),$.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),$.style.setProperty("gap","1rem"),$.style.setProperty("margin-bottom","1rem"),$.style.setProperty("padding","1rem"),$.style.setProperty("background","var(--background-color)"),$.style.setProperty("border-radius","var(--border-radius-sm)"),ne.style.setProperty("display","block"),ne.style.setProperty("margin-bottom","0.25rem"),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-muted)"),a(ne,()=>e("common.status","Status")),U.addEventListener("change",Ce=>o(Ce.currentTarget.value)),U.style.setProperty("width","100%"),U.style.setProperty("padding","0.5rem"),U.style.setProperty("border","1px solid var(--border-color)"),U.style.setProperty("border-radius","var(--border-radius-sm)"),U.style.setProperty("background","var(--surface-color)"),a(D,()=>e("common.all","All")),a(U,A(vt,{get each(){return te()},children:Ce=>(()=>{var Ee=ph();return Ee.value=Ce,a(Ee,Ce),Ee})()}),null),Q.style.setProperty("display","block"),Q.style.setProperty("margin-bottom","0.25rem"),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),a(Q,()=>e("hbl.classification","Classification")),Z.addEventListener("change",Ce=>N(Ce.currentTarget.value)),Z.style.setProperty("width","100%"),Z.style.setProperty("padding","0.5rem"),Z.style.setProperty("border","1px solid var(--border-color)"),Z.style.setProperty("border-radius","var(--border-radius-sm)"),Z.style.setProperty("background","var(--surface-color)"),a(oe,()=>e("common.all","All")),a(Z,A(vt,{get each(){return F()},children:Ce=>(()=>{var Ee=ph();return Ee.value=Ce,a(Ee,Ce),Ee})()}),null),re.style.setProperty("display","block"),re.style.setProperty("margin-bottom","0.25rem"),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),a(re,()=>e("hbl.shipper","Shipper")),Y.addEventListener("change",Ce=>d(Ce.currentTarget.value)),Y.style.setProperty("width","100%"),Y.style.setProperty("padding","0.5rem"),Y.style.setProperty("border","1px solid var(--border-color)"),Y.style.setProperty("border-radius","var(--border-radius-sm)"),Y.style.setProperty("background","var(--surface-color)"),a(ce,()=>e("common.all","All")),a(Y,A(vt,{get each(){return b()},children:Ce=>(()=>{var Ee=ph();return Ee.value=Ce,a(Ee,Ce),Ee})()}),null),ae.style.setProperty("display","block"),ae.style.setProperty("margin-bottom","0.25rem"),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),a(ae,()=>e("hbl.consignee","Consignee")),ye.addEventListener("change",Ce=>h(Ce.currentTarget.value)),ye.style.setProperty("width","100%"),ye.style.setProperty("padding","0.5rem"),ye.style.setProperty("border","1px solid var(--border-color)"),ye.style.setProperty("border-radius","var(--border-radius-sm)"),ye.style.setProperty("background","var(--surface-color)"),a(me,()=>e("common.all","All")),a(ye,A(vt,{get each(){return K()},children:Ce=>(()=>{var Ee=ph();return Ee.value=Ce,a(Ee,Ce),Ee})()}),null),ve.style.setProperty("display","block"),ve.style.setProperty("margin-bottom","0.25rem"),ve.style.setProperty("font-size","0.875rem"),ve.style.setProperty("color","var(--text-muted)"),a(ve,()=>e("common.dateFrom","Date From")),a(pe,A(Lt,{type:"date",get value(){return s().start},onInput:Ce=>l({...s(),start:Ce.currentTarget.value})}),null),Ie.style.setProperty("display","block"),Ie.style.setProperty("margin-bottom","0.25rem"),Ie.style.setProperty("font-size","0.875rem"),Ie.style.setProperty("color","var(--text-muted)"),a(Ie,()=>e("common.dateTo","Date To")),a(Ne,A(Lt,{type:"date",get value(){return s().end},onInput:Ce=>l({...s(),end:Ce.currentTarget.value})}),null),ge(()=>U.value=i()),ge(()=>Z.value=S()),ge(()=>Y.value=c()),ge(()=>ye.value=u()),$}}),T),T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),T.style.setProperty("margin-bottom","1rem"),R.style.setProperty("font-size","0.875rem"),R.style.setProperty("color","var(--text-muted)"),a(R,()=>e("common.showing","Showing"),J),a(R,()=>x().length,X),a(R,()=>e("common.of","of"),se),a(R,()=>t.hbls.length,_),a(R,()=>e("hbl.records","records"),null),k.style.setProperty("display","flex"),k.style.setProperty("gap","0.5rem"),a(k,A(ct,{variant:"outline",size:"sm",onClick:E,get children(){return e("common.print","Print")}}),null),a(k,A(ct,{variant:"outline",size:"sm",onClick:W,get children(){return e("common.exportCSV","Export CSV")}}),null),a(k,A(ct,{variant:"outline",size:"sm",onClick:I,get children(){return e("common.exportExcel","Export Excel")}}),null),v}}),w),w.style.setProperty("margin-top","1rem"),a(w,A(vt,{get each(){return x()},children:v=>A(Rt,{style:{"margin-bottom":"0.5rem"},get children(){var j=sR(),z=j.firstChild,T=z.firstChild,R=T.firstChild,J=R.nextSibling,X=T.nextSibling,H=X.firstChild,se=H.firstChild,O=se.nextSibling,_=H.nextSibling,k=_.firstChild,$=k.nextSibling,G=X.nextSibling,ne=G.firstChild,U=ne.nextSibling,D=z.nextSibling,B=D.firstChild,Q=B.firstChild,Z=Q.firstChild,oe=Q.nextSibling,de=B.nextSibling,re=de.firstChild,Y=re.firstChild,ce=re.nextSibling,ue=de.nextSibling,ae=ue.firstChild,ye=ae.firstChild,me=ae.nextSibling,pe=ue.nextSibling,ve=pe.firstChild,Ne=ve.firstChild,Ie=ve.nextSibling,Ce=Ie.firstChild,Ee=pe.nextSibling,we=Ee.firstChild,Re=we.firstChild,He=we.nextSibling,je=Ee.nextSibling,Ve=je.firstChild,qe=Ve.firstChild,tt=Ve.nextSibling;return j.addEventListener("mouseleave",rt=>{rt.currentTarget.style.backgroundColor="transparent"}),j.addEventListener("mouseenter",rt=>{rt.currentTarget.style.backgroundColor="var(--strip-color)"}),j.$$click=()=>t.onHBLSelect?.(v),j.style.setProperty("padding","1rem"),j.style.setProperty("cursor","pointer"),j.style.setProperty("transition","background-color 0.2s"),z.style.setProperty("display","grid"),z.style.setProperty("grid-template-columns","150px 1fr auto"),z.style.setProperty("gap","1rem"),z.style.setProperty("align-items","center"),R.style.setProperty("font-weight","600"),R.style.setProperty("color","var(--primary-color)"),a(R,()=>v.hbl),J.style.setProperty("font-size","0.75rem"),J.style.setProperty("color","var(--text-muted)"),a(J,()=>v.idairguide),X.style.setProperty("display","grid"),X.style.setProperty("grid-template-columns","1fr 1fr"),X.style.setProperty("gap","1rem"),se.style.setProperty("font-size","0.75rem"),se.style.setProperty("color","var(--text-muted)"),a(se,()=>e("hbl.shipper","Shipper")),O.style.setProperty("font-weight","500"),a(O,()=>v.nameshipper),k.style.setProperty("font-size","0.75rem"),k.style.setProperty("color","var(--text-muted)"),a(k,()=>e("hbl.consignee","Consignee")),$.style.setProperty("font-weight","500"),a($,()=>v.consigneeName),G.style.setProperty("text-align","right"),ne.style.setProperty("display","inline-block"),ne.style.setProperty("padding","0.25rem 0.75rem"),ne.style.setProperty("border-radius","var(--border-radius-sm)"),ne.style.setProperty("font-size","0.75rem"),ne.style.setProperty("font-weight","500"),ne.style.setProperty("color","white"),a(ne,()=>v.idguidestate),U.style.setProperty("font-size","0.75rem"),U.style.setProperty("color","var(--text-muted)"),U.style.setProperty("margin-top","0.25rem"),a(U,()=>L(v.datereserve)),D.style.setProperty("margin-top","0.75rem"),D.style.setProperty("display","grid"),D.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),D.style.setProperty("gap","0.5rem"),D.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),a(Q,()=>e("hbl.city","City"),Z),oe.style.setProperty("font-weight","500"),a(oe,()=>v.address.city),re.style.setProperty("color","var(--text-muted)"),a(re,()=>e("hbl.classification","Class"),Y),ce.style.setProperty("font-weight","500"),a(ce,()=>v.idclasification),ae.style.setProperty("color","var(--text-muted)"),a(ae,()=>e("hbl.commodity","Commodity"),ye),me.style.setProperty("font-weight","500"),a(me,()=>v.namegood),ve.style.setProperty("color","var(--text-muted)"),a(ve,()=>e("hbl.weight","Weight"),Ne),Ie.style.setProperty("font-weight","500"),a(Ie,()=>v.weight,Ce),we.style.setProperty("color","var(--text-muted)"),a(we,()=>e("hbl.bagNumber","Bag#"),Re),He.style.setProperty("font-weight","500"),a(He,()=>v.bagnumber),Ve.style.setProperty("color","var(--text-muted)"),a(Ve,()=>e("hbl.guideNo","Guide No."),qe),tt.style.setProperty("font-weight","500"),a(tt,()=>v.guia),ge(rt=>(rt=M(v.idguidestate))!=null?ne.style.setProperty("background-color",rt):ne.style.removeProperty("background-color")),j}})})),P})()};Wt(["click"]);const P_=t=>{const e=/230\d{6}/g,r=t.match(e)||[];return[...new Set(r)]},lR=t=>/^230\d{6}$/.test(t),cR=[{id:"YABA_09",label:"Recogida en Tienda",icon:"market",index:0},{id:"YABA_11",label:"En transito hacia YABA WH",icon:"truck-fast-outline",index:1},{id:"YABA_13",label:"YABA ALMACEN",icon:"store",index:2},{id:"YABA_14",label:"En transito hacia FL",icon:"truck-fast-outline",index:3},{id:"YABA_22",label:"Entrega a la aerolinea",icon:"airplane-takeoff",index:4},{id:"AERO_28",label:"LLegando a AeroVaradero",icon:"airplane-landing",index:5},{id:"AERO_33",label:"Recogida en AeroVaradero",icon:"dolly",index:6},{id:"YABA_46",label:"Transporte HAV",icon:"car-hatchback",tag:"HAV",index:7},{id:"YABA_40",label:"Transporte CAV",icon:"car-hatchback",tag:"CAV",index:7},{id:"YABA_41",label:"Transporte CMG",icon:"car-hatchback",tag:"CMG",index:7},{id:"YABA_42",label:"Transporte HLG",icon:"car-hatchback",tag:"HLG",index:7},{id:"YABA_50",label:"Almacen HAV",icon:"store",tag:"HAV",index:8},{id:"YABA_52",label:"Almacen CAV",icon:"store",tag:"CAV",index:8},{id:"YABA_54",label:"Almacen CMG",icon:"store",tag:"CMG",index:8},{id:"YABA_56",label:"Almacen HLG",icon:"store",tag:"HLG",index:8},{id:"YABA_70",label:"Escaneando por Locaciones",icon:"sort-numeric-ascending",index:9},{id:"YABA_78",label:"En reparto",icon:"moped",index:10},{id:"SSG_147",label:"SSG-47",icon:"sort-numeric-ascending",index:11},{id:"SSG_148",label:"SSG-48",icon:"sort-numeric-ascending",index:12},{id:"SSG_149",label:"SSG-49",icon:"sort-numeric-ascending",index:13},{id:"YABA_99",label:"Entregado",icon:"success",index:99}],dR=async(t,e,r)=>{try{if(!lR(t))return{hbl:t,success:!1,error:"Invalid HBL format. Expected 230XXXXXX"};const n={idguidestate:e,...r&&{notes:r}},i=await ai.updateHBLStatus(t,n);return{hbl:t,success:!0,newStatus:e,previousStatus:i.previousStatus}}catch(n){return{hbl:t,success:!1,error:n instanceof Error?n.message:"Unknown error occurred"}}},uR=async t=>{const e=[];let r=0,n=0;for(const i of t.hbls){const o=await dR(i,t.statusId,t.notes);e.push(o),o.success?r++:n++}return{success:n===0,results:e,totalProcessed:t.hbls.length,totalSuccess:r,totalFailed:n}},hR=async(t,e,r)=>{const n=P_(t);return n.length===0?{success:!1,results:[],totalProcessed:0,totalSuccess:0,totalFailed:0}:uR({hbls:n,statusId:e,notes:r})};var pR=le("<div><h3> <!> HBL(s):</h3><div><div>"),mR=le("<span><span>"),yR=le("<div><h2></h2><div><div><label></label><textarea></textarea><div></div></div><div><label></label><select><option value>-- <!> --</option></select></div><div><label></label><textarea></textarea></div><div><div>"),fR=le(`<style>
        @keyframes spin {
          to { transform: rotate(360deg); }
        }
      `),gR=le("<span>"),vR=le("<option> "),bR=le("<div><h4></h4><div>"),PR=le("<div><h3></h3><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),_R=le("<div>: ");const SR=t=>{const{t:e}=or(),[r,n]=Se(""),[i,o]=Se(""),[s,l]=Se(""),[c,d]=Se([]),[u,h]=Se(!1),[g,m]=Se(null),S=()=>{const V=P_(r());d(V)},N=async()=>{if(!i()||c().length===0){alert(e("hbl.bulkUpdate.selectStatusAndParse","Please select a status and parse HBLs first"));return}h(!0),m(null);try{const V=await hR(r(),i(),s()||void 0);m(V),t.onSuccess&&V.totalSuccess>0&&t.onSuccess(V)}catch(V){console.error("Error updating HBL statuses:",V),alert(e("hbl.bulkUpdate.error","Error updating HBL statuses. Please try again."))}finally{h(!1)}},x=()=>{n(""),o(""),l(""),d([]),m(null)},b={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease",resize:"vertical","min-height":"120px"},K={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},te={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},F={"margin-bottom":"1rem"};return A(Rt,{get children(){return[(()=>{var V=yR(),W=V.firstChild,I=W.nextSibling,E=I.firstChild,L=E.firstChild,M=L.nextSibling,P=M.nextSibling,w=E.nextSibling,v=w.firstChild,j=v.nextSibling,z=j.firstChild,T=z.firstChild,R=T.nextSibling;R.nextSibling;var J=w.nextSibling,X=J.firstChild,H=X.nextSibling,se=J.nextSibling,O=se.firstChild;return V.style.setProperty("padding","1.5rem"),W.style.setProperty("font-size","1.5rem"),W.style.setProperty("font-weight","600"),W.style.setProperty("margin-bottom","1.5rem"),W.style.setProperty("color","var(--text-primary)"),a(W,()=>e("hbl.bulkUpdate.title","Bulk HBL Status Update")),a(L,()=>e("hbl.bulkUpdate.inputLabel","Enter text containing HBL numbers (format: 230XXXXXX)")),M.addEventListener("blur",_=>_.currentTarget.style.borderColor="var(--border-color)"),M.addEventListener("focus",_=>_.currentTarget.style.borderColor="var(--primary-color)"),M.$$input=_=>n(_.currentTarget.value),P.style.setProperty("margin-top","0.75rem"),a(P,A(ct,{onClick:S,variant:"secondary",size:"sm",get children(){return e("hbl.bulkUpdate.parseButton","Parse HBLs")}})),a(I,A(Me,{get when(){return c().length>0},get children(){var _=pR(),k=_.firstChild,$=k.firstChild,G=$.nextSibling;G.nextSibling;var ne=k.nextSibling,U=ne.firstChild;return k.style.setProperty("font-size","1.125rem"),k.style.setProperty("font-weight","500"),k.style.setProperty("margin-bottom","0.75rem"),k.style.setProperty("color","var(--text-primary)"),a(k,()=>e("hbl.bulkUpdate.found","Found"),$),a(k,()=>c().length,G),ne.style.setProperty("background","var(--gray-50)"),ne.style.setProperty("padding","0.75rem"),ne.style.setProperty("border-radius","var(--border-radius-sm)"),ne.style.setProperty("max-height","8rem"),ne.style.setProperty("overflow-y","auto"),U.style.setProperty("display","flex"),U.style.setProperty("flex-wrap","wrap"),U.style.setProperty("gap","0.5rem"),a(U,A(vt,{get each(){return c()},children:D=>(()=>{var B=gR();return B.style.setProperty("padding","0.25rem 0.75rem"),B.style.setProperty("background","var(--primary-light)"),B.style.setProperty("color","white"),B.style.setProperty("border-radius","var(--border-radius-sm)"),B.style.setProperty("font-size","0.875rem"),B.style.setProperty("font-weight","500"),a(B,D),B})()})),ge(D=>p(_,F,D)),_}}),w),a(v,()=>e("hbl.bulkUpdate.selectStatus","Select New Status")),j.addEventListener("blur",_=>_.currentTarget.style.borderColor="var(--border-color)"),j.addEventListener("focus",_=>_.currentTarget.style.borderColor="var(--primary-color)"),j.addEventListener("change",_=>o(_.currentTarget.value)),p(j,K),a(z,()=>e("hbl.bulkUpdate.selectOption","Select Status"),R),a(j,A(vt,{each:cR,children:_=>(()=>{var k=vR(),$=k.firstChild;return a(k,()=>_.label,$),a(k,()=>_.tag?`(${_.tag})`:"",null),ge(()=>k.value=_.id),k})()}),null),a(X,()=>e("hbl.bulkUpdate.notes","Notes (Optional)")),H.addEventListener("blur",_=>_.currentTarget.style.borderColor="var(--border-color)"),H.addEventListener("focus",_=>_.currentTarget.style.borderColor="var(--primary-color)"),H.$$input=_=>l(_.currentTarget.value),se.style.setProperty("display","flex"),se.style.setProperty("justify-content","space-between"),se.style.setProperty("align-items","center"),se.style.setProperty("margin-top","1.5rem"),a(se,A(ct,{onClick:N,get disabled(){return u()||c().length===0||!i()},variant:"primary",get children(){return A(Me,{get when(){return u()},get fallback(){return e("hbl.bulkUpdate.updateButton","Update Statuses")},get children(){var _=mR(),k=_.firstChild;return _.style.setProperty("display","flex"),_.style.setProperty("align-items","center"),k.style.setProperty("display","inline-block"),k.style.setProperty("width","16px"),k.style.setProperty("height","16px"),k.style.setProperty("border","2px solid #fff"),k.style.setProperty("border-top-color","transparent"),k.style.setProperty("border-radius","50%"),k.style.setProperty("animation","spin 0.8s linear infinite"),k.style.setProperty("margin-right","0.5rem"),a(_,()=>e("hbl.bulkUpdate.updating","Updating..."),null),_}})}}),O),O.style.setProperty("display","flex"),O.style.setProperty("gap","0.75rem"),a(O,A(ct,{onClick:x,variant:"secondary",size:"sm",get children(){return e("hbl.bulkUpdate.reset","Reset")}}),null),a(O,A(Me,{get when(){return t.onClose},get children(){return A(ct,{get onClick(){return t.onClose},variant:"outline",size:"sm",get children(){return e("hbl.bulkUpdate.close","Close")}})}}),null),a(I,A(Me,{get when(){return g()},children:_=>(()=>{var k=PR(),$=k.firstChild,G=$.nextSibling,ne=G.firstChild,U=ne.firstChild,D=U.nextSibling,B=ne.nextSibling,Q=B.firstChild,Z=Q.nextSibling,oe=B.nextSibling,de=oe.firstChild,re=de.nextSibling;return k.style.setProperty("margin-top","1.5rem"),k.style.setProperty("padding","1rem"),k.style.setProperty("background","var(--gray-50)"),k.style.setProperty("border-radius","var(--border-radius)"),$.style.setProperty("font-size","1.125rem"),$.style.setProperty("font-weight","500"),$.style.setProperty("margin-bottom","1rem"),$.style.setProperty("color","var(--text-primary)"),a($,()=>e("hbl.bulkUpdate.results","Update Results")),G.style.setProperty("display","grid"),G.style.setProperty("grid-template-columns","repeat(3, 1fr)"),G.style.setProperty("gap","1rem"),G.style.setProperty("margin-bottom","1rem"),ne.style.setProperty("text-align","center"),U.style.setProperty("font-size","1.875rem"),U.style.setProperty("font-weight","700"),U.style.setProperty("color","var(--primary-color)"),a(U,()=>_().totalProcessed),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("color","var(--text-muted)"),a(D,()=>e("hbl.bulkUpdate.totalProcessed","Total Processed")),B.style.setProperty("text-align","center"),Q.style.setProperty("font-size","1.875rem"),Q.style.setProperty("font-weight","700"),Q.style.setProperty("color","var(--success-color)"),a(Q,()=>_().totalSuccess),Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-muted)"),a(Z,()=>e("hbl.bulkUpdate.successful","Successful")),oe.style.setProperty("text-align","center"),de.style.setProperty("font-size","1.875rem"),de.style.setProperty("font-weight","700"),de.style.setProperty("color","var(--danger-color)"),a(de,()=>_().totalFailed),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),a(re,()=>e("hbl.bulkUpdate.failed","Failed")),a(k,A(Me,{get when(){return _().totalFailed>0},get children(){var Y=bR(),ce=Y.firstChild,ue=ce.nextSibling;return Y.style.setProperty("margin-top","1rem"),Y.style.setProperty("padding","0.75rem"),Y.style.setProperty("background","var(--danger-light)"),Y.style.setProperty("border-radius","var(--border-radius-sm)"),ce.style.setProperty("font-weight","500"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("color","var(--danger-dark)"),a(ce,()=>e("hbl.bulkUpdate.failedUpdates","Failed Updates:")),ue.style.setProperty("max-height","8rem"),ue.style.setProperty("overflow-y","auto"),a(ue,A(vt,{get each(){return _().results.filter(ae=>!ae.success)},children:ae=>(()=>{var ye=_R(),me=ye.firstChild;return ye.style.setProperty("font-size","0.875rem"),ye.style.setProperty("color","var(--danger-color)"),ye.style.setProperty("margin-bottom","0.25rem"),a(ye,()=>ae.hbl,me),a(ye,()=>ae.error,null),ye})()})),Y}}),null),k})()}),null),ge(_=>{var k=F,$=te,G=b,ne=e("hbl.bulkUpdate.placeholder","Paste text here. HBL numbers matching 230XXXXXX will be extracted automatically."),U=F,D=te,B=F,Q=te,Z={...b,"min-height":"80px"},oe=e("hbl.bulkUpdate.notesPlaceholder","Add any notes about this status update...");return _.e=p(E,k,_.e),_.t=p(L,$,_.t),_.a=p(M,G,_.a),ne!==_.o&&Jt(M,"placeholder",_.o=ne),_.i=p(w,U,_.i),_.n=p(v,D,_.n),_.s=p(J,B,_.s),_.h=p(X,Q,_.h),_.r=p(H,Z,_.r),oe!==_.d&&Jt(H,"placeholder",_.d=oe),_},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),ge(()=>M.value=r()),ge(()=>j.value=i()),ge(()=>H.value=s()),V})(),fR()]}})};Wt(["input"]);var wR=le("<div><div><label></label><select><option value=all>"),xR=le("<div><div><h2>HBL: </h2><button>×</button></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong><span></span></div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> <!>, </div><div><strong>:</strong> </div><div><strong>:</strong> <!> kg</div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),CR=le("<div>"),AR=le("<div><div><h1></h1><button>"),$R=le("<option> ");const ER=()=>{const{t}=or(),[e,r]=Se([]),[n,i]=Se(null),[o,s]=Se([]),[l,c]=Se("all"),[d,u]=Se(""),h=x=>{i(x)},g=x=>{s(x)},m=x=>{c(x),S()},S=async()=>{if(!d().trim())return null;let x=await ai.getHBLS(d().trim(),{guia:l()});x?.error?r([]):r(Object.values(x))};Ln(()=>{});const N=Nt(()=>{const x=new Set([2516,2517,2518,2519,2520,2521].map(b=>b));return Array.from(x).sort((b,K)=>b-K)});return(()=>{var x=AR(),b=x.firstChild,K=b.firstChild,te=K.nextSibling;return x.style.setProperty("padding","1rem"),b.style.setProperty("margin-bottom","2rem"),b.style.setProperty("display","flex"),b.style.setProperty("justify-content","space-between"),b.style.setProperty("align-items","center"),K.style.setProperty("font-size","1.5rem"),K.style.setProperty("font-weight","600"),K.style.setProperty("color","var(--text-primary)"),a(K,()=>t("hbl.title","House Bill of Lading Management")),te.style.setProperty("padding","0.75rem 1.5rem"),te.style.setProperty("background","var(--primary-color)"),te.style.setProperty("color","white"),te.style.setProperty("border","none"),te.style.setProperty("border-radius","var(--border-radius-sm)"),te.style.setProperty("cursor","pointer"),te.style.setProperty("font-weight","500"),a(te,()=>t("hbl.addNew","Add New HBL")),a(x,A(SR,{}),null),a(x,A(Rt,{get children(){var F=wR(),V=F.firstChild,W=V.firstChild,I=W.nextSibling,E=I.firstChild;return F.style.setProperty("padding","1rem"),V.style.setProperty("width","13rem"),W.style.setProperty("display","block"),W.style.setProperty("margin-bottom","0.25rem"),W.style.setProperty("font-size","0.875rem"),W.style.setProperty("color","var(--text-muted)"),a(W,()=>t("hbl.guideNumber","Guide Number")),I.addEventListener("change",L=>m(L.currentTarget.value)),I.style.setProperty("width","100%"),I.style.setProperty("padding","0.5rem"),I.style.setProperty("border","1px solid var(--border-color)"),I.style.setProperty("border-radius","var(--border-radius-sm)"),I.style.setProperty("background","var(--surface-color)"),a(E,()=>t("common.all","All")),a(I,A(vt,{get each(){return N()},children:L=>(()=>{var M=$R(),P=M.firstChild;return M.value=L,a(M,()=>t("hbl.guideNo","Guide No."),P),a(M,L,null),M})()}),null),a(F,A(Lt,{type:"text",get placeholder(){return t("hbl.searchPlaceholder","Search by HBL#, air guide, shipper, consignee, commodity, bag#, identity...")},get value(){return d()},onChange:L=>u(L)}),null),ge(()=>I.value=l()),F}}),null),a(x,A(aR,{get hbls(){return e()},onFilterChange:g,onHBLSelect:h}),null),a(x,A(Me,{get when(){return n()},get children(){var F=CR();return F.style.setProperty("position","fixed"),F.style.setProperty("top","0"),F.style.setProperty("left","0"),F.style.setProperty("right","0"),F.style.setProperty("bottom","0"),F.style.setProperty("background","rgba(0, 0, 0, 0.5)"),F.style.setProperty("display","flex"),F.style.setProperty("align-items","center"),F.style.setProperty("justify-content","center"),F.style.setProperty("z-index","1000"),a(F,A(Rt,{style:{width:"90%","max-width":"600px","max-height":"90vh","overflow-y":"auto"},get children(){var V=xR(),W=V.firstChild,I=W.firstChild;I.firstChild;var E=I.nextSibling,L=W.nextSibling,M=L.firstChild,P=M.firstChild,w=P.firstChild;P.nextSibling;var v=M.nextSibling,j=v.firstChild,z=j.firstChild;j.nextSibling;var T=v.nextSibling,R=T.firstChild,J=R.firstChild,X=R.nextSibling,H=T.nextSibling,se=H.firstChild,O=se.firstChild;se.nextSibling;var _=H.nextSibling,k=_.firstChild,$=k.firstChild;k.nextSibling;var G=_.nextSibling,ne=G.firstChild,U=ne.firstChild;ne.nextSibling;var D=G.nextSibling,B=D.firstChild,Q=B.firstChild;B.nextSibling;var Z=D.nextSibling,oe=Z.firstChild,de=oe.firstChild;oe.nextSibling;var re=Z.nextSibling,Y=re.firstChild,ce=Y.firstChild;Y.nextSibling;var ue=re.nextSibling,ae=ue.firstChild,ye=ae.firstChild;ae.nextSibling;var me=ue.nextSibling,pe=me.firstChild,ve=pe.firstChild,Ne=pe.nextSibling,Ie=Ne.nextSibling;Ie.nextSibling;var Ce=me.nextSibling,Ee=Ce.firstChild,we=Ee.firstChild;Ee.nextSibling;var Re=Ce.nextSibling,He=Re.firstChild,je=He.firstChild,Ve=He.nextSibling,qe=Ve.nextSibling;qe.nextSibling;var tt=Re.nextSibling,rt=tt.firstChild,Be=rt.firstChild;rt.nextSibling;var Ge=tt.nextSibling,Fe=Ge.firstChild,at=Fe.firstChild;Fe.nextSibling;var lt=Ge.nextSibling,Xe=lt.firstChild,Ct=Xe.firstChild;Xe.nextSibling;var Le=lt.nextSibling,nt=Le.firstChild,We=nt.firstChild;nt.nextSibling;var kt=Le.nextSibling,Et=kt.firstChild,Ot=Et.firstChild;return Et.nextSibling,V.style.setProperty("padding","2rem"),W.style.setProperty("display","flex"),W.style.setProperty("justify-content","space-between"),W.style.setProperty("align-items","center"),W.style.setProperty("margin-bottom","1.5rem"),I.style.setProperty("font-size","1.25rem"),I.style.setProperty("font-weight","600"),a(I,()=>n().hbl,null),E.$$click=()=>i(null),E.style.setProperty("background","none"),E.style.setProperty("border","none"),E.style.setProperty("font-size","1.5rem"),E.style.setProperty("cursor","pointer"),E.style.setProperty("color","var(--text-muted)"),L.style.setProperty("display","grid"),L.style.setProperty("gap","1rem"),a(P,()=>t("hbl.airGuide","Air Guide"),w),a(M,()=>n().idairguide,null),a(j,()=>t("hbl.airNumber","Air Number"),z),a(v,()=>n().idairnumber,null),a(R,()=>t("hbl.status","Status"),J),X.style.setProperty("margin-left","0.5rem"),X.style.setProperty("padding","0.25rem 0.75rem"),X.style.setProperty("border-radius","var(--border-radius-sm)"),X.style.setProperty("font-size","0.875rem"),X.style.setProperty("color","white"),a(X,()=>n().idguidestate),a(se,()=>t("hbl.classification","Classification"),O),a(H,()=>n().idclasification,null),a(k,()=>t("hbl.shipper","Shipper"),$),a(_,()=>n().nameshipper,null),a(ne,()=>t("hbl.shipperPhone","Shipper Phone"),U),a(G,()=>n().phoneshipper,null),a(B,()=>t("hbl.consignee","Consignee"),Q),a(D,()=>n().consigneeName,null),a(oe,()=>t("hbl.consigneePhone","Consignee Phone"),de),a(Z,()=>n().ctelephone,null),a(Y,()=>t("hbl.identity","Identity"),ce),a(re,()=>n().cidentity,null),a(ae,()=>t("hbl.address","Address"),ye),a(ue,()=>n().street,null),a(pe,()=>t("hbl.city","City"),ve),a(me,()=>n().address.city,Ie),a(me,()=>n().address.estate,null),a(Ee,()=>t("hbl.commodity","Commodity"),we),a(Ce,()=>n().namegood,null),a(He,()=>t("hbl.weight","Weight"),je),a(Re,()=>n().weight,qe),a(rt,()=>t("hbl.quantity","Quantity"),Be),a(tt,()=>n().quantity,null),a(Fe,()=>t("hbl.bagNumber","Bag Number"),at),a(Ge,()=>n().bagnumber,null),a(Xe,()=>t("hbl.agency","Agency"),Ct),a(lt,()=>n().agency,null),a(nt,()=>t("hbl.guide","Guide"),We),a(Le,()=>n().guia,null),a(Et,()=>t("hbl.reserveDate","Reserve Date"),Ot),a(kt,()=>new Date(n().datereserve).toLocaleDateString(),null),ge(jt=>(jt=n().idguidestate==="ENTREGADO"?"#28a745":n().idguidestate==="ENVIADO"?"#17a2b8":n().idguidestate==="EN BODEGA"?"#007bff":"#6c757d")!=null?X.style.setProperty("background-color",jt):X.style.removeProperty("background-color")),V}})),F}}),null),x})()};Wt(["click"]);var IR=le("<div>$124,350"),TR=le("<div>+12% from last month"),kR=le("<div>247"),dc=le("<div>"),NR=le("<div>18"),LR=le("<div>$89,250"),RR=le("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const DR=()=>{const{t}=or(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},n={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)",margin:"0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"};return A(oo,{get title(){return t("dashboard.title")},get children(){return[(()=>{var o=dc();return p(o,e),a(o,A(Rt,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var s=IR();return ge(l=>p(s,n,l)),s})(),(()=>{var s=TR();return ge(l=>p(s,i,l)),s})()]}}),null),a(o,A(Rt,{get title(){return t("dashboard.employeeCount")},get subtitle(){return t("dashboard.current")},get children(){return[(()=>{var s=kR();return ge(l=>p(s,n,l)),s})(),(()=>{var s=dc();return a(s,()=>t("dashboard.newHires")),ge(l=>p(s,i,l)),s})()]}}),null),a(o,A(Rt,{get title(){return t("dashboard.pendingInvoices")},get subtitle(){return t("dashboard.outstanding")},get children(){return[(()=>{var s=NR();return ge(l=>p(s,n,l)),s})(),(()=>{var s=dc();return a(s,()=>t("dashboard.totalOutstanding")),ge(l=>p(s,i,l)),s})()]}}),null),a(o,A(Rt,{get title(){return t("dashboard.cashBalance")},get subtitle(){return t("accounts.title")},get children(){return[(()=>{var s=LR();return ge(l=>p(s,n,l)),s})(),(()=>{var s=dc();return a(s,()=>t("dashboard.lastUpdatedToday")),ge(l=>p(s,i,l)),s})()]}}),null),o})(),(()=>{var o=dc();return p(o,r),a(o,A(Rt,{get title(){return t("dashboard.quickActions")},get subtitle(){return t("dashboard.commonTasks")},get children(){var s=dc();return s.style.setProperty("display","flex"),s.style.setProperty("flex-direction","column"),s.style.setProperty("gap","1rem"),a(s,A(ct,{variant:"primary",get children(){return t("invoices.createNew")}}),null),a(s,A(ct,{variant:"secondary",get children(){return t("employees.addEmployee")}}),null),a(s,A(ct,{variant:"outline",get children(){return t("dashboard.generateReport")}}),null),s}}),null),a(o,A(Rt,{get title(){return t("dashboard.recentActivity")},get subtitle(){return t("dashboard.latestUpdates")},get children(){var s=RR(),l=s.firstChild,c=l.firstChild,d=c.nextSibling,u=l.nextSibling,h=u.firstChild,g=h.nextSibling,m=u.nextSibling,S=m.firstChild,N=S.nextSibling;return s.style.setProperty("display","flex"),s.style.setProperty("flex-direction","column"),s.style.setProperty("gap","0.75rem"),l.style.setProperty("border-bottom","1px solid var(--border-color)"),l.style.setProperty("padding-bottom","0.5rem"),c.style.setProperty("font-weight","500"),a(c,()=>t("dashboard.invoicePaid")),d.style.setProperty("font-size","0.875rem"),d.style.setProperty("color","var(--text-muted)"),a(d,()=>t("dashboard.hoursAgo")),u.style.setProperty("border-bottom","1px solid var(--border-color)"),u.style.setProperty("padding-bottom","0.5rem"),h.style.setProperty("font-weight","500"),a(h,()=>t("dashboard.newEmployeeOnboarded")),g.style.setProperty("font-size","0.875rem"),g.style.setProperty("color","var(--text-muted)"),a(g,()=>t("dashboard.dayAgo")),S.style.setProperty("font-weight","500"),a(S,()=>t("dashboard.monthlyReportGenerated")),N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),a(N,()=>t("dashboard.daysAgo")),s}}),null),o})(),A(Me,{get when(){return Gt.hasPermission("invoiceAccess")},get children(){return A(_7,{})}})]}})};var Y1=le("<div>"),MR=le("<div><div><div><strong>Display Name:</strong> </div><div><strong>UID:</strong> </div></div><div><strong>Created:</strong> "),FR=le("<div><h3>Store Access</h3><div></div><div>No store access granted"),OR=le("<div><select><option value=all>"),BR=le("<div><h3>Permissions</h3><div>"),VR=le('<div><div><input type=text placeholder="Search users..."></div><div>'),jR=le("<div>⚠️ You need administrator privileges to access this page."),zR=le("<div>Loading users..."),qR=le("<div><div></div><div></div><div> stores"),UR=le("<div>Select a user to view and edit their profile"),HR=le("<div><input type=checkbox><label>"),GR=le("<option>"),WR=le("<div><input type=checkbox><div><div></div><div>");const YR=()=>{const{t}=or(),[e,r]=Se([]),[n,i]=Se(null),[o,s]=Se(!1),[l,c]=Se(!1),[d,u]=Se(""),[h,g]=Se(null),m=[{id:"YY_8802",name:"Store 8802"},{id:"YY_8803",name:"Store 8803"},{id:"YY_8804",name:"Store 8804"},{id:"YY_8805",name:"Store 8805"},{id:"YY_8816",name:"Store 8816"},{id:"YY_8818",name:"Store 8818"},{id:"YY_8847",name:"Store 8847"},{id:"YY_3251",name:"Store 3251"},{id:"YY_32",name:"Store 32"},{id:"YY_76",name:"Store 76"},{id:"YY_2376",name:"Store 2376"},{id:"YY_79",name:"Store 79"},{id:"YY_8635",name:"Store 8635"},{id:"YY_8665",name:"Store 8665"},{id:"YY_8901",name:"Store 8901"},{id:"YY_3303",name:"Store Miami"},{id:"SS_42",name:"SS"}],S=[{key:"AccountAccess",label:"Account Access",description:"Access to accounting features"},{key:"BankingAccess",label:"Banking Access",description:"Access to banking operations"},{key:"InventoryAccess",label:"Inventory Access",description:"Access to inventory management"},{key:"JournalAccess",label:"Journal Access",description:"Access to journal entries"},{key:"invoiceAccess",label:"Invoice Access",description:"Access to Invoices"},{key:"HBLAccess",label:"HBL Access",description:"Access to HBL management"},{key:"PassportAccess",label:"Passport Access",description:"Access to passport applications"},{key:"inventoryDownsection",label:"Inventory Downsection",description:"Access to inventory downsection"},{key:"onlyRead",label:"Read Only",description:"Limited to read-only access"},{key:"read_write",label:"Read/Write",description:"Full read and write permissions"},{key:"isAdmin",label:"Administrator",description:"Full system administration rights"}];let N={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_2376:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1,YY_3303:!1,SS_42:!1},businessId:"YB100423253156428",AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,invoiceAccess:!1,HBLAccess:!1,PassportAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1},x=[{label:"Stephanie S",id:"SS695841584167881"},{label:"YABA",id:"YB100423253156428"},{label:"GUANCHO",id:"JJCM23753J15918M"},{label:"LUISCUETO",id:"LMR470531564CT28"}];Ln(async()=>{await b()});const b=async()=>{try{s(!0);const T=fP(Fc,"users"),R=wP(T,xP("createdAt","desc")),J=await EP(R),X=[];J.forEach(H=>{let se=H.data();Object.keys(N).map(O=>{let _=N?.[O];se.hasOwnProperty(O)||(se[O]=_)}),X.push({uid:H.id,...se})}),r(X)}catch(T){console.error("Error loading users:",T),g({type:"error",text:"Failed to load users"})}finally{s(!1)}},K=Nt(()=>{const T=d().toLowerCase();return T?e().filter(R=>R.email?.toLowerCase().includes(T)||R.displayName?.toLowerCase().includes(T)||R.uid?.toLowerCase().includes(T)):e()}),te=T=>{n()&&i(R=>({...R,stores:{...R.stores,[T]:!R.stores[T]}}))},F=T=>{n()&&i(R=>({...R,businessId:T}))},V=T=>{n()&&i(R=>({...R,[T]:!R[T]}))};Nt(()=>n()?n().stores&&Object.values(n().stores).some(T=>T):!1);const W=async()=>{if(n())try{c(!0),g(null);const T=Dp(Fc,"users",n().uid);let R={stores:n().stores,AccountAccess:n().AccountAccess,BankingAccess:n().BankingAccess,InventoryAccess:n().InventoryAccess,invoiceAccess:n().invoiceAccess,JournalAccess:n().JournalAccess,inventoryDownsection:n().inventoryDownsection,onlyRead:n().onlyRead,read_write:n().read_write,businessId:n().businessId,isAdmin:n().isAdmin||!1};await IP(T,R),r(J=>J.map(X=>X.uid===n().uid?n():X)),g({type:"success",text:"User profile updated successfully"})}catch(T){console.error("Error saving user profile:",T),g({type:"error",text:"Failed to save user profile"})}finally{c(!1)}},I={display:"grid","grid-template-columns":"350px 1fr",gap:"2rem",height:"calc(100vh - 200px)"},E={"max-height":"100%","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)",background:"var(--surface-color)"},L=T=>({padding:"1rem","border-bottom":"1px solid var(--border-color)",cursor:"pointer",background:T?"var(--primary-color-light)":"transparent",transition:"background 0.2s"}),M={padding:"0.75rem",border:"none","border-bottom":"1px solid var(--border-color)",background:"var(--surface-color)",width:"100%","font-size":"1rem"},P={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem"},w={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.75rem"},v={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",transition:"all 0.2s"},j=T=>({padding:"1rem","margin-bottom":"1rem","border-radius":"var(--border-radius)",background:T==="success"?"#d4edda":"#f8d7da",color:T==="success"?"#155724":"#721c24",border:`1px solid ${T==="success"?"#c3e6cb":"#f5c6cb"}`}),z=Nt(()=>Gt.state.profile?.isAdmin===!0);return A(oo,{title:"User Profile Administration",get children(){return A(Me,{get when(){return z()},get fallback(){return A(Rt,{get children(){var T=jR();return T.style.setProperty("text-align","center"),T.style.setProperty("padding","2rem"),T.style.setProperty("color","var(--text-muted)"),T}})},get children(){var T=VR(),R=T.firstChild,J=R.firstChild,X=R.nextSibling;return p(T,I),p(R,E),J.$$input=H=>u(H.currentTarget.value),p(J,M),a(R,A(Me,{get when(){return!o()},get fallback(){return(()=>{var H=zR();return H.style.setProperty("padding","2rem"),H.style.setProperty("text-align","center"),H})()},get children(){return A(vt,{get each(){return K()},children:H=>(()=>{var se=qR(),O=se.firstChild,_=O.nextSibling,k=_.nextSibling,$=k.firstChild;return se.$$click=()=>i(H),O.style.setProperty("font-weight","600"),a(O,()=>H.displayName||"No Name"),_.style.setProperty("font-size","0.875rem"),_.style.setProperty("color","var(--text-muted)"),a(_,()=>H.email),k.style.setProperty("font-size","0.75rem"),k.style.setProperty("color","var(--text-muted)"),k.style.setProperty("margin-top","0.25rem"),a(k,()=>H.isAdmin&&"👑 Admin • ",$),a(k,()=>Object.values(H.stores||{}).filter(Boolean).length,$),ge(G=>p(se,L(n()?.uid===H.uid),G)),se})()})}}),null),a(X,A(Me,{get when(){return n()},get fallback(){return A(Rt,{get children(){var H=UR();return H.style.setProperty("text-align","center"),H.style.setProperty("padding","2rem"),H.style.setProperty("color","var(--text-muted)"),H}})},get children(){return[A(Me,{get when(){return h()},get children(){var H=Y1();return a(H,()=>h().text),ge(se=>p(H,j(h().type),se)),H}}),A(Rt,{title:"User Information",get subtitle(){return n().email},get children(){return[(()=>{var H=MR(),se=H.firstChild,O=se.firstChild,_=O.firstChild;_.nextSibling;var k=O.nextSibling,$=k.firstChild;$.nextSibling;var G=se.nextSibling,ne=G.firstChild;return ne.nextSibling,H.style.setProperty("margin-bottom","2rem"),se.style.setProperty("display","flex"),se.style.setProperty("justify-content","space-between"),se.style.setProperty("margin-bottom","1rem"),a(O,()=>n().displayName||"Not set",null),a(k,()=>n().uid,null),a(G,()=>new Date(n().createdAt?.toDate?.()||n().createdAt).toLocaleDateString(),null),H})(),(()=>{var H=FR(),se=H.firstChild,O=se.nextSibling,_=O.nextSibling;return H.style.setProperty("margin-bottom","2rem"),se.style.setProperty("margin-bottom","1rem"),p(O,w),a(O,A(vt,{each:m,children:k=>{let $=gt.getLocationById(k?.id);return(()=>{var G=HR(),ne=G.firstChild,U=ne.nextSibling;return G.$$click=()=>te(k?.id),ne.style.setProperty("cursor","pointer"),U.style.setProperty("cursor","pointer"),U.style.setProperty("user-select","none"),a(U,()=>$?.name),ge(D=>p(G,{...v,background:n().stores?.[k?.id]?"var(--primary-color-light)":"transparent"},D)),ge(()=>ne.checked=n().stores?.[k?.id]||!1),G})()}})),_.style.setProperty("margin-top","0.5rem"),_.style.setProperty("font-size","0.875rem"),_.style.setProperty("color","var(--text-muted)"),H})(),(()=>{var H=OR(),se=H.firstChild,O=se.firstChild;return H.style.setProperty("margin-bottom","2rem"),se.addEventListener("change",_=>F(_.currentTarget.value)),se.style.setProperty("width","100%"),se.style.setProperty("padding","0.5rem"),se.style.setProperty("border","1px solid var(--border-color)"),se.style.setProperty("border-radius","var(--border-radius-sm)"),se.style.setProperty("background","var(--surface-color)"),a(O,()=>t("common.all","All")),a(se,A(vt,{each:x,children:_=>(()=>{var k=GR();return a(k,()=>_?.label),ge(()=>k.value=_.id),k})()}),null),ge(()=>se.value=n()?.businessId),H})(),(()=>{var H=BR(),se=H.firstChild,O=se.nextSibling;return H.style.setProperty("margin-bottom","2rem"),se.style.setProperty("margin-bottom","1rem"),p(O,P),a(O,A(vt,{each:S,children:_=>(()=>{var k=WR(),$=k.firstChild,G=$.nextSibling,ne=G.firstChild,U=ne.nextSibling;return k.$$click=()=>V(_.key),$.style.setProperty("cursor","pointer"),G.style.setProperty("flex","1"),G.style.setProperty("cursor","pointer"),G.style.setProperty("user-select","none"),ne.style.setProperty("font-weight","500"),a(ne,()=>_.label),U.style.setProperty("font-size","0.75rem"),U.style.setProperty("color","var(--text-muted)"),a(U,()=>_.description),ge(D=>p(k,{...v,background:n()[_.key]?"var(--primary-color-light)":"transparent"},D)),ge(()=>$.checked=!!n()[_.key]),k})()})),H})(),(()=>{var H=Y1();return H.style.setProperty("display","flex"),H.style.setProperty("gap","1rem"),H.style.setProperty("justify-content","flex-end"),a(H,A(ct,{variant:"secondary",onClick:()=>i(null),children:"Cancel"}),null),a(H,A(ct,{variant:"primary",onClick:W,get disabled(){return l()},get children(){return l()?"Saving...":"Save Changes"}}),null),H})()]}})]}})),ge(()=>J.value=d()),T}})}})};Wt(["input","click"]);const KR={common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",close:"Close",search:"Search",filter:"Filter",reset:"Reset",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",actions:"Actions",status:"Status",active:"Active",inactive:"Inactive",date:"Date",time:"Time",description:"Description",notes:"Notes",amount:"Amount",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Language",english:"English",spanish:"Spanish",noDataFound:"No data found",required:"Required",optional:"Optional",all:"All",none:"None",select:"Select",clear:"Clear",view:"View",unknown:"Unknown",details:"Details",notAvailable:"N/A",download:"Download",upload:"Upload",print:"Print",export:"Export",import:"Import",exportCSV:"Export CSV",exportExcel:"Export Excel",showing:"Showing",of:"of",dateFrom:"Date From",dateTo:"Date To",showFilters:"Show Filters",hideFilters:"Hide Filters",clearFilters:"Clear Filters",searching:"Searching...",refresh:"Refresh",showAll:"Show All",products:"products",filtered:"Filtered",suggested:"Suggested",enhanced:"Enhanced",legacy:"Legacy",email:"Email",phone:"Phone",address:"Address",name:"Name",code:"Code",category:"Category",type:"Type",quantity:"Quantity",price:"Price",cost:"Cost",value:"Value",balance:"Balance",created:"Created",modified:"Modified",summary:"Summary",history:"History",new:"New",addNew:"Add New",remove:"Remove",startDate:"Start Date",endDate:"End Date",from:"From",invoice:"Invoice",invoices:"invoices",reference:"Reference",createdBy:"Created By",units:"units",invoiceDocumentId:"Invoice/Document ID",referenceNumber:"Reference Number",referenceNumberPlaceholder:"Enter reference number...",generalNotes:"General Notes",auto:"Auto",optionalNotes:"Optional notes...",showPerPage:"Show per page",first:"First",last:"Last",store:"Store",orderId:"Order ID",tax:"Tax",paymentMethods:"Payment Methods",cash:"Cash",creditCard:"Credit Card",shipping:"Shipping",air:"Air",sea:"Sea",thankYouBusiness:"Thank you for your business!",thankForChoosingUs:"Thank you for choosing us!",taxExemptNote:"Tax exempted on cash payment.",youSaved:"You saved",generatedOn:"Generated on",printSavePDF:"Print / Save as PDF",pageOfPages:"Page {{current}} of {{total}}",showingXofY:"Showing {{start}}-{{end}} of {{total}}",page:"Page",pending:"Pending",completed:"Completed",customer:"Customer",location:"Location",reservations:"Reservations",backToDashboard:"Back to Dashboard",lbs:"pounds"},navigation:{dashboard:"Dashboard",accounts:"Chart of Accounts",balanceSheet:"Balance Sheet",inventory:"Inventory",inventoryManagement:"Inventory Management",employees:"Employees",employeeManagement:"Employee Management",entryBooks:"Entry Books",journalEntries:"Journal Entries",consolidate:"Bank Consolidation",reports:"Reports",settings:"Settings",logout:"Logout",home:"Home",hbl:"House Bill of Lading"},dashboard:{title:"Dashboard",welcome:"Welcome to HRM Finance",overview:"Overview",recentActivity:"Recent Activity",quickActions:"Quick Actions",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalEquity:"Total Equity",totalRevenue:"Total Revenue",totalExpenses:"Total Expenses",netIncome:"Net Income",cashBalance:"Cash Balance",accountsReceivable:"Accounts Receivable",accountsPayable:"Accounts Payable",inventoryValue:"Inventory Value",lowStockItems:"Low Stock Items",pendingInvoices:"Pending Invoices",employeeCount:"Employee Count",monthlyPayroll:"Monthly Payroll"},accounts:{title:"Chart of Accounts",accountNumber:"Account Number",accountName:"Account Name",accountType:"Account Type",category:"Category",balance:"Balance",parentAccount:"Parent Account",subAccounts:"Sub-accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",transactions:"Transactions",accountHistory:"Account History",types:{asset:"Asset",liability:"Liability",equity:"Equity",revenue:"Revenue",expense:"Expense"},categories:{currentAssets:"Current Assets",fixedAssets:"Fixed Assets",currentLiabilities:"Current Liabilities",longTermLiabilities:"Long-term Liabilities",ownersEquity:"Owner's Equity",operatingRevenue:"Operating Revenue",operatingExpenses:"Operating Expenses"},allAccounts:"All Accounts"},banking:{title:"Banking",unreconciled:"Unreconciled",reconciled:"Reconciled",reconciliation:"Reconciliation",notReconciled:"Not Reconciled"},balanceSheet:{title:"Balance Sheet",asOf:"As of",assets:"Assets",liabilities:"Liabilities",equity:"Equity",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalEquity:"Total Equity",currentAssets:"Current Assets",nonCurrentAssets:"Non-current Assets",currentLiabilities:"Current Liabilities",nonCurrentLiabilities:"Non-current Liabilities",retainedEarnings:"Retained Earnings",commonStock:"Common Stock",generateReport:"Generate Report",exportPDF:"Export PDF",exportExcel:"Export Excel"},inventory:{title:"Inventory Management",products:"Products",locations:"Locations",movements:"Movements",overview:"Overview",addProduct:"Add Product",addLocation:"Add Location",addMovement:"Add Movement",bulkMovement:"Bulk Movement",productName:"Product Name",productCode:"Product Code",sku:"SKU",category:"Category",quantity:"Quantity",unitOfMeasure:"Unit of Measure",unitCost:"Unit Cost",totalValue:"Total Value",minStockLevel:"Min Stock Level",maxStockLevel:"Max Stock Level",reorderPoint:"Reorder Point",locationName:"Location Name",locationType:"Location Type",locationCode:"Location Code",address:"Address",movementType:"Movement Type",fromLocation:"From Location",toLocation:"To Location",referenceNumber:"Reference Number",invoiceNumber:"Invoice Number",stockIn:"Stock In",stockOut:"Stock Out",transfer:"Transfer",adjustment:"Adjustment",inStock:"In Stock",lowStock:"Low Stock",outOfStock:"Out of Stock",stockLevels:"Stock Levels",stockByLocation:"Stock by Location",recentMovements:"Recent Movements",searchProducts:"Search products...",searchLocations:"Search locations...",noMovements:"No movements found",productDetails:"Product Details",locationDetails:"Location Details",movementDetails:"Movement Details",totalProducts:"Total Products",activeProducts:"Active Products",totalLocations:"Total Locations",activeLocations:"Active Locations",lowStockAlert:"Low Stock Alert",productsNeedRestocking:"products need restocking",lastSeen:"Last seen",noProducts:"No products at this location",warehouseType:"Warehouse",storeType:"Store",supplierType:"Supplier",customerType:"Customer"},employees:{title:"Employee Management",employeeList:"Employee List",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",payrollInfo:"Payroll Information",firstName:"First Name",lastName:"Last Name",fullName:"Full Name",email:"Email",phone:"Phone",address:"Address",dateOfBirth:"Date of Birth",employeeId:"Employee ID",department:"Department",position:"Position",hireDate:"Hire Date",employmentStatus:"Employment Status",salary:"Salary",payFrequency:"Pay Frequency",taxId:"Tax ID",bankAccount:"Bank Account",emergencyContact:"Emergency Contact",activeEmployees:"Active Employees",inactiveEmployees:"Inactive Employees",totalPayroll:"Total Payroll",searchEmployees:"Search employees..."},journal:{title:"Journal Entries",entryNumber:"Entry Number",entryDate:"Entry Date",debit:"Debit",credit:"Credit",account:"Account",memo:"Memo",reference:"Reference",createEntry:"Create Entry",editEntry:"Edit Entry",deleteEntry:"Delete Entry",addEntry:"Add Journal Entry",updateEntry:"Update Entry",saveAsDraft:"Save as Draft",post:"Post",postEntry:"Post Entry",voidEntry:"Void Entry",posted:"Posted",draft:"Draft",reversed:"Reversed",balanced:"Balanced",notBalanced:"Not Balanced",outOfBalance:"Out of Balance",unbalanced:"Unbalanced",recurringEntry:"Recurring Entry",attachments:"Attachments",draftEntry:"Draft Entry",postedEntry:"Posted Entry",totalDebits:"Total Debits",totalCredits:"Total Credits",totalDebit:"Total Debit",totalCredit:"Total Credit",totalAmount:"Total Amount",debitShort:"Dr.",creditShort:"Cr.",allEntries:"All Entries",noReference:"No reference",createdBy:"By",lines:"Lines",entryLines:"Journal Entry Lines",journalLines:"Journal Lines",addLine:"Add Line",lineDescription:"Line description",accountLines:"Account Lines",noDescription:"No description",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",balanceStatus:"Balance Status",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",fixBalance:"Fix Balance",editEntryTooltip:"Edit this journal entry",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",draftEntryDescription:"This entry can be edited and posted.",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",entryMustBeBalanced:"Entry must be balanced to post",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",entryNotBalancedShort:"Entry is not balanced",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",minTwoLinesRequired:"At least 2 line items are required",entryNotBalanced:"Entry is not balanced. Debit: ${debit}, Credit: ${credit}",lineAccountRequired:"Line {lineNumber}: Account is required",lineAmountRequired:"Line {lineNumber}: Either debit or credit amount must be provided",lineBothAmounts:"Line {lineNumber}: Cannot have both debit and credit amounts",enterEntryDescription:"Enter journal entry description",enterReferenceNumber:"Enter reference number",quickEntry:"Quick Journal Entry",selectCategory:"Select Category",selectTemplate:"Select Template",chooseCategory:"Choose a category...",chooseTemplate:"Choose a template...",enterAmounts:"Enter Amounts",entryPreview:"Entry Preview",createQuickEntry:"Create Quick Entry",templateRequired:"Please select a template",amountRequired:"Amount is required for {field}",templates:"Templates",manageTemplates:"Manage Templates",addNewTemplate:"Add New Template",templateDetails:"Template Details",newTemplate:"New Template",editTemplate:"Edit Template",templateName:"Template Name",enterTemplateName:"Enter template name",enterTemplateDescription:"Enter template description",category:"Category",templateLines:"Template Lines",type:"Type",amountType:"Amount Type",fieldName:"Field Name",selectAccount:"Select account...",variable:"Variable",fixed:"Fixed",fieldNamePlaceholder:"e.g., Amount",custom:"Custom",templateNameRequired:"Template name is required",templateDescriptionRequired:"Template description is required",lineDescriptionRequired:"Line {lineNumber}: Description is required",amountFieldNameRequired:"Line {lineNumber}: Amount field name is required",confirmDeleteTemplate:"Are you sure you want to delete this template?",selectTemplateToView:"Select a template from the list to view details",orCreateNew:"or create a new custom template",reconciliationSummary:"Reconciliation Summary",totalLines:"Total Lines",bankAccounts:"Bank Accounts",bankReconciled:"Bank Reconciled",bankPending:"Bank Pending",reconciledLines:"Reconciled Lines",unreconciledLines:"Unreconciled Lines",fullyReconciled:"Fully Reconciled",partiallyReconciled:"Partially Reconciled",unreconciled:"Unreconciled",reconciled:"Reconciled",pending:"Pending",matched:"Matched",manual:"Manual",pendingBankReconciliation:"Pending Bank Reconciliation",visitBankConsolidations:"Visit Bank Consolidations to reconcile these transactions",reconciliationTip:"Reconciliation Tip",unreconciledBankTransactions:"This entry has unreconciled bank account transactions.",bankAccount:"bank account",currentUser:"Current User",errorDeletingTemplate:"Error deleting template",errorSavingTemplate:"Error saving template",noLines:"No lines",noTemplateLines:"No template lines"},invoiceReport:{title:"Invoice Resume Report",filters:"Filters",storeLocation:"Store Location",allStores:"All Stores",fromDate:"From Date",toDate:"To Date",paymentMethod:"Payment Method",allMethods:"All Methods",cash:"Cash",zelle:"Zelle",other:"Other",shippingType:"Shipping Type",allTypes:"All Types",maritime:"🚢 Maritime",air:"✈️ Air",generateReport:"Generate Report",loading:"Loading...",print:"🖨️ Print",exportPdf:"📄 Export PDF",generating:"📄 Generating...",close:"Close",invoiceSummary:"Invoice Summary",totalInvoices:"Total Invoices",dateRange:"Date Range",store:"Store",shippingTypeLabel:"Shipping Type",notSet:"Not Set",paymentMethods:"Payment Methods",total:"Total",additionalCharges:"Additional Charges",transport:"Transport",aranceles:"Aranceles",tax:"Tax",productsSummary:"Products Summary",productType:"Product Type",quantity:"Quantity",totalValue:"Total Value",avgPrice:"Avg Price",reservasSummary:"Reservas Summary (Grouped by Price)",reservaType:"Reserva Type",totalQtyLbs:"Total Qty (lbs)",priceGroups:"Price Groups (Price → Qty)",otherServicesTitle:"Other Services & Charges",serviceType:"Service Type",totalOtherServices:"Total Other Services",totalSummary:"Total Summary",productsTotal:"Products Total",reservasTotal:"Reservas Total",transportServices:"Transport & Services",grandTotal:"GRAND TOTAL",invoiceReferences:"Invoice References",type:"Type",pricePerPound:"Price per pound",totalInvoicesCount:"Total invoices",invoiceNumbers:"Invoice Numbers",copyInvoiceNumbers:"📋 Copy Invoice Numbers",reportPeriod:"Report Period",allTimeReport:"All Time Report",generatedOn:"Generated on",generatingReport:"Generating report...",pdfGenerationFailed:"PDF generation failed. Using print instead.",invoiceNumbersCopied:"Invoice numbers copied to clipboard!",allTypesOption:"All Types",seaOption:"🚢 Maritime",airOption:"✈️ Air",allMethodsOption:"All Methods",cashOption:"Cash",zelleOption:"Zelle",otherOption:"Other",pdf:{title:"Invoice Resume Report",subtitle:"Comprehensive Financial Summary",paymentMethodsSummary:"Payment Methods Summary",productsSummary:"Products Summary",reservasSummary:"Reservas Summary (Grouped by Price)",otherServicesTitle:"Other Services & Charges",totalSummary:"Total Summary",paymentMethod:"Payment Method",amount:"Amount",product:"Product",quantity:"Quantity",total:"Total",type:"Type",totalQty:"Total Qty",priceGroups:"Price Groups",serviceType:"Service Type",productsTotal:"Products Total",reservasTotal:"Reservas Total",transportServices:"Transport & Services",grandTotal:"GRAND TOTAL",generatedOn:"Generated on:",all:"All",reportDate:"Report Date:",dateRange:"Date Range:",totalInvoices:"Total Invoices:",allTypes:"All Types",lbs:"lbs",page:"Page",of:"of"}},entryBooks:{title:"Entry Books",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",details:"Details",journalLines:"Journal Lines",balanceStatus:"Balance Status",unbalanced:"Unbalanced",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",postEntry:"Post Entry",fixBalance:"Fix Balance",draftEntry:"Draft Entry",draftEntryDescription:"This entry can be edited and posted.",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",postedEntry:"Posted Entry",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",editEntryTooltip:"Edit this journal entry",entryMustBeBalanced:"Entry must be balanced to post",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",post:"Post",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",voidEntry:"Void Entry",entryNotBalanced:"Entry Not Balanced",reconciliationSummary:"Reconciliation Summary",totalLines:"Total Lines",bankAccounts:"Bank Accounts",bankReconciled:"Bank Reconciled",bankPending:"Bank Pending",reconciledLines:"Reconciled Lines",manual:"Manual",pendingBankReconciliation:"Pending Bank Reconciliation",visitBankConsolidations:"Visit Bank Consolidations to reconcile these transactions",reconciliationTip:"Reconciliation Tip",unreconciledBankTransactions:"This entry has unreconciled bank account transactions.",unreconciledLines:"Unreconciled Lines",fullyReconciled:"Fully Reconciled",partiallyReconciled:"Partially Reconciled",unreconciled:"Unreconciled",reconciled:"Reconciled",pending:"Pending",matched:"Matched",noDescription:"No description",bankAccount:"bank account",currentUser:"Current User",errorDeletingTemplate:"Error deleting template",errorSavingTemplate:"Error saving template",noLines:"No lines",noTemplateLines:"No template lines"},consolidation:{title:"Bank Consolidation",bankAccount:"Bank Account",statementDate:"Statement Date",beginningBalance:"Beginning Balance",endingBalance:"Ending Balance",deposits:"Deposits",withdrawals:"Withdrawals",bankCharges:"Bank Charges",interest:"Interest",reconcile:"Reconcile",matched:"Matched",unmatched:"Unmatched",importStatement:"Import Statement",manualEntry:"Manual Entry",autoMatch:"Auto Match",clearAll:"Clear All",reconciliationStatus:"Reconciliation Status",difference:"Difference",bookBalance:"Book Balance",statementBalance:"Statement Balance",outstandingChecks:"Outstanding Checks",depositsInTransit:"Deposits in Transit"},forms:{requiredField:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",minLength:"Minimum length is",maxLength:"Maximum length is",minValue:"Minimum value is",maxValue:"Maximum value is",passwordMismatch:"Passwords do not match",selectOption:"Please select an option",enterValue:"Please enter a value",confirmDelete:"Are you sure you want to delete this item?",unsavedChanges:"You have unsaved changes. Do you want to continue?",saveSuccess:"Saved successfully",saveError:"Error saving data",deleteSuccess:"Deleted successfully",deleteError:"Error deleting item",descriptionRequired:"Description is required",errorOccurred:"An error occurred",errorPostingEntry:"An error occurred while posting the entry"},reports:{title:"Reports",incomeStatement:"Income Statement",balanceSheet:"Balance Sheet",cashFlow:"Cash Flow Statement",trialBalance:"Trial Balance",generalLedger:"General Ledger",accountsReceivable:"Accounts Receivable",accountsPayable:"Accounts Payable",inventoryReport:"Inventory Report",payrollReport:"Payroll Report",taxReport:"Tax Report",customReport:"Custom Report",dateRange:"Date Range",fromDate:"From Date",toDate:"To Date",generateReport:"Generate Report",exportOptions:"Export Options",pdf:"PDF",excel:"Excel",csv:"CSV"},settings:{title:"Settings",general:"General",company:"Company",users:"Users",security:"Security",backup:"Backup",companyName:"Company Name",companyAddress:"Company Address",taxId:"Tax ID",fiscalYear:"Fiscal Year",currency:"Currency",dateFormat:"Date Format",timeZone:"Time Zone",language:"Language",theme:"Theme",lightTheme:"Light",darkTheme:"Dark",autoBackup:"Auto Backup",backupFrequency:"Backup Frequency",lastBackup:"Last Backup",restoreBackup:"Restore Backup",exportData:"Export Data",importData:"Import Data",changePassword:"Change Password",twoFactorAuth:"Two-factor Authentication",sessionTimeout:"Session Timeout",auditLog:"Audit Log"},unauthorized:{title:"Access Restricted",accessDenied:"Access Denied",noPermission:"You don't have permission to access",thisFeature:"this feature",whySeeing:"Why am I seeing this?",explanation:"Your account doesn't have the necessary permissions to view this content.",requiredPermission:"Required permission:",goToDashboard:"Go to Dashboard",goBack:"Go Back",featuresCanAccess:"Features you can access:",dashboardAccess:"Dashboard and overview statistics",profileAccess:"Your profile and settings",roleBasedAccess:"Features enabled for your role",needAccess:"Need access? Contact your administrator or manager to request the appropriate permissions.",permissions:{accountAccess:"Account Management Access",inventoryAccess:"Inventory Access",employeeAccess:"HR Access",bankingAccess:"Banking Access",journalAccess:"Journal Entry Access",adminAccess:"Administrative Access",financialReporting:"Financial Reporting Access",invoiceManagement:"Invoice Management Access",productManagement:"Product Management Access",HBLAccess:"HBL Management Access"}},hbl:{title:"House Bill of Lading Management",records:"records",searchPlaceholder:"Search by HBL#, air guide, shipper, consignee, commodity, bag#, identity...",addNew:"Add New HBL",hblNumber:"HBL Number",airGuide:"Air Guide",airNumber:"Air Number",shipper:"Shipper",consignee:"Consignee",shipperPhone:"Shipper Phone",consigneePhone:"Consignee Phone",identity:"Identity",classification:"Classification",address:"Address",city:"City",state:"State",street:"Street",commodity:"Commodity",weight:"Weight",quantity:"Quantity",bagNumber:"Bag Number",agency:"Agency",guide:"Guide",guideNumber:"Guide Number",guideNo:"Guide No.",reserveDate:"Reserve Date",status:{"EN BODEGA":"In Warehouse",ENVIADO:"Shipped",ENTREGADO:"Delivered",CANCELADO:"Cancelled",PENDIENTE:"Pending"}},eventAutomation:{title:"Event-Based Automation",subtitle:"Automatically create journal entries when business events occur",tabs:{rules:"Automation Rules",events:"Event History",audit:"Audit Log"},rules:{title:"Active Automation Rules",createNew:"Create New Rule",noRules:"No automation rules configured yet.",createFirst:"Create Your First Rule",conditions:"Conditions",alwaysTriggers:"Always triggers",journalEntry:"Journal Entry",lines:"lines",enable:"Enable",disable:"Disable",priority:"Priority"},events:{title:"Recent Events",noEvents:"No events recorded yet. Events will appear here as they occur.",source:"Source",eventId:"Event ID",viewData:"View Event Data"},audit:{title:"Automation Audit Log",noActivity:"No automation activity recorded yet.",eventId:"Event ID",rulesTriggered:"Rules Triggered",entriesCreated:"Entries Created",journalEntries:"journal entries",success:"Success",failed:"Failed",error:"Error"},builder:{title:"Automation Rule",editTitle:"Edit Automation Rule",createTitle:"Create New Automation Rule",basicInfo:"Basic Information",ruleName:"Rule Name",ruleNamePlaceholder:"e.g., Cash Sale Automation",priority:"Priority (1-1000)",description:"Description",descriptionPlaceholder:"Describe what this rule does",eventType:"Event Type",active:"Active",eventDescription:"Event Description",conditions:{title:"Conditions",add:"Add Condition",noConditions:"No conditions - rule will trigger for all",field:"Field",operator:"Operator",value:"Value",selectField:"Select a field...",enterValue:"Enter value...",remove:"Remove"},journalTemplate:{title:"Journal Entry Template",description:"Entry Description Template",descriptionPlaceholder:"e.g., Cash Sale - Invoice {data.invoice}",reference:"Reference Template",referencePlaceholder:"e.g., INV-{data.invoice}",tip:"Tip: Use {data.field} to insert event data. Available fields:",lines:"Journal Entry Lines",addLine:"Add Line",noLines:"No journal entry lines defined. Add at least one debit and one credit line.",account:"Account",type:"Type",debit:"Debit",credit:"Credit",descriptionTemplate:"Description Template",descriptionTemplatePlaceholder:"e.g., Cash payment from {data.customerName}",amountExpression:"Amount Expression",amountExpressionPlaceholder:"e.g., data.totalAmount"},save:"Create Rule",update:"Update Rule",cancel:"Cancel"},eventTypes:{invoice_completed:"Invoice Completed",invoice_created:"Invoice Created",invoice_updated:"Invoice Updated",invoice_cancelled:"Invoice Cancelled",payment_received:"Payment Received",payment_refunded:"Payment Refunded",inventory_received:"Inventory Received",inventory_sold:"Inventory Sold",inventory_adjusted:"Inventory Adjusted",expense_created:"Expense Created",expense_approved:"Expense Approved",expense_paid:"Expense Paid",service_rendered:"Service Rendered",freight_processed:"Freight Processed",customs_cleared:"Customs Cleared"},operators:{equals:"Equals",notEquals:"Not Equals",greaterThan:"Greater Than",lessThan:"Less Than",greaterThanOrEqual:"Greater Than or Equal",lessThanOrEqual:"Less Than or Equal",contains:"Contains",notContains:"Not Contains",exists:"Exists",notExists:"Not Exists"},categories:{financial:"Financial",inventory:"Inventory",operational:"Operational"}},invoices:{title:"Invoice Dashboard",invoice:"Invoice",invoices:"Invoices",invoiceNumber:"Invoice Number",invoiceDetails:"Invoice Details",customerInformation:"Customer Information",customerName:"Customer Name",legalName:"Legal Name",contactInformation:"Contact Information",idPassport:"ID/Passport",phoneNumber:"Phone Number",altPhone:"Alt Phone",address:"Address",between:"Between",and:"and",products:"Products",reservations:"Reservations",services:"Services",unitPrice:"Unit Price",total:"Total",subtotal:"Subtotal",totalRevenue:"Total Revenue",totalProducts:"Total Products",totalReservations:"Total Reservations",aranceles:"Aranceles (Customs)",uniqueCustomers:"Unique Customers",averageInvoice:"Average Invoice",completed:"Completed",pending:"Pending",storesActive:"Stores Active",topProducts:"Top Products",mostSoldProducts:"Most sold products by quantity",reservationsByType:"Reservations by Type",distributionOfCategories:"Distribution of reservation categories",recentInvoices:"Recent Invoices",showingInvoices:"Showing {{count}} invoices",date:"Date",customer:"Customer",store:"Store",actions:"Actions",view:"View",status:"Status",printInvoice:"Print Invoice",exportPdf:"Export PDF",backToDashboard:"Back to Dashboard",fromInvoices:"From {{count}} invoices",value:"value",activeCustomers:"Active customers",perInvoiceValue:"Per invoice value",locations:"Locations",mostRecentActivity:"Most recent activity",storeLocation:"Store Location",allStores:"All Stores",fromDate:"From Date",toDate:"To Date",clearFilters:"Clear Filters",search:"Search",searchPlaceholder:"Search by invoice #, customer, store...",customsFees:"Total customs fees",salesType:"SALES",packagesOrder:"Packages Order",businessId:"Business ID",orderKey:"Order Key",reservationType:"Reservation Type",arancel:"Arancel",key:"Key",noInvoicesFound:"No invoices found",loadingInvoices:"Loading invoices...",errorLoadingInvoices:"Error loading invoices",refreshData:"Refresh Data",currentStockValue:"Current Stock Value",filterByStore:"Filter by store",filterByDate:"Filter by date range",totalCustomsFees:"Total customs fees",averageValue:"Average value",senderInformation:"Sender Information",receiptInformation:"Receipt Information",productsSubtotal:"Products Subtotal",reservationsSubtotal:"Reservations Subtotal",servicesSubtotal:"Services Subtotal",transportTotal:"Transport Subtotal",code:"Code",description:"Description",qty:"Qty",type:"Type",id:"ID",dob:"Date of Birth",passport:"Passport",createNew:"Create New Invoice",totalOutstanding:"Total Outstanding",unpaidInvoices:"Unpaid invoices",thisMonth:"This Month",revenueCollected:"Revenue collected",overdue:"Overdue",pastDueInvoices:"Past due invoices",latestBillingActivity:"Latest billing activity",paid:"Paid",shippingMethod:"Shipping",weight:"Weight",items:"Items",bulkInformation:"Bulk Information"}},QR={common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",add:"Agregar",close:"Cerrar",search:"Buscar",filter:"Filtrar",reset:"Restablecer",back:"Atrás",next:"Siguiente",previous:"Anterior",yes:"Sí",no:"No",from:"Desde",to:"Hasta",loading:"Cargando...",error:"Error",success:"Éxito",warning:"Advertencia",info:"Información",confirm:"Confirmar",actions:"Acciones",status:"Estado",active:"Activo",inactive:"Inactivo",date:"Fecha",time:"Hora",description:"Descripción",notes:"Notas",amount:"Monto",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Idioma",english:"Inglés",spanish:"Español",noDataFound:"No se encontraron datos",required:"Requerido",optional:"Opcional",all:"Todos",none:"Ninguno",select:"Seleccionar",clear:"Limpiar",view:"Ver",unknown:"Desconocido",details:"Detalles",notAvailable:"N/A",download:"Descargar",upload:"Cargar",print:"Imprimir",export:"Exportar",import:"Importar",exportCSV:"Exportar CSV",exportExcel:"Exportar Excel",showing:"Mostrando",of:"de",dateFrom:"Fecha Desde",dateTo:"Fecha Hasta",showFilters:"Mostrar Filtros",hideFilters:"Ocultar Filtros",clearFilters:"Limpiar Filtros",suggested:"Sugerido",enhanced:"Mejorado",legacy:"Clásico",email:"Correo Electrónico",phone:"Teléfono",address:"Dirección",name:"Nombre",code:"Código",category:"Categoría",type:"Tipo",quantity:"Cantidad",price:"Precio",cost:"Costo",value:"Valor",balance:"Saldo",created:"Creado",modified:"Modificado",summary:"Resumen",history:"Historial",new:"Nuevo",addNew:"Agregar Nuevo",remove:"Remover",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",invoice:"Factura",invoices:"facturas",reference:"Referencia",createdBy:"Creado Por",units:"unidades",invoiceDocumentId:"ID de Factura/Documento",referenceNumber:"Número de Referencia",referenceNumberPlaceholder:"Ingrese número de referencia...",generalNotes:"Notas Generales",auto:"Auto",optionalNotes:"Notas opcionales...",showPerPage:"Mostrar por página",first:"Primera",last:"Última",store:"Tienda",orderId:"ID de Orden",tax:"Impuesto",paymentMethods:"Métodos de Pago",cash:"Efectivo",creditCard:"Tarjeta de Crédito",shipping:"Envío",air:"Aéreo",sea:"Marítimo",thankYouBusiness:"¡Gracias por su negocio!",thankForChoosingUs:"¡Gracias por elejirnos!",taxExemptNote:"Impuesto exento en pago en efectivo.",youSaved:"Usted ahorró",generatedOn:"Generado el",printSavePDF:"Imprimir / Guardar como PDF",pageOfPages:"Página {{current}} de {{total}}",showingXofY:"Mostrando {{start}}-{{end}} de {{total}}",page:"Página",lbs:"libras"},navigation:{dashboard:"Panel de Control",accounts:"Plan de Cuentas",balanceSheet:"Balance General",inventory:"Inventario",inventoryManagement:"Gestión de Inventario",employees:"Empleados",employeeManagement:"Gestión de Empleados",entryBooks:"Libros de Entrada",journalEntries:"Asientos Contables",consolidate:"Consolidación Bancaria",reports:"Reportes",settings:"Configuración",logout:"Cerrar Sesión",home:"Inicio",hbl:"Conocimiento de Embarque"},dashboard:{title:"Panel de Control",welcome:"Bienvenido a HRM Finance",overview:"Resumen",recentActivity:"Actividad Reciente",quickActions:"Acciones Rápidas",totalAssets:"Activos Totales",totalLiabilities:"Pasivos Totales",totalEquity:"Patrimonio Total",totalRevenue:"Ingresos Totales",totalExpenses:"Gastos Totales",netIncome:"Ingreso Neto",cashBalance:"Saldo en Efectivo",accountsReceivable:"Cuentas por Cobrar",accountsPayable:"Cuentas por Pagar",inventoryValue:"Valor del Inventario",lowStockItems:"Artículos con Bajo Stock",pendingInvoices:"Facturas Pendientes",employeeCount:"Número de Empleados",monthlyPayroll:"Nómina Mensual"},accounts:{title:"Plan de Cuentas",accountNumber:"Número de Cuenta",accountName:"Nombre de Cuenta",accountType:"Tipo de Cuenta",category:"Categoría",balance:"Saldo",parentAccount:"Cuenta Padre",subAccounts:"Subcuentas",addAccount:"Agregar Cuenta",editAccount:"Editar Cuenta",deleteAccount:"Eliminar Cuenta",accountDetails:"Detalles de Cuenta",transactions:"Transacciones",accountHistory:"Historial de Cuenta",types:{asset:"Activo",liability:"Pasivo",equity:"Patrimonio",revenue:"Ingreso",expense:"Gasto"},categories:{currentAssets:"Activos Corrientes",fixedAssets:"Activos Fijos",currentLiabilities:"Pasivos Corrientes",longTermLiabilities:"Pasivos a Largo Plazo",ownersEquity:"Patrimonio del Propietario",operatingRevenue:"Ingresos Operativos",operatingExpenses:"Gastos Operativos"},allAccounts:"Todas las Cuentas"},banking:{title:"Bancario",unreconciled:"Sin Conciliar",reconciled:"Conciliado",reconciliation:"Conciliación",notReconciled:"No Conciliado"},balanceSheet:{title:"Balance General",asOf:"Al",assets:"Activos",liabilities:"Pasivos",equity:"Patrimonio",totalAssets:"Total de Activos",totalLiabilities:"Total de Pasivos",totalEquity:"Total de Patrimonio",currentAssets:"Activos Corrientes",nonCurrentAssets:"Activos No Corrientes",currentLiabilities:"Pasivos Corrientes",nonCurrentLiabilities:"Pasivos No Corrientes",retainedEarnings:"Utilidades Retenidas",commonStock:"Capital Social",generateReport:"Generar Reporte",exportPDF:"Exportar PDF",exportExcel:"Exportar Excel"},inventory:{title:"Gestión de Inventario",products:"Productos",locations:"Ubicaciones",movements:"Movimientos",overview:"Resumen",addProduct:"Agregar Producto",addLocation:"Agregar Ubicación",addMovement:"Agregar Movimiento",bulkMovement:"Movimiento Masivo",productName:"Nombre del Producto",productCode:"Código del Producto",sku:"SKU",category:"Categoría",quantity:"Cantidad",unitOfMeasure:"Unidad de Medida",unitCost:"Costo Unitario",totalValue:"Valor Total",minStockLevel:"Nivel Mínimo de Stock",maxStockLevel:"Nivel Máximo de Stock",reorderPoint:"Punto de Reorden",locationName:"Nombre de Ubicación",locationType:"Tipo de Ubicación",locationCode:"Código de Ubicación",address:"Dirección",movementType:"Tipo de Movimiento",fromLocation:"Desde Ubicación",toLocation:"Hacia Ubicación",referenceNumber:"Número de Referencia",invoiceNumber:"Número de Factura",stockIn:"Entrada de Stock",stockOut:"Salida de Stock",transfer:"Transferencia",adjustment:"Ajuste",inStock:"En Stock",lowStock:"Stock Bajo",outOfStock:"Sin Stock",stockLevels:"Niveles de Stock",stockByLocation:"Stock por Ubicación",recentMovements:"Movimientos Recientes",searchProducts:"Buscar productos...",searchLocations:"Buscar ubicaciones...",noMovements:"No se encontraron movimientos",productDetails:"Detalles del Producto",locationDetails:"Detalles de Ubicación",movementDetails:"Detalles del Movimiento",totalProducts:"Total de Productos",activeProducts:"Productos Activos",totalLocations:"Total de Ubicaciones",activeLocations:"Ubicaciones Activas",lowStockAlert:"Alerta de Stock Bajo",productsNeedRestocking:"productos necesitan reabastecimiento",lastSeen:"Visto por última vez",noProducts:"No hay productos en esta ubicación",warehouseType:"Almacén",storeType:"Tienda",supplierType:"Proveedor",customerType:"Cliente"},employees:{title:"Gestión de Empleados",employeeList:"Lista de Empleados",addEmployee:"Agregar Empleado",editEmployee:"Editar Empleado",employeeDetails:"Detalles del Empleado",personalInfo:"Información Personal",employmentInfo:"Información Laboral",payrollInfo:"Información de Nómina",firstName:"Nombre",lastName:"Apellido",fullName:"Nombre Completo",email:"Correo Electrónico",phone:"Teléfono",address:"Dirección",dateOfBirth:"Fecha de Nacimiento",employeeId:"ID de Empleado",department:"Departamento",position:"Puesto",hireDate:"Fecha de Contratación",employmentStatus:"Estado Laboral",salary:"Salario",payFrequency:"Frecuencia de Pago",taxId:"ID Fiscal",bankAccount:"Cuenta Bancaria",emergencyContact:"Contacto de Emergencia",activeEmployees:"Empleados Activos",inactiveEmployees:"Empleados Inactivos",totalPayroll:"Nómina Total",searchEmployees:"Buscar empleados..."},journal:{title:"Asientos Contables",entryNumber:"Número de Asiento",entryDate:"Fecha del Asiento",debit:"Débito",credit:"Crédito",account:"Cuenta",memo:"Nota",reference:"Referencia",createEntry:"Crear Asiento",editEntry:"Editar Asiento",deleteEntry:"Eliminar Asiento",addEntry:"Agregar Asiento Contable",updateEntry:"Actualizar Asiento",saveAsDraft:"Guardar como Borrador",post:"Registrar",postEntry:"Registrar Asiento",voidEntry:"Anular Asiento",posted:"Registrado",draft:"Borrador",reversed:"Revertido",balanced:"Balanceado",notBalanced:"No Balanceado",outOfBalance:"Desbalanceado",unbalanced:"Desbalanceado",recurringEntry:"Asiento Recurrente",attachments:"Archivos Adjuntos",draftEntry:"Asiento Borrador",postedEntry:"Asiento Registrado",totalDebits:"Débitos Totales",totalCredits:"Créditos Totales",totalDebit:"Débito Total",totalCredit:"Crédito Total",totalAmount:"Monto Total",debitShort:"Db.",creditShort:"Cr.",allEntries:"Todos los Asientos",noReference:"Sin referencia",createdBy:"Por",lines:"Líneas",entryLines:"Líneas del Asiento Contable",journalLines:"Líneas del Diario",addLine:"Agregar Línea",lineDescription:"Descripción de línea",accountLines:"Líneas de Cuentas",noDescription:"Sin descripción",andMoreLines:"... y {count} líneas más",viewDetails:"Ver Detalles",entryDetails:"Detalles del Asiento Contable",entryNotFound:"Asiento No Encontrado",entryNotFoundMessage:"El asiento contable que busca no se pudo encontrar o puede haber sido eliminado.",balanceStatus:"Estado del Balance",difference:"diferencia",createdAt:"Creado el",postedAt:"Registrado el",quickActions:"Acciones Rápidas",fixBalance:"Corregir Balance",editEntryTooltip:"Editar este asiento contable",postEntryTooltip:"Registrar este asiento contable",voidEntryTooltip:"Anular este asiento contable",draftEntryDescription:"Este asiento puede ser editado y registrado.",postedEntryDescription:"Este asiento ha sido registrado en el libro mayor. Editar creará una nueva copia borrador.",voidEntryDescription:"Este asiento ha sido anulado y no puede ser modificado.",entryMustBeBalanced:"El asiento debe estar balanceado para registrarse",entryMustBeBalancedBeforePosting:"El asiento debe estar balanceado antes de registrarse.",entryNotBalancedShort:"El asiento no está balanceado",confirmEditPosted:"Este asiento ha sido registrado. Editar creará una nueva copia borrador. ¿Continuar?",confirmPost:"¿Está seguro que desea registrar este asiento contable? Esta acción no se puede deshacer.",confirmVoid:"¿Está seguro que desea anular este asiento contable?",minTwoLinesRequired:"Se requieren al menos 2 líneas",entryNotBalanced:"Asiento no balanceado. Débito: ${debit}, Crédito: ${credit}",lineAccountRequired:"Línea {lineNumber}: La cuenta es requerida",lineAmountRequired:"Línea {lineNumber}: Se debe proporcionar monto en débito o crédito",lineBothAmounts:"Línea {lineNumber}: No puede tener montos en débito y crédito",enterEntryDescription:"Ingrese la descripción del asiento contable",enterReferenceNumber:"Ingrese el número de referencia",quickEntry:"Entrada Rápida de Diario",selectCategory:"Seleccionar Categoría",selectTemplate:"Seleccionar Plantilla",chooseCategory:"Elija una categoría...",chooseTemplate:"Elija una plantilla...",enterAmounts:"Ingresar Montos",entryPreview:"Vista Previa del Asiento",createQuickEntry:"Crear Entrada Rápida",templateRequired:"Por favor seleccione una plantilla",amountRequired:"Se requiere monto para {field}",templates:"Plantillas",manageTemplates:"Administrar Plantillas",addNewTemplate:"Agregar Nueva Plantilla",templateDetails:"Detalles de Plantilla",newTemplate:"Nueva Plantilla",editTemplate:"Editar Plantilla",templateName:"Nombre de Plantilla",enterTemplateName:"Ingrese nombre de plantilla",enterTemplateDescription:"Ingrese descripción de plantilla",category:"Categoría",templateLines:"Líneas de Plantilla",type:"Tipo",amountType:"Tipo de Monto",fieldName:"Nombre del Campo",selectAccount:"Seleccionar cuenta...",variable:"Variable",fixed:"Fijo",fieldNamePlaceholder:"ej., Monto",custom:"Personalizado",templateNameRequired:"El nombre de plantilla es requerido",templateDescriptionRequired:"La descripción de plantilla es requerida",lineDescriptionRequired:"Línea {lineNumber}: Se requiere descripción",amountFieldNameRequired:"Línea {lineNumber}: Se requiere nombre del campo de monto",confirmDeleteTemplate:"¿Está seguro que desea eliminar esta plantilla?",selectTemplateToView:"Seleccione una plantilla de la lista para ver detalles",orCreateNew:"o cree una nueva plantilla personalizada",reconciliationSummary:"Resumen de Conciliación",totalLines:"Líneas Totales",bankAccounts:"Cuentas Bancarias",bankReconciled:"Conciliadas Bancarias",bankPending:"Bancarias Pendientes",reconciledLines:"Líneas Conciliadas",unreconciledLines:"Líneas Sin Conciliar",fullyReconciled:"Completamente Conciliado",partiallyReconciled:"Parcialmente Conciliado",unreconciled:"Sin Conciliar",reconciled:"Conciliadas",pending:"Pendientes",matched:"Coincididas",manual:"Manual",pendingBankReconciliation:"Conciliación Bancaria Pendiente",visitBankConsolidations:"Visite Consolidaciones Bancarias para conciliar estas transacciones",reconciliationTip:"Consejo de Conciliación",unreconciledBankTransactions:"Este asiento tiene transacciones de cuentas bancarias sin conciliar.",bankAccount:"cuenta bancaria",currentUser:"Usuario Actual",errorDeletingTemplate:"Error al eliminar plantilla",errorSavingTemplate:"Error al guardar plantilla",noLines:"Sin líneas",noTemplateLines:"Sin líneas de plantilla"},invoiceReport:{title:"Reporte Resumen de Facturas",filters:"Filtros",storeLocation:"Ubicación de Tienda",allStores:"Todas las Tiendas",fromDate:"Fecha Desde",toDate:"Fecha Hasta",paymentMethod:"Método de Pago",allMethods:"Todos los Métodos",cash:"Efectivo",zelle:"Zelle",other:"Otro",shippingType:"Tipo de Envío",allTypes:"Todos los Tipos",maritime:"🚢 Marítimo",air:"✈️ Aéreo",generateReport:"Generar Reporte",loading:"Cargando...",print:"🖨️ Imprimir",exportPdf:"📄 Exportar PDF",generating:"📄 Generando...",close:"Cerrar",invoiceSummary:"Resumen de Facturas",totalInvoices:"Total de Facturas",dateRange:"Rango de Fechas",store:"Tienda",shippingTypeLabel:"Tipo de Envío",notSet:"No Establecido",paymentMethods:"Métodos de Pago",total:"Total",additionalCharges:"Cargos Adicionales",transport:"Transporte",aranceles:"Aranceles",tax:"Impuesto",productsSummary:"Resumen de Productos",productType:"Tipo de Producto",quantity:"Cantidad",totalValue:"Valor Total",avgPrice:"Precio Promedio",reservasSummary:"Resumen de Reservas (Agrupado por Precio)",reservaType:"Tipo de Reserva",totalQtyLbs:"Cantidad Total (lbs)",priceGroups:"Grupos de Precio (Precio → Cantidad)",otherServicesTitle:"Otros Servicios y Cargos",serviceType:"Tipo de Servicio",totalOtherServices:"Total Otros Servicios",totalSummary:"Resumen Total",productsTotal:"Total Productos",reservasTotal:"Total Reservas",transportServices:"Transporte y Servicios",grandTotal:"TOTAL GENERAL",invoiceReferences:"Referencias de Facturas",type:"Tipo",pricePerPound:"Precio por libra",totalInvoicesCount:"Total facturas",invoiceNumbers:"Números de Facturas",copyInvoiceNumbers:"📋 Copiar Números de Facturas",reportPeriod:"Período del Reporte",allTimeReport:"Reporte de Todo el Tiempo",generatedOn:"Generado el",generatingReport:"Generando reporte...",pdfGenerationFailed:"Falló la generación del PDF. Usando impresión en su lugar.",invoiceNumbersCopied:"¡Números de facturas copiados al portapapeles!",allTypesOption:"Todos los Tipos",seaOption:"🚢 Marítimo",airOption:"✈️ Aéreo",allMethodsOption:"Todos los Métodos",cashOption:"Efectivo",zelleOption:"Zelle",otherOption:"Otro",pdf:{title:"Reporte Resumen de Facturas",subtitle:"Resumen Financiero Completo",paymentMethodsSummary:"Resumen de Métodos de Pago",productsSummary:"Resumen de Productos",reservasSummary:"Resumen de Reservas (Agrupado por Precio)",otherServicesTitle:"Otros Servicios y Cargos",totalSummary:"Resumen Total",paymentMethod:"Método de Pago",amount:"Monto",product:"Producto",quantity:"Cantidad",total:"Total",type:"Tipo",totalQty:"Cantidad Total",priceGroups:"Grupos de Precio",serviceType:"Tipo de Servicio",productsTotal:"Total Productos",reservasTotal:"Total Reservas",transportServices:"Transporte y Servicios",grandTotal:"TOTAL GENERAL",generatedOn:"Generado el:",all:"Todo",reportDate:"Fecha del Reporte:",dateRange:"Rango de Fechas:",totalInvoices:"Total de Facturas:",allTypes:"Todos los Tipos",lbs:"lbs",page:"Página",of:"de"}},entryBooks:{title:"Libros de Entrada",subtitle:"Administrar asientos contables y registros del libro mayor",bookName:"Nombre del Libro",bookType:"Tipo de Libro",createBook:"Crear Libro",editBook:"Editar Libro",salesBook:"Libro de Ventas",purchaseBook:"Libro de Compras",cashBook:"Libro de Caja",generalBook:"Libro General",entries:"Entradas",addEntry:"Agregar Entrada",period:"Período",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",bookBalance:"Saldo del Libro",reconciledBalance:"Saldo Conciliado",difference:"Diferencia",reconcile:"Conciliar",isReconciled:"Está Conciliado",totalEntries:"Total de Asientos",allJournalEntries:"Todos los asientos contables",postedEntriesOnly:"Solo asientos registrados",fromPostedEntries:"De {count} asientos registrados",needBankReconciliation:"Necesita conciliación bancaria",allReconciled:"Todo conciliado",sortBy:"Ordenar Por",fromDate:"Fecha Desde",toDate:"Fecha Hasta",order:"Orden",newest:"Más Reciente",oldest:"Más Antiguo",resetFilters:"Restablecer Filtros",activeFilters:"Filtros activos",from:"Desde",to:"Hasta",entriesFound:"{count} asientos encontrados",noJournalEntries:"Sin Asientos Contables",startByCreating:"Comience creando su primer asiento",noEntriesMatch:"No hay asientos que coincidan con sus filtros actuales.",createFirstEntry:"Crear Primer Asiento",confirmVoid:"¿Está seguro que desea anular este asiento contable?",void:"Anulado",viewReconciliation:"Ver Conciliación"},consolidation:{title:"Consolidación Bancaria",bankAccount:"Cuenta Bancaria",statementDate:"Fecha del Estado",beginningBalance:"Saldo Inicial",endingBalance:"Saldo Final",deposits:"Depósitos",withdrawals:"Retiros",bankCharges:"Cargos Bancarios",interest:"Intereses",reconcile:"Conciliar",matched:"Conciliado",unmatched:"No Conciliado",importStatement:"Importar Estado",manualEntry:"Entrada Manual",autoMatch:"Coincidencia Automática",clearAll:"Limpiar Todo",reconciliationStatus:"Estado de Conciliación",difference:"Diferencia",bookBalance:"Saldo en Libros",statementBalance:"Saldo del Estado",outstandingChecks:"Cheques Pendientes",depositsInTransit:"Depósitos en Tránsito"},forms:{requiredField:"Este campo es requerido",invalidEmail:"Dirección de correo inválida",invalidNumber:"Número inválido",invalidDate:"Fecha inválida",minLength:"La longitud mínima es",maxLength:"La longitud máxima es",minValue:"El valor mínimo es",maxValue:"El valor máximo es",passwordMismatch:"Las contraseñas no coinciden",selectOption:"Por favor seleccione una opción",enterValue:"Por favor ingrese un valor",confirmDelete:"¿Está seguro de que desea eliminar este elemento?",unsavedChanges:"Tiene cambios sin guardar. ¿Desea continuar?",saveSuccess:"Guardado exitosamente",saveError:"Error al guardar datos",deleteSuccess:"Eliminado exitosamente",deleteError:"Error al eliminar elemento",descriptionRequired:"La descripción es requerida",errorOccurred:"Ocurrió un error",errorPostingEntry:"Ocurrió un error al registrar el asiento"},reports:{title:"Reportes",incomeStatement:"Estado de Resultados",balanceSheet:"Balance General",cashFlow:"Estado de Flujo de Efectivo",trialBalance:"Balance de Comprobación",generalLedger:"Libro Mayor",accountsReceivable:"Cuentas por Cobrar",accountsPayable:"Cuentas por Pagar",inventoryReport:"Reporte de Inventario",payrollReport:"Reporte de Nómina",taxReport:"Reporte de Impuestos",customReport:"Reporte Personalizado",dateRange:"Rango de Fechas",fromDate:"Desde",toDate:"Hasta",generateReport:"Generar Reporte",exportOptions:"Opciones de Exportación",pdf:"PDF",excel:"Excel",csv:"CSV"},settings:{title:"Configuración",general:"General",company:"Empresa",users:"Usuarios",security:"Seguridad",backup:"Respaldo",companyName:"Nombre de la Empresa",companyAddress:"Dirección de la Empresa",taxId:"ID Fiscal",fiscalYear:"Año Fiscal",currency:"Moneda",dateFormat:"Formato de Fecha",timeZone:"Zona Horaria",language:"Idioma",theme:"Tema",lightTheme:"Claro",darkTheme:"Oscuro",autoBackup:"Respaldo Automático",backupFrequency:"Frecuencia de Respaldo",lastBackup:"Último Respaldo",restoreBackup:"Restaurar Respaldo",exportData:"Exportar Datos",importData:"Importar Datos",changePassword:"Cambiar Contraseña",twoFactorAuth:"Autenticación de Dos Factores",sessionTimeout:"Tiempo de Espera de Sesión",auditLog:"Registro de Auditoría"},unauthorized:{title:"Acceso Restringido",accessDenied:"Acceso Denegado",noPermission:"No tienes permisos para acceder a",thisFeature:"esta funcionalidad",whySeeing:"¿Por qué veo esto?",explanation:"Tu cuenta no tiene los permisos necesarios para ver este contenido.",requiredPermission:"Permiso requerido:",goToDashboard:"Ir al Panel de Control",goBack:"Regresar",featuresCanAccess:"Funcionalidades a las que puedes acceder:",dashboardAccess:"Panel de control y estadísticas generales",profileAccess:"Tu perfil y configuraciones",roleBasedAccess:"Funcionalidades habilitadas para tu rol",needAccess:"¿Necesitas acceso? Contacta a tu administrador o gerente para solicitar los permisos apropiados.",permissions:{accountAccess:"Acceso a Gestión de Cuentas",inventoryAccess:"Acceso a Inventario",employeeAccess:"Acceso a Recursos Humanos",bankingAccess:"Acceso Bancario",journalAccess:"Acceso a Asientos Contables",adminAccess:"Acceso Administrativo",financialReporting:"Acceso a Reportes Financieros",invoiceManagement:"Acceso a Gestión de Facturas",productManagement:"Acceso a Gestión de Productos",HBLAccess:"Acceso a Gestión de HBL"}},hbl:{title:"Gestión de Conocimiento de Embarque",records:"registros",searchPlaceholder:"Buscar por HBL#, guía aérea, remitente, consignatario, mercancía, bolsa#, identidad...",addNew:"Agregar Nuevo HBL",hblNumber:"Número HBL",airGuide:"Guía Aérea",airNumber:"Número Aéreo",shipper:"Remitente",consignee:"Consignatario",shipperPhone:"Teléfono del Remitente",consigneePhone:"Teléfono del Consignatario",identity:"Identidad",classification:"Clasificación",address:"Dirección",city:"Ciudad",state:"Provincia",street:"Calle",commodity:"Mercancía",weight:"Peso",quantity:"Cantidad",bagNumber:"Número de Bolsa",agency:"Agencia",guide:"Guía",guideNumber:"Número de Guía",guideNo:"Guía No.",reserveDate:"Fecha de Reserva",status:{"EN BODEGA":"En Bodega",ENVIADO:"Enviado",ENTREGADO:"Entregado",CANCELADO:"Cancelado",PENDIENTE:"Pendiente"}},eventAutomation:{title:"Automatización Basada en Eventos",subtitle:"Crea automáticamente asientos contables cuando ocurren eventos del negocio",tabs:{rules:"Reglas de Automatización",events:"Historial de Eventos",audit:"Registro de Auditoría"},rules:{title:"Reglas de Automatización Activas",createNew:"Crear Nueva Regla",noRules:"No hay reglas de automatización configuradas aún.",createFirst:"Crear Tu Primera Regla",conditions:"Condiciones",alwaysTriggers:"Siempre se activa",journalEntry:"Asiento Contable",lines:"líneas",enable:"Habilitar",disable:"Deshabilitar",priority:"Prioridad"},events:{title:"Eventos Recientes",noEvents:"No hay eventos registrados aún. Los eventos aparecerán aquí cuando ocurran.",source:"Origen",eventId:"ID de Evento",viewData:"Ver Datos del Evento"},audit:{title:"Registro de Auditoría de Automatización",noActivity:"No hay actividad de automatización registrada aún.",eventId:"ID de Evento",rulesTriggered:"Reglas Activadas",entriesCreated:"Asientos Creados",journalEntries:"asientos contables",success:"Exitoso",failed:"Fallido",error:"Error"},builder:{title:"Regla de Automatización",editTitle:"Editar Regla de Automatización",createTitle:"Crear Nueva Regla de Automatización",basicInfo:"Información Básica",ruleName:"Nombre de la Regla",ruleNamePlaceholder:"ej., Automatización de Venta en Efectivo",priority:"Prioridad (1-1000)",description:"Descripción",descriptionPlaceholder:"Describe qué hace esta regla",eventType:"Tipo de Evento",active:"Activa",eventDescription:"Descripción del Evento",conditions:{title:"Condiciones",add:"Agregar Condición",noConditions:"Sin condiciones - la regla se activará para todos",field:"Campo",operator:"Operador",value:"Valor",selectField:"Seleccionar un campo...",enterValue:"Ingresar valor...",remove:"Eliminar"},journalTemplate:{title:"Plantilla de Asiento Contable",description:"Plantilla de Descripción del Asiento",descriptionPlaceholder:"ej., Venta en Efectivo - Factura {data.invoice}",reference:"Plantilla de Referencia",referencePlaceholder:"ej., INV-{data.invoice}",tip:"Consejo: Usa {data.field} para insertar datos del evento. Campos disponibles:",lines:"Líneas del Asiento Contable",addLine:"Agregar Línea",noLines:"No hay líneas de asiento definidas. Agrega al menos una línea de débito y una de crédito.",account:"Cuenta",type:"Tipo",debit:"Débito",credit:"Crédito",descriptionTemplate:"Plantilla de Descripción",descriptionTemplatePlaceholder:"ej., Pago en efectivo de {data.customerName}",amountExpression:"Expresión de Monto",amountExpressionPlaceholder:"ej., data.totalAmount"},save:"Crear Regla",update:"Actualizar Regla",cancel:"Cancelar"},eventTypes:{invoice_completed:"Factura Completada",invoice_created:"Factura Creada",invoice_updated:"Factura Actualizada",invoice_cancelled:"Factura Cancelada",payment_received:"Pago Recibido",payment_refunded:"Pago Reembolsado",inventory_received:"Inventario Recibido",inventory_sold:"Inventario Vendido",inventory_adjusted:"Inventario Ajustado",expense_created:"Gasto Creado",expense_approved:"Gasto Aprobado",expense_paid:"Gasto Pagado",service_rendered:"Servicio Prestado",freight_processed:"Flete Procesado",customs_cleared:"Aduanas Despachadas"},operators:{equals:"Igual a",notEquals:"No Igual a",greaterThan:"Mayor Que",lessThan:"Menor Que",greaterThanOrEqual:"Mayor o Igual Que",lessThanOrEqual:"Menor o Igual Que",contains:"Contiene",notContains:"No Contiene",exists:"Existe",notExists:"No Existe"},categories:{financial:"Financiero",inventory:"Inventario",operational:"Operacional"}},invoices:{title:"Panel de Facturas",invoice:"Factura",invoices:"Facturas",invoiceNumber:"Número de Factura",invoiceDetails:"Detalles de Factura",customerInformation:"Información del Cliente",customerName:"Nombre del Cliente",legalName:"Nombre Legal",contactInformation:"Información de Contacto",idPassport:"ID/Pasaporte",phoneNumber:"Número de Teléfono",altPhone:"Teléfono Alt.",address:"Dirección",between:"Entre",and:"y",products:"Productos",reservations:"Reservaciones",services:"Servicios",unitPrice:"Precio Unitario",total:"Total",subtotal:"Subtotal",category:"Categoria",totalRevenue:"Ingresos Totales",totalProducts:"Total de Productos",totalReservations:"Total de Reservaciones",aranceles:"Aranceles (Aduanas)",uniqueCustomers:"Clientes Únicos",averageInvoice:"Factura Promedio",completed:"Completada",pending:"Pendiente",storesActive:"Tiendas Activas",topProducts:"Productos Principales",mostSoldProducts:"Productos más vendidos por cantidad",reservationsByType:"Reservaciones por Tipo",distributionOfCategories:"Distribución de categorías de reservaciones",recentInvoices:"Facturas Recientes",showingInvoices:"Mostrando {{count}} facturas",date:"Fecha",customer:"Cliente",store:"Tienda",actions:"Acciones",view:"Ver",status:"Estado",printInvoice:"Imprimir Factura",exportPdf:"Exportar PDF",backToDashboard:"Volver al Panel",fromInvoices:"De {{count}} facturas",value:"valor",activeCustomers:"Clientes activos",perInvoiceValue:"Valor por factura",locations:"Ubicaciones",mostRecentActivity:"Actividad más reciente",storeLocation:"Ubicación de Tienda",allStores:"Todas las Tiendas",fromDate:"Fecha Desde",toDate:"Fecha Hasta",clearFilters:"Limpiar Filtros",search:"Buscar",searchPlaceholder:"Buscar por # factura, cliente, tienda...",customsFees:"Aranceles totales",salesType:"VENTAS",packagesOrder:"Orden de Paquetes",businessId:"ID de Negocio",orderKey:"Clave de Orden",reservationType:"Tipo de Reservación",arancel:"Arancel",key:"Clave",noInvoicesFound:"No se encontraron facturas",loadingInvoices:"Cargando facturas...",errorLoadingInvoices:"Error al cargar facturas",refreshData:"Actualizar Datos",currentStockValue:"Valor de Stock Actual",filterByStore:"Filtrar por tienda",filterByDate:"Filtrar por rango de fechas",totalCustomsFees:"Aranceles totales",averageValue:"Valor promedio",senderInformation:"Información del Remitente",receiptInformation:"Información del Destinatario",productsSubtotal:"Subtotal de Productos",reservationsSubtotal:"Subtotal de Reservaciones",servicesSubtotal:"Subtotal de Servicios",transportTotal:"Subtotal de Transporte",code:"Código",description:"Descripción",qty:"Cant.",type:"Tipo",id:"ID",dob:"Fecha de Nacimiento",passport:"Pasaporte",shippingMethod:"Envio",weight:"Peso",items:"Articulos",bulkInformation:"Informacion de Bultos"}},JR=()=>{if(typeof window<"u"){const t=localStorage.getItem("hrmfinance-language");if(t&&["es","en"].includes(t))return t}return"en"},[K1,XR]=Se(JR()),[Q1,ZR]=Se({en:{},es:{}}),Id={get language(){return K1()},get translations(){return Q1()},setLanguage(t){XR(t),typeof window<"u"&&localStorage.setItem("hrmfinance-language",t)},setTranslations(t){ZR(t)},translate(t,e){const r=K1(),n=Q1()[r];if(!n)return e||t;const i=t.split(".");let o=n;for(const s of i)if(o&&typeof o=="object"&&s in o)o=o[s];else return e||t;return typeof o=="string"?o:e||t},t(t,e){return this.translate(t,e)}},Wc=()=>({t:Id.translate.bind(Id),language:Id.language,setLanguage:Id.setLanguage});Id.setTranslations({en:KR,es:QR});const eD=async()=>{try{console.log("Testing PDF generation...");const e=(await no(()=>Promise.resolve().then(()=>i_),void 0)).default;console.log("jsPDF imported successfully");const r=new e;console.log("PDF document created"),r.setFontSize(20),r.text("Test PDF",20,20),r.setFontSize(12),r.text("This is a test PDF to verify the library works.",20,40),console.log("Text added to PDF"),r.save("test.pdf"),console.log("PDF saved successfully"),alert("Test PDF generated successfully!")}catch(t){console.error("Test PDF generation failed:",t),alert(`Test PDF failed: ${t.message}`)}},to=t=>parseFloat(t?.toString()||"0")||0,Xo=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t),tD=(t,e,r,n)=>{const i=e.filter(g=>g.bulkId===t?.id),o=r.filter(g=>g.bulkId===t?.id),s=n.filter(g=>g.bulkId===t?.id),l=i.reduce((g,m)=>g+Math.abs(m.qty)*to(m.salePrice),0),c=o.reduce((g,m)=>g+((to(m.qty)||0)*(to(m.price)||0)+(m.arancel?to(m.arancel):0)),0),d=s.reduce((g,m)=>g+(to(m.qty)||0)*(m.arancel||m.price?to(m.arancel||m.price):0),0),u=l+c+d,h=u+(t?.transportCost||20);return{bulkProducts:i,bulkReservas:o,bulkServices:s,productsTotal:l,reservasTotal:c,servicesTotal:d,itemsTotal:u,grandTotal:h}},rD=(t,e,r,n,i,o=!1)=>{const s=tD(t,e,r,n),{bulkProducts:l,bulkReservas:c,bulkServices:d}=s,u=`
    background: #f5f5f5;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 20px;
  `,h=`
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 20px;
  `,g=`
    margin: 0;
    font-size: 18px;
    font-weight: bold;
    color: #333;
  `,m=`
    font-size: 14px;
    color: #666;
    margin-top: 4px;
  `,S=`
    font-size: 24px;
    font-weight: bold;
    color: #6366f1;
    text-align: right;
  `,N=`
    font-size: 12px;
    color: #666;
    text-align: right;
    margin-top: 4px;
  `,x=`
    font-size: 16px;
    font-weight: 600;
    color: #666;
    margin: 20px 0 10px 0;
  `,b=`
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 15px;
    background: white;
    border-radius: 6px;
    overflow: hidden;
   
  `,K=`
    background: #f8f9fa;
    padding: 12px;
    text-align: left;
    font-weight: 600;
    font-size: 12px;
    color: #666;
    text-transform: uppercase;
    
  `,te=`
    padding: 12px;
   
    font-size: 14px;
    color: #333;
  `;return`
    <div style="${u}">
      <!-- Bulk Header - Clean design matching the image -->
      <div style="${h}">
        <div>
          <div style="${g}">📦 ${t?.name}</div>
          <div style="${m}">
            Tipo: <strong>${t?.type}</strong> | Envío: ${t?.shippingMethod==="aereo"?"✈️":"🚢"}${t?.shippingMethod==="aereo"?"Aéreo":"Marítimo"}
          </div>
        </div>
        <div>
          <div style="${S}">${Xo(s.grandTotal)}</div>
          <div style="${N}">
            Artículos: ${Xo(s.itemsTotal)} + Transporte: ${Xo(t?.transportCost||20)}
          </div>
        </div>
      </div>
      
      <!-- Products Section -->
      ${l.length>0?`
        <div style="${x}">Productos (${l.length})</div>
        <table style="${b}">
          <thead>
            <tr>
              <th style="${K}">CÓDIGO</th>
              <th style="${K}">DESCRIPCIÓN</th>
              <th style="${K}; text-align: center;">CANT.</th>
              <th style="${K}; text-align: right;">PRECIO UNITARIO</th>
              <th style="${K}; text-align: right;">TOTAL</th>
            </tr>
          </thead>
          <tbody>
            ${l.map(F=>`
              <tr>
                <td style="${te}">${F.product.code}</td>
                <td style="${te}">${F.product.label}</td>
                <td style="${te}; text-align: center;">${Math.abs(F.qty)}</td>
                <td style="${te}; text-align: right;">${Xo(F.salePrice)}</td>
                <td style="${te}; text-align: right;">
                  ${Xo(Math.abs(F.qty)*to(F.salePrice))}
                </td>
              </tr>
            `).join("")}
          </tbody>
        </table>
      `:""}
      
      <!-- Reservations Section -->
      ${c.length>0?`
        <div style="${x}">Reservaciones (${c.length})</div>
        <table style="${b}">
          <thead>
            <tr>
              <th style="${K}">TIPO</th>
              <th style="${K}; text-align: center;">CANT.</th>
              <th style="${K}; text-align: right;">PRECIO UNITARIO</th>
              <th style="${K}; text-align: right;">ARANCEL</th>
              <th style="${K}; text-align: right;">TOTAL</th>
            </tr>
          </thead>
          <tbody>
            ${c.map(F=>`
              <tr>
                <td style="${te}">${F.type}</td>
                <td style="${te}; text-align: center;">${F.qty}</td>
                <td style="${te}; text-align: right;">${Xo(F.price)}</td>
                <td style="${te}; text-align: right;">${F.arancel?Xo(F.arancel):"-"}</td>
                <td style="${te}; text-align: right;">
                  ${Xo((to(F.qty)||0)*(to(F.price)||0)+(F.arancel?to(F.arancel):0))}
                </td>
              </tr>
            `).join("")}
          </tbody>
        </table>
      `:""}
      
      <!-- Services Section -->
      ${d.length>0?`
        <div style="${x}">Servicios (${d.length})</div>
        <table style="${b}">
          <thead>
            <tr>
              <th style="${K}">TIPO</th>
              <th style="${K}; text-align: center;">CANT.</th>
              <th style="${K}; text-align: right;">ARANCEL</th>
              <th style="${K}; text-align: right;">TOTAL</th>
            </tr>
          </thead>
          <tbody>
            ${d.map(F=>`
              <tr>
                <td style="${te}">${F.type}</td>
                <td style="${te}; text-align: center;">${to(F.qty).toFixed(2)}</td>
                <td style="${te}; text-align: right;">${F.arancel||F.price?Xo(F.arancel||F.price):"-"}</td>
                <td style="${te}; text-align: right;">
                  ${Xo((to(F.qty)||0)*(F.arancel||F.price?to(F.arancel||F.price):0))}
                </td>
              </tr>
            `).join("")}
          </tbody>
        </table>
      `:""}
    </div>
  `},cy=(t,e)=>{try{console.log("Generating printable PDF...");const r=window.open("","_blank","width=800,height=600");if(!r){alert("Please allow popups to generate PDF");return}const n=t.shipper_consignee||{};let i=gt.getLocationById(t?.store);const o=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Invoice ${t.invoice||"N/A"}</title>
        <style>
          body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
          }
          .header {
            display: flex;
            justify-content: space-between;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
            margin-bottom: 20px;
          }
          .company {
            font-size: 24px;
            font-weight: bold;
            color: #2563eb;
          }
          .invoice-info {
            text-align: right;
          }
          .section {
            margin: 20px 0;
          }
          .section-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
          }
          .customer-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
             font-size: 13px;
          }
          .flex{
            display: flex;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
          }
          th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
          }
          th {
            background-color: #f2f2f2;
            font-weight: bold;
            font-size: 13px;
          }
          td{
           font-size: 12px;
          }
          .total-row {
            font-weight: bold;
            font-size: 16px;
            background-color: #e8f4fd;
          }
          .certification-section {
            page-break-inside: avoid;
            break-inside: avoid;
            orphans: 3;
            widows: 3;
          }
          .page-break-before {
            page-break-before: always;
            break-before: page;
          }
          @media print {
            body { margin: 0; }
            .no-print { display: none; }
            .certification-section {
              page-break-inside: avoid !important;
              break-inside: avoid !important;
              orphans: 3;
              widows: 3;
            }
            .page-break-before {
              page-break-before: always !important;
              break-before: page !important;
            }
            /* Force page break if certification section would be split */
            @page {
              margin: 0.5in;
              orphans: 3;
              widows: 3;
            }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <div>
            <div class="company">HRM FINANCE</div>
            <div>${e("common.store")}: ${i?.name||t?.store||"N/A"}</div>
            <div>${e("common.orderId")}: ${t.ssg_sorder_key||"N/A"}</div>
            ${t.shippingMethod?`<div>${e("common.shipping")}: ${t.shippingMethod==="aereo"?e("common.air"):e("common.sea")}</div>`:""}
          </div>
          <div class="invoice-info">
            <div style="font-size: 18px; font-weight: bold;">${e("common.invoice").toUpperCase()}</div>
            <div style="font-size: 16px; margin: 5px 0;">${t.invoice||"N/A"}</div>
            <div>${t.createDate?new Date(t.createDate).toLocaleDateString():"N/A"}</div>
            <div style="margin-top: 10px;">
              <span style="padding: 4px 8px; background: ${t.isCompleted?"#d4edda":"#fff3cd"}; border-radius: 10px; font-size: 12px;">
                ${t.isCompleted?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase()}
              </span>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="customer-info">
            <div><strong>${e("invoices.senderInformation")}:</strong> ${n.name||"N/A"}</div>
            ${n.phoneNumberS?`<div><strong>${e("invoices.phoneNumber")}:</strong> ${n.phoneNumberS}</div>`:""}
          
          </div>
          <div class="customer-info">
            <div><strong>${e("invoices.receiptInformation")}:</strong> ${[n.firstName,n.middleName,n.lastName,n.lastName2].filter(Boolean).join(" ")||"N/A"}</div>
            <div><strong>${e("invoices.phoneNumber")}:</strong> ${n.phoneNumber||"N/A"}</div>
            <div><strong>${e("invoices.id")}:</strong> ${n.cid||"N/A"}</div>
            ${n.address?`<div><strong>${e("invoices.address")}:</strong> ${n.address}</div>`:""}
          </div>
        </div>

        ${t.bulks&&t.bulks.length>0?`
        <div class="section">
          <div class="section-title">Información de Bultos</div>
          ${t.bulks.map(s=>rD(s,t.products||[],t.reservas||[],t.services||[],e,!1)).join("")}
        </div>
        `:""}

         ${t.bulks?"":` ${nD(t,e)}`}

        <div class="section flex">
          ${t?.paymentMethods?`
        <div class="section" style="margin-right: auto; width: 48%">
          <div class="section-title">${e("common.paymentMethods")}</div>
          <div class="customer-info">
            ${t.paymentMethods.cash>0?`<div><strong>💵 ${e("common.cash")}:</strong> $${t.paymentMethods?.cash?.toFixed(2)}</div>`:""}
            ${t.paymentMethods.zelle>0?`<div><strong>📱 Zelle:</strong> $${t.paymentMethods?.zelle?.toFixed(2)}</div>`:""}
            ${t.paymentMethods.creditCard>0?`<div><strong>💳 ${e("common.creditCard")}:</strong> $${t.paymentMethods?.creditCard?.toFixed(2)}</div>`:""}
            ${t.paymentMethods?.exemptTaxOnCash&&t?.paymentMethods.cash>0&&t?.taxSavings>0?`
              <div style="margin-top: 10px; padding: 8px; background-color: #e7f5ff; border-radius: 4px; font-size: 12px; font-style: italic;">
                * ${e("common.taxExemptNote")} ${e("common.youSaved")} $${t?.taxSavings.toFixed(2)}!
              </div>
            `:""}
          </div>
        </div>
        `:""}
        <div class="section ">
          <table style="margin-left: auto; width: width: 48%">
            ${t.productSubtotal?`
            <tr>
              <td><strong>${e("invoices.productsSubtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${t.productSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            ${t.reservaSubtotal?`
            <tr>
              <td><strong>${e("invoices.reservationsSubtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${t.reservaSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            ${t.serviceSubtotal?`
            <tr>
              <td><strong>${e("invoices.servicesSubtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${t.serviceSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            ${t.transportTotal?`
            <tr>
              <td><strong>${e("invoices.transportTotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${t.transportTotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            ${t.taxAmount&&t.taxAmount>0?`
            <tr>
              <td><strong>${e("common.subtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${(t.subtotalBeforeTax||0).toFixed(2)}</strong></td>
            </tr>
            <tr>
              <td><strong>${e("common.tax")} (${t.paymentMethods?.taxPercent||7}%):</strong></td>
              <td style="text-align: right;"><strong>$${t.taxAmount.toFixed(2)}</strong></td>
            </tr>
            `:""}
            <tr class="total-row">
              <td><strong>${e("invoices.total").toUpperCase()}:</strong></td>
              <td style="text-align: right;"><strong>$${(t.total||0).toFixed(2)}</strong></td>
            </tr>
          </table>
        </div>
        </div>
        
       

        <!-- Certification Section -->
        <div class="certification-section" style="margin-top: 40px; padding: 20px; border: 2px solid #333; background: #f9f9f9;">
          <div style="text-align: center; font-weight: bold; font-size: 14px; margin-bottom: 15px; text-transform: uppercase;">
            CERTIFICACIÓN DEL EMBARCADOR
          </div>
          <div style="font-size: 11px; line-height: 1.4; text-align: justify; margin-bottom: 20px;">
            <p><strong>Certifico que no envío sustancias ni productos prohibidos por las leyes y las aduanas de USA y Cuba, como por ejemplo:</strong> drogas, armas, explosivos, cigarrillos electrónicos, drones profesionales, joyas, prendas, dinero en efectivo, semillas, narcóticos, fármacos controlados, productos agrícolas de tipo herbicidas o antifúngicidas, ningún tipo de producto perecedero que necesite refrigeración.</p>
            
            <p><strong>Entiendo que al llenar este formulario, al enviar alguna de las sustancias o productos antes descritos mi carga puede ser decamisada completa o parcialmente por las aduanas de Cuba o USA sin derecho a reclamo ni compensación,</strong> de parte mía como embarcador, ni de la persona a quien envío (consignatario).</p>
            
           </div>
          
          <!-- Signature Section -->
          <div style="display: flex; justify-content: space-between; margin-top: 30px;">
            <div style="width: 45%; text-align: center;">
              <div style="border-bottom: 2px solid #333; margin-bottom: 10px; height: 40px;"></div>
              <div style="font-size: 10px; font-weight: bold;">FIRMA DEL EMBARCADOR / SHIPPER SIGNATURE</div>
              <div style="font-size: 10px; margin-top: 5px;">${n.name||"N/A"}</div>
            </div>
            <div style="width: 45%; text-align: center;">
              <div style="border-bottom: 2px solid #333; margin-bottom: 10px; height: 40px;"></div>
              <div style="font-size: 10px; font-weight: bold;">FECHA / DATE</div>
              <div style="font-size: 10px; margin-top: 5px;">${new Date().toLocaleDateString()}</div>
            </div>
          </div>
        </div>

        <div style="margin-top: 40px; text-align: center; color: #666; font-size: 12px;">
          <p>${e("common.thankForChoosingUs")}</p>
          <p>${e("common.generatedOn")} ${new Date().toLocaleDateString()}</p>
        </div>

        <script>
          // Check if certification section needs page break
          function checkCertificationPageBreak() {
            const certSection = document.querySelector('.certification-section');
            if (!certSection) return;
            
            // Reset any previous page break class to get accurate measurements
            certSection.classList.remove('page-break-before');
            
            // Force a layout recalculation
            certSection.offsetHeight;
            
            const rect = certSection.getBoundingClientRect();
            const certHeight = rect.height;
            const certTop = rect.top;
            
            // Estimate print page height (assuming standard letter size at 96 DPI)
            // Standard letter: 11 inches - 1 inch margins = 10 inches usable
            // At 96 DPI: 10 * 96 = 960px usable height per page
            const printPageHeight = 960;
            const pageMargin = 48; // 0.5 inch margins
            
            // Calculate current position on the page
            const currentPagePosition = certTop % printPageHeight;
            const remainingPageSpace = printPageHeight - currentPagePosition - pageMargin;
            
            // Add some buffer space (50px) to ensure comfortable fit
            const requiredSpace = certHeight + 50;
            
            false && console.log('Certification section analysis:', {
              certHeight,
              certTop,
              currentPagePosition,
              remainingPageSpace,
              requiredSpace,
              needsPageBreak: requiredSpace > remainingPageSpace
            });
            
            // Only add page break if certification truly won't fit
            if (requiredSpace > remainingPageSpace && remainingPageSpace < printPageHeight * 0.4) {
              // console.log('Adding page break for certification section');
              certSection.classList.add('page-break-before');
            }
          }
          
          // Run check when page loads and before printing
          document.addEventListener('DOMContentLoaded', function() {
            // Delay to ensure all content is rendered
            setTimeout(checkCertificationPageBreak, 100);
          });
          window.addEventListener('beforeprint', checkCertificationPageBreak);
        <\/script>

        <div class="no-print" style="margin-top: 30px; text-align: center;">
          <button onclick="window.print()" style="padding: 10px 20px; font-size: 16px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
            ${e("common.printSavePDF")}
          </button>
          <button onclick="window.close()" style="padding: 10px 20px; font-size: 16px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer; margin-left: 10px;">
            ${e("common.close")}
          </button>
        </div>
      </body>
      </html>
    `;r.document.write(o),r.document.close(),r.focus(),console.log("Printable PDF window opened")}catch(r){console.error("Error generating printable PDF:",r),alert("Error generating printable PDF: "+r.message)}},nD=(t,e)=>`
  ${t.products&&t.products.length>0?`
        <div class="section">
          <div class="section-title">${e("invoices.products")}</div>
          <table>
            <thead>
              <tr>
                <th>${e("invoices.code")}</th>
                <th>${e("invoices.description")}</th>
                <th>${e("invoices.qty")}</th>
                <th>${e("invoices.unitPrice")}</th>
                <th>${e("invoices.total")}</th>
              </tr>
            </thead>
            <tbody>
              ${t.products.map(r=>`
                <tr>
                  <td>${r.product?.code||"N/A"}</td>
                  <td>${r.product?.label||"N/A"}</td>
                  <td>${Math.abs(r.qty||0).toFixed(2)}</td>
                  <td>$${parseFloat(r.salePrice||0).toFixed(2)}</td>
                  <td>$${(r.total||Math.abs(r.qty||0)*parseFloat(r.salePrice||0)).toFixed(2)}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </div>
        `:""}
       

        ${t.reservas&&t.reservas.length>0?`
        <div class="section">
          <div class="section-title">${e("invoices.reservations")}</div>
          <table>
            <thead>
              <tr>
                <th>${e("invoices.type")}</th>
                <th>${e("invoices.qty")}</th>
                <th>${e("invoices.unitPrice")}</th>
                <th>${e("invoices.arancel")}</th>
                <th>${e("invoices.total")}</th>
              </tr>
            </thead>
            <tbody>
              ${t.reservas.map(r=>{const n=parseFloat(r.qty||0),i=parseFloat(r.price||0),o=parseFloat(r.arancel||0),s=r.total||n*i+o;return`
                  <tr>
                    <td>${r.type||"N/A"}</td>
                    <td>${n.toFixed(2)}</td>
                    <td>$${i.toFixed(2)}</td>
                    <td>${o>0?"$"+o.toFixed(2):"-"}</td>
                    <td>$${s.toFixed(2)}</td>
                  </tr>
                `}).join("")}
            </tbody>
          </table>
        </div>
        `:""}

        ${t.services&&t.services.length>0?`
        <div class="section">
          <div class="section-title">${e("invoices.services")}</div>
          <table>
            <thead>
              <tr>
                <th>${e("invoices.type")}</th>
                <th>${e("invoices.qty")}</th>
                <th>${e("invoices.arancel")}</th>
                <th>${e("invoices.total")}</th>
              </tr>
            </thead>
            <tbody>
              ${t.services.map(r=>{const n=parseFloat(r.qty||0),i=parseFloat(r.arancel||r.price||0),o=r.total||n*i;return`
                  <tr>
                    <td>${r.type||"N/A"}</td>
                    <td>${n.toFixed(2)}</td>
                    <td>${i>0?"$"+i.toFixed(2):"-"}</td>
                    <td>$${o.toFixed(2)}</td>
                  </tr>
                `}).join("")}
            </tbody>
          </table>
        </div>
        `:""}
  `,iD=async(t,e)=>{try{console.log("Starting professional PDF generation...");const n=(await no(()=>Promise.resolve().then(()=>i_),void 0)).default,i=new n,o=210,s=297,l=15,c=o-l*2,d={r:180,g:180,b:180},u={r:80,g:80,b:80},h={r:130,g:130,b:130},g={r:248,g:248,b:248},m={r:252,g:252,b:252},S={r:120,g:120,b:120},N={r:150,g:150,b:150};let x=l;const b=Z=>{i.setTextColor(Z.r,Z.g,Z.b)},K=Z=>{i.setFillColor(Z.r,Z.g,Z.b)},te=(Z,oe,de,re,Y,ce=!1)=>{i.roundedRect(Z,oe,de,re,Y,Y,ce?"F":"S")};K(m),i.rect(0,0,o,50,"F"),i.setDrawColor(d.r,d.g,d.b),i.setLineWidth(.5),i.line(0,50,o,50),b(u),i.setFontSize(32),i.setFont("helvetica","bold"),i.text("HRM",l,25),b(h),i.setFontSize(32),i.setFont("helvetica","normal");const F=i.getTextWidth("HRM ");i.text("FINANCE",l+F,25),b(h),i.setFontSize(9),i.setFont("helvetica","normal"),i.text("Professional Business Solutions",l,35);const V=70,W=o-l-V;i.setDrawColor(d.r,d.g,d.b),i.setLineWidth(.5),te(W,12,V,26,2,!1),b(u),i.setFontSize(14),i.setFont("helvetica","bold");const I=e("common.invoice").toUpperCase(),E=i.getTextWidth(I);i.text(I,W+(V-E)/2,22),i.setFontSize(11),i.setFont("helvetica","normal");const L=t.invoice||"N/A",M=i.getTextWidth(L);i.text(L,W+(V-M)/2,32),x=60,K(m),i.rect(0,50,o,20,"F");const P=t.isCompleted,w=P?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase();b(P?u:h),i.setFontSize(8),i.setFont("helvetica","bold"),i.text(`STATUS: ${w}`,l,58),b(h),i.setFontSize(9),i.setFont("helvetica","normal");const j=t.createDate?new Date(t.createDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A";i.text(j,o-l-i.getTextWidth(j),58),x=58,i.text(`${e("common.store")}: ${t.store||"N/A"}`,l+60,x),x+=5,i.text(`${e("common.orderId")}: ${t.ssg_sorder_key||"N/A"}`,l+60,x),t.shippingMethod&&i.text(`${e("common.shipping")}: ${t.shippingMethod==="aereo"?e("common.air"):e("common.sea")}`,o-l-50,x),x=80,b(u),i.setFontSize(14),i.setFont("helvetica","bold"),i.text(e("invoices.customerInformation"),l,x),x+=10;const z=45,T=10,R=(c-T)/2;K(m),te(l,x,R,z,3,!0),i.setDrawColor(d.r,d.g,d.b),i.setLineWidth(.3),te(l,x,R,z,3);const J=t.shipper_consignee||{};let X=x+8;b(h),i.setFontSize(9),i.text(e("invoices.senderInformation"),l+5,X),X+=7,b(u),i.setFontSize(11),i.setFont("helvetica","bold"),i.text(J.name||"N/A",l+5,X),J.phoneNumberS&&(X+=6,i.setFont("helvetica","normal"),i.setFontSize(9),b(h),i.text(`${e("invoices.altPhone")}: ${J.phoneNumberS}`,l+5,X)),K(m),te(l+R+T,x,R,z,3,!0),i.setDrawColor(d.r,d.g,d.b),i.setLineWidth(.3),te(l+R+T,x,R,z,3),X=x+8,b(h),i.setFontSize(9),i.text(e("invoices.receiptInformation"),l+R+T+5,X),X+=7;const H=[J.firstName,J.middleName,J.lastName,J.lastName2].filter(Boolean).join(" ")||"N/A";if(b(u),i.setFontSize(11),i.setFont("helvetica","bold"),i.text(H,l+R+T+5,X),X+=6,i.setFont("helvetica","normal"),i.setFontSize(9),b(h),i.text(`${e("invoices.phoneNumber")}: ${J.phoneNumber||"N/A"}`,l+R+T+5,X),X+=5,i.text(`${e("invoices.id")}: ${J.cid||"N/A"}`,l+R+T+5,X),J.address)X+=5,J.address.split(",").map(oe=>oe.trim()).forEach((oe,de)=>{de<2&&oe&&(i.text(oe,l+R+T+5,X),X+=5)});else{let Z=`${J.ybstreet||""} #${J.ybstreetNo||""} ${e("invoices.between")} ${J.ybbetwen1||""} ${e("invoices.and")} ${J.ybbetwen2||""}`,oe=`${J.ybreparto||""}, ${J.ybcity||""}, ${J.ybestate||""}`;X+=5,i.text(Z,l+R+T+5,X),X+=5,i.text(oe,l+R+T+5,X)}if(x+=z+15,t?.products&&t?.products?.length>0){b(u),i.setFontSize(14),i.setFont("helvetica","bold"),i.text(e("invoices.products"),l,x),x+=10,K(g),i.rect(l,x-6,c,10,"F"),i.setDrawColor(d.r,d.g,d.b),i.setLineWidth(.3),i.line(l,x+4,o-l,x+4),i.setFontSize(9),i.setFont("helvetica","bold"),b(u);const Z={code:l+5,description:l+35,qty:l+115,price:l+135,total:l+160};i.text(e("invoices.code"),Z.code,x),i.text(e("invoices.description"),Z.description,x),i.text(e("invoices.qty"),Z.qty,x),i.text(e("invoices.unitPrice"),Z.price,x),i.text(e("invoices.total"),Z.total,x),x+=10,i.setFont("helvetica","normal"),i.setFontSize(9),t.products.forEach((oe,de)=>{x>250&&(i.addPage(),x=l),de%2===0&&(K(m),i.rect(l,x-4,c,8,"F")),b(u),i.text(oe.product?.code||"N/A",Z.code,x);let re=oe.product?.label||"N/A";i.getTextWidth(re)>70&&(re=re.substring(0,40)+"..."),i.text(re,Z.description,x);const Y=Math.abs(oe.qty||0),ce=parseFloat(oe.salePrice||0),ue=oe.total||Y*ce;i.text(Y.toString(),Z.qty,x),i.text(`$${ce.toFixed(2)}`,Z.price,x),i.setFont("helvetica","bold"),i.text(`$${ue.toFixed(2)}`,Z.total,x),i.setFont("helvetica","normal"),x+=8}),i.setDrawColor(d.r,d.g,d.b),i.setLineWidth(.3),i.line(l,x,o-l,x),x+=15}if(t.reservas&&t.reservas.length>0){x>200&&(i.addPage(),x=l),b(u),i.setFontSize(14),i.setFont("helvetica","bold"),i.text(e("invoices.reservations"),l,x),x+=10,K(g),i.rect(l,x-6,c,10,"F"),i.setDrawColor(d.r,d.g,d.b),i.setLineWidth(.3),i.line(l,x+4,o-l,x+4),i.setFontSize(9),i.setFont("helvetica","bold"),b(u);const Z={type:l+5,qty:l+65,price:l+95,arancel:l+125,total:l+160};i.text(e("invoices.type"),Z.type,x),i.text(e("invoices.qty"),Z.qty,x),i.text(e("invoices.unitPrice"),Z.price,x),i.text(e("invoices.arancel"),Z.arancel,x),i.text(e("invoices.total"),Z.total,x),x+=10,i.setFont("helvetica","normal"),i.setFontSize(9),t.reservas.forEach((oe,de)=>{x>250&&(i.addPage(),x=l),de%2===0&&(K(m),i.rect(l,x-4,c,8,"F")),b(u),i.text(oe.type||"N/A",Z.type,x);const re=parseFloat(oe.qty||0),Y=parseFloat(oe.price||0),ce=parseFloat(oe.arancel||0),ue=oe.total||re*Y+ce;i.text(re.toString(),Z.qty,x),i.text(`$${Y.toFixed(2)}`,Z.price,x),i.text(`$${ce.toFixed(2)}`,Z.arancel,x),i.setFont("helvetica","bold"),i.text(`$${ue.toFixed(2)}`,Z.total,x),i.setFont("helvetica","normal"),x+=8}),i.setDrawColor(d.r,d.g,d.b),i.setLineWidth(.3),i.line(l,x,o-l,x),x+=15}x>210&&(i.addPage(),x=l);const se=o-l-80,O=80;let _=60;t.taxAmount&&t.taxAmount>0&&(_+=16),K(m),te(se-10,x,O+10,_,3,!0),i.setDrawColor(d.r,d.g,d.b),i.setLineWidth(.3),te(se-10,x,O+10,_,3);let k=x+10;if(i.setFontSize(10),b(h),t.productSubtotal!==void 0&&t.productSubtotal>0&&(i.text(e("invoices.productsSubtotal"),se,k),i.text(`$${t.productSubtotal.toFixed(2)}`,se+O-15,k,{align:"right"}),k+=8),t.reservaSubtotal!==void 0&&t.reservaSubtotal>0&&(i.text(e("invoices.reservationsSubtotal"),se,k),i.text(`$${t.reservaSubtotal.toFixed(2)}`,se+O-15,k,{align:"right"}),k+=8),t.taxAmount&&t.taxAmount>0){i.text(e("common.subtotal"),se,k),i.text(`$${(t.subtotalBeforeTax||0).toFixed(2)}`,se+O-15,k,{align:"right"}),k+=8;const Z=t.paymentMethods?.taxPercent||7;i.text(`${e("common.tax")} (${Z}%)`,se,k),i.text(`$${t.taxAmount.toFixed(2)}`,se+O-15,k,{align:"right"}),k+=8}if(i.setDrawColor(d.r,d.g,d.b),i.setLineWidth(.3),i.line(se,k+2,se+O-10,k+2),k+=10,i.setFontSize(14),i.setFont("helvetica","bold"),b(u),i.text(e("invoices.total"),se,k),i.text(`$${(t.total||0).toFixed(2)}`,se+O-15,k,{align:"right"}),t.paymentMethods){x+=_+20,b(u),i.setFontSize(12),i.setFont("helvetica","bold"),i.text(e("common.paymentMethods"),l,x),x+=10,i.setFontSize(10),i.setFont("helvetica","normal"),b(h);const Z=t.paymentMethods;let oe=x;Z.cash&&Z.cash>0&&(i.text(`${e("common.cash")}:`,l+5,oe),i.text(`$${Z.cash.toFixed(2)}`,l+50,oe),oe+=6),Z.zelle&&Z.zelle>0&&(i.text("Zelle:",l+5,oe),i.text(`$${Z.zelle.toFixed(2)}`,l+50,oe),oe+=6),Z.creditCard&&Z.creditCard>0&&(i.text(`${e("common.creditCard")}:`,l+5,oe),i.text(`$${Z.creditCard.toFixed(2)}`,l+50,oe),oe+=6),Z.exemptTaxOnCash&&Z.cash>0&&t.taxSavings>0&&(oe+=4,i.setFontSize(9),i.setFont("helvetica","italic"),i.text(`* Tax exempted on cash payment. You saved $${t.taxSavings.toFixed(2)}!`,l+5,oe)),x=oe+10}x=s-30,K(m),i.rect(0,x-10,o,40,"F"),i.setFontSize(12),i.setFont("helvetica","italic"),b(h);const $=e("common.thankYouBusiness"),G=i.getTextWidth($);i.text($,(o-G)/2,x),x+=8,i.setFontSize(9),i.setFont("helvetica","normal");const ne="www.hrmfinance.com | info@hrmfinance.com | +1 (555) 123-4567",U=i.getTextWidth(ne);i.text(ne,(o-U)/2,x),x+=8,i.setFontSize(8);const D=`Generated on ${new Date().toLocaleString("en-US")}`,B=i.getTextWidth(D);i.text(D,(o-B)/2,x);const Q=`invoice-${t.invoice||"unknown"}.pdf`;i.save(Q),console.log("Professional PDF saved successfully:",Q)}catch(r){throw console.error("Error in generateProfessionalInvoicePDF:",r),r}},wn=t=>parseFloat(t?.toString()||"0")||0,oD=t=>{if(t?.includes("/")){const[e,r,n]=t.split("/");return`${n}-${e.padStart(2,"0")}-${r.padStart(2,"0")}`}if(t?.includes("-")){const[e,r,n]=t.split("-");return`${n}-${e.padStart(2,"0")}-${r.padStart(2,"0")}`}return t},sD=t=>{const e=[];return t?.ybstreet&&(e.push(t?.ybstreet),t?.ybstreetNo&&e.push(`# ${t?.ybstreetNo}`)),t?.ybbetwen1&&t?.ybbetwen2&&e.push(`/ ${t?.ybbetwen1} y ${t.ybbetwen2}`),t?.ybreparto&&e.push(`, Rpto ${t?.ybreparto}`),t?.ybcity&&e.push(`, ${t?.ybcity}`),t?.ybestate&&e.push(`, ${t?.ybestate}`),e.join(" ")},aD=t=>{const e=wn(t.qty),r=wn(t.price),n=wn(t.arancel);return t.onlyTariff,{lbs:e*r,arancel:n,total:e*r+n}},lD=t=>{const e=Math.abs(t.qty),r=wn(t.salePrice);return e*r},cD=(t,e)=>{const r=t.split("-");if(r.length>=3){const n=r[0];return{YY_8803:"BISSONNET"}[n]||e}return e},pp=t=>{const e=t?.products?.reduce((V,W)=>V+lD(W),0),r=t?.reservas?.reduce((V,W)=>V+aD(W).total,0),n=t?.services?.reduce((V,W)=>{const I=wn(W.qty),E=wn(W.arancel);return V+I*E},0)||0;var i=0;t.bulks&&t.bulks.length>0&&t.bulks.forEach(V=>{i+=V?.transportCost||20});const o=t.transportTotal||i,s=parseFloat(wn(r).toFixed(2)),l=parseFloat(wn(n).toFixed(2));var c=wn(e)+wn(r)+wn(n)+wn(o),d=t?.TaxPercent||0,u=c*d/100,h=0,g=c+u,m=0;t?.paymentMethods&&t.subtotalBeforeTax&&(d=t?.paymentMethods?.taxPercent||0,u=t.taxAmount||0,g=t.total||0,c=t.subtotalBeforeTax||0,h=t?.taxSavings||0);const N=(t?.products||[])?.map((V,W)=>({id:Date.now().toString()+W,product:{id:V.product.id,code:V.product.code,label:V.product.label,price:0},qty:Math.abs(V.qty),salePrice:wn(V.salePrice),total:Math.abs(V.qty)*wn(V.salePrice),bulkId:V.bulkId})),x=t?.reservas?.map((V,W)=>({id:Date.now().toString()+W+1e3,type:V.type,qty:wn(V.qty),price:wn(V.price),arancel:wn(V.arancel),total:wn(V.qty)*wn(V.price)+wn(V.arancel),bulkId:V.bulkId})),b=t?.services?.map((V,W)=>{const I=wn(V.qty),E=wn(V.arancel);return{id:Date.now().toString()+W+2e3,type:V.type,qty:I,arancel:E,total:I*E,bulkId:V.bulkId}})||[],K={name:t.shipper_consignee?.name,firstName:t.shipper_consignee?.firstName,middleName:t.shipper_consignee?.middleName||"",lastName:t.shipper_consignee?.lastName,lastName2:t.shipper_consignee?.lastName2||"",phoneNumber:t.shipper_consignee?.phoneNumber,cid:t.shipper_consignee?.cid,passport:t.shipper_consignee?.passport||"",address:sD(t.shipper_consignee),phoneNumberS:t.shipper_consignee?.phoneNumberS,dob:oD(t.shipper_consignee?.dob)},te=cD(t.invoice,t.store),F=t.shippingMethod?.toLowerCase()==="aereo"?"aereo":"maritimo";return{invoice:t.invoice,description:t.description||"",store:te,shipper_consignee:K,products:N,reservas:x,services:b,bulks:t?.bulks,packagesOrder:t.packagesOrder,shippingMethod:F,paymentMethods:t?.paymentMethods,type:t.type,ssg_inventory_key:t.ssg_inventory_key,ssg_sorder_key:t.ssg_sorder_key,createDate:t.createDate,businessId:t.businessId,isCompleted:t.isCompleted,productSubtotal:e,reservaSubtotal:s,serviceSubtotal:l,subtotalBeforeTax:c,taxAmount:u,taxSavings:h,transportTotal:o,total:g,taxCalculationMethod:"subtotal",cashPaymentRatio:m}};var dD=le("<div>: <strong></strong> | <!>: <strong>"),uD=le("<div>: <!> + <!>: "),J1=le("<thead><tr><th></th><th></th><th></th><th></th><th>"),dy=le("<div><h5> (<!>)</h5><table><tbody>"),hD=le("<thead><tr><th></th><th></th><th></th><th>"),pD=le("<div>"),mD=le("<div><div><div><h4>📦 </h4></div><div><div>"),yD=le("<strong>/<!> lbs"),X1=le("<tr><td></td><td></td><td></td><td></td><td>"),fD=le("<tr><td></td><td></td><td></td><td>");const gD=t=>{const e=()=>t.products.filter(S=>S.bulkId===t.bulk?.id),r=()=>t.reservas.filter(S=>S.bulkId===t.bulk?.id),n=()=>t.services.filter(S=>S.bulkId===t.bulk?.id),i=()=>{const S=e().reduce((te,F)=>te+Math.abs(F.qty)*t.parseFloat2(F.salePrice),0),N=r().reduce((te,F)=>te+((t.parseFloat2(F.qty)||0)*(t.parseFloat2(F.price)||0)+(F.arancel?t.parseFloat2(F.arancel):0)),0),x=n().reduce((te,F)=>te+(t.parseFloat2(F.qty)||0)*(F.arancel||F.price?t.parseFloat2(F.arancel||F.price):0),0),b=S+N+x,K=b+(t.bulk?.transportCost||20);return{productsTotal:S,reservasTotal:N,servicesTotal:x,itemsTotal:b,grandTotal:K}},o=()=>({border:"1px solid var(--border-color)","border-radius":t.compact?"var(--border-radius-sm)":"var(--border-radius)",padding:t.compact?"0.75rem":"1rem","margin-bottom":t.compact?"0.75rem":"1rem",background:"var(--strip-color)"}),s=()=>({display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":t.compact?"0.5rem":"1rem","padding-bottom":t.compact?"0.25rem":"0.5rem","border-bottom":"1px solid var(--border-color)"}),l=()=>({margin:0,"font-size":t.compact?"1rem":"1.1rem","font-weight":"bold",color:"var(--text-primary)"}),c=()=>({"font-size":t.compact?"0.75rem":"0.875rem",color:"var(--text-muted)","margin-top":"0.25rem"}),d=()=>({"text-align":"right","font-weight":"bold","font-size":t.compact?"1rem":"1.1rem",color:"var(--primary-color)"}),u=()=>({"font-size":t.compact?"0.65rem":"0.75rem",color:"var(--text-muted)","margin-top":"0.125rem"}),h=()=>({margin:"0 0 0.5rem 0","font-size":t.compact?"0.85rem":"0.95rem",color:"var(--text-secondary)","font-weight":"500"}),g=()=>({...t.tableStyle,"font-size":t.compact?"0.8rem":"0.875rem","margin-bottom":t.compact?"0.5rem":"0.75rem"}),m=()=>({...t.tdStyle,padding:t.compact?"0.375rem":"0.5rem"});return(()=>{var S=mD(),N=S.firstChild,x=N.firstChild,b=x.firstChild;b.firstChild;var K=x.nextSibling,te=K.firstChild;return a(b,()=>t.bulk?.name,null),a(x,A(Me,{get when(){return t.showDetails},get children(){var F=dD(),V=F.firstChild,W=V.nextSibling,I=W.nextSibling,E=I.nextSibling,L=E.nextSibling,M=L.nextSibling;return a(F,()=>t.t("invoices.type"),V),a(W,()=>t.bulk?.type),a(F,()=>t.t("invoices.shippingMethod"),E),a(M,()=>t.bulk?.shippingMethod==="aereo"?"🛩️ Aéreo":"🚢 Marítimo"),a(F,(()=>{var P=ke(()=>!!(t.bulk?.currentWeight&&t.bulk?.maxWeight));return()=>P()&&[" | ",ke(()=>t.t("invoices.weight")),": ",(()=>{var w=yD(),v=w.firstChild,j=v.nextSibling;return j.nextSibling,a(w,()=>t.bulk?.currentWeight,v),a(w,()=>t.bulk?.maxWeight,j),w})()]})(),null),ge(P=>p(F,c(),P)),F}}),null),K.style.setProperty("text-align","right"),a(te,()=>t.formatCurrency(i().grandTotal)),a(K,A(Me,{get when(){return t.showDetails},get children(){var F=uD(),V=F.firstChild,W=V.nextSibling,I=W.nextSibling,E=I.nextSibling;return E.nextSibling,a(F,()=>t.t("invoices.items"),V),a(F,()=>t.formatCurrency(i().itemsTotal),W),a(F,()=>t.t("invoiceReport.transport"),E),a(F,()=>t.formatCurrency(t.bulk?.transportCost||20),null),ge(L=>p(F,u(),L)),F}}),null),a(S,A(Me,{get when(){return e().length>0},get children(){var F=dy(),V=F.firstChild,W=V.firstChild,I=W.nextSibling;I.nextSibling;var E=V.nextSibling,L=E.firstChild;return a(V,()=>t.t("invoices.products"),W),a(V,()=>e().length,I),a(E,A(Me,{get when(){return!t.compact},get children(){var M=J1(),P=M.firstChild,w=P.firstChild,v=w.nextSibling,j=v.nextSibling,z=j.nextSibling,T=z.nextSibling;return a(w,()=>t.t("invoices.code")),a(v,()=>t.t("invoices.description")),a(j,()=>t.t("invoices.qty")),a(z,()=>t.t("invoices.unitPrice")),a(T,()=>t.t("invoices.total")),ge(R=>{var J=t.thStyle,X=t.thStyle,H={...t.thStyle,"text-align":"center"},se={...t.thStyle,"text-align":"right"},O={...t.thStyle,"text-align":"right"};return R.e=p(w,J,R.e),R.t=p(v,X,R.t),R.a=p(j,H,R.a),R.o=p(z,se,R.o),R.i=p(T,O,R.i),R},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),M}}),L),a(L,A(vt,{get each(){return e()},children:M=>(()=>{var P=X1(),w=P.firstChild,v=w.nextSibling,j=v.nextSibling,z=j.nextSibling,T=z.nextSibling;return a(w,()=>M.product.code),a(v,()=>M.product.label),a(j,()=>Math.abs(M.qty)),a(z,()=>t.formatCurrency(M.salePrice)),a(T,()=>t.formatCurrency(Math.abs(M.qty)*t.parseFloat2(M.salePrice))),ge(R=>{var J=m(),X=m(),H={...m(),"text-align":"center"},se={...m(),"text-align":"right"},O={...m(),"text-align":"right"};return R.e=p(w,J,R.e),R.t=p(v,X,R.t),R.a=p(j,H,R.a),R.o=p(z,se,R.o),R.i=p(T,O,R.i),R},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),P})()})),ge(M=>{var P=t.compact?"0.5rem":"0.75rem",w=h(),v=g();return P!==M.e&&((M.e=P)!=null?F.style.setProperty("margin-bottom",P):F.style.removeProperty("margin-bottom")),M.t=p(V,w,M.t),M.a=p(E,v,M.a),M},{e:void 0,t:void 0,a:void 0}),F}}),null),a(S,A(Me,{get when(){return r().length>0},get children(){var F=dy(),V=F.firstChild,W=V.firstChild,I=W.nextSibling;I.nextSibling;var E=V.nextSibling,L=E.firstChild;return a(V,()=>t.t("invoices.reservations"),W),a(V,()=>r().length,I),a(E,A(Me,{get when(){return!t.compact},get children(){var M=J1(),P=M.firstChild,w=P.firstChild,v=w.nextSibling,j=v.nextSibling,z=j.nextSibling,T=z.nextSibling;return a(w,()=>t.t("invoices.type")),a(v,()=>t.t("invoices.qty")),a(j,()=>t.t("invoices.unitPrice")),a(z,()=>t.t("invoices.arancel")),a(T,()=>t.t("invoices.total")),ge(R=>{var J=t.thStyle,X={...t.thStyle,"text-align":"center"},H={...t.thStyle,"text-align":"right"},se={...t.thStyle,"text-align":"right"},O={...t.thStyle,"text-align":"right"};return R.e=p(w,J,R.e),R.t=p(v,X,R.t),R.a=p(j,H,R.a),R.o=p(z,se,R.o),R.i=p(T,O,R.i),R},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),M}}),L),a(L,A(vt,{get each(){return r()},children:M=>(()=>{var P=X1(),w=P.firstChild,v=w.nextSibling,j=v.nextSibling,z=j.nextSibling,T=z.nextSibling;return a(w,()=>M.type),a(v,()=>M.qty),a(j,()=>t.formatCurrency(M.price)),a(z,()=>M.arancel||"-"),a(T,()=>t.formatCurrency((t.parseFloat2(M.qty)||0)*(t.parseFloat2(M.price)||0)+(M.arancel?t.parseFloat2(M.arancel):0))),ge(R=>{var J=m(),X={...m(),"text-align":"center"},H={...m(),"text-align":"right"},se={...m(),"text-align":"right"},O={...m(),"text-align":"right"};return R.e=p(w,J,R.e),R.t=p(v,X,R.t),R.a=p(j,H,R.a),R.o=p(z,se,R.o),R.i=p(T,O,R.i),R},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),P})()})),ge(M=>{var P=t.compact?"0.5rem":"0.75rem",w=h(),v=g();return P!==M.e&&((M.e=P)!=null?F.style.setProperty("margin-bottom",P):F.style.removeProperty("margin-bottom")),M.t=p(V,w,M.t),M.a=p(E,v,M.a),M},{e:void 0,t:void 0,a:void 0}),F}}),null),a(S,A(Me,{get when(){return n().length>0},get children(){var F=dy(),V=F.firstChild,W=V.firstChild,I=W.nextSibling;I.nextSibling;var E=V.nextSibling,L=E.firstChild;return a(V,()=>t.t("invoices.services"),W),a(V,()=>n().length,I),a(E,A(Me,{get when(){return!t.compact},get children(){var M=hD(),P=M.firstChild,w=P.firstChild,v=w.nextSibling,j=v.nextSibling,z=j.nextSibling;return a(w,()=>t.t("invoices.type")),a(v,()=>t.t("invoices.qty")),a(j,()=>t.t("invoices.arancel")),a(z,()=>t.t("invoices.total")),ge(T=>{var R=t.thStyle,J={...t.thStyle,"text-align":"center"},X={...t.thStyle,"text-align":"right"},H={...t.thStyle,"text-align":"right"};return T.e=p(w,R,T.e),T.t=p(v,J,T.t),T.a=p(j,X,T.a),T.o=p(z,H,T.o),T},{e:void 0,t:void 0,a:void 0,o:void 0}),M}}),L),a(L,A(vt,{get each(){return n()},children:M=>(()=>{var P=fD(),w=P.firstChild,v=w.nextSibling,j=v.nextSibling,z=j.nextSibling;return a(w,()=>M.type),a(v,()=>t.parseFloat2(M.qty).toFixed(2)),a(j,(()=>{var T=ke(()=>!!(M.arancel||M.price));return()=>T()?t.formatCurrency(M.arancel||M.price):"-"})()),a(z,()=>t.formatCurrency((t.parseFloat2(M.qty)||0)*(M.arancel||M.price?t.parseFloat2(M.arancel||M.price):0))),ge(T=>{var R=m(),J={...m(),"text-align":"center"},X={...m(),"text-align":"right"},H={...m(),"text-align":"right"};return T.e=p(w,R,T.e),T.t=p(v,J,T.t),T.a=p(j,X,T.a),T.o=p(z,H,T.o),T},{e:void 0,t:void 0,a:void 0,o:void 0}),P})()})),ge(M=>{var P=h(),w=g();return M.e=p(V,P,M.e),M.t=p(E,w,M.t),M},{e:void 0,t:void 0}),F}}),null),a(S,A(Me,{get when(){return ke(()=>e().length===0&&r().length===0)()&&n().length===0},get children(){var F=pD();return F.style.setProperty("text-align","center"),F.style.setProperty("color","var(--text-muted)"),F.style.setProperty("font-style","italic"),a(F,()=>t.t("invoices.emptyBulk")),ge(V=>{var W=t.compact?"1rem":"1.5rem",I=t.compact?"0.8rem":"0.875rem";return W!==V.e&&((V.e=W)!=null?F.style.setProperty("padding",W):F.style.removeProperty("padding")),I!==V.t&&((V.t=I)!=null?F.style.setProperty("font-size",I):F.style.removeProperty("font-size")),V},{e:void 0,t:void 0}),F}}),null),ge(F=>{var V=o(),W=s(),I=l(),E=d();return F.e=p(S,V,F.e),F.t=p(N,W,F.t),F.a=p(b,I,F.a),F.o=p(te,E,F.o),F},{e:void 0,t:void 0,a:void 0,o:void 0}),S})()},Z1={cashSales:{debit:"1001",credit:"4001"},creditSales:{debit:"1101",credit:"4001"},inventoryPurchase:{debit:"1201",credit:"1001"},costOfGoodsSold:{debit:"5001",credit:"1201"},serviceRevenue:{debit:"1001",credit:"4101"},salesTax:{debit:"1001",credit:"2301"},customsFees:{debit:"1401",credit:"1001"},transportRevenue:{debit:"1001",credit:"4201"}},eb=[{id:"cash-sale-completed",name:"Cash Sale Completed",description:"Creates journal entry when cash sale invoice is completed",triggerEvent:"invoice_completed",isActive:!0,priority:100,conditions:[{field:"paymentMethods.cash",operator:"greaterThan",value:0}],actions:[{type:"create_journal_entry",accountMappings:[{debitAccountId:"1001",creditAccountId:"4001",amountExpression:"paymentMethods.cash",description:"Cash sale - Invoice #{invoice}"}]}]},{id:"credit-sale-completed",name:"Credit Sale Completed",description:"Creates journal entry when credit sale invoice is completed",triggerEvent:"invoice_completed",isActive:!0,priority:90,conditions:[{field:"paymentMethods.zelle",operator:"greaterThan",value:0}],actions:[{type:"create_journal_entry",accountMappings:[{debitAccountId:"1101",creditAccountId:"4001",amountExpression:"paymentMethods.zelle",description:"Credit sale (Zelle) - Invoice #{invoice}"}]}]},{id:"service-revenue-transport",name:"Transport Service Revenue",description:"Records transport service revenue when services are billed",triggerEvent:"service_rendered",isActive:!0,priority:80,conditions:[{field:"services.type",operator:"contains",value:"Transportación"}],actions:[{type:"create_journal_entry",accountMappings:[{debitAccountId:"1001",creditAccountId:"4201",amountExpression:"services.total",description:"Transport service - Invoice #{invoice}"}]}]},{id:"customs-fees",name:"Customs Fees Collection",description:"Records customs fees collected from customers",triggerEvent:"invoice_completed",isActive:!0,priority:70,conditions:[{field:"arancelesTotal",operator:"greaterThan",value:0}],actions:[{type:"create_journal_entry",accountMappings:[{debitAccountId:"1001",creditAccountId:"1401",amountExpression:"arancelesTotal",description:"Customs fees collection - Invoice #{invoice}"}]}]},{id:"sales-tax-collection",name:"Sales Tax Collection",description:"Records sales tax collected on taxable transactions",triggerEvent:"tax_calculated",isActive:!0,priority:60,conditions:[{field:"taxAmount",operator:"greaterThan",value:0}],actions:[{type:"create_journal_entry",accountMappings:[{debitAccountId:"1001",creditAccountId:"2301",amountExpression:"taxAmount",description:"Sales tax collected - Invoice #{invoice}"}]}]}];class vD{config;setConfig;constructor(){const[e,r]=Se({isEnabled:!0,defaultMappings:Z1,customRules:eb,accountMappings:[],auditSettings:{logAllTransactions:!0,requireApproval:!1,approvalThreshold:1e3}});this.config=e,this.setConfig=r}get isEnabled(){return this.config().isEnabled}get defaultMappings(){return this.config().defaultMappings}get automationRules(){return this.config().customRules.filter(e=>e.isActive)}get accountMappings(){return this.config().accountMappings.filter(e=>e.isActive)}updateConfig(e){this.setConfig(r=>({...r,...e}))}toggleAutomation(e){this.updateConfig({isEnabled:e})}addAccountMapping(e){const r={...e,id:`mapping_${Date.now()}`,createdAt:new Date,updatedAt:new Date};return this.setConfig(n=>({...n,accountMappings:[...n.accountMappings,r]})),r.id}updateAccountMapping(e,r){this.setConfig(n=>({...n,accountMappings:n.accountMappings.map(i=>i.id===e?{...i,...r,updatedAt:new Date}:i)}))}removeAccountMapping(e){this.setConfig(r=>({...r,accountMappings:r.accountMappings.filter(n=>n.id!==e)}))}addAutomationRule(e){const r={...e,id:`rule_${Date.now()}`};return this.setConfig(n=>({...n,customRules:[...n.customRules,r]})),r.id}updateAutomationRule(e,r){this.setConfig(n=>({...n,customRules:n.customRules.map(i=>i.id===e?{...i,...r}:i)}))}toggleAutomationRule(e,r){this.updateAutomationRule(e,{isActive:r})}removeAutomationRule(e){this.setConfig(r=>({...r,customRules:r.customRules.filter(n=>n.id!==e)}))}getAccountMapping(e){return this.accountMappings.find(r=>r.transactionType===e)||null}getApplicableRules(e,r){return this.automationRules.filter(n=>n.triggerEvent===e).filter(n=>this.evaluateConditions(n.conditions,r)).sort((n,i)=>i.priority-n.priority)}evaluateConditions(e,r){return e.length===0?!0:e.every(n=>{const i=this.getNestedValue(r,n.field);switch(n.operator){case"equals":return i===n.value;case"contains":return String(i).toLowerCase().includes(String(n.value).toLowerCase());case"greaterThan":return Number(i)>Number(n.value);case"lessThan":return Number(i)<Number(n.value);case"in":return Array.isArray(n.value)?n.value.includes(i):!1;default:return!1}})}getNestedValue(e,r){return r.split(".").reduce((n,i)=>n?.[i],e)}resetToDefaults(){this.setConfig({isEnabled:!0,defaultMappings:Z1,customRules:eb,accountMappings:[],auditSettings:{logAllTransactions:!0,requireApproval:!1,approvalThreshold:1e3}})}exportConfiguration(){return this.config()}importConfiguration(e){this.setConfig(e)}}const Pn=new vD;class bD{auditLog=[];async processEvent(e,r){if(!Pn.isEnabled)return;const n=new Date;let i=[],o=[],s=!0,l;try{const c=Pn.getApplicableRules(e,r);for(const d of c)try{const u=await this.executeRule(d,r);i.push(d.name),o.push(...u)}catch(u){console.error(`Error executing rule ${d.name}:`,u),l=u.message,s=!1}}catch(c){console.error("Error processing automation event:",c),l=c.message,s=!1}this.auditLog.push({timestamp:n,event:e,context:r,rulesApplied:i,entriesCreated:o,success:s,error:l}),this.auditLog.length>1e3&&(this.auditLog=this.auditLog.slice(-1e3))}async executeRule(e,r){const n=[];for(const i of e.actions)if(i.type==="create_journal_entry"){const o=await this.createJournalEntry(i,r,e.name);o&&n.push(o)}return n}async createJournalEntry(e,r,n){try{const i=e.accountMappings.map(h=>{const g=this.evaluateAmountExpression(h.amountExpression,r),m=this.expandDescription(h.description,r);return[{accountId:h.debitAccountId,accountName:this.getAccountName(h.debitAccountId),debitAmount:g,creditAmount:0,description:m},{accountId:h.creditAccountId,accountName:this.getAccountName(h.creditAccountId),debitAmount:0,creditAmount:g,description:m}]}).flat(),o=i.reduce((h,g)=>h+g.debitAmount,0),s=i.reduce((h,g)=>h+g.creditAmount,0),l={entryNumber:this.getNextEntryNumber(),date:new Date().toISOString().split("T")[0],description:`Auto: ${n} - ${this.getContextDescription(r)}`,reference:this.getReference(r),status:"draft",createdBy:"automation",createdAt:new Date().toISOString(),totalDebit:o,totalCredit:s,lines:i.map(h=>({...h,id:`line_${Date.now()}_${Math.random()}`}))},c=await dn.addJournalEntry(l),d=Pn.exportConfiguration(),u=i.reduce((h,g)=>h+g.debitAmount,0);return(!d.auditSettings.requireApproval||u<=d.auditSettings.approvalThreshold)&&dn.postJournalEntry(c),c}catch(i){throw console.error("Error creating journal entry:",i),i}}evaluateAmountExpression(e,r){try{if(!isNaN(Number(e)))return Number(e);const n=this.getNestedValue(r,e);return Number(n)||0}catch(n){return console.error(`Error evaluating amount expression: ${e}`,n),0}}expandDescription(e,r){return e.replace(/\{([^}]+)\}/g,(n,i)=>{const o=this.getNestedValue(r,i);return String(o||n)})}getNestedValue(e,r){return r.split(".").reduce((n,i)=>n?.[i],e)}getAccountName(e){return{1001:"Cash - Operating",1101:"Accounts Receivable",1201:"Inventory - Products",1401:"Customs Fees Receivable",2301:"Sales Tax Payable",4001:"Sales Revenue - Products",4101:"Service Revenue",4201:"Transport Service Revenue",5001:"Cost of Goods Sold"}[e]||`Account ${e}`}getReference(e){return e.invoice?.invoice?`INV-${e.invoice.invoice}`:e.payment?.id?`PAY-${e.payment.id}`:e.inventoryMovement?.id?`INV-MOV-${e.inventoryMovement.id}`:`AUTO-${Date.now()}`}getNextEntryNumber(){return dn.getNextEntryNumber()}getContextDescription(e){return e.invoice?`Invoice ${e.invoice.invoice} - ${e.invoice.shipper_consignee?.name}`:e.payment?`Payment ${e.payment.id}`:e.inventoryMovement?`Inventory Movement ${e.inventoryMovement.type}`:"Automated Transaction"}getAuditLog(e=100){return this.auditLog.slice(-e).reverse()}clearAuditLog(){this.auditLog=[]}}const yf=new bD,tb=t=>yf.processEvent("invoice_completed",{invoice:t}),[uc,Br]=Bc({invoices:[],selectedInvoice:null,loading:!1,error:null,lastUpdated:null}),[PD,fo]=Se({fetchAll:!1,fetchById:!1,create:!1,update:!1,delete:!1,generatePDF:!1}),qi={get state(){return uc},get loadingStates(){return PD()},async fetchInvoices(t){try{fo(s=>({...s,fetchAll:!0})),Br("loading",!0),Br("error",null);let e="SALES";if(t?.search&&(e+=" "+t.search),t?.store&&t.store!=="all")e+=" "+t.store;else if(!Gt.state?.profile?.isAdmin)return e+=" "+ki(32),Br("invoices",[]),Br("lastUpdated",new Date),[];t?.status&&t.status!=="all"&&(e+=" "+t.status);const r=e.toString(),n=await ai.getInvoice(r);let i=[];if(t?.dateFrom&&t?.dateTo){const s=l=>{let c=new Date(n[l].createDate).getTime(),d=new Date(t?.dateFrom).getTime(),u=new Date(t?.dateTo).getTime();c>=d&&c<=u&&i.push(n[l])};Object.keys(n).map(s)}else i=gl(n);const o=Array.isArray(i)?i:i||[];return Br("invoices",o),Br("lastUpdated",new Date),o}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoices";throw Br("error",r),console.error("Error fetching invoices:",e),e}finally{Br("loading",!1),fo(e=>({...e,fetchAll:!1}))}},fecthInventory:async t=>{},async fetchInvoiceById(t){try{fo(n=>({...n,fetchById:!0})),Br("error",null);const e=await ai.getInvoice(t),r=gl(e);return Br("selectedInvoice",r[0]),r}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice";throw Br("error",r),console.error("Error fetching invoice:",e),e}finally{fo(e=>({...e,fetchById:!1}))}},async createInvoice(t){try{fo(r=>({...r,create:!0})),Br("error",null);const e={type:t.type||"SALES",invoice:t.invoice,description:t.description||"",store:t.store||"",ssg_inventory_key:t.ssg_inventory_key||`INV-${Date.now()}`,ssg_sorder_key:t.ssg_sorder_key||`SO-${Date.now()}`,createDate:t.createDate||Date.now(),shipper_consignee:t.shipper_consignee,packagesOrder:t.packagesOrder||!1,businessId:t.businessId||"YB100423253156428",userId:t.userId||"current-user",reservas:t.reservas||[],products:t.products||[],isCompleted:t.isCompleted||!0};if(e.products&&e.products.length>0&&(e.productSubtotal=e.products.reduce((r,n)=>r+n.qty*n.salePrice,0)),e.reservas&&e.reservas.length>0&&(e.reservaSubtotal=e.reservas.reduce((r,n)=>r+n.total,0)),e.total=(e.productSubtotal||0)+(e.reservaSubtotal||0),Br("invoices",r=>[e,...r]),Br("lastUpdated",new Date),e.isCompleted)try{await tb(e),console.log("Automated journal entries processed for invoice:",e.invoice)}catch(r){console.error("Error processing automated journal entries:",r)}return e}catch(e){const r=e instanceof Error?e.message:"Failed to create invoice";throw Br("error",r),console.error("Error creating invoice:",e),e}finally{fo(e=>({...e,create:!1}))}},async generateInvoicePDF(t,e="compact",r="es"){try{fo(l=>({...l,generatePDF:!0})),Br("error",null);const n=uc.invoices.find(l=>l.invoice===t);if(!n)throw new Error("Invoice not found");let i;switch(e){case"compact":const{generateCompactModernInvoicePDF:l}=await no(async()=>{const{generateCompactModernInvoicePDF:u}=await import("./compactModernInvoicePdfGenerator-gmfkGbyU.js");return{generateCompactModernInvoicePDF:u}},[]);i=l;break;case"modern":const{generateModernMovementInvoicePDF:c}=await no(async()=>{const{generateModernMovementInvoicePDF:u}=await import("./modernMovementInvoicePdfGenerator-CYYTcdQu.js");return{generateModernMovementInvoicePDF:u}},[]);i=c;break;case"classic":default:const{generateWorkingInvoicePDF:d}=await no(async()=>{const{generateWorkingInvoicePDF:u}=await import("./workingPdfGenerator-Cc3BjZIo.js");return{generateWorkingInvoicePDF:u}},[]);i=d;break}const o={...n,movementType:"sales",items:n.products||[],invoiceId:n.invoice,id:n.invoice};return await i(o,null,r)}catch(n){const i=n instanceof Error?n.message:"Failed to generate PDF";throw Br("error",i),console.error("Error generating invoice PDF:",n),n}finally{fo(n=>({...n,generatePDF:!1}))}},async updateInvoice(t,e){try{fo(i=>({...i,update:!0})),Br("error",null);const r=uc.invoices.find(i=>i.ssg_sorder_key===t),n={};if(Br("invoices",i=>i.map(o=>o.invoice===t?n:o)),uc.selectedInvoice?.invoice===t&&Br("selectedInvoice",n),Br("lastUpdated",new Date),e.isCompleted&&!r?.isCompleted)try{await tb(n),console.log("Automated journal entries processed for updated invoice:",n.invoice)}catch(i){console.error("Error processing automated journal entries:",i)}return n}catch(r){const n=r instanceof Error?r.message:"Failed to update invoice";throw Br("error",n),console.error("Error updating invoice:",r),r}finally{fo(r=>({...r,update:!1}))}},async deleteInvoice(t){try{fo(i=>({...i,delete:!0})),Br("error",null),Br("invoices",i=>i.filter(o=>o.invoice!==t)),uc.selectedInvoice?.invoice===t&&Br("selectedInvoice",null),Br("lastUpdated",new Date);const n=await Zr({query:"deleteYabaSalesOrders",params:{businessId:"YB100423253156428",id:t}});return!0}catch(e){const r=e instanceof Error?e.message:"Failed to delete invoice";throw Br("error",r),console.error("Error deleting invoice:",e),e}finally{fo(e=>({...e,delete:!1}))}},async fetchInvoiceStats(t){try{Br("error",null);const e=new URLSearchParams;t?.store&&t.store!=="all"&&e.append("store",t.store),t?.dateFrom&&e.append("dateFrom",t.dateFrom),t?.dateTo&&e.append("dateTo",t.dateTo);const r=e.toString();return[]}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice statistics";throw Br("error",r),console.error("Error fetching invoice stats:",e),e}},async fetchStores(){try{return Br("error",null),[]}catch(t){const e=t instanceof Error?t.message:"Failed to fetch stores";throw Br("error",e),console.error("Error fetching stores:",t),t}},setSelectedInvoice(t){Br("selectedInvoice",t)},clearError(){Br("error",null)},getFilteredInvoices(t){let e=uc.invoices;if(t.store&&t.store!=="all"&&(e=e.filter(r=>r.store===t.store)),t.dateFrom){const r=new Date(t.dateFrom).getTime();e=e.filter(n=>n.createDate>=r)}if(t.dateTo){const r=new Date(t.dateTo).setHours(23,59,59,999);e=e.filter(n=>n.createDate<=r)}if(t.status&&t.status!=="all"){const r=t.status==="completed";e=e.filter(n=>n.isCompleted===r)}return e},calculateSummary(t){let e=t.length,r=t.filter(g=>g.isCompleted).length,n=0,i=0,o=0,s=0,l=0,c=0,d=new Set,u=new Set;t?.forEach(g=>{d.add(g?.shipper_consignee?.cid),u.add(g.store),g?.products?.length>0&&g?.products?.forEach(m=>{const S=Math.abs(m?.qty);n+=S,o+=S*(parseFloat(m?.salePrice)||1)}),g?.reservas?.length>0&&g?.reservas?.forEach(m=>{let S=parseInt(m?.qty);isNaN(S)&&(S=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[m.type]||m?.onlyTariff?(S=parseFloat(m.arancel)||parseFloat(m.qty)*parseFloat(m.price),c+=S):(m?.arancel&&(l+=parseFloat(m?.arancel)),i+=S,s+=S*parseFloat(m?.price))})});const h=o+s+c;return{totalInvoices:e,completedInvoices:r,pendingInvoices:e-r,totalProducts:n,totalReservas:i,totalProductAmount:o,totalReservaAmount:s,totalAranceles:l,grandTotal:h,totalOther:c,uniqueCustomers:d.size,uniqueStores:u.size,avgInvoiceValue:e>0?h/e:0}},async refreshData(t){return this.fetchInvoices(t)}};var uy=le("<br>"),mh=le("<div>"),_D=le("<div><h3>"),rb=le("<div><h3></h3><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),SD=le("<div><h3></h3><table><thead><tr><th></th><th></th><th></th><th></th></tr></thead><tbody>"),_d=le("<div><span>:</span><span>"),wD=le("<div><span> ($<!>%):</span><span>"),xD=le("<button>remove"),CD=le("<div class=invoice-display><div><div><div>:<span></span></div><div>: <span></span></div></div><div><div></div><h2></h2><div></div><div></div></div></div><div><h3></h3><div><div><div></div><div></div></div></div><div></div><h3></h3><div><div><div></div><div> <!> <!> </div><div></div><div></div></div><div><div></div><div></div><div></div><div></div><div> #<br> <!> <!> <br>, <br>, </div></div></div></div><div><div><div></div><div><span>:</span><span></span></div></div></div><div></div><div><button>🖨️ </button><button>🧪 Test PDF</button><button>📥 </button></div><style>"),nb=le("<tr><td></td><td></td><td></td><td></td><td>"),AD=le("<tr><td></td><td></td><td></td><td>");const Zo=t=>parseFloat(t?.toString()||"0")||0,$D=t=>{const{t:e}=Wc(),[r,n]=Se(""),[i,o]=Se(!1),s=z=>new Date(z).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),l=z=>{const T=typeof z=="string"?parseFloat(z):z;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T)},c=Nt(()=>{let z=0,T=0,R=0,J=0,X=0;t.invoice?.products?.forEach(_=>{const k=Math.abs(_?.qty),$=parseFloat(_?.salePrice?.toString())||1;z+=k*$}),t.invoice?.reservas?.forEach(_=>{let k=parseFloat(_?.qty?.toString());isNaN(k)&&(k=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[_.type]||_?.onlyTariff?(k=parseFloat(_.arancel?.toString())||parseFloat(_.qty?.toString())*parseFloat(_.price?.toString()),J+=k):(_?.arancel&&(X+=parseFloat(_?.arancel?.toString())),T+=k*parseFloat(_?.price?.toString()))}),t.invoice?.services?.forEach(_=>{R+=Zo(_.qty)*Zo(_.price||_.arancel)});var H=z+T+R+X+J,se=0,O=H+se;return t.invoice?.paymentMethods&&(se=t.invoice?.taxAmount,O=t.invoice?.total,H=t.invoice?.subtotalBeforeTax),{productSubtotal:z,reservaSubtotal:T,serviceSubtotal:R,tariffSubtotal:X,subtotal:H,tax:se,total:O}}),d={"max-width":"800px",margin:"0 auto",padding:"2rem",background:"white","box-shadow":"0 0 20px rgba(0,0,0,0.1)","border-radius":"var(--border-radius)"},u={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"2rem","padding-bottom":"2rem","border-bottom":"2px solid #e0e0e0"},h={"text-align":"right",flex:"1"},g={display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600","text-transform":"uppercase",background:t.invoice.isCompleted?"#d4edda":"#fff3cd",color:t.invoice.isCompleted?"#155724":"#856404","margin-bottom":"0.5rem"},m={"margin-bottom":"2rem"},S={"font-size":"1.1rem","font-weight":"600","margin-bottom":"1rem",color:"#333"},N={display:"grid","grid-template-columns":"1fr 1fr",gap:"1.5rem"},x={background:"#f8f9fa",padding:"1rem","border-radius":"var(--border-radius-sm)",border:"1px solid #e9ecef"},b={"font-size":"0.875rem",color:"#666","margin-bottom":"0.25rem"},K={"font-size":"1rem",color:"#333","font-weight":"500"},te={width:"100%","border-collapse":"collapse","margin-top":"1rem"},F={"text-align":"left",padding:"0.75rem","border-bottom":"2px solid #dee2e6","font-weight":"600",color:"#495057","font-size":"0.875rem","text-transform":"uppercase"},V={padding:"0.75rem","border-bottom":"1px solid #dee2e6",color:"#212529"},W={"font-weight":"600","font-size":"1.1rem"},I={display:"flex",gap:"1rem","justify-content":"center","margin-top":"2rem","padding-top":"2rem","border-top":"2px solid #e0e0e0"},E={padding:"0.75rem 1.5rem","border-radius":"var(--border-radius-sm)",border:"none","font-weight":"500",cursor:"pointer",transition:"all 0.2s",display:"flex","align-items":"center",gap:"0.5rem"},L={...E,background:"var(--primary-color)",color:"white"},M={...E,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},P=Nt(()=>gt.getLocationById(t.invoice.store)),w=async()=>{console.log("Starting PDF export...");try{if(!t.invoice){console.error("No invoice data available"),alert("No invoice data available");return}let z=pp(t.invoice);console.log("Using minimal ink PDF generator...");try{await iD(z,e),console.log("Minimal ink PDF generation completed successfully")}catch(T){console.error("PDF generation failed:",T),console.log("Trying printable PDF fallback..."),cy(z,e),console.log("Printable PDF fallback completed")}}catch(z){console.error("Error in handleExportPDF:",z),console.error("Error stack:",z.stack),alert(`Error generating PDF: ${z.message}`)}},v=async()=>{console.log("Starting PDF export...");try{if(!t.invoice){console.error("No invoice data available"),alert("No invoice data available");return}const z={...t.invoice,storeName:P()?.name||t.invoice.store,storeType:P()?.type,productSubtotal:c().productSubtotal,reservaSubtotal:c().reservaSubtotal,total:c().total};let T=pp(t.invoice);console.log("Using minimal ink PDF generator...");try{cy(T,e),console.log("Minimal ink PDF generation completed successfully")}catch(R){console.error("PDF generation failed:",R),console.log("Trying printable PDF fallback..."),cy(T,e),console.log("Printable PDF fallback completed")}}catch(z){console.error("Error in handleExportPDF:",z),console.error("Error stack:",z.stack),alert(`Error generating PDF: ${z.message}`)}},j=z=>{qi.deleteInvoice(t.invoice.ssg_sorder_key),t.goBack()};return(()=>{var z=CD(),T=z.firstChild,R=T.firstChild,J=R.firstChild,X=J.firstChild,H=X.nextSibling,se=J.nextSibling,O=se.firstChild,_=O.nextSibling,k=R.nextSibling,$=k.firstChild,G=$.nextSibling,ne=G.nextSibling,U=ne.nextSibling,D=T.nextSibling,B=D.firstChild,Q=B.nextSibling,Z=Q.firstChild,oe=Z.firstChild,de=oe.nextSibling,re=Q.nextSibling,Y=re.nextSibling,ce=Y.nextSibling,ue=ce.firstChild,ae=ue.firstChild,ye=ae.nextSibling,me=ye.firstChild,pe=me.nextSibling,ve=pe.nextSibling,Ne=ve.nextSibling;Ne.nextSibling;var Ie=ye.nextSibling,Ce=Ie.nextSibling,Ee=ue.nextSibling,we=Ee.firstChild,Re=we.nextSibling,He=Re.nextSibling,je=He.nextSibling,Ve=je.nextSibling,qe=Ve.firstChild,tt=qe.nextSibling,rt=tt.nextSibling,Be=rt.nextSibling,Ge=Be.nextSibling,Fe=Ge.nextSibling,at=Fe.nextSibling,lt=at.nextSibling,Xe=lt.nextSibling,Ct=Xe.nextSibling,Le=Ct.nextSibling,nt=D.nextSibling,We=nt.firstChild,kt=We.firstChild,Et=kt.nextSibling,Ot=Et.firstChild,jt=Ot.firstChild,mt=Ot.nextSibling,Zt=nt.nextSibling,rr=Zt.nextSibling,Dt=rr.firstChild;Dt.firstChild;var Kt=Dt.nextSibling,dt=Kt.nextSibling;dt.firstChild;var pt=rr.nextSibling;return p(z,d),p(T,u),J.style.setProperty("color","#666"),J.style.setProperty("margin-top","0.25rem"),a(J,()=>e(`inventory.${P()?.type}Type`),X),H.style.setProperty("font-size","1.1rem"),H.style.setProperty("font-weight","600"),H.style.setProperty("color","#444"),a(H,()=>P()?.name),se.style.setProperty("font-size",".91rem"),se.style.setProperty("font-weight","400"),se.style.setProperty("color","#666"),a(se,()=>e("invoices.id"),O),_.style.setProperty("font-size","1.1rem"),_.style.setProperty("font-weight","600"),_.style.setProperty("color","#444"),a(_,()=>t.invoice.ssg_sorder_key),p(k,h),a($,(()=>{var ze=ke(()=>!!t.invoice.isCompleted);return()=>ze()?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase()})()),G.style.setProperty("margin","0 0 0.5rem 0"),G.style.setProperty("font-size","1.5rem"),a(G,()=>e("invoices.invoice").toUpperCase()),ne.style.setProperty("font-size","1.1rem"),ne.style.setProperty("font-weight","600"),ne.style.setProperty("color","#333"),a(ne,()=>t.invoice.invoice),U.style.setProperty("color","#666"),U.style.setProperty("margin-top","0.5rem"),a(U,()=>s(t.invoice.createDate)),a(B,()=>e("invoices.senderInformation")),a(oe,()=>e("invoices.customerName")),a(de,()=>t.invoice.shipper_consignee.name),a(Z,A(Me,{get when(){return t.invoice.shipper_consignee.phoneNumberS},get children(){return[uy(),ke(()=>e("invoices.phoneNumber")),": ",ke(()=>t.invoice.shipper_consignee.phoneNumberS)]}}),null),a(Z,A(Me,{get when(){return t.invoice.shipper_consignee.dob},get children(){return[uy(),ke(()=>e("invoices.dob")),": ",ke(()=>t.invoice.shipper_consignee.dob)]}}),null),a(Z,A(Me,{get when(){return t.invoice.shipper_consignee.phoneNumberS},get children(){return[uy(),ke(()=>e("invoices.id")),": ",ke(()=>t.invoice.shipper_consignee.idS)]}}),null),re.style.setProperty("margin","20px"),a(Y,()=>e("invoices.receiptInformation")),a(ae,()=>e("invoices.customerName")),a(ye,()=>t.invoice.shipper_consignee.firstName,me),a(ye,()=>t.invoice.shipper_consignee.middleName,pe),a(ye,()=>t.invoice.shipper_consignee.lastName,Ne),a(ye,()=>t.invoice.shipper_consignee.lastName2,null),a(Ie,()=>e("invoices.id")),a(Ce,()=>t.invoice.shipper_consignee.cid),a(ue,A(Me,{get when(){return t.invoice.shipper_consignee.passport},get children(){return[(()=>{var ze=mh();return a(ze,()=>e("invoices.passport")),ge(bt=>p(ze,{...b,"margin-top":"0.75rem"},bt)),ze})(),(()=>{var ze=mh();return a(ze,()=>t.invoice.shipper_consignee.passport),ge(bt=>p(ze,K,bt)),ze})()]}}),null),a(we,()=>e("invoices.contactInformation")),a(Re,()=>e("invoices.phoneNumber")),a(He,()=>t.invoice.shipper_consignee.phoneNumber),a(Ee,A(Me,{get when(){return t.invoice.shipper_consignee.altPhoneNumber},get children(){return[(()=>{var ze=mh();return a(ze,()=>e("invoices.altPhone")),ge(bt=>p(ze,{...b,"margin-top":"0.75rem"},bt)),ze})(),(()=>{var ze=mh();return a(ze,()=>t.invoice.shipper_consignee.altPhoneNumber),ge(bt=>p(ze,K,bt)),ze})()]}}),je),a(je,()=>e("invoices.address")),a(Ve,()=>t.invoice.shipper_consignee.ybstreet,qe),a(Ve,()=>t.invoice.shipper_consignee.ybstreetNo,tt),a(Ve,()=>e("invoices.between"),rt),a(Ve,()=>t.invoice.shipper_consignee.ybbetwen1,Be),a(Ve,()=>e("invoices.and"),Fe),a(Ve,()=>t.invoice.shipper_consignee.ybbetwen2,lt),a(Ve,()=>t.invoice.shipper_consignee.ybreparto,Xe),a(Ve,()=>t.invoice.shipper_consignee.ybcity,Ct),a(Ve,()=>t.invoice.shipper_consignee.ybestate,Le),a(Ve,()=>t.invoice.shipper_consignee.nacionality,null),a(z,A(Me,{get when(){return t.invoice?.bulks?.length>0},get children(){var ze=_D(),bt=ze.firstChild;return a(bt,()=>e("invoices.bulkInformation")),a(ze,A(vt,{get each(){return t.invoice.bulks},children:Mt=>A(gD,{bulk:Mt,get products(){return t.invoice.products||[]},get reservas(){return t.invoice.reservas||[]},get services(){return t.invoice.services||[]},showDetails:!0,compact:!1,formatCurrency:l,parseFloat2:Zo,t:e,tableStyle:te,tdStyle:V,thStyle:F})}),null),ge(Mt=>{var ft=m,At=S;return Mt.e=p(ze,ft,Mt.e),Mt.t=p(bt,At,Mt.t),Mt},{e:void 0,t:void 0}),ze}}),nt),a(z,A(Me,{get when(){return!t.invoice?.bulks},get children(){return[A(Me,{get when(){return t.invoice?.products?.length>0},get children(){var ze=rb(),bt=ze.firstChild,Mt=bt.nextSibling,ft=Mt.firstChild,At=ft.firstChild,Ht=At.firstChild,Yt=Ht.nextSibling,nr=Yt.nextSibling,Dr=nr.nextSibling,vr=Dr.nextSibling,tr=ft.nextSibling;return a(bt,()=>e("invoices.products")),a(Ht,()=>e("invoices.code")),a(Yt,()=>e("invoices.description")),a(nr,()=>e("invoices.qty")),a(Dr,()=>e("invoices.unitPrice")),a(vr,()=>e("invoices.total")),a(tr,A(vt,{get each(){return t.invoice?.products},children:Bt=>(()=>{var ar=nb(),br=ar.firstChild,$r=br.nextSibling,mr=$r.nextSibling,sr=mr.nextSibling,Ir=sr.nextSibling;return a(br,()=>Bt.product.code),a($r,()=>Bt.product.label),a(mr,()=>Math.abs(Bt.qty)),a(sr,()=>l(Bt.salePrice)),a(Ir,()=>l(Math.abs(Bt.qty)*Zo(Bt.salePrice))),ge(dr=>{var rn=V,Zn=V,Gn={...V,"text-align":"center"},Li={...V,"text-align":"right"},Wn={...V,"text-align":"right"};return dr.e=p(br,rn,dr.e),dr.t=p($r,Zn,dr.t),dr.a=p(mr,Gn,dr.a),dr.o=p(sr,Li,dr.o),dr.i=p(Ir,Wn,dr.i),dr},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ar})()})),ge(Bt=>{var ar=m,br=S,$r=te,mr=F,sr=F,Ir={...F,"text-align":"center"},dr={...F,"text-align":"right"},rn={...F,"text-align":"right"};return Bt.e=p(ze,ar,Bt.e),Bt.t=p(bt,br,Bt.t),Bt.a=p(Mt,$r,Bt.a),Bt.o=p(Ht,mr,Bt.o),Bt.i=p(Yt,sr,Bt.i),Bt.n=p(nr,Ir,Bt.n),Bt.s=p(Dr,dr,Bt.s),Bt.h=p(vr,rn,Bt.h),Bt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),ze}}),A(Me,{get when(){return t.invoice?.reservas?.length>0},get children(){var ze=rb(),bt=ze.firstChild,Mt=bt.nextSibling,ft=Mt.firstChild,At=ft.firstChild,Ht=At.firstChild,Yt=Ht.nextSibling,nr=Yt.nextSibling,Dr=nr.nextSibling,vr=Dr.nextSibling,tr=ft.nextSibling;return a(bt,()=>e("invoices.reservations")),a(Ht,()=>e("invoices.type")),a(Yt,()=>e("invoices.qty")),a(nr,()=>e("invoices.unitPrice")),a(Dr,()=>e("invoices.arancel")),a(vr,()=>e("invoices.total")),a(tr,A(vt,{get each(){return t.invoice?.reservas},children:Bt=>(()=>{var ar=nb(),br=ar.firstChild,$r=br.nextSibling,mr=$r.nextSibling,sr=mr.nextSibling,Ir=sr.nextSibling;return a(br,()=>Bt.type),a($r,()=>Bt.qty),a(mr,()=>l(Bt.price)),a(sr,()=>Bt.arancel||"-"),a(Ir,()=>l((Zo(Bt.qty)||0)*(Zo(Bt.price)||0)+(Bt.arancel?Zo(Bt.arancel):0))),ge(dr=>{var rn=V,Zn={...V,"text-align":"center"},Gn={...V,"text-align":"right"},Li={...V,"text-align":"right"},Wn={...V,"text-align":"right"};return dr.e=p(br,rn,dr.e),dr.t=p($r,Zn,dr.t),dr.a=p(mr,Gn,dr.a),dr.o=p(sr,Li,dr.o),dr.i=p(Ir,Wn,dr.i),dr},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ar})()})),ge(Bt=>{var ar=m,br=S,$r=te,mr=F,sr={...F,"text-align":"center"},Ir={...F,"text-align":"right"},dr={...F,"text-align":"right"},rn={...F,"text-align":"right"};return Bt.e=p(ze,ar,Bt.e),Bt.t=p(bt,br,Bt.t),Bt.a=p(Mt,$r,Bt.a),Bt.o=p(Ht,mr,Bt.o),Bt.i=p(Yt,sr,Bt.i),Bt.n=p(nr,Ir,Bt.n),Bt.s=p(Dr,dr,Bt.s),Bt.h=p(vr,rn,Bt.h),Bt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),ze}}),A(Me,{get when(){return t.invoice?.services?.length>0},get children(){var ze=SD(),bt=ze.firstChild,Mt=bt.nextSibling,ft=Mt.firstChild,At=ft.firstChild,Ht=At.firstChild,Yt=Ht.nextSibling,nr=Yt.nextSibling,Dr=nr.nextSibling,vr=ft.nextSibling;return a(bt,()=>e("invoices.services")),a(Ht,()=>e("invoices.type")),a(Yt,()=>e("invoices.qty")),a(nr,()=>e("invoices.arancel")),a(Dr,()=>e("invoices.total")),a(vr,A(vt,{get each(){return t.invoice?.services},children:tr=>(()=>{var Bt=AD(),ar=Bt.firstChild,br=ar.nextSibling,$r=br.nextSibling,mr=$r.nextSibling;return a(ar,()=>tr.type),a(br,()=>Zo(tr.qty).toFixed(2)),a($r,(()=>{var sr=ke(()=>!!(tr.arancel||tr?.price));return()=>sr()?l(tr.arancel||tr?.price):"-"})()),a(mr,()=>l((Zo(tr.qty)||0)*(tr.arancel||tr?.price?Zo(tr.arancel||tr?.price):0))),ge(sr=>{var Ir=V,dr={...V,"text-align":"center"},rn={...V,"text-align":"right"},Zn={...V,"text-align":"right"};return sr.e=p(ar,Ir,sr.e),sr.t=p(br,dr,sr.t),sr.a=p($r,rn,sr.a),sr.o=p(mr,Zn,sr.o),sr},{e:void 0,t:void 0,a:void 0,o:void 0}),Bt})()})),ge(tr=>{var Bt=m,ar=S,br=te,$r=F,mr={...F,"text-align":"center"},sr={...F,"text-align":"right"},Ir={...F,"text-align":"right"};return tr.e=p(ze,Bt,tr.e),tr.t=p(bt,ar,tr.t),tr.a=p(Mt,br,tr.a),tr.o=p(Ht,$r,tr.o),tr.i=p(Yt,mr,tr.i),tr.n=p(nr,sr,tr.n),tr.s=p(Dr,Ir,tr.s),tr},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),ze}})]}}),nt),We.style.setProperty("display","inline-block"),We.style.setProperty("min-width","350px"),a(We,A(Me,{get when(){return t.invoice?.products?.length>0},get children(){var ze=_d(),bt=ze.firstChild,Mt=bt.firstChild,ft=bt.nextSibling;return ze.style.setProperty("display","flex"),ze.style.setProperty("justify-content","space-between"),ze.style.setProperty("margin-bottom","0.5rem"),a(bt,()=>e("invoices.productsSubtotal"),Mt),a(ft,()=>l(t?.parseData?.productSubtotal)),ze}}),kt),a(We,A(Me,{get when(){return t.invoice?.reservas?.length>0},get children(){var ze=_d(),bt=ze.firstChild,Mt=bt.firstChild,ft=bt.nextSibling;return ze.style.setProperty("display","flex"),ze.style.setProperty("justify-content","space-between"),ze.style.setProperty("margin-bottom","0.5rem"),a(bt,()=>e("invoices.reservationsSubtotal"),Mt),a(ft,()=>l(t?.parseData?.reservaSubtotal)),ze}}),kt),a(We,A(Me,{get when(){return t.invoice?.services?.length>0},get children(){var ze=_d(),bt=ze.firstChild,Mt=bt.firstChild,ft=bt.nextSibling;return ze.style.setProperty("display","flex"),ze.style.setProperty("justify-content","space-between"),ze.style.setProperty("margin-bottom","0.5rem"),a(bt,()=>e("invoices.servicesSubtotal"),Mt),a(ft,()=>l(t?.parseData?.serviceSubtotal)),ze}}),kt),a(We,A(Me,{get when(){return t.parseData?.transportTotal},get children(){var ze=_d(),bt=ze.firstChild,Mt=bt.firstChild,ft=bt.nextSibling;return ze.style.setProperty("display","flex"),ze.style.setProperty("justify-content","space-between"),ze.style.setProperty("margin-bottom","0.5rem"),a(bt,()=>e("invoices.transportTotal"),Mt),a(ft,()=>l(t.parseData.transportTotal)),ze}}),kt),a(We,A(Me,{get when(){return t?.parseData?.subtotalBeforeTax},get children(){var ze=_d(),bt=ze.firstChild,Mt=bt.firstChild,ft=bt.nextSibling;return ze.style.setProperty("display","flex"),ze.style.setProperty("justify-content","space-between"),ze.style.setProperty("margin-bottom","0.5rem"),a(bt,()=>e("common.subtotal"),Mt),a(ft,()=>l(t?.parseData?.subtotalBeforeTax)),ze}}),Et),a(We,A(Me,{get when(){return t?.parseData?.taxAmount},get children(){var ze=wD(),bt=ze.firstChild,Mt=bt.firstChild,ft=Mt.nextSibling;ft.nextSibling;var At=bt.nextSibling;return ze.style.setProperty("display","flex"),ze.style.setProperty("justify-content","space-between"),ze.style.setProperty("margin-bottom","0.5rem"),a(bt,()=>e("invoiceReport.tax"),Mt),a(bt,()=>t?.parseData.paymentMethods?.taxPercent||7,ft),a(At,()=>l(t?.parseData?.taxAmount)),ze}}),Et),a(Ot,()=>e("invoices.total"),jt),mt.style.setProperty("color","var(--primary-color)"),a(mt,()=>l(c().total)),Dt.addEventListener("mouseleave",ze=>ze.currentTarget.style.opacity="1"),Dt.addEventListener("mouseenter",ze=>ze.currentTarget.style.opacity="0.9"),Dt.$$click=v,a(Dt,()=>e("invoices.printInvoice"),null),Cn(Kt,"click",eD,!0),dt.addEventListener("mouseleave",ze=>{ze.currentTarget.style.background="white",ze.currentTarget.style.color="var(--primary-color)"}),dt.addEventListener("mouseenter",ze=>{ze.currentTarget.style.background="var(--primary-color)",ze.currentTarget.style.color="white"}),dt.$$click=w,a(dt,()=>e("invoices.exportPdf"),null),a(rr,A(Me,{get when(){return Gt.state?.profile?.isAdmin},get children(){var ze=xD();return ze.$$click=j,ze.addEventListener("mouseleave",bt=>bt.currentTarget.style.opacity="1"),ze.addEventListener("mouseenter",bt=>bt.currentTarget.style.opacity="0.9"),ge(bt=>p(ze,L,bt)),ze}}),null),a(pt,`
        @media print {
          .invoice-display {
            box-shadow: none !important;
            padding: 0 !important;
          }
          
          ${I} {
            display: none !important;
          }
        }
      `),ge(ze=>{var bt=g,Mt=m,ft=S,At=N,Ht=x,Yt=b,nr=K,Dr=S,vr=N,tr=x,Bt=b,ar=K,br={...b,"margin-top":"0.75rem"},$r=K,mr=x,sr=b,Ir={...b,"margin-top":"0.75rem"},dr=K,rn={...b,"margin-top":"0.75rem"},Zn=K,Gn={...m,"text-align":"right"},Li={...W,display:"flex","justify-content":"space-between","padding-top":"0.75rem","border-top":"2px solid #dee2e6"},Wn={...W,display:"flex","justify-content":"space-between","padding-top":"0.75rem","border-top":"2px solid #dee2e6"},so={...m,"text-align":"center",color:"#666","font-size":"0.875rem"},Ur=I,Ri=L,Po={...L,background:"#28a745"},_o=M;return ze.e=p($,bt,ze.e),ze.t=p(D,Mt,ze.t),ze.a=p(B,ft,ze.a),ze.o=p(Q,At,ze.o),ze.i=p(Z,Ht,ze.i),ze.n=p(oe,Yt,ze.n),ze.s=p(de,nr,ze.s),ze.h=p(Y,Dr,ze.h),ze.r=p(ce,vr,ze.r),ze.d=p(ue,tr,ze.d),ze.l=p(ae,Bt,ze.l),ze.u=p(ye,ar,ze.u),ze.c=p(Ie,br,ze.c),ze.w=p(Ce,$r,ze.w),ze.m=p(Ee,mr,ze.m),ze.f=p(we,sr,ze.f),ze.y=p(Re,Ir,ze.y),ze.g=p(He,dr,ze.g),ze.p=p(je,rn,ze.p),ze.b=p(Ve,Zn,ze.b),ze.T=p(nt,Gn,ze.T),ze.A=p(kt,Li,ze.A),ze.O=p(Et,Wn,ze.O),ze.I=p(Zt,so,ze.I),ze.S=p(rr,Ur,ze.S),ze.W=p(Dt,Ri,ze.W),ze.C=p(Kt,Po,ze.C),ze.B=p(dt,_o,ze.B),ze},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),z})()};Wt(["click"]);const Td={invoice:"",description:"",store:"",guide:"",shipper_consignee:{firstName:"",middleName:"",lastName:"",lastName2:"",phoneNumber:"",cid:"",dob:"",passport:"",address:"",altPhoneNumber:"",passportS:"",name:"",addressS:"",phoneNumberS:"",idS:""},products:[],reservas:[],services:[],bulks:[],packagesOrder:!1,shippingMethod:"",paymentMethods:{taxOnTotal:!1,taxPercent:0,exemptTaxOnCash:!1,cash:0,zelle:0,creditCard:0}},Tg="invoice_styled_form_draft",ED=()=>{try{const t=localStorage.getItem(Tg);if(t){const e=JSON.parse(t);return{...Td,...e,shipper_consignee:{...Td.shipper_consignee,...e.shipper_consignee||{}},paymentMethods:{...Td.paymentMethods,...e.paymentMethods||{}},products:e.products||[],reservas:e.reservas||[],services:e.services||[],bulks:e.bulks||[]}}}catch(t){console.warn("Failed to load styled invoice form from storage:",t)}return console.log("No saved data found, using default form data"),{...Td}},kg=t=>{try{localStorage.setItem(Tg,JSON.stringify(t))}catch(e){console.warn("Failed to save styled invoice form to storage:",e)}},ib=()=>{try{localStorage.removeItem(Tg)}catch(t){console.warn("Failed to clear styled invoice form from storage:",t)}},[xa,yi]=Se(ED()),[__,Qn]=Se(!1),[ID,Nh]=Se(null);let hy=null;const Ii=()=>{hy&&clearTimeout(hy),hy=setTimeout(()=>{const t=xa();kg(t),Nh(new Date),console.log("Styled invoice form auto-saved at",new Date().toLocaleTimeString())},1e3)},Er={formData:xa,get isDirty(){return __()},get lastSaved(){return ID()},updateForm:t=>{yi(e=>{const r={...e,...t};return Qn(!0),Ii(),r})},updateShipperConsignee:t=>{yi(e=>{const r={...e,shipper_consignee:{...e.shipper_consignee,...t}};return Qn(!0),Ii(),r})},updatePaymentMethods:t=>{yi(e=>{const r={...e,paymentMethods:{...e.paymentMethods,...t}};return Qn(!0),Ii(),r})},addProduct:t=>{yi(e=>{const r={...e,products:[...e.products,t]};return Qn(!0),Ii(),r})},updateProduct:(t,e)=>{yi(r=>{const n=[...r.products];n[t]={...n[t],...e};const i={...r,products:n};return Qn(!0),Ii(),i})},removeProduct:t=>{yi(e=>{const r=e.products.filter((i,o)=>o!==t),n={...e,products:r};return Qn(!0),Ii(),n})},addReserva:t=>{yi(e=>{const r={...e,reservas:[...e.reservas,t]};return Qn(!0),Ii(),r})},updateReserva:(t,e)=>{yi(r=>{const n=[...r.reservas];n[t]={...n[t],...e};const i={...r,reservas:n};return Qn(!0),Ii(),i})},removeReserva:t=>{yi(e=>{const r=e.reservas.filter((i,o)=>o!==t),n={...e,reservas:r};return Qn(!0),Ii(),n})},addService:t=>{yi(e=>{const r={...e,services:[...e.services,t]};return Qn(!0),Ii(),r})},updateService:(t,e)=>{yi(r=>{const n=[...r.services];n[t]={...n[t],...e};const i={...r,services:n};return Qn(!0),Ii(),i})},removeService:t=>{yi(e=>{const r=e.services.filter((i,o)=>o!==t),n={...e,services:r};return Qn(!0),Ii(),n})},addBulk:t=>{yi(e=>{const r={...e,bulks:[...e.bulks,t]};return Qn(!0),Ii(),r})},updateBulk:(t,e)=>{yi(r=>{const n=[...r.bulks];n[t]={...n[t],...e};const i={...r,bulks:n};return Qn(!0),Ii(),i})},removeBulk:t=>{yi(e=>{const r=e.bulks.filter((i,o)=>o!==t),n={...e,bulks:r};return Qn(!0),Ii(),n})},clearForm:()=>{yi({...Td}),Qn(!1),ib(),Nh(null)},markCompleted:()=>{ib(),Qn(!1),Nh(null)},forceSave:()=>{kg(xa()),Nh(new Date),Qn(!1)},hasData:()=>{const t=xa();return t.invoice!==""||t.description!==""||t.store!==""||t.shipper_consignee.name!==""||t.shipper_consignee.firstName!==""||t.shipper_consignee.cid!==""||t.products.length>0||t.reservas.length>0||t.services.length>0||t.bulks.length>0||t.paymentMethods.cash>0||t.paymentMethods.zelle>0||t.paymentMethods.creditCard>0},invoiceTotals:()=>{const t=xa(),e=t.products.reduce((m,S)=>m+S.qty*S.salePrice,0),r=t.reservas.reduce((m,S)=>m+(S.qty*S.price+S.arancel),0),n=t.services.reduce((m,S)=>m+S.qty*S.arancel,0),i=t.bulks.reduce((m,S)=>m+(S?.transportCost||20),0),o=Math.round(e)+Math.round(r)+Math.round(n)+Math.round(i),s=t.paymentMethods.cash+t.paymentMethods.zelle+t.paymentMethods.creditCard;let l=s;t.paymentMethods.exemptTaxOnCash&&(l=o-t.paymentMethods.cash);const c=t.paymentMethods.taxOnTotal?o*t.paymentMethods.taxPercent/100:l*t.paymentMethods.taxPercent/100,d=o+c,u=d-s,h=o*t.paymentMethods.taxPercent/100-c;return{itemsTotal:o,transportTotal:i,grandTotal:o,productsTotal:e,reservasTotal:r,servicesTotal:n,balance:u,totalWithTax:d,taxAmount:c,saveOnExemptTaxOnCash:h}},isValid:()=>{const t=xa(),e=Er.invoiceTotals();return e.balance<.6&&e.grandTotal&&t.invoice.trim()!==""&&t.store.trim()!==""&&t.shippingMethod.trim()!==""&&t.shipper_consignee.phoneNumber.trim()!==""&&t.shipper_consignee.phoneNumberS.trim()!==""&&t.shipper_consignee.firstName.trim()!==""&&t.shipper_consignee.name.trim()!==""&&t.shipper_consignee.lastName.trim()!==""&&t.shipper_consignee.cid.trim()!==""&&(t.products.length>0||t.reservas.length>0||t.services.length>0||t.bulks.length>0)},getFormData:()=>xa()};typeof window<"u"&&window.addEventListener("beforeunload",t=>{if(__()&&(kg(xa()),Er.hasData()))return t.preventDefault(),t.returnValue="You have unsaved changes in your invoice. Are you sure you want to leave?",t.returnValue});const ob=20,TD=["📺 TV","📺 Television","📺 Televisor","📺 Smart TV","🖥️ Monitor","🖥️ Pantalla","📺 Plasma","📺 LED TV","📺 OLED TV","💻 Computadora","💻 Laptop","💻 PC","💻 Desktop","💻 Macbook","💻 Notebook","🖥️ iMac","💻 Chromebook","⚡ Generador","⚡ Generator","🔧 Generador Electrico","🔌 Planta Electrica","⚡ Inversor","🔌 UPS","🔋 Bateria","🔋 Battery","🔋 Bateria de Litio","🔋 Lithium Battery","🔋 Power Bank","🔋 Banco de Energia","🔋 Bateria Externa","🔋 Cargador Solar","🔋 Solar Charger","🚗 Bateria de Carro","🎤 Amplificador","🎵 Bocinas Grandes","🎵 Sound System","📷 Camara Profesional","🎥 Video Camera","📹 Videocamara","🖨️ Impresora Grande","🖨️ Printer","📠 Fax Machine","❄️ Mini Nevera","🌀 Ventilador de Torre","☕ Cafetera Electrica","🍞 Tostadora","🥤 Licuadora","🍯 Procesador de Alimentos"],Ti={MISCELANEAS:{over50items:2.99,under50items:3.99},DURADEROS:{price:4.5,arancel:{ranges:[{min:0,max:5,cost:5},{min:5,max:20,cost:10},{min:20,max:50,cost:20},{min:50,max:100,cost:35},{min:100,max:1/0,cost:50}]}},LITHIUM_BATTERIES:{price:8.99},EXCLUSIVE:{price:6.99},DOCUMENTS:{price:1.99}},su=t=>{const e=t.toUpperCase();return e.includes("BATERIA")||e.includes("BATTERY")||e.includes("POWER BANK")||e.includes("LITIO")||e.includes("LITHIUM")?"LITHIUM_BATTERIES":TD.some(r=>{const n=r.replace(/^[\u{1F000}-\u{1F9FF}\u{2600}-\u{27BF}]\s*/u,"").toUpperCase();return e.includes(n)||t.toLowerCase().includes(n.toLowerCase())})?"EXCLUSIVE":e.includes("TV")||e.includes("DURADEROS")||e.includes("TELEFONO")||e.includes("PHONE")||e.includes("ELECTRODOMESTICO")||e.includes("ELECTRONIC")||e.includes("CAMARA")||e.includes("CAMERA")||e.includes("AUDIO")||e.includes("HERRAMIENTA")||e.includes("TOOL")||e.includes("EQUIPO")?"DURADEROS":e.includes("DOCUMENTO")||e.includes("DOCUMENT")||e.includes("PAPEL")||e.includes("CERTIFICADO")?"DOCUMENTS":"MISCELANEAS"},ff=(t,e,r,n)=>{const i=su(t);if(!e)switch(i){case"MISCELANEAS":return Ti.MISCELANEAS.under50items;case"DURADEROS":return Ti.DURADEROS.price;case"LITHIUM_BATTERIES":return Ti.LITHIUM_BATTERIES.price;case"EXCLUSIVE":return Ti.EXCLUSIVE.price;case"DOCUMENTS":return Ti.DOCUMENTS.price;default:return Ti.MISCELANEAS.under50items}const o=r.filter(s=>s.bulkId===e&&s.category==="MISCELANEAS").reduce((s,l)=>s+(l.qty||0),0);switch(i){case"MISCELANEAS":return o>=46?Ti.MISCELANEAS.over50items:Ti.MISCELANEAS.under50items;case"DURADEROS":return Ti.DURADEROS.price;case"LITHIUM_BATTERIES":return Ti.LITHIUM_BATTERIES.price;case"EXCLUSIVE":return Ti.EXCLUSIVE.price;case"DOCUMENTS":return Ti.DOCUMENTS.price;default:return Ti.MISCELANEAS.under50items}},gf=(t,e)=>{if(t==="DURADEROS"&&Ti.DURADEROS.arancel){const r=Ti.DURADEROS.arancel.ranges;for(const n of r)if(e>=n.min&&e<n.max)return n.cost}return 0},kD=(t,e,r,n,i)=>t!=="EXCLUSIVE"?{isValid:!0}:[...r.filter(s=>s.bulkId===e),...n.filter(s=>s.bulkId===e),...i.filter(s=>s.bulkId===e)]?.length>0?{isValid:!1,error:`⚠️ ${t} requiere un bulto exclusivo. Este item debe ir solo en su propio bulto.`}:{isValid:!0},py=(t,e,r,n)=>{const i=[...e.filter(s=>s.bulkId===t),...r.filter(s=>s.bulkId===t),...n.filter(s=>s.bulkId===t)];if(i?.some(s=>{const l=s.type||s.product?.label||"";return su(l)==="EXCLUSIVE"})){const s=i?.find(c=>{const d=c.type||c.product?.label||"";return su(d)==="EXCLUSIVE"});return{isValid:!1,error:`⚠️ Este bulto contiene ${s?.type||s?.product?.label||"equipo exclusivo"} que requiere ir solo. No se pueden agregar más items.`}}return{isValid:!0}};var sb=le("<div>"),ND=le("<div><input type=text autocomplete=off>"),LD=le("<div>No se encontraron tipos de reserva");const ab=["👕 Ropa y Zapatos","👕 Ropa","👞 Zapatos","👒 Sombreros y Gorras","🧥 Abrigos y Chaquetas","👖 Pantalones y Jeans","👗 Vestidos","🩱 Ropa de Baño","🧦 Calcetines y Medias","🩲 Ropa Interior","👶 Ropa de Bebe","📺 TV","📱 Telefono Movil","💻 Computadora/Laptop","⌨️ Teclados","🖱️ Mouse","🎧 Audifonos","🔌 Cables y Accesorios","🔋 Baterias","📷 Camaras","🎥 Videocamaras","📻 Radios","💾 USB y Memorias","🖨️ Impresoras","📽️ Proyectores","🕹️ Controles de Videojuegos","🎮 Consolas de Videojuegos","📡 Antenas","💡 Bombillas LED","🔦 Linternas","🏠 Utiles del Hogar","🛏️ Articulos para el Hogar","🪑 Muebles","🛋️ Sofas y Sillones","🚪 Puertas y Ventanas","🔑 Cerraduras y Llaves","🧽 Articulos de Limpieza","🧼 Productos de Limpieza","🧴 Detergentes","🕯️ Velas","🖼️ Cuadros y Decoraciones","🪴 Plantas y Macetas","🔨 Herramientas de Casa","⚡ Articulos Electricos","🌀 Ventiladores","❄️ Aires Acondicionados","🔥 Calentadores","💊 Medicamentos","🧴 Productos de Belleza","💄 Maquillaje","🧴 Shampoo y Acondicionador","🧼 Jabones","🪥 Cepillos de Dientes","🧻 Papel Higienico","🧴 Aseo Personal","💉 Equipos Medicos","🏥 Suministros Medicos","🩹 Vendas y Curitas","🌡️ Termometros","👓 Lentes Recetados","🕶️ Lentes de Sol","⚽ Equipos Deportivos","🏀 Balones","🎾 Raquetas","🏋️ Pesas","🎣 Equipos de Pesca","🎸 Instrumentos Musicales","🎲 Juegos y Juguetes","🧸 Peluches","🎯 Juegos de Mesa","🪀 Juguetes Clasicos","🍽️ Articulos de Cocina","🔪 Cuchillos","🥄 Cubiertos","🍳 Sartenes y Ollas","☕ Cafeteras","🧊 Neveras Pequeñas","🌶️ Condimentos","🍫 Dulces y Chocolates","🧂 Especias","🥫 Alimentos Enlatados","📚 Libros","📰 Revistas","📄 Documentos","📜 Certificados","💿 CDs y DVDs","📸 Fotos","🗞️ Periodicos","🔧 Herramientas","🔩 Tornillos y Clavos","🪚 Sierras","🔨 Martillos","⚒️ Herramientas de Construccion","🧰 Cajas de Herramientas","🪜 Escaleras","🔗 Cadenas y Candados","🚗 Repuestos de Carros","⚙️ Partes de Motor","🛞 Gomas y Rines","🔋 Baterias de Carro","🛢️ Aceites","🚨 Alarmas de Carro","🎵 Radios de Carro"],RD=t=>{const[e,r]=Se(!1),[n,i]=Se(""),[o,s]=Se(-1),l=()=>{const[te,F]=Se(""),V=n().toLowerCase();if(!V)return ab.slice(0,20);const W=ab.filter(I=>I.toLowerCase().includes(V));return W.length===0&&V.length>0?[`✏️ Agregar "${n()}"`]:W.slice(0,15)},c=()=>{r(!0),i(""),s(-1)},d=te=>{const V=te.target.value;i(V),r(V.length>=0),s(-1)},u=te=>{let F;te.startsWith("✏️ Agregar")?F=n():F=te.replace(/^[\u{1F000}-\u{1F9FF}\u{2600}-\u{27BF}]\s*/u,""),t.onChange(F),r(!1),i(""),s(-1)},h=te=>{const F=l();switch(te.key){case"ArrowDown":te.preventDefault(),s(V=>Math.min(V+1,F.length-1));break;case"ArrowUp":te.preventDefault(),s(V=>Math.max(V-1,-1));break;case"Enter":te.preventDefault(),o()>=0&&F[o()]&&u(F[o()]);break;case"Escape":r(!1),i(""),s(-1);break}},g=te=>{setTimeout(()=>{r(!1),i(""),s(-1)},150)},m=()=>e()&&n()?n():t.value||"",S={position:"relative",width:"100%",...t.style},N={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem","margin-bottom":"0.5rem",background:"var(--surface-color)"},x={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"200px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},b=te=>({padding:"0.5rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:te?"var(--primary-color)":"transparent",color:te?"white":"var(--text-primary)",transition:"all 0.2s ease","font-size":"0.875rem"}),K={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic","font-size":"0.875rem"};return(()=>{var te=ND(),F=te.firstChild;return F.addEventListener("blur",g),F.$$keydown=h,F.$$click=c,F.$$input=d,p(F,N),a(te,A(Me,{get when(){return e()},get children(){var V=sb();return a(V,A(Me,{get when(){return l().length>0},get fallback(){return(()=>{var W=LD();return p(W,K),W})()},get children(){return A(vt,{get each(){return l()},children:(W,I)=>(()=>{var E=sb();return E.addEventListener("mouseenter",()=>s(I())),E.$$click=()=>u(W),a(E,W),ge(L=>p(E,b(I()===o()),L)),E})()})}})),ge(W=>p(V,x,W)),V}}),null),ge(V=>{var W=S,I=t.placeholder||"Buscar tipo de reserva...";return V.e=p(te,W,V.e),I!==V.t&&Jt(F,"placeholder",V.t=I),V},{e:void 0,t:void 0}),ge(()=>F.value=m()),te})()};Wt(["input","click","keydown"]);var DD=le("<h4>Reservas (<!>)"),MD=le("<span>"),FD=le("<button type=button><span>"),OD=le('<div><div><div><span>Reserva: </span></div><button type=button title="Eliminar reserva">🗑️</button></div><div><div><label>Tipo de Reserva</label></div><div><label>Categoría</label><select><option value=MISCELANEAS>Miscelaneas</option><option value=DURADEROS>Duraderos</option><option value=LITHIUM_BATTERIES>Baterías Litio</option><option value=EXCLUSIVE>Exclusivos</option><option value=DOCUMENTS>Documentos</option></select></div></div><div><div><label>Cantidad</label></div><div><label>Precio ($) </label></div><div><label>Arancel ($) ');const BD=t=>{const e=(c,d)=>{t.onUpdateReserva(c,d),t.onBulkChange()},r=(c,d)=>{confirm(`¿Eliminar reserva "${d.type||"sin tipo"}"?

Esta acción no se puede deshacer.`)&&(t.onRemoveReserva(c),t.onBulkChange())},n={border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-bottom":"0.5rem",background:"white"},i={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"0.5rem"},o={background:"#fff",color:"red",border:"none","border-sradius":"50%",width:"1.8em",height:"1.8em",display:"flex","align-items":"center","justify-content":"center",cursor:"pointer","font-size":"0.75rem"},s={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem","margin-bottom":"0.5rem"},l={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"0.5rem"};return[A(Me,{get when(){return t.reservas.length>0},get children(){var c=DD(),d=c.firstChild,u=d.nextSibling;return u.nextSibling,c.style.setProperty("font-size","1rem"),c.style.setProperty("font-weight","bold"),c.style.setProperty("color","var(--primary-color)"),c.style.setProperty("margin","1.9rem 0 0.75rem 0 "),c.style.setProperty("border-bottom","1px solid var(--border-color)"),c.style.setProperty("padding-bottom","0.5rem"),a(c,A(Yr,{name:"inventory",size:"1em",style:{"margin-right":"0.5rem"}}),d),a(c,()=>t.reservas.length,u),c}}),A(vt,{get each(){return t.reservas},children:(c,d)=>(()=>{var u=OD(),h=u.firstChild,g=h.firstChild,m=g.firstChild,S=m.firstChild,N=g.nextSibling,x=h.nextSibling,b=x.firstChild,K=b.firstChild,te=b.nextSibling,F=te.firstChild,V=F.nextSibling,W=x.nextSibling,I=W.firstChild,E=I.firstChild,L=I.nextSibling,M=L.firstChild,P=L.nextSibling,w=P.firstChild;return p(u,n),p(h,i),g.style.setProperty("display","flex"),g.style.setProperty("align-items","center"),g.style.setProperty("gap","0.5rem"),g.style.setProperty("flex","1"),m.style.setProperty("font-weight","bold"),m.style.setProperty("color","var(--primary-color)"),a(m,A(Yr,{name:"inventory",size:"1em",style:{"margin-right":"0.3rem"}}),S),a(m,()=>c.type||"Sin tipo",null),a(g,A(Me,{get when(){return c.category},get children(){var v=MD();return v.style.setProperty("font-size","0.75rem"),v.style.setProperty("color","var(--text-muted)"),v.style.setProperty("background","var(--strip-color)"),v.style.setProperty("padding","2px 6px"),v.style.setProperty("border-radius","3px"),a(v,()=>c.category),v}}),null),a(g,A(Me,{get when(){return t.autoCalculation},get children(){var v=FD(),j=v.firstChild;return v.$$click=()=>e(d(),{autoCalculate:c.autoCalculate===!1}),v.style.setProperty("border","none"),v.style.setProperty("border-radius","var(--border-radius-sm)"),v.style.setProperty("padding","2px 8px"),v.style.setProperty("font-size","0.7rem"),v.style.setProperty("cursor","pointer"),v.style.setProperty("display","flex"),v.style.setProperty("align-items","center"),v.style.setProperty("gap","0.25rem"),a(j,()=>c.autoCalculate!==!1?"🤖 Auto":"✋ Manual"),ge(()=>Jt(v,"title",c.autoCalculate!==!1?"Auto-cálculo activo para esta reserva. Click para desactivar":"Auto-cálculo inactivo para esta reserva. Click para activar")),v}}),null),N.$$click=()=>r(d(),c),p(N,o),K.style.setProperty("font-size","0.875rem"),K.style.setProperty("font-weight","500"),a(b,A(RD,{get value(){return c.type},onChange:v=>e(d(),{type:v}),onWeightChange:v=>e(d(),{qty:v}),placeholder:"Buscar tipo de reserva...",get showWeight(){return c.category==="MISCELANEAS"},get weight(){return c.qty},style:{"margin-bottom":"0"}}),null),F.style.setProperty("font-size","0.875rem"),F.style.setProperty("font-weight","500"),V.addEventListener("change",v=>{e(d(),{category:v.target.value})}),E.style.setProperty("font-size","0.875rem"),E.style.setProperty("font-weight","500"),a(I,A(Lt,{type:"number",style:s,get value(){return c.qty.toString()},min:"1",onChange:v=>e(d(),{qty:Number(v)||1})}),null),M.style.setProperty("font-size","0.875rem"),M.style.setProperty("font-weight","500"),a(L,A(Lt,{type:"number",get style(){return{...s,background:t.autoCalculation&&c.autoCalculate!==!1?"var(--strip-color)":"var(--surface-color)",cursor:t.autoCalculation&&c.autoCalculate!==!1?"not-allowed":"text"}},get value(){return c.price.toString()},step:"0.01",get readOnly(){return t.autoCalculation&&c.autoCalculate!==!1},onChange:v=>{if(!t.autoCalculation||c.autoCalculate===!1){const j=Number(v)||0;e(d(),{price:j})}},get title(){return t.autoCalculation&&c.autoCalculate!==!1?"Precio calculado automáticamente":"Ingrese precio manualmente"}}),null),w.style.setProperty("font-size","0.875rem"),w.style.setProperty("font-weight","500"),a(P,A(Lt,{type:"number",get style(){return{...s,background:t.autoCalculation&&c.autoCalculate!==!1?"var(--strip-color)":"var(--surface-color)",cursor:t.autoCalculation&&c.autoCalculate!==!1?"not-allowed":"text"}},get value(){return c.arancel.toString()},step:"0.01",get readOnly(){return t.autoCalculation&&c.autoCalculate!==!1},onChange:v=>{if(!t.autoCalculation||c.autoCalculate===!1){const j=Number(v)||0;e(d(),{arancel:j})}},get title(){return t.autoCalculation&&c.autoCalculate!==!1?"Arancel calculado automáticamente":"Ingrese arancel manualmente"}}),null),ge(v=>{var j=l,z=s,T=l;return v.e=p(x,j,v.e),v.t=p(V,z,v.t),v.a=p(W,T,v.a),v},{e:void 0,t:void 0,a:void 0}),ge(()=>V.value=c.category),u})()})]};Wt(["click"]);var VD=le("<div>🔄 "),jD=le("<div>⚠️ <div>"),zD=le("<div><span>🔄</span><span>"),yh=le("<div>"),qD=le("<div><div><div><input type=text autocomplete=off>"),UD=le("<button type=button>+"),HD=le("<div><div></div><div>"),GD=le("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div></div><div>: "),WD=le("<span>"),YD=le("<span>⚠️ ");const KD=t=>{const{t:e}=or(),[r,n]=Se(!1),[i,o]=Se(""),[s,l]=Se(-1),[c,d]=Se(!1),[u,h]=Se(null),[g,m]=Se([]),[S,N]=Se(null),x=t.searchDelay||300,b=t.maxResults||40,K=Nt(()=>{if(!t.value)return null;const D=g().find(B=>B.id===t.value);return D||gt.getProductById(t.value)}),te=async D=>{if(!D.trim()){m([]);return}d(!0),h(null);const B=gt.getActiveProducts().filter(Q=>Q.name.toLowerCase().includes(D.toLowerCase())||Q.sku.toLowerCase().includes(D.toLowerCase())||Q?.UPC?.toLowerCase().includes(D?.toLowerCase())||Q.category.toLowerCase().includes(D.toLowerCase())).slice(0,b);m(B),d(!1)},F=Nt(()=>i().toLowerCase()?g():gt.getActiveProducts().slice(0,10)),V=()=>{n(!0),o(""),l(-1),h(null),i()||m(gt.getActiveProducts().slice(0,10))},W=D=>{const Q=D.target.value;o(Q),n(!0),l(-1),h(null),S()&&clearTimeout(S());const Z=setTimeout(()=>{te(Q)},x);N(Z)},I=D=>{t.onChange(D.id),n(!1),o(""),l(-1),h(null),S()&&(clearTimeout(S()),N(null))},E=D=>{const B=F();switch(D.key){case"ArrowDown":D.preventDefault(),l(Q=>Math.min(Q+1,B.length-1));break;case"ArrowUp":D.preventDefault(),l(Q=>Math.max(Q-1,-1));break;case"Enter":D.preventDefault(),s()>=0&&B[s()]&&I(B[s()]);break;case"Escape":n(!1),o(""),l(-1),h(null),S()&&(clearTimeout(S()),N(null));break}},L=D=>{setTimeout(()=>{n(!1),o(""),l(-1),S()&&(clearTimeout(S()),N(null))},150)},M=D=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(D),P=D=>gt.stockLevels.filter(B=>B.productId===D).reduce((B,Q)=>B+Q.quantity,0);Ln(()=>()=>{S()&&clearTimeout(S())});const w={position:"relative",width:"100%",...t.style},v={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},j={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"400px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},z=D=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:D?"var(--strip-color)":"transparent",color:D?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),T={display:"flex","justify-content":"space-between","align-items":"center"},R={flex:"1"},J={"font-weight":"500","margin-bottom":"0.25rem"},X={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","flex-wrap":"wrap"},H={"text-align":"right","font-size":"0.875rem"},se={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},O={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"},_={padding:"1rem","text-align":"center",color:"#d32f2f",background:"#ffebee","border-radius":"var(--border-radius-sm)",margin:"0.5rem","font-size":"0.875rem"},k=()=>r()&&i()?i():K()?`${K().name} (${K().sku})`:"",$={display:"flex","align-items":"stretch",width:"100%"},G={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},ne={...v,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},U={position:"absolute",right:t.onAddNew?"50px":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)","pointer-events":"none"};return(()=>{var D=qD(),B=D.firstChild,Q=B.firstChild,Z=Q.firstChild;return p(B,$),Q.style.setProperty("position","relative"),Q.style.setProperty("flex","1"),Z.addEventListener("blur",L),Z.$$keydown=E,Z.$$click=V,Z.$$input=W,a(Q,A(Me,{get when(){return c()},get children(){var oe=VD();return oe.firstChild,a(oe,()=>e("common.searching","Searching..."),null),ge(de=>p(oe,U,de)),oe}}),null),a(B,(()=>{var oe=ke(()=>!!t.onAddNew);return()=>oe()&&(()=>{var de=UD();return de.addEventListener("mouseleave",re=>{re.currentTarget.style.background="var(--surface-color)",re.currentTarget.style.color="var(--primary-color)"}),de.addEventListener("mouseenter",re=>{re.currentTarget.style.background="var(--primary-color)",re.currentTarget.style.color="white"}),Cn(de,"click",t.onAddNew,!0),p(de,G),ge(()=>Jt(de,"title",e("inventory.addProduct","Add new product"))),de})()})(),null),a(D,A(Me,{get when(){return r()},get children(){var oe=yh();return a(oe,A(Me,{get when(){return u()},get children(){var de=jD(),re=de.firstChild,Y=re.nextSibling;return p(de,_),a(de,u,Y),Y.style.setProperty("margin-top","0.5rem"),Y.style.setProperty("font-size","0.75rem"),a(Y,()=>e("inventory.searchFallback","Showing local results")),de}}),null),a(oe,A(Me,{get when(){return c()},get children(){var de=zD(),re=de.firstChild,Y=re.nextSibling;return p(de,O),a(Y,()=>e("common.searching","Searching products...")),de}}),null),a(oe,A(Me,{get when(){return ke(()=>!c())()&&F().length>0},get fallback(){return ke(()=>!c())()&&(()=>{var de=yh();return p(de,se),a(de,(()=>{var re=ke(()=>!!i());return()=>re()?(()=>{var Y=HD(),ce=Y.firstChild,ue=ce.nextSibling;return a(ce,()=>e("inventory.noProductsFound","No products found matching your search.")),ue.style.setProperty("margin-top","0.5rem"),ue.style.setProperty("font-size","0.75rem"),a(ue,()=>e("inventory.tryDifferentTerm","Try a different search term or check spelling.")),Y})():e("inventory.noProductsAvailable","No products available.")})()),de})()},get children(){return[A(vt,{get each(){return F()},children:(de,re)=>{const Y=P(de.id),ce=Y<=de.minStockLevel;return(()=>{var ue=GD(),ae=ue.firstChild,ye=ae.firstChild,me=ye.firstChild,pe=me.nextSibling,ve=pe.firstChild,Ne=ve.firstChild,Ie=ve.nextSibling,Ce=Ie.nextSibling,Ee=Ce.nextSibling,we=Ee.nextSibling,Re=ye.nextSibling,He=Re.firstChild,je=He.firstChild,Ve=He.nextSibling,qe=Ve.nextSibling,tt=qe.firstChild;return ue.addEventListener("mouseenter",()=>l(re())),ue.$$click=()=>I(de),p(ae,T),p(ye,R),p(me,J),a(me,()=>de.name,null),a(me,(()=>{var rt=ke(()=>!!i());return()=>rt()&&(()=>{var Be=WD();return Be.style.setProperty("margin-left","0.5rem"),Be.style.setProperty("font-size","0.75rem"),Be.style.setProperty("color","var(--primary-color)"),Be.style.setProperty("font-weight","normal"),a(Be,()=>g().includes(de)?"🌐 API":"💾 Local"),Be})()})(),null),p(pe,X),a(ve,()=>e("inventory.sku","SKU"),Ne),a(ve,()=>de.sku,null),a(Ce,()=>de.category),a(we,()=>M(de.unitCost)),a(ye,(()=>{var rt=ke(()=>!!de.description);return()=>rt()&&(()=>{var Be=yh();return Be.style.setProperty("font-size","0.75rem"),Be.style.setProperty("color","var(--text-muted)"),Be.style.setProperty("margin-top","0.25rem"),Be.style.setProperty("font-style","italic"),a(Be,(()=>{var Ge=ke(()=>de.description.length>60);return()=>Ge()?`${de.description.substring(0,60)}...`:de.description})()),Be})()})(),null),p(Re,H),He.style.setProperty("font-weight","600"),(ce?"#f44336":"var(--text-primary)")!=null?He.style.setProperty("color",ce?"#f44336":"var(--text-primary)"):He.style.removeProperty("color"),a(He,Y,je),a(He,()=>de.unitOfMeasure,null),Ve.style.setProperty("color","var(--text-muted)"),a(Ve,()=>ce?(()=>{var rt=YD();return rt.firstChild,rt.style.setProperty("color","#f44336"),a(rt,()=>e("inventory.lowStock","Low Stock"),null),rt})():e("inventory.inStock","In Stock")),qe.style.setProperty("font-size","0.75rem"),qe.style.setProperty("color","var(--text-muted)"),qe.style.setProperty("margin-top","0.25rem"),a(qe,()=>e("inventory.min","Min"),tt),a(qe,()=>de.minStockLevel,null),ge(rt=>p(ue,z(re()===s()),rt)),ue})()}}),ke(()=>ke(()=>F().length===b)()&&(()=>{var de=yh();return de.style.setProperty("padding","0.5rem"),de.style.setProperty("text-align","center"),de.style.setProperty("font-size","0.75rem"),de.style.setProperty("color","var(--text-muted)"),de.style.setProperty("border-top","1px solid var(--border-color)"),de.style.setProperty("font-style","italic"),a(de,()=>e("inventory.showingTopResults","Showing top {{count}} results",{count:b})),de})())]}}),null),ge(de=>p(oe,j,de)),oe}}),null),ge(oe=>{var de=w,re=ne,Y=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),ce=t.disabled,ue=t.required;return oe.e=p(D,de,oe.e),oe.t=p(Z,re,oe.t),Y!==oe.a&&Jt(Z,"placeholder",oe.a=Y),ce!==oe.o&&(Z.disabled=oe.o=ce),ue!==oe.i&&(Z.required=oe.i=ue),oe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ge(()=>Z.value=k()),D})()};Wt(["input","click","keydown"]);var QD=le("<h4>📦 Productos (<!>)"),JD=le('<div><div><span>📦 Producto: </span><button type=button title="Eliminar producto">🗑️</button></div><div><div><label>Cantidad</label><div></div></div><div><label>Cantidad</label></div><div><label>Precio Venta ($)');const XD=t=>{const e=(c,d)=>{let u={...d};const h=t.products[c];if(h&&(d.qty!==void 0||d.salePrice!==void 0)){const g=d.qty??h.qty,m=d.salePrice??h.salePrice;u={...u,total:g*m}}t.onUpdateProduct(c,u),t.onBulkChange()},r=(c,d)=>{confirm(`¿Eliminar producto "${d.product.label||"sin nombre"}"?

Esta acción no se puede deshacer.`)&&(t.onRemoveProduct(c),t.onBulkChange())},n=(c,d)=>{const u=gt.getProductById(c);if(!u)return;const h=t.products[d]||{},g={product:{id:u.id,code:u?.sku||"",label:u.name||"",price:u.unitCost||0}},m={...h,...g};console.log(m),e(d,m)},i={border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-bottom":"0.5rem",background:"white"},o={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"0.5rem"},s={color:"white",border:"none","border-radius":"50%",width:"28px",height:"28px",display:"flex","align-items":"center","justify-content":"center",cursor:"pointer","font-size":"0.75rem"},l={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"0.5rem"};return[A(Me,{get when(){return t.products.length>0},get children(){var c=QD(),d=c.firstChild,u=d.nextSibling;return u.nextSibling,c.style.setProperty("font-size","1rem"),c.style.setProperty("font-weight","bold"),c.style.setProperty("color","var(--success-color)"),c.style.setProperty("margin","1.9rem 0 0.75rem 0 "),c.style.setProperty("border-bottom","1px solid var(--border-color)"),c.style.setProperty("padding-bottom","0.5rem"),a(c,()=>t.products.length,u),c}}),A(vt,{get each(){return t.products},children:(c,d)=>(()=>{var u=JD(),h=u.firstChild,g=h.firstChild;g.firstChild;var m=g.nextSibling,S=h.nextSibling,N=S.firstChild,x=N.firstChild,b=x.nextSibling,K=N.nextSibling,te=K.firstChild,F=K.nextSibling,V=F.firstChild;return p(u,i),p(h,o),g.style.setProperty("font-weight","bold"),g.style.setProperty("color","var(--success-color)"),a(g,()=>c.product.label||"Sin nombre",null),m.$$click=()=>r(d(),c),p(m,s),p(S,l),x.style.setProperty("font-size","0.875rem"),x.style.setProperty("font-weight","500"),b.style.setProperty("margin",".6rem 0"),a(b,A(KD,{value:"",onChange:W=>n(W,d()),placeholder:"Buscar productos por nombre, SKU o categoria para agregar a la factura...",searchDelay:300,maxResults:15})),K.style.setProperty("text-align","center"),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("font-weight","500"),te.style.setProperty("text-align","right"),a(K,A(Lt,{type:"number",style:{"max-width":"120px"},get value(){return c.qty.toString()},min:"1",onChange:W=>e(d(),{qty:Number(W)||1})}),null),F.style.setProperty("text-align","center"),V.style.setProperty("font-size","0.875rem"),V.style.setProperty("font-weight","500"),a(F,A(Lt,{type:"number",style:{"max-width":"120px"},get value(){return c.salePrice.toString()},step:"0.01",onChange:W=>e(d(),{salePrice:Number(W)||0})}),null),u})()})]};Wt(["click"]);var lb=le("<div>"),ZD=le("<div><input type=text autocomplete=off>"),e9=le("<div>No se encontraron tipos de servicio");const cb=["🚛 Transporte","📦 Empaque","🔧 Rapeado","🏷️ Etiquetado","📋 Documentación","🛠️ Instalación","🔍 Inspección","📸 Fotografía","🧹 Limpieza","⚖️ Pesaje","📏 Medición","🎁 Gift Wrap","🔒 Seguro","📞 Notificación","🚚 Entrega a Domicilio"],t9=t=>{const[e,r]=Se(!1),[n,i]=Se(""),[o,s]=Se(-1),l=()=>{const[te,F]=Se(""),V=n().toLowerCase();if(!V)return cb.slice(0,20);const W=cb.filter(I=>I.toLowerCase().includes(V));return W.length===0&&V.length>0?[`✏️ Agregar "${n()}"`]:W.slice(0,15)},c=()=>{r(!0),i(""),s(-1)},d=te=>{const V=te.target.value;i(V),r(V.length>=0),s(-1)},u=te=>{let F;te.startsWith("✏️ Agregar")?F=n():F=te.replace(/^[\u{1F000}-\u{1F9FF}\u{2600}-\u{27BF}]\s*/u,""),t.onChange(F),r(!1),i(""),s(-1)},h=te=>{const F=l();switch(te.key){case"ArrowDown":te.preventDefault(),s(V=>Math.min(V+1,F.length-1));break;case"ArrowUp":te.preventDefault(),s(V=>Math.max(V-1,-1));break;case"Enter":te.preventDefault(),o()>=0&&F[o()]&&u(F[o()]);break;case"Escape":r(!1),i(""),s(-1);break}},g=te=>{setTimeout(()=>{r(!1),i(""),s(-1)},150)},m=()=>e()&&n()?n():t.value||"",S={position:"relative",width:"100%",...t.style},N={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem","margin-bottom":"0.5rem",background:"var(--surface-color)"},x={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"200px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},b=te=>({padding:"0.5rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:te?"var(--primary-color)":"transparent",color:te?"white":"var(--text-primary)",transition:"all 0.2s ease","font-size":"0.875rem"}),K={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic","font-size":"0.875rem"};return(()=>{var te=ZD(),F=te.firstChild;return F.addEventListener("blur",g),F.$$keydown=h,F.$$click=c,F.$$input=d,p(F,N),a(te,A(Me,{get when(){return e()},get children(){var V=lb();return a(V,A(Me,{get when(){return l().length>0},get fallback(){return(()=>{var W=e9();return p(W,K),W})()},get children(){return A(vt,{get each(){return l()},children:(W,I)=>(()=>{var E=lb();return E.addEventListener("mouseenter",()=>s(I())),E.$$click=()=>u(W),a(E,W),ge(L=>p(E,b(I()===o()),L)),E})()})}})),ge(W=>p(V,x,W)),V}}),null),ge(V=>{var W=S,I=t.placeholder||"Buscar tipo de servicio...";return V.e=p(te,W,V.e),I!==V.t&&Jt(F,"placeholder",V.t=I),V},{e:void 0,t:void 0}),ge(()=>F.value=m()),te})()};Wt(["input","click","keydown"]);var r9=le("<h4>🔧 Servicios (<!>)"),n9=le('<div><div><span>🔧 Servicio: </span><button type=button title="Eliminar servicio">🗑️</button></div><div><div><label>Tipo de Servicio</label></div><div><label>Cantidad</label></div><div><label>Precio ($)');const i9=t=>{const e=(c,d)=>{let u={...d};const h=t.services[c];if(h&&(d.qty!==void 0||d.price!==void 0)){const g=d.qty??h.qty,m=d.price??h.price;u={...u,total:m*g}}t.onUpdateService(c,u),t.onBulkChange()},r=(c,d)=>{confirm(`¿Eliminar servicio "${d.type||"sin tipo"}"?

Esta acción no se puede deshacer.`)&&(t.onRemoveService(c),t.onBulkChange())},n={border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-bottom":"0.5rem",background:"white"},i={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"0.5rem"},o={color:"white",border:"none","border-radius":"50%",width:"28px",height:"28px",display:"flex","align-items":"center","justify-content":"center",cursor:"pointer","font-size":"0.75rem"},s={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem","margin-bottom":"0.5rem"},l={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"0.5rem"};return[A(Me,{get when(){return t.services.length>0},get children(){var c=r9(),d=c.firstChild,u=d.nextSibling;return u.nextSibling,c.style.setProperty("font-size","1rem"),c.style.setProperty("font-weight","bold"),c.style.setProperty("color","var(--warning-color)"),c.style.setProperty("margin","1.9rem 0 0.75rem 0 "),c.style.setProperty("border-bottom","1px solid var(--border-color)"),c.style.setProperty("padding-bottom","0.5rem"),a(c,()=>t.services.length,u),c}}),A(vt,{get each(){return t.services},children:(c,d)=>(()=>{var u=n9(),h=u.firstChild,g=h.firstChild;g.firstChild;var m=g.nextSibling,S=h.nextSibling,N=S.firstChild,x=N.firstChild,b=N.nextSibling,K=b.firstChild,te=b.nextSibling,F=te.firstChild;return p(u,n),p(h,i),g.style.setProperty("font-weight","bold"),g.style.setProperty("color","var(--warning-color)"),a(g,()=>c.type||"Sin tipo",null),m.$$click=()=>r(d(),c),p(m,o),p(S,l),x.style.setProperty("font-size","0.875rem"),x.style.setProperty("font-weight","500"),a(N,A(t9,{get value(){return c.type},onChange:V=>e(d(),{type:V}),placeholder:"Buscar tipo de servicio, Ej: Empaque, Etiquetado, Transporte...",style:{"margin-bottom":"0"}}),null),K.style.setProperty("font-size","0.875rem"),K.style.setProperty("font-weight","500"),a(b,A(Lt,{type:"number",style:s,get value(){return c.qty.toString()},min:"1",onChange:V=>e(d(),{qty:Number(V)||1})}),null),F.style.setProperty("font-size","0.875rem"),F.style.setProperty("font-weight","500"),a(te,A(Lt,{type:"number",style:s,get value(){return c.arancel.toString()},step:"0.01",onChange:V=>e(d(),{arancel:Number(V)||0})}),null),u})()})]};Wt(["click"]);var o9=le("<div><h4>Información de Precios </h4><div>• <strong>Misceláneas:</strong> $3.99 (&lt;50 lbs) / $2.99 (≥50 lbs) - <em>Calculado por peso</em><br>• <strong>Duraderos:</strong> $4.50 + arancel dinámico por cantidad<br>• <strong>Aranceles Duraderos:</strong> 0-5 qty: $5, 5-20 qty: $10, 20-50 qty: $20, 50-100 qty: $35, 100+ qty: $50<br>• <strong>Baterías Litio:</strong> $8.99 (bulto exclusivo)<br>• <strong>Equipos Exclusivos:</strong> $6.99 (bulto exclusivo - TV, computadoras, generadores)<br>• <strong>Documentos:</strong> $1.99<br>• <strong>Transporte:</strong> $20 mínimo por bulto<br>"),s9=le("<div><div>📦</div><h3>No hay bultos creados</h3><p>Cree un bulto para comenzar a organizar sus reservas, productos y servicios.</p><button type=button><span>➕</span><span>Crear Primer Bulto"),a9=le("<div><div><h3>Gestión de Bultos</h3><div><button type=button></button><button type=button><span>Crear Bulto"),l9=le("<br>"),c9=le("<strong>Auto-cálculo desactivado:"),d9=le("<div>Este bulto está vacío. Use los botones de arriba para agregar items."),u9=le("<div><div><div><label>Nombre del Bulto</label></div><div><label>Costo Transporte ($)</label></div></div><div><button type=button>Reserva</button><button type=button>Producto</button><button type=button>Servicio</button><button type=button>Eliminar Bulto"),h9=le("<div><div><div><span></span><span>(<!> items, <!> lbs)</span></div><div><div>$</div><div>Items: $<!> + Transport: $");const p9=t=>{const[e,r]=Se(new Set),[n,i]=Se(!1),[o,s]=Se(!0),l=j=>{r(z=>{const T=new Set(z);return T.has(j)?T.delete(j):T.add(j),T})},c=j=>{const z=t.bulks?.findIndex(T=>T?.id===j);z!==-1&&t.onUpdateBulk(z,{token:ki()})},d=()=>{const j={id:ki(),name:`Bulto ${t.bulks?.length+1}`,type:"PERSONAL",maxWeight:50,currentWeight:0,transportCost:ob,shippingMethod:t.shippingMethod||"AEREO",status:"DRAFT",token:ki()};t.onAddBulk(j)},u=j=>{const z=py(j,t.products,t.reservas,t.services);if(!z.isValid){alert(z.error);return}const T={id:ki(),type:"",qty:1,weight:0,category:"MISCELANEAS",price:0,arancel:0,total:0,bulkId:j,autoCalculate:!1};t.onAddReserva(T),c(j)},h=j=>{const z=py(j,t.products,t.reservas,t.services);if(!z.isValid){alert(z.error);return}const T={id:ki(),product:{id:"",code:"",label:"",price:0},qty:1,salePrice:0,total:0,bulkId:j};t.onAddProduct(T),c(j)},g=j=>{const z=py(j,t.products,t.reservas,t.services);if(!z.isValid){alert(z.error);return}const T={id:ki(),type:"",qty:1,price:0,arancel:0,total:0,bulkId:j};t.onAddService(T),c(j)},m=(j,z)=>{var T=t.reservas;const R=t.reservas[j];if(!R)return;console.log("handleUpdateReserva called with:",{index:j,updates:z,reserva:R,autoCalculation:o()});let J={...z};if(o()&&z.autoCalculate!==!1&&R.autoCalculate!==!1&&(z.type||z.category||z.qty!==void 0)){const H=z.type||R.type,se=z.qty??R.qty,O=z.bulkId||R.bulkId||"",_=z.category||R.category;if(H||R.type){const k=H||R.type;if(O&&z.type){const U=kD(k,O,t.products,t.reservas,t.services);if(!U.isValid){alert(U.error);return}}T[j]={...R,type:H,qty:se,bulkId:O,category:_};const $=_||su(k),G=ff($,O,T),ne=gf($,se);J={...J,category:$,price:G,arancel:ne,total:(G+ne)*se},console.log("Auto-calculation results:",{typeToUse:k,category:$,newQty:se,dynamicPrice:G,dynamicArancel:ne,total:(G+ne)*se})}if(z.qty!==void 0||z.category!==void 0){console.log("Recalculating all reservas due to quantity/weight change...");const k=t.reservas.map(($,G)=>G===j?{...$,qty:J.qty||$.qty}:$);t.reservas.forEach(($,G)=>{const ne=$.autoCalculate!==!1;if($.type&&$.category&&ne){const U=G===j?{...$,...J}:$,D=ff(U.category,U.bulkId||"",k,U.qty),B=gf(U.category,G===j&&J.qty||U.qty),Q={category:U.category,price:D,arancel:B,total:(D+B)*U.qty};G===j?t.onUpdateReserva(G,{...J,...Q}):t.onUpdateReserva(G,Q)}else G===j&&t.onUpdateReserva(G,J)})}else t.onUpdateReserva(j,J)}else{if(z.price!==void 0||z.arancel!==void 0||z.qty!==void 0){const H=z.price??R.price,se=z.arancel??R.arancel,O=z.qty??R.qty;J={...J,total:(H+se)*O}}t.onUpdateReserva(j,J)}},S=j=>({reservas:t.reservas.filter(z=>z.bulkId===j),products:t.products.filter(z=>z.bulkId===j),services:t.services.filter(z=>z.bulkId===j)}),N=j=>{const z=S(j),T=t.bulks.find(H=>H?.id===j),R=[...z.reservas.map(H=>H.qty*H.price+H.arancel),...z.products.map(H=>H.qty*H.salePrice),...z.services.map(H=>H.qty*H.arancel)].reduce((H,se)=>H+se,0),J=T?.transportCost||ob,X=[...z.reservas.map(H=>H.qty),...z.products.map(H=>H.qty),...z.services.map(H=>H.qty)].reduce((H,se)=>H+se,0);return{itemsTotal:R,transportCost:J,grandTotal:R+J,totalItems:z.reservas.length+z.products.length+z.services.length,totalQty:X}},x={"margin-bottom":"2rem"},b={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem","padding-bottom":"0.5rem","border-bottom":"2px solid var(--primary-color)"},K={"font-size":"1.25rem","font-weight":"bold",color:"var(--text-primary)",margin:"0"},te={background:"var(--primary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",padding:"0.5rem 1rem",cursor:"pointer","font-size":"0.875rem","font-weight":"500",transition:"all 0.2s ease",display:"flex","align-items":"center",gap:"0.5rem"},F={background:n()?"var(--success-color)":"var(--border-color)",color:n()?"white":"var(--text-muted)",border:"none","border-radius":"var(--border-radius-sm)",padding:"0.5rem 1rem",cursor:"pointer","font-size":"0.875rem","margin-right":"0.5rem"},V={border:"1px solid var(--border-color)","border-radius":"var(--border-radius)","margin-bottom":"1rem",background:"var(--surface-color)"},W=j=>{N(j?.id);const z=e().has(j?.id);return{display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem","background-color":z?"var(--strip-color)":"var(--surface-color)","border-bottom":z?"none":"1px solid var(--border-color)",cursor:"pointer"}},I={padding:"1rem"},E={display:"flex",gap:"0.5rem","margin-bottom":"1rem","flex-wrap":"wrap"},L={background:"var(--strip-color)",color:"var(--primary-color)",border:"1px solid var(--primary-color)","border-radius":"var(--border-radius-sm)",padding:"0.5rem 1rem",cursor:"pointer","font-size":"0.875rem",transition:"all 0.2s ease"},M={color:"var(--error-color)",background:"white",border:"none","border-radius":"var(--border-radius-sm)",padding:"0.25rem 0.5rem",cursor:"pointer","font-size":"0.75rem"},P={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem"},w={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"0.5rem"},v={"align-items":"center",display:" flex"};return(()=>{var j=a9(),z=j.firstChild,T=z.firstChild,R=T.firstChild,J=T.nextSibling,X=J.firstChild,H=X.nextSibling,se=H.firstChild;return p(j,x),p(z,b),p(T,K),a(T,A(Yr,{name:"operations",size:"1.2em",style:{"margin-right":"0.5rem"}}),R),J.style.setProperty("display","flex"),X.$$click=()=>i(!n()),a(X,A(Yr,{get name(){return n()?"close":"finance"},size:"1em",style:{"margin-right":"0.5rem"}}),null),a(X,()=>n()?"Ocultar Precios":"Mostrar Precios",null),H.$$click=d,a(H,A(Yr,{name:"add",size:"1em",style:{"margin-right":"0.5rem"}}),se),a(j,A(Me,{get when(){return n()},get children(){var O=o9(),_=O.firstChild,k=_.firstChild,$=_.nextSibling,G=$.firstChild,ne=G.nextSibling,U=ne.nextSibling,D=U.nextSibling,B=D.nextSibling,Q=B.nextSibling,Z=Q.nextSibling,oe=Z.nextSibling,de=oe.nextSibling,re=de.nextSibling,Y=re.nextSibling,ce=Y.nextSibling,ue=ce.nextSibling,ae=ue.nextSibling,ye=ae.nextSibling,me=ye.nextSibling,pe=me.nextSibling,ve=pe.nextSibling,Ne=ve.nextSibling,Ie=Ne.nextSibling,Ce=Ie.nextSibling,Ee=Ce.nextSibling,we=Ee.nextSibling,Re=we.nextSibling,He=Re.nextSibling,je=He.nextSibling,Ve=je.nextSibling,qe=Ve.nextSibling;return qe.nextSibling,O.style.setProperty("background","var(--info-color)"),O.style.setProperty("padding","1rem"),O.style.setProperty("border-radius","var(--border-radius)"),O.style.setProperty("margin-bottom","1rem"),_.style.setProperty("margin","0 0 0.5rem 0"),_.style.setProperty("font-size","1rem"),a(_,A(Yr,{name:"finance",size:"1em",style:{"margin-right":"0.5rem"}}),k),a(_,(()=>{var tt=ke(()=>!!o());return()=>tt()?[A(Yr,{name:"robot",size:"0.9em",style:{"margin-left":"0.5rem","margin-right":"0.3rem"}}),"Auto-Cálculo ACTIVO"]:[A(Yr,{name:"hand",size:"0.9em",style:{"margin-left":"0.5rem","margin-right":"0.3rem"}}),"Auto-Cálculo DESACTIVADO"]})(),null),$.style.setProperty("font-size","0.875rem"),$.style.setProperty("line-height","1.4"),a($,(()=>{var tt=ke(()=>!o());return()=>tt()&&[l9(),(()=>{var rt=c9(),Be=rt.firstChild;return a(rt,A(Yr,{name:"warning",size:"0.9em",style:{"margin-right":"0.3rem"}}),Be),rt})()," Los precios y aranceles deben ingresarse manualmente"]})(),null),O}}),null),a(j,A(vt,{get each(){return t.bulks},children:(O,_)=>{const k=N(O?.id),$=e().has(O?.id),G=S(O?.id);return(()=>{var ne=h9(),U=ne.firstChild,D=U.firstChild,B=D.firstChild,Q=B.nextSibling,Z=Q.firstChild,oe=Z.nextSibling,de=oe.nextSibling,re=de.nextSibling;re.nextSibling;var Y=D.nextSibling,ce=Y.firstChild;ce.firstChild;var ue=ce.nextSibling,ae=ue.firstChild,ye=ae.nextSibling;return ye.nextSibling,p(ne,V),U.$$click=()=>l(O?.id),B.style.setProperty("font-weight","bold"),B.style.setProperty("font-size","1.1rem"),a(B,A(Yr,{name:$?"folder-closed":"folder-open",size:"1em",style:{"margin-right":"0.5rem"}}),null),a(B,()=>O?.name,null),Q.style.setProperty("margin-left","0.5rem"),Q.style.setProperty("color","var(--text-muted)"),Q.style.setProperty("font-size","0.875rem"),a(Q,()=>k.totalItems,oe),a(Q,()=>k.totalQty,re),Y.style.setProperty("text-align","right"),ce.style.setProperty("font-weight","bold"),ce.style.setProperty("color","var(--primary-color)"),a(ce,()=>k.grandTotal.toFixed(2),null),ue.style.setProperty("font-size","0.75rem"),ue.style.setProperty("color","var(--text-muted)"),a(ue,()=>k.itemsTotal.toFixed(2),ye),a(ue,()=>k.transportCost.toFixed(2),null),a(ne,A(Me,{when:!$,get children(){var me=u9(),pe=me.firstChild,ve=pe.firstChild,Ne=ve.firstChild,Ie=ve.nextSibling,Ce=Ie.firstChild,Ee=pe.nextSibling,we=Ee.firstChild,Re=we.firstChild,He=we.nextSibling,je=He.firstChild,Ve=He.nextSibling,qe=Ve.firstChild,tt=Ve.nextSibling,rt=tt.firstChild;return p(me,I),p(pe,w),a(ve,A(Lt,{type:"text",style:P,get value(){return O?.name},onChange:Be=>t.onUpdateBulk(_(),{name:Be})}),null),Ce.style.setProperty("font-size","0.875rem"),Ce.style.setProperty("font-weight","500"),a(Ie,A(Lt,{type:"number",style:P,get value(){return(O?.transportCost||0).toString()},min:0,onChange:Be=>t.onUpdateBulk(_(),{transportCost:Math.max(0,Number(Be))})}),null),p(Ee,E),we.$$click=()=>u(O?.id),a(we,A(Yr,{name:"add",size:"1em",style:{"margin-right":"0.3rem"}}),Re),He.$$click=()=>h(O?.id),a(He,A(Yr,{name:"add",size:"1em",style:{"margin-right":"0.3rem"}}),je),Ve.$$click=()=>g(O?.id),a(Ve,A(Yr,{name:"add",size:"1em",style:{"margin-right":"0.3rem"}}),qe),tt.$$click=()=>t.onRemoveBulk(_()),a(tt,A(Yr,{name:"delete",size:"1em",color:"red",style:{"margin-right":"0.3rem"}}),rt),a(me,A(BD,{get reservas(){return G.reservas},get showPricing(){return n()},get autoCalculation(){return o()},onUpdateReserva:(Be,Ge)=>{const Fe=G.reservas[Be],at=t.reservas.findIndex(lt=>lt.id===Fe.id);m(at,Ge)},onRemoveReserva:Be=>{const Ge=G.reservas[Be],Fe=t.reservas.findIndex(at=>at.id===Ge.id);t.onRemoveReserva(Fe)},onBulkChange:()=>c(O?.id)}),null),a(me,A(XD,{get products(){return G.products},get showPricing(){return n()},onUpdateProduct:(Be,Ge)=>{const Fe=G.products[Be],at=t.products.findIndex(lt=>lt.id===Fe.id);t.onUpdateProduct(at,Ge)},onRemoveProduct:Be=>{const Ge=G.products[Be],Fe=t.products.findIndex(at=>at.id===Ge.id);t.onRemoveProduct(Fe)},onBulkChange:()=>c(O?.id)}),null),a(me,A(i9,{get services(){return G.services},get showPricing(){return n()},onUpdateService:(Be,Ge)=>{const Fe=G.services[Be],at=t.services.findIndex(lt=>lt.id===Fe.id);t.onUpdateService(at,Ge)},onRemoveService:Be=>{const Ge=G.services[Be],Fe=t.services.findIndex(at=>at.id===Ge.id);t.onRemoveService(Fe)},onBulkChange:()=>c(O?.id)}),null),a(me,A(Me,{get when(){return k.totalItems===0},get children(){var Be=d9();return Be.style.setProperty("text-align","center"),Be.style.setProperty("color","var(--text-muted)"),Be.style.setProperty("font-style","italic"),Be.style.setProperty("padding","2rem"),Be}}),null),ge(Be=>{var Ge={"font-size":"0.875rem","font-weight":"500",...v},Fe=L,at=L,lt=L,Xe={...M,"margin-left":"auto",color:"red"};return Be.e=p(Ne,Ge,Be.e),Be.t=p(we,Fe,Be.t),Be.a=p(He,at,Be.a),Be.o=p(Ve,lt,Be.o),Be.i=p(tt,Xe,Be.i),Be},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),me}}),null),ge(me=>p(U,W(O),me)),ne})()}}),null),a(j,A(Me,{get when(){return t.bulks.length===0},get children(){var O=s9(),_=O.firstChild,k=_.nextSibling,$=k.nextSibling,G=$.nextSibling;return O.style.setProperty("text-align","center"),O.style.setProperty("padding","3rem"),O.style.setProperty("color","var(--text-muted)"),O.style.setProperty("border","2px dashed var(--border-color)"),O.style.setProperty("border-radius","var(--border-radius)"),_.style.setProperty("font-size","2rem"),_.style.setProperty("margin-bottom","1rem"),k.style.setProperty("margin-bottom","0.5rem"),$.style.setProperty("margin-bottom","1rem"),G.$$click=d,ge(ne=>p(G,te,ne)),O}}),null),ge(O=>{var _=F,k=te;return O.e=p(X,_,O.e),O.t=p(H,k,O.t),O},{e:void 0,t:void 0}),j})()};Wt(["click"]);var m9=le("<label>"),my=le("<div>"),y9=le("<button type=button>✕ Limpiar"),f9=le("<div><span>📱</span><span>Modo Escáner Activado: Escanee código de barras del ID cubano"),g9=le("<div><span>🔄</span><span>"),v9=le("<div><div><input type=text autocomplete=off><button type=button>"),b9=le("<span>📞 "),P9=le("<span>🆔 "),_9=le("<span>📧 "),S9=le("<div><div><div><div>👤 </div><div>");const w9=t=>{const{t:e}=or(),[r,n]=Se(!1),[i,o]=Se(""),[s,l]=Se(-1),[c,d]=Se(!1),[u,h]=Se([]),[g,m]=Se(null),[S,N]=Se(!1),[x,b]=Se(""),K=async G=>{if(!G.trim()||G.trim().length<6){h([]);return}try{d(!0);const ne=await ai.getConsigee(G);console.log(ne);const U=Object.values(ne).map(D=>({id:D.consigneeId,firstName:D.firstName,middleName:D.middleName,fullName:D.firstName+(D.middleName?" "+D.middleName:"")+" "+D.lastName+" "+D.lastName2,lastName:D.lastName+" "+D.lastName2,cid:D.cid,phoneNumber:D.phoneNumber,ybbetwen1:D.ybbetwen1,ybcity:D.ybcity,ybestate:D.ybestate,ybreparto:D.ybreparto,ybstreet:D.ybstreet,ybstreetNo:D.ybstreetNo,address:`Calle ${D.ybstreet}${D.ybstreetNo?" # "+D.ybstreetNo:""}${D.ybbetwen1?" / "+D.ybbetwen1:""}${D.ybbetwen2?" y "+D.ybbetwen2:""}${D.ybreparto?", Rpto "+D.ybreparto:""}, ${D.ybcity?D.ybcity:""}, ${D.ybestate?D.ybestate:""}`}));h(U)}catch(ne){console.warn("API search failed, falling back to local search:",ne)}finally{d(!1)}},te=G=>{const U=G.target.value;if(b(U),U.length>=11){g()&&clearTimeout(g());const D=setTimeout(()=>{K(U),n(!0),l(-1)},300);m(D)}else U.length===0&&(h([]),n(!1))},F=()=>{N(!S()),b(""),o(""),n(!1),h([]),g()&&(clearTimeout(g()),m(null))},V=()=>{b(""),n(!1),h([]),g()&&(clearTimeout(g()),m(null))},W=()=>{n(!0),o(""),l(-1),i()||K("")},I=G=>{const U=G.target.value;o(U),n(!0),l(-1),g()&&clearTimeout(g());const D=setTimeout(()=>{K(U)},600);m(D)},E=G=>{t.onChange(G),n(!1),o(""),l(-1),g()&&(clearTimeout(g()),m(null))},L=G=>{const ne=u();switch(G.key){case"ArrowDown":G.preventDefault(),l(U=>Math.min(U+1,ne.length-1));break;case"ArrowUp":G.preventDefault(),l(U=>Math.max(U-1,-1));break;case"Enter":G.preventDefault(),s()>=0&&ne[s()]&&E(ne[s()]);break;case"Escape":n(!1),o(""),l(-1),g()&&(clearTimeout(g()),m(null));break}},M=G=>{setTimeout(()=>{n(!1),o(""),l(-1),g()&&(clearTimeout(g()),m(null))},150)},P=()=>S()?x()||"":r()&&i()?i()||"":t.value&&t.value.cid||"";Ln(()=>(K(""),()=>{g()&&clearTimeout(g())}));const w={position:"relative",width:"100%",...t.style},v={display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},j={"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","font-style":"italic"},z={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},T={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},R=G=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:G?"var(--strip-color)":"transparent",color:G?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),J={display:"flex","justify-content":"space-between","align-items":"flex-start"},X={flex:"1"},H={"font-weight":"500","margin-bottom":"0.25rem"},se={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex","flex-direction":"column",gap:"0.125rem"},O={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},_={position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:S()?"var(--primary-color)":"var(--border-color)",color:S()?"white":"var(--text-muted)",border:"none","border-radius":"4px",padding:"6px 8px",cursor:"pointer","font-size":"12px","z-index":"10",transition:"all 0.2s ease"},k={position:"relative",width:"100%"},$={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"};return(()=>{var G=v9(),ne=G.firstChild,U=ne.firstChild,D=U.nextSibling;return a(G,A(Me,{get when(){return t.label},get children(){var B=m9();return p(B,v),a(B,()=>t.label),B}}),ne),a(G,A(Me,{get when(){return t.description},get children(){var B=my();return p(B,j),a(B,()=>t.description),B}}),ne),a(G,A(Me,{get when(){return S()},get children(){var B=f9(),Q=B.firstChild;return Q.nextSibling,B.style.setProperty("margin-bottom","0.5rem"),B.style.setProperty("padding","0.5rem"),B.style.setProperty("background-color","var(--primary-color)"),B.style.setProperty("color","white"),B.style.setProperty("border-radius","4px"),B.style.setProperty("font-size","0.875rem"),B.style.setProperty("display","flex"),B.style.setProperty("align-items","center"),B.style.setProperty("gap","0.5rem"),a(B,A(Me,{get when(){return x().length>0},get children(){var Z=y9();return Z.$$click=V,Z.style.setProperty("background","rgba(255,255,255,0.2)"),Z.style.setProperty("border","none"),Z.style.setProperty("color","white"),Z.style.setProperty("border-radius","2px"),Z.style.setProperty("padding","2px 6px"),Z.style.setProperty("cursor","pointer"),Z.style.setProperty("font-size","0.75rem"),Z}}),null),B}}),ne),Cn(U,"blur",S()?void 0:M),Cn(U,"keydown",S()?void 0:L,!0),Cn(U,"click",S()?void 0:W,!0),Cn(U,"input",S()?te:I,!0),D.$$click=F,a(D,()=>S()?"📱 Scanner":"🔍 Manual"),a(G,A(Me,{get when(){return r()},get children(){var B=my();return a(B,A(Me,{get when(){return c()},get children(){var Q=g9(),Z=Q.firstChild,oe=Z.nextSibling;return p(Q,$),a(oe,()=>e("common.searching","Buscando clientes...")),Q}}),null),a(B,A(Me,{get when(){return ke(()=>!c())()&&u().length>0},get fallback(){return ke(()=>!c())()&&(()=>{var Q=my();return p(Q,O),a(Q,(()=>{var Z=ke(()=>!!i());return()=>Z()?e("customer.noCustomersFound","No se encontraron clientes. Puede crear un nuevo cliente llenando el formulario."):e("customer.noCustomersAvailable","No se encontraron clientes previos. Se creará un nuevo cliente.")})()),Q})()},get children(){return A(vt,{get each(){return u()},children:(Q,Z)=>(()=>{var oe=S9(),de=oe.firstChild,re=de.firstChild,Y=re.firstChild;Y.firstChild;var ce=Y.nextSibling;return oe.addEventListener("mouseenter",()=>l(Z())),oe.$$click=()=>E(Q),p(de,J),p(re,X),p(Y,H),a(Y,()=>Q.fullName,null),p(ce,se),a(ce,A(Me,{get when(){return Q.phoneNumber},get children(){var ue=b9();return ue.firstChild,a(ue,()=>Q.phoneNumber,null),ue}}),null),a(ce,A(Me,{get when(){return Q.cid},get children(){var ue=P9();return ue.firstChild,a(ue,()=>Q.cid,null),ue}}),null),a(ce,A(Me,{get when(){return Q.email},get children(){var ue=_9();return ue.firstChild,a(ue,()=>Q.email,null),ue}}),null),ge(ue=>p(oe,R(Z()===s()),ue)),oe})()})}}),null),ge(Q=>p(B,T,Q)),B}}),null),ge(B=>{var Q=w,Z=k,oe={...z,"padding-right":"80px","border-color":S()?"var(--primary-color)":"var(--border-color)","box-shadow":S()?"0 0 0 3px rgba(108, 92, 231, 0.1)":"none"},de=S()?"Escanee código de barras del ID o escriba cédula (11 dígitos)...":t.placeholder||e("customer.searchPlaceholder","Buscar clientes por nombre, teléfono, ID..."),re=t.disabled,Y=t.required,ce=_,ue=S()?"Cambiar a búsqueda manual":"Activar modo escáner";return B.e=p(G,Q,B.e),B.t=p(ne,Z,B.t),B.a=p(U,oe,B.a),de!==B.o&&Jt(U,"placeholder",B.o=de),re!==B.i&&(U.disabled=B.i=re),Y!==B.n&&(U.required=B.n=Y),B.s=p(D,ce,B.s),ue!==B.h&&Jt(D,"title",B.h=ue),B},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),ge(()=>U.value=P()),G})()};Wt(["click","input","keydown"]);var x9=le("<label>"),yy=le("<div>"),C9=le("<button type=button>✕ Limpiar"),A9=le("<div><span>📱</span><span>Modo Escáner Activado: Escanee código de barras del ID del remitente"),$9=le("<div><span>🔄</span><span>"),E9=le("<div><div><input type=text autocomplete=off><button type=button>"),I9=le("<span>📞 "),T9=le("<div><div><div><div>👤 </div><div>");const k9=t=>{const{t:e}=or(),[r,n]=Se(!1),[i,o]=Se(""),[s,l]=Se(-1),[c,d]=Se(!1),[u,h]=Se([]),[g,m]=Se(null),[S,N]=Se(!1),[x,b]=Se(""),K=600,te=async U=>{if(!U.trim()||U.trim().length<6){h([]);return}try{d(!0);const D=await ai.getShipper(U),B=Object.values(D).map(Q=>({id:Q.shipperId,name:Q.name,dob:Q.dob,phoneNumberS:Q.phoneNumber,idS:Q.cid,street:Q.street}));h(B)}catch(D){console.warn("API search failed, falling back to local search:",D)}finally{d(!1)}},F=U=>{const B=U.target.value;if(b(B),B.length>=11){g()&&clearTimeout(g());const Q=setTimeout(()=>{te(B),n(!0),l(-1)},300);m(Q)}else B.length===0&&(h([]),n(!1))},V=()=>{N(!S()),b(""),o(""),n(!1),h([]),g()&&(clearTimeout(g()),m(null))},W=()=>{b(""),n(!1),h([]),g()&&(clearTimeout(g()),m(null))},I=U=>{const B=U.target.value;o(B),n(!0),l(-1),g()&&clearTimeout(g());const Q=setTimeout(()=>{te(B)},K);m(Q)},E=()=>{n(!0),o(""),l(-1),i()||te("")},L=U=>{t.onChange(U),n(!1),o(""),l(-1),g()&&(clearTimeout(g()),m(null))},M=U=>{const D=u();switch(U.key){case"ArrowDown":U.preventDefault(),l(B=>Math.min(B+1,D.length-1));break;case"ArrowUp":U.preventDefault(),l(B=>Math.max(B-1,-1));break;case"Enter":U.preventDefault(),s()>=0&&D[s()]&&L(D[s()]),S()&&v();break;case"Escape":n(!1),o(""),l(-1),g()&&(clearTimeout(g()),m(null));break}},P=U=>{setTimeout(()=>{n(!1),o(""),l(-1),g()&&(clearTimeout(g()),m(null))},150)},w=()=>S()?x()||"":r()&&i()?i():t.value?t.value.name:"";Ln(()=>(te(""),()=>{g()&&clearTimeout(g())}));const v=()=>{let U=i();console.log(U);let D=L9(U);if(D?.firstName){let B=D.dob.slice(4,8),Q=D.dob.slice(0,2),Z=D.dob.slice(2,4),oe=`${B}-${Q}-${Z}`;const de={id:D?.dlNumber?.trim(),name:`${D.firstName} ${D.lastName} `,dob:oe,phoneNumberS:"",idS:D.dlNumber?.trim(),addressS:`${D.address}, ${D.city}, ${D.state} ${D.zipCode}`};console.log(de),L(de)}},j={position:"relative",width:"100%",...t.style},z={display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},T={"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","font-style":"italic"},R={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},J={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},X=U=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:U?"var(--strip-color)":"transparent",color:U?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),H={display:"flex","justify-content":"space-between","align-items":"flex-start"},se={flex:"1"},O={"font-weight":"500","margin-bottom":"0.25rem"},_={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex","flex-direction":"column",gap:"0.125rem"},k={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},$={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"},G={position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:S()?"var(--primary-color)":"var(--border-color)",color:S()?"white":"var(--text-muted)",border:"none","border-radius":"4px",padding:"6px 8px",cursor:"pointer","font-size":"12px","z-index":"10",transition:"all 0.2s ease"},ne={position:"relative",width:"100%"};return(()=>{var U=E9(),D=U.firstChild,B=D.firstChild,Q=B.nextSibling;return a(U,A(Me,{get when(){return t.label},get children(){var Z=x9();return p(Z,z),a(Z,()=>t.label),Z}}),D),a(U,A(Me,{get when(){return t.description},get children(){var Z=yy();return p(Z,T),a(Z,()=>t.description),Z}}),D),a(U,A(Me,{get when(){return S()},get children(){var Z=A9(),oe=Z.firstChild;return oe.nextSibling,Z.style.setProperty("margin-bottom","0.5rem"),Z.style.setProperty("padding","0.5rem"),Z.style.setProperty("background-color","var(--primary-color)"),Z.style.setProperty("color","white"),Z.style.setProperty("border-radius","4px"),Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("display","flex"),Z.style.setProperty("align-items","center"),Z.style.setProperty("gap","0.5rem"),a(Z,A(Me,{get when(){return x().length>0},get children(){var de=C9();return de.$$click=W,de.style.setProperty("background","rgba(255,255,255,0.2)"),de.style.setProperty("border","none"),de.style.setProperty("color","white"),de.style.setProperty("border-radius","2px"),de.style.setProperty("padding","2px 6px"),de.style.setProperty("cursor","pointer"),de.style.setProperty("font-size","0.75rem"),de}}),null),Z}}),D),Cn(B,"blur",S()?handleLopValue:P),Cn(B,"keydown",S()?void 0:M,!0),Cn(B,"click",S()?void 0:E,!0),Cn(B,"input",S()?F:I,!0),Q.$$click=V,a(Q,()=>S()?"📱 Scanner":"🔍 Manual"),a(U,A(Me,{get when(){return r()},get children(){var Z=yy();return a(Z,A(Me,{get when(){return c()},get children(){var oe=$9(),de=oe.firstChild,re=de.nextSibling;return p(oe,$),a(re,()=>e("common.searching","Buscando clientes...")),oe}}),null),a(Z,A(Me,{get when(){return ke(()=>!c())()&&u().length>0},get fallback(){return ke(()=>!c())()&&(()=>{var oe=yy();return p(oe,k),a(oe,(()=>{var de=ke(()=>!!i());return()=>de()?e("customer.noShippersFound","No se encontraron clientes. Puede crear un nuevo cliente llenando el formulario."):e("customer.noShippersAvailable","No se encontraron clientes previos. Se creará un nuevo cliente.")})()),oe})()},get children(){return A(vt,{get each(){return u()},children:(oe,de)=>(()=>{var re=T9(),Y=re.firstChild,ce=Y.firstChild,ue=ce.firstChild;ue.firstChild;var ae=ue.nextSibling;return re.addEventListener("mouseenter",()=>l(de())),re.$$click=()=>L(oe),p(Y,H),p(ce,se),p(ue,O),a(ue,()=>oe.name,null),p(ae,_),a(ae,A(Me,{get when(){return oe.phoneNumberS},get children(){var ye=I9();return ye.firstChild,a(ye,()=>oe.phoneNumberS,null),ye}})),ge(ye=>p(re,X(de()===s()),ye)),re})()})}}),null),ge(oe=>p(Z,J,oe)),Z}}),null),ge(Z=>{var oe=j,de=ne,re={...R,"padding-right":"80px","border-color":S()?"var(--primary-color)":"var(--border-color)","box-shadow":S()?"0 0 0 3px rgba(108, 92, 231, 0.1)":"none"},Y=S()?"Escanee código de barras del ID del remitente o escriba cédula (11 dígitos)...":t.placeholder||e("customer.searchPlaceholder","Buscar clientes por nombre, teléfono, ID..."),ce=t.disabled,ue=t.required,ae=G,ye=S()?"Cambiar a búsqueda manual":"Activar modo escáner";return Z.e=p(U,oe,Z.e),Z.t=p(D,de,Z.t),Z.a=p(B,re,Z.a),Y!==Z.o&&Jt(B,"placeholder",Z.o=Y),ce!==Z.i&&(B.disabled=Z.i=ce),ue!==Z.n&&(B.required=Z.n=ue),Z.s=p(Q,ae,Z.s),ye!==Z.h&&Jt(Q,"title",Z.h=ye),Z},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),ge(()=>B.value=w()),U})()},db={DBA:"expirationDate",DCS:"lastName",DAC:"firstName",DAD:"middleName",DBD:"issueDate",DBB:"dob",DBC:"gender",DAY:"eyesColor",DAU:"height",DAG:"address",DAI:"city",DAJ:"state",DAK:"zipCode",DAQ:"dlNumber",DCF:"documentDiscriminator",DCG:"issueCountry",DAZ:"hairColor",DCI:"placeOfBirth"},N9={DDE:"Indicator that the last name is truncated",DDF:"Indicator that the first name is truncated",DCD:"Additional privileges granted to the cardholder (e.g., transportation of hazardous material",DDG:"Indicator that the middle name(s) are truncated",DDA:"Compliance Type",DDB:"Card Revision Date",DCA:"Jurisdiction-specific vehicle class",DBA:"Expiry Date",DCS:"lastName",DAC:"firstName",DBD:"issueDate",DBB:"birthDate",DBC:"gender",DAY:"eyeColor",DAU:"height",DAG:"street",DAI:"city",DAJ:"state",DAK:"zipCode",DAQ:"licenseNumber",DCF:"Document Discriminator",DCG:"issueCountry",DAH:"Street 2",DAZ:"hairColor",DCI:"placeOfBirth",DCJ:"Audit information",DCK:"Inventory Control Number",DBN:"Alias / AKA Family Name",DBG:"Alias / AKA Given Name",DBS:"Alias / AKA Suffix Name",DCU:"Name Suffix",DCE:"Physical Description Weight Range",DCL:"Race / Ethnicity",DCM:"Standard vehicle classification",DCN:"Standard endorsement code",DCO:"Standard restriction code",DCP:"Jurisdiction-specific vehicle classification description",DCQ:"Jurisdiction-specific endorsement code description",DCR:"Jurisdiction-specific restriction code description",DDC:"HazMat Endorsement Expiration Date",DDD:"Limited Duration Document Indicator",DAW:"Weight(pounds)",DAX:"Weight(kilograms)",DDH:"Under 18 Until",DDI:"Under 19 Until",DDJ:"Under 21 Until",DDK:"Organ Donor Indicator",DDL:"Veteran Indicator",DAD:"middleName"},L9=t=>{let e=Object.keys(N9),r={};return e.forEach((i,o)=>{if(t.indexOf(i)>=0){let s=t.split(i);s.length===2&&(t=s.join("*!*!*"+i))}}),t.split("*!*!*").forEach((i,o)=>{let s,l;o===1?(s="DAQ",l=i.substring(i.indexOf(s)+3)):(s=i.substring(0,3),l=i.substring(3).trim()),Object.keys(db).includes(s)&&(r[db[s]]=l)}),r};Wt(["click","input","keydown"]);var R9=le('<div><h3><span>👤</span><span>Información del Cliente</span></h3><div></div><div><div><label>Nombre</label><input type=text placeholder="Nombre completo del cliente"></div><div><label>Fecha de Nacimiento</label><input type=date></div><div><label>ID</label><input type=text placeholder="Número de cédula o ID"></div></div><div><div><label>Dirección</label><input type=text placeholder="Dirección completa"></div></div><div><div><label>Teléfono</label><input type=text placeholder="Número de teléfono">'),D9=le('<div><h3><span>🚚</span><span>Información del Remitente/Destinatario</span></h3><div></div><div><div><label>Primer Nombre *</label><input type=text placeholder="Primer nombre"required></div><div><label>Segundo Nombre</label><input type=text placeholder="Segundo nombre (opcional)"></div><div><label>Primer Apellido *</label><input type=text placeholder="Primer apellido"required></div></div><div><div><label>Cédula/ID *</label><input type=text placeholder="Número de cédula o ID"required></div><div><label>Pasaporte</label><input type=text placeholder="Número de pasaporte (opcional)"></div></div><div><div><label>Teléfono Principal *</label><input type=tel placeholder="Teléfono principal"required></div><div><label>Teléfono Secundario</label><input type=tel placeholder="Teléfono secundario (opcional)"></div></div><div><div><label>Dirección</label><input type=text placeholder="Dirección completa">');const M9=t=>{const e={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)",padding:"1.5rem","margin-bottom":"1.5rem"},r={"font-size":"1.25rem","font-weight":"bold",color:"var(--text-primary)","margin-bottom":"1rem","padding-bottom":"0.5rem","border-bottom":"2px solid var(--primary-color)",display:"flex","align-items":"center",gap:"0.5rem"},n={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem"},i={display:"grid","grid-template-columns":"1fr",gap:"1rem","margin-bottom":"1rem"},o={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem",margin:"1rem 0 "},s={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},l={display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"};return[(()=>{var c=R9(),d=c.firstChild,u=d.nextSibling,h=u.nextSibling,g=h.firstChild,m=g.firstChild,S=m.nextSibling,N=g.nextSibling,x=N.firstChild,b=x.nextSibling,K=N.nextSibling,te=K.firstChild,F=te.nextSibling,V=h.nextSibling,W=V.firstChild,I=W.firstChild,E=I.nextSibling,L=V.nextSibling,M=L.firstChild,P=M.firstChild,w=P.nextSibling;return a(u,A(k9,{get value(){return{name:t.shipperConsignee.name,phoneNumberS:t.shipperConsignee.phoneNumberS,idS:t.shipperConsignee.idS,dob:t.shipperConsignee.dob,addressS:t.shipperConsignee.addressS}},onChange:v=>{v&&(console.log({shipper:v}),t.onShipperConsigneeChange({name:v.name||"",phoneNumberS:v.phoneNumberS||"",idS:v.idS||"",dob:v.dob||"",addressS:v.addressS||""}))},placeholder:"Buscar remitente por nombre, cédula, teléfono...",label:"Remitente/Destinatario",description:"Busque y seleccione un remitente existente o ingrese los datos manualmente"})),S.$$input=v=>t.onShipperConsigneeChange({name:v.target.value}),b.$$input=v=>t.onShipperConsigneeChange({dob:v.target.value}),F.$$input=v=>t.onShipperConsigneeChange({idS:v.target.value}),E.$$input=v=>t.onShipperConsigneeChange({address:v.target.value}),w.$$input=v=>t.onShipperConsigneeChange({phoneNumberS:v.target.value}),ge(v=>{var j=e,z=r,T=i,R=n,J=l,X=s,H=l,se=s,O=l,_=s,k={...n,margin:"1rem 0"},$=l,G=s,ne={...n,margin:"1rem 0"},U=l,D=s;return v.e=p(c,j,v.e),v.t=p(d,z,v.t),v.a=p(u,T,v.a),v.o=p(h,R,v.o),v.i=p(m,J,v.i),v.n=p(S,X,v.n),v.s=p(x,H,v.s),v.h=p(b,se,v.h),v.r=p(te,O,v.r),v.d=p(F,_,v.d),v.l=p(V,k,v.l),v.u=p(I,$,v.u),v.c=p(E,G,v.c),v.w=p(L,ne,v.w),v.m=p(P,U,v.m),v.f=p(w,D,v.f),v},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0}),ge(()=>S.value=t.shipperConsignee.name),ge(()=>b.value=t.shipperConsignee.dob),ge(()=>F.value=t.shipperConsignee.idS),ge(()=>E.value=t.shipperConsignee.addressS),ge(()=>w.value=t.shipperConsignee.phoneNumberS),c})(),(()=>{var c=D9(),d=c.firstChild,u=d.nextSibling,h=u.nextSibling,g=h.firstChild,m=g.firstChild,S=m.nextSibling,N=g.nextSibling,x=N.firstChild,b=x.nextSibling,K=N.nextSibling,te=K.firstChild,F=te.nextSibling,V=h.nextSibling,W=V.firstChild,I=W.firstChild,E=I.nextSibling,L=W.nextSibling,M=L.firstChild,P=M.nextSibling,w=V.nextSibling,v=w.firstChild,j=v.firstChild,z=j.nextSibling,T=v.nextSibling,R=T.firstChild,J=R.nextSibling,X=w.nextSibling,H=X.firstChild,se=H.firstChild,O=se.nextSibling;return a(u,A(w9,{get value(){return t.customer},get onChange(){return t.onShipperConsigneeChange},placeholder:"Buscar cliente por nombre, teléfono, ID...",label:"Cliente",description:"Busque y seleccione un cliente existente o ingrese los datos manualmente"})),S.$$input=_=>{const k=_.target.value;t.onShipperConsigneeChange({firstName:k})},b.$$input=_=>{const k=_.target.value;t.onShipperConsigneeChange({middleName:k})},F.$$input=_=>{const k=_.target.value;t.onShipperConsigneeChange({lastName:k})},E.$$input=_=>{const k=_.target.value;t.onShipperConsigneeChange({cid:k})},P.$$input=_=>{const k=_.target.value;t.onShipperConsigneeChange({passport:k})},z.$$input=_=>{const k=_.target.value;t.onShipperConsigneeChange({phoneNumber:k})},J.$$input=_=>{const k=_.target.value;t.onShipperConsigneeChange({altPhoneNumber:k})},O.$$input=_=>{const k=_.target.value;t.onShipperConsigneeChange({address:k})},ge(_=>{var k=e,$=r,G=i,ne=n,U=l,D=s,B=l,Q=s,Z=l,oe=s,de=o,re=l,Y=s,ce=l,ue=s,ae=o,ye=l,me=s,pe=l,ve=s,Ne=i,Ie=l,Ce=s;return _.e=p(c,k,_.e),_.t=p(d,$,_.t),_.a=p(u,G,_.a),_.o=p(h,ne,_.o),_.i=p(m,U,_.i),_.n=p(S,D,_.n),_.s=p(x,B,_.s),_.h=p(b,Q,_.h),_.r=p(te,Z,_.r),_.d=p(F,oe,_.d),_.l=p(V,de,_.l),_.u=p(I,re,_.u),_.c=p(E,Y,_.c),_.w=p(M,ce,_.w),_.m=p(P,ue,_.m),_.f=p(w,ae,_.f),_.y=p(j,ye,_.y),_.g=p(z,me,_.g),_.p=p(R,pe,_.p),_.b=p(J,ve,_.b),_.T=p(X,Ne,_.T),_.A=p(se,Ie,_.A),_.O=p(O,Ce,_.O),_},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0}),ge(()=>S.value=t.shipperConsignee?.firstName||""),ge(()=>b.value=t.shipperConsignee?.middleName||""),ge(()=>F.value=t.shipperConsignee?.lastName||""),ge(()=>E.value=t.shipperConsignee?.cid||""),ge(()=>P.value=t.shipperConsignee?.passport||""),ge(()=>z.value=t.shipperConsignee?.phoneNumber||""),ge(()=>J.value=t.shipperConsignee?.altPhoneNumber||""),ge(()=>O.value=t.shipperConsignee?.address||""),c})()]};Wt(["input"]);var F9=le('<div><h3><span>📋</span><span>Información Básica de la Factura</span></h3><div><div><label>Número de Factura<span>*</span></label><input type=text placeholder="Ej: INV-2024-001"required><div>Número único de identificación para esta factura</div></div><div><label>Tienda/Sucursal</label><div>Ubicación donde se procesa la factura</div></div><div><label>Número de Guía</label><select required><option value>Seleccionar Número de Guía...</option><option value=2520>2520</option><option value=2521>2521</option><option value=2522>2522</option><option value=2523>2523</option><option value=2524>2524</option><option value=2525>2525</option></select><div>Número de seguimiento o guía de envío</div></div><div><label>Método de Envío<span>*</span></label><select required><option value>Seleccionar método...</option><option value=aereo>🛩️ Aéreo (AEREO)</option><option value=maritimo>🚢 Marítimo (SEA)</option></select><div>Método de transporte para el envío</div></div></div><div><div><label>Descripción</label><textarea placeholder="Descripción detallada de la factura, notas especiales, instrucciones de manejo, etc."></textarea><div>Información adicional sobre la factura o instrucciones especiales</div></div></div><div><div><input type=checkbox id=packages-order-checkbox><label for=packages-order-checkbox>📦 Orden de Paquetes</label></div><div>Marque si esta factura incluye una orden específica de paquetes</div></div><div><div><strong>Información importante:</strong><br>• El número de factura debe ser único<br>• El método de envío afecta los precios de transporte<br>• La descripción se incluirá en la factura impresa<br>• Los campos marcados con <span>*</span> son obligatorios');const O9=t=>{const e={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)",padding:"1.5rem","margin-bottom":"1.5rem"},r={"font-size":"1.25rem","font-weight":"bold",color:"var(--text-primary)","margin-bottom":"1rem","padding-bottom":"0.5rem","border-bottom":"2px solid var(--primary-color)",display:"flex","align-items":"center",gap:"0.5rem"},n={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem"},i={display:"grid","grid-template-columns":"1fr",gap:"1rem"},o={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"},s={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},l={display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},c={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.75rem 0"},d={width:"1rem",height:"1rem"},u={...s,cursor:"pointer"},h={color:"var(--error-color)","margin-left":"0.25rem"},g={"font-size":"0.75rem",color:"var(--text-muted)","margin-top":"0.25rem","font-style":"italic"};return(()=>{var m=F9(),S=m.firstChild,N=S.nextSibling,x=N.firstChild,b=x.firstChild,K=b.firstChild,te=K.nextSibling,F=b.nextSibling,V=F.nextSibling,W=x.nextSibling,I=W.firstChild,E=I.nextSibling,L=W.nextSibling,M=L.firstChild,P=M.nextSibling,w=P.nextSibling,v=L.nextSibling,j=v.firstChild,z=j.firstChild,T=z.nextSibling,R=j.nextSibling,J=R.nextSibling,X=N.nextSibling,H=X.firstChild,se=H.firstChild,O=se.nextSibling,_=O.nextSibling,k=X.nextSibling,$=k.firstChild,G=$.firstChild,ne=G.nextSibling,U=$.nextSibling,D=k.nextSibling,B=D.firstChild,Q=B.firstChild,Z=Q.nextSibling,oe=Z.nextSibling,de=oe.nextSibling,re=de.nextSibling,Y=re.nextSibling,ce=Y.nextSibling,ue=ce.nextSibling,ae=ue.nextSibling,ye=ae.nextSibling;return p(m,e),p(S,r),p(N,n),F.$$input=me=>t.onInvoiceChange(me.target.value),a(W,A(nu,{get value(){return t.store},get onChange(){return t.onStoreChange},placeholder:"Seleccionar tienda...",style:{width:"100%"}}),E),P.addEventListener("change",me=>t.onGuideChange(me.target.value)),R.addEventListener("change",me=>t.onShippingMethodChange(me.target.value)),p(X,i),O.$$input=me=>t.onDescriptionChange(me.target.value),p(k,o),p($,c),G.addEventListener("change",me=>t.onPackagesOrderChange(me.target.checked)),p(G,d),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("font-weight","500"),ne.style.setProperty("color","var(--text-secondary)"),ne.style.setProperty("cursor","pointer"),D.style.setProperty("margin-top","1rem"),D.style.setProperty("padding","1rem"),D.style.setProperty("background","var(--strip-color)"),D.style.setProperty("border-radius","var(--border-radius-sm)"),D.style.setProperty("border","1px solid var(--border-color)"),B.style.setProperty("font-size","0.875rem"),B.style.setProperty("color","var(--text-muted)"),B.style.setProperty("line-height","1.4"),ye.style.setProperty("color","var(--error-color)"),ge(me=>{var pe=l,ve=h,Ne=s,Ie=g,Ce=l,Ee=g,we=l,Re=u,He=g,je=l,Ve=h,qe=u,tt=g,rt=l,Be={...s,"min-height":"100px",resize:"vertical"},Ge=g,Fe={...g,"margin-top":"0",padding:"0.75rem 0","align-self":"center"};return me.e=p(b,pe,me.e),me.t=p(te,ve,me.t),me.a=p(F,Ne,me.a),me.o=p(V,Ie,me.o),me.i=p(I,Ce,me.i),me.n=p(E,Ee,me.n),me.s=p(M,we,me.s),me.h=p(P,Re,me.h),me.r=p(w,He,me.r),me.d=p(j,je,me.d),me.l=p(T,Ve,me.l),me.u=p(R,qe,me.u),me.c=p(J,tt,me.c),me.w=p(se,rt,me.w),me.m=p(O,Be,me.m),me.f=p(_,Ge,me.f),me.y=p(U,Fe,me.y),me},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0}),ge(()=>F.value=t.invoice),ge(()=>P.value=t.guide),ge(()=>R.value=t.shippingMethod),ge(()=>O.value=t.description),ge(()=>G.checked=t.packagesOrder),m})()};Wt(["input"]);var B9=le('<div><h3><span>💳</span><span>Métodos de Pago</span></h3><div><div>Total de la Factura</div><div>$</div></div><div><div><label>💵 Efectivo</label><button type=button title="Auto-completar balance">AUTO</button><div>Pago en efectivo</div></div><div><label>📱 Zelle</label><button type=button title="Auto-completar balance">AUTO</button><div>Transferencia Zelle</div></div><div><label>💳 Tarjeta de Crédito</label><button type=button title="Auto-completar balance">AUTO</button><div>Pago con tarjeta</div></div><div><label>📊 Impuesto (%)</label><input type=number min=0 max=100 step=0.1 placeholder=0.0><div>Porcentaje de impuesto aplicable</div></div></div><div><div><input type=checkbox id=tax-on-total-checkbox><label for=tax-on-total-checkbox>📊 Impuesto sobre el total de la factura</label></div><div><input type=checkbox id=exempt-cash-tax-checkbox><label for=exempt-cash-tax-checkbox>💵 Exento de impuesto en efectivo</label></div></div><div><div><span>Subtotal de Pagos:</span><span>$</span></div><div><span>Base Gravable: (Zelle, credit card)</span><span>$</span></div><div><span>Impuesto (<!>%):</span><span>$</span></div><div><span>Total con Impuesto:</span><span>$</span></div><div><span>Balance Pendiente:</span><span></span></div></div><div><div><strong>Desglose de Pagos:</strong><br>• Efectivo: $<br>• Zelle: $<br>• Tarjeta: $<br>• Use los botones "AUTO" para completar automáticamente el balance restante');const V9=t=>{const e=Nt(()=>{const b=t.paymentMethods?.cash+t.paymentMethods?.zelle+t.paymentMethods?.creditCard;console.log(b);let K=b;t.paymentMethods?.exemptTaxOnCash&&(K=t.invoiceTotal-t.paymentMethods?.cash);const te=t.paymentMethods.taxOnTotal?t.invoiceTotal*t.paymentMethods?.taxPercent/100:K*t.paymentMethods?.taxPercent/100,F=t.invoiceTotal+te,V=F-b;return{subtotal:b,taxableAmount:K,taxAmount:te,totalWithTax:F,balance:V,isFullyPaid:Math.round(V)<.01}}),r=b=>{const K=t.paymentMethods?.cash+t.paymentMethods?.zelle+t.paymentMethods?.creditCard,te=t.invoiceTotal-K;te>0&&t.onPaymentMethodsChange({[b]:t.paymentMethods[b]+te})},n={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)",padding:"1.5rem","margin-bottom":"1.5rem"},i={"font-size":"1.25rem","font-weight":"bold",color:"var(--text-primary)","margin-bottom":"1rem","padding-bottom":"0.5rem","border-bottom":"2px solid var(--primary-color)",display:"flex","align-items":"center",gap:"0.5rem"},o={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},s={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"},l={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},c={display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},d={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 0"},u={width:"1rem",height:"1rem"},h=b=>({"margin-top":"1.5rem",padding:"1rem",background:b===0?"var(--success-background)":b<-.01?"var(--warning-background)":"var(--error-background)",border:`1px solid ${b===0?"var(--success-color)":b<-.01?"var(--warning-color)":"var(--error-color)"}`,"border-radius":"var(--border-radius-sm)"}),g={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"0.5rem","font-size":"0.875rem"},m={...g,"font-weight":"bold","font-size":"1rem","padding-top":"0.5rem","border-top":"1px solid var(--border-color)"},S={position:"relative"},N={position:"absolute",right:"8px",top:"28px",background:"var(--primary-color)",color:"white",border:"none","border-radius":"4px",padding:"4px 8px",cursor:"pointer","font-size":"0.75rem","z-index":"10",opacity:"0.8",transition:"opacity 0.2s ease"},x={"font-size":"0.75rem",color:"var(--text-muted)","margin-top":"0.25rem","font-style":"italic"};return(()=>{var b=B9(),K=b.firstChild,te=K.nextSibling,F=te.firstChild,V=F.nextSibling;V.firstChild;var W=te.nextSibling,I=W.firstChild,E=I.firstChild,L=E.nextSibling,M=L.nextSibling,P=I.nextSibling,w=P.firstChild,v=w.nextSibling,j=v.nextSibling,z=P.nextSibling,T=z.firstChild,R=T.nextSibling,J=R.nextSibling,X=z.nextSibling,H=X.firstChild,se=H.nextSibling,O=se.nextSibling,_=W.nextSibling,k=_.firstChild,$=k.firstChild,G=$.nextSibling,ne=k.nextSibling,U=ne.firstChild,D=U.nextSibling,B=_.nextSibling,Q=B.firstChild,Z=Q.firstChild,oe=Z.nextSibling;oe.firstChild;var de=Q.nextSibling,re=de.firstChild,Y=re.nextSibling;Y.firstChild;var ce=de.nextSibling,ue=ce.firstChild,ae=ue.firstChild,ye=ae.nextSibling;ye.nextSibling;var me=ue.nextSibling;me.firstChild;var pe=ce.nextSibling,ve=pe.firstChild,Ne=ve.nextSibling;Ne.firstChild;var Ie=pe.nextSibling,Ce=Ie.firstChild,Ee=Ce.nextSibling,we=B.nextSibling,Re=we.firstChild,He=Re.firstChild,je=He.nextSibling,Ve=je.nextSibling,qe=Ve.nextSibling,tt=qe.nextSibling,rt=tt.nextSibling,Be=rt.nextSibling,Ge=Be.nextSibling;return p(b,n),p(K,i),te.style.setProperty("padding","1rem"),te.style.setProperty("background","var(--primary-color)"),te.style.setProperty("color","white"),te.style.setProperty("border-radius","var(--border-radius-sm)"),te.style.setProperty("margin-bottom","1rem"),te.style.setProperty("text-align","center"),F.style.setProperty("font-size","0.875rem"),F.style.setProperty("opacity","0.9"),V.style.setProperty("font-size","1.5rem"),V.style.setProperty("font-weight","bold"),a(V,()=>t.invoiceTotal.toFixed(),null),p(W,o),a(I,A(Lt,{type:"number",get style(){return{...l,"padding-right":"50px"}},get value(){return t.paymentMethods.cash.toString()},min:"0",step:"0.01",onChange:Fe=>t.onPaymentMethodsChange({cash:parseFloat(Fe)||0}),placeholder:"0.00"}),L),L.$$click=()=>r("cash"),a(P,A(Lt,{type:"number",get style(){return{...l,"padding-right":"50px"}},get value(){return t.paymentMethods.zelle.toString()},min:"0",step:"0.01",onChange:Fe=>t.onPaymentMethodsChange({zelle:parseFloat(Fe)||0}),placeholder:"0.00"}),v),v.$$click=()=>r("zelle"),a(z,A(Lt,{type:"number",get style(){return{...l,"padding-right":"50px"}},get value(){return t.paymentMethods.creditCard.toString()},min:"0",step:"0.01",onChange:Fe=>t.onPaymentMethodsChange({creditCard:parseFloat(Fe)||0}),placeholder:"0.00"}),R),R.$$click=()=>r("creditCard"),se.$$input=Fe=>t.onPaymentMethodsChange({taxPercent:Number(Fe.target.value)||0}),p(_,s),$.addEventListener("change",Fe=>t.onPaymentMethodsChange({taxOnTotal:Fe.target.checked})),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("font-weight","500"),G.style.setProperty("color","var(--text-secondary)"),G.style.setProperty("cursor","pointer"),U.addEventListener("change",Fe=>t.onPaymentMethodsChange({exemptTaxOnCash:Fe.target.checked})),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("font-weight","500"),D.style.setProperty("color","var(--text-secondary)"),D.style.setProperty("cursor","pointer"),a(oe,()=>e().subtotal.toFixed(1),null),a(Y,()=>e().taxableAmount.toFixed(1),null),a(ue,()=>t.paymentMethods.taxPercent,ye),a(me,()=>e().taxAmount.toFixed(1),null),a(Ne,()=>e().totalWithTax.toFixed(1),null),a(Ee,A(Me,{get when(){return Math.round(e().balance)<-.01},get children(){return["$",ke(()=>e().balance.toFixed())," "," (SOBREPAGO)"]}}),null),a(Ee,A(Me,{get when(){return Math.round(e().balance)===0},children:" (PAGADO)"}),null),a(Ee,A(Me,{get when(){return Math.round(e().balance)>.01},get children(){return["$",ke(()=>e().balance.toFixed())," "," (PENDIENTE)"]}}),null),we.style.setProperty("margin-top","1rem"),we.style.setProperty("padding","1rem"),we.style.setProperty("background","var(--strip-color)"),we.style.setProperty("border-radius","var(--border-radius-sm)"),we.style.setProperty("border","1px solid var(--border-color)"),Re.style.setProperty("font-size","0.875rem"),Re.style.setProperty("color","var(--text-muted)"),Re.style.setProperty("line-height","1.4"),a(Re,()=>t.paymentMethods?.cash?.toFixed(2),qe),a(Re,()=>t.paymentMethods?.zelle?.toFixed(2),rt),a(Re,()=>t.paymentMethods?.creditCard?.toFixed(2),Ge),ge(Fe=>{var at=S,lt=c,Xe=N,Ct=x,Le=S,nt=c,We=N,kt=x,Et=S,Ot=c,jt=N,mt=x,Zt=c,rr=l,Dt=x,Kt=d,dt=u,pt=d,ze=u,bt=h(Math.round(e().balance)),Mt=g,ft=g,At=g,Ht=g,Yt=m,nr=Math.round(e().balance)===0?"var(--success-color)":Math.round(e().balance)<.01?"var(--warning-color)":"var(--error-color)";return Fe.e=p(I,at,Fe.e),Fe.t=p(E,lt,Fe.t),Fe.a=p(L,Xe,Fe.a),Fe.o=p(M,Ct,Fe.o),Fe.i=p(P,Le,Fe.i),Fe.n=p(w,nt,Fe.n),Fe.s=p(v,We,Fe.s),Fe.h=p(j,kt,Fe.h),Fe.r=p(z,Et,Fe.r),Fe.d=p(T,Ot,Fe.d),Fe.l=p(R,jt,Fe.l),Fe.u=p(J,mt,Fe.u),Fe.c=p(H,Zt,Fe.c),Fe.w=p(se,rr,Fe.w),Fe.m=p(O,Dt,Fe.m),Fe.f=p(k,Kt,Fe.f),Fe.y=p($,dt,Fe.y),Fe.g=p(ne,pt,Fe.g),Fe.p=p(U,ze,Fe.p),Fe.b=p(B,bt,Fe.b),Fe.T=p(Q,Mt,Fe.T),Fe.A=p(de,ft,Fe.A),Fe.O=p(ce,At,Fe.O),Fe.I=p(pe,Ht,Fe.I),Fe.S=p(Ie,Yt,Fe.S),nr!==Fe.W&&((Fe.W=nr)!=null?Ee.style.setProperty("color",nr):Ee.style.removeProperty("color")),Fe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0}),ge(()=>se.value=t.paymentMethods.taxPercent),ge(()=>$.checked=t.paymentMethods.taxOnTotal),ge(()=>U.checked=t.paymentMethods.exemptTaxOnCash||!1),b})()};Wt(["click","input"]);var j9=le("<button type=button>"),z9=le("<div><div><h1>Nueva Factura</h1><p>Sistema de facturación con gestión de bultos</p></div><div><h3>Resumen de la Factura</h3><div><span> 📦 Total de Productos:</span><span>$</span></div><div><span>📋 Total de Reservas:</span><span>$</span></div><div><span>🔧 Total de Servicios:</span><span>$</span></div><div><span>🚚 Costo de Transporte:</span><span>$</span></div><div><span>Total General:</span><span>$</span></div></div><div><button type=button>Limpiar Form</button><button type=button>Guardar Borrador"),q9=le("<div><h3>¡Factura Creada Exitosamente!</h3><p>La factura ha sido guardada correctamente en el sistema."),U9=le("<div><strong>Error:</strong> "),H9=le("<details><summary>Debug Info (Development Only)</summary><pre>");const G9=()=>{const[t,e]=Se(null),[r,n]=Se(!1),[i,o]=Se(""),[s,l]=Se(!1),c=Er.formData,d=Nt(()=>{const D=c(),B=D.products.reduce((pe,ve)=>pe+ve.qty*ve.salePrice,0),Q=D.reservas.reduce((pe,ve)=>pe+(ve.qty*ve.price+ve.arancel),0),Z=D.services.reduce((pe,ve)=>pe+ve.qty*ve.arancel,0),oe=D.bulks.reduce((pe,ve)=>pe+(ve?.transportCost||20),0),de=Math.round(B)+Math.round(Q)+Math.round(Z)+Math.round(oe),re=D.paymentMethods.cash+D.paymentMethods.zelle+D.paymentMethods.creditCard;let Y=re;D.paymentMethods.exemptTaxOnCash&&(Y=de-D.paymentMethods.cash);const ce=D.paymentMethods.taxOnTotal?de*D.paymentMethods.taxPercent/100:Y*D.paymentMethods.taxPercent/100,ue=de+ce,ae=ue-re,ye=de*D.paymentMethods.taxPercent/100-ce;return{itemsTotal:de,transportTotal:oe,grandTotal:de,productsTotal:B,reservasTotal:Q,servicesTotal:Z,balance:ae,totalWithTax:ue,taxAmount:ce,saveOnExemptTaxOnCash:ye}});Un(()=>{if(!c().invoice){const D=`${mv(7)}-${mv(8)}`;Er.updateForm({invoice:D})}}),Un(()=>{const D=c();D.reservas.forEach((B,Q)=>{let Z={};if(B.autoCalculate!==!1&&B.type){const Y=ff(B.type,B.bulkId||"",D.reservas,B.qty),ce=gf(B.category||su(B.type),B.qty);Math.abs(B.price-Y)>.001&&(Z.price=Y),Math.abs(B.arancel-ce)>.001&&(Z.arancel=ce)}const oe=Z.price!==void 0?Z.price:B.price,de=Z.arancel!==void 0?Z.arancel:B.arancel,re=(oe+de)*B.qty;Math.abs(B.total-re)>.001&&(Z.total=re),Object.keys(Z).length>0&&Er.updateReserva(Q,Z)})});const u=async()=>{if(!Er.isValid()){o("Por favor complete todos los campos requeridos");return}n(!0),o(""),l(!1);try{let D=d();if(!c().invoice.trim())throw new Error("Numero de factura es requerido");if(!c().shipper_consignee.name.trim())throw new Error("Nombre del cliente es requerido");if(c().products.length===0&&c().reservas.length===0&&c().services.length===0)throw new Error("Al menos un producto, reserva o servicio es requerido");D.grandTotal>.01;const B={...c(),type:"SALES",ssg_inventory_key:`INVOICE-${Date.now()}`,ssg_sorder_key:`SO-${Date.now()}`,createDate:c().createDate||Date.now(),businessId:"YB100423253156428",isCompleted:!0,productSubtotal:D.productsTotal,reservaSubtotal:D.reservasTotal,serviceSubtotal:D.servicesTotal,subtotalBeforeTax:D.itemsTotal,transportTotal:D.transportTotal,taxAmount:D.taxAmount,taxSavings:D.saveOnExemptTaxOnCash,total:D.totalWithTax,shippingMethod:c().shippingMethod,taxCalculationMethod:c()?.paymentMethods.taxOnTotal?"total":"subtotal",cashPaymentRatio:D.balance>0?c().paymentMethods.cash/D.balance:0,paymentMethods:c().paymentMethods};console.log("createInvoice",JSON.stringify(B,null,4));const Q=await ai.addInventory(B);ai.addInvoice(Q),Er.clearForm(),e(null),l(!0)}catch(D){console.error("Error submitting invoice:",D),o("Error al guardar la factura. Por favor intente nuevamente.")}finally{n(!1)}},h=()=>{Er.hasData()&&confirm("¿Está seguro que desea limpiar el formulario? Se perderán todos los datos no guardados.")&&(Er.clearForm(),e(null),o(""),l(!1))},g=D=>{Er.addBulk(D)},m=(D,B)=>{Er.updateBulk(D,B),Er.updateBulk(D,{token:ki()})},S=D=>{const B=c().bulks[D];if(B&&confirm(`¿Está seguro que desea eliminar el bulto "${B.name}"? Esto también eliminará todos los items asignados al bulto.`)){const Z=c().reservas.filter(re=>re.bulkId!==B.id),oe=c().products.filter(re=>re.bulkId!==B.id),de=c().services.filter(re=>re.bulkId!==B.id);Er.updateForm({reservas:Z,products:oe,services:de}),Er.removeBulk(D)}},N=D=>{Er.addReserva(D)},x=(D,B)=>{Er.updateReserva(D,B)},b=D=>{Er.removeReserva(D)},K=D=>{Er.addProduct(D)},te=(D,B)=>{Er.updateProduct(D,B)},F=D=>{Er.removeProduct(D)},V=D=>{Er.addService(D)},W=(D,B)=>{Er.updateService(D,B)},I=D=>{Er.removeService(D)},E=D=>{Er.updateShipperConsignee(D)},L=D=>{Er.updatePaymentMethods(D)},M=D=>{Er.updateForm({invoice:D})},P=D=>{Er.updateForm({description:D})},w=D=>{Er.updateForm({store:D})},v=D=>{Er.updateForm({guide:D})},j=D=>{Er.updateForm({packagesOrder:D})},z=D=>{Er.updateForm({shippingMethod:D})},T={"max-width":"1200px",margin:"0 auto",padding:"2rem","font-family":"system-ui, sans-serif"},R={"text-align":"center","margin-bottom":"2rem",padding:"1rem",background:"var(--primary-color)",color:"white","border-radius":"var(--border-radius)",position:"relative"},J={"font-size":"2rem","font-weight":"bold","margin-bottom":"0.5rem"},X={"font-size":"1rem",opacity:"0.9",color:"white"};Er.isDirty;const H={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)",padding:"1.5rem","margin-bottom":"2rem","text-align":"center"},se={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"0.5rem","font-size":"1rem"},O={...se,"font-size":"1.25rem","font-weight":"bold","padding-top":"0.5rem","border-top":"2px solid var(--primary-color)",color:"var(--primary-color)"},_={display:"flex",gap:"1rem","justify-content":"center","margin-top":"2rem","flex-wrap":"wrap"},k={padding:"0.75rem 1.5rem","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-weight":"500",cursor:"pointer",border:"none",transition:"all 0.2s ease","min-width":"120px"},$={...k,background:"var(--primary-color)",color:"white"},G={...k,background:"var(--border-color)",color:"var(--text-primary)"},ne={background:"var(--error-background)",color:"var(--error-color)",padding:"1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1rem",border:"1px solid var(--error-color)"},U={background:"var(--success-background)",color:"var(--success-color)",padding:"1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1rem",border:"1px solid var(--success-color)","text-align":"center"};return(()=>{var D=z9(),B=D.firstChild,Q=B.firstChild,Z=Q.firstChild,oe=Q.nextSibling,de=B.nextSibling,re=de.firstChild,Y=re.firstChild,ce=re.nextSibling,ue=ce.firstChild,ae=ue.nextSibling;ae.firstChild;var ye=ce.nextSibling,me=ye.firstChild,pe=me.nextSibling;pe.firstChild;var ve=ye.nextSibling,Ne=ve.firstChild,Ie=Ne.nextSibling;Ie.firstChild;var Ce=ve.nextSibling,Ee=Ce.firstChild,we=Ee.nextSibling;we.firstChild;var Re=Ce.nextSibling,He=Re.firstChild,je=He.firstChild,Ve=He.nextSibling;Ve.firstChild;var qe=de.nextSibling,tt=qe.firstChild,rt=tt.firstChild,Be=tt.nextSibling,Ge=Be.firstChild;return p(D,T),p(Q,J),a(Q,A(Yr,{name:"invoice",size:"1.2em",style:{"margin-right":"0.5rem"}}),Z),p(oe,X),a(D,(()=>{var Fe=ke(()=>!!s());return()=>Fe()&&(()=>{var at=q9(),lt=at.firstChild,Xe=lt.firstChild,Ct=lt.nextSibling;return lt.style.setProperty("margin","0 0 0.5rem 0"),a(lt,A(Yr,{name:"success",size:"1.2em",style:{"margin-right":"0.5rem"}}),Xe),Ct.style.setProperty("margin","0"),ge(Le=>p(at,U,Le)),at})()})(),de),a(D,(()=>{var Fe=ke(()=>!!i());return()=>Fe()&&(()=>{var at=U9(),lt=at.firstChild,Xe=lt.firstChild;return lt.nextSibling,p(at,ne),a(lt,A(Yr,{name:"error",size:"1em",style:{"margin-right":"0.3rem"}}),Xe),a(at,i,null),at})()})(),de),a(D,A(O9,{get invoice(){return c().invoice},get description(){return c().description},get store(){return c().store},get guide(){return c().guide||""},get packagesOrder(){return c().packagesOrder},get shippingMethod(){return c().shippingMethod},onInvoiceChange:M,onDescriptionChange:P,onStoreChange:w,onGuideChange:v,onPackagesOrderChange:j,onShippingMethodChange:z}),de),a(D,A(M9,{get customer(){return t()},get shipperConsignee(){return c().shipper_consignee},onShipperConsigneeChange:E}),de),a(D,A(p9,{get bulks(){return c().bulks},get products(){return c().products},get reservas(){return c().reservas},get services(){return c().services},get shippingMethod(){return c().shippingMethod},onAddBulk:g,onUpdateBulk:m,onRemoveBulk:S,onAddReserva:N,onUpdateReserva:x,onRemoveReserva:b,onAddProduct:K,onUpdateProduct:te,onRemoveProduct:F,onAddService:V,onUpdateService:W,onRemoveService:I}),de),re.style.setProperty("margin","0 0 1rem 0"),re.style.setProperty("color","var(--text-primary)"),a(re,A(Yr,{name:"accounts",size:"1em",style:{"margin-right":"0.5rem"}}),Y),a(ae,()=>d().productsTotal.toFixed(1),null),a(pe,()=>d().reservasTotal.toFixed(1),null),a(Ie,()=>d().servicesTotal.toFixed(1),null),a(we,()=>d().transportTotal.toFixed(1),null),a(He,A(Yr,{name:"finance",size:"1em",style:{"margin-right":"0.3rem"}}),je),a(Ve,()=>d().grandTotal.toFixed(1),null),a(D,A(V9,{get paymentMethods(){return c().paymentMethods},onPaymentMethodsChange:L,get invoiceTotal(){return d().grandTotal}}),qe),tt.$$click=h,a(tt,A(Yr,{name:"delete",size:"1em",style:{"margin-right":"0.5rem"}}),rt),Be.$$click=()=>Er.forceSave(),a(Be,A(Yr,{name:"save",size:"1em",style:{"margin-right":"0.5rem"}}),Ge),a(qe,A(Me,{get when(){return Er.isValid()},get children(){var Fe=j9();return Fe.$$click=u,a(Fe,(()=>{var at=ke(()=>!!r());return()=>at()?[A(Yr,{name:"loading",size:"1em",style:{"margin-right":"0.5rem"}}),"Procesando..."]:[A(Yr,{name:"check",size:"1em",style:{"margin-right":"0.5rem"}}),"Crear Factura"]})()),ge(at=>{var lt=$,Xe=r()||!Er.isValid();return at.e=p(Fe,lt,at.e),Xe!==at.t&&(Fe.disabled=at.t=Xe),at},{e:void 0,t:void 0}),Fe}}),null),a(D,(()=>{var Fe=ke(()=>!1);return()=>Fe()&&(()=>{var at=H9(),lt=at.firstChild,Xe=lt.firstChild,Ct=lt.nextSibling;return at.style.setProperty("margin-top","2rem"),at.style.setProperty("font-size","0.875rem"),a(lt,A(Yr,{name:"search",size:"0.9em",style:{"margin-right":"0.3rem"}}),Xe),Ct.style.setProperty("background","#f5f5f5"),Ct.style.setProperty("padding","1rem"),Ct.style.setProperty("border-radius","4px"),Ct.style.setProperty("overflow","auto"),Ct.style.setProperty("max-height","300px"),a(Ct,()=>JSON.stringify({formValid:Er.isValid(),hasData:Er.hasData(),isDirty:Er.isDirty,bulksCount:c().bulks.length,itemsCount:{products:c().products.length,reservas:c().reservas.length,services:c().services.length},totals:d()},null,2)),at})()})(),null),ge(Fe=>{var at=R,lt=H,Xe=se,Ct=se,Le=se,nt=se,We=O,kt=_,Et=G,Ot=r(),jt=$,mt=r();return Fe.e=p(B,at,Fe.e),Fe.t=p(de,lt,Fe.t),Fe.a=p(ce,Xe,Fe.a),Fe.o=p(ye,Ct,Fe.o),Fe.i=p(ve,Le,Fe.i),Fe.n=p(Ce,nt,Fe.n),Fe.s=p(Re,We,Fe.s),Fe.h=p(qe,kt,Fe.h),Fe.r=p(tt,Et,Fe.r),Ot!==Fe.d&&(tt.disabled=Fe.d=Ot),Fe.l=p(Be,jt,Fe.l),mt!==Fe.u&&(Be.disabled=Fe.u=mt),Fe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0}),D})()};Wt(["click"]);var W9=le("<div><div><label></label><select><option value=all></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label><select><option value=all></option><option value=cash></option><option value=zelle></option><option value=other></option></select></div><div><label></label><select><option value=all></option><option value=SEA></option><option value=AEREO>"),Y9=le("<div><div><strong>:</strong> </div><div><strong>:</strong> <!> <!> </div><div><strong>:</strong> </div><div><strong>:</strong> "),K9=le("<div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),Q9=le("<div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),ub=le("<div>"),hb=le("<div><table><thead><tr><th></th><th></th><th></th><th></th></tr></thead><tbody>"),J9=le("<div><table><thead><tr><th>Tipo de Bulto</th><th>Cantidad</th><th>Items Totales</th><th>Valor Total</th><th>Valor Promedio</th></tr></thead><tbody><tr><td><strong>Total de Bultos:</strong></td><td></td><td></td><td></td><td>-"),X9=le("<div><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td colspan=4><strong>:</strong></td><td>"),Z9=le("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),eM=le("<div><div>"),tM=le("<div><div><div><h3></h3><button>×</button></div><div><div>: <strong></strong></div><div>: <strong></strong></div><div>: <strong></strong></div></div><div><div>:</div><div></div></div><div>"),rM=le("<div><div class=print-only><h1></h1><div></div><div>: </div></div><div class=no-print><h1></h1><div>"),nM=le("<option>"),iM=le("<tr><td></td><td></td><td></td><td>"),oM=le("<tr><td></td><td></td><td><div></div></td><td>"),sM=le("<div><span> → <!> lbs</span><button>📋 <!> invoice"),aM=le("<tr><td><div><span></span></div></td><td></td><td></td><td></td><td>"),lM=le("<tr><td><div></div></td><td>");const cM=t=>{const{t:e}=Wc(),[r,n]=Se(!1),[i,o]=Se(""),[s,l]=Se(""),[c,d]=Se("all"),[u,h]=Se("all"),[g,m]=Se("all"),[S,N]=Se("all"),[x,b]=Se(null),[K,te]=Se([]),[F,V]=Se(!1),[W,I]=Se(null);Ln(async()=>{await L()});const E=()=>gt.getActiveLocations(),L=async()=>{n(!0);try{let z=c()!=="all"?c():void 0;const T={store:z,dateFrom:i()||void 0,dateTo:s()||void 0};z&&(await qi.fetchInvoices(T),M())}catch(z){console.error("Error loading report data:",z)}finally{n(!1)}},M=()=>{let z=qi.getFilteredInvoices({store:c(),dateFrom:i(),dateTo:s()});S()!=="all"&&(z=z.filter(U=>U.shippingType===S()||!U.shippingType&&S()==="SEA")),te(z);let T=0,R=0,J=0,X=new Map,H=new Map,se=new Map,O=0,_=0,k=0;z.forEach(U=>{const D=_M(U),B=parseFloat(D.total);U.paymentMethods?(U?.paymentMethods?.cash&&(T+=U?.paymentMethods?.cash),U?.paymentMethods?.zelle&&(R+=U?.paymentMethods?.zelle),k+=U?.taxAmount):U.hasTax&&U?.TaxPercent?(R+=B,k+=U?.TaxPercent/100*B):T+=B,U.products?.forEach(Q=>{const Z=Q.product.label,oe=Math.abs(Q.qty),de=parseFloat(S_(Q));let re=Z;if(Q?.bulkId&&U?.bulks){const Y=U?.bulks.find(ce=>ce?.id===Q?.bulkId);Y&&(re=`${Z} (${Y?.name})`)}if(X.has(re)){const Y=X.get(re);X.set(re,{qty:Y.qty+oe,total:Y.total+de})}else X.set(re,{qty:oe,total:de})}),U.reservas?.forEach(Q=>{const Z=Q.type,oe=parseFloat(Q.qty)||0,de=parseFloat(Q.price)||0,re=parseFloat(Q.arancel)||0,Y=de*oe;let ce=Z,ue=Z;if(Q?.bulkId&&U?.bulks){const ye=U?.bulks.find(me=>me?.id===Q?.bulkId);ye&&(ce=`${Z}`,ue=ye?.name)}const ae=ce;if(H.has(ae)){const ye=H.get(ae);H.set(ae,{qty:parseFloat((ye.qty+oe).toFixed(2)),price:ye.price,total:parseFloat((ye.total+Y).toFixed(2)),priceGroups:ye.priceGroups});const me=ye.priceGroups.get(de)||{qty:0,invoices:[]};me.qty+=oe;let pe=`${Z}-${ue}`;me.invoices.includes(pe)||me.invoices.push(pe),ye.priceGroups.set(de,me)}else{const ye=new Map;ye.set(de,{qty:oe,invoices:[U.invoice]}),H.set(ae,{qty:oe,price:de,arancel:re,total:Y,priceGroups:ye})}_+=re}),U.services?.forEach(Q=>{const Z=Q.type,oe=parseFloat(Q.qty)||0,de=parseFloat(Q.arancel)||0,re=oe*de;let Y=Z;if(Q.bulkId&&U.bulks){const ce=U.bulks.find(ue=>ue?.id===Q?.bulkId);ce&&(Y=`${Z} (${ce?.name})`)}if(se.has(Y)){const ce=se.get(Y);se.set(Y,{qty:ce.qty+oe,arancel:ce.arancel+de,total:ce.total+re})}else se.set(Y,{qty:oe,arancel:de,total:re})})});let $=new Map;z.forEach(U=>{U.bulks&&U.bulks.length>0&&U.bulks.forEach(D=>{const B=U.products?.filter(Y=>Y.bulkId===D?.id)||[],Q=U.reservas?.filter(Y=>Y.bulkId===D?.id)||[],Z=U.services?.filter(Y=>Y.bulkId===D?.id)||[],oe=[...B.map(Y=>Math.abs(Y.qty)*parseFloat(Y.salePrice||0)),...Q.map(Y=>parseFloat(Y.qty||0)*parseFloat(Y.price||0)),...Z.map(Y=>parseFloat(Y.qty||0)*parseFloat(Y.arancel||0))].reduce((Y,ce)=>Y+ce,0);O+=D?.transportCost||20;const de=B.length+Q.length+Z.length,re=`${D?.type} - ${D?.shippingMethod?.toLowerCase()==="aereo"?"Aéreo":"Marítimo"}`;if($.has(re)){const Y=$.get(re);$.set(re,{count:Y.count+1,totalValue:Y.totalValue+oe,avgValue:(Y.totalValue+oe)/(Y.count+1),items:Y.items+de,shippingMethod:D?.shippingMethod})}else $.set(re,{count:1,totalValue:oe,avgValue:oe,items:de,shippingMethod:D?.shippingMethod})})});const G=T+R+J,ne={dateRange:{from:i(),to:s()},store:c(),shippingType:S(),totalInvoices:z.length,paymentMethods:{cash:T,zelle:R,other:J,total:T+R+J},productsByType:X,reservasByTypeAndPrice:H,otherServicesByType:se,bulkStatistics:$,transportTotal:O,arancelesTotal:_,taxTotal:k,grandTotal:G+k};b(ne)},P=z=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(z),w=()=>{v(),setTimeout(()=>{},100)},v=async()=>{try{const z=j();if(z){V(!0);const{generateInvoiceResumePDF:T}=await no(async()=>{const{generateInvoiceResumePDF:J}=await import("./invoiceResumePdfGenerator-DTushZGQ.js");return{generateInvoiceResumePDF:J}},[]),R=`invoice-resume-report-${new Date().toISOString().split("T")[0]}.pdf`;await T(z,e,R),console.log(`PDF generated successfully: ${R}`)}}catch(z){console.error("Error generating PDF:",z),alert(e("invoiceReport.pdfGenerationFailed")),w()}finally{V(!1)}},j=Nt(()=>x());return(()=>{var z=rM(),T=z.firstChild,R=T.firstChild,J=R.nextSibling,X=J.nextSibling,H=X.firstChild,se=T.nextSibling,O=se.firstChild,_=O.nextSibling;return z.style.setProperty("padding","2rem"),z.style.setProperty("max-width","1200px"),z.style.setProperty("margin","0 auto"),T.style.setProperty("text-align","center"),T.style.setProperty("margin-bottom","2rem"),T.style.setProperty("border-bottom","2px solid #333"),T.style.setProperty("padding-bottom","1rem"),a(R,()=>e("invoiceReport.title")),J.style.setProperty("font-size","12pt"),J.style.setProperty("margin-top","0.5rem"),J.style.setProperty("color","#666"),a(J,A(Me,{get when(){return ke(()=>!!j()?.dateRange?.from)()&&j()?.dateRange?.to},get children(){return[ke(()=>e("invoiceReport.reportPeriod")),": ",ke(()=>j()?.dateRange?.from)," to ",ke(()=>j()?.dateRange?.to)]}}),null),a(J,A(Me,{get when(){return!j()?.dateRange?.from||!j()?.dateRange?.to},get children(){return e("invoiceReport.allTimeReport")}}),null),X.style.setProperty("font-size","10pt"),X.style.setProperty("margin-top","0.5rem"),a(X,()=>e("invoiceReport.generatedOn"),H),a(X,()=>new Date().toLocaleDateString(),null),se.style.setProperty("display","flex"),se.style.setProperty("justify-content","space-between"),se.style.setProperty("align-items","center"),se.style.setProperty("margin-bottom","2rem"),O.style.setProperty("font-size","1.75rem"),O.style.setProperty("font-weight","bold"),a(O,()=>e("invoiceReport.title")),_.style.setProperty("display","flex"),_.style.setProperty("gap","1rem"),a(_,A(ct,{variant:"outline",onClick:w,get children(){return e("invoiceReport.print")}}),null),a(_,A(ct,{variant:"outline",onClick:v,get disabled(){return F()},get children(){return ke(()=>!!F())()?e("invoiceReport.generating"):e("invoiceReport.exportPdf")}}),null),a(_,A(Me,{get when(){return t.onClose},get children(){return A(ct,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("invoiceReport.close")}})}}),null),a(z,A(Rt,{get title(){return e("invoiceReport.filters")},style:{"margin-bottom":"2rem"},class:"no-print",get children(){var k=W9(),$=k.firstChild,G=$.firstChild,ne=G.nextSibling,U=ne.firstChild,D=$.nextSibling,B=D.firstChild,Q=B.nextSibling,Z=D.nextSibling,oe=Z.firstChild,de=oe.nextSibling,re=Z.nextSibling,Y=re.firstChild,ce=Y.nextSibling,ue=ce.firstChild,ae=ue.nextSibling,ye=ae.nextSibling,me=ye.nextSibling,pe=re.nextSibling,ve=pe.firstChild,Ne=ve.nextSibling,Ie=Ne.firstChild,Ce=Ie.nextSibling,Ee=Ce.nextSibling;return k.style.setProperty("display","grid"),k.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),k.style.setProperty("gap","1rem"),k.style.setProperty("align-items","end"),G.style.setProperty("display","block"),G.style.setProperty("margin-bottom","0.5rem"),G.style.setProperty("font-weight","500"),a(G,()=>e("invoiceReport.storeLocation")),ne.addEventListener("change",we=>d(we.currentTarget.value)),ne.style.setProperty("width","100%"),ne.style.setProperty("padding","0.75rem"),ne.style.setProperty("border","1px solid var(--border-color)"),ne.style.setProperty("border-radius","var(--border-radius-sm)"),a(U,()=>e("invoiceReport.allStores")),a(ne,A(vt,{get each(){return E()},children:we=>(()=>{var Re=nM();return a(Re,()=>we.name),ge(()=>Re.value=we.id),Re})()}),null),B.style.setProperty("display","block"),B.style.setProperty("margin-bottom","0.5rem"),B.style.setProperty("font-weight","500"),a(B,()=>e("invoiceReport.fromDate")),Q.addEventListener("change",we=>o(we.currentTarget.value)),Q.style.setProperty("width","100%"),Q.style.setProperty("padding","0.75rem"),Q.style.setProperty("border","1px solid var(--border-color)"),Q.style.setProperty("border-radius","var(--border-radius-sm)"),oe.style.setProperty("display","block"),oe.style.setProperty("margin-bottom","0.5rem"),oe.style.setProperty("font-weight","500"),a(oe,()=>e("invoiceReport.toDate")),de.addEventListener("change",we=>l(we.currentTarget.value)),de.style.setProperty("width","100%"),de.style.setProperty("padding","0.75rem"),de.style.setProperty("border","1px solid var(--border-color)"),de.style.setProperty("border-radius","var(--border-radius-sm)"),Y.style.setProperty("display","block"),Y.style.setProperty("margin-bottom","0.5rem"),Y.style.setProperty("font-weight","500"),a(Y,()=>e("invoiceReport.paymentMethod")),ce.addEventListener("change",we=>m(we.currentTarget.value)),ce.style.setProperty("width","100%"),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("border","1px solid var(--border-color)"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),a(ue,()=>e("invoiceReport.allMethodsOption")),a(ae,()=>e("invoiceReport.cashOption")),a(ye,()=>e("invoiceReport.zelleOption")),a(me,()=>e("invoiceReport.otherOption")),ve.style.setProperty("display","block"),ve.style.setProperty("margin-bottom","0.5rem"),ve.style.setProperty("font-weight","500"),a(ve,()=>e("invoiceReport.shippingType")),Ne.addEventListener("change",we=>N(we.currentTarget.value)),Ne.style.setProperty("width","100%"),Ne.style.setProperty("padding","0.75rem"),Ne.style.setProperty("border","1px solid var(--border-color)"),Ne.style.setProperty("border-radius","var(--border-radius-sm)"),a(Ie,()=>e("invoiceReport.allTypesOption")),a(Ce,()=>e("invoiceReport.seaOption")),a(Ee,()=>e("invoiceReport.airOption")),a(k,A(Me,{get when(){return c()!=="all"},get children(){return A(ct,{variant:"primary",onClick:L,get disabled(){return ke(()=>c()==="all")()&&r()},get children(){return ke(()=>!!r())()?e("invoiceReport.loading"):e("invoiceReport.generateReport")}})}}),null),ge(()=>ne.value=c()),ge(()=>Q.value=i()),ge(()=>de.value=s()),ge(()=>ce.value=g()),ge(()=>Ne.value=S()),k}}),null),a(z,A(Me,{get when(){return ke(()=>!!(c()!=="all"&&j()))()&&!r()},get children(){return[(()=>{var k=ub();return k.style.setProperty("display","grid"),k.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),k.style.setProperty("gap","1.5rem"),k.style.setProperty("margin-bottom","2rem"),a(k,A(Rt,{get title(){return e("invoiceReport.invoiceSummary")},get children(){var $=Y9(),G=$.firstChild,ne=G.firstChild,U=ne.firstChild;ne.nextSibling;var D=G.nextSibling,B=D.firstChild,Q=B.firstChild,Z=B.nextSibling,oe=Z.nextSibling,de=oe.nextSibling,re=de.nextSibling;re.nextSibling;var Y=D.nextSibling,ce=Y.firstChild,ue=ce.firstChild;ce.nextSibling;var ae=Y.nextSibling,ye=ae.firstChild,me=ye.firstChild;return ye.nextSibling,$.style.setProperty("padding","1rem"),G.style.setProperty("margin-bottom","0.5rem"),a(ne,()=>e("invoiceReport.totalInvoices"),U),a(G,()=>j().totalInvoices,null),D.style.setProperty("margin-bottom","0.5rem"),a(B,()=>e("invoiceReport.dateRange"),Q),a(D,()=>j().dateRange.from||e("common.all"),oe),a(D,()=>e("common.to"),re),a(D,()=>j().dateRange.to||e("common.all"),null),Y.style.setProperty("margin-bottom","0.5rem"),a(ce,()=>e("invoiceReport.store"),ue),a(Y,(()=>{var pe=ke(()=>j().store==="all");return()=>pe()?e("invoiceReport.allStores"):j().store})(),null),a(ye,()=>e("invoiceReport.shippingTypeLabel"),me),a(ae,(()=>{var pe=ke(()=>j().shippingType==="all");return()=>pe()?e("invoiceReport.allTypes"):ke(()=>j().shippingType==="SEA")()?e("invoiceReport.maritime"):ke(()=>j().shippingType==="AEREO")()?e("invoiceReport.air"):e("invoiceReport.notSet")})(),null),$}}),null),a(k,A(Rt,{get title(){return e("invoiceReport.paymentMethods")},get children(){var $=K9(),G=$.firstChild,ne=G.firstChild,U=ne.firstChild;ne.nextSibling;var D=G.nextSibling,B=D.firstChild,Q=B.firstChild;B.nextSibling;var Z=D.nextSibling,oe=Z.firstChild,de=oe.firstChild;oe.nextSibling;var re=Z.nextSibling,Y=re.firstChild,ce=Y.firstChild;return Y.nextSibling,$.style.setProperty("padding","1rem"),G.style.setProperty("margin-bottom","0.5rem"),a(ne,()=>e("invoiceReport.cash"),U),a(G,()=>P(j().paymentMethods.cash),null),D.style.setProperty("margin-bottom","0.5rem"),a(B,()=>e("invoiceReport.zelle"),Q),a(D,()=>P(j().paymentMethods.zelle),null),Z.style.setProperty("margin-bottom","0.5rem"),a(oe,()=>e("invoiceReport.other"),de),a(Z,()=>P(j().paymentMethods.other),null),re.style.setProperty("border-top","1px solid var(--border-color)"),re.style.setProperty("padding-top","0.5rem"),re.style.setProperty("font-weight","bold"),a(Y,()=>e("invoiceReport.total"),ce),a(re,()=>P(j().paymentMethods.total),null),$}}),null),a(k,A(Rt,{get title(){return e("invoiceReport.additionalCharges")},get children(){var $=Q9(),G=$.firstChild,ne=G.firstChild,U=ne.firstChild;ne.nextSibling;var D=G.nextSibling,B=D.firstChild,Q=B.firstChild;B.nextSibling;var Z=D.nextSibling,oe=Z.firstChild,de=oe.firstChild;return oe.nextSibling,$.style.setProperty("padding","1rem"),G.style.setProperty("margin-bottom","0.5rem"),a(ne,()=>e("invoiceReport.transport"),U),a(G,()=>P(j().transportTotal),null),D.style.setProperty("margin-bottom","0.5rem"),a(B,()=>e("invoiceReport.aranceles"),Q),a(D,()=>P(j().arancelesTotal),null),Z.style.setProperty("margin-bottom","0.5rem"),a(oe,()=>e("invoiceReport.tax"),de),a(Z,()=>P(j().taxTotal),null),$}}),null),k})(),A(Me,{get when(){return j().productsByType?.size>0},get children(){return A(Rt,{get title(){return e("invoiceReport.productsSummary")},style:{"margin-bottom":"2rem"},get children(){var k=hb(),$=k.firstChild,G=$.firstChild,ne=G.firstChild,U=ne.firstChild,D=U.nextSibling,B=D.nextSibling,Q=B.nextSibling,Z=G.nextSibling;return k.style.setProperty("overflow-x","auto"),$.style.setProperty("width","100%"),$.style.setProperty("border-collapse","collapse"),ne.style.setProperty("background","var(--background-color)"),U.style.setProperty("padding","1rem"),U.style.setProperty("text-align","left"),U.style.setProperty("border-bottom","2px solid var(--border-color)"),a(U,()=>e("invoiceReport.productType")),D.style.setProperty("padding","1rem"),D.style.setProperty("text-align","right"),D.style.setProperty("border-bottom","2px solid var(--border-color)"),a(D,()=>e("invoiceReport.quantity")),B.style.setProperty("padding","1rem"),B.style.setProperty("text-align","right"),B.style.setProperty("border-bottom","2px solid var(--border-color)"),a(B,()=>e("invoiceReport.totalValue")),Q.style.setProperty("padding","1rem"),Q.style.setProperty("text-align","right"),Q.style.setProperty("border-bottom","2px solid var(--border-color)"),a(Q,()=>e("invoiceReport.avgPrice")),a(Z,A(vt,{get each(){return Array.from(j().productsByType.entries()).sort((oe,de)=>de[1].total-oe[1].total)},children:([oe,de])=>(()=>{var re=iM(),Y=re.firstChild,ce=Y.nextSibling,ue=ce.nextSibling,ae=ue.nextSibling;return Y.style.setProperty("padding","0.75rem"),Y.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Y,oe),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("text-align","right"),ce.style.setProperty("border-bottom","1px solid var(--border-color)"),a(ce,()=>de.qty),ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("text-align","right"),ue.style.setProperty("border-bottom","1px solid var(--border-color)"),ue.style.setProperty("font-weight","600"),a(ue,()=>P(de.total)),ae.style.setProperty("padding","0.75rem"),ae.style.setProperty("text-align","right"),ae.style.setProperty("border-bottom","1px solid var(--border-color)"),a(ae,()=>P(de.total/de.qty)),re})()})),k}})}}),A(Me,{get when(){return j().reservasByTypeAndPrice?.size>0},get children(){return A(Rt,{get title(){return e("invoiceReport.reservasSummary")},style:{"margin-bottom":"2rem"},get children(){var k=hb(),$=k.firstChild,G=$.firstChild,ne=G.firstChild,U=ne.firstChild,D=U.nextSibling,B=D.nextSibling,Q=B.nextSibling,Z=G.nextSibling;return k.style.setProperty("overflow-x","auto"),$.style.setProperty("width","100%"),$.style.setProperty("border-collapse","collapse"),ne.style.setProperty("background","var(--background-color)"),U.style.setProperty("padding","1rem"),U.style.setProperty("text-align","left"),U.style.setProperty("border-bottom","2px solid var(--border-color)"),a(U,()=>e("invoiceReport.reservaType")),D.style.setProperty("padding","1rem"),D.style.setProperty("text-align","right"),D.style.setProperty("border-bottom","2px solid var(--border-color)"),a(D,()=>e("invoiceReport.totalQtyLbs")),B.style.setProperty("padding","1rem"),B.style.setProperty("text-align","left"),B.style.setProperty("border-bottom","2px solid var(--border-color)"),a(B,()=>e("invoiceReport.priceGroups")),Q.style.setProperty("padding","1rem"),Q.style.setProperty("text-align","right"),Q.style.setProperty("border-bottom","2px solid var(--border-color)"),a(Q,()=>e("invoiceReport.total")),a(Z,A(vt,{get each(){return Array.from(j().reservasByTypeAndPrice.entries()).sort((oe,de)=>de[1].total-oe[1].total)},children:([oe,de])=>(()=>{var re=oM(),Y=re.firstChild,ce=Y.nextSibling,ue=ce.nextSibling,ae=ue.firstChild,ye=ue.nextSibling;return Y.style.setProperty("padding","0.75rem"),Y.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Y,oe),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("text-align","right"),ce.style.setProperty("border-bottom","1px solid var(--border-color)"),ce.style.setProperty("font-weight","600"),a(ce,()=>de.qty?.toFixed(2)),ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("border-bottom","1px solid var(--border-color)"),ae.style.setProperty("font-size","0.875rem"),a(ae,A(vt,{get each(){return Array.from(de.priceGroups.entries()).sort((me,pe)=>me[0]-pe[0])},children:([me,pe])=>(()=>{var ve=sM(),Ne=ve.firstChild,Ie=Ne.firstChild,Ce=Ie.nextSibling;Ce.nextSibling;var Ee=Ne.nextSibling,we=Ee.firstChild,Re=we.nextSibling;return Re.nextSibling,ve.style.setProperty("margin-bottom","0.5rem"),ve.style.setProperty("display","flex"),ve.style.setProperty("align-items","center"),ve.style.setProperty("gap","0.5rem"),a(Ne,()=>P(me),Ie),a(Ne,()=>pe.qty?.toFixed(2),Ce),Ee.addEventListener("mouseleave",He=>He.currentTarget.style.background="#3498db"),Ee.addEventListener("mouseenter",He=>He.currentTarget.style.background="#2980b9"),Ee.$$click=()=>I({price:me,invoices:pe.invoices,type:oe}),Ee.style.setProperty("background","#3498db"),Ee.style.setProperty("color","white"),Ee.style.setProperty("border","none"),Ee.style.setProperty("border-radius","4px"),Ee.style.setProperty("padding","0.25rem 0.5rem"),Ee.style.setProperty("font-size","0.75rem"),Ee.style.setProperty("cursor","pointer"),Ee.style.setProperty("transition","background 0.2s"),a(Ee,()=>pe.invoices.length,Re),a(Ee,()=>pe.invoices.length>1?"s":"",null),ve})()})),ye.style.setProperty("padding","0.75rem"),ye.style.setProperty("text-align","right"),ye.style.setProperty("border-bottom","1px solid var(--border-color)"),ye.style.setProperty("font-weight","600"),a(ye,()=>P(de.total)),re})()})),k}})}}),A(Me,{get when(){return j().bulkStatistics?.size>0},get children(){return A(Rt,{title:"📦 Resumen de Bultos",style:{"margin-bottom":"2rem"},get children(){var k=J9(),$=k.firstChild,G=$.firstChild,ne=G.firstChild,U=ne.firstChild,D=U.nextSibling,B=D.nextSibling,Q=B.nextSibling,Z=Q.nextSibling,oe=G.nextSibling,de=oe.firstChild,re=de.firstChild,Y=re.nextSibling,ce=Y.nextSibling,ue=ce.nextSibling,ae=ue.nextSibling;return k.style.setProperty("overflow-x","auto"),$.style.setProperty("width","100%"),$.style.setProperty("border-collapse","collapse"),ne.style.setProperty("background","var(--background-color)"),U.style.setProperty("padding","1rem"),U.style.setProperty("text-align","left"),U.style.setProperty("border-bottom","2px solid var(--border-color)"),D.style.setProperty("padding","1rem"),D.style.setProperty("text-align","center"),D.style.setProperty("border-bottom","2px solid var(--border-color)"),B.style.setProperty("padding","1rem"),B.style.setProperty("text-align","center"),B.style.setProperty("border-bottom","2px solid var(--border-color)"),Q.style.setProperty("padding","1rem"),Q.style.setProperty("text-align","right"),Q.style.setProperty("border-bottom","2px solid var(--border-color)"),Z.style.setProperty("padding","1rem"),Z.style.setProperty("text-align","right"),Z.style.setProperty("border-bottom","2px solid var(--border-color)"),a(oe,A(vt,{get each(){return Array.from(j().bulkStatistics.entries()).sort((ye,me)=>me[1].totalValue-ye[1].totalValue)},children:([ye,me])=>(()=>{var pe=aM(),ve=pe.firstChild,Ne=ve.firstChild,Ie=Ne.firstChild,Ce=ve.nextSibling,Ee=Ce.nextSibling,we=Ee.nextSibling,Re=we.nextSibling;return ve.style.setProperty("padding","0.75rem"),ve.style.setProperty("border-bottom","1px solid var(--border-color)"),Ne.style.setProperty("display","flex"),Ne.style.setProperty("align-items","center"),Ne.style.setProperty("gap","0.5rem"),a(Ie,()=>me.shippingMethod==="aereo"?"✈️":"🚢"),a(Ne,ye,null),Ce.style.setProperty("padding","0.75rem"),Ce.style.setProperty("text-align","center"),Ce.style.setProperty("border-bottom","1px solid var(--border-color)"),Ce.style.setProperty("font-weight","600"),a(Ce,()=>me.count),Ee.style.setProperty("padding","0.75rem"),Ee.style.setProperty("text-align","center"),Ee.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Ee,()=>me.items),we.style.setProperty("padding","0.75rem"),we.style.setProperty("text-align","right"),we.style.setProperty("border-bottom","1px solid var(--border-color)"),we.style.setProperty("font-weight","600"),a(we,()=>P(me.totalValue)),Re.style.setProperty("padding","0.75rem"),Re.style.setProperty("text-align","right"),Re.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Re,()=>P(me.avgValue)),pe})()}),de),de.style.setProperty("background","var(--strip-color)"),de.style.setProperty("font-weight","bold"),re.style.setProperty("padding","0.75rem"),re.style.setProperty("border-top","2px solid var(--border-color)"),Y.style.setProperty("padding","0.75rem"),Y.style.setProperty("text-align","center"),Y.style.setProperty("border-top","2px solid var(--border-color)"),Y.style.setProperty("font-weight","700"),a(Y,()=>Array.from(j().bulkStatistics.values()).reduce((ye,me)=>ye+me.count,0)),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("text-align","center"),ce.style.setProperty("border-top","2px solid var(--border-color)"),ce.style.setProperty("font-weight","700"),a(ce,()=>Array.from(j().bulkStatistics.values()).reduce((ye,me)=>ye+me.items,0)),ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("text-align","right"),ue.style.setProperty("border-top","2px solid var(--border-color)"),ue.style.setProperty("font-weight","700"),a(ue,()=>P(Array.from(j().bulkStatistics.values()).reduce((ye,me)=>ye+me.totalValue,0))),ae.style.setProperty("padding","0.75rem"),ae.style.setProperty("text-align","right"),ae.style.setProperty("border-top","2px solid var(--border-color)"),k}})}}),A(Me,{get when(){return j().otherServicesByType?.size>0},get children(){return A(Rt,{get title(){return e("invoiceReport.otherServicesTitle")},style:{"margin-bottom":"2rem"},get children(){var k=X9(),$=k.firstChild,G=$.firstChild,ne=G.firstChild,U=ne.firstChild,D=U.nextSibling,B=G.nextSibling,Q=B.firstChild,Z=Q.firstChild,oe=Z.firstChild,de=oe.firstChild,re=Z.nextSibling;return k.style.setProperty("overflow-x","auto"),$.style.setProperty("width","100%"),$.style.setProperty("border-collapse","collapse"),ne.style.setProperty("background","var(--background-color)"),U.style.setProperty("padding","1rem"),U.style.setProperty("text-align","left"),U.style.setProperty("border-bottom","2px solid var(--border-color)"),a(U,()=>e("invoiceReport.serviceType")),D.style.setProperty("padding","1rem"),D.style.setProperty("text-align","right"),D.style.setProperty("border-bottom","2px solid var(--border-color)"),a(D,()=>e("invoiceReport.total")),a(B,A(vt,{get each(){return Array.from(j().otherServicesByType.entries()).sort((Y,ce)=>ce[1].total-Y[1].total)},children:([Y,ce])=>(()=>{var ue=lM(),ae=ue.firstChild,ye=ae.firstChild,me=ae.nextSibling;return ae.style.setProperty("padding","0.75rem"),ae.style.setProperty("border-bottom","1px solid var(--border-color)"),ye.style.setProperty("display","flex"),ye.style.setProperty("align-items","center"),ye.style.setProperty("gap","0.5rem"),a(ye,Y),me.style.setProperty("padding","0.75rem"),me.style.setProperty("text-align","right"),me.style.setProperty("border-bottom","1px solid var(--border-color)"),me.style.setProperty("font-weight","600"),a(me,()=>P(ce.total)),ue})()}),Q),Q.style.setProperty("background","var(--strip-color)"),Q.style.setProperty("font-weight","bold"),Z.style.setProperty("padding","0.75rem"),Z.style.setProperty("text-align","right"),Z.style.setProperty("border-top","2px solid var(--border-color)"),a(oe,()=>e("invoiceReport.totalOtherServices"),de),re.style.setProperty("padding","0.75rem"),re.style.setProperty("text-align","right"),re.style.setProperty("border-top","2px solid var(--border-color)"),re.style.setProperty("font-weight","700"),a(re,()=>P(j().transportTotal)),k}})}}),A(Rt,{get title(){return e("invoiceReport.totalSummary")},get children(){var k=Z9(),$=k.firstChild,G=$.firstChild,ne=G.nextSibling,U=$.nextSibling,D=U.firstChild,B=D.nextSibling,Q=U.nextSibling,Z=Q.firstChild,oe=Z.nextSibling,de=Q.nextSibling,re=de.firstChild,Y=re.nextSibling;return k.style.setProperty("display","grid"),k.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),k.style.setProperty("gap","2rem"),k.style.setProperty("padding","2rem"),$.style.setProperty("text-align","center"),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-secondary)"),G.style.setProperty("margin-bottom","0.5rem"),a(G,()=>e("invoiceReport.productsTotal")),ne.style.setProperty("font-size","1.5rem"),ne.style.setProperty("font-weight","bold"),ne.style.setProperty("color","var(--primary-color)"),a(ne,()=>P(Array.from(j().productsByType.values()).reduce((ce,ue)=>ce+ue.total,0))),U.style.setProperty("text-align","center"),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("color","var(--text-secondary)"),D.style.setProperty("margin-bottom","0.5rem"),a(D,()=>e("invoiceReport.reservasTotal")),B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","bold"),B.style.setProperty("color","var(--primary-color)"),a(B,()=>P(Array.from(j().reservasByTypeAndPrice.values()).reduce((ce,ue)=>ce+ue.total,0))),Q.style.setProperty("text-align","center"),Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-secondary)"),Z.style.setProperty("margin-bottom","0.5rem"),a(Z,()=>e("invoiceReport.transportServices")),oe.style.setProperty("font-size","1.5rem"),oe.style.setProperty("font-weight","bold"),oe.style.setProperty("color","var(--primary-color)"),a(oe,()=>P(j().transportTotal)),de.style.setProperty("text-align","center"),de.style.setProperty("border-left","2px solid var(--primary-color)"),de.style.setProperty("padding-left","2rem"),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-secondary)"),re.style.setProperty("margin-bottom","0.5rem"),a(re,()=>e("invoiceReport.grandTotal")),Y.style.setProperty("font-size","2rem"),Y.style.setProperty("font-weight","bold"),Y.style.setProperty("color","var(--primary-color)"),a(Y,()=>P(j().paymentMethods.total)),k}})]}}),null),a(z,A(Me,{get when(){return r()},get children(){var k=eM(),$=k.firstChild;return k.style.setProperty("text-align","center"),k.style.setProperty("padding","3rem"),$.style.setProperty("font-size","1.25rem"),$.style.setProperty("margin-bottom","1rem"),a($,()=>e("invoiceReport.generatingReport")),k}}),null),a(z,A(Me,{get when(){return W()},get children(){var k=tM(),$=k.firstChild,G=$.firstChild,ne=G.firstChild,U=ne.nextSibling,D=G.nextSibling,B=D.firstChild,Q=B.firstChild,Z=Q.nextSibling,oe=B.nextSibling,de=oe.firstChild,re=de.nextSibling,Y=oe.nextSibling,ce=Y.firstChild,ue=ce.nextSibling,ae=D.nextSibling,ye=ae.firstChild,me=ye.firstChild,pe=ye.nextSibling,ve=ae.nextSibling;return k.$$click=()=>I(null),k.style.setProperty("position","fixed"),k.style.setProperty("top","0"),k.style.setProperty("left","0"),k.style.setProperty("right","0"),k.style.setProperty("bottom","0"),k.style.setProperty("background","rgba(0, 0, 0, 0.5)"),k.style.setProperty("display","flex"),k.style.setProperty("align-items","center"),k.style.setProperty("justify-content","center"),k.style.setProperty("z-index","1000"),$.$$click=Ne=>Ne.stopPropagation(),$.style.setProperty("background","white"),$.style.setProperty("padding","2rem"),$.style.setProperty("border-radius","var(--border-radius)"),$.style.setProperty("max-width","600px"),$.style.setProperty("max-height","80vh"),$.style.setProperty("overflow-y","auto"),$.style.setProperty("box-shadow","var(--shadow-lg)"),G.style.setProperty("display","flex"),G.style.setProperty("justify-content","space-between"),G.style.setProperty("align-items","center"),G.style.setProperty("margin-bottom","1.5rem"),ne.style.setProperty("font-size","1.25rem"),ne.style.setProperty("font-weight","bold"),a(ne,()=>e("invoiceReport.invoiceReferences")),U.$$click=()=>I(null),U.style.setProperty("background","none"),U.style.setProperty("border","none"),U.style.setProperty("font-size","1.5rem"),U.style.setProperty("cursor","pointer"),U.style.setProperty("color","#666"),D.style.setProperty("margin-bottom","1rem"),B.style.setProperty("font-size","0.875rem"),B.style.setProperty("color","var(--text-secondary)"),a(B,()=>e("invoiceReport.type"),Q),a(Z,()=>W().type),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-secondary)"),a(oe,()=>e("invoiceReport.pricePerPound"),de),a(re,()=>P(W().price)),Y.style.setProperty("font-size","0.875rem"),Y.style.setProperty("color","var(--text-secondary)"),a(Y,()=>e("invoiceReport.totalInvoicesCount"),ce),a(ue,()=>W().invoices.length),ae.style.setProperty("border","1px solid var(--border-color)"),ae.style.setProperty("border-radius","var(--border-radius-sm)"),ae.style.setProperty("padding","1rem"),ae.style.setProperty("background","var(--background-color)"),ye.style.setProperty("font-weight","600"),ye.style.setProperty("margin-bottom","0.75rem"),a(ye,()=>e("invoiceReport.invoiceNumbers"),me),pe.style.setProperty("display","grid"),pe.style.setProperty("grid-template-columns","repeat(auto-fill, minmax(120px, 1fr))"),pe.style.setProperty("gap","0.5rem"),a(pe,A(vt,{get each(){return W().invoices},children:Ne=>(()=>{var Ie=ub();return Ie.$$click=()=>{const Ce=K().find(Ee=>Ee.invoice===Ne);Ce&&console.log("Invoice details:",Ce)},Ie.addEventListener("mouseleave",Ce=>{Ce.currentTarget.style.background="white",Ce.currentTarget.style.borderColor="var(--border-color)"}),Ie.addEventListener("mouseenter",Ce=>{Ce.currentTarget.style.background="#e3f2fd",Ce.currentTarget.style.borderColor="#2196f3"}),Ie.style.setProperty("padding","0.5rem"),Ie.style.setProperty("background","white"),Ie.style.setProperty("border","1px solid var(--border-color)"),Ie.style.setProperty("border-radius","var(--border-radius-sm)"),Ie.style.setProperty("font-family","monospace"),Ie.style.setProperty("font-size","0.875rem"),Ie.style.setProperty("text-align","center"),Ie.style.setProperty("transition","all 0.2s"),Ie.style.setProperty("cursor","pointer"),a(Ie,Ne),Ie})()})),ve.style.setProperty("margin-top","1.5rem"),ve.style.setProperty("display","flex"),ve.style.setProperty("justify-content","flex-end"),ve.style.setProperty("gap","1rem"),a(ve,A(ct,{variant:"outline",onClick:()=>{const Ne=W().invoices.join(", ");navigator.clipboard.writeText(Ne).then(()=>{alert(e("invoiceReport.invoiceNumbersCopied"))})},get children(){return e("invoiceReport.copyInvoiceNumbers")}}),null),a(ve,A(ct,{variant:"primary",onClick:()=>I(null),get children(){return e("invoiceReport.close")}}),null),k}}),null),z})()};Wt(["click"]);var dM=le("<div><div>"),uM=le("<div>⚠️ "),hM=le("<div><div><label></label><select><option value=all></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label><input type=text>"),pM=le("<div><button></button><button></button><button>➕ Crear Nueva Factura</button><button>📊 Resume Report"),dl=le("<div>"),mM=le("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),yM=le("<button>← "),fM=le("<option>"),gM=le("<div><div></div><div></div><div></div><div>"),pb=le("<div><span></span><span> "),vM=le("<div><span></span><span> $"),bM=le("<tr><td></td><td></td><td></td><td></td><td></td><td><span></span></td><td><button>");const Lh=t=>parseFloat(t?.toString())||0,PM=t=>{let e=Lh(t.qty),r=Lh(t.price),n=Lh(t.arancel);return`${(e*r+n)?.toFixed(2)}`},S_=t=>{let e=Math.abs(t.qty),r=Lh(t.salePrice);return`${(e*r)?.toFixed(2)}`},_M=t=>{let e=0;t?.reservas?.forEach(i=>{e+=parseFloat(PM(i))});let r=0;t?.products?.forEach(i=>{r+=parseFloat(S_(i))});let n={};return n.reservaSubtotal=e.toFixed(2),n.productSubtotal=r.toFixed(2),n.subtotalBeforeTax=(r+e).toFixed(2),n.total=n.subtotalBeforeTax,n},SM=t=>{const{t:e}=or(),[r,n]=Se(!1),[i,o]=Se("all"),[s,l]=Se(""),[c,d]=Se(""),[u,h]=Se(null),[g,m]=Se(null),[S,N]=Se("dashboard"),[x,b]=Se([]),[K,te]=Se(""),[F,V]=Se("overview");Ln(async()=>{try{t.invoices;try{const Z=await qi.fetchStores();let oe=Array.isArray(Z)?Z:Object.keys(Z)||[]}catch{const oe=qi.state.invoices||t.invoices,de=[...new Set(oe.map(re=>re.store))];b(de.sort())}}catch(Z){console.error("Error loading dashboard data:",Z)}}),Nt(()=>qi.state.invoices||t.invoices);const W=Nt(()=>{let Z;return t.invoices?Z=qi.getFilteredInvoices({store:i(),dateFrom:s(),dateTo:c()}):Z=qi.getFilteredInvoices({store:i(),dateFrom:s(),dateTo:c()}),Z}),I=async()=>{try{t.invoices,n(!0),await qi.refreshData({store:i()!=="all"?i():void 0,dateFrom:s()||void 0,dateTo:c()||void 0,search:K()}),n(!1)}catch(Z){console.error("Error refreshing data:",Z)}},E=Nt(()=>{r();const Z=W(),oe=qi.calculateSummary(Z);let de=new Map,re=new Map,Y=new Map;return Z.forEach(ce=>{ce?.products?.length>0&&ce?.products?.forEach(ue=>{const ae=Math.abs(ue.qty),ye=ue.product.label;de.set(ye,(de.get(ye)||0)+ae)}),ce?.reservas?.length>0&&ce?.reservas?.forEach(ue=>{let ae=parseInt(ue.qty);isNaN(ae)&&(ae=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[ue.type]||ue?.onlyTariff?(ae=parseFloat(ue.arancel)||parseFloat(ue.qty)*parseFloat(ue.price),Y.set(ue.type,(re.get(ue.type)||0)+ae)):re.set(ue.type,(re.get(ue.type)||0)+ae)})}),{...oe,productsByCategory:de,reservasByType:re,othersByType:Y}}),L=Z=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Z),M=Z=>new Date(Z).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),P={padding:"2rem"},w={display:"flex",gap:"1rem","align-items":"flex-end","margin-bottom":"2rem","flex-wrap":"wrap",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)"},v={display:"flex","flex-direction":"column",gap:"0.5rem",flex:"1","min-width":"200px"},j={"font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)"},z={padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--background-color)"},T={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(280px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},R={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)"},J={width:"48px",height:"48px","border-radius":"12px",display:"flex","align-items":"center","justify-content":"center","font-size":"1.5rem","margin-bottom":"1rem"},X={"font-size":"0.875rem",color:"var(--text-secondary)","margin-bottom":"0.5rem"},H={"font-size":"1.75rem","font-weight":"700",color:"var(--text-primary)","margin-bottom":"0.25rem"},se={"font-size":"0.75rem",color:"var(--text-muted)"},O={width:"100%",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",overflow:"hidden"},_={padding:"1rem","text-align":"left",background:"var(--background-color)","font-weight":"600",color:"var(--text-secondary)","font-size":"0.875rem","border-bottom":"2px solid var(--border-color)"},k={padding:"1rem","border-bottom":"1px solid var(--border-color)"},$={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},G=Z=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:Z?"var(--primary-color)":"var(--text-muted)","border-bottom":Z?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),ne={padding:"0.5rem 1rem",background:"var(--primary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","font-size":"0.875rem",transition:"opacity 0.2s"},U={padding:"0.75rem 1.5rem",background:"var(--secondary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","margin-bottom":"1rem",display:"flex","align-items":"center",gap:"0.5rem"},D=()=>[{title:e("invoices.totalRevenue"),value:E().grandTotal,icon:"💰",color:"#4CAF50",subtext:`${e("common.of")} ${E().totalInvoices} ${e("common.invoice")} `},{title:e("invoices.totalProducts"),value:E().totalProducts,icon:"📦",color:"#2196F3",subtext:`${L(E().totalProductAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.totalReservations"),value:E().totalReservas,icon:"🎫",color:"#FF9800",subtext:`${L(E().totalReservaAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.aranceles"),value:E().totalAranceles,icon:"🏛️",color:"#9C27B0",subtext:e("invoices.customsFees")},{title:e("invoices.uniqueCustomers"),value:E().uniqueCustomers,icon:"👥",color:"#00BCD4",subtext:e("invoices.activeCustomers"),isNumber:!0},{title:e("invoices.averageInvoice"),value:E().avgInvoiceValue,icon:"📊",color:"#FF5722",subtext:e("invoices.perInvoiceValue")},{title:e("invoices.completed"),value:E().completedInvoices,icon:"✅",color:"#4CAF50",subtext:`${E().pendingInvoices} ${e("invoices.pending")}`,isNumber:!0},{title:e("invoices.storesActive"),value:x().length,icon:"🏪",color:"#795548",subtext:e("invoices.locations"),isNumber:!0}],B=()=>gt.getActiveLocations();Un(()=>{});const Q=async()=>{let Z="YB1";xg.calcStockLevels(),await gt.fecthProduct(Z),await gt.fecthInventory(Z)};return Ln(()=>{Q()}),A(oo,{get title(){return e("invoices.title")},get children(){var Z=dl();return p(Z,P),a(Z,A(Me,{get when(){return S()==="dashboard"},get children(){return[A(Me,{get when(){return!t.invoices&&qi.state.loading},get children(){var oe=dM(),de=oe.firstChild;return oe.style.setProperty("text-align","center"),oe.style.setProperty("padding","2rem"),de.style.setProperty("font-size","1.25rem"),de.style.setProperty("margin-bottom","1rem"),a(de,()=>e("invoices.loadingInvoices")),oe}}),A(Me,{get when(){return qi.state.error},get children(){var oe=uM();return oe.firstChild,oe.style.setProperty("padding","1rem"),oe.style.setProperty("margin-bottom","1rem"),oe.style.setProperty("background","#ffebee"),oe.style.setProperty("border","1px solid #ffcdd2"),oe.style.setProperty("border-radius","var(--border-radius)"),oe.style.setProperty("color","#d32f2f"),a(oe,()=>qi.state.error,null),a(oe,A(ct,{variant:"outline",size:"sm",onClick:I,style:{"margin-left":"1rem"},get children(){return e("invoices.refreshData")}}),null),oe}}),(()=>{var oe=hM(),de=oe.firstChild,re=de.firstChild,Y=re.nextSibling,ce=Y.firstChild,ue=de.nextSibling,ae=ue.firstChild,ye=ae.nextSibling,me=ue.nextSibling,pe=me.firstChild,ve=pe.nextSibling,Ne=me.nextSibling,Ie=Ne.firstChild,Ce=Ie.nextSibling;return p(oe,w),a(re,()=>e("invoices.storeLocation")),Y.addEventListener("change",Ee=>o(Ee.currentTarget.value)),a(ce,()=>e("invoices.allStores")),a(Y,A(vt,{get each(){return B()},children:Ee=>(()=>{var we=fM();return a(we,()=>Ee.name),ge(()=>we.value=Ee.id),we})()}),null),a(ae,()=>e("invoices.fromDate")),ye.addEventListener("change",Ee=>l(Ee.currentTarget.value)),a(pe,()=>e("invoices.toDate")),ve.addEventListener("change",Ee=>d(Ee.currentTarget.value)),a(Ie,()=>e("invoices.search")),Ce.addEventListener("change",Ee=>te(Ee.currentTarget.value)),a(oe,A(ct,{variant:"secondary",onClick:()=>{o("all"),l(""),d(""),te("")},get children(){return e("invoices.clearFilters")}}),null),a(oe,A(ct,{variant:"primary",onClick:I,get disabled(){return!t.invoices&&qi.state.loading},get children(){return["🔄 ",ke(()=>e("invoices.refreshData"))]}}),null),ge(Ee=>{var we=v,Re=j,He=z,je=v,Ve=j,qe=z,tt=v,rt=j,Be=z,Ge=v,Fe=j,at=z,lt=e("invoices.searchPlaceholder");return Ee.e=p(de,we,Ee.e),Ee.t=p(re,Re,Ee.t),Ee.a=p(Y,He,Ee.a),Ee.o=p(ue,je,Ee.o),Ee.i=p(ae,Ve,Ee.i),Ee.n=p(ye,qe,Ee.n),Ee.s=p(me,tt,Ee.s),Ee.h=p(pe,rt,Ee.h),Ee.r=p(ve,Be,Ee.r),Ee.d=p(Ne,Ge,Ee.d),Ee.l=p(Ie,Fe,Ee.l),Ee.u=p(Ce,at,Ee.u),lt!==Ee.c&&Jt(Ce,"placeholder",Ee.c=lt),Ee},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0}),ge(()=>Y.value=i()),ge(()=>ye.value=s()),ge(()=>ve.value=c()),ge(()=>Ce.value=K()),oe})(),(()=>{var oe=pM(),de=oe.firstChild,re=de.nextSibling,Y=re.nextSibling,ce=Y.nextSibling;return p(oe,$),de.$$click=()=>V("overview"),a(de,()=>e("inventory.overview")),re.$$click=()=>V("invoices"),a(re,()=>e("invoices.invoices")),Y.$$click=()=>V("add"),ce.$$click=()=>V("report"),ge(ue=>{var ae=G(F()==="overview"),ye=G(F()==="invoices"),me=G(F()==="add"),pe=G(F()==="report");return ue.e=p(de,ae,ue.e),ue.t=p(re,ye,ue.t),ue.a=p(Y,me,ue.a),ue.o=p(ce,pe,ue.o),ue},{e:void 0,t:void 0,a:void 0,o:void 0}),oe})(),A(Me,{get when(){return F()==="overview"},get children(){return[(()=>{var oe=dl();return p(oe,T),a(oe,A(vt,{get each(){return D()},children:de=>(()=>{var re=gM(),Y=re.firstChild,ce=Y.nextSibling,ue=ce.nextSibling,ae=ue.nextSibling;return p(re,R),a(Y,()=>de?.icon),p(ce,X),a(ce,()=>de?.title),p(ue,H),a(ue,(()=>{var ye=ke(()=>!!de.isNumber);return()=>ye()?de.value:L(de.value)})()),p(ae,se),a(ae,()=>de.subtext),ge(ye=>p(Y,{...J,background:`${de?.color}20`,color:de?.color},ye)),re})()})),oe})(),A(Me,{get when(){return E()?.productsByCategory?.size>0},get children(){return A(Rt,{get title(){return e("invoices.topProducts")},get subtitle(){return e("invoices.mostSoldProducts")},get children(){var oe=dl();return oe.style.setProperty("max-height","300px"),oe.style.setProperty("overflow-y","auto"),a(oe,()=>Array.from(E().productsByCategory.entries()).sort((de,re)=>re[1]-de[1]).slice(0,10).map(([de,re])=>(()=>{var Y=pb(),ce=Y.firstChild,ue=ce.nextSibling,ae=ue.firstChild;return Y.style.setProperty("display","flex"),Y.style.setProperty("justify-content","space-between"),Y.style.setProperty("padding","0.75rem"),Y.style.setProperty("border-bottom","1px solid var(--border-color)"),a(ce,de),ue.style.setProperty("font-weight","600"),a(ue,re,ae),a(ue,()=>e("common.units"),null),Y})())),oe}})}}),(()=>{var oe=dl();return oe.style.setProperty("margin","19px"),oe})(),A(Me,{get when(){return E()?.reservasByType?.size>0},get children(){return A(Rt,{get title(){return e("invoices.reservationsByType")},get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var oe=dl();return oe.style.setProperty("max-height","300px"),oe.style.setProperty("overflow-y","auto"),a(oe,()=>Array.from(E().reservasByType.entries()).sort((de,re)=>re[1]-de[1]).map(([de,re])=>(()=>{var Y=pb(),ce=Y.firstChild,ue=ce.nextSibling,ae=ue.firstChild;return Y.style.setProperty("display","flex"),Y.style.setProperty("justify-content","space-between"),Y.style.setProperty("padding","0.75rem"),Y.style.setProperty("border-bottom","1px solid var(--border-color)"),a(ce,de),ue.style.setProperty("font-weight","600"),a(ue,re,ae),a(ue,()=>e("common.lbs"),null),Y})())),oe}})}}),(()=>{var oe=dl();return oe.style.setProperty("margin","19px"),oe})(),A(Me,{get when(){return E()?.othersByType?.size>0},get children(){return A(Rt,{title:"Aranceles y otros servicios",get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var oe=dl();return oe.style.setProperty("max-height","300px"),oe.style.setProperty("overflow-y","auto"),a(oe,()=>Array.from(E().othersByType.entries()).sort((de,re)=>re[1]-de[1]).map(([de,re])=>(()=>{var Y=vM(),ce=Y.firstChild,ue=ce.nextSibling,ae=ue.firstChild;return Y.style.setProperty("display","flex"),Y.style.setProperty("justify-content","space-between"),Y.style.setProperty("padding","0.75rem"),Y.style.setProperty("border-bottom","1px solid var(--border-color)"),a(ce,de),ue.style.setProperty("font-weight","600"),a(ue,re,ae),Y})())),oe}})}})]}})]}}),null),a(Z,A(Me,{get when(){return F()==="invoices"},get children(){return[A(Me,{get when(){return S()!=="detail"},get children(){return A(Rt,{get title(){return e("invoices.recentInvoices")},get subtitle(){return`Mostrando ${W().length} facturas`},style:{"margin-top":"1.5rem"},get children(){var oe=mM(),de=oe.firstChild,re=de.firstChild,Y=re.firstChild,ce=Y.firstChild,ue=ce.nextSibling,ae=ue.nextSibling,ye=ae.nextSibling,me=ye.nextSibling,pe=me.nextSibling,ve=pe.nextSibling,Ne=re.nextSibling;return oe.style.setProperty("overflow-x","auto"),p(de,O),a(ce,()=>e("invoices.invoiceNumber")),a(ue,()=>e("invoices.date")),a(ae,()=>e("invoices.customer")),a(ye,()=>e("invoices.id")),a(me,()=>e("invoices.total")),a(pe,()=>e("invoices.status")),a(ve,()=>e("invoices.actions")),a(Ne,A(vt,{get each(){return W().slice(0,50)},children:Ie=>{const Ce=()=>pp(Ie);return(()=>{var Ee=bM(),we=Ee.firstChild,Re=we.nextSibling,He=Re.nextSibling,je=He.nextSibling,Ve=je.nextSibling,qe=Ve.nextSibling,tt=qe.firstChild,rt=qe.nextSibling,Be=rt.firstChild;return a(we,()=>Ie?.invoice),a(Re,()=>M(Ie?.createDate)),a(He,()=>Ie?.shipper_consignee?.name),a(je,()=>Ie?.shipper_consignee?.cid),a(Ve,()=>L(Ce()?.total)),tt.style.setProperty("padding","0.25rem 0.75rem"),tt.style.setProperty("border-radius","9999px"),tt.style.setProperty("font-size","0.75rem"),tt.style.setProperty("font-weight","600"),a(tt,(()=>{var Ge=ke(()=>!!Ie.isCompleted);return()=>Ge()?e("invoices.completed"):e("invoices.pending")})()),Be.addEventListener("mouseleave",Ge=>Ge.currentTarget.style.opacity="1"),Be.addEventListener("mouseenter",Ge=>Ge.currentTarget.style.opacity="0.8"),Be.$$click=()=>{m(pp(Ie)),h(Ie),N("detail")},p(Be,ne),a(Be,()=>e("invoices.view")),ge(Ge=>{var Fe=k,at=k,lt=k,Xe=k,Ct={...k,"text-align":"right","font-weight":"600"},Le=k,nt=Ie.isCompleted?"#d4edda":"#fff3cd",We=Ie.isCompleted?"#155724":"#856404",kt=k;return Ge.e=p(we,Fe,Ge.e),Ge.t=p(Re,at,Ge.t),Ge.a=p(He,lt,Ge.a),Ge.o=p(je,Xe,Ge.o),Ge.i=p(Ve,Ct,Ge.i),Ge.n=p(qe,Le,Ge.n),nt!==Ge.s&&((Ge.s=nt)!=null?tt.style.setProperty("background",nt):tt.style.removeProperty("background")),We!==Ge.h&&((Ge.h=We)!=null?tt.style.setProperty("color",We):tt.style.removeProperty("color")),Ge.r=p(rt,kt,Ge.r),Ge},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),Ee})()}})),ge(Ie=>{var Ce=_,Ee=_,we=_,Re=_,He={..._,"text-align":"right"},je=_,Ve=_;return Ie.e=p(ce,Ce,Ie.e),Ie.t=p(ue,Ee,Ie.t),Ie.a=p(ae,we,Ie.a),Ie.o=p(ye,Re,Ie.o),Ie.i=p(me,He,Ie.i),Ie.n=p(pe,je,Ie.n),Ie.s=p(ve,Ve,Ie.s),Ie},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),oe}})}}),A(Me,{get when(){return ke(()=>S()==="detail")()&&u()},get children(){return[(()=>{var oe=yM();return oe.firstChild,oe.$$click=()=>{N("dashboard"),h(null)},p(oe,U),a(oe,()=>e("invoices.backToDashboard"),null),oe})(),A($D,{get invoice(){return u()},onPrint:()=>window.print(),get parseData(){return g()},goBack:()=>{N("dashboard"),h(null)}})]}})]}}),null),a(Z,A(Me,{get when(){return F()==="add"},get children(){return A(G9,{})}}),null),a(Z,A(Me,{get when(){return F()==="report"},get children(){return A(cM,{})}}),null),Z}})};Wt(["click"]);const wM=()=>A(SM,{invoices:[{type:"SALES",invoice:"20255FK6S4B43SSS",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCim",ssg_sorder_key:"JqdrRwGBpdBfRCim",createDate:1736132690425,shipper_consignee:{name:"Yudith Perez Medero",phoneNumberS:"5022408378",dob:"1982-07-23",firstName:"RAUL",lastName:"BATISTA",lastName2:"ESPOSITO",middleName:"",email:"",phoneNumber:"52393232",altPhoneNumber:"",cid:"48121007305",ybstreetNo:"9",ybstreet:"10",ybbetwen1:"CARRALERO",ybbetwen2:"3RA",ybapt:"",ybreparto:"PUEBLO NUEVO",consigneeId:"26144",ssg_consignee_key:"26144",passport:"NA",nacionality:"CUB",ybcity:"HOLGUIN",ybestate:"HOLGUIN",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534800",reservas:[{type:"UTILES DEL HOGAR",qty:"15",arancel:"10",price:"5",key:"1GB16SD80"},{type:"MISCELANEAS",qty:"19",arancel:"",price:"4",key:"0DS6K14Y2"}],products:[{product:{id:"CmrhMfVjLR9HxT6P",label:"FOGONES ELECTRICO DOBLE RESISTENCIA DE ALAMBRE",code:"978Y82K94"},qty:-1,price:23.696296296296296,salePrice:"34"},{product:{id:"ov56aPYGbXIq4XGy",label:"Caramelos",code:"C852CSKB5"},qty:-2,price:5.990000000000001,salePrice:"10"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43TTT",description:"",store:"YY_8803",ssg_inventory_key:"JqdrRwGBpdBfRCin",ssg_sorder_key:"JqdrRwGBpdBfRCin",createDate:1736032690425,shipper_consignee:{name:"Maria Rodriguez Santos",phoneNumberS:"5024567890",dob:"1990-03-15",firstName:"MARIA",lastName:"RODRIGUEZ",lastName2:"SANTOS",middleName:"ELENA",email:"maria@email.com",phoneNumber:"52987654",altPhoneNumber:"",cid:"90031507890",ybstreetNo:"15",ybstreet:"23",ybbetwen1:"MARTI",ybbetwen2:"CESPEDES",ybapt:"2A",ybreparto:"CENTRO",consigneeId:"26145",ssg_consignee_key:"26145",passport:"A1234567",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534801",reservas:[{type:"ELECTRONICOS",qty:"5",arancel:"15",price:"12",key:"2GB16SD81"},{type:"ROPA Y CALZADO",qty:"8",arancel:"8",price:"7",key:"0DS6K14Y3"}],products:[{product:{id:"XmrhMfVjLR9HxT6Q",label:"TELEVISOR LED 32 PULGADAS",code:"TV32LED01"},qty:-1,price:150.5,salePrice:"220"},{product:{id:"Yv56aPYGbXIq4XGz",label:"Zapatos Deportivos Nike",code:"ZAP001"},qty:-1,price:45.99,salePrice:"75"}],isCompleted:!1},{type:"SALES",invoice:"20255FK6S4B43UUU",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCio",ssg_sorder_key:"JqdrRwGBpdBfRCio",createDate:1735932690425,shipper_consignee:{name:"Carlos Mendez Perez",phoneNumberS:"5025678901",dob:"1975-12-08",firstName:"CARLOS",lastName:"MENDEZ",lastName2:"PEREZ",middleName:"ANTONIO",email:"",phoneNumber:"52876543",altPhoneNumber:"",cid:"75120878901",ybstreetNo:"7",ybstreet:"45",ybbetwen1:"LINEA",ybbetwen2:"PASEO",ybapt:"",ybreparto:"VEDADO",consigneeId:"26146",ssg_consignee_key:"26146",passport:"NA",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534802",reservas:[{type:"ALIMENTOS",qty:"25",arancel:"5",price:"3",key:"3GB16SD82"}],products:[{product:{id:"ZmrhMfVjLR9HxT6R",label:"ARROZ ESPECIAL 5LB",code:"ARZ005"},qty:-5,price:2.5,salePrice:"4"},{product:{id:"Av56aPYGbXIq4XG1",label:"ACEITE DE COCINA 1L",code:"ACE001"},qty:-3,price:3.75,salePrice:"6"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43VVV",description:"",store:"YY_8802",ssg_inventory_key:"JqdrRwGBpdBfRCip",ssg_sorder_key:"JqdrRwGBpdBfRCip",createDate:1735832690425,shipper_consignee:{name:"Ana Lucia Fernandez",phoneNumberS:"5026789012",dob:"1988-06-20",firstName:"ANA",lastName:"FERNANDEZ",lastName2:"LOPEZ",middleName:"LUCIA",email:"ana.lucia@email.com",phoneNumber:"52765432",altPhoneNumber:"52111222",cid:"88062076789",ybstreetNo:"12",ybstreet:"18",ybbetwen1:"CALZADA",ybbetwen2:"SAN LAZARO",ybapt:"3B",ybreparto:"CENTRO HABANA",consigneeId:"26147",ssg_consignee_key:"26147",passport:"B9876543",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:"Entrega en horario de oficina"},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534803",reservas:[{type:"MEDICINA Y SALUD",qty:"10",arancel:"12",price:"8",key:"4GB16SD83"},{type:"UTILES DEL HOGAR",qty:"6",arancel:"6",price:"4",key:"5GB16SD84"}],products:[{product:{id:"BmrhMfVjLR9HxT6S",label:"VITAMINAS MULTIPLES 60 CAP",code:"VIT001"},qty:-2,price:12.5,salePrice:"18"}],isCompleted:!0}]}),Rh={invoice:"",description:"",store:"",shipper_consignee:{name:"",firstName:"",middleName:"",lastName:"",lastName2:"",phoneNumber:"",cid:"",passport:"",address:""},products:[],reservas:[],bags:[],packagesOrder:!1,shippingType:"SEA"},Ng="invoice_form_draft",xM=()=>{try{const t=localStorage.getItem(Ng);if(t){const e=JSON.parse(t),r={...Rh,...e,shipper_consignee:{...Rh.shipper_consignee,...e.shipper_consignee||{}},products:e.products||[],reservas:e.reservas||[],bags:e.bags||[]};return console.log("Loaded form data from storage:",r),r}}catch(t){console.warn("Failed to load invoice form from storage:",t)}return console.log("No saved data found, using default form data"),{...Rh}},Lg=t=>{try{localStorage.setItem(Ng,JSON.stringify(t))}catch(e){console.warn("Failed to save invoice form to storage:",e)}},mb=()=>{try{localStorage.removeItem(Ng)}catch(t){console.warn("Failed to clear invoice form from storage:",t)}},[fl,go]=Se(xM()),[w_,ji]=Se(!1),[CM,Dh]=Se(null);let fy=null;const Do=()=>{fy&&clearTimeout(fy),fy=setTimeout(()=>{const t=fl();Lg(t),Dh(new Date),console.log("Invoice form auto-saved at",new Date().toLocaleTimeString())},1e3)},AM={formData:fl,get isDirty(){return w_()},get lastSaved(){return CM()},updateForm:t=>{go(e=>{const r={...e,...t};return ji(!0),Do(),r})},updateShipperConsignee:t=>{go(e=>{const r={...e,shipper_consignee:{...e.shipper_consignee,...t}};return ji(!0),Do(),r})},addProduct:t=>{go(e=>{const r={...e,products:[...e.products,t]};return ji(!0),Do(),r})},updateProduct:(t,e)=>{go(r=>{const n=[...r.products];n[t]={...n[t],...e};const i={...r,products:n};return ji(!0),Do(),i})},removeProduct:t=>{go(e=>{const r=e.products.filter((i,o)=>o!==t),n={...e,products:r};return ji(!0),Do(),n})},addReserva:t=>{go(e=>{const r={...e,reservas:[...e.reservas,t]};return ji(!0),Do(),r})},updateReserva:(t,e)=>{go(r=>{const n=[...r.reservas];n[t]={...n[t],...e};const i={...r,reservas:n};return ji(!0),Do(),i})},removeReserva:t=>{go(e=>{const r=e.reservas.filter((i,o)=>o!==t),n={...e,reservas:r};return ji(!0),Do(),n})},addBag:t=>{go(e=>{const r={...e,bags:[...e.bags,t]};return ji(!0),Do(),r})},updateBag:(t,e)=>{go(r=>{const n=[...r.bags];n[t]={...n[t],...e};const i={...r,bags:n};return ji(!0),Do(),i})},removeBag:t=>{go(e=>{const r=e.bags.filter((i,o)=>o!==t),n={...e,bags:r};return ji(!0),Do(),n})},clearForm:()=>{go({...Rh}),ji(!1),mb(),Dh(null)},markCompleted:()=>{mb(),ji(!1),Dh(null)},forceSave:()=>{Lg(fl()),Dh(new Date),ji(!1)},hasData:()=>{const t=fl();return t.invoice!==""||t.description!==""||t.store!==""||t.shipper_consignee.name!==""||t.shipper_consignee.firstName!==""||t.shipper_consignee.cid!==""||t.products.length>0||t.reservas.length>0||t.bags.length>0},isValid:()=>{const t=fl();return t.invoice.trim()!==""&&t.shipper_consignee.name.trim()!==""&&(t.products.length>0||t.reservas.length>0)},getFormData:()=>fl()};typeof window<"u"&&window.addEventListener("beforeunload",t=>{if(w_()&&(Lg(fl()),AM.hasData()))return t.preventDefault(),t.returnValue="You have unsaved changes in your invoice. Are you sure you want to leave?",t.returnValue});var $M=le('<div><div><h2></h2><div><h3>Basic Information</h3><div><div><label>Rule Name *</label><input type=text placeholder="Enter rule name"></div><div><label>Priority</label><input type=number min=1 max=1000></div></div><div><label>Description *</label><textarea placeholder="Describe what this rule does"></textarea></div><div><div><label>Trigger Event *</label><select></select></div><div><label><input type=checkbox>Active</label></div></div></div><div><div><h3>Conditions</h3><button>Add Condition</button></div></div><div><div><h3>Account Mappings</h3><button>Add Mapping</button></div></div><div><button>Cancel</button><button>'),yb=le("<option>"),EM=le('<div><div><div><label>Field</label><input type=text placeholder="e.g., invoice.total, paymentMethods.cash"></div><div><label>Operator</label><select></select></div><div><label>Value</label><input></div><div>'),fb=le("<button>Remove"),IM=le('<div><div><div><label>Debit Account</label><select></select></div><div><label>Credit Account</label><select></select></div></div><div><div><label>Amount Expression</label><input type=text placeholder="e.g., invoice.total, paymentMethods.cash"></div><div><label>Description Template</label><input type=text placeholder="e.g., Sale - Invoice #{invoice}"></div><div>'),gb=le("<option> - ");const TM=t=>{const e=()=>t.rule&&t.rule.id,[r,n]=Se({id:t.rule?.id||"",name:t.rule?.name||"",description:t.rule?.description||"",triggerEvent:t.rule?.triggerEvent||"invoice_completed",isActive:t.rule?.isActive??!0,priority:t.rule?.priority||100,conditions:t.rule?.conditions||[{field:"",operator:"greaterThan",value:0}],actions:t.rule?.actions||[{type:"create_journal_entry",accountMappings:[{debitAccountId:"1001",creditAccountId:"4001",amountExpression:"",description:""}]}]}),i=[{id:"1001",name:"Cash - Operating Account"},{id:"1002",name:"Cash - Zelle Account"},{id:"1003",name:"Cash - Credit Card Processing"},{id:"1101",name:"Accounts Receivable - Customers"},{id:"1201",name:"Inventory - Products"},{id:"1401",name:"Customs Fees Receivable"},{id:"2001",name:"Accounts Payable"},{id:"2301",name:"Sales Tax Payable"},{id:"2302",name:"Customs Fees Payable"},{id:"3001",name:"Owner's Equity"},{id:"4001",name:"Sales Revenue - Products"},{id:"4101",name:"Service Revenue - General"},{id:"4201",name:"Transport Service Revenue"},{id:"5001",name:"Cost of Goods Sold - Products"},{id:"5201",name:"Salaries and Wages"},{id:"5301",name:"Utilities Expense"}],o=[{value:"invoice_completed",label:"Invoice Completed"},{value:"payment_received",label:"Payment Received"},{value:"service_rendered",label:"Service Rendered"},{value:"inventory_movement",label:"Inventory Movement"},{value:"tax_calculated",label:"Tax Calculated"}],s=[{value:"equals",label:"Equals"},{value:"contains",label:"Contains"},{value:"greaterThan",label:"Greater Than"},{value:"lessThan",label:"Less Than"},{value:"in",label:"In Array"}],l=(V,W)=>{n(I=>({...I,[V]:W}))},c=()=>{const V=r();n({...V,conditions:[...V.conditions||[],{field:"",operator:"greaterThan",value:0}]})},d=V=>{const W=r();n({...W,conditions:W.conditions?.filter((I,E)=>E!==V)||[]})},u=(V,W,I)=>{const E=r(),L=[...E.conditions||[]];L[V]={...L[V],[W]:I},n({...E,conditions:L})},h=()=>{const V=r(),W=[...V.actions||[]];W[0]&&(W[0]={...W[0],accountMappings:[...W[0].accountMappings||[],{debitAccountId:"1001",creditAccountId:"4001",amountExpression:"",description:""}]}),n({...V,actions:W})},g=V=>{const W=r(),I=[...W.actions||[]];I[0]&&(I[0]={...I[0],accountMappings:I[0].accountMappings?.filter((E,L)=>L!==V)||[]}),n({...W,actions:I})},m=(V,W,I)=>{const E=r(),L=[...E.actions||[]];if(L[0]){const M=[...L[0].accountMappings||[]];M[V]={...M[V],[W]:I},L[0]={...L[0],accountMappings:M}}n({...E,actions:L})},S=()=>{const V=r();if(!V.name||!V.description||!V.triggerEvent){alert("Please fill in all required fields");return}const W={id:V.id||`rule_${Date.now()}`,name:V.name,description:V.description,triggerEvent:V.triggerEvent,isActive:V.isActive??!0,priority:V.priority||100,conditions:V.conditions||[],actions:V.actions||[]};t.onSave(W)},N={width:"100%",padding:"0.5rem",border:"1px solid #d1d5db","border-radius":"0.375rem","font-size":"0.875rem"},x={...N,"background-color":"white"},b={padding:"0.5rem 1rem","border-radius":"0.375rem",cursor:"pointer","font-weight":"500",border:"1px solid #d1d5db"},K={...b,"background-color":"#3b82f6",color:"white",border:"none"},te={...b,"background-color":"white",color:"#374151"},F={...b,"background-color":"#ef4444",color:"white",border:"none"};return(()=>{var V=$M(),W=V.firstChild,I=W.firstChild,E=I.nextSibling,L=E.firstChild,M=L.nextSibling,P=M.firstChild,w=P.firstChild,v=w.nextSibling,j=P.nextSibling,z=j.firstChild,T=z.nextSibling,R=M.nextSibling,J=R.firstChild,X=J.nextSibling,H=R.nextSibling,se=H.firstChild,O=se.firstChild,_=O.nextSibling,k=se.nextSibling,$=k.firstChild,G=$.firstChild,ne=E.nextSibling,U=ne.firstChild,D=U.firstChild,B=D.nextSibling,Q=ne.nextSibling,Z=Q.firstChild,oe=Z.firstChild,de=oe.nextSibling,re=Q.nextSibling,Y=re.firstChild,ce=Y.nextSibling;return V.style.setProperty("position","fixed"),V.style.setProperty("top","0"),V.style.setProperty("left","0"),V.style.setProperty("right","0"),V.style.setProperty("bottom","0"),V.style.setProperty("background-color","rgba(0, 0, 0, 0.5)"),V.style.setProperty("display","flex"),V.style.setProperty("align-items","center"),V.style.setProperty("justify-content","center"),V.style.setProperty("z-index","1000"),W.style.setProperty("background-color","white"),W.style.setProperty("border-radius","0.5rem"),W.style.setProperty("padding","2rem"),W.style.setProperty("max-width","800px"),W.style.setProperty("max-height","90vh"),W.style.setProperty("overflow-y","auto"),W.style.setProperty("width","90%"),I.style.setProperty("font-size","1.5rem"),I.style.setProperty("font-weight","700"),I.style.setProperty("margin-bottom","1.5rem"),a(I,()=>e()?"Edit Automation Rule":"Add New Automation Rule"),E.style.setProperty("margin-bottom","1.5rem"),L.style.setProperty("font-size","1.125rem"),L.style.setProperty("font-weight","600"),L.style.setProperty("margin-bottom","1rem"),M.style.setProperty("display","grid"),M.style.setProperty("grid-template-columns","1fr 1fr"),M.style.setProperty("gap","1rem"),M.style.setProperty("margin-bottom","1rem"),w.style.setProperty("display","block"),w.style.setProperty("font-weight","500"),w.style.setProperty("margin-bottom","0.5rem"),v.$$input=ue=>l("name",ue.currentTarget.value),z.style.setProperty("display","block"),z.style.setProperty("font-weight","500"),z.style.setProperty("margin-bottom","0.5rem"),T.$$input=ue=>l("priority",parseInt(ue.currentTarget.value)||100),R.style.setProperty("margin-bottom","1rem"),J.style.setProperty("display","block"),J.style.setProperty("font-weight","500"),J.style.setProperty("margin-bottom","0.5rem"),X.$$input=ue=>l("description",ue.currentTarget.value),H.style.setProperty("display","grid"),H.style.setProperty("grid-template-columns","1fr auto"),H.style.setProperty("gap","1rem"),H.style.setProperty("align-items","end"),O.style.setProperty("display","block"),O.style.setProperty("font-weight","500"),O.style.setProperty("margin-bottom","0.5rem"),_.addEventListener("change",ue=>l("triggerEvent",ue.currentTarget.value)),a(_,A(vt,{each:o,children:ue=>(()=>{var ae=yb();return a(ae,()=>ue.label),ge(()=>ae.value=ue.value),ae})()})),$.style.setProperty("display","flex"),$.style.setProperty("align-items","center"),$.style.setProperty("gap","0.5rem"),G.addEventListener("change",ue=>l("isActive",ue.currentTarget.checked)),ne.style.setProperty("margin-bottom","1.5rem"),U.style.setProperty("display","flex"),U.style.setProperty("justify-content","space-between"),U.style.setProperty("align-items","center"),U.style.setProperty("margin-bottom","1rem"),D.style.setProperty("font-size","1.125rem"),D.style.setProperty("font-weight","600"),B.$$click=c,a(ne,A(vt,{get each(){return r().conditions||[]},children:(ue,ae)=>(()=>{var ye=EM(),me=ye.firstChild,pe=me.firstChild,ve=pe.firstChild,Ne=ve.nextSibling,Ie=pe.nextSibling,Ce=Ie.firstChild,Ee=Ce.nextSibling,we=Ie.nextSibling,Re=we.firstChild,He=Re.nextSibling,je=we.nextSibling;return ye.style.setProperty("border","1px solid #d1d5db"),ye.style.setProperty("border-radius","0.375rem"),ye.style.setProperty("padding","1rem"),ye.style.setProperty("margin-bottom","1rem"),me.style.setProperty("display","grid"),me.style.setProperty("grid-template-columns","2fr 1fr 1fr auto"),me.style.setProperty("gap","1rem"),me.style.setProperty("align-items","end"),ve.style.setProperty("display","block"),ve.style.setProperty("font-weight","500"),ve.style.setProperty("margin-bottom","0.5rem"),Ne.$$input=Ve=>u(ae(),"field",Ve.currentTarget.value),Ce.style.setProperty("display","block"),Ce.style.setProperty("font-weight","500"),Ce.style.setProperty("margin-bottom","0.5rem"),Ee.addEventListener("change",Ve=>u(ae(),"operator",Ve.currentTarget.value)),a(Ee,A(vt,{each:s,children:Ve=>(()=>{var qe=yb();return a(qe,()=>Ve.label),ge(()=>qe.value=Ve.value),qe})()})),Re.style.setProperty("display","block"),Re.style.setProperty("font-weight","500"),Re.style.setProperty("margin-bottom","0.5rem"),He.$$input=Ve=>u(ae(),"value",ue.operator==="greaterThan"||ue.operator==="lessThan"?parseFloat(Ve.currentTarget.value)||0:Ve.currentTarget.value),a(je,(()=>{var Ve=ke(()=>(r().conditions?.length||0)>1);return()=>Ve()&&(()=>{var qe=fb();return qe.$$click=()=>d(ae()),ge(tt=>p(qe,F,tt)),qe})()})()),ge(Ve=>{var qe=N,tt=x,rt=ue.operator==="greaterThan"||ue.operator==="lessThan"?"number":"text",Be=N;return Ve.e=p(Ne,qe,Ve.e),Ve.t=p(Ee,tt,Ve.t),rt!==Ve.a&&Jt(He,"type",Ve.a=rt),Ve.o=p(He,Be,Ve.o),Ve},{e:void 0,t:void 0,a:void 0,o:void 0}),ge(()=>Ne.value=ue.field),ge(()=>Ee.value=ue.operator),ge(()=>He.value=ue.value),ye})()}),null),Q.style.setProperty("margin-bottom","2rem"),Z.style.setProperty("display","flex"),Z.style.setProperty("justify-content","space-between"),Z.style.setProperty("align-items","center"),Z.style.setProperty("margin-bottom","1rem"),oe.style.setProperty("font-size","1.125rem"),oe.style.setProperty("font-weight","600"),de.$$click=h,a(Q,A(vt,{get each(){return r().actions?.[0]?.accountMappings||[]},children:(ue,ae)=>(()=>{var ye=IM(),me=ye.firstChild,pe=me.firstChild,ve=pe.firstChild,Ne=ve.nextSibling,Ie=pe.nextSibling,Ce=Ie.firstChild,Ee=Ce.nextSibling,we=me.nextSibling,Re=we.firstChild,He=Re.firstChild,je=He.nextSibling,Ve=Re.nextSibling,qe=Ve.firstChild,tt=qe.nextSibling,rt=Ve.nextSibling;return ye.style.setProperty("border","1px solid #d1d5db"),ye.style.setProperty("border-radius","0.375rem"),ye.style.setProperty("padding","1rem"),ye.style.setProperty("margin-bottom","1rem"),me.style.setProperty("display","grid"),me.style.setProperty("grid-template-columns","1fr 1fr"),me.style.setProperty("gap","1rem"),me.style.setProperty("margin-bottom","1rem"),ve.style.setProperty("display","block"),ve.style.setProperty("font-weight","500"),ve.style.setProperty("margin-bottom","0.5rem"),Ne.addEventListener("change",Be=>m(ae(),"debitAccountId",Be.currentTarget.value)),a(Ne,A(vt,{each:i,children:Be=>(()=>{var Ge=gb(),Fe=Ge.firstChild;return a(Ge,()=>Be.id,Fe),a(Ge,()=>Be.name,null),ge(()=>Ge.value=Be.id),Ge})()})),Ce.style.setProperty("display","block"),Ce.style.setProperty("font-weight","500"),Ce.style.setProperty("margin-bottom","0.5rem"),Ee.addEventListener("change",Be=>m(ae(),"creditAccountId",Be.currentTarget.value)),a(Ee,A(vt,{each:i,children:Be=>(()=>{var Ge=gb(),Fe=Ge.firstChild;return a(Ge,()=>Be.id,Fe),a(Ge,()=>Be.name,null),ge(()=>Ge.value=Be.id),Ge})()})),we.style.setProperty("display","grid"),we.style.setProperty("grid-template-columns","1fr 2fr auto"),we.style.setProperty("gap","1rem"),we.style.setProperty("align-items","end"),He.style.setProperty("display","block"),He.style.setProperty("font-weight","500"),He.style.setProperty("margin-bottom","0.5rem"),je.$$input=Be=>m(ae(),"amountExpression",Be.currentTarget.value),qe.style.setProperty("display","block"),qe.style.setProperty("font-weight","500"),qe.style.setProperty("margin-bottom","0.5rem"),tt.$$input=Be=>m(ae(),"description",Be.currentTarget.value),a(rt,(()=>{var Be=ke(()=>(r().actions?.[0]?.accountMappings?.length||0)>1);return()=>Be()&&(()=>{var Ge=fb();return Ge.$$click=()=>g(ae()),ge(Fe=>p(Ge,F,Fe)),Ge})()})()),ge(Be=>{var Ge=x,Fe=x,at=N,lt=N;return Be.e=p(Ne,Ge,Be.e),Be.t=p(Ee,Fe,Be.t),Be.a=p(je,at,Be.a),Be.o=p(tt,lt,Be.o),Be},{e:void 0,t:void 0,a:void 0,o:void 0}),ge(()=>Ne.value=ue.debitAccountId),ge(()=>Ee.value=ue.creditAccountId),ge(()=>je.value=ue.amountExpression),ge(()=>tt.value=ue.description),ye})()}),null),re.style.setProperty("display","flex"),re.style.setProperty("justify-content","flex-end"),re.style.setProperty("gap","1rem"),Cn(Y,"click",t.onCancel,!0),ce.$$click=S,a(ce,()=>e()?"Update Rule":"Create Rule"),ge(ue=>{var ae=N,ye=N,me={...N,height:"4rem",resize:"vertical"},pe=x,ve=te,Ne=te,Ie=te,Ce=K;return ue.e=p(v,ae,ue.e),ue.t=p(T,ye,ue.t),ue.a=p(X,me,ue.a),ue.o=p(_,pe,ue.o),ue.i=p(B,ve,ue.i),ue.n=p(de,Ne,ue.n),ue.s=p(Y,Ie,ue.s),ue.h=p(ce,Ce,ue.h),ue},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),ge(()=>v.value=r().name||""),ge(()=>T.value=r().priority||100),ge(()=>X.value=r().description||""),ge(()=>_.value=r().triggerEvent||""),ge(()=>G.checked=r().isActive??!0),V})()};Wt(["input","click"]);var kM=le('<div><div><h2></h2><div><div><label>Mapping Name *</label><input type=text placeholder="Enter mapping name"></div><div><label>Description</label><textarea placeholder="Describe when this mapping should be used"></textarea></div><div><label>Transaction Type *</label><select></select></div><div><div><label>Debit Account *</label><select></select></div><div><label>Credit Account *</label><select></select></div></div><div><label><input type=checkbox>Active</label></div></div><div><button>Cancel</button><button>'),NM=le("<option>"),vb=le("<option> - ");const LM=t=>{const e=()=>t.mapping&&t.mapping.id,[r,n]=Se({id:t.mapping?.id||"",name:t.mapping?.name||"",description:t.mapping?.description||"",transactionType:t.mapping?.transactionType||"cashSale",debitAccountId:t.mapping?.debitAccountId||"1001",creditAccountId:t.mapping?.creditAccountId||"4001",conditions:t.mapping?.conditions||[],isActive:t.mapping?.isActive??!0}),i=[{id:"1001",name:"Cash - Operating Account"},{id:"1002",name:"Cash - Zelle Account"},{id:"1003",name:"Cash - Credit Card Processing"},{id:"1101",name:"Accounts Receivable - Customers"},{id:"1201",name:"Inventory - Products"},{id:"1401",name:"Customs Fees Receivable"},{id:"2001",name:"Accounts Payable"},{id:"2301",name:"Sales Tax Payable"},{id:"2302",name:"Customs Fees Payable"},{id:"3001",name:"Owner's Equity"},{id:"4001",name:"Sales Revenue - Products"},{id:"4101",name:"Service Revenue - General"},{id:"4201",name:"Transport Service Revenue"},{id:"5001",name:"Cost of Goods Sold - Products"},{id:"5201",name:"Salaries and Wages"},{id:"5301",name:"Utilities Expense"}],o=[{value:"cashSale",label:"Cash Sale"},{value:"creditSale",label:"Credit Sale"},{value:"serviceRevenue",label:"Service Revenue"},{value:"transportRevenue",label:"Transport Revenue"},{value:"inventoryPurchase",label:"Inventory Purchase"},{value:"expense",label:"General Expense"},{value:"customsFees",label:"Customs Fees"},{value:"salesTax",label:"Sales Tax"}],s=(m,S)=>{n(N=>({...N,[m]:S}))},l=()=>{const m=r();if(!m.name||!m.transactionType||!m.debitAccountId||!m.creditAccountId){alert("Please fill in all required fields");return}const S={id:m.id||`mapping_${Date.now()}`,name:m.name,description:m.description||"",transactionType:m.transactionType,debitAccountId:m.debitAccountId,creditAccountId:m.creditAccountId,conditions:m.conditions||[],isActive:m.isActive??!0,createdAt:t.mapping?.createdAt||new Date,updatedAt:new Date};t.onSave(S)},c={width:"100%",padding:"0.5rem",border:"1px solid #d1d5db","border-radius":"0.375rem","font-size":"0.875rem"},d={...c,"background-color":"white"},u={padding:"0.5rem 1rem","border-radius":"0.375rem",cursor:"pointer","font-weight":"500",border:"1px solid #d1d5db"},h={...u,"background-color":"#3b82f6",color:"white",border:"none"},g={...u,"background-color":"white",color:"#374151"};return(()=>{var m=kM(),S=m.firstChild,N=S.firstChild,x=N.nextSibling,b=x.firstChild,K=b.firstChild,te=K.nextSibling,F=b.nextSibling,V=F.firstChild,W=V.nextSibling,I=F.nextSibling,E=I.firstChild,L=E.nextSibling,M=I.nextSibling,P=M.firstChild,w=P.firstChild,v=w.nextSibling,j=P.nextSibling,z=j.firstChild,T=z.nextSibling,R=M.nextSibling,J=R.firstChild,X=J.firstChild,H=x.nextSibling,se=H.firstChild,O=se.nextSibling;return m.style.setProperty("position","fixed"),m.style.setProperty("top","0"),m.style.setProperty("left","0"),m.style.setProperty("right","0"),m.style.setProperty("bottom","0"),m.style.setProperty("background-color","rgba(0, 0, 0, 0.5)"),m.style.setProperty("display","flex"),m.style.setProperty("align-items","center"),m.style.setProperty("justify-content","center"),m.style.setProperty("z-index","1000"),S.style.setProperty("background-color","white"),S.style.setProperty("border-radius","0.5rem"),S.style.setProperty("padding","2rem"),S.style.setProperty("max-width","600px"),S.style.setProperty("max-height","90vh"),S.style.setProperty("overflow-y","auto"),S.style.setProperty("width","90%"),N.style.setProperty("font-size","1.5rem"),N.style.setProperty("font-weight","700"),N.style.setProperty("margin-bottom","1.5rem"),a(N,()=>e()?"Edit Account Mapping":"Add New Account Mapping"),x.style.setProperty("margin-bottom","1.5rem"),b.style.setProperty("margin-bottom","1rem"),K.style.setProperty("display","block"),K.style.setProperty("font-weight","500"),K.style.setProperty("margin-bottom","0.5rem"),te.$$input=_=>s("name",_.currentTarget.value),F.style.setProperty("margin-bottom","1rem"),V.style.setProperty("display","block"),V.style.setProperty("font-weight","500"),V.style.setProperty("margin-bottom","0.5rem"),W.$$input=_=>s("description",_.currentTarget.value),I.style.setProperty("margin-bottom","1rem"),E.style.setProperty("display","block"),E.style.setProperty("font-weight","500"),E.style.setProperty("margin-bottom","0.5rem"),L.addEventListener("change",_=>s("transactionType",_.currentTarget.value)),a(L,A(vt,{each:o,children:_=>(()=>{var k=NM();return a(k,()=>_.label),ge(()=>k.value=_.value),k})()})),M.style.setProperty("display","grid"),M.style.setProperty("grid-template-columns","1fr 1fr"),M.style.setProperty("gap","1rem"),M.style.setProperty("margin-bottom","1rem"),w.style.setProperty("display","block"),w.style.setProperty("font-weight","500"),w.style.setProperty("margin-bottom","0.5rem"),v.addEventListener("change",_=>s("debitAccountId",_.currentTarget.value)),a(v,A(vt,{each:i,children:_=>(()=>{var k=vb(),$=k.firstChild;return a(k,()=>_.id,$),a(k,()=>_.name,null),ge(()=>k.value=_.id),k})()})),z.style.setProperty("display","block"),z.style.setProperty("font-weight","500"),z.style.setProperty("margin-bottom","0.5rem"),T.addEventListener("change",_=>s("creditAccountId",_.currentTarget.value)),a(T,A(vt,{each:i,children:_=>(()=>{var k=vb(),$=k.firstChild;return a(k,()=>_.id,$),a(k,()=>_.name,null),ge(()=>k.value=_.id),k})()})),J.style.setProperty("display","flex"),J.style.setProperty("align-items","center"),J.style.setProperty("gap","0.5rem"),X.addEventListener("change",_=>s("isActive",_.currentTarget.checked)),H.style.setProperty("display","flex"),H.style.setProperty("justify-content","flex-end"),H.style.setProperty("gap","1rem"),Cn(se,"click",t.onCancel,!0),O.$$click=l,a(O,()=>e()?"Update Mapping":"Create Mapping"),ge(_=>{var k=c,$={...c,height:"3rem",resize:"vertical"},G=d,ne=d,U=d,D=g,B=h;return _.e=p(te,k,_.e),_.t=p(W,$,_.t),_.a=p(L,G,_.a),_.o=p(v,ne,_.o),_.i=p(T,U,_.i),_.n=p(se,D,_.n),_.s=p(O,B,_.s),_},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),ge(()=>te.value=r().name||""),ge(()=>W.value=r().description||""),ge(()=>L.value=r().transactionType||""),ge(()=>v.value=r().debitAccountId||""),ge(()=>T.value=r().creditAccountId||""),ge(()=>X.checked=r().isActive??!0),m})()};Wt(["input","click"]);var RM=le("<div><div><strong>Automation Status:</strong> <span></span></div><div><strong>Active Rules:</strong> </div><div><strong>Account Mappings:</strong> </div><div><strong>Audit Logging:</strong> <span>Enabled"),DM=le("<div><div><strong>Cash Sales:</strong> Cash → Sales Revenue</div><div><strong>Credit Sales:</strong> A/R → Sales Revenue</div><div><strong>Services:</strong> Cash → Service Revenue</div><div><strong>Transport:</strong> Cash → Transport Revenue</div><div><strong>Sales Tax:</strong> Cash → Tax Payable"),gy=le("<div>"),MM=le("<div><div><h3>Active Automation Rules</h3></div><table><thead><tr><th>Rule Name</th><th>Trigger Event</th><th>Priority</th><th>Status</th><th>Actions</th></tr></thead><tbody>"),FM=le("<div>No custom account mappings configured. The system uses default mappings."),OM=le("<div><div><h3>Transaction Account Mappings"),BM=le("<table><thead><tr><th>Timestamp</th><th>Event</th><th>Rules Applied</th><th>Entries Created</th><th>Status</th></tr></thead><tbody>"),VM=le("<div><div><h3>Recent Automation Activity"),jM=le("<div><div><h1>Account Automation Configuration</h1><div><label><input type=checkbox>Enable Automation</label></div></div><div><button>Overview</button><button>Automation Rules (<!>)</button><button>Account Mappings (<!>)</button><button>Audit Log"),zM=le("<div>No recent automation activity"),qM=le("<div><div> - </div><div> - <!> rules applied"),UM=le("<tr><td><div><div></div><div></div></div></td><td></td><td></td><td><span></span></td><td><div><button></button><button>Edit</button><button>Delete"),HM=le("<table><thead><tr><th>Mapping Name</th><th>Transaction Type</th><th>Debit Account</th><th>Credit Account</th><th>Status</th><th>Actions</th></tr></thead><tbody>"),GM=le("<tr><td><div><div></div><div></div></div></td><td></td><td></td><td></td><td><span></span></td><td><div><button>Edit</button><button>Delete"),WM=le("<div>No automation activity recorded yet."),YM=le("<tr><td><div></div></td><td><div></div></td><td><div></div></td><td><div> entries</div></td><td><span>");const KM=t=>{const[e,r]=Se("overview"),[n,i]=Se(null),[o,s]=Se(null),l=F=>new Date(F).toLocaleDateString(),c=()=>{Pn.toggleAutomation(!Pn.isEnabled)},d=(F,V)=>{Pn.toggleAutomationRule(F,V)},u=F=>{confirm("Are you sure you want to delete this automation rule?")&&Pn.removeAutomationRule(F)},h=F=>{confirm("Are you sure you want to delete this account mapping?")&&Pn.removeAccountMapping(F)},g=F=>{F.id&&Pn.automationRules.find(V=>V.id===F.id)?Pn.updateAutomationRule(F.id,F):Pn.addAutomationRule(F),i(null)},m=F=>{F.id&&Pn.accountMappings.find(V=>V.id===F.id)?Pn.updateAccountMapping(F.id,F):Pn.addAccountMapping(F),s(null)},S=()=>{i(null),s(null)},N=()=>yf.getAuditLog(50),x=F=>({padding:"0.75rem 1.5rem",border:"none",background:F?"var(--primary-color)":"transparent",color:F?"white":"var(--text-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer","font-weight":"500",transition:"all 0.2s"}),b={width:"100%","border-collapse":"collapse","margin-top":"1rem"},K={"text-align":"left",padding:"0.75rem","border-bottom":"2px solid var(--border-color)","font-weight":"600","font-size":"0.875rem"},te={padding:"0.75rem","border-bottom":"1px solid var(--border-color)"};return(()=>{var F=jM(),V=F.firstChild,W=V.firstChild,I=W.nextSibling,E=I.firstChild,L=E.firstChild,M=V.nextSibling,P=M.firstChild,w=P.nextSibling,v=w.firstChild,j=v.nextSibling;j.nextSibling;var z=w.nextSibling,T=z.firstChild,R=T.nextSibling;R.nextSibling;var J=z.nextSibling;return F.style.setProperty("padding","2rem"),F.style.setProperty("max-width","1200px"),F.style.setProperty("margin","0 auto"),V.style.setProperty("display","flex"),V.style.setProperty("justify-content","space-between"),V.style.setProperty("align-items","center"),V.style.setProperty("margin-bottom","2rem"),W.style.setProperty("font-size","1.75rem"),W.style.setProperty("font-weight","bold"),I.style.setProperty("display","flex"),I.style.setProperty("gap","1rem"),I.style.setProperty("align-items","center"),E.style.setProperty("display","flex"),E.style.setProperty("align-items","center"),E.style.setProperty("gap","0.5rem"),L.addEventListener("change",c),a(I,A(Me,{get when(){return t.onClose},get children(){return A(ct,{variant:"secondary",get onClick(){return t.onClose},children:"Close"})}}),null),M.style.setProperty("display","flex"),M.style.setProperty("gap","0.5rem"),M.style.setProperty("margin-bottom","2rem"),M.style.setProperty("border-bottom","1px solid var(--border-color)"),M.style.setProperty("padding-bottom","1rem"),P.$$click=()=>r("overview"),w.$$click=()=>r("rules"),a(w,()=>Pn.automationRules.length,j),z.$$click=()=>r("mappings"),a(z,()=>Pn.accountMappings.length,R),J.$$click=()=>r("audit"),a(F,A(Me,{get when(){return e()==="overview"},get children(){var X=gy();return X.style.setProperty("display","grid"),X.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(300px, 1fr))"),X.style.setProperty("gap","1.5rem"),a(X,A(Rt,{title:"System Status",get children(){var H=RM(),se=H.firstChild,O=se.firstChild,_=O.nextSibling,k=_.nextSibling,$=se.nextSibling,G=$.firstChild;G.nextSibling;var ne=$.nextSibling,U=ne.firstChild;U.nextSibling;var D=ne.nextSibling,B=D.firstChild,Q=B.nextSibling,Z=Q.nextSibling;return H.style.setProperty("padding","1rem"),se.style.setProperty("margin-bottom","1rem"),k.style.setProperty("font-weight","600"),a(k,()=>Pn.isEnabled?"Enabled":"Disabled"),$.style.setProperty("margin-bottom","1rem"),a($,()=>Pn.automationRules.length,null),ne.style.setProperty("margin-bottom","1rem"),a(ne,()=>Pn.accountMappings.length,null),Z.style.setProperty("color","#10b981"),Z.style.setProperty("font-weight","600"),ge(oe=>(oe=Pn.isEnabled?"#10b981":"#ef4444")!=null?k.style.setProperty("color",oe):k.style.removeProperty("color")),H}}),null),a(X,A(Rt,{title:"Default Account Mappings",get children(){var H=DM(),se=H.firstChild,O=se.nextSibling,_=O.nextSibling,k=_.nextSibling;return H.style.setProperty("padding","1rem"),H.style.setProperty("font-size","0.875rem"),se.style.setProperty("margin-bottom","0.5rem"),O.style.setProperty("margin-bottom","0.5rem"),_.style.setProperty("margin-bottom","0.5rem"),k.style.setProperty("margin-bottom","0.5rem"),H}}),null),a(X,A(Rt,{title:"Recent Activity",get children(){var H=gy();return H.style.setProperty("padding","1rem"),a(H,A(Me,{get when(){return N().length>0},get fallback(){return(()=>{var se=zM();return se.style.setProperty("color","var(--text-secondary)"),se.style.setProperty("font-style","italic"),se})()},get children(){return A(vt,{get each(){return N().slice(0,5)},children:se=>(()=>{var O=qM(),_=O.firstChild,k=_.firstChild,$=_.nextSibling,G=$.firstChild,ne=G.nextSibling;return ne.nextSibling,O.style.setProperty("margin-bottom","0.75rem"),O.style.setProperty("padding-bottom","0.75rem"),O.style.setProperty("border-bottom","1px solid var(--border-color)"),O.style.setProperty("font-size","0.875rem"),_.style.setProperty("font-weight","600"),a(_,()=>se.event,k),a(_,()=>se.success?"Success":"Failed",null),$.style.setProperty("color","var(--text-secondary)"),a($,()=>l(se.timestamp),G),a($,()=>se.rulesApplied.length,ne),ge(U=>(U=se.success?"#10b981":"#ef4444")!=null?_.style.setProperty("color",U):_.style.removeProperty("color")),O})()})}})),H}}),null),X}}),null),a(F,A(Me,{get when(){return e()==="rules"},get children(){return A(Rt,{title:"Automation Rules",get children(){var X=MM(),H=X.firstChild;H.firstChild;var se=H.nextSibling,O=se.firstChild,_=O.firstChild,k=_.firstChild,$=k.nextSibling,G=$.nextSibling,ne=G.nextSibling,U=ne.nextSibling,D=O.nextSibling;return X.style.setProperty("padding","1rem"),H.style.setProperty("margin-bottom","1rem"),H.style.setProperty("display","flex"),H.style.setProperty("justify-content","space-between"),a(H,A(ct,{variant:"primary",onClick:()=>i({}),children:"Add New Rule"}),null),a(D,A(vt,{get each(){return Pn.automationRules},children:B=>(()=>{var Q=UM(),Z=Q.firstChild,oe=Z.firstChild,de=oe.firstChild,re=de.nextSibling,Y=Z.nextSibling,ce=Y.nextSibling,ue=ce.nextSibling,ae=ue.firstChild,ye=ue.nextSibling,me=ye.firstChild,pe=me.firstChild,ve=pe.nextSibling,Ne=ve.nextSibling;return de.style.setProperty("font-weight","600"),a(de,()=>B.name),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-secondary)"),a(re,()=>B.description),a(Y,()=>B.triggerEvent),a(ce,()=>B.priority),ae.style.setProperty("font-weight","600"),a(ae,()=>B.isActive?"Active":"Inactive"),me.style.setProperty("display","flex"),me.style.setProperty("gap","0.5rem"),pe.$$click=()=>d(B.id,!B.isActive),pe.style.setProperty("padding","0.25rem 0.5rem"),pe.style.setProperty("font-size","0.75rem"),pe.style.setProperty("border","none"),pe.style.setProperty("border-radius","4px"),pe.style.setProperty("color","white"),pe.style.setProperty("cursor","pointer"),a(pe,()=>B.isActive?"Disable":"Enable"),ve.$$click=()=>i(B),ve.style.setProperty("padding","0.25rem 0.5rem"),ve.style.setProperty("font-size","0.75rem"),ve.style.setProperty("border","1px solid var(--border-color)"),ve.style.setProperty("border-radius","4px"),ve.style.setProperty("background","white"),ve.style.setProperty("cursor","pointer"),Ne.$$click=()=>u(B.id),Ne.style.setProperty("padding","0.25rem 0.5rem"),Ne.style.setProperty("font-size","0.75rem"),Ne.style.setProperty("border","none"),Ne.style.setProperty("border-radius","4px"),Ne.style.setProperty("background","#ef4444"),Ne.style.setProperty("color","white"),Ne.style.setProperty("cursor","pointer"),ge(Ie=>{var Ce=te,Ee=te,we=te,Re=te,He=B.isActive?"#10b981":"#ef4444",je=te,Ve=B.isActive?"#ef4444":"#10b981";return Ie.e=p(Z,Ce,Ie.e),Ie.t=p(Y,Ee,Ie.t),Ie.a=p(ce,we,Ie.a),Ie.o=p(ue,Re,Ie.o),He!==Ie.i&&((Ie.i=He)!=null?ae.style.setProperty("color",He):ae.style.removeProperty("color")),Ie.n=p(ye,je,Ie.n),Ve!==Ie.s&&((Ie.s=Ve)!=null?pe.style.setProperty("background",Ve):pe.style.removeProperty("background")),Ie},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),Q})()})),ge(B=>{var Q=b,Z=K,oe=K,de=K,re=K,Y=K;return B.e=p(se,Q,B.e),B.t=p(k,Z,B.t),B.a=p($,oe,B.a),B.o=p(G,de,B.o),B.i=p(ne,re,B.i),B.n=p(U,Y,B.n),B},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),X}})}}),null),a(F,A(Me,{get when(){return e()==="mappings"},get children(){return A(Rt,{title:"Account Mappings",get children(){var X=OM(),H=X.firstChild;return H.firstChild,X.style.setProperty("padding","1rem"),H.style.setProperty("margin-bottom","1rem"),H.style.setProperty("display","flex"),H.style.setProperty("justify-content","space-between"),a(H,A(ct,{variant:"primary",onClick:()=>s({}),children:"Add New Mapping"}),null),a(X,A(Me,{get when(){return Pn.accountMappings.length===0},get fallback(){return(()=>{var se=HM(),O=se.firstChild,_=O.firstChild,k=_.firstChild,$=k.nextSibling,G=$.nextSibling,ne=G.nextSibling,U=ne.nextSibling,D=U.nextSibling,B=O.nextSibling;return a(B,A(vt,{get each(){return Pn.accountMappings},children:Q=>(()=>{var Z=GM(),oe=Z.firstChild,de=oe.firstChild,re=de.firstChild,Y=re.nextSibling,ce=oe.nextSibling,ue=ce.nextSibling,ae=ue.nextSibling,ye=ae.nextSibling,me=ye.firstChild,pe=ye.nextSibling,ve=pe.firstChild,Ne=ve.firstChild,Ie=Ne.nextSibling;return re.style.setProperty("font-weight","600"),a(re,()=>Q.name),Y.style.setProperty("font-size","0.875rem"),Y.style.setProperty("color","var(--text-secondary)"),a(Y,()=>Q.description),a(ce,()=>Q.transactionType),a(ue,()=>Q.debitAccountId),a(ae,()=>Q.creditAccountId),me.style.setProperty("font-weight","600"),a(me,()=>Q.isActive?"Active":"Inactive"),ve.style.setProperty("display","flex"),ve.style.setProperty("gap","0.5rem"),Ne.$$click=()=>s(Q),Ne.style.setProperty("padding","0.25rem 0.5rem"),Ne.style.setProperty("font-size","0.75rem"),Ne.style.setProperty("border","1px solid var(--border-color)"),Ne.style.setProperty("border-radius","4px"),Ne.style.setProperty("background","white"),Ne.style.setProperty("cursor","pointer"),Ie.$$click=()=>h(Q.id),Ie.style.setProperty("padding","0.25rem 0.5rem"),Ie.style.setProperty("font-size","0.75rem"),Ie.style.setProperty("border","none"),Ie.style.setProperty("border-radius","4px"),Ie.style.setProperty("background","#ef4444"),Ie.style.setProperty("color","white"),Ie.style.setProperty("cursor","pointer"),ge(Ce=>{var Ee=te,we=te,Re=te,He=te,je=te,Ve=Q.isActive?"#10b981":"#ef4444",qe=te;return Ce.e=p(oe,Ee,Ce.e),Ce.t=p(ce,we,Ce.t),Ce.a=p(ue,Re,Ce.a),Ce.o=p(ae,He,Ce.o),Ce.i=p(ye,je,Ce.i),Ve!==Ce.n&&((Ce.n=Ve)!=null?me.style.setProperty("color",Ve):me.style.removeProperty("color")),Ce.s=p(pe,qe,Ce.s),Ce},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),Z})()})),ge(Q=>{var Z=b,oe=K,de=K,re=K,Y=K,ce=K,ue=K;return Q.e=p(se,Z,Q.e),Q.t=p(k,oe,Q.t),Q.a=p($,de,Q.a),Q.o=p(G,re,Q.o),Q.i=p(ne,Y,Q.i),Q.n=p(U,ce,Q.n),Q.s=p(D,ue,Q.s),Q},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),se})()},get children(){var se=FM();return se.style.setProperty("text-align","center"),se.style.setProperty("color","var(--text-secondary)"),se.style.setProperty("font-style","italic"),se.style.setProperty("padding","2rem"),se}}),null),X}})}}),null),a(F,A(Me,{get when(){return e()==="audit"},get children(){return A(Rt,{title:"Automation Audit Log",get children(){var X=VM(),H=X.firstChild;return H.firstChild,X.style.setProperty("padding","1rem"),H.style.setProperty("margin-bottom","1rem"),H.style.setProperty("display","flex"),H.style.setProperty("justify-content","space-between"),a(H,A(ct,{variant:"outline",onClick:()=>yf.clearAuditLog(),children:"Clear Log"}),null),a(X,A(Me,{get when(){return N().length>0},get fallback(){return(()=>{var se=WM();return se.style.setProperty("text-align","center"),se.style.setProperty("color","var(--text-secondary)"),se.style.setProperty("font-style","italic"),se.style.setProperty("padding","2rem"),se})()},get children(){var se=BM(),O=se.firstChild,_=O.firstChild,k=_.firstChild,$=k.nextSibling,G=$.nextSibling,ne=G.nextSibling,U=ne.nextSibling,D=O.nextSibling;return a(D,A(vt,{get each(){return N()},children:B=>(()=>{var Q=YM(),Z=Q.firstChild,oe=Z.firstChild,de=Z.nextSibling,re=de.firstChild,Y=de.nextSibling,ce=Y.firstChild,ue=Y.nextSibling,ae=ue.firstChild,ye=ae.firstChild,me=ue.nextSibling,pe=me.firstChild;return oe.style.setProperty("font-size","0.875rem"),a(oe,()=>l(B.timestamp)),re.style.setProperty("font-weight","600"),a(re,()=>B.event),ce.style.setProperty("font-size","0.875rem"),a(ce,()=>B.rulesApplied.join(", ")||"None"),ae.style.setProperty("font-size","0.875rem"),a(ae,()=>B.entriesCreated.length,ye),pe.style.setProperty("font-weight","600"),a(pe,()=>B.success?"Success":"Failed"),a(me,A(Me,{get when(){return B.error},get children(){var ve=gy();return ve.style.setProperty("font-size","0.75rem"),ve.style.setProperty("color","#ef4444"),a(ve,()=>B.error),ve}}),null),ge(ve=>{var Ne=te,Ie=te,Ce=te,Ee=te,we=te,Re=B.success?"#10b981":"#ef4444";return ve.e=p(Z,Ne,ve.e),ve.t=p(de,Ie,ve.t),ve.a=p(Y,Ce,ve.a),ve.o=p(ue,Ee,ve.o),ve.i=p(me,we,ve.i),Re!==ve.n&&((ve.n=Re)!=null?pe.style.setProperty("color",Re):pe.style.removeProperty("color")),ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),Q})()})),ge(B=>{var Q=b,Z=K,oe=K,de=K,re=K,Y=K;return B.e=p(se,Q,B.e),B.t=p(k,Z,B.t),B.a=p($,oe,B.a),B.o=p(G,de,B.o),B.i=p(ne,re,B.i),B.n=p(U,Y,B.n),B},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),se}}),null),X}})}}),null),a(F,A(Me,{get when(){return n()},get children(){return A(TM,{get rule(){return n()},onSave:g,onCancel:S})}}),null),a(F,A(Me,{get when(){return o()},get children(){return A(LM,{get mapping(){return o()},onSave:m,onCancel:S})}}),null),ge(X=>{var H=x(e()==="overview"),se=x(e()==="rules"),O=x(e()==="mappings"),_=x(e()==="audit");return X.e=p(P,H,X.e),X.t=p(w,se,X.t),X.a=p(z,O,X.a),X.o=p(J,_,X.o),X},{e:void 0,t:void 0,a:void 0,o:void 0}),ge(()=>L.checked=Pn.isEnabled),F})()};Wt(["click"]);class QM{async createCustomEntry(e){const{type:r,description:n,reference:i,date:o,entries:s,postImmediately:l=!1}=e,c=s.reduce((m,S)=>m+S.amount,0),d=s.reduce((m,S)=>m+S.amount,0),u=s.flatMap(m=>[{id:`line_${Date.now()}_${Math.random()}`,accountId:m.debitAccountId,accountName:this.getAccountName(m.debitAccountId),description:m.description||n,debitAmount:m.amount,creditAmount:0},{id:`line_${Date.now()}_${Math.random()}`,accountId:m.creditAccountId,accountName:this.getAccountName(m.creditAccountId),description:m.description||n,debitAmount:0,creditAmount:m.amount}]),h={entryNumber:dn.getNextEntryNumber(),date:o||new Date().toISOString().split("T")[0],description:`${n} (Manual)`,reference:i||`MANUAL-${Date.now()}`,status:"draft",createdBy:"manual-automation",createdAt:new Date().toISOString(),totalDebit:c,totalCredit:d,lines:u},g=await dn.addJournalEntry(h);return l&&dn.postJournalEntry(g),g}async createQuickTransaction(e){const{transactionType:r,amount:n,description:i,reference:o,customAccounts:s,paymentMethod:l="cash",postImmediately:c=!1}=e;let d,u;if(r==="custom"&&s)d=s.debitAccountId,u=s.creditAccountId;else{const h=this.getAccountsForTransaction(r,l);d=h.debitAccountId,u=h.creditAccountId}return this.createCustomEntry({type:"manual_entry",description:i,reference:o,entries:[{debitAccountId:d,creditAccountId:u,amount:n,description:i}],postImmediately:c})}async createBankTransfer(e){const{fromAccountId:r,toAccountId:n,amount:i,description:o,reference:s,postImmediately:l=!1}=e;return this.createCustomEntry({type:"transfer",description:`Bank Transfer: ${o}`,reference:s||`XFER-${Date.now()}`,entries:[{debitAccountId:n,creditAccountId:r,amount:i,description:o}],postImmediately:l})}async createAdjustment(e){const{accountId:r,adjustmentAccountId:n,amount:i,type:o,description:s,reference:l,postImmediately:c=!1}=e,d=this.isDebitIncreaseAccount(r);let u,h;return o==="increase"&&d||o==="decrease"&&!d?(u=r,h=n):(u=n,h=r),this.createCustomEntry({type:"adjustment",description:`Adjustment: ${s}`,reference:l||`ADJ-${Date.now()}`,entries:[{debitAccountId:u,creditAccountId:h,amount:i,description:s}],postImmediately:c})}async createComplexTransaction(e){const{description:r,reference:n,date:i,entries:o,postImmediately:s=!1}=e,l=o.filter(S=>S.type==="debit"),c=o.filter(S=>S.type==="credit"),d=l.reduce((S,N)=>S+N.amount,0),u=c.reduce((S,N)=>S+N.amount,0);if(Math.abs(d-u)>.01)throw new Error(`Transaction not balanced. Debits: ${d}, Credits: ${u}`);const h=[...l.map(S=>({id:`line_${Date.now()}_${Math.random()}`,accountId:S.accountId,accountName:this.getAccountName(S.accountId),description:S.description||r,debitAmount:S.amount,creditAmount:0})),...c.map(S=>({id:`line_${Date.now()}_${Math.random()}`,accountId:S.accountId,accountName:this.getAccountName(S.accountId),description:S.description||r,debitAmount:0,creditAmount:S.amount}))],g={entryNumber:dn.getNextEntryNumber(),date:i||new Date().toISOString().split("T")[0],description:`${r} (Complex)`,reference:n||`COMPLEX-${Date.now()}`,status:"draft",createdBy:"manual-automation",createdAt:new Date().toISOString(),totalDebit:d,totalCredit:u,lines:h},m=await dn.addJournalEntry(g);return s&&dn.postJournalEntry(m),m}getAccountsForTransaction(e,r){const i={cash_sale:{cash:{debitAccountId:"1001",creditAccountId:"4001"},zelle:{debitAccountId:"1002",creditAccountId:"4001"},credit_card:{debitAccountId:"1003",creditAccountId:"4001"}},credit_sale:{default:{debitAccountId:"1101",creditAccountId:"4001"}},expense_payment:{cash:{debitAccountId:"5201",creditAccountId:"1001"},check:{debitAccountId:"5201",creditAccountId:"1001"}},customer_payment:{cash:{debitAccountId:"1001",creditAccountId:"1101"},zelle:{debitAccountId:"1002",creditAccountId:"1101"},credit_card:{debitAccountId:"1003",creditAccountId:"1101"}}}[e];if(!i)throw new Error(`Unknown transaction type: ${e}`);return i[r]||i.default||i[Object.keys(i)[0]]}isDebitIncreaseAccount(e){const r=e.charAt(0);return r==="1"||r==="5"}getAccountName(e){return{1001:"Cash - Operating Account",1002:"Cash - Zelle Account",1003:"Cash - Credit Card Processing",1101:"Accounts Receivable - Customers",1102:"Accounts Receivable - Freight Charges",1201:"Inventory - Products",1202:"Inventory - Packaging Materials",1301:"Prepaid Expenses",1401:"Customs Fees Receivable",1402:"Transit Insurance Receivable",2001:"Accounts Payable",2002:"Freight Payable",2101:"Accrued Salaries",2102:"Accrued Rent",2301:"Sales Tax Payable",2302:"Customs Fees Payable",2303:"Transit Insurance Payable",3001:"Owner's Equity",3101:"Retained Earnings",4001:"Sales Revenue - Products",4101:"Service Revenue - General",4201:"Transport Service Revenue",4202:"Freight Revenue - Air",4203:"Freight Revenue - Sea",4301:"Processing Revenue - Packaging",4302:"Processing Revenue - Storage",5001:"Cost of Goods Sold - Products",5002:"Cost of Goods Sold - Packaging",5101:"Freight Expense - Air",5102:"Freight Expense - Sea",5103:"Local Transport Expense",5201:"Salaries and Wages",5202:"Rent Expense - Office",5203:"Rent Expense - Warehouse",5301:"Utilities Expense",5302:"Insurance Expense",5303:"Office Supplies",5401:"Professional Fees",5402:"Bank Fees",5403:"Credit Card Processing Fees",5501:"Vehicle Expenses",5502:"Equipment Maintenance",5601:"Depreciation Expense"}[e]||`Account ${e}`}getAvailableAccounts(){return[{id:"1001",name:"Cash - Operating Account",type:"Asset"},{id:"1002",name:"Cash - Zelle Account",type:"Asset"},{id:"1003",name:"Cash - Credit Card Processing",type:"Asset"},{id:"1101",name:"Accounts Receivable - Customers",type:"Asset"},{id:"1102",name:"Accounts Receivable - Freight Charges",type:"Asset"},{id:"1201",name:"Inventory - Products",type:"Asset"},{id:"1202",name:"Inventory - Packaging Materials",type:"Asset"},{id:"1301",name:"Prepaid Expenses",type:"Asset"},{id:"1401",name:"Customs Fees Receivable",type:"Asset"},{id:"1402",name:"Transit Insurance Receivable",type:"Asset"},{id:"2001",name:"Accounts Payable",type:"Liability"},{id:"2002",name:"Freight Payable",type:"Liability"},{id:"2101",name:"Accrued Salaries",type:"Liability"},{id:"2102",name:"Accrued Rent",type:"Liability"},{id:"2301",name:"Sales Tax Payable",type:"Liability"},{id:"2302",name:"Customs Fees Payable",type:"Liability"},{id:"2303",name:"Transit Insurance Payable",type:"Liability"},{id:"3001",name:"Owner's Equity",type:"Equity"},{id:"3101",name:"Retained Earnings",type:"Equity"},{id:"4001",name:"Sales Revenue - Products",type:"Revenue"},{id:"4101",name:"Service Revenue - General",type:"Revenue"},{id:"4201",name:"Transport Service Revenue",type:"Revenue"},{id:"4202",name:"Freight Revenue - Air",type:"Revenue"},{id:"4203",name:"Freight Revenue - Sea",type:"Revenue"},{id:"4301",name:"Processing Revenue - Packaging",type:"Revenue"},{id:"4302",name:"Processing Revenue - Storage",type:"Revenue"},{id:"5001",name:"Cost of Goods Sold - Products",type:"Expense"},{id:"5002",name:"Cost of Goods Sold - Packaging",type:"Expense"},{id:"5101",name:"Freight Expense - Air",type:"Expense"},{id:"5102",name:"Freight Expense - Sea",type:"Expense"},{id:"5103",name:"Local Transport Expense",type:"Expense"},{id:"5201",name:"Salaries and Wages",type:"Expense"},{id:"5202",name:"Rent Expense - Office",type:"Expense"},{id:"5203",name:"Rent Expense - Warehouse",type:"Expense"},{id:"5301",name:"Utilities Expense",type:"Expense"},{id:"5302",name:"Insurance Expense",type:"Expense"},{id:"5303",name:"Office Supplies",type:"Expense"},{id:"5401",name:"Professional Fees",type:"Expense"},{id:"5402",name:"Bank Fees",type:"Expense"},{id:"5403",name:"Credit Card Processing Fees",type:"Expense"},{id:"5501",name:"Vehicle Expenses",type:"Expense"},{id:"5502",name:"Equipment Maintenance",type:"Expense"},{id:"5601",name:"Depreciation Expense",type:"Expense"}]}getTransactionTemplates(){return[{id:"cash_sale",name:"Cash Sale",description:"Record a cash sale transaction",type:"cash_sale"},{id:"zelle_sale",name:"Zelle Sale",description:"Record a sale paid via Zelle",type:"cash_sale"},{id:"credit_sale",name:"Credit Sale",description:"Record a sale on credit (accounts receivable)",type:"credit_sale"},{id:"customer_payment",name:"Customer Payment",description:"Record payment received from customer",type:"customer_payment"},{id:"freight_expense",name:"Freight Expense",description:"Record freight/shipping costs",type:"custom",defaultAccounts:{debitAccountId:"5101",creditAccountId:"1001"}},{id:"salary_payment",name:"Salary Payment",description:"Record salary/wage payments",type:"expense_payment"},{id:"rent_payment",name:"Rent Payment",description:"Record monthly rent payment",type:"custom",defaultAccounts:{debitAccountId:"5202",creditAccountId:"1001"}},{id:"bank_transfer",name:"Bank Transfer",description:"Transfer funds between bank accounts",type:"custom"}]}}const fh=new QM;var JM=le('<div><h3>Quick Transactions</h3><div><label>Use Template:</label><select><option value>Select a template...</option></select></div><div><div><label>Transaction Type:</label><select><option value=cash_sale>Cash Sale</option><option value=credit_sale>Credit Sale</option><option value=expense_payment>Expense Payment</option><option value=customer_payment>Customer Payment</option><option value=custom>Custom</option></select></div><div><label>Payment Method:</label><select><option value=cash>Cash</option><option value=zelle>Zelle</option><option value=credit_card>Credit Card</option><option value=check>Check</option></select></div></div><div><label>Amount:</label><input type=number step=0.01></div><div><label>Description:</label><input type=text placeholder="Enter transaction description"></div><div><label>Reference (Optional):</label><input type=text placeholder="Invoice number, receipt, etc."></div><div><label><input type=checkbox>Post immediately (skip draft status)</label></div><button>'),XM=le('<div><h3>Custom Journal Entries</h3><div><div><label>Entry Type:</label><select><option value=manual_entry>Manual Entry</option><option value=transfer>Transfer</option><option value=adjustment>Adjustment</option><option value=payment>Payment</option><option value=receipt>Receipt</option></select></div><div><label>Date:</label><input type=date></div></div><div><label>Description:</label><input type=text placeholder="Enter entry description"></div><div><label>Reference (Optional):</label><input type=text placeholder="Reference number or code"></div><div><div><h4>Entry Lines:</h4><button>Add Line</button></div></div><div><label><input type=checkbox>Post immediately (skip draft status)</label></div><button>'),ZM=le("<div><div><h2>Custom Automation Panel</h2><p>Create manual journal entries with custom parameters on-demand.</p><div><button>Quick Transactions</button><button>Custom Entries"),bb=le("<div>"),eF=le("<option>"),tF=le('<div><div><div><label>Debit Account:</label><select></select></div><div><label>Credit Account:</label><select></select></div></div><div><div><label>Amount:</label><input type=number step=0.01></div><div><label>Line Description (Optional):</label><input type=text placeholder="Specific line description"></div><div>'),Pb=le("<option> - "),rF=le("<button>Remove");const nF=()=>{const[t,e]=Se("quick"),[r,n]=Se(!1),[i,o]=Se(""),[s,l]=Se(""),[c,d]=Se({transactionType:"cash_sale",amount:0,description:"",reference:"",paymentMethod:"cash",postImmediately:!1}),[u,h]=Se({type:"manual_entry",description:"",reference:"",date:new Date().toISOString().split("T")[0],entries:[{debitAccountId:"1001",creditAccountId:"4001",amount:0,description:""}],postImmediately:!1}),g=Nt(()=>fh.getAvailableAccounts()),m=Nt(()=>fh.getTransactionTemplates()),S=()=>{o(""),l("")},N=async()=>{n(!0),S();try{const L=await fh.createQuickTransaction(c());o(`Transaction created successfully! Entry ID: ${L}`),d({transactionType:"cash_sale",amount:0,description:"",reference:"",paymentMethod:"cash",postImmediately:!1})}catch(L){l(L instanceof Error?L.message:"Failed to create transaction")}finally{n(!1)}},x=async()=>{n(!0),S();try{const L=await fh.createCustomEntry(u());o(`Custom entry created successfully! Entry ID: ${L}`),h({type:"manual_entry",description:"",reference:"",date:new Date().toISOString().split("T")[0],entries:[{debitAccountId:"1001",creditAccountId:"4001",amount:0,description:""}],postImmediately:!1})}catch(L){l(L instanceof Error?L.message:"Failed to create entry")}finally{n(!1)}},b=L=>{const M=m().find(P=>P.id===L);M&&d(P=>({...P,transactionType:M.type,description:M.description}))},K=()=>{h(L=>({...L,entries:[...L.entries,{debitAccountId:"1001",creditAccountId:"4001",amount:0,description:""}]}))},te=L=>{h(M=>({...M,entries:M.entries.filter((P,w)=>w!==L)}))},F=(L,M,P)=>{h(w=>({...w,entries:w.entries.map((v,j)=>j===L?{...v,[M]:P}:v)}))},V=L=>({padding:"0.5rem 1rem",border:"none","background-color":L?"#3b82f6":"#e5e7eb",color:L?"white":"#374151","border-radius":"0.375rem",cursor:"pointer","font-weight":L?"600":"400"}),W={width:"100%",padding:"0.5rem",border:"1px solid #d1d5db","border-radius":"0.375rem","font-size":"0.875rem"},I={...W,"background-color":"white"},E={padding:"0.5rem 1rem","background-color":"#3b82f6",color:"white",border:"none","border-radius":"0.375rem",cursor:"pointer","font-weight":"500","disabled:opacity":"0.5","disabled:cursor":"not-allowed"};return(()=>{var L=ZM(),M=L.firstChild,P=M.firstChild,w=P.nextSibling,v=w.nextSibling,j=v.firstChild,z=j.nextSibling;return L.style.setProperty("max-width","800px"),L.style.setProperty("margin","0 auto"),L.style.setProperty("padding","1rem"),M.style.setProperty("margin-bottom","2rem"),P.style.setProperty("font-size","1.5rem"),P.style.setProperty("font-weight","700"),P.style.setProperty("margin-bottom","1rem"),w.style.setProperty("color","#6b7280"),w.style.setProperty("margin-bottom","1.5rem"),v.style.setProperty("display","flex"),v.style.setProperty("gap","0.5rem"),v.style.setProperty("margin-bottom","2rem"),j.$$click=()=>e("quick"),z.$$click=()=>e("custom"),a(M,(()=>{var T=ke(()=>!!i());return()=>T()&&(()=>{var R=bb();return R.style.setProperty("padding","0.75rem"),R.style.setProperty("background-color","#d1fae5"),R.style.setProperty("color","#047857"),R.style.setProperty("border-radius","0.375rem"),R.style.setProperty("margin-bottom","1rem"),a(R,i),R})()})(),null),a(M,(()=>{var T=ke(()=>!!s());return()=>T()&&(()=>{var R=bb();return R.style.setProperty("padding","0.75rem"),R.style.setProperty("background-color","#fef2f2"),R.style.setProperty("color","#dc2626"),R.style.setProperty("border-radius","0.375rem"),R.style.setProperty("margin-bottom","1rem"),a(R,s),R})()})(),null),a(M,A(Me,{get when(){return t()==="quick"},get children(){var T=JM(),R=T.firstChild,J=R.nextSibling,X=J.firstChild,H=X.nextSibling;H.firstChild;var se=J.nextSibling,O=se.firstChild,_=O.firstChild,k=_.nextSibling,$=O.nextSibling,G=$.firstChild,ne=G.nextSibling,U=se.nextSibling,D=U.firstChild,B=D.nextSibling,Q=U.nextSibling,Z=Q.firstChild,oe=Z.nextSibling,de=Q.nextSibling,re=de.firstChild,Y=re.nextSibling,ce=de.nextSibling,ue=ce.firstChild,ae=ue.firstChild,ye=ce.nextSibling;return R.style.setProperty("font-size","1.25rem"),R.style.setProperty("font-weight","600"),R.style.setProperty("margin-bottom","1rem"),J.style.setProperty("margin-bottom","1.5rem"),X.style.setProperty("display","block"),X.style.setProperty("font-weight","500"),X.style.setProperty("margin-bottom","0.5rem"),H.addEventListener("change",me=>b(me.currentTarget.value)),a(H,A(vt,{get each(){return m()},children:me=>(()=>{var pe=eF();return a(pe,()=>me.name),ge(()=>pe.value=me.id),pe})()}),null),se.style.setProperty("display","grid"),se.style.setProperty("grid-template-columns","1fr 1fr"),se.style.setProperty("gap","1rem"),se.style.setProperty("margin-bottom","1rem"),_.style.setProperty("display","block"),_.style.setProperty("font-weight","500"),_.style.setProperty("margin-bottom","0.5rem"),k.addEventListener("change",me=>d(pe=>({...pe,transactionType:me.currentTarget.value}))),G.style.setProperty("display","block"),G.style.setProperty("font-weight","500"),G.style.setProperty("margin-bottom","0.5rem"),ne.addEventListener("change",me=>d(pe=>({...pe,paymentMethod:me.currentTarget.value}))),U.style.setProperty("margin-bottom","1rem"),D.style.setProperty("display","block"),D.style.setProperty("font-weight","500"),D.style.setProperty("margin-bottom","0.5rem"),B.$$input=me=>d(pe=>({...pe,amount:parseFloat(me.currentTarget.value)||0})),Q.style.setProperty("margin-bottom","1rem"),Z.style.setProperty("display","block"),Z.style.setProperty("font-weight","500"),Z.style.setProperty("margin-bottom","0.5rem"),oe.$$input=me=>d(pe=>({...pe,description:me.currentTarget.value})),de.style.setProperty("margin-bottom","1rem"),re.style.setProperty("display","block"),re.style.setProperty("font-weight","500"),re.style.setProperty("margin-bottom","0.5rem"),Y.$$input=me=>d(pe=>({...pe,reference:me.currentTarget.value})),ce.style.setProperty("margin-bottom","1.5rem"),ue.style.setProperty("display","flex"),ue.style.setProperty("align-items","center"),ue.style.setProperty("gap","0.5rem"),ae.addEventListener("change",me=>d(pe=>({...pe,postImmediately:me.currentTarget.checked}))),ye.$$click=N,a(ye,()=>r()?"Creating...":"Create Quick Transaction"),ge(me=>{var pe=I,ve=I,Ne=I,Ie=W,Ce=W,Ee=W,we=E,Re=r()||!c().description||c().amount<=0;return me.e=p(H,pe,me.e),me.t=p(k,ve,me.t),me.a=p(ne,Ne,me.a),me.o=p(B,Ie,me.o),me.i=p(oe,Ce,me.i),me.n=p(Y,Ee,me.n),me.s=p(ye,we,me.s),Re!==me.h&&(ye.disabled=me.h=Re),me},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),ge(()=>k.value=c().transactionType),ge(()=>ne.value=c().paymentMethod),ge(()=>B.value=c().amount),ge(()=>oe.value=c().description),ge(()=>Y.value=c().reference),ge(()=>ae.checked=c().postImmediately),T}}),null),a(M,A(Me,{get when(){return t()==="custom"},get children(){var T=XM(),R=T.firstChild,J=R.nextSibling,X=J.firstChild,H=X.firstChild,se=H.nextSibling,O=X.nextSibling,_=O.firstChild,k=_.nextSibling,$=J.nextSibling,G=$.firstChild,ne=G.nextSibling,U=$.nextSibling,D=U.firstChild,B=D.nextSibling,Q=U.nextSibling,Z=Q.firstChild,oe=Z.firstChild,de=oe.nextSibling,re=Q.nextSibling,Y=re.firstChild,ce=Y.firstChild,ue=re.nextSibling;return R.style.setProperty("font-size","1.25rem"),R.style.setProperty("font-weight","600"),R.style.setProperty("margin-bottom","1rem"),J.style.setProperty("display","grid"),J.style.setProperty("grid-template-columns","1fr 1fr"),J.style.setProperty("gap","1rem"),J.style.setProperty("margin-bottom","1rem"),H.style.setProperty("display","block"),H.style.setProperty("font-weight","500"),H.style.setProperty("margin-bottom","0.5rem"),se.addEventListener("change",ae=>h(ye=>({...ye,type:ae.currentTarget.value}))),_.style.setProperty("display","block"),_.style.setProperty("font-weight","500"),_.style.setProperty("margin-bottom","0.5rem"),k.$$input=ae=>h(ye=>({...ye,date:ae.currentTarget.value})),$.style.setProperty("margin-bottom","1rem"),G.style.setProperty("display","block"),G.style.setProperty("font-weight","500"),G.style.setProperty("margin-bottom","0.5rem"),ne.$$input=ae=>h(ye=>({...ye,description:ae.currentTarget.value})),U.style.setProperty("margin-bottom","1.5rem"),D.style.setProperty("display","block"),D.style.setProperty("font-weight","500"),D.style.setProperty("margin-bottom","0.5rem"),B.$$input=ae=>h(ye=>({...ye,reference:ae.currentTarget.value})),Q.style.setProperty("margin-bottom","1.5rem"),Z.style.setProperty("display","flex"),Z.style.setProperty("justify-content","space-between"),Z.style.setProperty("align-items","center"),Z.style.setProperty("margin-bottom","1rem"),oe.style.setProperty("font-size","1rem"),oe.style.setProperty("font-weight","600"),de.$$click=K,a(Q,A(vt,{get each(){return u().entries},children:(ae,ye)=>(()=>{var me=tF(),pe=me.firstChild,ve=pe.firstChild,Ne=ve.firstChild,Ie=Ne.nextSibling,Ce=ve.nextSibling,Ee=Ce.firstChild,we=Ee.nextSibling,Re=pe.nextSibling,He=Re.firstChild,je=He.firstChild,Ve=je.nextSibling,qe=He.nextSibling,tt=qe.firstChild,rt=tt.nextSibling,Be=qe.nextSibling;return me.style.setProperty("border","1px solid #d1d5db"),me.style.setProperty("border-radius","0.375rem"),me.style.setProperty("padding","1rem"),me.style.setProperty("margin-bottom","1rem"),pe.style.setProperty("display","grid"),pe.style.setProperty("grid-template-columns","1fr 1fr"),pe.style.setProperty("gap","1rem"),pe.style.setProperty("margin-bottom","1rem"),Ne.style.setProperty("display","block"),Ne.style.setProperty("font-weight","500"),Ne.style.setProperty("margin-bottom","0.5rem"),Ie.addEventListener("change",Ge=>F(ye(),"debitAccountId",Ge.currentTarget.value)),a(Ie,A(vt,{get each(){return g()},children:Ge=>(()=>{var Fe=Pb(),at=Fe.firstChild;return a(Fe,()=>Ge.id,at),a(Fe,()=>Ge.name,null),ge(()=>Fe.value=Ge.id),Fe})()})),Ee.style.setProperty("display","block"),Ee.style.setProperty("font-weight","500"),Ee.style.setProperty("margin-bottom","0.5rem"),we.addEventListener("change",Ge=>F(ye(),"creditAccountId",Ge.currentTarget.value)),a(we,A(vt,{get each(){return g()},children:Ge=>(()=>{var Fe=Pb(),at=Fe.firstChild;return a(Fe,()=>Ge.id,at),a(Fe,()=>Ge.name,null),ge(()=>Fe.value=Ge.id),Fe})()})),Re.style.setProperty("display","grid"),Re.style.setProperty("grid-template-columns","1fr 2fr auto"),Re.style.setProperty("gap","1rem"),Re.style.setProperty("align-items","end"),je.style.setProperty("display","block"),je.style.setProperty("font-weight","500"),je.style.setProperty("margin-bottom","0.5rem"),Ve.$$input=Ge=>F(ye(),"amount",parseFloat(Ge.currentTarget.value)||0),tt.style.setProperty("display","block"),tt.style.setProperty("font-weight","500"),tt.style.setProperty("margin-bottom","0.5rem"),rt.$$input=Ge=>F(ye(),"description",Ge.currentTarget.value),a(Be,(()=>{var Ge=ke(()=>u().entries.length>1);return()=>Ge()&&(()=>{var Fe=rF();return Fe.$$click=()=>te(ye()),ge(at=>p(Fe,{...E,"background-color":"#dc2626"},at)),Fe})()})()),ge(Ge=>{var Fe=I,at=I,lt=W,Xe=W;return Ge.e=p(Ie,Fe,Ge.e),Ge.t=p(we,at,Ge.t),Ge.a=p(Ve,lt,Ge.a),Ge.o=p(rt,Xe,Ge.o),Ge},{e:void 0,t:void 0,a:void 0,o:void 0}),ge(()=>Ie.value=ae.debitAccountId),ge(()=>we.value=ae.creditAccountId),ge(()=>Ve.value=ae.amount),ge(()=>rt.value=ae.description||""),me})()}),null),re.style.setProperty("margin-bottom","1.5rem"),Y.style.setProperty("display","flex"),Y.style.setProperty("align-items","center"),Y.style.setProperty("gap","0.5rem"),ce.addEventListener("change",ae=>h(ye=>({...ye,postImmediately:ae.currentTarget.checked}))),ue.$$click=x,a(ue,()=>r()?"Creating...":"Create Custom Entry"),ge(ae=>{var ye=I,me=W,pe=W,ve=W,Ne={...E,"background-color":"#059669"},Ie=E,Ce=r()||!u().description||u().entries.some(Ee=>Ee.amount<=0);return ae.e=p(se,ye,ae.e),ae.t=p(k,me,ae.t),ae.a=p(ne,pe,ae.a),ae.o=p(B,ve,ae.o),ae.i=p(de,Ne,ae.i),ae.n=p(ue,Ie,ae.n),Ce!==ae.s&&(ue.disabled=ae.s=Ce),ae},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),ge(()=>se.value=u().type),ge(()=>k.value=u().date),ge(()=>ne.value=u().description),ge(()=>B.value=u().reference),ge(()=>ce.checked=u().postImmediately),T}}),null),ge(T=>{var R=V(t()==="quick"),J=V(t()==="custom");return T.e=p(j,R,T.e),T.t=p(z,J,T.t),T},{e:void 0,t:void 0}),L})()};Wt(["click","input"]);var _b=le("<div><button>← Back to Menu"),iF=le("<div><h2>Account Automation Menu</h2><p>Choose how you want to manage journal entries and account automation.</p><div><button><div><h3>🎯 Manual Custom Automation</h3><p>Create journal entries on-demand with custom parameters. Perfect for one-off transactions, adjustments, and when you need full control over the entries.</p><div><span>Recommended for custom transactions</span></div></div></button><button><div><h3>⚙️ Automatic Automation Configuration</h3><p>Configure rules that automatically create journal entries when certain events occur (like completing invoices, receiving payments, etc.).</p><div><span>Set up once, works automatically</span></div></div></button><div><h4>💡 Quick Guide:</h4><ul><li><strong>Manual Custom Automation:</strong> Use when you need to create specific entries with custom parameters</li><li><strong>Automatic Configuration:</strong> Use to set up rules that trigger automatically during business operations</li><li>Both systems work together - you can use automatic rules for common transactions and manual entries for exceptions");const oF=()=>{const[t,e]=Se("menu"),r={display:"block",width:"100%",padding:"1rem","margin-bottom":"0.5rem","background-color":"#f9fafb",border:"1px solid #d1d5db","border-radius":"0.5rem","text-align":"left",cursor:"pointer","text-decoration":"none",color:"#374151",transition:"all 0.2s ease-in-out"},n={padding:"0.5rem 1rem","background-color":"#6b7280",color:"white",border:"none","border-radius":"0.375rem",cursor:"pointer","font-weight":"500","margin-bottom":"1rem"};return[A(Me,{get when(){return t()==="custom"},get children(){var i=_b(),o=i.firstChild;return i.style.setProperty("max-width","1200px"),i.style.setProperty("margin","0 auto"),i.style.setProperty("padding","2rem"),o.$$click=()=>e("menu"),a(i,A(nF,{}),null),ge(s=>p(o,n,s)),i}}),A(Me,{get when(){return t()==="config"},get children(){var i=_b(),o=i.firstChild;return i.style.setProperty("max-width","1200px"),i.style.setProperty("margin","0 auto"),i.style.setProperty("padding","2rem"),o.$$click=()=>e("menu"),a(i,A(KM,{}),null),ge(s=>p(o,n,s)),i}}),A(Me,{get when(){return t()==="menu"},get children(){var i=iF(),o=i.firstChild,s=o.nextSibling,l=s.nextSibling,c=l.firstChild,d=c.firstChild,u=d.firstChild,h=u.nextSibling,g=h.nextSibling,m=g.firstChild,S=c.nextSibling,N=S.firstChild,x=N.firstChild,b=x.nextSibling,K=b.nextSibling,te=K.firstChild,F=S.nextSibling,V=F.firstChild,W=V.nextSibling;return i.style.setProperty("max-width","600px"),i.style.setProperty("margin","0 auto"),i.style.setProperty("padding","2rem"),o.style.setProperty("font-size","1.5rem"),o.style.setProperty("font-weight","700"),o.style.setProperty("margin-bottom","1rem"),s.style.setProperty("color","#6b7280"),s.style.setProperty("margin-bottom","2rem"),c.$$mouseout=I=>{I.currentTarget.style.backgroundColor="#f9fafb",I.currentTarget.style.borderColor="#d1d5db"},c.$$mouseover=I=>{I.currentTarget.style.backgroundColor="#f3f4f6",I.currentTarget.style.borderColor="#9ca3af"},c.$$click=()=>e("custom"),u.style.setProperty("font-size","1.125rem"),u.style.setProperty("font-weight","600"),u.style.setProperty("margin-bottom","0.5rem"),h.style.setProperty("color","#6b7280"),h.style.setProperty("font-size","0.875rem"),g.style.setProperty("margin-top","0.75rem"),m.style.setProperty("background-color","#dbeafe"),m.style.setProperty("color","#1e40af"),m.style.setProperty("padding","0.25rem 0.5rem"),m.style.setProperty("border-radius","0.25rem"),m.style.setProperty("font-size","0.75rem"),m.style.setProperty("font-weight","500"),S.$$mouseout=I=>{I.currentTarget.style.backgroundColor="#f9fafb",I.currentTarget.style.borderColor="#d1d5db"},S.$$mouseover=I=>{I.currentTarget.style.backgroundColor="#f3f4f6",I.currentTarget.style.borderColor="#9ca3af"},S.$$click=()=>e("config"),x.style.setProperty("font-size","1.125rem"),x.style.setProperty("font-weight","600"),x.style.setProperty("margin-bottom","0.5rem"),b.style.setProperty("color","#6b7280"),b.style.setProperty("font-size","0.875rem"),K.style.setProperty("margin-top","0.75rem"),te.style.setProperty("background-color","#ecfdf5"),te.style.setProperty("color","#065f46"),te.style.setProperty("padding","0.25rem 0.5rem"),te.style.setProperty("border-radius","0.25rem"),te.style.setProperty("font-size","0.75rem"),te.style.setProperty("font-weight","500"),F.style.setProperty("margin-top","2rem"),F.style.setProperty("padding","1rem"),F.style.setProperty("background-color","#fef7cd"),F.style.setProperty("border-radius","0.5rem"),F.style.setProperty("border","1px solid #f59e0b"),V.style.setProperty("font-size","1rem"),V.style.setProperty("font-weight","600"),V.style.setProperty("color","#92400e"),V.style.setProperty("margin-bottom","0.5rem"),W.style.setProperty("color","#92400e"),W.style.setProperty("font-size","0.875rem"),W.style.setProperty("line-height","1.5"),W.style.setProperty("margin-left","1rem"),ge(I=>{var E=r,L=r;return I.e=p(c,E,I.e),I.t=p(S,L,I.t),I},{e:void 0,t:void 0}),i}})]};Wt(["click","mouseover","mouseout"]);class sF{listeners=new Map;eventHistory=[];maxHistorySize=1e3;on(e,r,n){const i={id:n.id,eventTypes:Array.isArray(e)?e:[e],handler:r,priority:n.priority||100,isActive:n.isActive!==!1};return i.eventTypes.forEach(o=>{this.listeners.has(o)||this.listeners.set(o,[]);const l=this.listeners.get(o).filter(c=>c.id!==i.id);l.push(i),l.sort((c,d)=>d.priority-c.priority),this.listeners.set(o,l)}),i.id}off(e){this.listeners.forEach((r,n)=>{const i=r.filter(o=>o.id!==e);this.listeners.set(n,i)})}async emit(e){this.eventHistory.unshift(e),this.eventHistory.length>this.maxHistorySize&&(this.eventHistory=this.eventHistory.slice(0,this.maxHistorySize));const n=(this.listeners.get(e.type)||[]).filter(i=>i.isActive);for(const i of n)try{await i.handler(e)}catch(o){console.error(`Event listener ${i.id} failed for event ${e.type}:`,o)}}getHistory(e=100){return this.eventHistory.slice(0,e)}getListeners(e){if(e)return this.listeners.get(e)||[];const r=[];return this.listeners.forEach(n=>{n.forEach(i=>{r.find(o=>o.id===i.id)||r.push(i)})}),r}toggleListener(e,r){this.listeners.forEach(n=>{const i=n.find(o=>o.id===e);i&&(i.isActive=r)})}clearHistory(){this.eventHistory=[]}getStats(){const e={};let r=0;this.listeners.forEach((o,s)=>{e[s]=o.length,r+=o.length});const n=new Date(Date.now()-24*60*60*1e3),i=this.eventHistory.filter(o=>o.timestamp>n).reduce((o,s)=>{const l=o.find(c=>c.type===s.type);return l?l.count++:o.push({type:s.type,count:1}),o},[]);return{totalListeners:r,listenersByType:e,totalEvents:this.eventHistory.length,recentEvents:i}}}const x_=new sF,Ts={async getAll(){return mn(async()=>{const t=await Zr({query:"getEventRules",queryString:"businessId = :businessId",params:{":businessId":Gt.getBusinessId()}});return gl(t)},()=>cn.eventRules.getAll())},async getById(t){return mn(async()=>{const e=await Zr({query:"getEventRules",queryString:"businessId = :businessId AND id = :ruleId",params:{":businessId":Gt.getBusinessId(),":ruleId":t}});return gl(e)[0]||null},()=>cn.eventRules.getById(t))},async getByEventType(t){return mn(async()=>{const e=await Zr({query:"getEventRules",queryString:"businessId = :businessId AND eventType = :eventType AND isActive = true",params:{":businessId":Gt.getBusinessId(),":eventType":t}});return gl(e)},()=>cn.eventRules.getByEventType(t))},async create(t){return mn(async()=>{const e={...t,id:`rule_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,businessId:Gt.getBusinessId(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};console.log("Creating event rule with ID:",e.id),console.log("Rule data:",e);const r=await Zr({query:"addEventRules",form:{data:e}});console.log("GraphQL response:",r);const n=r?.addEventRules;if(!n)throw new Error("Failed to create event rule");return n},()=>cn.eventRules.create(t))},async update(t,e){return mn(async()=>{const r={...e,id:t,businessId:Gt.getBusinessId(),updatedAt:new Date().toISOString()},i=(await Zr({query:"updateEventRules",form:{id:t,data:r}}))?.updateEventRules;if(!i)throw new Error("Failed to update event rule");return i},()=>cn.eventRules.update(t,e))},async delete(t){return mn(async()=>{if((await Zr({query:"deleteEventRules",params:{id:t,businessId:Gt.getBusinessId()}}))?.deleteEventRules)return{success:!0,message:"Event rule deleted successfully"};throw new Error("Failed to delete event rule")},()=>cn.eventRules.delete(t))},async toggleActive(t,e){return this.update(t,{isActive:e})},async testRule(t,e){return mn(async()=>(await Zr({query:"testEventRule",form:{rule:t,sampleData:e,businessId:Gt.getBusinessId()}}))?.testEventRule||{success:!1,error:"Failed to test rule"},()=>cn.eventRules.testRule(t,e))},async getExecutionHistory(t,e=100){return mn(async()=>{const r=t?"businessId = :businessId AND ruleId = :ruleId":"businessId = :businessId",n={":businessId":Gt.getBusinessId()};t&&(n[":ruleId"]=t);const i=await Zr({query:"getEventRuleHistory",queryString:r,params:n,form:{limit:e}});return gl(i)},()=>cn.eventRules.getExecutionHistory(t,e))},async bulkToggle(t,e){return mn(async()=>(await Zr({query:"bulkUpdateEventRules",form:{ruleIds:t,updates:{isActive:e,updatedAt:new Date().toISOString()},businessId:Gt.getBusinessId()}}))?.bulkUpdateEventRules||{success:!1,updated:0,failed:t},()=>cn.eventRules.bulkToggle(t,e))},async exportRules(){return(await this.getAll()).map(e=>({...e,id:void 0,businessId:void 0}))},async importRules(t){return mn(async()=>(await Zr({query:"importEventRules",form:{rules:t.map(r=>({...r,businessId:Gt.getBusinessId()})),businessId:Gt.getBusinessId()}}))?.importEventRules||{success:!1,imported:0,failed:t.length,errors:["Import failed"]},()=>cn.eventRules.importRules(t))}};class aF{rules=new Map;auditLog=[];constructor(){x_.on(["invoice_completed","invoice_created","invoice_updated","invoice_cancelled","payment_received","payment_refunded","inventory_received","inventory_sold","inventory_adjusted","expense_created","expense_approved","expense_paid","service_rendered","freight_processed","customs_cleared","bank_transaction_imported"],this.handleEvent.bind(this),{id:"automation_service",priority:50}),this.loadRulesFromApi()}addRule(e){const r={...e,id:`rule_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,createdAt:new Date,updatedAt:new Date};return this.rules.set(r.id,r),r.id}updateRule(e,r){const n=this.rules.get(e);if(!n)return!1;const i={...n,...r,id:e,updatedAt:new Date};return this.rules.set(e,i),!0}removeRule(e){return this.rules.delete(e)}getRules(){return Array.from(this.rules.values())}getRulesForEvent(e){return this.getRules().filter(r=>r.eventType===e&&r.isActive).sort((r,n)=>n.priority-r.priority)}async handleEvent(e){const r=this.getRulesForEvent(e.type);if(r.length===0)return;const n=[],i=[];let o=!0,s;try{for(const l of r)try{if(this.evaluateConditions(l.conditions,e)){const d=await this.createJournalEntry(l,e);n.push(l.name),i.push(d)}}catch(c){console.error(`Error executing rule ${l.name}:`,c),s=c instanceof Error?c.message:"Unknown error",o=!1}}catch(l){console.error("Error processing event automation:",l),s=l instanceof Error?l.message:"Unknown error",o=!1}this.auditLog.unshift({timestamp:new Date,eventId:e.id,eventType:e.type,rulesTriggered:n,entriesCreated:i,success:o,error:s}),this.auditLog.length>1e3&&(this.auditLog=this.auditLog.slice(0,1e3))}evaluateConditions(e,r){return e.length===0?!0:e.every(n=>{const i=this.getNestedValue(r,n.field);return this.evaluateCondition(i,n)})}evaluateCondition(e,r){const{operator:n,value:i,dataType:o}=r,s=this.convertValue(e,o),l=this.convertValue(i,o);switch(n){case"equals":return s===l;case"notEquals":return s!==l;case"greaterThan":return s>l;case"lessThan":return s<l;case"greaterThanOrEqual":return s>=l;case"lessThanOrEqual":return s<=l;case"contains":return String(s).toLowerCase().includes(String(l).toLowerCase());case"notContains":return!String(s).toLowerCase().includes(String(l).toLowerCase());case"in":return Array.isArray(l)&&l.includes(s);case"notIn":return Array.isArray(l)&&!l.includes(s);case"exists":return e!=null;case"notExists":return e==null;default:return!1}}convertValue(e,r){if(e==null)return e;switch(r){case"number":return Number(e);case"string":return String(e);case"boolean":return!!e;case"date":return new Date(e);case"array":return Array.isArray(e)?e:[e];default:return e}}async createJournalEntry(e,r){const{journalEntryTemplate:n}=e,i=this.processTemplate(n.description,r),o=this.processTemplate(n.reference,r),s=[];for(const h of n.lines){if(h.conditions&&h.conditions.length>0&&!this.evaluateConditions(h.conditions,r))continue;const g=this.evaluateAmountExpression(h.amountExpression,r);if(g===0)continue;const m=this.processTemplate(h.accountExpression,r),S=h.subAccountExpression?this.processTemplate(h.subAccountExpression,r):void 0,N=this.processTemplate(h.descriptionTemplate,r),x={id:`line_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,accountId:m,accountName:this.getAccountName(m),subAccountId:S,subAccountName:S?this.getAccountName(S):void 0,description:N,debitAmount:h.isDebit?g:0,creditAmount:h.isDebit?0:g,reference:o};s.push(x)}if(s.length===0)throw new Error("No valid journal entry lines generated");const l=s.reduce((h,g)=>h+g.debitAmount,0),c=s.reduce((h,g)=>h+g.creditAmount,0);if(Math.abs(l-c)>.01)throw new Error(`Journal entry not balanced. Debits: ${l}, Credits: ${c}`);const d={entryNumber:dn.getNextEntryNumber(),date:new Date().toISOString().split("T")[0],description:i,reference:o,status:"draft",createdBy:"automation",createdAt:new Date().toISOString(),totalDebit:l,totalCredit:c,lines:s};return await dn.addJournalEntry(d)}processTemplate(e,r){return e.replace(/\{([^}]+)\}/g,(n,i)=>{const o=this.getNestedValue(r,i);return String(o||n)})}evaluateAmountExpression(e,r){try{if(!isNaN(Number(e)))return Number(e);const n=this.getNestedValue(r,e);return Number(n)||0}catch(n){return console.error(`Error evaluating amount expression: ${e}`,n),0}}getNestedValue(e,r){return r.split(".").reduce((n,i)=>n?.[i],e)}getAccountName(e){return{1001:"Cash - Operating Account",1002:"Cash - Zelle Account",1003:"Cash - Credit Card Processing",1101:"Accounts Receivable - Customers",1102:"Accounts Receivable - Freight Charges",1201:"Inventory - Products",1202:"Inventory - Packaging Materials",1301:"Prepaid Expenses",1401:"Customs Fees Receivable",1402:"Transit Insurance Receivable",2001:"Accounts Payable",2002:"Freight Payable",2101:"Accrued Salaries",2102:"Accrued Rent",2301:"Sales Tax Payable",2302:"Customs Fees Payable",2303:"Transit Insurance Payable",3001:"Owner's Equity",3101:"Retained Earnings",4001:"Sales Revenue - Products",4101:"Service Revenue - General",4201:"Transport Service Revenue",4202:"Freight Revenue - Air",4203:"Freight Revenue - Sea",4301:"Processing Revenue - Packaging",4302:"Processing Revenue - Storage",5001:"Cost of Goods Sold - Products",5002:"Cost of Goods Sold - Packaging",5101:"Freight Expense - Air",5102:"Freight Expense - Sea",5103:"Local Transport Expense",5201:"Salaries and Wages",5202:"Rent Expense - Office",5203:"Rent Expense - Warehouse",5301:"Utilities Expense",5302:"Insurance Expense",5303:"Office Supplies",5401:"Professional Fees",5402:"Bank Fees",5403:"Credit Card Processing Fees",5501:"Vehicle Expenses",5502:"Equipment Maintenance",5601:"Depreciation Expense"}[e]||`Account ${e}`}getAuditLog(e=100){return this.auditLog.slice(0,e)}clearAuditLog(){this.auditLog=[]}exportRules(){return this.getRules()}importRules(e){this.rules.clear(),e.forEach(r=>{this.rules.set(r.id,r)})}syncRules(e){this.rules.clear(),e.forEach(r=>{this.rules.set(r.id,r)})}async loadRulesFromApi(){try{const e=await Ts.getAll();this.syncRules(e)}catch(e){console.error("Failed to load event rules from API:",e)}}testRule(e,r){const n=e.conditions.map(s=>({condition:s,result:this.evaluateCondition(this.getNestedValue(r,s.field),s)})),i=n.every(s=>s.result),o={wouldTrigger:i,conditionResults:n};if(i)try{const s=this.processTemplate(e.journalEntryTemplate.description,r),l=this.processTemplate(e.journalEntryTemplate.reference,r),c=e.journalEntryTemplate.lines.map(d=>{const u=this.evaluateAmountExpression(d.amountExpression,r),h=this.processTemplate(d.accountExpression,r),g=this.processTemplate(d.descriptionTemplate,r);return{accountId:h,accountName:this.getAccountName(h),description:g,debitAmount:d.isDebit?u:0,creditAmount:d.isDebit?0:u}});o.estimatedJournalEntry={description:s,reference:l,lines:c}}catch(s){o.errors=[s instanceof Error?s.message:"Unknown error"]}return o}}const gh=new aF,wt=(t,e,r=!1,n)=>({type:t,description:e,required:r,...n}),lF={eventType:"invoice_completed",displayName:"Invoice Completed",description:"Triggered when an invoice is marked as completed",category:"financial",dataStructure:{"data.invoice":wt("string","Invoice number",!0,{example:"B47G1D-YY_8635-20250810"}),"data.description":wt("string","Invoice description",!1,{example:"Customer order description"}),"data.store":wt("string","Store code",!0,{example:"YY_8665"}),"data.guide":wt("string","Guide number",!0,{example:"2521"}),"data.createDate":wt("date","Invoice creation date",!0,{example:"2025-08-13"}),"data.type":wt("string","Invoice type",!0,{example:"SALES"}),"data.isCompleted":wt("boolean","Invoice completion status",!0,{example:!0}),"data.shipper_consignee.name":wt("string","Full name",!0,{example:"SUCEL NUNEZ JORGE"}),"data.shipper_consignee.firstName":wt("string","First name",!1,{example:"YASEL"}),"data.shipper_consignee.middleName":wt("string","Middle name",!1,{example:""}),"data.shipper_consignee.lastName":wt("string","Last name",!1,{example:"VASQUES JORGE"}),"data.shipper_consignee.lastName2":wt("string","Second last name",!1,{example:""}),"data.shipper_consignee.phoneNumber":wt("string","Primary phone number",!1,{example:"531101638"}),"data.shipper_consignee.phoneNumberS":wt("string","Secondary phone number",!1,{example:""}),"data.shipper_consignee.cid":wt("string","Customer ID number",!1,{example:"82072829422"}),"data.shipper_consignee.passport":wt("string","Passport number",!1,{example:""}),"data.shipper_consignee.address":wt("string","Full address",!1,{example:"Calle undefined"}),"data.products[0].id":wt("string","Product line item ID",!1,{example:"1755310725671"}),"data.products[0].product.id":wt("string","Product ID",!1,{example:"AjlXorLU63dtPDrm"}),"data.products[0].product.code":wt("string","Product code",!1,{example:"K89G06815"}),"data.products[0].product.label":wt("string","Product label/name",!1,{example:"SAZON COMPLETO BADIA 7 OZ"}),"data.products[0].product.price":wt("number","Product base price",!1,{format:"currency",example:0}),"data.products[0].qty":wt("number","Product quantity",!1,{example:4}),"data.products[0].salePrice":wt("number","Product sale price",!1,{format:"currency",example:8}),"data.products[0].total":wt("number","Product line total",!1,{format:"currency",example:32}),"data.reservas[0].id":wt("string","Reserva line item ID",!1,{example:"1755276669614"}),"data.reservas[0].type":wt("string","Reserva type",!1,{example:"Ropa"}),"data.reservas[0].qty":wt("number","Reserva quantity in lbs",!1,{example:120}),"data.reservas[0].price":wt("number","Reserva price per lb",!1,{format:"currency",example:4}),"data.reservas[0].arancel":wt("number","Reserva customs fee",!1,{format:"currency",example:0}),"data.reservas[0].total":wt("number","Reserva line total",!1,{format:"currency",example:480}),"data.services[0].id":wt("string","Service line item ID",!1,{example:"1755395460664"}),"data.services[0].type":wt("string","Service type",!1,{example:"🚛 Transportación"}),"data.services[0].qty":wt("number","Service quantity",!1,{example:3}),"data.services[0].price":wt("number","Service base price",!1,{format:"currency",example:0}),"data.services[0].arancel":wt("number","Service fee per unit",!1,{format:"currency",example:20}),"data.services[0].total":wt("number","Service line total",!1,{format:"currency",example:60}),"data.packagesOrder":wt("boolean","Is packages order",!1,{example:!1}),"data.shippingMethod":wt("string","Shipping method",!0,{example:"AEREO",options:[{value:"AEREO",label:"Air"},{value:"MARITIMO",label:"Maritime"}]}),"data.paymentMethods.taxOnTotal":wt("boolean","Tax applied on total",!1,{example:!1}),"data.paymentMethods.taxPercent":wt("number","Tax percentage",!1,{example:7}),"data.paymentMethods.exemptTaxOnCash":wt("boolean","Cash payment tax exempt",!1,{example:!0}),"data.paymentMethods.cash":wt("number","Cash payment amount",!1,{format:"currency",example:300}),"data.paymentMethods.zelle":wt("number","Zelle payment amount",!1,{format:"currency",example:292}),"data.paymentMethods.creditCard":wt("number","Credit card payment amount",!1,{format:"currency",example:0}),"data.businessId":wt("string","Business ID",!0,{example:"YB100423253156428"}),"data.ssg_inventory_key":wt("string","Inventory system key",!1,{example:"INVOICE-1755395719878"}),"data.ssg_sorder_key":wt("string","Sales order key",!1,{example:"SO-1755395719878"}),"data.referenceHId":wt("string","Reference hash ID",!1,{example:"xxhdlfvvmgvsn87q_1755395721386"}),"data.productSubtotal":wt("number","Products subtotal",!0,{format:"currency",example:32}),"data.reservaSubtotal":wt("number","Reservas subtotal",!0,{format:"currency",example:480}),"data.serviceSubtotal":wt("number","Services subtotal",!0,{format:"currency",example:60}),"data.subtotalBeforeTax":wt("number","Subtotal before tax",!0,{format:"currency",example:572}),"data.taxAmount":wt("number","Total tax amount",!0,{format:"currency",example:19.75}),"data.taxSavings":wt("number","Tax savings amount",!1,{format:"currency",example:20.29}),"data.total":wt("number","Final total amount",!0,{format:"currency",example:591.75}),"data.taxCalculationMethod":wt("string","Tax calculation method",!1,{example:"subtotal"}),"data.cashPaymentRatio":wt("number","Cash payment ratio",!1,{example:.51})},examples:[{name:"Cash Sale Invoice",description:"Invoice paid entirely in cash",sampleData:{invoice:"INV-2024-001",customerId:"CUST-001",customerName:"ABC Corporation",totalAmount:1500,subtotalAmount:1300,taxAmount:200,paymentMethods:{cash:1500,zelle:0,creditCard:0,check:0,bankTransfer:0},currency:"USD",status:"completed"}},{name:"Mixed Payment Invoice",description:"Invoice with cash and Zelle payments",sampleData:{invoice:"INV-2024-002",customerId:"CUST-002",customerName:"XYZ Inc",totalAmount:2e3,subtotalAmount:1800,taxAmount:200,paymentMethods:{cash:1200,zelle:800,creditCard:0,check:0,bankTransfer:0},currency:"USD",status:"completed"}}]},cF={eventType:"payment_received",displayName:"Payment Received",description:"Triggered when a payment is received from a customer",category:"financial",dataStructure:{"data.paymentId":wt("string","Payment ID",!0,{example:"PAY-2024-001"}),"data.invoiceId":wt("string","Related invoice ID",!1,{example:"INV-2024-001"}),"data.customerId":wt("string","Customer ID",!0),"data.customerName":wt("string","Customer name",!0,{example:"ABC Corporation"}),"data.amount":wt("number","Payment amount",!0,{format:"currency",example:1500}),"data.paymentMethod":wt("string","Payment method",!0,{options:[{value:"cash",label:"Cash"},{value:"zelle",label:"Zelle"},{value:"creditCard",label:"Credit Card"},{value:"check",label:"Check"},{value:"bankTransfer",label:"Bank Transfer"}],example:"cash"}),"data.currency":wt("string","Currency code",!0,{example:"USD"}),"data.exchangeRate":wt("number","Exchange rate",!1,{example:1}),"data.reference":wt("string","Payment reference",!0,{example:"REF-001"}),"data.bankAccount":wt("string","Bank account used",!1,{example:"BOA-Checking-001"}),"data.depositDate":wt("date","Date payment was deposited",!1,{format:"date",example:"2024-01-15"})},examples:[{name:"Cash Payment",description:"Cash payment for an invoice",sampleData:{paymentId:"PAY-2024-001",invoiceId:"INV-2024-001",customerId:"CUST-001",customerName:"ABC Corporation",amount:1500,paymentMethod:"cash",currency:"USD",reference:"CASH-001"}}]},dF={eventType:"inventory_received",displayName:"Inventory Received",description:"Triggered when inventory is received from suppliers",category:"inventory",dataStructure:{"data.movementId":wt("string","Movement ID",!0,{example:"MOV-2024-001"}),"data.productId":wt("string","Product ID",!0,{example:"PROD-001"}),"data.productName":wt("string","Product name",!0,{example:"Widget A"}),"data.sku":wt("string","Product SKU",!0,{example:"WID-A-001"}),"data.category":wt("string","Product category",!0,{example:"Electronics"}),"data.quantity":wt("number","Quantity received",!0,{example:100}),"data.unitCost":wt("number","Cost per unit",!0,{format:"currency",example:25}),"data.totalCost":wt("number","Total cost",!0,{format:"currency",example:2500}),"data.supplierId":wt("string","Supplier ID",!1,{example:"SUPP-001"}),"data.supplierName":wt("string","Supplier name",!1,{example:"Acme Supplies"}),"data.purchaseOrderId":wt("string","Purchase order ID",!1,{example:"PO-2024-001"}),"data.warehouseLocation":wt("string","Warehouse location",!0,{example:"WH-A-001"}),"data.movementType":wt("string","Type of movement",!0,{options:[{value:"purchase",label:"Purchase"},{value:"sale",label:"Sale"},{value:"adjustment",label:"Adjustment"},{value:"transfer",label:"Transfer"}],example:"purchase"})},examples:[{name:"Product Purchase",description:"Products received from supplier",sampleData:{movementId:"MOV-2024-001",productId:"PROD-001",productName:"Widget A",sku:"WID-A-001",category:"Electronics",quantity:100,unitCost:25,totalCost:2500,supplierId:"SUPP-001",supplierName:"Acme Supplies",movementType:"purchase"}}]},uF={eventType:"expense_created",displayName:"Expense Created",description:"Triggered when a new expense is created",category:"financial",dataStructure:{"data.expenseId":wt("string","Expense ID",!0,{example:"EXP-2024-001"}),"data.category":wt("string","Expense category",!0,{options:[{value:"office_supplies",label:"Office Supplies"},{value:"travel",label:"Travel"},{value:"utilities",label:"Utilities"},{value:"rent",label:"Rent"},{value:"equipment",label:"Equipment"},{value:"marketing",label:"Marketing"},{value:"professional_services",label:"Professional Services"}],example:"office_supplies"}),"data.subcategory":wt("string","Expense subcategory",!1,{example:"Stationery"}),"data.description":wt("string","Expense description",!0,{example:"Office supplies from Staples"}),"data.amount":wt("number","Expense amount",!0,{format:"currency",example:250}),"data.currency":wt("string","Currency code",!0,{example:"USD"}),"data.vendorId":wt("string","Vendor ID",!1,{example:"VEND-001"}),"data.vendorName":wt("string","Vendor name",!1,{example:"Staples Inc"}),"data.employeeId":wt("string","Employee ID",!1,{example:"EMP-001"}),"data.employeeName":wt("string","Employee name",!1,{example:"John Doe"}),"data.departmentId":wt("string","Department ID",!1,{example:"DEPT-001"}),"data.departmentName":wt("string","Department name",!1,{example:"Administration"}),"data.paymentMethod":wt("string","Payment method",!0,{options:[{value:"cash",label:"Cash"},{value:"check",label:"Check"},{value:"creditCard",label:"Credit Card"},{value:"bankTransfer",label:"Bank Transfer"}],example:"creditCard"}),"data.reference":wt("string","Reference number",!0,{example:"REF-001"}),"data.receiptAttached":wt("boolean","Receipt attached",!1,{example:!0})},examples:[{name:"Office Supplies Expense",description:"Office supplies purchased with credit card",sampleData:{expenseId:"EXP-2024-001",category:"office_supplies",description:"Office supplies from Staples",amount:250,currency:"USD",vendorName:"Staples Inc",paymentMethod:"creditCard",reference:"CC-001",receiptAttached:!0}}]},hF={eventType:"service_rendered",displayName:"Service Rendered",description:"Triggered when a service is completed for a customer",category:"operational",dataStructure:{"data.serviceId":wt("string","Service ID",!0,{example:"SRV-2024-001"}),"data.serviceType":wt("string","Type of service",!0,{options:[{value:"transport",label:"Transportation"},{value:"packaging",label:"Packaging"},{value:"storage",label:"Storage"},{value:"customs",label:"Customs Clearance"},{value:"processing",label:"Processing"},{value:"other",label:"Other"}],example:"transport"}),"data.description":wt("string","Service description",!0,{example:"Transportation from Miami to NYC"}),"data.customerId":wt("string","Customer ID",!0,{example:"CUST-001"}),"data.customerName":wt("string","Customer name",!0,{example:"ABC Corporation"}),"data.amount":wt("number","Service amount",!0,{format:"currency",example:500}),"data.currency":wt("string","Currency code",!0,{example:"USD"}),"data.quantity":wt("number","Service quantity",!1,{example:1}),"data.unitPrice":wt("number","Price per unit",!1,{format:"currency",example:500}),"data.invoiceId":wt("string","Related invoice ID",!1,{example:"INV-2024-001"}),"data.reference":wt("string","Service reference",!0,{example:"TRANS-001"}),"data.serviceDate":wt("date","Date service was performed",!0,{format:"date",example:"2024-01-15"}),"data.location":wt("string","Service location",!1,{example:"Miami, FL"}),"data.weight":wt("number","Weight (if applicable)",!1,{example:150.5}),"data.trackingNumber":wt("string","Tracking number",!1,{example:"TRK-123456"})},examples:[{name:"Transportation Service",description:"Freight transportation service",sampleData:{serviceId:"SRV-2024-001",serviceType:"transport",description:"Transportation from Miami to NYC",customerId:"CUST-001",customerName:"ABC Corporation",amount:500,currency:"USD",reference:"TRANS-001",serviceDate:"2024-01-15",weight:150.5}}]},pF={invoice_completed:lF,payment_received:cF,inventory_received:dF,expense_created:uF,service_rendered:hF},C_=t=>pF[t]||null,mF=t=>{const e=C_(t);return e?Object.entries(e.dataStructure).map(([r,n])=>({path:r,definition:n})):[]};var yF=le("<label>"),fF=le("<div>No fields found matching your criteria"),gF=le('<div><div><input type=text placeholder="Search fields..."><div></div></div><div>'),vF=le("<div>"),bF=le("<div><button type=button><span></span><span>▼"),PF=le("<button type=button> "),_F=le("<p>Example: <code>"),SF=le("<div><div><code></code><span></span></div><p>");const wF=t=>{Wc();const[e,r]=Se(!1),[n,i]=Se(""),[o,s]=Se("all"),l=Nt(()=>{const F=n().toLowerCase(),V=o();return t.availableFields.filter(W=>{const I=!F||W.path.toLowerCase().includes(F)||W.definition.description.toLowerCase().includes(F),E=V==="all"||V==="required"&&W.definition.required||V==="number"&&W.definition.type==="number"||V==="string"&&W.definition.type==="string"||V==="payment"&&W.path.includes("payment")||V==="customer"&&W.path.includes("customer");return I&&E})}),c=F=>{t.onFieldSelect(F),r(!1),i("")},d=F=>{switch(F){case"number":return"#dbeafe";case"string":return"#fef3c7";case"boolean":return"#dcfce7";case"date":return"#f3e8ff";default:return"#f3f4f6"}},u=F=>{switch(F){case"number":return"#1e40af";case"string":return"#92400e";case"boolean":return"#166534";case"date":return"#7c3aed";default:return"#374151"}},h=[{value:"all",label:"All Fields",icon:"📋"},{value:"required",label:"Required",icon:"⭐"},{value:"number",label:"Numbers",icon:"🔢"},{value:"string",label:"Text",icon:"📝"},{value:"payment",label:"Payments",icon:"💰"},{value:"customer",label:"Customer",icon:"👤"}],g={position:"relative",width:"100%"},m={width:"100%",padding:"0.75rem","background-color":"white",border:"1px solid #d1d5db","border-radius":"0.375rem","text-align":"left",cursor:"pointer","font-size":"0.875rem",display:"flex","justify-content":"space-between","align-items":"center"},S={position:"absolute",top:"100%",left:"0",right:"0","z-index":"50","background-color":"white",border:"1px solid #d1d5db","border-radius":"0.375rem","box-shadow":"0 10px 15px -3px rgba(0, 0, 0, 0.1)","margin-top":"0.25rem","max-height":"400px","overflow-y":"auto"},N={padding:"1rem","border-bottom":"1px solid #e5e7eb","background-color":"#f9fafb"},x={width:"100%",padding:"0.5rem",border:"1px solid #d1d5db","border-radius":"0.375rem","font-size":"0.875rem","margin-bottom":"0.75rem"},b={display:"flex","flex-wrap":"wrap",gap:"0.5rem"},K=F=>({padding:"0.25rem 0.75rem","border-radius":"0.375rem",border:"none",cursor:"pointer","font-size":"0.75rem","background-color":F?"#3b82f6":"#f3f4f6",color:F?"white":"#374151"}),te={padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid #f3f4f6","hover:background-color":"#f9fafb"};return(()=>{var F=bF(),V=F.firstChild,W=V.firstChild,I=W.nextSibling;return a(F,A(Me,{get when(){return t.label},get children(){var E=yF();return E.style.setProperty("display","block"),E.style.setProperty("font-weight","500"),E.style.setProperty("margin-bottom","0.5rem"),E.style.setProperty("font-size","0.875rem"),a(E,()=>t.label),E}}),V),V.addEventListener("mouseleave",E=>E.currentTarget.style.borderColor="#d1d5db"),V.addEventListener("mouseenter",E=>E.currentTarget.style.borderColor="#3b82f6"),V.$$click=()=>r(!e()),W.style.setProperty("color","#6b7280"),a(W,()=>t.placeholder||"Select a field from data interface..."),I.style.setProperty("transition","transform 0.2s"),a(F,A(Me,{get when(){return e()},get children(){var E=gF(),L=E.firstChild,M=L.firstChild,P=M.nextSibling,w=L.nextSibling;return p(L,N),M.$$input=v=>i(v.currentTarget.value),p(M,x),a(P,A(vt,{each:h,children:v=>(()=>{var j=PF(),z=j.firstChild;return j.$$click=()=>s(v.value),a(j,()=>v.icon,z),a(j,()=>v.label,null),ge(T=>p(j,K(o()===v.value),T)),j})()})),a(w,A(Me,{get when(){return l().length===0},get children(){var v=fF();return v.style.setProperty("padding","2rem"),v.style.setProperty("text-align","center"),v.style.setProperty("color","#6b7280"),v}}),null),a(w,A(vt,{get each(){return l()},children:v=>(()=>{var j=SF(),z=j.firstChild,T=z.firstChild,R=T.nextSibling,J=z.nextSibling;return j.addEventListener("mouseleave",X=>X.currentTarget.style.backgroundColor="transparent"),j.addEventListener("mouseenter",X=>X.currentTarget.style.backgroundColor="#f9fafb"),j.$$click=()=>c(v.path),p(j,te),z.style.setProperty("display","flex"),z.style.setProperty("justify-content","space-between"),z.style.setProperty("align-items","center"),z.style.setProperty("margin-bottom","0.25rem"),T.style.setProperty("font-family","monospace"),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","#059669"),T.style.setProperty("font-weight","600"),a(T,()=>v.path),R.style.setProperty("font-size","0.7rem"),R.style.setProperty("padding","0.125rem 0.375rem"),R.style.setProperty("border-radius","0.25rem"),R.style.setProperty("font-weight","500"),a(R,()=>v.definition.type,null),a(R,()=>v.definition.required&&" *",null),J.style.setProperty("font-size","0.75rem"),J.style.setProperty("color","#6b7280"),J.style.setProperty("margin","0 0 0.25rem 0"),a(J,()=>v.definition.description),a(j,A(Me,{get when(){return v.definition.example},get children(){var X=_F(),H=X.firstChild,se=H.nextSibling;return X.style.setProperty("font-size","0.7rem"),X.style.setProperty("color","#374151"),X.style.setProperty("margin","0"),X.style.setProperty("font-style","italic"),se.style.setProperty("background-color","#f3f4f6"),se.style.setProperty("padding","0.125rem 0.25rem"),se.style.setProperty("border-radius","0.125rem"),a(se,(()=>{var O=ke(()=>typeof v.definition.example=="object");return()=>O()?JSON.stringify(v.definition.example):v.definition.example})()),X}}),null),ge(X=>{var H=d(v.definition.type),se=u(v.definition.type);return H!==X.e&&((X.e=H)!=null?R.style.setProperty("background-color",H):R.style.removeProperty("background-color")),se!==X.t&&((X.t=se)!=null?R.style.setProperty("color",se):R.style.removeProperty("color")),X},{e:void 0,t:void 0}),j})()}),null),ge(v=>{var j=S,z=b;return v.e=p(E,j,v.e),v.t=p(P,z,v.t),v},{e:void 0,t:void 0}),ge(()=>M.value=n()),E}}),null),a(F,A(Me,{get when(){return e()},get children(){var E=vF();return E.$$click=()=>r(!1),E.style.setProperty("position","fixed"),E.style.setProperty("top","0"),E.style.setProperty("left","0"),E.style.setProperty("right","0"),E.style.setProperty("bottom","0"),E.style.setProperty("z-index","40"),E}}),null),ge(E=>{var L=g,M=m,P=e()?"rotate(180deg)":"none";return E.e=p(F,L,E.e),E.t=p(V,M,E.t),P!==E.a&&((E.a=P)!=null?I.style.setProperty("transform",P):I.style.removeProperty("transform")),E},{e:void 0,t:void 0,a:void 0}),F})()};Wt(["click","input"]);var xF=le('<div><h4>Create New Custom Field</h4><div><div><label>Field Name *</label><input type=text placeholder="e.g., totalWithTax, customerInfo"></div><div><label>Expression *</label><div><input type=text placeholder="e.g., data.subtotal + data.tax"></div><div><p>💡 Quick templates:</p><div></div></div></div><div><label>Description</label><input type=text placeholder="Describe what this field represents"></div><div><button>Cancel</button><button>Create Field'),CF=le("<div><p>No custom fields created yet</p><p>Create custom fields to combine multiple interface fields into reusable expressions"),AF=le("<div><div><div><h3>🛠️ Custom Fields</h3><p>Create custom expressions by combining interface fields</p></div><button>+ Add Custom Field</button></div><div>"),$F=le("<button type=button>"),EF=le("<p>"),IF=le("<div><div><div><div><h4></h4><span>custom field</span></div><div><code></code></div></div><div><button>Remove");const TF=t=>{Wc();const[e,r]=Se(!1),[n,i]=Se(null),[o,s]=Se({name:"",expression:"",description:""}),l=()=>{const te=o();te.name.trim()&&te.expression.trim()&&(t.onAdd(te),s({name:"",expression:"",description:""}),r(!1))},c=te=>{const F=o().expression,V=F?`${F} + ${te}`:te;s(W=>({...W,expression:V}))},d=te=>{s(F=>({...F,expression:te}))},u=[{label:"Total with Tax",expression:"data.subtotalAmount + data.taxAmount",description:"Subtotal plus tax amount"},{label:"Total Payments",expression:"data.paymentMethods.cash + data.paymentMethods.zelle + data.paymentMethods.creditCard",description:"Sum of all payment methods"},{label:"Customer Info",expression:'data.customerName + " (" + data.customerId + ")"',description:"Customer name with ID"},{label:"Invoice Reference",expression:'"Invoice " + data.invoice + " - " + data.customerName',description:"Complete invoice reference"}],h={border:"1px solid #d1d5db","border-radius":"0.5rem","background-color":"#f9fafb",padding:"1.5rem"},g={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem"},m={padding:"0.5rem 1rem","background-color":"#3b82f6",color:"white",border:"none","border-radius":"0.375rem",cursor:"pointer","font-weight":"500","font-size":"0.875rem"},S={...m,"background-color":"#6b7280"},N={...m,"background-color":"#ef4444"},x={width:"100%",padding:"0.5rem",border:"1px solid #d1d5db","border-radius":"0.375rem","font-size":"0.875rem"},b={"background-color":"white",border:"1px solid #e5e7eb","border-radius":"0.375rem",padding:"1rem","margin-bottom":"1rem"},K={"background-color":"white",border:"1px solid #d1d5db","border-radius":"0.375rem",padding:"1.5rem","margin-bottom":"1.5rem"};return(()=>{var te=AF(),F=te.firstChild,V=F.firstChild,W=V.firstChild,I=W.nextSibling,E=V.nextSibling,L=F.nextSibling;return p(te,h),p(F,g),W.style.setProperty("font-size","1.125rem"),W.style.setProperty("font-weight","600"),W.style.setProperty("margin","0 0 0.25rem 0"),I.style.setProperty("font-size","0.875rem"),I.style.setProperty("color","#6b7280"),I.style.setProperty("margin","0"),E.$$click=()=>r(!e()),a(te,A(Me,{get when(){return e()},get children(){var M=xF(),P=M.firstChild,w=P.nextSibling,v=w.firstChild,j=v.firstChild,z=j.nextSibling,T=v.nextSibling,R=T.firstChild,J=R.nextSibling,X=J.firstChild,H=J.nextSibling,se=H.firstChild,O=se.nextSibling,_=T.nextSibling,k=_.firstChild,$=k.nextSibling,G=_.nextSibling,ne=G.firstChild,U=ne.nextSibling;return p(M,K),P.style.setProperty("font-size","1rem"),P.style.setProperty("font-weight","600"),P.style.setProperty("margin-bottom","1rem"),w.style.setProperty("display","grid"),w.style.setProperty("gap","1rem"),j.style.setProperty("display","block"),j.style.setProperty("font-weight","500"),j.style.setProperty("margin-bottom","0.5rem"),z.$$input=D=>s(B=>({...B,name:D.currentTarget.value})),R.style.setProperty("display","block"),R.style.setProperty("font-weight","500"),R.style.setProperty("margin-bottom","0.5rem"),J.style.setProperty("display","grid"),J.style.setProperty("grid-template-columns","2fr 1fr"),J.style.setProperty("gap","0.5rem"),J.style.setProperty("margin-bottom","0.5rem"),X.$$input=D=>s(B=>({...B,expression:D.currentTarget.value})),a(J,A(wF,{get availableFields(){return t.availableFields},onFieldSelect:c,placeholder:"Insert field..."}),null),H.style.setProperty("margin-bottom","0.5rem"),se.style.setProperty("font-size","0.75rem"),se.style.setProperty("color","#6b7280"),se.style.setProperty("margin-bottom","0.5rem"),O.style.setProperty("display","flex"),O.style.setProperty("flex-wrap","wrap"),O.style.setProperty("gap","0.5rem"),a(O,A(vt,{each:u,children:D=>(()=>{var B=$F();return B.$$click=()=>d(D.expression),B.style.setProperty("padding","0.25rem 0.5rem"),B.style.setProperty("background-color","#f3f4f6"),B.style.setProperty("color","#374151"),B.style.setProperty("border","1px solid #d1d5db"),B.style.setProperty("border-radius","0.25rem"),B.style.setProperty("cursor","pointer"),B.style.setProperty("font-size","0.75rem"),a(B,()=>D.label),ge(()=>Jt(B,"title",D.description)),B})()})),k.style.setProperty("display","block"),k.style.setProperty("font-weight","500"),k.style.setProperty("margin-bottom","0.5rem"),$.$$input=D=>s(B=>({...B,description:D.currentTarget.value})),G.style.setProperty("display","flex"),G.style.setProperty("gap","0.5rem"),G.style.setProperty("justify-content","flex-end"),ne.$$click=()=>r(!1),U.$$click=l,ge(D=>{var B=x,Q=x,Z=x,oe=S,de=m;return D.e=p(z,B,D.e),D.t=p(X,Q,D.t),D.a=p($,Z,D.a),D.o=p(ne,oe,D.o),D.i=p(U,de,D.i),D},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ge(()=>z.value=o().name),ge(()=>X.value=o().expression),ge(()=>$.value=o().description),M}}),L),a(L,A(Me,{get when(){return t.customFields.length===0},get children(){var M=CF(),P=M.firstChild,w=P.nextSibling;return M.style.setProperty("padding","3rem"),M.style.setProperty("text-align","center"),M.style.setProperty("color","#6b7280"),M.style.setProperty("background-color","white"),M.style.setProperty("border-radius","0.375rem"),M.style.setProperty("border","1px solid #e5e7eb"),P.style.setProperty("font-size","1rem"),P.style.setProperty("margin-bottom","0.5rem"),w.style.setProperty("font-size","0.875rem"),M}}),null),a(L,A(vt,{get each(){return t.customFields},children:M=>(()=>{var P=IF(),w=P.firstChild,v=w.firstChild,j=v.firstChild,z=j.firstChild,T=z.nextSibling,R=j.nextSibling,J=R.firstChild,X=v.nextSibling,H=X.firstChild;return p(P,b),w.style.setProperty("display","flex"),w.style.setProperty("justify-content","space-between"),w.style.setProperty("align-items","start"),v.style.setProperty("flex-grow","1"),j.style.setProperty("display","flex"),j.style.setProperty("align-items","center"),j.style.setProperty("gap","0.75rem"),j.style.setProperty("margin-bottom","0.5rem"),z.style.setProperty("font-size","1rem"),z.style.setProperty("font-weight","600"),z.style.setProperty("margin","0"),z.style.setProperty("color","#1f2937"),a(z,()=>M.name),T.style.setProperty("font-size","0.7rem"),T.style.setProperty("padding","0.125rem 0.5rem"),T.style.setProperty("background-color","#dbeafe"),T.style.setProperty("color","#1e40af"),T.style.setProperty("border-radius","0.25rem"),T.style.setProperty("font-weight","500"),R.style.setProperty("margin-bottom","0.5rem"),J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","#4b5563"),J.style.setProperty("font-family","monospace"),J.style.setProperty("background-color","#f3f4f6"),J.style.setProperty("padding","0.5rem"),J.style.setProperty("border-radius","0.25rem"),J.style.setProperty("display","block"),a(J,()=>M.expression),a(v,A(Me,{get when(){return M.description},get children(){var se=EF();return se.style.setProperty("font-size","0.875rem"),se.style.setProperty("color","#6b7280"),se.style.setProperty("margin","0"),a(se,()=>M.description),se}}),null),X.style.setProperty("display","flex"),X.style.setProperty("gap","0.5rem"),H.$$click=()=>t.onRemove(M.id),ge(se=>p(H,{...N,padding:"0.5rem","font-size":"0.75rem"},se)),P})()}),null),ge(M=>p(E,m,M)),te})()};Wt(["click","input"]);var kF=le("<input>");const NF=t=>{const[e,r]=Se("");Un(()=>{t?.value!==void 0&&r(t.value.toString())});const n=o=>{(o.key==="Enter"||o.key==="Escape"||o.key==="Tab")&&t.onChange&&Sl(e())&&t.onChange(e())},i=()=>{Sl(e())&&t.onChange(e())};return(()=>{var o=kF();return o.addEventListener("blur",s=>{i(),s.target.style.borderColor="var(--border-color)"}),o.addEventListener("focus",s=>{s.target.style.borderColor="var(--primary-color)"}),o.$$keydown=n,o.$$input=s=>r(s.target.value),ge(s=>{var l=t.type||"text",c=t.placeholder,d=t.required,u=t.disabled,h=t.style;return l!==s.e&&Jt(o,"type",s.e=l),c!==s.t&&Jt(o,"placeholder",s.t=c),d!==s.a&&(o.required=s.a=d),u!==s.o&&(o.disabled=s.o=u),s.i=p(o,h,s.i),s},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ge(()=>o.value=e()),o})()};Wt(["input","keydown"]);var LF=le("<p>"),RF=le("<div><div><div><p>Available Fields</p><p>Click a field to insert it at cursor position</p></div><div>"),DF=le("<div>"),MF=le("<div><label></label><div><button type=button>📋 Fields"),FF=le("<div><div><code></code><span></span></div><p>");const vh=t=>{const[e,r]=Se(!1),[n,i]=Se(0),o=g=>{const m=t.value,S=m.substring(0,n()),N=m.substring(n());let x=g;t.type==="text"&&!g.startsWith("{")&&(x=`{${g}}`);const b=S+x+N;t.onInput(b),r(!1)},s=g=>{const m=g.currentTarget;i(m.selectionStart||0)},l={position:"relative",width:"100%"},c={display:"flex",gap:"0.5rem","align-items":"stretch"},d={"flex-grow":"1",padding:"0.5rem",border:"1px solid #d1d5db","border-radius":"0.375rem","font-size":"0.875rem"},u={padding:"0.5rem","background-color":"#f3f4f6",color:"#374151",border:"1px solid #d1d5db","border-radius":"0.375rem",cursor:"pointer","font-size":"0.75rem","white-space":"nowrap","font-weight":"500"},h={"font-size":"0.75rem",color:"#6b7280","margin-top":"0.25rem"};return(()=>{var g=MF(),m=g.firstChild,S=m.nextSibling,N=S.firstChild;return m.style.setProperty("display","block"),m.style.setProperty("font-weight","500"),m.style.setProperty("margin-bottom","0.5rem"),a(m,()=>t.label),p(S,c),a(S,A(NF,{type:"text",style:d,get value(){return t.value},get placeholder(){return t.placeholder},onChange:x=>t.onInput(x),onClick:s}),N),N.addEventListener("mouseleave",x=>x.currentTarget.style.backgroundColor="#f3f4f6"),N.addEventListener("mouseenter",x=>x.currentTarget.style.backgroundColor="#e5e7eb"),N.$$click=()=>r(!e()),a(g,A(Me,{get when(){return t.helpText},get children(){var x=LF();return p(x,h),a(x,()=>t.helpText),x}}),null),a(g,A(Me,{get when(){return e()},get children(){var x=RF(),b=x.firstChild,K=b.firstChild,te=K.firstChild,F=te.nextSibling,V=K.nextSibling;return x.style.setProperty("position","absolute"),x.style.setProperty("top","100%"),x.style.setProperty("left","0"),x.style.setProperty("right","0"),x.style.setProperty("z-index","50"),x.style.setProperty("margin-top","0.25rem"),b.style.setProperty("background-color","white"),b.style.setProperty("border","1px solid #d1d5db"),b.style.setProperty("border-radius","0.375rem"),b.style.setProperty("box-shadow","0 10px 15px -3px rgba(0, 0, 0, 0.1)"),b.style.setProperty("max-height","300px"),b.style.setProperty("overflow-y","auto"),K.style.setProperty("padding","0.75rem"),K.style.setProperty("border-bottom","1px solid #e5e7eb"),K.style.setProperty("background-color","#f9fafb"),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("font-weight","600"),te.style.setProperty("margin","0 0 0.25rem 0"),F.style.setProperty("font-size","0.75rem"),F.style.setProperty("color","#6b7280"),F.style.setProperty("margin","0"),a(V,A(vt,{get each(){return t.availableFields},children:W=>(()=>{var I=FF(),E=I.firstChild,L=E.firstChild,M=L.nextSibling,P=E.nextSibling;return I.addEventListener("mouseleave",w=>w.currentTarget.style.backgroundColor="transparent"),I.addEventListener("mouseenter",w=>w.currentTarget.style.backgroundColor="#f9fafb"),I.$$click=()=>o(W.path),I.style.setProperty("padding","0.75rem"),I.style.setProperty("cursor","pointer"),I.style.setProperty("border-bottom","1px solid #f3f4f6"),E.style.setProperty("display","flex"),E.style.setProperty("justify-content","space-between"),E.style.setProperty("align-items","center"),E.style.setProperty("margin-bottom","0.25rem"),L.style.setProperty("font-family","monospace"),L.style.setProperty("font-size","0.875rem"),L.style.setProperty("color","#059669"),L.style.setProperty("font-weight","600"),a(L,()=>W.path),M.style.setProperty("font-size","0.7rem"),M.style.setProperty("padding","0.125rem 0.375rem"),M.style.setProperty("border-radius","0.25rem"),a(M,()=>W.definition.type),P.style.setProperty("font-size","0.75rem"),P.style.setProperty("color","#6b7280"),P.style.setProperty("margin","0"),a(P,()=>W.definition.description),ge(w=>{var v=W.definition.type==="number"?"#dbeafe":"#fef3c7",j=W.definition.type==="number"?"#1e40af":"#92400e";return v!==w.e&&((w.e=v)!=null?M.style.setProperty("background-color",v):M.style.removeProperty("background-color")),j!==w.t&&((w.t=j)!=null?M.style.setProperty("color",j):M.style.removeProperty("color")),w},{e:void 0,t:void 0}),I})()})),x}}),null),a(g,A(Me,{get when(){return e()},get children(){var x=DF();return x.$$click=()=>r(!1),x.style.setProperty("position","fixed"),x.style.setProperty("top","0"),x.style.setProperty("left","0"),x.style.setProperty("right","0"),x.style.setProperty("bottom","0"),x.style.setProperty("z-index","40"),x}}),null),ge(x=>{var b=l,K=u;return x.e=p(g,b,x.e),x.t=p(N,K,x.t),x},{e:void 0,t:void 0}),g})()};Wt(["click"]);var OF=le("<div><p><strong>:</strong> </p><button type=button>"),Sb=le("<div>"),BF=le("<div><h5></h5><p></p><div></div><div><p>💡 <strong>Usage Tip:</strong> Copy field paths like <code>data.totalAmount</code> or <code>data.customerName</code> to use in conditions and journal entry templates."),VF=le("<div><h3>📋 Data Interface & Examples</h3><div><div><h4>📊 Available Fields</h4><div></div></div><div><h4>💡 Sample Data Examples"),jF=le("<p> <!> events"),zF=le("<p>"),qF=le("<div><div><h2></h2><div><h3></h3><div><div><label> *</label><input type=text></div><div><label></label><input type=number min=1 max=1000></div></div><div><label> *</label><textarea></textarea></div><div><div><label> *</label><select></select></div><div><label><input type=checkbox></label></div></div></div><div><div><h3></h3><button>+ </button></div></div><div><div><h3></h3><div><button type=button></button><button></button></div></div><div></div><div><h4></h4><button>+ </button></div></div><div><button></button><button>"),wb=le("<option>"),UF=le("<p>Example: <code>"),HF=le("<div><div><code></code><span></span></div><p>"),GF=le("<button type=button>"),WF=le("<input>"),YF=le("<div><div><div><label></label><select><option value></option></select></div><div><label></label><select></select></div><div><label></label></div><div><button>"),KF=le("<option> (<!>)"),QF=le("<input type=text value=N/A disabled>"),JF=le("<div><div><h5>Journal Line </h5><button></button></div><div><div><label></label><select></select></div><div><label></label><select><option value=debit></option><option value=credit></option></select></div></div><div>"),XF=le("<option> - <!> (<!>)");const ZF=t=>{const{t:e}=Wc(),r=()=>t.rule&&t.rule.id,[n,i]=Se(!1),[o,s]=Se(0),[l,c]=Se(!1),[d,u]=Se([]),[h,g]=Se({name:t.rule?.name||"",description:t.rule?.description||"",eventType:t.rule?.eventType||"invoice_completed",isActive:t.rule?.isActive??!0,priority:t.rule?.priority||100,conditions:t.rule?.conditions||[],journalEntryTemplate:t.rule?.journalEntryTemplate||{description:"",reference:"",lines:[]},createdBy:t.rule?.createdBy||"user"}),m=Nt(()=>{const _=h().eventType;return _?mF(_):[]}),S=Nt(()=>{const _=h().eventType;return _?C_(_):null}),N=[{value:"equals",label:e("eventAutomation.operators.equals")},{value:"notEquals",label:e("eventAutomation.operators.notEquals")},{value:"greaterThan",label:e("eventAutomation.operators.greaterThan")},{value:"lessThan",label:e("eventAutomation.operators.lessThan")},{value:"greaterThanOrEqual",label:e("eventAutomation.operators.greaterThanOrEqual")},{value:"lessThanOrEqual",label:e("eventAutomation.operators.lessThanOrEqual")},{value:"contains",label:e("eventAutomation.operators.contains")},{value:"notContains",label:e("eventAutomation.operators.notContains")},{value:"exists",label:e("eventAutomation.operators.exists")},{value:"notExists",label:e("eventAutomation.operators.notExists")}],x=[{id:"1001",name:"Cash - Operating Account",type:"Asset"},{id:"1002",name:"Cash - Zelle Account",type:"Asset"},{id:"1003",name:"Cash - Credit Card Processing",type:"Asset"},{id:"1101",name:"Accounts Receivable - Customers",type:"Asset"},{id:"1201",name:"Inventory - Products",type:"Asset"},{id:"1401",name:"Customs Fees Receivable",type:"Asset"},{id:"2001",name:"Accounts Payable",type:"Liability"},{id:"2301",name:"Sales Tax Payable",type:"Liability"},{id:"2302",name:"Customs Fees Payable",type:"Liability"},{id:"4001",name:"Sales Revenue - Products",type:"Revenue"},{id:"4101",name:"Service Revenue - General",type:"Revenue"},{id:"4201",name:"Transport Service Revenue",type:"Revenue"},{id:"5001",name:"Cost of Goods Sold - Products",type:"Expense"},{id:"5201",name:"Salaries and Wages",type:"Expense"},{id:"5301",name:"Utilities Expense",type:"Expense"}],b=[{value:"invoice_completed",label:e("eventAutomation.eventTypes.invoice_completed")},{value:"invoice_created",label:e("eventAutomation.eventTypes.invoice_created")},{value:"payment_received",label:e("eventAutomation.eventTypes.payment_received")},{value:"inventory_received",label:e("eventAutomation.eventTypes.inventory_received")},{value:"inventory_sold",label:e("eventAutomation.eventTypes.inventory_sold")},{value:"expense_created",label:e("eventAutomation.eventTypes.expense_created")},{value:"expense_approved",label:e("eventAutomation.eventTypes.expense_approved")},{value:"service_rendered",label:e("eventAutomation.eventTypes.service_rendered")}],K=(_,k)=>{g($=>({...$,[_]:k}))},te=(_,k)=>{g($=>({...$,journalEntryTemplate:{...$.journalEntryTemplate,[_]:k}}))},F=()=>{const _={field:m()[0]?.path||"",operator:"equals",value:"",dataType:"string"};g(k=>({...k,conditions:[...k.conditions||[],_]}))},V=(_,k,$)=>{const G=[...h().conditions||[]];if(G[_]={...G[_],[k]:$},k==="field"){const ne=m().find(U=>U.path===$);ne&&(G[_].dataType=ne.definition.type)}g(ne=>({...ne,conditions:G}))},W=_=>{g(k=>({...k,conditions:k.conditions?.filter(($,G)=>G!==_)||[]}))},I=()=>{const _={accountExpression:"1001",descriptionTemplate:"",amountExpression:"",isDebit:!0};g(k=>({...k,journalEntryTemplate:{...k.journalEntryTemplate,lines:[...k.journalEntryTemplate?.lines||[],_]}}))},E=(_,k,$)=>{const G=[...h().journalEntryTemplate?.lines||[]];G[_]={...G[_],[k]:$},g(ne=>({...ne,journalEntryTemplate:{...ne.journalEntryTemplate,lines:G}}))},L=_=>{const k={..._,id:`custom_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};u($=>[...$,k])},M=(_,k)=>{u($=>$.map(G=>G.id===_?{...G,...k}:G))},P=_=>{u(k=>k.filter($=>$.id!==_))},w=_=>{g(k=>({...k,journalEntryTemplate:{...k.journalEntryTemplate,lines:k.journalEntryTemplate?.lines.filter(($,G)=>G!==_)||[]}}))},v=()=>{const _=h();if(!_.name||!_.description||!_.eventType){alert("Please fill in all required fields");return}if(!_.journalEntryTemplate?.lines.length){alert("Please add at least one journal entry line");return}if(_.journalEntryTemplate.lines.filter($=>!$.accountExpression||!$.amountExpression||!$.descriptionTemplate).length>0){alert("Please complete all journal entry line fields");return}t.onSave(_)},j={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000",overflow:"auto",padding:"2rem"},z={"background-color":"white","border-radius":"0.5rem",padding:"2rem","max-width":"900px","max-height":"90vh","overflow-y":"auto",width:"100%"},T={width:"100%",padding:"0.5rem",border:"1px solid #d1d5db","border-radius":"0.375rem","font-size":"0.875rem"},R={...T,"background-color":"white"},J={padding:"0.5rem 1rem","border-radius":"0.375rem",cursor:"pointer","font-weight":"500",border:"1px solid #d1d5db"},X={...J,"background-color":"#3b82f6",color:"white",border:"none"},H={...J,"background-color":"white",color:"#374151"},se={...J,"background-color":"#ef4444",color:"white",border:"none"},O={"margin-bottom":"2rem","border-bottom":"1px solid #e5e7eb","padding-bottom":"2rem"};return(()=>{var _=qF(),k=_.firstChild,$=k.firstChild,G=$.nextSibling,ne=G.firstChild,U=ne.nextSibling,D=U.firstChild,B=D.firstChild,Q=B.firstChild,Z=B.nextSibling,oe=D.nextSibling,de=oe.firstChild,re=de.nextSibling,Y=U.nextSibling,ce=Y.firstChild,ue=ce.firstChild,ae=ce.nextSibling,ye=Y.nextSibling,me=ye.firstChild,pe=me.firstChild,ve=pe.firstChild,Ne=pe.nextSibling,Ie=me.nextSibling,Ce=Ie.firstChild,Ee=Ce.firstChild,we=G.nextSibling,Re=we.firstChild,He=Re.firstChild,je=He.nextSibling;je.firstChild;var Ve=we.nextSibling,qe=Ve.firstChild,tt=qe.firstChild,rt=tt.nextSibling,Be=rt.firstChild,Ge=Be.nextSibling,Fe=qe.nextSibling,at=Fe.nextSibling,lt=at.firstChild,Xe=lt.nextSibling;Xe.firstChild;var Ct=Ve.nextSibling,Le=Ct.firstChild,nt=Le.nextSibling;return p(k,z),$.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","700"),$.style.setProperty("margin-bottom","1.5rem"),a($,(()=>{var We=ke(()=>!!r());return()=>We()?e("eventAutomation.builder.editTitle"):e("eventAutomation.builder.createTitle")})()),ne.style.setProperty("font-size","1.125rem"),ne.style.setProperty("font-weight","600"),ne.style.setProperty("margin-bottom","1rem"),a(ne,()=>e("eventAutomation.builder.basicInfo")),U.style.setProperty("display","grid"),U.style.setProperty("grid-template-columns","1fr 1fr"),U.style.setProperty("gap","1rem"),U.style.setProperty("margin-bottom","1rem"),B.style.setProperty("display","block"),B.style.setProperty("font-weight","500"),B.style.setProperty("margin-bottom","0.5rem"),a(B,()=>e("eventAutomation.builder.ruleName"),Q),Z.$$input=We=>K("name",We.currentTarget.value),de.style.setProperty("display","block"),de.style.setProperty("font-weight","500"),de.style.setProperty("margin-bottom","0.5rem"),a(de,()=>e("eventAutomation.builder.priority")),re.$$input=We=>K("priority",parseInt(We.currentTarget.value)||100),Y.style.setProperty("margin-bottom","1rem"),ce.style.setProperty("display","block"),ce.style.setProperty("font-weight","500"),ce.style.setProperty("margin-bottom","0.5rem"),a(ce,()=>e("eventAutomation.builder.description"),ue),ae.$$input=We=>K("description",We.currentTarget.value),ye.style.setProperty("display","grid"),ye.style.setProperty("grid-template-columns","1fr auto"),ye.style.setProperty("gap","1rem"),ye.style.setProperty("align-items","end"),pe.style.setProperty("display","block"),pe.style.setProperty("font-weight","500"),pe.style.setProperty("margin-bottom","0.5rem"),a(pe,()=>e("eventAutomation.builder.eventType"),ve),Ne.addEventListener("change",We=>K("eventType",We.currentTarget.value)),a(Ne,A(vt,{each:b,children:We=>(()=>{var kt=wb();return a(kt,()=>We.label),ge(()=>kt.value=We.value),kt})()})),Ce.style.setProperty("display","flex"),Ce.style.setProperty("align-items","center"),Ce.style.setProperty("gap","0.5rem"),Ee.addEventListener("change",We=>K("isActive",We.currentTarget.checked)),a(Ce,()=>e("eventAutomation.builder.active"),null),a(G,A(Me,{get when(){return S()},get children(){var We=OF(),kt=We.firstChild,Et=kt.firstChild,Ot=Et.firstChild;Et.nextSibling;var jt=kt.nextSibling;return We.style.setProperty("margin-top","1rem"),We.style.setProperty("padding","1rem"),We.style.setProperty("background-color","#f3f4f6"),We.style.setProperty("border-radius","0.375rem"),kt.style.setProperty("font-size","0.875rem"),kt.style.setProperty("color","#4b5563"),kt.style.setProperty("margin-bottom","0.5rem"),a(Et,()=>e("eventAutomation.builder.eventDescription"),Ot),a(kt,()=>S()?.description,null),jt.$$click=()=>i(!n()),a(jt,()=>n()?"🔽 Hide Data Interface":"🔼 Show Data Interface & Examples"),ge(mt=>p(jt,{...H,"font-size":"0.75rem",padding:"0.25rem 0.5rem"},mt)),We}}),null),a(k,A(Me,{get when(){return ke(()=>!!n())()&&S()},get children(){var We=VF(),kt=We.firstChild,Et=kt.nextSibling,Ot=Et.firstChild,jt=Ot.firstChild,mt=jt.nextSibling,Zt=Ot.nextSibling,rr=Zt.firstChild;return kt.style.setProperty("font-size","1.125rem"),kt.style.setProperty("font-weight","600"),kt.style.setProperty("margin-bottom","1rem"),Et.style.setProperty("display","grid"),Et.style.setProperty("grid-template-columns","1fr 1fr"),Et.style.setProperty("gap","2rem"),jt.style.setProperty("font-size","1rem"),jt.style.setProperty("font-weight","600"),jt.style.setProperty("margin-bottom","0.75rem"),jt.style.setProperty("color","#1f2937"),mt.style.setProperty("max-height","300px"),mt.style.setProperty("overflow-y","auto"),mt.style.setProperty("border","1px solid #d1d5db"),mt.style.setProperty("border-radius","0.375rem"),mt.style.setProperty("padding","0.75rem"),mt.style.setProperty("background-color","#f9fafb"),a(mt,A(vt,{get each(){return m()},children:Dt=>(()=>{var Kt=HF(),dt=Kt.firstChild,pt=dt.firstChild,ze=pt.nextSibling,bt=dt.nextSibling;return Kt.style.setProperty("margin-bottom","0.5rem"),Kt.style.setProperty("padding","0.5rem"),Kt.style.setProperty("background-color","white"),Kt.style.setProperty("border-radius","0.25rem"),Kt.style.setProperty("border","1px solid #e5e7eb"),dt.style.setProperty("display","flex"),dt.style.setProperty("justify-content","space-between"),dt.style.setProperty("align-items","center"),pt.style.setProperty("font-family","monospace"),pt.style.setProperty("font-size","0.8rem"),pt.style.setProperty("color","#059669"),pt.style.setProperty("font-weight","600"),a(pt,()=>Dt.path),ze.style.setProperty("font-size","0.7rem"),ze.style.setProperty("padding","0.125rem 0.375rem"),ze.style.setProperty("border-radius","0.25rem"),ze.style.setProperty("font-weight","500"),a(ze,()=>Dt.definition.type),bt.style.setProperty("font-size","0.75rem"),bt.style.setProperty("color","#6b7280"),bt.style.setProperty("margin","0.25rem 0 0 0"),a(bt,()=>Dt.definition.description),a(Kt,A(Me,{get when(){return Dt.definition.example},get children(){var Mt=UF(),ft=Mt.firstChild,At=ft.nextSibling;return Mt.style.setProperty("font-size","0.7rem"),Mt.style.setProperty("color","#374151"),Mt.style.setProperty("margin","0.25rem 0 0 0"),Mt.style.setProperty("font-style","italic"),At.style.setProperty("background-color","#f3f4f6"),At.style.setProperty("padding","0.125rem 0.25rem"),At.style.setProperty("border-radius","0.125rem"),a(At,(()=>{var Ht=ke(()=>typeof Dt.definition.example=="object");return()=>Ht()?JSON.stringify(Dt.definition.example):Dt.definition.example})()),Mt}}),null),ge(Mt=>{var ft=Dt.definition.type==="number"?"#dbeafe":Dt.definition.type==="string"?"#fef3c7":Dt.definition.type==="boolean"?"#dcfce7":"#f3e8ff",At=Dt.definition.type==="number"?"#1e40af":Dt.definition.type==="string"?"#92400e":Dt.definition.type==="boolean"?"#166534":"#7c3aed";return ft!==Mt.e&&((Mt.e=ft)!=null?ze.style.setProperty("background-color",ft):ze.style.removeProperty("background-color")),At!==Mt.t&&((Mt.t=At)!=null?ze.style.setProperty("color",At):ze.style.removeProperty("color")),Mt},{e:void 0,t:void 0}),Kt})()})),rr.style.setProperty("font-size","1rem"),rr.style.setProperty("font-weight","600"),rr.style.setProperty("margin-bottom","0.75rem"),rr.style.setProperty("color","#1f2937"),a(Zt,A(Me,{get when(){return ke(()=>!!S()?.examples)()&&S().examples.length>0},get children(){return[(()=>{var Dt=Sb();return Dt.style.setProperty("margin-bottom","0.75rem"),a(Dt,A(vt,{get each(){return S().examples},children:(Kt,dt)=>(()=>{var pt=GF();return pt.$$click=()=>s(dt()),a(pt,()=>Kt.name),ge(ze=>p(pt,{...H,"margin-right":"0.5rem","margin-bottom":"0.5rem","font-size":"0.75rem",padding:"0.375rem 0.75rem","background-color":o()===dt()?"#3b82f6":"white",color:o()===dt()?"white":"#374151",border:o()===dt()?"none":"1px solid #d1d5db"},ze)),pt})()})),Dt})(),A(Me,{get when(){return S()?.examples[o()]},get children(){var Dt=BF(),Kt=Dt.firstChild,dt=Kt.nextSibling,pt=dt.nextSibling,ze=pt.nextSibling,bt=ze.firstChild;return Dt.style.setProperty("border","1px solid #d1d5db"),Dt.style.setProperty("border-radius","0.375rem"),Dt.style.setProperty("padding","0.75rem"),Dt.style.setProperty("background-color","#f9fafb"),Kt.style.setProperty("font-size","0.875rem"),Kt.style.setProperty("font-weight","600"),Kt.style.setProperty("margin-bottom","0.5rem"),a(Kt,()=>S().examples[o()].name),dt.style.setProperty("font-size","0.75rem"),dt.style.setProperty("color","#6b7280"),dt.style.setProperty("margin-bottom","0.75rem"),a(dt,()=>S().examples[o()].description),pt.style.setProperty("background-color","#1f2937"),pt.style.setProperty("color","#f9fafb"),pt.style.setProperty("padding","0.75rem"),pt.style.setProperty("border-radius","0.25rem"),pt.style.setProperty("font-family","monospace"),pt.style.setProperty("font-size","0.75rem"),pt.style.setProperty("overflow-x","auto"),pt.style.setProperty("white-space","pre"),a(pt,()=>JSON.stringify({data:S().examples[o()].sampleData},null,2)),ze.style.setProperty("margin-top","0.5rem"),ze.style.setProperty("padding","0.5rem"),ze.style.setProperty("background-color","#fef3c7"),ze.style.setProperty("border-radius","0.25rem"),bt.style.setProperty("font-size","0.7rem"),bt.style.setProperty("color","#92400e"),Dt}})]}}),null),ge(Dt=>p(We,O,Dt)),We}}),we),Re.style.setProperty("display","flex"),Re.style.setProperty("justify-content","space-between"),Re.style.setProperty("align-items","center"),Re.style.setProperty("margin-bottom","1rem"),He.style.setProperty("font-size","1.125rem"),He.style.setProperty("font-weight","600"),a(He,()=>e("eventAutomation.builder.conditions.title")),je.$$click=F,a(je,()=>e("eventAutomation.builder.conditions.add"),null),a(we,A(Me,{get when(){return(h().conditions?.length||0)===0},get children(){var We=jF(),kt=We.firstChild,Et=kt.nextSibling;return Et.nextSibling,We.style.setProperty("color","#6b7280"),We.style.setProperty("font-style","italic"),a(We,()=>e("eventAutomation.builder.conditions.noConditions"),kt),a(We,()=>h().eventType,Et),We}}),null),a(we,A(vt,{get each(){return h().conditions||[]},children:(We,kt)=>(()=>{var Et=YF(),Ot=Et.firstChild,jt=Ot.firstChild,mt=jt.firstChild,Zt=mt.nextSibling,rr=Zt.firstChild,Dt=jt.nextSibling,Kt=Dt.firstChild,dt=Kt.nextSibling,pt=Dt.nextSibling,ze=pt.firstChild,bt=pt.nextSibling,Mt=bt.firstChild;return Et.style.setProperty("border","1px solid #d1d5db"),Et.style.setProperty("border-radius","0.375rem"),Et.style.setProperty("padding","1rem"),Et.style.setProperty("margin-bottom","1rem"),Ot.style.setProperty("display","grid"),Ot.style.setProperty("grid-template-columns","2fr 1fr 1fr auto"),Ot.style.setProperty("gap","1rem"),Ot.style.setProperty("align-items","end"),mt.style.setProperty("display","block"),mt.style.setProperty("font-weight","500"),mt.style.setProperty("margin-bottom","0.5rem"),a(mt,()=>e("eventAutomation.builder.conditions.field")),Zt.addEventListener("change",ft=>V(kt(),"field",ft.currentTarget.value)),a(rr,()=>e("eventAutomation.builder.conditions.selectField")),a(Zt,A(vt,{get each(){return m()},children:ft=>(()=>{var At=KF(),Ht=At.firstChild,Yt=Ht.nextSibling;return Yt.nextSibling,a(At,()=>ft.path,Ht),a(At,()=>ft.definition.description,Yt),ge(()=>At.value=ft.path),At})()}),null),Kt.style.setProperty("display","block"),Kt.style.setProperty("font-weight","500"),Kt.style.setProperty("margin-bottom","0.5rem"),a(Kt,()=>e("eventAutomation.builder.conditions.operator")),dt.addEventListener("change",ft=>V(kt(),"operator",ft.currentTarget.value)),a(dt,A(vt,{each:N,children:ft=>(()=>{var At=wb();return a(At,()=>ft.label),ge(()=>At.value=ft.value),At})()})),ze.style.setProperty("display","block"),ze.style.setProperty("font-weight","500"),ze.style.setProperty("margin-bottom","0.5rem"),a(ze,()=>e("eventAutomation.builder.conditions.value")),a(pt,A(Me,{get when(){return We.operator!=="exists"&&We.operator!=="notExists"},get fallback(){return(()=>{var ft=QF();return ge(At=>p(ft,T,At)),ft})()},get children(){var ft=WF();return ft.$$input=At=>V(kt(),"value",We.dataType==="number"?parseFloat(At.currentTarget.value)||0:At.currentTarget.value),ge(At=>{var Ht=We.dataType==="number"?"number":"text",Yt=T,nr=We.dataType==="number"?"0":e("eventAutomation.builder.conditions.enterValue");return Ht!==At.e&&Jt(ft,"type",At.e=Ht),At.t=p(ft,Yt,At.t),nr!==At.a&&Jt(ft,"placeholder",At.a=nr),At},{e:void 0,t:void 0,a:void 0}),ge(()=>ft.value=We.value),ft}}),null),Mt.$$click=()=>W(kt()),a(Mt,()=>e("eventAutomation.builder.conditions.remove")),ge(ft=>{var At=R,Ht=R,Yt=se;return ft.e=p(Zt,At,ft.e),ft.t=p(dt,Ht,ft.t),ft.a=p(Mt,Yt,ft.a),ft},{e:void 0,t:void 0,a:void 0}),ge(()=>Zt.value=We.field),ge(()=>dt.value=We.operator),Et})()}),null),a(k,A(Me,{get when(){return l()},get children(){var We=Sb();return We.style.setProperty("margin-bottom","2rem"),a(We,A(TF,{get customFields(){return d()},get availableFields(){return m()},onAdd:L,onUpdate:M,onRemove:P})),We}}),Ve),Ve.style.setProperty("margin-bottom","2rem"),qe.style.setProperty("display","flex"),qe.style.setProperty("justify-content","space-between"),qe.style.setProperty("align-items","center"),qe.style.setProperty("margin-bottom","1rem"),tt.style.setProperty("font-size","1.125rem"),tt.style.setProperty("font-weight","600"),a(tt,()=>e("eventAutomation.builder.journalTemplate.title")),rt.style.setProperty("display","flex"),rt.style.setProperty("gap","0.5rem"),Be.$$click=()=>c(!l()),a(Be,()=>l()?"🔽 Hide Custom Fields":"🛠️ Manage Custom Fields"),Ge.$$click=()=>i(!n()),a(Ge,()=>n()?"🔽 Hide Data Interface":"📊 Show Data Interface"),Fe.style.setProperty("display","grid"),Fe.style.setProperty("grid-template-columns","1fr 1fr"),Fe.style.setProperty("gap","1rem"),Fe.style.setProperty("margin-bottom","1rem"),a(Fe,A(vh,{get label(){return`${e("eventAutomation.builder.journalTemplate.description")} *`},get value(){return h().journalEntryTemplate?.description||""},get placeholder(){return e("eventAutomation.builder.journalTemplate.descriptionPlaceholder")},get availableFields(){return m()},onInput:We=>te("description",We),type:"text",helpText:"Use {data.field} to insert event data in descriptions"}),null),a(Fe,A(vh,{get label(){return`${e("eventAutomation.builder.journalTemplate.reference")} *`},get value(){return h().journalEntryTemplate?.reference||""},get placeholder(){return e("eventAutomation.builder.journalTemplate.referencePlaceholder")},get availableFields(){return m()},onInput:We=>te("reference",We),type:"text",helpText:"Template for journal entry reference"}),null),at.style.setProperty("display","flex"),at.style.setProperty("justify-content","space-between"),at.style.setProperty("align-items","center"),at.style.setProperty("margin-bottom","1rem"),lt.style.setProperty("font-size","1rem"),lt.style.setProperty("font-weight","600"),a(lt,()=>e("eventAutomation.builder.journalTemplate.lines")),Xe.$$click=I,a(Xe,()=>e("eventAutomation.builder.journalTemplate.addLine"),null),a(Ve,A(Me,{get when(){return(h().journalEntryTemplate?.lines.length||0)===0},get children(){var We=zF();return We.style.setProperty("color","#6b7280"),We.style.setProperty("font-style","italic"),We.style.setProperty("margin-bottom","1rem"),a(We,()=>e("eventAutomation.builder.journalTemplate.noLines")),We}}),null),a(Ve,A(vt,{get each(){return h().journalEntryTemplate?.lines||[]},children:(We,kt)=>(()=>{var Et=JF(),Ot=Et.firstChild,jt=Ot.firstChild;jt.firstChild;var mt=jt.nextSibling,Zt=Ot.nextSibling,rr=Zt.firstChild,Dt=rr.firstChild,Kt=Dt.nextSibling,dt=rr.nextSibling,pt=dt.firstChild,ze=pt.nextSibling,bt=ze.firstChild,Mt=bt.nextSibling,ft=Zt.nextSibling;return Et.style.setProperty("border","1px solid #d1d5db"),Et.style.setProperty("border-radius","0.375rem"),Et.style.setProperty("padding","1rem"),Et.style.setProperty("margin-bottom","1rem"),Et.style.setProperty("background-color","#fafafa"),Ot.style.setProperty("display","flex"),Ot.style.setProperty("justify-content","space-between"),Ot.style.setProperty("align-items","center"),Ot.style.setProperty("margin-bottom","1rem"),jt.style.setProperty("font-size","0.875rem"),jt.style.setProperty("font-weight","600"),jt.style.setProperty("margin","0"),a(jt,()=>kt()+1,null),mt.$$click=()=>w(kt()),a(mt,()=>e("eventAutomation.builder.conditions.remove")),Zt.style.setProperty("display","grid"),Zt.style.setProperty("grid-template-columns","1fr 1fr"),Zt.style.setProperty("gap","1rem"),Zt.style.setProperty("margin-bottom","1rem"),Dt.style.setProperty("display","block"),Dt.style.setProperty("font-weight","500"),Dt.style.setProperty("margin-bottom","0.5rem"),a(Dt,()=>e("eventAutomation.builder.journalTemplate.account")),Kt.addEventListener("change",At=>E(kt(),"accountExpression",At.currentTarget.value)),a(Kt,A(vt,{each:x,children:At=>(()=>{var Ht=XF(),Yt=Ht.firstChild,nr=Yt.nextSibling,Dr=nr.nextSibling,vr=Dr.nextSibling;return vr.nextSibling,a(Ht,()=>At.id,Yt),a(Ht,()=>At.name,nr),a(Ht,()=>At.type,vr),ge(()=>Ht.value=At.id),Ht})()})),pt.style.setProperty("display","block"),pt.style.setProperty("font-weight","500"),pt.style.setProperty("margin-bottom","0.5rem"),a(pt,()=>e("eventAutomation.builder.journalTemplate.type")),ze.addEventListener("change",At=>E(kt(),"isDebit",At.currentTarget.value==="debit")),a(bt,()=>e("eventAutomation.builder.journalTemplate.debit")),a(Mt,()=>e("eventAutomation.builder.journalTemplate.credit")),ft.style.setProperty("display","grid"),ft.style.setProperty("grid-template-columns","2fr 1fr"),ft.style.setProperty("gap","1rem"),a(ft,A(vh,{get label(){return e("eventAutomation.builder.journalTemplate.descriptionTemplate")},get value(){return We.descriptionTemplate},get placeholder(){return e("eventAutomation.builder.journalTemplate.descriptionTemplatePlaceholder")},get availableFields(){return m()},onInput:At=>E(kt(),"descriptionTemplate",At),type:"text",helpText:"Use {data.field} to insert event data"}),null),a(ft,A(vh,{get label(){return e("eventAutomation.builder.journalTemplate.amountExpression")},get value(){return We.amountExpression},get placeholder(){return e("eventAutomation.builder.journalTemplate.amountExpressionPlaceholder")},get availableFields(){return m()},onInput:At=>E(kt(),"amountExpression",At),type:"expression",helpText:"Field path or expression for amount calculation"}),null),ge(At=>{var Ht=se,Yt=R,nr=R;return At.e=p(mt,Ht,At.e),At.t=p(Kt,Yt,At.t),At.a=p(ze,nr,At.a),At},{e:void 0,t:void 0,a:void 0}),ge(()=>Kt.value=We.accountExpression),ge(()=>ze.value=We.isDebit?"debit":"credit"),Et})()}),null),Ct.style.setProperty("display","flex"),Ct.style.setProperty("justify-content","flex-end"),Ct.style.setProperty("gap","1rem"),Cn(Le,"click",t.onCancel,!0),a(Le,()=>e("eventAutomation.builder.cancel")),nt.$$click=v,a(nt,(()=>{var We=ke(()=>!!r());return()=>We()?e("eventAutomation.builder.update"):e("eventAutomation.builder.save")})()),ge(We=>{var kt=j,Et=O,Ot=T,jt=e("eventAutomation.builder.ruleNamePlaceholder"),mt=T,Zt={...T,height:"4rem",resize:"vertical"},rr=e("eventAutomation.builder.descriptionPlaceholder"),Dt=R,Kt=O,dt=H,pt={...H,"font-size":"0.875rem"},ze={...H,"font-size":"0.875rem"},bt=H,Mt=H,ft=X;return We.e=p(_,kt,We.e),We.t=p(G,Et,We.t),We.a=p(Z,Ot,We.a),jt!==We.o&&Jt(Z,"placeholder",We.o=jt),We.i=p(re,mt,We.i),We.n=p(ae,Zt,We.n),rr!==We.s&&Jt(ae,"placeholder",We.s=rr),We.h=p(Ne,Dt,We.h),We.r=p(we,Kt,We.r),We.d=p(je,dt,We.d),We.l=p(Be,pt,We.l),We.u=p(Ge,ze,We.u),We.c=p(Xe,bt,We.c),We.w=p(Le,Mt,We.w),We.m=p(nt,ft,We.m),We},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),ge(()=>Z.value=h().name||""),ge(()=>re.value=h().priority||100),ge(()=>ae.value=h().description||""),ge(()=>Ne.value=h().eventType||""),ge(()=>Ee.checked=h().isActive??!0),_})()};Wt(["input","click"]);var eO=le("<div><p>Loading rules..."),tO=le("<div><p>Failed to load rules. Please refresh the page."),rO=le("<div><p></p><button>"),nO=le("<div><div><h2></h2><button>+ "),xb=le("<div>"),Cb=le("<div><h2>"),iO=le("<div><div><h1></h1><p></p></div><div><button> (<!>)</button><button></button><button>"),oO=le("<div><div><div><div><h3></h3><span></span><span></span></div><p></p><div><div><strong>:</strong></div><div><strong>:</strong><div> <!> - </div></div></div></div><div><button></button><button></button><button>"),sO=le("<div> <!> "),aO=le("<span>"),lO=le("<div><div><h3></h3><span></span></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><details><summary></summary><pre>"),cO=le("<div><strong>:</strong> "),dO=le("<div><div><div><h3></h3><span></span></div><span></span></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> <!> ");const uO=()=>{const{t}=Wc(),[e,r]=Se("rules"),[n,i]=Se(null),[o,s]=Se(!1),[l,c]=Se(""),[d,{refetch:u}]=mS(()=>Ts.getAll(),{initialValue:[]}),h=()=>x_.getHistory(50),g=()=>gh.getAuditLog(50);t("eventAutomation.eventTypes.invoice_completed"),t("eventAutomation.categories.financial"),t("eventAutomation.eventTypes.invoice_created"),t("eventAutomation.categories.financial"),t("eventAutomation.eventTypes.invoice_updated"),t("eventAutomation.categories.financial"),t("eventAutomation.eventTypes.payment_received"),t("eventAutomation.categories.financial"),t("eventAutomation.eventTypes.inventory_received"),t("eventAutomation.categories.inventory"),t("eventAutomation.eventTypes.inventory_sold"),t("eventAutomation.categories.inventory"),t("eventAutomation.eventTypes.inventory_adjusted"),t("eventAutomation.categories.inventory"),t("eventAutomation.eventTypes.expense_created"),t("eventAutomation.categories.financial"),t("eventAutomation.eventTypes.expense_approved"),t("eventAutomation.categories.financial"),t("eventAutomation.eventTypes.expense_paid"),t("eventAutomation.categories.financial"),t("eventAutomation.eventTypes.service_rendered"),t("eventAutomation.categories.operational"),t("eventAutomation.eventTypes.freight_processed"),t("eventAutomation.categories.operational"),t("eventAutomation.eventTypes.customs_cleared"),t("eventAutomation.categories.operational");const m=async W=>{try{n()?await Ts.update(n().id,W):await Ts.create(W),await u();const I=await Ts.getAll();gh.syncRules(I),i(null),s(!1)}catch(I){console.error("Failed to save rule:",I),alert("Failed to save rule. Please try again.")}},S=async W=>{if(confirm(t("common.confirmDelete")))try{await Ts.delete(W),await u();const I=await Ts.getAll();gh.syncRules(I)}catch(I){console.error("Failed to delete rule:",I),alert("Failed to delete rule. Please try again.")}},N=W=>new Date(W).toLocaleString(),x=W=>({padding:"0.75rem 1.5rem","background-color":W?"#3b82f6":"transparent",color:W?"white":"#6b7280",border:"none","border-radius":"0.5rem",cursor:"pointer","font-weight":"500",transition:"all 0.2s"}),b={"background-color":"white","border-radius":"0.5rem",padding:"1.5rem","box-shadow":"0 1px 3px 0 rgba(0, 0, 0, 0.1)","margin-bottom":"1rem"},K={padding:"0.5rem 1rem","background-color":"#3b82f6",color:"white",border:"none","border-radius":"0.375rem",cursor:"pointer","font-weight":"500"},te={...K,"background-color":"#6b7280"},F={...K,"background-color":"#ef4444"},V=async(W,I)=>{try{await Ts.toggleActive(W,I),await u();const E=await Ts.getAll();gh.syncRules(E)}catch(E){console.error("Failed to toggle rule:",E),alert("Failed to update rule status. Please try again.")}};return(()=>{var W=iO(),I=W.firstChild,E=I.firstChild,L=E.nextSibling,M=I.nextSibling,P=M.firstChild,w=P.firstChild,v=w.nextSibling;v.nextSibling;var j=P.nextSibling,z=j.nextSibling;return W.style.setProperty("max-width","1200px"),W.style.setProperty("margin","0 auto"),W.style.setProperty("padding","2rem"),I.style.setProperty("margin-bottom","2rem"),E.style.setProperty("font-size","2rem"),E.style.setProperty("font-weight","700"),E.style.setProperty("margin-bottom","0.5rem"),a(E,()=>t("eventAutomation.title")),L.style.setProperty("color","#6b7280"),a(L,()=>t("eventAutomation.subtitle")),M.style.setProperty("display","flex"),M.style.setProperty("gap","0.5rem"),M.style.setProperty("margin-bottom","2rem"),P.$$click=()=>r("rules"),a(P,()=>t("eventAutomation.tabs.rules"),w),a(P,(()=>{var T=ke(()=>!d.loading&&!d.error);return()=>T()?d().length:0})(),v),j.$$click=()=>r("events"),a(j,()=>t("eventAutomation.tabs.events")),z.$$click=()=>r("audit"),a(z,()=>t("eventAutomation.tabs.audit")),a(W,A(Me,{get when(){return e()==="rules"},get children(){var T=nO(),R=T.firstChild,J=R.firstChild,X=J.nextSibling;return X.firstChild,R.style.setProperty("display","flex"),R.style.setProperty("justify-content","space-between"),R.style.setProperty("margin-bottom","1.5rem"),J.style.setProperty("font-size","1.25rem"),J.style.setProperty("font-weight","600"),a(J,()=>t("eventAutomation.rules.title")),X.$$click=()=>s(!0),a(X,()=>t("eventAutomation.rules.createNew"),null),a(T,A(Me,{get when(){return d.loading},get children(){var H=eO(),se=H.firstChild;return se.style.setProperty("text-align","center"),se.style.setProperty("color","#6b7280"),ge(O=>p(H,b,O)),H}}),null),a(T,A(Me,{get when(){return d.error},get children(){var H=tO(),se=H.firstChild;return se.style.setProperty("text-align","center"),se.style.setProperty("color","#ef4444"),ge(O=>p(H,b,O)),H}}),null),a(T,A(Me,{get when(){return ke(()=>!d.loading&&!d.error)()&&d().length===0},get children(){var H=rO(),se=H.firstChild,O=se.nextSibling;return se.style.setProperty("margin-bottom","1rem"),a(se,()=>t("eventAutomation.rules.noRules")),O.$$click=()=>s(!0),a(O,()=>t("eventAutomation.rules.createFirst")),ge(_=>{var k={...b,"text-align":"center",padding:"3rem",color:"#6b7280"},$=K;return _.e=p(H,k,_.e),_.t=p(O,$,_.t),_},{e:void 0,t:void 0}),H}}),null),a(T,A(vt,{get each(){return ke(()=>!d.loading&&!d.error)()?d():[]},children:H=>(()=>{var se=oO(),O=se.firstChild,_=O.firstChild,k=_.firstChild,$=k.firstChild,G=$.nextSibling,ne=G.nextSibling,U=k.nextSibling,D=U.nextSibling,B=D.firstChild,Q=B.firstChild,Z=Q.firstChild,oe=B.nextSibling,de=oe.firstChild,re=de.firstChild,Y=de.nextSibling,ce=Y.firstChild,ue=ce.nextSibling;ue.nextSibling;var ae=_.nextSibling,ye=ae.firstChild,me=ye.nextSibling,pe=me.nextSibling;return O.style.setProperty("display","flex"),O.style.setProperty("justify-content","space-between"),O.style.setProperty("align-items","start"),_.style.setProperty("flex","1"),k.style.setProperty("display","flex"),k.style.setProperty("align-items","center"),k.style.setProperty("gap","1rem"),k.style.setProperty("margin-bottom","0.5rem"),$.style.setProperty("font-size","1.125rem"),$.style.setProperty("font-weight","600"),a($,()=>H.name),G.style.setProperty("padding","0.25rem 0.75rem"),G.style.setProperty("border-radius","0.375rem"),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("font-weight","500"),a(G,(()=>{var ve=ke(()=>!!H.isActive);return()=>ve()?t("common.active"):t("common.inactive")})()),ne.style.setProperty("padding","0.25rem 0.75rem"),ne.style.setProperty("background-color","#e5e7eb"),ne.style.setProperty("color","#374151"),ne.style.setProperty("border-radius","0.375rem"),ne.style.setProperty("font-size","0.875rem"),a(ne,()=>H.eventType),U.style.setProperty("color","#6b7280"),U.style.setProperty("margin-bottom","1rem"),a(U,()=>H.description),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("color","#4b5563"),B.style.setProperty("margin-bottom","0.5rem"),a(Q,()=>t("eventAutomation.rules.conditions"),Z),a(B,A(vt,{get each(){return H.conditions},children:(ve,Ne)=>(()=>{var Ie=sO(),Ce=Ie.firstChild,Ee=Ce.nextSibling;return Ee.nextSibling,Ie.style.setProperty("margin-left","1rem"),a(Ie,()=>Ne()>0&&"AND ",Ce),a(Ie,()=>ve.field,Ce),a(Ie,()=>ve.operator,Ee),a(Ie,()=>ve.value,null),Ie})()}),null),a(B,(()=>{var ve=ke(()=>H.conditions.length===0);return()=>ve()&&(()=>{var Ne=aO();return Ne.style.setProperty("margin-left","1rem"),a(Ne,()=>t("eventAutomation.rules.alwaysTriggers")),Ne})()})(),null),a(de,()=>t("eventAutomation.rules.journalEntry"),re),Y.style.setProperty("margin-left","1rem"),a(Y,()=>H.journalEntryTemplate.lines.length,ce),a(Y,()=>t("eventAutomation.rules.lines"),ue),a(Y,()=>H.journalEntryTemplate.description,null),ae.style.setProperty("display","flex"),ae.style.setProperty("gap","0.5rem"),ye.$$click=()=>V(H.id,!H.isActive),a(ye,(()=>{var ve=ke(()=>!!H.isActive);return()=>ve()?t("eventAutomation.rules.disable"):t("eventAutomation.rules.enable")})()),me.$$click=()=>i(H),a(me,()=>t("common.edit")),pe.$$click=()=>S(H.id),a(pe,()=>t("common.delete")),ge(ve=>{var Ne=b,Ie=H.isActive?"#d1fae5":"#fee2e2",Ce=H.isActive?"#065f46":"#991b1b",Ee=te,we=K,Re=F;return ve.e=p(se,Ne,ve.e),Ie!==ve.t&&((ve.t=Ie)!=null?G.style.setProperty("background-color",Ie):G.style.removeProperty("background-color")),Ce!==ve.a&&((ve.a=Ce)!=null?G.style.setProperty("color",Ce):G.style.removeProperty("color")),ve.o=p(ye,Ee,ve.o),ve.i=p(me,we,ve.i),ve.n=p(pe,Re,ve.n),ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),se})()}),null),ge(H=>p(X,K,H)),T}}),null),a(W,A(Me,{get when(){return e()==="events"},get children(){var T=Cb(),R=T.firstChild;return R.style.setProperty("font-size","1.25rem"),R.style.setProperty("font-weight","600"),R.style.setProperty("margin-bottom","1.5rem"),a(R,()=>t("eventAutomation.events.title")),a(T,A(Me,{get when(){return h().length===0},get children(){var J=xb();return a(J,()=>t("eventAutomation.events.noEvents")),ge(X=>p(J,{...b,"text-align":"center",color:"#6b7280"},X)),J}}),null),a(T,A(vt,{get each(){return h()},children:J=>(()=>{var X=lO(),H=X.firstChild,se=H.firstChild,O=se.nextSibling,_=H.nextSibling,k=_.firstChild,$=k.firstChild,G=$.firstChild;$.nextSibling;var ne=k.nextSibling,U=ne.firstChild,D=U.firstChild;U.nextSibling;var B=ne.nextSibling,Q=B.firstChild,Z=Q.nextSibling;return H.style.setProperty("display","flex"),H.style.setProperty("justify-content","space-between"),H.style.setProperty("margin-bottom","0.5rem"),se.style.setProperty("font-size","1rem"),se.style.setProperty("font-weight","600"),a(se,()=>J.type),O.style.setProperty("font-size","0.875rem"),O.style.setProperty("color","#6b7280"),a(O,()=>N(J.timestamp)),_.style.setProperty("font-size","0.875rem"),_.style.setProperty("color","#4b5563"),a($,()=>t("eventAutomation.events.source"),G),a(k,()=>J.source,null),a(U,()=>t("eventAutomation.events.eventId"),D),a(ne,()=>J.id,null),B.style.setProperty("margin-top","0.5rem"),Q.style.setProperty("cursor","pointer"),a(Q,()=>t("eventAutomation.events.viewData")),Z.style.setProperty("margin-top","0.5rem"),Z.style.setProperty("padding","0.5rem"),Z.style.setProperty("background-color","#f3f4f6"),Z.style.setProperty("border-radius","0.25rem"),Z.style.setProperty("overflow","auto"),Z.style.setProperty("font-size","0.75rem"),a(Z,()=>JSON.stringify(J.data,null,2)),ge(oe=>p(X,b,oe)),X})()}),null),T}}),null),a(W,A(Me,{get when(){return e()==="audit"},get children(){var T=Cb(),R=T.firstChild;return R.style.setProperty("font-size","1.25rem"),R.style.setProperty("font-weight","600"),R.style.setProperty("margin-bottom","1.5rem"),a(R,()=>t("eventAutomation.audit.title")),a(T,A(Me,{get when(){return g().length===0},get children(){var J=xb();return a(J,()=>t("eventAutomation.audit.noActivity")),ge(X=>p(J,{...b,"text-align":"center",color:"#6b7280"},X)),J}}),null),a(T,A(vt,{get each(){return g()},children:J=>(()=>{var X=dO(),H=X.firstChild,se=H.firstChild,O=se.firstChild,_=O.nextSibling,k=se.nextSibling,$=H.nextSibling,G=$.firstChild,ne=G.firstChild,U=ne.firstChild;ne.nextSibling;var D=G.nextSibling,B=D.firstChild,Q=B.firstChild;B.nextSibling;var Z=D.nextSibling,oe=Z.firstChild,de=oe.firstChild,re=oe.nextSibling,Y=re.nextSibling;return Y.nextSibling,H.style.setProperty("display","flex"),H.style.setProperty("justify-content","space-between"),H.style.setProperty("margin-bottom","0.5rem"),se.style.setProperty("display","flex"),se.style.setProperty("align-items","center"),se.style.setProperty("gap","1rem"),O.style.setProperty("font-size","1rem"),O.style.setProperty("font-weight","600"),a(O,()=>J.eventType),_.style.setProperty("padding","0.25rem 0.75rem"),_.style.setProperty("border-radius","0.375rem"),_.style.setProperty("font-size","0.875rem"),_.style.setProperty("font-weight","500"),a(_,(()=>{var ce=ke(()=>!!J.success);return()=>ce()?t("eventAutomation.audit.success"):t("eventAutomation.audit.failed")})()),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("color","#6b7280"),a(k,()=>N(J.timestamp)),$.style.setProperty("font-size","0.875rem"),$.style.setProperty("color","#4b5563"),a(ne,()=>t("eventAutomation.audit.eventId"),U),a(G,()=>J.eventId,null),a(B,()=>t("eventAutomation.audit.rulesTriggered"),Q),a(D,()=>J.rulesTriggered.join(", ")||t("common.none"),null),a(oe,()=>t("eventAutomation.audit.entriesCreated"),de),a(Z,()=>J.entriesCreated.length,Y),a(Z,()=>t("eventAutomation.audit.journalEntries"),null),a($,A(Me,{get when(){return J.error},get children(){var ce=cO(),ue=ce.firstChild,ae=ue.firstChild;return ue.nextSibling,ce.style.setProperty("color","#dc2626"),ce.style.setProperty("margin-top","0.5rem"),a(ue,()=>t("eventAutomation.audit.error"),ae),a(ce,()=>J.error,null),ce}}),null),ge(ce=>{var ue=b,ae=J.success?"#d1fae5":"#fee2e2",ye=J.success?"#065f46":"#991b1b";return ce.e=p(X,ue,ce.e),ae!==ce.t&&((ce.t=ae)!=null?_.style.setProperty("background-color",ae):_.style.removeProperty("background-color")),ye!==ce.a&&((ce.a=ye)!=null?_.style.setProperty("color",ye):_.style.removeProperty("color")),ce},{e:void 0,t:void 0,a:void 0}),X})()}),null),T}}),null),a(W,A(Me,{get when(){return o()||n()},get children(){return A(ZF,{get rule(){return n()},onSave:m,onCancel:()=>{s(!1),i(null)}})}}),null),ge(T=>{var R=x(e()==="rules"),J=x(e()==="events"),X=x(e()==="audit");return T.e=p(P,R,T.e),T.t=p(j,J,T.t),T.a=p(z,X,T.a),T},{e:void 0,t:void 0,a:void 0}),W})()};Wt(["click"]);const hO=async t=>new Promise(e=>{const r=new FileReader;r.onload=n=>{const i=new Image;i.onload=()=>{try{console.log("Image loaded:",i.width,"x",i.height);const o=document.createElement("canvas"),s=o.getContext("2d");if(!s){console.error("Canvas context not available"),e({success:!1,error:"Canvas context not available - your browser may not support this feature"});return}if(i.width===0||i.height===0){e({success:!1,error:"Invalid image dimensions"});return}o.width=i.width,o.height=i.height,s.drawImage(i,0,0);const l=s.getImageData(0,0,o.width,o.height),c=l.data;for(let u=0;u<c.length;u+=4){const h=c[u],g=c[u+1],m=c[u+2],x=.299*h+.587*g+.114*m<128?0:255;c[u]=x,c[u+1]=x,c[u+2]=x}s.putImageData(l,0,0),console.log("Processing image data for signature detection...");const d=pO(l);if(console.log("Signature bounds:",d),d){const u=document.createElement("canvas"),h=u.getContext("2d");if(h){const m=Math.max(d.maxX-d.minX+20,50),S=Math.max(d.maxY-d.minY+20,30);u.width=m,u.height=S,console.log("Creating signature canvas:",m,"x",S),h.fillStyle="white",h.fillRect(0,0,m,S);const N=Math.max(0,d.minX-10),x=Math.max(0,d.minY-10),b=Math.min(o.width-N,m),K=Math.min(o.height-x,S);h.drawImage(o,N,x,b,K,0,0,m,S),console.log("Signature extracted, making background transparent..."),mO(h,m,S);const te=yO(d,o.width,o.height);console.log("Signature extraction completed with confidence:",te),e({success:!0,signatureDataUrl:u.toDataURL("image/png"),confidence:te})}else e({success:!1,error:"Could not create signature canvas context"})}else console.log("No signature detected in image"),e({success:!1,error:`No signature detected. Please ensure:
- The signature is dark (black/blue ink)
- The background is light (white/cream)
- The signature is clearly visible`})}catch(o){e({success:!1,error:o instanceof Error?o.message:"Unknown error"})}},i.onerror=()=>{e({success:!1,error:"Failed to load image"})},i.src=n.target?.result},r.onerror=()=>{e({success:!1,error:"Failed to read file"})},r.readAsDataURL(t)}),pO=t=>{const e=t.data,r=t.width,n=t.height;let i=r,o=n,s=0,l=0,c=0;for(let g=0;g<n;g++)for(let m=0;m<r;m++){const S=(g*r+m)*4,N=e[S],x=e[S+1],b=e[S+2];if(e[S+3]<128)continue;.299*N+.587*x+.114*b<150&&(c++,i=Math.min(i,m),o=Math.min(o,g),s=Math.max(s,m),l=Math.max(l,g))}const d=s-i,u=l-o,h=c>=50&&d>=20&&u>=10;return console.log("Signature detection stats:",{pixelCount:c,width:d,height:u,hasValidSignature:h,bounds:h?{minX:i,minY:o,maxX:s,maxY:l}:null}),h?{minX:i,minY:o,maxX:s,maxY:l}:null},mO=(t,e,r)=>{const n=t.getImageData(0,0,e,r),i=n.data;for(let o=0;o<i.length;o+=4){const s=i[o],l=i[o+1],c=i[o+2];s>240&&l>240&&c>240&&(i[o+3]=0)}t.putImageData(n,0,0)},yO=(t,e,r)=>{const n=t.maxX-t.minX,i=t.maxY-t.minY,o=n*i,s=e*r,l=o/s;let c=0;l>=.05&&l<=.3?c=.9:l<.05?c=.5:c=.6;const d=n/i;return d>=2&&d<=5&&(c=Math.min(c+.1,1)),c},Ab=async t=>new Promise(e=>{const r=new Image;r.onload=()=>{const n=document.createElement("canvas"),i=n.getContext("2d");if(!i){e(t);return}const o=3;n.width=r.width*o,n.height=r.height*o,i.imageSmoothingEnabled=!0,i.imageSmoothingQuality="high",i.drawImage(r,0,0,n.width,n.height);const s=i.getImageData(0,0,n.width,n.height),l=s.data;fO(l,n.width,n.height),i.putImageData(s,0,0),PO(i,n.width,n.height);const c=document.createElement("canvas"),d=c.getContext("2d");if(!d){e(t);return}c.width=r.width,c.height=r.height,d.imageSmoothingEnabled=!0,d.imageSmoothingQuality="high",d.drawImage(n,0,0,c.width,c.height),e(c.toDataURL("image/png"))},r.onerror=()=>e(t),r.src=t}),fO=(t,e,r)=>{for(let n=0;n<t.length;n+=4){const i=t[n],o=t[n+1],s=t[n+2];if(t[n+3]<128)continue;const c=.299*i+.587*o+.114*s,d=gO(t,n,e,r);let u;c<d?u=Math.max(0,c-50):u=Math.min(255,c+30),t[n]=u,t[n+1]=u,t[n+2]=u}vO(t,e,r),bO(t,e,r)},gO=(t,e,r,n)=>{const i=e/4%r,o=Math.floor(e/4/r);let s=0,l=0;const c=5;for(let u=-c;u<=c;u++)for(let h=-c;h<=c;h++){const g=i+h,m=o+u;if(g>=0&&g<r&&m>=0&&m<n){const S=(m*r+g)*4;if(S<t.length){const N=.299*t[S]+.587*t[S+1]+.114*t[S+2];s+=N,l++}}}return(l>0?s/l:128)-15},vO=(t,e,r)=>{const n=new Uint8ClampedArray(t),i=1;for(let o=i;o<r-i;o++)for(let s=i;s<e-i;s++){const l=(o*e+s)*4;if(t[l+3]<128)continue;const c=[];for(let u=-i;u<=i;u++)for(let h=-i;h<=i;h++){const g=((o+u)*e+(s+h))*4,m=.299*n[g]+.587*n[g+1]+.114*n[g+2];c.push(m)}c.sort((u,h)=>u-h);const d=c[Math.floor(c.length/2)];t[l]=d,t[l+1]=d,t[l+2]=d}},bO=(t,e,r)=>{const n=new Uint8ClampedArray(t),i=[[0,-1,0],[-1,5,-1],[0,-1,0]];for(let o=1;o<r-1;o++)for(let s=1;s<e-1;s++){const l=(o*e+s)*4;if(t[l+3]<128)continue;let c=0;for(let u=0;u<3;u++)for(let h=0;h<3;h++){const g=((o+u-1)*e+(s+h-1))*4,m=.299*n[g]+.587*n[g+1]+.114*n[g+2];c+=m*i[u][h]}const d=Math.max(0,Math.min(255,c));t[l]=d,t[l+1]=d,t[l+2]=d}},PO=(t,e,r)=>{const n=[{radius:.5,alpha:.3},{radius:1,alpha:.2},{radius:1.5,alpha:.1}],i=t.getImageData(0,0,e,r);n.forEach(o=>{t.save(),t.globalAlpha=o.alpha,t.filter=`blur(${o.radius}px)`,t.putImageData(i,0,0),t.restore()}),t.save(),t.filter="contrast(120%) brightness(95%)",t.globalCompositeOperation="multiply",t.putImageData(i,0,0),t.restore()},_O=async t=>new Promise(e=>{const r=new Image;r.onload=async()=>{try{const n=document.createElement("canvas"),i=n.getContext("2d");if(!i){e(t);return}const o=800;let{width:s,height:l}=r;if(s>o||l>o){const u=Math.min(o/s,o/l);s=s*u,l=l*u}n.width=s,n.height=l,i.imageSmoothingEnabled=!0,i.imageSmoothingQuality="high",i.drawImage(r,0,0,s,l);const c=i.getImageData(0,0,n.width,n.height),d=await SO(n,c,3e3);e(d)}catch(n){console.error("Vectorization failed:",n),e(t)}},r.onerror=()=>e(t),r.src=t}),SO=(t,e,r)=>new Promise(n=>{const i=t.getContext("2d"),o=setTimeout(()=>{console.warn("Vectorization timeout - using enhanced fallback"),i.filter="blur(0.5px) contrast(150%) brightness(95%)",i.drawImage(t,0,0),n(t.toDataURL("image/png"))},r);setTimeout(()=>{try{const s=wO(t,e);clearTimeout(o),n(s.toDataURL("image/png"))}catch(s){clearTimeout(o),console.error("Light vectorization failed:",s),i.filter="blur(0.3px) contrast(120%)",i.drawImage(t,0,0),n(t.toDataURL("image/png"))}},10)}),wO=(t,e)=>{t.getContext("2d");const{width:r,height:n}=t,i=document.createElement("canvas"),o=i.getContext("2d");return i.width=r,i.height=n,o.drawImage(t,0,0),["contrast(130%)","blur(0.3px)","brightness(98%)","contrast(110%)"].forEach((l,c)=>{o.save(),o.filter=l,o.globalCompositeOperation=c===0?"source-over":"multiply",o.drawImage(i,0,0),o.restore()}),o.save(),o.globalCompositeOperation="source-over",o.lineCap="round",o.lineJoin="round",o.lineWidth=1.5,o.filter="blur(0.2px)",o.drawImage(i,0,0),o.restore(),i},xO=async()=>new Promise((t,e)=>{if(typeof window<"u"&&window.PDFLib){t(window.PDFLib);return}const r=document.createElement("script");r.src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js",r.onload=()=>{t(window.PDFLib)},r.onerror=e,document.head.appendChild(r)}),CO=async t=>{const e=await xO(),{PDFDocument:r,rgb:n,StandardFonts:i,degrees:o}=e,s=await r.create(),l=s.addPage([612,792]),c=s.addPage([612,792]),d=await s.embedFont(i.Helvetica),u=await s.embedFont(i.HelveticaBold),h=(x,b,K,te,F={})=>{x.drawText(b||"",{x:K,y:te,size:F.size||10,font:F.bold?u:d,color:F.color||n(0,0,0),...F})},g=(x,b,K,te)=>{te&&h(x,"X",b,K,{size:12,bold:!0})},m=async()=>{h(l,"(40498)",540,750,{size:10}),h(l,"SOLICITUD DE SERVICIO CONSULAR",200,720,{size:14,bold:!0}),h(l,"Pasaporte por",200,700,{size:11}),g(l,280,700,t.clasificacionMigratoria==="PSE"),h(l,"primera vez",300,700,{size:10}),h(l,"FOTO PEGADA",80,600,{size:10,bold:!0}),h(l,"(4 ½ X 4 ½)",80,580,{size:8}),l.drawRectangle({x:420,y:620,width:150,height:30,borderColor:n(0,0,0),borderWidth:1}),h(l,"No del Pasaporte",430,605,{size:9}),t.pasaporteAnterior?.numero&&h(l,t.pasaporteAnterior.numero,430,625,{size:12,bold:!0}),h(l,"Carné de Identidad",430,580,{size:9});const x=new Date;h(l,x.getDate().toString(),480,550,{size:11}),h(l,(x.getMonth()+1).toString(),510,550,{size:11}),h(l,x.getFullYear().toString(),540,550,{size:11});let b=480;h(l,"Primer Apellido",50,b,{size:9}),h(l,t.primerApellido.toUpperCase(),50,b-15,{size:11,bold:!0}),h(l,"Segundo Apellido",200,b,{size:9}),h(l,t.segundoApellido.toUpperCase(),200,b-15,{size:11,bold:!0}),b-=40,h(l,"Primer Nombre",50,b,{size:9}),h(l,t.primerNombre.toUpperCase(),50,b-15,{size:11,bold:!0}),h(l,"Segundo Nombre",350,b,{size:9}),h(l,(t.segundoNombre||"").toUpperCase(),350,b-15,{size:11,bold:!0}),b-=40,h(l,"Nombre",50,b,{size:9}),h(l,t.nombre.toUpperCase(),50,b-15,{size:11,bold:!0}),h(l,"Padre",200,b,{size:9}),h(l,t.padre.toUpperCase(),200,b-15,{size:11,bold:!0}),b-=40,h(l,"Sexo",50,b,{size:9}),g(l,50,b-20,t.sexo==="M"),h(l,"Masc",70,b-20,{size:9}),g(l,110,b-20,t.sexo==="F"),h(l,"Fem",130,b-20,{size:9}),h(l,"Color Piel",200,b,{size:9}),h(l,t.colorPiel,200,b-15,{size:10}),h(l,"Color Cabello",350,b,{size:9}),h(l,t.colorCabello,350,b-15,{size:10}),h(l,"Color Ojos",450,b,{size:9}),h(l,t.colorOjos,450,b-15,{size:10}),b-=40,h(l,"Estatura (cm)",50,b,{size:9}),h(l,t.estatura,50,b-15,{size:11,bold:!0}),h(l,"Características Especiales",150,b,{size:9}),h(l,t.caracteristicasEspeciales||"NINGUNA",150,b-15,{size:10}),b-=40,h(l,"Clasificación Migratoria al salir de Cuba",50,b,{size:9}),b-=20,[{code:"PSE",label:"Permiso de Salida Indefinido (PSI)",x:50},{code:"PVE",label:"Permiso de Viaje al Exterior (PVE)",x:200},{code:"PVT",label:"Permiso de Viaje Temporal (PVT)",x:350},{code:"PRE",label:"Permiso de Residencia en el Exterior (PRE)",x:450}].forEach(te=>{g(l,te.x,b,t.clasificacionMigratoria===te.code),h(l,te.label,te.x+20,b,{size:8})}),b-=40,h(l,"Lugar de Nacimiento",50,b,{size:9}),b-=20,h(l,"País",50,b,{size:9}),h(l,t.lugarNacimiento.pais.toUpperCase(),50,b-15,{size:11,bold:!0}),h(l,"Provincia",150,b,{size:9}),h(l,t.lugarNacimiento.provincia.toUpperCase(),150,b-15,{size:11,bold:!0}),h(l,"Municipio",350,b,{size:9}),h(l,t.lugarNacimiento.municipio.toUpperCase(),350,b-15,{size:11,bold:!0}),b-=40,h(l,"Fecha Nacimiento",450,b+40,{size:9}),h(l,"Día",420,b+20,{size:9}),h(l,t.lugarNacimiento.diaNacimiento,450,b+20,{size:11,bold:!0}),h(l,"Mes",480,b+20,{size:9}),h(l,t.lugarNacimiento.mesNacimiento,510,b+20,{size:11,bold:!0}),h(l,"Año",540,b+20,{size:9}),h(l,t.lugarNacimiento.anoNacimiento,550,b+20,{size:11,bold:!0}),h(l,"Dirección de la Residencia Actual",50,b,{size:9}),b-=20,h(l,"Dirección (calle, ave o apto, entre calles)",50,b,{size:8}),h(l,t.direccionActual.calle.toUpperCase(),50,b-15,{size:10,bold:!0}),b-=40,h(l,"Provincia - Estado - Región",50,b,{size:9}),h(l,t.direccionActual.provincia.toUpperCase(),50,b-15,{size:10,bold:!0}),h(l,"País",300,b,{size:9}),h(l,t.direccionActual.pais.toUpperCase(),300,b-15,{size:10,bold:!0}),h(l,"Código Postal",450,b,{size:9}),h(l,t.direccionActual.codigoPostal,450,b-15,{size:10,bold:!0}),b-=40,h(l,"Teléfono",50,b,{size:9}),h(l,t.telefono,50,b-15,{size:10,bold:!0}),h(l,"Fax",200,b,{size:9}),h(l,t.fax||"",200,b-15,{size:10}),h(l,"E-mail",350,b,{size:9}),h(l,t.email,350,b-15,{size:10}),b-=40,h(l,"Datos Laborales o de Estudio Actual",50,b,{size:9,bold:!0}),b-=20,h(l,"PROFESION",50,b,{size:9}),h(l,t.datosLaborales.profesion.toUpperCase(),50,b-15,{size:10,bold:!0}),h(l,"OBRERO",200,b,{size:9}),h(l,t.datosLaborales.ocupacion.toUpperCase(),200,b-15,{size:10,bold:!0}),h(l,"MECANICO",350,b,{size:9}),h(l,"Ocupación",350,b+10,{size:8}),b-=40,h(l,"Nombre del Centro de Trabajo / Estudio",50,b,{size:9}),h(l,t.datosLaborales.nombreCentroTrabajo.toUpperCase(),50,b-15,{size:10,bold:!0}),b-=30,h(l,"Dirección (calle, ave, etc, entre calles)",50,b,{size:9}),h(l,t.datosLaborales.direccionCentro.toUpperCase(),50,b-15,{size:10,bold:!0}),h(l,"Teléfono",400,b,{size:9}),h(l,t.datosLaborales.telefonoCentro,400,b-15,{size:10}),b-=40,h(l,"Observaciones:",50,b,{size:9}),t.firmaBase64&&l.drawImage(await s.embedPng(t.firmaBase64),{x:350,y:50,width:150,height:60}),l.drawLine({start:{x:350,y:50},end:{x:500,y:50},thickness:1,color:n(0,0,0)}),h(l,"Firma y Cuño del Funcionario",375,35,{size:8})},S=()=>{h(c,"(40498)",540,750,{size:10}),h(c,"Nivel Escolar",50,700,{size:9}),h(c,t.datosLaborales.nivelEscolar.toUpperCase(),50,680,{size:11,bold:!0}),h(c,"Nombres y Apellidos de la referencia en Cuba",50,640,{size:9}),h(c,t.referenciaEnCuba.nombre.toUpperCase(),50,620,{size:11,bold:!0}),h(c,"Parentesco",350,640,{size:9}),h(c,t.referenciaEnCuba.parentesco.toUpperCase(),350,620,{size:11,bold:!0}),h(c,"Dirección de la Referencia (incluir la provincia)",50,580,{size:9}),h(c,t.referenciaEnCuba.direccion.toUpperCase(),50,560,{size:10}),h(c,"Lugar de Residencia en Cuba (dos últimas direcciones)",50,500,{size:9});const x=460;c.drawLine({start:{x:50,y:x+20},end:{x:550,y:x+20},thickness:1}),c.drawLine({start:{x:50,y:x},end:{x:550,y:x},thickness:1}),h(c,"Desde",350,x+5,{size:9}),h(c,"Hasta",450,x+5,{size:9});let b=380;h(c,"Apellidos de soltera",50,b,{size:9}),h(c,t.apellidosSoltera||"",50,b-15,{size:10}),h(c,"Otros nombres",200,b,{size:9}),h(c,t.otrosNombres||"",200,b-15,{size:10}),h(c,"Número de residencia",350,b,{size:9}),h(c,t.numeroResidencia||"",350,b-15,{size:10}),h(c,"Pasaporte extranjero",480,b,{size:9}),h(c,t.pasaporteExtranjero||"",480,b-15,{size:10}),b-=60,h(c,"Para la confección del Pasaporte el titular presentó y se comprobó con:",50,b,{size:9}),b-=20,h(c,"Pasaporte vencido:",50,b,{size:9}),b-=30,t.pasaporteAnterior&&(h(c,"Número",50,b,{size:9}),h(c,t.pasaporteAnterior.numero,100,b,{size:10,bold:!0}),h(c,"Fecha de expedición",250,b,{size:9}),h(c,t.pasaporteAnterior.fechaExpedicion||"",350,b,{size:10}),h(c,"Lugar",450,b,{size:9}),h(c,t.pasaporteAnterior.lugar||"",480,b,{size:10})),b-=40,h(c,"Certificación de Nacimiento:",50,b,{size:9}),b-=20,h(c,"Tomo",50,b,{size:9}),h(c,t.certificadoNacimiento.tomo||"",100,b,{size:10}),h(c,"Folio",200,b,{size:9}),h(c,t.certificadoNacimiento.folio||"",250,b,{size:10}),h(c,"Registro Civil",350,b,{size:9}),h(c,t.certificadoNacimiento.registroCivil||"",430,b,{size:10}),b-=40,h(c,"Inscripción Consular",50,b,{size:9,bold:!0}),b-=30,t.inscripcionConsular&&(h(c,"Número",50,b,{size:9}),h(c,t.inscripcionConsular.numero,100,b,{size:10}),h(c,"De Fecha",250,b,{size:9}),h(c,t.inscripcionConsular.fecha,320,b,{size:10})),h(c,"Arancel",450,b+30,{size:9}),h(c,"$",490,b+10,{size:12}),h(c,t.arancel||"",500,b+10,{size:12,bold:!0}),b-=40,h(c,"Valoración Consular",50,b,{size:10,bold:!0}),c.drawRectangle({x:50,y:80,width:500,height:b-100,borderColor:n(0,0,0),borderWidth:1}),c.drawLine({start:{x:350,y:50},end:{x:500,y:50},thickness:1,color:n(0,0,0)}),h(c,"Firma y Cuño del Funcionario",375,35,{size:8})};await m(),S();const N=await s.save();return new Blob([N],{type:"application/pdf"})},vf=async(t,e={})=>{try{const r=Gt.state.user;if(!r)throw new Error("User not authenticated");const{status:n="draft",applicationNumber:i,processingNotes:o,overwrite:s=!1}=e,l=new Date().getTime(),c=ki(),d={applicationData:t,status:n,userId:r.uid,createdAt:l,updatedAt:l,applicationNumber:i,processingNotes:o,id:ki()};if(n==="submitted"&&!i){const g=Date.now(),m=`${t.primerNombre?.[0]||"X"}${t.primerApellido?.[0]||"X"}`;d.applicationNumber=`CUB-${m}-${g}`}console.log(d),console.log(JSON.stringify(d,null,4));let h={query:"addCubanPassport",params:{businessId:Gt.getBusinessId()},form:d};return console.log(h),console.log("Passport application saved successfully:",c),c}catch(r){throw console.error("Error saving passport application:",r),new Error(`Failed to save passport application: ${r instanceof Error?r.message:"Unknown error"}`)}},bf=async(t,e,r={})=>{try{if(!Gt.state.user)throw new Error("User not authenticated");const{status:i,applicationNumber:o,processingNotes:s}=r,l={applicationData:e,updatedAt:new Date().getTime()};if(i!==void 0&&(l.status=i),o!==void 0&&(l.applicationNumber=o),s!==void 0&&(l.processingNotes=s),i==="submitted"&&!o){const u=Date.now(),h=`${e.primerNombre?.[0]||"X"}${e.primerApellido?.[0]||"X"}`;l.applicationNumber=`CUB-${h}-${u}`,l.submissionDate=new Date().getTime()}console.log(l);let d={query:"updateCubanPassport",params:{businessId:Gt.getBusinessId(),id:l?.id},form:l};console.log(d),console.log("Passport application updated successfully:",t)}catch(n){throw console.error("Error updating passport application:",n),new Error(`Failed to update passport application: ${n instanceof Error?n.message:"Unknown error"}`)}};let $c=null;const AO=(t,e,r=2e3)=>{$c&&clearTimeout($c),$c=setTimeout(async()=>{try{if(e)await bf(e,t,{status:"draft"}),console.log("Application auto-saved");else{const n=await vf(t,{status:"draft"});return console.log("New application auto-saved:",n),n}}catch(n){console.error("Auto-save failed:",n)}},r)},$O=()=>{$c&&(clearTimeout($c),$c=null)},$b=()=>new Promise(t=>{const e=document.createElement("div");e.style.cssText=`
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10000;
      backdrop-filter: blur(2px);
    `;const r=document.createElement("div");r.style.cssText=`
      background: white;
      border-radius: 12px;
      padding: 2rem;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
    `,r.innerHTML=`
      <div style="text-align: center; margin-bottom: 1.5rem;">
        <div style="font-size: 3rem; margin-bottom: 0.5rem;">⚡</div>
        <h3 style="margin: 0; font-size: 1.5rem; color: #333;">Procesamiento Avanzado de Firma</h3>
      </div>
      
      <div style="margin-bottom: 1.5rem; color: #666; line-height: 1.5;">
        <p style="margin-bottom: 1rem;">El procesamiento vectorizado utilizará algoritmos avanzados que:</p>
        <ul style="text-align: left; padding-left: 1.5rem; margin: 0;">
          <li style="margin-bottom: 0.5rem;"><strong>🔧 Recursos:</strong> Consumirá más CPU y memoria</li>
          <li style="margin-bottom: 0.5rem;"><strong>⏱️ Tiempo:</strong> Puede tomar 2-5 segundos adicionales</li>
          <li style="margin-bottom: 0.5rem;"><strong>💻 Rendimiento:</strong> Funciona mejor en dispositivos modernos</li>
          <li style="margin-bottom: 0.5rem;"><strong>✨ Resultado:</strong> Mayor calidad y suavizado profesional</li>
        </ul>
      </div>
      
      <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem;">
        <p style="margin: 0; font-size: 0.9rem; color: #666;">
          <strong>💡 Alternativa:</strong> Si cancela, se usará el procesamiento "Mejorado" que es más rápido y consume menos recursos.
        </p>
      </div>
      
      <div style="display: flex; gap: 1rem; justify-content: flex-end;">
        <button id="cancel-btn" style="
          padding: 0.75rem 1.5rem;
          border: 2px solid #ddd;
          background: white;
          color: #666;
          border-radius: 8px;
          cursor: pointer;
          font-weight: 500;
          transition: all 0.2s;
        ">Usar Mejorado</button>
        <button id="continue-btn" style="
          padding: 0.75rem 1.5rem;
          border: none;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          color: white;
          border-radius: 8px;
          cursor: pointer;
          font-weight: 500;
          transition: all 0.2s;
        ">Continuar con Avanzado</button>
      </div>
    `;const n=r.querySelector("#cancel-btn"),i=r.querySelector("#continue-btn");n.addEventListener("mouseenter",()=>{n.style.borderColor="#bbb",n.style.color="#333"}),n.addEventListener("mouseleave",()=>{n.style.borderColor="#ddd",n.style.color="#666"}),i.addEventListener("mouseenter",()=>{i.style.transform="translateY(-1px)",i.style.boxShadow="0 4px 12px rgba(102, 126, 234, 0.4)"}),i.addEventListener("mouseleave",()=>{i.style.transform="translateY(0)",i.style.boxShadow="none"});const o=()=>{document.body.removeChild(e),document.body.style.overflow=""};n.addEventListener("click",()=>{o(),t(!1)}),i.addEventListener("click",()=>{o(),t(!0)});const s=l=>{l.key==="Escape"&&(o(),document.removeEventListener("keydown",s),t(!1))};e.addEventListener("click",l=>{l.target===e&&(o(),document.removeEventListener("keydown",s),t(!1))}),document.addEventListener("keydown",s),e.appendChild(r),document.body.appendChild(e),document.body.style.overflow="hidden",setTimeout(()=>i.focus(),100)});var EO=le("<div><span>"),IO=le('<div><div><div><h4>Firma Procesada</h4><p>✓ </p></div></div><div><img alt="Firma Extraída"></div><div><p>Esta firma se incluirá en el PDF del pasaporte. Verifique que se vea claramente antes de generar el documento.</p><p>🔍 Haga clic en la firma para verla en tamaño completo'),TO=le("<div><strong></strong> "),kO=le("<span><span></span>Guardando..."),NO=le("<span><span></span>Enviando..."),LO=le("<span><span></span>Generando..."),RO=le("<span>ID: <!>..."),DO=le("<div><h2>SOLICITUD DE SERVICIO CONSULAR</h2><p>Pasaporte Cubano </p><div><h3>Datos Personales</h3><div></div><div></div></div><div><h3>Características Físicas</h3><div></div></div><div><h3>Clasificación Migratoria al salir de Cuba</h3></div><div><h3>Lugar de Nacimiento</h3><div></div><div></div></div><div><h3>Dirección de la Residencia Actual</h3><div></div></div><div><h3>Información de Contacto</h3><div></div></div><div><h3>Datos Laborales o de Estudio Actual</h3><div></div><div></div></div><div><h3>Referencia en Cuba</h3><div></div></div><div><h3>Pasaporte Anterior (si aplica)</h3><div></div></div><div><h3>Certificación de Nacimiento</h3><div></div></div><div><h3>Firma del Solicitante</h3><div><label>Tipo de Procesamiento de Firma</label><select><option value=basic>Básico - Sin procesamiento adicional</option><option value=enhanced>Mejorado - Reducción de ruido y suavizado</option><option value=vectorized>Vectorizado - Calidad profesional (requiere confirmación)</option></select><div></div></div><div><p>Suba una imagen con su firma sobre fondo blanco para mejores resultados</p><input type=file accept=image/* id=signature-upload-cuban><label for=signature-upload-cuban>Subir Imagen de Firma</label></div></div><div><div></div><div>"),MO=le('<div><div><div><h3>Vista Completa de la Firma</h3><p></p></div><div><img alt="Firma en tamaño completo"></div><div>'),FO=le(`<style>
        @keyframes spin {
          to { transform: rotate(360deg); }
        }
      `);const OO=t=>{const[e,r]=Se({clasificacionMigratoria:"PSE",sexo:"M",colorPiel:"Blanca",colorOjos:"Castaños",colorCabello:"Negro",lugarNacimiento:{pais:"CUBA",provincia:"",municipio:"",diaNacimiento:"",mesNacimiento:"",anoNacimiento:""},direccionActual:{calle:"",provincia:"",municipio:"",pais:"ESTADOS UNIDOS",codigoPostal:""},datosLaborales:{ocupacion:"OBRERO",profesion:"MECANICO",nivelEscolar:"PRE-UNIVERSITARIO",nombreCentroTrabajo:"",direccionCentro:"",telefonoCentro:""},referenciaEnCuba:{nombre:"",parentesco:"",direccion:""},certificadoNacimiento:{tomo:"",folio:"",registroCivil:""},...t.initialData}),[n,i]=Se(null),[o,s]=Se(!1),[l,c]=Se(!1),[d,u]=Se("enhanced"),[h,g]=Se(!1),[m,S]=Se(!1),[N,x]=Se(t.applicationId),[b,K]=Se(null),[te,F]=Se(!1);Un(()=>{const z=e();z.primerNombre&&z.primerApellido&&z.email&&AO(z,N())}),Ll(()=>{$O()}),Un(()=>{te()?document.body.style.overflow="hidden":document.body.style.overflow=""});const V=z=>{z.key==="Escape"&&F(!1)};Un(()=>{r({clasificacionMigratoria:"PSE",sexo:"M",colorPiel:"Blanca",colorOjos:"Castaños",colorCabello:"Castaño",lugarNacimiento:{pais:"UNITED STATES",provincia:"SANTIAGO DE CUBA",municipio:"SANTIAGO DE CUBA",diaNacimiento:"19",mesNacimiento:"2",anoNacimiento:"1985"},direccionActual:{calle:"330 STARLET COURT",provincia:"KY",municipio:"FAIRDALE",pais:"UNITED STATES",codigoPostal:"40118"},datosLaborales:{ocupacion:"OBRERO",profesion:"MECANICO",nivelEscolar:"PRE-UNIVERSITARIO",nombreCentroTrabajo:"WALMART",direccionCentro:"175 OUTERLOOP ",telefonoCentro:""},referenciaEnCuba:{nombre:"ALINA PRADO",parentesco:"",direccion:"GRABD ASND AMAISJD ASLJD A,SD ASKASD ASDKAS ADK"},certificadoNacimiento:{tomo:"38",folio:"78",registroCivil:"SONGO LA MAYA"},primerApellido:"JODNASDJ",segundoApellido:"JSADNDN",primerNombre:"NKJASDA",segundoNombre:"JNJN",nombre:"JNJN",padre:"JN",estatura:"176",telefono:"5023231345",email:"nshdgvau@gmail.com",pasaporteAnterior:{numero:"K582932",fechaExpedicion:"2025-04-15",lugar:"LA HABANA"},firmaBase64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFcAAABSCAYAAAAhBUjfAAAQAElEQVR4AeybCVhUZdvHz4EZBsJdE0GZGXZRy9z30resy7LMSkpbNItEzbVFLXPjde9T08yyV818Wy61bLm0vbTUVFxQK2OQZQA3NCXLgJmB8/3uSfgAFQeECfjwOg8zZ+ac5zzP/7nv//2/72f0UGr/VRoCteBWGrSKUgtuLbhlQkCdPn26R9HG3erFxov7jppkuWrv3r11/fv3Dz169Ghri8XS5qeffmojr8OHDw/ncx/3wfr3k2oKuGq/fv28PD0929WvX3+Fj4/PBoPBsN5ut6/39fXdoNfr1+bl5XUdNGiQl1g0UxdL5qVyjxoBLqDpVVXt0qxZs5U7d+7stW7duvBdu3aFHTlyJPTtt98Oe+eddzryXSxQdk5MTAyRheB9pQNc7cHVNE39888/6wcGBk779ttvb0xLS9N37drVsXLlytRZs2YlRUZG5thsNnXz5s0dw8PD1zVu3HhlnTp12o8ZM8arsgGuzuBK4NJNnDgxpG7dupFr1qwJ9Pf3V1u3bp370ksvHYAGnmjUqNGQjRs3bv3mm28S27Rp41iwYIHpiy++6AHAr7IgPcTiKxPg6gyusnfv3rpNmjRZ0qlTp1XQgt/s2bMtixYt2oY1x2RnZ//4+++/x2dmZo4EwKGjRo3a3adPH3tKSoonYN+I9cbSOk6YMMGb7yuFIqoluIAnVmsIDg4Omzt3bviUKVOCGzZseGr79u3DcnNzR9x2222H7rzzztyoqKi8Hj16WE+cOLEXsKeiGvZ36dIlF4A9fvjhh05Y8KJz586ZALdSjmoJ7syZM/U5OTmdAfQ/119/vQk14MBq0wDLAqhpWHFeUbQE5L/++isO+hgZExOzG2u3/frrr7r333+/xZYtWwxcW2u5gOA80tPT6yC7psGfrXmvDw0N/R1Xnw8NnAdYzXlRiT8jRoywX7hw4TCBLbZevXpndDqdcvLkSc8bb7yxGfJMgluJO679tNpZLoFLODJ09erVpri4OA/AsY0ePToJirBi0Y7SIBELbtGihRWgk81mc463t3djaON5aKOpUE1p95bnu2oFLham++OPP7p07dr1DX9/f6NM+PTp01b4cywgW+X8as3X1zcdKpgMLViRaDrem/gs6K233hJ6uNrtZfq+2oB70bLqwLPT5s2bdwNprR5qcMCh1gYNGiRjlTZXZj5jxgwbFJKBVMsFXLnFyL+5WVlZQZxUKPdWG3DhUmXVqlUe6NqmRHsnCM2bN/9j69at80lzzwOMy0erVq1EDyukyMr+/ft1WG3AK6+88v/TcsVqEfxOQzhz5ozCuQJn5t53332JBKc0srFSubYk6j179rT36tXrBBZvI7NTUB4allvysms+dw74mnup5A727dunGz9+vHnhwoVhCH+Dh4eHAsjpVL1GBQQEpPF4jVaW4wwWuwCNewaP0NDACrxblvtdurZagAu/1kebLgPYd9u3b29s27Ztft++fdPgzKRly5a5xLVF0RBL//nnn086HA77qVOnNKpoRb+usPfVAVyVWoHHkCFDWqAWgsjCNLj2EMBOJ4H4AyTKarXcoihUxlQyOwXVoYrmdX5YwX+qHLjwqXqxefDqQfAyPPXUU+bDhw97Hzx4UL5L/+2332L4Lm7Dhg155cUDcJX7779fYYGcHF7efkq7r8qB++OPP3qfPn06lOyp5dmzZ1viujfffvvtKwlAJgKREhQUlHPo0KFUgC0zHRQFYs6cOQq1BoUFU3iGgicU/bpC3lc5cIncRoLL2/Drx9ddd90mZrmSjOqG7777Tk+y4MCNT5Fl5fP5NR1sBWnx8fGKBDM4XWFBy0UvpQ2iyoCLm6uUEAVAM8ErjCJMMFIp9K677jIS2T2aNm2q3HTTTRdIVecCfpl0LcHLi8JNC7zBl8ULpXLWKjY2NoT014BaEL3r9eyzz5r5vDXjaHOZFsZnZd6DqzLgigWQ2ta/4YYbnmMidbFcG6ogBZfNFS1K5UvkV156enrmvn37yqRr6bsRicbzGRkZwbj/ItoGUuhX/Pz8GvOdymI1ueeeexYD7nqK6CXbhszMzNegIiPjciYv3OPSUWXAJS1Vn376ad2KFSv88vPzFcDcnZqaGoNlWUlVNV6LBp4yTXLkyJH6bt26mQliLfGKcKil5fz584OPHTvmhQxTsWav559/PohtoAg85pKG97QkYQliDFI9E8xcer5c6NIqVPZFVLQ03NeBOkgH3P0ogqm48kGAdQYuwFZIHjzJzPw6dOjgWZbxfP/998ovv/ziD6++DJhmuFxFfSgmk0mhXCkZmsKGZi60kYJVWy62BF6TabnQVdOkpKTpSLZu7C6buUdAvuoQqgy4jFQCShaBZjRU8AiF7cMhISFBgOoDqArZlArYdXDhyYBQj+tdPtgGEhD19NOCm5w1BEB2egJ9iZdokZGRGejnp6g33Ms1ztasWbNoaMrauXNnTyiqHVa9pmXLlqu8vLw6EVSFg0u14KoELnNSHPxJpSVjXX5MdDk8FwhXKrfeequGNBPd60dRXCy31InRR+GxfPlyO9vrJ9G0Dvg7H+vXsOLCzAzQ7BSFrMi7hMmTJydyo4WWSFHI8vHHH1s2bdqUwP3pVOSaUYPoxrjmsMjOkifXXfGoauDKQMWCVSYhFhaUnJzshfXmdezY8Rhf5hOYDLilieaSa3KPguX+FhYWFgvl7N25c2cCvJ6EJebKdyyeAgWdZgHm4/Kn4X55vkI2qEJJZ+DnsXjRfe++++7TiYmJJ2l6FjmABa92livzVdge11Fj9ZOdBmq2CkBkHzlyZA1cnI2VmSIiIl7jc7PzYhf+EIjsWF0cr4/g0gO2bds2HM5NAVgN4BQWzGnZPNfOFryewruZ7SDzY489phHITvTv39/GDojC851Poy+FsqXzfWl/qqLlKgAgP/KYBEfWJTPLWbBgQSbKYQhg+CDXvOBl2ZQUyy5tbsW+A1ibt7d3KrvFSS+++GIqkstGf4pwL4HKC24N4lmRKIZb2D1eGxgY+B/23LoDZC8k2xoAX8GC+kNPdoA+htrI5n6nlRd7UJGTKgluQkKC/sCBA36M0xO9K1w4DkuzyzmBxxYbGysgZXNepgOANVSDDpUQCKDeWKzzfhazCeAtouK2nj21JUivgOPHj7d75JFH3oTfXyc77AKdmAhiHs8999xebnqBNNwq/fH+ikd5wVXpURovFX6IKtCo14oF5yPuU6jbHoXncpmMJBJWgB6Fq7q0Z1ZydJQYTe3atZsP7ZixPFVcHbnlBZc2v+OOO3zYmj/OcyZ99NFHuwFa5frmWLcHO83WPXv27CbQTmEx4gA3p2TfJc/LBa78zuqhhx7y7927t66gw4p6lb7JnoxM0MCk//zqq6/eB4CmnPtgbQqBJ7devXry2wSn/i3LcwlSOlzbCOcGSQKBVyjIO6EGjQVLp9YwnKA3euPGjQdJucey1xYtG5ks7EnUwlhk29Dz58/vEW525bnlAVfFbQMY2Ex4qiPbL1eL2mLhBe2qYyIKm1AGS5mACc71xcqm/etf/1oDuAK4wkQV0lTp76p9lbhARXk0glMncX8TFk6FIpwVMQCTREIl2dBRHAqGCmYT0Dz79OmTSNUsEeATbrnllsQPPvggFcsWlVEq1xY8tzzgKjzMwEM7kkouInp3mjFjxuUAVgV4OCr4mWeeiWCbJkgshwdfCRiVuq2eiZnRlsFYkAFL1SGhgrGaYFzYQHPAlyfZ2rHTl9R7i/ZV9D2PKX4wRn1WVlbwp59+asJa9SyexiLmQz/5SD0NBRIA166g7yWDBw++HvmmiUSDe8dhsaPoLY0sskzVuHKBS2VKI+B4rV27tiODnAYnNeXhxQ4mr+KCTeCnZejHTbTXce+2MsliF148ATh5V5+IPYlCST0JNvIZi6harVYpkivcn/P555+/i3X7I+TDly5dGspzvGm6CRMmBMgrnVwOZJWCjxEv+B+klxEw88aOHZvKToRl9+7dFrjU8sYbb1jRznlkhcdQJFNRCClRUVE2xpPcvXv3o7wvcwAtF7hMQGOizF3LJ+tRGjVqxEfFDyzaaSlkPmGI9vAtW7b0YhGWAZxkNpcAgNurZEK6N998U1SCnoDjdFnORYdK53KPDynpS0z8A0D4iKDyHtbdnbF0IGOag7u3BfBLvEgWVMBdt25dcFpamheWe5oANZaCzb1Qw0BpcPBAFnQgicOT0N7ei+4vzy13KzO4aDwDbtMCzWhgoKeY/DwGlll0BEzQQH2ga1RU1GI40si1wtP6Dz/8MJB2RX3KpBV0pWybi5VKPUAhWisAr6A7Ze/MY968eWb21MIeffTRMPq/CbDfxBL/SzAaWLdu3dfQwybGIgvBy98H3zdECUyCchrB4yoLl4dHZFAoSgRIS0GjlGm5++67U1kMkX1/33wNf8sELqaqMkAT2y4zmFRzKMHOqp8oORgm2JQJTV2yZMlNZFd5TzzxRBrFbgkEVx0q1uPcHRCgkUeSCQmoDrg7Bd5OoKj9K8AmMRYb13rCg/JTpBAs0Xf16tVBX375pXfRh6xfv94L8IJZcBNj15OB2dnZyBg4cGA292q0/KKNhZRgJa1oN+V6XxZwVbaxvYim5tGjR5vQe+qDDz54jJUuucrqJ5984rVw4cIAgNe45kBWVtYS1EU6mjWddPKyIMOXMgHt3LlzGjwtikCBsx0DBgywTpo0KZ4+RuDG9+MFY7G+6byeIqEQC3dyMqA5yL5SyaBy6avQcgHWhNpYiEdIqTGP8e4hO5tAQiAFogoBUQZ+ueYyuDJgoqekf1MaNGjQkML2HvjpWaJrOh0XGyTpqQbH5WNd56CFz5n4EPL041jzGCz4kh9xUC+V6G0aOnRoCOAaAEKBSzWo5Xx8fPzTcOlg+tkB2OkEl/EUU2biNX4ssJMyWAx7VFTULjTpSIriUj4MIqvypulwfyMLHUwiooejzxK8ZnHdAQLaZReZuVTY4TK4WKFKQNATnPzQhadxs5mAewBKKCbmmZCByB3o6+trQKo1gBZGQA9NAWkOlneQRbIDulq0cU9DEoNlaMm1pKGBlANVgNUIinlIsuPsnXnixmATFEmKGr58+fIQ+NFAcFTI/xXGcQELXYt88sJDXoN717CLLNvxDfGcSfB2I4zADu8mM6Y0ii5S2qwwEK/UkUvgMnnvIUOGmJElQQQBPROyAfYJuKrYIAUwZJIJgGYDqhFX9kLj+nNtPvryJC6pfv3110Fbt26NKGg7duwIZwc2Ak4No78QhL43Vq8Ahvr44497cn97lME6FMkGQFyHNjVihSo1WbFaDWvWsPLr4OEpSKg1BLvu48aNiwDQUBYpnH6N0IAolwwk3bNIQtGrxTztSuBc6+eugKtCBwHIn1dJeV9ni6V5y5YtVSyk2LMFWKxJx0aeCc1oxnIkfVUA2D516tQM3NWGpmwMNbwKZ24qaOjVj7DMNXa73QggKtaqkP7Kb7dUZ12LhwAABrhJREFUqlP1SCJmQQHtH3jggVYvv/yy/P8yb4DP5xprv379LNHR0Vbu8WAhQnluBDTgg0U3xNKXsoPwFjRjgkbyoCUr8zi6ePFioYOKB7cYGn+fuAKuAk8ZiMYmrMAse/xM+DjWWYwOUAgG3L4DgEzD+pxJBa6uPfzwwydw0xXQhx7LCh8+fHgoQITTIqQx6Qiq/8FkQt6IeOFahQWSPS9l4sSJOnjYn1TVA8CkqC0/CrEToA5jxdFQx73IwWhqHId4ho19LrFmoQodCsU8bdq0EIzC4+abbz7Iws1ioc8ybbcAy3Nc+1/rgKngjgpcK4WONNxyGvtNEsikD9mLUg8cOGAklXwZRdEJC3EWdOBdlbKdH3Qyk+CzHkuS/SfhVA9SSsmaxCuk0iW8Kfm9ggs7CymoAQ1AHET/5CeffPJXVMMR7j/Ss2fPbejq4VjkD1ikRV45j8a6t7HgiXhVjgREoS5ATeL673nWaKTjLjxLaKxqgUuWpSCHVAYpETwbyzzOfpNNkBU6QB14UUESyw7+7LPPnNkVUkfDUrWYmBhvAA4dPHhwJJYYQupsYLE0vs8nn3cQ/VOghRTOc+BrSSJyWMhkrNHSt2/feCx6JEANIgsbBL8OAswY2k88JxeOzpdXvjuEFcfQHqUws4OCSwKg7mBcQ1EZMfQbz6K7jQ4EF2ku0QIg2aVgAj86AFPuc1qrSCistRmBIxAXn4zwb4I12YKCglKIyBYKIamAY2dRFBZExW1VLNiGC6dwzVEA3c890QSwxwk2ItHyiOZxWOzD3DcApTAYGvqeGsbP0t57772fqbMmYYHFtDXB0UHml4xaiBMrBsyB0FQ0z9rN9ckEYachOAfuxj+ugKtRP8hAG84lqmcCsAGOlJ/+hKFZu8F9M4j411OHzcYdk9G0P2BJQ2n3MsFHu3Tpsp3PUglCNqPRKDuuqfDn4yzSAPTpw4C3EzCT+T4H1z3HIsxk/vvpM5GgmIT1icXx0dUPsWTiQyr3WVj4FLxLfgXpNhooOUJXwFWwDBugpqIxU6nhBpBpvQFAm2ireN9h0aJF57C0MQS0+7DOEVjyHtSBBYuP4zwa1xyKBJKkQxYgFaVgIU21kMklsQBO8OhfAlEeVn4SyxRuzGew5QFG7invvTyy4g6XwOVxGoEmHTedQvtp3LhxRtLYCPhUfiT3G1H4T9w6FSs7Qj0gRdxQrEhe5dxms+3BXf9NgEsj2/ovYMsP6QoAEDB4hCJUU/je+UE1/+MyuPBYjlgkxY8XcLk4rCsZhbCH+c8SuuBVgClonBYeGqDboYnj3C9y7HaC2nWF39bgN66CKxAIcHYi8h64chjJwAD4dhjne/myWIDh/JIDjpVn/YXE+oJAduGSC2rgBzLhskxLAM7BtZNw9QRuTKYJZ8rnvC31kGvqEcGfRCO3QpcWFLVVLB/sNfmdbKkdVLcvywquzE9AklbAmfKZSw0EddBKFyx/Ca+yI6EAsp5MLhAuN0AbLvVTXS4qD7jlnhtUIvVXA5xrIgg6i9pQixkVshi1gJQ2ebDjUFiLLfeDrnSjmz93G7iAqWRmZipkV5Lq5kMrau/evXUkEca4uLggJJ5CYcZKeVJoxs0wVM7j3AYuGZkSHBzstEq2UpyzgRoakmRMAuD6UEIaicoYagOSqQntOK+pzn/cAi5cqy1YsCCXHYF03N5OLVYlqEnhRk9Nwp8gp1IuTCNLO0pl7B9JVStjEd0CLpaqEbSs27dvf4ZEIoXS5TFSaBsWKz/FF6o4Cx3MJ33+Xa6tjIn+E326BVyZmKTQ7CYkx8bGbvfx8RlHpcsKuBplTA26cLBDcYpqlkOurSnNbeBSLJctmbMohpkEtoMUxDV2NoyoBIPsarATUVMwLZyH28AVd5cdVxTCMWoO+WzNdCTILaMSFkhS4vxPfIWjqiFv3AZuAV4UdPSkwG2x1tkEs/ZUy1Q2ITPYlqkxEqxgrm4HF+VgRiks3bx5c+f9+/d7UM+1si0+Hku2Fgyqpry6G1z5NY4Pu8FG+RkqsitfEgekWDKUUWMkWIFxuBtcpUePHrlsCWWwS5w9bNiwQ9R2/81gsmg1InFgHoWHu8GVX9GkXrhwYXxkZOSHZGUj2L3YhZL4P6stHFr1f+NucBWARBzkxlM8f4FtoHjOr1oLrq4wux1ckWRsc9vYd8tYuXKlAFvj6KDAGNwO7sUHC6DSLp7WzJd/CtyaiWaJWdWCWwKQijytBbci0SzRVy24JQCpyNNacCsSzRJ91YJbApCKPK0FtyLRLNFXLbglAKnI0/8FAAD//9Sz9BgAAAAGSURBVAMAr+VxWSjQ0ZEAAAAASUVORK5CYII="})});const W=(z,T)=>{r(R=>({...R,[z]:T})),K(null)},I=(z,T,R)=>{r(J=>({...J,[z]:{...J[z],[T]:R}})),K(null)},E=async z=>{const R=z.target.files?.[0];if(!R){console.log("No file selected");return}console.log("Processing file:",R.name,"Size:",R.size,"Type:",R.type),i(R),s(!0);try{if(!R.type.startsWith("image/"))throw new Error("Please select a valid image file");if(R.size>10*1024*1024)throw new Error("Image file is too large. Please select an image smaller than 10MB");console.log("Extracting signature from image...");const J=await hO(R);if(console.log("Extraction result:",{success:J.success,hasSignature:!!J.signatureDataUrl}),J.success&&J.signatureDataUrl){let X=J.signatureDataUrl;const H=d();console.log("Enhancement type:",H);try{H==="enhanced"?(console.log("Applying enhanced processing..."),X=await Ab(J.signatureDataUrl)):H==="vectorized"&&(await $b()?(console.log("User approved vectorized processing..."),X=await _O(J.signatureDataUrl)):(console.log("User declined vectorized processing, using enhanced instead..."),X=await Ab(J.signatureDataUrl))),console.log("Processing completed successfully")}catch(se){console.error("Enhancement failed, using basic extraction:",se),X=J.signatureDataUrl}W("firmaBase64",X)}else throw new Error(J.error||"Could not extract signature from image. Please ensure the image contains a clear signature on a white background.")}catch(J){console.error("Error extracting signature:",J);const X=J instanceof Error?J.message:"Unknown error processing signature";alert(`Error: ${X}

Tips:
- Use a clear image with good contrast
- Ensure signature is on white/light background
- Try a different enhancement type`)}finally{s(!1)}},L=async()=>{const z=e();if(!z.primerNombre||!z.primerApellido||!z.email){K({type:"error",text:"Por favor complete al menos el nombre, apellido y email antes de guardar"});return}try{g(!0),K(null);let T=N();T?await bf(T,z,{status:"draft"}):(T=await vf(z,{status:"draft"}),x(T),t.onSave?.(T)),K({type:"success",text:"Solicitud guardada como borrador exitosamente"})}catch(T){console.error("Error saving draft:",T),K({type:"error",text:T instanceof Error?T.message:"Error guardando la solicitud"})}finally{g(!1)}},M=async()=>{const z=e();if(["primerApellido","primerNombre","email","telefono","lugarNacimiento.diaNacimiento","lugarNacimiento.mesNacimiento","lugarNacimiento.anoNacimiento"].filter(J=>{const X=J.split(".");let H=z;for(const se of X)H=H?.[se];return!H}).length>0){K({type:"error",text:"Por favor complete todos los campos requeridos antes de enviar"});return}if(confirm("¿Está seguro que desea enviar esta solicitud? Una vez enviada no podrá ser modificada."))try{S(!0),K(null);let J=N();J?await bf(J,z,{status:"submitted"}):(J=await vf(z,{status:"submitted"}),x(J),t.onSave?.(J)),K({type:"success",text:"Solicitud enviada exitosamente. Recibirá notificaciones sobre el estado de su solicitud."})}catch(J){console.error("Error submitting application:",J),K({type:"error",text:J instanceof Error?J.message:"Error enviando la solicitud"})}finally{S(!1)}},P=async()=>{const z=e();if(!z.primerApellido||!z.primerNombre||!z.lugarNacimiento?.diaNacimiento){alert("Por favor complete todos los campos requeridos");return}c(!0);try{const T=await CO({...z,fechaSolicitud:new Date().toLocaleDateString()}),R=URL.createObjectURL(T),J=document.createElement("a");J.href=R,J.download=`pasaporte_cubano_${z.primerApellido}_${Date.now()}.pdf`,document.body.appendChild(J),J.click(),document.body.removeChild(J),URL.revokeObjectURL(R),t.onSubmit&&t.onSubmit(z)}catch(T){console.error("Error generating PDF:",T),alert("Error generando el PDF")}finally{c(!1)}},w={"margin-bottom":"2rem","padding-bottom":"1.5rem","border-bottom":"1px solid var(--border-color)"},v={"font-size":"1.25rem","font-weight":"600","margin-bottom":"1rem",color:"var(--text-primary)"},j={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"};return A(Rt,{get children(){return[(()=>{var z=DO(),T=z.firstChild,R=T.nextSibling,J=R.nextSibling,X=J.firstChild,H=X.nextSibling,se=H.nextSibling,O=J.nextSibling,_=O.firstChild,k=_.nextSibling,$=O.nextSibling,G=$.firstChild,ne=$.nextSibling,U=ne.firstChild,D=U.nextSibling,B=D.nextSibling,Q=ne.nextSibling,Z=Q.firstChild,oe=Z.nextSibling,de=Q.nextSibling,re=de.firstChild,Y=re.nextSibling,ce=de.nextSibling,ue=ce.firstChild,ae=ue.nextSibling,ye=ae.nextSibling,me=ce.nextSibling,pe=me.firstChild,ve=pe.nextSibling,Ne=me.nextSibling,Ie=Ne.firstChild,Ce=Ie.nextSibling,Ee=Ne.nextSibling,we=Ee.firstChild,Re=we.nextSibling,He=Ee.nextSibling,je=He.firstChild,Ve=je.nextSibling,qe=Ve.firstChild,tt=qe.nextSibling,rt=tt.nextSibling,Be=Ve.nextSibling,Ge=Be.firstChild,Fe=Ge.nextSibling,at=Fe.nextSibling,lt=He.nextSibling,Xe=lt.firstChild,Ct=Xe.nextSibling;return z.style.setProperty("padding","2rem"),T.style.setProperty("font-size","1.75rem"),T.style.setProperty("font-weight","700"),T.style.setProperty("margin-bottom","1rem"),T.style.setProperty("color","var(--text-primary)"),T.style.setProperty("text-align","center"),R.style.setProperty("text-align","center"),R.style.setProperty("margin-bottom","2rem"),R.style.setProperty("color","var(--text-muted)"),a(H,A(Lt,{label:"Primer Apellido",get value(){return e().primerApellido||""},onChange:Le=>W("primerApellido",Le.toUpperCase()),required:!0}),null),a(H,A(Lt,{label:"Segundo Apellido",get value(){return e().segundoApellido||""},onChange:Le=>W("segundoApellido",Le.toUpperCase()),required:!0}),null),a(H,A(Lt,{label:"Primer Nombre",get value(){return e().primerNombre||""},onChange:Le=>W("primerNombre",Le.toUpperCase()),required:!0}),null),a(H,A(Lt,{label:"Segundo Nombre",get value(){return e().segundoNombre||""},onChange:Le=>W("segundoNombre",Le.toUpperCase())}),null),a(se,A(Lt,{label:"Nombre de la Madre",get value(){return e().nombre||""},onChange:Le=>W("nombre",Le.toUpperCase()),required:!0}),null),a(se,A(Lt,{label:"Nombre del Padre",get value(){return e().padre||""},onChange:Le=>W("padre",Le.toUpperCase()),required:!0}),null),a(k,A(en,{label:"Sexo",get value(){return e().sexo||"M"},onChange:Le=>W("sexo",Le),options:[{value:"M",label:"Masculino"},{value:"F",label:"Femenino"}],required:!0}),null),a(k,A(en,{label:"Color de Piel",get value(){return e().colorPiel||"Blanca"},onChange:Le=>W("colorPiel",Le),options:[{value:"Blanca",label:"Blanca"},{value:"Mestiza",label:"Mestiza"},{value:"Negra",label:"Negra"}],required:!0}),null),a(k,A(en,{label:"Color de Cabello",get value(){return e().colorCabello||"Negro"},onChange:Le=>W("colorCabello",Le),options:[{value:"Negro",label:"Negro"},{value:"Castaño",label:"Castaño"},{value:"Rubio",label:"Rubio"},{value:"Gris",label:"Gris"}],required:!0}),null),a(k,A(en,{label:"Color de Ojos",get value(){return e().colorOjos||"Castaños"},onChange:Le=>W("colorOjos",Le),options:[{value:"Negros",label:"Negros"},{value:"Castaños",label:"Castaños"},{value:"Azules",label:"Azules"},{value:"Verdes",label:"Verdes"}],required:!0}),null),a(k,A(Lt,{label:"Estatura (cm)",get value(){return e().estatura||""},onChange:Le=>W("estatura",Le),placeholder:"168",required:!0}),null),a(k,A(Lt,{label:"Características Especiales",get value(){return e().caracteristicasEspeciales||""},onChange:Le=>W("caracteristicasEspeciales",Le.toUpperCase()),placeholder:"NINGUNA"}),null),a($,A(en,{label:"",get value(){return e().clasificacionMigratoria||"PSE"},onChange:Le=>W("clasificacionMigratoria",Le),options:[{value:"PSE",label:"Permiso de Salida Definitiva (PSD)"},{value:"PVE",label:"Permiso de Viaje al Exterior (PVE)"},{value:"PVT",label:"Permiso de Viaje Temporal (PVT)"},{value:"PRE",label:"Permiso de Residencia en el Exterior (PRE)"}],required:!0}),null),a(D,A(Lt,{label:"País",get value(){return e().lugarNacimiento?.pais||""},onChange:Le=>I("lugarNacimiento","pais",Le.toUpperCase()),placeholder:"CUBA",required:!0}),null),a(D,A(Lt,{label:"Provincia",get value(){return e().lugarNacimiento?.provincia||""},onChange:Le=>I("lugarNacimiento","provincia",Le.toUpperCase()),placeholder:"SANTIAGO DE CUBA",required:!0}),null),a(D,A(Lt,{label:"Municipio",get value(){return e().lugarNacimiento?.municipio||""},onChange:Le=>I("lugarNacimiento","municipio",Le.toUpperCase()),placeholder:"SANTIAGO DE CUBA",required:!0}),null),a(B,A(Lt,{label:"Día",get value(){return e().lugarNacimiento?.diaNacimiento||""},onChange:Le=>I("lugarNacimiento","diaNacimiento",Le),placeholder:"19",required:!0}),null),a(B,A(Lt,{label:"Mes",get value(){return e().lugarNacimiento?.mesNacimiento||""},onChange:Le=>I("lugarNacimiento","mesNacimiento",Le),placeholder:"2",required:!0}),null),a(B,A(Lt,{label:"Año",get value(){return e().lugarNacimiento?.anoNacimiento||""},onChange:Le=>I("lugarNacimiento","anoNacimiento",Le),placeholder:"1985",required:!0}),null),a(Q,A(Lt,{label:"Dirección (calle, ave o apto, entre calles)",get value(){return e().direccionActual?.calle||""},onChange:Le=>I("direccionActual","calle",Le.toUpperCase()),placeholder:"1222 W ASHLAND AVE",required:!0}),oe),a(oe,A(Lt,{label:"Ciudad/Municipio",get value(){return e().direccionActual?.municipio||""},onChange:Le=>I("direccionActual","municipio",Le.toUpperCase()),placeholder:"KY",required:!0}),null),a(oe,A(Lt,{label:"Provincia/Estado",get value(){return e().direccionActual?.provincia||""},onChange:Le=>I("direccionActual","provincia",Le.toUpperCase()),placeholder:"LOUISVILLE",required:!0}),null),a(oe,A(Lt,{label:"País",get value(){return e().direccionActual?.pais||""},onChange:Le=>I("direccionActual","pais",Le.toUpperCase()),placeholder:"ESTADOS UNIDOS",required:!0}),null),a(oe,A(Lt,{label:"Código Postal",get value(){return e().direccionActual?.codigoPostal||""},onChange:Le=>I("direccionActual","codigoPostal",Le),placeholder:"40215",required:!0}),null),a(Y,A(Lt,{label:"Teléfono",get value(){return e().telefono||""},onChange:Le=>W("telefono",Le),placeholder:"502-665-4184",required:!0}),null),a(Y,A(Lt,{label:"Fax",get value(){return e().fax||""},onChange:Le=>W("fax",Le),placeholder:"000-000-0000"}),null),a(Y,A(Lt,{label:"Email",get value(){return e().email||""},onChange:Le=>W("email",Le),type:"email",required:!0}),null),a(ae,A(Lt,{label:"Profesión",get value(){return e().datosLaborales?.profesion||""},onChange:Le=>I("datosLaborales","profesion",Le.toUpperCase()),placeholder:"MECANICO",required:!0}),null),a(ae,A(Lt,{label:"Ocupación",get value(){return e().datosLaborales?.ocupacion||""},onChange:Le=>I("datosLaborales","ocupacion",Le.toUpperCase()),placeholder:"OBRERO",required:!0}),null),a(ae,A(en,{label:"Nivel Escolar",get value(){return e().datosLaborales?.nivelEscolar||"PRE-UNIVERSITARIO"},onChange:Le=>I("datosLaborales","nivelEscolar",Le),options:[{value:"PRIMARIO",label:"Primario"},{value:"SECUNDARIO",label:"Secundario"},{value:"PRE-UNIVERSITARIO",label:"Pre-Universitario"},{value:"UNIVERSITARIO",label:"Universitario"}],required:!0}),null),ye.style.setProperty("margin-top","1rem"),a(ye,A(Lt,{label:"Nombre del Centro de Trabajo/Estudio",get value(){return e().datosLaborales?.nombreCentroTrabajo||""},onChange:Le=>I("datosLaborales","nombreCentroTrabajo",Le.toUpperCase()),placeholder:"BIGO TIRE",required:!0}),null),a(ye,A(Lt,{label:"Dirección del Centro",get value(){return e().datosLaborales?.direccionCentro||""},onChange:Le=>I("datosLaborales","direccionCentro",Le.toUpperCase()),placeholder:"44 13 CANE RUN LOUISVILLE",required:!0}),null),a(ye,A(Lt,{label:"Teléfono del Centro",get value(){return e().datosLaborales?.telefonoCentro||""},onChange:Le=>I("datosLaborales","telefonoCentro",Le),placeholder:"000-000-0000"}),null),a(me,A(Lt,{label:"Nombres y Apellidos de la referencia en Cuba",get value(){return e().referenciaEnCuba?.nombre||""},onChange:Le=>I("referenciaEnCuba","nombre",Le.toUpperCase()),placeholder:"ALINA PADRO TERRERO",required:!0}),ve),a(ve,A(Lt,{label:"Parentesco",get value(){return e().referenciaEnCuba?.parentesco||""},onChange:Le=>I("referenciaEnCuba","parentesco",Le.toUpperCase()),placeholder:"MADRE",required:!0})),a(me,A(Lt,{label:"Dirección de la Referencia (incluir la provincia)",get value(){return e().referenciaEnCuba?.direccion||""},onChange:Le=>I("referenciaEnCuba","direccion",Le.toUpperCase()),placeholder:"GRAL BANDERA 308 SANTIAGO DE CUBA SANTIAGO DE CUBA",required:!0}),null),a(Ce,A(Lt,{label:"Número de Pasaporte",get value(){return e().pasaporteAnterior?.numero||""},onChange:Le=>W("pasaporteAnterior",{...e().pasaporteAnterior,numero:Le.toUpperCase()}),placeholder:"K587373"}),null),a(Ce,A(Lt,{label:"Fecha de Expedición",type:"date",get value(){return e().pasaporteAnterior?.fechaExpedicion||""},onChange:Le=>W("pasaporteAnterior",{...e().pasaporteAnterior,fechaExpedicion:Le})}),null),a(Ce,A(Lt,{label:"Lugar de Expedición",get value(){return e().pasaporteAnterior?.lugar||""},onChange:Le=>W("pasaporteAnterior",{...e().pasaporteAnterior,lugar:Le.toUpperCase()})}),null),a(Re,A(Lt,{label:"Tomo",get value(){return e().certificadoNacimiento?.tomo||""},onChange:Le=>I("certificadoNacimiento","tomo",Le)}),null),a(Re,A(Lt,{label:"Folio",get value(){return e().certificadoNacimiento?.folio||""},onChange:Le=>I("certificadoNacimiento","folio",Le)}),null),a(Re,A(Lt,{label:"Registro Civil",get value(){return e().certificadoNacimiento?.registroCivil||""},onChange:Le=>I("certificadoNacimiento","registroCivil",Le.toUpperCase())}),null),Ve.style.setProperty("margin-bottom","1rem"),qe.style.setProperty("display","block"),qe.style.setProperty("font-weight","500"),qe.style.setProperty("margin-bottom","0.5rem"),qe.style.setProperty("color","var(--text-primary)"),tt.addEventListener("blur",Le=>Le.currentTarget.style.borderColor="var(--border-color)"),tt.addEventListener("focus",Le=>Le.currentTarget.style.borderColor="var(--primary-color)"),tt.addEventListener("change",Le=>u(Le.currentTarget.value)),tt.style.setProperty("width","100%"),tt.style.setProperty("padding","0.75rem"),tt.style.setProperty("border","1px solid var(--border-color)"),tt.style.setProperty("border-radius","var(--border-radius-sm)"),tt.style.setProperty("background","var(--surface-color)"),tt.style.setProperty("font-size","1rem"),tt.style.setProperty("cursor","pointer"),rt.style.setProperty("margin-top","0.5rem"),rt.style.setProperty("font-size","0.75rem"),rt.style.setProperty("color","var(--text-muted)"),a(rt,()=>d()==="basic"&&"• Extrae la firma tal como aparece en la imagen",null),a(rt,()=>d()==="enhanced"&&"• Mejora la calidad eliminando pixeles y suavizando bordes",null),a(rt,()=>d()==="vectorized"&&"• Filtros avanzados con calidad profesional (solicitará confirmación antes de procesar)",null),Be.style.setProperty("background","var(--gray-50)"),Be.style.setProperty("padding","1rem"),Be.style.setProperty("border-radius","var(--border-radius)"),Be.style.setProperty("margin-bottom","1rem"),Ge.style.setProperty("font-size","0.875rem"),Ge.style.setProperty("color","var(--text-muted)"),Ge.style.setProperty("margin-bottom","0.5rem"),Fe.addEventListener("change",E),Fe.style.setProperty("display","none"),at.style.setProperty("display","inline-block"),at.style.setProperty("padding","0.75rem 1.5rem"),at.style.setProperty("background","var(--primary-color)"),at.style.setProperty("color","white"),at.style.setProperty("border-radius","var(--border-radius-sm)"),at.style.setProperty("cursor","pointer"),at.style.setProperty("font-weight","500"),a(Be,A(Me,{get when(){return o()},get children(){var Le=EO(),nt=Le.firstChild;return Le.style.setProperty("margin-top","1rem"),Le.style.setProperty("color","var(--primary-color)"),Le.style.setProperty("font-size","0.875rem"),Le.style.setProperty("display","flex"),Le.style.setProperty("align-items","center"),nt.style.setProperty("display","inline-block"),nt.style.setProperty("width","16px"),nt.style.setProperty("height","16px"),nt.style.setProperty("border","2px solid var(--primary-color)"),nt.style.setProperty("border-top-color","transparent"),nt.style.setProperty("border-radius","50%"),nt.style.setProperty("animation","spin 0.8s linear infinite"),nt.style.setProperty("margin-right","0.5rem"),a(Le,()=>d()==="vectorized"?"Aplicando filtros avanzados... (optimizado para ser rápido)":"Extrayendo y mejorando firma...",null),Le}}),null),a(Be,A(Me,{get when(){return ke(()=>!!n())()&&!o()},get children(){return A(ct,{onClick:async()=>{d()==="vectorized"&&!await $b()||n()&&E({target:{files:[n()]}})},variant:"secondary",size:"sm",style:{"margin-top":"0.75rem"},get children(){return["Reprocesar con ",ke(()=>ke(()=>d()==="basic")()?"Básico":d()==="enhanced"?"Mejorado":"Filtros Avanzados")]}})}}),null),a(He,A(Me,{get when(){return e().firmaBase64},get children(){var Le=IO(),nt=Le.firstChild,We=nt.firstChild,kt=We.firstChild,Et=kt.nextSibling;Et.firstChild;var Ot=nt.nextSibling,jt=Ot.firstChild,mt=Ot.nextSibling,Zt=mt.firstChild,rr=Zt.nextSibling;return Le.style.setProperty("margin-top","1rem"),Le.style.setProperty("padding","1.5rem"),Le.style.setProperty("border","1px solid var(--border-color)"),Le.style.setProperty("border-radius","var(--border-radius-sm)"),Le.style.setProperty("background","white"),nt.style.setProperty("display","flex"),nt.style.setProperty("justify-content","space-between"),nt.style.setProperty("align-items","flex-start"),nt.style.setProperty("margin-bottom","1rem"),kt.style.setProperty("font-size","1.125rem"),kt.style.setProperty("font-weight","600"),kt.style.setProperty("margin-bottom","0.5rem"),kt.style.setProperty("color","var(--text-primary)"),Et.style.setProperty("font-size","0.875rem"),Et.style.setProperty("color","var(--success-color)"),Et.style.setProperty("margin-bottom","0"),Et.style.setProperty("font-weight","500"),a(Et,(()=>{var Dt=ke(()=>d()==="basic");return()=>Dt()?"Extraída sin procesamiento":d()==="enhanced"?"Mejorada con algoritmos avanzados":"Optimizada con filtros avanzados"})(),null),Ot.style.setProperty("display","flex"),Ot.style.setProperty("justify-content","center"),Ot.style.setProperty("align-items","center"),Ot.style.setProperty("background","#f8f9fa"),Ot.style.setProperty("padding","2rem"),Ot.style.setProperty("border-radius","var(--border-radius)"),Ot.style.setProperty("border","2px dashed var(--border-color)"),Ot.style.setProperty("min-height","200px"),jt.$$click=()=>F(!0),jt.style.setProperty("max-width","600px"),jt.style.setProperty("max-height","300px"),jt.style.setProperty("width","auto"),jt.style.setProperty("height","auto"),jt.style.setProperty("border","2px solid var(--border-color)"),jt.style.setProperty("border-radius","var(--border-radius-sm)"),jt.style.setProperty("background","white"),jt.style.setProperty("padding","1rem"),jt.style.setProperty("box-shadow","0 4px 12px rgba(0,0,0,0.15)"),jt.style.setProperty("cursor","pointer"),mt.style.setProperty("margin-top","1rem"),mt.style.setProperty("text-align","center"),Zt.style.setProperty("font-size","0.875rem"),Zt.style.setProperty("color","var(--text-muted)"),Zt.style.setProperty("margin","0 0 0.5rem 0"),rr.style.setProperty("font-size","0.8rem"),rr.style.setProperty("color","var(--primary-color)"),rr.style.setProperty("margin","0"),rr.style.setProperty("font-weight","500"),ge(()=>Jt(jt,"src",e().firmaBase64)),Le}}),null),a(z,A(Me,{get when(){return b()},get children(){var Le=TO(),nt=Le.firstChild;return nt.nextSibling,Le.style.setProperty("padding","1rem"),Le.style.setProperty("margin-top","1rem"),Le.style.setProperty("border-radius","var(--border-radius)"),a(nt,()=>b().type==="success"?"✓ Éxito:":"⚠ Error:"),a(Le,()=>b().text,null),ge(We=>{var kt=b().type==="success"?"var(--success-light)":"var(--error-light)",Et=b().type==="success"?"var(--success-dark)":"var(--error-dark)",Ot=`1px solid ${b().type==="success"?"var(--success-color)":"var(--error-color)"}`;return kt!==We.e&&((We.e=kt)!=null?Le.style.setProperty("background",kt):Le.style.removeProperty("background")),Et!==We.t&&((We.t=Et)!=null?Le.style.setProperty("color",Et):Le.style.removeProperty("color")),Ot!==We.a&&((We.a=Ot)!=null?Le.style.setProperty("border",Ot):Le.style.removeProperty("border")),We},{e:void 0,t:void 0,a:void 0}),Le}}),lt),lt.style.setProperty("display","flex"),lt.style.setProperty("justify-content","space-between"),lt.style.setProperty("align-items","center"),lt.style.setProperty("flex-wrap","wrap"),lt.style.setProperty("gap","1rem"),lt.style.setProperty("margin-top","2rem"),Xe.style.setProperty("display","flex"),Xe.style.setProperty("gap","1rem"),Xe.style.setProperty("flex-wrap","wrap"),a(Xe,A(ct,{onClick:L,get disabled(){return h()||m()},variant:"secondary",size:"md",get children(){return A(Me,{get when(){return h()},fallback:"Guardar Borrador",get children(){var Le=kO(),nt=Le.firstChild;return Le.style.setProperty("display","flex"),Le.style.setProperty("align-items","center"),nt.style.setProperty("display","inline-block"),nt.style.setProperty("width","16px"),nt.style.setProperty("height","16px"),nt.style.setProperty("border","2px solid currentColor"),nt.style.setProperty("border-top-color","transparent"),nt.style.setProperty("border-radius","50%"),nt.style.setProperty("animation","spin 0.8s linear infinite"),nt.style.setProperty("margin-right","0.5rem"),Le}})}}),null),a(Xe,A(ct,{onClick:M,get disabled(){return h()||m()},variant:"primary",size:"md",get children(){return A(Me,{get when(){return m()},fallback:"Enviar Solicitud",get children(){var Le=NO(),nt=Le.firstChild;return Le.style.setProperty("display","flex"),Le.style.setProperty("align-items","center"),nt.style.setProperty("display","inline-block"),nt.style.setProperty("width","16px"),nt.style.setProperty("height","16px"),nt.style.setProperty("border","2px solid #fff"),nt.style.setProperty("border-top-color","transparent"),nt.style.setProperty("border-radius","50%"),nt.style.setProperty("animation","spin 0.8s linear infinite"),nt.style.setProperty("margin-right","0.5rem"),Le}})}}),null),a(Xe,A(ct,{onClick:P,get disabled(){return l()||h()||m()},variant:"accent",size:"md",get children(){return A(Me,{get when(){return l()},fallback:"Generar PDF",get children(){var Le=LO(),nt=Le.firstChild;return Le.style.setProperty("display","flex"),Le.style.setProperty("align-items","center"),nt.style.setProperty("display","inline-block"),nt.style.setProperty("width","16px"),nt.style.setProperty("height","16px"),nt.style.setProperty("border","2px solid #fff"),nt.style.setProperty("border-top-color","transparent"),nt.style.setProperty("border-radius","50%"),nt.style.setProperty("animation","spin 0.8s linear infinite"),nt.style.setProperty("margin-right","0.5rem"),Le}})}}),null),Ct.style.setProperty("display","flex"),Ct.style.setProperty("gap","0.5rem"),a(Ct,A(Me,{get when(){return N()},get children(){var Le=RO(),nt=Le.firstChild,We=nt.nextSibling;return We.nextSibling,Le.style.setProperty("font-size","0.875rem"),Le.style.setProperty("color","var(--text-muted)"),Le.style.setProperty("padding","0.5rem"),a(Le,()=>N()?.substring(0,8),We),Le}}),null),a(Ct,A(ct,{onClick:()=>{confirm("¿Está seguro que desea limpiar el formulario?")&&window.location.reload()},variant:"secondary",size:"sm",children:"Limpiar Formulario"}),null),ge(Le=>{var nt=w,We=v,kt=j,Et={...j,"margin-top":"1rem"},Ot=w,jt=v,mt=j,Zt=w,rr=v,Dt=w,Kt=v,dt=j,pt={...j,"margin-top":"1rem","grid-template-columns":"repeat(3, 1fr)","max-width":"400px"},ze=w,bt=v,Mt={...j,"margin-top":"1rem"},ft=w,At=v,Ht=j,Yt=w,nr=v,Dr=j,vr=w,tr=v,Bt={...j,"margin-top":"1rem"},ar=w,br=v,$r=j,mr=w,sr=v,Ir=j,dr=w,rn=v;return Le.e=p(J,nt,Le.e),Le.t=p(X,We,Le.t),Le.a=p(H,kt,Le.a),Le.o=p(se,Et,Le.o),Le.i=p(O,Ot,Le.i),Le.n=p(_,jt,Le.n),Le.s=p(k,mt,Le.s),Le.h=p($,Zt,Le.h),Le.r=p(G,rr,Le.r),Le.d=p(ne,Dt,Le.d),Le.l=p(U,Kt,Le.l),Le.u=p(D,dt,Le.u),Le.c=p(B,pt,Le.c),Le.w=p(Q,ze,Le.w),Le.m=p(Z,bt,Le.m),Le.f=p(oe,Mt,Le.f),Le.y=p(de,ft,Le.y),Le.g=p(re,At,Le.g),Le.p=p(Y,Ht,Le.p),Le.b=p(ce,Yt,Le.b),Le.T=p(ue,nr,Le.T),Le.A=p(ae,Dr,Le.A),Le.O=p(me,vr,Le.O),Le.I=p(pe,tr,Le.I),Le.S=p(ve,Bt,Le.S),Le.W=p(Ne,ar,Le.W),Le.C=p(Ie,br,Le.C),Le.B=p(Ce,$r,Le.B),Le.v=p(Ee,mr,Le.v),Le.k=p(we,sr,Le.k),Le.x=p(Re,Ir,Le.x),Le.j=p(He,dr,Le.j),Le.q=p(je,rn,Le.q),Le},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0}),ge(()=>tt.value=d()),z})(),A(Me,{get when(){return te()},get children(){var z=MO(),T=z.firstChild,R=T.firstChild,J=R.firstChild,X=J.nextSibling,H=R.nextSibling,se=H.firstChild,O=H.nextSibling;return z.$$click=()=>F(!1),z.$$keydown=V,z.style.setProperty("position","fixed"),z.style.setProperty("top","0"),z.style.setProperty("left","0"),z.style.setProperty("width","100%"),z.style.setProperty("height","100%"),z.style.setProperty("background","rgba(0, 0, 0, 0.9)"),z.style.setProperty("z-index","10000"),z.style.setProperty("padding","2rem"),z.style.setProperty("box-sizing","border-box"),T.style.setProperty("width","100%"),T.style.setProperty("height","100%"),T.style.setProperty("display","flex"),T.style.setProperty("flex-direction","column"),T.style.setProperty("align-items","center"),T.style.setProperty("justify-content","center"),T.style.setProperty("gap","2rem"),R.style.setProperty("text-align","center"),R.style.setProperty("color","white"),J.style.setProperty("font-size","1.5rem"),J.style.setProperty("margin","0 0 0.5rem 0"),X.style.setProperty("font-size","1rem"),X.style.setProperty("margin","0"),X.style.setProperty("opacity","0.8"),a(X,(()=>{var _=ke(()=>d()==="basic");return()=>_()?"Firma extraída sin procesamiento adicional":d()==="enhanced"?"Firma mejorada con algoritmos avanzados":"Firma optimizada con filtros avanzados"})()),H.$$click=_=>_.stopPropagation(),H.style.setProperty("background","white"),H.style.setProperty("padding","2rem"),H.style.setProperty("border-radius","12px"),H.style.setProperty("max-width","90vw"),H.style.setProperty("max-height","70vh"),H.style.setProperty("display","flex"),H.style.setProperty("align-items","center"),H.style.setProperty("justify-content","center"),H.style.setProperty("box-shadow","0 10px 30px rgba(0, 0, 0, 0.5)"),se.style.setProperty("max-width","100%"),se.style.setProperty("max-height","100%"),se.style.setProperty("width","auto"),se.style.setProperty("height","auto"),O.$$click=_=>_.stopPropagation(),O.style.setProperty("display","flex"),O.style.setProperty("gap","1rem"),a(O,A(ct,{onClick:()=>F(!1),variant:"secondary",style:{background:"rgba(255, 255, 255, 0.9)",color:"var(--text-primary)"},children:"Cerrar (ESC)"}),null),a(O,A(ct,{onClick:()=>{const _=document.createElement("a");_.download="firma-extraida.png",_.href=e().firmaBase64,_.click()},variant:"primary",children:"Descargar Firma"}),null),ge(()=>Jt(se,"src",e().firmaBase64)),z}}),FO()]}})};Wt(["click","keydown"]);const BO=async(t={})=>{try{const e=Gt.state.user;if(!e)throw new Error("User not authenticated");const{status:r="all",searchTerm:n="",dateFrom:i,dateTo:o,limit:s=20,startAfter:l}=t;let c=[Ad("userId","==",e.uid),xP("createdAt","desc")];if(r!=="all"&&c.splice(1,0,Ad("status","==",r)),(i||o)&&(i&&c.splice(-1,0,Ad("createdAt",">=",new Date(i))),o&&c.splice(-1,0,Ad("createdAt","<=",new Date(o)))),l&&c.push(wE(l)),c.push(SE(s+1)),!(n&&n?.trim()))return[];let d={businessId:Gt.getBusinessId()};n&&n.split(" ").map((g,m)=>{g&&(d[":search"+m]=g.trim())});const h=await Ay({query:"getCubanPassport",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4 AND guia = guia",params:d});return console.log(h),h}catch(e){throw console.error("Error fetching passport applications:",e),new Error(`Failed to fetch passport applications: ${e instanceof Error?e.message:"Unknown error"}`)}},VO=async t=>{try{const e=Gt.state.user;if(!e)throw new Error("User not authenticated");const r=Dp(Fc,"passportApplications",t),n=await AP(r);if(!n.exists())return null;const i=n.data();if(i.userId!==e.uid)throw new Error("Unauthorized access to passport application");return{id:n.id,...i,createdAt:i.createdAt,updatedAt:i.updatedAt}}catch(e){throw console.error("Error fetching passport application:",e),new Error(`Failed to fetch passport application: ${e instanceof Error?e.message:"Unknown error"}`)}},jO=async t=>{try{const e=Gt.state.user;if(!e)throw new Error("User not authenticated");const r=await VO(t);if(!r)throw new Error("Application not found");if(r.userId!==e.uid)throw new Error("Unauthorized to delete this application");await Dp(Fc,"passportApplications",t).delete()}catch(e){throw console.error("Error deleting passport application:",e),new Error(`Failed to delete passport application: ${e instanceof Error?e.message:"Unknown error"}`)}},zO=async()=>{try{const t=Gt.state.user;if(!t)throw new Error("User not authenticated");const e={draft:0,submitted:0,processing:0,completed:0,rejected:0,total:0},r=fP(Fc,"passportApplications"),n=wP(r,Ad("userId","==",t.uid));return(await EP(n)).forEach(o=>{const l=o.data().status||"draft";l in e&&e[l]++,e.total++}),e}catch(t){return console.error("Error fetching application stats:",t),{draft:0,submitted:0,processing:0,completed:0,rejected:0,total:0}}};var bh=le("<div>"),qO=le("<div><strong>Error:</strong> "),UO=le("<div><div></div><p>Cargando solicitudes..."),HO=le(`<div><h2>Solicitudes de Pasaporte Guardadas</h2><div><div><div></div><div>Total</div></div><div><div></div><div>Borradores</div></div><div><div></div><div>Enviados</div></div><div><div></div><div>En Proceso</div></div><div><div></div><div>Completados</div></div></div><style>
        @keyframes spin {
          to { transform: rotate(360deg); }
        }
      `),GO=le("<div><p>📋 No hay solicitudes guardadas</p><p>Las solicitudes que guarde aparecerán aquí para poder verlas y editarlas más tarde."),WO=le("<div><strong>Número:</strong> "),YO=le("<div><strong>Notas:</strong> "),KO=le("<div><div><div><h3> <!> </h3><div><div><strong>Email:</strong> </div><div><strong>Teléfono:</strong> </div><div><strong>Creado:</strong> </div><div><strong>Actualizado:</strong> </div></div></div><div><div>");const QO=t=>{const[e,r]=Se([]),[n,i]=Se(!1),[o,s]=Se(null),[l,c]=Se({draft:0,submitted:0,processing:0,completed:0,rejected:0,total:0}),[d,u]=Se("all"),[h,g]=Se(""),[m,S]=Se(""),[N,x]=Se(""),[b,K]=Se(!1),[te,F]=Se(null);Ln(()=>{V(),W()});const V=async(T=!0)=>{try{i(!0),s(null);const R={status:d(),searchTerm:h().trim(),dateFrom:m()||void 0,dateTo:N()||void 0,limit:20,startAfter:T?void 0:te()},J=await BO(R);console.log(J),r(T?J.applications:X=>[...X,...J.applications]),K(J.hasMore),F(J.lastDoc)}catch(R){const J=R instanceof Error?R.message:"Failed to load applications";s(J),console.error("Error loading applications:",R)}finally{i(!1)}},W=async()=>{try{const T=await zO();c(T)}catch(T){console.error("Error loading stats:",T)}},I=()=>{V(!0)},E=async T=>{if(confirm("¿Está seguro que desea eliminar esta solicitud? Esta acción no se puede deshacer."))try{await jO(T),r(R=>R.filter(J=>J.id!==T)),await W()}catch(R){const J=R instanceof Error?R.message:"Failed to delete application";alert(`Error: ${J}`)}},L=T=>{if(!T)return"N/A";try{return(T.toDate?T.toDate():new Date(T)).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"N/A"}},M=T=>{switch(T){case"draft":return"var(--text-muted)";case"submitted":return"var(--warning-color)";case"processing":return"var(--primary-color)";case"completed":return"var(--success-color)";case"rejected":return"var(--error-color)";default:return"var(--text-muted)"}},P=T=>{switch(T){case"draft":return"Borrador";case"submitted":return"Enviado";case"processing":return"En Proceso";case"completed":return"Completado";case"rejected":return"Rechazado";default:return T}},w={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem","margin-bottom":"2rem"},v={padding:"1rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)","text-align":"center"},j={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"1.5rem"},z={padding:"1.5rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)","margin-bottom":"1rem",cursor:t.onSelectApplication?"pointer":"default",transition:"all 0.2s"};return(()=>{var T=HO(),R=T.firstChild,J=R.nextSibling,X=J.firstChild,H=X.firstChild,se=H.nextSibling,O=X.nextSibling,_=O.firstChild,k=_.nextSibling,$=O.nextSibling,G=$.firstChild,ne=G.nextSibling,U=$.nextSibling,D=U.firstChild,B=D.nextSibling,Q=U.nextSibling,Z=Q.firstChild,oe=Z.nextSibling,de=J.nextSibling;return R.style.setProperty("font-size","1.5rem"),R.style.setProperty("font-weight","700"),R.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("color","var(--text-primary)"),p(J,w),H.style.setProperty("font-size","2rem"),H.style.setProperty("font-weight","700"),H.style.setProperty("color","var(--primary-color)"),a(H,()=>l().total),se.style.setProperty("font-size","0.875rem"),se.style.setProperty("color","var(--text-muted)"),_.style.setProperty("font-size","2rem"),_.style.setProperty("font-weight","700"),a(_,()=>l().draft),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("color","var(--text-muted)"),G.style.setProperty("font-size","2rem"),G.style.setProperty("font-weight","700"),a(G,()=>l().submitted),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-muted)"),D.style.setProperty("font-size","2rem"),D.style.setProperty("font-weight","700"),a(D,()=>l().processing),B.style.setProperty("font-size","0.875rem"),B.style.setProperty("color","var(--text-muted)"),Z.style.setProperty("font-size","2rem"),Z.style.setProperty("font-weight","700"),a(Z,()=>l().completed),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),a(T,A(Rt,{title:"Filtros de Búsqueda",get children(){return[(()=>{var re=bh();return p(re,j),a(re,A(en,{label:"Estado",get value(){return d()},onChange:Y=>{u(Y),I()},options:[{value:"all",label:"Todos los Estados"},{value:"draft",label:"Borradores"},{value:"submitted",label:"Enviados"},{value:"processing",label:"En Proceso"},{value:"completed",label:"Completados"},{value:"rejected",label:"Rechazados"}]}),null),a(re,A(Lt,{label:"Buscar",get value(){return h()},onChange:Y=>{g(Y),setTimeout(()=>I(),500)},placeholder:"Nombre, apellido, email..."}),null),a(re,A(Lt,{label:"Desde",type:"date",get value(){return m()},onChange:Y=>{S(Y),I()}}),null),a(re,A(Lt,{label:"Hasta",type:"date",get value(){return N()},onChange:Y=>{x(Y),I()}}),null),re})(),(()=>{var re=bh();return re.style.setProperty("display","flex"),re.style.setProperty("gap","1rem"),re.style.setProperty("justify-content","flex-end"),a(re,A(ct,{onClick:()=>{u("all"),g(""),S(""),x(""),I()},variant:"secondary",size:"sm",children:"Limpiar Filtros"}),null),a(re,A(ct,{onClick:()=>I(),variant:"primary",size:"sm",children:"Actualizar"}),null),re})()]}}),de),a(T,A(Me,{get when(){return o()},get children(){var re=qO(),Y=re.firstChild;return Y.nextSibling,re.style.setProperty("padding","1rem"),re.style.setProperty("background","var(--error-light)"),re.style.setProperty("color","var(--error-dark)"),re.style.setProperty("border","1px solid var(--error-color)"),re.style.setProperty("border-radius","var(--border-radius)"),re.style.setProperty("margin-bottom","1rem"),a(re,o,null),re}}),de),a(T,A(Me,{get when(){return ke(()=>!!n())()&&e()?.length===0},get children(){var re=UO(),Y=re.firstChild;return re.style.setProperty("text-align","center"),re.style.setProperty("padding","3rem"),re.style.setProperty("color","var(--text-muted)"),Y.style.setProperty("display","inline-block"),Y.style.setProperty("width","32px"),Y.style.setProperty("height","32px"),Y.style.setProperty("border","3px solid var(--primary-color)"),Y.style.setProperty("border-top-color","transparent"),Y.style.setProperty("border-radius","50%"),Y.style.setProperty("animation","spin 0.8s linear infinite"),Y.style.setProperty("margin-bottom","1rem"),re}}),de),a(T,A(Me,{get when(){return!n()||e()?.length>0},get children(){return A(Me,{get when(){return e()?.length>0},get fallback(){return(()=>{var re=GO(),Y=re.firstChild;return re.style.setProperty("text-align","center"),re.style.setProperty("padding","3rem"),re.style.setProperty("color","var(--text-muted)"),Y.style.setProperty("font-size","1.125rem"),Y.style.setProperty("margin-bottom","1rem"),re})()},get children(){return[A(vt,{get each(){return e()},children:re=>(()=>{var Y=KO(),ce=Y.firstChild,ue=ce.firstChild,ae=ue.firstChild,ye=ae.firstChild,me=ye.nextSibling;me.nextSibling;var pe=ae.nextSibling,ve=pe.firstChild,Ne=ve.firstChild;Ne.nextSibling;var Ie=ve.nextSibling,Ce=Ie.firstChild;Ce.nextSibling;var Ee=Ie.nextSibling,we=Ee.firstChild;we.nextSibling;var Re=Ee.nextSibling,He=Re.firstChild;He.nextSibling;var je=ue.nextSibling,Ve=je.firstChild;return Y.$$click=()=>t.onSelectApplication?.(re),ce.style.setProperty("display","grid"),ce.style.setProperty("grid-template-columns","1fr auto"),ce.style.setProperty("align-items","start"),ce.style.setProperty("gap","1rem"),ae.style.setProperty("font-size","1.125rem"),ae.style.setProperty("font-weight","600"),ae.style.setProperty("margin-bottom","0.5rem"),ae.style.setProperty("color","var(--text-primary)"),a(ae,()=>re.applicationData.primerNombre,ye),a(ae,()=>re.applicationData.primerApellido,me),a(ae,()=>re.applicationData.segundoApellido,null),pe.style.setProperty("display","grid"),pe.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),pe.style.setProperty("gap","0.5rem"),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),a(ve,()=>re.applicationData.email,null),a(Ie,()=>re.applicationData.telefono,null),a(Ee,()=>L(re.createdAt),null),a(Re,()=>L(re.updatedAt),null),a(pe,A(Me,{get when(){return re.applicationNumber},get children(){var qe=WO(),tt=qe.firstChild;return tt.nextSibling,a(qe,()=>re.applicationNumber,null),qe}}),null),a(ue,A(Me,{get when(){return re.processingNotes},get children(){var qe=YO(),tt=qe.firstChild;return tt.nextSibling,qe.style.setProperty("margin-top","0.75rem"),qe.style.setProperty("padding","0.75rem"),qe.style.setProperty("background","var(--gray-50)"),qe.style.setProperty("border-radius","var(--border-radius-sm)"),qe.style.setProperty("font-size","0.875rem"),a(qe,()=>re.processingNotes,null),qe}}),null),je.style.setProperty("display","flex"),je.style.setProperty("flex-direction","column"),je.style.setProperty("align-items","flex-end"),je.style.setProperty("gap","0.75rem"),Ve.style.setProperty("padding","0.5rem 1rem"),Ve.style.setProperty("color","white"),Ve.style.setProperty("border-radius","var(--border-radius-sm)"),Ve.style.setProperty("font-size","0.875rem"),Ve.style.setProperty("font-weight","500"),a(Ve,()=>P(re.status)),a(je,A(Me,{get when(){return t.showActions!==!1},get children(){var qe=bh();return qe.style.setProperty("display","flex"),qe.style.setProperty("gap","0.5rem"),a(qe,A(Me,{get when(){return t.onEditApplication},get children(){return A(ct,{onClick:tt=>{tt.stopPropagation(),t.onEditApplication?.(re)},variant:"secondary",size:"sm",children:"Editar"})}}),null),a(qe,A(ct,{onClick:tt=>{tt.stopPropagation(),E(re.id)},variant:"danger",size:"sm",children:"Eliminar"}),null),qe}}),null),ge(qe=>{var tt={...z,":hover":t.onSelectApplication?{"border-color":"var(--primary-color)","box-shadow":"0 2px 8px rgba(0,0,0,0.1)"}:{}},rt=M(re.status);return qe.e=p(Y,tt,qe.e),rt!==qe.t&&((qe.t=rt)!=null?Ve.style.setProperty("background",rt):Ve.style.removeProperty("background")),qe},{e:void 0,t:void 0}),Y})()}),A(Me,{get when(){return b()},get children(){var re=bh();return re.style.setProperty("text-align","center"),re.style.setProperty("margin-top","2rem"),a(re,A(ct,{onClick:()=>V(!1),variant:"secondary",get disabled(){return n()},get children(){return A(Me,{get when(){return n()},fallback:"Cargar Más",children:"Cargando..."})}})),re}})]}})}}),de),ge(re=>{var Y=v,ce=v,ue=M("draft"),ae=v,ye=M("submitted"),me=v,pe=M("processing"),ve=v,Ne=M("completed");return re.e=p(X,Y,re.e),re.t=p(O,ce,re.t),ue!==re.a&&((re.a=ue)!=null?_.style.setProperty("color",ue):_.style.removeProperty("color")),re.o=p($,ae,re.o),ye!==re.i&&((re.i=ye)!=null?G.style.setProperty("color",ye):G.style.removeProperty("color")),re.n=p(U,me,re.n),pe!==re.s&&((re.s=pe)!=null?D.style.setProperty("color",pe):D.style.removeProperty("color")),re.h=p(Q,ve,re.h),Ne!==re.r&&((re.r=Ne)!=null?Z.style.setProperty("color",Ne):Z.style.removeProperty("color")),re},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),T})()};Wt(["click"]);var JO=le("<div><h3></h3><ul><li></li><li></li><li></li><li></li><li></li><li><strong>Auto-guardado:</strong> Su progreso se guarda automáticamente mientras completa el formulario"),XO=le("<div><div><h1></h1><p></p><div></div></div><div><h3></h3><p></p><div><div><h4></h4><p>1-800-CUBA-PASS</p></div><div><h4></h4><p>pasaportes@consuladocuba.com");const ZO=()=>{const{t}=or(),[e,r]=Se("form"),[n,i]=Se(null),o=h=>{console.log("Cuban passport form submitted:",h)},s=h=>{i(h),r("form")},l=h=>{i(h),r("form")},c=()=>{i(null),r("form")},d=h=>{console.log("Application saved:",h)},u={lugarNacimiento:{pais:"CUBA",provincia:"",municipio:"",diaNacimiento:"",mesNacimiento:"",anoNacimiento:""},direccionActual:{calle:"",provincia:"",municipio:"",pais:"ESTADOS UNIDOS",codigoPostal:""}};return(()=>{var h=XO(),g=h.firstChild,m=g.firstChild,S=m.nextSibling,N=S.nextSibling,x=g.nextSibling,b=x.firstChild,K=b.nextSibling,te=K.nextSibling,F=te.firstChild,V=F.firstChild,W=V.nextSibling,I=F.nextSibling,E=I.firstChild,L=E.nextSibling;return h.style.setProperty("max-width","1200px"),h.style.setProperty("margin","0 auto"),h.style.setProperty("padding","2rem"),g.style.setProperty("text-align","center"),g.style.setProperty("margin-bottom","2rem"),m.style.setProperty("font-size","2rem"),m.style.setProperty("font-weight","700"),m.style.setProperty("color","var(--text-primary)"),m.style.setProperty("margin-bottom","0.5rem"),a(m,()=>t("passport.cuban.pageTitle","Cuban Passport Application")),S.style.setProperty("color","var(--text-muted)"),S.style.setProperty("font-size","1.125rem"),S.style.setProperty("margin-bottom","1.5rem"),a(S,(()=>{var M=ke(()=>e()==="form");return()=>M()?n()?"Editando solicitud existente":"Complete el formulario para crear una nueva solicitud":"Gestione sus solicitudes de pasaporte guardadas"})()),N.style.setProperty("display","flex"),N.style.setProperty("justify-content","center"),N.style.setProperty("gap","1rem"),N.style.setProperty("margin-bottom","2rem"),a(N,A(ct,{onClick:()=>r("list"),get variant(){return e()==="list"?"primary":"secondary"},children:"📋 Ver Solicitudes"}),null),a(N,A(ct,{onClick:c,get variant(){return e()==="form"&&!n()?"primary":"secondary"},children:"➕ Nueva Solicitud"}),null),a(h,A(Me,{get when(){return e()==="form"},get children(){var M=JO(),P=M.firstChild,w=P.nextSibling,v=w.firstChild,j=v.nextSibling,z=j.nextSibling,T=z.nextSibling,R=T.nextSibling;return M.style.setProperty("background","var(--warning-light)"),M.style.setProperty("padding","1rem"),M.style.setProperty("border-radius","var(--border-radius)"),M.style.setProperty("margin-bottom","2rem"),M.style.setProperty("border","1px solid var(--warning-color)"),P.style.setProperty("font-size","1.125rem"),P.style.setProperty("font-weight","600"),P.style.setProperty("margin-bottom","0.5rem"),P.style.setProperty("color","var(--warning-dark)"),a(P,()=>t("passport.cuban.instructions.title","Important Instructions")),w.style.setProperty("margin-left","1.5rem"),w.style.setProperty("font-size","0.875rem"),w.style.setProperty("color","var(--text-primary)"),a(v,()=>t("passport.cuban.instructions.1","All names should be entered in UPPERCASE letters")),a(j,()=>t("passport.cuban.instructions.2","Ensure all information matches your official documents")),a(z,()=>t("passport.cuban.instructions.3","Upload a clear image of your signature on white paper")),a(T,()=>t("passport.cuban.instructions.4","The generated PDF will match the official Cuban passport form format")),a(R,()=>t("passport.cuban.instructions.5","You will need to print the form and add a 4.5 x 4.5 cm photo")),M}}),x),a(h,A(Me,{get when(){return e()==="form"},get children(){return A(OO,{onSubmit:o,get initialData(){return n()?.applicationData||u},get applicationId(){return n()?.id},onSave:d})}}),x),a(h,A(Me,{get when(){return e()==="list"},get children(){return A(QO,{onSelectApplication:s,onEditApplication:l,showActions:!0})}}),x),x.style.setProperty("margin-top","3rem"),x.style.setProperty("padding","1.5rem"),x.style.setProperty("background","var(--gray-50)"),x.style.setProperty("border-radius","var(--border-radius)"),x.style.setProperty("text-align","center"),b.style.setProperty("font-size","1.25rem"),b.style.setProperty("font-weight","600"),b.style.setProperty("margin-bottom","1rem"),b.style.setProperty("color","var(--text-primary)"),a(b,()=>t("passport.cuban.help.title","Need Help?")),K.style.setProperty("font-size","1rem"),K.style.setProperty("color","var(--text-muted)"),K.style.setProperty("margin-bottom","1rem"),a(K,()=>t("passport.cuban.help.description","For assistance with your passport application, contact the nearest Cuban consulate.")),te.style.setProperty("display","flex"),te.style.setProperty("justify-content","center"),te.style.setProperty("gap","2rem"),te.style.setProperty("flex-wrap","wrap"),V.style.setProperty("font-weight","500"),V.style.setProperty("margin-bottom","0.25rem"),a(V,()=>t("passport.cuban.help.phone","Phone")),W.style.setProperty("color","var(--primary-color)"),E.style.setProperty("font-weight","500"),E.style.setProperty("margin-bottom","0.25rem"),a(E,()=>t("passport.cuban.help.email","Email")),L.style.setProperty("color","var(--primary-color)"),h})()};var eB=le("<div><main>");const tB=t=>[A(wI,{}),ke(()=>t.children)],rB=()=>A(KE,{get children(){var t=eB(),e=t.firstChild;return a(e,A(bw,{root:tB,get children(){return[A($i,{path:"/",component:DR}),A($i,{path:"/accounts",component:()=>A(Vi,{permission:"AccountAccess",featureName:"Accounts",get children(){return A(pT,{})}})}),A($i,{path:"/accounts/:id",component:()=>A(Vi,{permission:"AccountAccess",featureName:"Account Details",get children(){return A(PT,{})}})}),A($i,{path:"/entry-books",component:()=>A(Vi,{permission:"JournalAccess",featureName:"Entry Books",get children(){return A(_L,{})}})}),A($i,{path:"/employees",component:()=>A(Vi,{permission:"EmployeeAccess",featureName:"Employee Management",get children(){return A(bN,{})}})}),A($i,{path:"/bank-consolidations",component:()=>A(Vi,{permission:"BankingAccess",featureName:"Bank Consolidations",get children(){return A(WN,{})}})}),A($i,{path:"/balance-sheet",component:()=>A(Vi,{permission:"AccountAccess",featureName:"Balance Sheet",get children(){return A(AT,{})}})}),A($i,{path:"/invoices",component:()=>A(Vi,{permission:"invoiceAccess",featureName:"Invoices",get children(){return A(wM,{})}})}),A($i,{path:"/inventory",component:()=>A(Vi,{permission:"InventoryAccess",featureName:"Inventory Management",get children(){return A(dN,{})}})}),A($i,{path:"/products",component:()=>A(Vi,{permission:"InventoryAccess",featureName:"Product Management",get children(){return A(LP,{})}})}),A($i,{path:"/hbl",component:()=>A(Vi,{permission:"HBLAccess",featureName:"HBL Management",get children(){return A(ER,{})}})}),A($i,{path:"/cuban-passport",component:()=>A(Vi,{permission:"PassportAccess",featureName:"Cuban Passport Application",get children(){return A(ZO,{})}})}),A($i,{path:"/admin/users",component:()=>A(Vi,{permission:"isAdmin",featureName:"User Administration",get children(){return A(YR,{})}})}),A($i,{path:"/automation",component:()=>A(Vi,{permission:"AccountAccess",featureName:"Manual Automation",get children(){return A(oF,{})}})}),A($i,{path:"/event-automation",component:()=>A(Vi,{permission:"AccountAccess",featureName:"Event Automation",get children(){return A(uO,{})}})})]}})),a(t,(()=>{var r=ke(()=>!1);return()=>r()&&A(DI,{})})(),null),t}}),nB=document.getElementById("root");RS(()=>A(rB,{}),nB);export{cr as E,no as _,tn as a,lB as b,gt as i,i_ as j};
