import{g as N,O as wt,P as Kt,c as K,o as Yt,aA as ir,f as or,W as Qt,a as v,t as h,h as e,i as o,S as f,F as Je,b as c,d as Ut,_ as Jt,V as Tt,v as lt,A as lr,aB as ar}from"./index-fjqJWr9C.js";const pt=[{code:"USD",name:"US Dollar",symbol:"$"},{code:"EUR",name:"Euro",symbol:"‚Ç¨"},{code:"CUP",name:"Peso Cubano",symbol:"$"},{code:"CUC",name:"Peso Convertible Cubano",symbol:"CUC"}],Pt=[{value:"pending",label:"Pendiente",color:"#f59e0b"},{value:"processing",label:"Procesando",color:"#3b82f6"},{value:"completed",label:"Completada",color:"#10b981"},{value:"cancelled",label:"Cancelada",color:"#ef4444"}],sr=()=>{const r=new Date,s=r.getFullYear(),$=String(r.getMonth()+1).padStart(2,"0"),t=String(r.getDate()).padStart(2,"0"),d=`${s}${$}${t}`,p=String(r.getHours()).padStart(2,"0"),l=String(r.getMinutes()).padStart(2,"0"),I=String(r.getSeconds()).padStart(2,"0"),T=`${p}${l}${I}`,X=Math.random().toString(36).substr(2,5).toUpperCase();return`REM-${d}-${T}-${X}`},Rt={async getAll(r,s=1,$=20){try{let t={businessId:N.getBusinessId(),page:s,pageSize:$},d=["businessId = businessId"];const p=N.state?.profile;p&&!p.isAdmin&&!p.read_write&&(t[":createdBy"]=N.currentUser?.uid||"unknown",d.push("createdBy = :createdBy")),r?.search&&r.search.split(" ").forEach((X,Z)=>{const V=`search${Z}`;t[`:${V}`]=X.trim(),d.push(`(remittanceNumber contain :${V} OR customerName contain :${V} OR reference contain :${V})`)}),r?.status&&(t[":status"]=r.status,d.push("status = :status")),r?.currency&&(t[":currency"]=r.currency,d.push("currency = :currency")),r?.dateFrom&&(t[":dateFrom"]=r.dateFrom.toISOString(),d.push("createdAt >= :dateFrom")),r?.dateTo&&(t[":dateTo"]=r.dateTo.toISOString(),d.push("createdAt <= :dateTo")),r?.customerId&&(t[":customerId"]=r.customerId,d.push("customerId = :customerId"));const I={query:"getRemittance",queryString:d.join(" AND "),params:t},T=await wt(I);return{remittances:T.data||[],total:T.total||0,page:s,pageSize:$}}catch(t){return console.error("Error fetching remittances:",t),{remittances:[],total:0,page:s,pageSize:$}}},async getById(r){try{const $={query:"getRemittance",queryString:"!* contain id",params:{id:{id:r}.id}},t=await wt($);return console.log($),console.log(t),t.data&&t.data.length>0?t.data[0]:null}catch(s){return console.error("Error fetching remittance by ID:",s),null}},async create(r){try{const s=sr(),$={...r,remittanceNumber:s,id:Kt(),date:new Date,status:"pending",createdAt:new Date,updatedAt:new Date,businessId:N.getBusinessId(),createdBy:N.currentUser?.uid||"unknown"},d={query:"addRemittance",params:{businessId:N.getBusinessId()},form:$},p=await wt(d);if(p.error)throw new Error(p.error);return{...$}}catch(s){throw console.error("Error creating remittance:",s),new Error("Error al crear la remesa")}},async update(r){try{const s={...r,updatedAt:new Date},t={query:"updateRemittance",params:{businessId:r.businessId,id:r.id},form:s},d=await wt(t);if(d.error)throw new Error(d.error);const p=await this.getById(r.id);if(!p)throw new Error("No se pudo recuperar la remesa actualizada");return p}catch(s){throw console.error("Error updating remittance:",s),new Error("Error al actualizar la remesa")}},async delete(r){try{const $={query:"deleteRemittance",params:{businessId:N.getBusinessId(),id:r}},t=await wt($);if(t.error)throw new Error(t.error);return{success:!0,message:"Remesa eliminada exitosamente"}}catch(s){return console.error("Error deleting remittance:",s),{success:!1,message:"Error al eliminar la remesa"}}},async updateStatus(r,s){return this.update({id:r,status:s})},async getByCustomer(r){try{const s={customerId:r};return(await this.getAll(s,1,100)).remittances}catch(s){return console.error("Error fetching remittances by customer:",s),[]}},async getStatistics(){try{const s={query:"getRemittanceStatistics",params:{businessId:N.getBusinessId()}};return(await wt(s)).data||{total:0,byStatus:{},byCurrency:{},totalAmount:{}}}catch(r){return console.error("Error fetching remittance statistics:",r),{total:0,byStatus:{},byCurrency:{},totalAmount:{}}}}},Mt=r=>({pending:"Pendiente",processing:"Procesando",completed:"Completada",cancelled:"Cancelada"})[r]||r,zt=r=>({pending:"#f59e0b",processing:"#3b82f6",completed:"#10b981",cancelled:"#ef4444"})[r]||"#6b7280";var dr=h("<div>Ref: "),qt=h("<select>"),cr=h("<div><span>Equivalente CUP</span><div><span>$"),ur=h("<div>C√©dula: "),vr=h("<button>‚úèÔ∏è Editar"),mr=h("<button>üóëÔ∏è"),gr=h("<div><div><div><div></div></div></div><div><div><span>Estado</span></div><div><span>Fecha</span><span></span></div><div><span>USD</span><div></div></div></div><div><div></div></div><div><button>üëÅÔ∏è Ver"),jt=h("<span>"),Ft=h("<option>"),hr=h("<button>+ Nueva"),br=h("<div><div><select><option value>Todos los estados</option></select><select><option value>Moneda</option></select></div><div><button>Aplicar</button><button>Limpiar"),fr=h("<div>"),yr=h("<div><button>‚Üê Anterior</button><span> / </span><button>Siguiente ‚Üí"),xr=h('<div><div><div><h1>Remesas</h1></div><div><input type=text placeholder="Buscar remesa..."><button>üîç'),Vt=h("<div>Cargando remesas..."),Wt=h("<div><p>No se encontraron remesas.</p><button>Crear primera remesa"),Sr=h("<button>+ Nueva Remesa"),$r=h("<th>Creado por"),wr=h("<table><thead><tr><th>N√∫mero</th><th>Cliente</th><th>Cantidad</th><th>Estado</th><th>Fecha</th><th>Acciones</th></tr></thead><tbody>"),pr=h("<div><button>Anterior</button><span>P√°gina <!> de </span><button>Siguiente"),Cr=h('<div><div><h1>Lista de Remesas</h1></div><div><div><label>Buscar</label><input type=text placeholder="N√∫mero, cliente, referencia..."></div><div><label>Estado</label><select><option value>Todos los estados</option></select></div><div><label>Moneda</label><select><option value>Todas las monedas</option></select></div><div><label>&nbsp;</label><div><button>Filtrar</button><button>Limpiar'),_r=h("<option> - "),Ot=h("<br>"),kr=h("<small>Ref: "),Er=h("<small>C√©dula: "),Fr=h("<small> $"),Rr=h("<td><small>"),zr=h("<button>Editar"),Dr=h("<button>Eliminar"),Nr=h("<tr><td><strong></strong><p></p></td><td><div></div></td><td><strong></strong></td><td></td><td></td><td><button>Ver");const Ar=r=>{const[s,$]=K({}),[t,d]=K(1),[p]=K(20),[l,I]=K(""),[T,X]=K(""),[Z,V]=K(""),[O,ue]=K(!1),[F,k]=K(window.innerWidth<768),[P,M]=K(!1),Be=()=>{k(window.innerWidth<768)};Yt(()=>{window.addEventListener("resize",Be)}),ir(()=>{window.removeEventListener("resize",Be)});const ve=or(()=>{const u={};return l()&&(u.search=l()),T()&&(u.status=T()),Z()&&(u.currency=Z()),u}),[w,{refetch:U}]=Qt(()=>({filter:ve(),page:t(),pageSize:p()}),async({filter:u,page:E,pageSize:he})=>await Rt.getAll(u,E,he)),oe=async u=>{if(confirm(`¬øEst√° seguro que desea eliminar la remesa ${u.remittanceNumber}?`)){const E=await Rt.delete(u.id);E.success?(alert("Remesa eliminada exitosamente"),U()):alert(E.message)}},G=async(u,E)=>{try{await Rt.updateStatus(u.id,E),alert("Estado actualizado exitosamente"),U()}catch{alert("Error al actualizar el estado")}},Pe=()=>{d(1),U()},W=()=>{I(""),X(""),V(""),d(1),U()},ee=(u,E)=>`${pt.find(Re=>Re.code===E)?.symbol||E} ${u.toFixed(2)}`,De={padding:"2rem","background-color":"var(--background-color)"},Ue={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},Xe={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)"},x={padding:"0.75rem 1.5rem","background-color":"var(--primary-color)",color:"white",border:"none","border-radius":"4px",cursor:"pointer","font-weight":"500"},ne={display:"flex",gap:"1rem","margin-bottom":"2rem","flex-wrap":"wrap","align-items":"end"},Se={display:"flex","flex-direction":"column",gap:"0.5rem"},_e={"font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)"},se={padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"4px","font-size":"0.875rem"},ke={...se,cursor:"pointer"},$e={padding:"0.5rem 1rem",border:"none","border-radius":"4px",cursor:"pointer","font-size":"0.875rem","font-weight":"500"},L={...$e,"background-color":"var(--primary-color)",color:"white"},de={...$e,"background-color":"var(--border-color)",color:"var(--text-secondary)"},ye={width:"100%","border-collapse":"collapse","background-color":"white","border-radius":"8px",overflow:"hidden","box-shadow":"0 1px 3px rgba(0,0,0,0.1)"},me={padding:"1rem","text-align":"left","background-color":"var(--strip-color)","font-weight":"600","font-size":"0.875rem",color:"var(--text-primary)","border-bottom":"1px solid var(--border-color)"},ge={padding:"1rem","border-bottom":"1px solid var(--border-light)","font-size":"0.875rem","vertical-align":"middle"},Ve=u=>({display:"inline-block",padding:"0.25rem 0.5rem","border-radius":"12px","font-size":"0.75rem","font-weight":"500","background-color":zt(u)+"20",color:zt(u)}),Le={...$e,padding:"0.25rem 0.5rem","font-size":"0.75rem","margin-right":"0.5rem"},at={...Le,"background-color":"#3b82f6",color:"white"},ht={...Le,"background-color":"#6b7280",color:"white"},st={...Le,"background-color":"#ef4444",color:"white"},Te={display:"flex","justify-content":"center","align-items":"center",gap:"1rem","margin-top":"2rem"},bt={"text-align":"center",padding:"3rem",color:"var(--text-muted)"},We={"text-align":"center",padding:"3rem",color:"var(--text-muted)"},Ze={padding:"1rem","background-color":"var(--background-color)"},ft={display:"flex","flex-direction":"column",gap:"1rem","margin-bottom":"1rem"},dt={display:"flex","justify-content":"space-between","align-items":"center"},Oe={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)"},Ge={padding:"0.5rem 1rem","background-color":"var(--primary-color)",color:"white",border:"none","border-radius":"4px",cursor:"pointer","font-weight":"500","font-size":"0.875rem"},et={display:"flex",gap:"0.5rem","align-items":"center"},a={flex:"1",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"8px","font-size":"1rem"},R={padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"8px",background:"white",cursor:"pointer",display:"flex","align-items":"center","justify-content":"center"},q={display:"flex","flex-direction":"column",gap:"0.75rem",padding:"1rem",background:"white","border-radius":"8px","margin-bottom":"1rem","box-shadow":"0 2px 8px rgba(0,0,0,0.08)"},C={display:"flex",gap:"0.5rem"},le={flex:"1",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"8px","font-size":"0.875rem",background:"white"},Ee={display:"flex",gap:"0.5rem","margin-top":"0.5rem"},we={flex:"1",padding:"0.75rem","border-radius":"8px",border:"none","font-weight":"500",cursor:"pointer"},He={display:"flex","flex-direction":"column",gap:"1rem"},Ke={background:"white","border-radius":"12px",padding:"1rem","box-shadow":"0 2px 8px rgba(0,0,0,0.08)",border:"1px solid var(--border-light)"},A={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"0.75rem"},pe={"font-weight":"600","font-size":"1rem",color:"var(--text-primary)"},ce={"font-size":"0.75rem",color:"var(--text-muted)","margin-top":"0.25rem"},Ne={"font-size":"1.25rem","font-weight":"700",color:"var(--primary-color)","text-align":"right"},tt={display:"flex","flex-direction":"column",gap:"0.5rem"},Me={display:"flex","justify-content":"space-between","align-items":"center","font-size":"0.875rem"},rt={color:"var(--text-muted)","font-size":"0.75rem"},ct={color:"var(--text-primary)","font-weight":"500"},yt={"border-top":"1px solid var(--border-light)","padding-top":"0.75rem","margin-top":"0.5rem"},xt={"font-weight":"500",color:"var(--text-primary)","margin-bottom":"0.25rem"},ut={"font-size":"0.75rem",color:"var(--text-muted)"},Dt={display:"flex",gap:"0.5rem","margin-top":"1rem","padding-top":"0.75rem","border-top":"1px solid var(--border-light)"},St={flex:"1",padding:"0.625rem","border-radius":"8px",border:"none","font-weight":"500","font-size":"0.875rem",cursor:"pointer",display:"flex","align-items":"center","justify-content":"center",gap:"0.25rem"},Nt={...St,background:"#f3f4f6",color:"#374151"},At={...St,background:"#dbeafe",color:"#1d4ed8"},It={...St,background:"#fee2e2",color:"#dc2626"},n={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"white","border-radius":"8px","margin-top":"1rem"},Y={padding:"0.625rem 1rem","border-radius":"8px",border:"1px solid var(--border-color)",background:"white",cursor:"pointer","font-weight":"500","font-size":"0.875rem"},ie={"font-size":"0.875rem",color:"var(--text-muted)"},y=u=>(()=>{var E=gr(),he=E.firstChild,Ye=he.firstChild,Re=Ye.firstChild,xe=he.nextSibling,ze=xe.firstChild,S=ze.firstChild,z=ze.nextSibling,D=z.firstChild,H=D.nextSibling,be=z.nextSibling,B=be.firstChild,Ae=B.nextSibling,_=xe.nextSibling,ae=_.firstChild,Ce=_.nextSibling,nt=Ce.firstChild;return e(E,Ke),e(he,A),e(Re,pe),o(Re,()=>u.remittanceNumber),o(Ye,v(f,{get when(){return u.reference},get children(){var i=dr();return i.firstChild,e(i,ce),o(i,()=>u.reference,null),i}}),null),o(ze,v(f,{get when(){return N.state?.profile?.isAdmin||N.state?.profile?.read_write||u.createdBy===N.currentUser?.uid},get fallback(){return(()=>{var i=jt();return o(i,()=>Mt(u.status)),c(b=>e(i,Ve(u.status),b)),i})()},get children(){var i=qt();return i.addEventListener("change",b=>G(u,b.target.value)),o(i,v(Je,{each:Pt,children:b=>(()=>{var j=Ft();return o(j,()=>b.label),c(()=>j.value=b.value),j})()})),c(b=>e(i,{...le,flex:"none",width:"auto",padding:"0.25rem 0.5rem",...Ve(u.status),border:`1px solid ${zt(u.status)}40`},b)),c(()=>i.value=u.status),i}}),null),o(H,()=>new Date(u.date).toLocaleDateString("es-ES")),o(Ae,()=>ee(u.amount,u.currency)),o(xe,v(f,{get when(){return u.currency!=="USD"&&u.exchangeRate},get children(){var i=cr(),b=i.firstChild,j=b.nextSibling,te=j.firstChild;return te.firstChild,o(te,()=>(u.amount*(u.exchangeRate||1)).toFixed(2),null),c(Q=>{var fe=Me,re=rt,Ie={...ct,...Ne};return Q.e=e(i,fe,Q.e),Q.t=e(b,re,Q.t),Q.a=e(te,Ie,Q.a),Q},{e:void 0,t:void 0,a:void 0}),i}}),null),e(_,yt),e(ae,xt),o(ae,()=>u.customer.fullName||u.customer.name),o(_,v(f,{get when(){return u.customer.cid},get children(){var i=ur();return i.firstChild,e(i,ut),o(i,()=>u.customer.cid,null),i}}),null),e(Ce,Dt),nt.$$click=()=>r.onView(u),o(Ce,v(f,{get when(){return N.isAdmin()},get children(){return[(()=>{var i=vr();return i.$$click=()=>r.onEdit(u),c(b=>e(i,At,b)),i})(),(()=>{var i=mr();return i.$$click=()=>oe(u),c(b=>e(i,It,b)),i})()]}}),null),c(i=>{var b=tt,j=Me,te=rt,Q=Me,fe=rt,re=ct,Ie=Me,qe=rt,it=Ne,g=Nt;return i.e=e(xe,b,i.e),i.t=e(ze,j,i.t),i.a=e(S,te,i.a),i.o=e(z,Q,i.o),i.i=e(D,fe,i.i),i.n=e(H,re,i.n),i.s=e(be,Ie,i.s),i.h=e(B,qe,i.h),i.r=e(Ae,it,i.r),i.d=e(nt,g,i.d),i},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),E})(),Fe=()=>(()=>{var u=xr(),E=u.firstChild,he=E.firstChild,Ye=he.firstChild,Re=he.nextSibling,xe=Re.firstChild,ze=xe.nextSibling;return e(u,Ze),e(he,dt),e(Ye,Oe),o(he,v(f,{get when(){return N.isAdmin()},get children(){var S=hr();return S.$$click=()=>r.onCreate(),c(z=>e(S,Ge,z)),S}}),null),e(Re,et),xe.$$keyup=S=>S.key==="Enter"&&Pe(),xe.$$input=S=>I(S.target.value),e(xe,a),ze.$$click=()=>M(!P()),o(u,v(f,{get when(){return P()},get children(){var S=br(),z=S.firstChild,D=z.firstChild;D.firstChild;var H=D.nextSibling;H.firstChild;var be=z.nextSibling,B=be.firstChild,Ae=B.nextSibling;return e(z,C),D.addEventListener("change",_=>X(_.target.value)),o(D,v(Je,{each:Pt,children:_=>(()=>{var ae=Ft();return o(ae,()=>_.label),c(()=>ae.value=_.value),ae})()}),null),H.addEventListener("change",_=>V(_.target.value)),o(H,v(Je,{each:pt,children:_=>(()=>{var ae=Ft();return o(ae,()=>_.code),c(()=>ae.value=_.code),ae})()}),null),e(be,Ee),B.$$click=Pe,Ae.$$click=W,c(_=>{var ae=q,Ce=le,nt=le,i={...we,background:"var(--primary-color)",color:"white"},b={...we,background:"#f3f4f6",color:"var(--text-secondary)"};return _.e=e(S,ae,_.e),_.t=e(D,Ce,_.t),_.a=e(H,nt,_.a),_.o=e(B,i,_.o),_.i=e(Ae,b,_.i),_},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),c(()=>D.value=T()),c(()=>H.value=Z()),S}}),null),o(u,v(f,{get when(){return!w.loading},get fallback(){return(()=>{var S=Vt();return c(z=>e(S,{...We,background:"white","border-radius":"12px"},z)),S})()},get children(){return v(f,{get when(){return w()?.remittances.length>0},get fallback(){return(()=>{var S=Wt(),z=S.firstChild,D=z.nextSibling;return D.$$click=()=>r.onCreate(),c(H=>{var be={...We,background:"white","border-radius":"12px"},B={...Ge,"margin-top":"1rem"};return H.e=e(S,be,H.e),H.t=e(D,B,H.t),H},{e:void 0,t:void 0}),S})()},get children(){return[(()=>{var S=fr();return o(S,v(Je,{get each(){return w()?.remittances||[]},children:z=>y(z)})),c(z=>e(S,He,z)),S})(),v(f,{get when(){return w()?.total>p()},get children(){var S=yr(),z=S.firstChild,D=z.nextSibling,H=D.firstChild,be=D.nextSibling;return e(S,n),z.$$click=()=>d(t()-1),e(D,ie),o(D,t,H),o(D,()=>Math.ceil((w()?.total||0)/p()),null),be.$$click=()=>d(t()+1),c(B=>{var Ae={...Y,opacity:t()===1?.5:1},_=t()===1,ae={...Y,opacity:t()>=Math.ceil((w()?.total||0)/p())?.5:1},Ce=t()>=Math.ceil((w()?.total||0)/p());return B.e=e(z,Ae,B.e),_!==B.t&&(z.disabled=B.t=_),B.a=e(be,ae,B.a),Ce!==B.o&&(be.disabled=B.o=Ce),B},{e:void 0,t:void 0,a:void 0,o:void 0}),S}})]}})}}),null),c(S=>{var z=ft,D={...R,background:P()?"var(--primary-color)":"white",color:P()?"white":"var(--text-primary)"};return S.e=e(E,z,S.e),S.t=e(ze,D,S.t),S},{e:void 0,t:void 0}),c(()=>xe.value=l()),u})();return v(f,{get when(){return F()},get fallback(){return(()=>{var u=Cr(),E=u.firstChild,he=E.firstChild,Ye=E.nextSibling,Re=Ye.firstChild,xe=Re.firstChild,ze=xe.nextSibling,S=Re.nextSibling,z=S.firstChild,D=z.nextSibling;D.firstChild;var H=S.nextSibling,be=H.firstChild,B=be.nextSibling;B.firstChild;var Ae=H.nextSibling,_=Ae.firstChild,ae=_.nextSibling,Ce=ae.firstChild,nt=Ce.nextSibling;return e(u,De),e(E,Ue),e(he,Xe),o(E,v(f,{get when(){return N.isAdmin()},get children(){var i=Sr();return i.$$click=()=>r.onCreate(),e(i,x),i}}),null),e(Ye,ne),ze.$$input=i=>I(i.target.value),D.addEventListener("change",i=>X(i.target.value)),o(D,v(Je,{each:Pt,children:i=>(()=>{var b=Ft();return o(b,()=>i.label),c(()=>b.value=i.value),b})()}),null),B.addEventListener("change",i=>V(i.target.value)),o(B,v(Je,{each:pt,children:i=>(()=>{var b=_r(),j=b.firstChild;return o(b,()=>i.code,j),o(b,()=>i.name,null),c(()=>b.value=i.code),b})()}),null),Ce.$$click=Pe,nt.$$click=W,o(u,v(f,{get when(){return!w.loading},get fallback(){return(()=>{var i=Vt();return c(b=>e(i,bt,b)),i})()},get children(){return v(f,{get when(){return w()?.remittances.length>0},get fallback(){return(()=>{var i=Wt(),b=i.firstChild,j=b.nextSibling;return j.$$click=()=>r.onCreate(),c(te=>{var Q=We,fe=L;return te.e=e(i,Q,te.e),te.t=e(j,fe,te.t),te},{e:void 0,t:void 0}),i})()},get children(){return[(()=>{var i=wr(),b=i.firstChild,j=b.firstChild,te=j.firstChild,Q=te.nextSibling,fe=Q.nextSibling,re=fe.nextSibling,Ie=re.nextSibling,qe=Ie.nextSibling,it=b.nextSibling;return o(j,v(f,{get when(){return N.state?.profile?.isAdmin},get children(){var g=$r();return c(je=>e(g,me,je)),g}}),qe),o(it,v(Je,{get each(){return w()?.remittances||[]},children:g=>(()=>{var je=Nr(),Qe=je.firstChild,vt=Qe.firstChild,Ct=vt.nextSibling,mt=Qe.nextSibling,_t=mt.firstChild,gt=mt.nextSibling,Lt=gt.firstChild,kt=gt.nextSibling,Et=kt.nextSibling,$t=Et.nextSibling,Bt=$t.firstChild;return o(vt,()=>g.remittanceNumber),o(Ct,()=>g.id),o(Qe,v(f,{get when(){return g.reference},get children(){return[Ot(),(()=>{var m=kr();return m.firstChild,m.style.setProperty("color","var(--text-muted)"),o(m,()=>g.reference,null),m})()]}}),null),o(_t,()=>g.customer.fullName||g.customer.name),o(mt,v(f,{get when(){return g.customer.cid},get children(){var m=Er();return m.firstChild,m.style.setProperty("color","var(--text-muted)"),o(m,()=>g.customer.cid,null),m}}),null),o(Lt,()=>ee(g.amount,g.currency)),o(gt,v(f,{get when(){return g.currency!=="USD"&&g.exchangeRate},get children(){return[Ot(),(()=>{var m=Fr(),J=m.firstChild;return m.style.setProperty("color","var(--text-muted)"),o(m,()=>g.currency,J),o(m,()=>(g.amount*(g.exchangeRate||1)).toFixed(2),null),m})()]}}),null),o(kt,v(f,{get when(){return N.state?.profile?.isAdmin||N.state?.profile?.read_write||g.createdBy===N.currentUser?.uid},get fallback(){return(()=>{var m=jt();return o(m,()=>Mt(g.status)),c(J=>e(m,Ve(g.status),J)),m})()},get children(){var m=qt();return m.addEventListener("change",J=>G(g,J.target.value)),o(m,v(Je,{each:Pt,children:J=>(()=>{var ot=Ft();return o(ot,()=>J.label),c(()=>ot.value=J.value),ot})()})),c(J=>e(m,{...ke,...Ve(g.status),border:"none",background:"transparent"},J)),c(()=>m.value=g.status),m}})),o(Et,()=>new Date(g.date).toLocaleDateString("es-ES")),o(je,v(f,{get when(){return N.isAdmin()},get children(){var m=Rr(),J=m.firstChild;return J.style.setProperty("color","var(--text-muted)"),o(J,()=>g.createdBy||"N/A"),c(ot=>e(m,ge,ot)),m}}),$t),Bt.$$click=()=>r.onView(g),o($t,v(f,{get when(){return N.isAdmin()},get children(){return[(()=>{var m=zr();return m.$$click=()=>r.onEdit(g),c(J=>e(m,at,J)),m})(),(()=>{var m=Dr();return m.$$click=()=>oe(g),c(J=>e(m,st,J)),m})()]}}),null),c(m=>{var J=ge,ot=ge,Zt=ge,er=ge,tr=ge,rr=ge,nr=ht;return m.e=e(Qe,J,m.e),m.t=e(mt,ot,m.t),m.a=e(gt,Zt,m.a),m.o=e(kt,er,m.o),m.i=e(Et,tr,m.i),m.n=e($t,rr,m.n),m.s=e(Bt,nr,m.s),m},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),je})()})),c(g=>{var je=ye,Qe=me,vt=me,Ct=me,mt=me,_t=me,gt=me;return g.e=e(i,je,g.e),g.t=e(te,Qe,g.t),g.a=e(Q,vt,g.a),g.o=e(fe,Ct,g.o),g.i=e(re,mt,g.i),g.n=e(Ie,_t,g.n),g.s=e(qe,gt,g.s),g},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),i})(),v(f,{get when(){return w()?.total>p()},get children(){var i=pr(),b=i.firstChild,j=b.nextSibling,te=j.firstChild,Q=te.nextSibling;Q.nextSibling;var fe=j.nextSibling;return e(i,Te),b.$$click=()=>d(t()-1),o(j,t,Q),o(j,()=>Math.ceil((w()?.total||0)/p()),null),fe.$$click=()=>d(t()+1),c(re=>{var Ie=de,qe=t()===1,it=de,g=t()>=Math.ceil((w()?.total||0)/p());return re.e=e(b,Ie,re.e),qe!==re.t&&(b.disabled=re.t=qe),re.a=e(fe,it,re.a),g!==re.o&&(fe.disabled=re.o=g),re},{e:void 0,t:void 0,a:void 0,o:void 0}),i}})]}})}}),null),c(i=>{var b=Se,j=_e,te=se,Q=Se,fe=_e,re=ke,Ie=Se,qe=_e,it=ke,g=Se,je=_e,Qe=L,vt=de;return i.e=e(Re,b,i.e),i.t=e(xe,j,i.t),i.a=e(ze,te,i.a),i.o=e(S,Q,i.o),i.i=e(z,fe,i.i),i.n=e(D,re,i.n),i.s=e(H,Ie,i.s),i.h=e(be,qe,i.h),i.r=e(B,it,i.r),i.d=e(Ae,g,i.d),i.l=e(_,je,i.l),i.u=e(Ce,Qe,i.u),i.c=e(nt,vt,i.c),i},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0}),c(()=>ze.value=l()),c(()=>D.value=T()),c(()=>B.value=Z()),u})()},get children(){return v(Fe,{})}})};Ut(["click","input","keyup"]);const Ir=r=>{const s=58.419999999999995,$=4*25.4,t=new Jt({orientation:"portrait",unit:"mm",format:[s,$]}),d=5,p=5;let l=d;const I=(k,P,M=10)=>{t.setFontSize(M);const Be=t.splitTextToSize(k,s-2*d);return t.text(Be,d,P),P+Be.length*p};t.setFontSize(14),t.setFont("helvetica","bold"),t.text("REMESA",s/2,l,{align:"center"}),l+=8,t.setLineWidth(.5),t.line(d,l,s-d,l),l+=5,t.setFontSize(8),t.setFont("helvetica","normal");const T=new Date(r.date);t.text(`Fecha: ${T.toLocaleDateString("es-ES")}`,d,l),l+=4,t.text(`No.: ${r.remittanceNumber}`,d,l),l+=4,t.setLineWidth(.2),t.line(d,l,s-d,l),l+=5,t.setFontSize(10),t.setFont("helvetica","bold"),t.text("DESTINATARIO:",d,l),l+=5,t.setFont("helvetica","normal");const X=r.customer.fullName||`${r.customer.firstName||""} ${r.customer.lastName||""}`.trim()||r.customer.name;l=I(X,l,9),l+=2,r.customer.address&&(t.setFontSize(8),l=I(r.customer.address,l,8),l+=2),r.customer.phoneNumber&&(t.setFontSize(8),t.text(`Tel√©fono: ${r.customer.phoneNumber}`,d,l),l+=4),r.customer.cid&&(t.setFontSize(8),t.text(`C√©dula: ${r.customer.cid}`,d,l),l+=4),l+=2,t.setLineWidth(.2),t.line(d,l,s-d,l),l+=5,t.setFontSize(10),t.setFont("helvetica","bold"),t.text("CANTIDAD:",d,l),l+=5;const Z={USD:"$",EUR:"‚Ç¨",CUP:"‚Ç±",CUC:"CUC$"};t.setFontSize(14),t.setFont("helvetica","bold");const O=`${Z[r.currency]||r.currency}${r.amount.toFixed(2)}`;if(t.text(O,s/2,l,{align:"center"}),l+=6,t.setFontSize(8),t.setFont("helvetica","normal"),t.text(r.currency,s/2,l,{align:"center"}),l+=5,r.currency!=="USD"&&r.exchangeRate){t.setFontSize(8);const k=(r.amount*r.exchangeRate).toFixed(2);t.text(`(USD $${k})`,s/2,l,{align:"center"}),l+=5}r.reference&&(l+=3,t.setLineWidth(.2),t.line(d,l,s-d,l),l+=5,t.setFontSize(8),t.setFont("helvetica","normal"),l=I(`Referencia: ${r.reference}`,l,8)),$-l-d>10&&(l=$-10,t.setFontSize(6),t.setFont("helvetica","italic"),t.text("Gracias por su confianza",s/2,l,{align:"center"}));const F=`remesa_${r.customer.cid||"cliente"}_${Date.now()}.pdf`;t.save(F)},Xt=r=>{const s=58.419999999999995,$=5*25.4,t=new Jt({orientation:"portrait",unit:"mm",format:[s,$]}),d=5,p=5;let l=d;const I=(F,k,P=10)=>{t.setFontSize(P);const M=t.splitTextToSize(F,s-2*d);return t.text(M,d,k),k+M.length*p};t.setFontSize(14),t.setFont("helvetica","bold"),t.text("REMESA",s/2,l,{align:"center"}),l+=8,t.setLineWidth(.5),t.line(d,l,s-d,l),l+=5,t.setFontSize(8),t.setFont("helvetica","normal");const T=new Date(r.date);t.text(`Fecha: ${T.toLocaleDateString("es-ES")}`,d,l),l+=4,t.text(`No.: ${r.remittanceNumber}`,d,l),l+=4,t.setLineWidth(.2),t.line(d,l,s-d,l),l+=5,t.setFontSize(10),t.setFont("helvetica","bold"),t.text("DESTINATARIO:",d,l),l+=5,t.setFont("helvetica","normal");const X=r.customer.fullName||`${r.customer.firstName||""} ${r.customer.lastName||""}`.trim()||r.customer.name;l=I(X,l,9),l+=2,r.customer.address&&(t.setFontSize(8),l=I(r.customer.address,l,8),l+=2),r.customer.phoneNumber&&(t.setFontSize(8),t.text(`Tel√©fono: ${r.customer.phoneNumber}`,d,l),l+=4),r.customer.cid&&(t.setFontSize(8),t.text(`C√©dula: ${r.customer.cid}`,d,l),l+=4),l+=2,t.setLineWidth(.2),t.line(d,l,s-d,l),l+=5,t.setFontSize(10),t.setFont("helvetica","bold"),t.text("CANTIDAD:",d,l),l+=9;const Z={USD:"$",EUR:"‚Ç¨",CUP:"$",CUC:"CUC"};if(r.currency!=="USD"&&r.exchangeRate){t.setFontSize(14),t.setFont("helvetica","bold");const F=Z[r.currency]||r.currency,k=(r.amount*r.exchangeRate).toFixed(2),P=`${r.currency} ${F} ${k}`;t.text(P,s/2,l,{align:"center"}),l+=6,t.setFontSize(8),t.text(`(USD $${r.amount.toFixed(2)})`,s/2,l,{align:"center"}),l+=5}r.reference&&(l+=3,t.setLineWidth(.2),t.line(d,l,s-d,l),l+=5,t.setFontSize(8),t.setFont("helvetica","normal"),l=I(`Referencia: ${r.reference}`,l,8)),$-l-d>10&&(l=$-10,t.setFontSize(6),t.setFont("helvetica","italic"),t.text("Gracias por su confianza",s/2,l,{align:"center"}));const O=t.output("dataurlstring"),ue=window.open();ue&&ue.document.write(`
      <html>
        <head>
          <title>Recibo de Remesa</title>
          <style>
            body { margin: 0; padding: 20px; background: #f0f0f0; display: flex; justify-content: center; }
            iframe { box-shadow: 0 0 20px rgba(0,0,0,0.2); }
          </style>
        </head>
        <body>
          <iframe src="${O}" width="600" height="800"></iframe>
        </body>
      </html>
    `)};var Br=h("<div><div><div><h2>Detalles de Remesa</h2><button>√ó"),Pr=h("<div>Cargando detalles..."),Ur=h("<div>No se pudo cargar la remesa"),Lr=h("<div><span>Direcci√≥n</span><span>"),Tr=h("<div><span>Tasa de Cambio</span><span>"),Mr=h("<div><span>Equivalente </span><span>$"),qr=h("<div><h3>Notas</h3><div>"),jr=h("<div><span>Creado por</span><span>"),Vr=h("<div><div><h3>Informaci√≥n General</h3><div><div><span>N√∫mero de Remesa</span><span></span></div><div><span>Estado</span><span></span></div><div><span>Fecha</span><span></span></div><div><span>Referencia</span><span></span></div></div></div><div><h3>Informaci√≥n del Cliente</h3><div><div><span>Nombre Completo</span><span></span></div><div><span>C√©dula</span><span></span></div><div><span>Tel√©fono</span><span></span></div><div><span>Email</span><span></span></div></div></div><div><h3>Informaci√≥n Financiera</h3><div><div><span>Cantidad</span><span> USD</span></div><div><span>Moneda</span><span></span></div></div></div><div><h3>Informaci√≥n de Auditor√≠a</h3><div><div><span>Creado</span><span></span></div><div><span>√öltima Actualizaci√≥n</span><span>"),Wr=h("<button>Editar"),Or=h("<div><button>Vista Previa PDF</button><button>Cerrar");const Gr=r=>{const[s,$]=K(!1);Qt(()=>r.remittanceId,async W=>{if(!W)return null});const t=async()=>{const W=r?.remittance;if(W)try{await Xt(W)}catch(ee){console.error("Error previewing PDF:",ee),alert("Error al mostrar la vista previa")}},d=(W,ee)=>`${pt.find(Xe=>Xe.code===ee)?.symbol||ee} ${W.toFixed(2)}`,p={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},l={"background-color":"white","border-radius":"8px","max-width":"600px",width:"90%","max-height":"90%",overflow:"auto","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1)"},I={padding:"1.5rem","border-bottom":"1px solid var(--border-color)",display:"flex","justify-content":"space-between","align-items":"center"},T={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)"},X={background:"none",border:"none","font-size":"1.5rem",cursor:"pointer",color:"var(--text-muted)"},Z={padding:"1.5rem"},V={"margin-bottom":"2rem"},O={"font-size":"1rem","font-weight":"600","margin-bottom":"1rem",color:"var(--text-primary)","border-bottom":"1px solid var(--border-light)","padding-bottom":"0.5rem"},ue={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"1rem"},F={display:"flex","flex-direction":"column",gap:"0.25rem"},k={"font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)"},P={"font-size":"0.875rem",color:"var(--text-primary)"},M={...P,"font-weight":"600","font-size":"1rem"},Be=W=>({display:"inline-block",padding:"0.5rem 1rem","border-radius":"20px","font-size":"0.875rem","font-weight":"500","background-color":zt(W)+"20",color:zt(W)}),ve={padding:"1.5rem","border-top":"1px solid var(--border-color)",display:"flex",gap:"1rem","justify-content":"flex-end"},w={padding:"0.75rem 1.5rem",border:"none","border-radius":"4px",cursor:"pointer","font-weight":"500","font-size":"0.875rem"},U={...w,"background-color":"var(--primary-color)",color:"white"},oe={...w,"background-color":"var(--border-color)",color:"var(--text-secondary)"},G={"text-align":"center",padding:"2rem",color:"var(--text-muted)"},Pe={"text-align":"center",padding:"2rem",color:"#ef4444"};return(()=>{var W=Br(),ee=W.firstChild,De=ee.firstChild,Ue=De.firstChild,Xe=Ue.nextSibling;return Tt(W,"click",r.onClose,!0),ee.$$click=x=>x.stopPropagation(),e(ee,l),e(De,I),e(Ue,T),Tt(Xe,"click",r.onClose,!0),e(Xe,X),o(ee,v(f,{when:!0,get fallback(){return(()=>{var x=Pr();return c(ne=>e(x,G,ne)),x})()},get children(){return v(f,{get when(){return r?.remittance},get fallback(){return(()=>{var x=Ur();return c(ne=>e(x,Pe,ne)),x})()},children:x=>[(()=>{var ne=Vr(),Se=ne.firstChild,_e=Se.firstChild,se=_e.nextSibling,ke=se.firstChild,$e=ke.firstChild,L=$e.nextSibling,de=ke.nextSibling,ye=de.firstChild,me=ye.nextSibling,ge=de.nextSibling,Ve=ge.firstChild,Le=Ve.nextSibling,at=ge.nextSibling,ht=at.firstChild,st=ht.nextSibling,Te=Se.nextSibling,bt=Te.firstChild,We=bt.nextSibling,Ze=We.firstChild,ft=Ze.firstChild,dt=ft.nextSibling,Oe=Ze.nextSibling,Ge=Oe.firstChild,et=Ge.nextSibling,a=Oe.nextSibling,R=a.firstChild,q=R.nextSibling,C=a.nextSibling,le=C.firstChild,Ee=le.nextSibling,we=Te.nextSibling,He=we.firstChild,Ke=He.nextSibling,A=Ke.firstChild,pe=A.firstChild,ce=pe.nextSibling,Ne=ce.firstChild,tt=A.nextSibling,Me=tt.firstChild,rt=Me.nextSibling,ct=we.nextSibling,yt=ct.firstChild,xt=yt.nextSibling,ut=xt.firstChild,Dt=ut.firstChild,St=Dt.nextSibling,Nt=ut.nextSibling,At=Nt.firstChild,It=At.nextSibling;return e(ne,Z),o(L,()=>x().remittanceNumber),o(me,()=>Mt(x().status)),o(Le,()=>new Date(x().date).toLocaleDateString("es-ES")),o(st,()=>x().reference||"N/A"),o(dt,()=>x().customer.fullName||x().customer.name),o(et,()=>x().customer.cid||"N/A"),o(q,()=>x().customer.phoneNumber||"N/A"),o(Ee,()=>x().customer.email||"N/A"),o(Te,v(f,{get when(){return x().customer.address},get children(){var n=Lr(),Y=n.firstChild,ie=Y.nextSibling;return o(ie,()=>x().customer.address),c(y=>{var Fe=F,u=k,E=M;return y.e=e(n,Fe,y.e),y.t=e(Y,u,y.t),y.a=e(ie,E,y.a),y},{e:void 0,t:void 0,a:void 0}),n}}),null),o(ce,()=>d(x().amount,"USD"),Ne),o(rt,()=>x().currency),o(Ke,v(f,{get when(){return lt(()=>!!x().exchangeRate)()&&x().currency!=="USD"},get children(){return[(()=>{var n=Tr(),Y=n.firstChild,ie=Y.nextSibling;return o(ie,()=>x().exchangeRate?.toFixed(4)),c(y=>{var Fe=F,u=k,E=M;return y.e=e(n,Fe,y.e),y.t=e(Y,u,y.t),y.a=e(ie,E,y.a),y},{e:void 0,t:void 0,a:void 0}),n})(),(()=>{var n=Mr(),Y=n.firstChild;Y.firstChild;var ie=Y.nextSibling;return ie.firstChild,o(Y,()=>x().currency,null),o(ie,()=>(x().amount*(x().exchangeRate||1)).toFixed(2),null),c(y=>{var Fe=F,u=k,E={...M,color:"var(--primary-color)","font-size":"1.6rem"};return y.e=e(n,Fe,y.e),y.t=e(Y,u,y.t),y.a=e(ie,E,y.a),y},{e:void 0,t:void 0,a:void 0}),n})()]}}),null),o(ne,v(f,{get when(){return x().notes},get children(){var n=qr(),Y=n.firstChild,ie=Y.nextSibling;return o(ie,()=>x().notes),c(y=>{var Fe=V,u=O,E=P;return y.e=e(n,Fe,y.e),y.t=e(Y,u,y.t),y.a=e(ie,E,y.a),y},{e:void 0,t:void 0,a:void 0}),n}}),ct),o(St,()=>new Date(x().createdAt).toLocaleString("es-ES")),o(It,()=>new Date(x().updatedAt).toLocaleString("es-ES")),o(xt,v(f,{get when(){return lt(()=>!!N.isAdmin())()&&x().createdBy},get children(){var n=jr(),Y=n.firstChild,ie=Y.nextSibling;return o(ie,()=>x().createdBy),c(y=>{var Fe=F,u=k,E=P;return y.e=e(n,Fe,y.e),y.t=e(Y,u,y.t),y.a=e(ie,E,y.a),y},{e:void 0,t:void 0,a:void 0}),n}}),null),c(n=>{var Y=V,ie=O,y=ue,Fe=F,u=k,E=M,he=F,Ye=k,Re=Be(x().status),xe=F,ze=k,S=M,z=F,D=k,H=M,be=V,B=O,Ae=ue,_=F,ae=k,Ce=M,nt=F,i=k,b=M,j=F,te=k,Q=M,fe=F,re=k,Ie=P,qe=V,it=O,g=ue,je=F,Qe=k,vt=M,Ct=F,mt=k,_t=M,gt=V,Lt=O,kt=ue,Et=F,$t=k,Bt=P,m=F,J=k,ot=P;return n.e=e(Se,Y,n.e),n.t=e(_e,ie,n.t),n.a=e(se,y,n.a),n.o=e(ke,Fe,n.o),n.i=e($e,u,n.i),n.n=e(L,E,n.n),n.s=e(de,he,n.s),n.h=e(ye,Ye,n.h),n.r=e(me,Re,n.r),n.d=e(ge,xe,n.d),n.l=e(Ve,ze,n.l),n.u=e(Le,S,n.u),n.c=e(at,z,n.c),n.w=e(ht,D,n.w),n.m=e(st,H,n.m),n.f=e(Te,be,n.f),n.y=e(bt,B,n.y),n.g=e(We,Ae,n.g),n.p=e(Ze,_,n.p),n.b=e(ft,ae,n.b),n.T=e(dt,Ce,n.T),n.A=e(Oe,nt,n.A),n.O=e(Ge,i,n.O),n.I=e(et,b,n.I),n.S=e(a,j,n.S),n.W=e(R,te,n.W),n.C=e(q,Q,n.C),n.B=e(C,fe,n.B),n.v=e(le,re,n.v),n.k=e(Ee,Ie,n.k),n.x=e(we,qe,n.x),n.j=e(He,it,n.j),n.q=e(Ke,g,n.q),n.z=e(A,je,n.z),n.P=e(pe,Qe,n.P),n.H=e(ce,vt,n.H),n.F=e(tt,Ct,n.F),n.M=e(Me,mt,n.M),n.D=e(rt,_t,n.D),n.R=e(ct,gt,n.R),n.E=e(yt,Lt,n.E),n.L=e(xt,kt,n.L),n.N=e(ut,Et,n.N),n.G=e(Dt,$t,n.G),n.U=e(St,Bt,n.U),n.K=e(Nt,m,n.K),n.V=e(At,J,n.V),n.Y=e(It,ot,n.Y),n},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0,z:void 0,P:void 0,H:void 0,F:void 0,M:void 0,D:void 0,R:void 0,E:void 0,L:void 0,N:void 0,G:void 0,U:void 0,K:void 0,V:void 0,Y:void 0}),ne})(),(()=>{var ne=Or(),Se=ne.firstChild,_e=Se.nextSibling;return e(ne,ve),Se.$$click=t,o(ne,v(f,{get when(){return N.isAdmin()},get children(){var se=Wr();return se.$$click=()=>r.onEdit(x()),c(ke=>e(se,U,ke)),se}}),_e),Tt(_e,"click",r.onClose,!0),c(se=>{var ke=oe,$e=oe;return se.e=e(Se,ke,se.e),se.t=e(_e,$e,se.t),se},{e:void 0,t:void 0}),ne})()]})}}),null),c(x=>e(W,p,x)),W})()};Ut(["click"]);var Hr=h("<div><label>Negocio</label><select>"),Kr=h("<div><label>Tasa de Cambio (a USD)</label><input type=number step=0.0001 min=0 placeholder=1.0000>"),Yr=h("<div><span>Equivalente:</span><span>$<!> "),Qr=h("<div><span>C√©dula:</span><span>"),Jr=h("<div><span>Tel√©fono:</span><span>"),Xr=h("<div><h3>Resumen</h3><div><span>Cliente:</span><span></span></div><div><span>Cantidad:</span><span> USD"),Zr=h("<button type=button>Vista Previa"),en=h('<div><h2></h2><form><div></div><div><label>Moneda</label><select required></select></div><div><label>Cantidad USD</label><input type=number step=0.01 min=0 placeholder=0.00 required></div><div><label>Referencia (Opcional)</label><input type=text placeholder="N√∫mero de referencia o descripci√≥n"></div><div><label>Notas (Opcional)</label><textarea placeholder="Notas adicionales sobre esta remesa"></textarea></div><div><button type=button>Cancelar</button><button type=submit>'),tn=h("<option>"),rn=h("<option> <!> - ");const Gt=r=>{const[s,$]=K(null),[t,d]=K(0),[p,l]=K("CUP"),[I,T]=K(395),[X,Z]=K(""),[V,O]=K(""),[ue,F]=K(!1),[k,P]=K(N.getBusinessId()),[M,Be]=K([]),ve=()=>!!r.remittance,w=()=>N.isAdmin();Yt(async()=>{if(w()){const L=await N.getAvailableBusinesses();Be(L)}}),lr(()=>{const L=r.remittance;L?($(L.customer),d(L.amount),l(L.currency),T(L.exchangeRate||1),Z(L.reference||""),O(L.notes||""),L.businessId&&P(L.businessId)):($(null),d(0),l("CUP"),T(395),Z(""),O(""),P(N.getBusinessId()))});const U=async L=>{if(L.preventDefault(),!s()){alert("Por favor seleccione un cliente");return}if(t()<=0){alert("Por favor ingrese una cantidad v√°lida");return}F(!0);try{if(ve()){const de={id:r.remittance.id,customer:s(),amount:t(),currency:p(),exchangeRate:I(),reference:X(),notes:V(),...w()&&{businessId:k()}};await Rt.update(de),alert("Remesa actualizada exitosamente")}else{const de={customer:s(),amount:t(),currency:p(),exchangeRate:I(),reference:X(),notes:V(),...w()&&{businessId:k()}},ye=await Rt.create(de),me={...ye,date:new Date,remittanceNumber:ye.remittanceNumber};Ir(me),alert("¬°Remesa creada exitosamente! Se ha descargado el recibo PDF.")}r.onSubmit?.(ve()),ve()||($(null),d(0),l("USD"),T(1),Z(""),O(""))}catch(de){console.error("Error submitting remittance:",de);const ye=ve()?"Error al actualizar la remesa. Por favor intente de nuevo.":"Error al crear la remesa. Por favor intente de nuevo.";alert(ye)}finally{F(!1)}},oe=()=>{if(!s()||t()<=0){alert("Por favor complete cliente y cantidad para ver la vista previa");return}const L={customer:s(),amount:t(),currency:p(),exchangeRate:I(),reference:X(),notes:V(),date:new Date,remittanceNumber:ve()?r.remittance.remittanceNumber:Kt()};Xt(L)},G=()=>{ve()||($(null),d(0),l("CUP"),T(395),Z(""),O("")),r.onCancel?.()},Pe=r.isModal?{"max-width":"600px",margin:"0 auto",padding:"0"}:{"max-width":"600px",margin:"0 auto",padding:"2rem","background-color":"white","border-radius":"8px","box-shadow":"0 4px 12px rgba(0,0,0,0.15)"},W={"font-size":"1.5rem","font-weight":"600","margin-bottom":"1.5rem","text-align":"center",color:"var(--text-primary)"},ee={"margin-bottom":"1.5rem"},De={display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.5rem"},Ue={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"4px","font-size":"1rem",background:"var(--surface-color)",color:"var(--text-primary)"},Xe={...Ue,cursor:"pointer"},x={...Ue,"min-height":"80px",resize:"vertical"},ne={padding:"0.75rem 1.5rem","background-color":"var(--primary-color)",color:"white",border:"none","border-radius":"4px",cursor:"pointer","font-weight":"500","margin-right":"0.5rem"},Se={...ne,"background-color":"var(--border-color)",color:"var(--text-secondary)"},_e={...ne,"background-color":"var(--secondary-color, #6b7280)",color:"white"},se={display:"flex","justify-content":"flex-end","margin-top":"2rem"},ke={"background-color":"var(--strip-color)",padding:"1rem","border-radius":"4px","margin-bottom":"1.5rem"},$e={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"};return(()=>{var L=en(),de=L.firstChild,ye=de.nextSibling,me=ye.firstChild,ge=me.nextSibling,Ve=ge.firstChild,Le=Ve.nextSibling,at=ge.nextSibling,ht=at.firstChild,st=ht.nextSibling,Te=at.nextSibling,bt=Te.firstChild,We=bt.nextSibling,Ze=Te.nextSibling,ft=Ze.firstChild,dt=ft.nextSibling,Oe=Ze.nextSibling,Ge=Oe.firstChild,et=Ge.nextSibling;return o(de,()=>ve()?"Editar Remesa":"Crear Remesa"),ye.addEventListener("submit",U),o(me,v(ar,{get value(){return s()},onChange:$,label:"Seleccionar Cliente",placeholder:"Buscar clientes por nombre, tel√©fono, c√©dula...",required:!0})),o(ye,v(f,{get when(){return lt(()=>!!w())()&&M().length>0},get children(){var a=Hr(),R=a.firstChild,q=R.nextSibling;return q.addEventListener("change",C=>P(C.target.value)),o(q,v(Je,{get each(){return M()},children:C=>(()=>{var le=tn();return o(le,()=>C.name),c(()=>le.value=C.id),le})()})),c(C=>{var le=ee,Ee=De,we=Xe;return C.e=e(a,le,C.e),C.t=e(R,Ee,C.t),C.a=e(q,we,C.a),C},{e:void 0,t:void 0,a:void 0}),c(()=>q.value=k()),a}}),ge),Le.addEventListener("change",a=>l(a.target.value)),o(Le,v(Je,{each:pt,children:a=>(()=>{var R=rn(),q=R.firstChild,C=q.nextSibling;return C.nextSibling,o(R,()=>a.symbol,q),o(R,()=>a.code,C),o(R,()=>a.name,null),c(()=>R.value=a.code),R})()})),st.$$input=a=>d(parseFloat(a.target.value)||0),o(ye,v(f,{get when(){return p()!=="USD"},get children(){var a=Kr(),R=a.firstChild,q=R.nextSibling;return q.$$input=C=>T(parseFloat(C.target.value)||1),c(C=>{var le=ee,Ee=De,we=Ue;return C.e=e(a,le,C.e),C.t=e(R,Ee,C.t),C.a=e(q,we,C.a),C},{e:void 0,t:void 0,a:void 0}),c(()=>q.value=I()),a}}),Te),We.$$input=a=>Z(a.target.value),dt.$$input=a=>O(a.target.value),o(ye,v(f,{get when(){return lt(()=>!!s())()&&t()>0},get children(){var a=Xr(),R=a.firstChild,q=R.nextSibling,C=q.firstChild,le=C.nextSibling,Ee=q.nextSibling,we=Ee.firstChild,He=we.nextSibling,Ke=He.firstChild;return e(a,ke),R.style.setProperty("margin-bottom","0.75rem"),R.style.setProperty("font-weight","600"),o(le,()=>s()?.fullName||s()?.name),o(He,()=>pt.find(A=>A.code===p())?.symbol,Ke),o(He,()=>t().toFixed(2),Ke),o(a,v(f,{get when(){return lt(()=>p()!=="USD")()&&I()!==1},get children(){var A=Yr(),pe=A.firstChild,ce=pe.nextSibling,Ne=ce.firstChild,tt=Ne.nextSibling;return tt.nextSibling,o(ce,()=>(t()*I()).toFixed(2),tt),o(ce,p,null),c(Me=>e(A,$e,Me)),A}}),null),o(a,v(f,{get when(){return s()?.cid},get children(){var A=Qr(),pe=A.firstChild,ce=pe.nextSibling;return o(ce,()=>s()?.cid),c(Ne=>e(A,$e,Ne)),A}}),null),o(a,v(f,{get when(){return s()?.phoneNumber},get children(){var A=Jr(),pe=A.firstChild,ce=pe.nextSibling;return o(ce,()=>s()?.phoneNumber),c(Ne=>e(A,$e,Ne)),A}}),null),c(A=>{var pe=$e,ce=$e;return A.e=e(q,pe,A.e),A.t=e(Ee,ce,A.t),A},{e:void 0,t:void 0}),a}}),Oe),e(Oe,se),Ge.$$click=G,o(Oe,v(f,{get when(){return!ve()},get children(){var a=Zr();return a.$$click=oe,c(R=>{var q=_e,C=ue()||!s()||t()<=0;return R.e=e(a,q,R.e),C!==R.t&&(a.disabled=R.t=C),R},{e:void 0,t:void 0}),a}}),et),o(et,(()=>{var a=lt(()=>!!ue());return()=>a()?ve()?"Actualizando...":"Creando...":ve()?"Actualizar Remesa":"Crear Remesa"})()),c(a=>{var R=Pe,q=W,C=ee,le=ee,Ee=De,we=Xe,He=ee,Ke=De,A=Ue,pe=ee,ce=De,Ne=Ue,tt=ee,Me=De,rt=x,ct=Se,yt=ue(),xt=ne,ut=ue()||!s()||t()<=0;return a.e=e(L,R,a.e),a.t=e(de,q,a.t),a.a=e(me,C,a.a),a.o=e(ge,le,a.o),a.i=e(Ve,Ee,a.i),a.n=e(Le,we,a.n),a.s=e(at,He,a.s),a.h=e(ht,Ke,a.h),a.r=e(st,A,a.r),a.d=e(Te,pe,a.d),a.l=e(bt,ce,a.l),a.u=e(We,Ne,a.u),a.c=e(Ze,tt,a.c),a.w=e(ft,Me,a.w),a.m=e(dt,rt,a.m),a.f=e(Ge,ct,a.f),yt!==a.y&&(Ge.disabled=a.y=yt),a.g=e(et,xt,a.g),ut!==a.p&&(et.disabled=a.p=ut),a},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0}),c(()=>Le.value=p()),c(()=>st.value=t()),c(()=>We.value=X()),c(()=>dt.value=V()),L})()};Ut(["input","click"]);var nn=h("<div><span>Remesas"),Ht=h("<div><div>"),on=h("<div>");const ln=()=>{const[r,s]=K("list"),[$,t]=K(null),[d,p]=K(0),l=()=>{s("list"),t(null),p(w=>w+1)},I=()=>{s("create"),t(null)},T=w=>{t(w),s("edit")},X=w=>{t(w),s("view")},Z=()=>{l()},V=()=>{l()},O=()=>{l()},ue=w=>{},F=w=>{T(w)},k={"min-height":"100vh","background-color":"var(--background-color)"},P={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},M={"background-color":"white","border-radius":"8px","max-width":"800px",width:"90%","max-height":"90%",overflow:"auto","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1)",padding:"2rem"},Be={padding:"1rem 2rem","background-color":"white","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem",color:"var(--text-muted)"},ve={color:"var(--primary-color)","text-decoration":"none",cursor:"pointer"};return(()=>{var w=on();return e(w,k),o(w,v(f,{get when(){return r()!=="list"},get children(){var U=nn(),oe=U.firstChild;return e(U,Be),oe.$$click=l,e(oe,ve),o(U,v(f,{get when(){return r()==="create"},children:" > Nueva Remesa"}),null),o(U,v(f,{get when(){return r()==="edit"},get children(){return" > Editar > "+($()?.remittanceNumber||"")}}),null),o(U,v(f,{get when(){return r()==="view"},get children(){return" > Ver > "+($()?.remittanceNumber||"")}}),null),U}}),null),o(w,v(f,{get when(){return r()==="list"},get children(){return v(Ar,{get key(){return d()},onCreate:I,onEdit:T,onView:X,onDelete:ue})}}),null),o(w,v(f,{get when(){return lt(()=>!!N.isAdmin())()&&r()==="create"},get children(){var U=Ht(),oe=U.firstChild;return U.$$click=O,oe.$$click=G=>G.stopPropagation(),o(oe,v(Gt,{remittance:null,onSubmit:Z,onCancel:O,isModal:!0})),c(G=>{var Pe=P,W=M;return G.e=e(U,Pe,G.e),G.t=e(oe,W,G.t),G},{e:void 0,t:void 0}),U}}),null),o(w,v(f,{get when(){return lt(()=>!!N.isAdmin())()&&r()==="edit"},get children(){var U=Ht(),oe=U.firstChild;return U.$$click=O,oe.$$click=G=>G.stopPropagation(),o(oe,v(Gt,{get remittance(){return $()},onSubmit:V,onCancel:O,isModal:!0})),c(G=>{var Pe=P,W=M;return G.e=e(U,Pe,G.e),G.t=e(oe,W,G.t),G},{e:void 0,t:void 0}),U}}),null),o(w,v(f,{get when(){return lt(()=>r()==="view")()&&$()},get children(){return v(Gr,{get remittanceId(){return $().id},get remittance(){return $()},onEdit:F,onClose:O})}}),null),w})()};Ut(["click"]);const sn=()=>v(ln,{});export{sn as default};
