(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const HP=!1,GP=(t,e)=>t===e,Yo=Symbol("solid-proxy"),l1=typeof Proxy=="function",ef=Symbol("solid-track"),Eh={equals:GP};let c1=y1;const ea=1,Ih=2,d1={owned:null,cleanups:null,context:null,owner:null},Kp={};var un=null;let Jp=null,WP=null,_n=null,Vi=null,Hs=null,op=0;function Sd(t,e){const r=_n,n=un,i=t.length===0,o=e===void 0?n:e,s=i?d1:{owned:null,cleanups:null,context:o?o.context:null,owner:o},l=i?t:()=>t(()=>Ji(()=>Md(s)));un=s,_n=null;try{return _s(l,!0)}finally{_n=r,un=n}}function we(t,e){e=e?Object.assign({},Eh,e):Eh;const r={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},n=i=>(typeof i=="function"&&(i=i(r.value)),f1(r,i));return[m1.bind(r),n]}function YP(t,e,r){const n=sp(t,e,!0,ea);Dc(n)}function fe(t,e,r){const n=sp(t,e,!1,ea);Dc(n)}function xi(t,e,r){c1=tS;const n=sp(t,e,!1,ea);n.user=!0,Hs?Hs.push(n):Dc(n)}function Ut(t,e,r){r=r?Object.assign({},Eh,r):Eh;const n=sp(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,Dc(n),m1.bind(n)}function KP(t){return t&&typeof t=="object"&&"then"in t}function JP(t,e,r){let n,i,o;typeof e=="function"?(n=t,i=e,o={}):(n=!0,i=t,o=e||{});let s=null,l=Kp,c=!1,d="initialValue"in o,u=typeof n=="function"&&Ut(n);const y=new Set,[g,f]=(o.storage||we)(o.initialValue),[w,E]=we(void 0),[x,T]=we(void 0,{equals:!1}),[Y,K]=we(d?"ready":"unresolved");function j($,D,b,S){return s===$&&(s=null,S!==void 0&&(d=!0),($===l||D===l)&&o.onHydrated&&queueMicrotask(()=>o.onHydrated(S,{value:D})),l=Kp,q(D,b)),D}function q($,D){_s(()=>{D===void 0&&f(()=>$),K(D!==void 0?"errored":d?"ready":"unresolved"),E(D);for(const b of y.keys())b.decrement();y.clear()},!1)}function J(){const $=XP,D=g(),b=w();if(b!==void 0&&!s)throw b;return _n&&_n.user,D}function C($=!0){if($!==!1&&c)return;c=!1;const D=u?u():n;if(D==null||D===!1){j(s,Ji(g));return}let b;const S=l!==Kp?l:Ji(()=>{try{return i(D,{value:g(),refetching:$})}catch(v){b=v}});if(b!==void 0){j(s,void 0,hh(b),D);return}else if(!KP(S))return j(s,S,void 0,D),S;return s=S,"v"in S?(S.s===1?j(s,S.v,void 0,D):j(s,void 0,hh(S.v),D),S):(c=!0,queueMicrotask(()=>c=!1),_s(()=>{K(d?"refreshing":"pending"),T()},!1),S.then(v=>j(S,v,void 0,D),v=>j(S,void 0,hh(v),D)))}Object.defineProperties(J,{state:{get:()=>Y()},error:{get:()=>w()},loading:{get(){const $=Y();return $==="pending"||$==="refreshing"}},latest:{get(){if(!d)return J();const $=w();if($&&!s)throw $;return g()}}});let P=un;return u?YP(()=>(P=un,C(!1))):C(!1),[J,{refetch:$=>ey(P,()=>C($)),mutate:f}]}function u1(t){return _s(t,!1)}function Ji(t){if(_n===null)return t();const e=_n;_n=null;try{return t()}finally{_n=e}}function Zf(t,e,r){const n=Array.isArray(t);let i,o=r&&r.defer;return s=>{let l;if(n){l=Array(t.length);for(let d=0;d<t.length;d++)l[d]=t[d]()}else l=t();if(o)return o=!1,s;const c=Ji(()=>e(l,i,s));return i=l,c}}function jn(t){xi(()=>Ji(t))}function Rc(t){return un===null||(un.cleanups===null?un.cleanups=[t]:un.cleanups.push(t)),t}function tf(){return _n}function h1(){return un}function ey(t,e){const r=un,n=_n;un=t,_n=null;try{return _s(e,!0)}catch(i){ny(i)}finally{un=r,_n=n}}function QP(t){const e=_n,r=un;return Promise.resolve().then(()=>{_n=e,un=r;let n;return _s(t,!1),_n=un=null,n?n.done:void 0})}const[A9,$9]=we(!1);function p1(t,e){const r=Symbol("context");return{id:r,Provider:rS(r),defaultValue:t}}function ty(t){let e;return un&&un.context&&(e=un.context[t.id])!==void 0?e:t.defaultValue}function ry(t){const e=Ut(t),r=Ut(()=>rf(e()));return r.toArray=()=>{const n=r();return Array.isArray(n)?n:n!=null?[n]:[]},r}let XP;function m1(){if(this.sources&&this.state)if(this.state===ea)Dc(this);else{const t=Vi;Vi=null,_s(()=>kh(this),!1),Vi=t}if(_n){const t=this.observers?this.observers.length:0;_n.sources?(_n.sources.push(this),_n.sourceSlots.push(t)):(_n.sources=[this],_n.sourceSlots=[t]),this.observers?(this.observers.push(_n),this.observerSlots.push(_n.sources.length-1)):(this.observers=[_n],this.observerSlots=[_n.sources.length-1])}return this.value}function f1(t,e,r){let n=t.value;return(!t.comparator||!t.comparator(n,e))&&(t.value=e,t.observers&&t.observers.length&&_s(()=>{for(let i=0;i<t.observers.length;i+=1){const o=t.observers[i],s=Jp&&Jp.running;s&&Jp.disposed.has(o),(s?!o.tState:!o.state)&&(o.pure?Vi.push(o):Hs.push(o),o.observers&&g1(o)),s||(o.state=ea)}if(Vi.length>1e6)throw Vi=[],new Error},!1)),e}function Dc(t){if(!t.fn)return;Md(t);const e=op;ZP(t,t.value,e)}function ZP(t,e,r){let n;const i=un,o=_n;_n=un=t;try{n=t.fn(e)}catch(s){return t.pure&&(t.state=ea,t.owned&&t.owned.forEach(Md),t.owned=null),t.updatedAt=r+1,ny(s)}finally{_n=o,un=i}(!t.updatedAt||t.updatedAt<=r)&&(t.updatedAt!=null&&"observers"in t?f1(t,n):t.value=n,t.updatedAt=r)}function sp(t,e,r,n=ea,i){const o={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:un,context:un?un.context:null,pure:r};return un===null||un!==d1&&(un.owned?un.owned.push(o):un.owned=[o]),o}function Th(t){if(t.state===0)return;if(t.state===Ih)return kh(t);if(t.suspense&&Ji(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<op);)t.state&&e.push(t);for(let r=e.length-1;r>=0;r--)if(t=e[r],t.state===ea)Dc(t);else if(t.state===Ih){const n=Vi;Vi=null,_s(()=>kh(t,e[0]),!1),Vi=n}}function _s(t,e){if(Vi)return t();let r=!1;e||(Vi=[]),Hs?r=!0:Hs=[],op++;try{const n=t();return eS(r),n}catch(n){r||(Hs=null),Vi=null,ny(n)}}function eS(t){if(Vi&&(y1(Vi),Vi=null),t)return;const e=Hs;Hs=null,e.length&&_s(()=>c1(e),!1)}function y1(t){for(let e=0;e<t.length;e++)Th(t[e])}function tS(t){let e,r=0;for(e=0;e<t.length;e++){const n=t[e];n.user?t[r++]=n:Th(n)}for(e=0;e<r;e++)Th(t[e])}function kh(t,e){t.state=0;for(let r=0;r<t.sources.length;r+=1){const n=t.sources[r];if(n.sources){const i=n.state;i===ea?n!==e&&(!n.updatedAt||n.updatedAt<op)&&Th(n):i===Ih&&kh(n,e)}}}function g1(t){for(let e=0;e<t.observers.length;e+=1){const r=t.observers[e];r.state||(r.state=Ih,r.pure?Vi.push(r):Hs.push(r),r.observers&&g1(r))}}function Md(t){let e;if(t.sources)for(;t.sources.length;){const r=t.sources.pop(),n=t.sourceSlots.pop(),i=r.observers;if(i&&i.length){const o=i.pop(),s=r.observerSlots.pop();n<i.length&&(o.sourceSlots[s]=n,i[n]=o,r.observerSlots[n]=s)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)Md(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)Md(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function hh(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function ny(t,e=un){throw hh(t)}function rf(t){if(typeof t=="function"&&!t.length)return rf(t());if(Array.isArray(t)){const e=[];for(let r=0;r<t.length;r++){const n=rf(t[r]);Array.isArray(n)?e.push.apply(e,n):e.push(n)}return e}return t}function rS(t,e){return function(n){let i;return fe(()=>i=Ji(()=>(un.context={...un.context,[t]:n.value},ry(()=>n.children))),void 0),i}}const nS=Symbol("fallback");function Vg(t){for(let e=0;e<t.length;e++)t[e]()}function iS(t,e,r={}){let n=[],i=[],o=[],s=0,l=e.length>1?[]:null;return Rc(()=>Vg(o)),()=>{let c=t()||[],d=c.length,u,y;return c[ef],Ji(()=>{let f,w,E,x,T,Y,K,j,q;if(d===0)s!==0&&(Vg(o),o=[],n=[],i=[],s=0,l&&(l=[])),r.fallback&&(n=[nS],i[0]=Sd(J=>(o[0]=J,r.fallback())),s=1);else if(s===0){for(i=new Array(d),y=0;y<d;y++)n[y]=c[y],i[y]=Sd(g);s=d}else{for(E=new Array(d),x=new Array(d),l&&(T=new Array(d)),Y=0,K=Math.min(s,d);Y<K&&n[Y]===c[Y];Y++);for(K=s-1,j=d-1;K>=Y&&j>=Y&&n[K]===c[j];K--,j--)E[j]=i[K],x[j]=o[K],l&&(T[j]=l[K]);for(f=new Map,w=new Array(j+1),y=j;y>=Y;y--)q=c[y],u=f.get(q),w[y]=u===void 0?-1:u,f.set(q,y);for(u=Y;u<=K;u++)q=n[u],y=f.get(q),y!==void 0&&y!==-1?(E[y]=i[u],x[y]=o[u],l&&(T[y]=l[u]),y=w[y],f.set(q,y)):o[u]();for(y=Y;y<d;y++)y in E?(i[y]=E[y],o[y]=x[y],l&&(l[y]=T[y],l[y](y))):i[y]=Sd(g);i=i.slice(0,s=d),n=c.slice(0)}return i});function g(f){if(o[y]=f,l){const[w,E]=we(y);return l[y]=E,e(c[y],w)}return e(c[y])}}}function I(t,e){return Ji(()=>t(e||{}))}function Fu(){return!0}const nf={get(t,e,r){return e===Yo?r:t.get(e)},has(t,e){return e===Yo?!0:t.has(e)},set:Fu,deleteProperty:Fu,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:Fu,deleteProperty:Fu}},ownKeys(t){return t.keys()}};function Qp(t){return(t=typeof t=="function"?t():t)?t:{}}function oS(){for(let t=0,e=this.length;t<e;++t){const r=this[t]();if(r!==void 0)return r}}function of(...t){let e=!1;for(let s=0;s<t.length;s++){const l=t[s];e=e||!!l&&Yo in l,t[s]=typeof l=="function"?(e=!0,Ut(l)):l}if(l1&&e)return new Proxy({get(s){for(let l=t.length-1;l>=0;l--){const c=Qp(t[l])[s];if(c!==void 0)return c}},has(s){for(let l=t.length-1;l>=0;l--)if(s in Qp(t[l]))return!0;return!1},keys(){const s=[];for(let l=0;l<t.length;l++)s.push(...Object.keys(Qp(t[l])));return[...new Set(s)]}},nf);const r={},n=Object.create(null);for(let s=t.length-1;s>=0;s--){const l=t[s];if(!l)continue;const c=Object.getOwnPropertyNames(l);for(let d=c.length-1;d>=0;d--){const u=c[d];if(u==="__proto__"||u==="constructor")continue;const y=Object.getOwnPropertyDescriptor(l,u);if(!n[u])n[u]=y.get?{enumerable:!0,configurable:!0,get:oS.bind(r[u]=[y.get.bind(l)])}:y.value!==void 0?y:void 0;else{const g=r[u];g&&(y.get?g.push(y.get.bind(l)):y.value!==void 0&&g.push(()=>y.value))}}}const i={},o=Object.keys(n);for(let s=o.length-1;s>=0;s--){const l=o[s],c=n[l];c&&c.get?Object.defineProperty(i,l,c):i[l]=c?c.value:void 0}return i}function sS(t,...e){if(l1&&Yo in t){const i=new Set(e.length>1?e.flat():e[0]),o=e.map(s=>new Proxy({get(l){return s.includes(l)?t[l]:void 0},has(l){return s.includes(l)&&l in t},keys(){return s.filter(l=>l in t)}},nf));return o.push(new Proxy({get(s){return i.has(s)?void 0:t[s]},has(s){return i.has(s)?!1:s in t},keys(){return Object.keys(t).filter(s=>!i.has(s))}},nf)),o}const r={},n=e.map(()=>({}));for(const i of Object.getOwnPropertyNames(t)){const o=Object.getOwnPropertyDescriptor(t,i),s=!o.get&&!o.set&&o.enumerable&&o.writable&&o.configurable;let l=!1,c=0;for(const d of e)d.includes(i)&&(l=!0,s?n[c][i]=o.value:Object.defineProperty(n[c],i,o)),++c;l||(s?r[i]=o.value:Object.defineProperty(r,i,o))}return[...n,r]}const aS=t=>`Stale read from <${t}>.`;function Ct(t){const e="fallback"in t&&{fallback:()=>t.fallback};return Ut(iS(()=>t.each,t.children,e||void 0))}function Oe(t){const e=t.keyed,r=Ut(()=>t.when,void 0,void 0),n=e?r:Ut(r,void 0,{equals:(i,o)=>!i==!o});return Ut(()=>{const i=n();if(i){const o=t.children;return typeof o=="function"&&o.length>0?Ji(()=>o(e?i:()=>{if(!Ji(n))throw aS("Show");return r()})):o}return t.fallback},void 0,void 0)}const lS=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],cS=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline",...lS]),dS=new Set(["innerHTML","textContent","innerText","children"]),uS=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),hS=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function pS(t,e){const r=hS[t];return typeof r=="object"?r[e]?r.$:void 0:r}const mS=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),Te=t=>Ut(()=>t());function fS(t,e,r){let n=r.length,i=e.length,o=n,s=0,l=0,c=e[i-1].nextSibling,d=null;for(;s<i||l<o;){if(e[s]===r[l]){s++,l++;continue}for(;e[i-1]===r[o-1];)i--,o--;if(i===s){const u=o<n?l?r[l-1].nextSibling:r[o-l]:c;for(;l<o;)t.insertBefore(r[l++],u)}else if(o===l)for(;s<i;)(!d||!d.has(e[s]))&&e[s].remove(),s++;else if(e[s]===r[o-1]&&r[l]===e[i-1]){const u=e[--i].nextSibling;t.insertBefore(r[l++],e[s++].nextSibling),t.insertBefore(r[--o],u),e[i]=r[o]}else{if(!d){d=new Map;let y=l;for(;y<o;)d.set(r[y],y++)}const u=d.get(e[s]);if(u!=null)if(l<u&&u<o){let y=s,g=1,f;for(;++y<i&&y<o&&!((f=d.get(e[y]))==null||f!==u+g);)g++;if(g>u-l){const w=e[s];for(;l<u;)t.insertBefore(r[l++],w)}else t.replaceChild(r[l++],e[s++])}else s++;else e[s++].remove()}}}const qg="_$DX_DELEGATE";function yS(t,e,r,n={}){let i;return Sd(o=>{i=o,e===document?t():a(e,t(),e.firstChild?null:void 0,r)},n.owner),()=>{i(),e.textContent=""}}function ae(t,e,r,n){let i;const o=()=>{const l=n?document.createElementNS("http://www.w3.org/1998/Math/MathML","template"):document.createElement("template");return l.innerHTML=t,r?l.content.firstChild.firstChild:n?l.firstChild:l.content.firstChild},s=e?()=>Ji(()=>document.importNode(i||(i=o()),!0)):()=>(i||(i=o())).cloneNode(!0);return s.cloneNode=s,s}function br(t,e=window.document){const r=e[qg]||(e[qg]=new Set);for(let n=0,i=t.length;n<i;n++){const o=t[n];r.has(o)||(r.add(o),e.addEventListener(o,wS))}}function ir(t,e,r){r==null?t.removeAttribute(e):t.setAttribute(e,r)}function gS(t,e,r){r?t.setAttribute(e,""):t.removeAttribute(e)}function iy(t,e){e==null?t.removeAttribute("class"):t.className=e}function Xn(t,e,r,n){if(n)Array.isArray(r)?(t[`$$${e}`]=r[0],t[`$$${e}Data`]=r[1]):t[`$$${e}`]=r;else if(Array.isArray(r)){const i=r[0];t.addEventListener(e,r[0]=o=>i.call(t,r[1],o))}else t.addEventListener(e,r,typeof r!="function"&&r)}function vS(t,e,r={}){const n=Object.keys(e||{}),i=Object.keys(r);let o,s;for(o=0,s=i.length;o<s;o++){const l=i[o];!l||l==="undefined"||e[l]||(zg(t,l,!1),delete r[l])}for(o=0,s=n.length;o<s;o++){const l=n[o],c=!!e[l];!l||l==="undefined"||r[l]===c||!c||(zg(t,l,!0),r[l]=c)}return r}function p(t,e,r){if(!e)return r?ir(t,"style"):e;const n=t.style;if(typeof e=="string")return n.cssText=e;typeof r=="string"&&(n.cssText=r=void 0),r||(r={}),e||(e={});let i,o;for(o in r)e[o]==null&&n.removeProperty(o),delete r[o];for(o in e)i=e[o],i!==r[o]&&(n.setProperty(o,i),r[o]=i);return r}function bS(t,e={},r,n){const i={};return fe(()=>i.children=Fd(t,e.children,i.children)),fe(()=>typeof e.ref=="function"&&_S(e.ref,t)),fe(()=>PS(t,e,r,!0,i,!0)),i}function _S(t,e,r){return Ji(()=>t(e,r))}function a(t,e,r,n){if(r!==void 0&&!n&&(n=[]),typeof e!="function")return Fd(t,e,n,r);fe(i=>Fd(t,e(),i,r),n)}function PS(t,e,r,n,i={},o=!1){e||(e={});for(const s in i)if(!(s in e)){if(s==="children")continue;i[s]=Ug(t,s,null,i[s],r,o,e)}for(const s in e){if(s==="children")continue;const l=e[s];i[s]=Ug(t,s,l,i[s],r,o,e)}}function SS(t){return t.toLowerCase().replace(/-([a-z])/g,(e,r)=>r.toUpperCase())}function zg(t,e,r){const n=e.trim().split(/\s+/);for(let i=0,o=n.length;i<o;i++)t.classList.toggle(n[i],r)}function Ug(t,e,r,n,i,o,s){let l,c,d,u,y;if(e==="style")return p(t,r,n);if(e==="classList")return vS(t,r,n);if(r===n)return n;if(e==="ref")o||r(t);else if(e.slice(0,3)==="on:"){const g=e.slice(3);n&&t.removeEventListener(g,n,typeof n!="function"&&n),r&&t.addEventListener(g,r,typeof r!="function"&&r)}else if(e.slice(0,10)==="oncapture:"){const g=e.slice(10);n&&t.removeEventListener(g,n,!0),r&&t.addEventListener(g,r,!0)}else if(e.slice(0,2)==="on"){const g=e.slice(2).toLowerCase(),f=mS.has(g);if(!f&&n){const w=Array.isArray(n)?n[0]:n;t.removeEventListener(g,w)}(f||r)&&(Xn(t,g,r,f),f&&br([g]))}else e.slice(0,5)==="attr:"?ir(t,e.slice(5),r):e.slice(0,5)==="bool:"?gS(t,e.slice(5),r):(y=e.slice(0,5)==="prop:")||(d=dS.has(e))||(u=pS(e,t.tagName))||(c=cS.has(e))||(l=t.nodeName.includes("-")||"is"in s)?(y&&(e=e.slice(5),c=!0),e==="class"||e==="className"?iy(t,r):l&&!c&&!d?t[SS(e)]=r:t[u||e]=r):ir(t,uS[e]||e,r);return r}function wS(t){let e=t.target;const r=`$$${t.type}`,n=t.target,i=t.currentTarget,o=c=>Object.defineProperty(t,"target",{configurable:!0,value:c}),s=()=>{const c=e[r];if(c&&!e.disabled){const d=e[`${r}Data`];if(d!==void 0?c.call(e,d,t):c.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&o(e.host),!0},l=()=>{for(;s()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const c=t.composedPath();o(c[0]);for(let d=0;d<c.length-2&&(e=c[d],!!s());d++){if(e._$host){e=e._$host,l();break}if(e.parentNode===i)break}}else l();o(n)}function Fd(t,e,r,n,i){for(;typeof r=="function";)r=r();if(e===r)return r;const o=typeof e,s=n!==void 0;if(t=s&&r[0]&&r[0].parentNode||t,o==="string"||o==="number"){if(o==="number"&&(e=e.toString(),e===r))return r;if(s){let l=r[0];l&&l.nodeType===3?l.data!==e&&(l.data=e):l=document.createTextNode(e),r=ic(t,r,n,l)}else r!==""&&typeof r=="string"?r=t.firstChild.data=e:r=t.textContent=e}else if(e==null||o==="boolean")r=ic(t,r,n);else{if(o==="function")return fe(()=>{let l=e();for(;typeof l=="function";)l=l();r=Fd(t,l,r,n)}),()=>r;if(Array.isArray(e)){const l=[],c=r&&Array.isArray(r);if(sf(l,e,r,i))return fe(()=>r=Fd(t,l,r,n,!0)),()=>r;if(l.length===0){if(r=ic(t,r,n),s)return r}else c?r.length===0?Hg(t,l,n):fS(t,r,l):(r&&ic(t),Hg(t,l));r=l}else if(e.nodeType){if(Array.isArray(r)){if(s)return r=ic(t,r,n,e);ic(t,r,null,e)}else r==null||r===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);r=e}}return r}function sf(t,e,r,n){let i=!1;for(let o=0,s=e.length;o<s;o++){let l=e[o],c=r&&r[t.length],d;if(!(l==null||l===!0||l===!1))if((d=typeof l)=="object"&&l.nodeType)t.push(l);else if(Array.isArray(l))i=sf(t,l,c)||i;else if(d==="function")if(n){for(;typeof l=="function";)l=l();i=sf(t,Array.isArray(l)?l:[l],Array.isArray(c)?c:[c])||i}else t.push(l),i=!0;else{const u=String(l);c&&c.nodeType===3&&c.data===u?t.push(c):t.push(document.createTextNode(u))}}return i}function Hg(t,e,r=null){for(let n=0,i=e.length;n<i;n++)t.insertBefore(e[n],r)}function ic(t,e,r,n){if(r===void 0)return t.textContent="";const i=n||document.createTextNode("");if(e.length){let o=!1;for(let s=e.length-1;s>=0;s--){const l=e[s];if(i!==l){const c=l.parentNode===t;!o&&!s?c?t.replaceChild(i,l):t.insertBefore(i,r):c&&l.remove()}else o=!0}}else t.insertBefore(i,r);return[i]}const xS=!1;function v1(){let t=new Set;function e(i){return t.add(i),()=>t.delete(i)}let r=!1;function n(i,o){if(r)return!(r=!1);const s={to:i,options:o,defaultPrevented:!1,preventDefault:()=>s.defaultPrevented=!0};for(const l of t)l.listener({...s,from:l.location,retry:c=>{c&&(r=!0),l.navigate(i,{...o,resolve:!1})}});return!s.defaultPrevented}return{subscribe:e,confirm:n}}let af;function oy(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),af=window.history.state._depth}oy();function CS(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function AS(t,e){let r=!1;return()=>{const n=af;oy();const i=n==null?null:af-n;if(r){r=!1;return}i&&e(i)?(r=!0,window.history.go(-i)):t()}}const $S=/^(?:[a-z0-9]+:)?\/\//i,ES=/^\/+|(\/)\/+$/g,b1="http://sr";function Cl(t,e=!1){const r=t.replace(ES,"$1");return r?e||/^[?#]/.test(r)?r:"/"+r:""}function ph(t,e,r){if($S.test(e))return;const n=Cl(t),i=r&&Cl(r);let o="";return!i||e.startsWith("/")?o=n:i.toLowerCase().indexOf(n.toLowerCase())!==0?o=n+i:o=i,(o||"/")+Cl(e,!o)}function IS(t,e){if(t==null)throw new Error(e);return t}function TS(t,e){return Cl(t).replace(/\/*(\*.*)?$/g,"")+Cl(e)}function _1(t){const e={};return t.searchParams.forEach((r,n)=>{n in e?Array.isArray(e[n])?e[n].push(r):e[n]=[e[n],r]:e[n]=r}),e}function kS(t,e,r){const[n,i]=t.split("/*",2),o=n.split("/").filter(Boolean),s=o.length;return l=>{const c=l.split("/").filter(Boolean),d=c.length-s;if(d<0||d>0&&i===void 0&&!e)return null;const u={path:s?"":"/",params:{}},y=g=>r===void 0?void 0:r[g];for(let g=0;g<s;g++){const f=o[g],w=f[0]===":",E=w?c[g]:c[g].toLowerCase(),x=w?f.slice(1):f.toLowerCase();if(w&&Xp(E,y(x)))u.params[x]=E;else if(w||!Xp(E,x))return null;u.path+=`/${E}`}if(i){const g=d?c.slice(-d).join("/"):"";if(Xp(g,y(i)))u.params[i]=g;else return null}return u}}function Xp(t,e){const r=n=>n===t;return e===void 0?!0:typeof e=="string"?r(e):typeof e=="function"?e(t):Array.isArray(e)?e.some(r):e instanceof RegExp?e.test(t):!1}function NS(t){const[e,r]=t.pattern.split("/*",2),n=e.split("/").filter(Boolean);return n.reduce((i,o)=>i+(o.startsWith(":")?2:3),n.length-(r===void 0?0:1))}function P1(t){const e=new Map,r=h1();return new Proxy({},{get(n,i){return e.has(i)||ey(r,()=>e.set(i,Ut(()=>t()[i]))),e.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function S1(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let r=t.slice(0,e.index),n=t.slice(e.index+e[0].length);const i=[r,r+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(n);)i.push(r+=e[1]),n=n.slice(e[0].length);return S1(n).reduce((o,s)=>[...o,...i.map(l=>l+s)],[])}const LS=100,w1=p1(),sy=p1(),Xd=()=>IS(ty(w1),"<A> and 'use' router primitives can be only used inside a Route."),RS=()=>ty(sy)||Xd().base,DS=t=>{const e=RS();return Ut(()=>e.resolvePath(t()))},MS=t=>{const e=Xd();return Ut(()=>{const r=t();return r!==void 0?e.renderPath(r):r})},ay=()=>Xd().navigatorFactory(),FS=()=>Xd().location,OS=()=>Xd().params;function BS(t,e=""){const{component:r,preload:n,load:i,children:o,info:s}=t,l=!o||Array.isArray(o)&&!o.length,c={key:t,component:r,preload:n||i,info:s};return x1(t.path).reduce((d,u)=>{for(const y of S1(u)){const g=TS(e,y);let f=l?g:g.split("/*",1)[0];f=f.split("/").map(w=>w.startsWith(":")||w.startsWith("*")?w:encodeURIComponent(w)).join("/"),d.push({...c,originalPath:u,pattern:f,matcher:kS(f,!l,t.matchFilters)})}return d},[])}function jS(t,e=0){return{routes:t,score:NS(t[t.length-1])*1e4-e,matcher(r){const n=[];for(let i=t.length-1;i>=0;i--){const o=t[i],s=o.matcher(r);if(!s)return null;n.unshift({...s,route:o})}return n}}}function x1(t){return Array.isArray(t)?t:[t]}function C1(t,e="",r=[],n=[]){const i=x1(t);for(let o=0,s=i.length;o<s;o++){const l=i[o];if(l&&typeof l=="object"){l.hasOwnProperty("path")||(l.path="");const c=BS(l,e);for(const d of c){r.push(d);const u=Array.isArray(l.children)&&l.children.length===0;if(l.children&&!u)C1(l.children,d.pattern,r,n);else{const y=jS([...r],n.length);n.push(y)}r.pop()}}}return r.length?n:n.sort((o,s)=>s.score-o.score)}function Zp(t,e){for(let r=0,n=t.length;r<n;r++){const i=t[r].matcher(e);if(i)return i}return[]}function VS(t,e,r){const n=new URL(b1),i=Ut(u=>{const y=t();try{return new URL(y,n)}catch{return console.error(`Invalid path ${y}`),u}},n,{equals:(u,y)=>u.href===y.href}),o=Ut(()=>i().pathname),s=Ut(()=>i().search,!0),l=Ut(()=>i().hash),c=()=>"",d=Zf(s,()=>_1(i()));return{get pathname(){return o()},get search(){return s()},get hash(){return l()},get state(){return e()},get key(){return c()},query:r?r(d):P1(d)}}let yl;function qS(){return yl}function zS(t,e,r,n={}){const{signal:[i,o],utils:s={}}=t,l=s.parsePath||(z=>z),c=s.renderPath||(z=>z),d=s.beforeLeave||v1(),u=ph("",n.base||"");if(u===void 0)throw new Error(`${u} is not a valid base path`);u&&!i().value&&o({value:u,replace:!0,scroll:!1});const[y,g]=we(!1);let f;const w=(z,re)=>{re.value===E()&&re.state===T()||(f===void 0&&g(!0),yl=z,f=re,QP(()=>{f===re&&(x(f.value),Y(f.state),q[1](L=>L.filter(O=>O.pending)))}).finally(()=>{f===re&&u1(()=>{yl=void 0,z==="navigate"&&S(f),g(!1),f=void 0})}))},[E,x]=we(i().value),[T,Y]=we(i().state),K=VS(E,T,s.queryWrapper),j=[],q=we([]),J=Ut(()=>typeof n.transformUrl=="function"?Zp(e(),n.transformUrl(K.pathname)):Zp(e(),K.pathname)),C=()=>{const z=J(),re={};for(let L=0;L<z.length;L++)Object.assign(re,z[L].params);return re},P=s.paramsWrapper?s.paramsWrapper(C,e):P1(C),$={pattern:u,path:()=>u,outlet:()=>null,resolvePath(z){return ph(u,z)}};return fe(Zf(i,z=>w("native",z),{defer:!0})),{base:$,location:K,params:P,isRouting:y,renderPath:c,parsePath:l,navigatorFactory:b,matches:J,beforeLeave:d,preloadRoute:v,singleFlight:n.singleFlight===void 0?!0:n.singleFlight,submissions:q};function D(z,re,L){Ji(()=>{if(typeof re=="number"){re&&(s.go?s.go(re):console.warn("Router integration does not support relative routing"));return}const O=!re||re[0]==="?",{replace:ne,resolve:X,scroll:W,state:se}={replace:!1,resolve:!O,scroll:!0,...L},F=X?z.resolvePath(re):ph(O&&K.pathname||"",re);if(F===void 0)throw new Error(`Path '${re}' is not a routable path`);if(j.length>=LS)throw new Error("Too many redirects");const k=E();(F!==k||se!==T())&&(xS||d.confirm(F,L)&&(j.push({value:k,replace:ne,scroll:W,state:T()}),w("navigate",{value:F,state:se})))})}function b(z){return z=z||ty(sy)||$,(re,L)=>D(z,re,L)}function S(z){const re=j[0];re&&(o({...z,replace:re.replace,scroll:re.scroll}),j.length=0)}function v(z,re){const L=Zp(e(),z.pathname),O=yl;yl="preload";for(let ne in L){const{route:X,params:W}=L[ne];X.component&&X.component.preload&&X.component.preload();const{preload:se}=X;re&&se&&ey(r(),()=>se({params:W,location:{pathname:z.pathname,search:z.search,hash:z.hash,query:_1(z),state:null,key:""},intent:"preload"}))}yl=O}}function US(t,e,r,n){const{base:i,location:o,params:s}=t,{pattern:l,component:c,preload:d}=n().route,u=Ut(()=>n().path);c&&c.preload&&c.preload();const y=d?d({params:s,location:o,intent:yl||"initial"}):void 0;return{parent:e,pattern:l,path:u,outlet:()=>c?I(c,{params:s,location:o,data:y,get children(){return r()}}):r(),resolvePath(f){return ph(i.path(),f,u())}}}const HS=t=>e=>{const{base:r}=e,n=ry(()=>e.children),i=Ut(()=>C1(n(),e.base||""));let o;const s=zS(t,i,()=>o,{base:r,singleFlight:e.singleFlight,transformUrl:e.transformUrl});return t.create&&t.create(s),I(w1.Provider,{value:s,get children(){return I(GS,{routerState:s,get root(){return e.root},get preload(){return e.rootPreload||e.rootLoad},get children(){return[Te(()=>(o=h1())&&null),I(WS,{routerState:s,get branches(){return i()}})]}})}})};function GS(t){const e=t.routerState.location,r=t.routerState.params,n=Ut(()=>t.preload&&Ji(()=>{t.preload({params:r,location:e,intent:qS()||"initial"})}));return I(Oe,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:i=>I(i,{params:r,location:e,get data(){return n()},get children(){return t.children}})})}function WS(t){const e=[];let r;const n=Ut(Zf(t.routerState.matches,(i,o,s)=>{let l=o&&i.length===o.length;const c=[];for(let d=0,u=i.length;d<u;d++){const y=o&&o[d],g=i[d];s&&y&&g.route.key===y.route.key?c[d]=s[d]:(l=!1,e[d]&&e[d](),Sd(f=>{e[d]=f,c[d]=US(t.routerState,c[d-1]||t.routerState.base,Gg(()=>n()[d+1]),()=>t.routerState.matches()[d])}))}return e.splice(i.length).forEach(d=>d()),s&&l?s:(r=c[0],c)}));return Gg(()=>n()&&r)()}const Gg=t=>()=>I(Oe,{get when(){return t()},keyed:!0,children:e=>I(sy.Provider,{value:e,get children(){return e.outlet()}})}),to=t=>{const e=ry(()=>t.children);return of(t,{get children(){return e()}})};function YS([t,e],r,n){return[t,n?i=>e(n(i)):e]}function KS(t){let e=!1;const r=i=>typeof i=="string"?{value:i}:i,n=YS(we(r(t.get()),{equals:(i,o)=>i.value===o.value&&i.state===o.state}),void 0,i=>(!e&&t.set(i),i));return t.init&&Rc(t.init((i=t.get())=>{e=!0,n[1](r(i)),e=!1})),HS({signal:n,create:t.create,utils:t.utils})}function JS(t,e,r){return t.addEventListener(e,r),()=>t.removeEventListener(e,r)}function QS(t,e){const r=t&&document.getElementById(t);r?r.scrollIntoView():e&&window.scrollTo(0,0)}const XS=new Map;function ZS(t=!0,e=!1,r="/_server",n){return i=>{const o=i.base.path(),s=i.navigatorFactory(i.base);let l,c;function d(E){return E.namespaceURI==="http://www.w3.org/2000/svg"}function u(E){if(E.defaultPrevented||E.button!==0||E.metaKey||E.altKey||E.ctrlKey||E.shiftKey)return;const x=E.composedPath().find(J=>J instanceof Node&&J.nodeName.toUpperCase()==="A");if(!x||e&&!x.hasAttribute("link"))return;const T=d(x),Y=T?x.href.baseVal:x.href;if((T?x.target.baseVal:x.target)||!Y&&!x.hasAttribute("state"))return;const j=(x.getAttribute("rel")||"").split(/\s+/);if(x.hasAttribute("download")||j&&j.includes("external"))return;const q=T?new URL(Y,document.baseURI):new URL(Y);if(!(q.origin!==window.location.origin||o&&q.pathname&&!q.pathname.toLowerCase().startsWith(o.toLowerCase())))return[x,q]}function y(E){const x=u(E);if(!x)return;const[T,Y]=x,K=i.parsePath(Y.pathname+Y.search+Y.hash),j=T.getAttribute("state");E.preventDefault(),s(K,{resolve:!1,replace:T.hasAttribute("replace"),scroll:!T.hasAttribute("noscroll"),state:j?JSON.parse(j):void 0})}function g(E){const x=u(E);if(!x)return;const[T,Y]=x;i.preloadRoute(Y,T.getAttribute("preload")!=="false")}function f(E){clearTimeout(l);const x=u(E);if(!x)return c=null;const[T,Y]=x;c!==T&&(l=setTimeout(()=>{i.preloadRoute(Y,T.getAttribute("preload")!=="false"),c=T},20))}function w(E){if(E.defaultPrevented)return;let x=E.submitter&&E.submitter.hasAttribute("formaction")?E.submitter.getAttribute("formaction"):E.target.getAttribute("action");if(!x)return;if(!x.startsWith("https://action/")){const Y=new URL(x,b1);if(x=i.parsePath(Y.pathname+Y.search),!x.startsWith(r))return}if(E.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const T=XS.get(x);if(T){E.preventDefault();const Y=new FormData(E.target,E.submitter);T.call({r:i,f:E.target},E.target.enctype==="multipart/form-data"?Y:new URLSearchParams(Y))}}br(["click","submit"]),document.addEventListener("click",y),t&&(document.addEventListener("mousemove",f,{passive:!0}),document.addEventListener("focusin",g,{passive:!0}),document.addEventListener("touchstart",g,{passive:!0})),document.addEventListener("submit",w),Rc(()=>{document.removeEventListener("click",y),t&&(document.removeEventListener("mousemove",f),document.removeEventListener("focusin",g),document.removeEventListener("touchstart",g)),document.removeEventListener("submit",w)})}}function ew(t){const e=t.replace(/^.*?#/,"");if(!e.startsWith("/")){const[,r="/"]=window.location.hash.split("#",2);return`${r}#${e}`}return e}function tw(t){const e=()=>window.location.hash.slice(1),r=v1();return KS({get:e,set({value:n,replace:i,scroll:o,state:s}){i?window.history.replaceState(CS(s),"","#"+n):window.history.pushState(s,"","#"+n);const l=n.indexOf("#"),c=l>=0?n.slice(l+1):"";QS(c,o),oy()},init:n=>JS(window,"hashchange",AS(n,i=>!r.confirm(i&&i<0?i:e()))),create:ZS(t.preload,t.explicitLinks,t.actionBase),utils:{go:n=>window.history.go(n),renderPath:n=>`#${n}`,parsePath:ew,beforeLeave:r}})(t)}var rw=ae("<a>");function hc(t){t=of({inactiveClass:"inactive",activeClass:"active"},t);const[,e]=sS(t,["href","state","class","activeClass","inactiveClass","end"]),r=DS(()=>t.href),n=MS(r),i=FS(),o=Ut(()=>{const s=r();if(s===void 0)return[!1,!1];const l=Cl(s.split(/[?#]/,1)[0]).toLowerCase(),c=decodeURI(Cl(i.pathname).toLowerCase());return[t.end?l===c:c.startsWith(l+"/")||c===l,l===c]});return(()=>{var s=rw();return bS(s,of(e,{get href(){return n()||t.href},get state(){return JSON.stringify(t.state)},get classList(){return{...t.class&&{[t.class]:!0},[t.inactiveClass]:!o()[0],[t.activeClass]:o()[0],...e.classList}},link:"",get"aria-current"(){return o()[1]?"page":void 0}}),!1),s})()}const lf=Symbol("store-raw"),bc=Symbol("store-node"),Vs=Symbol("store-has"),A1=Symbol("store-self");function $1(t){let e=t[Yo];if(!e&&(Object.defineProperty(t,Yo,{value:e=new Proxy(t,ow)}),!Array.isArray(t))){const r=Object.keys(t),n=Object.getOwnPropertyDescriptors(t);for(let i=0,o=r.length;i<o;i++){const s=r[i];n[s].get&&Object.defineProperty(t,s,{enumerable:n[s].enumerable,get:n[s].get.bind(e)})}}return e}function Nh(t){let e;return t!=null&&typeof t=="object"&&(t[Yo]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function Od(t,e=new Set){let r,n,i,o;if(r=t!=null&&t[lf])return r;if(!Nh(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let s=0,l=t.length;s<l;s++)i=t[s],(n=Od(i,e))!==i&&(t[s]=n)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const s=Object.keys(t),l=Object.getOwnPropertyDescriptors(t);for(let c=0,d=s.length;c<d;c++)o=s[c],!l[o].get&&(i=t[o],(n=Od(i,e))!==i&&(t[o]=n))}return t}function Lh(t,e){let r=t[e];return r||Object.defineProperty(t,e,{value:r=Object.create(null)}),r}function Bd(t,e,r){if(t[e])return t[e];const[n,i]=we(r,{equals:!1,internal:!0});return n.$=i,t[e]=n}function nw(t,e){const r=Reflect.getOwnPropertyDescriptor(t,e);return!r||r.get||!r.configurable||e===Yo||e===bc||(delete r.value,delete r.writable,r.get=()=>t[Yo][e]),r}function E1(t){tf()&&Bd(Lh(t,bc),A1)()}function iw(t){return E1(t),Reflect.ownKeys(t)}const ow={get(t,e,r){if(e===lf)return t;if(e===Yo)return r;if(e===ef)return E1(t),r;const n=Lh(t,bc),i=n[e];let o=i?i():t[e];if(e===bc||e===Vs||e==="__proto__")return o;if(!i){const s=Object.getOwnPropertyDescriptor(t,e);tf()&&(typeof o!="function"||t.hasOwnProperty(e))&&!(s&&s.get)&&(o=Bd(n,e,o)())}return Nh(o)?$1(o):o},has(t,e){return e===lf||e===Yo||e===ef||e===bc||e===Vs||e==="__proto__"?!0:(tf()&&Bd(Lh(t,Vs),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:iw,getOwnPropertyDescriptor:nw};function Rh(t,e,r,n=!1){if(!n&&t[e]===r)return;const i=t[e],o=t.length;r===void 0?(delete t[e],t[Vs]&&t[Vs][e]&&i!==void 0&&t[Vs][e].$()):(t[e]=r,t[Vs]&&t[Vs][e]&&i===void 0&&t[Vs][e].$());let s=Lh(t,bc),l;if((l=Bd(s,e,i))&&l.$(()=>r),Array.isArray(t)&&t.length!==o){for(let c=t.length;c<o;c++)(l=s[c])&&l.$();(l=Bd(s,"length",o))&&l.$(t.length)}(l=s[A1])&&l.$()}function I1(t,e){const r=Object.keys(e);for(let n=0;n<r.length;n+=1){const i=r[n];Rh(t,i,e[i])}}function sw(t,e){if(typeof e=="function"&&(e=e(t)),e=Od(e),Array.isArray(e)){if(t===e)return;let r=0,n=e.length;for(;r<n;r++){const i=e[r];t[r]!==i&&Rh(t,r,i)}Rh(t,"length",n)}else I1(t,e)}function md(t,e,r=[]){let n,i=t;if(e.length>1){n=e.shift();const s=typeof n,l=Array.isArray(t);if(Array.isArray(n)){for(let c=0;c<n.length;c++)md(t,[n[c]].concat(e),r);return}else if(l&&s==="function"){for(let c=0;c<t.length;c++)n(t[c],c)&&md(t,[c].concat(e),r);return}else if(l&&s==="object"){const{from:c=0,to:d=t.length-1,by:u=1}=n;for(let y=c;y<=d;y+=u)md(t,[y].concat(e),r);return}else if(e.length>1){md(t[n],e,[n].concat(r));return}i=t[n],r=[n].concat(r)}let o=e[0];typeof o=="function"&&(o=o(i,r),o===i)||n===void 0&&o==null||(o=Od(o),n===void 0||Nh(i)&&Nh(o)&&!Array.isArray(o)?I1(i,o):Rh(t,n,o))}function Zd(...[t,e]){const r=Od(t||{}),n=Array.isArray(r),i=$1(r);function o(...s){u1(()=>{n&&s.length===1?sw(r,s[0]):md(r,s)})}return[i,o]}const Gr=(t=300+Math.random()*700)=>new Promise(e=>setTimeout(e,t)),Ms=(t="")=>`${t}${Date.now()}-${Math.random().toString(36).substr(2,9)}`,ly=(t,e)=>e.split(".").reduce((r,n)=>r?.[n],t),em=(t,e)=>t.replace(/\{([^}]+)\}/g,(r,n)=>{const i=ly(e,n);return String(i||r)}),aw=(t,e)=>{try{if(!isNaN(Number(t)))return Number(t);const r=ly(e,t);return Number(r)||0}catch{return 0}};let zt={products:[{id:"prod-001",name:"Wireless Headphones",sku:"WH-001",productCode:"WH-001",productName:"Wireless Headphones",description:"High-quality wireless bluetooth headphones",category:"Electronics",unitOfMeasure:"pcs",unitCost:45,sellingPrice:89.99,minStockLevel:10,maxStockLevel:100,isActive:!0,createdDate:"2024-01-15T10:00:00Z",lastModified:"2024-01-15T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-002",name:"USB-C Cable",sku:"USB-001",description:"3ft USB-C charging cable",category:"Accessories",unitOfMeasure:"pcs",unitCost:8.5,sellingPrice:19.99,minStockLevel:25,maxStockLevel:200,isActive:!0,createdDate:"2024-01-16T10:00:00Z",lastModified:"2024-01-16T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-003",name:"Laptop Stand",sku:"LS-001",description:"Adjustable aluminum laptop stand",category:"Office",unitOfMeasure:"pcs",unitCost:25,sellingPrice:49.99,minStockLevel:5,maxStockLevel:50,isActive:!0,createdDate:"2024-01-17T10:00:00Z",lastModified:"2024-01-17T10:00:00Z",businessId:"YB100423253156428"}],locations:[{id:"loc-001",name:"Main Warehouse",code:"WH-001",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-002",name:"Retail Store - Downtown",code:"ST-001",type:"store",address:"456 Main St, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-003",name:"Retail Store - Mall",code:"ST-002",type:"store",address:"789 Mall Blvd, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"}],movements:[{id:"mov-001",productId:"prod-001",productName:"Wireless Headphones",productSku:"WH-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:50,unitCost:45,totalCost:2250,referenceNumber:"PO-001",notes:"Initial stock purchase",createdBy:"admin",createdDate:"2024-01-15T10:00:00Z",invoiceId:"INV-1000001"},{id:"mov-002",productId:"prod-002",productName:"USB-C Cable",productSku:"USB-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:100,unitCost:8.5,totalCost:850,referenceNumber:"PO-001",notes:"Bulk purchase",createdBy:"admin",createdDate:"2024-01-15T10:05:00Z",invoiceId:"INV-1000001"}],accounts:[{id:"acc-001",accountNumber:"1000",accountName:"Cash",accountType:"asset",category:"currentAssets",balance:5e4,parentAccountId:null,description:"Cash and cash equivalents",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"},{id:"acc-002",accountNumber:"1100",accountName:"Accounts Receivable",accountType:"asset",category:"currentAssets",balance:25e3,parentAccountId:null,description:"Money owed by customers",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"}],journalEntries:[{id:"je-001",entryNumber:"JE-001",date:"2024-01-15",description:"Initial cash deposit",reference:"DEP-001",status:"posted",createdBy:"admin",createdAt:"2024-01-15T10:00:00Z",postedAt:"2024-01-15T10:05:00Z",lines:[{id:"jel-001",accountId:"acc-001",accountName:"Cash",description:"Initial deposit",debitAmount:5e4,creditAmount:0},{id:"jel-002",accountId:"acc-003",accountName:"Owner Equity",description:"Initial capital",debitAmount:0,creditAmount:5e4}]}],eventRules:[{id:"rule-001",name:"Auto-post completed invoices",description:"Automatically create journal entries for completed invoices",eventType:"invoice_completed",conditions:[{field:"data.isCompleted",operator:"equals",value:!0,dataType:"boolean"},{field:"data.total",operator:"greaterThan",value:0,dataType:"number"}],journalEntryTemplate:{description:"Invoice {data.invoice} - {data.shipper_consignee.name}",reference:"{data.invoice}",lines:[{accountExpression:"1101",descriptionTemplate:"Invoice {data.invoice} - Customer: {data.shipper_consignee.name}",amountExpression:"data.total",isDebit:!0},{accountExpression:"4001",descriptionTemplate:"Sales revenue for invoice {data.invoice}",amountExpression:"data.productSubtotal",isDebit:!1},{accountExpression:"4201",descriptionTemplate:"Transport services",amountExpression:"data.serviceSubtotal",isDebit:!1},{accountExpression:"2301",descriptionTemplate:"Sales tax",amountExpression:"data.taxAmount",isDebit:!1}]},isActive:!0,priority:100,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01"),businessId:"YB100423253156428"},{id:"rule-002",name:"Record cash payments",description:"Create journal entries for cash payments received",eventType:"payment_received",conditions:[{field:"data.paymentMethod",operator:"equals",value:"cash",dataType:"string"}],journalEntryTemplate:{description:"Payment received - {data.customerName}",reference:"{data.reference}",lines:[{accountExpression:"1001",descriptionTemplate:"Cash payment from {data.customerName}",amountExpression:"data.amount",isDebit:!0},{accountExpression:"1101",descriptionTemplate:"Payment for invoice {data.invoiceId}",amountExpression:"data.amount",isDebit:!1}]},isActive:!0,priority:90,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01"),businessId:"YB100423253156428"}],eventRuleHistory:[]};const Fn=(t=.05)=>Math.random()<t,On=()=>{const t=["Network timeout","Connection refused","Server temporarily unavailable","Invalid request"];throw new Error(t[Math.floor(Math.random()*t.length)])},$n={products:{async getAll(t,e){await Gr(),Fn()&&On();let r=[...zt.products];if(t&&t.trim()){const n=t.toLowerCase();r=r.filter(i=>i.name.toLowerCase().includes(n)||i.sku.toLowerCase().includes(n)||i.category.toLowerCase().includes(n)||i.description.toLowerCase().includes(n))}return e?.category&&(r=r.filter(n=>n.category===e.category)),e?.isActive!==void 0&&(r=r.filter(n=>n.isActive===e.isActive)),r},async getById(t){return await Gr(),Fn()&&On(),zt.products.find(e=>e.id===t)||null},async create(t){if(await Gr(),Fn()&&On(),zt.products.some(r=>r.sku===t.sku))throw new Error("SKU already exists");const e={...t,id:Ms("prod-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return zt.products.push(e),e},async update(t,e){await Gr(),Fn()&&On();const r=zt.products.findIndex(i=>i.id===t);if(r===-1)throw new Error("Product not found");if(e.sku&&zt.products.some(i=>i.id!==t&&i.sku===e.sku))throw new Error("SKU already exists");const n={...zt.products[r],...e,lastModified:new Date().toISOString()};return zt.products[r]=n,n},async delete(t){await Gr(),Fn()&&On();const e=zt.products.findIndex(n=>n.id===t);if(e===-1)throw new Error("Product not found");return zt.movements.some(n=>n.productId===t)?{success:!1,message:"Cannot delete product with existing movements"}:(zt.products.splice(e,1),{success:!0,message:"Product deleted successfully"})}},locations:{async getAll(t){await Gr(),Fn()&&On();let e=[...zt.locations];return t?.type&&(e=e.filter(r=>r.type===t.type)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Gr(),zt.locations.find(e=>e.id===t)||null},async create(t){if(await Gr(),Fn()&&On(),zt.locations.some(r=>r.code===t.code))throw new Error("Location code already exists");const e={...t,id:Ms("loc-"),createdDate:new Date().toISOString()};return zt.locations.push(e),e},async update(t,e){await Gr(),Fn()&&On();const r=zt.locations.findIndex(n=>n.id===t);if(r===-1)throw new Error("Location not found");if(e.code&&zt.locations.some(n=>n.id!==t&&n.code===e.code))throw new Error("Location code already exists");return zt.locations[r]={...zt.locations[r],...e},zt.locations[r]}},movements:{async getAll(t){await Gr(),Fn()&&On();let e=[...zt.movements];if(t?.productId&&(e=e.filter(r=>r.productId===t.productId)),t?.locationId&&(e=e.filter(r=>r.locationId===t.locationId)),t?.movementType&&(e=e.filter(r=>r.movementType===t.movementType)),t?.dateFrom&&(e=e.filter(r=>r.createdDate>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.createdDate<=t.dateTo)),t?.search){const r=t.search.toLowerCase();e=e.filter(n=>n.productName.toLowerCase().includes(r)||n.productSku.toLowerCase().includes(r)||n.referenceNumber.toLowerCase().includes(r)||n.notes.toLowerCase().includes(r))}return e.sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime()),e},async getById(t){return await Gr(),zt.movements.find(e=>e.id===t)||null},async create(t){if(await Gr(),Fn()&&On(),!zt.products.find(i=>i.id===t.productId))throw new Error("Product not found");if(!zt.locations.find(i=>i.id===t.locationId))throw new Error("Location not found");if(t.movementType==="out"){const i=await this.getStockLevel(t.productId,t.locationId);if(i<t.quantity)throw new Error(`Insufficient stock. Available: ${i}, Requested: ${t.quantity}`)}const n={...t,id:Ms("mov-"),createdDate:new Date().toISOString()};return zt.movements.push(n),n},async update(t,e){await Gr(),Fn()&&On();const r=zt.movements.findIndex(i=>i.id===t);if(r===-1)throw new Error("Movement not found");const n={...zt.movements[r],...e,lastModified:new Date().toISOString()};return zt.movements[r]=n,n},async delete(t){await Gr(),Fn()&&On();const e=zt.movements.findIndex(r=>r.id===t);if(e===-1)throw new Error("Movement not found");return zt.movements.splice(e,1),{success:!0,message:"Movement deleted successfully"}},async createBulk(t){await Gr(),Fn()&&On();const e=[],r=[],n=new Date().toISOString(),i=zt.locations.find(o=>o.id===t.locationId);if(!i)return{success:!1,movements:[],errors:["Invalid location"]};for(let o=0;o<t.items.length;o++){const s=t.items[o],l=zt.products.find(u=>u.id===s.productId);if(!l){e.push(`Item ${o+1}: Product not found`);continue}if(s.quantity<=0){e.push(`Item ${o+1}: Quantity must be greater than 0`);continue}if(t.movementType==="out"){const u=await this.getStockLevel(s.productId,t.locationId);if(s.quantity>u){e.push(`Item ${o+1}: Insufficient stock. Available: ${u}, Requested: ${s.quantity}`);continue}}const c=s.unitCost||l.unitCost,d={id:Ms("mov-"),productId:l.id,productName:l.name,productSku:l.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:s.quantity,unitCost:c,totalCost:s.quantity*c,referenceNumber:t.referenceNumber,notes:s.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:t.fromLocationId?zt.locations.find(u=>u.id===t.fromLocationId)?.name:void 0};r.push(d)}return e.length>0?{success:!1,movements:[],errors:e}:(zt.movements.push(...r),{success:!0,movements:r,errors:[]})},async getStockLevel(t,e){return await Gr(50),zt.movements.filter(r=>r.productId===t&&r.locationId===e).reduce((r,n)=>{switch(n.movementType){case"in":case"adjustment":return r+n.quantity;case"out":return r-n.quantity;case"transfer":return n.locationId===e?r+n.quantity:r;default:return r}},0)},async getStockLevels(){await Gr();const t=new Map;for(const e of zt.movements){const r=`${e.productId}-${e.locationId}`;let n=t.get(r);switch(n||(n={id:r,productId:e.productId,locationId:e.locationId,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType){case"in":case"adjustment":n.quantity+=e.quantity;break;case"out":n.quantity-=e.quantity;break;case"transfer":e.locationId===e.locationId&&(n.quantity+=e.quantity);break}new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost,n.availableQuantity=n.quantity-n.reservedQuantity}return Array.from(t.values())}},accounts:{async getAll(t){await Gr(),Fn()&&On();let e=[...zt.accounts];return t?.accountType&&(e=e.filter(r=>r.accountType===t.accountType)),t?.category&&(e=e.filter(r=>r.category===t.category)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Gr(),zt.accounts.find(e=>e.id===t)||null},async create(t){if(await Gr(),Fn()&&On(),zt.accounts.some(r=>r.accountNumber===t.accountNumber))throw new Error("Account number already exists");const e={...t,id:Ms("acc-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return zt.accounts.push(e),e},async update(t,e){await Gr(),Fn()&&On();const r=zt.accounts.findIndex(n=>n.id===t);if(r===-1)throw new Error("Account not found");if(e.accountNumber&&zt.accounts.some(n=>n.id!==t&&n.accountNumber===e.accountNumber))throw new Error("Account number already exists");return zt.accounts[r]={...zt.accounts[r],...e,lastModified:new Date().toISOString()},zt.accounts[r]}},journal:{async getAll(t){await Gr(),Fn()&&On();let e=[...zt.journalEntries];return t?.status&&(e=e.filter(r=>r.status===t.status)),t?.accountId&&(e=e.filter(r=>r.lines.some(n=>n.accountId===t.accountId))),t?.dateFrom&&(e=e.filter(r=>r.date>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.date<=t.dateTo)),e.sort((r,n)=>new Date(n.createdAt).getTime()-new Date(r.createdAt).getTime())},async getById(t){return await Gr(),zt.journalEntries.find(e=>e.id===t)||null},async create(t){await Gr(),Fn()&&On();const e=t.lines.reduce((l,c)=>l+(c.debitAmount||0),0),r=t.lines.reduce((l,c)=>l+(c.creditAmount||0),0);if(Math.abs(e-r)>.01)throw new Error(`Entry is not balanced. Debit: ${e}, Credit: ${r}`);const n=zt.journalEntries.sort((l,c)=>c.entryNumber.localeCompare(l.entryNumber))[0],o=`JE-${((n?parseInt(n.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`,s={...t,id:Ms("je-"),entryNumber:o,createdAt:new Date().toISOString(),lines:t.lines.map(l=>({...l,id:Ms("jel-")}))};return zt.journalEntries.push(s),s},async update(t,e){await Gr(),Fn()&&On();const r=zt.journalEntries.findIndex(n=>n.id===t);if(r===-1)throw new Error("Journal entry not found");if(zt.journalEntries[r].status==="posted")throw new Error("Cannot modify posted entries");return zt.journalEntries[r]={...zt.journalEntries[r],...e},zt.journalEntries[r]},async post(t){await Gr(),Fn()&&On();const e=zt.journalEntries.findIndex(o=>o.id===t);if(e===-1)throw new Error("Journal entry not found");const r=zt.journalEntries[e];if(r.status==="posted")throw new Error("Entry is already posted");const n=r.lines.reduce((o,s)=>o+(s.debitAmount||0),0),i=r.lines.reduce((o,s)=>o+(s.creditAmount||0),0);if(Math.abs(n-i)>.01)throw new Error("Entry must be balanced before posting");return zt.journalEntries[e]={...r,status:"posted",postedAt:new Date().toISOString()},r.lines.forEach(o=>{const s=zt.accounts.findIndex(l=>l.id===o.accountId);if(s!==-1){const l=zt.accounts[s],c=o.debitAmount||0,d=o.creditAmount||0;["asset","expense"].includes(l.accountType)?l.balance+=c-d:l.balance+=d-c}}),zt.journalEntries[e]}},eventRules:{async getAll(){return await Gr(),Fn()&&On(),[...zt.eventRules]},async getById(t){return await Gr(),zt.eventRules.find(e=>e.id===t)||null},async getByEventType(t){return await Gr(),zt.eventRules.filter(e=>e.eventType===t&&e.isActive).sort((e,r)=>r.priority-e.priority)},async create(t){await Gr(),Fn()&&On();const e={...t,id:Ms("rule-"),createdAt:new Date,updatedAt:new Date,businessId:"YB100423253156428"};return zt.eventRules.push(e),e},async update(t,e){await Gr(),Fn()&&On();const r=zt.eventRules.findIndex(n=>n.id===t);if(r===-1)throw new Error("Event rule not found");return zt.eventRules[r]={...zt.eventRules[r],...e,id:t,updatedAt:new Date},zt.eventRules[r]},async delete(t){await Gr(),Fn()&&On();const e=zt.eventRules.findIndex(r=>r.id===t);if(e===-1)throw new Error("Event rule not found");return zt.eventRules.splice(e,1),{success:!0,message:"Event rule deleted successfully"}},async testRule(t,e){await Gr();try{return t.conditions.length===0||t.conditions.every(n=>{const i=ly(e,n.field);switch(n.operator){case"equals":return i===n.value;case"notEquals":return i!==n.value;case"greaterThan":return Number(i)>Number(n.value);case"lessThan":return Number(i)<Number(n.value);case"contains":return String(i).includes(String(n.value));case"exists":return i!=null;case"notExists":return i==null;default:return!1}})?{success:!0,result:{wouldTrigger:!0,estimatedJournalEntry:{description:em(t.journalEntryTemplate.description,e),reference:em(t.journalEntryTemplate.reference,e),lines:t.journalEntryTemplate.lines.map(i=>({accountId:i.accountExpression,description:em(i.descriptionTemplate,e),amount:aw(i.amountExpression,e),isDebit:i.isDebit}))}}}:{success:!0,result:{wouldTrigger:!1,reason:"Conditions not met"}}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Unknown error"}}},async getExecutionHistory(t,e=100){await Gr();let r=[...zt.eventRuleHistory];return t&&(r=r.filter(n=>n.ruleId===t)),r.sort((n,i)=>i.executedAt.getTime()-n.executedAt.getTime()).slice(0,e)},async bulkToggle(t,e){await Gr();const r=[],n=[];for(const i of t){const o=zt.eventRules.findIndex(s=>s.id===i);o!==-1?(zt.eventRules[o].isActive=e,zt.eventRules[o].updatedAt=new Date,r.push(i)):n.push(i)}return{success:n.length===0,updated:r.length,failed:n}},async importRules(t){await Gr();const e=[];let r=0;for(const n of t)try{const i={...n,id:Ms("rule-"),createdAt:new Date,updatedAt:new Date,businessId:"YB100423253156428"};zt.eventRules.push(i),r++}catch(i){e.push(`Failed to import rule ${n.name}: ${i instanceof Error?i.message:"Unknown error"}`)}return{success:e.length===0,imported:r,failed:t.length-r,errors:e}}},utils:{async getNextEntryNumber(){await Gr(100);const t=zt.journalEntries.sort((r,n)=>n.entryNumber.localeCompare(r.entryNumber))[0];return`JE-${((t?parseInt(t.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`},async getNextProductCode(t){await Gr(100);const e=t.toUpperCase().slice(0,3),r=zt.products.filter(i=>i.productCode?.startsWith(e)).sort((i,o)=>(o.productCode||"").localeCompare(i.productCode||""));if(r.length===0)return`${e}001`;const n=parseInt(r[0].productCode?.slice(-3)||"0");return`${e}${(n+1).toString().padStart(3,"0")}`},async healthCheck(){return await Gr(50),{status:"healthy",timestamp:new Date().toISOString(),version:"1.0.0"}},async resetDatabase(){return await Gr(200),zt={products:[...zt.products.slice(0,3)],locations:[...zt.locations.slice(0,3)],movements:[...zt.movements.slice(0,2)],accounts:[...zt.accounts.slice(0,2)],journalEntries:[...zt.journalEntries.slice(0,1)],eventRules:[...zt.eventRules.slice(0,2)],eventRuleHistory:[]},{success:!0,message:"Database reset to initial state"}},async getStats(){return await Gr(100),{products:zt.products.length,locations:zt.locations.length,movements:zt.movements.length,accounts:zt.accounts.length,journalEntries:zt.journalEntries.length,eventRules:zt.eventRules.length,eventRuleHistory:zt.eventRuleHistory.length,totalStockValue:zt.movements.reduce((t,e)=>e.movementType==="in"?t+e.totalCost:e.movementType==="out"?t-e.totalCost:t,0)}}}},T1=t=>t===null||typeof t!="object"?t:t instanceof Date?new Date(t.getTime()):Array.isArray(t)?t.map(e=>T1(e)):JSON.parse(JSON.stringify(t)),Nl=(t=16)=>{const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},Wg=(t=16)=>{const e="123456789";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},lw=(t=4)=>{const e="0123456789BCDFGKSY";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},Gs=t=>typeof t=="string"&&t.trim().length>0,yn=async t=>{const n=await fetch("https://qvamarkets.com/gql_api",{method:"POST",headers:{"Content-Type":"application/json","Accept-Encoding":"gzip, deflate, br",Authorization:"eyJhbGciOiJSUzI1NiIsImtpZCI6IjhlOGZjOGU1NTZmN2E3NmQwOGQzNTgyOWQ2ZjkwYWUyZTEyY2ZkMGQiLCJ0eXAiOiJKV1QifQ"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const i=await n.json();if(i.errors)throw new Error(i.errors[0]?.message||"GraphQL error");return i.data},cw=t=>({ENTRY:"in",in:"in",TRANSFER:"transfer",transfer:"transfer",SALES:"out",out:"out",adjustment:"adjustment"})[t],cf=t=>({ENTRY:"ENTRY",in:"ENTRY",TRANSFER:"TRANSFER",transfer:"TRANSFER",SALES:"SALES",out:"SALES",adjustment:"adjustment"})[t];function Pl(t){var e=[];return t&&Object.keys(t).map(r=>{e.push(t[r])}),e}function dw(t){if(!/^[a-z0-9+/]+={0,2}$/i.test(t)||t.length%4!=0)throw Error("Not base64 string");for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,n,i,o,s,l,c,d,u=[],y=0;y<t.length;y+=4)o=e.indexOf(t.charAt(y)),s=e.indexOf(t.charAt(y+1)),l=e.indexOf(t.charAt(y+2)),c=e.indexOf(t.charAt(y+3)),d=o<<18|s<<12|l<<6|c,r=d>>>16&255,n=d>>>8&255,i=d&255,u[y/4]=String.fromCharCode(r,n,i),c==64&&(u[y/4]=String.fromCharCode(r,n)),l==64&&(u[y/4]=String.fromCharCode(r));return t=u.join(""),t}const k1=(t,e,r,n)=>{let i=0,o={};return t.map(s=>{n?.[s]||N1(e?.[s],r?.[s])||(i=1,o[s]=e[s])}),{hasChange:i,data:o}},N1=(t,e)=>Object.prototype.toString.call(t)===Object.prototype.toString.call(e)?Object.prototype.toString.call(t)==="[object Object]"||Object.prototype.toString.call(t)==="[object Array]"?Object.keys(t).length!==Object.keys(e).length?!1:Object.keys(t).every(function(r){return N1(t[r],e[r])}):t===e:!1,uw=()=>{};var Yg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L1=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},hw=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[r++];e[n++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[r++],s=t[r++],l=t[r++],c=((i&7)<<18|(o&63)<<12|(s&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const o=t[r++],s=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(o&63)<<6|s&63)}}return e.join("")},R1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const o=t[i],s=i+1<t.length,l=s?t[i+1]:0,c=i+2<t.length,d=c?t[i+2]:0,u=o>>2,y=(o&3)<<4|l>>4;let g=(l&15)<<2|d>>6,f=d&63;c||(f=64,s||(g=64)),n.push(r[u],r[y],r[g],r[f])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(L1(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):hw(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const o=r[t.charAt(i++)],l=i<t.length?r[t.charAt(i)]:0;++i;const d=i<t.length?r[t.charAt(i)]:64;++i;const y=i<t.length?r[t.charAt(i)]:64;if(++i,o==null||l==null||d==null||y==null)throw new pw;const g=o<<2|l>>4;if(n.push(g),d!==64){const f=l<<4&240|d>>2;if(n.push(f),y!==64){const w=d<<6&192|y;n.push(w)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class pw extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const mw=function(t){const e=L1(t);return R1.encodeByteArray(e,!0)},Dh=function(t){return mw(t).replace(/\./g,"")},D1=function(t){try{return R1.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fw(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yw=()=>fw().__FIREBASE_DEFAULTS__,gw=()=>{if(typeof process>"u"||typeof Yg>"u")return;const t=Yg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},vw=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&D1(t[1]);return e&&JSON.parse(e)},ap=()=>{try{return uw()||yw()||gw()||vw()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},M1=t=>ap()?.emulatorHosts?.[t],bw=t=>{const e=M1(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},F1=()=>ap()?.config,O1=t=>ap()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _w{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mc(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function B1(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pw(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Dh(JSON.stringify(r)),Dh(JSON.stringify(s)),""].join(".")}const wd={};function Sw(){const t={prod:[],emulator:[]};for(const e of Object.keys(wd))wd[e]?t.emulator.push(e):t.prod.push(e);return t}function ww(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let Kg=!1;function j1(t,e){if(typeof window>"u"||typeof document>"u"||!Mc(window.location.host)||wd[t]===e||wd[t]||Kg)return;wd[t]=e;function r(g){return`__firebase__banner__${g}`}const n="__firebase__banner",o=Sw().prod.length>0;function s(){const g=document.getElementById(n);g&&g.remove()}function l(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function c(g,f){g.setAttribute("width","24"),g.setAttribute("id",f),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function d(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{Kg=!0,s()},g}function u(g,f){g.setAttribute("id",f),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function y(){const g=ww(n),f=r("text"),w=document.getElementById(f)||document.createElement("span"),E=r("learnmore"),x=document.getElementById(E)||document.createElement("a"),T=r("preprendIcon"),Y=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const K=g.element;l(K),u(x,E);const j=d();c(Y,T),K.append(Y,w,x,j),document.body.appendChild(K)}o?(w.innerText="Preview backend disconnected.",Y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",f)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function xw(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(zi())}function Cw(){const t=ap()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Aw(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function $w(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Ew(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Iw(){const t=zi();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Tw(){return!Cw()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function kw(){try{return typeof indexedDB=="object"}catch{return!1}}function Nw(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lw="FirebaseError";class ta extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=Lw,Object.setPrototypeOf(this,ta.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,eu.prototype.create)}}class eu{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,o=this.errors[e],s=o?Rw(o,n):"Error",l=`${this.serviceName}: ${s} (${i}).`;return new ta(i,l,n)}}function Rw(t,e){return t.replace(Dw,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const Dw=/\{\$([^}]+)}/g;function Mw(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ll(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const o=t[i],s=e[i];if(Jg(o)&&Jg(s)){if(!Ll(o,s))return!1}else if(o!==s)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function Jg(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tu(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Fw(t,e){const r=new Ow(t,e);return r.subscribe.bind(r)}class Ow{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");Bw(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=tm),i.error===void 0&&(i.error=tm),i.complete===void 0&&(i.complete=tm);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Bw(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function tm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ci(t){return t&&t._delegate?t._delegate:t}class Rl{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ml="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new _w;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(qw(e))try{this.getOrInitializeService({instanceIdentifier:ml})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=ml){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ml){return this.instances.has(e)}getOptions(e=ml){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,s]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(o);n===l&&s.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const o=this.instances.get(n);return o&&e(o,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Vw(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ml){return this.component?this.component.multipleInstances?e:ml:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Vw(t){return t===ml?void 0:t}function qw(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zw{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new jw(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(nn||(nn={}));const Uw={debug:nn.DEBUG,verbose:nn.VERBOSE,info:nn.INFO,warn:nn.WARN,error:nn.ERROR,silent:nn.SILENT},Hw=nn.INFO,Gw={[nn.DEBUG]:"log",[nn.VERBOSE]:"log",[nn.INFO]:"info",[nn.WARN]:"warn",[nn.ERROR]:"error"},Ww=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=Gw[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class cy{constructor(e){this.name=e,this._logLevel=Hw,this._logHandler=Ww,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in nn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Uw[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,nn.DEBUG,...e),this._logHandler(this,nn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,nn.VERBOSE,...e),this._logHandler(this,nn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,nn.INFO,...e),this._logHandler(this,nn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,nn.WARN,...e),this._logHandler(this,nn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,nn.ERROR,...e),this._logHandler(this,nn.ERROR,...e)}}const Yw=(t,e)=>e.some(r=>t instanceof r);let Qg,Xg;function Kw(){return Qg||(Qg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Jw(){return Xg||(Xg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const V1=new WeakMap,df=new WeakMap,q1=new WeakMap,rm=new WeakMap,dy=new WeakMap;function Qw(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",s)},o=()=>{r(Fa(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",s)});return e.then(r=>{r instanceof IDBCursor&&V1.set(r,t)}).catch(()=>{}),dy.set(e,t),e}function Xw(t){if(df.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",s),t.removeEventListener("abort",s)},o=()=>{r(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",s),t.addEventListener("abort",s)});df.set(t,e)}let uf={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return df.get(t);if(e==="objectStoreNames")return t.objectStoreNames||q1.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Fa(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Zw(t){uf=t(uf)}function ex(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(nm(this),e,...r);return q1.set(n,e.sort?e.sort():[e]),Fa(n)}:Jw().includes(t)?function(...e){return t.apply(nm(this),e),Fa(V1.get(this))}:function(...e){return Fa(t.apply(nm(this),e))}}function tx(t){return typeof t=="function"?ex(t):(t instanceof IDBTransaction&&Xw(t),Yw(t,Kw())?new Proxy(t,uf):t)}function Fa(t){if(t instanceof IDBRequest)return Qw(t);if(rm.has(t))return rm.get(t);const e=tx(t);return e!==t&&(rm.set(t,e),dy.set(e,t)),e}const nm=t=>dy.get(t);function rx(t,e,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const s=indexedDB.open(t,e),l=Fa(s);return n&&s.addEventListener("upgradeneeded",c=>{n(Fa(s.result),c.oldVersion,c.newVersion,Fa(s.transaction),c)}),r&&s.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const nx=["get","getKey","getAll","getAllKeys","count"],ix=["put","add","delete","clear"],im=new Map;function Zg(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(im.get(e))return im.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=ix.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||nx.includes(r)))return;const o=async function(s,...l){const c=this.transaction(s,i?"readwrite":"readonly");let d=c.store;return n&&(d=d.index(l.shift())),(await Promise.all([d[r](...l),i&&c.done]))[0]};return im.set(e,o),o}Zw(t=>({...t,get:(e,r,n)=>Zg(e,r)||t.get(e,r,n),has:(e,r)=>!!Zg(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ox{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(sx(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function sx(t){return t.getComponent()?.type==="VERSION"}const hf="@firebase/app",ev="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ys=new cy("@firebase/app"),ax="@firebase/app-compat",lx="@firebase/analytics-compat",cx="@firebase/analytics",dx="@firebase/app-check-compat",ux="@firebase/app-check",hx="@firebase/auth",px="@firebase/auth-compat",mx="@firebase/database",fx="@firebase/data-connect",yx="@firebase/database-compat",gx="@firebase/functions",vx="@firebase/functions-compat",bx="@firebase/installations",_x="@firebase/installations-compat",Px="@firebase/messaging",Sx="@firebase/messaging-compat",wx="@firebase/performance",xx="@firebase/performance-compat",Cx="@firebase/remote-config",Ax="@firebase/remote-config-compat",$x="@firebase/storage",Ex="@firebase/storage-compat",Ix="@firebase/firestore",Tx="@firebase/ai",kx="@firebase/firestore-compat",Nx="firebase",Lx="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pf="[DEFAULT]",Rx={[hf]:"fire-core",[ax]:"fire-core-compat",[cx]:"fire-analytics",[lx]:"fire-analytics-compat",[ux]:"fire-app-check",[dx]:"fire-app-check-compat",[hx]:"fire-auth",[px]:"fire-auth-compat",[mx]:"fire-rtdb",[fx]:"fire-data-connect",[yx]:"fire-rtdb-compat",[gx]:"fire-fn",[vx]:"fire-fn-compat",[bx]:"fire-iid",[_x]:"fire-iid-compat",[Px]:"fire-fcm",[Sx]:"fire-fcm-compat",[wx]:"fire-perf",[xx]:"fire-perf-compat",[Cx]:"fire-rc",[Ax]:"fire-rc-compat",[$x]:"fire-gcs",[Ex]:"fire-gcs-compat",[Ix]:"fire-fst",[kx]:"fire-fst-compat",[Tx]:"fire-vertex","fire-js":"fire-js",[Nx]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mh=new Map,Dx=new Map,mf=new Map;function tv(t,e){try{t.container.addComponent(e)}catch(r){Ys.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Ac(t){const e=t.name;if(mf.has(e))return Ys.debug(`There were multiple attempts to register component ${e}.`),!1;mf.set(e,t);for(const r of Mh.values())tv(r,t);for(const r of Dx.values())tv(r,t);return!0}function uy(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Lo(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mx={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Oa=new eu("app","Firebase",Mx);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fx{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Rl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Oa.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fc=Lx;function z1(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:pf,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw Oa.create("bad-app-name",{appName:String(i)});if(r||(r=F1()),!r)throw Oa.create("no-options");const o=Mh.get(i);if(o){if(Ll(r,o.options)&&Ll(n,o.config))return o;throw Oa.create("duplicate-app",{appName:i})}const s=new zw(i);for(const c of mf.values())s.addComponent(c);const l=new Fx(r,n,s);return Mh.set(i,l),l}function U1(t=pf){const e=Mh.get(t);if(!e&&t===pf&&F1())return z1();if(!e)throw Oa.create("no-app",{appName:t});return e}function Ba(t,e,r){let n=Rx[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const s=[`Unable to register library "${n}" with version "${e}":`];i&&s.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&o&&s.push("and"),o&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ys.warn(s.join(" "));return}Ac(new Rl(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ox="firebase-heartbeat-database",Bx=1,jd="firebase-heartbeat-store";let om=null;function H1(){return om||(om=rx(Ox,Bx,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(jd)}catch(r){console.warn(r)}}}}).catch(t=>{throw Oa.create("idb-open",{originalErrorMessage:t.message})})),om}async function jx(t){try{const r=(await H1()).transaction(jd),n=await r.objectStore(jd).get(G1(t));return await r.done,n}catch(e){if(e instanceof ta)Ys.warn(e.message);else{const r=Oa.create("idb-get",{originalErrorMessage:e?.message});Ys.warn(r.message)}}}async function rv(t,e){try{const n=(await H1()).transaction(jd,"readwrite");await n.objectStore(jd).put(e,G1(t)),await n.done}catch(r){if(r instanceof ta)Ys.warn(r.message);else{const n=Oa.create("idb-set",{originalErrorMessage:r?.message});Ys.warn(n.message)}}}function G1(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vx=1024,qx=30;class zx{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Hx(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=nv();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>qx){const i=Gx(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Ys.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=nv(),{heartbeatsToSend:r,unsentEntries:n}=Ux(this._heartbeatsCache.heartbeats),i=Dh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Ys.warn(e),""}}}function nv(){return new Date().toISOString().substring(0,10)}function Ux(t,e=Vx){const r=[];let n=t.slice();for(const i of t){const o=r.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),iv(r)>e){o.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),iv(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class Hx{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return kw()?Nw().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await jx(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return rv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return rv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function iv(t){return Dh(JSON.stringify({version:2,heartbeats:t})).length}function Gx(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wx(t){Ac(new Rl("platform-logger",e=>new ox(e),"PRIVATE")),Ac(new Rl("heartbeat",e=>new zx(e),"PRIVATE")),Ba(hf,ev,t),Ba(hf,ev,"esm2020"),Ba("fire-js","")}Wx("");function W1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Yx=W1,Y1=new eu("auth","Firebase",W1());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fh=new cy("@firebase/auth");function Kx(t,...e){Fh.logLevel<=nn.WARN&&Fh.warn(`Auth (${Fc}): ${t}`,...e)}function mh(t,...e){Fh.logLevel<=nn.ERROR&&Fh.error(`Auth (${Fc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ps(t,...e){throw py(t,...e)}function Wo(t,...e){return py(t,...e)}function hy(t,e,r){const n={...Yx(),[e]:r};return new eu("auth","Firebase",n).create(e,{appName:t.name})}function ja(t){return hy(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function K1(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&Ps(t,"argument-error"),hy(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function py(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return Y1.create(t,...e)}function Rr(t,e,...r){if(!t)throw py(e,...r)}function qs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw mh(e),new Error(e)}function Ks(t,e){t||qs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ff(){return typeof self<"u"&&self.location?.href||""}function Jx(){return ov()==="http:"||ov()==="https:"}function ov(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qx(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Jx()||$w()||"connection"in navigator)?navigator.onLine:!0}function Xx(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e,r){this.shortDelay=e,this.longDelay=r,Ks(r>e,"Short delay should be less than long delay!"),this.isMobile=xw()||Ew()}get(){return Qx()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function my(t,e){Ks(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;qs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;qs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;qs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zx={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eC=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],tC=new ru(3e4,6e4);function fy(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Oc(t,e,r,n,i={}){return Q1(t,i,async()=>{let o={},s={};n&&(e==="GET"?s=n:o={body:JSON.stringify(n)});const l=tu({key:t.config.apiKey,...s}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:c,...o};return Aw()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Mc(t.emulatorConfig.host)&&(d.credentials="include"),J1.fetch()(await X1(t,t.config.apiHost,r,l),d)})}async function Q1(t,e,r){t._canInitEmulator=!1;const n={...Zx,...e};try{const i=new nC(t),o=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const s=await o.json();if("needConfirmation"in s)throw Ou(t,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{const l=o.ok?s.errorMessage:s.error.message,[c,d]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ou(t,"credential-already-in-use",s);if(c==="EMAIL_EXISTS")throw Ou(t,"email-already-in-use",s);if(c==="USER_DISABLED")throw Ou(t,"user-disabled",s);const u=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw hy(t,u,d);Ps(t,u)}}catch(i){if(i instanceof ta)throw i;Ps(t,"network-request-failed",{message:String(i)})}}async function rC(t,e,r,n,i={}){const o=await Oc(t,e,r,n,i);return"mfaPendingCredential"in o&&Ps(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function X1(t,e,r,n){const i=`${e}${r}?${n}`,o=t,s=o.config.emulator?my(t.config,i):`${t.config.apiScheme}://${i}`;return eC.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(s).toString():s}class nC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Wo(this.auth,"network-request-failed")),tC.get())})}}function Ou(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Wo(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iC(t,e){return Oc(t,"POST","/v1/accounts:delete",e)}async function Oh(t,e){return Oc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xd(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function oC(t,e=!1){const r=Ci(t),n=await r.getIdToken(e),i=yy(n);Rr(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,s=o?.sign_in_provider;return{claims:i,token:n,authTime:xd(sm(i.auth_time)),issuedAtTime:xd(sm(i.iat)),expirationTime:xd(sm(i.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}}function sm(t){return Number(t)*1e3}function yy(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return mh("JWT malformed, contained fewer than 3 sections"),null;try{const i=D1(r);return i?JSON.parse(i):(mh("Failed to decode base64 JWT payload"),null)}catch(i){return mh("Caught error parsing JWT payload as JSON",i?.toString()),null}}function sv(t){const e=yy(t);return Rr(e,"internal-error"),Rr(typeof e.exp<"u","internal-error"),Rr(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vd(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof ta&&sC(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function sC({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=xd(this.lastLoginAt),this.creationTime=xd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bh(t){const e=t.auth,r=await t.getIdToken(),n=await Vd(t,Oh(e,{idToken:r}));Rr(n?.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const o=i.providerUserInfo?.length?Z1(i.providerUserInfo):[],s=cC(t.providerData,o),l=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!s?.length,d=l?c:!1,u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new yf(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,u)}async function lC(t){const e=Ci(t);await Bh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function cC(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function Z1(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dC(t,e){const r=await Q1(t,{},async()=>{const n=tu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,s=await X1(t,i,"/v1/token",`key=${o}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:l,body:n};return t.emulatorConfig&&Mc(t.emulatorConfig.host)&&(c.credentials="include"),J1.fetch()(s,c)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function uC(t,e){return Oc(t,"POST","/v2/accounts:revokeToken",fy(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Rr(e.idToken,"internal-error"),Rr(typeof e.idToken<"u","internal-error"),Rr(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):sv(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Rr(e.length!==0,"internal-error");const r=sv(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Rr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:o}=await dC(e,r);this.updateTokensAndExpiration(n,i,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:o}=r,s=new _c;return n&&(Rr(typeof n=="string","internal-error",{appName:e}),s.refreshToken=n),i&&(Rr(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),o&&(Rr(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new _c,this.toJSON())}_performRefresh(){return qs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wa(t,e){Rr(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Go{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new aC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new yf(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Vd(this,this.stsTokenManager.getToken(this.auth,e));return Rr(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return oC(this,e)}reload(){return lC(this)}_assign(e){this!==e&&(Rr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Go({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){Rr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Bh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Lo(this.auth.app))return Promise.reject(ja(this.auth));const e=await this.getIdToken();return await Vd(this,iC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,o=r.phoneNumber??void 0,s=r.photoURL??void 0,l=r.tenantId??void 0,c=r._redirectEventId??void 0,d=r.createdAt??void 0,u=r.lastLoginAt??void 0,{uid:y,emailVerified:g,isAnonymous:f,providerData:w,stsTokenManager:E}=r;Rr(y&&E,e,"internal-error");const x=_c.fromJSON(this.name,E);Rr(typeof y=="string",e,"internal-error"),wa(n,e.name),wa(i,e.name),Rr(typeof g=="boolean",e,"internal-error"),Rr(typeof f=="boolean",e,"internal-error"),wa(o,e.name),wa(s,e.name),wa(l,e.name),wa(c,e.name),wa(d,e.name),wa(u,e.name);const T=new Go({uid:y,auth:e,email:i,emailVerified:g,displayName:n,isAnonymous:f,photoURL:s,phoneNumber:o,tenantId:l,stsTokenManager:x,createdAt:d,lastLoginAt:u});return w&&Array.isArray(w)&&(T.providerData=w.map(Y=>({...Y}))),c&&(T._redirectEventId=c),T}static async _fromIdTokenResponse(e,r,n=!1){const i=new _c;i.updateFromServerResponse(r);const o=new Go({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Bh(o),o}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];Rr(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?Z1(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!o?.length,l=new _c;l.updateFromIdToken(n);const c=new Go({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:s}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new yf(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const av=new Map;function zs(t){Ks(t instanceof Function,"Expected a class definition");let e=av.get(t);return e?(Ks(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,av.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}e2.type="NONE";const lv=e2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fh(t,e,r){return`firebase:${t}:${e}:${r}`}class Pc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:o}=this.auth;this.fullUserKey=fh(this.userKey,i.apiKey,o),this.fullPersistenceKey=fh("persistence",i.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await Oh(this.auth,{idToken:e}).catch(()=>{});return r?Go._fromGetAccountInfoResponse(this.auth,r,e):null}return Go._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Pc(zs(lv),e,n);const i=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let o=i[0]||zs(lv);const s=fh(n,e.config.apiKey,e.name);let l=null;for(const d of r)try{const u=await d._get(s);if(u){let y;if(typeof u=="string"){const g=await Oh(e,{idToken:u}).catch(()=>{});if(!g)break;y=await Go._fromGetAccountInfoResponse(e,g,u)}else y=Go._fromJSON(e,u);d!==o&&(l=y),o=d;break}}catch{}const c=i.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!c.length?new Pc(o,e,n):(o=c[0],l&&await o._set(s,l.toJSON()),await Promise.all(r.map(async d=>{if(d!==o)try{await d._remove(s)}catch{}})),new Pc(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cv(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(i2(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(t2(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(s2(e))return"Blackberry";if(a2(e))return"Webos";if(r2(e))return"Safari";if((e.includes("chrome/")||n2(e))&&!e.includes("edge/"))return"Chrome";if(o2(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function t2(t=zi()){return/firefox\//i.test(t)}function r2(t=zi()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function n2(t=zi()){return/crios\//i.test(t)}function i2(t=zi()){return/iemobile/i.test(t)}function o2(t=zi()){return/android/i.test(t)}function s2(t=zi()){return/blackberry/i.test(t)}function a2(t=zi()){return/webos/i.test(t)}function gy(t=zi()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function hC(t=zi()){return gy(t)&&!!window.navigator?.standalone}function pC(){return Iw()&&document.documentMode===10}function l2(t=zi()){return gy(t)||o2(t)||a2(t)||s2(t)||/windows phone/i.test(t)||i2(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c2(t,e=[]){let r;switch(t){case"Browser":r=cv(zi());break;case"Worker":r=`${cv(zi())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Fc}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((s,l)=>{try{const c=e(o);s(c)}catch(c){l(c)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fC(t,e={}){return Oc(t,"GET","/v2/passwordPolicy",fy(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yC=6;class gC{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??yC,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new dv(this),this.idTokenSubscription=new dv(this),this.beforeStateQueue=new mC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Y1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=zs(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Pc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Oh(this,{idToken:e}),n=await Go._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Lo(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(s,s))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,s=n?._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===s)&&l?.user&&(n=l.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Rr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Bh(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Xx()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Lo(this.app))return Promise.reject(ja(this));const r=e?Ci(e):null;return r&&Rr(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Rr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Lo(this.app)?Promise.reject(ja(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Lo(this.app)?Promise.reject(ja(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await fC(this),r=new gC(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new eu("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await uC(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&zs(e)||this._popupRedirectResolver;Rr(r,this,"argument-error"),this.redirectPersistenceManager=await Pc.create(this,[zs(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let s=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Rr(l,this,"internal-error"),l.then(()=>{s||o(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,i);return()=>{s=!0,c()}}else{const c=e.addObserver(r);return()=>{s=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Rr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=c2(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(Lo(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Kx(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Ol(t){return Ci(t)}class dv{constructor(e){this.auth=e,this.observer=null,this.addObserver=Fw(r=>this.observer=r)}get next(){return Rr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vy={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function bC(t){vy=t}function _C(t){return vy.loadJS(t)}function PC(){return vy.gapiScript}function SC(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wC(t,e){const r=uy(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),o=r.getOptions();if(Ll(o,e??{}))return i;Ps(i,"already-initialized")}return r.initialize({options:e})}function xC(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(zs);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function CC(t,e,r){const n=Ol(t);Rr(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,o=d2(e),{host:s,port:l}=AC(e),c=l===null?"":`:${l}`,d={url:`${o}//${s}${c}/`},u=Object.freeze({host:s,port:l,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){Rr(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Rr(Ll(d,n.config.emulator)&&Ll(u,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=u,n.settings.appVerificationDisabledForTesting=!0,Mc(s)?(B1(`${o}//${s}${c}`),j1("Auth",!0)):$C()}function d2(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function AC(t){const e=d2(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const o=i[1];return{host:o,port:uv(n.substr(o.length+1))}}else{const[o,s]=n.split(":");return{host:o,port:uv(s)}}}function uv(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function $C(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u2{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return qs("not implemented")}_getIdTokenResponse(e){return qs("not implemented")}_linkToIdToken(e,r){return qs("not implemented")}_getReauthenticationResolver(e){return qs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sc(t,e){return rC(t,"POST","/v1/accounts:signInWithIdp",fy(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EC="http://localhost";class Dl extends u2{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Dl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Ps("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...o}=r;if(!n||!i)return null;const s=new Dl(n,i);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){const r=this.buildRequest();return Sc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Sc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Sc(e,r)}buildRequest(){const e={requestUri:EC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=tu(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu extends lp{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta extends nu{constructor(){super("facebook.com")}static credential(e){return Dl._fromParams({providerId:Ta.PROVIDER_ID,signInMethod:Ta.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ta.credentialFromTaggedObject(e)}static credentialFromError(e){return Ta.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ta.credential(e.oauthAccessToken)}catch{return null}}}Ta.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ta.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us extends nu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Dl._fromParams({providerId:us.PROVIDER_ID,signInMethod:us.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return us.credentialFromTaggedObject(e)}static credentialFromError(e){return us.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return us.credential(r,n)}catch{return null}}}us.GOOGLE_SIGN_IN_METHOD="google.com";us.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka extends nu{constructor(){super("github.com")}static credential(e){return Dl._fromParams({providerId:ka.PROVIDER_ID,signInMethod:ka.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ka.credentialFromTaggedObject(e)}static credentialFromError(e){return ka.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ka.credential(e.oauthAccessToken)}catch{return null}}}ka.GITHUB_SIGN_IN_METHOD="github.com";ka.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na extends nu{constructor(){super("twitter.com")}static credential(e,r){return Dl._fromParams({providerId:Na.PROVIDER_ID,signInMethod:Na.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Na.credentialFromTaggedObject(e)}static credentialFromError(e){return Na.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Na.credential(r,n)}catch{return null}}}Na.TWITTER_SIGN_IN_METHOD="twitter.com";Na.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const o=await Go._fromIdTokenResponse(e,n,i),s=hv(n);return new $c({user:o,providerId:s,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=hv(n);return new $c({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function hv(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh extends ta{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,jh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new jh(e,r,n,i)}}function h2(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?jh._fromErrorAndOperation(t,o,e,n):o})}async function IC(t,e,r=!1){const n=await Vd(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return $c._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TC(t,e,r=!1){const{auth:n}=t;if(Lo(n.app))return Promise.reject(ja(n));const i="reauthenticate";try{const o=await Vd(t,h2(n,i,e,t),r);Rr(o.idToken,n,"internal-error");const s=yy(o.idToken);Rr(s,n,"internal-error");const{sub:l}=s;return Rr(t.uid===l,n,"user-mismatch"),$c._forOperation(t,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&Ps(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p2(t,e,r=!1){if(Lo(t.app))return Promise.reject(ja(t));const n="signIn",i=await h2(t,n,e),o=await $c._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(o.user),o}async function kC(t,e){return p2(Ol(t),e)}function NC(t,e,r,n){return Ci(t).onIdTokenChanged(e,r,n)}function LC(t,e,r){return Ci(t).beforeAuthStateChanged(e,r)}function RC(t,e,r,n){return Ci(t).onAuthStateChanged(e,r,n)}function DC(t){return Ci(t).signOut()}const Vh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m2{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Vh,"1"),this.storage.removeItem(Vh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MC=1e3,FC=10;class f2 extends m2{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=l2(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((s,l,c)=>{this.notifyListeners(s,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const s=this.storage.getItem(n);!r&&this.localCache[n]===s||this.notifyListeners(n,s)},o=this.storage.getItem(n);pC()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,FC):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},MC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}f2.type="LOCAL";const OC=f2;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y2 extends m2{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}y2.type="SESSION";const g2=y2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BC(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new cp(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:o}=r.data,s=this.handlersMap[i];if(!s?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const l=Array.from(s).map(async d=>d(r.origin,o)),c=await BC(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}cp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function by(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,s;return new Promise((l,c)=>{const d=by("",20);i.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},n);s={messageChannel:i,onMessage(y){const g=y;if(g.data.eventId===d)switch(g.data.status){case"ack":clearTimeout(u),o=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),l(g.data.response);break;default:clearTimeout(u),clearTimeout(o),c(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ps(){return window}function VC(t){ps().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v2(){return typeof ps().WorkerGlobalScope<"u"&&typeof ps().importScripts=="function"}async function qC(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function zC(){return navigator?.serviceWorker?.controller||null}function UC(){return v2()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b2="firebaseLocalStorageDb",HC=1,qh="firebaseLocalStorage",_2="fbase_key";class iu{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function dp(t,e){return t.transaction([qh],e?"readwrite":"readonly").objectStore(qh)}function GC(){const t=indexedDB.deleteDatabase(b2);return new iu(t).toPromise()}function gf(){const t=indexedDB.open(b2,HC);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(qh,{keyPath:_2})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(qh)?e(n):(n.close(),await GC(),e(await gf()))})})}async function pv(t,e,r){const n=dp(t,!0).put({[_2]:e,value:r});return new iu(n).toPromise()}async function WC(t,e){const r=dp(t,!1).get(e),n=await new iu(r).toPromise();return n===void 0?null:n.value}function mv(t,e){const r=dp(t,!0).delete(e);return new iu(r).toPromise()}const YC=800,KC=3;class P2{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await gf(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>KC)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return v2()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=cp._getInstance(UC()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await qC(),!this.activeServiceWorker)return;this.sender=new jC(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||zC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await gf();return await pv(e,Vh,"1"),await mv(e,Vh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>pv(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>WC(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>mv(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=dp(i,!1).getAll();return new iu(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),YC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}P2.type="LOCAL";const JC=P2;new ru(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _y(t,e){return e?zs(e):(Rr(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py extends u2{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Sc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Sc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Sc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function QC(t){return p2(t.auth,new Py(t),t.bypassAuthState)}function XC(t){const{auth:e,user:r}=t;return Rr(r,e,"internal-error"),TC(r,new Py(t),t.bypassAuthState)}async function ZC(t){const{auth:e,user:r}=t;return Rr(r,e,"internal-error"),IC(r,new Py(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S2{constructor(e,r,n,i,o=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:o,error:s,type:l}=e;if(s){this.reject(s);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return QC;case"linkViaPopup":case"linkViaRedirect":return ZC;case"reauthViaPopup":case"reauthViaRedirect":return XC;default:Ps(this.auth,"internal-error")}}resolve(e){Ks(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ks(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eA=new ru(2e3,1e4);async function tA(t,e,r){if(Lo(t.app))return Promise.reject(Wo(t,"operation-not-supported-in-this-environment"));const n=Ol(t);K1(t,e,lp);const i=_y(n,r);return new Sl(n,"signInViaPopup",e,i).executeNotNull()}class Sl extends S2{constructor(e,r,n,i,o){super(e,r,i,o),this.provider=n,this.authWindow=null,this.pollId=null,Sl.currentPopupAction&&Sl.currentPopupAction.cancel(),Sl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Rr(e,this.auth,"internal-error"),e}async onExecution(){Ks(this.filter.length===1,"Popup operations only handle one event");const e=by();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Wo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Wo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Sl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Wo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,eA.get())};e()}}Sl.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rA="pendingRedirect",yh=new Map;class nA extends S2{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=yh.get(this.auth._key());if(!e){try{const n=await iA(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}yh.set(this.auth._key(),e)}return this.bypassAuthState||yh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function iA(t,e){const r=x2(e),n=w2(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}async function oA(t,e){return w2(t)._set(x2(e),"true")}function sA(t,e){yh.set(t._key(),e)}function w2(t){return zs(t._redirectPersistence)}function x2(t){return fh(rA,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aA(t,e,r){return lA(t,e,r)}async function lA(t,e,r){if(Lo(t.app))return Promise.reject(ja(t));const n=Ol(t);K1(t,e,lp),await n._initializationPromise;const i=_y(n,r);return await oA(i,n),i._openRedirect(n,e,"signInViaRedirect")}async function cA(t,e){return await Ol(t)._initializationPromise,C2(t,e,!1)}async function C2(t,e,r=!1){if(Lo(t.app))return Promise.reject(ja(t));const n=Ol(t),i=_y(n,e),s=await new nA(n,i,r).execute();return s&&!r&&(delete s.user._redirectEventId,await n._persistUserIfCurrent(s.user),await n._setRedirectUser(null,e)),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dA=10*60*1e3;class uA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!hA(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!A2(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Wo(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=dA&&this.cachedEventUids.clear(),this.cachedEventUids.has(fv(e))}saveEventToCache(e){this.cachedEventUids.add(fv(e)),this.lastProcessedEventTime=Date.now()}}function fv(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function A2({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function hA(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return A2(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pA(t,e={}){return Oc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mA=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,fA=/^https?/;async function yA(t){if(t.config.emulator)return;const{authorizedDomains:e}=await pA(t);for(const r of e)try{if(gA(r))return}catch{}Ps(t,"unauthorized-domain")}function gA(t){const e=ff(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return s.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&s.hostname===n}if(!fA.test(r))return!1;if(mA.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vA=new ru(3e4,6e4);function yv(){const t=ps().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function bA(t){return new Promise((e,r)=>{function n(){yv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{yv(),r(Wo(t,"network-request-failed"))},timeout:vA.get()})}if(ps().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(ps().gapi?.load)n();else{const i=SC("iframefcb");return ps()[i]=()=>{gapi.load?n():r(Wo(t,"network-request-failed"))},_C(`${PC()}?onload=${i}`).catch(o=>r(o))}}).catch(e=>{throw gh=null,e})}let gh=null;function _A(t){return gh=gh||bA(t),gh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PA=new ru(5e3,15e3),SA="__/auth/iframe",wA="emulator/auth/iframe",xA={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},CA=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function AA(t){const e=t.config;Rr(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?my(e,wA):`https://${t.config.authDomain}/${SA}`,n={apiKey:e.apiKey,appName:t.name,v:Fc},i=CA.get(t.config.apiHost);i&&(n.eid=i);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${tu(n).slice(1)}`}async function $A(t){const e=await _A(t),r=ps().gapi;return Rr(r,t,"internal-error"),e.open({where:document.body,url:AA(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:xA,dontclear:!0},n=>new Promise(async(i,o)=>{await n.restyle({setHideOnLeave:!1});const s=Wo(t,"network-request-failed"),l=ps().setTimeout(()=>{o(s)},PA.get());function c(){ps().clearTimeout(l),i(n)}n.ping(c).then(c,()=>{o(s)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EA={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},IA=500,TA=600,kA="_blank",NA="http://localhost";class gv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function LA(t,e,r,n=IA,i=TA){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const c={...EA,width:n.toString(),height:i.toString(),top:o,left:s},d=zi().toLowerCase();r&&(l=n2(d)?kA:r),t2(d)&&(e=e||NA,c.scrollbars="yes");const u=Object.entries(c).reduce((g,[f,w])=>`${g}${f}=${w},`,"");if(hC(d)&&l!=="_self")return RA(e||"",l),new gv(null);const y=window.open(e||"",l,u);Rr(y,t,"popup-blocked");try{y.focus()}catch{}return new gv(y)}function RA(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DA="__/auth/handler",MA="emulator/auth/handler",FA=encodeURIComponent("fac");async function vv(t,e,r,n,i,o){Rr(t.config.authDomain,t,"auth-domain-config-required"),Rr(t.config.apiKey,t,"invalid-api-key");const s={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Fc,eventId:i};if(e instanceof lp){e.setDefaultLanguage(t.languageCode),s.providerId=e.providerId||"",Mw(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,y]of Object.entries({}))s[u]=y}if(e instanceof nu){const u=e.getScopes().filter(y=>y!=="");u.length>0&&(s.scopes=u.join(","))}t.tenantId&&(s.tid=t.tenantId);const l=s;for(const u of Object.keys(l))l[u]===void 0&&delete l[u];const c=await t._getAppCheckToken(),d=c?`#${FA}=${encodeURIComponent(c)}`:"";return`${OA(t)}?${tu(l).slice(1)}${d}`}function OA({config:t}){return t.emulator?my(t,MA):`https://${t.authDomain}/${DA}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const am="webStorageSupport";class BA{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=g2,this._completeRedirectFn=C2,this._overrideRedirectResult=sA}async _openPopup(e,r,n,i){Ks(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await vv(e,r,n,ff(),i);return LA(e,o,by())}async _openRedirect(e,r,n,i){await this._originValidation(e);const o=await vv(e,r,n,ff(),i);return VC(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:o}=this.eventManagers[r];return i?Promise.resolve(i):(Ks(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await $A(e),n=new uA(e);return r.register("authEvent",i=>(Rr(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(am,{type:am},i=>{const o=i?.[0]?.[am];o!==void 0&&r(!!o),Ps(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=yA(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return l2()||r2()||gy()}}const jA=BA;var bv="@firebase/auth",_v="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VA{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Rr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qA(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function zA(t){Ac(new Rl("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:l}=n.options;Rr(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:s,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:c2(t)},d=new vC(n,i,o,c);return xC(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Ac(new Rl("auth-internal",e=>{const r=Ol(e.getProvider("auth").getImmediate());return(n=>new VA(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ba(bv,_v,qA(t)),Ba(bv,_v,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UA=5*60,HA=O1("authIdTokenMaxAge")||UA;let Pv=null;const GA=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>HA)return;const i=r?.token;Pv!==i&&(Pv=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function WA(t=U1()){const e=uy(t,"auth");if(e.isInitialized())return e.getImmediate();const r=wC(t,{popupRedirectResolver:jA,persistence:[JC,OC,g2]}),n=O1("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const s=GA(o.toString());LC(r,s,()=>s(r.currentUser)),NC(r,l=>s(l))}}const i=M1("auth");return i&&CC(r,`http://${i}`),r}function YA(){return document.getElementsByTagName("head")?.[0]??document}bC({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const o=Wo("internal-error");o.customData=i,r(o)},n.type="text/javascript",n.charset="UTF-8",YA().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});zA("Browser");var KA="firebase",JA="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ba(KA,JA,"app");var Sv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Va,$2;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,P){function $(){}$.prototype=P.prototype,C.D=P.prototype,C.prototype=new $,C.prototype.constructor=C,C.C=function(D,b,S){for(var v=Array(arguments.length-2),z=2;z<arguments.length;z++)v[z-2]=arguments[z];return P.prototype[b].apply(D,v)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(C,P,$){$||($=0);var D=Array(16);if(typeof P=="string")for(var b=0;16>b;++b)D[b]=P.charCodeAt($++)|P.charCodeAt($++)<<8|P.charCodeAt($++)<<16|P.charCodeAt($++)<<24;else for(b=0;16>b;++b)D[b]=P[$++]|P[$++]<<8|P[$++]<<16|P[$++]<<24;P=C.g[0],$=C.g[1],b=C.g[2];var S=C.g[3],v=P+(S^$&(b^S))+D[0]+3614090360&4294967295;P=$+(v<<7&4294967295|v>>>25),v=S+(b^P&($^b))+D[1]+3905402710&4294967295,S=P+(v<<12&4294967295|v>>>20),v=b+($^S&(P^$))+D[2]+606105819&4294967295,b=S+(v<<17&4294967295|v>>>15),v=$+(P^b&(S^P))+D[3]+3250441966&4294967295,$=b+(v<<22&4294967295|v>>>10),v=P+(S^$&(b^S))+D[4]+4118548399&4294967295,P=$+(v<<7&4294967295|v>>>25),v=S+(b^P&($^b))+D[5]+1200080426&4294967295,S=P+(v<<12&4294967295|v>>>20),v=b+($^S&(P^$))+D[6]+2821735955&4294967295,b=S+(v<<17&4294967295|v>>>15),v=$+(P^b&(S^P))+D[7]+4249261313&4294967295,$=b+(v<<22&4294967295|v>>>10),v=P+(S^$&(b^S))+D[8]+1770035416&4294967295,P=$+(v<<7&4294967295|v>>>25),v=S+(b^P&($^b))+D[9]+2336552879&4294967295,S=P+(v<<12&4294967295|v>>>20),v=b+($^S&(P^$))+D[10]+4294925233&4294967295,b=S+(v<<17&4294967295|v>>>15),v=$+(P^b&(S^P))+D[11]+2304563134&4294967295,$=b+(v<<22&4294967295|v>>>10),v=P+(S^$&(b^S))+D[12]+1804603682&4294967295,P=$+(v<<7&4294967295|v>>>25),v=S+(b^P&($^b))+D[13]+4254626195&4294967295,S=P+(v<<12&4294967295|v>>>20),v=b+($^S&(P^$))+D[14]+2792965006&4294967295,b=S+(v<<17&4294967295|v>>>15),v=$+(P^b&(S^P))+D[15]+1236535329&4294967295,$=b+(v<<22&4294967295|v>>>10),v=P+(b^S&($^b))+D[1]+4129170786&4294967295,P=$+(v<<5&4294967295|v>>>27),v=S+($^b&(P^$))+D[6]+3225465664&4294967295,S=P+(v<<9&4294967295|v>>>23),v=b+(P^$&(S^P))+D[11]+643717713&4294967295,b=S+(v<<14&4294967295|v>>>18),v=$+(S^P&(b^S))+D[0]+3921069994&4294967295,$=b+(v<<20&4294967295|v>>>12),v=P+(b^S&($^b))+D[5]+3593408605&4294967295,P=$+(v<<5&4294967295|v>>>27),v=S+($^b&(P^$))+D[10]+38016083&4294967295,S=P+(v<<9&4294967295|v>>>23),v=b+(P^$&(S^P))+D[15]+3634488961&4294967295,b=S+(v<<14&4294967295|v>>>18),v=$+(S^P&(b^S))+D[4]+3889429448&4294967295,$=b+(v<<20&4294967295|v>>>12),v=P+(b^S&($^b))+D[9]+568446438&4294967295,P=$+(v<<5&4294967295|v>>>27),v=S+($^b&(P^$))+D[14]+3275163606&4294967295,S=P+(v<<9&4294967295|v>>>23),v=b+(P^$&(S^P))+D[3]+4107603335&4294967295,b=S+(v<<14&4294967295|v>>>18),v=$+(S^P&(b^S))+D[8]+1163531501&4294967295,$=b+(v<<20&4294967295|v>>>12),v=P+(b^S&($^b))+D[13]+2850285829&4294967295,P=$+(v<<5&4294967295|v>>>27),v=S+($^b&(P^$))+D[2]+4243563512&4294967295,S=P+(v<<9&4294967295|v>>>23),v=b+(P^$&(S^P))+D[7]+1735328473&4294967295,b=S+(v<<14&4294967295|v>>>18),v=$+(S^P&(b^S))+D[12]+2368359562&4294967295,$=b+(v<<20&4294967295|v>>>12),v=P+($^b^S)+D[5]+4294588738&4294967295,P=$+(v<<4&4294967295|v>>>28),v=S+(P^$^b)+D[8]+2272392833&4294967295,S=P+(v<<11&4294967295|v>>>21),v=b+(S^P^$)+D[11]+1839030562&4294967295,b=S+(v<<16&4294967295|v>>>16),v=$+(b^S^P)+D[14]+4259657740&4294967295,$=b+(v<<23&4294967295|v>>>9),v=P+($^b^S)+D[1]+2763975236&4294967295,P=$+(v<<4&4294967295|v>>>28),v=S+(P^$^b)+D[4]+1272893353&4294967295,S=P+(v<<11&4294967295|v>>>21),v=b+(S^P^$)+D[7]+4139469664&4294967295,b=S+(v<<16&4294967295|v>>>16),v=$+(b^S^P)+D[10]+3200236656&4294967295,$=b+(v<<23&4294967295|v>>>9),v=P+($^b^S)+D[13]+681279174&4294967295,P=$+(v<<4&4294967295|v>>>28),v=S+(P^$^b)+D[0]+3936430074&4294967295,S=P+(v<<11&4294967295|v>>>21),v=b+(S^P^$)+D[3]+3572445317&4294967295,b=S+(v<<16&4294967295|v>>>16),v=$+(b^S^P)+D[6]+76029189&4294967295,$=b+(v<<23&4294967295|v>>>9),v=P+($^b^S)+D[9]+3654602809&4294967295,P=$+(v<<4&4294967295|v>>>28),v=S+(P^$^b)+D[12]+3873151461&4294967295,S=P+(v<<11&4294967295|v>>>21),v=b+(S^P^$)+D[15]+530742520&4294967295,b=S+(v<<16&4294967295|v>>>16),v=$+(b^S^P)+D[2]+3299628645&4294967295,$=b+(v<<23&4294967295|v>>>9),v=P+(b^($|~S))+D[0]+4096336452&4294967295,P=$+(v<<6&4294967295|v>>>26),v=S+($^(P|~b))+D[7]+1126891415&4294967295,S=P+(v<<10&4294967295|v>>>22),v=b+(P^(S|~$))+D[14]+2878612391&4294967295,b=S+(v<<15&4294967295|v>>>17),v=$+(S^(b|~P))+D[5]+4237533241&4294967295,$=b+(v<<21&4294967295|v>>>11),v=P+(b^($|~S))+D[12]+1700485571&4294967295,P=$+(v<<6&4294967295|v>>>26),v=S+($^(P|~b))+D[3]+2399980690&4294967295,S=P+(v<<10&4294967295|v>>>22),v=b+(P^(S|~$))+D[10]+4293915773&4294967295,b=S+(v<<15&4294967295|v>>>17),v=$+(S^(b|~P))+D[1]+2240044497&4294967295,$=b+(v<<21&4294967295|v>>>11),v=P+(b^($|~S))+D[8]+1873313359&4294967295,P=$+(v<<6&4294967295|v>>>26),v=S+($^(P|~b))+D[15]+4264355552&4294967295,S=P+(v<<10&4294967295|v>>>22),v=b+(P^(S|~$))+D[6]+2734768916&4294967295,b=S+(v<<15&4294967295|v>>>17),v=$+(S^(b|~P))+D[13]+1309151649&4294967295,$=b+(v<<21&4294967295|v>>>11),v=P+(b^($|~S))+D[4]+4149444226&4294967295,P=$+(v<<6&4294967295|v>>>26),v=S+($^(P|~b))+D[11]+3174756917&4294967295,S=P+(v<<10&4294967295|v>>>22),v=b+(P^(S|~$))+D[2]+718787259&4294967295,b=S+(v<<15&4294967295|v>>>17),v=$+(S^(b|~P))+D[9]+3951481745&4294967295,C.g[0]=C.g[0]+P&4294967295,C.g[1]=C.g[1]+(b+(v<<21&4294967295|v>>>11))&4294967295,C.g[2]=C.g[2]+b&4294967295,C.g[3]=C.g[3]+S&4294967295}n.prototype.u=function(C,P){P===void 0&&(P=C.length);for(var $=P-this.blockSize,D=this.B,b=this.h,S=0;S<P;){if(b==0)for(;S<=$;)i(this,C,S),S+=this.blockSize;if(typeof C=="string"){for(;S<P;)if(D[b++]=C.charCodeAt(S++),b==this.blockSize){i(this,D),b=0;break}}else for(;S<P;)if(D[b++]=C[S++],b==this.blockSize){i(this,D),b=0;break}}this.h=b,this.o+=P},n.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var P=1;P<C.length-8;++P)C[P]=0;var $=8*this.o;for(P=C.length-8;P<C.length;++P)C[P]=$&255,$/=256;for(this.u(C),C=Array(16),P=$=0;4>P;++P)for(var D=0;32>D;D+=8)C[$++]=this.g[P]>>>D&255;return C};function o(C,P){var $=l;return Object.prototype.hasOwnProperty.call($,C)?$[C]:$[C]=P(C)}function s(C,P){this.h=P;for(var $=[],D=!0,b=C.length-1;0<=b;b--){var S=C[b]|0;D&&S==P||($[b]=S,D=!1)}this.g=$}var l={};function c(C){return-128<=C&&128>C?o(C,function(P){return new s([P|0],0>P?-1:0)}):new s([C|0],0>C?-1:0)}function d(C){if(isNaN(C)||!isFinite(C))return y;if(0>C)return x(d(-C));for(var P=[],$=1,D=0;C>=$;D++)P[D]=C/$|0,$*=4294967296;return new s(P,0)}function u(C,P){if(C.length==0)throw Error("number format error: empty string");if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(C.charAt(0)=="-")return x(u(C.substring(1),P));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var $=d(Math.pow(P,8)),D=y,b=0;b<C.length;b+=8){var S=Math.min(8,C.length-b),v=parseInt(C.substring(b,b+S),P);8>S?(S=d(Math.pow(P,S)),D=D.j(S).add(d(v))):(D=D.j($),D=D.add(d(v)))}return D}var y=c(0),g=c(1),f=c(16777216);t=s.prototype,t.m=function(){if(E(this))return-x(this).m();for(var C=0,P=1,$=0;$<this.g.length;$++){var D=this.i($);C+=(0<=D?D:4294967296+D)*P,P*=4294967296}return C},t.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(w(this))return"0";if(E(this))return"-"+x(this).toString(C);for(var P=d(Math.pow(C,6)),$=this,D="";;){var b=j($,P).g;$=T($,b.j(P));var S=((0<$.g.length?$.g[0]:$.h)>>>0).toString(C);if($=b,w($))return S+D;for(;6>S.length;)S="0"+S;D=S+D}},t.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function w(C){if(C.h!=0)return!1;for(var P=0;P<C.g.length;P++)if(C.g[P]!=0)return!1;return!0}function E(C){return C.h==-1}t.l=function(C){return C=T(this,C),E(C)?-1:w(C)?0:1};function x(C){for(var P=C.g.length,$=[],D=0;D<P;D++)$[D]=~C.g[D];return new s($,~C.h).add(g)}t.abs=function(){return E(this)?x(this):this},t.add=function(C){for(var P=Math.max(this.g.length,C.g.length),$=[],D=0,b=0;b<=P;b++){var S=D+(this.i(b)&65535)+(C.i(b)&65535),v=(S>>>16)+(this.i(b)>>>16)+(C.i(b)>>>16);D=v>>>16,S&=65535,v&=65535,$[b]=v<<16|S}return new s($,$[$.length-1]&-2147483648?-1:0)};function T(C,P){return C.add(x(P))}t.j=function(C){if(w(this)||w(C))return y;if(E(this))return E(C)?x(this).j(x(C)):x(x(this).j(C));if(E(C))return x(this.j(x(C)));if(0>this.l(f)&&0>C.l(f))return d(this.m()*C.m());for(var P=this.g.length+C.g.length,$=[],D=0;D<2*P;D++)$[D]=0;for(D=0;D<this.g.length;D++)for(var b=0;b<C.g.length;b++){var S=this.i(D)>>>16,v=this.i(D)&65535,z=C.i(b)>>>16,re=C.i(b)&65535;$[2*D+2*b]+=v*re,Y($,2*D+2*b),$[2*D+2*b+1]+=S*re,Y($,2*D+2*b+1),$[2*D+2*b+1]+=v*z,Y($,2*D+2*b+1),$[2*D+2*b+2]+=S*z,Y($,2*D+2*b+2)}for(D=0;D<P;D++)$[D]=$[2*D+1]<<16|$[2*D];for(D=P;D<2*P;D++)$[D]=0;return new s($,0)};function Y(C,P){for(;(C[P]&65535)!=C[P];)C[P+1]+=C[P]>>>16,C[P]&=65535,P++}function K(C,P){this.g=C,this.h=P}function j(C,P){if(w(P))throw Error("division by zero");if(w(C))return new K(y,y);if(E(C))return P=j(x(C),P),new K(x(P.g),x(P.h));if(E(P))return P=j(C,x(P)),new K(x(P.g),P.h);if(30<C.g.length){if(E(C)||E(P))throw Error("slowDivide_ only works with positive integers.");for(var $=g,D=P;0>=D.l(C);)$=q($),D=q(D);var b=J($,1),S=J(D,1);for(D=J(D,2),$=J($,2);!w(D);){var v=S.add(D);0>=v.l(C)&&(b=b.add($),S=v),D=J(D,1),$=J($,1)}return P=T(C,b.j(P)),new K(b,P)}for(b=y;0<=C.l(P);){for($=Math.max(1,Math.floor(C.m()/P.m())),D=Math.ceil(Math.log($)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),S=d($),v=S.j(P);E(v)||0<v.l(C);)$-=D,S=d($),v=S.j(P);w(S)&&(S=g),b=b.add(S),C=T(C,v)}return new K(b,C)}t.A=function(C){return j(this,C).h},t.and=function(C){for(var P=Math.max(this.g.length,C.g.length),$=[],D=0;D<P;D++)$[D]=this.i(D)&C.i(D);return new s($,this.h&C.h)},t.or=function(C){for(var P=Math.max(this.g.length,C.g.length),$=[],D=0;D<P;D++)$[D]=this.i(D)|C.i(D);return new s($,this.h|C.h)},t.xor=function(C){for(var P=Math.max(this.g.length,C.g.length),$=[],D=0;D<P;D++)$[D]=this.i(D)^C.i(D);return new s($,this.h^C.h)};function q(C){for(var P=C.g.length+1,$=[],D=0;D<P;D++)$[D]=C.i(D)<<1|C.i(D-1)>>>31;return new s($,C.h)}function J(C,P){var $=P>>5;P%=32;for(var D=C.g.length-$,b=[],S=0;S<D;S++)b[S]=0<P?C.i(S+$)>>>P|C.i(S+$+1)<<32-P:C.i(S+$);return new s(b,C.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,$2=n,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=d,s.fromString=u,Va=s}).apply(typeof Sv<"u"?Sv:typeof self<"u"?self:typeof window<"u"?window:{});var Bu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var E2,fd,I2,vh,vf,T2,k2,N2;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(m,te,ue){return m==Array.prototype||m==Object.prototype||(m[te]=ue.value),m};function r(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof Bu=="object"&&Bu];for(var te=0;te<m.length;++te){var ue=m[te];if(ue&&ue.Math==Math)return ue}throw Error("Cannot find global object")}var n=r(this);function i(m,te){if(te)e:{var ue=n;m=m.split(".");for(var Ce=0;Ce<m.length-1;Ce++){var Qe=m[Ce];if(!(Qe in ue))break e;ue=ue[Qe]}m=m[m.length-1],Ce=ue[m],te=te(Ce),te!=Ce&&te!=null&&e(ue,m,{configurable:!0,writable:!0,value:te})}}function o(m,te){m instanceof String&&(m+="");var ue=0,Ce=!1,Qe={next:function(){if(!Ce&&ue<m.length){var ct=ue++;return{value:te(ct,m[ct]),done:!1}}return Ce=!0,{done:!0,value:void 0}}};return Qe[Symbol.iterator]=function(){return Qe},Qe}i("Array.prototype.values",function(m){return m||function(){return o(this,function(te,ue){return ue})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},l=this||self;function c(m){var te=typeof m;return te=te!="object"?te:m?Array.isArray(m)?"array":te:"null",te=="array"||te=="object"&&typeof m.length=="number"}function d(m){var te=typeof m;return te=="object"&&m!=null||te=="function"}function u(m,te,ue){return m.call.apply(m.bind,arguments)}function y(m,te,ue){if(!m)throw Error();if(2<arguments.length){var Ce=Array.prototype.slice.call(arguments,2);return function(){var Qe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Qe,Ce),m.apply(te,Qe)}}return function(){return m.apply(te,arguments)}}function g(m,te,ue){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:y,g.apply(null,arguments)}function f(m,te){var ue=Array.prototype.slice.call(arguments,1);return function(){var Ce=ue.slice();return Ce.push.apply(Ce,arguments),m.apply(this,Ce)}}function w(m,te){function ue(){}ue.prototype=te.prototype,m.aa=te.prototype,m.prototype=new ue,m.prototype.constructor=m,m.Qb=function(Ce,Qe,ct){for(var Ot=Array(arguments.length-2),Fr=2;Fr<arguments.length;Fr++)Ot[Fr-2]=arguments[Fr];return te.prototype[Qe].apply(Ce,Ot)}}function E(m){const te=m.length;if(0<te){const ue=Array(te);for(let Ce=0;Ce<te;Ce++)ue[Ce]=m[Ce];return ue}return[]}function x(m,te){for(let ue=1;ue<arguments.length;ue++){const Ce=arguments[ue];if(c(Ce)){const Qe=m.length||0,ct=Ce.length||0;m.length=Qe+ct;for(let Ot=0;Ot<ct;Ot++)m[Qe+Ot]=Ce[Ot]}else m.push(Ce)}}class T{constructor(te,ue){this.i=te,this.j=ue,this.h=0,this.g=null}get(){let te;return 0<this.h?(this.h--,te=this.g,this.g=te.next,te.next=null):te=this.i(),te}}function Y(m){return/^[\s\xa0]*$/.test(m)}function K(){var m=l.navigator;return m&&(m=m.userAgent)?m:""}function j(m){return j[" "](m),m}j[" "]=function(){};var q=K().indexOf("Gecko")!=-1&&!(K().toLowerCase().indexOf("webkit")!=-1&&K().indexOf("Edge")==-1)&&!(K().indexOf("Trident")!=-1||K().indexOf("MSIE")!=-1)&&K().indexOf("Edge")==-1;function J(m,te,ue){for(const Ce in m)te.call(ue,m[Ce],Ce,m)}function C(m,te){for(const ue in m)te.call(void 0,m[ue],ue,m)}function P(m){const te={};for(const ue in m)te[ue]=m[ue];return te}const $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(m,te){let ue,Ce;for(let Qe=1;Qe<arguments.length;Qe++){Ce=arguments[Qe];for(ue in Ce)m[ue]=Ce[ue];for(let ct=0;ct<$.length;ct++)ue=$[ct],Object.prototype.hasOwnProperty.call(Ce,ue)&&(m[ue]=Ce[ue])}}function b(m){var te=1;m=m.split(":");const ue=[];for(;0<te&&m.length;)ue.push(m.shift()),te--;return m.length&&ue.push(m.join(":")),ue}function S(m){l.setTimeout(()=>{throw m},0)}function v(){var m=X;let te=null;return m.g&&(te=m.g,m.g=m.g.next,m.g||(m.h=null),te.next=null),te}class z{constructor(){this.h=this.g=null}add(te,ue){const Ce=re.get();Ce.set(te,ue),this.h?this.h.next=Ce:this.g=Ce,this.h=Ce}}var re=new T(()=>new L,m=>m.reset());class L{constructor(){this.next=this.g=this.h=null}set(te,ue){this.h=te,this.g=ue,this.next=null}reset(){this.next=this.g=this.h=null}}let O,ne=!1,X=new z,W=()=>{const m=l.Promise.resolve(void 0);O=()=>{m.then(se)}};var se=()=>{for(var m;m=v();){try{m.h.call(m.g)}catch(ue){S(ue)}var te=re;te.j(m),100>te.h&&(te.h++,m.next=te.g,te.g=m)}ne=!1};function F(){this.s=this.s,this.C=this.C}F.prototype.s=!1,F.prototype.ma=function(){this.s||(this.s=!0,this.N())},F.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function k(m,te){this.type=m,this.g=this.target=te,this.defaultPrevented=!1}k.prototype.h=function(){this.defaultPrevented=!0};var N=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var m=!1,te=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const ue=()=>{};l.addEventListener("test",ue,te),l.removeEventListener("test",ue,te)}catch{}return m}();function A(m,te){if(k.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m){var ue=this.type=m.type,Ce=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;if(this.target=m.target||m.srcElement,this.g=te,te=m.relatedTarget){if(q){e:{try{j(te.nodeName);var Qe=!0;break e}catch{}Qe=!1}Qe||(te=null)}}else ue=="mouseover"?te=m.fromElement:ue=="mouseout"&&(te=m.toElement);this.relatedTarget=te,Ce?(this.clientX=Ce.clientX!==void 0?Ce.clientX:Ce.pageX,this.clientY=Ce.clientY!==void 0?Ce.clientY:Ce.pageY,this.screenX=Ce.screenX||0,this.screenY=Ce.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=typeof m.pointerType=="string"?m.pointerType:V[m.pointerType]||"",this.state=m.state,this.i=m,m.defaultPrevented&&A.aa.h.call(this)}}w(A,k);var V={2:"touch",3:"pen",4:"mouse"};A.prototype.h=function(){A.aa.h.call(this);var m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var Z="closure_listenable_"+(1e6*Math.random()|0),H=0;function B(m,te,ue,Ce,Qe){this.listener=m,this.proxy=null,this.src=te,this.type=ue,this.capture=!!Ce,this.ha=Qe,this.key=++H,this.da=this.fa=!1}function M(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function G(m){this.src=m,this.g={},this.h=0}G.prototype.add=function(m,te,ue,Ce,Qe){var ct=m.toString();m=this.g[ct],m||(m=this.g[ct]=[],this.h++);var Ot=ie(m,te,Ce,Qe);return-1<Ot?(te=m[Ot],ue||(te.fa=!1)):(te=new B(te,this.src,ct,!!Ce,Qe),te.fa=ue,m.push(te)),te};function Q(m,te){var ue=te.type;if(ue in m.g){var Ce=m.g[ue],Qe=Array.prototype.indexOf.call(Ce,te,void 0),ct;(ct=0<=Qe)&&Array.prototype.splice.call(Ce,Qe,1),ct&&(M(te),m.g[ue].length==0&&(delete m.g[ue],m.h--))}}function ie(m,te,ue,Ce){for(var Qe=0;Qe<m.length;++Qe){var ct=m[Qe];if(!ct.da&&ct.listener==te&&ct.capture==!!ue&&ct.ha==Ce)return Qe}return-1}var me="closure_lm_"+(1e6*Math.random()|0),oe={};function ee(m,te,ue,Ce,Qe){if(Array.isArray(te)){for(var ct=0;ct<te.length;ct++)ee(m,te[ct],ue,Ce,Qe);return null}return ue=Ne(ue),m&&m[Z]?m.K(te,ue,d(Ce)?!!Ce.capture:!1,Qe):de(m,te,ue,!1,Ce,Qe)}function de(m,te,ue,Ce,Qe,ct){if(!te)throw Error("Invalid event type");var Ot=d(Qe)?!!Qe.capture:!!Qe,Fr=ge(m);if(Fr||(m[me]=Fr=new G(m)),ue=Fr.add(te,ue,Ce,Ot,ct),ue.proxy)return ue;if(Ce=he(),ue.proxy=Ce,Ce.src=m,Ce.listener=ue,m.addEventListener)N||(Qe=Ot),Qe===void 0&&(Qe=!1),m.addEventListener(te.toString(),Ce,Qe);else if(m.attachEvent)m.attachEvent(ve(te.toString()),Ce);else if(m.addListener&&m.removeListener)m.addListener(Ce);else throw Error("addEventListener and attachEvent are unavailable.");return ue}function he(){function m(ue){return te.call(m.src,m.listener,ue)}const te=pe;return m}function le(m,te,ue,Ce,Qe){if(Array.isArray(te))for(var ct=0;ct<te.length;ct++)le(m,te[ct],ue,Ce,Qe);else Ce=d(Ce)?!!Ce.capture:!!Ce,ue=Ne(ue),m&&m[Z]?(m=m.i,te=String(te).toString(),te in m.g&&(ct=m.g[te],ue=ie(ct,ue,Ce,Qe),-1<ue&&(M(ct[ue]),Array.prototype.splice.call(ct,ue,1),ct.length==0&&(delete m.g[te],m.h--)))):m&&(m=ge(m))&&(te=m.g[te.toString()],m=-1,te&&(m=ie(te,ue,Ce,Qe)),(ue=-1<m?te[m]:null)&&ye(ue))}function ye(m){if(typeof m!="number"&&m&&!m.da){var te=m.src;if(te&&te[Z])Q(te.i,m);else{var ue=m.type,Ce=m.proxy;te.removeEventListener?te.removeEventListener(ue,Ce,m.capture):te.detachEvent?te.detachEvent(ve(ue),Ce):te.addListener&&te.removeListener&&te.removeListener(Ce),(ue=ge(te))?(Q(ue,m),ue.h==0&&(ue.src=null,te[me]=null)):M(m)}}}function ve(m){return m in oe?oe[m]:oe[m]="on"+m}function pe(m,te){if(m.da)m=!0;else{te=new A(te,this);var ue=m.listener,Ce=m.ha||m.src;m.fa&&ye(m),m=ue.call(Ce,te)}return m}function ge(m){return m=m[me],m instanceof G?m:null}var ke="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ne(m){return typeof m=="function"?m:(m[ke]||(m[ke]=function(te){return m.handleEvent(te)}),m[ke])}function xe(){F.call(this),this.i=new G(this),this.M=this,this.F=null}w(xe,F),xe.prototype[Z]=!0,xe.prototype.removeEventListener=function(m,te,ue,Ce){le(this,m,te,ue,Ce)};function $e(m,te){var ue,Ce=m.F;if(Ce)for(ue=[];Ce;Ce=Ce.F)ue.push(Ce);if(m=m.M,Ce=te.type||te,typeof te=="string")te=new k(te,m);else if(te instanceof k)te.target=te.target||m;else{var Qe=te;te=new k(Ce,m),D(te,Qe)}if(Qe=!0,ue)for(var ct=ue.length-1;0<=ct;ct--){var Ot=te.g=ue[ct];Qe=Ee(Ot,Ce,!0,te)&&Qe}if(Ot=te.g=m,Qe=Ee(Ot,Ce,!0,te)&&Qe,Qe=Ee(Ot,Ce,!1,te)&&Qe,ue)for(ct=0;ct<ue.length;ct++)Ot=te.g=ue[ct],Qe=Ee(Ot,Ce,!1,te)&&Qe}xe.prototype.N=function(){if(xe.aa.N.call(this),this.i){var m=this.i,te;for(te in m.g){for(var ue=m.g[te],Ce=0;Ce<ue.length;Ce++)M(ue[Ce]);delete m.g[te],m.h--}}this.F=null},xe.prototype.K=function(m,te,ue,Ce){return this.i.add(String(m),te,!1,ue,Ce)},xe.prototype.L=function(m,te,ue,Ce){return this.i.add(String(m),te,!0,ue,Ce)};function Ee(m,te,ue,Ce){if(te=m.i.g[String(te)],!te)return!0;te=te.concat();for(var Qe=!0,ct=0;ct<te.length;++ct){var Ot=te[ct];if(Ot&&!Ot.da&&Ot.capture==ue){var Fr=Ot.listener,tn=Ot.ha||Ot.src;Ot.fa&&Q(m.i,Ot),Qe=Fr.call(tn,Ce)!==!1&&Qe}}return Qe&&!Ce.defaultPrevented}function Me(m,te,ue){if(typeof m=="function")ue&&(m=g(m,ue));else if(m&&typeof m.handleEvent=="function")m=g(m.handleEvent,m);else throw Error("Invalid listener argument");return 2147483647<Number(te)?-1:l.setTimeout(m,te||0)}function Ye(m){m.g=Me(()=>{m.g=null,m.i&&(m.i=!1,Ye(m))},m.l);const te=m.h;m.h=null,m.m.apply(null,te)}class ze extends F{constructor(te,ue){super(),this.m=te,this.l=ue,this.h=null,this.i=!1,this.g=null}j(te){this.h=arguments,this.g?this.i=!0:Ye(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function je(m){F.call(this),this.h=m,this.g={}}w(je,F);var Xe=[];function ht(m){J(m.g,function(te,ue){this.g.hasOwnProperty(ue)&&ye(te)},m),m.g={}}je.prototype.N=function(){je.aa.N.call(this),ht(this)},je.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ut=l.JSON.stringify,Ue=l.JSON.parse,it=class{stringify(m){return l.JSON.stringify(m,void 0)}parse(m){return l.JSON.parse(m,void 0)}};function dt(){}dt.prototype.h=null;function Fe(m){return m.h||(m.h=m.i())}function Be(){}var Re={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function lt(){k.call(this,"d")}w(lt,k);function ot(){k.call(this,"c")}w(ot,k);var nt={},Ve=null;function qt(){return Ve=Ve||new xe}nt.La="serverreachability";function Mt(m){k.call(this,nt.La,m)}w(Mt,k);function Qt(m){const te=qt();$e(te,new Mt(te))}nt.STAT_EVENT="statevent";function lr(m,te){k.call(this,nt.STAT_EVENT,m),this.stat=te}w(lr,k);function bt(m){const te=qt();$e(te,new lr(te,m))}nt.Ma="timingevent";function yr(m,te){k.call(this,nt.Ma,m),this.size=te}w(yr,k);function Cr(m,te){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){m()},te)}function Kt(){this.g=!0}Kt.prototype.xa=function(){this.g=!1};function sr(m,te,ue,Ce,Qe,ct){m.info(function(){if(m.g)if(ct)for(var Ot="",Fr=ct.split("&"),tn=0;tn<Fr.length;tn++){var Or=Fr[tn].split("=");if(1<Or.length){var fn=Or[0];Or=Or[1];var xn=fn.split("_");Ot=2<=xn.length&&xn[1]=="type"?Ot+(fn+"="+Or+"&"):Ot+(fn+"=redacted&")}}else Ot=null;else Ot=ct;return"XMLHTTP REQ ("+Ce+") [attempt "+Qe+"]: "+te+`
`+ue+`
`+Ot})}function pt(m,te,ue,Ce,Qe,ct,Ot){m.info(function(){return"XMLHTTP RESP ("+Ce+") [ attempt "+Qe+"]: "+te+`
`+ue+`
`+ct+" "+Ot})}function gt(m,te,ue,Ce){m.info(function(){return"XMLHTTP TEXT ("+te+"): "+gr(m,ue)+(Ce?" "+Ce:"")})}function Vt(m,te){m.info(function(){return"TIMEOUT: "+te})}Kt.prototype.info=function(){};function gr(m,te){if(!m.g)return te;if(!te)return null;try{var ue=JSON.parse(te);if(ue){for(m=0;m<ue.length;m++)if(Array.isArray(ue[m])){var Ce=ue[m];if(!(2>Ce.length)){var Qe=Ce[1];if(Array.isArray(Qe)&&!(1>Qe.length)){var ct=Qe[0];if(ct!="noop"&&ct!="stop"&&ct!="close")for(var Ot=1;Ot<Qe.length;Ot++)Qe[Ot]=""}}}}return ut(ue)}catch{return te}}var et={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ft={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},At;function Yt(){}w(Yt,dt),Yt.prototype.g=function(){return new XMLHttpRequest},Yt.prototype.i=function(){return{}},At=new Yt;function hr(m,te,ue,Ce){this.j=m,this.i=te,this.l=ue,this.R=Ce||1,this.U=new je(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Pr}function Pr(){this.i=null,this.g="",this.h=!1}var Jr={},Tr={};function zr(m,te,ue){m.L=1,m.v=Wr(vt(te)),m.m=ue,m.P=!0,Xr(m,null)}function Xr(m,te){m.F=Date.now(),Yr(m),m.A=vt(m.v);var ue=m.A,Ce=m.R;Array.isArray(Ce)||(Ce=[String(Ce)]),Sr(ue.i,"t",Ce),m.C=0,ue=m.j.J,m.h=new Pr,m.g=be(m.j,ue?te:null,!m.m),0<m.O&&(m.M=new ze(g(m.Y,m,m.g),m.O)),te=m.U,ue=m.g,Ce=m.ca;var Qe="readystatechange";Array.isArray(Qe)||(Qe&&(Xe[0]=Qe.toString()),Qe=Xe);for(var ct=0;ct<Qe.length;ct++){var Ot=ee(ue,Qe[ct],Ce||te.handleEvent,!1,te.h||te);if(!Ot)break;te.g[Ot.key]=Ot}te=m.H?P(m.H):{},m.m?(m.u||(m.u="POST"),te["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.A,m.u,m.m,te)):(m.u="GET",m.g.ea(m.A,m.u,null,te)),Qt(),sr(m.i,m.u,m.A,m.l,m.R,m.m)}hr.prototype.ca=function(m){m=m.target;const te=this.M;te&&ai(m)==3?te.j():this.Y(m)},hr.prototype.Y=function(m){try{if(m==this.g)e:{const xn=ai(this.g);var te=this.g.Ba();const Bo=this.g.Z();if(!(3>xn)&&(xn!=3||this.g&&(this.h.h||this.g.oa()||zl(this.g)))){this.J||xn!=4||te==7||(te==8||0>=Bo?Qt(3):Qt(2)),We(this);var ue=this.g.Z();this.X=ue;t:if(pr(this)){var Ce=zl(this.g);m="";var Qe=Ce.length,ct=ai(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ft(this),Bt(this);var Ot="";break t}this.h.i=new l.TextDecoder}for(te=0;te<Qe;te++)this.h.h=!0,m+=this.h.i.decode(Ce[te],{stream:!(ct&&te==Qe-1)});Ce.length=0,this.h.g+=m,this.C=0,Ot=this.h.g}else Ot=this.g.oa();if(this.o=ue==200,pt(this.i,this.u,this.A,this.l,this.R,xn,ue),this.o){if(this.T&&!this.K){t:{if(this.g){var Fr,tn=this.g;if((Fr=tn.g?tn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Y(Fr)){var Or=Fr;break t}}Or=null}if(ue=Or)gt(this.i,this.l,ue,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ht(this,ue);else{this.o=!1,this.s=3,bt(12),Ft(this),Bt(this);break e}}if(this.P){ue=!0;let vi;for(;!this.J&&this.C<Ot.length;)if(vi=Jt(this,Ot),vi==Tr){xn==4&&(this.s=4,bt(14),ue=!1),gt(this.i,this.l,null,"[Incomplete Response]");break}else if(vi==Jr){this.s=4,bt(15),gt(this.i,this.l,Ot,"[Invalid Chunk]"),ue=!1;break}else gt(this.i,this.l,vi,null),Ht(this,vi);if(pr(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),xn!=4||Ot.length!=0||this.h.h||(this.s=1,bt(16),ue=!1),this.o=this.o&&ue,!ue)gt(this.i,this.l,Ot,"[Invalid Chunked Response]"),Ft(this),Bt(this);else if(0<Ot.length&&!this.W){this.W=!0;var fn=this.j;fn.g==this&&fn.ba&&!fn.M&&(fn.j.info("Great, no buffering proxy detected. Bytes received: "+Ot.length),ca(fn),fn.M=!0,bt(11))}}else gt(this.i,this.l,Ot,null),Ht(this,Ot);xn==4&&Ft(this),this.o&&!this.J&&(xn==4?ns(this.j,this):(this.o=!1,Yr(this)))}else ts(this.g),ue==400&&0<Ot.indexOf("Unknown SID")?(this.s=3,bt(12)):(this.s=0,bt(13)),Ft(this),Bt(this)}}}catch{}finally{}};function pr(m){return m.g?m.u=="GET"&&m.L!=2&&m.j.Ca:!1}function Jt(m,te){var ue=m.C,Ce=te.indexOf(`
`,ue);return Ce==-1?Tr:(ue=Number(te.substring(ue,Ce)),isNaN(ue)?Jr:(Ce+=1,Ce+ue>te.length?Tr:(te=te.slice(Ce,Ce+ue),m.C=Ce+ue,te)))}hr.prototype.cancel=function(){this.J=!0,Ft(this)};function Yr(m){m.S=Date.now()+m.I,Lr(m,m.I)}function Lr(m,te){if(m.B!=null)throw Error("WatchDog timer not null");m.B=Cr(g(m.ba,m),te)}function We(m){m.B&&(l.clearTimeout(m.B),m.B=null)}hr.prototype.ba=function(){this.B=null;const m=Date.now();0<=m-this.S?(Vt(this.i,this.A),this.L!=2&&(Qt(),bt(17)),Ft(this),this.s=2,Bt(this)):Lr(this,this.S-m)};function Bt(m){m.j.G==0||m.J||ns(m.j,m)}function Ft(m){We(m);var te=m.M;te&&typeof te.ma=="function"&&te.ma(),m.M=null,ht(m.U),m.g&&(te=m.g,m.g=null,te.abort(),te.ma())}function Ht(m,te){try{var ue=m.j;if(ue.G!=0&&(ue.g==m||Hr(ue.h,m))){if(!m.K&&Hr(ue.h,m)&&ue.G==3){try{var Ce=ue.Da.g.parse(te)}catch{Ce=null}if(Array.isArray(Ce)&&Ce.length==3){var Qe=Ce;if(Qe[0]==0){e:if(!ue.u){if(ue.g)if(ue.g.F+3e3<m.F)Oo(ue),oa(ue);else break e;Es(ue),bt(18)}}else ue.za=Qe[1],0<ue.za-ue.T&&37500>Qe[2]&&ue.F&&ue.v==0&&!ue.C&&(ue.C=Cr(g(ue.Za,ue),6e3));if(1>=xr(ue.h)&&ue.ca){try{ue.ca()}catch{}ue.ca=void 0}}else Ii(ue,11)}else if((m.K||ue.g==m)&&Oo(ue),!Y(te))for(Qe=ue.Da.g.parse(te),te=0;te<Qe.length;te++){let Or=Qe[te];if(ue.T=Or[0],Or=Or[1],ue.G==2)if(Or[0]=="c"){ue.K=Or[1],ue.ia=Or[2];const fn=Or[3];fn!=null&&(ue.la=fn,ue.j.info("VER="+ue.la));const xn=Or[4];xn!=null&&(ue.Aa=xn,ue.j.info("SVER="+ue.Aa));const Bo=Or[5];Bo!=null&&typeof Bo=="number"&&0<Bo&&(Ce=1.5*Bo,ue.L=Ce,ue.j.info("backChannelRequestTimeoutMs_="+Ce)),Ce=ue;const vi=m.g;if(vi){const is=vi.g?vi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(is){var ct=Ce.h;ct.g||is.indexOf("spdy")==-1&&is.indexOf("quic")==-1&&is.indexOf("h2")==-1||(ct.j=ct.l,ct.g=new Set,ct.h&&(mr(ct,ct.h),ct.h=null))}if(Ce.D){const os=vi.g?vi.g.getResponseHeader("X-HTTP-Session-Id"):null;os&&(Ce.ya=os,cr(Ce.I,Ce.D,os))}}ue.G=3,ue.l&&ue.l.ua(),ue.ba&&(ue.R=Date.now()-m.F,ue.j.info("Handshake RTT: "+ue.R+"ms")),Ce=ue;var Ot=m;if(Ce.qa=R(Ce,Ce.J?Ce.ia:null,Ce.W),Ot.K){Vr(Ce.h,Ot);var Fr=Ot,tn=Ce.L;tn&&(Fr.I=tn),Fr.B&&(We(Fr),Yr(Fr)),Ce.g=Ot}else la(Ce);0<ue.i.length&&sa(ue)}else Or[0]!="stop"&&Or[0]!="close"||Ii(ue,7);else ue.G==3&&(Or[0]=="stop"||Or[0]=="close"?Or[0]=="stop"?Ii(ue,7):Fo(ue):Or[0]!="noop"&&ue.l&&ue.l.ta(Or),ue.v=0)}}Qt(4)}catch{}}var Ke=class{constructor(m,te){this.g=m,this.map=te}};function Zt(m){this.l=m||10,l.PerformanceNavigationTiming?(m=l.performance.getEntriesByType("navigation"),m=0<m.length&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Wt(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function xr(m){return m.h?1:m.g?m.g.size:0}function Hr(m,te){return m.h?m.h==te:m.g?m.g.has(te):!1}function mr(m,te){m.g?m.g.add(te):m.h=te}function Vr(m,te){m.h&&m.h==te?m.h=null:m.g&&m.g.has(te)&&m.g.delete(te)}Zt.prototype.cancel=function(){if(this.i=Qr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function Qr(m){if(m.h!=null)return m.i.concat(m.h.D);if(m.g!=null&&m.g.size!==0){let te=m.i;for(const ue of m.g.values())te=te.concat(ue.D);return te}return E(m.i)}function hn(m){if(m.V&&typeof m.V=="function")return m.V();if(typeof Map<"u"&&m instanceof Map||typeof Set<"u"&&m instanceof Set)return Array.from(m.values());if(typeof m=="string")return m.split("");if(c(m)){for(var te=[],ue=m.length,Ce=0;Ce<ue;Ce++)te.push(m[Ce]);return te}te=[],ue=0;for(Ce in m)te[ue++]=m[Ce];return te}function Nt(m){if(m.na&&typeof m.na=="function")return m.na();if(!m.V||typeof m.V!="function"){if(typeof Map<"u"&&m instanceof Map)return Array.from(m.keys());if(!(typeof Set<"u"&&m instanceof Set)){if(c(m)||typeof m=="string"){var te=[];m=m.length;for(var ue=0;ue<m;ue++)te.push(ue);return te}te=[],ue=0;for(const Ce in m)te[ue++]=Ce;return te}}}function tr(m,te){if(m.forEach&&typeof m.forEach=="function")m.forEach(te,void 0);else if(c(m)||typeof m=="string")Array.prototype.forEach.call(m,te,void 0);else for(var ue=Nt(m),Ce=hn(m),Qe=Ce.length,ct=0;ct<Qe;ct++)te.call(void 0,Ce[ct],ue&&ue[ct],m)}var ur=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ar(m,te){if(m){m=m.split("&");for(var ue=0;ue<m.length;ue++){var Ce=m[ue].indexOf("="),Qe=null;if(0<=Ce){var ct=m[ue].substring(0,Ce);Qe=m[ue].substring(Ce+1)}else ct=m[ue];te(ct,Qe?decodeURIComponent(Qe.replace(/\+/g," ")):"")}}}function Rt(m){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,m instanceof Rt){this.h=m.h,St(this,m.j),this.o=m.o,this.g=m.g,jt(this,m.s),this.l=m.l;var te=m.i,ue=new ei;ue.i=te.i,te.g&&(ue.g=new Map(te.g),ue.h=te.h),Et(this,ue),this.m=m.m}else m&&(te=String(m).match(ur))?(this.h=!1,St(this,te[1]||"",!0),this.o=Kr(te[2]||""),this.g=Kr(te[3]||"",!0),jt(this,te[4]),this.l=Kr(te[5]||"",!0),Et(this,te[6]||"",!0),this.m=Kr(te[7]||"")):(this.h=!1,this.i=new ei(null,this.h))}Rt.prototype.toString=function(){var m=[],te=this.j;te&&m.push(Zr(te,Mn,!0),":");var ue=this.g;return(ue||te=="file")&&(m.push("//"),(te=this.o)&&m.push(Zr(te,Mn,!0),"@"),m.push(encodeURIComponent(String(ue)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),ue=this.s,ue!=null&&m.push(":",String(ue))),(ue=this.l)&&(this.g&&ue.charAt(0)!="/"&&m.push("/"),m.push(Zr(ue,ue.charAt(0)=="/"?en:Ln,!0))),(ue=this.i.toString())&&m.push("?",ue),(ue=this.m)&&m.push("#",Zr(ue,nr)),m.join("")};function vt(m){return new Rt(m)}function St(m,te,ue){m.j=ue?Kr(te,!0):te,m.j&&(m.j=m.j.replace(/:$/,""))}function jt(m,te){if(te){if(te=Number(te),isNaN(te)||0>te)throw Error("Bad port number "+te);m.s=te}else m.s=null}function Et(m,te,ue){te instanceof ei?(m.i=te,Do(m.i,m.h)):(ue||(te=Zr(te,wn)),m.i=new ei(te,m.h))}function cr(m,te,ue){m.i.set(te,ue)}function Wr(m){return cr(m,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),m}function Kr(m,te){return m?te?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function Zr(m,te,ue){return typeof m=="string"?(m=encodeURI(m).replace(te,qn),ue&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function qn(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var Mn=/[#\/\?@]/g,Ln=/[#\?:]/g,en=/[#\?]/g,wn=/[#\?@]/g,nr=/#/g;function ei(m,te){this.h=this.g=null,this.i=m||null,this.j=!!te}function pn(m){m.g||(m.g=new Map,m.h=0,m.i&&Ar(m.i,function(te,ue){m.add(decodeURIComponent(te.replace(/\+/g," ")),ue)}))}t=ei.prototype,t.add=function(m,te){pn(this),this.i=null,m=$i(this,m);var ue=this.g.get(m);return ue||this.g.set(m,ue=[]),ue.push(te),this.h+=1,this};function So(m,te){pn(m),te=$i(m,te),m.g.has(te)&&(m.i=null,m.h-=m.g.get(te).length,m.g.delete(te))}function co(m,te){return pn(m),te=$i(m,te),m.g.has(te)}t.forEach=function(m,te){pn(this),this.g.forEach(function(ue,Ce){ue.forEach(function(Qe){m.call(te,Qe,Ce,this)},this)},this)},t.na=function(){pn(this);const m=Array.from(this.g.values()),te=Array.from(this.g.keys()),ue=[];for(let Ce=0;Ce<te.length;Ce++){const Qe=m[Ce];for(let ct=0;ct<Qe.length;ct++)ue.push(te[Ce])}return ue},t.V=function(m){pn(this);let te=[];if(typeof m=="string")co(this,m)&&(te=te.concat(this.g.get($i(this,m))));else{m=Array.from(this.g.values());for(let ue=0;ue<m.length;ue++)te=te.concat(m[ue])}return te},t.set=function(m,te){return pn(this),this.i=null,m=$i(this,m),co(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[te]),this.h+=1,this},t.get=function(m,te){return m?(m=this.V(m),0<m.length?String(m[0]):te):te};function Sr(m,te,ue){So(m,te),0<ue.length&&(m.i=null,m.g.set($i(m,te),E(ue)),m.h+=ue.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],te=Array.from(this.g.keys());for(var ue=0;ue<te.length;ue++){var Ce=te[ue];const ct=encodeURIComponent(String(Ce)),Ot=this.V(Ce);for(Ce=0;Ce<Ot.length;Ce++){var Qe=ct;Ot[Ce]!==""&&(Qe+="="+encodeURIComponent(String(Ot[Ce]))),m.push(Qe)}}return this.i=m.join("&")};function $i(m,te){return te=String(te),m.j&&(te=te.toLowerCase()),te}function Do(m,te){te&&!m.j&&(pn(m),m.i=null,m.g.forEach(function(ue,Ce){var Qe=Ce.toLowerCase();Ce!=Qe&&(So(this,Ce),Sr(this,Qe,ue))},m)),m.j=te}function Ei(m,te){const ue=new Kt;if(l.Image){const Ce=new Image;Ce.onload=f(yi,ue,"TestLoadImage: loaded",!0,te,Ce),Ce.onerror=f(yi,ue,"TestLoadImage: error",!1,te,Ce),Ce.onabort=f(yi,ue,"TestLoadImage: abort",!1,te,Ce),Ce.ontimeout=f(yi,ue,"TestLoadImage: timeout",!1,te,Ce),l.setTimeout(function(){Ce.ontimeout&&Ce.ontimeout()},1e4),Ce.src=m}else te(!1)}function Xo(m,te){const ue=new Kt,Ce=new AbortController,Qe=setTimeout(()=>{Ce.abort(),yi(ue,"TestPingServer: timeout",!1,te)},1e4);fetch(m,{signal:Ce.signal}).then(ct=>{clearTimeout(Qe),ct.ok?yi(ue,"TestPingServer: ok",!0,te):yi(ue,"TestPingServer: server error",!1,te)}).catch(()=>{clearTimeout(Qe),yi(ue,"TestPingServer: error",!1,te)})}function yi(m,te,ue,Ce,Qe){try{Qe&&(Qe.onload=null,Qe.onerror=null,Qe.onabort=null,Qe.ontimeout=null),Ce(ue)}catch{}}function wo(){this.g=new it}function xs(m,te,ue){const Ce=ue||"";try{tr(m,function(Qe,ct){let Ot=Qe;d(Qe)&&(Ot=ut(Qe)),te.push(Ce+ct+"="+encodeURIComponent(Ot))})}catch(Qe){throw te.push(Ce+"type="+encodeURIComponent("_badmap")),Qe}}function Zo(m){this.l=m.Ub||null,this.j=m.eb||!1}w(Zo,dt),Zo.prototype.g=function(){return new es(this.l,this.j)},Zo.prototype.i=function(m){return function(){return m}}({});function es(m,te){xe.call(this),this.D=m,this.o=te,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(es,xe),t=es.prototype,t.open=function(m,te){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=m,this.A=te,this.readyState=1,Ui(this)},t.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const te={headers:this.u,method:this.B,credentials:this.m,cache:void 0};m&&(te.body=m),(this.D||l).fetch(new Request(this.A,te)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,uo(this)),this.readyState=0},t.Sa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,Ui(this)),this.g&&(this.readyState=3,Ui(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ra(this)}else m.text().then(this.Ra.bind(this),this.ga.bind(this))};function ra(m){m.j.read().then(m.Pa.bind(m)).catch(m.ga.bind(m))}t.Pa=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var te=m.value?m.value:new Uint8Array(0);(te=this.v.decode(te,{stream:!m.done}))&&(this.response=this.responseText+=te)}m.done?uo(this):Ui(this),this.readyState==3&&ra(this)}},t.Ra=function(m){this.g&&(this.response=this.responseText=m,uo(this))},t.Qa=function(m){this.g&&(this.response=m,uo(this))},t.ga=function(){this.g&&uo(this)};function uo(m){m.readyState=4,m.l=null,m.j=null,m.v=null,Ui(m)}t.setRequestHeader=function(m,te){this.u.append(m,te)},t.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],te=this.h.entries();for(var ue=te.next();!ue.done;)ue=ue.value,m.push(ue[0]+": "+ue[1]),ue=te.next();return m.join(`\r
`)};function Ui(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(es.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function ho(m){let te="";return J(m,function(ue,Ce){te+=Ce,te+=":",te+=ue,te+=`\r
`}),te}function Mo(m,te,ue){e:{for(Ce in ue){var Ce=!1;break e}Ce=!0}Ce||(ue=ho(ue),typeof m=="string"?ue!=null&&encodeURIComponent(String(ue)):cr(m,te,ue))}function an(m){xe.call(this),this.headers=new Map,this.o=m||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(an,xe);var el=/^https?$/i,na=["POST","PUT"];t=an.prototype,t.Ha=function(m){this.J=m},t.ea=function(m,te,ue,Ce){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);te=te?te.toUpperCase():"GET",this.D=m,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():At.g(),this.v=this.o?Fe(this.o):Fe(At),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(te,String(m),!0),this.B=!1}catch(ct){tl(this,ct);return}if(m=ue||"",ue=new Map(this.headers),Ce)if(Object.getPrototypeOf(Ce)===Object.prototype)for(var Qe in Ce)ue.set(Qe,Ce[Qe]);else if(typeof Ce.keys=="function"&&typeof Ce.get=="function")for(const ct of Ce.keys())ue.set(ct,Ce.get(ct));else throw Error("Unknown input type for opt_headers: "+String(Ce));Ce=Array.from(ue.keys()).find(ct=>ct.toLowerCase()=="content-type"),Qe=l.FormData&&m instanceof l.FormData,!(0<=Array.prototype.indexOf.call(na,te,void 0))||Ce||Qe||ue.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ct,Ot]of ue)this.g.setRequestHeader(ct,Ot);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{po(this),this.u=!0,this.g.send(m),this.u=!1}catch(ct){tl(this,ct)}};function tl(m,te){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=te,m.m=5,rl(m),Cs(m)}function rl(m){m.A||(m.A=!0,$e(m,"complete"),$e(m,"error"))}t.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=m||7,$e(this,"complete"),$e(this,"abort"),Cs(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Cs(this,!0)),an.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?nl(this):this.bb())},t.bb=function(){nl(this)};function nl(m){if(m.h&&typeof s<"u"&&(!m.v[1]||ai(m)!=4||m.Z()!=2)){if(m.u&&ai(m)==4)Me(m.Ea,0,m);else if($e(m,"readystatechange"),ai(m)==4){m.h=!1;try{const Ot=m.Z();e:switch(Ot){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var te=!0;break e;default:te=!1}var ue;if(!(ue=te)){var Ce;if(Ce=Ot===0){var Qe=String(m.D).match(ur)[1]||null;!Qe&&l.self&&l.self.location&&(Qe=l.self.location.protocol.slice(0,-1)),Ce=!el.test(Qe?Qe.toLowerCase():"")}ue=Ce}if(ue)$e(m,"complete"),$e(m,"success");else{m.m=6;try{var ct=2<ai(m)?m.g.statusText:""}catch{ct=""}m.l=ct+" ["+m.Z()+"]",rl(m)}}finally{Cs(m)}}}}function Cs(m,te){if(m.g){po(m);const ue=m.g,Ce=m.v[0]?()=>{}:null;m.g=null,m.v=null,te||$e(m,"ready");try{ue.onreadystatechange=Ce}catch{}}}function po(m){m.I&&(l.clearTimeout(m.I),m.I=null)}t.isActive=function(){return!!this.g};function ai(m){return m.g?m.g.readyState:0}t.Z=function(){try{return 2<ai(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(m){if(this.g){var te=this.g.responseText;return m&&te.indexOf(m)==0&&(te=te.substring(m.length)),Ue(te)}};function zl(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.H){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function ts(m){const te={};m=(m.g&&2<=ai(m)&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let Ce=0;Ce<m.length;Ce++){if(Y(m[Ce]))continue;var ue=b(m[Ce]);const Qe=ue[0];if(ue=ue[1],typeof ue!="string")continue;ue=ue.trim();const ct=te[Qe]||[];te[Qe]=ct,ct.push(ue)}C(te,function(Ce){return Ce.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function gi(m,te,ue){return ue&&ue.internalChannelParams&&ue.internalChannelParams[m]||te}function ia(m){this.Aa=0,this.i=[],this.j=new Kt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=gi("failFast",!1,m),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=gi("baseRetryDelayMs",5e3,m),this.cb=gi("retryDelaySeedMs",1e4,m),this.Wa=gi("forwardChannelMaxRetries",2,m),this.wa=gi("forwardChannelRequestTimeoutMs",2e4,m),this.pa=m&&m.xmlHttpFactory||void 0,this.Xa=m&&m.Tb||void 0,this.Ca=m&&m.useFetchStreams||!1,this.L=void 0,this.J=m&&m.supportsCrossDomainXhr||!1,this.K="",this.h=new Zt(m&&m.concurrentRequestLimit),this.Da=new wo,this.P=m&&m.fastHandshake||!1,this.O=m&&m.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=m&&m.Rb||!1,m&&m.xa&&this.j.xa(),m&&m.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&m&&m.detectBufferingProxy||!1,this.ja=void 0,m&&m.longPollingTimeout&&0<m.longPollingTimeout&&(this.ja=m.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=ia.prototype,t.la=8,t.G=1,t.connect=function(m,te,ue,Ce){bt(0),this.W=m,this.H=te||{},ue&&Ce!==void 0&&(this.H.OSID=ue,this.H.OAID=Ce),this.F=this.X,this.I=R(this,null,this.W),sa(this)};function Fo(m){if(As(m),m.G==3){var te=m.U++,ue=vt(m.I);if(cr(ue,"SID",m.K),cr(ue,"RID",te),cr(ue,"TYPE","terminate"),rs(m,ue),te=new hr(m,m.j,te),te.L=2,te.v=Wr(vt(ue)),ue=!1,l.navigator&&l.navigator.sendBeacon)try{ue=l.navigator.sendBeacon(te.v.toString(),"")}catch{}!ue&&l.Image&&(new Image().src=te.v,ue=!0),ue||(te.g=be(te.j,null),te.g.ea(te.v)),te.F=Date.now(),Yr(te)}ua(m)}function oa(m){m.g&&(ca(m),m.g.cancel(),m.g=null)}function As(m){oa(m),m.u&&(l.clearTimeout(m.u),m.u=null),Oo(m),m.h.cancel(),m.s&&(typeof m.s=="number"&&l.clearTimeout(m.s),m.s=null)}function sa(m){if(!Wt(m.h)&&!m.s){m.s=!0;var te=m.Ga;O||W(),ne||(O(),ne=!0),X.add(te,m),m.B=0}}function il(m,te){return xr(m.h)>=m.h.j-(m.s?1:0)?!1:m.s?(m.i=te.D.concat(m.i),!0):m.G==1||m.G==2||m.B>=(m.Va?0:m.Wa)?!1:(m.s=Cr(g(m.Ga,m,te),da(m,m.B)),m.B++,!0)}t.Ga=function(m){if(this.s)if(this.s=null,this.G==1){if(!m){this.U=Math.floor(1e5*Math.random()),m=this.U++;const Qe=new hr(this,this.j,m);let ct=this.o;if(this.S&&(ct?(ct=P(ct),D(ct,this.S)):ct=this.S),this.m!==null||this.O||(Qe.H=ct,ct=null),this.P)e:{for(var te=0,ue=0;ue<this.i.length;ue++){t:{var Ce=this.i[ue];if("__data__"in Ce.map&&(Ce=Ce.map.__data__,typeof Ce=="string")){Ce=Ce.length;break t}Ce=void 0}if(Ce===void 0)break;if(te+=Ce,4096<te){te=ue;break e}if(te===4096||ue===this.i.length-1){te=ue+1;break e}}te=1e3}else te=1e3;te=$s(this,Qe,te),ue=vt(this.I),cr(ue,"RID",m),cr(ue,"CVER",22),this.D&&cr(ue,"X-HTTP-Session-Id",this.D),rs(this,ue),ct&&(this.O?te="headers="+encodeURIComponent(String(ho(ct)))+"&"+te:this.m&&Mo(ue,this.m,ct)),mr(this.h,Qe),this.Ua&&cr(ue,"TYPE","init"),this.P?(cr(ue,"$req",te),cr(ue,"SID","null"),Qe.T=!0,zr(Qe,ue,null)):zr(Qe,ue,te),this.G=2}}else this.G==3&&(m?aa(this,m):this.i.length==0||Wt(this.h)||aa(this))};function aa(m,te){var ue;te?ue=te.l:ue=m.U++;const Ce=vt(m.I);cr(Ce,"SID",m.K),cr(Ce,"RID",ue),cr(Ce,"AID",m.T),rs(m,Ce),m.m&&m.o&&Mo(Ce,m.m,m.o),ue=new hr(m,m.j,ue,m.B+1),m.m===null&&(ue.H=m.o),te&&(m.i=te.D.concat(m.i)),te=$s(m,ue,1e3),ue.I=Math.round(.5*m.wa)+Math.round(.5*m.wa*Math.random()),mr(m.h,ue),zr(ue,Ce,te)}function rs(m,te){m.H&&J(m.H,function(ue,Ce){cr(te,Ce,ue)}),m.l&&tr({},function(ue,Ce){cr(te,Ce,ue)})}function $s(m,te,ue){ue=Math.min(m.i.length,ue);var Ce=m.l?g(m.l.Na,m.l,m):null;e:{var Qe=m.i;let ct=-1;for(;;){const Ot=["count="+ue];ct==-1?0<ue?(ct=Qe[0].g,Ot.push("ofs="+ct)):ct=0:Ot.push("ofs="+ct);let Fr=!0;for(let tn=0;tn<ue;tn++){let Or=Qe[tn].g;const fn=Qe[tn].map;if(Or-=ct,0>Or)ct=Math.max(0,Qe[tn].g-100),Fr=!1;else try{xs(fn,Ot,"req"+Or+"_")}catch{Ce&&Ce(fn)}}if(Fr){Ce=Ot.join("&");break e}}}return m=m.i.splice(0,ue),te.D=m,Ce}function la(m){if(!m.g&&!m.u){m.Y=1;var te=m.Fa;O||W(),ne||(O(),ne=!0),X.add(te,m),m.v=0}}function Es(m){return m.g||m.u||3<=m.v?!1:(m.Y++,m.u=Cr(g(m.Fa,m),da(m,m.v)),m.v++,!0)}t.Fa=function(){if(this.u=null,Ul(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var m=2*this.R;this.j.info("BP detection timer enabled: "+m),this.A=Cr(g(this.ab,this),m)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,bt(10),oa(this),Ul(this))};function ca(m){m.A!=null&&(l.clearTimeout(m.A),m.A=null)}function Ul(m){m.g=new hr(m,m.j,"rpc",m.Y),m.m===null&&(m.g.H=m.o),m.g.O=0;var te=vt(m.qa);cr(te,"RID","rpc"),cr(te,"SID",m.K),cr(te,"AID",m.T),cr(te,"CI",m.F?"0":"1"),!m.F&&m.ja&&cr(te,"TO",m.ja),cr(te,"TYPE","xmlhttp"),rs(m,te),m.m&&m.o&&Mo(te,m.m,m.o),m.L&&(m.g.I=m.L);var ue=m.g;m=m.ia,ue.L=1,ue.v=Wr(vt(te)),ue.m=null,ue.P=!0,Xr(ue,m)}t.Za=function(){this.C!=null&&(this.C=null,oa(this),Es(this),bt(19))};function Oo(m){m.C!=null&&(l.clearTimeout(m.C),m.C=null)}function ns(m,te){var ue=null;if(m.g==te){Oo(m),ca(m),m.g=null;var Ce=2}else if(Hr(m.h,te))ue=te.D,Vr(m.h,te),Ce=1;else return;if(m.G!=0){if(te.o)if(Ce==1){ue=te.m?te.m.length:0,te=Date.now()-te.F;var Qe=m.B;Ce=qt(),$e(Ce,new yr(Ce,ue)),sa(m)}else la(m);else if(Qe=te.s,Qe==3||Qe==0&&0<te.X||!(Ce==1&&il(m,te)||Ce==2&&Es(m)))switch(ue&&0<ue.length&&(te=m.h,te.i=te.i.concat(ue)),Qe){case 1:Ii(m,5);break;case 4:Ii(m,10);break;case 3:Ii(m,6);break;default:Ii(m,2)}}}function da(m,te){let ue=m.Ta+Math.floor(Math.random()*m.cb);return m.isActive()||(ue*=2),ue*te}function Ii(m,te){if(m.j.info("Error code "+te),te==2){var ue=g(m.fb,m),Ce=m.Xa;const Qe=!Ce;Ce=new Rt(Ce||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||St(Ce,"https"),Wr(Ce),Qe?Ei(Ce.toString(),ue):Xo(Ce.toString(),ue)}else bt(2);m.G=0,m.l&&m.l.sa(te),ua(m),As(m)}t.fb=function(m){m?(this.j.info("Successfully pinged google.com"),bt(2)):(this.j.info("Failed to ping google.com"),bt(1))};function ua(m){if(m.G=0,m.ka=[],m.l){const te=Qr(m.h);(te.length!=0||m.i.length!=0)&&(x(m.ka,te),x(m.ka,m.i),m.h.i.length=0,E(m.i),m.i.length=0),m.l.ra()}}function R(m,te,ue){var Ce=ue instanceof Rt?vt(ue):new Rt(ue);if(Ce.g!="")te&&(Ce.g=te+"."+Ce.g),jt(Ce,Ce.s);else{var Qe=l.location;Ce=Qe.protocol,te=te?te+"."+Qe.hostname:Qe.hostname,Qe=+Qe.port;var ct=new Rt(null);Ce&&St(ct,Ce),te&&(ct.g=te),Qe&&jt(ct,Qe),ue&&(ct.l=ue),Ce=ct}return ue=m.D,te=m.ya,ue&&te&&cr(Ce,ue,te),cr(Ce,"VER",m.la),rs(m,Ce),Ce}function be(m,te,ue){if(te&&!m.J)throw Error("Can't create secondary domain capable XhrIo object.");return te=m.Ca&&!m.pa?new an(new Zo({eb:ue})):new an(m.pa),te.Ha(m.J),te}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function De(){}t=De.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function qe(){}qe.prototype.g=function(m,te){return new Ze(m,te)};function Ze(m,te){xe.call(this),this.g=new ia(te),this.l=m,this.h=te&&te.messageUrlParams||null,m=te&&te.messageHeaders||null,te&&te.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=te&&te.initMessageHeaders||null,te&&te.messageContentType&&(m?m["X-WebChannel-Content-Type"]=te.messageContentType:m={"X-WebChannel-Content-Type":te.messageContentType}),te&&te.va&&(m?m["X-WebChannel-Client-Profile"]=te.va:m={"X-WebChannel-Client-Profile":te.va}),this.g.S=m,(m=te&&te.Sb)&&!Y(m)&&(this.g.m=m),this.v=te&&te.supportsCrossDomainXhr||!1,this.u=te&&te.sendRawJson||!1,(te=te&&te.httpSessionIdParam)&&!Y(te)&&(this.g.D=te,m=this.h,m!==null&&te in m&&(m=this.h,te in m&&delete m[te])),this.j=new er(this)}w(Ze,xe),Ze.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ze.prototype.close=function(){Fo(this.g)},Ze.prototype.o=function(m){var te=this.g;if(typeof m=="string"){var ue={};ue.__data__=m,m=ue}else this.u&&(ue={},ue.__data__=ut(m),m=ue);te.i.push(new Ke(te.Ya++,m)),te.G==3&&sa(te)},Ze.prototype.N=function(){this.g.l=null,delete this.j,Fo(this.g),delete this.g,Ze.aa.N.call(this)};function yt(m){lt.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var te=m.__sm__;if(te){e:{for(const ue in te){m=ue;break e}m=void 0}(this.i=m)&&(m=this.i,te=te!==null&&m in te?te[m]:void 0),this.data=te}else this.data=m}w(yt,lt);function Dt(){ot.call(this),this.status=1}w(Dt,ot);function er(m){this.g=m}w(er,De),er.prototype.ua=function(){$e(this.g,"a")},er.prototype.ta=function(m){$e(this.g,new yt(m))},er.prototype.sa=function(m){$e(this.g,new Dt)},er.prototype.ra=function(){$e(this.g,"b")},qe.prototype.createWebChannel=qe.prototype.g,Ze.prototype.send=Ze.prototype.o,Ze.prototype.open=Ze.prototype.m,Ze.prototype.close=Ze.prototype.close,N2=function(){return new qe},k2=function(){return qt()},T2=nt,vf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},et.NO_ERROR=0,et.TIMEOUT=8,et.HTTP_ERROR=6,vh=et,ft.COMPLETE="complete",I2=ft,Be.EventType=Re,Re.OPEN="a",Re.CLOSE="b",Re.ERROR="c",Re.MESSAGE="d",xe.prototype.listen=xe.prototype.K,fd=Be,an.prototype.listenOnce=an.prototype.L,an.prototype.getLastError=an.prototype.Ka,an.prototype.getLastErrorCode=an.prototype.Ba,an.prototype.getStatus=an.prototype.Z,an.prototype.getResponseJson=an.prototype.Oa,an.prototype.getResponseText=an.prototype.oa,an.prototype.send=an.prototype.ea,an.prototype.setWithCredentials=an.prototype.Ha,E2=an}).apply(typeof Bu<"u"?Bu:typeof self<"u"?self:typeof window<"u"?window:{});const wv="@firebase/firestore",xv="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Oi.UNAUTHENTICATED=new Oi(null),Oi.GOOGLE_CREDENTIALS=new Oi("google-credentials-uid"),Oi.FIRST_PARTY=new Oi("first-party-uid"),Oi.MOCK_USER=new Oi("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bc="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ml=new cy("@firebase/firestore");function pc(){return Ml.logLevel}function dr(t,...e){if(Ml.logLevel<=nn.DEBUG){const r=e.map(Sy);Ml.debug(`Firestore (${Bc}): ${t}`,...r)}}function Js(t,...e){if(Ml.logLevel<=nn.ERROR){const r=e.map(Sy);Ml.error(`Firestore (${Bc}): ${t}`,...r)}}function Ec(t,...e){if(Ml.logLevel<=nn.WARN){const r=e.map(Sy);Ml.warn(`Firestore (${Bc}): ${t}`,...r)}}function Sy(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nr(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,L2(t,n,r)}function L2(t,e,r){let n=`FIRESTORE (${Bc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Js(n),new Error(n)}function gn(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||L2(e,i,n)}function jr(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class or extends ta{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R2{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class QA{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Oi.UNAUTHENTICATED))}shutdown(){}}class XA{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class ZA{constructor(e){this.t=e,this.currentUser=Oi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){gn(this.o===void 0,42304);let n=this.i;const i=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let o=new Ws;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ws,e.enqueueRetryable(()=>i(this.currentUser))};const s=()=>{const c=o;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},l=c=>{dr("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(dr("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ws)}},0),s()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(dr("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(gn(typeof n.accessToken=="string",31837,{l:n}),new R2(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return gn(e===null||typeof e=="string",2055,{h:e}),new Oi(e)}}class e${constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Oi.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class t${constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new e$(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(Oi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Cv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class r${constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Lo(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){gn(this.o===void 0,3512);const n=o=>{o.error!=null&&dr("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const s=o.token!==this.m;return this.m=o.token,dr("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const i=o=>{dr("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):dr("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Cv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(gn(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new Cv(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n$(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=n$(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<r&&(n+=e.charAt(i[o]%62))}return n}}function on(t,e){return t<e?-1:t>e?1:0}function bf(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),o=e.charAt(n);if(i!==o)return lm(i)===lm(o)?on(i,o):lm(i)?1:-1}return on(t.length,e.length)}const i$=55296,o$=57343;function lm(t){const e=t.charCodeAt(0);return e>=i$&&e<=o$}function Ic(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Av="__name__";class ds{constructor(e,r,n){r===void 0?r=0:r>e.length&&Nr(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&Nr(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return ds.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof ds?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const o=ds.compareSegments(e.get(i),r.get(i));if(o!==0)return o}return on(e.length,r.length)}static compareSegments(e,r){const n=ds.isNumericId(e),i=ds.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?ds.extractNumericId(e).compare(ds.extractNumericId(r)):bf(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Va.fromString(e.substring(4,e.length-2))}}class Nn extends ds{construct(e,r,n){return new Nn(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new or(wt.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Nn(r)}static emptyPath(){return new Nn([])}}const s$=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class wi extends ds{construct(e,r,n){return new wi(e,r,n)}static isValidIdentifier(e){return s$.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),wi.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Av}static keyField(){return new wi([Av])}static fromServerFormat(e){const r=[];let n="",i=0;const o=()=>{if(n.length===0)throw new or(wt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let s=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new or(wt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new or(wt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else l==="`"?(s=!s,i++):l!=="."||s?(n+=l,i++):(o(),i++)}if(o(),s)throw new or(wt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new wi(r)}static emptyPath(){return new wi([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e){this.path=e}static fromPath(e){return new wr(Nn.fromString(e))}static fromName(e){return new wr(Nn.fromString(e).popFirst(5))}static empty(){return new wr(Nn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Nn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Nn.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new wr(new Nn(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D2(t,e,r){if(!r)throw new or(wt.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function a$(t,e,r,n){if(e===!0&&n===!0)throw new or(wt.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function $v(t){if(!wr.isDocumentKey(t))throw new or(wt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Ev(t){if(wr.isDocumentKey(t))throw new or(wt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function M2(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function up(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Nr(12329,{type:typeof t})}function Qs(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new or(wt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=up(t);throw new or(wt.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oi(t,e){const r={typeString:t};return e&&(r.value=e),r}function ou(t,e){if(!M2(t))throw new or(wt.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const s=t[n];if(i&&typeof s!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(o!==void 0&&s!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new or(wt.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iv=-62135596800,Tv=1e6;class Rn{static now(){return Rn.fromMillis(Date.now())}static fromDate(e){return Rn.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*Tv);return new Rn(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new or(wt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new or(wt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<Iv)throw new or(wt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new or(wt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Tv}_compareTo(e){return this.seconds===e.seconds?on(this.nanoseconds,e.nanoseconds):on(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Rn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ou(e,Rn._jsonSchema))return new Rn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Iv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Rn._jsonSchemaVersion="firestore/timestamp/1.0",Rn._jsonSchema={type:oi("string",Rn._jsonSchemaVersion),seconds:oi("number"),nanoseconds:oi("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{static fromTimestamp(e){return new Dr(e)}static min(){return new Dr(new Rn(0,0))}static max(){return new Dr(new Rn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qd=-1;function l$(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=Dr.fromTimestamp(n===1e9?new Rn(r+1,0):new Rn(r,n));return new Ua(i,wr.empty(),e)}function c$(t){return new Ua(t.readTime,t.key,qd)}class Ua{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Ua(Dr.min(),wr.empty(),qd)}static max(){return new Ua(Dr.max(),wr.empty(),qd)}}function d$(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=wr.comparator(t.documentKey,e.documentKey),r!==0?r:on(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u$="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class h${constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jc(t){if(t.code!==wt.FAILED_PRECONDITION||t.message!==u$)throw t;dr("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Nr(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new kt((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof kt?r:kt.resolve(r)}catch(r){return kt.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):kt.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):kt.reject(r)}static resolve(e){return new kt((r,n)=>{r(e)})}static reject(e){return new kt((r,n)=>{n(e)})}static waitFor(e){return new kt((r,n)=>{let i=0,o=0,s=!1;e.forEach(l=>{++i,l.next(()=>{++o,s&&o===i&&r()},c=>n(c))}),s=!0,o===i&&r()})}static or(e){let r=kt.resolve(!1);for(const n of e)r=r.next(i=>i?kt.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,o)=>{n.push(r.call(this,i,o))}),this.waitFor(n)}static mapArray(e,r){return new kt((n,i)=>{const o=e.length,s=new Array(o);let l=0;for(let c=0;c<o;c++){const d=c;r(e[d]).next(u=>{s[d]=u,++l,l===o&&n(s)},u=>i(u))}})}static doWhile(e,r){return new kt((n,i)=>{const o=()=>{e()===!0?r().next(()=>{o()},i):n()};o()})}}function p$(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Vc(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}hp.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xy=-1;function pp(t){return t==null}function zh(t){return t===0&&1/t==-1/0}function m$(t){return typeof t=="number"&&Number.isInteger(t)&&!zh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F2="";function f$(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=kv(e)),e=y$(t.get(r),e);return kv(e)}function y$(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const o=t.charAt(i);switch(o){case"\0":r+="";break;case F2:r+="";break;default:r+=o}}return r}function kv(t){return t+F2+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nv(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Xa(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function O2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e,r){this.comparator=e,this.root=r||Si.EMPTY}insert(e,r){return new Vn(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Si.BLACK,null,null))}remove(e){return new Vn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Si.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ju(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ju(this.root,e,this.comparator,!1)}getReverseIterator(){return new ju(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ju(this.root,e,this.comparator,!0)}}class ju{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Si{constructor(e,r,n,i,o){this.key=e,this.value=r,this.color=n??Si.RED,this.left=i??Si.EMPTY,this.right=o??Si.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,o){return new Si(e??this.key,r??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,r,n),null):o===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Si.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Si.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Si.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Si.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Nr(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Nr(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Nr(27949);return e+(this.isRed()?0:1)}}Si.EMPTY=null,Si.RED=!0,Si.BLACK=!1;Si.EMPTY=new class{constructor(){this.size=0}get key(){throw Nr(57766)}get value(){throw Nr(16141)}get color(){throw Nr(16727)}get left(){throw Nr(29726)}get right(){throw Nr(36894)}copy(e,r,n,i,o){return this}insert(e,r,n){return new Si(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e){this.comparator=e,this.data=new Vn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Lv(this.data.getIterator())}getIteratorFrom(e){return new Lv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof ui)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new ui(this.comparator);return r.data=e,r}}class Lv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e){this.fields=e,e.sort(wi.comparator)}static empty(){return new bo([])}unionWith(e){let r=new ui(wi.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new bo(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Ic(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new B2("Invalid base64 string: "+o):o}}(e);return new Ai(r)}static fromUint8Array(e){const r=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new Ai(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return on(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ai.EMPTY_BYTE_STRING=new Ai("");const g$=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ha(t){if(gn(!!t,39018),typeof t=="string"){let e=0;const r=g$.exec(t);if(gn(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Yn(t.seconds),nanos:Yn(t.nanos)}}function Yn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ga(t){return typeof t=="string"?Ai.fromBase64String(t):Ai.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j2="server_timestamp",V2="__type__",q2="__previous_value__",z2="__local_write_time__";function Cy(t){return(t?.mapValue?.fields||{})[V2]?.stringValue===j2}function mp(t){const e=t.mapValue.fields[q2];return Cy(e)?mp(e):e}function zd(t){const e=Ha(t.mapValue.fields[z2].timestampValue);return new Rn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v${constructor(e,r,n,i,o,s,l,c,d,u){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=d,this.isUsingEmulator=u}}const Uh="(default)";class Ud{constructor(e,r){this.projectId=e,this.database=r||Uh}static empty(){return new Ud("","")}get isDefaultDatabase(){return this.database===Uh}isEqual(e){return e instanceof Ud&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U2="__type__",b$="__max__",Vu={mapValue:{}},H2="__vector__",Hh="value";function Wa(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Cy(t)?4:P$(t)?9007199254740991:_$(t)?10:11:Nr(28295,{value:t})}function Ss(t,e){if(t===e)return!0;const r=Wa(t);if(r!==Wa(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return zd(t).isEqual(zd(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const s=Ha(i.timestampValue),l=Ha(o.timestampValue);return s.seconds===l.seconds&&s.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return Ga(i.bytesValue).isEqual(Ga(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return Yn(i.geoPointValue.latitude)===Yn(o.geoPointValue.latitude)&&Yn(i.geoPointValue.longitude)===Yn(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return Yn(i.integerValue)===Yn(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const s=Yn(i.doubleValue),l=Yn(o.doubleValue);return s===l?zh(s)===zh(l):isNaN(s)&&isNaN(l)}return!1}(t,e);case 9:return Ic(t.arrayValue.values||[],e.arrayValue.values||[],Ss);case 10:case 11:return function(i,o){const s=i.mapValue.fields||{},l=o.mapValue.fields||{};if(Nv(s)!==Nv(l))return!1;for(const c in s)if(s.hasOwnProperty(c)&&(l[c]===void 0||!Ss(s[c],l[c])))return!1;return!0}(t,e);default:return Nr(52216,{left:t})}}function Hd(t,e){return(t.values||[]).find(r=>Ss(r,e))!==void 0}function Tc(t,e){if(t===e)return 0;const r=Wa(t),n=Wa(e);if(r!==n)return on(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return on(t.booleanValue,e.booleanValue);case 2:return function(o,s){const l=Yn(o.integerValue||o.doubleValue),c=Yn(s.integerValue||s.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return Rv(t.timestampValue,e.timestampValue);case 4:return Rv(zd(t),zd(e));case 5:return bf(t.stringValue,e.stringValue);case 6:return function(o,s){const l=Ga(o),c=Ga(s);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(o,s){const l=o.split("/"),c=s.split("/");for(let d=0;d<l.length&&d<c.length;d++){const u=on(l[d],c[d]);if(u!==0)return u}return on(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,s){const l=on(Yn(o.latitude),Yn(s.latitude));return l!==0?l:on(Yn(o.longitude),Yn(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Dv(t.arrayValue,e.arrayValue);case 10:return function(o,s){const l=o.fields||{},c=s.fields||{},d=l[Hh]?.arrayValue,u=c[Hh]?.arrayValue,y=on(d?.values?.length||0,u?.values?.length||0);return y!==0?y:Dv(d,u)}(t.mapValue,e.mapValue);case 11:return function(o,s){if(o===Vu.mapValue&&s===Vu.mapValue)return 0;if(o===Vu.mapValue)return 1;if(s===Vu.mapValue)return-1;const l=o.fields||{},c=Object.keys(l),d=s.fields||{},u=Object.keys(d);c.sort(),u.sort();for(let y=0;y<c.length&&y<u.length;++y){const g=bf(c[y],u[y]);if(g!==0)return g;const f=Tc(l[c[y]],d[u[y]]);if(f!==0)return f}return on(c.length,u.length)}(t.mapValue,e.mapValue);default:throw Nr(23264,{he:r})}}function Rv(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return on(t,e);const r=Ha(t),n=Ha(e),i=on(r.seconds,n.seconds);return i!==0?i:on(r.nanos,n.nanos)}function Dv(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const o=Tc(r[i],n[i]);if(o)return o}return on(r.length,n.length)}function kc(t){return _f(t)}function _f(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Ha(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Ga(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return wr.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const o of r.values||[])i?i=!1:n+=",",n+=_f(o);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const s of n)o?o=!1:i+=",",i+=`${s}:${_f(r.fields[s])}`;return i+"}"}(t.mapValue):Nr(61005,{value:t})}function bh(t){switch(Wa(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=mp(t);return e?16+bh(e):16;case 5:return 2*t.stringValue.length;case 6:return Ga(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,o)=>i+bh(o),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return Xa(n.fields,(o,s)=>{i+=o.length+bh(s)}),i}(t.mapValue);default:throw Nr(13486,{value:t})}}function Mv(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Pf(t){return!!t&&"integerValue"in t}function Ay(t){return!!t&&"arrayValue"in t}function Fv(t){return!!t&&"nullValue"in t}function Ov(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function _h(t){return!!t&&"mapValue"in t}function _$(t){return(t?.mapValue?.fields||{})[U2]?.stringValue===H2}function Cd(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Xa(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Cd(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Cd(t.arrayValue.values[r]);return e}return{...t}}function P$(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===b$}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{constructor(e){this.value=e}static empty(){return new so({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!_h(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Cd(r)}setAll(e){let r=wi.emptyPath(),n={},i=[];e.forEach((s,l)=>{if(!r.isImmediateParentOf(l)){const c=this.getFieldsMap(r);this.applyChanges(c,n,i),n={},i=[],r=l.popLast()}s?n[l.lastSegment()]=Cd(s):i.push(l.lastSegment())});const o=this.getFieldsMap(r);this.applyChanges(o,n,i)}delete(e){const r=this.field(e.popLast());_h(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Ss(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];_h(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Xa(r,(i,o)=>e[i]=o);for(const i of n)delete e[i]}clone(){return new so(Cd(this.value))}}function G2(t){const e=[];return Xa(t.fields,(r,n)=>{const i=new wi([r]);if(_h(n)){const o=G2(n.mapValue).fields;if(o.length===0)e.push(i);else for(const s of o)e.push(i.child(s))}else e.push(i)}),new bo(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e,r,n,i,o,s,l){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=o,this.data=s,this.documentState=l}static newInvalidDocument(e){return new Bi(e,0,Dr.min(),Dr.min(),Dr.min(),so.empty(),0)}static newFoundDocument(e,r,n,i){return new Bi(e,1,r,Dr.min(),n,i,0)}static newNoDocument(e,r){return new Bi(e,2,r,Dr.min(),Dr.min(),so.empty(),0)}static newUnknownDocument(e,r){return new Bi(e,3,r,Dr.min(),Dr.min(),so.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Dr.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=so.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=so.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Dr.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Bi&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Bi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh{constructor(e,r){this.position=e,this.inclusive=r}}function Bv(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const o=e[i],s=t.position[i];if(o.field.isKeyField()?n=wr.comparator(wr.fromName(s.referenceValue),r.key):n=Tc(s,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function jv(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Ss(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd{constructor(e,r="asc"){this.field=e,this.dir=r}}function S$(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{}class ii extends W2{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new x$(e,r,n):r==="array-contains"?new $$(e,n):r==="in"?new E$(e,n):r==="not-in"?new I$(e,n):r==="array-contains-any"?new T$(e,n):new ii(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new C$(e,n):new A$(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Tc(r,this.value)):r!==null&&Wa(this.value)===Wa(r)&&this.matchesComparison(Tc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Nr(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ko extends W2{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Ko(e,r)}matches(e){return Y2(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Y2(t){return t.op==="and"}function K2(t){return w$(t)&&Y2(t)}function w$(t){for(const e of t.filters)if(e instanceof Ko)return!1;return!0}function Sf(t){if(t instanceof ii)return t.field.canonicalString()+t.op.toString()+kc(t.value);if(K2(t))return t.filters.map(e=>Sf(e)).join(",");{const e=t.filters.map(r=>Sf(r)).join(",");return`${t.op}(${e})`}}function J2(t,e){return t instanceof ii?function(n,i){return i instanceof ii&&n.op===i.op&&n.field.isEqual(i.field)&&Ss(n.value,i.value)}(t,e):t instanceof Ko?function(n,i){return i instanceof Ko&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((o,s,l)=>o&&J2(s,i.filters[l]),!0):!1}(t,e):void Nr(19439)}function Q2(t){return t instanceof ii?function(r){return`${r.field.canonicalString()} ${r.op} ${kc(r.value)}`}(t):t instanceof Ko?function(r){return r.op.toString()+" {"+r.getFilters().map(Q2).join(" ,")+"}"}(t):"Filter"}class x$ extends ii{constructor(e,r,n){super(e,r,n),this.key=wr.fromName(n.referenceValue)}matches(e){const r=wr.comparator(e.key,this.key);return this.matchesComparison(r)}}class C$ extends ii{constructor(e,r){super(e,"in",r),this.keys=X2("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class A$ extends ii{constructor(e,r){super(e,"not-in",r),this.keys=X2("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function X2(t,e){return(e.arrayValue?.values||[]).map(r=>wr.fromName(r.referenceValue))}class $$ extends ii{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Ay(r)&&Hd(r.arrayValue,this.value)}}class E$ extends ii{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Hd(this.value.arrayValue,r)}}class I$ extends ii{constructor(e,r){super(e,"not-in",r)}matches(e){if(Hd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Hd(this.value.arrayValue,r)}}class T$ extends ii{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Ay(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Hd(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k${constructor(e,r=null,n=[],i=[],o=null,s=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=s,this.endAt=l,this.Te=null}}function Vv(t,e=null,r=[],n=[],i=null,o=null,s=null){return new k$(t,e,r,n,i,o,s)}function $y(t){const e=jr(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Sf(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),pp(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>kc(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>kc(n)).join(",")),e.Te=r}return e.Te}function Ey(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!S$(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!J2(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!jv(t.startAt,e.startAt)&&jv(t.endAt,e.endAt)}function wf(t){return wr.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(e,r=null,n=[],i=[],o=null,s="F",l=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=s,this.startAt=l,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function N$(t,e,r,n,i,o,s,l){return new qc(t,e,r,n,i,o,s,l)}function Iy(t){return new qc(t)}function qv(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Z2(t){return t.collectionGroup!==null}function Ad(t){const e=jr(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let l=new ui(wi.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(o=>{r.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new Gd(o,n))}),r.has(wi.keyField().canonicalString())||e.Ie.push(new Gd(wi.keyField(),n))}return e.Ie}function ms(t){const e=jr(t);return e.Ee||(e.Ee=L$(e,Ad(t))),e.Ee}function L$(t,e){if(t.limitType==="F")return Vv(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new Gd(i.field,o)});const r=t.endAt?new Gh(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Gh(t.startAt.position,t.startAt.inclusive):null;return Vv(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function xf(t,e){const r=t.filters.concat([e]);return new qc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Cf(t,e,r){return new qc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function fp(t,e){return Ey(ms(t),ms(e))&&t.limitType===e.limitType}function e5(t){return`${$y(ms(t))}|lt:${t.limitType}`}function mc(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>Q2(i)).join(", ")}]`),pp(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>kc(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>kc(i)).join(",")),`Target(${n})`}(ms(t))}; limitType=${t.limitType})`}function yp(t,e){return e.isFoundDocument()&&function(n,i){const o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):wr.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(t,e)&&function(n,i){for(const o of Ad(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(s,l,c){const d=Bv(s,l,c);return s.inclusive?d<=0:d<0}(n.startAt,Ad(n),i)||n.endAt&&!function(s,l,c){const d=Bv(s,l,c);return s.inclusive?d>=0:d>0}(n.endAt,Ad(n),i))}(t,e)}function R$(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function t5(t){return(e,r)=>{let n=!1;for(const i of Ad(t)){const o=D$(i,e,r);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function D$(t,e,r){const n=t.field.isKeyField()?wr.comparator(e.key,r.key):function(o,s,l){const c=s.data.field(o),d=l.data.field(o);return c!==null&&d!==null?Tc(c,d):Nr(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Nr(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,o]of n)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Xa(this.inner,(r,n)=>{for(const[i,o]of n)e(i,o)})}isEmpty(){return O2(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M$=new Vn(wr.comparator);function Xs(){return M$}const r5=new Vn(wr.comparator);function yd(...t){let e=r5;for(const r of t)e=e.insert(r.key,r);return e}function n5(t){let e=r5;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function wl(){return $d()}function i5(){return $d()}function $d(){return new Bl(t=>t.toString(),(t,e)=>t.isEqual(e))}const F$=new Vn(wr.comparator),O$=new ui(wr.comparator);function sn(...t){let e=O$;for(const r of t)e=e.add(r);return e}const B$=new ui(on);function j$(){return B$}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ty(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zh(e)?"-0":e}}function o5(t){return{integerValue:""+t}}function V$(t,e){return m$(e)?o5(e):Ty(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gp{constructor(){this._=void 0}}function q$(t,e,r){return t instanceof Wh?function(i,o){const s={fields:{[V2]:{stringValue:j2},[z2]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Cy(o)&&(o=mp(o)),o&&(s.fields[q2]=o),{mapValue:s}}(r,e):t instanceof Wd?a5(t,e):t instanceof Yd?l5(t,e):function(i,o){const s=s5(i,o),l=zv(s)+zv(i.Ae);return Pf(s)&&Pf(i.Ae)?o5(l):Ty(i.serializer,l)}(t,e)}function z$(t,e,r){return t instanceof Wd?a5(t,e):t instanceof Yd?l5(t,e):r}function s5(t,e){return t instanceof Yh?function(n){return Pf(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}class Wh extends gp{}class Wd extends gp{constructor(e){super(),this.elements=e}}function a5(t,e){const r=c5(e);for(const n of t.elements)r.some(i=>Ss(i,n))||r.push(n);return{arrayValue:{values:r}}}class Yd extends gp{constructor(e){super(),this.elements=e}}function l5(t,e){let r=c5(e);for(const n of t.elements)r=r.filter(i=>!Ss(i,n));return{arrayValue:{values:r}}}class Yh extends gp{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function zv(t){return Yn(t.integerValue||t.doubleValue)}function c5(t){return Ay(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function U$(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Wd&&i instanceof Wd||n instanceof Yd&&i instanceof Yd?Ic(n.elements,i.elements,Ss):n instanceof Yh&&i instanceof Yh?Ss(n.Ae,i.Ae):n instanceof Wh&&i instanceof Wh}(t.transform,e.transform)}class H${constructor(e,r){this.version=e,this.transformResults=r}}class fs{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new fs}static exists(e){return new fs(void 0,e)}static updateTime(e){return new fs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ph(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class vp{}function d5(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new h5(t.key,fs.none()):new su(t.key,t.data,fs.none());{const r=t.data,n=so.empty();let i=new ui(wi.comparator);for(let o of e.fields)if(!i.has(o)){let s=r.field(o);s===null&&o.length>1&&(o=o.popLast(),s=r.field(o)),s===null?n.delete(o):n.set(o,s),i=i.add(o)}return new Za(t.key,n,new bo(i.toArray()),fs.none())}}function G$(t,e,r){t instanceof su?function(i,o,s){const l=i.value.clone(),c=Hv(i.fieldTransforms,o,s.transformResults);l.setAll(c),o.convertToFoundDocument(s.version,l).setHasCommittedMutations()}(t,e,r):t instanceof Za?function(i,o,s){if(!Ph(i.precondition,o))return void o.convertToUnknownDocument(s.version);const l=Hv(i.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(u5(i)),c.setAll(l),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(t,e,r):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,r)}function Ed(t,e,r,n){return t instanceof su?function(o,s,l,c){if(!Ph(o.precondition,s))return l;const d=o.value.clone(),u=Gv(o.fieldTransforms,c,s);return d.setAll(u),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),null}(t,e,r,n):t instanceof Za?function(o,s,l,c){if(!Ph(o.precondition,s))return l;const d=Gv(o.fieldTransforms,c,s),u=s.data;return u.setAll(u5(o)),u.setAll(d),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),l===null?null:l.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(y=>y.field))}(t,e,r,n):function(o,s,l){return Ph(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):l}(t,e,r)}function W$(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),o=s5(n.transform,i||null);o!=null&&(r===null&&(r=so.empty()),r.set(n.field,o))}return r||null}function Uv(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Ic(n,i,(o,s)=>U$(o,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class su extends vp{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Za extends vp{constructor(e,r,n,i,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function u5(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function Hv(t,e,r){const n=new Map;gn(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const o=t[i],s=o.transform,l=e.data.field(o.field);n.set(o.field,z$(s,l,r[i]))}return n}function Gv(t,e,r){const n=new Map;for(const i of t){const o=i.transform,s=r.data.field(i.field);n.set(i.field,q$(o,s,e))}return n}class h5 extends vp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Y$ extends vp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K${constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&G$(o,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Ed(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Ed(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=i5();return this.mutations.forEach(i=>{const o=e.get(i.key),s=o.overlayedDocument;let l=this.applyToLocalView(s,o.mutatedFields);l=r.has(i.key)?null:l;const c=d5(s,l);c!==null&&n.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(Dr.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),sn())}isEqual(e){return this.batchId===e.batchId&&Ic(this.mutations,e.mutations,(r,n)=>Uv(r,n))&&Ic(this.baseMutations,e.baseMutations,(r,n)=>Uv(r,n))}}class ky{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){gn(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return F$}();const o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,n[s].version);return new ky(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J${constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q${constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ni,ln;function X$(t){switch(t){case wt.OK:return Nr(64938);case wt.CANCELLED:case wt.UNKNOWN:case wt.DEADLINE_EXCEEDED:case wt.RESOURCE_EXHAUSTED:case wt.INTERNAL:case wt.UNAVAILABLE:case wt.UNAUTHENTICATED:return!1;case wt.INVALID_ARGUMENT:case wt.NOT_FOUND:case wt.ALREADY_EXISTS:case wt.PERMISSION_DENIED:case wt.FAILED_PRECONDITION:case wt.ABORTED:case wt.OUT_OF_RANGE:case wt.UNIMPLEMENTED:case wt.DATA_LOSS:return!0;default:return Nr(15467,{code:t})}}function p5(t){if(t===void 0)return Js("GRPC error has no .code"),wt.UNKNOWN;switch(t){case ni.OK:return wt.OK;case ni.CANCELLED:return wt.CANCELLED;case ni.UNKNOWN:return wt.UNKNOWN;case ni.DEADLINE_EXCEEDED:return wt.DEADLINE_EXCEEDED;case ni.RESOURCE_EXHAUSTED:return wt.RESOURCE_EXHAUSTED;case ni.INTERNAL:return wt.INTERNAL;case ni.UNAVAILABLE:return wt.UNAVAILABLE;case ni.UNAUTHENTICATED:return wt.UNAUTHENTICATED;case ni.INVALID_ARGUMENT:return wt.INVALID_ARGUMENT;case ni.NOT_FOUND:return wt.NOT_FOUND;case ni.ALREADY_EXISTS:return wt.ALREADY_EXISTS;case ni.PERMISSION_DENIED:return wt.PERMISSION_DENIED;case ni.FAILED_PRECONDITION:return wt.FAILED_PRECONDITION;case ni.ABORTED:return wt.ABORTED;case ni.OUT_OF_RANGE:return wt.OUT_OF_RANGE;case ni.UNIMPLEMENTED:return wt.UNIMPLEMENTED;case ni.DATA_LOSS:return wt.DATA_LOSS;default:return Nr(39323,{code:t})}}(ln=ni||(ni={}))[ln.OK=0]="OK",ln[ln.CANCELLED=1]="CANCELLED",ln[ln.UNKNOWN=2]="UNKNOWN",ln[ln.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ln[ln.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ln[ln.NOT_FOUND=5]="NOT_FOUND",ln[ln.ALREADY_EXISTS=6]="ALREADY_EXISTS",ln[ln.PERMISSION_DENIED=7]="PERMISSION_DENIED",ln[ln.UNAUTHENTICATED=16]="UNAUTHENTICATED",ln[ln.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ln[ln.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ln[ln.ABORTED=10]="ABORTED",ln[ln.OUT_OF_RANGE=11]="OUT_OF_RANGE",ln[ln.UNIMPLEMENTED=12]="UNIMPLEMENTED",ln[ln.INTERNAL=13]="INTERNAL",ln[ln.UNAVAILABLE=14]="UNAVAILABLE",ln[ln.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z$(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e3=new Va([4294967295,4294967295],0);function Wv(t){const e=Z$().encode(t),r=new $2;return r.update(e),new Uint8Array(r.digest())}function Yv(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Va([r,n],0),new Va([i,o],0)]}class Ny{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new gd(`Invalid padding: ${r}`);if(n<0)throw new gd(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new gd(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new gd(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Va.fromNumber(this.ge)}ye(e,r,n){let i=e.add(r.multiply(Va.fromNumber(n)));return i.compare(e3)===1&&(i=new Va([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=Wv(e),[n,i]=Yv(r);for(let o=0;o<this.hashCount;o++){const s=this.ye(n,i,o);if(!this.we(s))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new Ny(o,i,r);return n.forEach(l=>s.insert(l)),s}insert(e){if(this.ge===0)return;const r=Wv(e),[n,i]=Yv(r);for(let o=0;o<this.hashCount;o++){const s=this.ye(n,i,o);this.Se(s)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class gd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bp{constructor(e,r,n,i,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,au.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new bp(Dr.min(),i,new Vn(on),Xs(),sn())}}class au{constructor(e,r,n,i,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new au(n,r,sn(),sn(),sn())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh{constructor(e,r,n,i){this.be=e,this.removedTargetIds=r,this.key=n,this.De=i}}class m5{constructor(e,r){this.targetId=e,this.Ce=r}}class f5{constructor(e,r,n=Ai.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class Kv{constructor(){this.ve=0,this.Fe=Jv(),this.Me=Ai.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=sn(),r=sn(),n=sn();return this.Fe.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:Nr(38017,{changeType:o})}}),new au(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=Jv()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,gn(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class t3{constructor(e){this.Ge=e,this.ze=new Map,this.je=Xs(),this.Je=qu(),this.He=qu(),this.Ye=new Vn(on)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:Nr(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,i)=>{this.rt(i)&&r(i)})}st(e){const r=e.targetId,n=e.Ce.count,i=this.ot(r);if(i){const o=i.target;if(wf(o))if(n===0){const s=new wr(o.path);this.et(r,s,Bi.newNoDocument(s,Dr.min()))}else gn(n===1,20013,{expectedCount:n});else{const s=this._t(r);if(s!==n){const l=this.ut(e),c=l?this.ct(l,e,s):1;if(c!==0){this.it(r);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,d)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=r;let s,l;try{s=Ga(n).toUint8Array()}catch(c){if(c instanceof B2)return Ec("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new Ny(s,i,o)}catch(c){return Ec(c instanceof gd?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.ge===0?null:l}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let i=0;return n.forEach(o=>{const s=this.Ge.ht(),l=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(l)||(this.et(r,o,null),i++)}),i}Tt(e){const r=new Map;this.ze.forEach((o,s)=>{const l=this.ot(s);if(l){if(o.current&&wf(l.target)){const c=new wr(l.target.path);this.It(c).has(s)||this.Et(s,c)||this.et(s,c,Bi.newNoDocument(c,e))}o.Be&&(r.set(s,o.ke()),o.qe())}});let n=sn();this.He.forEach((o,s)=>{let l=!0;s.forEachWhile(c=>{const d=this.ot(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(o))}),this.je.forEach((o,s)=>s.setReadTime(e));const i=new bp(e,r,this.Ye,this.je,n);return this.je=Xs(),this.Je=qu(),this.He=qu(),this.Ye=new Vn(on),i}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,r)?i.Qe(r,1):i.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new Kv,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new ui(on),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new ui(on),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||dr("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Kv),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function qu(){return new Vn(wr.comparator)}function Jv(){return new Vn(wr.comparator)}const r3={asc:"ASCENDING",desc:"DESCENDING"},n3={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},i3={and:"AND",or:"OR"};class o3{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Af(t,e){return t.useProto3Json||pp(e)?e:{value:e}}function Kh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function y5(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function s3(t,e){return Kh(t,e.toTimestamp())}function ys(t){return gn(!!t,49232),Dr.fromTimestamp(function(r){const n=Ha(r);return new Rn(n.seconds,n.nanos)}(t))}function Ly(t,e){return $f(t,e).canonicalString()}function $f(t,e){const r=function(i){return new Nn(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function g5(t){const e=Nn.fromString(t);return gn(S5(e),10190,{key:e.toString()}),e}function Ef(t,e){return Ly(t.databaseId,e.path)}function cm(t,e){const r=g5(e);if(r.get(1)!==t.databaseId.projectId)throw new or(wt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new or(wt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new wr(b5(r))}function v5(t,e){return Ly(t.databaseId,e)}function a3(t){const e=g5(t);return e.length===4?Nn.emptyPath():b5(e)}function If(t){return new Nn(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function b5(t){return gn(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Qv(t,e,r){return{name:Ef(t,e),fields:r.value.mapValue.fields}}function l3(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Nr(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(d,u){return d.useProto3Json?(gn(u===void 0||typeof u=="string",58123),Ai.fromBase64String(u||"")):(gn(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),Ai.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,l=s&&function(d){const u=d.code===void 0?wt.UNKNOWN:p5(d.code);return new or(u,d.message||"")}(s);r=new f5(n,i,o,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=cm(t,n.document.name),o=ys(n.document.updateTime),s=n.document.createTime?ys(n.document.createTime):Dr.min(),l=new so({mapValue:{fields:n.document.fields}}),c=Bi.newFoundDocument(i,o,s,l),d=n.targetIds||[],u=n.removedTargetIds||[];r=new Sh(d,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=cm(t,n.document),o=n.readTime?ys(n.readTime):Dr.min(),s=Bi.newNoDocument(i,o),l=n.removedTargetIds||[];r=new Sh([],l,s.key,s)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=cm(t,n.document),o=n.removedTargetIds||[];r=new Sh([],o,i,null)}else{if(!("filter"in e))return Nr(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:o}=n,s=new Q$(i,o),l=n.targetId;r=new m5(l,s)}}return r}function c3(t,e){let r;if(e instanceof su)r={update:Qv(t,e.key,e.value)};else if(e instanceof h5)r={delete:Ef(t,e.key)};else if(e instanceof Za)r={update:Qv(t,e.key,e.data),updateMask:v3(e.fieldMask)};else{if(!(e instanceof Y$))return Nr(16599,{Vt:e.type});r={verify:Ef(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(o,s){const l=s.transform;if(l instanceof Wh)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Wd)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Yd)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Yh)return{fieldPath:s.field.canonicalString(),increment:l.Ae};throw Nr(20930,{transform:s.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:s3(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Nr(27497)}(t,e.precondition)),r}function d3(t,e){return t&&t.length>0?(gn(e!==void 0,14353),t.map(r=>function(i,o){let s=i.updateTime?ys(i.updateTime):ys(o);return s.isEqual(Dr.min())&&(s=ys(o)),new H$(s,i.transformResults||[])}(r,e))):[]}function u3(t,e){return{documents:[v5(t,e.path)]}}function h3(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=v5(t,i);const o=function(d){if(d.length!==0)return P5(Ko.create(d,"and"))}(e.filters);o&&(r.structuredQuery.where=o);const s=function(d){if(d.length!==0)return d.map(u=>function(g){return{field:fc(g.field),direction:f3(g.dir)}}(u))}(e.orderBy);s&&(r.structuredQuery.orderBy=s);const l=Af(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:r,parent:i}}function p3(t){let e=a3(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){gn(n===1,65062);const u=r.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let o=[];r.where&&(o=function(y){const g=_5(y);return g instanceof Ko&&K2(g)?g.getFilters():[g]}(r.where));let s=[];r.orderBy&&(s=function(y){return y.map(g=>function(w){return new Gd(yc(w.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(g))}(r.orderBy));let l=null;r.limit&&(l=function(y){let g;return g=typeof y=="object"?y.value:y,pp(g)?null:g}(r.limit));let c=null;r.startAt&&(c=function(y){const g=!!y.before,f=y.values||[];return new Gh(f,g)}(r.startAt));let d=null;return r.endAt&&(d=function(y){const g=!y.before,f=y.values||[];return new Gh(f,g)}(r.endAt)),N$(e,i,s,o,l,"F",c,d)}function m3(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Nr(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function _5(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=yc(r.unaryFilter.field);return ii.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=yc(r.unaryFilter.field);return ii.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=yc(r.unaryFilter.field);return ii.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=yc(r.unaryFilter.field);return ii.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Nr(61313);default:return Nr(60726)}}(t):t.fieldFilter!==void 0?function(r){return ii.create(yc(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Nr(58110);default:return Nr(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Ko.create(r.compositeFilter.filters.map(n=>_5(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Nr(1026)}}(r.compositeFilter.op))}(t):Nr(30097,{filter:t})}function f3(t){return r3[t]}function y3(t){return n3[t]}function g3(t){return i3[t]}function fc(t){return{fieldPath:t.canonicalString()}}function yc(t){return wi.fromServerFormat(t.fieldPath)}function P5(t){return t instanceof ii?function(r){if(r.op==="=="){if(Ov(r.value))return{unaryFilter:{field:fc(r.field),op:"IS_NAN"}};if(Fv(r.value))return{unaryFilter:{field:fc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(Ov(r.value))return{unaryFilter:{field:fc(r.field),op:"IS_NOT_NAN"}};if(Fv(r.value))return{unaryFilter:{field:fc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fc(r.field),op:y3(r.op),value:r.value}}}(t):t instanceof Ko?function(r){const n=r.getFilters().map(i=>P5(i));return n.length===1?n[0]:{compositeFilter:{op:g3(r.op),filters:n}}}(t):Nr(54877,{filter:t})}function v3(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function S5(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(e,r,n,i,o=Dr.min(),s=Dr.min(),l=Ai.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Ra(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Ra(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ra(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ra(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b3{constructor(e){this.yt=e}}function _3(t){const e=p3({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Cf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P3{constructor(){this.Cn=new S3}addToCollectionParentIndex(e,r){return this.Cn.add(r),kt.resolve()}getCollectionParents(e,r){return kt.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return kt.resolve()}deleteFieldIndex(e,r){return kt.resolve()}deleteAllFieldIndexes(e){return kt.resolve()}createTargetIndexes(e,r){return kt.resolve()}getDocumentsMatchingTarget(e,r){return kt.resolve(null)}getIndexType(e,r){return kt.resolve(0)}getFieldIndexes(e,r){return kt.resolve([])}getNextCollectionGroupToUpdate(e){return kt.resolve(null)}getMinOffset(e,r){return kt.resolve(Ua.min())}getMinOffsetFromCollectionGroup(e,r){return kt.resolve(Ua.min())}updateCollectionGroup(e,r,n){return kt.resolve()}updateIndexEntries(e,r){return kt.resolve()}}class S3{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new ui(Nn.comparator),o=!i.has(n);return this.index[r]=i.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new ui(Nn.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},w5=41943040;class oo{static withCacheSize(e){return new oo(e,oo.DEFAULT_COLLECTION_PERCENTILE,oo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */oo.DEFAULT_COLLECTION_PERCENTILE=10,oo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,oo.DEFAULT=new oo(w5,oo.DEFAULT_COLLECTION_PERCENTILE,oo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),oo.DISABLED=new oo(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Nc(0)}static cr(){return new Nc(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zv="LruGarbageCollector",w3=1048576;function e0([t,e],[r,n]){const i=on(t,r);return i===0?on(e,n):i}class x3{constructor(e){this.Ir=e,this.buffer=new ui(e0),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();e0(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class C3{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){dr(Zv,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Vc(r)?dr(Zv,"Ignoring IndexedDB error during garbage collection: ",r):await jc(r)}await this.Vr(3e5)})}}class A3{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return kt.resolve(hp.ce);const n=new x3(r);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(dr("LruGarbageCollector","Garbage collection skipped; disabled"),kt.resolve(Xv)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(dr("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Xv):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,o,s,l,c,d;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(dr("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),i=this.params.maximumSequenceNumbersToCollect):i=y,s=Date.now(),this.nthSequenceNumber(e,i))).next(y=>(n=y,l=Date.now(),this.removeTargets(e,n,r))).next(y=>(o=y,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(y=>(d=Date.now(),pc()<=nn.DEBUG&&dr("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-u}ms
	Determined least recently used ${i} in `+(l-s)+`ms
	Removed ${o} targets in `+(c-l)+`ms
	Removed ${y} documents in `+(d-c)+`ms
Total Duration: ${d-u}ms`),kt.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:y})))}}function $3(t,e){return new A3(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E3{constructor(){this.changes=new Bl(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Bi.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?kt.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I3{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T3{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Ed(n.mutation,i,bo.empty(),Rn.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,sn()).next(()=>n))}getLocalViewOfDocuments(e,r,n=sn()){const i=wl();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(o=>{let s=yd();return o.forEach((l,c)=>{s=s.insert(l,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,r){const n=wl();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,sn()))}populateOverlays(e,r,n){const i=[];return n.forEach(o=>{r.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,l)=>{r.set(s,l)})})}computeViews(e,r,n,i){let o=Xs();const s=$d(),l=function(){return $d()}();return r.forEach((c,d)=>{const u=n.get(d.key);i.has(d.key)&&(u===void 0||u.mutation instanceof Za)?o=o.insert(d.key,d):u!==void 0?(s.set(d.key,u.mutation.getFieldMask()),Ed(u.mutation,d,u.mutation.getFieldMask(),Rn.now())):s.set(d.key,bo.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((d,u)=>s.set(d,u)),r.forEach((d,u)=>l.set(d,new I3(u,s.get(d)??null))),l))}recalculateAndSaveOverlays(e,r){const n=$d();let i=new Vn((s,l)=>s-l),o=sn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(s=>{for(const l of s)l.keys().forEach(c=>{const d=r.get(c);if(d===null)return;let u=n.get(c)||bo.empty();u=l.applyToLocalView(d,u),n.set(c,u);const y=(i.get(l.batchId)||sn()).add(c);i=i.insert(l.batchId,y)})}).next(()=>{const s=[],l=i.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),d=c.key,u=c.value,y=i5();u.forEach(g=>{if(!o.has(g)){const f=d5(r.get(g),n.get(g));f!==null&&y.set(g,f),o=o.add(g)}}),s.push(this.documentOverlayCache.saveOverlays(e,d,y))}return kt.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(s){return wr.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):Z2(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(o=>{const s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-o.size):kt.resolve(wl());let l=qd,c=o;return s.next(d=>kt.forEach(d,(u,y)=>(l<y.largestBatchId&&(l=y.largestBatchId),o.get(u)?kt.resolve():this.remoteDocumentCache.getEntry(e,u).next(g=>{c=c.insert(u,g)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,c,d,sn())).next(u=>({batchId:l,changes:n5(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new wr(r)).next(n=>{let i=yd();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const o=r.collectionGroup;let s=yd();return this.indexManager.getCollectionParents(e,o).next(l=>kt.forEach(l,c=>{const d=function(y,g){return new qc(g,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(r,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,n,i).next(u=>{u.forEach((y,g)=>{s=s.insert(y,g)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,r,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,i))).next(s=>{o.forEach((c,d)=>{const u=d.getKey();s.get(u)===null&&(s=s.insert(u,Bi.newInvalidDocument(u)))});let l=yd();return s.forEach((c,d)=>{const u=o.get(c);u!==void 0&&Ed(u.mutation,d,bo.empty(),Rn.now()),yp(r,d)&&(l=l.insert(c,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k3{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return kt.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:ys(i.createTime)}}(r)),kt.resolve()}getNamedQuery(e,r){return kt.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(i){return{name:i.name,query:_3(i.bundledQuery),readTime:ys(i.readTime)}}(r)),kt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N3{constructor(){this.overlays=new Vn(wr.comparator),this.qr=new Map}getOverlay(e,r){return kt.resolve(this.overlays.get(r))}getOverlays(e,r){const n=wl();return kt.forEach(r,i=>this.getOverlay(e,i).next(o=>{o!==null&&n.set(i,o)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,o)=>{this.St(e,r,o)}),kt.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.qr.delete(n)),kt.resolve()}getOverlaysForCollection(e,r,n){const i=wl(),o=r.length+1,s=new wr(r.child("")),l=this.overlays.getIteratorFrom(s);for(;l.hasNext();){const c=l.getNext().value,d=c.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===o&&c.largestBatchId>n&&i.set(c.getKey(),c)}return kt.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let o=new Vn((d,u)=>d-u);const s=this.overlays.getIterator();for(;s.hasNext();){const d=s.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>n){let u=o.get(d.largestBatchId);u===null&&(u=wl(),o=o.insert(d.largestBatchId,u)),u.set(d.getKey(),d)}}const l=wl(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,u)=>l.set(d,u)),!(l.size()>=i)););return kt.resolve(l)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const s=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(n.key,new J$(r,n));let o=this.qr.get(r);o===void 0&&(o=sn(),this.qr.set(r,o)),this.qr.set(r,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L3{constructor(){this.sessionToken=Ai.EMPTY_BYTE_STRING}getSessionToken(e){return kt.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,kt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry{constructor(){this.Qr=new ui(fi.$r),this.Ur=new ui(fi.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new fi(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new fi(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new wr(new Nn([])),n=new fi(r,e),i=new fi(r,e+1),o=[];return this.Ur.forEachInRange([n,i],s=>{this.Gr(s),o.push(s.key)}),o}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new wr(new Nn([])),n=new fi(r,e),i=new fi(r,e+1);let o=sn();return this.Ur.forEachInRange([n,i],s=>{o=o.add(s.key)}),o}containsKey(e){const r=new fi(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class fi{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return wr.comparator(e.key,r.key)||on(e.Yr,r.Yr)}static Kr(e,r){return on(e.Yr,r.Yr)||wr.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R3{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new ui(fi.$r)}checkEmpty(e){return kt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new K$(o,r,n,i);this.mutationQueue.push(s);for(const l of i)this.Zr=this.Zr.add(new fi(l.key,o)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return kt.resolve(s)}lookupMutationBatch(e,r){return kt.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),o=i<0?0:i;return kt.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return kt.resolve(this.mutationQueue.length===0?xy:this.tr-1)}getAllMutationBatches(e){return kt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new fi(r,0),i=new fi(r,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,i],s=>{const l=this.Xr(s.Yr);o.push(l)}),kt.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new ui(on);return r.forEach(i=>{const o=new fi(i,0),s=new fi(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,s],l=>{n=n.add(l.Yr)})}),kt.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let o=n;wr.isDocumentKey(o)||(o=o.child(""));const s=new fi(new wr(o),0);let l=new ui(on);return this.Zr.forEachWhile(c=>{const d=c.key.path;return!!n.isPrefixOf(d)&&(d.length===i&&(l=l.add(c.Yr)),!0)},s),kt.resolve(this.ti(l))}ti(e){const r=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){gn(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return kt.forEach(r.mutations,i=>{const o=new fi(i.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new fi(r,0),i=this.Zr.firstAfterOrEqual(n);return kt.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,kt.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D3{constructor(e){this.ri=e,this.docs=function(){return new Vn(wr.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),o=i?i.size:0,s=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return kt.resolve(n?n.document.mutableCopy():Bi.newInvalidDocument(r))}getEntries(e,r){let n=Xs();return r.forEach(i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():Bi.newInvalidDocument(i))}),kt.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let o=Xs();const s=r.path,l=new wr(s.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:d,value:{document:u}}=c.getNext();if(!s.isPrefixOf(d.path))break;d.path.length>s.length+1||d$(c$(u),n)<=0||(i.has(u.key)||yp(r,u))&&(o=o.insert(u.key,u.mutableCopy()))}return kt.resolve(o)}getAllFromCollectionGroup(e,r,n,i){Nr(9500)}ii(e,r){return kt.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new M3(this)}getSize(e){return kt.resolve(this.size)}}class M3 extends E3{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),kt.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F3{constructor(e){this.persistence=e,this.si=new Bl(r=>$y(r),Ey),this.lastRemoteSnapshotVersion=Dr.min(),this.highestTargetId=0,this.oi=0,this._i=new Ry,this.targetCount=0,this.ai=Nc.ur()}forEachTarget(e,r){return this.si.forEach((n,i)=>r(i)),kt.resolve()}getLastRemoteSnapshotVersion(e){return kt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return kt.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),kt.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),kt.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Nc(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,kt.resolve()}updateTargetData(e,r){return this.Pr(r),kt.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,kt.resolve()}removeTargets(e,r,n){let i=0;const o=[];return this.si.forEach((s,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.si.delete(s),o.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),kt.waitFor(o).next(()=>i)}getTargetCount(e){return kt.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return kt.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),kt.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,o=[];return i&&r.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),kt.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),kt.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return kt.resolve(n)}containsKey(e,r){return kt.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x5{constructor(e,r){this.ui={},this.overlays={},this.ci=new hp(0),this.li=!1,this.li=!0,this.hi=new L3,this.referenceDelegate=e(this),this.Pi=new F3(this),this.indexManager=new P3,this.remoteDocumentCache=function(i){return new D3(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new b3(r),this.Ii=new k3(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new N3,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new R3(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){dr("MemoryPersistence","Starting transaction:",e);const i=new O3(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ai(e,r){return kt.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class O3 extends h${constructor(e){super(),this.currentSequenceNumber=e}}class Dy{constructor(e){this.persistence=e,this.Ri=new Ry,this.Vi=null}static mi(e){return new Dy(e)}get fi(){if(this.Vi)return this.Vi;throw Nr(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),kt.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),kt.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),kt.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(o=>this.fi.add(o.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return kt.forEach(this.fi,n=>{const i=wr.fromPath(n);return this.gi(e,i).next(o=>{o||r.removeEntry(i,Dr.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return kt.or([()=>kt.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Jh{constructor(e,r){this.persistence=e,this.pi=new Bl(n=>f$(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=$3(this,r)}static mi(e,r){return new Jh(e,r)}Ei(){}di(e){return kt.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return kt.forEach(this.pi,(n,i)=>this.br(e,n,i).next(o=>o?kt.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(e,s=>this.br(e,s,r).next(l=>{l||(n++,o.removeEntry(s,Dr.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),kt.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),kt.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),kt.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),kt.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=bh(e.data.value)),r}br(e,r,n){return kt.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.pi.get(r);return kt.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class My{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=sn(),i=sn();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new My(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B3{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j3{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Tw()?8:p$(zi())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const o={result:null};return this.ys(e,r).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.ws(e,r,i,n).next(s=>{o.result=s})}).next(()=>{if(o.result)return;const s=new B3;return this.Ss(e,r,s).next(l=>{if(o.result=l,this.Vs)return this.bs(e,r,s,l.size)})}).next(()=>o.result)}bs(e,r,n,i){return n.documentReadCount<this.fs?(pc()<=nn.DEBUG&&dr("QueryEngine","SDK will not create cache indexes for query:",mc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),kt.resolve()):(pc()<=nn.DEBUG&&dr("QueryEngine","Query:",mc(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(pc()<=nn.DEBUG&&dr("QueryEngine","The SDK decides to create cache indexes for query:",mc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ms(r))):kt.resolve())}ys(e,r){if(qv(r))return kt.resolve(null);let n=ms(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Cf(r,null,"F"),n=ms(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const s=sn(...o);return this.ps.getDocuments(e,s).next(l=>this.indexManager.getMinOffset(e,n).next(c=>{const d=this.Ds(r,l);return this.Cs(r,d,s,c.readTime)?this.ys(e,Cf(r,null,"F")):this.vs(e,d,r,c)}))})))}ws(e,r,n,i){return qv(r)||i.isEqual(Dr.min())?kt.resolve(null):this.ps.getDocuments(e,n).next(o=>{const s=this.Ds(r,o);return this.Cs(r,s,n,i)?kt.resolve(null):(pc()<=nn.DEBUG&&dr("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),mc(r)),this.vs(e,s,r,l$(i,qd)).next(l=>l))})}Ds(e,r){let n=new ui(t5(e));return r.forEach((i,o)=>{yp(e,o)&&(n=n.add(o))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(e,r,n){return pc()<=nn.DEBUG&&dr("QueryEngine","Using full collection scan to execute query:",mc(r)),this.ps.getDocumentsMatchingQuery(e,r,Ua.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(o=>(r.forEach(s=>{o=o.insert(s.key,s)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fy="LocalStore",V3=3e8;class q3{constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new Vn(on),this.xs=new Bl(o=>$y(o),Ey),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new T3(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function z3(t,e,r,n){return new q3(t,e,r,n)}async function C5(t,e){const r=jr(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(o=>{const s=[],l=[];let c=sn();for(const d of i){s.push(d.batchId);for(const u of d.mutations)c=c.add(u.key)}for(const d of o){l.push(d.batchId);for(const u of d.mutations)c=c.add(u.key)}return r.localDocuments.getDocuments(n,c).next(d=>({Ls:d,removedBatchIds:s,addedBatchIds:l}))})})}function U3(t,e){const r=jr(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),o=r.Ns.newChangeBuffer({trackRemovals:!0});return function(l,c,d,u){const y=d.batch,g=y.keys();let f=kt.resolve();return g.forEach(w=>{f=f.next(()=>u.getEntry(c,w)).next(E=>{const x=d.docVersions.get(w);gn(x!==null,48541),E.version.compareTo(x)<0&&(y.applyToRemoteDocument(E,d),E.isValidDocument()&&(E.setReadTime(d.commitVersion),u.addEntry(E)))})}),f.next(()=>l.mutationQueue.removeMutationBatch(c,y))}(r,n,e,o).next(()=>o.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let c=sn();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(c=c.add(l.batch.mutations[d].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function A5(t){const e=jr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function H3(t,e){const r=jr(t),n=e.snapshotVersion;let i=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const s=r.Ns.newChangeBuffer({trackRemovals:!0});i=r.Ms;const l=[];e.targetChanges.forEach((u,y)=>{const g=i.get(y);if(!g)return;l.push(r.Pi.removeMatchingKeys(o,u.removedDocuments,y).next(()=>r.Pi.addMatchingKeys(o,u.addedDocuments,y)));let f=g.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(y)!==null?f=f.withResumeToken(Ai.EMPTY_BYTE_STRING,Dr.min()).withLastLimboFreeSnapshotVersion(Dr.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,n)),i=i.insert(y,f),function(E,x,T){return E.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=V3?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(g,f,u)&&l.push(r.Pi.updateTargetData(o,f))});let c=Xs(),d=sn();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(o,u))}),l.push(G3(o,s,e.documentUpdates).next(u=>{c=u.ks,d=u.qs})),!n.isEqual(Dr.min())){const u=r.Pi.getLastRemoteSnapshotVersion(o).next(y=>r.Pi.setTargetsMetadata(o,o.currentSequenceNumber,n));l.push(u)}return kt.waitFor(l).next(()=>s.apply(o)).next(()=>r.localDocuments.getLocalViewOfDocuments(o,c,d)).next(()=>c)}).then(o=>(r.Ms=i,o))}function G3(t,e,r){let n=sn(),i=sn();return r.forEach(o=>n=n.add(o)),e.getEntries(t,n).next(o=>{let s=Xs();return r.forEach((l,c)=>{const d=o.get(l);c.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(l)),c.isNoDocument()&&c.version.isEqual(Dr.min())?(e.removeEntry(l,c.readTime),s=s.insert(l,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),s=s.insert(l,c)):dr(Fy,"Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",c.version)}),{ks:s,qs:i}})}function W3(t,e){const r=jr(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=xy),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function Y3(t,e){const r=jr(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Pi.getTargetData(n,e).next(o=>o?(i=o,kt.resolve(i)):r.Pi.allocateTargetId(n).next(s=>(i=new Ra(e,s,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function Tf(t,e,r){const n=jr(t),i=n.Ms.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,s=>n.persistence.referenceDelegate.removeTarget(s,i))}catch(s){if(!Vc(s))throw s;dr(Fy,`Failed to update sequence numbers for target ${e}: ${s}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function t0(t,e,r){const n=jr(t);let i=Dr.min(),o=sn();return n.persistence.runTransaction("Execute query","readwrite",s=>function(c,d,u){const y=jr(c),g=y.xs.get(u);return g!==void 0?kt.resolve(y.Ms.get(g)):y.Pi.getTargetData(d,u)}(n,s,ms(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(s,l.targetId).next(c=>{o=c})}).next(()=>n.Fs.getDocumentsMatchingQuery(s,e,r?i:Dr.min(),r?o:sn())).next(l=>(K3(n,R$(e),l),{documents:l,Qs:o})))}function K3(t,e,r){let n=t.Os.get(e)||Dr.min();r.forEach((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),t.Os.set(e,n)}class r0{constructor(){this.activeTargetIds=j$()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class J3{constructor(){this.Mo=new r0,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new r0,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q3{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n0="ConnectivityMonitor";class i0{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){dr(n0,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){dr(n0,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zu=null;function kf(){return zu===null?zu=function(){return 268435456+Math.round(2147483648*Math.random())}():zu++,"0x"+zu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dm="RestConnection",X3={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Z3{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===Uh?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,o){const s=kf(),l=this.zo(e,r.toUriEncodedString());dr(dm,`Sending RPC '${e}' ${s}:`,l,n);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,i,o);const{host:d}=new URL(l),u=Mc(d);return this.Jo(e,l,c,n,u).then(y=>(dr(dm,`Received RPC '${e}' ${s}: `,y),y),y=>{throw Ec(dm,`RPC '${e}' ${s} failed with error: `,y,"url: ",l,"request:",n),y})}Ho(e,r,n,i,o,s){return this.Go(e,r,n,i,o)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Bc}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>e[o]=i),n&&n.headers.forEach((i,o)=>e[o]=i)}zo(e,r){const n=X3[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e4{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ti="WebChannelConnection";class t4 extends Z3{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,o){const s=kf();return new Promise((l,c)=>{const d=new E2;d.setWithCredentials(!0),d.listenOnce(I2.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case vh.NO_ERROR:const y=d.getResponseJson();dr(Ti,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(y)),l(y);break;case vh.TIMEOUT:dr(Ti,`RPC '${e}' ${s} timed out`),c(new or(wt.DEADLINE_EXCEEDED,"Request time out"));break;case vh.HTTP_ERROR:const g=d.getStatus();if(dr(Ti,`RPC '${e}' ${s} failed with status:`,g,"response text:",d.getResponseText()),g>0){let f=d.getResponseJson();Array.isArray(f)&&(f=f[0]);const w=f?.error;if(w&&w.status&&w.message){const E=function(T){const Y=T.toLowerCase().replace(/_/g,"-");return Object.values(wt).indexOf(Y)>=0?Y:wt.UNKNOWN}(w.status);c(new or(E,w.message))}else c(new or(wt.UNKNOWN,"Server responded with status "+d.getStatus()))}else c(new or(wt.UNAVAILABLE,"Connection failed."));break;default:Nr(9055,{l_:e,streamId:s,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{dr(Ti,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);dr(Ti,`RPC '${e}' ${s} sending request:`,i),d.send(r,"POST",u,n,15)})}T_(e,r,n){const i=kf(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=N2(),l=k2(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const u=o.join("");dr(Ti,`Creating RPC '${e}' stream ${i}: ${u}`,c);const y=s.createWebChannel(u,c);this.I_(y);let g=!1,f=!1;const w=new e4({Yo:x=>{f?dr(Ti,`Not sending because RPC '${e}' stream ${i} is closed:`,x):(g||(dr(Ti,`Opening RPC '${e}' stream ${i} transport.`),y.open(),g=!0),dr(Ti,`RPC '${e}' stream ${i} sending:`,x),y.send(x))},Zo:()=>y.close()}),E=(x,T,Y)=>{x.listen(T,K=>{try{Y(K)}catch(j){setTimeout(()=>{throw j},0)}})};return E(y,fd.EventType.OPEN,()=>{f||(dr(Ti,`RPC '${e}' stream ${i} transport opened.`),w.o_())}),E(y,fd.EventType.CLOSE,()=>{f||(f=!0,dr(Ti,`RPC '${e}' stream ${i} transport closed`),w.a_(),this.E_(y))}),E(y,fd.EventType.ERROR,x=>{f||(f=!0,Ec(Ti,`RPC '${e}' stream ${i} transport errored. Name:`,x.name,"Message:",x.message),w.a_(new or(wt.UNAVAILABLE,"The operation could not be completed")))}),E(y,fd.EventType.MESSAGE,x=>{if(!f){const T=x.data[0];gn(!!T,16349);const Y=T,K=Y?.error||Y[0]?.error;if(K){dr(Ti,`RPC '${e}' stream ${i} received error:`,K);const j=K.status;let q=function(P){const $=ni[P];if($!==void 0)return p5($)}(j),J=K.message;q===void 0&&(q=wt.INTERNAL,J="Unknown error status: "+j+" with message "+K.message),f=!0,w.a_(new or(q,J)),y.close()}else dr(Ti,`RPC '${e}' stream ${i} received:`,T),w.u_(T)}}),E(l,T2.STAT_EVENT,x=>{x.stat===vf.PROXY?dr(Ti,`RPC '${e}' stream ${i} detected buffering proxy`):x.stat===vf.NOPROXY&&dr(Ti,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.__()},0),w}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function um(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _p(t){return new o3(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $5{constructor(e,r,n=1e3,i=1.5,o=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&dr("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o0="PersistentStream";class E5{constructor(e,r,n,i,o,s,l,c){this.Mi=e,this.S_=n,this.b_=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new $5(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===wt.RESOURCE_EXHAUSTED?(Js(r.toString()),Js("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===wt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===r&&this.G_(n,i)},n=>{e(()=>{const i=new or(wt.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return dr(o0,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(dr(o0,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class r4 extends E5{constructor(e,r,n,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,s),this.serializer=o}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=l3(this.serializer,e),n=function(o){if(!("targetChange"in o))return Dr.min();const s=o.targetChange;return s.targetIds&&s.targetIds.length?Dr.min():s.readTime?ys(s.readTime):Dr.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=If(this.serializer),r.addTarget=function(o,s){let l;const c=s.target;if(l=wf(c)?{documents:u3(o,c)}:{query:h3(o,c).ft},l.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){l.resumeToken=y5(o,s.resumeToken);const d=Af(o,s.expectedCount);d!==null&&(l.expectedCount=d)}else if(s.snapshotVersion.compareTo(Dr.min())>0){l.readTime=Kh(o,s.snapshotVersion.toTimestamp());const d=Af(o,s.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const n=m3(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=If(this.serializer),r.removeTarget=e,this.q_(r)}}class n4 extends E5{constructor(e,r,n,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,s),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return gn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,gn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){gn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=d3(e.writeResults,e.commitTime),n=ys(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=If(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>c3(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i4{}class o4 extends i4{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new or(wt.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Go(e,$f(r,n),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===wt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new or(wt.UNKNOWN,o.toString())})}Ho(e,r,n,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,l])=>this.connection.Ho(e,$f(r,n),i,s,l,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===wt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new or(wt.UNKNOWN,s.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class s4{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Js(r),this.aa=!1):dr("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fl="RemoteStore";class a4{constructor(e,r,n,i,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo(s=>{n.enqueueAndForget(async()=>{jl(this)&&(dr(Fl,"Restarting streams for network reachability change."),await async function(c){const d=jr(c);d.Ea.add(4),await lu(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Pp(d)}(this))})}),this.Ra=new s4(n,i)}}async function Pp(t){if(jl(t))for(const e of t.da)await e(!0)}async function lu(t){for(const e of t.da)await e(!1)}function I5(t,e){const r=jr(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Vy(r)?jy(r):zc(r).O_()&&By(r,e))}function Oy(t,e){const r=jr(t),n=zc(r);r.Ia.delete(e),n.O_()&&T5(r,e),r.Ia.size===0&&(n.O_()?n.L_():jl(r)&&r.Ra.set("Unknown"))}function By(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Dr.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}zc(t).Y_(e)}function T5(t,e){t.Va.Ue(e),zc(t).Z_(e)}function jy(t){t.Va=new t3({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),zc(t).start(),t.Ra.ua()}function Vy(t){return jl(t)&&!zc(t).x_()&&t.Ia.size>0}function jl(t){return jr(t).Ea.size===0}function k5(t){t.Va=void 0}async function l4(t){t.Ra.set("Online")}async function c4(t){t.Ia.forEach((e,r)=>{By(t,e)})}async function d4(t,e){k5(t),Vy(t)?(t.Ra.ha(e),jy(t)):t.Ra.set("Unknown")}async function u4(t,e,r){if(t.Ra.set("Online"),e instanceof f5&&e.state===2&&e.cause)try{await async function(i,o){const s=o.cause;for(const l of o.targetIds)i.Ia.has(l)&&(await i.remoteSyncer.rejectListen(l,s),i.Ia.delete(l),i.Va.removeTarget(l))}(t,e)}catch(n){dr(Fl,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Qh(t,n)}else if(e instanceof Sh?t.Va.Ze(e):e instanceof m5?t.Va.st(e):t.Va.tt(e),!r.isEqual(Dr.min()))try{const n=await A5(t.localStore);r.compareTo(n)>=0&&await function(o,s){const l=o.Va.Tt(s);return l.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const u=o.Ia.get(d);u&&o.Ia.set(d,u.withResumeToken(c.resumeToken,s))}}),l.targetMismatches.forEach((c,d)=>{const u=o.Ia.get(c);if(!u)return;o.Ia.set(c,u.withResumeToken(Ai.EMPTY_BYTE_STRING,u.snapshotVersion)),T5(o,c);const y=new Ra(u.target,c,d,u.sequenceNumber);By(o,y)}),o.remoteSyncer.applyRemoteEvent(l)}(t,r)}catch(n){dr(Fl,"Failed to raise snapshot:",n),await Qh(t,n)}}async function Qh(t,e,r){if(!Vc(e))throw e;t.Ea.add(1),await lu(t),t.Ra.set("Offline"),r||(r=()=>A5(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{dr(Fl,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await Pp(t)})}function N5(t,e){return e().catch(r=>Qh(t,r,e))}async function Sp(t){const e=jr(t),r=Ya(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:xy;for(;h4(e);)try{const i=await W3(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,p4(e,i)}catch(i){await Qh(e,i)}L5(e)&&R5(e)}function h4(t){return jl(t)&&t.Ta.length<10}function p4(t,e){t.Ta.push(e);const r=Ya(t);r.O_()&&r.X_&&r.ea(e.mutations)}function L5(t){return jl(t)&&!Ya(t).x_()&&t.Ta.length>0}function R5(t){Ya(t).start()}async function m4(t){Ya(t).ra()}async function f4(t){const e=Ya(t);for(const r of t.Ta)e.ea(r.mutations)}async function y4(t,e,r){const n=t.Ta.shift(),i=ky.from(n,e,r);await N5(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Sp(t)}async function g4(t,e){e&&Ya(t).X_&&await async function(n,i){if(function(s){return X$(s)&&s!==wt.ABORTED}(i.code)){const o=n.Ta.shift();Ya(n).B_(),await N5(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i)),await Sp(n)}}(t,e),L5(t)&&R5(t)}async function s0(t,e){const r=jr(t);r.asyncQueue.verifyOperationInProgress(),dr(Fl,"RemoteStore received new credentials");const n=jl(r);r.Ea.add(3),await lu(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await Pp(r)}async function v4(t,e){const r=jr(t);e?(r.Ea.delete(2),await Pp(r)):e||(r.Ea.add(2),await lu(r),r.Ra.set("Unknown"))}function zc(t){return t.ma||(t.ma=function(r,n,i){const o=jr(r);return o.sa(),new r4(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:l4.bind(null,t),t_:c4.bind(null,t),r_:d4.bind(null,t),H_:u4.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Vy(t)?jy(t):t.Ra.set("Unknown")):(await t.ma.stop(),k5(t))})),t.ma}function Ya(t){return t.fa||(t.fa=function(r,n,i){const o=jr(r);return o.sa(),new n4(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:m4.bind(null,t),r_:g4.bind(null,t),ta:f4.bind(null,t),na:y4.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Sp(t)):(await t.fa.stop(),t.Ta.length>0&&(dr(Fl,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qy{constructor(e,r,n,i,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new Ws,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,o){const s=Date.now()+n,l=new qy(e,r,s,i,o);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new or(wt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function zy(t,e){if(Js("AsyncQueue",`${e}: ${t}`),Vc(t))return new or(wt.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wc{static emptySet(e){return new wc(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||wr.comparator(r.key,n.key):(r,n)=>wr.comparator(r.key,n.key),this.keyedMap=yd(),this.sortedSet=new Vn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof wc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new wc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a0{constructor(){this.ga=new Vn(wr.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):Nr(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class Lc{constructor(e,r,n,i,o,s,l,c,d){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,r,n,i,o){const s=[];return r.forEach(l=>{s.push({type:0,doc:l})}),new Lc(e,r,wc.emptySet(r),s,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&fp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b4{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class _4{constructor(){this.queries=l0(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=jr(r),o=i.queries;i.queries=l0(),o.forEach((s,l)=>{for(const c of l.Sa)c.onError(n)})})(this,new or(wt.ABORTED,"Firestore shutting down"))}}function l0(){return new Bl(t=>e5(t),fp)}async function D5(t,e){const r=jr(t);let n=3;const i=e.query;let o=r.queries.get(i);o?!o.ba()&&e.Da()&&(n=2):(o=new b4,n=e.Da()?0:1);try{switch(n){case 0:o.wa=await r.onListen(i,!0);break;case 1:o.wa=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(s){const l=zy(s,`Initialization of query '${mc(e.query)}' failed`);return void e.onError(l)}r.queries.set(i,o),o.Sa.push(e),e.va(r.onlineState),o.wa&&e.Fa(o.wa)&&Uy(r)}async function M5(t,e){const r=jr(t),n=e.query;let i=3;const o=r.queries.get(n);if(o){const s=o.Sa.indexOf(e);s>=0&&(o.Sa.splice(s,1),o.Sa.length===0?i=e.Da()?0:1:!o.ba()&&e.Da()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function P4(t,e){const r=jr(t);let n=!1;for(const i of e){const o=i.query,s=r.queries.get(o);if(s){for(const l of s.Sa)l.Fa(i)&&(n=!0);s.wa=i}}n&&Uy(r)}function S4(t,e,r){const n=jr(t),i=n.queries.get(e);if(i)for(const o of i.Sa)o.onError(r);n.queries.delete(e)}function Uy(t){t.Ca.forEach(e=>{e.next()})}var Nf,c0;(c0=Nf||(Nf={})).Ma="default",c0.Cache="cache";class F5{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Lc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=Lc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Nf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O5{constructor(e){this.key=e}}class B5{constructor(e){this.key=e}}class w4{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=sn(),this.mutatedKeys=sn(),this.eu=t5(e),this.tu=new wc(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new a0,i=r?r.tu:this.tu;let o=r?r.mutatedKeys:this.mutatedKeys,s=i,l=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,y)=>{const g=i.get(u),f=yp(this.query,y)?y:null,w=!!g&&this.mutatedKeys.has(g.key),E=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let x=!1;g&&f?g.data.isEqual(f.data)?w!==E&&(n.track({type:3,doc:f}),x=!0):this.su(g,f)||(n.track({type:2,doc:f}),x=!0,(c&&this.eu(f,c)>0||d&&this.eu(f,d)<0)&&(l=!0)):!g&&f?(n.track({type:0,doc:f}),x=!0):g&&!f&&(n.track({type:1,doc:g}),x=!0,(c||d)&&(l=!0)),x&&(f?(s=s.add(f),o=E?o.add(u):o.delete(u)):(s=s.delete(u),o=o.delete(u)))}),this.query.limit!==null)for(;s.size>this.query.limit;){const u=this.query.limitType==="F"?s.last():s.first();s=s.delete(u.key),o=o.delete(u.key),n.track({type:1,doc:u})}return{tu:s,iu:n,Cs:l,mutatedKeys:o}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort((u,y)=>function(f,w){const E=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Nr(20277,{Rt:x})}};return E(f)-E(w)}(u.type,y.type)||this.eu(u.doc,y.doc)),this.ou(n),i=i??!1;const l=r&&!i?this._u():[],c=this.Xa.size===0&&this.current&&!i?1:0,d=c!==this.Za;return this.Za=c,s.length!==0||d?{snapshot:new Lc(this.query,e.tu,o,s,e.mutatedKeys,c===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new a0,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=sn(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new B5(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new O5(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=sn();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return Lc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Hy="SyncEngine";class x4{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class C4{constructor(e){this.key=e,this.hu=!1}}class A4{constructor(e,r,n,i,o,s){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new Bl(l=>e5(l),fp),this.Iu=new Map,this.Eu=new Set,this.du=new Vn(wr.comparator),this.Au=new Map,this.Ru=new Ry,this.Vu={},this.mu=new Map,this.fu=Nc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function $4(t,e,r=!0){const n=H5(t);let i;const o=n.Tu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await j5(n,e,r,!0),i}async function E4(t,e){const r=H5(t);await j5(r,e,!0,!1)}async function j5(t,e,r,n){const i=await Y3(t.localStore,ms(e)),o=i.targetId,s=t.sharedClientState.addLocalQueryTarget(o,r);let l;return n&&(l=await I4(t,e,o,s==="current",i.resumeToken)),t.isPrimaryClient&&r&&I5(t.remoteStore,i),l}async function I4(t,e,r,n,i){t.pu=(y,g,f)=>async function(E,x,T,Y){let K=x.view.ru(T);K.Cs&&(K=await t0(E.localStore,x.query,!1).then(({documents:C})=>x.view.ru(C,K)));const j=Y&&Y.targetChanges.get(x.targetId),q=Y&&Y.targetMismatches.get(x.targetId)!=null,J=x.view.applyChanges(K,E.isPrimaryClient,j,q);return u0(E,x.targetId,J.au),J.snapshot}(t,y,g,f);const o=await t0(t.localStore,e,!0),s=new w4(e,o.Qs),l=s.ru(o.documents),c=au.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),d=s.applyChanges(l,t.isPrimaryClient,c);u0(t,r,d.au);const u=new x4(e,r,s);return t.Tu.set(e,u),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),d.snapshot}async function T4(t,e,r){const n=jr(t),i=n.Tu.get(e),o=n.Iu.get(i.targetId);if(o.length>1)return n.Iu.set(i.targetId,o.filter(s=>!fp(s,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Tf(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Oy(n.remoteStore,i.targetId),Lf(n,i.targetId)}).catch(jc)):(Lf(n,i.targetId),await Tf(n.localStore,i.targetId,!0))}async function k4(t,e){const r=jr(t),n=r.Tu.get(e),i=r.Iu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Oy(r.remoteStore,n.targetId))}async function N4(t,e,r){const n=B4(t);try{const i=await function(s,l){const c=jr(s),d=Rn.now(),u=l.reduce((f,w)=>f.add(w.key),sn());let y,g;return c.persistence.runTransaction("Locally write mutations","readwrite",f=>{let w=Xs(),E=sn();return c.Ns.getEntries(f,u).next(x=>{w=x,w.forEach((T,Y)=>{Y.isValidDocument()||(E=E.add(T))})}).next(()=>c.localDocuments.getOverlayedDocuments(f,w)).next(x=>{y=x;const T=[];for(const Y of l){const K=W$(Y,y.get(Y.key).overlayedDocument);K!=null&&T.push(new Za(Y.key,K,G2(K.value.mapValue),fs.exists(!0)))}return c.mutationQueue.addMutationBatch(f,d,T,l)}).next(x=>{g=x;const T=x.applyToLocalDocumentSet(y,E);return c.documentOverlayCache.saveOverlays(f,x.batchId,T)})}).then(()=>({batchId:g.batchId,changes:n5(y)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(s,l,c){let d=s.Vu[s.currentUser.toKey()];d||(d=new Vn(on)),d=d.insert(l,c),s.Vu[s.currentUser.toKey()]=d}(n,i.batchId,r),await cu(n,i.changes),await Sp(n.remoteStore)}catch(i){const o=zy(i,"Failed to persist write");r.reject(o)}}async function V5(t,e){const r=jr(t);try{const n=await H3(r.localStore,e);e.targetChanges.forEach((i,o)=>{const s=r.Au.get(o);s&&(gn(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.hu=!0:i.modifiedDocuments.size>0?gn(s.hu,14607):i.removedDocuments.size>0&&(gn(s.hu,42227),s.hu=!1))}),await cu(r,n,e)}catch(n){await jc(n)}}function d0(t,e,r){const n=jr(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach((o,s)=>{const l=s.view.va(e);l.snapshot&&i.push(l.snapshot)}),function(s,l){const c=jr(s);c.onlineState=l;let d=!1;c.queries.forEach((u,y)=>{for(const g of y.Sa)g.va(l)&&(d=!0)}),d&&Uy(c)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function L4(t,e,r){const n=jr(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Au.get(e),o=i&&i.key;if(o){let s=new Vn(wr.comparator);s=s.insert(o,Bi.newNoDocument(o,Dr.min()));const l=sn().add(o),c=new bp(Dr.min(),new Map,new Vn(on),s,l);await V5(n,c),n.du=n.du.remove(o),n.Au.delete(e),Gy(n)}else await Tf(n.localStore,e,!1).then(()=>Lf(n,e,r)).catch(jc)}async function R4(t,e){const r=jr(t),n=e.batch.batchId;try{const i=await U3(r.localStore,e);z5(r,n,null),q5(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await cu(r,i)}catch(i){await jc(i)}}async function D4(t,e,r){const n=jr(t);try{const i=await function(s,l){const c=jr(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let u;return c.mutationQueue.lookupMutationBatch(d,l).next(y=>(gn(y!==null,37113),u=y.keys(),c.mutationQueue.removeMutationBatch(d,y))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,u,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,u)).next(()=>c.localDocuments.getDocuments(d,u))})}(n.localStore,e);z5(n,e,r),q5(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await cu(n,i)}catch(i){await jc(i)}}function q5(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function z5(t,e,r){const n=jr(t);let i=n.Vu[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(r?o.reject(r):o.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function Lf(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||U5(t,n)})}function U5(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Oy(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),Gy(t))}function u0(t,e,r){for(const n of r)n instanceof O5?(t.Ru.addReference(n.key,e),M4(t,n)):n instanceof B5?(dr(Hy,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||U5(t,n.key)):Nr(19791,{wu:n})}function M4(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(dr(Hy,"New document in limbo: "+r),t.Eu.add(n),Gy(t))}function Gy(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new wr(Nn.fromString(e)),n=t.fu.next();t.Au.set(n,new C4(r)),t.du=t.du.insert(r,n),I5(t.remoteStore,new Ra(ms(Iy(r.path)),n,"TargetPurposeLimboResolution",hp.ce))}}async function cu(t,e,r){const n=jr(t),i=[],o=[],s=[];n.Tu.isEmpty()||(n.Tu.forEach((l,c)=>{s.push(n.pu(c,e,r).then(d=>{if((d||r)&&n.isPrimaryClient){const u=d?!d.fromCache:r?.targetChanges.get(c.targetId)?.current;n.sharedClientState.updateQueryState(c.targetId,u?"current":"not-current")}if(d){i.push(d);const u=My.As(c.targetId,d);o.push(u)}}))}),await Promise.all(s),n.Pu.H_(i),await async function(c,d){const u=jr(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>kt.forEach(d,g=>kt.forEach(g.Es,f=>u.persistence.referenceDelegate.addReference(y,g.targetId,f)).next(()=>kt.forEach(g.ds,f=>u.persistence.referenceDelegate.removeReference(y,g.targetId,f)))))}catch(y){if(!Vc(y))throw y;dr(Fy,"Failed to update sequence numbers: "+y)}for(const y of d){const g=y.targetId;if(!y.fromCache){const f=u.Ms.get(g),w=f.snapshotVersion,E=f.withLastLimboFreeSnapshotVersion(w);u.Ms=u.Ms.insert(g,E)}}}(n.localStore,o))}async function F4(t,e){const r=jr(t);if(!r.currentUser.isEqual(e)){dr(Hy,"User change. New user:",e.toKey());const n=await C5(r.localStore,e);r.currentUser=e,function(o,s){o.mu.forEach(l=>{l.forEach(c=>{c.reject(new or(wt.CANCELLED,s))})}),o.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await cu(r,n.Ls)}}function O4(t,e){const r=jr(t),n=r.Au.get(e);if(n&&n.hu)return sn().add(n.key);{let i=sn();const o=r.Iu.get(e);if(!o)return i;for(const s of o){const l=r.Tu.get(s);i=i.unionWith(l.view.nu)}return i}}function H5(t){const e=jr(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=V5.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=O4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=L4.bind(null,e),e.Pu.H_=P4.bind(null,e.eventManager),e.Pu.yu=S4.bind(null,e.eventManager),e}function B4(t){const e=jr(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=R4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=D4.bind(null,e),e}class Xh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=_p(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return z3(this.persistence,new j3,e.initialUser,this.serializer)}Cu(e){return new x5(Dy.mi,this.serializer)}Du(e){return new J3}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Xh.provider={build:()=>new Xh};class j4 extends Xh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){gn(this.persistence.referenceDelegate instanceof Jh,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new C3(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?oo.withCacheSize(this.cacheSizeBytes):oo.DEFAULT;return new x5(n=>Jh.mi(n,r),this.serializer)}}class Rf{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>d0(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=F4.bind(null,this.syncEngine),await v4(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new _4}()}createDatastore(e){const r=_p(e.databaseInfo.databaseId),n=function(o){return new t4(o)}(e.databaseInfo);return function(o,s,l,c){return new o4(o,s,l,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,o,s,l){return new a4(n,i,o,s,l)}(this.localStore,this.datastore,e.asyncQueue,r=>d0(this.syncEngine,r,0),function(){return i0.v()?new i0:new Q3}())}createSyncEngine(e,r){return function(i,o,s,l,c,d,u){const y=new A4(i,o,s,l,c,d);return u&&(y.gu=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(r){const n=jr(r);dr(Fl,"RemoteStore shutting down."),n.Ea.add(5),await lu(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Rf.provider={build:()=>new Rf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G5{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Js("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ka="FirestoreClient";class V4{constructor(e,r,n,i,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Oi.UNAUTHENTICATED,this.clientId=wy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,async s=>{dr(Ka,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(n,s=>(dr(Ka,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ws;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=zy(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function hm(t,e){t.asyncQueue.verifyOperationInProgress(),dr(Ka,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await C5(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function h0(t,e){t.asyncQueue.verifyOperationInProgress();const r=await q4(t);dr(Ka,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>s0(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>s0(e.remoteStore,i)),t._onlineComponents=e}async function q4(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){dr(Ka,"Using user provided OfflineComponentProvider");try{await hm(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===wt.FAILED_PRECONDITION||i.code===wt.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Ec("Error using user provided cache. Falling back to memory cache: "+r),await hm(t,new Xh)}}else dr(Ka,"Using default OfflineComponentProvider"),await hm(t,new j4(void 0));return t._offlineComponents}async function W5(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(dr(Ka,"Using user provided OnlineComponentProvider"),await h0(t,t._uninitializedComponentsProvider._online)):(dr(Ka,"Using default OnlineComponentProvider"),await h0(t,new Rf))),t._onlineComponents}function z4(t){return W5(t).then(e=>e.syncEngine)}async function Y5(t){const e=await W5(t),r=e.eventManager;return r.onListen=$4.bind(null,e.syncEngine),r.onUnlisten=T4.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=E4.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=k4.bind(null,e.syncEngine),r}function U4(t,e,r={}){const n=new Ws;return t.asyncQueue.enqueueAndForget(async()=>function(o,s,l,c,d){const u=new G5({next:g=>{u.Nu(),s.enqueueAndForget(()=>M5(o,y));const f=g.docs.has(l);!f&&g.fromCache?d.reject(new or(wt.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&g.fromCache&&c&&c.source==="server"?d.reject(new or(wt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(g)},error:g=>d.reject(g)}),y=new F5(Iy(l.path),u,{includeMetadataChanges:!0,qa:!0});return D5(o,y)}(await Y5(t),t.asyncQueue,e,r,n)),n.promise}function H4(t,e,r={}){const n=new Ws;return t.asyncQueue.enqueueAndForget(async()=>function(o,s,l,c,d){const u=new G5({next:g=>{u.Nu(),s.enqueueAndForget(()=>M5(o,y)),g.fromCache&&c.source==="server"?d.reject(new or(wt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(g)},error:g=>d.reject(g)}),y=new F5(l,u,{includeMetadataChanges:!0,qa:!0});return D5(o,y)}(await Y5(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K5(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p0=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J5="firestore.googleapis.com",m0=!0;class f0{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new or(wt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=J5,this.ssl=m0}else this.host=e.host,this.ssl=e.ssl??m0;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=w5;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<w3)throw new or(wt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}a$("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=K5(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new or(wt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new or(wt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new or(wt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class wp{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new f0({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new or(wt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new or(wt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new f0(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new QA;switch(n.type){case"firstParty":return new t$(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new or(wt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=p0.get(r);n&&(dr("ComponentProvider","Removing Datastore"),p0.delete(r),n.terminate())}(this),Promise.resolve()}}function G4(t,e,r,n={}){t=Qs(t,wp);const i=Mc(e),o=t._getSettings(),s={...o,emulatorOptions:t._getEmulatorOptions()},l=`${e}:${r}`;i&&(B1(`https://${l}`),j1("Firestore",!0)),o.host!==J5&&o.host!==l&&Ec("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...o,host:l,ssl:i,emulatorOptions:n};if(!Ll(c,s)&&(t._setSettings(c),n.mockUserToken)){let d,u;if(typeof n.mockUserToken=="string")d=n.mockUserToken,u=Oi.MOCK_USER;else{d=Pw(n.mockUserToken,t._app?.options.projectId);const y=n.mockUserToken.sub||n.mockUserToken.user_id;if(!y)throw new or(wt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Oi(y)}t._authCredentials=new XA(new R2(d,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Vl(this.firestore,e,this._query)}}class Zn{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new qa(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Zn(this.firestore,e,this._key)}toJSON(){return{type:Zn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(ou(r,Zn._jsonSchema))return new Zn(e,n||null,new wr(Nn.fromString(r.referencePath)))}}Zn._jsonSchemaVersion="firestore/documentReference/1.0",Zn._jsonSchema={type:oi("string",Zn._jsonSchemaVersion),referencePath:oi("string")};class qa extends Vl{constructor(e,r,n){super(e,r,Iy(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Zn(this.firestore,null,new wr(e))}withConverter(e){return new qa(this.firestore,e,this._path)}}function W4(t,e,...r){if(t=Ci(t),D2("collection","path",e),t instanceof wp){const n=Nn.fromString(e,...r);return Ev(n),new qa(t,null,n)}{if(!(t instanceof Zn||t instanceof qa))throw new or(wt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Nn.fromString(e,...r));return Ev(n),new qa(t.firestore,null,n)}}function Q5(t,e,...r){if(t=Ci(t),arguments.length===1&&(e=wy.newId()),D2("doc","path",e),t instanceof wp){const n=Nn.fromString(e,...r);return $v(n),new Zn(t,null,new wr(n))}{if(!(t instanceof Zn||t instanceof qa))throw new or(wt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Nn.fromString(e,...r));return $v(n),new Zn(t.firestore,t instanceof qa?t.converter:null,new wr(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y0="AsyncQueue";class g0{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new $5(this,"async_queue_retry"),this._c=()=>{const n=um();n&&dr(y0,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=um();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=um();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Ws;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Vc(e))throw e;dr(y0,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Js("INTERNAL UNHANDLED ERROR: ",v0(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=qy.createAndSchedule(this,e,r,n,o=>this.hc(o));return this.tc.push(i),i}uc(){this.nc&&Nr(47125,{Pc:v0(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function v0(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class du extends wp{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new g0,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new g0(e),this._firestoreClient=void 0,await e}}}function Y4(t,e){const r=typeof t=="object"?t:U1(),n=typeof t=="string"?t:Uh,i=uy(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const o=bw("firestore");o&&G4(i,...o)}return i}function Wy(t){if(t._terminated)throw new or(wt.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||K4(t),t._firestoreClient}function K4(t){const e=t._freezeSettings(),r=function(i,o,s,l){return new v$(i,o,s,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,K5(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new V4(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(i){const o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ro(Ai.fromBase64String(e))}catch(r){throw new or(wt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Ro(Ai.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ro._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ou(e,Ro._jsonSchema))return Ro.fromBase64String(e.bytes)}}Ro._jsonSchemaVersion="firestore/bytes/1.0",Ro._jsonSchema={type:oi("string",Ro._jsonSchemaVersion),bytes:oi("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new or(wt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new wi(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yy{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new or(wt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new or(wt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return on(this._lat,e._lat)||on(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:gs._jsonSchemaVersion}}static fromJSON(e){if(ou(e,gs._jsonSchema))return new gs(e.latitude,e.longitude)}}gs._jsonSchemaVersion="firestore/geoPoint/1.0",gs._jsonSchema={type:oi("string",gs._jsonSchemaVersion),latitude:oi("number"),longitude:oi("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:vs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ou(e,vs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new vs(e.vectorValues);throw new or(wt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}vs._jsonSchemaVersion="firestore/vectorValue/1.0",vs._jsonSchema={type:oi("string",vs._jsonSchemaVersion),vectorValues:oi("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J4=/^__.*__$/;class Q4{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Za(e,this.data,this.fieldMask,r,this.fieldTransforms):new su(e,this.data,r,this.fieldTransforms)}}class X5{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Za(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function Z5(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Nr(40011,{Ac:t})}}class Ky{constructor(e,r,n,i,o,s){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Ky({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Zh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Z5(this.Ac)&&J4.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class X4{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||_p(e)}Cc(e,r,n,i=!1){return new Ky({Ac:e,methodName:r,Dc:n,path:wi.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Jy(t){const e=t._freezeSettings(),r=_p(t._databaseId);return new X4(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Z4(t,e,r,n,i,o={}){const s=t.Cc(o.merge||o.mergeFields?2:0,e,r,i);Qy("Data must be an object, but it was:",s,n);const l=e_(n,s);let c,d;if(o.merge)c=new bo(s.fieldMask),d=s.fieldTransforms;else if(o.mergeFields){const u=[];for(const y of o.mergeFields){const g=Df(e,y,r);if(!s.contains(g))throw new or(wt.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);r_(u,g)||u.push(g)}c=new bo(u),d=s.fieldTransforms.filter(y=>c.covers(y.field))}else c=null,d=s.fieldTransforms;return new Q4(new so(l),c,d)}class Cp extends Yy{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Cp}}function eE(t,e,r,n){const i=t.Cc(1,e,r);Qy("Data must be an object, but it was:",i,n);const o=[],s=so.empty();Xa(n,(c,d)=>{const u=Xy(e,c,r);d=Ci(d);const y=i.yc(u);if(d instanceof Cp)o.push(u);else{const g=uu(d,y);g!=null&&(o.push(u),s.set(u,g))}});const l=new bo(o);return new X5(s,l,i.fieldTransforms)}function tE(t,e,r,n,i,o){const s=t.Cc(1,e,r),l=[Df(e,n,r)],c=[i];if(o.length%2!=0)throw new or(wt.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<o.length;g+=2)l.push(Df(e,o[g])),c.push(o[g+1]);const d=[],u=so.empty();for(let g=l.length-1;g>=0;--g)if(!r_(d,l[g])){const f=l[g];let w=c[g];w=Ci(w);const E=s.yc(f);if(w instanceof Cp)d.push(f);else{const x=uu(w,E);x!=null&&(d.push(f),u.set(f,x))}}const y=new bo(d);return new X5(u,y,s.fieldTransforms)}function rE(t,e,r,n=!1){return uu(r,t.Cc(n?4:3,e))}function uu(t,e){if(t_(t=Ci(t)))return Qy("Unsupported field value:",e,t),e_(t,e);if(t instanceof Yy)return function(n,i){if(!Z5(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const o=[];let s=0;for(const l of n){let c=uu(l,i.wc(s));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),s++}return{arrayValue:{values:o}}}(t,e)}return function(n,i){if((n=Ci(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return V$(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=Rn.fromDate(n);return{timestampValue:Kh(i.serializer,o)}}if(n instanceof Rn){const o=new Rn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Kh(i.serializer,o)}}if(n instanceof gs)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Ro)return{bytesValue:y5(i.serializer,n._byteString)};if(n instanceof Zn){const o=i.databaseId,s=n.firestore._databaseId;if(!s.isEqual(o))throw i.Sc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Ly(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof vs)return function(s,l){return{mapValue:{fields:{[U2]:{stringValue:H2},[Hh]:{arrayValue:{values:s.toArray().map(d=>{if(typeof d!="number")throw l.Sc("VectorValues must only contain numeric values.");return Ty(l.serializer,d)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${up(n)}`)}(t,e)}function e_(t,e){const r={};return O2(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Xa(t,(n,i)=>{const o=uu(i,e.mc(n));o!=null&&(r[n]=o)}),{mapValue:{fields:r}}}function t_(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Rn||t instanceof gs||t instanceof Ro||t instanceof Zn||t instanceof Yy||t instanceof vs)}function Qy(t,e,r){if(!t_(r)||!M2(r)){const n=up(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function Df(t,e,r){if((e=Ci(e))instanceof xp)return e._internalPath;if(typeof e=="string")return Xy(t,e);throw Zh("Field path arguments must be of type string or ",t,!1,void 0,r)}const nE=new RegExp("[~\\*/\\[\\]]");function Xy(t,e,r){if(e.search(nE)>=0)throw Zh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new xp(...e.split("."))._internalPath}catch{throw Zh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Zh(t,e,r,n,i){const o=n&&!n.isEmpty(),s=i!==void 0;let l=`Function ${e}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${n}`),s&&(c+=` in document ${i}`),c+=")"),new or(wt.INVALID_ARGUMENT,l+t+c)}function r_(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n_{constructor(e,r,n,i,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Zn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new iE(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Zy("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class iE extends n_{data(){return super.data()}}function Zy(t,e){return typeof e=="string"?Xy(t,e):e instanceof xp?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oE(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new or(wt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class eg{}class i_ extends eg{}function sE(t,e,...r){let n=[];e instanceof eg&&n.push(e),n=n.concat(r),function(o){const s=o.filter(c=>c instanceof rg).length,l=o.filter(c=>c instanceof tg).length;if(s>1||s>0&&l>0)throw new or(wt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class tg extends i_{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new tg(e,r,n)}_apply(e){const r=this._parse(e);return o_(e._query,r),new Vl(e.firestore,e.converter,xf(e._query,r))}_parse(e){const r=Jy(e.firestore);return function(o,s,l,c,d,u,y){let g;if(d.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new or(wt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){_0(y,u);const w=[];for(const E of y)w.push(b0(c,o,E));g={arrayValue:{values:w}}}else g=b0(c,o,y)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||_0(y,u),g=rE(l,s,y,u==="in"||u==="not-in");return ii.create(d,u,g)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}class rg extends eg{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new rg(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Ko.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,o){let s=i;const l=o.getFlattenedFilters();for(const c of l)o_(s,c),s=xf(s,c)}(e._query,r),new Vl(e.firestore,e.converter,xf(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class ng extends i_{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new ng(e,r)}_apply(e){const r=function(i,o,s){if(i.startAt!==null)throw new or(wt.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new or(wt.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Gd(o,s)}(e._query,this._field,this._direction);return new Vl(e.firestore,e.converter,function(i,o){const s=i.explicitOrderBy.concat([o]);return new qc(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}function aE(t,e="asc"){const r=e,n=Zy("orderBy",t);return ng._create(n,r)}function b0(t,e,r){if(typeof(r=Ci(r))=="string"){if(r==="")throw new or(wt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Z2(e)&&r.indexOf("/")!==-1)throw new or(wt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Nn.fromString(r));if(!wr.isDocumentKey(n))throw new or(wt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Mv(t,new wr(n))}if(r instanceof Zn)return Mv(t,r._key);throw new or(wt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${up(r)}.`)}function _0(t,e){if(!Array.isArray(t)||t.length===0)throw new or(wt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function o_(t,e){const r=function(i,o){for(const s of i)for(const l of s.getFlattenedFilters())if(o.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new or(wt.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new or(wt.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class lE{convertValue(e,r="none"){switch(Wa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Yn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Ga(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Nr(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Xa(e,(i,o)=>{n[i]=this.convertValue(o,r)}),n}convertVectorValue(e){const r=e.fields?.[Hh].arrayValue?.values?.map(n=>Yn(n.doubleValue));return new vs(r)}convertGeoPoint(e){return new gs(Yn(e.latitude),Yn(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=mp(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(zd(e));default:return null}}convertTimestamp(e){const r=Ha(e);return new Rn(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Nn.fromString(e);gn(S5(n),9688,{name:e});const i=new Ud(n.get(1),n.get(3)),o=new wr(n.popFirst(5));return i.isEqual(r)||Js(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cE(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class vd{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Al extends n_{constructor(e,r,n,i,o,s){super(e,r,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new wh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Zy("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new or(wt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Al._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Al._jsonSchemaVersion="firestore/documentSnapshot/1.0",Al._jsonSchema={type:oi("string",Al._jsonSchemaVersion),bundleSource:oi("string","DocumentSnapshot"),bundleName:oi("string"),bundle:oi("string")};class wh extends Al{data(e={}){return super.data(e)}}class xc{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new vd(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new wh(this._firestore,this._userDataWriter,n.key,n,new vd(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new or(wt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(l=>{const c=new wh(i._firestore,i._userDataWriter,l.doc.key,l.doc,new vd(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>o||l.type!==3).map(l=>{const c=new wh(i._firestore,i._userDataWriter,l.doc.key,l.doc,new vd(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,u=-1;return l.type!==0&&(d=s.indexOf(l.doc.key),s=s.delete(l.doc.key)),l.type!==1&&(s=s.add(l.doc),u=s.indexOf(l.doc.key)),{type:dE(l.type),doc:c,oldIndex:d,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new or(wt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=xc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=wy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function dE(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Nr(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uE(t){t=Qs(t,Zn);const e=Qs(t.firestore,du);return U4(Wy(e),t._key).then(r=>mE(e,t,r))}xc._jsonSchemaVersion="firestore/querySnapshot/1.0",xc._jsonSchema={type:oi("string",xc._jsonSchemaVersion),bundleSource:oi("string","QuerySnapshot"),bundleName:oi("string"),bundle:oi("string")};class s_ extends lE{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ro(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Zn(this.firestore,null,r)}}function hE(t){t=Qs(t,Vl);const e=Qs(t.firestore,du),r=Wy(e),n=new s_(e);return oE(t._query),H4(r,t._query).then(i=>new xc(e,n,t,i))}function pE(t,e,r){t=Qs(t,Zn);const n=Qs(t.firestore,du),i=cE(t.converter,e);return l_(n,[Z4(Jy(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,fs.none())])}function a_(t,e,r,...n){t=Qs(t,Zn);const i=Qs(t.firestore,du),o=Jy(i);let s;return s=typeof(e=Ci(e))=="string"||e instanceof xp?tE(o,"updateDoc",t._key,e,r,n):eE(o,"updateDoc",t._key,e),l_(i,[s.toMutation(t._key,fs.exists(!0))])}function l_(t,e){return function(n,i){const o=new Ws;return n.asyncQueue.enqueueAndForget(async()=>N4(await z4(n),i,o)),o.promise}(Wy(t),e)}function mE(t,e,r){const n=r.docs.get(e._key),i=new s_(t);return new Al(t,i,e._key,n,new vd(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){Bc=i})(Fc),Ac(new Rl("firestore",(n,{instanceIdentifier:i,options:o})=>{const s=n.getProvider("app").getImmediate(),l=new du(new ZA(n.getProvider("auth-internal")),new r$(s,n.getProvider("app-check-internal")),function(d,u){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new or(wt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ud(d.options.projectId,u)}(s,i),s);return o={useFetchStreams:r,...o},l._setSettings(o),l},"PUBLIC").setMultipleInstances(!0)),Ba(wv,xv,e),Ba(wv,xv,"esm2020")})();let fE="eyAiYXBpS2V5IjogIkFJemFTeUJBbGN2WlRMMXRsQ05LRExENEJpTWJhR01iTnhCRjQtTSIsICAiYXV0aERvbWFpbiI6ICJocm0tMTEyOC5maXJlYmFzZWFwcC5jb20iLCAgImRhdGFiYXNlVVJMIjogImh0dHBzOi8vaHJtLTExMjguZmlyZWJhc2Vpby5jb20iLCAgInByb2plY3RJZCI6ICJocm0tMTEyOCIsICAic3RvcmFnZUJ1Y2tldCI6ICJocm0tMTEyOC5hcHBzcG90LmNvbSIsICAibWVzc2FnaW5nU2VuZGVySWQiOiAiMTA0OTI1MDU4NTI0NSIsICAiYXBwSWQiOiAiMToxMDQ5MjUwNTg1MjQ1OndlYjowZGFkMDAyMDI3MjM1MTRjY2M1Mjc0In0=";const c_=z1(JSON.parse(dw(fE))),gl=WA(c_),ep=new us,Mf=Y4(c_);ep.addScope("profile");ep.addScope("email");class bd extends Error{}bd.prototype.name="InvalidTokenError";function yE(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function gE(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return yE(e)}catch{return atob(e)}}function vE(t,e){if(typeof t!="string")throw new bd("Invalid token specified: must be a string");e||(e={});const r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new bd(`Invalid token specified: missing part #${r+1}`);let i;try{i=gE(n)}catch(o){throw new bd(`Invalid token specified: invalid base64 for part #${r+1} (${o.message})`)}try{return JSON.parse(i)}catch(o){throw new bd(`Invalid token specified: invalid json for part #${r+1} (${o.message})`)}}const bE={clientId:"195275085181-8ccjpgp8v1g80qhnlk6v4lpgid7n81gr.apps.googleusercontent.com"},_E=t=>{const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>{window.google&&window.google.accounts.id.initialize({client_id:bE.clientId,callback:r=>{t(r.credential)},auto_select:!1,cancel_on_tap_outside:!0})},document.head.appendChild(e)},PE=t=>vE(t),SE=()=>{window.google&&window.google.accounts.id.disableAutoSelect()},[wE,xE]=Zd({}),CE=async()=>{const e=await yn({query:"qcm42351987"});if(e&&!e.error){let n=Object.assign({},{},e);xE(n)}return 1},AE=async t=>{let e=wE?.[992002];e&&(e.params={tkn:t})},[oc,Mi]=Zd({user:null,loading:!0,error:null,authMethod:null}),[d_,P0]=we(null);RC(gl,t=>{t?Mi({user:t,loading:!1,error:null,authMethod:"firebase"}):d_()||Mi({user:null,loading:!1,error:null,authMethod:null})});cA(gl).then(t=>{t&&Mi({user:t.user,loading:!1,error:null,authMethod:"firebase"})}).catch(t=>{console.error("Redirect sign-in error:",t),Mi({loading:!1,error:t.message})});const vr={get state(){return oc},async getUserProfile(t){try{const e=Q5(Mf,"users",t),r=await uE(e);if(r.exists()){Mi("profile",r.data());let n={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_2376:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1},i=r.data(),o={};return Object.keys(n).map(s=>{let l=n?.[s];i.hasOwnProperty(s)||(o[s]=l)}),Object.keys(o).length>0&&a_(e,o),r.data()}else{let n=vr?.state?.user,i={uid:n?.uid,email:n?.email,displayName:n?.displayName,createdAt:new Date,stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_2376:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};return await pE(e,i),console.log("No such user profile!"),null}}catch(e){return console.error("Error fetching user profile:",e),null}},getBusinessId:()=>vr.state?.profile?.businessId,hasPermission:t=>{const e=vr.state?.profile;return e?.isAdmin?!0:e?e?.[t]===!0:!1},async signInWithGoogle(){try{Mi("loading",!0),Mi("error",null);try{const t=await tA(gl,ep);Mi({user:t.user,loading:!1,error:null,authMethod:"firebase"});try{vr.getUserProfile(t.user.uid)}catch(e){console.error("firestore error:",e)}}catch(t){if(t.code==="auth/popup-blocked")await aA(gl,ep);else throw t}}catch(t){console.error("Sign-in error:",t),Mi({loading:!1,error:t.message||"Failed to sign in with Google"})}},async signInWithGoogleP(t){const r=await yn({params:{id_token:t},query:"getGoogleUserbyToken"});if(r&&r){let n=new Date().getTime(),i=new Date(n+6e4*60*24*365),o="hrm_tkn_acc";document.cookie=`${o}=${r.data}; expires=${i}; path=/;g_state = {"i_l":1,"i_p":${i}}; ssgl_access_tkn = ${t}`,document.cookie=`ssgl_access_tkn = ${t}; expires=${i};`,await CE(),AE(r.data)}},async signInWithGoogleCloud(t){try{Mi("loading",!0),Mi("error",null);const e=PE(t),r={uid:e.sub,email:e.email,displayName:e.name,photoURL:e.picture};P0(r);const n={uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,emailVerified:!0};Mi({user:n,loading:!1,error:null,authMethod:"google-cloud"});try{const i=us.credential(t);await kC(gl,i)}catch{console.log("Firebase sign-in optional, continuing with Google Cloud auth")}}catch(e){console.error("Google Cloud sign-in error:",e),Mi({loading:!1,error:e.message||"Failed to sign in with Google Cloud"})}},async signOut(){try{Mi("loading",!0),(oc.authMethod==="firebase"||gl.currentUser)&&await DC(gl),oc.authMethod==="google-cloud"&&(SE(),P0(null)),Mi({user:null,loading:!1,error:null,authMethod:null})}catch(t){console.error("Sign-out error:",t),Mi({loading:!1,error:t.message||"Failed to sign out"})}},get isAuthenticated(){return!!oc.user||!!d_()},get currentUser(){return oc.user},get authMethod(){return oc.authMethod}},$E=async()=>({}),EE=()=>(typeof window<"u"&&localStorage.getItem("hrmfinance-api-mode"),"real");let vl=EE();const Ff={getMode(){return vl},setMode(t){vl=t,typeof window<"u"&&localStorage.setItem("hrmfinance-api-mode",t)},isFakeMode(){return vl==="fake"},isRealMode(){return vl==="real"},isHybridMode(){return vl==="hybrid"}},kn=async(t,e,r=!0)=>{if(vl==="fake")return e();if(vl==="real")return t();try{return await t()}catch(n){if(console.warn("Real API failed, falling back to fake server:",n),r)return e();throw n}},S0={async getAll(t,e){const r=await yn({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:{businessId:vr.getBusinessId(),":search0":"produ"}});return Pl(r)},async getById(t){return kn(async()=>(await this.getAll()).find(r=>r.id===t)||null,()=>$n.products.getById(t))},async create(t){return kn(async()=>{throw console.log("Creating product via real API:",t),new Error("Real API not implemented yet")},()=>$n.products.create(t))},async update(t,e){return kn(async()=>{throw console.log("Updating product via real API:",t,e),new Error("Real API not implemented yet")},()=>$n.products.update(t,e))},async delete(t){return kn(async()=>{throw console.log("Deleting product via real API:",t),new Error("Real API not implemented yet")},()=>$n.products.delete(t))}},qi={async getInventory(t,e){if(!(t&&t?.trim()))return[];let r={businessId:vr.getBusinessId()};return t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())}),await yn({query:"getScanYabaInventory",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async getProducts(t){if(!(t&&t?.trim()))return[];let e={businessId:vr.getBusinessId()};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await yn({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getConsigee(t){if(!(t&&t?.trim()))return[];let e={businessId:"all"};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await yn({query:"getScanConsigneeYabaExpress",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getShipper(t){if(!(t&&t?.trim()))return[];let e={businessId:"all"};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await yn({query:"getScanShipperYabaExpress",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getInvoice(t,e){if(!(t&&t?.trim()))return[];let r={businessId:vr.getBusinessId()};return t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())}),await yn({query:"getScanYabaSalesOrders",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async addInventory(t){let r={query:"addYabaInventory",params:{businessId:vr.getBusinessId()},form:t};return await yn(r)},async updInventory(t){return vr.getBusinessId(),await $E()},async addInvoice(t){let r={query:"addYabaSalesOrders",params:{businessId:vr.getBusinessId()},form:t};return await yn(r)},async getHBLS(t,e){if(!(t&&t?.trim()))return[];let r={businessId:vr.getBusinessId()};e?.search,e?.guia&&e.guia!=="all"&&(r.guia=e.guia),t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())});let n={query:"getScanYabaHbls",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4 AND guia = guia",params:r};const i=await yn(n);return console.log(n),console.log(i),i}},ig={async getAll(t){return qi.getInventory("ref")},async getById(t){return kn(async()=>{throw console.log("Getting movement by ID via real API:",t),new Error("Real API not implemented yet")},()=>$n.movements.getById(t))},async create(t){return kn(async()=>{throw console.log("Creating movement via real API:",t),new Error("Real API not implemented yet")},()=>$n.movements.create(t))},async update(t,e){return kn(async()=>{throw console.log("Updating movement via real API:",t,e),new Error("Real API not implemented yet")},()=>$n.movements.update(t,e))},async createBulk(t){return kn(async()=>{throw console.log("Creating bulk movements via real API:",t),new Error("Real API not implemented yet")},()=>$n.movements.createBulk(t))},async getStockLevels(t){return await yn({query:"calculateInventoryStock",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:t})},async calcStockLevels(){return[]}},Id={async getAlls(t,e){if(console.log("getAlls",t),!(t&&t?.trim()))return[];let r={businessId:"hcPiDPfZFS8ymqoh"};e?.search,t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())});const i=await yn({query:"getAllAccountsByUserId",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4 AND guia = guia",params:r});return console.log(i),i},async getAll(t){return kn(async()=>{throw console.log("Getting accounts via real API:",t),new Error("Real API not implemented yet")},()=>$n.accounts.getAll(t))},async getById(t){return kn(async()=>{throw console.log("Getting account by ID via real API:",t),new Error("Real API not implemented yet")},()=>$n.accounts.getById(t))},async create(t){let r={query:"addAccounts",params:{businessId:"hcPiDPfZFS8ymqoh"},form:t};console.log(r);const n=await yn(r);return console.log(n),n},async update(t,e){let n={query:"updateAccounts",params:{businessId:"hcPiDPfZFS8ymqoh",accountId:t},data2update:e};console.log(n);const i=await yn(n);return console.log(i),i},async delete(t){let r={query:"deleteAccounts",params:{businessId:"hcPiDPfZFS8ymqoh",accountId:t}};console.log(r);const n=await yn(r);return console.log(n),n}},pm={async getAll(t,e){if(console.log("getAlls",t),!(t&&t?.trim()))return[];let r={businessId:"hcPiDPfZFS8ymqoh"};return e?.search,t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())}),await yn({query:"getScanSSGEntryBooks",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4 AND createdTimeStamp > :date1 AND createdTimeStamp < :date2 AND account contain :account AND subAccount contain :subAccount AND status = :status",params:r})},async getById(t){return kn(async()=>{throw console.log("Getting journal entry by ID via real API:",t),new Error("Real API not implemented yet")},()=>$n.journal.getById(t))},async create(t){return await yn({query:"addSSGEntryBooks",params:{businessId:"hcPiDPfZFS8ymqoh"},form:t})},async update(t,e){return await yn({query:"updateSSGEntryBooks",params:{businessId:"hcPiDPfZFS8ymqoh",id:t},form:e})},async post(t){return kn(async()=>{throw console.log("Posting journal entry via real API:",t),new Error("Real API not implemented yet")},()=>$n.journal.post(t))}},w0={async getNextEntryNumber(){return kn(async()=>{throw console.log("Getting next entry number via real API"),new Error("Real API not implemented yet")},()=>$n.utils.getNextEntryNumber())},async getNextProductCode(t){return kn(async()=>{throw console.log("Getting next product code via real API:",t),new Error("Real API not implemented yet")},()=>$n.utils.getNextProductCode(t))},async healthCheck(){return kn(async()=>{const t=await fetch("/api/health");if(!t.ok)throw new Error("Health check failed");return t.json()},()=>$n.utils.healthCheck())},async getStats(){return kn(async()=>{throw console.log("Getting stats via real API"),new Error("Real API not implemented yet")},()=>$n.utils.getStats())}},IE=()=>{Ff.setMode("real"),console.log(" HRM Finance initialized in REAL API mode for production")};IE();var TE=ae("<p>"),kE=ae('<div><div><div><h1>HRM Finance</h1><p>Complete Business Management Solution</p><div><div><button><svg width=24 height=24 viewBox="0 0 24 24"><path fill=#4285F4 d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path><path fill=#34A853 d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path><path fill=#FBBC05 d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path><path fill=#EA4335 d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path></svg></button><p>Firebase Authentication</p></div></div></div><div><div><div></div><h3>Financial Management</h3><p>Complete chart of accounts, balance sheets, journal entries, and invoice management in one place.</p></div><div><div></div><h3>HR Management</h3><p>Track employees, manage onboarding, and monitor your workforce with powerful analytics.</p></div><div><div></div><h3>Inventory Control</h3><p>Real-time inventory tracking, product management, and movement history across multiple locations.</p></div><div><div></div><h3>Banking Integration</h3><p>Streamline bank reconciliation with CSV imports and automated consolidation features.</p></div><div><div></div><h3>Real-time Analytics</h3><p>Get instant insights with dashboards showing revenue, cash flow, and business performance.</p></div><div><div></div><h3>Multi-language Support</h3><p>Available in multiple languages to support your global business operations.</p></div></div><div><p>Secure authentication powered by Google  Your data is encrypted and protected</p><p>Choose your preferred authentication method above');const NE=()=>{jn(()=>{_E(x=>{vr.signInWithGoogleP(x)}),setTimeout(()=>{},100)});const t={"min-height":"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},e={background:"white","border-radius":"1rem","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","max-width":"1200px",width:"100%",overflow:"hidden"},r={padding:"3rem","text-align":"center","border-bottom":"1px solid #e2e8f0"},n={"font-size":"2.5rem","font-weight":"800",color:"#1a202c","margin-bottom":"1rem"},i={"font-size":"1.125rem",color:"#718096","margin-bottom":"2rem"},o={display:"flex","flex-direction":"column",gap:"1rem","align-items":"center","margin-bottom":"1rem"},s={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"2rem",padding:"3rem"},l={"text-align":"center",padding:"2rem","border-radius":"0.5rem",background:"#f7fafc",transition:"transform 0.2s",cursor:"default"},c={"font-size":"3rem","margin-bottom":"1rem"},d={"font-size":"1.25rem","font-weight":"600",color:"#2d3748","margin-bottom":"0.5rem"},u={color:"#718096","line-height":"1.6"},y={display:"inline-flex","align-items":"center",gap:"0.75rem",background:"white",color:"#4285f4",border:"2px solid #4285f4",padding:"0.75rem 2rem","font-size":"1.125rem","font-weight":"500","border-radius":"0.5rem",cursor:"pointer",transition:"all 0.2s","min-width":"250px","justify-content":"center"},g={color:"#e53e3e","margin-top":"1rem","font-size":"0.875rem"},f={background:"#f7fafc",padding:"2rem","text-align":"center",color:"#718096","font-size":"0.875rem"},w={"font-size":"0.75rem",color:"#718096","margin-top":"0.25rem","font-style":"italic"},E=()=>{vr.signInWithGoogle()};return(()=>{var x=kE(),T=x.firstChild,Y=T.firstChild,K=Y.firstChild,j=K.nextSibling,q=j.nextSibling,J=q.firstChild,C=J.firstChild;C.firstChild;var P=C.nextSibling,$=Y.nextSibling,D=$.firstChild,b=D.firstChild,S=b.nextSibling,v=S.nextSibling,z=D.nextSibling,re=z.firstChild,L=re.nextSibling,O=L.nextSibling,ne=z.nextSibling,X=ne.firstChild,W=X.nextSibling,se=W.nextSibling,F=ne.nextSibling,k=F.firstChild,N=k.nextSibling,A=N.nextSibling,V=F.nextSibling,Z=V.firstChild,H=Z.nextSibling,B=H.nextSibling,M=V.nextSibling,G=M.firstChild,Q=G.nextSibling,ie=Q.nextSibling,me=$.nextSibling,oe=me.firstChild,ee=oe.nextSibling;return p(x,t),p(T,e),p(Y,r),p(K,n),p(j,i),p(q,o),C.addEventListener("mouseleave",de=>{de.currentTarget.style.background="white",de.currentTarget.style.color="#4285f4"}),C.addEventListener("mouseenter",de=>{de.currentTarget.style.background="#4285f4",de.currentTarget.style.color="white"}),C.$$click=E,p(C,y),a(C,I(Oe,{get when(){return vr.state.loading},fallback:"Sign in with Google",children:"Signing in..."}),null),p(P,w),a(Y,I(Oe,{get when(){return vr.state.error},get children(){var de=TE();return p(de,g),a(de,()=>vr.state.error),de}}),null),p($,s),p(me,f),ee.style.setProperty("margin-top","0.5rem"),ee.style.setProperty("font-size","0.75rem"),fe(de=>{var he=vr.state.loading,le=l,ye=c,ve=d,pe=u,ge=l,ke=c,Ne=d,xe=u,$e=l,Ee=c,Me=d,Ye=u,ze=l,je=c,Xe=d,ht=u,ut=l,Ue=c,it=d,dt=u,Fe=l,Be=c,Re=d,lt=u;return he!==de.e&&(C.disabled=de.e=he),de.t=p(D,le,de.t),de.a=p(b,ye,de.a),de.o=p(S,ve,de.o),de.i=p(v,pe,de.i),de.n=p(z,ge,de.n),de.s=p(re,ke,de.s),de.h=p(L,Ne,de.h),de.r=p(O,xe,de.r),de.d=p(ne,$e,de.d),de.l=p(X,Ee,de.l),de.u=p(W,Me,de.u),de.c=p(se,Ye,de.c),de.w=p(F,ze,de.w),de.m=p(k,je,de.m),de.f=p(N,Xe,de.f),de.y=p(A,ht,de.y),de.g=p(V,ut,de.g),de.p=p(Z,Ue,de.p),de.b=p(H,it,de.b),de.T=p(B,dt,de.T),de.A=p(M,Fe,de.A),de.O=p(G,Be,de.O),de.I=p(Q,Re,de.I),de.S=p(ie,lt,de.S),de},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0}),x})()};br(["click"]);var LE=ae("<div><div>");const RE=t=>{const e={"min-height":"100vh",display:"flex","align-items":"center","justify-content":"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},r={width:"50px",height:"50px",border:"3px solid rgba(255, 255, 255, 0.3)","border-top-color":"white","border-radius":"50%",animation:"spin 1s linear infinite"},n=document.createElement("style");return n.textContent=`
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  `,document.head.appendChild(n),xi(async()=>{vr.state?.user?.uid&&vr.getUserProfile(vr.state?.user?.uid)}),jn(()=>{}),I(Oe,{get when(){return!vr.state.loading},get fallback(){return(()=>{var i=LE(),o=i.firstChild;return p(i,e),p(o,r),i})()},get children(){return I(Oe,{get when(){return vr.isAuthenticated},get fallback(){return I(NE,{})},get children(){return t.children}})}})};var DE=ae("<button>");const _t=t=>{const e=()=>{const r={"font-family":"inherit",cursor:t.disabled?"not-allowed":"pointer",border:"none","border-radius":"var(--border-radius-sm)","font-weight":"500",transition:"all 0.2s ease","text-decoration":"none",display:"inline-flex","align-items":"center","justify-content":"center",gap:"0.5rem",opacity:t.disabled?"0.6":"1"},n={sm:{padding:"0.5rem 1rem","font-size":"0.875rem"},md:{padding:"0.75rem 1.5rem","font-size":"1rem"},lg:{padding:"1rem 2rem","font-size":"1.125rem"}},i={primary:{background:"linear-gradient(135deg, var(--primary-color), var(--primary-dark))",color:"white","box-shadow":"var(--shadow-sm)"},secondary:{background:"var(--surface-color)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},outline:{background:"transparent",color:"var(--primary-color)",border:"1px solid var(--primary-color)"}};return{...r,...n[t.size||"md"],...i[t.variant||"primary"]}};return(()=>{var r=DE();return Xn(r,"click",t.onClick,!0),a(r,()=>t.children),fe(n=>{var i=e(),o=t.disabled,s=t.type||"button",l=`btn btn-${t.variant||"primary"} ${t.className||""}`;return n.e=p(r,i,n.e),o!==n.t&&(r.disabled=n.t=o),s!==n.a&&ir(r,"type",n.a=s),l!==n.o&&iy(r,n.o=l),n},{e:void 0,t:void 0,a:void 0,o:void 0}),r})()};br(["click"]);var ME=ae("<div><div><div><h2></h2><button></button></div><div>");const si=t=>{const e={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},r={background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)",width:"90%","max-height":"80vh",overflow:"auto",position:"relative"},n={padding:"1.5rem","border-bottom":"1px solid var(--border-color)",display:"flex","justify-content":"space-between","align-items":"center"},i={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},o={background:"none",border:"none","font-size":"1.5rem",cursor:"pointer",color:"var(--text-muted)",padding:"0.5rem","border-radius":"var(--border-radius-sm)"},s={padding:"1.5rem"},l=c=>{c.target===c.currentTarget&&t.onClose()};return I(Oe,{get when(){return t.isOpen},get children(){var c=ME(),d=c.firstChild,u=d.firstChild,y=u.firstChild,g=y.nextSibling,f=u.nextSibling;return c.$$click=l,p(u,n),p(y,i),a(y,()=>t.title),g.addEventListener("mouseleave",w=>w.target.style.background="none"),g.addEventListener("mouseenter",w=>w.target.style.background="var(--background-color)"),Xn(g,"click",t.onClose,!0),p(g,o),p(f,s),a(f,()=>t.children),fe(w=>{var E=e,x=r;return w.e=p(c,E,w.e),w.t=p(d,x,w.t),w},{e:void 0,t:void 0}),c}})};br(["click"]);var x0=ae("<div>"),FE=ae("<h3>"),OE=ae("<p>");const Gt=t=>{const e={background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"1.5rem","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",transition:"all 0.2s ease",cursor:t.onClick?"pointer":"default",margin:"9px"},r={"margin-bottom":"1rem"},n={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0 0 0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)",margin:"0"};return(()=>{var o=x0();return Xn(o,"click",t.onClick,!0),a(o,(()=>{var s=Te(()=>!!(t.title||t.subtitle));return()=>s()&&(()=>{var l=x0();return p(l,r),a(l,(()=>{var c=Te(()=>!!t.title);return()=>c()&&(()=>{var d=FE();return p(d,n),a(d,()=>t.title),d})()})(),null),a(l,(()=>{var c=Te(()=>!!t.subtitle);return()=>c()&&(()=>{var d=OE();return p(d,i),a(d,()=>t.subtitle),d})()})(),null),l})()})(),null),a(o,()=>t.children,null),fe(s=>{var l=e,c=`card ${t.className||""}`;return s.e=p(o,l,s.e),c!==s.t&&iy(o,s.t=c),s},{e:void 0,t:void 0}),o})()};br(["click"]);var BE=ae("<div><label></label><input>"),jE=ae("<span>*");const Mr=t=>{const e={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},r={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},n={"margin-bottom":"1rem"},[i,o]=we("");xi(()=>{t?.value!==void 0&&o(t.value.toString())});const s=c=>{(c.key==="Enter"||c.key==="Escape"||c.key==="Tab")&&t.onChange&&Gs(i())&&t.onChange(i())},l=()=>{Gs(i())&&t.onChange(i())};return(()=>{var c=BE(),d=c.firstChild,u=d.nextSibling;return p(c,n),p(d,e),a(d,()=>t.label,null),a(d,(()=>{var y=Te(()=>!!t.required);return()=>y()&&(()=>{var g=jE();return g.style.setProperty("color","var(--primary-color)"),g})()})(),null),u.addEventListener("blur",y=>{l(),y.target.style.borderColor="var(--border-color)"}),u.addEventListener("focus",y=>{y.target.style.borderColor="var(--primary-color)"}),u.$$keydown=s,u.$$input=y=>o(y.target.value),p(u,r),fe(y=>{var g=t.type||"text",f=t.placeholder,w=t.required,E=t.disabled;return g!==y.e&&ir(u,"type",y.e=g),f!==y.t&&ir(u,"placeholder",y.t=f),w!==y.a&&(u.required=y.a=w),E!==y.o&&(u.disabled=y.o=E),y},{e:void 0,t:void 0,a:void 0,o:void 0}),fe(()=>u.value=i()),c})()};br(["input","keydown"]);const VE={en:{common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",close:"Close",search:"Search",filter:"Filter",reset:"Reset",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",actions:"Actions",status:"Status",active:"Active",inactive:"Inactive",date:"Date",time:"Time",description:"Description",notes:"Notes",amount:"Amount",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Language",english:"English",spanish:"Spanish",noDataFound:"No data found",required:"Required",optional:"Optional",all:"All",none:"None",select:"Select",clear:"Clear",searching:"Searching...",refresh:"Refresh",showAll:"Show All",products:"products",filtered:"Filtered",view:"View",suggested:"Suggested",clearFilters:"Clear Filters",enhanced:"Enhanced",legacy:"Legacy",email:"Email",phone:"Phone",address:"Address",name:"Name",code:"Code",category:"Category",type:"Type",quantity:"Quantity",price:"Price",cost:"Cost",value:"Value",balance:"Balance",created:"Created",modified:"Modified",details:"Details",summary:"Summary",history:"History",new:"New",addNew:"Add New",unknown:"Unknown",notAvailable:"N/A",remove:"Remove",startDate:"Start Date",endDate:"End Date",from:"From",invoice:"Invoice",invoices:"invoices",reference:"Reference",createdBy:"Created By",units:"units",invoiceDocumentId:"Invoice/Document ID",referenceNumber:"Reference Number",referenceNumberPlaceholder:"Enter reference number...",generalNotes:"General Notes",auto:"Auto",optionalNotes:"Optional notes...",showPerPage:"Show per page",first:"First",last:"Last",store:"Store",orderId:"Order ID",tax:"Tax",paymentMethods:"Payment Methods",cash:"Cash",creditCard:"Credit Card",shipping:"Shipping",air:"Air",sea:"Sea",thankYouBusiness:"Thank you for your business!",thankForChoosingUs:"Thank you for choosing us!",taxExemptNote:"Tax exempted on cash payment.",youSaved:"You saved",generatedOn:"Generated on",printSavePDF:"Print / Save as PDF",pageOfPages:"Page {{current}} of {{total}}",showingXofY:"Showing {{start}}-{{end}} of {{total}}",page:"Page",of:"of",print:"Print",export:"Export",pending:"Pending",completed:"Completed",customer:"Customer",location:"Location",reservations:"Reservations",backToDashboard:"Back to Dashboard",lbs:"pounds"},navigation:{dashboard:"Dashboard",accounts:"Chart of Accounts",balanceSheet:"Balance Sheet",inventory:"Inventory",employees:"Employees",entryBooks:"Entry Books",consolidate:"Bank Consolidation",reports:"Reports",settings:"Settings"},dashboard:{title:"Dashboard",welcome:"Welcome to HRM Finance",totalRevenue:"Total Revenue",overview:"Overview",recentActivity:"Recent Activity",quickActions:"Quick Actions",employeeCount:"Employee Count",pendingInvoices:"Pending Invoices",cashBalance:"Cash Balance",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalExpenses:"Total Expenses",netIncome:"Net Income",netLoss:"Net Loss",monthlyPayroll:"Monthly Payroll",current:"Current",newHires:"+3 new hires",outstanding:"Outstanding",totalOutstanding:"$23,450 total",lastUpdatedToday:"Last updated today",commonTasks:"Common tasks",generateReport:"Generate Report",latestUpdates:"Latest updates",invoicePaid:"Invoice #1234 paid",hoursAgo:"2 hours ago",newEmployeeOnboarded:"New employee onboarded",dayAgo:"1 day ago",monthlyReportGenerated:"Monthly report generated",daysAgo:"2 days ago"},accounts:{title:"Chart of Accounts",accountNumber:"Account Number",accountName:"Account Name",accountType:"Account Type",category:"Category",balance:"Balance",parentAccount:"Parent Account",subAccounts:"Sub-accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",transactions:"Transactions",accountHistory:"Account History",backToAccounts:"Back to Accounts",accountNotFound:"Account not found",accountInformation:"Account Information",accountPurpose:"Account purpose",transactionHistory:"Transaction History",noTransactions:"No transactions found for this account",createdDate:"Created Date",lastModified:"Last Modified",noDescription:"No description provided.",totalCount:"Total count",basicDetails:"Basic details",currentBalance:"Current balance",classification:"Classification",allTransactions:"All account transactions",reference:"Reference",allAccounts:"All Accounts",types:{asset:"Asset",liability:"Liability",equity:"Equity",revenue:"Revenue",expense:"Expense"},categories:{currentAssets:"Current Assets",fixedAssets:"Fixed Assets",currentLiabilities:"Current Liabilities",longTermLiabilities:"Long-term Liabilities",ownersEquity:"Owner's Equity",operatingRevenue:"Operating Revenue",operatingExpenses:"Operating Expenses"}},inventory:{title:"Inventory Management",overview:"Overview",products:"Products & Stock",movements:"Movements",locations:"Locations",bulkMovement:"Bulk Movement",addMovement:"Add Movement",addProduct:"Add Product",addLocation:"Add Location",singleMovement:"Add Single Movement",addNewItem:"Add New Item",activeProducts:"Active Products",lowStockAlert:"Low Stock Items",totalValue:"Total Stock Value",activeLocations:"Active Locations",productsNeedRestocking:"products need restocking",recentMovements:"Recent Movements",noProducts:"No products at this location",productName:"Product Name",productCode:"Product Code",sku:"SKU",unitOfMeasure:"Unit of Measure",unitCost:"Unit Cost",minStockLevel:"Min Stock Level",maxStockLevel:"Max Stock Level",locationName:"Location Name",locationType:"Location Type",locationCode:"Location Code",movementType:"Movement Type",referenceNumber:"Reference Number",invoiceNumber:"Invoice Number",fromLocation:"From Location",toLocation:"To Location",stockIn:"Stock In",stockOut:"Stock Out",transfer:"Transfer",adjustment:"Adjustment",inStock:"In Stock",lowStock:"Low Stock",outOfStock:"Out of Stock",stockLevels:"Stock Levels",stockByLocation:"Stock by Location",searchProducts:"Search products by name, SKU, or category...",searchProductsStock:"Search products and check stock levels...",searchResult:"Search Result",searchResults:"Search Results",searchFallback:"Showing local results",tryDifferentTerm:"Try a different search term or check spelling.",showingTopResults:"Showing top {{count}} results",searchLocations:"Search locations...",noMovements:"No movements found",productDetails:"Product Details",locationDetails:"Location Details",movementDetails:"Movement Details",totalProducts:"Total Products",totalLocations:"Total Locations",lastSeen:"Last seen",warehouseType:"Warehouse",storeType:"Store",supplierType:"Supplier",customerType:"Customer",currentlyManaged:"Currently managed",needAttention:"Need attention",currentWorth:"Current worth",warehousesStores:"Warehouses & stores",thisMonth:"This Month",latestActivities:"Latest inventory activities",searchMovements:"Search Movements",countingSheet:"Counting Sheet",physicalCount:"Physical Count",physicalInventoryCount:"Physical Inventory Count",setupPhysicalCount:"Setup Physical Inventory Count",setupDescription:"Configure your physical inventory count settings and begin the counting process.",countWillInclude:"This count will include {{count}} products from {{location}} in {{category}} category.",startCounting:"Start Physical Count",counted:"Counted",remaining:"Remaining",variances:"Variances",complete:"Complete",systemQty:"System Qty",variance:"Variance",addNotes:"Add notes...",reviewAndConfirm:"Review and Confirm Adjustments",reviewDescription:"Review the inventory adjustments below and confirm to update your system.",stockIncreases:"Stock Increases",stockDecreases:"Stock Decreases",totalAdjustments:"Total Adjustments",confirmAdjustments:"Confirm Adjustments",perfectCount:"Perfect Count!",noVariances:"No variances found. Your physical count matches the system exactly.",physicalCountAdjustment:"Physical count adjustment",inventoryCountingSheetTitle:"INVENTORY COUNTING SHEET",location:"Location",allCategories:"All Categories",countedBy:"Counted by",verifiedBy:"Verified by",instructions:"Instructions",countInstructions:["Count all items physically present at this location",'Write the actual count in the "Physical Count" column',"Leave blank if item is not found",'Note any discrepancies in the "Notes" column',"Sign and date when complete"],unit:"Unit",totalProductsListed:"Total Products Listed",itemsCounted:"Items Counted",summaryFor:"SUMMARY FOR",discrepanciesFound:"Discrepancies Found",counterSignature:"Counter Signature",supervisorSignature:"Supervisor Signature",downloadCSV:"Download CSV",noAdjustmentsToDownload:"No adjustments to download",stockIncrease:"Stock Increase",stockDecrease:"Stock Decrease",purchaseReceive:"Purchase/Receive",saleIssue:"Sale/Issue",generalNotesPlaceholder:"Enter general notes for this movement...",sortBy:"Sort By",allLocations:"All Locations",searchByProduct:"Search by product, location, reference, notes, invoice...",allProducts:"All Products",bulkMovementReport:"Bulk Movement Report",totalQuantity:"Total Quantity",estimatedValue:"Estimated Value",viewHistoricalReports:"View Historical Reports",noBulkReportsFound:"No bulk movement reports found",bulkReportsAppearHere:"Bulk movement reports will appear here after you create bulk movements",allTypes:"All Types",startDate:"Start Date",endDate:"End Date",totalMovements:"Total Movements",totalItems:"Total Items",adjustMovements:"Try adjusting your filters or check back later.",inventoryMovements:"Inventory Movements",createdBy:"Created By",view:"View",enhanced:"Enhanced",legacy:"Legacy",addSingleMovement:"Add Single Movement",inStockSubtitle:"In stock",itemsBelowThreshold:"Items below threshold",inventoryWorth:"Inventory worth",quantity:"Quantity",units:"units",normal:"Normal",productsAndStock:"Products & Stock",lowStockItems:"Low Stock Items",totalStockValue:"Total Stock Value",warehousesAndStores:"Warehouses & stores",andMore:"...and {count} more",latestInventoryActivities:"Latest inventory activities",min:"Min",max:"Max",cost:"Cost",noProductsFound:"No products found matching your search.",noProductsAvailable:"No products available.",noLocationsFound:"No locations found matching your search.",noLocationsAvailable:"No locations available.",searchPlaceholder:"Search by product, location, reference, notes, invoice...",noMovementsFound:"No movements found",tryAdjustingFilters:"Try adjusting your filters or check back later.",transfers:"Transfers",adjustments:"Adjustments",bulk:"Bulk",product:"Product",store:"Store",supplier:"Supplier",warehouse:"Warehouse",movement:"Movement",editMovement:"Edit Movement",updateMovement:"Update Movement",movementInformation:"Movement Information",locationInformation:"Location Information",searchProductsImages:"Search products to view images...",searchForProducts:"Search for Products",startTypingToSearch:"Start typing to search and view product images",tryDifferentSearch:"Try a different search term"},employees:{title:"Employee Management",employeeList:"Employee List",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",payrollInfo:"Payroll Information",firstName:"First Name",lastName:"Last Name",fullName:"Full Name",email:"Email",phone:"Phone",address:"Address",dateOfBirth:"Date of Birth",employeeId:"Employee ID",department:"Department",position:"Position",hireDate:"Hire Date",employmentStatus:"Employment Status",salary:"Salary",payFrequency:"Pay Frequency",taxId:"Tax ID",bankAccount:"Bank Account",emergencyContact:"Emergency Contact",activeEmployees:"Active Employees",inactiveEmployees:"Inactive Employees",totalPayroll:"Total Payroll",searchEmployees:"Search employees...",enterFullName:"Enter employee's full name",enterPosition:"Enter job position",enterEmail:"Enter email address",enterPhone:"Enter phone number",enterSalary:"Enter annual salary",departments:{engineering:"Engineering",product:"Product",design:"Design",marketing:"Marketing",sales:"Sales",humanResources:"Human Resources",finance:"Finance",operations:"Operations",analytics:"Analytics"}},entryBooks:{title:"Entry Books",bookName:"Book Name",bookType:"Book Type",createBook:"Create Book",editBook:"Edit Book",salesBook:"Sales Book",purchaseBook:"Purchase Book",cashBook:"Cash Book",generalBook:"General Book",entries:"Entries",addEntry:"Add Entry",period:"Period",startDate:"Start Date",endDate:"End Date",bookBalance:"Book Balance",reconciledBalance:"Reconciled Balance",difference:"Difference",reconcile:"Reconcile",isReconciled:"Is Reconciled",noBooks:"No entry books found",createFirst:"Create your first entry book to get started",bookDetails:"Book Details",entriesCount:"entries",bookOverview:"Book overview and details",bookEntries:"Book Entries",allEntries:"All entries in this book",noEntries:"No entries found",addFirst:"Add your first entry to this book",entryDate:"Entry Date",entryDescription:"Entry Description",entryAmount:"Entry Amount",entryReference:"Entry Reference",subtitle:"Manage accounting entries and general ledger records",viewReconciliation:"View Reconciliation",totalEntries:"Total Entries",allJournalEntries:"All journal entries",postedEntriesOnly:"Posted entries only",fromPostedEntries:"From {count} posted entries",needBankReconciliation:"Need bank reconciliation",allReconciled:"All reconciled",sortBy:"Sort By",fromDate:"From Date",toDate:"To Date",order:"Order",newest:"Newest",oldest:"Oldest",resetFilters:"Reset Filters",activeFilters:"Active filters",from:"From",to:"To",entriesFound:"{count} entries found",noJournalEntries:"No Journal Entries",startByCreating:"Start by creating your first entry",noEntriesMatch:"No journal entries match your current filters.",createFirstEntry:"Create First Entry",void:"Void",confirmVoid:"Are you sure you want to void this journal entry?",entryBookRecords:"Entry Book Records"},banking:{title:"Bank Consolidation",bankAccount:"Bank Account",statementDate:"Statement Date",beginningBalance:"Beginning Balance",endingBalance:"Ending Balance",deposits:"Deposits",withdrawals:"Withdrawals",bankCharges:"Bank Charges",interest:"Interest",reconcile:"Reconcile",matched:"Matched",unmatched:"Unmatched",importStatement:"Import Statement",manualEntry:"Manual Entry",autoMatch:"Auto Match",clearAll:"Clear All",reconciliationStatus:"Reconciliation Status",difference:"Difference",bookBalance:"Book Balance",statementBalance:"Statement Balance",outstandingChecks:"Outstanding Checks",depositsInTransit:"Deposits in Transit",reconciled:"Reconciled",notReconciled:"Not Reconciled",unreconciled:"Unreconciled",reconciliation:"Reconciliation",compareStatements:"Compare bank statements with entry book records",importCSV:"Import CSV",startNewReconciliation:"Start New Reconciliation",bankAccountInfo:"Bank Account Info",currentAccountDetails:"Current account details",lastReconciled:"Last reconciled",bankTransactions:"Bank Transactions",selectedPeriod:"Selected period",pending:"pending",bookEntriesForComparison:"Book entries for comparison",reconciliationRate:"Reconciliation Rate",completionStatus:"Completion status",recentReconciliationSessions:"Recent Reconciliation Sessions",latestActivity:"Latest activity",noRecentSessions:"No recent reconciliation sessions found.",startFirstReconciliation:"Start First Reconciliation",entryBookRecords:"Entry Book Records",pleaseUploadCSV:"Please upload a CSV file",csvRequiresHeaderAndData:"CSV file must have at least a header and one data row",successfullyParsed:"Successfully parsed {count} rows",errorParsingCSV:"Error parsing CSV file. Please check the format.",dateDescriptionRequired:"Date and Description columns are required",importedTransaction:"Imported transaction",successfullyImported:"Successfully imported {count} bank transactions",errorImportingTransactions:"Error importing transactions. Please check your data.",importBankStatementCSV:"Import Bank Statement CSV",dropCSVHere:"Drop CSV file here",clickToUploadCSV:"Click to upload or drag and drop CSV file",supportedFormat:"Supported format: CSV with Date, Description, and Amount columns",mapCSVColumns:"Map CSV Columns",dateColumn:"Date Column",selectColumn:"Select column...",descriptionColumn:"Description Column",referenceColumn:"Reference Column",amountDebitColumn:"Amount/Debit Column",creditColumn:"Credit Column",balanceColumn:"Balance Column",andMoreRows:"... and {count} more rows",importing:"Importing...",importTransactions:"Import {count} Transactions",reconciliationComparison:"Reconciliation Comparison",bankStatements:"Bank Statements",totalTransactions:"Total transactions",totalEntries:"Total entries",unreconciledBank:"Unreconciled Bank",unreconciledBooks:"Unreconciled Books",needAttention:"Need attention",unreconcile:"Unreconcile",clickToReconcile:"Click to reconcile",potentialMatchesFound:"Potential Matches Found",clickRecordToReconcile:"Click on a record below to reconcile",exactMatch:"Exact Match",possibleMatch:"Possible Match",selected:"Selected",clearSelection:"Clear Selection"},journal:{title:"Journal Entries",entryNumber:"Entry Number",entryDate:"Entry Date",debit:"Debit",credit:"Credit",account:"Account",memo:"Memo",reference:"Reference",createEntry:"Create Entry",editEntry:"Edit Entry",deleteEntry:"Delete Entry",posted:"Posted",draft:"Draft",reversed:"Reversed",recurringEntry:"Recurring Entry",attachments:"Attachments",totalDebits:"Total Debits",totalCredits:"Total Credits",outOfBalance:"Out of Balance",balanced:"Balanced",addEntry:"Add Journal Entry",allEntries:"All Entries",totalDebit:"Total Debit",totalCredit:"Total Credit",debitShort:"Dr.",creditShort:"Cr.",noReference:"No reference",createdBy:"By",totalAmount:"Total Amount",lines:"Lines",entryNotBalancedShort:"Entry is not balanced",accountLines:"Account Lines",noDescription:"No description",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryLines:"Journal Entry Lines",addLine:"Add Line",lineDescription:"Line description",notBalanced:"Not Balanced",updateEntry:"Update Entry",saveAsDraft:"Save as Draft",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",editEntryTooltip:"Edit this journal entry",post:"Post",entryMustBeBalanced:"Entry must be balanced to post",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",journalLines:"Journal Lines",balanceStatus:"Balance Status",unbalanced:"Unbalanced",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",postEntry:"Post Entry",fixBalance:"Fix Balance",voidEntry:"Void Entry",draftEntry:"Draft Entry",draftEntryDescription:"This entry can be edited and posted.",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",postedEntry:"Posted Entry",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",minTwoLinesRequired:"At least 2 line items are required",entryNotBalanced:"Entry is not balanced. Debit: ${debit}, Credit: ${credit}",lineAccountRequired:"Line {lineNumber}: Account is required",lineAmountRequired:"Line {lineNumber}: Either debit or credit amount must be provided",lineBothAmounts:"Line {lineNumber}: Cannot have both debit and credit amounts",enterEntryDescription:"Enter journal entry description",enterReferenceNumber:"Enter reference number"},invoices:{title:"Invoice Dashboard",invoice:"Invoice",invoices:"Invoices",invoiceNumber:"Invoice Number",invoiceDetails:"Invoice Details",customerInformation:"Customer Information",customerName:"Customer Name",legalName:"Legal Name",contactInformation:"Contact Information",idPassport:"ID/Passport",phoneNumber:"Phone Number",altPhone:"Alt Phone",address:"Address",between:"Between",and:"and",products:"Products",reservations:"Reservations",services:"Services",unitPrice:"Unit Price",total:"Total",subtotal:"Subtotal",totalRevenue:"Total Revenue",totalProducts:"Total Products",totalReservations:"Total Reservations",aranceles:"Aranceles (Customs)",uniqueCustomers:"Unique Customers",averageInvoice:"Average Invoice",completed:"Completed",pending:"Pending",storesActive:"Stores Active",topProducts:"Top Products",mostSoldProducts:"Most sold products by quantity",reservationsByType:"Reservations by Type",distributionOfCategories:"Distribution of reservation categories",recentInvoices:"Recent Invoices",showingInvoices:"Showing {{count}} invoices",date:"Date",customer:"Customer",store:"Store",actions:"Actions",view:"View",status:"Status",printInvoice:"Print Invoice",exportPdf:"Export PDF",backToDashboard:"Back to Dashboard",fromInvoices:"From {{count}} invoices",value:"value",activeCustomers:"Active customers",perInvoiceValue:"Per invoice value",locations:"Locations",mostRecentActivity:"Most recent activity",storeLocation:"Store Location",allStores:"All Stores",fromDate:"From Date",toDate:"To Date",clearFilters:"Clear Filters",search:"Search",searchPlaceholder:"Search by invoice #, customer, store...",customsFees:"Total customs fees",salesType:"SALES",packagesOrder:"Packages Order",businessId:"Business ID",orderKey:"Order Key",reservationType:"Reservation Type",arancel:"Arancel",key:"Key",noInvoicesFound:"No invoices found",loadingInvoices:"Loading invoices...",errorLoadingInvoices:"Error loading invoices",refreshData:"Refresh Data",currentStockValue:"Current Stock Value",filterByStore:"Filter by store",filterByDate:"Filter by date range",totalCustomsFees:"Total customs fees",averageValue:"Average value",senderInformation:"Sender Information",receiptInformation:"Receipt Information",productsSubtotal:"Products Subtotal",reservationsSubtotal:"Reservations Subtotal",servicesSubtotal:"Services Subtotal",code:"Code",description:"Description",qty:"Qty",type:"Type",id:"ID",passport:"Passport",createNew:"Create New Invoice",totalOutstanding:"Total Outstanding",unpaidInvoices:"Unpaid invoices",thisMonth:"This Month",revenueCollected:"Revenue collected",overdue:"Overdue",pastDueInvoices:"Past due invoices",latestBillingActivity:"Latest billing activity",paid:"Paid"},forms:{requiredField:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",selectOption:"Please select an option",enterValue:"Please enter a value",confirmDelete:"Are you sure you want to delete this item?",unsavedChanges:"You have unsaved changes. Do you want to continue?",saveSuccess:"Saved successfully",saveError:"Error saving data",deleteSuccess:"Deleted successfully",deleteError:"Error deleting item",duplicateAccountNumber:"Account number already exists",descriptionRequired:"Description is required",errorOccurred:"An error occurred",errorPostingEntry:"An error occurred while posting the entry",referenceNumberRequired:"Reference number is required",locationRequired:"Location is required",fromLocationRequired:"From location is required for transfers",atLeastOneProduct:"At least one product is required",itemProductRequired:"Product is required for item {{index}}",itemQuantityRequired:"Quantity must be greater than 0 for item {{index}}"},modals:{addInventory:"Add Inventory Movement",bulkMovement:"Bulk Inventory Movement",addProduct:"Add New Product",addLocation:"Add New Location",inventoryDetail:"Inventory Item Details",quickAdd:"Quick Add",selectProduct:"Select Product",selectLocation:"Select Location",enterQuantity:"Enter quantity",enterCost:"Enter unit cost",enterReference:"Enter reference number",addNotes:"Add notes (optional)",generalInformation:"General Information",stockInformation:"Stock Information",locationInformation:"Location Information",movementInformation:"Movement Information",addToInventory:"Add to Inventory",createProduct:"Create Product",createLocation:"Create Location",processing:"Processing...",addingMovement:"Adding movement...",creatingProduct:"Creating product...",creatingLocation:"Creating location..."},products:{title:"Products",addNew:"Add New Product",totalProducts:"Total Products",inCatalog:"In catalog",activeProducts:"Active Products",currentlyAvailable:"Currently available",outOfStock:"Out of Stock",needsRestock:"Needs restock",productCatalog:"Product Catalog",manageYourProducts:"Manage your products and pricing",inStock:"In Stock",furniture:"Furniture",electronics:"Electronics",supplies:"Supplies",lighting:"Lighting",searchPlaceholder:"Search products by name, SKU, or category...",allCategories:"All Categories",clearFilters:"Clear filters",noResults:"No products found matching your criteria.",noProducts:"No products available.",showing:"Showing",filtered:"Filtered results",allProducts:"All products",searchResult:"Search Result",stock:"Stock",lowStock:"Low Stock"},unauthorized:{title:"Access Restricted",accessDenied:"Access Denied",noPermission:"You don't have permission to access",thisFeature:"this feature",whySeeing:"Why am I seeing this?",explanation:"Your account doesn't have the necessary permissions to view this content.",requiredPermission:"Required permission:",goToDashboard:"Go to Dashboard",goBack:"Go Back",featuresCanAccess:"Features you can access:",dashboardAccess:"Dashboard and overview statistics",profileAccess:"Your profile and settings",roleBasedAccess:"Features enabled for your role",needAccess:"Need access? Contact your administrator or manager to request the appropriate permissions.",permissions:{accountAccess:"Account Management Access",inventoryAccess:"Inventory Access",employeeAccess:"HR Access",bankingAccess:"Banking Access",journalAccess:"Journal Entry Access",adminAccess:"Administrative Access",financialReporting:"Financial Reporting Access",invoiceManagement:"Invoice Management Access",productManagement:"Product Management Access"}}},es:{common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",add:"Agregar",close:"Cerrar",search:"Buscar",filter:"Filtrar",reset:"Restablecer",back:"Atrs",next:"Siguiente",previous:"Anterior",yes:"S",no:"No",loading:"Cargando...",error:"Error",success:"xito",warning:"Advertencia",info:"Informacin",confirm:"Confirmar",actions:"Acciones",status:"Estado",active:"Activo",inactive:"Inactivo",date:"Fecha",time:"Hora",description:"Descripcin",notes:"Notas",amount:"Monto",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Idioma",english:"Ingls",spanish:"Espaol",noDataFound:"No se encontraron datos",required:"Requerido",optional:"Opcional",all:"Todos",none:"Ninguno",select:"Seleccionar",clear:"Limpiar",view:"Ver",suggested:"Sugerido",clearFilters:"Limpiar Filtros",enhanced:"Mejorado",legacy:"Clsico",email:"Correo Electrnico",phone:"Telfono",address:"Direccin",name:"Nombre",code:"Cdigo",category:"Categora",type:"Tipo",quantity:"Cantidad",price:"Precio",cost:"Costo",value:"Valor",balance:"Saldo",created:"Creado",modified:"Modificado",details:"Detalles",summary:"Resumen",history:"Historial",new:"Nuevo",addNew:"Agregar Nuevo",unknown:"Desconocido",notAvailable:"N/A",remove:"Remover",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",from:"De",invoice:"Factura",invoices:"facturas",reference:"Referencia",createdBy:"Creado Por",units:"unidades",invoiceDocumentId:"ID de Factura/Documento",referenceNumber:"Nmero de Referencia",referenceNumberPlaceholder:"Ingrese nmero de referencia...",generalNotes:"Notas Generales",auto:"Auto",optionalNotes:"Notas opcionales...",showPerPage:"Mostrar por pgina",first:"Primera",last:"ltima",store:"Tienda",orderId:"ID de Orden",tax:"Impuesto",paymentMethods:"Mtodos de Pago",cash:"Efectivo",creditCard:"Tarjeta de Crdito",shipping:"Envo",air:"Areo",sea:"Martimo",thankYouBusiness:"Gracias por su negocio!",thankForChoosingUs:"Gracias por elejirnos!",taxExemptNote:"Impuesto exento en pago en efectivo.",youSaved:"Usted ahorr",generatedOn:"Generado el",printSavePDF:"Imprimir / Guardar como PDF",pageOfPages:"Pgina {{current}} de {{total}}",showingXofY:"Mostrando {{start}}-{{end}} de {{total}}",page:"Pgina",of:"de",lbs:"libras"},navigation:{dashboard:"Panel de Control",accounts:"Plan de Cuentas",balanceSheet:"Balance General",inventory:"Inventario",employees:"Empleados",entryBooks:"Libros de Entrada",consolidate:"Consolidacin Bancaria",reports:"Reportes",settings:"Configuracin"},dashboard:{title:"Panel de Control",welcome:"Bienvenido a HRM Finance",totalRevenue:"Ingresos Totales",overview:"Resumen",recentActivity:"Actividad Reciente",quickActions:"Acciones Rpidas",employeeCount:"Nmero de Empleados",pendingInvoices:"Facturas Pendientes",cashBalance:"Saldo en Efectivo",totalAssets:"Activos Totales",totalLiabilities:"Pasivos Totales",totalExpenses:"Gastos Totales",netIncome:"Ingreso Neto",netLoss:"Prdida Neta",monthlyPayroll:"Nmina Mensual",current:"Actual",newHires:"+3 nuevas contrataciones",outstanding:"Pendiente",totalOutstanding:"$23,450 total",lastUpdatedToday:"ltima actualizacin hoy",commonTasks:"Tareas comunes",generateReport:"Generar Reporte",latestUpdates:"ltimas actualizaciones",invoicePaid:"Factura #1234 pagada",hoursAgo:"hace 2 horas",newEmployeeOnboarded:"Nuevo empleado incorporado",dayAgo:"hace 1 da",monthlyReportGenerated:"Reporte mensual generado",daysAgo:"hace 2 das"},accounts:{title:"Plan de Cuentas",accountNumber:"Nmero de Cuenta",accountName:"Nombre de Cuenta",accountType:"Tipo de Cuenta",category:"Categora",balance:"Saldo",parentAccount:"Cuenta Padre",subAccounts:"Subcuentas",addAccount:"Agregar Cuenta",editAccount:"Editar Cuenta",deleteAccount:"Eliminar Cuenta",accountDetails:"Detalles de Cuenta",transactions:"Transacciones",accountHistory:"Historial de Cuenta",backToAccounts:"Volver a Cuentas",accountNotFound:"Cuenta no encontrada",accountInformation:"Informacin de Cuenta",accountPurpose:"Propsito de la cuenta",transactionHistory:"Historial de Transacciones",noTransactions:"No se encontraron transacciones para esta cuenta",createdDate:"Fecha de Creacin",lastModified:"ltima Modificacin",noDescription:"No se proporcion descripcin.",totalCount:"Conteo total",basicDetails:"Detalles bsicos",currentBalance:"Saldo actual",classification:"Clasificacin",allTransactions:"Todas las transacciones de la cuenta",reference:"Referencia",types:{asset:"Activo",liability:"Pasivo",equity:"Patrimonio",revenue:"Ingreso",expense:"Gasto"},categories:{currentAssets:"Activos Corrientes",fixedAssets:"Activos Fijos",currentLiabilities:"Pasivos Corrientes",longTermLiabilities:"Pasivos a Largo Plazo",ownersEquity:"Patrimonio del Propietario",operatingRevenue:"Ingresos Operacionales",operatingExpenses:"Gastos Operacionales"}},inventory:{title:"Gestin de Inventario",overview:"Resumen",products:"Productos y Stock",movements:"Movimientos",locations:"Ubicaciones",bulkMovement:"Movimiento Masivo",addMovement:"Agregar Movimiento",addProduct:"Agregar Producto",addLocation:"Agregar Ubicacin",singleMovement:"Agregar Movimiento Individual",addNewItem:"Agregar Nuevo Artculo",activeProducts:"Productos Activos",lowStockAlert:"Artculos con Stock Bajo",totalValue:"Valor Total del Stock",activeLocations:"Ubicaciones Activas",productsNeedRestocking:"productos necesitan reabastecimiento",recentMovements:"Movimientos Recientes",noProducts:"No hay productos en esta ubicacin",productName:"Nombre del Producto",productCode:"Cdigo del Producto",sku:"SKU",category:"Categoria",unitOfMeasure:"Unidad de Medida",unitCost:"Costo Unitario",minStockLevel:"Nivel Mnimo de Stock",maxStockLevel:"Nivel Mximo de Stock",locationName:"Nombre de Ubicacin",locationType:"Tipo de Ubicacin",locationCode:"Cdigo de Ubicacin",movementType:"Tipo de Movimiento",referenceNumber:"Nmero de Referencia",invoiceNumber:"Nmero de Factura",fromLocation:"Desde Ubicacin",toLocation:"Hacia Ubicacin",stockIn:"Entrada de Stock",stockOut:"Salida de Stock",transfer:"Transferencia",adjustment:"Ajuste",inStock:"En Stock",lowStock:"Stock Bajo",outOfStock:"Sin Stock",stockLevels:"Niveles de Stock",stockByLocation:"Stock por Ubicacin",searchProducts:"Buscar productos...",searchLocations:"Buscar ubicaciones...",noMovements:"No se encontraron movimientos",productDetails:"Detalles del Producto",locationDetails:"Detalles de Ubicacin",movementDetails:"Detalles del Movimiento",totalProducts:"Total de Productos",totalLocations:"Total de Ubicaciones",lastSeen:"Visto por ltima vez",warehouseType:"Almacn",storeType:"Tienda",supplierType:"Proveedor",customerType:"Cliente",currentlyManaged:"Gestionados actualmente",needAttention:"Necesitan atencin",currentWorth:"Valor actual",warehousesStores:"Almacenes y tiendas",thisMonth:"Este Mes",latestActivities:"ltimas actividades de inventario",searchMovements:"Buscar Movimientos",countingSheet:"Hoja de Conteo",physicalCount:"Conteo Fsico",physicalInventoryCount:"Conteo Fsico de Inventario",setupPhysicalCount:"Configurar Conteo Fsico de Inventario",setupDescription:"Configure los ajustes de su conteo fsico de inventario y comience el proceso de conteo.",countWillInclude:"Este conteo incluir {{count}} productos de {{location}} en la categora {{category}}.",startCounting:"Iniciar Conteo Fsico",counted:"Contado",remaining:"Restante",variances:"Variaciones",complete:"Completo",systemQty:"Cant. Sistema",variance:"Variacin",addNotes:"Agregar notas...",reviewAndConfirm:"Revisar y Confirmar Ajustes",reviewDescription:"Revise los ajustes de inventario a continuacin y confirme para actualizar su sistema.",stockIncreases:"Aumentos de Stock",stockDecreases:"Disminuciones de Stock",totalAdjustments:"Ajustes Totales",confirmAdjustments:"Confirmar Ajustes",perfectCount:"Conteo Perfecto!",noVariances:"No se encontraron variaciones. Su conteo fsico coincide exactamente con el sistema.",physicalCountAdjustment:"Ajuste de conteo fsico",inventoryCountingSheetTitle:"HOJA DE CONTEO DE INVENTARIO",location:"Ubicacin",allCategories:"Todas las Categoras",countedBy:"Contado por",verifiedBy:"Verificado por",instructions:"Instrucciones",countInstructions:["Contar todos los artculos fsicamente presentes en esta ubicacin",'Escribir el conteo real en la columna "Conteo Fsico"',"Dejar en blanco si el artculo no se encuentra",'Anotar cualquier discrepancia en la columna "Notas"',"Firmar y fechar cuando est completo"],unit:"Unidad",totalProductsListed:"Total de Productos Listados",itemsCounted:"Artculos Contados",summaryFor:"RESUMEN PARA",discrepanciesFound:"Discrepancias Encontradas",counterSignature:"Firma del Contador",supervisorSignature:"Firma del Supervisor",downloadCSV:"Descargar CSV",noAdjustmentsToDownload:"No hay ajustes para descargar",stockIncrease:"Aumento de Stock",stockDecrease:"Disminucin de Stock",purchaseReceive:"Compra/Recepcin",saleIssue:"Venta/Emisin",generalNotesPlaceholder:"Ingrese notas generales para este movimiento...",sortBy:"Ordenar Por",allLocations:"Todas las Ubicaciones",searchByProduct:"Buscar por producto, ubicacin, referencia, notas, factura...",allProducts:"Todos los Productos",bulkMovementReport:"Reporte de Movimiento en Lote",totalQuantity:"Cantidad Total",estimatedValue:"Valor Estimado",viewHistoricalReports:"Ver Reportes Histricos",noBulkReportsFound:"No se encontraron reportes de movimientos en lote",bulkReportsAppearHere:"Los reportes de movimientos en lote aparecern aqu despus de crear movimientos en lote",allTypes:"Todos los Tipos",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",totalMovements:"Movimientos Totales",adjustMovements:"Intenta ajustar tus filtros o revisa ms tarde.",inventoryMovements:"Movimientos de Inventario",createdBy:"Creado Por",view:"Ver",enhanced:"Mejorado",legacy:"Clsico",addSingleMovement:"Agregar Movimiento Individual",inStockSubtitle:"En stock",itemsBelowThreshold:"Artculos bajo el umbral",inventoryWorth:"Valor del inventario",quantity:"Cantidad",units:"unidades",normal:"Normal",productsAndStock:"Productos y Stock",lowStockItems:"Artculos con Stock Bajo",totalStockValue:"Valor Total del Stock",warehousesAndStores:"Almacenes y tiendas",andMore:"...y {count} ms",latestInventoryActivities:"ltimas actividades de inventario",min:"Mn",max:"Mx",cost:"Costo",noProductsFound:"No se encontraron productos que coincidan con su bsqueda.",noProductsAvailable:"No hay productos disponibles.",noLocationsFound:"No se encontraron ubicaciones que coincidan con su bsqueda.",noLocationsAvailable:"No hay ubicaciones disponibles.",searchPlaceholder:"Buscar por producto, ubicacin, referencia, notas, factura...",noMovementsFound:"No se encontraron movimientos",tryAdjustingFilters:"Intenta ajustar tus filtros o revisa ms tarde.",transfers:"Transferencias",adjustments:"Ajustes",bulk:"Masivo",product:"Producto",store:"Tienda",supplier:"Proveedor",warehouse:"Almacn",movement:"Movimiento",editMovement:"Editar Movimiento",updateMovement:"Actualizar Movimiento",movementInformation:"Informacin del Movimiento",locationInformation:"Informacin de Ubicacin",searchProductsImages:"Buscar productos para ver imgenes...",searchForProducts:"Buscar Productos",startTypingToSearch:"Comienza a escribir para buscar y ver imgenes de productos",tryDifferentSearch:"Prueba con un trmino de bsqueda diferente"},employees:{title:"Gestin de Empleados",employeeList:"Lista de Empleados",addEmployee:"Agregar Empleado",editEmployee:"Editar Empleado",employeeDetails:"Detalles del Empleado",personalInfo:"Informacin Personal",employmentInfo:"Informacin Laboral",payrollInfo:"Informacin de Nmina",firstName:"Nombre",lastName:"Apellido",fullName:"Nombre Completo",email:"Correo Electrnico",phone:"Telfono",address:"Direccin",dateOfBirth:"Fecha de Nacimiento",employeeId:"ID de Empleado",department:"Departamento",position:"Puesto",hireDate:"Fecha de Contratacin",employmentStatus:"Estado Laboral",salary:"Salario",payFrequency:"Frecuencia de Pago",taxId:"ID Fiscal",bankAccount:"Cuenta Bancaria",emergencyContact:"Contacto de Emergencia",activeEmployees:"Empleados Activos",inactiveEmployees:"Empleados Inactivos",totalPayroll:"Nmina Total",searchEmployees:"Buscar empleados...",enterFullName:"Ingrese el nombre completo del empleado",enterPosition:"Ingrese el puesto de trabajo",enterEmail:"Ingrese la direccin de correo electrnico",enterPhone:"Ingrese el nmero de telfono",enterSalary:"Ingrese el salario anual",departments:{engineering:"Ingeniera",product:"Producto",design:"Diseo",marketing:"Marketing",sales:"Ventas",humanResources:"Recursos Humanos",finance:"Finanzas",operations:"Operaciones",analytics:"Analtica"}},entryBooks:{title:"Libros de Entrada",bookName:"Nombre del Libro",bookType:"Tipo de Libro",createBook:"Crear Libro",editBook:"Editar Libro",salesBook:"Libro de Ventas",purchaseBook:"Libro de Compras",cashBook:"Libro de Caja",generalBook:"Libro General",entries:"Entradas",addEntry:"Agregar Entrada",period:"Perodo",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",bookBalance:"Saldo del Libro",reconciledBalance:"Saldo Conciliado",difference:"Diferencia",reconcile:"Conciliar",isReconciled:"Est Conciliado",noBooks:"No se encontraron libros de entrada",createFirst:"Crea tu primer libro de entrada para comenzar",bookDetails:"Detalles del Libro",entriesCount:"entradas",bookOverview:"Resumen y detalles del libro",bookEntries:"Entradas del Libro",allEntries:"Todas las entradas en este libro",noEntries:"No se encontraron entradas",addFirst:"Agrega tu primera entrada a este libro",entryDate:"Fecha de Entrada",entryDescription:"Descripcin de Entrada",entryAmount:"Monto de Entrada",entryReference:"Referencia de Entrada"},banking:{title:"Consolidacin Bancaria",bankAccount:"Cuenta Bancaria",statementDate:"Fecha del Estado",beginningBalance:"Saldo Inicial",endingBalance:"Saldo Final",deposits:"Depsitos",withdrawals:"Retiros",bankCharges:"Cargos Bancarios",interest:"Intereses",reconcile:"Conciliar",matched:"Conciliado",unmatched:"No Conciliado",importStatement:"Importar Estado",manualEntry:"Entrada Manual",autoMatch:"Coincidencia Automtica",clearAll:"Limpiar Todo",reconciliationStatus:"Estado de Conciliacin",difference:"Diferencia",bookBalance:"Saldo en Libros",statementBalance:"Saldo del Estado",outstandingChecks:"Cheques Pendientes",depositsInTransit:"Depsitos en Trnsito",reconciled:"Conciliado",notReconciled:"No Conciliado",unreconciled:"No Conciliado",reconciliation:"Conciliacin",compareStatements:"Comparar estados bancarios con registros de libros de entrada",importCSV:"Importar CSV",startNewReconciliation:"Iniciar Nueva Conciliacin",bankAccountInfo:"Informacin de Cuenta Bancaria",currentAccountDetails:"Detalles de cuenta actual",lastReconciled:"ltima conciliacin",bankTransactions:"Transacciones Bancarias",selectedPeriod:"Perodo seleccionado",pending:"pendiente",bookEntriesForComparison:"Entradas de libros para comparacin",reconciliationRate:"Tasa de Conciliacin",completionStatus:"Estado de finalizacin",recentReconciliationSessions:"Sesiones de Conciliacin Recientes",latestActivity:"Actividad reciente",noRecentSessions:"No se encontraron sesiones de conciliacin recientes.",startFirstReconciliation:"Iniciar Primera Conciliacin",entryBookRecords:"Registros de Libros de Entrada",pleaseUploadCSV:"Por favor suba un archivo CSV",csvRequiresHeaderAndData:"El archivo CSV debe tener al menos un encabezado y una fila de datos",successfullyParsed:"Se analizaron exitosamente {count} filas",errorParsingCSV:"Error al analizar el archivo CSV. Verifique el formato.",dateDescriptionRequired:"Las columnas de Fecha y Descripcin son requeridas",importedTransaction:"Transaccin importada",successfullyImported:"Se importaron exitosamente {count} transacciones bancarias",errorImportingTransactions:"Error al importar transacciones. Verifique sus datos.",importBankStatementCSV:"Importar CSV de Estado Bancario",dropCSVHere:"Suelte el archivo CSV aqu",clickToUploadCSV:"Haga clic para cargar o arrastre y suelte el archivo CSV",supportedFormat:"Formato soportado: CSV con columnas de Fecha, Descripcin y Monto",mapCSVColumns:"Mapear Columnas CSV",dateColumn:"Columna de Fecha",selectColumn:"Seleccionar columna...",descriptionColumn:"Columna de Descripcin",referenceColumn:"Columna de Referencia",amountDebitColumn:"Columna de Monto/Dbito",creditColumn:"Columna de Crdito",balanceColumn:"Columna de Saldo",andMoreRows:"... y {count} filas ms",importing:"Importando...",importTransactions:"Importar {count} Transacciones",reconciliationComparison:"Comparacin de Conciliacin",bankStatements:"Estados Bancarios",totalTransactions:"Transacciones totales",totalEntries:"Entradas totales",unreconciledBank:"Banco No Conciliado",unreconciledBooks:"Libros No Conciliados",needAttention:"Necesitan atencin",unreconcile:"Desconciliar",clickToReconcile:"Hacer clic para conciliar",potentialMatchesFound:"Coincidencias Potenciales Encontradas",clickRecordToReconcile:"Haga clic en un registro a continuacin para conciliar",exactMatch:"Coincidencia Exacta",possibleMatch:"Posible Coincidencia",selected:"Seleccionado",clearSelection:"Limpiar Seleccin"},journal:{title:"Asientos Contables",entryNumber:"Nmero de Asiento",entryDate:"Fecha del Asiento",debit:"Dbito",credit:"Crdito",account:"Cuenta",memo:"Memo",reference:"Referencia",createEntry:"Crear Asiento",editEntry:"Editar Asiento",deleteEntry:"Eliminar Asiento",posted:"Registrado",draft:"Borrador",reversed:"Revertido",recurringEntry:"Asiento Recurrente",attachments:"Adjuntos",totalDebits:"Dbitos Totales",totalCredits:"Crditos Totales",outOfBalance:"Desbalanceado",balanced:"Balanceado"},forms:{requiredField:"Este campo es requerido",invalidEmail:"Direccin de correo invlida",invalidNumber:"Nmero invlido",invalidDate:"Fecha invlida",selectOption:"Por favor seleccione una opcin",enterValue:"Por favor ingrese un valor",confirmDelete:"Est seguro de que desea eliminar este elemento?",unsavedChanges:"Tiene cambios sin guardar. Desea continuar?",saveSuccess:"Guardado exitosamente",saveError:"Error al guardar datos",deleteSuccess:"Eliminado exitosamente",deleteError:"Error al eliminar elemento",duplicateAccountNumber:"El nmero de cuenta ya existe",referenceNumberRequired:"El nmero de referencia es requerido",locationRequired:"La ubicacin es requerida",fromLocationRequired:"La ubicacin de origen es requerida para transferencias",atLeastOneProduct:"Al menos un producto es requerido",itemProductRequired:"El producto es requerido para el artculo {{index}}",itemQuantityRequired:"La cantidad debe ser mayor que 0 para el artculo {{index}}"},modals:{addInventory:"Agregar Movimiento de Inventario",bulkMovement:"Movimiento Masivo de Inventario",addProduct:"Agregar Nuevo Producto",addLocation:"Agregar Nueva Ubicacin",inventoryDetail:"Detalles del Artculo de Inventario",quickAdd:"Agregar Rpido",selectProduct:"Seleccionar Producto",selectLocation:"Seleccionar Ubicacin",enterQuantity:"Ingresar cantidad",enterCost:"Ingresar costo unitario",enterReference:"Ingresar nmero de referencia",addNotes:"Agregar notas (opcional)",generalInformation:"Informacin General",stockInformation:"Informacin de Stock",locationInformation:"Informacin de Ubicacin",movementInformation:"Informacin de Movimiento",addToInventory:"Agregar al Inventario",createProduct:"Crear Producto",createLocation:"Crear Ubicacin",processing:"Procesando...",addingMovement:"Agregando movimiento...",creatingProduct:"Creando producto...",creatingLocation:"Creando ubicacin..."},products:{title:"Productos",addNew:"Agregar Nuevo Producto",totalProducts:"Total de Productos",inCatalog:"En catlogo",activeProducts:"Productos Activos",currentlyAvailable:"Actualmente disponibles",outOfStock:"Sin Stock",needsRestock:"Necesita reabastecimiento",productCatalog:"Catlogo de Productos",manageYourProducts:"Gestiona tus productos y precios",inStock:"En Stock",furniture:"Muebles",electronics:"Electrnicos",supplies:"Suministros",lighting:"Iluminacin"},invoices:{title:"Panel de Facturas",invoice:"Factura",invoices:"Facturas",invoiceNumber:"Nmero de Factura",invoiceDetails:"Detalles de Factura",customerInformation:"Informacin del Cliente",customerName:"Nombre del Cliente",legalName:"Nombre Legal",contactInformation:"Informacin de Contacto",idPassport:"ID/Pasaporte",phoneNumber:"Nmero de Telfono",altPhone:"Telfono Alt.",address:"Direccin",between:"Entre",and:"y",products:"Productos",reservations:"Reservaciones",services:"Servicios",unitPrice:"Precio Unitario",total:"Total",subtotal:"Subtotal",category:"Categoria",totalRevenue:"Ingresos Totales",totalProducts:"Total de Productos",totalReservations:"Total de Reservaciones",aranceles:"Aranceles (Aduanas)",uniqueCustomers:"Clientes nicos",averageInvoice:"Factura Promedio",completed:"Completada",pending:"Pendiente",storesActive:"Tiendas Activas",topProducts:"Productos Principales",mostSoldProducts:"Productos ms vendidos por cantidad",reservationsByType:"Reservaciones por Tipo",distributionOfCategories:"Distribucin de categoras de reservaciones",recentInvoices:"Facturas Recientes",showingInvoices:"Mostrando {{count}} facturas",date:"Fecha",customer:"Cliente",store:"Tienda",actions:"Acciones",view:"Ver",status:"Estado",printInvoice:"Imprimir Factura",exportPdf:"Exportar PDF",backToDashboard:"Volver al Panel",fromInvoices:"De {{count}} facturas",value:"valor",activeCustomers:"Clientes activos",perInvoiceValue:"Valor por factura",locations:"Ubicaciones",mostRecentActivity:"Actividad ms reciente",storeLocation:"Ubicacin de Tienda",allStores:"Todas las Tiendas",fromDate:"Fecha Desde",toDate:"Fecha Hasta",clearFilters:"Limpiar Filtros",search:"Buscar",searchPlaceholder:"Buscar por # factura, cliente, tienda...",customsFees:"Aranceles totales",salesType:"VENTAS",packagesOrder:"Orden de Paquetes",businessId:"ID de Negocio",orderKey:"Clave de Orden",reservationType:"Tipo de Reservacin",arancel:"Arancel",key:"Clave",noInvoicesFound:"No se encontraron facturas",loadingInvoices:"Cargando facturas...",errorLoadingInvoices:"Error al cargar facturas",refreshData:"Actualizar Datos",currentStockValue:"Valor de Stock Actual",filterByStore:"Filtrar por tienda",filterByDate:"Filtrar por rango de fechas",totalCustomsFees:"Aranceles totales",averageValue:"Valor promedio",senderInformation:"Informacin del Remitente",receiptInformation:"Informacin del Destinatario",productsSubtotal:"Subtotal de Productos",reservationsSubtotal:"Subtotal de Reservaciones",servicesSubtotal:"Subtotal de Servicios",code:"Cdigo",description:"Descripcin",qty:"Cant.",type:"Tipo",id:"ID",passport:"Pasaporte"},unauthorized:{title:"Acceso Restringido",accessDenied:"Acceso Denegado",noPermission:"No tienes permisos para acceder a",thisFeature:"esta funcionalidad",whySeeing:"Por qu veo esto?",explanation:"Tu cuenta no tiene los permisos necesarios para ver este contenido.",requiredPermission:"Permiso requerido:",goToDashboard:"Ir al Panel de Control",goBack:"Regresar",featuresCanAccess:"Funcionalidades a las que puedes acceder:",dashboardAccess:"Panel de control y estadsticas generales",profileAccess:"Tu perfil y configuraciones",roleBasedAccess:"Funcionalidades habilitadas para tu rol",needAccess:"Necesitas acceso? Contacta a tu administrador o gerente para solicitar los permisos apropiados.",permissions:{accountAccess:"Acceso a Gestin de Cuentas",inventoryAccess:"Acceso a Inventario",employeeAccess:"Acceso a Recursos Humanos",bankingAccess:"Acceso Bancario",journalAccess:"Acceso a Asientos Contables",adminAccess:"Acceso Administrativo",financialReporting:"Acceso a Reportes Financieros",invoiceManagement:"Acceso a Gestin de Facturas",productManagement:"Acceso a Gestin de Productos"}}}},qE=()=>{if(typeof window<"u"){const t=localStorage.getItem("hrmfinance-language");if(t&&["en","es"].includes(t))return t}return"en"},[mm,zE]=we(qE()),_r=()=>({t:(n,i,o)=>{const s=mm(),l=n.split(".");let c=VE[s];for(const u of l)if(c&&typeof c=="object"&&u in c)c=c[u];else return i||n;let d=typeof c=="string"?c:i||n;return o&&typeof d=="string"&&Object.keys(o).forEach(u=>{const y=o[u],g=`{{${u}}}`;d=d.replace(new RegExp(g,"g"),String(y))}),d},language:()=>mm(),setLanguage:n=>{zE(n),typeof window<"u"&&localStorage.setItem("hrmfinance-language",n)},currentLanguage:mm});var UE=ae("<div><label></label><select><option value>"),HE=ae("<span>*"),GE=ae("<option>");const Hn=t=>{const{t:e}=_r(),r={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},n={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},i={"margin-bottom":"1rem"};return(()=>{var o=UE(),s=o.firstChild,l=s.nextSibling,c=l.firstChild;return p(o,i),p(s,r),a(s,()=>t.label,null),a(s,(()=>{var d=Te(()=>!!t.required);return()=>d()&&(()=>{var u=HE();return u.style.setProperty("color","var(--primary-color)"),u})()})(),null),l.addEventListener("blur",d=>d.target.style.borderColor="var(--border-color)"),l.addEventListener("focus",d=>d.target.style.borderColor="var(--primary-color)"),l.addEventListener("change",d=>t.onChange(d.target.value)),p(l,n),a(c,()=>e("forms.selectOption")),a(l,()=>t.options.map(d=>(()=>{var u=GE();return a(u,()=>d.label),fe(()=>u.value=d.value),u})()),null),fe(d=>{var u=t.required,y=t.disabled;return u!==d.e&&(l.required=d.e=u),y!==d.t&&(l.disabled=d.t=y),d},{e:void 0,t:void 0}),fe(()=>l.value=t.value),o})()};var WE=ae("<main><div>"),YE=ae("<header><h1>");const Po=t=>{const e={"min-height":"100vh",background:"var(--background-color)"},r={"max-width":"1200px",margin:"0 auto",padding:"2rem"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},i={"font-size":"2rem","font-weight":"700",color:"var(--text-primary)",margin:"0"};return(()=>{var o=WE(),s=o.firstChild;return p(o,e),p(s,r),a(s,(()=>{var l=Te(()=>!!t.title);return()=>l()&&(()=>{var c=YE(),d=c.firstChild;return p(c,n),p(d,i),a(d,()=>t.title),c})()})(),null),a(s,()=>t.children,null),o})()};var KE=ae("<div><span></span><select><option value=en> </option><option value=es> ");const JE=()=>{const{t,language:e,setLanguage:r}=_r(),n={display:"flex","align-items":"center",gap:"0.5rem","margin-left":"auto"},i={padding:"0.5rem 1rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",background:"var(--surface-color)",color:"var(--text-primary)",cursor:"pointer","font-size":"0.875rem","font-weight":"500",transition:"all 0.2s ease","min-width":"120px"},o={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},s=l=>{const c=l.target;r(c.value)};return(()=>{var l=KE(),c=l.firstChild,d=c.nextSibling,u=d.firstChild;u.firstChild;var y=u.nextSibling;return y.firstChild,p(l,n),p(c,o),d.addEventListener("change",s),p(d,i),a(u,()=>t("common.english"),null),a(y,()=>t("common.spanish"),null),fe(()=>d.value=e()),l})()};var C0=ae('<img alt="User avatar">'),QE=ae("<div class=user-info-desktop><span>"),XE=ae("<button class=sign-out-desktop>Sign Out"),ZE=ae("<div><div><span></span></div><button>Sign Out"),eI=ae(`<nav><div><div class=desktop-nav></div><div><button class=mobile-menu-button><svg width=24 height=24 viewBox="0 0 24 24"fill=currentColor><path></path></svg></button></div></div><div class=mobile-nav></div><style>
        .nav-active {
          background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)) !important;
          color: white !important;
          box-shadow: var(--shadow-sm);
        }
        
        .desktop-nav a:hover:not(.nav-active),
        .nav-group button:hover {
          background: var(--background-color);
          color: var(--text-primary);
        }
        
        .mobile-nav a:hover:not(.nav-active) {
          background: var(--background-color);
          color: var(--text-primary);
        }

        /* Create invisible bridge to prevent gap issues */
        .nav-group::before {
          content: '';
          position: absolute;
          top: 100%;
          left: 0;
          right: 0;
          height: 0.5rem;
          z-index: 9;
        }
        
        @media (max-width: 768px) {
          .desktop-nav {
            display: none !important;
          }
          
          .mobile-menu-button {
            display: block !important;
          }
          
          .user-info-desktop,
          .sign-out-desktop {
            display: none !important;
          }
          
          nav > div:first-child {
            padding: 1rem;
          }
        }
        
        @media (min-width: 769px) {
          .mobile-nav {
            display: none !important;
          }
        }
      `),tI=ae("<div class=nav-group><button> <span></span></button><div>"),rI=ae("<div>"),nI=ae("<div><div><span> </span><span>");const iI=()=>{const{t}=_r(),[e,r]=we(!1),[n,i]=we(null),[o,s]=we(null),l={background:"var(--surface-color)","border-bottom":"1px solid var(--border-color)","box-shadow":"var(--shadow-sm)","backdrop-filter":"blur(10px)",position:"sticky",top:"0","z-index":"100"},c={display:"flex","align-items":"center","justify-content":"space-between",padding:"1rem 2rem",margin:"0 auto",position:"relative"},d={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","text-decoration":"none"},u={display:"flex",gap:"1rem","align-items":"center",flex:"1","margin-left":"2rem"},y={display:"none",position:"absolute",top:"100%",left:"0",right:"0",background:"var(--surface-color)","border-top":"1px solid var(--border-color)","box-shadow":"var(--shadow-md)","max-height":"70vh","overflow-y":"auto"},g={position:"relative",display:"flex","align-items":"center"},f={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem",background:"transparent",border:"none",color:"var(--text-secondary)","font-weight":"500","font-size":"0.875rem",cursor:"pointer","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease","white-space":"nowrap"},w={position:"absolute",top:"100%",left:"0",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","min-width":"200px","margin-top":"0.25rem","z-index":"10",display:"none","padding-top":"0.25rem"},E={"border-bottom":"1px solid var(--border-color)"},x={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",cursor:"pointer","font-weight":"600",color:"var(--text-primary)"},T={display:"block","text-decoration":"none",color:"var(--text-secondary)",padding:"0.75rem 1rem","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease","white-space":"nowrap"},Y={...T,padding:"0.75rem 1.5rem","border-bottom":"1px solid var(--border-light)"},K={display:"none",background:"transparent",border:"none",padding:"0.5rem",cursor:"pointer",color:"var(--text-primary)"},j={display:"flex","align-items":"center",gap:"1rem"},q={display:"flex","align-items":"center",gap:"0.75rem",padding:"0.5rem 1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",color:"var(--text-primary)"},J={width:"32px",height:"32px","border-radius":"50%","object-fit":"cover"},C={...T,cursor:"pointer",border:"1px solid var(--border-color)",background:"transparent","border-radius":"var(--border-radius-sm)"},P=()=>{vr.signOut()},$=L=>{const O=vr.state?.profile;return O?O[L]===!0||O.isAdmin===!0:!1},D=()=>{r(!e())},b=L=>{i(n()===L?null:L)},S=L=>{const O=o();O&&(clearTimeout(O),s(null)),i(L)},v=()=>{const L=setTimeout(()=>{i(null)},300);s(L)},z=[{name:"Finance",icon:"",items:[{path:"/accounts",label:t("navigation.accounts"),permission:"AccountAccess",icon:""},{path:"/entry-books",label:t("navigation.entryBooks"),permission:"JournalAccess",icon:""},{path:"/balance-sheet",label:t("navigation.balanceSheet"),permission:"AccountAccess",icon:""},{path:"/bank-consolidations",label:t("navigation.consolidate"),permission:"BankingAccess",icon:""},{path:"/automation",label:"Manual Automation",permission:"AccountAccess",icon:""},{path:"/event-automation",label:"Event Automation",permission:"AccountAccess",icon:""}]},{name:"Operations",icon:"",items:[{path:"/inventory",label:t("navigation.inventory"),permission:"InventoryAccess",icon:""},{path:"/invoices",label:t("invoices.invoices"),permission:"invoiceAccess",icon:""},{path:"/hbl",label:t("navigation.hbl"),permission:"HBLAccess",icon:""}]},{name:"Management",icon:"",items:[{path:"/employees",label:t("navigation.employees"),permission:"EmployeeAccess",icon:""},{path:"/admin/users",label:"Admin",permission:"isAdmin",icon:"",adminOnly:!0}]}],re=()=>z.map(L=>({...L,items:L.items.filter(O=>O.adminOnly?vr.state?.profile?.isAdmin:$(O.permission))})).filter(L=>L.items.length>0);return(()=>{var L=eI(),O=L.firstChild,ne=O.firstChild,X=ne.nextSibling,W=X.firstChild,se=W.firstChild,F=se.firstChild,k=O.nextSibling;return a(O,I(hc,{href:"/",style:d,children:"HRM Finance"}),ne),p(ne,u),a(ne,I(hc,{href:"/",style:T,activeClass:"nav-active",get children(){return[" ",Te(()=>t("navigation.dashboard"))]}}),null),a(ne,I(Ct,{get each(){return re()},children:N=>(()=>{var A=tI(),V=A.firstChild,Z=V.firstChild,H=Z.nextSibling,B=V.nextSibling;return A.addEventListener("mouseleave",v),A.addEventListener("mouseenter",()=>S(N.name)),a(V,()=>N.icon,Z),a(V,()=>N.name,H),H.style.setProperty("font-size","0.75rem"),B.addEventListener("mouseleave",v),B.addEventListener("mouseenter",()=>S(N.name)),a(B,I(Ct,{get each(){return N.items},children:M=>I(hc,{get href(){return M.path},style:T,activeClass:"nav-active",onClick:()=>i(null),get children(){return[Te(()=>M.icon)," ",Te(()=>M.label)]}})})),fe(M=>{var G=g,Q=f,ie={...w,display:n()===N.name?"block":"none"};return M.e=p(A,G,M.e),M.t=p(V,Q,M.t),M.a=p(B,ie,M.a),M},{e:void 0,t:void 0,a:void 0}),A})()}),null),p(X,j),a(X,I(JE,{}),W),a(X,I(Oe,{get when(){return vr.currentUser},get children(){return[(()=>{var N=QE(),A=N.firstChild;return a(N,I(Oe,{get when(){return vr.currentUser?.photoURL},get children(){var V=C0();return fe(Z=>{var H=vr.currentUser.photoURL,B=J;return H!==Z.e&&ir(V,"src",Z.e=H),Z.t=p(V,B,Z.t),Z},{e:void 0,t:void 0}),V}}),A),a(A,()=>vr.currentUser?.displayName||vr.currentUser?.email),fe(V=>p(N,q,V)),N})(),(()=>{var N=XE();return N.addEventListener("mouseleave",A=>{A.currentTarget.style.background="transparent",A.currentTarget.style.color="var(--text-secondary)"}),N.addEventListener("mouseenter",A=>{A.currentTarget.style.background="var(--background-color)",A.currentTarget.style.color="var(--text-primary)"}),N.$$click=P,fe(A=>p(N,C,A)),N})()]}}),W),W.$$click=D,p(W,K),a(k,I(hc,{href:"/",style:Y,activeClass:"nav-active",onClick:()=>r(!1),get children(){return[" ",Te(()=>t("navigation.dashboard"))]}}),null),a(k,I(Ct,{get each(){return re()},children:N=>(()=>{var A=nI(),V=A.firstChild,Z=V.firstChild,H=Z.firstChild,B=Z.nextSibling;return p(A,E),V.$$click=()=>b(N.name),p(V,x),a(Z,()=>N.icon,H),a(Z,()=>N.name,null),B.style.setProperty("transition","transform 0.2s"),a(A,I(Oe,{get when(){return n()===N.name},get children(){var M=rI();return M.style.setProperty("background","var(--background-color)"),a(M,I(Ct,{get each(){return N.items},children:G=>I(hc,{get href(){return G.path},get style(){return{...Y,"padding-left":"3rem"}},activeClass:"nav-active",onClick:()=>r(!1),get children(){return[Te(()=>G.icon)," ",Te(()=>G.label)]}})})),M}}),null),fe(M=>(M=n()===N.name?"rotate(180deg)":"none")!=null?B.style.setProperty("transform",M):B.style.removeProperty("transform")),A})()}),null),a(k,I(Oe,{get when(){return vr.currentUser},get children(){var N=ZE(),A=N.firstChild,V=A.firstChild,Z=A.nextSibling;return N.style.setProperty("padding","1rem"),N.style.setProperty("border-top","2px solid var(--border-color)"),a(A,I(Oe,{get when(){return vr.currentUser?.photoURL},get children(){var H=C0();return fe(B=>{var M=vr.currentUser.photoURL,G=J;return M!==B.e&&ir(H,"src",B.e=M),B.t=p(H,G,B.t),B},{e:void 0,t:void 0}),H}}),V),a(V,()=>vr.currentUser?.displayName||vr.currentUser?.email),Z.$$click=()=>{P(),r(!1)},fe(H=>{var B={...q,"margin-bottom":"1rem"},M={...C,width:"100%"};return H.e=p(A,B,H.e),H.t=p(Z,M,H.t),H},{e:void 0,t:void 0}),N}}),null),fe(N=>{var A=l,V=c,Z=e()?"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z":"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z",H={...y,display:e()?"block":"none"};return N.e=p(L,A,N.e),N.t=p(O,V,N.t),Z!==N.a&&ir(F,"d",N.a=Z),N.o=p(k,H,N.o),N},{e:void 0,t:void 0,a:void 0,o:void 0}),L})()};br(["click"]);var oI=ae("<div><div><div></div><h1></h1><p>.</p><div><p><strong></strong><br></p></div><div><button></button></div><div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><p>"),A0=ae("<br>"),sI=ae("<strong>");const aI=t=>{const{t:e}=_r(),r={"min-height":"calc(100vh - 200px)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},n={"text-align":"center","max-width":"600px",width:"100%"},i={"font-size":"5rem",color:"#e53e3e","margin-bottom":"2rem"},o={"font-size":"2.5rem","font-weight":"700",color:"#1a202c","margin-bottom":"1rem"},s={"font-size":"1.25rem",color:"#718096","margin-bottom":"2rem","line-height":"1.6"},l={background:"#f7fafc",border:"1px solid #e2e8f0","border-radius":"0.5rem",padding:"1.5rem","margin-bottom":"2rem"},c={color:"#4a5568","font-size":"1rem","line-height":"1.6"},d={display:"flex",gap:"1rem","justify-content":"center","flex-wrap":"wrap"},u={padding:"0.75rem 2rem","border-radius":"0.5rem","text-decoration":"none","font-weight":"500",transition:"all 0.2s",display:"inline-block"},y={...u,background:"var(--primary-color)",color:"white",border:"2px solid var(--primary-color)"},g={...u,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},f={"text-align":"left","margin-top":"2rem",padding:"0 2rem"},w={display:"flex","align-items":"center",gap:"0.75rem","margin-bottom":"1rem",color:"#4a5568"},E={color:"#48bb78","font-size":"1.25rem"};return I(Po,{get title(){return e("unauthorized.title")},get children(){var x=oI(),T=x.firstChild,Y=T.firstChild,K=Y.nextSibling,j=K.nextSibling,q=j.firstChild,J=j.nextSibling,C=J.firstChild,P=C.firstChild;P.nextSibling;var $=J.nextSibling,D=$.firstChild,b=$.nextSibling,S=b.firstChild,v=S.nextSibling,z=v.firstChild,re=z.nextSibling,L=v.nextSibling,O=L.firstChild,ne=O.nextSibling,X=L.nextSibling,W=X.firstChild,se=W.nextSibling,F=b.nextSibling,k=F.firstChild;return p(x,r),p(T,n),p(Y,i),p(K,o),a(K,()=>e("unauthorized.accessDenied")),p(j,s),a(j,()=>e("unauthorized.noPermission"),q),a(j,(()=>{var N=Te(()=>!!t.featureName);return()=>N()?` ${t.featureName}`:` ${e("unauthorized.thisFeature")}`})(),q),p(J,l),p(C,c),a(P,()=>e("unauthorized.whySeeing")),a(C,()=>e("unauthorized.explanation"),null),a(C,(()=>{var N=Te(()=>!!t.requiredPermission);return()=>N()&&[A0(),A0(),(()=>{var A=sI();return a(A,()=>e("unauthorized.requiredPermission")),A})()," ",Te(()=>t.requiredPermission)]})(),null),p($,d),a($,I(hc,{href:"/",style:y,get children(){return e("unauthorized.goToDashboard")}}),D),D.$$click=()=>window.history.back(),a(D,()=>e("unauthorized.goBack")),p(b,f),S.style.setProperty("margin-bottom","1rem"),S.style.setProperty("color","#2d3748"),a(S,()=>e("unauthorized.featuresCanAccess")),a(re,()=>e("unauthorized.dashboardAccess")),a(ne,()=>e("unauthorized.profileAccess")),a(se,()=>e("unauthorized.roleBasedAccess")),F.style.setProperty("margin-top","3rem"),F.style.setProperty("padding","1.5rem"),F.style.setProperty("background","#edf2f7"),F.style.setProperty("border-radius","0.5rem"),k.style.setProperty("color","#4a5568"),k.style.setProperty("font-size","0.875rem"),a(k,()=>e("unauthorized.needAccess")),fe(N=>{var A=g,V=w,Z=E,H=w,B=E,M=w,G=E;return N.e=p(D,A,N.e),N.t=p(v,V,N.t),N.a=p(z,Z,N.a),N.o=p(L,H,N.o),N.i=p(O,B,N.i),N.n=p(X,M,N.n),N.s=p(W,G,N.s),N},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),x}})};br(["click"]);const go=t=>{const{t:e}=_r(),r=()=>{if(!t.permission)return!0;const i=vr.state?.profile;if(!i)return!1;if(i.isAdmin)return!0;switch(t.permission){case"AccountAccess":return i.AccountAccess===!0;case"InventoryAccess":return i.InventoryAccess===!0;case"EmployeeAccess":return i.EmployeeAccess===!0;case"BankingAccess":return i.BankingAccess===!0;case"JournalAccess":return i.JournalAccess===!0;case"AdminAccess":return i.isAdmin===!0;default:return i[t.permission]===!0}},n=()=>{if(t.requiredPermission)return t.requiredPermission;switch(t.permission){case"AccountAccess":return e("unauthorized.permissions.accountAccess");case"InventoryAccess":return e("unauthorized.permissions.inventoryAccess");case"EmployeeAccess":return e("unauthorized.permissions.employeeAccess");case"BankingAccess":return e("unauthorized.permissions.bankingAccess");case"JournalAccess":return e("unauthorized.permissions.journalAccess");case"AdminAccess":return e("unauthorized.permissions.adminAccess");default:return t.permission}};return I(Oe,{get when(){return r()},get fallback(){return t.fallback||I(aI,{get featureName(){return t.featureName},get requiredPermission(){return n()}})},get children(){return t.children}})};var lI=ae('<button title="Open Dev Tools">'),cI=ae("<span>(<!>)"),dI=ae("<div><span></span><span>"),$0=ae("<div>"),uI=ae("<div>Database reset only available in fake mode"),hI=ae("<div><div>Loading..."),pI=ae("<div><div><h3> Dev Tools</h3><button></button></div><div><div>API Mode</div><div><button>Fake Server</button><button>Real API</button><button>Hybrid</button></div><div>Current: <strong></strong></div></div><div><div>Health Status</div></div><div><div>Database Stats</div></div><div><div>Actions</div><div><button> Refresh Stats</button><button> Health Check</button></div><div><button> Reset DB</button></div></div><div><div>Info</div><div> <strong>Fake Server:</strong> Uses local mock data<br> <strong>Real API:</strong> Connects to actual backend<br> <strong>Hybrid:</strong> Real API with fake fallback<br> Settings are saved in localStorage"),mI=ae("<div>Loading..."),fI=ae("<div><span>:</span><span>");const yI=()=>{const[t,e]=we(!1),[r,n]=we(Ff.getMode()),[i,o]=we({}),[s,l]=we(null),[c,d]=we(!1);jn(async()=>{await u(),await y()});const u=async()=>{try{const C=await w0.getStats();o(C)}catch(C){console.error("Failed to load stats:",C)}},y=async()=>{try{const C=await w0.healthCheck();l(C)}catch(C){console.error("Health check failed:",C),l({status:"error",error:C.message})}},g=async C=>{d(!0);try{Ff.setMode(C),n(C),await u(),await y()}catch(P){console.error("Failed to change API mode:",P)}finally{d(!1)}},f=async()=>{if(confirm("Are you sure you want to reset the fake database to its initial state?")){d(!0);try{const C=await $n.utils.resetDatabase();alert(C.message),await u()}catch(C){console.error("Failed to reset database:",C),alert("Failed to reset database")}finally{d(!1)}}},w={position:"fixed",bottom:"20px",right:"20px","z-index":"10000","font-family":"monospace"},E={background:"#1a1a1a",color:"#fff",border:"1px solid #333","border-radius":"8px",padding:"16px","min-width":"300px","max-width":"400px","box-shadow":"0 4px 20px rgba(0,0,0,0.3)"},x={background:"#007acc",color:"#fff",border:"none","border-radius":"50%",width:"50px",height:"50px",cursor:"pointer","font-size":"20px","box-shadow":"0 2px 10px rgba(0,0,0,0.2)",display:"flex","align-items":"center","justify-content":"center"},T={background:"#333",color:"#fff",border:"1px solid #555","border-radius":"4px",padding:"6px 12px",cursor:"pointer","font-size":"12px","margin-right":"8px","margin-bottom":"8px"},Y={...T,background:"#007acc","border-color":"#007acc"},K={"margin-bottom":"16px","padding-bottom":"12px","border-bottom":"1px solid #333"},j={"font-size":"14px","font-weight":"bold","margin-bottom":"8px",color:"#007acc"},q={display:"flex","justify-content":"space-between","font-size":"12px","margin-bottom":"4px"},J=C=>({display:"inline-block",width:"8px",height:"8px","border-radius":"50%","margin-right":"8px",background:C==="healthy"?"#00ff00":C==="error"?"#ff0000":"#ffff00"});return(()=>{var C=$0();return a(C,I(Oe,{get when(){return!t()},get children(){var P=lI();return P.$$click=()=>e(!0),p(P,x),P}}),null),a(C,I(Oe,{get when(){return t()},get children(){var P=pI(),$=P.firstChild,D=$.firstChild,b=D.nextSibling,S=$.nextSibling,v=S.firstChild,z=v.nextSibling,re=z.firstChild,L=re.nextSibling,O=L.nextSibling,ne=z.nextSibling,X=ne.firstChild,W=X.nextSibling,se=S.nextSibling,F=se.firstChild,k=se.nextSibling,N=k.firstChild,A=k.nextSibling,V=A.firstChild,Z=V.nextSibling,H=Z.firstChild,B=H.nextSibling,M=Z.nextSibling,G=M.firstChild,Q=A.nextSibling,ie=Q.firstChild,me=ie.nextSibling;return p(P,E),$.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),$.style.setProperty("margin-bottom","16px"),D.style.setProperty("margin","0"),D.style.setProperty("color","#007acc"),D.style.setProperty("font-size","16px"),b.$$click=()=>e(!1),re.$$click=()=>g("fake"),L.$$click=()=>g("real"),O.$$click=()=>g("hybrid"),ne.style.setProperty("font-size","11px"),ne.style.setProperty("color","#888"),ne.style.setProperty("margin-top","4px"),a(W,r),a(ne,()=>r()==="fake"&&" (Using fake server)",null),a(ne,()=>r()==="real"&&" (Using real API)",null),a(ne,()=>r()==="hybrid"&&" (Real API with fallback)",null),a(se,I(Oe,{get when(){return s()},get fallback(){return(()=>{var oe=mI();return oe.style.setProperty("font-size","12px"),oe})()},get children(){return[(()=>{var oe=dI(),ee=oe.firstChild,de=ee.nextSibling;return oe.style.setProperty("display","flex"),oe.style.setProperty("align-items","center"),oe.style.setProperty("font-size","12px"),a(de,()=>s()?.status||"Unknown"),a(oe,I(Oe,{get when(){return s()?.timestamp},get children(){var he=cI(),le=he.firstChild,ye=le.nextSibling;return ye.nextSibling,he.style.setProperty("margin-left","8px"),he.style.setProperty("color","#888"),a(he,()=>new Date(s().timestamp).toLocaleTimeString(),ye),he}}),null),fe(he=>p(ee,J(s()?.status||"unknown"),he)),oe})(),I(Oe,{get when(){return s()?.error},get children(){var oe=$0();return oe.style.setProperty("font-size","11px"),oe.style.setProperty("color","#ff6666"),oe.style.setProperty("margin-top","4px"),a(oe,()=>s().error),oe}})]}}),null),a(k,I(Ct,{get each(){return Object.entries(i())},children:([oe,ee])=>(()=>{var de=fI(),he=de.firstChild,le=he.firstChild,ye=he.nextSibling;return p(de,q),he.style.setProperty("text-transform","capitalize"),a(he,oe,le),ye.style.setProperty("color","#00ff00"),a(ye,ee),de})()}),null),H.$$click=u,B.$$click=y,M.style.setProperty("margin-top","8px"),G.$$click=f,a(A,I(Oe,{get when(){return r()!=="fake"},get children(){var oe=uI();return oe.style.setProperty("font-size","11px"),oe.style.setProperty("color","#888"),oe.style.setProperty("margin-top","4px"),oe}}),null),me.style.setProperty("font-size","11px"),me.style.setProperty("color","#888"),me.style.setProperty("line-height","1.4"),a(P,I(Oe,{get when(){return c()},get children(){var oe=hI(),ee=oe.firstChild;return oe.style.setProperty("position","absolute"),oe.style.setProperty("top","0"),oe.style.setProperty("left","0"),oe.style.setProperty("right","0"),oe.style.setProperty("bottom","0"),oe.style.setProperty("background","rgba(0,0,0,0.7)"),oe.style.setProperty("display","flex"),oe.style.setProperty("align-items","center"),oe.style.setProperty("justify-content","center"),oe.style.setProperty("border-radius","8px"),ee.style.setProperty("color","#fff"),ee.style.setProperty("font-size","14px"),oe}}),null),fe(oe=>{var ee={...T,padding:"4px 8px"},de=K,he=j,le=r()==="fake"?Y:T,ye=c(),ve=r()==="real"?Y:T,pe=c(),ge=r()==="hybrid"?Y:T,ke=c(),Ne=K,xe=j,$e=K,Ee=j,Me=K,Ye=j,ze=T,je=c(),Xe=T,ht=c(),ut={...T,background:"#cc4400","border-color":"#cc4400"},Ue=c()||r()!=="fake",it=j;return oe.e=p(b,ee,oe.e),oe.t=p(S,de,oe.t),oe.a=p(v,he,oe.a),oe.o=p(re,le,oe.o),ye!==oe.i&&(re.disabled=oe.i=ye),oe.n=p(L,ve,oe.n),pe!==oe.s&&(L.disabled=oe.s=pe),oe.h=p(O,ge,oe.h),ke!==oe.r&&(O.disabled=oe.r=ke),oe.d=p(se,Ne,oe.d),oe.l=p(F,xe,oe.l),oe.u=p(k,$e,oe.u),oe.c=p(N,Ee,oe.c),oe.w=p(A,Me,oe.w),oe.m=p(V,Ye,oe.m),oe.f=p(H,ze,oe.f),je!==oe.y&&(H.disabled=oe.y=je),oe.g=p(B,Xe,oe.g),ht!==oe.p&&(B.disabled=oe.p=ht),oe.b=p(G,ut,oe.b),Ue!==oe.T&&(G.disabled=oe.T=Ue),oe.A=p(ie,it,oe.A),oe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),P}}),null),fe(P=>p(C,w,P)),C})()};br(["click"]);const gI=[{id:"1",accountNumber:"1000",name:"Cash and Cash Equivalents",accountType:"Asset",category:"Current Assets",description:"Cash on hand and in bank accounts",balance:45230.5,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1001",accountNumber:"1001",name:"Petty Cash",accountType:"Asset",category:"Current Assets",description:"Small amounts of cash for minor expenses",balance:500,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1002",accountNumber:"1002",name:"Bank - Checking Account",accountType:"Asset",category:"Current Assets",description:"Main operating checking account",balance:32730.5,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1003",accountNumber:"1003",name:"Bank - Savings Account",accountType:"Asset",category:"Current Assets",description:"Interest-bearing savings account",balance:12e3,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"2",accountNumber:"1100",name:"Accounts Receivable",accountType:"Asset",category:"Current Assets",description:"Money owed by customers",balance:23450.75,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2001",accountNumber:"1101",name:"Trade Receivables",accountType:"Asset",category:"Current Assets",description:"Receivables from regular customers",balance:18450.75,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2002",accountNumber:"1102",name:"Employee Advances",accountType:"Asset",category:"Current Assets",description:"Money advanced to employees",balance:5e3,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"3",accountNumber:"1200",name:"Inventory",accountType:"Asset",category:"Current Assets",description:"Products held for sale",balance:78920.25,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-13"},{id:"4",accountNumber:"1500",name:"Equipment",accountType:"Asset",category:"Fixed Assets",description:"Office equipment and machinery",balance:125e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-12"},{id:"5",accountNumber:"2000",name:"Accounts Payable",accountType:"Liability",category:"Current Liabilities",description:"Money owed to suppliers",balance:15670.3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-11"},{id:"6",accountNumber:"2100",name:"Accrued Expenses",accountType:"Liability",category:"Current Liabilities",description:"Expenses incurred but not yet paid",balance:8945.6,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-10"},{id:"7",accountNumber:"2500",name:"Long-term Debt",accountType:"Liability",category:"Long-term Liabilities",description:"Long-term loans and mortgages",balance:85e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-09"},{id:"8",accountNumber:"3000",name:"Owner's Equity",accountType:"Equity",category:"Owner's Equity",description:"Owner's investment in the business",balance:15e4,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-08"},{id:"9",accountNumber:"3100",name:"Retained Earnings",accountType:"Equity",category:"Owner's Equity",description:"Accumulated profits retained in business",balance:32450.8,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-07"},{id:"10",accountNumber:"4000",name:"Sales Revenue",accountType:"Revenue",category:"Operating Revenue",description:"Revenue from product sales",balance:245678.9,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-06"},{id:"11",accountNumber:"4100",name:"Service Revenue",accountType:"Revenue",category:"Operating Revenue",description:"Revenue from services provided",balance:89432.15,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-05"},{id:"12",accountNumber:"5000",name:"Cost of Goods Sold",accountType:"Expense",category:"Operating Expenses",description:"Direct costs of producing goods",balance:125678.45,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-04"},{id:"13",accountNumber:"5100",name:"Salaries Expense",accountType:"Expense",category:"Operating Expenses",description:"Employee salary expenses",balance:98765.32,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-03"},{id:"14",accountNumber:"5200",name:"Rent Expense",accountType:"Expense",category:"Operating Expenses",description:"Office rent expenses",balance:24e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-02"}],vI=[{id:"1",accountId:"1",date:"2024-01-15",description:"Customer payment received",debitAmount:5e3,creditAmount:0,reference:"INV-2024-001",type:"debit"},{id:"2",accountId:"2",date:"2024-01-15",description:"Customer payment received",debitAmount:0,creditAmount:5e3,reference:"INV-2024-001",type:"credit"},{id:"3",accountId:"5",date:"2024-01-14",description:"Office supplies purchased",debitAmount:0,creditAmount:1250,reference:"PO-2024-001",type:"credit"}],[as,id]=we(gI),[fm,bI]=we(vI),qr={get accounts(){return as()},get transactions(){return fm()},parseAccount(t){let e={id:t?.accountId||t.id||t?.code,accountNumber:t.accountNumber||t?.code,code:t?.code,name:t.name,type:t.type,accountType:t.accountType,classification:t.classification||t.clasification,category:t.category,description:t.description,isActive:!0,accountId:t?.accountId,parentAccountId:t?.parentAccountId,parentAccountNumber:t?.parentAccountNumber};return console.log(e),e},updAccount(t){try{id(t.map(qr.parseAccount))}catch(e){console.log(e)}},fetchAllAccount(t){const e={...t,createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return id([...as(),e]),e},async addAccount(t){const e={...t,accountId:Nl(),id:Nl(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};console.log("newAccount",e);let r=await Id.create(e);return console.log(r),id([...as(),e]),e},async updateAccountServer(t,e){let r=await Id.update(t,e);qr.updateAccount(t,e),console.log(r,t,e)},updateAccount(t,e){id(as().map(r=>r.id===t?{...r,...e,lastModified:new Date().toISOString().split("T")[0]}:r))},async deleteAccount(t){let e=await Id.delete(t);console.log("deleteAccount",e),id(as().filter(r=>r.id!==t))},getAccountById(t){return as().find(e=>e.id===t)},getAccountsByType(t){return as().filter(e=>e.type===t)},getAccountTransactions(t){return fm().filter(e=>e.accountId===t)},addTransaction(t){const e={...t,id:Date.now().toString()};bI([...fm(),e]);const r=this.getAccountById(t.accountId);if(r){const n=t.type==="debit"?t.debitAmount:-t.creditAmount;this.updateAccount(t.accountId,{balance:r.balance+n})}return e},getTotalByType(t){return as().filter(e=>e.type===t&&e.isActive).reduce((e,r)=>e+r.balance,0)},getAccountCategories(t){const e=this.getAccountsByType(t);return[...new Set(e.map(r=>r.category))]},getSubAccounts(t){return as().filter(e=>e.parentAccountId===t)},getParentAccounts(){return as().filter(t=>!t.parentAccountId)},getAccountHierarchy(){const t=this.getParentAccounts();return console.log(this.getSubAccounts("20110")),console.log(t),t.map(e=>({...e,subAccounts:this.getSubAccounts(e?.id)}))},getAccountWithSubAccounts(t){const e=this.getAccountById(t);return e?{...e,subAccounts:this.getSubAccounts(t),parentAccount:e.parentAccountId?this.getAccountById(e.parentAccountId):null}:null},getAccountPath(t){const e=this.getAccountById(t);if(!e)return[];const r=[e];let n=e;for(;n.parentAccountId;){const i=this.getAccountById(n.parentAccountId);if(i)r.unshift(i),n=i;else break}return r},getTotalBalanceWithSubAccounts(t){const e=this.getAccountById(t);if(!e)return 0;const n=this.getSubAccounts(t).reduce((i,o)=>i+this.getTotalBalanceWithSubAccounts(o.id),0);return e.balance+n},canDeleteAccount(t){const e=this.getSubAccounts(t);if(e.length>0)return{canDelete:!1,reason:`Account has ${e.length} sub-account(s). Delete or move sub-accounts first.`};const r=this.getAccountTransactions(t);return r.length>0?{canDelete:!1,reason:`Account has ${r.length} transaction(s). Cannot delete account with transaction history.`}:{canDelete:!0}}};var xa=ae("<div>"),od=ae("<div> ");const _I=()=>{const{t}=_r(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},n={"font-size":"0.875rem",color:"var(--text-muted)"},i=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E),o=qr.getTotalByType("Asset"),s=qr.getTotalByType("Liability"),l=qr.getTotalByType("Equity"),c=qr.getTotalByType("Revenue"),d=qr.getTotalByType("Expense"),u=qr.getAccountsByType("Asset").length,y=qr.getAccountsByType("Liability").length,g=qr.getAccountsByType("Equity").length,f=qr.getAccountsByType("Revenue").length,w=qr.getAccountsByType("Expense").length;return(()=>{var E=xa();return p(E,e),a(E,I(Gt,{get title(){return t("dashboard.totalAssets")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var x=xa();return a(x,()=>i(o)),fe(T=>p(x,r,T)),x})(),(()=>{var x=od(),T=x.firstChild;return a(x,u,T),a(x,()=>t("navigation.accounts"),null),fe(Y=>p(x,n,Y)),x})()]}}),null),a(E,I(Gt,{get title(){return t("dashboard.totalLiabilities")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var x=xa();return a(x,()=>i(s)),fe(T=>p(x,r,T)),x})(),(()=>{var x=od(),T=x.firstChild;return a(x,y,T),a(x,()=>t("navigation.accounts"),null),fe(Y=>p(x,n,Y)),x})()]}}),null),a(E,I(Gt,{get title(){return t("dashboard.totalEquity")},get subtitle(){return t("accounts.categories.ownersEquity")},get children(){return[(()=>{var x=xa();return a(x,()=>i(l)),fe(T=>p(x,r,T)),x})(),(()=>{var x=od(),T=x.firstChild;return a(x,g,T),a(x,()=>t("navigation.accounts"),null),fe(Y=>p(x,n,Y)),x})()]}}),null),a(E,I(Gt,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("accounts.categories.operatingRevenue")},get children(){return[(()=>{var x=xa();return a(x,()=>i(c)),fe(T=>p(x,r,T)),x})(),(()=>{var x=od(),T=x.firstChild;return a(x,f,T),a(x,()=>t("navigation.accounts"),null),fe(Y=>p(x,n,Y)),x})()]}}),null),a(E,I(Gt,{get title(){return t("dashboard.totalExpenses")},get subtitle(){return t("accounts.categories.operatingExpenses")},get children(){return[(()=>{var x=xa();return a(x,()=>i(d)),fe(T=>p(x,r,T)),x})(),(()=>{var x=od(),T=x.firstChild;return a(x,w,T),a(x,()=>t("navigation.accounts"),null),fe(Y=>p(x,n,Y)),x})()]}}),null),a(E,I(Gt,{get title(){return t("dashboard.netIncome")},get subtitle(){return`${t("dashboard.totalRevenue")} - ${t("dashboard.totalExpenses")}`},get children(){return[(()=>{var x=xa();return a(x,()=>i(c-d)),fe(T=>p(x,{...r,color:c-d>=0?"#4caf50":"#f44336"},T)),x})(),(()=>{var x=xa();return a(x,()=>c-d>=0?t("dashboard.netIncome"):t("dashboard.netLoss")),fe(T=>p(x,n,T)),x})()]}}),null),E})()};var PI=ae("<div><div></div><div>"),SI=ae("<h3>"),sd=ae("<div>");const wI=t=>{const{t:e}=_r();ay();const r={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},i={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"},o={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},s={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},l={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem"},c={"font-size":"0.875rem",color:"var(--text-secondary)","line-height":"1.4"},d=g=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[g]||{bg:"#f5f5f5",color:"#666"},u=g=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(g),y=d(t.account.accountType);return I(Gt,{get children(){return[(()=>{var g=PI(),f=g.firstChild,w=f.nextSibling;return p(g,n),p(f,i),a(f,()=>t.account.accountNumber),a(w,()=>e(`accounts.types.${t.account.accountType.toLowerCase()}`)),fe(E=>p(w,{...o,background:y.bg,color:y.color},E)),g})(),(()=>{var g=SI();return g.style.setProperty("margin","0 0 0.5rem 0"),g.style.setProperty("font-size","1.1rem"),a(g,()=>t.account.name),g})(),(()=>{var g=sd();return p(g,l),a(g,()=>t.account.category),g})(),(()=>{var g=sd();return p(g,s),a(g,()=>u(t.account.balance)),g})(),(()=>{var g=sd();return p(g,c),a(g,()=>t.account.description),g})(),Te(()=>Te(()=>!t.account.isActive)()&&(()=>{var g=sd();return g.style.setProperty("margin-top","0.5rem"),g.style.setProperty("padding","0.25rem 0.75rem"),g.style.setProperty("border-radius","9999px"),g.style.setProperty("font-size","0.75rem"),g.style.setProperty("font-weight","500"),g.style.setProperty("background","#ffebee"),g.style.setProperty("color","#d32f2f"),g.style.setProperty("text-align","center"),a(g,()=>e("common.inactive")),g})()),(()=>{var g=sd();return p(g,r),a(g,I(_t,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.account),get children(){return[Te(()=>e("common.view"))," ",Te(()=>e("accounts.accountDetails"))]}})),g})()]}})};var xI=ae("<div><div></div><div>"),CI=ae("<div><div><div><div></div><h3>"),AI=ae("<div>"),$I=ae("<button>"),EI=ae("<div><h4> (<!>)"),II=ae("<div><div><div></div><div>  </div></div><div>");const TI=t=>{const{t:e}=_r(),r=ay(),[n,i]=we(!0),o={"margin-bottom":"1rem"},s={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},l={display:"flex","align-items":"center",gap:"1rem"},c={background:"none",border:"none",cursor:"pointer","font-size":"1.2rem",color:"var(--text-muted)",padding:"0.25rem","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease"},d={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},u={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},y={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},g={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},f={"margin-left":"1rem","border-left":"2px solid var(--border-color)","padding-left":"1rem","margin-top":"1rem"},w={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem","margin-bottom":"0.5rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},E={flex:"1"},x={"font-weight":"500","margin-bottom":"0.25rem"},T={"font-size":"0.875rem",color:"var(--text-muted)"},Y={"font-weight":"600",color:"var(--primary-color)"},K={display:"flex",gap:"0.5rem"},j=D=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[D]||{bg:"#f5f5f5",color:"#666"},q=D=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(D),J=D=>{t.onViewDetails?t.onViewDetails(D):r(`/accounts/${D.id}`)},C=()=>{t.onAddSubAccount&&t.onAddSubAccount(t.account)},P=t.account.balance+t.account.subAccounts.reduce((D,b)=>D+b.balance,0),$=j(t.account.accountType);return I(Gt,{className:"account-hierarchy-card",style:o,get children(){return[(()=>{var D=CI(),b=D.firstChild,S=b.firstChild,v=S.firstChild,z=v.nextSibling;return p(D,s),p(b,l),a(b,(()=>{var re=Te(()=>t.account.subAccounts.length>0);return()=>re()&&(()=>{var L=$I();return L.addEventListener("mouseleave",O=>O.target.style.background="none"),L.addEventListener("mouseenter",O=>O.target.style.background="var(--background-color)"),L.$$click=()=>i(!n()),p(L,c),a(L,()=>n()?"":""),L})()})(),S),S.$$click=()=>J(t.account),S.style.setProperty("cursor","pointer"),p(v,d),a(v,()=>t.account.accountNumber),p(z,u),a(z,()=>t.account.name),a(D,I(Oe,{get when(){return t?.account?.accountType},get children(){var re=xI(),L=re.firstChild,O=L.nextSibling;return re.style.setProperty("text-align","right"),p(L,y),a(L,()=>q(P||0)),a(O,()=>e(`accounts.types.${t?.account?.accountType?.toLowerCase()}`)),fe(ne=>p(O,{...g,background:$.bg,color:$.color},ne)),re}}),null),D})(),(()=>{var D=AI();return p(D,K),a(D,I(_t,{variant:"secondary",size:"sm",onClick:()=>J(t.account),get children(){return[Te(()=>e("common.view"))," ",Te(()=>e("accounts.accountDetails"))]}}),null),a(D,I(_t,{variant:"outline",size:"sm",onClick:C,get children(){return[Te(()=>e("common.add"))," ",Te(()=>e("accounts.subAccounts"))]}}),null),D})(),Te(()=>Te(()=>!!(n()&&t.account.subAccounts.length>0))()&&(()=>{var D=EI(),b=D.firstChild,S=b.firstChild,v=S.nextSibling;return v.nextSibling,p(D,f),b.style.setProperty("margin","0 0 1rem 0"),b.style.setProperty("font-size","1rem"),b.style.setProperty("color","var(--text-muted)"),a(b,()=>e("accounts.subAccounts"),S),a(b,()=>t.account.subAccounts.length,v),a(D,()=>t.account.subAccounts.map(z=>(()=>{var re=II(),L=re.firstChild,O=L.firstChild,ne=O.nextSibling,X=ne.firstChild,W=L.nextSibling;return re.addEventListener("mouseleave",se=>{se.currentTarget.style.background="var(--background-color)",se.currentTarget.style.transform="translateY(0)"}),re.addEventListener("mouseenter",se=>{se.currentTarget.style.background="var(--surface-color)",se.currentTarget.style.transform="translateY(-1px)"}),re.$$click=()=>J(z),p(re,w),p(L,E),p(O,x),a(O,()=>z.name),p(ne,T),a(ne,()=>z.accountNumber,X),a(ne,()=>z.description,null),p(W,Y),a(W,()=>q(z.balance)),re})()),null),D})())]}})};br(["click"]);var kI=ae("<form><div>");const NI=t=>{const{t:e}=_r(),[r,n]=we({accountNumber:"",name:"",accountType:"",category:"",type:"",classification:"",description:"",balance:"0",isActive:"true"}),i=[{value:"Asset",label:e("accounts.types.asset"),type:"debit",classification:"real"},{value:"Liability",label:e("accounts.types.liability"),type:"credit",classification:"real"},{value:"Equity",label:e("accounts.types.equity"),type:"credit",classification:"real"},{value:"Revenue",label:e("accounts.types.revenue"),type:"credit",classification:"nominal"},{value:"Expense",label:e("accounts.types.expense"),type:"debit",classification:"nominal"}],o=()=>{const u=r().accountType;return u?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")},{value:"Sales Revenue",label:e("accounts.categories.salesRevenue")},{value:"Service Revenue",label:e("accounts.categories.servicesRevenue")},{value:"Subscription Revenue",label:e("accounts.categories.subscriptionRevenue")},{value:"Rental Revenue",label:e("accounts.categories.rentalRevenue")},{value:"Commission Revenue",label:e("accounts.categories.commissionRevenue")},{value:"Franchise Revenue",label:e("accounts.categories.franchiseRevenue")},{value:"Licensing Revenue",label:e("accounts.categories.licensingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[u]||[]:[]},s=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],l={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},c=u=>{u.preventDefault();const y=r();if(!y.accountNumber||!y.name||!y.accountType||!y.category){alert(e("forms.requiredField"));return}const g=qr.accounts.find(E=>E.accountNumber===y.accountNumber),f=i.find(E=>E.value===y.accountType);if(g){alert(e("forms.duplicateAccountNumber"));return}const w={accountNumber:y.accountNumber,code:y.accountNumber,name:y.name,accountType:"",classification:f?.classification,type:f?.type,category:y.category,description:y.description,balance:parseFloat(y.balance)||0,isActive:y.isActive==="true"};qr.addAccount(w),n({accountNumber:"",name:"",accountType:"",type:"",category:"",description:"",classification:"",balance:"0",isActive:"true"}),t.onClose()},d=(u,y)=>{n(g=>{const f={...g,[u]:y};return u==="type"&&(f.category=""),f})};return I(si,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.addAccount")},get children(){var u=kI(),y=u.firstChild;return u.addEventListener("submit",c),a(u,I(Mr,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:g=>d("accountNumber",g),get placeholder(){return e("accounts.accountNumber")},required:!0}),y),a(u,I(Mr,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:g=>d("name",g),get placeholder(){return e("accounts.accountName")},required:!0}),y),a(u,I(Hn,{get label(){return e("accounts.accountType")},get value(){return r().accountType},onChange:g=>d("accountType",g),options:i,required:!0}),y),a(u,I(Hn,{get label(){return e("accounts.category")},get value(){return r().category},onChange:g=>d("category",g),get options(){return o()},required:!0}),y),a(u,I(Mr,{get label(){return e("common.description")},get value(){return r().description},onChange:g=>d("description",g),get placeholder(){return e("common.description")}}),y),a(u,I(Mr,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:g=>d("balance",g),get placeholder(){return e("accounts.balance")}}),y),a(u,I(Hn,{get label(){return e("common.status")},get value(){return r().isActive},onChange:g=>d("isActive",g),options:s,required:!0}),y),p(y,l),a(y,I(_t,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(y,I(_t,{variant:"primary",type:"submit",get children(){return e("accounts.addAccount")}}),null),u}})};var LI=ae("<form><div>"),RI=ae("<div><div></div><div> - </div><div>  ");const DI=t=>{const{t:e}=_r(),[r,n]=we({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"});e("accounts.types.asset"),e("accounts.types.liability"),e("accounts.types.equity"),e("accounts.types.revenue"),e("accounts.types.expense");const i=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],o={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},s={background:"var(--background-color)",padding:"1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1.5rem",border:"1px solid var(--border-color)"},l={"font-size":"0.875rem","font-weight":"500",color:"var(--text-muted)","margin-bottom":"0.5rem"},c={"font-weight":"600",color:"var(--text-primary)"},d={"font-size":"0.875rem",color:"var(--text-secondary)"},u=w=>{w.preventDefault();const E=r();if(console.log(E),!E.accountNumber||!E.name||!t.parentAccount){alert(e("forms.requiredField"));return}const x=qr.accounts.find(Y=>Y.accountNumber===E.accountNumber);if(console.log(x),x){alert(e("forms.duplicateAccountNumber"));return}const T={accountNumber:E.accountNumber,code:E.accountNumber,name:E.name,description:E.description,accountType:t.parentAccount.accountType,category:t.parentAccount.category,classification:t.parentAccount?.classification,type:t.parentAccount?.type,isActive:E.isActive==="true",parentAccountId:t.parentAccount.id,parentAccountNumber:t.parentAccount.accountId};qr.addAccount(T),n({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},y=(w,E)=>{n(x=>({...x,[w]:E}))},g=()=>{if(!t.parentAccount)return"";const w=t.parentAccount.accountNumber,x=qr.getSubAccounts(t.parentAccount.id).length+1;return(parseInt(w)+x).toString()},f=()=>r().accountNumber===""&&t.parentAccount?g():r().accountNumber;return I(si,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return`${e("common.add")} ${e("accounts.subAccounts")}`},get children(){return[Te(()=>Te(()=>!!t.parentAccount)()&&(()=>{var w=RI(),E=w.firstChild,x=E.nextSibling,T=x.firstChild,Y=x.nextSibling,K=Y.firstChild;return p(w,s),p(E,l),a(E,()=>e("accounts.parentAccount")),p(x,c),a(x,()=>t.parentAccount.accountNumber,T),a(x,()=>t.parentAccount.name,null),p(Y,d),a(Y,()=>e(`accounts.types.${t.parentAccount?.accountType?.toLowerCase()}`),K),a(Y,()=>t.parentAccount.category,null),w})()),(()=>{var w=LI(),E=w.firstChild;return w.addEventListener("submit",u),a(w,I(Mr,{get label(){return e("accounts.accountNumber")},get value(){return f()},onChange:x=>y("accountNumber",x),get placeholder(){return`${e("common.suggested")}: ${g()}`},required:!0}),E),a(w,I(Mr,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:x=>y("name",x),get placeholder(){return e("accounts.accountName")},required:!0}),E),a(w,I(Mr,{get label(){return e("common.description")},get value(){return r().description},onChange:x=>y("description",x),get placeholder(){return e("common.description")}}),E),a(w,I(Mr,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:x=>y("balance",x),get placeholder(){return e("accounts.balance")}}),E),a(w,I(Hn,{get label(){return e("common.status")},get value(){return r().isActive},onChange:x=>y("isActive",x),options:i,required:!0}),E),p(E,o),a(E,I(_t,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(E,I(_t,{variant:"primary",type:"submit",get children(){return[Te(()=>e("common.add"))," ",Te(()=>e("accounts.subAccounts"))]}}),null),w})()]}})};var MI=ae("<form><div>"),FI=ae("<div>");const OI=t=>{const{t:e}=_r(),[r,n]=we({accountNumber:"",name:"",type:"",accountType:"",category:"",description:"",isActive:"true"}),[i,o]=we(null);xi(()=>{t.account&&(console.log(t.account),n({accountNumber:t.account.accountNumber,name:t.account.name,type:t.account.type,accountType:t.account.accountType,category:t.account.category,description:t.account.description,isActive:t.account.isActive.toString()}),o(null))});const s=[{value:"Asset",label:e("accounts.types.asset")},{value:"Liability",label:e("accounts.types.liability")},{value:"Equity",label:e("accounts.types.equity")},{value:"Revenue",label:e("accounts.types.revenue")},{value:"Expense",label:e("accounts.types.expense")}],l=()=>{const f=r().accountType;return f?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[f]||[]:[]},c=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],d={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},u=f=>{if(f.preventDefault(),o(null),!t.account)return;const w=r();if(!w.accountNumber||!w.name||!w.type||!w.category){o(e("forms.requiredField"));return}if(qr.accounts.find(Y=>Y.accountNumber===w.accountNumber&&Y.id!==t.account.id)){o(e("forms.duplicateAccountNumber"));return}const x={accountNumber:w.accountNumber,name:w.name,type:w.type,accountType:w.accountType,category:w.category,description:w.description,isActive:w.isActive==="true"};console.log({data:w,updatedAccount:x});let T=k1(Object.keys(t.account),x,t.account,{accountId:1,id:1});try{qr.updateAccountServer(t.account?.accountId,T.data),t.onClose()}catch(Y){o(Y instanceof Error?Y.message:e("forms.saveError"))}},y=()=>{if(!t.account)return;const f=qr.canDeleteAccount(t.account.id);if(!f.canDelete){o(f.reason||e("forms.deleteError"));return}const w=e("forms.confirmDelete");if(confirm(w))try{qr.deleteAccount(t.account.id),t.onClose()}catch(E){o(E instanceof Error?E.message:e("forms.deleteError"))}},g=(f,w)=>{n(E=>{const x={...E,[f]:w};return f==="type"&&(x.category=""),x}),i()&&o(null)};return t.account?I(si,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.editAccount")},get children(){var f=MI(),w=f.firstChild;return f.addEventListener("submit",u),a(f,I(Mr,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:E=>g("accountNumber",E),get placeholder(){return e("accounts.accountNumber")},required:!0}),w),a(f,I(Mr,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:E=>g("name",E),get placeholder(){return e("accounts.accountName")},required:!0}),w),a(f,I(Hn,{get label(){return e("accounts.accountType")},get value(){return r().accountType},onChange:E=>g("accountType",E),options:s,required:!0}),w),a(f,I(Hn,{get label(){return e("accounts.category")},get value(){return r().category},onChange:E=>g("category",E),get options(){return l()},required:!0}),w),a(f,I(Mr,{get label(){return e("common.description")},get value(){return r().description},onChange:E=>g("description",E),get placeholder(){return e("common.description")}}),w),a(f,I(Hn,{get label(){return e("common.status")},get value(){return r().isActive},onChange:E=>g("isActive",E),options:c,required:!0}),w),a(f,(()=>{var E=Te(()=>!!i());return()=>E()&&(()=>{var x=FI();return x.style.setProperty("padding","1rem"),x.style.setProperty("border-radius","var(--border-radius-sm)"),x.style.setProperty("margin-top","1rem"),x.style.setProperty("background","#f8d7da"),x.style.setProperty("color","#721c24"),x.style.setProperty("border","1px solid #f5c6cb"),a(x,i),x})()})(),w),p(w,d),a(w,I(_t,{variant:"outline",type:"button",onClick:y,style:{color:"#dc3545","border-color":"#dc3545","margin-right":"auto"},get children(){return e("accounts.deleteAccount")}}),null),a(w,I(_t,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(w,I(_t,{variant:"primary",type:"submit",get children(){return e("common.save")}}),null),f}}):null};var BI=ae("<div><div></div><div></div><div></div><div>"),Uu=ae("<div>"),jI=ae("<div><div></div><div>"),VI=ae("<div><button></button><button> (<!>)"),qI=ae("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),zI=ae("<div><div><div></div><div>  </div></div><div>");const UI=t=>{const{t:e}=_r(),[r,n]=we("details"),[i,o]=we(!1),s=Ut(()=>t.account?qr.getAccountById(t.account.id)||t.account:null),l={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},c={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},d={"font-weight":"600",color:"var(--text-primary)"},u={"text-align":"center","margin-bottom":"2rem"},y={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},g={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},f={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem"},w={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},E=D=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:D?"var(--primary-color)":"var(--text-muted)","border-bottom":D?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),x={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},T={flex:"1"},Y={"font-size":"0.875rem",color:"var(--text-muted)"},K={"font-weight":"500","margin-bottom":"0.25rem"},j=D=>({"font-weight":"600",color:D==="debit"?"#4caf50":"#f44336"}),q={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},J=D=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[D]||{bg:"#f5f5f5",color:"#666"},C=D=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(D),P=D=>new Date(D).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),$=D=>{qr.deleteAccount(s()?.accountId),t.onClose()};return I(si,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.accountDetails")},get children(){return[Te(()=>Te(()=>!s())()?(()=>{var D=BI(),b=D.firstChild,S=b.nextSibling,v=S.nextSibling,z=v.nextSibling;return D.style.setProperty("text-align","center"),D.style.setProperty("padding","3rem"),D.style.setProperty("color","var(--text-muted)"),b.style.setProperty("font-size","1.5rem"),b.style.setProperty("margin-bottom","1rem"),S.style.setProperty("font-size","1.1rem"),S.style.setProperty("margin-bottom","0.5rem"),a(S,()=>e("common.error")),v.style.setProperty("font-size","0.875rem"),a(v,()=>e("common.noDataFound")),z.style.setProperty("margin-top","2rem"),a(z,I(_t,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),D})():(()=>{const D=Ut(()=>J(s().accountType)),b=Ut(()=>qr.getAccountTransactions(s().id));return[(()=>{var S=jI(),v=S.firstChild,z=v.nextSibling;return p(S,u),p(v,y),a(v,()=>s().name),p(z,g),a(z,()=>C(s().balance||0)),a(S,I(Oe,{get when(){return s().accountType},get children(){var re=Uu();return a(re,()=>e(`accounts.types.${s().accountType?.toLowerCase()}`)),fe(L=>p(re,{...f,background:D().bg,color:D().color},L)),re}}),null),S})(),(()=>{var S=VI(),v=S.firstChild,z=v.nextSibling,re=z.firstChild,L=re.nextSibling;return L.nextSibling,p(S,w),v.$$click=()=>n("details"),a(v,()=>e("accounts.accountDetails")),z.$$click=()=>n("transactions"),a(z,()=>e("accounts.transactions"),re),a(z,()=>b().length,L),fe(O=>{var ne=E(r()==="details"),X=E(r()==="transactions");return O.e=p(v,ne,O.e),O.t=p(z,X,O.t),O},{e:void 0,t:void 0}),S})(),Te(()=>Te(()=>r()==="details")()&&(()=>{var S=qI(),v=S.firstChild,z=v.firstChild,re=z.nextSibling,L=v.nextSibling,O=L.firstChild,ne=O.nextSibling,X=L.nextSibling,W=X.firstChild,se=W.nextSibling,F=X.nextSibling,k=F.firstChild,N=k.nextSibling,A=F.nextSibling,V=A.firstChild,Z=V.nextSibling,H=A.nextSibling,B=H.firstChild,M=B.nextSibling;return a(z,()=>e("accounts.accountNumber")),a(re,()=>s().accountNumber),a(O,()=>e("accounts.category")),a(ne,()=>s().category),a(W,()=>e("common.description")),a(se,()=>s().description),a(k,()=>e("common.status")),a(N,(()=>{var G=Te(()=>!!s().isActive);return()=>G()?e("common.active"):e("common.inactive")})()),a(V,()=>e("accounts.createdDate")),a(Z,()=>P(s().createdDate)),a(B,()=>e("accounts.lastModified")),a(M,()=>P(s().lastModified)),fe(G=>{var Q=l,ie=c,me=d,oe=l,ee=c,de=d,he=l,le=c,ye=d,ve=l,pe=c,ge=d,ke=l,Ne=c,xe=d,$e=l,Ee=c,Me=d;return G.e=p(v,Q,G.e),G.t=p(z,ie,G.t),G.a=p(re,me,G.a),G.o=p(L,oe,G.o),G.i=p(O,ee,G.i),G.n=p(ne,de,G.n),G.s=p(X,he,G.s),G.h=p(W,le,G.h),G.r=p(se,ye,G.r),G.d=p(F,ve,G.d),G.l=p(k,pe,G.l),G.u=p(N,ge,G.u),G.c=p(A,ke,G.c),G.w=p(V,Ne,G.w),G.m=p(Z,xe,G.m),G.f=p(H,$e,G.f),G.y=p(B,Ee,G.y),G.g=p(M,Me,G.g),G},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),S})()),Te(()=>Te(()=>r()==="transactions")()&&(()=>{var S=Uu();return a(S,(()=>{var v=Te(()=>b().length===0);return()=>v()?(()=>{var z=Uu();return z.style.setProperty("text-align","center"),z.style.setProperty("color","var(--text-muted)"),z.style.setProperty("padding","2rem"),a(z,()=>e("common.noDataFound")),z})():b().map(z=>(()=>{var re=zI(),L=re.firstChild,O=L.firstChild,ne=O.nextSibling,X=ne.firstChild,W=L.nextSibling;return p(re,x),p(L,T),p(O,K),a(O,()=>z.description),p(ne,Y),a(ne,()=>P(z.date),X),a(ne,()=>z.reference,null),a(W,()=>z.type==="debit"?"+":"-",null),a(W,()=>C(z.type==="debit"?z.debitAmount:z.creditAmount),null),fe(se=>p(W,j(z.type),se)),re})())})()),S})()),(()=>{var S=Uu();return p(S,q),a(S,I(_t,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),a(S,I(_t,{variant:"primary",onClick:()=>o(!0),get children(){return e("accounts.editAccount")}}),null),a(S,I(Oe,{get when(){return vr.state?.profile?.isAdmin},get children(){return I(_t,{variant:"primary",onClick:$,children:"Remove"})}}),null),S})()]})()),Te(()=>Te(()=>!!s())()&&I(OI,{get isOpen(){return i()},onClose:()=>{o(!1)},get account(){return s()}}))]}})};br(["click"]);const HI="modulepreload",GI=function(t){return"/"+t},E0={},ao=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){let s=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");i=s(r.map(d=>{if(d=GI(d),d in E0)return;E0[d]=!0;const u=d.endsWith(".css"),y=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${y}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":HI,u||(g.as="script"),g.crossOrigin="",g.href=d,c&&g.setAttribute("nonce",c),document.head.appendChild(g),u)return new Promise((f,w)=>{g.addEventListener("load",f),g.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(s){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s}return i.then(s=>{for(const l of s||[])l.status==="rejected"&&o(l.reason);return e().catch(o)})},I0={cashSales:{debit:"1001",credit:"4001"},creditSales:{debit:"1101",credit:"4001"},inventoryPurchase:{debit:"1201",credit:"1001"},costOfGoodsSold:{debit:"5001",credit:"1201"},serviceRevenue:{debit:"1001",credit:"4101"},salesTax:{debit:"1001",credit:"2301"},customsFees:{debit:"1401",credit:"1001"},transportRevenue:{debit:"1001",credit:"4201"}},T0=[{id:"cash-sale-completed",name:"Cash Sale Completed",description:"Creates journal entry when cash sale invoice is completed",triggerEvent:"invoice_completed",isActive:!0,priority:100,conditions:[{field:"paymentMethods.cash",operator:"greaterThan",value:0}],actions:[{type:"create_journal_entry",accountMappings:[{debitAccountId:"1001",creditAccountId:"4001",amountExpression:"paymentMethods.cash",description:"Cash sale - Invoice #{invoice}"}]}]},{id:"credit-sale-completed",name:"Credit Sale Completed",description:"Creates journal entry when credit sale invoice is completed",triggerEvent:"invoice_completed",isActive:!0,priority:90,conditions:[{field:"paymentMethods.zelle",operator:"greaterThan",value:0}],actions:[{type:"create_journal_entry",accountMappings:[{debitAccountId:"1101",creditAccountId:"4001",amountExpression:"paymentMethods.zelle",description:"Credit sale (Zelle) - Invoice #{invoice}"}]}]},{id:"service-revenue-transport",name:"Transport Service Revenue",description:"Records transport service revenue when services are billed",triggerEvent:"service_rendered",isActive:!0,priority:80,conditions:[{field:"services.type",operator:"contains",value:"Transportacin"}],actions:[{type:"create_journal_entry",accountMappings:[{debitAccountId:"1001",creditAccountId:"4201",amountExpression:"services.total",description:"Transport service - Invoice #{invoice}"}]}]},{id:"customs-fees",name:"Customs Fees Collection",description:"Records customs fees collected from customers",triggerEvent:"invoice_completed",isActive:!0,priority:70,conditions:[{field:"arancelesTotal",operator:"greaterThan",value:0}],actions:[{type:"create_journal_entry",accountMappings:[{debitAccountId:"1001",creditAccountId:"1401",amountExpression:"arancelesTotal",description:"Customs fees collection - Invoice #{invoice}"}]}]},{id:"sales-tax-collection",name:"Sales Tax Collection",description:"Records sales tax collected on taxable transactions",triggerEvent:"tax_calculated",isActive:!0,priority:60,conditions:[{field:"taxAmount",operator:"greaterThan",value:0}],actions:[{type:"create_journal_entry",accountMappings:[{debitAccountId:"1001",creditAccountId:"2301",amountExpression:"taxAmount",description:"Sales tax collected - Invoice #{invoice}"}]}]}];class WI{config;setConfig;constructor(){const[e,r]=we({isEnabled:!0,defaultMappings:I0,customRules:T0,accountMappings:[],auditSettings:{logAllTransactions:!0,requireApproval:!1,approvalThreshold:1e3}});this.config=e,this.setConfig=r}get isEnabled(){return this.config().isEnabled}get defaultMappings(){return this.config().defaultMappings}get automationRules(){return this.config().customRules.filter(e=>e.isActive)}get accountMappings(){return this.config().accountMappings.filter(e=>e.isActive)}updateConfig(e){this.setConfig(r=>({...r,...e}))}toggleAutomation(e){this.updateConfig({isEnabled:e})}addAccountMapping(e){const r={...e,id:`mapping_${Date.now()}`,createdAt:new Date,updatedAt:new Date};return this.setConfig(n=>({...n,accountMappings:[...n.accountMappings,r]})),r.id}updateAccountMapping(e,r){this.setConfig(n=>({...n,accountMappings:n.accountMappings.map(i=>i.id===e?{...i,...r,updatedAt:new Date}:i)}))}removeAccountMapping(e){this.setConfig(r=>({...r,accountMappings:r.accountMappings.filter(n=>n.id!==e)}))}addAutomationRule(e){const r={...e,id:`rule_${Date.now()}`};return this.setConfig(n=>({...n,customRules:[...n.customRules,r]})),r.id}updateAutomationRule(e,r){this.setConfig(n=>({...n,customRules:n.customRules.map(i=>i.id===e?{...i,...r}:i)}))}toggleAutomationRule(e,r){this.updateAutomationRule(e,{isActive:r})}removeAutomationRule(e){this.setConfig(r=>({...r,customRules:r.customRules.filter(n=>n.id!==e)}))}getAccountMapping(e){return this.accountMappings.find(r=>r.transactionType===e)||null}getApplicableRules(e,r){return this.automationRules.filter(n=>n.triggerEvent===e).filter(n=>this.evaluateConditions(n.conditions,r)).sort((n,i)=>i.priority-n.priority)}evaluateConditions(e,r){return e.length===0?!0:e.every(n=>{const i=this.getNestedValue(r,n.field);switch(n.operator){case"equals":return i===n.value;case"contains":return String(i).toLowerCase().includes(String(n.value).toLowerCase());case"greaterThan":return Number(i)>Number(n.value);case"lessThan":return Number(i)<Number(n.value);case"in":return Array.isArray(n.value)?n.value.includes(i):!1;default:return!1}})}getNestedValue(e,r){return r.split(".").reduce((n,i)=>n?.[i],e)}resetToDefaults(){this.setConfig({isEnabled:!0,defaultMappings:I0,customRules:T0,accountMappings:[],auditSettings:{logAllTransactions:!0,requireApproval:!1,approvalThreshold:1e3}})}exportConfiguration(){return this.config()}importConfiguration(e){this.setConfig(e)}}const Bn=new WI,[vo,Hu]=we([]),ym=()=>vo()?.map(e=>{const r=vo().find(n=>n.lines.some(i=>i.id===e.id));return r?{id:`eb_${e.id}`,accountId:e.accountId,date:r.date,description:r.description,reference:r.reference,debitAmount:e.debitAmount,creditAmount:e.creditAmount,category:e.accountName,isReconciled:e.reconciled||!1,reconciledWith:e.reconciledWith,createdAt:r.createdAt}:null}).filter(e=>e!==null),En={get journalEntries(){return vo()},async addJournalEntry(t){const e={...t,createdTimeStamp:new Date(t.createdAt).getTime(),id:Nl()};return await pm.create(e),Hu([...vo(),e]),e},async updateJournalEntry(t,e){await pm.update(t,e),Hu(vo().map(r=>r.id===t?{...r,...e}:r))},deleteJournalEntry(t){const e=vo().find(r=>r.id===t);if(e&&e.status==="posted")throw new Error("Cannot delete posted journal entries. Void them instead.");Hu(vo().filter(r=>r.id!==t))},voidJournalEntry(t){this.updateJournalEntry(t,{status:"void"})},postJournalEntry(t){const e=vo().find(r=>r.id===t);if(!e)throw new Error("Journal entry not found");if(Math.abs(e.totalDebit-e.totalCredit)>.01)throw new Error("Journal entry is not balanced. Debits must equal credits.");this.updateJournalEntry(t,{status:"posted",postedAt:new Date().toISOString()}),ym()},getJournalEntryById(t){return vo().find(e=>e.id===t)},getJournalEntriesByStatus(t){return vo().filter(e=>e.status===t)},getJournalEntriesByDateRange(t,e){return vo().filter(r=>r.date>=t&&r.date<=e)},getJournalEntriesByAccount(t){return vo().filter(e=>e.lines.some(r=>r.accountId===t))},getNextEntryNumber(){const t=new Date().getFullYear(),r=vo().filter(n=>n.entryNumber.includes(t.toString())).reduce((n,i)=>{const o=parseInt(i.entryNumber.split("-").pop()||"0");return o>n?o:n},0);return`JE-${t}-${String(r+1).padStart(3,"0")}`},validateJournalEntry(t){const e=[];if(t.date||e.push("Date is required"),t.description||e.push("Description is required"),(!t.lines||t.lines.length===0)&&e.push("At least one line item is required"),t.lines){const r=t.lines.reduce((i,o)=>i+(o.debitAmount||0),0),n=t.lines.reduce((i,o)=>i+(o.creditAmount||0),0);Math.abs(r-n)>.01&&e.push(`Entry is not balanced. Debit: ${r}, Credit: ${n}`),t.lines.forEach((i,o)=>{i.accountId||e.push(`Line ${o+1}: Account is required`),i.debitAmount===0&&i.creditAmount===0&&e.push(`Line ${o+1}: Either debit or credit amount must be provided`),i.debitAmount>0&&i.creditAmount>0&&e.push(`Line ${o+1}: Cannot have both debit and credit amounts`)})}return{isValid:e.length===0,errors:e}},async refreshData(t){return this.fetchInvoices(t)},async fetchInvoices(t){try{let e="";t?.search&&(e+=" "+t.search),t?.status&&t.status!=="all"&&(e+=" "+t.status);const r=e.toString(),n=await pm.getAll(r,t);return Hu(Object.values(n)),setTimeout(()=>{ym()},450),[]}catch(e){throw e instanceof Error&&e.message,console.error("Error fetching invoices:",e),e}finally{}},getBankRelatedEntries(){return ym()}};class YI{auditLog=[];async processEvent(e,r){if(!Bn.isEnabled)return;const n=new Date;let i=[],o=[],s=!0,l;try{const c=Bn.getApplicableRules(e,r);for(const d of c)try{const u=await this.executeRule(d,r);i.push(d.name),o.push(...u)}catch(u){console.error(`Error executing rule ${d.name}:`,u),l=u.message,s=!1}}catch(c){console.error("Error processing automation event:",c),l=c.message,s=!1}this.auditLog.push({timestamp:n,event:e,context:r,rulesApplied:i,entriesCreated:o,success:s,error:l}),this.auditLog.length>1e3&&(this.auditLog=this.auditLog.slice(-1e3))}async executeRule(e,r){const n=[];for(const i of e.actions)if(i.type==="create_journal_entry"){const o=await this.createJournalEntry(i,r,e.name);o&&n.push(o)}return n}async createJournalEntry(e,r,n){try{const i=e.accountMappings.map(y=>{const g=this.evaluateAmountExpression(y.amountExpression,r),f=this.expandDescription(y.description,r);return[{accountId:y.debitAccountId,accountName:this.getAccountName(y.debitAccountId),debitAmount:g,creditAmount:0,description:f},{accountId:y.creditAccountId,accountName:this.getAccountName(y.creditAccountId),debitAmount:0,creditAmount:g,description:f}]}).flat(),o=i.reduce((y,g)=>y+g.debitAmount,0),s=i.reduce((y,g)=>y+g.creditAmount,0),l={entryNumber:this.getNextEntryNumber(),date:new Date().toISOString().split("T")[0],description:`Auto: ${n} - ${this.getContextDescription(r)}`,reference:this.getReference(r),status:"draft",createdBy:"automation",createdAt:new Date().toISOString(),totalDebit:o,totalCredit:s,lines:i.map(y=>({...y,id:`line_${Date.now()}_${Math.random()}`}))},c=await En.addJournalEntry(l),d=Bn.exportConfiguration(),u=i.reduce((y,g)=>y+g.debitAmount,0);return(!d.auditSettings.requireApproval||u<=d.auditSettings.approvalThreshold)&&En.postJournalEntry(c),c}catch(i){throw console.error("Error creating journal entry:",i),i}}evaluateAmountExpression(e,r){try{if(!isNaN(Number(e)))return Number(e);const n=this.getNestedValue(r,e);return Number(n)||0}catch(n){return console.error(`Error evaluating amount expression: ${e}`,n),0}}expandDescription(e,r){return e.replace(/\{([^}]+)\}/g,(n,i)=>{const o=this.getNestedValue(r,i);return String(o||n)})}getNestedValue(e,r){return r.split(".").reduce((n,i)=>n?.[i],e)}getAccountName(e){return{1001:"Cash - Operating",1101:"Accounts Receivable",1201:"Inventory - Products",1401:"Customs Fees Receivable",2301:"Sales Tax Payable",4001:"Sales Revenue - Products",4101:"Service Revenue",4201:"Transport Service Revenue",5001:"Cost of Goods Sold"}[e]||`Account ${e}`}getReference(e){return e.invoice?.invoice?`INV-${e.invoice.invoice}`:e.payment?.id?`PAY-${e.payment.id}`:e.inventoryMovement?.id?`INV-MOV-${e.inventoryMovement.id}`:`AUTO-${Date.now()}`}getNextEntryNumber(){return En.getNextEntryNumber()}getContextDescription(e){return e.invoice?`Invoice ${e.invoice.invoice} - ${e.invoice.shipper_consignee?.name}`:e.payment?`Payment ${e.payment.id}`:e.inventoryMovement?`Inventory Movement ${e.inventoryMovement.type}`:"Automated Transaction"}getAuditLog(e=100){return this.auditLog.slice(-e).reverse()}clearAuditLog(){this.auditLog=[]}}const Of=new YI,k0=t=>Of.processEvent("invoice_completed",{invoice:t});var KI=ae('<div><div><h2></h2><div><h3>Basic Information</h3><div><div><label>Rule Name *</label><input type=text placeholder="Enter rule name"></div><div><label>Priority</label><input type=number min=1 max=1000></div></div><div><label>Description *</label><textarea placeholder="Describe what this rule does"></textarea></div><div><div><label>Trigger Event *</label><select></select></div><div><label><input type=checkbox>Active</label></div></div></div><div><div><h3>Conditions</h3><button>Add Condition</button></div></div><div><div><h3>Account Mappings</h3><button>Add Mapping</button></div></div><div><button>Cancel</button><button>'),N0=ae("<option>"),JI=ae('<div><div><div><label>Field</label><input type=text placeholder="e.g., invoice.total, paymentMethods.cash"></div><div><label>Operator</label><select></select></div><div><label>Value</label><input></div><div>'),L0=ae("<button>Remove"),QI=ae('<div><div><div><label>Debit Account</label><select></select></div><div><label>Credit Account</label><select></select></div></div><div><div><label>Amount Expression</label><input type=text placeholder="e.g., invoice.total, paymentMethods.cash"></div><div><label>Description Template</label><input type=text placeholder="e.g., Sale - Invoice #{invoice}"></div><div>'),R0=ae("<option> - ");const XI=t=>{const e=()=>t.rule&&t.rule.id,[r,n]=we({id:t.rule?.id||"",name:t.rule?.name||"",description:t.rule?.description||"",triggerEvent:t.rule?.triggerEvent||"invoice_completed",isActive:t.rule?.isActive??!0,priority:t.rule?.priority||100,conditions:t.rule?.conditions||[{field:"",operator:"greaterThan",value:0}],actions:t.rule?.actions||[{type:"create_journal_entry",accountMappings:[{debitAccountId:"1001",creditAccountId:"4001",amountExpression:"",description:""}]}]}),i=[{id:"1001",name:"Cash - Operating Account"},{id:"1002",name:"Cash - Zelle Account"},{id:"1003",name:"Cash - Credit Card Processing"},{id:"1101",name:"Accounts Receivable - Customers"},{id:"1201",name:"Inventory - Products"},{id:"1401",name:"Customs Fees Receivable"},{id:"2001",name:"Accounts Payable"},{id:"2301",name:"Sales Tax Payable"},{id:"2302",name:"Customs Fees Payable"},{id:"3001",name:"Owner's Equity"},{id:"4001",name:"Sales Revenue - Products"},{id:"4101",name:"Service Revenue - General"},{id:"4201",name:"Transport Service Revenue"},{id:"5001",name:"Cost of Goods Sold - Products"},{id:"5201",name:"Salaries and Wages"},{id:"5301",name:"Utilities Expense"}],o=[{value:"invoice_completed",label:"Invoice Completed"},{value:"payment_received",label:"Payment Received"},{value:"service_rendered",label:"Service Rendered"},{value:"inventory_movement",label:"Inventory Movement"},{value:"tax_calculated",label:"Tax Calculated"}],s=[{value:"equals",label:"Equals"},{value:"contains",label:"Contains"},{value:"greaterThan",label:"Greater Than"},{value:"lessThan",label:"Less Than"},{value:"in",label:"In Array"}],l=(q,J)=>{n(C=>({...C,[q]:J}))},c=()=>{const q=r();n({...q,conditions:[...q.conditions||[],{field:"",operator:"greaterThan",value:0}]})},d=q=>{const J=r();n({...J,conditions:J.conditions?.filter((C,P)=>P!==q)||[]})},u=(q,J,C)=>{const P=r(),$=[...P.conditions||[]];$[q]={...$[q],[J]:C},n({...P,conditions:$})},y=()=>{const q=r(),J=[...q.actions||[]];J[0]&&(J[0]={...J[0],accountMappings:[...J[0].accountMappings||[],{debitAccountId:"1001",creditAccountId:"4001",amountExpression:"",description:""}]}),n({...q,actions:J})},g=q=>{const J=r(),C=[...J.actions||[]];C[0]&&(C[0]={...C[0],accountMappings:C[0].accountMappings?.filter((P,$)=>$!==q)||[]}),n({...J,actions:C})},f=(q,J,C)=>{const P=r(),$=[...P.actions||[]];if($[0]){const D=[...$[0].accountMappings||[]];D[q]={...D[q],[J]:C},$[0]={...$[0],accountMappings:D}}n({...P,actions:$})},w=()=>{const q=r();if(!q.name||!q.description||!q.triggerEvent){alert("Please fill in all required fields");return}const J={id:q.id||`rule_${Date.now()}`,name:q.name,description:q.description,triggerEvent:q.triggerEvent,isActive:q.isActive??!0,priority:q.priority||100,conditions:q.conditions||[],actions:q.actions||[]};t.onSave(J)},E={width:"100%",padding:"0.5rem",border:"1px solid #d1d5db","border-radius":"0.375rem","font-size":"0.875rem"},x={...E,"background-color":"white"},T={padding:"0.5rem 1rem","border-radius":"0.375rem",cursor:"pointer","font-weight":"500",border:"1px solid #d1d5db"},Y={...T,"background-color":"#3b82f6",color:"white",border:"none"},K={...T,"background-color":"white",color:"#374151"},j={...T,"background-color":"#ef4444",color:"white",border:"none"};return(()=>{var q=KI(),J=q.firstChild,C=J.firstChild,P=C.nextSibling,$=P.firstChild,D=$.nextSibling,b=D.firstChild,S=b.firstChild,v=S.nextSibling,z=b.nextSibling,re=z.firstChild,L=re.nextSibling,O=D.nextSibling,ne=O.firstChild,X=ne.nextSibling,W=O.nextSibling,se=W.firstChild,F=se.firstChild,k=F.nextSibling,N=se.nextSibling,A=N.firstChild,V=A.firstChild,Z=P.nextSibling,H=Z.firstChild,B=H.firstChild,M=B.nextSibling,G=Z.nextSibling,Q=G.firstChild,ie=Q.firstChild,me=ie.nextSibling,oe=G.nextSibling,ee=oe.firstChild,de=ee.nextSibling;return q.style.setProperty("position","fixed"),q.style.setProperty("top","0"),q.style.setProperty("left","0"),q.style.setProperty("right","0"),q.style.setProperty("bottom","0"),q.style.setProperty("background-color","rgba(0, 0, 0, 0.5)"),q.style.setProperty("display","flex"),q.style.setProperty("align-items","center"),q.style.setProperty("justify-content","center"),q.style.setProperty("z-index","1000"),J.style.setProperty("background-color","white"),J.style.setProperty("border-radius","0.5rem"),J.style.setProperty("padding","2rem"),J.style.setProperty("max-width","800px"),J.style.setProperty("max-height","90vh"),J.style.setProperty("overflow-y","auto"),J.style.setProperty("width","90%"),C.style.setProperty("font-size","1.5rem"),C.style.setProperty("font-weight","700"),C.style.setProperty("margin-bottom","1.5rem"),a(C,()=>e()?"Edit Automation Rule":"Add New Automation Rule"),P.style.setProperty("margin-bottom","1.5rem"),$.style.setProperty("font-size","1.125rem"),$.style.setProperty("font-weight","600"),$.style.setProperty("margin-bottom","1rem"),D.style.setProperty("display","grid"),D.style.setProperty("grid-template-columns","1fr 1fr"),D.style.setProperty("gap","1rem"),D.style.setProperty("margin-bottom","1rem"),S.style.setProperty("display","block"),S.style.setProperty("font-weight","500"),S.style.setProperty("margin-bottom","0.5rem"),v.$$input=he=>l("name",he.currentTarget.value),re.style.setProperty("display","block"),re.style.setProperty("font-weight","500"),re.style.setProperty("margin-bottom","0.5rem"),L.$$input=he=>l("priority",parseInt(he.currentTarget.value)||100),O.style.setProperty("margin-bottom","1rem"),ne.style.setProperty("display","block"),ne.style.setProperty("font-weight","500"),ne.style.setProperty("margin-bottom","0.5rem"),X.$$input=he=>l("description",he.currentTarget.value),W.style.setProperty("display","grid"),W.style.setProperty("grid-template-columns","1fr auto"),W.style.setProperty("gap","1rem"),W.style.setProperty("align-items","end"),F.style.setProperty("display","block"),F.style.setProperty("font-weight","500"),F.style.setProperty("margin-bottom","0.5rem"),k.addEventListener("change",he=>l("triggerEvent",he.currentTarget.value)),a(k,I(Ct,{each:o,children:he=>(()=>{var le=N0();return a(le,()=>he.label),fe(()=>le.value=he.value),le})()})),A.style.setProperty("display","flex"),A.style.setProperty("align-items","center"),A.style.setProperty("gap","0.5rem"),V.addEventListener("change",he=>l("isActive",he.currentTarget.checked)),Z.style.setProperty("margin-bottom","1.5rem"),H.style.setProperty("display","flex"),H.style.setProperty("justify-content","space-between"),H.style.setProperty("align-items","center"),H.style.setProperty("margin-bottom","1rem"),B.style.setProperty("font-size","1.125rem"),B.style.setProperty("font-weight","600"),M.$$click=c,a(Z,I(Ct,{get each(){return r().conditions||[]},children:(he,le)=>(()=>{var ye=JI(),ve=ye.firstChild,pe=ve.firstChild,ge=pe.firstChild,ke=ge.nextSibling,Ne=pe.nextSibling,xe=Ne.firstChild,$e=xe.nextSibling,Ee=Ne.nextSibling,Me=Ee.firstChild,Ye=Me.nextSibling,ze=Ee.nextSibling;return ye.style.setProperty("border","1px solid #d1d5db"),ye.style.setProperty("border-radius","0.375rem"),ye.style.setProperty("padding","1rem"),ye.style.setProperty("margin-bottom","1rem"),ve.style.setProperty("display","grid"),ve.style.setProperty("grid-template-columns","2fr 1fr 1fr auto"),ve.style.setProperty("gap","1rem"),ve.style.setProperty("align-items","end"),ge.style.setProperty("display","block"),ge.style.setProperty("font-weight","500"),ge.style.setProperty("margin-bottom","0.5rem"),ke.$$input=je=>u(le(),"field",je.currentTarget.value),xe.style.setProperty("display","block"),xe.style.setProperty("font-weight","500"),xe.style.setProperty("margin-bottom","0.5rem"),$e.addEventListener("change",je=>u(le(),"operator",je.currentTarget.value)),a($e,I(Ct,{each:s,children:je=>(()=>{var Xe=N0();return a(Xe,()=>je.label),fe(()=>Xe.value=je.value),Xe})()})),Me.style.setProperty("display","block"),Me.style.setProperty("font-weight","500"),Me.style.setProperty("margin-bottom","0.5rem"),Ye.$$input=je=>u(le(),"value",he.operator==="greaterThan"||he.operator==="lessThan"?parseFloat(je.currentTarget.value)||0:je.currentTarget.value),a(ze,(()=>{var je=Te(()=>(r().conditions?.length||0)>1);return()=>je()&&(()=>{var Xe=L0();return Xe.$$click=()=>d(le()),fe(ht=>p(Xe,j,ht)),Xe})()})()),fe(je=>{var Xe=E,ht=x,ut=he.operator==="greaterThan"||he.operator==="lessThan"?"number":"text",Ue=E;return je.e=p(ke,Xe,je.e),je.t=p($e,ht,je.t),ut!==je.a&&ir(Ye,"type",je.a=ut),je.o=p(Ye,Ue,je.o),je},{e:void 0,t:void 0,a:void 0,o:void 0}),fe(()=>ke.value=he.field),fe(()=>$e.value=he.operator),fe(()=>Ye.value=he.value),ye})()}),null),G.style.setProperty("margin-bottom","2rem"),Q.style.setProperty("display","flex"),Q.style.setProperty("justify-content","space-between"),Q.style.setProperty("align-items","center"),Q.style.setProperty("margin-bottom","1rem"),ie.style.setProperty("font-size","1.125rem"),ie.style.setProperty("font-weight","600"),me.$$click=y,a(G,I(Ct,{get each(){return r().actions?.[0]?.accountMappings||[]},children:(he,le)=>(()=>{var ye=QI(),ve=ye.firstChild,pe=ve.firstChild,ge=pe.firstChild,ke=ge.nextSibling,Ne=pe.nextSibling,xe=Ne.firstChild,$e=xe.nextSibling,Ee=ve.nextSibling,Me=Ee.firstChild,Ye=Me.firstChild,ze=Ye.nextSibling,je=Me.nextSibling,Xe=je.firstChild,ht=Xe.nextSibling,ut=je.nextSibling;return ye.style.setProperty("border","1px solid #d1d5db"),ye.style.setProperty("border-radius","0.375rem"),ye.style.setProperty("padding","1rem"),ye.style.setProperty("margin-bottom","1rem"),ve.style.setProperty("display","grid"),ve.style.setProperty("grid-template-columns","1fr 1fr"),ve.style.setProperty("gap","1rem"),ve.style.setProperty("margin-bottom","1rem"),ge.style.setProperty("display","block"),ge.style.setProperty("font-weight","500"),ge.style.setProperty("margin-bottom","0.5rem"),ke.addEventListener("change",Ue=>f(le(),"debitAccountId",Ue.currentTarget.value)),a(ke,I(Ct,{each:i,children:Ue=>(()=>{var it=R0(),dt=it.firstChild;return a(it,()=>Ue.id,dt),a(it,()=>Ue.name,null),fe(()=>it.value=Ue.id),it})()})),xe.style.setProperty("display","block"),xe.style.setProperty("font-weight","500"),xe.style.setProperty("margin-bottom","0.5rem"),$e.addEventListener("change",Ue=>f(le(),"creditAccountId",Ue.currentTarget.value)),a($e,I(Ct,{each:i,children:Ue=>(()=>{var it=R0(),dt=it.firstChild;return a(it,()=>Ue.id,dt),a(it,()=>Ue.name,null),fe(()=>it.value=Ue.id),it})()})),Ee.style.setProperty("display","grid"),Ee.style.setProperty("grid-template-columns","1fr 2fr auto"),Ee.style.setProperty("gap","1rem"),Ee.style.setProperty("align-items","end"),Ye.style.setProperty("display","block"),Ye.style.setProperty("font-weight","500"),Ye.style.setProperty("margin-bottom","0.5rem"),ze.$$input=Ue=>f(le(),"amountExpression",Ue.currentTarget.value),Xe.style.setProperty("display","block"),Xe.style.setProperty("font-weight","500"),Xe.style.setProperty("margin-bottom","0.5rem"),ht.$$input=Ue=>f(le(),"description",Ue.currentTarget.value),a(ut,(()=>{var Ue=Te(()=>(r().actions?.[0]?.accountMappings?.length||0)>1);return()=>Ue()&&(()=>{var it=L0();return it.$$click=()=>g(le()),fe(dt=>p(it,j,dt)),it})()})()),fe(Ue=>{var it=x,dt=x,Fe=E,Be=E;return Ue.e=p(ke,it,Ue.e),Ue.t=p($e,dt,Ue.t),Ue.a=p(ze,Fe,Ue.a),Ue.o=p(ht,Be,Ue.o),Ue},{e:void 0,t:void 0,a:void 0,o:void 0}),fe(()=>ke.value=he.debitAccountId),fe(()=>$e.value=he.creditAccountId),fe(()=>ze.value=he.amountExpression),fe(()=>ht.value=he.description),ye})()}),null),oe.style.setProperty("display","flex"),oe.style.setProperty("justify-content","flex-end"),oe.style.setProperty("gap","1rem"),Xn(ee,"click",t.onCancel,!0),de.$$click=w,a(de,()=>e()?"Update Rule":"Create Rule"),fe(he=>{var le=E,ye=E,ve={...E,height:"4rem",resize:"vertical"},pe=x,ge=K,ke=K,Ne=K,xe=Y;return he.e=p(v,le,he.e),he.t=p(L,ye,he.t),he.a=p(X,ve,he.a),he.o=p(k,pe,he.o),he.i=p(M,ge,he.i),he.n=p(me,ke,he.n),he.s=p(ee,Ne,he.s),he.h=p(de,xe,he.h),he},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),fe(()=>v.value=r().name||""),fe(()=>L.value=r().priority||100),fe(()=>X.value=r().description||""),fe(()=>k.value=r().triggerEvent||""),fe(()=>V.checked=r().isActive??!0),q})()};br(["input","click"]);var ZI=ae('<div><div><h2></h2><div><div><label>Mapping Name *</label><input type=text placeholder="Enter mapping name"></div><div><label>Description</label><textarea placeholder="Describe when this mapping should be used"></textarea></div><div><label>Transaction Type *</label><select></select></div><div><div><label>Debit Account *</label><select></select></div><div><label>Credit Account *</label><select></select></div></div><div><label><input type=checkbox>Active</label></div></div><div><button>Cancel</button><button>'),eT=ae("<option>"),D0=ae("<option> - ");const tT=t=>{const e=()=>t.mapping&&t.mapping.id,[r,n]=we({id:t.mapping?.id||"",name:t.mapping?.name||"",description:t.mapping?.description||"",transactionType:t.mapping?.transactionType||"cashSale",debitAccountId:t.mapping?.debitAccountId||"1001",creditAccountId:t.mapping?.creditAccountId||"4001",conditions:t.mapping?.conditions||[],isActive:t.mapping?.isActive??!0}),i=[{id:"1001",name:"Cash - Operating Account"},{id:"1002",name:"Cash - Zelle Account"},{id:"1003",name:"Cash - Credit Card Processing"},{id:"1101",name:"Accounts Receivable - Customers"},{id:"1201",name:"Inventory - Products"},{id:"1401",name:"Customs Fees Receivable"},{id:"2001",name:"Accounts Payable"},{id:"2301",name:"Sales Tax Payable"},{id:"2302",name:"Customs Fees Payable"},{id:"3001",name:"Owner's Equity"},{id:"4001",name:"Sales Revenue - Products"},{id:"4101",name:"Service Revenue - General"},{id:"4201",name:"Transport Service Revenue"},{id:"5001",name:"Cost of Goods Sold - Products"},{id:"5201",name:"Salaries and Wages"},{id:"5301",name:"Utilities Expense"}],o=[{value:"cashSale",label:"Cash Sale"},{value:"creditSale",label:"Credit Sale"},{value:"serviceRevenue",label:"Service Revenue"},{value:"transportRevenue",label:"Transport Revenue"},{value:"inventoryPurchase",label:"Inventory Purchase"},{value:"expense",label:"General Expense"},{value:"customsFees",label:"Customs Fees"},{value:"salesTax",label:"Sales Tax"}],s=(f,w)=>{n(E=>({...E,[f]:w}))},l=()=>{const f=r();if(!f.name||!f.transactionType||!f.debitAccountId||!f.creditAccountId){alert("Please fill in all required fields");return}const w={id:f.id||`mapping_${Date.now()}`,name:f.name,description:f.description||"",transactionType:f.transactionType,debitAccountId:f.debitAccountId,creditAccountId:f.creditAccountId,conditions:f.conditions||[],isActive:f.isActive??!0,createdAt:t.mapping?.createdAt||new Date,updatedAt:new Date};t.onSave(w)},c={width:"100%",padding:"0.5rem",border:"1px solid #d1d5db","border-radius":"0.375rem","font-size":"0.875rem"},d={...c,"background-color":"white"},u={padding:"0.5rem 1rem","border-radius":"0.375rem",cursor:"pointer","font-weight":"500",border:"1px solid #d1d5db"},y={...u,"background-color":"#3b82f6",color:"white",border:"none"},g={...u,"background-color":"white",color:"#374151"};return(()=>{var f=ZI(),w=f.firstChild,E=w.firstChild,x=E.nextSibling,T=x.firstChild,Y=T.firstChild,K=Y.nextSibling,j=T.nextSibling,q=j.firstChild,J=q.nextSibling,C=j.nextSibling,P=C.firstChild,$=P.nextSibling,D=C.nextSibling,b=D.firstChild,S=b.firstChild,v=S.nextSibling,z=b.nextSibling,re=z.firstChild,L=re.nextSibling,O=D.nextSibling,ne=O.firstChild,X=ne.firstChild,W=x.nextSibling,se=W.firstChild,F=se.nextSibling;return f.style.setProperty("position","fixed"),f.style.setProperty("top","0"),f.style.setProperty("left","0"),f.style.setProperty("right","0"),f.style.setProperty("bottom","0"),f.style.setProperty("background-color","rgba(0, 0, 0, 0.5)"),f.style.setProperty("display","flex"),f.style.setProperty("align-items","center"),f.style.setProperty("justify-content","center"),f.style.setProperty("z-index","1000"),w.style.setProperty("background-color","white"),w.style.setProperty("border-radius","0.5rem"),w.style.setProperty("padding","2rem"),w.style.setProperty("max-width","600px"),w.style.setProperty("max-height","90vh"),w.style.setProperty("overflow-y","auto"),w.style.setProperty("width","90%"),E.style.setProperty("font-size","1.5rem"),E.style.setProperty("font-weight","700"),E.style.setProperty("margin-bottom","1.5rem"),a(E,()=>e()?"Edit Account Mapping":"Add New Account Mapping"),x.style.setProperty("margin-bottom","1.5rem"),T.style.setProperty("margin-bottom","1rem"),Y.style.setProperty("display","block"),Y.style.setProperty("font-weight","500"),Y.style.setProperty("margin-bottom","0.5rem"),K.$$input=k=>s("name",k.currentTarget.value),j.style.setProperty("margin-bottom","1rem"),q.style.setProperty("display","block"),q.style.setProperty("font-weight","500"),q.style.setProperty("margin-bottom","0.5rem"),J.$$input=k=>s("description",k.currentTarget.value),C.style.setProperty("margin-bottom","1rem"),P.style.setProperty("display","block"),P.style.setProperty("font-weight","500"),P.style.setProperty("margin-bottom","0.5rem"),$.addEventListener("change",k=>s("transactionType",k.currentTarget.value)),a($,I(Ct,{each:o,children:k=>(()=>{var N=eT();return a(N,()=>k.label),fe(()=>N.value=k.value),N})()})),D.style.setProperty("display","grid"),D.style.setProperty("grid-template-columns","1fr 1fr"),D.style.setProperty("gap","1rem"),D.style.setProperty("margin-bottom","1rem"),S.style.setProperty("display","block"),S.style.setProperty("font-weight","500"),S.style.setProperty("margin-bottom","0.5rem"),v.addEventListener("change",k=>s("debitAccountId",k.currentTarget.value)),a(v,I(Ct,{each:i,children:k=>(()=>{var N=D0(),A=N.firstChild;return a(N,()=>k.id,A),a(N,()=>k.name,null),fe(()=>N.value=k.id),N})()})),re.style.setProperty("display","block"),re.style.setProperty("font-weight","500"),re.style.setProperty("margin-bottom","0.5rem"),L.addEventListener("change",k=>s("creditAccountId",k.currentTarget.value)),a(L,I(Ct,{each:i,children:k=>(()=>{var N=D0(),A=N.firstChild;return a(N,()=>k.id,A),a(N,()=>k.name,null),fe(()=>N.value=k.id),N})()})),ne.style.setProperty("display","flex"),ne.style.setProperty("align-items","center"),ne.style.setProperty("gap","0.5rem"),X.addEventListener("change",k=>s("isActive",k.currentTarget.checked)),W.style.setProperty("display","flex"),W.style.setProperty("justify-content","flex-end"),W.style.setProperty("gap","1rem"),Xn(se,"click",t.onCancel,!0),F.$$click=l,a(F,()=>e()?"Update Mapping":"Create Mapping"),fe(k=>{var N=c,A={...c,height:"3rem",resize:"vertical"},V=d,Z=d,H=d,B=g,M=y;return k.e=p(K,N,k.e),k.t=p(J,A,k.t),k.a=p($,V,k.a),k.o=p(v,Z,k.o),k.i=p(L,H,k.i),k.n=p(se,B,k.n),k.s=p(F,M,k.s),k},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),fe(()=>K.value=r().name||""),fe(()=>J.value=r().description||""),fe(()=>$.value=r().transactionType||""),fe(()=>v.value=r().debitAccountId||""),fe(()=>L.value=r().creditAccountId||""),fe(()=>X.checked=r().isActive??!0),f})()};br(["input","click"]);var rT=ae("<div><div><strong>Automation Status:</strong> <span></span></div><div><strong>Active Rules:</strong> </div><div><strong>Account Mappings:</strong> </div><div><strong>Audit Logging:</strong> <span>Enabled"),nT=ae("<div><div><strong>Cash Sales:</strong> Cash  Sales Revenue</div><div><strong>Credit Sales:</strong> A/R  Sales Revenue</div><div><strong>Services:</strong> Cash  Service Revenue</div><div><strong>Transport:</strong> Cash  Transport Revenue</div><div><strong>Sales Tax:</strong> Cash  Tax Payable"),gm=ae("<div>"),iT=ae("<div><div><h3>Active Automation Rules</h3></div><table><thead><tr><th>Rule Name</th><th>Trigger Event</th><th>Priority</th><th>Status</th><th>Actions</th></tr></thead><tbody>"),oT=ae("<div>No custom account mappings configured. The system uses default mappings."),sT=ae("<div><div><h3>Transaction Account Mappings"),aT=ae("<table><thead><tr><th>Timestamp</th><th>Event</th><th>Rules Applied</th><th>Entries Created</th><th>Status</th></tr></thead><tbody>"),lT=ae("<div><div><h3>Recent Automation Activity"),cT=ae("<div><div><h1>Account Automation Configuration</h1><div><label><input type=checkbox>Enable Automation</label></div></div><div><button>Overview</button><button>Automation Rules (<!>)</button><button>Account Mappings (<!>)</button><button>Audit Log"),dT=ae("<div>No recent automation activity"),uT=ae("<div><div> - </div><div> - <!> rules applied"),hT=ae("<tr><td><div><div></div><div></div></div></td><td></td><td></td><td><span></span></td><td><div><button></button><button>Edit</button><button>Delete"),pT=ae("<table><thead><tr><th>Mapping Name</th><th>Transaction Type</th><th>Debit Account</th><th>Credit Account</th><th>Status</th><th>Actions</th></tr></thead><tbody>"),mT=ae("<tr><td><div><div></div><div></div></div></td><td></td><td></td><td></td><td><span></span></td><td><div><button>Edit</button><button>Delete"),fT=ae("<div>No automation activity recorded yet."),yT=ae("<tr><td><div></div></td><td><div></div></td><td><div></div></td><td><div> entries</div></td><td><span>");const gT=t=>{const[e,r]=we("overview"),[n,i]=we(null),[o,s]=we(null),l=j=>new Date(j).toLocaleDateString(),c=()=>{Bn.toggleAutomation(!Bn.isEnabled)},d=(j,q)=>{Bn.toggleAutomationRule(j,q)},u=j=>{confirm("Are you sure you want to delete this automation rule?")&&Bn.removeAutomationRule(j)},y=j=>{confirm("Are you sure you want to delete this account mapping?")&&Bn.removeAccountMapping(j)},g=j=>{j.id&&Bn.automationRules.find(q=>q.id===j.id)?Bn.updateAutomationRule(j.id,j):Bn.addAutomationRule(j),i(null)},f=j=>{j.id&&Bn.accountMappings.find(q=>q.id===j.id)?Bn.updateAccountMapping(j.id,j):Bn.addAccountMapping(j),s(null)},w=()=>{i(null),s(null)},E=()=>Of.getAuditLog(50),x=j=>({padding:"0.75rem 1.5rem",border:"none",background:j?"var(--primary-color)":"transparent",color:j?"white":"var(--text-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer","font-weight":"500",transition:"all 0.2s"}),T={width:"100%","border-collapse":"collapse","margin-top":"1rem"},Y={"text-align":"left",padding:"0.75rem","border-bottom":"2px solid var(--border-color)","font-weight":"600","font-size":"0.875rem"},K={padding:"0.75rem","border-bottom":"1px solid var(--border-color)"};return(()=>{var j=cT(),q=j.firstChild,J=q.firstChild,C=J.nextSibling,P=C.firstChild,$=P.firstChild,D=q.nextSibling,b=D.firstChild,S=b.nextSibling,v=S.firstChild,z=v.nextSibling;z.nextSibling;var re=S.nextSibling,L=re.firstChild,O=L.nextSibling;O.nextSibling;var ne=re.nextSibling;return j.style.setProperty("padding","2rem"),j.style.setProperty("max-width","1200px"),j.style.setProperty("margin","0 auto"),q.style.setProperty("display","flex"),q.style.setProperty("justify-content","space-between"),q.style.setProperty("align-items","center"),q.style.setProperty("margin-bottom","2rem"),J.style.setProperty("font-size","1.75rem"),J.style.setProperty("font-weight","bold"),C.style.setProperty("display","flex"),C.style.setProperty("gap","1rem"),C.style.setProperty("align-items","center"),P.style.setProperty("display","flex"),P.style.setProperty("align-items","center"),P.style.setProperty("gap","0.5rem"),$.addEventListener("change",c),a(C,I(Oe,{get when(){return t.onClose},get children(){return I(_t,{variant:"secondary",get onClick(){return t.onClose},children:"Close"})}}),null),D.style.setProperty("display","flex"),D.style.setProperty("gap","0.5rem"),D.style.setProperty("margin-bottom","2rem"),D.style.setProperty("border-bottom","1px solid var(--border-color)"),D.style.setProperty("padding-bottom","1rem"),b.$$click=()=>r("overview"),S.$$click=()=>r("rules"),a(S,()=>Bn.automationRules.length,z),re.$$click=()=>r("mappings"),a(re,()=>Bn.accountMappings.length,O),ne.$$click=()=>r("audit"),a(j,I(Oe,{get when(){return e()==="overview"},get children(){var X=gm();return X.style.setProperty("display","grid"),X.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(300px, 1fr))"),X.style.setProperty("gap","1.5rem"),a(X,I(Gt,{title:"System Status",get children(){var W=rT(),se=W.firstChild,F=se.firstChild,k=F.nextSibling,N=k.nextSibling,A=se.nextSibling,V=A.firstChild;V.nextSibling;var Z=A.nextSibling,H=Z.firstChild;H.nextSibling;var B=Z.nextSibling,M=B.firstChild,G=M.nextSibling,Q=G.nextSibling;return W.style.setProperty("padding","1rem"),se.style.setProperty("margin-bottom","1rem"),N.style.setProperty("font-weight","600"),a(N,()=>Bn.isEnabled?"Enabled":"Disabled"),A.style.setProperty("margin-bottom","1rem"),a(A,()=>Bn.automationRules.length,null),Z.style.setProperty("margin-bottom","1rem"),a(Z,()=>Bn.accountMappings.length,null),Q.style.setProperty("color","#10b981"),Q.style.setProperty("font-weight","600"),fe(ie=>(ie=Bn.isEnabled?"#10b981":"#ef4444")!=null?N.style.setProperty("color",ie):N.style.removeProperty("color")),W}}),null),a(X,I(Gt,{title:"Default Account Mappings",get children(){var W=nT(),se=W.firstChild,F=se.nextSibling,k=F.nextSibling,N=k.nextSibling;return W.style.setProperty("padding","1rem"),W.style.setProperty("font-size","0.875rem"),se.style.setProperty("margin-bottom","0.5rem"),F.style.setProperty("margin-bottom","0.5rem"),k.style.setProperty("margin-bottom","0.5rem"),N.style.setProperty("margin-bottom","0.5rem"),W}}),null),a(X,I(Gt,{title:"Recent Activity",get children(){var W=gm();return W.style.setProperty("padding","1rem"),a(W,I(Oe,{get when(){return E().length>0},get fallback(){return(()=>{var se=dT();return se.style.setProperty("color","var(--text-secondary)"),se.style.setProperty("font-style","italic"),se})()},get children(){return I(Ct,{get each(){return E().slice(0,5)},children:se=>(()=>{var F=uT(),k=F.firstChild,N=k.firstChild,A=k.nextSibling,V=A.firstChild,Z=V.nextSibling;return Z.nextSibling,F.style.setProperty("margin-bottom","0.75rem"),F.style.setProperty("padding-bottom","0.75rem"),F.style.setProperty("border-bottom","1px solid var(--border-color)"),F.style.setProperty("font-size","0.875rem"),k.style.setProperty("font-weight","600"),a(k,()=>se.event,N),a(k,()=>se.success?"Success":"Failed",null),A.style.setProperty("color","var(--text-secondary)"),a(A,()=>l(se.timestamp),V),a(A,()=>se.rulesApplied.length,Z),fe(H=>(H=se.success?"#10b981":"#ef4444")!=null?k.style.setProperty("color",H):k.style.removeProperty("color")),F})()})}})),W}}),null),X}}),null),a(j,I(Oe,{get when(){return e()==="rules"},get children(){return I(Gt,{title:"Automation Rules",get children(){var X=iT(),W=X.firstChild;W.firstChild;var se=W.nextSibling,F=se.firstChild,k=F.firstChild,N=k.firstChild,A=N.nextSibling,V=A.nextSibling,Z=V.nextSibling,H=Z.nextSibling,B=F.nextSibling;return X.style.setProperty("padding","1rem"),W.style.setProperty("margin-bottom","1rem"),W.style.setProperty("display","flex"),W.style.setProperty("justify-content","space-between"),a(W,I(_t,{variant:"primary",onClick:()=>i({}),children:"Add New Rule"}),null),a(B,I(Ct,{get each(){return Bn.automationRules},children:M=>(()=>{var G=hT(),Q=G.firstChild,ie=Q.firstChild,me=ie.firstChild,oe=me.nextSibling,ee=Q.nextSibling,de=ee.nextSibling,he=de.nextSibling,le=he.firstChild,ye=he.nextSibling,ve=ye.firstChild,pe=ve.firstChild,ge=pe.nextSibling,ke=ge.nextSibling;return me.style.setProperty("font-weight","600"),a(me,()=>M.name),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-secondary)"),a(oe,()=>M.description),a(ee,()=>M.triggerEvent),a(de,()=>M.priority),le.style.setProperty("font-weight","600"),a(le,()=>M.isActive?"Active":"Inactive"),ve.style.setProperty("display","flex"),ve.style.setProperty("gap","0.5rem"),pe.$$click=()=>d(M.id,!M.isActive),pe.style.setProperty("padding","0.25rem 0.5rem"),pe.style.setProperty("font-size","0.75rem"),pe.style.setProperty("border","none"),pe.style.setProperty("border-radius","4px"),pe.style.setProperty("color","white"),pe.style.setProperty("cursor","pointer"),a(pe,()=>M.isActive?"Disable":"Enable"),ge.$$click=()=>i(M),ge.style.setProperty("padding","0.25rem 0.5rem"),ge.style.setProperty("font-size","0.75rem"),ge.style.setProperty("border","1px solid var(--border-color)"),ge.style.setProperty("border-radius","4px"),ge.style.setProperty("background","white"),ge.style.setProperty("cursor","pointer"),ke.$$click=()=>u(M.id),ke.style.setProperty("padding","0.25rem 0.5rem"),ke.style.setProperty("font-size","0.75rem"),ke.style.setProperty("border","none"),ke.style.setProperty("border-radius","4px"),ke.style.setProperty("background","#ef4444"),ke.style.setProperty("color","white"),ke.style.setProperty("cursor","pointer"),fe(Ne=>{var xe=K,$e=K,Ee=K,Me=K,Ye=M.isActive?"#10b981":"#ef4444",ze=K,je=M.isActive?"#ef4444":"#10b981";return Ne.e=p(Q,xe,Ne.e),Ne.t=p(ee,$e,Ne.t),Ne.a=p(de,Ee,Ne.a),Ne.o=p(he,Me,Ne.o),Ye!==Ne.i&&((Ne.i=Ye)!=null?le.style.setProperty("color",Ye):le.style.removeProperty("color")),Ne.n=p(ye,ze,Ne.n),je!==Ne.s&&((Ne.s=je)!=null?pe.style.setProperty("background",je):pe.style.removeProperty("background")),Ne},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),G})()})),fe(M=>{var G=T,Q=Y,ie=Y,me=Y,oe=Y,ee=Y;return M.e=p(se,G,M.e),M.t=p(N,Q,M.t),M.a=p(A,ie,M.a),M.o=p(V,me,M.o),M.i=p(Z,oe,M.i),M.n=p(H,ee,M.n),M},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),X}})}}),null),a(j,I(Oe,{get when(){return e()==="mappings"},get children(){return I(Gt,{title:"Account Mappings",get children(){var X=sT(),W=X.firstChild;return W.firstChild,X.style.setProperty("padding","1rem"),W.style.setProperty("margin-bottom","1rem"),W.style.setProperty("display","flex"),W.style.setProperty("justify-content","space-between"),a(W,I(_t,{variant:"primary",onClick:()=>s({}),children:"Add New Mapping"}),null),a(X,I(Oe,{get when(){return Bn.accountMappings.length===0},get fallback(){return(()=>{var se=pT(),F=se.firstChild,k=F.firstChild,N=k.firstChild,A=N.nextSibling,V=A.nextSibling,Z=V.nextSibling,H=Z.nextSibling,B=H.nextSibling,M=F.nextSibling;return a(M,I(Ct,{get each(){return Bn.accountMappings},children:G=>(()=>{var Q=mT(),ie=Q.firstChild,me=ie.firstChild,oe=me.firstChild,ee=oe.nextSibling,de=ie.nextSibling,he=de.nextSibling,le=he.nextSibling,ye=le.nextSibling,ve=ye.firstChild,pe=ye.nextSibling,ge=pe.firstChild,ke=ge.firstChild,Ne=ke.nextSibling;return oe.style.setProperty("font-weight","600"),a(oe,()=>G.name),ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-secondary)"),a(ee,()=>G.description),a(de,()=>G.transactionType),a(he,()=>G.debitAccountId),a(le,()=>G.creditAccountId),ve.style.setProperty("font-weight","600"),a(ve,()=>G.isActive?"Active":"Inactive"),ge.style.setProperty("display","flex"),ge.style.setProperty("gap","0.5rem"),ke.$$click=()=>s(G),ke.style.setProperty("padding","0.25rem 0.5rem"),ke.style.setProperty("font-size","0.75rem"),ke.style.setProperty("border","1px solid var(--border-color)"),ke.style.setProperty("border-radius","4px"),ke.style.setProperty("background","white"),ke.style.setProperty("cursor","pointer"),Ne.$$click=()=>y(G.id),Ne.style.setProperty("padding","0.25rem 0.5rem"),Ne.style.setProperty("font-size","0.75rem"),Ne.style.setProperty("border","none"),Ne.style.setProperty("border-radius","4px"),Ne.style.setProperty("background","#ef4444"),Ne.style.setProperty("color","white"),Ne.style.setProperty("cursor","pointer"),fe(xe=>{var $e=K,Ee=K,Me=K,Ye=K,ze=K,je=G.isActive?"#10b981":"#ef4444",Xe=K;return xe.e=p(ie,$e,xe.e),xe.t=p(de,Ee,xe.t),xe.a=p(he,Me,xe.a),xe.o=p(le,Ye,xe.o),xe.i=p(ye,ze,xe.i),je!==xe.n&&((xe.n=je)!=null?ve.style.setProperty("color",je):ve.style.removeProperty("color")),xe.s=p(pe,Xe,xe.s),xe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),Q})()})),fe(G=>{var Q=T,ie=Y,me=Y,oe=Y,ee=Y,de=Y,he=Y;return G.e=p(se,Q,G.e),G.t=p(N,ie,G.t),G.a=p(A,me,G.a),G.o=p(V,oe,G.o),G.i=p(Z,ee,G.i),G.n=p(H,de,G.n),G.s=p(B,he,G.s),G},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),se})()},get children(){var se=oT();return se.style.setProperty("text-align","center"),se.style.setProperty("color","var(--text-secondary)"),se.style.setProperty("font-style","italic"),se.style.setProperty("padding","2rem"),se}}),null),X}})}}),null),a(j,I(Oe,{get when(){return e()==="audit"},get children(){return I(Gt,{title:"Automation Audit Log",get children(){var X=lT(),W=X.firstChild;return W.firstChild,X.style.setProperty("padding","1rem"),W.style.setProperty("margin-bottom","1rem"),W.style.setProperty("display","flex"),W.style.setProperty("justify-content","space-between"),a(W,I(_t,{variant:"outline",onClick:()=>Of.clearAuditLog(),children:"Clear Log"}),null),a(X,I(Oe,{get when(){return E().length>0},get fallback(){return(()=>{var se=fT();return se.style.setProperty("text-align","center"),se.style.setProperty("color","var(--text-secondary)"),se.style.setProperty("font-style","italic"),se.style.setProperty("padding","2rem"),se})()},get children(){var se=aT(),F=se.firstChild,k=F.firstChild,N=k.firstChild,A=N.nextSibling,V=A.nextSibling,Z=V.nextSibling,H=Z.nextSibling,B=F.nextSibling;return a(B,I(Ct,{get each(){return E()},children:M=>(()=>{var G=yT(),Q=G.firstChild,ie=Q.firstChild,me=Q.nextSibling,oe=me.firstChild,ee=me.nextSibling,de=ee.firstChild,he=ee.nextSibling,le=he.firstChild,ye=le.firstChild,ve=he.nextSibling,pe=ve.firstChild;return ie.style.setProperty("font-size","0.875rem"),a(ie,()=>l(M.timestamp)),oe.style.setProperty("font-weight","600"),a(oe,()=>M.event),de.style.setProperty("font-size","0.875rem"),a(de,()=>M.rulesApplied.join(", ")||"None"),le.style.setProperty("font-size","0.875rem"),a(le,()=>M.entriesCreated.length,ye),pe.style.setProperty("font-weight","600"),a(pe,()=>M.success?"Success":"Failed"),a(ve,I(Oe,{get when(){return M.error},get children(){var ge=gm();return ge.style.setProperty("font-size","0.75rem"),ge.style.setProperty("color","#ef4444"),a(ge,()=>M.error),ge}}),null),fe(ge=>{var ke=K,Ne=K,xe=K,$e=K,Ee=K,Me=M.success?"#10b981":"#ef4444";return ge.e=p(Q,ke,ge.e),ge.t=p(me,Ne,ge.t),ge.a=p(ee,xe,ge.a),ge.o=p(he,$e,ge.o),ge.i=p(ve,Ee,ge.i),Me!==ge.n&&((ge.n=Me)!=null?pe.style.setProperty("color",Me):pe.style.removeProperty("color")),ge},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),G})()})),fe(M=>{var G=T,Q=Y,ie=Y,me=Y,oe=Y,ee=Y;return M.e=p(se,G,M.e),M.t=p(N,Q,M.t),M.a=p(A,ie,M.a),M.o=p(V,me,M.o),M.i=p(Z,oe,M.i),M.n=p(H,ee,M.n),M},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),se}}),null),X}})}}),null),a(j,I(Oe,{get when(){return n()},get children(){return I(XI,{get rule(){return n()},onSave:g,onCancel:w})}}),null),a(j,I(Oe,{get when(){return o()},get children(){return I(tT,{get mapping(){return o()},onSave:f,onCancel:w})}}),null),fe(X=>{var W=x(e()==="overview"),se=x(e()==="rules"),F=x(e()==="mappings"),k=x(e()==="audit");return X.e=p(b,W,X.e),X.t=p(S,se,X.t),X.a=p(re,F,X.a),X.o=p(ne,k,X.o),X},{e:void 0,t:void 0,a:void 0,o:void 0}),fe(()=>$.checked=Bn.isEnabled),j})()};br(["click"]);class vT{async createCustomEntry(e){const{type:r,description:n,reference:i,date:o,entries:s,postImmediately:l=!1}=e,c=s.reduce((f,w)=>f+w.amount,0),d=s.reduce((f,w)=>f+w.amount,0),u=s.flatMap(f=>[{id:`line_${Date.now()}_${Math.random()}`,accountId:f.debitAccountId,accountName:this.getAccountName(f.debitAccountId),description:f.description||n,debitAmount:f.amount,creditAmount:0},{id:`line_${Date.now()}_${Math.random()}`,accountId:f.creditAccountId,accountName:this.getAccountName(f.creditAccountId),description:f.description||n,debitAmount:0,creditAmount:f.amount}]),y={entryNumber:En.getNextEntryNumber(),date:o||new Date().toISOString().split("T")[0],description:`${n} (Manual)`,reference:i||`MANUAL-${Date.now()}`,status:"draft",createdBy:"manual-automation",createdAt:new Date().toISOString(),totalDebit:c,totalCredit:d,lines:u},g=await En.addJournalEntry(y);return l&&En.postJournalEntry(g),g}async createQuickTransaction(e){const{transactionType:r,amount:n,description:i,reference:o,customAccounts:s,paymentMethod:l="cash",postImmediately:c=!1}=e;let d,u;if(r==="custom"&&s)d=s.debitAccountId,u=s.creditAccountId;else{const y=this.getAccountsForTransaction(r,l);d=y.debitAccountId,u=y.creditAccountId}return this.createCustomEntry({type:"manual_entry",description:i,reference:o,entries:[{debitAccountId:d,creditAccountId:u,amount:n,description:i}],postImmediately:c})}async createBankTransfer(e){const{fromAccountId:r,toAccountId:n,amount:i,description:o,reference:s,postImmediately:l=!1}=e;return this.createCustomEntry({type:"transfer",description:`Bank Transfer: ${o}`,reference:s||`XFER-${Date.now()}`,entries:[{debitAccountId:n,creditAccountId:r,amount:i,description:o}],postImmediately:l})}async createAdjustment(e){const{accountId:r,adjustmentAccountId:n,amount:i,type:o,description:s,reference:l,postImmediately:c=!1}=e,d=this.isDebitIncreaseAccount(r);let u,y;return o==="increase"&&d||o==="decrease"&&!d?(u=r,y=n):(u=n,y=r),this.createCustomEntry({type:"adjustment",description:`Adjustment: ${s}`,reference:l||`ADJ-${Date.now()}`,entries:[{debitAccountId:u,creditAccountId:y,amount:i,description:s}],postImmediately:c})}async createComplexTransaction(e){const{description:r,reference:n,date:i,entries:o,postImmediately:s=!1}=e,l=o.filter(w=>w.type==="debit"),c=o.filter(w=>w.type==="credit"),d=l.reduce((w,E)=>w+E.amount,0),u=c.reduce((w,E)=>w+E.amount,0);if(Math.abs(d-u)>.01)throw new Error(`Transaction not balanced. Debits: ${d}, Credits: ${u}`);const y=[...l.map(w=>({id:`line_${Date.now()}_${Math.random()}`,accountId:w.accountId,accountName:this.getAccountName(w.accountId),description:w.description||r,debitAmount:w.amount,creditAmount:0})),...c.map(w=>({id:`line_${Date.now()}_${Math.random()}`,accountId:w.accountId,accountName:this.getAccountName(w.accountId),description:w.description||r,debitAmount:0,creditAmount:w.amount}))],g={entryNumber:En.getNextEntryNumber(),date:i||new Date().toISOString().split("T")[0],description:`${r} (Complex)`,reference:n||`COMPLEX-${Date.now()}`,status:"draft",createdBy:"manual-automation",createdAt:new Date().toISOString(),totalDebit:d,totalCredit:u,lines:y},f=await En.addJournalEntry(g);return s&&En.postJournalEntry(f),f}getAccountsForTransaction(e,r){const i={cash_sale:{cash:{debitAccountId:"1001",creditAccountId:"4001"},zelle:{debitAccountId:"1002",creditAccountId:"4001"},credit_card:{debitAccountId:"1003",creditAccountId:"4001"}},credit_sale:{default:{debitAccountId:"1101",creditAccountId:"4001"}},expense_payment:{cash:{debitAccountId:"5201",creditAccountId:"1001"},check:{debitAccountId:"5201",creditAccountId:"1001"}},customer_payment:{cash:{debitAccountId:"1001",creditAccountId:"1101"},zelle:{debitAccountId:"1002",creditAccountId:"1101"},credit_card:{debitAccountId:"1003",creditAccountId:"1101"}}}[e];if(!i)throw new Error(`Unknown transaction type: ${e}`);return i[r]||i.default||i[Object.keys(i)[0]]}isDebitIncreaseAccount(e){const r=e.charAt(0);return r==="1"||r==="5"}getAccountName(e){return{1001:"Cash - Operating Account",1002:"Cash - Zelle Account",1003:"Cash - Credit Card Processing",1101:"Accounts Receivable - Customers",1102:"Accounts Receivable - Freight Charges",1201:"Inventory - Products",1202:"Inventory - Packaging Materials",1301:"Prepaid Expenses",1401:"Customs Fees Receivable",1402:"Transit Insurance Receivable",2001:"Accounts Payable",2002:"Freight Payable",2101:"Accrued Salaries",2102:"Accrued Rent",2301:"Sales Tax Payable",2302:"Customs Fees Payable",2303:"Transit Insurance Payable",3001:"Owner's Equity",3101:"Retained Earnings",4001:"Sales Revenue - Products",4101:"Service Revenue - General",4201:"Transport Service Revenue",4202:"Freight Revenue - Air",4203:"Freight Revenue - Sea",4301:"Processing Revenue - Packaging",4302:"Processing Revenue - Storage",5001:"Cost of Goods Sold - Products",5002:"Cost of Goods Sold - Packaging",5101:"Freight Expense - Air",5102:"Freight Expense - Sea",5103:"Local Transport Expense",5201:"Salaries and Wages",5202:"Rent Expense - Office",5203:"Rent Expense - Warehouse",5301:"Utilities Expense",5302:"Insurance Expense",5303:"Office Supplies",5401:"Professional Fees",5402:"Bank Fees",5403:"Credit Card Processing Fees",5501:"Vehicle Expenses",5502:"Equipment Maintenance",5601:"Depreciation Expense"}[e]||`Account ${e}`}getAvailableAccounts(){return[{id:"1001",name:"Cash - Operating Account",type:"Asset"},{id:"1002",name:"Cash - Zelle Account",type:"Asset"},{id:"1003",name:"Cash - Credit Card Processing",type:"Asset"},{id:"1101",name:"Accounts Receivable - Customers",type:"Asset"},{id:"1102",name:"Accounts Receivable - Freight Charges",type:"Asset"},{id:"1201",name:"Inventory - Products",type:"Asset"},{id:"1202",name:"Inventory - Packaging Materials",type:"Asset"},{id:"1301",name:"Prepaid Expenses",type:"Asset"},{id:"1401",name:"Customs Fees Receivable",type:"Asset"},{id:"1402",name:"Transit Insurance Receivable",type:"Asset"},{id:"2001",name:"Accounts Payable",type:"Liability"},{id:"2002",name:"Freight Payable",type:"Liability"},{id:"2101",name:"Accrued Salaries",type:"Liability"},{id:"2102",name:"Accrued Rent",type:"Liability"},{id:"2301",name:"Sales Tax Payable",type:"Liability"},{id:"2302",name:"Customs Fees Payable",type:"Liability"},{id:"2303",name:"Transit Insurance Payable",type:"Liability"},{id:"3001",name:"Owner's Equity",type:"Equity"},{id:"3101",name:"Retained Earnings",type:"Equity"},{id:"4001",name:"Sales Revenue - Products",type:"Revenue"},{id:"4101",name:"Service Revenue - General",type:"Revenue"},{id:"4201",name:"Transport Service Revenue",type:"Revenue"},{id:"4202",name:"Freight Revenue - Air",type:"Revenue"},{id:"4203",name:"Freight Revenue - Sea",type:"Revenue"},{id:"4301",name:"Processing Revenue - Packaging",type:"Revenue"},{id:"4302",name:"Processing Revenue - Storage",type:"Revenue"},{id:"5001",name:"Cost of Goods Sold - Products",type:"Expense"},{id:"5002",name:"Cost of Goods Sold - Packaging",type:"Expense"},{id:"5101",name:"Freight Expense - Air",type:"Expense"},{id:"5102",name:"Freight Expense - Sea",type:"Expense"},{id:"5103",name:"Local Transport Expense",type:"Expense"},{id:"5201",name:"Salaries and Wages",type:"Expense"},{id:"5202",name:"Rent Expense - Office",type:"Expense"},{id:"5203",name:"Rent Expense - Warehouse",type:"Expense"},{id:"5301",name:"Utilities Expense",type:"Expense"},{id:"5302",name:"Insurance Expense",type:"Expense"},{id:"5303",name:"Office Supplies",type:"Expense"},{id:"5401",name:"Professional Fees",type:"Expense"},{id:"5402",name:"Bank Fees",type:"Expense"},{id:"5403",name:"Credit Card Processing Fees",type:"Expense"},{id:"5501",name:"Vehicle Expenses",type:"Expense"},{id:"5502",name:"Equipment Maintenance",type:"Expense"},{id:"5601",name:"Depreciation Expense",type:"Expense"}]}getTransactionTemplates(){return[{id:"cash_sale",name:"Cash Sale",description:"Record a cash sale transaction",type:"cash_sale"},{id:"zelle_sale",name:"Zelle Sale",description:"Record a sale paid via Zelle",type:"cash_sale"},{id:"credit_sale",name:"Credit Sale",description:"Record a sale on credit (accounts receivable)",type:"credit_sale"},{id:"customer_payment",name:"Customer Payment",description:"Record payment received from customer",type:"customer_payment"},{id:"freight_expense",name:"Freight Expense",description:"Record freight/shipping costs",type:"custom",defaultAccounts:{debitAccountId:"5101",creditAccountId:"1001"}},{id:"salary_payment",name:"Salary Payment",description:"Record salary/wage payments",type:"expense_payment"},{id:"rent_payment",name:"Rent Payment",description:"Record monthly rent payment",type:"custom",defaultAccounts:{debitAccountId:"5202",creditAccountId:"1001"}},{id:"bank_transfer",name:"Bank Transfer",description:"Transfer funds between bank accounts",type:"custom"}]}}const Gu=new vT;var bT=ae('<div><h3>Quick Transactions</h3><div><label>Use Template:</label><select><option value>Select a template...</option></select></div><div><div><label>Transaction Type:</label><select><option value=cash_sale>Cash Sale</option><option value=credit_sale>Credit Sale</option><option value=expense_payment>Expense Payment</option><option value=customer_payment>Customer Payment</option><option value=custom>Custom</option></select></div><div><label>Payment Method:</label><select><option value=cash>Cash</option><option value=zelle>Zelle</option><option value=credit_card>Credit Card</option><option value=check>Check</option></select></div></div><div><label>Amount:</label><input type=number step=0.01></div><div><label>Description:</label><input type=text placeholder="Enter transaction description"></div><div><label>Reference (Optional):</label><input type=text placeholder="Invoice number, receipt, etc."></div><div><label><input type=checkbox>Post immediately (skip draft status)</label></div><button>'),_T=ae('<div><h3>Custom Journal Entries</h3><div><div><label>Entry Type:</label><select><option value=manual_entry>Manual Entry</option><option value=transfer>Transfer</option><option value=adjustment>Adjustment</option><option value=payment>Payment</option><option value=receipt>Receipt</option></select></div><div><label>Date:</label><input type=date></div></div><div><label>Description:</label><input type=text placeholder="Enter entry description"></div><div><label>Reference (Optional):</label><input type=text placeholder="Reference number or code"></div><div><div><h4>Entry Lines:</h4><button>Add Line</button></div></div><div><label><input type=checkbox>Post immediately (skip draft status)</label></div><button>'),PT=ae("<div><div><h2>Custom Automation Panel</h2><p>Create manual journal entries with custom parameters on-demand.</p><div><button>Quick Transactions</button><button>Custom Entries"),M0=ae("<div>"),ST=ae("<option>"),wT=ae('<div><div><div><label>Debit Account:</label><select></select></div><div><label>Credit Account:</label><select></select></div></div><div><div><label>Amount:</label><input type=number step=0.01></div><div><label>Line Description (Optional):</label><input type=text placeholder="Specific line description"></div><div>'),F0=ae("<option> - "),xT=ae("<button>Remove");const CT=()=>{const[t,e]=we("quick"),[r,n]=we(!1),[i,o]=we(""),[s,l]=we(""),[c,d]=we({transactionType:"cash_sale",amount:0,description:"",reference:"",paymentMethod:"cash",postImmediately:!1}),[u,y]=we({type:"manual_entry",description:"",reference:"",date:new Date().toISOString().split("T")[0],entries:[{debitAccountId:"1001",creditAccountId:"4001",amount:0,description:""}],postImmediately:!1}),g=Ut(()=>Gu.getAvailableAccounts()),f=Ut(()=>Gu.getTransactionTemplates()),w=()=>{o(""),l("")},E=async()=>{n(!0),w();try{const $=await Gu.createQuickTransaction(c());o(`Transaction created successfully! Entry ID: ${$}`),d({transactionType:"cash_sale",amount:0,description:"",reference:"",paymentMethod:"cash",postImmediately:!1})}catch($){l($ instanceof Error?$.message:"Failed to create transaction")}finally{n(!1)}},x=async()=>{n(!0),w();try{const $=await Gu.createCustomEntry(u());o(`Custom entry created successfully! Entry ID: ${$}`),y({type:"manual_entry",description:"",reference:"",date:new Date().toISOString().split("T")[0],entries:[{debitAccountId:"1001",creditAccountId:"4001",amount:0,description:""}],postImmediately:!1})}catch($){l($ instanceof Error?$.message:"Failed to create entry")}finally{n(!1)}},T=$=>{const D=f().find(b=>b.id===$);D&&d(b=>({...b,transactionType:D.type,description:D.description}))},Y=()=>{y($=>({...$,entries:[...$.entries,{debitAccountId:"1001",creditAccountId:"4001",amount:0,description:""}]}))},K=$=>{y(D=>({...D,entries:D.entries.filter((b,S)=>S!==$)}))},j=($,D,b)=>{y(S=>({...S,entries:S.entries.map((v,z)=>z===$?{...v,[D]:b}:v)}))},q=$=>({padding:"0.5rem 1rem",border:"none","background-color":$?"#3b82f6":"#e5e7eb",color:$?"white":"#374151","border-radius":"0.375rem",cursor:"pointer","font-weight":$?"600":"400"}),J={width:"100%",padding:"0.5rem",border:"1px solid #d1d5db","border-radius":"0.375rem","font-size":"0.875rem"},C={...J,"background-color":"white"},P={padding:"0.5rem 1rem","background-color":"#3b82f6",color:"white",border:"none","border-radius":"0.375rem",cursor:"pointer","font-weight":"500","disabled:opacity":"0.5","disabled:cursor":"not-allowed"};return(()=>{var $=PT(),D=$.firstChild,b=D.firstChild,S=b.nextSibling,v=S.nextSibling,z=v.firstChild,re=z.nextSibling;return $.style.setProperty("max-width","800px"),$.style.setProperty("margin","0 auto"),$.style.setProperty("padding","1rem"),D.style.setProperty("margin-bottom","2rem"),b.style.setProperty("font-size","1.5rem"),b.style.setProperty("font-weight","700"),b.style.setProperty("margin-bottom","1rem"),S.style.setProperty("color","#6b7280"),S.style.setProperty("margin-bottom","1.5rem"),v.style.setProperty("display","flex"),v.style.setProperty("gap","0.5rem"),v.style.setProperty("margin-bottom","2rem"),z.$$click=()=>e("quick"),re.$$click=()=>e("custom"),a(D,(()=>{var L=Te(()=>!!i());return()=>L()&&(()=>{var O=M0();return O.style.setProperty("padding","0.75rem"),O.style.setProperty("background-color","#d1fae5"),O.style.setProperty("color","#047857"),O.style.setProperty("border-radius","0.375rem"),O.style.setProperty("margin-bottom","1rem"),a(O,i),O})()})(),null),a(D,(()=>{var L=Te(()=>!!s());return()=>L()&&(()=>{var O=M0();return O.style.setProperty("padding","0.75rem"),O.style.setProperty("background-color","#fef2f2"),O.style.setProperty("color","#dc2626"),O.style.setProperty("border-radius","0.375rem"),O.style.setProperty("margin-bottom","1rem"),a(O,s),O})()})(),null),a(D,I(Oe,{get when(){return t()==="quick"},get children(){var L=bT(),O=L.firstChild,ne=O.nextSibling,X=ne.firstChild,W=X.nextSibling;W.firstChild;var se=ne.nextSibling,F=se.firstChild,k=F.firstChild,N=k.nextSibling,A=F.nextSibling,V=A.firstChild,Z=V.nextSibling,H=se.nextSibling,B=H.firstChild,M=B.nextSibling,G=H.nextSibling,Q=G.firstChild,ie=Q.nextSibling,me=G.nextSibling,oe=me.firstChild,ee=oe.nextSibling,de=me.nextSibling,he=de.firstChild,le=he.firstChild,ye=de.nextSibling;return O.style.setProperty("font-size","1.25rem"),O.style.setProperty("font-weight","600"),O.style.setProperty("margin-bottom","1rem"),ne.style.setProperty("margin-bottom","1.5rem"),X.style.setProperty("display","block"),X.style.setProperty("font-weight","500"),X.style.setProperty("margin-bottom","0.5rem"),W.addEventListener("change",ve=>T(ve.currentTarget.value)),a(W,I(Ct,{get each(){return f()},children:ve=>(()=>{var pe=ST();return a(pe,()=>ve.name),fe(()=>pe.value=ve.id),pe})()}),null),se.style.setProperty("display","grid"),se.style.setProperty("grid-template-columns","1fr 1fr"),se.style.setProperty("gap","1rem"),se.style.setProperty("margin-bottom","1rem"),k.style.setProperty("display","block"),k.style.setProperty("font-weight","500"),k.style.setProperty("margin-bottom","0.5rem"),N.addEventListener("change",ve=>d(pe=>({...pe,transactionType:ve.currentTarget.value}))),V.style.setProperty("display","block"),V.style.setProperty("font-weight","500"),V.style.setProperty("margin-bottom","0.5rem"),Z.addEventListener("change",ve=>d(pe=>({...pe,paymentMethod:ve.currentTarget.value}))),H.style.setProperty("margin-bottom","1rem"),B.style.setProperty("display","block"),B.style.setProperty("font-weight","500"),B.style.setProperty("margin-bottom","0.5rem"),M.$$input=ve=>d(pe=>({...pe,amount:parseFloat(ve.currentTarget.value)||0})),G.style.setProperty("margin-bottom","1rem"),Q.style.setProperty("display","block"),Q.style.setProperty("font-weight","500"),Q.style.setProperty("margin-bottom","0.5rem"),ie.$$input=ve=>d(pe=>({...pe,description:ve.currentTarget.value})),me.style.setProperty("margin-bottom","1rem"),oe.style.setProperty("display","block"),oe.style.setProperty("font-weight","500"),oe.style.setProperty("margin-bottom","0.5rem"),ee.$$input=ve=>d(pe=>({...pe,reference:ve.currentTarget.value})),de.style.setProperty("margin-bottom","1.5rem"),he.style.setProperty("display","flex"),he.style.setProperty("align-items","center"),he.style.setProperty("gap","0.5rem"),le.addEventListener("change",ve=>d(pe=>({...pe,postImmediately:ve.currentTarget.checked}))),ye.$$click=E,a(ye,()=>r()?"Creating...":"Create Quick Transaction"),fe(ve=>{var pe=C,ge=C,ke=C,Ne=J,xe=J,$e=J,Ee=P,Me=r()||!c().description||c().amount<=0;return ve.e=p(W,pe,ve.e),ve.t=p(N,ge,ve.t),ve.a=p(Z,ke,ve.a),ve.o=p(M,Ne,ve.o),ve.i=p(ie,xe,ve.i),ve.n=p(ee,$e,ve.n),ve.s=p(ye,Ee,ve.s),Me!==ve.h&&(ye.disabled=ve.h=Me),ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),fe(()=>N.value=c().transactionType),fe(()=>Z.value=c().paymentMethod),fe(()=>M.value=c().amount),fe(()=>ie.value=c().description),fe(()=>ee.value=c().reference),fe(()=>le.checked=c().postImmediately),L}}),null),a(D,I(Oe,{get when(){return t()==="custom"},get children(){var L=_T(),O=L.firstChild,ne=O.nextSibling,X=ne.firstChild,W=X.firstChild,se=W.nextSibling,F=X.nextSibling,k=F.firstChild,N=k.nextSibling,A=ne.nextSibling,V=A.firstChild,Z=V.nextSibling,H=A.nextSibling,B=H.firstChild,M=B.nextSibling,G=H.nextSibling,Q=G.firstChild,ie=Q.firstChild,me=ie.nextSibling,oe=G.nextSibling,ee=oe.firstChild,de=ee.firstChild,he=oe.nextSibling;return O.style.setProperty("font-size","1.25rem"),O.style.setProperty("font-weight","600"),O.style.setProperty("margin-bottom","1rem"),ne.style.setProperty("display","grid"),ne.style.setProperty("grid-template-columns","1fr 1fr"),ne.style.setProperty("gap","1rem"),ne.style.setProperty("margin-bottom","1rem"),W.style.setProperty("display","block"),W.style.setProperty("font-weight","500"),W.style.setProperty("margin-bottom","0.5rem"),se.addEventListener("change",le=>y(ye=>({...ye,type:le.currentTarget.value}))),k.style.setProperty("display","block"),k.style.setProperty("font-weight","500"),k.style.setProperty("margin-bottom","0.5rem"),N.$$input=le=>y(ye=>({...ye,date:le.currentTarget.value})),A.style.setProperty("margin-bottom","1rem"),V.style.setProperty("display","block"),V.style.setProperty("font-weight","500"),V.style.setProperty("margin-bottom","0.5rem"),Z.$$input=le=>y(ye=>({...ye,description:le.currentTarget.value})),H.style.setProperty("margin-bottom","1.5rem"),B.style.setProperty("display","block"),B.style.setProperty("font-weight","500"),B.style.setProperty("margin-bottom","0.5rem"),M.$$input=le=>y(ye=>({...ye,reference:le.currentTarget.value})),G.style.setProperty("margin-bottom","1.5rem"),Q.style.setProperty("display","flex"),Q.style.setProperty("justify-content","space-between"),Q.style.setProperty("align-items","center"),Q.style.setProperty("margin-bottom","1rem"),ie.style.setProperty("font-size","1rem"),ie.style.setProperty("font-weight","600"),me.$$click=Y,a(G,I(Ct,{get each(){return u().entries},children:(le,ye)=>(()=>{var ve=wT(),pe=ve.firstChild,ge=pe.firstChild,ke=ge.firstChild,Ne=ke.nextSibling,xe=ge.nextSibling,$e=xe.firstChild,Ee=$e.nextSibling,Me=pe.nextSibling,Ye=Me.firstChild,ze=Ye.firstChild,je=ze.nextSibling,Xe=Ye.nextSibling,ht=Xe.firstChild,ut=ht.nextSibling,Ue=Xe.nextSibling;return ve.style.setProperty("border","1px solid #d1d5db"),ve.style.setProperty("border-radius","0.375rem"),ve.style.setProperty("padding","1rem"),ve.style.setProperty("margin-bottom","1rem"),pe.style.setProperty("display","grid"),pe.style.setProperty("grid-template-columns","1fr 1fr"),pe.style.setProperty("gap","1rem"),pe.style.setProperty("margin-bottom","1rem"),ke.style.setProperty("display","block"),ke.style.setProperty("font-weight","500"),ke.style.setProperty("margin-bottom","0.5rem"),Ne.addEventListener("change",it=>j(ye(),"debitAccountId",it.currentTarget.value)),a(Ne,I(Ct,{get each(){return g()},children:it=>(()=>{var dt=F0(),Fe=dt.firstChild;return a(dt,()=>it.id,Fe),a(dt,()=>it.name,null),fe(()=>dt.value=it.id),dt})()})),$e.style.setProperty("display","block"),$e.style.setProperty("font-weight","500"),$e.style.setProperty("margin-bottom","0.5rem"),Ee.addEventListener("change",it=>j(ye(),"creditAccountId",it.currentTarget.value)),a(Ee,I(Ct,{get each(){return g()},children:it=>(()=>{var dt=F0(),Fe=dt.firstChild;return a(dt,()=>it.id,Fe),a(dt,()=>it.name,null),fe(()=>dt.value=it.id),dt})()})),Me.style.setProperty("display","grid"),Me.style.setProperty("grid-template-columns","1fr 2fr auto"),Me.style.setProperty("gap","1rem"),Me.style.setProperty("align-items","end"),ze.style.setProperty("display","block"),ze.style.setProperty("font-weight","500"),ze.style.setProperty("margin-bottom","0.5rem"),je.$$input=it=>j(ye(),"amount",parseFloat(it.currentTarget.value)||0),ht.style.setProperty("display","block"),ht.style.setProperty("font-weight","500"),ht.style.setProperty("margin-bottom","0.5rem"),ut.$$input=it=>j(ye(),"description",it.currentTarget.value),a(Ue,(()=>{var it=Te(()=>u().entries.length>1);return()=>it()&&(()=>{var dt=xT();return dt.$$click=()=>K(ye()),fe(Fe=>p(dt,{...P,"background-color":"#dc2626"},Fe)),dt})()})()),fe(it=>{var dt=C,Fe=C,Be=J,Re=J;return it.e=p(Ne,dt,it.e),it.t=p(Ee,Fe,it.t),it.a=p(je,Be,it.a),it.o=p(ut,Re,it.o),it},{e:void 0,t:void 0,a:void 0,o:void 0}),fe(()=>Ne.value=le.debitAccountId),fe(()=>Ee.value=le.creditAccountId),fe(()=>je.value=le.amount),fe(()=>ut.value=le.description||""),ve})()}),null),oe.style.setProperty("margin-bottom","1.5rem"),ee.style.setProperty("display","flex"),ee.style.setProperty("align-items","center"),ee.style.setProperty("gap","0.5rem"),de.addEventListener("change",le=>y(ye=>({...ye,postImmediately:le.currentTarget.checked}))),he.$$click=x,a(he,()=>r()?"Creating...":"Create Custom Entry"),fe(le=>{var ye=C,ve=J,pe=J,ge=J,ke={...P,"background-color":"#059669"},Ne=P,xe=r()||!u().description||u().entries.some($e=>$e.amount<=0);return le.e=p(se,ye,le.e),le.t=p(N,ve,le.t),le.a=p(Z,pe,le.a),le.o=p(M,ge,le.o),le.i=p(me,ke,le.i),le.n=p(he,Ne,le.n),xe!==le.s&&(he.disabled=le.s=xe),le},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),fe(()=>se.value=u().type),fe(()=>N.value=u().date),fe(()=>Z.value=u().description),fe(()=>M.value=u().reference),fe(()=>de.checked=u().postImmediately),L}}),null),fe(L=>{var O=q(t()==="quick"),ne=q(t()==="custom");return L.e=p(z,O,L.e),L.t=p(re,ne,L.t),L},{e:void 0,t:void 0}),$})()};br(["click","input"]);var O0=ae("<div><button> Back to Menu"),AT=ae("<div><h2>Account Automation Menu</h2><p>Choose how you want to manage journal entries and account automation.</p><div><button><div><h3> Manual Custom Automation</h3><p>Create journal entries on-demand with custom parameters. Perfect for one-off transactions, adjustments, and when you need full control over the entries.</p><div><span>Recommended for custom transactions</span></div></div></button><button><div><h3> Automatic Automation Configuration</h3><p>Configure rules that automatically create journal entries when certain events occur (like completing invoices, receiving payments, etc.).</p><div><span>Set up once, works automatically</span></div></div></button><div><h4> Quick Guide:</h4><ul><li><strong>Manual Custom Automation:</strong> Use when you need to create specific entries with custom parameters</li><li><strong>Automatic Configuration:</strong> Use to set up rules that trigger automatically during business operations</li><li>Both systems work together - you can use automatic rules for common transactions and manual entries for exceptions");const u_=()=>{const[t,e]=we("menu"),r={display:"block",width:"100%",padding:"1rem","margin-bottom":"0.5rem","background-color":"#f9fafb",border:"1px solid #d1d5db","border-radius":"0.5rem","text-align":"left",cursor:"pointer","text-decoration":"none",color:"#374151",transition:"all 0.2s ease-in-out"},n={padding:"0.5rem 1rem","background-color":"#6b7280",color:"white",border:"none","border-radius":"0.375rem",cursor:"pointer","font-weight":"500","margin-bottom":"1rem"};return[I(Oe,{get when(){return t()==="custom"},get children(){var i=O0(),o=i.firstChild;return i.style.setProperty("max-width","1200px"),i.style.setProperty("margin","0 auto"),i.style.setProperty("padding","2rem"),o.$$click=()=>e("menu"),a(i,I(CT,{}),null),fe(s=>p(o,n,s)),i}}),I(Oe,{get when(){return t()==="config"},get children(){var i=O0(),o=i.firstChild;return i.style.setProperty("max-width","1200px"),i.style.setProperty("margin","0 auto"),i.style.setProperty("padding","2rem"),o.$$click=()=>e("menu"),a(i,I(gT,{}),null),fe(s=>p(o,n,s)),i}}),I(Oe,{get when(){return t()==="menu"},get children(){var i=AT(),o=i.firstChild,s=o.nextSibling,l=s.nextSibling,c=l.firstChild,d=c.firstChild,u=d.firstChild,y=u.nextSibling,g=y.nextSibling,f=g.firstChild,w=c.nextSibling,E=w.firstChild,x=E.firstChild,T=x.nextSibling,Y=T.nextSibling,K=Y.firstChild,j=w.nextSibling,q=j.firstChild,J=q.nextSibling;return i.style.setProperty("max-width","600px"),i.style.setProperty("margin","0 auto"),i.style.setProperty("padding","2rem"),o.style.setProperty("font-size","1.5rem"),o.style.setProperty("font-weight","700"),o.style.setProperty("margin-bottom","1rem"),s.style.setProperty("color","#6b7280"),s.style.setProperty("margin-bottom","2rem"),c.$$mouseout=C=>{C.currentTarget.style.backgroundColor="#f9fafb",C.currentTarget.style.borderColor="#d1d5db"},c.$$mouseover=C=>{C.currentTarget.style.backgroundColor="#f3f4f6",C.currentTarget.style.borderColor="#9ca3af"},c.$$click=()=>e("custom"),u.style.setProperty("font-size","1.125rem"),u.style.setProperty("font-weight","600"),u.style.setProperty("margin-bottom","0.5rem"),y.style.setProperty("color","#6b7280"),y.style.setProperty("font-size","0.875rem"),g.style.setProperty("margin-top","0.75rem"),f.style.setProperty("background-color","#dbeafe"),f.style.setProperty("color","#1e40af"),f.style.setProperty("padding","0.25rem 0.5rem"),f.style.setProperty("border-radius","0.25rem"),f.style.setProperty("font-size","0.75rem"),f.style.setProperty("font-weight","500"),w.$$mouseout=C=>{C.currentTarget.style.backgroundColor="#f9fafb",C.currentTarget.style.borderColor="#d1d5db"},w.$$mouseover=C=>{C.currentTarget.style.backgroundColor="#f3f4f6",C.currentTarget.style.borderColor="#9ca3af"},w.$$click=()=>e("config"),x.style.setProperty("font-size","1.125rem"),x.style.setProperty("font-weight","600"),x.style.setProperty("margin-bottom","0.5rem"),T.style.setProperty("color","#6b7280"),T.style.setProperty("font-size","0.875rem"),Y.style.setProperty("margin-top","0.75rem"),K.style.setProperty("background-color","#ecfdf5"),K.style.setProperty("color","#065f46"),K.style.setProperty("padding","0.25rem 0.5rem"),K.style.setProperty("border-radius","0.25rem"),K.style.setProperty("font-size","0.75rem"),K.style.setProperty("font-weight","500"),j.style.setProperty("margin-top","2rem"),j.style.setProperty("padding","1rem"),j.style.setProperty("background-color","#fef7cd"),j.style.setProperty("border-radius","0.5rem"),j.style.setProperty("border","1px solid #f59e0b"),q.style.setProperty("font-size","1rem"),q.style.setProperty("font-weight","600"),q.style.setProperty("color","#92400e"),q.style.setProperty("margin-bottom","0.5rem"),J.style.setProperty("color","#92400e"),J.style.setProperty("font-size","0.875rem"),J.style.setProperty("line-height","1.5"),J.style.setProperty("margin-left","1rem"),fe(C=>{var P=r,$=r;return C.e=p(c,P,C.e),C.t=p(w,$,C.t),C},{e:void 0,t:void 0}),i}})]};br(["click","mouseover","mouseout"]);var $T=ae("<div><h2></h2><div><span>:</span><button></button><button>"),ET=ae("<div><span>:"),B0=ae("<div>"),IT=ae("<button>");const TT=()=>{const{t}=_r(),[e,r]=we(!1),[n,i]=we(!1),[o,s]=we(!1),[l,c]=we(null),[d,u]=we(null),[y,g]=we("All"),[f,w]=we("hierarchy"),E=$=>{c($),s(!0)},x=$=>{u($),i(!0)},T=()=>y()==="All"?f()==="hierarchy"?qr.getAccountHierarchy():qr.accounts:f()==="hierarchy"?qr.getAccountHierarchy().filter($=>$.accountType===y()):qr.getAccountsByType(y()),Y={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},K={display:"flex",gap:"1rem","margin-bottom":"2rem","align-items":"center"},j=$=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:$?"var(--primary-color)":"var(--surface-color)",color:$?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500",transition:"all 0.2s ease"}),q={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},J={display:"flex",gap:"0.5rem","align-items":"center","margin-left":"auto","margin-right":"1rem"},C=$=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:$?"var(--primary-color)":"var(--surface-color)",color:$?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),P=async()=>{let $=await Id.getAlls("acc");qr.updAccount(Object.values($))};return jn(()=>{P()}),I(Po,{get title(){return t("accounts.title")},get children(){return[I(_I,{}),I(u_,{}),(()=>{var $=$T(),D=$.firstChild,b=D.nextSibling,S=b.firstChild,v=S.firstChild,z=S.nextSibling,re=z.nextSibling;return p($,q),D.style.setProperty("margin","0"),D.style.setProperty("font-size","1.5rem"),a(D,()=>t("accounts.title")),p(b,J),S.style.setProperty("font-weight","500"),S.style.setProperty("color","var(--text-muted)"),S.style.setProperty("font-size","0.875rem"),a(S,()=>t("common.view"),v),z.$$click=()=>w("hierarchy"),a(z,()=>t("accounts.accountHierarchy")),re.$$click=()=>{w("flat"),Id.getAlls("iDP")},a(re,()=>t("common.all")),a($,I(_t,{variant:"primary",onClick:()=>r(!0),get children(){return t("accounts.addAccount")}}),null),fe(L=>{var O=C(f()==="hierarchy"),ne=C(f()==="flat");return L.e=p(z,O,L.e),L.t=p(re,ne,L.t),L},{e:void 0,t:void 0}),$})(),(()=>{var $=ET(),D=$.firstChild,b=D.firstChild;return p($,K),D.style.setProperty("font-weight","500"),D.style.setProperty("color","var(--text-muted)"),a(D,()=>t("common.filter"),b),a($,()=>[t("common.all"),t("accounts.types.asset"),t("accounts.types.liability"),t("accounts.types.equity"),t("accounts.types.revenue"),t("accounts.types.expense")].map((S,v)=>{const re=["All","Asset","Liability","Equity","Revenue","Expense"][v];return(()=>{var L=IT();return L.$$click=()=>g(re),a(L,S),fe(O=>p(L,j(y()===re),O)),L})()}),null),$})(),(()=>{var $=B0();return a($,(()=>{var D=Te(()=>f()==="hierarchy");return()=>D()?T().map(b=>I(TI,{account:b,onAddSubAccount:x,onViewDetails:E})):T().map(b=>I(wI,{account:b,onViewDetails:E}))})()),fe(D=>p($,f()==="hierarchy"?{display:"flex","flex-direction":"column",gap:"1rem"}:Y,D)),$})(),Te(()=>Te(()=>T().length===0)()&&(()=>{var $=B0();return $.style.setProperty("text-align","center"),$.style.setProperty("color","var(--text-muted)"),$.style.setProperty("padding","3rem"),$.style.setProperty("font-size","1.1rem"),a($,()=>t("common.noDataFound")),$})()),I(NI,{get isOpen(){return e()},onClose:()=>r(!1)}),I(DI,{get isOpen(){return n()},onClose:()=>i(!1),get parentAccount(){return d()}}),I(UI,{get isOpen(){return o()},onClose:()=>s(!1),get account(){return l()}})]}})};br(["click"]);var kT=ae("<div><h2>"),sc=ae("<div>"),NT=ae("<div><div><div></div><h1></h1><div></div></div><div>"),LT=ae("<div><button></button><button> (<!>)"),Wu=ae("<div><span></span><span>"),RT=ae("<p>"),DT=ae("<div><div></div><div>"),MT=ae("<div><div><div></div><div>  </div></div><div>");const FT=()=>{const{t}=_r(),e=OS(),r=ay(),[n,i]=we(null),[o,s]=we("overview");jn(()=>{const v=qr.getAccountById(e.id);v?i(v):r("/accounts")});const l={display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"1rem"},c={display:"flex","align-items":"center",gap:"1rem","margin-bottom":"2rem"},d={"font-size":"1rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},u={"font-size":"2.5rem","font-weight":"700",color:"var(--primary-color)"},y={padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},g={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},f=v=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:v?"var(--primary-color)":"var(--text-muted)","border-bottom":v?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),w={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},E={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},x={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},T={"font-weight":"500",color:"var(--text-muted)"},Y={"font-weight":"600",color:"var(--text-primary)"},K={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},j={flex:"1"},q={"font-weight":"500","margin-bottom":"0.25rem"},J={"font-size":"0.875rem",color:"var(--text-muted)"},C=v=>({"font-weight":"600",color:v==="debit"?"#4caf50":"#f44336"});if(!n())return I(Po,{get title(){return t("accounts.accountDetails")},get children(){var v=kT(),z=v.firstChild;return v.style.setProperty("text-align","center"),v.style.setProperty("padding","3rem"),a(z,()=>t("common.error")),a(v,I(_t,{variant:"primary",onClick:()=>r("/accounts"),get children(){return[Te(()=>t("common.back"))," ",Te(()=>t("navigation.accounts"))]}}),null),v}});const P=v=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[v]||{bg:"#f5f5f5",color:"#666"},$=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(v),D=v=>new Date(v).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),b=P(n().accountType),S=qr.getAccountTransactions(n().id);return I(Po,{get title(){return n().name},get children(){return[(()=>{var v=sc();return p(v,l),a(v,I(_t,{variant:"secondary",onClick:()=>r("/accounts"),get children(){return[" ",Te(()=>t("common.back"))," ",Te(()=>t("navigation.accounts"))]}})),v})(),(()=>{var v=NT(),z=v.firstChild,re=z.firstChild,L=re.nextSibling,O=L.nextSibling,ne=z.nextSibling;return p(v,c),p(re,d),a(re,()=>n().accountNumber),L.style.setProperty("margin","0.5rem 0"),L.style.setProperty("font-size","2rem"),a(L,()=>n().name),p(O,u),a(O,()=>$(n().balance)),a(ne,()=>n().accountType),fe(X=>p(ne,{...y,background:b.bg,color:b.color},X)),v})(),(()=>{var v=LT(),z=v.firstChild,re=z.nextSibling,L=re.firstChild,O=L.nextSibling;return O.nextSibling,p(v,g),z.$$click=()=>s("overview"),a(z,()=>t("dashboard.overview")),re.$$click=()=>s("transactions"),a(re,()=>t("accounts.transactions"),L),a(re,()=>S.length,O),fe(ne=>{var X=f(o()==="overview"),W=f(o()==="transactions");return ne.e=p(z,X,ne.e),ne.t=p(re,W,ne.t),ne},{e:void 0,t:void 0}),v})(),Te(()=>Te(()=>o()==="overview")()&&(()=>{var v=DT(),z=v.firstChild,re=z.nextSibling;return p(z,w),a(z,I(Gt,{get title(){return t("accounts.balance")},get subtitle(){return t("dashboard.overview")},get children(){var L=sc();return L.style.setProperty("font-size","1.5rem"),L.style.setProperty("font-weight","600"),L.style.setProperty("color","var(--primary-color)"),a(L,()=>$(n().balance)),L}}),null),a(z,I(Gt,{get title(){return t("accounts.accountType")},get subtitle(){return t("accounts.category")},get children(){var L=sc();return L.style.setProperty("font-size","1.5rem"),L.style.setProperty("font-weight","600"),L.style.setProperty("color","var(--primary-color)"),a(L,()=>t(`accounts.types.${n().accountType?.toLowerCase()}`)),L}}),null),a(z,I(Gt,{get title(){return t("common.status")},get subtitle(){return t("accounts.accountDetails")},get children(){var L=sc();return L.style.setProperty("font-size","1.5rem"),L.style.setProperty("font-weight","600"),a(L,(()=>{var O=Te(()=>!!n().isActive);return()=>O()?t("common.active"):t("common.inactive")})()),fe(O=>(O=n().isActive?"#4caf50":"#f44336")!=null?L.style.setProperty("color",O):L.style.removeProperty("color")),L}}),null),a(z,I(Gt,{get title(){return t("accounts.transactions")},get subtitle(){return t("common.total")},get children(){var L=sc();return L.style.setProperty("font-size","1.5rem"),L.style.setProperty("font-weight","600"),L.style.setProperty("color","var(--primary-color)"),a(L,()=>S.length),L}}),null),p(re,E),a(re,I(Gt,{get title(){return t("accounts.accountDetails")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var L=Wu(),O=L.firstChild,ne=O.nextSibling;return a(O,()=>t("accounts.accountNumber")),a(ne,()=>n().accountNumber),fe(X=>{var W=x,se=T,F=Y;return X.e=p(L,W,X.e),X.t=p(O,se,X.t),X.a=p(ne,F,X.a),X},{e:void 0,t:void 0,a:void 0}),L})(),(()=>{var L=Wu(),O=L.firstChild,ne=O.nextSibling;return a(O,()=>t("accounts.category")),a(ne,()=>n().category),fe(X=>{var W=x,se=T,F=Y;return X.e=p(L,W,X.e),X.t=p(O,se,X.t),X.a=p(ne,F,X.a),X},{e:void 0,t:void 0,a:void 0}),L})(),(()=>{var L=Wu(),O=L.firstChild,ne=O.nextSibling;return a(O,()=>t("common.date")),a(ne,()=>D(n().createdDate)),fe(X=>{var W=x,se=T,F=Y;return X.e=p(L,W,X.e),X.t=p(O,se,X.t),X.a=p(ne,F,X.a),X},{e:void 0,t:void 0,a:void 0}),L})(),(()=>{var L=Wu(),O=L.firstChild,ne=O.nextSibling;return a(O,()=>t("common.date")),a(ne,()=>D(n().lastModified)),fe(X=>{var W=x,se=T,F=Y;return X.e=p(L,W,X.e),X.t=p(O,se,X.t),X.a=p(ne,F,X.a),X},{e:void 0,t:void 0,a:void 0}),L})()]}}),null),a(re,I(Gt,{get title(){return t("common.description")},get subtitle(){return t("accounts.accountDetails")},get children(){var L=RT();return L.style.setProperty("margin","0"),L.style.setProperty("color","var(--text-secondary)"),a(L,()=>n().description||t("common.noDataFound")),L}}),null),v})()),Te(()=>Te(()=>o()==="transactions")()&&I(Gt,{get title(){return t("accounts.accountHistory")},get subtitle(){return t("accounts.transactions")},get children(){return Te(()=>S.length===0)()?(()=>{var v=sc();return v.style.setProperty("text-align","center"),v.style.setProperty("color","var(--text-muted)"),v.style.setProperty("padding","2rem"),a(v,()=>t("common.noDataFound")),v})():S.map(v=>(()=>{var z=MT(),re=z.firstChild,L=re.firstChild,O=L.nextSibling,ne=O.firstChild,X=re.nextSibling;return p(z,K),p(re,j),p(L,q),a(L,()=>v.description),p(O,J),a(O,()=>D(v.date),ne),a(O,()=>v.reference,null),a(X,()=>v.type==="debit"?"+":"-",null),a(X,()=>$(v.type==="debit"?v.debitAmount:v.creditAmount),null),fe(W=>p(X,C(v.type),W)),z})())}}))]}})};br(["click"]);var OT=ae("<div><div><h1></h1><p> </p></div><div><input type=date>"),Fs=ae("<div><span></span><span>"),BT=ae("<div><div></div><div>"),jT=ae("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),VT=ae("<div><div> (<!> = <!> + <!>)</div><div> = "),qT=ae("<span>(<!>: <!>)");const zT=()=>{const{t}=_r(),[e,r]=we(new Date().toISOString().split("T")[0]),[n,i]=we(0),[o,s]=we(0),[l,c]=we(0);jn(()=>{d()});const d=()=>{const w=qr.getAccountsByType("Asset"),E=qr.getAccountsByType("Liability"),x=qr.getAccountsByType("Equity"),T=w.reduce((j,q)=>j+q.balance,0),Y=E.reduce((j,q)=>j+q.balance,0),K=x.reduce((j,q)=>j+q.balance,0);i(T),s(Y),c(K)},u=w=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(w),y={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},g={"margin-bottom":"2rem"},f={"font-weight":"bold","font-size":"1.1rem","border-top":"2px solid var(--border-color)","padding-top":"0.5rem","margin-top":"1rem"};return I(Po,{get title(){return t("balanceSheet.title")},get children(){return[(()=>{var w=OT(),E=w.firstChild,x=E.firstChild,T=x.nextSibling,Y=T.firstChild,K=E.nextSibling,j=K.firstChild;return p(w,y),x.style.setProperty("margin","0"),a(x,()=>t("balanceSheet.title")),T.style.setProperty("margin","0.5rem 0 0 0"),T.style.setProperty("color","var(--text-muted)"),a(T,()=>t("balanceSheet.asOf"),Y),a(T,()=>new Date(e()).toLocaleDateString(),null),K.style.setProperty("display","flex"),K.style.setProperty("gap","1rem"),j.addEventListener("change",q=>r(q.target.value)),j.style.setProperty("padding","0.5rem"),j.style.setProperty("border","1px solid var(--border-color)"),j.style.setProperty("border-radius","var(--border-radius-sm)"),a(K,I(_t,{variant:"primary",onClick:d,get children(){return t("balanceSheet.generateReport")}}),null),fe(()=>j.value=e()),w})(),(()=>{var w=BT(),E=w.firstChild,x=E.nextSibling;return w.style.setProperty("display","grid"),w.style.setProperty("grid-template-columns","1fr 1fr"),w.style.setProperty("gap","2rem"),a(E,I(Gt,{get title(){return t("balanceSheet.assets")},style:g,get children(){return[(()=>{var T=Fs(),Y=T.firstChild,K=Y.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),a(Y,()=>t("balanceSheet.currentAssets")),a(K,()=>u(n()*.6)),T})(),(()=>{var T=Fs(),Y=T.firstChild,K=Y.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),a(Y,()=>t("balanceSheet.nonCurrentAssets")),a(K,()=>u(n()*.4)),T})(),(()=>{var T=Fs(),Y=T.firstChild,K=Y.nextSibling;return a(Y,()=>t("balanceSheet.totalAssets")),a(K,()=>u(n())),fe(j=>p(T,{...f,display:"flex","justify-content":"space-between"},j)),T})()]}})),a(x,I(Gt,{get title(){return t("balanceSheet.liabilities")},style:g,get children(){return[(()=>{var T=Fs(),Y=T.firstChild,K=Y.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),a(Y,()=>t("balanceSheet.currentLiabilities")),a(K,()=>u(o()*.7)),T})(),(()=>{var T=Fs(),Y=T.firstChild,K=Y.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),a(Y,()=>t("balanceSheet.nonCurrentLiabilities")),a(K,()=>u(o()*.3)),T})(),(()=>{var T=Fs(),Y=T.firstChild,K=Y.nextSibling;return a(Y,()=>t("balanceSheet.totalLiabilities")),a(K,()=>u(o())),fe(j=>p(T,{...f,display:"flex","justify-content":"space-between"},j)),T})()]}}),null),a(x,I(Gt,{get title(){return t("balanceSheet.equity")},get children(){return[(()=>{var T=Fs(),Y=T.firstChild,K=Y.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),a(Y,()=>t("balanceSheet.commonStock")),a(K,()=>u(l()*.8)),T})(),(()=>{var T=Fs(),Y=T.firstChild,K=Y.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),a(Y,()=>t("balanceSheet.retainedEarnings")),a(K,()=>u(l()*.2)),T})(),(()=>{var T=Fs(),Y=T.firstChild,K=Y.nextSibling;return a(Y,()=>t("balanceSheet.totalEquity")),a(K,()=>u(l())),fe(j=>p(T,{...f,display:"flex","justify-content":"space-between"},j)),T})()]}}),null),w})(),I(Gt,{get title(){return t("dashboard.overview")},style:{"margin-top":"2rem"},get children(){return[(()=>{var w=jT(),E=w.firstChild,x=E.firstChild,T=x.nextSibling,Y=E.nextSibling,K=Y.firstChild,j=K.nextSibling,q=Y.nextSibling,J=q.firstChild,C=J.nextSibling;return w.style.setProperty("display","grid"),w.style.setProperty("grid-template-columns","repeat(3, 1fr)"),w.style.setProperty("gap","2rem"),E.style.setProperty("text-align","center"),x.style.setProperty("font-size","0.875rem"),x.style.setProperty("color","var(--text-muted)"),x.style.setProperty("margin-bottom","0.5rem"),a(x,()=>t("balanceSheet.totalAssets")),T.style.setProperty("font-size","1.5rem"),T.style.setProperty("font-weight","bold"),T.style.setProperty("color","var(--primary-color)"),a(T,()=>u(n())),Y.style.setProperty("text-align","center"),K.style.setProperty("font-size","0.875rem"),K.style.setProperty("color","var(--text-muted)"),K.style.setProperty("margin-bottom","0.5rem"),a(K,()=>t("balanceSheet.totalLiabilities")),j.style.setProperty("font-size","1.5rem"),j.style.setProperty("font-weight","bold"),j.style.setProperty("color","#f44336"),a(j,()=>u(o())),q.style.setProperty("text-align","center"),J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-muted)"),J.style.setProperty("margin-bottom","0.5rem"),a(J,()=>t("balanceSheet.totalEquity")),C.style.setProperty("font-size","1.5rem"),C.style.setProperty("font-weight","bold"),C.style.setProperty("color","#4caf50"),a(C,()=>u(l())),w})(),(()=>{var w=VT(),E=w.firstChild,x=E.firstChild,T=x.nextSibling,Y=T.nextSibling,K=Y.nextSibling,j=K.nextSibling,q=j.nextSibling;q.nextSibling;var J=E.nextSibling,C=J.firstChild;return w.style.setProperty("margin-top","2rem"),w.style.setProperty("text-align","center"),E.style.setProperty("font-size","0.875rem"),E.style.setProperty("color","var(--text-muted)"),E.style.setProperty("margin-bottom","0.5rem"),a(E,()=>t("common.total"),x),a(E,()=>t("balanceSheet.totalAssets"),T),a(E,()=>t("balanceSheet.totalLiabilities"),K),a(E,()=>t("balanceSheet.totalEquity"),q),J.style.setProperty("font-size","1.2rem"),J.style.setProperty("font-weight","bold"),a(J,()=>u(n()),C),a(J,()=>u(o()+l()),null),a(J,(()=>{var P=Te(()=>Math.abs(n()-(o()+l()))>.01);return()=>P()&&(()=>{var $=qT(),D=$.firstChild,b=D.nextSibling,S=b.nextSibling,v=S.nextSibling;return v.nextSibling,$.style.setProperty("font-size","0.875rem"),$.style.setProperty("color","#f44336"),$.style.setProperty("display","block"),a($,()=>t("common.error"),b),a($,()=>u(n()-(o()+l())),v),$})()})(),null),fe(P=>(P=Math.abs(n()-(o()+l()))<.01?"#4caf50":"#f44336")!=null?J.style.setProperty("color",P):J.style.removeProperty("color")),w})()]}})]}})};br(["click"]);const UT=[{id:"YY_8802",code:"YY_8802",name:"CENTER",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8803",code:"YY_8803",name:"BISSONNET",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8804",code:"YY_8804",name:"IRVIN",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8805",code:"YY_8805",name:"KATTY",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8816",code:"YY_8816",type:"store",name:"YABA GLOBAL",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8818",code:"YY_8818",type:"store",name:"YABASURAUSTIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8847",code:"YY_8847",type:"store",name:"YABAOFICINA AZ",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_3251",code:"YY_3251",type:"store",name:"YABA FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_32",code:"YY_32",type:"store",name:"YABA MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_76",code:"YY_76",type:"store",name:"YABA DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_2376",code:"YY_2376",type:"store",name:"YABA SAN ANTONIO",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2025-08-14"},{id:"YY_79",code:"YY_79",type:"warehouse",name:"ALMACEN DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8635",code:"YY_8635",type:"store",name:"FASHION MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8665",code:"YY_8665",name:"IRVIN FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,type:"store",createdDate:"2024-01-01"},{id:"YY_8901",code:"YY_8901",name:"ALMACEN CENTRAL YABA",bussinesId:"YB100423253156428",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"SS_42",code:"SS_42",name:"STEPHANIE SOLUTION",bussinesId:"SS695841584167881",type:"store",address:"5520 Fern Valley Rd, Ste 108, Louisville, KY 40228",isActive:!0,createdDate:"2024-01-01"}],HT=[{id:"1",name:'MacBook Pro 16"',price:2399,quantity:75,category:"Electronics",description:"Apple MacBook Pro 16-inch with M2 Pro chip",sku:"MBP-16-M2P",supplier:"Apple Inc.",minStock:10,location:"Warehouse A",lastUpdated:"2024-01-15"},{id:"2",name:'Dell Monitor 27"',price:299,quantity:35,category:"Electronics",description:"Dell 27-inch 4K UHD Monitor",sku:"DELL-MON-27-4K",supplier:"Dell Technologies",minStock:15,location:"Warehouse B",lastUpdated:"2024-01-14"},{id:"3",name:"Wireless Mouse",price:49.99,quantity:12,category:"Accessories",description:"Ergonomic wireless mouse with precision tracking",sku:"MOUSE-WL-001",supplier:"Logitech",minStock:25,location:"Warehouse A",lastUpdated:"2024-01-13"}],Yu=()=>{const t=new Map;return no().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=Pt.getLocationById(e.locationId),i=t.get(r);i||(i={id:r,productId:e.productId,locationId:e.locationId,locationName:n?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,i)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(i.quantity+=e.quantity*1):e.movementType==="out"?i.quantity-=e.quantity*1:e.movementType==="adjustment"&&(i.quantity=e.quantity*1),new Date(e.createdDate)>new Date(i.lastMovementDate)&&(i.lastMovementDate=e.createdDate,i.lastMovementType=e.movementType),i.averageCost=e.unitCost*1,i.availableQuantity=i.quantity*1-i.reservedQuantity*1}),Array.from(t.values())},[ul,vm]=we([]),[Ca,j0]=we(UT),[no,Ku]=we([]),[Aa,ad]=we([]),[Ju,bm]=we(HT),GT={TRANSFER:1,transfer:1},V0=173442384e4,Pt={get products(){return ul()},get locations(){return Ca()},get movements(){return no()},get stockLevels(){return Aa()},parseInventoryData:t=>{const e=Object.keys(t).slice(0,900),r=[],n=i=>{let o=t;o[i]?.products&&o[i]?.products?.map(s=>{let l=cw(o[i]?.type),c=s?.price*1||s?.unitCost*1,d=s?.qty*1||s?.quantity*1;c=isNaN(c)?0:c,d=isNaN(d)?0:d;let u={id:o[i]?.ssg_inventory_key,productId:s?.product?.id,productName:s?.product?.label,productSku:s?.product?.code,locationId:o[i]?.store,locationName:o[i]?.store,location:o[i]?.store,movementType:l,quantity:d,unitCost:c,totalCost:c*1*d,minStock:10,referenceNumber:"PO-001",notes:o[i]?.description||o[i]?.notes,createdBy:"admin",createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(V0).toISOString(),invoiceId:o[i]?.invoice};if(r.push(u),GT[o[i].movementType]&&o[i]?.fromLocationId){let y=Pt.getLocationById(o[i]?.fromLocationId);const g={id:o[i]?.ssg_inventory_key,productId:s?.product?.id,productName:s?.product?.label,productSku:s?.product?.code,locationId:o[i]?.fromLocationId,locationName:y?.name||"",movementType:"out",quantity:d*-1,unitCost:c,totalCost:c*-1*d,minStock:10,referenceNumber:o[i]?.referenceNumber,notes:`Transfer to ${o[i]?.locationName}`+(o[i].notes?` - ${o[i].notes}`:""),createdBy:o[i].createdBy,createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(V0).toISOString(),invoiceId:o[i]?.invoiceId,toLocationId:o[i]?.locationId,toLocationName:o[i]?.locationName};r.push(g)}})};return e.map(n),r},fecthInventory:async t=>{const e=await qi.getInventory(t),r=Pt.parseInventoryData(e);Pt.updMovements(r)},getStockLevels:async t=>{const e=await ig.getStockLevels(t);ad(e)},fecthProduct:async t=>{const e=await qi.getProducts(t),r=Object.keys(e),n=o=>{let s=e;return{id:o,name:s[o].name,businessId:s[o].businessId,sku:s[o].code,UPC:s[o].UPC,numCode:s[o].codeN,category:s[o].category,unitCost:s[o].unitCost||0,unitOfMeasure:s[o].unitOfMeasure||s[o].unit,minStockLevel:s[o].minStockLevel,maxStockLevel:s[o].maxStockLevel,isActive:s[o].isActive,productImageUrl:s[o].productImageUrl,description:s[o].description||"",createdDate:s[o].createdAt||new Date().toISOString(),lastModified:s[o].updatedAt||new Date().toISOString()}},i=r.map(n);return Pt.updProduct(i),i},getProductById:t=>ul().find(e=>e.id===t),updProduct:t=>{vm(t)},getProductsBySku:t=>ul().filter(e=>e.sku.toLowerCase().includes(t.toLowerCase())),getProductsByCategory:t=>ul().filter(e=>e.category===t),getActiveProducts:()=>ul().filter(t=>t.name),getLocationById:t=>Ca().find(e=>e.id===t),getLocationsByType:t=>Ca().filter(e=>e.type===t),getActiveLocations:()=>{if(vr?.state?.profile?.isAdmin)return Ca();let t=vr?.state?.profile?.stores;return Ca().filter(e=>t?.[e?.id])},getMovementsByProduct:t=>no().filter(e=>e.productId===t),updMovements:t=>{Ku([...t]),ad(Yu())},getMovementsByLocation:t=>no()?.filter(e=>e.locationId===t),getMovementsByDateRange:(t,e)=>no()?.filter(r=>r.createdDate>=t&&r.createdDate<=e),getStockByProduct:t=>Aa()?.filter(e=>e.productId===t),getStockByLocation:t=>Aa()?.filter(e=>e.locationId===t),getStockByProductAndLocation:(t,e)=>Aa()?.find(r=>r.productId===t&&r.locationId===e),getTotalStockByProduct:t=>Aa()?.filter(e=>e.productId===t).reduce((e,r)=>e*1+r.quantity*1,0),getLastLocationByProduct:t=>{const e=no()?.filter(r=>r.productId===t).sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime());if(e.length>0)return Ca().find(r=>r.id===e[0].locationId)},getLowStockProducts:()=>(ul()||[])?.map(t=>{const e=Aa()?.filter(r=>r.productId===t.id).reduce((r,n)=>r+n.quantity,0)||0;return{...t,currentStock:e}}).filter(t=>t.currentStock<=t.minStockLevel),generateMovementInvoice:async(t,e,r,n="compact")=>{try{const{getUserLanguage:i}=await ao(async()=>{const{getUserLanguage:u}=await import("./languageUtils-BVmHbHaj.js");return{getUserLanguage:u}},[]),o=r||i();let s;switch(n){case"compact":const{generateCompactModernInvoicePDF:u}=await ao(async()=>{const{generateCompactModernInvoicePDF:f}=await import("./compactModernInvoicePdfGenerator-BHluHwEV.js");return{generateCompactModernInvoicePDF:f}},[]);s=u;break;case"modern":const{generateModernMovementInvoicePDF:y}=await ao(async()=>{const{generateModernMovementInvoicePDF:f}=await import("./modernMovementInvoicePdfGenerator-Ts-i93u8.js");return{generateModernMovementInvoicePDF:f}},[]);s=y;break;case"classic":default:const{generateMovementInvoicePDF:g}=await ao(async()=>{const{generateMovementInvoicePDF:f}=await import("./movementInvoicePdfGenerator-CLBMGZWR.js");return{generateMovementInvoicePDF:f}},[]);s=g;break}const l=no().filter(u=>u.invoiceId===t||u.id===t);if(l.length===0)throw new Error(`No movements found with ID: ${t}`);const c=l.reduce((u,y)=>{const g=y.invoiceId||y.id;return u[g]||(u[g]={invoiceId:g,movementType:y.movementType,referenceNumber:y.referenceNumber,createdBy:y.createdBy,createdDate:y.createdDate,locationName:y.locationName,fromLocationName:y.fromLocationName,toLocationName:y.toLocationName,notes:y.notes,items:[]}),u[g].items.push({productSku:y.productSku,productName:y.productName,quantity:y.quantity,unitCost:y.unitCost,totalCost:y.totalCost,receivedQuantity:y.movementType==="transfer"?null:void 0}),u},{}),d=[];for(const[u,y]of Object.entries(c)){const g=await s(y,e,o);d.push(g)}return d}catch(i){throw console.error("Error generating movement invoice:",i),i}},getMovementsByInvoiceId:t=>no().filter(e=>e.invoiceId===t),generateCompactMovementInvoice:async(t,e,r)=>Pt.generateMovementInvoice(t,e,r,"compact"),generateModernMovementInvoice:async(t,e,r)=>Pt.generateMovementInvoice(t,e,r,"modern"),generateClassicMovementInvoice:async(t,e,r)=>Pt.generateMovementInvoice(t,e,r,"classic"),getMovementInvoiceData:t=>{const e=no().filter(i=>i.invoiceId===t||i.id===t);if(e.length===0)return null;const r=e[0],n=e.reduce((i,o)=>i+(o.totalCost||o.quantity*o.unitCost),0);return{invoiceId:r.invoiceId||r.id,movementType:r.movementType,referenceNumber:r.referenceNumber,createdBy:r.createdBy,createdDate:r.createdDate,locationName:r.locationName,fromLocationName:r.fromLocationName,toLocationName:r.toLocationName,notes:r.notes,totalValue:n,itemCount:e.length,items:e.map(i=>({productSku:i.productSku,productName:i.productName,quantity:i.quantity,unitCost:i.unitCost,totalCost:i.totalCost||i.quantity*i.unitCost}))}},addInventoryMovement:t=>{const e={...t,id:`mov-${Date.now()}`,createdDate:new Date().toISOString()};Ku(r=>[...r,e]),ad(Yu())},addBulkInventoryMovements:async t=>{const e=[],r=[],n=new Date().toISOString(),i=Ca().find(l=>l.id===t.locationId);if(!i)return{success:!1,errors:["Invalid location"]};let o;if(t.movementType==="transfer"){if(!t.fromLocationId)return{success:!1,errors:["From location required for transfers"]};if(o=Ca().find(l=>l.id===t.fromLocationId),!o)return{success:!1,errors:["Invalid from location"]};if(t.fromLocationId===t.locationId)return{success:!1,errors:["From and to locations cannot be the same"]}}if(t.items.forEach((l,c)=>{const d=ul().find(f=>f.id===l.productId);if(!d){e.push(`Item ${c+1}: Product not found`);return}if(l.quantity<=0){e.push(`Item ${c+1}: Quantity must be greater than 0`);return}if(t.movementType==="out"){const f=Aa().filter(w=>w.productId===l.productId&&w.locationId===t.locationId).reduce((w,E)=>w+E.quantity,0);if(l.quantity>f){e.push(`Item ${c+1}: Insufficient stock. Available: ${f}, Requested: ${l.quantity}`);return}}if(t.movementType==="transfer"){const f=Aa().filter(w=>w.productId===l.productId&&w.locationId===t.fromLocationId).reduce((w,E)=>w+E.quantity,0);if(l.quantity>f){e.push(`Item ${c+1}: Insufficient stock at ${o?.name}. Available: ${f}, Requested: ${l.quantity}`);return}}const u=l.unitCost||d.unitCost,y=l.quantity*u,g={id:`mov-${Date.now()}-${c}`,productId:d.id,productName:d.name,productSku:d.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:l.quantity,unitCost:u,totalCost:y,minStock:10,referenceNumber:t.referenceNumber||"",notes:l.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:o?.name};if(r.push(g),t.movementType==="transfer"&&o){const f={id:`mov-${Date.now()}-${c}-out`,productId:d.id,productName:d.name,productSku:d.sku,locationId:t.fromLocationId,locationName:o.name,movementType:"out",quantity:l.quantity,unitCost:u,totalCost:y,minStock:10,referenceNumber:t.referenceNumber||"",notes:`Transfer to ${i.name}`+(l.notes?` - ${l.notes}`:""),createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,toLocationId:t.locationId,toLocationName:i.name};r.push(f)}}),e.length>0)return{success:!1,errors:e};Ku(l=>[...l,...r]),ad(Yu()),console.log({bulkRequest:t});const s=await qi.addInventory(t);return console.log({prodResults:s}),{success:!0,errors:[]}},getMovementsByInvoice:t=>no().filter(e=>e.invoiceId===t),getInvoiceSummary:t=>{const e=no().filter(o=>o.invoiceId===t);if(e.length===0)return null;const r=e.reduce((o,s)=>o+s.totalCost,0),n=new Set(e.map(o=>o.productId)).size,i=e[0];return{invoiceId:t,referenceNumber:i.referenceNumber,movementType:i.movementType,location:i.locationName,fromLocation:i.fromLocationName,productCount:n,totalItems:e.reduce((o,s)=>o+s.quantity,0),totalValue:r,createdDate:i.createdDate,createdBy:i.createdBy}},addProduct:t=>{const e={...t,id:`prod-${Date.now()}`,createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};vm(r=>[...r,e])},addLocation:t=>{const e={...t,id:`loc-${Date.now()}`,createdDate:new Date().toISOString()};j0(r=>[...r,e])},updateProduct:(t,e)=>{vm(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n))},updateLocation:(t,e)=>{j0(r=>r.map(n=>n.id===t?{...n,...e}:n))},updateMovement:(t,e)=>{Ku(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n)),ad(Yu())},get inventory(){return Ju()},addItem(t){const e={...t,id:Date.now().toString(),lastUpdated:new Date().toISOString().split("T")[0]};return bm([...Ju(),e]),e},updateItem(t,e){bm(Ju().map(r=>r.id===t?{...r,...e,lastUpdated:new Date().toISOString().split("T")[0]}:r))},deleteItem(t){bm(Ju().filter(e=>e.id!==t))},getItemById(t){return no().find(e=>e.id===t)},getLowStockItems(){return no().filter(t=>t.quantity*1<=t.minStock*1)},getTotalValue(){return no().reduce((t,e)=>t*1+e.unitCost*1*e.quantity*1,0)}};var q0=ae("<div>"),WT=ae("<div><div><input type=text autocomplete=off>"),YT=ae("<button type=button>+"),KT=ae("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>");const Ap=t=>{const{t:e}=_r(),[r,n]=we(!1),[i,o]=we(""),[s,l]=we(-1),c=Ut(()=>t.value?Pt.getProductById(t.value):null),d=Ut(()=>{const re=i().toLowerCase();return re?Pt.getActiveProducts().filter(L=>L.name.toLowerCase().includes(re)||L.sku.toLowerCase().includes(re)||L?.UPC?.toLowerCase().includes(re)||L.category.toLowerCase().includes(re)):Pt.getActiveProducts()}),u=()=>{n(!0),o(""),l(-1)},y=re=>{const L=re.target;o(L.value),n(!0),l(-1)},g=re=>{t.onChange(re),n(!1),o(""),l(-1)},f=re=>{const L=d();switch(re.key){case"ArrowDown":re.preventDefault(),l(O=>Math.min(O+1,L.length-1));break;case"ArrowUp":re.preventDefault(),l(O=>Math.max(O-1,-1));break;case"Enter":re.preventDefault(),s()>=0&&L[s()]&&g(L[s()]);break;case"Escape":n(!1),o(""),l(-1);break}},w=re=>{setTimeout(()=>{n(!1),o(""),l(-1)},150)},E=re=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(re),x=re=>Pt.stockLevels?.filter(L=>L.productId===re).reduce((L,O)=>L+O.quantity,0),T={position:"relative",width:"100%",...t.style},Y={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},K={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},j=re=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid "+re?"var(--primary-color)":"var(--border-color)",background:re?"var(--strip-color)":"transparent",color:re?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),q={display:"flex","justify-content":"space-between","align-items":"center"},J={flex:"1"},C={"font-weight":"500","margin-bottom":"0.25rem"},P={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},$={"text-align":"right","font-size":"0.875rem"},D={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},b=()=>r()&&i()?i():c()?`${c().name} (${c().sku})`:"",S={display:"flex","align-items":"stretch",width:"100%"},v={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},z={...Y,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"};return(()=>{var re=WT(),L=re.firstChild,O=L.firstChild;return p(L,S),O.addEventListener("blur",w),O.$$keydown=f,O.$$click=u,O.$$input=y,a(L,(()=>{var ne=Te(()=>!!t.onAddNew);return()=>ne()&&(()=>{var X=YT();return X.addEventListener("mouseleave",W=>{W.currentTarget.style.background="var(--surface-color)",W.currentTarget.style.color="var(--primary-color)"}),X.addEventListener("mouseenter",W=>{W.currentTarget.style.background="var(--primary-color)",W.currentTarget.style.color="white"}),Xn(X,"click",t.onAddNew,!0),p(X,v),fe(()=>ir(X,"title",e("inventory.addProduct","Add new product"))),X})()})(),null),a(re,I(Oe,{get when(){return r()},get children(){var ne=q0();return a(ne,I(Oe,{get when(){return d().length>0},get fallback(){return(()=>{var X=q0();return p(X,D),a(X,(()=>{var W=Te(()=>!!i());return()=>W()?e("inventory.noProductsFound","No products found matching your search."):e("inventory.noProductsAvailable","No products available.")})()),X})()},get children(){return I(Ct,{get each(){return d()},children:(X,W)=>{const se=x(X.id),F=se<=X.minStockLevel;return(()=>{var k=KT(),N=k.firstChild,A=N.firstChild,V=A.firstChild,Z=V.nextSibling,H=Z.firstChild,B=H.firstChild,M=H.nextSibling,G=M.nextSibling,Q=G.nextSibling,ie=Q.nextSibling,me=A.nextSibling,oe=me.firstChild,ee=oe.firstChild,de=oe.nextSibling;return k.addEventListener("mouseenter",()=>l(W())),k.$$click=()=>g(X),p(N,q),p(A,J),p(V,C),a(V,()=>X.name),p(Z,P),a(H,()=>e("inventory.sku","SKU"),B),a(H,()=>X.sku,null),a(G,()=>X.category),a(ie,()=>E(X.unitCost)),p(me,$),oe.style.setProperty("font-weight","600"),(F?"#f44336":"var(--text-primary)")!=null?oe.style.setProperty("color",F?"#f44336":"var(--text-primary)"):oe.style.removeProperty("color"),a(oe,se,ee),a(oe,()=>X.unitOfMeasure,null),de.style.setProperty("color","var(--text-muted)"),a(de,()=>F?e("inventory.lowStock","Low Stock"):e("inventory.inStock","In Stock")),fe(he=>p(k,j(W()===s()),he)),k})()}})}})),fe(X=>p(ne,K,X)),ne}}),null),fe(ne=>{var X=T,W=z,se=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),F=t.disabled,k=t.required;return ne.e=p(re,X,ne.e),ne.t=p(O,W,ne.t),se!==ne.a&&ir(O,"placeholder",ne.a=se),F!==ne.o&&(O.disabled=ne.o=F),k!==ne.i&&(O.required=ne.i=k),ne},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),fe(()=>O.value=b()),re})()};br(["input","click","keydown"]);var z0=ae("<div>"),JT=ae("<div><div><input type=text autocomplete=off>"),QT=ae("<button type=button>+"),XT=ae("<div><div><div><div> </div><div><span>: </span><span></span></div><div>");const Kd=t=>{const{t:e}=_r(),[r,n]=we(!1),[i,o]=we(""),[s,l]=we(-1),c=Ut(()=>t.value?Pt.getLocationById(t.value):null),d=Ut(()=>{let re=Pt.getActiveLocations();t.filterType&&(re=re.filter(O=>O.type===t.filterType));const L=i().toLowerCase();return L?re.filter(O=>O.name.toLowerCase().includes(L)||O?.code?.toLowerCase().includes(L)||O?.type?.toLowerCase().includes(L)||O?.address?.toLowerCase().includes(L)):re}),u=()=>{n(!0),o(""),l(-1)},y=re=>{const L=re.target;o(L.value),n(!0),l(-1)},g=re=>{t.onChange(re.id),n(!1),o(""),l(-1)},f=re=>{const L=d();switch(re.key){case"ArrowDown":re.preventDefault(),l(O=>Math.min(O+1,L.length-1));break;case"ArrowUp":re.preventDefault(),l(O=>Math.max(O-1,-1));break;case"Enter":re.preventDefault(),s()>=0&&L[s()]&&g(L[s()]);break;case"Escape":n(!1),o(""),l(-1);break}},w=re=>{setTimeout(()=>{n(!1),o(""),l(-1)},150)},E=re=>({warehouse:"",store:"",supplier:"",customer:""})[re]||"",x=re=>({warehouse:"#2196F3",store:"#4CAF50",supplier:"#FF9800",customer:"#9C27B0"})[re]||"#757575",T={position:"relative",width:"100%",...t.style},Y={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},K={display:"flex","align-items":"stretch",width:"100%"},j={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},q={...Y,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},J={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},C=re=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:re?"var(--strip-color)":"transparent",color:re?"var(--primary-dark)":"var(--text-primary)",transition:"all 0.2s ease"}),P={display:"flex","justify-content":"space-between","align-items":"center"},$={flex:"1"},D={"font-weight":"500","margin-bottom":"0.25rem"},b={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","align-items":"center"},S=re=>({padding:"0.2rem 0.5rem","border-radius":"var(--border-radius-sm)","font-size":"0.7rem","font-weight":"500",background:x(re),color:"white","text-transform":"uppercase"}),v={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},z=()=>r()&&i()?i():c()?`${c().name} (${c().code})`:"";return(()=>{var re=JT(),L=re.firstChild,O=L.firstChild;return p(L,K),O.addEventListener("blur",w),O.$$keydown=f,O.$$click=u,O.$$input=y,a(L,(()=>{var ne=Te(()=>!!t.onAddNew);return()=>ne()&&(()=>{var X=QT();return X.addEventListener("mouseleave",W=>{W.currentTarget.style.background="var(--surface-color)",W.currentTarget.style.color="var(--primary-color)"}),X.addEventListener("mouseenter",W=>{W.currentTarget.style.background="var(--primary-color)",W.currentTarget.style.color="white"}),Xn(X,"click",t.onAddNew,!0),p(X,j),fe(()=>ir(X,"title",e("inventory.addLocation","Add new location"))),X})()})(),null),a(re,I(Oe,{get when(){return r()},get children(){var ne=z0();return a(ne,I(Oe,{get when(){return d().length>0},get fallback(){return(()=>{var X=z0();return p(X,v),a(X,(()=>{var W=Te(()=>!!i());return()=>W()?e("inventory.noLocationsFound","No locations found matching your search."):e("inventory.noLocationsAvailable","No locations available.")})()),X})()},get children(){return I(Ct,{get each(){return d()},children:(X,W)=>(()=>{var se=XT(),F=se.firstChild,k=F.firstChild,N=k.firstChild,A=N.firstChild,V=N.nextSibling,Z=V.firstChild,H=Z.firstChild,B=Z.nextSibling,M=V.nextSibling;return se.addEventListener("mouseenter",()=>l(W())),se.$$click=()=>g(X),p(F,P),p(k,$),p(N,D),a(N,()=>E(X.type),A),a(N,()=>X.name,null),p(V,b),a(Z,()=>e("inventory.locationCode","Code"),H),a(Z,()=>X.code,null),a(B,()=>X.type),M.style.setProperty("font-size","0.75rem"),M.style.setProperty("color","var(--text-muted)"),M.style.setProperty("margin-top","0.25rem"),a(M,()=>X.address),fe(G=>{var Q=C(W()===s()),ie=S(X.type);return G.e=p(se,Q,G.e),G.t=p(B,ie,G.t),G},{e:void 0,t:void 0}),se})()})}})),fe(X=>p(ne,J,X)),ne}}),null),fe(ne=>{var X=T,W=q,se=t.placeholder||e("inventory.searchLocations","Search locations by name, code, or type..."),F=t.disabled,k=t.required;return ne.e=p(re,X,ne.e),ne.t=p(O,W,ne.t),se!==ne.a&&ir(O,"placeholder",ne.a=se),F!==ne.o&&(O.disabled=ne.o=F),k!==ne.i&&(O.required=ne.i=k),ne},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),fe(()=>O.value=z()),re})()};br(["input","click","keydown"]);var ZT=ae("<form><div><label> *</label><input type=text required></div><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text list=categories required><datalist id=categories><option value=Electronics></option><option value=Accessories></option><option value=Office></option><option value=Furniture></option><option value=Software></option><option value=Hardware></option></datalist></div></div><div><label></label><textarea></textarea></div><div><div><label></label><select><option value=pcs></option><option value=kg></option><option value=lbs></option><option value=m></option><option value=ft></option><option value=l></option><option value=gal></option><option value=box></option><option value=pack></option></select></div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div></div><div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div><div></div></div><div><div><label></label><input type=number min=0 step=1></div><div><label></label><input type=number min=1 step=1></div></div><div>"),ek=ae("<div>");const og=t=>{const{t:e}=_r(),[r,n]=we(""),[i,o]=we(""),[s,l]=we(""),[c,d]=we(""),[u,y]=we("pcs"),[g,f]=we(0),[w,E]=we(0),[x,T]=we(10),[Y,K]=we(100),[j,q]=we(""),J=()=>{n(""),o(""),l(""),d(""),y("pcs"),f(0),E(0),T(10),K(100),q("")},C=L=>{if(L.preventDefault(),q(""),!r().trim()){q(e("forms.productNameRequired"));return}if(!i().trim()){q(e("forms.skuRequired"));return}if(!c().trim()){q(e("forms.categoryRequired"));return}if(g()<0){q(e("forms.unitCostNotNegative"));return}if(w()<0){q(e("forms.sellingPriceNotNegative"));return}if(x()<0){q(e("forms.minStockNotNegative"));return}if(Y()<=x()){q(e("forms.maxStockGreaterThanMin"));return}if(Pt.getProductsBySku(i()).length>0){q(e("forms.skuAlreadyExists"));return}const ne={name:r().trim(),sku:i().trim().toUpperCase(),description:s().trim(),category:c().trim(),unitOfMeasure:u(),unitCost:g(),sellingPrice:w(),minStockLevel:x(),maxStockLevel:Y(),isActive:!0,businessId:"default-business"};Pt.addProduct(ne);const X=`prod-${Date.now()}`;t.onProductAdded&&t.onProductAdded(X),J(),t.onClose()},P=()=>{J(),t.onClose()},$={"margin-bottom":"1.5rem"},D={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},b={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},S={...b,cursor:"pointer"},v={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},z={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},re={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"};return I(si,{get isOpen(){return t.isOpen},onClose:P,get title(){return e("inventory.addNewProduct")},get children(){var L=ZT(),O=L.firstChild,ne=O.firstChild,X=ne.firstChild,W=ne.nextSibling,se=O.nextSibling,F=se.firstChild,k=F.firstChild,N=k.firstChild,A=k.nextSibling,V=F.nextSibling,Z=V.firstChild,H=Z.firstChild,B=Z.nextSibling,M=se.nextSibling,G=M.firstChild,Q=G.nextSibling,ie=M.nextSibling,me=ie.firstChild,oe=me.firstChild,ee=oe.nextSibling,de=ee.firstChild,he=de.nextSibling,le=he.nextSibling,ye=le.nextSibling,ve=ye.nextSibling,pe=ve.nextSibling,ge=pe.nextSibling,ke=ge.nextSibling,Ne=ke.nextSibling,xe=me.nextSibling,$e=xe.firstChild,Ee=$e.nextSibling,Me=ie.nextSibling,Ye=Me.firstChild,ze=Ye.firstChild,je=ze.nextSibling,Xe=Me.nextSibling,ht=Xe.firstChild,ut=ht.firstChild,Ue=ut.nextSibling,it=ht.nextSibling,dt=it.firstChild,Fe=dt.nextSibling,Be=Xe.nextSibling;return L.addEventListener("submit",C),a(ne,()=>e("inventory.productName"),X),W.addEventListener("change",Re=>n(Re.target.value)),a(k,()=>e("inventory.sku"),N),A.addEventListener("change",Re=>o(Re.target.value)),a(Z,()=>e("inventory.category"),H),B.addEventListener("change",Re=>d(Re.target.value)),a(G,()=>e("common.description")),Q.addEventListener("change",Re=>l(Re.target.value)),a(oe,()=>e("inventory.unitOfMeasure")),ee.addEventListener("change",Re=>y(Re.target.value)),a(de,()=>e("inventory.pieces")),a(he,()=>e("inventory.kilograms")),a(le,()=>e("inventory.pounds")),a(ye,()=>e("inventory.meters")),a(ve,()=>e("inventory.feet")),a(pe,()=>e("inventory.liters")),a(ge,()=>e("inventory.gallons")),a(ke,()=>e("inventory.boxes")),a(Ne,()=>e("inventory.packs")),a($e,()=>e("inventory.unitCost")),Ee.addEventListener("change",Re=>f(Number(Re.target.value))),a(ze,()=>e("inventory.sellingPrice")),je.addEventListener("change",Re=>E(Number(Re.target.value))),a(ut,()=>e("inventory.minimumStockLevel")),Ue.addEventListener("change",Re=>T(Number(Re.target.value))),a(dt,()=>e("inventory.maximumStockLevel")),Fe.addEventListener("change",Re=>K(Number(Re.target.value))),a(L,(()=>{var Re=Te(()=>!!j());return()=>Re()&&(()=>{var lt=ek();return p(lt,v),a(lt,j),lt})()})(),Be),p(Be,z),a(Be,I(_t,{variant:"secondary",type:"button",onClick:P,get children(){return e("common.cancel")}}),null),a(Be,I(_t,{variant:"primary",type:"submit",get children(){return e("inventory.addProduct")}}),null),fe(Re=>{var lt=$,ot=D,nt=b,Ve=e("inventory.enterProductName"),qt=re,Mt=D,Qt=b,lr=e("inventory.enterSkuCode"),bt=D,yr=b,Cr=e("inventory.enterCategory"),Kt=$,sr=D,pt={...b,"min-height":"80px",resize:"vertical"},gt=e("inventory.enterProductDescription"),Vt=re,gr=D,et=S,ft=D,At=b,Yt=re,hr=D,Pr=b,Jr=re,Tr=D,zr=b,Xr=D,pr=b;return Re.e=p(O,lt,Re.e),Re.t=p(ne,ot,Re.t),Re.a=p(W,nt,Re.a),Ve!==Re.o&&ir(W,"placeholder",Re.o=Ve),Re.i=p(se,qt,Re.i),Re.n=p(k,Mt,Re.n),Re.s=p(A,Qt,Re.s),lr!==Re.h&&ir(A,"placeholder",Re.h=lr),Re.r=p(Z,bt,Re.r),Re.d=p(B,yr,Re.d),Cr!==Re.l&&ir(B,"placeholder",Re.l=Cr),Re.u=p(M,Kt,Re.u),Re.c=p(G,sr,Re.c),Re.w=p(Q,pt,Re.w),gt!==Re.m&&ir(Q,"placeholder",Re.m=gt),Re.f=p(ie,Vt,Re.f),Re.y=p(oe,gr,Re.y),Re.g=p(ee,et,Re.g),Re.p=p($e,ft,Re.p),Re.b=p(Ee,At,Re.b),Re.T=p(Me,Yt,Re.T),Re.A=p(ze,hr,Re.A),Re.O=p(je,Pr,Re.O),Re.I=p(Xe,Jr,Re.I),Re.S=p(ut,Tr,Re.S),Re.W=p(Ue,zr,Re.W),Re.C=p(dt,Xr,Re.C),Re.B=p(Fe,pr,Re.B),Re},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),fe(()=>W.value=r()),fe(()=>A.value=i()),fe(()=>B.value=c()),fe(()=>Q.value=s()),fe(()=>ee.value=u()),fe(()=>Ee.value=g()),fe(()=>je.value=w()),fe(()=>Ue.value=x()),fe(()=>Fe.value=Y()),L}})};var tk=ae('<form><div><label> *</label><input type=text required></div><div><div><label> *<button type=button title="Generate code automatically"></button></label><input type=text required><div></div></div><div><label> *</label><select required><option value=warehouse> </option><option value=store> </option><option value=supplier> </option><option value=customer> </option></select><div></div></div></div><div><label> *</label><textarea required></textarea></div><div>'),rk=ae("<div><div>:</div><div><span></span><div><div></div><div>"),nk=ae("<div>");const sg=t=>{const{t:e}=_r(),[r,n]=we(""),[i,o]=we(""),[s,l]=we("warehouse"),[c,d]=we(""),[u,y]=we(""),g=()=>{n(""),o(""),l("warehouse"),d(""),y("")},f=()=>{if(r()){const b=s()==="warehouse"?"WH":s()==="store"?"ST":s()==="supplier"?"SUP":"CUST",S=r().toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,3),v=String(Math.floor(Math.random()*1e3)).padStart(3,"0");o(`${b}-${S}-${v}`)}},w=b=>{if(b.preventDefault(),y(""),!r().trim()){y(e("forms.locationNameRequired"));return}if(!i().trim()){y(e("forms.locationCodeRequired"));return}if(!c().trim()){y(e("forms.addressRequired"));return}if(Pt.locations.filter(re=>re.code.toLowerCase()===i().toLowerCase()).length>0){y(e("forms.locationCodeExists"));return}const v={name:r().trim(),code:i().trim().toUpperCase(),type:s(),address:c().trim(),isActive:!0};Pt.addLocation(v);const z=`loc-${Date.now()}`;t.onLocationAdded&&t.onLocationAdded(z),g(),t.onClose()},E=()=>{g(),t.onClose()},x={"margin-bottom":"1.5rem"},T={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},Y={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},K={...Y,cursor:"pointer"},j={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},q={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},J={display:"grid","grid-template-columns":"2fr 1fr",gap:"1rem"},C={"font-size":"0.875rem",color:"var(--text-muted)","margin-top":"0.25rem"},P={padding:"0.25rem 0.5rem","font-size":"0.75rem","margin-left":"0.5rem",background:"var(--background-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",color:"var(--text-muted)"},$=b=>({warehouse:"",store:"",supplier:"",customer:""})[b]||"",D=b=>({warehouse:e("inventory.warehouseDescription"),store:e("inventory.storeDescription"),supplier:e("inventory.supplierDescription"),customer:e("inventory.customerDescription")})[b]||"";return I(si,{get isOpen(){return t.isOpen},onClose:E,get title(){return e("inventory.addNewLocation")},get children(){var b=tk(),S=b.firstChild,v=S.firstChild,z=v.firstChild,re=v.nextSibling,L=S.nextSibling,O=L.firstChild,ne=O.firstChild,X=ne.firstChild,W=X.nextSibling,se=ne.nextSibling,F=se.nextSibling,k=O.nextSibling,N=k.firstChild,A=N.firstChild,V=N.nextSibling,Z=V.firstChild,H=Z.firstChild,B=Z.nextSibling,M=B.firstChild,G=B.nextSibling,Q=G.firstChild,ie=G.nextSibling,me=ie.firstChild,oe=V.nextSibling,ee=L.nextSibling,de=ee.firstChild,he=de.firstChild,le=de.nextSibling,ye=ee.nextSibling;return b.addEventListener("submit",w),a(v,()=>e("inventory.locationName"),z),re.addEventListener("change",ve=>n(ve.target.value)),p(L,J),a(ne,()=>e("inventory.locationCode"),X),W.$$click=f,p(W,P),a(W,()=>e("common.generate")),se.addEventListener("change",ve=>o(ve.target.value)),a(F,()=>e("inventory.uniqueIdentifierHelp")),a(N,()=>e("inventory.locationType"),A),V.addEventListener("change",ve=>l(ve.target.value)),a(Z,()=>$("warehouse"),H),a(Z,()=>e("inventory.warehouse"),null),a(B,()=>$("store"),M),a(B,()=>e("inventory.store"),null),a(G,()=>$("supplier"),Q),a(G,()=>e("inventory.supplier"),null),a(ie,()=>$("customer"),me),a(ie,()=>e("inventory.customer"),null),a(oe,()=>D(s())),a(de,()=>e("common.address"),he),le.addEventListener("change",ve=>d(ve.target.value)),a(b,(()=>{var ve=Te(()=>!!r());return()=>ve()&&(()=>{var pe=rk(),ge=pe.firstChild,ke=ge.firstChild,Ne=ge.nextSibling,xe=Ne.firstChild,$e=xe.nextSibling,Ee=$e.firstChild,Me=Ee.nextSibling;return pe.style.setProperty("padding","1rem"),pe.style.setProperty("background","var(--background-color)"),pe.style.setProperty("border-radius","var(--border-radius-sm)"),pe.style.setProperty("border","1px solid var(--border-color)"),pe.style.setProperty("margin-bottom","1rem"),ge.style.setProperty("font-weight","500"),ge.style.setProperty("margin-bottom","0.5rem"),a(ge,()=>e("common.preview"),ke),Ne.style.setProperty("display","flex"),Ne.style.setProperty("align-items","center"),Ne.style.setProperty("gap","0.5rem"),xe.style.setProperty("font-size","1.2rem"),a(xe,()=>$(s())),Ee.style.setProperty("font-weight","600"),a(Ee,r),Me.style.setProperty("font-size","0.875rem"),Me.style.setProperty("color","var(--text-muted)"),a(Me,(()=>{var Ye=Te(()=>!!i());return()=>Ye()&&`${i()}  `})(),null),a(Me,s,null),pe})()})(),ye),a(b,(()=>{var ve=Te(()=>!!u());return()=>ve()&&(()=>{var pe=nk();return p(pe,j),a(pe,u),pe})()})(),ye),p(ye,q),a(ye,I(_t,{variant:"secondary",type:"button",onClick:E,get children(){return e("common.cancel")}}),null),a(ye,I(_t,{variant:"primary",type:"submit",get children(){return e("inventory.addLocation")}}),null),fe(ve=>{var pe=x,ge=T,ke=Y,Ne=e("inventory.enterLocationName"),xe=T,$e=Y,Ee=e("inventory.enterUniqueCode"),Me=C,Ye=T,ze=K,je=C,Xe=x,ht=T,ut={...Y,"min-height":"100px",resize:"vertical"},Ue=e("inventory.enterCompleteAddress");return ve.e=p(S,pe,ve.e),ve.t=p(v,ge,ve.t),ve.a=p(re,ke,ve.a),Ne!==ve.o&&ir(re,"placeholder",ve.o=Ne),ve.i=p(ne,xe,ve.i),ve.n=p(se,$e,ve.n),Ee!==ve.s&&ir(se,"placeholder",ve.s=Ee),ve.h=p(F,Me,ve.h),ve.r=p(N,Ye,ve.r),ve.d=p(V,ze,ve.d),ve.l=p(oe,je,ve.l),ve.u=p(ee,Xe,ve.u),ve.c=p(de,ht,ve.c),ve.w=p(le,ut,ve.w),Ue!==ve.m&&ir(le,"placeholder",ve.m=Ue),ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),fe(()=>re.value=r()),fe(()=>se.value=i()),fe(()=>V.value=s()),fe(()=>le.value=c()),b}})};br(["click"]);var ik=ae("<form><div>"),U0=ae("<div><label> *"),ok=ae("<div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment>"),sk=ae("<div><label>"),ak=ae("<div><label> *</label><input type=number min=0 step=1 required>"),lk=ae("<div><label></label><input type=number min=0 step=0.01>"),ck=ae("<div><label></label><input type=text>"),dk=ae("<div><label></label><textarea>"),uk=ae("<div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span>:</span><span> "),hk=ae("<div><div><span>:</span><span>"),pk=ae("<div>");const mk=t=>{const{t:e}=_r(),[r,n]=we({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""}),[i,o]=we(""),[s,l]=we(""),[c,d]=we("in"),[u,y]=we(0),[g,f]=we(0),[w,E]=we(""),[x,T]=we(""),[Y,K]=we(""),[j,q]=we(""),[J,C]=we(!1),[P,$]=we(!1),D=()=>t.mode==="movement",b=Ut(()=>i()?Pt.getProductById(i()):null),S=Ut(()=>s()?Pt.getLocationById(s()):null),v=Ut(()=>Y()?Pt.getLocationById(Y()):null),z=Ut(()=>u()*g()),re=Ut(()=>!i()||!s()?0:Pt.getStockByProductAndLocation(i(),s())?.quantity||0),L=[{value:"Electronics",label:"Electronics"},{value:"Accessories",label:"Accessories"},{value:"Furniture",label:"Furniture"},{value:"Office Supplies",label:"Office Supplies"},{value:"Software",label:"Software"},{value:"Hardware",label:"Hardware"},{value:"Consumables",label:"Consumables"}],O=[{value:"Warehouse A",label:"Warehouse A"},{value:"Warehouse B",label:"Warehouse B"},{value:"Warehouse C",label:"Warehouse C"},{value:"Storage Room",label:"Storage Room"},{value:"Main Office",label:"Main Office"}],ne={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},X=()=>{o(""),l(""),d("in"),y(0),f(0),E(""),T(""),K(""),q("")},W=()=>{n({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""})},se=ie=>{if(ie.preventDefault(),D()){if(q(""),!i()){q(e("forms.selectProduct"));return}if(!s()){q(e("forms.selectLocation"));return}if(u()<=0){q(e("forms.quantityGreaterThanZero"));return}if(g()<0){q(e("forms.unitCostNotNegative"));return}if(c()==="transfer"&&!Y()){q(e("forms.selectFromLocation"));return}if(c()==="transfer"&&Y()===s()){q(e("forms.sameLocationError"));return}if(c()==="out"&&u()>re()){q(e("forms.insufficientStock",{currentStock:re()}));return}const me=b(),oe=S(),ee={productId:me.id,productName:me.name,productSku:me.sku,locationId:oe.id,locationName:oe.name,movementType:c(),quantity:u(),unitCost:g()||me.unitCost,totalCost:z()||u()*me.unitCost,referenceNumber:w()||`AUTO-${Date.now()}`,notes:x(),createdBy:"admin",fromLocationId:c()==="transfer"?Y():void 0,fromLocationName:c()==="transfer"?v()?.name:void 0};Pt.addInventoryMovement(ee),X()}else{const me=r();if(!me.name||!me.price||!me.quantity||!me.category||!me.sku||!me.supplier||!me.minStock||!me.location){alert(e("forms.fillAllRequired"));return}const oe={name:me.name,price:parseFloat(me.price),quantity:parseInt(me.quantity),category:me.category,description:me.description,sku:me.sku,supplier:me.supplier,minStock:parseInt(me.minStock),location:me.location};Pt.addItem(oe),W()}t.onClose()},F=(ie,me)=>{n(oe=>({...oe,[ie]:me}))},k=()=>{D()?X():W(),t.onClose()},N=ie=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ie),A={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},V={...A,cursor:"pointer"},Z={color:"#f44336","font-size":"0.875rem","margin-top":"0.5rem"},H={padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},B={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},M={"font-weight":"500",color:"var(--text-muted)"},G={"font-weight":"600",color:"var(--text-primary)"},Q=()=>D()?e("inventory.addMovement"):e("inventory.addNewItem");return I(si,{get isOpen(){return t.isOpen},onClose:k,get title(){return Q()},get children(){return[(()=>{var ie=ik(),me=ie.firstChild;return ie.addEventListener("submit",se),a(ie,(()=>{var oe=Te(()=>!!D());return()=>oe()?[(()=>{var ee=U0(),de=ee.firstChild,he=de.firstChild;return ee.style.setProperty("margin-bottom","1.5rem"),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),a(de,()=>e("inventory.product"),he),a(ee,I(Ap,{get value(){return i()},onChange:le=>{o(le);const ye=Pt.getProductById(le);ye&&f(ye.unitCost)},get placeholder(){return e("inventory.searchProductsPlaceholder")},onAddNew:()=>C(!0),required:!0}),null),ee})(),(()=>{var ee=ok(),de=ee.firstChild,he=de.firstChild,le=de.nextSibling,ye=le.firstChild,ve=ye.nextSibling,pe=ve.nextSibling,ge=pe.nextSibling;return ee.style.setProperty("margin-bottom","1.5rem"),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),a(de,()=>e("inventory.movementType"),he),le.addEventListener("change",ke=>d(ke.target.value)),a(ye,()=>e("inventory.stockInPurchase")),a(ve,()=>e("inventory.stockOutSale")),a(pe,()=>e("inventory.transferBetween")),a(ge,()=>e("inventory.stockAdjustment")),fe(ke=>p(le,V,ke)),fe(()=>le.value=c()),ee})(),Te(()=>Te(()=>c()==="transfer")()&&(()=>{var ee=U0(),de=ee.firstChild,he=de.firstChild;return ee.style.setProperty("margin-bottom","1.5rem"),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),a(de,()=>e("inventory.fromLocation"),he),a(ee,I(Kd,{get value(){return Y()},onChange:le=>K(le),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>$(!0),required:!0}),null),ee})()),(()=>{var ee=sk(),de=ee.firstChild;return ee.style.setProperty("margin-bottom","1.5rem"),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),a(de,(()=>{var he=Te(()=>c()==="transfer");return()=>he()?e("inventory.toLocation")+" *":e("inventory.locationName")+" *"})()),a(ee,I(Kd,{get value(){return s()},onChange:he=>l(he),get placeholder(){return Te(()=>c()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>$(!0),required:!0}),null),ee})(),Te(()=>Te(()=>!!(b()&&S()))()&&(()=>{var ee=uk(),de=ee.firstChild,he=de.firstChild,le=he.firstChild,ye=he.nextSibling,ve=ye.firstChild,pe=de.nextSibling,ge=pe.firstChild,ke=ge.firstChild,Ne=ge.nextSibling,xe=pe.nextSibling,$e=xe.firstChild,Ee=$e.firstChild,Me=$e.nextSibling,Ye=Me.firstChild;return a(he,()=>e("inventory.currentStockAt",{location:S()?.name}),le),a(ye,re,ve),a(ye,()=>b()?.unitOfMeasure,null),a(ge,()=>e("inventory.productCost"),ke),a(Ne,()=>N(b()?.unitCost||0)),a($e,()=>e("inventory.minStockLevel"),Ee),a(Me,()=>b()?.minStockLevel,Ye),a(Me,()=>b()?.unitOfMeasure,null),fe(ze=>{var je=H,Xe=B,ht=M,ut=G,Ue=B,it=M,dt=G,Fe=B,Be=M,Re=G;return ze.e=p(ee,je,ze.e),ze.t=p(de,Xe,ze.t),ze.a=p(he,ht,ze.a),ze.o=p(ye,ut,ze.o),ze.i=p(pe,Ue,ze.i),ze.n=p(ge,it,ze.n),ze.s=p(Ne,dt,ze.s),ze.h=p(xe,Fe,ze.h),ze.r=p($e,Be,ze.r),ze.d=p(Me,Re,ze.d),ze},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),ee})()),(()=>{var ee=ak(),de=ee.firstChild,he=de.firstChild,le=de.nextSibling;return ee.style.setProperty("margin-bottom","1.5rem"),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),a(de,()=>e("inventory.quantity"),he),le.addEventListener("change",ye=>y(Number(ye.target.value))),fe(ye=>p(le,A,ye)),fe(()=>le.value=u()),ee})(),(()=>{var ee=lk(),de=ee.firstChild,he=de.nextSibling;return ee.style.setProperty("margin-bottom","1.5rem"),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),a(de,()=>e("inventory.unitCost")),he.addEventListener("change",le=>f(Number(le.target.value))),fe(le=>{var ye=A,ve=e("inventory.willUseDefaultCost");return le.e=p(he,ye,le.e),ve!==le.t&&ir(he,"placeholder",le.t=ve),le},{e:void 0,t:void 0}),fe(()=>he.value=g()),ee})(),Te(()=>Te(()=>u()>0&&g()>0)()&&(()=>{var ee=hk(),de=ee.firstChild,he=de.firstChild,le=he.firstChild,ye=he.nextSibling;return a(he,()=>e("inventory.totalCost"),le),a(ye,()=>N(z())),fe(ve=>{var pe=H,ge=B,ke=M,Ne={...G,"font-size":"1.2rem",color:"var(--primary-color)"};return ve.e=p(ee,pe,ve.e),ve.t=p(de,ge,ve.t),ve.a=p(he,ke,ve.a),ve.o=p(ye,Ne,ve.o),ve},{e:void 0,t:void 0,a:void 0,o:void 0}),ee})()),(()=>{var ee=ck(),de=ee.firstChild,he=de.nextSibling;return ee.style.setProperty("margin-bottom","1.5rem"),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),a(de,()=>e("common.referenceNumber")),he.addEventListener("change",le=>E(le.target.value)),fe(le=>{var ye=A,ve=e("common.referenceNumberPlaceholder");return le.e=p(he,ye,le.e),ve!==le.t&&ir(he,"placeholder",le.t=ve),le},{e:void 0,t:void 0}),fe(()=>he.value=w()),ee})(),(()=>{var ee=dk(),de=ee.firstChild,he=de.nextSibling;return ee.style.setProperty("margin-bottom","1.5rem"),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),a(de,()=>e("common.notes")),he.addEventListener("change",le=>T(le.target.value)),fe(le=>{var ye={...A,"min-height":"100px",resize:"vertical"},ve=e("inventory.additionalNotesPlaceholder");return le.e=p(he,ye,le.e),ve!==le.t&&ir(he,"placeholder",le.t=ve),le},{e:void 0,t:void 0}),fe(()=>he.value=x()),ee})(),Te(()=>Te(()=>!!j())()&&(()=>{var ee=pk();return p(ee,Z),a(ee,j),ee})())]:[I(Mr,{get label(){return e("inventory.itemName")},get value(){return r().name},onChange:ee=>F("name",ee),get placeholder(){return e("inventory.enterItemName")},required:!0}),I(Mr,{get label(){return e("inventory.sku")},get value(){return r().sku},onChange:ee=>F("sku",ee),get placeholder(){return e("inventory.enterSkuCode")},required:!0}),I(Hn,{get label(){return e("inventory.category")},get value(){return r().category},onChange:ee=>F("category",ee),options:L,required:!0}),I(Mr,{get label(){return e("common.description")},get value(){return r().description},onChange:ee=>F("description",ee),get placeholder(){return e("inventory.enterItemDescription")}}),I(Mr,{get label(){return e("common.price")},type:"number",get value(){return r().price},onChange:ee=>F("price",ee),get placeholder(){return e("common.enterPrice")},required:!0}),I(Mr,{get label(){return e("inventory.quantity")},type:"number",get value(){return r().quantity},onChange:ee=>F("quantity",ee),get placeholder(){return e("inventory.enterQuantity")},required:!0}),I(Mr,{get label(){return e("inventory.minimumStock")},type:"number",get value(){return r().minStock},onChange:ee=>F("minStock",ee),get placeholder(){return e("inventory.enterMinStockLevel")},required:!0}),I(Mr,{get label(){return e("inventory.supplier")},get value(){return r().supplier},onChange:ee=>F("supplier",ee),get placeholder(){return e("inventory.enterSupplierName")},required:!0}),I(Hn,{get label(){return e("inventory.location")},get value(){return r().location},onChange:ee=>F("location",ee),options:O,required:!0})]})(),me),p(me,ne),a(me,I(_t,{variant:"secondary",type:"button",onClick:k,get children(){return e("common.cancel")}}),null),a(me,I(_t,{variant:"primary",type:"submit",get children(){return Te(()=>!!D())()?e("inventory.addMovement"):e("inventory.addItem")}}),null),ie})(),I(og,{get isOpen(){return J()},onClose:()=>C(!1),onProductAdded:ie=>{o(ie),C(!1)}}),I(sg,{get isOpen(){return P()},onClose:()=>$(!1),onLocationAdded:ie=>{c()==="transfer"&&!Y()?K(ie):l(ie),$(!1)}})]}})};br(["input","keydown"]);var fk=ae("<div><div></div><div></div><div></div><div>"),yk=ae("<div><strong>:</strong> "),gk=ae("<div><div><span></span><span></span></div><div><span></span><span> </span></div><div><span></span><span> </span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),vk=ae("<div>");const bk=t=>{const{t:e}=_r(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={"text-align":"center","margin-bottom":"2rem"},s={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},l={color:"var(--text-muted)","font-size":"1rem"},c={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"1rem"},d=(E,x)=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:E>x?"#d4edda":"#f8d7da",color:E>x?"#155724":"#721c24"}),u={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},y={"margin-bottom":"1.5rem",padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",color:"var(--text-secondary)"};if(!t.item)return null;const g=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E),f=E=>new Date(E).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),w=t.item.price*t.item.quantity;return I(si,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.itemDetails")},get children(){return[(()=>{var E=fk(),x=E.firstChild,T=x.nextSibling,Y=T.nextSibling,K=Y.nextSibling;return p(E,o),p(x,s),a(x,()=>t.item.name),p(T,l),a(T,()=>t.item.category),p(Y,c),a(Y,()=>g(t.item.price)),a(K,(()=>{var j=Te(()=>t.item.quantity>t.item.minStock);return()=>j()?e("inventory.inStock"):e("inventory.lowStockAlert")})()),fe(j=>p(K,d(t.item.quantity,t.item.minStock),j)),E})(),(()=>{var E=yk(),x=E.firstChild,T=x.firstChild;return x.nextSibling,p(E,y),a(x,()=>e("common.description"),T),a(E,()=>t.item.description,null),E})(),(()=>{var E=gk(),x=E.firstChild,T=x.firstChild,Y=T.nextSibling,K=x.nextSibling,j=K.firstChild,q=j.nextSibling,J=q.firstChild,C=K.nextSibling,P=C.firstChild,$=P.nextSibling,D=$.firstChild,b=C.nextSibling,S=b.firstChild,v=S.nextSibling,z=b.nextSibling,re=z.firstChild,L=re.nextSibling,O=z.nextSibling,ne=O.firstChild,X=ne.nextSibling,W=O.nextSibling,se=W.firstChild,F=se.nextSibling;return a(T,()=>e("inventory.sku")),a(Y,()=>t.item.sku),a(j,()=>e("inventory.quantity")),a(q,()=>t.item.quantity,J),a(q,()=>e("common.units"),null),a(P,()=>e("inventory.minimumStock")),a($,()=>t.item.minStock,D),a($,()=>e("common.units"),null),a(S,()=>e("inventory.totalValue")),a(v,()=>g(w)),a(re,()=>e("inventory.supplier")),a(L,()=>t.item.supplier),a(ne,()=>e("inventory.location")),a(X,()=>t.item.location),a(se,()=>e("common.lastUpdated")),a(F,()=>f(t.item.lastUpdated)),fe(k=>{var N=r,A=n,V=i,Z=r,H=n,B=i,M=r,G=n,Q=i,ie=r,me=n,oe=i,ee=r,de=n,he=i,le=r,ye=n,ve=i,pe=r,ge=n,ke=i;return k.e=p(x,N,k.e),k.t=p(T,A,k.t),k.a=p(Y,V,k.a),k.o=p(K,Z,k.o),k.i=p(j,H,k.i),k.n=p(q,B,k.n),k.s=p(C,M,k.s),k.h=p(P,G,k.h),k.r=p($,Q,k.r),k.d=p(b,ie,k.d),k.l=p(S,me,k.l),k.u=p(v,oe,k.u),k.c=p(z,ee,k.c),k.w=p(re,de,k.w),k.m=p(L,he,k.m),k.f=p(O,le,k.f),k.y=p(ne,ye,k.y),k.g=p(X,ve,k.g),k.p=p(W,pe,k.p),k.b=p(se,ge,k.b),k.T=p(F,ke,k.T),k},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),E})(),(()=>{var E=vk();return p(E,u),a(E,I(_t,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),a(E,I(_t,{variant:"primary",onClick:()=>{console.log("Edit item:",t.item.id)},get children(){return e("common.editItem")}}),null),E})()]}})};var _k=ae("<div>"),Pk=ae("<button type=button>"),Sk=ae("<div> "),H0=ae("<div>"),wk=ae("<div><div><input type=text autocomplete=off>"),xk=ae("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>"),Ck=ae("<span> ");const Ak=t=>{const{t:e}=_r(),[r,n]=we(""),[i,o]=we(!1),[s,l]=we(null),[c,d]=we([]),[u,y]=we(!1),[g,f]=we(-1),[w,E]=we(null),x=t.searchDelay||300;t.maxResults;const T=async N=>{if(!N.trim()||N.trim().length<3){d([]),t.onSearchResults?.([]);return}try{o(!0),l(null);try{console.log("apiResults",N),t.onSearchResults?.(N)}catch(A){console.warn("API search failed, using local fallback:",A),l("API search failed, showing local results")}}catch(A){const V=A instanceof Error?A.message:"Search failed";l(V),d([]),t.onSearchResults?.([])}finally{o(!1)}},Y=N=>{const V=N.target.value;n(V),l(null),console.log(),t.showResults,w()&&clearTimeout(w());const Z=setTimeout(()=>{T(V)},x);E(Z)},K=N=>{n(N.name),y(!1),f(-1),t.onInventorySelect?.(N)},j=N=>{if(!(!u()||c().length===0))switch(N.key){case"ArrowDown":N.preventDefault(),f(A=>Math.min(A+1,c().length-1));break;case"ArrowUp":N.preventDefault(),f(A=>Math.max(A-1,-1));break;case"Enter":N.preventDefault(),g()>=0&&c()[g()]&&K(c()[g()]);break;case"Escape":y(!1),f(-1);break}},q=()=>{t.showResults!==!1&&c().length>0&&y(!0)},J=()=>{setTimeout(()=>{y(!1),f(-1)},150)},C=()=>{n(""),d([]),l(null),y(!1),f(-1),t.onSearchResults?.([]),w()&&(clearTimeout(w()),E(null))},P=N=>Pt.stockLevels.filter(A=>A.inventoryId===N).reduce((A,V)=>A+V.quantity,0),$=N=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(N),D={position:"relative",width:"100%",...t.style},b={position:"relative",display:"flex","align-items":"center"},S={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},v={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},z={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},re={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},L=N=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:N?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),O={display:"flex","justify-content":"space-between","align-items":"center"},ne={flex:"1"},X={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},W={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},se={"text-align":"right","font-size":"0.875rem"},F={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},k={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var N=wk(),A=N.firstChild,V=A.firstChild;return V.addEventListener("blur",J),V.addEventListener("focus",q),V.$$keydown=j,V.$$input=Y,a(A,I(Oe,{get when(){return i()},get children(){var Z=_k();return fe(H=>p(Z,z,H)),Z}}),null),a(A,I(Oe,{get when(){return Te(()=>!!r())()&&!i()},get children(){var Z=Pk();return Z.addEventListener("mouseleave",H=>{H.currentTarget.style.background="none",H.currentTarget.style.color="var(--text-muted)"}),Z.addEventListener("mouseenter",H=>{H.currentTarget.style.background="var(--border-color)",H.currentTarget.style.color="var(--text-primary)"}),Z.$$click=C,fe(H=>{var B=v,M=e("common.clear","Clear search");return H.e=p(Z,B,H.e),M!==H.t&&ir(Z,"title",H.t=M),H},{e:void 0,t:void 0}),Z}}),null),a(N,I(Oe,{get when(){return u()&&t.showResults!==!1},get children(){var Z=H0();return a(Z,I(Oe,{get when(){return s()},get children(){var H=Sk();return H.firstChild,p(H,k),a(H,s,null),H}}),null),a(Z,I(Oe,{get when(){return c().length>0},get fallback(){return Te(()=>!!(r()&&!i()))()&&(()=>{var H=H0();return p(H,F),a(H,()=>e("inventory.noInventorysFound","No inventorys found matching your search.")),H})()},get children(){return I(Ct,{get each(){return c()},children:(H,B)=>{const M=P(H.id),G=M<=H.minStockLevel;return(()=>{var Q=xk(),ie=Q.firstChild,me=ie.firstChild,oe=me.firstChild,ee=oe.nextSibling,de=ee.firstChild,he=de.firstChild,le=de.nextSibling,ye=le.nextSibling,ve=ye.nextSibling,pe=ve.nextSibling,ge=me.nextSibling,ke=ge.firstChild,Ne=ke.firstChild,xe=ke.nextSibling;return Q.addEventListener("mouseenter",()=>f(B())),Q.$$click=()=>K(H),p(ie,O),p(me,ne),p(oe,X),a(oe,()=>H.name),p(ee,W),a(de,()=>e("inventory.sku","SKU"),he),a(de,()=>H.sku,null),a(ye,()=>H.category),a(pe,()=>$(H.unitCost)),p(ge,se),ke.style.setProperty("font-weight","600"),(G?"#f44336":"var(--text-primary)")!=null?ke.style.setProperty("color",G?"#f44336":"var(--text-primary)"):ke.style.removeProperty("color"),a(ke,M,Ne),a(ke,()=>H.unitOfMeasure,null),xe.style.setProperty("color","var(--text-muted)"),a(xe,()=>G?(()=>{var $e=Ck();return $e.firstChild,$e.style.setProperty("color","#f44336"),a($e,()=>e("inventory.lowStock","Low Stock"),null),$e})():e("inventory.inStock","In Stock")),fe($e=>p(Q,L(B()===g()),$e)),Q})()}})}}),null),fe(H=>p(Z,re,H)),Z}}),null),fe(Z=>{var H=D,B=b,M=S,G=t.placeholder||e("inventory.searchInventorys","Search inventorys by name, SKU, or category..."),Q=t.disabled;return Z.e=p(N,H,Z.e),Z.t=p(A,B,Z.t),Z.a=p(V,M,Z.a),G!==Z.o&&ir(V,"placeholder",Z.o=G),Q!==Z.i&&(V.disabled=Z.i=Q),Z},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),fe(()=>V.value=r()),N})()};br(["input","keydown","click"]);var $k=ae("<div>"),_m=ae("<div><span>:</span><span>"),Ek=ae("<div><button> "),Ik=ae("<div><div><div><h3></h3><div>: </div></div><div><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span> <!>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span>");const Tk=t=>{const{t:e}=_r(),r=f=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(f),n=f=>new Date(f).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),i=f=>({in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}})[f]||{bg:"#f5f5f5",color:"#666"},o=f=>({in:"",out:"",transfer:"",adjustment:""})[f]||"",s=()=>t.movement,l={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},c={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},d={"font-weight":"600",color:"var(--text-primary)","text-align":"right"},u={"margin-bottom":"1.5rem"},y={"font-weight":"600","margin-bottom":"0.75rem","padding-bottom":"0.5rem","border-bottom":"2px solid var(--border-color)"},g=f=>({display:"inline-flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"600","text-transform":"uppercase","letter-spacing":"0.5px",background:i(f).bg,color:i(f).color});return I(si,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.movementDetails")},size:"lg",get children(){return I(Oe,{get when(){return s()},get fallback(){return(()=>{var f=$k();return a(f,()=>e("common.noDataFound")),f})()},children:f=>(()=>{var w=Ik(),E=w.firstChild,x=E.firstChild,T=x.firstChild,Y=T.nextSibling,K=Y.firstChild,j=x.nextSibling,q=j.firstChild,J=E.nextSibling,C=J.firstChild,P=C.nextSibling,$=P.firstChild,D=$.firstChild,b=$.nextSibling,S=P.nextSibling,v=S.firstChild,z=v.firstChild,re=v.nextSibling,L=re.firstChild,O=S.nextSibling,ne=O.firstChild,X=ne.firstChild,W=ne.nextSibling,se=O.nextSibling,F=se.firstChild,k=F.firstChild,N=k.nextSibling;N.nextSibling;var A=F.nextSibling,V=J.nextSibling,Z=V.firstChild,H=Z.nextSibling,B=H.firstChild,M=B.firstChild,G=B.nextSibling,Q=V.nextSibling,ie=Q.firstChild,me=ie.nextSibling,oe=me.firstChild,ee=oe.firstChild,de=oe.nextSibling,he=me.nextSibling,le=he.firstChild,ye=le.firstChild,ve=le.nextSibling;return E.style.setProperty("display","flex"),E.style.setProperty("justify-content","space-between"),E.style.setProperty("align-items","center"),E.style.setProperty("margin-bottom","1.5rem"),E.style.setProperty("padding-bottom","1rem"),E.style.setProperty("border-bottom","2px solid var(--border-color)"),T.style.setProperty("margin","0 0 0.5rem 0"),T.style.setProperty("font-size","1.25rem"),a(T,()=>f().productName),Y.style.setProperty("font-size","0.875rem"),Y.style.setProperty("color","var(--text-muted)"),a(Y,()=>e("inventory.sku"),K),a(Y,()=>f().productSku,null),j.$$click=()=>Pt.generateMovementInvoice(f().id,e),q.style.setProperty("font-size","1.2rem"),a(q,()=>o(f().movementType)),a(j,()=>f().movementType,null),a(C,()=>e("inventory.movementInformation")),a($,()=>e("inventory.referenceNumber"),D),a(b,()=>f().referenceNumber),a(v,()=>e("common.quantity"),z),a(re,()=>f().quantity,L),a(re,()=>e("common.units"),null),a(ne,()=>e("inventory.unitCost"),X),a(W,()=>r(f().unitCost)),a(F,()=>e("common.total"),k),a(F,()=>e("common.value"),N),a(A,()=>r(f().totalCost)),a(Z,()=>e("inventory.locationInformation")),a(B,()=>e("inventory.location"),M),a(G,()=>f().locationName),a(V,I(Oe,{get when(){return f().fromLocationName},get children(){var pe=_m(),ge=pe.firstChild,ke=ge.firstChild,Ne=ge.nextSibling;return a(ge,()=>e("common.from"),ke),a(Ne,()=>f().fromLocationName),fe(xe=>{var $e=l,Ee=c,Me=d;return xe.e=p(pe,$e,xe.e),xe.t=p(ge,Ee,xe.t),xe.a=p(Ne,Me,xe.a),xe},{e:void 0,t:void 0,a:void 0}),pe}}),null),a(V,I(Oe,{get when(){return f().invoiceId},get children(){var pe=_m(),ge=pe.firstChild,ke=ge.firstChild,Ne=ge.nextSibling;return a(ge,()=>e("common.invoice"),ke),a(Ne,()=>f().invoiceId),fe(xe=>{var $e=l,Ee=c,Me={...d,color:"var(--primary-color)"};return xe.e=p(pe,$e,xe.e),xe.t=p(ge,Ee,xe.t),xe.a=p(Ne,Me,xe.a),xe},{e:void 0,t:void 0,a:void 0}),pe}}),null),a(ie,()=>e("common.details")),a(oe,()=>e("common.createdBy"),ee),a(de,()=>f().createdBy),a(le,()=>e("common.created"),ye),a(ve,()=>n(f().createdDate)),a(Q,I(Oe,{get when(){return f().notes},get children(){var pe=_m(),ge=pe.firstChild,ke=ge.firstChild,Ne=ge.nextSibling;return a(ge,()=>e("common.notes"),ke),a(Ne,()=>f().notes),fe(xe=>{var $e={...l,"border-bottom":"none"},Ee=c,Me={...d,"font-style":"italic","max-width":"60%","white-space":"pre-wrap"};return xe.e=p(pe,$e,xe.e),xe.t=p(ge,Ee,xe.t),xe.a=p(Ne,Me,xe.a),xe},{e:void 0,t:void 0,a:void 0}),pe}}),null),a(w,I(Oe,{get when(){return t.onEdit},get children(){var pe=Ek(),ge=pe.firstChild,ke=ge.firstChild;return pe.style.setProperty("display","flex"),pe.style.setProperty("justify-content","flex-end"),pe.style.setProperty("margin-top","1.5rem"),pe.style.setProperty("padding-top","1rem"),pe.style.setProperty("border-top","1px solid var(--border-color)"),ge.addEventListener("mouseleave",Ne=>{Ne.currentTarget.style.transform="translateY(0)",Ne.currentTarget.style.boxShadow="none"}),ge.addEventListener("mouseenter",Ne=>{Ne.currentTarget.style.transform="translateY(-1px)",Ne.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)"}),ge.$$click=()=>t.onEdit?.(f()),ge.style.setProperty("padding","0.5rem 1.5rem"),ge.style.setProperty("border-radius","var(--border-radius-sm)"),ge.style.setProperty("border","1px solid var(--primary-color)"),ge.style.setProperty("background","var(--primary-color)"),ge.style.setProperty("color","white"),ge.style.setProperty("cursor","pointer"),ge.style.setProperty("font-weight","500"),ge.style.setProperty("transition","all 0.2s ease"),a(ge,()=>e("common.edit"),ke),a(ge,()=>e("inventory.movement"),null),pe}}),null),fe(pe=>{var ge=g(f().movementType),ke=u,Ne=y,xe=l,$e=c,Ee=d,Me=l,Ye=c,ze={...d,"font-size":"1.1rem",color:"var(--primary-color)"},je=l,Xe=c,ht=d,ut=l,Ue=c,it={...d,"font-size":"1.1rem",color:"var(--primary-color)"},dt=u,Fe=y,Be=l,Re=c,lt=d,ot=u,nt=y,Ve=l,qt=c,Mt=d,Qt=l,lr=c,bt=d;return pe.e=p(j,ge,pe.e),pe.t=p(J,ke,pe.t),pe.a=p(C,Ne,pe.a),pe.o=p(P,xe,pe.o),pe.i=p($,$e,pe.i),pe.n=p(b,Ee,pe.n),pe.s=p(S,Me,pe.s),pe.h=p(v,Ye,pe.h),pe.r=p(re,ze,pe.r),pe.d=p(O,je,pe.d),pe.l=p(ne,Xe,pe.l),pe.u=p(W,ht,pe.u),pe.c=p(se,ut,pe.c),pe.w=p(F,Ue,pe.w),pe.m=p(A,it,pe.m),pe.f=p(V,dt,pe.f),pe.y=p(Z,Fe,pe.y),pe.g=p(H,Be,pe.g),pe.p=p(B,Re,pe.p),pe.b=p(G,lt,pe.b),pe.T=p(Q,ot,pe.T),pe.A=p(ie,nt,pe.A),pe.O=p(me,Ve,pe.O),pe.I=p(oe,qt,pe.I),pe.S=p(de,Mt,pe.S),pe.W=p(he,Qt,pe.W),pe.C=p(le,lr,pe.C),pe.B=p(ve,bt,pe.B),pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),w})()})}})};br(["click"]);var hl=ae("<div>"),kk=ae("<div><label></label><select><option value>"),Nk=ae("<div><div><span>:</span><span>$"),Lk=ae("<form><div><label></label><select><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><input type=number min=0.01 step=0.01></div><div><label></label><input type=number min=0 step=0.01></div><div><label></label><input type=text></div><div><label> (<!>)</label><input type=text></div><div><label> (<!>)</label><textarea></textarea></div><div><button type=button></button><button type=submit>"),G0=ae("<option> (<!>)");const Rk=t=>{const{t:e}=_r(),[r,n]=we("in"),[i,o]=we(""),[s,l]=we(""),[c,d]=we(""),[u,y]=we(""),[g,f]=we(""),[w,E]=we(""),[x,T]=we(""),[Y,K]=we(!1),[j,q]=we({});xi(()=>{const z=t.movement;z&&t.isOpen&&(n(z.movementType),o(z.quantity.toString()),l(z.unitCost.toString()),d(z.referenceNumber),y(z.notes),E(z.locationId),f(z.fromLocationId||""),T(z.invoiceId||""),q({}))});const J=()=>{const z={};return(!i()||parseFloat(i())<=0)&&(z.quantity=e("forms.requiredField")),(!s()||parseFloat(s())<0)&&(z.unitCost=e("forms.requiredField")),c().trim()||(z.referenceNumber=e("forms.requiredField")),w()||(z.locationId=e("forms.requiredField")),r()==="transfer"&&!g()&&(z.fromLocationId=e("forms.requiredField")),q(z),Object.keys(z).length===0},C=async z=>{if(z.preventDefault(),!(!J()||!t.movement)){K(!0);try{const re=t.movement,L=Pt.getProductById(re.productId),O=Pt.getLocationById(w()),ne=g()?Pt.getLocationById(g()):null;if(!L||!O)throw new Error("Product or location not found");const X={...re,movementType:r(),quantity:parseFloat(i()),unitCost:parseFloat(s()),totalCost:parseFloat(i())*parseFloat(s()),referenceNumber:c().trim(),notes:u().trim(),locationId:w(),locationName:O.name,fromLocationId:g()||void 0,fromLocationName:ne?.name,invoiceId:x().trim()||void 0,lastModified:new Date().toISOString()};Pt.updateMovement(re.id,X),t.onMovementUpdated?.(),t.onClose(),P()}catch(re){console.error("Error updating movement:",re),q({submit:e("forms.saveError")})}finally{K(!1)}}},P=()=>{n("in"),o(""),l(""),d(""),y(""),f(""),E(""),T(""),q({})},$=()=>{P(),t.onClose()},D={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",transition:"border-color 0.2s ease"},b={display:"block","margin-bottom":"0.25rem","font-weight":"500","font-size":"0.875rem"},S={color:"#d32f2f","font-size":"0.75rem","margin-top":"0.25rem"},v={"margin-bottom":"1rem"};return I(si,{get isOpen(){return t.isOpen},onClose:$,get title(){return e("inventory.editMovement","Edit Movement")},get children(){return I(Oe,{get when(){return t.movement},get fallback(){return(()=>{var z=hl();return a(z,()=>e("common.loading")),z})()},get children(){var z=Lk(),re=z.firstChild,L=re.firstChild,O=L.nextSibling,ne=O.firstChild,X=ne.nextSibling,W=X.nextSibling,se=W.nextSibling,F=re.nextSibling,k=F.firstChild,N=k.nextSibling,A=N.firstChild,V=F.nextSibling,Z=V.firstChild,H=Z.nextSibling,B=V.nextSibling,M=B.firstChild,G=M.nextSibling,Q=B.nextSibling,ie=Q.firstChild,me=ie.nextSibling,oe=Q.nextSibling,ee=oe.firstChild,de=ee.firstChild,he=de.nextSibling;he.nextSibling;var le=ee.nextSibling,ye=oe.nextSibling,ve=ye.firstChild,pe=ve.firstChild,ge=pe.nextSibling;ge.nextSibling;var ke=ve.nextSibling,Ne=ye.nextSibling,xe=Ne.firstChild,$e=xe.nextSibling;return z.addEventListener("submit",C),a(L,()=>e("inventory.movementType")),O.addEventListener("change",Ee=>n(Ee.target.value)),a(ne,()=>e("inventory.stockIn")),a(X,()=>e("inventory.stockOut")),a(W,()=>e("inventory.transfer")),a(se,()=>e("inventory.adjustment")),a(k,(()=>{var Ee=Te(()=>r()==="transfer");return()=>Ee()?e("inventory.toLocation"):e("inventory.location")})()),N.addEventListener("change",Ee=>E(Ee.target.value)),a(A,()=>e("modals.selectLocation")),a(N,I(Ct,{get each(){return Pt.getActiveLocations()},children:Ee=>(()=>{var Me=G0(),Ye=Me.firstChild,ze=Ye.nextSibling;return ze.nextSibling,a(Me,()=>Ee.name,Ye),a(Me,()=>Ee.type,ze),fe(()=>Me.value=Ee.id),Me})()}),null),a(F,I(Oe,{get when(){return j().locationId},get children(){var Ee=hl();return a(Ee,()=>j().locationId),fe(Me=>p(Ee,S,Me)),Ee}}),null),a(z,I(Oe,{get when(){return r()==="transfer"},get children(){var Ee=kk(),Me=Ee.firstChild,Ye=Me.nextSibling,ze=Ye.firstChild;return a(Me,()=>e("inventory.fromLocation")),Ye.addEventListener("change",je=>f(je.target.value)),a(ze,()=>e("modals.selectLocation")),a(Ye,I(Ct,{get each(){return Pt.getActiveLocations().filter(je=>je.id!==w())},children:je=>(()=>{var Xe=G0(),ht=Xe.firstChild,ut=ht.nextSibling;return ut.nextSibling,a(Xe,()=>je.name,ht),a(Xe,()=>je.type,ut),fe(()=>Xe.value=je.id),Xe})()}),null),a(Ee,I(Oe,{get when(){return j().fromLocationId},get children(){var je=hl();return a(je,()=>j().fromLocationId),fe(Xe=>p(je,S,Xe)),je}}),null),fe(je=>{var Xe=v,ht=b,ut={...D,"border-color":j().fromLocationId?"#d32f2f":"var(--border-color)"},Ue=Y();return je.e=p(Ee,Xe,je.e),je.t=p(Me,ht,je.t),je.a=p(Ye,ut,je.a),Ue!==je.o&&(Ye.disabled=je.o=Ue),je},{e:void 0,t:void 0,a:void 0,o:void 0}),fe(()=>Ye.value=g()),Ee}}),V),a(Z,()=>e("common.quantity")),H.$$input=Ee=>o(Ee.target.value),a(V,I(Oe,{get when(){return j().quantity},get children(){var Ee=hl();return a(Ee,()=>j().quantity),fe(Me=>p(Ee,S,Me)),Ee}}),null),a(M,()=>e("inventory.unitCost")),G.$$input=Ee=>l(Ee.target.value),a(B,I(Oe,{get when(){return j().unitCost},get children(){var Ee=hl();return a(Ee,()=>j().unitCost),fe(Me=>p(Ee,S,Me)),Ee}}),null),a(z,I(Oe,{get when(){return Te(()=>!!i())()&&s()},get children(){var Ee=Nk(),Me=Ee.firstChild,Ye=Me.firstChild,ze=Ye.firstChild,je=Ye.nextSibling;return je.firstChild,Me.style.setProperty("display","flex"),Me.style.setProperty("justify-content","space-between"),Ye.style.setProperty("font-weight","500"),a(Ye,()=>e("common.total"),ze),je.style.setProperty("font-weight","600"),je.style.setProperty("color","var(--primary-color)"),a(je,()=>(parseFloat(i()||"0")*parseFloat(s()||"0")).toFixed(2),null),fe(Xe=>p(Ee,{...v,padding:"0.75rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)"},Xe)),Ee}}),Q),a(ie,()=>e("inventory.referenceNumber")),me.$$input=Ee=>d(Ee.target.value),a(Q,I(Oe,{get when(){return j().referenceNumber},get children(){var Ee=hl();return a(Ee,()=>j().referenceNumber),fe(Me=>p(Ee,S,Me)),Ee}}),null),a(ee,()=>e("inventory.invoiceNumber"),de),a(ee,()=>e("common.optional"),he),le.$$input=Ee=>T(Ee.target.value),a(ve,()=>e("common.notes"),pe),a(ve,()=>e("common.optional"),ge),ke.$$input=Ee=>y(Ee.target.value),a(z,I(Oe,{get when(){return j().submit},get children(){var Ee=hl();return a(Ee,()=>j().submit),fe(Me=>p(Ee,{...S,"margin-bottom":"1rem"},Me)),Ee}}),Ne),Ne.style.setProperty("display","flex"),Ne.style.setProperty("gap","1rem"),Ne.style.setProperty("justify-content","flex-end"),xe.$$click=$,xe.style.setProperty("padding","0.5rem 1rem"),xe.style.setProperty("border","1px solid var(--border-color)"),xe.style.setProperty("border-radius","var(--border-radius-sm)"),xe.style.setProperty("background","white"),xe.style.setProperty("cursor","pointer"),a(xe,()=>e("common.cancel")),$e.style.setProperty("padding","0.5rem 1rem"),$e.style.setProperty("border","none"),$e.style.setProperty("border-radius","var(--border-radius-sm)"),$e.style.setProperty("background","var(--primary-color)"),$e.style.setProperty("color","white"),$e.style.setProperty("cursor","pointer"),$e.style.setProperty("font-weight","500"),a($e,(()=>{var Ee=Te(()=>!!Y());return()=>Ee()?e("modals.processing"):e("inventory.updateMovement","Update Movement")})()),fe(Ee=>{var Me=v,Ye=b,ze=D,je=Y(),Xe=v,ht=b,ut={...D,"border-color":j().locationId?"#d32f2f":"var(--border-color)"},Ue=Y(),it=v,dt=b,Fe={...D,"border-color":j().quantity?"#d32f2f":"var(--border-color)"},Be=e("modals.enterQuantity"),Re=Y(),lt=v,ot=b,nt={...D,"border-color":j().unitCost?"#d32f2f":"var(--border-color)"},Ve=e("modals.enterCost"),qt=Y(),Mt=v,Qt=b,lr={...D,"border-color":j().referenceNumber?"#d32f2f":"var(--border-color)"},bt=e("modals.enterReference"),yr=Y(),Cr=v,Kt=b,sr=D,pt=e("inventory.invoiceNumber"),gt=Y(),Vt=v,gr=b,et={...D,resize:"vertical","min-height":"80px"},ft=e("modals.addNotes"),At=Y(),Yt=Y(),hr=Y();return Ee.e=p(re,Me,Ee.e),Ee.t=p(L,Ye,Ee.t),Ee.a=p(O,ze,Ee.a),je!==Ee.o&&(O.disabled=Ee.o=je),Ee.i=p(F,Xe,Ee.i),Ee.n=p(k,ht,Ee.n),Ee.s=p(N,ut,Ee.s),Ue!==Ee.h&&(N.disabled=Ee.h=Ue),Ee.r=p(V,it,Ee.r),Ee.d=p(Z,dt,Ee.d),Ee.l=p(H,Fe,Ee.l),Be!==Ee.u&&ir(H,"placeholder",Ee.u=Be),Re!==Ee.c&&(H.disabled=Ee.c=Re),Ee.w=p(B,lt,Ee.w),Ee.m=p(M,ot,Ee.m),Ee.f=p(G,nt,Ee.f),Ve!==Ee.y&&ir(G,"placeholder",Ee.y=Ve),qt!==Ee.g&&(G.disabled=Ee.g=qt),Ee.p=p(Q,Mt,Ee.p),Ee.b=p(ie,Qt,Ee.b),Ee.T=p(me,lr,Ee.T),bt!==Ee.A&&ir(me,"placeholder",Ee.A=bt),yr!==Ee.O&&(me.disabled=Ee.O=yr),Ee.I=p(oe,Cr,Ee.I),Ee.S=p(ee,Kt,Ee.S),Ee.W=p(le,sr,Ee.W),pt!==Ee.C&&ir(le,"placeholder",Ee.C=pt),gt!==Ee.B&&(le.disabled=Ee.B=gt),Ee.v=p(ye,Vt,Ee.v),Ee.k=p(ve,gr,Ee.k),Ee.x=p(ke,et,Ee.x),ft!==Ee.j&&ir(ke,"placeholder",Ee.j=ft),At!==Ee.q&&(ke.disabled=Ee.q=At),Yt!==Ee.z&&(xe.disabled=Ee.z=Yt),hr!==Ee.P&&($e.disabled=Ee.P=hr),Ee},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0,z:void 0,P:void 0}),fe(()=>O.value=r()),fe(()=>N.value=w()),fe(()=>H.value=i()),fe(()=>G.value=s()),fe(()=>me.value=c()),fe(()=>le.value=x()),fe(()=>ke.value=u()),z}})}})};br(["input","click"]);var Dk=ae("<div><div></div><div><div><label></label><select><option value=all></option><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),Mk=ae("<div><h2>"),Fk=ae("<div><label>"),Ok=ae("<div><label></label><select><option value>"),Bk=ae("<option>"),jk=ae("<div><div></div><div></div><div>"),Vk=ae("<div><div><div><div><span></span><h3></h3><span></span></div><div>  </div></div><div><div></div><div> <!> @ </div></div></div><div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div><span>:</span><span>"),qk=ae("<span>"),zk=ae("<span> <!>: "),W0=ae("<div><span>:</span><span>"),Uk=ae("<div><div><span>:</span><select><option value=10>10</option><option value=25>25</option><option value=50>50</option><option value=100>100</option></select><span></span></div><div><div><span>:</span><input type=number min=1><span> "),Hk=ae("<span>..."),Gk=ae("<button>");const Wk=t=>{const{t:e}=_r(),[r,n]=we(""),[i,o]=we(""),[s,l]=we("all"),[c,d]=we({start:"",end:""}),[u,y]=we(""),[g,f]=we(""),[w,E]=we(1),[x,T]=we(25),[Y,K]=we(null),[j,q]=we(!1),[J,C]=we(!1),P=Ut(()=>{let le=Pt.movements;if(t.filterBy==="product"&&t.filterId?le=le.filter(ye=>ye.productId===t.filterId):t.filterBy==="location"&&t.filterId&&(le=le.filter(ye=>ye.locationId===t.filterId)),r()&&(le=le.filter(ye=>ye.productId===r())),i()&&(le=le.filter(ye=>ye.locationId===i())),s()!=="all"&&(le=le.filter(ye=>ye.movementType===s())),c().start&&(le=le.filter(ye=>ye.createdDate>=c().start)),c().end&&(le=le.filter(ye=>ye.createdDate<=c().end+"T23:59:59Z")),u()){const ye=u().toLowerCase();le=le.filter(ve=>ve.productName.toLowerCase().includes(ye)||ve.productSku.toLowerCase().includes(ye)||ve.locationName.toLowerCase().includes(ye)||ve.referenceNumber.toLowerCase().includes(ye)||ve.notes.toLowerCase().includes(ye)||ve.createdBy.toLowerCase().includes(ye)||ve.invoiceId&&ve.invoiceId.toLowerCase().includes(ye)||ve.fromLocationName&&ve.fromLocationName.toLowerCase().includes(ye)||ve.movementType.toLowerCase().includes(ye))}return le.sort((ye,ve)=>new Date(ve.createdDate).getTime()-new Date(ye.createdDate).getTime())});xi(()=>{r(),i(),s(),c(),u(),E(1)});const $=Ut(()=>{const le=(w()-1)*x(),ye=le+x();return P().slice(le,ye)}),D=Ut(()=>Math.ceil(P().length/x())),b=Ut(()=>{const le=P();return{total:le.length,stockIn:le.filter(ye=>ye.movementType==="in").length,stockOut:le.filter(ye=>ye.movementType==="out").length,transfers:le.filter(ye=>ye.movementType==="transfer").length,adjustments:le.filter(ye=>ye.movementType==="adjustment").length,totalValue:le.reduce((ye,ve)=>ye+ve.totalCost,0)}}),S={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},v={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},z={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)",cursor:"pointer"},re={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},L={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem","margin-bottom":"2rem"},O={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","text-align":"center"},ne={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},X={"font-size":"0.875rem",color:"var(--text-muted)","font-weight":"500"},W={padding:"1.5rem","margin-bottom":"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",transition:"all 0.2s ease"},se={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"1rem"};function F(le){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[le]||{bg:"#f5f5f5",color:"#666"}}const k=le=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:F(le).bg,color:F(le).color}),N={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"1rem"},A={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.5rem 0","border-bottom":"1px solid var(--border-color)"},V={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},Z={"font-weight":"600",color:"var(--text-primary)"},H={display:"flex","justify-content":"space-between","align-items":"center","margin-top":"2rem",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},B=le=>({padding:"0.25rem 0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:le?"var(--primary-color)":"var(--surface-color)",color:le?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),M=le=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(le),G=le=>new Date(le).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),Q=le=>({in:"",out:"",transfer:"",adjustment:""})[le]||"",ie=()=>{n(""),o(""),l("all"),d({start:"",end:""}),y(""),E(1)},me=le=>{K(le),q(!0)},oe=le=>{K(le),q(!1),C(!0)},ee=()=>{C(!1),K(null)},de=async le=>{i()&&(le+=" "+i()),cf(s())&&(le+=" "+cf(s()));const ye=await qi.getInventory(le),ve=Pt.parseInventoryData(ye);Pt.updMovements(ve)},he=()=>{};return(()=>{var le=Dk(),ye=le.firstChild,ve=ye.nextSibling,pe=ve.firstChild,ge=pe.firstChild,ke=ge.nextSibling,Ne=ke.firstChild,xe=Ne.nextSibling,$e=xe.nextSibling,Ee=$e.nextSibling,Me=Ee.nextSibling,Ye=pe.nextSibling,ze=Ye.firstChild,je=ze.nextSibling,Xe=Ye.nextSibling,ht=Xe.firstChild,ut=ht.nextSibling,Ue=ve.nextSibling,it=Ue.firstChild,dt=it.firstChild,Fe=dt.nextSibling,Be=it.nextSibling,Re=Be.firstChild,lt=Re.nextSibling,ot=Be.nextSibling,nt=ot.firstChild,Ve=nt.nextSibling,qt=ot.nextSibling,Mt=qt.firstChild,Qt=Mt.nextSibling,lr=qt.nextSibling,bt=lr.firstChild,yr=bt.nextSibling,Cr=lr.nextSibling,Kt=Cr.firstChild,sr=Kt.nextSibling;return a(le,(()=>{var pt=Te(()=>!t.filterBy);return()=>pt()&&(()=>{var gt=Mk(),Vt=gt.firstChild;return p(gt,S),Vt.style.setProperty("margin","0"),Vt.style.setProperty("font-size","1.5rem"),a(Vt,()=>e("inventory.movements")),a(gt,I(_t,{variant:"outline",onClick:ie,get children(){return e("common.clearFilters")}}),null),gt})()})(),ye),a(le,I(Ak,{filters:{selectedLocation:i,movementType:s},onSearchResults:pt=>{f(pt),de(pt)},get placeholder(){return e("inventory.searchProductsStock","Search inventories...")},showResults:!1,maxResults:20}),ye),ye.style.setProperty("margin","20px"),p(ve,v),a(ve,(()=>{var pt=Te(()=>!t.filterBy);return()=>pt()&&[(()=>{var gt=Fk(),Vt=gt.firstChild;return Vt.style.setProperty("display","block"),Vt.style.setProperty("margin-bottom","0.5rem"),Vt.style.setProperty("font-weight","500"),a(Vt,()=>e("inventory.product")),a(gt,I(Ap,{onChange:gr=>{console.log(gr),n(gr.id)},get placeholder(){return e("inventory.searchProductsImages","Search products to view images...")}}),null),gt})(),(()=>{var gt=Ok(),Vt=gt.firstChild,gr=Vt.nextSibling,et=gr.firstChild;return Vt.style.setProperty("display","block"),Vt.style.setProperty("margin-bottom","0.5rem"),Vt.style.setProperty("font-weight","500"),a(Vt,()=>e("inventory.location")),gr.addEventListener("change",ft=>o(ft.target.value)),a(et,()=>e("inventory.allLocations")),a(gr,I(Ct,{get each(){return Pt.locations},children:ft=>(()=>{var At=Bk();return a(At,()=>ft.name),fe(()=>At.value=ft.id),At})()}),null),fe(ft=>p(gr,z,ft)),fe(()=>gr.value=i()),gt})()]})(),pe),ge.style.setProperty("display","block"),ge.style.setProperty("margin-bottom","0.5rem"),ge.style.setProperty("font-weight","500"),a(ge,()=>e("inventory.movementType")),ke.addEventListener("change",pt=>{l(pt.target.value),de(g())}),a(Ne,()=>e("inventory.allTypes")),a(xe,()=>e("inventory.stockIn")),a($e,()=>e("inventory.stockOut")),a(Ee,()=>e("inventory.transfer")),a(Me,()=>e("inventory.adjustment")),ze.style.setProperty("display","block"),ze.style.setProperty("margin-bottom","0.5rem"),ze.style.setProperty("font-weight","500"),a(ze,()=>e("common.startDate")),je.addEventListener("change",pt=>d(gt=>({...gt,start:pt.target.value}))),ht.style.setProperty("display","block"),ht.style.setProperty("margin-bottom","0.5rem"),ht.style.setProperty("font-weight","500"),a(ht,()=>e("common.endDate")),ut.addEventListener("change",pt=>d(gt=>({...gt,end:pt.target.value}))),p(Ue,L),a(dt,()=>b().total),a(Fe,()=>e("inventory.totalMovements")),a(Re,()=>b().stockIn),a(lt,()=>e("inventory.stockIn")),a(nt,()=>b().stockOut),a(Ve,()=>e("inventory.stockOut")),a(Mt,()=>b().transfers),a(Qt,()=>e("inventory.transfers")),a(bt,()=>b().adjustments),a(yr,()=>e("inventory.adjustments")),Kt.$$click=he,a(Kt,()=>M(b().totalValue)),a(sr,()=>e("inventory.totalValue")),a(le,(()=>{var pt=Te(()=>$().length===0);return()=>pt()?(()=>{var gt=jk(),Vt=gt.firstChild,gr=Vt.nextSibling,et=gr.nextSibling;return gt.style.setProperty("text-align","center"),gt.style.setProperty("padding","3rem"),gt.style.setProperty("color","var(--text-muted)"),gt.style.setProperty("background","var(--surface-color)"),gt.style.setProperty("border-radius","var(--border-radius)"),gt.style.setProperty("border","1px solid var(--border-color)"),Vt.style.setProperty("font-size","1.5rem"),Vt.style.setProperty("margin-bottom","1rem"),gr.style.setProperty("font-size","1.1rem"),gr.style.setProperty("margin-bottom","0.5rem"),a(gr,()=>e("inventory.noMovementsFound")),et.style.setProperty("font-size","0.875rem"),a(et,()=>e("inventory.tryAdjustingFilters")),gt})():[I(Ct,{get each(){return $()},children:gt=>(()=>{var Vt=Vk(),gr=Vt.firstChild,et=gr.firstChild,ft=et.firstChild,At=ft.firstChild,Yt=At.nextSibling,hr=Yt.nextSibling,Pr=ft.nextSibling,Jr=Pr.firstChild,Tr=et.nextSibling,zr=Tr.firstChild,Xr=zr.nextSibling,pr=Xr.firstChild,Jt=pr.nextSibling;Jt.nextSibling;var Yr=gr.nextSibling,Lr=Yr.firstChild,We=Lr.firstChild,Bt=We.firstChild,Ft=Bt.firstChild,Ht=Bt.nextSibling,Ke=We.nextSibling,Zt=Ke.firstChild,Wt=Zt.firstChild,xr=Zt.nextSibling,Hr=Lr.nextSibling,mr=Hr.firstChild,Vr=mr.firstChild,Qr=Vr.firstChild,hn=Vr.nextSibling;return Vt.addEventListener("mouseleave",Nt=>{Nt.currentTarget.style.transform="translateY(0)",Nt.currentTarget.style.boxShadow="none"}),Vt.addEventListener("mouseenter",Nt=>{Nt.currentTarget.style.transform="translateY(-2px)",Nt.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),Vt.$$click=()=>me(gt),p(gr,se),ft.style.setProperty("display","flex"),ft.style.setProperty("align-items","center"),ft.style.setProperty("gap","0.5rem"),ft.style.setProperty("margin-bottom","0.5rem"),At.style.setProperty("font-size","1.2rem"),a(At,()=>Q(gt.movementType)),Yt.style.setProperty("margin","0"),Yt.style.setProperty("font-size","1.1rem"),a(Yt,()=>gt.productName),a(hr,()=>gt.movementType),a(ft,(()=>{var Nt=Te(()=>!!gt.invoiceId);return()=>Nt()&&(()=>{var tr=qk();return tr.style.setProperty("padding","0.2rem 0.5rem"),tr.style.setProperty("border-radius","var(--border-radius-sm)"),tr.style.setProperty("font-size","0.7rem"),tr.style.setProperty("font-weight","500"),tr.style.setProperty("background","var(--primary-color)"),tr.style.setProperty("color","white"),a(tr,()=>e("inventory.bulk")),tr})()})(),null),Pr.style.setProperty("font-size","0.875rem"),Pr.style.setProperty("color","var(--text-muted)"),a(Pr,()=>gt.productSku,Jr),a(Pr,()=>G(gt.createdDate),null),a(Pr,(()=>{var Nt=Te(()=>!!gt.invoiceId);return()=>Nt()&&(()=>{var tr=zk(),ur=tr.firstChild,Ar=ur.nextSibling;return Ar.nextSibling,tr.style.setProperty("margin-left","0.5rem"),tr.style.setProperty("font-weight","500"),a(tr,()=>e("common.invoice"),Ar),a(tr,()=>gt.invoiceId,null),tr})()})(),null),Tr.style.setProperty("text-align","right"),zr.style.setProperty("font-size","1.25rem"),zr.style.setProperty("font-weight","700"),zr.style.setProperty("color","var(--primary-color)"),a(zr,()=>M(gt.totalCost)),Xr.style.setProperty("font-size","0.875rem"),Xr.style.setProperty("color","var(--text-muted)"),a(Xr,()=>gt.quantity,pr),a(Xr,()=>e("common.units"),Jt),a(Xr,()=>M(gt.unitCost),null),p(Yr,N),a(Bt,()=>e("inventory.location"),Ft),a(Ht,()=>gt.locationName),a(Lr,(()=>{var Nt=Te(()=>!!gt.fromLocationName);return()=>Nt()&&(()=>{var tr=W0(),ur=tr.firstChild,Ar=ur.firstChild,Rt=ur.nextSibling;return a(ur,()=>e("common.from"),Ar),a(Rt,()=>gt.fromLocationName),fe(vt=>{var St=A,jt=V,Et=Z;return vt.e=p(tr,St,vt.e),vt.t=p(ur,jt,vt.t),vt.a=p(Rt,Et,vt.a),vt},{e:void 0,t:void 0,a:void 0}),tr})()})(),Ke),a(Zt,()=>e("common.reference"),Wt),a(xr,()=>gt.referenceNumber),a(Vr,()=>e("common.createdBy"),Qr),a(hn,()=>gt.createdBy),a(Hr,(()=>{var Nt=Te(()=>!!gt.notes);return()=>Nt()&&(()=>{var tr=W0(),ur=tr.firstChild,Ar=ur.firstChild,Rt=ur.nextSibling;return a(ur,()=>e("common.notes"),Ar),a(Rt,()=>gt.notes),fe(vt=>{var St={...A,"border-bottom":"none"},jt=V,Et={...Z,"max-width":"200px","text-align":"right","font-style":"italic"};return vt.e=p(tr,St,vt.e),vt.t=p(ur,jt,vt.t),vt.a=p(Rt,Et,vt.a),vt},{e:void 0,t:void 0,a:void 0}),tr})()})(),null),fe(Nt=>{var tr={...W,"border-left":gt.invoiceId?"4px solid var(--primary-color)":"1px solid var(--border-color)",cursor:"pointer"},ur=k(gt.movementType),Ar=A,Rt=V,vt=Z,St=A,jt=V,Et=Z,cr=A,Wr=V,Kr=Z;return Nt.e=p(Vt,tr,Nt.e),Nt.t=p(hr,ur,Nt.t),Nt.a=p(We,Ar,Nt.a),Nt.o=p(Bt,Rt,Nt.o),Nt.i=p(Ht,vt,Nt.i),Nt.n=p(Ke,St,Nt.n),Nt.s=p(Zt,jt,Nt.s),Nt.h=p(xr,Et,Nt.h),Nt.r=p(mr,cr,Nt.r),Nt.d=p(Vr,Wr,Nt.d),Nt.l=p(hn,Kr,Nt.l),Nt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),Vt})()}),Te(()=>Te(()=>D()>1)()&&(()=>{var gt=Uk(),Vt=gt.firstChild,gr=Vt.firstChild,et=gr.firstChild,ft=gr.nextSibling,At=ft.nextSibling,Yt=Vt.nextSibling,hr=Yt.firstChild,Pr=hr.firstChild,Jr=Pr.firstChild,Tr=Pr.nextSibling,zr=Tr.nextSibling,Xr=zr.firstChild;return p(gt,H),Vt.style.setProperty("display","flex"),Vt.style.setProperty("align-items","center"),Vt.style.setProperty("gap","0.5rem"),gr.style.setProperty("font-size","0.875rem"),gr.style.setProperty("color","var(--text-muted)"),a(gr,()=>e("common.showPerPage","Show per page"),et),ft.addEventListener("change",pr=>{T(Number(pr.target.value)),E(1)}),ft.style.setProperty("padding","0.25rem 0.5rem"),ft.style.setProperty("border","1px solid var(--border-color)"),ft.style.setProperty("border-radius","var(--border-radius-sm)"),ft.style.setProperty("background","var(--surface-color)"),ft.style.setProperty("cursor","pointer"),ft.style.setProperty("font-size","0.875rem"),At.style.setProperty("font-size","0.875rem"),At.style.setProperty("color","var(--text-muted)"),At.style.setProperty("margin-left","1rem"),a(At,()=>e("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:(w()-1)*x()+1,end:Math.min(w()*x(),P().length),total:P().length})),Yt.style.setProperty("display","flex"),Yt.style.setProperty("align-items","center"),Yt.style.setProperty("gap","0.5rem"),a(Yt,I(_t,{variant:"outline",size:"sm",onClick:()=>E(1),get disabled(){return w()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.first","First")}}),hr),a(Yt,I(_t,{variant:"outline",size:"sm",onClick:()=>E(pr=>Math.max(1,pr-1)),get disabled(){return w()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.previous")}}),hr),a(Yt,()=>{const pr=[],Jt=D(),Yr=w();if(Jt<=7)for(let Lr=1;Lr<=Jt;Lr++)pr.push(Lr);else{pr.push(1),Yr>3&&pr.push("...");for(let Lr=Math.max(2,Yr-1);Lr<=Math.min(Jt-1,Yr+1);Lr++)pr.includes(Lr)||pr.push(Lr);Yr<Jt-2&&pr.push("..."),pr.includes(Jt)||pr.push(Jt)}return I(Ct,{each:pr,children:Lr=>Lr==="..."?(()=>{var We=Hk();return We.style.setProperty("padding","0 0.5rem"),We.style.setProperty("color","var(--text-muted)"),We})():(()=>{var We=Gk();return We.$$click=()=>E(Lr),a(We,Lr),fe(Bt=>p(We,B(Lr===w()),Bt)),We})()})},hr),a(Yt,I(_t,{variant:"outline",size:"sm",onClick:()=>E(pr=>Math.min(D(),pr+1)),get disabled(){return w()===D()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.next")}}),hr),a(Yt,I(_t,{variant:"outline",size:"sm",onClick:()=>E(D()),get disabled(){return w()===D()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.last","Last")}}),hr),hr.style.setProperty("display","flex"),hr.style.setProperty("align-items","center"),hr.style.setProperty("gap","0.5rem"),hr.style.setProperty("margin-left","1rem"),Pr.style.setProperty("font-size","0.875rem"),Pr.style.setProperty("color","var(--text-muted)"),a(Pr,()=>e("common.page","Page"),Jr),Tr.addEventListener("change",pr=>{const Jt=Number(pr.target.value);Jt>=1&&Jt<=D()&&E(Jt)}),Tr.style.setProperty("width","4rem"),Tr.style.setProperty("padding","0.25rem 0.5rem"),Tr.style.setProperty("border","1px solid var(--border-color)"),Tr.style.setProperty("border-radius","var(--border-radius-sm)"),Tr.style.setProperty("background","var(--surface-color)"),Tr.style.setProperty("text-align","center"),Tr.style.setProperty("font-size","0.875rem"),zr.style.setProperty("font-size","0.875rem"),zr.style.setProperty("color","var(--text-muted)"),a(zr,()=>e("common.of","of"),Xr),a(zr,D,null),fe(()=>ir(Tr,"max",D())),fe(()=>ft.value=x()),fe(()=>Tr.value=w()),gt})())]})(),null),a(le,I(Tk,{get isOpen(){return j()},onClose:()=>{q(!1),K(null)},get movement(){return Y()},onEdit:oe}),null),a(le,I(Oe,{get when(){return vr.hasPermission("read_write")},get children(){return I(Rk,{get isOpen(){return J()},onClose:()=>{C(!1),K(null)},get movement(){return Y()},onMovementUpdated:ee})}}),null),fe(pt=>{var gt=z,Vt=re,gr=re,et=O,ft=ne,At=X,Yt=O,hr={...ne,color:"#2d7d32"},Pr=X,Jr=O,Tr={...ne,color:"#d32f2f"},zr=X,Xr=O,pr={...ne,color:"#1976d2"},Jt=X,Yr=O,Lr={...ne,color:"#f57c00"},We=X,Bt=O,Ft=ne,Ht=X;return pt.e=p(ke,gt,pt.e),pt.t=p(je,Vt,pt.t),pt.a=p(ut,gr,pt.a),pt.o=p(it,et,pt.o),pt.i=p(dt,ft,pt.i),pt.n=p(Fe,At,pt.n),pt.s=p(Be,Yt,pt.s),pt.h=p(Re,hr,pt.h),pt.r=p(lt,Pr,pt.r),pt.d=p(ot,Jr,pt.d),pt.l=p(nt,Tr,pt.l),pt.u=p(Ve,zr,pt.u),pt.c=p(qt,Xr,pt.c),pt.w=p(Mt,pr,pt.w),pt.m=p(Qt,Jt,pt.m),pt.f=p(lr,Yr,pt.f),pt.y=p(bt,Lr,pt.y),pt.g=p(yr,We,pt.g),pt.p=p(Cr,Bt,pt.p),pt.b=p(Kt,Ft,pt.b),pt.T=p(sr,Ht,pt.T),pt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),fe(()=>ke.value=s()),fe(()=>je.value=c().start),fe(()=>ut.value=c().end),le})()};br(["click"]);var Yk=ae("<div><p> "),Kk=ae("<div>"),Jk=ae("<div><div></div><h3></h3><p></p><div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=name></option><option value=sku></option><option value=category>"),Qk=ae("<div><div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div>%</div><div></div></div></div><div></div><div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),Xk=ae("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),Zk=ae("<div><div></div><h3></h3><p>"),e6=ae("<div><div><h3> </h3><p></p></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div></div><div>"),t6=ae("<div><div><div><h2> </h2><button>"),Y0=ae("<option>"),r6=ae("<div>..."),n6=ae("<tr><td><div></div><div>  </div></td><td><div></div></td><td><div></div></td><td><div></div></td><td><div>"),i6=ae("<tr><td><div></div></td><td><div></div><div>  <!>  </div></td><td><div></div></td><td><input type=number placeholder=0 min=0 step=0.01></td><td><div></div></td><td><input type=text>");const o6=t=>{const{t:e}=_r(),[r,n]=we([]),[i,o]=we(!1),[s,l]=we(!1),[c,d]=we("all"),[u,y]=we("all"),[g,f]=we("name"),[w,E]=we([]),[x,T]=we("setup"),Y=async()=>{try{o(!0);const X=await qi.getProducts("prod");if(!X||typeof X!="object"){console.warn("No API results, using local store"),n(Pt.products);return}const W=Object.keys(X),se=k=>{let A=X[k];return{id:k,name:A.name||"Unknown Product",businessId:A.businessId||"",sku:A.code||A.sku||"",UPC:A.UPC||"",numCode:A.codeN||"",category:A.category||"General",unitCost:A.unitCost||0,unitOfMeasure:A.unitOfMeasure||"pcs",minStockLevel:A.minStockLevel||0,maxStockLevel:A.maxStockLevel||100,isActive:A.isActive!==!1,description:A.description||"",createdDate:A.createdAt||new Date().toISOString(),lastModified:A.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(A.sellingPrice||A.price||"0")}},F=W.map(se);n(F)}catch(X){console.error("Failed to load products from API:",X),n(Pt.products)}finally{o(!1)}},K=Ut(()=>[...new Set(r().map(W=>W.category).filter(W=>W))].sort()),j=Ut(()=>{let X=r().filter(W=>W.isActive);return u()!=="all"&&(X=X.filter(W=>W.category===u())),X.sort((W,se)=>{switch(g()){case"name":return W.name.localeCompare(se.name);case"sku":return W.sku.localeCompare(se.sku);case"category":return W.category.localeCompare(se.category)||W.name.localeCompare(se.name);default:return 0}}),X}),q=Ut(()=>Pt.getActiveLocations()),J=(X,W)=>W&&W!=="all"?Pt.getStockByProductAndLocation(X,W)?.quantity||0:Pt.getTotalStockByProduct(X),C=()=>{const X=j().map(W=>{const se=J(W.id,c()!=="all"?c():void 0);return{productId:W.id,systemQuantity:se,physicalCount:null,notes:"",variance:0,product:W}});E(X),T("counting")},P=(X,W)=>{E(se=>se.map(F=>{if(F.productId===X){const k=W,N=k!==null?k-F.systemQuantity:0;return{...F,physicalCount:k,variance:N}}return F}))},$=(X,W)=>{E(se=>se.map(F=>F.productId===X?{...F,notes:W}:F))},D=Ut(()=>{const X=w(),W=X.length,se=X.filter(A=>A.physicalCount!==null).length,F=X.filter(A=>A.variance!==0).length,k=X.filter(A=>A.variance>0).length,N=X.filter(A=>A.variance<0).length;return{totalProducts:W,countedProducts:se,remainingProducts:W-se,variances:F,positiveVariances:k,negativeVariances:N,isComplete:se===W}}),b=()=>{const X=w().filter(k=>k.physicalCount!==null&&k.variance!==0);if(X.length===0)return null;const W=[e("inventory.product","Product"),e("inventory.sku","SKU"),e("inventory.category","Category"),e("inventory.location","Location"),e("inventory.systemQty","System Qty"),e("inventory.physicalCount","Physical Count"),e("inventory.variance","Variance"),e("inventory.adjustment","Adjustment"),e("common.notes","Notes"),e("common.date","Date")],se=X.map(k=>[`"${k.product.name}"`,`"${k.product.sku}"`,`"${k.product.category}"`,`"${z()}"`,k.systemQuantity,k.physicalCount,k.variance,k.variance>0?e("inventory.stockIncrease","Stock Increase"):e("inventory.stockDecrease","Stock Decrease"),`"${k.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")}"`,`"${re()}"`]);return[W.join(","),...se.map(k=>k.join(","))].join(`
`)},S=()=>{const X=b();if(!X){alert(e("inventory.noAdjustmentsToDownload","No adjustments to download"));return}const W=new Blob([X],{type:"text/csv;charset=utf-8;"}),se=document.createElement("a");if(se.download!==void 0){const F=URL.createObjectURL(W);se.setAttribute("href",F),se.setAttribute("download",`inventory-adjustments-${re().replace(/[/:,\s]/g,"-")}.csv`),se.style.visibility="hidden",document.body.appendChild(se),se.click(),document.body.removeChild(se)}},v=async(X=!0)=>{try{l(!0),console.log(w());const W=V=>{let Z=Pt.getProductById(V.productId),H=Pt.getStockByProductAndLocation(V.productId,c()),B=parseFloat(H?.averageCost+""),M=parseFloat(H?.quantity+"");return{product:{id:V.productId,label:Z?.name,code:Z?.code},productId:V?.productId,reason:"Physical Count Adjustment",notes:V?.notes||"Physical inventory adjustment",quantity:V?.variance,unitCost:B}},se=w().filter(V=>V.physicalCount!==null&&V.variance!==0).map(W);let F="ADJ_"+Wg();const k=new Date().toISOString(),N={ssg_inventory_key:Nl(),invoiceId:F,referenceNumber:Wg(),movementType:"adjustment",type:"adjustment",locationId:c(),items:se,products:se,generalNotes:"Physical inventory adjustment",description:"Physical Count Adjustment",invoice:F,store:c(),createdBy:"admin",createDate:k};console.log("Saving inventory bulkRequest:",N);const A=await qi.addInventory(N);X&&se.length>0&&S(),console.log("Saving inventory adjustments:",se),await new Promise(V=>setTimeout(V,1e3)),t.onClose()}catch(W){console.error("Failed to save inventory adjustments:",W)}finally{l(!1)}},z=Ut(()=>c()==="all"?"All Locations":q().find(W=>W.id===c())?.name||"Unknown Location"),re=()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),L=async()=>{await Pt.fecthInventory("prod"),await Y()};jn(async()=>{t.selectedLocationId&&d(t.selectedLocationId),L()});const O=()=>{const X=window.open("","_blank");if(!X){alert("Please allow pop-ups to print the counting sheet");return}const W=ne();X.document.write(W),X.document.close(),X.onload=()=>{X.print(),X.onafterprint=()=>{X.close()}}},ne=()=>{const X=j().map((W,se)=>{const F=J(W.id,c()!=="all"?c():void 0);return`
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${se+1}</td>
          <td style="border: 1px solid #000; padding: 8px; font-family: monospace;">${W.sku}</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 500;">${W.name}</div>
            ${W.UPC?`<div style="font-size: 0.8em; color: #666;">UPC: ${W.UPC}</div>`:""}
          </td>
         
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${W.unitOfMeasure}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">${F}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; background-color: #f9f9f9;"></td>
          <td style="border: 1px solid #000; padding: 8px;"></td>
        </tr>
      `}).join("");return`
      <!DOCTYPE html>
      <html>
      <head>
        <title> ${z()}_${u()}_${e("inventory.countingSheet","Inventory Counting Sheet")} - ${re()}</title>
        <style>
          @page {
            size: letter;
            margin: 0.5in 0.8in 0.5in 0.8in;
            @top-center {
              content: "${z()} | ${u()==="all"?e("inventory.allCategories","All Categories"):u()} | Page " counter(page);
              font-size: 10px;
              font-weight: bold;
              border-bottom: 1px solid #ccc;
              padding-bottom: 5px;
            }
          }
          body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            margin: 0;
            padding: 0;
            position: relative;
          }
          .page-identifier {
            position: fixed;
            left: 5px;
            top: 50%;
            transform: rotate(-90deg) translateX(-50%);
            transform-origin: left center;
            background: #f0f0f0;
            padding: 5px 15px;
            border: 1px solid #ccc;
            font-weight: bold;
            font-size: 10px;
            color: #333;
            z-index: 100;
          }
          .page-identifier-right {
            position: fixed;
            right: 5px;
            top: 50%;
            transform: rotate(90deg) translateX(50%);
            transform-origin: right center;
            background: #f0f0f0;
            padding: 5px 15px;
            border: 1px solid #ccc;
            font-weight: bold;
            font-size: 10px;
            color: #333;
            z-index: 100;
          }
          h1 {
            text-align: center;
            margin: 0 0 10px 0;
            font-size: 22px;
            page-break-after: avoid;
          }
          .header-info {
            text-align: center;
            margin-bottom: 20px;
            background: #f8f8f8;
            padding: 10px;
            border: 2px solid #333;
            page-break-after: avoid;
          }
          .page-header {
            display: none;
            text-align: center;
            background: #e0e0e0;
            padding: 8px;
            border: 1px solid #333;
            margin-bottom: 10px;
            font-weight: bold;
            font-size: 11px;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
          }
          th {
            background-color: #333;
            color: white;
            padding: 8px;
            text-align: left;
            font-weight: bold;
            border: 1px solid #000;
          }
          .summary-table {
            width: 50%;
            margin: 20px auto;
            /*page-break-before: auto;*/
          }
          .signature-section {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
            page-break-before: auto;
          }
          .signature-box {
            width: 45%;
            text-align: center;
          }
          .signature-line {
            border-bottom: 1px solid #000;
            margin-bottom: 5px;
            height: 30px;
          }
          @media print {
            body { margin: 0; }
            .page-identifier, .page-identifier-right { display: block; }
            .page-header { display: block; }
            tr { page-break-inside: avoid; }
            thead { display: table-header-group; }
            tfoot { display: table-footer-group; }
            .header-info { page-break-after: avoid; }
            h1 { page-break-after: avoid; }
            table { page-break-before: auto; }
            /*.summary-table { page-break-before: always; }*/
            .signature-section { page-break-before: avoid; }
            
            /* Repeat headers on each page */
            @page :first {
              @top-center { content: none; }
            }
            
            /* Force page headers to show on continuation pages */
            tbody::before {
              content: "";
              display: block;
              height: 0;
            }
          }
        </style>
      </head>
      <body>
        <!-- Page identifiers for multi-page documents -->
        <div class="page-identifier-right">
          ${z()} - ${u()==="all"?e("inventory.allCategories","All Categories"):u()} - ${re()} 
        </div>
       
        
        <h1>${e("inventory.inventoryCountingSheetTitle","INVENTORY COUNTING SHEET")}</h1>
        <div class="header-info">
          <p><strong>${e("inventory.location","Location")}:</strong> ${z()}</p>
          <p><strong>${e("common.category","Category")}:</strong> ${u()==="all"?e("inventory.allCategories","All Categories"):u()}</p>
          <p><strong>${e("common.date","Date")}:</strong> ${re()}</p>
          <p style="margin-top: 10px;">
            <span style="margin-right: 30px;">${e("inventory.countedBy","Counted by")}: _________________________</span>
            <span>${e("inventory.verifiedBy","Verified by")}: _________________________</span>
          </p>
        </div>

        <!-- Page header for continuation pages (hidden on first page) -->
        <div class="page-header">
          ${z()} | ${u()==="all"?e("inventory.allCategories","All Categories"):u()} | ${re()} 
        </div>

        <table>
          <thead>
            <tr>
              <th style="width: 5%; text-align: center;">#</th>
              <th style="width: 12%;">${e("inventory.sku","SKU")}</th>
              <th style="width: 25%;">${e("inventory.productName","Product Name")}</th>
              <th style="width: 8%; text-align: center;">${e("inventory.unit","Unit")}</th>
              <th style="width: 10%; text-align: center;">${e("inventory.systemQty","System Qty")}</th>
              <th style="width: 12%; text-align: center; background-color: #f0f0f0;">${e("inventory.physicalCount","Physical Count")}</th>
              <th style="width: 28%;">${e("common.notes","Notes")}</th>
            </tr>
            <!-- Repeat header info row for clarity -->
            <tr style="background-color: #f8f8f8; font-size: 10px;">
              <td colspan="8" style="text-align: center; padding: 4px; border: 1px solid #000; font-weight: bold;">
                 ${z()} |  ${u()==="all"?e("inventory.allCategories","All Categories"):u()} |  ${re()}
              </td>
            </tr>
          </thead>
          <tbody>
            ${X}
          </tbody>
        </table>
        
        <!-- Summary section with location/category context -->
        <div style="margin: 30px 0; padding: 15px; background: #f8f8f8;">
          <h3 style="text-align: center; margin: 0 0 15px 0; font-size: 16px;">
            ${e("inventory.summaryFor","SUMMARY FOR")}: ${z()} - ${u()==="all"?e("inventory.allCategories","All Categories"):u()}
          </h3>
          
          <table class="summary-table">
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.totalProductsListed","Total Products Listed")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">
                ${j().length}
              </td>
            </tr>
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.itemsCounted","Items Counted")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center;">
                ___________
              </td>
            </tr>
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.discrepanciesFound","Discrepancies Found")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center;">
                ___________
              </td>
            </tr>
          </table>
        </div>
        
        <div class="signature-section">
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.counterSignature","Counter Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.supervisorSignature","Supervisor Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
        </div>
      </body>
      </html>
    `};return I(Oe,{get when(){return t.isOpen},get children(){var X=t6(),W=X.firstChild,se=W.firstChild,F=se.firstChild;F.firstChild;var k=F.nextSibling;return X.style.setProperty("position","fixed"),X.style.setProperty("top","0"),X.style.setProperty("left","0"),X.style.setProperty("right","0"),X.style.setProperty("bottom","0"),X.style.setProperty("background","rgba(0, 0, 0, 0.5)"),X.style.setProperty("z-index","1000"),X.style.setProperty("display","flex"),X.style.setProperty("align-items","center"),X.style.setProperty("justify-content","center"),W.style.setProperty("background","white"),W.style.setProperty("border-radius","var(--border-radius)"),W.style.setProperty("padding","2rem"),W.style.setProperty("width","95%"),W.style.setProperty("height","95%"),W.style.setProperty("max-width","1400px"),W.style.setProperty("overflow-y","auto"),W.style.setProperty("position","relative"),se.style.setProperty("display","flex"),se.style.setProperty("justify-content","space-between"),se.style.setProperty("align-items","center"),se.style.setProperty("margin-bottom","2rem"),se.style.setProperty("border-bottom","1px solid var(--border-color)"),se.style.setProperty("padding-bottom","1rem"),F.style.setProperty("margin","0"),F.style.setProperty("font-size","1.5rem"),a(F,()=>e("inventory.physicalInventoryCount","Physical Inventory Count"),null),Xn(k,"click",t.onClose,!0),k.style.setProperty("background","none"),k.style.setProperty("border","none"),k.style.setProperty("font-size","1.5rem"),k.style.setProperty("cursor","pointer"),k.style.setProperty("padding","0.5rem"),a(W,I(Oe,{get when(){return x()==="setup"},get children(){var N=Jk(),A=N.firstChild,V=A.nextSibling,Z=V.nextSibling,H=Z.nextSibling,B=H.firstChild,M=B.firstChild,G=M.firstChild,Q=M.nextSibling,ie=Q.firstChild,me=B.nextSibling,oe=me.firstChild,ee=oe.firstChild,de=oe.nextSibling,he=de.firstChild,le=me.nextSibling,ye=le.firstChild,ve=ye.firstChild,pe=ye.nextSibling,ge=pe.firstChild,ke=ge.nextSibling,Ne=ke.nextSibling;return N.style.setProperty("text-align","center"),N.style.setProperty("padding","2rem"),N.style.setProperty("max-width","600px"),N.style.setProperty("margin","0 auto"),A.style.setProperty("font-size","3rem"),A.style.setProperty("margin-bottom","1rem"),V.style.setProperty("margin-bottom","1rem"),a(V,()=>e("inventory.setupPhysicalCount","Setup Physical Inventory Count")),Z.style.setProperty("margin-bottom","2rem"),Z.style.setProperty("color","var(--text-muted)"),a(Z,()=>e("inventory.setupDescription","Configure your physical inventory count settings and begin the counting process.")),H.style.setProperty("display","grid"),H.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),H.style.setProperty("gap","1rem"),H.style.setProperty("margin-bottom","2rem"),H.style.setProperty("padding","1rem"),H.style.setProperty("background","var(--surface-color)"),H.style.setProperty("border-radius","var(--border-radius)"),H.style.setProperty("text-align","left"),M.style.setProperty("display","block"),M.style.setProperty("margin-bottom","0.5rem"),M.style.setProperty("font-weight","500"),a(M,()=>e("inventory.location","Location"),G),Q.addEventListener("change",xe=>d(xe.target.value)),Q.style.setProperty("width","100%"),Q.style.setProperty("padding","0.5rem"),Q.style.setProperty("border","1px solid var(--border-color)"),Q.style.setProperty("border-radius","var(--border-radius-sm)"),a(ie,()=>e("inventory.allLocations","All Locations")),a(Q,I(Ct,{get each(){return q()},children:xe=>(()=>{var $e=Y0();return a($e,()=>xe.name),fe(()=>$e.value=xe.id),$e})()}),null),oe.style.setProperty("display","block"),oe.style.setProperty("margin-bottom","0.5rem"),oe.style.setProperty("font-weight","500"),a(oe,()=>e("inventory.category","Category"),ee),de.addEventListener("change",xe=>y(xe.target.value)),de.style.setProperty("width","100%"),de.style.setProperty("padding","0.5rem"),de.style.setProperty("border","1px solid var(--border-color)"),de.style.setProperty("border-radius","var(--border-radius-sm)"),a(he,()=>e("products.allCategories","All Categories")),a(de,I(Ct,{get each(){return K()},children:xe=>(()=>{var $e=Y0();return $e.value=xe,a($e,xe),$e})()}),null),ye.style.setProperty("display","block"),ye.style.setProperty("margin-bottom","0.5rem"),ye.style.setProperty("font-weight","500"),a(ye,()=>e("inventory.sortBy","Sort By"),ve),pe.addEventListener("change",xe=>f(xe.target.value)),pe.style.setProperty("width","100%"),pe.style.setProperty("padding","0.5rem"),pe.style.setProperty("border","1px solid var(--border-color)"),pe.style.setProperty("border-radius","var(--border-radius-sm)"),a(ge,()=>e("inventory.productName","Product Name")),a(ke,()=>e("inventory.sku","SKU")),a(Ne,()=>e("inventory.category","Category")),a(N,I(Oe,{get when(){return!i()},get fallback(){return(()=>{var xe=r6(),$e=xe.firstChild;return xe.style.setProperty("padding","2rem"),a(xe,()=>e("common.loading","Loading"),$e),xe})()},get children(){return[(()=>{var xe=Yk(),$e=xe.firstChild;return $e.firstChild,xe.style.setProperty("padding","1rem"),xe.style.setProperty("background","#fff3cd"),xe.style.setProperty("border-radius","var(--border-radius-sm)"),xe.style.setProperty("margin-bottom","2rem"),$e.style.setProperty("margin","0"),$e.style.setProperty("color","#856404"),a($e,()=>e("inventory.countWillInclude","This count will include {{count}} products from {{location}} in {{category}} category.",{count:j().length,location:z(),category:u()==="all"?e("inventory.allCategories","all categories"):u()}),null),xe})(),I(Oe,{get when(){return Te(()=>u()!=="all")()&&c()!=="all"},get children(){var xe=Kk();return xe.style.setProperty("display","grid"),xe.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),xe.style.setProperty("gap","1rem"),xe.style.setProperty("margin-bottom","2rem"),xe.style.setProperty("padding","1rem"),xe.style.setProperty("background","var(--surface-color)"),xe.style.setProperty("border-radius","var(--border-radius)"),a(xe,I(Oe,{get when(){return vr.hasPermission("physicalInventoryCountingForm")},get children(){return I(_t,{variant:"primary",size:"large",onClick:C,get disabled(){return i()||j().length===0},get children(){return[" ",Te(()=>e("inventory.startCounting","Start Physical Count"))]}})}}),null),a(xe,I(_t,{variant:"primary",onClick:O,get disabled(){return i()},get children(){return[" ",Te(()=>e("common.print","Print"))]}}),null),xe}})]}}),null),fe(()=>Q.value=c()),fe(()=>de.value=u()),fe(()=>pe.value=g()),N}}),null),a(W,I(Oe,{get when(){return x()==="counting"},get children(){var N=Qk(),A=N.firstChild,V=A.nextSibling,Z=V.firstChild,H=Z.firstChild,B=H.nextSibling,M=Z.nextSibling,G=M.firstChild,Q=G.nextSibling,ie=M.nextSibling,me=ie.firstChild,oe=me.nextSibling,ee=ie.nextSibling,de=ee.firstChild,he=de.firstChild,le=de.nextSibling,ye=V.nextSibling,ve=ye.nextSibling,pe=ve.firstChild,ge=pe.firstChild,ke=ge.firstChild,Ne=ke.firstChild,xe=Ne.nextSibling,$e=xe.nextSibling,Ee=$e.nextSibling,Me=Ee.nextSibling,Ye=Me.nextSibling,ze=ge.nextSibling;return A.style.setProperty("display","grid"),A.style.setProperty("grid-template-columns","repeat(auto-fit)"),A.style.setProperty("gap","1rem"),A.style.setProperty("margin-bottom","2rem"),A.style.setProperty("padding","1rem"),A.style.setProperty("background","var(--surface-color)"),A.style.setProperty("border-radius","var(--border-radius)"),a(A,z),V.style.setProperty("display","grid"),V.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),V.style.setProperty("gap","1rem"),V.style.setProperty("margin-bottom","2rem"),V.style.setProperty("padding","1rem"),V.style.setProperty("background","var(--surface-color)"),V.style.setProperty("border-radius","var(--border-radius)"),Z.style.setProperty("text-align","center"),H.style.setProperty("font-size","1.5rem"),H.style.setProperty("font-weight","700"),H.style.setProperty("color","var(--primary-color)"),a(H,()=>D().countedProducts),B.style.setProperty("font-size","0.875rem"),B.style.setProperty("color","var(--text-muted)"),a(B,()=>e("inventory.counted","Counted")),M.style.setProperty("text-align","center"),G.style.setProperty("font-size","1.5rem"),G.style.setProperty("font-weight","700"),G.style.setProperty("color","#ff9800"),a(G,()=>D().remainingProducts),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),a(Q,()=>e("inventory.remaining","Remaining")),ie.style.setProperty("text-align","center"),me.style.setProperty("font-size","1.5rem"),me.style.setProperty("font-weight","700"),me.style.setProperty("color","#f44336"),a(me,()=>D().variances),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),a(oe,()=>e("inventory.variances","Variances")),ee.style.setProperty("text-align","center"),de.style.setProperty("font-size","1.5rem"),de.style.setProperty("font-weight","700"),a(de,()=>Math.round(D().countedProducts/D().totalProducts*100),he),le.style.setProperty("font-size","0.875rem"),le.style.setProperty("color","var(--text-muted)"),a(le,()=>e("inventory.complete","Complete")),ye.style.setProperty("display","flex"),ye.style.setProperty("gap","1rem"),ye.style.setProperty("margin-bottom","2rem"),ye.style.setProperty("justify-content","center"),a(ye,I(_t,{variant:"outline",onClick:()=>T("setup"),get children(){return[" ",Te(()=>e("common.back","Back to Setup"))]}}),null),a(ye,I(_t,{variant:"primary",onClick:()=>T("review"),get children(){return[" ",Te(()=>e("inventory.reviewAdjustments","Review Adjustments"))]}}),null),ve.style.setProperty("border","1px solid var(--border-color)"),ve.style.setProperty("border-radius","var(--border-radius)"),ve.style.setProperty("overflow-x","auto"),pe.style.setProperty("width","100%"),pe.style.setProperty("border-collapse","collapse"),ke.style.setProperty("background","var(--surface-color)"),Ne.style.setProperty("padding","1rem"),Ne.style.setProperty("text-align","left"),Ne.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Ne,()=>e("inventory.no","No")),xe.style.setProperty("padding","1rem"),xe.style.setProperty("text-align","left"),xe.style.setProperty("border-bottom","1px solid var(--border-color)"),a(xe,()=>e("inventory.product","Product")),$e.style.setProperty("padding","1rem"),$e.style.setProperty("text-align","center"),$e.style.setProperty("border-bottom","1px solid var(--border-color)"),a($e,()=>e("inventory.systemQty","System Qty")),Ee.style.setProperty("padding","1rem"),Ee.style.setProperty("text-align","center"),Ee.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Ee,()=>e("inventory.physicalCount","Physical Count")),Me.style.setProperty("padding","1rem"),Me.style.setProperty("text-align","center"),Me.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Me,()=>e("inventory.variance","Variance")),Ye.style.setProperty("padding","1rem"),Ye.style.setProperty("text-align","left"),Ye.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Ye,()=>e("common.notes","Notes")),a(ze,I(Ct,{get each(){return w()},children:(je,Xe)=>I(s6,{get index(){return Xe()},updatePhysicalCount:P,entry:je,updateNotes:$})})),fe(je=>(je=D().isComplete?"#4caf50":"#ff9800")!=null?de.style.setProperty("color",je):de.style.removeProperty("color")),N}}),null),a(W,I(Oe,{get when(){return x()==="review"},get children(){var N=e6(),A=N.firstChild,V=A.firstChild;V.firstChild;var Z=V.nextSibling,H=A.nextSibling,B=H.firstChild,M=B.firstChild,G=M.nextSibling,Q=B.nextSibling,ie=Q.firstChild,me=ie.nextSibling,oe=Q.nextSibling,ee=oe.firstChild,de=ee.nextSibling,he=H.nextSibling;return A.style.setProperty("text-align","center"),A.style.setProperty("margin-bottom","2rem"),V.style.setProperty("margin-bottom","1rem"),a(V,()=>e("inventory.reviewAndConfirm","Review and Confirm Adjustments"),null),Z.style.setProperty("color","var(--text-muted)"),a(Z,()=>e("inventory.reviewDescription","Review the inventory adjustments below and confirm to update your system.")),H.style.setProperty("display","grid"),H.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),H.style.setProperty("gap","1rem"),H.style.setProperty("margin-bottom","2rem"),H.style.setProperty("padding","1rem"),H.style.setProperty("background","var(--surface-color)"),H.style.setProperty("border-radius","var(--border-radius)"),B.style.setProperty("text-align","center"),M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","700"),M.style.setProperty("color","#4caf50"),a(M,()=>D().positiveVariances),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-muted)"),a(G,()=>e("inventory.stockIncreases","Stock Increases")),Q.style.setProperty("text-align","center"),ie.style.setProperty("font-size","1.5rem"),ie.style.setProperty("font-weight","700"),ie.style.setProperty("color","#f44336"),a(ie,()=>D().negativeVariances),me.style.setProperty("font-size","0.875rem"),me.style.setProperty("color","var(--text-muted)"),a(me,()=>e("inventory.stockDecreases","Stock Decreases")),oe.style.setProperty("text-align","center"),ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","700"),ee.style.setProperty("color","var(--primary-color)"),a(ee,()=>D().variances),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("color","var(--text-muted)"),a(de,()=>e("inventory.totalAdjustments","Total Adjustments")),he.style.setProperty("display","flex"),he.style.setProperty("gap","1rem"),he.style.setProperty("margin-bottom","2rem"),he.style.setProperty("justify-content","center"),he.style.setProperty("flex-wrap","wrap"),a(he,I(_t,{variant:"outline",onClick:()=>T("counting"),get children(){return[" ",Te(()=>e("common.back","Back to Counting"))]}}),null),a(he,I(_t,{variant:"outline",onClick:S,get disabled(){return D().variances===0},get children(){return[" ",Te(()=>e("inventory.downloadCSV","Download CSV"))]}}),null),a(he,I(_t,{variant:"primary",onClick:v,get disabled(){return s()||D().variances===0},get children(){return Te(()=>!!s())()?" "+e("common.saving","Saving")+"...":" "+e("inventory.confirmAdjustments","Confirm Adjustments")}}),null),a(N,I(Oe,{get when(){return D().variances>0},get children(){var le=Xk(),ye=le.firstChild,ve=ye.firstChild,pe=ve.firstChild,ge=pe.firstChild,ke=ge.nextSibling,Ne=ke.nextSibling,xe=Ne.nextSibling,$e=xe.nextSibling,Ee=ve.nextSibling;return le.style.setProperty("border","1px solid var(--border-color)"),le.style.setProperty("border-radius","var(--border-radius)"),le.style.setProperty("overflow-x","auto"),ye.style.setProperty("width","100%"),ye.style.setProperty("border-collapse","collapse"),pe.style.setProperty("background","var(--surface-color)"),ge.style.setProperty("padding","1rem"),ge.style.setProperty("text-align","left"),ge.style.setProperty("border-bottom","1px solid var(--border-color)"),a(ge,()=>e("inventory.product","Product")),ke.style.setProperty("padding","1rem"),ke.style.setProperty("text-align","center"),ke.style.setProperty("border-bottom","1px solid var(--border-color)"),a(ke,()=>e("inventory.systemQty","System Qty")),Ne.style.setProperty("padding","1rem"),Ne.style.setProperty("text-align","center"),Ne.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Ne,()=>e("inventory.physicalCount","Physical Count")),xe.style.setProperty("padding","1rem"),xe.style.setProperty("text-align","center"),xe.style.setProperty("border-bottom","1px solid var(--border-color)"),a(xe,()=>e("inventory.adjustment","Adjustment")),$e.style.setProperty("padding","1rem"),$e.style.setProperty("text-align","left"),$e.style.setProperty("border-bottom","1px solid var(--border-color)"),a($e,()=>e("common.notes","Notes")),a(Ee,I(Ct,{get each(){return w().filter(Me=>Me.variance!==0)},children:Me=>(()=>{var Ye=n6(),ze=Ye.firstChild,je=ze.firstChild,Xe=je.nextSibling,ht=Xe.firstChild,ut=ze.nextSibling,Ue=ut.firstChild,it=ut.nextSibling,dt=it.firstChild,Fe=it.nextSibling,Be=Fe.firstChild,Re=Fe.nextSibling,lt=Re.firstChild;return Ye.style.setProperty("border-bottom","1px solid var(--border-color)"),ze.style.setProperty("padding","1rem"),je.style.setProperty("font-weight","500"),a(je,()=>Me.product.name),Xe.style.setProperty("font-size","0.875rem"),Xe.style.setProperty("color","var(--text-muted)"),a(Xe,()=>Me.product.sku,ht),a(Xe,()=>Me.product.category,null),ut.style.setProperty("padding","1rem"),ut.style.setProperty("text-align","center"),Ue.style.setProperty("font-weight","600"),a(Ue,()=>Me.systemQuantity),it.style.setProperty("padding","1rem"),it.style.setProperty("text-align","center"),dt.style.setProperty("font-weight","600"),a(dt,()=>Me.physicalCount),Fe.style.setProperty("padding","1rem"),Fe.style.setProperty("text-align","center"),Be.style.setProperty("font-weight","700"),a(Be,()=>Me.variance>0?"+":"",null),a(Be,()=>Me.variance,null),Re.style.setProperty("padding","1rem"),lt.style.setProperty("font-size","0.875rem"),a(lt,()=>Me.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")),fe(ot=>{var nt=Me.variance>0?"#d4edda":"#f8d7da",Ve=Me.variance>0?"#4caf50":"#f44336";return nt!==ot.e&&((ot.e=nt)!=null?Ye.style.setProperty("background",nt):Ye.style.removeProperty("background")),Ve!==ot.t&&((ot.t=Ve)!=null?Be.style.setProperty("color",Ve):Be.style.removeProperty("color")),ot},{e:void 0,t:void 0}),Ye})()})),le}}),null),a(N,I(Oe,{get when(){return D().variances===0},get children(){var le=Zk(),ye=le.firstChild,ve=ye.nextSibling,pe=ve.nextSibling;return le.style.setProperty("text-align","center"),le.style.setProperty("padding","3rem"),le.style.setProperty("background","var(--surface-color)"),le.style.setProperty("border-radius","var(--border-radius)"),ye.style.setProperty("font-size","3rem"),ye.style.setProperty("margin-bottom","1rem"),ve.style.setProperty("margin-bottom","0.5rem"),a(ve,()=>e("inventory.perfectCount","Perfect Count!")),pe.style.setProperty("color","var(--text-muted)"),a(pe,()=>e("inventory.noVariances","No variances found. Your physical count matches the system exactly.")),le}}),null),N}}),null),X}})},s6=t=>{const{t:e}=_r(),[r,n]=we(""),[i,o]=we("");let{entry:s,updatePhysicalCount:l,updateNotes:c,index:d}=t;jn(()=>{o(s?.notes),n(s?.physicalCount)});const u=()=>{let y=document.getElementById(`physicalCountInput_${d+2}`);if(console.log(Gs(r()),!y),Gs(r())&&!y){l(s?.productId,r()===""?null:parseFloat(r()));return}if(Gs(r())&&y){y.focus(),l(s?.productId,r()===""?null:parseFloat(r()));return}};return(()=>{var y=i6(),g=y.firstChild,f=g.firstChild,w=g.nextSibling,E=w.firstChild,x=E.nextSibling,T=x.firstChild,Y=T.nextSibling;Y.nextSibling;var K=w.nextSibling,j=K.firstChild,q=K.nextSibling,J=q.firstChild,C=q.nextSibling,P=C.firstChild,$=C.nextSibling,D=$.firstChild;return y.style.setProperty("border-bottom","1px solid var(--border-color)"),g.style.setProperty("padding","1rem"),g.style.setProperty("text-align","center"),f.style.setProperty("font-weight","600"),a(f,d+1),w.style.setProperty("padding","1rem"),E.style.setProperty("font-weight","500"),a(E,()=>s?.product.name),x.style.setProperty("font-size","0.875rem"),x.style.setProperty("color","var(--text-muted)"),a(x,()=>s?.product.sku,T),a(x,()=>s?.product.category,Y),a(x,()=>s?.product.unitOfMeasure,null),K.style.setProperty("padding","1rem"),K.style.setProperty("text-align","center"),j.style.setProperty("font-weight","600"),a(j,()=>s?.systemQuantity),q.style.setProperty("padding","1rem"),q.style.setProperty("text-align","center"),J.addEventListener("blur",()=>{u()}),J.$$keydown=b=>{b.keyCode===13&&u(),b.keyCode===27&&u(),b.keyCode},J.$$input=b=>{const S=b.target.value;n(S)},ir(J,"id",`physicalCountInput_${d+1}`),ir(J,"tabindex",d),J.style.setProperty("width","100px"),J.style.setProperty("padding","0.5rem"),J.style.setProperty("border","1px solid var(--border-color)"),J.style.setProperty("border-radius","var(--border-radius-sm)"),J.style.setProperty("text-align","center"),C.style.setProperty("padding","1rem"),C.style.setProperty("text-align","center"),P.style.setProperty("font-weight","600"),a(P,()=>s?.variance>0?"+":"",null),a(P,()=>s?.variance||"",null),$.style.setProperty("padding","1rem"),D.addEventListener("blur",b=>{c(s?.productId,i())}),D.$$keydown=b=>{b.keyCode===13&&c(s?.productId,i()),b.keyCode===27&&c(s?.productId,i()),b.keyCode===9&&c(s?.productId,i())},D.$$input=b=>{const S=b.target.value;o(S)},D.style.setProperty("width","200px"),D.style.setProperty("padding","0.5rem"),D.style.setProperty("border","1px solid var(--border-color)"),D.style.setProperty("border-radius","var(--border-radius-sm)"),fe(b=>{var S=s?.physicalCount!==null?s?.variance!==0?"#fff3cd":"#d4edda":"transparent",v=s?.variance>0?"#4caf50":s?.variance<0?"#f44336":"var(--text-muted)",z=e("inventory.addNotes","Add notes...");return S!==b.e&&((b.e=S)!=null?y.style.setProperty("background",S):y.style.removeProperty("background")),v!==b.t&&((b.t=v)!=null?P.style.setProperty("color",v):P.style.removeProperty("color")),z!==b.a&&ir(D,"placeholder",b.a=z),b},{e:void 0,t:void 0,a:void 0}),fe(()=>J.value=r()||""),fe(()=>D.value=i()||""),y})()};br(["click","input","keydown"]);function a6(t,e=300,r=!1){let n,i;const o=()=>{n!==void 0&&(clearTimeout(n),n=void 0),i=void 0},s=()=>{n!==void 0&&i!==void 0&&(clearTimeout(n),n=void 0,t(...i),i=void 0)},l=(...c)=>{i=c,n!==void 0&&clearTimeout(n),r&&n===void 0&&t(...c),n=window.setTimeout(()=>{r||t(...c),n=void 0,i=void 0},e)};return Rc(()=>{o()}),{debounced:l,cancel:o,flush:s}}function l6(t,e=300){const[r,n]=we(!1);let i;const o=async d=>{if(i&&i.abort(),!d.trim()){n(!1);return}i=new AbortController,n(!0);try{await t(d)}catch(u){u instanceof Error&&u.name!=="AbortError"&&console.error("Search error:",u)}finally{i.signal.aborted||n(!1)}},{debounced:s,cancel:l}=a6(o,e,!1),c=()=>{l(),i&&i.abort(),n(!1)};return Rc(()=>{c()}),{search:s,isSearching:r,cancel:c}}var K0=ae("<div>"),c6=ae("<div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),d6=ae("<div><h3></h3><div><div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><div><span></span><span></span></div><div><span></span><span>%"),u6=ae("<div><h4>"),h6=ae("<div><h3></h3><div><div><div><span></span><span> </span></div><div><span></span><span> </span></div></div><div><div><span></span><span> </span></div><div><span></span><span>"),p6=ae("<div><h3></h3><div><span></span><span></span></div><div><span></span><span>"),J0=ae("<div><h3>"),m6=ae("<div><div><div><h2></h2><div>SKU: <!>  </div></div><div></div></div><div><button></button><button></button><button></button></div><div>"),f6=ae("<span> "),y6=ae("<span> "),g6=ae("<div><div><span><span>  </span></span><span> </span></div><div>: <!>  <!>: "),v6=ae("<div> "),b6=ae("<div>Ref: "),_6=ae("<div><div><div><span></span><span></span><span></span></div><div><span></span></div></div><div><div> </div><div>"),P6=ae("<div><h4></h4><div></div><div>"),S6=ae("<div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div> <!>  </div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div>Min: <!>  Max: ");const w6=t=>{const{t:e}=_r(),[r,n]=we("details"),i=Ut(()=>{if(!t.product)return null;const $=Pt.getTotalStockByProduct(t.product.id),D=Pt.getStockByProduct(t.product.id),b=$<=t.product.minStockLevel,S=$===0,v=$>=t.product.maxStockLevel;return{total:$,byLocation:D,status:S?"out":b?"low":v?"over":"good",statusText:S?e("products.outOfStock","Out of Stock"):b?e("products.lowStock","Low Stock"):v?e("products.overStock","Over Stock"):e("products.inStock","In Stock")}}),o=$=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format($),s=$=>new Date($).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),l=Ut(()=>!t.product||t.product.unitCost===0?0:((t.product.sellingPrice-t.product.unitCost)/t.product.unitCost*100).toFixed(2)),c=Ut(()=>t.product?Pt.movements.filter($=>$.productId===t.product.id).sort(($,D)=>new Date(D.createdDate).getTime()-new Date($.createdDate).getTime()):[]),d=Ut(()=>{if(!t.product)return null;const $=c(),D=i(),b=new Date;b.setDate(b.getDate()-30);const S=$.filter(z=>new Date(z.createdDate)>=b),v=$.reduce((z,re)=>{const L=re.productId===t.product.id?re:null;return z+(L?L.quantity*L.unitCost:0)},0);return{recentMovements:$.length,movements30Days:S.length,totalValue:(D?.total||0)*t.product.unitCost,averageMovementValue:$.length>0?v/$.length:0,lastMovementDate:$.length>0?$[0].createdDate:null}}),u={"margin-bottom":"2rem"},y={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},g={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},f={"font-weight":"400",color:"var(--text-primary)","font-size":"1rem"},w=$=>({in:"",out:"",transfer:"",adjustment:""})[$]||"";function E($){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[$]||{bg:"#f5f5f5",color:"#666"}}const x=$=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:E($).bg,color:E($).color}),T=$=>{const D={good:{background:"#d4edda",color:"#155724"},low:{background:"#fff3cd",color:"#856404"},out:{background:"#f8d7da",color:"#721c24"},over:{background:"#cce5ff",color:"#004085"}};return{display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500",...D[$]||D.good}},Y={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"},K={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-bottom":"0.75rem"},j={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem","padding-bottom":"1rem","border-bottom":"2px solid var(--border-color)"},q={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},J=$=>({padding:"0.75rem 1.5rem",background:"none",border:"none","border-bottom":$?"2px solid var(--primary-color)":"2px solid transparent",color:$?"var(--primary-color)":"var(--text-muted)","font-weight":$?"600":"400",cursor:"pointer",transition:"all 0.2s","font-size":"0.875rem"}),C={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-bottom":"0.5rem"},P={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1.5rem","margin-bottom":"1rem"};return I(si,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("products.productDetails","Product Details")},size:"large",get children(){return I(Oe,{get when(){return t.product},get fallback(){return(()=>{var $=K0();return $.style.setProperty("text-align","center"),$.style.setProperty("padding","2rem"),$.style.setProperty("color","var(--text-muted)"),a($,()=>e("products.noProductSelected","No product selected")),$})()},children:$=>(()=>{var D=m6(),b=D.firstChild,S=b.firstChild,v=S.firstChild,z=v.nextSibling,re=z.firstChild,L=re.nextSibling;L.nextSibling;var O=S.nextSibling,ne=b.nextSibling,X=ne.firstChild,W=X.nextSibling,se=W.nextSibling,F=ne.nextSibling;return a(D,()=>JSON.stringify($),b),p(b,j),v.style.setProperty("margin","0"),v.style.setProperty("font-size","1.5rem"),v.style.setProperty("margin-bottom","0.25rem"),a(v,()=>$().name),z.style.setProperty("color","var(--text-muted)"),a(z,()=>$().sku,L),a(z,()=>$().category,null),a(O,()=>i()?.statusText),p(ne,q),X.$$click=()=>n("details"),a(X,()=>e("products.details","Details")),W.$$click=()=>n("movements"),a(W,()=>e("products.movements","Movements")),se.$$click=()=>n("analytics"),a(se,()=>e("products.analytics","Analytics")),a(D,I(Oe,{get when(){return r()==="details"},get children(){return[(()=>{var k=c6(),N=k.firstChild,A=N.nextSibling,V=A.firstChild,Z=V.nextSibling,H=A.nextSibling,B=H.firstChild,M=B.nextSibling,G=H.nextSibling,Q=G.firstChild,ie=Q.nextSibling;return N.style.setProperty("margin-bottom","1rem"),N.style.setProperty("font-size","1.1rem"),a(N,()=>e("products.basicInformation","Basic Information")),a(V,()=>e("products.description","Description")),a(Z,()=>$().description||e("common.notAvailable","N/A")),a(B,()=>e("products.unitOfMeasure","Unit of Measure")),a(M,()=>$().unitOfMeasure),a(Q,()=>e("products.status","Status")),a(ie,(()=>{var me=Te(()=>!!$().isActive);return()=>me()?(()=>{var oe=f6();return oe.firstChild,oe.style.setProperty("color","#2e7d32"),a(oe,()=>e("common.active","Active"),null),oe})():(()=>{var oe=y6();return oe.firstChild,oe.style.setProperty("color","#d32f2f"),a(oe,()=>e("common.inactive","Inactive"),null),oe})()})()),fe(me=>{var oe=u,ee=y,de=g,he=f,le=y,ye=g,ve=f,pe=y,ge=g,ke=f;return me.e=p(k,oe,me.e),me.t=p(A,ee,me.t),me.a=p(V,de,me.a),me.o=p(Z,he,me.o),me.i=p(H,le,me.i),me.n=p(B,ye,me.n),me.s=p(M,ve,me.s),me.h=p(G,pe,me.h),me.r=p(Q,ge,me.r),me.d=p(ie,ke,me.d),me},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),k})(),(()=>{var k=d6(),N=k.firstChild,A=N.nextSibling,V=A.firstChild,Z=V.firstChild,H=Z.firstChild,B=H.nextSibling,M=Z.nextSibling,G=M.firstChild,Q=G.nextSibling,ie=V.nextSibling,me=ie.firstChild,oe=me.firstChild,ee=oe.nextSibling,de=me.nextSibling,he=de.firstChild,le=he.nextSibling,ye=le.firstChild;return N.style.setProperty("margin-bottom","1rem"),N.style.setProperty("font-size","1.1rem"),a(N,()=>e("products.pricingInformation","Pricing Information")),a(H,()=>e("products.unitCost","Unit Cost")),a(B,()=>o($().unitCost)),a(G,()=>e("products.sellingPrice","Selling Price")),a(Q,()=>o($().sellingPrice)),a(oe,()=>e("products.profit","Profit")),a(ee,()=>o($().sellingPrice-$().unitCost)),a(he,()=>e("products.profitMargin","Profit Margin")),a(le,l,ye),fe(ve=>{var pe=u,ge=Y,ke=y,Ne=g,xe=f,$e=y,Ee=g,Me=f,Ye=y,ze=g,je=f,Xe=y,ht=g,ut=f;return ve.e=p(k,pe,ve.e),ve.t=p(A,ge,ve.t),ve.a=p(Z,ke,ve.a),ve.o=p(H,Ne,ve.o),ve.i=p(B,xe,ve.i),ve.n=p(M,$e,ve.n),ve.s=p(G,Ee,ve.s),ve.h=p(Q,Me,ve.h),ve.r=p(me,Ye,ve.r),ve.d=p(oe,ze,ve.d),ve.l=p(ee,je,ve.l),ve.u=p(de,Xe,ve.u),ve.c=p(he,ht,ve.c),ve.w=p(le,ut,ve.w),ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),k})(),(()=>{var k=h6(),N=k.firstChild,A=N.nextSibling,V=A.firstChild,Z=V.firstChild,H=Z.firstChild,B=H.nextSibling,M=B.firstChild,G=Z.nextSibling,Q=G.firstChild,ie=Q.nextSibling,me=ie.firstChild,oe=V.nextSibling,ee=oe.firstChild,de=ee.firstChild,he=de.nextSibling,le=he.firstChild,ye=ee.nextSibling,ve=ye.firstChild,pe=ve.nextSibling;return N.style.setProperty("margin-bottom","1rem"),N.style.setProperty("font-size","1.1rem"),a(N,()=>e("products.stockInformation","Stock Information")),a(H,()=>e("products.totalStock","Total Stock")),a(B,()=>i()?.total||0,M),a(B,()=>$().unitOfMeasure,null),a(Q,()=>e("products.minStockLevel","Min Stock Level")),a(ie,()=>$().minStockLevel,me),a(ie,()=>$().unitOfMeasure,null),a(de,()=>e("products.maxStockLevel","Max Stock Level")),a(he,()=>$().maxStockLevel,le),a(he,()=>$().unitOfMeasure,null),a(ve,()=>e("products.stockValue","Stock Value")),a(pe,()=>o((i()?.total||0)*$().unitCost)),a(k,I(Oe,{get when(){return Te(()=>!!i()?.byLocation)()&&i().byLocation.length>0},get children(){var ge=u6(),ke=ge.firstChild;return ge.style.setProperty("margin-top","1.5rem"),ke.style.setProperty("margin-bottom","1rem"),ke.style.setProperty("font-size","1rem"),a(ke,()=>e("products.stockByLocation","Stock by Location")),a(ge,()=>i().byLocation.map(Ne=>(()=>{var xe=g6(),$e=xe.firstChild,Ee=$e.firstChild,Me=Ee.firstChild;Me.firstChild;var Ye=Ee.nextSibling,ze=Ye.firstChild,je=$e.nextSibling,Xe=je.firstChild,ht=Xe.nextSibling,ut=ht.nextSibling,Ue=ut.nextSibling;return Ue.nextSibling,p(xe,K),$e.style.setProperty("display","flex"),$e.style.setProperty("justify-content","space-between"),$e.style.setProperty("align-items","center"),Ee.style.setProperty("font-weight","500"),Ee.style.setProperty("color","var(--primary-color)"),a(Ee,()=>Ne.locationId,Me),Me.style.setProperty("font-weight","500"),Me.style.setProperty("color","var(--text-muted)"),a(Me,()=>Ne.locationName,null),Ye.style.setProperty("font-weight","600"),a(Ye,()=>Ne.quantity,ze),a(Ye,()=>$().unitOfMeasure,null),je.style.setProperty("margin-top","0.5rem"),je.style.setProperty("font-size","0.875rem"),je.style.setProperty("color","var(--text-muted)"),a(je,()=>e("products.available","Available"),Xe),a(je,()=>Ne.availableQuantity,ht),a(je,()=>e("products.reserved","Reserved"),Ue),a(je,()=>Ne.reservedQuantity,null),fe(it=>(it=Ne.quantity>0?"var(--primary-color)":"var(--text-muted)")!=null?Ye.style.setProperty("color",it):Ye.style.removeProperty("color")),xe})()),null),ge}}),null),fe(ge=>{var ke=u,Ne=Y,xe=y,$e=g,Ee=f,Me=y,Ye=g,ze=f,je=y,Xe=g,ht=f,ut=y,Ue=g,it=f;return ge.e=p(k,ke,ge.e),ge.t=p(A,Ne,ge.t),ge.a=p(Z,xe,ge.a),ge.o=p(H,$e,ge.o),ge.i=p(B,Ee,ge.i),ge.n=p(G,Me,ge.n),ge.s=p(Q,Ye,ge.s),ge.h=p(ie,ze,ge.h),ge.r=p(ee,je,ge.r),ge.d=p(de,Xe,ge.d),ge.l=p(he,ht,ge.l),ge.u=p(ye,ut,ge.u),ge.c=p(ve,Ue,ge.c),ge.w=p(pe,it,ge.w),ge},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),k})(),(()=>{var k=p6(),N=k.firstChild,A=N.nextSibling,V=A.firstChild,Z=V.nextSibling,H=A.nextSibling,B=H.firstChild,M=B.nextSibling;return N.style.setProperty("margin-bottom","1rem"),N.style.setProperty("font-size","1.1rem"),a(N,()=>e("products.timestamps","Timestamps")),a(V,()=>e("common.createdDate","Created Date")),a(Z,()=>s($().createdDate)),a(B,()=>e("common.lastModified","Last Modified")),a(M,()=>s($().lastModified)),fe(G=>{var Q=u,ie=y,me=g,oe=f,ee=y,de=g,he=f;return G.e=p(k,Q,G.e),G.t=p(A,ie,G.t),G.a=p(V,me,G.a),G.o=p(Z,oe,G.o),G.i=p(H,ee,G.i),G.n=p(B,de,G.n),G.s=p(M,he,G.s),G},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),k})()]}}),F),a(D,I(Oe,{get when(){return r()==="movements"},get children(){var k=J0(),N=k.firstChild;return N.style.setProperty("margin-bottom","1rem"),N.style.setProperty("font-size","1.1rem"),a(N,()=>e("products.recentMovements","Recent Movements")),a(k,I(Oe,{get when(){return c().length>0},get fallback(){return(()=>{var A=v6();return A.firstChild,A.style.setProperty("text-align","center"),A.style.setProperty("padding","2rem"),A.style.setProperty("color","var(--text-muted)"),A.style.setProperty("background","var(--surface-color)"),A.style.setProperty("border-radius","var(--border-radius-sm)"),A.style.setProperty("border","1px solid var(--border-color)"),a(A,()=>e("products.noMovements","No movements found for this product"),null),A})()},get children(){return I(Ct,{get each(){return c()},children:A=>{const V=A.productId===$().id?A:null;if(!V)return null;let Z=Pt.getLocationById(A.locationId);return(()=>{var H=_6(),B=H.firstChild,M=B.firstChild,G=M.firstChild,Q=G.nextSibling,ie=Q.nextSibling,me=M.nextSibling,oe=me.firstChild,ee=B.nextSibling,de=ee.firstChild,he=de.firstChild,le=de.nextSibling;return p(H,C),M.style.setProperty("font-weight","600"),M.style.setProperty("margin-bottom","0.25rem"),G.style.setProperty("font-size","1.2rem"),a(G,()=>w(A.movementType)),Q.style.setProperty("padding","0 6px"),a(ie,()=>A.movementType),me.style.setProperty("font-size","0.875rem"),me.style.setProperty("color","var(--text-muted)"),a(me,()=>` ${s(A?.createdDate)}  `,oe),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("font-weight","600"),oe.style.setProperty("color","var(--primary-color)"),a(oe,()=>A?.locationId),a(me,()=>`  ${Z?.name}`,null),a(B,I(Oe,{get when(){return A.referenceNumber},get children(){var ye=b6();return ye.firstChild,ye.style.setProperty("font-size","0.75rem"),ye.style.setProperty("color","var(--text-muted)"),ye.style.setProperty("margin-top","0.25rem"),a(ye,()=>A?.referenceNumber,null),ye}}),null),ee.style.setProperty("text-align","right"),de.style.setProperty("font-weight","600"),de.style.setProperty("font-size","1rem"),a(de,()=>A?.movementType==="in"?"+":"",he),a(de,()=>V.quantity,he),a(de,()=>$().unitOfMeasure,null),le.style.setProperty("font-size","0.875rem"),le.style.setProperty("color","var(--text-muted)"),a(le,()=>o(V.unitCost)),fe(ye=>{var ve=x(A.movementType),pe=A?.movementType==="in"?"#2e7d32":"#d32f2f";return ye.e=p(ie,ve,ye.e),pe!==ye.t&&((ye.t=pe)!=null?de.style.setProperty("color",pe):de.style.removeProperty("color")),ye},{e:void 0,t:void 0}),H})()}})}}),null),fe(A=>p(k,u,A)),k}}),F),a(D,I(Oe,{get when(){return r()==="analytics"},get children(){var k=J0(),N=k.firstChild;return N.style.setProperty("margin-bottom","1rem"),N.style.setProperty("font-size","1.1rem"),a(N,()=>e("products.analytics","Analytics")),a(k,I(Oe,{get when(){return d()},get fallback(){return(()=>{var A=K0();return A.style.setProperty("text-align","center"),A.style.setProperty("padding","2rem"),A.style.setProperty("color","var(--text-muted)"),a(A,()=>e("products.noAnalytics","No analytics data available")),A})()},children:A=>(()=>{var V=S6(),Z=V.firstChild,H=Z.firstChild,B=H.nextSibling,M=B.nextSibling,G=Z.nextSibling,Q=G.firstChild,ie=Q.nextSibling,me=ie.nextSibling,oe=G.nextSibling,ee=oe.firstChild,de=ee.nextSibling,he=de.nextSibling,le=he.firstChild,ye=le.nextSibling;ye.nextSibling;var ve=oe.nextSibling,pe=ve.firstChild,ge=pe.nextSibling,ke=ge.nextSibling,Ne=ve.nextSibling,xe=Ne.firstChild,$e=xe.nextSibling,Ee=$e.nextSibling,Me=Ee.firstChild,Ye=Me.nextSibling;return Ye.nextSibling,H.style.setProperty("margin","0 0 0.5rem 0"),H.style.setProperty("color","var(--primary-color)"),a(H,()=>e("products.totalMovements","Total Movements")),B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),a(B,()=>A().recentMovements),M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),M.style.setProperty("margin-top","0.25rem"),a(M,()=>e("products.allTime","All time")),Q.style.setProperty("margin","0 0 0.5rem 0"),Q.style.setProperty("color","var(--primary-color)"),a(Q,()=>e("products.last30Days","Last 30 Days")),ie.style.setProperty("font-size","1.5rem"),ie.style.setProperty("font-weight","600"),a(ie,()=>A().movements30Days),me.style.setProperty("font-size","0.875rem"),me.style.setProperty("color","var(--text-muted)"),me.style.setProperty("margin-top","0.25rem"),a(me,()=>e("products.movements","movements")),ee.style.setProperty("margin","0 0 0.5rem 0"),ee.style.setProperty("color","var(--primary-color)"),a(ee,()=>e("products.currentValue","Current Stock Value")),de.style.setProperty("font-size","1.5rem"),de.style.setProperty("font-weight","600"),a(de,()=>o(A().totalValue)),he.style.setProperty("font-size","0.875rem"),he.style.setProperty("color","var(--text-muted)"),he.style.setProperty("margin-top","0.25rem"),a(he,()=>i()?.total||0,le),a(he,()=>$().unitOfMeasure,ye),a(he,()=>o($().unitCost),null),pe.style.setProperty("margin","0 0 0.5rem 0"),pe.style.setProperty("color","var(--primary-color)"),a(pe,()=>e("products.avgMovementValue","Avg Movement Value")),ge.style.setProperty("font-size","1.5rem"),ge.style.setProperty("font-weight","600"),a(ge,()=>o(A().averageMovementValue)),ke.style.setProperty("font-size","0.875rem"),ke.style.setProperty("color","var(--text-muted)"),ke.style.setProperty("margin-top","0.25rem"),a(ke,()=>e("products.perMovement","per movement")),a(V,I(Oe,{get when(){return A().lastMovementDate},get children(){var ze=P6(),je=ze.firstChild,Xe=je.nextSibling,ht=Xe.nextSibling;return je.style.setProperty("margin","0 0 0.5rem 0"),je.style.setProperty("color","var(--primary-color)"),a(je,()=>e("products.lastMovement","Last Movement")),Xe.style.setProperty("font-size","1.25rem"),Xe.style.setProperty("font-weight","600"),a(Xe,()=>s(A().lastMovementDate)),ht.style.setProperty("font-size","0.875rem"),ht.style.setProperty("color","var(--text-muted)"),ht.style.setProperty("margin-top","0.25rem"),a(ht,()=>e("products.mostRecent","Most recent activity")),fe(ut=>p(ze,P,ut)),ze}}),Ne),xe.style.setProperty("margin","0 0 0.5rem 0"),xe.style.setProperty("color","var(--primary-color)"),a(xe,()=>e("products.stockStatus","Stock Status")),$e.style.setProperty("font-size","1.25rem"),$e.style.setProperty("font-weight","600"),a($e,()=>i()?.statusText),Ee.style.setProperty("font-size","0.875rem"),Ee.style.setProperty("color","var(--text-muted)"),Ee.style.setProperty("margin-top","0.25rem"),a(Ee,()=>$().minStockLevel,Ye),a(Ee,()=>$().maxStockLevel,null),fe(ze=>{var je=Y,Xe=P,ht=P,ut=P,Ue=P,it=P;return ze.e=p(V,je,ze.e),ze.t=p(Z,Xe,ze.t),ze.a=p(G,ht,ze.a),ze.o=p(oe,ut,ze.o),ze.i=p(ve,Ue,ze.i),ze.n=p(Ne,it,ze.n),ze},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),V})()}),null),fe(A=>p(k,u,A)),k}}),F),F.style.setProperty("display","flex"),F.style.setProperty("gap","1rem"),F.style.setProperty("justify-content","flex-end"),F.style.setProperty("margin-top","2rem"),a(F,I(_t,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close","Close")}}),null),a(F,I(Oe,{get when(){return t.onEdit},get children(){return I(_t,{variant:"primary",get onClick(){return t.onEdit},get children(){return e("common.edit","Edit")}})}}),null),fe(k=>{var N=T(i()?.status||"good"),A=J(r()==="details"),V=J(r()==="movements"),Z=J(r()==="analytics");return k.e=p(O,N,k.e),k.t=p(X,A,k.t),k.a=p(W,V,k.a),k.o=p(se,Z,k.o),k},{e:void 0,t:void 0,a:void 0,o:void 0}),D})()})}})};br(["click"]);var x6=ae("<div>"),C6=ae("<button type=button>"),A6=ae("<div> "),Q0=ae("<div>"),$6=ae("<div><div><input type=text autocomplete=off>"),E6=ae("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>"),I6=ae("<span> ");const T6=t=>{const{t:e}=_r(),[r,n]=we(""),[i,o]=we(!1),[s,l]=we(null),[c,d]=we([]),[u,y]=we(!1),[g,f]=we(-1),[w,E]=we(null),x=t.searchDelay||300,T=t.maxResults||900,Y=async A=>{if(!A.trim()||A.trim().length<3){d([]),t.onSearchResults?.([]);return}try{o(!0),l(null);try{const V=await qi.getProducts(A),Z=Object.keys(V),H=M=>{let G=V;return{id:M,name:G[M].name,businessId:G[M].businessId,sku:G[M].code,UPC:G[M].UPC,numCode:G[M].codeN,category:G[M].category,unitCost:G[M].unitCost||0,unitOfMeasure:G[M].unitOfMeasure,minStockLevel:G[M].minStockLevel,maxStockLevel:G[M].maxStockLevel,isActive:G[M].isActive,description:G[M].description||"",createdDate:G[M].createdAt||new Date().toISOString(),lastModified:G[M].updatedAt||new Date().toISOString()}},B=Z.map(H);d(B),Pt.updProduct(B),t.onSearchResults?.(B)}catch(V){console.warn("API search failed, using local fallback:",V),l("API search failed, showing local results");const Z=Pt.getActiveProducts().filter(H=>H.name.toLowerCase().includes(A.toLowerCase())||H.sku.toLowerCase().includes(A.toLowerCase())||H.category.toLowerCase().includes(A.toLowerCase())).slice(0,T);d(Z),t.onSearchResults?.(Z)}}catch(V){const Z=V instanceof Error?V.message:"Search failed";l(Z),d([]),t.onSearchResults?.([])}finally{o(!1)}},K=A=>{const Z=A.target.value;n(Z),l(null),t.showResults!==!1&&y(!0),w()&&clearTimeout(w());const H=setTimeout(()=>{Y(Z)},x);E(H)},j=A=>{n(A.name),y(!1),f(-1),t.onProductSelect?.(A)},q=A=>{if(!(!u()||c().length===0))switch(A.key){case"ArrowDown":A.preventDefault(),f(V=>Math.min(V+1,c().length-1));break;case"ArrowUp":A.preventDefault(),f(V=>Math.max(V-1,-1));break;case"Enter":A.preventDefault(),g()>=0&&c()[g()]&&j(c()[g()]);break;case"Escape":y(!1),f(-1);break}},J=()=>{t.showResults!==!1&&c().length>0&&y(!0)},C=()=>{setTimeout(()=>{y(!1),f(-1)},150)},P=()=>{n(""),d([]),l(null),y(!1),f(-1),t.onSearchResults?.([]),w()&&(clearTimeout(w()),E(null))},$=A=>Pt.stockLevels.filter(V=>V.productId===A).reduce((V,Z)=>V+Z.quantity,0),D=A=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(A),b={position:"relative",width:"100%",...t.style},S={position:"relative",display:"flex","align-items":"center"},v={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},z={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},re={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},L={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},O=A=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:A?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),ne={display:"flex","justify-content":"space-between","align-items":"center"},X={flex:"1"},W={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},se={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},F={"text-align":"right","font-size":"0.875rem"},k={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},N={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var A=$6(),V=A.firstChild,Z=V.firstChild;return Z.addEventListener("blur",C),Z.addEventListener("focus",J),Z.$$keydown=q,Z.$$input=K,a(V,I(Oe,{get when(){return i()},get children(){var H=x6();return fe(B=>p(H,re,B)),H}}),null),a(V,I(Oe,{get when(){return Te(()=>!!r())()&&!i()},get children(){var H=C6();return H.addEventListener("mouseleave",B=>{B.currentTarget.style.background="none",B.currentTarget.style.color="var(--text-muted)"}),H.addEventListener("mouseenter",B=>{B.currentTarget.style.background="var(--border-color)",B.currentTarget.style.color="var(--text-primary)"}),H.$$click=P,fe(B=>{var M=z,G=e("common.clear","Clear search");return B.e=p(H,M,B.e),G!==B.t&&ir(H,"title",B.t=G),B},{e:void 0,t:void 0}),H}}),null),a(A,I(Oe,{get when(){return u()&&t.showResults!==!1},get children(){var H=Q0();return a(H,I(Oe,{get when(){return s()},get children(){var B=A6();return B.firstChild,p(B,N),a(B,s,null),B}}),null),a(H,I(Oe,{get when(){return c().length>0},get fallback(){return Te(()=>!!(r()&&!i()))()&&(()=>{var B=Q0();return p(B,k),a(B,()=>e("inventory.noProductsFound","No products found matching your search.")),B})()},get children(){return I(Ct,{get each(){return c()},children:(B,M)=>{const G=$(B.id),Q=G<=B.minStockLevel;return(()=>{var ie=E6(),me=ie.firstChild,oe=me.firstChild,ee=oe.firstChild,de=ee.nextSibling,he=de.firstChild,le=he.firstChild,ye=he.nextSibling,ve=ye.nextSibling,pe=ve.nextSibling,ge=pe.nextSibling,ke=oe.nextSibling,Ne=ke.firstChild,xe=Ne.firstChild,$e=Ne.nextSibling;return ie.addEventListener("mouseenter",()=>f(M())),ie.$$click=()=>j(B),p(me,ne),p(oe,X),p(ee,W),a(ee,()=>B.name),p(de,se),a(he,()=>e("inventory.sku","SKU"),le),a(he,()=>B.sku,null),a(ve,()=>B.category),a(ge,()=>D(B.unitCost)),p(ke,F),Ne.style.setProperty("font-weight","600"),(Q?"#f44336":"var(--text-primary)")!=null?Ne.style.setProperty("color",Q?"#f44336":"var(--text-primary)"):Ne.style.removeProperty("color"),a(Ne,G,xe),a(Ne,()=>B.unitOfMeasure,null),$e.style.setProperty("color","var(--text-muted)"),a($e,()=>Q?(()=>{var Ee=I6();return Ee.firstChild,Ee.style.setProperty("color","#f44336"),a(Ee,()=>e("inventory.lowStock","Low Stock"),null),Ee})():e("inventory.inStock","In Stock")),fe(Ee=>p(ie,O(M()===g()),Ee)),ie})()}})}}),null),fe(B=>p(H,L,B)),H}}),null),fe(H=>{var B=b,M=S,G=v,Q=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),ie=t.disabled;return H.e=p(A,B,H.e),H.t=p(V,M,H.t),H.a=p(Z,G,H.a),Q!==H.o&&ir(Z,"placeholder",H.o=Q),ie!==H.i&&(Z.disabled=H.i=ie),H},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),fe(()=>Z.value=r()),A})()};br(["input","keydown","click"]);var k6=ae("<div><div><h2></h2><div><div>"),N6=ae("<div><span>"),L6=ae("<span> "),R6=ae("<div><div><div><div><h3></h3><span></span></div><div></div><div>: </div></div><div><div></div><div>  <!>: </div><div>: "),D6=ae("<div><div>:</div><div>"),M6=ae("<div>: "),F6=ae("<div><div><span>:</span><select><option value=10>10</option><option value=20>20</option><option value=50>50</option><option value=100>100</option></select></div><div><div><span></span><input type=number min=1><span> </span></div></div><div>");const h_=()=>{const{t}=_r(),[e,r]=we(""),[n,i]=we(""),[o,s]=we([]),[l,c]=we(!1),[d,u]=we(null),[y,g]=we(!1),[f,w]=we(!1),[E,x]=we(!1),[T,Y]=we(null),[K,j]=we(!1),[q,J]=we([]),[C,P]=we(!1),[$,D]=we(1),[b,S]=we(20);jn(async()=>{await v()});const v=async()=>{try{c(!0),u(null);try{const A=await S0.getAll();s(A.map(V=>({id:V.id||`prod-${Date.now()}-${Math.random()}`,name:V.productName||V.name||"Unknown Product",sku:V.sku||V.productCode||"",description:V.description||"",category:V.category||"General",unitOfMeasure:V.unitOfMeasure||"pcs",unitCost:parseFloat(V.unitCost||V.cost||"0"),sellingPrice:parseFloat(V.sellingPrice||V.price||"0"),minStockLevel:parseInt(V.minStockLevel||"0"),maxStockLevel:parseInt(V.maxStockLevel||"100"),isActive:V.isActive!==!1,createdDate:V.createdDate||new Date().toISOString(),lastModified:V.lastModified||new Date().toISOString(),businessId:V.businessId||"YB100423253156428"})))}catch(A){console.warn("API failed, using local store:",A),s(Pt.products)}}catch(A){u(A instanceof Error?A.message:"Failed to load products")}finally{c(!1)}},z=async()=>{try{c(!0),u(null);try{const A=await qi.getProducts("prod"),V=Object.keys(A),Z=B=>{let G=A[B];return{id:G.id,name:G.name,businessId:G.businessId,sku:G.code,numCode:G.codeN,category:G.category,unitCost:G.unitCost||0,unitOfMeasure:G.unitOfMeasure,minStockLevel:G.minStockLevel,maxStockLevel:G.maxStockLevel,isActive:G.isActive,description:G.description||"",createdDate:G.createdAt||new Date().toISOString(),lastModified:G.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(G.sellingPrice||G.price||"0")}},H=V.map(Z);s(H)}catch(A){console.warn("API failed, using local store:",A),s(Pt.products)}}catch(A){u(A instanceof Error?A.message:"Failed to load products")}finally{c(!1)}},{cancel:re}=l6(async A=>{if(!A.trim()){await v();return}try{u(null);const V=await S0.getAll(A);s(V.map(Z=>({id:Z.id||`prod-${Date.now()}-${Math.random()}`,name:Z.productName||Z.name||"Unknown Product",sku:Z.sku||Z.productCode||"",description:Z.description||"",category:Z.category||"General",unitOfMeasure:Z.unitOfMeasure||"pcs",unitCost:parseFloat(Z.unitCost||Z.cost||"0"),sellingPrice:parseFloat(Z.sellingPrice||Z.price||"0"),minStockLevel:parseInt(Z.minStockLevel||"0"),maxStockLevel:parseInt(Z.maxStockLevel||"100"),isActive:Z.isActive!==!1,createdDate:Z.createdDate||new Date().toISOString(),lastModified:Z.lastModified||new Date().toISOString(),businessId:Z.businessId||"YB100423253156428"})))}catch(V){u(V instanceof Error?V.message:"Search failed");const Z=Pt.products.filter(H=>H.name.toLowerCase().includes(A.toLowerCase())||H.sku.toLowerCase().includes(A.toLowerCase())||H.category.toLowerCase().includes(A.toLowerCase()));s(Z)}},300);Rc(()=>{re()}),Ut(()=>{let A=o();return n()&&(A=A.filter(V=>V.category===n())),A}),Ut(()=>[...new Set(o().map(V=>V.category))].sort()),Ut(()=>{const A=o().filter(H=>H.isActive),V=o().length,Z=o().filter(H=>Pt.getTotalStockByProduct(H.id)===0);return{total:V,active:A.length,outOfStock:Z.length}});const L=A=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(A),O={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},ne={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},X=A=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:A?"#ffebee":"#e8f5e8",color:A?"#d32f2f":"#2d7d32"});Ut(()=>{const A=Pt.products||[],V=Pt.movements||[],Z=Pt.stockLevels||[],H=Pt.getLowStockProducts(),B=A?.length||0,M=A?.filter(ie=>ie.isActive).length,G=Z.reduce((ie,me)=>ie*1+me.quantity*1*me.averageCost*1,0),Q=V?.filter(ie=>{const me=new Date(ie.createdDate),oe=new Date;return me.getMonth()===oe.getMonth()&&me.getFullYear()===oe.getFullYear()}).length;return{totalProducts:B,activeProducts:M,lowStockProducts:H.length,totalStockValue:G,totalMovementsThisMonth:Q,totalLocations:Pt.locations.length,activeLocations:Pt.getActiveLocations().length}});const W=Ut(()=>Pt.products.map(A=>{const V=Pt.getStockByProduct(A.id),Z=Pt.getTotalStockByProduct(A.id),H=Pt.getLastLocationByProduct(A.id);return{...A,totalStock:Z,stockByLocation:V,lastLocation:H,isLowStock:Z<=A.minStockLevel}})),se=Ut(()=>q().map(A=>{const V=Pt.getStockByProduct(A.id),Z=Pt.getTotalStockByProduct(A.id),H=Pt.getLastLocationByProduct(A.id);return{...A,totalStock:Z,stockByLocation:V,lastLocation:H,isLowStock:Z<=A.minStockLevel}})),F=Ut(()=>{const A=C()?se():W(),V=($()-1)*b(),Z=V+b();return A.slice(V,Z)}),k=Ut(()=>{const A=C()?se():W();return Math.ceil(A.length/b())}),N=A=>{Y(A),w(!0)};return I(Po,{get title(){return t("products.title","Products")},get children(){return[(()=>{var A=k6(),V=A.firstChild,Z=V.firstChild,H=Z.nextSibling,B=H.firstChild;return A.style.setProperty("display","flex"),A.style.setProperty("justify-content","space-between"),A.style.setProperty("align-items","flex-start"),A.style.setProperty("margin-bottom","1.5rem"),A.style.setProperty("flex-wrap","wrap"),A.style.setProperty("gap","1rem"),V.style.setProperty("flex","1"),V.style.setProperty("min-width","300px"),Z.style.setProperty("margin","0 0 1rem 0"),Z.style.setProperty("font-size","1.5rem"),a(Z,()=>t("inventory.products")),H.style.setProperty("display","flex"),H.style.setProperty("gap","1rem"),H.style.setProperty("align-items","center"),H.style.setProperty("flex-wrap","wrap"),B.style.setProperty("flex","1"),B.style.setProperty("min-width","250px"),a(B,I(T6,{onSearchResults:M=>{J(M),P(M.length>0)},get placeholder(){return t("inventory.searchProductsStock","Search products and check stock levels...")},showResults:!1,maxResults:20})),a(H,I(_t,{variant:"outline",onClick:()=>{z(),P(!1)},get children(){return[" ",Te(()=>t("common.showAll","Show All"))]}}),null),a(A,I(Oe,{get when(){return vr.hasPermission("read_write")},get children(){return I(_t,{variant:"primary",onClick:()=>j(!0),get children(){return[" ",Te(()=>t("inventory.addProduct"))]}})}}),null),A})(),(()=>{var A=N6(),V=A.firstChild;return A.style.setProperty("margin-bottom","1rem"),A.style.setProperty("font-size","0.875rem"),A.style.setProperty("color","var(--text-muted)"),A.style.setProperty("display","flex"),A.style.setProperty("justify-content","space-between"),A.style.setProperty("align-items","center"),a(V,(()=>{var Z=Te(()=>!!C());return()=>Z()?`${t("inventory.searchResults","Search Results")}: ${se().length} ${t("common.products","products")}`:`${t("inventory.totalProducts","Total Products")}: ${W().length} ${t("common.products","products")}`})()),a(A,(()=>{var Z=Te(()=>!!C());return()=>Z()&&(()=>{var H=L6();return H.firstChild,H.style.setProperty("color","var(--primary-color)"),a(H,()=>t("inventory.filtered","Filtered view"),null),H})()})(),null),A})(),I(Ct,{get each(){return F()},children:A=>(()=>{var V=R6(),Z=V.firstChild,H=Z.firstChild,B=H.firstChild,M=B.firstChild,G=M.nextSibling,Q=B.nextSibling,ie=Q.nextSibling,me=ie.firstChild,oe=H.nextSibling,ee=oe.firstChild,de=ee.nextSibling,he=de.firstChild,le=he.nextSibling;le.nextSibling;var ye=de.nextSibling,ve=ye.firstChild;return V.$$click=()=>N(A),V.addEventListener("mouseleave",pe=>{pe.currentTarget.style.transform="translateY(0)",pe.currentTarget.style.boxShadow="none"}),V.addEventListener("mouseenter",pe=>{pe.currentTarget.style.transform="translateY(-2px)",pe.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),p(V,O),p(Z,ne),B.style.setProperty("display","flex"),B.style.setProperty("align-items","center"),B.style.setProperty("gap","0.5rem"),B.style.setProperty("margin-bottom","0.5rem"),M.style.setProperty("margin","0"),M.style.setProperty("font-size","1.1rem"),a(M,()=>A.name),a(G,(()=>{var pe=Te(()=>!!A.isLowStock);return()=>pe()?t("inventory.lowStockAlert"):t("inventory.inStock")})()),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),a(Q,()=>A.sku,null),a(Q,()=>A.UPC?"  "+A.UPC:"",null),a(Q,()=>A.category?"  "+A.category:"",null),ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-muted)"),a(ie,()=>t("inventory.lastSeen"),me),a(ie,()=>A.lastLocation?.name||t("inventory.noMovements"),null),oe.style.setProperty("text-align","right"),ee.style.setProperty("font-size","1.25rem"),ee.style.setProperty("font-weight","700"),ee.style.setProperty("color","var(--primary-color)"),a(ee,()=>A.totalStock),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("color","var(--text-muted)"),a(de,()=>A.unitOfMeasure,he),a(de,()=>t("inventory.min"),le),a(de,()=>A.minStockLevel,null),ye.style.setProperty("font-size","0.875rem"),ye.style.setProperty("color","var(--text-muted)"),a(ye,()=>t("inventory.cost"),ve),a(ye,()=>L(A.unitCost),null),a(V,(()=>{var pe=Te(()=>A?.stockByLocation?.length>0);return()=>pe()&&(()=>{var ge=D6(),ke=ge.firstChild,Ne=ke.firstChild,xe=ke.nextSibling;return ge.style.setProperty("margin-top","1rem"),ke.style.setProperty("font-weight","500"),ke.style.setProperty("margin-bottom","0.5rem"),ke.style.setProperty("font-size","0.875rem"),a(ke,()=>t("inventory.stockByLocation"),Ne),xe.style.setProperty("display","flex"),xe.style.setProperty("flex-wrap","wrap"),xe.style.setProperty("gap","0.5rem"),a(xe,I(Ct,{get each(){return A.stockByLocation},children:$e=>{const Ee=Pt.getLocationById($e.locationId);return(()=>{var Me=M6(),Ye=Me.firstChild;return Me.style.setProperty("padding","0.25rem 0.5rem"),Me.style.setProperty("background","var(--background-color)"),Me.style.setProperty("border-radius","var(--border-radius-sm)"),Me.style.setProperty("font-size","0.75rem"),Me.style.setProperty("border","1px solid var(--border-color)"),a(Me,()=>Ee?.name,Ye),a(Me,()=>$e.quantity,null),Me})()}})),ge})()})(),null),fe(pe=>p(G,X(A.isLowStock),pe)),V})()}),Te(()=>Te(()=>k()>1)()&&(()=>{var A=F6(),V=A.firstChild,Z=V.firstChild,H=Z.firstChild,B=Z.nextSibling,M=V.nextSibling,G=M.firstChild,Q=G.firstChild,ie=Q.nextSibling,me=ie.nextSibling,oe=me.firstChild,ee=M.nextSibling;return A.style.setProperty("display","flex"),A.style.setProperty("justify-content","space-between"),A.style.setProperty("align-items","center"),A.style.setProperty("margin-top","2rem"),A.style.setProperty("padding","1rem"),A.style.setProperty("background","var(--surface-color)"),A.style.setProperty("border-radius","var(--border-radius)"),A.style.setProperty("border","1px solid var(--border-color)"),V.style.setProperty("display","flex"),V.style.setProperty("align-items","center"),V.style.setProperty("gap","0.5rem"),Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-muted)"),a(Z,()=>t("common.showPerPage","Show per page"),H),B.addEventListener("change",de=>{S(parseInt(de.target.value)),D(1)}),B.style.setProperty("padding","0.25rem 0.5rem"),B.style.setProperty("border","1px solid var(--border-color)"),B.style.setProperty("border-radius","var(--border-radius-sm)"),B.style.setProperty("background","var(--background-color)"),B.style.setProperty("cursor","pointer"),M.style.setProperty("display","flex"),M.style.setProperty("align-items","center"),M.style.setProperty("gap","0.5rem"),a(M,I(_t,{variant:"outline",size:"sm",onClick:()=>D(1),get disabled(){return $()===1},get children(){return t("common.first","First")}}),G),a(M,I(_t,{variant:"outline",size:"sm",onClick:()=>D(de=>Math.max(1,de-1)),get disabled(){return $()===1},get children(){return t("common.previous","Previous")}}),G),G.style.setProperty("display","flex"),G.style.setProperty("align-items","center"),G.style.setProperty("gap","0.25rem"),Q.style.setProperty("font-size","0.875rem"),a(Q,()=>t("common.page","Page")),ie.addEventListener("change",de=>{const he=parseInt(de.target.value);he>=1&&he<=k()&&D(he)}),ie.style.setProperty("width","60px"),ie.style.setProperty("padding","0.25rem 0.5rem"),ie.style.setProperty("border","1px solid var(--border-color)"),ie.style.setProperty("border-radius","var(--border-radius-sm)"),ie.style.setProperty("text-align","center"),ie.style.setProperty("font-size","0.875rem"),me.style.setProperty("font-size","0.875rem"),a(me,()=>t("common.of","of"),oe),a(me,k,null),a(M,I(_t,{variant:"outline",size:"sm",onClick:()=>D(de=>Math.min(k(),de+1)),get disabled(){return $()===k()},get children(){return t("common.next","Next")}}),null),a(M,I(_t,{variant:"outline",size:"sm",onClick:()=>D(k()),get disabled(){return $()===k()},get children(){return t("common.last","Last")}}),null),ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),a(ee,()=>{const de=C()?se():W(),he=($()-1)*b()+1,le=Math.min($()*b(),de.length);return t("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:he,end:le,total:de.length})}),fe(()=>ir(ie,"max",k())),fe(()=>B.value=b()),fe(()=>ie.value=$()),A})()),I(og,{get isOpen(){return y()},onClose:()=>g(!1),onProductAdded:()=>{v()}}),I(w6,{get isOpen(){return f()},onClose:()=>{w(!1),Y(null)},get product(){return T()},onEdit:()=>{w(!1),x(!0)}})]}})};br(["click"]);var O6=ae("<div><div></div><div>"),B6=ae("<div><div><img></div><div>X</div><div><div><h2></h2><div></div></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),j6=ae("<div>"),V6=ae("<div><div></div><h3></h3><p>"),q6=ae("<div><div>"),z6=ae("<div>"),U6=ae("<div><div><img loading=lazy></div><div><div></div><div>  </div><div></div><div>",!0,!1,!1);const H6=t=>{const{t:e}=_r(),[r,n]=we(null),[i,o]=we([]),[s,l]=we(!1),c=O=>{n(O),t.onProductSelect?.(O)},d=()=>{n(null),t.onProductSelect?.(null),o([]),l(!1)},u=O=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(O),y=()=>"YABABYSSolution",g=()=>"https://qvamarkets.s3.us-east-2.amazonaws.com/V2_images/7258/",f=O=>{if(O.productImageUrl)return g()+y()+"/"+O?.productImageUrl;const ne={Electronics:"https://via.placeholder.com/400x300/4F46E5/FFFFFF?text=Electronics",Furniture:"https://via.placeholder.com/400x300/059669/FFFFFF?text=Furniture",Food:"https://via.placeholder.com/400x300/DC2626/FFFFFF?text=Food",Clothing:"https://via.placeholder.com/400x300/7C3AED/FFFFFF?text=Clothing",Tools:"https://via.placeholder.com/400x300/EA580C/FFFFFF?text=Tools",General:"https://via.placeholder.com/400x300/6B7280/FFFFFF?text=Product"};return ne[O.category]||ne.General},w={padding:"2rem"},E={"max-width":"600px",margin:"0 auto 2rem",position:"relative"},x={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},T={background:"var(--surface-color)","border-radius":"var(--border-radius)",overflow:"hidden","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.3s ease"},Y={position:"relative",width:"100%",height:"200px",overflow:"hidden",background:"#f5f5f5"},K={width:"100%",height:"100%","object-fit":"cover",transition:"transform 0.3s ease"},j={padding:"1rem"},q={"font-size":"1rem","font-weight":"600","margin-bottom":"0.5rem",color:"var(--text-primary)",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},J={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.25rem"},C={"font-size":"1.25rem","font-weight":"700",color:"var(--primary-color)","margin-top":"0.5rem"},P={display:"flex",gap:"2rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"2rem","box-shadow":"var(--shadow-md)","margin-bottom":"2rem",position:"relative"},$={width:"400px",height:"300px","border-radius":"var(--border-radius)",overflow:"hidden",background:"#f5f5f5"},D={flex:"1",display:"flex","flex-direction":"column",gap:"1rem"},b={display:"flex","justify-content":"space-between","padding-bottom":"0.5rem","border-bottom":"1px solid var(--border-light)"},S={"font-weight":"500",color:"var(--text-muted)"},v={"font-weight":"600",color:"var(--text-primary)"},z=O=>({display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600",background:"#d4edda",color:"#155724"}),re={"text-align":"center",padding:"4rem 2rem",color:"var(--text-muted)"},L={"font-size":"3rem","margin-bottom":"1rem",opacity:"0.5"};return(()=>{var O=q6(),ne=O.firstChild;return p(O,w),a(ne,I(Ap,{onChange:X=>{console.log(X);let W=X;l(!0),c(W)},get placeholder(){return e("inventory.searchProductsImages","Search products to view images...")}})),a(O,I(Oe,{get when(){return r()&&t.showDetails!==!1},get children(){var X=B6(),W=X.firstChild,se=W.firstChild,F=W.nextSibling,k=F.nextSibling,N=k.firstChild,A=N.firstChild,V=A.nextSibling,Z=N.nextSibling,H=Z.firstChild,B=H.nextSibling,M=Z.nextSibling,G=M.firstChild,Q=G.nextSibling,ie=M.nextSibling,me=ie.firstChild,oe=me.nextSibling,ee=ie.nextSibling,de=ee.firstChild,he=de.nextSibling,le=ee.nextSibling,ye=le.firstChild,ve=ye.nextSibling;return p(X,P),p(W,$),se.style.setProperty("width","100%"),se.style.setProperty("height","100%"),se.style.setProperty("object-fit","contain"),se.style.setProperty("aspect-ratio","1 / 1"),F.$$click=()=>{d()},F.style.setProperty("position","absolute"),F.style.setProperty("top","0.5rem"),F.style.setProperty("right","0.5rem"),F.style.setProperty("color","#3d3d3d"),F.style.setProperty("border-radius","50%"),F.style.setProperty("width","2rem"),F.style.setProperty("height","2rem"),F.style.setProperty("display","flex"),F.style.setProperty("align-items","center"),F.style.setProperty("justify-content","center"),F.style.setProperty("font-size","1.25rem"),F.style.setProperty("box-shadow","var(--shadow-sm)"),F.style.setProperty("cursor","pointer"),p(k,D),A.style.setProperty("margin","0 0 0.5rem 0"),A.style.setProperty("font-size","1.5rem"),a(A,()=>r().name),a(V,()=>e("products.inStock","In Stock")),a(H,()=>e("products.sku","SKU")),a(B,()=>r().sku),a(G,()=>e("inventory.category","Category")),a(Q,()=>r().category),a(me,()=>e("inventory.unitOfMeasure","Unit")),a(oe,()=>r().unitOfMeasure),a(de,()=>e("inventory.unitCost","Cost")),a(he,()=>u(r().unitCost)),a(ye,()=>e("inventory.UPC","UPC")),a(ve,()=>r().UPC),a(k,I(Oe,{get when(){return r().description},get children(){var pe=O6(),ge=pe.firstChild,ke=ge.nextSibling;return pe.style.setProperty("margin-top","1rem"),a(ge,()=>e("common.description","Description")),ke.style.setProperty("margin-top","0.5rem"),ke.style.setProperty("color","var(--text-primary)"),a(ke,()=>r().description),fe(Ne=>p(ge,S,Ne)),pe}}),null),fe(pe=>{var ge=f(r()),ke=r().name,Ne=z(),xe=b,$e=S,Ee=v,Me=b,Ye=S,ze=v,je=b,Xe=S,ht=v,ut=b,Ue=S,it=v,dt=b,Fe=S,Be=v;return ge!==pe.e&&ir(se,"src",pe.e=ge),ke!==pe.t&&ir(se,"alt",pe.t=ke),pe.a=p(V,Ne,pe.a),pe.o=p(Z,xe,pe.o),pe.i=p(H,$e,pe.i),pe.n=p(B,Ee,pe.n),pe.s=p(M,Me,pe.s),pe.h=p(G,Ye,pe.h),pe.r=p(Q,ze,pe.r),pe.d=p(ie,je,pe.d),pe.l=p(me,Xe,pe.l),pe.u=p(oe,ht,pe.u),pe.c=p(ee,ut,pe.c),pe.w=p(de,Ue,pe.w),pe.m=p(he,it,pe.m),pe.f=p(le,dt,pe.f),pe.y=p(ye,Fe,pe.y),pe.g=p(ve,Be,pe.g),pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),X}}),null),a(O,I(Oe,{get when(){return i().length>0},get children(){var X=j6();return p(X,x),a(X,I(Ct,{get each(){return i()},children:W=>(()=>{var se=U6(),F=se.firstChild,k=F.firstChild,N=F.nextSibling,A=N.firstChild,V=A.nextSibling,Z=V.firstChild,H=V.nextSibling,B=H.nextSibling;return se.addEventListener("mouseleave",M=>{M.currentTarget.style.transform="translateY(0)",M.currentTarget.style.boxShadow="var(--shadow-sm)";const G=M.currentTarget.querySelector("img");G&&(G.style.transform="scale(1)")}),se.addEventListener("mouseenter",M=>{M.currentTarget.style.transform="translateY(-4px)",M.currentTarget.style.boxShadow="var(--shadow-lg)";const G=M.currentTarget.querySelector("img");G&&(G.style.transform="scale(1.05)")}),se.$$click=()=>c(W),p(se,T),a(F,I(Oe,{get when(){return W===r()},get children(){var M=z6();return M.style.setProperty("position","absolute"),M.style.setProperty("top","0.5rem"),M.style.setProperty("right","0.5rem"),M.style.setProperty("background","var(--primary-color)"),M.style.setProperty("color","white"),M.style.setProperty("border-radius","50%"),M.style.setProperty("width","2rem"),M.style.setProperty("height","2rem"),M.style.setProperty("display","flex"),M.style.setProperty("align-items","center"),M.style.setProperty("justify-content","center"),M.style.setProperty("font-size","1.25rem"),M}}),null),p(N,j),a(A,()=>W.name),a(V,()=>W.sku,Z),a(V,()=>W.category,null),a(H,()=>W.unitOfMeasure),p(B,C),a(B,()=>u(W.sellingPrice)),fe(M=>{var G=Y,Q=f(W),ie=W.name,me=K,oe=q,ee=W.name,de=J,he=J;return M.e=p(F,G,M.e),Q!==M.t&&ir(k,"src",M.t=Q),ie!==M.a&&ir(k,"alt",M.a=ie),M.o=p(k,me,M.o),M.i=p(A,oe,M.i),ee!==M.n&&ir(A,"title",M.n=ee),M.s=p(V,de,M.s),M.h=p(H,he,M.h),M},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),se})()})),X}}),null),a(O,I(Oe,{get when(){return!r()},get children(){var X=V6(),W=X.firstChild,se=W.nextSibling,F=se.nextSibling;return p(W,L),se.style.setProperty("margin-bottom","0.5rem"),a(se,()=>e("inventory.noProductsFound","No Products Found")),a(F,()=>e("inventory.tryDifferentSearch","Try a different search term")),fe(k=>p(X,re,k)),X}}),null),fe(X=>p(ne,E,X)),O})()};br(["click"]);var G6=ae("<button>"),W6=ae("<div><h3></h3><button> "),Y6=ae("<div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),Pm=ae("<div><strong>:</strong> "),K6=ae("<div>"),J6=ae("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),Q6=ae("<div><div><h2></h2><div><select><option value=date></option><option value=quantity></option><option value=value></option></select></div></div><div>"),X6=ae("<div><div><h3></h3><div></div></div><div><span></span><div>"),Z6=ae("<div><div><strong>:</strong> "),eN=ae("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),tN=ae("<div><button></button><button>"),rN=ae("<tr><td></td><td></td><td></td><td></td><td></td><td>");const nN=t=>{const{t:e}=_r(),[r,n]=we(null),[i,o]=we("date"),s=Ut(()=>{const g=t.movements||Pt.movements,f=new Map;return g.forEach(w=>{const E=w.referenceNumber||w.ssg_inventory_key||w.invoiceId||"UNKNOWN";if(!f.has(E)){const Y=Pt.getLocationById(w.locationId);f.set(E,{referenceNumber:w.referenceNumber||"",invoiceId:w.invoiceId||"",ssg_inventory_key:w.ssg_inventory_key||"",movementType:w.movementType||"unknown",locationId:w.locationId||"",locationName:Y?.name||"Unknown Location",totalItems:0,totalQuantity:0,createDate:w.createDate||new Date().toISOString(),description:w.description||"",generalNotes:w.generalNotes||"",movements:[],totalValue:0})}const x=f.get(E);x.movements.push(w),x.totalItems++,x.totalQuantity+=Math.abs(w.quantity||0);const T=Pt.getProductById(w.productId);T&&T.unitCost&&(x.totalValue+=Math.abs(w.quantity||0)*T.unitCost)}),Array.from(f.values()).sort((w,E)=>{switch(i()){case"quantity":return E.totalQuantity-w.totalQuantity;case"value":return E.totalValue-w.totalValue;case"date":default:return new Date(E.createDate).getTime()-new Date(w.createDate).getTime()}})}),l=g=>new Date(g).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),c=g=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(g),d=g=>{switch(g.toLowerCase()){case"in":case"stock_in":return"#22c55e";case"out":case"stock_out":return"#ef4444";case"transfer":return"#3b82f6";case"adjustment":return"#f59e0b";default:return"#6b7280"}},u=g=>{switch(g.toLowerCase()){case"in":case"stock_in":return"";case"out":case"stock_out":return"";case"transfer":return"";case"adjustment":return"";default:return""}},y=g=>{const f=g||r();if(!f)return;const w=window.open("","_blank");if(!w)return;const E=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Bulk Movement Report - ${f.referenceNumber||f.invoiceId}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 20px; }
          .group-info { background: #f8f9fa; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
          .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
          table { width: 100%; border-collapse: collapse; margin-top: 15px; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background-color: #f2f2f2; font-weight: bold; }
          .summary { background: #e8f4fd; padding: 15px; margin-top: 20px; border-radius: 5px; }
          @media print { body { margin: 0; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>BULK MOVEMENT REPORT</h1>
          <h2>${f.referenceNumber||f.invoiceId}</h2>
          <p>Generated: ${l(new Date().toISOString())}</p>
        </div>
        
        <div class="group-info">
          <div class="info-grid">
            <div>
              <strong>Reference Number:</strong> ${f.referenceNumber||"N/A"}<br>
              <strong>Invoice ID:</strong> ${f.invoiceId||"N/A"}<br>
              <strong>Movement Type:</strong> ${f.movementType.toUpperCase()}<br>
              <strong>Location:</strong> ${f.locationName}
            </div>
            <div>
              <strong>Date:</strong> ${l(f.createDate)}<br>
              <strong>Total Items:</strong> ${f.totalItems}<br>
              <strong>Total Quantity:</strong> ${f.totalQuantity}<br>
              <strong>Estimated Value:</strong> ${c(f.totalValue)}
            </div>
          </div>
          ${f.description?`<p><strong>Description:</strong> ${f.description}</p>`:""}
          ${f.generalNotes?`<p><strong>Notes:</strong> ${f.generalNotes}</p>`:""}
        </div>
        
        <table>
          <thead>
            <tr>
              <th>Product Code</th>
              <th>Product Name</th>
              <th>Quantity</th>
              <th>Unit Cost</th>
              <th>Total Value</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody>
            ${f.movements.map(x=>{const T=Pt.getProductById(x.productId),Y=T?.unitCost||0,K=Math.abs(x.quantity||0)*Y;return`
                <tr>
                  <td>${T?.code||x.productId}</td>
                  <td>${T?.name||"Unknown Product"}</td>
                  <td>${x.quantity||0}</td>
                  <td>${c(Y)}</td>
                  <td>${c(K)}</td>
                  <td>${x.notes||"-"}</td>
                </tr>
              `}).join("")}
          </tbody>
        </table>
        
        <div class="summary">
          <h3>SUMMARY</h3>
          <p><strong>Total Products:</strong> ${f.totalItems}</p>
          <p><strong>Total Quantity Moved:</strong> ${f.totalQuantity}</p>
          <p><strong>Total Estimated Value:</strong> ${c(f.totalValue)}</p>
          <p><strong>Movement Impact:</strong> ${f.movementType==="in"?"Increased":f.movementType==="out"?"Decreased":"Adjusted"} inventory</p>
        </div>
      </body>
      </html>
    `;w.document.write(E),w.document.close(),w.print()};return(()=>{var g=Q6(),f=g.firstChild,w=f.firstChild,E=w.nextSibling,x=E.firstChild,T=x.firstChild,Y=T.nextSibling,K=Y.nextSibling,j=f.nextSibling;return g.style.setProperty("padding","1rem"),f.style.setProperty("display","flex"),f.style.setProperty("justify-content","space-between"),f.style.setProperty("align-items","center"),f.style.setProperty("margin-bottom","2rem"),a(w,()=>e("inventory.bulkMovementReport","Bulk Movement Report")),E.style.setProperty("display","flex"),E.style.setProperty("gap","1rem"),x.addEventListener("change",q=>o(q.currentTarget.value)),x.style.setProperty("padding","0.5rem"),a(T,()=>e("common.sortByDate","Sort by Date")),a(Y,()=>e("common.sortByQuantity","Sort by Quantity")),a(K,()=>e("common.sortByValue","Sort by Value")),a(E,I(Oe,{get when(){return t.onClose},get children(){var q=G6();return Xn(q,"click",t.onClose,!0),q.style.setProperty("padding","0.5rem 1rem"),q.style.setProperty("background","#6c757d"),q.style.setProperty("color","white"),q.style.setProperty("border","none"),q.style.setProperty("border-radius","var(--border-radius-sm)"),q.style.setProperty("cursor","pointer"),a(q,()=>e("common.close","Close")),q}}),null),j.style.setProperty("display","grid"),j.style.setProperty("grid-template-columns","repeat(auto-fill, minmax(400px, 1fr))"),j.style.setProperty("gap","1rem"),j.style.setProperty("margin-bottom","2rem"),a(j,I(Ct,{get each(){return s()},children:q=>I(Gt,{get style(){return{cursor:"pointer",border:r()===q?"2px solid var(--primary-color)":"1px solid #e9ecef",transition:"all 0.2s"}},onClick:()=>n(q),get children(){return[(()=>{var J=X6(),C=J.firstChild,P=C.firstChild,$=P.nextSibling,D=C.nextSibling,b=D.firstChild,S=b.nextSibling;return J.style.setProperty("display","flex"),J.style.setProperty("justify-content","space-between"),J.style.setProperty("align-items","flex-start"),J.style.setProperty("margin-bottom","1rem"),P.style.setProperty("margin","0 0 0.5rem 0"),P.style.setProperty("font-size","1.1rem"),a(P,()=>q.referenceNumber||q.invoiceId||"No Reference"),$.style.setProperty("font-size","0.875rem"),$.style.setProperty("color","#6c757d"),a($,()=>l(q.createDate)),D.style.setProperty("text-align","center"),b.style.setProperty("font-size","1.5rem"),a(b,()=>u(q.movementType)),S.style.setProperty("font-size","0.75rem"),S.style.setProperty("font-weight","bold"),a(S,()=>q.movementType.toUpperCase()),fe(v=>(v=d(q.movementType))!=null?S.style.setProperty("color",v):S.style.removeProperty("color")),J})(),(()=>{var J=Z6(),C=J.firstChild,P=C.firstChild,$=P.firstChild;return P.nextSibling,J.style.setProperty("margin-bottom","1rem"),C.style.setProperty("font-size","0.875rem"),C.style.setProperty("margin-bottom","0.25rem"),a(P,()=>e("inventory.location","Location"),$),a(C,()=>q.locationName,null),a(J,I(Oe,{get when(){return q.description},get children(){var D=Pm(),b=D.firstChild,S=b.firstChild;return b.nextSibling,D.style.setProperty("font-size","0.875rem"),D.style.setProperty("margin-bottom","0.25rem"),a(b,()=>e("common.description","Description"),S),a(D,()=>q.description,null),D}}),null),J})(),(()=>{var J=eN(),C=J.firstChild,P=C.firstChild,$=P.nextSibling,D=C.nextSibling,b=D.firstChild,S=b.nextSibling,v=D.nextSibling,z=v.firstChild,re=z.nextSibling;return J.style.setProperty("display","grid"),J.style.setProperty("grid-template-columns","repeat(3, 1fr)"),J.style.setProperty("gap","0.5rem"),J.style.setProperty("margin-bottom","1rem"),C.style.setProperty("text-align","center"),C.style.setProperty("padding","0.5rem"),C.style.setProperty("background","#f8f9fa"),C.style.setProperty("border-radius","var(--border-radius-sm)"),P.style.setProperty("font-weight","bold"),P.style.setProperty("color","#3b82f6"),a(P,()=>q.totalItems),$.style.setProperty("font-size","0.75rem"),$.style.setProperty("color","#6c757d"),a($,()=>e("inventory.items","Items")),D.style.setProperty("text-align","center"),D.style.setProperty("padding","0.5rem"),D.style.setProperty("background","#f8f9fa"),D.style.setProperty("border-radius","var(--border-radius-sm)"),b.style.setProperty("font-weight","bold"),b.style.setProperty("color","#22c55e"),a(b,()=>q.totalQuantity),S.style.setProperty("font-size","0.75rem"),S.style.setProperty("color","#6c757d"),a(S,()=>e("inventory.quantity","Quantity")),v.style.setProperty("text-align","center"),v.style.setProperty("padding","0.5rem"),v.style.setProperty("background","#f8f9fa"),v.style.setProperty("border-radius","var(--border-radius-sm)"),z.style.setProperty("font-weight","bold"),z.style.setProperty("color","#f59e0b"),a(z,()=>c(q.totalValue)),re.style.setProperty("font-size","0.75rem"),re.style.setProperty("color","#6c757d"),a(re,()=>e("common.value","Value")),J})(),(()=>{var J=tN(),C=J.firstChild,P=C.nextSibling;return J.style.setProperty("display","flex"),J.style.setProperty("gap","0.5rem"),C.$$click=$=>{$.stopPropagation(),n(q)},C.style.setProperty("flex","1"),C.style.setProperty("padding","0.5rem"),C.style.setProperty("background","var(--primary-color)"),C.style.setProperty("color","white"),C.style.setProperty("border","none"),C.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("cursor","pointer"),C.style.setProperty("font-size","0.875rem"),a(C,()=>e("common.viewDetails","View Details")),P.$$click=$=>{$.stopPropagation(),y(q)},P.style.setProperty("padding","0.5rem"),P.style.setProperty("background","#22c55e"),P.style.setProperty("color","white"),P.style.setProperty("border","none"),P.style.setProperty("border-radius","var(--border-radius-sm)"),P.style.setProperty("cursor","pointer"),P.style.setProperty("font-size","0.875rem"),J})()]}})})),a(g,I(Oe,{get when(){return r()},get children(){return I(Gt,{get children(){return[(()=>{var q=W6(),J=q.firstChild,C=J.nextSibling;return C.firstChild,q.style.setProperty("display","flex"),q.style.setProperty("justify-content","space-between"),q.style.setProperty("align-items","center"),q.style.setProperty("margin-bottom","1rem"),a(J,()=>e("inventory.movementDetails","Movement Details")),C.$$click=()=>y(),C.style.setProperty("padding","0.5rem 1rem"),C.style.setProperty("background","#22c55e"),C.style.setProperty("color","white"),C.style.setProperty("border","none"),C.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("cursor","pointer"),a(C,()=>e("common.print","Print Report"),null),q})(),(()=>{var q=Y6(),J=q.firstChild,C=J.firstChild,P=C.firstChild,$=P.firstChild;P.nextSibling;var D=C.nextSibling,b=D.firstChild,S=b.firstChild;b.nextSibling;var v=D.nextSibling,z=v.firstChild,re=z.firstChild;z.nextSibling;var L=v.nextSibling,O=L.firstChild,ne=O.firstChild;O.nextSibling;var X=J.nextSibling,W=X.firstChild,se=W.firstChild,F=se.firstChild;se.nextSibling;var k=W.nextSibling,N=k.firstChild,A=N.firstChild;N.nextSibling;var V=k.nextSibling,Z=V.firstChild,H=Z.firstChild;Z.nextSibling;var B=V.nextSibling,M=B.firstChild,G=M.firstChild;return M.nextSibling,q.style.setProperty("display","grid"),q.style.setProperty("grid-template-columns","repeat(2, 1fr)"),q.style.setProperty("gap","1rem"),q.style.setProperty("margin-bottom","2rem"),q.style.setProperty("padding","1rem"),q.style.setProperty("background","#f8f9fa"),q.style.setProperty("border-radius","var(--border-radius-sm)"),a(P,()=>e("inventory.referenceNumber","Reference"),$),a(C,()=>r()?.referenceNumber||"N/A",null),a(b,()=>e("inventory.invoiceId","Invoice ID"),S),a(D,()=>r()?.invoiceId||"N/A",null),a(z,()=>e("inventory.movementType","Type"),re),a(v,()=>r()?.movementType.toUpperCase(),null),a(O,()=>e("inventory.location","Location"),ne),a(L,()=>r()?.locationName,null),a(se,()=>e("common.date","Date"),F),a(W,(()=>{var Q=Te(()=>!!r());return()=>Q()?l(r().createDate):""})(),null),a(N,()=>e("inventory.totalItems","Total Items"),A),a(k,()=>r()?.totalItems,null),a(Z,()=>e("inventory.totalQuantity","Total Quantity"),H),a(V,()=>r()?.totalQuantity,null),a(M,()=>e("common.estimatedValue","Estimated Value"),G),a(B,(()=>{var Q=Te(()=>!!r());return()=>Q()?c(r().totalValue):""})(),null),q})(),I(Oe,{get when(){return r()?.description||r()?.generalNotes},get children(){var q=K6();return q.style.setProperty("margin-bottom","2rem"),q.style.setProperty("padding","1rem"),q.style.setProperty("background","#e8f4fd"),q.style.setProperty("border-radius","var(--border-radius-sm)"),a(q,I(Oe,{get when(){return r()?.description},get children(){var J=Pm(),C=J.firstChild,P=C.firstChild;return C.nextSibling,a(C,()=>e("common.description","Description"),P),a(J,()=>r()?.description,null),J}}),null),a(q,I(Oe,{get when(){return r()?.generalNotes},get children(){var J=Pm(),C=J.firstChild,P=C.firstChild;return C.nextSibling,a(C,()=>e("common.notes","Notes"),P),a(J,()=>r()?.generalNotes,null),J}}),null),q}}),(()=>{var q=J6(),J=q.firstChild,C=J.firstChild,P=C.firstChild,$=P.firstChild,D=$.nextSibling,b=D.nextSibling,S=b.nextSibling,v=S.nextSibling,z=v.nextSibling,re=C.nextSibling;return q.style.setProperty("overflow-x","auto"),J.style.setProperty("width","100%"),J.style.setProperty("border-collapse","collapse"),P.style.setProperty("border-bottom","2px solid #dee2e6"),$.style.setProperty("padding","0.75rem"),$.style.setProperty("text-align","left"),a($,()=>e("inventory.productCode","Code")),D.style.setProperty("padding","0.75rem"),D.style.setProperty("text-align","left"),a(D,()=>e("inventory.productName","Product")),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","center"),a(b,()=>e("inventory.quantity","Quantity")),S.style.setProperty("padding","0.75rem"),S.style.setProperty("text-align","right"),a(S,()=>e("inventory.unitCost","Unit Cost")),v.style.setProperty("padding","0.75rem"),v.style.setProperty("text-align","right"),a(v,()=>e("common.totalValue","Total Value")),z.style.setProperty("padding","0.75rem"),z.style.setProperty("text-align","left"),a(z,()=>e("common.notes","Notes")),a(re,I(Ct,{get each(){return r()?.movements||[]},children:L=>{const O=Pt.getProductById(L.productId),ne=O?.unitCost||0,X=Math.abs(L.quantity||0)*ne;return(()=>{var W=rN(),se=W.firstChild,F=se.nextSibling,k=F.nextSibling,N=k.nextSibling,A=N.nextSibling,V=A.nextSibling;return W.style.setProperty("border-bottom","1px solid #dee2e6"),se.style.setProperty("padding","0.75rem"),se.style.setProperty("font-family","monospace"),a(se,()=>O?.code||L.productId),F.style.setProperty("padding","0.75rem"),a(F,()=>O?.name||"Unknown Product"),k.style.setProperty("padding","0.75rem"),k.style.setProperty("text-align","center"),k.style.setProperty("font-weight","bold"),a(k,()=>L.quantity||0),N.style.setProperty("padding","0.75rem"),N.style.setProperty("text-align","right"),a(N,()=>c(ne)),A.style.setProperty("padding","0.75rem"),A.style.setProperty("text-align","right"),A.style.setProperty("font-weight","bold"),a(A,()=>c(X)),V.style.setProperty("padding","0.75rem"),V.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","#6c757d"),a(V,()=>L.notes||"-"),fe(Z=>(Z=(L.quantity||0)>=0?"#22c55e":"#ef4444")!=null?k.style.setProperty("color",Z):k.style.removeProperty("color")),W})()}})),q})()]}})}}),null),fe(()=>x.value=i()),g})()};br(["click"]);var iN=ae("<div><div></div><div></div><div>"),X0=ae("<div>"),oN=ae("<div><div><div><h2> - </h2><button></button></div><div>"),sN=ae("<div><div><div><div><h3></h3><span></span></div><div></div></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const aN=t=>{const{t:e}=_r(),[r,n]=we(""),[i,o]=we(!1),s=Ut(()=>{const w=Pt.movements,E=new Map;return w.forEach(x=>{const T=x.referenceNumber||x.invoiceId||x.ssg_inventory_key||"UNKNOWN";E.has(T)||E.set(T,{referenceNumber:T,movements:[],totalItems:0,totalValue:0,createdDate:x.createdDate,movementType:x.movementType});const Y=E.get(T);Y.movements.push(x),Y.totalItems+=x.quantity,Y.totalValue+=x.totalCost,new Date(x.createdDate)<new Date(Y.createdDate)&&(Y.createdDate=x.createdDate)}),Array.from(E.values()).filter(x=>x.movements.length>1).sort((x,T)=>new Date(T.createdDate).getTime()-new Date(x.createdDate).getTime())}),l=Ut(()=>{const w=s().find(E=>E.referenceNumber===r());return w?w.movements:[]}),c=w=>{n(w),o(!0)},d=()=>{o(!1),n("")},u=w=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(w),y=w=>new Date(w).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),g=w=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[w]||w,f=w=>({in:"#4caf50",out:"#f44336",transfer:"#2196f3",adjustment:"#ff9800"})[w]||"#666";return[I(si,{get isOpen(){return Te(()=>!!t.isOpen)()&&!i()},get onClose(){return t.onClose},get title(){return e("inventory.viewHistoricalReports")},size:"large",get children(){var w=X0();return w.style.setProperty("max-height","70vh"),w.style.setProperty("overflow-y","auto"),a(w,I(Oe,{get when(){return s().length===0},get children(){var E=iN(),x=E.firstChild,T=x.nextSibling,Y=T.nextSibling;return E.style.setProperty("text-align","center"),E.style.setProperty("padding","3rem"),E.style.setProperty("color","var(--text-muted)"),x.style.setProperty("font-size","2rem"),x.style.setProperty("margin-bottom","1rem"),T.style.setProperty("font-size","1.1rem"),T.style.setProperty("margin-bottom","0.5rem"),a(T,()=>e("inventory.noBulkReportsFound","No bulk movement reports found")),Y.style.setProperty("font-size","0.9rem"),a(Y,()=>e("inventory.bulkReportsAppearHere","Bulk movement reports will appear here after you create bulk movements")),E}}),null),a(w,I(Oe,{get when(){return s().length>0},get children(){var E=X0();return E.style.setProperty("display","grid"),E.style.setProperty("gap","1rem"),a(E,I(Ct,{get each(){return s()},children:x=>(()=>{var T=sN(),Y=T.firstChild,K=Y.firstChild,j=K.firstChild,q=j.firstChild,J=q.nextSibling,C=j.nextSibling,P=Y.nextSibling,$=P.firstChild,D=$.firstChild,b=D.nextSibling,S=$.nextSibling,v=S.firstChild,z=v.nextSibling,re=S.nextSibling,L=re.firstChild,O=L.nextSibling;return T.style.setProperty("padding","1.5rem"),T.style.setProperty("border","1px solid var(--border-color)"),T.style.setProperty("border-radius","var(--border-radius)"),T.style.setProperty("background","var(--surface-color)"),T.style.setProperty("transition","all 0.2s ease"),Y.style.setProperty("display","flex"),Y.style.setProperty("justify-content","space-between"),Y.style.setProperty("align-items","flex-start"),Y.style.setProperty("margin-bottom","1rem"),K.style.setProperty("flex","1"),j.style.setProperty("display","flex"),j.style.setProperty("align-items","center"),j.style.setProperty("gap","1rem"),j.style.setProperty("margin-bottom","0.5rem"),q.style.setProperty("margin","0"),q.style.setProperty("font-size","1.1rem"),q.style.setProperty("color","var(--text-primary)"),a(q,()=>x.referenceNumber),J.style.setProperty("padding","0.25rem 0.75rem"),J.style.setProperty("border-radius","1rem"),J.style.setProperty("font-size","0.75rem"),J.style.setProperty("font-weight","500"),a(J,()=>g(x.movementType)),C.style.setProperty("color","var(--text-muted)"),C.style.setProperty("font-size","0.875rem"),a(C,()=>y(x.createdDate)),a(Y,I(_t,{variant:"outline",size:"sm",onClick:()=>c(x.referenceNumber),get children(){return e("common.view")}}),null),P.style.setProperty("display","grid"),P.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),P.style.setProperty("gap","1rem"),P.style.setProperty("margin-bottom","1rem"),D.style.setProperty("font-size","0.75rem"),D.style.setProperty("font-weight","500"),D.style.setProperty("text-transform","uppercase"),D.style.setProperty("color","var(--text-muted)"),D.style.setProperty("margin-bottom","0.25rem"),a(D,()=>e("inventory.totalProducts")),b.style.setProperty("font-size","1.25rem"),b.style.setProperty("font-weight","600"),b.style.setProperty("color","var(--primary-color)"),a(b,()=>x.movements.length),v.style.setProperty("font-size","0.75rem"),v.style.setProperty("font-weight","500"),v.style.setProperty("text-transform","uppercase"),v.style.setProperty("color","var(--text-muted)"),v.style.setProperty("margin-bottom","0.25rem"),a(v,()=>e("inventory.totalItems")),z.style.setProperty("font-size","1.25rem"),z.style.setProperty("font-weight","600"),z.style.setProperty("color","var(--primary-color)"),a(z,()=>x.totalItems),L.style.setProperty("font-size","0.75rem"),L.style.setProperty("font-weight","500"),L.style.setProperty("text-transform","uppercase"),L.style.setProperty("color","var(--text-muted)"),L.style.setProperty("margin-bottom","0.25rem"),a(L,()=>e("inventory.estimatedValue")),O.style.setProperty("font-size","1.25rem"),O.style.setProperty("font-weight","600"),O.style.setProperty("color","var(--primary-color)"),a(O,()=>u(x.totalValue)),fe(ne=>{var X=f(x.movementType)+"20",W=f(x.movementType);return X!==ne.e&&((ne.e=X)!=null?J.style.setProperty("background",X):J.style.removeProperty("background")),W!==ne.t&&((ne.t=W)!=null?J.style.setProperty("color",W):J.style.removeProperty("color")),ne},{e:void 0,t:void 0}),T})()})),E}}),null),w}}),I(Oe,{get when(){return i()},get children(){var w=oN(),E=w.firstChild,x=E.firstChild,T=x.firstChild,Y=T.firstChild,K=T.nextSibling,j=x.nextSibling;return w.style.setProperty("position","fixed"),w.style.setProperty("top","0"),w.style.setProperty("left","0"),w.style.setProperty("right","0"),w.style.setProperty("bottom","0"),w.style.setProperty("background","rgba(0, 0, 0, 0.5)"),w.style.setProperty("z-index","1000"),w.style.setProperty("display","flex"),w.style.setProperty("align-items","center"),w.style.setProperty("justify-content","center"),w.style.setProperty("padding","2rem"),E.style.setProperty("background","white"),E.style.setProperty("border-radius","var(--border-radius)"),E.style.setProperty("width","95%"),E.style.setProperty("max-width","1200px"),E.style.setProperty("max-height","90vh"),E.style.setProperty("overflow-y","auto"),E.style.setProperty("position","relative"),x.style.setProperty("padding","1rem 2rem"),x.style.setProperty("border-bottom","1px solid #e9ecef"),x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),x.style.setProperty("background","#f8f9fa"),T.style.setProperty("margin","0"),a(T,()=>e("inventory.bulkMovementReport"),Y),a(T,r,null),K.$$click=d,K.style.setProperty("background","none"),K.style.setProperty("border","none"),K.style.setProperty("font-size","1.5rem"),K.style.setProperty("cursor","pointer"),K.style.setProperty("padding","0.5rem"),K.style.setProperty("line-height","1"),j.style.setProperty("padding","1rem"),a(j,I(nN,{get movements(){return l()},onClose:d})),w}})]};br(["click"]);var lN=ae("<form><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text required></div></div><div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><div><label></label></div></div><div><div><h3></h3></div></div><div><label></label><textarea></textarea></div><div>"),cN=ae("<div><label> *"),dN=ae("<div><div></div><div></div><div></div><div></div><div>"),Sm=ae("<div>"),uN=ae("<div><input type=number min=0 step=1 required><input type=number min=0 step=0.01><input type=text>"),hN=ae("<div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span>"),pN=ae("<div> ");const mN=t=>{const{t:e}=_r(),[r,n]=we(`INV-${Date.now()}`),[i,o]=we(""),[s,l]=we("in"),[c,d]=we(""),[u,y]=we(""),[g,f]=we(""),[w,E]=we([]),[x,T]=we([]),[Y,K]=we(!1),[j,q]=we(!1),J=()=>{E(H=>[...H,{productId:"",quantity:0,unitCost:0,notes:""}])},C=H=>{E(B=>B.filter((M,G)=>G!==H))},P=(H,B,M)=>{E(G=>G.map((Q,ie)=>ie===H?{...Q,[B]:M}:Q))},$=()=>{n(`INV-${Date.now()}`),o(""),l("in"),d(""),y(""),f(""),E([]),T([])},D=async H=>{H.preventDefault(),T([]);const B=[];if(i()||B.push(e("forms.referenceNumberRequired")),c()||B.push(e("forms.locationRequired")),s()==="transfer"&&!u()&&B.push(e("forms.fromLocationRequired")),w().length===0&&B.push(e("forms.atLeastOneProduct")),w().forEach((Q,ie)=>{Q.productId||B.push(e("forms.itemProductRequired","Product is required for item {{index}}",{index:ie+1})),Q.quantity<=0&&B.push(e("forms.itemQuantityRequired","Quantity must be greater than 0 for item {{index}}",{index:ie+1}))}),B.length>0){T(B);return}const M={ssg_inventory_key:Nl(),invoiceId:r(),referenceNumber:i(),movementType:s(),type:cf(s()),locationId:c(),fromLocationId:s()==="transfer"?u():void 0,items:w(),products:w(),generalNotes:g(),description:g(),invoice:i(),store:c(),createdBy:"admin",createDate:new Date().toISOString()};console.log(M);const G=await Pt.addBulkInventoryMovements(M);console.log(G),G.success?t.onMovementComplete?t.onMovementComplete(i()):($(),t.onClose()):T(G.errors)},b=()=>{$(),t.onClose()},S=Ut(()=>w().reduce((H,B)=>{const M=Pt.getProductById(B.productId),G=B.unitCost||M?.unitCost||0;return H+B.quantity*G},0)),v=Ut(()=>w().reduce((H,B)=>H+B.quantity,0)),z={"margin-bottom":"1.5rem"},re={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},L={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},O={...L,cursor:"pointer"},ne={display:"grid",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},X={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},W={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem","padding-left":"0.75rem"},se={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},F={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},k={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},N={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},A=H=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(H),V=H=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[H]||H,Z=async H=>{await Pt.fecthInventory(H),await Pt.fecthProduct(H)};return jn(()=>{Z("prod")}),I(si,{get isOpen(){return t.isOpen},onClose:b,get title(){return e("inventory.bulkMovement")},get children(){return[(()=>{var H=lN(),B=H.firstChild,M=B.firstChild,G=M.firstChild,Q=G.firstChild,ie=G.nextSibling,me=M.nextSibling,oe=me.firstChild,ee=oe.firstChild,de=oe.nextSibling,he=B.nextSibling,le=he.firstChild,ye=le.firstChild,ve=le.nextSibling,pe=ve.firstChild,ge=pe.nextSibling,ke=ge.nextSibling,Ne=ke.nextSibling,xe=he.nextSibling,$e=xe.firstChild,Ee=$e.firstChild,Me=xe.nextSibling,Ye=Me.firstChild,ze=Ye.firstChild,je=Me.nextSibling,Xe=je.firstChild,ht=Xe.nextSibling,ut=je.nextSibling;return H.addEventListener("submit",D),B.style.setProperty("display","grid"),B.style.setProperty("grid-template-columns","1fr 1fr"),B.style.setProperty("gap","1rem"),B.style.setProperty("margin-bottom","1.5rem"),a(G,()=>e("common.invoiceDocumentId"),Q),ie.addEventListener("change",Ue=>n(Ue.target.value)),a(oe,()=>e("common.referenceNumber"),ee),de.addEventListener("change",Ue=>o(Ue.target.value)),a(le,()=>e("inventory.movementType"),ye),ve.addEventListener("change",Ue=>l(Ue.target.value)),a(pe,()=>e("inventory.purchaseReceive")),a(ge,()=>e("inventory.saleIssue")),a(ke,()=>e("inventory.transfer")),a(Ne,()=>e("inventory.adjustment")),xe.style.setProperty("display","grid"),xe.style.setProperty("gap","1rem"),xe.style.setProperty("margin-bottom","1.5rem"),a(xe,(()=>{var Ue=Te(()=>s()==="transfer");return()=>Ue()&&(()=>{var it=cN(),dt=it.firstChild,Fe=dt.firstChild;return a(dt,()=>e("inventory.fromLocation"),Fe),a(it,I(Kd,{get value(){return u()},onChange:Be=>y(Be),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>q(!0),required:!0}),null),fe(Be=>p(dt,re,Be)),it})()})(),$e),a(Ee,(()=>{var Ue=Te(()=>s()==="transfer");return()=>Ue()?e("inventory.toLocation")+" *":e("inventory.location")+" *"})()),a($e,I(Kd,{get value(){return c()},onChange:Ue=>d(Ue),get placeholder(){return Te(()=>s()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>q(!0),required:!0}),null),Ye.style.setProperty("display","flex"),Ye.style.setProperty("justify-content","space-between"),Ye.style.setProperty("align-items","center"),Ye.style.setProperty("margin-bottom","1rem"),ze.style.setProperty("margin","0"),ze.style.setProperty("font-size","1.1rem"),a(ze,()=>e("inventory.products")),a(Ye,I(_t,{variant:"outline",type:"button",onClick:J,get children(){return e("inventory.addProduct")}}),null),a(Me,(()=>{var Ue=Te(()=>w().length>0);return()=>Ue()&&[(()=>{var it=dN(),dt=it.firstChild,Fe=dt.nextSibling,Be=Fe.nextSibling,Re=Be.nextSibling;return p(it,W),a(dt,()=>e("inventory.product")),a(Fe,()=>e("inventory.quantity")),a(Be,()=>e("inventory.unitCost")),a(Re,()=>e("common.notes")),it})(),I(Ct,{get each(){return w()},children:(it,dt)=>[(()=>{var Fe=Sm();return p(Fe,ne),a(Fe,I(Ap,{get value(){return it.productId},onChange:Be=>{P(dt(),"productId",Be.id);let Re={id:Be.id,label:Be.name,code:Be.sku};P(dt(),"product",Re);const lt=Pt.getProductById(Be.id);lt&&!it.unitCost&&P(dt(),"unitCost",lt.unitCost)},get placeholder(){return e("inventory.searchProduct")},onAddNew:()=>K(!0),required:!0})),Fe})(),(()=>{var Fe=uN(),Be=Fe.firstChild,Re=Be.nextSibling,lt=Re.nextSibling;return p(Fe,X),Be.addEventListener("change",ot=>P(dt(),"quantity",Number(ot.target.value))),Re.addEventListener("change",ot=>P(dt(),"unitCost",Number(ot.target.value))),lt.addEventListener("change",ot=>P(dt(),"notes",ot.target.value)),a(Fe,I(_t,{variant:"outline",size:"sm",type:"button",onClick:()=>C(dt()),style:{color:"#f44336","border-color":"#f44336"},get children(){return e("common.remove")}}),null),fe(ot=>{var nt=L,Ve=L,qt=e("common.auto"),Mt=L,Qt=e("common.optionalNotes");return ot.e=p(Be,nt,ot.e),ot.t=p(Re,Ve,ot.t),qt!==ot.a&&ir(Re,"placeholder",ot.a=qt),ot.o=p(lt,Mt,ot.o),Qt!==ot.i&&ir(lt,"placeholder",ot.i=Qt),ot},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),fe(()=>Be.value=it.quantity),fe(()=>Re.value=it.unitCost),fe(()=>lt.value=it.notes),Fe})()]})]})(),null),a(Me,(()=>{var Ue=Te(()=>w().length===0);return()=>Ue()&&(()=>{var it=Sm();return it.style.setProperty("text-align","center"),it.style.setProperty("padding","2rem"),it.style.setProperty("background","var(--background-color)"),it.style.setProperty("border-radius","var(--border-radius-sm)"),it.style.setProperty("border","1px solid var(--border-color)"),it.style.setProperty("color","var(--text-muted)"),a(it,()=>e("inventory.noProductsAdded")),it})()})(),null),a(H,(()=>{var Ue=Te(()=>w().length>0);return()=>Ue()&&(()=>{var it=hN(),dt=it.firstChild,Fe=dt.nextSibling,Be=Fe.firstChild,Re=Be.firstChild,lt=Be.nextSibling,ot=Fe.nextSibling,nt=ot.firstChild,Ve=nt.firstChild,qt=nt.nextSibling,Mt=ot.nextSibling,Qt=Mt.firstChild,lr=Qt.firstChild,bt=Qt.nextSibling,yr=Mt.nextSibling,Cr=yr.firstChild,Kt=Cr.firstChild,sr=Cr.nextSibling;return p(it,se),dt.style.setProperty("margin","0 0 1rem 0"),dt.style.setProperty("font-size","1rem"),a(dt,()=>e("common.summary")),a(Be,()=>e("inventory.totalProducts"),Re),lt.style.setProperty("font-weight","600"),a(lt,()=>w().length),a(nt,()=>e("inventory.totalItems"),Ve),qt.style.setProperty("font-weight","600"),a(qt,v),a(Qt,()=>e("inventory.totalValue"),lr),bt.style.setProperty("font-weight","600"),bt.style.setProperty("color","var(--primary-color)"),a(bt,()=>A(S())),a(Cr,()=>e("inventory.movementType"),Kt),sr.style.setProperty("font-weight","600"),a(sr,()=>V(s())),fe(pt=>{var gt=F,Vt=F,gr=F,et=F;return pt.e=p(Fe,gt,pt.e),pt.t=p(ot,Vt,pt.t),pt.a=p(Mt,gr,pt.a),pt.o=p(yr,et,pt.o),pt},{e:void 0,t:void 0,a:void 0,o:void 0}),it})()})(),je),a(Xe,()=>e("common.generalNotes")),ht.addEventListener("change",Ue=>f(Ue.target.value)),a(H,(()=>{var Ue=Te(()=>x().length>0);return()=>Ue()&&(()=>{var it=Sm();return p(it,k),a(it,I(Ct,{get each(){return x()},children:dt=>(()=>{var Fe=pN();return Fe.firstChild,a(Fe,dt,null),Fe})()})),it})()})(),ut),p(ut,N),a(ut,I(_t,{variant:"secondary",type:"button",onClick:b,get children(){return e("common.cancel")}}),null),a(ut,I(_t,{variant:"primary",type:"submit",get children(){return e("inventory.createMovement")}}),null),fe(Ue=>{var it=re,dt=L,Fe=re,Be=L,Re=e("common.referenceNumberPlaceholder"),lt=z,ot=re,nt=O,Ve=s()==="transfer"?"1fr 1fr":"1fr",qt=re,Mt=z,Qt=z,lr=re,bt={...L,"min-height":"80px",resize:"vertical"},yr=e("inventory.generalNotesPlaceholder");return Ue.e=p(G,it,Ue.e),Ue.t=p(ie,dt,Ue.t),Ue.a=p(oe,Fe,Ue.a),Ue.o=p(de,Be,Ue.o),Re!==Ue.i&&ir(de,"placeholder",Ue.i=Re),Ue.n=p(he,lt,Ue.n),Ue.s=p(le,ot,Ue.s),Ue.h=p(ve,nt,Ue.h),Ve!==Ue.r&&((Ue.r=Ve)!=null?xe.style.setProperty("grid-template-columns",Ve):xe.style.removeProperty("grid-template-columns")),Ue.d=p(Ee,qt,Ue.d),Ue.l=p(Me,Mt,Ue.l),Ue.u=p(je,Qt,Ue.u),Ue.c=p(Xe,lr,Ue.c),Ue.w=p(ht,bt,Ue.w),yr!==Ue.m&&ir(ht,"placeholder",Ue.m=yr),Ue},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),fe(()=>ie.value=r()),fe(()=>de.value=i()),fe(()=>ve.value=s()),fe(()=>ht.value=g()),H})(),I(og,{get isOpen(){return Y()},onClose:()=>K(!1),onProductAdded:H=>{K(!1)}}),I(sg,{get isOpen(){return j()},onClose:()=>q(!1),onLocationAdded:H=>{s()==="transfer"&&!u()?y(H):d(H),q(!1)}})]}})};var fN=ae("<div><h1></h1><div>"),Yi=ae("<div>"),yN=ae("<div><h3></h3><div>"),gN=ae("<div>: <!> "),vN=ae("<div><button></button><button></button><button></button><button>"),bN=ae("<div><div>"),_N=ae("<div><span> (<!>)</span><span> / <!> "),PN=ae("<div><div><h2></h2></div><div>"),SN=ae("<div><div><div><span></span><h3></h3></div><div>  </div><div></div></div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div>:"),wN=ae("<div><div><div><div></div><div></div></div><div><div> </div><div></div><div>Min: "),xN=ae("<span> LOW");const CN=()=>{const{t}=_r(),[e,r]=we(!1),[n,i]=we(!1),[o,s]=we(!1),[l,c]=we(null),[d,u]=we("overview"),[y,g]=we("new"),[f,w]=we([]),[E,x]=we(!1),[T,Y]=we(!1),[K,j]=we(!1),[q,J]=we(!1),[C,P]=we(1),$=H=>{c(H),s(!0)},D=Ut(()=>{const H=Pt.products||[],B=Pt.movements||[],M=Pt.stockLevels||[],G=Pt.getLowStockProducts(),Q=H?.length||0,ie=H?.filter(ee=>ee.isActive).length,me=M.reduce((ee,de)=>ee*1+de.quantity*1*de.averageCost*1,0),oe=B?.filter(ee=>{const de=new Date(ee.createdDate),he=new Date;return de.getMonth()===he.getMonth()&&de.getFullYear()===he.getFullYear()}).length;return{totalProducts:Q,activeProducts:ie,lowStockProducts:G.length,totalStockValue:me,totalMovementsThisMonth:oe,totalLocations:Pt.locations.length,activeLocations:Pt.getActiveLocations().length}});Ut(()=>Pt.products.map(H=>{const B=Pt.getStockByProduct(H.id),M=Pt.getTotalStockByProduct(H.id),G=Pt.getLastLocationByProduct(H.id);return{...H,totalStock:M,stockByLocation:B,lastLocation:G,isLowStock:M<=H.minStockLevel}})),Ut(()=>{E(),P(1)});const b=(H,B)=>H<=B?t("inventory.lowStockAlert"):H<=B*2?t("inventory.normalStock"):t("inventory.inStock"),S=H=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(H),v=H=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(H),z=H=>{switch(H){case"warehouse":return t("inventory.warehouse");case"store":return t("inventory.store");case"supplier":return t("inventory.supplier");case"customer":return t("inventory.customer");default:return H}},re={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},L={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},O=H=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500",background:H>50?"#d4edda":H>20?"#fff3cd":"#f8d7da",color:H>50?"#155724":H>20?"#856404":"#721c24"}),ne={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},X={color:"var(--text-muted)","font-size":"0.875rem"},W={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},se={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},F={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},k=H=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:H?"var(--primary-color)":"var(--text-muted)","border-bottom":H?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),N={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem","margin-bottom":"2rem"},A={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},V=Ut(()=>{const H=Pt.movements;return{total:H.length,stockIn:H.filter(B=>B.movementType==="in").length,stockOut:H.filter(B=>B.movementType==="out").length,transfers:H.filter(B=>B.movementType==="transfer").length,adjustments:H.filter(B=>B.movementType==="adjustment").length,totalValue:H.reduce((B,M)=>B+M.totalCost,0)}}),Z=async()=>{let H=vr.state?.profile?.businessId;setTimeout(async()=>{await Pt.getStockLevels("YY_")},2300),ig.calcStockLevels(),await Pt.fecthProduct(H),await Pt.fecthInventory(H)};return jn(()=>{Z()}),I(Po,{get title(){return t("inventory.title")},get children(){return[(()=>{var H=fN(),B=H.firstChild,M=B.nextSibling;return p(H,se),B.style.setProperty("margin","0"),B.style.setProperty("font-size","1.75rem"),M.style.setProperty("display","flex"),M.style.setProperty("align-items","center"),M.style.setProperty("gap","1rem"),a(M,(()=>{var G=Te(()=>y()==="new");return()=>G()&&I(_t,{variant:"outline",onClick:()=>j(!0),get children(){return[" ",Te(()=>t("inventory.physicalCount","Physical Count"))]}})})(),null),a(M,I(Oe,{get when(){return vr.hasPermission("read_write")},get children(){return[I(_t,{variant:"outline",onClick:()=>J(!0),get children(){return[" ",Te(()=>t("inventory.viewHistoricalReports"))]}}),Te(()=>n()?"O":"X"),I(_t,{variant:"primary",onClick:()=>i(!0),get children(){return Te(()=>y()==="new")()?t("inventory.addMovement"):t("common.add")}})]}}),null),H})(),I(H6,{}),I(Oe,{get when(){return vr.hasPermission("inventoryDownsection")},get children(){return Te(()=>y()==="legacy")()?[(()=>{var H=Yi();return a(H,I(Gt,{get title(){return t("inventory.totalItems")},get subtitle(){return t("inventory.inStock")},get children(){var B=Yi();return B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","var(--primary-color)"),a(B,()=>Pt.inventory.length),B}}),null),a(H,I(Gt,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.itemsBelowThreshold")},get children(){var B=Yi();return B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","var(--primary-color)"),a(B,()=>Pt.getLowStockItems().length),B}}),null),a(H,I(Gt,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.inventoryWorth")},get children(){var B=Yi();return B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","var(--primary-color)"),a(B,()=>S(Pt.getTotalValue())),B}}),null),fe(B=>p(H,W,B)),H})(),(()=>{var H=Yi();return p(H,re),a(H,I(Ct,{get each(){return Pt.inventory},children:B=>{const M=b(B.quantity,B.minStock),G=B.quantity<=B.minStock?8:B.quantity<=B.minStock*2?35:75;return I(Gt,{onClick:()=>$(B),get children(){return[(()=>{var Q=yN(),ie=Q.firstChild,me=ie.nextSibling;return p(Q,L),ie.style.setProperty("margin","0"),ie.style.setProperty("font-size","1.1rem"),a(ie,()=>B.name),a(me,M),fe(oe=>p(me,O(G),oe)),Q})(),(()=>{var Q=Yi();return p(Q,ne),a(Q,()=>S(B.price)),Q})(),(()=>{var Q=gN(),ie=Q.firstChild,me=ie.nextSibling;return me.nextSibling,p(Q,X),a(Q,()=>t("inventory.quantity"),ie),a(Q,()=>B.quantity,me),a(Q,()=>t("common.units"),null),Q})()]}})}})),H})()]:[(()=>{var H=vN(),B=H.firstChild,M=B.nextSibling,G=M.nextSibling,Q=G.nextSibling;return p(H,F),B.$$click=()=>u("overview"),a(B,()=>t("inventory.overview")),M.$$click=()=>u("products"),a(M,()=>t("inventory.products")),G.$$click=()=>u("movements"),a(G,()=>t("inventory.movements")),Q.$$click=()=>u("locations"),a(Q,()=>t("inventory.locations")),fe(ie=>{var me=k(d()==="overview"),oe=k(d()==="products"),ee=k(d()==="movements"),de=k(d()==="locations");return ie.e=p(B,me,ie.e),ie.t=p(M,oe,ie.t),ie.a=p(G,ee,ie.a),ie.o=p(Q,de,ie.o),ie},{e:void 0,t:void 0,a:void 0,o:void 0}),H})(),Te(()=>Te(()=>d()==="overview")()&&(()=>{var H=bN(),B=H.firstChild;return a(B,I(Gt,{get title(){return t("inventory.activeProducts")},get subtitle(){return t("inventory.currentlyManaged")},get children(){var M=Yi();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","var(--primary-color)"),a(M,()=>D().activeProducts),M}}),null),a(B,I(Gt,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.needAttention")},get children(){var M=Yi();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","#d32f2f"),a(M,()=>D().lowStockProducts),M}}),null),a(B,I(Gt,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.currentWorth")},get children(){var M=Yi();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","var(--primary-color)"),a(M,()=>v(V().totalValue)),M}}),null),a(B,I(Gt,{get title(){return t("inventory.movements")},get subtitle(){return t("inventory.thisMonth")},get children(){var M=Yi();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","var(--primary-color)"),a(M,()=>D().totalMovementsThisMonth),M}}),null),a(B,I(Gt,{get title(){return t("inventory.activeLocations")},get subtitle(){return t("inventory.warehousesStores")},get children(){var M=Yi();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","var(--primary-color)"),a(M,()=>D().activeLocations),M}}),null),a(H,(()=>{var M=Te(()=>D().lowStockProducts>0);return()=>M()&&I(Gt,{get title(){return` ${t("inventory.lowStockAlert")}`},get subtitle(){return`${D().lowStockProducts} ${t("inventory.productsNeedRestocking")}`},style:{"margin-bottom":"2rem","border-color":"#ffcdd2",background:"#ffebee"},get children(){var G=Yi();return G.style.setProperty("margin-top","1rem"),a(G,I(Ct,{get each(){return Pt.getLowStockProducts().slice(0,9)},children:Q=>(()=>{var ie=_N(),me=ie.firstChild,oe=me.firstChild,ee=oe.nextSibling;ee.nextSibling;var de=me.nextSibling,he=de.firstChild,le=he.nextSibling;return le.nextSibling,ie.style.setProperty("display","flex"),ie.style.setProperty("justify-content","space-between"),ie.style.setProperty("margin-bottom","0.5rem"),ie.style.setProperty("font-size","0.875rem"),a(me,()=>Q.name,oe),a(me,()=>Q?.sku,ee),de.style.setProperty("color","#d32f2f"),de.style.setProperty("font-weight","600"),a(de,()=>Q.currentStock,he),a(de,()=>Q.minStockLevel,le),a(de,()=>t("inventory.min"),null),ie})()}),null),a(G,(()=>{var Q=Te(()=>Pt.getLowStockProducts().length>5);return()=>Q()&&(()=>{var ie=Yi();return ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-muted)"),ie.style.setProperty("font-style","italic"),a(ie,()=>t("common.andMore",{count:Pt.getLowStockProducts().length-9})),ie})()})(),null),G}})})(),null),fe(M=>p(B,W,M)),H})()),Te(()=>Te(()=>d()==="products")()&&I(h_,{})),Te(()=>Te(()=>d()==="movements")()&&I(Wk,{})),Te(()=>Te(()=>d()==="locations")()&&(()=>{var H=PN(),B=H.firstChild,M=B.firstChild,G=B.nextSibling;return B.style.setProperty("display","flex"),B.style.setProperty("justify-content","space-between"),B.style.setProperty("align-items","center"),B.style.setProperty("margin-bottom","1.5rem"),M.style.setProperty("margin","0"),M.style.setProperty("font-size","1.5rem"),a(M,()=>t("inventory.locations")),a(B,I(Oe,{get when(){return vr.hasPermission("read_write")},get children(){return I(_t,{variant:"primary",onClick:()=>Y(!0),get children(){return[" ",Te(()=>t("inventory.addLocation"))]}})}}),null),p(G,N),a(G,I(Ct,{get each(){return Pt.getActiveLocations()},children:Q=>{const ie=Pt.getStockByLocation(Q.id),me=ie?.length,oe=ie?.reduce((de,he)=>de*1+he.quantity*1,0),ee=ie?.reduce((de,he)=>(Pt?.getProductById(he.productId),de+(he?.averageCost||0)),0);return(()=>{var de=SN(),he=de.firstChild,le=he.firstChild,ye=le.firstChild,ve=ye.nextSibling,pe=le.nextSibling,ge=pe.firstChild,ke=pe.nextSibling,Ne=he.nextSibling,xe=Ne.firstChild,$e=xe.firstChild,Ee=$e.firstChild,Me=$e.nextSibling,Ye=xe.nextSibling,ze=Ye.firstChild,je=ze.firstChild,Xe=ze.nextSibling,ht=Ye.nextSibling,ut=ht.firstChild,Ue=ut.firstChild,it=ut.nextSibling,dt=Ne.nextSibling,Fe=dt.firstChild,Be=Fe.firstChild;return he.style.setProperty("margin-bottom","1rem"),he.style.setProperty("padding-bottom","1rem"),he.style.setProperty("border-bottom","1px solid var(--border-color)"),le.style.setProperty("display","flex"),le.style.setProperty("align-items","center"),le.style.setProperty("gap","0.5rem"),le.style.setProperty("margin-bottom","0.5rem"),ye.style.setProperty("font-size","1.2rem"),a(ye,()=>Q.type==="warehouse"?"":Q.type==="store"?"":Q.type==="supplier"?"":""),ve.style.setProperty("margin","0"),ve.style.setProperty("font-size","1.1rem"),a(ve,()=>Q.name),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),a(pe,()=>Q.code,ge),a(pe,()=>z(Q.type),null),ke.style.setProperty("font-size","0.75rem"),ke.style.setProperty("color","var(--text-muted)"),ke.style.setProperty("margin-top","0.25rem"),a(ke,()=>Q.address),Ne.style.setProperty("margin-bottom","1rem"),xe.style.setProperty("display","flex"),xe.style.setProperty("justify-content","space-between"),xe.style.setProperty("margin-bottom","0.5rem"),$e.style.setProperty("font-size","0.875rem"),$e.style.setProperty("font-weight","500"),a($e,()=>t("inventory.products"),Ee),Me.style.setProperty("font-weight","600"),a(Me,me),Ye.style.setProperty("display","flex"),Ye.style.setProperty("justify-content","space-between"),Ye.style.setProperty("margin-bottom","0.5rem"),ze.style.setProperty("font-size","0.875rem"),ze.style.setProperty("font-weight","500"),a(ze,()=>t("inventory.totalItems"),je),Xe.style.setProperty("font-weight","600"),Xe.style.setProperty("color","var(--primary-color)"),a(Xe,oe),ht.style.setProperty("display","flex"),ht.style.setProperty("justify-content","space-between"),ht.style.setProperty("margin-bottom","1rem"),ut.style.setProperty("font-size","0.875rem"),ut.style.setProperty("font-weight","500"),a(ut,()=>t("inventory.totalValue"),Ue),it.style.setProperty("font-weight","600"),it.style.setProperty("color","var(--primary-color)"),a(it,()=>v(ee)),Fe.style.setProperty("font-weight","600"),Fe.style.setProperty("margin-bottom","0.75rem"),Fe.style.setProperty("font-size","0.875rem"),Fe.style.setProperty("color","var(--text-primary)"),Fe.style.setProperty("border-bottom","1px solid var(--border-color)"),Fe.style.setProperty("padding-bottom","0.5rem"),a(Fe,()=>t("inventory.productDetails"),Be),a(dt,(()=>{var Re=Te(()=>ie?.length===0);return()=>Re()?(()=>{var lt=Yi();return lt.style.setProperty("text-align","center"),lt.style.setProperty("color","var(--text-muted)"),lt.style.setProperty("font-style","italic"),lt.style.setProperty("padding","1rem"),a(lt,()=>t("inventory.noProducts")),lt})():(()=>{var lt=Yi();return lt.style.setProperty("max-height","200px"),lt.style.setProperty("overflow-y","auto"),lt.style.setProperty("border","1px solid var(--border-color)"),lt.style.setProperty("border-radius","var(--border-radius-sm)"),a(lt,I(Ct,{each:ie,children:ot=>{const nt=Pt.getProductById(ot.productId);if(!nt)return null;const Ve=ot.quantity<=nt.minStockLevel,qt=ot.averageCost;return ot.quantity?(()=>{var Mt=wN(),Qt=Mt.firstChild,lr=Qt.firstChild,bt=lr.firstChild,yr=bt.nextSibling,Cr=lr.nextSibling,Kt=Cr.firstChild,sr=Kt.firstChild,pt=Kt.nextSibling,gt=pt.nextSibling;return gt.firstChild,Mt.style.setProperty("padding","0.75rem"),Mt.style.setProperty("border-bottom","1px solid var(--border-color)"),(Ve?"#fff5f5":"transparent")!=null?Mt.style.setProperty("background",Ve?"#fff5f5":"transparent"):Mt.style.removeProperty("background"),Mt.style.setProperty("transition","background-color 0.2s ease"),Qt.style.setProperty("display","flex"),Qt.style.setProperty("justify-content","space-between"),Qt.style.setProperty("align-items","flex-start"),Qt.style.setProperty("margin-bottom","0.25rem"),lr.style.setProperty("flex","1"),bt.style.setProperty("font-weight","500"),bt.style.setProperty("font-size","0.875rem"),(Ve?"#d32f2f":"var(--text-primary)")!=null?bt.style.setProperty("color",Ve?"#d32f2f":"var(--text-primary)"):bt.style.removeProperty("color"),a(bt,()=>nt.name,null),a(bt,Ve&&(()=>{var Vt=xN();return Vt.style.setProperty("margin-left","0.5rem"),Vt.style.setProperty("font-size","0.7rem"),Vt.style.setProperty("color","#d32f2f"),Vt})(),null),yr.style.setProperty("font-size","0.75rem"),yr.style.setProperty("color","var(--text-muted)"),yr.style.setProperty("margin-top","0.1rem"),a(yr,()=>nt.sku,null),a(yr,()=>nt.UPC?"  "+nt.UPC:"",null),a(yr,()=>nt.category?"  "+nt.category:"",null),Cr.style.setProperty("text-align","right"),Kt.style.setProperty("font-weight","600"),Kt.style.setProperty("font-size","0.875rem"),(Ve?"#d32f2f":"var(--primary-color)")!=null?Kt.style.setProperty("color",Ve?"#d32f2f":"var(--primary-color)"):Kt.style.removeProperty("color"),a(Kt,()=>ot.quantity,sr),a(Kt,()=>nt.unitOfMeasure,null),pt.style.setProperty("font-size","0.75rem"),pt.style.setProperty("color","var(--text-muted)"),a(pt,()=>v(qt)),gt.style.setProperty("font-size","0.7rem"),gt.style.setProperty("color","var(--text-muted)"),gt.style.setProperty("margin-top","0.1rem"),a(gt,()=>nt.minStockLevel,null),Mt})():null}})),lt})()})(),null),fe(Re=>p(de,{...A,"min-height":"400px"},Re)),de})()}})),H})())]}}),I(Oe,{get when(){return vr.hasPermission("read_write")},get children(){return[I(bk,{get isOpen(){return o()},onClose:()=>s(!1),get item(){return l()}}),I(sg,{get isOpen(){return T()},onClose:()=>Y(!1),onLocationAdded:()=>{Y(!1)}})]}}),I(mN,{get isOpen(){return n()},onClose:()=>i(!1)}),I(mk,{get isOpen(){return e()},onClose:()=>r(!1),get mode(){return y()==="new"?"movement":"legacy"}}),I(o6,{get isOpen(){return K()},onClose:()=>j(!1)}),I(aN,{get isOpen(){return q()},onClose:()=>J(!1)})]}})};br(["click"]);br(["click"]);const AN=[{id:"1",name:"John Doe",position:"Software Engineer",salary:85e3,email:"john.doe@company.com",phone:"+1 (555) 123-4567",department:"Engineering",startDate:"2023-01-15"},{id:"2",name:"Jane Smith",position:"Product Manager",salary:95e3,email:"jane.smith@company.com",phone:"+1 (555) 234-5678",department:"Product",startDate:"2022-08-20"},{id:"3",name:"Mike Brown",position:"Designer",salary:7e4,email:"mike.brown@company.com",phone:"+1 (555) 345-6789",department:"Design",startDate:"2023-03-10"},{id:"4",name:"Sarah Kim",position:"HR Manager",salary:78e3,email:"sarah.kim@company.com",phone:"+1 (555) 456-7890",department:"Human Resources",startDate:"2022-11-05"},{id:"5",name:"Alex Lee",position:"Data Analyst",salary:72e3,email:"alex.lee@company.com",phone:"+1 (555) 567-8901",department:"Analytics",startDate:"2023-02-28"},{id:"6",name:"Emma Wilson",position:"Marketing Manager",salary:82e3,email:"emma.wilson@company.com",phone:"+1 (555) 678-9012",department:"Marketing",startDate:"2022-09-15"}],[ld,wm]=we(AN),p_={get employees(){return ld()},addEmployee(t){const e={...t,id:Date.now().toString()};return wm([...ld(),e]),e},updateEmployee(t,e){wm(ld().map(r=>r.id===t?{...r,...e}:r))},deleteEmployee(t){wm(ld().filter(e=>e.id!==t))},getEmployeeById(t){return ld().find(e=>e.id===t)}};var $N=ae("<form><div>");const EN=t=>{const{t:e}=_r(),[r,n]=we({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),i=[{value:"Engineering",label:e("employees.departments.engineering","Engineering")},{value:"Product",label:e("employees.departments.product","Product")},{value:"Design",label:e("employees.departments.design","Design")},{value:"Marketing",label:e("employees.departments.marketing","Marketing")},{value:"Sales",label:e("employees.departments.sales","Sales")},{value:"Human Resources",label:e("employees.departments.humanResources","Human Resources")},{value:"Finance",label:e("employees.departments.finance","Finance")},{value:"Operations",label:e("employees.departments.operations","Operations")},{value:"Analytics",label:e("employees.departments.analytics","Analytics")}],o={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},s=c=>{c.preventDefault();const d=r();if(!d.name||!d.position||!d.salary||!d.email||!d.department||!d.startDate){alert(e("forms.requiredField"));return}const u={name:d.name,position:d.position,salary:parseFloat(d.salary),email:d.email,phone:d.phone,department:d.department,startDate:d.startDate};p_.addEmployee(u),n({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),t.onClose()},l=(c,d)=>{n(u=>({...u,[c]:d}))};return I(si,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.addEmployee")},get children(){var c=$N(),d=c.firstChild;return c.addEventListener("submit",s),a(c,I(Mr,{get label(){return e("employees.fullName")},get value(){return r().name},onChange:u=>l("name",u),get placeholder(){return e("employees.enterFullName","Enter employee's full name")},required:!0}),d),a(c,I(Mr,{get label(){return e("employees.position")},get value(){return r().position},onChange:u=>l("position",u),get placeholder(){return e("employees.enterPosition","Enter job position")},required:!0}),d),a(c,I(Hn,{get label(){return e("employees.department")},get value(){return r().department},onChange:u=>l("department",u),options:i,required:!0}),d),a(c,I(Mr,{get label(){return e("employees.email")},type:"email",get value(){return r().email},onChange:u=>l("email",u),get placeholder(){return e("employees.enterEmail","Enter email address")},required:!0}),d),a(c,I(Mr,{get label(){return e("employees.phone")},type:"tel",get value(){return r().phone},onChange:u=>l("phone",u),get placeholder(){return e("employees.enterPhone","Enter phone number")}}),d),a(c,I(Mr,{get label(){return e("employees.salary")},type:"number",get value(){return r().salary},onChange:u=>l("salary",u),get placeholder(){return e("employees.enterSalary","Enter annual salary")},required:!0}),d),a(c,I(Mr,{get label(){return e("employees.hireDate")},type:"date",get value(){return r().startDate},onChange:u=>l("startDate",u),required:!0}),d),p(d,o),a(d,I(_t,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(d,I(_t,{variant:"primary",type:"submit",get children(){return e("employees.addEmployee")}}),null),c}})};var IN=ae("<div><div></div><div></div><div>"),TN=ae("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),kN=ae("<div>");const NN=t=>{const{t:e}=_r(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={width:"80px",height:"80px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.5rem",margin:"0 auto 1.5rem auto"},s={"text-align":"center","margin-bottom":"2rem"},l={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},c={color:"var(--text-muted)","font-size":"1rem"},d={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"};if(!t.employee)return null;const u=f=>f.split(" ").map(w=>w[0]).join("").toUpperCase(),y=f=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(f),g=f=>new Date(f).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return I(si,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.employeeDetails")},get children(){return[(()=>{var f=IN(),w=f.firstChild,E=w.nextSibling,x=E.nextSibling;return p(f,s),p(w,o),a(w,()=>u(t.employee.name)),p(E,l),a(E,()=>t.employee.name),p(x,c),a(x,()=>t.employee.position),f})(),(()=>{var f=TN(),w=f.firstChild,E=w.firstChild,x=E.nextSibling,T=w.nextSibling,Y=T.firstChild,K=Y.nextSibling,j=T.nextSibling,q=j.firstChild,J=q.nextSibling,C=j.nextSibling,P=C.firstChild,$=P.nextSibling,D=C.nextSibling,b=D.firstChild,S=b.nextSibling,v=D.nextSibling,z=v.firstChild,re=z.nextSibling;return a(E,()=>e("employees.employeeId")),a(x,()=>t.employee.id),a(Y,()=>e("employees.department")),a(K,()=>t.employee.department),a(q,()=>e("employees.email")),a(J,()=>t.employee.email),a(P,()=>e("employees.phone")),a($,()=>t.employee.phone),a(b,()=>e("employees.salary")),a(S,()=>y(t.employee.salary)),a(z,()=>e("employees.hireDate")),a(re,()=>g(t.employee.startDate)),fe(L=>{var O=r,ne=n,X=i,W=r,se=n,F=i,k=r,N=n,A=i,V=r,Z=n,H=i,B=r,M=n,G=i,Q=r,ie=n,me=i;return L.e=p(w,O,L.e),L.t=p(E,ne,L.t),L.a=p(x,X,L.a),L.o=p(T,W,L.o),L.i=p(Y,se,L.i),L.n=p(K,F,L.n),L.s=p(j,k,L.s),L.h=p(q,N,L.h),L.r=p(J,A,L.r),L.d=p(C,V,L.d),L.l=p(P,Z,L.l),L.u=p($,H,L.u),L.c=p(D,B,L.c),L.w=p(b,M,L.w),L.m=p(S,G,L.m),L.f=p(v,Q,L.f),L.y=p(z,ie,L.y),L.g=p(re,me,L.g),L},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),f})(),(()=>{var f=kN();return p(f,d),a(f,I(_t,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),a(f,I(_t,{variant:"primary",onClick:()=>{console.log("Edit employee:",t.employee.id)},get children(){return e("employees.editEmployee")}}),null),f})()]}})};var Z0=ae("<div>"),LN=ae("<div><div></div><div><div></div><div></div><div>/year");const RN=()=>{const{t}=_r(),[e,r]=we(!1),[n,i]=we(!1),[o,s]=we(null),l=E=>{s(E),i(!0)},c={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},d={display:"flex","align-items":"center",gap:"1rem"},u={width:"60px",height:"60px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.2rem"},y={flex:"1"},g={"font-weight":"600","margin-bottom":"0.25rem"},f={color:"var(--text-muted)","font-size":"0.875rem","margin-bottom":"0.5rem"},w={color:"var(--primary-color)","font-weight":"500"};return I(Po,{get title(){return t("employees.title")},get children(){return[(()=>{var E=Z0();return E.style.setProperty("margin-bottom","2rem"),a(E,I(_t,{variant:"primary",onClick:()=>r(!0),get children(){return t("employees.addEmployee")}})),E})(),(()=>{var E=Z0();return p(E,c),a(E,()=>p_.employees.map(x=>{const T=K=>K.split(" ").map(j=>j[0]).join("").toUpperCase(),Y=K=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(K);return I(Gt,{onClick:()=>l(x),get children(){var K=LN(),j=K.firstChild,q=j.nextSibling,J=q.firstChild,C=J.nextSibling,P=C.nextSibling,$=P.firstChild;return p(K,d),p(j,u),a(j,()=>T(x.name)),p(q,y),p(J,g),a(J,()=>x.name),p(C,f),a(C,()=>x.position),p(P,w),a(P,()=>Y(x.salary),$),K}})})),E})(),I(EN,{get isOpen(){return e()},onClose:()=>r(!1)}),I(NN,{get isOpen(){return n()},onClose:()=>i(!1),get employee(){return o()}})]}})},DN=[{id:"1",accountId:"1002",bankName:"First National Bank",accountNumber:"****1234",accountType:"checking",currency:"USD",currentBalance:32730.5,lastReconciledDate:"2024-01-01",lastReconciledBalance:3e4,isActive:!0},{id:"2",accountId:"1003",bankName:"First National Bank",accountNumber:"****5678",accountType:"savings",currency:"USD",currentBalance:12e3,lastReconciledDate:"2024-01-01",lastReconciledBalance:1e4,isActive:!0}],MN=[{id:"1",accountId:"1002",date:"2024-01-15",description:"Customer Payment - ABC Corp",reference:"CHK001234",debitAmount:5e3,creditAmount:0,balance:35730.5,category:"Customer Payment",isReconciled:!0,reconciledWith:"eb1",importedAt:"2024-01-16",source:"csv_import"},{id:"2",accountId:"1002",date:"2024-01-14",description:"Office Supplies - Staples",reference:"CHK001235",debitAmount:0,creditAmount:250,balance:30730.5,category:"Office Expenses",isReconciled:!0,reconciledWith:"eb2",importedAt:"2024-01-16",source:"csv_import"},{id:"3",accountId:"1002",date:"2024-01-13",description:"Monthly Rent Payment",reference:"CHK001236",debitAmount:0,creditAmount:2e3,balance:28730.5,category:"Rent",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"},{id:"4",accountId:"1002",date:"2024-01-12",description:"Wire Transfer In",reference:"WIRE001",debitAmount:1e4,creditAmount:0,balance:38730.5,category:"Wire Transfer",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"}],FN=[{id:"eb1",accountId:"1002",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",debitAmount:5e3,creditAmount:0,category:"Accounts Receivable",isReconciled:!0,reconciledWith:"1",createdAt:"2024-01-15"},{id:"eb2",accountId:"1002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",debitAmount:0,creditAmount:250,category:"Office Expenses",isReconciled:!0,reconciledWith:"2",createdAt:"2024-01-14"},{id:"eb3",accountId:"1002",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",debitAmount:0,creditAmount:3500,category:"Salary Expense",isReconciled:!1,createdAt:"2024-01-11"}],ON=[{id:"1",bankAccountId:"1",periodStart:"2024-01-01",periodEnd:"2024-01-15",startingBalance:3e4,endingBalance:35730.5,status:"in_progress",totalBankTransactions:4,totalEntryBookRecords:3,reconciledTransactions:2,unreconciledTransactions:2,discrepancyAmount:1500,createdAt:"2024-01-16",notes:"Wire transfer and rent payment need investigation"}],[Qu,eb]=we(DN),[$a,xm]=we(MN),[cd,tb]=we(FN),[Xu,rb]=we(ON),ci={get bankAccounts(){return Qu()},addBankAccount(t){const e={...t,id:Date.now().toString()};return eb([...Qu(),e]),e},updateBankAccount(t,e){eb(Qu().map(r=>r.id===t?{...r,...e}:r))},getBankAccountById(t){return Qu().find(e=>e.id===t)},get bankStatements(){return $a()},addBankStatement(t){const e={...t,id:Date.now().toString(),importedAt:new Date().toISOString()};return xm([...$a(),e]),e},addBankStatementsFromCSV(t){const e=t.map(r=>({...r,id:`csv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,importedAt:new Date().toISOString(),source:"csv_import",isReconciled:!1}));return xm([...$a(),...e]),e},updateBankStatement(t,e){xm($a().map(r=>r.id===t?{...r,...e}:r))},getBankStatementsByAccount(t){return $a().filter(e=>e.accountId===t)},getUnreconciledBankStatements(t){return(t?this.getBankStatementsByAccount(t):$a()).filter(r=>!r.isReconciled)},get entryBookRecords(){return cd()},addEntryBookRecord(t){const e={...t,id:Date.now().toString(),createdAt:new Date().toISOString()};return tb([...cd(),e]),e},updateEntryBookRecord(t,e){tb(cd().map(r=>r.id===t?{...r,...e}:r))},getEntryBookRecordsByAccount(t){return cd().filter(e=>e.accountId===t)},getUnreconciledEntryBookRecords(t){return(t?this.getEntryBookRecordsByAccount(t):cd()).filter(r=>!r.isReconciled)},reconcileTransaction(t,e){this.updateBankStatement(t,{isReconciled:!0,reconciledWith:e}),this.updateEntryBookRecord(e,{isReconciled:!0,reconciledWith:t})},unreconciledTransaction(t){const e=$a().find(r=>r.id===t);e?.reconciledWith&&this.updateEntryBookRecord(e.reconciledWith,{isReconciled:!1,reconciledWith:void 0}),this.updateBankStatement(t,{isReconciled:!1,reconciledWith:void 0})},findPotentialMatches(t){const e=$a().find(n=>n.id===t);return e?this.getUnreconciledEntryBookRecords(e.accountId).filter(n=>{const i=Math.abs(e.debitAmount-n.debitAmount)<.01||Math.abs(e.creditAmount-n.creditAmount)<.01,o=new Date(e.date),s=new Date(n.date),c=Math.abs((o.getTime()-s.getTime())/(1e3*60*60*24))<=3,d=e.reference===n.reference||e.description.toLowerCase().includes(n.description.toLowerCase())||n.description.toLowerCase().includes(e.description.toLowerCase());return i&&(c||d)}).sort((n,i)=>{const o=(n.date===e.date?2:0)+(n.reference===e.reference?1:0);return(i.date===e.date?2:0)+(i.reference===e.reference?1:0)-o}):[]},get reconciliationSessions(){return Xu()},startReconciliationSession(t,e,r){const n=this.getBankStatementsByAccount(t).filter(d=>d.date>=e&&d.date<=r),i=this.getEntryBookRecordsByAccount(t).filter(d=>d.date>=e&&d.date<=r),o=n.filter(d=>d.isReconciled).length,s=this.getBankAccountById(t)?.lastReconciledBalance||0,l=this.getBankAccountById(t)?.currentBalance||0,c={id:Date.now().toString(),bankAccountId:t,periodStart:e,periodEnd:r,startingBalance:s,endingBalance:l,status:"in_progress",totalBankTransactions:n.length,totalEntryBookRecords:i.length,reconciledTransactions:o,unreconciledTransactions:n.length-o,discrepancyAmount:0,createdAt:new Date().toISOString()};return rb([...Xu(),c]),c},updateReconciliationSession(t,e){rb(Xu().map(r=>r.id===t?{...r,...e}:r))},getReconciliationSessionsByAccount(t){return Xu().filter(e=>e.bankAccountId===t)}};var Cm=ae("<div>"),BN=ae("<div><strong>:</strong> <!> - "),jN=ae("<div><div><div></div><div></div><div></div></div><input id=csvFileInput type=file accept=.csv>"),VN=ae("<div><h4></h4><div><div><label> *</label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value>"),ac=ae("<option>"),qN=ae("<div><table><thead><tr></tr></thead><tbody>"),zN=ae("<th>"),UN=ae("<tr>"),HN=ae("<td>");const GN=t=>{const{t:e}=_r(),[r,n]=we(!1),[i,o]=we(!1),[s,l]=we(null),[c,d]=we([]),[u,y]=we({date:"",description:"",reference:"",debit:"",credit:"",balance:""}),g={border:`2px dashed ${r()?"var(--primary-color)":"var(--border-color)"}`,"border-radius":"var(--border-radius)",padding:"2rem","text-align":"center","background-color":r()?"var(--background-color)":"transparent",transition:"all 0.2s ease",cursor:"pointer"},f={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem","margin-top":"1.5rem"},w={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-family":"inherit"},E={"max-height":"200px","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},x={width:"100%","border-collapse":"collapse","font-size":"0.875rem"},T={padding:"0.5rem","border-bottom":"1px solid var(--border-color)","text-align":"left"},Y={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},K=S=>{S.preventDefault(),n(!0)},j=S=>{S.preventDefault(),n(!1)},q=S=>{S.preventDefault(),n(!1);const v=S.dataTransfer?.files;v&&v.length>0&&C(v[0])},J=S=>{const v=S.target;v.files&&v.files.length>0&&C(v.files[0])},C=S=>{if(!S.name.toLowerCase().endsWith(".csv")){l({success:!1,message:e("banking.pleaseUploadCSV")});return}o(!0);const v=new FileReader;v.onload=z=>{try{const L=(z.target?.result).split(`
`).filter(W=>W.trim());if(L.length<2){l({success:!1,message:e("banking.csvRequiresHeaderAndData")}),o(!1);return}const O=L[0].split(",").map(W=>W.trim().replace(/[\"\']/g,"")),ne=L.slice(1).map(W=>{const se=W.split(",").map(k=>k.trim().replace(/[\"\']/g,"")),F={};return O.forEach((k,N)=>{F[k]=se[N]||""}),F});d(ne),l({success:!0,message:e("banking.successfullyParsed").replace("{count}",ne.length.toString()),count:ne.length});const X={...u()};O.forEach(W=>{const se=W.toLowerCase();se.includes("date")&&(X.date=W),(se.includes("description")||se.includes("memo"))&&(X.description=W),(se.includes("reference")||se.includes("check")||se.includes("ref"))&&(X.reference=W),(se.includes("debit")||se.includes("deposit"))&&(X.debit=W),(se.includes("credit")||se.includes("withdrawal")||se.includes("amount"))&&(X.debit?X.credit=W:X.debit=W),se.includes("balance")&&(X.balance=W)}),y(X)}catch{l({success:!1,message:e("banking.errorParsingCSV")})}o(!1)},v.readAsText(S)},P=(S,v)=>{y(z=>({...z,[S]:v}))},$=()=>c().length===0?[]:Object.keys(c()[0]),D=()=>{if(!t.bankAccount||c().length===0)return;const S=u();if(!S.date||!S.description){l({success:!1,message:e("banking.dateDescriptionRequired")});return}o(!0);try{const v=c().map(re=>{const L=W=>W&&parseFloat(W.replace(/[^0-9.-]/g,""))||0,O=W=>{const se=new Date(W);if(isNaN(se.getTime())){const F=W.split("/");if(F.length===3)return new Date(parseInt(F[2]),parseInt(F[0])-1,parseInt(F[1])).toISOString().split("T")[0]}return se.toISOString().split("T")[0]};let ne=0,X=0;if(S.debit&&S.credit)ne=L(re[S.debit]),X=L(re[S.credit]);else if(S.debit){const W=L(re[S.debit]);W>0?ne=W:X=Math.abs(W)}return{accountId:t.bankAccount.accountId,date:O(re[S.date]),description:re[S.description]||e("banking.importedTransaction"),reference:re[S.reference]||"",debitAmount:ne,creditAmount:X,balance:S.balance?L(re[S.balance]):0,isReconciled:!1}}),z=ci.addBankStatementsFromCSV(v);l({success:!0,message:e("banking.successfullyImported").replace("{count}",z.length.toString()),count:z.length}),d([]),y({date:"",description:"",reference:"",debit:"",credit:"",balance:""})}catch{l({success:!1,message:e("banking.errorImportingTransactions")})}o(!1)},b=()=>{d([]),l(null),y({date:"",description:"",reference:"",debit:"",credit:"",balance:""})};return I(si,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("banking.importBankStatementCSV")},get children(){return[Te(()=>Te(()=>!!t.bankAccount)()&&(()=>{var S=BN(),v=S.firstChild,z=v.firstChild,re=v.nextSibling,L=re.nextSibling;return L.nextSibling,S.style.setProperty("margin-bottom","1.5rem"),S.style.setProperty("padding","1rem"),S.style.setProperty("background","var(--background-color)"),S.style.setProperty("border-radius","var(--border-radius-sm)"),S.style.setProperty("border","1px solid var(--border-color)"),a(v,()=>e("banking.bankAccount"),z),a(S,()=>t.bankAccount.bankName,L),a(S,()=>t.bankAccount.accountNumber,null),S})()),Te(()=>Te(()=>c().length===0)()?(()=>{var S=jN(),v=S.firstChild,z=v.firstChild,re=z.nextSibling,L=re.nextSibling,O=v.nextSibling;return v.$$click=()=>document.getElementById("csvFileInput")?.click(),v.addEventListener("drop",q),v.addEventListener("dragleave",j),v.addEventListener("dragover",K),z.style.setProperty("font-size","2rem"),z.style.setProperty("margin-bottom","1rem"),re.style.setProperty("font-weight","500"),re.style.setProperty("margin-bottom","0.5rem"),a(re,(()=>{var ne=Te(()=>!!r());return()=>ne()?e("banking.dropCSVHere"):e("banking.clickToUploadCSV")})()),L.style.setProperty("font-size","0.875rem"),L.style.setProperty("color","var(--text-muted)"),a(L,()=>e("banking.supportedFormat")),O.addEventListener("change",J),O.style.setProperty("display","none"),fe(ne=>p(v,g,ne)),S})():(()=>{var S=VN(),v=S.firstChild,z=v.nextSibling,re=z.firstChild,L=re.firstChild,O=L.firstChild,ne=L.nextSibling,X=ne.firstChild,W=re.nextSibling,se=W.firstChild,F=se.firstChild,k=se.nextSibling,N=k.firstChild,A=W.nextSibling,V=A.firstChild,Z=V.nextSibling,H=Z.firstChild,B=A.nextSibling,M=B.firstChild,G=M.firstChild,Q=M.nextSibling,ie=Q.firstChild,me=B.nextSibling,oe=me.firstChild,ee=oe.nextSibling,de=ee.firstChild,he=me.nextSibling,le=he.firstChild,ye=le.nextSibling,ve=ye.firstChild;return v.style.setProperty("margin","0 0 1rem 0"),a(v,()=>e("banking.mapCSVColumns")),p(z,f),L.style.setProperty("display","block"),L.style.setProperty("margin-bottom","0.5rem"),L.style.setProperty("font-weight","500"),a(L,()=>e("banking.dateColumn"),O),ne.addEventListener("change",pe=>P("date",pe.target.value)),a(X,()=>e("banking.selectColumn")),a(ne,()=>$().map(pe=>(()=>{var ge=ac();return ge.value=pe,a(ge,pe),ge})()),null),se.style.setProperty("display","block"),se.style.setProperty("margin-bottom","0.5rem"),se.style.setProperty("font-weight","500"),a(se,()=>e("banking.descriptionColumn"),F),k.addEventListener("change",pe=>P("description",pe.target.value)),a(N,()=>e("banking.selectColumn")),a(k,()=>$().map(pe=>(()=>{var ge=ac();return ge.value=pe,a(ge,pe),ge})()),null),V.style.setProperty("display","block"),V.style.setProperty("margin-bottom","0.5rem"),V.style.setProperty("font-weight","500"),a(V,()=>e("banking.referenceColumn")),Z.addEventListener("change",pe=>P("reference",pe.target.value)),a(H,()=>e("banking.selectColumn")),a(Z,()=>$().map(pe=>(()=>{var ge=ac();return ge.value=pe,a(ge,pe),ge})()),null),M.style.setProperty("display","block"),M.style.setProperty("margin-bottom","0.5rem"),M.style.setProperty("font-weight","500"),a(M,()=>e("banking.amountDebitColumn"),G),Q.addEventListener("change",pe=>P("debit",pe.target.value)),a(ie,()=>e("banking.selectColumn")),a(Q,()=>$().map(pe=>(()=>{var ge=ac();return ge.value=pe,a(ge,pe),ge})()),null),oe.style.setProperty("display","block"),oe.style.setProperty("margin-bottom","0.5rem"),oe.style.setProperty("font-weight","500"),a(oe,()=>e("banking.creditColumn")),ee.addEventListener("change",pe=>P("credit",pe.target.value)),a(de,()=>e("banking.selectColumn")),a(ee,()=>$().map(pe=>(()=>{var ge=ac();return ge.value=pe,a(ge,pe),ge})()),null),le.style.setProperty("display","block"),le.style.setProperty("margin-bottom","0.5rem"),le.style.setProperty("font-weight","500"),a(le,()=>e("banking.balanceColumn")),ye.addEventListener("change",pe=>P("balance",pe.target.value)),a(ve,()=>e("banking.selectColumn")),a(ye,()=>$().map(pe=>(()=>{var ge=ac();return ge.value=pe,a(ge,pe),ge})()),null),a(S,(()=>{var pe=Te(()=>c().length>0);return()=>pe()&&(()=>{var ge=qN(),ke=ge.firstChild,Ne=ke.firstChild,xe=Ne.firstChild,$e=Ne.nextSibling;return p(ge,E),xe.style.setProperty("background-color","var(--background-color)"),a(xe,()=>$().slice(0,6).map(Ee=>(()=>{var Me=zN();return a(Me,Ee),fe(Ye=>p(Me,T,Ye)),Me})())),a($e,()=>c().slice(0,3).map(Ee=>(()=>{var Me=UN();return a(Me,()=>$().slice(0,6).map(Ye=>(()=>{var ze=HN();return a(ze,()=>Ee[Ye]),fe(je=>p(ze,T,je)),ze})())),Me})())),a(ge,(()=>{var Ee=Te(()=>c().length>3);return()=>Ee()&&(()=>{var Me=Cm();return Me.style.setProperty("padding","0.5rem"),Me.style.setProperty("text-align","center"),Me.style.setProperty("color","var(--text-muted)"),a(Me,()=>e("banking.andMoreRows").replace("{count}",(c().length-3).toString())),Me})()})(),null),fe(Ee=>p(ke,x,Ee)),ge})()})(),null),fe(pe=>{var ge=w,ke=w,Ne=w,xe=w,$e=w,Ee=w;return pe.e=p(ne,ge,pe.e),pe.t=p(k,ke,pe.t),pe.a=p(Z,Ne,pe.a),pe.o=p(Q,xe,pe.o),pe.i=p(ee,$e,pe.i),pe.n=p(ye,Ee,pe.n),pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),fe(()=>ne.value=u().date),fe(()=>k.value=u().description),fe(()=>Z.value=u().reference),fe(()=>Q.value=u().debit),fe(()=>ee.value=u().credit),fe(()=>ye.value=u().balance),S})()),Te(()=>Te(()=>!!s())()&&(()=>{var S=Cm();return S.style.setProperty("padding","1rem"),S.style.setProperty("border-radius","var(--border-radius-sm)"),S.style.setProperty("margin-top","1rem"),a(S,()=>s().message),fe(v=>{var z=s().success?"#d4edda":"#f8d7da",re=s().success?"#155724":"#721c24",L=`1px solid ${s().success?"#c3e6cb":"#f5c6cb"}`;return z!==v.e&&((v.e=z)!=null?S.style.setProperty("background",z):S.style.removeProperty("background")),re!==v.t&&((v.t=re)!=null?S.style.setProperty("color",re):S.style.removeProperty("color")),L!==v.a&&((v.a=L)!=null?S.style.setProperty("border",L):S.style.removeProperty("border")),v},{e:void 0,t:void 0,a:void 0}),S})()),(()=>{var S=Cm();return p(S,Y),a(S,I(_t,{variant:"secondary",onClick:()=>{b(),t.onClose()},get children(){return e("common.cancel")}}),null),a(S,(()=>{var v=Te(()=>c().length>0);return()=>v()&&I(_t,{variant:"outline",onClick:b,get children(){return e("common.reset")}})})(),null),a(S,(()=>{var v=Te(()=>c().length>0);return()=>v()&&I(_t,{variant:"primary",onClick:D,get disabled(){return i()||!u().date||!u().description},get children(){return Te(()=>!!i())()?e("banking.importing"):e("banking.importTransactions").replace("{count}",c().length.toString())}})})(),null),S})()]}})};br(["click"]);var nb=ae("<span>"),Zu=ae("<div>"),ib=ae("<div> "),WN=ae("<div><div><h3></h3><div><button></button><button></button><button></button></div></div><div></div><div><div><h4></h4><div></div></div><div><h4></h4><div>"),YN=ae("<div><div><div></div><div>  </div></div><div><div>"),Am=ae("<span> "),KN=ae("<span>(<!>)"),JN=ae("<div><strong>:</strong> "),ob=ae("<div><div><div></div><div>  </div></div><div>"),QN=ae("<div><div>:</div><div></div><div>");const XN=t=>{const{t:e}=_r(),[r,n]=we([]),[i,o]=we([]),[s,l]=we(null),[c,d]=we([]),[u,y]=we("unreconciled");xi(()=>{const L=ci.getBankAccountById(t.bankAccountId);if(L){const O=ci.getBankStatementsByAccount(L.accountId).filter(X=>X.date>=t.selectedPeriod.start&&X.date<=t.selectedPeriod.end),ne=ci.getEntryBookRecordsByAccount(L.accountId).filter(X=>X.date>=t.selectedPeriod.start&&X.date<=t.selectedPeriod.end);n(O),o(ne)}});const g=()=>{const L=r();switch(u()){case"reconciled":return L.filter(O=>O.isReconciled);case"unreconciled":return L.filter(O=>!O.isReconciled);default:return L}},f=()=>{const L=i();switch(u()){case"reconciled":return L.filter(O=>O.isReconciled);case"unreconciled":return L.filter(O=>!O.isReconciled);default:return L}},w=L=>{if(l(L),L.isReconciled)d([]);else{const O=ci.findPotentialMatches(L.id);d(O)}},E=L=>{const O=s();if(O){ci.reconcileTransaction(O.id,L.id);const ne=ci.getBankAccountById(t.bankAccountId);if(ne){const X=ci.getBankStatementsByAccount(ne.accountId).filter(se=>se.date>=t.selectedPeriod.start&&se.date<=t.selectedPeriod.end),W=ci.getEntryBookRecordsByAccount(ne.accountId).filter(se=>se.date>=t.selectedPeriod.start&&se.date<=t.selectedPeriod.end);n(X),o(W)}l(null),d([])}},x=L=>{ci.unreconciledTransaction(L.id);const O=ci.getBankAccountById(t.bankAccountId);if(O){const ne=ci.getBankStatementsByAccount(O.accountId).filter(W=>W.date>=t.selectedPeriod.start&&W.date<=t.selectedPeriod.end),X=ci.getEntryBookRecordsByAccount(O.accountId).filter(W=>W.date>=t.selectedPeriod.start&&W.date<=t.selectedPeriod.end);n(ne),o(X)}},T={display:"grid","grid-template-columns":"1fr 1fr",gap:"2rem","margin-top":"2rem"},Y={height:"600px","overflow-y":"auto"},K={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},j=L=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:L?"var(--primary-color)":"var(--surface-color)",color:L?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),q=(L,O)=>({display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem","margin-bottom":"0.5rem",background:L?"var(--primary-color)":O?"#e8f5e8":"var(--surface-color)",color:L?"white":"var(--text-primary)","border-radius":"var(--border-radius-sm)",border:`1px solid ${L?"var(--primary-color)":O?"#c3e6cb":"var(--border-color)"}`,cursor:"pointer",transition:"all 0.2s ease"}),J={flex:"1"},C={"font-weight":"500","margin-bottom":"0.25rem"},P={"font-size":"0.875rem",opacity:"0.8"},$=L=>({"font-weight":"600",color:L?"#4caf50":"#f44336"}),D={padding:"0.25rem 0.5rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","margin-left":"0.5rem"},b=L=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(L),S=L=>new Date(L).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),v=L=>{if(!s())return null;const O=s();return(Math.abs(O.debitAmount-L.debitAmount)<.01||Math.abs(O.creditAmount-L.creditAmount)<.01)&&O.date===L.date?(()=>{var W=nb();return a(W,()=>e("banking.exactMatch")),fe(se=>p(W,{...D,background:"#d4edda",color:"#155724"},se)),W})():c().includes(L)?(()=>{var W=nb();return a(W,()=>e("banking.possibleMatch")),fe(se=>p(W,{...D,background:"#fff3cd",color:"#856404"},se)),W})():null},re=(()=>{const L=r(),O=i(),ne=L.filter(W=>W.isReconciled).length,X=O.filter(W=>W.isReconciled).length;return{totalStatements:L.length,totalRecords:O.length,reconciledStatements:ne,reconciledRecords:X,unreconciledStatements:L.length-ne,unreconciledRecords:O.length-X}})();return(()=>{var L=WN(),O=L.firstChild,ne=O.firstChild,X=ne.nextSibling,W=X.firstChild,se=W.nextSibling,F=se.nextSibling,k=O.nextSibling,N=k.nextSibling,A=N.firstChild,V=A.firstChild,Z=V.nextSibling,H=A.nextSibling,B=H.firstChild,M=B.nextSibling;return p(O,K),ne.style.setProperty("margin","0"),ne.style.setProperty("font-size","1.25rem"),a(ne,()=>e("banking.reconciliationComparison")),X.style.setProperty("display","flex"),X.style.setProperty("gap","0.5rem"),W.$$click=()=>y("all"),a(W,()=>e("common.all")),se.$$click=()=>y("unreconciled"),a(se,()=>e("banking.unreconciled")),F.$$click=()=>y("reconciled"),a(F,()=>e("banking.reconciled")),k.style.setProperty("display","grid"),k.style.setProperty("grid-template-columns","repeat(4, 1fr)"),k.style.setProperty("gap","1rem"),k.style.setProperty("margin-bottom","2rem"),a(k,I(Gt,{get title(){return e("banking.bankStatements")},get subtitle(){return e("banking.totalTransactions")},get children(){return[(()=>{var G=Zu();return G.style.setProperty("font-size","1.5rem"),G.style.setProperty("font-weight","600"),G.style.setProperty("color","var(--primary-color)"),a(G,()=>re.totalStatements),G})(),(()=>{var G=ib(),Q=G.firstChild;return G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-muted)"),a(G,()=>re.reconciledStatements,Q),a(G,()=>e("banking.reconciled"),null),G})()]}}),null),a(k,I(Gt,{get title(){return e("banking.entryBookRecords")},get subtitle(){return e("banking.totalEntries")},get children(){return[(()=>{var G=Zu();return G.style.setProperty("font-size","1.5rem"),G.style.setProperty("font-weight","600"),G.style.setProperty("color","var(--primary-color)"),a(G,()=>re.totalRecords),G})(),(()=>{var G=ib(),Q=G.firstChild;return G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-muted)"),a(G,()=>re.reconciledRecords,Q),a(G,()=>e("banking.reconciled"),null),G})()]}}),null),a(k,I(Gt,{get title(){return e("banking.unreconciledBank")},get subtitle(){return e("banking.needAttention")},get children(){var G=Zu();return G.style.setProperty("font-size","1.5rem"),G.style.setProperty("font-weight","600"),G.style.setProperty("color","#f44336"),a(G,()=>re.unreconciledStatements),G}}),null),a(k,I(Gt,{get title(){return e("banking.unreconciledBooks")},get subtitle(){return e("banking.needAttention")},get children(){var G=Zu();return G.style.setProperty("font-size","1.5rem"),G.style.setProperty("font-weight","600"),G.style.setProperty("color","#f44336"),a(G,()=>re.unreconciledRecords),G}}),null),p(N,T),V.style.setProperty("margin","0 0 1rem 0"),a(V,()=>e("banking.bankStatements")),a(Z,()=>g().map(G=>(()=>{var Q=YN(),ie=Q.firstChild,me=ie.firstChild,oe=me.nextSibling,ee=oe.firstChild,de=ie.nextSibling,he=de.firstChild;return Q.$$click=()=>w(G),a(me,()=>G.description),a(oe,()=>S(G.date),ee),a(oe,()=>G.reference,null),a(oe,(()=>{var le=Te(()=>!!G.isReconciled);return()=>le()&&(()=>{var ye=Am();return ye.firstChild,ye.style.setProperty("color","#4caf50"),ye.style.setProperty("margin-left","0.5rem"),a(ye,()=>e("banking.reconciled"),null),ye})()})(),null),a(he,()=>G.debitAmount>0?"+":"-",null),a(he,()=>b(G.debitAmount||G.creditAmount),null),a(de,(()=>{var le=Te(()=>!!G.isReconciled);return()=>le()&&I(_t,{variant:"outline",size:"sm",onClick:ye=>{ye.stopPropagation(),x(G)},style:{"margin-top":"0.5rem"},get children(){return e("banking.unreconcile")}})})(),null),fe(le=>{var ye=q(s()?.id===G.id,G.isReconciled),ve=J,pe=C,ge=P,ke=$(G.debitAmount>0);return le.e=p(Q,ye,le.e),le.t=p(ie,ve,le.t),le.a=p(me,pe,le.a),le.o=p(oe,ge,le.o),le.i=p(he,ke,le.i),le},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Q})())),B.style.setProperty("margin","0 0 1rem 0"),a(B,()=>e("banking.entryBookRecords"),null),a(B,(()=>{var G=Te(()=>!!(s()&&!s().isReconciled));return()=>G()&&(()=>{var Q=KN(),ie=Q.firstChild,me=ie.nextSibling;return me.nextSibling,Q.style.setProperty("font-weight","400"),Q.style.setProperty("color","var(--text-muted)"),Q.style.setProperty("margin-left","0.5rem"),a(Q,()=>e("banking.clickToReconcile"),me),Q})()})(),null),a(M,(()=>{var G=Te(()=>!!(s()&&!s().isReconciled));return()=>G()?[Te(()=>Te(()=>c().length>0)()&&(()=>{var Q=JN(),ie=Q.firstChild,me=ie.firstChild;return ie.nextSibling,Q.style.setProperty("margin-bottom","1rem"),Q.style.setProperty("padding","0.75rem"),Q.style.setProperty("background","#fff3cd"),Q.style.setProperty("border-radius","var(--border-radius-sm)"),a(ie,()=>e("banking.potentialMatchesFound"),me),a(Q,()=>e("banking.clickRecordToReconcile"),null),Q})()),Te(()=>f().map(Q=>(c().includes(Q),(()=>{var ie=ob(),me=ie.firstChild,oe=me.firstChild,ee=oe.nextSibling,de=ee.firstChild,he=me.nextSibling;return ie.$$click=()=>{Q.isReconciled||E(Q)},a(oe,()=>Q.description,null),a(oe,()=>v(Q),null),a(ee,()=>S(Q.date),de),a(ee,()=>Q.reference,null),a(ee,(()=>{var le=Te(()=>!!Q.isReconciled);return()=>le()&&(()=>{var ye=Am();return ye.firstChild,ye.style.setProperty("color","#4caf50"),ye.style.setProperty("margin-left","0.5rem"),a(ye,()=>e("banking.reconciled"),null),ye})()})(),null),a(he,()=>Q.debitAmount>0?"+":"-",null),a(he,()=>b(Q.debitAmount||Q.creditAmount),null),fe(le=>{var ye={...q(!1,Q.isReconciled),opacity:Q.isReconciled?.6:1,cursor:Q.isReconciled?"not-allowed":"pointer"},ve=J,pe=C,ge=P,ke=$(Q.debitAmount>0);return le.e=p(ie,ye,le.e),le.t=p(me,ve,le.t),le.a=p(oe,pe,le.a),le.o=p(ee,ge,le.o),le.i=p(he,ke,le.i),le},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ie})())))]:f().map(Q=>(()=>{var ie=ob(),me=ie.firstChild,oe=me.firstChild,ee=oe.nextSibling,de=ee.firstChild,he=me.nextSibling;return a(oe,()=>Q.description),a(ee,()=>S(Q.date),de),a(ee,()=>Q.reference,null),a(ee,(()=>{var le=Te(()=>!!Q.isReconciled);return()=>le()&&(()=>{var ye=Am();return ye.firstChild,ye.style.setProperty("color","#4caf50"),ye.style.setProperty("margin-left","0.5rem"),a(ye,()=>e("banking.reconciled"),null),ye})()})(),null),a(he,()=>Q.debitAmount>0?"+":"-",null),a(he,()=>b(Q.debitAmount||Q.creditAmount),null),fe(le=>{var ye=q(!1,Q.isReconciled),ve=J,pe=C,ge=P,ke=$(Q.debitAmount>0);return le.e=p(ie,ye,le.e),le.t=p(me,ve,le.t),le.a=p(oe,pe,le.a),le.o=p(ee,ge,le.o),le.i=p(he,ke,le.i),le},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ie})())})()),a(L,(()=>{var G=Te(()=>!!(s()&&!s().isReconciled));return()=>G()&&(()=>{var Q=QN(),ie=Q.firstChild,me=ie.firstChild,oe=ie.nextSibling,ee=oe.nextSibling;return Q.style.setProperty("position","fixed"),Q.style.setProperty("bottom","2rem"),Q.style.setProperty("right","2rem"),Q.style.setProperty("background","var(--surface-color)"),Q.style.setProperty("padding","1rem"),Q.style.setProperty("border-radius","var(--border-radius)"),Q.style.setProperty("box-shadow","var(--shadow-lg)"),Q.style.setProperty("border","1px solid var(--border-color)"),Q.style.setProperty("max-width","300px"),ie.style.setProperty("font-weight","500"),ie.style.setProperty("margin-bottom","0.5rem"),a(ie,()=>e("banking.selected"),me),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("margin-bottom","0.5rem"),a(oe,()=>s().description),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","var(--primary-color)"),a(ee,()=>b(s().debitAmount||s().creditAmount)),a(Q,I(_t,{variant:"secondary",size:"sm",onClick:()=>{l(null),d([])},style:{"margin-top":"0.5rem"},get children(){return e("banking.clearSelection")}}),null),Q})()})(),null),fe(G=>{var Q=j(u()==="all"),ie=j(u()==="unreconciled"),me=j(u()==="reconciled"),oe=Y,ee=Y;return G.e=p(W,Q,G.e),G.t=p(se,ie,G.t),G.a=p(F,me,G.a),G.o=p(Z,oe,G.o),G.i=p(M,ee,G.i),G},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),L})()};br(["click"]);var ZN=ae("<div><div><h2></h2><p></p></div><div>"),eL=ae("<div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date>"),tL=ae("<div><button></button><button>"),rL=ae("<div><br>"),dd=ae("<div>"),nL=ae("<div><div></div><div>  </div><div>"),iL=ae("<div>: "),oL=ae("<div> <!>  <!> "),sL=ae("<div>%"),aL=ae("<div> of <!> transactions");const lL=()=>{const{t}=_r(),[e,r]=we(null),[n,i]=we({start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[o,s]=we(!1),[l,c]=we("overview");xi(()=>{!e()&&ci.bankAccounts.length>0&&r(ci.bankAccounts[0])});const d={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},u={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},y={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},g=K=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:K?"var(--primary-color)":"var(--text-muted)","border-bottom":K?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),f={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},w=K=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(K),E=K=>new Date(K).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),x=()=>ci.bankAccounts.map(K=>({value:K.id,label:`${K.bankName} - ${K.accountNumber} (${K.accountType})`})),Y=(()=>{if(!e())return null;const K=ci.getBankStatementsByAccount(e().accountId).filter(J=>J.date>=n().start&&J.date<=n().end),j=ci.getEntryBookRecordsByAccount(e().accountId).filter(J=>J.date>=n().start&&J.date<=n().end),q=K.filter(J=>J.isReconciled).length;return j.filter(J=>J.isReconciled).length,{totalBankTransactions:K.length,totalEntryBookRecords:j.length,reconciledTransactions:q,unreconciledTransactions:K.length-q,reconciliationRate:K.length>0?q/K.length*100:0}})();return I(Po,{get title(){return t("banking.title")},get children(){return[(()=>{var K=ZN(),j=K.firstChild,q=j.firstChild,J=q.nextSibling,C=j.nextSibling;return p(K,d),q.style.setProperty("margin","0 0 0.5rem 0"),q.style.setProperty("font-size","1.5rem"),a(q,()=>t("banking.reconciliation")),J.style.setProperty("margin","0"),J.style.setProperty("color","var(--text-muted)"),a(J,()=>t("banking.compareStatements")),C.style.setProperty("display","flex"),C.style.setProperty("gap","1rem"),a(C,I(_t,{variant:"secondary",onClick:()=>s(!0),get disabled(){return!e()},get children(){return t("banking.importCSV")}}),null),a(C,I(_t,{variant:"primary",get children(){return t("banking.startNewReconciliation")}}),null),K})(),(()=>{var K=eL(),j=K.firstChild,q=j.firstChild,J=j.nextSibling,C=J.firstChild,P=C.nextSibling,$=J.nextSibling,D=$.firstChild,b=D.nextSibling;return p(K,u),j.style.setProperty("flex","1"),q.style.setProperty("display","block"),q.style.setProperty("margin-bottom","0.5rem"),q.style.setProperty("font-weight","500"),a(q,()=>t("banking.bankAccount")),a(j,I(Hn,{label:"",get value(){return e()?.id||""},onChange:S=>{const v=ci.getBankAccountById(S);r(v||null)},get options(){return x()}}),null),C.style.setProperty("display","block"),C.style.setProperty("margin-bottom","0.5rem"),C.style.setProperty("font-weight","500"),a(C,()=>t("entryBooks.startDate")),P.addEventListener("change",S=>i(v=>({...v,start:S.target.value}))),P.style.setProperty("padding","0.75rem"),P.style.setProperty("border","1px solid var(--border-color)"),P.style.setProperty("border-radius","var(--border-radius-sm)"),P.style.setProperty("font-family","inherit"),D.style.setProperty("display","block"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("font-weight","500"),a(D,()=>t("entryBooks.endDate")),b.addEventListener("change",S=>i(v=>({...v,end:S.target.value}))),b.style.setProperty("padding","0.75rem"),b.style.setProperty("border","1px solid var(--border-color)"),b.style.setProperty("border-radius","var(--border-radius-sm)"),b.style.setProperty("font-family","inherit"),fe(()=>P.value=n().start),fe(()=>b.value=n().end),K})(),(()=>{var K=tL(),j=K.firstChild,q=j.nextSibling;return p(K,y),j.$$click=()=>c("overview"),a(j,()=>t("common.overview")),q.$$click=()=>c("reconciliation"),a(q,()=>t("banking.reconciliation")),fe(J=>{var C=g(l()==="overview"),P=g(l()==="reconciliation");return J.e=p(j,C,J.e),J.t=p(q,P,J.t),J},{e:void 0,t:void 0}),K})(),Te(()=>Te(()=>l()==="overview")()&&(()=>{var K=dd();return a(K,(()=>{var j=Te(()=>!!e());return()=>j()&&(()=>{var q=dd();return p(q,f),a(q,I(Gt,{get title(){return t("banking.bankAccountInfo")},get subtitle(){return t("banking.currentAccountDetails")},get children(){return[(()=>{var J=nL(),C=J.firstChild,P=C.nextSibling,$=P.firstChild,D=P.nextSibling;return J.style.setProperty("margin-bottom","1rem"),C.style.setProperty("font-weight","600"),C.style.setProperty("margin-bottom","0.5rem"),a(C,()=>e().bankName),P.style.setProperty("color","var(--text-muted)"),P.style.setProperty("margin-bottom","0.5rem"),a(P,()=>e().accountNumber,$),a(P,()=>e().accountType,null),D.style.setProperty("font-size","1.25rem"),D.style.setProperty("font-weight","600"),D.style.setProperty("color","var(--primary-color)"),a(D,()=>w(e().currentBalance)),J})(),Te(()=>Te(()=>!!e().lastReconciledDate)()&&(()=>{var J=iL(),C=J.firstChild;return J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-muted)"),a(J,()=>t("banking.lastReconciled"),C),a(J,()=>E(e().lastReconciledDate),null),J})())]}}),null),a(q,Y&&[I(Gt,{get title(){return t("banking.bankTransactions")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var J=dd();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","var(--primary-color)"),J.style.setProperty("margin-bottom","0.5rem"),a(J,()=>Y.totalBankTransactions),J})(),(()=>{var J=oL(),C=J.firstChild,P=C.nextSibling,$=P.nextSibling,D=$.nextSibling;return D.nextSibling,J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-muted)"),a(J,()=>Y.reconciledTransactions,C),a(J,()=>t("banking.reconciled"),P),a(J,()=>Y.unreconciledTransactions,D),a(J,()=>t("banking.pending"),null),J})()]}}),I(Gt,{get title(){return t("entryBooks.entryBookRecords")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var J=dd();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","var(--primary-color)"),J.style.setProperty("margin-bottom","0.5rem"),a(J,()=>Y.totalEntryBookRecords),J})(),(()=>{var J=dd();return J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-muted)"),a(J,()=>t("banking.bookEntriesForComparison")),J})()]}}),I(Gt,{get title(){return t("banking.reconciliationRate")},get subtitle(){return t("banking.completionStatus")},get children(){return[(()=>{var J=sL(),C=J.firstChild;return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("margin-bottom","0.5rem"),a(J,()=>Math.round(Y.reconciliationRate),C),fe(P=>(P=Y.reconciliationRate>80?"#4caf50":Y.reconciliationRate>50?"#ff9800":"#f44336")!=null?J.style.setProperty("color",P):J.style.removeProperty("color")),J})(),(()=>{var J=aL(),C=J.firstChild,P=C.nextSibling;return P.nextSibling,J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-muted)"),a(J,()=>Y.reconciledTransactions,C),a(J,()=>Y.totalBankTransactions,P),J})()]}})],null),q})()})(),null),a(K,I(Gt,{get title(){return t("banking.recentReconciliationSessions")},get subtitle(){return t("banking.latestActivity")},get children(){var j=rL(),q=j.firstChild;return j.style.setProperty("text-align","center"),j.style.setProperty("color","var(--text-muted)"),j.style.setProperty("padding","2rem"),a(j,()=>t("banking.noRecentSessions"),q),a(j,I(_t,{variant:"primary",style:{"margin-top":"1rem"},onClick:()=>c("reconciliation"),get children(){return t("banking.startFirstReconciliation")}}),null),j}}),null),K})()),Te(()=>Te(()=>!!(l()==="reconciliation"&&e()))()&&I(XN,{get bankAccountId(){return e().id},get selectedPeriod(){return n()}})),I(GN,{get isOpen(){return o()},onClose:()=>s(!1),get bankAccount(){return e()}})]}})};br(["click"]);br(["input","click"]);var cL=ae("<h2>Upload Bank Statement CSV"),dL=ae("<input type=file accept=.csv>"),uL=ae("<h3>Filters"),hL=ae('<div><input type=text placeholder="Search transactions..."><input type=date placeholder="Start Date"><input type=date placeholder="End Date"><button>Download Detailed Report'),pL=ae("<div><button>Summary</button><button>Deposits</button><button>Payments</button><button>Timeline"),mL=ae("<h3>Total Deposits"),eh=ae("<p>"),sb=ae("<p> transactions"),fL=ae("<h3>Total Payments"),yL=ae("<h3>Net Cash Flow"),gL=ae("<h3>Check Payments"),vL=ae("<p> checks"),ud=ae("<div>"),bL=ae("<h3>Accounts & Payment Methods Used"),_L=ae("<h3>Monthly Cash Flow Trend"),PL=ae("<div><table><thead><tr><th>Month</th><th>Deposits</th><th>Payments</th><th>Net</th></tr></thead><tbody>"),SL=ae("<h2>Deposits by Type"),wL=ae("<h2>Top Depositors"),xL=ae("<div><table><thead><tr><th>Depositor</th><th>Total Amount</th><th>Count</th><th>Actions</th></tr></thead><tbody>"),CL=ae("<h2>Payments by Category"),AL=ae("<h2>Top Payees"),$L=ae("<div><table><thead><tr><th>Payee</th><th>Category</th><th>Total Amount</th><th>Count</th></tr></thead><tbody>"),EL=ae("<h2>Transaction Timeline"),IL=ae("<div><h1>Detailed Bank Statement Analyzer"),TL=ae("<span>"),kL=ae("<tr><td></td><td></td><td></td><td>"),ab=ae("<div><h4></h4><p></p><p> transactions"),NL=ae("<tr><td></td><td></td><td></td><td><details><summary>View</summary><div>"),LL=ae("<div> - "),RL=ae("<tr><td></td><td><span></span></td><td></td><td>"),DL=ae("<div><div><div></div><div>  </div></div><div><div>");const ML=()=>{const[t,e]=we(""),[r,n]=we("summary"),[i,o]=we(""),[s,l]=we({start:"",end:""}),[c,d]=Zd({list:[]}),u={Utilities:["AT&T","METRO BY T-MOBILE","COMCAST","STREAM ENERGY","NETFLIX","SPECTRUM"],checks:["CHECK"],JPM:["JPM","POVBR"],Transportation:["DRIVE AWAY","TRANPORT","QUICKQUACK","EXXON","SHELL","CHEVRON","UBER","LYFT","U-HAUL","UHAL","LOVE'S"],Lodging:["HOLIDAY INN","MARRIOTT","HILTON","AIRBNB","HOTEL","MOTEL"],"Food & Dining":["GOLDEN CORRAL","MOCTEZUMA","CHINA STAR","RESTAURANT","CAFE","STARBUCKS","BUFFET","GRILL","MARKET","SEAFOOD"],Shopping:["BURLINGTON","WALMART","TARGET","AMAZON","ROSS","KROGER","PUBLIC","AMZN","AMZ"],Financial:["AMERICANFIRSTFIN","LOAN","CREDIT"],Insurance:["INSURANCE","GEICO","STATE FARM"],Rent:["SHAFAII INVESTME"],Medical:["PHARMACY","CVS","WALGREENS","HOSPITAL","CLINIC"],Entertainment:["CINEMA","THEATER","CONCERT"],"Other Services":["BARBER","SALON","SPA","GYM"],Return:["RETURN ITEM "]},y=j=>{const q=j.toUpperCase();for(const[J,C]of Object.entries(u))for(const P of C)if(q.includes(P.toUpperCase()))return J;return"Other"},g=j=>{const q=j.match(/Zelle payment from ([^0-9]+)/i);if(q)return q[1].trim().replace(/[A-Z0-9]{10,}$/,"").trim();if(j.includes("CHECK"))return"Check Payment";const J=j.match(/^([^0-9]+)/);return J?J[1].trim():j.substring(0,30)},f=j=>{const q=j.trim().split(`
`),J=[];console.log(q);for(let C=1;C<q.length;C++){const P=q[C].split(",");if(console.log(P),P.length>=3){const $=parseFloat(P[2]);let D={postingDate:P[0],description:P[1],amount:$};J.push(D)}}return console.log({transactions:J}),d("list",J),J};Ut(()=>t()?f(t()):[]);const w=Ut(()=>{let j=c?.list;if((s().start||s().end)&&(j=j.filter(q=>{const J=new Date(q.postingDate),C=s().start?new Date(s().start):new Date("2024-01-01"),P=s().end?new Date(s().end):new Date("2024-12-31");return J>=C&&J<=P})),i()){const q=i().toLowerCase();j=j.filter(J=>J.description.toLowerCase().includes(q)||Math.abs(J.amount).toString().includes(q))}return j}),E=Ut(()=>{const j={deposits:{total:0,count:0,byType:new Map,byPayee:new Map},payments:{total:0,count:0,byType:new Map,byPayee:new Map},checks:{total:0,count:0,transactions:[]},transfers:{total:0,count:0,transactions:[]},dailyBalances:new Map,accountsAffected:new Set};return w().forEach(q=>{const J=g(q.description);if(console.log({transaction:q}),j.dailyBalances.set(q.postingDate,q.amount),(q.description.includes("ZELLE")||q.description.includes("QUICKPAY"))&&j.accountsAffected.add("Zelle Account"),q.description.includes("ACH")&&j.accountsAffected.add("ACH Network"),q?.description.includes("DEBIT_CARD")&&j.accountsAffected.add("Debit Card"),q?.description.includes("CHECK")&&j.accountsAffected.add("Checking Account"),q?.description.includes("TRANSFER")&&j.accountsAffected.add("Savings Account"),q.amount>0){j.deposits.total+=q.amount,j.deposits.count++,j.deposits.byType.has(q.description)||j.deposits.byType.set(q.description,{total:0,count:0,transactions:[]});const C=j.deposits.byType.get(q.description);C.total+=q.amount,C.count++,C.transactions.push(q),j.deposits.byPayee.has(J)||j.deposits.byPayee.set(J,{name:J,totalAmount:0,transactionCount:0,transactions:[]});const P=j.deposits.byPayee.get(J);P.totalAmount+=q.amount,P.transactionCount++,P.transactions.push(q)}if(q.amount<0){j.payments.total+=Math.abs(q.amount),j.payments.count++,j.payments.byType.has(q.description)||j.payments.byType.set(q.description,{total:0,count:0,transactions:[]});const C=j.payments.byType.get(q.description);C.total+=Math.abs(q.amount),C.count++,C.transactions.push(q);const P=y(q.description);j.payments.byPayee.has(J)||j.payments.byPayee.set(J,{name:J,totalAmount:0,transactionCount:0,transactions:[],category:P});const $=j.payments.byPayee.get(J);$.totalAmount+=Math.abs(q.amount),$.transactionCount++,$.transactions.push(q)}(q.type==="CHECK_PAID"||q.checkNumber)&&(j.checks.total+=Math.abs(q.amount),j.checks.count++,j.checks.transactions.push(q)),(q.description.includes("TRANSFER")||q.description==="ACCT_XFER")&&(j.transfers.total+=Math.abs(q.amount),j.transfers.count++,j.transfers.transactions.push(q))}),console.log(j),j}),x=Ut(()=>{const j=new Map;return w().forEach(q=>{const J=q.postingDate.substring(0,7);j.has(J)||j.set(J,{deposits:0,payments:0,net:0});const C=j.get(J);q.amount>0?C.deposits+=q.amount:C.payments+=Math.abs(q.amount),C.net=C.deposits-C.payments}),Array.from(j.entries()).sort((q,J)=>q[0].localeCompare(J[0]))}),T=j=>{const J=j.target.files?.[0];if(J){const C=new FileReader;C.onload=P=>{console.log(P.target?.result),f(P.target?.result)},C.readAsText(J)}},Y=()=>{const j=E();let q=`# DETAILED BANK STATEMENT ANALYSIS
`;q+=`Generated: ${new Date().toLocaleDateString()}

`,q+=`## EXECUTIVE SUMMARY

`,q+=`- **Total Deposits:** $${j.deposits.total.toFixed(2)} (${j.deposits.count} transactions)
`,q+=`- **Total Payments:** $${j.payments.total.toFixed(2)} (${j.payments.count} transactions)
`,q+=`- **Net Cash Flow:** $${(j.deposits.total-j.payments.total).toFixed(2)}
`,q+=`- **Check Payments:** $${j.checks.total.toFixed(2)} (${j.checks.count} checks)
`,q+=`- **Transfers:** $${j.transfers.total.toFixed(2)} (${j.transfers.count} transfers)

`,q+=`## ACCOUNTS AFFECTED

`,j.accountsAffected.forEach(S=>{q+=`- ${S}
`}),q+=`
`,q+=`## DEPOSITS DETAIL

`,q+=`### By Type
`,j.deposits.byType.forEach((S,v)=>{q+=`- **${v}**: $${S.total.toFixed(2)} (${S.count} transactions)
`}),q+=`
### Top Depositors
`,Array.from(j.deposits.byPayee.entries()).sort((S,v)=>v[1].totalAmount-S[1].totalAmount).slice(0,20).forEach(([S,v])=>{q+=`- **${S}**: $${v.totalAmount.toFixed(2)} (${v.transactionCount} transactions)
`}),q+=`
## PAYMENTS DETAIL

`,q+=`### By Type
`,j.payments.byType.forEach((S,v)=>{q+=`- **${v}**: $${S.total.toFixed(2)} (${S.count} transactions)
`}),q+=`
### By Category
`;const C=new Map;j.payments.byPayee.forEach(S=>{const v=S.category||"Other";C.set(v,(C.get(v)||0)+S.totalAmount)}),Array.from(C.entries()).sort((S,v)=>v[1]-S[1]).forEach(([S,v])=>{q+=`- **${S}**: $${v.toFixed(2)}
`}),q+=`
### Top Payees
`,Array.from(j.payments.byPayee.entries()).sort((S,v)=>v[1].totalAmount-S[1].totalAmount).slice(0,20).forEach(([S,v])=>{q+=`- **${S}** (${v.category}): $${v.totalAmount.toFixed(2)} (${v.transactionCount} transactions)
`}),q+=`
## MONTHLY CASH FLOW TREND

`,x().forEach(([S,v])=>{q+=`- **${S}**: Deposits: $${v.deposits.toFixed(2)} | Payments: $${v.payments.toFixed(2)} | Net: $${v.net.toFixed(2)}
`}),j.checks.transactions.length>0&&(q+=`
## CHECK PAYMENTS DETAIL

`,j.checks.transactions.forEach(S=>{q+=`- Check #${S.checkNumber||"N/A"} - ${S.postingDate} - $${Math.abs(S.amount).toFixed(2)}
`}));const $=new Blob([q],{type:"text/markdown"}),D=URL.createObjectURL($),b=document.createElement("a");b.href=D,b.download=`detailed_bank_analysis_${new Date().toISOString().split("T")[0]}.md`,b.click(),URL.revokeObjectURL(D)},K=j=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(j);return(()=>{var j=IL(),q=j.firstChild;return j.style.setProperty("padding","2rem"),q.style.setProperty("margin-bottom","2rem"),a(j,I(Gt,{style:{"margin-bottom":"2rem"},get children(){return[cL(),(()=>{var J=dL();return J.addEventListener("change",T),J.style.setProperty("margin-top","1rem"),J})()]}}),null),a(j,I(Oe,{get when(){return c?.list},get children(){return[I(Gt,{style:{"margin-bottom":"2rem"},get children(){return[uL(),(()=>{var J=hL(),C=J.firstChild,P=C.nextSibling,$=P.nextSibling,D=$.nextSibling;return J.style.setProperty("display","flex"),J.style.setProperty("gap","1rem"),J.style.setProperty("margin-top","1rem"),J.style.setProperty("flex-wrap","wrap"),C.$$input=b=>o(b.currentTarget.value),C.style.setProperty("flex","1"),C.style.setProperty("min-width","200px"),C.style.setProperty("padding","0.5rem"),P.$$input=b=>l({...s(),start:b.currentTarget.value}),$.$$input=b=>l({...s(),end:b.currentTarget.value}),D.$$click=Y,D.style.setProperty("padding","0.5rem 1rem"),D.style.setProperty("background","var(--primary-color)"),D.style.setProperty("color","white"),D.style.setProperty("border","none"),D.style.setProperty("border-radius","var(--border-radius-sm)"),D.style.setProperty("cursor","pointer"),fe(()=>C.value=i()),fe(()=>P.value=s().start),fe(()=>$.value=s().end),J})()]}}),(()=>{var J=pL(),C=J.firstChild,P=C.nextSibling,$=P.nextSibling,D=$.nextSibling;return J.style.setProperty("display","flex"),J.style.setProperty("gap","1rem"),J.style.setProperty("margin-bottom","2rem"),C.$$click=()=>n("summary"),C.style.setProperty("padding","0.5rem 1rem"),C.style.setProperty("border","none"),C.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("cursor","pointer"),P.$$click=()=>n("deposits"),P.style.setProperty("padding","0.5rem 1rem"),P.style.setProperty("border","none"),P.style.setProperty("border-radius","var(--border-radius-sm)"),P.style.setProperty("cursor","pointer"),$.$$click=()=>n("payments"),$.style.setProperty("padding","0.5rem 1rem"),$.style.setProperty("border","none"),$.style.setProperty("border-radius","var(--border-radius-sm)"),$.style.setProperty("cursor","pointer"),D.$$click=()=>n("timeline"),D.style.setProperty("padding","0.5rem 1rem"),D.style.setProperty("border","none"),D.style.setProperty("border-radius","var(--border-radius-sm)"),D.style.setProperty("cursor","pointer"),fe(b=>{var S=r()==="summary"?"var(--primary-color)":"#e9ecef",v=r()==="summary"?"white":"black",z=r()==="deposits"?"var(--primary-color)":"#e9ecef",re=r()==="deposits"?"white":"black",L=r()==="payments"?"var(--primary-color)":"#e9ecef",O=r()==="payments"?"white":"black",ne=r()==="timeline"?"var(--primary-color)":"#e9ecef",X=r()==="timeline"?"white":"black";return S!==b.e&&((b.e=S)!=null?C.style.setProperty("background",S):C.style.removeProperty("background")),v!==b.t&&((b.t=v)!=null?C.style.setProperty("color",v):C.style.removeProperty("color")),z!==b.a&&((b.a=z)!=null?P.style.setProperty("background",z):P.style.removeProperty("background")),re!==b.o&&((b.o=re)!=null?P.style.setProperty("color",re):P.style.removeProperty("color")),L!==b.i&&((b.i=L)!=null?$.style.setProperty("background",L):$.style.removeProperty("background")),O!==b.n&&((b.n=O)!=null?$.style.setProperty("color",O):$.style.removeProperty("color")),ne!==b.s&&((b.s=ne)!=null?D.style.setProperty("background",ne):D.style.removeProperty("background")),X!==b.h&&((b.h=X)!=null?D.style.setProperty("color",X):D.style.removeProperty("color")),b},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),J})(),I(Oe,{get when(){return r()==="summary"},get children(){return[(()=>{var J=ud();return J.style.setProperty("display","grid"),J.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),J.style.setProperty("gap","1rem"),J.style.setProperty("margin-bottom","2rem"),a(J,I(Gt,{get children(){return[mL(),(()=>{var C=eh();return C.style.setProperty("font-size","2rem"),C.style.setProperty("font-weight","bold"),C.style.setProperty("color","#22c55e"),a(C,()=>K(E().deposits.total)),C})(),(()=>{var C=sb(),P=C.firstChild;return C.style.setProperty("color","#6c757d"),a(C,()=>E().deposits.count,P),C})()]}}),null),a(J,I(Gt,{get children(){return[fL(),(()=>{var C=eh();return C.style.setProperty("font-size","2rem"),C.style.setProperty("font-weight","bold"),C.style.setProperty("color","#ef4444"),a(C,()=>K(E().payments.total)),C})(),(()=>{var C=sb(),P=C.firstChild;return C.style.setProperty("color","#6c757d"),a(C,()=>E().payments.count,P),C})()]}}),null),a(J,I(Gt,{get children(){return[yL(),(()=>{var C=eh();return C.style.setProperty("font-size","2rem"),C.style.setProperty("font-weight","bold"),a(C,()=>K(E().deposits.total-E().payments.total)),fe(P=>(P=E().deposits.total-E().payments.total>=0?"#22c55e":"#ef4444")!=null?C.style.setProperty("color",P):C.style.removeProperty("color")),C})()]}}),null),a(J,I(Gt,{get children(){return[gL(),(()=>{var C=eh();return C.style.setProperty("font-size","2rem"),C.style.setProperty("font-weight","bold"),C.style.setProperty("color","#3b82f6"),a(C,()=>K(E().checks.total)),C})(),(()=>{var C=vL(),P=C.firstChild;return C.style.setProperty("color","#6c757d"),a(C,()=>E().checks.count,P),C})()]}}),null),J})(),I(Gt,{style:{"margin-bottom":"2rem"},get children(){return[bL(),(()=>{var J=ud();return J.style.setProperty("display","flex"),J.style.setProperty("flex-wrap","wrap"),J.style.setProperty("gap","0.5rem"),J.style.setProperty("margin-top","1rem"),a(J,I(Ct,{get each(){return Array.from(E().accountsAffected)},children:C=>(()=>{var P=TL();return P.style.setProperty("padding","0.25rem 0.75rem"),P.style.setProperty("background","#e9ecef"),P.style.setProperty("border-radius","9999px"),P.style.setProperty("font-size","0.875rem"),a(P,C),P})()})),J})()]}}),I(Gt,{get children(){return[_L(),(()=>{var J=PL(),C=J.firstChild,P=C.firstChild,$=P.firstChild,D=$.firstChild,b=D.nextSibling,S=b.nextSibling,v=S.nextSibling,z=P.nextSibling;return J.style.setProperty("overflow-x","auto"),C.style.setProperty("width","100%"),C.style.setProperty("border-collapse","collapse"),C.style.setProperty("margin-top","1rem"),$.style.setProperty("border-bottom","2px solid #dee2e6"),D.style.setProperty("padding","0.75rem"),D.style.setProperty("text-align","left"),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","right"),S.style.setProperty("padding","0.75rem"),S.style.setProperty("text-align","right"),v.style.setProperty("padding","0.75rem"),v.style.setProperty("text-align","right"),a(z,I(Ct,{get each(){return x()},children:([re,L])=>(()=>{var O=kL(),ne=O.firstChild,X=ne.nextSibling,W=X.nextSibling,se=W.nextSibling;return O.style.setProperty("border-bottom","1px solid #dee2e6"),ne.style.setProperty("padding","0.75rem"),a(ne,re),X.style.setProperty("padding","0.75rem"),X.style.setProperty("text-align","right"),X.style.setProperty("color","#22c55e"),a(X,()=>K(isNaN(L.deposits)?0:L.deposits)),W.style.setProperty("padding","0.75rem"),W.style.setProperty("text-align","right"),W.style.setProperty("color","#ef4444"),a(W,()=>K(isNaN(L.payments)?0:L.payments)),se.style.setProperty("padding","0.75rem"),se.style.setProperty("text-align","right"),se.style.setProperty("font-weight","bold"),a(se,()=>K(L.net)),fe(F=>(F=L.net>=0?"#22c55e":"#ef4444")!=null?se.style.setProperty("color",F):se.style.removeProperty("color")),O})()})),J})()]}})]}}),I(Oe,{get when(){return r()==="deposits"},get children(){return[I(Gt,{style:{"margin-bottom":"2rem"},get children(){return[SL(),(()=>{var J=ud();return J.style.setProperty("display","grid"),J.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(300px, 1fr))"),J.style.setProperty("gap","1rem"),J.style.setProperty("margin-top","1rem"),a(J,I(Ct,{get each(){return Array.from(E().deposits.byType.entries())},children:([C,P])=>(()=>{var $=ab(),D=$.firstChild,b=D.nextSibling,S=b.nextSibling,v=S.firstChild;return $.style.setProperty("padding","1rem"),$.style.setProperty("background","#f8f9fa"),$.style.setProperty("border-radius","var(--border-radius-sm)"),$.style.setProperty("border","1px solid #e9ecef"),a(D,C),b.style.setProperty("font-size","1.5rem"),b.style.setProperty("font-weight","bold"),b.style.setProperty("color","#22c55e"),a(b,()=>K(P.total)),S.style.setProperty("color","#6c757d"),a(S,()=>P.count,v),$})()})),J})()]}}),I(Gt,{get children(){return[wL(),(()=>{var J=xL(),C=J.firstChild,P=C.firstChild,$=P.firstChild,D=$.firstChild,b=D.nextSibling,S=b.nextSibling,v=S.nextSibling,z=P.nextSibling;return J.style.setProperty("overflow-x","auto"),C.style.setProperty("width","100%"),C.style.setProperty("border-collapse","collapse"),C.style.setProperty("margin-top","1rem"),$.style.setProperty("border-bottom","2px solid #dee2e6"),D.style.setProperty("padding","0.75rem"),D.style.setProperty("text-align","left"),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","right"),S.style.setProperty("padding","0.75rem"),S.style.setProperty("text-align","center"),v.style.setProperty("padding","0.75rem"),v.style.setProperty("text-align","center"),a(z,I(Ct,{get each(){return Array.from(E().deposits.byPayee.entries()).sort((re,L)=>L[1].totalAmount-re[1].totalAmount).slice(0,20)},children:([re,L])=>(()=>{var O=NL(),ne=O.firstChild,X=ne.nextSibling,W=X.nextSibling,se=W.nextSibling,F=se.firstChild,k=F.firstChild,N=k.nextSibling;return O.style.setProperty("border-bottom","1px solid #dee2e6"),ne.style.setProperty("padding","0.75rem"),a(ne,re),X.style.setProperty("padding","0.75rem"),X.style.setProperty("text-align","right"),X.style.setProperty("color","#22c55e"),X.style.setProperty("font-weight","bold"),a(X,()=>K(L.totalAmount)),W.style.setProperty("padding","0.75rem"),W.style.setProperty("text-align","center"),a(W,()=>L.transactionCount),se.style.setProperty("padding","0.75rem"),se.style.setProperty("text-align","center"),k.style.setProperty("cursor","pointer"),N.style.setProperty("margin-top","0.5rem"),N.style.setProperty("font-size","0.875rem"),a(N,I(Ct,{get each(){return L.transactions.slice(0,5)},children:A=>(()=>{var V=LL(),Z=V.firstChild;return V.style.setProperty("padding","0.25rem"),a(V,()=>A.postingDate,Z),a(V,()=>K(A.amount),null),V})()})),O})()})),J})()]}})]}}),I(Oe,{get when(){return r()==="payments"},get children(){return[I(Gt,{style:{"margin-bottom":"2rem"},get children(){return[CL(),(()=>{var J=ud();return J.style.setProperty("display","grid"),J.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),J.style.setProperty("gap","1rem"),J.style.setProperty("margin-top","1rem"),a(J,()=>{const C=new Map;return E().payments.byPayee.forEach(P=>{const $=P.category||"Other";C.has($)||C.set($,{total:0,count:0});const D=C.get($);D.total+=P.totalAmount,D.count+=P.transactionCount}),Array.from(C.entries()).sort((P,$)=>$[1].total-P[1].total).map(([P,$])=>(()=>{var D=ab(),b=D.firstChild,S=b.nextSibling,v=S.nextSibling,z=v.firstChild;return D.style.setProperty("padding","1rem"),D.style.setProperty("background","#f8f9fa"),D.style.setProperty("border-radius","var(--border-radius-sm)"),D.style.setProperty("border","1px solid #e9ecef"),a(b,P),S.style.setProperty("font-size","1.5rem"),S.style.setProperty("font-weight","bold"),S.style.setProperty("color","#ef4444"),a(S,()=>K($.total)),v.style.setProperty("color","#6c757d"),a(v,()=>$.count,z),D})())}),J})()]}}),I(Gt,{get children(){return[AL(),(()=>{var J=$L(),C=J.firstChild,P=C.firstChild,$=P.firstChild,D=$.firstChild,b=D.nextSibling,S=b.nextSibling,v=S.nextSibling,z=P.nextSibling;return J.style.setProperty("overflow-x","auto"),C.style.setProperty("width","100%"),C.style.setProperty("border-collapse","collapse"),C.style.setProperty("margin-top","1rem"),$.style.setProperty("border-bottom","2px solid #dee2e6"),D.style.setProperty("padding","0.75rem"),D.style.setProperty("text-align","left"),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","left"),S.style.setProperty("padding","0.75rem"),S.style.setProperty("text-align","right"),v.style.setProperty("padding","0.75rem"),v.style.setProperty("text-align","center"),a(z,I(Ct,{get each(){return Array.from(E().payments.byPayee.entries()).sort((re,L)=>L[1].totalAmount-re[1].totalAmount).slice(0,130)},children:([re,L])=>(()=>{var O=RL(),ne=O.firstChild,X=ne.nextSibling,W=X.firstChild,se=X.nextSibling,F=se.nextSibling;return O.style.setProperty("border-bottom","1px solid #dee2e6"),ne.style.setProperty("padding","0.75rem"),a(ne,re),X.style.setProperty("padding","0.75rem"),W.style.setProperty("padding","0.25rem 0.5rem"),W.style.setProperty("background","#e9ecef"),W.style.setProperty("border-radius","4px"),W.style.setProperty("font-size","0.875rem"),a(W,()=>L.category),se.style.setProperty("padding","0.75rem"),se.style.setProperty("text-align","right"),se.style.setProperty("color","#ef4444"),se.style.setProperty("font-weight","bold"),a(se,()=>K(L.totalAmount)),F.style.setProperty("padding","0.75rem"),F.style.setProperty("text-align","center"),a(F,()=>L.transactionCount),O})()})),J})()]}})]}}),I(Oe,{get when(){return r()==="timeline"},get children(){return I(Gt,{get children(){return[EL(),(()=>{var J=ud();return J.style.setProperty("max-height","600px"),J.style.setProperty("overflow-y","auto"),J.style.setProperty("margin-top","1rem"),a(J,I(Ct,{get each(){return w().slice(0,100)},children:C=>(()=>{var P=DL(),$=P.firstChild,D=$.firstChild,b=D.nextSibling,S=b.firstChild,v=$.nextSibling,z=v.firstChild;return P.style.setProperty("padding","1rem"),P.style.setProperty("border-bottom","1px solid #e9ecef"),P.style.setProperty("display","flex"),P.style.setProperty("justify-content","space-between"),P.style.setProperty("align-items","center"),$.style.setProperty("flex","1"),D.style.setProperty("font-weight","bold"),a(D,()=>C.description),b.style.setProperty("font-size","0.875rem"),b.style.setProperty("color","#6c757d"),a(b,()=>C.postingDate,S),a(b,()=>C.type,null),a(b,()=>C.checkNumber&&`  Check #${C.checkNumber}`,null),v.style.setProperty("text-align","right"),z.style.setProperty("font-weight","bold"),z.style.setProperty("font-size","1.1rem"),a(z,()=>K(Math.abs(C.amount)),null),a(z,()=>C.amount>=0?" ":" ",null),fe(re=>(re=C.amount>=0?"#22c55e":"#ef4444")!=null?z.style.setProperty("color",re):z.style.removeProperty("color")),P})()})),J})()]}})}})]}}),null),j})()};br(["input","click"]);var FL=ae("<div><div></div><div>"),$m=ae("<div>"),OL=ae("<div>  <!>  <!> "),BL=ae("<div><div><div></div><div></div></div><div><div></div><div>"),jL=ae("<div><div>:"),VL=ae("<div> <!>: <!> <!>, <!> "),qL=ae("<div><div><div></div><div></div></div><div>"),lb=ae("<div> "),zL=ae("<div> ");const UL=t=>{const{t:e}=_r(),r={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},n={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},i={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},o={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"0.5rem"},s={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"1rem"},l={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},c={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},d={"max-height":"100px","overflow-y":"auto","border-top":"1px solid var(--border-color)","padding-top":"1rem"},u={display:"flex","justify-content":"space-between","align-items":"center","font-size":"0.875rem","margin-bottom":"0.5rem"},y={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},g=T=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[T],f=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T),w=T=>new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),E=g(t.entry.status),x=Math.abs(t.entry.totalDebit-t.entry.totalCredit)<.01;return I(Gt,{get children(){return[(()=>{var T=FL(),Y=T.firstChild,K=Y.nextSibling;return p(T,r),p(Y,n),a(Y,()=>t.entry.entryNumber),a(K,()=>e(`journal.${t.entry.status}`,t.entry.status)),fe(j=>p(K,{...i,background:E.bg,color:E.color},j)),T})(),(()=>{var T=$m();return p(T,o),a(T,()=>t.entry.description),T})(),(()=>{var T=OL(),Y=T.firstChild,K=Y.nextSibling,j=K.nextSibling,q=j.nextSibling;return q.nextSibling,p(T,s),a(T,()=>w(t.entry.date),Y),a(T,()=>t.entry.reference||e("journal.noReference","No reference"),K),a(T,()=>e("journal.createdBy","By"),q),a(T,()=>t.entry.createdBy,null),T})(),(()=>{var T=BL(),Y=T.firstChild,K=Y.firstChild,j=K.nextSibling,q=Y.nextSibling,J=q.firstChild,C=J.nextSibling;return p(T,l),K.style.setProperty("font-size","0.875rem"),K.style.setProperty("color","var(--text-muted)"),a(K,()=>e("journal.totalAmount","Total Amount")),p(j,c),a(j,()=>f(t.entry.totalDebit)),q.style.setProperty("text-align","right"),J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-muted)"),a(J,()=>e("journal.lines","Lines")),C.style.setProperty("font-weight","600"),a(C,()=>t.entry.lines.length),T})(),Te(()=>!x&&(()=>{var T=VL(),Y=T.firstChild,K=Y.nextSibling,j=K.nextSibling,q=j.nextSibling,J=q.nextSibling,C=J.nextSibling,P=C.nextSibling,$=P.nextSibling;return $.nextSibling,T.style.setProperty("padding","0.5rem"),T.style.setProperty("border-radius","var(--border-radius-sm)"),T.style.setProperty("background","#f8d7da"),T.style.setProperty("color","#721c24"),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("margin-bottom","1rem"),a(T,()=>e("journal.entryNotBalancedShort","Entry is not balanced"),K),a(T,()=>e("journal.debit"),q),a(T,()=>f(t.entry.totalDebit),C),a(T,()=>e("journal.credit"),$),a(T,()=>f(t.entry.totalCredit),null),T})()),(()=>{var T=jL(),Y=T.firstChild,K=Y.firstChild;return p(T,d),Y.style.setProperty("font-weight","500"),Y.style.setProperty("margin-bottom","0.5rem"),Y.style.setProperty("font-size","0.875rem"),a(Y,()=>e("journal.accountLines","Account Lines"),K),a(T,()=>t.entry.lines.slice(0,3).map(j=>(()=>{var q=qL(),J=q.firstChild,C=J.firstChild,P=C.nextSibling,$=J.nextSibling;return p(q,u),J.style.setProperty("flex","1"),C.style.setProperty("font-weight","500"),a(C,()=>j.accountName),P.style.setProperty("font-size","0.75rem"),P.style.setProperty("color","var(--text-muted)"),a(P,()=>j.description||e("journal.noDescription","No description")),$.style.setProperty("text-align","right"),a($,(()=>{var D=Te(()=>j.debitAmount>0);return()=>D()&&(()=>{var b=lb(),S=b.firstChild;return b.style.setProperty("color","#4caf50"),b.style.setProperty("font-weight","500"),a(b,()=>e("journal.debitShort","Dr."),S),a(b,()=>f(j.debitAmount),null),b})()})(),null),a($,(()=>{var D=Te(()=>j.creditAmount>0);return()=>D()&&(()=>{var b=lb(),S=b.firstChild;return b.style.setProperty("color","#f44336"),b.style.setProperty("font-weight","500"),a(b,()=>e("journal.creditShort","Cr."),S),a(b,()=>f(j.creditAmount),null),b})()})(),null),a($,(()=>{var D=Te(()=>!!j.reconciled);return()=>D()&&(()=>{var b=zL();return b.firstChild,b.style.setProperty("font-size","0.75rem"),b.style.setProperty("color","#4caf50"),a(b,()=>e("banking.reconciled","Reconciled"),null),b})()})(),null),q})()),null),a(T,(()=>{var j=Te(()=>t.entry.lines.length>3);return()=>j()&&(()=>{var q=$m();return q.style.setProperty("text-align","center"),q.style.setProperty("color","var(--text-muted)"),q.style.setProperty("font-size","0.875rem"),a(q,()=>e("journal.andMoreLines","... and {count} more lines").replace("{count}",(t.entry.lines.length-3).toString())),q})()})(),null),T})(),(()=>{var T=$m();return p(T,y),a(T,I(_t,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.entry),get children(){return e("journal.viewDetails","View Details")}})),T})()]}})};var HL=ae("<form><div></div><div><div><h4></h4></div><div><div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div></div></div><div><div><strong>: </strong></div><div><strong>: </strong></div><div></div></div></div><div>"),Em=ae("<div>");const m_=t=>{const{t:e}=_r(),[r,n]=we({entryNumber:"",date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),[i,o]=we([]),[s,l]=we(null);xi(()=>{if(t.isOpen){if(t.editEntry)n({entryNumber:t.editEntry.entryNumber,date:t.editEntry.date,description:t.editEntry.description,reference:t.editEntry.reference,createdBy:t.editEntry.createdBy}),o(t.editEntry.lines.map((j,q)=>({...j,tempId:`line_${t.editEntry.entryNumber}_${q}`})));else{const j=En.getNextEntryNumber();n({entryNumber:j,date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),o([{tempId:`line_${j}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${j}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])}l(null)}});const c={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},d={display:"grid","grid-template-columns":"2fr 2fr 1fr 1fr 1fr",gap:"1rem","align-items":"end","margin-bottom":"1rem",padding:"1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},u={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},y=()=>qr.accounts.map(j=>({value:j.id,label:`${j.accountNumber} - ${j.name}`})),g=(j,q)=>{n(J=>({...J,[j]:q}))},f=(j,q,J)=>{o(C=>C.map(P=>{if(P.tempId===j){const $={...P,[q]:J};if(q==="accountId"&&typeof J=="string"){const D=qr.getAccountById(J);D&&($.accountName=D.name)}return $}return P}))},w=()=>{o(j=>[...j,{tempId:`line_${r()?.entryNumber}_${j.length}`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])},E=j=>{i().length>2&&o(q=>q.filter(J=>J.tempId!==j))},x=()=>{const j=i().reduce((J,C)=>J+(C.debitAmount||0),0),q=i().reduce((J,C)=>J+(C.creditAmount||0),0);return{totalDebit:j,totalCredit:q,isBalanced:Math.abs(j-q)<.01}},T=j=>{j.preventDefault(),l(null);const q=r(),J=i(),{totalDebit:C,totalCredit:P,isBalanced:$}=x();if(!q.description){l(e("forms.descriptionRequired","Description is required"));return}if(J.length<2){l(e("journal.minTwoLinesRequired","At least 2 line items are required"));return}if(!$){l(e("journal.entryNotBalanced","Entry is not balanced. Debit: ${debit}, Credit: ${credit}").replace("${debit}",`$${C.toFixed(2)}`).replace("${credit}",`$${P.toFixed(2)}`));return}for(let S=0;S<J.length;S++){const v=J[S];if(!v.accountId){l(e("journal.lineAccountRequired","Line {lineNumber}: Account is required").replace("{lineNumber}",(S+1).toString()));return}if(v.debitAmount===0&&v.creditAmount===0){l(e("journal.lineAmountRequired","Line {lineNumber}: Either debit or credit amount must be provided").replace("{lineNumber}",(S+1).toString()));return}if((v.debitAmount||0)>0&&(v.creditAmount||0)>0){l(e("journal.lineBothAmounts","Line {lineNumber}: Cannot have both debit and credit amounts").replace("{lineNumber}",(S+1).toString()));return}}const D={entryNumber:q.entryNumber,date:q.date,description:q.description,reference:q.reference,status:"draft",createdBy:q.createdBy,createdAt:new Date().toISOString(),totalDebit:C,totalCredit:P,lines:J.map((S,v)=>{const{tempId:z,...re}=S;return{id:`jel_${q.entryNumber}_${v}`,...re}})};let b=k1(Object.keys(t.editEntry),D,t.editEntry,{id:1,referenceHId:1,createdBy:1,createdAt:1,createdTimeStamp:1});try{t.editEntry?En.updateJournalEntry(t.editEntry.id,b.data):En.addJournalEntry(D);let S=En.getNextEntryNumber();n({entryNumber:S,date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),o([{tempId:`line_${S}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${S}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),t.onClose()}catch(S){l(S instanceof Error?S.message:e("forms.errorOccurred","An error occurred"))}},Y=j=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(j),K=x();return I(si,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return Te(()=>!!t.editEntry)()?e("journal.editEntry"):e("journal.addEntry","Add Journal Entry")},get children(){var j=HL(),q=j.firstChild,J=q.nextSibling,C=J.firstChild,P=C.firstChild,$=C.nextSibling,D=$.firstChild,b=D.firstChild,S=b.firstChild,v=b.nextSibling,z=v.firstChild,re=v.nextSibling,L=re.firstChild,O=re.nextSibling,ne=O.firstChild,X=O.nextSibling,W=X.firstChild,se=$.nextSibling,F=se.firstChild,k=F.firstChild,N=k.firstChild,A=F.nextSibling,V=A.firstChild,Z=V.firstChild,H=A.nextSibling,B=J.nextSibling;return j.addEventListener("submit",T),q.style.setProperty("display","grid"),q.style.setProperty("grid-template-columns","1fr 1fr"),q.style.setProperty("gap","1rem"),a(q,I(Mr,{get label(){return e("journal.entryNumber")},get value(){return r().entryNumber},onChange:M=>g("entryNumber",M),get disabled(){return!!t.editEntry},required:!0}),null),a(q,I(Mr,{get label(){return e("common.date")},type:"date",get value(){return r().date},onChange:M=>g("date",M),required:!0}),null),a(j,I(Mr,{get label(){return e("common.description")},get value(){return r().description},onChange:M=>g("description",M),get placeholder(){return e("journal.enterEntryDescription","Enter journal entry description")},required:!0}),J),a(j,I(Mr,{get label(){return e("journal.reference")},get value(){return r().reference},onChange:M=>g("reference",M),get placeholder(){return e("journal.enterReferenceNumber","Enter reference number")}}),J),J.style.setProperty("margin-top","2rem"),C.style.setProperty("display","flex"),C.style.setProperty("justify-content","space-between"),C.style.setProperty("align-items","center"),C.style.setProperty("margin-bottom","1rem"),P.style.setProperty("margin","0"),a(P,()=>e("journal.entryLines","Journal Entry Lines")),a(C,I(_t,{type:"button",variant:"secondary",size:"sm",onClick:w,get children(){return e("journal.addLine","Add Line")}}),null),$.style.setProperty("margin-bottom","1rem"),$.style.setProperty("font-size","0.875rem"),$.style.setProperty("color","var(--text-muted)"),D.style.setProperty("display","grid"),D.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1fr"),D.style.setProperty("gap","1rem"),a(S,()=>e("journal.account")),a(z,()=>e("common.description")),a(L,()=>e("journal.debit")),a(ne,()=>e("journal.credit")),a(W,()=>e("common.actions")),a(J,I(Ct,{get each(){return i()},get fallback(){return(()=>{var M=Em();return a(M,()=>e("journal.noLines","No lines")),M})()},children:(M,G)=>{const Q=M;return(()=>{var ie=Em();return p(ie,d),a(ie,I(Hn,{label:"",get value(){return Q.accountId||""},onChange:me=>f(Q.tempId,"accountId",me),get options(){return y()}}),null),a(ie,I(Mr,{label:"",get value(){return Q.description||""},onChange:me=>f(Q.tempId,"description",me),get placeholder(){return e("journal.lineDescription","Line description")}}),null),a(ie,I(Mr,{label:"",type:"number",get value(){return Q.debitAmount?.toString()||"0"},onChange:me=>{f(Q.tempId,"debitAmount",parseFloat(me)||0),parseFloat(me)>0&&f(Q.tempId,"creditAmount",0)},placeholder:"0.00"}),null),a(ie,I(Mr,{label:"",type:"number",get value(){return Q.creditAmount?.toString()||"0"},onChange:me=>{f(Q.tempId,"creditAmount",parseFloat(me)||0),parseFloat(me)>0&&f(Q.tempId,"debitAmount",0)},placeholder:"0.00"}),null),a(ie,I(_t,{type:"button",variant:"outline",size:"sm",onClick:()=>E(Q.tempId),get disabled(){return i().length<=2},get children(){return e("common.remove")}}),null),ie})()}}),se),p(se,u),a(k,()=>e("journal.totalDebit","Total Debit"),N),a(k,()=>Y(K.totalDebit),null),a(V,()=>e("journal.totalCredit","Total Credit"),Z),a(V,()=>Y(K.totalCredit),null),H.style.setProperty("font-weight","600"),a(H,(()=>{var M=Te(()=>!!K.isBalanced);return()=>M()?` ${e("journal.balanced")}`:` ${e("journal.notBalanced","Not Balanced")}`})()),a(j,(()=>{var M=Te(()=>!!s());return()=>M()&&(()=>{var G=Em();return G.style.setProperty("padding","1rem"),G.style.setProperty("border-radius","var(--border-radius-sm)"),G.style.setProperty("margin-top","1rem"),G.style.setProperty("background","#f8d7da"),G.style.setProperty("color","#721c24"),G.style.setProperty("border","1px solid #f5c6cb"),a(G,s),G})()})(),B),p(B,c),a(B,I(_t,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(B,I(_t,{variant:"primary",type:"submit",get disabled(){return!K.isBalanced},get children(){return Te(()=>!!t.editEntry)()?e("journal.updateEntry","Update Entry"):e("journal.saveAsDraft","Save as Draft")}}),null),fe(M=>(M=K.isBalanced?"#4caf50":"#f44336")!=null?H.style.setProperty("color",M):H.style.removeProperty("color")),j}})},GL={"Sale Amount":{en:"Sale Amount",es:"Monto de Venta"},"Payment Amount":{en:"Payment Amount",es:"Monto del Pago"},"Expense Amount":{en:"Expense Amount",es:"Monto del Gasto"},"Rent Amount":{en:"Rent Amount",es:"Monto del Alquiler"},"Salary Amount":{en:"Salary Amount",es:"Monto del Salario"},"Utility Amount":{en:"Utility Amount",es:"Monto de Servicios"},"Inventory Cost":{en:"Inventory Cost",es:"Costo del Inventario"},"Investment Amount":{en:"Investment Amount",es:"Monto de Inversin"},"Depreciation Amount":{en:"Depreciation Amount",es:"Monto de Depreciacin"},"Interest Amount":{en:"Interest Amount",es:"Monto de Inters"},"Principal Amount":{en:"Principal Amount",es:"Monto Principal"},"Total Payment":{en:"Total Payment",es:"Pago Total"},Amount:{en:"Amount",es:"Monto"},Monto:{en:"Amount",es:"Monto"}},WL={"Cash Sale":{en:"Cash Sale",es:"Venta en Efectivo"},"Credit Sale":{en:"Credit Sale",es:"Venta a Crdito"},"Customer Payment Received":{en:"Customer Payment Received",es:"Pago Recibido del Cliente"},"Office Expenses":{en:"Office Expenses",es:"Gastos de Oficina"},"Rent Payment":{en:"Rent Payment",es:"Pago de Alquiler"},"Salary Payment":{en:"Salary Payment",es:"Pago de Salario"},"Utility Payment":{en:"Utility Payment",es:"Pago de Servicios"},"Inventory Purchase":{en:"Inventory Purchase",es:"Compra de Inventario"},"Supplier Payment":{en:"Supplier Payment",es:"Pago a Proveedor"},"Capital Investment":{en:"Capital Investment",es:"Inversin de Capital"},"Depreciation Expense":{en:"Depreciation Expense",es:"Gasto de Depreciacin"},"Loan Payment":{en:"Loan Payment",es:"Pago de Prstamo"}},YL={"Record a cash sale transaction":{en:"Record a cash sale transaction",es:"Registrar una transaccin de venta en efectivo"},"Record a sale on credit (accounts receivable)":{en:"Record a sale on credit (accounts receivable)",es:"Registrar una venta a crdito (cuentas por cobrar)"},"Record payment received from customer":{en:"Record payment received from customer",es:"Registrar pago recibido del cliente"},"Record office supplies and expenses":{en:"Record office supplies and expenses",es:"Registrar suministros y gastos de oficina"},"Record monthly rent payment":{en:"Record monthly rent payment",es:"Registrar pago mensual de alquiler"},"Record employee salary payment":{en:"Record employee salary payment",es:"Registrar pago de salario de empleado"},"Record utility bills payment":{en:"Record utility bills payment",es:"Registrar pago de servicios pblicos"},"Record inventory purchase on credit":{en:"Record inventory purchase on credit",es:"Registrar compra de inventario a crdito"},"Record payment to supplier":{en:"Record payment to supplier",es:"Registrar pago a proveedor"},"Record owner capital investment":{en:"Record owner capital investment",es:"Registrar inversin de capital del propietario"},"Record monthly depreciation of assets":{en:"Record monthly depreciation of assets",es:"Registrar depreciacin mensual de activos"},"Record loan principal and interest payment":{en:"Record loan principal and interest payment",es:"Registrar pago de capital e intereses del prstamo"}},KL={"Cash received from sale":{en:"Cash received from sale",es:"Efectivo recibido de venta"},"Sales revenue":{en:"Sales revenue",es:"Ingresos por ventas"},"Credit sale to customer":{en:"Credit sale to customer",es:"Venta a crdito al cliente"},"Payment received from customer":{en:"Payment received from customer",es:"Pago recibido del cliente"},"Payment applied to receivable":{en:"Payment applied to receivable",es:"Pago aplicado a cuenta por cobrar"},"Office supplies and expenses":{en:"Office supplies and expenses",es:"Suministros y gastos de oficina"},"Payment for office expenses":{en:"Payment for office expenses",es:"Pago por gastos de oficina"},"Monthly rent payment":{en:"Monthly rent payment",es:"Pago mensual de alquiler"},"Rent payment":{en:"Rent payment",es:"Pago de alquiler"},"Employee salary":{en:"Employee salary",es:"Salario de empleado"},"Salary payment":{en:"Salary payment",es:"Pago de salario"},"Utility bills payment":{en:"Utility bills payment",es:"Pago de servicios pblicos"},"Utility payment":{en:"Utility payment",es:"Pago de servicios"},"Inventory purchase":{en:"Inventory purchase",es:"Compra de inventario"},"Amount owed to supplier":{en:"Amount owed to supplier",es:"Monto adeudado al proveedor"},"Payment to supplier":{en:"Payment to supplier",es:"Pago al proveedor"},"Capital investment received":{en:"Capital investment received",es:"Inversin de capital recibida"},"Capital investment":{en:"Capital investment",es:"Inversin de capital"},"Monthly depreciation expense":{en:"Monthly depreciation expense",es:"Gasto mensual de depreciacin"},"Accumulated depreciation":{en:"Accumulated depreciation",es:"Depreciacin acumulada"},"Interest expense":{en:"Interest expense",es:"Gasto por intereses"},"Principal payment":{en:"Principal payment",es:"Pago de capital"},"Total loan payment":{en:"Total loan payment",es:"Pago total del prstamo"}},JL=t=>GL[t]?.["es"]||t,QL=t=>WL[t]?.["es"]||t,XL=t=>YL[t]?.["es"]||t,ZL=t=>KL[t]?.["es"]||t,e7=[{id:"cash_sale",name:"Cash Sale",description:"Record a cash sale transaction",category:"revenue",lines:[{id:"cs1",accountId:"1001",accountName:"Petty Cash",description:"Cash received from sale",type:"debit",isAmountField:!0,amountFieldName:"Sale Amount"},{id:"cs2",accountId:"10",accountName:"Sales Revenue",description:"Sales revenue",type:"credit",isAmountField:!0,amountFieldName:"Sale Amount"}]},{id:"credit_sale",name:"Credit Sale",description:"Record a sale on credit (accounts receivable)",category:"revenue",lines:[{id:"crs1",accountId:"2001",accountName:"Trade Receivables",description:"Credit sale to customer",type:"debit",isAmountField:!0,amountFieldName:"Sale Amount"},{id:"crs2",accountId:"10",accountName:"Sales Revenue",description:"Sales revenue",type:"credit",isAmountField:!0,amountFieldName:"Sale Amount"}]},{id:"customer_payment",name:"Customer Payment Received",description:"Record payment received from customer",category:"assets",lines:[{id:"cp1",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment received from customer",type:"debit",isAmountField:!0,amountFieldName:"Payment Amount"},{id:"cp2",accountId:"2001",accountName:"Trade Receivables",description:"Payment applied to receivable",type:"credit",isAmountField:!0,amountFieldName:"Payment Amount"}]},{id:"office_expenses",name:"Office Expenses",description:"Record office supplies and expenses",category:"expenses",lines:[{id:"oe1",accountId:"5200",accountName:"Office Expenses",description:"Office supplies and expenses",type:"debit",isAmountField:!0,amountFieldName:"Expense Amount"},{id:"oe2",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment for office expenses",type:"credit",isAmountField:!0,amountFieldName:"Expense Amount"}]},{id:"rent_payment",name:"Rent Payment",description:"Record monthly rent payment",category:"expenses",lines:[{id:"rp1",accountId:"5200",accountName:"Rent Expense",description:"Monthly rent payment",type:"debit",isAmountField:!0,amountFieldName:"Rent Amount"},{id:"rp2",accountId:"1002",accountName:"Bank - Checking Account",description:"Rent payment",type:"credit",isAmountField:!0,amountFieldName:"Rent Amount"}]},{id:"salary_payment",name:"Salary Payment",description:"Record employee salary payment",category:"expenses",lines:[{id:"sp1",accountId:"13",accountName:"Salaries Expense",description:"Employee salary",type:"debit",isAmountField:!0,amountFieldName:"Salary Amount"},{id:"sp2",accountId:"1002",accountName:"Bank - Checking Account",description:"Salary payment",type:"credit",isAmountField:!0,amountFieldName:"Salary Amount"}]},{id:"utility_payment",name:"Utility Payment",description:"Record utility bills payment",category:"expenses",lines:[{id:"up1",accountId:"14",accountName:"Operating Expenses",description:"Utility bills payment",type:"debit",isAmountField:!0,amountFieldName:"Utility Amount"},{id:"up2",accountId:"1002",accountName:"Bank - Checking Account",description:"Utility payment",type:"credit",isAmountField:!0,amountFieldName:"Utility Amount"}]},{id:"inventory_purchase",name:"Inventory Purchase",description:"Record inventory purchase on credit",category:"assets",lines:[{id:"ip1",accountId:"3",accountName:"Inventory",description:"Inventory purchase",type:"debit",isAmountField:!0,amountFieldName:"Inventory Cost"},{id:"ip2",accountId:"5",accountName:"Accounts Payable",description:"Amount owed to supplier",type:"credit",isAmountField:!0,amountFieldName:"Inventory Cost"}]},{id:"supplier_payment",name:"Supplier Payment",description:"Record payment to supplier",category:"liabilities",lines:[{id:"spp1",accountId:"5",accountName:"Accounts Payable",description:"Payment to supplier",type:"debit",isAmountField:!0,amountFieldName:"Payment Amount"},{id:"spp2",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment to supplier",type:"credit",isAmountField:!0,amountFieldName:"Payment Amount"}]},{id:"capital_investment",name:"Capital Investment",description:"Record owner capital investment",category:"equity",lines:[{id:"ci1",accountId:"1002",accountName:"Bank - Checking Account",description:"Capital investment received",type:"debit",isAmountField:!0,amountFieldName:"Investment Amount"},{id:"ci2",accountId:"8",accountName:"Owner's Equity",description:"Capital investment",type:"credit",isAmountField:!0,amountFieldName:"Investment Amount"}]},{id:"depreciation",name:"Depreciation Expense",description:"Record monthly depreciation of assets",category:"expenses",lines:[{id:"dep1",accountId:"14",accountName:"Operating Expenses",description:"Monthly depreciation expense",type:"debit",isAmountField:!0,amountFieldName:"Depreciation Amount"},{id:"dep2",accountId:"15",accountName:"Accumulated Depreciation",description:"Accumulated depreciation",type:"credit",isAmountField:!0,amountFieldName:"Depreciation Amount"}]},{id:"loan_payment",name:"Loan Payment",description:"Record loan principal and interest payment",category:"liabilities",lines:[{id:"lp1",accountId:"14",accountName:"Operating Expenses",description:"Interest expense",type:"debit",isAmountField:!0,amountFieldName:"Interest Amount"},{id:"lp2",accountId:"6",accountName:"Loans Payable",description:"Principal payment",type:"debit",isAmountField:!0,amountFieldName:"Principal Amount"},{id:"lp3",accountId:"1002",accountName:"Bank - Checking Account",description:"Total loan payment",type:"credit",isAmountField:!0,amountFieldName:"Total Payment"}]}],f_="journal_custom_templates",t7=()=>{try{const t=localStorage.getItem(f_);if(t)return JSON.parse(t)}catch(t){console.warn("Failed to load custom templates:",t)}return[]},Im=t=>{try{localStorage.setItem(f_,JSON.stringify(t))}catch(e){console.warn("Failed to save custom templates:",e)}},r7=()=>{const t=t7();return[...e7,...t]},[Tm,km]=we(r7()),Fi={get templates(){return Tm()},getTemplatesByCategory(t){return Tm().filter(e=>e.category===t)},getTemplateById(t){return Tm().find(e=>e.id===t)},addTemplate(t){const e={...t,id:`custom_${Date.now()}`};return km(r=>{const n=[...r,e],i=n.filter(o=>o.id.startsWith("custom_"));return Im(i),n}),e},updateTemplate(t,e){km(r=>{const n=r.map(o=>o.id===t?{...o,...e}:o),i=n.filter(o=>o.id.startsWith("custom_"));return Im(i),n})},deleteTemplate(t){if(t.startsWith("custom_"))km(e=>{const r=e.filter(i=>i.id!==t),n=r.filter(i=>i.id.startsWith("custom_"));return Im(n),r});else throw new Error("Cannot delete default templates")},getAllCategories(){return["revenue","expenses","assets","liabilities","equity"]},getCategoryDisplayName(t){const e="es",r={revenue:{en:"Revenue & Sales",es:"Ingresos y Ventas"},expenses:{en:"Expenses & Costs",es:"Gastos y Costos"},assets:{en:"Assets & Receipts",es:"Activos y Recibos"},liabilities:{en:"Liabilities & Payments",es:"Pasivos y Pagos"},equity:{en:"Equity & Capital",es:"Patrimonio y Capital"}};return r[t][e]||r[t].en},getTranslatedFieldName:JL,getTranslatedTemplateName:QL,getTranslatedTemplateDesc:XL,getTranslatedLineDesc:ZL};var cb=ae("<div>"),n7=ae("<div><h4></h4><div><div><strong>: </strong><span>|</span><strong>: </strong></div><div>"),i7=ae("<form><div></div><div>"),o7=ae("<div><div><div></div><div></div><div></div></div><div></div><div><div> ");const s7=t=>{const{t:e}=_r(),[r,n]=we(""),[i,o]=Zd({form:{}}),[s,l]=we(""),[c,d]=we(""),[u,y]=we({}),[g,f]=we({date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),[w,E]=we(null);xi(()=>{t.isOpen&&(n(""),o("form",null),l(null),d(""),f({date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),E(null))}),xi(()=>{});const x={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},T={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-top":"1rem"},Y={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.5rem 0","border-bottom":"1px solid var(--border-color)"},K=z=>{if(n(z),z){const re=Fi.getTemplateById(z);o("form",T1(re)||null),l(re?.lines),re&&!g().description&&f(L=>({...L,description:re.description})),re&&re.lines.forEach((L,O)=>{L.fixedAmount||(o("form","lines",O,"fixedAmount",0),y(ne=>({...ne,[L.id]:0})))})}},j=()=>Fi.getAllCategories().map(z=>({value:z,label:Fi.getCategoryDisplayName(z)})),q=()=>{const z=c();return z?Fi.getTemplatesByCategory(z).map(re=>({value:re.id,label:Fi.getTranslatedTemplateName(re.name)})):[]},J=(z,re)=>{f(L=>({...L,[z]:re}))},C=z=>u()?.[z]||0,P=(z,re)=>{const L=i.form;!L||!L.lines.find(ne=>ne.id===z)||(y(ne=>({...ne,[z]:re})),L.lines.findIndex(ne=>ne.id===z))},$=()=>{const z=i.form;if(!z)return{totalDebit:0,totalCredit:0,isBalanced:!1};let re=0,L=0;return z?.lines?.forEach(O=>{const ne=u()?.[O.id]||O.fixedAmount||0;O.type==="debit"?re+=ne:L+=ne}),{totalDebit:re,totalCredit:L,isBalanced:Math.abs(re-L)<.01}},D=()=>{const z=i.form;if(!z)return[];const re=new Map;return z?.lines?.forEach(L=>{L.isAmountField&&L.amountFieldName&&re.set(L.amountFieldName,L.id)}),Array.from(re.entries()).map(([L,O])=>({fieldName:L,lineId:O}))},b=z=>{z.preventDefault(),E(null);const re=i.form;if(!re){E(e("journal.templateRequired","Please select a template"));return}const L=g(),{totalDebit:O,totalCredit:ne,isBalanced:X}=$();if(!L.description){E(e("forms.descriptionRequired","Description is required"));return}if(!X){E(e("journal.entryNotBalanced","Entry is not balanced. Debit: ${debit}, Credit: ${credit}").replace("${debit}",`$${O.toFixed(2)}`).replace("${credit}",`$${ne.toFixed(2)}`));return}for(const se of re.lines){const F=u()?.[se.id]||0;if(se.isAmountField&&F<=0){E(e("journal.amountRequired","Amount is required for {field}").replace("{field}",se.amountFieldName||"line"));return}}const W={entryNumber:En.getNextEntryNumber(),date:L.date,description:L.description,reference:L.reference,status:"draft",createdBy:L.createdBy,createdAt:new Date().toISOString(),totalDebit:O,totalCredit:ne,lines:re.lines.map((se,F)=>{const k=u()?.[se.id]||0;return{id:`jel_${Date.now()}_${F}`,accountId:se.accountId,accountName:se.accountName,description:se.description,debitAmount:se.type==="debit"?k:0,creditAmount:se.type==="credit"?k:0}})};try{En.addJournalEntry(W),t.onClose()}catch(se){E(se instanceof Error?se.message:e("forms.errorOccurred","An error occurred"))}},S=z=>{const re="es-ES";return new Intl.NumberFormat(re,{style:"currency",currency:"USD"}).format(z)};D();const v=()=>i?.form?.lines||[];return I(si,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.quickEntry","Quick Journal Entry")},get children(){var z=i7(),re=z.firstChild,L=re.nextSibling;return z.addEventListener("submit",b),re.style.setProperty("display","grid"),re.style.setProperty("grid-template-columns","1fr 1fr"),re.style.setProperty("gap","1rem"),re.style.setProperty("margin-bottom","1rem"),a(re,I(Hn,{get label(){return e("journal.selectCategory","Select Category")},get value(){return c()},onChange:O=>{d(O),K("")},get options(){return[{value:"",label:e("journal.chooseCategory","Choose a category...")},...j()]},required:!0}),null),a(re,I(Hn,{get label(){return e("journal.selectTemplate","Select Template")},get value(){return r()},onChange:K,get options(){return[{value:"",label:e("journal.chooseTemplate","Choose a template...")},...q()]},get disabled(){return!c()},required:!0}),null),a(z,I(Oe,{get when(){return i.form},get children(){return[(()=>{var O=cb();return O.style.setProperty("display","grid"),O.style.setProperty("grid-template-columns","1fr 1fr"),O.style.setProperty("gap","1rem"),a(O,I(Mr,{get label(){return e("common.date")},type:"date",get value(){return g().date},onChange:ne=>J("date",ne),required:!0}),null),a(O,I(Mr,{get label(){return e("journal.reference")},get value(){return g().reference},onChange:ne=>J("reference",ne),get placeholder(){return e("journal.enterReferenceNumber","Enter reference number")}}),null),O})(),I(Mr,{get label(){return e("common.description")},get value(){return g().description},onChange:O=>J("description",O),get placeholder(){return i?.form?.description||e("journal.enterEntryDescription","Enter journal entry description")},required:!0}),(()=>{var O=n7(),ne=O.firstChild,X=ne.nextSibling,W=X.firstChild,se=W.firstChild,F=se.firstChild,k=se.nextSibling,N=k.nextSibling,A=N.firstChild,V=W.nextSibling;return p(O,T),ne.style.setProperty("margin","0 0 1rem 0"),ne.style.setProperty("color","var(--text-primary)"),a(ne,()=>e("journal.entryPreview","Entry Preview")),a(O,I(Ct,{get each(){return v()},children:Z=>(()=>{var H=o7(),B=H.firstChild,M=B.firstChild,G=M.nextSibling,Q=G.nextSibling,ie=B.nextSibling,me=ie.nextSibling,oe=me.firstChild,ee=oe.firstChild;return M.style.setProperty("font-weight","500"),a(M,()=>Z.accountName),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-muted)"),a(G,()=>Fi.getTranslatedLineDesc(Z.description)),Q.style.setProperty("font-size","0.75rem"),Q.style.setProperty("margin-top","0.25rem"),Q.style.setProperty("font-weight","500"),a(Q,(()=>{var de=Te(()=>Z.type==="debit");return()=>de()?e("journal.debit"):e("journal.credit")})()),a(ie,I(Mr,{label:"",type:"number",get value(){return C(Z.id).toString()},onChange:de=>P(Z.id,parseFloat(de)||0),placeholder:"0.00",step:"0.01",min:"0",style:{"font-size":"0.875rem"}})),me.style.setProperty("text-align","right"),oe.style.setProperty("font-weight","600"),a(oe,()=>Z.type==="debit"?"DR":"CR",ee),a(oe,()=>S(C(Z.id)),null),fe(de=>{var he={...Y,display:"grid","grid-template-columns":"2fr 1fr 1fr",gap:"1rem","align-items":"center"},le=Z.type==="debit"?"#d32f2f":"#2e7d32",ye=Z.type==="debit"?"#d32f2f":"#2e7d32";return de.e=p(H,he,de.e),le!==de.t&&((de.t=le)!=null?Q.style.setProperty("color",le):Q.style.removeProperty("color")),ye!==de.a&&((de.a=ye)!=null?oe.style.setProperty("color",ye):oe.style.removeProperty("color")),de},{e:void 0,t:void 0,a:void 0}),H})()}),X),X.style.setProperty("margin-top","1rem"),X.style.setProperty("padding-top","1rem"),X.style.setProperty("border-top","2px solid var(--border-color)"),X.style.setProperty("display","flex"),X.style.setProperty("justify-content","space-between"),X.style.setProperty("align-items","center"),a(se,()=>e("journal.totalDebit"),F),a(se,()=>S($().totalDebit),null),k.style.setProperty("margin","0 1rem"),k.style.setProperty("color","var(--text-muted)"),a(N,()=>e("journal.totalCredit"),A),a(N,()=>S($().totalCredit),null),V.style.setProperty("font-weight","600"),a(V,(()=>{var Z=Te(()=>!!$().isBalanced);return()=>Z()?` ${e("journal.balanced","Balanced")}`:` ${e("journal.notBalanced","Not Balanced")}`})()),fe(Z=>(Z=$().isBalanced?"#4caf50":"#f44336")!=null?V.style.setProperty("color",Z):V.style.removeProperty("color")),O})()]}}),L),a(z,(()=>{var O=Te(()=>!!w());return()=>O()&&(()=>{var ne=cb();return ne.style.setProperty("padding","1rem"),ne.style.setProperty("border-radius","var(--border-radius-sm)"),ne.style.setProperty("margin-top","1rem"),ne.style.setProperty("background","#f8d7da"),ne.style.setProperty("color","#721c24"),ne.style.setProperty("border","1px solid #f5c6cb"),a(ne,w),ne})()})(),L),p(L,x),a(L,I(_t,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(L,I(_t,{variant:"primary",type:"submit",get disabled(){return!i.form||!$().isBalanced},get children(){return e("journal.createQuickEntry","Create Quick Entry")}}),null),z}})};var a7=ae("<div><h3></h3><div>"),l7=ae("<div><div></div><div><div><h4></h4></div><div><div><div></div><div></div><div></div><div></div><div></div><div>"),c7=ae("<div><p></p><p>"),db=ae("<div><div></div><div>"),d7=ae("<h4>"),u7=ae("<span>"),Nm=ae("<div>");const h7=t=>{const{t:e}=_r(),[r,n]=we(""),[i,o]=we(!1),[s,l]=we(!1),[c,d]=we({name:"",description:"",category:"expenses"}),[u,y]=we([{accountId:"",accountName:"",description:"",type:"debit",isAmountField:!0,amountFieldName:e("common.amount","Amount")},{accountId:"",accountName:"",description:"",type:"credit",isAmountField:!0,amountFieldName:e("common.amount","Amount")}]),[g,f]=we(null);xi(()=>{t.isOpen&&(n(""),o(!1),l(!1),f(null),q())});const w={display:"flex",gap:"1.5rem",height:"500px"},E={width:"300px","border-right":"1px solid var(--border-color)","padding-right":"1.5rem","overflow-y":"auto"},x={flex:"1","overflow-y":"auto"},T={padding:"0.75rem","margin-bottom":"0.5rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",transition:"all 0.2s"},Y={display:"grid","grid-template-columns":"2fr 2fr 1fr 1fr 1fr 80px",gap:"0.5rem","align-items":"end","margin-bottom":"0.75rem",padding:"0.75rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)"},K=()=>qr.accounts.map(O=>({value:O.id,label:`${O.accountNumber} - ${O.name}`})),j=()=>Fi.getAllCategories().map(O=>({value:O,label:Fi.getCategoryDisplayName(O)})),q=()=>{d({name:"",description:"",category:"expenses"}),y([{accountId:"",accountName:"",description:"",type:"debit",isAmountField:!0,amountFieldName:e("common.amount","Amount")},{accountId:"",accountName:"",description:"",type:"credit",isAmountField:!0,amountFieldName:e("common.amount","Amount")}])},J=O=>{const ne=Fi.getTemplateById(O);ne&&(d({name:ne.name,description:ne.description,category:ne.category}),y(ne.lines.map(X=>({accountId:X.accountId,accountName:X.accountName,description:X.description,type:X.type,isAmountField:X.isAmountField,amountFieldName:X.amountFieldName,fixedAmount:X.fixedAmount}))))},C=O=>{n(O),o(!1),l(!1),J(O)},P=()=>{n(""),o(!1),l(!0),q()},$=()=>{r()&&r().startsWith("custom_")&&o(!0)},D=()=>{const O=r();if(O&&O.startsWith("custom_")&&confirm(e("journal.confirmDeleteTemplate","Are you sure you want to delete this template?")))try{Fi.deleteTemplate(O),n(""),q()}catch(ne){f(ne instanceof Error?ne.message:e("journal.errorDeletingTemplate","Error deleting template"))}},b=(O,ne)=>{d(X=>({...X,[O]:ne}))},S=(O,ne,X)=>{y(W=>W.map((se,F)=>{if(F===O){const k={...se,[ne]:X};if(ne==="accountId"&&typeof X=="string"){const N=qr.getAccountById(X);N&&(k.accountName=N.name)}return k}return se}))},v=()=>{y(O=>[...O,{accountId:"",accountName:"",description:"",type:O.length%2===0?"debit":"credit",isAmountField:!0,amountFieldName:e("common.amount","Amount")}])},z=O=>{u().length>2&&y(ne=>ne.filter((X,W)=>W!==O))},re=()=>{f(null);const O=c(),ne=u();if(!O.name.trim()){f(e("journal.templateNameRequired","Template name is required"));return}if(!O.description.trim()){f(e("journal.templateDescriptionRequired","Template description is required"));return}if(ne.length<2){f(e("journal.minTwoLinesRequired","At least 2 lines are required"));return}for(let W=0;W<ne.length;W++){const se=ne[W];if(!se.accountId){f(e("journal.lineAccountRequired","Line {lineNumber}: Account is required").replace("{lineNumber}",(W+1).toString()));return}if(!se.description){f(e("journal.lineDescriptionRequired","Line {lineNumber}: Description is required").replace("{lineNumber}",(W+1).toString()));return}if(se.isAmountField&&!se.amountFieldName){f(e("journal.amountFieldNameRequired","Line {lineNumber}: Amount field name is required").replace("{lineNumber}",(W+1).toString()));return}}const X={name:O.name,description:O.description,category:O.category,lines:ne.map((W,se)=>({id:`line_${Date.now()}_${se}`,...W}))};try{if(i()&&r())Fi.updateTemplate(r(),X);else{const W=Fi.addTemplate(X);n(W.id)}o(!1),l(!1)}catch(W){f(W instanceof Error?W.message:e("journal.errorSavingTemplate","Error saving template"))}},L=()=>{const O=Fi.templates,ne={};return O.forEach(X=>{ne[X.category]||(ne[X.category]=[]),ne[X.category].push(X)}),ne};return I(si,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.manageTemplates","Manage Journal Templates")},size:"large",get children(){var O=db(),ne=O.firstChild,X=ne.nextSibling;return p(O,w),p(ne,E),a(ne,I(_t,{variant:"primary",onClick:P,style:{width:"100%","margin-bottom":"1rem"},get children(){return["+ ",Te(()=>e("journal.addNewTemplate","Add New Template"))]}}),null),a(ne,I(Ct,{get each(){return Object.entries(L())},children:([W,se])=>[(()=>{var F=d7();return F.style.setProperty("margin","1rem 0 0.5rem 0"),F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),F.style.setProperty("text-transform","uppercase"),a(F,()=>Fi.getCategoryDisplayName(W)),F})(),I(Ct,{each:se,children:F=>(()=>{var k=db(),N=k.firstChild,A=N.nextSibling;return k.$$click=()=>C(F.id),N.style.setProperty("font-weight","500"),a(N,()=>Fi.getTranslatedTemplateName(F.name)),A.style.setProperty("font-size","0.75rem"),A.style.setProperty("opacity","0.8"),A.style.setProperty("margin-top","0.25rem"),a(A,()=>Fi.getTranslatedTemplateDesc(F.description)),a(k,(()=>{var V=Te(()=>!!F.id.startsWith("custom_"));return()=>V()&&(()=>{var Z=u7();return Z.style.setProperty("font-size","0.625rem"),Z.style.setProperty("background","rgba(255,255,255,0.2)"),Z.style.setProperty("padding","0.125rem 0.5rem"),Z.style.setProperty("border-radius","10px"),Z.style.setProperty("margin-top","0.25rem"),Z.style.setProperty("display","inline-block"),a(Z,()=>e("journal.custom","Custom")),Z})()})(),null),fe(V=>p(k,{...T,background:r()===F.id?"var(--primary-color)":"var(--surface-color)",color:r()===F.id?"white":"inherit"},V)),k})()})]}),null),p(X,x),a(X,I(Oe,{get when(){return r()||s()},get children(){return[(()=>{var W=a7(),se=W.firstChild,F=se.nextSibling;return W.style.setProperty("display","flex"),W.style.setProperty("justify-content","space-between"),W.style.setProperty("align-items","center"),W.style.setProperty("margin-bottom","1rem"),se.style.setProperty("margin","0"),a(se,(()=>{var k=Te(()=>!!s());return()=>k()?e("journal.newTemplate","New Template"):Te(()=>!!i())()?e("journal.editTemplate","Edit Template"):e("journal.templateDetails","Template Details")})()),F.style.setProperty("display","flex"),F.style.setProperty("gap","0.5rem"),a(F,I(Oe,{get when(){return Te(()=>!!(r()&&r().startsWith("custom_")))()&&!i()},get children(){return[I(_t,{variant:"outline",size:"sm",onClick:$,get children(){return e("common.edit")}}),I(_t,{variant:"outline",size:"sm",onClick:D,style:{color:"var(--danger-color)"},get children(){return e("common.delete")}})]}}),null),a(F,I(Oe,{get when(){return i()||s()},get children(){return[I(_t,{variant:"secondary",size:"sm",onClick:()=>{o(!1),l(!1),r()&&J(r())},get children(){return e("common.cancel")}}),I(_t,{variant:"primary",size:"sm",onClick:re,get children(){return e("common.save")}})]}}),null),W})(),(()=>{var W=l7(),se=W.firstChild,F=se.nextSibling,k=F.firstChild,N=k.firstChild,A=k.nextSibling,V=A.firstChild,Z=V.firstChild,H=Z.nextSibling,B=H.nextSibling,M=B.nextSibling,G=M.nextSibling,Q=G.nextSibling;return W.style.setProperty("background","var(--background-color)"),W.style.setProperty("padding","1rem"),W.style.setProperty("border-radius","var(--border-radius-sm)"),se.style.setProperty("display","grid"),se.style.setProperty("grid-template-columns","2fr 1fr"),se.style.setProperty("gap","1rem"),se.style.setProperty("margin-bottom","1rem"),a(se,I(Mr,{get label(){return e("journal.templateName","Template Name")},get value(){return c().name},onChange:ie=>b("name",ie),get disabled(){return Te(()=>!i())()&&!s()},get placeholder(){return e("journal.enterTemplateName","Enter template name")}}),null),a(se,I(Hn,{get label(){return e("journal.category","Category")},get value(){return c().category},onChange:ie=>b("category",ie),get options(){return j()},get disabled(){return Te(()=>!i())()&&!s()}}),null),a(W,I(Mr,{get label(){return e("common.description")},get value(){return c().description},onChange:ie=>b("description",ie),get disabled(){return Te(()=>!i())()&&!s()},get placeholder(){return e("journal.enterTemplateDescription","Enter template description")}}),F),F.style.setProperty("margin-top","2rem"),k.style.setProperty("display","flex"),k.style.setProperty("justify-content","space-between"),k.style.setProperty("align-items","center"),k.style.setProperty("margin-bottom","1rem"),N.style.setProperty("margin","0"),a(N,()=>e("journal.templateLines","Template Lines")),a(k,I(Oe,{get when(){return i()||s()},get children(){return I(_t,{variant:"secondary",size:"sm",onClick:v,get children(){return["+ ",Te(()=>e("journal.addLine"))]}})}}),null),A.style.setProperty("margin-bottom","0.5rem"),A.style.setProperty("font-size","0.75rem"),A.style.setProperty("color","var(--text-muted)"),V.style.setProperty("display","grid"),V.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1fr 80px"),V.style.setProperty("gap","0.5rem"),a(Z,()=>e("journal.account")),a(H,()=>e("common.description")),a(B,()=>e("journal.type","Type")),a(M,()=>e("journal.amountType","Amount Type")),a(G,()=>e("journal.fieldName","Field Name")),a(Q,()=>e("common.actions")),a(F,I(Ct,{get each(){return u()},get fallback(){return(()=>{var ie=Nm();return a(ie,()=>e("journal.noTemplateLines","No template lines")),ie})()},children:(ie,me)=>{const oe=ie,ee=me();return(()=>{var de=Nm();return p(de,Y),a(de,I(Hn,{label:"",get value(){return oe.accountId||""},onChange:he=>S(ee,"accountId",he),get options(){return[{value:"",label:e("journal.selectAccount","Select account...")},...K()]},get disabled(){return Te(()=>!i())()&&!s()}}),null),a(de,I(Mr,{label:"",get value(){return oe.description||""},onChange:he=>S(ee,"description",he),get placeholder(){return e("journal.lineDescription")},get disabled(){return Te(()=>!i())()&&!s()}}),null),a(de,I(Hn,{label:"",get value(){return oe.type},onChange:he=>S(ee,"type",he),get options(){return[{value:"debit",label:e("journal.debit")},{value:"credit",label:e("journal.credit")}]},get disabled(){return Te(()=>!i())()&&!s()}}),null),a(de,I(Hn,{label:"",get value(){return oe.isAmountField?"variable":"fixed"},onChange:he=>{S(ee,"isAmountField",he==="variable"),he==="fixed"&&S(ee,"fixedAmount",0)},get options(){return[{value:"variable",label:e("journal.variable","Variable")},{value:"fixed",label:e("journal.fixed","Fixed")}]},get disabled(){return Te(()=>!i())()&&!s()}}),null),a(de,I(Oe,{get when(){return oe.isAmountField},get fallback(){return I(Mr,{label:"",type:"number",get value(){return oe.fixedAmount?.toString()||"0"},onChange:he=>S(ee,"fixedAmount",parseFloat(he)||0),placeholder:"0.00",get disabled(){return Te(()=>!i())()&&!s()}})},get children(){return I(Mr,{label:"",get value(){return oe.amountFieldName||""},onChange:he=>S(ee,"amountFieldName",he),get placeholder(){return e("journal.fieldNamePlaceholder","e.g., Monto")},get disabled(){return Te(()=>!i())()&&!s()}})}}),null),a(de,I(Oe,{get when(){return i()||s()},get children(){return I(_t,{variant:"outline",size:"sm",onClick:()=>z(ee),get disabled(){return u().length<=2},style:{color:"var(--danger-color)"},get children(){return e("common.remove")}})}}),null),de})()}}),null),W})(),Te(()=>Te(()=>!!g())()&&(()=>{var W=Nm();return W.style.setProperty("padding","1rem"),W.style.setProperty("border-radius","var(--border-radius-sm)"),W.style.setProperty("margin-top","1rem"),W.style.setProperty("background","#f8d7da"),W.style.setProperty("color","#721c24"),W.style.setProperty("border","1px solid #f5c6cb"),a(W,g),W})())]}}),null),a(X,I(Oe,{get when(){return Te(()=>!r())()&&!s()},get children(){var W=c7(),se=W.firstChild,F=se.nextSibling;return W.style.setProperty("text-align","center"),W.style.setProperty("padding","3rem"),W.style.setProperty("color","var(--text-muted)"),a(se,()=>e("journal.selectTemplateToView","Select a template from the list to view details")),a(F,()=>e("journal.orCreateNew","or create a new custom template")),W}}),null),O}})};br(["click"]);var p7=ae("<div><div></div><div></div><div></div><div>"),m7=ae("<div><div></div><div></div><div></div><div></div><div>"),f7=ae("<div><button></button><button> (<!>)</button><button> (<!>/<!>)"),Lm=ae("<div>"),y7=ae("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><div><h4></h4><div></div></div><div>"),Rm=ae("<div><span></span><span>"),th=ae("<div><strong>:</strong> "),g7=ae("<div><div><div></div><div></div><div></div><div></div><div></div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div></div></div><div><div><strong> </strong></div><div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div></div><div><div><strong>:</strong> </div><div><strong>:</strong> "),v7=ae("<div><div><div></div><div></div></div><div></div><div></div><div></div><div>"),b7=ae("<div><span> "),_7=ae("<span>(<!>)"),P7=ae("<div><div>:"),S7=ae("<div><div> <!>:</div><div>"),w7=ae("<div><div><div><span></span><h3></h3></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),x7=ae("<div><h4> <!> (<!>)"),C7=ae("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div> "),A7=ae("<div> "),$7=ae("<div><h4> <!> (<!>)"),E7=ae("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div> "),I7=ae("<div><div> </div><div> ");const T7=t=>{const{t:e}=_r(),[r,n]=we("details"),[i,o]=we(!1),s=Ut(()=>t.entryId?En.getJournalEntryById(t.entryId):null),l={"text-align":"center","margin-bottom":"2rem",position:"relative"},c={position:"absolute",top:"0",right:"0",display:"flex",gap:"0.5rem"},d={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","margin-bottom":"0.5rem"},u={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},y={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},g={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem",display:"inline-block"},f={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},w={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},E={"font-weight":"600",color:"var(--text-primary)"},x={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},T=v=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:v?"var(--primary-color)":"var(--text-muted)","border-bottom":v?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),Y={display:"grid","grid-template-columns":"2fr 2.5fr 1fr 1fr 1.5fr",gap:"1rem",padding:"1rem 0","border-bottom":"1px solid var(--border-color)","align-items":"center"},K={...Y,"font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","border-bottom":"2px solid var(--border-color)"},j={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},q={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},J=v=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[v],C=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(v),P=v=>new Date(v).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),$=v=>new Date(v).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),D=()=>{s()?.status==="posted"&&!confirm(e("journal.confirmEditPosted","This entry has been posted. Editing will create a new draft copy. Continue?"))||o(!0)},b=()=>{if(s()&&confirm(e("journal.confirmPost","Are you sure you want to post this journal entry? This action cannot be undone.")))try{En.postJournalEntry(s().id)}catch(v){alert(v instanceof Error?v.message:e("forms.errorPostingEntry","An error occurred while posting the entry"))}},S=()=>{s()&&confirm(e("journal.confirmVoid","Are you sure you want to void this journal entry?"))&&En.voidJournalEntry(s().id)};return[I(si,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.entryDetails","Journal Entry Details")},get children(){return Te(()=>!s())()?(()=>{var v=p7(),z=v.firstChild,re=z.nextSibling,L=re.nextSibling,O=L.nextSibling;return v.style.setProperty("text-align","center"),v.style.setProperty("padding","3rem"),v.style.setProperty("color","var(--text-muted)"),z.style.setProperty("font-size","1.5rem"),z.style.setProperty("margin-bottom","1rem"),re.style.setProperty("font-size","1.1rem"),re.style.setProperty("margin-bottom","0.5rem"),a(re,()=>e("journal.entryNotFound","Entry Not Found")),L.style.setProperty("font-size","0.875rem"),a(L,()=>e("journal.entryNotFoundMessage","The journal entry you're looking for could not be found or may have been deleted.")),O.style.setProperty("margin-top","2rem"),a(O,I(_t,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),v})():(()=>{const v=s(),z=J(v.status),re=Math.abs(v.totalDebit-v.totalCredit)<.01;return[(()=>{var L=m7(),O=L.firstChild,ne=O.nextSibling,X=ne.nextSibling,W=X.nextSibling,se=W.nextSibling;return p(L,l),a(O,I(_t,{variant:"outline",size:"sm",onClick:D,get title(){return e("journal.editEntryTooltip","Edit this journal entry")},get children(){return e("common.edit")}}),null),a(O,(()=>{var F=Te(()=>v.status==="draft");return()=>F()&&I(_t,{variant:"primary",size:"sm",onClick:b,disabled:!re,get title(){return re?e("journal.postEntryTooltip","Post this journal entry"):e("journal.entryMustBeBalanced","Entry must be balanced to post")},get children(){return e("journal.post","Post")}})})(),null),a(O,(()=>{var F=Te(()=>v.status==="posted");return()=>F()&&I(_t,{variant:"outline",size:"sm",onClick:S,style:{color:"#dc3545","border-color":"#dc3545"},get title(){return e("journal.voidEntryTooltip","Void this journal entry")},get children(){return e("entryBooks.void","Void")}})})(),null),p(ne,d),a(ne,()=>v.entryNumber),p(X,u),a(X,()=>v.description),p(W,y),a(W,()=>C(v.totalDebit)),a(se,()=>e(`journal.${v.status}`,v.status)),fe(F=>{var k=c,N={...g,background:z.bg,color:z.color};return F.e=p(O,k,F.e),F.t=p(se,N,F.t),F},{e:void 0,t:void 0}),L})(),(()=>{var L=f7(),O=L.firstChild,ne=O.nextSibling,X=ne.firstChild,W=X.nextSibling;W.nextSibling;var se=ne.nextSibling,F=se.firstChild,k=F.nextSibling,N=k.nextSibling,A=N.nextSibling;return A.nextSibling,p(L,x),O.$$click=()=>n("details"),a(O,()=>e("common.details")),ne.$$click=()=>n("lines"),a(ne,()=>e("journal.journalLines","Journal Lines"),X),a(ne,()=>v.lines.length,W),se.$$click=()=>n("reconciliation"),a(se,()=>e("banking.reconciliation","Reconciliation"),F),a(se,()=>v.lines.filter(V=>V.reconciled).length,k),a(se,()=>v.lines.length,A),fe(V=>{var Z=T(r()==="details"),H=T(r()==="lines"),B=T(r()==="reconciliation");return V.e=p(O,Z,V.e),V.t=p(ne,H,V.t),V.a=p(se,B,V.a),V},{e:void 0,t:void 0,a:void 0}),L})(),Te(()=>Te(()=>r()==="details")()&&(()=>{var L=y7(),O=L.firstChild,ne=O.firstChild,X=ne.nextSibling,W=O.nextSibling,se=W.firstChild,F=se.nextSibling,k=W.nextSibling,N=k.firstChild,A=N.nextSibling,V=k.nextSibling,Z=V.firstChild,H=Z.nextSibling,B=V.nextSibling,M=B.firstChild,G=M.nextSibling,Q=B.nextSibling,ie=Q.firstChild,me=ie.nextSibling,oe=Q.nextSibling,ee=oe.firstChild,de=ee.nextSibling,he=oe.nextSibling,le=he.firstChild,ye=le.firstChild,ve=ye.nextSibling,pe=le.nextSibling;return a(ne,()=>e("common.date")),a(X,()=>P(v.date)),a(se,()=>e("journal.reference")),a(F,()=>v.reference||e("common.notAvailable","N/A")),a(N,()=>e("journal.totalDebit")),a(A,()=>C(v.totalDebit)),a(Z,()=>e("journal.totalCredit")),a(H,()=>C(v.totalCredit)),a(M,()=>e("journal.balanceStatus","Balance Status")),a(G,()=>re?`${e("journal.balanced")} `:`${e("journal.unbalanced","Unbalanced")} (${C(Math.abs(v.totalDebit-v.totalCredit))} ${e("journal.difference","difference")})`),a(ie,()=>e("journal.createdBy")),a(me,()=>v.createdBy),a(ee,()=>e("journal.createdAt","Created At")),a(de,()=>$(v.createdAt)),a(L,(()=>{var ge=Te(()=>!!v.postedAt);return()=>ge()&&(()=>{var ke=Rm(),Ne=ke.firstChild,xe=Ne.nextSibling;return a(Ne,()=>e("journal.postedAt","Posted At")),a(xe,()=>$(v.postedAt)),fe($e=>{var Ee=f,Me=w,Ye=E;return $e.e=p(ke,Ee,$e.e),$e.t=p(Ne,Me,$e.t),$e.a=p(xe,Ye,$e.a),$e},{e:void 0,t:void 0,a:void 0}),ke})()})(),he),he.style.setProperty("margin-top","2rem"),he.style.setProperty("padding-top","1rem"),he.style.setProperty("border-top","2px solid var(--border-color)"),le.style.setProperty("display","flex"),le.style.setProperty("justify-content","space-between"),le.style.setProperty("align-items","center"),le.style.setProperty("margin-bottom","1rem"),ye.style.setProperty("margin","0"),ye.style.setProperty("font-size","1rem"),a(ye,()=>e("journal.quickActions","Quick Actions")),ve.style.setProperty("display","flex"),ve.style.setProperty("gap","0.5rem"),a(ve,I(_t,{variant:"primary",size:"sm",onClick:D,get children(){return[" ",Te(()=>e("journal.editEntry"))]}}),null),a(ve,(()=>{var ge=Te(()=>v.status==="draft");return()=>ge()&&I(_t,{variant:"outline",size:"sm",onClick:b,disabled:!re,style:{"border-color":re?"#4caf50":"#f44336",color:re?"#4caf50":"#f44336"},get children(){return re?` ${e("journal.postEntry","Post Entry")}`:` ${e("journal.fixBalance","Fix Balance")}`}})})(),null),a(ve,(()=>{var ge=Te(()=>v.status==="posted");return()=>ge()&&I(_t,{variant:"outline",size:"sm",onClick:S,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return[" ",Te(()=>e("journal.voidEntry","Void Entry"))]}})})(),null),pe.style.setProperty("padding","1rem"),pe.style.setProperty("border-radius","var(--border-radius-sm)"),pe.style.setProperty("font-size","0.875rem"),a(pe,(()=>{var ge=Te(()=>v.status==="draft");return()=>ge()&&(()=>{var ke=th(),Ne=ke.firstChild,xe=Ne.firstChild;return Ne.nextSibling,a(Ne,()=>e("journal.draftEntry","Draft Entry"),xe),a(ke,()=>e("journal.draftEntryDescription","This entry can be edited and posted."),null),a(ke,()=>!re&&`  ${e("journal.entryMustBeBalancedBeforePosting","Entry must be balanced before posting.")}`,null),ke})()})(),null),a(pe,(()=>{var ge=Te(()=>v.status==="posted");return()=>ge()&&(()=>{var ke=th(),Ne=ke.firstChild,xe=Ne.firstChild;return Ne.nextSibling,a(Ne,()=>e("journal.postedEntry","Posted Entry"),xe),a(ke,()=>e("journal.postedEntryDescription","This entry has been posted to the general ledger. Editing will create a new draft copy."),null),ke})()})(),null),a(pe,(()=>{var ge=Te(()=>v.status==="void");return()=>ge()&&(()=>{var ke=th(),Ne=ke.firstChild,xe=Ne.firstChild;return Ne.nextSibling,a(Ne,()=>e("journal.voidEntry"),xe),a(ke,()=>e("journal.voidEntryDescription","This entry has been voided and cannot be modified."),null),ke})()})(),null),fe(ge=>{var ke=f,Ne=w,xe=E,$e=f,Ee=w,Me=E,Ye=f,ze=w,je=E,Xe=f,ht=w,ut=E,Ue=f,it=w,dt={...E,color:re?"#4caf50":"#f44336"},Fe=f,Be=w,Re=E,lt=f,ot=w,nt=E,Ve=v.status==="draft"?"#fff3cd":v.status==="posted"?"#d4edda":"#f8d7da";return ge.e=p(O,ke,ge.e),ge.t=p(ne,Ne,ge.t),ge.a=p(X,xe,ge.a),ge.o=p(W,$e,ge.o),ge.i=p(se,Ee,ge.i),ge.n=p(F,Me,ge.n),ge.s=p(k,Ye,ge.s),ge.h=p(N,ze,ge.h),ge.r=p(A,je,ge.r),ge.d=p(V,Xe,ge.d),ge.l=p(Z,ht,ge.l),ge.u=p(H,ut,ge.u),ge.c=p(B,Ue,ge.c),ge.w=p(M,it,ge.w),ge.m=p(G,dt,ge.m),ge.f=p(Q,Fe,ge.f),ge.y=p(ie,Be,ge.y),ge.g=p(me,Re,ge.g),ge.p=p(oe,lt,ge.p),ge.b=p(ee,ot,ge.b),ge.T=p(de,nt,ge.T),Ve!==ge.A&&((ge.A=Ve)!=null?pe.style.setProperty("background",Ve):pe.style.removeProperty("background")),ge},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),L})()),Te(()=>Te(()=>r()==="lines")()&&(()=>{var L=g7(),O=L.firstChild,ne=O.firstChild,X=ne.nextSibling,W=X.nextSibling,se=W.nextSibling,F=se.nextSibling,k=O.nextSibling,N=k.firstChild,A=N.firstChild,V=A.firstChild;A.nextSibling;var Z=N.nextSibling,H=Z.firstChild,B=H.firstChild;H.nextSibling;var M=Z.nextSibling,G=k.nextSibling,Q=G.firstChild,ie=Q.firstChild;ie.firstChild;var me=Q.nextSibling,oe=me.firstChild,ee=oe.firstChild,de=ee.firstChild,he=de.firstChild;de.nextSibling;var le=ee.nextSibling,ye=le.firstChild,ve=ye.firstChild;ye.nextSibling;var pe=le.nextSibling,ge=pe.firstChild,ke=ge.firstChild;ge.nextSibling;var Ne=oe.nextSibling,xe=Ne.firstChild,$e=xe.firstChild,Ee=$e.firstChild;$e.nextSibling;var Me=xe.nextSibling,Ye=Me.firstChild,ze=Ye.firstChild;return Ye.nextSibling,a(ne,()=>e("journal.account")),a(X,()=>e("common.description")),a(W,()=>e("journal.debit")),a(se,()=>e("journal.credit")),a(F,()=>e("banking.reconciliation")),a(L,I(Ct,{get each(){return v.lines},children:je=>(()=>{var Xe=v7(),ht=Xe.firstChild,ut=ht.firstChild,Ue=ut.nextSibling,it=ht.nextSibling,dt=it.nextSibling,Fe=dt.nextSibling,Be=Fe.nextSibling;return ut.style.setProperty("font-weight","500"),a(ut,()=>je.accountName),Ue.style.setProperty("font-size","0.75rem"),Ue.style.setProperty("color","var(--text-muted)"),a(Ue,()=>qr.getAccountById(je.accountId)?.accountNumber||je.accountId),it.style.setProperty("font-size","0.875rem"),a(it,()=>je.description||"-"),dt.style.setProperty("font-weight","600"),a(dt,(()=>{var Re=Te(()=>je.debitAmount>0);return()=>Re()?C(je.debitAmount):"-"})()),Fe.style.setProperty("font-weight","600"),a(Fe,(()=>{var Re=Te(()=>je.creditAmount>0);return()=>Re()?C(je.creditAmount):"-"})()),a(Be,(()=>{var Re=Te(()=>!!je.reconciled);return()=>Re()?(()=>{var lt=b7(),ot=lt.firstChild;return ot.firstChild,lt.style.setProperty("display","flex"),lt.style.setProperty("align-items","center"),lt.style.setProperty("gap","0.5rem"),lt.style.setProperty("color","#4caf50"),lt.style.setProperty("font-size","0.875rem"),ot.style.setProperty("font-weight","600"),a(ot,()=>e("banking.reconciled"),null),a(lt,(()=>{var nt=Te(()=>!!je.reconciledWith);return()=>nt()&&(()=>{var Ve=_7(),qt=Ve.firstChild,Mt=qt.nextSibling;return Mt.nextSibling,Ve.style.setProperty("font-size","0.75rem"),Ve.style.setProperty("color","var(--text-muted)"),Ve.style.setProperty("font-style","italic"),a(Ve,()=>je.reconciledWith,Mt),Ve})()})(),null),lt})():(()=>{var lt=Lm();return lt.style.setProperty("color","var(--text-muted)"),lt.style.setProperty("font-size","0.875rem"),a(lt,()=>e("banking.notReconciled","Not Reconciled")),lt})()})()),fe(Re=>{var lt=Y,ot=je.debitAmount>0?"#4caf50":"var(--text-muted)",nt=je.creditAmount>0?"#f44336":"var(--text-muted)";return Re.e=p(Xe,lt,Re.e),ot!==Re.t&&((Re.t=ot)!=null?dt.style.setProperty("color",ot):dt.style.removeProperty("color")),nt!==Re.a&&((Re.a=nt)!=null?Fe.style.setProperty("color",nt):Fe.style.removeProperty("color")),Re},{e:void 0,t:void 0,a:void 0}),Xe})()}),k),p(k,j),a(A,()=>e("journal.totalDebit"),V),a(N,()=>C(v.totalDebit),null),a(H,()=>e("journal.totalCredit"),B),a(Z,()=>C(v.totalCredit),null),(re?"#4caf50":"#f44336")!=null?M.style.setProperty("color",re?"#4caf50":"#f44336"):M.style.removeProperty("color"),M.style.setProperty("font-weight","600"),a(M,()=>re?` ${e("journal.balanced")}`:` ${e("journal.notBalanced","Not Balanced")}`),G.style.setProperty("margin-top","1rem"),G.style.setProperty("padding","1rem"),G.style.setProperty("border-radius","var(--border-radius-sm)"),G.style.setProperty("font-size","0.875rem"),Q.style.setProperty("margin-bottom","0.5rem"),a(ie,()=>e("journal.reconciliationSummary","Reconciliation Summary"),null),me.style.setProperty("display","grid"),me.style.setProperty("grid-template-columns","1fr 1fr"),me.style.setProperty("gap","1rem"),ee.style.setProperty("margin-bottom","0.25rem"),a(de,()=>e("journal.totalLines","Total Lines"),he),a(ee,()=>v.lines.length,null),le.style.setProperty("margin-bottom","0.25rem"),le.style.setProperty("color","#4caf50"),a(ye,()=>e("journal.reconciled","Reconciled"),ve),a(le,()=>v.lines.filter(je=>je.reconciled).length,null),pe.style.setProperty("color","#f44336"),a(ge,()=>e("journal.unreconciled","Unreconciled"),ke),a(pe,()=>v.lines.filter(je=>!je.reconciled).length,null),xe.style.setProperty("margin-bottom","0.25rem"),a($e,()=>e("journal.bankAccounts","Bank Accounts"),Ee),a(xe,()=>v.lines.filter(je=>["1001","1002","1003"].includes(je.accountId)).length,null),Me.style.setProperty("margin-bottom","0.25rem"),Me.style.setProperty("color","#4caf50"),a(Ye,()=>e("journal.bankReconciled","Bank Reconciled"),ze),a(Me,()=>v.lines.filter(je=>["1001","1002","1003"].includes(je.accountId)&&je.reconciled).length,null),a(Ne,(()=>{var je=Te(()=>v.lines.filter(Xe=>["1001","1002","1003"].includes(Xe.accountId)&&!Xe.reconciled).length>0);return()=>je()&&(()=>{var Xe=th(),ht=Xe.firstChild,ut=ht.firstChild;return ht.nextSibling,Xe.style.setProperty("color","#f44336"),a(ht,()=>e("journal.bankPending","Bank Pending"),ut),a(Xe,()=>v.lines.filter(Ue=>["1001","1002","1003"].includes(Ue.accountId)&&!Ue.reconciled).length,null),Xe})()})(),null),a(G,(()=>{var je=Te(()=>v.lines.filter(Xe=>Xe.reconciled).length>0);return()=>je()&&(()=>{var Xe=P7(),ht=Xe.firstChild,ut=ht.firstChild;return Xe.style.setProperty("margin-top","0.75rem"),Xe.style.setProperty("padding-top","0.75rem"),Xe.style.setProperty("border-top","1px solid var(--border-color)"),ht.style.setProperty("margin-bottom","0.5rem"),ht.style.setProperty("font-weight","500"),a(ht,()=>e("journal.reconciledLines","Reconciled Lines"),ut),a(Xe,()=>v.lines.filter(Ue=>Ue.reconciled).map(Ue=>(()=>{var it=Rm(),dt=it.firstChild,Fe=dt.nextSibling;return it.style.setProperty("display","flex"),it.style.setProperty("justify-content","space-between"),it.style.setProperty("margin-bottom","0.25rem"),it.style.setProperty("font-size","0.8rem"),a(dt,()=>Ue.accountName),Fe.style.setProperty("color","var(--text-muted)"),a(Fe,(()=>{var Be=Te(()=>!!Ue.reconciledWith);return()=>Be()?` ${Ue.reconciledWith}`:e("journal.manual","Manual")})()),it})()),null),Xe})()})(),null),a(G,(()=>{var je=Te(()=>v.lines.filter(Xe=>!Xe.reconciled&&["1001","1002","1003"].includes(Xe.accountId)).length>0);return()=>je()&&(()=>{var Xe=S7(),ht=Xe.firstChild,ut=ht.firstChild,Ue=ut.nextSibling;Ue.nextSibling;var it=ht.nextSibling;return Xe.style.setProperty("margin-top","0.75rem"),Xe.style.setProperty("padding-top","0.75rem"),Xe.style.setProperty("border-top","1px solid var(--border-color)"),ht.style.setProperty("margin-bottom","0.5rem"),ht.style.setProperty("font-weight","500"),ht.style.setProperty("color","#f44336"),a(ht,()=>e("journal.pendingBankReconciliation","Pending Bank Reconciliation"),Ue),a(Xe,()=>v.lines.filter(dt=>!dt.reconciled&&["1001","1002","1003"].includes(dt.accountId)).map(dt=>(()=>{var Fe=Rm(),Be=Fe.firstChild,Re=Be.nextSibling;return Fe.style.setProperty("display","flex"),Fe.style.setProperty("justify-content","space-between"),Fe.style.setProperty("margin-bottom","0.25rem"),Fe.style.setProperty("font-size","0.8rem"),Fe.style.setProperty("color","#f44336"),a(Be,()=>dt.accountName),a(Re,()=>C(dt.debitAmount||dt.creditAmount)),Fe})()),it),it.style.setProperty("margin-top","0.5rem"),it.style.setProperty("font-size","0.75rem"),it.style.setProperty("color","var(--text-muted)"),it.style.setProperty("font-style","italic"),a(it,()=>e("journal.visitBankConsolidations","Visit Bank Consolidations to reconcile these transactions")),Xe})()})(),null),fe(je=>{var Xe=K,ht=v.lines.some(ut=>ut.reconciled)?"#e8f5e8":"#fff3cd";return je.e=p(O,Xe,je.e),ht!==je.t&&((je.t=ht)!=null?G.style.setProperty("background",ht):G.style.removeProperty("background")),je},{e:void 0,t:void 0}),L})()),Te(()=>Te(()=>r()==="reconciliation")()&&(()=>{var L=w7(),O=L.firstChild,ne=O.firstChild,X=ne.firstChild,W=X.nextSibling,se=ne.nextSibling,F=se.firstChild,k=F.firstChild,N=k.nextSibling,A=F.nextSibling,V=A.firstChild,Z=V.nextSibling,H=A.nextSibling,B=H.firstChild,M=B.nextSibling;return O.style.setProperty("margin-bottom","1.5rem"),O.style.setProperty("padding","1rem"),O.style.setProperty("border-radius","var(--border-radius)"),O.style.setProperty("border","1px solid var(--border-color)"),ne.style.setProperty("display","flex"),ne.style.setProperty("align-items","center"),ne.style.setProperty("gap","0.5rem"),ne.style.setProperty("margin-bottom","1rem"),X.style.setProperty("font-size","1.5rem"),a(X,(()=>{var G=Te(()=>!!v.lines.every(Q=>Q.reconciled));return()=>G()?"":v.lines.some(Q=>Q.reconciled)?"":""})()),W.style.setProperty("margin","0"),W.style.setProperty("font-size","1.2rem"),a(W,(()=>{var G=Te(()=>!!v.lines.every(Q=>Q.reconciled));return()=>G()?e("journal.fullyReconciled","Fully Reconciled"):Te(()=>!!v.lines.some(Q=>Q.reconciled))()?e("journal.partiallyReconciled","Partially Reconciled"):e("journal.unreconciled","Unreconciled")})()),se.style.setProperty("display","grid"),se.style.setProperty("grid-template-columns","1fr 1fr 1fr"),se.style.setProperty("gap","1rem"),F.style.setProperty("text-align","center"),k.style.setProperty("font-size","2rem"),k.style.setProperty("font-weight","700"),k.style.setProperty("color","var(--primary-color)"),a(k,()=>v.lines.length),N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),a(N,()=>e("journal.totalLines","Total Lines")),A.style.setProperty("text-align","center"),V.style.setProperty("font-size","2rem"),V.style.setProperty("font-weight","700"),V.style.setProperty("color","#4caf50"),a(V,()=>v.lines.filter(G=>G.reconciled).length),Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-muted)"),a(Z,()=>e("journal.reconciled","Reconciled")),H.style.setProperty("text-align","center"),B.style.setProperty("font-size","2rem"),B.style.setProperty("font-weight","700"),B.style.setProperty("color","#f44336"),a(B,()=>v.lines.filter(G=>!G.reconciled).length),M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),a(M,()=>e("journal.pending","Pending")),a(L,(()=>{var G=Te(()=>v.lines.filter(Q=>Q.reconciled).length>0);return()=>G()&&(()=>{var Q=x7(),ie=Q.firstChild,me=ie.firstChild,oe=me.nextSibling,ee=oe.nextSibling,de=ee.nextSibling;return de.nextSibling,Q.style.setProperty("margin-bottom","1.5rem"),ie.style.setProperty("margin","0 0 1rem 0"),ie.style.setProperty("font-size","1.1rem"),ie.style.setProperty("color","#4caf50"),ie.style.setProperty("display","flex"),ie.style.setProperty("align-items","center"),ie.style.setProperty("gap","0.5rem"),a(ie,()=>e("journal.reconciledLines","Reconciled Lines"),oe),a(ie,()=>v.lines.filter(he=>he.reconciled).length,de),a(Q,()=>v.lines.filter(he=>he.reconciled).map(he=>(()=>{var le=C7(),ye=le.firstChild,ve=ye.firstChild,pe=ve.nextSibling,ge=ye.nextSibling,ke=ge.nextSibling,Ne=ke.nextSibling,xe=Ne.nextSibling,$e=xe.firstChild;return $e.firstChild,le.style.setProperty("display","grid"),le.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),le.style.setProperty("gap","1rem"),le.style.setProperty("padding","0.75rem"),le.style.setProperty("margin-bottom","0.5rem"),le.style.setProperty("background","#f0f9f0"),le.style.setProperty("border-radius","var(--border-radius-sm)"),le.style.setProperty("align-items","center"),le.style.setProperty("font-size","0.875rem"),ve.style.setProperty("font-weight","500"),a(ve,()=>he.accountName),pe.style.setProperty("font-size","0.75rem"),pe.style.setProperty("color","var(--text-muted)"),a(pe,()=>qr.getAccountById(he.accountId)?.accountNumber),ge.style.setProperty("color","var(--text-muted)"),a(ge,()=>he.description||e("journal.noDescription","No description")),ke.style.setProperty("font-weight","600"),a(ke,(()=>{var Ee=Te(()=>he.debitAmount>0);return()=>Ee()?C(he.debitAmount):"-"})()),Ne.style.setProperty("font-weight","600"),a(Ne,(()=>{var Ee=Te(()=>he.creditAmount>0);return()=>Ee()?C(he.creditAmount):"-"})()),xe.style.setProperty("color","#4caf50"),$e.style.setProperty("font-weight","500"),a($e,()=>e("journal.matched","Matched"),null),a(xe,(()=>{var Ee=Te(()=>!!he.reconciledWith);return()=>Ee()&&(()=>{var Me=A7();return Me.firstChild,Me.style.setProperty("font-size","0.75rem"),Me.style.setProperty("font-style","italic"),a(Me,()=>he.reconciledWith,null),Me})()})(),null),fe(Ee=>{var Me=he.debitAmount>0?"#4caf50":"var(--text-muted)",Ye=he.creditAmount>0?"#f44336":"var(--text-muted)";return Me!==Ee.e&&((Ee.e=Me)!=null?ke.style.setProperty("color",Me):ke.style.removeProperty("color")),Ye!==Ee.t&&((Ee.t=Ye)!=null?Ne.style.setProperty("color",Ye):Ne.style.removeProperty("color")),Ee},{e:void 0,t:void 0}),le})()),null),Q})()})(),null),a(L,(()=>{var G=Te(()=>v.lines.filter(Q=>!Q.reconciled).length>0);return()=>G()&&(()=>{var Q=$7(),ie=Q.firstChild,me=ie.firstChild,oe=me.nextSibling,ee=oe.nextSibling,de=ee.nextSibling;return de.nextSibling,Q.style.setProperty("margin-bottom","1.5rem"),ie.style.setProperty("margin","0 0 1rem 0"),ie.style.setProperty("font-size","1.1rem"),ie.style.setProperty("color","#f44336"),ie.style.setProperty("display","flex"),ie.style.setProperty("align-items","center"),ie.style.setProperty("gap","0.5rem"),a(ie,()=>e("journal.unreconciledLines","Unreconciled Lines"),oe),a(ie,()=>v.lines.filter(he=>!he.reconciled).length,de),a(Q,()=>v.lines.filter(he=>!he.reconciled).map(he=>(()=>{var le=E7(),ye=le.firstChild,ve=ye.firstChild,pe=ve.nextSibling,ge=ye.nextSibling,ke=ge.nextSibling,Ne=ke.nextSibling,xe=Ne.nextSibling,$e=xe.firstChild;return $e.firstChild,le.style.setProperty("display","grid"),le.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),le.style.setProperty("gap","1rem"),le.style.setProperty("padding","0.75rem"),le.style.setProperty("margin-bottom","0.5rem"),le.style.setProperty("background","#fff9f0"),le.style.setProperty("border-radius","var(--border-radius-sm)"),le.style.setProperty("align-items","center"),le.style.setProperty("font-size","0.875rem"),le.style.setProperty("border","1px solid #ffe0b3"),ve.style.setProperty("font-weight","500"),a(ve,()=>he.accountName),pe.style.setProperty("font-size","0.75rem"),pe.style.setProperty("color","var(--text-muted)"),a(pe,()=>qr.getAccountById(he.accountId)?.accountNumber),ge.style.setProperty("color","var(--text-muted)"),a(ge,()=>he.description||e("journal.noDescription","No description")),ke.style.setProperty("font-weight","600"),a(ke,(()=>{var Ee=Te(()=>he.debitAmount>0);return()=>Ee()?C(he.debitAmount):"-"})()),Ne.style.setProperty("font-weight","600"),a(Ne,(()=>{var Ee=Te(()=>he.creditAmount>0);return()=>Ee()?C(he.creditAmount):"-"})()),xe.style.setProperty("color","#f44336"),$e.style.setProperty("font-weight","500"),a($e,()=>e("journal.pending","Pending"),null),a(xe,(()=>{var Ee=Te(()=>!!["1001","1002","1003"].includes(he.accountId));return()=>Ee()&&(()=>{var Me=Lm();return Me.style.setProperty("font-size","0.75rem"),Me.style.setProperty("font-style","italic"),a(Me,()=>e("journal.bankAccount","Bank account")),Me})()})(),null),fe(Ee=>{var Me=he.debitAmount>0?"#4caf50":"var(--text-muted)",Ye=he.creditAmount>0?"#f44336":"var(--text-muted)";return Me!==Ee.e&&((Ee.e=Me)!=null?ke.style.setProperty("color",Me):ke.style.removeProperty("color")),Ye!==Ee.t&&((Ee.t=Ye)!=null?Ne.style.setProperty("color",Ye):Ne.style.removeProperty("color")),Ee},{e:void 0,t:void 0}),le})()),null),a(Q,(()=>{var he=Te(()=>v.lines.filter(le=>!le.reconciled&&["1001","1002","1003"].includes(le.accountId)).length>0);return()=>he()&&(()=>{var le=I7(),ye=le.firstChild;ye.firstChild;var ve=ye.nextSibling,pe=ve.firstChild;return le.style.setProperty("padding","0.75rem"),le.style.setProperty("background","#ffebee"),le.style.setProperty("border-radius","var(--border-radius-sm)"),le.style.setProperty("margin-top","1rem"),le.style.setProperty("border","1px solid #ffcdd2"),ye.style.setProperty("font-weight","500"),ye.style.setProperty("margin-bottom","0.5rem"),ye.style.setProperty("color","#f44336"),a(ye,()=>e("journal.reconciliationTip","Reconciliation Tip"),null),ve.style.setProperty("font-size","0.875rem"),ve.style.setProperty("color","var(--text-muted)"),a(ve,()=>e("journal.unreconciledBankTransactions","This entry has unreconciled bank account transactions."),pe),a(ve,()=>e("journal.visitBankConsolidations","Visit Bank Consolidations to reconcile these transactions"),null),le})()})(),null),Q})()})(),null),fe(G=>(G=v.lines.every(Q=>Q.reconciled)?"#e8f5e8":v.lines.some(Q=>Q.reconciled)?"#fff3cd":"#ffebee")!=null?O.style.setProperty("background",G):O.style.removeProperty("background")),L})()),(()=>{var L=Lm();return p(L,q),a(L,I(_t,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),a(L,I(_t,{variant:"primary",onClick:D,get children(){return e("journal.editEntry")}}),null),a(L,(()=>{var O=Te(()=>v.status==="draft");return()=>O()&&I(_t,{variant:"outline",onClick:b,disabled:!re,style:{"border-color":"#4caf50",color:re?"#4caf50":"var(--text-muted)"},get children(){return re?e("journal.postEntry","Post Entry"):e("journal.entryNotBalanced","Entry Not Balanced")}})})(),null),a(L,(()=>{var O=Te(()=>v.status==="posted");return()=>O()&&I(_t,{variant:"outline",onClick:S,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return e("journal.voidEntry","Void Entry")}})})(),null),L})()]})()}}),Te(()=>Te(()=>!!s())()&&I(m_,{get isOpen(){return i()},onClose:()=>{o(!1)},get editEntry(){return s()}}))]};br(["click"]);var k7=ae("<div><div><h2></h2><p></p></div><div>"),Os=ae("<div>"),N7=ae("<div> <!>  <!> "),L7=ae("<div><div><label></label></div><div><label></label></div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label></div><div>"),R7=ae("<div><span>:</span><span> "),rh=ae("<span>: "),D7=ae("<div><br>");const M7=()=>{const{t}=_r(),[e,r]=we(!1),[n,i]=we(!1),[o,s]=we(!1),[l,c]=we(null),[d,u]=we(!1),[y,g]=we(null),[f,w]=we("all"),[E,x]=we("all"),[T,Y]=we(""),[K,j]=we(""),[q,J]=we("date"),[C,P]=we("desc"),$={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},D={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)","flex-wrap":"wrap"},b={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem"},S={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(400px, 1fr))",gap:"1.5rem"},v=()=>[{value:"all",label:t("journal.allEntries","All Entries")},{value:"draft",label:t("journal.draft")},{value:"posted",label:t("journal.posted")},{value:"void",label:t("entryBooks.void","Void")}],z=()=>[{value:"all",label:t("accounts.allAccounts","All Accounts")},...qr.accounts.map(N=>({value:N.id,label:`${N.accountNumber} - ${N.name}`}))],re=()=>[{value:"date",label:t("common.date")},{value:"entryNumber",label:t("journal.entryNumber")},{value:"amount",label:t("common.amount")}],L=()=>{let N=En.journalEntries;return f()!=="all"&&(N=N.filter(A=>A.status===f())),E()!=="all"&&(N=N.filter(A=>A.lines.some(V=>V.accountId===E()))),T(),K(),N=[...N].sort((A,V)=>{let Z=0;switch(q()){case"date":Z=new Date(A.date).getTime()-new Date(V.date).getTime();break;case"entryNumber":Z=A.entryNumber.localeCompare(V.entryNumber);break;case"amount":Z=A.totalDebit-V.totalDebit;break}return C()==="asc"?Z:-Z}),N},O=()=>{const N=En.journalEntries,A=N.filter(G=>G.status==="draft"),V=N.filter(G=>G.status==="posted"),Z=N.filter(G=>G.status==="void"),H=V.reduce((G,Q)=>G+Q.totalDebit,0),B=V.reduce((G,Q)=>G+Q.totalCredit,0),M=N.filter(G=>G.lines.some(Q=>["1001","1002","1003"].includes(Q.accountId)&&!Q.reconciled)).length;return{totalEntries:N.length,draftEntries:A.length,postedEntries:V.length,voidEntries:Z.length,totalDebit:H,totalCredit:B,unreconciledEntries:M}},ne=N=>{g(N.id),u(!0)},X=()=>{c(null),r(!0)},W=()=>{i(!0)},se=()=>{r(!1),c(null)},F=N=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(N),k=O();return L(),jn(()=>{En.refreshData({search:"2025"})}),I(Po,{get title(){return t("entryBooks.title")},get children(){return[(()=>{var N=k7(),A=N.firstChild,V=A.firstChild,Z=V.nextSibling,H=A.nextSibling;return p(N,$),V.style.setProperty("margin","0 0 0.5rem 0"),V.style.setProperty("font-size","1.5rem"),a(V,()=>t("journal.title")),Z.style.setProperty("margin","0"),Z.style.setProperty("color","var(--text-muted)"),a(Z,()=>t("entryBooks.subtitle","Manage accounting entries and general ledger records")),H.style.setProperty("display","flex"),H.style.setProperty("gap","1rem"),a(H,I(_t,{variant:"secondary",onClick:()=>window.location.href="/bank-consolidations",get children(){return t("entryBooks.viewReconciliation","View Reconciliation")}}),null),a(H,I(_t,{variant:"outline",onClick:W,style:{background:"#4caf50",color:"white","border-color":"#4caf50"},get children(){return[" ",Te(()=>t("journal.quickEntry","Quick Entry"))]}}),null),a(H,I(_t,{variant:"outline",onClick:()=>s(!0),get title(){return t("journal.manageTemplates","Manage Templates")},get children(){return[" ",Te(()=>t("journal.templates","Templates"))]}}),null),a(H,I(_t,{variant:"primary",onClick:X,get children(){return t("journal.addEntry","Add Journal Entry")}}),null),N})(),(()=>{var N=Os();return p(N,b),a(N,I(Gt,{get title(){return t("entryBooks.totalEntries","Total Entries")},get subtitle(){return t("entryBooks.allJournalEntries","All journal entries")},get children(){return[(()=>{var A=Os();return A.style.setProperty("font-size","1.5rem"),A.style.setProperty("font-weight","600"),A.style.setProperty("color","var(--primary-color)"),A.style.setProperty("margin-bottom","0.5rem"),a(A,()=>k.totalEntries),A})(),(()=>{var A=N7(),V=A.firstChild,Z=V.nextSibling,H=Z.nextSibling,B=H.nextSibling;return B.nextSibling,A.style.setProperty("font-size","0.875rem"),A.style.setProperty("color","var(--text-muted)"),a(A,()=>k.postedEntries,V),a(A,()=>t("journal.posted").toLowerCase(),Z),a(A,()=>k.draftEntries,B),a(A,()=>t("journal.draft").toLowerCase(),null),a(A,(()=>{var M=Te(()=>k.voidEntries>0);return()=>M()&&`  ${k.voidEntries} ${t("entryBooks.void","void").toLowerCase()}`})(),null),A})()]}}),null),a(N,I(Gt,{get title(){return t("journal.totalDebits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var A=Os();return A.style.setProperty("font-size","1.5rem"),A.style.setProperty("font-weight","600"),A.style.setProperty("color","#4caf50"),A.style.setProperty("margin-bottom","0.5rem"),a(A,()=>F(k.totalDebit)),A})(),(()=>{var A=Os();return A.style.setProperty("font-size","0.875rem"),A.style.setProperty("color","var(--text-muted)"),a(A,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",k.postedEntries.toString())),A})()]}}),null),a(N,I(Gt,{get title(){return t("journal.totalCredits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var A=Os();return A.style.setProperty("font-size","1.5rem"),A.style.setProperty("font-weight","600"),A.style.setProperty("color","#f44336"),A.style.setProperty("margin-bottom","0.5rem"),a(A,()=>F(k.totalCredit)),A})(),(()=>{var A=Os();return A.style.setProperty("font-size","0.875rem"),A.style.setProperty("color","var(--text-muted)"),a(A,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",k.postedEntries.toString())),A})()]}}),null),a(N,I(Gt,{get title(){return t("banking.unreconciled","Unreconciled")},get subtitle(){return t("banking.title")},get children(){return[(()=>{var A=Os();return A.style.setProperty("font-size","1.5rem"),A.style.setProperty("font-weight","600"),A.style.setProperty("margin-bottom","0.5rem"),a(A,()=>k.unreconciledEntries),fe(V=>(V=k.unreconciledEntries>0?"#ff9800":"#4caf50")!=null?A.style.setProperty("color",V):A.style.removeProperty("color")),A})(),(()=>{var A=Os();return A.style.setProperty("font-size","0.875rem"),A.style.setProperty("color","var(--text-muted)"),a(A,(()=>{var V=Te(()=>k.unreconciledEntries>0);return()=>V()?t("entryBooks.needBankReconciliation","Need bank reconciliation"):t("entryBooks.allReconciled","All reconciled")})()),A})()]}}),null),N})(),(()=>{var N=L7(),A=N.firstChild,V=A.firstChild,Z=A.nextSibling,H=Z.firstChild,B=Z.nextSibling,M=B.firstChild,G=B.nextSibling,Q=G.firstChild,ie=Q.nextSibling,me=G.nextSibling,oe=me.firstChild,ee=oe.nextSibling,de=me.nextSibling,he=de.firstChild,le=de.nextSibling;return p(N,D),A.style.setProperty("min-width","150px"),V.style.setProperty("display","block"),V.style.setProperty("margin-bottom","0.5rem"),V.style.setProperty("font-weight","500"),V.style.setProperty("font-size","0.875rem"),a(V,()=>t("common.status")),a(A,I(Hn,{label:"",get value(){return f()},onChange:w,get options(){return v()}}),null),Z.style.setProperty("min-width","200px"),H.style.setProperty("display","block"),H.style.setProperty("margin-bottom","0.5rem"),H.style.setProperty("font-weight","500"),H.style.setProperty("font-size","0.875rem"),a(H,()=>t("journal.account")),a(Z,I(Hn,{label:"",get value(){return E()},onChange:x,get options(){return z()}}),null),B.style.setProperty("min-width","120px"),M.style.setProperty("display","block"),M.style.setProperty("margin-bottom","0.5rem"),M.style.setProperty("font-weight","500"),M.style.setProperty("font-size","0.875rem"),a(M,()=>t("entryBooks.sortBy","Sort By")),a(B,I(Hn,{label:"",get value(){return q()},onChange:J,get options(){return re()}}),null),G.style.setProperty("min-width","130px"),Q.style.setProperty("display","block"),Q.style.setProperty("margin-bottom","0.5rem"),Q.style.setProperty("font-weight","500"),Q.style.setProperty("font-size","0.875rem"),a(Q,()=>t("entryBooks.fromDate","From Date")),ie.addEventListener("change",ye=>Y(ye.target.value)),ie.style.setProperty("padding","0.75rem"),ie.style.setProperty("border","1px solid var(--border-color)"),ie.style.setProperty("border-radius","var(--border-radius-sm)"),ie.style.setProperty("font-family","inherit"),ie.style.setProperty("width","100%"),me.style.setProperty("min-width","130px"),oe.style.setProperty("display","block"),oe.style.setProperty("margin-bottom","0.5rem"),oe.style.setProperty("font-weight","500"),oe.style.setProperty("font-size","0.875rem"),a(oe,()=>t("entryBooks.toDate","To Date")),ee.addEventListener("change",ye=>j(ye.target.value)),ee.style.setProperty("padding","0.75rem"),ee.style.setProperty("border","1px solid var(--border-color)"),ee.style.setProperty("border-radius","var(--border-radius-sm)"),ee.style.setProperty("font-family","inherit"),ee.style.setProperty("width","100%"),de.style.setProperty("min-width","100px"),he.style.setProperty("display","block"),he.style.setProperty("margin-bottom","0.5rem"),he.style.setProperty("font-weight","500"),he.style.setProperty("font-size","0.875rem"),a(he,()=>t("entryBooks.order","Order")),a(de,I(Hn,{label:"",get value(){return C()},onChange:P,get options(){return[{value:"desc",label:t("entryBooks.newest","Newest")},{value:"asc",label:t("entryBooks.oldest","Oldest")}]}}),null),le.style.setProperty("display","flex"),le.style.setProperty("align-items","end"),le.style.setProperty("gap","0.5rem"),a(le,I(_t,{variant:"outline",size:"sm",onClick:()=>{w("all"),x("all"),Y(""),j(""),J("date"),P("desc")},get children(){return t("entryBooks.resetFilters","Reset Filters")}})),fe(()=>ie.value=T()),fe(()=>ee.value=K()),N})(),Te(()=>Te(()=>!!(f()!=="all"||E()!=="all"||T()||K()))()&&(()=>{var N=R7(),A=N.firstChild,V=A.firstChild,Z=A.nextSibling,H=Z.firstChild;return N.style.setProperty("display","flex"),N.style.setProperty("gap","0.5rem"),N.style.setProperty("align-items","center"),N.style.setProperty("margin-bottom","1rem"),N.style.setProperty("padding","0.75rem"),N.style.setProperty("background","var(--surface-color)"),N.style.setProperty("border-radius","var(--border-radius-sm)"),N.style.setProperty("border","1px solid var(--border-color)"),A.style.setProperty("font-size","0.875rem"),A.style.setProperty("font-weight","500"),a(A,()=>t("entryBooks.activeFilters","Active filters"),V),a(N,(()=>{var B=Te(()=>f()!=="all");return()=>B()&&(()=>{var M=rh(),G=M.firstChild;return M.style.setProperty("padding","0.25rem 0.5rem"),M.style.setProperty("background","var(--primary-color)"),M.style.setProperty("color","white"),M.style.setProperty("border-radius","12px"),M.style.setProperty("font-size","0.75rem"),a(M,()=>t("common.status"),G),a(M,f,null),M})()})(),Z),a(N,(()=>{var B=Te(()=>E()!=="all");return()=>B()&&(()=>{var M=rh(),G=M.firstChild;return M.style.setProperty("padding","0.25rem 0.5rem"),M.style.setProperty("background","var(--primary-color)"),M.style.setProperty("color","white"),M.style.setProperty("border-radius","12px"),M.style.setProperty("font-size","0.75rem"),a(M,()=>t("journal.account"),G),a(M,()=>qr.getAccountById(E())?.name||t("common.unknown","Unknown"),null),M})()})(),Z),a(N,(()=>{var B=Te(()=>!!T());return()=>B()&&(()=>{var M=rh(),G=M.firstChild;return M.style.setProperty("padding","0.25rem 0.5rem"),M.style.setProperty("background","var(--primary-color)"),M.style.setProperty("color","white"),M.style.setProperty("border-radius","12px"),M.style.setProperty("font-size","0.75rem"),a(M,()=>t("entryBooks.from","From"),G),a(M,T,null),M})()})(),Z),a(N,(()=>{var B=Te(()=>!!K());return()=>B()&&(()=>{var M=rh(),G=M.firstChild;return M.style.setProperty("padding","0.25rem 0.5rem"),M.style.setProperty("background","var(--primary-color)"),M.style.setProperty("color","white"),M.style.setProperty("border-radius","12px"),M.style.setProperty("font-size","0.75rem"),a(M,()=>t("entryBooks.to","To"),G),a(M,K,null),M})()})(),Z),Z.style.setProperty("margin-left","auto"),Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-muted)"),a(Z,()=>En.journalEntries.length,H),a(Z,()=>t("entryBooks.entriesFound","{count} entries found").replace("{count}",En.journalEntries.length.toString()),null),N})()),Te(()=>Te(()=>En.journalEntries.length===0)()?I(Gt,{get title(){return t("entryBooks.noJournalEntries","No Journal Entries")},get subtitle(){return t("entryBooks.startByCreating","Start by creating your first entry")},get children(){var N=D7(),A=N.firstChild;return N.style.setProperty("text-align","center"),N.style.setProperty("color","var(--text-muted)"),N.style.setProperty("padding","2rem"),a(N,()=>t("entryBooks.noEntriesMatch","No journal entries match your current filters."),A),a(N,I(_t,{variant:"primary",style:{"margin-top":"1rem"},onClick:X,get children(){return t("entryBooks.createFirstEntry","Create First Entry")}}),null),N}}):(()=>{var N=Os();return p(N,S),a(N,I(Ct,{get each(){return En.journalEntries},children:A=>I(UL,{entry:A,onViewDetails:ne})})),N})()),I(m_,{get isOpen(){return e()},onClose:se,get editEntry(){return l()}}),I(s7,{get isOpen(){return n()},onClose:()=>i(!1)}),I(h7,{get isOpen(){return o()},onClose:()=>s(!1)}),I(T7,{get isOpen(){return d()},onClose:()=>{u(!1),g(null)},get entryId(){return y()}})]}})};function Pn(t){"@babel/helpers - typeof";return Pn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pn(t)}var ji=Uint8Array,_o=Uint16Array,ag=Int32Array,$p=new ji([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ep=new ji([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Bf=new ji([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),y_=function(t,e){for(var r=new _o(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var i=new ag(r[30]),n=1;n<30;++n)for(var o=r[n];o<r[n+1];++o)i[o]=o-r[n]<<5|n;return{b:r,r:i}},g_=y_($p,2),v_=g_.b,jf=g_.r;v_[28]=258,jf[258]=28;var b_=y_(Ep,0),F7=b_.b,ub=b_.r,Vf=new _o(32768);for(var Dn=0;Dn<32768;++Dn){var Ea=(Dn&43690)>>1|(Dn&21845)<<1;Ea=(Ea&52428)>>2|(Ea&13107)<<2,Ea=(Ea&61680)>>4|(Ea&3855)<<4,Vf[Dn]=((Ea&65280)>>8|(Ea&255)<<8)>>1}var bs=function(t,e,r){for(var n=t.length,i=0,o=new _o(e);i<n;++i)t[i]&&++o[t[i]-1];var s=new _o(e);for(i=1;i<e;++i)s[i]=s[i-1]+o[i-1]<<1;var l;if(r){l=new _o(1<<e);var c=15-e;for(i=0;i<n;++i)if(t[i])for(var d=i<<4|t[i],u=e-t[i],y=s[t[i]-1]++<<u,g=y|(1<<u)-1;y<=g;++y)l[Vf[y]>>c]=d}else for(l=new _o(n),i=0;i<n;++i)t[i]&&(l[i]=Vf[s[t[i]-1]++]>>15-t[i]);return l},Ja=new ji(288);for(var Dn=0;Dn<144;++Dn)Ja[Dn]=8;for(var Dn=144;Dn<256;++Dn)Ja[Dn]=9;for(var Dn=256;Dn<280;++Dn)Ja[Dn]=7;for(var Dn=280;Dn<288;++Dn)Ja[Dn]=8;var Jd=new ji(32);for(var Dn=0;Dn<32;++Dn)Jd[Dn]=5;var O7=bs(Ja,9,0),B7=bs(Ja,9,1),j7=bs(Jd,5,0),V7=bs(Jd,5,1),Dm=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},qo=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Mm=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},lg=function(t){return(t+7)/8|0},__=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new ji(t.subarray(e,r))},q7=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ho=function(t,e,r){var n=new Error(e||q7[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,Ho),!r)throw n;return n},z7=function(t,e,r,n){var i=t.length,o=0;if(!i||e.f&&!e.l)return r||new ji(0);var s=!r,l=s||e.i!=2,c=e.i;s&&(r=new ji(i*3));var d=function(G){var Q=r.length;if(G>Q){var ie=new ji(Math.max(Q*2,G));ie.set(r),r=ie}},u=e.f||0,y=e.p||0,g=e.b||0,f=e.l,w=e.d,E=e.m,x=e.n,T=i*8;do{if(!f){u=qo(t,y,1);var Y=qo(t,y+1,3);if(y+=3,Y)if(Y==1)f=B7,w=V7,E=9,x=5;else if(Y==2){var J=qo(t,y,31)+257,C=qo(t,y+10,15)+4,P=J+qo(t,y+5,31)+1;y+=14;for(var $=new ji(P),D=new ji(19),b=0;b<C;++b)D[Bf[b]]=qo(t,y+b*3,7);y+=C*3;for(var S=Dm(D),v=(1<<S)-1,z=bs(D,S,1),b=0;b<P;){var re=z[qo(t,y,v)];y+=re&15;var K=re>>4;if(K<16)$[b++]=K;else{var L=0,O=0;for(K==16?(O=3+qo(t,y,3),y+=2,L=$[b-1]):K==17?(O=3+qo(t,y,7),y+=3):K==18&&(O=11+qo(t,y,127),y+=7);O--;)$[b++]=L}}var ne=$.subarray(0,J),X=$.subarray(J);E=Dm(ne),x=Dm(X),f=bs(ne,E,1),w=bs(X,x,1)}else Ho(1);else{var K=lg(y)+4,j=t[K-4]|t[K-3]<<8,q=K+j;if(q>i){c&&Ho(0);break}l&&d(g+j),r.set(t.subarray(K,q),g),e.b=g+=j,e.p=y=q*8,e.f=u;continue}if(y>T){c&&Ho(0);break}}l&&d(g+131072);for(var W=(1<<E)-1,se=(1<<x)-1,F=y;;F=y){var L=f[Mm(t,y)&W],k=L>>4;if(y+=L&15,y>T){c&&Ho(0);break}if(L||Ho(2),k<256)r[g++]=k;else if(k==256){F=y,f=null;break}else{var N=k-254;if(k>264){var b=k-257,A=$p[b];N=qo(t,y,(1<<A)-1)+v_[b],y+=A}var V=w[Mm(t,y)&se],Z=V>>4;V||Ho(3),y+=V&15;var X=F7[Z];if(Z>3){var A=Ep[Z];X+=Mm(t,y)&(1<<A)-1,y+=A}if(y>T){c&&Ho(0);break}l&&d(g+131072);var H=g+N;if(g<X){var B=o-X,M=Math.min(X,H);for(B+g<0&&Ho(3);g<M;++g)r[g]=n[B+g]}for(;g<H;++g)r[g]=r[g-X]}}e.l=f,e.p=F,e.b=g,e.f=u,f&&(u=1,e.m=E,e.d=w,e.n=x)}while(!u);return g!=r.length&&s?__(r,0,g):r.subarray(0,g)},Bs=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},hd=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},Fm=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var i=r.length,o=r.slice();if(!i)return{t:S_,l:0};if(i==1){var s=new ji(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(q,J){return q.f-J.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],d=0,u=1,y=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};u!=i-1;)l=r[r[d].f<r[y].f?d++:y++],c=r[d!=u&&r[d].f<r[y].f?d++:y++],r[u++]={s:-1,f:l.f+c.f,l,r:c};for(var g=o[0].s,n=1;n<i;++n)o[n].s>g&&(g=o[n].s);var f=new _o(g+1),w=qf(r[u-1],f,0);if(w>e){var n=0,E=0,x=w-e,T=1<<x;for(o.sort(function(J,C){return f[C.s]-f[J.s]||J.f-C.f});n<i;++n){var Y=o[n].s;if(f[Y]>e)E+=T-(1<<w-f[Y]),f[Y]=e;else break}for(E>>=x;E>0;){var K=o[n].s;f[K]<e?E-=1<<e-f[K]++-1:++n}for(;n>=0&&E;--n){var j=o[n].s;f[j]==e&&(--f[j],++E)}w=e}return{t:new ji(f),l:w}},qf=function(t,e,r){return t.s==-1?Math.max(qf(t.l,e,r+1),qf(t.r,e,r+1)):e[t.s]=r},hb=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new _o(++e),n=0,i=t[0],o=1,s=function(c){r[n++]=c},l=1;l<=e;++l)if(t[l]==i&&l!=e)++o;else{if(!i&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(i),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(i);o=1,i=t[l]}return{c:r.subarray(0,n),n:e}},pd=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},P_=function(t,e,r){var n=r.length,i=lg(e+2);t[i]=n&255,t[i+1]=n>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var o=0;o<n;++o)t[i+o+4]=r[o];return(i+4+n)*8},pb=function(t,e,r,n,i,o,s,l,c,d,u){Bs(e,u++,r),++i[256];for(var y=Fm(i,15),g=y.t,f=y.l,w=Fm(o,15),E=w.t,x=w.l,T=hb(g),Y=T.c,K=T.n,j=hb(E),q=j.c,J=j.n,C=new _o(19),P=0;P<Y.length;++P)++C[Y[P]&31];for(var P=0;P<q.length;++P)++C[q[P]&31];for(var $=Fm(C,7),D=$.t,b=$.l,S=19;S>4&&!D[Bf[S-1]];--S);var v=d+5<<3,z=pd(i,Ja)+pd(o,Jd)+s,re=pd(i,g)+pd(o,E)+s+14+3*S+pd(C,D)+2*C[16]+3*C[17]+7*C[18];if(c>=0&&v<=z&&v<=re)return P_(e,u,t.subarray(c,c+d));var L,O,ne,X;if(Bs(e,u,1+(re<z)),u+=2,re<z){L=bs(g,f,0),O=g,ne=bs(E,x,0),X=E;var W=bs(D,b,0);Bs(e,u,K-257),Bs(e,u+5,J-1),Bs(e,u+10,S-4),u+=14;for(var P=0;P<S;++P)Bs(e,u+3*P,D[Bf[P]]);u+=3*S;for(var se=[Y,q],F=0;F<2;++F)for(var k=se[F],P=0;P<k.length;++P){var N=k[P]&31;Bs(e,u,W[N]),u+=D[N],N>15&&(Bs(e,u,k[P]>>5&127),u+=k[P]>>12)}}else L=O7,O=Ja,ne=j7,X=Jd;for(var P=0;P<l;++P){var A=n[P];if(A>255){var N=A>>18&31;hd(e,u,L[N+257]),u+=O[N+257],N>7&&(Bs(e,u,A>>23&31),u+=$p[N]);var V=A&31;hd(e,u,ne[V]),u+=X[V],V>3&&(hd(e,u,A>>5&8191),u+=Ep[V])}else hd(e,u,L[A]),u+=O[A]}return hd(e,u,L[256]),u+O[256]},U7=new ag([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),S_=new ji(0),H7=function(t,e,r,n,i,o){var s=o.z||t.length,l=new ji(n+s+5*(1+Math.ceil(s/7e3))+i),c=l.subarray(n,l.length-i),d=o.l,u=(o.r||0)&7;if(e){u&&(c[0]=o.r>>3);for(var y=U7[e-1],g=y>>13,f=y&8191,w=(1<<r)-1,E=o.p||new _o(32768),x=o.h||new _o(w+1),T=Math.ceil(r/3),Y=2*T,K=function(me){return(t[me]^t[me+1]<<T^t[me+2]<<Y)&w},j=new ag(25e3),q=new _o(288),J=new _o(32),C=0,P=0,$=o.i||0,D=0,b=o.w||0,S=0;$+2<s;++$){var v=K($),z=$&32767,re=x[v];if(E[z]=re,x[v]=z,b<=$){var L=s-$;if((C>7e3||D>24576)&&(L>423||!d)){u=pb(t,c,0,j,q,J,P,D,S,$-S,u),D=C=P=0,S=$;for(var O=0;O<286;++O)q[O]=0;for(var O=0;O<30;++O)J[O]=0}var ne=2,X=0,W=f,se=z-re&32767;if(L>2&&v==K($-se))for(var F=Math.min(g,L)-1,k=Math.min(32767,$),N=Math.min(258,L);se<=k&&--W&&z!=re;){if(t[$+ne]==t[$+ne-se]){for(var A=0;A<N&&t[$+A]==t[$+A-se];++A);if(A>ne){if(ne=A,X=se,A>F)break;for(var V=Math.min(se,A-2),Z=0,O=0;O<V;++O){var H=$-se+O&32767,B=E[H],M=H-B&32767;M>Z&&(Z=M,re=H)}}}z=re,re=E[z],se+=z-re&32767}if(X){j[D++]=268435456|jf[ne]<<18|ub[X];var G=jf[ne]&31,Q=ub[X]&31;P+=$p[G]+Ep[Q],++q[257+G],++J[Q],b=$+ne,++C}else j[D++]=t[$],++q[t[$]]}}for($=Math.max($,b);$<s;++$)j[D++]=t[$],++q[t[$]];u=pb(t,c,d,j,q,J,P,D,S,$-S,u),d||(o.r=u&7|c[u/8|0]<<3,u-=7,o.h=x,o.p=E,o.i=$,o.w=b)}else{for(var $=o.w||0;$<s+d;$+=65535){var ie=$+65535;ie>=s&&(c[u/8|0]=d,ie=s),u=P_(c,u+1,t.subarray($,ie))}o.i=s}return __(l,0,n+lg(u)+i)},w_=function(){var t=1,e=0;return{p:function(r){for(var n=t,i=e,o=r.length|0,s=0;s!=o;){for(var l=Math.min(s+2655,o);s<l;++s)i+=n+=r[s];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}t=n,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},G7=function(t,e,r,n,i){if(!i&&(i={l:1},e.dictionary)){var o=e.dictionary.subarray(-32768),s=new ji(o.length+t.length);s.set(o),s.set(t,o.length),t=s,i.w=o.length}return H7(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,i)},x_=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},W7=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=w_();i.p(e.dictionary),x_(t,2,i.d())}},Y7=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&Ho(6,"invalid zlib data"),(t[1]>>5&1)==1&&Ho(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function zf(t,e){e||(e={});var r=w_();r.p(t);var n=G7(t,e,e.dictionary?6:2,4);return W7(n,e),x_(n,n.length-4,r.d()),n}function K7(t,e){return z7(t.subarray(Y7(t),-4),{i:2},e,e)}var J7=typeof TextDecoder<"u"&&new TextDecoder,Q7=0;try{J7.decode(S_,{stream:!0}),Q7=1}catch{}var kr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Om(){kr.console&&typeof kr.console.log=="function"&&kr.console.log.apply(kr.console,arguments)}var An={log:Om,warn:function(t){kr.console&&(typeof kr.console.warn=="function"?kr.console.warn.apply(kr.console,arguments):Om.call(null,arguments))},error:function(t){kr.console&&(typeof kr.console.error=="function"?kr.console.error.apply(kr.console,arguments):Om(t))}};function Bm(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){fl(n.response,e,r)},n.onerror=function(){An.error("could not download file")},n.send()}function mb(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function nh(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var Td,Uf,fl=kr.saveAs||((typeof window>"u"?"undefined":Pn(window))!=="object"||window!==kr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=kr.URL||kr.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?mb(i.href)?Bm(t,e,r):nh(i,i.target="_blank"):nh(i)):(i.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){nh(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(mb(t))Bm(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){nh(n)})}else navigator.msSaveOrOpenBlob(function(i,o){return o===void 0?o={autoBom:!1}:Pn(o)!=="object"&&(An.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return Bm(t,e,r);var i=t.type==="application/octet-stream",o=/constructor/i.test(kr.HTMLElement)||kr.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&o)&&(typeof FileReader>"u"?"undefined":Pn(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var u=l.result;u=s?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},l.readAsDataURL(t)}else{var c=kr.URL||kr.webkitURL,d=c.createObjectURL(t);n?n.location=d:location.href=d,n=null,setTimeout(function(){c.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function C_(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,o=r[n].process,s=i.exec(t);s&&(e=o(s),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),d=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),"#"+l+c+d}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function jm(t,e){var r=t[0],n=t[1],i=t[2],o=t[3];r=ki(r,n,i,o,e[0],7,-680876936),o=ki(o,r,n,i,e[1],12,-389564586),i=ki(i,o,r,n,e[2],17,606105819),n=ki(n,i,o,r,e[3],22,-1044525330),r=ki(r,n,i,o,e[4],7,-176418897),o=ki(o,r,n,i,e[5],12,1200080426),i=ki(i,o,r,n,e[6],17,-1473231341),n=ki(n,i,o,r,e[7],22,-45705983),r=ki(r,n,i,o,e[8],7,1770035416),o=ki(o,r,n,i,e[9],12,-1958414417),i=ki(i,o,r,n,e[10],17,-42063),n=ki(n,i,o,r,e[11],22,-1990404162),r=ki(r,n,i,o,e[12],7,1804603682),o=ki(o,r,n,i,e[13],12,-40341101),i=ki(i,o,r,n,e[14],17,-1502002290),r=Ni(r,n=ki(n,i,o,r,e[15],22,1236535329),i,o,e[1],5,-165796510),o=Ni(o,r,n,i,e[6],9,-1069501632),i=Ni(i,o,r,n,e[11],14,643717713),n=Ni(n,i,o,r,e[0],20,-373897302),r=Ni(r,n,i,o,e[5],5,-701558691),o=Ni(o,r,n,i,e[10],9,38016083),i=Ni(i,o,r,n,e[15],14,-660478335),n=Ni(n,i,o,r,e[4],20,-405537848),r=Ni(r,n,i,o,e[9],5,568446438),o=Ni(o,r,n,i,e[14],9,-1019803690),i=Ni(i,o,r,n,e[3],14,-187363961),n=Ni(n,i,o,r,e[8],20,1163531501),r=Ni(r,n,i,o,e[13],5,-1444681467),o=Ni(o,r,n,i,e[2],9,-51403784),i=Ni(i,o,r,n,e[7],14,1735328473),r=Li(r,n=Ni(n,i,o,r,e[12],20,-1926607734),i,o,e[5],4,-378558),o=Li(o,r,n,i,e[8],11,-2022574463),i=Li(i,o,r,n,e[11],16,1839030562),n=Li(n,i,o,r,e[14],23,-35309556),r=Li(r,n,i,o,e[1],4,-1530992060),o=Li(o,r,n,i,e[4],11,1272893353),i=Li(i,o,r,n,e[7],16,-155497632),n=Li(n,i,o,r,e[10],23,-1094730640),r=Li(r,n,i,o,e[13],4,681279174),o=Li(o,r,n,i,e[0],11,-358537222),i=Li(i,o,r,n,e[3],16,-722521979),n=Li(n,i,o,r,e[6],23,76029189),r=Li(r,n,i,o,e[9],4,-640364487),o=Li(o,r,n,i,e[12],11,-421815835),i=Li(i,o,r,n,e[15],16,530742520),r=Ri(r,n=Li(n,i,o,r,e[2],23,-995338651),i,o,e[0],6,-198630844),o=Ri(o,r,n,i,e[7],10,1126891415),i=Ri(i,o,r,n,e[14],15,-1416354905),n=Ri(n,i,o,r,e[5],21,-57434055),r=Ri(r,n,i,o,e[12],6,1700485571),o=Ri(o,r,n,i,e[3],10,-1894986606),i=Ri(i,o,r,n,e[10],15,-1051523),n=Ri(n,i,o,r,e[1],21,-2054922799),r=Ri(r,n,i,o,e[8],6,1873313359),o=Ri(o,r,n,i,e[15],10,-30611744),i=Ri(i,o,r,n,e[6],15,-1560198380),n=Ri(n,i,o,r,e[13],21,1309151649),r=Ri(r,n,i,o,e[4],6,-145523070),o=Ri(o,r,n,i,e[11],10,-1120210379),i=Ri(i,o,r,n,e[2],15,718787259),n=Ri(n,i,o,r,e[9],21,-343485551),t[0]=Da(r,t[0]),t[1]=Da(n,t[1]),t[2]=Da(i,t[2]),t[3]=Da(o,t[3])}function Ip(t,e,r,n,i,o){return e=Da(Da(e,t),Da(n,o)),Da(e<<i|e>>>32-i,r)}function ki(t,e,r,n,i,o,s){return Ip(e&r|~e&n,t,e,i,o,s)}function Ni(t,e,r,n,i,o,s){return Ip(e&n|r&~n,t,e,i,o,s)}function Li(t,e,r,n,i,o,s){return Ip(e^r^n,t,e,i,o,s)}function Ri(t,e,r,n,i,o,s){return Ip(r^(e|~n),t,e,i,o,s)}function A_(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)jm(n,X7(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(jm(n,i),e=0;e<16;e++)i[e]=0;return i[14]=8*r,jm(n,i),n}function X7(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}Td=kr.atob.bind(kr),Uf=kr.btoa.bind(kr);var fb="0123456789abcdef".split("");function Z7(t){for(var e="",r=0;r<4;r++)e+=fb[t>>8*r+4&15]+fb[t>>8*r&15];return e}function eR(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Hf(t){return A_(t).map(eR).join("")}var tR=function(t){for(var e=0;e<t.length;e++)t[e]=Z7(t[e]);return t.join("")}(A_("hello"))!="5d41402abc4b2a76b9719d911017c592";function Da(t,e){if(tR){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Gf(t,e){var r,n,i,o;if(t!==r){for(var s=(i=t,o=1+(256/t.length>>0),new Array(o+1).join(i)),l=[],c=0;c<256;c++)l[c]=c;var d=0;for(c=0;c<256;c++){var u=l[c];d=(d+u+s.charCodeAt(c))%256,l[c]=l[d],l[d]=u}r=t,n=l}else l=n;var y=e.length,g=0,f=0,w="";for(c=0;c<y;c++)f=(f+(u=l[g=(g+1)%256]))%256,l[g]=l[f],l[f]=u,s=l[(l[g]+l[f])%256],w+=String.fromCharCode(e.charCodeAt(c)^s);return w}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var yb={print:4,modify:8,copy:16,"annot-forms":32};function gc(t,e,r,n){this.v=1,this.r=2;var i=192;t.forEach(function(l){if(yb.perm!==void 0)throw new Error("Invalid permission: "+l);i+=yb[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var o=(e+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,s),this.P=-(1+(255^i)),this.encryptionKey=Hf(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Gf(this.encryptionKey,this.padding)}function vc(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var i=t.charCodeAt(n);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?e+="#"+("0"+i.toString(16)).slice(-2):e+=t[n]}return e}function gb(t){if(Pn(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var o=Math.random().toString(35);return e[r][o]=[n,!!i],o},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var o in e[r]){var s=e[r][o];try{s[0].apply(t,n)}catch(l){kr.console&&An.error("jsPDF PubSub Error",l.message,l)}s[1]&&i.push(o)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Qd(t){if(!(this instanceof Qd))return new Qd(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function $_(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function La(t,e,r,n,i){if(!(this instanceof La))return new La(t,e,r,n,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,$_.call(this,n,i)}function xl(t,e,r,n,i){if(!(this instanceof xl))return new xl(t,e,r,n,i);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,$_.call(this,n,i)}function Er(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],o=arguments[3],s=[],l=1,c=16,d="S",u=null;Pn(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,i=t.format||i,o=t.compress||t.compressPdf||o,(u=t.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),d=t.defaultPathOperation||"S"),s=t.filters||(o===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var y=t.putOnlyUsedFonts||!1,g={},f={internal:{},__private__:{}};f.__private__.PubSub=gb;var w="1.3",E=f.__private__.getPdfVersion=function(){return w};f.__private__.setPdfVersion=function(R){w=R};var x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return x};var T=f.__private__.getPageFormat=function(R){return x[R]};i=i||"a4";var Y={COMPAT:"compat",ADVANCED:"advanced"},K=Y.COMPAT;function j(){this.saveGraphicsState(),ee(new bt(ze,0,0,-ze,0,Ii()*ze).toString()+" cm"),this.setFontSize(this.getFontSize()/ze),d="n",K=Y.ADVANCED}function q(){this.restoreGraphicsState(),d="S",K=Y.COMPAT}var J=f.__private__.combineFontStyleAndFontWeight=function(R,be){if(R=="bold"&&be=="normal"||R=="bold"&&be==400||R=="normal"&&be=="italic"||R=="bold"&&be=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return be&&(R=be==400||be==="normal"?R==="italic"?"italic":"normal":be!=700&&be!=="bold"||R!=="normal"?(be==700?"bold":be)+""+R:"bold"),R};f.advancedAPI=function(R){var be=K===Y.COMPAT;return be&&j.call(this),typeof R!="function"||(R(this),be&&q.call(this)),this},f.compatAPI=function(R){var be=K===Y.ADVANCED;return be&&q.call(this),typeof R!="function"||(R(this),be&&j.call(this)),this},f.isAdvancedAPI=function(){return K===Y.ADVANCED};var C,P=function(R){if(K!==Y.ADVANCED)throw new Error(R+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},$=f.roundToPrecision=f.__private__.roundToPrecision=function(R,be){var De=e||be;if(isNaN(R)||isNaN(De))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return R.toFixed(De).replace(/0+$/,"")};C=f.hpf=f.__private__.hpf=typeof c=="number"?function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return $(R,c)}:c==="smart"?function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return $(R,R>-1&&R<1?16:5)}:function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return $(R,16)};var D=f.f2=f.__private__.f2=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.f2");return $(R,2)},b=f.__private__.f3=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.f3");return $(R,3)},S=f.scale=f.__private__.scale=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.scale");return K===Y.COMPAT?R*ze:K===Y.ADVANCED?R:void 0},v=function(R){return K===Y.COMPAT?Ii()-R:K===Y.ADVANCED?R:void 0},z=function(R){return S(v(R))};f.__private__.setPrecision=f.setPrecision=function(R){typeof parseInt(R,10)=="number"&&(e=parseInt(R,10))};var re,L="00000000000000000000000000000000",O=f.__private__.getFileId=function(){return L},ne=f.__private__.setFileId=function(R){return L=R!==void 0&&/^[a-fA-F0-9]{32}$/.test(R)?R.toUpperCase():L.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(pn=new gc(u.userPermissions,u.userPassword,u.ownerPassword,L)),L};f.setFileId=function(R){return ne(R),this},f.getFileId=function(){return O()};var X=f.__private__.convertDateToPDFDate=function(R){var be=R.getTimezoneOffset(),De=be<0?"+":"-",qe=Math.floor(Math.abs(be/60)),Ze=Math.abs(be%60),yt=[De,N(qe),"'",N(Ze),"'"].join("");return["D:",R.getFullYear(),N(R.getMonth()+1),N(R.getDate()),N(R.getHours()),N(R.getMinutes()),N(R.getSeconds()),yt].join("")},W=f.__private__.convertPDFDateToDate=function(R){var be=parseInt(R.substr(2,4),10),De=parseInt(R.substr(6,2),10)-1,qe=parseInt(R.substr(8,2),10),Ze=parseInt(R.substr(10,2),10),yt=parseInt(R.substr(12,2),10),Dt=parseInt(R.substr(14,2),10);return new Date(be,De,qe,Ze,yt,Dt,0)},se=f.__private__.setCreationDate=function(R){var be;if(R===void 0&&(R=new Date),R instanceof Date)be=X(R);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(R))throw new Error("Invalid argument passed to jsPDF.setCreationDate");be=R}return re=be},F=f.__private__.getCreationDate=function(R){var be=re;return R==="jsDate"&&(be=W(re)),be};f.setCreationDate=function(R){return se(R),this},f.getCreationDate=function(R){return F(R)};var k,N=f.__private__.padd2=function(R){return("0"+parseInt(R)).slice(-2)},A=f.__private__.padd2Hex=function(R){return("00"+(R=R.toString())).substr(R.length)},V=0,Z=[],H=[],B=0,M=[],G=[],Q=!1,ie=H,me=function(){V=0,B=0,H=[],Z=[],M=[],gr=pt(),et=pt()};f.__private__.setCustomOutputDestination=function(R){Q=!0,ie=R};var oe=function(R){Q||(ie=R)};f.__private__.resetCustomOutputDestination=function(){Q=!1,ie=H};var ee=f.__private__.out=function(R){return R=R.toString(),B+=R.length+1,ie.push(R),ie},de=f.__private__.write=function(R){return ee(arguments.length===1?R.toString():Array.prototype.join.call(arguments," "))},he=f.__private__.getArrayBuffer=function(R){for(var be=R.length,De=new ArrayBuffer(be),qe=new Uint8Array(De);be--;)qe[be]=R.charCodeAt(be);return De},le=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return le};var ye=t.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(R){return ye=K===Y.ADVANCED?R/ze:R,this};var ve,pe=f.__private__.getFontSize=f.getFontSize=function(){return K===Y.COMPAT?ye:ye*ze},ge=t.R2L||!1;f.__private__.setR2L=f.setR2L=function(R){return ge=R,this},f.__private__.getR2L=f.getR2L=function(){return ge};var ke,Ne=f.__private__.setZoomMode=function(R){var be=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(R))ve=R;else if(isNaN(R)){if(be.indexOf(R)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+R+'" is not recognized.');ve=R}else ve=parseInt(R,10)};f.__private__.getZoomMode=function(){return ve};var xe,$e=f.__private__.setPageMode=function(R){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(R)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+R+'" is not recognized.');ke=R};f.__private__.getPageMode=function(){return ke};var Ee=f.__private__.setLayoutMode=function(R){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(R)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+R+'" is not recognized.');xe=R};f.__private__.getLayoutMode=function(){return xe},f.__private__.setDisplayMode=f.setDisplayMode=function(R,be,De){return Ne(R),Ee(be),$e(De),this};var Me={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(R){if(Object.keys(Me).indexOf(R)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Me[R]},f.__private__.getDocumentProperties=function(){return Me},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(R){for(var be in Me)Me.hasOwnProperty(be)&&R[be]&&(Me[be]=R[be]);return this},f.__private__.setDocumentProperty=function(R,be){if(Object.keys(Me).indexOf(R)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Me[R]=be};var Ye,ze,je,Xe,ht,ut={},Ue={},it=[],dt={},Fe={},Be={},Re={},lt=null,ot=0,nt=[],Ve=new gb(f),qt=t.hotfixes||[],Mt={},Qt={},lr=[],bt=function R(be,De,qe,Ze,yt,Dt){if(!(this instanceof R))return new R(be,De,qe,Ze,yt,Dt);isNaN(be)&&(be=1),isNaN(De)&&(De=0),isNaN(qe)&&(qe=0),isNaN(Ze)&&(Ze=1),isNaN(yt)&&(yt=0),isNaN(Dt)&&(Dt=0),this._matrix=[be,De,qe,Ze,yt,Dt]};Object.defineProperty(bt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(R){this._matrix[0]=R}}),Object.defineProperty(bt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(R){this._matrix[1]=R}}),Object.defineProperty(bt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(R){this._matrix[2]=R}}),Object.defineProperty(bt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(R){this._matrix[3]=R}}),Object.defineProperty(bt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(R){this._matrix[4]=R}}),Object.defineProperty(bt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(R){this._matrix[5]=R}}),Object.defineProperty(bt.prototype,"a",{get:function(){return this._matrix[0]},set:function(R){this._matrix[0]=R}}),Object.defineProperty(bt.prototype,"b",{get:function(){return this._matrix[1]},set:function(R){this._matrix[1]=R}}),Object.defineProperty(bt.prototype,"c",{get:function(){return this._matrix[2]},set:function(R){this._matrix[2]=R}}),Object.defineProperty(bt.prototype,"d",{get:function(){return this._matrix[3]},set:function(R){this._matrix[3]=R}}),Object.defineProperty(bt.prototype,"e",{get:function(){return this._matrix[4]},set:function(R){this._matrix[4]=R}}),Object.defineProperty(bt.prototype,"f",{get:function(){return this._matrix[5]},set:function(R){this._matrix[5]=R}}),Object.defineProperty(bt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(bt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(bt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(bt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),bt.prototype.join=function(R){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(C).join(R)},bt.prototype.multiply=function(R){var be=R.sx*this.sx+R.shy*this.shx,De=R.sx*this.shy+R.shy*this.sy,qe=R.shx*this.sx+R.sy*this.shx,Ze=R.shx*this.shy+R.sy*this.sy,yt=R.tx*this.sx+R.ty*this.shx+this.tx,Dt=R.tx*this.shy+R.ty*this.sy+this.ty;return new bt(be,De,qe,Ze,yt,Dt)},bt.prototype.decompose=function(){var R=this.sx,be=this.shy,De=this.shx,qe=this.sy,Ze=this.tx,yt=this.ty,Dt=Math.sqrt(R*R+be*be),er=(R/=Dt)*De+(be/=Dt)*qe;De-=R*er,qe-=be*er;var m=Math.sqrt(De*De+qe*qe);return er/=m,R*(qe/=m)<be*(De/=m)&&(R=-R,be=-be,er=-er,Dt=-Dt),{scale:new bt(Dt,0,0,m,0,0),translate:new bt(1,0,0,1,Ze,yt),rotate:new bt(R,be,-be,R,0,0),skew:new bt(1,0,er,1,0,0)}},bt.prototype.toString=function(R){return this.join(" ")},bt.prototype.inversed=function(){var R=this.sx,be=this.shy,De=this.shx,qe=this.sy,Ze=this.tx,yt=this.ty,Dt=1/(R*qe-be*De),er=qe*Dt,m=-be*Dt,te=-De*Dt,ue=R*Dt;return new bt(er,m,te,ue,-er*Ze-te*yt,-m*Ze-ue*yt)},bt.prototype.applyToPoint=function(R){var be=R.x*this.sx+R.y*this.shx+this.tx,De=R.x*this.shy+R.y*this.sy+this.ty;return new $s(be,De)},bt.prototype.applyToRectangle=function(R){var be=this.applyToPoint(R),De=this.applyToPoint(new $s(R.x+R.w,R.y+R.h));return new la(be.x,be.y,De.x-be.x,De.y-be.y)},bt.prototype.clone=function(){var R=this.sx,be=this.shy,De=this.shx,qe=this.sy,Ze=this.tx,yt=this.ty;return new bt(R,be,De,qe,Ze,yt)},f.Matrix=bt;var yr=f.matrixMult=function(R,be){return be.multiply(R)},Cr=new bt(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=Cr;var Kt=function(R,be){if(!Fe[R]){var De=(be instanceof La?"Sh":"P")+(Object.keys(dt).length+1).toString(10);be.id=De,Fe[R]=De,dt[De]=be,Ve.publish("addPattern",be)}};f.ShadingPattern=La,f.TilingPattern=xl,f.addShadingPattern=function(R,be){return P("addShadingPattern()"),Kt(R,be),this},f.beginTilingPattern=function(R){P("beginTilingPattern()"),ca(R.boundingBox[0],R.boundingBox[1],R.boundingBox[2]-R.boundingBox[0],R.boundingBox[3]-R.boundingBox[1],R.matrix)},f.endTilingPattern=function(R,be){P("endTilingPattern()"),be.stream=G[k].join(`
`),Kt(R,be),Ve.publish("endTilingPattern",be),lr.pop().restore()};var sr=f.__private__.newObject=function(){var R=pt();return gt(R,!0),R},pt=f.__private__.newObjectDeferred=function(){return V++,Z[V]=function(){return B},V},gt=function(R,be){return be=typeof be=="boolean"&&be,Z[R]=B,be&&ee(R+" 0 obj"),R},Vt=f.__private__.newAdditionalObject=function(){var R={objId:pt(),content:""};return M.push(R),R},gr=pt(),et=pt(),ft=f.__private__.decodeColorString=function(R){var be=R.split(" ");if(be.length!==2||be[1]!=="g"&&be[1]!=="G")be.length===5&&(be[4]==="k"||be[4]==="K")&&(be=[(1-be[0])*(1-be[3]),(1-be[1])*(1-be[3]),(1-be[2])*(1-be[3]),"r"]);else{var De=parseFloat(be[0]);be=[De,De,De,"r"]}for(var qe="#",Ze=0;Ze<3;Ze++)qe+=("0"+Math.floor(255*parseFloat(be[Ze])).toString(16)).slice(-2);return qe},At=f.__private__.encodeColorString=function(R){var be;typeof R=="string"&&(R={ch1:R});var De=R.ch1,qe=R.ch2,Ze=R.ch3,yt=R.ch4,Dt=R.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof De=="string"&&De.charAt(0)!=="#"){var er=new C_(De);if(er.ok)De=er.toHex();else if(!/^\d*\.?\d*$/.test(De))throw new Error('Invalid color "'+De+'" passed to jsPDF.encodeColorString.')}if(typeof De=="string"&&/^#[0-9A-Fa-f]{3}$/.test(De)&&(De="#"+De[1]+De[1]+De[2]+De[2]+De[3]+De[3]),typeof De=="string"&&/^#[0-9A-Fa-f]{6}$/.test(De)){var m=parseInt(De.substr(1),16);De=m>>16&255,qe=m>>8&255,Ze=255&m}if(qe===void 0||yt===void 0&&De===qe&&qe===Ze)if(typeof De=="string")be=De+" "+Dt[0];else switch(R.precision){case 2:be=D(De/255)+" "+Dt[0];break;case 3:default:be=b(De/255)+" "+Dt[0]}else if(yt===void 0||Pn(yt)==="object"){if(yt&&!isNaN(yt.a)&&yt.a===0)return be=["1.","1.","1.",Dt[1]].join(" ");if(typeof De=="string")be=[De,qe,Ze,Dt[1]].join(" ");else switch(R.precision){case 2:be=[D(De/255),D(qe/255),D(Ze/255),Dt[1]].join(" ");break;default:case 3:be=[b(De/255),b(qe/255),b(Ze/255),Dt[1]].join(" ")}}else if(typeof De=="string")be=[De,qe,Ze,yt,Dt[2]].join(" ");else switch(R.precision){case 2:be=[D(De),D(qe),D(Ze),D(yt),Dt[2]].join(" ");break;case 3:default:be=[b(De),b(qe),b(Ze),b(yt),Dt[2]].join(" ")}return be},Yt=f.__private__.getFilters=function(){return s},hr=f.__private__.putStream=function(R){var be=(R=R||{}).data||"",De=R.filters||Yt(),qe=R.alreadyAppliedFilters||[],Ze=R.addLength1||!1,yt=be.length,Dt=R.objectId,er=function(Fr){return Fr};if(u!==null&&Dt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(er=pn.encryptor(Dt,0));var m={};De===!0&&(De=["FlateEncode"]);var te=R.additionalKeyValues||[],ue=(m=Er.API.processDataByFilters!==void 0?Er.API.processDataByFilters(be,De):{data:be,reverseChain:[]}).reverseChain+(Array.isArray(qe)?qe.join(" "):qe.toString());if(m.data.length!==0&&(te.push({key:"Length",value:m.data.length}),Ze===!0&&te.push({key:"Length1",value:yt})),ue.length!=0)if(ue.split("/").length-1==1)te.push({key:"Filter",value:ue});else{te.push({key:"Filter",value:"["+ue+"]"});for(var Ce=0;Ce<te.length;Ce+=1)if(te[Ce].key==="DecodeParms"){for(var Qe=[],ct=0;ct<m.reverseChain.split("/").length-1;ct+=1)Qe.push("null");Qe.push(te[Ce].value),te[Ce].value="["+Qe.join(" ")+"]"}}ee("<<");for(var Ot=0;Ot<te.length;Ot++)ee("/"+te[Ot].key+" "+te[Ot].value);ee(">>"),m.data.length!==0&&(ee("stream"),ee(er(m.data)),ee("endstream"))},Pr=f.__private__.putPage=function(R){var be=R.number,De=R.data,qe=R.objId,Ze=R.contentsObjId;gt(qe,!0),ee("<</Type /Page"),ee("/Parent "+R.rootDictionaryObjId+" 0 R"),ee("/Resources "+R.resourceDictionaryObjId+" 0 R"),ee("/MediaBox ["+parseFloat(C(R.mediaBox.bottomLeftX))+" "+parseFloat(C(R.mediaBox.bottomLeftY))+" "+C(R.mediaBox.topRightX)+" "+C(R.mediaBox.topRightY)+"]"),R.cropBox!==null&&ee("/CropBox ["+C(R.cropBox.bottomLeftX)+" "+C(R.cropBox.bottomLeftY)+" "+C(R.cropBox.topRightX)+" "+C(R.cropBox.topRightY)+"]"),R.bleedBox!==null&&ee("/BleedBox ["+C(R.bleedBox.bottomLeftX)+" "+C(R.bleedBox.bottomLeftY)+" "+C(R.bleedBox.topRightX)+" "+C(R.bleedBox.topRightY)+"]"),R.trimBox!==null&&ee("/TrimBox ["+C(R.trimBox.bottomLeftX)+" "+C(R.trimBox.bottomLeftY)+" "+C(R.trimBox.topRightX)+" "+C(R.trimBox.topRightY)+"]"),R.artBox!==null&&ee("/ArtBox ["+C(R.artBox.bottomLeftX)+" "+C(R.artBox.bottomLeftY)+" "+C(R.artBox.topRightX)+" "+C(R.artBox.topRightY)+"]"),typeof R.userUnit=="number"&&R.userUnit!==1&&ee("/UserUnit "+R.userUnit),Ve.publish("putPage",{objId:qe,pageContext:nt[be],pageNumber:be,page:De}),ee("/Contents "+Ze+" 0 R"),ee(">>"),ee("endobj");var yt=De.join(`
`);return K===Y.ADVANCED&&(yt+=`
Q`),gt(Ze,!0),hr({data:yt,filters:Yt(),objectId:Ze}),ee("endobj"),qe},Jr=f.__private__.putPages=function(){var R,be,De=[];for(R=1;R<=ot;R++)nt[R].objId=pt(),nt[R].contentsObjId=pt();for(R=1;R<=ot;R++)De.push(Pr({number:R,data:G[R],objId:nt[R].objId,contentsObjId:nt[R].contentsObjId,mediaBox:nt[R].mediaBox,cropBox:nt[R].cropBox,bleedBox:nt[R].bleedBox,trimBox:nt[R].trimBox,artBox:nt[R].artBox,userUnit:nt[R].userUnit,rootDictionaryObjId:gr,resourceDictionaryObjId:et}));gt(gr,!0),ee("<</Type /Pages");var qe="/Kids [";for(be=0;be<ot;be++)qe+=De[be]+" 0 R ";ee(qe+"]"),ee("/Count "+ot),ee(">>"),ee("endobj"),Ve.publish("postPutPages")},Tr=function(R){Ve.publish("putFont",{font:R,out:ee,newObject:sr,putStream:hr}),R.isAlreadyPutted!==!0&&(R.objectNumber=sr(),ee("<<"),ee("/Type /Font"),ee("/BaseFont /"+vc(R.postScriptName)),ee("/Subtype /Type1"),typeof R.encoding=="string"&&ee("/Encoding /"+R.encoding),ee("/FirstChar 32"),ee("/LastChar 255"),ee(">>"),ee("endobj"))},zr=function(){for(var R in ut)ut.hasOwnProperty(R)&&(y===!1||y===!0&&g.hasOwnProperty(R))&&Tr(ut[R])},Xr=function(R){R.objectNumber=sr();var be=[];be.push({key:"Type",value:"/XObject"}),be.push({key:"Subtype",value:"/Form"}),be.push({key:"BBox",value:"["+[C(R.x),C(R.y),C(R.x+R.width),C(R.y+R.height)].join(" ")+"]"}),be.push({key:"Matrix",value:"["+R.matrix.toString()+"]"});var De=R.pages[1].join(`
`);hr({data:De,additionalKeyValues:be,objectId:R.objectNumber}),ee("endobj")},pr=function(){for(var R in Mt)Mt.hasOwnProperty(R)&&Xr(Mt[R])},Jt=function(R,be){var De,qe=[],Ze=1/(be-1);for(De=0;De<1;De+=Ze)qe.push(De);if(qe.push(1),R[0].offset!=0){var yt={offset:0,color:R[0].color};R.unshift(yt)}if(R[R.length-1].offset!=1){var Dt={offset:1,color:R[R.length-1].color};R.push(Dt)}for(var er="",m=0,te=0;te<qe.length;te++){for(De=qe[te];De>R[m+1].offset;)m++;var ue=R[m].offset,Ce=(De-ue)/(R[m+1].offset-ue),Qe=R[m].color,ct=R[m+1].color;er+=A(Math.round((1-Ce)*Qe[0]+Ce*ct[0]).toString(16))+A(Math.round((1-Ce)*Qe[1]+Ce*ct[1]).toString(16))+A(Math.round((1-Ce)*Qe[2]+Ce*ct[2]).toString(16))}return er.trim()},Yr=function(R,be){be||(be=21);var De=sr(),qe=Jt(R.colors,be),Ze=[];Ze.push({key:"FunctionType",value:"0"}),Ze.push({key:"Domain",value:"[0.0 1.0]"}),Ze.push({key:"Size",value:"["+be+"]"}),Ze.push({key:"BitsPerSample",value:"8"}),Ze.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ze.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),hr({data:qe,additionalKeyValues:Ze,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:De}),ee("endobj"),R.objectNumber=sr(),ee("<< /ShadingType "+R.type),ee("/ColorSpace /DeviceRGB");var yt="/Coords ["+C(parseFloat(R.coords[0]))+" "+C(parseFloat(R.coords[1]))+" ";R.type===2?yt+=C(parseFloat(R.coords[2]))+" "+C(parseFloat(R.coords[3])):yt+=C(parseFloat(R.coords[2]))+" "+C(parseFloat(R.coords[3]))+" "+C(parseFloat(R.coords[4]))+" "+C(parseFloat(R.coords[5])),ee(yt+="]"),R.matrix&&ee("/Matrix ["+R.matrix.toString()+"]"),ee("/Function "+De+" 0 R"),ee("/Extend [true true]"),ee(">>"),ee("endobj")},Lr=function(R,be){var De=pt(),qe=sr();be.push({resourcesOid:De,objectOid:qe}),R.objectNumber=qe;var Ze=[];Ze.push({key:"Type",value:"/Pattern"}),Ze.push({key:"PatternType",value:"1"}),Ze.push({key:"PaintType",value:"1"}),Ze.push({key:"TilingType",value:"1"}),Ze.push({key:"BBox",value:"["+R.boundingBox.map(C).join(" ")+"]"}),Ze.push({key:"XStep",value:C(R.xStep)}),Ze.push({key:"YStep",value:C(R.yStep)}),Ze.push({key:"Resources",value:De+" 0 R"}),R.matrix&&Ze.push({key:"Matrix",value:"["+R.matrix.toString()+"]"}),hr({data:R.stream,additionalKeyValues:Ze,objectId:R.objectNumber}),ee("endobj")},We=function(R){var be;for(be in dt)dt.hasOwnProperty(be)&&(dt[be]instanceof La?Yr(dt[be]):dt[be]instanceof xl&&Lr(dt[be],R))},Bt=function(R){for(var be in R.objectNumber=sr(),ee("<<"),R)switch(be){case"opacity":ee("/ca "+D(R[be]));break;case"stroke-opacity":ee("/CA "+D(R[be]))}ee(">>"),ee("endobj")},Ft=function(){var R;for(R in Be)Be.hasOwnProperty(R)&&Bt(Be[R])},Ht=function(){for(var R in ee("/XObject <<"),Mt)Mt.hasOwnProperty(R)&&Mt[R].objectNumber>=0&&ee("/"+R+" "+Mt[R].objectNumber+" 0 R");Ve.publish("putXobjectDict"),ee(">>")},Ke=function(){pn.oid=sr(),ee("<<"),ee("/Filter /Standard"),ee("/V "+pn.v),ee("/R "+pn.r),ee("/U <"+pn.toHexString(pn.U)+">"),ee("/O <"+pn.toHexString(pn.O)+">"),ee("/P "+pn.P),ee(">>"),ee("endobj")},Zt=function(){for(var R in ee("/Font <<"),ut)ut.hasOwnProperty(R)&&(y===!1||y===!0&&g.hasOwnProperty(R))&&ee("/"+R+" "+ut[R].objectNumber+" 0 R");ee(">>")},Wt=function(){if(Object.keys(dt).length>0){for(var R in ee("/Shading <<"),dt)dt.hasOwnProperty(R)&&dt[R]instanceof La&&dt[R].objectNumber>=0&&ee("/"+R+" "+dt[R].objectNumber+" 0 R");Ve.publish("putShadingPatternDict"),ee(">>")}},xr=function(R){if(Object.keys(dt).length>0){for(var be in ee("/Pattern <<"),dt)dt.hasOwnProperty(be)&&dt[be]instanceof f.TilingPattern&&dt[be].objectNumber>=0&&dt[be].objectNumber<R&&ee("/"+be+" "+dt[be].objectNumber+" 0 R");Ve.publish("putTilingPatternDict"),ee(">>")}},Hr=function(){if(Object.keys(Be).length>0){var R;for(R in ee("/ExtGState <<"),Be)Be.hasOwnProperty(R)&&Be[R].objectNumber>=0&&ee("/"+R+" "+Be[R].objectNumber+" 0 R");Ve.publish("putGStateDict"),ee(">>")}},mr=function(R){gt(R.resourcesOid,!0),ee("<<"),ee("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Zt(),Wt(),xr(R.objectOid),Hr(),Ht(),ee(">>"),ee("endobj")},Vr=function(){var R=[];zr(),Ft(),pr(),We(R),Ve.publish("putResources"),R.forEach(mr),mr({resourcesOid:et,objectOid:Number.MAX_SAFE_INTEGER}),Ve.publish("postPutResources")},Qr=function(){Ve.publish("putAdditionalObjects");for(var R=0;R<M.length;R++){var be=M[R];gt(be.objId,!0),ee(be.content),ee("endobj")}Ve.publish("postPutAdditionalObjects")},hn=function(R){Ue[R.fontName]=Ue[R.fontName]||{},Ue[R.fontName][R.fontStyle]=R.id},Nt=function(R,be,De,qe,Ze){var yt={id:"F"+(Object.keys(ut).length+1).toString(10),postScriptName:R,fontName:be,fontStyle:De,encoding:qe,isStandardFont:Ze||!1,metadata:{}};return Ve.publish("addFont",{font:yt,instance:this}),ut[yt.id]=yt,hn(yt),yt.id},tr=function(R){for(var be=0,De=le.length;be<De;be++){var qe=Nt.call(this,R[be][0],R[be][1],R[be][2],le[be][3],!0);y===!1&&(g[qe]=!0);var Ze=R[be][0].split("-");hn({id:qe,fontName:Ze[0],fontStyle:Ze[1]||""})}Ve.publish("addFonts",{fonts:ut,dictionary:Ue})},ur=function(R){return R.foo=function(){try{return R.apply(this,arguments)}catch(qe){var be=qe.stack||"";~be.indexOf(" at ")&&(be=be.split(" at ")[1]);var De="Error in function "+be.split(`
`)[0].split("<")[0]+": "+qe.message;if(!kr.console)throw new Error(De);kr.console.error(De,qe),kr.alert&&alert(De)}},R.foo.bar=R,R.foo},Ar=function(R,be){var De,qe,Ze,yt,Dt,er,m,te,ue;if(Ze=(be=be||{}).sourceEncoding||"Unicode",Dt=be.outputEncoding,(be.autoencode||Dt)&&ut[Ye].metadata&&ut[Ye].metadata[Ze]&&ut[Ye].metadata[Ze].encoding&&(yt=ut[Ye].metadata[Ze].encoding,!Dt&&ut[Ye].encoding&&(Dt=ut[Ye].encoding),!Dt&&yt.codePages&&(Dt=yt.codePages[0]),typeof Dt=="string"&&(Dt=yt[Dt]),Dt)){for(m=!1,er=[],De=0,qe=R.length;De<qe;De++)(te=Dt[R.charCodeAt(De)])?er.push(String.fromCharCode(te)):er.push(R[De]),er[De].charCodeAt(0)>>8&&(m=!0);R=er.join("")}for(De=R.length;m===void 0&&De!==0;)R.charCodeAt(De-1)>>8&&(m=!0),De--;if(!m)return R;for(er=be.noBOM?[]:[254,255],De=0,qe=R.length;De<qe;De++){if((ue=(te=R.charCodeAt(De))>>8)>>8)throw new Error("Character at position "+De+" of string '"+R+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");er.push(ue),er.push(te-(ue<<8))}return String.fromCharCode.apply(void 0,er)},Rt=f.__private__.pdfEscape=f.pdfEscape=function(R,be){return Ar(R,be).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},vt=f.__private__.beginPage=function(R){G[++ot]=[],nt[ot]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(R[0]),topRightY:Number(R[1])}},Et(ot),oe(G[k])},St=function(R,be){var De,qe,Ze;switch(r=be||r,typeof R=="string"&&(De=T(R.toLowerCase()),Array.isArray(De)&&(qe=De[0],Ze=De[1])),Array.isArray(R)&&(qe=R[0]*ze,Ze=R[1]*ze),isNaN(qe)&&(qe=i[0],Ze=i[1]),(qe>14400||Ze>14400)&&(An.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),qe=Math.min(14400,qe),Ze=Math.min(14400,Ze)),i=[qe,Ze],r.substr(0,1)){case"l":Ze>qe&&(i=[Ze,qe]);break;case"p":qe>Ze&&(i=[Ze,qe])}vt(i),tl(el),ee(gi),il!==0&&ee(il+" J"),aa!==0&&ee(aa+" j"),Ve.publish("addPage",{pageNumber:ot})},jt=function(R){R>0&&R<=ot&&(G.splice(R,1),nt.splice(R,1),ot--,k>ot&&(k=ot),this.setPage(k))},Et=function(R){R>0&&R<=ot&&(k=R)},cr=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return G.length-1},Wr=function(R,be,De){var qe,Ze=void 0;return De=De||{},R=R!==void 0?R:ut[Ye].fontName,be=be!==void 0?be:ut[Ye].fontStyle,qe=R.toLowerCase(),Ue[qe]!==void 0&&Ue[qe][be]!==void 0?Ze=Ue[qe][be]:Ue[R]!==void 0&&Ue[R][be]!==void 0?Ze=Ue[R][be]:De.disableWarning===!1&&An.warn("Unable to look up font label for font '"+R+"', '"+be+"'. Refer to getFontList() for available fonts."),Ze||De.noFallback||(Ze=Ue.times[be])==null&&(Ze=Ue.times.normal),Ze},Kr=f.__private__.putInfo=function(){var R=sr(),be=function(qe){return qe};for(var De in u!==null&&(be=pn.encryptor(R,0)),ee("<<"),ee("/Producer ("+Rt(be("jsPDF "+Er.version))+")"),Me)Me.hasOwnProperty(De)&&Me[De]&&ee("/"+De.substr(0,1).toUpperCase()+De.substr(1)+" ("+Rt(be(Me[De]))+")");ee("/CreationDate ("+Rt(be(re))+")"),ee(">>"),ee("endobj")},Zr=f.__private__.putCatalog=function(R){var be=(R=R||{}).rootDictionaryObjId||gr;switch(sr(),ee("<<"),ee("/Type /Catalog"),ee("/Pages "+be+" 0 R"),ve||(ve="fullwidth"),ve){case"fullwidth":ee("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ee("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ee("/OpenAction [3 0 R /Fit]");break;case"original":ee("/OpenAction [3 0 R /XYZ null null 1]");break;default:var De=""+ve;De.substr(De.length-1)==="%"&&(ve=parseInt(ve)/100),typeof ve=="number"&&ee("/OpenAction [3 0 R /XYZ null null "+D(ve)+"]")}switch(xe||(xe="continuous"),xe){case"continuous":ee("/PageLayout /OneColumn");break;case"single":ee("/PageLayout /SinglePage");break;case"two":case"twoleft":ee("/PageLayout /TwoColumnLeft");break;case"tworight":ee("/PageLayout /TwoColumnRight")}ke&&ee("/PageMode /"+ke),Ve.publish("putCatalog"),ee(">>"),ee("endobj")},qn=f.__private__.putTrailer=function(){ee("trailer"),ee("<<"),ee("/Size "+(V+1)),ee("/Root "+V+" 0 R"),ee("/Info "+(V-1)+" 0 R"),u!==null&&ee("/Encrypt "+pn.oid+" 0 R"),ee("/ID [ <"+L+"> <"+L+"> ]"),ee(">>")},Mn=f.__private__.putHeader=function(){ee("%PDF-"+w),ee("%")},Ln=f.__private__.putXRef=function(){var R="0000000000";ee("xref"),ee("0 "+(V+1)),ee("0000000000 65535 f ");for(var be=1;be<=V;be++)typeof Z[be]=="function"?ee((R+Z[be]()).slice(-10)+" 00000 n "):Z[be]!==void 0?ee((R+Z[be]).slice(-10)+" 00000 n "):ee("0000000000 00000 n ")},en=f.__private__.buildDocument=function(){me(),oe(H),Ve.publish("buildDocument"),Mn(),Jr(),Qr(),Vr(),u!==null&&Ke(),Kr(),Zr();var R=B;return Ln(),qn(),ee("startxref"),ee(""+R),ee("%%EOF"),oe(G[k]),H.join(`
`)},wn=f.__private__.getBlob=function(R){return new Blob([he(R)],{type:"application/pdf"})},nr=f.output=f.__private__.output=ur(function(R,be){switch(typeof(be=be||{})=="string"?be={filename:be}:be.filename=be.filename||"generated.pdf",R){case void 0:return en();case"save":f.save(be.filename);break;case"arraybuffer":return he(en());case"blob":return wn(en());case"bloburi":case"bloburl":if(kr.URL!==void 0&&typeof kr.URL.createObjectURL=="function")return kr.URL&&kr.URL.createObjectURL(wn(en()))||void 0;An.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var De="",qe=en();try{De=Uf(qe)}catch{De=Uf(unescape(encodeURIComponent(qe)))}return"data:application/pdf;filename="+be.filename+";base64,"+De;case"pdfobjectnewwindow":if(Object.prototype.toString.call(kr)==="[object Window]"){var Ze="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",yt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';be.pdfObjectUrl&&(Ze=be.pdfObjectUrl,yt="");var Dt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ze+'"'+yt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(be)+");<\/script></body></html>",er=kr.open();return er!==null&&er.document.write(Dt),er}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(kr)==="[object Window]"){var m='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(be.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+be.filename+'" width="500px" height="400px" /></body></html>',te=kr.open();if(te!==null){te.document.write(m);var ue=this;te.document.documentElement.querySelector("#pdfViewer").onload=function(){te.document.title=be.filename,te.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ue.output("bloburl"))}}return te}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(kr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Ce='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",be)+'"></iframe></body></html>',Qe=kr.open();if(Qe!==null&&(Qe.document.write(Ce),Qe.document.title=be.filename),Qe||typeof safari>"u")return Qe;break;case"datauri":case"dataurl":return kr.document.location.href=this.output("datauristring",be);default:return null}}),ei=function(R){return Array.isArray(qt)===!0&&qt.indexOf(R)>-1};switch(n){case"pt":ze=1;break;case"mm":ze=72/25.4;break;case"cm":ze=72/2.54;break;case"in":ze=72;break;case"px":ze=ei("px_scaling")==1?.75:96/72;break;case"pc":case"em":ze=12;break;case"ex":ze=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);ze=n}var pn=null;se(),ne();var So=function(R){return u!==null?pn.encryptor(R,0):function(be){return be}},co=f.__private__.getPageInfo=f.getPageInfo=function(R){if(isNaN(R)||R%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:nt[R].objId,pageNumber:R,pageContext:nt[R]}},Sr=f.__private__.getPageInfoByObjId=function(R){if(isNaN(R)||R%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var be in nt)if(nt[be].objId===R)break;return co(be)},$i=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:nt[k].objId,pageNumber:k,pageContext:nt[k]}};f.addPage=function(){return St.apply(this,arguments),this},f.setPage=function(){return Et.apply(this,arguments),oe.call(this,G[k]),this},f.insertPage=function(R){return this.addPage(),this.movePage(k,R),this},f.movePage=function(R,be){var De,qe;if(R>be){De=G[R],qe=nt[R];for(var Ze=R;Ze>be;Ze--)G[Ze]=G[Ze-1],nt[Ze]=nt[Ze-1];G[be]=De,nt[be]=qe,this.setPage(be)}else if(R<be){De=G[R],qe=nt[R];for(var yt=R;yt<be;yt++)G[yt]=G[yt+1],nt[yt]=nt[yt+1];G[be]=De,nt[be]=qe,this.setPage(be)}return this},f.deletePage=function(){return jt.apply(this,arguments),this},f.__private__.text=f.text=function(R,be,De,qe,Ze){var yt,Dt,er,m,te,ue,Ce,Qe,ct,Ot=(qe=qe||{}).scope||this;if(typeof R=="number"&&typeof be=="number"&&(typeof De=="string"||Array.isArray(De))){var Fr=De;De=be,be=R,R=Fr}if(arguments[3]instanceof bt?(P("The transform parameter of text() with a Matrix value"),ct=Ze):(er=arguments[4],m=arguments[5],Pn(Ce=arguments[3])==="object"&&Ce!==null||(typeof er=="string"&&(m=er,er=null),typeof Ce=="string"&&(m=Ce,Ce=null),typeof Ce=="number"&&(er=Ce,Ce=null),qe={flags:Ce,angle:er,align:m})),isNaN(be)||isNaN(De)||R==null)throw new Error("Invalid arguments passed to jsPDF.text");if(R.length===0)return Ot;var tn="",Or=!1,fn=typeof qe.lineHeightFactor=="number"?qe.lineHeightFactor:an,xn=Ot.internal.scaleFactor;function Bo(In){return In=In.split("	").join(Array(qe.TabLen||9).join(" ")),Rt(In,Ce)}function vi(In){for(var Tn,Wn=In.concat(),li=[],Ns=Wn.length;Ns--;)typeof(Tn=Wn.shift())=="string"?li.push(Tn):Array.isArray(In)&&(Tn.length===1||Tn[1]===void 0&&Tn[2]===void 0)?li.push(Tn[0]):li.push([Tn[0],Tn[1],Tn[2]]);return li}function is(In,Tn){var Wn;if(typeof In=="string")Wn=Tn(In)[0];else if(Array.isArray(In)){for(var li,Ns,Qc=In.concat(),Zl=[],gu=Qc.length;gu--;)typeof(li=Qc.shift())=="string"?Zl.push(Tn(li)[0]):Array.isArray(li)&&typeof li[0]=="string"&&(Ns=Tn(li[0],li[1],li[2]),Zl.push([Ns[0],Ns[1],Ns[2]]));Wn=Zl}return Wn}var os=!1,Uc=!0;if(typeof R=="string")os=!0;else if(Array.isArray(R)){var Hc=R.concat();Dt=[];for(var Hl,bi=Hc.length;bi--;)(typeof(Hl=Hc.shift())!="string"||Array.isArray(Hl)&&typeof Hl[0]!="string")&&(Uc=!1);os=Uc}if(os===!1)throw new Error('Type of text must be string or Array. "'+R+'" is not recognized.');typeof R=="string"&&(R=R.match(/[\r?\n]/)?R.split(/\r\n|\r|\n/g):[R]);var Gl=ye/Ot.internal.scaleFactor,Wl=Gl*(fn-1);switch(qe.baseline){case"bottom":De-=Wl;break;case"top":De+=Gl-Wl;break;case"hanging":De+=Gl-2*Wl;break;case"middle":De+=Gl/2-Wl}if((ue=qe.maxWidth||0)>0&&(typeof R=="string"?R=Ot.splitTextToSize(R,ue):Object.prototype.toString.call(R)==="[object Array]"&&(R=R.reduce(function(In,Tn){return In.concat(Ot.splitTextToSize(Tn,ue))},[]))),yt={text:R,x:be,y:De,options:qe,mutex:{pdfEscape:Rt,activeFontKey:Ye,fonts:ut,activeFontSize:ye}},Ve.publish("preProcessText",yt),R=yt.text,er=(qe=yt.options).angle,!(ct instanceof bt)&&er&&typeof er=="number"){er*=Math.PI/180,qe.rotationDirection===0&&(er=-er),K===Y.ADVANCED&&(er=-er);var Yl=Math.cos(er),Gc=Math.sin(er);ct=new bt(Yl,Gc,-Gc,Yl,0,0)}else er&&er instanceof bt&&(ct=er);K!==Y.ADVANCED||ct||(ct=Cr),(te=qe.charSpace||As)!==void 0&&(tn+=C(S(te))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Qe=qe.horizontalScale)!==void 0&&(tn+=C(100*Qe)+` Tz
`),qe.lang;var Qi=-1,kp=qe.renderingMode!==void 0?qe.renderingMode:qe.stroke,Wc=Ot.internal.getCurrentPageInfo().pageContext;switch(kp){case 0:case!1:case"fill":Qi=0;break;case 1:case!0:case"stroke":Qi=1;break;case 2:case"fillThenStroke":Qi=2;break;case 3:case"invisible":Qi=3;break;case 4:case"fillAndAddForClipping":Qi=4;break;case 5:case"strokeAndAddPathForClipping":Qi=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Qi=6;break;case 7:case"addToPathForClipping":Qi=7}var pu=Wc.usedRenderingMode!==void 0?Wc.usedRenderingMode:-1;Qi!==-1?tn+=Qi+` Tr
`:pu!==-1&&(tn+=`0 Tr
`),Qi!==-1&&(Wc.usedRenderingMode=Qi),m=qe.align||"left";var xo,Kl=ye*fn,mu=Ot.internal.pageSize.getWidth(),fu=ut[Ye];te=qe.charSpace||As,ue=qe.maxWidth||0,Ce=Object.assign({autoencode:!0,noBOM:!0},qe.flags);var ha=[],ol=function(In){return Ot.getStringUnitWidth(In,{font:fu,charSpace:te,fontSize:ye,doKerning:!1})*ye/xn};if(Object.prototype.toString.call(R)==="[object Array]"){var Xi;Dt=vi(R),m!=="left"&&(xo=Dt.map(ol));var Hi,pa=0;if(m==="right"){be-=xo[0],R=[],bi=Dt.length;for(var Is=0;Is<bi;Is++)Is===0?(Hi=po(be),Xi=ai(De)):(Hi=S(pa-xo[Is]),Xi=-Kl),R.push([Dt[Is],Hi,Xi]),pa=xo[Is]}else if(m==="center"){be-=xo[0]/2,R=[],bi=Dt.length;for(var Ts=0;Ts<bi;Ts++)Ts===0?(Hi=po(be),Xi=ai(De)):(Hi=S((pa-xo[Ts])/2),Xi=-Kl),R.push([Dt[Ts],Hi,Xi]),pa=xo[Ts]}else if(m==="left"){R=[],bi=Dt.length;for(var Jl=0;Jl<bi;Jl++)R.push(Dt[Jl])}else if(m==="justify"&&fu.encoding==="Identity-H"){R=[],bi=Dt.length,ue=ue!==0?ue:mu;for(var ks=0,Gn=0;Gn<bi;Gn++)if(Xi=Gn===0?ai(De):-Kl,Hi=Gn===0?po(be):ks,Gn<bi-1){var Yc=S((ue-xo[Gn])/(Dt[Gn].split(" ").length-1)),Gi=Dt[Gn].split(" ");R.push([Gi[0]+" ",Hi,Xi]),ks=0;for(var Co=1;Co<Gi.length;Co++){var Ql=(ol(Gi[Co-1]+" "+Gi[Co])-ol(Gi[Co]))*xn+Yc;Co==Gi.length-1?R.push([Gi[Co],Ql,0]):R.push([Gi[Co]+" ",Ql,0]),ks-=Ql}}else R.push([Dt[Gn],Hi,Xi]);R.push(["",ks,0])}else{if(m!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(R=[],bi=Dt.length,ue=ue!==0?ue:mu,Gn=0;Gn<bi;Gn++)Xi=Gn===0?ai(De):-Kl,Hi=Gn===0?po(be):0,Gn<bi-1?ha.push(C(S((ue-xo[Gn])/(Dt[Gn].split(" ").length-1)))):ha.push(0),R.push([Dt[Gn],Hi,Xi])}}var yu=typeof qe.R2L=="boolean"?qe.R2L:ge;yu===!0&&(R=is(R,function(In,Tn,Wn){return[In.split("").reverse().join(""),Tn,Wn]})),yt={text:R,x:be,y:De,options:qe,mutex:{pdfEscape:Rt,activeFontKey:Ye,fonts:ut,activeFontSize:ye}},Ve.publish("postProcessText",yt),R=yt.text,Or=yt.mutex.isHex||!1;var Kc=ut[Ye].encoding;Kc!=="WinAnsiEncoding"&&Kc!=="StandardEncoding"||(R=is(R,function(In,Tn,Wn){return[Bo(In),Tn,Wn]})),Dt=vi(R),R=[];for(var sl,al,ma,ll=0,Xl=1,cl=Array.isArray(Dt[0])?Xl:ll,fa="",Jc=function(In,Tn,Wn){var li="";return Wn instanceof bt?(Wn=typeof qe.angle=="number"?yr(Wn,new bt(1,0,0,1,In,Tn)):yr(new bt(1,0,0,1,In,Tn),Wn),K===Y.ADVANCED&&(Wn=yr(new bt(1,0,0,-1,0,0),Wn)),li=Wn.join(" ")+` Tm
`):li=C(In)+" "+C(Tn)+` Td
`,li},Ao=0;Ao<Dt.length;Ao++){switch(fa="",cl){case Xl:ma=(Or?"<":"(")+Dt[Ao][0]+(Or?">":")"),sl=parseFloat(Dt[Ao][1]),al=parseFloat(Dt[Ao][2]);break;case ll:ma=(Or?"<":"(")+Dt[Ao]+(Or?">":")"),sl=po(be),al=ai(De)}ha!==void 0&&ha[Ao]!==void 0&&(fa=ha[Ao]+` Tw
`),Ao===0?R.push(fa+Jc(sl,al,ct)+ma):cl===ll?R.push(fa+ma):cl===Xl&&R.push(fa+Jc(sl,al,ct)+ma)}R=cl===ll?R.join(` Tj
T* `):R.join(` Tj
`),R+=` Tj
`;var $o=`BT
/`;return $o+=Ye+" "+ye+` Tf
`,$o+=C(ye*fn)+` TL
`,$o+=Fo+`
`,$o+=tn,$o+=R,ee($o+="ET"),g[Ye]=!0,Ot};var Do=f.__private__.clip=f.clip=function(R){return ee(R==="evenodd"?"W*":"W"),this};f.clipEvenOdd=function(){return Do("evenodd")},f.__private__.discardPath=f.discardPath=function(){return ee("n"),this};var Ei=f.__private__.isValidStyle=function(R){var be=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(R)!==-1&&(be=!0),be};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(R){return Ei(R)&&(d=R),this};var Xo=f.__private__.getStyle=f.getStyle=function(R){var be=d;switch(R){case"D":case"S":be="S";break;case"F":be="f";break;case"FD":case"DF":be="B";break;case"f":case"f*":case"B":case"B*":be=R}return be},yi=f.close=function(){return ee("h"),this};f.stroke=function(){return ee("S"),this},f.fill=function(R){return wo("f",R),this},f.fillEvenOdd=function(R){return wo("f*",R),this},f.fillStroke=function(R){return wo("B",R),this},f.fillStrokeEvenOdd=function(R){return wo("B*",R),this};var wo=function(R,be){Pn(be)==="object"?es(be,R):ee(R)},xs=function(R){R===null||K===Y.ADVANCED&&R===void 0||(R=Xo(R),ee(R))};function Zo(R,be,De,qe,Ze){var yt=new xl(be||this.boundingBox,De||this.xStep,qe||this.yStep,this.gState,Ze||this.matrix);yt.stream=this.stream;var Dt=R+"$$"+this.cloneIndex+++"$$";return Kt(Dt,yt),yt}var es=function(R,be){var De=Fe[R.key],qe=dt[De];if(qe instanceof La)ee("q"),ee(ra(be)),qe.gState&&f.setGState(qe.gState),ee(R.matrix.toString()+" cm"),ee("/"+De+" sh"),ee("Q");else if(qe instanceof xl){var Ze=new bt(1,0,0,-1,0,Ii());R.matrix&&(Ze=Ze.multiply(R.matrix||Cr),De=Zo.call(qe,R.key,R.boundingBox,R.xStep,R.yStep,Ze).id),ee("q"),ee("/Pattern cs"),ee("/"+De+" scn"),qe.gState&&f.setGState(qe.gState),ee(be),ee("Q")}},ra=function(R){switch(R){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},uo=f.moveTo=function(R,be){return ee(C(S(R))+" "+C(z(be))+" m"),this},Ui=f.lineTo=function(R,be){return ee(C(S(R))+" "+C(z(be))+" l"),this},ho=f.curveTo=function(R,be,De,qe,Ze,yt){return ee([C(S(R)),C(z(be)),C(S(De)),C(z(qe)),C(S(Ze)),C(z(yt)),"c"].join(" ")),this};f.__private__.line=f.line=function(R,be,De,qe,Ze){if(isNaN(R)||isNaN(be)||isNaN(De)||isNaN(qe)||!Ei(Ze))throw new Error("Invalid arguments passed to jsPDF.line");return K===Y.COMPAT?this.lines([[De-R,qe-be]],R,be,[1,1],Ze||"S"):this.lines([[De-R,qe-be]],R,be,[1,1]).stroke()},f.__private__.lines=f.lines=function(R,be,De,qe,Ze,yt){var Dt,er,m,te,ue,Ce,Qe,ct,Ot,Fr,tn,Or;if(typeof R=="number"&&(Or=De,De=be,be=R,R=Or),qe=qe||[1,1],yt=yt||!1,isNaN(be)||isNaN(De)||!Array.isArray(R)||!Array.isArray(qe)||!Ei(Ze)||typeof yt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(uo(be,De),Dt=qe[0],er=qe[1],te=R.length,Fr=be,tn=De,m=0;m<te;m++)(ue=R[m]).length===2?(Fr=ue[0]*Dt+Fr,tn=ue[1]*er+tn,Ui(Fr,tn)):(Ce=ue[0]*Dt+Fr,Qe=ue[1]*er+tn,ct=ue[2]*Dt+Fr,Ot=ue[3]*er+tn,Fr=ue[4]*Dt+Fr,tn=ue[5]*er+tn,ho(Ce,Qe,ct,Ot,Fr,tn));return yt&&yi(),xs(Ze),this},f.path=function(R){for(var be=0;be<R.length;be++){var De=R[be],qe=De.c;switch(De.op){case"m":uo(qe[0],qe[1]);break;case"l":Ui(qe[0],qe[1]);break;case"c":ho.apply(this,qe);break;case"h":yi()}}return this},f.__private__.rect=f.rect=function(R,be,De,qe,Ze){if(isNaN(R)||isNaN(be)||isNaN(De)||isNaN(qe)||!Ei(Ze))throw new Error("Invalid arguments passed to jsPDF.rect");return K===Y.COMPAT&&(qe=-qe),ee([C(S(R)),C(z(be)),C(S(De)),C(S(qe)),"re"].join(" ")),xs(Ze),this},f.__private__.triangle=f.triangle=function(R,be,De,qe,Ze,yt,Dt){if(isNaN(R)||isNaN(be)||isNaN(De)||isNaN(qe)||isNaN(Ze)||isNaN(yt)||!Ei(Dt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[De-R,qe-be],[Ze-De,yt-qe],[R-Ze,be-yt]],R,be,[1,1],Dt,!0),this},f.__private__.roundedRect=f.roundedRect=function(R,be,De,qe,Ze,yt,Dt){if(isNaN(R)||isNaN(be)||isNaN(De)||isNaN(qe)||isNaN(Ze)||isNaN(yt)||!Ei(Dt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var er=4/3*(Math.SQRT2-1);return Ze=Math.min(Ze,.5*De),yt=Math.min(yt,.5*qe),this.lines([[De-2*Ze,0],[Ze*er,0,Ze,yt-yt*er,Ze,yt],[0,qe-2*yt],[0,yt*er,-Ze*er,yt,-Ze,yt],[2*Ze-De,0],[-Ze*er,0,-Ze,-yt*er,-Ze,-yt],[0,2*yt-qe],[0,-yt*er,Ze*er,-yt,Ze,-yt]],R+Ze,be,[1,1],Dt,!0),this},f.__private__.ellipse=f.ellipse=function(R,be,De,qe,Ze){if(isNaN(R)||isNaN(be)||isNaN(De)||isNaN(qe)||!Ei(Ze))throw new Error("Invalid arguments passed to jsPDF.ellipse");var yt=4/3*(Math.SQRT2-1)*De,Dt=4/3*(Math.SQRT2-1)*qe;return uo(R+De,be),ho(R+De,be-Dt,R+yt,be-qe,R,be-qe),ho(R-yt,be-qe,R-De,be-Dt,R-De,be),ho(R-De,be+Dt,R-yt,be+qe,R,be+qe),ho(R+yt,be+qe,R+De,be+Dt,R+De,be),xs(Ze),this},f.__private__.circle=f.circle=function(R,be,De,qe){if(isNaN(R)||isNaN(be)||isNaN(De)||!Ei(qe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(R,be,De,De,qe)},f.setFont=function(R,be,De){return De&&(be=J(be,De)),Ye=Wr(R,be,{disableWarning:!1}),this};var Mo=f.__private__.getFont=f.getFont=function(){return ut[Wr.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var R,be,De={};for(R in Ue)if(Ue.hasOwnProperty(R))for(be in De[R]=[],Ue[R])Ue[R].hasOwnProperty(be)&&De[R].push(be);return De},f.addFont=function(R,be,De,qe,Ze){var yt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&yt.indexOf(arguments[3])!==-1?Ze=arguments[3]:arguments[3]&&yt.indexOf(arguments[3])==-1&&(De=J(De,qe)),Ze=Ze||"Identity-H",Nt.call(this,R,be,De,Ze)};var an,el=t.lineWidth||.200025,na=f.__private__.getLineWidth=f.getLineWidth=function(){return el},tl=f.__private__.setLineWidth=f.setLineWidth=function(R){return el=R,ee(C(S(R))+" w"),this};f.__private__.setLineDash=Er.API.setLineDash=Er.API.setLineDashPattern=function(R,be){if(R=R||[],be=be||0,isNaN(be)||!Array.isArray(R))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return R=R.map(function(De){return C(S(De))}).join(" "),be=C(S(be)),ee("["+R+"] "+be+" d"),this};var rl=f.__private__.getLineHeight=f.getLineHeight=function(){return ye*an};f.__private__.getLineHeight=f.getLineHeight=function(){return ye*an};var nl=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(R){return typeof(R=R||1.15)=="number"&&(an=R),this},Cs=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return an};nl(t.lineHeight);var po=f.__private__.getHorizontalCoordinate=function(R){return S(R)},ai=f.__private__.getVerticalCoordinate=function(R){return K===Y.ADVANCED?R:nt[k].mediaBox.topRightY-nt[k].mediaBox.bottomLeftY-S(R)},zl=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(R){return C(po(R))},ts=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(R){return C(ai(R))},gi=t.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return ft(gi)},f.__private__.setStrokeColor=f.setDrawColor=function(R,be,De,qe){return gi=At({ch1:R,ch2:be,ch3:De,ch4:qe,pdfColorType:"draw",precision:2}),ee(gi),this};var ia=t.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return ft(ia)},f.__private__.setFillColor=f.setFillColor=function(R,be,De,qe){return ia=At({ch1:R,ch2:be,ch3:De,ch4:qe,pdfColorType:"fill",precision:2}),ee(ia),this};var Fo=t.textColor||"0 g",oa=f.__private__.getTextColor=f.getTextColor=function(){return ft(Fo)};f.__private__.setTextColor=f.setTextColor=function(R,be,De,qe){return Fo=At({ch1:R,ch2:be,ch3:De,ch4:qe,pdfColorType:"text",precision:3}),this};var As=t.charSpace,sa=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(As||0)};f.__private__.setCharSpace=f.setCharSpace=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return As=R,this};var il=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(R){var be=f.CapJoinStyles[R];if(be===void 0)throw new Error("Line cap style of '"+R+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return il=be,ee(be+" J"),this};var aa=0;f.__private__.setLineJoin=f.setLineJoin=function(R){var be=f.CapJoinStyles[R];if(be===void 0)throw new Error("Line join style of '"+R+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return aa=be,ee(be+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(R){if(R=R||0,isNaN(R))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ee(C(S(R))+" M"),this},f.GState=Qd,f.setGState=function(R){(R=typeof R=="string"?Be[Re[R]]:rs(null,R)).equals(lt)||(ee("/"+R.id+" gs"),lt=R)};var rs=function(R,be){if(!R||!Re[R]){var De=!1;for(var qe in Be)if(Be.hasOwnProperty(qe)&&Be[qe].equals(be)){De=!0;break}if(De)be=Be[qe];else{var Ze="GS"+(Object.keys(Be).length+1).toString(10);Be[Ze]=be,be.id=Ze}return R&&(Re[R]=be.id),Ve.publish("addGState",be),be}};f.addGState=function(R,be){return rs(R,be),this},f.saveGraphicsState=function(){return ee("q"),it.push({key:Ye,size:ye,color:Fo}),this},f.restoreGraphicsState=function(){ee("Q");var R=it.pop();return Ye=R.key,ye=R.size,Fo=R.color,lt=null,this},f.setCurrentTransformationMatrix=function(R){return ee(R.toString()+" cm"),this},f.comment=function(R){return ee("#"+R),this};var $s=function(R,be){var De=R||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return De},set:function(yt){isNaN(yt)||(De=parseFloat(yt))}});var qe=be||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return qe},set:function(yt){isNaN(yt)||(qe=parseFloat(yt))}});var Ze="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ze},set:function(yt){Ze=yt.toString()}}),this},la=function(R,be,De,qe){$s.call(this,R,be),this.type="rect";var Ze=De||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ze},set:function(Dt){isNaN(Dt)||(Ze=parseFloat(Dt))}});var yt=qe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return yt},set:function(Dt){isNaN(Dt)||(yt=parseFloat(Dt))}}),this},Es=function(){this.page=ot,this.currentPage=k,this.pages=G.slice(0),this.pagesContext=nt.slice(0),this.x=je,this.y=Xe,this.matrix=ht,this.width=ns(k),this.height=Ii(k),this.outputDestination=ie,this.id="",this.objectNumber=-1};Es.prototype.restore=function(){ot=this.page,k=this.currentPage,nt=this.pagesContext,G=this.pages,je=this.x,Xe=this.y,ht=this.matrix,da(k,this.width),ua(k,this.height),ie=this.outputDestination};var ca=function(R,be,De,qe,Ze){lr.push(new Es),ot=k=0,G=[],je=R,Xe=be,ht=Ze,vt([De,qe])},Ul=function(R){if(Qt[R])lr.pop().restore();else{var be=new Es,De="Xo"+(Object.keys(Mt).length+1).toString(10);be.id=De,Qt[R]=De,Mt[De]=be,Ve.publish("addFormObject",be),lr.pop().restore()}};for(var Oo in f.beginFormObject=function(R,be,De,qe,Ze){return ca(R,be,De,qe,Ze),this},f.endFormObject=function(R){return Ul(R),this},f.doFormObject=function(R,be){var De=Mt[Qt[R]];return ee("q"),ee(be.toString()+" cm"),ee("/"+De.id+" Do"),ee("Q"),this},f.getFormObject=function(R){var be=Mt[Qt[R]];return{x:be.x,y:be.y,width:be.width,height:be.height,matrix:be.matrix}},f.save=function(R,be){return R=R||"generated.pdf",(be=be||{}).returnPromise=be.returnPromise||!1,be.returnPromise===!1?(fl(wn(en()),R),typeof fl.unload=="function"&&kr.setTimeout&&setTimeout(fl.unload,911),this):new Promise(function(De,qe){try{var Ze=fl(wn(en()),R);typeof fl.unload=="function"&&kr.setTimeout&&setTimeout(fl.unload,911),De(Ze)}catch(yt){qe(yt.message)}})},Er.API)Er.API.hasOwnProperty(Oo)&&(Oo==="events"&&Er.API.events.length?function(R,be){var De,qe,Ze;for(Ze=be.length-1;Ze!==-1;Ze--)De=be[Ze][0],qe=be[Ze][1],R.subscribe.apply(R,[De].concat(typeof qe=="function"?[qe]:qe))}(Ve,Er.API.events):f[Oo]=Er.API[Oo]);var ns=f.getPageWidth=function(R){return(nt[R=R||k].mediaBox.topRightX-nt[R].mediaBox.bottomLeftX)/ze},da=f.setPageWidth=function(R,be){nt[R].mediaBox.topRightX=be*ze+nt[R].mediaBox.bottomLeftX},Ii=f.getPageHeight=function(R){return(nt[R=R||k].mediaBox.topRightY-nt[R].mediaBox.bottomLeftY)/ze},ua=f.setPageHeight=function(R,be){nt[R].mediaBox.topRightY=be*ze+nt[R].mediaBox.bottomLeftY};return f.internal={pdfEscape:Rt,getStyle:Xo,getFont:Mo,getFontSize:pe,getCharSpace:sa,getTextColor:oa,getLineHeight:rl,getLineHeightFactor:Cs,getLineWidth:na,write:de,getHorizontalCoordinate:po,getVerticalCoordinate:ai,getCoordinateString:zl,getVerticalCoordinateString:ts,collections:{},newObject:sr,newAdditionalObject:Vt,newObjectDeferred:pt,newObjectDeferredBegin:gt,getFilters:Yt,putStream:hr,events:Ve,scaleFactor:ze,pageSize:{getWidth:function(){return ns(k)},setWidth:function(R){da(k,R)},getHeight:function(){return Ii(k)},setHeight:function(R){ua(k,R)}},encryptionOptions:u,encryption:pn,getEncryptor:So,output:nr,getNumberOfPages:cr,pages:G,out:ee,f2:D,f3:b,getPageInfo:co,getPageInfoByObjId:Sr,getCurrentPageInfo:$i,getPDFVersion:E,Point:$s,Rectangle:la,Matrix:bt,hasHotfix:ei},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return ns(k)},set:function(R){da(k,R)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return Ii(k)},set:function(R){ua(k,R)},enumerable:!0,configurable:!0}),tr.call(f,le),Ye="F1",St(i,r),Ve.publish("initialized"),f}gc.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},gc.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},gc.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},gc.prototype.processOwnerPassword=function(t,e){return Gf(Hf(e).substr(0,5),t)},gc.prototype.encryptor=function(t,e){var r=Hf(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return Gf(r,n)}},Qd.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||Pn(t)!==Pn(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},Er.API={events:[]},Er.version="3.0.1";var Un=Er.API,cg=1,ql=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},lc=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Br=function(t){return t.toFixed(2)},Ia=function(t){return t.toFixed(5)};Un.__acroform__={};var lo=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},vb=function(t){return t*cg},cs=function(t){var e=new I_,r=fr.internal.getHeight(t)||0,n=fr.internal.getWidth(t)||0;return e.BBox=[0,0,Number(Br(n)),Number(Br(r))],e},rR=Un.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<e},nR=Un.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<e)},iR=Un.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(t&1<<e)==0?0:1},Kn=Un.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return iR(t,e-1)},Jn=Un.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return rR(t,e-1)},Qn=Un.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return nR(t,e-1)},oR=Un.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,i=t[0],o=t[1],s=t[2],l=t[3],c={};return c.lowerLeft_X=r(i)||0,c.lowerLeft_Y=n(o+l)||0,c.upperRight_X=r(i+s)||0,c.upperRight_Y=n(o)||0,[Number(Br(c.lowerLeft_X)),Number(Br(c.lowerLeft_Y)),Number(Br(c.upperRight_X)),Number(Br(c.upperRight_Y))]},sR=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=Wf(t,r),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+Br(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var o=cs(t);return o.scope=t.scope,o.stream=e.join(`
`),o}},Wf=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(b){return b.split(`
`)}):i.map(function(b){return[b]});var o=r,s=fr.internal.getHeight(t)||0;s=s<0?-s:s;var l=fr.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(b,S,v){if(b+1<i.length){var z=S+" "+i[b+1][0];return ih(z,t,v).width<=l-4}return!1};o++;e:for(;o>0;){e="",o--;var d,u,y=ih("3",t,o).height,g=t.multiline?s-o:(s-y)/2,f=g+=2,w=0,E=0,x=0;if(o<=0){e=`(...) Tj
`,e+="% Width of Text: "+ih(e,t,o=12).width+", FieldWidth:"+l+`
`;break}for(var T="",Y=0,K=0;K<i.length;K++)if(i.hasOwnProperty(K)){var j=!1;if(i[K].length!==1&&x!==i[K].length-1){if((y+2)*(Y+2)+2>s)continue e;T+=i[K][x],j=!0,E=K,K--}else{T=(T+=i[K][x]+" ").substr(T.length-1)==" "?T.substr(0,T.length-1):T;var q=parseInt(K),J=c(q,T,o),C=K>=i.length-1;if(J&&!C){T+=" ",x=0;continue}if(J||C){if(C)E=q;else if(t.multiline&&(y+2)*(Y+2)+2>s)continue e}else{if(!t.multiline||(y+2)*(Y+2)+2>s)continue e;E=q}}for(var P="",$=w;$<=E;$++){var D=i[$];if(t.multiline){if($===E){P+=D[x]+" ",x=(x+1)%D.length;continue}if($===w){P+=D[D.length-1]+" ";continue}}P+=D[0]+" "}switch(P=P.substr(P.length-1)==" "?P.substr(0,P.length-1):P,u=ih(P,t,o).width,t.textAlign){case"right":d=l-u-2;break;case"center":d=(l-u)/2;break;case"left":default:d=2}e+=Br(d)+" "+Br(f)+` Td
`,e+="("+ql(P)+`) Tj
`,e+=-Br(d)+` 0 Td
`,f=-(o+2),u=0,w=j?E:E+1,Y++,T=""}break}return n.text=e,n.fontSize=o,n},ih=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},aR={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},lR=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},cR=function(t,e){for(var r in t)if(t.hasOwnProperty(r)){var n=r,i=t[r];e.internal.newObjectDeferredBegin(i.objId,!0),Pn(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete t[n]}},dR=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Jo.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(aR)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");cg=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new T_,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var o=n[i];o.objId=void 0,o.hasAnnotation&&lR(o,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,i){var o=!n;for(var s in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var l=n[s],c=[],d=l.Rect;if(l.Rect&&(l.Rect=oR(l.Rect,i)),i.internal.newObjectDeferredBegin(l.objId,!0),l.DA=fr.createDefaultAppearanceStream(l),Pn(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=d,l.hasAppearanceStream&&!l.appearanceStreamContent){var u=sR(l);c.push({key:"AP",value:"<</N "+u+">>"}),i.internal.acroformPlugin.xForms.push(u)}if(l.appearanceStreamContent){var y="";for(var g in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(g)){var f=l.appearanceStreamContent[g];if(y+="/"+g+" ",y+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var s in f)if(f.hasOwnProperty(s)){var w=f[s];typeof w=="function"&&(w=w.call(i,l)),y+="/"+s+" "+w+" ",i.internal.acroformPlugin.xForms.indexOf(w)>=0||i.internal.acroformPlugin.xForms.push(w)}}else typeof(w=f)=="function"&&(w=w.call(i,l)),y+="/"+s+" "+w,i.internal.acroformPlugin.xForms.indexOf(w)>=0||i.internal.acroformPlugin.xForms.push(w);y+=">>"}c.push({key:"AP",value:`<<
`+y+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:l.objId}),i.internal.out("endobj")}o&&cR(i.internal.acroformPlugin.xForms,i)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},E_=Un.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(s){return s};if(Array.isArray(t)){for(var i="[",o=0;o<t.length;o++)switch(o!==0&&(i+=" "),Pn(t[o])){case"boolean":case"number":case"object":i+=t[o].toString();break;case"string":t[o].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),i+="("+ql(n(t[o].toString()))+")"):i+=t[o].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Vm=function(t,e,r){var n=function(i){return i};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),t="("+ql(n(t))+")"},hs=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};hs.prototype.toString=function(){return this.objId+" 0 R"},hs.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},hs.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],i=this[n];i&&(Array.isArray(i)?t.push({key:n,value:E_(i,this.objId,this.scope)}):i instanceof hs?(i.scope=this.scope,t.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:n,value:i}))}return t};var I_=function(){hs.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};lo(I_,hs);var T_=function(){hs.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+ql(r(t))+")"}},set:function(r){t=r}})};lo(T_,hs);var Jo=function t(){hs.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(T){if(isNaN(T))throw new Error('Invalid value "'+T+'" for attribute F supplied.');e=T}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Kn(e,3)},set:function(T){T?this.F=Jn(e,3):this.F=Qn(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(T){if(isNaN(T))throw new Error('Invalid value "'+T+'" for attribute Ff supplied.');r=T}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(T){n=T!==void 0?T:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(T){n[0]=T}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(T){n[1]=T}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(T){n[2]=T}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(T){n[3]=T}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(T){switch(T){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=T;break;default:throw new Error('Invalid value "'+T+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof tp)return;o="FieldObject"+t.FieldNum++}var T=function(Y){return Y};return this.scope&&(T=this.scope.internal.getEncryptor(this.objId)),"("+ql(T(o))+")"},set:function(T){o=T.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(T){o=T}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(T){s=T}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(T){l=T}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(T){c=T}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/cg:d},set:function(T){d=T}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(T){u=T}});var y="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!y||this instanceof tp||this instanceof za))return Vm(y,this.objId,this.scope)},set:function(T){T=T.toString(),y=T}});var g=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof di?g:Vm(g,this.objId,this.scope)},set:function(T){T=T.toString(),g=this instanceof di?T:T.substr(0,1)==="("?lc(T.substr(1,T.length-2)):lc(T)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof di?lc(g.substr(1,g.length-1)):g},set:function(T){T=T.toString(),g=this instanceof di?"/"+T:T}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(T){this.V=T}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof di?f:Vm(f,this.objId,this.scope)},set:function(T){T=T.toString(),f=this instanceof di?T:T.substr(0,1)==="("?lc(T.substr(1,T.length-2)):lc(T)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof di?lc(f.substr(1,f.length-1)):f},set:function(T){T=T.toString(),f=this instanceof di?"/"+T:T}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var w,E=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return E},set:function(T){T=!!T,E=T}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(w)return w},set:function(T){w=T}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Kn(this.Ff,1)},set:function(T){T?this.Ff=Jn(this.Ff,1):this.Ff=Qn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Kn(this.Ff,2)},set:function(T){T?this.Ff=Jn(this.Ff,2):this.Ff=Qn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Kn(this.Ff,3)},set:function(T){T?this.Ff=Jn(this.Ff,3):this.Ff=Qn(this.Ff,3)}});var x=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(x!==null)return x},set:function(T){if([0,1,2].indexOf(T)===-1)throw new Error('Invalid value "'+T+'" for attribute Q supplied.');x=T}}),Object.defineProperty(this,"textAlign",{get:function(){var T;switch(x){case 0:default:T="left";break;case 1:T="center";break;case 2:T="right"}return T},configurable:!0,enumerable:!0,set:function(T){switch(T){case"right":case 2:x=2;break;case"center":case 1:x=1;break;case"left":case 0:default:x=0}}})};lo(Jo,hs);var $l=function(){Jo.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return E_(e,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=function(o,s,l){l||(l=1);for(var c,d=[];c=s.exec(o);)d.push(c[l]);return d}(n,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Kn(this.Ff,18)},set:function(r){r?this.Ff=Jn(this.Ff,18):this.Ff=Qn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Kn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Jn(this.Ff,19):this.Ff=Qn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Kn(this.Ff,20)},set:function(r){r?(this.Ff=Jn(this.Ff,20),e.sort()):this.Ff=Qn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Kn(this.Ff,22)},set:function(r){r?this.Ff=Jn(this.Ff,22):this.Ff=Qn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Kn(this.Ff,23)},set:function(r){r?this.Ff=Jn(this.Ff,23):this.Ff=Qn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Kn(this.Ff,27)},set:function(r){r?this.Ff=Jn(this.Ff,27):this.Ff=Qn(this.Ff,27)}}),this.hasAppearanceStream=!1};lo($l,Jo);var El=function(){$l.call(this),this.fontName="helvetica",this.combo=!1};lo(El,$l);var Il=function(){El.call(this),this.combo=!0};lo(Il,El);var kd=function(){Il.call(this),this.edit=!0};lo(kd,Il);var di=function(){Jo.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Kn(this.Ff,15)},set:function(r){r?this.Ff=Jn(this.Ff,15):this.Ff=Qn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Kn(this.Ff,16)},set:function(r){r?this.Ff=Jn(this.Ff,16):this.Ff=Qn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Kn(this.Ff,17)},set:function(r){r?this.Ff=Jn(this.Ff,17):this.Ff=Qn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Kn(this.Ff,26)},set:function(r){r?this.Ff=Jn(this.Ff,26):this.Ff=Qn(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(o){return o};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,i=[];for(n in i.push("<<"),e)i.push("/"+n+" ("+ql(r(e[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){Pn(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};lo(di,Jo);var Nd=function(){di.call(this),this.pushButton=!0};lo(Nd,di);var Tl=function(){di.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};lo(Tl,di);var tp=function(){var t,e;Jo.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(l){return l};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var o,s=[];for(o in s.push("<<"),n)s.push("/"+o+" ("+ql(i(n[o]))+")");return s.push(">>"),s.join(`
`)},set:function(i){Pn(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=fr.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};lo(tp,Jo),Tl.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},Tl.prototype.createOption=function(t){var e=new tp;return e.Parent=this,e.optionName=t,this.Kids.push(e),uR.call(this.scope,e),e};var Ld=function(){di.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=fr.CheckBox.createAppearanceStream()};lo(Ld,di);var za=function(){Jo.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Kn(this.Ff,13)},set:function(e){e?this.Ff=Jn(this.Ff,13):this.Ff=Qn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Kn(this.Ff,21)},set:function(e){e?this.Ff=Jn(this.Ff,21):this.Ff=Qn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Kn(this.Ff,23)},set:function(e){e?this.Ff=Jn(this.Ff,23):this.Ff=Qn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Kn(this.Ff,24)},set:function(e){e?this.Ff=Jn(this.Ff,24):this.Ff=Qn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Kn(this.Ff,25)},set:function(e){e?this.Ff=Jn(this.Ff,25):this.Ff=Qn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Kn(this.Ff,26)},set:function(e){e?this.Ff=Jn(this.Ff,26):this.Ff=Qn(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};lo(za,Jo);var Rd=function(){za.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Kn(this.Ff,14)},set:function(t){t?this.Ff=Jn(this.Ff,14):this.Ff=Qn(this.Ff,14)}}),this.password=!0};lo(Rd,za);var fr={CheckBox:{createAppearanceStream:function(){return{N:{On:fr.CheckBox.YesNormal},D:{On:fr.CheckBox.YesPushDown,Off:fr.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=cs(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),o=Wf(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+Br(fr.internal.getWidth(t))+" "+Br(fr.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Br(o.fontSize)+" Tf "+i),r.push("BT"),r.push(o.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=cs(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),i=[],o=fr.internal.getHeight(t),s=fr.internal.getWidth(t),l=Wf(t,t.caption);return i.push("1 g"),i.push("0 0 "+Br(s)+" "+Br(o)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Br(s-1)+" "+Br(o-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+Br(l.fontSize)+" Tf "+n),i.push(l.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=cs(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Br(fr.internal.getWidth(t))+" "+Br(fr.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:fr.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=fr.RadioButton.Circle.YesNormal,e.D[t]=fr.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=cs(t);e.scope=t.scope;var r=[],n=fr.internal.getWidth(t)<=fr.internal.getHeight(t)?fr.internal.getWidth(t)/4:fr.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=fr.internal.Bezier_C,o=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Ia(fr.internal.getWidth(t)/2)+" "+Ia(fr.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=cs(t);e.scope=t.scope;var r=[],n=fr.internal.getWidth(t)<=fr.internal.getHeight(t)?fr.internal.getWidth(t)/4:fr.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),o=Number((i*fr.internal.Bezier_C).toFixed(5)),s=Number((n*fr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Ia(fr.internal.getWidth(t)/2)+" "+Ia(fr.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),r.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),r.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),r.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Ia(fr.internal.getWidth(t)/2)+" "+Ia(fr.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=cs(t);e.scope=t.scope;var r=[],n=fr.internal.getWidth(t)<=fr.internal.getHeight(t)?fr.internal.getWidth(t)/4:fr.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),o=Number((i*fr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Ia(fr.internal.getWidth(t)/2)+" "+Ia(fr.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),r.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),r.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),r.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:fr.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=fr.RadioButton.Cross.YesNormal,e.D[t]=fr.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=cs(t);e.scope=t.scope;var r=[],n=fr.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+Br(fr.internal.getWidth(t)-2)+" "+Br(fr.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(Br(n.x1.x)+" "+Br(n.x1.y)+" m"),r.push(Br(n.x2.x)+" "+Br(n.x2.y)+" l"),r.push(Br(n.x4.x)+" "+Br(n.x4.y)+" m"),r.push(Br(n.x3.x)+" "+Br(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=cs(t);e.scope=t.scope;var r=fr.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+Br(fr.internal.getWidth(t))+" "+Br(fr.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Br(fr.internal.getWidth(t)-2)+" "+Br(fr.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(Br(r.x1.x)+" "+Br(r.x1.y)+" m"),n.push(Br(r.x2.x)+" "+Br(r.x2.y)+" l"),n.push(Br(r.x4.x)+" "+Br(r.x4.y)+" m"),n.push(Br(r.x3.x)+" "+Br(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=cs(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Br(fr.internal.getWidth(t))+" "+Br(fr.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};fr.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=fr.internal.getWidth(t),r=fr.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},fr.internal.getWidth=function(t){var e=0;return Pn(t)==="object"&&(e=vb(t.Rect[2])),e},fr.internal.getHeight=function(t){var e=0;return Pn(t)==="object"&&(e=vb(t.Rect[3])),e};var uR=Un.addField=function(t){if(dR(this,t),!(t instanceof Jo))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Un.AcroFormChoiceField=$l,Un.AcroFormListBox=El,Un.AcroFormComboBox=Il,Un.AcroFormEditBox=kd,Un.AcroFormButton=di,Un.AcroFormPushButton=Nd,Un.AcroFormRadioButton=Tl,Un.AcroFormCheckBox=Ld,Un.AcroFormTextField=za,Un.AcroFormPasswordField=Rd,Un.AcroFormAppearance=fr,Un.AcroForm={ChoiceField:$l,ListBox:El,ComboBox:Il,EditBox:kd,Button:di,PushButton:Nd,RadioButton:Tl,CheckBox:Ld,TextField:za,PasswordField:Rd,Appearance:fr},Er.AcroForm={ChoiceField:$l,ListBox:El,ComboBox:Il,EditBox:kd,Button:di,PushButton:Nd,RadioButton:Tl,CheckBox:Ld,TextField:za,PasswordField:Rd,Appearance:fr};var hR=Er.AcroForm;function k_(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){t.__addimage__={};var e="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=t.__addimage__.getImageFileTypeByImageData=function(b,S){var v,z,re,L,O,ne=e;if((S=S||e)==="RGBA"||b.data!==void 0&&b.data instanceof Uint8ClampedArray&&"height"in b&&"width"in b)return"RGBA";if(J(b))for(O in r)for(re=r[O],v=0;v<re.length;v+=1){for(L=!0,z=0;z<re[v].length;z+=1)if(re[v][z]!==void 0&&re[v][z]!==b[z]){L=!1;break}if(L===!0){ne=O;break}}else for(O in r)for(re=r[O],v=0;v<re.length;v+=1){for(L=!0,z=0;z<re[v].length;z+=1)if(re[v][z]!==void 0&&re[v][z]!==b.charCodeAt(z)){L=!1;break}if(L===!0){ne=O;break}}return ne===e&&S!==e&&(ne=S),ne},i=function b(S){for(var v=this.internal.write,z=this.internal.putStream,re=(0,this.internal.getFilters)();re.indexOf("FlateEncode")!==-1;)re.splice(re.indexOf("FlateEncode"),1);S.objectId=this.internal.newObject();var L=[];if(L.push({key:"Type",value:"/XObject"}),L.push({key:"Subtype",value:"/Image"}),L.push({key:"Width",value:S.width}),L.push({key:"Height",value:S.height}),S.colorSpace===x.INDEXED?L.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(S.palette.length/3-1)+" "+("sMask"in S&&S.sMask!==void 0?S.objectId+2:S.objectId+1)+" 0 R]"}):(L.push({key:"ColorSpace",value:"/"+S.colorSpace}),S.colorSpace===x.DEVICE_CMYK&&L.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),L.push({key:"BitsPerComponent",value:S.bitsPerComponent}),"decodeParameters"in S&&S.decodeParameters!==void 0&&L.push({key:"DecodeParms",value:"<<"+S.decodeParameters+">>"}),"transparency"in S&&Array.isArray(S.transparency)){for(var O="",ne=0,X=S.transparency.length;ne<X;ne++)O+=S.transparency[ne]+" "+S.transparency[ne]+" ";L.push({key:"Mask",value:"["+O+"]"})}S.sMask!==void 0&&L.push({key:"SMask",value:S.objectId+1+" 0 R"});var W=S.filter!==void 0?["/"+S.filter]:void 0;if(z({data:S.data,additionalKeyValues:L,alreadyAppliedFilters:W,objectId:S.objectId}),v("endobj"),"sMask"in S&&S.sMask!==void 0){var se="/Predictor "+S.predictor+" /Colors 1 /BitsPerComponent "+S.bitsPerComponent+" /Columns "+S.width,F={width:S.width,height:S.height,colorSpace:"DeviceGray",bitsPerComponent:S.bitsPerComponent,decodeParameters:se,data:S.sMask};"filter"in S&&(F.filter=S.filter),b.call(this,F)}if(S.colorSpace===x.INDEXED){var k=this.internal.newObject();z({data:P(new Uint8Array(S.palette)),objectId:k}),v("endobj")}},o=function(){var b=this.internal.collections.addImage_images;for(var S in b)i.call(this,b[S])},s=function(){var b,S=this.internal.collections.addImage_images,v=this.internal.write;for(var z in S)v("/I"+(b=S[z]).index,b.objectId,"0","R")},l=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",s))},c=function(){var b=this.internal.collections.addImage_images;return l.call(this),b},d=function(){return Object.keys(this.internal.collections.addImage_images).length},u=function(b){return typeof t["process"+b.toUpperCase()]=="function"},y=function(b){return Pn(b)==="object"&&b.nodeType===1},g=function(b,S){if(b.nodeName==="IMG"&&b.hasAttribute("src")){var v=""+b.getAttribute("src");if(v.indexOf("data:image/")===0)return Td(unescape(v).split("base64,").pop());var z=t.loadFile(v,!0);if(z!==void 0)return z}if(b.nodeName==="CANVAS"){if(b.width===0||b.height===0)throw new Error("Given canvas must have data. Canvas width: "+b.width+", height: "+b.height);var re;switch(S){case"PNG":re="image/png";break;case"WEBP":re="image/webp";break;case"JPEG":case"JPG":default:re="image/jpeg"}return Td(b.toDataURL(re,1).split("base64,").pop())}},f=function(b){var S=this.internal.collections.addImage_images;if(S){for(var v in S)if(b===S[v].alias)return S[v]}},w=function(b,S,v){return b||S||(b=-96,S=-96),b<0&&(b=-1*v.width*72/b/this.internal.scaleFactor),S<0&&(S=-1*v.height*72/S/this.internal.scaleFactor),b===0&&(b=S*v.width/v.height),S===0&&(S=b*v.height/v.width),[b,S]},E=function(b,S,v,z,re,L){var O=w.call(this,v,z,re),ne=this.internal.getCoordinateString,X=this.internal.getVerticalCoordinateString,W=c.call(this);if(v=O[0],z=O[1],W[re.index]=re,L){L*=Math.PI/180;var se=Math.cos(L),F=Math.sin(L),k=function(A){return A.toFixed(4)},N=[k(se),k(F),k(-1*F),k(se),0,0,"cm"]}this.internal.write("q"),L?(this.internal.write([1,"0","0",1,ne(b),X(S+z),"cm"].join(" ")),this.internal.write(N.join(" ")),this.internal.write([ne(v),"0","0",ne(z),"0","0","cm"].join(" "))):this.internal.write([ne(v),"0","0",ne(z),ne(b),X(S+z),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+re.index+" Do"),this.internal.write("Q")},x=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var T=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},Y=t.__addimage__.sHashCode=function(b){var S,v,z=0;if(typeof b=="string")for(v=b.length,S=0;S<v;S++)z=(z<<5)-z+b.charCodeAt(S),z|=0;else if(J(b))for(v=b.byteLength/2,S=0;S<v;S++)z=(z<<5)-z+b[S],z|=0;return z},K=t.__addimage__.validateStringAsBase64=function(b){(b=b||"").toString().trim();var S=!0;return b.length===0&&(S=!1),b.length%4!=0&&(S=!1),/^[A-Za-z0-9+/]+$/.test(b.substr(0,b.length-2))===!1&&(S=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(b.substr(-2))===!1&&(S=!1),S},j=t.__addimage__.extractImageFromDataUrl=function(b){if(b==null||!(b=b.trim()).startsWith("data:"))return null;var S=b.indexOf(",");return S<0?null:b.substring(0,S).trim().endsWith("base64")?b.substring(S+1):null},q=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(b){return q()&&b instanceof ArrayBuffer};var J=t.__addimage__.isArrayBufferView=function(b){return q()&&typeof Uint32Array<"u"&&(b instanceof Int8Array||b instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&b instanceof Uint8ClampedArray||b instanceof Int16Array||b instanceof Uint16Array||b instanceof Int32Array||b instanceof Uint32Array||b instanceof Float32Array||b instanceof Float64Array)},C=t.__addimage__.binaryStringToUint8Array=function(b){for(var S=b.length,v=new Uint8Array(S),z=0;z<S;z++)v[z]=b.charCodeAt(z);return v},P=t.__addimage__.arrayBufferToBinaryString=function(b){for(var S="",v=J(b)?b:new Uint8Array(b),z=0;z<v.length;z+=8192)S+=String.fromCharCode.apply(null,v.subarray(z,z+8192));return S};t.addImage=function(){var b,S,v,z,re,L,O,ne,X;if(typeof arguments[1]=="number"?(S=e,v=arguments[1],z=arguments[2],re=arguments[3],L=arguments[4],O=arguments[5],ne=arguments[6],X=arguments[7]):(S=arguments[1],v=arguments[2],z=arguments[3],re=arguments[4],L=arguments[5],O=arguments[6],ne=arguments[7],X=arguments[8]),Pn(b=arguments[0])==="object"&&!y(b)&&"imageData"in b){var W=b;b=W.imageData,S=W.format||S||e,v=W.x||v||0,z=W.y||z||0,re=W.w||W.width||re,L=W.h||W.height||L,O=W.alias||O,ne=W.compression||ne,X=W.rotation||W.angle||X}var se=this.internal.getFilters();if(ne===void 0&&se.indexOf("FlateEncode")!==-1&&(ne="SLOW"),isNaN(v)||isNaN(z))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var F=$.call(this,b,S,O,ne);return E.call(this,v,z,re,L,F,X),this};var $=function(b,S,v,z){var re,L,O;if(typeof b=="string"&&n(b)===e){b=unescape(b);var ne=D(b,!1);(ne!==""||(ne=t.loadFile(b,!0))!==void 0)&&(b=ne)}if(y(b)&&(b=g(b,S)),S=n(b,S),!u(S))throw new Error("addImage does not support files of type '"+S+"', please ensure that a plugin for '"+S+"' support is added.");if(((O=v)==null||O.length===0)&&(v=function(X){return typeof X=="string"||J(X)?Y(X):J(X.data)?Y(X.data):null}(b)),(re=f.call(this,v))||(q()&&(b instanceof Uint8Array||S==="RGBA"||(L=b,b=C(b))),re=this["process"+S.toUpperCase()](b,d.call(this),v,function(X){return X&&typeof X=="string"&&(X=X.toUpperCase()),X in t.image_compression?X:T.NONE}(z),L)),!re)throw new Error("An unknown error occurred whilst processing the image.");return re},D=t.__addimage__.convertBase64ToBinaryString=function(b,S){S=typeof S!="boolean"||S;var v,z="";if(typeof b=="string"){var re;v=(re=j(b))!==null&&re!==void 0?re:b;try{z=Td(v)}catch(L){if(S)throw K(v)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+L.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return z};t.getImageProperties=function(b){var S,v,z="";if(y(b)&&(b=g(b)),typeof b=="string"&&n(b)===e&&((z=D(b,!1))===""&&(z=t.loadFile(b)||""),b=z),v=n(b),!u(v))throw new Error("addImage does not support files of type '"+v+"', please ensure that a plugin for '"+v+"' support is added.");if(!q()||b instanceof Uint8Array||(b=C(b)),!(S=this["process"+v.toUpperCase()](b)))throw new Error("An unknown error occurred whilst processing the image");return S.fileType=v,S}})(Er.API),function(t){var e=function(r){if(r!==void 0&&r!="")return!0};Er.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,i,o,s=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),d=r.pageContext.annotations,u=!1,y=0;y<d.length&&!u;y++)switch((n=d[y]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var g=0;g<d.length;g++){n=d[g];var f=this.internal.pdfEscape,w=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var E=this.internal.newAdditionalObject(),x=this.internal.newAdditionalObject(),T=this.internal.getEncryptor(E.objId),Y=n.title||"Note";o="<</Type /Annot /Subtype /Text "+(i="/Rect ["+s(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+f(T(n.contents))+")",o+=" /Popup "+x.objId+" 0 R",o+=" /P "+c.objId+" 0 R",o+=" /T ("+f(T(Y))+") >>",E.content=o;var K=E.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+s(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+K,n.open&&(o+=" /Open true"),o+=" >>",x.content=o,this.internal.write(E.objId,"0 R",x.objId,"0 R");break;case"freetext":i="/Rect ["+s(n.bounds.x)+" "+l(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var j=n.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+f(w(n.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+j+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(n.options.name){var q=this.annotations._nameMap[n.options.name];n.options.pageNumber=q.page,n.options.top=q.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",o="",n.options.url)o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+f(w(n.options.url))+") >>";else if(n.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,o+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var J=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),o+=" /XYZ "+n.options.left+" "+J+" "+n.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,i,o,s){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:d(n),w:c(r+i),h:d(n+o)},options:s,type:"link"})},t.textWithLink=function(r,n,i,o){var s,l,c=this.getTextWidth(r),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){l=o.maxWidth;var u=this.splitTextToSize(r,l).length;s=Math.ceil(d*u)}else l=c,s=d;return this.text(r,n,i,o),i+=.2*d,o.align==="center"&&(n-=c/2),o.align==="right"&&(n-=c),this.link(n,i-d,l,s,o),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(Er.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var o=t.__arabicParser__.isInArabicSubstitutionA=function(E){return e[E.charCodeAt(0)]!==void 0},s=t.__arabicParser__.isArabicLetter=function(E){return typeof E=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(E)},l=t.__arabicParser__.isArabicEndLetter=function(E){return s(E)&&o(E)&&e[E.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(E){return s(E)&&i.indexOf(E.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(E){return s(E)&&o(E)&&e[E.charCodeAt(0)].length>=1};var d=t.__arabicParser__.arabicLetterHasFinalForm=function(E){return s(E)&&o(E)&&e[E.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(E){return s(E)&&o(E)&&e[E.charCodeAt(0)].length>=3};var u=t.__arabicParser__.arabicLetterHasMedialForm=function(E){return s(E)&&o(E)&&e[E.charCodeAt(0)].length==4},y=t.__arabicParser__.resolveLigatures=function(E){var x=0,T=r,Y="",K=0;for(x=0;x<E.length;x+=1)T[E.charCodeAt(x)]!==void 0?(K++,typeof(T=T[E.charCodeAt(x)])=="number"&&(Y+=String.fromCharCode(T),T=r,K=0),x===E.length-1&&(T=r,Y+=E.charAt(x-(K-1)),x-=K-1,K=0)):(T=r,Y+=E.charAt(x-K),x-=K,K=0);return Y};t.__arabicParser__.isArabicDiacritic=function(E){return E!==void 0&&n[E.charCodeAt(0)]!==void 0};var g=t.__arabicParser__.getCorrectForm=function(E,x,T){return s(E)?o(E)===!1?-1:!d(E)||!s(x)&&!s(T)||!s(T)&&l(x)||l(E)&&!s(x)||l(E)&&c(x)||l(E)&&l(x)?0:u(E)&&s(x)&&!l(x)&&s(T)&&d(T)?3:l(E)||!s(T)?1:2:-1},f=function(E){var x=0,T=0,Y=0,K="",j="",q="",J=(E=E||"").split("\\s+"),C=[];for(x=0;x<J.length;x+=1){for(C.push(""),T=0;T<J[x].length;T+=1)K=J[x][T],j=J[x][T-1],q=J[x][T+1],s(K)?(Y=g(K,j,q),C[x]+=Y!==-1?String.fromCharCode(e[K.charCodeAt(0)][Y]):K):C[x]+=K;C[x]=y(C[x])}return C.join(" ")},w=t.__arabicParser__.processArabic=t.processArabic=function(){var E,x=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,T=[];if(Array.isArray(x)){var Y=0;for(T=[],Y=0;Y<x.length;Y+=1)Array.isArray(x[Y])?T.push([f(x[Y][0]),x[Y][1],x[Y][2]]):T.push([f(x[Y])]);E=T}else E=f(x);return typeof arguments[0]=="string"?E:(arguments[0].text=E,arguments[0])};t.events.push(["preProcessText",w])}(Er.API),Er.API.autoPrint=function(t){var e;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(l){i=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(l){o=l}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(l){s=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(Er.API),function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(E){c=E}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(E){d=E}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(E){u=E}});var y=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return y},set:function(E){y=E}});var g=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return g},set:function(E){g=E}});var f=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return f},set:function(E){f=E}});var w=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return w},set:function(E){w=E}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,d){n.call(this);var u=(d=d||{}).fontSize||this.getFontSize(),y=d.font||this.getFont(),g=d.scaleFactor||this.internal.scaleFactor,f=0,w=0,E=0,x=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var T=d.maxWidth;T>0?typeof c=="string"?c=this.splitTextToSize(c,T):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(K,j){return K.concat(x.splitTextToSize(j,T))},[])):c=Array.isArray(c)?c:[c];for(var Y=0;Y<c.length;Y++)f<(E=this.getStringUnitWidth(c[Y],{font:y})*u)&&(f=E);return f!==0&&(w=c.length),{w:f/=g,h:Math.max((w*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/g,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new o(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=t.cell=function(){var c;c=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var d=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,y=this.internal.__cell__.margins||e,g=this.internal.__cell__.tableHeaderRow,f=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===c.lineNumber?(c.x=(d.x||0)+(d.width||0),c.y=d.y||0):d.y+d.height+c.height+y.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=y.top,f&&g&&(this.printHeaderRow(c.lineNumber,!0),c.y+=g[0].height)):c.y=d.y+d.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};t.table=function(c,d,u,y,g){if(n.call(this),!u)throw new Error("No data for PDF table.");var f,w,E,x,T=[],Y=[],K=[],j={},q={},J=[],C=[],P=(g=g||{}).autoSize||!1,$=g.printHeaders!==!1,D=g.css&&g.css["font-size"]!==void 0?16*g.css["font-size"]:g.fontSize||12,b=g.margins||Object.assign({width:this.getPageWidth()},e),S=typeof g.padding=="number"?g.padding:3,v=g.headerBackgroundColor||"#c8c8c8",z=g.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=$,this.internal.__cell__.margins=b,this.internal.__cell__.table_font_size=D,this.internal.__cell__.padding=S,this.internal.__cell__.headerBackgroundColor=v,this.internal.__cell__.headerTextColor=z,this.setFontSize(D),y==null)Y=T=Object.keys(u[0]),K=T.map(function(){return"left"});else if(Array.isArray(y)&&Pn(y[0])==="object")for(T=y.map(function(W){return W.name}),Y=y.map(function(W){return W.prompt||W.name||""}),K=y.map(function(W){return W.align||"left"}),f=0;f<y.length;f+=1)q[y[f].name]=y[f].width*(19.049976/25.4);else Array.isArray(y)&&typeof y[0]=="string"&&(Y=T=y,K=T.map(function(){return"left"}));if(P||Array.isArray(y)&&typeof y[0]=="string")for(f=0;f<T.length;f+=1){for(j[x=T[f]]=u.map(function(W){return W[x]}),this.setFont(void 0,"bold"),J.push(this.getTextDimensions(Y[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),w=j[x],this.setFont(void 0,"normal"),E=0;E<w.length;E+=1)J.push(this.getTextDimensions(w[E],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);q[x]=Math.max.apply(null,J)+S+S,J=[]}if($){var re={};for(f=0;f<T.length;f+=1)re[T[f]]={},re[T[f]].text=Y[f],re[T[f]].align=K[f];var L=l.call(this,re,q);C=T.map(function(W){return new o(c,d,q[W],L,re[W].text,void 0,re[W].align)}),this.setTableHeaderRow(C),this.printHeaderRow(1,!1)}var O=y.reduce(function(W,se){return W[se.name]=se.align,W},{});for(f=0;f<u.length;f+=1){"rowStart"in g&&g.rowStart instanceof Function&&g.rowStart({row:f,data:u[f]},this);var ne=l.call(this,u[f],q);for(E=0;E<T.length;E+=1){var X=u[f][T[E]];"cellStart"in g&&g.cellStart instanceof Function&&g.cellStart({row:f,col:E,data:X},this),s.call(this,new o(c,d,q[T[E]],ne,X,f+2,O[T[E]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=d,this};var l=function(c,d){var u=this.internal.__cell__.padding,y=this.internal.__cell__.table_font_size,g=this.internal.scaleFactor;return Object.keys(c).map(function(f){var w=c[f];return this.splitTextToSize(w.hasOwnProperty("text")?w.text:w,d[f]-u-u)},this).map(function(f){return this.getLineHeightFactor()*f.length*y/g+u+u},this).reduce(function(f,w){return Math.max(f,w)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,d){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var y=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(y[0],y[1],y[2],y[3],void 0,-1)}this.setFont(void 0,"bold");for(var g=[],f=0;f<this.internal.__cell__.tableHeaderRow.length;f+=1){u=this.internal.__cell__.tableHeaderRow[f].clone(),d&&(u.y=this.internal.__cell__.margins.top||0,g.push(u)),u.lineNumber=c;var w=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,u),this.setTextColor(w)}g.length>0&&this.setTableHeaderRow(g),this.setFont(void 0,"normal"),r=!1}}(Er.API);var N_={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},L_=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Yf=k_(L_),R_=[100,200,300,400,500,600,700,800,900],pR=k_(R_);function Kf(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=function(o){return N_[o=o||"normal"]?o:"normal"}(t.style),n=function(o){if(!o)return 400;if(typeof o=="number")return o>=100&&o<=900&&o%100==0?o:400;if(/^\d00$/.test(o))return parseInt(o);switch(o){case"bold":return 700;case"normal":default:return 400}}(t.weight),i=function(o){return typeof Yf[o=o||"normal"]=="number"?o:"normal"}(t.stretch);return{family:e,style:r,weight:n,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,r,n].join(" ")}}}function bb(t,e,r,n){var i;for(i=r;i>=0&&i<e.length;i+=n)if(t[e[i]])return t[e[i]];for(i=r;i>=0&&i<e.length;i-=n)if(t[e[i]])return t[e[i]]}var mR={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},_b={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Pb(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function fR(t,e,r){for(var n=(r=r||{}).defaultFontFamily||"times",i=Object.assign({},mR,r.genericFontFamilies||{}),o=null,s=null,l=0;l<e.length;++l)if(i[(o=Kf(e[l])).family]&&(o.family=i[o.family]),t.hasOwnProperty(o.family)){s=t[o.family];break}if(!(s=s||t[n]))throw new Error("Could not find a font-family for the rule '"+Pb(o)+"' and default family '"+n+"'.");if(s=function(c,d){if(d[c])return d[c];var u=Yf[c],y=u<=Yf.normal?-1:1,g=bb(d,L_,u,y);if(!g)throw new Error("Could not find a matching font-stretch value for "+c);return g}(o.stretch,s),s=function(c,d){if(d[c])return d[c];for(var u=N_[c],y=0;y<u.length;++y)if(d[u[y]])return d[u[y]];throw new Error("Could not find a matching font-style for "+c)}(o.style,s),!(s=function(c,d){if(d[c])return d[c];if(c===400&&d[500])return d[500];if(c===500&&d[400])return d[400];var u=pR[c],y=bb(d,R_,u,c<400?-1:1);if(!y)throw new Error("Could not find a matching font-weight for value "+c);return y}(o.weight,s)))throw new Error("Failed to resolve a font for the rule '"+Pb(o)+"'.");return s}function Sb(t){return t.trimLeft()}function yR(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function gR(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var oh,wb,xb,qm=["times"];(function(t){var e,r,n,i,o,s,l,c,d,u=function(F){return F=F||{},this.isStrokeTransparent=F.isStrokeTransparent||!1,this.strokeOpacity=F.strokeOpacity||1,this.strokeStyle=F.strokeStyle||"#000000",this.fillStyle=F.fillStyle||"#000000",this.isFillTransparent=F.isFillTransparent||!1,this.fillOpacity=F.fillOpacity||1,this.font=F.font||"10px sans-serif",this.textBaseline=F.textBaseline||"alphabetic",this.textAlign=F.textAlign||"left",this.lineWidth=F.lineWidth||1,this.lineJoin=F.lineJoin||"miter",this.lineCap=F.lineCap||"butt",this.path=F.path||[],this.transform=F.transform!==void 0?F.transform.clone():new c,this.globalCompositeOperation=F.globalCompositeOperation||"normal",this.globalAlpha=F.globalAlpha||1,this.clip_path=F.clip_path||[],this.currentPoint=F.currentPoint||new s,this.miterLimit=F.miterLimit||10,this.lastPoint=F.lastPoint||new s,this.lineDashOffset=F.lineDashOffset||0,this.lineDash=F.lineDash||[],this.margin=F.margin||[0,0,0,0],this.prevPageLastElemOffset=F.prevPageLastElemOffset||0,this.ignoreClearRect=typeof F.ignoreClearRect!="boolean"||F.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new y(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,s=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,d=new u}]);var y=function(F){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var k=F;Object.defineProperty(this,"pdf",{get:function(){return k}});var N=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return N},set:function(oe){N=!!oe}});var A=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return A},set:function(oe){A=!!oe}});var V=0;Object.defineProperty(this,"posX",{get:function(){return V},set:function(oe){isNaN(oe)||(V=oe)}});var Z=0;Object.defineProperty(this,"posY",{get:function(){return Z},set:function(oe){isNaN(oe)||(Z=oe)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(oe){var ee;typeof oe=="number"?ee=[oe,oe,oe,oe]:((ee=new Array(4))[0]=oe[0],ee[1]=oe.length>=2?oe[1]:ee[0],ee[2]=oe.length>=3?oe[2]:ee[0],ee[3]=oe.length>=4?oe[3]:ee[1]),d.margin=ee}});var H=!1;Object.defineProperty(this,"autoPaging",{get:function(){return H},set:function(oe){H=oe}});var B=0;Object.defineProperty(this,"lastBreak",{get:function(){return B},set:function(oe){B=oe}});var M=[];Object.defineProperty(this,"pageBreaks",{get:function(){return M},set:function(oe){M=oe}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(oe){oe instanceof u&&(d=oe)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(oe){d.path=oe}});var G=[];Object.defineProperty(this,"ctxStack",{get:function(){return G},set:function(oe){G=oe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(oe){var ee;ee=g(oe),this.ctx.fillStyle=ee.style,this.ctx.isFillTransparent=ee.a===0,this.ctx.fillOpacity=ee.a,this.pdf.setFillColor(ee.r,ee.g,ee.b,{a:ee.a}),this.pdf.setTextColor(ee.r,ee.g,ee.b,{a:ee.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(oe){var ee=g(oe);this.ctx.strokeStyle=ee.style,this.ctx.isStrokeTransparent=ee.a===0,this.ctx.strokeOpacity=ee.a,ee.a===0?this.pdf.setDrawColor(255,255,255):(ee.a,this.pdf.setDrawColor(ee.r,ee.g,ee.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(oe){["butt","round","square"].indexOf(oe)!==-1&&(this.ctx.lineCap=oe,this.pdf.setLineCap(oe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(oe){isNaN(oe)||(this.ctx.lineWidth=oe,this.pdf.setLineWidth(oe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(oe){["bevel","round","miter"].indexOf(oe)!==-1&&(this.ctx.lineJoin=oe,this.pdf.setLineJoin(oe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(oe){isNaN(oe)||(this.ctx.miterLimit=oe,this.pdf.setMiterLimit(oe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(oe){this.ctx.textBaseline=oe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(oe){["right","end","center","left","start"].indexOf(oe)!==-1&&(this.ctx.textAlign=oe)}});var Q=null;function ie(oe,ee){if(Q===null){var de=function(he){var le=[];return Object.keys(he).forEach(function(ye){he[ye].forEach(function(ve){var pe=null;switch(ve){case"bold":pe={family:ye,weight:"bold"};break;case"italic":pe={family:ye,style:"italic"};break;case"bolditalic":pe={family:ye,weight:"bold",style:"italic"};break;case"":case"normal":pe={family:ye}}pe!==null&&(pe.ref={name:ye,style:ve},le.push(pe))})}),le}(oe.getFontList());Q=function(he){for(var le={},ye=0;ye<he.length;++ye){var ve=Kf(he[ye]),pe=ve.family,ge=ve.stretch,ke=ve.style,Ne=ve.weight;le[pe]=le[pe]||{},le[pe][ge]=le[pe][ge]||{},le[pe][ge][ke]=le[pe][ge][ke]||{},le[pe][ge][ke][Ne]=ve}return le}(de.concat(ee))}return Q}var me=null;Object.defineProperty(this,"fontFaces",{get:function(){return me},set:function(oe){Q=null,me=oe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(oe){var ee;if(this.ctx.font=oe,(ee=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(oe))!==null){var de=ee[1];ee[2];var he=ee[3],le=ee[4];ee[5];var ye=ee[6],ve=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(le)[2];le=Math.floor(ve==="px"?parseFloat(le)*this.pdf.internal.scaleFactor:ve==="em"?parseFloat(le)*this.pdf.getFontSize():parseFloat(le)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(le);var pe=function(Me){var Ye,ze,je=[],Xe=Me.trim();if(Xe==="")return qm;if(Xe in _b)return[_b[Xe]];for(;Xe!=="";){switch(ze=null,Ye=(Xe=Sb(Xe)).charAt(0)){case'"':case"'":ze=yR(Xe.substring(1),Ye);break;default:ze=gR(Xe)}if(ze===null||(je.push(ze[0]),(Xe=Sb(ze[1]))!==""&&Xe.charAt(0)!==","))return qm;Xe=Xe.replace(/^,/,"")}return je}(ye);if(this.fontFaces){var ge=fR(ie(this.pdf,this.fontFaces),pe.map(function(Me){return{family:Me,stretch:"normal",weight:he,style:de}}));this.pdf.setFont(ge.ref.name,ge.ref.style)}else{var ke="";(he==="bold"||parseInt(he,10)>=700||de==="bold")&&(ke="bold"),de==="italic"&&(ke+="italic"),ke.length===0&&(ke="normal");for(var Ne="",xe={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},$e=0;$e<pe.length;$e++){if(this.pdf.internal.getFont(pe[$e],ke,{noFallback:!0,disableWarning:!0})!==void 0){Ne=pe[$e];break}if(ke==="bolditalic"&&this.pdf.internal.getFont(pe[$e],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Ne=pe[$e],ke="bold";else if(this.pdf.internal.getFont(pe[$e],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Ne=pe[$e],ke="normal";break}}if(Ne===""){for(var Ee=0;Ee<pe.length;Ee++)if(xe[pe[Ee]]){Ne=xe[pe[Ee]];break}}Ne=Ne===""?"Times":Ne,this.pdf.setFont(Ne,ke)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(oe){this.ctx.globalCompositeOperation=oe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(oe){this.ctx.globalAlpha=oe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(oe){this.ctx.lineDashOffset=oe,se.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(oe){this.ctx.lineDash=oe,se.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(oe){this.ctx.ignoreClearRect=!!oe}})};y.prototype.setLineDash=function(F){this.lineDash=F},y.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},y.prototype.fill=function(){j.call(this,"fill",!1)},y.prototype.stroke=function(){j.call(this,"stroke",!1)},y.prototype.beginPath=function(){this.path=[{type:"begin"}]},y.prototype.moveTo=function(F,k){if(isNaN(F)||isNaN(k))throw An.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var N=this.ctx.transform.applyToPoint(new s(F,k));this.path.push({type:"mt",x:N.x,y:N.y}),this.ctx.lastPoint=new s(F,k)},y.prototype.closePath=function(){var F=new s(0,0),k=0;for(k=this.path.length-1;k!==-1;k--)if(this.path[k].type==="begin"&&Pn(this.path[k+1])==="object"&&typeof this.path[k+1].x=="number"){F=new s(this.path[k+1].x,this.path[k+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(F.x,F.y)},y.prototype.lineTo=function(F,k){if(isNaN(F)||isNaN(k))throw An.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var N=this.ctx.transform.applyToPoint(new s(F,k));this.path.push({type:"lt",x:N.x,y:N.y}),this.ctx.lastPoint=new s(N.x,N.y)},y.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),j.call(this,null,!0)},y.prototype.quadraticCurveTo=function(F,k,N,A){if(isNaN(N)||isNaN(A)||isNaN(F)||isNaN(k))throw An.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var V=this.ctx.transform.applyToPoint(new s(N,A)),Z=this.ctx.transform.applyToPoint(new s(F,k));this.path.push({type:"qct",x1:Z.x,y1:Z.y,x:V.x,y:V.y}),this.ctx.lastPoint=new s(V.x,V.y)},y.prototype.bezierCurveTo=function(F,k,N,A,V,Z){if(isNaN(V)||isNaN(Z)||isNaN(F)||isNaN(k)||isNaN(N)||isNaN(A))throw An.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var H=this.ctx.transform.applyToPoint(new s(V,Z)),B=this.ctx.transform.applyToPoint(new s(F,k)),M=this.ctx.transform.applyToPoint(new s(N,A));this.path.push({type:"bct",x1:B.x,y1:B.y,x2:M.x,y2:M.y,x:H.x,y:H.y}),this.ctx.lastPoint=new s(H.x,H.y)},y.prototype.arc=function(F,k,N,A,V,Z){if(isNaN(F)||isNaN(k)||isNaN(N)||isNaN(A)||isNaN(V))throw An.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Z=!!Z,!this.ctx.transform.isIdentity){var H=this.ctx.transform.applyToPoint(new s(F,k));F=H.x,k=H.y;var B=this.ctx.transform.applyToPoint(new s(0,N)),M=this.ctx.transform.applyToPoint(new s(0,0));N=Math.sqrt(Math.pow(B.x-M.x,2)+Math.pow(B.y-M.y,2))}Math.abs(V-A)>=2*Math.PI&&(A=0,V=2*Math.PI),this.path.push({type:"arc",x:F,y:k,radius:N,startAngle:A,endAngle:V,counterclockwise:Z})},y.prototype.arcTo=function(F,k,N,A,V){throw new Error("arcTo not implemented.")},y.prototype.rect=function(F,k,N,A){if(isNaN(F)||isNaN(k)||isNaN(N)||isNaN(A))throw An.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(F,k),this.lineTo(F+N,k),this.lineTo(F+N,k+A),this.lineTo(F,k+A),this.lineTo(F,k),this.lineTo(F+N,k),this.lineTo(F,k)},y.prototype.fillRect=function(F,k,N,A){if(isNaN(F)||isNaN(k)||isNaN(N)||isNaN(A))throw An.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var V={};this.lineCap!=="butt"&&(V.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(V.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(F,k,N,A),this.fill(),V.hasOwnProperty("lineCap")&&(this.lineCap=V.lineCap),V.hasOwnProperty("lineJoin")&&(this.lineJoin=V.lineJoin)}},y.prototype.strokeRect=function(F,k,N,A){if(isNaN(F)||isNaN(k)||isNaN(N)||isNaN(A))throw An.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");w.call(this)||(this.beginPath(),this.rect(F,k,N,A),this.stroke())},y.prototype.clearRect=function(F,k,N,A){if(isNaN(F)||isNaN(k)||isNaN(N)||isNaN(A))throw An.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(F,k,N,A))},y.prototype.save=function(F){F=typeof F!="boolean"||F;for(var k=this.pdf.internal.getCurrentPageInfo().pageNumber,N=0;N<this.pdf.internal.getNumberOfPages();N++)this.pdf.setPage(N+1),this.pdf.internal.out("q");if(this.pdf.setPage(k),F){this.ctx.fontSize=this.pdf.internal.getFontSize();var A=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=A}},y.prototype.restore=function(F){F=typeof F!="boolean"||F;for(var k=this.pdf.internal.getCurrentPageInfo().pageNumber,N=0;N<this.pdf.internal.getNumberOfPages();N++)this.pdf.setPage(N+1),this.pdf.internal.out("Q");this.pdf.setPage(k),F&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},y.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var g=function(F){var k,N,A,V;if(F.isCanvasGradient===!0&&(F=F.getColor()),!F)return{r:0,g:0,b:0,a:0,style:F};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(F))k=0,N=0,A=0,V=0;else{var Z=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(F);if(Z!==null)k=parseInt(Z[1]),N=parseInt(Z[2]),A=parseInt(Z[3]),V=1;else if((Z=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(F))!==null)k=parseInt(Z[1]),N=parseInt(Z[2]),A=parseInt(Z[3]),V=parseFloat(Z[4]);else{if(V=1,typeof F=="string"&&F.charAt(0)!=="#"){var H=new C_(F);F=H.ok?H.toHex():"#000000"}F.length===4?(k=F.substring(1,2),k+=k,N=F.substring(2,3),N+=N,A=F.substring(3,4),A+=A):(k=F.substring(1,3),N=F.substring(3,5),A=F.substring(5,7)),k=parseInt(k,16),N=parseInt(N,16),A=parseInt(A,16)}}return{r:k,g:N,b:A,a:V,style:F}},f=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},w=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};y.prototype.fillText=function(F,k,N,A){if(isNaN(k)||isNaN(N)||typeof F!="string")throw An.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(A=isNaN(A)?void 0:A,!f.call(this)){var V=ne(this.ctx.transform.rotation),Z=this.ctx.transform.scaleX;S.call(this,{text:F,x:k,y:N,scale:Z,angle:V,align:this.textAlign,maxWidth:A})}},y.prototype.strokeText=function(F,k,N,A){if(isNaN(k)||isNaN(N)||typeof F!="string")throw An.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!w.call(this)){A=isNaN(A)?void 0:A;var V=ne(this.ctx.transform.rotation),Z=this.ctx.transform.scaleX;S.call(this,{text:F,x:k,y:N,scale:Z,renderingMode:"stroke",angle:V,align:this.textAlign,maxWidth:A})}},y.prototype.measureText=function(F){if(typeof F!="string")throw An.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var k=this.pdf,N=this.pdf.internal.scaleFactor,A=k.internal.getFontSize(),V=k.getStringUnitWidth(F)*A/k.internal.scaleFactor,Z=function(H){var B=(H=H||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return B}}),this};return new Z({width:V*=Math.round(96*N/72*1e4)/1e4})},y.prototype.scale=function(F,k){if(isNaN(F)||isNaN(k))throw An.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var N=new c(F,0,0,k,0,0);this.ctx.transform=this.ctx.transform.multiply(N)},y.prototype.rotate=function(F){if(isNaN(F))throw An.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var k=new c(Math.cos(F),Math.sin(F),-Math.sin(F),Math.cos(F),0,0);this.ctx.transform=this.ctx.transform.multiply(k)},y.prototype.translate=function(F,k){if(isNaN(F)||isNaN(k))throw An.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var N=new c(1,0,0,1,F,k);this.ctx.transform=this.ctx.transform.multiply(N)},y.prototype.transform=function(F,k,N,A,V,Z){if(isNaN(F)||isNaN(k)||isNaN(N)||isNaN(A)||isNaN(V)||isNaN(Z))throw An.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var H=new c(F,k,N,A,V,Z);this.ctx.transform=this.ctx.transform.multiply(H)},y.prototype.setTransform=function(F,k,N,A,V,Z){F=isNaN(F)?1:F,k=isNaN(k)?0:k,N=isNaN(N)?0:N,A=isNaN(A)?1:A,V=isNaN(V)?0:V,Z=isNaN(Z)?0:Z,this.ctx.transform=new c(F,k,N,A,V,Z)};var E=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};y.prototype.drawImage=function(F,k,N,A,V,Z,H,B,M){var G=this.pdf.getImageProperties(F),Q=1,ie=1,me=1,oe=1;A!==void 0&&B!==void 0&&(me=B/A,oe=M/V,Q=G.width/A*B/A,ie=G.height/V*M/V),Z===void 0&&(Z=k,H=N,k=0,N=0),A!==void 0&&B===void 0&&(B=A,M=V),A===void 0&&B===void 0&&(B=G.width,M=G.height);for(var ee,de=this.ctx.transform.decompose(),he=ne(de.rotate.shx),le=new c,ye=(le=(le=(le=le.multiply(de.translate)).multiply(de.skew)).multiply(de.scale)).applyToRectangle(new l(Z-k*me,H-N*oe,A*Q,V*ie)),ve=x.call(this,ye),pe=[],ge=0;ge<ve.length;ge+=1)pe.indexOf(ve[ge])===-1&&pe.push(ve[ge]);if(K(pe),this.autoPaging)for(var ke=pe[0],Ne=pe[pe.length-1],xe=ke;xe<Ne+1;xe++){this.pdf.setPage(xe);var $e=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ee=xe===1?this.posY+this.margin[0]:this.margin[0],Me=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ye=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ze=xe===1?0:Me+(xe-2)*Ye;if(this.ctx.clip_path.length!==0){var je=this.path;ee=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Y(ee,this.posX+this.margin[3],-ze+Ee+this.ctx.prevPageLastElemOffset),q.call(this,"fill",!0),this.path=je}var Xe=JSON.parse(JSON.stringify(ye));Xe=Y([Xe],this.posX+this.margin[3],-ze+Ee+this.ctx.prevPageLastElemOffset)[0];var ht=(xe>ke||xe<Ne)&&E.call(this);ht&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],$e,Ye,null).clip().discardPath()),this.pdf.addImage(F,"JPEG",Xe.x,Xe.y,Xe.w,Xe.h,null,null,he),ht&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(F,"JPEG",ye.x,ye.y,ye.w,ye.h,null,null,he)};var x=function(F,k,N){var A=[];k=k||this.pdf.internal.pageSize.width,N=N||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var V=this.posY+this.ctx.prevPageLastElemOffset;switch(F.type){default:case"mt":case"lt":A.push(Math.floor((F.y+V)/N)+1);break;case"arc":A.push(Math.floor((F.y+V-F.radius)/N)+1),A.push(Math.floor((F.y+V+F.radius)/N)+1);break;case"qct":var Z=X(this.ctx.lastPoint.x,this.ctx.lastPoint.y,F.x1,F.y1,F.x,F.y);A.push(Math.floor((Z.y+V)/N)+1),A.push(Math.floor((Z.y+Z.h+V)/N)+1);break;case"bct":var H=W(this.ctx.lastPoint.x,this.ctx.lastPoint.y,F.x1,F.y1,F.x2,F.y2,F.x,F.y);A.push(Math.floor((H.y+V)/N)+1),A.push(Math.floor((H.y+H.h+V)/N)+1);break;case"rect":A.push(Math.floor((F.y+V)/N)+1),A.push(Math.floor((F.y+F.h+V)/N)+1)}for(var B=0;B<A.length;B+=1)for(;this.pdf.internal.getNumberOfPages()<A[B];)T.call(this);return A},T=function(){var F=this.fillStyle,k=this.strokeStyle,N=this.font,A=this.lineCap,V=this.lineWidth,Z=this.lineJoin;this.pdf.addPage(),this.fillStyle=F,this.strokeStyle=k,this.font=N,this.lineCap=A,this.lineWidth=V,this.lineJoin=Z},Y=function(F,k,N){for(var A=0;A<F.length;A++)switch(F[A].type){case"bct":F[A].x2+=k,F[A].y2+=N;case"qct":F[A].x1+=k,F[A].y1+=N;case"mt":case"lt":case"arc":default:F[A].x+=k,F[A].y+=N}return F},K=function(F){return F.sort(function(k,N){return k-N})},j=function(F,k){for(var N,A,V=this.fillStyle,Z=this.strokeStyle,H=this.lineCap,B=this.lineWidth,M=Math.abs(B*this.ctx.transform.scaleX),G=this.lineJoin,Q=JSON.parse(JSON.stringify(this.path)),ie=JSON.parse(JSON.stringify(this.path)),me=[],oe=0;oe<ie.length;oe++)if(ie[oe].x!==void 0)for(var ee=x.call(this,ie[oe]),de=0;de<ee.length;de+=1)me.indexOf(ee[de])===-1&&me.push(ee[de]);for(var he=0;he<me.length;he++)for(;this.pdf.internal.getNumberOfPages()<me[he];)T.call(this);if(K(me),this.autoPaging)for(var le=me[0],ye=me[me.length-1],ve=le;ve<ye+1;ve++){this.pdf.setPage(ve),this.fillStyle=V,this.strokeStyle=Z,this.lineCap=H,this.lineWidth=M,this.lineJoin=G;var pe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ge=ve===1?this.posY+this.margin[0]:this.margin[0],ke=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ne=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],xe=ve===1?0:ke+(ve-2)*Ne;if(this.ctx.clip_path.length!==0){var $e=this.path;N=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Y(N,this.posX+this.margin[3],-xe+ge+this.ctx.prevPageLastElemOffset),q.call(this,F,!0),this.path=$e}if(A=JSON.parse(JSON.stringify(Q)),this.path=Y(A,this.posX+this.margin[3],-xe+ge+this.ctx.prevPageLastElemOffset),k===!1||ve===0){var Ee=(ve>le||ve<ye)&&E.call(this);Ee&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],pe,Ne,null).clip().discardPath()),q.call(this,F,k),Ee&&this.pdf.restoreGraphicsState()}this.lineWidth=B}else this.lineWidth=M,q.call(this,F,k),this.lineWidth=B;this.path=Q},q=function(F,k){if((F!=="stroke"||k||!w.call(this))&&(F==="stroke"||k||!f.call(this))){for(var N,A,V=[],Z=this.path,H=0;H<Z.length;H++){var B=Z[H];switch(B.type){case"begin":V.push({begin:!0});break;case"close":V.push({close:!0});break;case"mt":V.push({start:B,deltas:[],abs:[]});break;case"lt":var M=V.length;if(Z[H-1]&&!isNaN(Z[H-1].x)&&(N=[B.x-Z[H-1].x,B.y-Z[H-1].y],M>0)){for(;M>=0;M--)if(V[M-1].close!==!0&&V[M-1].begin!==!0){V[M-1].deltas.push(N),V[M-1].abs.push(B);break}}break;case"bct":N=[B.x1-Z[H-1].x,B.y1-Z[H-1].y,B.x2-Z[H-1].x,B.y2-Z[H-1].y,B.x-Z[H-1].x,B.y-Z[H-1].y],V[V.length-1].deltas.push(N);break;case"qct":var G=Z[H-1].x+2/3*(B.x1-Z[H-1].x),Q=Z[H-1].y+2/3*(B.y1-Z[H-1].y),ie=B.x+2/3*(B.x1-B.x),me=B.y+2/3*(B.y1-B.y),oe=B.x,ee=B.y;N=[G-Z[H-1].x,Q-Z[H-1].y,ie-Z[H-1].x,me-Z[H-1].y,oe-Z[H-1].x,ee-Z[H-1].y],V[V.length-1].deltas.push(N);break;case"arc":V.push({deltas:[],abs:[],arc:!0}),Array.isArray(V[V.length-1].abs)&&V[V.length-1].abs.push(B)}}A=k?null:F==="stroke"?"stroke":"fill";for(var de=!1,he=0;he<V.length;he++)if(V[he].arc)for(var le=V[he].abs,ye=0;ye<le.length;ye++){var ve=le[ye];ve.type==="arc"?P.call(this,ve.x,ve.y,ve.radius,ve.startAngle,ve.endAngle,ve.counterclockwise,void 0,k,!de):v.call(this,ve.x,ve.y),de=!0}else if(V[he].close===!0)this.pdf.internal.out("h"),de=!1;else if(V[he].begin!==!0){var pe=V[he].start.x,ge=V[he].start.y;z.call(this,V[he].deltas,pe,ge),de=!0}A&&$.call(this,A),k&&D.call(this)}},J=function(F){var k=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,N=k*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return F-N;case"top":return F+k-N;case"hanging":return F+k-2*N;case"middle":return F+k/2-N;case"ideographic":return F;case"alphabetic":default:return F}},C=function(F){return F+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};y.prototype.createLinearGradient=function(){var F=function(){};return F.colorStops=[],F.addColorStop=function(k,N){this.colorStops.push([k,N])},F.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},F.isCanvasGradient=!0,F},y.prototype.createPattern=function(){return this.createLinearGradient()},y.prototype.createRadialGradient=function(){return this.createLinearGradient()};var P=function(F,k,N,A,V,Z,H,B,M){for(var G=L.call(this,N,A,V,Z),Q=0;Q<G.length;Q++){var ie=G[Q];Q===0&&(M?b.call(this,ie.x1+F,ie.y1+k):v.call(this,ie.x1+F,ie.y1+k)),re.call(this,F,k,ie.x2,ie.y2,ie.x3,ie.y3,ie.x4,ie.y4)}B?D.call(this):$.call(this,H)},$=function(F){switch(F){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},D=function(){this.pdf.clip(),this.pdf.discardPath()},b=function(F,k){this.pdf.internal.out(r(F)+" "+n(k)+" m")},S=function(F){var k;switch(F.align){case"right":case"end":k="right";break;case"center":k="center";break;case"left":case"start":default:k="left"}var N=this.pdf.getTextDimensions(F.text),A=J.call(this,F.y),V=C.call(this,A)-N.h,Z=this.ctx.transform.applyToPoint(new s(F.x,A)),H=this.ctx.transform.decompose(),B=new c;B=(B=(B=B.multiply(H.translate)).multiply(H.skew)).multiply(H.scale);for(var M,G,Q,ie=this.ctx.transform.applyToRectangle(new l(F.x,A,N.w,N.h)),me=B.applyToRectangle(new l(F.x,V,N.w,N.h)),oe=x.call(this,me),ee=[],de=0;de<oe.length;de+=1)ee.indexOf(oe[de])===-1&&ee.push(oe[de]);if(K(ee),this.autoPaging)for(var he=ee[0],le=ee[ee.length-1],ye=he;ye<le+1;ye++){this.pdf.setPage(ye);var ve=ye===1?this.posY+this.margin[0]:this.margin[0],pe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ge=this.pdf.internal.pageSize.height-this.margin[2],ke=ge-this.margin[0],Ne=this.pdf.internal.pageSize.width-this.margin[1],xe=Ne-this.margin[3],$e=ye===1?0:pe+(ye-2)*ke;if(this.ctx.clip_path.length!==0){var Ee=this.path;M=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Y(M,this.posX+this.margin[3],-1*$e+ve),q.call(this,"fill",!0),this.path=Ee}var Me=Y([JSON.parse(JSON.stringify(me))],this.posX+this.margin[3],-$e+ve+this.ctx.prevPageLastElemOffset)[0];F.scale>=.01&&(G=this.pdf.internal.getFontSize(),this.pdf.setFontSize(G*F.scale),Q=this.lineWidth,this.lineWidth=Q*F.scale);var Ye=this.autoPaging!=="text";if(Ye||Me.y+Me.h<=ge){if(Ye||Me.y>=ve&&Me.x<=Ne){var ze=Ye?F.text:this.pdf.splitTextToSize(F.text,F.maxWidth||Ne-Me.x)[0],je=Y([JSON.parse(JSON.stringify(ie))],this.posX+this.margin[3],-$e+ve+this.ctx.prevPageLastElemOffset)[0],Xe=Ye&&(ye>he||ye<le)&&E.call(this);Xe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],xe,ke,null).clip().discardPath()),this.pdf.text(ze,je.x,je.y,{angle:F.angle,align:k,renderingMode:F.renderingMode}),Xe&&this.pdf.restoreGraphicsState()}}else Me.y<ge&&(this.ctx.prevPageLastElemOffset+=ge-Me.y);F.scale>=.01&&(this.pdf.setFontSize(G),this.lineWidth=Q)}else F.scale>=.01&&(G=this.pdf.internal.getFontSize(),this.pdf.setFontSize(G*F.scale),Q=this.lineWidth,this.lineWidth=Q*F.scale),this.pdf.text(F.text,Z.x+this.posX,Z.y+this.posY,{angle:F.angle,align:k,renderingMode:F.renderingMode,maxWidth:F.maxWidth}),F.scale>=.01&&(this.pdf.setFontSize(G),this.lineWidth=Q)},v=function(F,k,N,A){N=N||0,A=A||0,this.pdf.internal.out(r(F+N)+" "+n(k+A)+" l")},z=function(F,k,N){return this.pdf.lines(F,k,N,null,null)},re=function(F,k,N,A,V,Z,H,B){this.pdf.internal.out([e(i(N+F)),e(o(A+k)),e(i(V+F)),e(o(Z+k)),e(i(H+F)),e(o(B+k)),"c"].join(" "))},L=function(F,k,N,A){for(var V=2*Math.PI,Z=Math.PI/2;k>N;)k-=V;var H=Math.abs(N-k);H<V&&A&&(H=V-H);for(var B=[],M=A?-1:1,G=k;H>1e-5;){var Q=G+M*Math.min(H,Z);B.push(O.call(this,F,G,Q)),H-=Math.abs(Q-G),G=Q}return B},O=function(F,k,N){var A=(N-k)/2,V=F*Math.cos(A),Z=F*Math.sin(A),H=V,B=-Z,M=H*H+B*B,G=M+H*V+B*Z,Q=4/3*(Math.sqrt(2*M*G)-G)/(H*Z-B*V),ie=H-Q*B,me=B+Q*H,oe=ie,ee=-me,de=A+k,he=Math.cos(de),le=Math.sin(de);return{x1:F*Math.cos(k),y1:F*Math.sin(k),x2:ie*he-me*le,y2:ie*le+me*he,x3:oe*he-ee*le,y3:oe*le+ee*he,x4:F*Math.cos(N),y4:F*Math.sin(N)}},ne=function(F){return 180*F/Math.PI},X=function(F,k,N,A,V,Z){var H=F+.5*(N-F),B=k+.5*(A-k),M=V+.5*(N-V),G=Z+.5*(A-Z),Q=Math.min(F,V,H,M),ie=Math.max(F,V,H,M),me=Math.min(k,Z,B,G),oe=Math.max(k,Z,B,G);return new l(Q,me,ie-Q,oe-me)},W=function(F,k,N,A,V,Z,H,B){var M,G,Q,ie,me,oe,ee,de,he,le,ye,ve,pe,ge,ke=N-F,Ne=A-k,xe=V-N,$e=Z-A,Ee=H-V,Me=B-Z;for(G=0;G<41;G++)he=(ee=(Q=F+(M=G/40)*ke)+M*((me=N+M*xe)-Q))+M*(me+M*(V+M*Ee-me)-ee),le=(de=(ie=k+M*Ne)+M*((oe=A+M*$e)-ie))+M*(oe+M*(Z+M*Me-oe)-de),G==0?(ye=he,ve=le,pe=he,ge=le):(ye=Math.min(ye,he),ve=Math.min(ve,le),pe=Math.max(pe,he),ge=Math.max(ge,le));return new l(Math.round(ye),Math.round(ve),Math.round(pe-ye),Math.round(ge-ve))},se=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var F,k,N=(F=this.ctx.lineDash,k=this.ctx.lineDashOffset,JSON.stringify({lineDash:F,lineDashOffset:k}));this.prevLineDash!==N&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=N)}}})(Er.API),function(t){var e=function(o){var s,l,c,d,u,y,g,f,w,E;for(l=[],c=0,d=(o+=s="\0\0\0\0".slice(o.length%4||4)).length;d>c;c+=4)(u=(o.charCodeAt(c)<<24)+(o.charCodeAt(c+1)<<16)+(o.charCodeAt(c+2)<<8)+o.charCodeAt(c+3))!==0?(y=(u=((u=((u=((u=(u-(E=u%85))/85)-(w=u%85))/85)-(f=u%85))/85)-(g=u%85))/85)%85,l.push(y+33,g+33,f+33,w+33,E+33)):l.push(122);return function(x,T){for(var Y=T;Y>0;Y--)x.pop()}(l,s.length),String.fromCharCode.apply(String,l)+"~>"},r=function(o){var s,l,c,d,u,y=String,g="length",f=255,w="charCodeAt",E="slice",x="replace";for(o[E](-2),o=o[E](0,-2)[x](/\s/g,"")[x]("z","!!!!!"),c=[],d=0,u=(o+=s="uuuuu"[E](o[g]%5||5))[g];u>d;d+=5)l=52200625*(o[w](d)-33)+614125*(o[w](d+1)-33)+7225*(o[w](d+2)-33)+85*(o[w](d+3)-33)+(o[w](d+4)-33),c.push(f&l>>24,f&l>>16,f&l>>8,f&l);return function(T,Y){for(var K=Y;K>0;K--)T.pop()}(c,s[g]),y.fromCharCode.apply(y,c)},n=function(o){var s=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),s.test(o)===!1)return"";for(var l="",c=0;c<o.length;c+=2)l+=String.fromCharCode("0x"+(o[c]+o[c+1]));return l},i=function(o){for(var s=new Uint8Array(o.length),l=o.length;l--;)s[l]=o.charCodeAt(l);return o=(s=zf(s)).reduce(function(c,d){return c+String.fromCharCode(d)},"")};t.processDataByFilters=function(o,s){var l=0,c=o||"",d=[];for(typeof(s=s||[])=="string"&&(s=[s]),l=0;l<s.length;l+=1)switch(s[l]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=n(c),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(u){return("0"+u.charCodeAt().toString(16)).slice(-2)}).join("")+">",d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=i(c),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[l]+'" is not implemented')}return{data:c,reverseChain:d.reverse().join(" ")}}}(Er.API),function(t){t.loadFile=function(e,r,n){return function(i,o,s){o=o!==!1,s=typeof s=="function"?s:function(){};var l=void 0;try{l=function(c,d,u){var y=new XMLHttpRequest,g=0,f=function(w){var E=w.length,x=[],T=String.fromCharCode;for(g=0;g<E;g+=1)x.push(T(255&w.charCodeAt(g)));return x.join("")};if(y.open("GET",c,!d),y.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(y.onload=function(){y.status===200?u(f(this.responseText)):u(void 0)}),y.send(null),d&&y.status===200)return f(y.responseText)}(i,o,s)}catch{}return l}(e,r,n)},t.loadImageFile=t.loadFile}(Er.API),function(t){function e(){return(kr.html2canvas?Promise.resolve(kr.html2canvas):ao(()=>import("./html2canvas.esm-BfxBtG_O.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load html2canvas: "+s))}).then(function(s){return s.default?s.default:s})}function r(){return(kr.DOMPurify?Promise.resolve(kr.DOMPurify):ao(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load dompurify: "+s))}).then(function(s){return s.default?s.default:s})}var n=function(s){var l=Pn(s);return l==="undefined"?"undefined":l==="string"||s instanceof String?"string":l==="number"||s instanceof Number?"number":l==="function"||s instanceof Function?"function":s&&s.constructor===Array?"array":s&&s.nodeType===1?"element":l==="object"?"object":"unknown"},i=function(s,l){var c=document.createElement(s);for(var d in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[d]=l.style[d];return c},o=function s(l){var c=Object.assign(s.convert(Promise.resolve()),JSON.parse(JSON.stringify(s.template))),d=s.convert(Promise.resolve(),c);return d=(d=d.setProgress(1,s,1,[s])).set(l)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(s,l){return s.__proto__=l||o.prototype,s},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(s,l){return this.then(function(){switch(l=l||function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(s)){case"string":return this.then(r).then(function(c){return this.set({src:i("div",{innerHTML:s,dompurify:c})})});case"element":return this.set({src:s});case"canvas":return this.set({canvas:s});case"img":return this.set({img:s});default:return this.error("Unknown source type.")}})},o.prototype.to=function(s){switch(s){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var s={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=function c(d,u){for(var y=d.nodeType===3?document.createTextNode(d.nodeValue):d.cloneNode(!1),g=d.firstChild;g;g=g.nextSibling)u!==!0&&g.nodeType===1&&g.nodeName==="SCRIPT"||y.appendChild(c(g,u));return d.nodeType===1&&(d.nodeName==="CANVAS"?(y.width=d.width,y.height=d.height,y.getContext("2d").drawImage(d,0,0)):d.nodeName!=="TEXTAREA"&&d.nodeName!=="SELECT"||(y.value=d.value),y.addEventListener("load",function(){y.scrollTop=d.scrollTop,y.scrollLeft=d.scrollLeft},!0)),y}(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(s.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:s}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(e).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(e).then(function(l){var c=this.opt.jsPDF,d=this.opt.fontFaces,u=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,y=Object.assign({async:!0,allowTaint:!0,scale:u,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete y.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=d,d)for(var g=0;g<d.length;++g){var f=d[g],w=f.src.find(function(E){return E.format==="truetype"});w&&c.addFont(w.url,f.ref.name,f.ref.style)}return y.windowHeight=y.windowHeight||0,y.windowHeight=y.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):y.windowHeight,c.context2d.save(!0),l(this.prop.container,y)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var s=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=s})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(s,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(s,l):this.outputPdf(s,l)},o.prototype.outputPdf=function(s,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(s,l)})},o.prototype.outputImg=function(s){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(s){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+s+'" is not supported.'}})},o.prototype.save=function(s){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(s?{filename:s}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(s){if(n(s)!=="object")return this;var l=Object.keys(s||{}).map(function(c){if(c in o.template.prop)return function(){this.prop[c]=s[c]};switch(c){case"margin":return this.setMargin.bind(this,s.margin);case"jsPDF":return function(){return this.opt.jsPDF=s.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,s.pageSize);default:return function(){this.opt[c]=s[c]}}},this);return this.then(function(){return this.thenList(l)})},o.prototype.get=function(s,l){return this.then(function(){var c=s in o.template.prop?this.prop[s]:this.opt[s];return l?l(c):c})},o.prototype.setMargin=function(s){return this.then(function(){switch(n(s)){case"number":s=[s,s,s,s];case"array":if(s.length===2&&(s=[s[0],s[1],s[0],s[1]]),s.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=s}).then(this.setPageSize)},o.prototype.setPageSize=function(s){function l(c,d){return Math.floor(c*d/72*96)}return this.then(function(){(s=s||Er.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(s.inner={width:s.width-this.opt.margin[1]-this.opt.margin[3],height:s.height-this.opt.margin[0]-this.opt.margin[2]},s.inner.px={width:l(s.inner.width,s.k),height:l(s.inner.height,s.k)},s.inner.ratio=s.inner.height/s.inner.width),this.prop.pageSize=s})},o.prototype.setProgress=function(s,l,c,d){return s!=null&&(this.progress.val=s),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(s,l,c,d){return this.setProgress(s?this.progress.val+s:null,l||null,c?this.progress.n+c:null,d?this.progress.stack.concat(d):null)},o.prototype.then=function(s,l){var c=this;return this.thenCore(s,l,function(d,u){return c.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(y){return c.updateProgress(null,d),y}).then(d,u).then(function(y){return c.updateProgress(1),y})})},o.prototype.thenCore=function(s,l,c){c=c||Promise.prototype.then,s&&(s=s.bind(this)),l&&(l=l.bind(this));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:o.convert(Object.assign({},this),Promise.prototype),u=c.call(d,s,l);return o.convert(u,this.__proto__)},o.prototype.thenExternal=function(s,l){return Promise.prototype.then.call(this,s,l)},o.prototype.thenList=function(s){var l=this;return s.forEach(function(c){l=l.thenCore(c)}),l},o.prototype.catch=function(s){s&&(s=s.bind(this));var l=Promise.prototype.catch.call(this,s);return o.convert(l,this)},o.prototype.catchExternal=function(s){return Promise.prototype.catch.call(this,s)},o.prototype.error=function(s){return this.then(function(){throw new Error(s)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Er.getPageSize=function(s,l,c){if(Pn(s)==="object"){var d=s;s=d.orientation,l=d.unit||l,c=d.format||c}l=l||"mm",c=c||"a4",s=(""+(s||"P")).toLowerCase();var u,y=(""+c).toLowerCase(),g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":u=1;break;case"mm":u=72/25.4;break;case"cm":u=72/2.54;break;case"in":u=72;break;case"px":u=.75;break;case"pc":case"em":u=12;break;case"ex":u=6;break;default:throw"Invalid unit: "+l}var f,w=0,E=0;if(g.hasOwnProperty(y))w=g[y][1]/u,E=g[y][0]/u;else try{w=c[1],E=c[0]}catch{throw new Error("Invalid format: "+c)}if(s==="p"||s==="portrait")s="p",E>w&&(f=E,E=w,w=f);else{if(s!=="l"&&s!=="landscape")throw"Invalid orientation: "+s;s="l",w>E&&(f=E,E=w,w=f)}return{width:E,height:w,unit:l,k:u,orientation:s}},t.html=function(s,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(Kf):null;var c=new o(l);return l.worker?c:c.from(s).doCallback()}}(Er.API),Er.API.addJS=function(t){return xb=t,this.internal.events.subscribe("postPutResources",function(){oh=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(oh+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),wb=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+xb+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){oh!==void 0&&wb!==void 0&&this.internal.out("/Names <</JavaScript "+oh+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),o=0;o<i.length;o++){var s=i[o],l=n.exec(s);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,u=[];for(o=0;o<d;o++){var y=r.internal.newObject();u.push(y);var g=r.internal.getPageInfo(o+1);r.internal.write("<< /D["+g.objId+" 0 R /XYZ null null null]>> endobj")}var f=r.internal.newObject();for(r.internal.write("<< /Names [ "),o=0;o<u.length;o++)r.internal.write("(page_"+(o+1)+")"+u[o]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+f+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,o){var s={title:i,options:o,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<n.children.length;o++){var s=n.children[o];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),o>0&&this.line("/Prev "+this.makeRef(n.children[o-1])),o<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[o+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var l=this.count=this.count_r({count:0},s);if(l>0&&this.line("/Count "+l),s.options&&s.options.pageNumber){var c=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var d=0;d<n.children.length;d++)this.renderItems(n.children[d])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var o=0;o<i.children.length;o++)n.count++,this.count_r(n,i.children[o]);return n.count}}])}(Er.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,i,o,s,l){var c,d=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(c=function(y){for(var g,f=256*y.charCodeAt(4)+y.charCodeAt(5),w=y.length,E={width:0,height:0,numcomponents:1},x=4;x<w;x+=2){if(x+=f,e.indexOf(y.charCodeAt(x+1))!==-1){g=256*y.charCodeAt(x+5)+y.charCodeAt(x+6),E={width:256*y.charCodeAt(x+7)+y.charCodeAt(x+8),height:g,numcomponents:y.charCodeAt(x+9)};break}f=256*y.charCodeAt(x+2)+y.charCodeAt(x+3)}return E}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}u={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:d,index:n,alias:i}}return u}}(Er.API);var cc,sh,Cb,Ab,$b,vR=function(){var t,e,r;function n(o){var s,l,c,d,u,y,g,f,w,E,x,T,Y,K;for(this.data=o,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},y=null;;){switch(s=this.readUInt32(),w=function(){var j,q;for(q=[],j=0;j<4;++j)q.push(String.fromCharCode(this.data[this.pos++]));return q}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(s);break;case"fcTL":y&&this.animation.frames.push(y),this.pos+=4,y={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},u=this.readUInt16(),d=this.readUInt16()||100,y.delay=1e3*u/d,y.disposeOp=this.data[this.pos++],y.blendOp=this.data[this.pos++],y.data=[];break;case"IDAT":case"fdAT":for(w==="fdAT"&&(this.pos+=4,s-=4),o=y?.data||this.imgData,T=0;0<=s?T<s:T>s;0<=s?++T:--T)o.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(s),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((E=c-this.transparency.indexed.length)>0)for(Y=0;0<=E?Y<E:Y>E;0<=E?++Y:--Y)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(s)[0];break;case 2:this.transparency.rgb=this.read(s)}break;case"tEXt":g=(x=this.read(s)).indexOf(0),f=String.fromCharCode.apply(String,x.slice(0,g)),this.text[f]=String.fromCharCode.apply(String,x.slice(g+1));break;case"IEND":return y&&this.animation.frames.push(y),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=(K=this.colorType)===4||K===6,l=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*l,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=s}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(o){var s,l;for(l=[],s=0;0<=o?s<o:s>o;0<=o?++s:--s)l.push(this.data[this.pos++]);return l},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(o){var s=this.pixelBitlength/8,l=new Uint8Array(this.width*this.height*s),c=0,d=this;if(o==null&&(o=this.imgData),o.length===0)return new Uint8Array(0);function u(y,g,f,w){var E,x,T,Y,K,j,q,J,C,P,$,D,b,S,v,z,re,L,O,ne,X,W=Math.ceil((d.width-y)/f),se=Math.ceil((d.height-g)/w),F=d.width==W&&d.height==se;for(S=s*W,D=F?l:new Uint8Array(S*se),j=o.length,b=0,x=0;b<se&&c<j;){switch(o[c++]){case 0:for(Y=re=0;re<S;Y=re+=1)D[x++]=o[c++];break;case 1:for(Y=L=0;L<S;Y=L+=1)E=o[c++],K=Y<s?0:D[x-s],D[x++]=(E+K)%256;break;case 2:for(Y=O=0;O<S;Y=O+=1)E=o[c++],T=(Y-Y%s)/s,v=b&&D[(b-1)*S+T*s+Y%s],D[x++]=(v+E)%256;break;case 3:for(Y=ne=0;ne<S;Y=ne+=1)E=o[c++],T=(Y-Y%s)/s,K=Y<s?0:D[x-s],v=b&&D[(b-1)*S+T*s+Y%s],D[x++]=(E+Math.floor((K+v)/2))%256;break;case 4:for(Y=X=0;X<S;Y=X+=1)E=o[c++],T=(Y-Y%s)/s,K=Y<s?0:D[x-s],b===0?v=z=0:(v=D[(b-1)*S+T*s+Y%s],z=T&&D[(b-1)*S+(T-1)*s+Y%s]),q=K+v-z,J=Math.abs(q-K),P=Math.abs(q-v),$=Math.abs(q-z),C=J<=P&&J<=$?K:P<=$?v:z,D[x++]=(E+C)%256;break;default:throw new Error("Invalid filter algorithm: "+o[c-1])}if(!F){var k=((g+b*w)*d.width+y)*s,N=b*S;for(Y=0;Y<W;Y+=1){for(var A=0;A<s;A+=1)l[k++]=D[N++];k+=(f-1)*s}}b++}}return o=K7(o),d.interlaceMethod==1?(u(0,0,8,8),u(4,0,8,8),u(0,4,4,8),u(2,0,4,4),u(0,2,2,4),u(1,0,2,2),u(0,1,1,2)):u(0,0,1,1),l},n.prototype.decodePalette=function(){var o,s,l,c,d,u,y,g,f;for(l=this.palette,u=this.transparency.indexed||[],d=new Uint8Array((u.length||0)+l.length),c=0,o=0,s=y=0,g=l.length;y<g;s=y+=3)d[c++]=l[s],d[c++]=l[s+1],d[c++]=l[s+2],d[c++]=(f=u[o++])!=null?f:255;return d},n.prototype.copyToImageData=function(o,s){var l,c,d,u,y,g,f,w,E,x,T;if(c=this.colors,E=null,l=this.hasAlphaChannel,this.palette.length&&(E=(T=this._decodedPalette)!=null?T:this._decodedPalette=this.decodePalette(),c=4,l=!0),w=(d=o.data||o).length,y=E||s,u=g=0,c===1)for(;u<w;)f=E?4*s[u/4]:g,x=y[f++],d[u++]=x,d[u++]=x,d[u++]=x,d[u++]=l?y[f++]:255,g=f;else for(;u<w;)f=E?4*s[u/4]:g,d[u++]=y[f++],d[u++]=y[f++],d[u++]=y[f++],d[u++]=l?y[f++]:255,g=f},n.prototype.decode=function(){var o;return o=new Uint8Array(this.width*this.height*4),this.copyToImageData(o,this.decodePixels()),o};var i=function(){if(Object.prototype.toString.call(kr)==="[object Window]"){try{e=kr.document.createElement("canvas"),r=e.getContext("2d")}catch{return!1}return!0}return!1};return i(),t=function(o){var s;if(i()===!0)return r.width=o.width,r.height=o.height,r.clearRect(0,0,o.width,o.height),r.putImageData(o,0,0),(s=new Image).src=e.toDataURL(),s;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(o){var s,l,c,d,u,y,g,f;if(this.animation){for(f=[],l=u=0,y=(g=this.animation.frames).length;u<y;l=++u)s=g[l],c=o.createImageData(s.width,s.height),d=this.decodePixels(new Uint8Array(s.data)),this.copyToImageData(c,d),s.imageData=c,f.push(s.image=t(c));return f}},n.prototype.renderFrame=function(o,s){var l,c,d;return l=(c=this.animation.frames)[s],d=c[s-1],s===0&&o.clearRect(0,0,this.width,this.height),d?.disposeOp===1?o.clearRect(d.xOffset,d.yOffset,d.width,d.height):d?.disposeOp===2&&o.putImageData(d.imageData,d.xOffset,d.yOffset),l.blendOp===0&&o.clearRect(l.xOffset,l.yOffset,l.width,l.height),o.drawImage(l.image,l.xOffset,l.yOffset)},n.prototype.animate=function(o){var s,l,c,d,u,y,g=this;return l=0,y=this.animation,d=y.numFrames,c=y.frames,u=y.numPlays,(s=function(){var f,w;if(f=l++%d,w=c[f],g.renderFrame(o,f),d>1&&l/d<u)return g.animation._timeout=setTimeout(s,w.delay)})()},n.prototype.stopAnimation=function(){var o;return clearTimeout((o=this.animation)!=null?o._timeout:void 0)},n.prototype.render=function(o){var s,l;return o._png&&o._png.stopAnimation(),o._png=this,o.width=this.width,o.height=this.height,s=o.getContext("2d"),this.animation?(this.decodeFrames(s),this.animate(s)):(l=s.createImageData(this.width,this.height),this.copyToImageData(l,this.decodePixels()),s.putImageData(l,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function bR(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,i=t[e++],o=i>>7,s=1<<(7&i)+1;t[e++],t[e++];var l=null,c=null;o&&(l=e,c=s,e+=3*s);var d=!0,u=[],y=0,g=null,f=0,w=null;for(this.width=r,this.height=n;d&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,w=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((b=t[e++])>=0))throw Error("Invalid block size");if(b===0)break;e+=b}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var E=t[e++];y=t[e++]|t[e++]<<8,g=t[e++],(1&E)==0&&(g=null),f=E>>2&7,e++;break;case 254:for(;;){if(!((b=t[e++])>=0))throw Error("Invalid block size");if(b===0)break;e+=b}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var x=t[e++]|t[e++]<<8,T=t[e++]|t[e++]<<8,Y=t[e++]|t[e++]<<8,K=t[e++]|t[e++]<<8,j=t[e++],q=j>>6&1,J=1<<(7&j)+1,C=l,P=c,$=!1;j>>7&&($=!0,C=e,P=J,e+=3*J);var D=e;for(e++;;){var b;if(!((b=t[e++])>=0))throw Error("Invalid block size");if(b===0)break;e+=b}u.push({x,y:T,width:Y,height:K,has_local_palette:$,palette_offset:C,palette_size:P,data_offset:D,data_length:e-D,transparent_index:g,interlaced:!!q,delay:y,disposal:f});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return w},this.frameInfo=function(S){if(S<0||S>=u.length)throw new Error("Frame index out of range.");return u[S]},this.decodeAndBlitFrameBGRA=function(S,v){var z=this.frameInfo(S),re=z.width*z.height,L=new Uint8Array(re);Eb(t,z.data_offset,L,re);var O=z.palette_offset,ne=z.transparent_index;ne===null&&(ne=256);var X=z.width,W=r-X,se=X,F=4*(z.y*r+z.x),k=4*((z.y+z.height)*r+z.x),N=F,A=4*W;z.interlaced===!0&&(A+=4*r*7);for(var V=8,Z=0,H=L.length;Z<H;++Z){var B=L[Z];if(se===0&&(se=X,(N+=A)>=k&&(A=4*W+4*r*(V-1),N=F+(X+W)*(V<<1),V>>=1)),B===ne)N+=4;else{var M=t[O+3*B],G=t[O+3*B+1],Q=t[O+3*B+2];v[N++]=Q,v[N++]=G,v[N++]=M,v[N++]=255}--se}},this.decodeAndBlitFrameRGBA=function(S,v){var z=this.frameInfo(S),re=z.width*z.height,L=new Uint8Array(re);Eb(t,z.data_offset,L,re);var O=z.palette_offset,ne=z.transparent_index;ne===null&&(ne=256);var X=z.width,W=r-X,se=X,F=4*(z.y*r+z.x),k=4*((z.y+z.height)*r+z.x),N=F,A=4*W;z.interlaced===!0&&(A+=4*r*7);for(var V=8,Z=0,H=L.length;Z<H;++Z){var B=L[Z];if(se===0&&(se=X,(N+=A)>=k&&(A=4*W+4*r*(V-1),N=F+(X+W)*(V<<1),V>>=1)),B===ne)N+=4;else{var M=t[O+3*B],G=t[O+3*B+1],Q=t[O+3*B+2];v[N++]=M,v[N++]=G,v[N++]=Q,v[N++]=255}--se}}}function Eb(t,e,r,n){for(var i=t[e++],o=1<<i,s=o+1,l=s+1,c=i+1,d=(1<<c)-1,u=0,y=0,g=0,f=t[e++],w=new Int32Array(4096),E=null;;){for(;u<16&&f!==0;)y|=t[e++]<<u,u+=8,f===1?f=t[e++]:--f;if(u<c)break;var x=y&d;if(y>>=c,u-=c,x!==o){if(x===s)break;for(var T=x<l?x:E,Y=0,K=T;K>o;)K=w[K]>>8,++Y;var j=K;if(g+Y+(T!==x?1:0)>n)return void An.log("Warning, gif stream longer than expected.");r[g++]=j;var q=g+=Y;for(T!==x&&(r[g++]=j),K=T;Y--;)K=w[K],r[--q]=255&K,K>>=8;E!==null&&l<4096&&(w[l++]=E<<8|j,l>=d+1&&c<12&&(++c,d=d<<1|1)),E=x}else l=s+1,d=(1<<(c=i+1))-1,E=null}return g!==n&&An.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function zm(t){var e,r,n,i,o,s=Math.floor,l=new Array(64),c=new Array(64),d=new Array(64),u=new Array(64),y=new Array(65535),g=new Array(65535),f=new Array(64),w=new Array(64),E=[],x=0,T=7,Y=new Array(64),K=new Array(64),j=new Array(64),q=new Array(256),J=new Array(2048),C=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],P=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],$=[0,1,2,3,4,5,6,7,8,9,10,11],D=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],b=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],S=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],v=[0,1,2,3,4,5,6,7,8,9,10,11],z=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],re=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function L(F,k){for(var N=0,A=0,V=new Array,Z=1;Z<=16;Z++){for(var H=1;H<=F[Z];H++)V[k[A]]=[],V[k[A]][0]=N,V[k[A]][1]=Z,A++,N++;N*=2}return V}function O(F){for(var k=F[0],N=F[1]-1;N>=0;)k&1<<N&&(x|=1<<T),N--,--T<0&&(x==255?(ne(255),ne(0)):ne(x),T=7,x=0)}function ne(F){E.push(F)}function X(F){ne(F>>8&255),ne(255&F)}function W(F,k,N,A,V){for(var Z,H=V[0],B=V[240],M=function(le,ye){var ve,pe,ge,ke,Ne,xe,$e,Ee,Me,Ye,ze=0;for(Me=0;Me<8;++Me){ve=le[ze],pe=le[ze+1],ge=le[ze+2],ke=le[ze+3],Ne=le[ze+4],xe=le[ze+5],$e=le[ze+6];var je=ve+(Ee=le[ze+7]),Xe=ve-Ee,ht=pe+$e,ut=pe-$e,Ue=ge+xe,it=ge-xe,dt=ke+Ne,Fe=ke-Ne,Be=je+dt,Re=je-dt,lt=ht+Ue,ot=ht-Ue;le[ze]=Be+lt,le[ze+4]=Be-lt;var nt=.707106781*(ot+Re);le[ze+2]=Re+nt,le[ze+6]=Re-nt;var Ve=.382683433*((Be=Fe+it)-(ot=ut+Xe)),qt=.5411961*Be+Ve,Mt=1.306562965*ot+Ve,Qt=.707106781*(lt=it+ut),lr=Xe+Qt,bt=Xe-Qt;le[ze+5]=bt+qt,le[ze+3]=bt-qt,le[ze+1]=lr+Mt,le[ze+7]=lr-Mt,ze+=8}for(ze=0,Me=0;Me<8;++Me){ve=le[ze],pe=le[ze+8],ge=le[ze+16],ke=le[ze+24],Ne=le[ze+32],xe=le[ze+40],$e=le[ze+48];var yr=ve+(Ee=le[ze+56]),Cr=ve-Ee,Kt=pe+$e,sr=pe-$e,pt=ge+xe,gt=ge-xe,Vt=ke+Ne,gr=ke-Ne,et=yr+Vt,ft=yr-Vt,At=Kt+pt,Yt=Kt-pt;le[ze]=et+At,le[ze+32]=et-At;var hr=.707106781*(Yt+ft);le[ze+16]=ft+hr,le[ze+48]=ft-hr;var Pr=.382683433*((et=gr+gt)-(Yt=sr+Cr)),Jr=.5411961*et+Pr,Tr=1.306562965*Yt+Pr,zr=.707106781*(At=gt+sr),Xr=Cr+zr,pr=Cr-zr;le[ze+40]=pr+Jr,le[ze+24]=pr-Jr,le[ze+8]=Xr+Tr,le[ze+56]=Xr-Tr,ze++}for(Me=0;Me<64;++Me)Ye=le[Me]*ye[Me],f[Me]=Ye>0?Ye+.5|0:Ye-.5|0;return f}(F,k),G=0;G<64;++G)w[C[G]]=M[G];var Q=w[0]-N;N=w[0],Q==0?O(A[0]):(O(A[g[Z=32767+Q]]),O(y[Z]));for(var ie=63;ie>0&&w[ie]==0;)ie--;if(ie==0)return O(H),N;for(var me,oe=1;oe<=ie;){for(var ee=oe;w[oe]==0&&oe<=ie;)++oe;var de=oe-ee;if(de>=16){me=de>>4;for(var he=1;he<=me;++he)O(B);de&=15}Z=32767+w[oe],O(V[(de<<4)+g[Z]]),O(y[Z]),oe++}return ie!=63&&O(H),N}function se(F){F=Math.min(Math.max(F,1),100),o!=F&&(function(k){for(var N=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],A=0;A<64;A++){var V=s((N[A]*k+50)/100);V=Math.min(Math.max(V,1),255),l[C[A]]=V}for(var Z=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],H=0;H<64;H++){var B=s((Z[H]*k+50)/100);B=Math.min(Math.max(B,1),255),c[C[H]]=B}for(var M=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],G=0,Q=0;Q<8;Q++)for(var ie=0;ie<8;ie++)d[G]=1/(l[C[G]]*M[Q]*M[ie]*8),u[G]=1/(c[C[G]]*M[Q]*M[ie]*8),G++}(F<50?Math.floor(5e3/F):Math.floor(200-2*F)),o=F)}this.encode=function(F,k){k&&se(k),E=new Array,x=0,T=7,X(65496),X(65504),X(16),ne(74),ne(70),ne(73),ne(70),ne(0),ne(1),ne(1),ne(0),X(1),X(1),ne(0),ne(0),function(){X(65499),X(132),ne(0);for(var pe=0;pe<64;pe++)ne(l[pe]);ne(1);for(var ge=0;ge<64;ge++)ne(c[ge])}(),function(pe,ge){X(65472),X(17),ne(8),X(ge),X(pe),ne(3),ne(1),ne(17),ne(0),ne(2),ne(17),ne(1),ne(3),ne(17),ne(1)}(F.width,F.height),function(){X(65476),X(418),ne(0);for(var pe=0;pe<16;pe++)ne(P[pe+1]);for(var ge=0;ge<=11;ge++)ne($[ge]);ne(16);for(var ke=0;ke<16;ke++)ne(D[ke+1]);for(var Ne=0;Ne<=161;Ne++)ne(b[Ne]);ne(1);for(var xe=0;xe<16;xe++)ne(S[xe+1]);for(var $e=0;$e<=11;$e++)ne(v[$e]);ne(17);for(var Ee=0;Ee<16;Ee++)ne(z[Ee+1]);for(var Me=0;Me<=161;Me++)ne(re[Me])}(),X(65498),X(12),ne(3),ne(1),ne(0),ne(2),ne(17),ne(3),ne(17),ne(0),ne(63),ne(0);var N=0,A=0,V=0;x=0,T=7,this.encode.displayName="_encode_";for(var Z,H,B,M,G,Q,ie,me,oe,ee=F.data,de=F.width,he=F.height,le=4*de,ye=0;ye<he;){for(Z=0;Z<le;){for(G=le*ye+Z,ie=-1,me=0,oe=0;oe<64;oe++)Q=G+(me=oe>>3)*le+(ie=4*(7&oe)),ye+me>=he&&(Q-=le*(ye+1+me-he)),Z+ie>=le&&(Q-=Z+ie-le+4),H=ee[Q++],B=ee[Q++],M=ee[Q++],Y[oe]=(J[H]+J[B+256>>0]+J[M+512>>0]>>16)-128,K[oe]=(J[H+768>>0]+J[B+1024>>0]+J[M+1280>>0]>>16)-128,j[oe]=(J[H+1280>>0]+J[B+1536>>0]+J[M+1792>>0]>>16)-128;N=W(Y,d,N,e,n),A=W(K,u,A,r,i),V=W(j,u,V,r,i),Z+=32}ye+=8}if(T>=0){var ve=[];ve[1]=T+1,ve[0]=(1<<T+1)-1,O(ve)}return X(65497),new Uint8Array(E)},t=t||50,function(){for(var F=String.fromCharCode,k=0;k<256;k++)q[k]=F(k)}(),e=L(P,$),r=L(S,v),n=L(D,b),i=L(z,re),function(){for(var F=1,k=2,N=1;N<=15;N++){for(var A=F;A<k;A++)g[32767+A]=N,y[32767+A]=[],y[32767+A][1]=N,y[32767+A][0]=A;for(var V=-(k-1);V<=-F;V++)g[32767+V]=N,y[32767+V]=[],y[32767+V][1]=N,y[32767+V][0]=k-1+V;F<<=1,k<<=1}}(),function(){for(var F=0;F<256;F++)J[F]=19595*F,J[F+256>>0]=38470*F,J[F+512>>0]=7471*F+32768,J[F+768>>0]=-11059*F,J[F+1024>>0]=-21709*F,J[F+1280>>0]=32768*F+8421375,J[F+1536>>0]=-27439*F,J[F+1792>>0]=-5329*F}(),se(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function zo(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Ib(t){function e(P){if(!P)throw Error("assert :P")}function r(P,$,D){for(var b=0;4>b;b++)if(P[$+b]!=D.charCodeAt(b))return!0;return!1}function n(P,$,D,b,S){for(var v=0;v<S;v++)P[$+v]=D[b+v]}function i(P,$,D,b){for(var S=0;S<b;S++)P[$+S]=D}function o(P){return new Int32Array(P)}function s(P,$){for(var D=[],b=0;b<P;b++)D.push(new $);return D}function l(P,$){var D=[];return function b(S,v,z){for(var re=z[v],L=0;L<re&&(S.push(z.length>v+1?[]:new $),!(z.length<v+1));L++)b(S[L],v+1,z)}(D,0,P),D}var c=function(){var P=this;function $(h,_){for(var U=1<<_-1>>>0;h&U;)U>>>=1;return U?(h&U-1)+U:h}function D(h,_,U,ce,_e){e(!(ce%U));do h[_+(ce-=U)]=_e;while(0<ce)}function b(h,_,U,ce,_e){if(e(2328>=_e),512>=_e)var Pe=o(512);else if((Pe=o(_e))==null)return 0;return function(Se,Ae,Ie,Le,He,st){var at,tt,It=Ae,mt=1<<Ie,Ge=o(16),Je=o(16);for(e(He!=0),e(Le!=null),e(Se!=null),e(0<Ie),tt=0;tt<He;++tt){if(15<Le[tt])return 0;++Ge[Le[tt]]}if(Ge[0]==He)return 0;for(Je[1]=0,at=1;15>at;++at){if(Ge[at]>1<<at)return 0;Je[at+1]=Je[at]+Ge[at]}for(tt=0;tt<He;++tt)at=Le[tt],0<Le[tt]&&(st[Je[at]++]=tt);if(Je[15]==1)return(Le=new S).g=0,Le.value=st[0],D(Se,It,1,mt,Le),mt;var xt,Lt=-1,$t=mt-1,ar=0,Xt=1,$r=1,rr=1<<Ie;for(tt=0,at=1,He=2;at<=Ie;++at,He<<=1){if(Xt+=$r<<=1,0>($r-=Ge[at]))return 0;for(;0<Ge[at];--Ge[at])(Le=new S).g=at,Le.value=st[tt++],D(Se,It+ar,He,rr,Le),ar=$(ar,at)}for(at=Ie+1,He=2;15>=at;++at,He<<=1){if(Xt+=$r<<=1,0>($r-=Ge[at]))return 0;for(;0<Ge[at];--Ge[at]){if(Le=new S,(ar&$t)!=Lt){for(It+=rr,xt=1<<(Lt=at)-Ie;15>Lt&&!(0>=(xt-=Ge[Lt]));)++Lt,xt<<=1;mt+=rr=1<<(xt=Lt-Ie),Se[Ae+(Lt=ar&$t)].g=xt+Ie,Se[Ae+Lt].value=It-Ae-Lt}Le.g=at-Ie,Le.value=st[tt++],D(Se,It+(ar>>Ie),He,rr,Le),ar=$(ar,at)}}return Xt!=2*Je[15]-1?0:mt}(h,_,U,ce,_e,Pe)}function S(){this.value=this.g=0}function v(){this.value=this.g=0}function z(){this.G=s(5,S),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(bi,v)}function re(h,_,U,ce){e(h!=null),e(_!=null),e(2147483648>ce),h.Ca=254,h.I=0,h.b=-8,h.Ka=0,h.oa=_,h.pa=U,h.Jd=_,h.Yc=U+ce,h.Zc=4<=ce?U+ce-4+1:U,Z(h)}function L(h,_){for(var U=0;0<_--;)U|=B(h,128)<<_;return U}function O(h,_){var U=L(h,_);return H(h)?-U:U}function ne(h,_,U,ce){var _e,Pe=0;for(e(h!=null),e(_!=null),e(4294967288>ce),h.Sb=ce,h.Ra=0,h.u=0,h.h=0,4<ce&&(ce=4),_e=0;_e<ce;++_e)Pe+=_[U+_e]<<8*_e;h.Ra=Pe,h.bb=ce,h.oa=_,h.pa=U}function X(h){for(;8<=h.u&&h.bb<h.Sb;)h.Ra>>>=8,h.Ra+=h.oa[h.pa+h.bb]<<Yl-8>>>0,++h.bb,h.u-=8;N(h)&&(h.h=1,h.u=0)}function W(h,_){if(e(0<=_),!h.h&&_<=Wl){var U=k(h)&Gl[_];return h.u+=_,X(h),U}return h.h=1,h.u=0}function se(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function F(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function k(h){return h.Ra>>>(h.u&Yl-1)>>>0}function N(h){return e(h.bb<=h.Sb),h.h||h.bb==h.Sb&&h.u>Yl}function A(h,_){h.u=_,h.h=N(h)}function V(h){h.u>=Gc&&(e(h.u>=Gc),X(h))}function Z(h){e(h!=null&&h.oa!=null),h.pa<h.Zc?(h.I=(h.oa[h.pa++]|h.I<<8)>>>0,h.b+=8):(e(h!=null&&h.oa!=null),h.pa<h.Yc?(h.b+=8,h.I=h.oa[h.pa++]|h.I<<8):h.Ka?h.b=0:(h.I<<=8,h.b+=8,h.Ka=1))}function H(h){return L(h,1)}function B(h,_){var U=h.Ca;0>h.b&&Z(h);var ce=h.b,_e=U*_>>>8,Pe=(h.I>>>ce>_e)+0;for(Pe?(U-=_e,h.I-=_e+1<<ce>>>0):U=_e+1,ce=U,_e=0;256<=ce;)_e+=8,ce>>=8;return ce=7^_e+Qi[ce],h.b-=ce,h.Ca=(U<<ce)-1,Pe}function M(h,_,U){h[_+0]=U>>24&255,h[_+1]=U>>16&255,h[_+2]=U>>8&255,h[_+3]=U>>0&255}function G(h,_){return h[_+0]<<0|h[_+1]<<8}function Q(h,_){return G(h,_)|h[_+2]<<16}function ie(h,_){return G(h,_)|G(h,_+2)<<16}function me(h,_){var U=1<<_;return e(h!=null),e(0<_),h.X=o(U),h.X==null?0:(h.Mb=32-_,h.Xa=_,1)}function oe(h,_){e(h!=null),e(_!=null),e(h.Xa==_.Xa),n(_.X,0,h.X,0,1<<_.Xa)}function ee(){this.X=[],this.Xa=this.Mb=0}function de(h,_,U,ce){e(U!=null),e(ce!=null);var _e=U[0],Pe=ce[0];return _e==0&&(_e=(h*Pe+_/2)/_),Pe==0&&(Pe=(_*_e+h/2)/h),0>=_e||0>=Pe?0:(U[0]=_e,ce[0]=Pe,1)}function he(h,_){return h+(1<<_)-1>>>_}function le(h,_){return((4278255360&h)+(4278255360&_)>>>0&4278255360)+((16711935&h)+(16711935&_)>>>0&16711935)>>>0}function ye(h,_){P[_]=function(U,ce,_e,Pe,Se,Ae,Ie){var Le;for(Le=0;Le<Se;++Le){var He=P[h](Ae[Ie+Le-1],_e,Pe+Le);Ae[Ie+Le]=le(U[ce+Le],He)}}}function ve(){this.ud=this.hd=this.jd=0}function pe(h,_){return((4278124286&(h^_))>>>1)+(h&_)>>>0}function ge(h){return 0<=h&&256>h?h:0>h?0:255<h?255:void 0}function ke(h,_){return ge(h+(h-_+.5>>1))}function Ne(h,_,U){return Math.abs(_-U)-Math.abs(h-U)}function xe(h,_,U,ce,_e,Pe,Se){for(ce=Pe[Se-1],U=0;U<_e;++U)Pe[Se+U]=ce=le(h[_+U],ce)}function $e(h,_,U,ce,_e){var Pe;for(Pe=0;Pe<U;++Pe){var Se=h[_+Pe],Ae=Se>>8&255,Ie=16711935&(Ie=(Ie=16711935&Se)+((Ae<<16)+Ae));ce[_e+Pe]=(4278255360&Se)+Ie>>>0}}function Ee(h,_){_.jd=h>>0&255,_.hd=h>>8&255,_.ud=h>>16&255}function Me(h,_,U,ce,_e,Pe){var Se;for(Se=0;Se<ce;++Se){var Ae=_[U+Se],Ie=Ae>>>8,Le=Ae,He=255&(He=(He=Ae>>>16)+((h.jd<<24>>24)*(Ie<<24>>24)>>>5));Le=255&(Le=(Le=Le+((h.hd<<24>>24)*(Ie<<24>>24)>>>5))+((h.ud<<24>>24)*(He<<24>>24)>>>5)),_e[Pe+Se]=(4278255360&Ae)+(He<<16)+Le}}function Ye(h,_,U,ce,_e){P[_]=function(Pe,Se,Ae,Ie,Le,He,st,at,tt){for(Ie=st;Ie<at;++Ie)for(st=0;st<tt;++st)Le[He++]=_e(Ae[ce(Pe[Se++])])},P[h]=function(Pe,Se,Ae,Ie,Le,He,st){var at=8>>Pe.b,tt=Pe.Ea,It=Pe.K[0],mt=Pe.w;if(8>at)for(Pe=(1<<Pe.b)-1,mt=(1<<at)-1;Se<Ae;++Se){var Ge,Je=0;for(Ge=0;Ge<tt;++Ge)Ge&Pe||(Je=ce(Ie[Le++])),He[st++]=_e(It[Je&mt]),Je>>=at}else P["VP8LMapColor"+U](Ie,Le,It,mt,He,st,Se,Ae,tt)}}function ze(h,_,U,ce,_e){for(U=_+U;_<U;){var Pe=h[_++];ce[_e++]=Pe>>16&255,ce[_e++]=Pe>>8&255,ce[_e++]=Pe>>0&255}}function je(h,_,U,ce,_e){for(U=_+U;_<U;){var Pe=h[_++];ce[_e++]=Pe>>16&255,ce[_e++]=Pe>>8&255,ce[_e++]=Pe>>0&255,ce[_e++]=Pe>>24&255}}function Xe(h,_,U,ce,_e){for(U=_+U;_<U;){var Pe=(Se=h[_++])>>16&240|Se>>12&15,Se=Se>>0&240|Se>>28&15;ce[_e++]=Pe,ce[_e++]=Se}}function ht(h,_,U,ce,_e){for(U=_+U;_<U;){var Pe=(Se=h[_++])>>16&248|Se>>13&7,Se=Se>>5&224|Se>>3&31;ce[_e++]=Pe,ce[_e++]=Se}}function ut(h,_,U,ce,_e){for(U=_+U;_<U;){var Pe=h[_++];ce[_e++]=Pe>>0&255,ce[_e++]=Pe>>8&255,ce[_e++]=Pe>>16&255}}function Ue(h,_,U,ce,_e,Pe){if(Pe==0)for(U=_+U;_<U;)M(ce,((Pe=h[_++])[0]>>24|Pe[1]>>8&65280|Pe[2]<<8&16711680|Pe[3]<<24)>>>0),_e+=32;else n(ce,_e,h,_,U)}function it(h,_){P[_][0]=P[h+"0"],P[_][1]=P[h+"1"],P[_][2]=P[h+"2"],P[_][3]=P[h+"3"],P[_][4]=P[h+"4"],P[_][5]=P[h+"5"],P[_][6]=P[h+"6"],P[_][7]=P[h+"7"],P[_][8]=P[h+"8"],P[_][9]=P[h+"9"],P[_][10]=P[h+"10"],P[_][11]=P[h+"11"],P[_][12]=P[h+"12"],P[_][13]=P[h+"13"],P[_][14]=P[h+"0"],P[_][15]=P[h+"0"]}function dt(h){return h==Rp||h==Dp||h==wu||h==Mp}function Fe(){this.eb=[],this.size=this.A=this.fb=0}function Be(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Re(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Fe,this.f.kb=new Be,this.sd=null}function lt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function ot(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function nt(h){return alert("todo:WebPSamplerProcessPlane"),h.T}function Ve(h,_){var U=h.T,ce=_.ba.f.RGBA,_e=ce.eb,Pe=ce.fb+h.ka*ce.A,Se=Io[_.ba.S],Ae=h.y,Ie=h.O,Le=h.f,He=h.N,st=h.ea,at=h.W,tt=_.cc,It=_.dc,mt=_.Mc,Ge=_.Nc,Je=h.ka,xt=h.ka+h.T,Lt=h.U,$t=Lt+1>>1;for(Je==0?Se(Ae,Ie,null,null,Le,He,st,at,Le,He,st,at,_e,Pe,null,null,Lt):(Se(_.ec,_.fc,Ae,Ie,tt,It,mt,Ge,Le,He,st,at,_e,Pe-ce.A,_e,Pe,Lt),++U);Je+2<xt;Je+=2)tt=Le,It=He,mt=st,Ge=at,He+=h.Rc,at+=h.Rc,Pe+=2*ce.A,Se(Ae,(Ie+=2*h.fa)-h.fa,Ae,Ie,tt,It,mt,Ge,Le,He,st,at,_e,Pe-ce.A,_e,Pe,Lt);return Ie+=h.fa,h.j+xt<h.o?(n(_.ec,_.fc,Ae,Ie,Lt),n(_.cc,_.dc,Le,He,$t),n(_.Mc,_.Nc,st,at,$t),U--):1&xt||Se(Ae,Ie,null,null,Le,He,st,at,Le,He,st,at,_e,Pe+ce.A,null,null,Lt),U}function qt(h,_,U){var ce=h.F,_e=[h.J];if(ce!=null){var Pe=h.U,Se=_.ba.S,Ae=Se==Su||Se==wu;_=_.ba.f.RGBA;var Ie=[0],Le=h.ka;Ie[0]=h.T,h.Kb&&(Le==0?--Ie[0]:(--Le,_e[0]-=h.width),h.j+h.ka+h.T==h.o&&(Ie[0]=h.o-h.j-Le));var He=_.eb;Le=_.fb+Le*_.A,h=Tn(ce,_e[0],h.width,Pe,Ie,He,Le+(Ae?0:3),_.A),e(U==Ie),h&&dt(Se)&&$o(He,Le,Ae,Pe,Ie,_.A)}return 0}function Mt(h){var _=h.ma,U=_.ba.S,ce=11>U,_e=U==_u||U==Pu||U==Su||U==Lp||U==12||dt(U);if(_.memory=null,_.Ib=null,_.Jb=null,_.Nd=null,!Uc(_.Oa,h,_e?11:12))return 0;if(_e&&dt(U)&&Dt(),h.da)alert("todo:use_scaling");else{if(ce){if(_.Ib=nt,h.Kb){if(U=h.U+1>>1,_.memory=o(h.U+2*U),_.memory==null)return 0;_.ec=_.memory,_.fc=0,_.cc=_.ec,_.dc=_.fc+h.U,_.Mc=_.cc,_.Nc=_.dc+U,_.Ib=Ve,Dt()}}else alert("todo:EmitYUV");_e&&(_.Jb=qt,ce&&Ze())}if(ce&&!wg){for(h=0;256>h;++h)AP[h]=89858*(h-128)+Cu>>xu,IP[h]=-22014*(h-128)+Cu,EP[h]=-45773*(h-128),$P[h]=113618*(h-128)+Cu>>xu;for(h=Zc;h<Bp;++h)_=76283*(h-16)+Cu>>xu,TP[h-Zc]=fn(_,255),kP[h-Zc]=fn(_+8>>4,15);wg=1}return 1}function Qt(h){var _=h.ma,U=h.U,ce=h.T;return e(!(1&h.ka)),0>=U||0>=ce?0:(U=_.Ib(h,_),_.Jb!=null&&_.Jb(h,_,U),_.Dc+=U,1)}function lr(h){h.ma.memory=null}function bt(h,_,U,ce){return W(h,8)!=47?0:(_[0]=W(h,14)+1,U[0]=W(h,14)+1,ce[0]=W(h,1),W(h,3)!=0?0:!h.h)}function yr(h,_){if(4>h)return h+1;var U=h-2>>1;return(2+(1&h)<<U)+W(_,U)+1}function Cr(h,_){return 120<_?_-120:1<=(U=((U=hP[_-1])>>4)*h+(8-(15&U)))?U:1;var U}function Kt(h,_,U){var ce=k(U),_e=h[_+=255&ce].g-8;return 0<_e&&(A(U,U.u+8),ce=k(U),_+=h[_].value,_+=ce&(1<<_e)-1),A(U,U.u+h[_].g),h[_].value}function sr(h,_,U){return U.g+=h.g,U.value+=h.value<<_>>>0,e(8>=U.g),h.g}function pt(h,_,U){var ce=h.xc;return e((_=ce==0?0:h.vc[h.md*(U>>ce)+(_>>ce)])<h.Wb),h.Ya[_]}function gt(h,_,U,ce){var _e=h.ab,Pe=h.c*_,Se=h.C;_=Se+_;var Ae=U,Ie=ce;for(ce=h.Ta,U=h.Ua;0<_e--;){var Le=h.gc[_e],He=Se,st=_,at=Ae,tt=Ie,It=(Ie=ce,Ae=U,Le.Ea);switch(e(He<st),e(st<=Le.nc),Le.hc){case 2:pu(at,tt,(st-He)*It,Ie,Ae);break;case 0:var mt=He,Ge=st,Je=Ie,xt=Ae,Lt=(rr=Le).Ea;mt==0&&(kp(at,tt,null,null,1,Je,xt),xe(at,tt+1,0,0,Lt-1,Je,xt+1),tt+=Lt,xt+=Lt,++mt);for(var $t=1<<rr.b,ar=$t-1,Xt=he(Lt,rr.b),$r=rr.K,rr=rr.w+(mt>>rr.b)*Xt;mt<Ge;){var mn=$r,vn=rr,cn=1;for(Wc(at,tt,Je,xt-Lt,1,Je,xt);cn<Lt;){var rn=(cn&~ar)+$t;rn>Lt&&(rn=Lt),(0,ha[mn[vn++]>>8&15])(at,tt+ +cn,Je,xt+cn-Lt,rn-cn,Je,xt+cn),cn=rn}tt+=Lt,xt+=Lt,++mt&ar||(rr+=Xt)}st!=Le.nc&&n(Ie,Ae-It,Ie,Ae+(st-He-1)*It,It);break;case 1:for(It=at,Ge=tt,Lt=(at=Le.Ea)-(xt=at&~(Je=(tt=1<<Le.b)-1)),mt=he(at,Le.b),$t=Le.K,Le=Le.w+(He>>Le.b)*mt;He<st;){for(ar=$t,Xt=Le,$r=new ve,rr=Ge+xt,mn=Ge+at;Ge<rr;)Ee(ar[Xt++],$r),ol($r,It,Ge,tt,Ie,Ae),Ge+=tt,Ae+=tt;Ge<mn&&(Ee(ar[Xt++],$r),ol($r,It,Ge,Lt,Ie,Ae),Ge+=Lt,Ae+=Lt),++He&Je||(Le+=mt)}break;case 3:if(at==Ie&&tt==Ae&&0<Le.b){for(Ge=Ie,at=It=Ae+(st-He)*It-(xt=(st-He)*he(Le.Ea,Le.b)),tt=Ie,Je=Ae,mt=[],xt=(Lt=xt)-1;0<=xt;--xt)mt[xt]=tt[Je+xt];for(xt=Lt-1;0<=xt;--xt)Ge[at+xt]=mt[xt];xo(Le,He,st,Ie,It,Ie,Ae)}else xo(Le,He,st,at,tt,Ie,Ae)}Ae=ce,Ie=U}Ie!=U&&n(ce,U,Ae,Ie,Pe)}function Vt(h,_){var U=h.V,ce=h.Ba+h.c*h.C,_e=_-h.C;if(e(_<=h.l.o),e(16>=_e),0<_e){var Pe=h.l,Se=h.Ta,Ae=h.Ua,Ie=Pe.width;if(gt(h,_e,U,ce),_e=Ae=[Ae],e((U=h.C)<(ce=_)),e(Pe.v<Pe.va),ce>Pe.o&&(ce=Pe.o),U<Pe.j){var Le=Pe.j-U;U=Pe.j,_e[0]+=Le*Ie}if(U>=ce?U=0:(_e[0]+=4*Pe.v,Pe.ka=U-Pe.j,Pe.U=Pe.va-Pe.v,Pe.T=ce-U,U=1),U){if(Ae=Ae[0],11>(U=h.ca).S){var He=U.f.RGBA,st=(ce=U.S,_e=Pe.U,Pe=Pe.T,Le=He.eb,He.A),at=Pe;for(He=He.fb+h.Ma*He.A;0<at--;){var tt=Se,It=Ae,mt=_e,Ge=Le,Je=He;switch(ce){case bu:Xi(tt,It,mt,Ge,Je);break;case _u:Hi(tt,It,mt,Ge,Je);break;case Rp:Hi(tt,It,mt,Ge,Je),$o(Ge,Je,0,mt,1,0);break;case mg:Ts(tt,It,mt,Ge,Je);break;case Pu:Ue(tt,It,mt,Ge,Je,1);break;case Dp:Ue(tt,It,mt,Ge,Je,1),$o(Ge,Je,0,mt,1,0);break;case Su:Ue(tt,It,mt,Ge,Je,0);break;case wu:Ue(tt,It,mt,Ge,Je,0),$o(Ge,Je,1,mt,1,0);break;case Lp:pa(tt,It,mt,Ge,Je);break;case Mp:pa(tt,It,mt,Ge,Je),In(Ge,Je,mt,1,0);break;case fg:Is(tt,It,mt,Ge,Je);break;default:e(0)}Ae+=Ie,He+=st}h.Ma+=Pe}else alert("todo:EmitRescaledRowsYUVA");e(h.Ma<=U.height)}}h.C=_,e(h.C<=h.i)}function gr(h){var _;if(0<h.ua)return 0;for(_=0;_<h.Wb;++_){var U=h.Ya[_].G,ce=h.Ya[_].H;if(0<U[1][ce[1]+0].g||0<U[2][ce[2]+0].g||0<U[3][ce[3]+0].g)return 0}return 1}function et(h,_,U,ce,_e,Pe){if(h.Z!=0){var Se=h.qd,Ae=h.rd;for(e(ga[h.Z]!=null);_<U;++_)ga[h.Z](Se,Ae,ce,_e,ce,_e,Pe),Se=ce,Ae=_e,_e+=Pe;h.qd=Se,h.rd=Ae}}function ft(h,_){var U=h.l.ma,ce=U.Z==0||U.Z==1?h.l.j:h.C;if(ce=h.C<ce?ce:h.C,e(_<=h.l.o),_>ce){var _e=h.l.width,Pe=U.ca,Se=U.tb+_e*ce,Ae=h.V,Ie=h.Ba+h.c*ce,Le=h.gc;e(h.ab==1),e(Le[0].hc==3),mu(Le[0],ce,_,Ae,Ie,Pe,Se),et(U,ce,_,Pe,Se,_e)}h.C=h.Ma=_}function At(h,_,U,ce,_e,Pe,Se){var Ae=h.$/ce,Ie=h.$%ce,Le=h.m,He=h.s,st=U+h.$,at=st;_e=U+ce*_e;var tt=U+ce*Pe,It=280+He.ua,mt=h.Pb?Ae:16777216,Ge=0<He.ua?He.Wa:null,Je=He.wc,xt=st<tt?pt(He,Ie,Ae):null;e(h.C<Pe),e(tt<=_e);var Lt=!1;e:for(;;){for(;Lt||st<tt;){var $t=0;if(Ae>=mt){var ar=st-U;e((mt=h).Pb),mt.wd=mt.m,mt.xd=ar,0<mt.s.ua&&oe(mt.s.Wa,mt.s.vb),mt=Ae+mP}if(Ie&Je||(xt=pt(He,Ie,Ae)),e(xt!=null),xt.Qb&&(_[st]=xt.qb,Lt=!0),!Lt)if(V(Le),xt.jc){$t=Le,ar=_;var Xt=st,$r=xt.pd[k($t)&bi-1];e(xt.jc),256>$r.g?(A($t,$t.u+$r.g),ar[Xt]=$r.value,$t=0):(A($t,$t.u+$r.g-256),e(256<=$r.value),$t=$r.value),$t==0&&(Lt=!0)}else $t=Kt(xt.G[0],xt.H[0],Le);if(Le.h)break;if(Lt||256>$t){if(!Lt)if(xt.nd)_[st]=(xt.qb|$t<<8)>>>0;else{if(V(Le),Lt=Kt(xt.G[1],xt.H[1],Le),V(Le),ar=Kt(xt.G[2],xt.H[2],Le),Xt=Kt(xt.G[3],xt.H[3],Le),Le.h)break;_[st]=(Xt<<24|Lt<<16|$t<<8|ar)>>>0}if(Lt=!1,++st,++Ie>=ce&&(Ie=0,++Ae,Se!=null&&Ae<=Pe&&!(Ae%16)&&Se(h,Ae),Ge!=null))for(;at<st;)$t=_[at++],Ge.X[(506832829*$t&4294967295)>>>Ge.Mb]=$t}else if(280>$t){if($t=yr($t-256,Le),ar=Kt(xt.G[4],xt.H[4],Le),V(Le),ar=Cr(ce,ar=yr(ar,Le)),Le.h)break;if(st-U<ar||_e-st<$t)break e;for(Xt=0;Xt<$t;++Xt)_[st+Xt]=_[st+Xt-ar];for(st+=$t,Ie+=$t;Ie>=ce;)Ie-=ce,++Ae,Se!=null&&Ae<=Pe&&!(Ae%16)&&Se(h,Ae);if(e(st<=_e),Ie&Je&&(xt=pt(He,Ie,Ae)),Ge!=null)for(;at<st;)$t=_[at++],Ge.X[(506832829*$t&4294967295)>>>Ge.Mb]=$t}else{if(!($t<It))break e;for(Lt=$t-280,e(Ge!=null);at<st;)$t=_[at++],Ge.X[(506832829*$t&4294967295)>>>Ge.Mb]=$t;$t=st,e(!(Lt>>>(ar=Ge).Xa)),_[$t]=ar.X[Lt],Lt=!0}Lt||e(Le.h==N(Le))}if(h.Pb&&Le.h&&st<_e)e(h.m.h),h.a=5,h.m=h.wd,h.$=h.xd,0<h.s.ua&&oe(h.s.vb,h.s.Wa);else{if(Le.h)break e;Se?.(h,Ae>Pe?Pe:Ae),h.a=0,h.$=st-U}return 1}return h.a=3,0}function Yt(h){e(h!=null),h.vc=null,h.yc=null,h.Ya=null;var _=h.Wa;_!=null&&(_.X=null),h.vb=null,e(h!=null)}function hr(){var h=new Ul;return h==null?null:(h.a=0,h.xb=vg,it("Predictor","VP8LPredictors"),it("Predictor","VP8LPredictors_C"),it("PredictorAdd","VP8LPredictorsAdd"),it("PredictorAdd","VP8LPredictorsAdd_C"),pu=$e,ol=Me,Xi=ze,Hi=je,pa=Xe,Is=ht,Ts=ut,P.VP8LMapColor32b=Kl,P.VP8LMapColor8b=fu,h)}function Pr(h,_,U,ce,_e){var Pe=1,Se=[h],Ae=[_],Ie=ce.m,Le=ce.s,He=null,st=0;e:for(;;){if(U)for(;Pe&&W(Ie,1);){var at=Se,tt=Ae,It=ce,mt=1,Ge=It.m,Je=It.gc[It.ab],xt=W(Ge,2);if(It.Oc&1<<xt)Pe=0;else{switch(It.Oc|=1<<xt,Je.hc=xt,Je.Ea=at[0],Je.nc=tt[0],Je.K=[null],++It.ab,e(4>=It.ab),xt){case 0:case 1:Je.b=W(Ge,3)+2,mt=Pr(he(Je.Ea,Je.b),he(Je.nc,Je.b),0,It,Je.K),Je.K=Je.K[0];break;case 3:var Lt,$t=W(Ge,8)+1,ar=16<$t?0:4<$t?1:2<$t?2:3;if(at[0]=he(Je.Ea,ar),Je.b=ar,Lt=mt=Pr($t,1,0,It,Je.K)){var Xt,$r=$t,rr=Je,mn=1<<(8>>rr.b),vn=o(mn);if(vn==null)Lt=0;else{var cn=rr.K[0],rn=rr.w;for(vn[0]=rr.K[0][0],Xt=1;Xt<1*$r;++Xt)vn[Xt]=le(cn[rn+Xt],vn[Xt-1]);for(;Xt<4*mn;++Xt)vn[Xt]=0;rr.K[0]=null,rr.K[0]=vn,Lt=1}}mt=Lt;break;case 2:break;default:e(0)}Pe=mt}}if(Se=Se[0],Ae=Ae[0],Pe&&W(Ie,1)&&!(Pe=1<=(st=W(Ie,4))&&11>=st)){ce.a=3;break e}var Cn;if(Cn=Pe)t:{var Sn,Ur,ti,Zi=ce,ri=Se,eo=Ae,bn=st,fo=U,yo=Zi.m,hi=Zi.s,_i=[null],Wi=1,To=0,ss=pP[bn];r:for(;;){if(fo&&W(yo,1)){var pi=W(yo,3)+2,Rs=he(ri,pi),dl=he(eo,pi),ec=Rs*dl;if(!Pr(Rs,dl,0,Zi,_i))break r;for(_i=_i[0],hi.xc=pi,Sn=0;Sn<ec;++Sn){var va=_i[Sn]>>8&65535;_i[Sn]=va,va>=Wi&&(Wi=va+1)}}if(yo.h)break r;for(Ur=0;5>Ur;++Ur){var zn=yg[Ur];!Ur&&0<bn&&(zn+=1<<bn),To<zn&&(To=zn)}var jp=s(Wi*ss,S),Ag=Wi,$g=s(Ag,z);if($g==null)var $u=null;else e(65536>=Ag),$u=$g;var ed=o(To);if($u==null||ed==null||jp==null){Zi.a=1;break r}var Eu=jp;for(Sn=ti=0;Sn<Wi;++Sn){var Vo=$u[Sn],tc=Vo.G,rc=Vo.H,Eg=0,Iu=1,Ig=0;for(Ur=0;5>Ur;++Ur){zn=yg[Ur],tc[Ur]=Eu,rc[Ur]=ti,!Ur&&0<bn&&(zn+=1<<bn);i:{var Tu,Vp=zn,ku=Zi,td=ed,RP=Eu,DP=ti,qp=0,ba=ku.m,MP=W(ba,1);if(i(td,0,0,Vp),MP){var FP=W(ba,1)+1,OP=W(ba,1),Tg=W(ba,OP==0?1:8);td[Tg]=1,FP==2&&(td[Tg=W(ba,8)]=1);var Nu=1}else{var kg=o(19),Ng=W(ba,4)+4;if(19<Ng){ku.a=3;var Lu=0;break i}for(Tu=0;Tu<Ng;++Tu)kg[uP[Tu]]=W(ba,3);var zp=void 0,rd=void 0,Lg=ku,BP=kg,Ru=Vp,Rg=td,Up=0,_a=Lg.m,Dg=8,Mg=s(128,S);n:for(;b(Mg,0,7,BP,19);){if(W(_a,1)){var jP=2+2*W(_a,3);if((zp=2+W(_a,jP))>Ru)break n}else zp=Ru;for(rd=0;rd<Ru&&zp--;){V(_a);var Fg=Mg[0+(127&k(_a))];A(_a,_a.u+Fg.g);var nc=Fg.value;if(16>nc)Rg[rd++]=nc,nc!=0&&(Dg=nc);else{var VP=nc==16,Og=nc-16,qP=cP[Og],Bg=W(_a,lP[Og])+qP;if(rd+Bg>Ru)break n;for(var zP=VP?Dg:0;0<Bg--;)Rg[rd++]=zP}}Up=1;break n}Up||(Lg.a=3),Nu=Up}(Nu=Nu&&!ba.h)&&(qp=b(RP,DP,8,td,Vp)),Nu&&qp!=0?Lu=qp:(ku.a=3,Lu=0)}if(Lu==0)break r;if(Iu&&dP[Ur]==1&&(Iu=Eu[ti].g==0),Eg+=Eu[ti].g,ti+=Lu,3>=Ur){var nd,Hp=ed[0];for(nd=1;nd<zn;++nd)ed[nd]>Hp&&(Hp=ed[nd]);Ig+=Hp}}if(Vo.nd=Iu,Vo.Qb=0,Iu&&(Vo.qb=(tc[3][rc[3]+0].value<<24|tc[1][rc[1]+0].value<<16|tc[2][rc[2]+0].value)>>>0,Eg==0&&256>tc[0][rc[0]+0].value&&(Vo.Qb=1,Vo.qb+=tc[0][rc[0]+0].value<<8)),Vo.jc=!Vo.Qb&&6>Ig,Vo.jc){var Du,Ds=Vo;for(Du=0;Du<bi;++Du){var Pa=Du,Sa=Ds.pd[Pa],Mu=Ds.G[0][Ds.H[0]+Pa];256<=Mu.value?(Sa.g=Mu.g+256,Sa.value=Mu.value):(Sa.g=0,Sa.value=0,Pa>>=sr(Mu,8,Sa),Pa>>=sr(Ds.G[1][Ds.H[1]+Pa],16,Sa),Pa>>=sr(Ds.G[2][Ds.H[2]+Pa],0,Sa),sr(Ds.G[3][Ds.H[3]+Pa],24,Sa))}}}hi.vc=_i,hi.Wb=Wi,hi.Ya=$u,hi.yc=jp,Cn=1;break t}Cn=0}if(!(Pe=Cn)){ce.a=3;break e}if(0<st){if(Le.ua=1<<st,!me(Le.Wa,st)){ce.a=1,Pe=0;break e}}else Le.ua=0;var Gp=ce,jg=Se,UP=Ae,Wp=Gp.s,Yp=Wp.xc;if(Gp.c=jg,Gp.i=UP,Wp.md=he(jg,Yp),Wp.wc=Yp==0?-1:(1<<Yp)-1,U){ce.xb=PP;break e}if((He=o(Se*Ae))==null){ce.a=1,Pe=0;break e}Pe=(Pe=At(ce,He,0,Se,Ae,Ae,null))&&!Ie.h;break e}return Pe?(_e!=null?_e[0]=He:(e(He==null),e(U)),ce.$=0,U||Yt(Le)):Yt(Le),Pe}function Jr(h,_){var U=h.c*h.i,ce=U+_+16*_;return e(h.c<=_),h.V=o(ce),h.V==null?(h.Ta=null,h.Ua=0,h.a=1,0):(h.Ta=h.V,h.Ua=h.Ba+U+_,1)}function Tr(h,_){var U=h.C,ce=_-U,_e=h.V,Pe=h.Ba+h.c*U;for(e(_<=h.l.o);0<ce;){var Se=16<ce?16:ce,Ae=h.l.ma,Ie=h.l.width,Le=Ie*Se,He=Ae.ca,st=Ae.tb+Ie*U,at=h.Ta,tt=h.Ua;gt(h,Se,_e,Pe),Wn(at,tt,He,st,Le),et(Ae,U,U+Se,He,st,Ie),ce-=Se,_e+=Se*h.c,U+=Se}e(U==_),h.C=h.Ma=_}function zr(){this.ub=this.yd=this.td=this.Rb=0}function Xr(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function pr(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function Jt(){this.Yb=function(){var h=[];return function _(U,ce,_e){for(var Pe=_e[ce],Se=0;Se<Pe&&(U.push(_e.length>ce+1?[]:0),!(_e.length<ce+1));Se++)_(U[Se],ce+1,_e)}(h,0,[3,11]),h}()}function Yr(){this.jb=o(3),this.Wc=l([4,8],Jt),this.Xc=l([4,17],Jt)}function Lr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function We(){this.ld=this.La=this.dd=this.tc=0}function Bt(){this.Na=this.la=0}function Ft(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ht(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ke(){this.uc=this.M=this.Nb=0,this.wa=Array(new We),this.Y=0,this.ya=Array(new Ht),this.aa=0,this.l=new xr}function Zt(){this.y=o(16),this.f=o(8),this.ea=o(8)}function Wt(){this.cb=this.a=0,this.sc="",this.m=new se,this.Od=new zr,this.Kc=new Xr,this.ed=new Lr,this.Qa=new pr,this.Ic=this.$c=this.Aa=0,this.D=new Ke,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,se),this.ia=0,this.pb=s(4,Ft),this.Pa=new Yr,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Zt),this.Hd=0,this.rb=Array(new Bt),this.sb=0,this.wa=Array(new We),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ht),this.L=this.aa=0,this.gd=l([4,2],We),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function xr(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Hr(){var h=new Wt;return h!=null&&(h.a=0,h.sc="OK",h.cb=0,h.Xb=0,Xc||(Xc=hn)),h}function mr(h,_,U){return h.a==0&&(h.a=_,h.sc=U,h.cb=0),0}function Vr(h,_,U){return 3<=U&&h[_+0]==157&&h[_+1]==1&&h[_+2]==42}function Qr(h,_){if(h==null)return 0;if(h.a=0,h.sc="OK",_==null)return mr(h,2,"null VP8Io passed to VP8GetHeaders()");var U=_.data,ce=_.w,_e=_.ha;if(4>_e)return mr(h,7,"Truncated header.");var Pe=U[ce+0]|U[ce+1]<<8|U[ce+2]<<16,Se=h.Od;if(Se.Rb=!(1&Pe),Se.td=Pe>>1&7,Se.yd=Pe>>4&1,Se.ub=Pe>>5,3<Se.td)return mr(h,3,"Incorrect keyframe parameters.");if(!Se.yd)return mr(h,4,"Frame not displayable.");ce+=3,_e-=3;var Ae=h.Kc;if(Se.Rb){if(7>_e)return mr(h,7,"cannot parse picture header");if(!Vr(U,ce,_e))return mr(h,3,"Bad code word");Ae.c=16383&(U[ce+4]<<8|U[ce+3]),Ae.Td=U[ce+4]>>6,Ae.i=16383&(U[ce+6]<<8|U[ce+5]),Ae.Ud=U[ce+6]>>6,ce+=7,_e-=7,h.za=Ae.c+15>>4,h.Ub=Ae.i+15>>4,_.width=Ae.c,_.height=Ae.i,_.Da=0,_.j=0,_.v=0,_.va=_.width,_.o=_.height,_.da=0,_.ib=_.width,_.hb=_.height,_.U=_.width,_.T=_.height,i((Pe=h.Pa).jb,0,255,Pe.jb.length),e((Pe=h.Qa)!=null),Pe.Cb=0,Pe.Bb=0,Pe.Fb=1,i(Pe.Zb,0,0,Pe.Zb.length),i(Pe.Lb,0,0,Pe.Lb)}if(Se.ub>_e)return mr(h,7,"bad partition length");re(Pe=h.m,U,ce,Se.ub),ce+=Se.ub,_e-=Se.ub,Se.Rb&&(Ae.Ld=H(Pe),Ae.Kd=H(Pe)),Ae=h.Qa;var Ie,Le=h.Pa;if(e(Pe!=null),e(Ae!=null),Ae.Cb=H(Pe),Ae.Cb){if(Ae.Bb=H(Pe),H(Pe)){for(Ae.Fb=H(Pe),Ie=0;4>Ie;++Ie)Ae.Zb[Ie]=H(Pe)?O(Pe,7):0;for(Ie=0;4>Ie;++Ie)Ae.Lb[Ie]=H(Pe)?O(Pe,6):0}if(Ae.Bb)for(Ie=0;3>Ie;++Ie)Le.jb[Ie]=H(Pe)?L(Pe,8):255}else Ae.Bb=0;if(Pe.Ka)return mr(h,3,"cannot parse segment header");if((Ae=h.ed).zd=H(Pe),Ae.Tb=L(Pe,6),Ae.wb=L(Pe,3),Ae.Pc=H(Pe),Ae.Pc&&H(Pe)){for(Le=0;4>Le;++Le)H(Pe)&&(Ae.vd[Le]=O(Pe,6));for(Le=0;4>Le;++Le)H(Pe)&&(Ae.od[Le]=O(Pe,6))}if(h.L=Ae.Tb==0?0:Ae.zd?1:2,Pe.Ka)return mr(h,3,"cannot parse filter header");var He=_e;if(_e=Ie=ce,ce=Ie+He,Ae=He,h.Xb=(1<<L(h.m,2))-1,He<3*(Le=h.Xb))U=7;else{for(Ie+=3*Le,Ae-=3*Le,He=0;He<Le;++He){var st=U[_e+0]|U[_e+1]<<8|U[_e+2]<<16;st>Ae&&(st=Ae),re(h.Jc[+He],U,Ie,st),Ie+=st,Ae-=st,_e+=3}re(h.Jc[+Le],U,Ie,Ae),U=Ie<ce?0:5}if(U!=0)return mr(h,U,"cannot parse partitions");for(U=L(Ie=h.m,7),_e=H(Ie)?O(Ie,4):0,ce=H(Ie)?O(Ie,4):0,Ae=H(Ie)?O(Ie,4):0,Le=H(Ie)?O(Ie,4):0,Ie=H(Ie)?O(Ie,4):0,He=h.Qa,st=0;4>st;++st){if(He.Cb){var at=He.Zb[st];He.Fb||(at+=U)}else{if(0<st){h.pb[st]=h.pb[0];continue}at=U}var tt=h.pb[st];tt.Sc[0]=Fp[fn(at+_e,127)],tt.Sc[1]=Op[fn(at+0,127)],tt.Eb[0]=2*Fp[fn(at+ce,127)],tt.Eb[1]=101581*Op[fn(at+Ae,127)]>>16,8>tt.Eb[1]&&(tt.Eb[1]=8),tt.Qc[0]=Fp[fn(at+Le,117)],tt.Qc[1]=Op[fn(at+Ie,127)],tt.lc=at+Ie}if(!Se.Rb)return mr(h,4,"Not a key frame.");for(H(Pe),Se=h.Pa,U=0;4>U;++U){for(_e=0;8>_e;++_e)for(ce=0;3>ce;++ce)for(Ae=0;11>Ae;++Ae)Le=B(Pe,bP[U][_e][ce][Ae])?L(Pe,8):gP[U][_e][ce][Ae],Se.Wc[U][_e].Yb[ce][Ae]=Le;for(_e=0;17>_e;++_e)Se.Xc[U][_e]=Se.Wc[U][_P[_e]]}return h.kc=H(Pe),h.kc&&(h.Bd=L(Pe,8)),h.cb=1}function hn(h,_,U,ce,_e,Pe,Se){var Ae=_[_e].Yb[U];for(U=0;16>_e;++_e){if(!B(h,Ae[U+0]))return _e;for(;!B(h,Ae[U+1]);)if(Ae=_[++_e].Yb[0],U=0,_e==16)return 16;var Ie=_[_e+1].Yb;if(B(h,Ae[U+2])){var Le=h,He=0;if(B(Le,(at=Ae)[(st=U)+3]))if(B(Le,at[st+6])){for(Ae=0,st=2*(He=B(Le,at[st+8]))+(at=B(Le,at[st+9+He])),He=0,at=fP[st];at[Ae];++Ae)He+=He+B(Le,at[Ae]);He+=3+(8<<st)}else B(Le,at[st+7])?(He=7+2*B(Le,165),He+=B(Le,145)):He=5+B(Le,159);else He=B(Le,at[st+4])?3+B(Le,at[st+5]):2;Ae=Ie[2]}else He=1,Ae=Ie[1];Ie=Se+yP[_e],0>(Le=h).b&&Z(Le);var st,at=Le.b,tt=(st=Le.Ca>>1)-(Le.I>>at)>>31;--Le.b,Le.Ca+=tt,Le.Ca|=1,Le.I-=(st+1&tt)<<at,Pe[Ie]=((He^tt)-tt)*ce[(0<_e)+0]}return 16}function Nt(h){var _=h.rb[h.sb-1];_.la=0,_.Na=0,i(h.zc,0,0,h.zc.length),h.ja=0}function tr(h,_){if(h==null)return 0;if(_==null)return mr(h,2,"NULL VP8Io parameter in VP8Decode().");if(!h.cb&&!Qr(h,_))return 0;if(e(h.cb),_.ac==null||_.ac(_)){_.ob&&(h.L=0);var U=Au[h.L];if(h.L==2?(h.yb=0,h.zb=0):(h.yb=_.v-U>>4,h.zb=_.j-U>>4,0>h.yb&&(h.yb=0),0>h.zb&&(h.zb=0)),h.Va=_.o+15+U>>4,h.Hb=_.va+15+U>>4,h.Hb>h.za&&(h.Hb=h.za),h.Va>h.Ub&&(h.Va=h.Ub),0<h.L){var ce=h.ed;for(U=0;4>U;++U){var _e;if(h.Qa.Cb){var Pe=h.Qa.Lb[U];h.Qa.Fb||(Pe+=ce.Tb)}else Pe=ce.Tb;for(_e=0;1>=_e;++_e){var Se=h.gd[U][_e],Ae=Pe;if(ce.Pc&&(Ae+=ce.vd[0],_e&&(Ae+=ce.od[0])),0<(Ae=0>Ae?0:63<Ae?63:Ae)){var Ie=Ae;0<ce.wb&&(Ie=4<ce.wb?Ie>>2:Ie>>1)>9-ce.wb&&(Ie=9-ce.wb),1>Ie&&(Ie=1),Se.dd=Ie,Se.tc=2*Ae+Ie,Se.ld=40<=Ae?2:15<=Ae?1:0}else Se.tc=0;Se.La=_e}}}U=0}else mr(h,6,"Frame setup failed"),U=h.a;if(U=U==0){if(U){h.$c=0,0<h.Aa||(h.Ic=LP);e:{U=h.Ic,ce=4*(Ie=h.za);var Le=32*Ie,He=Ie+1,st=0<h.L?Ie*(0<h.Aa?2:1):0,at=(h.Aa==2?2:1)*Ie;if((Se=ce+832+(_e=3*(16*U+Au[h.L])/2*Le)+(Pe=h.Fa!=null&&0<h.Fa.length?h.Kc.c*h.Kc.i:0))!=Se)U=0;else{if(Se>h.Vb){if(h.Vb=0,h.Ec=o(Se),h.Fc=0,h.Ec==null){U=mr(h,1,"no memory during frame initialization.");break e}h.Vb=Se}Se=h.Ec,Ae=h.Fc,h.Ac=Se,h.Bc=Ae,Ae+=ce,h.Gd=s(Le,Zt),h.Hd=0,h.rb=s(He+1,Bt),h.sb=1,h.wa=st?s(st,We):null,h.Y=0,h.D.Nb=0,h.D.wa=h.wa,h.D.Y=h.Y,0<h.Aa&&(h.D.Y+=Ie),e(!0),h.oc=Se,h.pc=Ae,Ae+=832,h.ya=s(at,Ht),h.aa=0,h.D.ya=h.ya,h.D.aa=h.aa,h.Aa==2&&(h.D.aa+=Ie),h.R=16*Ie,h.B=8*Ie,Ie=(Le=Au[h.L])*h.R,Le=Le/2*h.B,h.sa=Se,h.ta=Ae+Ie,h.qa=h.sa,h.ra=h.ta+16*U*h.R+Le,h.Ha=h.qa,h.Ia=h.ra+8*U*h.B+Le,h.$c=0,Ae+=_e,h.mb=Pe?Se:null,h.nb=Pe?Ae:null,e(Ae+Pe<=h.Fc+h.Vb),Nt(h),i(h.Ac,h.Bc,0,ce),U=1}}if(U){if(_.ka=0,_.y=h.sa,_.O=h.ta,_.f=h.qa,_.N=h.ra,_.ea=h.Ha,_.Vd=h.Ia,_.fa=h.R,_.Rc=h.B,_.F=null,_.J=0,!gu){for(U=-255;255>=U;++U)li[255+U]=0>U?-U:U;for(U=-1020;1020>=U;++U)Ns[1020+U]=-128>U?-128:127<U?127:U;for(U=-112;112>=U;++U)Qc[112+U]=-16>U?-16:15<U?15:U;for(U=-255;510>=U;++U)Zl[255+U]=0>U?0:255<U?255:U;gu=1}Jl=Kr,ks=jt,Yc=Et,Gi=cr,Co=Wr,Gn=St,Ql=ia,yu=Fo,Kc=sa,sl=il,al=oa,ma=As,ll=aa,Xl=rs,cl=Cs,fa=po,Jc=ai,Ao=zl,jo[0]=Ei,jo[1]=qn,jo[2]=$i,jo[3]=Do,jo[4]=Xo,jo[5]=wo,jo[6]=yi,jo[7]=xs,jo[8]=es,jo[9]=Zo,ya[0]=ei,ya[1]=Ln,ya[2]=en,ya[3]=wn,ya[4]=pn,ya[5]=So,ya[6]=co,Ls[0]=ho,Ls[1]=Mn,Ls[2]=ra,Ls[3]=uo,Ls[4]=an,Ls[5]=Mo,Ls[6]=el,U=1}else U=0}U&&(U=function(tt,It){for(tt.M=0;tt.M<tt.Va;++tt.M){var mt,Ge=tt.Jc[tt.M&tt.Xb],Je=tt.m,xt=tt;for(mt=0;mt<xt.za;++mt){var Lt=Je,$t=xt,ar=$t.Ac,Xt=$t.Bc+4*mt,$r=$t.zc,rr=$t.ya[$t.aa+mt];if($t.Qa.Bb?rr.$b=B(Lt,$t.Pa.jb[0])?2+B(Lt,$t.Pa.jb[2]):B(Lt,$t.Pa.jb[1]):rr.$b=0,$t.kc&&(rr.Ad=B(Lt,$t.Bd)),rr.Za=!B(Lt,145)+0,rr.Za){var mn=rr.Ob,vn=0;for($t=0;4>$t;++$t){var cn,rn=$r[0+$t];for(cn=0;4>cn;++cn){rn=vP[ar[Xt+cn]][rn];for(var Cn=gg[B(Lt,rn[0])];0<Cn;)Cn=gg[2*Cn+B(Lt,rn[Cn])];rn=-Cn,ar[Xt+cn]=rn}n(mn,vn,ar,Xt,4),vn+=4,$r[0+$t]=rn}}else rn=B(Lt,156)?B(Lt,128)?1:3:B(Lt,163)?2:0,rr.Ob[0]=rn,i(ar,Xt,rn,4),i($r,0,rn,4);rr.Dd=B(Lt,142)?B(Lt,114)?B(Lt,183)?1:3:2:0}if(xt.m.Ka)return mr(tt,7,"Premature end-of-partition0 encountered.");for(;tt.ja<tt.za;++tt.ja){if(xt=Ge,Lt=(Je=tt).rb[Je.sb-1],ar=Je.rb[Je.sb+Je.ja],mt=Je.ya[Je.aa+Je.ja],Xt=Je.kc?mt.Ad:0)Lt.la=ar.la=0,mt.Za||(Lt.Na=ar.Na=0),mt.Hc=0,mt.Gc=0,mt.ia=0;else{var Sn,Ur;if(Lt=ar,ar=xt,Xt=Je.Pa.Xc,$r=Je.ya[Je.aa+Je.ja],rr=Je.pb[$r.$b],$t=$r.ad,mn=0,vn=Je.rb[Je.sb-1],rn=cn=0,i($t,mn,0,384),$r.Za)var ti=0,Zi=Xt[3];else{Cn=o(16);var ri=Lt.Na+vn.Na;if(ri=Xc(ar,Xt[1],ri,rr.Eb,0,Cn,0),Lt.Na=vn.Na=(0<ri)+0,1<ri)Jl(Cn,0,$t,mn);else{var eo=Cn[0]+3>>3;for(Cn=0;256>Cn;Cn+=16)$t[mn+Cn]=eo}ti=1,Zi=Xt[0]}var bn=15&Lt.la,fo=15&vn.la;for(Cn=0;4>Cn;++Cn){var yo=1&fo;for(eo=Ur=0;4>eo;++eo)bn=bn>>1|(yo=(ri=Xc(ar,Zi,ri=yo+(1&bn),rr.Sc,ti,$t,mn))>ti)<<7,Ur=Ur<<2|(3<ri?3:1<ri?2:$t[mn+0]!=0),mn+=16;bn>>=4,fo=fo>>1|yo<<7,cn=(cn<<8|Ur)>>>0}for(Zi=bn,ti=fo>>4,Sn=0;4>Sn;Sn+=2){for(Ur=0,bn=Lt.la>>4+Sn,fo=vn.la>>4+Sn,Cn=0;2>Cn;++Cn){for(yo=1&fo,eo=0;2>eo;++eo)ri=yo+(1&bn),bn=bn>>1|(yo=0<(ri=Xc(ar,Xt[2],ri,rr.Qc,0,$t,mn)))<<3,Ur=Ur<<2|(3<ri?3:1<ri?2:$t[mn+0]!=0),mn+=16;bn>>=2,fo=fo>>1|yo<<5}rn|=Ur<<4*Sn,Zi|=bn<<4<<Sn,ti|=(240&fo)<<Sn}Lt.la=Zi,vn.la=ti,$r.Hc=cn,$r.Gc=rn,$r.ia=43690&rn?0:rr.ia,Xt=!(cn|rn)}if(0<Je.L&&(Je.wa[Je.Y+Je.ja]=Je.gd[mt.$b][mt.Za],Je.wa[Je.Y+Je.ja].La|=!Xt),xt.Ka)return mr(tt,7,"Premature end-of-file encountered.")}if(Nt(tt),Je=It,xt=1,mt=(Ge=tt).D,Lt=0<Ge.L&&Ge.M>=Ge.zb&&Ge.M<=Ge.Va,Ge.Aa==0)e:{if(mt.M=Ge.M,mt.uc=Lt,is(Ge,mt),xt=1,mt=(Ur=Ge.D).Nb,Lt=(rn=Au[Ge.L])*Ge.R,ar=rn/2*Ge.B,Cn=16*mt*Ge.R,eo=8*mt*Ge.B,Xt=Ge.sa,$r=Ge.ta-Lt+Cn,rr=Ge.qa,$t=Ge.ra-ar+eo,mn=Ge.Ha,vn=Ge.Ia-ar+eo,fo=(bn=Ur.M)==0,cn=bn>=Ge.Va-1,Ge.Aa==2&&is(Ge,Ur),Ur.uc)for(yo=(ri=Ge).D.M,e(ri.D.uc),Ur=ri.yb;Ur<ri.Hb;++Ur){ti=Ur,Zi=yo;var hi=(_i=(zn=ri).D).Nb;Sn=zn.R;var _i=_i.wa[_i.Y+ti],Wi=zn.sa,To=zn.ta+16*hi*Sn+16*ti,ss=_i.dd,pi=_i.tc;if(pi!=0)if(e(3<=pi),zn.L==1)0<ti&&fa(Wi,To,Sn,pi+4),_i.La&&Ao(Wi,To,Sn,pi),0<Zi&&cl(Wi,To,Sn,pi+4),_i.La&&Jc(Wi,To,Sn,pi);else{var Rs=zn.B,dl=zn.qa,ec=zn.ra+8*hi*Rs+8*ti,va=zn.Ha,zn=zn.Ia+8*hi*Rs+8*ti;hi=_i.ld,0<ti&&(yu(Wi,To,Sn,pi+4,ss,hi),sl(dl,ec,va,zn,Rs,pi+4,ss,hi)),_i.La&&(ma(Wi,To,Sn,pi,ss,hi),Xl(dl,ec,va,zn,Rs,pi,ss,hi)),0<Zi&&(Ql(Wi,To,Sn,pi+4,ss,hi),Kc(dl,ec,va,zn,Rs,pi+4,ss,hi)),_i.La&&(al(Wi,To,Sn,pi,ss,hi),ll(dl,ec,va,zn,Rs,pi,ss,hi))}}if(Ge.ia&&alert("todo:DitherRow"),Je.put!=null){if(Ur=16*bn,bn=16*(bn+1),fo?(Je.y=Ge.sa,Je.O=Ge.ta+Cn,Je.f=Ge.qa,Je.N=Ge.ra+eo,Je.ea=Ge.Ha,Je.W=Ge.Ia+eo):(Ur-=rn,Je.y=Xt,Je.O=$r,Je.f=rr,Je.N=$t,Je.ea=mn,Je.W=vn),cn||(bn-=rn),bn>Je.o&&(bn=Je.o),Je.F=null,Je.J=null,Ge.Fa!=null&&0<Ge.Fa.length&&Ur<bn&&(Je.J=ua(Ge,Je,Ur,bn-Ur),Je.F=Ge.mb,Je.F==null&&Je.F.length==0)){xt=mr(Ge,3,"Could not decode alpha data.");break e}Ur<Je.j&&(rn=Je.j-Ur,Ur=Je.j,e(!(1&rn)),Je.O+=Ge.R*rn,Je.N+=Ge.B*(rn>>1),Je.W+=Ge.B*(rn>>1),Je.F!=null&&(Je.J+=Je.width*rn)),Ur<bn&&(Je.O+=Je.v,Je.N+=Je.v>>1,Je.W+=Je.v>>1,Je.F!=null&&(Je.J+=Je.v),Je.ka=Ur-Je.j,Je.U=Je.va-Je.v,Je.T=bn-Ur,xt=Je.put(Je))}mt+1!=Ge.Ic||cn||(n(Ge.sa,Ge.ta-Lt,Xt,$r+16*Ge.R,Lt),n(Ge.qa,Ge.ra-ar,rr,$t+8*Ge.B,ar),n(Ge.Ha,Ge.Ia-ar,mn,vn+8*Ge.B,ar))}if(!xt)return mr(tt,6,"Output aborted.")}return 1}(h,_)),_.bc!=null&&_.bc(_),U&=1}return U?(h.cb=0,U):0}function ur(h,_,U,ce,_e){_e=h[_+U+32*ce]+(_e>>3),h[_+U+32*ce]=-256&_e?0>_e?0:255:_e}function Ar(h,_,U,ce,_e,Pe){ur(h,_,0,U,ce+_e),ur(h,_,1,U,ce+Pe),ur(h,_,2,U,ce-Pe),ur(h,_,3,U,ce-_e)}function Rt(h){return(20091*h>>16)+h}function vt(h,_,U,ce){var _e,Pe=0,Se=o(16);for(_e=0;4>_e;++_e){var Ae=h[_+0]+h[_+8],Ie=h[_+0]-h[_+8],Le=(35468*h[_+4]>>16)-Rt(h[_+12]),He=Rt(h[_+4])+(35468*h[_+12]>>16);Se[Pe+0]=Ae+He,Se[Pe+1]=Ie+Le,Se[Pe+2]=Ie-Le,Se[Pe+3]=Ae-He,Pe+=4,_++}for(_e=Pe=0;4>_e;++_e)Ae=(h=Se[Pe+0]+4)+Se[Pe+8],Ie=h-Se[Pe+8],Le=(35468*Se[Pe+4]>>16)-Rt(Se[Pe+12]),ur(U,ce,0,0,Ae+(He=Rt(Se[Pe+4])+(35468*Se[Pe+12]>>16))),ur(U,ce,1,0,Ie+Le),ur(U,ce,2,0,Ie-Le),ur(U,ce,3,0,Ae-He),Pe++,ce+=32}function St(h,_,U,ce){var _e=h[_+0]+4,Pe=35468*h[_+4]>>16,Se=Rt(h[_+4]),Ae=35468*h[_+1]>>16;Ar(U,ce,0,_e+Se,h=Rt(h[_+1]),Ae),Ar(U,ce,1,_e+Pe,h,Ae),Ar(U,ce,2,_e-Pe,h,Ae),Ar(U,ce,3,_e-Se,h,Ae)}function jt(h,_,U,ce,_e){vt(h,_,U,ce),_e&&vt(h,_+16,U,ce+4)}function Et(h,_,U,ce){ks(h,_+0,U,ce,1),ks(h,_+32,U,ce+128,1)}function cr(h,_,U,ce){var _e;for(h=h[_+0]+4,_e=0;4>_e;++_e)for(_=0;4>_;++_)ur(U,ce,_,_e,h)}function Wr(h,_,U,ce){h[_+0]&&Gi(h,_+0,U,ce),h[_+16]&&Gi(h,_+16,U,ce+4),h[_+32]&&Gi(h,_+32,U,ce+128),h[_+48]&&Gi(h,_+48,U,ce+128+4)}function Kr(h,_,U,ce){var _e,Pe=o(16);for(_e=0;4>_e;++_e){var Se=h[_+0+_e]+h[_+12+_e],Ae=h[_+4+_e]+h[_+8+_e],Ie=h[_+4+_e]-h[_+8+_e],Le=h[_+0+_e]-h[_+12+_e];Pe[0+_e]=Se+Ae,Pe[8+_e]=Se-Ae,Pe[4+_e]=Le+Ie,Pe[12+_e]=Le-Ie}for(_e=0;4>_e;++_e)Se=(h=Pe[0+4*_e]+3)+Pe[3+4*_e],Ae=Pe[1+4*_e]+Pe[2+4*_e],Ie=Pe[1+4*_e]-Pe[2+4*_e],Le=h-Pe[3+4*_e],U[ce+0]=Se+Ae>>3,U[ce+16]=Le+Ie>>3,U[ce+32]=Se-Ae>>3,U[ce+48]=Le-Ie>>3,ce+=64}function Zr(h,_,U){var ce,_e=_-32,Pe=mo,Se=255-h[_e-1];for(ce=0;ce<U;++ce){var Ae,Ie=Pe,Le=Se+h[_-1];for(Ae=0;Ae<U;++Ae)h[_+Ae]=Ie[Le+h[_e+Ae]];_+=32}}function qn(h,_){Zr(h,_,4)}function Mn(h,_){Zr(h,_,8)}function Ln(h,_){Zr(h,_,16)}function en(h,_){var U;for(U=0;16>U;++U)n(h,_+32*U,h,_-32,16)}function wn(h,_){var U;for(U=16;0<U;--U)i(h,_,h[_-1],16),_+=32}function nr(h,_,U){var ce;for(ce=0;16>ce;++ce)i(_,U+32*ce,h,16)}function ei(h,_){var U,ce=16;for(U=0;16>U;++U)ce+=h[_-1+32*U]+h[_+U-32];nr(ce>>5,h,_)}function pn(h,_){var U,ce=8;for(U=0;16>U;++U)ce+=h[_-1+32*U];nr(ce>>4,h,_)}function So(h,_){var U,ce=8;for(U=0;16>U;++U)ce+=h[_+U-32];nr(ce>>4,h,_)}function co(h,_){nr(128,h,_)}function Sr(h,_,U){return h+2*_+U+2>>2}function $i(h,_){var U,ce=_-32;for(ce=new Uint8Array([Sr(h[ce-1],h[ce+0],h[ce+1]),Sr(h[ce+0],h[ce+1],h[ce+2]),Sr(h[ce+1],h[ce+2],h[ce+3]),Sr(h[ce+2],h[ce+3],h[ce+4])]),U=0;4>U;++U)n(h,_+32*U,ce,0,ce.length)}function Do(h,_){var U=h[_-1],ce=h[_-1+32],_e=h[_-1+64],Pe=h[_-1+96];M(h,_+0,16843009*Sr(h[_-1-32],U,ce)),M(h,_+32,16843009*Sr(U,ce,_e)),M(h,_+64,16843009*Sr(ce,_e,Pe)),M(h,_+96,16843009*Sr(_e,Pe,Pe))}function Ei(h,_){var U,ce=4;for(U=0;4>U;++U)ce+=h[_+U-32]+h[_-1+32*U];for(ce>>=3,U=0;4>U;++U)i(h,_+32*U,ce,4)}function Xo(h,_){var U=h[_-1+0],ce=h[_-1+32],_e=h[_-1+64],Pe=h[_-1-32],Se=h[_+0-32],Ae=h[_+1-32],Ie=h[_+2-32],Le=h[_+3-32];h[_+0+96]=Sr(ce,_e,h[_-1+96]),h[_+1+96]=h[_+0+64]=Sr(U,ce,_e),h[_+2+96]=h[_+1+64]=h[_+0+32]=Sr(Pe,U,ce),h[_+3+96]=h[_+2+64]=h[_+1+32]=h[_+0+0]=Sr(Se,Pe,U),h[_+3+64]=h[_+2+32]=h[_+1+0]=Sr(Ae,Se,Pe),h[_+3+32]=h[_+2+0]=Sr(Ie,Ae,Se),h[_+3+0]=Sr(Le,Ie,Ae)}function yi(h,_){var U=h[_+1-32],ce=h[_+2-32],_e=h[_+3-32],Pe=h[_+4-32],Se=h[_+5-32],Ae=h[_+6-32],Ie=h[_+7-32];h[_+0+0]=Sr(h[_+0-32],U,ce),h[_+1+0]=h[_+0+32]=Sr(U,ce,_e),h[_+2+0]=h[_+1+32]=h[_+0+64]=Sr(ce,_e,Pe),h[_+3+0]=h[_+2+32]=h[_+1+64]=h[_+0+96]=Sr(_e,Pe,Se),h[_+3+32]=h[_+2+64]=h[_+1+96]=Sr(Pe,Se,Ae),h[_+3+64]=h[_+2+96]=Sr(Se,Ae,Ie),h[_+3+96]=Sr(Ae,Ie,Ie)}function wo(h,_){var U=h[_-1+0],ce=h[_-1+32],_e=h[_-1+64],Pe=h[_-1-32],Se=h[_+0-32],Ae=h[_+1-32],Ie=h[_+2-32],Le=h[_+3-32];h[_+0+0]=h[_+1+64]=Pe+Se+1>>1,h[_+1+0]=h[_+2+64]=Se+Ae+1>>1,h[_+2+0]=h[_+3+64]=Ae+Ie+1>>1,h[_+3+0]=Ie+Le+1>>1,h[_+0+96]=Sr(_e,ce,U),h[_+0+64]=Sr(ce,U,Pe),h[_+0+32]=h[_+1+96]=Sr(U,Pe,Se),h[_+1+32]=h[_+2+96]=Sr(Pe,Se,Ae),h[_+2+32]=h[_+3+96]=Sr(Se,Ae,Ie),h[_+3+32]=Sr(Ae,Ie,Le)}function xs(h,_){var U=h[_+0-32],ce=h[_+1-32],_e=h[_+2-32],Pe=h[_+3-32],Se=h[_+4-32],Ae=h[_+5-32],Ie=h[_+6-32],Le=h[_+7-32];h[_+0+0]=U+ce+1>>1,h[_+1+0]=h[_+0+64]=ce+_e+1>>1,h[_+2+0]=h[_+1+64]=_e+Pe+1>>1,h[_+3+0]=h[_+2+64]=Pe+Se+1>>1,h[_+0+32]=Sr(U,ce,_e),h[_+1+32]=h[_+0+96]=Sr(ce,_e,Pe),h[_+2+32]=h[_+1+96]=Sr(_e,Pe,Se),h[_+3+32]=h[_+2+96]=Sr(Pe,Se,Ae),h[_+3+64]=Sr(Se,Ae,Ie),h[_+3+96]=Sr(Ae,Ie,Le)}function Zo(h,_){var U=h[_-1+0],ce=h[_-1+32],_e=h[_-1+64],Pe=h[_-1+96];h[_+0+0]=U+ce+1>>1,h[_+2+0]=h[_+0+32]=ce+_e+1>>1,h[_+2+32]=h[_+0+64]=_e+Pe+1>>1,h[_+1+0]=Sr(U,ce,_e),h[_+3+0]=h[_+1+32]=Sr(ce,_e,Pe),h[_+3+32]=h[_+1+64]=Sr(_e,Pe,Pe),h[_+3+64]=h[_+2+64]=h[_+0+96]=h[_+1+96]=h[_+2+96]=h[_+3+96]=Pe}function es(h,_){var U=h[_-1+0],ce=h[_-1+32],_e=h[_-1+64],Pe=h[_-1+96],Se=h[_-1-32],Ae=h[_+0-32],Ie=h[_+1-32],Le=h[_+2-32];h[_+0+0]=h[_+2+32]=U+Se+1>>1,h[_+0+32]=h[_+2+64]=ce+U+1>>1,h[_+0+64]=h[_+2+96]=_e+ce+1>>1,h[_+0+96]=Pe+_e+1>>1,h[_+3+0]=Sr(Ae,Ie,Le),h[_+2+0]=Sr(Se,Ae,Ie),h[_+1+0]=h[_+3+32]=Sr(U,Se,Ae),h[_+1+32]=h[_+3+64]=Sr(ce,U,Se),h[_+1+64]=h[_+3+96]=Sr(_e,ce,U),h[_+1+96]=Sr(Pe,_e,ce)}function ra(h,_){var U;for(U=0;8>U;++U)n(h,_+32*U,h,_-32,8)}function uo(h,_){var U;for(U=0;8>U;++U)i(h,_,h[_-1],8),_+=32}function Ui(h,_,U){var ce;for(ce=0;8>ce;++ce)i(_,U+32*ce,h,8)}function ho(h,_){var U,ce=8;for(U=0;8>U;++U)ce+=h[_+U-32]+h[_-1+32*U];Ui(ce>>4,h,_)}function Mo(h,_){var U,ce=4;for(U=0;8>U;++U)ce+=h[_+U-32];Ui(ce>>3,h,_)}function an(h,_){var U,ce=4;for(U=0;8>U;++U)ce+=h[_-1+32*U];Ui(ce>>3,h,_)}function el(h,_){Ui(128,h,_)}function na(h,_,U){var ce=h[_-U],_e=h[_+0],Pe=3*(_e-ce)+Np[1020+h[_-2*U]-h[_+U]],Se=vu[112+(Pe+4>>3)];h[_-U]=mo[255+ce+vu[112+(Pe+3>>3)]],h[_+0]=mo[255+_e-Se]}function tl(h,_,U,ce){var _e=h[_+0],Pe=h[_+U];return Eo[255+h[_-2*U]-h[_-U]]>ce||Eo[255+Pe-_e]>ce}function rl(h,_,U,ce){return 4*Eo[255+h[_-U]-h[_+0]]+Eo[255+h[_-2*U]-h[_+U]]<=ce}function nl(h,_,U,ce,_e){var Pe=h[_-3*U],Se=h[_-2*U],Ae=h[_-U],Ie=h[_+0],Le=h[_+U],He=h[_+2*U],st=h[_+3*U];return 4*Eo[255+Ae-Ie]+Eo[255+Se-Le]>ce?0:Eo[255+h[_-4*U]-Pe]<=_e&&Eo[255+Pe-Se]<=_e&&Eo[255+Se-Ae]<=_e&&Eo[255+st-He]<=_e&&Eo[255+He-Le]<=_e&&Eo[255+Le-Ie]<=_e}function Cs(h,_,U,ce){var _e=2*ce+1;for(ce=0;16>ce;++ce)rl(h,_+ce,U,_e)&&na(h,_+ce,U)}function po(h,_,U,ce){var _e=2*ce+1;for(ce=0;16>ce;++ce)rl(h,_+ce*U,1,_e)&&na(h,_+ce*U,1)}function ai(h,_,U,ce){var _e;for(_e=3;0<_e;--_e)Cs(h,_+=4*U,U,ce)}function zl(h,_,U,ce){var _e;for(_e=3;0<_e;--_e)po(h,_+=4,U,ce)}function ts(h,_,U,ce,_e,Pe,Se,Ae){for(Pe=2*Pe+1;0<_e--;){if(nl(h,_,U,Pe,Se))if(tl(h,_,U,Ae))na(h,_,U);else{var Ie=h,Le=_,He=U,st=Ie[Le-2*He],at=Ie[Le-He],tt=Ie[Le+0],It=Ie[Le+He],mt=Ie[Le+2*He],Ge=27*(xt=Np[1020+3*(tt-at)+Np[1020+st-It]])+63>>7,Je=18*xt+63>>7,xt=9*xt+63>>7;Ie[Le-3*He]=mo[255+Ie[Le-3*He]+xt],Ie[Le-2*He]=mo[255+st+Je],Ie[Le-He]=mo[255+at+Ge],Ie[Le+0]=mo[255+tt-Ge],Ie[Le+He]=mo[255+It-Je],Ie[Le+2*He]=mo[255+mt-xt]}_+=ce}}function gi(h,_,U,ce,_e,Pe,Se,Ae){for(Pe=2*Pe+1;0<_e--;){if(nl(h,_,U,Pe,Se))if(tl(h,_,U,Ae))na(h,_,U);else{var Ie=h,Le=_,He=U,st=Ie[Le-He],at=Ie[Le+0],tt=Ie[Le+He],It=vu[112+((mt=3*(at-st))+4>>3)],mt=vu[112+(mt+3>>3)],Ge=It+1>>1;Ie[Le-2*He]=mo[255+Ie[Le-2*He]+Ge],Ie[Le-He]=mo[255+st+mt],Ie[Le+0]=mo[255+at-It],Ie[Le+He]=mo[255+tt-Ge]}_+=ce}}function ia(h,_,U,ce,_e,Pe){ts(h,_,U,1,16,ce,_e,Pe)}function Fo(h,_,U,ce,_e,Pe){ts(h,_,1,U,16,ce,_e,Pe)}function oa(h,_,U,ce,_e,Pe){var Se;for(Se=3;0<Se;--Se)gi(h,_+=4*U,U,1,16,ce,_e,Pe)}function As(h,_,U,ce,_e,Pe){var Se;for(Se=3;0<Se;--Se)gi(h,_+=4,1,U,16,ce,_e,Pe)}function sa(h,_,U,ce,_e,Pe,Se,Ae){ts(h,_,_e,1,8,Pe,Se,Ae),ts(U,ce,_e,1,8,Pe,Se,Ae)}function il(h,_,U,ce,_e,Pe,Se,Ae){ts(h,_,1,_e,8,Pe,Se,Ae),ts(U,ce,1,_e,8,Pe,Se,Ae)}function aa(h,_,U,ce,_e,Pe,Se,Ae){gi(h,_+4*_e,_e,1,8,Pe,Se,Ae),gi(U,ce+4*_e,_e,1,8,Pe,Se,Ae)}function rs(h,_,U,ce,_e,Pe,Se,Ae){gi(h,_+4,1,_e,8,Pe,Se,Ae),gi(U,ce+4,1,_e,8,Pe,Se,Ae)}function $s(){this.ba=new Re,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new ot,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function la(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Es(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function ca(){this.ua=0,this.Wa=new ee,this.vb=new ee,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new z,this.yc=new S}function Ul(){this.xb=this.a=0,this.l=new xr,this.ca=new Re,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new F,this.Pb=0,this.wd=new F,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new ca,this.ab=0,this.gc=s(4,Es),this.Oc=0}function Oo(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new xr,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ns(h,_,U,ce,_e,Pe,Se){for(h=h==null?0:h[_+0],_=0;_<Se;++_)_e[Pe+_]=h+U[ce+_]&255,h=_e[Pe+_]}function da(h,_,U,ce,_e,Pe,Se){var Ae;if(h==null)ns(null,null,U,ce,_e,Pe,Se);else for(Ae=0;Ae<Se;++Ae)_e[Pe+Ae]=h[_+Ae]+U[ce+Ae]&255}function Ii(h,_,U,ce,_e,Pe,Se){if(h==null)ns(null,null,U,ce,_e,Pe,Se);else{var Ae,Ie=h[_+0],Le=Ie,He=Ie;for(Ae=0;Ae<Se;++Ae)Le=He+(Ie=h[_+Ae])-Le,He=U[ce+Ae]+(-256&Le?0>Le?0:255:Le)&255,Le=Ie,_e[Pe+Ae]=He}}function ua(h,_,U,ce){var _e=_.width,Pe=_.o;if(e(h!=null&&_!=null),0>U||0>=ce||U+ce>Pe)return null;if(!h.Cc){if(h.ga==null){var Se;if(h.ga=new Oo,(Se=h.ga==null)||(Se=_.width*_.o,e(h.Gb.length==0),h.Gb=o(Se),h.Uc=0,h.Gb==null?Se=0:(h.mb=h.Gb,h.nb=h.Uc,h.rc=null,Se=1),Se=!Se),!Se){Se=h.ga;var Ae=h.Fa,Ie=h.P,Le=h.qc,He=h.mb,st=h.nb,at=Ie+1,tt=Le-1,It=Se.l;if(e(Ae!=null&&He!=null&&_!=null),ga[0]=null,ga[1]=ns,ga[2]=da,ga[3]=Ii,Se.ca=He,Se.tb=st,Se.c=_.width,Se.i=_.height,e(0<Se.c&&0<Se.i),1>=Le)_=0;else if(Se.$a=Ae[Ie+0]>>0&3,Se.Z=Ae[Ie+0]>>2&3,Se.Lc=Ae[Ie+0]>>4&3,Ie=Ae[Ie+0]>>6&3,0>Se.$a||1<Se.$a||4<=Se.Z||1<Se.Lc||Ie)_=0;else if(It.put=Qt,It.ac=Mt,It.bc=lr,It.ma=Se,It.width=_.width,It.height=_.height,It.Da=_.Da,It.v=_.v,It.va=_.va,It.j=_.j,It.o=_.o,Se.$a)e:{e(Se.$a==1),_=hr();t:for(;;){if(_==null){_=0;break e}if(e(Se!=null),Se.mc=_,_.c=Se.c,_.i=Se.i,_.l=Se.l,_.l.ma=Se,_.l.width=Se.c,_.l.height=Se.i,_.a=0,ne(_.m,Ae,at,tt),!Pr(Se.c,Se.i,1,_,null)||(_.ab==1&&_.gc[0].hc==3&&gr(_.s)?(Se.ic=1,Ae=_.c*_.i,_.Ta=null,_.Ua=0,_.V=o(Ae),_.Ba=0,_.V==null?(_.a=1,_=0):_=1):(Se.ic=0,_=Jr(_,Se.c)),!_))break t;_=1;break e}Se.mc=null,_=0}else _=tt>=Se.c*Se.i;Se=!_}if(Se)return null;h.ga.Lc!=1?h.Ga=0:ce=Pe-U}e(h.ga!=null),e(U+ce<=Pe);e:{if(_=(Ae=h.ga).c,Pe=Ae.l.o,Ae.$a==0){if(at=h.rc,tt=h.Vc,It=h.Fa,Ie=h.P+1+U*_,Le=h.mb,He=h.nb+U*_,e(Ie<=h.P+h.qc),Ae.Z!=0)for(e(ga[Ae.Z]!=null),Se=0;Se<ce;++Se)ga[Ae.Z](at,tt,It,Ie,Le,He,_),at=Le,tt=He,He+=_,Ie+=_;else for(Se=0;Se<ce;++Se)n(Le,He,It,Ie,_),at=Le,tt=He,He+=_,Ie+=_;h.rc=at,h.Vc=tt}else{if(e(Ae.mc!=null),_=U+ce,e((Se=Ae.mc)!=null),e(_<=Se.i),Se.C>=_)_=1;else if(Ae.ic||Ze(),Ae.ic){Ae=Se.V,at=Se.Ba,tt=Se.c;var mt=Se.i,Ge=(It=1,Ie=Se.$/tt,Le=Se.$%tt,He=Se.m,st=Se.s,Se.$),Je=tt*mt,xt=tt*_,Lt=st.wc,$t=Ge<xt?pt(st,Le,Ie):null;e(Ge<=Je),e(_<=mt),e(gr(st));t:for(;;){for(;!He.h&&Ge<xt;){if(Le&Lt||($t=pt(st,Le,Ie)),e($t!=null),V(He),256>(mt=Kt($t.G[0],$t.H[0],He)))Ae[at+Ge]=mt,++Ge,++Le>=tt&&(Le=0,++Ie<=_&&!(Ie%16)&&ft(Se,Ie));else{if(!(280>mt)){It=0;break t}mt=yr(mt-256,He);var ar,Xt=Kt($t.G[4],$t.H[4],He);if(V(He),!(Ge>=(Xt=Cr(tt,Xt=yr(Xt,He)))&&Je-Ge>=mt)){It=0;break t}for(ar=0;ar<mt;++ar)Ae[at+Ge+ar]=Ae[at+Ge+ar-Xt];for(Ge+=mt,Le+=mt;Le>=tt;)Le-=tt,++Ie<=_&&!(Ie%16)&&ft(Se,Ie);Ge<xt&&Le&Lt&&($t=pt(st,Le,Ie))}e(He.h==N(He))}ft(Se,Ie>_?_:Ie);break t}!It||He.h&&Ge<Je?(It=0,Se.a=He.h?5:3):Se.$=Ge,_=It}else _=At(Se,Se.V,Se.Ba,Se.c,Se.i,_,Tr);if(!_){ce=0;break e}}U+ce>=Pe&&(h.Cc=1),ce=1}if(!ce)return null;if(h.Cc&&((ce=h.ga)!=null&&(ce.mc=null),h.ga=null,0<h.Ga))return alert("todo:WebPDequantizeLevels"),null}return h.nb+U*_e}function R(h,_,U,ce,_e,Pe){for(;0<_e--;){var Se,Ae=h,Ie=_+(U?1:0),Le=h,He=_+(U?0:3);for(Se=0;Se<ce;++Se){var st=Le[He+4*Se];st!=255&&(st*=32897,Ae[Ie+4*Se+0]=Ae[Ie+4*Se+0]*st>>23,Ae[Ie+4*Se+1]=Ae[Ie+4*Se+1]*st>>23,Ae[Ie+4*Se+2]=Ae[Ie+4*Se+2]*st>>23)}_+=Pe}}function be(h,_,U,ce,_e){for(;0<ce--;){var Pe;for(Pe=0;Pe<U;++Pe){var Se=h[_+2*Pe+0],Ae=15&(Le=h[_+2*Pe+1]),Ie=4369*Ae,Le=(240&Le|Le>>4)*Ie>>16;h[_+2*Pe+0]=(240&Se|Se>>4)*Ie>>16&240|(15&Se|Se<<4)*Ie>>16>>4&15,h[_+2*Pe+1]=240&Le|Ae}_+=_e}}function De(h,_,U,ce,_e,Pe,Se,Ae){var Ie,Le,He=255;for(Le=0;Le<_e;++Le){for(Ie=0;Ie<ce;++Ie){var st=h[_+Ie];Pe[Se+4*Ie]=st,He&=st}_+=U,Se+=Ae}return He!=255}function qe(h,_,U,ce,_e){var Pe;for(Pe=0;Pe<_e;++Pe)U[ce+Pe]=h[_+Pe]>>8}function Ze(){$o=R,In=be,Tn=De,Wn=qe}function yt(h,_,U){P[h]=function(ce,_e,Pe,Se,Ae,Ie,Le,He,st,at,tt,It,mt,Ge,Je,xt,Lt){var $t,ar=Lt-1>>1,Xt=Ae[Ie+0]|Le[He+0]<<16,$r=st[at+0]|tt[It+0]<<16;e(ce!=null);var rr=3*Xt+$r+131074>>2;for(_(ce[_e+0],255&rr,rr>>16,mt,Ge),Pe!=null&&(rr=3*$r+Xt+131074>>2,_(Pe[Se+0],255&rr,rr>>16,Je,xt)),$t=1;$t<=ar;++$t){var mn=Ae[Ie+$t]|Le[He+$t]<<16,vn=st[at+$t]|tt[It+$t]<<16,cn=Xt+mn+$r+vn+524296,rn=cn+2*(mn+$r)>>3;rr=rn+Xt>>1,Xt=(cn=cn+2*(Xt+vn)>>3)+mn>>1,_(ce[_e+2*$t-1],255&rr,rr>>16,mt,Ge+(2*$t-1)*U),_(ce[_e+2*$t-0],255&Xt,Xt>>16,mt,Ge+(2*$t-0)*U),Pe!=null&&(rr=cn+$r>>1,Xt=rn+vn>>1,_(Pe[Se+2*$t-1],255&rr,rr>>16,Je,xt+(2*$t-1)*U),_(Pe[Se+2*$t+0],255&Xt,Xt>>16,Je,xt+(2*$t+0)*U)),Xt=mn,$r=vn}1&Lt||(rr=3*Xt+$r+131074>>2,_(ce[_e+Lt-1],255&rr,rr>>16,mt,Ge+(Lt-1)*U),Pe!=null&&(rr=3*$r+Xt+131074>>2,_(Pe[Se+Lt-1],255&rr,rr>>16,Je,xt+(Lt-1)*U)))}}function Dt(){Io[bu]=SP,Io[_u]=bg,Io[mg]=wP,Io[Pu]=_g,Io[Su]=Pg,Io[Lp]=Sg,Io[fg]=xP,Io[Rp]=bg,Io[Dp]=_g,Io[wu]=Pg,Io[Mp]=Sg}function er(h){return h&-16384?0>h?0:255:h>>CP}function m(h,_){return er((19077*h>>8)+(26149*_>>8)-14234)}function te(h,_,U){return er((19077*h>>8)-(6419*_>>8)-(13320*U>>8)+8708)}function ue(h,_){return er((19077*h>>8)+(33050*_>>8)-17685)}function Ce(h,_,U,ce,_e){ce[_e+0]=m(h,U),ce[_e+1]=te(h,_,U),ce[_e+2]=ue(h,_)}function Qe(h,_,U,ce,_e){ce[_e+0]=ue(h,_),ce[_e+1]=te(h,_,U),ce[_e+2]=m(h,U)}function ct(h,_,U,ce,_e){var Pe=te(h,_,U);_=Pe<<3&224|ue(h,_)>>3,ce[_e+0]=248&m(h,U)|Pe>>5,ce[_e+1]=_}function Ot(h,_,U,ce,_e){var Pe=240&ue(h,_)|15;ce[_e+0]=240&m(h,U)|te(h,_,U)>>4,ce[_e+1]=Pe}function Fr(h,_,U,ce,_e){ce[_e+0]=255,Ce(h,_,U,ce,_e+1)}function tn(h,_,U,ce,_e){Qe(h,_,U,ce,_e),ce[_e+3]=255}function Or(h,_,U,ce,_e){Ce(h,_,U,ce,_e),ce[_e+3]=255}function fn(h,_){return 0>h?0:h>_?_:h}function xn(h,_,U){P[h]=function(ce,_e,Pe,Se,Ae,Ie,Le,He,st){for(var at=He+(-2&st)*U;He!=at;)_(ce[_e+0],Pe[Se+0],Ae[Ie+0],Le,He),_(ce[_e+1],Pe[Se+0],Ae[Ie+0],Le,He+U),_e+=2,++Se,++Ie,He+=2*U;1&st&&_(ce[_e+0],Pe[Se+0],Ae[Ie+0],Le,He)}}function Bo(h,_,U){return U==0?h==0?_==0?6:5:_==0?4:0:U}function vi(h,_,U,ce,_e){switch(h>>>30){case 3:ks(_,U,ce,_e,0);break;case 2:Gn(_,U,ce,_e);break;case 1:Gi(_,U,ce,_e)}}function is(h,_){var U,ce,_e=_.M,Pe=_.Nb,Se=h.oc,Ae=h.pc+40,Ie=h.oc,Le=h.pc+584,He=h.oc,st=h.pc+600;for(U=0;16>U;++U)Se[Ae+32*U-1]=129;for(U=0;8>U;++U)Ie[Le+32*U-1]=129,He[st+32*U-1]=129;for(0<_e?Se[Ae-1-32]=Ie[Le-1-32]=He[st-1-32]=129:(i(Se,Ae-32-1,127,21),i(Ie,Le-32-1,127,9),i(He,st-32-1,127,9)),ce=0;ce<h.za;++ce){var at=_.ya[_.aa+ce];if(0<ce){for(U=-1;16>U;++U)n(Se,Ae+32*U-4,Se,Ae+32*U+12,4);for(U=-1;8>U;++U)n(Ie,Le+32*U-4,Ie,Le+32*U+4,4),n(He,st+32*U-4,He,st+32*U+4,4)}var tt=h.Gd,It=h.Hd+ce,mt=at.ad,Ge=at.Hc;if(0<_e&&(n(Se,Ae-32,tt[It].y,0,16),n(Ie,Le-32,tt[It].f,0,8),n(He,st-32,tt[It].ea,0,8)),at.Za){var Je=Se,xt=Ae-32+16;for(0<_e&&(ce>=h.za-1?i(Je,xt,tt[It].y[15],4):n(Je,xt,tt[It+1].y,0,4)),U=0;4>U;U++)Je[xt+128+U]=Je[xt+256+U]=Je[xt+384+U]=Je[xt+0+U];for(U=0;16>U;++U,Ge<<=2)Je=Se,xt=Ae+xg[U],jo[at.Ob[U]](Je,xt),vi(Ge,mt,16*+U,Je,xt)}else if(Je=Bo(ce,_e,at.Ob[0]),ya[Je](Se,Ae),Ge!=0)for(U=0;16>U;++U,Ge<<=2)vi(Ge,mt,16*+U,Se,Ae+xg[U]);for(U=at.Gc,Je=Bo(ce,_e,at.Dd),Ls[Je](Ie,Le),Ls[Je](He,st),Ge=mt,Je=Ie,xt=Le,255&(at=U>>0)&&(170&at?Yc(Ge,256,Je,xt):Co(Ge,256,Je,xt)),at=He,Ge=st,255&(U>>=8)&&(170&U?Yc(mt,320,at,Ge):Co(mt,320,at,Ge)),_e<h.Ub-1&&(n(tt[It].y,0,Se,Ae+480,16),n(tt[It].f,0,Ie,Le+224,8),n(tt[It].ea,0,He,st+224,8)),U=8*Pe*h.B,tt=h.sa,It=h.ta+16*ce+16*Pe*h.R,mt=h.qa,at=h.ra+8*ce+U,Ge=h.Ha,Je=h.Ia+8*ce+U,U=0;16>U;++U)n(tt,It+U*h.R,Se,Ae+32*U,16);for(U=0;8>U;++U)n(mt,at+U*h.B,Ie,Le+32*U,8),n(Ge,Je+U*h.B,He,st+32*U,8)}}function os(h,_,U,ce,_e,Pe,Se,Ae,Ie){var Le=[0],He=[0],st=0,at=Ie!=null?Ie.kd:0,tt=Ie??new la;if(h==null||12>U)return 7;tt.data=h,tt.w=_,tt.ha=U,_=[_],U=[U],tt.gb=[tt.gb];e:{var It=_,mt=U,Ge=tt.gb;if(e(h!=null),e(mt!=null),e(Ge!=null),Ge[0]=0,12<=mt[0]&&!r(h,It[0],"RIFF")){if(r(h,It[0]+8,"WEBP")){Ge=3;break e}var Je=ie(h,It[0]+4);if(12>Je||4294967286<Je){Ge=3;break e}if(at&&Je>mt[0]-8){Ge=7;break e}Ge[0]=Je,It[0]+=12,mt[0]-=12}Ge=0}if(Ge!=0)return Ge;for(Je=0<tt.gb[0],U=U[0];;){e:{var xt=h;mt=_,Ge=U;var Lt=Le,$t=He,ar=It=[0];if((rr=st=[st])[0]=0,8>Ge[0])Ge=7;else{if(!r(xt,mt[0],"VP8X")){if(ie(xt,mt[0]+4)!=10){Ge=3;break e}if(18>Ge[0]){Ge=7;break e}var Xt=ie(xt,mt[0]+8),$r=1+Q(xt,mt[0]+12);if(2147483648<=$r*(xt=1+Q(xt,mt[0]+15))){Ge=3;break e}ar!=null&&(ar[0]=Xt),Lt!=null&&(Lt[0]=$r),$t!=null&&($t[0]=xt),mt[0]+=18,Ge[0]-=18,rr[0]=1}Ge=0}}if(st=st[0],It=It[0],Ge!=0)return Ge;if(mt=!!(2&It),!Je&&st)return 3;if(Pe!=null&&(Pe[0]=!!(16&It)),Se!=null&&(Se[0]=mt),Ae!=null&&(Ae[0]=0),Se=Le[0],It=He[0],st&&mt&&Ie==null){Ge=0;break}if(4>U){Ge=7;break}if(Je&&st||!Je&&!st&&!r(h,_[0],"ALPH")){U=[U],tt.na=[tt.na],tt.P=[tt.P],tt.Sa=[tt.Sa];e:{Xt=h,Ge=_,Je=U;var rr=tt.gb;Lt=tt.na,$t=tt.P,ar=tt.Sa,$r=22,e(Xt!=null),e(Je!=null),xt=Ge[0];var mn=Je[0];for(e(Lt!=null),e(ar!=null),Lt[0]=null,$t[0]=null,ar[0]=0;;){if(Ge[0]=xt,Je[0]=mn,8>mn){Ge=7;break e}var vn=ie(Xt,xt+4);if(4294967286<vn){Ge=3;break e}var cn=8+vn+1&-2;if($r+=cn,0<rr&&$r>rr){Ge=3;break e}if(!r(Xt,xt,"VP8 ")||!r(Xt,xt,"VP8L")){Ge=0;break e}if(mn[0]<cn){Ge=7;break e}r(Xt,xt,"ALPH")||(Lt[0]=Xt,$t[0]=xt+8,ar[0]=vn),xt+=cn,mn-=cn}}if(U=U[0],tt.na=tt.na[0],tt.P=tt.P[0],tt.Sa=tt.Sa[0],Ge!=0)break}U=[U],tt.Ja=[tt.Ja],tt.xa=[tt.xa];e:if(rr=h,Ge=_,Je=U,Lt=tt.gb[0],$t=tt.Ja,ar=tt.xa,Xt=Ge[0],xt=!r(rr,Xt,"VP8 "),$r=!r(rr,Xt,"VP8L"),e(rr!=null),e(Je!=null),e($t!=null),e(ar!=null),8>Je[0])Ge=7;else{if(xt||$r){if(rr=ie(rr,Xt+4),12<=Lt&&rr>Lt-12){Ge=3;break e}if(at&&rr>Je[0]-8){Ge=7;break e}$t[0]=rr,Ge[0]+=8,Je[0]-=8,ar[0]=$r}else ar[0]=5<=Je[0]&&rr[Xt+0]==47&&!(rr[Xt+4]>>5),$t[0]=Je[0];Ge=0}if(U=U[0],tt.Ja=tt.Ja[0],tt.xa=tt.xa[0],_=_[0],Ge!=0)break;if(4294967286<tt.Ja)return 3;if(Ae==null||mt||(Ae[0]=tt.xa?2:1),Se=[Se],It=[It],tt.xa){if(5>U){Ge=7;break}Ae=Se,at=It,mt=Pe,h==null||5>U?h=0:5<=U&&h[_+0]==47&&!(h[_+4]>>5)?(Je=[0],rr=[0],Lt=[0],ne($t=new F,h,_,U),bt($t,Je,rr,Lt)?(Ae!=null&&(Ae[0]=Je[0]),at!=null&&(at[0]=rr[0]),mt!=null&&(mt[0]=Lt[0]),h=1):h=0):h=0}else{if(10>U){Ge=7;break}Ae=It,h==null||10>U||!Vr(h,_+3,U-3)?h=0:(at=h[_+0]|h[_+1]<<8|h[_+2]<<16,mt=16383&(h[_+7]<<8|h[_+6]),h=16383&(h[_+9]<<8|h[_+8]),1&at||3<(at>>1&7)||!(at>>4&1)||at>>5>=tt.Ja||!mt||!h?h=0:(Se&&(Se[0]=mt),Ae&&(Ae[0]=h),h=1))}if(!h||(Se=Se[0],It=It[0],st&&(Le[0]!=Se||He[0]!=It)))return 3;Ie!=null&&(Ie[0]=tt,Ie.offset=_-Ie.w,e(4294967286>_-Ie.w),e(Ie.offset==Ie.ha-U));break}return Ge==0||Ge==7&&st&&Ie==null?(Pe!=null&&(Pe[0]|=tt.na!=null&&0<tt.na.length),ce!=null&&(ce[0]=Se),_e!=null&&(_e[0]=It),0):Ge}function Uc(h,_,U){var ce=_.width,_e=_.height,Pe=0,Se=0,Ae=ce,Ie=_e;if(_.Da=h!=null&&0<h.Da,_.Da&&(Ae=h.cd,Ie=h.bd,Pe=h.v,Se=h.j,11>U||(Pe&=-2,Se&=-2),0>Pe||0>Se||0>=Ae||0>=Ie||Pe+Ae>ce||Se+Ie>_e))return 0;if(_.v=Pe,_.j=Se,_.va=Pe+Ae,_.o=Se+Ie,_.U=Ae,_.T=Ie,_.da=h!=null&&0<h.da,_.da){if(!de(Ae,Ie,U=[h.ib],Pe=[h.hb]))return 0;_.ib=U[0],_.hb=Pe[0]}return _.ob=h!=null&&h.ob,_.Kb=h==null||!h.Sd,_.da&&(_.ob=_.ib<3*ce/4&&_.hb<3*_e/4,_.Kb=0),1}function Hc(h){if(h==null)return 2;if(11>h.S){var _=h.f.RGBA;_.fb+=(h.height-1)*_.A,_.A=-_.A}else _=h.f.kb,h=h.height,_.O+=(h-1)*_.fa,_.fa=-_.fa,_.N+=(h-1>>1)*_.Ab,_.Ab=-_.Ab,_.W+=(h-1>>1)*_.Db,_.Db=-_.Db,_.F!=null&&(_.J+=(h-1)*_.lb,_.lb=-_.lb);return 0}function Hl(h,_,U,ce){if(ce==null||0>=h||0>=_)return 2;if(U!=null){if(U.Da){var _e=U.cd,Pe=U.bd,Se=-2&U.v,Ae=-2&U.j;if(0>Se||0>Ae||0>=_e||0>=Pe||Se+_e>h||Ae+Pe>_)return 2;h=_e,_=Pe}if(U.da){if(!de(h,_,_e=[U.ib],Pe=[U.hb]))return 2;h=_e[0],_=Pe[0]}}ce.width=h,ce.height=_;e:{var Ie=ce.width,Le=ce.height;if(h=ce.S,0>=Ie||0>=Le||!(h>=bu&&13>h))h=2;else{if(0>=ce.Rd&&ce.sd==null){Se=Pe=_e=_=0;var He=(Ae=Ie*Cg[h])*Le;if(11>h||(Pe=(Le+1)/2*(_=(Ie+1)/2),h==12&&(Se=(_e=Ie)*Le)),(Le=o(He+2*Pe+Se))==null){h=1;break e}ce.sd=Le,11>h?((Ie=ce.f.RGBA).eb=Le,Ie.fb=0,Ie.A=Ae,Ie.size=He):((Ie=ce.f.kb).y=Le,Ie.O=0,Ie.fa=Ae,Ie.Fd=He,Ie.f=Le,Ie.N=0+He,Ie.Ab=_,Ie.Cd=Pe,Ie.ea=Le,Ie.W=0+He+Pe,Ie.Db=_,Ie.Ed=Pe,h==12&&(Ie.F=Le,Ie.J=0+He+2*Pe),Ie.Tc=Se,Ie.lb=_e)}if(_=1,_e=ce.S,Pe=ce.width,Se=ce.height,_e>=bu&&13>_e)if(11>_e)h=ce.f.RGBA,_&=(Ae=Math.abs(h.A))*(Se-1)+Pe<=h.size,_&=Ae>=Pe*Cg[_e],_&=h.eb!=null;else{h=ce.f.kb,Ae=(Pe+1)/2,He=(Se+1)/2,Ie=Math.abs(h.fa),Le=Math.abs(h.Ab);var st=Math.abs(h.Db),at=Math.abs(h.lb),tt=at*(Se-1)+Pe;_&=Ie*(Se-1)+Pe<=h.Fd,_&=Le*(He-1)+Ae<=h.Cd,_=(_&=st*(He-1)+Ae<=h.Ed)&Ie>=Pe&Le>=Ae&st>=Ae,_&=h.y!=null,_&=h.f!=null,_&=h.ea!=null,_e==12&&(_&=at>=Pe,_&=tt<=h.Tc,_&=h.F!=null)}else _=0;h=_?0:2}}return h!=0||U!=null&&U.fd&&(h=Hc(ce)),h}var bi=64,Gl=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Wl=24,Yl=32,Gc=8,Qi=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ye("Predictor0","PredictorAdd0"),P.Predictor0=function(){return 4278190080},P.Predictor1=function(h){return h},P.Predictor2=function(h,_,U){return _[U+0]},P.Predictor3=function(h,_,U){return _[U+1]},P.Predictor4=function(h,_,U){return _[U-1]},P.Predictor5=function(h,_,U){return pe(pe(h,_[U+1]),_[U+0])},P.Predictor6=function(h,_,U){return pe(h,_[U-1])},P.Predictor7=function(h,_,U){return pe(h,_[U+0])},P.Predictor8=function(h,_,U){return pe(_[U-1],_[U+0])},P.Predictor9=function(h,_,U){return pe(_[U+0],_[U+1])},P.Predictor10=function(h,_,U){return pe(pe(h,_[U-1]),pe(_[U+0],_[U+1]))},P.Predictor11=function(h,_,U){var ce=_[U+0];return 0>=Ne(ce>>24&255,h>>24&255,(_=_[U-1])>>24&255)+Ne(ce>>16&255,h>>16&255,_>>16&255)+Ne(ce>>8&255,h>>8&255,_>>8&255)+Ne(255&ce,255&h,255&_)?ce:h},P.Predictor12=function(h,_,U){var ce=_[U+0];return(ge((h>>24&255)+(ce>>24&255)-((_=_[U-1])>>24&255))<<24|ge((h>>16&255)+(ce>>16&255)-(_>>16&255))<<16|ge((h>>8&255)+(ce>>8&255)-(_>>8&255))<<8|ge((255&h)+(255&ce)-(255&_)))>>>0},P.Predictor13=function(h,_,U){var ce=_[U-1];return(ke((h=pe(h,_[U+0]))>>24&255,ce>>24&255)<<24|ke(h>>16&255,ce>>16&255)<<16|ke(h>>8&255,ce>>8&255)<<8|ke(h>>0&255,ce>>0&255))>>>0};var kp=P.PredictorAdd0;P.PredictorAdd1=xe,ye("Predictor2","PredictorAdd2"),ye("Predictor3","PredictorAdd3"),ye("Predictor4","PredictorAdd4"),ye("Predictor5","PredictorAdd5"),ye("Predictor6","PredictorAdd6"),ye("Predictor7","PredictorAdd7"),ye("Predictor8","PredictorAdd8"),ye("Predictor9","PredictorAdd9"),ye("Predictor10","PredictorAdd10"),ye("Predictor11","PredictorAdd11"),ye("Predictor12","PredictorAdd12"),ye("Predictor13","PredictorAdd13");var Wc=P.PredictorAdd2;Ye("ColorIndexInverseTransform","MapARGB","32b",function(h){return h>>8&255},function(h){return h}),Ye("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(h){return h},function(h){return h>>8&255});var pu,xo=P.ColorIndexInverseTransform,Kl=P.MapARGB,mu=P.VP8LColorIndexInverseTransformAlpha,fu=P.MapAlpha,ha=P.VP8LPredictorsAdd=[];ha.length=16,(P.VP8LPredictors=[]).length=16,(P.VP8LPredictorsAdd_C=[]).length=16,(P.VP8LPredictors_C=[]).length=16;var ol,Xi,Hi,pa,Is,Ts,Jl,ks,Gn,Yc,Gi,Co,Ql,yu,Kc,sl,al,ma,ll,Xl,cl,fa,Jc,Ao,$o,In,Tn,Wn,li=o(511),Ns=o(2041),Qc=o(225),Zl=o(767),gu=0,Np=Ns,vu=Qc,mo=Zl,Eo=li,bu=0,_u=1,mg=2,Pu=3,Su=4,Lp=5,fg=6,Rp=7,Dp=8,wu=9,Mp=10,lP=[2,3,7],cP=[3,3,11],yg=[280,256,256,256,40],dP=[0,1,1,1,0],uP=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],hP=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],pP=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],mP=8,Fp=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Op=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Xc=null,fP=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],yP=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],gg=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],gP=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],vP=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],bP=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],_P=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ya=[],jo=[],Ls=[],PP=1,vg=2,ga=[],Io=[];yt("UpsampleRgbLinePair",Ce,3),yt("UpsampleBgrLinePair",Qe,3),yt("UpsampleRgbaLinePair",Or,4),yt("UpsampleBgraLinePair",tn,4),yt("UpsampleArgbLinePair",Fr,4),yt("UpsampleRgba4444LinePair",Ot,2),yt("UpsampleRgb565LinePair",ct,2);var SP=P.UpsampleRgbLinePair,wP=P.UpsampleBgrLinePair,bg=P.UpsampleRgbaLinePair,_g=P.UpsampleBgraLinePair,Pg=P.UpsampleArgbLinePair,Sg=P.UpsampleRgba4444LinePair,xP=P.UpsampleRgb565LinePair,xu=16,Cu=1<<xu-1,Zc=-227,Bp=482,CP=6,wg=0,AP=o(256),$P=o(256),EP=o(256),IP=o(256),TP=o(Bp-Zc),kP=o(Bp-Zc);xn("YuvToRgbRow",Ce,3),xn("YuvToBgrRow",Qe,3),xn("YuvToRgbaRow",Or,4),xn("YuvToBgraRow",tn,4),xn("YuvToArgbRow",Fr,4),xn("YuvToRgba4444Row",Ot,2),xn("YuvToRgb565Row",ct,2);var xg=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Au=[0,2,8],NP=[8,7,6,4,4,2,2,2,1,1,1,1],LP=1;this.WebPDecodeRGBA=function(h,_,U,ce,_e){var Pe=_u,Se=new $s,Ae=new Re;Se.ba=Ae,Ae.S=Pe,Ae.width=[Ae.width],Ae.height=[Ae.height];var Ie=Ae.width,Le=Ae.height,He=new lt;if(He==null||h==null)var st=2;else e(He!=null),st=os(h,_,U,He.width,He.height,He.Pd,He.Qd,He.format,null);if(st!=0?Ie=0:(Ie!=null&&(Ie[0]=He.width[0]),Le!=null&&(Le[0]=He.height[0]),Ie=1),Ie){Ae.width=Ae.width[0],Ae.height=Ae.height[0],ce!=null&&(ce[0]=Ae.width),_e!=null&&(_e[0]=Ae.height);e:{if(ce=new xr,(_e=new la).data=h,_e.w=_,_e.ha=U,_e.kd=1,_=[0],e(_e!=null),((h=os(_e.data,_e.w,_e.ha,null,null,null,_,null,_e))==0||h==7)&&_[0]&&(h=4),(_=h)==0){if(e(Se!=null),ce.data=_e.data,ce.w=_e.w+_e.offset,ce.ha=_e.ha-_e.offset,ce.put=Qt,ce.ac=Mt,ce.bc=lr,ce.ma=Se,_e.xa){if((h=hr())==null){Se=1;break e}if(function(at,tt){var It=[0],mt=[0],Ge=[0];t:for(;;){if(at==null)return 0;if(tt==null)return at.a=2,0;if(at.l=tt,at.a=0,ne(at.m,tt.data,tt.w,tt.ha),!bt(at.m,It,mt,Ge)){at.a=3;break t}if(at.xb=vg,tt.width=It[0],tt.height=mt[0],!Pr(It[0],mt[0],1,at,null))break t;return 1}return e(at.a!=0),0}(h,ce)){if(ce=(_=Hl(ce.width,ce.height,Se.Oa,Se.ba))==0){t:{ce=h;r:for(;;){if(ce==null){ce=0;break t}if(e(ce.s.yc!=null),e(ce.s.Ya!=null),e(0<ce.s.Wb),e((U=ce.l)!=null),e((_e=U.ma)!=null),ce.xb!=0){if(ce.ca=_e.ba,ce.tb=_e.tb,e(ce.ca!=null),!Uc(_e.Oa,U,Pu)){ce.a=2;break r}if(!Jr(ce,U.width)||U.da)break r;if((U.da||dt(ce.ca.S))&&Ze(),11>ce.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),ce.ca.f.kb.F!=null&&Ze()),ce.Pb&&0<ce.s.ua&&ce.s.vb.X==null&&!me(ce.s.vb,ce.s.Wa.Xa)){ce.a=1;break r}ce.xb=0}if(!At(ce,ce.V,ce.Ba,ce.c,ce.i,U.o,Vt))break r;_e.Dc=ce.Ma,ce=1;break t}e(ce.a!=0),ce=0}ce=!ce}ce&&(_=h.a)}else _=h.a}else{if((h=new Hr)==null){Se=1;break e}if(h.Fa=_e.na,h.P=_e.P,h.qc=_e.Sa,Qr(h,ce)){if((_=Hl(ce.width,ce.height,Se.Oa,Se.ba))==0){if(h.Aa=0,U=Se.Oa,e((_e=h)!=null),U!=null){if(0<(Ie=0>(Ie=U.Md)?0:100<Ie?255:255*Ie/100)){for(Le=He=0;4>Le;++Le)12>(st=_e.pb[Le]).lc&&(st.ia=Ie*NP[0>st.lc?0:st.lc]>>3),He|=st.ia;He&&(alert("todo:VP8InitRandom"),_e.ia=1)}_e.Ga=U.Id,100<_e.Ga?_e.Ga=100:0>_e.Ga&&(_e.Ga=0)}tr(h,ce)||(_=h.a)}}else _=h.a}_==0&&Se.Oa!=null&&Se.Oa.fd&&(_=Hc(Se.ba))}Se=_}Pe=Se!=0?null:11>Pe?Ae.f.RGBA.eb:Ae.f.kb.y}else Pe=null;return Pe};var Cg=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(P,$){for(var D="",b=0;b<4;b++)D+=String.fromCharCode(P[$++]);return D}function u(P,$){return(P[$+0]<<0|P[$+1]<<8|P[$+2]<<16)>>>0}function y(P,$){return(P[$+0]<<0|P[$+1]<<8|P[$+2]<<16|P[$+3]<<24)>>>0}new c;var g=[0],f=[0],w=[],E=new c,x=t,T=function(P,$){var D={},b=0,S=!1,v=0,z=0;if(D.frames=[],!function(k,N,A,V){for(var Z=0;Z<V;Z++)if(k[N+Z]!=A.charCodeAt(Z))return!0;return!1}(P,$,"RIFF",4)){for(y(P,$+=4),$+=8;$<P.length;){var re=d(P,$),L=y(P,$+=4);$+=4;var O=L+(1&L);switch(re){case"VP8 ":case"VP8L":D.frames[b]===void 0&&(D.frames[b]={}),(W=D.frames[b]).src_off=S?z:$-8,W.src_size=v+L+8,b++,S&&(S=!1,v=0,z=0);break;case"VP8X":(W=D.header={}).feature_flags=P[$];var ne=$+4;W.canvas_width=1+u(P,ne),ne+=3,W.canvas_height=1+u(P,ne),ne+=3;break;case"ALPH":S=!0,v=O+8,z=$-8;break;case"ANIM":(W=D.header).bgcolor=y(P,$),ne=$+4,W.loop_count=(se=P)[(F=ne)+0]<<0|se[F+1]<<8,ne+=2;break;case"ANMF":var X,W;(W=D.frames[b]={}).offset_x=2*u(P,$),$+=3,W.offset_y=2*u(P,$),$+=3,W.width=1+u(P,$),$+=3,W.height=1+u(P,$),$+=3,W.duration=u(P,$),$+=3,X=P[$++],W.dispose=1&X,W.blend=X>>1&1}re!="ANMF"&&($+=O)}var se,F;return D}}(x,0);T.response=x,T.rgbaoutput=!0,T.dataurl=!1;var Y=T.header?T.header:null,K=T.frames?T.frames:null;if(Y){Y.loop_counter=Y.loop_count,g=[Y.canvas_height],f=[Y.canvas_width];for(var j=0;j<K.length&&K[j].blend!=0;j++);}var q=K[0],J=E.WebPDecodeRGBA(x,q.src_off,q.src_size,f,g);q.rgba=J,q.imgwidth=f[0],q.imgheight=g[0];for(var C=0;C<f[0]*g[0]*4;C++)w[C]=J[C];return this.width=f,this.height=g,this.data=w,this}(function(t){var e=function(){return typeof zf=="function"},r=function(g,f,w,E){var x=4,T=s;switch(E){case t.image_compression.FAST:x=1,T=o;break;case t.image_compression.MEDIUM:x=6,T=l;break;case t.image_compression.SLOW:x=9,T=c}g=n(g,f,w,T);var Y=zf(g,{level:x});return t.__addimage__.arrayBufferToBinaryString(Y)},n=function(g,f,w,E){for(var x,T,Y,K=g.length/f,j=new Uint8Array(g.length+K),q=u(),J=0;J<K;J+=1){if(Y=J*f,x=g.subarray(Y,Y+f),E)j.set(E(x,w,T),Y+J);else{for(var C,P=q.length,$=[];C<P;C+=1)$[C]=q[C](x,w,T);var D=y($.concat());j.set($[D],Y+J)}T=x}return j},i=function(g){var f=Array.apply([],g);return f.unshift(0),f},o=function(g,f){var w,E=[],x=g.length;E[0]=1;for(var T=0;T<x;T+=1)w=g[T-f]||0,E[T+1]=g[T]-w+256&255;return E},s=function(g,f,w){var E,x=[],T=g.length;x[0]=2;for(var Y=0;Y<T;Y+=1)E=w&&w[Y]||0,x[Y+1]=g[Y]-E+256&255;return x},l=function(g,f,w){var E,x,T=[],Y=g.length;T[0]=3;for(var K=0;K<Y;K+=1)E=g[K-f]||0,x=w&&w[K]||0,T[K+1]=g[K]+256-(E+x>>>1)&255;return T},c=function(g,f,w){var E,x,T,Y,K=[],j=g.length;K[0]=4;for(var q=0;q<j;q+=1)E=g[q-f]||0,x=w&&w[q]||0,T=w&&w[q-f]||0,Y=d(E,x,T),K[q+1]=g[q]-Y+256&255;return K},d=function(g,f,w){if(g===f&&f===w)return g;var E=Math.abs(f-w),x=Math.abs(g-w),T=Math.abs(g+f-w-w);return E<=x&&E<=T?g:x<=T?f:w},u=function(){return[i,o,s,l,c]},y=function(g){var f=g.map(function(w){return w.reduce(function(E,x){return E+Math.abs(x)},0)});return f.indexOf(Math.min.apply(null,f))};t.processPNG=function(g,f,w,E){var x,T,Y,K,j,q,J,C,P,$,D,b,S,v,z,re=this.decode.FLATE_DECODE,L="";if(this.__addimage__.isArrayBuffer(g)&&(g=new Uint8Array(g)),this.__addimage__.isArrayBufferView(g)){if(g=(Y=new vR(g)).imgData,T=Y.bits,x=Y.colorSpace,j=Y.colors,[4,6].indexOf(Y.colorType)!==-1){if(Y.bits===8){P=(C=Y.pixelBitlength==32?new Uint32Array(Y.decodePixels().buffer):Y.pixelBitlength==16?new Uint16Array(Y.decodePixels().buffer):new Uint8Array(Y.decodePixels().buffer)).length,D=new Uint8Array(P*Y.colors),$=new Uint8Array(P);var O,ne=Y.pixelBitlength-Y.bits;for(v=0,z=0;v<P;v++){for(S=C[v],O=0;O<ne;)D[z++]=S>>>O&255,O+=Y.bits;$[v]=S>>>O&255}}if(Y.bits===16){P=(C=new Uint32Array(Y.decodePixels().buffer)).length,D=new Uint8Array(P*(32/Y.pixelBitlength)*Y.colors),$=new Uint8Array(P*(32/Y.pixelBitlength)),b=Y.colors>1,v=0,z=0;for(var X=0;v<P;)S=C[v++],D[z++]=S>>>0&255,b&&(D[z++]=S>>>16&255,S=C[v++],D[z++]=S>>>0&255),$[X++]=S>>>16&255;T=8}E!==t.image_compression.NONE&&e()?(g=r(D,Y.width*Y.colors,Y.colors,E),J=r($,Y.width,1,E)):(g=D,J=$,re=void 0)}if(Y.colorType===3&&(x=this.color_spaces.INDEXED,q=Y.palette,Y.transparency.indexed)){var W=Y.transparency.indexed,se=0;for(v=0,P=W.length;v<P;++v)se+=W[v];if((se/=255)===P-1&&W.indexOf(0)!==-1)K=[W.indexOf(0)];else if(se!==P){for(C=Y.decodePixels(),$=new Uint8Array(C.length),v=0,P=C.length;v<P;v++)$[v]=W[C[v]];J=r($,Y.width,1)}}var F=function(k){var N;switch(k){case t.image_compression.FAST:N=11;break;case t.image_compression.MEDIUM:N=13;break;case t.image_compression.SLOW:N=14;break;default:N=12}return N}(E);return re===this.decode.FLATE_DECODE&&(L="/Predictor "+F+" "),L+="/Colors "+j+" /BitsPerComponent "+T+" /Columns "+Y.width,(this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g))&&(g=this.__addimage__.arrayBufferToBinaryString(g)),(J&&this.__addimage__.isArrayBuffer(J)||this.__addimage__.isArrayBufferView(J))&&(J=this.__addimage__.arrayBufferToBinaryString(J)),{alias:w,data:g,index:f,filter:re,decodeParameters:L,transparency:K,palette:q,sMask:J,predictor:F,width:Y.width,height:Y.height,bitsPerComponent:T,colorSpace:x}}}})(Er.API),function(t){t.processGIF89A=function(e,r,n,i){var o=new bR(e),s=o.width,l=o.height,c=[];o.decodeAndBlitFrameRGBA(0,c);var d={data:c,width:s,height:l},u=new zm(100).encode(d,100);return t.processJPEG.call(this,u,r,n,i)},t.processGIF87A=t.processGIF89A}(Er.API),zo.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:n,blue:r,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},zo.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){An.log("bit decode error:"+r)}},zo.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var o=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*i*4,l=0;l<8&&8*i+l<this.width;l++){var c=this.palette[o>>7-l&1];this.data[s+4*l]=c.blue,this.data[s+4*l+1]=c.green,this.data[s+4*l+2]=c.red,this.data[s+4*l+3]=255}r!==0&&(this.pos+=4-r)}},zo.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<t;i++){var o=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*i*4,l=o>>4,c=15&o,d=this.palette[l];if(this.data[s]=d.blue,this.data[s+1]=d.green,this.data[s+2]=d.red,this.data[s+3]=255,2*i+1>=this.width)break;d=this.palette[c],this.data[s+4]=d.blue,this.data[s+4+1]=d.green,this.data[s+4+2]=d.red,this.data[s+4+3]=255}e!==0&&(this.pos+=4-e)}},zo.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+4*n;if(i<this.palette.length){var s=this.palette[i];this.data[o]=s.red,this.data[o+1]=s.green,this.data[o+2]=s.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}t!==0&&(this.pos+=4-t)}},zo.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(o&e)/e*255|0,l=(o>>5&e)/e*255|0,c=(o>>10&e)/e*255|0,d=o>>15?255:0,u=n*this.width*4+4*i;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=s,this.data[u+3]=d}this.pos+=t}},zo.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(s&e)/e*255|0,c=(s>>5&r)/r*255|0,d=(s>>11)/e*255|0,u=i*this.width*4+4*o;this.data[u]=d,this.data[u+1]=c,this.data[u+2]=l,this.data[u+3]=255}this.pos+=t}},zo.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*r;this.data[s]=o,this.data[s+1]=i,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},zo.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=o,this.data[l+1]=i,this.data[l+2]=n,this.data[l+3]=s}},zo.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,r,n,i){var o=new zo(e,!1),s=o.width,l=o.height,c={data:o.getData(),width:s,height:l},d=new zm(100).encode(c,100);return t.processJPEG.call(this,d,r,n,i)}}(Er.API),Ib.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,r,n,i){var o=new Ib(e),s=o.width,l=o.height,c={data:o.getData(),width:s,height:l},d=new zm(100).encode(c,100);return t.processJPEG.call(this,d,r,n,i)}}(Er.API),Er.API.processRGBA=function(t,e,r){for(var n=t.data,i=n.length,o=new Uint8Array(i/4*3),s=new Uint8Array(i/4),l=0,c=0,d=0;d<i;d+=4){var u=n[d],y=n[d+1],g=n[d+2],f=n[d+3];o[l++]=u,o[l++]=y,o[l++]=g,s[c++]=f}var w=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:w,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},Er.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},cc=Er.API,sh=cc.getCharWidthsArray=function(t,e){var r,n,i=(e=e||{}).font||this.internal.getFont(),o=e.fontSize||this.internal.getFontSize(),s=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:i.metadata.Unicode.widths,c=l.fof?l.fof:1,d=e.kerning?e.kerning:i.metadata.Unicode.kerning,u=d.fof?d.fof:1,y=e.doKerning!==!1,g=0,f=t.length,w=0,E=l[0]||c,x=[];for(r=0;r<f;r++)n=t.charCodeAt(r),typeof i.metadata.widthOfString=="function"?x.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+s*(1e3/o)||0)/1e3):(g=y&&Pn(d[n])==="object"&&!isNaN(parseInt(d[n][w],10))?d[n][w]/u:0,x.push((l[n]||E)/c+g)),w=n;return x},Cb=cc.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return cc.processArabic&&(t=cc.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,i)/r:sh.apply(this,arguments).reduce(function(o,s){return o+s},0)},Ab=function(t,e,r,n){for(var i=[],o=0,s=t.length,l=0;o!==s&&l+e[o]<r;)l+=e[o],o++;i.push(t.slice(0,o));var c=o;for(l=0;o!==s;)l+e[o]>n&&(i.push(t.slice(c,o)),l=0,c=o),l+=e[o],o++;return c!==o&&i.push(t.slice(c,o)),i},$b=function(t,e,r){r||(r={});var n,i,o,s,l,c,d,u=[],y=[u],g=r.textIndent||0,f=0,w=0,E=t.split(" "),x=sh.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?E[0].length+2:r.lineIndent||0){var T=Array(c).join(" "),Y=[];E.map(function(j){(j=j.split(/\s*\n/)).length>1?Y=Y.concat(j.map(function(q,J){return(J&&q.length?`
`:"")+q})):Y.push(j[0])}),E=Y,c=Cb.apply(this,[T,r])}for(o=0,s=E.length;o<s;o++){var K=0;if(n=E[o],c&&n[0]==`
`&&(n=n.substr(1),K=1),g+f+(w=(i=sh.apply(this,[n,r])).reduce(function(j,q){return j+q},0))>e||K){if(w>e){for(l=Ab.apply(this,[n,i,e-(g+f),e]),u.push(l.shift()),u=[l.pop()];l.length;)y.push([l.shift()]);w=i.slice(n.length-(u[0]?u[0].length:0)).reduce(function(j,q){return j+q},0)}else u=[n];y.push(u),g=w+c,f=x}else u.push(n),g+=f+w,f=x}return d=c?function(j,q){return(q?T:"")+j.join(" ")}:function(j){return j.join(" ")},y.map(d)},cc.splitTextToSize=function(t,e,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),o=function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var y=this.internal.getFont(u.fontName,u.fontStyle);return y.metadata.Unicode?{widths:y.metadata.Unicode.widths||{0:1},kerning:y.metadata.Unicode.kerning||{}}:{font:y.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var s=1*this.internal.scaleFactor*e/i;o.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,o.lineIndent=r.lineIndent;var l,c,d=[];for(l=0,c=n.length;l<c;l++)d=d.concat($b.apply(this,[n[l],s,o]));return d},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",r={},n={},i=0;i<e.length;i++)r[e[i]]="0123456789abcdef"[i],n["0123456789abcdef"[i]]=e[i];var o=function(y){return"0x"+parseInt(y,10).toString(16)},s=t.__fontmetrics__.compress=function(y){var g,f,w,E,x=["{"];for(var T in y){if(g=y[T],isNaN(parseInt(T,10))?f="'"+T+"'":(T=parseInt(T,10),f=(f=o(T).slice(2)).slice(0,-1)+n[f.slice(-1)]),typeof g=="number")g<0?(w=o(g).slice(3),E="-"):(w=o(g).slice(2),E=""),w=E+w.slice(0,-1)+n[w.slice(-1)];else{if(Pn(g)!=="object")throw new Error("Don't know what to do with value type "+Pn(g)+".");w=s(g)}x.push(f+w)}return x.push("}"),x.join("")},l=t.__fontmetrics__.uncompress=function(y){if(typeof y!="string")throw new Error("Invalid argument passed to uncompress.");for(var g,f,w,E,x={},T=1,Y=x,K=[],j="",q="",J=y.length-1,C=1;C<J;C+=1)(E=y[C])=="'"?g?(w=g.join(""),g=void 0):g=[]:g?g.push(E):E=="{"?(K.push([Y,w]),Y={},w=void 0):E=="}"?((f=K.pop())[0][f[1]]=Y,w=void 0,Y=f[0]):E=="-"?T=-1:w===void 0?r.hasOwnProperty(E)?(j+=r[E],w=parseInt(j,16)*T,T=1,j=""):j+=E:r.hasOwnProperty(E)?(q+=r[E],Y[w]=parseInt(q,16)*T,T=1,w=void 0,q=""):q+=E;return x},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},u={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(y){var g=y.font,f=u.Unicode[g.postScriptName];f&&(g.metadata.Unicode={},g.metadata.Unicode.widths=f.widths,g.metadata.Unicode.kerning=f.kerning);var w=d.Unicode[g.postScriptName];w&&(g.metadata.Unicode.encoding=w,g.encoding=w.codePages[0])}])}(Er.API),function(t){var e=function(r){for(var n=r.length,i=new Uint8Array(n),o=0;o<n;o++)i[o]=r.charCodeAt(o);return i};t.API.events.push(["addFont",function(r){var n=void 0,i=r.font,o=r.instance;if(!i.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=o.existsFileInVFS(i.postScriptName)===!1?o.loadFile(i.postScriptName):o.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(s,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(Td(l)),s.metadata=t.API.TTFFont.open(l),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(i,n)}}])}(Er),function(t){function e(){return(kr.canvg?Promise.resolve(kr.canvg):ao(()=>import("./index.es-x4W_XQVk.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}Er.API.addSvgAsImage=function(r,n,i,o,s,l,c,d){if(isNaN(n)||isNaN(i))throw An.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(o)||isNaN(s))throw An.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=o,u.height=s;var y=u.getContext("2d");y.fillStyle="#fff",y.fillRect(0,0,u.width,u.height);var g={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return e().then(function(w){return w.fromString(y,r,g)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(w){return w.render(g)}).then(function(){f.addImage(u.toDataURL("image/jpeg",1),n,i,o,s,c,d)})}}(),Er.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(e,r);return this},Er.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,i,o,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(s),c=[],d=0,u=0,y=0;function g(w,E){var x,T=!1;for(x=0;x<w.length;x+=1)w[x]===E&&(T=!0);return T}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var f=l.length;for(y=0;y<f;y+=1)r[l[y]].value=r[l[y]].defaultValue,r[l[y]].explicitSet=!1}if(Pn(t)==="object"){for(i in t)if(o=t[i],g(l,i)&&o!==void 0){if(r[i].type==="boolean"&&typeof o=="boolean")r[i].value=o;else if(r[i].type==="name"&&g(r[i].valueSet,o))r[i].value=o;else if(r[i].type==="integer"&&Number.isInteger(o))r[i].value=o;else if(r[i].type==="array"){for(d=0;d<o.length;d+=1)if(n=!0,o[d].length===1&&typeof o[d][0]=="number")c.push(String(o[d]-1));else if(o[d].length>1){for(u=0;u<o[d].length;u+=1)typeof o[d][u]!="number"&&(n=!1);n===!0&&c.push([o[d][0]-1,o[d][1]-1].join(" "))}r[i].value="["+c.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var w,E=[];for(w in r)r[w].explicitSet===!0&&(r[w].type==="name"?E.push("/"+w+" /"+r[w].value):E.push("/"+w+" "+r[w].value));E.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+E.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),d=o.length+s.length+l.length+i.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(i+o+s+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}(Er.API),function(t){var e=t.API,r=e.pdfEscape16=function(o,s){for(var l,c=s.metadata.Unicode.widths,d=["","0","00","000","0000"],u=[""],y=0,g=o.length;y<g;++y){if(l=s.metadata.characterToGlyph(o.charCodeAt(y)),s.metadata.glyIdsUsed.push(l),s.metadata.toUnicode[l]=o.charCodeAt(y),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(s.metadata.widthOfGlyph(l),10)])),l=="0")return u.join("");l=l.toString(16),u.push(d[4-l.length],l)}return u.join("")},n=function(o){var s,l,c,d,u,y,g;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],y=0,g=(l=Object.keys(o).sort(function(f,w){return f-w})).length;y<g;y++)s=l[y],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),o[s]!==void 0&&o[s]!==null&&typeof o[s].toString=="function"&&(d=("0000"+o[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),c.push("<"+s+"><"+d+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(o){(function(s){var l=s.font,c=s.out,d=s.newObject,u=s.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var y=l.metadata.Unicode.widths,g=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),f="",w=0;w<g.length;w++)f+=String.fromCharCode(g[w]);var E=d();u({data:f,addLength1:!0,objectId:E}),c("endobj");var x=d();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:x}),c("endobj");var T=d();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+vc(l.fontName)),c("/FontFile2 "+E+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var Y=d();c("<<"),c("/Type /Font"),c("/BaseFont /"+vc(l.fontName)),c("/FontDescriptor "+T+" 0 R"),c("/W "+t.API.PDFObject.convert(y)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=d(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+x+" 0 R"),c("/BaseFont /"+vc(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+Y+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(o)}]),e.events.push(["putFont",function(o){(function(s){var l=s.font,c=s.out,d=s.newObject,u=s.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var y=l.metadata.rawData,g="",f=0;f<y.length;f++)g+=String.fromCharCode(y[f]);var w=d();u({data:g,addLength1:!0,objectId:w}),c("endobj");var E=d();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:E}),c("endobj");var x=d();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+w+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+vc(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=d();for(var T=0;T<l.metadata.hmtx.widths.length;T++)l.metadata.hmtx.widths[T]=parseInt(l.metadata.hmtx.widths[T]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+E+" 0 R/BaseFont/"+vc(l.fontName)+"/FontDescriptor "+x+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(o)}]);var i=function(o){var s,l=o.text||"",c=o.x,d=o.y,u=o.options||{},y=o.mutex||{},g=y.pdfEscape,f=y.activeFontKey,w=y.fonts,E=f,x="",T=0,Y="",K=w[E].encoding;if(w[E].encoding!=="Identity-H")return{text:l,x:c,y:d,options:u,mutex:y};for(Y=l,E=f,Array.isArray(l)&&(Y=l[0]),T=0;T<Y.length;T+=1)w[E].metadata.hasOwnProperty("cmap")&&(s=w[E].metadata.cmap.unicode.codeMap[Y[T].charCodeAt(0)]),s||Y[T].charCodeAt(0)<256&&w[E].metadata.hasOwnProperty("Unicode")?x+=Y[T]:x+="";var j="";return parseInt(E.slice(1))<14||K==="WinAnsiEncoding"?j=g(x,E).split("").map(function(q){return q.charCodeAt(0).toString(16)}).join(""):K==="Identity-H"&&(j=r(x,w[E])),y.isHex=!0,{text:j,x:c,y:d,options:u,mutex:y}};e.events.push(["postProcessText",function(o){var s=o.text||"",l=[],c={text:s,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(s)){var d=0;for(d=0;d<s.length;d+=1)Array.isArray(s[d])&&s[d].length===3?l.push([i(Object.assign({},c,{text:s[d][0]})).text,s[d][1],s[d][2]]):l.push(i(Object.assign({},c,{text:s[d]})).text);o.text=l}else o.text=i(Object.assign({},c,{text:s})).text}])}(Er),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Er.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var i,o,s,l,c,d,u,y=e,g=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],w={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},E={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},x=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],T=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),Y=!1,K=0;this.__bidiEngine__={};var j=function(b){var S=b.charCodeAt(),v=S>>8,z=E[v];return z!==void 0?y[256*z+(255&S)]:v===252||v===253?"AL":T.test(v)?"L":v===8?"R":"N"},q=function(b){for(var S,v=0;v<b.length;v++){if((S=j(b.charAt(v)))==="L")return!1;if(S==="R")return!0}return!1},J=function(b,S,v,z){var re,L,O,ne,X=S[z];switch(X){case"L":case"R":Y=!1;break;case"N":case"AN":break;case"EN":Y&&(X="AN");break;case"AL":Y=!0,X="R";break;case"WS":X="N";break;case"CS":z<1||z+1>=S.length||(re=v[z-1])!=="EN"&&re!=="AN"||(L=S[z+1])!=="EN"&&L!=="AN"?X="N":Y&&(L="AN"),X=L===re?L:"N";break;case"ES":X=(re=z>0?v[z-1]:"B")==="EN"&&z+1<S.length&&S[z+1]==="EN"?"EN":"N";break;case"ET":if(z>0&&v[z-1]==="EN"){X="EN";break}if(Y){X="N";break}for(O=z+1,ne=S.length;O<ne&&S[O]==="ET";)O++;X=O<ne&&S[O]==="EN"?"EN":"N";break;case"NSM":if(s&&!l){for(ne=S.length,O=z+1;O<ne&&S[O]==="NSM";)O++;if(O<ne){var W=b[z],se=W>=1425&&W<=2303||W===64286;if(re=S[O],se&&(re==="R"||re==="AL")){X="R";break}}}X=z<1||(re=S[z-1])==="B"?"N":v[z-1];break;case"B":Y=!1,i=!0,X=K;break;case"S":o=!0,X="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":Y=!1;break;case"BN":X="N"}return X},C=function(b,S,v){var z=b.split("");return v&&P(z,v,{hiLevel:K}),z.reverse(),S&&S.reverse(),z.join("")},P=function(b,S,v){var z,re,L,O,ne,X=-1,W=b.length,se=0,F=[],k=K?f:g,N=[];for(Y=!1,i=!1,o=!1,re=0;re<W;re++)N[re]=j(b[re]);for(L=0;L<W;L++){if(ne=se,F[L]=J(b,N,F,L),z=240&(se=k[ne][w[F[L]]]),se&=15,S[L]=O=k[se][5],z>0)if(z===16){for(re=X;re<L;re++)S[re]=1;X=-1}else X=-1;if(k[se][6])X===-1&&(X=L);else if(X>-1){for(re=X;re<L;re++)S[re]=O;X=-1}N[L]==="B"&&(S[L]=0),v.hiLevel|=O}o&&function(A,V,Z){for(var H=0;H<Z;H++)if(A[H]==="S"){V[H]=K;for(var B=H-1;B>=0&&A[B]==="WS";B--)V[B]=K}}(N,S,W)},$=function(b,S,v,z,re){if(!(re.hiLevel<b)){if(b===1&&K===1&&!i)return S.reverse(),void(v&&v.reverse());for(var L,O,ne,X,W=S.length,se=0;se<W;){if(z[se]>=b){for(ne=se+1;ne<W&&z[ne]>=b;)ne++;for(X=se,O=ne-1;X<O;X++,O--)L=S[X],S[X]=S[O],S[O]=L,v&&(L=v[X],v[X]=v[O],v[O]=L);se=ne}se++}}},D=function(b,S,v){var z=b.split(""),re={hiLevel:K};return v||(v=[]),P(z,v,re),function(L,O,ne){if(ne.hiLevel!==0&&u)for(var X,W=0;W<L.length;W++)O[W]===1&&(X=x.indexOf(L[W]))>=0&&(L[W]=x[X+1])}(z,v,re),$(2,z,S,v,re),$(1,z,S,v,re),z.join("")};return this.__bidiEngine__.doBidiReorder=function(b,S,v){if(function(re,L){if(L)for(var O=0;O<re.length;O++)L[O]=O;l===void 0&&(l=q(re)),d===void 0&&(d=q(re))}(b,S),s||!c||d)if(s&&c&&l^d)K=l?1:0,b=C(b,S,v);else if(!s&&c&&d)K=l?1:0,b=D(b,S,v),b=C(b,S);else if(!s||l||c||d){if(s&&!c&&l^d)b=C(b,S),l?(K=0,b=D(b,S,v)):(K=1,b=D(b,S,v),b=C(b,S));else if(s&&l&&!c&&d)K=1,b=D(b,S,v),b=C(b,S);else if(!s&&!c&&l^d){var z=u;l?(K=1,b=D(b,S,v),K=0,u=!1,b=D(b,S,v),u=z):(K=0,b=D(b,S,v),b=C(b,S),K=1,u=!1,b=D(b,S,v),u=z,b=C(b,S))}}else K=0,b=D(b,S,v);else K=l?1:0,b=D(b,S,v);return b},this.__bidiEngine__.setOptions=function(b){b&&(s=b.isInputVisual,c=b.isOutputVisual,l=b.isInputRtl,d=b.isOutputRtl,u=b.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var o=n.options||{};n.mutex,o.lang;var s=[];if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,r.setOptions(o),Object.prototype.toString.call(i)==="[object Array]"){var l=0;for(s=[],l=0;l<i.length;l+=1)Object.prototype.toString.call(i[l])==="[object Array]"?s.push([r.doBidiReorder(i[l][0]),i[l][1],i[l][2]]):s.push([r.doBidiReorder(i[l])]);n.text=s}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])}(Er),Er.API.TTFFont=function(){function t(e){var r;if(this.rawData=e,r=this.contents=new Qa(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new RR(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new _R(this.contents),this.head=new SR(this),this.name=new $R(this),this.cmap=new D_(this),this.toUnicode={},this.hhea=new wR(this),this.maxp=new ER(this),this.hmtx=new IR(this),this.post=new CR(this),this.os2=new xR(this),this.loca=new LR(this),this.glyf=new TR(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,i,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var s,l,c,d;for(d=[],s=0,l=(c=this.bbox).length;s<l;s++)e=c[s],d.push(Math.round(e*this.scaleFactor));return d}.call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),(32768&(r=i>>16))!=0&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var i,o,s,l;for(s=0,o=0,l=(e=""+e).length;0<=l?o<l:o>l;o=0<=l?++o:--o)i=e.charCodeAt(o),s+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return s*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t}();var Qo,Qa=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,i;for(i=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(e.charCodeAt(r)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,i,o,s,l,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),o=this.readByte(),s=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^o)+65536*(255^s)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*i+16777216*o+65536*s+256*l+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,i,o;for(o=[],n=0,i=e.length;n<i;n++)r=e[n],o.push(this.writeByte(r));return o},t}(),_R=function(){var t;function e(r){var n,i,o;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,o=this.tableCount;0<=o?i<o:i>o;i=0<=o?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,i,o,s,l,c,d,u,y,g,f,w,E;for(E in f=Object.keys(r).length,c=Math.log(2),y=16*Math.floor(Math.log(f)/c),s=Math.floor(y/c),u=16*f-y,(i=new Qa).writeInt(this.scalarType),i.writeShort(f),i.writeShort(y),i.writeShort(s),i.writeShort(u),o=16*f,d=i.pos+o,l=null,w=[],r)for(g=r[E],i.writeString(E),i.writeInt(t(g)),i.writeInt(d),i.writeInt(g.length),w=w.concat(g),E==="head"&&(l=d),d+=g.length;d%4;)w.push(0),d++;return i.write(w),n=2981146554-t(i.data),i.pos=l+8,i.writeUInt32(n),i.data},t=function(r){var n,i,o,s;for(r=M_.call(r);r.length%4;)r.push(0);for(o=new Qa(r),i=0,n=0,s=r.length;n<s;n=n+=4)i+=o.readUInt32();return 4294967295&i},e}(),PR={}.hasOwnProperty,ws=function(t,e){for(var r in e)PR.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Qo=function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var SR=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ws(e,Qo),e.prototype.tag="head",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},e.prototype.encode=function(r){var n;return(n=new Qa).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},e}(),Tb=function(){function t(e,r){var n,i,o,s,l,c,d,u,y,g,f,w,E,x,T,Y,K;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),y=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(f=e.readUInt16(),g=f/2,e.pos+=6,o=function(){var j,q;for(q=[],c=j=0;0<=g?j<g:j>g;c=0<=g?++j:--j)q.push(e.readUInt16());return q}(),e.pos+=2,E=function(){var j,q;for(q=[],c=j=0;0<=g?j<g:j>g;c=0<=g?++j:--j)q.push(e.readUInt16());return q}(),d=function(){var j,q;for(q=[],c=j=0;0<=g?j<g:j>g;c=0<=g?++j:--j)q.push(e.readUInt16());return q}(),u=function(){var j,q;for(q=[],c=j=0;0<=g?j<g:j>g;c=0<=g?++j:--j)q.push(e.readUInt16());return q}(),i=(this.length-e.pos+this.offset)/2,l=function(){var j,q;for(q=[],c=j=0;0<=i?j<i:j>i;c=0<=i?++j:--j)q.push(e.readUInt16());return q}(),c=T=0,K=o.length;T<K;c=++T)for(x=o[c],n=Y=w=E[c];w<=x?Y<=x:Y>=x;n=w<=x?++Y:--Y)u[c]===0?s=n+d[c]:(s=l[u[c]/2+(n-w)-(g-c)]||0)!==0&&(s+=d[c]),this.codeMap[n]=65535&s}e.pos=y}return t.encode=function(e,r){var n,i,o,s,l,c,d,u,y,g,f,w,E,x,T,Y,K,j,q,J,C,P,$,D,b,S,v,z,re,L,O,ne,X,W,se,F,k,N,A,V,Z,H,B,M,G,Q;switch(z=new Qa,s=Object.keys(e).sort(function(ie,me){return ie-me}),r){case"macroman":for(E=0,x=function(){var ie=[];for(w=0;w<256;++w)ie.push(0);return ie}(),Y={0:0},o={},re=0,X=s.length;re<X;re++)Y[B=e[i=s[re]]]==null&&(Y[B]=++E),o[i]={old:e[i],new:Y[e[i]]},x[i]=Y[e[i]];return z.writeUInt16(1),z.writeUInt16(0),z.writeUInt32(12),z.writeUInt16(0),z.writeUInt16(262),z.writeUInt16(0),z.write(x),{charMap:o,subtable:z.data,maxGlyphID:E+1};case"unicode":for(S=[],y=[],K=0,Y={},n={},T=d=null,L=0,W=s.length;L<W;L++)Y[q=e[i=s[L]]]==null&&(Y[q]=++K),n[i]={old:q,new:Y[q]},l=Y[q]-i,T!=null&&l===d||(T&&y.push(T),S.push(i),d=l),T=i;for(T&&y.push(T),y.push(65535),S.push(65535),D=2*($=S.length),P=2*Math.pow(Math.log($)/Math.LN2,2),g=Math.log(P/2)/Math.LN2,C=2*$-P,c=[],J=[],f=[],w=O=0,se=S.length;O<se;w=++O){if(b=S[w],u=y[w],b===65535){c.push(0),J.push(0);break}if(b-(v=n[b].new)>=32768)for(c.push(0),J.push(2*(f.length+$-w)),i=ne=b;b<=u?ne<=u:ne>=u;i=b<=u?++ne:--ne)f.push(n[i].new);else c.push(v-b),J.push(0)}for(z.writeUInt16(3),z.writeUInt16(1),z.writeUInt32(12),z.writeUInt16(4),z.writeUInt16(16+8*$+2*f.length),z.writeUInt16(0),z.writeUInt16(D),z.writeUInt16(P),z.writeUInt16(g),z.writeUInt16(C),Z=0,F=y.length;Z<F;Z++)i=y[Z],z.writeUInt16(i);for(z.writeUInt16(0),H=0,k=S.length;H<k;H++)i=S[H],z.writeUInt16(i);for(M=0,N=c.length;M<N;M++)l=c[M],z.writeUInt16(l);for(G=0,A=J.length;G<A;G++)j=J[G],z.writeUInt16(j);for(Q=0,V=f.length;Q<V;Q++)E=f[Q],z.writeUInt16(E);return{charMap:n,subtable:z.data,maxGlyphID:K+1}}},t}(),D_=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ws(e,Qo),e.prototype.tag="cmap",e.prototype.parse=function(r){var n,i,o;for(r.pos=this.offset,this.version=r.readUInt16(),o=r.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=o?i<o:i>o;i=0<=o?++i:--i)n=new Tb(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},e.encode=function(r,n){var i,o;return n==null&&(n="macroman"),i=Tb.encode(r,n),(o=new Qa).writeUInt16(0),o.writeUInt16(1),i.table=o.data.concat(i.subtable),i},e}(),wR=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ws(e,Qo),e.prototype.tag="hhea",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},e}(),xR=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ws(e,Qo),e.prototype.tag="OS/2",e.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var n,i;for(i=[],n=0;n<10;++n)i.push(r.readByte());return i}(),this.charRange=function(){var n,i;for(i=[],n=0;n<4;++n)i.push(r.readInt());return i}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var n,i;for(i=[],n=0;n<2;n=++n)i.push(r.readInt());return i}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},e}(),CR=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ws(e,Qo),e.prototype.tag="post",e.prototype.parse=function(r){var n,i,o;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var s;for(i=r.readUInt16(),this.glyphNameIndex=[],s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],o=[];r.pos<this.offset+this.length;)n=r.readByte(),o.push(this.names.push(r.readString(n)));return o;case 151552:return i=r.readUInt16(),this.offsets=r.read(i);case 196608:break;case 262144:return this.map=function(){var l,c,d;for(d=[],s=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;s=0<=c?++l:--l)d.push(r.readUInt32());return d}.call(this)}},e}(),AR=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},$R=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ws(e,Qo),e.prototype.tag="name",e.prototype.parse=function(r){var n,i,o,s,l,c,d,u,y,g,f;for(r.pos=this.offset,r.readShort(),n=r.readShort(),c=r.readShort(),i=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)i.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+c+r.readShort()});for(d={},s=y=0,g=i.length;y<g;s=++y)o=i[s],r.pos=o.offset,u=r.readString(o.length),l=new AR(u,o),d[f=o.nameID]==null&&(d[f]=[]),d[o.nameID].push(l);this.strings=d,this.copyright=d[0],this.fontFamily=d[1],this.fontSubfamily=d[2],this.uniqueSubfamily=d[3],this.fontName=d[4],this.version=d[5];try{this.postscriptName=d[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=d[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=d[7],this.manufacturer=d[8],this.designer=d[9],this.description=d[10],this.vendorUrl=d[11],this.designerUrl=d[12],this.license=d[13],this.licenseUrl=d[14],this.preferredFamily=d[15],this.preferredSubfamily=d[17],this.compatibleFull=d[18],this.sampleText=d[19]},e}(),ER=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ws(e,Qo),e.prototype.tag="maxp",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},e}(),IR=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ws(e,Qo),e.prototype.tag="hmtx",e.prototype.parse=function(r){var n,i,o,s,l,c,d;for(r.pos=this.offset,this.metrics=[],n=0,c=this.file.hhea.numberOfMetrics;0<=c?n<c:n>c;n=0<=c?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(o=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,y;for(y=[],n=u=0;0<=o?u<o:u>o;n=0<=o?++u:--u)y.push(r.readInt16());return y}(),this.widths=function(){var u,y,g,f;for(f=[],u=0,y=(g=this.metrics).length;u<y;u++)s=g[u],f.push(s.advance);return f}.call(this),i=this.widths[this.widths.length-1],d=[],n=l=0;0<=o?l<o:l>o;n=0<=o?++l:--l)d.push(this.widths.push(i));return d},e.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},e}(),M_=[].slice,TR=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ws(e,Qo),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(r){var n,i,o,s,l,c,d,u,y,g;return r in this.cache?this.cache[r]:(s=this.file.loca,n=this.file.contents,i=s.indexOf(r),(o=s.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+i,l=(c=new Qa(n.read(o))).readShort(),u=c.readShort(),g=c.readShort(),d=c.readShort(),y=c.readShort(),this.cache[r]=l===-1?new NR(c,u,g,d,y):new kR(c,l,u,g,d,y),this.cache[r]))},e.prototype.encode=function(r,n,i){var o,s,l,c,d;for(l=[],s=[],c=0,d=n.length;c<d;c++)o=r[n[c]],s.push(l.length),o&&(l=l.concat(o.encode(i)));return s.push(l.length),{table:l,offsets:s}},e}(),kR=function(){function t(e,r,n,i,o,s){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=o,this.yMax=s,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),NR=function(){function t(e,r,n,i,o){var s,l;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;l=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&l;)s.pos+=1&l?4:2,128&l?s.pos+=8:64&l?s.pos+=4:8&l&&(s.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new Qa(M_.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t}(),LR=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ws(e,Qo),e.prototype.tag="loca",e.prototype.parse=function(r){var n,i;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?function(){var o,s;for(s=[],i=0,o=this.length;i<o;i+=2)s.push(2*r.readUInt16());return s}.call(this):function(){var o,s;for(s=[],i=0,o=this.length;i<o;i+=4)s.push(r.readUInt32());return s}.call(this)},e.prototype.indexOf=function(r){return this.offsets[r]},e.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},e.prototype.encode=function(r,n){for(var i=new Uint32Array(this.offsets.length),o=0,s=0,l=0;l<i.length;++l)if(i[l]=o,s<n.length&&n[s]==l){++s,i[l]=o;var c=this.offsets[l],d=this.offsets[l+1]-c;d>0&&(o+=d)}for(var u=new Array(4*i.length),y=0;y<i.length;++y)u[4*y+3]=255&i[y],u[4*y+2]=(65280&i[y])>>8,u[4*y+1]=(16711680&i[y])>>16,u[4*y]=(4278190080&i[y])>>24;return u},e}(),RR=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,i,o;for(r in i=this.font.cmap.tables[0].codeMap,e={},o=this.subset)n=o[r],e[r]=i[n];return e},t.prototype.glyphsFor=function(e){var r,n,i,o,s,l,c;for(i={},s=0,l=e.length;s<l;s++)i[o=e[s]]=this.font.glyf.glyphFor(o);for(o in r=[],i)(n=i[o])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(o in c=this.glyphsFor(r))n=c[o],i[o]=n;return i},t.prototype.encode=function(e,r){var n,i,o,s,l,c,d,u,y,g,f,w,E,x,T;for(i in n=D_.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),f={0:0},T=n.charMap)f[(c=T[i]).old]=c.new;for(w in g=n.maxGlyphID,s)w in f||(f[w]=g++);return u=function(Y){var K,j;for(K in j={},Y)j[Y[K]]=K;return j}(f),y=Object.keys(u).sort(function(Y,K){return Y-K}),E=function(){var Y,K,j;for(j=[],Y=0,K=y.length;Y<K;Y++)l=y[Y],j.push(u[l]);return j}(),o=this.font.glyf.encode(s,E,f),d=this.font.loca.encode(o.offsets,E),x={cmap:this.font.cmap.raw(),glyf:o.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(x["OS/2"]=this.font.os2.raw()),this.font.directory.encode(x)},t}();Er.API.PDFObject=function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,i,o,s;if(Array.isArray(r))return"["+function(){var l,c,d;for(d=[],l=0,c=r.length;l<c;l++)n=r[l],d.push(e.convert(n));return d}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in o=["<<"],r)s=r[i],o.push("/"+i+" "+e.convert(s));return o.push(">>"),o.join(`
`)}return""+r},e}();const F_=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:hR,AcroFormAppearance:fr,AcroFormButton:di,AcroFormCheckBox:Ld,AcroFormChoiceField:$l,AcroFormComboBox:Il,AcroFormEditBox:kd,AcroFormListBox:El,AcroFormPasswordField:Rd,AcroFormPushButton:Nd,AcroFormRadioButton:Tl,AcroFormTextField:za,GState:Qd,ShadingPattern:La,TilingPattern:xl,default:Er,jsPDF:Er},Symbol.toStringTag,{value:"Module"}));function O_(t,e,r,n,i){n=n||{};var o=1.15,s=i.internal.scaleFactor,l=i.internal.getFontSize()/s,c=i.getLineHeightFactor?i.getLineHeightFactor():o,d=l*c,u=/\r\n|\r|\n/g,y="",g=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(y=typeof t=="string"?t.split(u):t,g=y.length||1),r+=l*(2-o),n.valign==="middle"?r-=g/2*d:n.valign==="bottom"&&(r-=g*d),n.halign==="center"||n.halign==="right"){var f=l;if(n.halign==="center"&&(f*=.5),y&&g>=1){for(var w=0;w<y.length;w++)i.text(y[w],e-i.getStringUnitWidth(y[w])*f,r),r+=d;return i}e-=i.getStringUnitWidth(t)*f}return n.halign==="justify"?i.text(t,e,r,{maxWidth:n.maxWidth||100,align:"justify"}):i.text(t,e,r),i}var kb={},Cc=function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:kb=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var n,i,o;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var s=this.jsPDFDocument.internal.getFont(),l=s.fontStyle,c=s.fontName;if(e.font&&(c=e.font),e.fontStyle){l=e.fontStyle;var d=this.getFontList()[c];d&&d.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(d[0]),l=d[0])}if(this.jsPDFDocument.setFont(c,l),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var u=t.unifyColor(e.fillColor);u&&(n=this.jsPDFDocument).setFillColor.apply(n,u),u=t.unifyColor(e.textColor),u&&(i=this.jsPDFDocument).setTextColor.apply(i,u),u=t.unifyColor(e.lineColor),u&&(o=this.jsPDFDocument).setDrawColor.apply(o,u),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,n){return this.jsPDFDocument.splitTextToSize(e,r,n)},t.prototype.rect=function(e,r,n,i,o){return this.jsPDFDocument.rect(e,r,n,i,o)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return kb||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t}(),Jf=function(t,e){return Jf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},Jf(t,e)};function B_(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Jf(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var j_=function(t){B_(e,t);function e(r){var n=t.call(this)||this;return n._element=r,n}return e}(Array);function DR(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function MR(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function rp(t,e,r){r.applyStyles(e,!0);var n=Array.isArray(t)?t:[t],i=n.map(function(o){return r.getTextWidth(o)}).reduce(function(o,s){return Math.max(o,s)},0);return i}function V_(t,e,r,n){var i=e.settings.tableLineWidth,o=e.settings.tableLineColor;t.applyStyles({lineWidth:i,lineColor:o});var s=q_(i,!1);s&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),n.y-r.y,s)}function q_(t,e){var r=t>0,n=e||e===0;return r&&n?"DF":r?"S":n?"F":null}function Tp(t,e){var r,n,i,o;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(n=t.top)!==null&&n!==void 0?n:e,right:(i=t.right)!==null&&i!==void 0?i:e,bottom:(o=t.bottom)!==null&&o!==void 0?o:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function z_(t,e){var r=Tp(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function FR(t,e,r,n,i){var o={},s=1.3333333333333333,l=Um(e,function(K){return i.getComputedStyle(K).backgroundColor});l!=null&&(o.fillColor=l);var c=Um(e,function(K){return i.getComputedStyle(K).color});c!=null&&(o.textColor=c);var d=BR(n,r);d&&(o.cellPadding=d);var u="borderTopColor",y=s*r,g=n.borderTopWidth;if(n.borderBottomWidth===g&&n.borderRightWidth===g&&n.borderLeftWidth===g){var f=(parseFloat(g)||0)/y;f&&(o.lineWidth=f)}else o.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/y,right:(parseFloat(n.borderRightWidth)||0)/y,bottom:(parseFloat(n.borderBottomWidth)||0)/y,left:(parseFloat(n.borderLeftWidth)||0)/y},o.lineWidth.top||(o.lineWidth.right?u="borderRightColor":o.lineWidth.bottom?u="borderBottomColor":o.lineWidth.left&&(u="borderLeftColor"));var w=Um(e,function(K){return i.getComputedStyle(K)[u]});w!=null&&(o.lineColor=w);var E=["left","right","center","justify"];E.indexOf(n.textAlign)!==-1&&(o.halign=n.textAlign),E=["middle","bottom","top"],E.indexOf(n.verticalAlign)!==-1&&(o.valign=n.verticalAlign);var x=parseInt(n.fontSize||"");isNaN(x)||(o.fontSize=x/s);var T=OR(n);T&&(o.fontStyle=T);var Y=(n.fontFamily||"").toLowerCase();return t.indexOf(Y)!==-1&&(o.font=Y),o}function OR(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function Um(t,e){var r=U_(t,e);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var i=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],o=parseInt(n[4]);return o===0||isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function U_(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:U_(t.parentElement,e):r}function BR(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],n=96/(72/e),i=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,o=r.map(function(l){return parseInt(l||"0")/n}),s=Tp(o,0);return i>s.top&&(s.top=i),i>s.bottom&&(s.bottom=i),s}function H_(t,e,r,n,i){var o,s;n===void 0&&(n=!1),i===void 0&&(i=!1);var l;typeof e=="string"?l=r.document.querySelector(e):l=e;var c=Object.keys(t.getFontList()),d=t.scaleFactor(),u=[],y=[],g=[];if(!l)return console.error("Html table could not be found with input: ",e),{head:u,body:y,foot:g};for(var f=0;f<l.rows.length;f++){var w=l.rows[f],E=(s=(o=w?.parentElement)===null||o===void 0?void 0:o.tagName)===null||s===void 0?void 0:s.toLowerCase(),x=jR(c,d,r,w,n,i);x&&(E==="thead"?u.push(x):E==="tfoot"?g.push(x):y.push(x))}return{head:u,body:y,foot:g}}function jR(t,e,r,n,i,o){for(var s=new j_(n),l=0;l<n.cells.length;l++){var c=n.cells[l],d=r.getComputedStyle(c);if(i||d.display!=="none"){var u=void 0;o&&(u=FR(t,c,e,d,r)),s.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:u,_element:c,content:VR(c)})}}var y=r.getComputedStyle(n);if(s.length>0&&(i||y.display!=="none"))return s}function VR(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function qR(t,e,r){for(var n=0,i=[t,e,r];n<i.length;n++){var o=i[n];o&&typeof o!="object"&&console.error("The options parameter should be of type object, is: "+typeof o),o.startY&&typeof o.startY!="number"&&(console.error("Invalid value for startY option",o.startY),delete o.startY)}}function Us(t,e,r,n,i){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(t),s=1;s<arguments.length;s++){var l=arguments[s];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(o[c]=l[c])}return o}function G_(t,e){var r=new Cc(t),n=r.getDocumentOptions(),i=r.getGlobalOptions();qR(i,n,e);var o=Us({},i,n,e),s;typeof window<"u"&&(s=window);var l=zR(i,n,e),c=UR(i,n,e),d=HR(r,o),u=WR(r,o,s);return{id:e.tableId,content:u,hooks:c,styles:l,settings:d}}function zR(t,e,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},i=function(c){if(c==="columnStyles"){var d=t[c],u=e[c],y=r[c];n.columnStyles=Us({},d,u,y)}else{var g=[t,e,r],f=g.map(function(w){return w[c]||{}});n[c]=Us({},f[0],f[1],f[2])}},o=0,s=Object.keys(n);o<s.length;o++){var l=s[o];i(l)}return n}function UR(t,e,r){for(var n=[t,e,r],i={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},o=0,s=n;o<s.length;o++){var l=s[o];l.didParseCell&&i.didParseCell.push(l.didParseCell),l.willDrawCell&&i.willDrawCell.push(l.willDrawCell),l.didDrawCell&&i.didDrawCell.push(l.didDrawCell),l.willDrawPage&&i.willDrawPage.push(l.willDrawPage),l.didDrawPage&&i.didDrawPage.push(l.didDrawPage)}return i}function HR(t,e){var r,n,i,o,s,l,c,d,u,y,g,f,w=Tp(e.margin,40/t.scaleFactor()),E=(r=GR(t,e.startY))!==null&&r!==void 0?r:w.top,x;e.showFoot===!0?x="everyPage":e.showFoot===!1?x="never":x=(n=e.showFoot)!==null&&n!==void 0?n:"everyPage";var T;e.showHead===!0?T="everyPage":e.showHead===!1?T="never":T=(i=e.showHead)!==null&&i!==void 0?i:"everyPage";var Y=(o=e.useCss)!==null&&o!==void 0?o:!1,K=e.theme||(Y?"plain":"striped"),j=!!e.horizontalPageBreak,q=(s=e.horizontalPageBreakRepeat)!==null&&s!==void 0?s:null;return{includeHiddenHtml:(l=e.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:Y,theme:K,startY:E,margin:w,pageBreak:(c=e.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(d=e.rowPageBreak)!==null&&d!==void 0?d:"auto",tableWidth:(u=e.tableWidth)!==null&&u!==void 0?u:"auto",showHead:T,showFoot:x,tableLineWidth:(y=e.tableLineWidth)!==null&&y!==void 0?y:0,tableLineColor:(g=e.tableLineColor)!==null&&g!==void 0?g:200,horizontalPageBreak:j,horizontalPageBreakRepeat:q,horizontalPageBreakBehaviour:(f=e.horizontalPageBreakBehaviour)!==null&&f!==void 0?f:"afterAllRows"}}function GR(t,e){var r=t.getLastAutoTable(),n=t.scaleFactor(),i=t.pageNumber(),o=!1;if(r&&r.startPageNumber){var s=r.startPageNumber+r.pageNumber-1;o=s===i}return typeof e=="number"?e:(e==null||e===!1)&&o&&r?.finalY!=null?r.finalY+20/n:null}function WR(t,e,r){var n=e.head||[],i=e.body||[],o=e.foot||[];if(e.html){var s=e.includeHiddenHtml;if(r){var l=H_(t,e.html,r,s,e.useCss)||{};n=l.head||n,i=l.body||n,o=l.foot||n}else console.error("Cannot parse html in non browser environment")}var c=e.columns||YR(n,i,o);return{columns:c,head:n,body:i,foot:o}}function YR(t,e,r){var n=t[0]||e[0]||r[0]||[],i=[];return Object.keys(n).filter(function(o){return o!=="_element"}).forEach(function(o){var s=1,l;Array.isArray(n)?l=n[parseInt(o)]:l=n[o],typeof l=="object"&&!Array.isArray(l)&&(s=l?.colSpan||1);for(var c=0;c<s;c++){var d=void 0;Array.isArray(n)?d=i.length:d=o+(c>0?"_".concat(c):"");var u={dataKey:d};i.push(u)}}),i}var Qf=function(){function t(e,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=e.getDocument()}return t}(),KR=function(t){B_(e,t);function e(r,n,i,o,s,l){var c=t.call(this,r,n,l)||this;return c.cell=i,c.row=o,c.column=s,c.section=o.section,c}return e}(Qf),JR=function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,n,i,o,s){for(var l=0,c=r;l<c.length;l++){var d=c[l],u=new KR(e,this,n,i,o,s),y=d(u)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],y)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var n=0,i=this.hooks.didDrawPage;n<i.length;n++){var o=i[n];o(new Qf(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var n=0,i=this.hooks.willDrawPage;n<i.length;n++){var o=i[n];o(new Qf(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(i,o){return i+o.wrappedWidth},0);return r}else{var n=this.settings.margin;return e-n.left-n.right}},t}(),W_=function(){function t(e,r,n,i,o){o===void 0&&(o=!1),this.height=0,this.raw=e,e instanceof j_&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=n,this.cells=i,this.spansMultiplePages=o}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(n,i){var o;return Math.max(n,((o=r.cells[i.index])===null||o===void 0?void 0:o.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(n){var i=r.cells[n.index];return i?i.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var n=this;return e.reduce(function(i,o){var s=n.cells[o.index];if(!s)return 0;var l=r.getLineHeight(s.styles.fontSize),c=s.padding("vertical"),d=c+l;return d>i?d:i},0)},t}(),Y_=function(){function t(e,r,n){var i;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=e;var o=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,o=(i=e.content)!==null&&i!==void 0?i:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var s=o!=null?""+o:"",l=/\r\n|\r|\n/g;this.text=s.split(l)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var i=this.width-this.padding("horizontal");n=this.x+i/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,i=this.styles.fontSize/e*r,o=n*i+this.padding("vertical");return Math.max(o,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=Tp(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t}(),QR=function(){function t(e,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=n}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,n=0,i=e.allRows();n<i.length;n++){var o=i[n],s=o.cells[this.index];s&&typeof s.styles.cellWidth=="number"&&(r=Math.max(r,s.styles.cellWidth))}return r},t}();function XR(t,e){ZR(t,e);var r=[],n=0;e.columns.forEach(function(o){var s=o.getMaxCustomCellWidth(e);s?o.width=s:(o.width=o.wrappedWidth,r.push(o)),n+=o.width});var i=e.getWidth(t.pageSize().width)-n;i&&(i=Xf(r,i,function(o){return Math.max(o.minReadableWidth,o.minWidth)})),i&&(i=Xf(r,i,function(o){return o.minWidth})),i=Math.abs(i),!e.settings.horizontalPageBreak&&i>.1/t.scaleFactor()&&(i=i<1?i:Math.round(i),console.warn("Of the table content, ".concat(i," units width could not fit page"))),tD(e),rD(e,t),eD(e)}function ZR(t,e){var r=t.scaleFactor(),n=e.settings.horizontalPageBreak,i=z_(t,e);e.allRows().forEach(function(o){for(var s=0,l=e.columns;s<l.length;s++){var c=l[s],d=o.cells[c.index];if(d){var u=e.hooks.didParseCell;e.callCellHooks(t,u,d,o,c,null);var y=d.padding("horizontal");d.contentWidth=rp(d.text,d.styles,t)+y;var g=rp(d.text.join(" ").split(/[^\S\u00A0]+/),d.styles,t);if(d.minReadableWidth=g+d.padding("horizontal"),typeof d.styles.cellWidth=="number")d.minWidth=d.styles.cellWidth,d.wrappedWidth=d.styles.cellWidth;else if(d.styles.cellWidth==="wrap"||n===!0)d.contentWidth>i?(d.minWidth=i,d.wrappedWidth=i):(d.minWidth=d.contentWidth,d.wrappedWidth=d.contentWidth);else{var f=10/r;d.minWidth=d.styles.minCellWidth||f,d.wrappedWidth=d.contentWidth,d.minWidth>d.wrappedWidth&&(d.wrappedWidth=d.minWidth)}}}}),e.allRows().forEach(function(o){for(var s=0,l=e.columns;s<l.length;s++){var c=l[s],d=o.cells[c.index];if(d&&d.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,d.wrappedWidth),c.minWidth=Math.max(c.minWidth,d.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,d.minReadableWidth);else{var u=e.styles.columnStyles[c.dataKey]||e.styles.columnStyles[c.index]||{},y=u.cellWidth||u.minCellWidth;y&&typeof y=="number"&&(c.minWidth=y,c.wrappedWidth=y)}d&&(d.colSpan>1&&!c.minWidth&&(c.minWidth=d.minWidth),d.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=d.minWidth))}})}function Xf(t,e,r){for(var n=e,i=t.reduce(function(f,w){return f+w.wrappedWidth},0),o=0;o<t.length;o++){var s=t[o],l=s.wrappedWidth/i,c=n*l,d=s.width+c,u=r(s),y=d<u?u:d;e-=y-s.width,s.width=y}if(e=Math.round(e*1e10)/1e10,e){var g=t.filter(function(f){return e<0?f.width>r(f):!0});g.length&&(e=Xf(g,e,r))}return e}function eD(t){for(var e={},r=1,n=t.allRows(),i=0;i<n.length;i++)for(var o=n[i],s=0,l=t.columns;s<l.length;s++){var c=l[s],d=e[c.index];if(r>1)r--,delete o.cells[c.index];else if(d)d.cell.height+=o.height,r=d.cell.colSpan,delete o.cells[c.index],d.left--,d.left<=1&&delete e[c.index];else{var u=o.cells[c.index];if(!u)continue;if(u.height=o.height,u.rowSpan>1){var y=n.length-i,g=u.rowSpan>y?y:u.rowSpan;e[c.index]={cell:u,left:g,row:o}}}}}function tD(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var n=e[r],i=null,o=0,s=0,l=0;l<t.columns.length;l++){var c=t.columns[l];if(s-=1,s>1&&t.columns[l+1])o+=c.width,delete n.cells[c.index];else if(i){var d=i;delete n.cells[c.index],i=null,d.width=c.width+o}else{var d=n.cells[c.index];if(!d)continue;if(s=d.colSpan,o=0,d.colSpan>1){i=d,o+=c.width;continue}d.width=c.width+o}}}function rD(t,e){for(var r={count:0,height:0},n=0,i=t.allRows();n<i.length;n++){for(var o=i[n],s=0,l=t.columns;s<l.length;s++){var c=l[s],d=o.cells[c.index];if(d){e.applyStyles(d.styles,!0);var u=d.width-d.padding("horizontal");if(d.styles.overflow==="linebreak")d.text=e.splitTextToSize(d.text,u+1/e.scaleFactor(),{fontSize:d.styles.fontSize});else if(d.styles.overflow==="ellipsize")d.text=Nb(d.text,u,d.styles,e,"...");else if(d.styles.overflow==="hidden")d.text=Nb(d.text,u,d.styles,e,"");else if(typeof d.styles.overflow=="function"){var y=d.styles.overflow(d.text,u);typeof y=="string"?d.text=[y]:d.text=y}d.contentHeight=d.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var g=d.contentHeight/d.rowSpan;d.rowSpan>1&&r.count*r.height<g*d.rowSpan?r={height:g,count:d.rowSpan}:r&&r.count>0&&r.height>g&&(g=r.height),g>o.height&&(o.height=g)}}r.count--}}function Nb(t,e,r,n,i){return t.map(function(o){return nD(o,e,r,n,i)})}function nD(t,e,r,n,i){var o=1e4*n.scaleFactor();if(e=Math.ceil(e*o)/o,e>=rp(t,r,n))return t;for(;e<rp(t+i,r,n)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+i}function K_(t,e){var r=new Cc(t),n=iD(e,r.scaleFactor()),i=new JR(e,n);return XR(r,i),r.applyStyles(r.userStyles),i}function iD(t,e){var r=t.content,n=sD(r.columns);if(r.head.length===0){var i=Lb(n,"head");i&&r.head.push(i)}if(r.foot.length===0){var i=Lb(n,"foot");i&&r.foot.push(i)}var o=t.settings.theme,s=t.styles;return{columns:n,head:Hm("head",r.head,n,s,o,e),body:Hm("body",r.body,n,s,o,e),foot:Hm("foot",r.foot,n,s,o,e)}}function Hm(t,e,r,n,i,o){var s={},l=e.map(function(c,d){for(var u=0,y={},g=0,f=0,w=0,E=r;w<E.length;w++){var x=E[w];if(s[x.index]==null||s[x.index].left===0)if(f===0){var T=void 0;Array.isArray(c)?T=c[x.index-g-u]:T=c[x.dataKey];var Y={};typeof T=="object"&&!Array.isArray(T)&&(Y=T?.styles||{});var K=aD(t,x,d,i,n,o,Y),j=new Y_(T,K,t);y[x.dataKey]=j,y[x.index]=j,f=j.colSpan-1,s[x.index]={left:j.rowSpan-1,times:f}}else f--,g++;else s[x.index].left--,f=s[x.index].times,u++}return new W_(c,d,t,y)});return l}function Lb(t,e){var r={};return t.forEach(function(n){if(n.raw!=null){var i=oD(e,n.raw);i!=null&&(r[n.dataKey]=i)}}),Object.keys(r).length>0?r:null}function oD(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function sD(t){return t.map(function(e,r){var n,i;return typeof e=="object"?i=(n=e.dataKey)!==null&&n!==void 0?n:r:i=r,new QR(i,e,r)})}function aD(t,e,r,n,i,o,s){var l=MR(n),c;t==="head"?c=i.headStyles:t==="body"?c=i.bodyStyles:t==="foot"&&(c=i.footStyles);var d=Us({},l.table,l[t],i.styles,c),u=i.columnStyles[e.dataKey]||i.columnStyles[e.index]||{},y=t==="body"?u:{},g=t==="body"&&r%2===0?Us({},l.alternateRow,i.alternateRowStyles):{},f=DR(o),w=Us({},f,d,g,y);return Us(w,s)}function lD(t,e,r){var n;r===void 0&&(r={});var i=z_(t,e),o=new Map,s=[],l=[],c=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?c=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(c=[e.settings.horizontalPageBreakRepeat]),c.forEach(function(g){var f=e.columns.find(function(w){return w.dataKey===g||w.index===g});f&&!o.has(f.index)&&(o.set(f.index,!0),s.push(f.index),l.push(e.columns[f.index]),i-=f.wrappedWidth)});for(var d=!0,u=(n=r?.start)!==null&&n!==void 0?n:0;u<e.columns.length;){if(o.has(u)){u++;continue}var y=e.columns[u].wrappedWidth;if(d||i>=y)d=!1,s.push(u),l.push(e.columns[u]),i-=y;else break;u++}return{colIndexes:s,columns:l,lastIndex:u-1}}function cD(t,e){for(var r=[],n=0;n<e.columns.length;n++){var i=lD(t,e,{start:n});i.columns.length&&(r.push(i),n=i.lastIndex)}return r}function J_(t,e){var r=e.settings,n=r.startY,i=r.margin,o={x:i.left,y:n},s=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),l=n+i.bottom+s;if(r.pageBreak==="avoid"){var c=e.body,d=c.reduce(function(g,f){return g+f.height},0);l+=d}var u=new Cc(t);(r.pageBreak==="always"||r.startY!=null&&l>u.pageSize().height)&&(X_(u),o.y=i.top),e.callWillDrawPageHooks(u,o);var y=Us({},o);e.startPageNumber=u.pageNumber(),r.horizontalPageBreak?dD(u,e,y,o):(u.applyStyles(u.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(g){return Zs(u,e,g,o,e.columns)}),u.applyStyles(u.userStyles),e.body.forEach(function(g,f){var w=f===e.body.length-1;np(u,e,g,w,y,o,e.columns)}),u.applyStyles(u.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(g){return Zs(u,e,g,o,e.columns)})),V_(u,e,y,o),e.callEndPageHooks(u,o),e.finalY=o.y,t.lastAutoTable=e,u.applyStyles(u.userStyles)}function dD(t,e,r,n){var i=cD(t,e),o=e.settings;if(o.horizontalPageBreakBehaviour==="afterAllRows")i.forEach(function(d,u){t.applyStyles(t.userStyles),u>0?Dd(t,e,r,n,d.columns,!0):Rb(t,e,n,d.columns),uD(t,e,r,n,d.columns),Gm(t,e,n,d.columns)});else for(var s=-1,l=i[0],c=function(){var d=s;if(l){t.applyStyles(t.userStyles);var u=l.columns;s>=0?Dd(t,e,r,n,u,!0):Rb(t,e,n,u),d=Db(t,e,s+1,n,u),Gm(t,e,n,u)}var y=d-s;i.slice(1).forEach(function(g){t.applyStyles(t.userStyles),Dd(t,e,r,n,g.columns,!0),Db(t,e,s+1,n,g.columns,y),Gm(t,e,n,g.columns)}),s=d};s<e.body.length-1;)c()}function Rb(t,e,r,n){var i=e.settings;t.applyStyles(t.userStyles),(i.showHead==="firstPage"||i.showHead==="everyPage")&&e.head.forEach(function(o){return Zs(t,e,o,r,n)})}function uD(t,e,r,n,i){t.applyStyles(t.userStyles),e.body.forEach(function(o,s){var l=s===e.body.length-1;np(t,e,o,l,r,n,i)})}function Db(t,e,r,n,i,o){t.applyStyles(t.userStyles),o=o??e.body.length;var s=Math.min(r+o,e.body.length),l=-1;return e.body.slice(r,s).forEach(function(c,d){var u=r+d===e.body.length-1,y=Q_(t,e,u,n);c.canEntireRowFit(y,i)&&(Zs(t,e,c,n,i),l=r+d)}),l}function Gm(t,e,r,n){var i=e.settings;t.applyStyles(t.userStyles),(i.showFoot==="lastPage"||i.showFoot==="everyPage")&&e.foot.forEach(function(o){return Zs(t,e,o,r,n)})}function hD(t,e,r){var n=r.getLineHeight(t.styles.fontSize),i=t.padding("vertical"),o=Math.floor((e-i)/n);return Math.max(0,o)}function pD(t,e,r,n){var i={};t.spansMultiplePages=!0,t.height=0;for(var o=0,s=0,l=r.columns;s<l.length;s++){var c=l[s],d=t.cells[c.index];if(d){Array.isArray(d.text)||(d.text=[d.text]);var u=new Y_(d.raw,d.styles,d.section);u=Us(u,d),u.text=[];var y=hD(d,e,n);d.text.length>y&&(u.text=d.text.splice(y,d.text.length));var g=n.scaleFactor(),f=n.getLineHeightFactor();d.contentHeight=d.getContentHeight(g,f),d.contentHeight>=e&&(d.contentHeight=e,u.styles.minCellHeight-=e),d.contentHeight>t.height&&(t.height=d.contentHeight),u.contentHeight=u.getContentHeight(g,f),u.contentHeight>o&&(o=u.contentHeight),i[c.index]=u}}var w=new W_(t.raw,-1,t.section,i,!0);w.height=o;for(var E=0,x=r.columns;E<x.length;E++){var c=x[E],u=w.cells[c.index];u&&(u.height=w.height);var d=t.cells[c.index];d&&(d.height=t.height)}return w}function mD(t,e,r,n){var i=t.pageSize().height,o=n.settings.margin,s=o.top+o.bottom,l=i-s;e.section==="body"&&(l-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=e.getMinimumRowHeight(n.columns,t),d=c<r;if(c>l)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!d)return!1;var u=e.hasRowSpan(n.columns),y=e.getMaxCellHeight(n.columns)>l;return y?(u&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(u||n.settings.rowPageBreak==="avoid")}function np(t,e,r,n,i,o,s){var l=Q_(t,e,n,o);if(r.canEntireRowFit(l,s))Zs(t,e,r,o,s);else if(mD(t,r,l,e)){var c=pD(r,l,e,t);Zs(t,e,r,o,s),Dd(t,e,i,o,s),np(t,e,c,n,i,o,s)}else Dd(t,e,i,o,s),np(t,e,r,n,i,o,s)}function Zs(t,e,r,n,i){n.x=e.settings.margin.left;for(var o=0,s=i;o<s.length;o++){var l=s[o],c=r.cells[l.index];if(!c){n.x+=l.width;continue}t.applyStyles(c.styles),c.x=n.x,c.y=n.y;var d=e.callCellHooks(t,e.hooks.willDrawCell,c,r,l,n);if(d===!1){n.x+=l.width;continue}fD(t,c,n);var u=c.getTextPos();O_(c.text,u.x,u.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,c,r,l,n),n.x+=l.width}n.y+=r.height}function fD(t,e,r){var n=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof n.lineWidth=="number"){var i=q_(n.lineWidth,n.fillColor);i&&t.rect(e.x,r.y,e.width,e.height,i)}else typeof n.lineWidth=="object"&&(n.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),yD(t,e,r,n.lineWidth))}function yD(t,e,r,n){var i,o,s,l;n.top&&(i=r.x,o=r.y,s=r.x+e.width,l=r.y,n.right&&(s+=.5*n.right),n.left&&(i-=.5*n.left),c(n.top,i,o,s,l)),n.bottom&&(i=r.x,o=r.y+e.height,s=r.x+e.width,l=r.y+e.height,n.right&&(s+=.5*n.right),n.left&&(i-=.5*n.left),c(n.bottom,i,o,s,l)),n.left&&(i=r.x,o=r.y,s=r.x,l=r.y+e.height,n.top&&(o-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.left,i,o,s,l)),n.right&&(i=r.x+e.width,o=r.y,s=r.x+e.width,l=r.y+e.height,n.top&&(o-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.right,i,o,s,l));function c(d,u,y,g,f){t.getDocument().setLineWidth(d),t.getDocument().line(u,y,g,f,"S")}}function Q_(t,e,r,n){var i=e.settings.margin.bottom,o=e.settings.showFoot;return(o==="everyPage"||o==="lastPage"&&r)&&(i+=e.getFootHeight(e.columns)),t.pageSize().height-n.y-i}function Dd(t,e,r,n,i,o){i===void 0&&(i=[]),o===void 0&&(o=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!o&&e.foot.forEach(function(l){return Zs(t,e,l,n,i)}),e.callEndPageHooks(t,n);var s=e.settings.margin;V_(t,e,r,n),X_(t),e.pageNumber++,n.x=s.left,n.y=s.top,r.y=s.top,e.callWillDrawPageHooks(t,n),e.settings.showHead==="everyPage"&&(e.head.forEach(function(l){return Zs(t,e,l,n,i)}),t.applyStyles(t.userStyles))}function X_(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function gD(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e[0],i=G_(this,n),o=K_(this,i);return J_(this,o),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,n,i){O_(e,r,n,i,this)},t.API.autoTableSetDefaults=function(e){return Cc.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){Cc.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var i=new Cc(this),o=H_(i,e,window,r,!1),s=o.head,l=o.body,c=((n=s[0])===null||n===void 0?void 0:n.map(function(d){return d.content}))||[];return{columns:c,rows:l,data:l}}}var Wm;function I9(t,e){var r=G_(t,e),n=K_(t,r);J_(t,n)}try{if(typeof window<"u"&&window){var Mb=window,Fb=Mb.jsPDF||((Wm=Mb.jspdf)===null||Wm===void 0?void 0:Wm.jsPDF);Fb&&gD(Fb)}}catch(t){console.error("Could not apply autoTable plugin",t)}var vD=ae("<div><div><label></label><select><option value=all></option></select></div><div><label></label><select><option value=all></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label></div><div><label>"),bD=ae("<div><div><div></div></div><div><div> <!> <!> <!> </div><div>"),_D=ae("<div><div>"),ah=ae("<option>"),PD=ae("<div><div><div><div></div><div></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div></div><div><div></div><div></div></div></div><div><div><span>: </span><span></span></div><div><span>: </span><span></span></div><div><span>: </span><span></span></div><div><span>: </span><span> kg</span></div><div><span>: </span><span></span></div><div><span>: </span><span>");const SD=t=>{const{t:e}=_r(),[r,n]=we(""),[i,o]=we("all"),[s,l]=we({start:"",end:""}),[c,d]=we(""),[u,y]=we(""),[g,f]=we(!1),[w,E]=we("all"),x=Ut(()=>{let b=t.hbls;var S="";if(r()&&(S+=r().toLowerCase()),r()){const v=r().toLowerCase();b=b.filter(z=>z.hbl.toLowerCase().includes(v)||z.idairguide.toLowerCase().includes(v)||z.nameshipper.toLowerCase().includes(v)||z.consigneeName.toLowerCase().includes(v)||z.namegood.toLowerCase().includes(v)||z.bagnumber.toLowerCase().includes(v)||z.cidentity.toLowerCase().includes(v))}return i()!=="all"&&(b=b.filter(v=>v.idguidestate===i())),w()!=="all"&&(b=b.filter(v=>v.idclasification===w())),(s().start||s().end)&&(b=b.filter(v=>{const z=new Date(v.datereserve),re=s().start?new Date(s().start):new Date("1900-01-01"),L=s().end?new Date(s().end):new Date("2100-12-31");return z>=re&&z<=L})),c()&&(b=b?.filter(v=>v.nameshipper.toLowerCase().includes(c().toLowerCase()))),u()&&(b=b?.filter(v=>v.consigneeName.toLowerCase().includes(u().toLowerCase()))),b=b?.sort((v,z)=>new Date(z.datereserve).getTime()-new Date(v.datereserve).getTime()),t.onFilterChange?.(b),b}),T=Ut(()=>{const b=new Set(t.hbls.map(S=>S.nameshipper));return Array.from(b).sort()}),Y=Ut(()=>{const b=new Set(t.hbls.map(S=>S.consigneeName));return Array.from(b).sort()}),K=Ut(()=>{const b=new Set(t.hbls.map(S=>S.idguidestate));return Array.from(b).sort()}),j=Ut(()=>{const b=new Set(t.hbls.map(S=>S.idclasification));return Array.from(b).sort()}),q=()=>{n(""),o("all"),l({start:"",end:""}),d(""),y(""),E("all")},J=()=>{const b=["HBL Number","Air Guide","Status","Classification","Shipper","Consignee","Identity","Phone","City","Commodity","Weight (kg)","Quantity","Bag Number","Reserve Date"],S=x().map(O=>[O.hbl,O.idairguide,O.idguidestate,O.idclasification,O.nameshipper,O.consigneeName,O.cidentity,O.phoneshipper,O.address.city,O.namegood,O.weight,O.quantity,O.bagnumber,new Date(O.datereserve).toLocaleDateString()]),v=[b.join(","),...S.map(O=>O.map(ne=>`"${ne}"`).join(","))].join(`
`),z=new Blob([v],{type:"text/csv"}),re=URL.createObjectURL(z),L=document.createElement("a");L.href=re,L.download=`HBL_List_${new Date().toISOString().split("T")[0]}.csv`,L.click(),URL.revokeObjectURL(re)},C=()=>{const b=["HBL Number","Air Guide","Air Number","Status","Classification","Shipper","Consignee","Identity","Shipper Phone","Consignee Phone","Street","City","State","Commodity","Weight (kg)","Quantity","Bag Number","Agency","Guide","Reserve Date"];x().map(O=>[O.hbl,O.idairguide,O.idairnumber,O.idguidestate,O.idclasification,O.nameshipper,O.consigneeName,O.cidentity,O.phoneshipper,O.ctelephone,O.street,O.address.city,O.address.estate,O.namegood,O.weight,O.quantity,O.bagnumber,O.agency,O.guia,new Date(O.datereserve).toLocaleDateString()]);const S=x().map(O=>[O.hbl,O.idclasification,O.idairguide,O.idairnumber,O.idguidestate,O.nameshipper,O.consigneeName,O.cidentity,O.phoneshipper,O.ctelephone,O.street,O.address.city,O.address.estate,O.namegood,O.weight,O.quantity,O.bagnumber,O.agency,O.guia,new Date(O.datereserve).toLocaleDateString()]),v=[b.join("	"),...S.map(O=>O.join("	"))].join(`
`),z=new Blob([v],{type:"application/vnd.ms-excel"}),re=URL.createObjectURL(z),L=document.createElement("a");L.href=re,L.download=`HBL_List_${new Date().toISOString().split("T")[0]}.xls`,L.click(),URL.revokeObjectURL(re)},P=()=>{const b=new Er;b.setFontSize(16),b.text("House Bill of Lading List",14,15),b.setFontSize(10),b.text(`Generated: ${new Date().toLocaleString()}`,14,25),b.setFontSize(10);let S=35;r()&&(b.text(`Search: ${r()}`,14,S),S+=5),i()!=="all"&&(b.text(`Status: ${i()}`,14,S),S+=5);const v=["HBL#","Status","Shipper","Consignee","City","Weight","Commodity"],z=x().map(re=>[re.hbl,re.idguidestate,re.nameshipper.substring(0,20)+(re.nameshipper.length>20?"...":""),re.consigneeName.substring(0,20)+(re.consigneeName.length>20?"...":""),re.address.city,re.weight+" kg",re.namegood.substring(0,15)+(re.namegood.length>15?"...":"")]);b.autoTable({head:[v],body:z,startY:S+5,styles:{fontSize:8},headStyles:{fillColor:[0,123,255]}}),b.save(`HBL_List_${new Date().toISOString().split("T")[0]}.pdf`)},$=b=>b?new Date(b).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-",D=b=>({"EN BODEGA":"#17a2b8",ENVIADO:"#007bff",ENTREGADO:"#28a745",CANCELADO:"#dc3545",PENDIENTE:"#ffc107"})[b]||"#6c757d";return(()=>{var b=_D(),S=b.firstChild;return a(b,I(Gt,{get children(){var v=bD(),z=v.firstChild,re=z.firstChild,L=z.nextSibling,O=L.firstChild,ne=O.firstChild,X=ne.nextSibling,W=X.nextSibling,se=W.nextSibling,F=se.nextSibling,k=F.nextSibling;k.nextSibling;var N=O.nextSibling;return v.style.setProperty("padding","1rem"),z.style.setProperty("display","grid"),z.style.setProperty("grid-template-columns","1fr auto"),z.style.setProperty("gap","1rem"),z.style.setProperty("margin-bottom","1rem"),a(z,I(Mr,{type:"text",get placeholder(){return e("hbl.searchPlaceholder","Search by HBL#, air guide, shipper, consignee, commodity, bag#, identity...")},get value(){return r()},onInput:A=>n(A.currentTarget.value)}),re),re.style.setProperty("display","flex"),re.style.setProperty("gap","0.5rem"),a(re,I(_t,{variant:"outline",size:"sm",onClick:()=>f(!g()),get children(){return Te(()=>!!g())()?e("common.hideFilters","Hide Filters"):e("common.showFilters","Show Filters")}}),null),a(re,I(_t,{variant:"outline",size:"sm",onClick:q,get children(){return e("common.clearFilters","Clear Filters")}}),null),a(v,I(Oe,{get when(){return g()},get children(){var A=vD(),V=A.firstChild,Z=V.firstChild,H=Z.nextSibling,B=H.firstChild,M=V.nextSibling,G=M.firstChild,Q=G.nextSibling,ie=Q.firstChild,me=M.nextSibling,oe=me.firstChild,ee=oe.nextSibling,de=ee.firstChild,he=me.nextSibling,le=he.firstChild,ye=le.nextSibling,ve=ye.firstChild,pe=he.nextSibling,ge=pe.firstChild,ke=pe.nextSibling,Ne=ke.firstChild;return A.style.setProperty("display","grid"),A.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),A.style.setProperty("gap","1rem"),A.style.setProperty("margin-bottom","1rem"),A.style.setProperty("padding","1rem"),A.style.setProperty("background","var(--background-color)"),A.style.setProperty("border-radius","var(--border-radius-sm)"),Z.style.setProperty("display","block"),Z.style.setProperty("margin-bottom","0.25rem"),Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-muted)"),a(Z,()=>e("common.status","Status")),H.addEventListener("change",xe=>o(xe.currentTarget.value)),H.style.setProperty("width","100%"),H.style.setProperty("padding","0.5rem"),H.style.setProperty("border","1px solid var(--border-color)"),H.style.setProperty("border-radius","var(--border-radius-sm)"),H.style.setProperty("background","var(--surface-color)"),a(B,()=>e("common.all","All")),a(H,I(Ct,{get each(){return K()},children:xe=>(()=>{var $e=ah();return $e.value=xe,a($e,xe),$e})()}),null),G.style.setProperty("display","block"),G.style.setProperty("margin-bottom","0.25rem"),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-muted)"),a(G,()=>e("hbl.classification","Classification")),Q.addEventListener("change",xe=>E(xe.currentTarget.value)),Q.style.setProperty("width","100%"),Q.style.setProperty("padding","0.5rem"),Q.style.setProperty("border","1px solid var(--border-color)"),Q.style.setProperty("border-radius","var(--border-radius-sm)"),Q.style.setProperty("background","var(--surface-color)"),a(ie,()=>e("common.all","All")),a(Q,I(Ct,{get each(){return j()},children:xe=>(()=>{var $e=ah();return $e.value=xe,a($e,xe),$e})()}),null),oe.style.setProperty("display","block"),oe.style.setProperty("margin-bottom","0.25rem"),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),a(oe,()=>e("hbl.shipper","Shipper")),ee.addEventListener("change",xe=>d(xe.currentTarget.value)),ee.style.setProperty("width","100%"),ee.style.setProperty("padding","0.5rem"),ee.style.setProperty("border","1px solid var(--border-color)"),ee.style.setProperty("border-radius","var(--border-radius-sm)"),ee.style.setProperty("background","var(--surface-color)"),a(de,()=>e("common.all","All")),a(ee,I(Ct,{get each(){return T()},children:xe=>(()=>{var $e=ah();return $e.value=xe,a($e,xe),$e})()}),null),le.style.setProperty("display","block"),le.style.setProperty("margin-bottom","0.25rem"),le.style.setProperty("font-size","0.875rem"),le.style.setProperty("color","var(--text-muted)"),a(le,()=>e("hbl.consignee","Consignee")),ye.addEventListener("change",xe=>y(xe.currentTarget.value)),ye.style.setProperty("width","100%"),ye.style.setProperty("padding","0.5rem"),ye.style.setProperty("border","1px solid var(--border-color)"),ye.style.setProperty("border-radius","var(--border-radius-sm)"),ye.style.setProperty("background","var(--surface-color)"),a(ve,()=>e("common.all","All")),a(ye,I(Ct,{get each(){return Y()},children:xe=>(()=>{var $e=ah();return $e.value=xe,a($e,xe),$e})()}),null),ge.style.setProperty("display","block"),ge.style.setProperty("margin-bottom","0.25rem"),ge.style.setProperty("font-size","0.875rem"),ge.style.setProperty("color","var(--text-muted)"),a(ge,()=>e("common.dateFrom","Date From")),a(pe,I(Mr,{type:"date",get value(){return s().start},onInput:xe=>l({...s(),start:xe.currentTarget.value})}),null),Ne.style.setProperty("display","block"),Ne.style.setProperty("margin-bottom","0.25rem"),Ne.style.setProperty("font-size","0.875rem"),Ne.style.setProperty("color","var(--text-muted)"),a(Ne,()=>e("common.dateTo","Date To")),a(ke,I(Mr,{type:"date",get value(){return s().end},onInput:xe=>l({...s(),end:xe.currentTarget.value})}),null),fe(()=>H.value=i()),fe(()=>Q.value=w()),fe(()=>ee.value=c()),fe(()=>ye.value=u()),A}}),L),L.style.setProperty("display","flex"),L.style.setProperty("justify-content","space-between"),L.style.setProperty("align-items","center"),L.style.setProperty("margin-bottom","1rem"),O.style.setProperty("font-size","0.875rem"),O.style.setProperty("color","var(--text-muted)"),a(O,()=>e("common.showing","Showing"),ne),a(O,()=>x().length,X),a(O,()=>e("common.of","of"),se),a(O,()=>t.hbls.length,k),a(O,()=>e("hbl.records","records"),null),N.style.setProperty("display","flex"),N.style.setProperty("gap","0.5rem"),a(N,I(_t,{variant:"outline",size:"sm",onClick:P,get children(){return e("common.print","Print")}}),null),a(N,I(_t,{variant:"outline",size:"sm",onClick:J,get children(){return e("common.exportCSV","Export CSV")}}),null),a(N,I(_t,{variant:"outline",size:"sm",onClick:C,get children(){return e("common.exportExcel","Export Excel")}}),null),v}}),S),S.style.setProperty("margin-top","1rem"),a(S,I(Ct,{get each(){return x()},children:v=>I(Gt,{style:{"margin-bottom":"0.5rem"},get children(){var z=PD(),re=z.firstChild,L=re.firstChild,O=L.firstChild,ne=O.nextSibling,X=L.nextSibling,W=X.firstChild,se=W.firstChild,F=se.nextSibling,k=W.nextSibling,N=k.firstChild,A=N.nextSibling,V=X.nextSibling,Z=V.firstChild,H=Z.nextSibling,B=re.nextSibling,M=B.firstChild,G=M.firstChild,Q=G.firstChild,ie=G.nextSibling,me=M.nextSibling,oe=me.firstChild,ee=oe.firstChild,de=oe.nextSibling,he=me.nextSibling,le=he.firstChild,ye=le.firstChild,ve=le.nextSibling,pe=he.nextSibling,ge=pe.firstChild,ke=ge.firstChild,Ne=ge.nextSibling,xe=Ne.firstChild,$e=pe.nextSibling,Ee=$e.firstChild,Me=Ee.firstChild,Ye=Ee.nextSibling,ze=$e.nextSibling,je=ze.firstChild,Xe=je.firstChild,ht=je.nextSibling;return z.addEventListener("mouseleave",ut=>{ut.currentTarget.style.backgroundColor="transparent"}),z.addEventListener("mouseenter",ut=>{ut.currentTarget.style.backgroundColor="var(--strip-color)"}),z.$$click=()=>t.onHBLSelect?.(v),z.style.setProperty("padding","1rem"),z.style.setProperty("cursor","pointer"),z.style.setProperty("transition","background-color 0.2s"),re.style.setProperty("display","grid"),re.style.setProperty("grid-template-columns","150px 1fr auto"),re.style.setProperty("gap","1rem"),re.style.setProperty("align-items","center"),O.style.setProperty("font-weight","600"),O.style.setProperty("color","var(--primary-color)"),a(O,()=>v.hbl),ne.style.setProperty("font-size","0.75rem"),ne.style.setProperty("color","var(--text-muted)"),a(ne,()=>v.idairguide),X.style.setProperty("display","grid"),X.style.setProperty("grid-template-columns","1fr 1fr"),X.style.setProperty("gap","1rem"),se.style.setProperty("font-size","0.75rem"),se.style.setProperty("color","var(--text-muted)"),a(se,()=>e("hbl.shipper","Shipper")),F.style.setProperty("font-weight","500"),a(F,()=>v.nameshipper),N.style.setProperty("font-size","0.75rem"),N.style.setProperty("color","var(--text-muted)"),a(N,()=>e("hbl.consignee","Consignee")),A.style.setProperty("font-weight","500"),a(A,()=>v.consigneeName),V.style.setProperty("text-align","right"),Z.style.setProperty("display","inline-block"),Z.style.setProperty("padding","0.25rem 0.75rem"),Z.style.setProperty("border-radius","var(--border-radius-sm)"),Z.style.setProperty("font-size","0.75rem"),Z.style.setProperty("font-weight","500"),Z.style.setProperty("color","white"),a(Z,()=>v.idguidestate),H.style.setProperty("font-size","0.75rem"),H.style.setProperty("color","var(--text-muted)"),H.style.setProperty("margin-top","0.25rem"),a(H,()=>$(v.datereserve)),B.style.setProperty("margin-top","0.75rem"),B.style.setProperty("display","grid"),B.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),B.style.setProperty("gap","0.5rem"),B.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-muted)"),a(G,()=>e("hbl.city","City"),Q),ie.style.setProperty("font-weight","500"),a(ie,()=>v.address.city),oe.style.setProperty("color","var(--text-muted)"),a(oe,()=>e("hbl.classification","Class"),ee),de.style.setProperty("font-weight","500"),a(de,()=>v.idclasification),le.style.setProperty("color","var(--text-muted)"),a(le,()=>e("hbl.commodity","Commodity"),ye),ve.style.setProperty("font-weight","500"),a(ve,()=>v.namegood),ge.style.setProperty("color","var(--text-muted)"),a(ge,()=>e("hbl.weight","Weight"),ke),Ne.style.setProperty("font-weight","500"),a(Ne,()=>v.weight,xe),Ee.style.setProperty("color","var(--text-muted)"),a(Ee,()=>e("hbl.bagNumber","Bag#"),Me),Ye.style.setProperty("font-weight","500"),a(Ye,()=>v.bagnumber),je.style.setProperty("color","var(--text-muted)"),a(je,()=>e("hbl.guideNo","Guide No."),Xe),ht.style.setProperty("font-weight","500"),a(ht,()=>v.guia),fe(ut=>(ut=D(v.idguidestate))!=null?Z.style.setProperty("background-color",ut):Z.style.removeProperty("background-color")),z}})})),b})()};br(["click"]);var wD=ae("<div><div><label></label><select><option value=all>"),xD=ae("<div><div><h2>HBL: </h2><button></button></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong><span></span></div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> <!>, </div><div><strong>:</strong> </div><div><strong>:</strong> <!> kg</div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),CD=ae("<div>"),AD=ae("<div><div><h1></h1><button>"),$D=ae("<option> ");const ED=()=>{const{t}=_r(),[e,r]=we([]),[n,i]=we(null),[o,s]=we([]),[l,c]=we("all"),[d,u]=we(""),y=x=>{i(x)},g=x=>{s(x)},f=x=>{c(x),w()},w=async()=>{if(!d().trim())return null;let x=await qi.getHBLS(d().trim(),{guia:l()});x?.error?r([]):r(Object.values(x))};jn(()=>{});const E=Ut(()=>{const x=new Set([2516,2517,2518,2519,2520,2521].map(T=>T));return Array.from(x).sort((T,Y)=>T-Y)});return(()=>{var x=AD(),T=x.firstChild,Y=T.firstChild,K=Y.nextSibling;return x.style.setProperty("padding","1rem"),T.style.setProperty("margin-bottom","2rem"),T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),Y.style.setProperty("font-size","1.5rem"),Y.style.setProperty("font-weight","600"),Y.style.setProperty("color","var(--text-primary)"),a(Y,()=>t("hbl.title","House Bill of Lading Management")),K.style.setProperty("padding","0.75rem 1.5rem"),K.style.setProperty("background","var(--primary-color)"),K.style.setProperty("color","white"),K.style.setProperty("border","none"),K.style.setProperty("border-radius","var(--border-radius-sm)"),K.style.setProperty("cursor","pointer"),K.style.setProperty("font-weight","500"),a(K,()=>t("hbl.addNew","Add New HBL")),a(x,I(Gt,{get children(){var j=wD(),q=j.firstChild,J=q.firstChild,C=J.nextSibling,P=C.firstChild;return j.style.setProperty("padding","1rem"),q.style.setProperty("width","13rem"),J.style.setProperty("display","block"),J.style.setProperty("margin-bottom","0.25rem"),J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-muted)"),a(J,()=>t("hbl.guideNumber","Guide Number")),C.addEventListener("change",$=>f($.currentTarget.value)),C.style.setProperty("width","100%"),C.style.setProperty("padding","0.5rem"),C.style.setProperty("border","1px solid var(--border-color)"),C.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("background","var(--surface-color)"),a(P,()=>t("common.all","All")),a(C,I(Ct,{get each(){return E()},children:$=>(()=>{var D=$D(),b=D.firstChild;return D.value=$,a(D,()=>t("hbl.guideNo","Guide No."),b),a(D,$,null),D})()}),null),a(j,I(Mr,{type:"text",get placeholder(){return t("hbl.searchPlaceholder","Search by HBL#, air guide, shipper, consignee, commodity, bag#, identity...")},get value(){return d()},onChange:$=>u($)}),null),fe(()=>C.value=l()),j}}),null),a(x,I(SD,{get hbls(){return e()},onFilterChange:g,onHBLSelect:y}),null),a(x,I(Oe,{get when(){return n()},get children(){var j=CD();return j.style.setProperty("position","fixed"),j.style.setProperty("top","0"),j.style.setProperty("left","0"),j.style.setProperty("right","0"),j.style.setProperty("bottom","0"),j.style.setProperty("background","rgba(0, 0, 0, 0.5)"),j.style.setProperty("display","flex"),j.style.setProperty("align-items","center"),j.style.setProperty("justify-content","center"),j.style.setProperty("z-index","1000"),a(j,I(Gt,{style:{width:"90%","max-width":"600px","max-height":"90vh","overflow-y":"auto"},get children(){var q=xD(),J=q.firstChild,C=J.firstChild;C.firstChild;var P=C.nextSibling,$=J.nextSibling,D=$.firstChild,b=D.firstChild,S=b.firstChild;b.nextSibling;var v=D.nextSibling,z=v.firstChild,re=z.firstChild;z.nextSibling;var L=v.nextSibling,O=L.firstChild,ne=O.firstChild,X=O.nextSibling,W=L.nextSibling,se=W.firstChild,F=se.firstChild;se.nextSibling;var k=W.nextSibling,N=k.firstChild,A=N.firstChild;N.nextSibling;var V=k.nextSibling,Z=V.firstChild,H=Z.firstChild;Z.nextSibling;var B=V.nextSibling,M=B.firstChild,G=M.firstChild;M.nextSibling;var Q=B.nextSibling,ie=Q.firstChild,me=ie.firstChild;ie.nextSibling;var oe=Q.nextSibling,ee=oe.firstChild,de=ee.firstChild;ee.nextSibling;var he=oe.nextSibling,le=he.firstChild,ye=le.firstChild;le.nextSibling;var ve=he.nextSibling,pe=ve.firstChild,ge=pe.firstChild,ke=pe.nextSibling,Ne=ke.nextSibling;Ne.nextSibling;var xe=ve.nextSibling,$e=xe.firstChild,Ee=$e.firstChild;$e.nextSibling;var Me=xe.nextSibling,Ye=Me.firstChild,ze=Ye.firstChild,je=Ye.nextSibling,Xe=je.nextSibling;Xe.nextSibling;var ht=Me.nextSibling,ut=ht.firstChild,Ue=ut.firstChild;ut.nextSibling;var it=ht.nextSibling,dt=it.firstChild,Fe=dt.firstChild;dt.nextSibling;var Be=it.nextSibling,Re=Be.firstChild,lt=Re.firstChild;Re.nextSibling;var ot=Be.nextSibling,nt=ot.firstChild,Ve=nt.firstChild;nt.nextSibling;var qt=ot.nextSibling,Mt=qt.firstChild,Qt=Mt.firstChild;return Mt.nextSibling,q.style.setProperty("padding","2rem"),J.style.setProperty("display","flex"),J.style.setProperty("justify-content","space-between"),J.style.setProperty("align-items","center"),J.style.setProperty("margin-bottom","1.5rem"),C.style.setProperty("font-size","1.25rem"),C.style.setProperty("font-weight","600"),a(C,()=>n().hbl,null),P.$$click=()=>i(null),P.style.setProperty("background","none"),P.style.setProperty("border","none"),P.style.setProperty("font-size","1.5rem"),P.style.setProperty("cursor","pointer"),P.style.setProperty("color","var(--text-muted)"),$.style.setProperty("display","grid"),$.style.setProperty("gap","1rem"),a(b,()=>t("hbl.airGuide","Air Guide"),S),a(D,()=>n().idairguide,null),a(z,()=>t("hbl.airNumber","Air Number"),re),a(v,()=>n().idairnumber,null),a(O,()=>t("hbl.status","Status"),ne),X.style.setProperty("margin-left","0.5rem"),X.style.setProperty("padding","0.25rem 0.75rem"),X.style.setProperty("border-radius","var(--border-radius-sm)"),X.style.setProperty("font-size","0.875rem"),X.style.setProperty("color","white"),a(X,()=>n().idguidestate),a(se,()=>t("hbl.classification","Classification"),F),a(W,()=>n().idclasification,null),a(N,()=>t("hbl.shipper","Shipper"),A),a(k,()=>n().nameshipper,null),a(Z,()=>t("hbl.shipperPhone","Shipper Phone"),H),a(V,()=>n().phoneshipper,null),a(M,()=>t("hbl.consignee","Consignee"),G),a(B,()=>n().consigneeName,null),a(ie,()=>t("hbl.consigneePhone","Consignee Phone"),me),a(Q,()=>n().ctelephone,null),a(ee,()=>t("hbl.identity","Identity"),de),a(oe,()=>n().cidentity,null),a(le,()=>t("hbl.address","Address"),ye),a(he,()=>n().street,null),a(pe,()=>t("hbl.city","City"),ge),a(ve,()=>n().address.city,Ne),a(ve,()=>n().address.estate,null),a($e,()=>t("hbl.commodity","Commodity"),Ee),a(xe,()=>n().namegood,null),a(Ye,()=>t("hbl.weight","Weight"),ze),a(Me,()=>n().weight,Xe),a(ut,()=>t("hbl.quantity","Quantity"),Ue),a(ht,()=>n().quantity,null),a(dt,()=>t("hbl.bagNumber","Bag Number"),Fe),a(it,()=>n().bagnumber,null),a(Re,()=>t("hbl.agency","Agency"),lt),a(Be,()=>n().agency,null),a(nt,()=>t("hbl.guide","Guide"),Ve),a(ot,()=>n().guia,null),a(Mt,()=>t("hbl.reserveDate","Reserve Date"),Qt),a(qt,()=>new Date(n().datereserve).toLocaleDateString(),null),fe(lr=>(lr=n().idguidestate==="ENTREGADO"?"#28a745":n().idguidestate==="ENVIADO"?"#17a2b8":n().idguidestate==="EN BODEGA"?"#007bff":"#6c757d")!=null?X.style.setProperty("background-color",lr):X.style.removeProperty("background-color")),q}})),j}}),null),x})()};br(["click"]);var ID=ae("<div>$124,350"),TD=ae("<div>+12% from last month"),kD=ae("<div>247"),dc=ae("<div>"),ND=ae("<div>18"),LD=ae("<div>$89,250"),RD=ae("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const DD=()=>{const{t}=_r(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},n={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)",margin:"0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"};return I(Po,{get title(){return t("dashboard.title")},get children(){return[(()=>{var o=dc();return p(o,e),a(o,I(Gt,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var s=ID();return fe(l=>p(s,n,l)),s})(),(()=>{var s=TD();return fe(l=>p(s,i,l)),s})()]}}),null),a(o,I(Gt,{get title(){return t("dashboard.employeeCount")},get subtitle(){return t("dashboard.current")},get children(){return[(()=>{var s=kD();return fe(l=>p(s,n,l)),s})(),(()=>{var s=dc();return a(s,()=>t("dashboard.newHires")),fe(l=>p(s,i,l)),s})()]}}),null),a(o,I(Gt,{get title(){return t("dashboard.pendingInvoices")},get subtitle(){return t("dashboard.outstanding")},get children(){return[(()=>{var s=ND();return fe(l=>p(s,n,l)),s})(),(()=>{var s=dc();return a(s,()=>t("dashboard.totalOutstanding")),fe(l=>p(s,i,l)),s})()]}}),null),a(o,I(Gt,{get title(){return t("dashboard.cashBalance")},get subtitle(){return t("accounts.title")},get children(){return[(()=>{var s=LD();return fe(l=>p(s,n,l)),s})(),(()=>{var s=dc();return a(s,()=>t("dashboard.lastUpdatedToday")),fe(l=>p(s,i,l)),s})()]}}),null),o})(),(()=>{var o=dc();return p(o,r),a(o,I(Gt,{get title(){return t("dashboard.quickActions")},get subtitle(){return t("dashboard.commonTasks")},get children(){var s=dc();return s.style.setProperty("display","flex"),s.style.setProperty("flex-direction","column"),s.style.setProperty("gap","1rem"),a(s,I(_t,{variant:"primary",get children(){return t("invoices.createNew")}}),null),a(s,I(_t,{variant:"secondary",get children(){return t("employees.addEmployee")}}),null),a(s,I(_t,{variant:"outline",get children(){return t("dashboard.generateReport")}}),null),s}}),null),a(o,I(Gt,{get title(){return t("dashboard.recentActivity")},get subtitle(){return t("dashboard.latestUpdates")},get children(){var s=RD(),l=s.firstChild,c=l.firstChild,d=c.nextSibling,u=l.nextSibling,y=u.firstChild,g=y.nextSibling,f=u.nextSibling,w=f.firstChild,E=w.nextSibling;return s.style.setProperty("display","flex"),s.style.setProperty("flex-direction","column"),s.style.setProperty("gap","0.75rem"),l.style.setProperty("border-bottom","1px solid var(--border-color)"),l.style.setProperty("padding-bottom","0.5rem"),c.style.setProperty("font-weight","500"),a(c,()=>t("dashboard.invoicePaid")),d.style.setProperty("font-size","0.875rem"),d.style.setProperty("color","var(--text-muted)"),a(d,()=>t("dashboard.hoursAgo")),u.style.setProperty("border-bottom","1px solid var(--border-color)"),u.style.setProperty("padding-bottom","0.5rem"),y.style.setProperty("font-weight","500"),a(y,()=>t("dashboard.newEmployeeOnboarded")),g.style.setProperty("font-size","0.875rem"),g.style.setProperty("color","var(--text-muted)"),a(g,()=>t("dashboard.dayAgo")),w.style.setProperty("font-weight","500"),a(w,()=>t("dashboard.monthlyReportGenerated")),E.style.setProperty("font-size","0.875rem"),E.style.setProperty("color","var(--text-muted)"),a(E,()=>t("dashboard.daysAgo")),s}}),null),o})(),I(Oe,{get when(){return vr.hasPermission("invoiceAccess")},get children(){return I(ML,{})}})]}})};var Ob=ae("<div>"),MD=ae("<div><div><div><strong>Display Name:</strong> </div><div><strong>UID:</strong> </div></div><div><strong>Created:</strong> "),FD=ae("<div><h3>Store Access</h3><div></div><div>No store access granted"),OD=ae("<div><select><option value=all>"),BD=ae("<div><h3>Permissions</h3><div>"),jD=ae('<div><div><input type=text placeholder="Search users..."></div><div>'),VD=ae("<div> You need administrator privileges to access this page."),qD=ae("<div>Loading users..."),zD=ae("<div><div></div><div></div><div> stores"),UD=ae("<div>Select a user to view and edit their profile"),HD=ae("<div><input type=checkbox><label>"),GD=ae("<option>"),WD=ae("<div><input type=checkbox><div><div></div><div>");const YD=()=>{const{t}=_r(),[e,r]=we([]),[n,i]=we(null),[o,s]=we(!1),[l,c]=we(!1),[d,u]=we(""),[y,g]=we(null),f=[{id:"YY_8802",name:"Store 8802"},{id:"YY_8803",name:"Store 8803"},{id:"YY_8804",name:"Store 8804"},{id:"YY_8805",name:"Store 8805"},{id:"YY_8816",name:"Store 8816"},{id:"YY_8818",name:"Store 8818"},{id:"YY_8847",name:"Store 8847"},{id:"YY_3251",name:"Store 3251"},{id:"YY_32",name:"Store 32"},{id:"YY_76",name:"Store 76"},{id:"YY_2376",name:"Store 2376"},{id:"YY_79",name:"Store 79"},{id:"YY_8635",name:"Store 8635"},{id:"YY_8665",name:"Store 8665"},{id:"YY_8901",name:"Store 8901"}],w=[{key:"AccountAccess",label:"Account Access",description:"Access to accounting features"},{key:"BankingAccess",label:"Banking Access",description:"Access to banking operations"},{key:"InventoryAccess",label:"Inventory Access",description:"Access to inventory management"},{key:"JournalAccess",label:"Journal Access",description:"Access to journal entries"},{key:"invoiceAccess",label:"invoice Access",description:"Access to Invoices"},{key:"inventoryDownsection",label:"Inventory Downsection",description:"Access to inventory downsection"},{key:"onlyRead",label:"Read Only",description:"Limited to read-only access"},{key:"read_write",label:"Read/Write",description:"Full read and write permissions"},{key:"isAdmin",label:"Administrator",description:"Full system administration rights"}];let E={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_2376:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},businessId:"YB100423253156428",AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,invoiceAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1},x=[{label:"Stephanie S",id:"SS695841584167881"},{label:"YABA",id:"YB100423253156428"},{label:"GUANCHO",id:"JJCM23753J15918M"},{label:"LUISCUETO",id:"LMR470531564CT28"}];jn(async()=>{await T()});const T=async()=>{try{s(!0);const L=W4(Mf,"users"),O=sE(L,aE("createdAt","desc")),ne=await hE(O),X=[];ne.forEach(W=>{let se=W.data();Object.keys(E).map(F=>{let k=E?.[F];se.hasOwnProperty(F)||(se[F]=k)}),X.push({uid:W.id,...se})}),r(X)}catch(L){console.error("Error loading users:",L),g({type:"error",text:"Failed to load users"})}finally{s(!1)}},Y=Ut(()=>{const L=d().toLowerCase();return L?e().filter(O=>O.email?.toLowerCase().includes(L)||O.displayName?.toLowerCase().includes(L)||O.uid?.toLowerCase().includes(L)):e()}),K=L=>{n()&&i(O=>({...O,stores:{...O.stores,[L]:!O.stores[L]}}))},j=L=>{n()&&i(O=>({...O,businessId:L}))},q=L=>{n()&&i(O=>({...O,[L]:!O[L]}))};Ut(()=>n()?n().stores&&Object.values(n().stores).some(L=>L):!1);const J=async()=>{if(n())try{c(!0),g(null);const L=Q5(Mf,"users",n().uid);let O={stores:n().stores,AccountAccess:n().AccountAccess,BankingAccess:n().BankingAccess,InventoryAccess:n().InventoryAccess,invoiceAccess:n().invoiceAccess,JournalAccess:n().JournalAccess,inventoryDownsection:n().inventoryDownsection,onlyRead:n().onlyRead,read_write:n().read_write,businessId:n().businessId,isAdmin:n().isAdmin||!1};await a_(L,O),r(ne=>ne.map(X=>X.uid===n().uid?n():X)),g({type:"success",text:"User profile updated successfully"})}catch(L){console.error("Error saving user profile:",L),g({type:"error",text:"Failed to save user profile"})}finally{c(!1)}},C={display:"grid","grid-template-columns":"350px 1fr",gap:"2rem",height:"calc(100vh - 200px)"},P={"max-height":"100%","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)",background:"var(--surface-color)"},$=L=>({padding:"1rem","border-bottom":"1px solid var(--border-color)",cursor:"pointer",background:L?"var(--primary-color-light)":"transparent",transition:"background 0.2s"}),D={padding:"0.75rem",border:"none","border-bottom":"1px solid var(--border-color)",background:"var(--surface-color)",width:"100%","font-size":"1rem"},b={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem"},S={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.75rem"},v={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",transition:"all 0.2s"},z=L=>({padding:"1rem","margin-bottom":"1rem","border-radius":"var(--border-radius)",background:L==="success"?"#d4edda":"#f8d7da",color:L==="success"?"#155724":"#721c24",border:`1px solid ${L==="success"?"#c3e6cb":"#f5c6cb"}`}),re=Ut(()=>vr.state.profile?.isAdmin===!0);return I(Po,{title:"User Profile Administration",get children(){return I(Oe,{get when(){return re()},get fallback(){return I(Gt,{get children(){var L=VD();return L.style.setProperty("text-align","center"),L.style.setProperty("padding","2rem"),L.style.setProperty("color","var(--text-muted)"),L}})},get children(){var L=jD(),O=L.firstChild,ne=O.firstChild,X=O.nextSibling;return p(L,C),p(O,P),ne.$$input=W=>u(W.currentTarget.value),p(ne,D),a(O,I(Oe,{get when(){return!o()},get fallback(){return(()=>{var W=qD();return W.style.setProperty("padding","2rem"),W.style.setProperty("text-align","center"),W})()},get children(){return I(Ct,{get each(){return Y()},children:W=>(()=>{var se=zD(),F=se.firstChild,k=F.nextSibling,N=k.nextSibling,A=N.firstChild;return se.$$click=()=>i(W),F.style.setProperty("font-weight","600"),a(F,()=>W.displayName||"No Name"),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("color","var(--text-muted)"),a(k,()=>W.email),N.style.setProperty("font-size","0.75rem"),N.style.setProperty("color","var(--text-muted)"),N.style.setProperty("margin-top","0.25rem"),a(N,()=>W.isAdmin&&" Admin  ",A),a(N,()=>Object.values(W.stores||{}).filter(Boolean).length,A),fe(V=>p(se,$(n()?.uid===W.uid),V)),se})()})}}),null),a(X,I(Oe,{get when(){return n()},get fallback(){return I(Gt,{get children(){var W=UD();return W.style.setProperty("text-align","center"),W.style.setProperty("padding","2rem"),W.style.setProperty("color","var(--text-muted)"),W}})},get children(){return[I(Oe,{get when(){return y()},get children(){var W=Ob();return a(W,()=>y().text),fe(se=>p(W,z(y().type),se)),W}}),I(Gt,{title:"User Information",get subtitle(){return n().email},get children(){return[(()=>{var W=MD(),se=W.firstChild,F=se.firstChild,k=F.firstChild;k.nextSibling;var N=F.nextSibling,A=N.firstChild;A.nextSibling;var V=se.nextSibling,Z=V.firstChild;return Z.nextSibling,W.style.setProperty("margin-bottom","2rem"),se.style.setProperty("display","flex"),se.style.setProperty("justify-content","space-between"),se.style.setProperty("margin-bottom","1rem"),a(F,()=>n().displayName||"Not set",null),a(N,()=>n().uid,null),a(V,()=>new Date(n().createdAt?.toDate?.()||n().createdAt).toLocaleDateString(),null),W})(),(()=>{var W=FD(),se=W.firstChild,F=se.nextSibling,k=F.nextSibling;return W.style.setProperty("margin-bottom","2rem"),se.style.setProperty("margin-bottom","1rem"),p(F,S),a(F,I(Ct,{each:f,children:N=>{let A=Pt.getLocationById(N?.id);return(()=>{var V=HD(),Z=V.firstChild,H=Z.nextSibling;return V.$$click=()=>K(N?.id),Z.style.setProperty("cursor","pointer"),H.style.setProperty("cursor","pointer"),H.style.setProperty("user-select","none"),a(H,()=>A?.name),fe(B=>p(V,{...v,background:n().stores?.[N?.id]?"var(--primary-color-light)":"transparent"},B)),fe(()=>Z.checked=n().stores?.[N?.id]||!1),V})()}})),k.style.setProperty("margin-top","0.5rem"),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("color","var(--text-muted)"),W})(),(()=>{var W=OD(),se=W.firstChild,F=se.firstChild;return W.style.setProperty("margin-bottom","2rem"),se.addEventListener("change",k=>j(k.currentTarget.value)),se.style.setProperty("width","100%"),se.style.setProperty("padding","0.5rem"),se.style.setProperty("border","1px solid var(--border-color)"),se.style.setProperty("border-radius","var(--border-radius-sm)"),se.style.setProperty("background","var(--surface-color)"),a(F,()=>t("common.all","All")),a(se,I(Ct,{each:x,children:k=>(()=>{var N=GD();return a(N,()=>k?.label),fe(()=>N.value=k.id),N})()}),null),fe(()=>se.value=n()?.businessId),W})(),(()=>{var W=BD(),se=W.firstChild,F=se.nextSibling;return W.style.setProperty("margin-bottom","2rem"),se.style.setProperty("margin-bottom","1rem"),p(F,b),a(F,I(Ct,{each:w,children:k=>(()=>{var N=WD(),A=N.firstChild,V=A.nextSibling,Z=V.firstChild,H=Z.nextSibling;return N.$$click=()=>q(k.key),A.style.setProperty("cursor","pointer"),V.style.setProperty("flex","1"),V.style.setProperty("cursor","pointer"),V.style.setProperty("user-select","none"),Z.style.setProperty("font-weight","500"),a(Z,()=>k.label),H.style.setProperty("font-size","0.75rem"),H.style.setProperty("color","var(--text-muted)"),a(H,()=>k.description),fe(B=>p(N,{...v,background:n()[k.key]?"var(--primary-color-light)":"transparent"},B)),fe(()=>A.checked=!!n()[k.key]),N})()})),W})(),(()=>{var W=Ob();return W.style.setProperty("display","flex"),W.style.setProperty("gap","1rem"),W.style.setProperty("justify-content","flex-end"),a(W,I(_t,{variant:"secondary",onClick:()=>i(null),children:"Cancel"}),null),a(W,I(_t,{variant:"primary",onClick:J,get disabled(){return l()},get children(){return l()?"Saving...":"Save Changes"}}),null),W})()]}})]}})),fe(()=>ne.value=d()),L}})}})};br(["input","click"]);const KD=async()=>{try{console.log("Testing PDF generation...");const e=(await ao(()=>Promise.resolve().then(()=>F_),void 0)).default;console.log("jsPDF imported successfully");const r=new e;console.log("PDF document created"),r.setFontSize(20),r.text("Test PDF",20,20),r.setFontSize(12),r.text("This is a test PDF to verify the library works.",20,40),console.log("Text added to PDF"),r.save("test.pdf"),console.log("PDF saved successfully"),alert("Test PDF generated successfully!")}catch(t){console.error("Test PDF generation failed:",t),alert(`Test PDF failed: ${t.message}`)}},Ym=(t,e)=>{try{console.log("Generating printable PDF..."),console.log(t);const r=window.open("","_blank","width=800,height=600");if(!r){alert("Please allow popups to generate PDF");return}const n=t.shipper_consignee||{};let i=Pt.getLocationById(t?.store);const o=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Invoice ${t.invoice||"N/A"}</title>
        <style>
          body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
          }
          .header {
            display: flex;
            justify-content: space-between;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
            margin-bottom: 20px;
          }
          .company {
            font-size: 24px;
            font-weight: bold;
            color: #2563eb;
          }
          .invoice-info {
            text-align: right;
          }
          .section {
            margin: 20px 0;
          }
          .section-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
          }
          .customer-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
             font-size: 13px;
          }
          .flex{
            display: flex;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
          }
          th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
          }
          th {
            background-color: #f2f2f2;
            font-weight: bold;
            font-size: 13px;
          }
          td{
           font-size: 12px;
          }
          .total-row {
            font-weight: bold;
            font-size: 16px;
            background-color: #e8f4fd;
          }
          .certification-section {
            page-break-inside: avoid;
            break-inside: avoid;
            orphans: 3;
            widows: 3;
          }
          .page-break-before {
            page-break-before: always;
            break-before: page;
          }
          @media print {
            body { margin: 0; }
            .no-print { display: none; }
            .certification-section {
              page-break-inside: avoid !important;
              break-inside: avoid !important;
              orphans: 3;
              widows: 3;
            }
            .page-break-before {
              page-break-before: always !important;
              break-before: page !important;
            }
            /* Force page break if certification section would be split */
            @page {
              margin: 0.5in;
              orphans: 3;
              widows: 3;
            }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <div>
            <div class="company">HRM FINANCE</div>
            <div>${e("common.store")}: ${i?.name||t?.store||"N/A"}</div>
            <div>${e("common.orderId")}: ${t.ssg_sorder_key||"N/A"}</div>
            ${t.shippingMethod?`<div>${e("common.shipping")}: ${t.shippingMethod==="aereo"?e("common.air"):e("common.sea")}</div>`:""}
          </div>
          <div class="invoice-info">
            <div style="font-size: 18px; font-weight: bold;">${e("common.invoice").toUpperCase()}</div>
            <div style="font-size: 16px; margin: 5px 0;">${t.invoice||"N/A"}</div>
            <div>${t.createDate?new Date(t.createDate).toLocaleDateString():"N/A"}</div>
            <div style="margin-top: 10px;">
              <span style="padding: 4px 8px; background: ${t.isCompleted?"#d4edda":"#fff3cd"}; border-radius: 10px; font-size: 12px;">
                ${t.isCompleted?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase()}
              </span>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="customer-info">
            <div><strong>${e("invoices.senderInformation")}:</strong> ${n.name||"N/A"}</div>
            ${n.phoneNumberS?`<div><strong>${e("invoices.phoneNumber")}:</strong> ${n.phoneNumberS}</div>`:""}
          
          </div>
          <div class="customer-info">
            <div><strong>${e("invoices.receiptInformation")}:</strong> ${[n.firstName,n.middleName,n.lastName,n.lastName2].filter(Boolean).join(" ")||"N/A"}</div>
            <div><strong>${e("invoices.phoneNumber")}:</strong> ${n.phoneNumber||"N/A"}</div>
            <div><strong>${e("invoices.id")}:</strong> ${n.cid||"N/A"}</div>
            ${n.address?`<div><strong>${e("invoices.address")}:</strong> ${n.address}</div>`:""}
          </div>
        </div>

        ${t.products&&t.products.length>0?`
        <div class="section">
          <div class="section-title">${e("invoices.products")}</div>
          <table>
            <thead>
              <tr>
                <th>${e("invoices.code")}</th>
                <th>${e("invoices.description")}</th>
                <th>${e("invoices.qty")}</th>
                <th>${e("invoices.unitPrice")}</th>
                <th>${e("invoices.total")}</th>
              </tr>
            </thead>
            <tbody>
              ${t.products.map(s=>`
                <tr>
                  <td>${s.product?.code||"N/A"}</td>
                  <td>${s.product?.label||"N/A"}</td>
                  <td>${Math.abs(s.qty||0).toFixed(2)}</td>
                  <td>$${parseFloat(s.salePrice||0).toFixed(2)}</td>
                  <td>$${(s.total||Math.abs(s.qty||0)*parseFloat(s.salePrice||0)).toFixed(2)}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </div>
        `:""}

        ${t.reservas&&t.reservas.length>0?`
        <div class="section">
          <div class="section-title">${e("invoices.reservations")}</div>
          <table>
            <thead>
              <tr>
                <th>${e("invoices.type")}</th>
                <th>${e("invoices.qty")}</th>
                <th>${e("invoices.unitPrice")}</th>
                <th>${e("invoices.arancel")}</th>
                <th>${e("invoices.total")}</th>
              </tr>
            </thead>
            <tbody>
              ${t.reservas.map(s=>{const l=parseFloat(s.qty||0),c=parseFloat(s.price||0),d=parseFloat(s.arancel||0),u=s.total||l*c+d;return`
                  <tr>
                    <td>${s.type||"N/A"}</td>
                    <td>${l.toFixed(2)}</td>
                    <td>$${c.toFixed(2)}</td>
                    <td>${d>0?"$"+d.toFixed(2):"-"}</td>
                    <td>$${u.toFixed(2)}</td>
                  </tr>
                `}).join("")}
            </tbody>
          </table>
        </div>
        `:""}

        ${t.services&&t.services.length>0?`
        <div class="section">
          <div class="section-title">${e("invoices.services")}</div>
          <table>
            <thead>
              <tr>
                <th>${e("invoices.type")}</th>
                <th>${e("invoices.qty")}</th>
                <th>${e("invoices.arancel")}</th>
                <th>${e("invoices.total")}</th>
              </tr>
            </thead>
            <tbody>
              ${t.services.map(s=>{const l=parseFloat(s.qty||0),c=parseFloat(s.price||0),d=parseFloat(s.arancel||0),u=s.total||l*c+d;return`
                  <tr>
                    <td>${s.type||"N/A"}</td>
                    <td>${l.toFixed(2)}</td>
                    <td>${d>0?"$"+d.toFixed(2):"-"}</td>
                    <td>$${u.toFixed(2)}</td>
                  </tr>
                `}).join("")}
            </tbody>
          </table>
        </div>
        `:""}

        <div class="section flex">
          ${t.paymentMethods?`
        <div class="section" style="margin-right: auto; width: 48%">
          <div class="section-title">${e("common.paymentMethods")}</div>
          <div class="customer-info">
            ${t.paymentMethods.cash>0?`<div><strong> ${e("common.cash")}:</strong> $${t.paymentMethods.cash.toFixed(2)}</div>`:""}
            ${t.paymentMethods.zelle>0?`<div><strong> Zelle:</strong> $${t.paymentMethods.zelle.toFixed(2)}</div>`:""}
            ${t.paymentMethods.creditCard>0?`<div><strong> ${e("common.creditCard")}:</strong> $${t.paymentMethods.creditCard.toFixed(2)}</div>`:""}
            ${t.paymentMethods.exemptTaxOnCash&&t.paymentMethods.cash>0&&t.taxSavings>0?`
              <div style="margin-top: 10px; padding: 8px; background-color: #e7f5ff; border-radius: 4px; font-size: 12px; font-style: italic;">
                * ${e("common.taxExemptNote")} ${e("common.youSaved")} $${t.taxSavings.toFixed(2)}!
              </div>
            `:""}
          </div>
        </div>
        `:""}
        <div class="section ">
          <table style="margin-left: auto; width: width: 48%">
            ${t.productSubtotal?`
            <tr>
              <td><strong>${e("invoices.productsSubtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${t.productSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            ${t.reservaSubtotal?`
            <tr>
              <td><strong>${e("invoices.reservationsSubtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${t.reservaSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            ${t.serviceSubtotal?`
            <tr>
              <td><strong>${e("invoices.servicesSubtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${t.serviceSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            ${t.taxAmount&&t.taxAmount>0?`
            <tr>
              <td><strong>${e("common.subtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${(t.subtotalBeforeTax||0).toFixed(2)}</strong></td>
            </tr>
            <tr>
              <td><strong>${e("common.tax")} (${t.paymentMethods?.taxPercent||7}%):</strong></td>
              <td style="text-align: right;"><strong>$${t.taxAmount.toFixed(2)}</strong></td>
            </tr>
            `:""}
            <tr class="total-row">
              <td><strong>${e("invoices.total").toUpperCase()}:</strong></td>
              <td style="text-align: right;"><strong>$${(t.total||0).toFixed(2)}</strong></td>
            </tr>
          </table>
        </div>
        </div>
        
       

        <!-- Certification Section -->
        <div class="certification-section" style="margin-top: 40px; padding: 20px; border: 2px solid #333; background: #f9f9f9;">
          <div style="text-align: center; font-weight: bold; font-size: 14px; margin-bottom: 15px; text-transform: uppercase;">
            CERTIFICACIN DEL EMBARCADOR
          </div>
          <div style="font-size: 11px; line-height: 1.4; text-align: justify; margin-bottom: 20px;">
            <p><strong>Certifico que no envo sustancias ni productos prohibidos por las leyes y las aduanas de USA y Cuba, como por ejemplo:</strong> drogas, armas, explosivos, cigarrillos electrnicos, drones profesionales, joyas, prendas, dinero en efectivo, semillas, narcticos, frmacos controlados, productos agrcolas de tipo herbicidas o antifngicidas, ningn tipo de producto perecedero que necesite refrigeracin.</p>
            
            <p><strong>Entiendo que al llenar este formulario, al enviar alguna de las sustancias o productos antes descritos mi carga puede ser decamisada completa o parcialmente por las aduanas de Cuba o USA sin derecho a reclamo ni compensacin,</strong> de parte ma como embarcador, ni de la persona a quien envo (consignatario).</p>
            
           </div>
          
          <!-- Signature Section -->
          <div style="display: flex; justify-content: space-between; margin-top: 30px;">
            <div style="width: 45%; text-align: center;">
              <div style="border-bottom: 2px solid #333; margin-bottom: 10px; height: 40px;"></div>
              <div style="font-size: 10px; font-weight: bold;">FIRMA DEL EMBARCADOR / SHIPPER SIGNATURE</div>
              <div style="font-size: 10px; margin-top: 5px;">${n.name||"N/A"}</div>
            </div>
            <div style="width: 45%; text-align: center;">
              <div style="border-bottom: 2px solid #333; margin-bottom: 10px; height: 40px;"></div>
              <div style="font-size: 10px; font-weight: bold;">FECHA / DATE</div>
              <div style="font-size: 10px; margin-top: 5px;">${new Date().toLocaleDateString()}</div>
            </div>
          </div>
        </div>

        <div style="margin-top: 40px; text-align: center; color: #666; font-size: 12px;">
          <p>${e("common.thankForChoosingUs")}</p>
          <p>${e("common.generatedOn")} ${new Date().toLocaleDateString()}</p>
        </div>

        <script>
          // Check if certification section needs page break
          function checkCertificationPageBreak() {
            const certSection = document.querySelector('.certification-section');
            if (!certSection) return;
            
            // Reset any previous page break class to get accurate measurements
            certSection.classList.remove('page-break-before');
            
            // Force a layout recalculation
            certSection.offsetHeight;
            
            const rect = certSection.getBoundingClientRect();
            const certHeight = rect.height;
            const certTop = rect.top;
            
            // Estimate print page height (assuming standard letter size at 96 DPI)
            // Standard letter: 11 inches - 1 inch margins = 10 inches usable
            // At 96 DPI: 10 * 96 = 960px usable height per page
            const printPageHeight = 960;
            const pageMargin = 48; // 0.5 inch margins
            
            // Calculate current position on the page
            const currentPagePosition = certTop % printPageHeight;
            const remainingPageSpace = printPageHeight - currentPagePosition - pageMargin;
            
            // Add some buffer space (50px) to ensure comfortable fit
            const requiredSpace = certHeight + 50;
            
            false && console.log('Certification section analysis:', {
              certHeight,
              certTop,
              currentPagePosition,
              remainingPageSpace,
              requiredSpace,
              needsPageBreak: requiredSpace > remainingPageSpace
            });
            
            // Only add page break if certification truly won't fit
            if (requiredSpace > remainingPageSpace && remainingPageSpace < printPageHeight * 0.4) {
              // console.log('Adding page break for certification section');
              certSection.classList.add('page-break-before');
            }
          }
          
          // Run check when page loads and before printing
          document.addEventListener('DOMContentLoaded', function() {
            // Delay to ensure all content is rendered
            setTimeout(checkCertificationPageBreak, 100);
          });
          window.addEventListener('beforeprint', checkCertificationPageBreak);
        <\/script>

        <div class="no-print" style="margin-top: 30px; text-align: center;">
          <button onclick="window.print()" style="padding: 10px 20px; font-size: 16px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
            ${e("common.printSavePDF")}
          </button>
          <button onclick="window.close()" style="padding: 10px 20px; font-size: 16px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer; margin-left: 10px;">
            ${e("common.close")}
          </button>
        </div>
      </body>
      </html>
    `;r.document.write(o),r.document.close(),r.focus(),console.log("Printable PDF window opened")}catch(r){console.error("Error generating printable PDF:",r),alert("Error generating printable PDF: "+r.message)}},JD=async(t,e)=>{try{console.log("Starting professional PDF generation...");const n=(await ao(()=>Promise.resolve().then(()=>F_),void 0)).default,i=new n,o=210,s=297,l=15,c=o-l*2,d={r:180,g:180,b:180},u={r:80,g:80,b:80},y={r:130,g:130,b:130},g={r:248,g:248,b:248},f={r:252,g:252,b:252},w={r:120,g:120,b:120},E={r:150,g:150,b:150};let x=l;const T=Q=>{i.setTextColor(Q.r,Q.g,Q.b)},Y=Q=>{i.setFillColor(Q.r,Q.g,Q.b)},K=(Q,ie,me,oe,ee,de=!1)=>{i.roundedRect(Q,ie,me,oe,ee,ee,de?"F":"S")};Y(f),i.rect(0,0,o,50,"F"),i.setDrawColor(d.r,d.g,d.b),i.setLineWidth(.5),i.line(0,50,o,50),T(u),i.setFontSize(32),i.setFont("helvetica","bold"),i.text("HRM",l,25),T(y),i.setFontSize(32),i.setFont("helvetica","normal");const j=i.getTextWidth("HRM ");i.text("FINANCE",l+j,25),T(y),i.setFontSize(9),i.setFont("helvetica","normal"),i.text("Professional Business Solutions",l,35);const q=70,J=o-l-q;i.setDrawColor(d.r,d.g,d.b),i.setLineWidth(.5),K(J,12,q,26,2,!1),T(u),i.setFontSize(14),i.setFont("helvetica","bold");const C=e("common.invoice").toUpperCase(),P=i.getTextWidth(C);i.text(C,J+(q-P)/2,22),i.setFontSize(11),i.setFont("helvetica","normal");const $=t.invoice||"N/A",D=i.getTextWidth($);i.text($,J+(q-D)/2,32),x=60,Y(f),i.rect(0,50,o,20,"F");const b=t.isCompleted,S=b?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase();T(b?u:y),i.setFontSize(8),i.setFont("helvetica","bold"),i.text(`STATUS: ${S}`,l,58),T(y),i.setFontSize(9),i.setFont("helvetica","normal");const z=t.createDate?new Date(t.createDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A";i.text(z,o-l-i.getTextWidth(z),58),x=58,i.text(`${e("common.store")}: ${t.store||"N/A"}`,l+60,x),x+=5,i.text(`${e("common.orderId")}: ${t.ssg_sorder_key||"N/A"}`,l+60,x),t.shippingMethod&&i.text(`${e("common.shipping")}: ${t.shippingMethod==="aereo"?e("common.air"):e("common.sea")}`,o-l-50,x),x=80,T(u),i.setFontSize(14),i.setFont("helvetica","bold"),i.text(e("invoices.customerInformation"),l,x),x+=10;const re=45,L=10,O=(c-L)/2;Y(f),K(l,x,O,re,3,!0),i.setDrawColor(d.r,d.g,d.b),i.setLineWidth(.3),K(l,x,O,re,3);const ne=t.shipper_consignee||{};let X=x+8;T(y),i.setFontSize(9),i.text(e("invoices.senderInformation"),l+5,X),X+=7,T(u),i.setFontSize(11),i.setFont("helvetica","bold"),i.text(ne.name||"N/A",l+5,X),ne.phoneNumberS&&(X+=6,i.setFont("helvetica","normal"),i.setFontSize(9),T(y),i.text(`${e("invoices.altPhone")}: ${ne.phoneNumberS}`,l+5,X)),Y(f),K(l+O+L,x,O,re,3,!0),i.setDrawColor(d.r,d.g,d.b),i.setLineWidth(.3),K(l+O+L,x,O,re,3),X=x+8,T(y),i.setFontSize(9),i.text(e("invoices.receiptInformation"),l+O+L+5,X),X+=7;const W=[ne.firstName,ne.middleName,ne.lastName,ne.lastName2].filter(Boolean).join(" ")||"N/A";if(T(u),i.setFontSize(11),i.setFont("helvetica","bold"),i.text(W,l+O+L+5,X),X+=6,i.setFont("helvetica","normal"),i.setFontSize(9),T(y),i.text(`${e("invoices.phoneNumber")}: ${ne.phoneNumber||"N/A"}`,l+O+L+5,X),X+=5,i.text(`${e("invoices.id")}: ${ne.cid||"N/A"}`,l+O+L+5,X),ne.address)X+=5,ne.address.split(",").map(ie=>ie.trim()).forEach((ie,me)=>{me<2&&ie&&(i.text(ie,l+O+L+5,X),X+=5)});else{let Q=`${ne.ybstreet||""} #${ne.ybstreetNo||""} ${e("invoices.between")} ${ne.ybbetwen1||""} ${e("invoices.and")} ${ne.ybbetwen2||""}`,ie=`${ne.ybreparto||""}, ${ne.ybcity||""}, ${ne.ybestate||""}`;X+=5,i.text(Q,l+O+L+5,X),X+=5,i.text(ie,l+O+L+5,X)}if(x+=re+15,t?.products&&t?.products?.length>0){T(u),i.setFontSize(14),i.setFont("helvetica","bold"),i.text(e("invoices.products"),l,x),x+=10,Y(g),i.rect(l,x-6,c,10,"F"),i.setDrawColor(d.r,d.g,d.b),i.setLineWidth(.3),i.line(l,x+4,o-l,x+4),i.setFontSize(9),i.setFont("helvetica","bold"),T(u);const Q={code:l+5,description:l+35,qty:l+115,price:l+135,total:l+160};i.text(e("invoices.code"),Q.code,x),i.text(e("invoices.description"),Q.description,x),i.text(e("invoices.qty"),Q.qty,x),i.text(e("invoices.unitPrice"),Q.price,x),i.text(e("invoices.total"),Q.total,x),x+=10,i.setFont("helvetica","normal"),i.setFontSize(9),t.products.forEach((ie,me)=>{x>250&&(i.addPage(),x=l),me%2===0&&(Y(f),i.rect(l,x-4,c,8,"F")),T(u),i.text(ie.product?.code||"N/A",Q.code,x);let oe=ie.product?.label||"N/A";i.getTextWidth(oe)>70&&(oe=oe.substring(0,40)+"..."),i.text(oe,Q.description,x);const ee=Math.abs(ie.qty||0),de=parseFloat(ie.salePrice||0),he=ie.total||ee*de;i.text(ee.toString(),Q.qty,x),i.text(`$${de.toFixed(2)}`,Q.price,x),i.setFont("helvetica","bold"),i.text(`$${he.toFixed(2)}`,Q.total,x),i.setFont("helvetica","normal"),x+=8}),i.setDrawColor(d.r,d.g,d.b),i.setLineWidth(.3),i.line(l,x,o-l,x),x+=15}if(t.reservas&&t.reservas.length>0){x>200&&(i.addPage(),x=l),T(u),i.setFontSize(14),i.setFont("helvetica","bold"),i.text(e("invoices.reservations"),l,x),x+=10,Y(g),i.rect(l,x-6,c,10,"F"),i.setDrawColor(d.r,d.g,d.b),i.setLineWidth(.3),i.line(l,x+4,o-l,x+4),i.setFontSize(9),i.setFont("helvetica","bold"),T(u);const Q={type:l+5,qty:l+65,price:l+95,arancel:l+125,total:l+160};i.text(e("invoices.type"),Q.type,x),i.text(e("invoices.qty"),Q.qty,x),i.text(e("invoices.unitPrice"),Q.price,x),i.text(e("invoices.arancel"),Q.arancel,x),i.text(e("invoices.total"),Q.total,x),x+=10,i.setFont("helvetica","normal"),i.setFontSize(9),t.reservas.forEach((ie,me)=>{x>250&&(i.addPage(),x=l),me%2===0&&(Y(f),i.rect(l,x-4,c,8,"F")),T(u),i.text(ie.type||"N/A",Q.type,x);const oe=parseFloat(ie.qty||0),ee=parseFloat(ie.price||0),de=parseFloat(ie.arancel||0),he=ie.total||oe*ee+de;i.text(oe.toString(),Q.qty,x),i.text(`$${ee.toFixed(2)}`,Q.price,x),i.text(`$${de.toFixed(2)}`,Q.arancel,x),i.setFont("helvetica","bold"),i.text(`$${he.toFixed(2)}`,Q.total,x),i.setFont("helvetica","normal"),x+=8}),i.setDrawColor(d.r,d.g,d.b),i.setLineWidth(.3),i.line(l,x,o-l,x),x+=15}x>210&&(i.addPage(),x=l);const se=o-l-80,F=80;let k=60;t.taxAmount&&t.taxAmount>0&&(k+=16),Y(f),K(se-10,x,F+10,k,3,!0),i.setDrawColor(d.r,d.g,d.b),i.setLineWidth(.3),K(se-10,x,F+10,k,3);let N=x+10;if(i.setFontSize(10),T(y),t.productSubtotal!==void 0&&t.productSubtotal>0&&(i.text(e("invoices.productsSubtotal"),se,N),i.text(`$${t.productSubtotal.toFixed(2)}`,se+F-15,N,{align:"right"}),N+=8),t.reservaSubtotal!==void 0&&t.reservaSubtotal>0&&(i.text(e("invoices.reservationsSubtotal"),se,N),i.text(`$${t.reservaSubtotal.toFixed(2)}`,se+F-15,N,{align:"right"}),N+=8),t.taxAmount&&t.taxAmount>0){i.text(e("common.subtotal"),se,N),i.text(`$${(t.subtotalBeforeTax||0).toFixed(2)}`,se+F-15,N,{align:"right"}),N+=8;const Q=t.paymentMethods?.taxPercent||7;i.text(`${e("common.tax")} (${Q}%)`,se,N),i.text(`$${t.taxAmount.toFixed(2)}`,se+F-15,N,{align:"right"}),N+=8}if(i.setDrawColor(d.r,d.g,d.b),i.setLineWidth(.3),i.line(se,N+2,se+F-10,N+2),N+=10,i.setFontSize(14),i.setFont("helvetica","bold"),T(u),i.text(e("invoices.total"),se,N),i.text(`$${(t.total||0).toFixed(2)}`,se+F-15,N,{align:"right"}),t.paymentMethods){x+=k+20,T(u),i.setFontSize(12),i.setFont("helvetica","bold"),i.text(e("common.paymentMethods"),l,x),x+=10,i.setFontSize(10),i.setFont("helvetica","normal"),T(y);const Q=t.paymentMethods;let ie=x;Q.cash&&Q.cash>0&&(i.text(`${e("common.cash")}:`,l+5,ie),i.text(`$${Q.cash.toFixed(2)}`,l+50,ie),ie+=6),Q.zelle&&Q.zelle>0&&(i.text("Zelle:",l+5,ie),i.text(`$${Q.zelle.toFixed(2)}`,l+50,ie),ie+=6),Q.creditCard&&Q.creditCard>0&&(i.text(`${e("common.creditCard")}:`,l+5,ie),i.text(`$${Q.creditCard.toFixed(2)}`,l+50,ie),ie+=6),Q.exemptTaxOnCash&&Q.cash>0&&t.taxSavings>0&&(ie+=4,i.setFontSize(9),i.setFont("helvetica","italic"),i.text(`* Tax exempted on cash payment. You saved $${t.taxSavings.toFixed(2)}!`,l+5,ie)),x=ie+10}x=s-30,Y(f),i.rect(0,x-10,o,40,"F"),i.setFontSize(12),i.setFont("helvetica","italic"),T(y);const A=e("common.thankYouBusiness"),V=i.getTextWidth(A);i.text(A,(o-V)/2,x),x+=8,i.setFontSize(9),i.setFont("helvetica","normal");const Z="www.hrmfinance.com | info@hrmfinance.com | +1 (555) 123-4567",H=i.getTextWidth(Z);i.text(Z,(o-H)/2,x),x+=8,i.setFontSize(8);const B=`Generated on ${new Date().toLocaleString("en-US")}`,M=i.getTextWidth(B);i.text(B,(o-M)/2,x);const G=`invoice-${t.invoice||"unknown"}.pdf`;i.save(G),console.log("Professional PDF saved successfully:",G)}catch(r){throw console.error("Error in generateProfessionalInvoicePDF:",r),r}},Pi=t=>parseFloat(t?.toString()||"0")||0,QD=t=>{if(t?.includes("/")){const[e,r,n]=t.split("/");return`${n}-${e.padStart(2,"0")}-${r.padStart(2,"0")}`}if(t?.includes("-")){const[e,r,n]=t.split("-");return`${n}-${e.padStart(2,"0")}-${r.padStart(2,"0")}`}return t},XD=t=>{const e=[];return t.ybstreet&&(e.push(t.ybstreet),t.ybstreetNo&&e.push(`# ${t.ybstreetNo}`)),t.ybbetwen1&&t.ybbetwen2&&e.push(`/ ${t.ybbetwen1} y ${t.ybbetwen2}`),t.ybreparto&&e.push(`, Rpto ${t.ybreparto}`),t.ybcity&&e.push(`, ${t.ybcity}`),t.ybestate&&e.push(`, ${t.ybestate}`),e.join(" ")},Bb=t=>{const e=Pi(t.qty),r=Pi(t.price),n=Pi(t.arancel);return t.onlyTariff,{lbs:e*r,arancel:n,total:e*r+n}},jb=t=>{const e=Math.abs(t.qty),r=Pi(t.salePrice);return e*r},ZD=(t,e)=>{const r=t.split("-");if(r.length>=3){const n=r[0];return{YY_8803:"BISSONNET"}[n]||e}return e},ip=t=>{const e=t?.products?.reduce((K,j)=>K+jb(j),0),r=t?.reservas?.reduce((K,j)=>K+Bb(j).lbs,0),n=t?.services?.reduce((K,j)=>{const q=Pi(j.qty),J=Pi(j.arancel);return K+q*J},0)||0,i=parseFloat(Pi(r).toFixed(2)),o=parseFloat(Pi(n).toFixed(2));var s=Pi(e)+Pi(r)+Pi(n),l=t?.TaxPercent||0,c=s*l/100,d=0,u=s+c,y=0;t?.paymentMethods&&t.subtotalBeforeTax&&(l=t?.paymentMethods?.taxPercent||0,c=t.taxAmount||0,u=t.total||0,s=t.subtotalBeforeTax||0,d=t?.taxSavings||0);const f=(t?.products||[])?.map((K,j)=>({id:Date.now().toString()+j,product:{id:K.product.id,code:K.product.code,label:K.product.label,price:0},qty:Math.abs(K.qty),salePrice:Pi(K.salePrice),total:jb(K)})),w=t?.reservas?.map((K,j)=>({id:Date.now().toString()+j+1e3,type:K.type,qty:Pi(K.qty),price:Pi(K.price),arancel:Pi(K.arancel),total:Bb(K)?.total})),E=t?.services?.map((K,j)=>{const q=Pi(K.qty),J=Pi(K.arancel);return{id:Date.now().toString()+j+2e3,type:K.type,qty:q,arancel:J,total:q*J}})||[],x={name:t.shipper_consignee.name,firstName:t.shipper_consignee.firstName,middleName:t.shipper_consignee.middleName||"",lastName:t.shipper_consignee.lastName,lastName2:t.shipper_consignee.lastName2||"",phoneNumber:t.shipper_consignee.phoneNumber,cid:t.shipper_consignee.cid,passport:t.shipper_consignee.passport||"",address:XD(t.shipper_consignee),phoneNumberS:t.shipper_consignee.phoneNumberS,dob:QD(t.shipper_consignee.dob)},T=ZD(t.invoice,t.store),Y=t.shippingMethod?.toLowerCase()==="aereo"?"aereo":"maritimo";return{invoice:t.invoice,description:t.description||"",store:T,shipper_consignee:x,products:f,reservas:w,services:E,packagesOrder:t.packagesOrder,shippingMethod:Y,paymentMethods:t?.paymentMethods,type:t.type,ssg_inventory_key:t.ssg_inventory_key,ssg_sorder_key:t.ssg_sorder_key,createDate:t.createDate,businessId:t.businessId,isCompleted:t.isCompleted,productSubtotal:e,reservaSubtotal:i,serviceSubtotal:o,subtotalBeforeTax:s,taxAmount:c,taxSavings:d,total:u,taxCalculationMethod:"subtotal",cashPaymentRatio:y}},[uc,dn]=Zd({invoices:[],selectedInvoice:null,loading:!1,error:null,lastUpdated:null}),[e8,ko]=we({fetchAll:!1,fetchById:!1,create:!1,update:!1,delete:!1,generatePDF:!1}),io={get state(){return uc},get loadingStates(){return e8()},async fetchInvoices(t){try{ko(s=>({...s,fetchAll:!0})),dn("loading",!0),dn("error",null);let e="SALES";if(t?.search&&(e+=" "+t.search),t?.store&&t.store!=="all")e+=" "+t.store;else if(!vr.state?.profile?.isAdmin)return e+=" "+Nl(32),dn("invoices",[]),dn("lastUpdated",new Date),[];t?.status&&t.status!=="all"&&(e+=" "+t.status);const r=e.toString(),n=await qi.getInvoice(r);let i=[];if(t?.dateFrom&&t?.dateTo){const s=l=>{let c=new Date(n[l].createDate).getTime(),d=new Date(t?.dateFrom).getTime(),u=new Date(t?.dateTo).getTime();c>=d&&c<=u&&i.push(n[l])};Object.keys(n).map(s)}else i=Pl(n);const o=Array.isArray(i)?i:i||[];return dn("invoices",o),dn("lastUpdated",new Date),o}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoices";throw dn("error",r),console.error("Error fetching invoices:",e),e}finally{dn("loading",!1),ko(e=>({...e,fetchAll:!1}))}},fecthInventory:async t=>{},async fetchInvoiceById(t){try{ko(n=>({...n,fetchById:!0})),dn("error",null);const e=await qi.getInvoice(t),r=Pl(e);return dn("selectedInvoice",r[0]),r}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice";throw dn("error",r),console.error("Error fetching invoice:",e),e}finally{ko(e=>({...e,fetchById:!1}))}},async createInvoice(t){try{ko(r=>({...r,create:!0})),dn("error",null);const e={type:t.type||"SALES",invoice:t.invoice,description:t.description||"",store:t.store||"",ssg_inventory_key:t.ssg_inventory_key||`INV-${Date.now()}`,ssg_sorder_key:t.ssg_sorder_key||`SO-${Date.now()}`,createDate:t.createDate||Date.now(),shipper_consignee:t.shipper_consignee,packagesOrder:t.packagesOrder||!1,businessId:t.businessId||"YB100423253156428",userId:t.userId||"current-user",reservas:t.reservas||[],products:t.products||[],isCompleted:t.isCompleted||!0};if(e.products&&e.products.length>0&&(e.productSubtotal=e.products.reduce((r,n)=>r+n.qty*n.salePrice,0)),e.reservas&&e.reservas.length>0&&(e.reservaSubtotal=e.reservas.reduce((r,n)=>r+n.total,0)),e.total=(e.productSubtotal||0)+(e.reservaSubtotal||0),dn("invoices",r=>[e,...r]),dn("lastUpdated",new Date),e.isCompleted)try{await k0(e),console.log("Automated journal entries processed for invoice:",e.invoice)}catch(r){console.error("Error processing automated journal entries:",r)}return e}catch(e){const r=e instanceof Error?e.message:"Failed to create invoice";throw dn("error",r),console.error("Error creating invoice:",e),e}finally{ko(e=>({...e,create:!1}))}},async generateInvoicePDF(t,e="compact",r="es"){try{ko(l=>({...l,generatePDF:!0})),dn("error",null);const n=uc.invoices.find(l=>l.invoice===t);if(!n)throw new Error("Invoice not found");let i;switch(e){case"compact":const{generateCompactModernInvoicePDF:l}=await ao(async()=>{const{generateCompactModernInvoicePDF:u}=await import("./compactModernInvoicePdfGenerator-BHluHwEV.js");return{generateCompactModernInvoicePDF:u}},[]);i=l;break;case"modern":const{generateModernMovementInvoicePDF:c}=await ao(async()=>{const{generateModernMovementInvoicePDF:u}=await import("./modernMovementInvoicePdfGenerator-Ts-i93u8.js");return{generateModernMovementInvoicePDF:u}},[]);i=c;break;case"classic":default:const{generateWorkingInvoicePDF:d}=await ao(async()=>{const{generateWorkingInvoicePDF:u}=await import("./workingPdfGenerator-DKuNFtsa.js");return{generateWorkingInvoicePDF:u}},[]);i=d;break}const o={...n,movementType:"sales",items:n.products||[],invoiceId:n.invoice,id:n.invoice};return await i(o,null,r)}catch(n){const i=n instanceof Error?n.message:"Failed to generate PDF";throw dn("error",i),console.error("Error generating invoice PDF:",n),n}finally{ko(n=>({...n,generatePDF:!1}))}},async updateInvoice(t,e){try{ko(i=>({...i,update:!0})),dn("error",null);const r=uc.invoices.find(i=>i.ssg_sorder_key===t),n={};if(dn("invoices",i=>i.map(o=>o.invoice===t?n:o)),uc.selectedInvoice?.invoice===t&&dn("selectedInvoice",n),dn("lastUpdated",new Date),e.isCompleted&&!r?.isCompleted)try{await k0(n),console.log("Automated journal entries processed for updated invoice:",n.invoice)}catch(i){console.error("Error processing automated journal entries:",i)}return n}catch(r){const n=r instanceof Error?r.message:"Failed to update invoice";throw dn("error",n),console.error("Error updating invoice:",r),r}finally{ko(r=>({...r,update:!1}))}},async deleteInvoice(t){try{ko(i=>({...i,delete:!0})),dn("error",null),dn("invoices",i=>i.filter(o=>o.invoice!==t)),uc.selectedInvoice?.invoice===t&&dn("selectedInvoice",null),dn("lastUpdated",new Date);const n=await yn({query:"deleteYabaSalesOrders",params:{businessId:"YB100423253156428",id:t}});return!0}catch(e){const r=e instanceof Error?e.message:"Failed to delete invoice";throw dn("error",r),console.error("Error deleting invoice:",e),e}finally{ko(e=>({...e,delete:!1}))}},async fetchInvoiceStats(t){try{dn("error",null);const e=new URLSearchParams;t?.store&&t.store!=="all"&&e.append("store",t.store),t?.dateFrom&&e.append("dateFrom",t.dateFrom),t?.dateTo&&e.append("dateTo",t.dateTo);const r=e.toString();return[]}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice statistics";throw dn("error",r),console.error("Error fetching invoice stats:",e),e}},async fetchStores(){try{return dn("error",null),[]}catch(t){const e=t instanceof Error?t.message:"Failed to fetch stores";throw dn("error",e),console.error("Error fetching stores:",t),t}},setSelectedInvoice(t){dn("selectedInvoice",t)},clearError(){dn("error",null)},getFilteredInvoices(t){let e=uc.invoices;if(t.store&&t.store!=="all"&&(e=e.filter(r=>r.store===t.store)),t.dateFrom){const r=new Date(t.dateFrom).getTime();e=e.filter(n=>n.createDate>=r)}if(t.dateTo){const r=new Date(t.dateTo).setHours(23,59,59,999);e=e.filter(n=>n.createDate<=r)}if(t.status&&t.status!=="all"){const r=t.status==="completed";e=e.filter(n=>n.isCompleted===r)}return e},calculateSummary(t){let e=t.length,r=t.filter(g=>g.isCompleted).length,n=0,i=0,o=0,s=0,l=0,c=0,d=new Set,u=new Set;t?.forEach(g=>{d.add(g?.shipper_consignee?.cid),u.add(g.store),g?.products?.length>0&&g?.products?.forEach(f=>{const w=Math.abs(f?.qty);n+=w,o+=w*(parseFloat(f?.salePrice)||1)}),g?.reservas?.length>0&&g?.reservas?.forEach(f=>{let w=parseInt(f?.qty);isNaN(w)&&(w=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[f.type]||f?.onlyTariff?(w=parseFloat(f.arancel)||parseFloat(f.qty)*parseFloat(f.price),c+=w):(f?.arancel&&(l+=parseFloat(f?.arancel)),i+=w,s+=w*parseFloat(f?.price))})});const y=o+s+c;return{totalInvoices:e,completedInvoices:r,pendingInvoices:e-r,totalProducts:n,totalReservas:i,totalProductAmount:o,totalReservaAmount:s,totalAranceles:l,grandTotal:y,totalOther:c,uniqueCustomers:d.size,uniqueStores:u.size,avgInvoiceValue:e>0?y/e:0}},async refreshData(t){return this.fetchInvoices(t)}};var t8=ae("<br>"),Vb=ae("<div><h3></h3><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),r8=ae("<div><h3></h3><table><thead><tr><th></th><th></th><th></th><th></th></tr></thead><tbody>"),lh=ae("<div><span>:</span><span>"),n8=ae("<div><span> ($<!>%):</span><span>"),i8=ae("<button>remove"),o8=ae("<div class=invoice-display><div><div><div>:<span></span></div><div>: <span></span></div></div><div><div></div><h2></h2><div></div><div></div></div></div><div><h3></h3><div><div><div></div><div></div></div></div><div></div><h3></h3><div><div><div></div><div> <!> <!> </div><div></div><div></div><div></div><div></div></div><div><div></div><div></div><div></div><div></div><div> #<br> <!> <!> <br>, <br>, </div></div></div></div><div><div><div></div><div><span>:</span><span></span></div></div></div><div></div><div><button> </button><button> Test PDF</button><button> </button></div><style>"),qb=ae("<tr><td></td><td></td><td></td><td></td><td>"),s8=ae("<tr><td></td><td></td><td></td><td>");const ls=t=>parseFloat(t?.toString()||"0")||0,a8=t=>{const{t:e}=_r(),[r,n]=we(""),[i,o]=we(!1),s=re=>new Date(re).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),l=re=>{const L=typeof re=="string"?parseFloat(re):re;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(L)},c=Ut(()=>{let re=0,L=0,O=0,ne=0,X=0;t.invoice?.products?.forEach(k=>{const N=Math.abs(k?.qty),A=parseFloat(k?.salePrice?.toString())||1;re+=N*A}),t.invoice?.reservas?.forEach(k=>{let N=parseFloat(k?.qty?.toString());isNaN(N)&&(N=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[k.type]||k?.onlyTariff?(N=parseFloat(k.arancel?.toString())||parseFloat(k.qty?.toString())*parseFloat(k.price?.toString()),ne+=N):(k?.arancel&&(X+=parseFloat(k?.arancel?.toString())),L+=N*parseFloat(k?.price?.toString()))}),t.invoice?.services?.forEach(k=>{O+=ls(k.qty)*ls(k.price)+ls(k.arancel)});var W=re+L+O+X+ne,se=0,F=W+se;return t.invoice?.paymentMethods&&(se=t.invoice?.taxAmount,F=t.invoice?.total,W=t.invoice?.subtotalBeforeTax),{productSubtotal:re,reservaSubtotal:L,serviceSubtotal:O,tariffSubtotal:X,subtotal:W,tax:se,total:F}}),d={"max-width":"800px",margin:"0 auto",padding:"2rem",background:"white","box-shadow":"0 0 20px rgba(0,0,0,0.1)","border-radius":"var(--border-radius)"},u={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"2rem","padding-bottom":"2rem","border-bottom":"2px solid #e0e0e0"},y={"text-align":"right",flex:"1"},g={display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600","text-transform":"uppercase",background:t.invoice.isCompleted?"#d4edda":"#fff3cd",color:t.invoice.isCompleted?"#155724":"#856404","margin-bottom":"0.5rem"},f={"margin-bottom":"2rem"},w={"font-size":"1.1rem","font-weight":"600","margin-bottom":"1rem",color:"#333"},E={display:"grid","grid-template-columns":"1fr 1fr",gap:"1.5rem"},x={background:"#f8f9fa",padding:"1rem","border-radius":"var(--border-radius-sm)",border:"1px solid #e9ecef"},T={"font-size":"0.875rem",color:"#666","margin-bottom":"0.25rem"},Y={"font-size":"1rem",color:"#333","font-weight":"500"},K={width:"100%","border-collapse":"collapse","margin-top":"1rem"},j={"text-align":"left",padding:"0.75rem","border-bottom":"2px solid #dee2e6","font-weight":"600",color:"#495057","font-size":"0.875rem","text-transform":"uppercase"},q={padding:"0.75rem","border-bottom":"1px solid #dee2e6",color:"#212529"},J={"font-weight":"600","font-size":"1.1rem"},C={display:"flex",gap:"1rem","justify-content":"center","margin-top":"2rem","padding-top":"2rem","border-top":"2px solid #e0e0e0"},P={padding:"0.75rem 1.5rem","border-radius":"var(--border-radius-sm)",border:"none","font-weight":"500",cursor:"pointer",transition:"all 0.2s",display:"flex","align-items":"center",gap:"0.5rem"},$={...P,background:"var(--primary-color)",color:"white"},D={...P,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},b=Ut(()=>Pt.getLocationById(t.invoice.store)),S=async()=>{console.log("Starting PDF export...");try{if(!t.invoice){console.error("No invoice data available"),alert("No invoice data available");return}let re=ip(t.invoice);console.log("Using minimal ink PDF generator...");try{await JD(re,e),console.log("Minimal ink PDF generation completed successfully")}catch(L){console.error("PDF generation failed:",L),console.log("Trying printable PDF fallback..."),Ym(re,e),console.log("Printable PDF fallback completed")}}catch(re){console.error("Error in handleExportPDF:",re),console.error("Error stack:",re.stack),alert(`Error generating PDF: ${re.message}`)}},v=async()=>{console.log("Starting PDF export...");try{if(!t.invoice){console.error("No invoice data available"),alert("No invoice data available");return}const re={...t.invoice,storeName:b()?.name||t.invoice.store,storeType:b()?.type,productSubtotal:c().productSubtotal,reservaSubtotal:c().reservaSubtotal,total:c().total};let L=ip(t.invoice);console.log("Using minimal ink PDF generator...");try{Ym(L,e),console.log("Minimal ink PDF generation completed successfully")}catch(O){console.error("PDF generation failed:",O),console.log("Trying printable PDF fallback..."),Ym(L,e),console.log("Printable PDF fallback completed")}}catch(re){console.error("Error in handleExportPDF:",re),console.error("Error stack:",re.stack),alert(`Error generating PDF: ${re.message}`)}},z=re=>{io.deleteInvoice(t.invoice.ssg_sorder_key),t.goBack()};return(()=>{var re=o8(),L=re.firstChild,O=L.firstChild,ne=O.firstChild,X=ne.firstChild,W=X.nextSibling,se=ne.nextSibling,F=se.firstChild,k=F.nextSibling,N=O.nextSibling,A=N.firstChild,V=A.nextSibling,Z=V.nextSibling,H=Z.nextSibling,B=L.nextSibling,M=B.firstChild,G=M.nextSibling,Q=G.firstChild,ie=Q.firstChild,me=ie.nextSibling,oe=G.nextSibling,ee=oe.nextSibling,de=ee.nextSibling,he=de.firstChild,le=he.firstChild,ye=le.nextSibling,ve=ye.firstChild,pe=ve.nextSibling,ge=pe.nextSibling,ke=ge.nextSibling;ke.nextSibling;var Ne=ye.nextSibling,xe=Ne.nextSibling,$e=xe.nextSibling,Ee=$e.nextSibling,Me=he.nextSibling,Ye=Me.firstChild,ze=Ye.nextSibling,je=ze.nextSibling,Xe=je.nextSibling,ht=Xe.nextSibling,ut=ht.firstChild,Ue=ut.nextSibling,it=Ue.nextSibling,dt=it.nextSibling,Fe=dt.nextSibling,Be=Fe.nextSibling,Re=Be.nextSibling,lt=Re.nextSibling,ot=lt.nextSibling,nt=ot.nextSibling,Ve=nt.nextSibling,qt=B.nextSibling,Mt=qt.firstChild,Qt=Mt.firstChild,lr=Qt.nextSibling,bt=lr.firstChild,yr=bt.firstChild,Cr=bt.nextSibling,Kt=qt.nextSibling,sr=Kt.nextSibling,pt=sr.firstChild;pt.firstChild;var gt=pt.nextSibling,Vt=gt.nextSibling;Vt.firstChild;var gr=sr.nextSibling;return p(re,d),p(L,u),ne.style.setProperty("color","#666"),ne.style.setProperty("margin-top","0.25rem"),a(ne,()=>e(`inventory.${b()?.type}Type`),X),W.style.setProperty("font-size","1.1rem"),W.style.setProperty("font-weight","600"),W.style.setProperty("color","#444"),a(W,()=>b()?.name),se.style.setProperty("font-size",".91rem"),se.style.setProperty("font-weight","400"),se.style.setProperty("color","#666"),a(se,()=>e("invoices.id"),F),k.style.setProperty("font-size","1.1rem"),k.style.setProperty("font-weight","600"),k.style.setProperty("color","#444"),a(k,()=>t.invoice.ssg_sorder_key),p(N,y),a(A,(()=>{var et=Te(()=>!!t.invoice.isCompleted);return()=>et()?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase()})()),V.style.setProperty("margin","0 0 0.5rem 0"),V.style.setProperty("font-size","1.5rem"),a(V,()=>e("common.invoice").toUpperCase()),Z.style.setProperty("font-size","1.1rem"),Z.style.setProperty("font-weight","600"),Z.style.setProperty("color","#333"),a(Z,()=>t.invoice.invoice),H.style.setProperty("color","#666"),H.style.setProperty("margin-top","0.5rem"),a(H,()=>s(t.invoice.createDate)),a(M,()=>e("invoices.senderInformation")),a(ie,()=>e("invoices.customerName")),a(me,()=>t.invoice.shipper_consignee.name),a(Q,I(Oe,{get when(){return t.invoice.shipper_consignee.phoneNumberS},get children(){return[t8(),Te(()=>e("invoices.altPhone")),": ",Te(()=>t.invoice.shipper_consignee.phoneNumberS)]}}),null),oe.style.setProperty("margin","20px"),a(ee,()=>e("invoices.receiptInformation")),a(le,()=>e("invoices.customerName")),a(ye,()=>t.invoice.shipper_consignee.firstName,ve),a(ye,()=>t.invoice.shipper_consignee.middleName,pe),a(ye,()=>t.invoice.shipper_consignee.lastName,ke),a(ye,()=>t.invoice.shipper_consignee.lastName2,null),a(Ne,()=>e("invoices.id")),a(xe,()=>t.invoice.shipper_consignee.cid),a($e,()=>e("invoices.passport")),a(Ee,()=>t.invoice.shipper_consignee.passport),a(Ye,()=>e("invoices.contactInformation")),a(ze,()=>e("invoices.phoneNumber")),a(je,()=>t.invoice.shipper_consignee.phoneNumber),a(Xe,()=>e("invoices.address")),a(ht,()=>t.invoice.shipper_consignee.ybstreet,ut),a(ht,()=>t.invoice.shipper_consignee.ybstreetNo,Ue),a(ht,()=>e("invoices.between"),it),a(ht,()=>t.invoice.shipper_consignee.ybbetwen1,dt),a(ht,()=>e("invoices.and"),Be),a(ht,()=>t.invoice.shipper_consignee.ybbetwen2,lt),a(ht,()=>t.invoice.shipper_consignee.ybreparto,ot),a(ht,()=>t.invoice.shipper_consignee.ybcity,nt),a(ht,()=>t.invoice.shipper_consignee.ybestate,Ve),a(ht,()=>t.invoice.shipper_consignee.nacionality,null),a(re,I(Oe,{get when(){return t.invoice?.products?.length>0},get children(){var et=Vb(),ft=et.firstChild,At=ft.nextSibling,Yt=At.firstChild,hr=Yt.firstChild,Pr=hr.firstChild,Jr=Pr.nextSibling,Tr=Jr.nextSibling,zr=Tr.nextSibling,Xr=zr.nextSibling,pr=Yt.nextSibling;return a(ft,()=>e("invoices.products")),a(Pr,()=>e("invoices.code")),a(Jr,()=>e("invoices.description")),a(Tr,()=>e("invoices.qty")),a(zr,()=>e("invoices.unitPrice")),a(Xr,()=>e("invoices.total")),a(pr,I(Ct,{get each(){return t.invoice?.products},children:Jt=>(()=>{var Yr=qb(),Lr=Yr.firstChild,We=Lr.nextSibling,Bt=We.nextSibling,Ft=Bt.nextSibling,Ht=Ft.nextSibling;return a(Lr,()=>Jt.product.code),a(We,()=>Jt.product.label),a(Bt,()=>Math.abs(Jt.qty)),a(Ft,()=>l(Jt.salePrice)),a(Ht,()=>l(Math.abs(Jt.qty)*ls(Jt.salePrice))),fe(Ke=>{var Zt=q,Wt=q,xr={...q,"text-align":"center"},Hr={...q,"text-align":"right"},mr={...q,"text-align":"right"};return Ke.e=p(Lr,Zt,Ke.e),Ke.t=p(We,Wt,Ke.t),Ke.a=p(Bt,xr,Ke.a),Ke.o=p(Ft,Hr,Ke.o),Ke.i=p(Ht,mr,Ke.i),Ke},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Yr})()})),fe(Jt=>{var Yr=f,Lr=w,We=K,Bt=j,Ft=j,Ht={...j,"text-align":"center"},Ke={...j,"text-align":"right"},Zt={...j,"text-align":"right"};return Jt.e=p(et,Yr,Jt.e),Jt.t=p(ft,Lr,Jt.t),Jt.a=p(At,We,Jt.a),Jt.o=p(Pr,Bt,Jt.o),Jt.i=p(Jr,Ft,Jt.i),Jt.n=p(Tr,Ht,Jt.n),Jt.s=p(zr,Ke,Jt.s),Jt.h=p(Xr,Zt,Jt.h),Jt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),et}}),qt),a(re,I(Oe,{get when(){return t.invoice?.reservas?.length>0},get children(){var et=Vb(),ft=et.firstChild,At=ft.nextSibling,Yt=At.firstChild,hr=Yt.firstChild,Pr=hr.firstChild,Jr=Pr.nextSibling,Tr=Jr.nextSibling,zr=Tr.nextSibling,Xr=zr.nextSibling,pr=Yt.nextSibling;return a(ft,()=>e("invoices.reservations")),a(Pr,()=>e("invoices.type")),a(Jr,()=>e("invoices.qty")),a(Tr,()=>e("invoices.unitPrice")),a(zr,()=>e("invoices.arancel")),a(Xr,()=>e("invoices.total")),a(pr,I(Ct,{get each(){return t.invoice?.reservas},children:Jt=>(()=>{var Yr=qb(),Lr=Yr.firstChild,We=Lr.nextSibling,Bt=We.nextSibling,Ft=Bt.nextSibling,Ht=Ft.nextSibling;return a(Lr,()=>Jt.type),a(We,()=>Jt.qty),a(Bt,()=>l(Jt.price)),a(Ft,()=>Jt.arancel||"-"),a(Ht,()=>l((ls(Jt.qty)||0)*(ls(Jt.price)||0)+(Jt.arancel?ls(Jt.arancel):0))),fe(Ke=>{var Zt=q,Wt={...q,"text-align":"center"},xr={...q,"text-align":"right"},Hr={...q,"text-align":"right"},mr={...q,"text-align":"right"};return Ke.e=p(Lr,Zt,Ke.e),Ke.t=p(We,Wt,Ke.t),Ke.a=p(Bt,xr,Ke.a),Ke.o=p(Ft,Hr,Ke.o),Ke.i=p(Ht,mr,Ke.i),Ke},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Yr})()})),fe(Jt=>{var Yr=f,Lr=w,We=K,Bt=j,Ft={...j,"text-align":"center"},Ht={...j,"text-align":"right"},Ke={...j,"text-align":"right"},Zt={...j,"text-align":"right"};return Jt.e=p(et,Yr,Jt.e),Jt.t=p(ft,Lr,Jt.t),Jt.a=p(At,We,Jt.a),Jt.o=p(Pr,Bt,Jt.o),Jt.i=p(Jr,Ft,Jt.i),Jt.n=p(Tr,Ht,Jt.n),Jt.s=p(zr,Ke,Jt.s),Jt.h=p(Xr,Zt,Jt.h),Jt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),et}}),qt),a(re,I(Oe,{get when(){return t.invoice?.services?.length>0},get children(){var et=r8(),ft=et.firstChild,At=ft.nextSibling,Yt=At.firstChild,hr=Yt.firstChild,Pr=hr.firstChild,Jr=Pr.nextSibling,Tr=Jr.nextSibling,zr=Tr.nextSibling,Xr=Yt.nextSibling;return a(ft,()=>e("invoices.services")),a(Pr,()=>e("invoices.type")),a(Jr,()=>e("invoices.qty")),a(Tr,()=>e("invoices.arancel")),a(zr,()=>e("invoices.total")),a(Xr,I(Ct,{get each(){return t.invoice?.services},children:pr=>(()=>{var Jt=s8(),Yr=Jt.firstChild,Lr=Yr.nextSibling,We=Lr.nextSibling,Bt=We.nextSibling;return a(Yr,()=>pr.type),a(Lr,()=>ls(pr.qty).toFixed(2)),a(We,(()=>{var Ft=Te(()=>!!pr.arancel);return()=>Ft()?l(pr.arancel):"-"})()),a(Bt,()=>l((ls(pr.qty)||0)*(pr.arancel?ls(pr.arancel):0))),fe(Ft=>{var Ht=q,Ke={...q,"text-align":"center"},Zt={...q,"text-align":"right"},Wt={...q,"text-align":"right"};return Ft.e=p(Yr,Ht,Ft.e),Ft.t=p(Lr,Ke,Ft.t),Ft.a=p(We,Zt,Ft.a),Ft.o=p(Bt,Wt,Ft.o),Ft},{e:void 0,t:void 0,a:void 0,o:void 0}),Jt})()})),fe(pr=>{var Jt=f,Yr=w,Lr=K,We=j,Bt={...j,"text-align":"center"},Ft={...j,"text-align":"right"},Ht={...j,"text-align":"right"};return pr.e=p(et,Jt,pr.e),pr.t=p(ft,Yr,pr.t),pr.a=p(At,Lr,pr.a),pr.o=p(Pr,We,pr.o),pr.i=p(Jr,Bt,pr.i),pr.n=p(Tr,Ft,pr.n),pr.s=p(zr,Ht,pr.s),pr},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),et}}),qt),Mt.style.setProperty("display","inline-block"),Mt.style.setProperty("min-width","350px"),a(Mt,I(Oe,{get when(){return t.invoice?.products?.length>0},get children(){var et=lh(),ft=et.firstChild,At=ft.firstChild,Yt=ft.nextSibling;return et.style.setProperty("display","flex"),et.style.setProperty("justify-content","space-between"),et.style.setProperty("margin-bottom","0.5rem"),a(ft,()=>e("invoices.productsSubtotal"),At),a(Yt,()=>l(t?.parseData?.productSubtotal)),et}}),Qt),a(Mt,I(Oe,{get when(){return t.invoice?.reservas?.length>0},get children(){var et=lh(),ft=et.firstChild,At=ft.firstChild,Yt=ft.nextSibling;return et.style.setProperty("display","flex"),et.style.setProperty("justify-content","space-between"),et.style.setProperty("margin-bottom","0.5rem"),a(ft,()=>e("invoices.reservationsSubtotal"),At),a(Yt,()=>l(t?.parseData?.reservaSubtotal)),et}}),Qt),a(Mt,I(Oe,{get when(){return t.invoice?.services?.length>0},get children(){var et=lh(),ft=et.firstChild,At=ft.firstChild,Yt=ft.nextSibling;return et.style.setProperty("display","flex"),et.style.setProperty("justify-content","space-between"),et.style.setProperty("margin-bottom","0.5rem"),a(ft,()=>e("invoices.servicesSubtotal"),At),a(Yt,()=>l(t?.parseData?.serviceSubtotal)),et}}),Qt),a(Mt,I(Oe,{get when(){return t?.parseData?.subtotalBeforeTax},get children(){var et=lh(),ft=et.firstChild,At=ft.firstChild,Yt=ft.nextSibling;return et.style.setProperty("display","flex"),et.style.setProperty("justify-content","space-between"),et.style.setProperty("margin-bottom","0.5rem"),a(ft,()=>e("common.subtotal"),At),a(Yt,()=>l(t?.parseData?.subtotalBeforeTax)),et}}),lr),a(Mt,I(Oe,{get when(){return t?.parseData?.taxAmount},get children(){var et=n8(),ft=et.firstChild,At=ft.firstChild,Yt=At.nextSibling;Yt.nextSibling;var hr=ft.nextSibling;return et.style.setProperty("display","flex"),et.style.setProperty("justify-content","space-between"),et.style.setProperty("margin-bottom","0.5rem"),a(ft,()=>e("common.tax"),At),a(ft,()=>t?.parseData.paymentMethods?.taxPercent||7,Yt),a(hr,()=>l(t?.parseData?.taxAmount)),et}}),lr),a(bt,()=>e("invoices.total"),yr),Cr.style.setProperty("color","var(--primary-color)"),a(Cr,()=>l(c().total)),pt.addEventListener("mouseleave",et=>et.currentTarget.style.opacity="1"),pt.addEventListener("mouseenter",et=>et.currentTarget.style.opacity="0.9"),pt.$$click=v,a(pt,()=>e("invoices.printInvoice"),null),Xn(gt,"click",KD,!0),Vt.addEventListener("mouseleave",et=>{et.currentTarget.style.background="white",et.currentTarget.style.color="var(--primary-color)"}),Vt.addEventListener("mouseenter",et=>{et.currentTarget.style.background="var(--primary-color)",et.currentTarget.style.color="white"}),Vt.$$click=S,a(Vt,()=>e("invoices.exportPdf"),null),a(sr,I(Oe,{get when(){return vr.state?.profile?.isAdmin},get children(){var et=i8();return et.$$click=z,et.addEventListener("mouseleave",ft=>ft.currentTarget.style.opacity="1"),et.addEventListener("mouseenter",ft=>ft.currentTarget.style.opacity="0.9"),fe(ft=>p(et,$,ft)),et}}),null),a(gr,`
        @media print {
          .invoice-display {
            box-shadow: none !important;
            padding: 0 !important;
          }
          
          ${C} {
            display: none !important;
          }
        }
      `),fe(et=>{var ft=g,At=f,Yt=w,hr=E,Pr=x,Jr=T,Tr=Y,zr=w,Xr=E,pr=x,Jt=T,Yr=Y,Lr={...T,"margin-top":"0.75rem"},We=Y,Bt={...T,"margin-top":"0.75rem"},Ft=Y,Ht=x,Ke=T,Zt={...T,"margin-top":"0.75rem"},Wt=Y,xr={...T,"margin-top":"0.75rem"},Hr=Y,mr={...f,"text-align":"right"},Vr={...J,display:"flex","justify-content":"space-between","padding-top":"0.75rem","border-top":"2px solid #dee2e6"},Qr={...J,display:"flex","justify-content":"space-between","padding-top":"0.75rem","border-top":"2px solid #dee2e6"},hn={...f,"text-align":"center",color:"#666","font-size":"0.875rem"},Nt=C,tr=$,ur={...$,background:"#28a745"},Ar=D;return et.e=p(A,ft,et.e),et.t=p(B,At,et.t),et.a=p(M,Yt,et.a),et.o=p(G,hr,et.o),et.i=p(Q,Pr,et.i),et.n=p(ie,Jr,et.n),et.s=p(me,Tr,et.s),et.h=p(ee,zr,et.h),et.r=p(de,Xr,et.r),et.d=p(he,pr,et.d),et.l=p(le,Jt,et.l),et.u=p(ye,Yr,et.u),et.c=p(Ne,Lr,et.c),et.w=p(xe,We,et.w),et.m=p($e,Bt,et.m),et.f=p(Ee,Ft,et.f),et.y=p(Me,Ht,et.y),et.g=p(Ye,Ke,et.g),et.p=p(ze,Zt,et.p),et.b=p(je,Wt,et.b),et.T=p(Xe,xr,et.T),et.A=p(ht,Hr,et.A),et.O=p(qt,mr,et.O),et.I=p(Qt,Vr,et.I),et.S=p(lr,Qr,et.S),et.W=p(Kt,hn,et.W),et.C=p(sr,Nt,et.C),et.B=p(pt,tr,et.B),et.v=p(gt,ur,et.v),et.k=p(Vt,Ar,et.k),et},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0}),re})()};br(["click"]);const _d={invoice:"",description:"",store:"",guide:"",shipper_consignee:{name:"",firstName:"",middleName:"",lastName:"",lastName2:"",phoneNumber:"",phoneNumberS:"",cid:"",passport:"",address:""},products:[],reservas:[],services:[],bulks:[],packagesOrder:!1,shippingMethod:"",paymentMethods:{taxOnTotal:!1,taxPercent:0,exemptTaxOnCash:!1,cash:0,zelle:0,creditCard:0}},dg="invoice_styled_form_draft",l8=()=>{try{const t=localStorage.getItem(dg);if(t){const e=JSON.parse(t);return{..._d,...e,shipper_consignee:{..._d.shipper_consignee,...e.shipper_consignee||{}},paymentMethods:{..._d.paymentMethods,...e.paymentMethods||{}},products:e.products||[],reservas:e.reservas||[],services:e.services||[],bulks:e.bulks||[]}}}catch(t){console.warn("Failed to load styled invoice form from storage:",t)}return console.log("No saved data found, using default form data"),{..._d}},ug=t=>{try{localStorage.setItem(dg,JSON.stringify(t))}catch(e){console.warn("Failed to save styled invoice form to storage:",e)}},zb=()=>{try{localStorage.removeItem(dg)}catch(t){console.warn("Failed to clear styled invoice form from storage:",t)}},[bl,Di]=we(l8()),[Z_,mi]=we(!1),[c8,xh]=we(null);let Km=null;const Ki=()=>{Km&&clearTimeout(Km),Km=setTimeout(()=>{const t=bl();ug(t),xh(new Date),console.log("Styled invoice form auto-saved at",new Date().toLocaleTimeString())},1e3)},Ir={formData:bl,get isDirty(){return Z_()},get lastSaved(){return c8()},updateForm:t=>{console.log(t),Di(e=>{const r={...e,...t};return mi(!0),Ki(),r})},updateShipperConsignee:t=>{Di(e=>{const r={...e,shipper_consignee:{...e.shipper_consignee,...t}};return mi(!0),Ki(),r})},updatePaymentMethods:t=>{Di(e=>{const r={...e,paymentMethods:{...e.paymentMethods,...t}};return mi(!0),Ki(),r})},addProduct:t=>{Di(e=>{const r={...e,products:[...e.products,t]};return mi(!0),Ki(),r})},updateProduct:(t,e)=>{Di(r=>{const n=[...r.products];n[t]={...n[t],...e};const i={...r,products:n};return mi(!0),Ki(),i})},removeProduct:t=>{Di(e=>{const r=e.products.filter((i,o)=>o!==t),n={...e,products:r};return mi(!0),Ki(),n})},addReserva:t=>{Di(e=>{const r={...e,reservas:[...e.reservas,t]};return mi(!0),Ki(),r})},updateReserva:(t,e)=>{Di(r=>{const n=[...r.reservas];n[t]={...n[t],...e};const i={...r,reservas:n};return mi(!0),Ki(),i})},removeReserva:t=>{Di(e=>{const r=e.reservas.filter((i,o)=>o!==t),n={...e,reservas:r};return mi(!0),Ki(),n})},addService:t=>{Di(e=>{const r={...e,services:[...e.services,t]};return mi(!0),Ki(),r})},updateService:(t,e)=>{Di(r=>{const n=[...r.services];n[t]={...n[t],...e};const i={...r,services:n};return mi(!0),Ki(),i})},removeService:t=>{Di(e=>{const r=e.services.filter((i,o)=>o!==t),n={...e,services:r};return mi(!0),Ki(),n})},addBulk:t=>{Di(e=>{const r={...e,bulks:[...e.bulks,t]};return mi(!0),Ki(),r})},updateBulk:(t,e)=>{Di(r=>{const n=[...r.bulks];n[t]={...n[t],...e};const i={...r,bulks:n};return mi(!0),Ki(),i})},removeBulk:t=>{Di(e=>{const r=e.bulks.filter((i,o)=>o!==t),n={...e,bulks:r};return mi(!0),Ki(),n})},clearForm:()=>{Di({..._d}),mi(!1),zb(),xh(null)},markCompleted:()=>{zb(),mi(!1),xh(null)},forceSave:()=>{ug(bl()),xh(new Date),mi(!1)},hasData:()=>{const t=bl();return t.invoice!==""||t.description!==""||t.store!==""||t.shipper_consignee.name!==""||t.shipper_consignee.firstName!==""||t.shipper_consignee.cid!==""||t.products.length>0||t.reservas.length>0||t.services.length>0||t.bulks.length>0||t.paymentMethods.cash>0||t.paymentMethods.zelle>0||t.paymentMethods.creditCard>0},isValid:()=>{const t=bl();return t.invoice.trim()!==""&&t.shipper_consignee.firstName.trim()!==""&&t.shipper_consignee.lastName.trim()!==""&&t.shipper_consignee.cid.trim()!==""&&(t.products.length>0||t.reservas.length>0||t.services.length>0||t.bulks.length>0)},getFormData:()=>bl()};typeof window<"u"&&window.addEventListener("beforeunload",t=>{if(Z_()&&(ug(bl()),Ir.hasData()))return t.preventDefault(),t.returnValue="You have unsaved changes in your invoice. Are you sure you want to leave?",t.returnValue});var d8=ae("<div> "),u8=ae("<div> <div>"),h8=ae("<div><span></span><span>"),ch=ae("<div>"),p8=ae("<div><div><div><input type=text autocomplete=off>"),m8=ae("<button type=button>+"),f8=ae("<div><div></div><div>"),y8=ae("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div></div><div>: "),g8=ae("<span>"),v8=ae("<span> ");const b8=t=>{const{t:e}=_r(),[r,n]=we(!1),[i,o]=we(""),[s,l]=we(-1),[c,d]=we(!1),[u,y]=we(null),[g,f]=we([]),[w,E]=we(null),x=t.searchDelay||300,T=t.maxResults||40,Y=Ut(()=>{if(!t.value)return null;const B=g().find(M=>M.id===t.value);return B||Pt.getProductById(t.value)}),K=async B=>{if(!B.trim()){f([]);return}d(!0),y(null);const M=Pt.getActiveProducts().filter(G=>G.name.toLowerCase().includes(B.toLowerCase())||G.sku.toLowerCase().includes(B.toLowerCase())||G?.UPC?.toLowerCase().includes(B?.toLowerCase())||G.category.toLowerCase().includes(B.toLowerCase())).slice(0,T);f(M),d(!1)},j=Ut(()=>i().toLowerCase()?g():Pt.getActiveProducts().slice(0,10)),q=()=>{n(!0),o(""),l(-1),y(null),i()||f(Pt.getActiveProducts().slice(0,10))},J=B=>{const G=B.target.value;o(G),n(!0),l(-1),y(null),w()&&clearTimeout(w());const Q=setTimeout(()=>{K(G)},x);E(Q)},C=B=>{t.onChange(B.id),n(!1),o(""),l(-1),y(null),w()&&(clearTimeout(w()),E(null))},P=B=>{const M=j();switch(B.key){case"ArrowDown":B.preventDefault(),l(G=>Math.min(G+1,M.length-1));break;case"ArrowUp":B.preventDefault(),l(G=>Math.max(G-1,-1));break;case"Enter":B.preventDefault(),s()>=0&&M[s()]&&C(M[s()]);break;case"Escape":n(!1),o(""),l(-1),y(null),w()&&(clearTimeout(w()),E(null));break}},$=B=>{setTimeout(()=>{n(!1),o(""),l(-1),w()&&(clearTimeout(w()),E(null))},150)},D=B=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(B),b=B=>Pt.stockLevels.filter(M=>M.productId===B).reduce((M,G)=>M+G.quantity,0);jn(()=>()=>{w()&&clearTimeout(w())});const S={position:"relative",width:"100%",...t.style},v={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},z={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"400px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},re=B=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:B?"var(--strip-color)":"transparent",color:B?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),L={display:"flex","justify-content":"space-between","align-items":"center"},O={flex:"1"},ne={"font-weight":"500","margin-bottom":"0.25rem"},X={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","flex-wrap":"wrap"},W={"text-align":"right","font-size":"0.875rem"},se={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},F={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"},k={padding:"1rem","text-align":"center",color:"#d32f2f",background:"#ffebee","border-radius":"var(--border-radius-sm)",margin:"0.5rem","font-size":"0.875rem"},N=()=>r()&&i()?i():Y()?`${Y().name} (${Y().sku})`:"",A={display:"flex","align-items":"stretch",width:"100%"},V={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},Z={...v,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},H={position:"absolute",right:t.onAddNew?"50px":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)","pointer-events":"none"};return(()=>{var B=p8(),M=B.firstChild,G=M.firstChild,Q=G.firstChild;return p(M,A),G.style.setProperty("position","relative"),G.style.setProperty("flex","1"),Q.addEventListener("blur",$),Q.$$keydown=P,Q.$$click=q,Q.$$input=J,a(G,I(Oe,{get when(){return c()},get children(){var ie=d8();return ie.firstChild,a(ie,()=>e("common.searching","Searching..."),null),fe(me=>p(ie,H,me)),ie}}),null),a(M,(()=>{var ie=Te(()=>!!t.onAddNew);return()=>ie()&&(()=>{var me=m8();return me.addEventListener("mouseleave",oe=>{oe.currentTarget.style.background="var(--surface-color)",oe.currentTarget.style.color="var(--primary-color)"}),me.addEventListener("mouseenter",oe=>{oe.currentTarget.style.background="var(--primary-color)",oe.currentTarget.style.color="white"}),Xn(me,"click",t.onAddNew,!0),p(me,V),fe(()=>ir(me,"title",e("inventory.addProduct","Add new product"))),me})()})(),null),a(B,I(Oe,{get when(){return r()},get children(){var ie=ch();return a(ie,I(Oe,{get when(){return u()},get children(){var me=u8(),oe=me.firstChild,ee=oe.nextSibling;return p(me,k),a(me,u,ee),ee.style.setProperty("margin-top","0.5rem"),ee.style.setProperty("font-size","0.75rem"),a(ee,()=>e("inventory.searchFallback","Showing local results")),me}}),null),a(ie,I(Oe,{get when(){return c()},get children(){var me=h8(),oe=me.firstChild,ee=oe.nextSibling;return p(me,F),a(ee,()=>e("common.searching","Searching products...")),me}}),null),a(ie,I(Oe,{get when(){return Te(()=>!c())()&&j().length>0},get fallback(){return Te(()=>!c())()&&(()=>{var me=ch();return p(me,se),a(me,(()=>{var oe=Te(()=>!!i());return()=>oe()?(()=>{var ee=f8(),de=ee.firstChild,he=de.nextSibling;return a(de,()=>e("inventory.noProductsFound","No products found matching your search.")),he.style.setProperty("margin-top","0.5rem"),he.style.setProperty("font-size","0.75rem"),a(he,()=>e("inventory.tryDifferentTerm","Try a different search term or check spelling.")),ee})():e("inventory.noProductsAvailable","No products available.")})()),me})()},get children(){return[I(Ct,{get each(){return j()},children:(me,oe)=>{const ee=b(me.id),de=ee<=me.minStockLevel;return(()=>{var he=y8(),le=he.firstChild,ye=le.firstChild,ve=ye.firstChild,pe=ve.nextSibling,ge=pe.firstChild,ke=ge.firstChild,Ne=ge.nextSibling,xe=Ne.nextSibling,$e=xe.nextSibling,Ee=$e.nextSibling,Me=ye.nextSibling,Ye=Me.firstChild,ze=Ye.firstChild,je=Ye.nextSibling,Xe=je.nextSibling,ht=Xe.firstChild;return he.addEventListener("mouseenter",()=>l(oe())),he.$$click=()=>C(me),p(le,L),p(ye,O),p(ve,ne),a(ve,()=>me.name,null),a(ve,(()=>{var ut=Te(()=>!!i());return()=>ut()&&(()=>{var Ue=g8();return Ue.style.setProperty("margin-left","0.5rem"),Ue.style.setProperty("font-size","0.75rem"),Ue.style.setProperty("color","var(--primary-color)"),Ue.style.setProperty("font-weight","normal"),a(Ue,()=>g().includes(me)?" API":" Local"),Ue})()})(),null),p(pe,X),a(ge,()=>e("inventory.sku","SKU"),ke),a(ge,()=>me.sku,null),a(xe,()=>me.category),a(Ee,()=>D(me.unitCost)),a(ye,(()=>{var ut=Te(()=>!!me.description);return()=>ut()&&(()=>{var Ue=ch();return Ue.style.setProperty("font-size","0.75rem"),Ue.style.setProperty("color","var(--text-muted)"),Ue.style.setProperty("margin-top","0.25rem"),Ue.style.setProperty("font-style","italic"),a(Ue,(()=>{var it=Te(()=>me.description.length>60);return()=>it()?`${me.description.substring(0,60)}...`:me.description})()),Ue})()})(),null),p(Me,W),Ye.style.setProperty("font-weight","600"),(de?"#f44336":"var(--text-primary)")!=null?Ye.style.setProperty("color",de?"#f44336":"var(--text-primary)"):Ye.style.removeProperty("color"),a(Ye,ee,ze),a(Ye,()=>me.unitOfMeasure,null),je.style.setProperty("color","var(--text-muted)"),a(je,()=>de?(()=>{var ut=v8();return ut.firstChild,ut.style.setProperty("color","#f44336"),a(ut,()=>e("inventory.lowStock","Low Stock"),null),ut})():e("inventory.inStock","In Stock")),Xe.style.setProperty("font-size","0.75rem"),Xe.style.setProperty("color","var(--text-muted)"),Xe.style.setProperty("margin-top","0.25rem"),a(Xe,()=>e("inventory.min","Min"),ht),a(Xe,()=>me.minStockLevel,null),fe(ut=>p(he,re(oe()===s()),ut)),he})()}}),Te(()=>Te(()=>j().length===T)()&&(()=>{var me=ch();return me.style.setProperty("padding","0.5rem"),me.style.setProperty("text-align","center"),me.style.setProperty("font-size","0.75rem"),me.style.setProperty("color","var(--text-muted)"),me.style.setProperty("border-top","1px solid var(--border-color)"),me.style.setProperty("font-style","italic"),a(me,()=>e("inventory.showingTopResults","Showing top {{count}} results",{count:T})),me})())]}}),null),fe(me=>p(ie,z,me)),ie}}),null),fe(ie=>{var me=S,oe=Z,ee=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),de=t.disabled,he=t.required;return ie.e=p(B,me,ie.e),ie.t=p(Q,oe,ie.t),ee!==ie.a&&ir(Q,"placeholder",ie.a=ee),de!==ie.o&&(Q.disabled=ie.o=de),he!==ie.i&&(Q.required=ie.i=he),ie},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),fe(()=>Q.value=N()),B})()};br(["input","click","keydown"]);var _8=ae("<label>"),Jm=ae("<div>"),P8=ae("<button type=button> Limpiar"),S8=ae("<div><span></span><span>Modo Escner Activado: Escanee cdigo de barras del ID cubano"),w8=ae("<div><span></span><span>"),x8=ae("<div><div><input type=text autocomplete=off><button type=button>"),C8=ae("<span> "),A8=ae("<span> "),$8=ae("<span> "),E8=ae("<div><div><div><div> </div><div>");const I8=t=>{const{t:e}=_r(),[r,n]=we(!1),[i,o]=we(""),[s,l]=we(-1),[c,d]=we(!1),[u,y]=we([]),[g,f]=we(null),[w,E]=we(!1),[x,T]=we(""),Y=async V=>{if(!V.trim()||V.trim().length<6){y([]);return}try{d(!0);const Z=await qi.getConsigee(V);console.log(Z);const H=Object.values(Z).map(B=>({id:B.consigneeId,firstName:B.firstName+(B.middleName?" "+B.middleName:""),fullName:B.firstName+(B.middleName?" "+B.middleName:"")+" "+B.lastName+" "+B.lastName2,lastName:B.lastName+" "+B.lastName2,cid:B.cid,phoneNumber:B.phoneNumber,ybbetwen1:B.ybbetwen1,ybcity:B.ybcity,ybestate:B.ybestate,ybreparto:B.ybreparto,ybstreet:B.ybstreet,ybstreetNo:B.ybstreetNo,address:`Calle ${B.ybstreet}${B.ybstreetNo?" # "+B.ybstreetNo:""}${B.ybbetwen1?" / "+B.ybbetwen1:""}${B.ybbetwen2?" y "+B.ybbetwen2:""}${B.ybreparto?", Rpto "+B.ybreparto:""}, ${B.ybcity?B.ybcity:""}, ${B.ybestate?B.ybestate:""}`}));y(H)}catch(Z){console.warn("API search failed, falling back to local search:",Z)}finally{d(!1)}},K=V=>{const H=V.target.value;if(T(H),H.length>=11){g()&&clearTimeout(g());const B=setTimeout(()=>{Y(H),n(!0),l(-1)},300);f(B)}else H.length===0&&(y([]),n(!1))},j=()=>{E(!w()),T(""),o(""),n(!1),y([]),g()&&(clearTimeout(g()),f(null))},q=()=>{T(""),n(!1),y([]),g()&&(clearTimeout(g()),f(null))},J=()=>{n(!0),o(""),l(-1),i()||Y("")},C=V=>{const H=V.target.value;o(H),n(!0),l(-1),g()&&clearTimeout(g());const B=setTimeout(()=>{Y(H)},600);f(B)},P=V=>{t.onChange(V),n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null))},$=V=>{const Z=u();switch(V.key){case"ArrowDown":V.preventDefault(),l(H=>Math.min(H+1,Z.length-1));break;case"ArrowUp":V.preventDefault(),l(H=>Math.max(H-1,-1));break;case"Enter":V.preventDefault(),s()>=0&&Z[s()]&&P(Z[s()]);break;case"Escape":n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null));break}},D=V=>{setTimeout(()=>{n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null))},150)},b=()=>w()?x()||"":r()&&i()?i()||"":t.value&&t.value.cid||"";jn(()=>(Y(""),()=>{g()&&clearTimeout(g())}));const S={position:"relative",width:"100%",...t.style},v={display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},z={"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","font-style":"italic"},re={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},L={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},O=V=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:V?"var(--strip-color)":"transparent",color:V?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),ne={display:"flex","justify-content":"space-between","align-items":"flex-start"},X={flex:"1"},W={"font-weight":"500","margin-bottom":"0.25rem"},se={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex","flex-direction":"column",gap:"0.125rem"},F={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},k={position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:w()?"var(--primary-color)":"var(--border-color)",color:w()?"white":"var(--text-muted)",border:"none","border-radius":"4px",padding:"6px 8px",cursor:"pointer","font-size":"12px","z-index":"10",transition:"all 0.2s ease"},N={position:"relative",width:"100%"},A={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"};return(()=>{var V=x8(),Z=V.firstChild,H=Z.firstChild,B=H.nextSibling;return a(V,I(Oe,{get when(){return t.label},get children(){var M=_8();return p(M,v),a(M,()=>t.label),M}}),Z),a(V,I(Oe,{get when(){return t.description},get children(){var M=Jm();return p(M,z),a(M,()=>t.description),M}}),Z),a(V,I(Oe,{get when(){return w()},get children(){var M=S8(),G=M.firstChild;return G.nextSibling,M.style.setProperty("margin-bottom","0.5rem"),M.style.setProperty("padding","0.5rem"),M.style.setProperty("background-color","var(--primary-color)"),M.style.setProperty("color","white"),M.style.setProperty("border-radius","4px"),M.style.setProperty("font-size","0.875rem"),M.style.setProperty("display","flex"),M.style.setProperty("align-items","center"),M.style.setProperty("gap","0.5rem"),a(M,I(Oe,{get when(){return x().length>0},get children(){var Q=P8();return Q.$$click=q,Q.style.setProperty("background","rgba(255,255,255,0.2)"),Q.style.setProperty("border","none"),Q.style.setProperty("color","white"),Q.style.setProperty("border-radius","2px"),Q.style.setProperty("padding","2px 6px"),Q.style.setProperty("cursor","pointer"),Q.style.setProperty("font-size","0.75rem"),Q}}),null),M}}),Z),Xn(H,"blur",w()?void 0:D),Xn(H,"keydown",w()?void 0:$,!0),Xn(H,"click",w()?void 0:J,!0),Xn(H,"input",w()?K:C,!0),B.$$click=j,a(B,()=>w()?" Scanner":" Manual"),a(V,I(Oe,{get when(){return r()},get children(){var M=Jm();return a(M,I(Oe,{get when(){return c()},get children(){var G=w8(),Q=G.firstChild,ie=Q.nextSibling;return p(G,A),a(ie,()=>e("common.searching","Buscando clientes...")),G}}),null),a(M,I(Oe,{get when(){return Te(()=>!c())()&&u().length>0},get fallback(){return Te(()=>!c())()&&(()=>{var G=Jm();return p(G,F),a(G,(()=>{var Q=Te(()=>!!i());return()=>Q()?e("customer.noCustomersFound","No se encontraron clientes. Puede crear un nuevo cliente llenando el formulario."):e("customer.noCustomersAvailable","No se encontraron clientes previos. Se crear un nuevo cliente.")})()),G})()},get children(){return I(Ct,{get each(){return u()},children:(G,Q)=>(()=>{var ie=E8(),me=ie.firstChild,oe=me.firstChild,ee=oe.firstChild;ee.firstChild;var de=ee.nextSibling;return ie.addEventListener("mouseenter",()=>l(Q())),ie.$$click=()=>P(G),p(me,ne),p(oe,X),p(ee,W),a(ee,()=>G.fullName,null),p(de,se),a(de,I(Oe,{get when(){return G.phoneNumber},get children(){var he=C8();return he.firstChild,a(he,()=>G.phoneNumber,null),he}}),null),a(de,I(Oe,{get when(){return G.cid},get children(){var he=A8();return he.firstChild,a(he,()=>G.cid,null),he}}),null),a(de,I(Oe,{get when(){return G.email},get children(){var he=$8();return he.firstChild,a(he,()=>G.email,null),he}}),null),fe(he=>p(ie,O(Q()===s()),he)),ie})()})}}),null),fe(G=>p(M,L,G)),M}}),null),fe(M=>{var G=S,Q=N,ie={...re,"padding-right":"80px","border-color":w()?"var(--primary-color)":"var(--border-color)","box-shadow":w()?"0 0 0 3px rgba(108, 92, 231, 0.1)":"none"},me=w()?"Escanee cdigo de barras del ID o escriba cdula (11 dgitos)...":t.placeholder||e("customer.searchPlaceholder","Buscar clientes por nombre, telfono, ID..."),oe=t.disabled,ee=t.required,de=k,he=w()?"Cambiar a bsqueda manual":"Activar modo escner";return M.e=p(V,G,M.e),M.t=p(Z,Q,M.t),M.a=p(H,ie,M.a),me!==M.o&&ir(H,"placeholder",M.o=me),oe!==M.i&&(H.disabled=M.i=oe),ee!==M.n&&(H.required=M.n=ee),M.s=p(B,de,M.s),he!==M.h&&ir(B,"title",M.h=he),M},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),fe(()=>H.value=b()),V})()};br(["click","input","keydown"]);var T8=ae("<label>"),Qm=ae("<div>"),k8=ae("<button type=button> Limpiar"),N8=ae("<div><span></span><span>Modo Escner Activado: Escanee cdigo de barras del ID del remitente"),L8=ae("<div><span></span><span>"),R8=ae("<div><div><input type=text autocomplete=off><button type=button>"),D8=ae("<span> "),M8=ae("<div><div><div><div> </div><div>");const F8=t=>{const{t:e}=_r(),[r,n]=we(!1),[i,o]=we(""),[s,l]=we(-1),[c,d]=we(!1),[u,y]=we([]),[g,f]=we(null),[w,E]=we(!1),[x,T]=we(""),Y=600,K=async H=>{if(!H.trim()||H.trim().length<6){y([]);return}try{d(!0);const B=await qi.getShipper(H),M=Object.values(B).map(G=>({id:G.shipperId,name:G.name,dob:G.dob,phoneNumberS:G.phoneNumber,idS:G.cid,street:G.street}));y(M)}catch(B){console.warn("API search failed, falling back to local search:",B)}finally{d(!1)}},j=H=>{const M=H.target.value;if(T(M),M.length>=11){g()&&clearTimeout(g());const G=setTimeout(()=>{K(M),n(!0),l(-1)},300);f(G)}else M.length===0&&(y([]),n(!1))},q=()=>{E(!w()),T(""),o(""),n(!1),y([]),g()&&(clearTimeout(g()),f(null))},J=()=>{T(""),n(!1),y([]),g()&&(clearTimeout(g()),f(null))},C=H=>{const M=H.target.value;o(M),n(!0),l(-1),g()&&clearTimeout(g());const G=setTimeout(()=>{K(M)},Y);f(G)},P=()=>{n(!0),o(""),l(-1),i()||K("")},$=H=>{t.onChange(H),n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null))},D=H=>{const B=u();switch(H.key){case"ArrowDown":H.preventDefault(),l(M=>Math.min(M+1,B.length-1));break;case"ArrowUp":H.preventDefault(),l(M=>Math.max(M-1,-1));break;case"Enter":H.preventDefault(),s()>=0&&B[s()]&&$(B[s()]),w()&&v();break;case"Escape":n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null));break}},b=H=>{setTimeout(()=>{n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null))},150)},S=()=>w()?x()||"":r()&&i()?i():t.value?t.value.name:"";jn(()=>(K(""),()=>{g()&&clearTimeout(g())}));const v=()=>{let H=i();console.log(H);let B=B8(H);if(B?.firstName){let M=B.dob.slice(4,8),G=B.dob.slice(0,2),Q=B.dob.slice(2,4),ie=`${M}-${G}-${Q}`;const me={id:B?.dlNumber?.trim(),name:`${B.firstName} ${B.lastName} `,dob:ie,phoneNumberS:"",idS:B.dlNumber?.trim(),addressS:`${B.address} ${B.city} ${B.state} ${B.zipCode}`};$(me)}},z={position:"relative",width:"100%",...t.style},re={display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},L={"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","font-style":"italic"},O={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},ne={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},X=H=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:H?"var(--strip-color)":"transparent",color:H?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),W={display:"flex","justify-content":"space-between","align-items":"flex-start"},se={flex:"1"},F={"font-weight":"500","margin-bottom":"0.25rem"},k={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex","flex-direction":"column",gap:"0.125rem"},N={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},A={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"},V={position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:w()?"var(--primary-color)":"var(--border-color)",color:w()?"white":"var(--text-muted)",border:"none","border-radius":"4px",padding:"6px 8px",cursor:"pointer","font-size":"12px","z-index":"10",transition:"all 0.2s ease"},Z={position:"relative",width:"100%"};return(()=>{var H=R8(),B=H.firstChild,M=B.firstChild,G=M.nextSibling;return a(H,I(Oe,{get when(){return t.label},get children(){var Q=T8();return p(Q,re),a(Q,()=>t.label),Q}}),B),a(H,I(Oe,{get when(){return t.description},get children(){var Q=Qm();return p(Q,L),a(Q,()=>t.description),Q}}),B),a(H,I(Oe,{get when(){return w()},get children(){var Q=N8(),ie=Q.firstChild;return ie.nextSibling,Q.style.setProperty("margin-bottom","0.5rem"),Q.style.setProperty("padding","0.5rem"),Q.style.setProperty("background-color","var(--primary-color)"),Q.style.setProperty("color","white"),Q.style.setProperty("border-radius","4px"),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("display","flex"),Q.style.setProperty("align-items","center"),Q.style.setProperty("gap","0.5rem"),a(Q,I(Oe,{get when(){return x().length>0},get children(){var me=k8();return me.$$click=J,me.style.setProperty("background","rgba(255,255,255,0.2)"),me.style.setProperty("border","none"),me.style.setProperty("color","white"),me.style.setProperty("border-radius","2px"),me.style.setProperty("padding","2px 6px"),me.style.setProperty("cursor","pointer"),me.style.setProperty("font-size","0.75rem"),me}}),null),Q}}),B),Xn(M,"blur",w()?handleLopValue:b),Xn(M,"keydown",w()?void 0:D,!0),Xn(M,"click",w()?void 0:P,!0),Xn(M,"input",w()?j:C,!0),G.$$click=q,a(G,()=>w()?" Scanner":" Manual"),a(H,I(Oe,{get when(){return r()},get children(){var Q=Qm();return a(Q,I(Oe,{get when(){return c()},get children(){var ie=L8(),me=ie.firstChild,oe=me.nextSibling;return p(ie,A),a(oe,()=>e("common.searching","Buscando clientes...")),ie}}),null),a(Q,I(Oe,{get when(){return Te(()=>!c())()&&u().length>0},get fallback(){return Te(()=>!c())()&&(()=>{var ie=Qm();return p(ie,N),a(ie,(()=>{var me=Te(()=>!!i());return()=>me()?e("customer.noShippersFound","No se encontraron clientes. Puede crear un nuevo cliente llenando el formulario."):e("customer.noShippersAvailable","No se encontraron clientes previos. Se crear un nuevo cliente.")})()),ie})()},get children(){return I(Ct,{get each(){return u()},children:(ie,me)=>(()=>{var oe=M8(),ee=oe.firstChild,de=ee.firstChild,he=de.firstChild;he.firstChild;var le=he.nextSibling;return oe.addEventListener("mouseenter",()=>l(me())),oe.$$click=()=>$(ie),p(ee,W),p(de,se),p(he,F),a(he,()=>ie.name,null),p(le,k),a(le,I(Oe,{get when(){return ie.phoneNumberS},get children(){var ye=D8();return ye.firstChild,a(ye,()=>ie.phoneNumberS,null),ye}})),fe(ye=>p(oe,X(me()===s()),ye)),oe})()})}}),null),fe(ie=>p(Q,ne,ie)),Q}}),null),fe(Q=>{var ie=z,me=Z,oe={...O,"padding-right":"80px","border-color":w()?"var(--primary-color)":"var(--border-color)","box-shadow":w()?"0 0 0 3px rgba(108, 92, 231, 0.1)":"none"},ee=w()?"Escanee cdigo de barras del ID del remitente o escriba cdula (11 dgitos)...":t.placeholder||e("customer.searchPlaceholder","Buscar clientes por nombre, telfono, ID..."),de=t.disabled,he=t.required,le=V,ye=w()?"Cambiar a bsqueda manual":"Activar modo escner";return Q.e=p(H,ie,Q.e),Q.t=p(B,me,Q.t),Q.a=p(M,oe,Q.a),ee!==Q.o&&ir(M,"placeholder",Q.o=ee),de!==Q.i&&(M.disabled=Q.i=de),he!==Q.n&&(M.required=Q.n=he),Q.s=p(G,le,Q.s),ye!==Q.h&&ir(G,"title",Q.h=ye),Q},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),fe(()=>M.value=S()),H})()},Ub={DBA:"expirationDate",DCS:"lastName",DAC:"firstName",DAD:"middleName",DBD:"issueDate",DBB:"dob",DBC:"gender",DAY:"eyesColor",DAU:"height",DAG:"address",DAI:"city",DAJ:"state",DAK:"zipCode",DAQ:"dlNumber",DCF:"documentDiscriminator",DCG:"issueCountry",DAZ:"hairColor",DCI:"placeOfBirth"},O8={DDE:"Indicator that the last name is truncated",DDF:"Indicator that the first name is truncated",DCD:"Additional privileges granted to the cardholder (e.g., transportation of hazardous material",DDG:"Indicator that the middle name(s) are truncated",DDA:"Compliance Type",DDB:"Card Revision Date",DCA:"Jurisdiction-specific vehicle class",DBA:"Expiry Date",DCS:"lastName",DAC:"firstName",DBD:"issueDate",DBB:"birthDate",DBC:"gender",DAY:"eyeColor",DAU:"height",DAG:"street",DAI:"city",DAJ:"state",DAK:"zipCode",DAQ:"licenseNumber",DCF:"Document Discriminator",DCG:"issueCountry",DAH:"Street 2",DAZ:"hairColor",DCI:"placeOfBirth",DCJ:"Audit information",DCK:"Inventory Control Number",DBN:"Alias / AKA Family Name",DBG:"Alias / AKA Given Name",DBS:"Alias / AKA Suffix Name",DCU:"Name Suffix",DCE:"Physical Description Weight Range",DCL:"Race / Ethnicity",DCM:"Standard vehicle classification",DCN:"Standard endorsement code",DCO:"Standard restriction code",DCP:"Jurisdiction-specific vehicle classification description",DCQ:"Jurisdiction-specific endorsement code description",DCR:"Jurisdiction-specific restriction code description",DDC:"HazMat Endorsement Expiration Date",DDD:"Limited Duration Document Indicator",DAW:"Weight(pounds)",DAX:"Weight(kilograms)",DDH:"Under 18 Until",DDI:"Under 19 Until",DDJ:"Under 21 Until",DDK:"Organ Donor Indicator",DDL:"Veteran Indicator",DAD:"middleName"},B8=t=>{let e=Object.keys(O8),r={};return e.forEach((i,o)=>{if(t.indexOf(i)>=0){let s=t.split(i);s.length===2&&(t=s.join("*!*!*"+i))}}),t.split("*!*!*").forEach((i,o)=>{let s,l;o===1?(s="DAQ",l=i.substring(i.indexOf(s)+3)):(s=i.substring(0,3),l=i.substring(3).trim()),Object.keys(Ub).includes(s)&&(r[Ub[s]]=l)}),r};br(["click","input","keydown"]);var j8=ae("<div> "),Ma=ae("<div>"),V8=ae('<div><h3> Informacion del Cliente</h3><div></div><div></div><div><label>Nombre del Cliente/Empresa *</label><input type=text placeholder="ej., Juan Perez o Empresa ABC"required></div><div><label>Numero de Telefono Principal</label><input type=tel placeholder="ej., +53-5-123-4567"></div><div><label>Fecha de Nacimiento</label><input type=date placeholder=02/14/2000></div><div><label>ID</label><input type=tel placeholder></div><div><label>Direccion</label><textarea placeholder="ej., Calle 23 #456, Apto 4B, Vedado, La Habana, 10400">'),q8=ae('<div><h3> Informacion del Destinatario</h3><div></div><div><label>Primer Nombre</label><input type=text placeholder="ej., Juan"></div><div><label>Apellido</label><input type=text placeholder="ej., Perez"></div><div><label>Numero de Identificacion</label><input type=text placeholder="ej., 12345678901 o A1234567"></div><div><label>Numero de Pasaporte</label><input type=text placeholder="ej., AB1234567"></div><div><label>Numero de Telefono Principal</label><input type=tel placeholder="ej., +53-5-123-4567"></div><div><label>Direccion de Entrega/Facturacion</label><textarea placeholder="ej., Calle 23 #456, Apto 4B, Vedado, La Habana, 10400">'),Xm=ae("<div><strong>Subtotal Sin Asignar: $"),z8=ae("<div><div><span> Reservas Sin Asignar</span><div>Items no asignados a ningn bulto"),U8=ae("<div><div><span> Servicios Sin Asignar</span><div>Items no asignados a ningn bulto"),H8=ae("<div><div></div><div>No hay bultos creados</div><div>Crea un bulto para empezar a agregar productos, reservas y servicios"),G8=ae("<div><div><span> Gestin de Bultos</span><button>+ Crear Bulto"),W8=ae("<div><div><span> Productos Sin Asignar</span><div>Items no asignados a ningn bulto"),Y8=ae("<div><div>Vista previa del calculo:</div><div>Subtotal: $</div><div> Del Subtotal: $<!>(Total: $<!>)</div><div> Del Total: $<!>(Total: $<!>)"),K8=ae("<div><div> Beneficio por Pago en Efectivo:</div><div>Efectivo: $<!> (<!>% del pago)</div><div>Ahorro en impuestos: $</div><div>Impuesto original: $<!>  Impuesto final: $"),J8=ae("<div><label><input type=checkbox><span> Exencion de Impuesto por Pago en Efectivo</span></label><div>Los pagos en efectivo estaran exentos de impuestos. Mientras mayor sea el porcentaje pagado en efectivo, mayor sera la exencion."),Q8=ae("<div><div><label>Impuesto (%)</label><div>Porcentaje de impuesto. Puede aplicarse sobre el subtotal o como porcentaje del total final.</div><input type=number placeholder=0 min=0 max=99 step=0.01><div><div><label><input type=radio name=taxMethod><span>Del Subtotal (tradicional)</span></label><div>Impuesto = Subtotal  <!>%</div><label><input type=radio name=taxMethod><span>Del Total Final</span></label><div>El impuesto representa el <!>% del total final"),X8=ae("<span> Sin impuesto"),Z8=ae('<div><div><span> Metodos de Pago</span></div><div>Distribuya el pago total entre los diferentes metodos de pago disponibles.</div><div><button type=button> Todo Efectivo</button><button type=button title="Pagar todo por Zelle"> Todo Zelle</button><button type=button title="Pagar todo con tarjeta"> Todo Tarjeta</button><button type=button title="Limpiar todos los pagos"> Limpiar</button></div><div><div><label> Efectivo</label><input type=text placeholder=0.00 min=0 step=0.01></div><div><label> Zelle</label><input type=text placeholder=0.00 min=0 step=0.01></div></div><div><label> Tarjeta de Credito</label><input type=text placeholder=0.00 min=0 step=0.01></div><div><div><div>Total de Pagos: <strong>$</strong></div><div>Balance: <strong>$</strong></div></div><div><div>Total a Pagar: <strong>$</strong></div><div>'),eM=ae("<div>Servicios: $"),tM=ae("<span>(Ahorro: $<!>)"),rM=ae("<div>Impuesto (<!>% <!>): $"),nM=ae("<div><div><div>Productos: $</div><div>Reservas: $</div><div>Subtotal: $</div><div>Total: $"),iM=ae("<span><span></span>Auto-guardando cambios..."),oM=ae("<span><span></span>Guardado: "),sM=ae("<button>Limpiar Formulario"),aM=ae("<div><div>"),lM=ae("<button>"),cM=ae("<div><button></button><button> Nueva Factura"),dM=ae('<div><h2> Crear Nueva Factura</h2><div><div><div><h3> Informacion de Factura</h3><div><div><label>Numero de Factura *</label><input type=text></div><div><label>Ubicacion de Tienda *</label></div></div><div><div><label>Metodo de Envio</label><div>Seleccione el metodo de transporte para esta orden.</div><select><option value>Seleccionar metodo...</option><option value=AEREO> Aereo (Avion)</option><option value=SEA> Maritimo (Barco)</option></select></div><div><label>fecha</label><div>Seleccione una fecha si es diferente al dia de hoy.</div><input type=date></div><div><label>No de Guia</label><select><option value=all></option></select></div></div><div><label>Descripcion de Factura</label><textarea placeholder="ej., Venta regular, pedido mayorista, descuento especial aplicado..."></textarea></div><label><input type=checkbox><div><span>Orden de Paquete/Envio</span><div>Marque esto si esta factura incluye servicios de envio o manejo de paquetes.</div></div></label></div></div><div>'),uM=ae("<option>"),hM=ae("<div><span> <!> items</span><span> <!> qty</span><span> $"),pM=ae("<div><div><label>Tipo</label><select><option value=MISCELANEAS> Miscelaneas</option><option value=DURADERO> Duradero</option><option value=MIXED> Mixto</option></select></div><div><label>Mtodo de Envo</label><select><option value=SEA> Martimo</option><option value=AEREO> Areo"),mM=ae("<div><div><span>Utilizacin de Peso </span><span>%</span></div><div><div>"),fM=ae("<div><button> Agregar Reserva</button><button> Agregar Producto</button><button> Agregar Servicio"),yM=ae("<div><h4> Reservas"),gM=ae("<div><strong>Subtotal: $"),vM=ae("<div><h4> Servicios"),bM=ae("<div><div></div><div>Este bulto est vaco</div><div>Usa los botones de arriba para agregar items"),_M=ae("<div><div><div><span> Productos y Articulos</span></div><div><label>Agregar Productos al Bulto"),PM=ae("<div><div><div><div><button></button><button></button></div> </div> </div> "),SM=ae("<span>(Requiere otro bulto)*"),wM=ae("<div><div><span></span><span>$<!>/lbs</span></div><div>"),Hb=ae("<span> ($<!>)"),eP=ae("<div> "),xM=ae("<div> Reserva de un solo Bulto es necesario ponerlo en un bulto independiente"),CM=ae("<div>(<!><!>+<!>)"),tP=ae("<div><label>Bulto:</label><select><option value>Sin asignar"),AM=ae("<div><div><div></div><button></button></div><div><label>Categoria</label><select><option value=MISCELANEAS> Miscelaneas</option><option value=DURADEROS> Duradero</option><option value=LITHIUM_BATTERIES> Baterias Litio</option></select></div><div><div><label>Cant (lbs)</label></div><div><label>Precio</label></div><div><label>Arancel</label></div><div>$"),rP=ae("<option> (<!>/<!>lbs)"),$M=ae("<div><div><div><div></div><div></div></div><button></button></div><div><div>$"),EM=ae("<input step=0.01>"),nP=ae("<div><div><input type=text autocomplete=off><div>"),IM=ae("<div><div><div></div><button></button></div><div><div><label>Cantidad</label></div><div><label>Precio/Cargo</label></div><div><label>Total</label><input type=text disabled>");const Gb=[" Transportacin"," Cajas"," Servicio de Rapeado"," Otros Servicios"],Wb=[" Ropa y Zapatos"," Ropa"," Zapatos"," Sombreros y Gorras"," Abrigos y Chaquetas"," Pantalones y Jeans"," Vestidos"," Ropa de Bao"," Calcetines y Medias"," Ropa Interior"," Ropa de Bebe"," TV"," Telefono Movil"," Computadora/Laptop"," Teclados"," Mouse"," Audifonos"," Cables y Accesorios"," Baterias"," Camaras"," Videocamaras"," Radios"," USB y Memorias"," Impresoras"," Proyectores"," Controles de Videojuegos"," Consolas de Videojuegos"," Antenas"," Bombillas LED"," Linternas"," Utiles del Hogar"," Articulos para el Hogar"," Muebles"," Sofas y Sillones"," Puertas y Ventanas"," Cerraduras y Llaves"," Articulos de Limpieza"," Productos de Limpieza"," Detergentes"," Velas"," Cuadros y Decoraciones"," Plantas y Macetas"," Herramientas de Casa"," Articulos Electricos"," Ventiladores"," Aires Acondicionados"," Calentadores"," Medicamentos"," Productos de Belleza"," Maquillaje"," Shampoo y Acondicionador"," Jabones"," Cepillos de Dientes"," Papel Higienico"," Aseo Personal"," Equipos Medicos"," Suministros Medicos"," Vendas y Curitas"," Termometros"," Lentes Recetados"," Lentes de Sol"," Alimentos"," Pan y Panaderia"," Lacteos"," Alimentos Enlatados"," Pasta y Granos"," Cafe y Te"," Condimentos y Especias"," Miel y Mermeladas"," Bebidas Alcoholicas"," Bebidas y Refrescos"," Dulces y Golosinas"," Articulos Deportivos"," Balones"," Equipos de Baloncesto"," Equipos de Tenis"," Badminton"," Articulos de Natacion"," Bicicletas y Accesorios"," Patinetas"," Equipos de Pesca"," Equipos de Camping"," Juegos de Mesa"," Juguetes"," Libros"," Revistas y Periodicos"," Videojuegos"," Instrumentos Musicales"," Guitarras"," Teclados Musicales"," Instrumentos de Percusion"," Materiales de Arte"," Lapices y Boligrafos"," Cuadernos y Papeleria"," Crayones y Marcadores"," Disfraces"," Cartas y Juegos"," Repuestos de Auto"," Llantas"," Herramientas Automotrices"," Aceites y Lubricantes"," Accesorios para Auto"," Llaves de Auto"," Radios para Auto"," Vidrios para Auto"," Asientos para Auto"," Herramientas"," Martillos"," Sierras"," Tornillos y Clavos"," Repuestos Mecanicos"," Cajas de Herramientas"," Instrumentos de Medicion"," Equipos de Laboratorio"," Equipos de Oficina"," Monitores"," Fax"," Telefonos"," Maletas"," Mochilas"," Bolsos y Carteras"," Equipaje"," Mapas y Guias"," Brujulas"," Joyeria"," Relojes"," Collares"," Piedras Preciosas"," Accesorios de Lujo"," Cadenas"," Anillos"," Aretes"," Sillas de Rueda"," Transportacion"," Cajas"," Servicio de Rapeado"," Servicios de Aseo"," Servicios Profesionales"," Reparaciones"," Servicios de Comunicacion"," Servicios Empresariales"," Servicios de Construccion"," Regalos"," Articulos de Fiesta"," Globos y Decoraciones"," Articulos Religiosos"," Articulos Espirituales"," Amuletos"," Articulos Misticos"," Articulos de Entretenimiento"," Manualidades"," Costura y Tejido"," Tijeras y Cortadores"," Utiles Escolares"," Articulos Educativos"," Lupas y Microscopios"," Instrumentos de Medicion"," Equipos de Comunicacion"," Balanzas"," Candados y Seguridad"," Alarmas"," Sistemas de Vigilancia"],Yb={padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--background-color)"},rt={container:{padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)"},header:{"font-size":"1.5rem","font-weight":"700",color:"var(--text-primary)","margin-bottom":"1.5rem"},grid:{display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem"},section:{background:"var(--background-color)",padding:"1.25rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},sectionTitle:{"font-size":"1.125rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"1rem",display:"flex","align-items":"center",gap:"0.5rem"},formGroup:{"margin-bottom":"1rem"},label:{display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},fieldDescription:{"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","line-height":"1.4","font-style":"italic"},input:{width:"100%",padding:"0.625rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",background:"var(--surface-color)",transition:"border-color 0.2s",outline:"none"},textarea:{width:"100%",padding:"0.625rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",background:"var(--surface-color)",resize:"vertical","min-height":"60px"},button:{padding:"0.625rem 1.25rem",border:"none","border-radius":"var(--border-radius-sm)","font-size":"0.875rem","font-weight":"500",cursor:"pointer",transition:"all 0.2s",display:"inline-flex","align-items":"center",gap:"0.5rem"},primaryButton:{background:"var(--primary-color)",color:"white"},secondaryButton:{background:"var(--secondary-color)",color:"white"},successButton:{background:"#4CAF50",color:"white"},alert:{padding:"0.75rem 1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1rem","font-size":"0.875rem",display:"flex","align-items":"center",gap:"0.5rem"},errorAlert:{background:"#ffebee",border:"1px solid #ffcdd2",color:"#d32f2f"},successAlert:{background:"#e8f5e9",border:"1px solid #c8e6c9",color:"#2e7d32"},productWrapItem:{padding:"0.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"0.5rem"},productItem:{display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem","margin-bottom":"0.5rem"},smallInput:{width:"70px",padding:"0.375rem 0.5rem","font-size":"0.8125rem"},removeButton:{background:"none",border:"none",color:"#f44336",cursor:"pointer","font-size":"1.25rem",padding:"0.25rem"},totalSection:{padding:"1rem","border-radius":"var(--border-radius-sm)","text-align":"right"},gridTwo:{display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"}},TM=()=>{const{t}=_r(),e=Ir.formData,r=Fe=>Ir.updateForm(Fe),[n,i]=we(null),[o,s]=we(""),[l,c]=we(""),[d,u]=we(null);jn(()=>{Ir.hasData()&&(x("Form data restored from previous session"),setTimeout(()=>x(""),3e3))});const[y,g]=we(!1),[f,w]=we(""),[E,x]=we(""),[T,Y]=we(""),[K,j]=we(!1),[q,J]=we(""),[C,P]=we(!1),[$,D]=we(new Set),b=20,S=[" TV"," Television"," Televisor"," Smart TV"," Monitor"," Pantalla"," Plasma"," LED TV"," OLED TV"," Computadora"," Laptop"," PC"," Desktop"," Macbook"," Notebook"," iMac"," Chromebook"," Generador"," Generator"," Generador Electrico"," Planta Electrica"," Inversor"," UPS"," Bateria"," Battery"," Bateria de Litio"," Lithium Battery"," Power Bank"," Banco de Energia"," Bateria Externa"," Cargador Solar"," Solar Charger"," Bateria de Carro"," Amplificador"," Bocinas Grandes"," Sound System"," Camara Profesional"," Video Camera"," Videocamara"," Impresora Grande"," Printer"," Fax Machine"," Mini Nevera"," Ventilador de Torre"," Cafetera Electrica"," Tostadora"," Licuadora"," Procesador de Alimentos"],v={MISCELANEAS:{over50items:2.99,under50items:3.99,description:"Ropa, zapatos, accesorios, artculos personales"},DURADEROS:{price:4.5,description:"Electrnicos, electrodomsticos, herramientas",arancel:{ranges:[{min:0,max:5,cost:5},{min:5,max:20,cost:10},{min:20,max:50,cost:20},{min:50,max:100,cost:35},{min:100,max:1/0,cost:50}]}},LITHIUM_BATTERIES:{price:4.99,description:"Bateras de litio, power banks, equipos con batera de litio",arancel:50},EXCLUSIVE:{price:4.5,description:"TVs, computadoras, generadores (bulto exclusivo)",arancel:30},DOCUMENTS:{price:1.99,description:"Documentos, papeles, certificados"}},z=Fe=>{const Be=Fe?.toUpperCase();return Be?Be.includes("BATERIA")||Be.includes("BATTERY")||Be.includes("POWER BANK")||Be.includes("LITIO")||Be.includes("LITHIUM")?"LITHIUM_BATTERIES":S.some(Re=>{const lt=Re.replace(/^[\u{1F000}-\u{1F9FF}\u{2600}-\u{27BF}]\s*/u,"").toUpperCase();return Be.includes(lt)||Fe.toLowerCase().includes(lt.toLowerCase())})?"EXCLUSIVE":Be.includes("DURADEROS")||Be.includes("TV")||Be.includes("TELEFONO")||Be.includes("PHONE")||Be.includes("ELECTRODOMESTICO")||Be.includes("ELECTRONIC")||Be.includes("CAMARA")||Be.includes("CAMERA")||Be.includes("AUDIO")||Be.includes("HERRAMIENTA")||Be.includes("TOOL")||Be.includes("EQUIPO")?"DURADEROS":Be.includes("DOCUMENTO")||Be.includes("DOCUMENT")||Be.includes("PAPEL")||Be.includes("CERTIFICADO")?"DOCUMENTS":"MISCELANEAS":"MISCELANEAS"},re=(Fe,Be)=>{if(z(Fe),!e().bulks?.find(ot=>ot.id===Be))return v.MISCELANEAS.under50items;const lt=e().reservas.filter(ot=>ot.bulkId===Be&&ot.category==="MISCELANEAS").reduce((ot,nt)=>ot+(nt.qty||0),0);switch(Fe){case"MISCELANEAS":return lt>=50?v.MISCELANEAS.over50items:v.MISCELANEAS.under50items;case"DURADEROS":return v.DURADEROS.price;case"LITHIUM_BATTERIES":return v.LITHIUM_BATTERIES.price;case"EXCLUSIVE":return v.EXCLUSIVE.price;case"DOCUMENTS":return v.DOCUMENTS.price;default:return v.MISCELANEAS.under50items}},L=(Fe,Be)=>{const Re=z(Fe);if(Re==="DURADEROS"&&v.DURADEROS.arancel){const lt=v.DURADEROS.arancel.ranges;for(const ot of lt)if(Be>=ot.min&&Be<ot.max)return ot.cost}return Re==="LITHIUM_BATTERIES"&&v.LITHIUM_BATTERIES.arancel?v.LITHIUM_BATTERIES.arancel:Re==="EXCLUSIVE"&&v.EXCLUSIVE.arancel?v.EXCLUSIVE.arancel:0},O=Fe=>{if(!Fe)return"";const Be=Pt.getLocationById(Fe),Re=Be?.code||Be?.name?.substring(0,3).toUpperCase()||"INV",ot=new Date().toISOString().slice(0,10).replace(/-/g,"");return`${lw(6)}-${Re}-${ot}`};xi(()=>{const Fe=o();if(Fe&&!e().invoice.trim()){const Be=O(Fe);c(Be),r({invoice:Be})}}),xi(()=>{const Fe=n();Fe&&Ir.updateShipperConsignee({name:Fe.name,firstName:Fe.firstName||"",lastName:Fe.lastName||"",phoneNumber:Fe.phoneNumber||"",cid:Fe.cid||"",passport:Fe.passport||"",address:Fe.address||"",addressS:Fe.addressS||"",dob:Fe.dob||"",idS:Fe.idS||"",phoneNumberS:Fe.phoneNumberS||""})}),xi(()=>{});const ne=(Fe,Be)=>{const Re=Pt.getProductById(Fe);if(!Re)return;J(Be.id);const lt={id:Date.now().toString(),product:{id:Re.id,code:Re.sku||"",label:Re.name||"",price:Re.unitCost||0},qty:1,weight:0,salePrice:Re.unitCost||0,total:Re.unitCost||0,bulkId:Be.id};Ir.addProduct(lt),Q(Be.id)},X=Fe=>{s(Fe),r({store:Fe})},W=Fe=>{i(Be=>({...Be,...Fe}))},se=Fe=>{u({name:Fe?.name}),console.log(Fe);let Be={phoneNumberS:Fe?.phoneNumberS,name:Fe?.name,dob:Fe?.dob,addressS:Fe?.addressS,idS:Fe?.idS};console.log(Be),i(Re=>({...Re,...Be}))},F=(Fe,Be,Re)=>{const lt=e().products,ot=lt.findIndex(nt=>nt.id===Fe);if(ot!==-1){const nt={...lt[ot],[Be]:Re};nt.total=nt.qty*nt.salePrice,Ir.updateProduct(ot,nt)}},k=Fe=>{const Be=e().products.findIndex(Re=>Re.id===Fe);Be!==-1&&Ir.removeProduct(Be)},N=()=>{const Fe=q();if(Fe){const Re=G(Fe);if(!Re.isValid){w(Re.error||""),setTimeout(()=>w(""),5e3);return}}const Be={id:Date.now().toString(),type:"",qty:1,weight:0,price:0,arancel:0,total:0,bulkId:Fe};Ir.addReserva(Be),Fe&&Q(Fe)},A=()=>{const Fe={id:Date.now().toString(),type:"",qty:1,price:0,arancel:0,total:0,bulkId:q()};Ir.addService(Fe),q()&&Q(q())},V=()=>{let Fe=Nl();const Be={id:Fe,name:`Bulto #${(e().bulks||[]).length+1}`,type:"MIXED",maxWeight:300,currentWeight:0,shippingMethod:e().shippingMethod||"SEA",status:"DRAFT"};Ir.addBulk(Be);const Re={id:Date.now().toString(),type:"Transportacion",qty:1,price:b,total:b,bulkId:Fe};Ir.addService(Re),Q(Fe)},Z=(Fe,Be)=>{const Re=e().bulks||[],lt=Re.findIndex(ot=>ot.id===Fe);if(lt!==-1){const ot={...Re[lt],...Be};Ir.updateBulk(lt,ot)}},H=Fe=>{const Re=(e().bulks||[]).findIndex(lt=>lt.id===Fe);Re!==-1&&(e().products.forEach((lt,ot)=>{lt.bulkId===Fe&&Ir.updateProduct(ot,{...lt,bulkId:void 0})}),e().reservas.forEach((lt,ot)=>{lt.bulkId===Fe&&Ir.updateReserva(ot,{...lt,bulkId:void 0})}),e().services.forEach((lt,ot)=>{lt.bulkId===Fe&&Ir.updateService(ot,{...lt,bulkId:void 0})}),Ir.removeBulk(Re),q()===Fe&&J(""))},B=(Fe,Be,Re)=>{if(Fe==="product"){const lt=e().products.findIndex(ot=>ot.id===Be);lt!==-1&&Ir.updateProduct(lt,{...e().products[lt],bulkId:Re})}else if(Fe==="reserva"){const lt=e().reservas.findIndex(ot=>ot.id===Be);if(lt!==-1){const ot=e().reservas[lt];let nt={...ot,bulkId:Re};if(ot.type&&Re){const Ve=re(ot.category,Re);nt.price=Ve;const qt=L(ot.category,Number(ot.qty)||0);nt.arancel=qt,nt.total=Number(nt.qty)*Number(nt.price)+Number(nt.arancel)}Ir.updateReserva(lt,nt)}}else if(Fe==="service"){const lt=e().services.findIndex(ot=>ot.id===Be);lt!==-1&&Ir.updateService(lt,{...e().services[lt],bulkId:Re})}Q(Re)},M=(Fe,Be)=>z(Fe)!=="EXCLUSIVE"?{isValid:!0}:[...e().products.filter(ot=>ot.bulkId===Be),...e().reservas.filter(ot=>ot.bulkId===Be),...e().services.filter(ot=>ot.bulkId===Be)].length>0?{isValid:!1,error:` ${Fe} requiere un bulto exclusivo. Este item debe ir solo en su propio bulto.`}:{isValid:!0},G=Fe=>{const Be=[...e().products.filter(lt=>lt.bulkId===Fe),...e().reservas.filter(lt=>lt.bulkId===Fe),...e().services.filter(lt=>lt.bulkId===Fe)];if(Be.some(lt=>{const ot=lt.type||lt.product?.label||"";return z(ot)==="EXCLUSIVE"})){const lt=Be.find(nt=>{const Ve=nt.type||nt.product?.label||"";return z(Ve)==="EXCLUSIVE"});return{isValid:!1,error:` Este bulto contiene ${lt?.type||lt?.product?.label||"equipo exclusivo"} que requiere ir solo. No se pueden agregar ms items.`}}return{isValid:!0}},Q=Fe=>{const Be=e().products.filter(nt=>nt.bulkId===Fe),Re=e().reservas.filter(nt=>nt.bulkId===Fe),lt=e().services.filter(nt=>nt.bulkId===Fe),ot=Be.reduce((nt,Ve)=>nt+(Ve.qty||0),0)+Re.reduce((nt,Ve)=>nt+(Ve.qty||0),0)+lt.reduce((nt,Ve)=>nt+(Ve.qty||0),0);Z(Fe,{currentWeight:ot}),Re.forEach(nt=>{if(z(nt.category)==="MISCELANEAS"){const Ve=re(nt.category,Fe),qt=(nt.qty||0)*Ve+(nt.arancel||0),Mt=e().reservas.findIndex(Qt=>Qt.id===nt.id);Mt!==-1&&Ir.updateReserva(Mt,{...nt,price:Ve,total:qt})}})},ie=Fe=>{const Be=e().products.filter(nt=>nt.bulkId===Fe.id),Re=e().reservas.filter(nt=>nt.bulkId===Fe.id),lt=e().services.filter(nt=>nt.bulkId===Fe.id),ot=Be.reduce((nt,Ve)=>nt+Ve.total,0)+Re.reduce((nt,Ve)=>nt+Ve.total,0)+lt.reduce((nt,Ve)=>nt+Ve.total,0);return Fe.transportCost+ot},me=Fe=>{D(Be=>{const Re=new Set(Be);return Re.has(Fe)?Re.delete(Fe):Re.add(Fe),Re})},oe=(Fe,Be,Re)=>{const lt=e().reservas,ot=lt.findIndex(nt=>nt.id===Fe);if(ot!==-1){const nt=lt[ot];let Ve={...nt,[Be]:Re};if(Be==="category"&&Re){if(nt.bulkId){const Mt=M(String(Re),nt.bulkId);if(!Mt.isValid){w(Mt.error||""),setTimeout(()=>w(""),5e3);return}const Qt=re(String(Re),nt.bulkId);Ve.price=Qt}else switch(z(String(Re))){case"MISCELANEAS":Ve.price=v.MISCELANEAS.under50items;break;case"DURADEROS":Ve.price=v.DURADEROS.price;break;case"LITHIUM_BATTERIES":Ve.price=v.LITHIUM_BATTERIES.price;break;case"EXCLUSIVE":Ve.price=v.EXCLUSIVE.price;break;case"DOCUMENTS":Ve.price=v.DOCUMENTS.price;break;default:Ve.price=v.MISCELANEAS.under50items}const qt=L(String(Re),Number(Ve.qty)||0);Ve.arancel=qt}if(Be==="qty"&&Ve.type){const qt=L(Ve.category,Number(Re)||0);Ve.arancel=qt}(Be==="qty"||Be==="price"||Be==="arancel"||Be==="type")&&(Ve.total=Number(Ve.qty)*Number(Ve.price)+Number(Ve.arancel)),Ir.updateReserva(ot,Ve),nt.bulkId&&Be==="qty"&&Q(nt.bulkId)}},ee=Fe=>{const Be=e().reservas.findIndex(Re=>Re.id===Fe);Be!==-1&&Ir.removeReserva(Be)},de=(Fe,Be,Re)=>{const lt=e().services,ot=lt.findIndex(nt=>nt.id===Fe);if(ot!==-1){const nt={...lt[ot],[Be]:Re};(Be==="qty"||Be==="arancel")&&(nt.total=Number(nt.qty)*Number(nt.arancel)),Ir.updateService(ot,nt)}},he=Fe=>{const Be=e().services.findIndex(Re=>Re.id===Fe);Be!==-1&&Ir.removeService(Be)},le=()=>e().products.reduce((Fe,Be)=>Fe+Be.total,0),ye=()=>e().reservas.reduce((Fe,Be)=>Fe+Be.total,0),ve=()=>e().services.reduce((Fe,Be)=>Fe+Be.total,0),pe=()=>le()+ye()+ve(),ge=()=>{if(e()?.paymentMethods.taxPercent===0)return 0;if(e()?.paymentMethods.exemptTaxOnCash){const Fe=xe()>0?e().paymentMethods.cash/xe():0,Be=Math.min(Fe,1);let Re;return e()?.paymentMethods.taxOnTotal?Re=pe()/(1-e()?.paymentMethods.taxPercent/100)-pe():Re=pe()*(e()?.paymentMethods.taxPercent/100),Re*(1-Be)}return e()?.paymentMethods.taxOnTotal?pe()/(1-e()?.paymentMethods?.taxPercent/100)-pe():pe()*(e()?.paymentMethods?.taxPercent/100)},ke=()=>{if(!e()?.paymentMethods.exemptTaxOnCash||e()?.paymentMethods.taxPercent===0)return 0;const Fe=xe()>0?e().paymentMethods.cash/xe():0,Be=Math.min(Fe,1);let Re;return e()?.paymentMethods.taxOnTotal?Re=pe()/(1-e()?.paymentMethods?.taxPercent/100)-pe():Re=pe()*(e()?.paymentMethods?.taxPercent/100),Re*Be},Ne=()=>pe()+ge(),xe=()=>{const Fe=e().paymentMethods;return Fe.cash+Fe.zelle+Fe.creditCard},$e=()=>Ne()-xe(),Ee=(Fe,Be)=>{Ir.updatePaymentMethods({[Fe]:Be})},Me=(Fe,Be)=>{Ir.updatePaymentMethods({[Fe]:Be})},Ye=Fe=>{const Be=Ne();Ir.updatePaymentMethods({cash:Fe==="cash"?Be:0,zelle:Fe==="zelle"?Be:0,creditCard:Fe==="creditCard"?Be:0})},ze=()=>{Ir.updatePaymentMethods({cash:0,zelle:0,creditCard:0})},je=async()=>{g(!0),w(""),x("");try{if(!e().invoice.trim())throw new Error("Numero de factura es requerido");if(!e().shipper_consignee.name.trim())throw new Error("Nombre del cliente es requerido");if(e().products.length===0&&e().reservas.length===0&&e().services.length===0)throw new Error("Al menos un producto, reserva o servicio es requerido");if(Math.round($e())>.01)throw new Error(`El total de pagos (${xe().toFixed()}) no coincide con el total de la factura (${Ne().toFixed()})`);const Fe={...e(),type:"SALES",ssg_inventory_key:`INVOICE-${Date.now()}`,ssg_sorder_key:`SO-${Date.now()}`,createDate:e().createDate||Date.now(),businessId:"YB100423253156428",isCompleted:!0,productSubtotal:le(),reservaSubtotal:ye(),serviceSubtotal:ve(),subtotalBeforeTax:pe(),taxAmount:ge(),taxSavings:ke(),total:Ne(),shippingMethod:e().shippingMethod,taxCalculationMethod:e()?.paymentMethods.taxOnTotal?"total":"subtotal",cashPaymentRatio:xe()>0?e().paymentMethods.cash/xe():0,paymentMethods:e().paymentMethods},Be=await qi.addInventory(Fe);qi.addInvoice(Be),Y(Be.data),x(" Invoice created successfully! You can now generate a PDF."),Ir.markCompleted(),ht()}catch(Fe){w(Fe.message||"Error creating invoice")}finally{g(!1)}},Xe=async()=>{if(T()){j(!0),w("");try{const{generateEnhancedInvoicePDF:Fe}=await ao(async()=>{const{generateEnhancedInvoicePDF:ot}=await import("./enhancedInvoicePdfGenerator-CJez5tx2.js");return{generateEnhancedInvoicePDF:ot}},[]),Re={invoiceId:T(),shippingMethod:e().shippingMethod,taxPercent:e()?.paymentMethods.taxPercent,taxOnTotal:e()?.paymentMethods.taxOnTotal,exemptTaxOnCash:e()?.paymentMethods.exemptTaxOnCash,paymentMethods:e().paymentMethods,productSubtotal:le(),reservaSubtotal:ye(),subtotalBeforeTax:pe(),taxAmount:ge(),taxSavings:e()?.paymentMethods.exemptTaxOnCash?pe()*e()?.paymentMethods.taxPercent/100-ge():0,total:Ne(),cashPaymentRatio:xe()>0?e().paymentMethods.cash/xe():0},lt=await Fe({...e(),...Re},"es","modern");x(` PDF generated successfully: ${lt}`)}catch(Fe){w(Fe.message||"Error generating PDF")}finally{j(!1)}}},ht=()=>{Ir.clearForm(),Y(""),x(""),w("")},ut=()=>Ir.hasData()&&Ir.isDirty,Ue=()=>{ut()?confirm("Are you sure you want to clear the form? All unsaved changes will be lost.")&&ht():ht()};jn(()=>{});const it=Fe=>{switch(Fe){case"MISCELANEAS":return 80;case"MIXED":return 80;default:return 300}},dt=Ut(()=>{const Fe=new Set([2516,2517,2518,2519,2520,2521,2522,2523].map(Be=>Be));return Array.from(Fe).sort((Be,Re)=>Be-Re)});return(()=>{var Fe=dM(),Be=Fe.firstChild,Re=Be.nextSibling,lt=Re.firstChild,ot=lt.firstChild,nt=ot.firstChild,Ve=nt.nextSibling,qt=Ve.firstChild,Mt=qt.firstChild,Qt=Mt.nextSibling,lr=qt.nextSibling,bt=lr.firstChild,yr=Ve.nextSibling,Cr=yr.firstChild,Kt=Cr.firstChild,sr=Kt.nextSibling,pt=sr.nextSibling,gt=Cr.nextSibling,Vt=gt.firstChild,gr=Vt.nextSibling,et=gr.nextSibling,ft=gt.nextSibling,At=ft.firstChild,Yt=At.nextSibling,hr=Yt.firstChild,Pr=yr.nextSibling,Jr=Pr.firstChild,Tr=Jr.nextSibling,zr=Pr.nextSibling,Xr=zr.firstChild,pr=Xr.nextSibling,Jt=pr.firstChild,Yr=Jt.nextSibling,Lr=lt.nextSibling;return a(Fe,I(Oe,{get when(){return f()},get children(){var We=j8();return We.firstChild,a(We,f,null),fe(Bt=>p(We,{...rt.alert,...rt.errorAlert},Bt)),We}}),Re),a(Fe,I(Oe,{get when(){return E()},get children(){var We=Ma();return a(We,E),fe(Bt=>p(We,{...rt.alert,...rt.successAlert},Bt)),We}}),Re),Qt.$$input=We=>r({invoice:We.target.value}),a(lr,I(Kd,{get value(){return o()},onChange:X,get placeholder(){return t("inventory.selectStoreLocation","Buscar y seleccionar ubicacion de tienda...")},filterType:"store",required:!0}),null),pt.addEventListener("change",We=>r({shippingMethod:We.currentTarget.value})),et.addEventListener("change",We=>r({createDate:We.currentTarget.value})),Yt.addEventListener("change",We=>r({guide:We.currentTarget.value})),Yt.style.setProperty("width","100%"),Yt.style.setProperty("padding","0.5rem"),Yt.style.setProperty("border","1px solid var(--border-color)"),Yt.style.setProperty("border-radius","var(--border-radius-sm)"),Yt.style.setProperty("background","var(--surface-color)"),a(hr,()=>t("common.all","All")),a(Yt,I(Ct,{get each(){return dt()},children:We=>(()=>{var Bt=uM();return Bt.value=We,a(Bt,We),Bt})()}),null),Tr.$$input=We=>r({description:We.target.value}),Xr.addEventListener("change",We=>r({packagesOrder:We.target.checked})),a(lt,I(Oe,{get when(){return Te(()=>!!(e().shippingMethod&&e().invoice&&e().guide))()&&o()},get children(){return[(()=>{var We=V8(),Bt=We.firstChild,Ft=Bt.nextSibling,Ht=Ft.nextSibling,Ke=Ht.nextSibling,Zt=Ke.firstChild,Wt=Zt.nextSibling,xr=Ke.nextSibling,Hr=xr.firstChild,mr=Hr.nextSibling,Vr=xr.nextSibling,Qr=Vr.firstChild,hn=Qr.nextSibling,Nt=Vr.nextSibling,tr=Nt.firstChild,ur=tr.nextSibling,Ar=Nt.nextSibling,Rt=Ar.firstChild,vt=Rt.nextSibling;return a(Ft,I(F8,{get value(){return d()},onChange:se,label:"Buscar Cliente Existente",description:"Busque clientes existentes por nombre, telefono o ID. Si no se encuentra, complete el formulario a continuacion para crear un nuevo cliente.",placeholder:"Escriba nombre del cliente, numero de telefono o ID para buscar..."})),Wt.$$input=St=>Ir.updateShipperConsignee({name:St.target.value}),mr.$$input=St=>Ir.updateShipperConsignee({phoneNumberS:St.target.value}),hn.addEventListener("change",St=>Ir.updateShipperConsignee({dob:St.target.value})),ur.$$input=St=>Ir.updateShipperConsignee({idS:St.target.value}),vt.$$input=St=>Ir.updateShipperConsignee({addressS:St.target.value}),fe(St=>{var jt={...rt.section,"margin-top":"1rem"},Et=rt.sectionTitle,cr=rt.formGroup,Wr=rt.gridTwo,Kr=rt.formGroup,Zr=rt.label,qn=rt.input,Mn=rt.formGroup,Ln=rt.label,en=rt.input,wn=rt.formGroup,nr=rt.label,ei=Yb,pn=rt.formGroup,So=rt.label,co=rt.input,Sr=rt.formGroup,$i=rt.label,Do=rt.textarea;return St.e=p(We,jt,St.e),St.t=p(Bt,Et,St.t),St.a=p(Ft,cr,St.a),St.o=p(Ht,Wr,St.o),St.i=p(Ke,Kr,St.i),St.n=p(Zt,Zr,St.n),St.s=p(Wt,qn,St.s),St.h=p(xr,Mn,St.h),St.r=p(Hr,Ln,St.r),St.d=p(mr,en,St.d),St.l=p(Vr,wn,St.l),St.u=p(Qr,nr,St.u),St.c=p(hn,ei,St.c),St.w=p(Nt,pn,St.w),St.m=p(tr,So,St.m),St.f=p(ur,co,St.f),St.y=p(Ar,Sr,St.y),St.g=p(Rt,$i,St.g),St.p=p(vt,Do,St.p),St},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0}),fe(()=>Wt.value=e().shipper_consignee.name),fe(()=>mr.value=e().shipper_consignee.phoneNumberS||""),fe(()=>hn.value=e().shipper_consignee.dob||""),fe(()=>ur.value=e().shipper_consignee.idS||""),fe(()=>vt.value=e().shipper_consignee.addressS||""),We})(),(()=>{var We=q8(),Bt=We.firstChild,Ft=Bt.nextSibling,Ht=Ft.nextSibling,Ke=Ht.firstChild,Zt=Ke.nextSibling,Wt=Ht.nextSibling,xr=Wt.firstChild,Hr=xr.nextSibling,mr=Wt.nextSibling,Vr=mr.firstChild,Qr=Vr.nextSibling,hn=mr.nextSibling,Nt=hn.firstChild,tr=Nt.nextSibling,ur=hn.nextSibling,Ar=ur.firstChild,Rt=Ar.nextSibling,vt=ur.nextSibling,St=vt.firstChild,jt=St.nextSibling;return a(Ft,I(I8,{get value(){return n()},onChange:W,label:"Buscar Destinatario Existente",description:"Busque Destinatario existentes por telefono o ID. Si no se encuentra, complete el formulario a continuacion para crear un nuevo destinatario.",placeholder:"Escriba nombre del destinatario, numero de telefono o ID para buscar..."})),Zt.$$input=Et=>Ir.updateShipperConsignee({firstName:Et.target.value}),Hr.$$input=Et=>Ir.updateShipperConsignee({lastName:Et.target.value}),Qr.$$input=Et=>Ir.updateShipperConsignee({cid:Et.target.value}),tr.$$input=Et=>Ir.updateShipperConsignee({passport:Et.target.value}),Rt.$$input=Et=>Ir.updateShipperConsignee({phoneNumber:Et.target.value}),jt.$$input=Et=>Ir.updateShipperConsignee({address:Et.target.value}),fe(Et=>{var cr={...rt.section,"margin-top":"1rem"},Wr=rt.sectionTitle,Kr=rt.formGroup,Zr=rt.formGroup,qn=rt.label,Mn=rt.input,Ln=rt.formGroup,en=rt.label,wn=rt.input,nr=rt.formGroup,ei=rt.label,pn=rt.input,So=rt.formGroup,co=rt.label,Sr=rt.input,$i=rt.formGroup,Do=rt.label,Ei=rt.input,Xo=rt.formGroup,yi=rt.label,wo=rt.textarea;return Et.e=p(We,cr,Et.e),Et.t=p(Bt,Wr,Et.t),Et.a=p(Ft,Kr,Et.a),Et.o=p(Ht,Zr,Et.o),Et.i=p(Ke,qn,Et.i),Et.n=p(Zt,Mn,Et.n),Et.s=p(Wt,Ln,Et.s),Et.h=p(xr,en,Et.h),Et.r=p(Hr,wn,Et.r),Et.d=p(mr,nr,Et.d),Et.l=p(Vr,ei,Et.l),Et.u=p(Qr,pn,Et.u),Et.c=p(hn,So,Et.c),Et.w=p(Nt,co,Et.w),Et.m=p(tr,Sr,Et.m),Et.f=p(ur,$i,Et.f),Et.y=p(Ar,Do,Et.y),Et.g=p(Rt,Ei,Et.g),Et.p=p(vt,Xo,Et.p),Et.b=p(St,yi,Et.b),Et.T=p(jt,wo,Et.T),Et},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),fe(()=>Zt.value=e().shipper_consignee.firstName||""),fe(()=>Hr.value=e().shipper_consignee.lastName||""),fe(()=>Qr.value=e().shipper_consignee.cid||""),fe(()=>tr.value=e().shipper_consignee.passport||""),fe(()=>Rt.value=e().shipper_consignee.phoneNumber||""),fe(()=>jt.value=e().shipper_consignee.address||""),We})()]}}),null),a(Lr,I(Oe,{get when(){return Te(()=>!!(e().shippingMethod&&e().invoice&&e().shipper_consignee?.cid))()&&e().shipper_consignee?.name},get children(){return[I(Oe,{get when(){return e().reservas.filter(We=>!We.bulkId).length>0},get children(){var We=z8(),Bt=We.firstChild,Ft=Bt.firstChild,Ht=Ft.nextSibling;return Ht.style.setProperty("font-size","0.875rem"),Ht.style.setProperty("color","#6b7280"),a(We,I(Ct,{get each(){return e().reservas.filter(Ke=>!Ke.bulkId)},children:Ke=>I(Kb,{updateReserva:oe,reserva:Ke,removeReserva:ee,get bulks(){return e().bulks||[]},assignItemToBulk:B})}),null),a(We,I(Oe,{get when(){return e().reservas.filter(Ke=>!Ke.bulkId).length>0},get children(){var Ke=Xm(),Zt=Ke.firstChild;return Zt.firstChild,Ke.style.setProperty("margin-top","0.75rem"),Ke.style.setProperty("padding-top","0.75rem"),Ke.style.setProperty("border-top","1px solid var(--border-color)"),Ke.style.setProperty("text-align","right"),a(Zt,()=>e().reservas.filter(Wt=>!Wt.bulkId).reduce((Wt,xr)=>Wt+xr.total,0).toFixed(),null),Ke}}),null),fe(Ke=>{var Zt={...rt.section,"margin-top":"1rem"},Wt={...rt.sectionTitle,"justify-content":"space-between"};return Ke.e=p(We,Zt,Ke.e),Ke.t=p(Bt,Wt,Ke.t),Ke},{e:void 0,t:void 0}),We}}),I(Oe,{get when(){return e().services.filter(We=>!We.bulkId).length>0},get children(){var We=U8(),Bt=We.firstChild,Ft=Bt.firstChild,Ht=Ft.nextSibling;return Ht.style.setProperty("font-size","0.875rem"),Ht.style.setProperty("color","#6b7280"),a(We,I(Ct,{get each(){return e().services.filter(Ke=>!Ke.bulkId)},children:Ke=>I(Qb,{updateService:de,service:Ke,removeService:he,get bulks(){return e().bulks||[]},assignItemToBulk:B})}),null),a(We,I(Oe,{get when(){return e().services.filter(Ke=>!Ke.bulkId).length>0},get children(){var Ke=Xm(),Zt=Ke.firstChild;return Zt.firstChild,Ke.style.setProperty("margin-top","0.75rem"),Ke.style.setProperty("padding-top","0.75rem"),Ke.style.setProperty("border-top","1px solid var(--border-color)"),Ke.style.setProperty("text-align","right"),a(Zt,()=>e().services.filter(Wt=>!Wt.bulkId).reduce((Wt,xr)=>Wt+xr.total,0).toFixed(2),null),Ke}}),null),fe(Ke=>{var Zt={...rt.section,"margin-top":"1rem"},Wt={...rt.sectionTitle,"justify-content":"space-between"};return Ke.e=p(We,Zt,Ke.e),Ke.t=p(Bt,Wt,Ke.t),Ke},{e:void 0,t:void 0}),We}}),(()=>{var We=G8(),Bt=We.firstChild,Ft=Bt.firstChild,Ht=Ft.nextSibling;return Ht.$$click=V,a(We,I(Oe,{get when(){return(e().bulks||[]).length===0},get children(){var Ke=H8(),Zt=Ke.firstChild,Wt=Zt.nextSibling;return Ke.style.setProperty("text-align","center"),Ke.style.setProperty("padding","2rem"),Ke.style.setProperty("color","#6b7280"),Ke.style.setProperty("border","2px dashed var(--border-color)"),Ke.style.setProperty("border-radius","var(--border-radius-sm)"),Ke.style.setProperty("margin-top","1rem"),Zt.style.setProperty("font-size","3rem"),Zt.style.setProperty("margin-bottom","1rem"),Wt.style.setProperty("font-size","1.125rem"),Wt.style.setProperty("margin-bottom","0.5rem"),Ke}}),null),a(We,I(Ct,{get each(){return e().bulks||[]},children:Ke=>{const Zt=[...e().products.filter(Wt=>Wt.bulkId===Ke.id),...e().reservas.filter(Wt=>Wt.bulkId===Ke.id),...e().services.filter(Wt=>Wt.bulkId===Ke.id)];return(()=>{var Wt=PM(),xr=Wt.firstChild,Hr=xr.firstChild,mr=Hr.firstChild,Vr=mr.firstChild,Qr=Vr.nextSibling,hn=mr.nextSibling;return xr.style.setProperty("display","flex"),xr.style.setProperty("justify-content","space-between"),xr.style.setProperty("align-items","flex-start"),xr.style.setProperty("margin-bottom","1rem"),xr.style.setProperty("padding-bottom","1rem"),xr.style.setProperty("border-bottom","1px solid var(--border-color)"),Hr.style.setProperty("flex","1"),mr.style.setProperty("display","flex"),mr.style.setProperty("align-items","center"),mr.style.setProperty("gap","0.5rem"),mr.style.setProperty("margin-bottom","0.5rem"),Vr.$$click=()=>me(Ke.id),Vr.style.setProperty("background","none"),Vr.style.setProperty("border","none"),Vr.style.setProperty("font-size","1.25rem"),Vr.style.setProperty("cursor","pointer"),Vr.style.setProperty("padding","0.25rem"),Vr.style.setProperty("color","var(--primary-color)"),a(Vr,()=>$().has(Ke.id)?"":""),a(mr,I(Mr,{type:"text",get value(){return Ke.name},onChange:Nt=>Z(Ke.id,{name:Nt}),get style(){return{...rt.input,"font-size":"1.125rem","font-weight":"600","margin-bottom":"0",flex:"1"}}}),Qr),Qr.$$click=()=>H(Ke.id),a(mr,I(Oe,{get when(){return $().has(Ke.id)},get children(){var Nt=hM(),tr=Nt.firstChild,ur=tr.firstChild,Ar=ur.nextSibling;Ar.nextSibling;var Rt=tr.nextSibling,vt=Rt.firstChild,St=vt.nextSibling;St.nextSibling;var jt=Rt.nextSibling;return jt.firstChild,Nt.style.setProperty("display","flex"),Nt.style.setProperty("gap","1rem"),Nt.style.setProperty("align-items","center"),Nt.style.setProperty("font-size","0.875rem"),Nt.style.setProperty("color","#6b7280"),a(tr,()=>Zt?.length,Ar),a(Rt,()=>Ke?.currentWeight?.toFixed(0)||0,St),a(jt,()=>ie(Ke).toFixed(2),null),Nt}}),null),a(Hr,I(Oe,{get when(){return!$().has(Ke.id)},get children(){return[(()=>{var Nt=pM(),tr=Nt.firstChild,ur=tr.firstChild,Ar=ur.nextSibling,Rt=tr.nextSibling,vt=Rt.firstChild,St=vt.nextSibling;return Nt.style.setProperty("display","grid"),Nt.style.setProperty("grid-template-columns","1fr 1fr 1fr"),Nt.style.setProperty("gap","1rem"),Nt.style.setProperty("margin","20px"),Ar.addEventListener("change",jt=>Z(Ke.id,{type:jt.target.value,maxWeight:it(jt.target.value)})),St.addEventListener("change",jt=>Z(Ke.id,{shippingMethod:jt.target.value})),fe(jt=>{var Et=rt.label,cr=rt.input,Wr=rt.label,Kr=rt.input;return jt.e=p(ur,Et,jt.e),jt.t=p(Ar,cr,jt.t),jt.a=p(vt,Wr,jt.a),jt.o=p(St,Kr,jt.o),jt},{e:void 0,t:void 0,a:void 0,o:void 0}),fe(()=>Ar.value=Ke.type),fe(()=>St.value=Ke.shippingMethod),Nt})(),(()=>{var Nt=mM(),tr=Nt.firstChild,ur=tr.firstChild;ur.firstChild;var Ar=ur.nextSibling,Rt=Ar.firstChild,vt=tr.nextSibling,St=vt.firstChild;return Nt.style.setProperty("margin-bottom","1rem"),tr.style.setProperty("display","flex"),tr.style.setProperty("justify-content","space-between"),tr.style.setProperty("margin-bottom","0.5rem"),ur.style.setProperty("font-size","0.875rem"),ur.style.setProperty("font-weight","500"),a(ur,(()=>{var jt=Te(()=>Ke.currentWeight>Ke.maxWeight*.9);return()=>jt()?(()=>{var Et=SM();return Et.style.setProperty("color","#ef4444"),Et})():""})(),null),Ar.style.setProperty("font-size","0.875rem"),a(Ar,()=>(Ke.currentWeight/Ke.maxWeight*100).toFixed(1),Rt),vt.style.setProperty("width","100%"),vt.style.setProperty("height","8px"),vt.style.setProperty("background","#e5e7eb"),vt.style.setProperty("border-radius","4px"),vt.style.setProperty("overflow","hidden"),St.style.setProperty("height","100%"),St.style.setProperty("transition","all 0.3s ease"),fe(jt=>{var Et=`${Math.min(Ke.currentWeight/Ke.maxWeight*100,100)}%`,cr=Ke.currentWeight>Ke.maxWeight*.9?"#ef4444":Ke.currentWeight>Ke.maxWeight*.7?"#f59e0b":"#10b981";return Et!==jt.e&&((jt.e=Et)!=null?St.style.setProperty("width",Et):St.style.removeProperty("width")),cr!==jt.t&&((jt.t=cr)!=null?St.style.setProperty("background",cr):St.style.removeProperty("background")),jt},{e:void 0,t:void 0}),Nt})(),(()=>{var Nt=fM(),tr=Nt.firstChild,ur=tr.nextSibling,Ar=ur.nextSibling;return Nt.style.setProperty("display","flex"),Nt.style.setProperty("gap","0.5rem"),Nt.style.setProperty("margin-bottom","1rem"),Nt.style.setProperty("flex-wrap","wrap"),tr.$$click=()=>{J(Ke.id),N()},ur.$$click=()=>{J(Ke.id);const Rt={id:Date.now().toString(),product:{id:"custom-"+Date.now(),code:"CUSTOM",label:"Producto personalizado",price:0},qty:1,weight:0,salePrice:0,total:0,bulkId:Ke.id};Ir.addProduct(Rt),Q(Ke.id)},Ar.$$click=()=>{J(Ke.id),A()},fe(Rt=>{var vt={...rt.button,...rt.successButton},St={...rt.button,...rt.primaryButton},jt={...rt.button,background:"#f59e0b",color:"white"};return Rt.e=p(tr,vt,Rt.e),Rt.t=p(ur,St,Rt.t),Rt.a=p(Ar,jt,Rt.a),Rt},{e:void 0,t:void 0,a:void 0}),Nt})(),(()=>{var Nt=_M(),tr=Nt.firstChild,ur=tr.firstChild,Ar=ur.nextSibling,Rt=Ar.firstChild;return a(Nt,I(Oe,{get when(){return e().reservas.filter(vt=>vt.bulkId===Ke.id).length>0},get children(){var vt=yM(),St=vt.firstChild;return vt.style.setProperty("margin-bottom","1rem"),a(vt,I(Ct,{get each(){return e().reservas.filter(jt=>jt.bulkId===Ke.id)},children:jt=>(()=>{var Et=Ma();return a(Et,I(Kb,{updateReserva:oe,reserva:jt,removeReserva:ee,bulks:[],assignItemToBulk:()=>{},hideBulkSelector:!0,categorizeReservaType:z,get reservasTotalBulk(){return e().reservas.filter(cr=>cr.bulkId===Ke.id).length}}),null),a(Et,I(Oe,{get when(){return jt.type},get children(){var cr=wM(),Wr=cr.firstChild,Kr=Wr.firstChild,Zr=Kr.nextSibling,qn=Zr.firstChild,Mn=qn.nextSibling;Mn.nextSibling;var Ln=Wr.nextSibling;return cr.style.setProperty("margin-top","0.5rem"),cr.style.setProperty("margin-bottom","0.5rem"),cr.style.setProperty("padding","0.5rem"),cr.style.setProperty("background-color","#f1f5f9"),cr.style.setProperty("border-radius","4px"),cr.style.setProperty("font-size","0.75rem"),Wr.style.setProperty("display","flex"),Wr.style.setProperty("justify-content","space-between"),Wr.style.setProperty("align-items","center"),Kr.style.setProperty("font-weight","500"),a(Kr,()=>z(jt.type)==="EXCLUSIVE"&&" Bulto Exclusivo",null),a(Kr,()=>z(jt.type)==="LITHIUM_BATTERIES"&&" Batera de Litio",null),a(Kr,()=>z(jt.type)==="DURADEROS"&&" Duradero",null),a(Kr,()=>z(jt.type)==="MISCELANEAS"&&" Miscelnea",null),a(Kr,()=>z(jt.type)==="DOCUMENTS"&&" Documento",null),Zr.style.setProperty("font-weight","600"),Zr.style.setProperty("color","#1f2937"),a(Zr,()=>v[z(jt.type)].price||(z(jt.type)==="MISCELANEAS"?e().reservas.filter(en=>en.bulkId===Ke.id&&z(en.type)==="MISCELANEAS").reduce((en,wn)=>en+(wn.qty||0),0)>=50?v.MISCELANEAS.over50items:v.MISCELANEAS.under50items:0),Mn),Ln.style.setProperty("margin-top","0.25rem"),Ln.style.setProperty("color","#6b7280"),a(Ln,()=>v[z(jt.type)].description),fe(en=>(en=z(jt.type)==="EXCLUSIVE"?"#dc2626":z(jt.type)==="LITHIUM_BATTERIES"?"#ea580c":z(jt.type)==="DURADEROS"?"#7c3aed":z(jt.type)==="MISCELANEAS"?"#059669":"#6b7280")!=null?Kr.style.setProperty("color",en):Kr.style.removeProperty("color")),cr}}),null),Et})()}),null),fe(jt=>p(St,{...rt.sectionTitle,"margin-bottom":"0.5rem"},jt)),vt}}),tr),tr.style.setProperty("margin-top","1rem"),a(Ar,I(b8,{value:"",onChange:vt=>ne(vt,Ke),get placeholder(){return t("inventory.searchProductsToAdd","Buscar productos por nombre, SKU o categoria para agregar a la factura...")},searchDelay:300,maxResults:15}),null),a(tr,I(Oe,{get when(){return e().products.filter(vt=>vt.bulkId===Ke.id).length>0},get children(){var vt=Ma();return vt.style.setProperty("margin-bottom","1rem"),a(vt,I(Ct,{get each(){return e().products.filter(St=>St.bulkId===Ke.id)},children:St=>I(Jb,{product:St,updateProduct:F,removeProduct:k,bulks:[],assignItemToBulk:()=>{},hideBulkSelector:!0})})),vt}}),null),a(tr,I(Oe,{get when(){return e().products.length>0},get children(){var vt=gM(),St=vt.firstChild;return St.firstChild,vt.style.setProperty("margin-top","0.75rem"),vt.style.setProperty("padding-top","0.75rem"),vt.style.setProperty("border-top","1px solid var(--border-color)"),vt.style.setProperty("text-align","right"),a(St,()=>le().toFixed(),null),vt}}),null),a(Nt,I(Oe,{get when(){return e().services.filter(vt=>vt.bulkId===Ke.id).length>0},get children(){var vt=vM(),St=vt.firstChild;return vt.style.setProperty("margin-bottom","1rem"),a(vt,I(Ct,{get each(){return e().services.filter(jt=>jt.bulkId===Ke.id)},children:jt=>I(Qb,{updateService:de,service:jt,removeService:he,bulks:[],assignItemToBulk:()=>{},hideBulkSelector:!0})}),null),fe(jt=>p(St,{...rt.sectionTitle,"margin-bottom":"0.5rem"},jt)),vt}}),null),a(Nt,I(Oe,{get when(){return Zt.length===0},get children(){var vt=bM(),St=vt.firstChild,jt=St.nextSibling,Et=jt.nextSibling;return vt.style.setProperty("text-align","center"),vt.style.setProperty("padding","2rem"),vt.style.setProperty("color","#6b7280"),vt.style.setProperty("border","1px dashed var(--border-color)"),vt.style.setProperty("border-radius","var(--border-radius-sm)"),St.style.setProperty("font-size","2rem"),St.style.setProperty("margin-bottom","0.5rem"),Et.style.setProperty("font-size","0.875rem"),vt}}),null),fe(vt=>{var St={...rt.sectionTitle,"justify-content":"space-between"},jt=rt.formGroup,Et=rt.label;return vt.e=p(ur,St,vt.e),vt.t=p(Ar,jt,vt.t),vt.a=p(Rt,Et,vt.a),vt},{e:void 0,t:void 0,a:void 0}),Nt})()]}}),hn),fe(Nt=>{var tr={...rt.section,"margin-top":"1.5rem",border:"2px solid var(--primary-color)","border-radius":"var(--border-radius-md)"},ur=$().has(Ke.id)?"Expandir bulto":"Colapsar bulto",Ar=rt.removeButton;return Nt.e=p(Wt,tr,Nt.e),ur!==Nt.t&&ir(Vr,"title",Nt.t=ur),Nt.a=p(Qr,Ar,Nt.a),Nt},{e:void 0,t:void 0,a:void 0}),Wt})()}}),null),fe(Ke=>{var Zt={...rt.section,"margin-top":"1rem"},Wt={...rt.sectionTitle,"justify-content":"space-between"},xr={...rt.button,...rt.primaryButton};return Ke.e=p(We,Zt,Ke.e),Ke.t=p(Bt,Wt,Ke.t),Ke.a=p(Ht,xr,Ke.a),Ke},{e:void 0,t:void 0,a:void 0}),We})(),I(Oe,{get when(){return e().products.filter(We=>!We.bulkId).length>0},get children(){var We=W8(),Bt=We.firstChild,Ft=Bt.firstChild,Ht=Ft.nextSibling;return Ht.style.setProperty("font-size","0.875rem"),Ht.style.setProperty("color","#6b7280"),a(We,I(Ct,{get each(){return e().products.filter(Ke=>!Ke.bulkId)},children:Ke=>I(Jb,{product:Ke,updateProduct:F,removeProduct:k,get bulks(){return e().bulks||[]},assignItemToBulk:B})}),null),a(We,I(Oe,{get when(){return e().products.filter(Ke=>!Ke.bulkId).length>0},get children(){var Ke=Xm(),Zt=Ke.firstChild;return Zt.firstChild,Ke.style.setProperty("margin-top","0.75rem"),Ke.style.setProperty("padding-top","0.75rem"),Ke.style.setProperty("border-top","1px solid var(--border-color)"),Ke.style.setProperty("text-align","right"),a(Zt,()=>e().products.filter(Wt=>!Wt.bulkId).reduce((Wt,xr)=>Wt+xr.total,0).toFixed(),null),Ke}}),null),fe(Ke=>{var Zt={...rt.section,"margin-top":"1rem"},Wt={...rt.sectionTitle,"justify-content":"space-between"};return Ke.e=p(We,Zt,Ke.e),Ke.t=p(Bt,Wt,Ke.t),Ke},{e:void 0,t:void 0}),We}}),(()=>{var We=Q8(),Bt=We.firstChild,Ft=Bt.firstChild,Ht=Ft.nextSibling,Ke=Ht.nextSibling,Zt=Ke.nextSibling,Wt=Zt.firstChild,xr=Wt.firstChild,Hr=xr.firstChild,mr=xr.nextSibling,Vr=mr.firstChild,Qr=Vr.nextSibling;Qr.nextSibling;var hn=mr.nextSibling,Nt=hn.firstChild,tr=hn.nextSibling,ur=tr.firstChild,Ar=ur.nextSibling;return Ar.nextSibling,a(Bt,I(Oe,{get when(){return Te(()=>e()?.paymentMethods.taxPercent>0)()&&pe()>0},get children(){var Rt=Y8(),vt=Rt.firstChild,St=vt.nextSibling;St.firstChild;var jt=St.nextSibling,Et=jt.firstChild,cr=Et.nextSibling,Wr=cr.nextSibling,Kr=Wr.nextSibling;Kr.nextSibling;var Zr=jt.nextSibling,qn=Zr.firstChild,Mn=qn.nextSibling,Ln=Mn.nextSibling,en=Ln.nextSibling;return en.nextSibling,Rt.style.setProperty("margin-top","0.5rem"),Rt.style.setProperty("padding","0.5rem"),Rt.style.setProperty("background","var(--strip-color)"),Rt.style.setProperty("border-radius","var(--border-radius-sm)"),Rt.style.setProperty("font-size","0.75rem"),Rt.style.setProperty("border","1px solid var(--border-color)"),vt.style.setProperty("font-weight","500"),vt.style.setProperty("margin-bottom","0.25rem"),a(St,()=>pe().toFixed(2),null),a(jt,()=>(pe()*e()?.paymentMethods?.taxPercent/100).toFixed(2),cr),a(jt,()=>(pe()+pe()*e()?.paymentMethods?.taxPercent/100).toFixed(2),Kr),a(Zr,()=>ge().toFixed(2),Mn),a(Zr,()=>Ne().toFixed(2),en),fe(wn=>{var nr=e()?.paymentMethods?.taxOnTotal?"var(--primary-color)":"var(--text-muted)",ei=e()?.paymentMethods?.taxOnTotal?"var(--text-muted)":"var(--primary-color)";return nr!==wn.e&&((wn.e=nr)!=null?jt.style.setProperty("color",nr):jt.style.removeProperty("color")),ei!==wn.t&&((wn.t=ei)!=null?Zr.style.setProperty("color",ei):Zr.style.removeProperty("color")),wn},{e:void 0,t:void 0}),Rt}}),Ke),Ke.$$input=Rt=>Ee("taxPercent",parseFloat(Rt.target.value)||0),Zt.style.setProperty("margin-top","0.5rem"),Zt.style.setProperty("align-items","center"),Zt.style.setProperty("gap","0.5rem"),Wt.style.setProperty("margin-top","0.5rem"),Hr.addEventListener("change",()=>Ee("taxOnTotal",!1)),a(mr,()=>e()?.paymentMethods?.taxPercent,Qr),a(mr,(()=>{var Rt=Te(()=>e()?.paymentMethods?.taxPercent>0&&!e()?.paymentMethods?.taxOnTotal);return()=>Rt()&&(()=>{var vt=Hb(),St=vt.firstChild,jt=St.nextSibling;return jt.nextSibling,vt.style.setProperty("color","var(--primary-color)"),a(vt,()=>(pe()*e()?.paymentMethods?.taxPercent/100).toFixed(2),jt),vt})()})(),null),Nt.addEventListener("change",()=>Ee("taxOnTotal",!0)),a(tr,()=>e()?.paymentMethods?.taxPercent,Ar),a(tr,(()=>{var Rt=Te(()=>!!(e()?.paymentMethods?.taxPercent>0&&e()?.paymentMethods?.taxOnTotal));return()=>Rt()&&(()=>{var vt=Hb(),St=vt.firstChild,jt=St.nextSibling;return jt.nextSibling,vt.style.setProperty("color","var(--primary-color)"),a(vt,()=>ge().toFixed(2),jt),vt})()})(),null),a(Zt,I(Oe,{get when(){return e()?.paymentMethods?.taxPercent>0},get children(){var Rt=J8(),vt=Rt.firstChild,St=vt.firstChild,jt=vt.nextSibling;return Rt.style.setProperty("margin-top","1rem"),Rt.style.setProperty("padding-top","1rem"),Rt.style.setProperty("border-top","1px solid var(--border-color)"),St.addEventListener("change",Et=>Me("exemptTaxOnCash",Et.target.checked)),a(Rt,I(Oe,{get when(){return Te(()=>!!e()?.paymentMethods?.exemptTaxOnCash)()&&xe()>0},get children(){var Et=K8(),cr=Et.firstChild,Wr=cr.nextSibling,Kr=Wr.firstChild,Zr=Kr.nextSibling,qn=Zr.nextSibling,Mn=qn.nextSibling;Mn.nextSibling;var Ln=Wr.nextSibling;Ln.firstChild;var en=Ln.nextSibling,wn=en.firstChild,nr=wn.nextSibling;return nr.nextSibling,Et.style.setProperty("margin-top","0.5rem"),Et.style.setProperty("padding","0.75rem"),Et.style.setProperty("background","#e8f5e9"),Et.style.setProperty("border-radius","var(--border-radius-sm)"),Et.style.setProperty("font-size","0.875rem"),Et.style.setProperty("border","1px solid #c8e6c9"),cr.style.setProperty("font-weight","500"),cr.style.setProperty("color","#2e7d32"),cr.style.setProperty("margin-bottom","0.5rem"),a(Wr,()=>e().paymentMethods.cash.toFixed(2),Zr),a(Wr,()=>(e().paymentMethods.cash/xe()*100).toFixed(1),Mn),Ln.style.setProperty("color","#4CAF50"),Ln.style.setProperty("font-weight","500"),a(Ln,()=>ke().toFixed(2),null),en.style.setProperty("font-size","0.8rem"),en.style.setProperty("color","#666"),en.style.setProperty("margin-top","0.25rem"),a(en,()=>(ge()+ke()).toFixed(2),nr),a(en,()=>ge().toFixed(2),null),Et}}),null),fe(Et=>{var cr={...rt.label,display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"0.5rem"},Wr=rt.fieldDescription;return Et.e=p(vt,cr,Et.e),Et.t=p(jt,Wr,Et.t),Et},{e:void 0,t:void 0}),fe(()=>St.checked=e()?.paymentMethods?.exemptTaxOnCash),Rt}}),null),fe(Rt=>{var vt={...rt.section,"margin-top":"1rem"},St=rt.formGroup,jt=rt.label,Et=rt.fieldDescription,cr=rt.input,Wr={...rt.label,display:"flex","align-items":"center",gap:"0.5rem","font-size":"0.8rem","margin-bottom":"0.25rem"},Kr={...rt.fieldDescription,"margin-left":"1.5rem","margin-bottom":"0.5rem"},Zr={...rt.label,display:"flex","align-items":"center",gap:"0.5rem","font-size":"0.8rem","margin-bottom":"0.25rem"},qn={...rt.fieldDescription,"margin-left":"1.5rem"};return Rt.e=p(We,vt,Rt.e),Rt.t=p(Bt,St,Rt.t),Rt.a=p(Ft,jt,Rt.a),Rt.o=p(Ht,Et,Rt.o),Rt.i=p(Ke,cr,Rt.i),Rt.n=p(xr,Wr,Rt.n),Rt.s=p(mr,Kr,Rt.s),Rt.h=p(hn,Zr,Rt.h),Rt.r=p(tr,qn,Rt.r),Rt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),fe(()=>Ke.value=e()?.paymentMethods?.taxPercent),fe(()=>Hr.checked=!e()?.paymentMethods?.taxOnTotal),fe(()=>Nt.checked=e()?.paymentMethods?.taxOnTotal),We})(),(()=>{var We=Z8(),Bt=We.firstChild,Ft=Bt.nextSibling,Ht=Ft.nextSibling,Ke=Ht.firstChild;Ke.firstChild;var Zt=Ke.nextSibling,Wt=Zt.nextSibling,xr=Wt.nextSibling,Hr=Ht.nextSibling,mr=Hr.firstChild,Vr=mr.firstChild,Qr=Vr.nextSibling,hn=mr.nextSibling,Nt=hn.firstChild,tr=Nt.nextSibling,ur=Hr.nextSibling,Ar=ur.firstChild,Rt=Ar.nextSibling,vt=ur.nextSibling,St=vt.firstChild,jt=St.firstChild,Et=jt.firstChild,cr=Et.nextSibling;cr.firstChild;var Wr=jt.nextSibling,Kr=Wr.firstChild,Zr=Kr.nextSibling;Zr.firstChild;var qn=St.nextSibling,Mn=qn.firstChild,Ln=Mn.firstChild,en=Ln.nextSibling;en.firstChild;var wn=Mn.nextSibling;return Ht.style.setProperty("display","flex"),Ht.style.setProperty("gap","0.5rem"),Ht.style.setProperty("margin-bottom","1rem"),Ht.style.setProperty("flex-wrap","wrap"),Ke.$$click=()=>Ye("cash"),a(Ke,I(Oe,{get when(){return Te(()=>!!e()?.paymentMethods.exemptTaxOnCash)()&&e()?.paymentMethods.taxPercent>0},get children(){var nr=X8();return nr.style.setProperty("font-size","0.6rem"),nr.style.setProperty("display","block"),nr.style.setProperty("line-height","1"),nr}}),null),Zt.$$click=()=>Ye("zelle"),Wt.$$click=()=>Ye("creditCard"),xr.$$click=ze,Qr.$$input=nr=>Ee("cash",parseFloat(nr.target.value)||0),tr.$$input=nr=>Ee("zelle",parseFloat(nr.target.value)||0),Rt.$$input=nr=>Ee("creditCard",parseFloat(nr.target.value)||0),vt.style.setProperty("margin-top","1rem"),vt.style.setProperty("padding-top","1rem"),vt.style.setProperty("border-top","1px solid var(--border-color)"),vt.style.setProperty("display","grid"),vt.style.setProperty("grid-template-columns","1fr 1fr"),vt.style.setProperty("gap","1rem"),vt.style.setProperty("font-size","0.875rem"),a(cr,()=>xe().toFixed(),null),a(Zr,()=>$e().toFixed(),null),qn.style.setProperty("text-align","right"),a(en,()=>Ne().toFixed(),null),wn.style.setProperty("font-weight","500"),a(wn,(()=>{var nr=Te(()=>Math.round($e())===0);return()=>nr()?" Pagado Completo":$e()>0?"Falta Pagar":"Sobrepago"})()),fe(nr=>{var ei={...rt.section,"margin-top":"1rem"},pn=rt.sectionTitle,So=rt.fieldDescription,co={...rt.button,...e()?.paymentMethods.exemptTaxOnCash&&e()?.paymentMethods.taxPercent>0?{background:"#4CAF50",color:"white"}:rt.secondaryButton,"font-size":"0.75rem",padding:"0.5rem 0.75rem",position:"relative"},Sr=e()?.paymentMethods.exemptTaxOnCash&&e()?.paymentMethods.taxPercent>0?`Pagar todo en efectivo (Ahorro: $${(pe()*e()?.paymentMethods.taxPercent/100).toFixed(2)})`:"Pagar todo en efectivo",$i={...rt.button,...rt.secondaryButton,"font-size":"0.75rem",padding:"0.5rem 0.75rem"},Do={...rt.button,...rt.secondaryButton,"font-size":"0.75rem",padding:"0.5rem 0.75rem"},Ei={...rt.button,background:"#f44336",color:"white","font-size":"0.75rem",padding:"0.5rem 0.75rem"},Xo=rt.gridTwo,yi=rt.formGroup,wo=rt.label,xs=rt.input,Zo=rt.formGroup,es=rt.label,ra=rt.input,uo=rt.formGroup,Ui=rt.label,ho=rt.input,Mo=parseFloat($e().toFixed())===0?"#4CAF50":$e()>0?"#f44336":"#FF9800",an=parseFloat($e().toFixed())===0?"#4CAF50":"#f44336";return nr.e=p(We,ei,nr.e),nr.t=p(Bt,pn,nr.t),nr.a=p(Ft,So,nr.a),nr.o=p(Ke,co,nr.o),Sr!==nr.i&&ir(Ke,"title",nr.i=Sr),nr.n=p(Zt,$i,nr.n),nr.s=p(Wt,Do,nr.s),nr.h=p(xr,Ei,nr.h),nr.r=p(Hr,Xo,nr.r),nr.d=p(mr,yi,nr.d),nr.l=p(Vr,wo,nr.l),nr.u=p(Qr,xs,nr.u),nr.c=p(hn,Zo,nr.c),nr.w=p(Nt,es,nr.w),nr.m=p(tr,ra,nr.m),nr.f=p(ur,uo,nr.f),nr.y=p(Ar,Ui,nr.y),nr.g=p(Rt,ho,nr.g),Mo!==nr.p&&((nr.p=Mo)!=null?Wr.style.setProperty("color",Mo):Wr.style.removeProperty("color")),an!==nr.b&&((nr.b=an)!=null?wn.style.setProperty("color",an):wn.style.removeProperty("color")),nr},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0}),fe(()=>Qr.value=e().paymentMethods.cash),fe(()=>tr.value=e().paymentMethods.zelle),fe(()=>Rt.value=e().paymentMethods.creditCard),We})(),(()=>{var We=nM(),Bt=We.firstChild,Ft=Bt.firstChild;Ft.firstChild;var Ht=Ft.nextSibling;Ht.firstChild;var Ke=Ht.nextSibling;Ke.firstChild;var Zt=Ke.nextSibling;return Zt.firstChild,Ft.style.setProperty("font-size","0.875rem"),Ft.style.setProperty("opacity","0.9"),a(Ft,()=>le().toFixed(),null),Ht.style.setProperty("font-size","0.875rem"),Ht.style.setProperty("opacity","0.9"),a(Ht,()=>ye().toFixed(),null),a(Bt,I(Oe,{get when(){return ve()>0},get children(){var Wt=eM();return Wt.firstChild,Wt.style.setProperty("font-size","0.875rem"),Wt.style.setProperty("opacity","0.9"),a(Wt,()=>ve().toFixed(2),null),Wt}}),Ke),Ke.style.setProperty("font-size","0.875rem"),Ke.style.setProperty("opacity","0.9"),Ke.style.setProperty("border-top","1px solid rgba(175,175,175,0.2)"),Ke.style.setProperty("padding-top","0.5rem"),Ke.style.setProperty("margin-top","0.5rem"),a(Ke,()=>pe().toFixed(2),null),a(Bt,I(Oe,{get when(){return e()?.paymentMethods?.taxPercent>0},get children(){var Wt=rM(),xr=Wt.firstChild,Hr=xr.nextSibling,mr=Hr.nextSibling,Vr=mr.nextSibling;return Vr.nextSibling,Wt.style.setProperty("font-size","0.875rem"),Wt.style.setProperty("opacity","0.9"),a(Wt,()=>e()?.paymentMethods?.taxPercent,Hr),a(Wt,()=>e()?.paymentMethods?.taxOnTotal?"del total":"del subtotal",Vr),a(Wt,()=>ge().toFixed(2),null),a(Wt,I(Oe,{get when(){return Te(()=>!!e()?.paymentMethods?.exemptTaxOnCash)()&&ke()>0},get children(){var Qr=tM(),hn=Qr.firstChild,Nt=hn.nextSibling;return Nt.nextSibling,Qr.style.setProperty("color","#4CAF50"),Qr.style.setProperty("margin-left","0.5rem"),a(Qr,()=>ke().toFixed(2),Nt),Qr}}),null),Wt}}),Zt),Zt.style.setProperty("font-size","1.5rem"),Zt.style.setProperty("font-weight","700"),Zt.style.setProperty("margin-top","0.5rem"),Zt.style.setProperty("border-top","1px solid rgba(175,175,175,0.3)"),Zt.style.setProperty("padding-top","0.5rem"),a(Zt,()=>Ne().toFixed(0),null),fe(Wt=>{var xr={...rt.section,"margin-top":"1rem"},Hr=rt.totalSection;return Wt.e=p(We,xr,Wt.e),Wt.t=p(Bt,Hr,Wt.t),Wt},{e:void 0,t:void 0}),We})(),(()=>{var We=Ma();return We.style.setProperty("margin-top","1rem"),We})(),I(Oe,{get when(){return Ir.isDirty||Ir.lastSaved},get children(){var We=aM(),Bt=We.firstChild;return We.style.setProperty("margin-top","1rem"),We.style.setProperty("background","rgba(76, 175, 80, 0.1)"),We.style.setProperty("border","1px solid rgba(76, 175, 80, 0.3)"),We.style.setProperty("border-radius","var(--border-radius-sm)"),We.style.setProperty("padding","0.75rem"),Bt.style.setProperty("display","flex"),Bt.style.setProperty("align-items","center"),Bt.style.setProperty("justify-content","space-between"),Bt.style.setProperty("font-size","0.875rem"),a(Bt,I(Oe,{get when(){return Ir.isDirty},get children(){var Ft=iM(),Ht=Ft.firstChild;return Ft.style.setProperty("color","#4CAF50"),Ft.style.setProperty("display","flex"),Ft.style.setProperty("align-items","center"),Ft.style.setProperty("gap","0.5rem"),Ht.style.setProperty("width","8px"),Ht.style.setProperty("height","8px"),Ht.style.setProperty("background","#4CAF50"),Ht.style.setProperty("border-radius","50%"),Ht.style.setProperty("display","inline-block"),Ht.style.setProperty("animation","pulse 2s infinite"),Ft}}),null),a(Bt,I(Oe,{get when(){return!Ir.isDirty&&Ir.lastSaved},get children(){var Ft=oM(),Ht=Ft.firstChild;return Ht.nextSibling,Ft.style.setProperty("color","#4CAF50"),Ft.style.setProperty("display","flex"),Ft.style.setProperty("align-items","center"),Ft.style.setProperty("gap","0.5rem"),Ht.style.setProperty("width","8px"),Ht.style.setProperty("height","8px"),Ht.style.setProperty("background","#4CAF50"),Ht.style.setProperty("border-radius","50%"),Ht.style.setProperty("display","inline-block"),a(Ft,()=>Ir.lastSaved?.toLocaleTimeString(),null),Ft}}),null),a(Bt,I(Oe,{get when(){return ut()},get children(){var Ft=sM();return Ft.$$click=Ue,Ft.style.setProperty("background","none"),Ft.style.setProperty("border","none"),Ft.style.setProperty("color","#f44336"),Ft.style.setProperty("cursor","pointer"),Ft.style.setProperty("font-size","0.75rem"),Ft.style.setProperty("text-decoration","underline"),Ft}}),null),We}}),I(Oe,{get when(){return Te(()=>!T()&&Ne()>0)()&&!(y()||!e().invoice.trim()||!e().shipper_consignee.name.trim()||Math.round($e())>.01)},get children(){var We=lM();return We.$$click=je,a(We,()=>y()?" Creando Factura...":" Crear Factura"),fe(Bt=>{var Ft=y()||!e().invoice.trim()||!e().shipper_consignee.name.trim()||Math.round($e())>.01,Ht={...rt.button,...rt.primaryButton,width:"100%","justify-content":"center",padding:"0.875rem","font-size":"1rem",opacity:y()||!e().invoice.trim()||!e().shipper_consignee.name.trim()||Math.round($e())>.01?"0.6":"1"},Ke=e().invoice.trim()?e().shipper_consignee.name.trim()?Math.abs($e())>.01?`El balance de pago debe ser $0.00 (actual: $${$e().toFixed(2)})`:"Crear esta factura":"Por favor ingrese el nombre del cliente":"Por favor ingrese un numero de factura";return Ft!==Bt.e&&(We.disabled=Bt.e=Ft),Bt.t=p(We,Ht,Bt.t),Ke!==Bt.a&&ir(We,"title",Bt.a=Ke),Bt},{e:void 0,t:void 0,a:void 0}),We}}),I(Oe,{get when(){return T()},get children(){var We=cM(),Bt=We.firstChild,Ft=Bt.nextSibling;return We.style.setProperty("display","grid"),We.style.setProperty("grid-template-columns","1fr 1fr"),We.style.setProperty("gap","0.75rem"),Bt.$$click=Xe,a(Bt,()=>K()?" Generando...":" Generar PDF"),Ft.$$click=Ue,fe(Ht=>{var Ke=K(),Zt={...rt.button,...rt.successButton,"justify-content":"center",opacity:K()?"0.6":"1"},Wt={...rt.button,...rt.secondaryButton,"justify-content":"center"};return Ke!==Ht.e&&(Bt.disabled=Ht.e=Ke),Ht.t=p(Bt,Zt,Ht.t),Ht.a=p(Ft,Wt,Ht.a),Ht},{e:void 0,t:void 0,a:void 0}),We}})]}})),fe(We=>{var Bt=rt.container,Ft=rt.header,Ht=rt.grid,Ke=rt.section,Zt=rt.sectionTitle,Wt=rt.gridTwo,xr=rt.formGroup,Hr=rt.label,mr=rt.input,Vr=l()||"INV-20241201-1234",Qr=rt.formGroup,hn=rt.label,Nt=rt.gridTwo,tr=rt.formGroup,ur=rt.label,Ar=rt.fieldDescription,Rt=rt.input,vt=rt.formGroup,St=rt.label,jt=rt.fieldDescription,Et=Yb,cr=rt.formGroup,Wr=rt.label,Kr=rt.formGroup,Zr=rt.label,qn=rt.textarea,Mn={...rt.label,display:"flex","align-items":"center",gap:"0.5rem"},Ln=rt.fieldDescription;return We.e=p(Fe,Bt,We.e),We.t=p(Be,Ft,We.t),We.a=p(Re,Ht,We.a),We.o=p(ot,Ke,We.o),We.i=p(nt,Zt,We.i),We.n=p(Ve,Wt,We.n),We.s=p(qt,xr,We.s),We.h=p(Mt,Hr,We.h),We.r=p(Qt,mr,We.r),Vr!==We.d&&ir(Qt,"placeholder",We.d=Vr),We.l=p(lr,Qr,We.l),We.u=p(bt,hn,We.u),We.c=p(yr,Nt,We.c),We.w=p(Cr,tr,We.w),We.m=p(Kt,ur,We.m),We.f=p(sr,Ar,We.f),We.y=p(pt,Rt,We.y),We.g=p(gt,vt,We.g),We.p=p(Vt,St,We.p),We.b=p(gr,jt,We.b),We.T=p(et,Et,We.T),We.A=p(ft,cr,We.A),We.O=p(At,Wr,We.O),We.I=p(Pr,Kr,We.I),We.S=p(Jr,Zr,We.S),We.W=p(Tr,qn,We.W),We.C=p(zr,Mn,We.C),We.B=p(Yr,Ln,We.B),We},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),fe(()=>Qt.value=e().invoice),fe(()=>pt.value=e().shippingMethod),fe(()=>et.value=e().createDate),fe(()=>Yt.value=e().guide),fe(()=>Tr.value=e().description),fe(()=>Xr.checked=e().packagesOrder),Fe})()},Kb=t=>{let{reserva:e,updateReserva:r,removeReserva:n,bulks:i,assignItemToBulk:o,hideBulkSelector:s}=t,l=(t?.categorizeReservaType(e.category)==="LITHIUM_BATTERIES"||t?.categorizeReservaType(e.category)==="EXCLUSIVE")&&t?.reservasTotalBulk>1,c=l?{"border-left":"4px solid #ef4444"}:{};return(()=>{var d=AM(),u=d.firstChild,y=u.firstChild,g=y.nextSibling,f=u.nextSibling,w=f.firstChild,E=w.nextSibling,x=f.nextSibling,T=x.firstChild,Y=T.firstChild,K=T.nextSibling,j=K.firstChild,q=K.nextSibling,J=q.firstChild,C=q.nextSibling;return C.firstChild,y.style.setProperty("flex","1"),a(y,I(kM,{get value(){return e.type},onChange:P=>r(e.id,"type",P),placeholder:"ej., Ropa, Zapatos, TV, Utiles del Hogar...",width:"100%",index:1}),null),a(y,I(Oe,{get when(){return e?.bulkId},get children(){var P=eP();return P.firstChild,P.style.setProperty("font-size","0.75rem"),P.style.setProperty("color","#4CAF50"),P.style.setProperty("margin-top","0.25rem"),a(P,()=>i?.find($=>$.id===e.bulkId)?.name||"Bulto asignado",null),P}}),null),a(y,I(Oe,{when:l,get children(){var P=xM();return P.style.setProperty("font-size","0.75rem"),P.style.setProperty("color","#ef4444"),P.style.setProperty("margin-top","0.25rem"),P}}),null),g.$$click=()=>n(e.id),E.addEventListener("change",P=>r(e.id,"category",P.target.value)),a(T,I(kl,{type:"number",get value(){return e.qty},update:P=>r(e.id,"qty",parseFloat(P)||0),get style(){return{...rt.input,...rt.smallInput,width:"60px"}},placeholder:"Cant",min:"1",step:"0.01",index:2}),null),a(K,I(kl,{type:"number",get value(){return e.price},update:P=>r(e.id,"price",parseFloat(P)||0),get style(){return{...rt.input,...rt.smallInput}},placeholder:"Precio",step:"0.01",index:3}),null),a(q,I(kl,{type:"number",get value(){return e.arancel},update:P=>r(e.id,"arancel",parseFloat(P)||0),get style(){return{...rt.input,...rt.smallInput}},placeholder:"Arancel",step:"0.01",index:4}),null),C.style.setProperty("width","80px"),C.style.setProperty("text-align","right"),C.style.setProperty("font-weight","500"),a(C,()=>e.total?.toFixed(2)||"0.00",null),a(C,I(Oe,{get when(){return!1},get children(){var P=CM(),$=P.firstChild,D=$.nextSibling,b=D.nextSibling,S=b.nextSibling,v=S.nextSibling,z=v.nextSibling;return z.nextSibling,P.style.setProperty("font-size","0.6rem"),P.style.setProperty("color","var(--text-muted)"),a(P,()=>e.qty,D),a(P,()=>e.price,S),a(P,()=>e.arancel,z),P}}),null),a(d,I(Oe,{get when(){return!s&&i&&i.length>0},get children(){var P=tP(),$=P.firstChild,D=$.nextSibling;return D.firstChild,P.style.setProperty("margin-top","0.5rem"),P.style.setProperty("font-size","0.875rem"),$.style.setProperty("margin-right","0.5rem"),D.addEventListener("change",b=>o("reserva",e.id,b.target.value)),a(D,I(Ct,{each:i,children:b=>(()=>{var S=rP(),v=S.firstChild,z=v.nextSibling,re=z.nextSibling,L=re.nextSibling;return L.nextSibling,a(S,()=>b.name,v),a(S,()=>b.currentWeight.toFixed(1),z),a(S,()=>b.maxWeight,L),fe(()=>S.value=b.id),S})()}),null),fe(b=>p(D,{...rt.input,width:"auto",padding:"0.25rem"},b)),fe(()=>D.value=e?.bulkId||""),P}}),null),fe(P=>{var $={...rt.productWrapItem,...c},D=`${e.type}`,b={...rt.productItem,"justify-content":"space-around"},S=rt.removeButton,v=rt.label,z=rt.input,re=rt.productItem,L=rt.formGroup,O=rt.label,ne=rt.formGroup,X=rt.label,W=rt.formGroup,se=rt.label;return P.e=p(d,$,P.e),D!==P.t&&ir(d,"data-reserve",P.t=D),P.a=p(u,b,P.a),P.o=p(g,S,P.o),P.i=p(w,v,P.i),P.n=p(E,z,P.n),P.s=p(x,re,P.s),P.h=p(T,L,P.h),P.r=p(Y,O,P.r),P.d=p(K,ne,P.d),P.l=p(j,X,P.l),P.u=p(q,W,P.u),P.c=p(J,se,P.c),P},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0}),fe(()=>E.value=e.category),d})()},Jb=t=>{let{product:e,updateProduct:r,removeProduct:n}=t;return(()=>{var i=$M(),o=i.firstChild,s=o.firstChild,l=s.firstChild,c=l.nextSibling,d=s.nextSibling,u=o.nextSibling,y=u.firstChild;return y.firstChild,s.style.setProperty("flex","1"),l.style.setProperty("font-weight","500"),l.style.setProperty("font-size","0.875rem"),a(l,()=>e?.product.label),c.style.setProperty("font-size","0.75rem"),c.style.setProperty("color","var(--text-muted)"),a(c,()=>e?.product.code),d.$$click=()=>n(e?.id),a(u,I(kl,{type:"number",get value(){return e?.qty},placeholder:"Cant",update:g=>r(e?.id,"qty",parseFloat(g)||0)}),y),a(u,I(kl,{type:"number",get value(){return e?.salePrice},placeholder:"Precio",update:g=>r(e?.id,"salePrice",parseFloat(g)||0)}),y),y.style.setProperty("width","80px"),y.style.setProperty("text-align","right"),y.style.setProperty("font-weight","500"),a(y,()=>e?.total.toFixed(2),null),fe(g=>{var f=rt.productWrapItem,w=rt.productItem,E=rt.removeButton,x=rt.productItem;return g.e=p(i,f,g.e),g.t=p(o,w,g.t),g.a=p(d,E,g.a),g.o=p(u,x,g.o),g},{e:void 0,t:void 0,a:void 0,o:void 0}),i})()},kl=t=>{const[e,r]=we("");jn(()=>{t?.value!==void 0&&r(t.value.toString())});const n=o=>{(o.key==="Enter"||o.key==="Escape"||o.key==="Tab")&&t.update&&Gs(e())&&t.update(e())},i=()=>{t.update&&Gs(e())&&t.update(e())};return(()=>{var o=EM();return o.addEventListener("blur",i),o.$$keydown=n,o.$$input=s=>r(s.target.value),fe(s=>{var l=t?.type,c={...rt.input,...rt.smallInput,width:t?.width||"90px"},d=t.placeholder,u=t.title,y=t?.index;return l!==s.e&&ir(o,"type",s.e=l),s.t=p(o,c,s.t),d!==s.a&&ir(o,"placeholder",s.a=d),u!==s.o&&ir(o,"title",s.o=u),y!==s.i&&ir(o,"tabindex",s.i=y),s},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),fe(()=>o.value=e()),o})()},kM=t=>{const[e,r]=we(!1),[n,i]=we(""),[o,s]=we(-1),l=()=>{const K=n().toLowerCase();if(!K)return Wb;const j=Wb.filter(q=>q.toLowerCase().includes(K));return j.length===0&&K.length>0?[` Agregar "${n()}"`]:j},c=()=>{r(!0),i(""),s(-1)},d=K=>{const q=K.target.value;i(q),r(q.length>0),s(-1)},u=K=>{let j;K.startsWith(" Agregar")?j=n():j=K.replace(/^[\u{1F000}-\u{1F9FF}\u{2600}-\u{27BF}]\s*/u,""),t.onChange(j),r(!1),i(""),s(-1)},y=K=>{const j=l();switch(K.key){case"ArrowDown":K.preventDefault(),s(q=>Math.min(q+1,j.length-1));break;case"ArrowUp":K.preventDefault(),s(q=>Math.max(q-1,-1));break;case"Enter":K.preventDefault(),o()>=0&&j[o()]?u(j[o()]):(t.onChange(n()||t.value),r(!1));break;case"Escape":r(!1),i(""),s(-1);break}},g=()=>{setTimeout(()=>{n()&&n()!==t.value&&t.onChange(n()),r(!1),i(""),s(-1)},150)},f=()=>e()&&n()?n():t.value||"",w={position:"relative",width:t.width||"100%",flex:t.width?void 0:"1"},E={...rt.input,width:"100%","padding-right":"2rem"},x={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"200px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},T=K=>({padding:"0.5rem 0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:K?"var(--strip-color)":"transparent",color:K?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease","font-size":"0.875rem"}),Y={position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)","pointer-events":"none",color:"var(--text-muted)","font-size":"0.75rem"};return(()=>{var K=nP(),j=K.firstChild,q=j.firstChild,J=q.nextSibling;return j.style.setProperty("position","relative"),q.addEventListener("blur",g),q.$$keydown=y,q.$$click=c,q.$$input=d,a(J,()=>e()?"":""),a(K,I(Oe,{get when(){return Te(()=>!!e())()&&l().length>0},get children(){var C=Ma();return a(C,I(Ct,{get each(){return l()},children:(P,$)=>{const D=P.startsWith(" Agregar");return(()=>{var b=Ma();return b.addEventListener("mouseenter",()=>s($())),b.$$click=()=>u(P),a(b,P),fe(S=>p(b,{...T($()===o()),...D&&{"font-style":"italic","border-left":"3px solid var(--primary-color)",background:$()===o()?"var(--primary-color)":"#f0f8ff",color:$()===o()?"white":"var(--primary-color)"}},S)),b})()}})),fe(P=>p(C,x,P)),C}}),null),fe(C=>{var P=w,$=E,D=t.placeholder,b=t?.index,S=Y;return C.e=p(K,P,C.e),C.t=p(q,$,C.t),D!==C.a&&ir(q,"placeholder",C.a=D),b!==C.o&&ir(q,"tabindex",C.o=b),C.i=p(J,S,C.i),C},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),fe(()=>q.value=f()),K})()},Qb=t=>{let{service:e,updateService:r,removeService:n,bulks:i,assignItemToBulk:o,hideBulkSelector:s}=t;return(()=>{var l=IM(),c=l.firstChild,d=c.firstChild,u=d.nextSibling,y=c.nextSibling,g=y.firstChild,f=g.firstChild,w=g.nextSibling,E=w.firstChild,x=w.nextSibling,T=x.firstChild,Y=T.nextSibling;return d.style.setProperty("flex","1"),a(d,I(NM,{get value(){return e.type},onChange:K=>r(e.id,"type",K),placeholder:"Seleccionar tipo de servicio...",width:"100%",index:1}),null),a(d,I(Oe,{get when(){return e?.bulkId},get children(){var K=eP();return K.firstChild,K.style.setProperty("font-size","0.75rem"),K.style.setProperty("color","#4CAF50"),K.style.setProperty("margin-top","0.25rem"),a(K,()=>i?.find(j=>j.id===e.bulkId)?.name||"Bulto asignado",null),K}}),null),u.$$click=()=>n(e.id),a(g,I(kl,{type:"number",get value(){return e.qty},update:K=>r(e.id,"qty",parseFloat(K)||0),get style(){return{...rt.input,...rt.smallInput,width:"60px"}},placeholder:"Cant",step:"1",min:"0",index:2}),null),a(w,I(kl,{type:"number",get value(){return e.price},update:K=>r(e.id,"price",parseFloat(K)||0),get style(){return{...rt.input,...rt.smallInput}},placeholder:"Precio",step:"0.01",index:4}),null),a(l,I(Oe,{get when(){return!s&&i&&i.length>0},get children(){var K=tP(),j=K.firstChild,q=j.nextSibling;return q.firstChild,K.style.setProperty("margin-top","0.5rem"),K.style.setProperty("font-size","0.875rem"),j.style.setProperty("margin-right","0.5rem"),q.addEventListener("change",J=>o("service",e.id,J.target.value)),a(q,I(Ct,{each:i,children:J=>(()=>{var C=rP(),P=C.firstChild,$=P.nextSibling,D=$.nextSibling,b=D.nextSibling;return b.nextSibling,a(C,()=>J.name,P),a(C,()=>J.currentWeight.toFixed(1),$),a(C,()=>J.maxWeight,b),fe(()=>C.value=J.id),C})()}),null),fe(J=>p(q,{...rt.input,width:"auto",padding:"0.25rem"},J)),fe(()=>q.value=e?.bulkId||""),K}}),null),fe(K=>{var j=rt.productWrapItem,q={...rt.productItem,"justify-content":"space-around"},J=rt.removeButton,C=rt.productItem,P=rt.formGroup,$=rt.label,D=rt.formGroup,b=rt.label,S=rt.formGroup,v=rt.label,z={...rt.input,...rt.smallInput,background:"var(--strip-color)"};return K.e=p(l,j,K.e),K.t=p(c,q,K.t),K.a=p(u,J,K.a),K.o=p(y,C,K.o),K.i=p(g,P,K.i),K.n=p(f,$,K.n),K.s=p(w,D,K.s),K.h=p(E,b,K.h),K.r=p(x,S,K.r),K.d=p(T,v,K.d),K.l=p(Y,z,K.l),K},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),fe(()=>Y.value=`$${e.total.toFixed(2)}`),l})()},NM=t=>{const[e,r]=we(!1),[n,i]=we(""),[o,s]=we(-1),l=()=>{const K=n().toLowerCase();return K?Gb.filter(j=>j.toLowerCase().includes(K)):Gb},c=K=>{const j=K.target.value;i(j),r(!0)},d=()=>{r(!0),i("")},u=K=>{t.onChange(K),r(!1),i(""),s(-1)},y=K=>{const j=l();switch(K.key){case"ArrowDown":K.preventDefault(),s(q=>Math.min(q+1,j.length-1));break;case"ArrowUp":K.preventDefault(),s(q=>Math.max(q-1,-1));break;case"Enter":K.preventDefault(),o()>=0&&o()<j.length&&u(j[o()]);break;case"Escape":r(!1),i(""),s(-1);break}},g=()=>{setTimeout(()=>{r(!1),i(""),s(-1)},150)},f=()=>e()&&n()?n():t.value||"",w={position:"relative",width:t.width||"100%",flex:t.width?void 0:"1"},E={...rt.input,width:"100%","padding-right":"2rem"},x={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"200px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},T=K=>({padding:"0.5rem 0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:K?"var(--strip-color)":"transparent",color:K?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease","font-size":"0.875rem"}),Y={position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)","pointer-events":"none",color:"var(--text-muted)","font-size":"0.75rem"};return(()=>{var K=nP(),j=K.firstChild,q=j.firstChild,J=q.nextSibling;return j.style.setProperty("position","relative"),q.addEventListener("blur",g),q.$$keydown=y,q.$$click=d,q.$$input=c,a(J,()=>e()?"":""),a(K,I(Oe,{get when(){return Te(()=>!!e())()&&l().length>0},get children(){var C=Ma();return a(C,I(Ct,{get each(){return l()},children:(P,$)=>{const D=$()===o();return(()=>{var b=Ma();return b.addEventListener("mouseenter",()=>s($())),b.$$mousedown=()=>u(P),a(b,P),fe(S=>p(b,T(D),S)),b})()}})),fe(P=>p(C,x,P)),C}}),null),fe(C=>{var P=w,$=E,D=t.placeholder,b=t?.index,S=Y;return C.e=p(K,P,C.e),C.t=p(q,$,C.t),D!==C.a&&ir(q,"placeholder",C.a=D),b!==C.o&&ir(q,"tabindex",C.o=b),C.i=p(J,S,C.i),C},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),fe(()=>q.value=f()),K})()};br(["input","click","keydown","mousedown"]);const LM={common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",close:"Close",search:"Search",filter:"Filter",reset:"Reset",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",actions:"Actions",status:"Status",active:"Active",inactive:"Inactive",date:"Date",time:"Time",description:"Description",notes:"Notes",amount:"Amount",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Language",english:"English",spanish:"Spanish",noDataFound:"No data found",required:"Required",optional:"Optional",all:"All",none:"None",select:"Select",clear:"Clear",view:"View",unknown:"Unknown",details:"Details",notAvailable:"N/A",download:"Download",upload:"Upload",print:"Print",export:"Export",import:"Import",exportCSV:"Export CSV",exportExcel:"Export Excel",showing:"Showing",of:"of",dateFrom:"Date From",dateTo:"Date To",showFilters:"Show Filters",hideFilters:"Hide Filters",clearFilters:"Clear Filters"},navigation:{dashboard:"Dashboard",accounts:"Chart of Accounts",balanceSheet:"Balance Sheet",inventory:"Inventory",inventoryManagement:"Inventory Management",employees:"Employees",employeeManagement:"Employee Management",entryBooks:"Entry Books",journalEntries:"Journal Entries",consolidate:"Bank Consolidation",reports:"Reports",settings:"Settings",logout:"Logout",home:"Home",hbl:"House Bill of Lading"},dashboard:{title:"Dashboard",welcome:"Welcome to HRM Finance",overview:"Overview",recentActivity:"Recent Activity",quickActions:"Quick Actions",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalEquity:"Total Equity",totalRevenue:"Total Revenue",totalExpenses:"Total Expenses",netIncome:"Net Income",cashBalance:"Cash Balance",accountsReceivable:"Accounts Receivable",accountsPayable:"Accounts Payable",inventoryValue:"Inventory Value",lowStockItems:"Low Stock Items",pendingInvoices:"Pending Invoices",employeeCount:"Employee Count",monthlyPayroll:"Monthly Payroll"},accounts:{title:"Chart of Accounts",accountNumber:"Account Number",accountName:"Account Name",accountType:"Account Type",category:"Category",balance:"Balance",parentAccount:"Parent Account",subAccounts:"Sub-accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",transactions:"Transactions",accountHistory:"Account History",types:{asset:"Asset",liability:"Liability",equity:"Equity",revenue:"Revenue",expense:"Expense"},categories:{currentAssets:"Current Assets",fixedAssets:"Fixed Assets",currentLiabilities:"Current Liabilities",longTermLiabilities:"Long-term Liabilities",ownersEquity:"Owner's Equity",operatingRevenue:"Operating Revenue",operatingExpenses:"Operating Expenses"},allAccounts:"All Accounts"},banking:{title:"Banking",unreconciled:"Unreconciled",reconciled:"Reconciled",reconciliation:"Reconciliation",notReconciled:"Not Reconciled"},balanceSheet:{title:"Balance Sheet",asOf:"As of",assets:"Assets",liabilities:"Liabilities",equity:"Equity",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalEquity:"Total Equity",currentAssets:"Current Assets",nonCurrentAssets:"Non-current Assets",currentLiabilities:"Current Liabilities",nonCurrentLiabilities:"Non-current Liabilities",retainedEarnings:"Retained Earnings",commonStock:"Common Stock",generateReport:"Generate Report",exportPDF:"Export PDF",exportExcel:"Export Excel"},inventory:{title:"Inventory Management",products:"Products",locations:"Locations",movements:"Movements",overview:"Overview",addProduct:"Add Product",addLocation:"Add Location",addMovement:"Add Movement",bulkMovement:"Bulk Movement",productName:"Product Name",productCode:"Product Code",sku:"SKU",category:"Category",quantity:"Quantity",unitOfMeasure:"Unit of Measure",unitCost:"Unit Cost",totalValue:"Total Value",minStockLevel:"Min Stock Level",maxStockLevel:"Max Stock Level",reorderPoint:"Reorder Point",locationName:"Location Name",locationType:"Location Type",locationCode:"Location Code",address:"Address",movementType:"Movement Type",fromLocation:"From Location",toLocation:"To Location",referenceNumber:"Reference Number",invoiceNumber:"Invoice Number",stockIn:"Stock In",stockOut:"Stock Out",transfer:"Transfer",adjustment:"Adjustment",inStock:"In Stock",lowStock:"Low Stock",outOfStock:"Out of Stock",stockLevels:"Stock Levels",stockByLocation:"Stock by Location",recentMovements:"Recent Movements",searchProducts:"Search products...",searchLocations:"Search locations...",noMovements:"No movements found",productDetails:"Product Details",locationDetails:"Location Details",movementDetails:"Movement Details",totalProducts:"Total Products",activeProducts:"Active Products",totalLocations:"Total Locations",activeLocations:"Active Locations",lowStockAlert:"Low Stock Alert",productsNeedRestocking:"products need restocking",lastSeen:"Last seen",noProducts:"No products at this location",warehouseType:"Warehouse",storeType:"Store",supplierType:"Supplier",customerType:"Customer"},employees:{title:"Employee Management",employeeList:"Employee List",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",payrollInfo:"Payroll Information",firstName:"First Name",lastName:"Last Name",fullName:"Full Name",email:"Email",phone:"Phone",address:"Address",dateOfBirth:"Date of Birth",employeeId:"Employee ID",department:"Department",position:"Position",hireDate:"Hire Date",employmentStatus:"Employment Status",salary:"Salary",payFrequency:"Pay Frequency",taxId:"Tax ID",bankAccount:"Bank Account",emergencyContact:"Emergency Contact",activeEmployees:"Active Employees",inactiveEmployees:"Inactive Employees",totalPayroll:"Total Payroll",searchEmployees:"Search employees..."},journal:{title:"Journal Entries",entryNumber:"Entry Number",entryDate:"Entry Date",debit:"Debit",credit:"Credit",account:"Account",memo:"Memo",reference:"Reference",createEntry:"Create Entry",editEntry:"Edit Entry",deleteEntry:"Delete Entry",addEntry:"Add Journal Entry",updateEntry:"Update Entry",saveAsDraft:"Save as Draft",post:"Post",postEntry:"Post Entry",voidEntry:"Void Entry",posted:"Posted",draft:"Draft",reversed:"Reversed",balanced:"Balanced",notBalanced:"Not Balanced",outOfBalance:"Out of Balance",unbalanced:"Unbalanced",recurringEntry:"Recurring Entry",attachments:"Attachments",draftEntry:"Draft Entry",postedEntry:"Posted Entry",totalDebits:"Total Debits",totalCredits:"Total Credits",totalDebit:"Total Debit",totalCredit:"Total Credit",totalAmount:"Total Amount",debitShort:"Dr.",creditShort:"Cr.",allEntries:"All Entries",noReference:"No reference",createdBy:"By",lines:"Lines",entryLines:"Journal Entry Lines",journalLines:"Journal Lines",addLine:"Add Line",lineDescription:"Line description",accountLines:"Account Lines",noDescription:"No description",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",balanceStatus:"Balance Status",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",fixBalance:"Fix Balance",editEntryTooltip:"Edit this journal entry",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",draftEntryDescription:"This entry can be edited and posted.",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",entryMustBeBalanced:"Entry must be balanced to post",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",entryNotBalancedShort:"Entry is not balanced",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",minTwoLinesRequired:"At least 2 line items are required",entryNotBalanced:"Entry is not balanced. Debit: ${debit}, Credit: ${credit}",lineAccountRequired:"Line {lineNumber}: Account is required",lineAmountRequired:"Line {lineNumber}: Either debit or credit amount must be provided",lineBothAmounts:"Line {lineNumber}: Cannot have both debit and credit amounts",enterEntryDescription:"Enter journal entry description",enterReferenceNumber:"Enter reference number",quickEntry:"Quick Journal Entry",selectCategory:"Select Category",selectTemplate:"Select Template",chooseCategory:"Choose a category...",chooseTemplate:"Choose a template...",enterAmounts:"Enter Amounts",entryPreview:"Entry Preview",createQuickEntry:"Create Quick Entry",templateRequired:"Please select a template",amountRequired:"Amount is required for {field}",templates:"Templates",manageTemplates:"Manage Templates",addNewTemplate:"Add New Template",templateDetails:"Template Details",newTemplate:"New Template",editTemplate:"Edit Template",templateName:"Template Name",enterTemplateName:"Enter template name",enterTemplateDescription:"Enter template description",category:"Category",templateLines:"Template Lines",type:"Type",amountType:"Amount Type",fieldName:"Field Name",selectAccount:"Select account...",variable:"Variable",fixed:"Fixed",fieldNamePlaceholder:"e.g., Amount",custom:"Custom",templateNameRequired:"Template name is required",templateDescriptionRequired:"Template description is required",lineDescriptionRequired:"Line {lineNumber}: Description is required",amountFieldNameRequired:"Line {lineNumber}: Amount field name is required",confirmDeleteTemplate:"Are you sure you want to delete this template?",selectTemplateToView:"Select a template from the list to view details",orCreateNew:"or create a new custom template",reconciliationSummary:"Reconciliation Summary",totalLines:"Total Lines",bankAccounts:"Bank Accounts",bankReconciled:"Bank Reconciled",bankPending:"Bank Pending",reconciledLines:"Reconciled Lines",unreconciledLines:"Unreconciled Lines",fullyReconciled:"Fully Reconciled",partiallyReconciled:"Partially Reconciled",unreconciled:"Unreconciled",reconciled:"Reconciled",pending:"Pending",matched:"Matched",manual:"Manual",pendingBankReconciliation:"Pending Bank Reconciliation",visitBankConsolidations:"Visit Bank Consolidations to reconcile these transactions",reconciliationTip:"Reconciliation Tip",unreconciledBankTransactions:"This entry has unreconciled bank account transactions.",bankAccount:"bank account",currentUser:"Current User",errorDeletingTemplate:"Error deleting template",errorSavingTemplate:"Error saving template",noLines:"No lines",noTemplateLines:"No template lines"},invoiceReport:{title:"Invoice Resume Report",filters:"Filters",storeLocation:"Store Location",allStores:"All Stores",fromDate:"From Date",toDate:"To Date",paymentMethod:"Payment Method",allMethods:"All Methods",cash:"Cash",zelle:"Zelle",other:"Other",shippingType:"Shipping Type",allTypes:"All Types",maritime:" Maritime",air:" Air",generateReport:"Generate Report",loading:"Loading...",print:" Print",exportPdf:" Export PDF",generating:" Generating...",close:"Close",invoiceSummary:"Invoice Summary",totalInvoices:"Total Invoices",dateRange:"Date Range",store:"Store",shippingTypeLabel:"Shipping Type",notSet:"Not Set",paymentMethods:"Payment Methods",total:"Total",additionalCharges:"Additional Charges",transport:"Transport",aranceles:"Aranceles",tax:"Tax",productsSummary:"Products Summary",productType:"Product Type",quantity:"Quantity",totalValue:"Total Value",avgPrice:"Avg Price",reservasSummary:"Reservas Summary (Grouped by Price)",reservaType:"Reserva Type",totalQtyLbs:"Total Qty (lbs)",priceGroups:"Price Groups (Price  Qty)",otherServicesTitle:"Other Services & Charges",serviceType:"Service Type",totalOtherServices:"Total Other Services",totalSummary:"Total Summary",productsTotal:"Products Total",reservasTotal:"Reservas Total",transportServices:"Transport & Services",grandTotal:"GRAND TOTAL",invoiceReferences:"Invoice References",type:"Type",pricePerPound:"Price per pound",totalInvoicesCount:"Total invoices",invoiceNumbers:"Invoice Numbers",copyInvoiceNumbers:" Copy Invoice Numbers",reportPeriod:"Report Period",allTimeReport:"All Time Report",generatedOn:"Generated on",generatingReport:"Generating report...",pdfGenerationFailed:"PDF generation failed. Using print instead.",invoiceNumbersCopied:"Invoice numbers copied to clipboard!",allTypesOption:"All Types",seaOption:" Maritime",airOption:" Air",allMethodsOption:"All Methods",cashOption:"Cash",zelleOption:"Zelle",otherOption:"Other",pdf:{title:"Invoice Resume Report",subtitle:"Comprehensive Financial Summary",paymentMethodsSummary:"Payment Methods Summary",productsSummary:"Products Summary",reservasSummary:"Reservas Summary (Grouped by Price)",otherServicesTitle:"Other Services & Charges",totalSummary:"Total Summary",paymentMethod:"Payment Method",amount:"Amount",product:"Product",quantity:"Quantity",total:"Total",type:"Type",totalQty:"Total Qty",priceGroups:"Price Groups",serviceType:"Service Type",productsTotal:"Products Total",reservasTotal:"Reservas Total",transportServices:"Transport & Services",grandTotal:"GRAND TOTAL",generatedOn:"Generated on:",all:"All",reportDate:"Report Date:",dateRange:"Date Range:",totalInvoices:"Total Invoices:",allTypes:"All Types",lbs:"lbs",page:"Page",of:"of"}},entryBooks:{title:"Entry Books",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",details:"Details",journalLines:"Journal Lines",balanceStatus:"Balance Status",unbalanced:"Unbalanced",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",postEntry:"Post Entry",fixBalance:"Fix Balance",draftEntry:"Draft Entry",draftEntryDescription:"This entry can be edited and posted.",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",postedEntry:"Posted Entry",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",editEntryTooltip:"Edit this journal entry",entryMustBeBalanced:"Entry must be balanced to post",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",post:"Post",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",voidEntry:"Void Entry",entryNotBalanced:"Entry Not Balanced",reconciliationSummary:"Reconciliation Summary",totalLines:"Total Lines",bankAccounts:"Bank Accounts",bankReconciled:"Bank Reconciled",bankPending:"Bank Pending",reconciledLines:"Reconciled Lines",manual:"Manual",pendingBankReconciliation:"Pending Bank Reconciliation",visitBankConsolidations:"Visit Bank Consolidations to reconcile these transactions",reconciliationTip:"Reconciliation Tip",unreconciledBankTransactions:"This entry has unreconciled bank account transactions.",unreconciledLines:"Unreconciled Lines",fullyReconciled:"Fully Reconciled",partiallyReconciled:"Partially Reconciled",unreconciled:"Unreconciled",reconciled:"Reconciled",pending:"Pending",matched:"Matched",noDescription:"No description",bankAccount:"bank account",currentUser:"Current User",errorDeletingTemplate:"Error deleting template",errorSavingTemplate:"Error saving template",noLines:"No lines",noTemplateLines:"No template lines"},consolidation:{title:"Bank Consolidation",bankAccount:"Bank Account",statementDate:"Statement Date",beginningBalance:"Beginning Balance",endingBalance:"Ending Balance",deposits:"Deposits",withdrawals:"Withdrawals",bankCharges:"Bank Charges",interest:"Interest",reconcile:"Reconcile",matched:"Matched",unmatched:"Unmatched",importStatement:"Import Statement",manualEntry:"Manual Entry",autoMatch:"Auto Match",clearAll:"Clear All",reconciliationStatus:"Reconciliation Status",difference:"Difference",bookBalance:"Book Balance",statementBalance:"Statement Balance",outstandingChecks:"Outstanding Checks",depositsInTransit:"Deposits in Transit"},forms:{requiredField:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",minLength:"Minimum length is",maxLength:"Maximum length is",minValue:"Minimum value is",maxValue:"Maximum value is",passwordMismatch:"Passwords do not match",selectOption:"Please select an option",enterValue:"Please enter a value",confirmDelete:"Are you sure you want to delete this item?",unsavedChanges:"You have unsaved changes. Do you want to continue?",saveSuccess:"Saved successfully",saveError:"Error saving data",deleteSuccess:"Deleted successfully",deleteError:"Error deleting item",descriptionRequired:"Description is required",errorOccurred:"An error occurred",errorPostingEntry:"An error occurred while posting the entry"},reports:{title:"Reports",incomeStatement:"Income Statement",balanceSheet:"Balance Sheet",cashFlow:"Cash Flow Statement",trialBalance:"Trial Balance",generalLedger:"General Ledger",accountsReceivable:"Accounts Receivable",accountsPayable:"Accounts Payable",inventoryReport:"Inventory Report",payrollReport:"Payroll Report",taxReport:"Tax Report",customReport:"Custom Report",dateRange:"Date Range",fromDate:"From Date",toDate:"To Date",generateReport:"Generate Report",exportOptions:"Export Options",pdf:"PDF",excel:"Excel",csv:"CSV"},settings:{title:"Settings",general:"General",company:"Company",users:"Users",security:"Security",backup:"Backup",companyName:"Company Name",companyAddress:"Company Address",taxId:"Tax ID",fiscalYear:"Fiscal Year",currency:"Currency",dateFormat:"Date Format",timeZone:"Time Zone",language:"Language",theme:"Theme",lightTheme:"Light",darkTheme:"Dark",autoBackup:"Auto Backup",backupFrequency:"Backup Frequency",lastBackup:"Last Backup",restoreBackup:"Restore Backup",exportData:"Export Data",importData:"Import Data",changePassword:"Change Password",twoFactorAuth:"Two-factor Authentication",sessionTimeout:"Session Timeout",auditLog:"Audit Log"},unauthorized:{title:"Access Restricted",accessDenied:"Access Denied",noPermission:"You don't have permission to access",thisFeature:"this feature",whySeeing:"Why am I seeing this?",explanation:"Your account doesn't have the necessary permissions to view this content.",requiredPermission:"Required permission:",goToDashboard:"Go to Dashboard",goBack:"Go Back",featuresCanAccess:"Features you can access:",dashboardAccess:"Dashboard and overview statistics",profileAccess:"Your profile and settings",roleBasedAccess:"Features enabled for your role",needAccess:"Need access? Contact your administrator or manager to request the appropriate permissions.",permissions:{accountAccess:"Account Management Access",inventoryAccess:"Inventory Access",employeeAccess:"HR Access",bankingAccess:"Banking Access",journalAccess:"Journal Entry Access",adminAccess:"Administrative Access",financialReporting:"Financial Reporting Access",invoiceManagement:"Invoice Management Access",productManagement:"Product Management Access",HBLAccess:"HBL Management Access"}},hbl:{title:"House Bill of Lading Management",records:"records",searchPlaceholder:"Search by HBL#, air guide, shipper, consignee, commodity, bag#, identity...",addNew:"Add New HBL",hblNumber:"HBL Number",airGuide:"Air Guide",airNumber:"Air Number",shipper:"Shipper",consignee:"Consignee",shipperPhone:"Shipper Phone",consigneePhone:"Consignee Phone",identity:"Identity",classification:"Classification",address:"Address",city:"City",state:"State",street:"Street",commodity:"Commodity",weight:"Weight",quantity:"Quantity",bagNumber:"Bag Number",agency:"Agency",guide:"Guide",guideNumber:"Guide Number",guideNo:"Guide No.",reserveDate:"Reserve Date",status:{"EN BODEGA":"In Warehouse",ENVIADO:"Shipped",ENTREGADO:"Delivered",CANCELADO:"Cancelled",PENDIENTE:"Pending"}},eventAutomation:{title:"Event-Based Automation",subtitle:"Automatically create journal entries when business events occur",tabs:{rules:"Automation Rules",events:"Event History",audit:"Audit Log"},rules:{title:"Active Automation Rules",createNew:"Create New Rule",noRules:"No automation rules configured yet.",createFirst:"Create Your First Rule",conditions:"Conditions",alwaysTriggers:"Always triggers",journalEntry:"Journal Entry",lines:"lines",enable:"Enable",disable:"Disable",priority:"Priority"},events:{title:"Recent Events",noEvents:"No events recorded yet. Events will appear here as they occur.",source:"Source",eventId:"Event ID",viewData:"View Event Data"},audit:{title:"Automation Audit Log",noActivity:"No automation activity recorded yet.",eventId:"Event ID",rulesTriggered:"Rules Triggered",entriesCreated:"Entries Created",journalEntries:"journal entries",success:"Success",failed:"Failed",error:"Error"},builder:{title:"Automation Rule",editTitle:"Edit Automation Rule",createTitle:"Create New Automation Rule",basicInfo:"Basic Information",ruleName:"Rule Name",ruleNamePlaceholder:"e.g., Cash Sale Automation",priority:"Priority (1-1000)",description:"Description",descriptionPlaceholder:"Describe what this rule does",eventType:"Event Type",active:"Active",eventDescription:"Event Description",conditions:{title:"Conditions",add:"Add Condition",noConditions:"No conditions - rule will trigger for all",field:"Field",operator:"Operator",value:"Value",selectField:"Select a field...",enterValue:"Enter value...",remove:"Remove"},journalTemplate:{title:"Journal Entry Template",description:"Entry Description Template",descriptionPlaceholder:"e.g., Cash Sale - Invoice {data.invoice}",reference:"Reference Template",referencePlaceholder:"e.g., INV-{data.invoice}",tip:"Tip: Use {data.field} to insert event data. Available fields:",lines:"Journal Entry Lines",addLine:"Add Line",noLines:"No journal entry lines defined. Add at least one debit and one credit line.",account:"Account",type:"Type",debit:"Debit",credit:"Credit",descriptionTemplate:"Description Template",descriptionTemplatePlaceholder:"e.g., Cash payment from {data.customerName}",amountExpression:"Amount Expression",amountExpressionPlaceholder:"e.g., data.totalAmount"},save:"Create Rule",update:"Update Rule",cancel:"Cancel"},eventTypes:{invoice_completed:"Invoice Completed",invoice_created:"Invoice Created",invoice_updated:"Invoice Updated",invoice_cancelled:"Invoice Cancelled",payment_received:"Payment Received",payment_refunded:"Payment Refunded",inventory_received:"Inventory Received",inventory_sold:"Inventory Sold",inventory_adjusted:"Inventory Adjusted",expense_created:"Expense Created",expense_approved:"Expense Approved",expense_paid:"Expense Paid",service_rendered:"Service Rendered",freight_processed:"Freight Processed",customs_cleared:"Customs Cleared"},operators:{equals:"Equals",notEquals:"Not Equals",greaterThan:"Greater Than",lessThan:"Less Than",greaterThanOrEqual:"Greater Than or Equal",lessThanOrEqual:"Less Than or Equal",contains:"Contains",notContains:"Not Contains",exists:"Exists",notExists:"Not Exists"},categories:{financial:"Financial",inventory:"Inventory",operational:"Operational"}}},RM={common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",add:"Agregar",close:"Cerrar",search:"Buscar",filter:"Filtrar",reset:"Restablecer",back:"Atrs",next:"Siguiente",previous:"Anterior",yes:"S",no:"No",from:"Desde",to:"Hasta",loading:"Cargando...",error:"Error",success:"xito",warning:"Advertencia",info:"Informacin",confirm:"Confirmar",actions:"Acciones",status:"Estado",active:"Activo",inactive:"Inactivo",date:"Fecha",time:"Hora",description:"Descripcin",notes:"Notas",amount:"Monto",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Idioma",english:"Ingls",spanish:"Espaol",noDataFound:"No se encontraron datos",required:"Requerido",optional:"Opcional",all:"Todos",none:"Ninguno",select:"Seleccionar",clear:"Limpiar",view:"Ver",unknown:"Desconocido",details:"Detalles",notAvailable:"N/A",download:"Descargar",upload:"Cargar",print:"Imprimir",export:"Exportar",import:"Importar",exportCSV:"Exportar CSV",exportExcel:"Exportar Excel",showing:"Mostrando",of:"de",dateFrom:"Fecha Desde",dateTo:"Fecha Hasta",showFilters:"Mostrar Filtros",hideFilters:"Ocultar Filtros",clearFilters:"Limpiar Filtros"},navigation:{dashboard:"Panel de Control",accounts:"Plan de Cuentas",balanceSheet:"Balance General",inventory:"Inventario",inventoryManagement:"Gestin de Inventario",employees:"Empleados",employeeManagement:"Gestin de Empleados",entryBooks:"Libros de Entrada",journalEntries:"Asientos Contables",consolidate:"Consolidacin Bancaria",reports:"Reportes",settings:"Configuracin",logout:"Cerrar Sesin",home:"Inicio",hbl:"Conocimiento de Embarque"},dashboard:{title:"Panel de Control",welcome:"Bienvenido a HRM Finance",overview:"Resumen",recentActivity:"Actividad Reciente",quickActions:"Acciones Rpidas",totalAssets:"Activos Totales",totalLiabilities:"Pasivos Totales",totalEquity:"Patrimonio Total",totalRevenue:"Ingresos Totales",totalExpenses:"Gastos Totales",netIncome:"Ingreso Neto",cashBalance:"Saldo en Efectivo",accountsReceivable:"Cuentas por Cobrar",accountsPayable:"Cuentas por Pagar",inventoryValue:"Valor del Inventario",lowStockItems:"Artculos con Bajo Stock",pendingInvoices:"Facturas Pendientes",employeeCount:"Nmero de Empleados",monthlyPayroll:"Nmina Mensual"},accounts:{title:"Plan de Cuentas",accountNumber:"Nmero de Cuenta",accountName:"Nombre de Cuenta",accountType:"Tipo de Cuenta",category:"Categora",balance:"Saldo",parentAccount:"Cuenta Padre",subAccounts:"Subcuentas",addAccount:"Agregar Cuenta",editAccount:"Editar Cuenta",deleteAccount:"Eliminar Cuenta",accountDetails:"Detalles de Cuenta",transactions:"Transacciones",accountHistory:"Historial de Cuenta",types:{asset:"Activo",liability:"Pasivo",equity:"Patrimonio",revenue:"Ingreso",expense:"Gasto"},categories:{currentAssets:"Activos Corrientes",fixedAssets:"Activos Fijos",currentLiabilities:"Pasivos Corrientes",longTermLiabilities:"Pasivos a Largo Plazo",ownersEquity:"Patrimonio del Propietario",operatingRevenue:"Ingresos Operativos",operatingExpenses:"Gastos Operativos"},allAccounts:"Todas las Cuentas"},banking:{title:"Bancario",unreconciled:"Sin Conciliar",reconciled:"Conciliado",reconciliation:"Conciliacin",notReconciled:"No Conciliado"},balanceSheet:{title:"Balance General",asOf:"Al",assets:"Activos",liabilities:"Pasivos",equity:"Patrimonio",totalAssets:"Total de Activos",totalLiabilities:"Total de Pasivos",totalEquity:"Total de Patrimonio",currentAssets:"Activos Corrientes",nonCurrentAssets:"Activos No Corrientes",currentLiabilities:"Pasivos Corrientes",nonCurrentLiabilities:"Pasivos No Corrientes",retainedEarnings:"Utilidades Retenidas",commonStock:"Capital Social",generateReport:"Generar Reporte",exportPDF:"Exportar PDF",exportExcel:"Exportar Excel"},inventory:{title:"Gestin de Inventario",products:"Productos",locations:"Ubicaciones",movements:"Movimientos",overview:"Resumen",addProduct:"Agregar Producto",addLocation:"Agregar Ubicacin",addMovement:"Agregar Movimiento",bulkMovement:"Movimiento Masivo",productName:"Nombre del Producto",productCode:"Cdigo del Producto",sku:"SKU",category:"Categora",quantity:"Cantidad",unitOfMeasure:"Unidad de Medida",unitCost:"Costo Unitario",totalValue:"Valor Total",minStockLevel:"Nivel Mnimo de Stock",maxStockLevel:"Nivel Mximo de Stock",reorderPoint:"Punto de Reorden",locationName:"Nombre de Ubicacin",locationType:"Tipo de Ubicacin",locationCode:"Cdigo de Ubicacin",address:"Direccin",movementType:"Tipo de Movimiento",fromLocation:"Desde Ubicacin",toLocation:"Hacia Ubicacin",referenceNumber:"Nmero de Referencia",invoiceNumber:"Nmero de Factura",stockIn:"Entrada de Stock",stockOut:"Salida de Stock",transfer:"Transferencia",adjustment:"Ajuste",inStock:"En Stock",lowStock:"Stock Bajo",outOfStock:"Sin Stock",stockLevels:"Niveles de Stock",stockByLocation:"Stock por Ubicacin",recentMovements:"Movimientos Recientes",searchProducts:"Buscar productos...",searchLocations:"Buscar ubicaciones...",noMovements:"No se encontraron movimientos",productDetails:"Detalles del Producto",locationDetails:"Detalles de Ubicacin",movementDetails:"Detalles del Movimiento",totalProducts:"Total de Productos",activeProducts:"Productos Activos",totalLocations:"Total de Ubicaciones",activeLocations:"Ubicaciones Activas",lowStockAlert:"Alerta de Stock Bajo",productsNeedRestocking:"productos necesitan reabastecimiento",lastSeen:"Visto por ltima vez",noProducts:"No hay productos en esta ubicacin",warehouseType:"Almacn",storeType:"Tienda",supplierType:"Proveedor",customerType:"Cliente"},employees:{title:"Gestin de Empleados",employeeList:"Lista de Empleados",addEmployee:"Agregar Empleado",editEmployee:"Editar Empleado",employeeDetails:"Detalles del Empleado",personalInfo:"Informacin Personal",employmentInfo:"Informacin Laboral",payrollInfo:"Informacin de Nmina",firstName:"Nombre",lastName:"Apellido",fullName:"Nombre Completo",email:"Correo Electrnico",phone:"Telfono",address:"Direccin",dateOfBirth:"Fecha de Nacimiento",employeeId:"ID de Empleado",department:"Departamento",position:"Puesto",hireDate:"Fecha de Contratacin",employmentStatus:"Estado Laboral",salary:"Salario",payFrequency:"Frecuencia de Pago",taxId:"ID Fiscal",bankAccount:"Cuenta Bancaria",emergencyContact:"Contacto de Emergencia",activeEmployees:"Empleados Activos",inactiveEmployees:"Empleados Inactivos",totalPayroll:"Nmina Total",searchEmployees:"Buscar empleados..."},journal:{title:"Asientos Contables",entryNumber:"Nmero de Asiento",entryDate:"Fecha del Asiento",debit:"Dbito",credit:"Crdito",account:"Cuenta",memo:"Nota",reference:"Referencia",createEntry:"Crear Asiento",editEntry:"Editar Asiento",deleteEntry:"Eliminar Asiento",addEntry:"Agregar Asiento Contable",updateEntry:"Actualizar Asiento",saveAsDraft:"Guardar como Borrador",post:"Registrar",postEntry:"Registrar Asiento",voidEntry:"Anular Asiento",posted:"Registrado",draft:"Borrador",reversed:"Revertido",balanced:"Balanceado",notBalanced:"No Balanceado",outOfBalance:"Desbalanceado",unbalanced:"Desbalanceado",recurringEntry:"Asiento Recurrente",attachments:"Archivos Adjuntos",draftEntry:"Asiento Borrador",postedEntry:"Asiento Registrado",totalDebits:"Dbitos Totales",totalCredits:"Crditos Totales",totalDebit:"Dbito Total",totalCredit:"Crdito Total",totalAmount:"Monto Total",debitShort:"Db.",creditShort:"Cr.",allEntries:"Todos los Asientos",noReference:"Sin referencia",createdBy:"Por",lines:"Lneas",entryLines:"Lneas del Asiento Contable",journalLines:"Lneas del Diario",addLine:"Agregar Lnea",lineDescription:"Descripcin de lnea",accountLines:"Lneas de Cuentas",noDescription:"Sin descripcin",andMoreLines:"... y {count} lneas ms",viewDetails:"Ver Detalles",entryDetails:"Detalles del Asiento Contable",entryNotFound:"Asiento No Encontrado",entryNotFoundMessage:"El asiento contable que busca no se pudo encontrar o puede haber sido eliminado.",balanceStatus:"Estado del Balance",difference:"diferencia",createdAt:"Creado el",postedAt:"Registrado el",quickActions:"Acciones Rpidas",fixBalance:"Corregir Balance",editEntryTooltip:"Editar este asiento contable",postEntryTooltip:"Registrar este asiento contable",voidEntryTooltip:"Anular este asiento contable",draftEntryDescription:"Este asiento puede ser editado y registrado.",postedEntryDescription:"Este asiento ha sido registrado en el libro mayor. Editar crear una nueva copia borrador.",voidEntryDescription:"Este asiento ha sido anulado y no puede ser modificado.",entryMustBeBalanced:"El asiento debe estar balanceado para registrarse",entryMustBeBalancedBeforePosting:"El asiento debe estar balanceado antes de registrarse.",entryNotBalancedShort:"El asiento no est balanceado",confirmEditPosted:"Este asiento ha sido registrado. Editar crear una nueva copia borrador. Continuar?",confirmPost:"Est seguro que desea registrar este asiento contable? Esta accin no se puede deshacer.",confirmVoid:"Est seguro que desea anular este asiento contable?",minTwoLinesRequired:"Se requieren al menos 2 lneas",entryNotBalanced:"Asiento no balanceado. Dbito: ${debit}, Crdito: ${credit}",lineAccountRequired:"Lnea {lineNumber}: La cuenta es requerida",lineAmountRequired:"Lnea {lineNumber}: Se debe proporcionar monto en dbito o crdito",lineBothAmounts:"Lnea {lineNumber}: No puede tener montos en dbito y crdito",enterEntryDescription:"Ingrese la descripcin del asiento contable",enterReferenceNumber:"Ingrese el nmero de referencia",quickEntry:"Entrada Rpida de Diario",selectCategory:"Seleccionar Categora",selectTemplate:"Seleccionar Plantilla",chooseCategory:"Elija una categora...",chooseTemplate:"Elija una plantilla...",enterAmounts:"Ingresar Montos",entryPreview:"Vista Previa del Asiento",createQuickEntry:"Crear Entrada Rpida",templateRequired:"Por favor seleccione una plantilla",amountRequired:"Se requiere monto para {field}",templates:"Plantillas",manageTemplates:"Administrar Plantillas",addNewTemplate:"Agregar Nueva Plantilla",templateDetails:"Detalles de Plantilla",newTemplate:"Nueva Plantilla",editTemplate:"Editar Plantilla",templateName:"Nombre de Plantilla",enterTemplateName:"Ingrese nombre de plantilla",enterTemplateDescription:"Ingrese descripcin de plantilla",category:"Categora",templateLines:"Lneas de Plantilla",type:"Tipo",amountType:"Tipo de Monto",fieldName:"Nombre del Campo",selectAccount:"Seleccionar cuenta...",variable:"Variable",fixed:"Fijo",fieldNamePlaceholder:"ej., Monto",custom:"Personalizado",templateNameRequired:"El nombre de plantilla es requerido",templateDescriptionRequired:"La descripcin de plantilla es requerida",lineDescriptionRequired:"Lnea {lineNumber}: Se requiere descripcin",amountFieldNameRequired:"Lnea {lineNumber}: Se requiere nombre del campo de monto",confirmDeleteTemplate:"Est seguro que desea eliminar esta plantilla?",selectTemplateToView:"Seleccione una plantilla de la lista para ver detalles",orCreateNew:"o cree una nueva plantilla personalizada",reconciliationSummary:"Resumen de Conciliacin",totalLines:"Lneas Totales",bankAccounts:"Cuentas Bancarias",bankReconciled:"Conciliadas Bancarias",bankPending:"Bancarias Pendientes",reconciledLines:"Lneas Conciliadas",unreconciledLines:"Lneas Sin Conciliar",fullyReconciled:"Completamente Conciliado",partiallyReconciled:"Parcialmente Conciliado",unreconciled:"Sin Conciliar",reconciled:"Conciliadas",pending:"Pendientes",matched:"Coincididas",manual:"Manual",pendingBankReconciliation:"Conciliacin Bancaria Pendiente",visitBankConsolidations:"Visite Consolidaciones Bancarias para conciliar estas transacciones",reconciliationTip:"Consejo de Conciliacin",unreconciledBankTransactions:"Este asiento tiene transacciones de cuentas bancarias sin conciliar.",bankAccount:"cuenta bancaria",currentUser:"Usuario Actual",errorDeletingTemplate:"Error al eliminar plantilla",errorSavingTemplate:"Error al guardar plantilla",noLines:"Sin lneas",noTemplateLines:"Sin lneas de plantilla"},invoiceReport:{title:"Reporte Resumen de Facturas",filters:"Filtros",storeLocation:"Ubicacin de Tienda",allStores:"Todas las Tiendas",fromDate:"Fecha Desde",toDate:"Fecha Hasta",paymentMethod:"Mtodo de Pago",allMethods:"Todos los Mtodos",cash:"Efectivo",zelle:"Zelle",other:"Otro",shippingType:"Tipo de Envo",allTypes:"Todos los Tipos",maritime:" Martimo",air:" Areo",generateReport:"Generar Reporte",loading:"Cargando...",print:" Imprimir",exportPdf:" Exportar PDF",generating:" Generando...",close:"Cerrar",invoiceSummary:"Resumen de Facturas",totalInvoices:"Total de Facturas",dateRange:"Rango de Fechas",store:"Tienda",shippingTypeLabel:"Tipo de Envo",notSet:"No Establecido",paymentMethods:"Mtodos de Pago",total:"Total",additionalCharges:"Cargos Adicionales",transport:"Transporte",aranceles:"Aranceles",tax:"Impuesto",productsSummary:"Resumen de Productos",productType:"Tipo de Producto",quantity:"Cantidad",totalValue:"Valor Total",avgPrice:"Precio Promedio",reservasSummary:"Resumen de Reservas (Agrupado por Precio)",reservaType:"Tipo de Reserva",totalQtyLbs:"Cantidad Total (lbs)",priceGroups:"Grupos de Precio (Precio  Cantidad)",otherServicesTitle:"Otros Servicios y Cargos",serviceType:"Tipo de Servicio",totalOtherServices:"Total Otros Servicios",totalSummary:"Resumen Total",productsTotal:"Total Productos",reservasTotal:"Total Reservas",transportServices:"Transporte y Servicios",grandTotal:"TOTAL GENERAL",invoiceReferences:"Referencias de Facturas",type:"Tipo",pricePerPound:"Precio por libra",totalInvoicesCount:"Total facturas",invoiceNumbers:"Nmeros de Facturas",copyInvoiceNumbers:" Copiar Nmeros de Facturas",reportPeriod:"Perodo del Reporte",allTimeReport:"Reporte de Todo el Tiempo",generatedOn:"Generado el",generatingReport:"Generando reporte...",pdfGenerationFailed:"Fall la generacin del PDF. Usando impresin en su lugar.",invoiceNumbersCopied:"Nmeros de facturas copiados al portapapeles!",allTypesOption:"Todos los Tipos",seaOption:" Martimo",airOption:" Areo",allMethodsOption:"Todos los Mtodos",cashOption:"Efectivo",zelleOption:"Zelle",otherOption:"Otro",pdf:{title:"Reporte Resumen de Facturas",subtitle:"Resumen Financiero Completo",paymentMethodsSummary:"Resumen de Mtodos de Pago",productsSummary:"Resumen de Productos",reservasSummary:"Resumen de Reservas (Agrupado por Precio)",otherServicesTitle:"Otros Servicios y Cargos",totalSummary:"Resumen Total",paymentMethod:"Mtodo de Pago",amount:"Monto",product:"Producto",quantity:"Cantidad",total:"Total",type:"Tipo",totalQty:"Cantidad Total",priceGroups:"Grupos de Precio",serviceType:"Tipo de Servicio",productsTotal:"Total Productos",reservasTotal:"Total Reservas",transportServices:"Transporte y Servicios",grandTotal:"TOTAL GENERAL",generatedOn:"Generado el:",all:"Todo",reportDate:"Fecha del Reporte:",dateRange:"Rango de Fechas:",totalInvoices:"Total de Facturas:",allTypes:"Todos los Tipos",lbs:"lbs",page:"Pgina",of:"de"}},entryBooks:{title:"Libros de Entrada",subtitle:"Administrar asientos contables y registros del libro mayor",bookName:"Nombre del Libro",bookType:"Tipo de Libro",createBook:"Crear Libro",editBook:"Editar Libro",salesBook:"Libro de Ventas",purchaseBook:"Libro de Compras",cashBook:"Libro de Caja",generalBook:"Libro General",entries:"Entradas",addEntry:"Agregar Entrada",period:"Perodo",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",bookBalance:"Saldo del Libro",reconciledBalance:"Saldo Conciliado",difference:"Diferencia",reconcile:"Conciliar",isReconciled:"Est Conciliado",totalEntries:"Total de Asientos",allJournalEntries:"Todos los asientos contables",postedEntriesOnly:"Solo asientos registrados",fromPostedEntries:"De {count} asientos registrados",needBankReconciliation:"Necesita conciliacin bancaria",allReconciled:"Todo conciliado",sortBy:"Ordenar Por",fromDate:"Fecha Desde",toDate:"Fecha Hasta",order:"Orden",newest:"Ms Reciente",oldest:"Ms Antiguo",resetFilters:"Restablecer Filtros",activeFilters:"Filtros activos",from:"Desde",to:"Hasta",entriesFound:"{count} asientos encontrados",noJournalEntries:"Sin Asientos Contables",startByCreating:"Comience creando su primer asiento",noEntriesMatch:"No hay asientos que coincidan con sus filtros actuales.",createFirstEntry:"Crear Primer Asiento",confirmVoid:"Est seguro que desea anular este asiento contable?",void:"Anulado",viewReconciliation:"Ver Conciliacin"},consolidation:{title:"Consolidacin Bancaria",bankAccount:"Cuenta Bancaria",statementDate:"Fecha del Estado",beginningBalance:"Saldo Inicial",endingBalance:"Saldo Final",deposits:"Depsitos",withdrawals:"Retiros",bankCharges:"Cargos Bancarios",interest:"Intereses",reconcile:"Conciliar",matched:"Conciliado",unmatched:"No Conciliado",importStatement:"Importar Estado",manualEntry:"Entrada Manual",autoMatch:"Coincidencia Automtica",clearAll:"Limpiar Todo",reconciliationStatus:"Estado de Conciliacin",difference:"Diferencia",bookBalance:"Saldo en Libros",statementBalance:"Saldo del Estado",outstandingChecks:"Cheques Pendientes",depositsInTransit:"Depsitos en Trnsito"},forms:{requiredField:"Este campo es requerido",invalidEmail:"Direccin de correo invlida",invalidNumber:"Nmero invlido",invalidDate:"Fecha invlida",minLength:"La longitud mnima es",maxLength:"La longitud mxima es",minValue:"El valor mnimo es",maxValue:"El valor mximo es",passwordMismatch:"Las contraseas no coinciden",selectOption:"Por favor seleccione una opcin",enterValue:"Por favor ingrese un valor",confirmDelete:"Est seguro de que desea eliminar este elemento?",unsavedChanges:"Tiene cambios sin guardar. Desea continuar?",saveSuccess:"Guardado exitosamente",saveError:"Error al guardar datos",deleteSuccess:"Eliminado exitosamente",deleteError:"Error al eliminar elemento",descriptionRequired:"La descripcin es requerida",errorOccurred:"Ocurri un error",errorPostingEntry:"Ocurri un error al registrar el asiento"},reports:{title:"Reportes",incomeStatement:"Estado de Resultados",balanceSheet:"Balance General",cashFlow:"Estado de Flujo de Efectivo",trialBalance:"Balance de Comprobacin",generalLedger:"Libro Mayor",accountsReceivable:"Cuentas por Cobrar",accountsPayable:"Cuentas por Pagar",inventoryReport:"Reporte de Inventario",payrollReport:"Reporte de Nmina",taxReport:"Reporte de Impuestos",customReport:"Reporte Personalizado",dateRange:"Rango de Fechas",fromDate:"Desde",toDate:"Hasta",generateReport:"Generar Reporte",exportOptions:"Opciones de Exportacin",pdf:"PDF",excel:"Excel",csv:"CSV"},settings:{title:"Configuracin",general:"General",company:"Empresa",users:"Usuarios",security:"Seguridad",backup:"Respaldo",companyName:"Nombre de la Empresa",companyAddress:"Direccin de la Empresa",taxId:"ID Fiscal",fiscalYear:"Ao Fiscal",currency:"Moneda",dateFormat:"Formato de Fecha",timeZone:"Zona Horaria",language:"Idioma",theme:"Tema",lightTheme:"Claro",darkTheme:"Oscuro",autoBackup:"Respaldo Automtico",backupFrequency:"Frecuencia de Respaldo",lastBackup:"ltimo Respaldo",restoreBackup:"Restaurar Respaldo",exportData:"Exportar Datos",importData:"Importar Datos",changePassword:"Cambiar Contrasea",twoFactorAuth:"Autenticacin de Dos Factores",sessionTimeout:"Tiempo de Espera de Sesin",auditLog:"Registro de Auditora"},unauthorized:{title:"Acceso Restringido",accessDenied:"Acceso Denegado",noPermission:"No tienes permisos para acceder a",thisFeature:"esta funcionalidad",whySeeing:"Por qu veo esto?",explanation:"Tu cuenta no tiene los permisos necesarios para ver este contenido.",requiredPermission:"Permiso requerido:",goToDashboard:"Ir al Panel de Control",goBack:"Regresar",featuresCanAccess:"Funcionalidades a las que puedes acceder:",dashboardAccess:"Panel de control y estadsticas generales",profileAccess:"Tu perfil y configuraciones",roleBasedAccess:"Funcionalidades habilitadas para tu rol",needAccess:"Necesitas acceso? Contacta a tu administrador o gerente para solicitar los permisos apropiados.",permissions:{accountAccess:"Acceso a Gestin de Cuentas",inventoryAccess:"Acceso a Inventario",employeeAccess:"Acceso a Recursos Humanos",bankingAccess:"Acceso Bancario",journalAccess:"Acceso a Asientos Contables",adminAccess:"Acceso Administrativo",financialReporting:"Acceso a Reportes Financieros",invoiceManagement:"Acceso a Gestin de Facturas",productManagement:"Acceso a Gestin de Productos",HBLAccess:"Acceso a Gestin de HBL"}},hbl:{title:"Gestin de Conocimiento de Embarque",records:"registros",searchPlaceholder:"Buscar por HBL#, gua area, remitente, consignatario, mercanca, bolsa#, identidad...",addNew:"Agregar Nuevo HBL",hblNumber:"Nmero HBL",airGuide:"Gua Area",airNumber:"Nmero Areo",shipper:"Remitente",consignee:"Consignatario",shipperPhone:"Telfono del Remitente",consigneePhone:"Telfono del Consignatario",identity:"Identidad",classification:"Clasificacin",address:"Direccin",city:"Ciudad",state:"Provincia",street:"Calle",commodity:"Mercanca",weight:"Peso",quantity:"Cantidad",bagNumber:"Nmero de Bolsa",agency:"Agencia",guide:"Gua",guideNumber:"Nmero de Gua",guideNo:"Gua No.",reserveDate:"Fecha de Reserva",status:{"EN BODEGA":"En Bodega",ENVIADO:"Enviado",ENTREGADO:"Entregado",CANCELADO:"Cancelado",PENDIENTE:"Pendiente"}},eventAutomation:{title:"Automatizacin Basada en Eventos",subtitle:"Crea automticamente asientos contables cuando ocurren eventos del negocio",tabs:{rules:"Reglas de Automatizacin",events:"Historial de Eventos",audit:"Registro de Auditora"},rules:{title:"Reglas de Automatizacin Activas",createNew:"Crear Nueva Regla",noRules:"No hay reglas de automatizacin configuradas an.",createFirst:"Crear Tu Primera Regla",conditions:"Condiciones",alwaysTriggers:"Siempre se activa",journalEntry:"Asiento Contable",lines:"lneas",enable:"Habilitar",disable:"Deshabilitar",priority:"Prioridad"},events:{title:"Eventos Recientes",noEvents:"No hay eventos registrados an. Los eventos aparecern aqu cuando ocurran.",source:"Origen",eventId:"ID de Evento",viewData:"Ver Datos del Evento"},audit:{title:"Registro de Auditora de Automatizacin",noActivity:"No hay actividad de automatizacin registrada an.",eventId:"ID de Evento",rulesTriggered:"Reglas Activadas",entriesCreated:"Asientos Creados",journalEntries:"asientos contables",success:"Exitoso",failed:"Fallido",error:"Error"},builder:{title:"Regla de Automatizacin",editTitle:"Editar Regla de Automatizacin",createTitle:"Crear Nueva Regla de Automatizacin",basicInfo:"Informacin Bsica",ruleName:"Nombre de la Regla",ruleNamePlaceholder:"ej., Automatizacin de Venta en Efectivo",priority:"Prioridad (1-1000)",description:"Descripcin",descriptionPlaceholder:"Describe qu hace esta regla",eventType:"Tipo de Evento",active:"Activa",eventDescription:"Descripcin del Evento",conditions:{title:"Condiciones",add:"Agregar Condicin",noConditions:"Sin condiciones - la regla se activar para todos",field:"Campo",operator:"Operador",value:"Valor",selectField:"Seleccionar un campo...",enterValue:"Ingresar valor...",remove:"Eliminar"},journalTemplate:{title:"Plantilla de Asiento Contable",description:"Plantilla de Descripcin del Asiento",descriptionPlaceholder:"ej., Venta en Efectivo - Factura {data.invoice}",reference:"Plantilla de Referencia",referencePlaceholder:"ej., INV-{data.invoice}",tip:"Consejo: Usa {data.field} para insertar datos del evento. Campos disponibles:",lines:"Lneas del Asiento Contable",addLine:"Agregar Lnea",noLines:"No hay lneas de asiento definidas. Agrega al menos una lnea de dbito y una de crdito.",account:"Cuenta",type:"Tipo",debit:"Dbito",credit:"Crdito",descriptionTemplate:"Plantilla de Descripcin",descriptionTemplatePlaceholder:"ej., Pago en efectivo de {data.customerName}",amountExpression:"Expresin de Monto",amountExpressionPlaceholder:"ej., data.totalAmount"},save:"Crear Regla",update:"Actualizar Regla",cancel:"Cancelar"},eventTypes:{invoice_completed:"Factura Completada",invoice_created:"Factura Creada",invoice_updated:"Factura Actualizada",invoice_cancelled:"Factura Cancelada",payment_received:"Pago Recibido",payment_refunded:"Pago Reembolsado",inventory_received:"Inventario Recibido",inventory_sold:"Inventario Vendido",inventory_adjusted:"Inventario Ajustado",expense_created:"Gasto Creado",expense_approved:"Gasto Aprobado",expense_paid:"Gasto Pagado",service_rendered:"Servicio Prestado",freight_processed:"Flete Procesado",customs_cleared:"Aduanas Despachadas"},operators:{equals:"Igual a",notEquals:"No Igual a",greaterThan:"Mayor Que",lessThan:"Menor Que",greaterThanOrEqual:"Mayor o Igual Que",lessThanOrEqual:"Menor o Igual Que",contains:"Contiene",notContains:"No Contiene",exists:"Existe",notExists:"No Existe"},categories:{financial:"Financiero",inventory:"Inventario",operational:"Operacional"}}},DM=()=>{if(typeof window<"u"){const t=localStorage.getItem("hrmfinance-language");if(t&&["es","en"].includes(t))return t}return"en"},[Xb,MM]=we(DM()),[Zb,FM]=we({en:{},es:{}}),Pd={get language(){return Xb()},get translations(){return Zb()},setLanguage(t){MM(t),typeof window<"u"&&localStorage.setItem("hrmfinance-language",t)},setTranslations(t){FM(t)},translate(t,e){const r=Xb(),n=Zb()[r];if(!n)return e||t;const i=t.split(".");let o=n;for(const s of i)if(o&&typeof o=="object"&&s in o)o=o[s];else return e||t;return typeof o=="string"?o:e||t},t(t,e){return this.translate(t,e)}},hu=()=>({t:Pd.translate.bind(Pd),language:Pd.language,setLanguage:Pd.setLanguage});Pd.setTranslations({en:LM,es:RM});var OM=ae("<div><div><label></label><select><option value=all></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label><select><option value=all></option><option value=cash></option><option value=zelle></option><option value=other></option></select></div><div><label></label><select><option value=all></option><option value=SEA></option><option value=AEREO>"),BM=ae("<div><div><strong>:</strong> </div><div><strong>:</strong> <!> <!> </div><div><strong>:</strong> </div><div><strong>:</strong> "),jM=ae("<div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),VM=ae("<div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),e1=ae("<div>"),t1=ae("<div><table><thead><tr><th></th><th></th><th></th><th></th></tr></thead><tbody>"),qM=ae("<div><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td colspan=4><strong>:</strong></td><td>"),zM=ae("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),UM=ae("<div><div>"),HM=ae("<div><div><div><h3></h3><button></button></div><div><div>: <strong></strong></div><div>: <strong></strong></div><div>: <strong></strong></div></div><div><div>:</div><div></div></div><div>"),GM=ae("<div><div class=print-only><h1></h1><div></div><div>: </div></div><div class=no-print><h1></h1><div>"),WM=ae("<option>"),YM=ae("<tr><td></td><td></td><td></td><td>"),KM=ae("<tr><td></td><td></td><td><div></div></td><td>"),JM=ae("<div><span>  <!> lbs</span><button> <!> invoice"),QM=ae("<tr><td><div></div></td><td>");const XM=t=>{const{t:e}=hu(),[r,n]=we(!1),[i,o]=we(""),[s,l]=we(""),[c,d]=we("all"),[u,y]=we("all"),[g,f]=we("all"),[w,E]=we("all"),[x,T]=we(null),[Y,K]=we([]),[j,q]=we(!1),[J,C]=we(null);jn(async()=>{await $()});const P=()=>Pt.getActiveLocations(),$=async()=>{n(!0);try{let re=c()!=="all"?c():void 0;const L={store:re,dateFrom:i()||void 0,dateTo:s()||void 0};re&&(await io.fetchInvoices(L),D())}catch(re){console.error("Error loading report data:",re)}finally{n(!1)}},D=()=>{let re=io.getFilteredInvoices({store:c(),dateFrom:i(),dateTo:s()});w()!=="all"&&(re=re.filter(Z=>Z.shippingType===w()||!Z.shippingType&&w()==="SEA")),K(re);let L=0,O=0,ne=0,X=new Map,W=new Map,se=new Map,F=0,k=0,N=0;re.forEach(Z=>{const H=dF(Z),B=parseFloat(H.total);Z.paymentMethods?(Z?.paymentMethods?.cash&&(L+=Z?.paymentMethods?.cash),Z?.paymentMethods?.zelle&&(O+=Z?.paymentMethods?.zelle),N+=Z?.taxAmount):Z.hasTax&&Z?.TaxPercent?(O+=B,N+=Z?.TaxPercent/100*B):L+=B,Z.products?.forEach(M=>{const G=M.product.label,Q=Math.abs(M.qty),ie=parseFloat(iP(M));if(X.has(G)){const me=X.get(G);X.set(G,{qty:me.qty+Q,total:me.total+ie})}else X.set(G,{qty:Q,total:ie})}),Z.reservas?.forEach(M=>{const G=M.type,Q=parseFloat(M.qty)||0,ie=parseFloat(M.price)||0,me=parseFloat(M.arancel)||0;var oe=ie*Q;const ee=G;if(W.has(ee)){const de=W.get(ee);W.set(ee,{qty:de.qty+Q,price:de.price,total:de.total+oe,priceGroups:de.priceGroups});const he=de.priceGroups.get(ie)||{qty:0,invoices:[]};he.qty+=Q,he.invoices.includes(Z.invoice)||he.invoices.push(Z.invoice),de.priceGroups.set(ie,he)}else{const de=new Map;de.set(ie,{qty:Q,invoices:[Z.invoice]}),W.set(ee,{qty:Q,price:ie,arancel:me,total:oe,priceGroups:de})}k+=me}),Z.services?.forEach(M=>{const G=M.type,Q=parseFloat(M.qty)||0,ie=parseFloat(M.arancel)||0,me=Q*ie;if(F+=me,se.has(G)){const oe=se.get(G);se.set(G,{qty:oe.qty+Q,price:oe.price,arancel:oe.arancel+ie,total:oe.total+me})}else se.set(G,{qty:Q,price:0,arancel:ie,total:me})})});const A=L+O+ne,V={dateRange:{from:i(),to:s()},store:c(),shippingType:w(),totalInvoices:re.length,paymentMethods:{cash:L,zelle:O,other:ne,total:L+O+ne},productsByType:X,reservasByTypeAndPrice:W,otherServicesByType:se,transportTotal:F,arancelesTotal:k,taxTotal:N,grandTotal:A+N};T(V)},b=re=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(re),S=()=>{v(),setTimeout(()=>{},100)},v=async()=>{try{const re=z();if(re){q(!0);const{generateInvoiceResumePDF:L}=await ao(async()=>{const{generateInvoiceResumePDF:ne}=await import("./invoiceResumePdfGenerator-BqFhrxp8.js");return{generateInvoiceResumePDF:ne}},[]),O=`invoice-resume-report-${new Date().toISOString().split("T")[0]}.pdf`;await L(re,e,O),console.log(`PDF generated successfully: ${O}`)}}catch(re){console.error("Error generating PDF:",re),alert(e("invoiceReport.pdfGenerationFailed")),S()}finally{q(!1)}},z=Ut(()=>x());return(()=>{var re=GM(),L=re.firstChild,O=L.firstChild,ne=O.nextSibling,X=ne.nextSibling,W=X.firstChild,se=L.nextSibling,F=se.firstChild,k=F.nextSibling;return re.style.setProperty("padding","2rem"),re.style.setProperty("max-width","1200px"),re.style.setProperty("margin","0 auto"),L.style.setProperty("text-align","center"),L.style.setProperty("margin-bottom","2rem"),L.style.setProperty("border-bottom","2px solid #333"),L.style.setProperty("padding-bottom","1rem"),a(O,()=>e("invoiceReport.title")),ne.style.setProperty("font-size","12pt"),ne.style.setProperty("margin-top","0.5rem"),ne.style.setProperty("color","#666"),a(ne,I(Oe,{get when(){return Te(()=>!!z()?.dateRange?.from)()&&z()?.dateRange?.to},get children(){return[Te(()=>e("invoiceReport.reportPeriod")),": ",Te(()=>z()?.dateRange?.from)," to ",Te(()=>z()?.dateRange?.to)]}}),null),a(ne,I(Oe,{get when(){return!z()?.dateRange?.from||!z()?.dateRange?.to},get children(){return e("invoiceReport.allTimeReport")}}),null),X.style.setProperty("font-size","10pt"),X.style.setProperty("margin-top","0.5rem"),a(X,()=>e("invoiceReport.generatedOn"),W),a(X,()=>new Date().toLocaleDateString(),null),se.style.setProperty("display","flex"),se.style.setProperty("justify-content","space-between"),se.style.setProperty("align-items","center"),se.style.setProperty("margin-bottom","2rem"),F.style.setProperty("font-size","1.75rem"),F.style.setProperty("font-weight","bold"),a(F,()=>e("invoiceReport.title")),k.style.setProperty("display","flex"),k.style.setProperty("gap","1rem"),a(k,I(_t,{variant:"outline",onClick:S,get children(){return e("invoiceReport.print")}}),null),a(k,I(_t,{variant:"outline",onClick:v,get disabled(){return j()},get children(){return Te(()=>!!j())()?e("invoiceReport.generating"):e("invoiceReport.exportPdf")}}),null),a(k,I(Oe,{get when(){return t.onClose},get children(){return I(_t,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("invoiceReport.close")}})}}),null),a(re,I(Gt,{get title(){return e("invoiceReport.filters")},style:{"margin-bottom":"2rem"},class:"no-print",get children(){var N=OM(),A=N.firstChild,V=A.firstChild,Z=V.nextSibling,H=Z.firstChild,B=A.nextSibling,M=B.firstChild,G=M.nextSibling,Q=B.nextSibling,ie=Q.firstChild,me=ie.nextSibling,oe=Q.nextSibling,ee=oe.firstChild,de=ee.nextSibling,he=de.firstChild,le=he.nextSibling,ye=le.nextSibling,ve=ye.nextSibling,pe=oe.nextSibling,ge=pe.firstChild,ke=ge.nextSibling,Ne=ke.firstChild,xe=Ne.nextSibling,$e=xe.nextSibling;return N.style.setProperty("display","grid"),N.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),N.style.setProperty("gap","1rem"),N.style.setProperty("align-items","end"),V.style.setProperty("display","block"),V.style.setProperty("margin-bottom","0.5rem"),V.style.setProperty("font-weight","500"),a(V,()=>e("invoiceReport.storeLocation")),Z.addEventListener("change",Ee=>d(Ee.currentTarget.value)),Z.style.setProperty("width","100%"),Z.style.setProperty("padding","0.75rem"),Z.style.setProperty("border","1px solid var(--border-color)"),Z.style.setProperty("border-radius","var(--border-radius-sm)"),a(H,()=>e("invoiceReport.allStores")),a(Z,I(Ct,{get each(){return P()},children:Ee=>(()=>{var Me=WM();return a(Me,()=>Ee.name),fe(()=>Me.value=Ee.id),Me})()}),null),M.style.setProperty("display","block"),M.style.setProperty("margin-bottom","0.5rem"),M.style.setProperty("font-weight","500"),a(M,()=>e("invoiceReport.fromDate")),G.addEventListener("change",Ee=>o(Ee.currentTarget.value)),G.style.setProperty("width","100%"),G.style.setProperty("padding","0.75rem"),G.style.setProperty("border","1px solid var(--border-color)"),G.style.setProperty("border-radius","var(--border-radius-sm)"),ie.style.setProperty("display","block"),ie.style.setProperty("margin-bottom","0.5rem"),ie.style.setProperty("font-weight","500"),a(ie,()=>e("invoiceReport.toDate")),me.addEventListener("change",Ee=>l(Ee.currentTarget.value)),me.style.setProperty("width","100%"),me.style.setProperty("padding","0.75rem"),me.style.setProperty("border","1px solid var(--border-color)"),me.style.setProperty("border-radius","var(--border-radius-sm)"),ee.style.setProperty("display","block"),ee.style.setProperty("margin-bottom","0.5rem"),ee.style.setProperty("font-weight","500"),a(ee,()=>e("invoiceReport.paymentMethod")),de.addEventListener("change",Ee=>f(Ee.currentTarget.value)),de.style.setProperty("width","100%"),de.style.setProperty("padding","0.75rem"),de.style.setProperty("border","1px solid var(--border-color)"),de.style.setProperty("border-radius","var(--border-radius-sm)"),a(he,()=>e("invoiceReport.allMethodsOption")),a(le,()=>e("invoiceReport.cashOption")),a(ye,()=>e("invoiceReport.zelleOption")),a(ve,()=>e("invoiceReport.otherOption")),ge.style.setProperty("display","block"),ge.style.setProperty("margin-bottom","0.5rem"),ge.style.setProperty("font-weight","500"),a(ge,()=>e("invoiceReport.shippingType")),ke.addEventListener("change",Ee=>E(Ee.currentTarget.value)),ke.style.setProperty("width","100%"),ke.style.setProperty("padding","0.75rem"),ke.style.setProperty("border","1px solid var(--border-color)"),ke.style.setProperty("border-radius","var(--border-radius-sm)"),a(Ne,()=>e("invoiceReport.allTypesOption")),a(xe,()=>e("invoiceReport.seaOption")),a($e,()=>e("invoiceReport.airOption")),a(N,I(Oe,{get when(){return c()!=="all"},get children(){return I(_t,{variant:"primary",onClick:$,get disabled(){return Te(()=>c()==="all")()&&r()},get children(){return Te(()=>!!r())()?e("invoiceReport.loading"):e("invoiceReport.generateReport")}})}}),null),fe(()=>Z.value=c()),fe(()=>G.value=i()),fe(()=>me.value=s()),fe(()=>de.value=g()),fe(()=>ke.value=w()),N}}),null),a(re,I(Oe,{get when(){return Te(()=>!!(c()!=="all"&&z()))()&&!r()},get children(){return[(()=>{var N=e1();return N.style.setProperty("display","grid"),N.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),N.style.setProperty("gap","1.5rem"),N.style.setProperty("margin-bottom","2rem"),a(N,I(Gt,{get title(){return e("invoiceReport.invoiceSummary")},get children(){var A=BM(),V=A.firstChild,Z=V.firstChild,H=Z.firstChild;Z.nextSibling;var B=V.nextSibling,M=B.firstChild,G=M.firstChild,Q=M.nextSibling,ie=Q.nextSibling,me=ie.nextSibling,oe=me.nextSibling;oe.nextSibling;var ee=B.nextSibling,de=ee.firstChild,he=de.firstChild;de.nextSibling;var le=ee.nextSibling,ye=le.firstChild,ve=ye.firstChild;return ye.nextSibling,A.style.setProperty("padding","1rem"),V.style.setProperty("margin-bottom","0.5rem"),a(Z,()=>e("invoiceReport.totalInvoices"),H),a(V,()=>z().totalInvoices,null),B.style.setProperty("margin-bottom","0.5rem"),a(M,()=>e("invoiceReport.dateRange"),G),a(B,()=>z().dateRange.from||e("common.all"),ie),a(B,()=>e("common.to"),oe),a(B,()=>z().dateRange.to||e("common.all"),null),ee.style.setProperty("margin-bottom","0.5rem"),a(de,()=>e("invoiceReport.store"),he),a(ee,(()=>{var pe=Te(()=>z().store==="all");return()=>pe()?e("invoiceReport.allStores"):z().store})(),null),a(ye,()=>e("invoiceReport.shippingTypeLabel"),ve),a(le,(()=>{var pe=Te(()=>z().shippingType==="all");return()=>pe()?e("invoiceReport.allTypes"):Te(()=>z().shippingType==="SEA")()?e("invoiceReport.maritime"):Te(()=>z().shippingType==="AEREO")()?e("invoiceReport.air"):e("invoiceReport.notSet")})(),null),A}}),null),a(N,I(Gt,{get title(){return e("invoiceReport.paymentMethods")},get children(){var A=jM(),V=A.firstChild,Z=V.firstChild,H=Z.firstChild;Z.nextSibling;var B=V.nextSibling,M=B.firstChild,G=M.firstChild;M.nextSibling;var Q=B.nextSibling,ie=Q.firstChild,me=ie.firstChild;ie.nextSibling;var oe=Q.nextSibling,ee=oe.firstChild,de=ee.firstChild;return ee.nextSibling,A.style.setProperty("padding","1rem"),V.style.setProperty("margin-bottom","0.5rem"),a(Z,()=>e("invoiceReport.cash"),H),a(V,()=>b(z().paymentMethods.cash),null),B.style.setProperty("margin-bottom","0.5rem"),a(M,()=>e("invoiceReport.zelle"),G),a(B,()=>b(z().paymentMethods.zelle),null),Q.style.setProperty("margin-bottom","0.5rem"),a(ie,()=>e("invoiceReport.other"),me),a(Q,()=>b(z().paymentMethods.other),null),oe.style.setProperty("border-top","1px solid var(--border-color)"),oe.style.setProperty("padding-top","0.5rem"),oe.style.setProperty("font-weight","bold"),a(ee,()=>e("invoiceReport.total"),de),a(oe,()=>b(z().paymentMethods.total),null),A}}),null),a(N,I(Gt,{get title(){return e("invoiceReport.additionalCharges")},get children(){var A=VM(),V=A.firstChild,Z=V.firstChild,H=Z.firstChild;Z.nextSibling;var B=V.nextSibling,M=B.firstChild,G=M.firstChild;M.nextSibling;var Q=B.nextSibling,ie=Q.firstChild,me=ie.firstChild;return ie.nextSibling,A.style.setProperty("padding","1rem"),V.style.setProperty("margin-bottom","0.5rem"),a(Z,()=>e("invoiceReport.transport"),H),a(V,()=>b(z().transportTotal),null),B.style.setProperty("margin-bottom","0.5rem"),a(M,()=>e("invoiceReport.aranceles"),G),a(B,()=>b(z().arancelesTotal),null),Q.style.setProperty("margin-bottom","0.5rem"),a(ie,()=>e("invoiceReport.tax"),me),a(Q,()=>b(z().taxTotal),null),A}}),null),N})(),I(Oe,{get when(){return z().productsByType?.size>0},get children(){return I(Gt,{get title(){return e("invoiceReport.productsSummary")},style:{"margin-bottom":"2rem"},get children(){var N=t1(),A=N.firstChild,V=A.firstChild,Z=V.firstChild,H=Z.firstChild,B=H.nextSibling,M=B.nextSibling,G=M.nextSibling,Q=V.nextSibling;return N.style.setProperty("overflow-x","auto"),A.style.setProperty("width","100%"),A.style.setProperty("border-collapse","collapse"),Z.style.setProperty("background","var(--background-color)"),H.style.setProperty("padding","1rem"),H.style.setProperty("text-align","left"),H.style.setProperty("border-bottom","2px solid var(--border-color)"),a(H,()=>e("invoiceReport.productType")),B.style.setProperty("padding","1rem"),B.style.setProperty("text-align","right"),B.style.setProperty("border-bottom","2px solid var(--border-color)"),a(B,()=>e("invoiceReport.quantity")),M.style.setProperty("padding","1rem"),M.style.setProperty("text-align","right"),M.style.setProperty("border-bottom","2px solid var(--border-color)"),a(M,()=>e("invoiceReport.totalValue")),G.style.setProperty("padding","1rem"),G.style.setProperty("text-align","right"),G.style.setProperty("border-bottom","2px solid var(--border-color)"),a(G,()=>e("invoiceReport.avgPrice")),a(Q,I(Ct,{get each(){return Array.from(z().productsByType.entries()).sort((ie,me)=>me[1].total-ie[1].total)},children:([ie,me])=>(()=>{var oe=YM(),ee=oe.firstChild,de=ee.nextSibling,he=de.nextSibling,le=he.nextSibling;return ee.style.setProperty("padding","0.75rem"),ee.style.setProperty("border-bottom","1px solid var(--border-color)"),a(ee,ie),de.style.setProperty("padding","0.75rem"),de.style.setProperty("text-align","right"),de.style.setProperty("border-bottom","1px solid var(--border-color)"),a(de,()=>me.qty),he.style.setProperty("padding","0.75rem"),he.style.setProperty("text-align","right"),he.style.setProperty("border-bottom","1px solid var(--border-color)"),he.style.setProperty("font-weight","600"),a(he,()=>b(me.total)),le.style.setProperty("padding","0.75rem"),le.style.setProperty("text-align","right"),le.style.setProperty("border-bottom","1px solid var(--border-color)"),a(le,()=>b(me.total/me.qty)),oe})()})),N}})}}),I(Oe,{get when(){return z().reservasByTypeAndPrice?.size>0},get children(){return I(Gt,{get title(){return e("invoiceReport.reservasSummary")},style:{"margin-bottom":"2rem"},get children(){var N=t1(),A=N.firstChild,V=A.firstChild,Z=V.firstChild,H=Z.firstChild,B=H.nextSibling,M=B.nextSibling,G=M.nextSibling,Q=V.nextSibling;return N.style.setProperty("overflow-x","auto"),A.style.setProperty("width","100%"),A.style.setProperty("border-collapse","collapse"),Z.style.setProperty("background","var(--background-color)"),H.style.setProperty("padding","1rem"),H.style.setProperty("text-align","left"),H.style.setProperty("border-bottom","2px solid var(--border-color)"),a(H,()=>e("invoiceReport.reservaType")),B.style.setProperty("padding","1rem"),B.style.setProperty("text-align","right"),B.style.setProperty("border-bottom","2px solid var(--border-color)"),a(B,()=>e("invoiceReport.totalQtyLbs")),M.style.setProperty("padding","1rem"),M.style.setProperty("text-align","left"),M.style.setProperty("border-bottom","2px solid var(--border-color)"),a(M,()=>e("invoiceReport.priceGroups")),G.style.setProperty("padding","1rem"),G.style.setProperty("text-align","right"),G.style.setProperty("border-bottom","2px solid var(--border-color)"),a(G,()=>e("invoiceReport.total")),a(Q,I(Ct,{get each(){return Array.from(z().reservasByTypeAndPrice.entries()).sort((ie,me)=>me[1].total-ie[1].total)},children:([ie,me])=>(()=>{var oe=KM(),ee=oe.firstChild,de=ee.nextSibling,he=de.nextSibling,le=he.firstChild,ye=he.nextSibling;return ee.style.setProperty("padding","0.75rem"),ee.style.setProperty("border-bottom","1px solid var(--border-color)"),a(ee,ie),de.style.setProperty("padding","0.75rem"),de.style.setProperty("text-align","right"),de.style.setProperty("border-bottom","1px solid var(--border-color)"),de.style.setProperty("font-weight","600"),a(de,()=>me.qty),he.style.setProperty("padding","0.75rem"),he.style.setProperty("border-bottom","1px solid var(--border-color)"),le.style.setProperty("font-size","0.875rem"),a(le,I(Ct,{get each(){return Array.from(me.priceGroups.entries()).sort((ve,pe)=>ve[0]-pe[0])},children:([ve,pe])=>(()=>{var ge=JM(),ke=ge.firstChild,Ne=ke.firstChild,xe=Ne.nextSibling;xe.nextSibling;var $e=ke.nextSibling,Ee=$e.firstChild,Me=Ee.nextSibling;return Me.nextSibling,ge.style.setProperty("margin-bottom","0.5rem"),ge.style.setProperty("display","flex"),ge.style.setProperty("align-items","center"),ge.style.setProperty("gap","0.5rem"),a(ke,()=>b(ve),Ne),a(ke,()=>pe.qty,xe),$e.addEventListener("mouseleave",Ye=>Ye.currentTarget.style.background="#3498db"),$e.addEventListener("mouseenter",Ye=>Ye.currentTarget.style.background="#2980b9"),$e.$$click=()=>C({price:ve,invoices:pe.invoices,type:ie}),$e.style.setProperty("background","#3498db"),$e.style.setProperty("color","white"),$e.style.setProperty("border","none"),$e.style.setProperty("border-radius","4px"),$e.style.setProperty("padding","0.25rem 0.5rem"),$e.style.setProperty("font-size","0.75rem"),$e.style.setProperty("cursor","pointer"),$e.style.setProperty("transition","background 0.2s"),a($e,()=>pe.invoices.length,Me),a($e,()=>pe.invoices.length>1?"s":"",null),ge})()})),ye.style.setProperty("padding","0.75rem"),ye.style.setProperty("text-align","right"),ye.style.setProperty("border-bottom","1px solid var(--border-color)"),ye.style.setProperty("font-weight","600"),a(ye,()=>b(me.total)),oe})()})),N}})}}),I(Oe,{get when(){return z().otherServicesByType?.size>0},get children(){return I(Gt,{get title(){return e("invoiceReport.otherServicesTitle")},style:{"margin-bottom":"2rem"},get children(){var N=qM(),A=N.firstChild,V=A.firstChild,Z=V.firstChild,H=Z.firstChild,B=H.nextSibling,M=V.nextSibling,G=M.firstChild,Q=G.firstChild,ie=Q.firstChild,me=ie.firstChild,oe=Q.nextSibling;return N.style.setProperty("overflow-x","auto"),A.style.setProperty("width","100%"),A.style.setProperty("border-collapse","collapse"),Z.style.setProperty("background","var(--background-color)"),H.style.setProperty("padding","1rem"),H.style.setProperty("text-align","left"),H.style.setProperty("border-bottom","2px solid var(--border-color)"),a(H,()=>e("invoiceReport.serviceType")),B.style.setProperty("padding","1rem"),B.style.setProperty("text-align","right"),B.style.setProperty("border-bottom","2px solid var(--border-color)"),a(B,()=>e("invoiceReport.total")),a(M,I(Ct,{get each(){return Array.from(z().otherServicesByType.entries()).sort((ee,de)=>de[1].total-ee[1].total)},children:([ee,de])=>(()=>{var he=QM(),le=he.firstChild,ye=le.firstChild,ve=le.nextSibling;return le.style.setProperty("padding","0.75rem"),le.style.setProperty("border-bottom","1px solid var(--border-color)"),ye.style.setProperty("display","flex"),ye.style.setProperty("align-items","center"),ye.style.setProperty("gap","0.5rem"),a(ye,ee),ve.style.setProperty("padding","0.75rem"),ve.style.setProperty("text-align","right"),ve.style.setProperty("border-bottom","1px solid var(--border-color)"),ve.style.setProperty("font-weight","600"),a(ve,()=>b(de.total)),he})()}),G),G.style.setProperty("background","var(--strip-color)"),G.style.setProperty("font-weight","bold"),Q.style.setProperty("padding","0.75rem"),Q.style.setProperty("text-align","right"),Q.style.setProperty("border-top","2px solid var(--border-color)"),a(ie,()=>e("invoiceReport.totalOtherServices"),me),oe.style.setProperty("padding","0.75rem"),oe.style.setProperty("text-align","right"),oe.style.setProperty("border-top","2px solid var(--border-color)"),oe.style.setProperty("font-weight","700"),a(oe,()=>b(z().transportTotal)),N}})}}),I(Gt,{get title(){return e("invoiceReport.totalSummary")},get children(){var N=zM(),A=N.firstChild,V=A.firstChild,Z=V.nextSibling,H=A.nextSibling,B=H.firstChild,M=B.nextSibling,G=H.nextSibling,Q=G.firstChild,ie=Q.nextSibling,me=G.nextSibling,oe=me.firstChild,ee=oe.nextSibling;return N.style.setProperty("display","grid"),N.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),N.style.setProperty("gap","2rem"),N.style.setProperty("padding","2rem"),A.style.setProperty("text-align","center"),V.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","var(--text-secondary)"),V.style.setProperty("margin-bottom","0.5rem"),a(V,()=>e("invoiceReport.productsTotal")),Z.style.setProperty("font-size","1.5rem"),Z.style.setProperty("font-weight","bold"),Z.style.setProperty("color","var(--primary-color)"),a(Z,()=>b(Array.from(z().productsByType.values()).reduce((de,he)=>de+he.total,0))),H.style.setProperty("text-align","center"),B.style.setProperty("font-size","0.875rem"),B.style.setProperty("color","var(--text-secondary)"),B.style.setProperty("margin-bottom","0.5rem"),a(B,()=>e("invoiceReport.reservasTotal")),M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","bold"),M.style.setProperty("color","var(--primary-color)"),a(M,()=>b(Array.from(z().reservasByTypeAndPrice.values()).reduce((de,he)=>de+he.total,0))),G.style.setProperty("text-align","center"),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-secondary)"),Q.style.setProperty("margin-bottom","0.5rem"),a(Q,()=>e("invoiceReport.transportServices")),ie.style.setProperty("font-size","1.5rem"),ie.style.setProperty("font-weight","bold"),ie.style.setProperty("color","var(--primary-color)"),a(ie,()=>b(z().transportTotal)),me.style.setProperty("text-align","center"),me.style.setProperty("border-left","2px solid var(--primary-color)"),me.style.setProperty("padding-left","2rem"),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-secondary)"),oe.style.setProperty("margin-bottom","0.5rem"),a(oe,()=>e("invoiceReport.grandTotal")),ee.style.setProperty("font-size","2rem"),ee.style.setProperty("font-weight","bold"),ee.style.setProperty("color","var(--primary-color)"),a(ee,()=>b(z().paymentMethods.total)),N}})]}}),null),a(re,I(Oe,{get when(){return r()},get children(){var N=UM(),A=N.firstChild;return N.style.setProperty("text-align","center"),N.style.setProperty("padding","3rem"),A.style.setProperty("font-size","1.25rem"),A.style.setProperty("margin-bottom","1rem"),a(A,()=>e("invoiceReport.generatingReport")),N}}),null),a(re,I(Oe,{get when(){return J()},get children(){var N=HM(),A=N.firstChild,V=A.firstChild,Z=V.firstChild,H=Z.nextSibling,B=V.nextSibling,M=B.firstChild,G=M.firstChild,Q=G.nextSibling,ie=M.nextSibling,me=ie.firstChild,oe=me.nextSibling,ee=ie.nextSibling,de=ee.firstChild,he=de.nextSibling,le=B.nextSibling,ye=le.firstChild,ve=ye.firstChild,pe=ye.nextSibling,ge=le.nextSibling;return N.$$click=()=>C(null),N.style.setProperty("position","fixed"),N.style.setProperty("top","0"),N.style.setProperty("left","0"),N.style.setProperty("right","0"),N.style.setProperty("bottom","0"),N.style.setProperty("background","rgba(0, 0, 0, 0.5)"),N.style.setProperty("display","flex"),N.style.setProperty("align-items","center"),N.style.setProperty("justify-content","center"),N.style.setProperty("z-index","1000"),A.$$click=ke=>ke.stopPropagation(),A.style.setProperty("background","white"),A.style.setProperty("padding","2rem"),A.style.setProperty("border-radius","var(--border-radius)"),A.style.setProperty("max-width","600px"),A.style.setProperty("max-height","80vh"),A.style.setProperty("overflow-y","auto"),A.style.setProperty("box-shadow","var(--shadow-lg)"),V.style.setProperty("display","flex"),V.style.setProperty("justify-content","space-between"),V.style.setProperty("align-items","center"),V.style.setProperty("margin-bottom","1.5rem"),Z.style.setProperty("font-size","1.25rem"),Z.style.setProperty("font-weight","bold"),a(Z,()=>e("invoiceReport.invoiceReferences")),H.$$click=()=>C(null),H.style.setProperty("background","none"),H.style.setProperty("border","none"),H.style.setProperty("font-size","1.5rem"),H.style.setProperty("cursor","pointer"),H.style.setProperty("color","#666"),B.style.setProperty("margin-bottom","1rem"),M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-secondary)"),a(M,()=>e("invoiceReport.type"),G),a(Q,()=>J().type),ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-secondary)"),a(ie,()=>e("invoiceReport.pricePerPound"),me),a(oe,()=>b(J().price)),ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-secondary)"),a(ee,()=>e("invoiceReport.totalInvoicesCount"),de),a(he,()=>J().invoices.length),le.style.setProperty("border","1px solid var(--border-color)"),le.style.setProperty("border-radius","var(--border-radius-sm)"),le.style.setProperty("padding","1rem"),le.style.setProperty("background","var(--background-color)"),ye.style.setProperty("font-weight","600"),ye.style.setProperty("margin-bottom","0.75rem"),a(ye,()=>e("invoiceReport.invoiceNumbers"),ve),pe.style.setProperty("display","grid"),pe.style.setProperty("grid-template-columns","repeat(auto-fill, minmax(120px, 1fr))"),pe.style.setProperty("gap","0.5rem"),a(pe,I(Ct,{get each(){return J().invoices},children:ke=>(()=>{var Ne=e1();return Ne.$$click=()=>{const xe=Y().find($e=>$e.invoice===ke);xe&&console.log("Invoice details:",xe)},Ne.addEventListener("mouseleave",xe=>{xe.currentTarget.style.background="white",xe.currentTarget.style.borderColor="var(--border-color)"}),Ne.addEventListener("mouseenter",xe=>{xe.currentTarget.style.background="#e3f2fd",xe.currentTarget.style.borderColor="#2196f3"}),Ne.style.setProperty("padding","0.5rem"),Ne.style.setProperty("background","white"),Ne.style.setProperty("border","1px solid var(--border-color)"),Ne.style.setProperty("border-radius","var(--border-radius-sm)"),Ne.style.setProperty("font-family","monospace"),Ne.style.setProperty("font-size","0.875rem"),Ne.style.setProperty("text-align","center"),Ne.style.setProperty("transition","all 0.2s"),Ne.style.setProperty("cursor","pointer"),a(Ne,ke),Ne})()})),ge.style.setProperty("margin-top","1.5rem"),ge.style.setProperty("display","flex"),ge.style.setProperty("justify-content","flex-end"),ge.style.setProperty("gap","1rem"),a(ge,I(_t,{variant:"outline",onClick:()=>{const ke=J().invoices.join(", ");navigator.clipboard.writeText(ke).then(()=>{alert(e("invoiceReport.invoiceNumbersCopied"))})},get children(){return e("invoiceReport.copyInvoiceNumbers")}}),null),a(ge,I(_t,{variant:"primary",onClick:()=>C(null),get children(){return e("invoiceReport.close")}}),null),N}}),null),re})()};br(["click"]);var ZM=ae("<div><div>"),eF=ae("<div> "),tF=ae("<div><div><label></label><select><option value=all></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label><input type=text>"),rF=ae("<div><button></button><button></button><button> Crear Nueva Factura</button><button> Resume Report"),pl=ae("<div>"),nF=ae("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),iF=ae("<button> "),oF=ae("<option>"),sF=ae("<div><div></div><div></div><div></div><div>"),r1=ae("<div><span></span><span> "),aF=ae("<div><span></span><span> $"),lF=ae("<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td><span></span></td><td><button>");const Ch=t=>parseFloat(t?.toString())||0,cF=t=>{let e=Ch(t.qty),r=Ch(t.price),n=Ch(t.arancel);return`${(e*r+n)?.toFixed(2)}`},iP=t=>{let e=Math.abs(t.qty),r=Ch(t.salePrice);return`${(e*r)?.toFixed(2)}`},dF=t=>{let e=0;t?.reservas?.forEach(i=>{e+=parseFloat(cF(i))});let r=0;t?.products?.forEach(i=>{r+=parseFloat(iP(i))});let n={};return n.reservaSubtotal=e.toFixed(2),n.productSubtotal=r.toFixed(2),n.subtotalBeforeTax=(r+e).toFixed(2),n.total=n.subtotalBeforeTax,n},uF=t=>{const{t:e}=_r(),[r,n]=we(!1),[i,o]=we("all"),[s,l]=we(""),[c,d]=we(""),[u,y]=we(null),[g,f]=we(null),[w,E]=we("dashboard"),[x,T]=we([]),[Y,K]=we(""),[j,q]=we("overview");jn(async()=>{try{t.invoices;try{const Q=await io.fetchStores();let ie=Array.isArray(Q)?Q:Object.keys(Q)||[]}catch{const ie=io.state.invoices||t.invoices,me=[...new Set(ie.map(oe=>oe.store))];T(me.sort())}}catch(Q){console.error("Error loading dashboard data:",Q)}}),Ut(()=>io.state.invoices||t.invoices);const J=Ut(()=>{let Q;return t.invoices?Q=io.getFilteredInvoices({store:i(),dateFrom:s(),dateTo:c()}):Q=io.getFilteredInvoices({store:i(),dateFrom:s(),dateTo:c()}),Q}),C=async()=>{try{t.invoices,n(!0),await io.refreshData({store:i()!=="all"?i():void 0,dateFrom:s()||void 0,dateTo:c()||void 0,search:Y()}),n(!1)}catch(Q){console.error("Error refreshing data:",Q)}},P=Ut(()=>{r();const Q=J(),ie=io.calculateSummary(Q);let me=new Map,oe=new Map,ee=new Map;return Q.forEach(de=>{de?.products?.length>0&&de?.products?.forEach(he=>{const le=Math.abs(he.qty),ye=he.product.label;me.set(ye,(me.get(ye)||0)+le)}),de?.reservas?.length>0&&de?.reservas?.forEach(he=>{let le=parseInt(he.qty);isNaN(le)&&(le=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[he.type]||he?.onlyTariff?(le=parseFloat(he.arancel)||parseFloat(he.qty)*parseFloat(he.price),ee.set(he.type,(oe.get(he.type)||0)+le)):oe.set(he.type,(oe.get(he.type)||0)+le)})}),{...ie,productsByCategory:me,reservasByType:oe,othersByType:ee}}),$=Q=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Q),D=Q=>new Date(Q).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),b={padding:"2rem"},S={display:"flex",gap:"1rem","align-items":"flex-end","margin-bottom":"2rem","flex-wrap":"wrap",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)"},v={display:"flex","flex-direction":"column",gap:"0.5rem",flex:"1","min-width":"200px"},z={"font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)"},re={padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--background-color)"},L={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(280px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},O={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)"},ne={width:"48px",height:"48px","border-radius":"12px",display:"flex","align-items":"center","justify-content":"center","font-size":"1.5rem","margin-bottom":"1rem"},X={"font-size":"0.875rem",color:"var(--text-secondary)","margin-bottom":"0.5rem"},W={"font-size":"1.75rem","font-weight":"700",color:"var(--text-primary)","margin-bottom":"0.25rem"},se={"font-size":"0.75rem",color:"var(--text-muted)"},F={width:"100%",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",overflow:"hidden"},k={padding:"1rem","text-align":"left",background:"var(--background-color)","font-weight":"600",color:"var(--text-secondary)","font-size":"0.875rem","border-bottom":"2px solid var(--border-color)"},N={padding:"1rem","border-bottom":"1px solid var(--border-color)"},A={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},V=Q=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:Q?"var(--primary-color)":"var(--text-muted)","border-bottom":Q?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),Z={padding:"0.5rem 1rem",background:"var(--primary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","font-size":"0.875rem",transition:"opacity 0.2s"},H={padding:"0.75rem 1.5rem",background:"var(--secondary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","margin-bottom":"1rem",display:"flex","align-items":"center",gap:"0.5rem"},B=()=>[{title:e("invoices.totalRevenue"),value:P().grandTotal,icon:"",color:"#4CAF50",subtext:`${e("common.of")} ${P().totalInvoices} ${e("common.invoice")} `},{title:e("invoices.totalProducts"),value:P().totalProducts,icon:"",color:"#2196F3",subtext:`${$(P().totalProductAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.totalReservations"),value:P().totalReservas,icon:"",color:"#FF9800",subtext:`${$(P().totalReservaAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.aranceles"),value:P().totalAranceles,icon:"",color:"#9C27B0",subtext:e("invoices.customsFees")},{title:e("invoices.uniqueCustomers"),value:P().uniqueCustomers,icon:"",color:"#00BCD4",subtext:e("invoices.activeCustomers"),isNumber:!0},{title:e("invoices.averageInvoice"),value:P().avgInvoiceValue,icon:"",color:"#FF5722",subtext:e("invoices.perInvoiceValue")},{title:e("invoices.completed"),value:P().completedInvoices,icon:"",color:"#4CAF50",subtext:`${P().pendingInvoices} ${e("invoices.pending")}`,isNumber:!0},{title:e("invoices.storesActive"),value:x().length,icon:"",color:"#795548",subtext:e("invoices.locations"),isNumber:!0}],M=()=>Pt.getActiveLocations();xi(()=>{});const G=async()=>{let Q="YB1";ig.calcStockLevels(),await Pt.fecthProduct(Q),await Pt.fecthInventory(Q)};return jn(()=>{G()}),I(Po,{get title(){return e("invoices.title")},get children(){var Q=pl();return p(Q,b),a(Q,I(Oe,{get when(){return w()==="dashboard"},get children(){return[I(Oe,{get when(){return!t.invoices&&io.state.loading},get children(){var ie=ZM(),me=ie.firstChild;return ie.style.setProperty("text-align","center"),ie.style.setProperty("padding","2rem"),me.style.setProperty("font-size","1.25rem"),me.style.setProperty("margin-bottom","1rem"),a(me,()=>e("invoices.loadingInvoices")),ie}}),I(Oe,{get when(){return io.state.error},get children(){var ie=eF();return ie.firstChild,ie.style.setProperty("padding","1rem"),ie.style.setProperty("margin-bottom","1rem"),ie.style.setProperty("background","#ffebee"),ie.style.setProperty("border","1px solid #ffcdd2"),ie.style.setProperty("border-radius","var(--border-radius)"),ie.style.setProperty("color","#d32f2f"),a(ie,()=>io.state.error,null),a(ie,I(_t,{variant:"outline",size:"sm",onClick:C,style:{"margin-left":"1rem"},get children(){return e("invoices.refreshData")}}),null),ie}}),(()=>{var ie=tF(),me=ie.firstChild,oe=me.firstChild,ee=oe.nextSibling,de=ee.firstChild,he=me.nextSibling,le=he.firstChild,ye=le.nextSibling,ve=he.nextSibling,pe=ve.firstChild,ge=pe.nextSibling,ke=ve.nextSibling,Ne=ke.firstChild,xe=Ne.nextSibling;return p(ie,S),a(oe,()=>e("invoices.storeLocation")),ee.addEventListener("change",$e=>o($e.currentTarget.value)),a(de,()=>e("invoices.allStores")),a(ee,I(Ct,{get each(){return M()},children:$e=>(()=>{var Ee=oF();return a(Ee,()=>$e.name),fe(()=>Ee.value=$e.id),Ee})()}),null),a(le,()=>e("invoices.fromDate")),ye.addEventListener("change",$e=>l($e.currentTarget.value)),a(pe,()=>e("invoices.toDate")),ge.addEventListener("change",$e=>d($e.currentTarget.value)),a(Ne,()=>e("invoices.search")),xe.addEventListener("change",$e=>K($e.currentTarget.value)),a(ie,I(_t,{variant:"secondary",onClick:()=>{o("all"),l(""),d(""),K("")},get children(){return e("invoices.clearFilters")}}),null),a(ie,I(_t,{variant:"primary",onClick:C,get disabled(){return!t.invoices&&io.state.loading},get children(){return[" ",Te(()=>e("invoices.refreshData"))]}}),null),fe($e=>{var Ee=v,Me=z,Ye=re,ze=v,je=z,Xe=re,ht=v,ut=z,Ue=re,it=v,dt=z,Fe=re,Be=e("invoices.searchPlaceholder");return $e.e=p(me,Ee,$e.e),$e.t=p(oe,Me,$e.t),$e.a=p(ee,Ye,$e.a),$e.o=p(he,ze,$e.o),$e.i=p(le,je,$e.i),$e.n=p(ye,Xe,$e.n),$e.s=p(ve,ht,$e.s),$e.h=p(pe,ut,$e.h),$e.r=p(ge,Ue,$e.r),$e.d=p(ke,it,$e.d),$e.l=p(Ne,dt,$e.l),$e.u=p(xe,Fe,$e.u),Be!==$e.c&&ir(xe,"placeholder",$e.c=Be),$e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0}),fe(()=>ee.value=i()),fe(()=>ye.value=s()),fe(()=>ge.value=c()),fe(()=>xe.value=Y()),ie})(),(()=>{var ie=rF(),me=ie.firstChild,oe=me.nextSibling,ee=oe.nextSibling,de=ee.nextSibling;return p(ie,A),me.$$click=()=>q("overview"),a(me,()=>e("inventory.overview")),oe.$$click=()=>q("invoices"),a(oe,()=>e("invoices.invoices")),ee.$$click=()=>q("add"),de.$$click=()=>q("report"),fe(he=>{var le=V(j()==="overview"),ye=V(j()==="invoices"),ve=V(j()==="add"),pe=V(j()==="report");return he.e=p(me,le,he.e),he.t=p(oe,ye,he.t),he.a=p(ee,ve,he.a),he.o=p(de,pe,he.o),he},{e:void 0,t:void 0,a:void 0,o:void 0}),ie})(),I(Oe,{get when(){return j()==="overview"},get children(){return[(()=>{var ie=pl();return p(ie,L),a(ie,I(Ct,{get each(){return B()},children:me=>(()=>{var oe=sF(),ee=oe.firstChild,de=ee.nextSibling,he=de.nextSibling,le=he.nextSibling;return p(oe,O),a(ee,()=>me?.icon),p(de,X),a(de,()=>me?.title),p(he,W),a(he,(()=>{var ye=Te(()=>!!me.isNumber);return()=>ye()?me.value:$(me.value)})()),p(le,se),a(le,()=>me.subtext),fe(ye=>p(ee,{...ne,background:`${me?.color}20`,color:me?.color},ye)),oe})()})),ie})(),I(Oe,{get when(){return P()?.productsByCategory?.size>0},get children(){return I(Gt,{get title(){return e("invoices.topProducts")},get subtitle(){return e("invoices.mostSoldProducts")},get children(){var ie=pl();return ie.style.setProperty("max-height","300px"),ie.style.setProperty("overflow-y","auto"),a(ie,()=>Array.from(P().productsByCategory.entries()).sort((me,oe)=>oe[1]-me[1]).slice(0,10).map(([me,oe])=>(()=>{var ee=r1(),de=ee.firstChild,he=de.nextSibling,le=he.firstChild;return ee.style.setProperty("display","flex"),ee.style.setProperty("justify-content","space-between"),ee.style.setProperty("padding","0.75rem"),ee.style.setProperty("border-bottom","1px solid var(--border-color)"),a(de,me),he.style.setProperty("font-weight","600"),a(he,oe,le),a(he,()=>e("common.units"),null),ee})())),ie}})}}),(()=>{var ie=pl();return ie.style.setProperty("margin","19px"),ie})(),I(Oe,{get when(){return P()?.reservasByType?.size>0},get children(){return I(Gt,{get title(){return e("invoices.reservationsByType")},get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var ie=pl();return ie.style.setProperty("max-height","300px"),ie.style.setProperty("overflow-y","auto"),a(ie,()=>Array.from(P().reservasByType.entries()).sort((me,oe)=>oe[1]-me[1]).map(([me,oe])=>(()=>{var ee=r1(),de=ee.firstChild,he=de.nextSibling,le=he.firstChild;return ee.style.setProperty("display","flex"),ee.style.setProperty("justify-content","space-between"),ee.style.setProperty("padding","0.75rem"),ee.style.setProperty("border-bottom","1px solid var(--border-color)"),a(de,me),he.style.setProperty("font-weight","600"),a(he,oe,le),a(he,()=>e("common.lbs"),null),ee})())),ie}})}}),(()=>{var ie=pl();return ie.style.setProperty("margin","19px"),ie})(),I(Oe,{get when(){return P()?.othersByType?.size>0},get children(){return I(Gt,{title:"Aranceles y otros servicios",get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var ie=pl();return ie.style.setProperty("max-height","300px"),ie.style.setProperty("overflow-y","auto"),a(ie,()=>Array.from(P().othersByType.entries()).sort((me,oe)=>oe[1]-me[1]).map(([me,oe])=>(()=>{var ee=aF(),de=ee.firstChild,he=de.nextSibling,le=he.firstChild;return ee.style.setProperty("display","flex"),ee.style.setProperty("justify-content","space-between"),ee.style.setProperty("padding","0.75rem"),ee.style.setProperty("border-bottom","1px solid var(--border-color)"),a(de,me),he.style.setProperty("font-weight","600"),a(he,oe,le),ee})())),ie}})}})]}})]}}),null),a(Q,I(Oe,{get when(){return j()==="invoices"},get children(){return[I(Oe,{get when(){return w()!=="detail"},get children(){return I(Gt,{get title(){return e("invoices.recentInvoices")},get subtitle(){return`Mostrando ${J().length} facturas`},style:{"margin-top":"1.5rem"},get children(){var ie=nF(),me=ie.firstChild,oe=me.firstChild,ee=oe.firstChild,de=ee.firstChild,he=de.nextSibling,le=he.nextSibling,ye=le.nextSibling,ve=ye.nextSibling,pe=ve.nextSibling,ge=pe.nextSibling,ke=ge.nextSibling,Ne=ke.nextSibling,xe=oe.nextSibling;return ie.style.setProperty("overflow-x","auto"),p(me,F),a(de,()=>e("invoices.invoiceNumber")),a(he,()=>e("invoices.date")),a(le,()=>e("invoices.customer")),a(ye,()=>e("invoices.store")),a(ve,()=>e("invoices.products")),a(pe,()=>e("invoices.reservations")),a(ge,()=>e("invoices.total")),a(ke,()=>e("invoices.status")),a(Ne,()=>e("invoices.actions")),a(xe,I(Ct,{get each(){return J().slice(0,50)},children:$e=>{console.log(JSON.stringify($e,null,4));const Ee=()=>ip($e);return(()=>{var Me=lF(),Ye=Me.firstChild,ze=Ye.nextSibling,je=ze.nextSibling,Xe=je.nextSibling,ht=Xe.nextSibling,ut=ht.nextSibling,Ue=ut.nextSibling,it=Ue.nextSibling,dt=it.firstChild,Fe=it.nextSibling,Be=Fe.firstChild;return a(Ye,()=>$e?.invoice),a(ze,()=>D($e?.createDate)),a(je,()=>$e?.shipper_consignee?.name),a(Xe,()=>$e?.store),a(ht,()=>Ee()?.productSubtotal),a(ut,()=>Ee()?.reservaSubtotal),a(Ue,()=>$(Ee()?.total)),dt.style.setProperty("padding","0.25rem 0.75rem"),dt.style.setProperty("border-radius","9999px"),dt.style.setProperty("font-size","0.75rem"),dt.style.setProperty("font-weight","600"),a(dt,(()=>{var Re=Te(()=>!!$e.isCompleted);return()=>Re()?e("invoices.completed"):e("invoices.pending")})()),Be.addEventListener("mouseleave",Re=>Re.currentTarget.style.opacity="1"),Be.addEventListener("mouseenter",Re=>Re.currentTarget.style.opacity="0.8"),Be.$$click=()=>{f(ip($e)),y($e),E("detail")},p(Be,Z),a(Be,()=>e("invoices.view")),fe(Re=>{var lt=N,ot=N,nt=N,Ve=N,qt=N,Mt=N,Qt={...N,"text-align":"right","font-weight":"600"},lr=N,bt=$e.isCompleted?"#d4edda":"#fff3cd",yr=$e.isCompleted?"#155724":"#856404",Cr=N;return Re.e=p(Ye,lt,Re.e),Re.t=p(ze,ot,Re.t),Re.a=p(je,nt,Re.a),Re.o=p(Xe,Ve,Re.o),Re.i=p(ht,qt,Re.i),Re.n=p(ut,Mt,Re.n),Re.s=p(Ue,Qt,Re.s),Re.h=p(it,lr,Re.h),bt!==Re.r&&((Re.r=bt)!=null?dt.style.setProperty("background",bt):dt.style.removeProperty("background")),yr!==Re.d&&((Re.d=yr)!=null?dt.style.setProperty("color",yr):dt.style.removeProperty("color")),Re.l=p(Fe,Cr,Re.l),Re},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),Me})()}})),fe($e=>{var Ee=k,Me=k,Ye=k,ze=k,je=k,Xe=k,ht={...k,"text-align":"right"},ut=k,Ue=k;return $e.e=p(de,Ee,$e.e),$e.t=p(he,Me,$e.t),$e.a=p(le,Ye,$e.a),$e.o=p(ye,ze,$e.o),$e.i=p(ve,je,$e.i),$e.n=p(pe,Xe,$e.n),$e.s=p(ge,ht,$e.s),$e.h=p(ke,ut,$e.h),$e.r=p(Ne,Ue,$e.r),$e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),ie}})}}),I(Oe,{get when(){return Te(()=>w()==="detail")()&&u()},get children(){return[(()=>{var ie=iF();return ie.firstChild,ie.$$click=()=>{E("dashboard"),y(null)},p(ie,H),a(ie,()=>e("invoices.backToDashboard"),null),ie})(),I(a8,{get invoice(){return u()},onPrint:()=>window.print(),get parseData(){return g()},goBack:()=>{E("dashboard"),y(null)}})]}})]}}),null),a(Q,I(Oe,{get when(){return j()==="add"},get children(){return I(TM,{})}}),null),a(Q,I(Oe,{get when(){return j()==="report"},get children(){return I(XM,{})}}),null),Q}})};br(["click"]);const hF=()=>I(uF,{invoices:[{type:"SALES",invoice:"20255FK6S4B43SSS",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCim",ssg_sorder_key:"JqdrRwGBpdBfRCim",createDate:1736132690425,shipper_consignee:{name:"Yudith Perez Medero",phoneNumberS:"5022408378",dob:"1982-07-23",firstName:"RAUL",lastName:"BATISTA",lastName2:"ESPOSITO",middleName:"",email:"",phoneNumber:"52393232",altPhoneNumber:"",cid:"48121007305",ybstreetNo:"9",ybstreet:"10",ybbetwen1:"CARRALERO",ybbetwen2:"3RA",ybapt:"",ybreparto:"PUEBLO NUEVO",consigneeId:"26144",ssg_consignee_key:"26144",passport:"NA",nacionality:"CUB",ybcity:"HOLGUIN",ybestate:"HOLGUIN",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534800",reservas:[{type:"UTILES DEL HOGAR",qty:"15",arancel:"10",price:"5",key:"1GB16SD80"},{type:"MISCELANEAS",qty:"19",arancel:"",price:"4",key:"0DS6K14Y2"}],products:[{product:{id:"CmrhMfVjLR9HxT6P",label:"FOGONES ELECTRICO DOBLE RESISTENCIA DE ALAMBRE",code:"978Y82K94"},qty:-1,price:23.696296296296296,salePrice:"34"},{product:{id:"ov56aPYGbXIq4XGy",label:"Caramelos",code:"C852CSKB5"},qty:-2,price:5.990000000000001,salePrice:"10"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43TTT",description:"",store:"YY_8803",ssg_inventory_key:"JqdrRwGBpdBfRCin",ssg_sorder_key:"JqdrRwGBpdBfRCin",createDate:1736032690425,shipper_consignee:{name:"Maria Rodriguez Santos",phoneNumberS:"5024567890",dob:"1990-03-15",firstName:"MARIA",lastName:"RODRIGUEZ",lastName2:"SANTOS",middleName:"ELENA",email:"maria@email.com",phoneNumber:"52987654",altPhoneNumber:"",cid:"90031507890",ybstreetNo:"15",ybstreet:"23",ybbetwen1:"MARTI",ybbetwen2:"CESPEDES",ybapt:"2A",ybreparto:"CENTRO",consigneeId:"26145",ssg_consignee_key:"26145",passport:"A1234567",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534801",reservas:[{type:"ELECTRONICOS",qty:"5",arancel:"15",price:"12",key:"2GB16SD81"},{type:"ROPA Y CALZADO",qty:"8",arancel:"8",price:"7",key:"0DS6K14Y3"}],products:[{product:{id:"XmrhMfVjLR9HxT6Q",label:"TELEVISOR LED 32 PULGADAS",code:"TV32LED01"},qty:-1,price:150.5,salePrice:"220"},{product:{id:"Yv56aPYGbXIq4XGz",label:"Zapatos Deportivos Nike",code:"ZAP001"},qty:-1,price:45.99,salePrice:"75"}],isCompleted:!1},{type:"SALES",invoice:"20255FK6S4B43UUU",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCio",ssg_sorder_key:"JqdrRwGBpdBfRCio",createDate:1735932690425,shipper_consignee:{name:"Carlos Mendez Perez",phoneNumberS:"5025678901",dob:"1975-12-08",firstName:"CARLOS",lastName:"MENDEZ",lastName2:"PEREZ",middleName:"ANTONIO",email:"",phoneNumber:"52876543",altPhoneNumber:"",cid:"75120878901",ybstreetNo:"7",ybstreet:"45",ybbetwen1:"LINEA",ybbetwen2:"PASEO",ybapt:"",ybreparto:"VEDADO",consigneeId:"26146",ssg_consignee_key:"26146",passport:"NA",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534802",reservas:[{type:"ALIMENTOS",qty:"25",arancel:"5",price:"3",key:"3GB16SD82"}],products:[{product:{id:"ZmrhMfVjLR9HxT6R",label:"ARROZ ESPECIAL 5LB",code:"ARZ005"},qty:-5,price:2.5,salePrice:"4"},{product:{id:"Av56aPYGbXIq4XG1",label:"ACEITE DE COCINA 1L",code:"ACE001"},qty:-3,price:3.75,salePrice:"6"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43VVV",description:"",store:"YY_8802",ssg_inventory_key:"JqdrRwGBpdBfRCip",ssg_sorder_key:"JqdrRwGBpdBfRCip",createDate:1735832690425,shipper_consignee:{name:"Ana Lucia Fernandez",phoneNumberS:"5026789012",dob:"1988-06-20",firstName:"ANA",lastName:"FERNANDEZ",lastName2:"LOPEZ",middleName:"LUCIA",email:"ana.lucia@email.com",phoneNumber:"52765432",altPhoneNumber:"52111222",cid:"88062076789",ybstreetNo:"12",ybstreet:"18",ybbetwen1:"CALZADA",ybbetwen2:"SAN LAZARO",ybapt:"3B",ybreparto:"CENTRO HABANA",consigneeId:"26147",ssg_consignee_key:"26147",passport:"B9876543",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:"Entrega en horario de oficina"},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534803",reservas:[{type:"MEDICINA Y SALUD",qty:"10",arancel:"12",price:"8",key:"4GB16SD83"},{type:"UTILES DEL HOGAR",qty:"6",arancel:"6",price:"4",key:"5GB16SD84"}],products:[{product:{id:"BmrhMfVjLR9HxT6S",label:"VITAMINAS MULTIPLES 60 CAP",code:"VIT001"},qty:-2,price:12.5,salePrice:"18"}],isCompleted:!0}]}),Ah={invoice:"",description:"",store:"",shipper_consignee:{name:"",firstName:"",middleName:"",lastName:"",lastName2:"",phoneNumber:"",cid:"",passport:"",address:""},products:[],reservas:[],bags:[],packagesOrder:!1,shippingType:"SEA"},hg="invoice_form_draft",pF=()=>{try{const t=localStorage.getItem(hg);if(t){const e=JSON.parse(t),r={...Ah,...e,shipper_consignee:{...Ah.shipper_consignee,...e.shipper_consignee||{}},products:e.products||[],reservas:e.reservas||[],bags:e.bags||[]};return console.log("Loaded form data from storage:",r),r}}catch(t){console.warn("Failed to load invoice form from storage:",t)}return console.log("No saved data found, using default form data"),{...Ah}},pg=t=>{try{localStorage.setItem(hg,JSON.stringify(t))}catch(e){console.warn("Failed to save invoice form to storage:",e)}},n1=()=>{try{localStorage.removeItem(hg)}catch(t){console.warn("Failed to clear invoice form from storage:",t)}},[_l,No]=we(pF()),[oP,ro]=we(!1),[mF,$h]=we(null);let Zm=null;const Uo=()=>{Zm&&clearTimeout(Zm),Zm=setTimeout(()=>{const t=_l();pg(t),$h(new Date),console.log("Invoice form auto-saved at",new Date().toLocaleTimeString())},1e3)},fF={formData:_l,get isDirty(){return oP()},get lastSaved(){return mF()},updateForm:t=>{No(e=>{const r={...e,...t};return ro(!0),Uo(),r})},updateShipperConsignee:t=>{No(e=>{const r={...e,shipper_consignee:{...e.shipper_consignee,...t}};return ro(!0),Uo(),r})},addProduct:t=>{No(e=>{const r={...e,products:[...e.products,t]};return ro(!0),Uo(),r})},updateProduct:(t,e)=>{No(r=>{const n=[...r.products];n[t]={...n[t],...e};const i={...r,products:n};return ro(!0),Uo(),i})},removeProduct:t=>{No(e=>{const r=e.products.filter((i,o)=>o!==t),n={...e,products:r};return ro(!0),Uo(),n})},addReserva:t=>{No(e=>{const r={...e,reservas:[...e.reservas,t]};return ro(!0),Uo(),r})},updateReserva:(t,e)=>{No(r=>{const n=[...r.reservas];n[t]={...n[t],...e};const i={...r,reservas:n};return ro(!0),Uo(),i})},removeReserva:t=>{No(e=>{const r=e.reservas.filter((i,o)=>o!==t),n={...e,reservas:r};return ro(!0),Uo(),n})},addBag:t=>{No(e=>{const r={...e,bags:[...e.bags,t]};return ro(!0),Uo(),r})},updateBag:(t,e)=>{No(r=>{const n=[...r.bags];n[t]={...n[t],...e};const i={...r,bags:n};return ro(!0),Uo(),i})},removeBag:t=>{No(e=>{const r=e.bags.filter((i,o)=>o!==t),n={...e,bags:r};return ro(!0),Uo(),n})},clearForm:()=>{No({...Ah}),ro(!1),n1(),$h(null)},markCompleted:()=>{n1(),ro(!1),$h(null)},forceSave:()=>{pg(_l()),$h(new Date),ro(!1)},hasData:()=>{const t=_l();return t.invoice!==""||t.description!==""||t.store!==""||t.shipper_consignee.name!==""||t.shipper_consignee.firstName!==""||t.shipper_consignee.cid!==""||t.products.length>0||t.reservas.length>0||t.bags.length>0},isValid:()=>{const t=_l();return t.invoice.trim()!==""&&t.shipper_consignee.name.trim()!==""&&(t.products.length>0||t.reservas.length>0)},getFormData:()=>_l()};typeof window<"u"&&window.addEventListener("beforeunload",t=>{if(oP()&&(pg(_l()),fF.hasData()))return t.preventDefault(),t.returnValue="You have unsaved changes in your invoice. Are you sure you want to leave?",t.returnValue});class yF{listeners=new Map;eventHistory=[];maxHistorySize=1e3;on(e,r,n){const i={id:n.id,eventTypes:Array.isArray(e)?e:[e],handler:r,priority:n.priority||100,isActive:n.isActive!==!1};return i.eventTypes.forEach(o=>{this.listeners.has(o)||this.listeners.set(o,[]);const l=this.listeners.get(o).filter(c=>c.id!==i.id);l.push(i),l.sort((c,d)=>d.priority-c.priority),this.listeners.set(o,l)}),i.id}off(e){this.listeners.forEach((r,n)=>{const i=r.filter(o=>o.id!==e);this.listeners.set(n,i)})}async emit(e){this.eventHistory.unshift(e),this.eventHistory.length>this.maxHistorySize&&(this.eventHistory=this.eventHistory.slice(0,this.maxHistorySize));const n=(this.listeners.get(e.type)||[]).filter(i=>i.isActive);for(const i of n)try{await i.handler(e)}catch(o){console.error(`Event listener ${i.id} failed for event ${e.type}:`,o)}}getHistory(e=100){return this.eventHistory.slice(0,e)}getListeners(e){if(e)return this.listeners.get(e)||[];const r=[];return this.listeners.forEach(n=>{n.forEach(i=>{r.find(o=>o.id===i.id)||r.push(i)})}),r}toggleListener(e,r){this.listeners.forEach(n=>{const i=n.find(o=>o.id===e);i&&(i.isActive=r)})}clearHistory(){this.eventHistory=[]}getStats(){const e={};let r=0;this.listeners.forEach((o,s)=>{e[s]=o.length,r+=o.length});const n=new Date(Date.now()-24*60*60*1e3),i=this.eventHistory.filter(o=>o.timestamp>n).reduce((o,s)=>{const l=o.find(c=>c.type===s.type);return l?l.count++:o.push({type:s.type,count:1}),o},[]);return{totalListeners:r,listenersByType:e,totalEvents:this.eventHistory.length,recentEvents:i}}}const sP=new yF,js={async getAll(){return kn(async()=>{const t=await yn({query:"getEventRules",queryString:"businessId = :businessId",params:{":businessId":vr.getBusinessId()}});return Pl(t)},()=>$n.eventRules.getAll())},async getById(t){return kn(async()=>{const e=await yn({query:"getEventRules",queryString:"businessId = :businessId AND id = :ruleId",params:{":businessId":vr.getBusinessId(),":ruleId":t}});return Pl(e)[0]||null},()=>$n.eventRules.getById(t))},async getByEventType(t){return kn(async()=>{const e=await yn({query:"getEventRules",queryString:"businessId = :businessId AND eventType = :eventType AND isActive = true",params:{":businessId":vr.getBusinessId(),":eventType":t}});return Pl(e)},()=>$n.eventRules.getByEventType(t))},async create(t){return kn(async()=>{const e={...t,id:`rule_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,businessId:vr.getBusinessId(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};console.log("Creating event rule with ID:",e.id),console.log("Rule data:",e);const r=await yn({query:"addEventRules",form:{data:e}});console.log("GraphQL response:",r);const n=r?.addEventRules;if(!n)throw new Error("Failed to create event rule");return n},()=>$n.eventRules.create(t))},async update(t,e){return kn(async()=>{const r={...e,id:t,businessId:vr.getBusinessId(),updatedAt:new Date().toISOString()},i=(await yn({query:"updateEventRules",form:{id:t,data:r}}))?.updateEventRules;if(!i)throw new Error("Failed to update event rule");return i},()=>$n.eventRules.update(t,e))},async delete(t){return kn(async()=>{if((await yn({query:"deleteEventRules",params:{id:t,businessId:vr.getBusinessId()}}))?.deleteEventRules)return{success:!0,message:"Event rule deleted successfully"};throw new Error("Failed to delete event rule")},()=>$n.eventRules.delete(t))},async toggleActive(t,e){return this.update(t,{isActive:e})},async testRule(t,e){return kn(async()=>(await yn({query:"testEventRule",form:{rule:t,sampleData:e,businessId:vr.getBusinessId()}}))?.testEventRule||{success:!1,error:"Failed to test rule"},()=>$n.eventRules.testRule(t,e))},async getExecutionHistory(t,e=100){return kn(async()=>{const r=t?"businessId = :businessId AND ruleId = :ruleId":"businessId = :businessId",n={":businessId":vr.getBusinessId()};t&&(n[":ruleId"]=t);const i=await yn({query:"getEventRuleHistory",queryString:r,params:n,form:{limit:e}});return Pl(i)},()=>$n.eventRules.getExecutionHistory(t,e))},async bulkToggle(t,e){return kn(async()=>(await yn({query:"bulkUpdateEventRules",form:{ruleIds:t,updates:{isActive:e,updatedAt:new Date().toISOString()},businessId:vr.getBusinessId()}}))?.bulkUpdateEventRules||{success:!1,updated:0,failed:t},()=>$n.eventRules.bulkToggle(t,e))},async exportRules(){return(await this.getAll()).map(e=>({...e,id:void 0,businessId:void 0}))},async importRules(t){return kn(async()=>(await yn({query:"importEventRules",form:{rules:t.map(r=>({...r,businessId:vr.getBusinessId()})),businessId:vr.getBusinessId()}}))?.importEventRules||{success:!1,imported:0,failed:t.length,errors:["Import failed"]},()=>$n.eventRules.importRules(t))}};class gF{rules=new Map;auditLog=[];constructor(){sP.on(["invoice_completed","invoice_created","invoice_updated","invoice_cancelled","payment_received","payment_refunded","inventory_received","inventory_sold","inventory_adjusted","expense_created","expense_approved","expense_paid","service_rendered","freight_processed","customs_cleared","bank_transaction_imported"],this.handleEvent.bind(this),{id:"automation_service",priority:50}),this.loadRulesFromApi()}addRule(e){const r={...e,id:`rule_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,createdAt:new Date,updatedAt:new Date};return this.rules.set(r.id,r),r.id}updateRule(e,r){const n=this.rules.get(e);if(!n)return!1;const i={...n,...r,id:e,updatedAt:new Date};return this.rules.set(e,i),!0}removeRule(e){return this.rules.delete(e)}getRules(){return Array.from(this.rules.values())}getRulesForEvent(e){return this.getRules().filter(r=>r.eventType===e&&r.isActive).sort((r,n)=>n.priority-r.priority)}async handleEvent(e){const r=this.getRulesForEvent(e.type);if(r.length===0)return;const n=[],i=[];let o=!0,s;try{for(const l of r)try{if(this.evaluateConditions(l.conditions,e)){const d=await this.createJournalEntry(l,e);n.push(l.name),i.push(d)}}catch(c){console.error(`Error executing rule ${l.name}:`,c),s=c instanceof Error?c.message:"Unknown error",o=!1}}catch(l){console.error("Error processing event automation:",l),s=l instanceof Error?l.message:"Unknown error",o=!1}this.auditLog.unshift({timestamp:new Date,eventId:e.id,eventType:e.type,rulesTriggered:n,entriesCreated:i,success:o,error:s}),this.auditLog.length>1e3&&(this.auditLog=this.auditLog.slice(0,1e3))}evaluateConditions(e,r){return e.length===0?!0:e.every(n=>{const i=this.getNestedValue(r,n.field);return this.evaluateCondition(i,n)})}evaluateCondition(e,r){const{operator:n,value:i,dataType:o}=r,s=this.convertValue(e,o),l=this.convertValue(i,o);switch(n){case"equals":return s===l;case"notEquals":return s!==l;case"greaterThan":return s>l;case"lessThan":return s<l;case"greaterThanOrEqual":return s>=l;case"lessThanOrEqual":return s<=l;case"contains":return String(s).toLowerCase().includes(String(l).toLowerCase());case"notContains":return!String(s).toLowerCase().includes(String(l).toLowerCase());case"in":return Array.isArray(l)&&l.includes(s);case"notIn":return Array.isArray(l)&&!l.includes(s);case"exists":return e!=null;case"notExists":return e==null;default:return!1}}convertValue(e,r){if(e==null)return e;switch(r){case"number":return Number(e);case"string":return String(e);case"boolean":return!!e;case"date":return new Date(e);case"array":return Array.isArray(e)?e:[e];default:return e}}async createJournalEntry(e,r){const{journalEntryTemplate:n}=e,i=this.processTemplate(n.description,r),o=this.processTemplate(n.reference,r),s=[];for(const y of n.lines){if(y.conditions&&y.conditions.length>0&&!this.evaluateConditions(y.conditions,r))continue;const g=this.evaluateAmountExpression(y.amountExpression,r);if(g===0)continue;const f=this.processTemplate(y.accountExpression,r),w=y.subAccountExpression?this.processTemplate(y.subAccountExpression,r):void 0,E=this.processTemplate(y.descriptionTemplate,r),x={id:`line_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,accountId:f,accountName:this.getAccountName(f),subAccountId:w,subAccountName:w?this.getAccountName(w):void 0,description:E,debitAmount:y.isDebit?g:0,creditAmount:y.isDebit?0:g,reference:o};s.push(x)}if(s.length===0)throw new Error("No valid journal entry lines generated");const l=s.reduce((y,g)=>y+g.debitAmount,0),c=s.reduce((y,g)=>y+g.creditAmount,0);if(Math.abs(l-c)>.01)throw new Error(`Journal entry not balanced. Debits: ${l}, Credits: ${c}`);const d={entryNumber:En.getNextEntryNumber(),date:new Date().toISOString().split("T")[0],description:i,reference:o,status:"draft",createdBy:"automation",createdAt:new Date().toISOString(),totalDebit:l,totalCredit:c,lines:s};return await En.addJournalEntry(d)}processTemplate(e,r){return e.replace(/\{([^}]+)\}/g,(n,i)=>{const o=this.getNestedValue(r,i);return String(o||n)})}evaluateAmountExpression(e,r){try{if(!isNaN(Number(e)))return Number(e);const n=this.getNestedValue(r,e);return Number(n)||0}catch(n){return console.error(`Error evaluating amount expression: ${e}`,n),0}}getNestedValue(e,r){return r.split(".").reduce((n,i)=>n?.[i],e)}getAccountName(e){return{1001:"Cash - Operating Account",1002:"Cash - Zelle Account",1003:"Cash - Credit Card Processing",1101:"Accounts Receivable - Customers",1102:"Accounts Receivable - Freight Charges",1201:"Inventory - Products",1202:"Inventory - Packaging Materials",1301:"Prepaid Expenses",1401:"Customs Fees Receivable",1402:"Transit Insurance Receivable",2001:"Accounts Payable",2002:"Freight Payable",2101:"Accrued Salaries",2102:"Accrued Rent",2301:"Sales Tax Payable",2302:"Customs Fees Payable",2303:"Transit Insurance Payable",3001:"Owner's Equity",3101:"Retained Earnings",4001:"Sales Revenue - Products",4101:"Service Revenue - General",4201:"Transport Service Revenue",4202:"Freight Revenue - Air",4203:"Freight Revenue - Sea",4301:"Processing Revenue - Packaging",4302:"Processing Revenue - Storage",5001:"Cost of Goods Sold - Products",5002:"Cost of Goods Sold - Packaging",5101:"Freight Expense - Air",5102:"Freight Expense - Sea",5103:"Local Transport Expense",5201:"Salaries and Wages",5202:"Rent Expense - Office",5203:"Rent Expense - Warehouse",5301:"Utilities Expense",5302:"Insurance Expense",5303:"Office Supplies",5401:"Professional Fees",5402:"Bank Fees",5403:"Credit Card Processing Fees",5501:"Vehicle Expenses",5502:"Equipment Maintenance",5601:"Depreciation Expense"}[e]||`Account ${e}`}getAuditLog(e=100){return this.auditLog.slice(0,e)}clearAuditLog(){this.auditLog=[]}exportRules(){return this.getRules()}importRules(e){this.rules.clear(),e.forEach(r=>{this.rules.set(r.id,r)})}syncRules(e){this.rules.clear(),e.forEach(r=>{this.rules.set(r.id,r)})}async loadRulesFromApi(){try{const e=await js.getAll();this.syncRules(e)}catch(e){console.error("Failed to load event rules from API:",e)}}testRule(e,r){const n=e.conditions.map(s=>({condition:s,result:this.evaluateCondition(this.getNestedValue(r,s.field),s)})),i=n.every(s=>s.result),o={wouldTrigger:i,conditionResults:n};if(i)try{const s=this.processTemplate(e.journalEntryTemplate.description,r),l=this.processTemplate(e.journalEntryTemplate.reference,r),c=e.journalEntryTemplate.lines.map(d=>{const u=this.evaluateAmountExpression(d.amountExpression,r),y=this.processTemplate(d.accountExpression,r),g=this.processTemplate(d.descriptionTemplate,r);return{accountId:y,accountName:this.getAccountName(y),description:g,debitAmount:d.isDebit?u:0,creditAmount:d.isDebit?0:u}});o.estimatedJournalEntry={description:s,reference:l,lines:c}}catch(s){o.errors=[s instanceof Error?s.message:"Unknown error"]}return o}}const dh=new gF,Tt=(t,e,r=!1,n)=>({type:t,description:e,required:r,...n}),vF={eventType:"invoice_completed",displayName:"Invoice Completed",description:"Triggered when an invoice is marked as completed",category:"financial",dataStructure:{"data.invoice":Tt("string","Invoice number",!0,{example:"B47G1D-YY_8635-20250810"}),"data.description":Tt("string","Invoice description",!1,{example:"Customer order description"}),"data.store":Tt("string","Store code",!0,{example:"YY_8665"}),"data.guide":Tt("string","Guide number",!0,{example:"2521"}),"data.createDate":Tt("date","Invoice creation date",!0,{example:"2025-08-13"}),"data.type":Tt("string","Invoice type",!0,{example:"SALES"}),"data.isCompleted":Tt("boolean","Invoice completion status",!0,{example:!0}),"data.shipper_consignee.name":Tt("string","Full name",!0,{example:"SUCEL NUNEZ JORGE"}),"data.shipper_consignee.firstName":Tt("string","First name",!1,{example:"YASEL"}),"data.shipper_consignee.middleName":Tt("string","Middle name",!1,{example:""}),"data.shipper_consignee.lastName":Tt("string","Last name",!1,{example:"VASQUES JORGE"}),"data.shipper_consignee.lastName2":Tt("string","Second last name",!1,{example:""}),"data.shipper_consignee.phoneNumber":Tt("string","Primary phone number",!1,{example:"531101638"}),"data.shipper_consignee.phoneNumberS":Tt("string","Secondary phone number",!1,{example:""}),"data.shipper_consignee.cid":Tt("string","Customer ID number",!1,{example:"82072829422"}),"data.shipper_consignee.passport":Tt("string","Passport number",!1,{example:""}),"data.shipper_consignee.address":Tt("string","Full address",!1,{example:"Calle undefined"}),"data.products[0].id":Tt("string","Product line item ID",!1,{example:"1755310725671"}),"data.products[0].product.id":Tt("string","Product ID",!1,{example:"AjlXorLU63dtPDrm"}),"data.products[0].product.code":Tt("string","Product code",!1,{example:"K89G06815"}),"data.products[0].product.label":Tt("string","Product label/name",!1,{example:"SAZON COMPLETO BADIA 7 OZ"}),"data.products[0].product.price":Tt("number","Product base price",!1,{format:"currency",example:0}),"data.products[0].qty":Tt("number","Product quantity",!1,{example:4}),"data.products[0].salePrice":Tt("number","Product sale price",!1,{format:"currency",example:8}),"data.products[0].total":Tt("number","Product line total",!1,{format:"currency",example:32}),"data.reservas[0].id":Tt("string","Reserva line item ID",!1,{example:"1755276669614"}),"data.reservas[0].type":Tt("string","Reserva type",!1,{example:"Ropa"}),"data.reservas[0].qty":Tt("number","Reserva quantity in lbs",!1,{example:120}),"data.reservas[0].price":Tt("number","Reserva price per lb",!1,{format:"currency",example:4}),"data.reservas[0].arancel":Tt("number","Reserva customs fee",!1,{format:"currency",example:0}),"data.reservas[0].total":Tt("number","Reserva line total",!1,{format:"currency",example:480}),"data.services[0].id":Tt("string","Service line item ID",!1,{example:"1755395460664"}),"data.services[0].type":Tt("string","Service type",!1,{example:" Transportacin"}),"data.services[0].qty":Tt("number","Service quantity",!1,{example:3}),"data.services[0].price":Tt("number","Service base price",!1,{format:"currency",example:0}),"data.services[0].arancel":Tt("number","Service fee per unit",!1,{format:"currency",example:20}),"data.services[0].total":Tt("number","Service line total",!1,{format:"currency",example:60}),"data.packagesOrder":Tt("boolean","Is packages order",!1,{example:!1}),"data.shippingMethod":Tt("string","Shipping method",!0,{example:"AEREO",options:[{value:"AEREO",label:"Air"},{value:"MARITIMO",label:"Maritime"}]}),"data.paymentMethods.taxOnTotal":Tt("boolean","Tax applied on total",!1,{example:!1}),"data.paymentMethods.taxPercent":Tt("number","Tax percentage",!1,{example:7}),"data.paymentMethods.exemptTaxOnCash":Tt("boolean","Cash payment tax exempt",!1,{example:!0}),"data.paymentMethods.cash":Tt("number","Cash payment amount",!1,{format:"currency",example:300}),"data.paymentMethods.zelle":Tt("number","Zelle payment amount",!1,{format:"currency",example:292}),"data.paymentMethods.creditCard":Tt("number","Credit card payment amount",!1,{format:"currency",example:0}),"data.businessId":Tt("string","Business ID",!0,{example:"YB100423253156428"}),"data.ssg_inventory_key":Tt("string","Inventory system key",!1,{example:"INVOICE-1755395719878"}),"data.ssg_sorder_key":Tt("string","Sales order key",!1,{example:"SO-1755395719878"}),"data.referenceHId":Tt("string","Reference hash ID",!1,{example:"xxhdlfvvmgvsn87q_1755395721386"}),"data.productSubtotal":Tt("number","Products subtotal",!0,{format:"currency",example:32}),"data.reservaSubtotal":Tt("number","Reservas subtotal",!0,{format:"currency",example:480}),"data.serviceSubtotal":Tt("number","Services subtotal",!0,{format:"currency",example:60}),"data.subtotalBeforeTax":Tt("number","Subtotal before tax",!0,{format:"currency",example:572}),"data.taxAmount":Tt("number","Total tax amount",!0,{format:"currency",example:19.75}),"data.taxSavings":Tt("number","Tax savings amount",!1,{format:"currency",example:20.29}),"data.total":Tt("number","Final total amount",!0,{format:"currency",example:591.75}),"data.taxCalculationMethod":Tt("string","Tax calculation method",!1,{example:"subtotal"}),"data.cashPaymentRatio":Tt("number","Cash payment ratio",!1,{example:.51})},examples:[{name:"Cash Sale Invoice",description:"Invoice paid entirely in cash",sampleData:{invoice:"INV-2024-001",customerId:"CUST-001",customerName:"ABC Corporation",totalAmount:1500,subtotalAmount:1300,taxAmount:200,paymentMethods:{cash:1500,zelle:0,creditCard:0,check:0,bankTransfer:0},currency:"USD",status:"completed"}},{name:"Mixed Payment Invoice",description:"Invoice with cash and Zelle payments",sampleData:{invoice:"INV-2024-002",customerId:"CUST-002",customerName:"XYZ Inc",totalAmount:2e3,subtotalAmount:1800,taxAmount:200,paymentMethods:{cash:1200,zelle:800,creditCard:0,check:0,bankTransfer:0},currency:"USD",status:"completed"}}]},bF={eventType:"payment_received",displayName:"Payment Received",description:"Triggered when a payment is received from a customer",category:"financial",dataStructure:{"data.paymentId":Tt("string","Payment ID",!0,{example:"PAY-2024-001"}),"data.invoiceId":Tt("string","Related invoice ID",!1,{example:"INV-2024-001"}),"data.customerId":Tt("string","Customer ID",!0),"data.customerName":Tt("string","Customer name",!0,{example:"ABC Corporation"}),"data.amount":Tt("number","Payment amount",!0,{format:"currency",example:1500}),"data.paymentMethod":Tt("string","Payment method",!0,{options:[{value:"cash",label:"Cash"},{value:"zelle",label:"Zelle"},{value:"creditCard",label:"Credit Card"},{value:"check",label:"Check"},{value:"bankTransfer",label:"Bank Transfer"}],example:"cash"}),"data.currency":Tt("string","Currency code",!0,{example:"USD"}),"data.exchangeRate":Tt("number","Exchange rate",!1,{example:1}),"data.reference":Tt("string","Payment reference",!0,{example:"REF-001"}),"data.bankAccount":Tt("string","Bank account used",!1,{example:"BOA-Checking-001"}),"data.depositDate":Tt("date","Date payment was deposited",!1,{format:"date",example:"2024-01-15"})},examples:[{name:"Cash Payment",description:"Cash payment for an invoice",sampleData:{paymentId:"PAY-2024-001",invoiceId:"INV-2024-001",customerId:"CUST-001",customerName:"ABC Corporation",amount:1500,paymentMethod:"cash",currency:"USD",reference:"CASH-001"}}]},_F={eventType:"inventory_received",displayName:"Inventory Received",description:"Triggered when inventory is received from suppliers",category:"inventory",dataStructure:{"data.movementId":Tt("string","Movement ID",!0,{example:"MOV-2024-001"}),"data.productId":Tt("string","Product ID",!0,{example:"PROD-001"}),"data.productName":Tt("string","Product name",!0,{example:"Widget A"}),"data.sku":Tt("string","Product SKU",!0,{example:"WID-A-001"}),"data.category":Tt("string","Product category",!0,{example:"Electronics"}),"data.quantity":Tt("number","Quantity received",!0,{example:100}),"data.unitCost":Tt("number","Cost per unit",!0,{format:"currency",example:25}),"data.totalCost":Tt("number","Total cost",!0,{format:"currency",example:2500}),"data.supplierId":Tt("string","Supplier ID",!1,{example:"SUPP-001"}),"data.supplierName":Tt("string","Supplier name",!1,{example:"Acme Supplies"}),"data.purchaseOrderId":Tt("string","Purchase order ID",!1,{example:"PO-2024-001"}),"data.warehouseLocation":Tt("string","Warehouse location",!0,{example:"WH-A-001"}),"data.movementType":Tt("string","Type of movement",!0,{options:[{value:"purchase",label:"Purchase"},{value:"sale",label:"Sale"},{value:"adjustment",label:"Adjustment"},{value:"transfer",label:"Transfer"}],example:"purchase"})},examples:[{name:"Product Purchase",description:"Products received from supplier",sampleData:{movementId:"MOV-2024-001",productId:"PROD-001",productName:"Widget A",sku:"WID-A-001",category:"Electronics",quantity:100,unitCost:25,totalCost:2500,supplierId:"SUPP-001",supplierName:"Acme Supplies",movementType:"purchase"}}]},PF={eventType:"expense_created",displayName:"Expense Created",description:"Triggered when a new expense is created",category:"financial",dataStructure:{"data.expenseId":Tt("string","Expense ID",!0,{example:"EXP-2024-001"}),"data.category":Tt("string","Expense category",!0,{options:[{value:"office_supplies",label:"Office Supplies"},{value:"travel",label:"Travel"},{value:"utilities",label:"Utilities"},{value:"rent",label:"Rent"},{value:"equipment",label:"Equipment"},{value:"marketing",label:"Marketing"},{value:"professional_services",label:"Professional Services"}],example:"office_supplies"}),"data.subcategory":Tt("string","Expense subcategory",!1,{example:"Stationery"}),"data.description":Tt("string","Expense description",!0,{example:"Office supplies from Staples"}),"data.amount":Tt("number","Expense amount",!0,{format:"currency",example:250}),"data.currency":Tt("string","Currency code",!0,{example:"USD"}),"data.vendorId":Tt("string","Vendor ID",!1,{example:"VEND-001"}),"data.vendorName":Tt("string","Vendor name",!1,{example:"Staples Inc"}),"data.employeeId":Tt("string","Employee ID",!1,{example:"EMP-001"}),"data.employeeName":Tt("string","Employee name",!1,{example:"John Doe"}),"data.departmentId":Tt("string","Department ID",!1,{example:"DEPT-001"}),"data.departmentName":Tt("string","Department name",!1,{example:"Administration"}),"data.paymentMethod":Tt("string","Payment method",!0,{options:[{value:"cash",label:"Cash"},{value:"check",label:"Check"},{value:"creditCard",label:"Credit Card"},{value:"bankTransfer",label:"Bank Transfer"}],example:"creditCard"}),"data.reference":Tt("string","Reference number",!0,{example:"REF-001"}),"data.receiptAttached":Tt("boolean","Receipt attached",!1,{example:!0})},examples:[{name:"Office Supplies Expense",description:"Office supplies purchased with credit card",sampleData:{expenseId:"EXP-2024-001",category:"office_supplies",description:"Office supplies from Staples",amount:250,currency:"USD",vendorName:"Staples Inc",paymentMethod:"creditCard",reference:"CC-001",receiptAttached:!0}}]},SF={eventType:"service_rendered",displayName:"Service Rendered",description:"Triggered when a service is completed for a customer",category:"operational",dataStructure:{"data.serviceId":Tt("string","Service ID",!0,{example:"SRV-2024-001"}),"data.serviceType":Tt("string","Type of service",!0,{options:[{value:"transport",label:"Transportation"},{value:"packaging",label:"Packaging"},{value:"storage",label:"Storage"},{value:"customs",label:"Customs Clearance"},{value:"processing",label:"Processing"},{value:"other",label:"Other"}],example:"transport"}),"data.description":Tt("string","Service description",!0,{example:"Transportation from Miami to NYC"}),"data.customerId":Tt("string","Customer ID",!0,{example:"CUST-001"}),"data.customerName":Tt("string","Customer name",!0,{example:"ABC Corporation"}),"data.amount":Tt("number","Service amount",!0,{format:"currency",example:500}),"data.currency":Tt("string","Currency code",!0,{example:"USD"}),"data.quantity":Tt("number","Service quantity",!1,{example:1}),"data.unitPrice":Tt("number","Price per unit",!1,{format:"currency",example:500}),"data.invoiceId":Tt("string","Related invoice ID",!1,{example:"INV-2024-001"}),"data.reference":Tt("string","Service reference",!0,{example:"TRANS-001"}),"data.serviceDate":Tt("date","Date service was performed",!0,{format:"date",example:"2024-01-15"}),"data.location":Tt("string","Service location",!1,{example:"Miami, FL"}),"data.weight":Tt("number","Weight (if applicable)",!1,{example:150.5}),"data.trackingNumber":Tt("string","Tracking number",!1,{example:"TRK-123456"})},examples:[{name:"Transportation Service",description:"Freight transportation service",sampleData:{serviceId:"SRV-2024-001",serviceType:"transport",description:"Transportation from Miami to NYC",customerId:"CUST-001",customerName:"ABC Corporation",amount:500,currency:"USD",reference:"TRANS-001",serviceDate:"2024-01-15",weight:150.5}}]},wF={invoice_completed:vF,payment_received:bF,inventory_received:_F,expense_created:PF,service_rendered:SF},aP=t=>wF[t]||null,xF=t=>{const e=aP(t);return e?Object.entries(e.dataStructure).map(([r,n])=>({path:r,definition:n})):[]};var CF=ae("<label>"),AF=ae("<div>No fields found matching your criteria"),$F=ae('<div><div><input type=text placeholder="Search fields..."><div></div></div><div>'),EF=ae("<div>"),IF=ae("<div><button type=button><span></span><span>"),TF=ae("<button type=button> "),kF=ae("<p>Example: <code>"),NF=ae("<div><div><code></code><span></span></div><p>");const LF=t=>{hu();const[e,r]=we(!1),[n,i]=we(""),[o,s]=we("all"),l=Ut(()=>{const j=n().toLowerCase(),q=o();return t.availableFields.filter(J=>{const C=!j||J.path.toLowerCase().includes(j)||J.definition.description.toLowerCase().includes(j),P=q==="all"||q==="required"&&J.definition.required||q==="number"&&J.definition.type==="number"||q==="string"&&J.definition.type==="string"||q==="payment"&&J.path.includes("payment")||q==="customer"&&J.path.includes("customer");return C&&P})}),c=j=>{t.onFieldSelect(j),r(!1),i("")},d=j=>{switch(j){case"number":return"#dbeafe";case"string":return"#fef3c7";case"boolean":return"#dcfce7";case"date":return"#f3e8ff";default:return"#f3f4f6"}},u=j=>{switch(j){case"number":return"#1e40af";case"string":return"#92400e";case"boolean":return"#166534";case"date":return"#7c3aed";default:return"#374151"}},y=[{value:"all",label:"All Fields",icon:""},{value:"required",label:"Required",icon:""},{value:"number",label:"Numbers",icon:""},{value:"string",label:"Text",icon:""},{value:"payment",label:"Payments",icon:""},{value:"customer",label:"Customer",icon:""}],g={position:"relative",width:"100%"},f={width:"100%",padding:"0.75rem","background-color":"white",border:"1px solid #d1d5db","border-radius":"0.375rem","text-align":"left",cursor:"pointer","font-size":"0.875rem",display:"flex","justify-content":"space-between","align-items":"center"},w={position:"absolute",top:"100%",left:"0",right:"0","z-index":"50","background-color":"white",border:"1px solid #d1d5db","border-radius":"0.375rem","box-shadow":"0 10px 15px -3px rgba(0, 0, 0, 0.1)","margin-top":"0.25rem","max-height":"400px","overflow-y":"auto"},E={padding:"1rem","border-bottom":"1px solid #e5e7eb","background-color":"#f9fafb"},x={width:"100%",padding:"0.5rem",border:"1px solid #d1d5db","border-radius":"0.375rem","font-size":"0.875rem","margin-bottom":"0.75rem"},T={display:"flex","flex-wrap":"wrap",gap:"0.5rem"},Y=j=>({padding:"0.25rem 0.75rem","border-radius":"0.375rem",border:"none",cursor:"pointer","font-size":"0.75rem","background-color":j?"#3b82f6":"#f3f4f6",color:j?"white":"#374151"}),K={padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid #f3f4f6","hover:background-color":"#f9fafb"};return(()=>{var j=IF(),q=j.firstChild,J=q.firstChild,C=J.nextSibling;return a(j,I(Oe,{get when(){return t.label},get children(){var P=CF();return P.style.setProperty("display","block"),P.style.setProperty("font-weight","500"),P.style.setProperty("margin-bottom","0.5rem"),P.style.setProperty("font-size","0.875rem"),a(P,()=>t.label),P}}),q),q.addEventListener("mouseleave",P=>P.currentTarget.style.borderColor="#d1d5db"),q.addEventListener("mouseenter",P=>P.currentTarget.style.borderColor="#3b82f6"),q.$$click=()=>r(!e()),J.style.setProperty("color","#6b7280"),a(J,()=>t.placeholder||"Select a field from data interface..."),C.style.setProperty("transition","transform 0.2s"),a(j,I(Oe,{get when(){return e()},get children(){var P=$F(),$=P.firstChild,D=$.firstChild,b=D.nextSibling,S=$.nextSibling;return p($,E),D.$$input=v=>i(v.currentTarget.value),p(D,x),a(b,I(Ct,{each:y,children:v=>(()=>{var z=TF(),re=z.firstChild;return z.$$click=()=>s(v.value),a(z,()=>v.icon,re),a(z,()=>v.label,null),fe(L=>p(z,Y(o()===v.value),L)),z})()})),a(S,I(Oe,{get when(){return l().length===0},get children(){var v=AF();return v.style.setProperty("padding","2rem"),v.style.setProperty("text-align","center"),v.style.setProperty("color","#6b7280"),v}}),null),a(S,I(Ct,{get each(){return l()},children:v=>(()=>{var z=NF(),re=z.firstChild,L=re.firstChild,O=L.nextSibling,ne=re.nextSibling;return z.addEventListener("mouseleave",X=>X.currentTarget.style.backgroundColor="transparent"),z.addEventListener("mouseenter",X=>X.currentTarget.style.backgroundColor="#f9fafb"),z.$$click=()=>c(v.path),p(z,K),re.style.setProperty("display","flex"),re.style.setProperty("justify-content","space-between"),re.style.setProperty("align-items","center"),re.style.setProperty("margin-bottom","0.25rem"),L.style.setProperty("font-family","monospace"),L.style.setProperty("font-size","0.875rem"),L.style.setProperty("color","#059669"),L.style.setProperty("font-weight","600"),a(L,()=>v.path),O.style.setProperty("font-size","0.7rem"),O.style.setProperty("padding","0.125rem 0.375rem"),O.style.setProperty("border-radius","0.25rem"),O.style.setProperty("font-weight","500"),a(O,()=>v.definition.type,null),a(O,()=>v.definition.required&&" *",null),ne.style.setProperty("font-size","0.75rem"),ne.style.setProperty("color","#6b7280"),ne.style.setProperty("margin","0 0 0.25rem 0"),a(ne,()=>v.definition.description),a(z,I(Oe,{get when(){return v.definition.example},get children(){var X=kF(),W=X.firstChild,se=W.nextSibling;return X.style.setProperty("font-size","0.7rem"),X.style.setProperty("color","#374151"),X.style.setProperty("margin","0"),X.style.setProperty("font-style","italic"),se.style.setProperty("background-color","#f3f4f6"),se.style.setProperty("padding","0.125rem 0.25rem"),se.style.setProperty("border-radius","0.125rem"),a(se,(()=>{var F=Te(()=>typeof v.definition.example=="object");return()=>F()?JSON.stringify(v.definition.example):v.definition.example})()),X}}),null),fe(X=>{var W=d(v.definition.type),se=u(v.definition.type);return W!==X.e&&((X.e=W)!=null?O.style.setProperty("background-color",W):O.style.removeProperty("background-color")),se!==X.t&&((X.t=se)!=null?O.style.setProperty("color",se):O.style.removeProperty("color")),X},{e:void 0,t:void 0}),z})()}),null),fe(v=>{var z=w,re=T;return v.e=p(P,z,v.e),v.t=p(b,re,v.t),v},{e:void 0,t:void 0}),fe(()=>D.value=n()),P}}),null),a(j,I(Oe,{get when(){return e()},get children(){var P=EF();return P.$$click=()=>r(!1),P.style.setProperty("position","fixed"),P.style.setProperty("top","0"),P.style.setProperty("left","0"),P.style.setProperty("right","0"),P.style.setProperty("bottom","0"),P.style.setProperty("z-index","40"),P}}),null),fe(P=>{var $=g,D=f,b=e()?"rotate(180deg)":"none";return P.e=p(j,$,P.e),P.t=p(q,D,P.t),b!==P.a&&((P.a=b)!=null?C.style.setProperty("transform",b):C.style.removeProperty("transform")),P},{e:void 0,t:void 0,a:void 0}),j})()};br(["click","input"]);var RF=ae('<div><h4>Create New Custom Field</h4><div><div><label>Field Name *</label><input type=text placeholder="e.g., totalWithTax, customerInfo"></div><div><label>Expression *</label><div><input type=text placeholder="e.g., data.subtotal + data.tax"></div><div><p> Quick templates:</p><div></div></div></div><div><label>Description</label><input type=text placeholder="Describe what this field represents"></div><div><button>Cancel</button><button>Create Field'),DF=ae("<div><p>No custom fields created yet</p><p>Create custom fields to combine multiple interface fields into reusable expressions"),MF=ae("<div><div><div><h3> Custom Fields</h3><p>Create custom expressions by combining interface fields</p></div><button>+ Add Custom Field</button></div><div>"),FF=ae("<button type=button>"),OF=ae("<p>"),BF=ae("<div><div><div><div><h4></h4><span>custom field</span></div><div><code></code></div></div><div><button>Remove");const jF=t=>{hu();const[e,r]=we(!1),[n,i]=we(null),[o,s]=we({name:"",expression:"",description:""}),l=()=>{const K=o();K.name.trim()&&K.expression.trim()&&(t.onAdd(K),s({name:"",expression:"",description:""}),r(!1))},c=K=>{const j=o().expression,q=j?`${j} + ${K}`:K;s(J=>({...J,expression:q}))},d=K=>{s(j=>({...j,expression:K}))},u=[{label:"Total with Tax",expression:"data.subtotalAmount + data.taxAmount",description:"Subtotal plus tax amount"},{label:"Total Payments",expression:"data.paymentMethods.cash + data.paymentMethods.zelle + data.paymentMethods.creditCard",description:"Sum of all payment methods"},{label:"Customer Info",expression:'data.customerName + " (" + data.customerId + ")"',description:"Customer name with ID"},{label:"Invoice Reference",expression:'"Invoice " + data.invoice + " - " + data.customerName',description:"Complete invoice reference"}],y={border:"1px solid #d1d5db","border-radius":"0.5rem","background-color":"#f9fafb",padding:"1.5rem"},g={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem"},f={padding:"0.5rem 1rem","background-color":"#3b82f6",color:"white",border:"none","border-radius":"0.375rem",cursor:"pointer","font-weight":"500","font-size":"0.875rem"},w={...f,"background-color":"#6b7280"},E={...f,"background-color":"#ef4444"},x={width:"100%",padding:"0.5rem",border:"1px solid #d1d5db","border-radius":"0.375rem","font-size":"0.875rem"},T={"background-color":"white",border:"1px solid #e5e7eb","border-radius":"0.375rem",padding:"1rem","margin-bottom":"1rem"},Y={"background-color":"white",border:"1px solid #d1d5db","border-radius":"0.375rem",padding:"1.5rem","margin-bottom":"1.5rem"};return(()=>{var K=MF(),j=K.firstChild,q=j.firstChild,J=q.firstChild,C=J.nextSibling,P=q.nextSibling,$=j.nextSibling;return p(K,y),p(j,g),J.style.setProperty("font-size","1.125rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("margin","0 0 0.25rem 0"),C.style.setProperty("font-size","0.875rem"),C.style.setProperty("color","#6b7280"),C.style.setProperty("margin","0"),P.$$click=()=>r(!e()),a(K,I(Oe,{get when(){return e()},get children(){var D=RF(),b=D.firstChild,S=b.nextSibling,v=S.firstChild,z=v.firstChild,re=z.nextSibling,L=v.nextSibling,O=L.firstChild,ne=O.nextSibling,X=ne.firstChild,W=ne.nextSibling,se=W.firstChild,F=se.nextSibling,k=L.nextSibling,N=k.firstChild,A=N.nextSibling,V=k.nextSibling,Z=V.firstChild,H=Z.nextSibling;return p(D,Y),b.style.setProperty("font-size","1rem"),b.style.setProperty("font-weight","600"),b.style.setProperty("margin-bottom","1rem"),S.style.setProperty("display","grid"),S.style.setProperty("gap","1rem"),z.style.setProperty("display","block"),z.style.setProperty("font-weight","500"),z.style.setProperty("margin-bottom","0.5rem"),re.$$input=B=>s(M=>({...M,name:B.currentTarget.value})),O.style.setProperty("display","block"),O.style.setProperty("font-weight","500"),O.style.setProperty("margin-bottom","0.5rem"),ne.style.setProperty("display","grid"),ne.style.setProperty("grid-template-columns","2fr 1fr"),ne.style.setProperty("gap","0.5rem"),ne.style.setProperty("margin-bottom","0.5rem"),X.$$input=B=>s(M=>({...M,expression:B.currentTarget.value})),a(ne,I(LF,{get availableFields(){return t.availableFields},onFieldSelect:c,placeholder:"Insert field..."}),null),W.style.setProperty("margin-bottom","0.5rem"),se.style.setProperty("font-size","0.75rem"),se.style.setProperty("color","#6b7280"),se.style.setProperty("margin-bottom","0.5rem"),F.style.setProperty("display","flex"),F.style.setProperty("flex-wrap","wrap"),F.style.setProperty("gap","0.5rem"),a(F,I(Ct,{each:u,children:B=>(()=>{var M=FF();return M.$$click=()=>d(B.expression),M.style.setProperty("padding","0.25rem 0.5rem"),M.style.setProperty("background-color","#f3f4f6"),M.style.setProperty("color","#374151"),M.style.setProperty("border","1px solid #d1d5db"),M.style.setProperty("border-radius","0.25rem"),M.style.setProperty("cursor","pointer"),M.style.setProperty("font-size","0.75rem"),a(M,()=>B.label),fe(()=>ir(M,"title",B.description)),M})()})),N.style.setProperty("display","block"),N.style.setProperty("font-weight","500"),N.style.setProperty("margin-bottom","0.5rem"),A.$$input=B=>s(M=>({...M,description:B.currentTarget.value})),V.style.setProperty("display","flex"),V.style.setProperty("gap","0.5rem"),V.style.setProperty("justify-content","flex-end"),Z.$$click=()=>r(!1),H.$$click=l,fe(B=>{var M=x,G=x,Q=x,ie=w,me=f;return B.e=p(re,M,B.e),B.t=p(X,G,B.t),B.a=p(A,Q,B.a),B.o=p(Z,ie,B.o),B.i=p(H,me,B.i),B},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),fe(()=>re.value=o().name),fe(()=>X.value=o().expression),fe(()=>A.value=o().description),D}}),$),a($,I(Oe,{get when(){return t.customFields.length===0},get children(){var D=DF(),b=D.firstChild,S=b.nextSibling;return D.style.setProperty("padding","3rem"),D.style.setProperty("text-align","center"),D.style.setProperty("color","#6b7280"),D.style.setProperty("background-color","white"),D.style.setProperty("border-radius","0.375rem"),D.style.setProperty("border","1px solid #e5e7eb"),b.style.setProperty("font-size","1rem"),b.style.setProperty("margin-bottom","0.5rem"),S.style.setProperty("font-size","0.875rem"),D}}),null),a($,I(Ct,{get each(){return t.customFields},children:D=>(()=>{var b=BF(),S=b.firstChild,v=S.firstChild,z=v.firstChild,re=z.firstChild,L=re.nextSibling,O=z.nextSibling,ne=O.firstChild,X=v.nextSibling,W=X.firstChild;return p(b,T),S.style.setProperty("display","flex"),S.style.setProperty("justify-content","space-between"),S.style.setProperty("align-items","start"),v.style.setProperty("flex-grow","1"),z.style.setProperty("display","flex"),z.style.setProperty("align-items","center"),z.style.setProperty("gap","0.75rem"),z.style.setProperty("margin-bottom","0.5rem"),re.style.setProperty("font-size","1rem"),re.style.setProperty("font-weight","600"),re.style.setProperty("margin","0"),re.style.setProperty("color","#1f2937"),a(re,()=>D.name),L.style.setProperty("font-size","0.7rem"),L.style.setProperty("padding","0.125rem 0.5rem"),L.style.setProperty("background-color","#dbeafe"),L.style.setProperty("color","#1e40af"),L.style.setProperty("border-radius","0.25rem"),L.style.setProperty("font-weight","500"),O.style.setProperty("margin-bottom","0.5rem"),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","#4b5563"),ne.style.setProperty("font-family","monospace"),ne.style.setProperty("background-color","#f3f4f6"),ne.style.setProperty("padding","0.5rem"),ne.style.setProperty("border-radius","0.25rem"),ne.style.setProperty("display","block"),a(ne,()=>D.expression),a(v,I(Oe,{get when(){return D.description},get children(){var se=OF();return se.style.setProperty("font-size","0.875rem"),se.style.setProperty("color","#6b7280"),se.style.setProperty("margin","0"),a(se,()=>D.description),se}}),null),X.style.setProperty("display","flex"),X.style.setProperty("gap","0.5rem"),W.$$click=()=>t.onRemove(D.id),fe(se=>p(W,{...E,padding:"0.5rem","font-size":"0.75rem"},se)),b})()}),null),fe(D=>p(P,f,D)),K})()};br(["click","input"]);var VF=ae("<input>");const qF=t=>{const[e,r]=we("");xi(()=>{t?.value!==void 0&&r(t.value.toString())});const n=o=>{(o.key==="Enter"||o.key==="Escape"||o.key==="Tab")&&t.onChange&&Gs(e())&&t.onChange(e())},i=()=>{Gs(e())&&t.onChange(e())};return(()=>{var o=VF();return o.addEventListener("blur",s=>{i(),s.target.style.borderColor="var(--border-color)"}),o.addEventListener("focus",s=>{s.target.style.borderColor="var(--primary-color)"}),o.$$keydown=n,o.$$input=s=>r(s.target.value),fe(s=>{var l=t.type||"text",c=t.placeholder,d=t.required,u=t.disabled,y=t.style;return l!==s.e&&ir(o,"type",s.e=l),c!==s.t&&ir(o,"placeholder",s.t=c),d!==s.a&&(o.required=s.a=d),u!==s.o&&(o.disabled=s.o=u),s.i=p(o,y,s.i),s},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),fe(()=>o.value=e()),o})()};br(["input","keydown"]);var zF=ae("<p>"),UF=ae("<div><div><div><p>Available Fields</p><p>Click a field to insert it at cursor position</p></div><div>"),HF=ae("<div>"),GF=ae("<div><label></label><div><button type=button> Fields"),WF=ae("<div><div><code></code><span></span></div><p>");const uh=t=>{const[e,r]=we(!1),[n,i]=we(0),o=g=>{const f=t.value,w=f.substring(0,n()),E=f.substring(n());let x=g;t.type==="text"&&!g.startsWith("{")&&(x=`{${g}}`);const T=w+x+E;t.onInput(T),r(!1)},s=g=>{const f=g.currentTarget;i(f.selectionStart||0)},l={position:"relative",width:"100%"},c={display:"flex",gap:"0.5rem","align-items":"stretch"},d={"flex-grow":"1",padding:"0.5rem",border:"1px solid #d1d5db","border-radius":"0.375rem","font-size":"0.875rem"},u={padding:"0.5rem","background-color":"#f3f4f6",color:"#374151",border:"1px solid #d1d5db","border-radius":"0.375rem",cursor:"pointer","font-size":"0.75rem","white-space":"nowrap","font-weight":"500"},y={"font-size":"0.75rem",color:"#6b7280","margin-top":"0.25rem"};return(()=>{var g=GF(),f=g.firstChild,w=f.nextSibling,E=w.firstChild;return f.style.setProperty("display","block"),f.style.setProperty("font-weight","500"),f.style.setProperty("margin-bottom","0.5rem"),a(f,()=>t.label),p(w,c),a(w,I(qF,{type:"text",style:d,get value(){return t.value},get placeholder(){return t.placeholder},onChange:x=>t.onInput(x),onClick:s}),E),E.addEventListener("mouseleave",x=>x.currentTarget.style.backgroundColor="#f3f4f6"),E.addEventListener("mouseenter",x=>x.currentTarget.style.backgroundColor="#e5e7eb"),E.$$click=()=>r(!e()),a(g,I(Oe,{get when(){return t.helpText},get children(){var x=zF();return p(x,y),a(x,()=>t.helpText),x}}),null),a(g,I(Oe,{get when(){return e()},get children(){var x=UF(),T=x.firstChild,Y=T.firstChild,K=Y.firstChild,j=K.nextSibling,q=Y.nextSibling;return x.style.setProperty("position","absolute"),x.style.setProperty("top","100%"),x.style.setProperty("left","0"),x.style.setProperty("right","0"),x.style.setProperty("z-index","50"),x.style.setProperty("margin-top","0.25rem"),T.style.setProperty("background-color","white"),T.style.setProperty("border","1px solid #d1d5db"),T.style.setProperty("border-radius","0.375rem"),T.style.setProperty("box-shadow","0 10px 15px -3px rgba(0, 0, 0, 0.1)"),T.style.setProperty("max-height","300px"),T.style.setProperty("overflow-y","auto"),Y.style.setProperty("padding","0.75rem"),Y.style.setProperty("border-bottom","1px solid #e5e7eb"),Y.style.setProperty("background-color","#f9fafb"),K.style.setProperty("font-size","0.875rem"),K.style.setProperty("font-weight","600"),K.style.setProperty("margin","0 0 0.25rem 0"),j.style.setProperty("font-size","0.75rem"),j.style.setProperty("color","#6b7280"),j.style.setProperty("margin","0"),a(q,I(Ct,{get each(){return t.availableFields},children:J=>(()=>{var C=WF(),P=C.firstChild,$=P.firstChild,D=$.nextSibling,b=P.nextSibling;return C.addEventListener("mouseleave",S=>S.currentTarget.style.backgroundColor="transparent"),C.addEventListener("mouseenter",S=>S.currentTarget.style.backgroundColor="#f9fafb"),C.$$click=()=>o(J.path),C.style.setProperty("padding","0.75rem"),C.style.setProperty("cursor","pointer"),C.style.setProperty("border-bottom","1px solid #f3f4f6"),P.style.setProperty("display","flex"),P.style.setProperty("justify-content","space-between"),P.style.setProperty("align-items","center"),P.style.setProperty("margin-bottom","0.25rem"),$.style.setProperty("font-family","monospace"),$.style.setProperty("font-size","0.875rem"),$.style.setProperty("color","#059669"),$.style.setProperty("font-weight","600"),a($,()=>J.path),D.style.setProperty("font-size","0.7rem"),D.style.setProperty("padding","0.125rem 0.375rem"),D.style.setProperty("border-radius","0.25rem"),a(D,()=>J.definition.type),b.style.setProperty("font-size","0.75rem"),b.style.setProperty("color","#6b7280"),b.style.setProperty("margin","0"),a(b,()=>J.definition.description),fe(S=>{var v=J.definition.type==="number"?"#dbeafe":"#fef3c7",z=J.definition.type==="number"?"#1e40af":"#92400e";return v!==S.e&&((S.e=v)!=null?D.style.setProperty("background-color",v):D.style.removeProperty("background-color")),z!==S.t&&((S.t=z)!=null?D.style.setProperty("color",z):D.style.removeProperty("color")),S},{e:void 0,t:void 0}),C})()})),x}}),null),a(g,I(Oe,{get when(){return e()},get children(){var x=HF();return x.$$click=()=>r(!1),x.style.setProperty("position","fixed"),x.style.setProperty("top","0"),x.style.setProperty("left","0"),x.style.setProperty("right","0"),x.style.setProperty("bottom","0"),x.style.setProperty("z-index","40"),x}}),null),fe(x=>{var T=l,Y=u;return x.e=p(g,T,x.e),x.t=p(E,Y,x.t),x},{e:void 0,t:void 0}),g})()};br(["click"]);var YF=ae("<div><p><strong>:</strong> </p><button type=button>"),i1=ae("<div>"),KF=ae("<div><h5></h5><p></p><div></div><div><p> <strong>Usage Tip:</strong> Copy field paths like <code>data.totalAmount</code> or <code>data.customerName</code> to use in conditions and journal entry templates."),JF=ae("<div><h3> Data Interface & Examples</h3><div><div><h4> Available Fields</h4><div></div></div><div><h4> Sample Data Examples"),QF=ae("<p> <!> events"),XF=ae("<p>"),ZF=ae("<div><div><h2></h2><div><h3></h3><div><div><label> *</label><input type=text></div><div><label></label><input type=number min=1 max=1000></div></div><div><label> *</label><textarea></textarea></div><div><div><label> *</label><select></select></div><div><label><input type=checkbox></label></div></div></div><div><div><h3></h3><button>+ </button></div></div><div><div><h3></h3><div><button type=button></button><button></button></div></div><div></div><div><h4></h4><button>+ </button></div></div><div><button></button><button>"),o1=ae("<option>"),e9=ae("<p>Example: <code>"),t9=ae("<div><div><code></code><span></span></div><p>"),r9=ae("<button type=button>"),n9=ae("<input>"),i9=ae("<div><div><div><label></label><select><option value></option></select></div><div><label></label><select></select></div><div><label></label></div><div><button>"),o9=ae("<option> (<!>)"),s9=ae("<input type=text value=N/A disabled>"),a9=ae("<div><div><h5>Journal Line </h5><button></button></div><div><div><label></label><select></select></div><div><label></label><select><option value=debit></option><option value=credit></option></select></div></div><div>"),l9=ae("<option> - <!> (<!>)");const c9=t=>{const{t:e}=hu(),r=()=>t.rule&&t.rule.id,[n,i]=we(!1),[o,s]=we(0),[l,c]=we(!1),[d,u]=we([]),[y,g]=we({name:t.rule?.name||"",description:t.rule?.description||"",eventType:t.rule?.eventType||"invoice_completed",isActive:t.rule?.isActive??!0,priority:t.rule?.priority||100,conditions:t.rule?.conditions||[],journalEntryTemplate:t.rule?.journalEntryTemplate||{description:"",reference:"",lines:[]},createdBy:t.rule?.createdBy||"user"}),f=Ut(()=>{const k=y().eventType;return k?xF(k):[]}),w=Ut(()=>{const k=y().eventType;return k?aP(k):null}),E=[{value:"equals",label:e("eventAutomation.operators.equals")},{value:"notEquals",label:e("eventAutomation.operators.notEquals")},{value:"greaterThan",label:e("eventAutomation.operators.greaterThan")},{value:"lessThan",label:e("eventAutomation.operators.lessThan")},{value:"greaterThanOrEqual",label:e("eventAutomation.operators.greaterThanOrEqual")},{value:"lessThanOrEqual",label:e("eventAutomation.operators.lessThanOrEqual")},{value:"contains",label:e("eventAutomation.operators.contains")},{value:"notContains",label:e("eventAutomation.operators.notContains")},{value:"exists",label:e("eventAutomation.operators.exists")},{value:"notExists",label:e("eventAutomation.operators.notExists")}],x=[{id:"1001",name:"Cash - Operating Account",type:"Asset"},{id:"1002",name:"Cash - Zelle Account",type:"Asset"},{id:"1003",name:"Cash - Credit Card Processing",type:"Asset"},{id:"1101",name:"Accounts Receivable - Customers",type:"Asset"},{id:"1201",name:"Inventory - Products",type:"Asset"},{id:"1401",name:"Customs Fees Receivable",type:"Asset"},{id:"2001",name:"Accounts Payable",type:"Liability"},{id:"2301",name:"Sales Tax Payable",type:"Liability"},{id:"2302",name:"Customs Fees Payable",type:"Liability"},{id:"4001",name:"Sales Revenue - Products",type:"Revenue"},{id:"4101",name:"Service Revenue - General",type:"Revenue"},{id:"4201",name:"Transport Service Revenue",type:"Revenue"},{id:"5001",name:"Cost of Goods Sold - Products",type:"Expense"},{id:"5201",name:"Salaries and Wages",type:"Expense"},{id:"5301",name:"Utilities Expense",type:"Expense"}],T=[{value:"invoice_completed",label:e("eventAutomation.eventTypes.invoice_completed")},{value:"invoice_created",label:e("eventAutomation.eventTypes.invoice_created")},{value:"payment_received",label:e("eventAutomation.eventTypes.payment_received")},{value:"inventory_received",label:e("eventAutomation.eventTypes.inventory_received")},{value:"inventory_sold",label:e("eventAutomation.eventTypes.inventory_sold")},{value:"expense_created",label:e("eventAutomation.eventTypes.expense_created")},{value:"expense_approved",label:e("eventAutomation.eventTypes.expense_approved")},{value:"service_rendered",label:e("eventAutomation.eventTypes.service_rendered")}],Y=(k,N)=>{g(A=>({...A,[k]:N}))},K=(k,N)=>{g(A=>({...A,journalEntryTemplate:{...A.journalEntryTemplate,[k]:N}}))},j=()=>{const k={field:f()[0]?.path||"",operator:"equals",value:"",dataType:"string"};g(N=>({...N,conditions:[...N.conditions||[],k]}))},q=(k,N,A)=>{const V=[...y().conditions||[]];if(V[k]={...V[k],[N]:A},N==="field"){const Z=f().find(H=>H.path===A);Z&&(V[k].dataType=Z.definition.type)}g(Z=>({...Z,conditions:V}))},J=k=>{g(N=>({...N,conditions:N.conditions?.filter((A,V)=>V!==k)||[]}))},C=()=>{const k={accountExpression:"1001",descriptionTemplate:"",amountExpression:"",isDebit:!0};g(N=>({...N,journalEntryTemplate:{...N.journalEntryTemplate,lines:[...N.journalEntryTemplate?.lines||[],k]}}))},P=(k,N,A)=>{const V=[...y().journalEntryTemplate?.lines||[]];V[k]={...V[k],[N]:A},g(Z=>({...Z,journalEntryTemplate:{...Z.journalEntryTemplate,lines:V}}))},$=k=>{const N={...k,id:`custom_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};u(A=>[...A,N])},D=(k,N)=>{u(A=>A.map(V=>V.id===k?{...V,...N}:V))},b=k=>{u(N=>N.filter(A=>A.id!==k))},S=k=>{g(N=>({...N,journalEntryTemplate:{...N.journalEntryTemplate,lines:N.journalEntryTemplate?.lines.filter((A,V)=>V!==k)||[]}}))},v=()=>{const k=y();if(!k.name||!k.description||!k.eventType){alert("Please fill in all required fields");return}if(!k.journalEntryTemplate?.lines.length){alert("Please add at least one journal entry line");return}if(k.journalEntryTemplate.lines.filter(A=>!A.accountExpression||!A.amountExpression||!A.descriptionTemplate).length>0){alert("Please complete all journal entry line fields");return}t.onSave(k)},z={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000",overflow:"auto",padding:"2rem"},re={"background-color":"white","border-radius":"0.5rem",padding:"2rem","max-width":"900px","max-height":"90vh","overflow-y":"auto",width:"100%"},L={width:"100%",padding:"0.5rem",border:"1px solid #d1d5db","border-radius":"0.375rem","font-size":"0.875rem"},O={...L,"background-color":"white"},ne={padding:"0.5rem 1rem","border-radius":"0.375rem",cursor:"pointer","font-weight":"500",border:"1px solid #d1d5db"},X={...ne,"background-color":"#3b82f6",color:"white",border:"none"},W={...ne,"background-color":"white",color:"#374151"},se={...ne,"background-color":"#ef4444",color:"white",border:"none"},F={"margin-bottom":"2rem","border-bottom":"1px solid #e5e7eb","padding-bottom":"2rem"};return(()=>{var k=ZF(),N=k.firstChild,A=N.firstChild,V=A.nextSibling,Z=V.firstChild,H=Z.nextSibling,B=H.firstChild,M=B.firstChild,G=M.firstChild,Q=M.nextSibling,ie=B.nextSibling,me=ie.firstChild,oe=me.nextSibling,ee=H.nextSibling,de=ee.firstChild,he=de.firstChild,le=de.nextSibling,ye=ee.nextSibling,ve=ye.firstChild,pe=ve.firstChild,ge=pe.firstChild,ke=pe.nextSibling,Ne=ve.nextSibling,xe=Ne.firstChild,$e=xe.firstChild,Ee=V.nextSibling,Me=Ee.firstChild,Ye=Me.firstChild,ze=Ye.nextSibling;ze.firstChild;var je=Ee.nextSibling,Xe=je.firstChild,ht=Xe.firstChild,ut=ht.nextSibling,Ue=ut.firstChild,it=Ue.nextSibling,dt=Xe.nextSibling,Fe=dt.nextSibling,Be=Fe.firstChild,Re=Be.nextSibling;Re.firstChild;var lt=je.nextSibling,ot=lt.firstChild,nt=ot.nextSibling;return p(N,re),A.style.setProperty("font-size","1.5rem"),A.style.setProperty("font-weight","700"),A.style.setProperty("margin-bottom","1.5rem"),a(A,(()=>{var Ve=Te(()=>!!r());return()=>Ve()?e("eventAutomation.builder.editTitle"):e("eventAutomation.builder.createTitle")})()),Z.style.setProperty("font-size","1.125rem"),Z.style.setProperty("font-weight","600"),Z.style.setProperty("margin-bottom","1rem"),a(Z,()=>e("eventAutomation.builder.basicInfo")),H.style.setProperty("display","grid"),H.style.setProperty("grid-template-columns","1fr 1fr"),H.style.setProperty("gap","1rem"),H.style.setProperty("margin-bottom","1rem"),M.style.setProperty("display","block"),M.style.setProperty("font-weight","500"),M.style.setProperty("margin-bottom","0.5rem"),a(M,()=>e("eventAutomation.builder.ruleName"),G),Q.$$input=Ve=>Y("name",Ve.currentTarget.value),me.style.setProperty("display","block"),me.style.setProperty("font-weight","500"),me.style.setProperty("margin-bottom","0.5rem"),a(me,()=>e("eventAutomation.builder.priority")),oe.$$input=Ve=>Y("priority",parseInt(Ve.currentTarget.value)||100),ee.style.setProperty("margin-bottom","1rem"),de.style.setProperty("display","block"),de.style.setProperty("font-weight","500"),de.style.setProperty("margin-bottom","0.5rem"),a(de,()=>e("eventAutomation.builder.description"),he),le.$$input=Ve=>Y("description",Ve.currentTarget.value),ye.style.setProperty("display","grid"),ye.style.setProperty("grid-template-columns","1fr auto"),ye.style.setProperty("gap","1rem"),ye.style.setProperty("align-items","end"),pe.style.setProperty("display","block"),pe.style.setProperty("font-weight","500"),pe.style.setProperty("margin-bottom","0.5rem"),a(pe,()=>e("eventAutomation.builder.eventType"),ge),ke.addEventListener("change",Ve=>Y("eventType",Ve.currentTarget.value)),a(ke,I(Ct,{each:T,children:Ve=>(()=>{var qt=o1();return a(qt,()=>Ve.label),fe(()=>qt.value=Ve.value),qt})()})),xe.style.setProperty("display","flex"),xe.style.setProperty("align-items","center"),xe.style.setProperty("gap","0.5rem"),$e.addEventListener("change",Ve=>Y("isActive",Ve.currentTarget.checked)),a(xe,()=>e("eventAutomation.builder.active"),null),a(V,I(Oe,{get when(){return w()},get children(){var Ve=YF(),qt=Ve.firstChild,Mt=qt.firstChild,Qt=Mt.firstChild;Mt.nextSibling;var lr=qt.nextSibling;return Ve.style.setProperty("margin-top","1rem"),Ve.style.setProperty("padding","1rem"),Ve.style.setProperty("background-color","#f3f4f6"),Ve.style.setProperty("border-radius","0.375rem"),qt.style.setProperty("font-size","0.875rem"),qt.style.setProperty("color","#4b5563"),qt.style.setProperty("margin-bottom","0.5rem"),a(Mt,()=>e("eventAutomation.builder.eventDescription"),Qt),a(qt,()=>w()?.description,null),lr.$$click=()=>i(!n()),a(lr,()=>n()?" Hide Data Interface":" Show Data Interface & Examples"),fe(bt=>p(lr,{...W,"font-size":"0.75rem",padding:"0.25rem 0.5rem"},bt)),Ve}}),null),a(N,I(Oe,{get when(){return Te(()=>!!n())()&&w()},get children(){var Ve=JF(),qt=Ve.firstChild,Mt=qt.nextSibling,Qt=Mt.firstChild,lr=Qt.firstChild,bt=lr.nextSibling,yr=Qt.nextSibling,Cr=yr.firstChild;return qt.style.setProperty("font-size","1.125rem"),qt.style.setProperty("font-weight","600"),qt.style.setProperty("margin-bottom","1rem"),Mt.style.setProperty("display","grid"),Mt.style.setProperty("grid-template-columns","1fr 1fr"),Mt.style.setProperty("gap","2rem"),lr.style.setProperty("font-size","1rem"),lr.style.setProperty("font-weight","600"),lr.style.setProperty("margin-bottom","0.75rem"),lr.style.setProperty("color","#1f2937"),bt.style.setProperty("max-height","300px"),bt.style.setProperty("overflow-y","auto"),bt.style.setProperty("border","1px solid #d1d5db"),bt.style.setProperty("border-radius","0.375rem"),bt.style.setProperty("padding","0.75rem"),bt.style.setProperty("background-color","#f9fafb"),a(bt,I(Ct,{get each(){return f()},children:Kt=>(()=>{var sr=t9(),pt=sr.firstChild,gt=pt.firstChild,Vt=gt.nextSibling,gr=pt.nextSibling;return sr.style.setProperty("margin-bottom","0.5rem"),sr.style.setProperty("padding","0.5rem"),sr.style.setProperty("background-color","white"),sr.style.setProperty("border-radius","0.25rem"),sr.style.setProperty("border","1px solid #e5e7eb"),pt.style.setProperty("display","flex"),pt.style.setProperty("justify-content","space-between"),pt.style.setProperty("align-items","center"),gt.style.setProperty("font-family","monospace"),gt.style.setProperty("font-size","0.8rem"),gt.style.setProperty("color","#059669"),gt.style.setProperty("font-weight","600"),a(gt,()=>Kt.path),Vt.style.setProperty("font-size","0.7rem"),Vt.style.setProperty("padding","0.125rem 0.375rem"),Vt.style.setProperty("border-radius","0.25rem"),Vt.style.setProperty("font-weight","500"),a(Vt,()=>Kt.definition.type),gr.style.setProperty("font-size","0.75rem"),gr.style.setProperty("color","#6b7280"),gr.style.setProperty("margin","0.25rem 0 0 0"),a(gr,()=>Kt.definition.description),a(sr,I(Oe,{get when(){return Kt.definition.example},get children(){var et=e9(),ft=et.firstChild,At=ft.nextSibling;return et.style.setProperty("font-size","0.7rem"),et.style.setProperty("color","#374151"),et.style.setProperty("margin","0.25rem 0 0 0"),et.style.setProperty("font-style","italic"),At.style.setProperty("background-color","#f3f4f6"),At.style.setProperty("padding","0.125rem 0.25rem"),At.style.setProperty("border-radius","0.125rem"),a(At,(()=>{var Yt=Te(()=>typeof Kt.definition.example=="object");return()=>Yt()?JSON.stringify(Kt.definition.example):Kt.definition.example})()),et}}),null),fe(et=>{var ft=Kt.definition.type==="number"?"#dbeafe":Kt.definition.type==="string"?"#fef3c7":Kt.definition.type==="boolean"?"#dcfce7":"#f3e8ff",At=Kt.definition.type==="number"?"#1e40af":Kt.definition.type==="string"?"#92400e":Kt.definition.type==="boolean"?"#166534":"#7c3aed";return ft!==et.e&&((et.e=ft)!=null?Vt.style.setProperty("background-color",ft):Vt.style.removeProperty("background-color")),At!==et.t&&((et.t=At)!=null?Vt.style.setProperty("color",At):Vt.style.removeProperty("color")),et},{e:void 0,t:void 0}),sr})()})),Cr.style.setProperty("font-size","1rem"),Cr.style.setProperty("font-weight","600"),Cr.style.setProperty("margin-bottom","0.75rem"),Cr.style.setProperty("color","#1f2937"),a(yr,I(Oe,{get when(){return Te(()=>!!w()?.examples)()&&w().examples.length>0},get children(){return[(()=>{var Kt=i1();return Kt.style.setProperty("margin-bottom","0.75rem"),a(Kt,I(Ct,{get each(){return w().examples},children:(sr,pt)=>(()=>{var gt=r9();return gt.$$click=()=>s(pt()),a(gt,()=>sr.name),fe(Vt=>p(gt,{...W,"margin-right":"0.5rem","margin-bottom":"0.5rem","font-size":"0.75rem",padding:"0.375rem 0.75rem","background-color":o()===pt()?"#3b82f6":"white",color:o()===pt()?"white":"#374151",border:o()===pt()?"none":"1px solid #d1d5db"},Vt)),gt})()})),Kt})(),I(Oe,{get when(){return w()?.examples[o()]},get children(){var Kt=KF(),sr=Kt.firstChild,pt=sr.nextSibling,gt=pt.nextSibling,Vt=gt.nextSibling,gr=Vt.firstChild;return Kt.style.setProperty("border","1px solid #d1d5db"),Kt.style.setProperty("border-radius","0.375rem"),Kt.style.setProperty("padding","0.75rem"),Kt.style.setProperty("background-color","#f9fafb"),sr.style.setProperty("font-size","0.875rem"),sr.style.setProperty("font-weight","600"),sr.style.setProperty("margin-bottom","0.5rem"),a(sr,()=>w().examples[o()].name),pt.style.setProperty("font-size","0.75rem"),pt.style.setProperty("color","#6b7280"),pt.style.setProperty("margin-bottom","0.75rem"),a(pt,()=>w().examples[o()].description),gt.style.setProperty("background-color","#1f2937"),gt.style.setProperty("color","#f9fafb"),gt.style.setProperty("padding","0.75rem"),gt.style.setProperty("border-radius","0.25rem"),gt.style.setProperty("font-family","monospace"),gt.style.setProperty("font-size","0.75rem"),gt.style.setProperty("overflow-x","auto"),gt.style.setProperty("white-space","pre"),a(gt,()=>JSON.stringify({data:w().examples[o()].sampleData},null,2)),Vt.style.setProperty("margin-top","0.5rem"),Vt.style.setProperty("padding","0.5rem"),Vt.style.setProperty("background-color","#fef3c7"),Vt.style.setProperty("border-radius","0.25rem"),gr.style.setProperty("font-size","0.7rem"),gr.style.setProperty("color","#92400e"),Kt}})]}}),null),fe(Kt=>p(Ve,F,Kt)),Ve}}),Ee),Me.style.setProperty("display","flex"),Me.style.setProperty("justify-content","space-between"),Me.style.setProperty("align-items","center"),Me.style.setProperty("margin-bottom","1rem"),Ye.style.setProperty("font-size","1.125rem"),Ye.style.setProperty("font-weight","600"),a(Ye,()=>e("eventAutomation.builder.conditions.title")),ze.$$click=j,a(ze,()=>e("eventAutomation.builder.conditions.add"),null),a(Ee,I(Oe,{get when(){return(y().conditions?.length||0)===0},get children(){var Ve=QF(),qt=Ve.firstChild,Mt=qt.nextSibling;return Mt.nextSibling,Ve.style.setProperty("color","#6b7280"),Ve.style.setProperty("font-style","italic"),a(Ve,()=>e("eventAutomation.builder.conditions.noConditions"),qt),a(Ve,()=>y().eventType,Mt),Ve}}),null),a(Ee,I(Ct,{get each(){return y().conditions||[]},children:(Ve,qt)=>(()=>{var Mt=i9(),Qt=Mt.firstChild,lr=Qt.firstChild,bt=lr.firstChild,yr=bt.nextSibling,Cr=yr.firstChild,Kt=lr.nextSibling,sr=Kt.firstChild,pt=sr.nextSibling,gt=Kt.nextSibling,Vt=gt.firstChild,gr=gt.nextSibling,et=gr.firstChild;return Mt.style.setProperty("border","1px solid #d1d5db"),Mt.style.setProperty("border-radius","0.375rem"),Mt.style.setProperty("padding","1rem"),Mt.style.setProperty("margin-bottom","1rem"),Qt.style.setProperty("display","grid"),Qt.style.setProperty("grid-template-columns","2fr 1fr 1fr auto"),Qt.style.setProperty("gap","1rem"),Qt.style.setProperty("align-items","end"),bt.style.setProperty("display","block"),bt.style.setProperty("font-weight","500"),bt.style.setProperty("margin-bottom","0.5rem"),a(bt,()=>e("eventAutomation.builder.conditions.field")),yr.addEventListener("change",ft=>q(qt(),"field",ft.currentTarget.value)),a(Cr,()=>e("eventAutomation.builder.conditions.selectField")),a(yr,I(Ct,{get each(){return f()},children:ft=>(()=>{var At=o9(),Yt=At.firstChild,hr=Yt.nextSibling;return hr.nextSibling,a(At,()=>ft.path,Yt),a(At,()=>ft.definition.description,hr),fe(()=>At.value=ft.path),At})()}),null),sr.style.setProperty("display","block"),sr.style.setProperty("font-weight","500"),sr.style.setProperty("margin-bottom","0.5rem"),a(sr,()=>e("eventAutomation.builder.conditions.operator")),pt.addEventListener("change",ft=>q(qt(),"operator",ft.currentTarget.value)),a(pt,I(Ct,{each:E,children:ft=>(()=>{var At=o1();return a(At,()=>ft.label),fe(()=>At.value=ft.value),At})()})),Vt.style.setProperty("display","block"),Vt.style.setProperty("font-weight","500"),Vt.style.setProperty("margin-bottom","0.5rem"),a(Vt,()=>e("eventAutomation.builder.conditions.value")),a(gt,I(Oe,{get when(){return Ve.operator!=="exists"&&Ve.operator!=="notExists"},get fallback(){return(()=>{var ft=s9();return fe(At=>p(ft,L,At)),ft})()},get children(){var ft=n9();return ft.$$input=At=>q(qt(),"value",Ve.dataType==="number"?parseFloat(At.currentTarget.value)||0:At.currentTarget.value),fe(At=>{var Yt=Ve.dataType==="number"?"number":"text",hr=L,Pr=Ve.dataType==="number"?"0":e("eventAutomation.builder.conditions.enterValue");return Yt!==At.e&&ir(ft,"type",At.e=Yt),At.t=p(ft,hr,At.t),Pr!==At.a&&ir(ft,"placeholder",At.a=Pr),At},{e:void 0,t:void 0,a:void 0}),fe(()=>ft.value=Ve.value),ft}}),null),et.$$click=()=>J(qt()),a(et,()=>e("eventAutomation.builder.conditions.remove")),fe(ft=>{var At=O,Yt=O,hr=se;return ft.e=p(yr,At,ft.e),ft.t=p(pt,Yt,ft.t),ft.a=p(et,hr,ft.a),ft},{e:void 0,t:void 0,a:void 0}),fe(()=>yr.value=Ve.field),fe(()=>pt.value=Ve.operator),Mt})()}),null),a(N,I(Oe,{get when(){return l()},get children(){var Ve=i1();return Ve.style.setProperty("margin-bottom","2rem"),a(Ve,I(jF,{get customFields(){return d()},get availableFields(){return f()},onAdd:$,onUpdate:D,onRemove:b})),Ve}}),je),je.style.setProperty("margin-bottom","2rem"),Xe.style.setProperty("display","flex"),Xe.style.setProperty("justify-content","space-between"),Xe.style.setProperty("align-items","center"),Xe.style.setProperty("margin-bottom","1rem"),ht.style.setProperty("font-size","1.125rem"),ht.style.setProperty("font-weight","600"),a(ht,()=>e("eventAutomation.builder.journalTemplate.title")),ut.style.setProperty("display","flex"),ut.style.setProperty("gap","0.5rem"),Ue.$$click=()=>c(!l()),a(Ue,()=>l()?" Hide Custom Fields":" Manage Custom Fields"),it.$$click=()=>i(!n()),a(it,()=>n()?" Hide Data Interface":" Show Data Interface"),dt.style.setProperty("display","grid"),dt.style.setProperty("grid-template-columns","1fr 1fr"),dt.style.setProperty("gap","1rem"),dt.style.setProperty("margin-bottom","1rem"),a(dt,I(uh,{get label(){return`${e("eventAutomation.builder.journalTemplate.description")} *`},get value(){return y().journalEntryTemplate?.description||""},get placeholder(){return e("eventAutomation.builder.journalTemplate.descriptionPlaceholder")},get availableFields(){return f()},onInput:Ve=>K("description",Ve),type:"text",helpText:"Use {data.field} to insert event data in descriptions"}),null),a(dt,I(uh,{get label(){return`${e("eventAutomation.builder.journalTemplate.reference")} *`},get value(){return y().journalEntryTemplate?.reference||""},get placeholder(){return e("eventAutomation.builder.journalTemplate.referencePlaceholder")},get availableFields(){return f()},onInput:Ve=>K("reference",Ve),type:"text",helpText:"Template for journal entry reference"}),null),Fe.style.setProperty("display","flex"),Fe.style.setProperty("justify-content","space-between"),Fe.style.setProperty("align-items","center"),Fe.style.setProperty("margin-bottom","1rem"),Be.style.setProperty("font-size","1rem"),Be.style.setProperty("font-weight","600"),a(Be,()=>e("eventAutomation.builder.journalTemplate.lines")),Re.$$click=C,a(Re,()=>e("eventAutomation.builder.journalTemplate.addLine"),null),a(je,I(Oe,{get when(){return(y().journalEntryTemplate?.lines.length||0)===0},get children(){var Ve=XF();return Ve.style.setProperty("color","#6b7280"),Ve.style.setProperty("font-style","italic"),Ve.style.setProperty("margin-bottom","1rem"),a(Ve,()=>e("eventAutomation.builder.journalTemplate.noLines")),Ve}}),null),a(je,I(Ct,{get each(){return y().journalEntryTemplate?.lines||[]},children:(Ve,qt)=>(()=>{var Mt=a9(),Qt=Mt.firstChild,lr=Qt.firstChild;lr.firstChild;var bt=lr.nextSibling,yr=Qt.nextSibling,Cr=yr.firstChild,Kt=Cr.firstChild,sr=Kt.nextSibling,pt=Cr.nextSibling,gt=pt.firstChild,Vt=gt.nextSibling,gr=Vt.firstChild,et=gr.nextSibling,ft=yr.nextSibling;return Mt.style.setProperty("border","1px solid #d1d5db"),Mt.style.setProperty("border-radius","0.375rem"),Mt.style.setProperty("padding","1rem"),Mt.style.setProperty("margin-bottom","1rem"),Mt.style.setProperty("background-color","#fafafa"),Qt.style.setProperty("display","flex"),Qt.style.setProperty("justify-content","space-between"),Qt.style.setProperty("align-items","center"),Qt.style.setProperty("margin-bottom","1rem"),lr.style.setProperty("font-size","0.875rem"),lr.style.setProperty("font-weight","600"),lr.style.setProperty("margin","0"),a(lr,()=>qt()+1,null),bt.$$click=()=>S(qt()),a(bt,()=>e("eventAutomation.builder.conditions.remove")),yr.style.setProperty("display","grid"),yr.style.setProperty("grid-template-columns","1fr 1fr"),yr.style.setProperty("gap","1rem"),yr.style.setProperty("margin-bottom","1rem"),Kt.style.setProperty("display","block"),Kt.style.setProperty("font-weight","500"),Kt.style.setProperty("margin-bottom","0.5rem"),a(Kt,()=>e("eventAutomation.builder.journalTemplate.account")),sr.addEventListener("change",At=>P(qt(),"accountExpression",At.currentTarget.value)),a(sr,I(Ct,{each:x,children:At=>(()=>{var Yt=l9(),hr=Yt.firstChild,Pr=hr.nextSibling,Jr=Pr.nextSibling,Tr=Jr.nextSibling;return Tr.nextSibling,a(Yt,()=>At.id,hr),a(Yt,()=>At.name,Pr),a(Yt,()=>At.type,Tr),fe(()=>Yt.value=At.id),Yt})()})),gt.style.setProperty("display","block"),gt.style.setProperty("font-weight","500"),gt.style.setProperty("margin-bottom","0.5rem"),a(gt,()=>e("eventAutomation.builder.journalTemplate.type")),Vt.addEventListener("change",At=>P(qt(),"isDebit",At.currentTarget.value==="debit")),a(gr,()=>e("eventAutomation.builder.journalTemplate.debit")),a(et,()=>e("eventAutomation.builder.journalTemplate.credit")),ft.style.setProperty("display","grid"),ft.style.setProperty("grid-template-columns","2fr 1fr"),ft.style.setProperty("gap","1rem"),a(ft,I(uh,{get label(){return e("eventAutomation.builder.journalTemplate.descriptionTemplate")},get value(){return Ve.descriptionTemplate},get placeholder(){return e("eventAutomation.builder.journalTemplate.descriptionTemplatePlaceholder")},get availableFields(){return f()},onInput:At=>P(qt(),"descriptionTemplate",At),type:"text",helpText:"Use {data.field} to insert event data"}),null),a(ft,I(uh,{get label(){return e("eventAutomation.builder.journalTemplate.amountExpression")},get value(){return Ve.amountExpression},get placeholder(){return e("eventAutomation.builder.journalTemplate.amountExpressionPlaceholder")},get availableFields(){return f()},onInput:At=>P(qt(),"amountExpression",At),type:"expression",helpText:"Field path or expression for amount calculation"}),null),fe(At=>{var Yt=se,hr=O,Pr=O;return At.e=p(bt,Yt,At.e),At.t=p(sr,hr,At.t),At.a=p(Vt,Pr,At.a),At},{e:void 0,t:void 0,a:void 0}),fe(()=>sr.value=Ve.accountExpression),fe(()=>Vt.value=Ve.isDebit?"debit":"credit"),Mt})()}),null),lt.style.setProperty("display","flex"),lt.style.setProperty("justify-content","flex-end"),lt.style.setProperty("gap","1rem"),Xn(ot,"click",t.onCancel,!0),a(ot,()=>e("eventAutomation.builder.cancel")),nt.$$click=v,a(nt,(()=>{var Ve=Te(()=>!!r());return()=>Ve()?e("eventAutomation.builder.update"):e("eventAutomation.builder.save")})()),fe(Ve=>{var qt=z,Mt=F,Qt=L,lr=e("eventAutomation.builder.ruleNamePlaceholder"),bt=L,yr={...L,height:"4rem",resize:"vertical"},Cr=e("eventAutomation.builder.descriptionPlaceholder"),Kt=O,sr=F,pt=W,gt={...W,"font-size":"0.875rem"},Vt={...W,"font-size":"0.875rem"},gr=W,et=W,ft=X;return Ve.e=p(k,qt,Ve.e),Ve.t=p(V,Mt,Ve.t),Ve.a=p(Q,Qt,Ve.a),lr!==Ve.o&&ir(Q,"placeholder",Ve.o=lr),Ve.i=p(oe,bt,Ve.i),Ve.n=p(le,yr,Ve.n),Cr!==Ve.s&&ir(le,"placeholder",Ve.s=Cr),Ve.h=p(ke,Kt,Ve.h),Ve.r=p(Ee,sr,Ve.r),Ve.d=p(ze,pt,Ve.d),Ve.l=p(Ue,gt,Ve.l),Ve.u=p(it,Vt,Ve.u),Ve.c=p(Re,gr,Ve.c),Ve.w=p(ot,et,Ve.w),Ve.m=p(nt,ft,Ve.m),Ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),fe(()=>Q.value=y().name||""),fe(()=>oe.value=y().priority||100),fe(()=>le.value=y().description||""),fe(()=>ke.value=y().eventType||""),fe(()=>$e.checked=y().isActive??!0),k})()};br(["input","click"]);var d9=ae("<div><p>Loading rules..."),u9=ae("<div><p>Failed to load rules. Please refresh the page."),h9=ae("<div><p></p><button>"),p9=ae("<div><div><h2></h2><button>+ "),s1=ae("<div>"),a1=ae("<div><h2>"),m9=ae("<div><div><h1></h1><p></p></div><div><button> (<!>)</button><button></button><button>"),f9=ae("<div><div><div><div><h3></h3><span></span><span></span></div><p></p><div><div><strong>:</strong></div><div><strong>:</strong><div> <!> - </div></div></div></div><div><button></button><button></button><button>"),y9=ae("<div> <!> "),g9=ae("<span>"),v9=ae("<div><div><h3></h3><span></span></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><details><summary></summary><pre>"),b9=ae("<div><strong>:</strong> "),_9=ae("<div><div><div><h3></h3><span></span></div><span></span></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> <!> ");const P9=()=>{const{t}=hu(),[e,r]=we("rules"),[n,i]=we(null),[o,s]=we(!1),[l,c]=we(""),[d,{refetch:u}]=JP(()=>js.getAll(),{initialValue:[]}),y=()=>sP.getHistory(50),g=()=>dh.getAuditLog(50);t("eventAutomation.eventTypes.invoice_completed"),t("eventAutomation.categories.financial"),t("eventAutomation.eventTypes.invoice_created"),t("eventAutomation.categories.financial"),t("eventAutomation.eventTypes.invoice_updated"),t("eventAutomation.categories.financial"),t("eventAutomation.eventTypes.payment_received"),t("eventAutomation.categories.financial"),t("eventAutomation.eventTypes.inventory_received"),t("eventAutomation.categories.inventory"),t("eventAutomation.eventTypes.inventory_sold"),t("eventAutomation.categories.inventory"),t("eventAutomation.eventTypes.inventory_adjusted"),t("eventAutomation.categories.inventory"),t("eventAutomation.eventTypes.expense_created"),t("eventAutomation.categories.financial"),t("eventAutomation.eventTypes.expense_approved"),t("eventAutomation.categories.financial"),t("eventAutomation.eventTypes.expense_paid"),t("eventAutomation.categories.financial"),t("eventAutomation.eventTypes.service_rendered"),t("eventAutomation.categories.operational"),t("eventAutomation.eventTypes.freight_processed"),t("eventAutomation.categories.operational"),t("eventAutomation.eventTypes.customs_cleared"),t("eventAutomation.categories.operational");const f=async J=>{try{n()?await js.update(n().id,J):await js.create(J),await u();const C=await js.getAll();dh.syncRules(C),i(null),s(!1)}catch(C){console.error("Failed to save rule:",C),alert("Failed to save rule. Please try again.")}},w=async J=>{if(confirm(t("common.confirmDelete")))try{await js.delete(J),await u();const C=await js.getAll();dh.syncRules(C)}catch(C){console.error("Failed to delete rule:",C),alert("Failed to delete rule. Please try again.")}},E=J=>new Date(J).toLocaleString(),x=J=>({padding:"0.75rem 1.5rem","background-color":J?"#3b82f6":"transparent",color:J?"white":"#6b7280",border:"none","border-radius":"0.5rem",cursor:"pointer","font-weight":"500",transition:"all 0.2s"}),T={"background-color":"white","border-radius":"0.5rem",padding:"1.5rem","box-shadow":"0 1px 3px 0 rgba(0, 0, 0, 0.1)","margin-bottom":"1rem"},Y={padding:"0.5rem 1rem","background-color":"#3b82f6",color:"white",border:"none","border-radius":"0.375rem",cursor:"pointer","font-weight":"500"},K={...Y,"background-color":"#6b7280"},j={...Y,"background-color":"#ef4444"},q=async(J,C)=>{try{await js.toggleActive(J,C),await u();const P=await js.getAll();dh.syncRules(P)}catch(P){console.error("Failed to toggle rule:",P),alert("Failed to update rule status. Please try again.")}};return(()=>{var J=m9(),C=J.firstChild,P=C.firstChild,$=P.nextSibling,D=C.nextSibling,b=D.firstChild,S=b.firstChild,v=S.nextSibling;v.nextSibling;var z=b.nextSibling,re=z.nextSibling;return J.style.setProperty("max-width","1200px"),J.style.setProperty("margin","0 auto"),J.style.setProperty("padding","2rem"),C.style.setProperty("margin-bottom","2rem"),P.style.setProperty("font-size","2rem"),P.style.setProperty("font-weight","700"),P.style.setProperty("margin-bottom","0.5rem"),a(P,()=>t("eventAutomation.title")),$.style.setProperty("color","#6b7280"),a($,()=>t("eventAutomation.subtitle")),D.style.setProperty("display","flex"),D.style.setProperty("gap","0.5rem"),D.style.setProperty("margin-bottom","2rem"),b.$$click=()=>r("rules"),a(b,()=>t("eventAutomation.tabs.rules"),S),a(b,(()=>{var L=Te(()=>!d.loading&&!d.error);return()=>L()?d().length:0})(),v),z.$$click=()=>r("events"),a(z,()=>t("eventAutomation.tabs.events")),re.$$click=()=>r("audit"),a(re,()=>t("eventAutomation.tabs.audit")),a(J,I(Oe,{get when(){return e()==="rules"},get children(){var L=p9(),O=L.firstChild,ne=O.firstChild,X=ne.nextSibling;return X.firstChild,O.style.setProperty("display","flex"),O.style.setProperty("justify-content","space-between"),O.style.setProperty("margin-bottom","1.5rem"),ne.style.setProperty("font-size","1.25rem"),ne.style.setProperty("font-weight","600"),a(ne,()=>t("eventAutomation.rules.title")),X.$$click=()=>s(!0),a(X,()=>t("eventAutomation.rules.createNew"),null),a(L,I(Oe,{get when(){return d.loading},get children(){var W=d9(),se=W.firstChild;return se.style.setProperty("text-align","center"),se.style.setProperty("color","#6b7280"),fe(F=>p(W,T,F)),W}}),null),a(L,I(Oe,{get when(){return d.error},get children(){var W=u9(),se=W.firstChild;return se.style.setProperty("text-align","center"),se.style.setProperty("color","#ef4444"),fe(F=>p(W,T,F)),W}}),null),a(L,I(Oe,{get when(){return Te(()=>!d.loading&&!d.error)()&&d().length===0},get children(){var W=h9(),se=W.firstChild,F=se.nextSibling;return se.style.setProperty("margin-bottom","1rem"),a(se,()=>t("eventAutomation.rules.noRules")),F.$$click=()=>s(!0),a(F,()=>t("eventAutomation.rules.createFirst")),fe(k=>{var N={...T,"text-align":"center",padding:"3rem",color:"#6b7280"},A=Y;return k.e=p(W,N,k.e),k.t=p(F,A,k.t),k},{e:void 0,t:void 0}),W}}),null),a(L,I(Ct,{get each(){return Te(()=>!d.loading&&!d.error)()?d():[]},children:W=>(()=>{var se=f9(),F=se.firstChild,k=F.firstChild,N=k.firstChild,A=N.firstChild,V=A.nextSibling,Z=V.nextSibling,H=N.nextSibling,B=H.nextSibling,M=B.firstChild,G=M.firstChild,Q=G.firstChild,ie=M.nextSibling,me=ie.firstChild,oe=me.firstChild,ee=me.nextSibling,de=ee.firstChild,he=de.nextSibling;he.nextSibling;var le=k.nextSibling,ye=le.firstChild,ve=ye.nextSibling,pe=ve.nextSibling;return F.style.setProperty("display","flex"),F.style.setProperty("justify-content","space-between"),F.style.setProperty("align-items","start"),k.style.setProperty("flex","1"),N.style.setProperty("display","flex"),N.style.setProperty("align-items","center"),N.style.setProperty("gap","1rem"),N.style.setProperty("margin-bottom","0.5rem"),A.style.setProperty("font-size","1.125rem"),A.style.setProperty("font-weight","600"),a(A,()=>W.name),V.style.setProperty("padding","0.25rem 0.75rem"),V.style.setProperty("border-radius","0.375rem"),V.style.setProperty("font-size","0.875rem"),V.style.setProperty("font-weight","500"),a(V,(()=>{var ge=Te(()=>!!W.isActive);return()=>ge()?t("common.active"):t("common.inactive")})()),Z.style.setProperty("padding","0.25rem 0.75rem"),Z.style.setProperty("background-color","#e5e7eb"),Z.style.setProperty("color","#374151"),Z.style.setProperty("border-radius","0.375rem"),Z.style.setProperty("font-size","0.875rem"),a(Z,()=>W.eventType),H.style.setProperty("color","#6b7280"),H.style.setProperty("margin-bottom","1rem"),a(H,()=>W.description),B.style.setProperty("font-size","0.875rem"),B.style.setProperty("color","#4b5563"),M.style.setProperty("margin-bottom","0.5rem"),a(G,()=>t("eventAutomation.rules.conditions"),Q),a(M,I(Ct,{get each(){return W.conditions},children:(ge,ke)=>(()=>{var Ne=y9(),xe=Ne.firstChild,$e=xe.nextSibling;return $e.nextSibling,Ne.style.setProperty("margin-left","1rem"),a(Ne,()=>ke()>0&&"AND ",xe),a(Ne,()=>ge.field,xe),a(Ne,()=>ge.operator,$e),a(Ne,()=>ge.value,null),Ne})()}),null),a(M,(()=>{var ge=Te(()=>W.conditions.length===0);return()=>ge()&&(()=>{var ke=g9();return ke.style.setProperty("margin-left","1rem"),a(ke,()=>t("eventAutomation.rules.alwaysTriggers")),ke})()})(),null),a(me,()=>t("eventAutomation.rules.journalEntry"),oe),ee.style.setProperty("margin-left","1rem"),a(ee,()=>W.journalEntryTemplate.lines.length,de),a(ee,()=>t("eventAutomation.rules.lines"),he),a(ee,()=>W.journalEntryTemplate.description,null),le.style.setProperty("display","flex"),le.style.setProperty("gap","0.5rem"),ye.$$click=()=>q(W.id,!W.isActive),a(ye,(()=>{var ge=Te(()=>!!W.isActive);return()=>ge()?t("eventAutomation.rules.disable"):t("eventAutomation.rules.enable")})()),ve.$$click=()=>i(W),a(ve,()=>t("common.edit")),pe.$$click=()=>w(W.id),a(pe,()=>t("common.delete")),fe(ge=>{var ke=T,Ne=W.isActive?"#d1fae5":"#fee2e2",xe=W.isActive?"#065f46":"#991b1b",$e=K,Ee=Y,Me=j;return ge.e=p(se,ke,ge.e),Ne!==ge.t&&((ge.t=Ne)!=null?V.style.setProperty("background-color",Ne):V.style.removeProperty("background-color")),xe!==ge.a&&((ge.a=xe)!=null?V.style.setProperty("color",xe):V.style.removeProperty("color")),ge.o=p(ye,$e,ge.o),ge.i=p(ve,Ee,ge.i),ge.n=p(pe,Me,ge.n),ge},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),se})()}),null),fe(W=>p(X,Y,W)),L}}),null),a(J,I(Oe,{get when(){return e()==="events"},get children(){var L=a1(),O=L.firstChild;return O.style.setProperty("font-size","1.25rem"),O.style.setProperty("font-weight","600"),O.style.setProperty("margin-bottom","1.5rem"),a(O,()=>t("eventAutomation.events.title")),a(L,I(Oe,{get when(){return y().length===0},get children(){var ne=s1();return a(ne,()=>t("eventAutomation.events.noEvents")),fe(X=>p(ne,{...T,"text-align":"center",color:"#6b7280"},X)),ne}}),null),a(L,I(Ct,{get each(){return y()},children:ne=>(()=>{var X=v9(),W=X.firstChild,se=W.firstChild,F=se.nextSibling,k=W.nextSibling,N=k.firstChild,A=N.firstChild,V=A.firstChild;A.nextSibling;var Z=N.nextSibling,H=Z.firstChild,B=H.firstChild;H.nextSibling;var M=Z.nextSibling,G=M.firstChild,Q=G.nextSibling;return W.style.setProperty("display","flex"),W.style.setProperty("justify-content","space-between"),W.style.setProperty("margin-bottom","0.5rem"),se.style.setProperty("font-size","1rem"),se.style.setProperty("font-weight","600"),a(se,()=>ne.type),F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","#6b7280"),a(F,()=>E(ne.timestamp)),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("color","#4b5563"),a(A,()=>t("eventAutomation.events.source"),V),a(N,()=>ne.source,null),a(H,()=>t("eventAutomation.events.eventId"),B),a(Z,()=>ne.id,null),M.style.setProperty("margin-top","0.5rem"),G.style.setProperty("cursor","pointer"),a(G,()=>t("eventAutomation.events.viewData")),Q.style.setProperty("margin-top","0.5rem"),Q.style.setProperty("padding","0.5rem"),Q.style.setProperty("background-color","#f3f4f6"),Q.style.setProperty("border-radius","0.25rem"),Q.style.setProperty("overflow","auto"),Q.style.setProperty("font-size","0.75rem"),a(Q,()=>JSON.stringify(ne.data,null,2)),fe(ie=>p(X,T,ie)),X})()}),null),L}}),null),a(J,I(Oe,{get when(){return e()==="audit"},get children(){var L=a1(),O=L.firstChild;return O.style.setProperty("font-size","1.25rem"),O.style.setProperty("font-weight","600"),O.style.setProperty("margin-bottom","1.5rem"),a(O,()=>t("eventAutomation.audit.title")),a(L,I(Oe,{get when(){return g().length===0},get children(){var ne=s1();return a(ne,()=>t("eventAutomation.audit.noActivity")),fe(X=>p(ne,{...T,"text-align":"center",color:"#6b7280"},X)),ne}}),null),a(L,I(Ct,{get each(){return g()},children:ne=>(()=>{var X=_9(),W=X.firstChild,se=W.firstChild,F=se.firstChild,k=F.nextSibling,N=se.nextSibling,A=W.nextSibling,V=A.firstChild,Z=V.firstChild,H=Z.firstChild;Z.nextSibling;var B=V.nextSibling,M=B.firstChild,G=M.firstChild;M.nextSibling;var Q=B.nextSibling,ie=Q.firstChild,me=ie.firstChild,oe=ie.nextSibling,ee=oe.nextSibling;return ee.nextSibling,W.style.setProperty("display","flex"),W.style.setProperty("justify-content","space-between"),W.style.setProperty("margin-bottom","0.5rem"),se.style.setProperty("display","flex"),se.style.setProperty("align-items","center"),se.style.setProperty("gap","1rem"),F.style.setProperty("font-size","1rem"),F.style.setProperty("font-weight","600"),a(F,()=>ne.eventType),k.style.setProperty("padding","0.25rem 0.75rem"),k.style.setProperty("border-radius","0.375rem"),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("font-weight","500"),a(k,(()=>{var de=Te(()=>!!ne.success);return()=>de()?t("eventAutomation.audit.success"):t("eventAutomation.audit.failed")})()),N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","#6b7280"),a(N,()=>E(ne.timestamp)),A.style.setProperty("font-size","0.875rem"),A.style.setProperty("color","#4b5563"),a(Z,()=>t("eventAutomation.audit.eventId"),H),a(V,()=>ne.eventId,null),a(M,()=>t("eventAutomation.audit.rulesTriggered"),G),a(B,()=>ne.rulesTriggered.join(", ")||t("common.none"),null),a(ie,()=>t("eventAutomation.audit.entriesCreated"),me),a(Q,()=>ne.entriesCreated.length,ee),a(Q,()=>t("eventAutomation.audit.journalEntries"),null),a(A,I(Oe,{get when(){return ne.error},get children(){var de=b9(),he=de.firstChild,le=he.firstChild;return he.nextSibling,de.style.setProperty("color","#dc2626"),de.style.setProperty("margin-top","0.5rem"),a(he,()=>t("eventAutomation.audit.error"),le),a(de,()=>ne.error,null),de}}),null),fe(de=>{var he=T,le=ne.success?"#d1fae5":"#fee2e2",ye=ne.success?"#065f46":"#991b1b";return de.e=p(X,he,de.e),le!==de.t&&((de.t=le)!=null?k.style.setProperty("background-color",le):k.style.removeProperty("background-color")),ye!==de.a&&((de.a=ye)!=null?k.style.setProperty("color",ye):k.style.removeProperty("color")),de},{e:void 0,t:void 0,a:void 0}),X})()}),null),L}}),null),a(J,I(Oe,{get when(){return o()||n()},get children(){return I(c9,{get rule(){return n()},onSave:f,onCancel:()=>{s(!1),i(null)}})}}),null),fe(L=>{var O=x(e()==="rules"),ne=x(e()==="events"),X=x(e()==="audit");return L.e=p(b,O,L.e),L.t=p(z,ne,L.t),L.a=p(re,X,L.a),L},{e:void 0,t:void 0,a:void 0}),J})()};br(["click"]);var S9=ae("<div><main>");const w9=t=>[I(iI,{}),Te(()=>t.children)],x9=()=>I(RE,{get children(){var t=S9(),e=t.firstChild;return a(e,I(tw,{root:w9,get children(){return[I(to,{path:"/",component:DD}),I(to,{path:"/accounts",component:()=>I(go,{permission:"AccountAccess",featureName:"Accounts",get children(){return I(TT,{})}})}),I(to,{path:"/accounts/:id",component:()=>I(go,{permission:"AccountAccess",featureName:"Account Details",get children(){return I(FT,{})}})}),I(to,{path:"/entry-books",component:()=>I(go,{permission:"JournalAccess",featureName:"Entry Books",get children(){return I(M7,{})}})}),I(to,{path:"/employees",component:()=>I(go,{permission:"EmployeeAccess",featureName:"Employee Management",get children(){return I(RN,{})}})}),I(to,{path:"/bank-consolidations",component:()=>I(go,{permission:"BankingAccess",featureName:"Bank Consolidations",get children(){return I(lL,{})}})}),I(to,{path:"/balance-sheet",component:()=>I(go,{permission:"AccountAccess",featureName:"Balance Sheet",get children(){return I(zT,{})}})}),I(to,{path:"/invoices",component:()=>I(go,{permission:"invoiceAccess",featureName:"Invoices",get children(){return I(hF,{})}})}),I(to,{path:"/inventory",component:()=>I(go,{permission:"InventoryAccess",featureName:"Inventory Management",get children(){return I(CN,{})}})}),I(to,{path:"/products",component:()=>I(go,{permission:"InventoryAccess",featureName:"Product Management",get children(){return I(h_,{})}})}),I(to,{path:"/hbl",component:()=>I(go,{permission:"HBLAccess",featureName:"HBL Management",get children(){return I(ED,{})}})}),I(to,{path:"/admin/users",component:()=>I(go,{permission:"isAdmin",featureName:"User Administration",get children(){return I(YD,{})}})}),I(to,{path:"/automation",component:()=>I(go,{permission:"AccountAccess",featureName:"Manual Automation",get children(){return I(u_,{})}})}),I(to,{path:"/event-automation",component:()=>I(go,{permission:"AccountAccess",featureName:"Event Automation",get children(){return I(P9,{})}})})]}})),a(t,(()=>{var r=Te(()=>!1);return()=>r()&&I(yI,{})})(),null),t}}),C9=document.getElementById("root");yS(()=>I(x9,{}),C9);export{Er as E,ao as _,Pn as a,I9 as b,Pt as i,F_ as j};
