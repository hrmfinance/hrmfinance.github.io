(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const kg=!1,Rg=(t,e)=>t===e,Yr=Symbol("solid-proxy"),cm=typeof Proxy=="function",Nl=Symbol("solid-track"),ia={equals:Rg};let um=vm;const ti=1,oa=2,dm={owned:null,cleanups:null,context:null,owner:null};var It=null;let nl=null,Dg=null,Mt=null,wr=null,Pn=null,Ra=0;function Oo(t,e){const r=Mt,n=It,i=t.length===0,o=e===void 0?n:e,a=i?dm:{owned:null,cleanups:null,context:o?o.context:null,owner:o},c=i?t:()=>t(()=>Ur(()=>qo(a)));It=a,Mt=null;try{return ni(c,!0)}finally{Mt=r,It=n}}function ge(t,e){e=e?Object.assign({},ia,e):ia;const r={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},n=i=>(typeof i=="function"&&(i=i(r.value)),pm(r,i));return[gm.bind(r),n]}function ie(t,e,r){const n=bc(t,e,!1,ti);is(n)}function ri(t,e,r){um=Og;const n=bc(t,e,!1,ti);n.user=!0,Pn?Pn.push(n):is(n)}function qe(t,e,r){r=r?Object.assign({},ia,r):ia;const n=bc(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,is(n),gm.bind(n)}function hm(t){return ni(t,!1)}function Ur(t){if(Mt===null)return t();const e=Mt;Mt=null;try{return t()}finally{Mt=e}}function gc(t,e,r){const n=Array.isArray(t);let i,o=r&&r.defer;return a=>{let c;if(n){c=Array(t.length);for(let h=0;h<t.length;h++)c[h]=t[h]()}else c=t();if(o)return o=!1,a;const u=Ur(()=>e(c,i,a));return i=c,u}}function Qr(t){ri(()=>Ur(t))}function oo(t){return It===null||(It.cleanups===null?It.cleanups=[t]:It.cleanups.push(t)),t}function Ll(){return Mt}function mm(){return It}function fm(t,e){const r=It,n=Mt;It=t,Mt=null;try{return ni(e,!0)}catch(i){_c(i)}finally{It=r,Mt=n}}function Ng(t){const e=Mt,r=It;return Promise.resolve().then(()=>{Mt=e,It=r;let n;return ni(t,!1),Mt=It=null,n?n.done:void 0})}const[eT,tT]=ge(!1);function ym(t,e){const r=Symbol("context");return{id:r,Provider:Bg(r),defaultValue:t}}function pc(t){let e;return It&&It.context&&(e=It.context[t.id])!==void 0?e:t.defaultValue}function vc(t){const e=qe(t),r=qe(()=>Ml(e()));return r.toArray=()=>{const n=r();return Array.isArray(n)?n:n!=null?[n]:[]},r}function gm(){if(this.sources&&this.state)if(this.state===ti)is(this);else{const t=wr;wr=null,ni(()=>aa(this),!1),wr=t}if(Mt){const t=this.observers?this.observers.length:0;Mt.sources?(Mt.sources.push(this),Mt.sourceSlots.push(t)):(Mt.sources=[this],Mt.sourceSlots=[t]),this.observers?(this.observers.push(Mt),this.observerSlots.push(Mt.sources.length-1)):(this.observers=[Mt],this.observerSlots=[Mt.sources.length-1])}return this.value}function pm(t,e,r){let n=t.value;return(!t.comparator||!t.comparator(n,e))&&(t.value=e,t.observers&&t.observers.length&&ni(()=>{for(let i=0;i<t.observers.length;i+=1){const o=t.observers[i],a=nl&&nl.running;a&&nl.disposed.has(o),(a?!o.tState:!o.state)&&(o.pure?wr.push(o):Pn.push(o),o.observers&&bm(o)),a||(o.state=ti)}if(wr.length>1e6)throw wr=[],new Error},!1)),e}function is(t){if(!t.fn)return;qo(t);const e=Ra;Lg(t,t.value,e)}function Lg(t,e,r){let n;const i=It,o=Mt;Mt=It=t;try{n=t.fn(e)}catch(a){return t.pure&&(t.state=ti,t.owned&&t.owned.forEach(qo),t.owned=null),t.updatedAt=r+1,_c(a)}finally{Mt=o,It=i}(!t.updatedAt||t.updatedAt<=r)&&(t.updatedAt!=null&&"observers"in t?pm(t,n):t.value=n,t.updatedAt=r)}function bc(t,e,r,n=ti,i){const o={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:It,context:It?It.context:null,pure:r};return It===null||It!==dm&&(It.owned?It.owned.push(o):It.owned=[o]),o}function sa(t){if(t.state===0)return;if(t.state===oa)return aa(t);if(t.suspense&&Ur(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<Ra);)t.state&&e.push(t);for(let r=e.length-1;r>=0;r--)if(t=e[r],t.state===ti)is(t);else if(t.state===oa){const n=wr;wr=null,ni(()=>aa(t,e[0]),!1),wr=n}}function ni(t,e){if(wr)return t();let r=!1;e||(wr=[]),Pn?r=!0:Pn=[],Ra++;try{const n=t();return Mg(r),n}catch(n){r||(Pn=null),wr=null,_c(n)}}function Mg(t){if(wr&&(vm(wr),wr=null),t)return;const e=Pn;Pn=null,e.length&&ni(()=>um(e),!1)}function vm(t){for(let e=0;e<t.length;e++)sa(t[e])}function Og(t){let e,r=0;for(e=0;e<t.length;e++){const n=t[e];n.user?t[r++]=n:sa(n)}for(e=0;e<r;e++)sa(t[e])}function aa(t,e){t.state=0;for(let r=0;r<t.sources.length;r+=1){const n=t.sources[r];if(n.sources){const i=n.state;i===ti?n!==e&&(!n.updatedAt||n.updatedAt<Ra)&&sa(n):i===oa&&aa(n,e)}}}function bm(t){for(let e=0;e<t.observers.length;e+=1){const r=t.observers[e];r.state||(r.state=oa,r.pure?wr.push(r):Pn.push(r),r.observers&&bm(r))}}function qo(t){let e;if(t.sources)for(;t.sources.length;){const r=t.sources.pop(),n=t.sourceSlots.pop(),i=r.observers;if(i&&i.length){const o=i.pop(),a=r.observerSlots.pop();n<i.length&&(o.sourceSlots[a]=n,i[n]=o,r.observerSlots[n]=a)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)qo(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)qo(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function Vg(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function _c(t,e=It){throw Vg(t)}function Ml(t){if(typeof t=="function"&&!t.length)return Ml(t());if(Array.isArray(t)){const e=[];for(let r=0;r<t.length;r++){const n=Ml(t[r]);Array.isArray(n)?e.push.apply(e,n):e.push(n)}return e}return t}function Bg(t,e){return function(n){let i;return ie(()=>i=Ur(()=>(It.context={...It.context,[t]:n.value},vc(()=>n.children))),void 0),i}}const Fg=Symbol("fallback");function Yu(t){for(let e=0;e<t.length;e++)t[e]()}function Ug(t,e,r={}){let n=[],i=[],o=[],a=0,c=e.length>1?[]:null;return oo(()=>Yu(o)),()=>{let u=t()||[],h=u.length,f,g;return u[Nl],Ur(()=>{let C,R,T,E,$,K,Z,J,de;if(h===0)a!==0&&(Yu(o),o=[],n=[],i=[],a=0,c&&(c=[])),r.fallback&&(n=[Fg],i[0]=Oo(re=>(o[0]=re,r.fallback())),a=1);else if(a===0){for(i=new Array(h),g=0;g<h;g++)n[g]=u[g],i[g]=Oo(b);a=h}else{for(T=new Array(h),E=new Array(h),c&&($=new Array(h)),K=0,Z=Math.min(a,h);K<Z&&n[K]===u[K];K++);for(Z=a-1,J=h-1;Z>=K&&J>=K&&n[Z]===u[J];Z--,J--)T[J]=i[Z],E[J]=o[Z],c&&($[J]=c[Z]);for(C=new Map,R=new Array(J+1),g=J;g>=K;g--)de=u[g],f=C.get(de),R[g]=f===void 0?-1:f,C.set(de,g);for(f=K;f<=Z;f++)de=n[f],g=C.get(de),g!==void 0&&g!==-1?(T[g]=i[f],E[g]=o[f],c&&($[g]=c[f]),g=R[g],C.set(de,g)):o[f]();for(g=K;g<h;g++)g in T?(i[g]=T[g],o[g]=E[g],c&&(c[g]=$[g],c[g](g))):i[g]=Oo(b);i=i.slice(0,a=h),n=u.slice(0)}return i});function b(C){if(o[g]=C,c){const[R,T]=ge(g);return c[g]=T,e(u[g],R)}return e(u[g])}}}function _(t,e){return Ur(()=>t(e||{}))}function Ts(){return!0}const Ol={get(t,e,r){return e===Yr?r:t.get(e)},has(t,e){return e===Yr?!0:t.has(e)},set:Ts,deleteProperty:Ts,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:Ts,deleteProperty:Ts}},ownKeys(t){return t.keys()}};function il(t){return(t=typeof t=="function"?t():t)?t:{}}function jg(){for(let t=0,e=this.length;t<e;++t){const r=this[t]();if(r!==void 0)return r}}function Vl(...t){let e=!1;for(let a=0;a<t.length;a++){const c=t[a];e=e||!!c&&Yr in c,t[a]=typeof c=="function"?(e=!0,qe(c)):c}if(cm&&e)return new Proxy({get(a){for(let c=t.length-1;c>=0;c--){const u=il(t[c])[a];if(u!==void 0)return u}},has(a){for(let c=t.length-1;c>=0;c--)if(a in il(t[c]))return!0;return!1},keys(){const a=[];for(let c=0;c<t.length;c++)a.push(...Object.keys(il(t[c])));return[...new Set(a)]}},Ol);const r={},n=Object.create(null);for(let a=t.length-1;a>=0;a--){const c=t[a];if(!c)continue;const u=Object.getOwnPropertyNames(c);for(let h=u.length-1;h>=0;h--){const f=u[h];if(f==="__proto__"||f==="constructor")continue;const g=Object.getOwnPropertyDescriptor(c,f);if(!n[f])n[f]=g.get?{enumerable:!0,configurable:!0,get:jg.bind(r[f]=[g.get.bind(c)])}:g.value!==void 0?g:void 0;else{const b=r[f];b&&(g.get?b.push(g.get.bind(c)):g.value!==void 0&&b.push(()=>g.value))}}}const i={},o=Object.keys(n);for(let a=o.length-1;a>=0;a--){const c=o[a],u=n[c];u&&u.get?Object.defineProperty(i,c,u):i[c]=u?u.value:void 0}return i}function zg(t,...e){if(cm&&Yr in t){const i=new Set(e.length>1?e.flat():e[0]),o=e.map(a=>new Proxy({get(c){return a.includes(c)?t[c]:void 0},has(c){return a.includes(c)&&c in t},keys(){return a.filter(c=>c in t)}},Ol));return o.push(new Proxy({get(a){return i.has(a)?void 0:t[a]},has(a){return i.has(a)?!1:a in t},keys(){return Object.keys(t).filter(a=>!i.has(a))}},Ol)),o}const r={},n=e.map(()=>({}));for(const i of Object.getOwnPropertyNames(t)){const o=Object.getOwnPropertyDescriptor(t,i),a=!o.get&&!o.set&&o.enumerable&&o.writable&&o.configurable;let c=!1,u=0;for(const h of e)h.includes(i)&&(c=!0,a?n[u][i]=o.value:Object.defineProperty(n[u],i,o)),++u;c||(a?r[i]=o.value:Object.defineProperty(r,i,o))}return[...n,r]}const qg=t=>`Stale read from <${t}>.`;function xt(t){const e="fallback"in t&&{fallback:()=>t.fallback};return qe(Ug(()=>t.each,t.children,e||void 0))}function Le(t){const e=t.keyed,r=qe(()=>t.when,void 0,void 0),n=e?r:qe(r,void 0,{equals:(i,o)=>!i==!o});return qe(()=>{const i=n();if(i){const o=t.children;return typeof o=="function"&&o.length>0?Ur(()=>o(e?i:()=>{if(!Ur(n))throw qg("Show");return r()})):o}return t.fallback},void 0,void 0)}const Hg=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],Gg=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline",...Hg]),Wg=new Set(["innerHTML","textContent","innerText","children"]),Yg=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),Kg=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function Qg(t,e){const r=Kg[t];return typeof r=="object"?r[e]?r.$:void 0:r}const Jg=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),me=t=>qe(()=>t());function Xg(t,e,r){let n=r.length,i=e.length,o=n,a=0,c=0,u=e[i-1].nextSibling,h=null;for(;a<i||c<o;){if(e[a]===r[c]){a++,c++;continue}for(;e[i-1]===r[o-1];)i--,o--;if(i===a){const f=o<n?c?r[c-1].nextSibling:r[o-c]:u;for(;c<o;)t.insertBefore(r[c++],f)}else if(o===c)for(;a<i;)(!h||!h.has(e[a]))&&e[a].remove(),a++;else if(e[a]===r[o-1]&&r[c]===e[i-1]){const f=e[--i].nextSibling;t.insertBefore(r[c++],e[a++].nextSibling),t.insertBefore(r[--o],f),e[i]=r[o]}else{if(!h){h=new Map;let g=c;for(;g<o;)h.set(r[g],g++)}const f=h.get(e[a]);if(f!=null)if(c<f&&f<o){let g=a,b=1,C;for(;++g<i&&g<o&&!((C=h.get(e[g]))==null||C!==f+b);)b++;if(b>f-c){const R=e[a];for(;c<f;)t.insertBefore(r[c++],R)}else t.replaceChild(r[c++],e[a++])}else a++;else e[a++].remove()}}}const Ku="_$DX_DELEGATE";function Zg(t,e,r,n={}){let i;return Oo(o=>{i=o,e===document?t():s(e,t(),e.firstChild?null:void 0,r)},n.owner),()=>{i(),e.textContent=""}}function G(t,e,r,n){let i;const o=()=>{const c=document.createElement("template");return c.innerHTML=t,c.content.firstChild},a=()=>(i||(i=o())).cloneNode(!0);return a.cloneNode=a,a}function _t(t,e=window.document){const r=e[Ku]||(e[Ku]=new Set);for(let n=0,i=t.length;n<i;n++){const o=t[n];r.has(o)||(r.add(o),e.addEventListener(o,sp))}}function lt(t,e,r){r==null?t.removeAttribute(e):t.setAttribute(e,r)}function ep(t,e,r){r?t.setAttribute(e,""):t.removeAttribute(e)}function Sc(t,e){e==null?t.removeAttribute("class"):t.className=e}function Ai(t,e,r,n){if(n)Array.isArray(r)?(t[`$$${e}`]=r[0],t[`$$${e}Data`]=r[1]):t[`$$${e}`]=r;else if(Array.isArray(r)){const i=r[0];t.addEventListener(e,r[0]=o=>i.call(t,r[1],o))}else t.addEventListener(e,r,typeof r!="function"&&r)}function tp(t,e,r={}){const n=Object.keys(e||{}),i=Object.keys(r);let o,a;for(o=0,a=i.length;o<a;o++){const c=i[o];!c||c==="undefined"||e[c]||(Qu(t,c,!1),delete r[c])}for(o=0,a=n.length;o<a;o++){const c=n[o],u=!!e[c];!c||c==="undefined"||r[c]===u||!u||(Qu(t,c,!0),r[c]=u)}return r}function d(t,e,r){if(!e)return r?lt(t,"style"):e;const n=t.style;if(typeof e=="string")return n.cssText=e;typeof r=="string"&&(n.cssText=r=void 0),r||(r={}),e||(e={});let i,o;for(o in r)e[o]==null&&n.removeProperty(o),delete r[o];for(o in e)i=e[o],i!==r[o]&&(n.setProperty(o,i),r[o]=i);return r}function rp(t,e={},r,n){const i={};return ie(()=>i.children=Ho(t,e.children,i.children)),ie(()=>typeof e.ref=="function"&&np(e.ref,t)),ie(()=>ip(t,e,r,!0,i,!0)),i}function np(t,e,r){return Ur(()=>t(e,r))}function s(t,e,r,n){if(r!==void 0&&!n&&(n=[]),typeof e!="function")return Ho(t,e,n,r);ie(i=>Ho(t,e(),i,r),n)}function ip(t,e,r,n,i={},o=!1){e||(e={});for(const a in i)if(!(a in e)){if(a==="children")continue;i[a]=Ju(t,a,null,i[a],r,o,e)}for(const a in e){if(a==="children")continue;const c=e[a];i[a]=Ju(t,a,c,i[a],r,o,e)}}function op(t){return t.toLowerCase().replace(/-([a-z])/g,(e,r)=>r.toUpperCase())}function Qu(t,e,r){const n=e.trim().split(/\s+/);for(let i=0,o=n.length;i<o;i++)t.classList.toggle(n[i],r)}function Ju(t,e,r,n,i,o,a){let c,u,h,f,g;if(e==="style")return d(t,r,n);if(e==="classList")return tp(t,r,n);if(r===n)return n;if(e==="ref")o||r(t);else if(e.slice(0,3)==="on:"){const b=e.slice(3);n&&t.removeEventListener(b,n,typeof n!="function"&&n),r&&t.addEventListener(b,r,typeof r!="function"&&r)}else if(e.slice(0,10)==="oncapture:"){const b=e.slice(10);n&&t.removeEventListener(b,n,!0),r&&t.addEventListener(b,r,!0)}else if(e.slice(0,2)==="on"){const b=e.slice(2).toLowerCase(),C=Jg.has(b);if(!C&&n){const R=Array.isArray(n)?n[0]:n;t.removeEventListener(b,R)}(C||r)&&(Ai(t,b,r,C),C&&_t([b]))}else e.slice(0,5)==="attr:"?lt(t,e.slice(5),r):e.slice(0,5)==="bool:"?ep(t,e.slice(5),r):(g=e.slice(0,5)==="prop:")||(h=Wg.has(e))||(f=Qg(e,t.tagName))||(u=Gg.has(e))||(c=t.nodeName.includes("-")||"is"in a)?(g&&(e=e.slice(5),u=!0),e==="class"||e==="className"?Sc(t,r):c&&!u&&!h?t[op(e)]=r:t[f||e]=r):lt(t,Yg[e]||e,r);return r}function sp(t){let e=t.target;const r=`$$${t.type}`,n=t.target,i=t.currentTarget,o=u=>Object.defineProperty(t,"target",{configurable:!0,value:u}),a=()=>{const u=e[r];if(u&&!e.disabled){const h=e[`${r}Data`];if(h!==void 0?u.call(e,h,t):u.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&o(e.host),!0},c=()=>{for(;a()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const u=t.composedPath();o(u[0]);for(let h=0;h<u.length-2&&(e=u[h],!!a());h++){if(e._$host){e=e._$host,c();break}if(e.parentNode===i)break}}else c();o(n)}function Ho(t,e,r,n,i){for(;typeof r=="function";)r=r();if(e===r)return r;const o=typeof e,a=n!==void 0;if(t=a&&r[0]&&r[0].parentNode||t,o==="string"||o==="number"){if(o==="number"&&(e=e.toString(),e===r))return r;if(a){let c=r[0];c&&c.nodeType===3?c.data!==e&&(c.data=e):c=document.createTextNode(e),r=Mi(t,r,n,c)}else r!==""&&typeof r=="string"?r=t.firstChild.data=e:r=t.textContent=e}else if(e==null||o==="boolean")r=Mi(t,r,n);else{if(o==="function")return ie(()=>{let c=e();for(;typeof c=="function";)c=c();r=Ho(t,c,r,n)}),()=>r;if(Array.isArray(e)){const c=[],u=r&&Array.isArray(r);if(Bl(c,e,r,i))return ie(()=>r=Ho(t,c,r,n,!0)),()=>r;if(c.length===0){if(r=Mi(t,r,n),a)return r}else u?r.length===0?Xu(t,c,n):Xg(t,r,c):(r&&Mi(t),Xu(t,c));r=c}else if(e.nodeType){if(Array.isArray(r)){if(a)return r=Mi(t,r,n,e);Mi(t,r,null,e)}else r==null||r===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);r=e}}return r}function Bl(t,e,r,n){let i=!1;for(let o=0,a=e.length;o<a;o++){let c=e[o],u=r&&r[t.length],h;if(!(c==null||c===!0||c===!1))if((h=typeof c)=="object"&&c.nodeType)t.push(c);else if(Array.isArray(c))i=Bl(t,c,u)||i;else if(h==="function")if(n){for(;typeof c=="function";)c=c();i=Bl(t,Array.isArray(c)?c:[c],Array.isArray(u)?u:[u])||i}else t.push(c),i=!0;else{const f=String(c);u&&u.nodeType===3&&u.data===f?t.push(u):t.push(document.createTextNode(f))}}return i}function Xu(t,e,r=null){for(let n=0,i=e.length;n<i;n++)t.insertBefore(e[n],r)}function Mi(t,e,r,n){if(r===void 0)return t.textContent="";const i=n||document.createTextNode("");if(e.length){let o=!1;for(let a=e.length-1;a>=0;a--){const c=e[a];if(i!==c){const u=c.parentNode===t;!o&&!a?u?t.replaceChild(i,c):t.insertBefore(i,r):u&&c.remove()}else o=!0}}else t.insertBefore(i,r);return[i]}const ap=!1;function _m(){let t=new Set;function e(i){return t.add(i),()=>t.delete(i)}let r=!1;function n(i,o){if(r)return!(r=!1);const a={to:i,options:o,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const c of t)c.listener({...a,from:c.location,retry:u=>{u&&(r=!0),c.navigate(i,{...o,resolve:!1})}});return!a.defaultPrevented}return{subscribe:e,confirm:n}}let Fl;function Pc(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Fl=window.history.state._depth}Pc();function lp(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function cp(t,e){let r=!1;return()=>{const n=Fl;Pc();const i=n==null?null:Fl-n;if(r){r=!1;return}i&&e(i)?(r=!0,window.history.go(-i)):t()}}const up=/^(?:[a-z0-9]+:)?\/\//i,dp=/^\/+|(\/)\/+$/g,Sm="http://sr";function vi(t,e=!1){const r=t.replace(dp,"$1");return r?e||/^[?#]/.test(r)?r:"/"+r:""}function Gs(t,e,r){if(up.test(e))return;const n=vi(t),i=r&&vi(r);let o="";return!i||e.startsWith("/")?o=n:i.toLowerCase().indexOf(n.toLowerCase())!==0?o=n+i:o=i,(o||"/")+vi(e,!o)}function hp(t,e){if(t==null)throw new Error(e);return t}function mp(t,e){return vi(t).replace(/\/*(\*.*)?$/g,"")+vi(e)}function Pm(t){const e={};return t.searchParams.forEach((r,n)=>{n in e?Array.isArray(e[n])?e[n].push(r):e[n]=[e[n],r]:e[n]=r}),e}function fp(t,e,r){const[n,i]=t.split("/*",2),o=n.split("/").filter(Boolean),a=o.length;return c=>{const u=c.split("/").filter(Boolean),h=u.length-a;if(h<0||h>0&&i===void 0&&!e)return null;const f={path:a?"":"/",params:{}},g=b=>r===void 0?void 0:r[b];for(let b=0;b<a;b++){const C=o[b],R=C[0]===":",T=R?u[b]:u[b].toLowerCase(),E=R?C.slice(1):C.toLowerCase();if(R&&ol(T,g(E)))f.params[E]=T;else if(R||!ol(T,E))return null;f.path+=`/${T}`}if(i){const b=h?u.slice(-h).join("/"):"";if(ol(b,g(i)))f.params[i]=b;else return null}return f}}function ol(t,e){const r=n=>n===t;return e===void 0?!0:typeof e=="string"?r(e):typeof e=="function"?e(t):Array.isArray(e)?e.some(r):e instanceof RegExp?e.test(t):!1}function yp(t){const[e,r]=t.pattern.split("/*",2),n=e.split("/").filter(Boolean);return n.reduce((i,o)=>i+(o.startsWith(":")?2:3),n.length-(r===void 0?0:1))}function wm(t){const e=new Map,r=mm();return new Proxy({},{get(n,i){return e.has(i)||fm(r,()=>e.set(i,qe(()=>t()[i]))),e.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function Cm(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let r=t.slice(0,e.index),n=t.slice(e.index+e[0].length);const i=[r,r+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(n);)i.push(r+=e[1]),n=n.slice(e[0].length);return Cm(n).reduce((o,a)=>[...o,...i.map(c=>c+a)],[])}const gp=100,Am=ym(),wc=ym(),os=()=>hp(pc(Am),"<A> and 'use' router primitives can be only used inside a Route."),pp=()=>pc(wc)||os().base,vp=t=>{const e=pp();return qe(()=>e.resolvePath(t()))},bp=t=>{const e=os();return qe(()=>{const r=t();return r!==void 0?e.renderPath(r):r})},Cc=()=>os().navigatorFactory(),_p=()=>os().location,Sp=()=>os().params;function Pp(t,e=""){const{component:r,preload:n,load:i,children:o,info:a}=t,c=!o||Array.isArray(o)&&!o.length,u={key:t,component:r,preload:n||i,info:a};return Im(t.path).reduce((h,f)=>{for(const g of Cm(f)){const b=mp(e,g);let C=c?b:b.split("/*",1)[0];C=C.split("/").map(R=>R.startsWith(":")||R.startsWith("*")?R:encodeURIComponent(R)).join("/"),h.push({...u,originalPath:f,pattern:C,matcher:fp(C,!c,t.matchFilters)})}return h},[])}function wp(t,e=0){return{routes:t,score:yp(t[t.length-1])*1e4-e,matcher(r){const n=[];for(let i=t.length-1;i>=0;i--){const o=t[i],a=o.matcher(r);if(!a)return null;n.unshift({...a,route:o})}return n}}}function Im(t){return Array.isArray(t)?t:[t]}function Em(t,e="",r=[],n=[]){const i=Im(t);for(let o=0,a=i.length;o<a;o++){const c=i[o];if(c&&typeof c=="object"){c.hasOwnProperty("path")||(c.path="");const u=Pp(c,e);for(const h of u){r.push(h);const f=Array.isArray(c.children)&&c.children.length===0;if(c.children&&!f)Em(c.children,h.pattern,r,n);else{const g=wp([...r],n.length);n.push(g)}r.pop()}}}return r.length?n:n.sort((o,a)=>a.score-o.score)}function sl(t,e){for(let r=0,n=t.length;r<n;r++){const i=t[r].matcher(e);if(i)return i}return[]}function Cp(t,e,r){const n=new URL(Sm),i=qe(f=>{const g=t();try{return new URL(g,n)}catch{return console.error(`Invalid path ${g}`),f}},n,{equals:(f,g)=>f.href===g.href}),o=qe(()=>i().pathname),a=qe(()=>i().search,!0),c=qe(()=>i().hash),u=()=>"",h=gc(a,()=>Pm(i()));return{get pathname(){return o()},get search(){return a()},get hash(){return c()},get state(){return e()},get key(){return u()},query:r?r(h):wm(h)}}let mi;function Ap(){return mi}function Ip(t,e,r,n={}){const{signal:[i,o],utils:a={}}=t,c=a.parsePath||(se=>se),u=a.renderPath||(se=>se),h=a.beforeLeave||_m(),f=Gs("",n.base||"");if(f===void 0)throw new Error(`${f} is not a valid base path`);f&&!i().value&&o({value:f,replace:!0,scroll:!1});const[g,b]=ge(!1);let C;const R=(se,W)=>{W.value===T()&&W.state===$()||(C===void 0&&b(!0),mi=se,C=W,Ng(()=>{C===W&&(E(C.value),K(C.state),de[1](k=>k.filter(H=>H.pending)))}).finally(()=>{C===W&&hm(()=>{mi=void 0,se==="navigate"&&A(C),b(!1),C=void 0})}))},[T,E]=ge(i().value),[$,K]=ge(i().state),Z=Cp(T,$,a.queryWrapper),J=[],de=ge([]),re=qe(()=>typeof n.transformUrl=="function"?sl(e(),n.transformUrl(Z.pathname)):sl(e(),Z.pathname)),I=()=>{const se=re(),W={};for(let k=0;k<se.length;k++)Object.assign(W,se[k].params);return W},S=a.paramsWrapper?a.paramsWrapper(I,e):wm(I),v={pattern:f,path:()=>f,outlet:()=>null,resolvePath(se){return Gs(f,se)}};return ie(gc(i,se=>R("native",se),{defer:!0})),{base:v,location:Z,params:S,isRouting:g,renderPath:u,parsePath:c,navigatorFactory:P,matches:re,beforeLeave:h,preloadRoute:y,singleFlight:n.singleFlight===void 0?!0:n.singleFlight,submissions:de};function w(se,W,k){Ur(()=>{if(typeof W=="number"){W&&(a.go?a.go(W):console.warn("Router integration does not support relative routing"));return}const H=!W||W[0]==="?",{replace:V,resolve:O,scroll:D,state:M}={replace:!1,resolve:!H,scroll:!0,...k},he=O?se.resolvePath(W):Gs(H&&Z.pathname||"",W);if(he===void 0)throw new Error(`Path '${W}' is not a routable path`);if(J.length>=gp)throw new Error("Too many redirects");const z=T();(he!==z||M!==$())&&(ap||h.confirm(he,k)&&(J.push({value:z,replace:V,scroll:D,state:$()}),R("navigate",{value:he,state:M})))})}function P(se){return se=se||pc(wc)||v,(W,k)=>w(se,W,k)}function A(se){const W=J[0];W&&(o({...se,replace:W.replace,scroll:W.scroll}),J.length=0)}function y(se,W){const k=sl(e(),se.pathname),H=mi;mi="preload";for(let V in k){const{route:O,params:D}=k[V];O.component&&O.component.preload&&O.component.preload();const{preload:M}=O;W&&M&&fm(r(),()=>M({params:D,location:{pathname:se.pathname,search:se.search,hash:se.hash,query:Pm(se),state:null,key:""},intent:"preload"}))}mi=H}}function Ep(t,e,r,n){const{base:i,location:o,params:a}=t,{pattern:c,component:u,preload:h}=n().route,f=qe(()=>n().path);u&&u.preload&&u.preload();const g=h?h({params:a,location:o,intent:mi||"initial"}):void 0;return{parent:e,pattern:c,path:f,outlet:()=>u?_(u,{params:a,location:o,data:g,get children(){return r()}}):r(),resolvePath(C){return Gs(i.path(),C,f())}}}const xp=t=>e=>{const{base:r}=e,n=vc(()=>e.children),i=qe(()=>Em(n(),e.base||""));let o;const a=Ip(t,i,()=>o,{base:r,singleFlight:e.singleFlight,transformUrl:e.transformUrl});return t.create&&t.create(a),_(Am.Provider,{value:a,get children(){return _(Tp,{routerState:a,get root(){return e.root},get preload(){return e.rootPreload||e.rootLoad},get children(){return[me(()=>(o=mm())&&null),_($p,{routerState:a,get branches(){return i()}})]}})}})};function Tp(t){const e=t.routerState.location,r=t.routerState.params,n=qe(()=>t.preload&&Ur(()=>{t.preload({params:r,location:e,intent:Ap()||"initial"})}));return _(Le,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:i=>_(i,{params:r,location:e,get data(){return n()},get children(){return t.children}})})}function $p(t){const e=[];let r;const n=qe(gc(t.routerState.matches,(i,o,a)=>{let c=o&&i.length===o.length;const u=[];for(let h=0,f=i.length;h<f;h++){const g=o&&o[h],b=i[h];a&&g&&b.route.key===g.route.key?u[h]=a[h]:(c=!1,e[h]&&e[h](),Oo(C=>{e[h]=C,u[h]=Ep(t.routerState,u[h-1]||t.routerState.base,Zu(()=>n()[h+1]),()=>t.routerState.matches()[h])}))}return e.splice(i.length).forEach(h=>h()),a&&c?a:(r=u[0],u)}));return Zu(()=>n()&&r)()}const Zu=t=>()=>_(Le,{get when(){return t()},keyed:!0,children:e=>_(wc.Provider,{value:e,get children(){return e.outlet()}})}),Hr=t=>{const e=vc(()=>t.children);return Vl(t,{get children(){return e()}})};function kp([t,e],r,n){return[t,n?i=>e(n(i)):e]}function Rp(t){let e=!1;const r=i=>typeof i=="string"?{value:i}:i,n=kp(ge(r(t.get()),{equals:(i,o)=>i.value===o.value&&i.state===o.state}),void 0,i=>(!e&&t.set(i),i));return t.init&&oo(t.init((i=t.get())=>{e=!0,n[1](r(i)),e=!1})),xp({signal:n,create:t.create,utils:t.utils})}function Dp(t,e,r){return t.addEventListener(e,r),()=>t.removeEventListener(e,r)}function Np(t,e){const r=t&&document.getElementById(t);r?r.scrollIntoView():e&&window.scrollTo(0,0)}const Lp=new Map;function Mp(t=!0,e=!1,r="/_server",n){return i=>{const o=i.base.path(),a=i.navigatorFactory(i.base);let c,u;function h(T){return T.namespaceURI==="http://www.w3.org/2000/svg"}function f(T){if(T.defaultPrevented||T.button!==0||T.metaKey||T.altKey||T.ctrlKey||T.shiftKey)return;const E=T.composedPath().find(re=>re instanceof Node&&re.nodeName.toUpperCase()==="A");if(!E||e&&!E.hasAttribute("link"))return;const $=h(E),K=$?E.href.baseVal:E.href;if(($?E.target.baseVal:E.target)||!K&&!E.hasAttribute("state"))return;const J=(E.getAttribute("rel")||"").split(/\s+/);if(E.hasAttribute("download")||J&&J.includes("external"))return;const de=$?new URL(K,document.baseURI):new URL(K);if(!(de.origin!==window.location.origin||o&&de.pathname&&!de.pathname.toLowerCase().startsWith(o.toLowerCase())))return[E,de]}function g(T){const E=f(T);if(!E)return;const[$,K]=E,Z=i.parsePath(K.pathname+K.search+K.hash),J=$.getAttribute("state");T.preventDefault(),a(Z,{resolve:!1,replace:$.hasAttribute("replace"),scroll:!$.hasAttribute("noscroll"),state:J?JSON.parse(J):void 0})}function b(T){const E=f(T);if(!E)return;const[$,K]=E;i.preloadRoute(K,$.getAttribute("preload")!=="false")}function C(T){clearTimeout(c);const E=f(T);if(!E)return u=null;const[$,K]=E;u!==$&&(c=setTimeout(()=>{i.preloadRoute(K,$.getAttribute("preload")!=="false"),u=$},20))}function R(T){if(T.defaultPrevented)return;let E=T.submitter&&T.submitter.hasAttribute("formaction")?T.submitter.getAttribute("formaction"):T.target.getAttribute("action");if(!E)return;if(!E.startsWith("https://action/")){const K=new URL(E,Sm);if(E=i.parsePath(K.pathname+K.search),!E.startsWith(r))return}if(T.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const $=Lp.get(E);if($){T.preventDefault();const K=new FormData(T.target,T.submitter);$.call({r:i,f:T.target},T.target.enctype==="multipart/form-data"?K:new URLSearchParams(K))}}_t(["click","submit"]),document.addEventListener("click",g),t&&(document.addEventListener("mousemove",C,{passive:!0}),document.addEventListener("focusin",b,{passive:!0}),document.addEventListener("touchstart",b,{passive:!0})),document.addEventListener("submit",R),oo(()=>{document.removeEventListener("click",g),t&&(document.removeEventListener("mousemove",C),document.removeEventListener("focusin",b),document.removeEventListener("touchstart",b)),document.removeEventListener("submit",R)})}}function Op(t){const e=t.replace(/^.*?#/,"");if(!e.startsWith("/")){const[,r="/"]=window.location.hash.split("#",2);return`${r}#${e}`}return e}function Vp(t){const e=()=>window.location.hash.slice(1),r=_m();return Rp({get:e,set({value:n,replace:i,scroll:o,state:a}){i?window.history.replaceState(lp(a),"","#"+n):window.history.pushState(a,"","#"+n);const c=n.indexOf("#"),u=c>=0?n.slice(c+1):"";Np(u,o),Pc()},init:n=>Dp(window,"hashchange",cp(n,i=>!r.confirm(i&&i<0?i:e()))),create:Mp(t.preload,t.explicitLinks,t.actionBase),utils:{go:n=>window.history.go(n),renderPath:n=>`#${n}`,parsePath:Op,beforeLeave:r}})(t)}var Bp=G("<a>");function tn(t){t=Vl({inactiveClass:"inactive",activeClass:"active"},t);const[,e]=zg(t,["href","state","class","activeClass","inactiveClass","end"]),r=vp(()=>t.href),n=bp(r),i=_p(),o=qe(()=>{const a=r();if(a===void 0)return[!1,!1];const c=vi(a.split(/[?#]/,1)[0]).toLowerCase(),u=decodeURI(vi(i.pathname).toLowerCase());return[t.end?c===u:u.startsWith(c+"/")||u===c,c===u]});return(()=>{var a=Bp();return rp(a,Vl(e,{get href(){return n()||t.href},get state(){return JSON.stringify(t.state)},get classList(){return{...t.class&&{[t.class]:!0},[t.inactiveClass]:!o()[0],[t.activeClass]:o()[0],...e.classList}},link:"",get"aria-current"(){return o()[1]?"page":void 0}}),!1),a})()}const Ul=Symbol("store-raw"),Hi=Symbol("store-node"),vn=Symbol("store-has"),xm=Symbol("store-self");function Tm(t){let e=t[Yr];if(!e&&(Object.defineProperty(t,Yr,{value:e=new Proxy(t,jp)}),!Array.isArray(t))){const r=Object.keys(t),n=Object.getOwnPropertyDescriptors(t);for(let i=0,o=r.length;i<o;i++){const a=r[i];n[a].get&&Object.defineProperty(t,a,{enumerable:n[a].enumerable,get:n[a].get.bind(e)})}}return e}function la(t){let e;return t!=null&&typeof t=="object"&&(t[Yr]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function Go(t,e=new Set){let r,n,i,o;if(r=t!=null&&t[Ul])return r;if(!la(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let a=0,c=t.length;a<c;a++)i=t[a],(n=Go(i,e))!==i&&(t[a]=n)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const a=Object.keys(t),c=Object.getOwnPropertyDescriptors(t);for(let u=0,h=a.length;u<h;u++)o=a[u],!c[o].get&&(i=t[o],(n=Go(i,e))!==i&&(t[o]=n))}return t}function ca(t,e){let r=t[e];return r||Object.defineProperty(t,e,{value:r=Object.create(null)}),r}function Wo(t,e,r){if(t[e])return t[e];const[n,i]=ge(r,{equals:!1,internal:!0});return n.$=i,t[e]=n}function Fp(t,e){const r=Reflect.getOwnPropertyDescriptor(t,e);return!r||r.get||!r.configurable||e===Yr||e===Hi||(delete r.value,delete r.writable,r.get=()=>t[Yr][e]),r}function $m(t){Ll()&&Wo(ca(t,Hi),xm)()}function Up(t){return $m(t),Reflect.ownKeys(t)}const jp={get(t,e,r){if(e===Ul)return t;if(e===Yr)return r;if(e===Nl)return $m(t),r;const n=ca(t,Hi),i=n[e];let o=i?i():t[e];if(e===Hi||e===vn||e==="__proto__")return o;if(!i){const a=Object.getOwnPropertyDescriptor(t,e);Ll()&&(typeof o!="function"||t.hasOwnProperty(e))&&!(a&&a.get)&&(o=Wo(n,e,o)())}return la(o)?Tm(o):o},has(t,e){return e===Ul||e===Yr||e===Nl||e===Hi||e===vn||e==="__proto__"?!0:(Ll()&&Wo(ca(t,vn),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:Up,getOwnPropertyDescriptor:Fp};function ua(t,e,r,n=!1){if(!n&&t[e]===r)return;const i=t[e],o=t.length;r===void 0?(delete t[e],t[vn]&&t[vn][e]&&i!==void 0&&t[vn][e].$()):(t[e]=r,t[vn]&&t[vn][e]&&i===void 0&&t[vn][e].$());let a=ca(t,Hi),c;if((c=Wo(a,e,i))&&c.$(()=>r),Array.isArray(t)&&t.length!==o){for(let u=t.length;u<o;u++)(c=a[u])&&c.$();(c=Wo(a,"length",o))&&c.$(t.length)}(c=a[xm])&&c.$()}function km(t,e){const r=Object.keys(e);for(let n=0;n<r.length;n+=1){const i=r[n];ua(t,i,e[i])}}function zp(t,e){if(typeof e=="function"&&(e=e(t)),e=Go(e),Array.isArray(e)){if(t===e)return;let r=0,n=e.length;for(;r<n;r++){const i=e[r];t[r]!==i&&ua(t,r,i)}ua(t,"length",n)}else km(t,e)}function $o(t,e,r=[]){let n,i=t;if(e.length>1){n=e.shift();const a=typeof n,c=Array.isArray(t);if(Array.isArray(n)){for(let u=0;u<n.length;u++)$o(t,[n[u]].concat(e),r);return}else if(c&&a==="function"){for(let u=0;u<t.length;u++)n(t[u],u)&&$o(t,[u].concat(e),r);return}else if(c&&a==="object"){const{from:u=0,to:h=t.length-1,by:f=1}=n;for(let g=u;g<=h;g+=f)$o(t,[g].concat(e),r);return}else if(e.length>1){$o(t[n],e,[n].concat(r));return}i=t[n],r=[n].concat(r)}let o=e[0];typeof o=="function"&&(o=o(i,r),o===i)||n===void 0&&o==null||(o=Go(o),n===void 0||la(i)&&la(o)&&!Array.isArray(o)?km(i,o):ua(t,n,o))}function Rm(...[t,e]){const r=Go(t||{}),n=Array.isArray(r),i=Tm(r);function o(...a){hm(()=>{n&&a.length===1?zp(r,a[0]):$o(r,a)})}return[i,o]}const At=(t=300+Math.random()*700)=>new Promise(e=>setTimeout(e,t)),li=(t="")=>`${t}${Date.now()}-${Math.random().toString(36).substr(2,9)}`;let Be={products:[{id:"prod-001",name:"Wireless Headphones",sku:"WH-001",productCode:"WH-001",productName:"Wireless Headphones",description:"High-quality wireless bluetooth headphones",category:"Electronics",unitOfMeasure:"pcs",unitCost:45,sellingPrice:89.99,minStockLevel:10,maxStockLevel:100,isActive:!0,createdDate:"2024-01-15T10:00:00Z",lastModified:"2024-01-15T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-002",name:"USB-C Cable",sku:"USB-001",description:"3ft USB-C charging cable",category:"Accessories",unitOfMeasure:"pcs",unitCost:8.5,sellingPrice:19.99,minStockLevel:25,maxStockLevel:200,isActive:!0,createdDate:"2024-01-16T10:00:00Z",lastModified:"2024-01-16T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-003",name:"Laptop Stand",sku:"LS-001",description:"Adjustable aluminum laptop stand",category:"Office",unitOfMeasure:"pcs",unitCost:25,sellingPrice:49.99,minStockLevel:5,maxStockLevel:50,isActive:!0,createdDate:"2024-01-17T10:00:00Z",lastModified:"2024-01-17T10:00:00Z",businessId:"YB100423253156428"}],locations:[{id:"loc-001",name:"Main Warehouse",code:"WH-001",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-002",name:"Retail Store - Downtown",code:"ST-001",type:"store",address:"456 Main St, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-003",name:"Retail Store - Mall",code:"ST-002",type:"store",address:"789 Mall Blvd, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"}],movements:[{id:"mov-001",productId:"prod-001",productName:"Wireless Headphones",productSku:"WH-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:50,unitCost:45,totalCost:2250,referenceNumber:"PO-001",notes:"Initial stock purchase",createdBy:"admin",createdDate:"2024-01-15T10:00:00Z",invoiceId:"INV-1000001"},{id:"mov-002",productId:"prod-002",productName:"USB-C Cable",productSku:"USB-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:100,unitCost:8.5,totalCost:850,referenceNumber:"PO-001",notes:"Bulk purchase",createdBy:"admin",createdDate:"2024-01-15T10:05:00Z",invoiceId:"INV-1000001"}],accounts:[{id:"acc-001",accountNumber:"1000",accountName:"Cash",accountType:"asset",category:"currentAssets",balance:5e4,parentAccountId:null,description:"Cash and cash equivalents",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"},{id:"acc-002",accountNumber:"1100",accountName:"Accounts Receivable",accountType:"asset",category:"currentAssets",balance:25e3,parentAccountId:null,description:"Money owed by customers",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"}],journalEntries:[{id:"je-001",entryNumber:"JE-001",date:"2024-01-15",description:"Initial cash deposit",reference:"DEP-001",status:"posted",createdBy:"admin",createdAt:"2024-01-15T10:00:00Z",postedAt:"2024-01-15T10:05:00Z",lines:[{id:"jel-001",accountId:"acc-001",accountName:"Cash",description:"Initial deposit",debitAmount:5e4,creditAmount:0},{id:"jel-002",accountId:"acc-003",accountName:"Owner Equity",description:"Initial capital",debitAmount:0,creditAmount:5e4}]}]};const Zt=(t=.05)=>Math.random()<t,er=()=>{const t=["Network timeout","Connection refused","Server temporarily unavailable","Invalid request"];throw new Error(t[Math.floor(Math.random()*t.length)])},kr={products:{async getAll(t,e){await At(),Zt()&&er();let r=[...Be.products];if(t&&t.trim()){const n=t.toLowerCase();r=r.filter(i=>i.name.toLowerCase().includes(n)||i.sku.toLowerCase().includes(n)||i.category.toLowerCase().includes(n)||i.description.toLowerCase().includes(n))}return e?.category&&(r=r.filter(n=>n.category===e.category)),e?.isActive!==void 0&&(r=r.filter(n=>n.isActive===e.isActive)),r},async getById(t){return await At(),Zt()&&er(),Be.products.find(e=>e.id===t)||null},async create(t){if(await At(),Zt()&&er(),Be.products.some(r=>r.sku===t.sku))throw new Error("SKU already exists");const e={...t,id:li("prod-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return Be.products.push(e),e},async update(t,e){await At(),Zt()&&er();const r=Be.products.findIndex(i=>i.id===t);if(r===-1)throw new Error("Product not found");if(e.sku&&Be.products.some(i=>i.id!==t&&i.sku===e.sku))throw new Error("SKU already exists");const n={...Be.products[r],...e,lastModified:new Date().toISOString()};return Be.products[r]=n,n},async delete(t){await At(),Zt()&&er();const e=Be.products.findIndex(n=>n.id===t);if(e===-1)throw new Error("Product not found");return Be.movements.some(n=>n.productId===t)?{success:!1,message:"Cannot delete product with existing movements"}:(Be.products.splice(e,1),{success:!0,message:"Product deleted successfully"})}},locations:{async getAll(t){await At(),Zt()&&er();let e=[...Be.locations];return t?.type&&(e=e.filter(r=>r.type===t.type)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await At(),Be.locations.find(e=>e.id===t)||null},async create(t){if(await At(),Zt()&&er(),Be.locations.some(r=>r.code===t.code))throw new Error("Location code already exists");const e={...t,id:li("loc-"),createdDate:new Date().toISOString()};return Be.locations.push(e),e},async update(t,e){await At(),Zt()&&er();const r=Be.locations.findIndex(n=>n.id===t);if(r===-1)throw new Error("Location not found");if(e.code&&Be.locations.some(n=>n.id!==t&&n.code===e.code))throw new Error("Location code already exists");return Be.locations[r]={...Be.locations[r],...e},Be.locations[r]}},movements:{async getAll(t){await At(),Zt()&&er();let e=[...Be.movements];if(t?.productId&&(e=e.filter(r=>r.productId===t.productId)),t?.locationId&&(e=e.filter(r=>r.locationId===t.locationId)),t?.movementType&&(e=e.filter(r=>r.movementType===t.movementType)),t?.dateFrom&&(e=e.filter(r=>r.createdDate>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.createdDate<=t.dateTo)),t?.search){const r=t.search.toLowerCase();e=e.filter(n=>n.productName.toLowerCase().includes(r)||n.productSku.toLowerCase().includes(r)||n.referenceNumber.toLowerCase().includes(r)||n.notes.toLowerCase().includes(r))}return e.sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime()),e},async getById(t){return await At(),Be.movements.find(e=>e.id===t)||null},async create(t){if(await At(),Zt()&&er(),!Be.products.find(i=>i.id===t.productId))throw new Error("Product not found");if(!Be.locations.find(i=>i.id===t.locationId))throw new Error("Location not found");if(t.movementType==="out"){const i=await this.getStockLevel(t.productId,t.locationId);if(i<t.quantity)throw new Error(`Insufficient stock. Available: ${i}, Requested: ${t.quantity}`)}const n={...t,id:li("mov-"),createdDate:new Date().toISOString()};return Be.movements.push(n),n},async update(t,e){await At(),Zt()&&er();const r=Be.movements.findIndex(i=>i.id===t);if(r===-1)throw new Error("Movement not found");const n={...Be.movements[r],...e,lastModified:new Date().toISOString()};return Be.movements[r]=n,n},async delete(t){await At(),Zt()&&er();const e=Be.movements.findIndex(r=>r.id===t);if(e===-1)throw new Error("Movement not found");return Be.movements.splice(e,1),{success:!0,message:"Movement deleted successfully"}},async createBulk(t){await At(),Zt()&&er();const e=[],r=[],n=new Date().toISOString(),i=Be.locations.find(o=>o.id===t.locationId);if(!i)return{success:!1,movements:[],errors:["Invalid location"]};for(let o=0;o<t.items.length;o++){const a=t.items[o],c=Be.products.find(f=>f.id===a.productId);if(!c){e.push(`Item ${o+1}: Product not found`);continue}if(a.quantity<=0){e.push(`Item ${o+1}: Quantity must be greater than 0`);continue}if(t.movementType==="out"){const f=await this.getStockLevel(a.productId,t.locationId);if(a.quantity>f){e.push(`Item ${o+1}: Insufficient stock. Available: ${f}, Requested: ${a.quantity}`);continue}}const u=a.unitCost||c.unitCost,h={id:li("mov-"),productId:c.id,productName:c.name,productSku:c.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:a.quantity,unitCost:u,totalCost:a.quantity*u,referenceNumber:t.referenceNumber,notes:a.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:t.fromLocationId?Be.locations.find(f=>f.id===t.fromLocationId)?.name:void 0};r.push(h)}return e.length>0?{success:!1,movements:[],errors:e}:(Be.movements.push(...r),{success:!0,movements:r,errors:[]})},async getStockLevel(t,e){return await At(50),Be.movements.filter(r=>r.productId===t&&r.locationId===e).reduce((r,n)=>{switch(n.movementType){case"in":case"adjustment":return r+n.quantity;case"out":return r-n.quantity;case"transfer":return n.locationId===e?r+n.quantity:r;default:return r}},0)},async getStockLevels(){await At();const t=new Map;for(const e of Be.movements){const r=`${e.productId}-${e.locationId}`;let n=t.get(r);switch(n||(n={id:r,productId:e.productId,locationId:e.locationId,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType){case"in":case"adjustment":n.quantity+=e.quantity;break;case"out":n.quantity-=e.quantity;break;case"transfer":e.locationId===e.locationId&&(n.quantity+=e.quantity);break}new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost,n.availableQuantity=n.quantity-n.reservedQuantity}return Array.from(t.values())}},accounts:{async getAll(t){await At(),Zt()&&er();let e=[...Be.accounts];return t?.accountType&&(e=e.filter(r=>r.accountType===t.accountType)),t?.category&&(e=e.filter(r=>r.category===t.category)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await At(),Be.accounts.find(e=>e.id===t)||null},async create(t){if(await At(),Zt()&&er(),Be.accounts.some(r=>r.accountNumber===t.accountNumber))throw new Error("Account number already exists");const e={...t,id:li("acc-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return Be.accounts.push(e),e},async update(t,e){await At(),Zt()&&er();const r=Be.accounts.findIndex(n=>n.id===t);if(r===-1)throw new Error("Account not found");if(e.accountNumber&&Be.accounts.some(n=>n.id!==t&&n.accountNumber===e.accountNumber))throw new Error("Account number already exists");return Be.accounts[r]={...Be.accounts[r],...e,lastModified:new Date().toISOString()},Be.accounts[r]}},journal:{async getAll(t){await At(),Zt()&&er();let e=[...Be.journalEntries];return t?.status&&(e=e.filter(r=>r.status===t.status)),t?.accountId&&(e=e.filter(r=>r.lines.some(n=>n.accountId===t.accountId))),t?.dateFrom&&(e=e.filter(r=>r.date>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.date<=t.dateTo)),e.sort((r,n)=>new Date(n.createdAt).getTime()-new Date(r.createdAt).getTime())},async getById(t){return await At(),Be.journalEntries.find(e=>e.id===t)||null},async create(t){await At(),Zt()&&er();const e=t.lines.reduce((c,u)=>c+(u.debitAmount||0),0),r=t.lines.reduce((c,u)=>c+(u.creditAmount||0),0);if(Math.abs(e-r)>.01)throw new Error(`Entry is not balanced. Debit: ${e}, Credit: ${r}`);const n=Be.journalEntries.sort((c,u)=>u.entryNumber.localeCompare(c.entryNumber))[0],o=`JE-${((n?parseInt(n.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`,a={...t,id:li("je-"),entryNumber:o,createdAt:new Date().toISOString(),lines:t.lines.map(c=>({...c,id:li("jel-")}))};return Be.journalEntries.push(a),a},async update(t,e){await At(),Zt()&&er();const r=Be.journalEntries.findIndex(n=>n.id===t);if(r===-1)throw new Error("Journal entry not found");if(Be.journalEntries[r].status==="posted")throw new Error("Cannot modify posted entries");return Be.journalEntries[r]={...Be.journalEntries[r],...e},Be.journalEntries[r]},async post(t){await At(),Zt()&&er();const e=Be.journalEntries.findIndex(o=>o.id===t);if(e===-1)throw new Error("Journal entry not found");const r=Be.journalEntries[e];if(r.status==="posted")throw new Error("Entry is already posted");const n=r.lines.reduce((o,a)=>o+(a.debitAmount||0),0),i=r.lines.reduce((o,a)=>o+(a.creditAmount||0),0);if(Math.abs(n-i)>.01)throw new Error("Entry must be balanced before posting");return Be.journalEntries[e]={...r,status:"posted",postedAt:new Date().toISOString()},r.lines.forEach(o=>{const a=Be.accounts.findIndex(c=>c.id===o.accountId);if(a!==-1){const c=Be.accounts[a],u=o.debitAmount||0,h=o.creditAmount||0;["asset","expense"].includes(c.accountType)?c.balance+=u-h:c.balance+=h-u}}),Be.journalEntries[e]}},utils:{async getNextEntryNumber(){await At(100);const t=Be.journalEntries.sort((r,n)=>n.entryNumber.localeCompare(r.entryNumber))[0];return`JE-${((t?parseInt(t.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`},async getNextProductCode(t){await At(100);const e=t.toUpperCase().slice(0,3),r=Be.products.filter(i=>i.productCode?.startsWith(e)).sort((i,o)=>(o.productCode||"").localeCompare(i.productCode||""));if(r.length===0)return`${e}001`;const n=parseInt(r[0].productCode?.slice(-3)||"0");return`${e}${(n+1).toString().padStart(3,"0")}`},async healthCheck(){return await At(50),{status:"healthy",timestamp:new Date().toISOString(),version:"1.0.0"}},async resetDatabase(){return await At(200),Be={products:[...Be.products.slice(0,3)],locations:[...Be.locations.slice(0,3)],movements:[...Be.movements.slice(0,2)],accounts:[...Be.accounts.slice(0,2)],journalEntries:[...Be.journalEntries.slice(0,1)]},{success:!0,message:"Database reset to initial state"}},async getStats(){return await At(100),{products:Be.products.length,locations:Be.locations.length,movements:Be.movements.length,accounts:Be.accounts.length,journalEntries:Be.journalEntries.length,totalStockValue:Be.movements.reduce((t,e)=>e.movementType==="in"?t+e.totalCost:e.movementType==="out"?t-e.totalCost:t,0)}}}},Ws=(t=16)=>{const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},qp=t=>typeof t=="string"&&t.trim().length>0,Un=async t=>{const n=await fetch("https://qvamarkets.com/gql_api",{method:"POST",headers:{"Content-Type":"application/json","Accept-Encoding":"gzip, deflate, br",Authorization:"eyJhbGciOiJSUzI1NiIsImtpZCI6IjhlOGZjOGU1NTZmN2E3NmQwOGQzNTgyOWQ2ZjkwYWUyZTEyY2ZkMGQiLCJ0eXAiOiJKV1QifQ"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const i=await n.json();if(i.errors)throw new Error(i.errors[0]?.message||"GraphQL error");return i.data},Hp=t=>({ENTRY:"in",in:"in",TRANSFER:"transfer",transfer:"transfer",SALES:"out",out:"out",adjustment:"adjustment"})[t],jl=t=>({ENTRY:"ENTRY",in:"ENTRY",TRANSFER:"TRANSFER",transfer:"TRANSFER",SALES:"SALES",out:"SALES",adjustment:"adjustment"})[t];function Gp(t){var e=[];return t&&Object.keys(t).map(r=>{e.push(t[r])}),e}function Wp(t){if(!/^[a-z0-9+/]+={0,2}$/i.test(t)||t.length%4!=0)throw Error("Not base64 string");for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,n,i,o,a,c,u,h,f=[],g=0;g<t.length;g+=4)o=e.indexOf(t.charAt(g)),a=e.indexOf(t.charAt(g+1)),c=e.indexOf(t.charAt(g+2)),u=e.indexOf(t.charAt(g+3)),h=o<<18|a<<12|c<<6|u,r=h>>>16&255,n=h>>>8&255,i=h&255,f[g/4]=String.fromCharCode(r,n,i),u==64&&(f[g/4]=String.fromCharCode(r,n)),c==64&&(f[g/4]=String.fromCharCode(r));return t=f.join(""),t}const Yp=async()=>({}),Kp=()=>(typeof window<"u"&&localStorage.getItem("hrmfinance-api-mode"),"real");let fi=Kp();const Yo={getMode(){return fi},setMode(t){fi=t,typeof window<"u"&&localStorage.setItem("hrmfinance-api-mode",t)},isFakeMode(){return fi==="fake"},isRealMode(){return fi==="real"},isHybridMode(){return fi==="hybrid"}},Fr=async(t,e,r=!0)=>{if(fi==="fake")return e();if(fi==="real")return t();try{return await t()}catch(n){if(console.warn("Real API failed, falling back to fake server:",n),r)return e();throw n}},ed={async getAll(t,e){const r=await Un({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:{businessId:"YB100423253156428",":search0":"produ"}});return Gp(r)},async getById(t){return Fr(async()=>(await this.getAll()).find(r=>r.id===t)||null,()=>kr.products.getById(t))},async create(t){return Fr(async()=>{throw console.log("Creating product via real API:",t),new Error("Real API not implemented yet")},()=>kr.products.create(t))},async update(t,e){return Fr(async()=>{throw console.log("Updating product via real API:",t,e),new Error("Real API not implemented yet")},()=>kr.products.update(t,e))},async delete(t){return Fr(async()=>{throw console.log("Deleting product via real API:",t),new Error("Real API not implemented yet")},()=>kr.products.delete(t))}},jn={async getInventory(t,e){if(!(t&&t?.trim()))return[];let r={businessId:"YB100423253156428"};return t&&t.split(" ").map((o,a)=>{o&&(r[":search"+a]=o.trim())}),await Un({query:"getScanYabaInventory",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async getProducts(t){if(!(t&&t?.trim()))return[];let e={businessId:"YB100423253156428"};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await Un({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async addInventory(t){let r={query:"addYabaInventory",params:{businessId:"YB100423253156428"},form:t};const n=await Un(r);return console.log(r),console.log(n),n},async updInventory(t){return await Yp()}},td={async getAll(t){return Fr(async()=>{throw console.log("Getting accounts via real API:",t),new Error("Real API not implemented yet")},()=>kr.accounts.getAll(t))},async getById(t){return Fr(async()=>{throw console.log("Getting account by ID via real API:",t),new Error("Real API not implemented yet")},()=>kr.accounts.getById(t))},async create(t){return Fr(async()=>{throw console.log("Creating account via real API:",t),new Error("Real API not implemented yet")},()=>kr.accounts.create(t))},async update(t,e){return Fr(async()=>{throw console.log("Updating account via real API:",t,e),new Error("Real API not implemented yet")},()=>kr.accounts.update(t,e))}},rd={async getNextEntryNumber(){return Fr(async()=>{throw console.log("Getting next entry number via real API"),new Error("Real API not implemented yet")},()=>kr.utils.getNextEntryNumber())},async getNextProductCode(t){return Fr(async()=>{throw console.log("Getting next product code via real API:",t),new Error("Real API not implemented yet")},()=>kr.utils.getNextProductCode(t))},async healthCheck(){return Fr(async()=>{const t=await fetch("/api/health");if(!t.ok)throw new Error("Health check failed");return t.json()},()=>kr.utils.healthCheck())},async getStats(){return Fr(async()=>{throw console.log("Getting stats via real API"),new Error("Real API not implemented yet")},()=>kr.utils.getStats())}},Qp=()=>{Yo.setMode("real"),console.log("🚀 HRM Finance initialized in REAL API mode for production")};Qp();const Jp=()=>{};var nd={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dm=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},Xp=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[r++];e[n++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[r++],a=t[r++],c=t[r++],u=((i&7)<<18|(o&63)<<12|(a&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const o=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},Nm={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const o=t[i],a=i+1<t.length,c=a?t[i+1]:0,u=i+2<t.length,h=u?t[i+2]:0,f=o>>2,g=(o&3)<<4|c>>4;let b=(c&15)<<2|h>>6,C=h&63;u||(C=64,a||(b=64)),n.push(r[f],r[g],r[b],r[C])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Dm(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Xp(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const o=r[t.charAt(i++)],c=i<t.length?r[t.charAt(i)]:0;++i;const h=i<t.length?r[t.charAt(i)]:64;++i;const g=i<t.length?r[t.charAt(i)]:64;if(++i,o==null||c==null||h==null||g==null)throw new Zp;const b=o<<2|c>>4;if(n.push(b),h!==64){const C=c<<4&240|h>>2;if(n.push(C),g!==64){const R=h<<6&192|g;n.push(R)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Zp extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ev=function(t){const e=Dm(t);return Nm.encodeByteArray(e,!0)},da=function(t){return ev(t).replace(/\./g,"")},Lm=function(t){try{return Nm.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tv(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rv=()=>tv().__FIREBASE_DEFAULTS__,nv=()=>{if(typeof process>"u"||typeof nd>"u")return;const t=nd.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},iv=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Lm(t[1]);return e&&JSON.parse(e)},Da=()=>{try{return Jp()||rv()||nv()||iv()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Mm=t=>Da()?.emulatorHosts?.[t],ov=t=>{const e=Mm(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Om=()=>Da()?.config,Vm=t=>Da()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function so(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Bm(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function av(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[da(JSON.stringify(r)),da(JSON.stringify(a)),""].join(".")}const Vo={};function lv(){const t={prod:[],emulator:[]};for(const e of Object.keys(Vo))Vo[e]?t.emulator.push(e):t.prod.push(e);return t}function cv(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let id=!1;function Fm(t,e){if(typeof window>"u"||typeof document>"u"||!so(window.location.host)||Vo[t]===e||Vo[t]||id)return;Vo[t]=e;function r(b){return`__firebase__banner__${b}`}const n="__firebase__banner",o=lv().prod.length>0;function a(){const b=document.getElementById(n);b&&b.remove()}function c(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function u(b,C){b.setAttribute("width","24"),b.setAttribute("id",C),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function h(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{id=!0,a()},b}function f(b,C){b.setAttribute("id",C),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function g(){const b=cv(n),C=r("text"),R=document.getElementById(C)||document.createElement("span"),T=r("learnmore"),E=document.getElementById(T)||document.createElement("a"),$=r("preprendIcon"),K=document.getElementById($)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const Z=b.element;c(Z),f(E,T);const J=h();u(K,$),Z.append(K,R,E,J),document.body.appendChild(Z)}o?(R.innerText="Preview backend disconnected.",K.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(K.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,R.innerText="Preview backend running in this workspace."),R.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function uv(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Cr())}function dv(){const t=Da()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function hv(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function mv(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function fv(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function yv(){const t=Cr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function gv(){return!dv()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function pv(){try{return typeof indexedDB=="object"}catch{return!1}}function vv(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bv="FirebaseError";class Tn extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=bv,Object.setPrototypeOf(this,Tn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ss.prototype.create)}}class ss{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?_v(o,n):"Error",c=`${this.serviceName}: ${a} (${i}).`;return new Tn(i,c,n)}}function _v(t,e){return t.replace(Sv,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const Sv=/\{\$([^}]+)}/g;function Pv(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function _i(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const o=t[i],a=e[i];if(od(o)&&od(a)){if(!_i(o,a))return!1}else if(o!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function od(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function as(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function wv(t,e){const r=new Cv(t,e);return r.subscribe.bind(r)}class Cv{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");Av(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=al),i.error===void 0&&(i.error=al),i.complete===void 0&&(i.complete=al);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Av(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function al(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mr(t){return t&&t._delegate?t._delegate:t}class Si{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iv{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new sv;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(xv(e))try{this.getOrInitializeService({instanceIdentifier:hi})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=hi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=hi){return this.instances.has(e)}getOptions(e=hi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(o);n===c&&a.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const o=this.instances.get(n);return o&&e(o,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Ev(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=hi){return this.component?this.component.multipleInstances?e:hi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Ev(t){return t===hi?void 0:t}function xv(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new Iv(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(mt||(mt={}));const $v={debug:mt.DEBUG,verbose:mt.VERBOSE,info:mt.INFO,warn:mt.WARN,error:mt.ERROR,silent:mt.SILENT},kv=mt.INFO,Rv={[mt.DEBUG]:"log",[mt.VERBOSE]:"log",[mt.INFO]:"info",[mt.WARN]:"warn",[mt.ERROR]:"error"},Dv=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=Rv[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ac{constructor(e){this.name=e,this._logLevel=kv,this._logHandler=Dv,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in mt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?$v[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,mt.DEBUG,...e),this._logHandler(this,mt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,mt.VERBOSE,...e),this._logHandler(this,mt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,mt.INFO,...e),this._logHandler(this,mt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,mt.WARN,...e),this._logHandler(this,mt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,mt.ERROR,...e),this._logHandler(this,mt.ERROR,...e)}}const Nv=(t,e)=>e.some(r=>t instanceof r);let sd,ad;function Lv(){return sd||(sd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Mv(){return ad||(ad=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Um=new WeakMap,zl=new WeakMap,jm=new WeakMap,ll=new WeakMap,Ic=new WeakMap;function Ov(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",a)},o=()=>{r(zn(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&Um.set(r,t)}).catch(()=>{}),Ic.set(e,t),e}function Vv(t){if(zl.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",a),t.removeEventListener("abort",a)},o=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",a),t.addEventListener("abort",a)});zl.set(t,e)}let ql={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return zl.get(t);if(e==="objectStoreNames")return t.objectStoreNames||jm.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return zn(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Bv(t){ql=t(ql)}function Fv(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(cl(this),e,...r);return jm.set(n,e.sort?e.sort():[e]),zn(n)}:Mv().includes(t)?function(...e){return t.apply(cl(this),e),zn(Um.get(this))}:function(...e){return zn(t.apply(cl(this),e))}}function Uv(t){return typeof t=="function"?Fv(t):(t instanceof IDBTransaction&&Vv(t),Nv(t,Lv())?new Proxy(t,ql):t)}function zn(t){if(t instanceof IDBRequest)return Ov(t);if(ll.has(t))return ll.get(t);const e=Uv(t);return e!==t&&(ll.set(t,e),Ic.set(e,t)),e}const cl=t=>Ic.get(t);function jv(t,e,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const a=indexedDB.open(t,e),c=zn(a);return n&&a.addEventListener("upgradeneeded",u=>{n(zn(a.result),u.oldVersion,u.newVersion,zn(a.transaction),u)}),r&&a.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),c.then(u=>{o&&u.addEventListener("close",()=>o()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const zv=["get","getKey","getAll","getAllKeys","count"],qv=["put","add","delete","clear"],ul=new Map;function ld(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ul.get(e))return ul.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=qv.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||zv.includes(r)))return;const o=async function(a,...c){const u=this.transaction(a,i?"readwrite":"readonly");let h=u.store;return n&&(h=h.index(c.shift())),(await Promise.all([h[r](...c),i&&u.done]))[0]};return ul.set(e,o),o}Bv(t=>({...t,get:(e,r,n)=>ld(e,r)||t.get(e,r,n),has:(e,r)=>!!ld(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hv{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(Gv(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function Gv(t){return t.getComponent()?.type==="VERSION"}const Hl="@firebase/app",cd="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cn=new Ac("@firebase/app"),Wv="@firebase/app-compat",Yv="@firebase/analytics-compat",Kv="@firebase/analytics",Qv="@firebase/app-check-compat",Jv="@firebase/app-check",Xv="@firebase/auth",Zv="@firebase/auth-compat",eb="@firebase/database",tb="@firebase/data-connect",rb="@firebase/database-compat",nb="@firebase/functions",ib="@firebase/functions-compat",ob="@firebase/installations",sb="@firebase/installations-compat",ab="@firebase/messaging",lb="@firebase/messaging-compat",cb="@firebase/performance",ub="@firebase/performance-compat",db="@firebase/remote-config",hb="@firebase/remote-config-compat",mb="@firebase/storage",fb="@firebase/storage-compat",yb="@firebase/firestore",gb="@firebase/ai",pb="@firebase/firestore-compat",vb="firebase",bb="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gl="[DEFAULT]",_b={[Hl]:"fire-core",[Wv]:"fire-core-compat",[Kv]:"fire-analytics",[Yv]:"fire-analytics-compat",[Jv]:"fire-app-check",[Qv]:"fire-app-check-compat",[Xv]:"fire-auth",[Zv]:"fire-auth-compat",[eb]:"fire-rtdb",[tb]:"fire-data-connect",[rb]:"fire-rtdb-compat",[nb]:"fire-fn",[ib]:"fire-fn-compat",[ob]:"fire-iid",[sb]:"fire-iid-compat",[ab]:"fire-fcm",[lb]:"fire-fcm-compat",[cb]:"fire-perf",[ub]:"fire-perf-compat",[db]:"fire-rc",[hb]:"fire-rc-compat",[mb]:"fire-gcs",[fb]:"fire-gcs-compat",[yb]:"fire-fst",[pb]:"fire-fst-compat",[gb]:"fire-vertex","fire-js":"fire-js",[vb]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ha=new Map,Sb=new Map,Wl=new Map;function ud(t,e){try{t.container.addComponent(e)}catch(r){Cn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Ji(t){const e=t.name;if(Wl.has(e))return Cn.debug(`There were multiple attempts to register component ${e}.`),!1;Wl.set(e,t);for(const r of ha.values())ud(r,t);for(const r of Sb.values())ud(r,t);return!0}function Ec(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Vr(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pb={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},qn=new ss("app","Firebase",Pb);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wb{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Si("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ao=bb;function zm(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Gl,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw qn.create("bad-app-name",{appName:String(i)});if(r||(r=Om()),!r)throw qn.create("no-options");const o=ha.get(i);if(o){if(_i(r,o.options)&&_i(n,o.config))return o;throw qn.create("duplicate-app",{appName:i})}const a=new Tv(i);for(const u of Wl.values())a.addComponent(u);const c=new wb(r,n,a);return ha.set(i,c),c}function qm(t=Gl){const e=ha.get(t);if(!e&&t===Gl&&Om())return zm();if(!e)throw qn.create("no-app",{appName:t});return e}function Hn(t,e,r){let n=_b[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${n}" with version "${e}":`];i&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Cn.warn(a.join(" "));return}Ji(new Si(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cb="firebase-heartbeat-database",Ab=1,Ko="firebase-heartbeat-store";let dl=null;function Hm(){return dl||(dl=jv(Cb,Ab,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ko)}catch(r){console.warn(r)}}}}).catch(t=>{throw qn.create("idb-open",{originalErrorMessage:t.message})})),dl}async function Ib(t){try{const r=(await Hm()).transaction(Ko),n=await r.objectStore(Ko).get(Gm(t));return await r.done,n}catch(e){if(e instanceof Tn)Cn.warn(e.message);else{const r=qn.create("idb-get",{originalErrorMessage:e?.message});Cn.warn(r.message)}}}async function dd(t,e){try{const n=(await Hm()).transaction(Ko,"readwrite");await n.objectStore(Ko).put(e,Gm(t)),await n.done}catch(r){if(r instanceof Tn)Cn.warn(r.message);else{const n=qn.create("idb-set",{originalErrorMessage:r?.message});Cn.warn(n.message)}}}function Gm(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eb=1024,xb=30;class Tb{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new kb(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=hd();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>xb){const i=Rb(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Cn.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=hd(),{heartbeatsToSend:r,unsentEntries:n}=$b(this._heartbeatsCache.heartbeats),i=da(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Cn.warn(e),""}}}function hd(){return new Date().toISOString().substring(0,10)}function $b(t,e=Eb){const r=[];let n=t.slice();for(const i of t){const o=r.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),md(r)>e){o.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),md(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class kb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return pv()?vv().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Ib(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return dd(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return dd(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function md(t){return da(JSON.stringify({version:2,heartbeats:t})).length}function Rb(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Db(t){Ji(new Si("platform-logger",e=>new Hv(e),"PRIVATE")),Ji(new Si("heartbeat",e=>new Tb(e),"PRIVATE")),Hn(Hl,cd,t),Hn(Hl,cd,"esm2020"),Hn("fire-js","")}Db("");function Wm(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Nb=Wm,Ym=new ss("auth","Firebase",Wm());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ma=new Ac("@firebase/auth");function Lb(t,...e){ma.logLevel<=mt.WARN&&ma.warn(`Auth (${ao}): ${t}`,...e)}function Ys(t,...e){ma.logLevel<=mt.ERROR&&ma.error(`Auth (${ao}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dn(t,...e){throw Tc(t,...e)}function Wr(t,...e){return Tc(t,...e)}function xc(t,e,r){const n={...Nb(),[e]:r};return new ss("auth","Firebase",n).create(e,{appName:t.name})}function Gn(t){return xc(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Km(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&dn(t,"argument-error"),xc(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Tc(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return Ym.create(t,...e)}function tt(t,e,...r){if(!t)throw Tc(e,...r)}function bn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ys(e),new Error(e)}function An(t,e){t||bn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yl(){return typeof self<"u"&&self.location?.href||""}function Mb(){return fd()==="http:"||fd()==="https:"}function fd(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ob(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Mb()||mv()||"connection"in navigator)?navigator.onLine:!0}function Vb(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e,r){this.shortDelay=e,this.longDelay=r,An(r>e,"Short delay should be less than long delay!"),this.isMobile=uv()||fv()}get(){return Ob()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $c(t,e){An(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;bn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;bn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;bn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bb={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fb=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Ub=new ls(3e4,6e4);function kc(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function lo(t,e,r,n,i={}){return Jm(t,i,async()=>{let o={},a={};n&&(e==="GET"?a=n:o={body:JSON.stringify(n)});const c=as({key:t.config.apiKey,...a}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const h={method:e,headers:u,...o};return hv()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&so(t.emulatorConfig.host)&&(h.credentials="include"),Qm.fetch()(await Xm(t,t.config.apiHost,r,c),h)})}async function Jm(t,e,r){t._canInitEmulator=!1;const n={...Bb,...e};try{const i=new zb(t),o=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw $s(t,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const c=o.ok?a.errorMessage:a.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw $s(t,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw $s(t,"email-already-in-use",a);if(u==="USER_DISABLED")throw $s(t,"user-disabled",a);const f=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw xc(t,f,h);dn(t,f)}}catch(i){if(i instanceof Tn)throw i;dn(t,"network-request-failed",{message:String(i)})}}async function jb(t,e,r,n,i={}){const o=await lo(t,e,r,n,i);return"mfaPendingCredential"in o&&dn(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function Xm(t,e,r,n){const i=`${e}${r}?${n}`,o=t,a=o.config.emulator?$c(t.config,i):`${t.config.apiScheme}://${i}`;return Fb.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(a).toString():a}class zb{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Wr(this.auth,"network-request-failed")),Ub.get())})}}function $s(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Wr(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qb(t,e){return lo(t,"POST","/v1/accounts:delete",e)}async function fa(t,e){return lo(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bo(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Hb(t,e=!1){const r=mr(t),n=await r.getIdToken(e),i=Rc(n);tt(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:n,authTime:Bo(hl(i.auth_time)),issuedAtTime:Bo(hl(i.iat)),expirationTime:Bo(hl(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}}function hl(t){return Number(t)*1e3}function Rc(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Ys("JWT malformed, contained fewer than 3 sections"),null;try{const i=Lm(r);return i?JSON.parse(i):(Ys("Failed to decode base64 JWT payload"),null)}catch(i){return Ys("Caught error parsing JWT payload as JSON",i?.toString()),null}}function yd(t){const e=Rc(t);return tt(e,"internal-error"),tt(typeof e.exp<"u","internal-error"),tt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qo(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Tn&&Gb(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function Gb({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wb{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Bo(this.lastLoginAt),this.creationTime=Bo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ya(t){const e=t.auth,r=await t.getIdToken(),n=await Qo(t,fa(e,{idToken:r}));tt(n?.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const o=i.providerUserInfo?.length?Zm(i.providerUserInfo):[],a=Kb(t.providerData,o),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!a?.length,h=c?u:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Kl(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(t,f)}async function Yb(t){const e=mr(t);await ya(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Kb(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function Zm(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qb(t,e){const r=await Jm(t,{},async()=>{const n=as({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,a=await Xm(t,i,"/v1/token",`key=${o}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:n};return t.emulatorConfig&&so(t.emulatorConfig.host)&&(u.credentials="include"),Qm.fetch()(a,u)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function Jb(t,e){return lo(t,"POST","/v2/accounts:revokeToken",kc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){tt(e.idToken,"internal-error"),tt(typeof e.idToken<"u","internal-error"),tt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):yd(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){tt(e.length!==0,"internal-error");const r=yd(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(tt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:o}=await Qb(e,r);this.updateTokensAndExpiration(n,i,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:o}=r,a=new Gi;return n&&(tt(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(tt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(tt(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Gi,this.toJSON())}_performRefresh(){return bn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dn(t,e){tt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Gr{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new Wb(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Kl(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Qo(this,this.stsTokenManager.getToken(this.auth,e));return tt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return Hb(this,e)}reload(){return Yb(this)}_assign(e){this!==e&&(tt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Gr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){tt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await ya(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Vr(this.auth.app))return Promise.reject(Gn(this.auth));const e=await this.getIdToken();return await Qo(this,qb(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,o=r.phoneNumber??void 0,a=r.photoURL??void 0,c=r.tenantId??void 0,u=r._redirectEventId??void 0,h=r.createdAt??void 0,f=r.lastLoginAt??void 0,{uid:g,emailVerified:b,isAnonymous:C,providerData:R,stsTokenManager:T}=r;tt(g&&T,e,"internal-error");const E=Gi.fromJSON(this.name,T);tt(typeof g=="string",e,"internal-error"),Dn(n,e.name),Dn(i,e.name),tt(typeof b=="boolean",e,"internal-error"),tt(typeof C=="boolean",e,"internal-error"),Dn(o,e.name),Dn(a,e.name),Dn(c,e.name),Dn(u,e.name),Dn(h,e.name),Dn(f,e.name);const $=new Gr({uid:g,auth:e,email:i,emailVerified:b,displayName:n,isAnonymous:C,photoURL:a,phoneNumber:o,tenantId:c,stsTokenManager:E,createdAt:h,lastLoginAt:f});return R&&Array.isArray(R)&&($.providerData=R.map(K=>({...K}))),u&&($._redirectEventId=u),$}static async _fromIdTokenResponse(e,r,n=!1){const i=new Gi;i.updateFromServerResponse(r);const o=new Gr({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await ya(o),o}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];tt(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?Zm(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!o?.length,c=new Gi;c.updateFromIdToken(n);const u=new Gr({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:a}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Kl(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(u,h),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gd=new Map;function _n(t){An(t instanceof Function,"Expected a class definition");let e=gd.get(t);return e?(An(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,gd.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}ef.type="NONE";const pd=ef;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ks(t,e,r){return`firebase:${t}:${e}:${r}`}class Wi{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:o}=this.auth;this.fullUserKey=Ks(this.userKey,i.apiKey,o),this.fullPersistenceKey=Ks("persistence",i.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await fa(this.auth,{idToken:e}).catch(()=>{});return r?Gr._fromGetAccountInfoResponse(this.auth,r,e):null}return Gr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Wi(_n(pd),e,n);const i=(await Promise.all(r.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let o=i[0]||_n(pd);const a=Ks(n,e.config.apiKey,e.name);let c=null;for(const h of r)try{const f=await h._get(a);if(f){let g;if(typeof f=="string"){const b=await fa(e,{idToken:f}).catch(()=>{});if(!b)break;g=await Gr._fromGetAccountInfoResponse(e,b,f)}else g=Gr._fromJSON(e,f);h!==o&&(c=g),o=h;break}}catch{}const u=i.filter(h=>h._shouldAllowMigration);return!o._shouldAllowMigration||!u.length?new Wi(o,e,n):(o=u[0],c&&await o._set(a,c.toJSON()),await Promise.all(r.map(async h=>{if(h!==o)try{await h._remove(a)}catch{}})),new Wi(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vd(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(of(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(tf(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(af(e))return"Blackberry";if(lf(e))return"Webos";if(rf(e))return"Safari";if((e.includes("chrome/")||nf(e))&&!e.includes("edge/"))return"Chrome";if(sf(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function tf(t=Cr()){return/firefox\//i.test(t)}function rf(t=Cr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function nf(t=Cr()){return/crios\//i.test(t)}function of(t=Cr()){return/iemobile/i.test(t)}function sf(t=Cr()){return/android/i.test(t)}function af(t=Cr()){return/blackberry/i.test(t)}function lf(t=Cr()){return/webos/i.test(t)}function Dc(t=Cr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Xb(t=Cr()){return Dc(t)&&!!window.navigator?.standalone}function Zb(){return yv()&&document.documentMode===10}function cf(t=Cr()){return Dc(t)||sf(t)||lf(t)||af(t)||/windows phone/i.test(t)||of(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uf(t,e=[]){let r;switch(t){case"Browser":r=vd(Cr());break;case"Worker":r=`${vd(Cr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${ao}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e0{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((a,c)=>{try{const u=e(o);a(u)}catch(u){c(u)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t0(t,e={}){return lo(t,"GET","/v2/passwordPolicy",kc(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r0=6;class n0{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??r0,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new bd(this),this.idTokenSubscription=new bd(this),this.beforeStateQueue=new e0(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ym,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=_n(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Wi.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await fa(this,{idToken:e}),n=await Gr._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Vr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,a=n?._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(n=c.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return tt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await ya(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Vb()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Vr(this.app))return Promise.reject(Gn(this));const r=e?mr(e):null;return r&&tt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&tt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Vr(this.app)?Promise.reject(Gn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Vr(this.app)?Promise.reject(Gn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(_n(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await t0(this),r=new n0(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ss("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await Jb(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&_n(e)||this._popupRedirectResolver;tt(r,this,"argument-error"),this.redirectPersistenceManager=await Wi.create(this,[_n(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(tt(c,this,"internal-error"),c.then(()=>{a||o(this.currentUser)}),typeof r=="function"){const u=e.addObserver(r,n,i);return()=>{a=!0,u()}}else{const u=e.addObserver(r);return()=>{a=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return tt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=uf(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(Vr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Lb(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Ii(t){return mr(t)}class bd{constructor(e){this.auth=e,this.observer=null,this.addObserver=wv(r=>this.observer=r)}get next(){return tt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function o0(t){Nc=t}function s0(t){return Nc.loadJS(t)}function a0(){return Nc.gapiScript}function l0(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c0(t,e){const r=Ec(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),o=r.getOptions();if(_i(o,e??{}))return i;dn(i,"already-initialized")}return r.initialize({options:e})}function u0(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(_n);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function d0(t,e,r){const n=Ii(t);tt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,o=df(e),{host:a,port:c}=h0(e),u=c===null?"":`:${c}`,h={url:`${o}//${a}${u}/`},f=Object.freeze({host:a,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){tt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),tt(_i(h,n.config.emulator)&&_i(f,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=f,n.settings.appVerificationDisabledForTesting=!0,so(a)?(Bm(`${o}//${a}${u}`),Fm("Auth",!0)):m0()}function df(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function h0(t){const e=df(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const o=i[1];return{host:o,port:_d(n.substr(o.length+1))}}else{const[o,a]=n.split(":");return{host:o,port:_d(a)}}}function _d(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function m0(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return bn("not implemented")}_getIdTokenResponse(e){return bn("not implemented")}_linkToIdToken(e,r){return bn("not implemented")}_getReauthenticationResolver(e){return bn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yi(t,e){return jb(t,"POST","/v1/accounts:signInWithIdp",kc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f0="http://localhost";class Pi extends hf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Pi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):dn("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...o}=r;if(!n||!i)return null;const a=new Pi(n,i);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return Yi(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Yi(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Yi(e,r)}buildRequest(){const e={requestUri:f0,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=as(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs extends Na{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On extends cs{constructor(){super("facebook.com")}static credential(e){return Pi._fromParams({providerId:On.PROVIDER_ID,signInMethod:On.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return On.credentialFromTaggedObject(e)}static credentialFromError(e){return On.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return On.credential(e.oauthAccessToken)}catch{return null}}}On.FACEBOOK_SIGN_IN_METHOD="facebook.com";On.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn extends cs{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Pi._fromParams({providerId:nn.PROVIDER_ID,signInMethod:nn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return nn.credentialFromTaggedObject(e)}static credentialFromError(e){return nn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return nn.credential(r,n)}catch{return null}}}nn.GOOGLE_SIGN_IN_METHOD="google.com";nn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn extends cs{constructor(){super("github.com")}static credential(e){return Pi._fromParams({providerId:Vn.PROVIDER_ID,signInMethod:Vn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Vn.credentialFromTaggedObject(e)}static credentialFromError(e){return Vn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Vn.credential(e.oauthAccessToken)}catch{return null}}}Vn.GITHUB_SIGN_IN_METHOD="github.com";Vn.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn extends cs{constructor(){super("twitter.com")}static credential(e,r){return Pi._fromParams({providerId:Bn.PROVIDER_ID,signInMethod:Bn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Bn.credentialFromTaggedObject(e)}static credentialFromError(e){return Bn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Bn.credential(r,n)}catch{return null}}}Bn.TWITTER_SIGN_IN_METHOD="twitter.com";Bn.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const o=await Gr._fromIdTokenResponse(e,n,i),a=Sd(n);return new Xi({user:o,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=Sd(n);return new Xi({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function Sd(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga extends Tn{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,ga.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new ga(e,r,n,i)}}function mf(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?ga._fromErrorAndOperation(t,o,e,n):o})}async function y0(t,e,r=!1){const n=await Qo(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Xi._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g0(t,e,r=!1){const{auth:n}=t;if(Vr(n.app))return Promise.reject(Gn(n));const i="reauthenticate";try{const o=await Qo(t,mf(n,i,e,t),r);tt(o.idToken,n,"internal-error");const a=Rc(o.idToken);tt(a,n,"internal-error");const{sub:c}=a;return tt(t.uid===c,n,"user-mismatch"),Xi._forOperation(t,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&dn(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ff(t,e,r=!1){if(Vr(t.app))return Promise.reject(Gn(t));const n="signIn",i=await mf(t,n,e),o=await Xi._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(o.user),o}async function p0(t,e){return ff(Ii(t),e)}function v0(t,e,r,n){return mr(t).onIdTokenChanged(e,r,n)}function b0(t,e,r){return mr(t).beforeAuthStateChanged(e,r)}function _0(t,e,r,n){return mr(t).onAuthStateChanged(e,r,n)}function S0(t){return mr(t).signOut()}const pa="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(pa,"1"),this.storage.removeItem(pa),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P0=1e3,w0=10;class gf extends yf{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=cf(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,c,u)=>{this.notifyListeners(a,u)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},o=this.storage.getItem(n);Zb()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,w0):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},P0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}gf.type="LOCAL";const C0=gf;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf extends yf{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}pf.type="SESSION";const vf=pf;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A0(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new La(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:o}=r.data,a=this.handlersMap[i];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const c=Array.from(a).map(async h=>h(r.origin,o)),u=await A0(c);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:u})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}La.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lc(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,a;return new Promise((c,u)=>{const h=Lc("",20);i.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(g){const b=g;if(b.data.eventId===h)switch(b.data.status){case"ack":clearTimeout(f),o=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),c(b.data.response);break;default:clearTimeout(f),clearTimeout(o),u(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function on(){return window}function E0(t){on().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bf(){return typeof on().WorkerGlobalScope<"u"&&typeof on().importScripts=="function"}async function x0(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function T0(){return navigator?.serviceWorker?.controller||null}function $0(){return bf()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _f="firebaseLocalStorageDb",k0=1,va="firebaseLocalStorage",Sf="fbase_key";class us{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Ma(t,e){return t.transaction([va],e?"readwrite":"readonly").objectStore(va)}function R0(){const t=indexedDB.deleteDatabase(_f);return new us(t).toPromise()}function Ql(){const t=indexedDB.open(_f,k0);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(va,{keyPath:Sf})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(va)?e(n):(n.close(),await R0(),e(await Ql()))})})}async function Pd(t,e,r){const n=Ma(t,!0).put({[Sf]:e,value:r});return new us(n).toPromise()}async function D0(t,e){const r=Ma(t,!1).get(e),n=await new us(r).toPromise();return n===void 0?null:n.value}function wd(t,e){const r=Ma(t,!0).delete(e);return new us(r).toPromise()}const N0=800,L0=3;class Pf{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ql(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>L0)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return bf()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=La._getInstance($0()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await x0(),!this.activeServiceWorker)return;this.sender=new I0(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||T0()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ql();return await Pd(e,pa,"1"),await wd(e,pa),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>Pd(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>D0(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>wd(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=Ma(i,!1).getAll();return new us(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),N0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Pf.type="LOCAL";const M0=Pf;new ls(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mc(t,e){return e?_n(e):(tt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oc extends hf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Yi(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Yi(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Yi(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function O0(t){return ff(t.auth,new Oc(t),t.bypassAuthState)}function V0(t){const{auth:e,user:r}=t;return tt(r,e,"internal-error"),g0(r,new Oc(t),t.bypassAuthState)}async function B0(t){const{auth:e,user:r}=t;return tt(r,e,"internal-error"),y0(r,new Oc(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{constructor(e,r,n,i,o=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:o,error:a,type:c}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return O0;case"linkViaPopup":case"linkViaRedirect":return B0;case"reauthViaPopup":case"reauthViaRedirect":return V0;default:dn(this.auth,"internal-error")}}resolve(e){An(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){An(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F0=new ls(2e3,1e4);async function U0(t,e,r){if(Vr(t.app))return Promise.reject(Wr(t,"operation-not-supported-in-this-environment"));const n=Ii(t);Km(t,e,Na);const i=Mc(n,r);return new gi(n,"signInViaPopup",e,i).executeNotNull()}class gi extends wf{constructor(e,r,n,i,o){super(e,r,i,o),this.provider=n,this.authWindow=null,this.pollId=null,gi.currentPopupAction&&gi.currentPopupAction.cancel(),gi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return tt(e,this.auth,"internal-error"),e}async onExecution(){An(this.filter.length===1,"Popup operations only handle one event");const e=Lc();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Wr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Wr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,gi.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Wr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,F0.get())};e()}}gi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j0="pendingRedirect",Qs=new Map;class z0 extends wf{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Qs.get(this.auth._key());if(!e){try{const n=await q0(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Qs.set(this.auth._key(),e)}return this.bypassAuthState||Qs.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function q0(t,e){const r=Af(e),n=Cf(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}async function H0(t,e){return Cf(t)._set(Af(e),"true")}function G0(t,e){Qs.set(t._key(),e)}function Cf(t){return _n(t._redirectPersistence)}function Af(t){return Ks(j0,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W0(t,e,r){return Y0(t,e,r)}async function Y0(t,e,r){if(Vr(t.app))return Promise.reject(Gn(t));const n=Ii(t);Km(t,e,Na),await n._initializationPromise;const i=Mc(n,r);return await H0(i,n),i._openRedirect(n,e,"signInViaRedirect")}async function K0(t,e){return await Ii(t)._initializationPromise,If(t,e,!1)}async function If(t,e,r=!1){if(Vr(t.app))return Promise.reject(Gn(t));const n=Ii(t),i=Mc(n,e),a=await new z0(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q0=10*60*1e3;class J0{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!X0(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!Ef(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Wr(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Q0&&this.cachedEventUids.clear(),this.cachedEventUids.has(Cd(e))}saveEventToCache(e){this.cachedEventUids.add(Cd(e)),this.lastProcessedEventTime=Date.now()}}function Cd(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Ef({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function X0(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ef(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z0(t,e={}){return lo(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e_=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,t_=/^https?/;async function r_(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Z0(t);for(const r of e)try{if(n_(r))return}catch{}dn(t,"unauthorized-domain")}function n_(t){const e=Yl(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!t_.test(r))return!1;if(e_.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i_=new ls(3e4,6e4);function Ad(){const t=on().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function o_(t){return new Promise((e,r)=>{function n(){Ad(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Ad(),r(Wr(t,"network-request-failed"))},timeout:i_.get()})}if(on().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(on().gapi?.load)n();else{const i=l0("iframefcb");return on()[i]=()=>{gapi.load?n():r(Wr(t,"network-request-failed"))},s0(`${a0()}?onload=${i}`).catch(o=>r(o))}}).catch(e=>{throw Js=null,e})}let Js=null;function s_(t){return Js=Js||o_(t),Js}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a_=new ls(5e3,15e3),l_="__/auth/iframe",c_="emulator/auth/iframe",u_={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},d_=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function h_(t){const e=t.config;tt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?$c(e,c_):`https://${t.config.authDomain}/${l_}`,n={apiKey:e.apiKey,appName:t.name,v:ao},i=d_.get(t.config.apiHost);i&&(n.eid=i);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${as(n).slice(1)}`}async function m_(t){const e=await s_(t),r=on().gapi;return tt(r,t,"internal-error"),e.open({where:document.body,url:h_(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:u_,dontclear:!0},n=>new Promise(async(i,o)=>{await n.restyle({setHideOnLeave:!1});const a=Wr(t,"network-request-failed"),c=on().setTimeout(()=>{o(a)},a_.get());function u(){on().clearTimeout(c),i(n)}n.ping(u).then(u,()=>{o(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f_={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},y_=500,g_=600,p_="_blank",v_="http://localhost";class Id{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function b_(t,e,r,n=y_,i=g_){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const u={...f_,width:n.toString(),height:i.toString(),top:o,left:a},h=Cr().toLowerCase();r&&(c=nf(h)?p_:r),tf(h)&&(e=e||v_,u.scrollbars="yes");const f=Object.entries(u).reduce((b,[C,R])=>`${b}${C}=${R},`,"");if(Xb(h)&&c!=="_self")return __(e||"",c),new Id(null);const g=window.open(e||"",c,f);tt(g,t,"popup-blocked");try{g.focus()}catch{}return new Id(g)}function __(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S_="__/auth/handler",P_="emulator/auth/handler",w_=encodeURIComponent("fac");async function Ed(t,e,r,n,i,o){tt(t.config.authDomain,t,"auth-domain-config-required"),tt(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:ao,eventId:i};if(e instanceof Na){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",Pv(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,g]of Object.entries({}))a[f]=g}if(e instanceof cs){const f=e.getScopes().filter(g=>g!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const c=a;for(const f of Object.keys(c))c[f]===void 0&&delete c[f];const u=await t._getAppCheckToken(),h=u?`#${w_}=${encodeURIComponent(u)}`:"";return`${C_(t)}?${as(c).slice(1)}${h}`}function C_({config:t}){return t.emulator?$c(t,P_):`https://${t.authDomain}/${S_}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ml="webStorageSupport";class A_{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vf,this._completeRedirectFn=If,this._overrideRedirectResult=G0}async _openPopup(e,r,n,i){An(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await Ed(e,r,n,Yl(),i);return b_(e,o,Lc())}async _openRedirect(e,r,n,i){await this._originValidation(e);const o=await Ed(e,r,n,Yl(),i);return E0(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:o}=this.eventManagers[r];return i?Promise.resolve(i):(An(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await m_(e),n=new J0(e);return r.register("authEvent",i=>(tt(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(ml,{type:ml},i=>{const o=i?.[0]?.[ml];o!==void 0&&r(!!o),dn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=r_(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return cf()||rf()||Dc()}}const I_=A_;var xd="@firebase/auth",Td="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E_{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){tt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x_(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function T_(t){Ji(new Si("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=n.options;tt(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:a,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:uf(t)},h=new i0(n,i,o,u);return u0(h,r),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Ji(new Si("auth-internal",e=>{const r=Ii(e.getProvider("auth").getImmediate());return(n=>new E_(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Hn(xd,Td,x_(t)),Hn(xd,Td,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $_=5*60,k_=Vm("authIdTokenMaxAge")||$_;let $d=null;const R_=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>k_)return;const i=r?.token;$d!==i&&($d=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function D_(t=qm()){const e=Ec(t,"auth");if(e.isInitialized())return e.getImmediate();const r=c0(t,{popupRedirectResolver:I_,persistence:[M0,C0,vf]}),n=Vm("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const a=R_(o.toString());b0(r,a,()=>a(r.currentUser)),v0(r,c=>a(c))}}const i=Mm("auth");return i&&d0(r,`http://${i}`),r}function N_(){return document.getElementsByTagName("head")?.[0]??document}o0({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const o=Wr("internal-error");o.customData=i,r(o)},n.type="text/javascript",n.charset="UTF-8",N_().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});T_("Browser");var L_="firebase",M_="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Hn(L_,M_,"app");var kd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Wn,xf;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,S){function v(){}v.prototype=S.prototype,I.D=S.prototype,I.prototype=new v,I.prototype.constructor=I,I.C=function(w,P,A){for(var y=Array(arguments.length-2),se=2;se<arguments.length;se++)y[se-2]=arguments[se];return S.prototype[P].apply(w,y)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,S,v){v||(v=0);var w=Array(16);if(typeof S=="string")for(var P=0;16>P;++P)w[P]=S.charCodeAt(v++)|S.charCodeAt(v++)<<8|S.charCodeAt(v++)<<16|S.charCodeAt(v++)<<24;else for(P=0;16>P;++P)w[P]=S[v++]|S[v++]<<8|S[v++]<<16|S[v++]<<24;S=I.g[0],v=I.g[1],P=I.g[2];var A=I.g[3],y=S+(A^v&(P^A))+w[0]+3614090360&4294967295;S=v+(y<<7&4294967295|y>>>25),y=A+(P^S&(v^P))+w[1]+3905402710&4294967295,A=S+(y<<12&4294967295|y>>>20),y=P+(v^A&(S^v))+w[2]+606105819&4294967295,P=A+(y<<17&4294967295|y>>>15),y=v+(S^P&(A^S))+w[3]+3250441966&4294967295,v=P+(y<<22&4294967295|y>>>10),y=S+(A^v&(P^A))+w[4]+4118548399&4294967295,S=v+(y<<7&4294967295|y>>>25),y=A+(P^S&(v^P))+w[5]+1200080426&4294967295,A=S+(y<<12&4294967295|y>>>20),y=P+(v^A&(S^v))+w[6]+2821735955&4294967295,P=A+(y<<17&4294967295|y>>>15),y=v+(S^P&(A^S))+w[7]+4249261313&4294967295,v=P+(y<<22&4294967295|y>>>10),y=S+(A^v&(P^A))+w[8]+1770035416&4294967295,S=v+(y<<7&4294967295|y>>>25),y=A+(P^S&(v^P))+w[9]+2336552879&4294967295,A=S+(y<<12&4294967295|y>>>20),y=P+(v^A&(S^v))+w[10]+4294925233&4294967295,P=A+(y<<17&4294967295|y>>>15),y=v+(S^P&(A^S))+w[11]+2304563134&4294967295,v=P+(y<<22&4294967295|y>>>10),y=S+(A^v&(P^A))+w[12]+1804603682&4294967295,S=v+(y<<7&4294967295|y>>>25),y=A+(P^S&(v^P))+w[13]+4254626195&4294967295,A=S+(y<<12&4294967295|y>>>20),y=P+(v^A&(S^v))+w[14]+2792965006&4294967295,P=A+(y<<17&4294967295|y>>>15),y=v+(S^P&(A^S))+w[15]+1236535329&4294967295,v=P+(y<<22&4294967295|y>>>10),y=S+(P^A&(v^P))+w[1]+4129170786&4294967295,S=v+(y<<5&4294967295|y>>>27),y=A+(v^P&(S^v))+w[6]+3225465664&4294967295,A=S+(y<<9&4294967295|y>>>23),y=P+(S^v&(A^S))+w[11]+643717713&4294967295,P=A+(y<<14&4294967295|y>>>18),y=v+(A^S&(P^A))+w[0]+3921069994&4294967295,v=P+(y<<20&4294967295|y>>>12),y=S+(P^A&(v^P))+w[5]+3593408605&4294967295,S=v+(y<<5&4294967295|y>>>27),y=A+(v^P&(S^v))+w[10]+38016083&4294967295,A=S+(y<<9&4294967295|y>>>23),y=P+(S^v&(A^S))+w[15]+3634488961&4294967295,P=A+(y<<14&4294967295|y>>>18),y=v+(A^S&(P^A))+w[4]+3889429448&4294967295,v=P+(y<<20&4294967295|y>>>12),y=S+(P^A&(v^P))+w[9]+568446438&4294967295,S=v+(y<<5&4294967295|y>>>27),y=A+(v^P&(S^v))+w[14]+3275163606&4294967295,A=S+(y<<9&4294967295|y>>>23),y=P+(S^v&(A^S))+w[3]+4107603335&4294967295,P=A+(y<<14&4294967295|y>>>18),y=v+(A^S&(P^A))+w[8]+1163531501&4294967295,v=P+(y<<20&4294967295|y>>>12),y=S+(P^A&(v^P))+w[13]+2850285829&4294967295,S=v+(y<<5&4294967295|y>>>27),y=A+(v^P&(S^v))+w[2]+4243563512&4294967295,A=S+(y<<9&4294967295|y>>>23),y=P+(S^v&(A^S))+w[7]+1735328473&4294967295,P=A+(y<<14&4294967295|y>>>18),y=v+(A^S&(P^A))+w[12]+2368359562&4294967295,v=P+(y<<20&4294967295|y>>>12),y=S+(v^P^A)+w[5]+4294588738&4294967295,S=v+(y<<4&4294967295|y>>>28),y=A+(S^v^P)+w[8]+2272392833&4294967295,A=S+(y<<11&4294967295|y>>>21),y=P+(A^S^v)+w[11]+1839030562&4294967295,P=A+(y<<16&4294967295|y>>>16),y=v+(P^A^S)+w[14]+4259657740&4294967295,v=P+(y<<23&4294967295|y>>>9),y=S+(v^P^A)+w[1]+2763975236&4294967295,S=v+(y<<4&4294967295|y>>>28),y=A+(S^v^P)+w[4]+1272893353&4294967295,A=S+(y<<11&4294967295|y>>>21),y=P+(A^S^v)+w[7]+4139469664&4294967295,P=A+(y<<16&4294967295|y>>>16),y=v+(P^A^S)+w[10]+3200236656&4294967295,v=P+(y<<23&4294967295|y>>>9),y=S+(v^P^A)+w[13]+681279174&4294967295,S=v+(y<<4&4294967295|y>>>28),y=A+(S^v^P)+w[0]+3936430074&4294967295,A=S+(y<<11&4294967295|y>>>21),y=P+(A^S^v)+w[3]+3572445317&4294967295,P=A+(y<<16&4294967295|y>>>16),y=v+(P^A^S)+w[6]+76029189&4294967295,v=P+(y<<23&4294967295|y>>>9),y=S+(v^P^A)+w[9]+3654602809&4294967295,S=v+(y<<4&4294967295|y>>>28),y=A+(S^v^P)+w[12]+3873151461&4294967295,A=S+(y<<11&4294967295|y>>>21),y=P+(A^S^v)+w[15]+530742520&4294967295,P=A+(y<<16&4294967295|y>>>16),y=v+(P^A^S)+w[2]+3299628645&4294967295,v=P+(y<<23&4294967295|y>>>9),y=S+(P^(v|~A))+w[0]+4096336452&4294967295,S=v+(y<<6&4294967295|y>>>26),y=A+(v^(S|~P))+w[7]+1126891415&4294967295,A=S+(y<<10&4294967295|y>>>22),y=P+(S^(A|~v))+w[14]+2878612391&4294967295,P=A+(y<<15&4294967295|y>>>17),y=v+(A^(P|~S))+w[5]+4237533241&4294967295,v=P+(y<<21&4294967295|y>>>11),y=S+(P^(v|~A))+w[12]+1700485571&4294967295,S=v+(y<<6&4294967295|y>>>26),y=A+(v^(S|~P))+w[3]+2399980690&4294967295,A=S+(y<<10&4294967295|y>>>22),y=P+(S^(A|~v))+w[10]+4293915773&4294967295,P=A+(y<<15&4294967295|y>>>17),y=v+(A^(P|~S))+w[1]+2240044497&4294967295,v=P+(y<<21&4294967295|y>>>11),y=S+(P^(v|~A))+w[8]+1873313359&4294967295,S=v+(y<<6&4294967295|y>>>26),y=A+(v^(S|~P))+w[15]+4264355552&4294967295,A=S+(y<<10&4294967295|y>>>22),y=P+(S^(A|~v))+w[6]+2734768916&4294967295,P=A+(y<<15&4294967295|y>>>17),y=v+(A^(P|~S))+w[13]+1309151649&4294967295,v=P+(y<<21&4294967295|y>>>11),y=S+(P^(v|~A))+w[4]+4149444226&4294967295,S=v+(y<<6&4294967295|y>>>26),y=A+(v^(S|~P))+w[11]+3174756917&4294967295,A=S+(y<<10&4294967295|y>>>22),y=P+(S^(A|~v))+w[2]+718787259&4294967295,P=A+(y<<15&4294967295|y>>>17),y=v+(A^(P|~S))+w[9]+3951481745&4294967295,I.g[0]=I.g[0]+S&4294967295,I.g[1]=I.g[1]+(P+(y<<21&4294967295|y>>>11))&4294967295,I.g[2]=I.g[2]+P&4294967295,I.g[3]=I.g[3]+A&4294967295}n.prototype.u=function(I,S){S===void 0&&(S=I.length);for(var v=S-this.blockSize,w=this.B,P=this.h,A=0;A<S;){if(P==0)for(;A<=v;)i(this,I,A),A+=this.blockSize;if(typeof I=="string"){for(;A<S;)if(w[P++]=I.charCodeAt(A++),P==this.blockSize){i(this,w),P=0;break}}else for(;A<S;)if(w[P++]=I[A++],P==this.blockSize){i(this,w),P=0;break}}this.h=P,this.o+=S},n.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var S=1;S<I.length-8;++S)I[S]=0;var v=8*this.o;for(S=I.length-8;S<I.length;++S)I[S]=v&255,v/=256;for(this.u(I),I=Array(16),S=v=0;4>S;++S)for(var w=0;32>w;w+=8)I[v++]=this.g[S]>>>w&255;return I};function o(I,S){var v=c;return Object.prototype.hasOwnProperty.call(v,I)?v[I]:v[I]=S(I)}function a(I,S){this.h=S;for(var v=[],w=!0,P=I.length-1;0<=P;P--){var A=I[P]|0;w&&A==S||(v[P]=A,w=!1)}this.g=v}var c={};function u(I){return-128<=I&&128>I?o(I,function(S){return new a([S|0],0>S?-1:0)}):new a([I|0],0>I?-1:0)}function h(I){if(isNaN(I)||!isFinite(I))return g;if(0>I)return E(h(-I));for(var S=[],v=1,w=0;I>=v;w++)S[w]=I/v|0,v*=4294967296;return new a(S,0)}function f(I,S){if(I.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(I.charAt(0)=="-")return E(f(I.substring(1),S));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=h(Math.pow(S,8)),w=g,P=0;P<I.length;P+=8){var A=Math.min(8,I.length-P),y=parseInt(I.substring(P,P+A),S);8>A?(A=h(Math.pow(S,A)),w=w.j(A).add(h(y))):(w=w.j(v),w=w.add(h(y)))}return w}var g=u(0),b=u(1),C=u(16777216);t=a.prototype,t.m=function(){if(T(this))return-E(this).m();for(var I=0,S=1,v=0;v<this.g.length;v++){var w=this.i(v);I+=(0<=w?w:4294967296+w)*S,S*=4294967296}return I},t.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(R(this))return"0";if(T(this))return"-"+E(this).toString(I);for(var S=h(Math.pow(I,6)),v=this,w="";;){var P=J(v,S).g;v=$(v,P.j(S));var A=((0<v.g.length?v.g[0]:v.h)>>>0).toString(I);if(v=P,R(v))return A+w;for(;6>A.length;)A="0"+A;w=A+w}},t.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function R(I){if(I.h!=0)return!1;for(var S=0;S<I.g.length;S++)if(I.g[S]!=0)return!1;return!0}function T(I){return I.h==-1}t.l=function(I){return I=$(this,I),T(I)?-1:R(I)?0:1};function E(I){for(var S=I.g.length,v=[],w=0;w<S;w++)v[w]=~I.g[w];return new a(v,~I.h).add(b)}t.abs=function(){return T(this)?E(this):this},t.add=function(I){for(var S=Math.max(this.g.length,I.g.length),v=[],w=0,P=0;P<=S;P++){var A=w+(this.i(P)&65535)+(I.i(P)&65535),y=(A>>>16)+(this.i(P)>>>16)+(I.i(P)>>>16);w=y>>>16,A&=65535,y&=65535,v[P]=y<<16|A}return new a(v,v[v.length-1]&-2147483648?-1:0)};function $(I,S){return I.add(E(S))}t.j=function(I){if(R(this)||R(I))return g;if(T(this))return T(I)?E(this).j(E(I)):E(E(this).j(I));if(T(I))return E(this.j(E(I)));if(0>this.l(C)&&0>I.l(C))return h(this.m()*I.m());for(var S=this.g.length+I.g.length,v=[],w=0;w<2*S;w++)v[w]=0;for(w=0;w<this.g.length;w++)for(var P=0;P<I.g.length;P++){var A=this.i(w)>>>16,y=this.i(w)&65535,se=I.i(P)>>>16,W=I.i(P)&65535;v[2*w+2*P]+=y*W,K(v,2*w+2*P),v[2*w+2*P+1]+=A*W,K(v,2*w+2*P+1),v[2*w+2*P+1]+=y*se,K(v,2*w+2*P+1),v[2*w+2*P+2]+=A*se,K(v,2*w+2*P+2)}for(w=0;w<S;w++)v[w]=v[2*w+1]<<16|v[2*w];for(w=S;w<2*S;w++)v[w]=0;return new a(v,0)};function K(I,S){for(;(I[S]&65535)!=I[S];)I[S+1]+=I[S]>>>16,I[S]&=65535,S++}function Z(I,S){this.g=I,this.h=S}function J(I,S){if(R(S))throw Error("division by zero");if(R(I))return new Z(g,g);if(T(I))return S=J(E(I),S),new Z(E(S.g),E(S.h));if(T(S))return S=J(I,E(S)),new Z(E(S.g),S.h);if(30<I.g.length){if(T(I)||T(S))throw Error("slowDivide_ only works with positive integers.");for(var v=b,w=S;0>=w.l(I);)v=de(v),w=de(w);var P=re(v,1),A=re(w,1);for(w=re(w,2),v=re(v,2);!R(w);){var y=A.add(w);0>=y.l(I)&&(P=P.add(v),A=y),w=re(w,1),v=re(v,1)}return S=$(I,P.j(S)),new Z(P,S)}for(P=g;0<=I.l(S);){for(v=Math.max(1,Math.floor(I.m()/S.m())),w=Math.ceil(Math.log(v)/Math.LN2),w=48>=w?1:Math.pow(2,w-48),A=h(v),y=A.j(S);T(y)||0<y.l(I);)v-=w,A=h(v),y=A.j(S);R(A)&&(A=b),P=P.add(A),I=$(I,y)}return new Z(P,I)}t.A=function(I){return J(this,I).h},t.and=function(I){for(var S=Math.max(this.g.length,I.g.length),v=[],w=0;w<S;w++)v[w]=this.i(w)&I.i(w);return new a(v,this.h&I.h)},t.or=function(I){for(var S=Math.max(this.g.length,I.g.length),v=[],w=0;w<S;w++)v[w]=this.i(w)|I.i(w);return new a(v,this.h|I.h)},t.xor=function(I){for(var S=Math.max(this.g.length,I.g.length),v=[],w=0;w<S;w++)v[w]=this.i(w)^I.i(w);return new a(v,this.h^I.h)};function de(I){for(var S=I.g.length+1,v=[],w=0;w<S;w++)v[w]=I.i(w)<<1|I.i(w-1)>>>31;return new a(v,I.h)}function re(I,S){var v=S>>5;S%=32;for(var w=I.g.length-v,P=[],A=0;A<w;A++)P[A]=0<S?I.i(A+v)>>>S|I.i(A+v+1)<<32-S:I.i(A+v);return new a(P,I.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,xf=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=f,Wn=a}).apply(typeof kd<"u"?kd:typeof self<"u"?self:typeof window<"u"?window:{});var ks=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Tf,ko,$f,Xs,Jl,kf,Rf,Df;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,m,p){return l==Array.prototype||l==Object.prototype||(l[m]=p.value),l};function r(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof ks=="object"&&ks];for(var m=0;m<l.length;++m){var p=l[m];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var n=r(this);function i(l,m){if(m)e:{var p=n;l=l.split(".");for(var L=0;L<l.length-1;L++){var _e=l[L];if(!(_e in p))break e;p=p[_e]}l=l[l.length-1],L=p[l],m=m(L),m!=L&&m!=null&&e(p,l,{configurable:!0,writable:!0,value:m})}}function o(l,m){l instanceof String&&(l+="");var p=0,L=!1,_e={next:function(){if(!L&&p<l.length){var Ce=p++;return{value:m(Ce,l[Ce]),done:!1}}return L=!0,{done:!0,value:void 0}}};return _e[Symbol.iterator]=function(){return _e},_e}i("Array.prototype.values",function(l){return l||function(){return o(this,function(m,p){return p})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},c=this||self;function u(l){var m=typeof l;return m=m!="object"?m:l?Array.isArray(l)?"array":m:"null",m=="array"||m=="object"&&typeof l.length=="number"}function h(l){var m=typeof l;return m=="object"&&l!=null||m=="function"}function f(l,m,p){return l.call.apply(l.bind,arguments)}function g(l,m,p){if(!l)throw Error();if(2<arguments.length){var L=Array.prototype.slice.call(arguments,2);return function(){var _e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(_e,L),l.apply(m,_e)}}return function(){return l.apply(m,arguments)}}function b(l,m,p){return b=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:g,b.apply(null,arguments)}function C(l,m){var p=Array.prototype.slice.call(arguments,1);return function(){var L=p.slice();return L.push.apply(L,arguments),l.apply(this,L)}}function R(l,m){function p(){}p.prototype=m.prototype,l.aa=m.prototype,l.prototype=new p,l.prototype.constructor=l,l.Qb=function(L,_e,Ce){for(var Ne=Array(arguments.length-2),Lt=2;Lt<arguments.length;Lt++)Ne[Lt-2]=arguments[Lt];return m.prototype[_e].apply(L,Ne)}}function T(l){const m=l.length;if(0<m){const p=Array(m);for(let L=0;L<m;L++)p[L]=l[L];return p}return[]}function E(l,m){for(let p=1;p<arguments.length;p++){const L=arguments[p];if(u(L)){const _e=l.length||0,Ce=L.length||0;l.length=_e+Ce;for(let Ne=0;Ne<Ce;Ne++)l[_e+Ne]=L[Ne]}else l.push(L)}}class ${constructor(m,p){this.i=m,this.j=p,this.h=0,this.g=null}get(){let m;return 0<this.h?(this.h--,m=this.g,this.g=m.next,m.next=null):m=this.i(),m}}function K(l){return/^[\s\xa0]*$/.test(l)}function Z(){var l=c.navigator;return l&&(l=l.userAgent)?l:""}function J(l){return J[" "](l),l}J[" "]=function(){};var de=Z().indexOf("Gecko")!=-1&&!(Z().toLowerCase().indexOf("webkit")!=-1&&Z().indexOf("Edge")==-1)&&!(Z().indexOf("Trident")!=-1||Z().indexOf("MSIE")!=-1)&&Z().indexOf("Edge")==-1;function re(l,m,p){for(const L in l)m.call(p,l[L],L,l)}function I(l,m){for(const p in l)m.call(void 0,l[p],p,l)}function S(l){const m={};for(const p in l)m[p]=l[p];return m}const v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(l,m){let p,L;for(let _e=1;_e<arguments.length;_e++){L=arguments[_e];for(p in L)l[p]=L[p];for(let Ce=0;Ce<v.length;Ce++)p=v[Ce],Object.prototype.hasOwnProperty.call(L,p)&&(l[p]=L[p])}}function P(l){var m=1;l=l.split(":");const p=[];for(;0<m&&l.length;)p.push(l.shift()),m--;return l.length&&p.push(l.join(":")),p}function A(l){c.setTimeout(()=>{throw l},0)}function y(){var l=O;let m=null;return l.g&&(m=l.g,l.g=l.g.next,l.g||(l.h=null),m.next=null),m}class se{constructor(){this.h=this.g=null}add(m,p){const L=W.get();L.set(m,p),this.h?this.h.next=L:this.g=L,this.h=L}}var W=new $(()=>new k,l=>l.reset());class k{constructor(){this.next=this.g=this.h=null}set(m,p){this.h=m,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let H,V=!1,O=new se,D=()=>{const l=c.Promise.resolve(void 0);H=()=>{l.then(M)}};var M=()=>{for(var l;l=y();){try{l.h.call(l.g)}catch(p){A(p)}var m=W;m.j(l),100>m.h&&(m.h++,l.next=m.g,m.g=l)}V=!1};function he(){this.s=this.s,this.C=this.C}he.prototype.s=!1,he.prototype.ma=function(){this.s||(this.s=!0,this.N())},he.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function z(l,m){this.type=l,this.g=this.target=m,this.defaultPrevented=!1}z.prototype.h=function(){this.defaultPrevented=!0};var pe=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var l=!1,m=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const p=()=>{};c.addEventListener("test",p,m),c.removeEventListener("test",p,m)}catch{}return l}();function x(l,m){if(z.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var p=this.type=l.type,L=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=m,m=l.relatedTarget){if(de){e:{try{J(m.nodeName);var _e=!0;break e}catch{}_e=!1}_e||(m=null)}}else p=="mouseover"?m=l.fromElement:p=="mouseout"&&(m=l.toElement);this.relatedTarget=m,L?(this.clientX=L.clientX!==void 0?L.clientX:L.pageX,this.clientY=L.clientY!==void 0?L.clientY:L.pageY,this.screenX=L.screenX||0,this.screenY=L.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:F[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&x.aa.h.call(this)}}R(x,z);var F={2:"touch",3:"pen",4:"mouse"};x.prototype.h=function(){x.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var ee="closure_listenable_"+(1e6*Math.random()|0),Q=0;function ue(l,m,p,L,_e){this.listener=l,this.proxy=null,this.src=m,this.type=p,this.capture=!!L,this.ha=_e,this.key=++Q,this.da=this.fa=!1}function te(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function B(l){this.src=l,this.g={},this.h=0}B.prototype.add=function(l,m,p,L,_e){var Ce=l.toString();l=this.g[Ce],l||(l=this.g[Ce]=[],this.h++);var Ne=ve(l,m,L,_e);return-1<Ne?(m=l[Ne],p||(m.fa=!1)):(m=new ue(m,this.src,Ce,!!L,_e),m.fa=p,l.push(m)),m};function ae(l,m){var p=m.type;if(p in l.g){var L=l.g[p],_e=Array.prototype.indexOf.call(L,m,void 0),Ce;(Ce=0<=_e)&&Array.prototype.splice.call(L,_e,1),Ce&&(te(m),l.g[p].length==0&&(delete l.g[p],l.h--))}}function ve(l,m,p,L){for(var _e=0;_e<l.length;++_e){var Ce=l[_e];if(!Ce.da&&Ce.listener==m&&Ce.capture==!!p&&Ce.ha==L)return _e}return-1}var be="closure_lm_"+(1e6*Math.random()|0),oe={};function ce(l,m,p,L,_e){if(Array.isArray(m)){for(var Ce=0;Ce<m.length;Ce++)ce(l,m[Ce],p,L,_e);return null}return p=we(p),l&&l[ee]?l.K(m,p,h(L)?!!L.capture:!1,_e):Y(l,m,p,!1,L,_e)}function Y(l,m,p,L,_e,Ce){if(!m)throw Error("Invalid event type");var Ne=h(_e)?!!_e.capture:!!_e,Lt=j(l);if(Lt||(l[be]=Lt=new B(l)),p=Lt.add(m,p,L,Ne,Ce),p.proxy)return p;if(L=q(),p.proxy=L,L.src=l,L.listener=p,l.addEventListener)pe||(_e=Ne),_e===void 0&&(_e=!1),l.addEventListener(m.toString(),L,_e);else if(l.attachEvent)l.attachEvent(fe(m.toString()),L);else if(l.addListener&&l.removeListener)l.addListener(L);else throw Error("addEventListener and attachEvent are unavailable.");return p}function q(){function l(p){return m.call(l.src,l.listener,p)}const m=U;return l}function N(l,m,p,L,_e){if(Array.isArray(m))for(var Ce=0;Ce<m.length;Ce++)N(l,m[Ce],p,L,_e);else L=h(L)?!!L.capture:!!L,p=we(p),l&&l[ee]?(l=l.i,m=String(m).toString(),m in l.g&&(Ce=l.g[m],p=ve(Ce,p,L,_e),-1<p&&(te(Ce[p]),Array.prototype.splice.call(Ce,p,1),Ce.length==0&&(delete l.g[m],l.h--)))):l&&(l=j(l))&&(m=l.g[m.toString()],l=-1,m&&(l=ve(m,p,L,_e)),(p=-1<l?m[l]:null)&&ne(p))}function ne(l){if(typeof l!="number"&&l&&!l.da){var m=l.src;if(m&&m[ee])ae(m.i,l);else{var p=l.type,L=l.proxy;m.removeEventListener?m.removeEventListener(p,L,l.capture):m.detachEvent?m.detachEvent(fe(p),L):m.addListener&&m.removeListener&&m.removeListener(L),(p=j(m))?(ae(p,l),p.h==0&&(p.src=null,m[be]=null)):te(l)}}}function fe(l){return l in oe?oe[l]:oe[l]="on"+l}function U(l,m){if(l.da)l=!0;else{m=new x(m,this);var p=l.listener,L=l.ha||l.src;l.fa&&ne(l),l=p.call(L,m)}return l}function j(l){return l=l[be],l instanceof B?l:null}var Se="__closure_events_fn_"+(1e9*Math.random()>>>0);function we(l){return typeof l=="function"?l:(l[Se]||(l[Se]=function(m){return l.handleEvent(m)}),l[Se])}function le(){he.call(this),this.i=new B(this),this.M=this,this.F=null}R(le,he),le.prototype[ee]=!0,le.prototype.removeEventListener=function(l,m,p,L){N(this,l,m,p,L)};function ye(l,m){var p,L=l.F;if(L)for(p=[];L;L=L.F)p.push(L);if(l=l.M,L=m.type||m,typeof m=="string")m=new z(m,l);else if(m instanceof z)m.target=m.target||l;else{var _e=m;m=new z(L,l),w(m,_e)}if(_e=!0,p)for(var Ce=p.length-1;0<=Ce;Ce--){var Ne=m.g=p[Ce];_e=X(Ne,L,!0,m)&&_e}if(Ne=m.g=l,_e=X(Ne,L,!0,m)&&_e,_e=X(Ne,L,!1,m)&&_e,p)for(Ce=0;Ce<p.length;Ce++)Ne=m.g=p[Ce],_e=X(Ne,L,!1,m)&&_e}le.prototype.N=function(){if(le.aa.N.call(this),this.i){var l=this.i,m;for(m in l.g){for(var p=l.g[m],L=0;L<p.length;L++)te(p[L]);delete l.g[m],l.h--}}this.F=null},le.prototype.K=function(l,m,p,L){return this.i.add(String(l),m,!1,p,L)},le.prototype.L=function(l,m,p,L){return this.i.add(String(l),m,!0,p,L)};function X(l,m,p,L){if(m=l.i.g[String(m)],!m)return!0;m=m.concat();for(var _e=!0,Ce=0;Ce<m.length;++Ce){var Ne=m[Ce];if(Ne&&!Ne.da&&Ne.capture==p){var Lt=Ne.listener,cr=Ne.ha||Ne.src;Ne.fa&&ae(l.i,Ne),_e=Lt.call(cr,L)!==!1&&_e}}return _e&&!L.defaultPrevented}function Pe(l,m,p){if(typeof l=="function")p&&(l=b(l,p));else if(l&&typeof l.handleEvent=="function")l=b(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(m)?-1:c.setTimeout(l,m||0)}function ke(l){l.g=Pe(()=>{l.g=null,l.i&&(l.i=!1,ke(l))},l.l);const m=l.h;l.h=null,l.m.apply(null,m)}class Te extends he{constructor(m,p){super(),this.m=m,this.l=p,this.h=null,this.i=!1,this.g=null}j(m){this.h=arguments,this.g?this.i=!0:ke(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $e(l){he.call(this),this.h=l,this.g={}}R($e,he);var Ue=[];function Ye(l){re(l.g,function(m,p){this.g.hasOwnProperty(p)&&ne(m)},l),l.g={}}$e.prototype.N=function(){$e.aa.N.call(this),Ye(this)},$e.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ze=c.JSON.stringify,Ee=c.JSON.parse,Me=class{stringify(l){return c.JSON.stringify(l,void 0)}parse(l){return c.JSON.parse(l,void 0)}};function Ke(){}Ke.prototype.h=null;function Ge(l){return l.h||(l.h=l.i())}function He(){}var Ae={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function st(){z.call(this,"d")}R(st,z);function Xe(){z.call(this,"c")}R(Xe,z);var gt={},dt=null;function Ft(){return dt=dt||new le}gt.La="serverreachability";function Ht(l){z.call(this,gt.La,l)}R(Ht,z);function $t(l){const m=Ft();ye(m,new Ht(m))}gt.STAT_EVENT="statevent";function Ot(l,m){z.call(this,gt.STAT_EVENT,l),this.stat=m}R(Ot,z);function bt(l){const m=Ft();ye(m,new Ot(m,l))}gt.Ma="timingevent";function Jt(l,m){z.call(this,gt.Ma,l),this.size=m}R(Jt,z);function St(l,m){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){l()},m)}function ir(){this.g=!0}ir.prototype.xa=function(){this.g=!1};function Oe(l,m,p,L,_e,Ce){l.info(function(){if(l.g)if(Ce)for(var Ne="",Lt=Ce.split("&"),cr=0;cr<Lt.length;cr++){var Pt=Lt[cr].split("=");if(1<Pt.length){var pr=Pt[0];Pt=Pt[1];var vr=pr.split("_");Ne=2<=vr.length&&vr[1]=="type"?Ne+(pr+"="+Pt+"&"):Ne+(pr+"=redacted&")}}else Ne=null;else Ne=Ce;return"XMLHTTP REQ ("+L+") [attempt "+_e+"]: "+m+`
`+p+`
`+Ne})}function Ve(l,m,p,L,_e,Ce,Ne){l.info(function(){return"XMLHTTP RESP ("+L+") [ attempt "+_e+"]: "+m+`
`+p+`
`+Ce+" "+Ne})}function Je(l,m,p,L){l.info(function(){return"XMLHTTP TEXT ("+m+"): "+kt(l,p)+(L?" "+L:"")})}function nt(l,m){l.info(function(){return"TIMEOUT: "+m})}ir.prototype.info=function(){};function kt(l,m){if(!l.g)return m;if(!m)return null;try{var p=JSON.parse(m);if(p){for(l=0;l<p.length;l++)if(Array.isArray(p[l])){var L=p[l];if(!(2>L.length)){var _e=L[1];if(Array.isArray(_e)&&!(1>_e.length)){var Ce=_e[0];if(Ce!="noop"&&Ce!="stop"&&Ce!="close")for(var Ne=1;Ne<_e.length;Ne++)_e[Ne]=""}}}}return ze(p)}catch{return m}}var Ze={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ht={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},pt;function Ct(){}R(Ct,Ke),Ct.prototype.g=function(){return new XMLHttpRequest},Ct.prototype.i=function(){return{}},pt=new Ct;function ct(l,m,p,L){this.j=l,this.i=m,this.l=p,this.R=L||1,this.U=new $e(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Nr}function Nr(){this.i=null,this.g="",this.h=!1}var Vt={},Ut={};function Yt(l,m,p){l.L=1,l.v=Ri(Ar(m)),l.m=p,l.P=!0,Rt(l,null)}function Rt(l,m){l.F=Date.now(),qt(l),l.A=Ar(l.v);var p=l.A,L=l.R;Array.isArray(L)||(L=[String(L)]),Iu(p.i,"t",L),l.C=0,p=l.j.J,l.h=new Nr,l.g=qu(l.j,p?m:null,!l.m),0<l.O&&(l.M=new Te(b(l.Y,l,l.g),l.O)),m=l.U,p=l.g,L=l.ca;var _e="readystatechange";Array.isArray(_e)||(_e&&(Ue[0]=_e.toString()),_e=Ue);for(var Ce=0;Ce<_e.length;Ce++){var Ne=ce(p,_e[Ce],L||m.handleEvent,!1,m.h||m);if(!Ne)break;m.g[Ne.key]=Ne}m=l.H?S(l.H):{},l.m?(l.u||(l.u="POST"),m["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,m)):(l.u="GET",l.g.ea(l.A,l.u,null,m)),$t(),Oe(l.i,l.u,l.A,l.l,l.R,l.m)}ct.prototype.ca=function(l){l=l.target;const m=this.M;m&&yn(l)==3?m.j():this.Y(l)},ct.prototype.Y=function(l){try{if(l==this.g)e:{const vr=yn(this.g);var m=this.g.Ba();const Li=this.g.Z();if(!(3>vr)&&(vr!=3||this.g&&(this.h.h||this.g.oa()||Du(this.g)))){this.J||vr!=4||m==7||(m==8||0>=Li?$t(3):$t(2)),Lr(this);var p=this.g.Z();this.X=p;t:if(Xt(this)){var L=Du(this.g);l="";var _e=L.length,Ce=yn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Mr(this),mn(this);var Ne="";break t}this.h.i=new c.TextDecoder}for(m=0;m<_e;m++)this.h.h=!0,l+=this.h.i.decode(L[m],{stream:!(Ce&&m==_e-1)});L.length=0,this.h.g+=l,this.C=0,Ne=this.h.g}else Ne=this.g.oa();if(this.o=p==200,Ve(this.i,this.u,this.A,this.l,this.R,vr,p),this.o){if(this.T&&!this.K){t:{if(this.g){var Lt,cr=this.g;if((Lt=cr.g?cr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(Lt)){var Pt=Lt;break t}}Pt=null}if(p=Pt)Je(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,si(this,p);else{this.o=!1,this.s=3,bt(12),Mr(this),mn(this);break e}}if(this.P){p=!0;let qr;for(;!this.J&&this.C<Ne.length;)if(qr=jr(this,Ne),qr==Ut){vr==4&&(this.s=4,bt(14),p=!1),Je(this.i,this.l,null,"[Incomplete Response]");break}else if(qr==Vt){this.s=4,bt(15),Je(this.i,this.l,Ne,"[Invalid Chunk]"),p=!1;break}else Je(this.i,this.l,qr,null),si(this,qr);if(Xt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),vr!=4||Ne.length!=0||this.h.h||(this.s=1,bt(16),p=!1),this.o=this.o&&p,!p)Je(this.i,this.l,Ne,"[Invalid Chunked Response]"),Mr(this),mn(this);else if(0<Ne.length&&!this.W){this.W=!0;var pr=this.j;pr.g==this&&pr.ba&&!pr.M&&(pr.j.info("Great, no buffering proxy detected. Bytes received: "+Ne.length),tl(pr),pr.M=!0,bt(11))}}else Je(this.i,this.l,Ne,null),si(this,Ne);vr==4&&Mr(this),this.o&&!this.J&&(vr==4?Fu(this.j,this):(this.o=!1,qt(this)))}else Tg(this.g),p==400&&0<Ne.indexOf("Unknown SID")?(this.s=3,bt(12)):(this.s=0,bt(13)),Mr(this),mn(this)}}}catch{}finally{}};function Xt(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function jr(l,m){var p=l.C,L=m.indexOf(`
`,p);return L==-1?Ut:(p=Number(m.substring(p,L)),isNaN(p)?Vt:(L+=1,L+p>m.length?Ut:(m=m.slice(L,L+p),l.C=L+p,m)))}ct.prototype.cancel=function(){this.J=!0,Mr(this)};function qt(l){l.S=Date.now()+l.I,lr(l,l.I)}function lr(l,m){if(l.B!=null)throw Error("WatchDog timer not null");l.B=St(b(l.ba,l),m)}function Lr(l){l.B&&(c.clearTimeout(l.B),l.B=null)}ct.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(nt(this.i,this.A),this.L!=2&&($t(),bt(17)),Mr(this),this.s=2,mn(this)):lr(this,this.S-l)};function mn(l){l.j.G==0||l.J||Fu(l.j,l)}function Mr(l){Lr(l);var m=l.M;m&&typeof m.ma=="function"&&m.ma(),l.M=null,Ye(l.U),l.g&&(m=l.g,l.g=null,m.abort(),m.ma())}function si(l,m){try{var p=l.j;if(p.G!=0&&(p.g==l||ki(p.h,l))){if(!l.K&&ki(p.h,l)&&p.G==3){try{var L=p.Da.g.parse(m)}catch{L=null}if(Array.isArray(L)&&L.length==3){var _e=L;if(_e[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<l.F)Is(p),Cs(p);else break e;el(p),bt(18)}}else p.za=_e[1],0<p.za-p.T&&37500>_e[2]&&p.F&&p.v==0&&!p.C&&(p.C=St(b(p.Za,p),6e3));if(1>=go(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else ai(p,11)}else if((l.K||p.g==l)&&Is(p),!K(m))for(_e=p.Da.g.parse(m),m=0;m<_e.length;m++){let Pt=_e[m];if(p.T=Pt[0],Pt=Pt[1],p.G==2)if(Pt[0]=="c"){p.K=Pt[1],p.ia=Pt[2];const pr=Pt[3];pr!=null&&(p.la=pr,p.j.info("VER="+p.la));const vr=Pt[4];vr!=null&&(p.Aa=vr,p.j.info("SVER="+p.Aa));const Li=Pt[5];Li!=null&&typeof Li=="number"&&0<Li&&(L=1.5*Li,p.L=L,p.j.info("backChannelRequestTimeoutMs_="+L)),L=p;const qr=l.g;if(qr){const xs=qr.g?qr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(xs){var Ce=L.h;Ce.g||xs.indexOf("spdy")==-1&&xs.indexOf("quic")==-1&&xs.indexOf("h2")==-1||(Ce.j=Ce.l,Ce.g=new Set,Ce.h&&($n(Ce,Ce.h),Ce.h=null))}if(L.D){const rl=qr.g?qr.g.getResponseHeader("X-HTTP-Session-Id"):null;rl&&(L.ya=rl,Nt(L.I,L.D,rl))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-l.F,p.j.info("Handshake RTT: "+p.R+"ms")),L=p;var Ne=l;if(L.qa=zu(L,L.J?L.ia:null,L.W),Ne.K){bs(L.h,Ne);var Lt=Ne,cr=L.L;cr&&(Lt.I=cr),Lt.B&&(Lr(Lt),qt(Lt)),L.g=Ne}else Vu(L);0<p.i.length&&As(p)}else Pt[0]!="stop"&&Pt[0]!="close"||ai(p,7);else p.G==3&&(Pt[0]=="stop"||Pt[0]=="close"?Pt[0]=="stop"?ai(p,7):Za(p):Pt[0]!="noop"&&p.l&&p.l.ta(Pt),p.v=0)}}$t(4)}catch{}}var $i=class{constructor(l,m){this.g=l,this.map=m}};function vs(l){this.l=l||10,c.PerformanceNavigationTiming?(l=c.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function yo(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function go(l){return l.h?1:l.g?l.g.size:0}function ki(l,m){return l.h?l.h==m:l.g?l.g.has(m):!1}function $n(l,m){l.g?l.g.add(m):l.h=m}function bs(l,m){l.h&&l.h==m?l.h=null:l.g&&l.g.has(m)&&l.g.delete(m)}vs.prototype.cancel=function(){if(this.i=po(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function po(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let m=l.i;for(const p of l.g.values())m=m.concat(p.D);return m}return T(l.i)}function at(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var m=[],p=l.length,L=0;L<p;L++)m.push(l[L]);return m}m=[],p=0;for(L in l)m[p++]=l[L];return m}function Dt(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var m=[];l=l.length;for(var p=0;p<l;p++)m.push(p);return m}m=[],p=0;for(const L in l)m[p++]=L;return m}}}function gr(l,m){if(l.forEach&&typeof l.forEach=="function")l.forEach(m,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,m,void 0);else for(var p=Dt(l),L=at(l),_e=L.length,Ce=0;Ce<_e;Ce++)m.call(void 0,L[Ce],p&&p[Ce],l)}var zr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function fn(l,m){if(l){l=l.split("&");for(var p=0;p<l.length;p++){var L=l[p].indexOf("="),_e=null;if(0<=L){var Ce=l[p].substring(0,L);_e=l[p].substring(L+1)}else Ce=l[p];m(Ce,_e?decodeURIComponent(_e.replace(/\+/g," ")):"")}}}function jt(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof jt){this.h=l.h,Jr(this,l.j),this.o=l.o,this.g=l.g,Xr(this,l.s),this.l=l.l;var m=l.i,p=new _o;p.i=m.i,m.g&&(p.g=new Map(m.g),p.h=m.h),_s(this,p),this.m=l.m}else l&&(m=String(l).match(zr))?(this.h=!1,Jr(this,m[1]||"",!0),this.o=vo(m[2]||""),this.g=vo(m[3]||"",!0),Xr(this,m[4]),this.l=vo(m[5]||"",!0),_s(this,m[6]||"",!0),this.m=vo(m[7]||"")):(this.h=!1,this.i=new _o(null,this.h))}jt.prototype.toString=function(){var l=[],m=this.j;m&&l.push(bo(m,wu,!0),":");var p=this.g;return(p||m=="file")&&(l.push("//"),(m=this.o)&&l.push(bo(m,wu,!0),"@"),l.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&l.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(bo(p,p.charAt(0)=="/"?bg:vg,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",bo(p,Sg)),l.join("")};function Ar(l){return new jt(l)}function Jr(l,m,p){l.j=p?vo(m,!0):m,l.j&&(l.j=l.j.replace(/:$/,""))}function Xr(l,m){if(m){if(m=Number(m),isNaN(m)||0>m)throw Error("Bad port number "+m);l.s=m}else l.s=null}function _s(l,m,p){m instanceof _o?(l.i=m,Pg(l.i,l.h)):(p||(m=bo(m,_g)),l.i=new _o(m,l.h))}function Nt(l,m,p){l.i.set(m,p)}function Ri(l){return Nt(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function vo(l,m){return l?m?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function bo(l,m,p){return typeof l=="string"?(l=encodeURI(l).replace(m,pg),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function pg(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var wu=/[#\/\?@]/g,vg=/[#\?:]/g,bg=/[#\?]/g,_g=/[#\?@]/g,Sg=/#/g;function _o(l,m){this.h=this.g=null,this.i=l||null,this.j=!!m}function kn(l){l.g||(l.g=new Map,l.h=0,l.i&&fn(l.i,function(m,p){l.add(decodeURIComponent(m.replace(/\+/g," ")),p)}))}t=_o.prototype,t.add=function(l,m){kn(this),this.i=null,l=Di(this,l);var p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(m),this.h+=1,this};function Cu(l,m){kn(l),m=Di(l,m),l.g.has(m)&&(l.i=null,l.h-=l.g.get(m).length,l.g.delete(m))}function Au(l,m){return kn(l),m=Di(l,m),l.g.has(m)}t.forEach=function(l,m){kn(this),this.g.forEach(function(p,L){p.forEach(function(_e){l.call(m,_e,L,this)},this)},this)},t.na=function(){kn(this);const l=Array.from(this.g.values()),m=Array.from(this.g.keys()),p=[];for(let L=0;L<m.length;L++){const _e=l[L];for(let Ce=0;Ce<_e.length;Ce++)p.push(m[L])}return p},t.V=function(l){kn(this);let m=[];if(typeof l=="string")Au(this,l)&&(m=m.concat(this.g.get(Di(this,l))));else{l=Array.from(this.g.values());for(let p=0;p<l.length;p++)m=m.concat(l[p])}return m},t.set=function(l,m){return kn(this),this.i=null,l=Di(this,l),Au(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[m]),this.h+=1,this},t.get=function(l,m){return l?(l=this.V(l),0<l.length?String(l[0]):m):m};function Iu(l,m,p){Cu(l,m),0<p.length&&(l.i=null,l.g.set(Di(l,m),T(p)),l.h+=p.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],m=Array.from(this.g.keys());for(var p=0;p<m.length;p++){var L=m[p];const Ce=encodeURIComponent(String(L)),Ne=this.V(L);for(L=0;L<Ne.length;L++){var _e=Ce;Ne[L]!==""&&(_e+="="+encodeURIComponent(String(Ne[L]))),l.push(_e)}}return this.i=l.join("&")};function Di(l,m){return m=String(m),l.j&&(m=m.toLowerCase()),m}function Pg(l,m){m&&!l.j&&(kn(l),l.i=null,l.g.forEach(function(p,L){var _e=L.toLowerCase();L!=_e&&(Cu(this,L),Iu(this,_e,p))},l)),l.j=m}function wg(l,m){const p=new ir;if(c.Image){const L=new Image;L.onload=C(Rn,p,"TestLoadImage: loaded",!0,m,L),L.onerror=C(Rn,p,"TestLoadImage: error",!1,m,L),L.onabort=C(Rn,p,"TestLoadImage: abort",!1,m,L),L.ontimeout=C(Rn,p,"TestLoadImage: timeout",!1,m,L),c.setTimeout(function(){L.ontimeout&&L.ontimeout()},1e4),L.src=l}else m(!1)}function Cg(l,m){const p=new ir,L=new AbortController,_e=setTimeout(()=>{L.abort(),Rn(p,"TestPingServer: timeout",!1,m)},1e4);fetch(l,{signal:L.signal}).then(Ce=>{clearTimeout(_e),Ce.ok?Rn(p,"TestPingServer: ok",!0,m):Rn(p,"TestPingServer: server error",!1,m)}).catch(()=>{clearTimeout(_e),Rn(p,"TestPingServer: error",!1,m)})}function Rn(l,m,p,L,_e){try{_e&&(_e.onload=null,_e.onerror=null,_e.onabort=null,_e.ontimeout=null),L(p)}catch{}}function Ag(){this.g=new Me}function Ig(l,m,p){const L=p||"";try{gr(l,function(_e,Ce){let Ne=_e;h(_e)&&(Ne=ze(_e)),m.push(L+Ce+"="+encodeURIComponent(Ne))})}catch(_e){throw m.push(L+"type="+encodeURIComponent("_badmap")),_e}}function Ss(l){this.l=l.Ub||null,this.j=l.eb||!1}R(Ss,Ke),Ss.prototype.g=function(){return new Ps(this.l,this.j)},Ss.prototype.i=function(l){return function(){return l}}({});function Ps(l,m){le.call(this),this.D=l,this.o=m,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(Ps,le),t=Ps.prototype,t.open=function(l,m){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=m,this.readyState=1,Po(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const m={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(m.body=l),(this.D||c).fetch(new Request(this.A,m)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,So(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Po(this)),this.g&&(this.readyState=3,Po(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Eu(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function Eu(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var m=l.value?l.value:new Uint8Array(0);(m=this.v.decode(m,{stream:!l.done}))&&(this.response=this.responseText+=m)}l.done?So(this):Po(this),this.readyState==3&&Eu(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,So(this))},t.Qa=function(l){this.g&&(this.response=l,So(this))},t.ga=function(){this.g&&So(this)};function So(l){l.readyState=4,l.l=null,l.j=null,l.v=null,Po(l)}t.setRequestHeader=function(l,m){this.u.append(l,m)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],m=this.h.entries();for(var p=m.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=m.next();return l.join(`\r
`)};function Po(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Ps.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function xu(l){let m="";return re(l,function(p,L){m+=L,m+=":",m+=p,m+=`\r
`}),m}function Xa(l,m,p){e:{for(L in p){var L=!1;break e}L=!0}L||(p=xu(p),typeof l=="string"?p!=null&&encodeURIComponent(String(p)):Nt(l,m,p))}function Wt(l){le.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(Wt,le);var Eg=/^https?$/i,xg=["POST","PUT"];t=Wt.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,m,p,L){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);m=m?m.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():pt.g(),this.v=this.o?Ge(this.o):Ge(pt),this.g.onreadystatechange=b(this.Ea,this);try{this.B=!0,this.g.open(m,String(l),!0),this.B=!1}catch(Ce){Tu(this,Ce);return}if(l=p||"",p=new Map(this.headers),L)if(Object.getPrototypeOf(L)===Object.prototype)for(var _e in L)p.set(_e,L[_e]);else if(typeof L.keys=="function"&&typeof L.get=="function")for(const Ce of L.keys())p.set(Ce,L.get(Ce));else throw Error("Unknown input type for opt_headers: "+String(L));L=Array.from(p.keys()).find(Ce=>Ce.toLowerCase()=="content-type"),_e=c.FormData&&l instanceof c.FormData,!(0<=Array.prototype.indexOf.call(xg,m,void 0))||L||_e||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ce,Ne]of p)this.g.setRequestHeader(Ce,Ne);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ru(this),this.u=!0,this.g.send(l),this.u=!1}catch(Ce){Tu(this,Ce)}};function Tu(l,m){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=m,l.m=5,$u(l),ws(l)}function $u(l){l.A||(l.A=!0,ye(l,"complete"),ye(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,ye(this,"complete"),ye(this,"abort"),ws(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ws(this,!0)),Wt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?ku(this):this.bb())},t.bb=function(){ku(this)};function ku(l){if(l.h&&typeof a<"u"&&(!l.v[1]||yn(l)!=4||l.Z()!=2)){if(l.u&&yn(l)==4)Pe(l.Ea,0,l);else if(ye(l,"readystatechange"),yn(l)==4){l.h=!1;try{const Ne=l.Z();e:switch(Ne){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var m=!0;break e;default:m=!1}var p;if(!(p=m)){var L;if(L=Ne===0){var _e=String(l.D).match(zr)[1]||null;!_e&&c.self&&c.self.location&&(_e=c.self.location.protocol.slice(0,-1)),L=!Eg.test(_e?_e.toLowerCase():"")}p=L}if(p)ye(l,"complete"),ye(l,"success");else{l.m=6;try{var Ce=2<yn(l)?l.g.statusText:""}catch{Ce=""}l.l=Ce+" ["+l.Z()+"]",$u(l)}}finally{ws(l)}}}}function ws(l,m){if(l.g){Ru(l);const p=l.g,L=l.v[0]?()=>{}:null;l.g=null,l.v=null,m||ye(l,"ready");try{p.onreadystatechange=L}catch{}}}function Ru(l){l.I&&(c.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function yn(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<yn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var m=this.g.responseText;return l&&m.indexOf(l)==0&&(m=m.substring(l.length)),Ee(m)}};function Du(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function Tg(l){const m={};l=(l.g&&2<=yn(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let L=0;L<l.length;L++){if(K(l[L]))continue;var p=P(l[L]);const _e=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const Ce=m[_e]||[];m[_e]=Ce,Ce.push(p)}I(m,function(L){return L.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function wo(l,m,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||m}function Nu(l){this.Aa=0,this.i=[],this.j=new ir,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=wo("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=wo("baseRetryDelayMs",5e3,l),this.cb=wo("retryDelaySeedMs",1e4,l),this.Wa=wo("forwardChannelMaxRetries",2,l),this.wa=wo("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new vs(l&&l.concurrentRequestLimit),this.Da=new Ag,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Nu.prototype,t.la=8,t.G=1,t.connect=function(l,m,p,L){bt(0),this.W=l,this.H=m||{},p&&L!==void 0&&(this.H.OSID=p,this.H.OAID=L),this.F=this.X,this.I=zu(this,null,this.W),As(this)};function Za(l){if(Lu(l),l.G==3){var m=l.U++,p=Ar(l.I);if(Nt(p,"SID",l.K),Nt(p,"RID",m),Nt(p,"TYPE","terminate"),Co(l,p),m=new ct(l,l.j,m),m.L=2,m.v=Ri(Ar(p)),p=!1,c.navigator&&c.navigator.sendBeacon)try{p=c.navigator.sendBeacon(m.v.toString(),"")}catch{}!p&&c.Image&&(new Image().src=m.v,p=!0),p||(m.g=qu(m.j,null),m.g.ea(m.v)),m.F=Date.now(),qt(m)}ju(l)}function Cs(l){l.g&&(tl(l),l.g.cancel(),l.g=null)}function Lu(l){Cs(l),l.u&&(c.clearTimeout(l.u),l.u=null),Is(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&c.clearTimeout(l.s),l.s=null)}function As(l){if(!yo(l.h)&&!l.s){l.s=!0;var m=l.Ga;H||D(),V||(H(),V=!0),O.add(m,l),l.B=0}}function $g(l,m){return go(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=m.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=St(b(l.Ga,l,m),Uu(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const _e=new ct(this,this.j,l);let Ce=this.o;if(this.S&&(Ce?(Ce=S(Ce),w(Ce,this.S)):Ce=this.S),this.m!==null||this.O||(_e.H=Ce,Ce=null),this.P)e:{for(var m=0,p=0;p<this.i.length;p++){t:{var L=this.i[p];if("__data__"in L.map&&(L=L.map.__data__,typeof L=="string")){L=L.length;break t}L=void 0}if(L===void 0)break;if(m+=L,4096<m){m=p;break e}if(m===4096||p===this.i.length-1){m=p+1;break e}}m=1e3}else m=1e3;m=Ou(this,_e,m),p=Ar(this.I),Nt(p,"RID",l),Nt(p,"CVER",22),this.D&&Nt(p,"X-HTTP-Session-Id",this.D),Co(this,p),Ce&&(this.O?m="headers="+encodeURIComponent(String(xu(Ce)))+"&"+m:this.m&&Xa(p,this.m,Ce)),$n(this.h,_e),this.Ua&&Nt(p,"TYPE","init"),this.P?(Nt(p,"$req",m),Nt(p,"SID","null"),_e.T=!0,Yt(_e,p,null)):Yt(_e,p,m),this.G=2}}else this.G==3&&(l?Mu(this,l):this.i.length==0||yo(this.h)||Mu(this))};function Mu(l,m){var p;m?p=m.l:p=l.U++;const L=Ar(l.I);Nt(L,"SID",l.K),Nt(L,"RID",p),Nt(L,"AID",l.T),Co(l,L),l.m&&l.o&&Xa(L,l.m,l.o),p=new ct(l,l.j,p,l.B+1),l.m===null&&(p.H=l.o),m&&(l.i=m.D.concat(l.i)),m=Ou(l,p,1e3),p.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),$n(l.h,p),Yt(p,L,m)}function Co(l,m){l.H&&re(l.H,function(p,L){Nt(m,L,p)}),l.l&&gr({},function(p,L){Nt(m,L,p)})}function Ou(l,m,p){p=Math.min(l.i.length,p);var L=l.l?b(l.l.Na,l.l,l):null;e:{var _e=l.i;let Ce=-1;for(;;){const Ne=["count="+p];Ce==-1?0<p?(Ce=_e[0].g,Ne.push("ofs="+Ce)):Ce=0:Ne.push("ofs="+Ce);let Lt=!0;for(let cr=0;cr<p;cr++){let Pt=_e[cr].g;const pr=_e[cr].map;if(Pt-=Ce,0>Pt)Ce=Math.max(0,_e[cr].g-100),Lt=!1;else try{Ig(pr,Ne,"req"+Pt+"_")}catch{L&&L(pr)}}if(Lt){L=Ne.join("&");break e}}}return l=l.i.splice(0,p),m.D=l,L}function Vu(l){if(!l.g&&!l.u){l.Y=1;var m=l.Fa;H||D(),V||(H(),V=!0),O.add(m,l),l.v=0}}function el(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=St(b(l.Fa,l),Uu(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Bu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=St(b(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,bt(10),Cs(this),Bu(this))};function tl(l){l.A!=null&&(c.clearTimeout(l.A),l.A=null)}function Bu(l){l.g=new ct(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var m=Ar(l.qa);Nt(m,"RID","rpc"),Nt(m,"SID",l.K),Nt(m,"AID",l.T),Nt(m,"CI",l.F?"0":"1"),!l.F&&l.ja&&Nt(m,"TO",l.ja),Nt(m,"TYPE","xmlhttp"),Co(l,m),l.m&&l.o&&Xa(m,l.m,l.o),l.L&&(l.g.I=l.L);var p=l.g;l=l.ia,p.L=1,p.v=Ri(Ar(m)),p.m=null,p.P=!0,Rt(p,l)}t.Za=function(){this.C!=null&&(this.C=null,Cs(this),el(this),bt(19))};function Is(l){l.C!=null&&(c.clearTimeout(l.C),l.C=null)}function Fu(l,m){var p=null;if(l.g==m){Is(l),tl(l),l.g=null;var L=2}else if(ki(l.h,m))p=m.D,bs(l.h,m),L=1;else return;if(l.G!=0){if(m.o)if(L==1){p=m.m?m.m.length:0,m=Date.now()-m.F;var _e=l.B;L=Ft(),ye(L,new Jt(L,p)),As(l)}else Vu(l);else if(_e=m.s,_e==3||_e==0&&0<m.X||!(L==1&&$g(l,m)||L==2&&el(l)))switch(p&&0<p.length&&(m=l.h,m.i=m.i.concat(p)),_e){case 1:ai(l,5);break;case 4:ai(l,10);break;case 3:ai(l,6);break;default:ai(l,2)}}}function Uu(l,m){let p=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(p*=2),p*m}function ai(l,m){if(l.j.info("Error code "+m),m==2){var p=b(l.fb,l),L=l.Xa;const _e=!L;L=new jt(L||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Jr(L,"https"),Ri(L),_e?wg(L.toString(),p):Cg(L.toString(),p)}else bt(2);l.G=0,l.l&&l.l.sa(m),ju(l),Lu(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),bt(2)):(this.j.info("Failed to ping google.com"),bt(1))};function ju(l){if(l.G=0,l.ka=[],l.l){const m=po(l.h);(m.length!=0||l.i.length!=0)&&(E(l.ka,m),E(l.ka,l.i),l.h.i.length=0,T(l.i),l.i.length=0),l.l.ra()}}function zu(l,m,p){var L=p instanceof jt?Ar(p):new jt(p);if(L.g!="")m&&(L.g=m+"."+L.g),Xr(L,L.s);else{var _e=c.location;L=_e.protocol,m=m?m+"."+_e.hostname:_e.hostname,_e=+_e.port;var Ce=new jt(null);L&&Jr(Ce,L),m&&(Ce.g=m),_e&&Xr(Ce,_e),p&&(Ce.l=p),L=Ce}return p=l.D,m=l.ya,p&&m&&Nt(L,p,m),Nt(L,"VER",l.la),Co(l,L),L}function qu(l,m,p){if(m&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return m=l.Ca&&!l.pa?new Wt(new Ss({eb:p})):new Wt(l.pa),m.Ha(l.J),m}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Hu(){}t=Hu.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Es(){}Es.prototype.g=function(l,m){return new Tr(l,m)};function Tr(l,m){le.call(this),this.g=new Nu(m),this.l=l,this.h=m&&m.messageUrlParams||null,l=m&&m.messageHeaders||null,m&&m.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=m&&m.initMessageHeaders||null,m&&m.messageContentType&&(l?l["X-WebChannel-Content-Type"]=m.messageContentType:l={"X-WebChannel-Content-Type":m.messageContentType}),m&&m.va&&(l?l["X-WebChannel-Client-Profile"]=m.va:l={"X-WebChannel-Client-Profile":m.va}),this.g.S=l,(l=m&&m.Sb)&&!K(l)&&(this.g.m=l),this.v=m&&m.supportsCrossDomainXhr||!1,this.u=m&&m.sendRawJson||!1,(m=m&&m.httpSessionIdParam)&&!K(m)&&(this.g.D=m,l=this.h,l!==null&&m in l&&(l=this.h,m in l&&delete l[m])),this.j=new Ni(this)}R(Tr,le),Tr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Tr.prototype.close=function(){Za(this.g)},Tr.prototype.o=function(l){var m=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.u&&(p={},p.__data__=ze(l),l=p);m.i.push(new $i(m.Ya++,l)),m.G==3&&As(m)},Tr.prototype.N=function(){this.g.l=null,delete this.j,Za(this.g),delete this.g,Tr.aa.N.call(this)};function Gu(l){st.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var m=l.__sm__;if(m){e:{for(const p in m){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,m=m!==null&&l in m?m[l]:void 0),this.data=m}else this.data=l}R(Gu,st);function Wu(){Xe.call(this),this.status=1}R(Wu,Xe);function Ni(l){this.g=l}R(Ni,Hu),Ni.prototype.ua=function(){ye(this.g,"a")},Ni.prototype.ta=function(l){ye(this.g,new Gu(l))},Ni.prototype.sa=function(l){ye(this.g,new Wu)},Ni.prototype.ra=function(){ye(this.g,"b")},Es.prototype.createWebChannel=Es.prototype.g,Tr.prototype.send=Tr.prototype.o,Tr.prototype.open=Tr.prototype.m,Tr.prototype.close=Tr.prototype.close,Df=function(){return new Es},Rf=function(){return Ft()},kf=gt,Jl={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ze.NO_ERROR=0,Ze.TIMEOUT=8,Ze.HTTP_ERROR=6,Xs=Ze,ht.COMPLETE="complete",$f=ht,He.EventType=Ae,Ae.OPEN="a",Ae.CLOSE="b",Ae.ERROR="c",Ae.MESSAGE="d",le.prototype.listen=le.prototype.K,ko=He,Wt.prototype.listenOnce=Wt.prototype.L,Wt.prototype.getLastError=Wt.prototype.Ka,Wt.prototype.getLastErrorCode=Wt.prototype.Ba,Wt.prototype.getStatus=Wt.prototype.Z,Wt.prototype.getResponseJson=Wt.prototype.Oa,Wt.prototype.getResponseText=Wt.prototype.oa,Wt.prototype.send=Wt.prototype.ea,Wt.prototype.setWithCredentials=Wt.prototype.Ha,Tf=Wt}).apply(typeof ks<"u"?ks:typeof self<"u"?self:typeof window<"u"?window:{});const Rd="@firebase/firestore",Dd="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Sr.UNAUTHENTICATED=new Sr(null),Sr.GOOGLE_CREDENTIALS=new Sr("google-credentials-uid"),Sr.FIRST_PARTY=new Sr("first-party-uid"),Sr.MOCK_USER=new Sr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let co="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wi=new Ac("@firebase/firestore");function Ui(){return wi.logLevel}function je(t,...e){if(wi.logLevel<=mt.DEBUG){const r=e.map(Vc);wi.debug(`Firestore (${co}): ${t}`,...r)}}function In(t,...e){if(wi.logLevel<=mt.ERROR){const r=e.map(Vc);wi.error(`Firestore (${co}): ${t}`,...r)}}function Zi(t,...e){if(wi.logLevel<=mt.WARN){const r=e.map(Vc);wi.warn(`Firestore (${co}): ${t}`,...r)}}function Vc(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function et(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,Nf(t,n,r)}function Nf(t,e,r){let n=`FIRESTORE (${co}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw In(n),new Error(n)}function Tt(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||Nf(e,i,n)}function it(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Fe extends Tn{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class O_{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Sr.UNAUTHENTICATED))}shutdown(){}}class V_{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class B_{constructor(e){this.t=e,this.currentUser=Sr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Tt(this.o===void 0,42304);let n=this.i;const i=u=>this.i!==n?(n=this.i,r(u)):Promise.resolve();let o=new wn;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new wn,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const u=o;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},c=u=>{je("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(je("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new wn)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(je("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Tt(typeof n.accessToken=="string",31837,{l:n}),new Lf(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Tt(e===null||typeof e=="string",2055,{h:e}),new Sr(e)}}class F_{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Sr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class U_{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new F_(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(Sr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Nd{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class j_{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Vr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Tt(this.o===void 0,3512);const n=o=>{o.error!=null&&je("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const a=o.token!==this.m;return this.m=o.token,je("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const i=o=>{je("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):je("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Nd(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Tt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new Nd(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z_(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bc{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=z_(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<r&&(n+=e.charAt(i[o]%62))}return n}}function ft(t,e){return t<e?-1:t>e?1:0}function Xl(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),o=e.charAt(n);if(i!==o)return fl(i)===fl(o)?ft(i,o):fl(i)?1:-1}return ft(t.length,e.length)}const q_=55296,H_=57343;function fl(t){const e=t.charCodeAt(0);return e>=q_&&e<=H_}function eo(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ld="__name__";class rn{constructor(e,r,n){r===void 0?r=0:r>e.length&&et(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&et(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return rn.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof rn?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const o=rn.compareSegments(e.get(i),r.get(i));if(o!==0)return o}return ft(e.length,r.length)}static compareSegments(e,r){const n=rn.isNumericId(e),i=rn.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?rn.extractNumericId(e).compare(rn.extractNumericId(r)):Xl(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Wn.fromString(e.substring(4,e.length-2))}}class Bt extends rn{construct(e,r,n){return new Bt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Fe(Ie.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Bt(r)}static emptyPath(){return new Bt([])}}const G_=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class dr extends rn{construct(e,r,n){return new dr(e,r,n)}static isValidIdentifier(e){return G_.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),dr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Ld}static keyField(){return new dr([Ld])}static fromServerFormat(e){const r=[];let n="",i=0;const o=()=>{if(n.length===0)throw new Fe(Ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new Fe(Ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Fe(Ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,i+=2}else c==="`"?(a=!a,i++):c!=="."||a?(n+=c,i++):(o(),i++)}if(o(),a)throw new Fe(Ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new dr(r)}static emptyPath(){return new dr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(e){this.path=e}static fromPath(e){return new Qe(Bt.fromString(e))}static fromName(e){return new Qe(Bt.fromString(e).popFirst(5))}static empty(){return new Qe(Bt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Bt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Bt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Qe(new Bt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mf(t,e,r){if(!r)throw new Fe(Ie.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function W_(t,e,r,n){if(e===!0&&n===!0)throw new Fe(Ie.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function Md(t){if(!Qe.isDocumentKey(t))throw new Fe(Ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Od(t){if(Qe.isDocumentKey(t))throw new Fe(Ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Of(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Oa(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":et(12329,{type:typeof t})}function En(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Fe(Ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Oa(t);throw new Fe(Ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nr(t,e){const r={typeString:t};return e&&(r.value=e),r}function ds(t,e){if(!Of(t))throw new Fe(Ie.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const a=t[n];if(i&&typeof a!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(o!==void 0&&a!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new Fe(Ie.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vd=-62135596800,Bd=1e6;class zt{static now(){return zt.fromMillis(Date.now())}static fromDate(e){return zt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*Bd);return new zt(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Fe(Ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Fe(Ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<Vd)throw new Fe(Ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Fe(Ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Bd}_compareTo(e){return this.seconds===e.seconds?ft(this.nanoseconds,e.nanoseconds):ft(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:zt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ds(e,zt._jsonSchema))return new zt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Vd;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}zt._jsonSchemaVersion="firestore/timestamp/1.0",zt._jsonSchema={type:nr("string",zt._jsonSchemaVersion),seconds:nr("number"),nanoseconds:nr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{static fromTimestamp(e){return new rt(e)}static min(){return new rt(new zt(0,0))}static max(){return new rt(new zt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jo=-1;function Y_(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=rt.fromTimestamp(n===1e9?new zt(r+1,0):new zt(r,n));return new Kn(i,Qe.empty(),e)}function K_(t){return new Kn(t.readTime,t.key,Jo)}class Kn{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Kn(rt.min(),Qe.empty(),Jo)}static max(){return new Kn(rt.max(),Qe.empty(),Jo)}}function Q_(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Qe.comparator(t.documentKey,e.documentKey),r!==0?r:ft(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J_="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class X_{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uo(t){if(t.code!==Ie.FAILED_PRECONDITION||t.message!==J_)throw t;je("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&et(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new xe((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof xe?r:xe.resolve(r)}catch(r){return xe.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):xe.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):xe.reject(r)}static resolve(e){return new xe((r,n)=>{r(e)})}static reject(e){return new xe((r,n)=>{n(e)})}static waitFor(e){return new xe((r,n)=>{let i=0,o=0,a=!1;e.forEach(c=>{++i,c.next(()=>{++o,a&&o===i&&r()},u=>n(u))}),a=!0,o===i&&r()})}static or(e){let r=xe.resolve(!1);for(const n of e)r=r.next(i=>i?xe.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,o)=>{n.push(r.call(this,i,o))}),this.waitFor(n)}static mapArray(e,r){return new xe((n,i)=>{const o=e.length,a=new Array(o);let c=0;for(let u=0;u<o;u++){const h=u;r(e[h]).next(f=>{a[h]=f,++c,c===o&&n(a)},f=>i(f))}})}static doWhile(e,r){return new xe((n,i)=>{const o=()=>{e()===!0?r().next(()=>{o()},i):n()};o()})}}function Z_(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function ho(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Va{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Va.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fc=-1;function Ba(t){return t==null}function ba(t){return t===0&&1/t==-1/0}function eS(t){return typeof t=="number"&&Number.isInteger(t)&&!ba(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vf="";function tS(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=Fd(e)),e=rS(t.get(r),e);return Fd(e)}function rS(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const o=t.charAt(i);switch(o){case"\0":r+="";break;case Vf:r+="";break;default:r+=o}}return r}function Fd(t){return t+Vf+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ud(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function ii(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function Bf(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e,r){this.comparator=e,this.root=r||ur.EMPTY}insert(e,r){return new Gt(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,ur.BLACK,null,null))}remove(e){return new Gt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ur.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Rs(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Rs(this.root,e,this.comparator,!1)}getReverseIterator(){return new Rs(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Rs(this.root,e,this.comparator,!0)}}class Rs{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ur{constructor(e,r,n,i,o){this.key=e,this.value=r,this.color=n??ur.RED,this.left=i??ur.EMPTY,this.right=o??ur.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,o){return new ur(e??this.key,r??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,r,n),null):o===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ur.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return ur.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ur.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ur.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw et(43730,{key:this.key,value:this.value});if(this.right.isRed())throw et(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw et(27949);return e+(this.isRed()?0:1)}}ur.EMPTY=null,ur.RED=!0,ur.BLACK=!1;ur.EMPTY=new class{constructor(){this.size=0}get key(){throw et(57766)}get value(){throw et(16141)}get color(){throw et(16727)}get left(){throw et(29726)}get right(){throw et(36894)}copy(e,r,n,i,o){return this}insert(e,r,n){return new ur(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e){this.comparator=e,this.data=new Gt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new jd(this.data.getIterator())}getIteratorFrom(e){return new jd(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof sr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new sr(this.comparator);return r.data=e,r}}class jd{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e){this.fields=e,e.sort(dr.comparator)}static empty(){return new Rr([])}unionWith(e){let r=new sr(dr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Rr(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return eo(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Ff("Invalid base64 string: "+o):o}}(e);return new fr(r)}static fromUint8Array(e){const r=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new fr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ft(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}fr.EMPTY_BYTE_STRING=new fr("");const nS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Qn(t){if(Tt(!!t,39018),typeof t=="string"){let e=0;const r=nS.exec(t);if(Tt(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Kt(t.seconds),nanos:Kt(t.nanos)}}function Kt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Jn(t){return typeof t=="string"?fr.fromBase64String(t):fr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uf="server_timestamp",jf="__type__",zf="__previous_value__",qf="__local_write_time__";function Uc(t){return(t?.mapValue?.fields||{})[jf]?.stringValue===Uf}function Fa(t){const e=t.mapValue.fields[zf];return Uc(e)?Fa(e):e}function Xo(t){const e=Qn(t.mapValue.fields[qf].timestampValue);return new zt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iS{constructor(e,r,n,i,o,a,c,u,h,f){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}}const _a="(default)";class Zo{constructor(e,r){this.projectId=e,this.database=r||_a}static empty(){return new Zo("","")}get isDefaultDatabase(){return this.database===_a}isEqual(e){return e instanceof Zo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hf="__type__",oS="__max__",Ds={mapValue:{}},Gf="__vector__",Sa="value";function Xn(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Uc(t)?4:aS(t)?9007199254740991:sS(t)?10:11:et(28295,{value:t})}function hn(t,e){if(t===e)return!0;const r=Xn(t);if(r!==Xn(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Xo(t).isEqual(Xo(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const a=Qn(i.timestampValue),c=Qn(o.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return Jn(i.bytesValue).isEqual(Jn(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return Kt(i.geoPointValue.latitude)===Kt(o.geoPointValue.latitude)&&Kt(i.geoPointValue.longitude)===Kt(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return Kt(i.integerValue)===Kt(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const a=Kt(i.doubleValue),c=Kt(o.doubleValue);return a===c?ba(a)===ba(c):isNaN(a)&&isNaN(c)}return!1}(t,e);case 9:return eo(t.arrayValue.values||[],e.arrayValue.values||[],hn);case 10:case 11:return function(i,o){const a=i.mapValue.fields||{},c=o.mapValue.fields||{};if(Ud(a)!==Ud(c))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(c[u]===void 0||!hn(a[u],c[u])))return!1;return!0}(t,e);default:return et(52216,{left:t})}}function es(t,e){return(t.values||[]).find(r=>hn(r,e))!==void 0}function to(t,e){if(t===e)return 0;const r=Xn(t),n=Xn(e);if(r!==n)return ft(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return ft(t.booleanValue,e.booleanValue);case 2:return function(o,a){const c=Kt(o.integerValue||o.doubleValue),u=Kt(a.integerValue||a.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return zd(t.timestampValue,e.timestampValue);case 4:return zd(Xo(t),Xo(e));case 5:return Xl(t.stringValue,e.stringValue);case 6:return function(o,a){const c=Jn(o),u=Jn(a);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(o,a){const c=o.split("/"),u=a.split("/");for(let h=0;h<c.length&&h<u.length;h++){const f=ft(c[h],u[h]);if(f!==0)return f}return ft(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,a){const c=ft(Kt(o.latitude),Kt(a.latitude));return c!==0?c:ft(Kt(o.longitude),Kt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return qd(t.arrayValue,e.arrayValue);case 10:return function(o,a){const c=o.fields||{},u=a.fields||{},h=c[Sa]?.arrayValue,f=u[Sa]?.arrayValue,g=ft(h?.values?.length||0,f?.values?.length||0);return g!==0?g:qd(h,f)}(t.mapValue,e.mapValue);case 11:return function(o,a){if(o===Ds.mapValue&&a===Ds.mapValue)return 0;if(o===Ds.mapValue)return 1;if(a===Ds.mapValue)return-1;const c=o.fields||{},u=Object.keys(c),h=a.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let g=0;g<u.length&&g<f.length;++g){const b=Xl(u[g],f[g]);if(b!==0)return b;const C=to(c[u[g]],h[f[g]]);if(C!==0)return C}return ft(u.length,f.length)}(t.mapValue,e.mapValue);default:throw et(23264,{he:r})}}function zd(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ft(t,e);const r=Qn(t),n=Qn(e),i=ft(r.seconds,n.seconds);return i!==0?i:ft(r.nanos,n.nanos)}function qd(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const o=to(r[i],n[i]);if(o)return o}return ft(r.length,n.length)}function ro(t){return Zl(t)}function Zl(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Qn(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Jn(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Qe.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const o of r.values||[])i?i=!1:n+=",",n+=Zl(o);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const a of n)o?o=!1:i+=",",i+=`${a}:${Zl(r.fields[a])}`;return i+"}"}(t.mapValue):et(61005,{value:t})}function Zs(t){switch(Xn(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Fa(t);return e?16+Zs(e):16;case 5:return 2*t.stringValue.length;case 6:return Jn(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,o)=>i+Zs(o),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return ii(n.fields,(o,a)=>{i+=o.length+Zs(a)}),i}(t.mapValue);default:throw et(13486,{value:t})}}function Hd(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ec(t){return!!t&&"integerValue"in t}function jc(t){return!!t&&"arrayValue"in t}function Gd(t){return!!t&&"nullValue"in t}function Wd(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ea(t){return!!t&&"mapValue"in t}function sS(t){return(t?.mapValue?.fields||{})[Hf]?.stringValue===Gf}function Fo(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ii(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Fo(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Fo(t.arrayValue.values[r]);return e}return{...t}}function aS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===oS}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e){this.value=e}static empty(){return new xr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!ea(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Fo(r)}setAll(e){let r=dr.emptyPath(),n={},i=[];e.forEach((a,c)=>{if(!r.isImmediateParentOf(c)){const u=this.getFieldsMap(r);this.applyChanges(u,n,i),n={},i=[],r=c.popLast()}a?n[c.lastSegment()]=Fo(a):i.push(c.lastSegment())});const o=this.getFieldsMap(r);this.applyChanges(o,n,i)}delete(e){const r=this.field(e.popLast());ea(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return hn(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];ea(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){ii(r,(i,o)=>e[i]=o);for(const i of n)delete e[i]}clone(){return new xr(Fo(this.value))}}function Wf(t){const e=[];return ii(t.fields,(r,n)=>{const i=new dr([r]);if(ea(n)){const o=Wf(n.mapValue).fields;if(o.length===0)e.push(i);else for(const a of o)e.push(i.child(a))}else e.push(i)}),new Rr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e,r,n,i,o,a,c){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=o,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Pr(e,0,rt.min(),rt.min(),rt.min(),xr.empty(),0)}static newFoundDocument(e,r,n,i){return new Pr(e,1,r,rt.min(),n,i,0)}static newNoDocument(e,r){return new Pr(e,2,r,rt.min(),rt.min(),xr.empty(),0)}static newUnknownDocument(e,r){return new Pr(e,3,r,rt.min(),rt.min(),xr.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(rt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=xr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=xr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=rt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Pr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Pr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e,r){this.position=e,this.inclusive=r}}function Yd(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const o=e[i],a=t.position[i];if(o.field.isKeyField()?n=Qe.comparator(Qe.fromName(a.referenceValue),r.key):n=to(a,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function Kd(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!hn(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e,r="asc"){this.field=e,this.dir=r}}function lS(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yf{}class rr extends Yf{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new uS(e,r,n):r==="array-contains"?new mS(e,n):r==="in"?new fS(e,n):r==="not-in"?new yS(e,n):r==="array-contains-any"?new gS(e,n):new rr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new dS(e,n):new hS(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(to(r,this.value)):r!==null&&Xn(this.value)===Xn(r)&&this.matchesComparison(to(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return et(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Kr extends Yf{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Kr(e,r)}matches(e){return Kf(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Kf(t){return t.op==="and"}function Qf(t){return cS(t)&&Kf(t)}function cS(t){for(const e of t.filters)if(e instanceof Kr)return!1;return!0}function tc(t){if(t instanceof rr)return t.field.canonicalString()+t.op.toString()+ro(t.value);if(Qf(t))return t.filters.map(e=>tc(e)).join(",");{const e=t.filters.map(r=>tc(r)).join(",");return`${t.op}(${e})`}}function Jf(t,e){return t instanceof rr?function(n,i){return i instanceof rr&&n.op===i.op&&n.field.isEqual(i.field)&&hn(n.value,i.value)}(t,e):t instanceof Kr?function(n,i){return i instanceof Kr&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((o,a,c)=>o&&Jf(a,i.filters[c]),!0):!1}(t,e):void et(19439)}function Xf(t){return t instanceof rr?function(r){return`${r.field.canonicalString()} ${r.op} ${ro(r.value)}`}(t):t instanceof Kr?function(r){return r.op.toString()+" {"+r.getFilters().map(Xf).join(" ,")+"}"}(t):"Filter"}class uS extends rr{constructor(e,r,n){super(e,r,n),this.key=Qe.fromName(n.referenceValue)}matches(e){const r=Qe.comparator(e.key,this.key);return this.matchesComparison(r)}}class dS extends rr{constructor(e,r){super(e,"in",r),this.keys=Zf("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class hS extends rr{constructor(e,r){super(e,"not-in",r),this.keys=Zf("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function Zf(t,e){return(e.arrayValue?.values||[]).map(r=>Qe.fromName(r.referenceValue))}class mS extends rr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return jc(r)&&es(r.arrayValue,this.value)}}class fS extends rr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&es(this.value.arrayValue,r)}}class yS extends rr{constructor(e,r){super(e,"not-in",r)}matches(e){if(es(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!es(this.value.arrayValue,r)}}class gS extends rr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!jc(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>es(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{constructor(e,r=null,n=[],i=[],o=null,a=null,c=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=a,this.endAt=c,this.Te=null}}function Qd(t,e=null,r=[],n=[],i=null,o=null,a=null){return new pS(t,e,r,n,i,o,a)}function zc(t){const e=it(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>tc(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),Ba(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>ro(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>ro(n)).join(",")),e.Te=r}return e.Te}function qc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!lS(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!Jf(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Kd(t.startAt,e.startAt)&&Kd(t.endAt,e.endAt)}function rc(t){return Qe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo{constructor(e,r=null,n=[],i=[],o=null,a="F",c=null,u=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=a,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function vS(t,e,r,n,i,o,a,c){return new mo(t,e,r,n,i,o,a,c)}function Hc(t){return new mo(t)}function Jd(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function ey(t){return t.collectionGroup!==null}function Uo(t){const e=it(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new sr(dr.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(o=>{r.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new ts(o,n))}),r.has(dr.keyField().canonicalString())||e.Ie.push(new ts(dr.keyField(),n))}return e.Ie}function sn(t){const e=it(t);return e.Ee||(e.Ee=bS(e,Uo(t))),e.Ee}function bS(t,e){if(t.limitType==="F")return Qd(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new ts(i.field,o)});const r=t.endAt?new Pa(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Pa(t.startAt.position,t.startAt.inclusive):null;return Qd(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function nc(t,e){const r=t.filters.concat([e]);return new mo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function ic(t,e,r){return new mo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Ua(t,e){return qc(sn(t),sn(e))&&t.limitType===e.limitType}function ty(t){return`${zc(sn(t))}|lt:${t.limitType}`}function ji(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>Xf(i)).join(", ")}]`),Ba(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>ro(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>ro(i)).join(",")),`Target(${n})`}(sn(t))}; limitType=${t.limitType})`}function ja(t,e){return e.isFoundDocument()&&function(n,i){const o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):Qe.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(t,e)&&function(n,i){for(const o of Uo(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,c,u){const h=Yd(a,c,u);return a.inclusive?h<=0:h<0}(n.startAt,Uo(n),i)||n.endAt&&!function(a,c,u){const h=Yd(a,c,u);return a.inclusive?h>=0:h>0}(n.endAt,Uo(n),i))}(t,e)}function _S(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function ry(t){return(e,r)=>{let n=!1;for(const i of Uo(t)){const o=SS(i,e,r);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function SS(t,e,r){const n=t.field.isKeyField()?Qe.comparator(e.key,r.key):function(o,a,c){const u=a.data.field(o),h=c.data.field(o);return u!==null&&h!==null?to(u,h):et(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return et(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,o]of n)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ii(this.inner,(r,n)=>{for(const[i,o]of n)e(i,o)})}isEmpty(){return Bf(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PS=new Gt(Qe.comparator);function xn(){return PS}const ny=new Gt(Qe.comparator);function Ro(...t){let e=ny;for(const r of t)e=e.insert(r.key,r);return e}function iy(t){let e=ny;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function pi(){return jo()}function oy(){return jo()}function jo(){return new Ei(t=>t.toString(),(t,e)=>t.isEqual(e))}const wS=new Gt(Qe.comparator),CS=new sr(Qe.comparator);function yt(...t){let e=CS;for(const r of t)e=e.add(r);return e}const AS=new sr(ft);function IS(){return AS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gc(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ba(e)?"-0":e}}function sy(t){return{integerValue:""+t}}function ES(t,e){return eS(e)?sy(e):Gc(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(){this._=void 0}}function xS(t,e,r){return t instanceof wa?function(i,o){const a={fields:{[jf]:{stringValue:Uf},[qf]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Uc(o)&&(o=Fa(o)),o&&(a.fields[zf]=o),{mapValue:a}}(r,e):t instanceof rs?ly(t,e):t instanceof ns?cy(t,e):function(i,o){const a=ay(i,o),c=Xd(a)+Xd(i.Ae);return ec(a)&&ec(i.Ae)?sy(c):Gc(i.serializer,c)}(t,e)}function TS(t,e,r){return t instanceof rs?ly(t,e):t instanceof ns?cy(t,e):r}function ay(t,e){return t instanceof Ca?function(n){return ec(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}class wa extends za{}class rs extends za{constructor(e){super(),this.elements=e}}function ly(t,e){const r=uy(e);for(const n of t.elements)r.some(i=>hn(i,n))||r.push(n);return{arrayValue:{values:r}}}class ns extends za{constructor(e){super(),this.elements=e}}function cy(t,e){let r=uy(e);for(const n of t.elements)r=r.filter(i=>!hn(i,n));return{arrayValue:{values:r}}}class Ca extends za{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function Xd(t){return Kt(t.integerValue||t.doubleValue)}function uy(t){return jc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function $S(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof rs&&i instanceof rs||n instanceof ns&&i instanceof ns?eo(n.elements,i.elements,hn):n instanceof Ca&&i instanceof Ca?hn(n.Ae,i.Ae):n instanceof wa&&i instanceof wa}(t.transform,e.transform)}class kS{constructor(e,r){this.version=e,this.transformResults=r}}class an{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new an}static exists(e){return new an(void 0,e)}static updateTime(e){return new an(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ta(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class qa{}function dy(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new my(t.key,an.none()):new hs(t.key,t.data,an.none());{const r=t.data,n=xr.empty();let i=new sr(dr.comparator);for(let o of e.fields)if(!i.has(o)){let a=r.field(o);a===null&&o.length>1&&(o=o.popLast(),a=r.field(o)),a===null?n.delete(o):n.set(o,a),i=i.add(o)}return new oi(t.key,n,new Rr(i.toArray()),an.none())}}function RS(t,e,r){t instanceof hs?function(i,o,a){const c=i.value.clone(),u=eh(i.fieldTransforms,o,a.transformResults);c.setAll(u),o.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,r):t instanceof oi?function(i,o,a){if(!ta(i.precondition,o))return void o.convertToUnknownDocument(a.version);const c=eh(i.fieldTransforms,o,a.transformResults),u=o.data;u.setAll(hy(i)),u.setAll(c),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,r):function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function zo(t,e,r,n){return t instanceof hs?function(o,a,c,u){if(!ta(o.precondition,a))return c;const h=o.value.clone(),f=th(o.fieldTransforms,u,a);return h.setAll(f),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(t,e,r,n):t instanceof oi?function(o,a,c,u){if(!ta(o.precondition,a))return c;const h=th(o.fieldTransforms,u,a),f=a.data;return f.setAll(hy(o)),f.setAll(h),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),c===null?null:c.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(g=>g.field))}(t,e,r,n):function(o,a,c){return ta(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(t,e,r)}function DS(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),o=ay(n.transform,i||null);o!=null&&(r===null&&(r=xr.empty()),r.set(n.field,o))}return r||null}function Zd(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&eo(n,i,(o,a)=>$S(o,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class hs extends qa{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class oi extends qa{constructor(e,r,n,i,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function hy(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function eh(t,e,r){const n=new Map;Tt(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const o=t[i],a=o.transform,c=e.data.field(o.field);n.set(o.field,TS(a,c,r[i]))}return n}function th(t,e,r){const n=new Map;for(const i of t){const o=i.transform,a=r.data.field(i.field);n.set(i.field,xS(o,a,e))}return n}class my extends qa{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class NS extends qa{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LS{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&RS(o,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=zo(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=zo(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=oy();return this.mutations.forEach(i=>{const o=e.get(i.key),a=o.overlayedDocument;let c=this.applyToLocalView(a,o.mutatedFields);c=r.has(i.key)?null:c;const u=dy(a,c);u!==null&&n.set(i.key,u),a.isValidDocument()||a.convertToNoDocument(rt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),yt())}isEqual(e){return this.batchId===e.batchId&&eo(this.mutations,e.mutations,(r,n)=>Zd(r,n))&&eo(this.baseMutations,e.baseMutations,(r,n)=>Zd(r,n))}}class Wc{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Tt(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return wS}();const o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,n[a].version);return new Wc(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MS{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tr,vt;function VS(t){switch(t){case Ie.OK:return et(64938);case Ie.CANCELLED:case Ie.UNKNOWN:case Ie.DEADLINE_EXCEEDED:case Ie.RESOURCE_EXHAUSTED:case Ie.INTERNAL:case Ie.UNAVAILABLE:case Ie.UNAUTHENTICATED:return!1;case Ie.INVALID_ARGUMENT:case Ie.NOT_FOUND:case Ie.ALREADY_EXISTS:case Ie.PERMISSION_DENIED:case Ie.FAILED_PRECONDITION:case Ie.ABORTED:case Ie.OUT_OF_RANGE:case Ie.UNIMPLEMENTED:case Ie.DATA_LOSS:return!0;default:return et(15467,{code:t})}}function fy(t){if(t===void 0)return In("GRPC error has no .code"),Ie.UNKNOWN;switch(t){case tr.OK:return Ie.OK;case tr.CANCELLED:return Ie.CANCELLED;case tr.UNKNOWN:return Ie.UNKNOWN;case tr.DEADLINE_EXCEEDED:return Ie.DEADLINE_EXCEEDED;case tr.RESOURCE_EXHAUSTED:return Ie.RESOURCE_EXHAUSTED;case tr.INTERNAL:return Ie.INTERNAL;case tr.UNAVAILABLE:return Ie.UNAVAILABLE;case tr.UNAUTHENTICATED:return Ie.UNAUTHENTICATED;case tr.INVALID_ARGUMENT:return Ie.INVALID_ARGUMENT;case tr.NOT_FOUND:return Ie.NOT_FOUND;case tr.ALREADY_EXISTS:return Ie.ALREADY_EXISTS;case tr.PERMISSION_DENIED:return Ie.PERMISSION_DENIED;case tr.FAILED_PRECONDITION:return Ie.FAILED_PRECONDITION;case tr.ABORTED:return Ie.ABORTED;case tr.OUT_OF_RANGE:return Ie.OUT_OF_RANGE;case tr.UNIMPLEMENTED:return Ie.UNIMPLEMENTED;case tr.DATA_LOSS:return Ie.DATA_LOSS;default:return et(39323,{code:t})}}(vt=tr||(tr={}))[vt.OK=0]="OK",vt[vt.CANCELLED=1]="CANCELLED",vt[vt.UNKNOWN=2]="UNKNOWN",vt[vt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",vt[vt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",vt[vt.NOT_FOUND=5]="NOT_FOUND",vt[vt.ALREADY_EXISTS=6]="ALREADY_EXISTS",vt[vt.PERMISSION_DENIED=7]="PERMISSION_DENIED",vt[vt.UNAUTHENTICATED=16]="UNAUTHENTICATED",vt[vt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",vt[vt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",vt[vt.ABORTED=10]="ABORTED",vt[vt.OUT_OF_RANGE=11]="OUT_OF_RANGE",vt[vt.UNIMPLEMENTED=12]="UNIMPLEMENTED",vt[vt.INTERNAL=13]="INTERNAL",vt[vt.UNAVAILABLE=14]="UNAVAILABLE",vt[vt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BS(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FS=new Wn([4294967295,4294967295],0);function rh(t){const e=BS().encode(t),r=new xf;return r.update(e),new Uint8Array(r.digest())}function nh(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Wn([r,n],0),new Wn([i,o],0)]}class Yc{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Do(`Invalid padding: ${r}`);if(n<0)throw new Do(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Do(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Do(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Wn.fromNumber(this.ge)}ye(e,r,n){let i=e.add(r.multiply(Wn.fromNumber(n)));return i.compare(FS)===1&&(i=new Wn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=rh(e),[n,i]=nh(r);for(let o=0;o<this.hashCount;o++){const a=this.ye(n,i,o);if(!this.we(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new Yc(o,i,r);return n.forEach(c=>a.insert(c)),a}insert(e){if(this.ge===0)return;const r=rh(e),[n,i]=nh(r);for(let o=0;o<this.hashCount;o++){const a=this.ye(n,i,o);this.Se(a)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Do extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e,r,n,i,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,ms.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Ha(rt.min(),i,new Gt(ft),xn(),yt())}}class ms{constructor(e,r,n,i,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new ms(n,r,yt(),yt(),yt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(e,r,n,i){this.be=e,this.removedTargetIds=r,this.key=n,this.De=i}}class yy{constructor(e,r){this.targetId=e,this.Ce=r}}class gy{constructor(e,r,n=fr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class ih{constructor(){this.ve=0,this.Fe=oh(),this.Me=fr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=yt(),r=yt(),n=yt();return this.Fe.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:et(38017,{changeType:o})}}),new ms(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=oh()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Tt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class US{constructor(e){this.Ge=e,this.ze=new Map,this.je=xn(),this.Je=Ns(),this.He=Ns(),this.Ye=new Gt(ft)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:et(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,i)=>{this.rt(i)&&r(i)})}st(e){const r=e.targetId,n=e.Ce.count,i=this.ot(r);if(i){const o=i.target;if(rc(o))if(n===0){const a=new Qe(o.path);this.et(r,a,Pr.newNoDocument(a,rt.min()))}else Tt(n===1,20013,{expectedCount:n});else{const a=this._t(r);if(a!==n){const c=this.ut(e),u=c?this.ct(c,e,a):1;if(u!==0){this.it(r);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,h)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=r;let a,c;try{a=Jn(n).toUint8Array()}catch(u){if(u instanceof Ff)return Zi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Yc(a,i,o)}catch(u){return Zi(u instanceof Do?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let i=0;return n.forEach(o=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(c)||(this.et(r,o,null),i++)}),i}Tt(e){const r=new Map;this.ze.forEach((o,a)=>{const c=this.ot(a);if(c){if(o.current&&rc(c.target)){const u=new Qe(c.target.path);this.It(u).has(a)||this.Et(a,u)||this.et(a,u,Pr.newNoDocument(u,e))}o.Be&&(r.set(a,o.ke()),o.qe())}});let n=yt();this.He.forEach((o,a)=>{let c=!0;a.forEachWhile(u=>{const h=this.ot(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(o))}),this.je.forEach((o,a)=>a.setReadTime(e));const i=new Ha(e,r,this.Ye,this.je,n);return this.je=xn(),this.Je=Ns(),this.He=Ns(),this.Ye=new Gt(ft),i}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,r)?i.Qe(r,1):i.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new ih,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new sr(ft),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new sr(ft),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||je("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new ih),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Ns(){return new Gt(Qe.comparator)}function oh(){return new Gt(Qe.comparator)}const jS={asc:"ASCENDING",desc:"DESCENDING"},zS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},qS={and:"AND",or:"OR"};class HS{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function oc(t,e){return t.useProto3Json||Ba(e)?e:{value:e}}function Aa(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function py(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function GS(t,e){return Aa(t,e.toTimestamp())}function ln(t){return Tt(!!t,49232),rt.fromTimestamp(function(r){const n=Qn(r);return new zt(n.seconds,n.nanos)}(t))}function Kc(t,e){return sc(t,e).canonicalString()}function sc(t,e){const r=function(i){return new Bt(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function vy(t){const e=Bt.fromString(t);return Tt(wy(e),10190,{key:e.toString()}),e}function ac(t,e){return Kc(t.databaseId,e.path)}function yl(t,e){const r=vy(e);if(r.get(1)!==t.databaseId.projectId)throw new Fe(Ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Fe(Ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Qe(_y(r))}function by(t,e){return Kc(t.databaseId,e)}function WS(t){const e=vy(t);return e.length===4?Bt.emptyPath():_y(e)}function lc(t){return new Bt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function _y(t){return Tt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function sh(t,e,r){return{name:ac(t,e),fields:r.value.mapValue.fields}}function YS(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:et(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(h,f){return h.useProto3Json?(Tt(f===void 0||typeof f=="string",58123),fr.fromBase64String(f||"")):(Tt(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),fr.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(h){const f=h.code===void 0?Ie.UNKNOWN:fy(h.code);return new Fe(f,h.message||"")}(a);r=new gy(n,i,o,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=yl(t,n.document.name),o=ln(n.document.updateTime),a=n.document.createTime?ln(n.document.createTime):rt.min(),c=new xr({mapValue:{fields:n.document.fields}}),u=Pr.newFoundDocument(i,o,a,c),h=n.targetIds||[],f=n.removedTargetIds||[];r=new ra(h,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=yl(t,n.document),o=n.readTime?ln(n.readTime):rt.min(),a=Pr.newNoDocument(i,o),c=n.removedTargetIds||[];r=new ra([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=yl(t,n.document),o=n.removedTargetIds||[];r=new ra([],o,i,null)}else{if(!("filter"in e))return et(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:o}=n,a=new OS(i,o),c=n.targetId;r=new yy(c,a)}}return r}function KS(t,e){let r;if(e instanceof hs)r={update:sh(t,e.key,e.value)};else if(e instanceof my)r={delete:ac(t,e.key)};else if(e instanceof oi)r={update:sh(t,e.key,e.data),updateMask:i1(e.fieldMask)};else{if(!(e instanceof NS))return et(16599,{Vt:e.type});r={verify:ac(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(o,a){const c=a.transform;if(c instanceof wa)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof rs)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof ns)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Ca)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw et(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:GS(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:et(27497)}(t,e.precondition)),r}function QS(t,e){return t&&t.length>0?(Tt(e!==void 0,14353),t.map(r=>function(i,o){let a=i.updateTime?ln(i.updateTime):ln(o);return a.isEqual(rt.min())&&(a=ln(o)),new kS(a,i.transformResults||[])}(r,e))):[]}function JS(t,e){return{documents:[by(t,e.path)]}}function XS(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=by(t,i);const o=function(h){if(h.length!==0)return Py(Kr.create(h,"and"))}(e.filters);o&&(r.structuredQuery.where=o);const a=function(h){if(h.length!==0)return h.map(f=>function(b){return{field:zi(b.field),direction:t1(b.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const c=oc(t,e.limit);return c!==null&&(r.structuredQuery.limit=c),e.startAt&&(r.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ft:r,parent:i}}function ZS(t){let e=WS(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Tt(n===1,65062);const f=r.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let o=[];r.where&&(o=function(g){const b=Sy(g);return b instanceof Kr&&Qf(b)?b.getFilters():[b]}(r.where));let a=[];r.orderBy&&(a=function(g){return g.map(b=>function(R){return new ts(qi(R.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(b))}(r.orderBy));let c=null;r.limit&&(c=function(g){let b;return b=typeof g=="object"?g.value:g,Ba(b)?null:b}(r.limit));let u=null;r.startAt&&(u=function(g){const b=!!g.before,C=g.values||[];return new Pa(C,b)}(r.startAt));let h=null;return r.endAt&&(h=function(g){const b=!g.before,C=g.values||[];return new Pa(C,b)}(r.endAt)),vS(e,i,a,o,c,"F",u,h)}function e1(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return et(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Sy(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=qi(r.unaryFilter.field);return rr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=qi(r.unaryFilter.field);return rr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=qi(r.unaryFilter.field);return rr.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=qi(r.unaryFilter.field);return rr.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return et(61313);default:return et(60726)}}(t):t.fieldFilter!==void 0?function(r){return rr.create(qi(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return et(58110);default:return et(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Kr.create(r.compositeFilter.filters.map(n=>Sy(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return et(1026)}}(r.compositeFilter.op))}(t):et(30097,{filter:t})}function t1(t){return jS[t]}function r1(t){return zS[t]}function n1(t){return qS[t]}function zi(t){return{fieldPath:t.canonicalString()}}function qi(t){return dr.fromServerFormat(t.fieldPath)}function Py(t){return t instanceof rr?function(r){if(r.op==="=="){if(Wd(r.value))return{unaryFilter:{field:zi(r.field),op:"IS_NAN"}};if(Gd(r.value))return{unaryFilter:{field:zi(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(Wd(r.value))return{unaryFilter:{field:zi(r.field),op:"IS_NOT_NAN"}};if(Gd(r.value))return{unaryFilter:{field:zi(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zi(r.field),op:r1(r.op),value:r.value}}}(t):t instanceof Kr?function(r){const n=r.getFilters().map(i=>Py(i));return n.length===1?n[0]:{compositeFilter:{op:n1(r.op),filters:n}}}(t):et(54877,{filter:t})}function i1(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function wy(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e,r,n,i,o=rt.min(),a=rt.min(),c=fr.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Fn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Fn(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Fn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Fn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{constructor(e){this.yt=e}}function s1(t){const e=ZS({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ic(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a1{constructor(){this.Cn=new l1}addToCollectionParentIndex(e,r){return this.Cn.add(r),xe.resolve()}getCollectionParents(e,r){return xe.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return xe.resolve()}deleteFieldIndex(e,r){return xe.resolve()}deleteAllFieldIndexes(e){return xe.resolve()}createTargetIndexes(e,r){return xe.resolve()}getDocumentsMatchingTarget(e,r){return xe.resolve(null)}getIndexType(e,r){return xe.resolve(0)}getFieldIndexes(e,r){return xe.resolve([])}getNextCollectionGroupToUpdate(e){return xe.resolve(null)}getMinOffset(e,r){return xe.resolve(Kn.min())}getMinOffsetFromCollectionGroup(e,r){return xe.resolve(Kn.min())}updateCollectionGroup(e,r,n){return xe.resolve()}updateIndexEntries(e,r){return xe.resolve()}}class l1{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new sr(Bt.comparator),o=!i.has(n);return this.index[r]=i.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new sr(Bt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ah={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Cy=41943040;class Er{static withCacheSize(e){return new Er(e,Er.DEFAULT_COLLECTION_PERCENTILE,Er.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Er.DEFAULT_COLLECTION_PERCENTILE=10,Er.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Er.DEFAULT=new Er(Cy,Er.DEFAULT_COLLECTION_PERCENTILE,Er.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Er.DISABLED=new Er(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new no(0)}static cr(){return new no(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lh="LruGarbageCollector",c1=1048576;function ch([t,e],[r,n]){const i=ft(t,r);return i===0?ft(e,n):i}class u1{constructor(e){this.Ir=e,this.buffer=new sr(ch),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();ch(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class d1{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){je(lh,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){ho(r)?je(lh,"Ignoring IndexedDB error during garbage collection: ",r):await uo(r)}await this.Vr(3e5)})}}class h1{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return xe.resolve(Va.ce);const n=new u1(r);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(je("LruGarbageCollector","Garbage collection skipped; disabled"),xe.resolve(ah)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(je("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ah):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,o,a,c,u,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(je("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,a=Date.now(),this.nthSequenceNumber(e,i))).next(g=>(n=g,c=Date.now(),this.removeTargets(e,n,r))).next(g=>(o=g,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(g=>(h=Date.now(),Ui()<=mt.DEBUG&&je("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-f}ms
	Determined least recently used ${i} in `+(c-a)+`ms
	Removed ${o} targets in `+(u-c)+`ms
	Removed ${g} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),xe.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:g})))}}function m1(t,e){return new h1(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f1{constructor(){this.changes=new Ei(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Pr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?xe.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g1{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&zo(n.mutation,i,Rr.empty(),zt.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,yt()).next(()=>n))}getLocalViewOfDocuments(e,r,n=yt()){const i=pi();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(o=>{let a=Ro();return o.forEach((c,u)=>{a=a.insert(c,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=pi();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,yt()))}populateOverlays(e,r,n){const i=[];return n.forEach(o=>{r.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,c)=>{r.set(a,c)})})}computeViews(e,r,n,i){let o=xn();const a=jo(),c=function(){return jo()}();return r.forEach((u,h)=>{const f=n.get(h.key);i.has(h.key)&&(f===void 0||f.mutation instanceof oi)?o=o.insert(h.key,h):f!==void 0?(a.set(h.key,f.mutation.getFieldMask()),zo(f.mutation,h,f.mutation.getFieldMask(),zt.now())):a.set(h.key,Rr.empty())}),this.recalculateAndSaveOverlays(e,o).next(u=>(u.forEach((h,f)=>a.set(h,f)),r.forEach((h,f)=>c.set(h,new y1(f,a.get(h)??null))),c))}recalculateAndSaveOverlays(e,r){const n=jo();let i=new Gt((a,c)=>a-c),o=yt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const c of a)c.keys().forEach(u=>{const h=r.get(u);if(h===null)return;let f=n.get(u)||Rr.empty();f=c.applyToLocalView(h,f),n.set(u,f);const g=(i.get(c.batchId)||yt()).add(u);i=i.insert(c.batchId,g)})}).next(()=>{const a=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,f=u.value,g=oy();f.forEach(b=>{if(!o.has(b)){const C=dy(r.get(b),n.get(b));C!==null&&g.set(b,C),o=o.add(b)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,g))}return xe.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return Qe.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):ey(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(o=>{const a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-o.size):xe.resolve(pi());let c=Jo,u=o;return a.next(h=>xe.forEach(h,(f,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),o.get(f)?xe.resolve():this.remoteDocumentCache.getEntry(e,f).next(b=>{u=u.insert(f,b)}))).next(()=>this.populateOverlays(e,h,o)).next(()=>this.computeViews(e,u,h,yt())).next(f=>({batchId:c,changes:iy(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Qe(r)).next(n=>{let i=Ro();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const o=r.collectionGroup;let a=Ro();return this.indexManager.getCollectionParents(e,o).next(c=>xe.forEach(c,u=>{const h=function(g,b){return new mo(b,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(r,u.child(o));return this.getDocumentsMatchingCollectionQuery(e,h,n,i).next(f=>{f.forEach((g,b)=>{a=a.insert(g,b)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,i))).next(a=>{o.forEach((u,h)=>{const f=h.getKey();a.get(f)===null&&(a=a.insert(f,Pr.newInvalidDocument(f)))});let c=Ro();return a.forEach((u,h)=>{const f=o.get(u);f!==void 0&&zo(f.mutation,h,Rr.empty(),zt.now()),ja(r,h)&&(c=c.insert(u,h))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return xe.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:ln(i.createTime)}}(r)),xe.resolve()}getNamedQuery(e,r){return xe.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(i){return{name:i.name,query:s1(i.bundledQuery),readTime:ln(i.readTime)}}(r)),xe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v1{constructor(){this.overlays=new Gt(Qe.comparator),this.qr=new Map}getOverlay(e,r){return xe.resolve(this.overlays.get(r))}getOverlays(e,r){const n=pi();return xe.forEach(r,i=>this.getOverlay(e,i).next(o=>{o!==null&&n.set(i,o)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,o)=>{this.St(e,r,o)}),xe.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.qr.delete(n)),xe.resolve()}getOverlaysForCollection(e,r,n){const i=pi(),o=r.length+1,a=new Qe(r.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!r.isPrefixOf(h.path))break;h.path.length===o&&u.largestBatchId>n&&i.set(u.getKey(),u)}return xe.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let o=new Gt((h,f)=>h-f);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===r&&h.largestBatchId>n){let f=o.get(h.largestBatchId);f===null&&(f=pi(),o=o.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const c=pi(),u=o.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,f)=>c.set(h,f)),!(c.size()>=i)););return xe.resolve(c)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new MS(r,n));let o=this.qr.get(r);o===void 0&&(o=yt(),this.qr.set(r,o)),this.qr.set(r,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1{constructor(){this.sessionToken=fr.EMPTY_BYTE_STRING}getSessionToken(e){return xe.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,xe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(){this.Qr=new sr(ar.$r),this.Ur=new sr(ar.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new ar(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new ar(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new Qe(new Bt([])),n=new ar(r,e),i=new ar(r,e+1),o=[];return this.Ur.forEachInRange([n,i],a=>{this.Gr(a),o.push(a.key)}),o}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new Qe(new Bt([])),n=new ar(r,e),i=new ar(r,e+1);let o=yt();return this.Ur.forEachInRange([n,i],a=>{o=o.add(a.key)}),o}containsKey(e){const r=new ar(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class ar{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return Qe.comparator(e.key,r.key)||ft(e.Yr,r.Yr)}static Kr(e,r){return ft(e.Yr,r.Yr)||Qe.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _1{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new sr(ar.$r)}checkEmpty(e){return xe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new LS(o,r,n,i);this.mutationQueue.push(a);for(const c of i)this.Zr=this.Zr.add(new ar(c.key,o)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return xe.resolve(a)}lookupMutationBatch(e,r){return xe.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),o=i<0?0:i;return xe.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return xe.resolve(this.mutationQueue.length===0?Fc:this.tr-1)}getAllMutationBatches(e){return xe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new ar(r,0),i=new ar(r,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,i],a=>{const c=this.Xr(a.Yr);o.push(c)}),xe.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new sr(ft);return r.forEach(i=>{const o=new ar(i,0),a=new ar(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,a],c=>{n=n.add(c.Yr)})}),xe.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let o=n;Qe.isDocumentKey(o)||(o=o.child(""));const a=new ar(new Qe(o),0);let c=new sr(ft);return this.Zr.forEachWhile(u=>{const h=u.key.path;return!!n.isPrefixOf(h)&&(h.length===i&&(c=c.add(u.Yr)),!0)},a),xe.resolve(this.ti(c))}ti(e){const r=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Tt(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return xe.forEach(r.mutations,i=>{const o=new ar(i.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new ar(r,0),i=this.Zr.firstAfterOrEqual(n);return xe.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,xe.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S1{constructor(e){this.ri=e,this.docs=function(){return new Gt(Qe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),o=i?i.size:0,a=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return xe.resolve(n?n.document.mutableCopy():Pr.newInvalidDocument(r))}getEntries(e,r){let n=xn();return r.forEach(i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():Pr.newInvalidDocument(i))}),xe.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let o=xn();const a=r.path,c=new Qe(a.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||Q_(K_(f),n)<=0||(i.has(f.key)||ja(r,f))&&(o=o.insert(f.key,f.mutableCopy()))}return xe.resolve(o)}getAllFromCollectionGroup(e,r,n,i){et(9500)}ii(e,r){return xe.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new P1(this)}getSize(e){return xe.resolve(this.size)}}class P1 extends f1{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),xe.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{constructor(e){this.persistence=e,this.si=new Ei(r=>zc(r),qc),this.lastRemoteSnapshotVersion=rt.min(),this.highestTargetId=0,this.oi=0,this._i=new Qc,this.targetCount=0,this.ai=no.ur()}forEachTarget(e,r){return this.si.forEach((n,i)=>r(i)),xe.resolve()}getLastRemoteSnapshotVersion(e){return xe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return xe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),xe.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),xe.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new no(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,xe.resolve()}updateTargetData(e,r){return this.Pr(r),xe.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,xe.resolve()}removeTargets(e,r,n){let i=0;const o=[];return this.si.forEach((a,c)=>{c.sequenceNumber<=r&&n.get(c.targetId)===null&&(this.si.delete(a),o.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),xe.waitFor(o).next(()=>i)}getTargetCount(e){return xe.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return xe.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),xe.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,o=[];return i&&r.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),xe.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),xe.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return xe.resolve(n)}containsKey(e,r){return xe.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ay{constructor(e,r){this.ui={},this.overlays={},this.ci=new Va(0),this.li=!1,this.li=!0,this.hi=new b1,this.referenceDelegate=e(this),this.Pi=new w1(this),this.indexManager=new a1,this.remoteDocumentCache=function(i){return new S1(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new o1(r),this.Ii=new p1(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new v1,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new _1(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){je("MemoryPersistence","Starting transaction:",e);const i=new C1(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ai(e,r){return xe.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class C1 extends X_{constructor(e){super(),this.currentSequenceNumber=e}}class Jc{constructor(e){this.persistence=e,this.Ri=new Qc,this.Vi=null}static mi(e){return new Jc(e)}get fi(){if(this.Vi)return this.Vi;throw et(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),xe.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),xe.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),xe.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(o=>this.fi.add(o.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return xe.forEach(this.fi,n=>{const i=Qe.fromPath(n);return this.gi(e,i).next(o=>{o||r.removeEntry(i,rt.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return xe.or([()=>xe.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Ia{constructor(e,r){this.persistence=e,this.pi=new Ei(n=>tS(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=m1(this,r)}static mi(e,r){return new Ia(e,r)}Ei(){}di(e){return xe.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return xe.forEach(this.pi,(n,i)=>this.br(e,n,i).next(o=>o?xe.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(e,a=>this.br(e,a,r).next(c=>{c||(n++,o.removeEntry(a,rt.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),xe.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),xe.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),xe.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),xe.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Zs(e.data.value)),r}br(e,r,n){return xe.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.pi.get(r);return xe.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=yt(),i=yt();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new Xc(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I1{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return gv()?8:Z_(Cr())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const o={result:null};return this.ys(e,r).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.ws(e,r,i,n).next(a=>{o.result=a})}).next(()=>{if(o.result)return;const a=new A1;return this.Ss(e,r,a).next(c=>{if(o.result=c,this.Vs)return this.bs(e,r,a,c.size)})}).next(()=>o.result)}bs(e,r,n,i){return n.documentReadCount<this.fs?(Ui()<=mt.DEBUG&&je("QueryEngine","SDK will not create cache indexes for query:",ji(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),xe.resolve()):(Ui()<=mt.DEBUG&&je("QueryEngine","Query:",ji(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(Ui()<=mt.DEBUG&&je("QueryEngine","The SDK decides to create cache indexes for query:",ji(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,sn(r))):xe.resolve())}ys(e,r){if(Jd(r))return xe.resolve(null);let n=sn(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=ic(r,null,"F"),n=sn(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const a=yt(...o);return this.ps.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,n).next(u=>{const h=this.Ds(r,c);return this.Cs(r,h,a,u.readTime)?this.ys(e,ic(r,null,"F")):this.vs(e,h,r,u)}))})))}ws(e,r,n,i){return Jd(r)||i.isEqual(rt.min())?xe.resolve(null):this.ps.getDocuments(e,n).next(o=>{const a=this.Ds(r,o);return this.Cs(r,a,n,i)?xe.resolve(null):(Ui()<=mt.DEBUG&&je("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ji(r)),this.vs(e,a,r,Y_(i,Jo)).next(c=>c))})}Ds(e,r){let n=new sr(ry(e));return r.forEach((i,o)=>{ja(e,o)&&(n=n.add(o))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(e,r,n){return Ui()<=mt.DEBUG&&je("QueryEngine","Using full collection scan to execute query:",ji(r)),this.ps.getDocumentsMatchingQuery(e,r,Kn.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(o=>(r.forEach(a=>{o=o.insert(a.key,a)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zc="LocalStore",E1=3e8;class x1{constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new Gt(ft),this.xs=new Ei(o=>zc(o),qc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new g1(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function T1(t,e,r,n){return new x1(t,e,r,n)}async function Iy(t,e){const r=it(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(o=>{const a=[],c=[];let u=yt();for(const h of i){a.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}for(const h of o){c.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}return r.localDocuments.getDocuments(n,u).next(h=>({Ls:h,removedBatchIds:a,addedBatchIds:c}))})})}function $1(t,e){const r=it(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),o=r.Ns.newChangeBuffer({trackRemovals:!0});return function(c,u,h,f){const g=h.batch,b=g.keys();let C=xe.resolve();return b.forEach(R=>{C=C.next(()=>f.getEntry(u,R)).next(T=>{const E=h.docVersions.get(R);Tt(E!==null,48541),T.version.compareTo(E)<0&&(g.applyToRemoteDocument(T,h),T.isValidDocument()&&(T.setReadTime(h.commitVersion),f.addEntry(T)))})}),C.next(()=>c.mutationQueue.removeMutationBatch(u,g))}(r,n,e,o).next(()=>o.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let u=yt();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function Ey(t){const e=it(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function k1(t,e){const r=it(t),n=e.snapshotVersion;let i=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const a=r.Ns.newChangeBuffer({trackRemovals:!0});i=r.Ms;const c=[];e.targetChanges.forEach((f,g)=>{const b=i.get(g);if(!b)return;c.push(r.Pi.removeMatchingKeys(o,f.removedDocuments,g).next(()=>r.Pi.addMatchingKeys(o,f.addedDocuments,g)));let C=b.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(g)!==null?C=C.withResumeToken(fr.EMPTY_BYTE_STRING,rt.min()).withLastLimboFreeSnapshotVersion(rt.min()):f.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(f.resumeToken,n)),i=i.insert(g,C),function(T,E,$){return T.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=E1?!0:$.addedDocuments.size+$.modifiedDocuments.size+$.removedDocuments.size>0}(b,C,f)&&c.push(r.Pi.updateTargetData(o,C))});let u=xn(),h=yt();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(r.persistence.referenceDelegate.updateLimboDocument(o,f))}),c.push(R1(o,a,e.documentUpdates).next(f=>{u=f.ks,h=f.qs})),!n.isEqual(rt.min())){const f=r.Pi.getLastRemoteSnapshotVersion(o).next(g=>r.Pi.setTargetsMetadata(o,o.currentSequenceNumber,n));c.push(f)}return xe.waitFor(c).next(()=>a.apply(o)).next(()=>r.localDocuments.getLocalViewOfDocuments(o,u,h)).next(()=>u)}).then(o=>(r.Ms=i,o))}function R1(t,e,r){let n=yt(),i=yt();return r.forEach(o=>n=n.add(o)),e.getEntries(t,n).next(o=>{let a=xn();return r.forEach((c,u)=>{const h=o.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(rt.min())?(e.removeEntry(c,u.readTime),a=a.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),a=a.insert(c,u)):je(Zc,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{ks:a,qs:i}})}function D1(t,e){const r=it(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Fc),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function N1(t,e){const r=it(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Pi.getTargetData(n,e).next(o=>o?(i=o,xe.resolve(i)):r.Pi.allocateTargetId(n).next(a=>(i=new Fn(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function cc(t,e,r){const n=it(t),i=n.Ms.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!ho(a))throw a;je(Zc,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function uh(t,e,r){const n=it(t);let i=rt.min(),o=yt();return n.persistence.runTransaction("Execute query","readwrite",a=>function(u,h,f){const g=it(u),b=g.xs.get(f);return b!==void 0?xe.resolve(g.Ms.get(b)):g.Pi.getTargetData(h,f)}(n,a,sn(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,c.targetId).next(u=>{o=u})}).next(()=>n.Fs.getDocumentsMatchingQuery(a,e,r?i:rt.min(),r?o:yt())).next(c=>(L1(n,_S(e),c),{documents:c,Qs:o})))}function L1(t,e,r){let n=t.Os.get(e)||rt.min();r.forEach((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),t.Os.set(e,n)}class dh{constructor(){this.activeTargetIds=IS()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class M1{constructor(){this.Mo=new dh,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new dh,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hh="ConnectivityMonitor";class mh{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){je(hh,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){je(hh,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ls=null;function uc(){return Ls===null?Ls=function(){return 268435456+Math.round(2147483648*Math.random())}():Ls++,"0x"+Ls.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gl="RestConnection",V1={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class B1{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===_a?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,o){const a=uc(),c=this.zo(e,r.toUriEncodedString());je(gl,`Sending RPC '${e}' ${a}:`,c,n);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,o);const{host:h}=new URL(c),f=so(h);return this.Jo(e,c,u,n,f).then(g=>(je(gl,`Received RPC '${e}' ${a}: `,g),g),g=>{throw Zi(gl,`RPC '${e}' ${a} failed with error: `,g,"url: ",c,"request:",n),g})}Ho(e,r,n,i,o,a){return this.Go(e,r,n,i,o)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+co}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>e[o]=i),n&&n.headers.forEach((i,o)=>e[o]=i)}zo(e,r){const n=V1[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F1{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const br="WebChannelConnection";class U1 extends B1{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,o){const a=uc();return new Promise((c,u)=>{const h=new Tf;h.setWithCredentials(!0),h.listenOnce($f.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Xs.NO_ERROR:const g=h.getResponseJson();je(br,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(g)),c(g);break;case Xs.TIMEOUT:je(br,`RPC '${e}' ${a} timed out`),u(new Fe(Ie.DEADLINE_EXCEEDED,"Request time out"));break;case Xs.HTTP_ERROR:const b=h.getStatus();if(je(br,`RPC '${e}' ${a} failed with status:`,b,"response text:",h.getResponseText()),b>0){let C=h.getResponseJson();Array.isArray(C)&&(C=C[0]);const R=C?.error;if(R&&R.status&&R.message){const T=function($){const K=$.toLowerCase().replace(/_/g,"-");return Object.values(Ie).indexOf(K)>=0?K:Ie.UNKNOWN}(R.status);u(new Fe(T,R.message))}else u(new Fe(Ie.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new Fe(Ie.UNAVAILABLE,"Connection failed."));break;default:et(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{je(br,`RPC '${e}' ${a} completed.`)}});const f=JSON.stringify(i);je(br,`RPC '${e}' ${a} sending request:`,i),h.send(r,"POST",f,n,15)})}T_(e,r,n){const i=uc(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Df(),c=Rf(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,r,n),u.encodeInitMessageHeaders=!0;const f=o.join("");je(br,`Creating RPC '${e}' stream ${i}: ${f}`,u);const g=a.createWebChannel(f,u);this.I_(g);let b=!1,C=!1;const R=new F1({Yo:E=>{C?je(br,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(b||(je(br,`Opening RPC '${e}' stream ${i} transport.`),g.open(),b=!0),je(br,`RPC '${e}' stream ${i} sending:`,E),g.send(E))},Zo:()=>g.close()}),T=(E,$,K)=>{E.listen($,Z=>{try{K(Z)}catch(J){setTimeout(()=>{throw J},0)}})};return T(g,ko.EventType.OPEN,()=>{C||(je(br,`RPC '${e}' stream ${i} transport opened.`),R.o_())}),T(g,ko.EventType.CLOSE,()=>{C||(C=!0,je(br,`RPC '${e}' stream ${i} transport closed`),R.a_(),this.E_(g))}),T(g,ko.EventType.ERROR,E=>{C||(C=!0,Zi(br,`RPC '${e}' stream ${i} transport errored. Name:`,E.name,"Message:",E.message),R.a_(new Fe(Ie.UNAVAILABLE,"The operation could not be completed")))}),T(g,ko.EventType.MESSAGE,E=>{if(!C){const $=E.data[0];Tt(!!$,16349);const K=$,Z=K?.error||K[0]?.error;if(Z){je(br,`RPC '${e}' stream ${i} received error:`,Z);const J=Z.status;let de=function(S){const v=tr[S];if(v!==void 0)return fy(v)}(J),re=Z.message;de===void 0&&(de=Ie.INTERNAL,re="Unknown error status: "+J+" with message "+Z.message),C=!0,R.a_(new Fe(de,re)),g.close()}else je(br,`RPC '${e}' stream ${i} received:`,$),R.u_($)}}),T(c,kf.STAT_EVENT,E=>{E.stat===Jl.PROXY?je(br,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===Jl.NOPROXY&&je(br,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{R.__()},0),R}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function pl(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ga(t){return new HS(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy{constructor(e,r,n=1e3,i=1.5,o=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&je("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fh="PersistentStream";class Ty{constructor(e,r,n,i,o,a,c,u){this.Mi=e,this.S_=n,this.b_=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new xy(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===Ie.RESOURCE_EXHAUSTED?(In(r.toString()),In("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===Ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===r&&this.G_(n,i)},n=>{e(()=>{const i=new Fe(Ie.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return je(fh,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(je(fh,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class j1 extends Ty{constructor(e,r,n,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=o}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=YS(this.serializer,e),n=function(o){if(!("targetChange"in o))return rt.min();const a=o.targetChange;return a.targetIds&&a.targetIds.length?rt.min():a.readTime?ln(a.readTime):rt.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=lc(this.serializer),r.addTarget=function(o,a){let c;const u=a.target;if(c=rc(u)?{documents:JS(o,u)}:{query:XS(o,u).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=py(o,a.resumeToken);const h=oc(o,a.expectedCount);h!==null&&(c.expectedCount=h)}else if(a.snapshotVersion.compareTo(rt.min())>0){c.readTime=Aa(o,a.snapshotVersion.toTimestamp());const h=oc(o,a.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);const n=e1(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=lc(this.serializer),r.removeTarget=e,this.q_(r)}}class z1 extends Ty{constructor(e,r,n,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Tt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Tt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Tt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=QS(e.writeResults,e.commitTime),n=ln(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=lc(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>KS(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q1{}class H1 extends q1{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Fe(Ie.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Go(e,sc(r,n),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Fe(Ie.UNKNOWN,o.toString())})}Ho(e,r,n,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Ho(e,sc(r,n),i,a,c,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Fe(Ie.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class G1{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(In(r),this.aa=!1):je("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ci="RemoteStore";class W1{constructor(e,r,n,i,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo(a=>{n.enqueueAndForget(async()=>{xi(this)&&(je(Ci,"Restarting streams for network reachability change."),await async function(u){const h=it(u);h.Ea.add(4),await fs(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Wa(h)}(this))})}),this.Ra=new G1(n,i)}}async function Wa(t){if(xi(t))for(const e of t.da)await e(!0)}async function fs(t){for(const e of t.da)await e(!1)}function $y(t,e){const r=it(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),nu(r)?ru(r):fo(r).O_()&&tu(r,e))}function eu(t,e){const r=it(t),n=fo(r);r.Ia.delete(e),n.O_()&&ky(r,e),r.Ia.size===0&&(n.O_()?n.L_():xi(r)&&r.Ra.set("Unknown"))}function tu(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(rt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}fo(t).Y_(e)}function ky(t,e){t.Va.Ue(e),fo(t).Z_(e)}function ru(t){t.Va=new US({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),fo(t).start(),t.Ra.ua()}function nu(t){return xi(t)&&!fo(t).x_()&&t.Ia.size>0}function xi(t){return it(t).Ea.size===0}function Ry(t){t.Va=void 0}async function Y1(t){t.Ra.set("Online")}async function K1(t){t.Ia.forEach((e,r)=>{tu(t,e)})}async function Q1(t,e){Ry(t),nu(t)?(t.Ra.ha(e),ru(t)):t.Ra.set("Unknown")}async function J1(t,e,r){if(t.Ra.set("Online"),e instanceof gy&&e.state===2&&e.cause)try{await async function(i,o){const a=o.cause;for(const c of o.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,a),i.Ia.delete(c),i.Va.removeTarget(c))}(t,e)}catch(n){je(Ci,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Ea(t,n)}else if(e instanceof ra?t.Va.Ze(e):e instanceof yy?t.Va.st(e):t.Va.tt(e),!r.isEqual(rt.min()))try{const n=await Ey(t.localStore);r.compareTo(n)>=0&&await function(o,a){const c=o.Va.Tt(a);return c.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const f=o.Ia.get(h);f&&o.Ia.set(h,f.withResumeToken(u.resumeToken,a))}}),c.targetMismatches.forEach((u,h)=>{const f=o.Ia.get(u);if(!f)return;o.Ia.set(u,f.withResumeToken(fr.EMPTY_BYTE_STRING,f.snapshotVersion)),ky(o,u);const g=new Fn(f.target,u,h,f.sequenceNumber);tu(o,g)}),o.remoteSyncer.applyRemoteEvent(c)}(t,r)}catch(n){je(Ci,"Failed to raise snapshot:",n),await Ea(t,n)}}async function Ea(t,e,r){if(!ho(e))throw e;t.Ea.add(1),await fs(t),t.Ra.set("Offline"),r||(r=()=>Ey(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{je(Ci,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await Wa(t)})}function Dy(t,e){return e().catch(r=>Ea(t,r,e))}async function Ya(t){const e=it(t),r=Zn(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Fc;for(;X1(e);)try{const i=await D1(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,Z1(e,i)}catch(i){await Ea(e,i)}Ny(e)&&Ly(e)}function X1(t){return xi(t)&&t.Ta.length<10}function Z1(t,e){t.Ta.push(e);const r=Zn(t);r.O_()&&r.X_&&r.ea(e.mutations)}function Ny(t){return xi(t)&&!Zn(t).x_()&&t.Ta.length>0}function Ly(t){Zn(t).start()}async function eP(t){Zn(t).ra()}async function tP(t){const e=Zn(t);for(const r of t.Ta)e.ea(r.mutations)}async function rP(t,e,r){const n=t.Ta.shift(),i=Wc.from(n,e,r);await Dy(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Ya(t)}async function nP(t,e){e&&Zn(t).X_&&await async function(n,i){if(function(a){return VS(a)&&a!==Ie.ABORTED}(i.code)){const o=n.Ta.shift();Zn(n).B_(),await Dy(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i)),await Ya(n)}}(t,e),Ny(t)&&Ly(t)}async function yh(t,e){const r=it(t);r.asyncQueue.verifyOperationInProgress(),je(Ci,"RemoteStore received new credentials");const n=xi(r);r.Ea.add(3),await fs(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await Wa(r)}async function iP(t,e){const r=it(t);e?(r.Ea.delete(2),await Wa(r)):e||(r.Ea.add(2),await fs(r),r.Ra.set("Unknown"))}function fo(t){return t.ma||(t.ma=function(r,n,i){const o=it(r);return o.sa(),new j1(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:Y1.bind(null,t),t_:K1.bind(null,t),r_:Q1.bind(null,t),H_:J1.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),nu(t)?ru(t):t.Ra.set("Unknown")):(await t.ma.stop(),Ry(t))})),t.ma}function Zn(t){return t.fa||(t.fa=function(r,n,i){const o=it(r);return o.sa(),new z1(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:eP.bind(null,t),r_:nP.bind(null,t),ta:tP.bind(null,t),na:rP.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Ya(t)):(await t.fa.stop(),t.Ta.length>0&&(je(Ci,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e,r,n,i,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new wn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,o){const a=Date.now()+n,c=new iu(e,r,a,i,o);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Fe(Ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ou(t,e){if(In("AsyncQueue",`${e}: ${t}`),ho(t))return new Fe(Ie.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{static emptySet(e){return new Ki(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||Qe.comparator(r.key,n.key):(r,n)=>Qe.comparator(r.key,n.key),this.keyedMap=Ro(),this.sortedSet=new Gt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Ki)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Ki;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gh{constructor(){this.ga=new Gt(Qe.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):et(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class io{constructor(e,r,n,i,o,a,c,u,h){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,r,n,i,o){const a=[];return r.forEach(c=>{a.push({type:0,doc:c})}),new io(e,r,Ki.emptySet(r),a,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ua(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oP{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class sP{constructor(){this.queries=ph(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=it(r),o=i.queries;i.queries=ph(),o.forEach((a,c)=>{for(const u of c.Sa)u.onError(n)})})(this,new Fe(Ie.ABORTED,"Firestore shutting down"))}}function ph(){return new Ei(t=>ty(t),Ua)}async function My(t,e){const r=it(t);let n=3;const i=e.query;let o=r.queries.get(i);o?!o.ba()&&e.Da()&&(n=2):(o=new oP,n=e.Da()?0:1);try{switch(n){case 0:o.wa=await r.onListen(i,!0);break;case 1:o.wa=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const c=ou(a,`Initialization of query '${ji(e.query)}' failed`);return void e.onError(c)}r.queries.set(i,o),o.Sa.push(e),e.va(r.onlineState),o.wa&&e.Fa(o.wa)&&su(r)}async function Oy(t,e){const r=it(t),n=e.query;let i=3;const o=r.queries.get(n);if(o){const a=o.Sa.indexOf(e);a>=0&&(o.Sa.splice(a,1),o.Sa.length===0?i=e.Da()?0:1:!o.ba()&&e.Da()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function aP(t,e){const r=it(t);let n=!1;for(const i of e){const o=i.query,a=r.queries.get(o);if(a){for(const c of a.Sa)c.Fa(i)&&(n=!0);a.wa=i}}n&&su(r)}function lP(t,e,r){const n=it(t),i=n.queries.get(e);if(i)for(const o of i.Sa)o.onError(r);n.queries.delete(e)}function su(t){t.Ca.forEach(e=>{e.next()})}var dc,vh;(vh=dc||(dc={})).Ma="default",vh.Cache="cache";class Vy{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new io(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=io.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==dc.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By{constructor(e){this.key=e}}class Fy{constructor(e){this.key=e}}class cP{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=yt(),this.mutatedKeys=yt(),this.eu=ry(e),this.tu=new Ki(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new gh,i=r?r.tu:this.tu;let o=r?r.mutatedKeys:this.mutatedKeys,a=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,g)=>{const b=i.get(f),C=ja(this.query,g)?g:null,R=!!b&&this.mutatedKeys.has(b.key),T=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let E=!1;b&&C?b.data.isEqual(C.data)?R!==T&&(n.track({type:3,doc:C}),E=!0):this.su(b,C)||(n.track({type:2,doc:C}),E=!0,(u&&this.eu(C,u)>0||h&&this.eu(C,h)<0)&&(c=!0)):!b&&C?(n.track({type:0,doc:C}),E=!0):b&&!C&&(n.track({type:1,doc:b}),E=!0,(u||h)&&(c=!0)),E&&(C?(a=a.add(C),o=T?o.add(f):o.delete(f)):(a=a.delete(f),o=o.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),o=o.delete(f.key),n.track({type:1,doc:f})}return{tu:a,iu:n,Cs:c,mutatedKeys:o}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((f,g)=>function(C,R){const T=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return et(20277,{Rt:E})}};return T(C)-T(R)}(f.type,g.type)||this.eu(f.doc,g.doc)),this.ou(n),i=i??!1;const c=r&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,h=u!==this.Za;return this.Za=u,a.length!==0||h?{snapshot:new io(this.query,e.tu,o,a,e.mutatedKeys,u===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new gh,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=yt(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new Fy(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new By(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=yt();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return io.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const au="SyncEngine";class uP{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class dP{constructor(e){this.key=e,this.hu=!1}}class hP{constructor(e,r,n,i,o,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Ei(c=>ty(c),Ua),this.Iu=new Map,this.Eu=new Set,this.du=new Gt(Qe.comparator),this.Au=new Map,this.Ru=new Qc,this.Vu={},this.mu=new Map,this.fu=no.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function mP(t,e,r=!0){const n=Gy(t);let i;const o=n.Tu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await Uy(n,e,r,!0),i}async function fP(t,e){const r=Gy(t);await Uy(r,e,!0,!1)}async function Uy(t,e,r,n){const i=await N1(t.localStore,sn(e)),o=i.targetId,a=t.sharedClientState.addLocalQueryTarget(o,r);let c;return n&&(c=await yP(t,e,o,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&$y(t.remoteStore,i),c}async function yP(t,e,r,n,i){t.pu=(g,b,C)=>async function(T,E,$,K){let Z=E.view.ru($);Z.Cs&&(Z=await uh(T.localStore,E.query,!1).then(({documents:I})=>E.view.ru(I,Z)));const J=K&&K.targetChanges.get(E.targetId),de=K&&K.targetMismatches.get(E.targetId)!=null,re=E.view.applyChanges(Z,T.isPrimaryClient,J,de);return _h(T,E.targetId,re.au),re.snapshot}(t,g,b,C);const o=await uh(t.localStore,e,!0),a=new cP(e,o.Qs),c=a.ru(o.documents),u=ms.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),h=a.applyChanges(c,t.isPrimaryClient,u);_h(t,r,h.au);const f=new uP(e,r,a);return t.Tu.set(e,f),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),h.snapshot}async function gP(t,e,r){const n=it(t),i=n.Tu.get(e),o=n.Iu.get(i.targetId);if(o.length>1)return n.Iu.set(i.targetId,o.filter(a=>!Ua(a,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await cc(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&eu(n.remoteStore,i.targetId),hc(n,i.targetId)}).catch(uo)):(hc(n,i.targetId),await cc(n.localStore,i.targetId,!0))}async function pP(t,e){const r=it(t),n=r.Tu.get(e),i=r.Iu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),eu(r.remoteStore,n.targetId))}async function vP(t,e,r){const n=AP(t);try{const i=await function(a,c){const u=it(a),h=zt.now(),f=c.reduce((C,R)=>C.add(R.key),yt());let g,b;return u.persistence.runTransaction("Locally write mutations","readwrite",C=>{let R=xn(),T=yt();return u.Ns.getEntries(C,f).next(E=>{R=E,R.forEach(($,K)=>{K.isValidDocument()||(T=T.add($))})}).next(()=>u.localDocuments.getOverlayedDocuments(C,R)).next(E=>{g=E;const $=[];for(const K of c){const Z=DS(K,g.get(K.key).overlayedDocument);Z!=null&&$.push(new oi(K.key,Z,Wf(Z.value.mapValue),an.exists(!0)))}return u.mutationQueue.addMutationBatch(C,h,$,c)}).next(E=>{b=E;const $=E.applyToLocalDocumentSet(g,T);return u.documentOverlayCache.saveOverlays(C,E.batchId,$)})}).then(()=>({batchId:b.batchId,changes:iy(g)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,c,u){let h=a.Vu[a.currentUser.toKey()];h||(h=new Gt(ft)),h=h.insert(c,u),a.Vu[a.currentUser.toKey()]=h}(n,i.batchId,r),await ys(n,i.changes),await Ya(n.remoteStore)}catch(i){const o=ou(i,"Failed to persist write");r.reject(o)}}async function jy(t,e){const r=it(t);try{const n=await k1(r.localStore,e);e.targetChanges.forEach((i,o)=>{const a=r.Au.get(o);a&&(Tt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?Tt(a.hu,14607):i.removedDocuments.size>0&&(Tt(a.hu,42227),a.hu=!1))}),await ys(r,n,e)}catch(n){await uo(n)}}function bh(t,e,r){const n=it(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach((o,a)=>{const c=a.view.va(e);c.snapshot&&i.push(c.snapshot)}),function(a,c){const u=it(a);u.onlineState=c;let h=!1;u.queries.forEach((f,g)=>{for(const b of g.Sa)b.va(c)&&(h=!0)}),h&&su(u)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function bP(t,e,r){const n=it(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Au.get(e),o=i&&i.key;if(o){let a=new Gt(Qe.comparator);a=a.insert(o,Pr.newNoDocument(o,rt.min()));const c=yt().add(o),u=new Ha(rt.min(),new Map,new Gt(ft),a,c);await jy(n,u),n.du=n.du.remove(o),n.Au.delete(e),lu(n)}else await cc(n.localStore,e,!1).then(()=>hc(n,e,r)).catch(uo)}async function _P(t,e){const r=it(t),n=e.batch.batchId;try{const i=await $1(r.localStore,e);qy(r,n,null),zy(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await ys(r,i)}catch(i){await uo(i)}}async function SP(t,e,r){const n=it(t);try{const i=await function(a,c){const u=it(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let f;return u.mutationQueue.lookupMutationBatch(h,c).next(g=>(Tt(g!==null,37113),f=g.keys(),u.mutationQueue.removeMutationBatch(h,g))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f)).next(()=>u.localDocuments.getDocuments(h,f))})}(n.localStore,e);qy(n,e,r),zy(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await ys(n,i)}catch(i){await uo(i)}}function zy(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function qy(t,e,r){const n=it(t);let i=n.Vu[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(r?o.reject(r):o.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function hc(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||Hy(t,n)})}function Hy(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(eu(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),lu(t))}function _h(t,e,r){for(const n of r)n instanceof By?(t.Ru.addReference(n.key,e),PP(t,n)):n instanceof Fy?(je(au,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||Hy(t,n.key)):et(19791,{wu:n})}function PP(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(je(au,"New document in limbo: "+r),t.Eu.add(n),lu(t))}function lu(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new Qe(Bt.fromString(e)),n=t.fu.next();t.Au.set(n,new dP(r)),t.du=t.du.insert(r,n),$y(t.remoteStore,new Fn(sn(Hc(r.path)),n,"TargetPurposeLimboResolution",Va.ce))}}async function ys(t,e,r){const n=it(t),i=[],o=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach((c,u)=>{a.push(n.pu(u,e,r).then(h=>{if((h||r)&&n.isPrimaryClient){const f=h?!h.fromCache:r?.targetChanges.get(u.targetId)?.current;n.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(h){i.push(h);const f=Xc.As(u.targetId,h);o.push(f)}}))}),await Promise.all(a),n.Pu.H_(i),await async function(u,h){const f=it(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>xe.forEach(h,b=>xe.forEach(b.Es,C=>f.persistence.referenceDelegate.addReference(g,b.targetId,C)).next(()=>xe.forEach(b.ds,C=>f.persistence.referenceDelegate.removeReference(g,b.targetId,C)))))}catch(g){if(!ho(g))throw g;je(Zc,"Failed to update sequence numbers: "+g)}for(const g of h){const b=g.targetId;if(!g.fromCache){const C=f.Ms.get(b),R=C.snapshotVersion,T=C.withLastLimboFreeSnapshotVersion(R);f.Ms=f.Ms.insert(b,T)}}}(n.localStore,o))}async function wP(t,e){const r=it(t);if(!r.currentUser.isEqual(e)){je(au,"User change. New user:",e.toKey());const n=await Iy(r.localStore,e);r.currentUser=e,function(o,a){o.mu.forEach(c=>{c.forEach(u=>{u.reject(new Fe(Ie.CANCELLED,a))})}),o.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await ys(r,n.Ls)}}function CP(t,e){const r=it(t),n=r.Au.get(e);if(n&&n.hu)return yt().add(n.key);{let i=yt();const o=r.Iu.get(e);if(!o)return i;for(const a of o){const c=r.Tu.get(a);i=i.unionWith(c.view.nu)}return i}}function Gy(t){const e=it(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=jy.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=CP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=bP.bind(null,e),e.Pu.H_=aP.bind(null,e.eventManager),e.Pu.yu=lP.bind(null,e.eventManager),e}function AP(t){const e=it(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=_P.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=SP.bind(null,e),e}class xa{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ga(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return T1(this.persistence,new I1,e.initialUser,this.serializer)}Cu(e){return new Ay(Jc.mi,this.serializer)}Du(e){return new M1}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}xa.provider={build:()=>new xa};class IP extends xa{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Tt(this.persistence.referenceDelegate instanceof Ia,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new d1(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?Er.withCacheSize(this.cacheSizeBytes):Er.DEFAULT;return new Ay(n=>Ia.mi(n,r),this.serializer)}}class mc{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>bh(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=wP.bind(null,this.syncEngine),await iP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new sP}()}createDatastore(e){const r=Ga(e.databaseInfo.databaseId),n=function(o){return new U1(o)}(e.databaseInfo);return function(o,a,c,u){return new H1(o,a,c,u)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,o,a,c){return new W1(n,i,o,a,c)}(this.localStore,this.datastore,e.asyncQueue,r=>bh(this.syncEngine,r,0),function(){return mh.v()?new mh:new O1}())}createSyncEngine(e,r){return function(i,o,a,c,u,h,f){const g=new hP(i,o,a,c,u,h);return f&&(g.gu=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(r){const n=it(r);je(Ci,"RemoteStore shutting down."),n.Ea.add(5),await fs(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}mc.provider={build:()=>new mc};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):In("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ei="FirestoreClient";class EP{constructor(e,r,n,i,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Sr.UNAUTHENTICATED,this.clientId=Bc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,async a=>{je(ei,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(je(ei,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new wn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=ou(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function vl(t,e){t.asyncQueue.verifyOperationInProgress(),je(ei,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await Iy(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Sh(t,e){t.asyncQueue.verifyOperationInProgress();const r=await xP(t);je(ei,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>yh(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>yh(e.remoteStore,i)),t._onlineComponents=e}async function xP(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){je(ei,"Using user provided OfflineComponentProvider");try{await vl(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===Ie.FAILED_PRECONDITION||i.code===Ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Zi("Error using user provided cache. Falling back to memory cache: "+r),await vl(t,new xa)}}else je(ei,"Using default OfflineComponentProvider"),await vl(t,new IP(void 0));return t._offlineComponents}async function Yy(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(je(ei,"Using user provided OnlineComponentProvider"),await Sh(t,t._uninitializedComponentsProvider._online)):(je(ei,"Using default OnlineComponentProvider"),await Sh(t,new mc))),t._onlineComponents}function TP(t){return Yy(t).then(e=>e.syncEngine)}async function Ky(t){const e=await Yy(t),r=e.eventManager;return r.onListen=mP.bind(null,e.syncEngine),r.onUnlisten=gP.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=fP.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=pP.bind(null,e.syncEngine),r}function $P(t,e,r={}){const n=new wn;return t.asyncQueue.enqueueAndForget(async()=>function(o,a,c,u,h){const f=new Wy({next:b=>{f.Nu(),a.enqueueAndForget(()=>Oy(o,g));const C=b.docs.has(c);!C&&b.fromCache?h.reject(new Fe(Ie.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&b.fromCache&&u&&u.source==="server"?h.reject(new Fe(Ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(b)},error:b=>h.reject(b)}),g=new Vy(Hc(c.path),f,{includeMetadataChanges:!0,qa:!0});return My(o,g)}(await Ky(t),t.asyncQueue,e,r,n)),n.promise}function kP(t,e,r={}){const n=new wn;return t.asyncQueue.enqueueAndForget(async()=>function(o,a,c,u,h){const f=new Wy({next:b=>{f.Nu(),a.enqueueAndForget(()=>Oy(o,g)),b.fromCache&&u.source==="server"?h.reject(new Fe(Ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(b)},error:b=>h.reject(b)}),g=new Vy(c,f,{includeMetadataChanges:!0,qa:!0});return My(o,g)}(await Ky(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qy(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ph=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jy="firestore.googleapis.com",wh=!0;class Ch{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Fe(Ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Jy,this.ssl=wh}else this.host=e.host,this.ssl=e.ssl??wh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Cy;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<c1)throw new Fe(Ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}W_("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Qy(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Fe(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Fe(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Fe(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ka{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ch({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Fe(Ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Fe(Ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ch(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new O_;switch(n.type){case"firstParty":return new U_(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Fe(Ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=Ph.get(r);n&&(je("ComponentProvider","Removing Datastore"),Ph.delete(r),n.terminate())}(this),Promise.resolve()}}function RP(t,e,r,n={}){t=En(t,Ka);const i=so(e),o=t._getSettings(),a={...o,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${r}`;i&&(Bm(`https://${c}`),Fm("Firestore",!0)),o.host!==Jy&&o.host!==c&&Zi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...o,host:c,ssl:i,emulatorOptions:n};if(!_i(u,a)&&(t._setSettings(u),n.mockUserToken)){let h,f;if(typeof n.mockUserToken=="string")h=n.mockUserToken,f=Sr.MOCK_USER;else{h=av(n.mockUserToken,t._app?.options.projectId);const g=n.mockUserToken.sub||n.mockUserToken.user_id;if(!g)throw new Fe(Ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Sr(g)}t._authCredentials=new V_(new Lf(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Ti(this.firestore,e,this._query)}}class Qt{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Yn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Qt(this.firestore,e,this._key)}toJSON(){return{type:Qt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(ds(r,Qt._jsonSchema))return new Qt(e,n||null,new Qe(Bt.fromString(r.referencePath)))}}Qt._jsonSchemaVersion="firestore/documentReference/1.0",Qt._jsonSchema={type:nr("string",Qt._jsonSchemaVersion),referencePath:nr("string")};class Yn extends Ti{constructor(e,r,n){super(e,r,Hc(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Qt(this.firestore,null,new Qe(e))}withConverter(e){return new Yn(this.firestore,e,this._path)}}function DP(t,e,...r){if(t=mr(t),Mf("collection","path",e),t instanceof Ka){const n=Bt.fromString(e,...r);return Od(n),new Yn(t,null,n)}{if(!(t instanceof Qt||t instanceof Yn))throw new Fe(Ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Bt.fromString(e,...r));return Od(n),new Yn(t.firestore,null,n)}}function Xy(t,e,...r){if(t=mr(t),arguments.length===1&&(e=Bc.newId()),Mf("doc","path",e),t instanceof Ka){const n=Bt.fromString(e,...r);return Md(n),new Qt(t,null,new Qe(n))}{if(!(t instanceof Qt||t instanceof Yn))throw new Fe(Ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Bt.fromString(e,...r));return Md(n),new Qt(t.firestore,t instanceof Yn?t.converter:null,new Qe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ah="AsyncQueue";class Ih{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new xy(this,"async_queue_retry"),this._c=()=>{const n=pl();n&&je(Ah,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=pl();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=pl();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new wn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ho(e))throw e;je(Ah,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,In("INTERNAL UNHANDLED ERROR: ",Eh(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=iu.createAndSchedule(this,e,r,n,o=>this.hc(o));return this.tc.push(i),i}uc(){this.nc&&et(47125,{Pc:Eh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function Eh(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class gs extends Ka{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new Ih,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Ih(e),this._firestoreClient=void 0,await e}}}function NP(t,e){const r=typeof t=="object"?t:qm(),n=typeof t=="string"?t:_a,i=Ec(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const o=ov("firestore");o&&RP(i,...o)}return i}function cu(t){if(t._terminated)throw new Fe(Ie.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||LP(t),t._firestoreClient}function LP(t){const e=t._freezeSettings(),r=function(i,o,a,c){return new iS(i,o,a,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,Qy(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new EP(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(i){const o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Br(fr.fromBase64String(e))}catch(r){throw new Fe(Ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Br(fr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Br._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ds(e,Br._jsonSchema))return Br.fromBase64String(e.bytes)}}Br._jsonSchemaVersion="firestore/bytes/1.0",Br._jsonSchema={type:nr("string",Br._jsonSchemaVersion),bytes:nr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Fe(Ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new dr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Fe(Ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Fe(Ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ft(this._lat,e._lat)||ft(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:cn._jsonSchemaVersion}}static fromJSON(e){if(ds(e,cn._jsonSchema))return new cn(e.latitude,e.longitude)}}cn._jsonSchemaVersion="firestore/geoPoint/1.0",cn._jsonSchema={type:nr("string",cn._jsonSchemaVersion),latitude:nr("number"),longitude:nr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:un._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ds(e,un._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new un(e.vectorValues);throw new Fe(Ie.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}un._jsonSchemaVersion="firestore/vectorValue/1.0",un._jsonSchema={type:nr("string",un._jsonSchemaVersion),vectorValues:nr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MP=/^__.*__$/;class OP{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new oi(e,this.data,this.fieldMask,r,this.fieldTransforms):new hs(e,this.data,r,this.fieldTransforms)}}class Zy{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new oi(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function eg(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw et(40011,{Ac:t})}}class du{constructor(e,r,n,i,o,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new du({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Ta(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(eg(this.Ac)&&MP.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class VP{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Ga(e)}Cc(e,r,n,i=!1){return new du({Ac:e,methodName:r,Dc:n,path:dr.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function hu(t){const e=t._freezeSettings(),r=Ga(t._databaseId);return new VP(t._databaseId,!!e.ignoreUndefinedProperties,r)}function BP(t,e,r,n,i,o={}){const a=t.Cc(o.merge||o.mergeFields?2:0,e,r,i);mu("Data must be an object, but it was:",a,n);const c=tg(n,a);let u,h;if(o.merge)u=new Rr(a.fieldMask),h=a.fieldTransforms;else if(o.mergeFields){const f=[];for(const g of o.mergeFields){const b=fc(e,g,r);if(!a.contains(b))throw new Fe(Ie.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);ng(f,b)||f.push(b)}u=new Rr(f),h=a.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,h=a.fieldTransforms;return new OP(new xr(c),u,h)}class Ja extends uu{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ja}}function FP(t,e,r,n){const i=t.Cc(1,e,r);mu("Data must be an object, but it was:",i,n);const o=[],a=xr.empty();ii(n,(u,h)=>{const f=fu(e,u,r);h=mr(h);const g=i.yc(f);if(h instanceof Ja)o.push(f);else{const b=ps(h,g);b!=null&&(o.push(f),a.set(f,b))}});const c=new Rr(o);return new Zy(a,c,i.fieldTransforms)}function UP(t,e,r,n,i,o){const a=t.Cc(1,e,r),c=[fc(e,n,r)],u=[i];if(o.length%2!=0)throw new Fe(Ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let b=0;b<o.length;b+=2)c.push(fc(e,o[b])),u.push(o[b+1]);const h=[],f=xr.empty();for(let b=c.length-1;b>=0;--b)if(!ng(h,c[b])){const C=c[b];let R=u[b];R=mr(R);const T=a.yc(C);if(R instanceof Ja)h.push(C);else{const E=ps(R,T);E!=null&&(h.push(C),f.set(C,E))}}const g=new Rr(h);return new Zy(f,g,a.fieldTransforms)}function jP(t,e,r,n=!1){return ps(r,t.Cc(n?4:3,e))}function ps(t,e){if(rg(t=mr(t)))return mu("Unsupported field value:",e,t),tg(t,e);if(t instanceof uu)return function(n,i){if(!eg(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const o=[];let a=0;for(const c of n){let u=ps(c,i.wc(a));u==null&&(u={nullValue:"NULL_VALUE"}),o.push(u),a++}return{arrayValue:{values:o}}}(t,e)}return function(n,i){if((n=mr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return ES(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=zt.fromDate(n);return{timestampValue:Aa(i.serializer,o)}}if(n instanceof zt){const o=new zt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Aa(i.serializer,o)}}if(n instanceof cn)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Br)return{bytesValue:py(i.serializer,n._byteString)};if(n instanceof Qt){const o=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(o))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Kc(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof un)return function(a,c){return{mapValue:{fields:{[Hf]:{stringValue:Gf},[Sa]:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return Gc(c.serializer,h)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${Oa(n)}`)}(t,e)}function tg(t,e){const r={};return Bf(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ii(t,(n,i)=>{const o=ps(i,e.mc(n));o!=null&&(r[n]=o)}),{mapValue:{fields:r}}}function rg(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof zt||t instanceof cn||t instanceof Br||t instanceof Qt||t instanceof uu||t instanceof un)}function mu(t,e,r){if(!rg(r)||!Of(r)){const n=Oa(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function fc(t,e,r){if((e=mr(e))instanceof Qa)return e._internalPath;if(typeof e=="string")return fu(t,e);throw Ta("Field path arguments must be of type string or ",t,!1,void 0,r)}const zP=new RegExp("[~\\*/\\[\\]]");function fu(t,e,r){if(e.search(zP)>=0)throw Ta(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Qa(...e.split("."))._internalPath}catch{throw Ta(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Ta(t,e,r,n,i){const o=n&&!n.isEmpty(),a=i!==void 0;let c=`Function ${e}() called with invalid data`;r&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(o||a)&&(u+=" (found",o&&(u+=` in field ${n}`),a&&(u+=` in document ${i}`),u+=")"),new Fe(Ie.INVALID_ARGUMENT,c+t+u)}function ng(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ig{constructor(e,r,n,i,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Qt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new qP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(yu("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class qP extends ig{data(){return super.data()}}function yu(t,e){return typeof e=="string"?fu(t,e):e instanceof Qa?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HP(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Fe(Ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class gu{}class og extends gu{}function GP(t,e,...r){let n=[];e instanceof gu&&n.push(e),n=n.concat(r),function(o){const a=o.filter(u=>u instanceof vu).length,c=o.filter(u=>u instanceof pu).length;if(a>1||a>0&&c>0)throw new Fe(Ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class pu extends og{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new pu(e,r,n)}_apply(e){const r=this._parse(e);return sg(e._query,r),new Ti(e.firestore,e.converter,nc(e._query,r))}_parse(e){const r=hu(e.firestore);return function(o,a,c,u,h,f,g){let b;if(h.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new Fe(Ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){Th(g,f);const R=[];for(const T of g)R.push(xh(u,o,T));b={arrayValue:{values:R}}}else b=xh(u,o,g)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||Th(g,f),b=jP(c,a,g,f==="in"||f==="not-in");return rr.create(h,f,b)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}class vu extends gu{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new vu(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Kr.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,o){let a=i;const c=o.getFlattenedFilters();for(const u of c)sg(a,u),a=nc(a,u)}(e._query,r),new Ti(e.firestore,e.converter,nc(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class bu extends og{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new bu(e,r)}_apply(e){const r=function(i,o,a){if(i.startAt!==null)throw new Fe(Ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Fe(Ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ts(o,a)}(e._query,this._field,this._direction);return new Ti(e.firestore,e.converter,function(i,o){const a=i.explicitOrderBy.concat([o]);return new mo(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}function WP(t,e="asc"){const r=e,n=yu("orderBy",t);return bu._create(n,r)}function xh(t,e,r){if(typeof(r=mr(r))=="string"){if(r==="")throw new Fe(Ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ey(e)&&r.indexOf("/")!==-1)throw new Fe(Ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Bt.fromString(r));if(!Qe.isDocumentKey(n))throw new Fe(Ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Hd(t,new Qe(n))}if(r instanceof Qt)return Hd(t,r._key);throw new Fe(Ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Oa(r)}.`)}function Th(t,e){if(!Array.isArray(t)||t.length===0)throw new Fe(Ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function sg(t,e){const r=function(i,o){for(const a of i)for(const c of a.getFlattenedFilters())if(o.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Fe(Ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Fe(Ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class YP{convertValue(e,r="none"){switch(Xn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Kt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Jn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw et(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return ii(e,(i,o)=>{n[i]=this.convertValue(o,r)}),n}convertVectorValue(e){const r=e.fields?.[Sa].arrayValue?.values?.map(n=>Kt(n.doubleValue));return new un(r)}convertGeoPoint(e){return new cn(Kt(e.latitude),Kt(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Fa(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Xo(e));default:return null}}convertTimestamp(e){const r=Qn(e);return new zt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Bt.fromString(e);Tt(wy(n),9688,{name:e});const i=new Zo(n.get(1),n.get(3)),o=new Qe(n.popFirst(5));return i.isEqual(r)||In(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KP(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class No{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class bi extends ig{constructor(e,r,n,i,o,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new na(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(yu("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Fe(Ie.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=bi._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}bi._jsonSchemaVersion="firestore/documentSnapshot/1.0",bi._jsonSchema={type:nr("string",bi._jsonSchemaVersion),bundleSource:nr("string","DocumentSnapshot"),bundleName:nr("string"),bundle:nr("string")};class na extends bi{data(e={}){return super.data(e)}}class Qi{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new No(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new na(this._firestore,this._userDataWriter,n.key,n,new No(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Fe(Ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(c=>{const u=new na(i._firestore,i._userDataWriter,c.doc.key,c.doc,new No(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>o||c.type!==3).map(c=>{const u=new na(i._firestore,i._userDataWriter,c.doc.key,c.doc,new No(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,f=-1;return c.type!==0&&(h=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),f=a.indexOf(c.doc.key)),{type:QP(c.type),doc:u,oldIndex:h,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Fe(Ie.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Qi._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Bc.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function QP(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return et(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JP(t){t=En(t,Qt);const e=En(t.firestore,gs);return $P(cu(e),t._key).then(r=>ew(e,t,r))}Qi._jsonSchemaVersion="firestore/querySnapshot/1.0",Qi._jsonSchema={type:nr("string",Qi._jsonSchemaVersion),bundleSource:nr("string","QuerySnapshot"),bundleName:nr("string"),bundle:nr("string")};class ag extends YP{constructor(e){super(),this.firestore=e}convertBytes(e){return new Br(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Qt(this.firestore,null,r)}}function XP(t){t=En(t,Ti);const e=En(t.firestore,gs),r=cu(e),n=new ag(e);return HP(t._query),kP(r,t._query).then(i=>new Qi(e,n,t,i))}function ZP(t,e,r){t=En(t,Qt);const n=En(t.firestore,gs),i=KP(t.converter,e);return cg(n,[BP(hu(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,an.none())])}function lg(t,e,r,...n){t=En(t,Qt);const i=En(t.firestore,gs),o=hu(i);let a;return a=typeof(e=mr(e))=="string"||e instanceof Qa?UP(o,"updateDoc",t._key,e,r,n):FP(o,"updateDoc",t._key,e),cg(i,[a.toMutation(t._key,an.exists(!0))])}function cg(t,e){return function(n,i){const o=new wn;return n.asyncQueue.enqueueAndForget(async()=>vP(await TP(n),i,o)),o.promise}(cu(t),e)}function ew(t,e,r){const n=r.docs.get(e._key),i=new ag(t);return new bi(t,i,e._key,n,new No(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){co=i})(ao),Ji(new Si("firestore",(n,{instanceIdentifier:i,options:o})=>{const a=n.getProvider("app").getImmediate(),c=new gs(new B_(n.getProvider("auth-internal")),new j_(a,n.getProvider("app-check-internal")),function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Fe(Ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zo(h.options.projectId,f)}(a,i),a);return o={useFetchStreams:r,...o},c._setSettings(o),c},"PUBLIC").setMultipleInstances(!0)),Hn(Rd,Dd,e),Hn(Rd,Dd,"esm2020")})();let tw="eyAiYXBpS2V5IjogIkFJemFTeUJBbGN2WlRMMXRsQ05LRExENEJpTWJhR01iTnhCRjQtTSIsICAiYXV0aERvbWFpbiI6ICJocm0tMTEyOC5maXJlYmFzZWFwcC5jb20iLCAgImRhdGFiYXNlVVJMIjogImh0dHBzOi8vaHJtLTExMjguZmlyZWJhc2Vpby5jb20iLCAgInByb2plY3RJZCI6ICJocm0tMTEyOCIsICAic3RvcmFnZUJ1Y2tldCI6ICJocm0tMTEyOC5hcHBzcG90LmNvbSIsICAibWVzc2FnaW5nU2VuZGVySWQiOiAiMTA0OTI1MDU4NTI0NSIsICAiYXBwSWQiOiAiMToxMDQ5MjUwNTg1MjQ1OndlYjowZGFkMDAyMDI3MjM1MTRjY2M1Mjc0In0=";const ug=zm(JSON.parse(Wp(tw))),yi=D_(ug),$a=new nn,yc=NP(ug);$a.addScope("profile");$a.addScope("email");class Lo extends Error{}Lo.prototype.name="InvalidTokenError";function rw(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function nw(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return rw(e)}catch{return atob(e)}}function iw(t,e){if(typeof t!="string")throw new Lo("Invalid token specified: must be a string");e||(e={});const r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new Lo(`Invalid token specified: missing part #${r+1}`);let i;try{i=nw(n)}catch(o){throw new Lo(`Invalid token specified: invalid base64 for part #${r+1} (${o.message})`)}try{return JSON.parse(i)}catch(o){throw new Lo(`Invalid token specified: invalid json for part #${r+1} (${o.message})`)}}const ow={clientId:"195275085181-8ccjpgp8v1g80qhnlk6v4lpgid7n81gr.apps.googleusercontent.com"},sw=t=>{const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>{window.google&&window.google.accounts.id.initialize({client_id:ow.clientId,callback:r=>{t(r.credential)},auto_select:!1,cancel_on_tap_outside:!0})},document.head.appendChild(e)},aw=t=>iw(t),lw=()=>{window.google&&window.google.accounts.id.disableAutoSelect()},[cw,uw]=Rm({}),dw=async()=>{const e=await Un({query:"qcm42351987"});if(e&&!e.error){let n=Object.assign({},{},e);uw(n)}return 1},hw=async t=>{let e=cw?.[992002];e&&(e.params={tkn:t},await Un(e))},[Oi,_r]=Rm({user:null,loading:!0,error:null,authMethod:null}),[dg,$h]=ge(null);_0(yi,t=>{t?_r({user:t,loading:!1,error:null,authMethod:"firebase"}):dg()||_r({user:null,loading:!1,error:null,authMethod:null})});K0(yi).then(t=>{t&&_r({user:t.user,loading:!1,error:null,authMethod:"firebase"})}).catch(t=>{console.error("Redirect sign-in error:",t),_r({loading:!1,error:t.message})});const Et={get state(){return Oi},async getUserProfile(t){try{const e=Xy(yc,"users",t),r=await JP(e);if(r.exists()){_r("profile",r.data());let n={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1},i=r.data(),o={};return Object.keys(n).map(a=>{let c=n?.[a];i.hasOwnProperty(a)||(o[a]=c)}),Object.keys(o).length>0&&lg(e,o),r.data()}else{let n=Et?.state?.user,i={uid:n?.uid,email:n?.email,displayName:n?.displayName,createdAt:new Date,stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};return await ZP(e,i),console.log("No such user profile!"),null}}catch(e){return console.error("Error fetching user profile:",e),null}},hasPermission:t=>{const e=Et.state?.profile;return e.isAdmin?!0:e?e[t]===!0:!1},async signInWithGoogle(){try{_r("loading",!0),_r("error",null);try{const t=await U0(yi,$a);_r({user:t.user,loading:!1,error:null,authMethod:"firebase"});try{Et.getUserProfile(t.user.uid)}catch(e){console.error("firestore error:",e)}}catch(t){if(t.code==="auth/popup-blocked")await W0(yi,$a);else throw t}}catch(t){console.error("Sign-in error:",t),_r({loading:!1,error:t.message||"Failed to sign in with Google"})}},async signInWithGoogleP(t){const r=await Un({params:{id_token:t},query:"getGoogleUserbyToken"});if(r&&r){let n=new Date().getTime(),i=new Date(n+6e4*60*24*365),o="hrm_tkn_acc";document.cookie=`${o}=${r.data}; expires=${i}; path=/;g_state = {"i_l":1,"i_p":${i}}; ssgl_access_tkn = ${t}`,document.cookie=`ssgl_access_tkn = ${t}; expires=${i};`,await dw(),hw(r.data)}},async signInWithGoogleCloud(t){try{_r("loading",!0),_r("error",null);const e=aw(t),r={uid:e.sub,email:e.email,displayName:e.name,photoURL:e.picture};$h(r);const n={uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,emailVerified:!0};_r({user:n,loading:!1,error:null,authMethod:"google-cloud"});try{const i=nn.credential(t);await p0(yi,i)}catch{console.log("Firebase sign-in optional, continuing with Google Cloud auth")}}catch(e){console.error("Google Cloud sign-in error:",e),_r({loading:!1,error:e.message||"Failed to sign in with Google Cloud"})}},async signOut(){try{_r("loading",!0),(Oi.authMethod==="firebase"||yi.currentUser)&&await S0(yi),Oi.authMethod==="google-cloud"&&(lw(),$h(null)),_r({user:null,loading:!1,error:null,authMethod:null})}catch(t){console.error("Sign-out error:",t),_r({loading:!1,error:t.message||"Failed to sign out"})}},get isAuthenticated(){return!!Oi.user||!!dg()},get currentUser(){return Oi.user},get authMethod(){return Oi.authMethod}};var mw=G("<p>"),fw=G('<div><div><div><h1>HRM Finance</h1><p>Complete Business Management Solution</p><div><div><button><svg width=24 height=24 viewBox="0 0 24 24"><path fill=#4285F4 d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path><path fill=#34A853 d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path><path fill=#FBBC05 d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path><path fill=#EA4335 d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path></svg></button><p>Firebase Authentication</p></div></div></div><div><div><div>💰</div><h3>Financial Management</h3><p>Complete chart of accounts, balance sheets, journal entries, and invoice management in one place.</p></div><div><div>👥</div><h3>HR Management</h3><p>Track employees, manage onboarding, and monitor your workforce with powerful analytics.</p></div><div><div>📦</div><h3>Inventory Control</h3><p>Real-time inventory tracking, product management, and movement history across multiple locations.</p></div><div><div>🏦</div><h3>Banking Integration</h3><p>Streamline bank reconciliation with CSV imports and automated consolidation features.</p></div><div><div>📊</div><h3>Real-time Analytics</h3><p>Get instant insights with dashboards showing revenue, cash flow, and business performance.</p></div><div><div>🌐</div><h3>Multi-language Support</h3><p>Available in multiple languages to support your global business operations.</p></div></div><div><p>Secure authentication powered by Google • Your data is encrypted and protected</p><p>Choose your preferred authentication method above');const yw=()=>{Qr(()=>{sw(E=>{Et.signInWithGoogleP(E)}),setTimeout(()=>{},100)});const t={"min-height":"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},e={background:"white","border-radius":"1rem","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","max-width":"1200px",width:"100%",overflow:"hidden"},r={padding:"3rem","text-align":"center","border-bottom":"1px solid #e2e8f0"},n={"font-size":"2.5rem","font-weight":"800",color:"#1a202c","margin-bottom":"1rem"},i={"font-size":"1.125rem",color:"#718096","margin-bottom":"2rem"},o={display:"flex","flex-direction":"column",gap:"1rem","align-items":"center","margin-bottom":"1rem"},a={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"2rem",padding:"3rem"},c={"text-align":"center",padding:"2rem","border-radius":"0.5rem",background:"#f7fafc",transition:"transform 0.2s",cursor:"default"},u={"font-size":"3rem","margin-bottom":"1rem"},h={"font-size":"1.25rem","font-weight":"600",color:"#2d3748","margin-bottom":"0.5rem"},f={color:"#718096","line-height":"1.6"},g={display:"inline-flex","align-items":"center",gap:"0.75rem",background:"white",color:"#4285f4",border:"2px solid #4285f4",padding:"0.75rem 2rem","font-size":"1.125rem","font-weight":"500","border-radius":"0.5rem",cursor:"pointer",transition:"all 0.2s","min-width":"250px","justify-content":"center"},b={color:"#e53e3e","margin-top":"1rem","font-size":"0.875rem"},C={background:"#f7fafc",padding:"2rem","text-align":"center",color:"#718096","font-size":"0.875rem"},R={"font-size":"0.75rem",color:"#718096","margin-top":"0.25rem","font-style":"italic"},T=()=>{Et.signInWithGoogle()};return(()=>{var E=fw(),$=E.firstChild,K=$.firstChild,Z=K.firstChild,J=Z.nextSibling,de=J.nextSibling,re=de.firstChild,I=re.firstChild;I.firstChild;var S=I.nextSibling,v=K.nextSibling,w=v.firstChild,P=w.firstChild,A=P.nextSibling,y=A.nextSibling,se=w.nextSibling,W=se.firstChild,k=W.nextSibling,H=k.nextSibling,V=se.nextSibling,O=V.firstChild,D=O.nextSibling,M=D.nextSibling,he=V.nextSibling,z=he.firstChild,pe=z.nextSibling,x=pe.nextSibling,F=he.nextSibling,ee=F.firstChild,Q=ee.nextSibling,ue=Q.nextSibling,te=F.nextSibling,B=te.firstChild,ae=B.nextSibling,ve=ae.nextSibling,be=v.nextSibling,oe=be.firstChild,ce=oe.nextSibling;return d(E,t),d($,e),d(K,r),d(Z,n),d(J,i),d(de,o),I.addEventListener("mouseleave",Y=>{Y.currentTarget.style.background="white",Y.currentTarget.style.color="#4285f4"}),I.addEventListener("mouseenter",Y=>{Y.currentTarget.style.background="#4285f4",Y.currentTarget.style.color="white"}),I.$$click=T,d(I,g),s(I,_(Le,{get when(){return Et.state.loading},fallback:"Sign in with Google",children:"Signing in..."}),null),d(S,R),s(K,_(Le,{get when(){return Et.state.error},get children(){var Y=mw();return d(Y,b),s(Y,()=>Et.state.error),Y}}),null),d(v,a),d(be,C),ce.style.setProperty("margin-top","0.5rem"),ce.style.setProperty("font-size","0.75rem"),ie(Y=>{var q=Et.state.loading,N=c,ne=u,fe=h,U=f,j=c,Se=u,we=h,le=f,ye=c,X=u,Pe=h,ke=f,Te=c,$e=u,Ue=h,Ye=f,ze=c,Ee=u,Me=h,Ke=f,Ge=c,He=u,Ae=h,st=f;return q!==Y.e&&(I.disabled=Y.e=q),Y.t=d(w,N,Y.t),Y.a=d(P,ne,Y.a),Y.o=d(A,fe,Y.o),Y.i=d(y,U,Y.i),Y.n=d(se,j,Y.n),Y.s=d(W,Se,Y.s),Y.h=d(k,we,Y.h),Y.r=d(H,le,Y.r),Y.d=d(V,ye,Y.d),Y.l=d(O,X,Y.l),Y.u=d(D,Pe,Y.u),Y.c=d(M,ke,Y.c),Y.w=d(he,Te,Y.w),Y.m=d(z,$e,Y.m),Y.f=d(pe,Ue,Y.f),Y.y=d(x,Ye,Y.y),Y.g=d(F,ze,Y.g),Y.p=d(ee,Ee,Y.p),Y.b=d(Q,Me,Y.b),Y.T=d(ue,Ke,Y.T),Y.A=d(te,Ge,Y.A),Y.O=d(B,He,Y.O),Y.I=d(ae,Ae,Y.I),Y.S=d(ve,st,Y.S),Y},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0}),E})()};_t(["click"]);var gw=G("<div><div>");const pw=t=>{const e={"min-height":"100vh",display:"flex","align-items":"center","justify-content":"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},r={width:"50px",height:"50px",border:"3px solid rgba(255, 255, 255, 0.3)","border-top-color":"white","border-radius":"50%",animation:"spin 1s linear infinite"},n=document.createElement("style");return n.textContent=`
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  `,document.head.appendChild(n),ri(()=>{Et.state?.user?.uid&&Et.getUserProfile(Et.state?.user?.uid)}),Qr(()=>{}),_(Le,{get when(){return!Et.state.loading},get fallback(){return(()=>{var i=gw(),o=i.firstChild;return d(i,e),d(o,r),i})()},get children(){return _(Le,{get when(){return Et.isAuthenticated},get fallback(){return _(yw,{})},get children(){return t.children}})}})};var vw=G("<button>");const De=t=>{const e=()=>{const r={"font-family":"inherit",cursor:t.disabled?"not-allowed":"pointer",border:"none","border-radius":"var(--border-radius-sm)","font-weight":"500",transition:"all 0.2s ease","text-decoration":"none",display:"inline-flex","align-items":"center","justify-content":"center",gap:"0.5rem",opacity:t.disabled?"0.6":"1"},n={sm:{padding:"0.5rem 1rem","font-size":"0.875rem"},md:{padding:"0.75rem 1.5rem","font-size":"1rem"},lg:{padding:"1rem 2rem","font-size":"1.125rem"}},i={primary:{background:"linear-gradient(135deg, var(--primary-color), var(--primary-dark))",color:"white","box-shadow":"var(--shadow-sm)"},secondary:{background:"var(--surface-color)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},outline:{background:"transparent",color:"var(--primary-color)",border:"1px solid var(--primary-color)"}};return{...r,...n[t.size||"md"],...i[t.variant||"primary"]}};return(()=>{var r=vw();return Ai(r,"click",t.onClick,!0),s(r,()=>t.children),ie(n=>{var i=e(),o=t.disabled,a=t.type||"button",c=`btn btn-${t.variant||"primary"} ${t.className||""}`;return n.e=d(r,i,n.e),o!==n.t&&(r.disabled=n.t=o),a!==n.a&&lt(r,"type",n.a=a),c!==n.o&&Sc(r,n.o=c),n},{e:void 0,t:void 0,a:void 0,o:void 0}),r})()};_t(["click"]);var bw=G("<div><div><div><h2></h2><button>×</button></div><div>");const yr=t=>{const e={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},r={background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","max-width":"920px",width:"90%","max-height":"80vh",overflow:"auto",position:"relative"},n={padding:"1.5rem","border-bottom":"1px solid var(--border-color)",display:"flex","justify-content":"space-between","align-items":"center"},i={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},o={background:"none",border:"none","font-size":"1.5rem",cursor:"pointer",color:"var(--text-muted)",padding:"0.5rem","border-radius":"var(--border-radius-sm)"},a={padding:"1.5rem"},c=u=>{u.target===u.currentTarget&&t.onClose()};return _(Le,{get when(){return t.isOpen},get children(){var u=bw(),h=u.firstChild,f=h.firstChild,g=f.firstChild,b=g.nextSibling,C=f.nextSibling;return u.$$click=c,d(f,n),d(g,i),s(g,()=>t.title),b.addEventListener("mouseleave",R=>R.target.style.background="none"),b.addEventListener("mouseenter",R=>R.target.style.background="var(--background-color)"),Ai(b,"click",t.onClose,!0),d(b,o),d(C,a),s(C,()=>t.children),ie(R=>{var T=e,E=r;return R.e=d(u,T,R.e),R.t=d(h,E,R.t),R},{e:void 0,t:void 0}),u}})};_t(["click"]);var kh=G("<div>"),_w=G("<h3>"),Sw=G("<p>");const We=t=>{const e={background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"1.5rem","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",transition:"all 0.2s ease",cursor:t.onClick?"pointer":"default"},r={"margin-bottom":"1rem"},n={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0 0 0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)",margin:"0"};return(()=>{var o=kh();return Ai(o,"click",t.onClick,!0),s(o,(()=>{var a=me(()=>!!(t.title||t.subtitle));return()=>a()&&(()=>{var c=kh();return d(c,r),s(c,(()=>{var u=me(()=>!!t.title);return()=>u()&&(()=>{var h=_w();return d(h,n),s(h,()=>t.title),h})()})(),null),s(c,(()=>{var u=me(()=>!!t.subtitle);return()=>u()&&(()=>{var h=Sw();return d(h,i),s(h,()=>t.subtitle),h})()})(),null),c})()})(),null),s(o,()=>t.children,null),ie(a=>{var c=e,u=`card ${t.className||""}`;return a.e=d(o,c,a.e),u!==a.t&&Sc(o,a.t=u),a},{e:void 0,t:void 0}),o})()};_t(["click"]);var Pw=G("<div><label></label><input>"),ww=G("<span>*");const wt=t=>{const e={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},r={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},n={"margin-bottom":"1rem"};return(()=>{var i=Pw(),o=i.firstChild,a=o.nextSibling;return d(i,n),d(o,e),s(o,()=>t.label,null),s(o,(()=>{var c=me(()=>!!t.required);return()=>c()&&(()=>{var u=ww();return u.style.setProperty("color","var(--primary-color)"),u})()})(),null),a.addEventListener("blur",c=>c.target.style.borderColor="var(--border-color)"),a.addEventListener("focus",c=>c.target.style.borderColor="var(--primary-color)"),a.$$input=c=>t.onChange(c.target.value),d(a,r),ie(c=>{var u=t.type||"text",h=t.placeholder,f=t.required,g=t.disabled;return u!==c.e&&lt(a,"type",c.e=u),h!==c.t&&lt(a,"placeholder",c.t=h),f!==c.a&&(a.required=c.a=f),g!==c.o&&(a.disabled=c.o=g),c},{e:void 0,t:void 0,a:void 0,o:void 0}),ie(()=>a.value=t.value),i})()};_t(["input"]);const Cw={en:{common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",close:"Close",search:"Search",filter:"Filter",reset:"Reset",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",actions:"Actions",status:"Status",active:"Active",inactive:"Inactive",date:"Date",time:"Time",description:"Description",notes:"Notes",amount:"Amount",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Language",english:"English",spanish:"Spanish",noDataFound:"No data found",required:"Required",optional:"Optional",all:"All",none:"None",select:"Select",clear:"Clear",searching:"Searching...",refresh:"Refresh",showAll:"Show All",products:"products",filtered:"Filtered",view:"View",suggested:"Suggested",clearFilters:"Clear Filters",enhanced:"Enhanced",legacy:"Legacy",email:"Email",phone:"Phone",address:"Address",name:"Name",code:"Code",category:"Category",type:"Type",quantity:"Quantity",price:"Price",cost:"Cost",value:"Value",balance:"Balance",created:"Created",modified:"Modified",details:"Details",summary:"Summary",history:"History",new:"New",addNew:"Add New",unknown:"Unknown",notAvailable:"N/A",remove:"Remove",startDate:"Start Date",endDate:"End Date",from:"From",invoice:"Invoice",reference:"Reference",createdBy:"Created By",units:"units",invoiceDocumentId:"Invoice/Document ID",referenceNumber:"Reference Number",referenceNumberPlaceholder:"Enter reference number...",generalNotes:"General Notes",auto:"Auto",optionalNotes:"Optional notes...",showPerPage:"Show per page",first:"First",last:"Last",pageOfPages:"Page {{current}} of {{total}}",showingXofY:"Showing {{start}}-{{end}} of {{total}}",page:"Page",of:"of"},forms:{referenceNumberRequired:"Reference number is required",locationRequired:"Location is required",fromLocationRequired:"From location is required for transfers",atLeastOneProduct:"At least one product is required",itemProductRequired:"Product is required for item {{index}}",itemQuantityRequired:"Quantity must be greater than 0 for item {{index}}"},navigation:{dashboard:"Dashboard",accounts:"Chart of Accounts",balanceSheet:"Balance Sheet",inventory:"Inventory",employees:"Employees",entryBooks:"Entry Books",consolidate:"Bank Consolidation",reports:"Reports",settings:"Settings"},dashboard:{title:"Dashboard",welcome:"Welcome to HRM Finance",totalRevenue:"Total Revenue",overview:"Overview",recentActivity:"Recent Activity",quickActions:"Quick Actions",employeeCount:"Employee Count",pendingInvoices:"Pending Invoices",cashBalance:"Cash Balance",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalExpenses:"Total Expenses",netIncome:"Net Income",netLoss:"Net Loss",monthlyPayroll:"Monthly Payroll",current:"Current",newHires:"+3 new hires",outstanding:"Outstanding",totalOutstanding:"$23,450 total",lastUpdatedToday:"Last updated today",commonTasks:"Common tasks",generateReport:"Generate Report",latestUpdates:"Latest updates",invoicePaid:"Invoice #1234 paid",hoursAgo:"2 hours ago",newEmployeeOnboarded:"New employee onboarded",dayAgo:"1 day ago",monthlyReportGenerated:"Monthly report generated",daysAgo:"2 days ago"},accounts:{title:"Chart of Accounts",accountNumber:"Account Number",accountName:"Account Name",accountType:"Account Type",category:"Category",balance:"Balance",parentAccount:"Parent Account",subAccounts:"Sub-accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",transactions:"Transactions",accountHistory:"Account History",backToAccounts:"Back to Accounts",accountNotFound:"Account not found",accountInformation:"Account Information",accountPurpose:"Account purpose",transactionHistory:"Transaction History",noTransactions:"No transactions found for this account",createdDate:"Created Date",lastModified:"Last Modified",noDescription:"No description provided.",totalCount:"Total count",basicDetails:"Basic details",currentBalance:"Current balance",classification:"Classification",allTransactions:"All account transactions",reference:"Reference",allAccounts:"All Accounts",types:{asset:"Asset",liability:"Liability",equity:"Equity",revenue:"Revenue",expense:"Expense"},categories:{currentAssets:"Current Assets",fixedAssets:"Fixed Assets",currentLiabilities:"Current Liabilities",longTermLiabilities:"Long-term Liabilities",ownersEquity:"Owner's Equity",operatingRevenue:"Operating Revenue",operatingExpenses:"Operating Expenses"}},inventory:{title:"Inventory Management",overview:"Overview",products:"Products & Stock",movements:"Movements",locations:"Locations",bulkMovement:"Bulk Movement",addMovement:"Add Movement",addProduct:"Add Product",addLocation:"Add Location",singleMovement:"Add Single Movement",addNewItem:"Add New Item",activeProducts:"Active Products",lowStockAlert:"Low Stock Items",totalValue:"Total Stock Value",activeLocations:"Active Locations",productsNeedRestocking:"products need restocking",recentMovements:"Recent Movements",noProducts:"No products at this location",productName:"Product Name",productCode:"Product Code",sku:"SKU",unitOfMeasure:"Unit of Measure",unitCost:"Unit Cost",minStockLevel:"Min Stock Level",maxStockLevel:"Max Stock Level",locationName:"Location Name",locationType:"Location Type",locationCode:"Location Code",movementType:"Movement Type",referenceNumber:"Reference Number",invoiceNumber:"Invoice Number",fromLocation:"From Location",toLocation:"To Location",stockIn:"Stock In",stockOut:"Stock Out",transfer:"Transfer",adjustment:"Adjustment",inStock:"In Stock",lowStock:"Low Stock",outOfStock:"Out of Stock",stockLevels:"Stock Levels",stockByLocation:"Stock by Location",searchProducts:"Search products by name, SKU, or category...",searchProductsStock:"Search products and check stock levels...",searchResult:"Search Result",searchResults:"Search Results",searchFallback:"Showing local results",tryDifferentTerm:"Try a different search term or check spelling.",showingTopResults:"Showing top {{count}} results",searchLocations:"Search locations...",noMovements:"No movements found",productDetails:"Product Details",locationDetails:"Location Details",movementDetails:"Movement Details",totalProducts:"Total Products",totalLocations:"Total Locations",lastSeen:"Last seen",warehouseType:"Warehouse",storeType:"Store",supplierType:"Supplier",customerType:"Customer",currentlyManaged:"Currently managed",needAttention:"Need attention",currentWorth:"Current worth",warehousesStores:"Warehouses & stores",thisMonth:"This Month",latestActivities:"Latest inventory activities",searchMovements:"Search Movements",countingSheet:"Counting Sheet",physicalCount:"Physical Count",physicalInventoryCount:"Physical Inventory Count",setupPhysicalCount:"Setup Physical Inventory Count",setupDescription:"Configure your physical inventory count settings and begin the counting process.",countWillInclude:"This count will include {{count}} products from {{location}} in {{category}} category.",startCounting:"Start Physical Count",counted:"Counted",remaining:"Remaining",variances:"Variances",complete:"Complete",systemQty:"System Qty",variance:"Variance",addNotes:"Add notes...",reviewAndConfirm:"Review and Confirm Adjustments",reviewDescription:"Review the inventory adjustments below and confirm to update your system.",stockIncreases:"Stock Increases",stockDecreases:"Stock Decreases",totalAdjustments:"Total Adjustments",confirmAdjustments:"Confirm Adjustments",perfectCount:"Perfect Count!",noVariances:"No variances found. Your physical count matches the system exactly.",physicalCountAdjustment:"Physical count adjustment",inventoryCountingSheetTitle:"INVENTORY COUNTING SHEET",location:"Location",allCategories:"All Categories",countedBy:"Counted by",verifiedBy:"Verified by",instructions:"Instructions",countInstructions:["Count all items physically present at this location",'Write the actual count in the "Physical Count" column',"Leave blank if item is not found",'Note any discrepancies in the "Notes" column',"Sign and date when complete"],productName:"Product Name",unit:"Unit",totalProductsListed:"Total Products Listed",itemsCounted:"Items Counted",discrepanciesFound:"Discrepancies Found",counterSignature:"Counter Signature",supervisorSignature:"Supervisor Signature",downloadCSV:"Download CSV",noAdjustmentsToDownload:"No adjustments to download",stockIncrease:"Stock Increase",stockDecrease:"Stock Decrease",purchaseReceive:"Purchase/Receive",saleIssue:"Sale/Issue",transfer:"Transfer",adjustment:"Adjustment",movementType:"Movement Type",fromLocation:"From Location",toLocation:"To Location",searchSourceLocation:"Search source location...",searchDestinationLocation:"Search destination location...",searchLocation:"Search location...",addProduct:"Add Product",searchProduct:"Search product...",unitCost:"Unit Cost",noProductsAdded:'No products added yet. Click "Add Product" to get started.',createMovement:"Create Movement",generalNotesPlaceholder:"Enter general notes for this movement...",sortBy:"Sort By",allLocations:"All Locations",searchByProduct:"Search by product, location, reference, notes, invoice...",allProducts:"All Products",allTypes:"All Types",startDate:"Start Date",endDate:"End Date",totalMovements:"Total Movements",totalItems:"Total Items",adjustMovements:"Try adjusting your filters or check back later.",inventoryMovements:"Inventory Movements",createdBy:"Created By",view:"View",enhanced:"Enhanced",legacy:"Legacy",addSingleMovement:"Add Single Movement",inStockSubtitle:"In stock",itemsBelowThreshold:"Items below threshold",inventoryWorth:"Inventory worth",quantity:"Quantity",units:"units",normal:"Normal",productsAndStock:"Products & Stock",lowStockItems:"Low Stock Items",totalStockValue:"Total Stock Value",warehousesAndStores:"Warehouses & stores",andMore:"...and {count} more",latestInventoryActivities:"Latest inventory activities",min:"Min",max:"Max",cost:"Cost",noProductsFound:"No products found matching your search.",noProductsAvailable:"No products available.",noLocationsFound:"No locations found matching your search.",noLocationsAvailable:"No locations available.",searchPlaceholder:"Search by product, location, reference, notes, invoice...",noMovementsFound:"No movements found",tryAdjustingFilters:"Try adjusting your filters or check back later.",transfers:"Transfers",adjustments:"Adjustments",bulk:"Bulk",product:"Product",location:"Location",store:"Store",supplier:"Supplier",warehouse:"Warehouse",movement:"Movement",editMovement:"Edit Movement",updateMovement:"Update Movement",movementInformation:"Movement Information",locationInformation:"Location Information"},employees:{title:"Employee Management",employeeList:"Employee List",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",payrollInfo:"Payroll Information",firstName:"First Name",lastName:"Last Name",fullName:"Full Name",email:"Email",phone:"Phone",address:"Address",dateOfBirth:"Date of Birth",employeeId:"Employee ID",department:"Department",position:"Position",hireDate:"Hire Date",employmentStatus:"Employment Status",salary:"Salary",payFrequency:"Pay Frequency",taxId:"Tax ID",bankAccount:"Bank Account",emergencyContact:"Emergency Contact",activeEmployees:"Active Employees",inactiveEmployees:"Inactive Employees",totalPayroll:"Total Payroll",searchEmployees:"Search employees...",enterFullName:"Enter employee's full name",enterPosition:"Enter job position",enterEmail:"Enter email address",enterPhone:"Enter phone number",enterSalary:"Enter annual salary",departments:{engineering:"Engineering",product:"Product",design:"Design",marketing:"Marketing",sales:"Sales",humanResources:"Human Resources",finance:"Finance",operations:"Operations",analytics:"Analytics"}},entryBooks:{title:"Entry Books",bookName:"Book Name",bookType:"Book Type",createBook:"Create Book",editBook:"Edit Book",salesBook:"Sales Book",purchaseBook:"Purchase Book",cashBook:"Cash Book",generalBook:"General Book",entries:"Entries",addEntry:"Add Entry",period:"Period",startDate:"Start Date",endDate:"End Date",bookBalance:"Book Balance",reconciledBalance:"Reconciled Balance",difference:"Difference",reconcile:"Reconcile",isReconciled:"Is Reconciled",noBooks:"No entry books found",createFirst:"Create your first entry book to get started",bookDetails:"Book Details",entriesCount:"entries",bookOverview:"Book overview and details",bookEntries:"Book Entries",allEntries:"All entries in this book",noEntries:"No entries found",addFirst:"Add your first entry to this book",entryDate:"Entry Date",entryDescription:"Entry Description",entryAmount:"Entry Amount",entryReference:"Entry Reference",subtitle:"Manage accounting entries and general ledger records",viewReconciliation:"View Reconciliation",totalEntries:"Total Entries",allJournalEntries:"All journal entries",postedEntriesOnly:"Posted entries only",fromPostedEntries:"From {count} posted entries",needBankReconciliation:"Need bank reconciliation",allReconciled:"All reconciled",sortBy:"Sort By",fromDate:"From Date",toDate:"To Date",order:"Order",newest:"Newest",oldest:"Oldest",resetFilters:"Reset Filters",activeFilters:"Active filters",from:"From",to:"To",entriesFound:"{count} entries found",noJournalEntries:"No Journal Entries",startByCreating:"Start by creating your first entry",noEntriesMatch:"No journal entries match your current filters.",createFirstEntry:"Create First Entry",void:"Void",confirmVoid:"Are you sure you want to void this journal entry?",entryBookRecords:"Entry Book Records"},banking:{title:"Bank Consolidation",bankAccount:"Bank Account",statementDate:"Statement Date",beginningBalance:"Beginning Balance",endingBalance:"Ending Balance",deposits:"Deposits",withdrawals:"Withdrawals",bankCharges:"Bank Charges",interest:"Interest",reconcile:"Reconcile",matched:"Matched",unmatched:"Unmatched",importStatement:"Import Statement",manualEntry:"Manual Entry",autoMatch:"Auto Match",clearAll:"Clear All",reconciliationStatus:"Reconciliation Status",difference:"Difference",bookBalance:"Book Balance",statementBalance:"Statement Balance",outstandingChecks:"Outstanding Checks",depositsInTransit:"Deposits in Transit",reconciled:"Reconciled",notReconciled:"Not Reconciled",unreconciled:"Unreconciled",reconciliation:"Reconciliation",compareStatements:"Compare bank statements with entry book records",importCSV:"Import CSV",startNewReconciliation:"Start New Reconciliation",bankAccountInfo:"Bank Account Info",currentAccountDetails:"Current account details",lastReconciled:"Last reconciled",bankTransactions:"Bank Transactions",selectedPeriod:"Selected period",pending:"pending",bookEntriesForComparison:"Book entries for comparison",reconciliationRate:"Reconciliation Rate",completionStatus:"Completion status",recentReconciliationSessions:"Recent Reconciliation Sessions",latestActivity:"Latest activity",noRecentSessions:"No recent reconciliation sessions found.",startFirstReconciliation:"Start First Reconciliation",entryBookRecords:"Entry Book Records",pleaseUploadCSV:"Please upload a CSV file",csvRequiresHeaderAndData:"CSV file must have at least a header and one data row",successfullyParsed:"Successfully parsed {count} rows",errorParsingCSV:"Error parsing CSV file. Please check the format.",dateDescriptionRequired:"Date and Description columns are required",importedTransaction:"Imported transaction",successfullyImported:"Successfully imported {count} bank transactions",errorImportingTransactions:"Error importing transactions. Please check your data.",importBankStatementCSV:"Import Bank Statement CSV",dropCSVHere:"Drop CSV file here",clickToUploadCSV:"Click to upload or drag and drop CSV file",supportedFormat:"Supported format: CSV with Date, Description, and Amount columns",mapCSVColumns:"Map CSV Columns",dateColumn:"Date Column",selectColumn:"Select column...",descriptionColumn:"Description Column",referenceColumn:"Reference Column",amountDebitColumn:"Amount/Debit Column",creditColumn:"Credit Column",balanceColumn:"Balance Column",andMoreRows:"... and {count} more rows",importing:"Importing...",importTransactions:"Import {count} Transactions",reconciliationComparison:"Reconciliation Comparison",bankStatements:"Bank Statements",totalTransactions:"Total transactions",totalEntries:"Total entries",unreconciledBank:"Unreconciled Bank",unreconciledBooks:"Unreconciled Books",needAttention:"Need attention",unreconcile:"Unreconcile",clickToReconcile:"Click to reconcile",potentialMatchesFound:"Potential Matches Found",clickRecordToReconcile:"Click on a record below to reconcile",exactMatch:"Exact Match",possibleMatch:"Possible Match",selected:"Selected",clearSelection:"Clear Selection"},journal:{title:"Journal Entries",entryNumber:"Entry Number",entryDate:"Entry Date",debit:"Debit",credit:"Credit",account:"Account",memo:"Memo",reference:"Reference",createEntry:"Create Entry",editEntry:"Edit Entry",deleteEntry:"Delete Entry",posted:"Posted",draft:"Draft",reversed:"Reversed",recurringEntry:"Recurring Entry",attachments:"Attachments",totalDebits:"Total Debits",totalCredits:"Total Credits",outOfBalance:"Out of Balance",balanced:"Balanced",addEntry:"Add Journal Entry",allEntries:"All Entries",totalDebit:"Total Debit",totalCredit:"Total Credit",debitShort:"Dr.",creditShort:"Cr.",noReference:"No reference",createdBy:"By",totalAmount:"Total Amount",lines:"Lines",entryNotBalancedShort:"Entry is not balanced",accountLines:"Account Lines",noDescription:"No description",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryLines:"Journal Entry Lines",addLine:"Add Line",lineDescription:"Line description",notBalanced:"Not Balanced",updateEntry:"Update Entry",saveAsDraft:"Save as Draft",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",editEntryTooltip:"Edit this journal entry",post:"Post",entryMustBeBalanced:"Entry must be balanced to post",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",journalLines:"Journal Lines",balanceStatus:"Balance Status",unbalanced:"Unbalanced",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",postEntry:"Post Entry",fixBalance:"Fix Balance",voidEntry:"Void Entry",draftEntry:"Draft Entry",draftEntryDescription:"This entry can be edited and posted.",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",postedEntry:"Posted Entry",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",minTwoLinesRequired:"At least 2 line items are required",entryNotBalanced:"Entry is not balanced. Debit: ${debit}, Credit: ${credit}",lineAccountRequired:"Line {lineNumber}: Account is required",lineAmountRequired:"Line {lineNumber}: Either debit or credit amount must be provided",lineBothAmounts:"Line {lineNumber}: Cannot have both debit and credit amounts",enterEntryDescription:"Enter journal entry description",enterReferenceNumber:"Enter reference number"},forms:{requiredField:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",selectOption:"Please select an option",enterValue:"Please enter a value",confirmDelete:"Are you sure you want to delete this item?",unsavedChanges:"You have unsaved changes. Do you want to continue?",saveSuccess:"Saved successfully",saveError:"Error saving data",deleteSuccess:"Deleted successfully",deleteError:"Error deleting item",duplicateAccountNumber:"Account number already exists",descriptionRequired:"Description is required",errorOccurred:"An error occurred",errorPostingEntry:"An error occurred while posting the entry"},modals:{addInventory:"Add Inventory Movement",bulkMovement:"Bulk Inventory Movement",addProduct:"Add New Product",addLocation:"Add New Location",inventoryDetail:"Inventory Item Details",quickAdd:"Quick Add",selectProduct:"Select Product",selectLocation:"Select Location",enterQuantity:"Enter quantity",enterCost:"Enter unit cost",enterReference:"Enter reference number",addNotes:"Add notes (optional)",generalInformation:"General Information",stockInformation:"Stock Information",locationInformation:"Location Information",movementInformation:"Movement Information",addToInventory:"Add to Inventory",createProduct:"Create Product",createLocation:"Create Location",processing:"Processing...",addingMovement:"Adding movement...",creatingProduct:"Creating product...",creatingLocation:"Creating location..."},products:{title:"Products",addNew:"Add New Product",totalProducts:"Total Products",inCatalog:"In catalog",activeProducts:"Active Products",currentlyAvailable:"Currently available",outOfStock:"Out of Stock",needsRestock:"Needs restock",productCatalog:"Product Catalog",manageYourProducts:"Manage your products and pricing",inStock:"In Stock",furniture:"Furniture",electronics:"Electronics",supplies:"Supplies",lighting:"Lighting",searchPlaceholder:"Search products by name, SKU, or category...",allCategories:"All Categories",clearFilters:"Clear filters",noResults:"No products found matching your criteria.",noProducts:"No products available.",showing:"Showing",filtered:"Filtered results",allProducts:"All products",searchResult:"Search Result",stock:"Stock",lowStock:"Low Stock"},invoices:{title:"Invoices",createNew:"Create New Invoice",totalOutstanding:"Total Outstanding",unpaidInvoices:"Unpaid invoices",thisMonth:"This Month",revenueCollected:"Revenue collected",overdue:"Overdue",pastDueInvoices:"Past due invoices",recentInvoices:"Recent Invoices",latestBillingActivity:"Latest billing activity",paid:"Paid",pending:"Pending"},unauthorized:{title:"Access Restricted",accessDenied:"Access Denied",noPermission:"You don't have permission to access",thisFeature:"this feature",whySeeing:"Why am I seeing this?",explanation:"Your account doesn't have the necessary permissions to view this content.",requiredPermission:"Required permission:",goToDashboard:"Go to Dashboard",goBack:"Go Back",featuresCanAccess:"Features you can access:",dashboardAccess:"Dashboard and overview statistics",profileAccess:"Your profile and settings",roleBasedAccess:"Features enabled for your role",needAccess:"Need access? Contact your administrator or manager to request the appropriate permissions.",permissions:{accountAccess:"Account Management Access",inventoryAccess:"Inventory Access",employeeAccess:"HR Access",bankingAccess:"Banking Access",journalAccess:"Journal Entry Access",adminAccess:"Administrative Access",financialReporting:"Financial Reporting Access",invoiceManagement:"Invoice Management Access",productManagement:"Product Management Access"}}},es:{common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",add:"Agregar",close:"Cerrar",search:"Buscar",filter:"Filtrar",reset:"Restablecer",back:"Atrás",next:"Siguiente",previous:"Anterior",yes:"Sí",no:"No",loading:"Cargando...",error:"Error",success:"Éxito",warning:"Advertencia",info:"Información",confirm:"Confirmar",actions:"Acciones",status:"Estado",active:"Activo",inactive:"Inactivo",date:"Fecha",time:"Hora",description:"Descripción",notes:"Notas",amount:"Monto",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Idioma",english:"Inglés",spanish:"Español",noDataFound:"No se encontraron datos",required:"Requerido",optional:"Opcional",all:"Todos",none:"Ninguno",select:"Seleccionar",clear:"Limpiar",view:"Ver",suggested:"Sugerido",clearFilters:"Limpiar Filtros",enhanced:"Mejorado",legacy:"Clásico",email:"Correo Electrónico",phone:"Teléfono",address:"Dirección",name:"Nombre",code:"Código",category:"Categoría",type:"Tipo",quantity:"Cantidad",price:"Precio",cost:"Costo",value:"Valor",balance:"Saldo",created:"Creado",modified:"Modificado",details:"Detalles",summary:"Resumen",history:"Historial",new:"Nuevo",addNew:"Agregar Nuevo",unknown:"Desconocido",notAvailable:"N/A",remove:"Remover",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",from:"De",invoice:"Factura",reference:"Referencia",createdBy:"Creado Por",units:"unidades",invoiceDocumentId:"ID de Factura/Documento",referenceNumber:"Número de Referencia",referenceNumberPlaceholder:"Ingrese número de referencia...",generalNotes:"Notas Generales",auto:"Auto",optionalNotes:"Notas opcionales...",showPerPage:"Mostrar por página",first:"Primera",last:"Última",pageOfPages:"Página {{current}} de {{total}}",showingXofY:"Mostrando {{start}}-{{end}} de {{total}}",page:"Página",of:"de"},forms:{referenceNumberRequired:"El número de referencia es requerido",locationRequired:"La ubicación es requerida",fromLocationRequired:"La ubicación de origen es requerida para transferencias",atLeastOneProduct:"Al menos un producto es requerido",itemProductRequired:"El producto es requerido para el artículo {{index}}",itemQuantityRequired:"La cantidad debe ser mayor que 0 para el artículo {{index}}"},navigation:{dashboard:"Panel de Control",accounts:"Plan de Cuentas",balanceSheet:"Balance General",inventory:"Inventario",employees:"Empleados",entryBooks:"Libros de Entrada",consolidate:"Consolidación Bancaria",reports:"Reportes",settings:"Configuración"},dashboard:{title:"Panel de Control",welcome:"Bienvenido a HRM Finance",totalRevenue:"Ingresos Totales",overview:"Resumen",recentActivity:"Actividad Reciente",quickActions:"Acciones Rápidas",employeeCount:"Número de Empleados",pendingInvoices:"Facturas Pendientes",cashBalance:"Saldo en Efectivo",totalAssets:"Activos Totales",totalLiabilities:"Pasivos Totales",totalExpenses:"Gastos Totales",netIncome:"Ingreso Neto",netLoss:"Pérdida Neta",monthlyPayroll:"Nómina Mensual",current:"Actual",newHires:"+3 nuevas contrataciones",outstanding:"Pendiente",totalOutstanding:"$23,450 total",lastUpdatedToday:"Última actualización hoy",commonTasks:"Tareas comunes",generateReport:"Generar Reporte",latestUpdates:"Últimas actualizaciones",invoicePaid:"Factura #1234 pagada",hoursAgo:"hace 2 horas",newEmployeeOnboarded:"Nuevo empleado incorporado",dayAgo:"hace 1 día",monthlyReportGenerated:"Reporte mensual generado",daysAgo:"hace 2 días"},accounts:{title:"Plan de Cuentas",accountNumber:"Número de Cuenta",accountName:"Nombre de Cuenta",accountType:"Tipo de Cuenta",category:"Categoría",balance:"Saldo",parentAccount:"Cuenta Padre",subAccounts:"Subcuentas",addAccount:"Agregar Cuenta",editAccount:"Editar Cuenta",deleteAccount:"Eliminar Cuenta",accountDetails:"Detalles de Cuenta",transactions:"Transacciones",accountHistory:"Historial de Cuenta",backToAccounts:"Volver a Cuentas",accountNotFound:"Cuenta no encontrada",accountInformation:"Información de Cuenta",accountPurpose:"Propósito de la cuenta",transactionHistory:"Historial de Transacciones",noTransactions:"No se encontraron transacciones para esta cuenta",createdDate:"Fecha de Creación",lastModified:"Última Modificación",noDescription:"No se proporcionó descripción.",totalCount:"Conteo total",basicDetails:"Detalles básicos",currentBalance:"Saldo actual",classification:"Clasificación",allTransactions:"Todas las transacciones de la cuenta",reference:"Referencia",types:{asset:"Activo",liability:"Pasivo",equity:"Patrimonio",revenue:"Ingreso",expense:"Gasto"},categories:{currentAssets:"Activos Corrientes",fixedAssets:"Activos Fijos",currentLiabilities:"Pasivos Corrientes",longTermLiabilities:"Pasivos a Largo Plazo",ownersEquity:"Patrimonio del Propietario",operatingRevenue:"Ingresos Operacionales",operatingExpenses:"Gastos Operacionales"}},inventory:{title:"Gestión de Inventario",overview:"Resumen",products:"Productos y Stock",movements:"Movimientos",locations:"Ubicaciones",bulkMovement:"Movimiento Masivo",addMovement:"Agregar Movimiento",addProduct:"Agregar Producto",addLocation:"Agregar Ubicación",singleMovement:"Agregar Movimiento Individual",addNewItem:"Agregar Nuevo Artículo",activeProducts:"Productos Activos",lowStockAlert:"Artículos con Stock Bajo",totalValue:"Valor Total del Stock",activeLocations:"Ubicaciones Activas",productsNeedRestocking:"productos necesitan reabastecimiento",recentMovements:"Movimientos Recientes",noProducts:"No hay productos en esta ubicación",productName:"Nombre del Producto",productCode:"Código del Producto",sku:"SKU",unitOfMeasure:"Unidad de Medida",unitCost:"Costo Unitario",minStockLevel:"Nivel Mínimo de Stock",maxStockLevel:"Nivel Máximo de Stock",locationName:"Nombre de Ubicación",locationType:"Tipo de Ubicación",locationCode:"Código de Ubicación",movementType:"Tipo de Movimiento",referenceNumber:"Número de Referencia",invoiceNumber:"Número de Factura",fromLocation:"Desde Ubicación",toLocation:"Hacia Ubicación",stockIn:"Entrada de Stock",stockOut:"Salida de Stock",transfer:"Transferencia",adjustment:"Ajuste",inStock:"En Stock",lowStock:"Stock Bajo",outOfStock:"Sin Stock",stockLevels:"Niveles de Stock",stockByLocation:"Stock por Ubicación",searchProducts:"Buscar productos...",searchLocations:"Buscar ubicaciones...",noMovements:"No se encontraron movimientos",productDetails:"Detalles del Producto",locationDetails:"Detalles de Ubicación",movementDetails:"Detalles del Movimiento",totalProducts:"Total de Productos",totalLocations:"Total de Ubicaciones",lastSeen:"Visto por última vez",warehouseType:"Almacén",storeType:"Tienda",supplierType:"Proveedor",customerType:"Cliente",currentlyManaged:"Gestionados actualmente",needAttention:"Necesitan atención",currentWorth:"Valor actual",warehousesStores:"Almacenes y tiendas",thisMonth:"Este Mes",latestActivities:"Últimas actividades de inventario",searchMovements:"Buscar Movimientos",countingSheet:"Hoja de Conteo",physicalCount:"Conteo Físico",physicalInventoryCount:"Conteo Físico de Inventario",setupPhysicalCount:"Configurar Conteo Físico de Inventario",setupDescription:"Configure los ajustes de su conteo físico de inventario y comience el proceso de conteo.",countWillInclude:"Este conteo incluirá {{count}} productos de {{location}} en la categoría {{category}}.",startCounting:"Iniciar Conteo Físico",counted:"Contado",remaining:"Restante",variances:"Variaciones",complete:"Completo",systemQty:"Cant. Sistema",variance:"Variación",addNotes:"Agregar notas...",reviewAndConfirm:"Revisar y Confirmar Ajustes",reviewDescription:"Revise los ajustes de inventario a continuación y confirme para actualizar su sistema.",stockIncreases:"Aumentos de Stock",stockDecreases:"Disminuciones de Stock",totalAdjustments:"Ajustes Totales",confirmAdjustments:"Confirmar Ajustes",adjustment:"Ajuste",perfectCount:"¡Conteo Perfecto!",noVariances:"No se encontraron variaciones. Su conteo físico coincide exactamente con el sistema.",physicalCountAdjustment:"Ajuste de conteo físico",inventoryCountingSheetTitle:"HOJA DE CONTEO DE INVENTARIO",location:"Ubicación",allCategories:"Todas las Categorías",countedBy:"Contado por",verifiedBy:"Verificado por",instructions:"Instrucciones",countInstructions:["Contar todos los artículos físicamente presentes en esta ubicación",'Escribir el conteo real en la columna "Conteo Físico"',"Dejar en blanco si el artículo no se encuentra",'Anotar cualquier discrepancia en la columna "Notas"',"Firmar y fechar cuando esté completo"],productName:"Nombre del Producto",unit:"Unidad",totalProductsListed:"Total de Productos Listados",itemsCounted:"Artículos Contados",discrepanciesFound:"Discrepancias Encontradas",counterSignature:"Firma del Contador",supervisorSignature:"Firma del Supervisor",downloadCSV:"Descargar CSV",noAdjustmentsToDownload:"No hay ajustes para descargar",stockIncrease:"Aumento de Stock",stockDecrease:"Disminución de Stock",purchaseReceive:"Compra/Recepción",saleIssue:"Venta/Emisión",transfer:"Transferencia",adjustment:"Ajuste",movementType:"Tipo de Movimiento",fromLocation:"Ubicación de Origen",toLocation:"Ubicación de Destino",searchSourceLocation:"Buscar ubicación de origen...",searchDestinationLocation:"Buscar ubicación de destino...",searchLocation:"Buscar ubicación...",addProduct:"Agregar Producto",searchProduct:"Buscar producto...",unitCost:"Costo Unitario",noProductsAdded:'No se han agregado productos aún. Haga clic en "Agregar Producto" para comenzar.',createMovement:"Crear Movimiento",generalNotesPlaceholder:"Ingrese notas generales para este movimiento...",sortBy:"Ordenar Por",allLocations:"Todas las Ubicaciones",searchByProduct:"Buscar por producto, ubicación, referencia, notas, factura...",allProducts:"Todos los Productos",allTypes:"Todos los Tipos",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",totalMovements:"Movimientos Totales",totalItems:"Artículos Totales",adjustMovements:"Intenta ajustar tus filtros o revisa más tarde.",inventoryMovements:"Movimientos de Inventario",createdBy:"Creado Por",view:"Ver",enhanced:"Mejorado",legacy:"Clásico",addSingleMovement:"Agregar Movimiento Individual",inStockSubtitle:"En stock",itemsBelowThreshold:"Artículos bajo el umbral",inventoryWorth:"Valor del inventario",quantity:"Cantidad",units:"unidades",normal:"Normal",productsAndStock:"Productos y Stock",lowStockItems:"Artículos con Stock Bajo",totalStockValue:"Valor Total del Stock",warehousesAndStores:"Almacenes y tiendas",andMore:"...y {count} más",latestInventoryActivities:"Últimas actividades de inventario",min:"Mín",max:"Máx",cost:"Costo",noProductsFound:"No se encontraron productos que coincidan con su búsqueda.",noProductsAvailable:"No hay productos disponibles.",noLocationsFound:"No se encontraron ubicaciones que coincidan con su búsqueda.",noLocationsAvailable:"No hay ubicaciones disponibles.",searchPlaceholder:"Buscar por producto, ubicación, referencia, notas, factura...",noMovementsFound:"No se encontraron movimientos",tryAdjustingFilters:"Intenta ajustar tus filtros o revisa más tarde.",transfers:"Transferencias",adjustments:"Ajustes",bulk:"Masivo",product:"Producto",location:"Ubicación",store:"Tienda",supplier:"Proveedor",warehouse:"Almacén",movement:"Movimiento",editMovement:"Editar Movimiento",updateMovement:"Actualizar Movimiento",movementInformation:"Información del Movimiento",locationInformation:"Información de Ubicación"},employees:{title:"Gestión de Empleados",employeeList:"Lista de Empleados",addEmployee:"Agregar Empleado",editEmployee:"Editar Empleado",employeeDetails:"Detalles del Empleado",personalInfo:"Información Personal",employmentInfo:"Información Laboral",payrollInfo:"Información de Nómina",firstName:"Nombre",lastName:"Apellido",fullName:"Nombre Completo",email:"Correo Electrónico",phone:"Teléfono",address:"Dirección",dateOfBirth:"Fecha de Nacimiento",employeeId:"ID de Empleado",department:"Departamento",position:"Puesto",hireDate:"Fecha de Contratación",employmentStatus:"Estado Laboral",salary:"Salario",payFrequency:"Frecuencia de Pago",taxId:"ID Fiscal",bankAccount:"Cuenta Bancaria",emergencyContact:"Contacto de Emergencia",activeEmployees:"Empleados Activos",inactiveEmployees:"Empleados Inactivos",totalPayroll:"Nómina Total",searchEmployees:"Buscar empleados...",enterFullName:"Ingrese el nombre completo del empleado",enterPosition:"Ingrese el puesto de trabajo",enterEmail:"Ingrese la dirección de correo electrónico",enterPhone:"Ingrese el número de teléfono",enterSalary:"Ingrese el salario anual",departments:{engineering:"Ingeniería",product:"Producto",design:"Diseño",marketing:"Marketing",sales:"Ventas",humanResources:"Recursos Humanos",finance:"Finanzas",operations:"Operaciones",analytics:"Analítica"}},entryBooks:{title:"Libros de Entrada",bookName:"Nombre del Libro",bookType:"Tipo de Libro",createBook:"Crear Libro",editBook:"Editar Libro",salesBook:"Libro de Ventas",purchaseBook:"Libro de Compras",cashBook:"Libro de Caja",generalBook:"Libro General",entries:"Entradas",addEntry:"Agregar Entrada",period:"Período",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",bookBalance:"Saldo del Libro",reconciledBalance:"Saldo Conciliado",difference:"Diferencia",reconcile:"Conciliar",isReconciled:"Está Conciliado",noBooks:"No se encontraron libros de entrada",createFirst:"Crea tu primer libro de entrada para comenzar",bookDetails:"Detalles del Libro",entriesCount:"entradas",bookOverview:"Resumen y detalles del libro",bookEntries:"Entradas del Libro",allEntries:"Todas las entradas en este libro",noEntries:"No se encontraron entradas",addFirst:"Agrega tu primera entrada a este libro",entryDate:"Fecha de Entrada",entryDescription:"Descripción de Entrada",entryAmount:"Monto de Entrada",entryReference:"Referencia de Entrada"},banking:{title:"Consolidación Bancaria",bankAccount:"Cuenta Bancaria",statementDate:"Fecha del Estado",beginningBalance:"Saldo Inicial",endingBalance:"Saldo Final",deposits:"Depósitos",withdrawals:"Retiros",bankCharges:"Cargos Bancarios",interest:"Intereses",reconcile:"Conciliar",matched:"Conciliado",unmatched:"No Conciliado",importStatement:"Importar Estado",manualEntry:"Entrada Manual",autoMatch:"Coincidencia Automática",clearAll:"Limpiar Todo",reconciliationStatus:"Estado de Conciliación",difference:"Diferencia",bookBalance:"Saldo en Libros",statementBalance:"Saldo del Estado",outstandingChecks:"Cheques Pendientes",depositsInTransit:"Depósitos en Tránsito",reconciled:"Conciliado",notReconciled:"No Conciliado",unreconciled:"No Conciliado",reconciliation:"Conciliación",compareStatements:"Comparar estados bancarios con registros de libros de entrada",importCSV:"Importar CSV",startNewReconciliation:"Iniciar Nueva Conciliación",bankAccountInfo:"Información de Cuenta Bancaria",currentAccountDetails:"Detalles de cuenta actual",lastReconciled:"Última conciliación",bankTransactions:"Transacciones Bancarias",selectedPeriod:"Período seleccionado",pending:"pendiente",bookEntriesForComparison:"Entradas de libros para comparación",reconciliationRate:"Tasa de Conciliación",completionStatus:"Estado de finalización",recentReconciliationSessions:"Sesiones de Conciliación Recientes",latestActivity:"Actividad reciente",noRecentSessions:"No se encontraron sesiones de conciliación recientes.",startFirstReconciliation:"Iniciar Primera Conciliación",entryBookRecords:"Registros de Libros de Entrada",pleaseUploadCSV:"Por favor suba un archivo CSV",csvRequiresHeaderAndData:"El archivo CSV debe tener al menos un encabezado y una fila de datos",successfullyParsed:"Se analizaron exitosamente {count} filas",errorParsingCSV:"Error al analizar el archivo CSV. Verifique el formato.",dateDescriptionRequired:"Las columnas de Fecha y Descripción son requeridas",importedTransaction:"Transacción importada",successfullyImported:"Se importaron exitosamente {count} transacciones bancarias",errorImportingTransactions:"Error al importar transacciones. Verifique sus datos.",importBankStatementCSV:"Importar CSV de Estado Bancario",dropCSVHere:"Suelte el archivo CSV aquí",clickToUploadCSV:"Haga clic para cargar o arrastre y suelte el archivo CSV",supportedFormat:"Formato soportado: CSV con columnas de Fecha, Descripción y Monto",mapCSVColumns:"Mapear Columnas CSV",dateColumn:"Columna de Fecha",selectColumn:"Seleccionar columna...",descriptionColumn:"Columna de Descripción",referenceColumn:"Columna de Referencia",amountDebitColumn:"Columna de Monto/Débito",creditColumn:"Columna de Crédito",balanceColumn:"Columna de Saldo",andMoreRows:"... y {count} filas más",importing:"Importando...",importTransactions:"Importar {count} Transacciones",reconciliationComparison:"Comparación de Conciliación",bankStatements:"Estados Bancarios",totalTransactions:"Transacciones totales",totalEntries:"Entradas totales",unreconciledBank:"Banco No Conciliado",unreconciledBooks:"Libros No Conciliados",needAttention:"Necesitan atención",unreconcile:"Desconciliar",clickToReconcile:"Hacer clic para conciliar",potentialMatchesFound:"Coincidencias Potenciales Encontradas",clickRecordToReconcile:"Haga clic en un registro a continuación para conciliar",exactMatch:"Coincidencia Exacta",possibleMatch:"Posible Coincidencia",selected:"Seleccionado",clearSelection:"Limpiar Selección"},journal:{title:"Asientos Contables",entryNumber:"Número de Asiento",entryDate:"Fecha del Asiento",debit:"Débito",credit:"Crédito",account:"Cuenta",memo:"Memo",reference:"Referencia",createEntry:"Crear Asiento",editEntry:"Editar Asiento",deleteEntry:"Eliminar Asiento",posted:"Registrado",draft:"Borrador",reversed:"Revertido",recurringEntry:"Asiento Recurrente",attachments:"Adjuntos",totalDebits:"Débitos Totales",totalCredits:"Créditos Totales",outOfBalance:"Desbalanceado",balanced:"Balanceado"},forms:{requiredField:"Este campo es requerido",invalidEmail:"Dirección de correo inválida",invalidNumber:"Número inválido",invalidDate:"Fecha inválida",selectOption:"Por favor seleccione una opción",enterValue:"Por favor ingrese un valor",confirmDelete:"¿Está seguro de que desea eliminar este elemento?",unsavedChanges:"Tiene cambios sin guardar. ¿Desea continuar?",saveSuccess:"Guardado exitosamente",saveError:"Error al guardar datos",deleteSuccess:"Eliminado exitosamente",deleteError:"Error al eliminar elemento",duplicateAccountNumber:"El número de cuenta ya existe"},modals:{addInventory:"Agregar Movimiento de Inventario",bulkMovement:"Movimiento Masivo de Inventario",addProduct:"Agregar Nuevo Producto",addLocation:"Agregar Nueva Ubicación",inventoryDetail:"Detalles del Artículo de Inventario",quickAdd:"Agregar Rápido",selectProduct:"Seleccionar Producto",selectLocation:"Seleccionar Ubicación",enterQuantity:"Ingresar cantidad",enterCost:"Ingresar costo unitario",enterReference:"Ingresar número de referencia",addNotes:"Agregar notas (opcional)",generalInformation:"Información General",stockInformation:"Información de Stock",locationInformation:"Información de Ubicación",movementInformation:"Información de Movimiento",addToInventory:"Agregar al Inventario",createProduct:"Crear Producto",createLocation:"Crear Ubicación",processing:"Procesando...",addingMovement:"Agregando movimiento...",creatingProduct:"Creando producto...",creatingLocation:"Creando ubicación..."},products:{title:"Productos",addNew:"Agregar Nuevo Producto",totalProducts:"Total de Productos",inCatalog:"En catálogo",activeProducts:"Productos Activos",currentlyAvailable:"Actualmente disponibles",outOfStock:"Sin Stock",needsRestock:"Necesita reabastecimiento",productCatalog:"Catálogo de Productos",manageYourProducts:"Gestiona tus productos y precios",inStock:"En Stock",furniture:"Muebles",electronics:"Electrónicos",supplies:"Suministros",lighting:"Iluminación"},invoices:{title:"Facturas",createNew:"Crear Nueva Factura",totalOutstanding:"Total Pendiente",unpaidInvoices:"Facturas no pagadas",thisMonth:"Este Mes",revenueCollected:"Ingresos recaudados",overdue:"Vencidas",pastDueInvoices:"Facturas vencidas",recentInvoices:"Facturas Recientes",latestBillingActivity:"Actividad de facturación reciente",paid:"Pagado",pending:"Pendiente"},unauthorized:{title:"Acceso Restringido",accessDenied:"Acceso Denegado",noPermission:"No tienes permisos para acceder a",thisFeature:"esta funcionalidad",whySeeing:"¿Por qué veo esto?",explanation:"Tu cuenta no tiene los permisos necesarios para ver este contenido.",requiredPermission:"Permiso requerido:",goToDashboard:"Ir al Panel de Control",goBack:"Regresar",featuresCanAccess:"Funcionalidades a las que puedes acceder:",dashboardAccess:"Panel de control y estadísticas generales",profileAccess:"Tu perfil y configuraciones",roleBasedAccess:"Funcionalidades habilitadas para tu rol",needAccess:"¿Necesitas acceso? Contacta a tu administrador o gerente para solicitar los permisos apropiados.",permissions:{accountAccess:"Acceso a Gestión de Cuentas",inventoryAccess:"Acceso a Inventario",employeeAccess:"Acceso a Recursos Humanos",bankingAccess:"Acceso Bancario",journalAccess:"Acceso a Asientos Contables",adminAccess:"Acceso Administrativo",financialReporting:"Acceso a Reportes Financieros",invoiceManagement:"Acceso a Gestión de Facturas",productManagement:"Acceso a Gestión de Productos"}}}},Aw=()=>{if(typeof window<"u"){const t=localStorage.getItem("hrmfinance-language");if(t&&["en","es"].includes(t))return t}return"en"},[Rh,Iw]=ge(Aw()),ot=()=>({t:(n,i,o)=>{const a=Rh(),c=n.split(".");let u=Cw[a];for(const f of c)if(u&&typeof u=="object"&&f in u)u=u[f];else return i||n;let h=typeof u=="string"?u:i||n;return o&&typeof h=="string"&&Object.keys(o).forEach(f=>{const g=o[f],b=`{{${f}}}`;h=h.replace(new RegExp(b,"g"),String(g))}),h},language:()=>Rh(),setLanguage:n=>{Iw(n),typeof window<"u"&&localStorage.setItem("hrmfinance-language",n)}});var Ew=G("<div><label></label><select><option value>"),xw=G("<span>*"),Tw=G("<option>");const hr=t=>{const{t:e}=ot(),r={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},n={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},i={"margin-bottom":"1rem"};return(()=>{var o=Ew(),a=o.firstChild,c=a.nextSibling,u=c.firstChild;return d(o,i),d(a,r),s(a,()=>t.label,null),s(a,(()=>{var h=me(()=>!!t.required);return()=>h()&&(()=>{var f=xw();return f.style.setProperty("color","var(--primary-color)"),f})()})(),null),c.addEventListener("blur",h=>h.target.style.borderColor="var(--border-color)"),c.addEventListener("focus",h=>h.target.style.borderColor="var(--primary-color)"),c.addEventListener("change",h=>t.onChange(h.target.value)),d(c,n),s(u,()=>e("forms.selectOption")),s(c,()=>t.options.map(h=>(()=>{var f=Tw();return s(f,()=>h.label),ie(()=>f.value=h.value),f})()),null),ie(h=>{var f=t.required,g=t.disabled;return f!==h.e&&(c.required=h.e=f),g!==h.t&&(c.disabled=h.t=g),h},{e:void 0,t:void 0}),ie(()=>c.value=t.value),o})()};var $w=G("<div><span></span><select><option value=en>🇺🇸 </option><option value=es>🇪🇸 ");const hg=()=>{const{t,language:e,setLanguage:r}=ot(),n={display:"flex","align-items":"center",gap:"0.5rem","margin-left":"auto"},i={padding:"0.5rem 1rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",background:"var(--surface-color)",color:"var(--text-primary)",cursor:"pointer","font-size":"0.875rem","font-weight":"500",transition:"all 0.2s ease","min-width":"120px"},o={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},a=c=>{const u=c.target;r(u.value)};return(()=>{var c=$w(),u=c.firstChild,h=u.nextSibling,f=h.firstChild;f.firstChild;var g=f.nextSibling;return g.firstChild,d(c,n),d(u,o),h.addEventListener("change",a),d(h,i),s(f,()=>t("common.english"),null),s(g,()=>t("common.spanish"),null),ie(()=>h.value=e()),c})()};var kw=G("<main><div>"),Rw=G("<header><h1>");const Dr=t=>{const e={"min-height":"100vh",background:"var(--background-color)"},r={"max-width":"1200px",margin:"0 auto",padding:"2rem"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},i={"font-size":"2rem","font-weight":"700",color:"var(--text-primary)",margin:"0"};return(()=>{var o=kw(),a=o.firstChild;return d(o,e),d(a,r),s(a,(()=>{var c=me(()=>!!t.title);return()=>c()&&(()=>{var u=Rw(),h=u.firstChild;return d(u,n),d(h,i),s(h,()=>t.title),s(u,_(hg,{}),null),u})()})(),null),s(a,()=>t.children,null),o})()};var Dw=G('<img alt="User avatar">'),Nw=G("<div><span>"),Lw=G("<button>Sign Out"),Mw=G(`<nav><div><div><div></div></div><div></div></div><style>
        .nav-active {
          background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)) !important;
          color: white !important;
          box-shadow: var(--shadow-sm);
        }
        
        nav a:hover:not(.nav-active) {
          background: var(--background-color);
          color: var(--text-primary);
        }
        
        @media (max-width: 768px) {
          nav div:first-child {
            flex-direction: column;
            gap: 1rem;
            padding: 1rem;
          }
          
          nav div:last-child {
            flex-wrap: wrap;
            justify-content: center;
          }
        }
      `);const Ow=()=>{const{t}=ot(),e={background:"var(--surface-color)","border-bottom":"1px solid var(--border-color)","box-shadow":"var(--shadow-sm)","backdrop-filter":"blur(10px)",position:"sticky",top:"0","z-index":"100"},r={display:"flex","align-items":"center","justify-content":"space-between",padding:"1rem 2rem",margin:"0 auto"},n={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","text-decoration":"none","margin-right":"2rem"},i={display:"flex",gap:"0.5rem","align-items":"center"},o={"text-decoration":"none",color:"var(--text-secondary)",padding:"0.5rem 1rem","border-radius":"var(--border-radius-sm)","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease","white-space":"nowrap"},a={display:"flex","align-items":"center",gap:"1rem"},c={display:"flex","align-items":"center",gap:"0.75rem",padding:"0.5rem 1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",color:"var(--text-primary)"},u={width:"32px",height:"32px","border-radius":"50%","object-fit":"cover"},h={...o,cursor:"pointer",border:"1px solid var(--border-color)",background:"transparent"},f=()=>{Et.signOut()},g=b=>{const C=Et.state?.profile;return C?C[b]===!0||C.isAdmin===!0:!1};return(()=>{var b=Mw(),C=b.firstChild,R=C.firstChild,T=R.firstChild,E=R.nextSibling;return d(C,r),R.style.setProperty("display","flex"),R.style.setProperty("align-items","center"),R.style.setProperty("flex","1"),s(R,_(tn,{href:"/",style:n,children:"HRM Finance"}),T),d(T,i),s(T,_(tn,{href:"/",style:o,activeClass:"nav-active",get children(){return t("navigation.dashboard")}}),null),s(T,_(Le,{get when(){return g("AccountAccess")},get children(){return _(tn,{href:"/accounts",style:o,activeClass:"nav-active",get children(){return t("navigation.accounts")}})}}),null),s(T,_(Le,{get when(){return g("JournalAccess")},get children(){return _(tn,{href:"/entry-books",style:o,activeClass:"nav-active",get children(){return t("navigation.entryBooks")}})}}),null),s(T,_(Le,{get when(){return g("EmployeeAccess")},get children(){return _(tn,{href:"/employees",style:o,activeClass:"nav-active",get children(){return t("navigation.employees")}})}}),null),s(T,_(Le,{get when(){return g("BankingAccess")},get children(){return _(tn,{href:"/bank-consolidations",style:o,activeClass:"nav-active",get children(){return t("navigation.consolidate")}})}}),null),s(T,_(Le,{get when(){return g("AccountAccess")},get children(){return _(tn,{href:"/balance-sheet",style:o,activeClass:"nav-active",get children(){return t("navigation.balanceSheet")}})}}),null),s(T,_(Le,{get when(){return g("InventoryAccess")},get children(){return _(tn,{href:"/inventory",style:o,activeClass:"nav-active",get children(){return t("navigation.inventory")}})}}),null),s(T,_(Le,{get when(){return Et.state?.profile?.isAdmin},get children(){return _(tn,{href:"/admin/users",style:o,activeClass:"nav-active",children:"👥 Admin"})}}),null),d(E,a),s(E,_(hg,{}),null),s(E,_(Le,{get when(){return Et.currentUser},get children(){return[(()=>{var $=Nw(),K=$.firstChild;return d($,c),s($,_(Le,{get when(){return Et.currentUser?.photoURL},get children(){var Z=Dw();return ie(J=>{var de=Et.currentUser.photoURL,re=u;return de!==J.e&&lt(Z,"src",J.e=de),J.t=d(Z,re,J.t),J},{e:void 0,t:void 0}),Z}}),K),$})(),(()=>{var $=Lw();return $.addEventListener("mouseleave",K=>{K.currentTarget.style.background="transparent",K.currentTarget.style.color="var(--text-secondary)"}),$.addEventListener("mouseenter",K=>{K.currentTarget.style.background="var(--background-color)",K.currentTarget.style.color="var(--text-primary)"}),$.$$click=f,ie(K=>d($,h,K)),$})()]}}),null),ie($=>d(b,e,$)),b})()};_t(["click"]);var Vw=G("<div><div><div>🔒</div><h1></h1><p>.</p><div><p><strong></strong><br></p></div><div><button></button></div><div><h3></h3><div><span>✓</span><span></span></div><div><span>✓</span><span></span></div><div><span>✓</span><span></span></div></div><div><p>"),Dh=G("<br>"),Bw=G("<strong>");const Fw=t=>{const{t:e}=ot(),r={"min-height":"calc(100vh - 200px)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},n={"text-align":"center","max-width":"600px",width:"100%"},i={"font-size":"5rem",color:"#e53e3e","margin-bottom":"2rem"},o={"font-size":"2.5rem","font-weight":"700",color:"#1a202c","margin-bottom":"1rem"},a={"font-size":"1.25rem",color:"#718096","margin-bottom":"2rem","line-height":"1.6"},c={background:"#f7fafc",border:"1px solid #e2e8f0","border-radius":"0.5rem",padding:"1.5rem","margin-bottom":"2rem"},u={color:"#4a5568","font-size":"1rem","line-height":"1.6"},h={display:"flex",gap:"1rem","justify-content":"center","flex-wrap":"wrap"},f={padding:"0.75rem 2rem","border-radius":"0.5rem","text-decoration":"none","font-weight":"500",transition:"all 0.2s",display:"inline-block"},g={...f,background:"var(--primary-color)",color:"white",border:"2px solid var(--primary-color)"},b={...f,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},C={"text-align":"left","margin-top":"2rem",padding:"0 2rem"},R={display:"flex","align-items":"center",gap:"0.75rem","margin-bottom":"1rem",color:"#4a5568"},T={color:"#48bb78","font-size":"1.25rem"};return _(Dr,{get title(){return e("unauthorized.title")},get children(){var E=Vw(),$=E.firstChild,K=$.firstChild,Z=K.nextSibling,J=Z.nextSibling,de=J.firstChild,re=J.nextSibling,I=re.firstChild,S=I.firstChild;S.nextSibling;var v=re.nextSibling,w=v.firstChild,P=v.nextSibling,A=P.firstChild,y=A.nextSibling,se=y.firstChild,W=se.nextSibling,k=y.nextSibling,H=k.firstChild,V=H.nextSibling,O=k.nextSibling,D=O.firstChild,M=D.nextSibling,he=P.nextSibling,z=he.firstChild;return d(E,r),d($,n),d(K,i),d(Z,o),s(Z,()=>e("unauthorized.accessDenied")),d(J,a),s(J,()=>e("unauthorized.noPermission"),de),s(J,(()=>{var pe=me(()=>!!t.featureName);return()=>pe()?` ${t.featureName}`:` ${e("unauthorized.thisFeature")}`})(),de),d(re,c),d(I,u),s(S,()=>e("unauthorized.whySeeing")),s(I,()=>e("unauthorized.explanation"),null),s(I,(()=>{var pe=me(()=>!!t.requiredPermission);return()=>pe()&&[Dh(),Dh(),(()=>{var x=Bw();return s(x,()=>e("unauthorized.requiredPermission")),x})()," ",me(()=>t.requiredPermission)]})(),null),d(v,h),s(v,_(tn,{href:"/",style:g,get children(){return e("unauthorized.goToDashboard")}}),w),w.$$click=()=>window.history.back(),s(w,()=>e("unauthorized.goBack")),d(P,C),A.style.setProperty("margin-bottom","1rem"),A.style.setProperty("color","#2d3748"),s(A,()=>e("unauthorized.featuresCanAccess")),s(W,()=>e("unauthorized.dashboardAccess")),s(V,()=>e("unauthorized.profileAccess")),s(M,()=>e("unauthorized.roleBasedAccess")),he.style.setProperty("margin-top","3rem"),he.style.setProperty("padding","1.5rem"),he.style.setProperty("background","#edf2f7"),he.style.setProperty("border-radius","0.5rem"),z.style.setProperty("color","#4a5568"),z.style.setProperty("font-size","0.875rem"),s(z,()=>e("unauthorized.needAccess")),ie(pe=>{var x=b,F=R,ee=T,Q=R,ue=T,te=R,B=T;return pe.e=d(w,x,pe.e),pe.t=d(y,F,pe.t),pe.a=d(se,ee,pe.a),pe.o=d(k,Q,pe.o),pe.i=d(H,ue,pe.i),pe.n=d(O,te,pe.n),pe.s=d(D,B,pe.s),pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),E}})};_t(["click"]);const Zr=t=>{const{t:e}=ot(),r=()=>{if(!t.permission)return!0;const i=Et.state?.profile;if(!i)return!1;switch(t.permission){case"AccountAccess":return i.AccountAccess===!0;case"InventoryAccess":return i.InventoryAccess===!0;case"EmployeeAccess":return i.EmployeeAccess===!0;case"BankingAccess":return i.BankingAccess===!0;case"JournalAccess":return i.JournalAccess===!0;case"AdminAccess":return i.isAdmin===!0;default:return i[t.permission]===!0}},n=()=>{if(t.requiredPermission)return t.requiredPermission;switch(t.permission){case"AccountAccess":return e("unauthorized.permissions.accountAccess");case"InventoryAccess":return e("unauthorized.permissions.inventoryAccess");case"EmployeeAccess":return e("unauthorized.permissions.employeeAccess");case"BankingAccess":return e("unauthorized.permissions.bankingAccess");case"JournalAccess":return e("unauthorized.permissions.journalAccess");case"AdminAccess":return e("unauthorized.permissions.adminAccess");default:return t.permission}};return _(Le,{get when(){return r()},get fallback(){return t.fallback||_(Fw,{get featureName(){return t.featureName},get requiredPermission(){return n()}})},get children(){return t.children}})};var Uw=G('<button title="Open Dev Tools">🛠️'),jw=G("<span>(<!>)"),zw=G("<div><span></span><span>"),Nh=G("<div>"),qw=G("<div>Database reset only available in fake mode"),Hw=G("<div><div>Loading..."),Gw=G("<div><div><h3>🛠️ Dev Tools</h3><button>✕</button></div><div><div>API Mode</div><div><button>Fake Server</button><button>Real API</button><button>Hybrid</button></div><div>Current: <strong></strong></div></div><div><div>Health Status</div></div><div><div>Database Stats</div></div><div><div>Actions</div><div><button>🔄 Refresh Stats</button><button>💊 Health Check</button></div><div><button>🗑️ Reset DB</button></div></div><div><div>Info</div><div>• <strong>Fake Server:</strong> Uses local mock data<br>• <strong>Real API:</strong> Connects to actual backend<br>• <strong>Hybrid:</strong> Real API with fake fallback<br>• Settings are saved in localStorage"),Ww=G("<div>Loading..."),Yw=G("<div><span>:</span><span>");const Kw=()=>{const[t,e]=ge(!1),[r,n]=ge(Yo.getMode()),[i,o]=ge({}),[a,c]=ge(null),[u,h]=ge(!1);Qr(async()=>{await f(),await g()});const f=async()=>{try{const I=await rd.getStats();o(I)}catch(I){console.error("Failed to load stats:",I)}},g=async()=>{try{const I=await rd.healthCheck();c(I)}catch(I){console.error("Health check failed:",I),c({status:"error",error:I.message})}},b=async I=>{h(!0);try{Yo.setMode(I),n(I),await f(),await g()}catch(S){console.error("Failed to change API mode:",S)}finally{h(!1)}},C=async()=>{if(confirm("Are you sure you want to reset the fake database to its initial state?")){h(!0);try{const I=await kr.utils.resetDatabase();alert(I.message),await f()}catch(I){console.error("Failed to reset database:",I),alert("Failed to reset database")}finally{h(!1)}}},R={position:"fixed",bottom:"20px",right:"20px","z-index":"10000","font-family":"monospace"},T={background:"#1a1a1a",color:"#fff",border:"1px solid #333","border-radius":"8px",padding:"16px","min-width":"300px","max-width":"400px","box-shadow":"0 4px 20px rgba(0,0,0,0.3)"},E={background:"#007acc",color:"#fff",border:"none","border-radius":"50%",width:"50px",height:"50px",cursor:"pointer","font-size":"20px","box-shadow":"0 2px 10px rgba(0,0,0,0.2)",display:"flex","align-items":"center","justify-content":"center"},$={background:"#333",color:"#fff",border:"1px solid #555","border-radius":"4px",padding:"6px 12px",cursor:"pointer","font-size":"12px","margin-right":"8px","margin-bottom":"8px"},K={...$,background:"#007acc","border-color":"#007acc"},Z={"margin-bottom":"16px","padding-bottom":"12px","border-bottom":"1px solid #333"},J={"font-size":"14px","font-weight":"bold","margin-bottom":"8px",color:"#007acc"},de={display:"flex","justify-content":"space-between","font-size":"12px","margin-bottom":"4px"},re=I=>({display:"inline-block",width:"8px",height:"8px","border-radius":"50%","margin-right":"8px",background:I==="healthy"?"#00ff00":I==="error"?"#ff0000":"#ffff00"});return(()=>{var I=Nh();return s(I,_(Le,{get when(){return!t()},get children(){var S=Uw();return S.$$click=()=>e(!0),d(S,E),S}}),null),s(I,_(Le,{get when(){return t()},get children(){var S=Gw(),v=S.firstChild,w=v.firstChild,P=w.nextSibling,A=v.nextSibling,y=A.firstChild,se=y.nextSibling,W=se.firstChild,k=W.nextSibling,H=k.nextSibling,V=se.nextSibling,O=V.firstChild,D=O.nextSibling,M=A.nextSibling,he=M.firstChild,z=M.nextSibling,pe=z.firstChild,x=z.nextSibling,F=x.firstChild,ee=F.nextSibling,Q=ee.firstChild,ue=Q.nextSibling,te=ee.nextSibling,B=te.firstChild,ae=x.nextSibling,ve=ae.firstChild,be=ve.nextSibling;return d(S,T),v.style.setProperty("display","flex"),v.style.setProperty("justify-content","space-between"),v.style.setProperty("align-items","center"),v.style.setProperty("margin-bottom","16px"),w.style.setProperty("margin","0"),w.style.setProperty("color","#007acc"),w.style.setProperty("font-size","16px"),P.$$click=()=>e(!1),W.$$click=()=>b("fake"),k.$$click=()=>b("real"),H.$$click=()=>b("hybrid"),V.style.setProperty("font-size","11px"),V.style.setProperty("color","#888"),V.style.setProperty("margin-top","4px"),s(D,r),s(V,()=>r()==="fake"&&" (Using fake server)",null),s(V,()=>r()==="real"&&" (Using real API)",null),s(V,()=>r()==="hybrid"&&" (Real API with fallback)",null),s(M,_(Le,{get when(){return a()},get fallback(){return(()=>{var oe=Ww();return oe.style.setProperty("font-size","12px"),oe})()},get children(){return[(()=>{var oe=zw(),ce=oe.firstChild,Y=ce.nextSibling;return oe.style.setProperty("display","flex"),oe.style.setProperty("align-items","center"),oe.style.setProperty("font-size","12px"),s(Y,()=>a()?.status||"Unknown"),s(oe,_(Le,{get when(){return a()?.timestamp},get children(){var q=jw(),N=q.firstChild,ne=N.nextSibling;return ne.nextSibling,q.style.setProperty("margin-left","8px"),q.style.setProperty("color","#888"),s(q,()=>new Date(a().timestamp).toLocaleTimeString(),ne),q}}),null),ie(q=>d(ce,re(a()?.status||"unknown"),q)),oe})(),_(Le,{get when(){return a()?.error},get children(){var oe=Nh();return oe.style.setProperty("font-size","11px"),oe.style.setProperty("color","#ff6666"),oe.style.setProperty("margin-top","4px"),s(oe,()=>a().error),oe}})]}}),null),s(z,_(xt,{get each(){return Object.entries(i())},children:([oe,ce])=>(()=>{var Y=Yw(),q=Y.firstChild,N=q.firstChild,ne=q.nextSibling;return d(Y,de),q.style.setProperty("text-transform","capitalize"),s(q,oe,N),ne.style.setProperty("color","#00ff00"),s(ne,ce),Y})()}),null),Q.$$click=f,ue.$$click=g,te.style.setProperty("margin-top","8px"),B.$$click=C,s(x,_(Le,{get when(){return r()!=="fake"},get children(){var oe=qw();return oe.style.setProperty("font-size","11px"),oe.style.setProperty("color","#888"),oe.style.setProperty("margin-top","4px"),oe}}),null),be.style.setProperty("font-size","11px"),be.style.setProperty("color","#888"),be.style.setProperty("line-height","1.4"),s(S,_(Le,{get when(){return u()},get children(){var oe=Hw(),ce=oe.firstChild;return oe.style.setProperty("position","absolute"),oe.style.setProperty("top","0"),oe.style.setProperty("left","0"),oe.style.setProperty("right","0"),oe.style.setProperty("bottom","0"),oe.style.setProperty("background","rgba(0,0,0,0.7)"),oe.style.setProperty("display","flex"),oe.style.setProperty("align-items","center"),oe.style.setProperty("justify-content","center"),oe.style.setProperty("border-radius","8px"),ce.style.setProperty("color","#fff"),ce.style.setProperty("font-size","14px"),oe}}),null),ie(oe=>{var ce={...$,padding:"4px 8px"},Y=Z,q=J,N=r()==="fake"?K:$,ne=u(),fe=r()==="real"?K:$,U=u(),j=r()==="hybrid"?K:$,Se=u(),we=Z,le=J,ye=Z,X=J,Pe=Z,ke=J,Te=$,$e=u(),Ue=$,Ye=u(),ze={...$,background:"#cc4400","border-color":"#cc4400"},Ee=u()||r()!=="fake",Me=J;return oe.e=d(P,ce,oe.e),oe.t=d(A,Y,oe.t),oe.a=d(y,q,oe.a),oe.o=d(W,N,oe.o),ne!==oe.i&&(W.disabled=oe.i=ne),oe.n=d(k,fe,oe.n),U!==oe.s&&(k.disabled=oe.s=U),oe.h=d(H,j,oe.h),Se!==oe.r&&(H.disabled=oe.r=Se),oe.d=d(M,we,oe.d),oe.l=d(he,le,oe.l),oe.u=d(z,ye,oe.u),oe.c=d(pe,X,oe.c),oe.w=d(x,Pe,oe.w),oe.m=d(F,ke,oe.m),oe.f=d(Q,Te,oe.f),$e!==oe.y&&(Q.disabled=oe.y=$e),oe.g=d(ue,Ue,oe.g),Ye!==oe.p&&(ue.disabled=oe.p=Ye),oe.b=d(B,ze,oe.b),Ee!==oe.T&&(B.disabled=oe.T=Ee),oe.A=d(ve,Me,oe.A),oe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),S}}),null),ie(S=>d(I,R,S)),I})()};_t(["click"]);var Qw=G("<div>$124,350"),Jw=G("<div>+12% from last month"),Xw=G("<div>247"),Vi=G("<div>"),Zw=G("<div>18"),eC=G("<div>$89,250"),tC=G("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const rC=()=>{const{t}=ot(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},n={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)",margin:"0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"};return _(Dr,{get title(){return t("dashboard.title")},get children(){return[(()=>{var o=Vi();return d(o,e),s(o,_(We,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var a=Qw();return ie(c=>d(a,n,c)),a})(),(()=>{var a=Jw();return ie(c=>d(a,i,c)),a})()]}}),null),s(o,_(We,{get title(){return t("dashboard.employeeCount")},get subtitle(){return t("dashboard.current")},get children(){return[(()=>{var a=Xw();return ie(c=>d(a,n,c)),a})(),(()=>{var a=Vi();return s(a,()=>t("dashboard.newHires")),ie(c=>d(a,i,c)),a})()]}}),null),s(o,_(We,{get title(){return t("dashboard.pendingInvoices")},get subtitle(){return t("dashboard.outstanding")},get children(){return[(()=>{var a=Zw();return ie(c=>d(a,n,c)),a})(),(()=>{var a=Vi();return s(a,()=>t("dashboard.totalOutstanding")),ie(c=>d(a,i,c)),a})()]}}),null),s(o,_(We,{get title(){return t("dashboard.cashBalance")},get subtitle(){return t("accounts.title")},get children(){return[(()=>{var a=eC();return ie(c=>d(a,n,c)),a})(),(()=>{var a=Vi();return s(a,()=>t("dashboard.lastUpdatedToday")),ie(c=>d(a,i,c)),a})()]}}),null),o})(),(()=>{var o=Vi();return d(o,r),s(o,_(We,{get title(){return t("dashboard.quickActions")},get subtitle(){return t("dashboard.commonTasks")},get children(){var a=Vi();return a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("gap","1rem"),s(a,_(De,{variant:"primary",get children(){return t("invoices.createNew")}}),null),s(a,_(De,{variant:"secondary",get children(){return t("employees.addEmployee")}}),null),s(a,_(De,{variant:"outline",get children(){return t("dashboard.generateReport")}}),null),a}}),null),s(o,_(We,{get title(){return t("dashboard.recentActivity")},get subtitle(){return t("dashboard.latestUpdates")},get children(){var a=tC(),c=a.firstChild,u=c.firstChild,h=u.nextSibling,f=c.nextSibling,g=f.firstChild,b=g.nextSibling,C=f.nextSibling,R=C.firstChild,T=R.nextSibling;return a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("gap","0.75rem"),c.style.setProperty("border-bottom","1px solid var(--border-color)"),c.style.setProperty("padding-bottom","0.5rem"),u.style.setProperty("font-weight","500"),s(u,()=>t("dashboard.invoicePaid")),h.style.setProperty("font-size","0.875rem"),h.style.setProperty("color","var(--text-muted)"),s(h,()=>t("dashboard.hoursAgo")),f.style.setProperty("border-bottom","1px solid var(--border-color)"),f.style.setProperty("padding-bottom","0.5rem"),g.style.setProperty("font-weight","500"),s(g,()=>t("dashboard.newEmployeeOnboarded")),b.style.setProperty("font-size","0.875rem"),b.style.setProperty("color","var(--text-muted)"),s(b,()=>t("dashboard.dayAgo")),R.style.setProperty("font-weight","500"),s(R,()=>t("dashboard.monthlyReportGenerated")),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","var(--text-muted)"),s(T,()=>t("dashboard.daysAgo")),a}}),null),o})()]}})},nC=[{id:"1",accountNumber:"1000",name:"Cash and Cash Equivalents",type:"Asset",category:"Current Assets",description:"Cash on hand and in bank accounts",balance:45230.5,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1001",accountNumber:"1001",name:"Petty Cash",type:"Asset",category:"Current Assets",description:"Small amounts of cash for minor expenses",balance:500,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1002",accountNumber:"1002",name:"Bank - Checking Account",type:"Asset",category:"Current Assets",description:"Main operating checking account",balance:32730.5,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1003",accountNumber:"1003",name:"Bank - Savings Account",type:"Asset",category:"Current Assets",description:"Interest-bearing savings account",balance:12e3,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"2",accountNumber:"1100",name:"Accounts Receivable",type:"Asset",category:"Current Assets",description:"Money owed by customers",balance:23450.75,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2001",accountNumber:"1101",name:"Trade Receivables",type:"Asset",category:"Current Assets",description:"Receivables from regular customers",balance:18450.75,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2002",accountNumber:"1102",name:"Employee Advances",type:"Asset",category:"Current Assets",description:"Money advanced to employees",balance:5e3,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"3",accountNumber:"1200",name:"Inventory",type:"Asset",category:"Current Assets",description:"Products held for sale",balance:78920.25,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-13"},{id:"4",accountNumber:"1500",name:"Equipment",type:"Asset",category:"Fixed Assets",description:"Office equipment and machinery",balance:125e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-12"},{id:"5",accountNumber:"2000",name:"Accounts Payable",type:"Liability",category:"Current Liabilities",description:"Money owed to suppliers",balance:15670.3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-11"},{id:"6",accountNumber:"2100",name:"Accrued Expenses",type:"Liability",category:"Current Liabilities",description:"Expenses incurred but not yet paid",balance:8945.6,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-10"},{id:"7",accountNumber:"2500",name:"Long-term Debt",type:"Liability",category:"Long-term Liabilities",description:"Long-term loans and mortgages",balance:85e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-09"},{id:"8",accountNumber:"3000",name:"Owner's Equity",type:"Equity",category:"Owner's Equity",description:"Owner's investment in the business",balance:15e4,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-08"},{id:"9",accountNumber:"3100",name:"Retained Earnings",type:"Equity",category:"Owner's Equity",description:"Accumulated profits retained in business",balance:32450.8,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-07"},{id:"10",accountNumber:"4000",name:"Sales Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from product sales",balance:245678.9,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-06"},{id:"11",accountNumber:"4100",name:"Service Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from services provided",balance:89432.15,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-05"},{id:"12",accountNumber:"5000",name:"Cost of Goods Sold",type:"Expense",category:"Operating Expenses",description:"Direct costs of producing goods",balance:125678.45,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-04"},{id:"13",accountNumber:"5100",name:"Salaries Expense",type:"Expense",category:"Operating Expenses",description:"Employee salary expenses",balance:98765.32,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-03"},{id:"14",accountNumber:"5200",name:"Rent Expense",type:"Expense",category:"Operating Expenses",description:"Office rent expenses",balance:24e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-02"}],iC=[{id:"1",accountId:"1",date:"2024-01-15",description:"Customer payment received",debitAmount:5e3,creditAmount:0,reference:"INV-2024-001",type:"debit"},{id:"2",accountId:"2",date:"2024-01-15",description:"Customer payment received",debitAmount:0,creditAmount:5e3,reference:"INV-2024-001",type:"credit"},{id:"3",accountId:"5",date:"2024-01-14",description:"Office supplies purchased",debitAmount:0,creditAmount:1250,reference:"PO-2024-001",type:"credit"}],[en,Ms]=ge(nC),[bl,oC]=ge(iC),ut={get accounts(){return en()},get transactions(){return bl()},fetchAllAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return Ms([...en(),e]),e},addAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return Ms([...en(),e]),e},updateAccount(t,e){Ms(en().map(r=>r.id===t?{...r,...e,lastModified:new Date().toISOString().split("T")[0]}:r))},deleteAccount(t){Ms(en().filter(e=>e.id!==t))},getAccountById(t){return en().find(e=>e.id===t)},getAccountsByType(t){return en().filter(e=>e.type===t)},getAccountTransactions(t){return bl().filter(e=>e.accountId===t)},addTransaction(t){const e={...t,id:Date.now().toString()};oC([...bl(),e]);const r=this.getAccountById(t.accountId);if(r){const n=t.type==="debit"?t.debitAmount:-t.creditAmount;this.updateAccount(t.accountId,{balance:r.balance+n})}return e},getTotalByType(t){return en().filter(e=>e.type===t&&e.isActive).reduce((e,r)=>e+r.balance,0)},getAccountCategories(t){const e=this.getAccountsByType(t);return[...new Set(e.map(r=>r.category))]},getSubAccounts(t){return en().filter(e=>e.parentAccountId===t)},getParentAccounts(){return en().filter(t=>!t.parentAccountId)},getAccountHierarchy(){return this.getParentAccounts().map(e=>({...e,subAccounts:this.getSubAccounts(e.id)}))},getAccountWithSubAccounts(t){const e=this.getAccountById(t);return e?{...e,subAccounts:this.getSubAccounts(t),parentAccount:e.parentAccountId?this.getAccountById(e.parentAccountId):null}:null},getAccountPath(t){const e=this.getAccountById(t);if(!e)return[];const r=[e];let n=e;for(;n.parentAccountId;){const i=this.getAccountById(n.parentAccountId);if(i)r.unshift(i),n=i;else break}return r},getTotalBalanceWithSubAccounts(t){const e=this.getAccountById(t);if(!e)return 0;const n=this.getSubAccounts(t).reduce((i,o)=>i+this.getTotalBalanceWithSubAccounts(o.id),0);return e.balance+n},canDeleteAccount(t){const e=this.getSubAccounts(t);if(e.length>0)return{canDelete:!1,reason:`Account has ${e.length} sub-account(s). Delete or move sub-accounts first.`};const r=this.getAccountTransactions(t);return r.length>0?{canDelete:!1,reason:`Account has ${r.length} transaction(s). Cannot delete account with transaction history.`}:{canDelete:!0}}};var Nn=G("<div>"),Ao=G("<div> ");const sC=()=>{const{t}=ot(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},n={"font-size":"0.875rem",color:"var(--text-muted)"},i=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T),o=ut.getTotalByType("Asset"),a=ut.getTotalByType("Liability"),c=ut.getTotalByType("Equity"),u=ut.getTotalByType("Revenue"),h=ut.getTotalByType("Expense"),f=ut.getAccountsByType("Asset").length,g=ut.getAccountsByType("Liability").length,b=ut.getAccountsByType("Equity").length,C=ut.getAccountsByType("Revenue").length,R=ut.getAccountsByType("Expense").length;return(()=>{var T=Nn();return d(T,e),s(T,_(We,{get title(){return t("dashboard.totalAssets")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var E=Nn();return s(E,()=>i(o)),ie($=>d(E,r,$)),E})(),(()=>{var E=Ao(),$=E.firstChild;return s(E,f,$),s(E,()=>t("navigation.accounts"),null),ie(K=>d(E,n,K)),E})()]}}),null),s(T,_(We,{get title(){return t("dashboard.totalLiabilities")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var E=Nn();return s(E,()=>i(a)),ie($=>d(E,r,$)),E})(),(()=>{var E=Ao(),$=E.firstChild;return s(E,g,$),s(E,()=>t("navigation.accounts"),null),ie(K=>d(E,n,K)),E})()]}}),null),s(T,_(We,{get title(){return t("dashboard.totalEquity")},get subtitle(){return t("accounts.categories.ownersEquity")},get children(){return[(()=>{var E=Nn();return s(E,()=>i(c)),ie($=>d(E,r,$)),E})(),(()=>{var E=Ao(),$=E.firstChild;return s(E,b,$),s(E,()=>t("navigation.accounts"),null),ie(K=>d(E,n,K)),E})()]}}),null),s(T,_(We,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("accounts.categories.operatingRevenue")},get children(){return[(()=>{var E=Nn();return s(E,()=>i(u)),ie($=>d(E,r,$)),E})(),(()=>{var E=Ao(),$=E.firstChild;return s(E,C,$),s(E,()=>t("navigation.accounts"),null),ie(K=>d(E,n,K)),E})()]}}),null),s(T,_(We,{get title(){return t("dashboard.totalExpenses")},get subtitle(){return t("accounts.categories.operatingExpenses")},get children(){return[(()=>{var E=Nn();return s(E,()=>i(h)),ie($=>d(E,r,$)),E})(),(()=>{var E=Ao(),$=E.firstChild;return s(E,R,$),s(E,()=>t("navigation.accounts"),null),ie(K=>d(E,n,K)),E})()]}}),null),s(T,_(We,{get title(){return t("dashboard.netIncome")},get subtitle(){return`${t("dashboard.totalRevenue")} - ${t("dashboard.totalExpenses")}`},get children(){return[(()=>{var E=Nn();return s(E,()=>i(u-h)),ie($=>d(E,{...r,color:u-h>=0?"#4caf50":"#f44336"},$)),E})(),(()=>{var E=Nn();return s(E,()=>u-h>=0?t("dashboard.netIncome"):t("dashboard.netLoss")),ie($=>d(E,n,$)),E})()]}}),null),T})()};var aC=G("<div><div></div><div>"),lC=G("<h3>"),Io=G("<div>");const cC=t=>{const{t:e}=ot();Cc();const r={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},i={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"},o={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},a={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},c={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem"},u={"font-size":"0.875rem",color:"var(--text-secondary)","line-height":"1.4"},h=b=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[b]||{bg:"#f5f5f5",color:"#666"},f=b=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(b),g=h(t.account.type);return _(We,{get children(){return[(()=>{var b=aC(),C=b.firstChild,R=C.nextSibling;return d(b,n),d(C,i),s(C,()=>t.account.accountNumber),s(R,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),ie(T=>d(R,{...o,background:g.bg,color:g.color},T)),b})(),(()=>{var b=lC();return b.style.setProperty("margin","0 0 0.5rem 0"),b.style.setProperty("font-size","1.1rem"),s(b,()=>t.account.name),b})(),(()=>{var b=Io();return d(b,c),s(b,()=>t.account.category),b})(),(()=>{var b=Io();return d(b,a),s(b,()=>f(t.account.balance)),b})(),(()=>{var b=Io();return d(b,u),s(b,()=>t.account.description),b})(),me(()=>me(()=>!t.account.isActive)()&&(()=>{var b=Io();return b.style.setProperty("margin-top","0.5rem"),b.style.setProperty("padding","0.25rem 0.75rem"),b.style.setProperty("border-radius","9999px"),b.style.setProperty("font-size","0.75rem"),b.style.setProperty("font-weight","500"),b.style.setProperty("background","#ffebee"),b.style.setProperty("color","#d32f2f"),b.style.setProperty("text-align","center"),s(b,()=>e("common.inactive")),b})()),(()=>{var b=Io();return d(b,r),s(b,_(De,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.account),get children(){return[me(()=>e("common.view"))," ",me(()=>e("accounts.accountDetails"))]}})),b})()]}})};var uC=G("<div><div><div><div></div><h3></h3></div></div><div><div></div><div>"),dC=G("<div>"),hC=G("<button>"),mC=G("<div><h4> (<!>)"),fC=G("<div><div><div></div><div> • </div></div><div>");const yC=t=>{const{t:e}=ot(),r=Cc(),[n,i]=ge(!0),o={"margin-bottom":"1rem"},a={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},c={display:"flex","align-items":"center",gap:"1rem"},u={background:"none",border:"none",cursor:"pointer","font-size":"1.2rem",color:"var(--text-muted)",padding:"0.25rem","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease"},h={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},f={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},g={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},b={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},C={"margin-left":"1rem","border-left":"2px solid var(--border-color)","padding-left":"1rem","margin-top":"1rem"},R={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem","margin-bottom":"0.5rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},T={flex:"1"},E={"font-weight":"500","margin-bottom":"0.25rem"},$={"font-size":"0.875rem",color:"var(--text-muted)"},K={"font-weight":"600",color:"var(--primary-color)"},Z={display:"flex",gap:"0.5rem"},J=w=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[w]||{bg:"#f5f5f5",color:"#666"},de=w=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(w),re=w=>{t.onViewDetails?t.onViewDetails(w):r(`/accounts/${w.id}`)},I=()=>{t.onAddSubAccount&&t.onAddSubAccount(t.account)},S=t.account.balance+t.account.subAccounts.reduce((w,P)=>w+P.balance,0),v=J(t.account.type);return _(We,{className:"account-hierarchy-card",style:o,get children(){return[(()=>{var w=uC(),P=w.firstChild,A=P.firstChild,y=A.firstChild,se=y.nextSibling,W=P.nextSibling,k=W.firstChild,H=k.nextSibling;return d(w,a),d(P,c),s(P,(()=>{var V=me(()=>t.account.subAccounts.length>0);return()=>V()&&(()=>{var O=hC();return O.addEventListener("mouseleave",D=>D.target.style.background="none"),O.addEventListener("mouseenter",D=>D.target.style.background="var(--background-color)"),O.$$click=()=>i(!n()),d(O,u),s(O,()=>n()?"▼":"▶"),O})()})(),A),A.$$click=()=>re(t.account),A.style.setProperty("cursor","pointer"),d(y,h),s(y,()=>t.account.accountNumber),d(se,f),s(se,()=>t.account.name),W.style.setProperty("text-align","right"),d(k,g),s(k,()=>de(S)),s(H,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),ie(V=>d(H,{...b,background:v.bg,color:v.color},V)),w})(),(()=>{var w=dC();return d(w,Z),s(w,_(De,{variant:"secondary",size:"sm",onClick:()=>re(t.account),get children(){return[me(()=>e("common.view"))," ",me(()=>e("accounts.accountDetails"))]}}),null),s(w,_(De,{variant:"outline",size:"sm",onClick:I,get children(){return[me(()=>e("common.add"))," ",me(()=>e("accounts.subAccounts"))]}}),null),w})(),me(()=>me(()=>!!(n()&&t.account.subAccounts.length>0))()&&(()=>{var w=mC(),P=w.firstChild,A=P.firstChild,y=A.nextSibling;return y.nextSibling,d(w,C),P.style.setProperty("margin","0 0 1rem 0"),P.style.setProperty("font-size","1rem"),P.style.setProperty("color","var(--text-muted)"),s(P,()=>e("accounts.subAccounts"),A),s(P,()=>t.account.subAccounts.length,y),s(w,()=>t.account.subAccounts.map(se=>(()=>{var W=fC(),k=W.firstChild,H=k.firstChild,V=H.nextSibling,O=V.firstChild,D=k.nextSibling;return W.addEventListener("mouseleave",M=>{M.currentTarget.style.background="var(--background-color)",M.currentTarget.style.transform="translateY(0)"}),W.addEventListener("mouseenter",M=>{M.currentTarget.style.background="var(--surface-color)",M.currentTarget.style.transform="translateY(-1px)"}),W.$$click=()=>re(se),d(W,R),d(k,T),d(H,E),s(H,()=>se.name),d(V,$),s(V,()=>se.accountNumber,O),s(V,()=>se.description,null),d(D,K),s(D,()=>de(se.balance)),W})()),null),w})())]}})};_t(["click"]);var gC=G("<form><div>");const pC=t=>{const{t:e}=ot(),[r,n]=ge({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),i=[{value:"Asset",label:e("accounts.types.asset"),type:"debit",classification:"real"},{value:"Liability",label:e("accounts.types.liability"),type:"credit",classification:"real"},{value:"Equity",label:e("accounts.types.equity"),type:"credit",classification:"real"},{value:"Revenue",label:e("accounts.types.revenue"),type:"credit",classification:"nominal"},{value:"Expense",label:e("accounts.types.expense"),type:"debit",classification:"nominal"}],o=()=>{const f=r().type;return f?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")},{value:"Sales Revenue",label:e("accounts.categories.salesRevenue")},{value:"Service Revenue",label:e("accounts.categories.servicesRevenue")},{value:"Subscription Revenue",label:e("accounts.categories.subscriptionRevenue")},{value:"Rental Revenue",label:e("accounts.categories.rentalRevenue")},{value:"Commission Revenue",label:e("accounts.categories.commissionRevenue")},{value:"Franchise Revenue",label:e("accounts.categories.franchiseRevenue")},{value:"Licensing Revenue",label:e("accounts.categories.licensingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[f]||[]:[]},a=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],c={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},u=f=>{f.preventDefault();const g=r();if(!g.accountNumber||!g.name||!g.type||!g.category){alert(e("forms.requiredField"));return}if(ut.accounts.find(R=>R.accountNumber===g.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const C={accountNumber:g.accountNumber,name:g.name,type:g.type,category:g.category,description:g.description,balance:parseFloat(g.balance)||0,isActive:g.isActive==="true"};ut.addAccount(C),n({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},h=(f,g)=>{n(b=>{const C={...b,[f]:g};return f==="type"&&(C.category=""),C})};return _(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.addAccount")},get children(){var f=gC(),g=f.firstChild;return f.addEventListener("submit",u),s(f,_(wt,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:b=>h("accountNumber",b),get placeholder(){return e("accounts.accountNumber")},required:!0}),g),s(f,_(wt,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:b=>h("name",b),get placeholder(){return e("accounts.accountName")},required:!0}),g),s(f,_(hr,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:b=>h("type",b),options:i,required:!0}),g),s(f,_(hr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:b=>h("category",b),get options(){return o()},required:!0}),g),s(f,_(wt,{get label(){return e("common.description")},get value(){return r().description},onChange:b=>h("description",b),get placeholder(){return e("common.description")}}),g),s(f,_(wt,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:b=>h("balance",b),get placeholder(){return e("accounts.balance")}}),g),s(f,_(hr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:b=>h("isActive",b),options:a,required:!0}),g),d(g,c),s(g,_(De,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(g,_(De,{variant:"primary",type:"submit",get children(){return e("accounts.addAccount")}}),null),f}})};var vC=G("<form><div>"),bC=G("<div><div></div><div> - </div><div> • ");const _C=t=>{const{t:e}=ot(),[r,n]=ge({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),i=()=>t.parentAccount?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[t.parentAccount.type]||[]:[],o=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],a={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},c={background:"var(--background-color)",padding:"1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1.5rem",border:"1px solid var(--border-color)"},u={"font-size":"0.875rem","font-weight":"500",color:"var(--text-muted)","margin-bottom":"0.5rem"},h={"font-weight":"600",color:"var(--text-primary)"},f={"font-size":"0.875rem",color:"var(--text-secondary)"},g=T=>{T.preventDefault();const E=r();if(!E.accountNumber||!E.name||!E.category||!t.parentAccount){alert(e("forms.requiredField"));return}if(ut.accounts.find(Z=>Z.accountNumber===E.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const K={accountNumber:E.accountNumber,name:E.name,type:t.parentAccount.type,category:E.category,description:E.description,balance:parseFloat(E.balance)||0,isActive:E.isActive==="true",parentAccountId:t.parentAccount.id};ut.addAccount(K),n({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},b=(T,E)=>{n($=>({...$,[T]:E}))},C=()=>{if(!t.parentAccount)return"";const T=t.parentAccount.accountNumber,$=ut.getSubAccounts(t.parentAccount.id).length+1;return(parseInt(T)+$).toString()},R=()=>r().accountNumber===""&&t.parentAccount?C():r().accountNumber;return _(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return`${e("common.add")} ${e("accounts.subAccounts")}`},get children(){return[me(()=>me(()=>!!t.parentAccount)()&&(()=>{var T=bC(),E=T.firstChild,$=E.nextSibling,K=$.firstChild,Z=$.nextSibling,J=Z.firstChild;return d(T,c),d(E,u),s(E,()=>e("accounts.parentAccount")),d($,h),s($,()=>t.parentAccount.accountNumber,K),s($,()=>t.parentAccount.name,null),d(Z,f),s(Z,()=>e(`accounts.types.${t.parentAccount.type.toLowerCase()}`),J),s(Z,()=>t.parentAccount.category,null),T})()),(()=>{var T=vC(),E=T.firstChild;return T.addEventListener("submit",g),s(T,_(wt,{get label(){return e("accounts.accountNumber")},get value(){return R()},onChange:$=>b("accountNumber",$),get placeholder(){return`${e("common.suggested")}: ${C()}`},required:!0}),E),s(T,_(wt,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:$=>b("name",$),get placeholder(){return e("accounts.accountName")},required:!0}),E),s(T,_(hr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:$=>b("category",$),get options(){return i()},required:!0}),E),s(T,_(wt,{get label(){return e("common.description")},get value(){return r().description},onChange:$=>b("description",$),get placeholder(){return e("common.description")}}),E),s(T,_(wt,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:$=>b("balance",$),get placeholder(){return e("accounts.balance")}}),E),s(T,_(hr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:$=>b("isActive",$),options:o,required:!0}),E),d(E,a),s(E,_(De,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(E,_(De,{variant:"primary",type:"submit",get children(){return[me(()=>e("common.add"))," ",me(()=>e("accounts.subAccounts"))]}}),null),T})()]}})};var SC=G("<form><div>"),PC=G("<div>");const wC=t=>{const{t:e}=ot(),[r,n]=ge({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),[i,o]=ge(null);ri(()=>{t.account&&(n({accountNumber:t.account.accountNumber,name:t.account.name,type:t.account.type,category:t.account.category,description:t.account.description,balance:t.account.balance.toString(),isActive:t.account.isActive.toString()}),o(null))});const a=[{value:"Asset",label:e("accounts.types.asset")},{value:"Liability",label:e("accounts.types.liability")},{value:"Equity",label:e("accounts.types.equity")},{value:"Revenue",label:e("accounts.types.revenue")},{value:"Expense",label:e("accounts.types.expense")}],c=()=>{const C=r().type;return C?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[C]||[]:[]},u=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},f=C=>{if(C.preventDefault(),o(null),!t.account)return;const R=r();if(!R.accountNumber||!R.name||!R.type||!R.category){o(e("forms.requiredField"));return}if(ut.accounts.find($=>$.accountNumber===R.accountNumber&&$.id!==t.account.id)){o(e("forms.duplicateAccountNumber"));return}const E={accountNumber:R.accountNumber,name:R.name,type:R.type,category:R.category,description:R.description,balance:parseFloat(R.balance)||0,isActive:R.isActive==="true"};try{ut.updateAccount(t.account.id,E),t.onClose()}catch($){o($ instanceof Error?$.message:e("forms.saveError"))}},g=()=>{if(!t.account)return;const C=ut.canDeleteAccount(t.account.id);if(!C.canDelete){o(C.reason||e("forms.deleteError"));return}const R=e("forms.confirmDelete");if(confirm(R))try{ut.deleteAccount(t.account.id),t.onClose()}catch(T){o(T instanceof Error?T.message:e("forms.deleteError"))}},b=(C,R)=>{n(T=>{const E={...T,[C]:R};return C==="type"&&(E.category=""),E}),i()&&o(null)};return t.account?_(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.editAccount")},get children(){var C=SC(),R=C.firstChild;return C.addEventListener("submit",f),s(C,_(wt,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:T=>b("accountNumber",T),get placeholder(){return e("accounts.accountNumber")},required:!0}),R),s(C,_(wt,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:T=>b("name",T),get placeholder(){return e("accounts.accountName")},required:!0}),R),s(C,_(hr,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:T=>b("type",T),options:a,required:!0}),R),s(C,_(hr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:T=>b("category",T),get options(){return c()},required:!0}),R),s(C,_(wt,{get label(){return e("common.description")},get value(){return r().description},onChange:T=>b("description",T),get placeholder(){return e("common.description")}}),R),s(C,_(wt,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:T=>b("balance",T),get placeholder(){return e("accounts.balance")}}),R),s(C,_(hr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:T=>b("isActive",T),options:u,required:!0}),R),s(C,(()=>{var T=me(()=>!!i());return()=>T()&&(()=>{var E=PC();return E.style.setProperty("padding","1rem"),E.style.setProperty("border-radius","var(--border-radius-sm)"),E.style.setProperty("margin-top","1rem"),E.style.setProperty("background","#f8d7da"),E.style.setProperty("color","#721c24"),E.style.setProperty("border","1px solid #f5c6cb"),s(E,i),E})()})(),R),d(R,h),s(R,_(De,{variant:"outline",type:"button",onClick:g,style:{color:"#dc3545","border-color":"#dc3545","margin-right":"auto"},get children(){return e("accounts.deleteAccount")}}),null),s(R,_(De,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(R,_(De,{variant:"primary",type:"submit",get children(){return e("common.save")}}),null),C}}):null};var CC=G("<div><div>⚠️</div><div></div><div></div><div>"),AC=G("<div><div></div><div></div><div>"),IC=G("<div><button></button><button> (<!>)"),_l=G("<div>"),EC=G("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),xC=G("<div><div><div></div><div> • </div></div><div>");const TC=t=>{const{t:e}=ot(),[r,n]=ge("details"),[i,o]=ge(!1),a=qe(()=>t.account?ut.getAccountById(t.account.id)||t.account:null),c={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},u={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},h={"font-weight":"600",color:"var(--text-primary)"},f={"text-align":"center","margin-bottom":"2rem"},g={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},b={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},C={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem"},R={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},T=v=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:v?"var(--primary-color)":"var(--text-muted)","border-bottom":v?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),E={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},$={flex:"1"},K={"font-size":"0.875rem",color:"var(--text-muted)"},Z={"font-weight":"500","margin-bottom":"0.25rem"},J=v=>({"font-weight":"600",color:v==="debit"?"#4caf50":"#f44336"}),de={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},re=v=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[v]||{bg:"#f5f5f5",color:"#666"},I=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(v),S=v=>new Date(v).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return _(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.accountDetails")},get children(){return[me(()=>me(()=>!a())()?(()=>{var v=CC(),w=v.firstChild,P=w.nextSibling,A=P.nextSibling,y=A.nextSibling;return v.style.setProperty("text-align","center"),v.style.setProperty("padding","3rem"),v.style.setProperty("color","var(--text-muted)"),w.style.setProperty("font-size","1.5rem"),w.style.setProperty("margin-bottom","1rem"),P.style.setProperty("font-size","1.1rem"),P.style.setProperty("margin-bottom","0.5rem"),s(P,()=>e("common.error")),A.style.setProperty("font-size","0.875rem"),s(A,()=>e("common.noDataFound")),y.style.setProperty("margin-top","2rem"),s(y,_(De,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),v})():(()=>{const v=qe(()=>re(a().type)),w=qe(()=>ut.getAccountTransactions(a().id));return[(()=>{var P=AC(),A=P.firstChild,y=A.nextSibling,se=y.nextSibling;return d(P,f),d(A,g),s(A,()=>a().name),d(y,b),s(y,()=>I(a().balance)),s(se,()=>e(`accounts.types.${a().type.toLowerCase()}`)),ie(W=>d(se,{...C,background:v().bg,color:v().color},W)),P})(),(()=>{var P=IC(),A=P.firstChild,y=A.nextSibling,se=y.firstChild,W=se.nextSibling;return W.nextSibling,d(P,R),A.$$click=()=>n("details"),s(A,()=>e("accounts.accountDetails")),y.$$click=()=>n("transactions"),s(y,()=>e("accounts.transactions"),se),s(y,()=>w().length,W),ie(k=>{var H=T(r()==="details"),V=T(r()==="transactions");return k.e=d(A,H,k.e),k.t=d(y,V,k.t),k},{e:void 0,t:void 0}),P})(),me(()=>me(()=>r()==="details")()&&(()=>{var P=EC(),A=P.firstChild,y=A.firstChild,se=y.nextSibling,W=A.nextSibling,k=W.firstChild,H=k.nextSibling,V=W.nextSibling,O=V.firstChild,D=O.nextSibling,M=V.nextSibling,he=M.firstChild,z=he.nextSibling,pe=M.nextSibling,x=pe.firstChild,F=x.nextSibling,ee=pe.nextSibling,Q=ee.firstChild,ue=Q.nextSibling;return s(y,()=>e("accounts.accountNumber")),s(se,()=>a().accountNumber),s(k,()=>e("accounts.category")),s(H,()=>a().category),s(O,()=>e("common.description")),s(D,()=>a().description),s(he,()=>e("common.status")),s(z,(()=>{var te=me(()=>!!a().isActive);return()=>te()?e("common.active"):e("common.inactive")})()),s(x,()=>e("accounts.createdDate")),s(F,()=>S(a().createdDate)),s(Q,()=>e("accounts.lastModified")),s(ue,()=>S(a().lastModified)),ie(te=>{var B=c,ae=u,ve=h,be=c,oe=u,ce=h,Y=c,q=u,N=h,ne=c,fe=u,U=h,j=c,Se=u,we=h,le=c,ye=u,X=h;return te.e=d(A,B,te.e),te.t=d(y,ae,te.t),te.a=d(se,ve,te.a),te.o=d(W,be,te.o),te.i=d(k,oe,te.i),te.n=d(H,ce,te.n),te.s=d(V,Y,te.s),te.h=d(O,q,te.h),te.r=d(D,N,te.r),te.d=d(M,ne,te.d),te.l=d(he,fe,te.l),te.u=d(z,U,te.u),te.c=d(pe,j,te.c),te.w=d(x,Se,te.w),te.m=d(F,we,te.m),te.f=d(ee,le,te.f),te.y=d(Q,ye,te.y),te.g=d(ue,X,te.g),te},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),P})()),me(()=>me(()=>r()==="transactions")()&&(()=>{var P=_l();return s(P,(()=>{var A=me(()=>w().length===0);return()=>A()?(()=>{var y=_l();return y.style.setProperty("text-align","center"),y.style.setProperty("color","var(--text-muted)"),y.style.setProperty("padding","2rem"),s(y,()=>e("common.noDataFound")),y})():w().map(y=>(()=>{var se=xC(),W=se.firstChild,k=W.firstChild,H=k.nextSibling,V=H.firstChild,O=W.nextSibling;return d(se,E),d(W,$),d(k,Z),s(k,()=>y.description),d(H,K),s(H,()=>S(y.date),V),s(H,()=>y.reference,null),s(O,()=>y.type==="debit"?"+":"-",null),s(O,()=>I(y.type==="debit"?y.debitAmount:y.creditAmount),null),ie(D=>d(O,J(y.type),D)),se})())})()),P})()),(()=>{var P=_l();return d(P,de),s(P,_(De,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(P,_(De,{variant:"primary",onClick:()=>o(!0),get children(){return e("accounts.editAccount")}}),null),P})()]})()),me(()=>me(()=>!!a())()&&_(wC,{get isOpen(){return i()},onClose:()=>{o(!1)},get account(){return a()}}))]}})};_t(["click"]);const $C="https://qvamarkets.com/gql_api",[kC,Lh]=ge(!1),[RC,Sl]=ge(null);class DC{baseUrl;constructor(e=$C){this.baseUrl=e}async request(e,r,n,i){Lh(!0),Sl(null);try{const o=r.startsWith("http")?r:`${this.baseUrl}${r}`,a={method:e,headers:{"Content-Type":"application/json",Accept:"application/json",...i}};n&&(e==="POST"||e==="PUT"||e==="PATCH")&&(a.body=JSON.stringify(n));const c=await fetch(o,a);if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);const u=await c.json();if(u.errors&&u.errors.length>0)throw new Error(u.errors[0].message);return u.data||u}catch(o){const a=o instanceof Error?o.message:"Unknown error occurred";throw Sl(a),o}finally{Lh(!1)}}async graphql(e){return this.request("POST","",e)}async get(e,r){return this.request("GET",e,void 0,r)}async post(e,r,n){return this.request("POST",e,r,n)}async put(e,r,n){return this.request("PUT",e,r,n)}async patch(e,r,n){return this.request("PATCH",e,r,n)}async delete(e,r){return this.request("DELETE",e,void 0,r)}getLoadingState(){return kC()}getErrorState(){return RC()}clearError(){Sl(null)}}const Os=new DC,_u=`
  fragment AccountFields on Account {
    id
    accountNumber
    name
    type
    category
    description
    balance
    isActive
    parentAccountId
    createdDate
    lastModified
  }
`,NC=`
  query GetAccountById($id: ID!) {
    account(id: $id) {
      ...AccountFields
    }
  }
  ${_u}
`,LC=`
  mutation CreateAccount($input: CreateAccountInput!) {
    createAccount(input: $input) {
      ...AccountFields
    }
  }
  ${_u}
`,MC=`
  mutation UpdateAccount($id: ID!, $input: UpdateAccountInput!) {
    updateAccount(id: $id, input: $input) {
      ...AccountFields
    }
  }
  ${_u}
`,OC=`
  mutation DeleteAccount($id: ID!) {
    deleteAccount(id: $id) {
      success
      message
    }
  }
`;class VC{async getAccounts(e,r){try{if(Yo.isFakeMode())return await td.getAll(e);const n=await Un({query:"getAllYabaProducts",params:{businessId:"YB100423253156428"}});return console.log("Real API accounts response:",n),n?.accounts||[]}catch(n){if(console.error("Error fetching accounts:",n),Yo.isHybridMode())return console.warn("Falling back to fake API for accounts"),await td.getAll(e);throw n}}async getAccountById(e){try{return(await Os.graphql({query:NC,variables:{id:e}})).account}catch(r){throw console.error("Error fetching account:",r),r}}async createAccount(e){try{return(await Os.graphql({query:LC,variables:{input:e}})).createAccount}catch(r){throw console.error("Error creating account:",r),r}}async updateAccount(e,r){try{return(await Os.graphql({query:MC,variables:{id:e,input:r}})).updateAccount}catch(n){throw console.error("Error updating account:",n),n}}async deleteAccount(e){try{return(await Os.graphql({query:OC,variables:{id:e}})).deleteAccount}catch(r){throw console.error("Error deleting account:",r),r}}async getAccountsByType(e){return this.getAccounts({type:e})}async getAccountHierarchy(){const e=await this.getAccounts();return this.buildHierarchy(e)}buildHierarchy(e){const r=new Map,n=[];return e.forEach(i=>{r.set(i.id,{...i,subAccounts:[]})}),e.forEach(i=>{const o=r.get(i.id);if(i.parentAccountId){const a=r.get(i.parentAccountId);a&&(a.subAccounts=a.subAccounts||[],a.subAccounts.push(o))}else n.push(o)}),n}async getAccountBalance(e){const r=await this.getAccountById(e);return r?r.balance:0}async searchAccounts(e){return this.getAccounts({search:e})}}const BC=new VC;var FC=G("<div><h2></h2><div><span>:</span><button></button><button>"),UC=G("<div><span>:"),Mh=G("<div>"),jC=G("<button>");const zC=()=>{const{t}=ot(),[e,r]=ge(!1),[n,i]=ge(!1),[o,a]=ge(!1),[c,u]=ge(null),[h,f]=ge(null),[g,b]=ge("All"),[C,R]=ge("hierarchy"),T=S=>{u(S),a(!0)},E=S=>{f(S),i(!0)},$=()=>g()==="All"?C()==="hierarchy"?ut.getAccountHierarchy():ut.accounts:C()==="hierarchy"?ut.getAccountHierarchy().filter(S=>S.type===g()):ut.getAccountsByType(g()),K={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},Z={display:"flex",gap:"1rem","margin-bottom":"2rem","align-items":"center"},J=S=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:S?"var(--primary-color)":"var(--surface-color)",color:S?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500",transition:"all 0.2s ease"}),de={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},re={display:"flex",gap:"0.5rem","align-items":"center","margin-left":"auto","margin-right":"1rem"},I=S=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:S?"var(--primary-color)":"var(--surface-color)",color:S?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"});return _(Dr,{get title(){return t("accounts.title")},get children(){return[_(sC,{}),(()=>{var S=FC(),v=S.firstChild,w=v.nextSibling,P=w.firstChild,A=P.firstChild,y=P.nextSibling,se=y.nextSibling;return d(S,de),v.style.setProperty("margin","0"),v.style.setProperty("font-size","1.5rem"),s(v,()=>t("accounts.title")),d(w,re),P.style.setProperty("font-weight","500"),P.style.setProperty("color","var(--text-muted)"),P.style.setProperty("font-size","0.875rem"),s(P,()=>t("common.view"),A),y.$$click=()=>R("hierarchy"),s(y,()=>t("accounts.accountHierarchy")),se.$$click=()=>{R("flat"),BC.getAccounts()},s(se,()=>t("common.all")),s(S,_(De,{variant:"primary",onClick:()=>r(!0),get children(){return t("accounts.addAccount")}}),null),ie(W=>{var k=I(C()==="hierarchy"),H=I(C()==="flat");return W.e=d(y,k,W.e),W.t=d(se,H,W.t),W},{e:void 0,t:void 0}),S})(),(()=>{var S=UC(),v=S.firstChild,w=v.firstChild;return d(S,Z),v.style.setProperty("font-weight","500"),v.style.setProperty("color","var(--text-muted)"),s(v,()=>t("common.filter"),w),s(S,()=>[t("common.all"),t("accounts.types.asset"),t("accounts.types.liability"),t("accounts.types.equity"),t("accounts.types.revenue"),t("accounts.types.expense")].map((P,A)=>{const se=["All","Asset","Liability","Equity","Revenue","Expense"][A];return(()=>{var W=jC();return W.$$click=()=>b(se),s(W,P),ie(k=>d(W,J(g()===se),k)),W})()}),null),S})(),(()=>{var S=Mh();return s(S,(()=>{var v=me(()=>C()==="hierarchy");return()=>v()?$().map(w=>_(yC,{account:w,onAddSubAccount:E,onViewDetails:T})):$().map(w=>_(cC,{account:w,onViewDetails:T}))})()),ie(v=>d(S,C()==="hierarchy"?{display:"flex","flex-direction":"column",gap:"1rem"}:K,v)),S})(),me(()=>me(()=>$().length===0)()&&(()=>{var S=Mh();return S.style.setProperty("text-align","center"),S.style.setProperty("color","var(--text-muted)"),S.style.setProperty("padding","3rem"),S.style.setProperty("font-size","1.1rem"),s(S,()=>t("common.noDataFound")),S})()),_(pC,{get isOpen(){return e()},onClose:()=>r(!1)}),_(_C,{get isOpen(){return n()},onClose:()=>i(!1),get parentAccount(){return h()}}),_(TC,{get isOpen(){return o()},onClose:()=>a(!1),get account(){return c()}})]}})};_t(["click"]);var qC=G("<div><h2>"),Bi=G("<div>"),HC=G("<div><div><div></div><h1></h1><div></div></div><div>"),GC=G("<div><button></button><button> (<!>)"),Vs=G("<div><span></span><span>"),WC=G("<p>"),YC=G("<div><div></div><div>"),KC=G("<div><div><div></div><div> • </div></div><div>");const QC=()=>{const{t}=ot(),e=Sp(),r=Cc(),[n,i]=ge(null),[o,a]=ge("overview");Qr(()=>{const y=ut.getAccountById(e.id);y?i(y):r("/accounts")});const c={display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"1rem"},u={display:"flex","align-items":"center",gap:"1rem","margin-bottom":"2rem"},h={"font-size":"1rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},f={"font-size":"2.5rem","font-weight":"700",color:"var(--primary-color)"},g={padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},b={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},C=y=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:y?"var(--primary-color)":"var(--text-muted)","border-bottom":y?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),R={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},T={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},E={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},$={"font-weight":"500",color:"var(--text-muted)"},K={"font-weight":"600",color:"var(--text-primary)"},Z={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},J={flex:"1"},de={"font-weight":"500","margin-bottom":"0.25rem"},re={"font-size":"0.875rem",color:"var(--text-muted)"},I=y=>({"font-weight":"600",color:y==="debit"?"#4caf50":"#f44336"});if(!n())return _(Dr,{get title(){return t("accounts.accountDetails")},get children(){var y=qC(),se=y.firstChild;return y.style.setProperty("text-align","center"),y.style.setProperty("padding","3rem"),s(se,()=>t("common.error")),s(y,_(De,{variant:"primary",onClick:()=>r("/accounts"),get children(){return[me(()=>t("common.back"))," ",me(()=>t("navigation.accounts"))]}}),null),y}});const S=y=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[y]||{bg:"#f5f5f5",color:"#666"},v=y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(y),w=y=>new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),P=S(n().type),A=ut.getAccountTransactions(n().id);return _(Dr,{get title(){return n().name},get children(){return[(()=>{var y=Bi();return d(y,c),s(y,_(De,{variant:"secondary",onClick:()=>r("/accounts"),get children(){return["← ",me(()=>t("common.back"))," ",me(()=>t("navigation.accounts"))]}})),y})(),(()=>{var y=HC(),se=y.firstChild,W=se.firstChild,k=W.nextSibling,H=k.nextSibling,V=se.nextSibling;return d(y,u),d(W,h),s(W,()=>n().accountNumber),k.style.setProperty("margin","0.5rem 0"),k.style.setProperty("font-size","2rem"),s(k,()=>n().name),d(H,f),s(H,()=>v(n().balance)),s(V,()=>n().type),ie(O=>d(V,{...g,background:P.bg,color:P.color},O)),y})(),(()=>{var y=GC(),se=y.firstChild,W=se.nextSibling,k=W.firstChild,H=k.nextSibling;return H.nextSibling,d(y,b),se.$$click=()=>a("overview"),s(se,()=>t("dashboard.overview")),W.$$click=()=>a("transactions"),s(W,()=>t("accounts.transactions"),k),s(W,()=>A.length,H),ie(V=>{var O=C(o()==="overview"),D=C(o()==="transactions");return V.e=d(se,O,V.e),V.t=d(W,D,V.t),V},{e:void 0,t:void 0}),y})(),me(()=>me(()=>o()==="overview")()&&(()=>{var y=YC(),se=y.firstChild,W=se.nextSibling;return d(se,R),s(se,_(We,{get title(){return t("accounts.balance")},get subtitle(){return t("dashboard.overview")},get children(){var k=Bi();return k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","600"),k.style.setProperty("color","var(--primary-color)"),s(k,()=>v(n().balance)),k}}),null),s(se,_(We,{get title(){return t("accounts.accountType")},get subtitle(){return t("accounts.category")},get children(){var k=Bi();return k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","600"),k.style.setProperty("color","var(--primary-color)"),s(k,()=>t(`accounts.types.${n().type.toLowerCase()}`)),k}}),null),s(se,_(We,{get title(){return t("common.status")},get subtitle(){return t("accounts.accountDetails")},get children(){var k=Bi();return k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","600"),s(k,(()=>{var H=me(()=>!!n().isActive);return()=>H()?t("common.active"):t("common.inactive")})()),ie(H=>(H=n().isActive?"#4caf50":"#f44336")!=null?k.style.setProperty("color",H):k.style.removeProperty("color")),k}}),null),s(se,_(We,{get title(){return t("accounts.transactions")},get subtitle(){return t("common.total")},get children(){var k=Bi();return k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","600"),k.style.setProperty("color","var(--primary-color)"),s(k,()=>A.length),k}}),null),d(W,T),s(W,_(We,{get title(){return t("accounts.accountDetails")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var k=Vs(),H=k.firstChild,V=H.nextSibling;return s(H,()=>t("accounts.accountNumber")),s(V,()=>n().accountNumber),ie(O=>{var D=E,M=$,he=K;return O.e=d(k,D,O.e),O.t=d(H,M,O.t),O.a=d(V,he,O.a),O},{e:void 0,t:void 0,a:void 0}),k})(),(()=>{var k=Vs(),H=k.firstChild,V=H.nextSibling;return s(H,()=>t("accounts.category")),s(V,()=>n().category),ie(O=>{var D=E,M=$,he=K;return O.e=d(k,D,O.e),O.t=d(H,M,O.t),O.a=d(V,he,O.a),O},{e:void 0,t:void 0,a:void 0}),k})(),(()=>{var k=Vs(),H=k.firstChild,V=H.nextSibling;return s(H,()=>t("common.date")),s(V,()=>w(n().createdDate)),ie(O=>{var D=E,M=$,he=K;return O.e=d(k,D,O.e),O.t=d(H,M,O.t),O.a=d(V,he,O.a),O},{e:void 0,t:void 0,a:void 0}),k})(),(()=>{var k=Vs(),H=k.firstChild,V=H.nextSibling;return s(H,()=>t("common.date")),s(V,()=>w(n().lastModified)),ie(O=>{var D=E,M=$,he=K;return O.e=d(k,D,O.e),O.t=d(H,M,O.t),O.a=d(V,he,O.a),O},{e:void 0,t:void 0,a:void 0}),k})()]}}),null),s(W,_(We,{get title(){return t("common.description")},get subtitle(){return t("accounts.accountDetails")},get children(){var k=WC();return k.style.setProperty("margin","0"),k.style.setProperty("color","var(--text-secondary)"),s(k,()=>n().description||t("common.noDataFound")),k}}),null),y})()),me(()=>me(()=>o()==="transactions")()&&_(We,{get title(){return t("accounts.accountHistory")},get subtitle(){return t("accounts.transactions")},get children(){return me(()=>A.length===0)()?(()=>{var y=Bi();return y.style.setProperty("text-align","center"),y.style.setProperty("color","var(--text-muted)"),y.style.setProperty("padding","2rem"),s(y,()=>t("common.noDataFound")),y})():A.map(y=>(()=>{var se=KC(),W=se.firstChild,k=W.firstChild,H=k.nextSibling,V=H.firstChild,O=W.nextSibling;return d(se,Z),d(W,J),d(k,de),s(k,()=>y.description),d(H,re),s(H,()=>w(y.date),V),s(H,()=>y.reference,null),s(O,()=>y.type==="debit"?"+":"-",null),s(O,()=>v(y.type==="debit"?y.debitAmount:y.creditAmount),null),ie(D=>d(O,I(y.type),D)),se})())}}))]}})};_t(["click"]);var JC=G("<div><div><h1></h1><p> </p></div><div><input type=date>"),gn=G("<div><span></span><span>"),XC=G("<div><div></div><div>"),ZC=G("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),eA=G("<div><div> (<!> = <!> + <!>)</div><div> = "),tA=G("<span>(<!>: <!>)");const rA=()=>{const{t}=ot(),[e,r]=ge(new Date().toISOString().split("T")[0]),[n,i]=ge(0),[o,a]=ge(0),[c,u]=ge(0);Qr(()=>{h()});const h=()=>{const R=ut.getAccountsByType("Asset"),T=ut.getAccountsByType("Liability"),E=ut.getAccountsByType("Equity"),$=R.reduce((J,de)=>J+de.balance,0),K=T.reduce((J,de)=>J+de.balance,0),Z=E.reduce((J,de)=>J+de.balance,0);i($),a(K),u(Z)},f=R=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(R),g={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},b={"margin-bottom":"2rem"},C={"font-weight":"bold","font-size":"1.1rem","border-top":"2px solid var(--border-color)","padding-top":"0.5rem","margin-top":"1rem"};return _(Dr,{get title(){return t("balanceSheet.title")},get children(){return[(()=>{var R=JC(),T=R.firstChild,E=T.firstChild,$=E.nextSibling,K=$.firstChild,Z=T.nextSibling,J=Z.firstChild;return d(R,g),E.style.setProperty("margin","0"),s(E,()=>t("balanceSheet.title")),$.style.setProperty("margin","0.5rem 0 0 0"),$.style.setProperty("color","var(--text-muted)"),s($,()=>t("balanceSheet.asOf"),K),s($,()=>new Date(e()).toLocaleDateString(),null),Z.style.setProperty("display","flex"),Z.style.setProperty("gap","1rem"),J.addEventListener("change",de=>r(de.target.value)),J.style.setProperty("padding","0.5rem"),J.style.setProperty("border","1px solid var(--border-color)"),J.style.setProperty("border-radius","var(--border-radius-sm)"),s(Z,_(De,{variant:"primary",onClick:h,get children(){return t("balanceSheet.generateReport")}}),null),ie(()=>J.value=e()),R})(),(()=>{var R=XC(),T=R.firstChild,E=T.nextSibling;return R.style.setProperty("display","grid"),R.style.setProperty("grid-template-columns","1fr 1fr"),R.style.setProperty("gap","2rem"),s(T,_(We,{get title(){return t("balanceSheet.assets")},style:b,get children(){return[(()=>{var $=gn(),K=$.firstChild,Z=K.nextSibling;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),s(K,()=>t("balanceSheet.currentAssets")),s(Z,()=>f(n()*.6)),$})(),(()=>{var $=gn(),K=$.firstChild,Z=K.nextSibling;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),s(K,()=>t("balanceSheet.nonCurrentAssets")),s(Z,()=>f(n()*.4)),$})(),(()=>{var $=gn(),K=$.firstChild,Z=K.nextSibling;return s(K,()=>t("balanceSheet.totalAssets")),s(Z,()=>f(n())),ie(J=>d($,{...C,display:"flex","justify-content":"space-between"},J)),$})()]}})),s(E,_(We,{get title(){return t("balanceSheet.liabilities")},style:b,get children(){return[(()=>{var $=gn(),K=$.firstChild,Z=K.nextSibling;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),s(K,()=>t("balanceSheet.currentLiabilities")),s(Z,()=>f(o()*.7)),$})(),(()=>{var $=gn(),K=$.firstChild,Z=K.nextSibling;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),s(K,()=>t("balanceSheet.nonCurrentLiabilities")),s(Z,()=>f(o()*.3)),$})(),(()=>{var $=gn(),K=$.firstChild,Z=K.nextSibling;return s(K,()=>t("balanceSheet.totalLiabilities")),s(Z,()=>f(o())),ie(J=>d($,{...C,display:"flex","justify-content":"space-between"},J)),$})()]}}),null),s(E,_(We,{get title(){return t("balanceSheet.equity")},get children(){return[(()=>{var $=gn(),K=$.firstChild,Z=K.nextSibling;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),s(K,()=>t("balanceSheet.commonStock")),s(Z,()=>f(c()*.8)),$})(),(()=>{var $=gn(),K=$.firstChild,Z=K.nextSibling;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),s(K,()=>t("balanceSheet.retainedEarnings")),s(Z,()=>f(c()*.2)),$})(),(()=>{var $=gn(),K=$.firstChild,Z=K.nextSibling;return s(K,()=>t("balanceSheet.totalEquity")),s(Z,()=>f(c())),ie(J=>d($,{...C,display:"flex","justify-content":"space-between"},J)),$})()]}}),null),R})(),_(We,{get title(){return t("dashboard.overview")},style:{"margin-top":"2rem"},get children(){return[(()=>{var R=ZC(),T=R.firstChild,E=T.firstChild,$=E.nextSibling,K=T.nextSibling,Z=K.firstChild,J=Z.nextSibling,de=K.nextSibling,re=de.firstChild,I=re.nextSibling;return R.style.setProperty("display","grid"),R.style.setProperty("grid-template-columns","repeat(3, 1fr)"),R.style.setProperty("gap","2rem"),T.style.setProperty("text-align","center"),E.style.setProperty("font-size","0.875rem"),E.style.setProperty("color","var(--text-muted)"),E.style.setProperty("margin-bottom","0.5rem"),s(E,()=>t("balanceSheet.totalAssets")),$.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","bold"),$.style.setProperty("color","var(--primary-color)"),s($,()=>f(n())),K.style.setProperty("text-align","center"),Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-muted)"),Z.style.setProperty("margin-bottom","0.5rem"),s(Z,()=>t("balanceSheet.totalLiabilities")),J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","bold"),J.style.setProperty("color","#f44336"),s(J,()=>f(o())),de.style.setProperty("text-align","center"),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),re.style.setProperty("margin-bottom","0.5rem"),s(re,()=>t("balanceSheet.totalEquity")),I.style.setProperty("font-size","1.5rem"),I.style.setProperty("font-weight","bold"),I.style.setProperty("color","#4caf50"),s(I,()=>f(c())),R})(),(()=>{var R=eA(),T=R.firstChild,E=T.firstChild,$=E.nextSibling,K=$.nextSibling,Z=K.nextSibling,J=Z.nextSibling,de=J.nextSibling;de.nextSibling;var re=T.nextSibling,I=re.firstChild;return R.style.setProperty("margin-top","2rem"),R.style.setProperty("text-align","center"),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","var(--text-muted)"),T.style.setProperty("margin-bottom","0.5rem"),s(T,()=>t("common.total"),E),s(T,()=>t("balanceSheet.totalAssets"),$),s(T,()=>t("balanceSheet.totalLiabilities"),Z),s(T,()=>t("balanceSheet.totalEquity"),de),re.style.setProperty("font-size","1.2rem"),re.style.setProperty("font-weight","bold"),s(re,()=>f(n()),I),s(re,()=>f(o()+c()),null),s(re,(()=>{var S=me(()=>Math.abs(n()-(o()+c()))>.01);return()=>S()&&(()=>{var v=tA(),w=v.firstChild,P=w.nextSibling,A=P.nextSibling,y=A.nextSibling;return y.nextSibling,v.style.setProperty("font-size","0.875rem"),v.style.setProperty("color","#f44336"),v.style.setProperty("display","block"),s(v,()=>t("common.error"),P),s(v,()=>f(n()-(o()+c())),y),v})()})(),null),ie(S=>(S=Math.abs(n()-(o()+c()))<.01?"#4caf50":"#f44336")!=null?re.style.setProperty("color",S):re.style.removeProperty("color")),R})()]}})]}})};_t(["click"]);const nA=[{id:"YY_8802",code:"YY_8802",name:"CENTER",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8803",code:"YY_8803",name:"BISONET",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8804",code:"YY_8804",name:"IRVIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8805",code:"YY_8805",name:"KATTY",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8816",code:"YY_8816",name:"YABA GLOBAL",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8818",code:"YY_8818",name:"YABASURAUSTIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8847",code:"YY_8847",name:"YABAOFICINA AZ",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_3251",code:"YY_3251",name:"YABA FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_32",code:"YY_32",name:"YABA MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_76",code:"YY_76",name:"YABA DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_79",code:"YY_79",name:"ALMACEN DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8635",code:"YY_8635",name:"FASHION MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8665",code:"YY_8665",name:"IRVIN FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8901",code:"YY_8901",name:"ALMACEN CENTRAL YABA",bussinesId:"YB100423253156428",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01"}],iA=[{id:"1",name:'MacBook Pro 16"',price:2399,quantity:75,category:"Electronics",description:"Apple MacBook Pro 16-inch with M2 Pro chip",sku:"MBP-16-M2P",supplier:"Apple Inc.",minStock:10,location:"Warehouse A",lastUpdated:"2024-01-15"},{id:"2",name:'Dell Monitor 27"',price:299,quantity:35,category:"Electronics",description:"Dell 27-inch 4K UHD Monitor",sku:"DELL-MON-27-4K",supplier:"Dell Technologies",minStock:15,location:"Warehouse B",lastUpdated:"2024-01-14"},{id:"3",name:"Wireless Mouse",price:49.99,quantity:12,category:"Accessories",description:"Ergonomic wireless mouse with precision tracking",sku:"MOUSE-WL-001",supplier:"Logitech",minStock:25,location:"Warehouse A",lastUpdated:"2024-01-13"}],Bs=()=>{const t=new Map;return Or().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=Re.getLocationById(e.locationId),i=t.get(r);i||(i={id:r,productId:e.productId,locationId:e.locationId,locationName:n?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,i)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(i.quantity+=e.quantity*1):e.movementType==="out"?i.quantity-=e.quantity*1:e.movementType==="adjustment"&&(i.quantity=e.quantity*1),new Date(e.createdDate)>new Date(i.lastMovementDate)&&(i.lastMovementDate=e.createdDate,i.lastMovementType=e.movementType),i.averageCost=e.unitCost*1,i.availableQuantity=i.quantity*1-i.reservedQuantity*1}),Array.from(t.values())},[ci,Pl]=ge([]),[ui,Oh]=ge(nA),[Or,Fs]=ge([]),[Ln,Mo]=ge([]),oA=()=>{const t=new Map;return Or().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=t.get(r),i=Re.getLocationById(e.locationId);n||(n={id:r,productId:e.productId,locationId:e.locationId,locationName:i?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(n.quantity+=e.quantity*1):e.movementType==="out"?n.quantity-=e.quantity*1:e.movementType==="adjustment"&&(n.quantity=e.quantity*1),new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost*1,n.availableQuantity=n.quantity*1-n.reservedQuantity*1}),Array.from(t.values())};Mo(oA());const[Us,wl]=ge(iA),sA={TRANSFER:1,transfer:1},Vh=173442384e4,Re={get products(){return ci()},get locations(){return ui()},get movements(){return Or()},get stockLevels(){return Ln()},parseInventoryData:t=>{const e=Object.keys(t).slice(0,900),r=[],n=i=>{let o=t;o[i]?.products&&o[i]?.products?.map(a=>{let c=Hp(o[i]?.type),u=a?.price*1||a?.unitCost*1,h=a?.qty*1||a?.quantity*1;u=isNaN(u)?0:u,h=isNaN(h)?0:h;let f={id:o[i]?.ssg_inventory_key,productId:a?.product?.id,productName:a?.product?.label,productSku:a?.product?.code,locationId:o[i]?.store,locationName:o[i]?.store,location:o[i]?.store,movementType:c,quantity:h,unitCost:u,totalCost:u*1*h,minStock:10,referenceNumber:"PO-001",notes:o[i]?.description||o[i]?.notes,createdBy:"admin",createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(Vh).toISOString(),invoiceId:o[i]?.invoice};if(r.push(f),sA[o[i].movementType]&&o[i]?.fromLocationId){let g=Re.getLocationById(o[i]?.fromLocationId);const b={id:o[i]?.ssg_inventory_key,productId:a?.product?.id,productName:a?.product?.label,productSku:a?.product?.code,locationId:o[i]?.fromLocationId,locationName:g?.name||"",movementType:"out",quantity:h*-1,unitCost:u,totalCost:u*-1*h,minStock:10,referenceNumber:o[i]?.referenceNumber,notes:`Transfer to ${o[i]?.locationName}`+(o[i].notes?` - ${o[i].notes}`:""),createdBy:o[i].createdBy,createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(Vh).toISOString(),invoiceId:o[i]?.invoiceId,toLocationId:o[i]?.locationId,toLocationName:o[i]?.locationName};r.push(b)}})};return e.map(n),r},fecthInventory:async t=>{const e=await jn.getInventory(t),r=Re.parseInventoryData(e);Re.updMovements(r)},fecthProduct:async t=>{const e=await jn.getProducts(t),r=Object.keys(e),n=o=>{let a=e;return{id:o,name:a[o].name,businessId:a[o].businessId,sku:a[o].code,UPC:a[o].UPC,numCode:a[o].codeN,category:a[o].category,unitCost:a[o].unitCost||0,unitOfMeasure:a[o].unitOfMeasure||a[o].unit,minStockLevel:a[o].minStockLevel,maxStockLevel:a[o].maxStockLevel,isActive:a[o].isActive,description:a[o].description||"",createdDate:a[o].createdAt||new Date().toISOString(),lastModified:a[o].updatedAt||new Date().toISOString()}},i=r.map(n);return Re.updProduct(i),i},getProductById:t=>ci().find(e=>e.id===t),updProduct:t=>{Pl(t)},getProductsBySku:t=>ci().filter(e=>e.sku.toLowerCase().includes(t.toLowerCase())),getProductsByCategory:t=>ci().filter(e=>e.category===t),getActiveProducts:()=>ci().filter(t=>t.name),getLocationById:t=>ui().find(e=>e.id===t),getLocationsByType:t=>ui().filter(e=>e.type===t),getActiveLocations:()=>{let t=Et.state.profile.stores;return ui().filter(e=>t?.[e?.id])},getMovementsByProduct:t=>Or().filter(e=>e.productId===t),updMovements:t=>{Fs([...t]),Mo(Bs())},getMovementsByLocation:t=>Or().filter(e=>e.locationId===t),getMovementsByDateRange:(t,e)=>Or().filter(r=>r.createdDate>=t&&r.createdDate<=e),getStockByProduct:t=>Ln().filter(e=>e.productId===t),getStockByLocation:t=>Ln().filter(e=>e.locationId===t),getStockByProductAndLocation:(t,e)=>Ln().find(r=>r.productId===t&&r.locationId===e),getTotalStockByProduct:t=>Ln().filter(e=>e.productId===t).reduce((e,r)=>e*1+r.quantity*1,0),getLastLocationByProduct:t=>{const e=Or().filter(r=>r.productId===t).sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime());if(e.length>0)return ui().find(r=>r.id===e[0].locationId)},getLowStockProducts:()=>(ci()||[])?.map(t=>{const e=Ln().filter(r=>r.productId===t.id).reduce((r,n)=>r+n.quantity,0);return{...t,currentStock:e}}).filter(t=>t.currentStock<=t.minStockLevel),addInventoryMovement:t=>{const e={...t,id:`mov-${Date.now()}`,createdDate:new Date().toISOString()};Fs(r=>[...r,e]),Mo(Bs())},addBulkInventoryMovements:async t=>{const e=[],r=[],n=new Date().toISOString(),i=ui().find(c=>c.id===t.locationId);if(!i)return{success:!1,errors:["Invalid location"]};let o;if(t.movementType==="transfer"){if(!t.fromLocationId)return{success:!1,errors:["From location required for transfers"]};if(o=ui().find(c=>c.id===t.fromLocationId),!o)return{success:!1,errors:["Invalid from location"]};if(t.fromLocationId===t.locationId)return{success:!1,errors:["From and to locations cannot be the same"]}}if(t.items.forEach((c,u)=>{const h=ci().find(C=>C.id===c.productId);if(!h){e.push(`Item ${u+1}: Product not found`);return}if(c.quantity<=0){e.push(`Item ${u+1}: Quantity must be greater than 0`);return}if(t.movementType==="out"){const C=Ln().filter(R=>R.productId===c.productId&&R.locationId===t.locationId).reduce((R,T)=>R+T.quantity,0);if(c.quantity>C){e.push(`Item ${u+1}: Insufficient stock. Available: ${C}, Requested: ${c.quantity}`);return}}if(t.movementType==="transfer"){const C=Ln().filter(R=>R.productId===c.productId&&R.locationId===t.fromLocationId).reduce((R,T)=>R+T.quantity,0);if(c.quantity>C){e.push(`Item ${u+1}: Insufficient stock at ${o?.name}. Available: ${C}, Requested: ${c.quantity}`);return}}const f=c.unitCost||h.unitCost,g=c.quantity*f,b={id:`mov-${Date.now()}-${u}`,productId:h.id,productName:h.name,productSku:h.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:c.quantity,unitCost:f,totalCost:g,minStock:10,referenceNumber:t.referenceNumber||"",notes:c.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:o?.name};if(r.push(b),t.movementType==="transfer"&&o){const C={id:`mov-${Date.now()}-${u}-out`,productId:h.id,productName:h.name,productSku:h.sku,locationId:t.fromLocationId,locationName:o.name,movementType:"out",quantity:c.quantity,unitCost:f,totalCost:g,minStock:10,referenceNumber:t.referenceNumber||"",notes:`Transfer to ${i.name}`+(c.notes?` - ${c.notes}`:""),createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,toLocationId:t.locationId,toLocationName:i.name};r.push(C)}}),e.length>0)return{success:!1,errors:e};Fs(c=>[...c,...r]),Mo(Bs()),console.log({bulkRequest:t});const a=await jn.addInventory(t);return console.log({prodResults:a}),{success:!0,errors:[]}},getMovementsByInvoice:t=>Or().filter(e=>e.invoiceId===t),getInvoiceSummary:t=>{const e=Or().filter(o=>o.invoiceId===t);if(e.length===0)return null;const r=e.reduce((o,a)=>o+a.totalCost,0),n=new Set(e.map(o=>o.productId)).size,i=e[0];return{invoiceId:t,referenceNumber:i.referenceNumber,movementType:i.movementType,location:i.locationName,fromLocation:i.fromLocationName,productCount:n,totalItems:e.reduce((o,a)=>o+a.quantity,0),totalValue:r,createdDate:i.createdDate,createdBy:i.createdBy}},addProduct:t=>{const e={...t,id:`prod-${Date.now()}`,createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};Pl(r=>[...r,e])},addLocation:t=>{const e={...t,id:`loc-${Date.now()}`,createdDate:new Date().toISOString()};Oh(r=>[...r,e])},updateProduct:(t,e)=>{Pl(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n))},updateLocation:(t,e)=>{Oh(r=>r.map(n=>n.id===t?{...n,...e}:n))},updateMovement:(t,e)=>{Fs(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n)),Mo(Bs())},get inventory(){return Us()},addItem(t){const e={...t,id:Date.now().toString(),lastUpdated:new Date().toISOString().split("T")[0]};return wl([...Us(),e]),e},updateItem(t,e){wl(Us().map(r=>r.id===t?{...r,...e,lastUpdated:new Date().toISOString().split("T")[0]}:r))},deleteItem(t){wl(Us().filter(e=>e.id!==t))},getItemById(t){return Or().find(e=>e.id===t)},getLowStockItems(){return Or().filter(t=>t.quantity*1<=t.minStock*1)},getTotalValue(){return Or().reduce((t,e)=>t*1+e.unitCost*1*e.quantity*1,0)}};var Bh=G("<div>"),aA=G("<div><div><input type=text autocomplete=off>"),lA=G("<button type=button>+"),cA=G("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>");const mg=t=>{const{t:e}=ot(),[r,n]=ge(!1),[i,o]=ge(""),[a,c]=ge(-1),u=qe(()=>t.value?Re.getProductById(t.value):null),h=qe(()=>{const W=i().toLowerCase();return W?Re.getActiveProducts().filter(k=>k.name.toLowerCase().includes(W)||k.sku.toLowerCase().includes(W)||k.category.toLowerCase().includes(W)):Re.getActiveProducts()}),f=()=>{n(!0),o(""),c(-1)},g=W=>{const k=W.target;o(k.value),n(!0),c(-1)},b=W=>{t.onChange(W),n(!1),o(""),c(-1)},C=W=>{const k=h();switch(W.key){case"ArrowDown":W.preventDefault(),c(H=>Math.min(H+1,k.length-1));break;case"ArrowUp":W.preventDefault(),c(H=>Math.max(H-1,-1));break;case"Enter":W.preventDefault(),a()>=0&&k[a()]&&b(k[a()]);break;case"Escape":n(!1),o(""),c(-1);break}},R=W=>{setTimeout(()=>{n(!1),o(""),c(-1)},150)},T=W=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(W),E=W=>Re.stockLevels.filter(k=>k.productId===W).reduce((k,H)=>k+H.quantity,0),$={position:"relative",width:"100%",...t.style},K={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},Z={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},J=W=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid "+W?"var(--primary-color)":"var(--border-color)",background:W?"var(--strip-color)":"transparent",color:W?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),de={display:"flex","justify-content":"space-between","align-items":"center"},re={flex:"1"},I={"font-weight":"500","margin-bottom":"0.25rem"},S={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},v={"text-align":"right","font-size":"0.875rem"},w={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},P=()=>r()&&i()?i():u()?`${u().name} (${u().sku})`:"",A={display:"flex","align-items":"stretch",width:"100%"},y={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},se={...K,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"};return(()=>{var W=aA(),k=W.firstChild,H=k.firstChild;return d(k,A),H.addEventListener("blur",R),H.$$keydown=C,H.$$click=f,H.$$input=g,s(k,(()=>{var V=me(()=>!!t.onAddNew);return()=>V()&&(()=>{var O=lA();return O.addEventListener("mouseleave",D=>{D.currentTarget.style.background="var(--surface-color)",D.currentTarget.style.color="var(--primary-color)"}),O.addEventListener("mouseenter",D=>{D.currentTarget.style.background="var(--primary-color)",D.currentTarget.style.color="white"}),Ai(O,"click",t.onAddNew,!0),d(O,y),ie(()=>lt(O,"title",e("inventory.addProduct","Add new product"))),O})()})(),null),s(W,_(Le,{get when(){return r()},get children(){var V=Bh();return s(V,_(Le,{get when(){return h().length>0},get fallback(){return(()=>{var O=Bh();return d(O,w),s(O,(()=>{var D=me(()=>!!i());return()=>D()?e("inventory.noProductsFound","No products found matching your search."):e("inventory.noProductsAvailable","No products available.")})()),O})()},get children(){return _(xt,{get each(){return h()},children:(O,D)=>{const M=E(O.id),he=M<=O.minStockLevel;return(()=>{var z=cA(),pe=z.firstChild,x=pe.firstChild,F=x.firstChild,ee=F.nextSibling,Q=ee.firstChild,ue=Q.firstChild,te=Q.nextSibling,B=te.nextSibling,ae=B.nextSibling,ve=ae.nextSibling,be=x.nextSibling,oe=be.firstChild,ce=oe.firstChild,Y=oe.nextSibling;return z.addEventListener("mouseenter",()=>c(D())),z.$$click=()=>b(O),d(pe,de),d(x,re),d(F,I),s(F,()=>O.name),d(ee,S),s(Q,()=>e("inventory.sku","SKU"),ue),s(Q,()=>O.sku,null),s(B,()=>O.category),s(ve,()=>T(O.unitCost)),d(be,v),oe.style.setProperty("font-weight","600"),(he?"#f44336":"var(--text-primary)")!=null?oe.style.setProperty("color",he?"#f44336":"var(--text-primary)"):oe.style.removeProperty("color"),s(oe,M,ce),s(oe,()=>O.unitOfMeasure,null),Y.style.setProperty("color","var(--text-muted)"),s(Y,()=>he?e("inventory.lowStock","Low Stock"):e("inventory.inStock","In Stock")),ie(q=>d(z,J(D()===a()),q)),z})()}})}})),ie(O=>d(V,Z,O)),V}}),null),ie(V=>{var O=$,D=se,M=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),he=t.disabled,z=t.required;return V.e=d(W,O,V.e),V.t=d(H,D,V.t),M!==V.a&&lt(H,"placeholder",V.a=M),he!==V.o&&(H.disabled=V.o=he),z!==V.i&&(H.required=V.i=z),V},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ie(()=>H.value=P()),W})()};_t(["input","click","keydown"]);var Fh=G("<div>"),uA=G("<div><div><input type=text autocomplete=off>"),dA=G("<button type=button>+"),hA=G("<div><div><div><div> </div><div><span>: </span><span></span></div><div>");const ka=t=>{const{t:e}=ot(),[r,n]=ge(!1),[i,o]=ge(""),[a,c]=ge(-1),u=qe(()=>t.value?Re.getLocationById(t.value):null),h=qe(()=>{let W=Re.getActiveLocations();t.filterType&&(W=W.filter(H=>H.type===t.filterType));const k=i().toLowerCase();return k?W.filter(H=>H.name.toLowerCase().includes(k)||H?.code?.toLowerCase().includes(k)||H?.type?.toLowerCase().includes(k)||H?.address?.toLowerCase().includes(k)):W}),f=()=>{n(!0),o(""),c(-1)},g=W=>{const k=W.target;o(k.value),n(!0),c(-1)},b=W=>{t.onChange(W.id),n(!1),o(""),c(-1)},C=W=>{const k=h();switch(W.key){case"ArrowDown":W.preventDefault(),c(H=>Math.min(H+1,k.length-1));break;case"ArrowUp":W.preventDefault(),c(H=>Math.max(H-1,-1));break;case"Enter":W.preventDefault(),a()>=0&&k[a()]&&b(k[a()]);break;case"Escape":n(!1),o(""),c(-1);break}},R=W=>{setTimeout(()=>{n(!1),o(""),c(-1)},150)},T=W=>({warehouse:"🏭",store:"🏪",supplier:"🚚",customer:"👥"})[W]||"📍",E=W=>({warehouse:"#2196F3",store:"#4CAF50",supplier:"#FF9800",customer:"#9C27B0"})[W]||"#757575",$={position:"relative",width:"100%",...t.style},K={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},Z={display:"flex","align-items":"stretch",width:"100%"},J={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},de={...K,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},re={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},I=W=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:W?"var(--strip-color)":"transparent",color:W?"var(--primary-dark)":"var(--text-primary)",transition:"all 0.2s ease"}),S={display:"flex","justify-content":"space-between","align-items":"center"},v={flex:"1"},w={"font-weight":"500","margin-bottom":"0.25rem"},P={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","align-items":"center"},A=W=>({padding:"0.2rem 0.5rem","border-radius":"var(--border-radius-sm)","font-size":"0.7rem","font-weight":"500",background:E(W),color:"white","text-transform":"uppercase"}),y={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},se=()=>r()&&i()?i():u()?`${u().name} (${u().code})`:"";return(()=>{var W=uA(),k=W.firstChild,H=k.firstChild;return d(k,Z),H.addEventListener("blur",R),H.$$keydown=C,H.$$click=f,H.$$input=g,s(k,(()=>{var V=me(()=>!!t.onAddNew);return()=>V()&&(()=>{var O=dA();return O.addEventListener("mouseleave",D=>{D.currentTarget.style.background="var(--surface-color)",D.currentTarget.style.color="var(--primary-color)"}),O.addEventListener("mouseenter",D=>{D.currentTarget.style.background="var(--primary-color)",D.currentTarget.style.color="white"}),Ai(O,"click",t.onAddNew,!0),d(O,J),ie(()=>lt(O,"title",e("inventory.addLocation","Add new location"))),O})()})(),null),s(W,_(Le,{get when(){return r()},get children(){var V=Fh();return s(V,_(Le,{get when(){return h().length>0},get fallback(){return(()=>{var O=Fh();return d(O,y),s(O,(()=>{var D=me(()=>!!i());return()=>D()?e("inventory.noLocationsFound","No locations found matching your search."):e("inventory.noLocationsAvailable","No locations available.")})()),O})()},get children(){return _(xt,{get each(){return h()},children:(O,D)=>(()=>{var M=hA(),he=M.firstChild,z=he.firstChild,pe=z.firstChild,x=pe.firstChild,F=pe.nextSibling,ee=F.firstChild,Q=ee.firstChild,ue=ee.nextSibling,te=F.nextSibling;return M.addEventListener("mouseenter",()=>c(D())),M.$$click=()=>b(O),d(he,S),d(z,v),d(pe,w),s(pe,()=>T(O.type),x),s(pe,()=>O.name,null),d(F,P),s(ee,()=>e("inventory.locationCode","Code"),Q),s(ee,()=>O.code,null),s(ue,()=>O.type),te.style.setProperty("font-size","0.75rem"),te.style.setProperty("color","var(--text-muted)"),te.style.setProperty("margin-top","0.25rem"),s(te,()=>O.address),ie(B=>{var ae=I(D()===a()),ve=A(O.type);return B.e=d(M,ae,B.e),B.t=d(ue,ve,B.t),B},{e:void 0,t:void 0}),M})()})}})),ie(O=>d(V,re,O)),V}}),null),ie(V=>{var O=$,D=de,M=t.placeholder||e("inventory.searchLocations","Search locations by name, code, or type..."),he=t.disabled,z=t.required;return V.e=d(W,O,V.e),V.t=d(H,D,V.t),M!==V.a&&lt(H,"placeholder",V.a=M),he!==V.o&&(H.disabled=V.o=he),z!==V.i&&(H.required=V.i=z),V},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ie(()=>H.value=se()),W})()};_t(["input","click","keydown"]);var mA=G("<form><div><label> *</label><input type=text required></div><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text list=categories required><datalist id=categories><option value=Electronics></option><option value=Accessories></option><option value=Office></option><option value=Furniture></option><option value=Software></option><option value=Hardware></option></datalist></div></div><div><label></label><textarea></textarea></div><div><div><label></label><select><option value=pcs></option><option value=kg></option><option value=lbs></option><option value=m></option><option value=ft></option><option value=l></option><option value=gal></option><option value=box></option><option value=pack></option></select></div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div></div><div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div><div></div></div><div><div><label></label><input type=number min=0 step=1></div><div><label></label><input type=number min=1 step=1></div></div><div>"),fA=G("<div>");const Su=t=>{const{t:e}=ot(),[r,n]=ge(""),[i,o]=ge(""),[a,c]=ge(""),[u,h]=ge(""),[f,g]=ge("pcs"),[b,C]=ge(0),[R,T]=ge(0),[E,$]=ge(10),[K,Z]=ge(100),[J,de]=ge(""),re=()=>{n(""),o(""),c(""),h(""),g("pcs"),C(0),T(0),$(10),Z(100),de("")},I=k=>{if(k.preventDefault(),de(""),!r().trim()){de(e("forms.productNameRequired"));return}if(!i().trim()){de(e("forms.skuRequired"));return}if(!u().trim()){de(e("forms.categoryRequired"));return}if(b()<0){de(e("forms.unitCostNotNegative"));return}if(R()<0){de(e("forms.sellingPriceNotNegative"));return}if(E()<0){de(e("forms.minStockNotNegative"));return}if(K()<=E()){de(e("forms.maxStockGreaterThanMin"));return}if(Re.getProductsBySku(i()).length>0){de(e("forms.skuAlreadyExists"));return}const V={name:r().trim(),sku:i().trim().toUpperCase(),description:a().trim(),category:u().trim(),unitOfMeasure:f(),unitCost:b(),sellingPrice:R(),minStockLevel:E(),maxStockLevel:K(),isActive:!0,businessId:"default-business"};Re.addProduct(V);const O=`prod-${Date.now()}`;t.onProductAdded&&t.onProductAdded(O),re(),t.onClose()},S=()=>{re(),t.onClose()},v={"margin-bottom":"1.5rem"},w={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},P={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},A={...P,cursor:"pointer"},y={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},se={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},W={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"};return _(yr,{get isOpen(){return t.isOpen},onClose:S,get title(){return e("inventory.addNewProduct")},get children(){var k=mA(),H=k.firstChild,V=H.firstChild,O=V.firstChild,D=V.nextSibling,M=H.nextSibling,he=M.firstChild,z=he.firstChild,pe=z.firstChild,x=z.nextSibling,F=he.nextSibling,ee=F.firstChild,Q=ee.firstChild,ue=ee.nextSibling,te=M.nextSibling,B=te.firstChild,ae=B.nextSibling,ve=te.nextSibling,be=ve.firstChild,oe=be.firstChild,ce=oe.nextSibling,Y=ce.firstChild,q=Y.nextSibling,N=q.nextSibling,ne=N.nextSibling,fe=ne.nextSibling,U=fe.nextSibling,j=U.nextSibling,Se=j.nextSibling,we=Se.nextSibling,le=be.nextSibling,ye=le.firstChild,X=ye.nextSibling,Pe=ve.nextSibling,ke=Pe.firstChild,Te=ke.firstChild,$e=Te.nextSibling,Ue=Pe.nextSibling,Ye=Ue.firstChild,ze=Ye.firstChild,Ee=ze.nextSibling,Me=Ye.nextSibling,Ke=Me.firstChild,Ge=Ke.nextSibling,He=Ue.nextSibling;return k.addEventListener("submit",I),s(V,()=>e("inventory.productName"),O),D.addEventListener("change",Ae=>n(Ae.target.value)),s(z,()=>e("inventory.sku"),pe),x.addEventListener("change",Ae=>o(Ae.target.value)),s(ee,()=>e("inventory.category"),Q),ue.addEventListener("change",Ae=>h(Ae.target.value)),s(B,()=>e("common.description")),ae.addEventListener("change",Ae=>c(Ae.target.value)),s(oe,()=>e("inventory.unitOfMeasure")),ce.addEventListener("change",Ae=>g(Ae.target.value)),s(Y,()=>e("inventory.pieces")),s(q,()=>e("inventory.kilograms")),s(N,()=>e("inventory.pounds")),s(ne,()=>e("inventory.meters")),s(fe,()=>e("inventory.feet")),s(U,()=>e("inventory.liters")),s(j,()=>e("inventory.gallons")),s(Se,()=>e("inventory.boxes")),s(we,()=>e("inventory.packs")),s(ye,()=>e("inventory.unitCost")),X.addEventListener("change",Ae=>C(Number(Ae.target.value))),s(Te,()=>e("inventory.sellingPrice")),$e.addEventListener("change",Ae=>T(Number(Ae.target.value))),s(ze,()=>e("inventory.minimumStockLevel")),Ee.addEventListener("change",Ae=>$(Number(Ae.target.value))),s(Ke,()=>e("inventory.maximumStockLevel")),Ge.addEventListener("change",Ae=>Z(Number(Ae.target.value))),s(k,(()=>{var Ae=me(()=>!!J());return()=>Ae()&&(()=>{var st=fA();return d(st,y),s(st,J),st})()})(),He),d(He,se),s(He,_(De,{variant:"secondary",type:"button",onClick:S,get children(){return e("common.cancel")}}),null),s(He,_(De,{variant:"primary",type:"submit",get children(){return e("inventory.addProduct")}}),null),ie(Ae=>{var st=v,Xe=w,gt=P,dt=e("inventory.enterProductName"),Ft=W,Ht=w,$t=P,Ot=e("inventory.enterSkuCode"),bt=w,Jt=P,St=e("inventory.enterCategory"),ir=v,Oe=w,Ve={...P,"min-height":"80px",resize:"vertical"},Je=e("inventory.enterProductDescription"),nt=W,kt=w,Ze=A,ht=w,pt=P,Ct=W,ct=w,Nr=P,Vt=W,Ut=w,Yt=P,Rt=w,Xt=P;return Ae.e=d(H,st,Ae.e),Ae.t=d(V,Xe,Ae.t),Ae.a=d(D,gt,Ae.a),dt!==Ae.o&&lt(D,"placeholder",Ae.o=dt),Ae.i=d(M,Ft,Ae.i),Ae.n=d(z,Ht,Ae.n),Ae.s=d(x,$t,Ae.s),Ot!==Ae.h&&lt(x,"placeholder",Ae.h=Ot),Ae.r=d(ee,bt,Ae.r),Ae.d=d(ue,Jt,Ae.d),St!==Ae.l&&lt(ue,"placeholder",Ae.l=St),Ae.u=d(te,ir,Ae.u),Ae.c=d(B,Oe,Ae.c),Ae.w=d(ae,Ve,Ae.w),Je!==Ae.m&&lt(ae,"placeholder",Ae.m=Je),Ae.f=d(ve,nt,Ae.f),Ae.y=d(oe,kt,Ae.y),Ae.g=d(ce,Ze,Ae.g),Ae.p=d(ye,ht,Ae.p),Ae.b=d(X,pt,Ae.b),Ae.T=d(Pe,Ct,Ae.T),Ae.A=d(Te,ct,Ae.A),Ae.O=d($e,Nr,Ae.O),Ae.I=d(Ue,Vt,Ae.I),Ae.S=d(ze,Ut,Ae.S),Ae.W=d(Ee,Yt,Ae.W),Ae.C=d(Ke,Rt,Ae.C),Ae.B=d(Ge,Xt,Ae.B),Ae},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),ie(()=>D.value=r()),ie(()=>x.value=i()),ie(()=>ue.value=u()),ie(()=>ae.value=a()),ie(()=>ce.value=f()),ie(()=>X.value=b()),ie(()=>$e.value=R()),ie(()=>Ee.value=E()),ie(()=>Ge.value=K()),k}})};var yA=G('<form><div><label> *</label><input type=text required></div><div><div><label> *<button type=button title="Generate code automatically"></button></label><input type=text required><div></div></div><div><label> *</label><select required><option value=warehouse> </option><option value=store> </option><option value=supplier> </option><option value=customer> </option></select><div></div></div></div><div><label> *</label><textarea required></textarea></div><div>'),gA=G("<div><div>:</div><div><span></span><div><div></div><div>"),pA=G("<div>");const Pu=t=>{const{t:e}=ot(),[r,n]=ge(""),[i,o]=ge(""),[a,c]=ge("warehouse"),[u,h]=ge(""),[f,g]=ge(""),b=()=>{n(""),o(""),c("warehouse"),h(""),g("")},C=()=>{if(r()){const P=a()==="warehouse"?"WH":a()==="store"?"ST":a()==="supplier"?"SUP":"CUST",A=r().toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,3),y=String(Math.floor(Math.random()*1e3)).padStart(3,"0");o(`${P}-${A}-${y}`)}},R=P=>{if(P.preventDefault(),g(""),!r().trim()){g(e("forms.locationNameRequired"));return}if(!i().trim()){g(e("forms.locationCodeRequired"));return}if(!u().trim()){g(e("forms.addressRequired"));return}if(Re.locations.filter(W=>W.code.toLowerCase()===i().toLowerCase()).length>0){g(e("forms.locationCodeExists"));return}const y={name:r().trim(),code:i().trim().toUpperCase(),type:a(),address:u().trim(),isActive:!0};Re.addLocation(y);const se=`loc-${Date.now()}`;t.onLocationAdded&&t.onLocationAdded(se),b(),t.onClose()},T=()=>{b(),t.onClose()},E={"margin-bottom":"1.5rem"},$={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},K={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},Z={...K,cursor:"pointer"},J={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},de={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},re={display:"grid","grid-template-columns":"2fr 1fr",gap:"1rem"},I={"font-size":"0.875rem",color:"var(--text-muted)","margin-top":"0.25rem"},S={padding:"0.25rem 0.5rem","font-size":"0.75rem","margin-left":"0.5rem",background:"var(--background-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",color:"var(--text-muted)"},v=P=>({warehouse:"🏭",store:"🏪",supplier:"🚚",customer:"👥"})[P]||"📍",w=P=>({warehouse:e("inventory.warehouseDescription"),store:e("inventory.storeDescription"),supplier:e("inventory.supplierDescription"),customer:e("inventory.customerDescription")})[P]||"";return _(yr,{get isOpen(){return t.isOpen},onClose:T,get title(){return e("inventory.addNewLocation")},get children(){var P=yA(),A=P.firstChild,y=A.firstChild,se=y.firstChild,W=y.nextSibling,k=A.nextSibling,H=k.firstChild,V=H.firstChild,O=V.firstChild,D=O.nextSibling,M=V.nextSibling,he=M.nextSibling,z=H.nextSibling,pe=z.firstChild,x=pe.firstChild,F=pe.nextSibling,ee=F.firstChild,Q=ee.firstChild,ue=ee.nextSibling,te=ue.firstChild,B=ue.nextSibling,ae=B.firstChild,ve=B.nextSibling,be=ve.firstChild,oe=F.nextSibling,ce=k.nextSibling,Y=ce.firstChild,q=Y.firstChild,N=Y.nextSibling,ne=ce.nextSibling;return P.addEventListener("submit",R),s(y,()=>e("inventory.locationName"),se),W.addEventListener("change",fe=>n(fe.target.value)),d(k,re),s(V,()=>e("inventory.locationCode"),O),D.$$click=C,d(D,S),s(D,()=>e("common.generate")),M.addEventListener("change",fe=>o(fe.target.value)),s(he,()=>e("inventory.uniqueIdentifierHelp")),s(pe,()=>e("inventory.locationType"),x),F.addEventListener("change",fe=>c(fe.target.value)),s(ee,()=>v("warehouse"),Q),s(ee,()=>e("inventory.warehouse"),null),s(ue,()=>v("store"),te),s(ue,()=>e("inventory.store"),null),s(B,()=>v("supplier"),ae),s(B,()=>e("inventory.supplier"),null),s(ve,()=>v("customer"),be),s(ve,()=>e("inventory.customer"),null),s(oe,()=>w(a())),s(Y,()=>e("common.address"),q),N.addEventListener("change",fe=>h(fe.target.value)),s(P,(()=>{var fe=me(()=>!!r());return()=>fe()&&(()=>{var U=gA(),j=U.firstChild,Se=j.firstChild,we=j.nextSibling,le=we.firstChild,ye=le.nextSibling,X=ye.firstChild,Pe=X.nextSibling;return U.style.setProperty("padding","1rem"),U.style.setProperty("background","var(--background-color)"),U.style.setProperty("border-radius","var(--border-radius-sm)"),U.style.setProperty("border","1px solid var(--border-color)"),U.style.setProperty("margin-bottom","1rem"),j.style.setProperty("font-weight","500"),j.style.setProperty("margin-bottom","0.5rem"),s(j,()=>e("common.preview"),Se),we.style.setProperty("display","flex"),we.style.setProperty("align-items","center"),we.style.setProperty("gap","0.5rem"),le.style.setProperty("font-size","1.2rem"),s(le,()=>v(a())),X.style.setProperty("font-weight","600"),s(X,r),Pe.style.setProperty("font-size","0.875rem"),Pe.style.setProperty("color","var(--text-muted)"),s(Pe,(()=>{var ke=me(()=>!!i());return()=>ke()&&`${i()} • `})(),null),s(Pe,a,null),U})()})(),ne),s(P,(()=>{var fe=me(()=>!!f());return()=>fe()&&(()=>{var U=pA();return d(U,J),s(U,f),U})()})(),ne),d(ne,de),s(ne,_(De,{variant:"secondary",type:"button",onClick:T,get children(){return e("common.cancel")}}),null),s(ne,_(De,{variant:"primary",type:"submit",get children(){return e("inventory.addLocation")}}),null),ie(fe=>{var U=E,j=$,Se=K,we=e("inventory.enterLocationName"),le=$,ye=K,X=e("inventory.enterUniqueCode"),Pe=I,ke=$,Te=Z,$e=I,Ue=E,Ye=$,ze={...K,"min-height":"100px",resize:"vertical"},Ee=e("inventory.enterCompleteAddress");return fe.e=d(A,U,fe.e),fe.t=d(y,j,fe.t),fe.a=d(W,Se,fe.a),we!==fe.o&&lt(W,"placeholder",fe.o=we),fe.i=d(V,le,fe.i),fe.n=d(M,ye,fe.n),X!==fe.s&&lt(M,"placeholder",fe.s=X),fe.h=d(he,Pe,fe.h),fe.r=d(pe,ke,fe.r),fe.d=d(F,Te,fe.d),fe.l=d(oe,$e,fe.l),fe.u=d(ce,Ue,fe.u),fe.c=d(Y,Ye,fe.c),fe.w=d(N,ze,fe.w),Ee!==fe.m&&lt(N,"placeholder",fe.m=Ee),fe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),ie(()=>W.value=r()),ie(()=>M.value=i()),ie(()=>F.value=a()),ie(()=>N.value=u()),P}})};_t(["click"]);var vA=G("<form><div>"),Uh=G("<div><label> *"),bA=G("<div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment>"),_A=G("<div><label>"),SA=G("<div><label> *</label><input type=number min=0 step=1 required>"),PA=G("<div><label></label><input type=number min=0 step=0.01>"),wA=G("<div><label></label><input type=text>"),CA=G("<div><label></label><textarea>"),AA=G("<div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span>:</span><span> "),IA=G("<div><div><span>:</span><span>"),EA=G("<div>");const xA=t=>{const{t:e}=ot(),[r,n]=ge({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""}),[i,o]=ge(""),[a,c]=ge(""),[u,h]=ge("in"),[f,g]=ge(0),[b,C]=ge(0),[R,T]=ge(""),[E,$]=ge(""),[K,Z]=ge(""),[J,de]=ge(""),[re,I]=ge(!1),[S,v]=ge(!1),w=()=>t.mode==="movement",P=qe(()=>i()?Re.getProductById(i()):null),A=qe(()=>a()?Re.getLocationById(a()):null),y=qe(()=>K()?Re.getLocationById(K()):null),se=qe(()=>f()*b()),W=qe(()=>!i()||!a()?0:Re.getStockByProductAndLocation(i(),a())?.quantity||0),k=[{value:"Electronics",label:"Electronics"},{value:"Accessories",label:"Accessories"},{value:"Furniture",label:"Furniture"},{value:"Office Supplies",label:"Office Supplies"},{value:"Software",label:"Software"},{value:"Hardware",label:"Hardware"},{value:"Consumables",label:"Consumables"}],H=[{value:"Warehouse A",label:"Warehouse A"},{value:"Warehouse B",label:"Warehouse B"},{value:"Warehouse C",label:"Warehouse C"},{value:"Storage Room",label:"Storage Room"},{value:"Main Office",label:"Main Office"}],V={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},O=()=>{o(""),c(""),h("in"),g(0),C(0),T(""),$(""),Z(""),de("")},D=()=>{n({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""})},M=ve=>{if(ve.preventDefault(),w()){if(de(""),!i()){de(e("forms.selectProduct"));return}if(!a()){de(e("forms.selectLocation"));return}if(f()<=0){de(e("forms.quantityGreaterThanZero"));return}if(b()<0){de(e("forms.unitCostNotNegative"));return}if(u()==="transfer"&&!K()){de(e("forms.selectFromLocation"));return}if(u()==="transfer"&&K()===a()){de(e("forms.sameLocationError"));return}if(u()==="out"&&f()>W()){de(e("forms.insufficientStock",{currentStock:W()}));return}const be=P(),oe=A(),ce={productId:be.id,productName:be.name,productSku:be.sku,locationId:oe.id,locationName:oe.name,movementType:u(),quantity:f(),unitCost:b()||be.unitCost,totalCost:se()||f()*be.unitCost,referenceNumber:R()||`AUTO-${Date.now()}`,notes:E(),createdBy:"admin",fromLocationId:u()==="transfer"?K():void 0,fromLocationName:u()==="transfer"?y()?.name:void 0};Re.addInventoryMovement(ce),O()}else{const be=r();if(!be.name||!be.price||!be.quantity||!be.category||!be.sku||!be.supplier||!be.minStock||!be.location){alert(e("forms.fillAllRequired"));return}const oe={name:be.name,price:parseFloat(be.price),quantity:parseInt(be.quantity),category:be.category,description:be.description,sku:be.sku,supplier:be.supplier,minStock:parseInt(be.minStock),location:be.location};Re.addItem(oe),D()}t.onClose()},he=(ve,be)=>{n(oe=>({...oe,[ve]:be}))},z=()=>{w()?O():D(),t.onClose()},pe=ve=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ve),x={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},F={...x,cursor:"pointer"},ee={color:"#f44336","font-size":"0.875rem","margin-top":"0.5rem"},Q={padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},ue={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},te={"font-weight":"500",color:"var(--text-muted)"},B={"font-weight":"600",color:"var(--text-primary)"},ae=()=>w()?e("inventory.addMovement"):e("inventory.addNewItem");return _(yr,{get isOpen(){return t.isOpen},onClose:z,get title(){return ae()},get children(){return[(()=>{var ve=vA(),be=ve.firstChild;return ve.addEventListener("submit",M),s(ve,(()=>{var oe=me(()=>!!w());return()=>oe()?[(()=>{var ce=Uh(),Y=ce.firstChild,q=Y.firstChild;return ce.style.setProperty("margin-bottom","1.5rem"),Y.style.setProperty("display","block"),Y.style.setProperty("margin-bottom","0.5rem"),Y.style.setProperty("font-weight","500"),s(Y,()=>e("inventory.product"),q),s(ce,_(mg,{get value(){return i()},onChange:N=>{o(N);const ne=Re.getProductById(N);ne&&C(ne.unitCost)},get placeholder(){return e("inventory.searchProductsPlaceholder")},onAddNew:()=>I(!0),required:!0}),null),ce})(),(()=>{var ce=bA(),Y=ce.firstChild,q=Y.firstChild,N=Y.nextSibling,ne=N.firstChild,fe=ne.nextSibling,U=fe.nextSibling,j=U.nextSibling;return ce.style.setProperty("margin-bottom","1.5rem"),Y.style.setProperty("display","block"),Y.style.setProperty("margin-bottom","0.5rem"),Y.style.setProperty("font-weight","500"),s(Y,()=>e("inventory.movementType"),q),N.addEventListener("change",Se=>h(Se.target.value)),s(ne,()=>e("inventory.stockInPurchase")),s(fe,()=>e("inventory.stockOutSale")),s(U,()=>e("inventory.transferBetween")),s(j,()=>e("inventory.stockAdjustment")),ie(Se=>d(N,F,Se)),ie(()=>N.value=u()),ce})(),me(()=>me(()=>u()==="transfer")()&&(()=>{var ce=Uh(),Y=ce.firstChild,q=Y.firstChild;return ce.style.setProperty("margin-bottom","1.5rem"),Y.style.setProperty("display","block"),Y.style.setProperty("margin-bottom","0.5rem"),Y.style.setProperty("font-weight","500"),s(Y,()=>e("inventory.fromLocation"),q),s(ce,_(ka,{get value(){return K()},onChange:N=>Z(N),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>v(!0),required:!0}),null),ce})()),(()=>{var ce=_A(),Y=ce.firstChild;return ce.style.setProperty("margin-bottom","1.5rem"),Y.style.setProperty("display","block"),Y.style.setProperty("margin-bottom","0.5rem"),Y.style.setProperty("font-weight","500"),s(Y,(()=>{var q=me(()=>u()==="transfer");return()=>q()?e("inventory.toLocation")+" *":e("inventory.locationName")+" *"})()),s(ce,_(ka,{get value(){return a()},onChange:q=>c(q),get placeholder(){return me(()=>u()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>v(!0),required:!0}),null),ce})(),me(()=>me(()=>!!(P()&&A()))()&&(()=>{var ce=AA(),Y=ce.firstChild,q=Y.firstChild,N=q.firstChild,ne=q.nextSibling,fe=ne.firstChild,U=Y.nextSibling,j=U.firstChild,Se=j.firstChild,we=j.nextSibling,le=U.nextSibling,ye=le.firstChild,X=ye.firstChild,Pe=ye.nextSibling,ke=Pe.firstChild;return s(q,()=>e("inventory.currentStockAt",{location:A()?.name}),N),s(ne,W,fe),s(ne,()=>P()?.unitOfMeasure,null),s(j,()=>e("inventory.productCost"),Se),s(we,()=>pe(P()?.unitCost||0)),s(ye,()=>e("inventory.minStockLevel"),X),s(Pe,()=>P()?.minStockLevel,ke),s(Pe,()=>P()?.unitOfMeasure,null),ie(Te=>{var $e=Q,Ue=ue,Ye=te,ze=B,Ee=ue,Me=te,Ke=B,Ge=ue,He=te,Ae=B;return Te.e=d(ce,$e,Te.e),Te.t=d(Y,Ue,Te.t),Te.a=d(q,Ye,Te.a),Te.o=d(ne,ze,Te.o),Te.i=d(U,Ee,Te.i),Te.n=d(j,Me,Te.n),Te.s=d(we,Ke,Te.s),Te.h=d(le,Ge,Te.h),Te.r=d(ye,He,Te.r),Te.d=d(Pe,Ae,Te.d),Te},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),ce})()),(()=>{var ce=SA(),Y=ce.firstChild,q=Y.firstChild,N=Y.nextSibling;return ce.style.setProperty("margin-bottom","1.5rem"),Y.style.setProperty("display","block"),Y.style.setProperty("margin-bottom","0.5rem"),Y.style.setProperty("font-weight","500"),s(Y,()=>e("inventory.quantity"),q),N.addEventListener("change",ne=>g(Number(ne.target.value))),ie(ne=>d(N,x,ne)),ie(()=>N.value=f()),ce})(),(()=>{var ce=PA(),Y=ce.firstChild,q=Y.nextSibling;return ce.style.setProperty("margin-bottom","1.5rem"),Y.style.setProperty("display","block"),Y.style.setProperty("margin-bottom","0.5rem"),Y.style.setProperty("font-weight","500"),s(Y,()=>e("inventory.unitCost")),q.addEventListener("change",N=>C(Number(N.target.value))),ie(N=>{var ne=x,fe=e("inventory.willUseDefaultCost");return N.e=d(q,ne,N.e),fe!==N.t&&lt(q,"placeholder",N.t=fe),N},{e:void 0,t:void 0}),ie(()=>q.value=b()),ce})(),me(()=>me(()=>f()>0&&b()>0)()&&(()=>{var ce=IA(),Y=ce.firstChild,q=Y.firstChild,N=q.firstChild,ne=q.nextSibling;return s(q,()=>e("inventory.totalCost"),N),s(ne,()=>pe(se())),ie(fe=>{var U=Q,j=ue,Se=te,we={...B,"font-size":"1.2rem",color:"var(--primary-color)"};return fe.e=d(ce,U,fe.e),fe.t=d(Y,j,fe.t),fe.a=d(q,Se,fe.a),fe.o=d(ne,we,fe.o),fe},{e:void 0,t:void 0,a:void 0,o:void 0}),ce})()),(()=>{var ce=wA(),Y=ce.firstChild,q=Y.nextSibling;return ce.style.setProperty("margin-bottom","1.5rem"),Y.style.setProperty("display","block"),Y.style.setProperty("margin-bottom","0.5rem"),Y.style.setProperty("font-weight","500"),s(Y,()=>e("common.referenceNumber")),q.addEventListener("change",N=>T(N.target.value)),ie(N=>{var ne=x,fe=e("common.referenceNumberPlaceholder");return N.e=d(q,ne,N.e),fe!==N.t&&lt(q,"placeholder",N.t=fe),N},{e:void 0,t:void 0}),ie(()=>q.value=R()),ce})(),(()=>{var ce=CA(),Y=ce.firstChild,q=Y.nextSibling;return ce.style.setProperty("margin-bottom","1.5rem"),Y.style.setProperty("display","block"),Y.style.setProperty("margin-bottom","0.5rem"),Y.style.setProperty("font-weight","500"),s(Y,()=>e("common.notes")),q.addEventListener("change",N=>$(N.target.value)),ie(N=>{var ne={...x,"min-height":"100px",resize:"vertical"},fe=e("inventory.additionalNotesPlaceholder");return N.e=d(q,ne,N.e),fe!==N.t&&lt(q,"placeholder",N.t=fe),N},{e:void 0,t:void 0}),ie(()=>q.value=E()),ce})(),me(()=>me(()=>!!J())()&&(()=>{var ce=EA();return d(ce,ee),s(ce,J),ce})())]:[_(wt,{get label(){return e("inventory.itemName")},get value(){return r().name},onChange:ce=>he("name",ce),get placeholder(){return e("inventory.enterItemName")},required:!0}),_(wt,{get label(){return e("inventory.sku")},get value(){return r().sku},onChange:ce=>he("sku",ce),get placeholder(){return e("inventory.enterSkuCode")},required:!0}),_(hr,{get label(){return e("inventory.category")},get value(){return r().category},onChange:ce=>he("category",ce),options:k,required:!0}),_(wt,{get label(){return e("common.description")},get value(){return r().description},onChange:ce=>he("description",ce),get placeholder(){return e("inventory.enterItemDescription")}}),_(wt,{get label(){return e("common.price")},type:"number",get value(){return r().price},onChange:ce=>he("price",ce),get placeholder(){return e("common.enterPrice")},required:!0}),_(wt,{get label(){return e("inventory.quantity")},type:"number",get value(){return r().quantity},onChange:ce=>he("quantity",ce),get placeholder(){return e("inventory.enterQuantity")},required:!0}),_(wt,{get label(){return e("inventory.minimumStock")},type:"number",get value(){return r().minStock},onChange:ce=>he("minStock",ce),get placeholder(){return e("inventory.enterMinStockLevel")},required:!0}),_(wt,{get label(){return e("inventory.supplier")},get value(){return r().supplier},onChange:ce=>he("supplier",ce),get placeholder(){return e("inventory.enterSupplierName")},required:!0}),_(hr,{get label(){return e("inventory.location")},get value(){return r().location},onChange:ce=>he("location",ce),options:H,required:!0})]})(),be),d(be,V),s(be,_(De,{variant:"secondary",type:"button",onClick:z,get children(){return e("common.cancel")}}),null),s(be,_(De,{variant:"primary",type:"submit",get children(){return me(()=>!!w())()?e("inventory.addMovement"):e("inventory.addItem")}}),null),ve})(),_(Su,{get isOpen(){return re()},onClose:()=>I(!1),onProductAdded:ve=>{o(ve),I(!1)}}),_(Pu,{get isOpen(){return S()},onClose:()=>v(!1),onLocationAdded:ve=>{u()==="transfer"&&!K()?Z(ve):c(ve),v(!1)}})]}})};_t(["input","keydown"]);var TA=G("<form><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text required></div></div><div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><div><label></label></div></div><div><div><h3></h3></div></div><div><label></label><textarea></textarea></div><div>"),$A=G("<div><label> *"),kA=G("<div><div></div><div></div><div></div><div></div><div>"),Cl=G("<div>"),RA=G("<div><input type=number min=0 step=1 required><input type=number min=0 step=0.01><input type=text>"),DA=G("<div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span>"),NA=G("<div>• ");const LA=t=>{const{t:e}=ot(),[r,n]=ge(`INV-${Date.now()}`),[i,o]=ge(""),[a,c]=ge("in"),[u,h]=ge(""),[f,g]=ge(""),[b,C]=ge(""),[R,T]=ge([]),[E,$]=ge([]),[K,Z]=ge(!1),[J,de]=ge(!1),re=()=>{T(Q=>[...Q,{productId:"",quantity:0,unitCost:0,notes:""}])},I=Q=>{T(ue=>ue.filter((te,B)=>B!==Q))},S=(Q,ue,te)=>{T(B=>B.map((ae,ve)=>ve===Q?{...ae,[ue]:te}:ae))},v=()=>{n(`INV-${Date.now()}`),o(""),c("in"),h(""),g(""),C(""),T([]),$([])},w=async Q=>{Q.preventDefault(),$([]);const ue=[];if(i()||ue.push(e("forms.referenceNumberRequired")),u()||ue.push(e("forms.locationRequired")),a()==="transfer"&&!f()&&ue.push(e("forms.fromLocationRequired")),R().length===0&&ue.push(e("forms.atLeastOneProduct")),R().forEach((ae,ve)=>{ae.productId||ue.push(e("forms.itemProductRequired","Product is required for item {{index}}",{index:ve+1})),ae.quantity<=0&&ue.push(e("forms.itemQuantityRequired","Quantity must be greater than 0 for item {{index}}",{index:ve+1}))}),ue.length>0){$(ue);return}const te={ssg_inventory_key:Ws(),invoiceId:r(),referenceNumber:i(),movementType:a(),type:jl(a()),locationId:u(),fromLocationId:a()==="transfer"?f():void 0,items:R(),products:R(),generalNotes:b(),description:b(),invoice:i(),store:u(),createdBy:"admin",createDate:new Date().toISOString()};console.log(te);const B=await Re.addBulkInventoryMovements(te);console.log(B),B.success?(v(),t.onClose()):$(B.errors)},P=()=>{v(),t.onClose()},A=qe(()=>R().reduce((Q,ue)=>{const te=Re.getProductById(ue.productId),B=ue.unitCost||te?.unitCost||0;return Q+ue.quantity*B},0)),y=qe(()=>R().reduce((Q,ue)=>Q+ue.quantity,0)),se={"margin-bottom":"1.5rem"},W={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},k={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},H={...k,cursor:"pointer"},V={display:"grid",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},O={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},D={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem","padding-left":"0.75rem"},M={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},he={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},z={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},pe={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},x=Q=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Q),F=Q=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[Q]||Q,ee=async Q=>{await Re.fecthInventory(Q),await Re.fecthProduct(Q)};return Qr(()=>{ee("prod")}),_(yr,{get isOpen(){return t.isOpen},onClose:P,get title(){return e("inventory.bulkMovement")},get children(){return[(()=>{var Q=TA(),ue=Q.firstChild,te=ue.firstChild,B=te.firstChild,ae=B.firstChild,ve=B.nextSibling,be=te.nextSibling,oe=be.firstChild,ce=oe.firstChild,Y=oe.nextSibling,q=ue.nextSibling,N=q.firstChild,ne=N.firstChild,fe=N.nextSibling,U=fe.firstChild,j=U.nextSibling,Se=j.nextSibling,we=Se.nextSibling,le=q.nextSibling,ye=le.firstChild,X=ye.firstChild,Pe=le.nextSibling,ke=Pe.firstChild,Te=ke.firstChild,$e=Pe.nextSibling,Ue=$e.firstChild,Ye=Ue.nextSibling,ze=$e.nextSibling;return Q.addEventListener("submit",w),ue.style.setProperty("display","grid"),ue.style.setProperty("grid-template-columns","1fr 1fr"),ue.style.setProperty("gap","1rem"),ue.style.setProperty("margin-bottom","1.5rem"),s(B,()=>e("common.invoiceDocumentId"),ae),ve.addEventListener("change",Ee=>n(Ee.target.value)),s(oe,()=>e("common.referenceNumber"),ce),Y.addEventListener("change",Ee=>o(Ee.target.value)),s(N,()=>e("inventory.movementType"),ne),fe.addEventListener("change",Ee=>c(Ee.target.value)),s(U,()=>e("inventory.purchaseReceive")),s(j,()=>e("inventory.saleIssue")),s(Se,()=>e("inventory.transfer")),s(we,()=>e("inventory.adjustment")),le.style.setProperty("display","grid"),le.style.setProperty("gap","1rem"),le.style.setProperty("margin-bottom","1.5rem"),s(le,(()=>{var Ee=me(()=>a()==="transfer");return()=>Ee()&&(()=>{var Me=$A(),Ke=Me.firstChild,Ge=Ke.firstChild;return s(Ke,()=>e("inventory.fromLocation"),Ge),s(Me,_(ka,{get value(){return f()},onChange:He=>g(He),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>de(!0),required:!0}),null),ie(He=>d(Ke,W,He)),Me})()})(),ye),s(X,(()=>{var Ee=me(()=>a()==="transfer");return()=>Ee()?e("inventory.toLocation")+" *":e("inventory.location")+" *"})()),s(ye,_(ka,{get value(){return u()},onChange:Ee=>h(Ee),get placeholder(){return me(()=>a()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>de(!0),required:!0}),null),ke.style.setProperty("display","flex"),ke.style.setProperty("justify-content","space-between"),ke.style.setProperty("align-items","center"),ke.style.setProperty("margin-bottom","1rem"),Te.style.setProperty("margin","0"),Te.style.setProperty("font-size","1.1rem"),s(Te,()=>e("inventory.products")),s(ke,_(De,{variant:"outline",type:"button",onClick:re,get children(){return e("inventory.addProduct")}}),null),s(Pe,(()=>{var Ee=me(()=>R().length>0);return()=>Ee()&&[(()=>{var Me=kA(),Ke=Me.firstChild,Ge=Ke.nextSibling,He=Ge.nextSibling,Ae=He.nextSibling;return d(Me,D),s(Ke,()=>e("inventory.product")),s(Ge,()=>e("inventory.quantity")),s(He,()=>e("inventory.unitCost")),s(Ae,()=>e("common.notes")),Me})(),_(xt,{get each(){return R()},children:(Me,Ke)=>[(()=>{var Ge=Cl();return d(Ge,V),s(Ge,_(mg,{get value(){return Me.productId},onChange:He=>{S(Ke(),"productId",He.id);let Ae={id:He.id,label:He.name,code:He.sku};S(Ke(),"product",Ae);const st=Re.getProductById(He.id);st&&!Me.unitCost&&S(Ke(),"unitCost",st.unitCost)},get placeholder(){return e("inventory.searchProduct")},onAddNew:()=>Z(!0),required:!0})),Ge})(),(()=>{var Ge=RA(),He=Ge.firstChild,Ae=He.nextSibling,st=Ae.nextSibling;return d(Ge,O),He.addEventListener("change",Xe=>S(Ke(),"quantity",Number(Xe.target.value))),Ae.addEventListener("change",Xe=>S(Ke(),"unitCost",Number(Xe.target.value))),st.addEventListener("change",Xe=>S(Ke(),"notes",Xe.target.value)),s(Ge,_(De,{variant:"outline",size:"sm",type:"button",onClick:()=>I(Ke()),style:{color:"#f44336","border-color":"#f44336"},get children(){return e("common.remove")}}),null),ie(Xe=>{var gt=k,dt=k,Ft=e("common.auto"),Ht=k,$t=e("common.optionalNotes");return Xe.e=d(He,gt,Xe.e),Xe.t=d(Ae,dt,Xe.t),Ft!==Xe.a&&lt(Ae,"placeholder",Xe.a=Ft),Xe.o=d(st,Ht,Xe.o),$t!==Xe.i&&lt(st,"placeholder",Xe.i=$t),Xe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ie(()=>He.value=Me.quantity),ie(()=>Ae.value=Me.unitCost),ie(()=>st.value=Me.notes),Ge})()]})]})(),null),s(Pe,(()=>{var Ee=me(()=>R().length===0);return()=>Ee()&&(()=>{var Me=Cl();return Me.style.setProperty("text-align","center"),Me.style.setProperty("padding","2rem"),Me.style.setProperty("background","var(--background-color)"),Me.style.setProperty("border-radius","var(--border-radius-sm)"),Me.style.setProperty("border","1px solid var(--border-color)"),Me.style.setProperty("color","var(--text-muted)"),s(Me,()=>e("inventory.noProductsAdded")),Me})()})(),null),s(Q,(()=>{var Ee=me(()=>R().length>0);return()=>Ee()&&(()=>{var Me=DA(),Ke=Me.firstChild,Ge=Ke.nextSibling,He=Ge.firstChild,Ae=He.firstChild,st=He.nextSibling,Xe=Ge.nextSibling,gt=Xe.firstChild,dt=gt.firstChild,Ft=gt.nextSibling,Ht=Xe.nextSibling,$t=Ht.firstChild,Ot=$t.firstChild,bt=$t.nextSibling,Jt=Ht.nextSibling,St=Jt.firstChild,ir=St.firstChild,Oe=St.nextSibling;return d(Me,M),Ke.style.setProperty("margin","0 0 1rem 0"),Ke.style.setProperty("font-size","1rem"),s(Ke,()=>e("common.summary")),s(He,()=>e("inventory.totalProducts"),Ae),st.style.setProperty("font-weight","600"),s(st,()=>R().length),s(gt,()=>e("inventory.totalItems"),dt),Ft.style.setProperty("font-weight","600"),s(Ft,y),s($t,()=>e("inventory.totalValue"),Ot),bt.style.setProperty("font-weight","600"),bt.style.setProperty("color","var(--primary-color)"),s(bt,()=>x(A())),s(St,()=>e("inventory.movementType"),ir),Oe.style.setProperty("font-weight","600"),s(Oe,()=>F(a())),ie(Ve=>{var Je=he,nt=he,kt=he,Ze=he;return Ve.e=d(Ge,Je,Ve.e),Ve.t=d(Xe,nt,Ve.t),Ve.a=d(Ht,kt,Ve.a),Ve.o=d(Jt,Ze,Ve.o),Ve},{e:void 0,t:void 0,a:void 0,o:void 0}),Me})()})(),$e),s(Ue,()=>e("common.generalNotes")),Ye.addEventListener("change",Ee=>C(Ee.target.value)),s(Q,(()=>{var Ee=me(()=>E().length>0);return()=>Ee()&&(()=>{var Me=Cl();return d(Me,z),s(Me,_(xt,{get each(){return E()},children:Ke=>(()=>{var Ge=NA();return Ge.firstChild,s(Ge,Ke,null),Ge})()})),Me})()})(),ze),d(ze,pe),s(ze,_(De,{variant:"secondary",type:"button",onClick:P,get children(){return e("common.cancel")}}),null),s(ze,_(De,{variant:"primary",type:"submit",get children(){return e("inventory.createMovement")}}),null),ie(Ee=>{var Me=W,Ke=k,Ge=W,He=k,Ae=e("common.referenceNumberPlaceholder"),st=se,Xe=W,gt=H,dt=a()==="transfer"?"1fr 1fr":"1fr",Ft=W,Ht=se,$t=se,Ot=W,bt={...k,"min-height":"80px",resize:"vertical"},Jt=e("inventory.generalNotesPlaceholder");return Ee.e=d(B,Me,Ee.e),Ee.t=d(ve,Ke,Ee.t),Ee.a=d(oe,Ge,Ee.a),Ee.o=d(Y,He,Ee.o),Ae!==Ee.i&&lt(Y,"placeholder",Ee.i=Ae),Ee.n=d(q,st,Ee.n),Ee.s=d(N,Xe,Ee.s),Ee.h=d(fe,gt,Ee.h),dt!==Ee.r&&((Ee.r=dt)!=null?le.style.setProperty("grid-template-columns",dt):le.style.removeProperty("grid-template-columns")),Ee.d=d(X,Ft,Ee.d),Ee.l=d(Pe,Ht,Ee.l),Ee.u=d($e,$t,Ee.u),Ee.c=d(Ue,Ot,Ee.c),Ee.w=d(Ye,bt,Ee.w),Jt!==Ee.m&&lt(Ye,"placeholder",Ee.m=Jt),Ee},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),ie(()=>ve.value=r()),ie(()=>Y.value=i()),ie(()=>fe.value=a()),ie(()=>Ye.value=b()),Q})(),_(Su,{get isOpen(){return K()},onClose:()=>Z(!1),onProductAdded:Q=>{Z(!1)}}),_(Pu,{get isOpen(){return J()},onClose:()=>de(!1),onLocationAdded:Q=>{a()==="transfer"&&!f()?g(Q):h(Q),de(!1)}})]}})};var MA=G("<div><div></div><div></div><div></div><div>"),OA=G("<div><strong>:</strong> "),VA=G("<div><div><span></span><span></span></div><div><span></span><span> </span></div><div><span></span><span> </span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),BA=G("<div>");const FA=t=>{const{t:e}=ot(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={"text-align":"center","margin-bottom":"2rem"},a={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},c={color:"var(--text-muted)","font-size":"1rem"},u={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"1rem"},h=(T,E)=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:T>E?"#d4edda":"#f8d7da",color:T>E?"#155724":"#721c24"}),f={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},g={"margin-bottom":"1.5rem",padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",color:"var(--text-secondary)"};if(!t.item)return null;const b=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T),C=T=>new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),R=t.item.price*t.item.quantity;return _(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.itemDetails")},get children(){return[(()=>{var T=MA(),E=T.firstChild,$=E.nextSibling,K=$.nextSibling,Z=K.nextSibling;return d(T,o),d(E,a),s(E,()=>t.item.name),d($,c),s($,()=>t.item.category),d(K,u),s(K,()=>b(t.item.price)),s(Z,(()=>{var J=me(()=>t.item.quantity>t.item.minStock);return()=>J()?e("inventory.inStock"):e("inventory.lowStockAlert")})()),ie(J=>d(Z,h(t.item.quantity,t.item.minStock),J)),T})(),(()=>{var T=OA(),E=T.firstChild,$=E.firstChild;return E.nextSibling,d(T,g),s(E,()=>e("common.description"),$),s(T,()=>t.item.description,null),T})(),(()=>{var T=VA(),E=T.firstChild,$=E.firstChild,K=$.nextSibling,Z=E.nextSibling,J=Z.firstChild,de=J.nextSibling,re=de.firstChild,I=Z.nextSibling,S=I.firstChild,v=S.nextSibling,w=v.firstChild,P=I.nextSibling,A=P.firstChild,y=A.nextSibling,se=P.nextSibling,W=se.firstChild,k=W.nextSibling,H=se.nextSibling,V=H.firstChild,O=V.nextSibling,D=H.nextSibling,M=D.firstChild,he=M.nextSibling;return s($,()=>e("inventory.sku")),s(K,()=>t.item.sku),s(J,()=>e("inventory.quantity")),s(de,()=>t.item.quantity,re),s(de,()=>e("common.units"),null),s(S,()=>e("inventory.minimumStock")),s(v,()=>t.item.minStock,w),s(v,()=>e("common.units"),null),s(A,()=>e("inventory.totalValue")),s(y,()=>b(R)),s(W,()=>e("inventory.supplier")),s(k,()=>t.item.supplier),s(V,()=>e("inventory.location")),s(O,()=>t.item.location),s(M,()=>e("common.lastUpdated")),s(he,()=>C(t.item.lastUpdated)),ie(z=>{var pe=r,x=n,F=i,ee=r,Q=n,ue=i,te=r,B=n,ae=i,ve=r,be=n,oe=i,ce=r,Y=n,q=i,N=r,ne=n,fe=i,U=r,j=n,Se=i;return z.e=d(E,pe,z.e),z.t=d($,x,z.t),z.a=d(K,F,z.a),z.o=d(Z,ee,z.o),z.i=d(J,Q,z.i),z.n=d(de,ue,z.n),z.s=d(I,te,z.s),z.h=d(S,B,z.h),z.r=d(v,ae,z.r),z.d=d(P,ve,z.d),z.l=d(A,be,z.l),z.u=d(y,oe,z.u),z.c=d(se,ce,z.c),z.w=d(W,Y,z.w),z.m=d(k,q,z.m),z.f=d(H,N,z.f),z.y=d(V,ne,z.y),z.g=d(O,fe,z.g),z.p=d(D,U,z.p),z.b=d(M,j,z.b),z.T=d(he,Se,z.T),z},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),T})(),(()=>{var T=BA();return d(T,f),s(T,_(De,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(T,_(De,{variant:"primary",onClick:()=>{console.log("Edit item:",t.item.id)},get children(){return e("common.editItem")}}),null),T})()]}})};var UA=G("<div>🔄"),jA=G("<button type=button>×"),zA=G("<div>⚠️ "),jh=G("<div>"),qA=G("<div><div><input type=text autocomplete=off>"),HA=G("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>"),GA=G("<span>⚠️ ");const WA=t=>{const{t:e}=ot(),[r,n]=ge(""),[i,o]=ge(!1),[a,c]=ge(null),[u,h]=ge([]),[f,g]=ge(!1),[b,C]=ge(-1),[R,T]=ge(null),E=t.searchDelay||300;t.maxResults;const $=async pe=>{if(!pe.trim()||pe.trim().length<3){h([]),t.onSearchResults?.([]);return}try{o(!0),c(null);try{console.log("apiResults",pe),t.onSearchResults?.(pe)}catch(x){console.warn("API search failed, using local fallback:",x),c("API search failed, showing local results")}}catch(x){const F=x instanceof Error?x.message:"Search failed";c(F),h([]),t.onSearchResults?.([])}finally{o(!1)}},K=pe=>{const F=pe.target.value;n(F),c(null),console.log(),t.showResults,R()&&clearTimeout(R());const ee=setTimeout(()=>{$(F)},E);T(ee)},Z=pe=>{n(pe.name),g(!1),C(-1),t.onInventorySelect?.(pe)},J=pe=>{if(!(!f()||u().length===0))switch(pe.key){case"ArrowDown":pe.preventDefault(),C(x=>Math.min(x+1,u().length-1));break;case"ArrowUp":pe.preventDefault(),C(x=>Math.max(x-1,-1));break;case"Enter":pe.preventDefault(),b()>=0&&u()[b()]&&Z(u()[b()]);break;case"Escape":g(!1),C(-1);break}},de=()=>{t.showResults!==!1&&u().length>0&&g(!0)},re=()=>{setTimeout(()=>{g(!1),C(-1)},150)},I=()=>{n(""),h([]),c(null),g(!1),C(-1),t.onSearchResults?.([]),R()&&(clearTimeout(R()),T(null))},S=pe=>Re.stockLevels.filter(x=>x.inventoryId===pe).reduce((x,F)=>x+F.quantity,0),v=pe=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(pe),w={position:"relative",width:"100%",...t.style},P={position:"relative",display:"flex","align-items":"center"},A={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},y={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},se={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},W={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},k=pe=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:pe?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),H={display:"flex","justify-content":"space-between","align-items":"center"},V={flex:"1"},O={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},D={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},M={"text-align":"right","font-size":"0.875rem"},he={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},z={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var pe=qA(),x=pe.firstChild,F=x.firstChild;return F.addEventListener("blur",re),F.addEventListener("focus",de),F.$$keydown=J,F.$$input=K,s(x,_(Le,{get when(){return i()},get children(){var ee=UA();return ie(Q=>d(ee,se,Q)),ee}}),null),s(x,_(Le,{get when(){return me(()=>!!r())()&&!i()},get children(){var ee=jA();return ee.addEventListener("mouseleave",Q=>{Q.currentTarget.style.background="none",Q.currentTarget.style.color="var(--text-muted)"}),ee.addEventListener("mouseenter",Q=>{Q.currentTarget.style.background="var(--border-color)",Q.currentTarget.style.color="var(--text-primary)"}),ee.$$click=I,ie(Q=>{var ue=y,te=e("common.clear","Clear search");return Q.e=d(ee,ue,Q.e),te!==Q.t&&lt(ee,"title",Q.t=te),Q},{e:void 0,t:void 0}),ee}}),null),s(pe,_(Le,{get when(){return f()&&t.showResults!==!1},get children(){var ee=jh();return s(ee,_(Le,{get when(){return a()},get children(){var Q=zA();return Q.firstChild,d(Q,z),s(Q,a,null),Q}}),null),s(ee,_(Le,{get when(){return u().length>0},get fallback(){return me(()=>!!(r()&&!i()))()&&(()=>{var Q=jh();return d(Q,he),s(Q,()=>e("inventory.noInventorysFound","No inventorys found matching your search.")),Q})()},get children(){return _(xt,{get each(){return u()},children:(Q,ue)=>{const te=S(Q.id),B=te<=Q.minStockLevel;return(()=>{var ae=HA(),ve=ae.firstChild,be=ve.firstChild,oe=be.firstChild,ce=oe.nextSibling,Y=ce.firstChild,q=Y.firstChild,N=Y.nextSibling,ne=N.nextSibling,fe=ne.nextSibling,U=fe.nextSibling,j=be.nextSibling,Se=j.firstChild,we=Se.firstChild,le=Se.nextSibling;return ae.addEventListener("mouseenter",()=>C(ue())),ae.$$click=()=>Z(Q),d(ve,H),d(be,V),d(oe,O),s(oe,()=>Q.name),d(ce,D),s(Y,()=>e("inventory.sku","SKU"),q),s(Y,()=>Q.sku,null),s(ne,()=>Q.category),s(U,()=>v(Q.unitCost)),d(j,M),Se.style.setProperty("font-weight","600"),(B?"#f44336":"var(--text-primary)")!=null?Se.style.setProperty("color",B?"#f44336":"var(--text-primary)"):Se.style.removeProperty("color"),s(Se,te,we),s(Se,()=>Q.unitOfMeasure,null),le.style.setProperty("color","var(--text-muted)"),s(le,()=>B?(()=>{var ye=GA();return ye.firstChild,ye.style.setProperty("color","#f44336"),s(ye,()=>e("inventory.lowStock","Low Stock"),null),ye})():e("inventory.inStock","In Stock")),ie(ye=>d(ae,k(ue()===b()),ye)),ae})()}})}}),null),ie(Q=>d(ee,W,Q)),ee}}),null),ie(ee=>{var Q=w,ue=P,te=A,B=t.placeholder||e("inventory.searchInventorys","Search inventorys by name, SKU, or category..."),ae=t.disabled;return ee.e=d(pe,Q,ee.e),ee.t=d(x,ue,ee.t),ee.a=d(F,te,ee.a),B!==ee.o&&lt(F,"placeholder",ee.o=B),ae!==ee.i&&(F.disabled=ee.i=ae),ee},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ie(()=>F.value=r()),pe})()};_t(["input","keydown","click"]);var YA=G("<div>"),Al=G("<div><span>:</span><span>"),KA=G("<div><button> "),QA=G("<div><div><div><h3></h3><div>: </div></div><div><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span> <!>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span>");const JA=t=>{const{t:e}=ot(),r=C=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(C),n=C=>new Date(C).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),i=C=>({in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}})[C]||{bg:"#f5f5f5",color:"#666"},o=C=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[C]||"📋",a=()=>t.movement,c={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},u={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},h={"font-weight":"600",color:"var(--text-primary)","text-align":"right"},f={"margin-bottom":"1.5rem"},g={"font-weight":"600","margin-bottom":"0.75rem","padding-bottom":"0.5rem","border-bottom":"2px solid var(--border-color)"},b=C=>({display:"inline-flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"600","text-transform":"uppercase","letter-spacing":"0.5px",background:i(C).bg,color:i(C).color});return _(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.movementDetails")},size:"lg",get children(){return _(Le,{get when(){return a()},get fallback(){return(()=>{var C=YA();return s(C,()=>e("common.noDataFound")),C})()},children:C=>(()=>{var R=QA(),T=R.firstChild,E=T.firstChild,$=E.firstChild,K=$.nextSibling,Z=K.firstChild,J=E.nextSibling,de=J.firstChild,re=T.nextSibling,I=re.firstChild,S=I.nextSibling,v=S.firstChild,w=v.firstChild,P=v.nextSibling,A=S.nextSibling,y=A.firstChild,se=y.firstChild,W=y.nextSibling,k=W.firstChild,H=A.nextSibling,V=H.firstChild,O=V.firstChild,D=V.nextSibling,M=H.nextSibling,he=M.firstChild,z=he.firstChild,pe=z.nextSibling;pe.nextSibling;var x=he.nextSibling,F=re.nextSibling,ee=F.firstChild,Q=ee.nextSibling,ue=Q.firstChild,te=ue.firstChild,B=ue.nextSibling,ae=F.nextSibling,ve=ae.firstChild,be=ve.nextSibling,oe=be.firstChild,ce=oe.firstChild,Y=oe.nextSibling,q=be.nextSibling,N=q.firstChild,ne=N.firstChild,fe=N.nextSibling;return T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),T.style.setProperty("margin-bottom","1.5rem"),T.style.setProperty("padding-bottom","1rem"),T.style.setProperty("border-bottom","2px solid var(--border-color)"),$.style.setProperty("margin","0 0 0.5rem 0"),$.style.setProperty("font-size","1.25rem"),s($,()=>C().productName),K.style.setProperty("font-size","0.875rem"),K.style.setProperty("color","var(--text-muted)"),s(K,()=>e("inventory.sku"),Z),s(K,()=>C().productSku,null),de.style.setProperty("font-size","1.2rem"),s(de,()=>o(C().movementType)),s(J,()=>C().movementType,null),s(I,()=>e("inventory.movementInformation")),s(v,()=>e("inventory.referenceNumber"),w),s(P,()=>C().referenceNumber),s(y,()=>e("common.quantity"),se),s(W,()=>C().quantity,k),s(W,()=>e("common.units"),null),s(V,()=>e("inventory.unitCost"),O),s(D,()=>r(C().unitCost)),s(he,()=>e("common.total"),z),s(he,()=>e("common.value"),pe),s(x,()=>r(C().totalCost)),s(ee,()=>e("inventory.locationInformation")),s(ue,()=>e("inventory.location"),te),s(B,()=>C().locationName),s(F,_(Le,{get when(){return C().fromLocationName},get children(){var U=Al(),j=U.firstChild,Se=j.firstChild,we=j.nextSibling;return s(j,()=>e("common.from"),Se),s(we,()=>C().fromLocationName),ie(le=>{var ye=c,X=u,Pe=h;return le.e=d(U,ye,le.e),le.t=d(j,X,le.t),le.a=d(we,Pe,le.a),le},{e:void 0,t:void 0,a:void 0}),U}}),null),s(F,_(Le,{get when(){return C().invoiceId},get children(){var U=Al(),j=U.firstChild,Se=j.firstChild,we=j.nextSibling;return s(j,()=>e("common.invoice"),Se),s(we,()=>C().invoiceId),ie(le=>{var ye=c,X=u,Pe={...h,color:"var(--primary-color)"};return le.e=d(U,ye,le.e),le.t=d(j,X,le.t),le.a=d(we,Pe,le.a),le},{e:void 0,t:void 0,a:void 0}),U}}),null),s(ve,()=>e("common.details")),s(oe,()=>e("common.createdBy"),ce),s(Y,()=>C().createdBy),s(N,()=>e("common.created"),ne),s(fe,()=>n(C().createdDate)),s(ae,_(Le,{get when(){return C().notes},get children(){var U=Al(),j=U.firstChild,Se=j.firstChild,we=j.nextSibling;return s(j,()=>e("common.notes"),Se),s(we,()=>C().notes),ie(le=>{var ye={...c,"border-bottom":"none"},X=u,Pe={...h,"font-style":"italic","max-width":"60%","white-space":"pre-wrap"};return le.e=d(U,ye,le.e),le.t=d(j,X,le.t),le.a=d(we,Pe,le.a),le},{e:void 0,t:void 0,a:void 0}),U}}),null),s(R,_(Le,{get when(){return t.onEdit},get children(){var U=KA(),j=U.firstChild,Se=j.firstChild;return U.style.setProperty("display","flex"),U.style.setProperty("justify-content","flex-end"),U.style.setProperty("margin-top","1.5rem"),U.style.setProperty("padding-top","1rem"),U.style.setProperty("border-top","1px solid var(--border-color)"),j.addEventListener("mouseleave",we=>{we.currentTarget.style.transform="translateY(0)",we.currentTarget.style.boxShadow="none"}),j.addEventListener("mouseenter",we=>{we.currentTarget.style.transform="translateY(-1px)",we.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)"}),j.$$click=()=>t.onEdit?.(C()),j.style.setProperty("padding","0.5rem 1.5rem"),j.style.setProperty("border-radius","var(--border-radius-sm)"),j.style.setProperty("border","1px solid var(--primary-color)"),j.style.setProperty("background","var(--primary-color)"),j.style.setProperty("color","white"),j.style.setProperty("cursor","pointer"),j.style.setProperty("font-weight","500"),j.style.setProperty("transition","all 0.2s ease"),s(j,()=>e("common.edit"),Se),s(j,()=>e("inventory.movement"),null),U}}),null),ie(U=>{var j=b(C().movementType),Se=f,we=g,le=c,ye=u,X=h,Pe=c,ke=u,Te={...h,"font-size":"1.1rem",color:"var(--primary-color)"},$e=c,Ue=u,Ye=h,ze=c,Ee=u,Me={...h,"font-size":"1.1rem",color:"var(--primary-color)"},Ke=f,Ge=g,He=c,Ae=u,st=h,Xe=f,gt=g,dt=c,Ft=u,Ht=h,$t=c,Ot=u,bt=h;return U.e=d(J,j,U.e),U.t=d(re,Se,U.t),U.a=d(I,we,U.a),U.o=d(S,le,U.o),U.i=d(v,ye,U.i),U.n=d(P,X,U.n),U.s=d(A,Pe,U.s),U.h=d(y,ke,U.h),U.r=d(W,Te,U.r),U.d=d(H,$e,U.d),U.l=d(V,Ue,U.l),U.u=d(D,Ye,U.u),U.c=d(M,ze,U.c),U.w=d(he,Ee,U.w),U.m=d(x,Me,U.m),U.f=d(F,Ke,U.f),U.y=d(ee,Ge,U.y),U.g=d(Q,He,U.g),U.p=d(ue,Ae,U.p),U.b=d(B,st,U.b),U.T=d(ae,Xe,U.T),U.A=d(ve,gt,U.A),U.O=d(be,dt,U.O),U.I=d(oe,Ft,U.I),U.S=d(Y,Ht,U.S),U.W=d(q,$t,U.W),U.C=d(N,Ot,U.C),U.B=d(fe,bt,U.B),U},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),R})()})}})};_t(["click"]);var di=G("<div>"),XA=G("<div><label></label><select><option value>"),ZA=G("<div><div><span>:</span><span>$"),eI=G("<form><div><label></label><select><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><input type=number min=0.01 step=0.01></div><div><label></label><input type=number min=0 step=0.01></div><div><label></label><input type=text></div><div><label> (<!>)</label><input type=text></div><div><label> (<!>)</label><textarea></textarea></div><div><button type=button></button><button type=submit>"),zh=G("<option> (<!>)");const tI=t=>{const{t:e}=ot(),[r,n]=ge("in"),[i,o]=ge(""),[a,c]=ge(""),[u,h]=ge(""),[f,g]=ge(""),[b,C]=ge(""),[R,T]=ge(""),[E,$]=ge(""),[K,Z]=ge(!1),[J,de]=ge({});ri(()=>{const se=t.movement;se&&t.isOpen&&(n(se.movementType),o(se.quantity.toString()),c(se.unitCost.toString()),h(se.referenceNumber),g(se.notes),T(se.locationId),C(se.fromLocationId||""),$(se.invoiceId||""),de({}))});const re=()=>{const se={};return(!i()||parseFloat(i())<=0)&&(se.quantity=e("forms.requiredField")),(!a()||parseFloat(a())<0)&&(se.unitCost=e("forms.requiredField")),u().trim()||(se.referenceNumber=e("forms.requiredField")),R()||(se.locationId=e("forms.requiredField")),r()==="transfer"&&!b()&&(se.fromLocationId=e("forms.requiredField")),de(se),Object.keys(se).length===0},I=async se=>{if(se.preventDefault(),!(!re()||!t.movement)){Z(!0);try{const W=t.movement,k=Re.getProductById(W.productId),H=Re.getLocationById(R()),V=b()?Re.getLocationById(b()):null;if(!k||!H)throw new Error("Product or location not found");const O={...W,movementType:r(),quantity:parseFloat(i()),unitCost:parseFloat(a()),totalCost:parseFloat(i())*parseFloat(a()),referenceNumber:u().trim(),notes:f().trim(),locationId:R(),locationName:H.name,fromLocationId:b()||void 0,fromLocationName:V?.name,invoiceId:E().trim()||void 0,lastModified:new Date().toISOString()};Re.updateMovement(W.id,O),t.onMovementUpdated?.(),t.onClose(),S()}catch(W){console.error("Error updating movement:",W),de({submit:e("forms.saveError")})}finally{Z(!1)}}},S=()=>{n("in"),o(""),c(""),h(""),g(""),C(""),T(""),$(""),de({})},v=()=>{S(),t.onClose()},w={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",transition:"border-color 0.2s ease"},P={display:"block","margin-bottom":"0.25rem","font-weight":"500","font-size":"0.875rem"},A={color:"#d32f2f","font-size":"0.75rem","margin-top":"0.25rem"},y={"margin-bottom":"1rem"};return _(yr,{get isOpen(){return t.isOpen},onClose:v,get title(){return e("inventory.editMovement","Edit Movement")},get children(){return _(Le,{get when(){return t.movement},get fallback(){return(()=>{var se=di();return s(se,()=>e("common.loading")),se})()},get children(){var se=eI(),W=se.firstChild,k=W.firstChild,H=k.nextSibling,V=H.firstChild,O=V.nextSibling,D=O.nextSibling,M=D.nextSibling,he=W.nextSibling,z=he.firstChild,pe=z.nextSibling,x=pe.firstChild,F=he.nextSibling,ee=F.firstChild,Q=ee.nextSibling,ue=F.nextSibling,te=ue.firstChild,B=te.nextSibling,ae=ue.nextSibling,ve=ae.firstChild,be=ve.nextSibling,oe=ae.nextSibling,ce=oe.firstChild,Y=ce.firstChild,q=Y.nextSibling;q.nextSibling;var N=ce.nextSibling,ne=oe.nextSibling,fe=ne.firstChild,U=fe.firstChild,j=U.nextSibling;j.nextSibling;var Se=fe.nextSibling,we=ne.nextSibling,le=we.firstChild,ye=le.nextSibling;return se.addEventListener("submit",I),s(k,()=>e("inventory.movementType")),H.addEventListener("change",X=>n(X.target.value)),s(V,()=>e("inventory.stockIn")),s(O,()=>e("inventory.stockOut")),s(D,()=>e("inventory.transfer")),s(M,()=>e("inventory.adjustment")),s(z,(()=>{var X=me(()=>r()==="transfer");return()=>X()?e("inventory.toLocation"):e("inventory.location")})()),pe.addEventListener("change",X=>T(X.target.value)),s(x,()=>e("modals.selectLocation")),s(pe,_(xt,{get each(){return Re.getActiveLocations()},children:X=>(()=>{var Pe=zh(),ke=Pe.firstChild,Te=ke.nextSibling;return Te.nextSibling,s(Pe,()=>X.name,ke),s(Pe,()=>X.type,Te),ie(()=>Pe.value=X.id),Pe})()}),null),s(he,_(Le,{get when(){return J().locationId},get children(){var X=di();return s(X,()=>J().locationId),ie(Pe=>d(X,A,Pe)),X}}),null),s(se,_(Le,{get when(){return r()==="transfer"},get children(){var X=XA(),Pe=X.firstChild,ke=Pe.nextSibling,Te=ke.firstChild;return s(Pe,()=>e("inventory.fromLocation")),ke.addEventListener("change",$e=>C($e.target.value)),s(Te,()=>e("modals.selectLocation")),s(ke,_(xt,{get each(){return Re.getActiveLocations().filter($e=>$e.id!==R())},children:$e=>(()=>{var Ue=zh(),Ye=Ue.firstChild,ze=Ye.nextSibling;return ze.nextSibling,s(Ue,()=>$e.name,Ye),s(Ue,()=>$e.type,ze),ie(()=>Ue.value=$e.id),Ue})()}),null),s(X,_(Le,{get when(){return J().fromLocationId},get children(){var $e=di();return s($e,()=>J().fromLocationId),ie(Ue=>d($e,A,Ue)),$e}}),null),ie($e=>{var Ue=y,Ye=P,ze={...w,"border-color":J().fromLocationId?"#d32f2f":"var(--border-color)"},Ee=K();return $e.e=d(X,Ue,$e.e),$e.t=d(Pe,Ye,$e.t),$e.a=d(ke,ze,$e.a),Ee!==$e.o&&(ke.disabled=$e.o=Ee),$e},{e:void 0,t:void 0,a:void 0,o:void 0}),ie(()=>ke.value=b()),X}}),F),s(ee,()=>e("common.quantity")),Q.$$input=X=>o(X.target.value),s(F,_(Le,{get when(){return J().quantity},get children(){var X=di();return s(X,()=>J().quantity),ie(Pe=>d(X,A,Pe)),X}}),null),s(te,()=>e("inventory.unitCost")),B.$$input=X=>c(X.target.value),s(ue,_(Le,{get when(){return J().unitCost},get children(){var X=di();return s(X,()=>J().unitCost),ie(Pe=>d(X,A,Pe)),X}}),null),s(se,_(Le,{get when(){return me(()=>!!i())()&&a()},get children(){var X=ZA(),Pe=X.firstChild,ke=Pe.firstChild,Te=ke.firstChild,$e=ke.nextSibling;return $e.firstChild,Pe.style.setProperty("display","flex"),Pe.style.setProperty("justify-content","space-between"),ke.style.setProperty("font-weight","500"),s(ke,()=>e("common.total"),Te),$e.style.setProperty("font-weight","600"),$e.style.setProperty("color","var(--primary-color)"),s($e,()=>(parseFloat(i()||"0")*parseFloat(a()||"0")).toFixed(2),null),ie(Ue=>d(X,{...y,padding:"0.75rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)"},Ue)),X}}),ae),s(ve,()=>e("inventory.referenceNumber")),be.$$input=X=>h(X.target.value),s(ae,_(Le,{get when(){return J().referenceNumber},get children(){var X=di();return s(X,()=>J().referenceNumber),ie(Pe=>d(X,A,Pe)),X}}),null),s(ce,()=>e("inventory.invoiceNumber"),Y),s(ce,()=>e("common.optional"),q),N.$$input=X=>$(X.target.value),s(fe,()=>e("common.notes"),U),s(fe,()=>e("common.optional"),j),Se.$$input=X=>g(X.target.value),s(se,_(Le,{get when(){return J().submit},get children(){var X=di();return s(X,()=>J().submit),ie(Pe=>d(X,{...A,"margin-bottom":"1rem"},Pe)),X}}),we),we.style.setProperty("display","flex"),we.style.setProperty("gap","1rem"),we.style.setProperty("justify-content","flex-end"),le.$$click=v,le.style.setProperty("padding","0.5rem 1rem"),le.style.setProperty("border","1px solid var(--border-color)"),le.style.setProperty("border-radius","var(--border-radius-sm)"),le.style.setProperty("background","white"),le.style.setProperty("cursor","pointer"),s(le,()=>e("common.cancel")),ye.style.setProperty("padding","0.5rem 1rem"),ye.style.setProperty("border","none"),ye.style.setProperty("border-radius","var(--border-radius-sm)"),ye.style.setProperty("background","var(--primary-color)"),ye.style.setProperty("color","white"),ye.style.setProperty("cursor","pointer"),ye.style.setProperty("font-weight","500"),s(ye,(()=>{var X=me(()=>!!K());return()=>X()?e("modals.processing"):e("inventory.updateMovement","Update Movement")})()),ie(X=>{var Pe=y,ke=P,Te=w,$e=K(),Ue=y,Ye=P,ze={...w,"border-color":J().locationId?"#d32f2f":"var(--border-color)"},Ee=K(),Me=y,Ke=P,Ge={...w,"border-color":J().quantity?"#d32f2f":"var(--border-color)"},He=e("modals.enterQuantity"),Ae=K(),st=y,Xe=P,gt={...w,"border-color":J().unitCost?"#d32f2f":"var(--border-color)"},dt=e("modals.enterCost"),Ft=K(),Ht=y,$t=P,Ot={...w,"border-color":J().referenceNumber?"#d32f2f":"var(--border-color)"},bt=e("modals.enterReference"),Jt=K(),St=y,ir=P,Oe=w,Ve=e("inventory.invoiceNumber"),Je=K(),nt=y,kt=P,Ze={...w,resize:"vertical","min-height":"80px"},ht=e("modals.addNotes"),pt=K(),Ct=K(),ct=K();return X.e=d(W,Pe,X.e),X.t=d(k,ke,X.t),X.a=d(H,Te,X.a),$e!==X.o&&(H.disabled=X.o=$e),X.i=d(he,Ue,X.i),X.n=d(z,Ye,X.n),X.s=d(pe,ze,X.s),Ee!==X.h&&(pe.disabled=X.h=Ee),X.r=d(F,Me,X.r),X.d=d(ee,Ke,X.d),X.l=d(Q,Ge,X.l),He!==X.u&&lt(Q,"placeholder",X.u=He),Ae!==X.c&&(Q.disabled=X.c=Ae),X.w=d(ue,st,X.w),X.m=d(te,Xe,X.m),X.f=d(B,gt,X.f),dt!==X.y&&lt(B,"placeholder",X.y=dt),Ft!==X.g&&(B.disabled=X.g=Ft),X.p=d(ae,Ht,X.p),X.b=d(ve,$t,X.b),X.T=d(be,Ot,X.T),bt!==X.A&&lt(be,"placeholder",X.A=bt),Jt!==X.O&&(be.disabled=X.O=Jt),X.I=d(oe,St,X.I),X.S=d(ce,ir,X.S),X.W=d(N,Oe,X.W),Ve!==X.C&&lt(N,"placeholder",X.C=Ve),Je!==X.B&&(N.disabled=X.B=Je),X.v=d(ne,nt,X.v),X.k=d(fe,kt,X.k),X.x=d(Se,Ze,X.x),ht!==X.j&&lt(Se,"placeholder",X.j=ht),pt!==X.q&&(Se.disabled=X.q=pt),Ct!==X.z&&(le.disabled=X.z=Ct),ct!==X.P&&(ye.disabled=X.P=ct),X},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0,z:void 0,P:void 0}),ie(()=>H.value=r()),ie(()=>pe.value=R()),ie(()=>Q.value=i()),ie(()=>B.value=a()),ie(()=>be.value=u()),ie(()=>N.value=E()),ie(()=>Se.value=f()),se}})}})};_t(["input","click"]);var rI=G("<div><div></div><div><div><label></label><select><option value=all></option><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),nI=G("<div><h2>"),qh=G("<div><label></label><select><option value>"),iI=G("<option> (<!>)"),oI=G("<option>"),sI=G("<div><div>📦</div><div></div><div>"),aI=G("<div><div><div><div><span></span><h3></h3><span></span></div><div> • </div></div><div><div></div><div> <!> @ </div></div></div><div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div><span>:</span><span>"),lI=G("<span>"),cI=G("<span>• <!>: "),Hh=G("<div><span>:</span><span>"),uI=G("<div><div><span>:</span><select><option value=10>10</option><option value=25>25</option><option value=50>50</option><option value=100>100</option></select><span></span></div><div><div><span>:</span><input type=number min=1><span> "),dI=G("<span>..."),hI=G("<button>");const mI=t=>{const{t:e}=ot(),[r,n]=ge(""),[i,o]=ge(""),[a,c]=ge("all"),[u,h]=ge({start:"",end:""}),[f,g]=ge(""),[b,C]=ge(""),[R,T]=ge(1),[E,$]=ge(25),[K,Z]=ge(null),[J,de]=ge(!1),[re,I]=ge(!1),S=qe(()=>{let q=Re.movements;if(t.filterBy==="product"&&t.filterId?q=q.filter(N=>N.productId===t.filterId):t.filterBy==="location"&&t.filterId&&(q=q.filter(N=>N.locationId===t.filterId)),r()&&(q=q.filter(N=>N.productId===r())),i()&&(q=q.filter(N=>N.locationId===i())),a()!=="all"&&(q=q.filter(N=>N.movementType===a())),u().start&&(q=q.filter(N=>N.createdDate>=u().start)),u().end&&(q=q.filter(N=>N.createdDate<=u().end+"T23:59:59Z")),f()){const N=f().toLowerCase();q=q.filter(ne=>ne.productName.toLowerCase().includes(N)||ne.productSku.toLowerCase().includes(N)||ne.locationName.toLowerCase().includes(N)||ne.referenceNumber.toLowerCase().includes(N)||ne.notes.toLowerCase().includes(N)||ne.createdBy.toLowerCase().includes(N)||ne.invoiceId&&ne.invoiceId.toLowerCase().includes(N)||ne.fromLocationName&&ne.fromLocationName.toLowerCase().includes(N)||ne.movementType.toLowerCase().includes(N))}return q.sort((N,ne)=>new Date(ne.createdDate).getTime()-new Date(N.createdDate).getTime())});ri(()=>{r(),i(),a(),u(),f(),T(1)});const v=qe(()=>{const q=(R()-1)*E(),N=q+E();return S().slice(q,N)}),w=qe(()=>Math.ceil(S().length/E())),P=qe(()=>{const q=S();return{total:q.length,stockIn:q.filter(N=>N.movementType==="in").length,stockOut:q.filter(N=>N.movementType==="out").length,transfers:q.filter(N=>N.movementType==="transfer").length,adjustments:q.filter(N=>N.movementType==="adjustment").length,totalValue:q.reduce((N,ne)=>N+ne.totalCost,0)}}),A={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},y={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},se={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)",cursor:"pointer"},W={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},k={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem","margin-bottom":"2rem"},H={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","text-align":"center"},V={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},O={"font-size":"0.875rem",color:"var(--text-muted)","font-weight":"500"},D={padding:"1.5rem","margin-bottom":"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",transition:"all 0.2s ease"},M={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"1rem"};function he(q){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[q]||{bg:"#f5f5f5",color:"#666"}}const z=q=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:he(q).bg,color:he(q).color}),pe={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"1rem"},x={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.5rem 0","border-bottom":"1px solid var(--border-color)"},F={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},ee={"font-weight":"600",color:"var(--text-primary)"},Q={display:"flex","justify-content":"space-between","align-items":"center","margin-top":"2rem",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},ue=q=>({padding:"0.25rem 0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:q?"var(--primary-color)":"var(--surface-color)",color:q?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),te=q=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(q),B=q=>new Date(q).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),ae=q=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[q]||"📋",ve=()=>{n(""),o(""),c("all"),h({start:"",end:""}),g(""),T(1)},be=q=>{Z(q),de(!0)},oe=q=>{Z(q),de(!1),I(!0)},ce=()=>{I(!1),Z(null)},Y=async q=>{i()&&(q+=" "+i()),jl(a())&&(q+=" "+jl(a()));const N=await jn.getInventory(q),ne=Re.parseInventoryData(N);Re.updMovements(ne)};return(()=>{var q=rI(),N=q.firstChild,ne=N.nextSibling,fe=ne.firstChild,U=fe.firstChild,j=U.nextSibling,Se=j.firstChild,we=Se.nextSibling,le=we.nextSibling,ye=le.nextSibling,X=ye.nextSibling,Pe=fe.nextSibling,ke=Pe.firstChild,Te=ke.nextSibling,$e=Pe.nextSibling,Ue=$e.firstChild,Ye=Ue.nextSibling,ze=ne.nextSibling,Ee=ze.firstChild,Me=Ee.firstChild,Ke=Me.nextSibling,Ge=Ee.nextSibling,He=Ge.firstChild,Ae=He.nextSibling,st=Ge.nextSibling,Xe=st.firstChild,gt=Xe.nextSibling,dt=st.nextSibling,Ft=dt.firstChild,Ht=Ft.nextSibling,$t=dt.nextSibling,Ot=$t.firstChild,bt=Ot.nextSibling,Jt=$t.nextSibling,St=Jt.firstChild,ir=St.nextSibling;return s(q,(()=>{var Oe=me(()=>!t.filterBy);return()=>Oe()&&(()=>{var Ve=nI(),Je=Ve.firstChild;return d(Ve,A),Je.style.setProperty("margin","0"),Je.style.setProperty("font-size","1.5rem"),s(Je,()=>e("inventory.movements")),s(Ve,_(De,{variant:"outline",onClick:ve,get children(){return e("common.clearFilters")}}),null),Ve})()})(),N),s(q,_(WA,{filters:{selectedLocation:i,movementType:a},onSearchResults:Oe=>{C(Oe),Y(Oe)},get placeholder(){return e("inventory.searchProductsStock","Search inventories...")},showResults:!1,maxResults:20}),N),N.style.setProperty("margin","20px"),d(ne,y),s(ne,(()=>{var Oe=me(()=>!t.filterBy);return()=>Oe()&&[(()=>{var Ve=qh(),Je=Ve.firstChild,nt=Je.nextSibling,kt=nt.firstChild;return Je.style.setProperty("display","block"),Je.style.setProperty("margin-bottom","0.5rem"),Je.style.setProperty("font-weight","500"),s(Je,()=>e("inventory.product")),nt.addEventListener("change",Ze=>n(Ze.target.value)),s(kt,()=>e("inventory.allProducts")),s(nt,_(xt,{get each(){return Re.products},children:Ze=>(()=>{var ht=iI(),pt=ht.firstChild,Ct=pt.nextSibling;return Ct.nextSibling,s(ht,()=>Ze.name,pt),s(ht,()=>Ze.sku,Ct),ie(()=>ht.value=Ze.id),ht})()}),null),ie(Ze=>d(nt,se,Ze)),ie(()=>nt.value=r()),Ve})(),(()=>{var Ve=qh(),Je=Ve.firstChild,nt=Je.nextSibling,kt=nt.firstChild;return Je.style.setProperty("display","block"),Je.style.setProperty("margin-bottom","0.5rem"),Je.style.setProperty("font-weight","500"),s(Je,()=>e("inventory.location")),nt.addEventListener("change",Ze=>o(Ze.target.value)),s(kt,()=>e("inventory.allLocations")),s(nt,_(xt,{get each(){return Re.locations},children:Ze=>(()=>{var ht=oI();return s(ht,()=>Ze.name),ie(()=>ht.value=Ze.id),ht})()}),null),ie(Ze=>d(nt,se,Ze)),ie(()=>nt.value=i()),Ve})()]})(),fe),U.style.setProperty("display","block"),U.style.setProperty("margin-bottom","0.5rem"),U.style.setProperty("font-weight","500"),s(U,()=>e("inventory.movementType")),j.addEventListener("change",Oe=>{c(Oe.target.value),Y(b())}),s(Se,()=>e("inventory.allTypes")),s(we,()=>e("inventory.stockIn")),s(le,()=>e("inventory.stockOut")),s(ye,()=>e("inventory.transfer")),s(X,()=>e("inventory.adjustment")),ke.style.setProperty("display","block"),ke.style.setProperty("margin-bottom","0.5rem"),ke.style.setProperty("font-weight","500"),s(ke,()=>e("common.startDate")),Te.addEventListener("change",Oe=>h(Ve=>({...Ve,start:Oe.target.value}))),Ue.style.setProperty("display","block"),Ue.style.setProperty("margin-bottom","0.5rem"),Ue.style.setProperty("font-weight","500"),s(Ue,()=>e("common.endDate")),Ye.addEventListener("change",Oe=>h(Ve=>({...Ve,end:Oe.target.value}))),d(ze,k),s(Me,()=>P().total),s(Ke,()=>e("inventory.totalMovements")),s(He,()=>P().stockIn),s(Ae,()=>e("inventory.stockIn")),s(Xe,()=>P().stockOut),s(gt,()=>e("inventory.stockOut")),s(Ft,()=>P().transfers),s(Ht,()=>e("inventory.transfers")),s(Ot,()=>P().adjustments),s(bt,()=>e("inventory.adjustments")),s(St,()=>te(P().totalValue)),s(ir,()=>e("inventory.totalValue")),s(q,(()=>{var Oe=me(()=>v().length===0);return()=>Oe()?(()=>{var Ve=sI(),Je=Ve.firstChild,nt=Je.nextSibling,kt=nt.nextSibling;return Ve.style.setProperty("text-align","center"),Ve.style.setProperty("padding","3rem"),Ve.style.setProperty("color","var(--text-muted)"),Ve.style.setProperty("background","var(--surface-color)"),Ve.style.setProperty("border-radius","var(--border-radius)"),Ve.style.setProperty("border","1px solid var(--border-color)"),Je.style.setProperty("font-size","1.5rem"),Je.style.setProperty("margin-bottom","1rem"),nt.style.setProperty("font-size","1.1rem"),nt.style.setProperty("margin-bottom","0.5rem"),s(nt,()=>e("inventory.noMovementsFound")),kt.style.setProperty("font-size","0.875rem"),s(kt,()=>e("inventory.tryAdjustingFilters")),Ve})():[_(xt,{get each(){return v()},children:Ve=>(()=>{var Je=aI(),nt=Je.firstChild,kt=nt.firstChild,Ze=kt.firstChild,ht=Ze.firstChild,pt=ht.nextSibling,Ct=pt.nextSibling,ct=Ze.nextSibling,Nr=ct.firstChild,Vt=kt.nextSibling,Ut=Vt.firstChild,Yt=Ut.nextSibling,Rt=Yt.firstChild,Xt=Rt.nextSibling;Xt.nextSibling;var jr=nt.nextSibling,qt=jr.firstChild,lr=qt.firstChild,Lr=lr.firstChild,mn=Lr.firstChild,Mr=Lr.nextSibling,si=lr.nextSibling,$i=si.firstChild,vs=$i.firstChild,yo=$i.nextSibling,go=qt.nextSibling,ki=go.firstChild,$n=ki.firstChild,bs=$n.firstChild,po=$n.nextSibling;return Je.addEventListener("mouseleave",at=>{at.currentTarget.style.transform="translateY(0)",at.currentTarget.style.boxShadow="none"}),Je.addEventListener("mouseenter",at=>{at.currentTarget.style.transform="translateY(-2px)",at.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),Je.$$click=()=>be(Ve),d(nt,M),Ze.style.setProperty("display","flex"),Ze.style.setProperty("align-items","center"),Ze.style.setProperty("gap","0.5rem"),Ze.style.setProperty("margin-bottom","0.5rem"),ht.style.setProperty("font-size","1.2rem"),s(ht,()=>ae(Ve.movementType)),pt.style.setProperty("margin","0"),pt.style.setProperty("font-size","1.1rem"),s(pt,()=>Ve.productName),s(Ct,()=>Ve.movementType),s(Ze,(()=>{var at=me(()=>!!Ve.invoiceId);return()=>at()&&(()=>{var Dt=lI();return Dt.style.setProperty("padding","0.2rem 0.5rem"),Dt.style.setProperty("border-radius","var(--border-radius-sm)"),Dt.style.setProperty("font-size","0.7rem"),Dt.style.setProperty("font-weight","500"),Dt.style.setProperty("background","var(--primary-color)"),Dt.style.setProperty("color","white"),s(Dt,()=>e("inventory.bulk")),Dt})()})(),null),ct.style.setProperty("font-size","0.875rem"),ct.style.setProperty("color","var(--text-muted)"),s(ct,()=>Ve.productSku,Nr),s(ct,()=>B(Ve.createdDate),null),s(ct,(()=>{var at=me(()=>!!Ve.invoiceId);return()=>at()&&(()=>{var Dt=cI(),gr=Dt.firstChild,zr=gr.nextSibling;return zr.nextSibling,Dt.style.setProperty("margin-left","0.5rem"),Dt.style.setProperty("font-weight","500"),s(Dt,()=>e("common.invoice"),zr),s(Dt,()=>Ve.invoiceId,null),Dt})()})(),null),Vt.style.setProperty("text-align","right"),Ut.style.setProperty("font-size","1.25rem"),Ut.style.setProperty("font-weight","700"),Ut.style.setProperty("color","var(--primary-color)"),s(Ut,()=>te(Ve.totalCost)),Yt.style.setProperty("font-size","0.875rem"),Yt.style.setProperty("color","var(--text-muted)"),s(Yt,()=>Ve.quantity,Rt),s(Yt,()=>e("common.units"),Xt),s(Yt,()=>te(Ve.unitCost),null),d(jr,pe),s(Lr,()=>e("inventory.location"),mn),s(Mr,()=>Ve.locationName),s(qt,(()=>{var at=me(()=>!!Ve.fromLocationName);return()=>at()&&(()=>{var Dt=Hh(),gr=Dt.firstChild,zr=gr.firstChild,fn=gr.nextSibling;return s(gr,()=>e("common.from"),zr),s(fn,()=>Ve.fromLocationName),ie(jt=>{var Ar=x,Jr=F,Xr=ee;return jt.e=d(Dt,Ar,jt.e),jt.t=d(gr,Jr,jt.t),jt.a=d(fn,Xr,jt.a),jt},{e:void 0,t:void 0,a:void 0}),Dt})()})(),si),s($i,()=>e("common.reference"),vs),s(yo,()=>Ve.referenceNumber),s($n,()=>e("common.createdBy"),bs),s(po,()=>Ve.createdBy),s(go,(()=>{var at=me(()=>!!Ve.notes);return()=>at()&&(()=>{var Dt=Hh(),gr=Dt.firstChild,zr=gr.firstChild,fn=gr.nextSibling;return s(gr,()=>e("common.notes"),zr),s(fn,()=>Ve.notes),ie(jt=>{var Ar={...x,"border-bottom":"none"},Jr=F,Xr={...ee,"max-width":"200px","text-align":"right","font-style":"italic"};return jt.e=d(Dt,Ar,jt.e),jt.t=d(gr,Jr,jt.t),jt.a=d(fn,Xr,jt.a),jt},{e:void 0,t:void 0,a:void 0}),Dt})()})(),null),ie(at=>{var Dt={...D,"border-left":Ve.invoiceId?"4px solid var(--primary-color)":"1px solid var(--border-color)",cursor:"pointer"},gr=z(Ve.movementType),zr=x,fn=F,jt=ee,Ar=x,Jr=F,Xr=ee,_s=x,Nt=F,Ri=ee;return at.e=d(Je,Dt,at.e),at.t=d(Ct,gr,at.t),at.a=d(lr,zr,at.a),at.o=d(Lr,fn,at.o),at.i=d(Mr,jt,at.i),at.n=d(si,Ar,at.n),at.s=d($i,Jr,at.s),at.h=d(yo,Xr,at.h),at.r=d(ki,_s,at.r),at.d=d($n,Nt,at.d),at.l=d(po,Ri,at.l),at},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),Je})()}),me(()=>me(()=>w()>1)()&&(()=>{var Ve=uI(),Je=Ve.firstChild,nt=Je.firstChild,kt=nt.firstChild,Ze=nt.nextSibling,ht=Ze.nextSibling,pt=Je.nextSibling,Ct=pt.firstChild,ct=Ct.firstChild,Nr=ct.firstChild,Vt=ct.nextSibling,Ut=Vt.nextSibling,Yt=Ut.firstChild;return d(Ve,Q),Je.style.setProperty("display","flex"),Je.style.setProperty("align-items","center"),Je.style.setProperty("gap","0.5rem"),nt.style.setProperty("font-size","0.875rem"),nt.style.setProperty("color","var(--text-muted)"),s(nt,()=>e("common.showPerPage","Show per page"),kt),Ze.addEventListener("change",Rt=>{$(Number(Rt.target.value)),T(1)}),Ze.style.setProperty("padding","0.25rem 0.5rem"),Ze.style.setProperty("border","1px solid var(--border-color)"),Ze.style.setProperty("border-radius","var(--border-radius-sm)"),Ze.style.setProperty("background","var(--surface-color)"),Ze.style.setProperty("cursor","pointer"),Ze.style.setProperty("font-size","0.875rem"),ht.style.setProperty("font-size","0.875rem"),ht.style.setProperty("color","var(--text-muted)"),ht.style.setProperty("margin-left","1rem"),s(ht,()=>e("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:(R()-1)*E()+1,end:Math.min(R()*E(),S().length),total:S().length})),pt.style.setProperty("display","flex"),pt.style.setProperty("align-items","center"),pt.style.setProperty("gap","0.5rem"),s(pt,_(De,{variant:"outline",size:"sm",onClick:()=>T(1),get disabled(){return R()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.first","First")}}),Ct),s(pt,_(De,{variant:"outline",size:"sm",onClick:()=>T(Rt=>Math.max(1,Rt-1)),get disabled(){return R()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.previous")}}),Ct),s(pt,()=>{const Rt=[],Xt=w(),jr=R();if(Xt<=7)for(let qt=1;qt<=Xt;qt++)Rt.push(qt);else{Rt.push(1),jr>3&&Rt.push("...");for(let qt=Math.max(2,jr-1);qt<=Math.min(Xt-1,jr+1);qt++)Rt.includes(qt)||Rt.push(qt);jr<Xt-2&&Rt.push("..."),Rt.includes(Xt)||Rt.push(Xt)}return _(xt,{each:Rt,children:qt=>qt==="..."?(()=>{var lr=dI();return lr.style.setProperty("padding","0 0.5rem"),lr.style.setProperty("color","var(--text-muted)"),lr})():(()=>{var lr=hI();return lr.$$click=()=>T(qt),s(lr,qt),ie(Lr=>d(lr,ue(qt===R()),Lr)),lr})()})},Ct),s(pt,_(De,{variant:"outline",size:"sm",onClick:()=>T(Rt=>Math.min(w(),Rt+1)),get disabled(){return R()===w()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.next")}}),Ct),s(pt,_(De,{variant:"outline",size:"sm",onClick:()=>T(w()),get disabled(){return R()===w()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.last","Last")}}),Ct),Ct.style.setProperty("display","flex"),Ct.style.setProperty("align-items","center"),Ct.style.setProperty("gap","0.5rem"),Ct.style.setProperty("margin-left","1rem"),ct.style.setProperty("font-size","0.875rem"),ct.style.setProperty("color","var(--text-muted)"),s(ct,()=>e("common.page","Page"),Nr),Vt.addEventListener("change",Rt=>{const Xt=Number(Rt.target.value);Xt>=1&&Xt<=w()&&T(Xt)}),Vt.style.setProperty("width","4rem"),Vt.style.setProperty("padding","0.25rem 0.5rem"),Vt.style.setProperty("border","1px solid var(--border-color)"),Vt.style.setProperty("border-radius","var(--border-radius-sm)"),Vt.style.setProperty("background","var(--surface-color)"),Vt.style.setProperty("text-align","center"),Vt.style.setProperty("font-size","0.875rem"),Ut.style.setProperty("font-size","0.875rem"),Ut.style.setProperty("color","var(--text-muted)"),s(Ut,()=>e("common.of","of"),Yt),s(Ut,w,null),ie(()=>lt(Vt,"max",w())),ie(()=>Ze.value=E()),ie(()=>Vt.value=R()),Ve})())]})(),null),s(q,_(JA,{get isOpen(){return J()},onClose:()=>{de(!1),Z(null)},get movement(){return K()},onEdit:oe}),null),s(q,_(Le,{get when(){return Et.hasPermission("read_write")},get children(){return _(tI,{get isOpen(){return re()},onClose:()=>{I(!1),Z(null)},get movement(){return K()},onMovementUpdated:ce})}}),null),ie(Oe=>{var Ve=se,Je=W,nt=W,kt=H,Ze=V,ht=O,pt=H,Ct={...V,color:"#2d7d32"},ct=O,Nr=H,Vt={...V,color:"#d32f2f"},Ut=O,Yt=H,Rt={...V,color:"#1976d2"},Xt=O,jr=H,qt={...V,color:"#f57c00"},lr=O,Lr=H,mn=V,Mr=O;return Oe.e=d(j,Ve,Oe.e),Oe.t=d(Te,Je,Oe.t),Oe.a=d(Ye,nt,Oe.a),Oe.o=d(Ee,kt,Oe.o),Oe.i=d(Me,Ze,Oe.i),Oe.n=d(Ke,ht,Oe.n),Oe.s=d(Ge,pt,Oe.s),Oe.h=d(He,Ct,Oe.h),Oe.r=d(Ae,ct,Oe.r),Oe.d=d(st,Nr,Oe.d),Oe.l=d(Xe,Vt,Oe.l),Oe.u=d(gt,Ut,Oe.u),Oe.c=d(dt,Yt,Oe.c),Oe.w=d(Ft,Rt,Oe.w),Oe.m=d(Ht,Xt,Oe.m),Oe.f=d($t,jr,Oe.f),Oe.y=d(Ot,qt,Oe.y),Oe.g=d(bt,lr,Oe.g),Oe.p=d(Jt,Lr,Oe.p),Oe.b=d(St,mn,Oe.b),Oe.T=d(ir,Mr,Oe.T),Oe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),ie(()=>j.value=a()),ie(()=>Te.value=u().start),ie(()=>Ye.value=u().end),q})()};_t(["click"]);var fI=G("<div><p>📋 "),yI=G("<div>"),gI=G("<div><div>📊</div><h3></h3><p></p><div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=name></option><option value=sku></option><option value=category>"),pI=G("<div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div>%</div><div></div></div></div><div></div><div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),vI=G("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),bI=G("<div><div>✅</div><h3></h3><p>"),_I=G("<div><div><h3>📋 </h3><p></p></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div></div><div>"),SI=G("<div><div><div><h2>📋 </h2><button>×"),Gh=G("<option>"),PI=G("<div>..."),wI=G("<tr><td><div></div><div> • </div></td><td><div></div></td><td><div></div></td><td><div></div></td><td><div>"),CI=G("<tr><td><div></div></td><td><div></div><div> • <!> • </div></td><td><div></div></td><td><input type=number placeholder=0 min=0 step=0.01></td><td><div></div></td><td><input type=text>");const AI=t=>{const{t:e}=ot(),[r,n]=ge([]),[i,o]=ge(!1),[a,c]=ge(!1),[u,h]=ge("all"),[f,g]=ge("all"),[b,C]=ge("name"),[R,T]=ge([]),[E,$]=ge("setup"),K=async()=>{try{o(!0);const O=await jn.getProducts("prod");if(!O||typeof O!="object"){console.warn("No API results, using local store"),n(Re.products);return}const D=Object.keys(O),M=z=>{let x=O[z];return{id:z,name:x.name||"Unknown Product",businessId:x.businessId||"",sku:x.code||x.sku||"",UPC:x.UPC||"",numCode:x.codeN||"",category:x.category||"General",unitCost:x.unitCost||0,unitOfMeasure:x.unitOfMeasure||"pcs",minStockLevel:x.minStockLevel||0,maxStockLevel:x.maxStockLevel||100,isActive:x.isActive!==!1,description:x.description||"",createdDate:x.createdAt||new Date().toISOString(),lastModified:x.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(x.sellingPrice||x.price||"0")}},he=D.map(M);n(he)}catch(O){console.error("Failed to load products from API:",O),n(Re.products)}finally{o(!1)}},Z=qe(()=>[...new Set(r().map(D=>D.category).filter(D=>D))].sort()),J=qe(()=>{let O=r().filter(D=>D.isActive);return f()!=="all"&&(O=O.filter(D=>D.category===f())),O.sort((D,M)=>{switch(b()){case"name":return D.name.localeCompare(M.name);case"sku":return D.sku.localeCompare(M.sku);case"category":return D.category.localeCompare(M.category)||D.name.localeCompare(M.name);default:return 0}}),O}),de=qe(()=>Re.getActiveLocations()),re=(O,D)=>D&&D!=="all"?Re.getStockByProductAndLocation(O,D)?.quantity||0:Re.getTotalStockByProduct(O),I=()=>{const O=J().map(D=>{const M=re(D.id,u()!=="all"?u():void 0);return{productId:D.id,systemQuantity:M,physicalCount:null,notes:"",variance:0,product:D}});T(O),$("counting")},S=(O,D)=>{T(M=>M.map(he=>{if(he.productId===O){const z=D,pe=z!==null?z-he.systemQuantity:0;return{...he,physicalCount:z,variance:pe}}return he}))},v=(O,D)=>{T(M=>M.map(he=>he.productId===O?{...he,notes:D}:he))},w=qe(()=>{const O=R(),D=O.length,M=O.filter(x=>x.physicalCount!==null).length,he=O.filter(x=>x.variance!==0).length,z=O.filter(x=>x.variance>0).length,pe=O.filter(x=>x.variance<0).length;return{totalProducts:D,countedProducts:M,remainingProducts:D-M,variances:he,positiveVariances:z,negativeVariances:pe,isComplete:M===D}}),P=()=>{const O=R().filter(z=>z.physicalCount!==null&&z.variance!==0);if(O.length===0)return null;const D=[e("inventory.product","Product"),e("inventory.sku","SKU"),e("inventory.category","Category"),e("inventory.location","Location"),e("inventory.systemQty","System Qty"),e("inventory.physicalCount","Physical Count"),e("inventory.variance","Variance"),e("inventory.adjustment","Adjustment"),e("common.notes","Notes"),e("common.date","Date")],M=O.map(z=>[`"${z.product.name}"`,`"${z.product.sku}"`,`"${z.product.category}"`,`"${se()}"`,z.systemQuantity,z.physicalCount,z.variance,z.variance>0?e("inventory.stockIncrease","Stock Increase"):e("inventory.stockDecrease","Stock Decrease"),`"${z.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")}"`,`"${W()}"`]);return[D.join(","),...M.map(z=>z.join(","))].join(`
`)},A=()=>{const O=P();if(!O){alert(e("inventory.noAdjustmentsToDownload","No adjustments to download"));return}const D=new Blob([O],{type:"text/csv;charset=utf-8;"}),M=document.createElement("a");if(M.download!==void 0){const he=URL.createObjectURL(D);M.setAttribute("href",he),M.setAttribute("download",`inventory-adjustments-${W().replace(/[/:,\s]/g,"-")}.csv`),M.style.visibility="hidden",document.body.appendChild(M),M.click(),document.body.removeChild(M)}},y=async(O=!0)=>{try{c(!0),console.log(R());const D=F=>{let ee=Re.getProductById(F.productId),Q=Re.getStockByProductAndLocation(F.productId,u()),ue=parseFloat(Q?.averageCost+""),te=parseFloat(Q?.quantity+"");return{product:{id:F.productId,label:ee?.name,code:ee?.code},productId:F?.productId,reason:"Physical Count Adjustment",notes:F?.notes||"Physical inventory adjustment",quantity:F?.variance,unitCost:ue}},M=R().filter(F=>F.physicalCount!==null&&F.variance!==0).map(D);let he="ADJ_"+Ws();const z=new Date().toISOString(),pe={ssg_inventory_key:Ws(),invoiceId:he,referenceNumber:Ws(),movementType:"adjustment",type:"adjustment",locationId:u(),items:M,products:M,generalNotes:"Physical inventory adjustment",description:"Physical Count Adjustment",invoice:he,store:u(),createdBy:"admin",createDate:z};console.log("Saving inventory bulkRequest:",pe);const x=await jn.addInventory(pe);O&&M.length>0&&A(),console.log("Saving inventory adjustments:",M),await new Promise(F=>setTimeout(F,1e3)),t.onClose()}catch(D){console.error("Failed to save inventory adjustments:",D)}finally{c(!1)}},se=qe(()=>u()==="all"?"All Locations":de().find(D=>D.id===u())?.name||"Unknown Location"),W=()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),k=async()=>{await Re.fecthInventory("prod"),await K()};Qr(async()=>{t.selectedLocationId&&h(t.selectedLocationId),k()});const H=()=>{const O=window.open("","_blank");if(!O){alert("Please allow pop-ups to print the counting sheet");return}const D=V();O.document.write(D),O.document.close(),O.onload=()=>{O.print(),O.onafterprint=()=>{O.close()}}},V=()=>{const O=J().map((D,M)=>{const he=re(D.id,u()!=="all"?u():void 0);return`
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${M+1}</td>
          <td style="border: 1px solid #000; padding: 8px; font-family: monospace;">${D.sku}</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 500;">${D.name}</div>
            ${D.UPC?`<div style="font-size: 0.8em; color: #666;">UPC: ${D.UPC}</div>`:""}
          </td>
          <td style="border: 1px solid #000; padding: 8px;">${D.category}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${D.unitOfMeasure}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">${he}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; background-color: #f9f9f9;">________</td>
          <td style="border: 1px solid #000; padding: 8px;">_______________</td>
        </tr>
      `}).join("");return`
      <!DOCTYPE html>
      <html>
      <head>
        <title> ${se()}_${f()}_${e("inventory.countingSheet","Inventory Counting Sheet")} - ${W()}</title>
        <style>
          @page {
            size: letter;
            margin: 0.5in;
          }
          body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            margin: 0;
            padding: 0;
          }
          h1 {
            text-align: center;
            margin: 0 0 10px 0;
            font-size: 24px;
          }
          .header-info {
            text-align: center;
            margin-bottom: 20px;
          }
          .instructions {
            background-color: #f0f0f0;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
          }
          th {
            background-color: #333;
            color: white;
            padding: 8px;
            text-align: left;
            font-weight: bold;
            border: 1px solid #000;
          }
          .summary-table {
            width: 50%;
            margin: 20px auto;
          }
          .signature-section {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
          }
          .signature-box {
            width: 45%;
            text-align: center;
          }
          .signature-line {
            border-bottom: 1px solid #000;
            margin-bottom: 5px;
            height: 30px;
          }
          @media print {
            tr { page-break-inside: avoid; }
          }
        </style>
      </head>
      <body>
        <h1>${e("inventory.inventoryCountingSheetTitle","INVENTORY COUNTING SHEET")}</h1>
        <div class="header-info">
          <p><strong>${e("inventory.location","Location")}:</strong> ${se()}</p>
          <p><strong>${e("common.category","Category")}:</strong> ${f()==="all"?e("inventory.allCategories","All Categories"):f()}</p>
          <p><strong>${e("common.date","Date")}:</strong> ${W()}</p>
          <p style="margin-top: 10px;">
            <span style="margin-right: 30px;">${e("inventory.countedBy","Counted by")}: _________________________</span>
            <span>${e("inventory.verifiedBy","Verified by")}: _________________________</span>
          </p>
        </div>

        <table>
          <thead>
            <tr>
              <th style="width: 5%; text-align: center;">#</th>
              <th style="width: 12%;">${e("inventory.sku","SKU")}</th>
              <th style="width: 25%;">${e("inventory.productName","Product Name")}</th>
              <th style="width: 12%;">${e("common.category","Category")}</th>
              <th style="width: 8%; text-align: center;">${e("inventory.unit","Unit")}</th>
              <th style="width: 10%; text-align: center;">${e("inventory.systemQty","System Qty")}</th>
              <th style="width: 12%; text-align: center; background-color: #f0f0f0;">${e("inventory.physicalCount","Physical Count")}</th>
              <th style="width: 16%;">${e("common.notes","Notes")}</th>
            </tr>
          </thead>
          <tbody>
            ${O}
          </tbody>
        </table>
        
        <table class="summary-table">
          <tr>
            <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
              ${e("inventory.totalProductsListed","Total Products Listed")}:
            </td>
            <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">
              ${J().length}
            </td>
          </tr>
          <tr>
            <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
              ${e("inventory.itemsCounted","Items Counted")}:
            </td>
            <td style="border: 1px solid #000; padding: 8px; text-align: center;">
              ___________
            </td>
          </tr>
          <tr>
            <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
              ${e("inventory.discrepanciesFound","Discrepancies Found")}:
            </td>
            <td style="border: 1px solid #000; padding: 8px; text-align: center;">
              ___________
            </td>
          </tr>
        </table>
        
        <div class="signature-section">
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.counterSignature","Counter Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.supervisorSignature","Supervisor Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
        </div>
      </body>
      </html>
    `};return _(Le,{get when(){return t.isOpen},get children(){var O=SI(),D=O.firstChild,M=D.firstChild,he=M.firstChild;he.firstChild;var z=he.nextSibling;return O.style.setProperty("position","fixed"),O.style.setProperty("top","0"),O.style.setProperty("left","0"),O.style.setProperty("right","0"),O.style.setProperty("bottom","0"),O.style.setProperty("background","rgba(0, 0, 0, 0.5)"),O.style.setProperty("z-index","1000"),O.style.setProperty("display","flex"),O.style.setProperty("align-items","center"),O.style.setProperty("justify-content","center"),D.style.setProperty("background","white"),D.style.setProperty("border-radius","var(--border-radius)"),D.style.setProperty("padding","2rem"),D.style.setProperty("width","95%"),D.style.setProperty("height","95%"),D.style.setProperty("max-width","1400px"),D.style.setProperty("overflow-y","auto"),D.style.setProperty("position","relative"),M.style.setProperty("display","flex"),M.style.setProperty("justify-content","space-between"),M.style.setProperty("align-items","center"),M.style.setProperty("margin-bottom","2rem"),M.style.setProperty("border-bottom","1px solid var(--border-color)"),M.style.setProperty("padding-bottom","1rem"),he.style.setProperty("margin","0"),he.style.setProperty("font-size","1.5rem"),s(he,()=>e("inventory.physicalInventoryCount","Physical Inventory Count"),null),Ai(z,"click",t.onClose,!0),z.style.setProperty("background","none"),z.style.setProperty("border","none"),z.style.setProperty("font-size","1.5rem"),z.style.setProperty("cursor","pointer"),z.style.setProperty("padding","0.5rem"),s(D,_(Le,{get when(){return E()==="setup"},get children(){var pe=gI(),x=pe.firstChild,F=x.nextSibling,ee=F.nextSibling,Q=ee.nextSibling,ue=Q.firstChild,te=ue.firstChild,B=te.firstChild,ae=te.nextSibling,ve=ae.firstChild,be=ue.nextSibling,oe=be.firstChild,ce=oe.firstChild,Y=oe.nextSibling,q=Y.firstChild,N=be.nextSibling,ne=N.firstChild,fe=ne.firstChild,U=ne.nextSibling,j=U.firstChild,Se=j.nextSibling,we=Se.nextSibling;return pe.style.setProperty("text-align","center"),pe.style.setProperty("padding","2rem"),pe.style.setProperty("max-width","600px"),pe.style.setProperty("margin","0 auto"),x.style.setProperty("font-size","3rem"),x.style.setProperty("margin-bottom","1rem"),F.style.setProperty("margin-bottom","1rem"),s(F,()=>e("inventory.setupPhysicalCount","Setup Physical Inventory Count")),ee.style.setProperty("margin-bottom","2rem"),ee.style.setProperty("color","var(--text-muted)"),s(ee,()=>e("inventory.setupDescription","Configure your physical inventory count settings and begin the counting process.")),Q.style.setProperty("display","grid"),Q.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),Q.style.setProperty("gap","1rem"),Q.style.setProperty("margin-bottom","2rem"),Q.style.setProperty("padding","1rem"),Q.style.setProperty("background","var(--surface-color)"),Q.style.setProperty("border-radius","var(--border-radius)"),Q.style.setProperty("text-align","left"),te.style.setProperty("display","block"),te.style.setProperty("margin-bottom","0.5rem"),te.style.setProperty("font-weight","500"),s(te,()=>e("inventory.location","Location"),B),ae.addEventListener("change",le=>h(le.target.value)),ae.style.setProperty("width","100%"),ae.style.setProperty("padding","0.5rem"),ae.style.setProperty("border","1px solid var(--border-color)"),ae.style.setProperty("border-radius","var(--border-radius-sm)"),s(ve,()=>e("inventory.allLocations","All Locations")),s(ae,_(xt,{get each(){return de()},children:le=>(()=>{var ye=Gh();return s(ye,()=>le.name),ie(()=>ye.value=le.id),ye})()}),null),oe.style.setProperty("display","block"),oe.style.setProperty("margin-bottom","0.5rem"),oe.style.setProperty("font-weight","500"),s(oe,()=>e("inventory.category","Category"),ce),Y.addEventListener("change",le=>g(le.target.value)),Y.style.setProperty("width","100%"),Y.style.setProperty("padding","0.5rem"),Y.style.setProperty("border","1px solid var(--border-color)"),Y.style.setProperty("border-radius","var(--border-radius-sm)"),s(q,()=>e("products.allCategories","All Categories")),s(Y,_(xt,{get each(){return Z()},children:le=>(()=>{var ye=Gh();return ye.value=le,s(ye,le),ye})()}),null),ne.style.setProperty("display","block"),ne.style.setProperty("margin-bottom","0.5rem"),ne.style.setProperty("font-weight","500"),s(ne,()=>e("inventory.sortBy","Sort By"),fe),U.addEventListener("change",le=>C(le.target.value)),U.style.setProperty("width","100%"),U.style.setProperty("padding","0.5rem"),U.style.setProperty("border","1px solid var(--border-color)"),U.style.setProperty("border-radius","var(--border-radius-sm)"),s(j,()=>e("inventory.productName","Product Name")),s(Se,()=>e("inventory.sku","SKU")),s(we,()=>e("inventory.category","Category")),s(pe,_(Le,{get when(){return!i()},get fallback(){return(()=>{var le=PI(),ye=le.firstChild;return le.style.setProperty("padding","2rem"),s(le,()=>e("common.loading","Loading"),ye),le})()},get children(){return[(()=>{var le=fI(),ye=le.firstChild;return ye.firstChild,le.style.setProperty("padding","1rem"),le.style.setProperty("background","#fff3cd"),le.style.setProperty("border-radius","var(--border-radius-sm)"),le.style.setProperty("margin-bottom","2rem"),ye.style.setProperty("margin","0"),ye.style.setProperty("color","#856404"),s(ye,()=>e("inventory.countWillInclude","This count will include {{count}} products from {{location}} in {{category}} category.",{count:J().length,location:se(),category:f()==="all"?e("inventory.allCategories","all categories"):f()}),null),le})(),(()=>{var le=yI();return le.style.setProperty("display","grid"),le.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),le.style.setProperty("gap","1rem"),le.style.setProperty("margin-bottom","2rem"),le.style.setProperty("padding","1rem"),le.style.setProperty("background","var(--surface-color)"),le.style.setProperty("border-radius","var(--border-radius)"),s(le,_(Le,{get when(){return Et.hasPermission("physicalInventoryCountingForm")},get children(){return _(De,{variant:"primary",size:"large",onClick:I,get disabled(){return i()||J().length===0},get children(){return["🚀 ",me(()=>e("inventory.startCounting","Start Physical Count"))]}})}}),null),s(le,_(De,{variant:"primary",onClick:H,get disabled(){return i()},get children(){return["🖨️ ",me(()=>e("common.print","Print"))]}}),null),le})()]}}),null),ie(()=>ae.value=u()),ie(()=>Y.value=f()),ie(()=>U.value=b()),pe}}),null),s(D,_(Le,{get when(){return E()==="counting"},get children(){var pe=pI(),x=pe.firstChild,F=x.firstChild,ee=F.firstChild,Q=ee.nextSibling,ue=F.nextSibling,te=ue.firstChild,B=te.nextSibling,ae=ue.nextSibling,ve=ae.firstChild,be=ve.nextSibling,oe=ae.nextSibling,ce=oe.firstChild,Y=ce.firstChild,q=ce.nextSibling,N=x.nextSibling,ne=N.nextSibling,fe=ne.firstChild,U=fe.firstChild,j=U.firstChild,Se=j.firstChild,we=Se.nextSibling,le=we.nextSibling,ye=le.nextSibling,X=ye.nextSibling,Pe=X.nextSibling,ke=U.nextSibling;return x.style.setProperty("display","grid"),x.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),x.style.setProperty("gap","1rem"),x.style.setProperty("margin-bottom","2rem"),x.style.setProperty("padding","1rem"),x.style.setProperty("background","var(--surface-color)"),x.style.setProperty("border-radius","var(--border-radius)"),F.style.setProperty("text-align","center"),ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","700"),ee.style.setProperty("color","var(--primary-color)"),s(ee,()=>w().countedProducts),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),s(Q,()=>e("inventory.counted","Counted")),ue.style.setProperty("text-align","center"),te.style.setProperty("font-size","1.5rem"),te.style.setProperty("font-weight","700"),te.style.setProperty("color","#ff9800"),s(te,()=>w().remainingProducts),B.style.setProperty("font-size","0.875rem"),B.style.setProperty("color","var(--text-muted)"),s(B,()=>e("inventory.remaining","Remaining")),ae.style.setProperty("text-align","center"),ve.style.setProperty("font-size","1.5rem"),ve.style.setProperty("font-weight","700"),ve.style.setProperty("color","#f44336"),s(ve,()=>w().variances),be.style.setProperty("font-size","0.875rem"),be.style.setProperty("color","var(--text-muted)"),s(be,()=>e("inventory.variances","Variances")),oe.style.setProperty("text-align","center"),ce.style.setProperty("font-size","1.5rem"),ce.style.setProperty("font-weight","700"),s(ce,()=>Math.round(w().countedProducts/w().totalProducts*100),Y),q.style.setProperty("font-size","0.875rem"),q.style.setProperty("color","var(--text-muted)"),s(q,()=>e("inventory.complete","Complete")),N.style.setProperty("display","flex"),N.style.setProperty("gap","1rem"),N.style.setProperty("margin-bottom","2rem"),N.style.setProperty("justify-content","center"),s(N,_(De,{variant:"outline",onClick:()=>$("setup"),get children(){return["⬅️ ",me(()=>e("common.back","Back to Setup"))]}}),null),s(N,_(De,{variant:"primary",onClick:()=>$("review"),get children(){return["📋 ",me(()=>e("inventory.reviewAdjustments","Review Adjustments"))]}}),null),ne.style.setProperty("border","1px solid var(--border-color)"),ne.style.setProperty("border-radius","var(--border-radius)"),ne.style.setProperty("overflow-x","auto"),fe.style.setProperty("width","100%"),fe.style.setProperty("border-collapse","collapse"),j.style.setProperty("background","var(--surface-color)"),Se.style.setProperty("padding","1rem"),Se.style.setProperty("text-align","left"),Se.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Se,()=>e("inventory.no","No")),we.style.setProperty("padding","1rem"),we.style.setProperty("text-align","left"),we.style.setProperty("border-bottom","1px solid var(--border-color)"),s(we,()=>e("inventory.product","Product")),le.style.setProperty("padding","1rem"),le.style.setProperty("text-align","center"),le.style.setProperty("border-bottom","1px solid var(--border-color)"),s(le,()=>e("inventory.systemQty","System Qty")),ye.style.setProperty("padding","1rem"),ye.style.setProperty("text-align","center"),ye.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ye,()=>e("inventory.physicalCount","Physical Count")),X.style.setProperty("padding","1rem"),X.style.setProperty("text-align","center"),X.style.setProperty("border-bottom","1px solid var(--border-color)"),s(X,()=>e("inventory.variance","Variance")),Pe.style.setProperty("padding","1rem"),Pe.style.setProperty("text-align","left"),Pe.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Pe,()=>e("common.notes","Notes")),s(ke,_(xt,{get each(){return R()},children:(Te,$e)=>_(II,{get index(){return $e()},updatePhysicalCount:S,entry:Te,updateNotes:v})})),ie(Te=>(Te=w().isComplete?"#4caf50":"#ff9800")!=null?ce.style.setProperty("color",Te):ce.style.removeProperty("color")),pe}}),null),s(D,_(Le,{get when(){return E()==="review"},get children(){var pe=_I(),x=pe.firstChild,F=x.firstChild;F.firstChild;var ee=F.nextSibling,Q=x.nextSibling,ue=Q.firstChild,te=ue.firstChild,B=te.nextSibling,ae=ue.nextSibling,ve=ae.firstChild,be=ve.nextSibling,oe=ae.nextSibling,ce=oe.firstChild,Y=ce.nextSibling,q=Q.nextSibling;return x.style.setProperty("text-align","center"),x.style.setProperty("margin-bottom","2rem"),F.style.setProperty("margin-bottom","1rem"),s(F,()=>e("inventory.reviewAndConfirm","Review and Confirm Adjustments"),null),ee.style.setProperty("color","var(--text-muted)"),s(ee,()=>e("inventory.reviewDescription","Review the inventory adjustments below and confirm to update your system.")),Q.style.setProperty("display","grid"),Q.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),Q.style.setProperty("gap","1rem"),Q.style.setProperty("margin-bottom","2rem"),Q.style.setProperty("padding","1rem"),Q.style.setProperty("background","var(--surface-color)"),Q.style.setProperty("border-radius","var(--border-radius)"),ue.style.setProperty("text-align","center"),te.style.setProperty("font-size","1.5rem"),te.style.setProperty("font-weight","700"),te.style.setProperty("color","#4caf50"),s(te,()=>w().positiveVariances),B.style.setProperty("font-size","0.875rem"),B.style.setProperty("color","var(--text-muted)"),s(B,()=>e("inventory.stockIncreases","Stock Increases")),ae.style.setProperty("text-align","center"),ve.style.setProperty("font-size","1.5rem"),ve.style.setProperty("font-weight","700"),ve.style.setProperty("color","#f44336"),s(ve,()=>w().negativeVariances),be.style.setProperty("font-size","0.875rem"),be.style.setProperty("color","var(--text-muted)"),s(be,()=>e("inventory.stockDecreases","Stock Decreases")),oe.style.setProperty("text-align","center"),ce.style.setProperty("font-size","1.5rem"),ce.style.setProperty("font-weight","700"),ce.style.setProperty("color","var(--primary-color)"),s(ce,()=>w().variances),Y.style.setProperty("font-size","0.875rem"),Y.style.setProperty("color","var(--text-muted)"),s(Y,()=>e("inventory.totalAdjustments","Total Adjustments")),q.style.setProperty("display","flex"),q.style.setProperty("gap","1rem"),q.style.setProperty("margin-bottom","2rem"),q.style.setProperty("justify-content","center"),q.style.setProperty("flex-wrap","wrap"),s(q,_(De,{variant:"outline",onClick:()=>$("counting"),get children(){return["⬅️ ",me(()=>e("common.back","Back to Counting"))]}}),null),s(q,_(De,{variant:"outline",onClick:A,get disabled(){return w().variances===0},get children(){return["📥 ",me(()=>e("inventory.downloadCSV","Download CSV"))]}}),null),s(q,_(De,{variant:"primary",onClick:y,get disabled(){return a()||w().variances===0},get children(){return me(()=>!!a())()?"💾 "+e("common.saving","Saving")+"...":"✅ "+e("inventory.confirmAdjustments","Confirm Adjustments")}}),null),s(pe,_(Le,{get when(){return w().variances>0},get children(){var N=vI(),ne=N.firstChild,fe=ne.firstChild,U=fe.firstChild,j=U.firstChild,Se=j.nextSibling,we=Se.nextSibling,le=we.nextSibling,ye=le.nextSibling,X=fe.nextSibling;return N.style.setProperty("border","1px solid var(--border-color)"),N.style.setProperty("border-radius","var(--border-radius)"),N.style.setProperty("overflow-x","auto"),ne.style.setProperty("width","100%"),ne.style.setProperty("border-collapse","collapse"),U.style.setProperty("background","var(--surface-color)"),j.style.setProperty("padding","1rem"),j.style.setProperty("text-align","left"),j.style.setProperty("border-bottom","1px solid var(--border-color)"),s(j,()=>e("inventory.product","Product")),Se.style.setProperty("padding","1rem"),Se.style.setProperty("text-align","center"),Se.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Se,()=>e("inventory.systemQty","System Qty")),we.style.setProperty("padding","1rem"),we.style.setProperty("text-align","center"),we.style.setProperty("border-bottom","1px solid var(--border-color)"),s(we,()=>e("inventory.physicalCount","Physical Count")),le.style.setProperty("padding","1rem"),le.style.setProperty("text-align","center"),le.style.setProperty("border-bottom","1px solid var(--border-color)"),s(le,()=>e("inventory.adjustment","Adjustment")),ye.style.setProperty("padding","1rem"),ye.style.setProperty("text-align","left"),ye.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ye,()=>e("common.notes","Notes")),s(X,_(xt,{get each(){return R().filter(Pe=>Pe.variance!==0)},children:Pe=>(()=>{var ke=wI(),Te=ke.firstChild,$e=Te.firstChild,Ue=$e.nextSibling,Ye=Ue.firstChild,ze=Te.nextSibling,Ee=ze.firstChild,Me=ze.nextSibling,Ke=Me.firstChild,Ge=Me.nextSibling,He=Ge.firstChild,Ae=Ge.nextSibling,st=Ae.firstChild;return ke.style.setProperty("border-bottom","1px solid var(--border-color)"),Te.style.setProperty("padding","1rem"),$e.style.setProperty("font-weight","500"),s($e,()=>Pe.product.name),Ue.style.setProperty("font-size","0.875rem"),Ue.style.setProperty("color","var(--text-muted)"),s(Ue,()=>Pe.product.sku,Ye),s(Ue,()=>Pe.product.category,null),ze.style.setProperty("padding","1rem"),ze.style.setProperty("text-align","center"),Ee.style.setProperty("font-weight","600"),s(Ee,()=>Pe.systemQuantity),Me.style.setProperty("padding","1rem"),Me.style.setProperty("text-align","center"),Ke.style.setProperty("font-weight","600"),s(Ke,()=>Pe.physicalCount),Ge.style.setProperty("padding","1rem"),Ge.style.setProperty("text-align","center"),He.style.setProperty("font-weight","700"),s(He,()=>Pe.variance>0?"+":"",null),s(He,()=>Pe.variance,null),Ae.style.setProperty("padding","1rem"),st.style.setProperty("font-size","0.875rem"),s(st,()=>Pe.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")),ie(Xe=>{var gt=Pe.variance>0?"#d4edda":"#f8d7da",dt=Pe.variance>0?"#4caf50":"#f44336";return gt!==Xe.e&&((Xe.e=gt)!=null?ke.style.setProperty("background",gt):ke.style.removeProperty("background")),dt!==Xe.t&&((Xe.t=dt)!=null?He.style.setProperty("color",dt):He.style.removeProperty("color")),Xe},{e:void 0,t:void 0}),ke})()})),N}}),null),s(pe,_(Le,{get when(){return w().variances===0},get children(){var N=bI(),ne=N.firstChild,fe=ne.nextSibling,U=fe.nextSibling;return N.style.setProperty("text-align","center"),N.style.setProperty("padding","3rem"),N.style.setProperty("background","var(--surface-color)"),N.style.setProperty("border-radius","var(--border-radius)"),ne.style.setProperty("font-size","3rem"),ne.style.setProperty("margin-bottom","1rem"),fe.style.setProperty("margin-bottom","0.5rem"),s(fe,()=>e("inventory.perfectCount","Perfect Count!")),U.style.setProperty("color","var(--text-muted)"),s(U,()=>e("inventory.noVariances","No variances found. Your physical count matches the system exactly.")),N}}),null),pe}}),null),O}})},II=t=>{const{t:e}=ot(),[r,n]=ge(""),[i,o]=ge("");let{entry:a,updatePhysicalCount:c,updateNotes:u,index:h}=t;Qr(()=>{o(a?.notes),n(a?.physicalCount)});const f=()=>{let g=document.getElementById(`physicalCountInput_${h+2}`);qp(r())&&g&&(g.focus(),c(a?.productId,r()===""?null:parseFloat(r())))};return(()=>{var g=CI(),b=g.firstChild,C=b.firstChild,R=b.nextSibling,T=R.firstChild,E=T.nextSibling,$=E.firstChild,K=$.nextSibling;K.nextSibling;var Z=R.nextSibling,J=Z.firstChild,de=Z.nextSibling,re=de.firstChild,I=de.nextSibling,S=I.firstChild,v=I.nextSibling,w=v.firstChild;return g.style.setProperty("border-bottom","1px solid var(--border-color)"),b.style.setProperty("padding","1rem"),b.style.setProperty("text-align","center"),C.style.setProperty("font-weight","600"),s(C,h+1),R.style.setProperty("padding","1rem"),T.style.setProperty("font-weight","500"),s(T,()=>a?.product.name),E.style.setProperty("font-size","0.875rem"),E.style.setProperty("color","var(--text-muted)"),s(E,()=>a?.product.sku,$),s(E,()=>a?.product.category,K),s(E,()=>a?.product.unitOfMeasure,null),Z.style.setProperty("padding","1rem"),Z.style.setProperty("text-align","center"),J.style.setProperty("font-weight","600"),s(J,()=>a?.systemQuantity),de.style.setProperty("padding","1rem"),de.style.setProperty("text-align","center"),re.addEventListener("blur",()=>{f()}),re.$$keydown=P=>{P.keyCode===13&&f(),P.keyCode===27&&f(),P.keyCode===9&&f()},re.$$input=P=>{const A=P.target.value;n(A)},lt(re,"id",`physicalCountInput_${h+1}`),lt(re,"tabindex",h),re.style.setProperty("width","100px"),re.style.setProperty("padding","0.5rem"),re.style.setProperty("border","1px solid var(--border-color)"),re.style.setProperty("border-radius","var(--border-radius-sm)"),re.style.setProperty("text-align","center"),I.style.setProperty("padding","1rem"),I.style.setProperty("text-align","center"),S.style.setProperty("font-weight","600"),s(S,()=>a?.variance>0?"+":"",null),s(S,()=>a?.variance||"—",null),v.style.setProperty("padding","1rem"),w.addEventListener("blur",P=>{u(a?.productId,i())}),w.$$keydown=P=>{P.keyCode===13&&u(a?.productId,i()),P.keyCode===27&&u(a?.productId,i()),P.keyCode===9&&u(a?.productId,i())},w.$$input=P=>{const A=P.target.value;o(A)},w.style.setProperty("width","200px"),w.style.setProperty("padding","0.5rem"),w.style.setProperty("border","1px solid var(--border-color)"),w.style.setProperty("border-radius","var(--border-radius-sm)"),ie(P=>{var A=a?.physicalCount!==null?a?.variance!==0?"#fff3cd":"#d4edda":"transparent",y=a?.variance>0?"#4caf50":a?.variance<0?"#f44336":"var(--text-muted)",se=e("inventory.addNotes","Add notes...");return A!==P.e&&((P.e=A)!=null?g.style.setProperty("background",A):g.style.removeProperty("background")),y!==P.t&&((P.t=y)!=null?S.style.setProperty("color",y):S.style.removeProperty("color")),se!==P.a&&lt(w,"placeholder",P.a=se),P},{e:void 0,t:void 0,a:void 0}),ie(()=>re.value=r()||""),ie(()=>w.value=i()||""),g})()};_t(["click","input","keydown"]);function EI(t,e=300,r=!1){let n,i;const o=()=>{n!==void 0&&(clearTimeout(n),n=void 0),i=void 0},a=()=>{n!==void 0&&i!==void 0&&(clearTimeout(n),n=void 0,t(...i),i=void 0)},c=(...u)=>{i=u,n!==void 0&&clearTimeout(n),r&&n===void 0&&t(...u),n=window.setTimeout(()=>{r||t(...u),n=void 0,i=void 0},e)};return oo(()=>{o()}),{debounced:c,cancel:o,flush:a}}function xI(t,e=300){const[r,n]=ge(!1);let i;const o=async h=>{if(i&&i.abort(),!h.trim()){n(!1);return}i=new AbortController,n(!0);try{await t(h)}catch(f){f instanceof Error&&f.name!=="AbortError"&&console.error("Search error:",f)}finally{i.signal.aborted||n(!1)}},{debounced:a,cancel:c}=EI(o,e,!1),u=()=>{c(),i&&i.abort(),n(!1)};return oo(()=>{u()}),{search:a,isSearching:r,cancel:u}}var Wh=G("<div>"),TI=G("<div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),$I=G("<div><h3></h3><div><div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><div><span></span><span></span></div><div><span></span><span>%"),kI=G("<div><h4>"),RI=G("<div><h3></h3><div><div><div><span></span><span> </span></div><div><span></span><span> </span></div></div><div><div><span></span><span> </span></div><div><span></span><span>"),DI=G("<div><h3></h3><div><span></span><span></span></div><div><span></span><span>"),Yh=G("<div><h3>"),NI=G("<div><div><div><h2></h2><div>SKU: <!> • </div></div><div></div></div><div><button></button><button></button><button></button></div><div>"),LI=G("<span>✓ "),MI=G("<span>✗ "),OI=G("<div><div><span><span> • </span></span><span> </span></div><div>: <!> • <!>: "),VI=G("<div>📦 "),BI=G("<div>Ref: "),FI=G("<div><div><div><span></span><span></span><span></span></div><div><span></span></div></div><div><div> </div><div>"),UI=G("<div><h4></h4><div></div><div>"),jI=G("<div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div> <!> × </div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div>Min: <!> • Max: ");const zI=t=>{const{t:e}=ot(),[r,n]=ge("details"),i=qe(()=>{if(!t.product)return null;const v=Re.getTotalStockByProduct(t.product.id),w=Re.getStockByProduct(t.product.id),P=v<=t.product.minStockLevel,A=v===0,y=v>=t.product.maxStockLevel;return{total:v,byLocation:w,status:A?"out":P?"low":y?"over":"good",statusText:A?e("products.outOfStock","Out of Stock"):P?e("products.lowStock","Low Stock"):y?e("products.overStock","Over Stock"):e("products.inStock","In Stock")}}),o=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(v),a=v=>new Date(v).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),c=qe(()=>!t.product||t.product.unitCost===0?0:((t.product.sellingPrice-t.product.unitCost)/t.product.unitCost*100).toFixed(2)),u=qe(()=>t.product?Re.movements.filter(v=>v.productId===t.product.id).sort((v,w)=>new Date(w.createdDate).getTime()-new Date(v.createdDate).getTime()):[]),h=qe(()=>{if(!t.product)return null;const v=u(),w=i(),P=new Date;P.setDate(P.getDate()-30);const A=v.filter(se=>new Date(se.createdDate)>=P),y=v.reduce((se,W)=>{const k=W.productId===t.product.id?W:null;return se+(k?k.quantity*k.unitCost:0)},0);return{recentMovements:v.length,movements30Days:A.length,totalValue:(w?.total||0)*t.product.unitCost,averageMovementValue:v.length>0?y/v.length:0,lastMovementDate:v.length>0?v[0].createdDate:null}}),f={"margin-bottom":"2rem"},g={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},b={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},C={"font-weight":"400",color:"var(--text-primary)","font-size":"1rem"},R=v=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[v]||"📋";function T(v){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[v]||{bg:"#f5f5f5",color:"#666"}}const E=v=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:T(v).bg,color:T(v).color}),$=v=>{const w={good:{background:"#d4edda",color:"#155724"},low:{background:"#fff3cd",color:"#856404"},out:{background:"#f8d7da",color:"#721c24"},over:{background:"#cce5ff",color:"#004085"}};return{display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500",...w[v]||w.good}},K={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"},Z={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-bottom":"0.75rem"},J={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem","padding-bottom":"1rem","border-bottom":"2px solid var(--border-color)"},de={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},re=v=>({padding:"0.75rem 1.5rem",background:"none",border:"none","border-bottom":v?"2px solid var(--primary-color)":"2px solid transparent",color:v?"var(--primary-color)":"var(--text-muted)","font-weight":v?"600":"400",cursor:"pointer",transition:"all 0.2s","font-size":"0.875rem"}),I={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-bottom":"0.5rem"},S={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1.5rem","margin-bottom":"1rem"};return _(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("products.productDetails","Product Details")},size:"large",get children(){return _(Le,{get when(){return t.product},get fallback(){return(()=>{var v=Wh();return v.style.setProperty("text-align","center"),v.style.setProperty("padding","2rem"),v.style.setProperty("color","var(--text-muted)"),s(v,()=>e("products.noProductSelected","No product selected")),v})()},children:v=>(()=>{var w=NI(),P=w.firstChild,A=P.firstChild,y=A.firstChild,se=y.nextSibling,W=se.firstChild,k=W.nextSibling;k.nextSibling;var H=A.nextSibling,V=P.nextSibling,O=V.firstChild,D=O.nextSibling,M=D.nextSibling,he=V.nextSibling;return s(w,()=>JSON.stringify(v),P),d(P,J),y.style.setProperty("margin","0"),y.style.setProperty("font-size","1.5rem"),y.style.setProperty("margin-bottom","0.25rem"),s(y,()=>v().name),se.style.setProperty("color","var(--text-muted)"),s(se,()=>v().sku,k),s(se,()=>v().category,null),s(H,()=>i()?.statusText),d(V,de),O.$$click=()=>n("details"),s(O,()=>e("products.details","Details")),D.$$click=()=>n("movements"),s(D,()=>e("products.movements","Movements")),M.$$click=()=>n("analytics"),s(M,()=>e("products.analytics","Analytics")),s(w,_(Le,{get when(){return r()==="details"},get children(){return[(()=>{var z=TI(),pe=z.firstChild,x=pe.nextSibling,F=x.firstChild,ee=F.nextSibling,Q=x.nextSibling,ue=Q.firstChild,te=ue.nextSibling,B=Q.nextSibling,ae=B.firstChild,ve=ae.nextSibling;return pe.style.setProperty("margin-bottom","1rem"),pe.style.setProperty("font-size","1.1rem"),s(pe,()=>e("products.basicInformation","Basic Information")),s(F,()=>e("products.description","Description")),s(ee,()=>v().description||e("common.notAvailable","N/A")),s(ue,()=>e("products.unitOfMeasure","Unit of Measure")),s(te,()=>v().unitOfMeasure),s(ae,()=>e("products.status","Status")),s(ve,(()=>{var be=me(()=>!!v().isActive);return()=>be()?(()=>{var oe=LI();return oe.firstChild,oe.style.setProperty("color","#2e7d32"),s(oe,()=>e("common.active","Active"),null),oe})():(()=>{var oe=MI();return oe.firstChild,oe.style.setProperty("color","#d32f2f"),s(oe,()=>e("common.inactive","Inactive"),null),oe})()})()),ie(be=>{var oe=f,ce=g,Y=b,q=C,N=g,ne=b,fe=C,U=g,j=b,Se=C;return be.e=d(z,oe,be.e),be.t=d(x,ce,be.t),be.a=d(F,Y,be.a),be.o=d(ee,q,be.o),be.i=d(Q,N,be.i),be.n=d(ue,ne,be.n),be.s=d(te,fe,be.s),be.h=d(B,U,be.h),be.r=d(ae,j,be.r),be.d=d(ve,Se,be.d),be},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),z})(),(()=>{var z=$I(),pe=z.firstChild,x=pe.nextSibling,F=x.firstChild,ee=F.firstChild,Q=ee.firstChild,ue=Q.nextSibling,te=ee.nextSibling,B=te.firstChild,ae=B.nextSibling,ve=F.nextSibling,be=ve.firstChild,oe=be.firstChild,ce=oe.nextSibling,Y=be.nextSibling,q=Y.firstChild,N=q.nextSibling,ne=N.firstChild;return pe.style.setProperty("margin-bottom","1rem"),pe.style.setProperty("font-size","1.1rem"),s(pe,()=>e("products.pricingInformation","Pricing Information")),s(Q,()=>e("products.unitCost","Unit Cost")),s(ue,()=>o(v().unitCost)),s(B,()=>e("products.sellingPrice","Selling Price")),s(ae,()=>o(v().sellingPrice)),s(oe,()=>e("products.profit","Profit")),s(ce,()=>o(v().sellingPrice-v().unitCost)),s(q,()=>e("products.profitMargin","Profit Margin")),s(N,c,ne),ie(fe=>{var U=f,j=K,Se=g,we=b,le=C,ye=g,X=b,Pe=C,ke=g,Te=b,$e=C,Ue=g,Ye=b,ze=C;return fe.e=d(z,U,fe.e),fe.t=d(x,j,fe.t),fe.a=d(ee,Se,fe.a),fe.o=d(Q,we,fe.o),fe.i=d(ue,le,fe.i),fe.n=d(te,ye,fe.n),fe.s=d(B,X,fe.s),fe.h=d(ae,Pe,fe.h),fe.r=d(be,ke,fe.r),fe.d=d(oe,Te,fe.d),fe.l=d(ce,$e,fe.l),fe.u=d(Y,Ue,fe.u),fe.c=d(q,Ye,fe.c),fe.w=d(N,ze,fe.w),fe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),z})(),(()=>{var z=RI(),pe=z.firstChild,x=pe.nextSibling,F=x.firstChild,ee=F.firstChild,Q=ee.firstChild,ue=Q.nextSibling,te=ue.firstChild,B=ee.nextSibling,ae=B.firstChild,ve=ae.nextSibling,be=ve.firstChild,oe=F.nextSibling,ce=oe.firstChild,Y=ce.firstChild,q=Y.nextSibling,N=q.firstChild,ne=ce.nextSibling,fe=ne.firstChild,U=fe.nextSibling;return pe.style.setProperty("margin-bottom","1rem"),pe.style.setProperty("font-size","1.1rem"),s(pe,()=>e("products.stockInformation","Stock Information")),s(Q,()=>e("products.totalStock","Total Stock")),s(ue,()=>i()?.total||0,te),s(ue,()=>v().unitOfMeasure,null),s(ae,()=>e("products.minStockLevel","Min Stock Level")),s(ve,()=>v().minStockLevel,be),s(ve,()=>v().unitOfMeasure,null),s(Y,()=>e("products.maxStockLevel","Max Stock Level")),s(q,()=>v().maxStockLevel,N),s(q,()=>v().unitOfMeasure,null),s(fe,()=>e("products.stockValue","Stock Value")),s(U,()=>o((i()?.total||0)*v().unitCost)),s(z,_(Le,{get when(){return me(()=>!!i()?.byLocation)()&&i().byLocation.length>0},get children(){var j=kI(),Se=j.firstChild;return j.style.setProperty("margin-top","1.5rem"),Se.style.setProperty("margin-bottom","1rem"),Se.style.setProperty("font-size","1rem"),s(Se,()=>e("products.stockByLocation","Stock by Location")),s(j,()=>i().byLocation.map(we=>(()=>{var le=OI(),ye=le.firstChild,X=ye.firstChild,Pe=X.firstChild;Pe.firstChild;var ke=X.nextSibling,Te=ke.firstChild,$e=ye.nextSibling,Ue=$e.firstChild,Ye=Ue.nextSibling,ze=Ye.nextSibling,Ee=ze.nextSibling;return Ee.nextSibling,d(le,Z),ye.style.setProperty("display","flex"),ye.style.setProperty("justify-content","space-between"),ye.style.setProperty("align-items","center"),X.style.setProperty("font-weight","500"),X.style.setProperty("color","var(--primary-color)"),s(X,()=>we.locationId,Pe),Pe.style.setProperty("font-weight","500"),Pe.style.setProperty("color","var(--text-muted)"),s(Pe,()=>we.locationName,null),ke.style.setProperty("font-weight","600"),s(ke,()=>we.quantity,Te),s(ke,()=>v().unitOfMeasure,null),$e.style.setProperty("margin-top","0.5rem"),$e.style.setProperty("font-size","0.875rem"),$e.style.setProperty("color","var(--text-muted)"),s($e,()=>e("products.available","Available"),Ue),s($e,()=>we.availableQuantity,Ye),s($e,()=>e("products.reserved","Reserved"),Ee),s($e,()=>we.reservedQuantity,null),ie(Me=>(Me=we.quantity>0?"var(--primary-color)":"var(--text-muted)")!=null?ke.style.setProperty("color",Me):ke.style.removeProperty("color")),le})()),null),j}}),null),ie(j=>{var Se=f,we=K,le=g,ye=b,X=C,Pe=g,ke=b,Te=C,$e=g,Ue=b,Ye=C,ze=g,Ee=b,Me=C;return j.e=d(z,Se,j.e),j.t=d(x,we,j.t),j.a=d(ee,le,j.a),j.o=d(Q,ye,j.o),j.i=d(ue,X,j.i),j.n=d(B,Pe,j.n),j.s=d(ae,ke,j.s),j.h=d(ve,Te,j.h),j.r=d(ce,$e,j.r),j.d=d(Y,Ue,j.d),j.l=d(q,Ye,j.l),j.u=d(ne,ze,j.u),j.c=d(fe,Ee,j.c),j.w=d(U,Me,j.w),j},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),z})(),(()=>{var z=DI(),pe=z.firstChild,x=pe.nextSibling,F=x.firstChild,ee=F.nextSibling,Q=x.nextSibling,ue=Q.firstChild,te=ue.nextSibling;return pe.style.setProperty("margin-bottom","1rem"),pe.style.setProperty("font-size","1.1rem"),s(pe,()=>e("products.timestamps","Timestamps")),s(F,()=>e("common.createdDate","Created Date")),s(ee,()=>a(v().createdDate)),s(ue,()=>e("common.lastModified","Last Modified")),s(te,()=>a(v().lastModified)),ie(B=>{var ae=f,ve=g,be=b,oe=C,ce=g,Y=b,q=C;return B.e=d(z,ae,B.e),B.t=d(x,ve,B.t),B.a=d(F,be,B.a),B.o=d(ee,oe,B.o),B.i=d(Q,ce,B.i),B.n=d(ue,Y,B.n),B.s=d(te,q,B.s),B},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),z})()]}}),he),s(w,_(Le,{get when(){return r()==="movements"},get children(){var z=Yh(),pe=z.firstChild;return pe.style.setProperty("margin-bottom","1rem"),pe.style.setProperty("font-size","1.1rem"),s(pe,()=>e("products.recentMovements","Recent Movements")),s(z,_(Le,{get when(){return u().length>0},get fallback(){return(()=>{var x=VI();return x.firstChild,x.style.setProperty("text-align","center"),x.style.setProperty("padding","2rem"),x.style.setProperty("color","var(--text-muted)"),x.style.setProperty("background","var(--surface-color)"),x.style.setProperty("border-radius","var(--border-radius-sm)"),x.style.setProperty("border","1px solid var(--border-color)"),s(x,()=>e("products.noMovements","No movements found for this product"),null),x})()},get children(){return _(xt,{get each(){return u()},children:x=>{const F=x.productId===v().id?x:null;if(!F)return null;let ee=Re.getLocationById(x.locationId);return(()=>{var Q=FI(),ue=Q.firstChild,te=ue.firstChild,B=te.firstChild,ae=B.nextSibling,ve=ae.nextSibling,be=te.nextSibling,oe=be.firstChild,ce=ue.nextSibling,Y=ce.firstChild,q=Y.firstChild,N=Y.nextSibling;return d(Q,I),te.style.setProperty("font-weight","600"),te.style.setProperty("margin-bottom","0.25rem"),B.style.setProperty("font-size","1.2rem"),s(B,()=>R(x.movementType)),ae.style.setProperty("padding","0 6px"),s(ve,()=>x.movementType),be.style.setProperty("font-size","0.875rem"),be.style.setProperty("color","var(--text-muted)"),s(be,()=>` ${a(x?.createdDate)} • `,oe),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("font-weight","600"),oe.style.setProperty("color","var(--primary-color)"),s(oe,()=>x?.locationId),s(be,()=>` • ${ee?.name}`,null),s(ue,_(Le,{get when(){return x.referenceNumber},get children(){var ne=BI();return ne.firstChild,ne.style.setProperty("font-size","0.75rem"),ne.style.setProperty("color","var(--text-muted)"),ne.style.setProperty("margin-top","0.25rem"),s(ne,()=>x?.referenceNumber,null),ne}}),null),ce.style.setProperty("text-align","right"),Y.style.setProperty("font-weight","600"),Y.style.setProperty("font-size","1rem"),s(Y,()=>x?.movementType==="in"?"+":"",q),s(Y,()=>F.quantity,q),s(Y,()=>v().unitOfMeasure,null),N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),s(N,()=>o(F.unitCost)),ie(ne=>{var fe=E(x.movementType),U=x?.movementType==="in"?"#2e7d32":"#d32f2f";return ne.e=d(ve,fe,ne.e),U!==ne.t&&((ne.t=U)!=null?Y.style.setProperty("color",U):Y.style.removeProperty("color")),ne},{e:void 0,t:void 0}),Q})()}})}}),null),ie(x=>d(z,f,x)),z}}),he),s(w,_(Le,{get when(){return r()==="analytics"},get children(){var z=Yh(),pe=z.firstChild;return pe.style.setProperty("margin-bottom","1rem"),pe.style.setProperty("font-size","1.1rem"),s(pe,()=>e("products.analytics","Analytics")),s(z,_(Le,{get when(){return h()},get fallback(){return(()=>{var x=Wh();return x.style.setProperty("text-align","center"),x.style.setProperty("padding","2rem"),x.style.setProperty("color","var(--text-muted)"),s(x,()=>e("products.noAnalytics","No analytics data available")),x})()},children:x=>(()=>{var F=jI(),ee=F.firstChild,Q=ee.firstChild,ue=Q.nextSibling,te=ue.nextSibling,B=ee.nextSibling,ae=B.firstChild,ve=ae.nextSibling,be=ve.nextSibling,oe=B.nextSibling,ce=oe.firstChild,Y=ce.nextSibling,q=Y.nextSibling,N=q.firstChild,ne=N.nextSibling;ne.nextSibling;var fe=oe.nextSibling,U=fe.firstChild,j=U.nextSibling,Se=j.nextSibling,we=fe.nextSibling,le=we.firstChild,ye=le.nextSibling,X=ye.nextSibling,Pe=X.firstChild,ke=Pe.nextSibling;return ke.nextSibling,Q.style.setProperty("margin","0 0 0.5rem 0"),Q.style.setProperty("color","var(--primary-color)"),s(Q,()=>e("products.totalMovements","Total Movements")),ue.style.setProperty("font-size","1.5rem"),ue.style.setProperty("font-weight","600"),s(ue,()=>x().recentMovements),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),te.style.setProperty("margin-top","0.25rem"),s(te,()=>e("products.allTime","All time")),ae.style.setProperty("margin","0 0 0.5rem 0"),ae.style.setProperty("color","var(--primary-color)"),s(ae,()=>e("products.last30Days","Last 30 Days")),ve.style.setProperty("font-size","1.5rem"),ve.style.setProperty("font-weight","600"),s(ve,()=>x().movements30Days),be.style.setProperty("font-size","0.875rem"),be.style.setProperty("color","var(--text-muted)"),be.style.setProperty("margin-top","0.25rem"),s(be,()=>e("products.movements","movements")),ce.style.setProperty("margin","0 0 0.5rem 0"),ce.style.setProperty("color","var(--primary-color)"),s(ce,()=>e("products.currentValue","Current Stock Value")),Y.style.setProperty("font-size","1.5rem"),Y.style.setProperty("font-weight","600"),s(Y,()=>o(x().totalValue)),q.style.setProperty("font-size","0.875rem"),q.style.setProperty("color","var(--text-muted)"),q.style.setProperty("margin-top","0.25rem"),s(q,()=>i()?.total||0,N),s(q,()=>v().unitOfMeasure,ne),s(q,()=>o(v().unitCost),null),U.style.setProperty("margin","0 0 0.5rem 0"),U.style.setProperty("color","var(--primary-color)"),s(U,()=>e("products.avgMovementValue","Avg Movement Value")),j.style.setProperty("font-size","1.5rem"),j.style.setProperty("font-weight","600"),s(j,()=>o(x().averageMovementValue)),Se.style.setProperty("font-size","0.875rem"),Se.style.setProperty("color","var(--text-muted)"),Se.style.setProperty("margin-top","0.25rem"),s(Se,()=>e("products.perMovement","per movement")),s(F,_(Le,{get when(){return x().lastMovementDate},get children(){var Te=UI(),$e=Te.firstChild,Ue=$e.nextSibling,Ye=Ue.nextSibling;return $e.style.setProperty("margin","0 0 0.5rem 0"),$e.style.setProperty("color","var(--primary-color)"),s($e,()=>e("products.lastMovement","Last Movement")),Ue.style.setProperty("font-size","1.25rem"),Ue.style.setProperty("font-weight","600"),s(Ue,()=>a(x().lastMovementDate)),Ye.style.setProperty("font-size","0.875rem"),Ye.style.setProperty("color","var(--text-muted)"),Ye.style.setProperty("margin-top","0.25rem"),s(Ye,()=>e("products.mostRecent","Most recent activity")),ie(ze=>d(Te,S,ze)),Te}}),we),le.style.setProperty("margin","0 0 0.5rem 0"),le.style.setProperty("color","var(--primary-color)"),s(le,()=>e("products.stockStatus","Stock Status")),ye.style.setProperty("font-size","1.25rem"),ye.style.setProperty("font-weight","600"),s(ye,()=>i()?.statusText),X.style.setProperty("font-size","0.875rem"),X.style.setProperty("color","var(--text-muted)"),X.style.setProperty("margin-top","0.25rem"),s(X,()=>v().minStockLevel,ke),s(X,()=>v().maxStockLevel,null),ie(Te=>{var $e=K,Ue=S,Ye=S,ze=S,Ee=S,Me=S;return Te.e=d(F,$e,Te.e),Te.t=d(ee,Ue,Te.t),Te.a=d(B,Ye,Te.a),Te.o=d(oe,ze,Te.o),Te.i=d(fe,Ee,Te.i),Te.n=d(we,Me,Te.n),Te},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),F})()}),null),ie(x=>d(z,f,x)),z}}),he),he.style.setProperty("display","flex"),he.style.setProperty("gap","1rem"),he.style.setProperty("justify-content","flex-end"),he.style.setProperty("margin-top","2rem"),s(he,_(De,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close","Close")}}),null),s(he,_(Le,{get when(){return t.onEdit},get children(){return _(De,{variant:"primary",get onClick(){return t.onEdit},get children(){return e("common.edit","Edit")}})}}),null),ie(z=>{var pe=$(i()?.status||"good"),x=re(r()==="details"),F=re(r()==="movements"),ee=re(r()==="analytics");return z.e=d(H,pe,z.e),z.t=d(O,x,z.t),z.a=d(D,F,z.a),z.o=d(M,ee,z.o),z},{e:void 0,t:void 0,a:void 0,o:void 0}),w})()})}})};_t(["click"]);var qI=G("<div>🔄"),HI=G("<button type=button>×"),GI=G("<div>⚠️ "),Kh=G("<div>"),WI=G("<div><div><input type=text autocomplete=off>"),YI=G("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>"),KI=G("<span>⚠️ ");const QI=t=>{const{t:e}=ot(),[r,n]=ge(""),[i,o]=ge(!1),[a,c]=ge(null),[u,h]=ge([]),[f,g]=ge(!1),[b,C]=ge(-1),[R,T]=ge(null),E=t.searchDelay||300,$=t.maxResults||900,K=async x=>{if(!x.trim()||x.trim().length<3){h([]),t.onSearchResults?.([]);return}try{o(!0),c(null);try{const F=await jn.getProducts(x),ee=Object.keys(F),Q=te=>{let B=F;return{id:te,name:B[te].name,businessId:B[te].businessId,sku:B[te].code,UPC:B[te].UPC,numCode:B[te].codeN,category:B[te].category,unitCost:B[te].unitCost||0,unitOfMeasure:B[te].unitOfMeasure,minStockLevel:B[te].minStockLevel,maxStockLevel:B[te].maxStockLevel,isActive:B[te].isActive,description:B[te].description||"",createdDate:B[te].createdAt||new Date().toISOString(),lastModified:B[te].updatedAt||new Date().toISOString()}},ue=ee.map(Q);h(ue),Re.updProduct(ue),t.onSearchResults?.(ue)}catch(F){console.warn("API search failed, using local fallback:",F),c("API search failed, showing local results");const ee=Re.getActiveProducts().filter(Q=>Q.name.toLowerCase().includes(x.toLowerCase())||Q.sku.toLowerCase().includes(x.toLowerCase())||Q.category.toLowerCase().includes(x.toLowerCase())).slice(0,$);h(ee),t.onSearchResults?.(ee)}}catch(F){const ee=F instanceof Error?F.message:"Search failed";c(ee),h([]),t.onSearchResults?.([])}finally{o(!1)}},Z=x=>{const ee=x.target.value;n(ee),c(null),t.showResults!==!1&&g(!0),R()&&clearTimeout(R());const Q=setTimeout(()=>{K(ee)},E);T(Q)},J=x=>{n(x.name),g(!1),C(-1),t.onProductSelect?.(x)},de=x=>{if(!(!f()||u().length===0))switch(x.key){case"ArrowDown":x.preventDefault(),C(F=>Math.min(F+1,u().length-1));break;case"ArrowUp":x.preventDefault(),C(F=>Math.max(F-1,-1));break;case"Enter":x.preventDefault(),b()>=0&&u()[b()]&&J(u()[b()]);break;case"Escape":g(!1),C(-1);break}},re=()=>{t.showResults!==!1&&u().length>0&&g(!0)},I=()=>{setTimeout(()=>{g(!1),C(-1)},150)},S=()=>{n(""),h([]),c(null),g(!1),C(-1),t.onSearchResults?.([]),R()&&(clearTimeout(R()),T(null))},v=x=>Re.stockLevels.filter(F=>F.productId===x).reduce((F,ee)=>F+ee.quantity,0),w=x=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(x),P={position:"relative",width:"100%",...t.style},A={position:"relative",display:"flex","align-items":"center"},y={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},se={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},W={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},k={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},H=x=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:x?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),V={display:"flex","justify-content":"space-between","align-items":"center"},O={flex:"1"},D={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},M={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},he={"text-align":"right","font-size":"0.875rem"},z={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},pe={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var x=WI(),F=x.firstChild,ee=F.firstChild;return ee.addEventListener("blur",I),ee.addEventListener("focus",re),ee.$$keydown=de,ee.$$input=Z,s(F,_(Le,{get when(){return i()},get children(){var Q=qI();return ie(ue=>d(Q,W,ue)),Q}}),null),s(F,_(Le,{get when(){return me(()=>!!r())()&&!i()},get children(){var Q=HI();return Q.addEventListener("mouseleave",ue=>{ue.currentTarget.style.background="none",ue.currentTarget.style.color="var(--text-muted)"}),Q.addEventListener("mouseenter",ue=>{ue.currentTarget.style.background="var(--border-color)",ue.currentTarget.style.color="var(--text-primary)"}),Q.$$click=S,ie(ue=>{var te=se,B=e("common.clear","Clear search");return ue.e=d(Q,te,ue.e),B!==ue.t&&lt(Q,"title",ue.t=B),ue},{e:void 0,t:void 0}),Q}}),null),s(x,_(Le,{get when(){return f()&&t.showResults!==!1},get children(){var Q=Kh();return s(Q,_(Le,{get when(){return a()},get children(){var ue=GI();return ue.firstChild,d(ue,pe),s(ue,a,null),ue}}),null),s(Q,_(Le,{get when(){return u().length>0},get fallback(){return me(()=>!!(r()&&!i()))()&&(()=>{var ue=Kh();return d(ue,z),s(ue,()=>e("inventory.noProductsFound","No products found matching your search.")),ue})()},get children(){return _(xt,{get each(){return u()},children:(ue,te)=>{const B=v(ue.id),ae=B<=ue.minStockLevel;return(()=>{var ve=YI(),be=ve.firstChild,oe=be.firstChild,ce=oe.firstChild,Y=ce.nextSibling,q=Y.firstChild,N=q.firstChild,ne=q.nextSibling,fe=ne.nextSibling,U=fe.nextSibling,j=U.nextSibling,Se=oe.nextSibling,we=Se.firstChild,le=we.firstChild,ye=we.nextSibling;return ve.addEventListener("mouseenter",()=>C(te())),ve.$$click=()=>J(ue),d(be,V),d(oe,O),d(ce,D),s(ce,()=>ue.name),d(Y,M),s(q,()=>e("inventory.sku","SKU"),N),s(q,()=>ue.sku,null),s(fe,()=>ue.category),s(j,()=>w(ue.unitCost)),d(Se,he),we.style.setProperty("font-weight","600"),(ae?"#f44336":"var(--text-primary)")!=null?we.style.setProperty("color",ae?"#f44336":"var(--text-primary)"):we.style.removeProperty("color"),s(we,B,le),s(we,()=>ue.unitOfMeasure,null),ye.style.setProperty("color","var(--text-muted)"),s(ye,()=>ae?(()=>{var X=KI();return X.firstChild,X.style.setProperty("color","#f44336"),s(X,()=>e("inventory.lowStock","Low Stock"),null),X})():e("inventory.inStock","In Stock")),ie(X=>d(ve,H(te()===b()),X)),ve})()}})}}),null),ie(ue=>d(Q,k,ue)),Q}}),null),ie(Q=>{var ue=P,te=A,B=y,ae=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),ve=t.disabled;return Q.e=d(x,ue,Q.e),Q.t=d(F,te,Q.t),Q.a=d(ee,B,Q.a),ae!==Q.o&&lt(ee,"placeholder",Q.o=ae),ve!==Q.i&&(ee.disabled=Q.i=ve),Q},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ie(()=>ee.value=r()),x})()};_t(["input","keydown","click"]);var JI=G("<div><div><h2></h2><div><div>"),XI=G("<div><span>"),ZI=G("<span>🔍 "),eE=G("<div><div><div><div><h3></h3><span></span></div><div></div><div>: </div></div><div><div></div><div> • <!>: </div><div>: "),tE=G("<div><div>:</div><div>"),rE=G("<div>: "),nE=G("<div><div><span>:</span><select><option value=10>10</option><option value=20>20</option><option value=50>50</option><option value=100>100</option></select></div><div><div><span></span><input type=number min=1><span> </span></div></div><div>");const fg=()=>{const{t}=ot(),[e,r]=ge(""),[n,i]=ge(""),[o,a]=ge([]),[c,u]=ge(!1),[h,f]=ge(null),[g,b]=ge(!1),[C,R]=ge(!1),[T,E]=ge(!1),[$,K]=ge(null),[Z,J]=ge(!1),[de,re]=ge([]),[I,S]=ge(!1),[v,w]=ge(1),[P,A]=ge(20);Qr(async()=>{await y()});const y=async()=>{try{u(!0),f(null);try{const x=await ed.getAll();a(x.map(F=>({id:F.id||`prod-${Date.now()}-${Math.random()}`,name:F.productName||F.name||"Unknown Product",sku:F.sku||F.productCode||"",description:F.description||"",category:F.category||"General",unitOfMeasure:F.unitOfMeasure||"pcs",unitCost:parseFloat(F.unitCost||F.cost||"0"),sellingPrice:parseFloat(F.sellingPrice||F.price||"0"),minStockLevel:parseInt(F.minStockLevel||"0"),maxStockLevel:parseInt(F.maxStockLevel||"100"),isActive:F.isActive!==!1,createdDate:F.createdDate||new Date().toISOString(),lastModified:F.lastModified||new Date().toISOString(),businessId:F.businessId||"YB100423253156428"})))}catch(x){console.warn("API failed, using local store:",x),a(Re.products)}}catch(x){f(x instanceof Error?x.message:"Failed to load products")}finally{u(!1)}},se=async()=>{try{u(!0),f(null);try{const x=await jn.getProducts("prod"),F=Object.keys(x),ee=ue=>{let B=x[ue];return{id:B.id,name:B.name,businessId:B.businessId,sku:B.code,numCode:B.codeN,category:B.category,unitCost:B.unitCost||0,unitOfMeasure:B.unitOfMeasure,minStockLevel:B.minStockLevel,maxStockLevel:B.maxStockLevel,isActive:B.isActive,description:B.description||"",createdDate:B.createdAt||new Date().toISOString(),lastModified:B.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(B.sellingPrice||B.price||"0")}},Q=F.map(ee);a(Q)}catch(x){console.warn("API failed, using local store:",x),a(Re.products)}}catch(x){f(x instanceof Error?x.message:"Failed to load products")}finally{u(!1)}},{cancel:W}=xI(async x=>{if(!x.trim()){await y();return}try{f(null);const F=await ed.getAll(x);a(F.map(ee=>({id:ee.id||`prod-${Date.now()}-${Math.random()}`,name:ee.productName||ee.name||"Unknown Product",sku:ee.sku||ee.productCode||"",description:ee.description||"",category:ee.category||"General",unitOfMeasure:ee.unitOfMeasure||"pcs",unitCost:parseFloat(ee.unitCost||ee.cost||"0"),sellingPrice:parseFloat(ee.sellingPrice||ee.price||"0"),minStockLevel:parseInt(ee.minStockLevel||"0"),maxStockLevel:parseInt(ee.maxStockLevel||"100"),isActive:ee.isActive!==!1,createdDate:ee.createdDate||new Date().toISOString(),lastModified:ee.lastModified||new Date().toISOString(),businessId:ee.businessId||"YB100423253156428"})))}catch(F){f(F instanceof Error?F.message:"Search failed");const ee=Re.products.filter(Q=>Q.name.toLowerCase().includes(x.toLowerCase())||Q.sku.toLowerCase().includes(x.toLowerCase())||Q.category.toLowerCase().includes(x.toLowerCase()));a(ee)}},300);oo(()=>{W()}),qe(()=>{let x=o();return n()&&(x=x.filter(F=>F.category===n())),x}),qe(()=>[...new Set(o().map(F=>F.category))].sort()),qe(()=>{const x=o().filter(Q=>Q.isActive),F=o().length,ee=o().filter(Q=>Re.getTotalStockByProduct(Q.id)===0);return{total:F,active:x.length,outOfStock:ee.length}});const k=x=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(x),H={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},V={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},O=x=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:x?"#ffebee":"#e8f5e8",color:x?"#d32f2f":"#2d7d32"});qe(()=>{const x=Re.products||[],F=Re.movements||[],ee=Re.stockLevels||[],Q=Re.getLowStockProducts(),ue=x?.length||0,te=x?.filter(ve=>ve.isActive).length,B=ee.reduce((ve,be)=>ve*1+be.quantity*1*be.averageCost*1,0),ae=F?.filter(ve=>{const be=new Date(ve.createdDate),oe=new Date;return be.getMonth()===oe.getMonth()&&be.getFullYear()===oe.getFullYear()}).length;return{totalProducts:ue,activeProducts:te,lowStockProducts:Q.length,totalStockValue:B,totalMovementsThisMonth:ae,totalLocations:Re.locations.length,activeLocations:Re.getActiveLocations().length}});const D=qe(()=>Re.products.map(x=>{const F=Re.getStockByProduct(x.id),ee=Re.getTotalStockByProduct(x.id),Q=Re.getLastLocationByProduct(x.id);return{...x,totalStock:ee,stockByLocation:F,lastLocation:Q,isLowStock:ee<=x.minStockLevel}})),M=qe(()=>de().map(x=>{const F=Re.getStockByProduct(x.id),ee=Re.getTotalStockByProduct(x.id),Q=Re.getLastLocationByProduct(x.id);return{...x,totalStock:ee,stockByLocation:F,lastLocation:Q,isLowStock:ee<=x.minStockLevel}})),he=qe(()=>{const x=I()?M():D(),F=(v()-1)*P(),ee=F+P();return x.slice(F,ee)}),z=qe(()=>{const x=I()?M():D();return Math.ceil(x.length/P())}),pe=x=>{K(x),R(!0)};return _(Dr,{get title(){return t("products.title","Products")},get children(){return[(()=>{var x=JI(),F=x.firstChild,ee=F.firstChild,Q=ee.nextSibling,ue=Q.firstChild;return x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","flex-start"),x.style.setProperty("margin-bottom","1.5rem"),x.style.setProperty("flex-wrap","wrap"),x.style.setProperty("gap","1rem"),F.style.setProperty("flex","1"),F.style.setProperty("min-width","300px"),ee.style.setProperty("margin","0 0 1rem 0"),ee.style.setProperty("font-size","1.5rem"),s(ee,()=>t("inventory.products")),Q.style.setProperty("display","flex"),Q.style.setProperty("gap","1rem"),Q.style.setProperty("align-items","center"),Q.style.setProperty("flex-wrap","wrap"),ue.style.setProperty("flex","1"),ue.style.setProperty("min-width","250px"),s(ue,_(QI,{onSearchResults:te=>{re(te),S(te.length>0)},get placeholder(){return t("inventory.searchProductsStock","Search products and check stock levels...")},showResults:!1,maxResults:20})),s(Q,_(De,{variant:"outline",onClick:()=>{se(),S(!1)},get children(){return["🔄 ",me(()=>t("common.showAll","Show All"))]}}),null),s(x,_(Le,{get when(){return Et.hasPermission("read_write")},get children(){return _(De,{variant:"primary",onClick:()=>J(!0),get children(){return["➕ ",me(()=>t("inventory.addProduct"))]}})}}),null),x})(),(()=>{var x=XI(),F=x.firstChild;return x.style.setProperty("margin-bottom","1rem"),x.style.setProperty("font-size","0.875rem"),x.style.setProperty("color","var(--text-muted)"),x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),s(F,(()=>{var ee=me(()=>!!I());return()=>ee()?`${t("inventory.searchResults","Search Results")}: ${M().length} ${t("common.products","products")}`:`${t("inventory.totalProducts","Total Products")}: ${D().length} ${t("common.products","products")}`})()),s(x,(()=>{var ee=me(()=>!!I());return()=>ee()&&(()=>{var Q=ZI();return Q.firstChild,Q.style.setProperty("color","var(--primary-color)"),s(Q,()=>t("inventory.filtered","Filtered view"),null),Q})()})(),null),x})(),_(xt,{get each(){return he()},children:x=>(()=>{var F=eE(),ee=F.firstChild,Q=ee.firstChild,ue=Q.firstChild,te=ue.firstChild,B=te.nextSibling,ae=ue.nextSibling,ve=ae.nextSibling,be=ve.firstChild,oe=Q.nextSibling,ce=oe.firstChild,Y=ce.nextSibling,q=Y.firstChild,N=q.nextSibling;N.nextSibling;var ne=Y.nextSibling,fe=ne.firstChild;return F.$$click=()=>pe(x),F.addEventListener("mouseleave",U=>{U.currentTarget.style.transform="translateY(0)",U.currentTarget.style.boxShadow="none"}),F.addEventListener("mouseenter",U=>{U.currentTarget.style.transform="translateY(-2px)",U.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),d(F,H),d(ee,V),ue.style.setProperty("display","flex"),ue.style.setProperty("align-items","center"),ue.style.setProperty("gap","0.5rem"),ue.style.setProperty("margin-bottom","0.5rem"),te.style.setProperty("margin","0"),te.style.setProperty("font-size","1.1rem"),s(te,()=>x.name),s(B,(()=>{var U=me(()=>!!x.isLowStock);return()=>U()?t("inventory.lowStockAlert"):t("inventory.inStock")})()),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),s(ae,()=>x.sku,null),s(ae,()=>x.UPC?" • "+x.UPC:"",null),s(ae,()=>x.category?" • "+x.category:"",null),ve.style.setProperty("font-size","0.875rem"),ve.style.setProperty("color","var(--text-muted)"),s(ve,()=>t("inventory.lastSeen"),be),s(ve,()=>x.lastLocation?.name||t("inventory.noMovements"),null),oe.style.setProperty("text-align","right"),ce.style.setProperty("font-size","1.25rem"),ce.style.setProperty("font-weight","700"),ce.style.setProperty("color","var(--primary-color)"),s(ce,()=>x.totalStock),Y.style.setProperty("font-size","0.875rem"),Y.style.setProperty("color","var(--text-muted)"),s(Y,()=>x.unitOfMeasure,q),s(Y,()=>t("inventory.min"),N),s(Y,()=>x.minStockLevel,null),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-muted)"),s(ne,()=>t("inventory.cost"),fe),s(ne,()=>k(x.unitCost),null),s(F,(()=>{var U=me(()=>x.stockByLocation.length>0);return()=>U()&&(()=>{var j=tE(),Se=j.firstChild,we=Se.firstChild,le=Se.nextSibling;return j.style.setProperty("margin-top","1rem"),Se.style.setProperty("font-weight","500"),Se.style.setProperty("margin-bottom","0.5rem"),Se.style.setProperty("font-size","0.875rem"),s(Se,()=>t("inventory.stockByLocation"),we),le.style.setProperty("display","flex"),le.style.setProperty("flex-wrap","wrap"),le.style.setProperty("gap","0.5rem"),s(le,_(xt,{get each(){return x.stockByLocation},children:ye=>{const X=Re.getLocationById(ye.locationId);return(()=>{var Pe=rE(),ke=Pe.firstChild;return Pe.style.setProperty("padding","0.25rem 0.5rem"),Pe.style.setProperty("background","var(--background-color)"),Pe.style.setProperty("border-radius","var(--border-radius-sm)"),Pe.style.setProperty("font-size","0.75rem"),Pe.style.setProperty("border","1px solid var(--border-color)"),s(Pe,()=>X?.name,ke),s(Pe,()=>ye.quantity,null),Pe})()}})),j})()})(),null),ie(U=>d(B,O(x.isLowStock),U)),F})()}),me(()=>me(()=>z()>1)()&&(()=>{var x=nE(),F=x.firstChild,ee=F.firstChild,Q=ee.firstChild,ue=ee.nextSibling,te=F.nextSibling,B=te.firstChild,ae=B.firstChild,ve=ae.nextSibling,be=ve.nextSibling,oe=be.firstChild,ce=te.nextSibling;return x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),x.style.setProperty("margin-top","2rem"),x.style.setProperty("padding","1rem"),x.style.setProperty("background","var(--surface-color)"),x.style.setProperty("border-radius","var(--border-radius)"),x.style.setProperty("border","1px solid var(--border-color)"),F.style.setProperty("display","flex"),F.style.setProperty("align-items","center"),F.style.setProperty("gap","0.5rem"),ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),s(ee,()=>t("common.showPerPage","Show per page"),Q),ue.addEventListener("change",Y=>{A(parseInt(Y.target.value)),w(1)}),ue.style.setProperty("padding","0.25rem 0.5rem"),ue.style.setProperty("border","1px solid var(--border-color)"),ue.style.setProperty("border-radius","var(--border-radius-sm)"),ue.style.setProperty("background","var(--background-color)"),ue.style.setProperty("cursor","pointer"),te.style.setProperty("display","flex"),te.style.setProperty("align-items","center"),te.style.setProperty("gap","0.5rem"),s(te,_(De,{variant:"outline",size:"sm",onClick:()=>w(1),get disabled(){return v()===1},get children(){return t("common.first","First")}}),B),s(te,_(De,{variant:"outline",size:"sm",onClick:()=>w(Y=>Math.max(1,Y-1)),get disabled(){return v()===1},get children(){return t("common.previous","Previous")}}),B),B.style.setProperty("display","flex"),B.style.setProperty("align-items","center"),B.style.setProperty("gap","0.25rem"),ae.style.setProperty("font-size","0.875rem"),s(ae,()=>t("common.page","Page")),ve.addEventListener("change",Y=>{const q=parseInt(Y.target.value);q>=1&&q<=z()&&w(q)}),ve.style.setProperty("width","60px"),ve.style.setProperty("padding","0.25rem 0.5rem"),ve.style.setProperty("border","1px solid var(--border-color)"),ve.style.setProperty("border-radius","var(--border-radius-sm)"),ve.style.setProperty("text-align","center"),ve.style.setProperty("font-size","0.875rem"),be.style.setProperty("font-size","0.875rem"),s(be,()=>t("common.of","of"),oe),s(be,z,null),s(te,_(De,{variant:"outline",size:"sm",onClick:()=>w(Y=>Math.min(z(),Y+1)),get disabled(){return v()===z()},get children(){return t("common.next","Next")}}),null),s(te,_(De,{variant:"outline",size:"sm",onClick:()=>w(z()),get disabled(){return v()===z()},get children(){return t("common.last","Last")}}),null),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("color","var(--text-muted)"),s(ce,()=>{const Y=I()?M():D(),q=(v()-1)*P()+1,N=Math.min(v()*P(),Y.length);return t("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:q,end:N,total:Y.length})}),ie(()=>lt(ve,"max",z())),ie(()=>ue.value=P()),ie(()=>ve.value=v()),x})()),_(Su,{get isOpen(){return g()},onClose:()=>b(!1),onProductAdded:()=>{y()}}),_(zI,{get isOpen(){return C()},onClose:()=>{R(!1),K(null)},get product(){return $()},onEdit:()=>{R(!1),E(!0)}})]}})};_t(["click"]);var iE=G("<div><h1></h1><div><div><span>View:</span><button> 1</button><button> 2"),Ir=G("<div>"),oE=G("<div><h3></h3><div>"),sE=G("<div>: <!> "),aE=G("<div><button></button><button></button><button></button><button>"),lE=G("<div><div>"),cE=G("<div><span> (<!>)</span><span> / <!> "),uE=G("<div><div><h2></h2></div><div>"),dE=G("<div><div><div><span></span><h3></h3></div><div> • </div><div></div></div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div>:"),hE=G("<div><div><div><div></div><div></div></div><div><div> </div><div></div><div>Min: "),mE=G("<span>⚠️ LOW");const fE=()=>{const{t}=ot(),[e,r]=ge(!1),[n,i]=ge(!1),[o,a]=ge(!1),[c,u]=ge(null),[h,f]=ge("overview"),[g,b]=ge("new"),[C,R]=ge(""),[T,E]=ge(""),[$,K]=ge([]),[Z,J]=ge(!1),[de,re]=ge(!1),[I,S]=ge(!1),[v,w]=ge(!1),[P,A]=ge(!1),[y,se]=ge(1),[W,k]=ge(20),H=q=>{u(q),a(!0)},V=qe(()=>{const q=Re.products||[],N=Re.movements||[],ne=Re.stockLevels||[],fe=Re.getLowStockProducts(),U=q?.length||0,j=q?.filter(le=>le.isActive).length,Se=ne.reduce((le,ye)=>le*1+ye.quantity*1*ye.averageCost*1,0),we=N?.filter(le=>{const ye=new Date(le.createdDate),X=new Date;return ye.getMonth()===X.getMonth()&&ye.getFullYear()===X.getFullYear()}).length;return{totalProducts:U,activeProducts:j,lowStockProducts:fe.length,totalStockValue:Se,totalMovementsThisMonth:we,totalLocations:Re.locations.length,activeLocations:Re.getActiveLocations().length}});qe(()=>Re.products.map(q=>{const N=Re.getStockByProduct(q.id),ne=Re.getTotalStockByProduct(q.id),fe=Re.getLastLocationByProduct(q.id);return{...q,totalStock:ne,stockByLocation:N,lastLocation:fe,isLowStock:ne<=q.minStockLevel}})),qe(()=>{de(),se(1)});const O=(q,N)=>q<=N?t("inventory.lowStockAlert"):q<=N*2?t("inventory.normalStock"):t("inventory.inStock"),D=q=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(q),M=q=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(q),he=q=>{switch(q){case"warehouse":return t("inventory.warehouse");case"store":return t("inventory.store");case"supplier":return t("inventory.supplier");case"customer":return t("inventory.customer");default:return q}},z={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},pe={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},x=q=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500",background:q>50?"#d4edda":q>20?"#fff3cd":"#f8d7da",color:q>50?"#155724":q>20?"#856404":"#721c24"}),F={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},ee={color:"var(--text-muted)","font-size":"0.875rem"},Q={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},ue={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},te={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},B=q=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:q?"var(--primary-color)":"var(--text-muted)","border-bottom":q?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),ae={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem","margin-bottom":"2rem"},ve={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},be={display:"flex",gap:"0.5rem","align-items":"center","margin-left":"auto","margin-right":"1rem"},oe=q=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:q?"var(--primary-color)":"var(--surface-color)",color:q?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),ce=qe(()=>{const q=Re.movements;return{total:q.length,stockIn:q.filter(N=>N.movementType==="in").length,stockOut:q.filter(N=>N.movementType==="out").length,transfers:q.filter(N=>N.movementType==="transfer").length,adjustments:q.filter(N=>N.movementType==="adjustment").length,totalValue:q.reduce((N,ne)=>N+ne.totalCost,0)}}),Y=async()=>{let q="prod";await Re.fecthInventory(q),await Re.fecthProduct(q)};return Qr(()=>{Y()}),_(Dr,{get title(){return t("inventory.title")},get children(){return[(()=>{var q=iE(),N=q.firstChild,ne=N.nextSibling,fe=ne.firstChild,U=fe.firstChild,j=U.nextSibling,Se=j.firstChild,we=j.nextSibling,le=we.firstChild;return d(q,ue),N.style.setProperty("margin","0"),N.style.setProperty("font-size","1.75rem"),ne.style.setProperty("display","flex"),ne.style.setProperty("align-items","center"),ne.style.setProperty("gap","1rem"),d(fe,be),U.style.setProperty("font-weight","500"),U.style.setProperty("color","var(--text-muted)"),U.style.setProperty("font-size","0.875rem"),j.$$click=()=>b("new"),s(j,()=>t("common.view"),Se),we.$$click=()=>b("legacy"),s(we,()=>t("common.view"),le),s(ne,(()=>{var ye=me(()=>g()==="new");return()=>ye()&&_(De,{variant:"outline",onClick:()=>A(!0),get children(){return["🔢 ",me(()=>t("inventory.physicalCount","Physical Count"))]}})})(),null),s(ne,_(Le,{get when(){return Et.hasPermission("read_write")},get children(){return _(De,{variant:"primary",onClick:()=>i(!0),get children(){return me(()=>g()==="new")()?t("inventory.addMovement"):t("common.add")}})}}),null),ie(ye=>{var X=oe(g()==="new"),Pe=oe(g()==="legacy");return ye.e=d(j,X,ye.e),ye.t=d(we,Pe,ye.t),ye},{e:void 0,t:void 0}),q})(),_(Le,{get when(){return Et.hasPermission("inventoryDownsection")},get children(){return me(()=>g()==="legacy")()?[(()=>{var q=Ir();return s(q,_(We,{get title(){return t("inventory.totalItems")},get subtitle(){return t("inventory.inStock")},get children(){var N=Ir();return N.style.setProperty("font-size","1.5rem"),N.style.setProperty("font-weight","600"),N.style.setProperty("color","var(--primary-color)"),s(N,()=>Re.inventory.length),N}}),null),s(q,_(We,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.itemsBelowThreshold")},get children(){var N=Ir();return N.style.setProperty("font-size","1.5rem"),N.style.setProperty("font-weight","600"),N.style.setProperty("color","var(--primary-color)"),s(N,()=>Re.getLowStockItems().length),N}}),null),s(q,_(We,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.inventoryWorth")},get children(){var N=Ir();return N.style.setProperty("font-size","1.5rem"),N.style.setProperty("font-weight","600"),N.style.setProperty("color","var(--primary-color)"),s(N,()=>D(Re.getTotalValue())),N}}),null),ie(N=>d(q,Q,N)),q})(),(()=>{var q=Ir();return d(q,z),s(q,_(xt,{get each(){return Re.inventory},children:N=>{const ne=O(N.quantity,N.minStock),fe=N.quantity<=N.minStock?8:N.quantity<=N.minStock*2?35:75;return _(We,{onClick:()=>H(N),get children(){return[(()=>{var U=oE(),j=U.firstChild,Se=j.nextSibling;return d(U,pe),j.style.setProperty("margin","0"),j.style.setProperty("font-size","1.1rem"),s(j,()=>N.name),s(Se,ne),ie(we=>d(Se,x(fe),we)),U})(),(()=>{var U=Ir();return d(U,F),s(U,()=>D(N.price)),U})(),(()=>{var U=sE(),j=U.firstChild,Se=j.nextSibling;return Se.nextSibling,d(U,ee),s(U,()=>t("inventory.quantity"),j),s(U,()=>N.quantity,Se),s(U,()=>t("common.units"),null),U})()]}})}})),q})()]:[(()=>{var q=aE(),N=q.firstChild,ne=N.nextSibling,fe=ne.nextSibling,U=fe.nextSibling;return d(q,te),N.$$click=()=>f("overview"),s(N,()=>t("inventory.overview")),ne.$$click=()=>f("products"),s(ne,()=>t("inventory.products")),fe.$$click=()=>f("movements"),s(fe,()=>t("inventory.movements")),U.$$click=()=>f("locations"),s(U,()=>t("inventory.locations")),ie(j=>{var Se=B(h()==="overview"),we=B(h()==="products"),le=B(h()==="movements"),ye=B(h()==="locations");return j.e=d(N,Se,j.e),j.t=d(ne,we,j.t),j.a=d(fe,le,j.a),j.o=d(U,ye,j.o),j},{e:void 0,t:void 0,a:void 0,o:void 0}),q})(),me(()=>me(()=>h()==="overview")()&&(()=>{var q=lE(),N=q.firstChild;return s(N,_(We,{get title(){return t("inventory.activeProducts")},get subtitle(){return t("inventory.currentlyManaged")},get children(){var ne=Ir();return ne.style.setProperty("font-size","1.5rem"),ne.style.setProperty("font-weight","600"),ne.style.setProperty("color","var(--primary-color)"),s(ne,()=>V().activeProducts),ne}}),null),s(N,_(We,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.needAttention")},get children(){var ne=Ir();return ne.style.setProperty("font-size","1.5rem"),ne.style.setProperty("font-weight","600"),ne.style.setProperty("color","#d32f2f"),s(ne,()=>V().lowStockProducts),ne}}),null),s(N,_(We,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.currentWorth")},get children(){var ne=Ir();return ne.style.setProperty("font-size","1.5rem"),ne.style.setProperty("font-weight","600"),ne.style.setProperty("color","var(--primary-color)"),s(ne,()=>M(ce().totalValue)),ne}}),null),s(N,_(We,{get title(){return t("inventory.movements")},get subtitle(){return t("inventory.thisMonth")},get children(){var ne=Ir();return ne.style.setProperty("font-size","1.5rem"),ne.style.setProperty("font-weight","600"),ne.style.setProperty("color","var(--primary-color)"),s(ne,()=>V().totalMovementsThisMonth),ne}}),null),s(N,_(We,{get title(){return t("inventory.activeLocations")},get subtitle(){return t("inventory.warehousesStores")},get children(){var ne=Ir();return ne.style.setProperty("font-size","1.5rem"),ne.style.setProperty("font-weight","600"),ne.style.setProperty("color","var(--primary-color)"),s(ne,()=>V().activeLocations),ne}}),null),s(q,(()=>{var ne=me(()=>V().lowStockProducts>0);return()=>ne()&&_(We,{get title(){return`⚠️ ${t("inventory.lowStockAlert")}`},get subtitle(){return`${V().lowStockProducts} ${t("inventory.productsNeedRestocking")}`},style:{"margin-bottom":"2rem","border-color":"#ffcdd2",background:"#ffebee"},get children(){var fe=Ir();return fe.style.setProperty("margin-top","1rem"),s(fe,_(xt,{get each(){return Re.getLowStockProducts().slice(0,9)},children:U=>(()=>{var j=cE(),Se=j.firstChild,we=Se.firstChild,le=we.nextSibling;le.nextSibling;var ye=Se.nextSibling,X=ye.firstChild,Pe=X.nextSibling;return Pe.nextSibling,j.style.setProperty("display","flex"),j.style.setProperty("justify-content","space-between"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-size","0.875rem"),s(Se,()=>U.name,we),s(Se,()=>U?.sku,le),ye.style.setProperty("color","#d32f2f"),ye.style.setProperty("font-weight","600"),s(ye,()=>U.currentStock,X),s(ye,()=>U.minStockLevel,Pe),s(ye,()=>t("inventory.min"),null),j})()}),null),s(fe,(()=>{var U=me(()=>Re.getLowStockProducts().length>5);return()=>U()&&(()=>{var j=Ir();return j.style.setProperty("font-size","0.875rem"),j.style.setProperty("color","var(--text-muted)"),j.style.setProperty("font-style","italic"),s(j,()=>t("common.andMore",{count:Re.getLowStockProducts().length-9})),j})()})(),null),fe}})})(),null),ie(ne=>d(N,Q,ne)),q})()),me(()=>me(()=>h()==="products")()&&_(fg,{})),me(()=>me(()=>h()==="movements")()&&_(mI,{})),me(()=>me(()=>h()==="locations")()&&(()=>{var q=uE(),N=q.firstChild,ne=N.firstChild,fe=N.nextSibling;return N.style.setProperty("display","flex"),N.style.setProperty("justify-content","space-between"),N.style.setProperty("align-items","center"),N.style.setProperty("margin-bottom","1.5rem"),ne.style.setProperty("margin","0"),ne.style.setProperty("font-size","1.5rem"),s(ne,()=>t("inventory.locations")),s(N,_(Le,{get when(){return Et.hasPermission("read_write")},get children(){return _(De,{variant:"primary",onClick:()=>S(!0),get children(){return["🏭 ",me(()=>t("inventory.addLocation"))]}})}}),null),d(fe,ae),s(fe,_(xt,{get each(){return Re.getActiveLocations()},children:U=>{const j=Re.getStockByLocation(U.id),Se=j.length,we=j.reduce((ye,X)=>ye*1+X.quantity*1,0),le=j.reduce((ye,X)=>(Re.getProductById(X.productId),ye+(X?.averageCost||0)),0);return(()=>{var ye=dE(),X=ye.firstChild,Pe=X.firstChild,ke=Pe.firstChild,Te=ke.nextSibling,$e=Pe.nextSibling,Ue=$e.firstChild,Ye=$e.nextSibling,ze=X.nextSibling,Ee=ze.firstChild,Me=Ee.firstChild,Ke=Me.firstChild,Ge=Me.nextSibling,He=Ee.nextSibling,Ae=He.firstChild,st=Ae.firstChild,Xe=Ae.nextSibling,gt=He.nextSibling,dt=gt.firstChild,Ft=dt.firstChild,Ht=dt.nextSibling,$t=ze.nextSibling,Ot=$t.firstChild,bt=Ot.firstChild;return X.style.setProperty("margin-bottom","1rem"),X.style.setProperty("padding-bottom","1rem"),X.style.setProperty("border-bottom","1px solid var(--border-color)"),Pe.style.setProperty("display","flex"),Pe.style.setProperty("align-items","center"),Pe.style.setProperty("gap","0.5rem"),Pe.style.setProperty("margin-bottom","0.5rem"),ke.style.setProperty("font-size","1.2rem"),s(ke,()=>U.type==="warehouse"?"🏭":U.type==="store"?"🏪":U.type==="supplier"?"🚚":"👥"),Te.style.setProperty("margin","0"),Te.style.setProperty("font-size","1.1rem"),s(Te,()=>U.name),$e.style.setProperty("font-size","0.875rem"),$e.style.setProperty("color","var(--text-muted)"),s($e,()=>U.code,Ue),s($e,()=>he(U.type),null),Ye.style.setProperty("font-size","0.75rem"),Ye.style.setProperty("color","var(--text-muted)"),Ye.style.setProperty("margin-top","0.25rem"),s(Ye,()=>U.address),ze.style.setProperty("margin-bottom","1rem"),Ee.style.setProperty("display","flex"),Ee.style.setProperty("justify-content","space-between"),Ee.style.setProperty("margin-bottom","0.5rem"),Me.style.setProperty("font-size","0.875rem"),Me.style.setProperty("font-weight","500"),s(Me,()=>t("inventory.products"),Ke),Ge.style.setProperty("font-weight","600"),s(Ge,Se),He.style.setProperty("display","flex"),He.style.setProperty("justify-content","space-between"),He.style.setProperty("margin-bottom","0.5rem"),Ae.style.setProperty("font-size","0.875rem"),Ae.style.setProperty("font-weight","500"),s(Ae,()=>t("inventory.totalItems"),st),Xe.style.setProperty("font-weight","600"),Xe.style.setProperty("color","var(--primary-color)"),s(Xe,we),gt.style.setProperty("display","flex"),gt.style.setProperty("justify-content","space-between"),gt.style.setProperty("margin-bottom","1rem"),dt.style.setProperty("font-size","0.875rem"),dt.style.setProperty("font-weight","500"),s(dt,()=>t("inventory.totalValue"),Ft),Ht.style.setProperty("font-weight","600"),Ht.style.setProperty("color","var(--primary-color)"),s(Ht,()=>M(le)),Ot.style.setProperty("font-weight","600"),Ot.style.setProperty("margin-bottom","0.75rem"),Ot.style.setProperty("font-size","0.875rem"),Ot.style.setProperty("color","var(--text-primary)"),Ot.style.setProperty("border-bottom","1px solid var(--border-color)"),Ot.style.setProperty("padding-bottom","0.5rem"),s(Ot,()=>t("inventory.productDetails"),bt),s($t,(()=>{var Jt=me(()=>j.length===0);return()=>Jt()?(()=>{var St=Ir();return St.style.setProperty("text-align","center"),St.style.setProperty("color","var(--text-muted)"),St.style.setProperty("font-style","italic"),St.style.setProperty("padding","1rem"),s(St,()=>t("inventory.noProducts")),St})():(()=>{var St=Ir();return St.style.setProperty("max-height","200px"),St.style.setProperty("overflow-y","auto"),St.style.setProperty("border","1px solid var(--border-color)"),St.style.setProperty("border-radius","var(--border-radius-sm)"),s(St,_(xt,{each:j,children:ir=>{const Oe=Re.getProductById(ir.productId);if(!Oe)return null;const Ve=ir.quantity<=Oe.minStockLevel,Je=ir.averageCost;return(()=>{var nt=hE(),kt=nt.firstChild,Ze=kt.firstChild,ht=Ze.firstChild,pt=ht.nextSibling,Ct=Ze.nextSibling,ct=Ct.firstChild,Nr=ct.firstChild,Vt=ct.nextSibling,Ut=Vt.nextSibling;return Ut.firstChild,nt.style.setProperty("padding","0.75rem"),nt.style.setProperty("border-bottom","1px solid var(--border-color)"),(Ve?"#fff5f5":"transparent")!=null?nt.style.setProperty("background",Ve?"#fff5f5":"transparent"):nt.style.removeProperty("background"),nt.style.setProperty("transition","background-color 0.2s ease"),kt.style.setProperty("display","flex"),kt.style.setProperty("justify-content","space-between"),kt.style.setProperty("align-items","flex-start"),kt.style.setProperty("margin-bottom","0.25rem"),Ze.style.setProperty("flex","1"),ht.style.setProperty("font-weight","500"),ht.style.setProperty("font-size","0.875rem"),(Ve?"#d32f2f":"var(--text-primary)")!=null?ht.style.setProperty("color",Ve?"#d32f2f":"var(--text-primary)"):ht.style.removeProperty("color"),s(ht,()=>Oe.name,null),s(ht,Ve&&(()=>{var Yt=mE();return Yt.style.setProperty("margin-left","0.5rem"),Yt.style.setProperty("font-size","0.7rem"),Yt.style.setProperty("color","#d32f2f"),Yt})(),null),pt.style.setProperty("font-size","0.75rem"),pt.style.setProperty("color","var(--text-muted)"),pt.style.setProperty("margin-top","0.1rem"),s(pt,()=>Oe.sku,null),s(pt,()=>Oe.UPC?" • "+Oe.UPC:"",null),s(pt,()=>Oe.category?" • "+Oe.category:"",null),Ct.style.setProperty("text-align","right"),ct.style.setProperty("font-weight","600"),ct.style.setProperty("font-size","0.875rem"),(Ve?"#d32f2f":"var(--primary-color)")!=null?ct.style.setProperty("color",Ve?"#d32f2f":"var(--primary-color)"):ct.style.removeProperty("color"),s(ct,()=>ir.quantity,Nr),s(ct,()=>Oe.unitOfMeasure,null),Vt.style.setProperty("font-size","0.75rem"),Vt.style.setProperty("color","var(--text-muted)"),s(Vt,()=>M(Je)),Ut.style.setProperty("font-size","0.7rem"),Ut.style.setProperty("color","var(--text-muted)"),Ut.style.setProperty("margin-top","0.1rem"),s(Ut,()=>Oe.minStockLevel,null),nt})()}})),St})()})(),null),ie(Jt=>d(ye,{...ve,"min-height":"400px"},Jt)),ye})()}})),q})())]}}),_(Le,{get when(){return Et.hasPermission("read_write")},get children(){return[_(xA,{get isOpen(){return e()},onClose:()=>r(!1),get mode(){return g()==="new"?"movement":"legacy"}}),_(LA,{get isOpen(){return n()},onClose:()=>i(!1)}),_(FA,{get isOpen(){return o()},onClose:()=>a(!1),get item(){return c()}}),_(Pu,{get isOpen(){return I()},onClose:()=>S(!1),onLocationAdded:()=>{S(!1)}})]}}),_(AI,{get isOpen(){return P()},onClose:()=>A(!1)})]}})};_t(["click"]);const yE=[{id:"1",name:"John Doe",position:"Software Engineer",salary:85e3,email:"john.doe@company.com",phone:"+1 (555) 123-4567",department:"Engineering",startDate:"2023-01-15"},{id:"2",name:"Jane Smith",position:"Product Manager",salary:95e3,email:"jane.smith@company.com",phone:"+1 (555) 234-5678",department:"Product",startDate:"2022-08-20"},{id:"3",name:"Mike Brown",position:"Designer",salary:7e4,email:"mike.brown@company.com",phone:"+1 (555) 345-6789",department:"Design",startDate:"2023-03-10"},{id:"4",name:"Sarah Kim",position:"HR Manager",salary:78e3,email:"sarah.kim@company.com",phone:"+1 (555) 456-7890",department:"Human Resources",startDate:"2022-11-05"},{id:"5",name:"Alex Lee",position:"Data Analyst",salary:72e3,email:"alex.lee@company.com",phone:"+1 (555) 567-8901",department:"Analytics",startDate:"2023-02-28"},{id:"6",name:"Emma Wilson",position:"Marketing Manager",salary:82e3,email:"emma.wilson@company.com",phone:"+1 (555) 678-9012",department:"Marketing",startDate:"2022-09-15"}],[Eo,Il]=ge(yE),yg={get employees(){return Eo()},addEmployee(t){const e={...t,id:Date.now().toString()};return Il([...Eo(),e]),e},updateEmployee(t,e){Il(Eo().map(r=>r.id===t?{...r,...e}:r))},deleteEmployee(t){Il(Eo().filter(e=>e.id!==t))},getEmployeeById(t){return Eo().find(e=>e.id===t)}};var gE=G("<form><div>");const pE=t=>{const{t:e}=ot(),[r,n]=ge({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),i=[{value:"Engineering",label:e("employees.departments.engineering","Engineering")},{value:"Product",label:e("employees.departments.product","Product")},{value:"Design",label:e("employees.departments.design","Design")},{value:"Marketing",label:e("employees.departments.marketing","Marketing")},{value:"Sales",label:e("employees.departments.sales","Sales")},{value:"Human Resources",label:e("employees.departments.humanResources","Human Resources")},{value:"Finance",label:e("employees.departments.finance","Finance")},{value:"Operations",label:e("employees.departments.operations","Operations")},{value:"Analytics",label:e("employees.departments.analytics","Analytics")}],o={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},a=u=>{u.preventDefault();const h=r();if(!h.name||!h.position||!h.salary||!h.email||!h.department||!h.startDate){alert(e("forms.requiredField"));return}const f={name:h.name,position:h.position,salary:parseFloat(h.salary),email:h.email,phone:h.phone,department:h.department,startDate:h.startDate};yg.addEmployee(f),n({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),t.onClose()},c=(u,h)=>{n(f=>({...f,[u]:h}))};return _(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.addEmployee")},get children(){var u=gE(),h=u.firstChild;return u.addEventListener("submit",a),s(u,_(wt,{get label(){return e("employees.fullName")},get value(){return r().name},onChange:f=>c("name",f),get placeholder(){return e("employees.enterFullName","Enter employee's full name")},required:!0}),h),s(u,_(wt,{get label(){return e("employees.position")},get value(){return r().position},onChange:f=>c("position",f),get placeholder(){return e("employees.enterPosition","Enter job position")},required:!0}),h),s(u,_(hr,{get label(){return e("employees.department")},get value(){return r().department},onChange:f=>c("department",f),options:i,required:!0}),h),s(u,_(wt,{get label(){return e("employees.email")},type:"email",get value(){return r().email},onChange:f=>c("email",f),get placeholder(){return e("employees.enterEmail","Enter email address")},required:!0}),h),s(u,_(wt,{get label(){return e("employees.phone")},type:"tel",get value(){return r().phone},onChange:f=>c("phone",f),get placeholder(){return e("employees.enterPhone","Enter phone number")}}),h),s(u,_(wt,{get label(){return e("employees.salary")},type:"number",get value(){return r().salary},onChange:f=>c("salary",f),get placeholder(){return e("employees.enterSalary","Enter annual salary")},required:!0}),h),s(u,_(wt,{get label(){return e("employees.hireDate")},type:"date",get value(){return r().startDate},onChange:f=>c("startDate",f),required:!0}),h),d(h,o),s(h,_(De,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(h,_(De,{variant:"primary",type:"submit",get children(){return e("employees.addEmployee")}}),null),u}})};var vE=G("<div><div></div><div></div><div>"),bE=G("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),_E=G("<div>");const SE=t=>{const{t:e}=ot(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={width:"80px",height:"80px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.5rem",margin:"0 auto 1.5rem auto"},a={"text-align":"center","margin-bottom":"2rem"},c={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},u={color:"var(--text-muted)","font-size":"1rem"},h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"};if(!t.employee)return null;const f=C=>C.split(" ").map(R=>R[0]).join("").toUpperCase(),g=C=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(C),b=C=>new Date(C).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return _(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.employeeDetails")},get children(){return[(()=>{var C=vE(),R=C.firstChild,T=R.nextSibling,E=T.nextSibling;return d(C,a),d(R,o),s(R,()=>f(t.employee.name)),d(T,c),s(T,()=>t.employee.name),d(E,u),s(E,()=>t.employee.position),C})(),(()=>{var C=bE(),R=C.firstChild,T=R.firstChild,E=T.nextSibling,$=R.nextSibling,K=$.firstChild,Z=K.nextSibling,J=$.nextSibling,de=J.firstChild,re=de.nextSibling,I=J.nextSibling,S=I.firstChild,v=S.nextSibling,w=I.nextSibling,P=w.firstChild,A=P.nextSibling,y=w.nextSibling,se=y.firstChild,W=se.nextSibling;return s(T,()=>e("employees.employeeId")),s(E,()=>t.employee.id),s(K,()=>e("employees.department")),s(Z,()=>t.employee.department),s(de,()=>e("employees.email")),s(re,()=>t.employee.email),s(S,()=>e("employees.phone")),s(v,()=>t.employee.phone),s(P,()=>e("employees.salary")),s(A,()=>g(t.employee.salary)),s(se,()=>e("employees.hireDate")),s(W,()=>b(t.employee.startDate)),ie(k=>{var H=r,V=n,O=i,D=r,M=n,he=i,z=r,pe=n,x=i,F=r,ee=n,Q=i,ue=r,te=n,B=i,ae=r,ve=n,be=i;return k.e=d(R,H,k.e),k.t=d(T,V,k.t),k.a=d(E,O,k.a),k.o=d($,D,k.o),k.i=d(K,M,k.i),k.n=d(Z,he,k.n),k.s=d(J,z,k.s),k.h=d(de,pe,k.h),k.r=d(re,x,k.r),k.d=d(I,F,k.d),k.l=d(S,ee,k.l),k.u=d(v,Q,k.u),k.c=d(w,ue,k.c),k.w=d(P,te,k.w),k.m=d(A,B,k.m),k.f=d(y,ae,k.f),k.y=d(se,ve,k.y),k.g=d(W,be,k.g),k},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),C})(),(()=>{var C=_E();return d(C,h),s(C,_(De,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(C,_(De,{variant:"primary",onClick:()=>{console.log("Edit employee:",t.employee.id)},get children(){return e("employees.editEmployee")}}),null),C})()]}})};var Qh=G("<div>"),PE=G("<div><div></div><div><div></div><div></div><div>/year");const wE=()=>{const{t}=ot(),[e,r]=ge(!1),[n,i]=ge(!1),[o,a]=ge(null),c=T=>{a(T),i(!0)},u={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},h={display:"flex","align-items":"center",gap:"1rem"},f={width:"60px",height:"60px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.2rem"},g={flex:"1"},b={"font-weight":"600","margin-bottom":"0.25rem"},C={color:"var(--text-muted)","font-size":"0.875rem","margin-bottom":"0.5rem"},R={color:"var(--primary-color)","font-weight":"500"};return _(Dr,{get title(){return t("employees.title")},get children(){return[(()=>{var T=Qh();return T.style.setProperty("margin-bottom","2rem"),s(T,_(De,{variant:"primary",onClick:()=>r(!0),get children(){return t("employees.addEmployee")}})),T})(),(()=>{var T=Qh();return d(T,u),s(T,()=>yg.employees.map(E=>{const $=Z=>Z.split(" ").map(J=>J[0]).join("").toUpperCase(),K=Z=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Z);return _(We,{onClick:()=>c(E),get children(){var Z=PE(),J=Z.firstChild,de=J.nextSibling,re=de.firstChild,I=re.nextSibling,S=I.nextSibling,v=S.firstChild;return d(Z,h),d(J,f),s(J,()=>$(E.name)),d(de,g),d(re,b),s(re,()=>E.name),d(I,C),s(I,()=>E.position),d(S,R),s(S,()=>K(E.salary),v),Z}})})),T})(),_(pE,{get isOpen(){return e()},onClose:()=>r(!1)}),_(SE,{get isOpen(){return n()},onClose:()=>i(!1),get employee(){return o()}})]}})},CE=[{id:"1",accountId:"1002",bankName:"First National Bank",accountNumber:"****1234",accountType:"checking",currency:"USD",currentBalance:32730.5,lastReconciledDate:"2024-01-01",lastReconciledBalance:3e4,isActive:!0},{id:"2",accountId:"1003",bankName:"First National Bank",accountNumber:"****5678",accountType:"savings",currency:"USD",currentBalance:12e3,lastReconciledDate:"2024-01-01",lastReconciledBalance:1e4,isActive:!0}],AE=[{id:"1",accountId:"1002",date:"2024-01-15",description:"Customer Payment - ABC Corp",reference:"CHK001234",debitAmount:5e3,creditAmount:0,balance:35730.5,category:"Customer Payment",isReconciled:!0,reconciledWith:"eb1",importedAt:"2024-01-16",source:"csv_import"},{id:"2",accountId:"1002",date:"2024-01-14",description:"Office Supplies - Staples",reference:"CHK001235",debitAmount:0,creditAmount:250,balance:30730.5,category:"Office Expenses",isReconciled:!0,reconciledWith:"eb2",importedAt:"2024-01-16",source:"csv_import"},{id:"3",accountId:"1002",date:"2024-01-13",description:"Monthly Rent Payment",reference:"CHK001236",debitAmount:0,creditAmount:2e3,balance:28730.5,category:"Rent",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"},{id:"4",accountId:"1002",date:"2024-01-12",description:"Wire Transfer In",reference:"WIRE001",debitAmount:1e4,creditAmount:0,balance:38730.5,category:"Wire Transfer",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"}],IE=[{id:"eb1",accountId:"1002",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",debitAmount:5e3,creditAmount:0,category:"Accounts Receivable",isReconciled:!0,reconciledWith:"1",createdAt:"2024-01-15"},{id:"eb2",accountId:"1002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",debitAmount:0,creditAmount:250,category:"Office Expenses",isReconciled:!0,reconciledWith:"2",createdAt:"2024-01-14"},{id:"eb3",accountId:"1002",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",debitAmount:0,creditAmount:3500,category:"Salary Expense",isReconciled:!1,createdAt:"2024-01-11"}],EE=[{id:"1",bankAccountId:"1",periodStart:"2024-01-01",periodEnd:"2024-01-15",startingBalance:3e4,endingBalance:35730.5,status:"in_progress",totalBankTransactions:4,totalEntryBookRecords:3,reconciledTransactions:2,unreconciledTransactions:2,discrepancyAmount:1500,createdAt:"2024-01-16",notes:"Wire transfer and rent payment need investigation"}],[js,Jh]=ge(CE),[Mn,El]=ge(AE),[xo,Xh]=ge(IE),[zs,Zh]=ge(EE),or={get bankAccounts(){return js()},addBankAccount(t){const e={...t,id:Date.now().toString()};return Jh([...js(),e]),e},updateBankAccount(t,e){Jh(js().map(r=>r.id===t?{...r,...e}:r))},getBankAccountById(t){return js().find(e=>e.id===t)},get bankStatements(){return Mn()},addBankStatement(t){const e={...t,id:Date.now().toString(),importedAt:new Date().toISOString()};return El([...Mn(),e]),e},addBankStatementsFromCSV(t){const e=t.map(r=>({...r,id:`csv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,importedAt:new Date().toISOString(),source:"csv_import",isReconciled:!1}));return El([...Mn(),...e]),e},updateBankStatement(t,e){El(Mn().map(r=>r.id===t?{...r,...e}:r))},getBankStatementsByAccount(t){return Mn().filter(e=>e.accountId===t)},getUnreconciledBankStatements(t){return(t?this.getBankStatementsByAccount(t):Mn()).filter(r=>!r.isReconciled)},get entryBookRecords(){return xo()},addEntryBookRecord(t){const e={...t,id:Date.now().toString(),createdAt:new Date().toISOString()};return Xh([...xo(),e]),e},updateEntryBookRecord(t,e){Xh(xo().map(r=>r.id===t?{...r,...e}:r))},getEntryBookRecordsByAccount(t){return xo().filter(e=>e.accountId===t)},getUnreconciledEntryBookRecords(t){return(t?this.getEntryBookRecordsByAccount(t):xo()).filter(r=>!r.isReconciled)},reconcileTransaction(t,e){this.updateBankStatement(t,{isReconciled:!0,reconciledWith:e}),this.updateEntryBookRecord(e,{isReconciled:!0,reconciledWith:t})},unreconciledTransaction(t){const e=Mn().find(r=>r.id===t);e?.reconciledWith&&this.updateEntryBookRecord(e.reconciledWith,{isReconciled:!1,reconciledWith:void 0}),this.updateBankStatement(t,{isReconciled:!1,reconciledWith:void 0})},findPotentialMatches(t){const e=Mn().find(n=>n.id===t);return e?this.getUnreconciledEntryBookRecords(e.accountId).filter(n=>{const i=Math.abs(e.debitAmount-n.debitAmount)<.01||Math.abs(e.creditAmount-n.creditAmount)<.01,o=new Date(e.date),a=new Date(n.date),u=Math.abs((o.getTime()-a.getTime())/(1e3*60*60*24))<=3,h=e.reference===n.reference||e.description.toLowerCase().includes(n.description.toLowerCase())||n.description.toLowerCase().includes(e.description.toLowerCase());return i&&(u||h)}).sort((n,i)=>{const o=(n.date===e.date?2:0)+(n.reference===e.reference?1:0);return(i.date===e.date?2:0)+(i.reference===e.reference?1:0)-o}):[]},get reconciliationSessions(){return zs()},startReconciliationSession(t,e,r){const n=this.getBankStatementsByAccount(t).filter(h=>h.date>=e&&h.date<=r),i=this.getEntryBookRecordsByAccount(t).filter(h=>h.date>=e&&h.date<=r),o=n.filter(h=>h.isReconciled).length,a=this.getBankAccountById(t)?.lastReconciledBalance||0,c=this.getBankAccountById(t)?.currentBalance||0,u={id:Date.now().toString(),bankAccountId:t,periodStart:e,periodEnd:r,startingBalance:a,endingBalance:c,status:"in_progress",totalBankTransactions:n.length,totalEntryBookRecords:i.length,reconciledTransactions:o,unreconciledTransactions:n.length-o,discrepancyAmount:0,createdAt:new Date().toISOString()};return Zh([...zs(),u]),u},updateReconciliationSession(t,e){Zh(zs().map(r=>r.id===t?{...r,...e}:r))},getReconciliationSessionsByAccount(t){return zs().filter(e=>e.bankAccountId===t)}};var xl=G("<div>"),xE=G("<div><strong>:</strong> <!> - "),TE=G("<div><div><div>📄</div><div></div><div></div></div><input id=csvFileInput type=file accept=.csv>"),$E=G("<div><h4></h4><div><div><label> *</label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value>"),Fi=G("<option>"),kE=G("<div><table><thead><tr></tr></thead><tbody>"),RE=G("<th>"),DE=G("<tr>"),NE=G("<td>");const LE=t=>{const{t:e}=ot(),[r,n]=ge(!1),[i,o]=ge(!1),[a,c]=ge(null),[u,h]=ge([]),[f,g]=ge({date:"",description:"",reference:"",debit:"",credit:"",balance:""}),b={border:`2px dashed ${r()?"var(--primary-color)":"var(--border-color)"}`,"border-radius":"var(--border-radius)",padding:"2rem","text-align":"center","background-color":r()?"var(--background-color)":"transparent",transition:"all 0.2s ease",cursor:"pointer"},C={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem","margin-top":"1.5rem"},R={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-family":"inherit"},T={"max-height":"200px","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},E={width:"100%","border-collapse":"collapse","font-size":"0.875rem"},$={padding:"0.5rem","border-bottom":"1px solid var(--border-color)","text-align":"left"},K={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},Z=A=>{A.preventDefault(),n(!0)},J=A=>{A.preventDefault(),n(!1)},de=A=>{A.preventDefault(),n(!1);const y=A.dataTransfer?.files;y&&y.length>0&&I(y[0])},re=A=>{const y=A.target;y.files&&y.files.length>0&&I(y.files[0])},I=A=>{if(!A.name.toLowerCase().endsWith(".csv")){c({success:!1,message:e("banking.pleaseUploadCSV")});return}o(!0);const y=new FileReader;y.onload=se=>{try{const k=(se.target?.result).split(`
`).filter(D=>D.trim());if(k.length<2){c({success:!1,message:e("banking.csvRequiresHeaderAndData")}),o(!1);return}const H=k[0].split(",").map(D=>D.trim().replace(/[\"\']/g,"")),V=k.slice(1).map(D=>{const M=D.split(",").map(z=>z.trim().replace(/[\"\']/g,"")),he={};return H.forEach((z,pe)=>{he[z]=M[pe]||""}),he});h(V),c({success:!0,message:e("banking.successfullyParsed").replace("{count}",V.length.toString()),count:V.length});const O={...f()};H.forEach(D=>{const M=D.toLowerCase();M.includes("date")&&(O.date=D),(M.includes("description")||M.includes("memo"))&&(O.description=D),(M.includes("reference")||M.includes("check")||M.includes("ref"))&&(O.reference=D),(M.includes("debit")||M.includes("deposit"))&&(O.debit=D),(M.includes("credit")||M.includes("withdrawal")||M.includes("amount"))&&(O.debit?O.credit=D:O.debit=D),M.includes("balance")&&(O.balance=D)}),g(O)}catch{c({success:!1,message:e("banking.errorParsingCSV")})}o(!1)},y.readAsText(A)},S=(A,y)=>{g(se=>({...se,[A]:y}))},v=()=>u().length===0?[]:Object.keys(u()[0]),w=()=>{if(!t.bankAccount||u().length===0)return;const A=f();if(!A.date||!A.description){c({success:!1,message:e("banking.dateDescriptionRequired")});return}o(!0);try{const y=u().map(W=>{const k=D=>D&&parseFloat(D.replace(/[^0-9.-]/g,""))||0,H=D=>{const M=new Date(D);if(isNaN(M.getTime())){const he=D.split("/");if(he.length===3)return new Date(parseInt(he[2]),parseInt(he[0])-1,parseInt(he[1])).toISOString().split("T")[0]}return M.toISOString().split("T")[0]};let V=0,O=0;if(A.debit&&A.credit)V=k(W[A.debit]),O=k(W[A.credit]);else if(A.debit){const D=k(W[A.debit]);D>0?V=D:O=Math.abs(D)}return{accountId:t.bankAccount.accountId,date:H(W[A.date]),description:W[A.description]||e("banking.importedTransaction"),reference:W[A.reference]||"",debitAmount:V,creditAmount:O,balance:A.balance?k(W[A.balance]):0,isReconciled:!1}}),se=or.addBankStatementsFromCSV(y);c({success:!0,message:e("banking.successfullyImported").replace("{count}",se.length.toString()),count:se.length}),h([]),g({date:"",description:"",reference:"",debit:"",credit:"",balance:""})}catch{c({success:!1,message:e("banking.errorImportingTransactions")})}o(!1)},P=()=>{h([]),c(null),g({date:"",description:"",reference:"",debit:"",credit:"",balance:""})};return _(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("banking.importBankStatementCSV")},get children(){return[me(()=>me(()=>!!t.bankAccount)()&&(()=>{var A=xE(),y=A.firstChild,se=y.firstChild,W=y.nextSibling,k=W.nextSibling;return k.nextSibling,A.style.setProperty("margin-bottom","1.5rem"),A.style.setProperty("padding","1rem"),A.style.setProperty("background","var(--background-color)"),A.style.setProperty("border-radius","var(--border-radius-sm)"),A.style.setProperty("border","1px solid var(--border-color)"),s(y,()=>e("banking.bankAccount"),se),s(A,()=>t.bankAccount.bankName,k),s(A,()=>t.bankAccount.accountNumber,null),A})()),me(()=>me(()=>u().length===0)()?(()=>{var A=TE(),y=A.firstChild,se=y.firstChild,W=se.nextSibling,k=W.nextSibling,H=y.nextSibling;return y.$$click=()=>document.getElementById("csvFileInput")?.click(),y.addEventListener("drop",de),y.addEventListener("dragleave",J),y.addEventListener("dragover",Z),se.style.setProperty("font-size","2rem"),se.style.setProperty("margin-bottom","1rem"),W.style.setProperty("font-weight","500"),W.style.setProperty("margin-bottom","0.5rem"),s(W,(()=>{var V=me(()=>!!r());return()=>V()?e("banking.dropCSVHere"):e("banking.clickToUploadCSV")})()),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("color","var(--text-muted)"),s(k,()=>e("banking.supportedFormat")),H.addEventListener("change",re),H.style.setProperty("display","none"),ie(V=>d(y,b,V)),A})():(()=>{var A=$E(),y=A.firstChild,se=y.nextSibling,W=se.firstChild,k=W.firstChild,H=k.firstChild,V=k.nextSibling,O=V.firstChild,D=W.nextSibling,M=D.firstChild,he=M.firstChild,z=M.nextSibling,pe=z.firstChild,x=D.nextSibling,F=x.firstChild,ee=F.nextSibling,Q=ee.firstChild,ue=x.nextSibling,te=ue.firstChild,B=te.firstChild,ae=te.nextSibling,ve=ae.firstChild,be=ue.nextSibling,oe=be.firstChild,ce=oe.nextSibling,Y=ce.firstChild,q=be.nextSibling,N=q.firstChild,ne=N.nextSibling,fe=ne.firstChild;return y.style.setProperty("margin","0 0 1rem 0"),s(y,()=>e("banking.mapCSVColumns")),d(se,C),k.style.setProperty("display","block"),k.style.setProperty("margin-bottom","0.5rem"),k.style.setProperty("font-weight","500"),s(k,()=>e("banking.dateColumn"),H),V.addEventListener("change",U=>S("date",U.target.value)),s(O,()=>e("banking.selectColumn")),s(V,()=>v().map(U=>(()=>{var j=Fi();return j.value=U,s(j,U),j})()),null),M.style.setProperty("display","block"),M.style.setProperty("margin-bottom","0.5rem"),M.style.setProperty("font-weight","500"),s(M,()=>e("banking.descriptionColumn"),he),z.addEventListener("change",U=>S("description",U.target.value)),s(pe,()=>e("banking.selectColumn")),s(z,()=>v().map(U=>(()=>{var j=Fi();return j.value=U,s(j,U),j})()),null),F.style.setProperty("display","block"),F.style.setProperty("margin-bottom","0.5rem"),F.style.setProperty("font-weight","500"),s(F,()=>e("banking.referenceColumn")),ee.addEventListener("change",U=>S("reference",U.target.value)),s(Q,()=>e("banking.selectColumn")),s(ee,()=>v().map(U=>(()=>{var j=Fi();return j.value=U,s(j,U),j})()),null),te.style.setProperty("display","block"),te.style.setProperty("margin-bottom","0.5rem"),te.style.setProperty("font-weight","500"),s(te,()=>e("banking.amountDebitColumn"),B),ae.addEventListener("change",U=>S("debit",U.target.value)),s(ve,()=>e("banking.selectColumn")),s(ae,()=>v().map(U=>(()=>{var j=Fi();return j.value=U,s(j,U),j})()),null),oe.style.setProperty("display","block"),oe.style.setProperty("margin-bottom","0.5rem"),oe.style.setProperty("font-weight","500"),s(oe,()=>e("banking.creditColumn")),ce.addEventListener("change",U=>S("credit",U.target.value)),s(Y,()=>e("banking.selectColumn")),s(ce,()=>v().map(U=>(()=>{var j=Fi();return j.value=U,s(j,U),j})()),null),N.style.setProperty("display","block"),N.style.setProperty("margin-bottom","0.5rem"),N.style.setProperty("font-weight","500"),s(N,()=>e("banking.balanceColumn")),ne.addEventListener("change",U=>S("balance",U.target.value)),s(fe,()=>e("banking.selectColumn")),s(ne,()=>v().map(U=>(()=>{var j=Fi();return j.value=U,s(j,U),j})()),null),s(A,(()=>{var U=me(()=>u().length>0);return()=>U()&&(()=>{var j=kE(),Se=j.firstChild,we=Se.firstChild,le=we.firstChild,ye=we.nextSibling;return d(j,T),le.style.setProperty("background-color","var(--background-color)"),s(le,()=>v().slice(0,6).map(X=>(()=>{var Pe=RE();return s(Pe,X),ie(ke=>d(Pe,$,ke)),Pe})())),s(ye,()=>u().slice(0,3).map(X=>(()=>{var Pe=DE();return s(Pe,()=>v().slice(0,6).map(ke=>(()=>{var Te=NE();return s(Te,()=>X[ke]),ie($e=>d(Te,$,$e)),Te})())),Pe})())),s(j,(()=>{var X=me(()=>u().length>3);return()=>X()&&(()=>{var Pe=xl();return Pe.style.setProperty("padding","0.5rem"),Pe.style.setProperty("text-align","center"),Pe.style.setProperty("color","var(--text-muted)"),s(Pe,()=>e("banking.andMoreRows").replace("{count}",(u().length-3).toString())),Pe})()})(),null),ie(X=>d(Se,E,X)),j})()})(),null),ie(U=>{var j=R,Se=R,we=R,le=R,ye=R,X=R;return U.e=d(V,j,U.e),U.t=d(z,Se,U.t),U.a=d(ee,we,U.a),U.o=d(ae,le,U.o),U.i=d(ce,ye,U.i),U.n=d(ne,X,U.n),U},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),ie(()=>V.value=f().date),ie(()=>z.value=f().description),ie(()=>ee.value=f().reference),ie(()=>ae.value=f().debit),ie(()=>ce.value=f().credit),ie(()=>ne.value=f().balance),A})()),me(()=>me(()=>!!a())()&&(()=>{var A=xl();return A.style.setProperty("padding","1rem"),A.style.setProperty("border-radius","var(--border-radius-sm)"),A.style.setProperty("margin-top","1rem"),s(A,()=>a().message),ie(y=>{var se=a().success?"#d4edda":"#f8d7da",W=a().success?"#155724":"#721c24",k=`1px solid ${a().success?"#c3e6cb":"#f5c6cb"}`;return se!==y.e&&((y.e=se)!=null?A.style.setProperty("background",se):A.style.removeProperty("background")),W!==y.t&&((y.t=W)!=null?A.style.setProperty("color",W):A.style.removeProperty("color")),k!==y.a&&((y.a=k)!=null?A.style.setProperty("border",k):A.style.removeProperty("border")),y},{e:void 0,t:void 0,a:void 0}),A})()),(()=>{var A=xl();return d(A,K),s(A,_(De,{variant:"secondary",onClick:()=>{P(),t.onClose()},get children(){return e("common.cancel")}}),null),s(A,(()=>{var y=me(()=>u().length>0);return()=>y()&&_(De,{variant:"outline",onClick:P,get children(){return e("common.reset")}})})(),null),s(A,(()=>{var y=me(()=>u().length>0);return()=>y()&&_(De,{variant:"primary",onClick:w,get disabled(){return i()||!f().date||!f().description},get children(){return me(()=>!!i())()?e("banking.importing"):e("banking.importTransactions").replace("{count}",u().length.toString())}})})(),null),A})()]}})};_t(["click"]);var em=G("<span>"),qs=G("<div>"),tm=G("<div> "),ME=G("<div><div><h3></h3><div><button></button><button></button><button></button></div></div><div></div><div><div><h4></h4><div></div></div><div><h4></h4><div>"),OE=G("<div><div><div></div><div> • </div></div><div><div>"),Tl=G("<span>✓ "),VE=G("<span>(<!>)"),BE=G("<div><strong>:</strong> "),rm=G("<div><div><div></div><div> • </div></div><div>"),FE=G("<div><div>:</div><div></div><div>");const UE=t=>{const{t:e}=ot(),[r,n]=ge([]),[i,o]=ge([]),[a,c]=ge(null),[u,h]=ge([]),[f,g]=ge("unreconciled");ri(()=>{const k=or.getBankAccountById(t.bankAccountId);if(k){const H=or.getBankStatementsByAccount(k.accountId).filter(O=>O.date>=t.selectedPeriod.start&&O.date<=t.selectedPeriod.end),V=or.getEntryBookRecordsByAccount(k.accountId).filter(O=>O.date>=t.selectedPeriod.start&&O.date<=t.selectedPeriod.end);n(H),o(V)}});const b=()=>{const k=r();switch(f()){case"reconciled":return k.filter(H=>H.isReconciled);case"unreconciled":return k.filter(H=>!H.isReconciled);default:return k}},C=()=>{const k=i();switch(f()){case"reconciled":return k.filter(H=>H.isReconciled);case"unreconciled":return k.filter(H=>!H.isReconciled);default:return k}},R=k=>{if(c(k),k.isReconciled)h([]);else{const H=or.findPotentialMatches(k.id);h(H)}},T=k=>{const H=a();if(H){or.reconcileTransaction(H.id,k.id);const V=or.getBankAccountById(t.bankAccountId);if(V){const O=or.getBankStatementsByAccount(V.accountId).filter(M=>M.date>=t.selectedPeriod.start&&M.date<=t.selectedPeriod.end),D=or.getEntryBookRecordsByAccount(V.accountId).filter(M=>M.date>=t.selectedPeriod.start&&M.date<=t.selectedPeriod.end);n(O),o(D)}c(null),h([])}},E=k=>{or.unreconciledTransaction(k.id);const H=or.getBankAccountById(t.bankAccountId);if(H){const V=or.getBankStatementsByAccount(H.accountId).filter(D=>D.date>=t.selectedPeriod.start&&D.date<=t.selectedPeriod.end),O=or.getEntryBookRecordsByAccount(H.accountId).filter(D=>D.date>=t.selectedPeriod.start&&D.date<=t.selectedPeriod.end);n(V),o(O)}},$={display:"grid","grid-template-columns":"1fr 1fr",gap:"2rem","margin-top":"2rem"},K={height:"600px","overflow-y":"auto"},Z={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},J=k=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:k?"var(--primary-color)":"var(--surface-color)",color:k?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),de=(k,H)=>({display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem","margin-bottom":"0.5rem",background:k?"var(--primary-color)":H?"#e8f5e8":"var(--surface-color)",color:k?"white":"var(--text-primary)","border-radius":"var(--border-radius-sm)",border:`1px solid ${k?"var(--primary-color)":H?"#c3e6cb":"var(--border-color)"}`,cursor:"pointer",transition:"all 0.2s ease"}),re={flex:"1"},I={"font-weight":"500","margin-bottom":"0.25rem"},S={"font-size":"0.875rem",opacity:"0.8"},v=k=>({"font-weight":"600",color:k?"#4caf50":"#f44336"}),w={padding:"0.25rem 0.5rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","margin-left":"0.5rem"},P=k=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(k),A=k=>new Date(k).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),y=k=>{if(!a())return null;const H=a();return(Math.abs(H.debitAmount-k.debitAmount)<.01||Math.abs(H.creditAmount-k.creditAmount)<.01)&&H.date===k.date?(()=>{var D=em();return s(D,()=>e("banking.exactMatch")),ie(M=>d(D,{...w,background:"#d4edda",color:"#155724"},M)),D})():u().includes(k)?(()=>{var D=em();return s(D,()=>e("banking.possibleMatch")),ie(M=>d(D,{...w,background:"#fff3cd",color:"#856404"},M)),D})():null},W=(()=>{const k=r(),H=i(),V=k.filter(D=>D.isReconciled).length,O=H.filter(D=>D.isReconciled).length;return{totalStatements:k.length,totalRecords:H.length,reconciledStatements:V,reconciledRecords:O,unreconciledStatements:k.length-V,unreconciledRecords:H.length-O}})();return(()=>{var k=ME(),H=k.firstChild,V=H.firstChild,O=V.nextSibling,D=O.firstChild,M=D.nextSibling,he=M.nextSibling,z=H.nextSibling,pe=z.nextSibling,x=pe.firstChild,F=x.firstChild,ee=F.nextSibling,Q=x.nextSibling,ue=Q.firstChild,te=ue.nextSibling;return d(H,Z),V.style.setProperty("margin","0"),V.style.setProperty("font-size","1.25rem"),s(V,()=>e("banking.reconciliationComparison")),O.style.setProperty("display","flex"),O.style.setProperty("gap","0.5rem"),D.$$click=()=>g("all"),s(D,()=>e("common.all")),M.$$click=()=>g("unreconciled"),s(M,()=>e("banking.unreconciled")),he.$$click=()=>g("reconciled"),s(he,()=>e("banking.reconciled")),z.style.setProperty("display","grid"),z.style.setProperty("grid-template-columns","repeat(4, 1fr)"),z.style.setProperty("gap","1rem"),z.style.setProperty("margin-bottom","2rem"),s(z,_(We,{get title(){return e("banking.bankStatements")},get subtitle(){return e("banking.totalTransactions")},get children(){return[(()=>{var B=qs();return B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","var(--primary-color)"),s(B,()=>W.totalStatements),B})(),(()=>{var B=tm(),ae=B.firstChild;return B.style.setProperty("font-size","0.875rem"),B.style.setProperty("color","var(--text-muted)"),s(B,()=>W.reconciledStatements,ae),s(B,()=>e("banking.reconciled"),null),B})()]}}),null),s(z,_(We,{get title(){return e("banking.entryBookRecords")},get subtitle(){return e("banking.totalEntries")},get children(){return[(()=>{var B=qs();return B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","var(--primary-color)"),s(B,()=>W.totalRecords),B})(),(()=>{var B=tm(),ae=B.firstChild;return B.style.setProperty("font-size","0.875rem"),B.style.setProperty("color","var(--text-muted)"),s(B,()=>W.reconciledRecords,ae),s(B,()=>e("banking.reconciled"),null),B})()]}}),null),s(z,_(We,{get title(){return e("banking.unreconciledBank")},get subtitle(){return e("banking.needAttention")},get children(){var B=qs();return B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","#f44336"),s(B,()=>W.unreconciledStatements),B}}),null),s(z,_(We,{get title(){return e("banking.unreconciledBooks")},get subtitle(){return e("banking.needAttention")},get children(){var B=qs();return B.style.setProperty("font-size","1.5rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","#f44336"),s(B,()=>W.unreconciledRecords),B}}),null),d(pe,$),F.style.setProperty("margin","0 0 1rem 0"),s(F,()=>e("banking.bankStatements")),s(ee,()=>b().map(B=>(()=>{var ae=OE(),ve=ae.firstChild,be=ve.firstChild,oe=be.nextSibling,ce=oe.firstChild,Y=ve.nextSibling,q=Y.firstChild;return ae.$$click=()=>R(B),s(be,()=>B.description),s(oe,()=>A(B.date),ce),s(oe,()=>B.reference,null),s(oe,(()=>{var N=me(()=>!!B.isReconciled);return()=>N()&&(()=>{var ne=Tl();return ne.firstChild,ne.style.setProperty("color","#4caf50"),ne.style.setProperty("margin-left","0.5rem"),s(ne,()=>e("banking.reconciled"),null),ne})()})(),null),s(q,()=>B.debitAmount>0?"+":"-",null),s(q,()=>P(B.debitAmount||B.creditAmount),null),s(Y,(()=>{var N=me(()=>!!B.isReconciled);return()=>N()&&_(De,{variant:"outline",size:"sm",onClick:ne=>{ne.stopPropagation(),E(B)},style:{"margin-top":"0.5rem"},get children(){return e("banking.unreconcile")}})})(),null),ie(N=>{var ne=de(a()?.id===B.id,B.isReconciled),fe=re,U=I,j=S,Se=v(B.debitAmount>0);return N.e=d(ae,ne,N.e),N.t=d(ve,fe,N.t),N.a=d(be,U,N.a),N.o=d(oe,j,N.o),N.i=d(q,Se,N.i),N},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ae})())),ue.style.setProperty("margin","0 0 1rem 0"),s(ue,()=>e("banking.entryBookRecords"),null),s(ue,(()=>{var B=me(()=>!!(a()&&!a().isReconciled));return()=>B()&&(()=>{var ae=VE(),ve=ae.firstChild,be=ve.nextSibling;return be.nextSibling,ae.style.setProperty("font-weight","400"),ae.style.setProperty("color","var(--text-muted)"),ae.style.setProperty("margin-left","0.5rem"),s(ae,()=>e("banking.clickToReconcile"),be),ae})()})(),null),s(te,(()=>{var B=me(()=>!!(a()&&!a().isReconciled));return()=>B()?[me(()=>me(()=>u().length>0)()&&(()=>{var ae=BE(),ve=ae.firstChild,be=ve.firstChild;return ve.nextSibling,ae.style.setProperty("margin-bottom","1rem"),ae.style.setProperty("padding","0.75rem"),ae.style.setProperty("background","#fff3cd"),ae.style.setProperty("border-radius","var(--border-radius-sm)"),s(ve,()=>e("banking.potentialMatchesFound"),be),s(ae,()=>e("banking.clickRecordToReconcile"),null),ae})()),me(()=>C().map(ae=>(u().includes(ae),(()=>{var ve=rm(),be=ve.firstChild,oe=be.firstChild,ce=oe.nextSibling,Y=ce.firstChild,q=be.nextSibling;return ve.$$click=()=>{ae.isReconciled||T(ae)},s(oe,()=>ae.description,null),s(oe,()=>y(ae),null),s(ce,()=>A(ae.date),Y),s(ce,()=>ae.reference,null),s(ce,(()=>{var N=me(()=>!!ae.isReconciled);return()=>N()&&(()=>{var ne=Tl();return ne.firstChild,ne.style.setProperty("color","#4caf50"),ne.style.setProperty("margin-left","0.5rem"),s(ne,()=>e("banking.reconciled"),null),ne})()})(),null),s(q,()=>ae.debitAmount>0?"+":"-",null),s(q,()=>P(ae.debitAmount||ae.creditAmount),null),ie(N=>{var ne={...de(!1,ae.isReconciled),opacity:ae.isReconciled?.6:1,cursor:ae.isReconciled?"not-allowed":"pointer"},fe=re,U=I,j=S,Se=v(ae.debitAmount>0);return N.e=d(ve,ne,N.e),N.t=d(be,fe,N.t),N.a=d(oe,U,N.a),N.o=d(ce,j,N.o),N.i=d(q,Se,N.i),N},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ve})())))]:C().map(ae=>(()=>{var ve=rm(),be=ve.firstChild,oe=be.firstChild,ce=oe.nextSibling,Y=ce.firstChild,q=be.nextSibling;return s(oe,()=>ae.description),s(ce,()=>A(ae.date),Y),s(ce,()=>ae.reference,null),s(ce,(()=>{var N=me(()=>!!ae.isReconciled);return()=>N()&&(()=>{var ne=Tl();return ne.firstChild,ne.style.setProperty("color","#4caf50"),ne.style.setProperty("margin-left","0.5rem"),s(ne,()=>e("banking.reconciled"),null),ne})()})(),null),s(q,()=>ae.debitAmount>0?"+":"-",null),s(q,()=>P(ae.debitAmount||ae.creditAmount),null),ie(N=>{var ne=de(!1,ae.isReconciled),fe=re,U=I,j=S,Se=v(ae.debitAmount>0);return N.e=d(ve,ne,N.e),N.t=d(be,fe,N.t),N.a=d(oe,U,N.a),N.o=d(ce,j,N.o),N.i=d(q,Se,N.i),N},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ve})())})()),s(k,(()=>{var B=me(()=>!!(a()&&!a().isReconciled));return()=>B()&&(()=>{var ae=FE(),ve=ae.firstChild,be=ve.firstChild,oe=ve.nextSibling,ce=oe.nextSibling;return ae.style.setProperty("position","fixed"),ae.style.setProperty("bottom","2rem"),ae.style.setProperty("right","2rem"),ae.style.setProperty("background","var(--surface-color)"),ae.style.setProperty("padding","1rem"),ae.style.setProperty("border-radius","var(--border-radius)"),ae.style.setProperty("box-shadow","var(--shadow-lg)"),ae.style.setProperty("border","1px solid var(--border-color)"),ae.style.setProperty("max-width","300px"),ve.style.setProperty("font-weight","500"),ve.style.setProperty("margin-bottom","0.5rem"),s(ve,()=>e("banking.selected"),be),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("margin-bottom","0.5rem"),s(oe,()=>a().description),ce.style.setProperty("font-weight","600"),ce.style.setProperty("color","var(--primary-color)"),s(ce,()=>P(a().debitAmount||a().creditAmount)),s(ae,_(De,{variant:"secondary",size:"sm",onClick:()=>{c(null),h([])},style:{"margin-top":"0.5rem"},get children(){return e("banking.clearSelection")}}),null),ae})()})(),null),ie(B=>{var ae=J(f()==="all"),ve=J(f()==="unreconciled"),be=J(f()==="reconciled"),oe=K,ce=K;return B.e=d(D,ae,B.e),B.t=d(M,ve,B.t),B.a=d(he,be,B.a),B.o=d(ee,oe,B.o),B.i=d(te,ce,B.i),B},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),k})()};_t(["click"]);var jE=G("<div><div><h2></h2><p></p></div><div>"),zE=G("<div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date>"),qE=G("<div><button></button><button>"),HE=G("<div><br>"),To=G("<div>"),GE=G("<div><div></div><div> • </div><div>"),WE=G("<div>: "),YE=G("<div> <!> • <!> "),KE=G("<div>%"),QE=G("<div> of <!> transactions");const JE=()=>{const{t}=ot(),[e,r]=ge(null),[n,i]=ge({start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[o,a]=ge(!1),[c,u]=ge("overview");ri(()=>{!e()&&or.bankAccounts.length>0&&r(or.bankAccounts[0])});const h={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},f={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},g={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},b=Z=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:Z?"var(--primary-color)":"var(--text-muted)","border-bottom":Z?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),C={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},R=Z=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Z),T=Z=>new Date(Z).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),E=()=>or.bankAccounts.map(Z=>({value:Z.id,label:`${Z.bankName} - ${Z.accountNumber} (${Z.accountType})`})),K=(()=>{if(!e())return null;const Z=or.getBankStatementsByAccount(e().accountId).filter(re=>re.date>=n().start&&re.date<=n().end),J=or.getEntryBookRecordsByAccount(e().accountId).filter(re=>re.date>=n().start&&re.date<=n().end),de=Z.filter(re=>re.isReconciled).length;return J.filter(re=>re.isReconciled).length,{totalBankTransactions:Z.length,totalEntryBookRecords:J.length,reconciledTransactions:de,unreconciledTransactions:Z.length-de,reconciliationRate:Z.length>0?de/Z.length*100:0}})();return _(Dr,{get title(){return t("banking.title")},get children(){return[(()=>{var Z=jE(),J=Z.firstChild,de=J.firstChild,re=de.nextSibling,I=J.nextSibling;return d(Z,h),de.style.setProperty("margin","0 0 0.5rem 0"),de.style.setProperty("font-size","1.5rem"),s(de,()=>t("banking.reconciliation")),re.style.setProperty("margin","0"),re.style.setProperty("color","var(--text-muted)"),s(re,()=>t("banking.compareStatements")),I.style.setProperty("display","flex"),I.style.setProperty("gap","1rem"),s(I,_(De,{variant:"secondary",onClick:()=>a(!0),get disabled(){return!e()},get children(){return t("banking.importCSV")}}),null),s(I,_(De,{variant:"primary",get children(){return t("banking.startNewReconciliation")}}),null),Z})(),(()=>{var Z=zE(),J=Z.firstChild,de=J.firstChild,re=J.nextSibling,I=re.firstChild,S=I.nextSibling,v=re.nextSibling,w=v.firstChild,P=w.nextSibling;return d(Z,f),J.style.setProperty("flex","1"),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),s(de,()=>t("banking.bankAccount")),s(J,_(hr,{label:"",get value(){return e()?.id||""},onChange:A=>{const y=or.getBankAccountById(A);r(y||null)},get options(){return E()}}),null),I.style.setProperty("display","block"),I.style.setProperty("margin-bottom","0.5rem"),I.style.setProperty("font-weight","500"),s(I,()=>t("entryBooks.startDate")),S.addEventListener("change",A=>i(y=>({...y,start:A.target.value}))),S.style.setProperty("padding","0.75rem"),S.style.setProperty("border","1px solid var(--border-color)"),S.style.setProperty("border-radius","var(--border-radius-sm)"),S.style.setProperty("font-family","inherit"),w.style.setProperty("display","block"),w.style.setProperty("margin-bottom","0.5rem"),w.style.setProperty("font-weight","500"),s(w,()=>t("entryBooks.endDate")),P.addEventListener("change",A=>i(y=>({...y,end:A.target.value}))),P.style.setProperty("padding","0.75rem"),P.style.setProperty("border","1px solid var(--border-color)"),P.style.setProperty("border-radius","var(--border-radius-sm)"),P.style.setProperty("font-family","inherit"),ie(()=>S.value=n().start),ie(()=>P.value=n().end),Z})(),(()=>{var Z=qE(),J=Z.firstChild,de=J.nextSibling;return d(Z,g),J.$$click=()=>u("overview"),s(J,()=>t("common.overview")),de.$$click=()=>u("reconciliation"),s(de,()=>t("banking.reconciliation")),ie(re=>{var I=b(c()==="overview"),S=b(c()==="reconciliation");return re.e=d(J,I,re.e),re.t=d(de,S,re.t),re},{e:void 0,t:void 0}),Z})(),me(()=>me(()=>c()==="overview")()&&(()=>{var Z=To();return s(Z,(()=>{var J=me(()=>!!e());return()=>J()&&(()=>{var de=To();return d(de,C),s(de,_(We,{get title(){return t("banking.bankAccountInfo")},get subtitle(){return t("banking.currentAccountDetails")},get children(){return[(()=>{var re=GE(),I=re.firstChild,S=I.nextSibling,v=S.firstChild,w=S.nextSibling;return re.style.setProperty("margin-bottom","1rem"),I.style.setProperty("font-weight","600"),I.style.setProperty("margin-bottom","0.5rem"),s(I,()=>e().bankName),S.style.setProperty("color","var(--text-muted)"),S.style.setProperty("margin-bottom","0.5rem"),s(S,()=>e().accountNumber,v),s(S,()=>e().accountType,null),w.style.setProperty("font-size","1.25rem"),w.style.setProperty("font-weight","600"),w.style.setProperty("color","var(--primary-color)"),s(w,()=>R(e().currentBalance)),re})(),me(()=>me(()=>!!e().lastReconciledDate)()&&(()=>{var re=WE(),I=re.firstChild;return re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),s(re,()=>t("banking.lastReconciled"),I),s(re,()=>T(e().lastReconciledDate),null),re})())]}}),null),s(de,K&&[_(We,{get title(){return t("banking.bankTransactions")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var re=To();return re.style.setProperty("font-size","1.5rem"),re.style.setProperty("font-weight","600"),re.style.setProperty("color","var(--primary-color)"),re.style.setProperty("margin-bottom","0.5rem"),s(re,()=>K.totalBankTransactions),re})(),(()=>{var re=YE(),I=re.firstChild,S=I.nextSibling,v=S.nextSibling,w=v.nextSibling;return w.nextSibling,re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),s(re,()=>K.reconciledTransactions,I),s(re,()=>t("banking.reconciled"),S),s(re,()=>K.unreconciledTransactions,w),s(re,()=>t("banking.pending"),null),re})()]}}),_(We,{get title(){return t("entryBooks.entryBookRecords")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var re=To();return re.style.setProperty("font-size","1.5rem"),re.style.setProperty("font-weight","600"),re.style.setProperty("color","var(--primary-color)"),re.style.setProperty("margin-bottom","0.5rem"),s(re,()=>K.totalEntryBookRecords),re})(),(()=>{var re=To();return re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),s(re,()=>t("banking.bookEntriesForComparison")),re})()]}}),_(We,{get title(){return t("banking.reconciliationRate")},get subtitle(){return t("banking.completionStatus")},get children(){return[(()=>{var re=KE(),I=re.firstChild;return re.style.setProperty("font-size","1.5rem"),re.style.setProperty("font-weight","600"),re.style.setProperty("margin-bottom","0.5rem"),s(re,()=>Math.round(K.reconciliationRate),I),ie(S=>(S=K.reconciliationRate>80?"#4caf50":K.reconciliationRate>50?"#ff9800":"#f44336")!=null?re.style.setProperty("color",S):re.style.removeProperty("color")),re})(),(()=>{var re=QE(),I=re.firstChild,S=I.nextSibling;return S.nextSibling,re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),s(re,()=>K.reconciledTransactions,I),s(re,()=>K.totalBankTransactions,S),re})()]}})],null),de})()})(),null),s(Z,_(We,{get title(){return t("banking.recentReconciliationSessions")},get subtitle(){return t("banking.latestActivity")},get children(){var J=HE(),de=J.firstChild;return J.style.setProperty("text-align","center"),J.style.setProperty("color","var(--text-muted)"),J.style.setProperty("padding","2rem"),s(J,()=>t("banking.noRecentSessions"),de),s(J,_(De,{variant:"primary",style:{"margin-top":"1rem"},onClick:()=>u("reconciliation"),get children(){return t("banking.startFirstReconciliation")}}),null),J}}),null),Z})()),me(()=>me(()=>!!(c()==="reconciliation"&&e()))()&&_(UE,{get bankAccountId(){return e().id},get selectedPeriod(){return n()}})),_(LE,{get isOpen(){return o()},onClose:()=>a(!1),get bankAccount(){return e()}})]}})};_t(["click"]);var XE=G("<div><div></div><div>"),$l=G("<div>"),ZE=G("<div> • <!> • <!> "),ex=G("<div><div><div></div><div></div></div><div><div></div><div>"),tx=G("<div><div>:"),rx=G("<div>⚠️ <!>: <!> <!>, <!> "),nx=G("<div><div><div></div><div></div></div><div>"),nm=G("<div> "),ix=G("<div>✓ ");const ox=t=>{const{t:e}=ot(),r={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},n={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},i={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},o={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"0.5rem"},a={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"1rem"},c={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},u={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},h={"max-height":"100px","overflow-y":"auto","border-top":"1px solid var(--border-color)","padding-top":"1rem"},f={display:"flex","justify-content":"space-between","align-items":"center","font-size":"0.875rem","margin-bottom":"0.5rem"},g={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},b=$=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[$],C=$=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format($),R=$=>new Date($).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),T=b(t.entry.status),E=Math.abs(t.entry.totalDebit-t.entry.totalCredit)<.01;return _(We,{get children(){return[(()=>{var $=XE(),K=$.firstChild,Z=K.nextSibling;return d($,r),d(K,n),s(K,()=>t.entry.entryNumber),s(Z,()=>t.entry.status),ie(J=>d(Z,{...i,background:T.bg,color:T.color},J)),$})(),(()=>{var $=$l();return d($,o),s($,()=>t.entry.description),$})(),(()=>{var $=ZE(),K=$.firstChild,Z=K.nextSibling,J=Z.nextSibling,de=J.nextSibling;return de.nextSibling,d($,a),s($,()=>R(t.entry.date),K),s($,()=>t.entry.reference||e("journal.noReference","No reference"),Z),s($,()=>e("journal.createdBy","By"),de),s($,()=>t.entry.createdBy,null),$})(),(()=>{var $=ex(),K=$.firstChild,Z=K.firstChild,J=Z.nextSibling,de=K.nextSibling,re=de.firstChild,I=re.nextSibling;return d($,c),Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-muted)"),s(Z,()=>e("journal.totalAmount","Total Amount")),d(J,u),s(J,()=>C(t.entry.totalDebit)),de.style.setProperty("text-align","right"),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),s(re,()=>e("journal.lines","Lines")),I.style.setProperty("font-weight","600"),s(I,()=>t.entry.lines.length),$})(),me(()=>!E&&(()=>{var $=rx(),K=$.firstChild,Z=K.nextSibling,J=Z.nextSibling,de=J.nextSibling,re=de.nextSibling,I=re.nextSibling,S=I.nextSibling,v=S.nextSibling;return v.nextSibling,$.style.setProperty("padding","0.5rem"),$.style.setProperty("border-radius","var(--border-radius-sm)"),$.style.setProperty("background","#f8d7da"),$.style.setProperty("color","#721c24"),$.style.setProperty("font-size","0.875rem"),$.style.setProperty("margin-bottom","1rem"),s($,()=>e("journal.entryNotBalancedShort","Entry is not balanced"),Z),s($,()=>e("journal.debit"),de),s($,()=>C(t.entry.totalDebit),I),s($,()=>e("journal.credit"),v),s($,()=>C(t.entry.totalCredit),null),$})()),(()=>{var $=tx(),K=$.firstChild,Z=K.firstChild;return d($,h),K.style.setProperty("font-weight","500"),K.style.setProperty("margin-bottom","0.5rem"),K.style.setProperty("font-size","0.875rem"),s(K,()=>e("journal.accountLines","Account Lines"),Z),s($,()=>t.entry.lines.slice(0,3).map(J=>(()=>{var de=nx(),re=de.firstChild,I=re.firstChild,S=I.nextSibling,v=re.nextSibling;return d(de,f),re.style.setProperty("flex","1"),I.style.setProperty("font-weight","500"),s(I,()=>J.accountName),S.style.setProperty("font-size","0.75rem"),S.style.setProperty("color","var(--text-muted)"),s(S,()=>J.description||e("journal.noDescription","No description")),v.style.setProperty("text-align","right"),s(v,(()=>{var w=me(()=>J.debitAmount>0);return()=>w()&&(()=>{var P=nm(),A=P.firstChild;return P.style.setProperty("color","#4caf50"),P.style.setProperty("font-weight","500"),s(P,()=>e("journal.debitShort","Dr."),A),s(P,()=>C(J.debitAmount),null),P})()})(),null),s(v,(()=>{var w=me(()=>J.creditAmount>0);return()=>w()&&(()=>{var P=nm(),A=P.firstChild;return P.style.setProperty("color","#f44336"),P.style.setProperty("font-weight","500"),s(P,()=>e("journal.creditShort","Cr."),A),s(P,()=>C(J.creditAmount),null),P})()})(),null),s(v,(()=>{var w=me(()=>!!J.reconciled);return()=>w()&&(()=>{var P=ix();return P.firstChild,P.style.setProperty("font-size","0.75rem"),P.style.setProperty("color","#4caf50"),s(P,()=>e("banking.reconciled","Reconciled"),null),P})()})(),null),de})()),null),s($,(()=>{var J=me(()=>t.entry.lines.length>3);return()=>J()&&(()=>{var de=$l();return de.style.setProperty("text-align","center"),de.style.setProperty("color","var(--text-muted)"),de.style.setProperty("font-size","0.875rem"),s(de,()=>e("journal.andMoreLines","... and {count} more lines").replace("{count}",(t.entry.lines.length-3).toString())),de})()})(),null),$})(),(()=>{var $=$l();return d($,g),s($,_(De,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.entry),get children(){return e("journal.viewDetails","View Details")}})),$})()]}})},sx=[{id:"je1",entryNumber:"JE-2024-001",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",status:"posted",createdBy:"John Doe",createdAt:"2024-01-15T09:00:00Z",postedAt:"2024-01-15T09:05:00Z",totalDebit:5e3,totalCredit:5e3,lines:[{id:"jel1",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment from ABC Corp",debitAmount:5e3,creditAmount:0,reconciled:!0,reconciledWith:"eb1"},{id:"jel2",accountId:"2001",accountName:"Trade Receivables",description:"Payment received for INV-2024-001",debitAmount:0,creditAmount:5e3}]},{id:"je2",entryNumber:"JE-2024-002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",status:"posted",createdBy:"Jane Smith",createdAt:"2024-01-14T10:00:00Z",postedAt:"2024-01-14T10:15:00Z",totalDebit:250,totalCredit:250,lines:[{id:"jel3",accountId:"5200",accountName:"Office Expenses",description:"Office supplies from Staples",debitAmount:250,creditAmount:0},{id:"jel4",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment to Staples",debitAmount:0,creditAmount:250,reconciled:!0,reconciledWith:"eb2"}]},{id:"je3",entryNumber:"JE-2024-003",date:"2024-01-13",description:"Monthly Rent Payment",reference:"RENT-2024-01",status:"posted",createdBy:"John Doe",createdAt:"2024-01-13T08:00:00Z",postedAt:"2024-01-13T08:30:00Z",totalDebit:2e3,totalCredit:2e3,lines:[{id:"jel5",accountId:"5200",accountName:"Rent Expense",description:"January office rent",debitAmount:2e3,creditAmount:0},{id:"jel6",accountId:"1002",accountName:"Bank - Checking Account",description:"Rent payment",debitAmount:0,creditAmount:2e3,reconciled:!1}]},{id:"je4",entryNumber:"JE-2024-004",date:"2024-01-12",description:"Wire Transfer - Capital Investment",reference:"WIRE-001",status:"posted",createdBy:"Admin",createdAt:"2024-01-12T14:00:00Z",postedAt:"2024-01-12T14:30:00Z",totalDebit:1e4,totalCredit:1e4,lines:[{id:"jel7",accountId:"1002",accountName:"Bank - Checking Account",description:"Wire transfer received",debitAmount:1e4,creditAmount:0,reconciled:!1},{id:"jel8",accountId:"8",accountName:"Owner's Equity",description:"Capital investment",debitAmount:0,creditAmount:1e4}]},{id:"je5",entryNumber:"JE-2024-005",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",status:"posted",createdBy:"HR Manager",createdAt:"2024-01-11T16:00:00Z",postedAt:"2024-01-11T16:30:00Z",totalDebit:3500,totalCredit:3500,lines:[{id:"jel9",accountId:"13",accountName:"Salaries Expense",description:"Monthly salary - John Doe",debitAmount:3500,creditAmount:0},{id:"jel10",accountId:"1002",accountName:"Bank - Checking Account",description:"Salary payment",debitAmount:0,creditAmount:3500,reconciled:!1}]},{id:"je6",entryNumber:"JE-2024-006",date:"2024-01-10",description:"Product Sales - Multiple Customers",reference:"SALES-2024-010",status:"posted",createdBy:"Sales Manager",createdAt:"2024-01-10T11:00:00Z",postedAt:"2024-01-10T11:30:00Z",totalDebit:8500,totalCredit:8500,lines:[{id:"jel11",accountId:"1001",accountName:"Petty Cash",description:"Cash sales",debitAmount:1500,creditAmount:0},{id:"jel12",accountId:"2001",accountName:"Trade Receivables",description:"Credit sales",debitAmount:7e3,creditAmount:0},{id:"jel13",accountId:"10",accountName:"Sales Revenue",description:"Product sales revenue",debitAmount:0,creditAmount:8500}]},{id:"je7",entryNumber:"JE-2024-007",date:"2024-01-09",description:"Inventory Purchase",reference:"PO-2024-002",status:"draft",createdBy:"Warehouse Manager",createdAt:"2024-01-09T15:00:00Z",totalDebit:15e3,totalCredit:15e3,lines:[{id:"jel14",accountId:"3",accountName:"Inventory",description:"Product inventory purchase",debitAmount:15e3,creditAmount:0},{id:"jel15",accountId:"5",accountName:"Accounts Payable",description:"Amount owed to supplier",debitAmount:0,creditAmount:15e3}]},{id:"je8",entryNumber:"JE-2024-008",date:"2024-01-08",description:"Utility Bills Payment",reference:"UTIL-2024-01",status:"posted",createdBy:"Admin",createdAt:"2024-01-08T09:00:00Z",postedAt:"2024-01-08T09:30:00Z",totalDebit:450,totalCredit:450,lines:[{id:"jel16",accountId:"14",accountName:"Operating Expenses",description:"Electricity and water bills",debitAmount:450,creditAmount:0},{id:"jel17",accountId:"1003",accountName:"Bank - Savings Account",description:"Utility payment",debitAmount:0,creditAmount:450}]}],[$r,kl]=ge(sx),im=()=>$r().filter(e=>e.status==="posted").flatMap(e=>e.lines.filter(r=>["1001","1002","1003"].includes(r.accountId))).map(e=>{const r=$r().find(n=>n.lines.some(i=>i.id===e.id));return r?{id:`eb_${e.id}`,accountId:e.accountId,date:r.date,description:r.description,reference:r.reference,debitAmount:e.debitAmount,creditAmount:e.creditAmount,category:e.accountName,isReconciled:e.reconciled||!1,reconciledWith:e.reconciledWith,createdAt:r.createdAt}:null}).filter(e=>e!==null),Sn={get journalEntries(){return $r()},addJournalEntry(t){const e={...t,id:Date.now().toString()};return kl([...$r(),e]),e},updateJournalEntry(t,e){kl($r().map(r=>r.id===t?{...r,...e}:r))},deleteJournalEntry(t){const e=$r().find(r=>r.id===t);if(e&&e.status==="posted")throw new Error("Cannot delete posted journal entries. Void them instead.");kl($r().filter(r=>r.id!==t))},voidJournalEntry(t){this.updateJournalEntry(t,{status:"void"})},postJournalEntry(t){const e=$r().find(r=>r.id===t);if(!e)throw new Error("Journal entry not found");if(Math.abs(e.totalDebit-e.totalCredit)>.01)throw new Error("Journal entry is not balanced. Debits must equal credits.");this.updateJournalEntry(t,{status:"posted",postedAt:new Date().toISOString()}),im()},getJournalEntryById(t){return $r().find(e=>e.id===t)},getJournalEntriesByStatus(t){return $r().filter(e=>e.status===t)},getJournalEntriesByDateRange(t,e){return $r().filter(r=>r.date>=t&&r.date<=e)},getJournalEntriesByAccount(t){return $r().filter(e=>e.lines.some(r=>r.accountId===t))},getNextEntryNumber(){const t=new Date().getFullYear(),r=$r().filter(n=>n.entryNumber.includes(t.toString())).reduce((n,i)=>{const o=parseInt(i.entryNumber.split("-").pop()||"0");return o>n?o:n},0);return`JE-${t}-${String(r+1).padStart(3,"0")}`},validateJournalEntry(t){const e=[];if(t.date||e.push("Date is required"),t.description||e.push("Description is required"),(!t.lines||t.lines.length===0)&&e.push("At least one line item is required"),t.lines){const r=t.lines.reduce((i,o)=>i+(o.debitAmount||0),0),n=t.lines.reduce((i,o)=>i+(o.creditAmount||0),0);Math.abs(r-n)>.01&&e.push(`Entry is not balanced. Debit: ${r}, Credit: ${n}`),t.lines.forEach((i,o)=>{i.accountId||e.push(`Line ${o+1}: Account is required`),i.debitAmount===0&&i.creditAmount===0&&e.push(`Line ${o+1}: Either debit or credit amount must be provided`),i.debitAmount>0&&i.creditAmount>0&&e.push(`Line ${o+1}: Cannot have both debit and credit amounts`)})}return{isValid:e.length===0,errors:e}},getBankRelatedEntries(){return im()}};var ax=G("<form><div></div><div><div><h4></h4></div><div><div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div></div></div><div><div><strong>: </strong></div><div><strong>: </strong></div><div></div></div></div><div>"),om=G("<div>");const gg=t=>{const{t:e}=ot(),[r,n]=ge({entryNumber:"",date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),[i,o]=ge([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),[a,c]=ge(null);ri(()=>{if(t.isOpen){if(t.editEntry)n({entryNumber:t.editEntry.entryNumber,date:t.editEntry.date,description:t.editEntry.description,reference:t.editEntry.reference,createdBy:t.editEntry.createdBy}),o(t.editEntry.lines.map((J,de)=>({...J,tempId:`line_${Date.now()}_${de}`})));else{const J=Sn.getNextEntryNumber();n({entryNumber:J,date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),o([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])}c(null)}});const u={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},h={display:"grid","grid-template-columns":"2fr 2fr 1fr 1fr 1fr",gap:"1rem","align-items":"end","margin-bottom":"1rem",padding:"1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},f={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},g=()=>ut.accounts.map(J=>({value:J.id,label:`${J.accountNumber} - ${J.name}`})),b=(J,de)=>{n(re=>({...re,[J]:de}))},C=(J,de,re)=>{o(I=>I.map(S=>{if(S.tempId===J){const v={...S,[de]:re};if(de==="accountId"&&typeof re=="string"){const w=ut.getAccountById(re);w&&(v.accountName=w.name)}return v}return S}))},R=()=>{o(J=>[...J,{tempId:`line_${Date.now()}_${J.length}`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])},T=J=>{i().length>2&&o(de=>de.filter(re=>re.tempId!==J))},E=()=>{const J=i().reduce((re,I)=>re+(I.debitAmount||0),0),de=i().reduce((re,I)=>re+(I.creditAmount||0),0);return{totalDebit:J,totalCredit:de,isBalanced:Math.abs(J-de)<.01}},$=J=>{J.preventDefault(),c(null);const de=r(),re=i(),{totalDebit:I,totalCredit:S,isBalanced:v}=E();if(!de.description){c(e("forms.descriptionRequired","Description is required"));return}if(re.length<2){c(e("journal.minTwoLinesRequired","At least 2 line items are required"));return}if(!v){c(e("journal.entryNotBalanced","Entry is not balanced. Debit: ${debit}, Credit: ${credit}").replace("${debit}",`$${I.toFixed(2)}`).replace("${credit}",`$${S.toFixed(2)}`));return}for(let P=0;P<re.length;P++){const A=re[P];if(!A.accountId){c(e("journal.lineAccountRequired","Line {lineNumber}: Account is required").replace("{lineNumber}",(P+1).toString()));return}if(A.debitAmount===0&&A.creditAmount===0){c(e("journal.lineAmountRequired","Line {lineNumber}: Either debit or credit amount must be provided").replace("{lineNumber}",(P+1).toString()));return}if((A.debitAmount||0)>0&&(A.creditAmount||0)>0){c(e("journal.lineBothAmounts","Line {lineNumber}: Cannot have both debit and credit amounts").replace("{lineNumber}",(P+1).toString()));return}}const w={entryNumber:de.entryNumber,date:de.date,description:de.description,reference:de.reference,status:"draft",createdBy:de.createdBy,createdAt:new Date().toISOString(),totalDebit:I,totalCredit:S,lines:re.map((P,A)=>{const{tempId:y,...se}=P;return{id:`jel_${Date.now()}_${A}`,...se}})};try{t.editEntry?Sn.updateJournalEntry(t.editEntry.id,w):Sn.addJournalEntry(w),n({entryNumber:Sn.getNextEntryNumber(),date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),o([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),t.onClose()}catch(P){c(P instanceof Error?P.message:e("forms.errorOccurred","An error occurred"))}},K=J=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(J),Z=E();return _(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return me(()=>!!t.editEntry)()?e("journal.editEntry"):e("journal.addEntry","Add Journal Entry")},get children(){var J=ax(),de=J.firstChild,re=de.nextSibling,I=re.firstChild,S=I.firstChild,v=I.nextSibling,w=v.firstChild,P=w.firstChild,A=P.firstChild,y=P.nextSibling,se=y.firstChild,W=y.nextSibling,k=W.firstChild,H=W.nextSibling,V=H.firstChild,O=H.nextSibling,D=O.firstChild,M=v.nextSibling,he=M.firstChild,z=he.firstChild,pe=z.firstChild,x=he.nextSibling,F=x.firstChild,ee=F.firstChild,Q=x.nextSibling,ue=re.nextSibling;return J.addEventListener("submit",$),de.style.setProperty("display","grid"),de.style.setProperty("grid-template-columns","1fr 1fr"),de.style.setProperty("gap","1rem"),s(de,_(wt,{get label(){return e("journal.entryNumber")},get value(){return r().entryNumber},onChange:te=>b("entryNumber",te),get disabled(){return!!t.editEntry},required:!0}),null),s(de,_(wt,{get label(){return e("common.date")},type:"date",get value(){return r().date},onChange:te=>b("date",te),required:!0}),null),s(J,_(wt,{get label(){return e("common.description")},get value(){return r().description},onChange:te=>b("description",te),get placeholder(){return e("journal.enterEntryDescription","Enter journal entry description")},required:!0}),re),s(J,_(wt,{get label(){return e("journal.reference")},get value(){return r().reference},onChange:te=>b("reference",te),get placeholder(){return e("journal.enterReferenceNumber","Enter reference number")}}),re),re.style.setProperty("margin-top","2rem"),I.style.setProperty("display","flex"),I.style.setProperty("justify-content","space-between"),I.style.setProperty("align-items","center"),I.style.setProperty("margin-bottom","1rem"),S.style.setProperty("margin","0"),s(S,()=>e("journal.entryLines","Journal Entry Lines")),s(I,_(De,{type:"button",variant:"secondary",size:"sm",onClick:R,get children(){return e("journal.addLine","Add Line")}}),null),v.style.setProperty("margin-bottom","1rem"),v.style.setProperty("font-size","0.875rem"),v.style.setProperty("color","var(--text-muted)"),w.style.setProperty("display","grid"),w.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1fr"),w.style.setProperty("gap","1rem"),s(A,()=>e("journal.account")),s(se,()=>e("common.description")),s(k,()=>e("journal.debit")),s(V,()=>e("journal.credit")),s(D,()=>e("common.actions")),s(re,_(xt,{get each(){return i()},children:te=>(()=>{var B=om();return d(B,h),s(B,_(hr,{label:"",get value(){return te.accountId||""},onChange:ae=>C(te.tempId,"accountId",ae),get options(){return g()}}),null),s(B,_(wt,{label:"",get value(){return te.description||""},onChange:ae=>C(te.tempId,"description",ae),get placeholder(){return e("journal.lineDescription","Line description")}}),null),s(B,_(wt,{label:"",type:"number",get value(){return te.debitAmount?.toString()||"0"},onChange:ae=>{C(te.tempId,"debitAmount",parseFloat(ae)||0),parseFloat(ae)>0&&C(te.tempId,"creditAmount",0)},placeholder:"0.00"}),null),s(B,_(wt,{label:"",type:"number",get value(){return te.creditAmount?.toString()||"0"},onChange:ae=>{C(te.tempId,"creditAmount",parseFloat(ae)||0),parseFloat(ae)>0&&C(te.tempId,"debitAmount",0)},placeholder:"0.00"}),null),s(B,_(De,{type:"button",variant:"outline",size:"sm",onClick:()=>T(te.tempId),get disabled(){return i().length<=2},get children(){return e("common.remove","Remove")}}),null),B})()}),M),d(M,f),s(z,()=>e("journal.totalDebit","Total Debit"),pe),s(z,()=>K(Z.totalDebit),null),s(F,()=>e("journal.totalCredit","Total Credit"),ee),s(F,()=>K(Z.totalCredit),null),Q.style.setProperty("font-weight","600"),s(Q,(()=>{var te=me(()=>!!Z.isBalanced);return()=>te()?`✓ ${e("journal.balanced")}`:`⚠️ ${e("journal.notBalanced","Not Balanced")}`})()),s(J,(()=>{var te=me(()=>!!a());return()=>te()&&(()=>{var B=om();return B.style.setProperty("padding","1rem"),B.style.setProperty("border-radius","var(--border-radius-sm)"),B.style.setProperty("margin-top","1rem"),B.style.setProperty("background","#f8d7da"),B.style.setProperty("color","#721c24"),B.style.setProperty("border","1px solid #f5c6cb"),s(B,a),B})()})(),ue),d(ue,u),s(ue,_(De,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(ue,_(De,{variant:"primary",type:"submit",get disabled(){return!Z.isBalanced},get children(){return me(()=>!!t.editEntry)()?e("journal.updateEntry","Update Entry"):e("journal.saveAsDraft","Save as Draft")}}),null),ie(te=>(te=Z.isBalanced?"#4caf50":"#f44336")!=null?Q.style.setProperty("color",te):Q.style.removeProperty("color")),J}})};var lx=G("<div><div>⚠️</div><div></div><div></div><div>"),cx=G("<div><div></div><div></div><div></div><div></div><div>"),ux=G("<div><button></button><button> (<!>)</button><button> (<!>/<!>)"),sm=G("<div>"),dx=G("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><div><h4></h4><div></div></div><div>"),Rl=G("<div><span></span><span>"),Dl=G("<div><strong>:</strong> "),hx=G("<div><div><div></div><div></div><div></div><div></div><div></div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div></div></div><div><div><strong>🔗 Reconciliation Summary</strong></div><div><div><div><strong>Total Lines:</strong> </div><div><strong>Reconciled:</strong> </div><div><strong>Unreconciled:</strong> </div></div><div><div><strong>Bank Accounts:</strong> </div><div><strong>Bank Reconciled:</strong> "),mx=G("<div><div><div></div><div></div></div><div></div><div></div><div></div><div>"),fx=G("<div><span>✓ "),yx=G("<span>(<!>)"),gx=G("<div><strong>Bank Pending:</strong> "),px=G("<div><div>Reconciled Lines:"),vx=G("<div><div>⚠️ Pending Bank Reconciliation:</div><div>Visit Bank Consolidations to reconcile these transactions"),bx=G("<div><div><div><span></span><h3></h3></div><div><div><div></div><div>Total Lines</div></div><div><div></div><div>Reconciled</div></div><div><div></div><div>Pending"),_x=G("<div><h4>✅ Reconciled Lines (<!>)"),Sx=G("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div>✓ Matched"),Px=G("<div>→ "),wx=G("<div><h4>⏳ Unreconciled Lines (<!>)"),Cx=G("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div>⏳ Pending"),Ax=G("<div>Bank account"),Ix=G("<div><div>💡 Reconciliation Tip</div><div>This entry has unreconciled bank account transactions. Visit <strong>Bank Consolidations</strong> to match these with bank statements.");const Ex=t=>{const{t:e}=ot(),[r,n]=ge("details"),[i,o]=ge(!1),a=qe(()=>t.entryId?Sn.getJournalEntryById(t.entryId):null),c={"text-align":"center","margin-bottom":"2rem",position:"relative"},u={position:"absolute",top:"0",right:"0",display:"flex",gap:"0.5rem"},h={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","margin-bottom":"0.5rem"},f={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},g={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},b={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem",display:"inline-block"},C={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},R={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},T={"font-weight":"600",color:"var(--text-primary)"},E={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},$=y=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:y?"var(--primary-color)":"var(--text-muted)","border-bottom":y?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),K={display:"grid","grid-template-columns":"2fr 2.5fr 1fr 1fr 1.5fr",gap:"1rem",padding:"1rem 0","border-bottom":"1px solid var(--border-color)","align-items":"center"},Z={...K,"font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","border-bottom":"2px solid var(--border-color)"},J={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},de={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},re=y=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[y],I=y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(y),S=y=>new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),v=y=>new Date(y).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),w=()=>{entry.status==="posted"&&!confirm(e("journal.confirmEditPosted","This entry has been posted. Editing will create a new draft copy. Continue?"))||o(!0)},P=()=>{if(a()&&confirm(e("journal.confirmPost","Are you sure you want to post this journal entry? This action cannot be undone.")))try{Sn.postJournalEntry(a().id)}catch(y){alert(y instanceof Error?y.message:e("forms.errorPostingEntry","An error occurred while posting the entry"))}},A=()=>{a()&&confirm(e("journal.confirmVoid","Are you sure you want to void this journal entry?"))&&Sn.voidJournalEntry(a().id)};return[_(yr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.entryDetails","Journal Entry Details")},get children(){return me(()=>!a())()?(()=>{var y=lx(),se=y.firstChild,W=se.nextSibling,k=W.nextSibling,H=k.nextSibling;return y.style.setProperty("text-align","center"),y.style.setProperty("padding","3rem"),y.style.setProperty("color","var(--text-muted)"),se.style.setProperty("font-size","1.5rem"),se.style.setProperty("margin-bottom","1rem"),W.style.setProperty("font-size","1.1rem"),W.style.setProperty("margin-bottom","0.5rem"),s(W,()=>e("journal.entryNotFound","Entry Not Found")),k.style.setProperty("font-size","0.875rem"),s(k,()=>e("journal.entryNotFoundMessage","The journal entry you're looking for could not be found or may have been deleted.")),H.style.setProperty("margin-top","2rem"),s(H,_(De,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),y})():(()=>{const y=a(),se=re(y.status),W=Math.abs(y.totalDebit-y.totalCredit)<.01;return[(()=>{var k=cx(),H=k.firstChild,V=H.nextSibling,O=V.nextSibling,D=O.nextSibling,M=D.nextSibling;return d(k,c),s(H,_(De,{variant:"outline",size:"sm",onClick:w,get title(){return e("journal.editEntryTooltip","Edit this journal entry")},get children(){return e("common.edit")}}),null),s(H,(()=>{var he=me(()=>y.status==="draft");return()=>he()&&_(De,{variant:"primary",size:"sm",onClick:P,disabled:!W,get title(){return W?e("journal.postEntryTooltip","Post this journal entry"):e("journal.entryMustBeBalanced","Entry must be balanced to post")},get children(){return e("journal.post","Post")}})})(),null),s(H,(()=>{var he=me(()=>y.status==="posted");return()=>he()&&_(De,{variant:"outline",size:"sm",onClick:A,style:{color:"#dc3545","border-color":"#dc3545"},get title(){return e("journal.voidEntryTooltip","Void this journal entry")},get children(){return e("entryBooks.void","Void")}})})(),null),d(V,h),s(V,()=>y.entryNumber),d(O,f),s(O,()=>y.description),d(D,g),s(D,()=>I(y.totalDebit)),s(M,()=>y.status),ie(he=>{var z=u,pe={...b,background:se.bg,color:se.color};return he.e=d(H,z,he.e),he.t=d(M,pe,he.t),he},{e:void 0,t:void 0}),k})(),(()=>{var k=ux(),H=k.firstChild,V=H.nextSibling,O=V.firstChild,D=O.nextSibling;D.nextSibling;var M=V.nextSibling,he=M.firstChild,z=he.nextSibling,pe=z.nextSibling,x=pe.nextSibling;return x.nextSibling,d(k,E),H.$$click=()=>n("details"),s(H,()=>e("common.details")),V.$$click=()=>n("lines"),s(V,()=>e("journal.journalLines","Journal Lines"),O),s(V,()=>y.lines.length,D),M.$$click=()=>n("reconciliation"),s(M,()=>e("banking.reconciliation","Reconciliation"),he),s(M,()=>y.lines.filter(F=>F.reconciled).length,z),s(M,()=>y.lines.length,x),ie(F=>{var ee=$(r()==="details"),Q=$(r()==="lines"),ue=$(r()==="reconciliation");return F.e=d(H,ee,F.e),F.t=d(V,Q,F.t),F.a=d(M,ue,F.a),F},{e:void 0,t:void 0,a:void 0}),k})(),me(()=>me(()=>r()==="details")()&&(()=>{var k=dx(),H=k.firstChild,V=H.firstChild,O=V.nextSibling,D=H.nextSibling,M=D.firstChild,he=M.nextSibling,z=D.nextSibling,pe=z.firstChild,x=pe.nextSibling,F=z.nextSibling,ee=F.firstChild,Q=ee.nextSibling,ue=F.nextSibling,te=ue.firstChild,B=te.nextSibling,ae=ue.nextSibling,ve=ae.firstChild,be=ve.nextSibling,oe=ae.nextSibling,ce=oe.firstChild,Y=ce.nextSibling,q=oe.nextSibling,N=q.firstChild,ne=N.firstChild,fe=ne.nextSibling,U=N.nextSibling;return s(V,()=>e("common.date")),s(O,()=>S(y.date)),s(M,()=>e("journal.reference")),s(he,()=>y.reference||e("common.notAvailable","N/A")),s(pe,()=>e("journal.totalDebit")),s(x,()=>I(y.totalDebit)),s(ee,()=>e("journal.totalCredit")),s(Q,()=>I(y.totalCredit)),s(te,()=>e("journal.balanceStatus","Balance Status")),s(B,()=>W?`${e("journal.balanced")} ✓`:`${e("journal.unbalanced","Unbalanced")} (${I(Math.abs(y.totalDebit-y.totalCredit))} ${e("journal.difference","difference")})`),s(ve,()=>e("journal.createdBy")),s(be,()=>y.createdBy),s(ce,()=>e("journal.createdAt","Created At")),s(Y,()=>v(y.createdAt)),s(k,(()=>{var j=me(()=>!!y.postedAt);return()=>j()&&(()=>{var Se=Rl(),we=Se.firstChild,le=we.nextSibling;return s(we,()=>e("journal.postedAt","Posted At")),s(le,()=>v(y.postedAt)),ie(ye=>{var X=C,Pe=R,ke=T;return ye.e=d(Se,X,ye.e),ye.t=d(we,Pe,ye.t),ye.a=d(le,ke,ye.a),ye},{e:void 0,t:void 0,a:void 0}),Se})()})(),q),q.style.setProperty("margin-top","2rem"),q.style.setProperty("padding-top","1rem"),q.style.setProperty("border-top","2px solid var(--border-color)"),N.style.setProperty("display","flex"),N.style.setProperty("justify-content","space-between"),N.style.setProperty("align-items","center"),N.style.setProperty("margin-bottom","1rem"),ne.style.setProperty("margin","0"),ne.style.setProperty("font-size","1rem"),s(ne,()=>e("journal.quickActions","Quick Actions")),fe.style.setProperty("display","flex"),fe.style.setProperty("gap","0.5rem"),s(fe,_(De,{variant:"primary",size:"sm",onClick:w,get children(){return["✏️ ",me(()=>e("journal.editEntry"))]}}),null),s(fe,(()=>{var j=me(()=>y.status==="draft");return()=>j()&&_(De,{variant:"outline",size:"sm",onClick:P,disabled:!W,style:{"border-color":W?"#4caf50":"#f44336",color:W?"#4caf50":"#f44336"},get children(){return W?`✓ ${e("journal.postEntry","Post Entry")}`:`⚠️ ${e("journal.fixBalance","Fix Balance")}`}})})(),null),s(fe,(()=>{var j=me(()=>y.status==="posted");return()=>j()&&_(De,{variant:"outline",size:"sm",onClick:A,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return["🗑️ ",me(()=>e("journal.voidEntry","Void Entry"))]}})})(),null),U.style.setProperty("padding","1rem"),U.style.setProperty("border-radius","var(--border-radius-sm)"),U.style.setProperty("font-size","0.875rem"),s(U,(()=>{var j=me(()=>y.status==="draft");return()=>j()&&(()=>{var Se=Dl(),we=Se.firstChild,le=we.firstChild;return we.nextSibling,s(we,()=>e("journal.draftEntry","Draft Entry"),le),s(Se,()=>e("journal.draftEntryDescription","This entry can be edited and posted."),null),s(Se,()=>!W&&` ⚠️ ${e("journal.entryMustBeBalancedBeforePosting","Entry must be balanced before posting.")}`,null),Se})()})(),null),s(U,(()=>{var j=me(()=>y.status==="posted");return()=>j()&&(()=>{var Se=Dl(),we=Se.firstChild,le=we.firstChild;return we.nextSibling,s(we,()=>e("journal.postedEntry","Posted Entry"),le),s(Se,()=>e("journal.postedEntryDescription","This entry has been posted to the general ledger. Editing will create a new draft copy."),null),Se})()})(),null),s(U,(()=>{var j=me(()=>y.status==="void");return()=>j()&&(()=>{var Se=Dl(),we=Se.firstChild,le=we.firstChild;return we.nextSibling,s(we,()=>e("journal.voidEntry"),le),s(Se,()=>e("journal.voidEntryDescription","This entry has been voided and cannot be modified."),null),Se})()})(),null),ie(j=>{var Se=C,we=R,le=T,ye=C,X=R,Pe=T,ke=C,Te=R,$e=T,Ue=C,Ye=R,ze=T,Ee=C,Me=R,Ke={...T,color:W?"#4caf50":"#f44336"},Ge=C,He=R,Ae=T,st=C,Xe=R,gt=T,dt=y.status==="draft"?"#fff3cd":y.status==="posted"?"#d4edda":"#f8d7da";return j.e=d(H,Se,j.e),j.t=d(V,we,j.t),j.a=d(O,le,j.a),j.o=d(D,ye,j.o),j.i=d(M,X,j.i),j.n=d(he,Pe,j.n),j.s=d(z,ke,j.s),j.h=d(pe,Te,j.h),j.r=d(x,$e,j.r),j.d=d(F,Ue,j.d),j.l=d(ee,Ye,j.l),j.u=d(Q,ze,j.u),j.c=d(ue,Ee,j.c),j.w=d(te,Me,j.w),j.m=d(B,Ke,j.m),j.f=d(ae,Ge,j.f),j.y=d(ve,He,j.y),j.g=d(be,Ae,j.g),j.p=d(oe,st,j.p),j.b=d(ce,Xe,j.b),j.T=d(Y,gt,j.T),dt!==j.A&&((j.A=dt)!=null?U.style.setProperty("background",dt):U.style.removeProperty("background")),j},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),k})()),me(()=>me(()=>r()==="lines")()&&(()=>{var k=hx(),H=k.firstChild,V=H.firstChild,O=V.nextSibling,D=O.nextSibling,M=D.nextSibling,he=M.nextSibling,z=H.nextSibling,pe=z.firstChild,x=pe.firstChild,F=x.firstChild;x.nextSibling;var ee=pe.nextSibling,Q=ee.firstChild,ue=Q.firstChild;Q.nextSibling;var te=ee.nextSibling,B=z.nextSibling,ae=B.firstChild,ve=ae.nextSibling,be=ve.firstChild,oe=be.firstChild,ce=oe.firstChild;ce.nextSibling;var Y=oe.nextSibling,q=Y.firstChild;q.nextSibling;var N=Y.nextSibling,ne=N.firstChild;ne.nextSibling;var fe=be.nextSibling,U=fe.firstChild,j=U.firstChild;j.nextSibling;var Se=U.nextSibling,we=Se.firstChild;return we.nextSibling,s(V,()=>e("journal.account")),s(O,()=>e("common.description")),s(D,()=>e("journal.debit")),s(M,()=>e("journal.credit")),s(he,()=>e("banking.reconciliation")),s(k,_(xt,{get each(){return y.lines},children:le=>(()=>{var ye=mx(),X=ye.firstChild,Pe=X.firstChild,ke=Pe.nextSibling,Te=X.nextSibling,$e=Te.nextSibling,Ue=$e.nextSibling,Ye=Ue.nextSibling;return Pe.style.setProperty("font-weight","500"),s(Pe,()=>le.accountName),ke.style.setProperty("font-size","0.75rem"),ke.style.setProperty("color","var(--text-muted)"),s(ke,()=>ut.getAccountById(le.accountId)?.accountNumber||le.accountId),Te.style.setProperty("font-size","0.875rem"),s(Te,()=>le.description||"-"),$e.style.setProperty("font-weight","600"),s($e,(()=>{var ze=me(()=>le.debitAmount>0);return()=>ze()?I(le.debitAmount):"-"})()),Ue.style.setProperty("font-weight","600"),s(Ue,(()=>{var ze=me(()=>le.creditAmount>0);return()=>ze()?I(le.creditAmount):"-"})()),s(Ye,(()=>{var ze=me(()=>!!le.reconciled);return()=>ze()?(()=>{var Ee=fx(),Me=Ee.firstChild;return Me.firstChild,Ee.style.setProperty("display","flex"),Ee.style.setProperty("align-items","center"),Ee.style.setProperty("gap","0.5rem"),Ee.style.setProperty("color","#4caf50"),Ee.style.setProperty("font-size","0.875rem"),Me.style.setProperty("font-weight","600"),s(Me,()=>e("banking.reconciled"),null),s(Ee,(()=>{var Ke=me(()=>!!le.reconciledWith);return()=>Ke()&&(()=>{var Ge=yx(),He=Ge.firstChild,Ae=He.nextSibling;return Ae.nextSibling,Ge.style.setProperty("font-size","0.75rem"),Ge.style.setProperty("color","var(--text-muted)"),Ge.style.setProperty("font-style","italic"),s(Ge,()=>le.reconciledWith,Ae),Ge})()})(),null),Ee})():(()=>{var Ee=sm();return Ee.style.setProperty("color","var(--text-muted)"),Ee.style.setProperty("font-size","0.875rem"),s(Ee,()=>e("banking.notReconciled","Not Reconciled")),Ee})()})()),ie(ze=>{var Ee=K,Me=le.debitAmount>0?"#4caf50":"var(--text-muted)",Ke=le.creditAmount>0?"#f44336":"var(--text-muted)";return ze.e=d(ye,Ee,ze.e),Me!==ze.t&&((ze.t=Me)!=null?$e.style.setProperty("color",Me):$e.style.removeProperty("color")),Ke!==ze.a&&((ze.a=Ke)!=null?Ue.style.setProperty("color",Ke):Ue.style.removeProperty("color")),ze},{e:void 0,t:void 0,a:void 0}),ye})()}),z),d(z,J),s(x,()=>e("journal.totalDebit"),F),s(pe,()=>I(y.totalDebit),null),s(Q,()=>e("journal.totalCredit"),ue),s(ee,()=>I(y.totalCredit),null),(W?"#4caf50":"#f44336")!=null?te.style.setProperty("color",W?"#4caf50":"#f44336"):te.style.removeProperty("color"),te.style.setProperty("font-weight","600"),s(te,()=>W?`✓ ${e("journal.balanced")}`:`⚠️ ${e("journal.notBalanced","Not Balanced")}`),B.style.setProperty("margin-top","1rem"),B.style.setProperty("padding","1rem"),B.style.setProperty("border-radius","var(--border-radius-sm)"),B.style.setProperty("font-size","0.875rem"),ae.style.setProperty("margin-bottom","0.5rem"),ve.style.setProperty("display","grid"),ve.style.setProperty("grid-template-columns","1fr 1fr"),ve.style.setProperty("gap","1rem"),oe.style.setProperty("margin-bottom","0.25rem"),s(oe,()=>y.lines.length,null),Y.style.setProperty("margin-bottom","0.25rem"),Y.style.setProperty("color","#4caf50"),s(Y,()=>y.lines.filter(le=>le.reconciled).length,null),N.style.setProperty("color","#f44336"),s(N,()=>y.lines.filter(le=>!le.reconciled).length,null),U.style.setProperty("margin-bottom","0.25rem"),s(U,()=>y.lines.filter(le=>["1001","1002","1003"].includes(le.accountId)).length,null),Se.style.setProperty("margin-bottom","0.25rem"),Se.style.setProperty("color","#4caf50"),s(Se,()=>y.lines.filter(le=>["1001","1002","1003"].includes(le.accountId)&&le.reconciled).length,null),s(fe,(()=>{var le=me(()=>y.lines.filter(ye=>["1001","1002","1003"].includes(ye.accountId)&&!ye.reconciled).length>0);return()=>le()&&(()=>{var ye=gx(),X=ye.firstChild;return X.nextSibling,ye.style.setProperty("color","#f44336"),s(ye,()=>y.lines.filter(Pe=>["1001","1002","1003"].includes(Pe.accountId)&&!Pe.reconciled).length,null),ye})()})(),null),s(B,(()=>{var le=me(()=>y.lines.filter(ye=>ye.reconciled).length>0);return()=>le()&&(()=>{var ye=px(),X=ye.firstChild;return ye.style.setProperty("margin-top","0.75rem"),ye.style.setProperty("padding-top","0.75rem"),ye.style.setProperty("border-top","1px solid var(--border-color)"),X.style.setProperty("margin-bottom","0.5rem"),X.style.setProperty("font-weight","500"),s(ye,()=>y.lines.filter(Pe=>Pe.reconciled).map(Pe=>(()=>{var ke=Rl(),Te=ke.firstChild,$e=Te.nextSibling;return ke.style.setProperty("display","flex"),ke.style.setProperty("justify-content","space-between"),ke.style.setProperty("margin-bottom","0.25rem"),ke.style.setProperty("font-size","0.8rem"),s(Te,()=>Pe.accountName),$e.style.setProperty("color","var(--text-muted)"),s($e,()=>Pe.reconciledWith?`→ ${Pe.reconciledWith}`:"Manual"),ke})()),null),ye})()})(),null),s(B,(()=>{var le=me(()=>y.lines.filter(ye=>!ye.reconciled&&["1001","1002","1003"].includes(ye.accountId)).length>0);return()=>le()&&(()=>{var ye=vx(),X=ye.firstChild,Pe=X.nextSibling;return ye.style.setProperty("margin-top","0.75rem"),ye.style.setProperty("padding-top","0.75rem"),ye.style.setProperty("border-top","1px solid var(--border-color)"),X.style.setProperty("margin-bottom","0.5rem"),X.style.setProperty("font-weight","500"),X.style.setProperty("color","#f44336"),s(ye,()=>y.lines.filter(ke=>!ke.reconciled&&["1001","1002","1003"].includes(ke.accountId)).map(ke=>(()=>{var Te=Rl(),$e=Te.firstChild,Ue=$e.nextSibling;return Te.style.setProperty("display","flex"),Te.style.setProperty("justify-content","space-between"),Te.style.setProperty("margin-bottom","0.25rem"),Te.style.setProperty("font-size","0.8rem"),Te.style.setProperty("color","#f44336"),s($e,()=>ke.accountName),s(Ue,()=>I(ke.debitAmount||ke.creditAmount)),Te})()),Pe),Pe.style.setProperty("margin-top","0.5rem"),Pe.style.setProperty("font-size","0.75rem"),Pe.style.setProperty("color","var(--text-muted)"),Pe.style.setProperty("font-style","italic"),ye})()})(),null),ie(le=>{var ye=Z,X=y.lines.some(Pe=>Pe.reconciled)?"#e8f5e8":"#fff3cd";return le.e=d(H,ye,le.e),X!==le.t&&((le.t=X)!=null?B.style.setProperty("background",X):B.style.removeProperty("background")),le},{e:void 0,t:void 0}),k})()),me(()=>me(()=>r()==="reconciliation")()&&(()=>{var k=bx(),H=k.firstChild,V=H.firstChild,O=V.firstChild,D=O.nextSibling,M=V.nextSibling,he=M.firstChild,z=he.firstChild,pe=z.nextSibling,x=he.nextSibling,F=x.firstChild,ee=F.nextSibling,Q=x.nextSibling,ue=Q.firstChild,te=ue.nextSibling;return H.style.setProperty("margin-bottom","1.5rem"),H.style.setProperty("padding","1rem"),H.style.setProperty("border-radius","var(--border-radius)"),H.style.setProperty("border","1px solid var(--border-color)"),V.style.setProperty("display","flex"),V.style.setProperty("align-items","center"),V.style.setProperty("gap","0.5rem"),V.style.setProperty("margin-bottom","1rem"),O.style.setProperty("font-size","1.5rem"),s(O,(()=>{var B=me(()=>!!y.lines.every(ae=>ae.reconciled));return()=>B()?"✅":y.lines.some(ae=>ae.reconciled)?"🔄":"⏳"})()),D.style.setProperty("margin","0"),D.style.setProperty("font-size","1.2rem"),s(D,(()=>{var B=me(()=>!!y.lines.every(ae=>ae.reconciled));return()=>B()?"Fully Reconciled":y.lines.some(ae=>ae.reconciled)?"Partially Reconciled":"Unreconciled"})()),M.style.setProperty("display","grid"),M.style.setProperty("grid-template-columns","1fr 1fr 1fr"),M.style.setProperty("gap","1rem"),he.style.setProperty("text-align","center"),z.style.setProperty("font-size","2rem"),z.style.setProperty("font-weight","700"),z.style.setProperty("color","var(--primary-color)"),s(z,()=>y.lines.length),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),x.style.setProperty("text-align","center"),F.style.setProperty("font-size","2rem"),F.style.setProperty("font-weight","700"),F.style.setProperty("color","#4caf50"),s(F,()=>y.lines.filter(B=>B.reconciled).length),ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),Q.style.setProperty("text-align","center"),ue.style.setProperty("font-size","2rem"),ue.style.setProperty("font-weight","700"),ue.style.setProperty("color","#f44336"),s(ue,()=>y.lines.filter(B=>!B.reconciled).length),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),s(k,(()=>{var B=me(()=>y.lines.filter(ae=>ae.reconciled).length>0);return()=>B()&&(()=>{var ae=_x(),ve=ae.firstChild,be=ve.firstChild,oe=be.nextSibling;return oe.nextSibling,ae.style.setProperty("margin-bottom","1.5rem"),ve.style.setProperty("margin","0 0 1rem 0"),ve.style.setProperty("font-size","1.1rem"),ve.style.setProperty("color","#4caf50"),ve.style.setProperty("display","flex"),ve.style.setProperty("align-items","center"),ve.style.setProperty("gap","0.5rem"),s(ve,()=>y.lines.filter(ce=>ce.reconciled).length,oe),s(ae,()=>y.lines.filter(ce=>ce.reconciled).map(ce=>(()=>{var Y=Sx(),q=Y.firstChild,N=q.firstChild,ne=N.nextSibling,fe=q.nextSibling,U=fe.nextSibling,j=U.nextSibling,Se=j.nextSibling,we=Se.firstChild;return Y.style.setProperty("display","grid"),Y.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),Y.style.setProperty("gap","1rem"),Y.style.setProperty("padding","0.75rem"),Y.style.setProperty("margin-bottom","0.5rem"),Y.style.setProperty("background","#f0f9f0"),Y.style.setProperty("border-radius","var(--border-radius-sm)"),Y.style.setProperty("align-items","center"),Y.style.setProperty("font-size","0.875rem"),N.style.setProperty("font-weight","500"),s(N,()=>ce.accountName),ne.style.setProperty("font-size","0.75rem"),ne.style.setProperty("color","var(--text-muted)"),s(ne,()=>ut.getAccountById(ce.accountId)?.accountNumber),fe.style.setProperty("color","var(--text-muted)"),s(fe,()=>ce.description||"No description"),U.style.setProperty("font-weight","600"),s(U,(()=>{var le=me(()=>ce.debitAmount>0);return()=>le()?I(ce.debitAmount):"-"})()),j.style.setProperty("font-weight","600"),s(j,(()=>{var le=me(()=>ce.creditAmount>0);return()=>le()?I(ce.creditAmount):"-"})()),Se.style.setProperty("color","#4caf50"),we.style.setProperty("font-weight","500"),s(Se,(()=>{var le=me(()=>!!ce.reconciledWith);return()=>le()&&(()=>{var ye=Px();return ye.firstChild,ye.style.setProperty("font-size","0.75rem"),ye.style.setProperty("font-style","italic"),s(ye,()=>ce.reconciledWith,null),ye})()})(),null),ie(le=>{var ye=ce.debitAmount>0?"#4caf50":"var(--text-muted)",X=ce.creditAmount>0?"#f44336":"var(--text-muted)";return ye!==le.e&&((le.e=ye)!=null?U.style.setProperty("color",ye):U.style.removeProperty("color")),X!==le.t&&((le.t=X)!=null?j.style.setProperty("color",X):j.style.removeProperty("color")),le},{e:void 0,t:void 0}),Y})()),null),ae})()})(),null),s(k,(()=>{var B=me(()=>y.lines.filter(ae=>!ae.reconciled).length>0);return()=>B()&&(()=>{var ae=wx(),ve=ae.firstChild,be=ve.firstChild,oe=be.nextSibling;return oe.nextSibling,ae.style.setProperty("margin-bottom","1.5rem"),ve.style.setProperty("margin","0 0 1rem 0"),ve.style.setProperty("font-size","1.1rem"),ve.style.setProperty("color","#f44336"),ve.style.setProperty("display","flex"),ve.style.setProperty("align-items","center"),ve.style.setProperty("gap","0.5rem"),s(ve,()=>y.lines.filter(ce=>!ce.reconciled).length,oe),s(ae,()=>y.lines.filter(ce=>!ce.reconciled).map(ce=>(()=>{var Y=Cx(),q=Y.firstChild,N=q.firstChild,ne=N.nextSibling,fe=q.nextSibling,U=fe.nextSibling,j=U.nextSibling,Se=j.nextSibling,we=Se.firstChild;return Y.style.setProperty("display","grid"),Y.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),Y.style.setProperty("gap","1rem"),Y.style.setProperty("padding","0.75rem"),Y.style.setProperty("margin-bottom","0.5rem"),Y.style.setProperty("background","#fff9f0"),Y.style.setProperty("border-radius","var(--border-radius-sm)"),Y.style.setProperty("align-items","center"),Y.style.setProperty("font-size","0.875rem"),Y.style.setProperty("border","1px solid #ffe0b3"),N.style.setProperty("font-weight","500"),s(N,()=>ce.accountName),ne.style.setProperty("font-size","0.75rem"),ne.style.setProperty("color","var(--text-muted)"),s(ne,()=>ut.getAccountById(ce.accountId)?.accountNumber),fe.style.setProperty("color","var(--text-muted)"),s(fe,()=>ce.description||"No description"),U.style.setProperty("font-weight","600"),s(U,(()=>{var le=me(()=>ce.debitAmount>0);return()=>le()?I(ce.debitAmount):"-"})()),j.style.setProperty("font-weight","600"),s(j,(()=>{var le=me(()=>ce.creditAmount>0);return()=>le()?I(ce.creditAmount):"-"})()),Se.style.setProperty("color","#f44336"),we.style.setProperty("font-weight","500"),s(Se,(()=>{var le=me(()=>!!["1001","1002","1003"].includes(ce.accountId));return()=>le()&&(()=>{var ye=Ax();return ye.style.setProperty("font-size","0.75rem"),ye.style.setProperty("font-style","italic"),ye})()})(),null),ie(le=>{var ye=ce.debitAmount>0?"#4caf50":"var(--text-muted)",X=ce.creditAmount>0?"#f44336":"var(--text-muted)";return ye!==le.e&&((le.e=ye)!=null?U.style.setProperty("color",ye):U.style.removeProperty("color")),X!==le.t&&((le.t=X)!=null?j.style.setProperty("color",X):j.style.removeProperty("color")),le},{e:void 0,t:void 0}),Y})()),null),s(ae,(()=>{var ce=me(()=>y.lines.filter(Y=>!Y.reconciled&&["1001","1002","1003"].includes(Y.accountId)).length>0);return()=>ce()&&(()=>{var Y=Ix(),q=Y.firstChild,N=q.nextSibling;return Y.style.setProperty("padding","0.75rem"),Y.style.setProperty("background","#ffebee"),Y.style.setProperty("border-radius","var(--border-radius-sm)"),Y.style.setProperty("margin-top","1rem"),Y.style.setProperty("border","1px solid #ffcdd2"),q.style.setProperty("font-weight","500"),q.style.setProperty("margin-bottom","0.5rem"),q.style.setProperty("color","#f44336"),N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),Y})()})(),null),ae})()})(),null),ie(B=>(B=y.lines.every(ae=>ae.reconciled)?"#e8f5e8":y.lines.some(ae=>ae.reconciled)?"#fff3cd":"#ffebee")!=null?H.style.setProperty("background",B):H.style.removeProperty("background")),k})()),(()=>{var k=sm();return d(k,de),s(k,_(De,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(k,_(De,{variant:"primary",onClick:w,get children(){return e("journal.editEntry")}}),null),s(k,(()=>{var H=me(()=>y.status==="draft");return()=>H()&&_(De,{variant:"outline",onClick:P,disabled:!W,style:{"border-color":"#4caf50",color:W?"#4caf50":"var(--text-muted)"},get children(){return W?e("journal.postEntry","Post Entry"):e("journal.entryNotBalanced","Entry Not Balanced")}})})(),null),s(k,(()=>{var H=me(()=>y.status==="posted");return()=>H()&&_(De,{variant:"outline",onClick:A,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return e("journal.voidEntry","Void Entry")}})})(),null),k})()]})()}}),me(()=>me(()=>!!a())()&&_(gg,{get isOpen(){return i()},onClose:()=>{o(!1)},get editEntry(){return a()}}))]};_t(["click"]);var xx=G("<div><div><h2></h2><p></p></div><div>"),pn=G("<div>"),Tx=G("<div> <!> • <!> "),$x=G("<div><div><label></label></div><div><label></label></div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label></div><div>"),kx=G("<div><span>:</span><span> "),Hs=G("<span>: "),Rx=G("<div><br>");const Dx=()=>{const{t}=ot(),[e,r]=ge(!1),[n,i]=ge(null),[o,a]=ge(!1),[c,u]=ge(null),[h,f]=ge("all"),[g,b]=ge("all"),[C,R]=ge(""),[T,E]=ge(""),[$,K]=ge("date"),[Z,J]=ge("desc"),de={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},re={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)","flex-wrap":"wrap"},I={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem"},S={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(400px, 1fr))",gap:"1.5rem"},v=()=>[{value:"all",label:t("journal.allEntries","All Entries")},{value:"draft",label:t("journal.draft")},{value:"posted",label:t("journal.posted")},{value:"void",label:t("entryBooks.void","Void")}],w=()=>[{value:"all",label:t("accounts.allAccounts","All Accounts")},...ut.accounts.map(D=>({value:D.id,label:`${D.accountNumber} - ${D.name}`}))],P=()=>[{value:"date",label:t("common.date")},{value:"entryNumber",label:t("journal.entryNumber")},{value:"amount",label:t("common.amount")}],A=()=>{let D=Sn.journalEntries;return h()!=="all"&&(D=D.filter(M=>M.status===h())),g()!=="all"&&(D=D.filter(M=>M.lines.some(he=>he.accountId===g()))),C()&&(D=D.filter(M=>M.date>=C())),T()&&(D=D.filter(M=>M.date<=T())),D=[...D].sort((M,he)=>{let z=0;switch($()){case"date":z=new Date(M.date).getTime()-new Date(he.date).getTime();break;case"entryNumber":z=M.entryNumber.localeCompare(he.entryNumber);break;case"amount":z=M.totalDebit-he.totalDebit;break}return Z()==="asc"?z:-z}),D},y=()=>{const D=Sn.journalEntries,M=D.filter(ee=>ee.status==="draft"),he=D.filter(ee=>ee.status==="posted"),z=D.filter(ee=>ee.status==="void"),pe=he.reduce((ee,Q)=>ee+Q.totalDebit,0),x=he.reduce((ee,Q)=>ee+Q.totalCredit,0),F=D.filter(ee=>ee.lines.some(Q=>["1001","1002","1003"].includes(Q.accountId)&&!Q.reconciled)).length;return{totalEntries:D.length,draftEntries:M.length,postedEntries:he.length,voidEntries:z.length,totalDebit:pe,totalCredit:x,unreconciledEntries:F}},se=D=>{u(D.id),a(!0)},W=()=>{i(null),r(!0)},k=()=>{r(!1),i(null)},H=D=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(D),V=y(),O=A();return _(Dr,{get title(){return t("entryBooks.title")},get children(){return[(()=>{var D=xx(),M=D.firstChild,he=M.firstChild,z=he.nextSibling,pe=M.nextSibling;return d(D,de),he.style.setProperty("margin","0 0 0.5rem 0"),he.style.setProperty("font-size","1.5rem"),s(he,()=>t("journal.title")),z.style.setProperty("margin","0"),z.style.setProperty("color","var(--text-muted)"),s(z,()=>t("entryBooks.subtitle","Manage accounting entries and general ledger records")),pe.style.setProperty("display","flex"),pe.style.setProperty("gap","1rem"),s(pe,_(De,{variant:"secondary",onClick:()=>window.location.href="/bank-consolidations",get children(){return t("entryBooks.viewReconciliation","View Reconciliation")}}),null),s(pe,_(De,{variant:"primary",onClick:W,get children(){return t("journal.addEntry","Add Journal Entry")}}),null),D})(),(()=>{var D=pn();return d(D,I),s(D,_(We,{get title(){return t("entryBooks.totalEntries","Total Entries")},get subtitle(){return t("entryBooks.allJournalEntries","All journal entries")},get children(){return[(()=>{var M=pn();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","var(--primary-color)"),M.style.setProperty("margin-bottom","0.5rem"),s(M,()=>V.totalEntries),M})(),(()=>{var M=Tx(),he=M.firstChild,z=he.nextSibling,pe=z.nextSibling,x=pe.nextSibling;return x.nextSibling,M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),s(M,()=>V.postedEntries,he),s(M,()=>t("journal.posted").toLowerCase(),z),s(M,()=>V.draftEntries,x),s(M,()=>t("journal.draft").toLowerCase(),null),s(M,(()=>{var F=me(()=>V.voidEntries>0);return()=>F()&&` • ${V.voidEntries} ${t("entryBooks.void","void").toLowerCase()}`})(),null),M})()]}}),null),s(D,_(We,{get title(){return t("journal.totalDebits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var M=pn();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","#4caf50"),M.style.setProperty("margin-bottom","0.5rem"),s(M,()=>H(V.totalDebit)),M})(),(()=>{var M=pn();return M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),s(M,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",V.postedEntries.toString())),M})()]}}),null),s(D,_(We,{get title(){return t("journal.totalCredits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var M=pn();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","#f44336"),M.style.setProperty("margin-bottom","0.5rem"),s(M,()=>H(V.totalCredit)),M})(),(()=>{var M=pn();return M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),s(M,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",V.postedEntries.toString())),M})()]}}),null),s(D,_(We,{get title(){return t("banking.unreconciled","Unreconciled")},get subtitle(){return t("banking.title")},get children(){return[(()=>{var M=pn();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("margin-bottom","0.5rem"),s(M,()=>V.unreconciledEntries),ie(he=>(he=V.unreconciledEntries>0?"#ff9800":"#4caf50")!=null?M.style.setProperty("color",he):M.style.removeProperty("color")),M})(),(()=>{var M=pn();return M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),s(M,(()=>{var he=me(()=>V.unreconciledEntries>0);return()=>he()?t("entryBooks.needBankReconciliation","Need bank reconciliation"):t("entryBooks.allReconciled","All reconciled")})()),M})()]}}),null),D})(),(()=>{var D=$x(),M=D.firstChild,he=M.firstChild,z=M.nextSibling,pe=z.firstChild,x=z.nextSibling,F=x.firstChild,ee=x.nextSibling,Q=ee.firstChild,ue=Q.nextSibling,te=ee.nextSibling,B=te.firstChild,ae=B.nextSibling,ve=te.nextSibling,be=ve.firstChild,oe=ve.nextSibling;return d(D,re),M.style.setProperty("min-width","150px"),he.style.setProperty("display","block"),he.style.setProperty("margin-bottom","0.5rem"),he.style.setProperty("font-weight","500"),he.style.setProperty("font-size","0.875rem"),s(he,()=>t("common.status")),s(M,_(hr,{label:"",get value(){return h()},onChange:f,get options(){return v()}}),null),z.style.setProperty("min-width","200px"),pe.style.setProperty("display","block"),pe.style.setProperty("margin-bottom","0.5rem"),pe.style.setProperty("font-weight","500"),pe.style.setProperty("font-size","0.875rem"),s(pe,()=>t("journal.account")),s(z,_(hr,{label:"",get value(){return g()},onChange:b,get options(){return w()}}),null),x.style.setProperty("min-width","120px"),F.style.setProperty("display","block"),F.style.setProperty("margin-bottom","0.5rem"),F.style.setProperty("font-weight","500"),F.style.setProperty("font-size","0.875rem"),s(F,()=>t("entryBooks.sortBy","Sort By")),s(x,_(hr,{label:"",get value(){return $()},onChange:K,get options(){return P()}}),null),ee.style.setProperty("min-width","130px"),Q.style.setProperty("display","block"),Q.style.setProperty("margin-bottom","0.5rem"),Q.style.setProperty("font-weight","500"),Q.style.setProperty("font-size","0.875rem"),s(Q,()=>t("entryBooks.fromDate","From Date")),ue.addEventListener("change",ce=>R(ce.target.value)),ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("border","1px solid var(--border-color)"),ue.style.setProperty("border-radius","var(--border-radius-sm)"),ue.style.setProperty("font-family","inherit"),ue.style.setProperty("width","100%"),te.style.setProperty("min-width","130px"),B.style.setProperty("display","block"),B.style.setProperty("margin-bottom","0.5rem"),B.style.setProperty("font-weight","500"),B.style.setProperty("font-size","0.875rem"),s(B,()=>t("entryBooks.toDate","To Date")),ae.addEventListener("change",ce=>E(ce.target.value)),ae.style.setProperty("padding","0.75rem"),ae.style.setProperty("border","1px solid var(--border-color)"),ae.style.setProperty("border-radius","var(--border-radius-sm)"),ae.style.setProperty("font-family","inherit"),ae.style.setProperty("width","100%"),ve.style.setProperty("min-width","100px"),be.style.setProperty("display","block"),be.style.setProperty("margin-bottom","0.5rem"),be.style.setProperty("font-weight","500"),be.style.setProperty("font-size","0.875rem"),s(be,()=>t("entryBooks.order","Order")),s(ve,_(hr,{label:"",get value(){return Z()},onChange:J,get options(){return[{value:"desc",label:t("entryBooks.newest","Newest")},{value:"asc",label:t("entryBooks.oldest","Oldest")}]}}),null),oe.style.setProperty("display","flex"),oe.style.setProperty("align-items","end"),oe.style.setProperty("gap","0.5rem"),s(oe,_(De,{variant:"outline",size:"sm",onClick:()=>{f("all"),b("all"),R(""),E(""),K("date"),J("desc")},get children(){return t("entryBooks.resetFilters","Reset Filters")}})),ie(()=>ue.value=C()),ie(()=>ae.value=T()),D})(),me(()=>me(()=>!!(h()!=="all"||g()!=="all"||C()||T()))()&&(()=>{var D=kx(),M=D.firstChild,he=M.firstChild,z=M.nextSibling,pe=z.firstChild;return D.style.setProperty("display","flex"),D.style.setProperty("gap","0.5rem"),D.style.setProperty("align-items","center"),D.style.setProperty("margin-bottom","1rem"),D.style.setProperty("padding","0.75rem"),D.style.setProperty("background","var(--surface-color)"),D.style.setProperty("border-radius","var(--border-radius-sm)"),D.style.setProperty("border","1px solid var(--border-color)"),M.style.setProperty("font-size","0.875rem"),M.style.setProperty("font-weight","500"),s(M,()=>t("entryBooks.activeFilters","Active filters"),he),s(D,(()=>{var x=me(()=>h()!=="all");return()=>x()&&(()=>{var F=Hs(),ee=F.firstChild;return F.style.setProperty("padding","0.25rem 0.5rem"),F.style.setProperty("background","var(--primary-color)"),F.style.setProperty("color","white"),F.style.setProperty("border-radius","12px"),F.style.setProperty("font-size","0.75rem"),s(F,()=>t("common.status"),ee),s(F,h,null),F})()})(),z),s(D,(()=>{var x=me(()=>g()!=="all");return()=>x()&&(()=>{var F=Hs(),ee=F.firstChild;return F.style.setProperty("padding","0.25rem 0.5rem"),F.style.setProperty("background","var(--primary-color)"),F.style.setProperty("color","white"),F.style.setProperty("border-radius","12px"),F.style.setProperty("font-size","0.75rem"),s(F,()=>t("journal.account"),ee),s(F,()=>ut.getAccountById(g())?.name||t("common.unknown","Unknown"),null),F})()})(),z),s(D,(()=>{var x=me(()=>!!C());return()=>x()&&(()=>{var F=Hs(),ee=F.firstChild;return F.style.setProperty("padding","0.25rem 0.5rem"),F.style.setProperty("background","var(--primary-color)"),F.style.setProperty("color","white"),F.style.setProperty("border-radius","12px"),F.style.setProperty("font-size","0.75rem"),s(F,()=>t("entryBooks.from","From"),ee),s(F,C,null),F})()})(),z),s(D,(()=>{var x=me(()=>!!T());return()=>x()&&(()=>{var F=Hs(),ee=F.firstChild;return F.style.setProperty("padding","0.25rem 0.5rem"),F.style.setProperty("background","var(--primary-color)"),F.style.setProperty("color","white"),F.style.setProperty("border-radius","12px"),F.style.setProperty("font-size","0.75rem"),s(F,()=>t("entryBooks.to","To"),ee),s(F,T,null),F})()})(),z),z.style.setProperty("margin-left","auto"),z.style.setProperty("font-size","0.875rem"),z.style.setProperty("color","var(--text-muted)"),s(z,()=>O.length,pe),s(z,()=>t("entryBooks.entriesFound","{count} entries found").replace("{count}",O.length.toString()),null),D})()),me(()=>me(()=>O.length===0)()?_(We,{get title(){return t("entryBooks.noJournalEntries","No Journal Entries")},get subtitle(){return t("entryBooks.startByCreating","Start by creating your first entry")},get children(){var D=Rx(),M=D.firstChild;return D.style.setProperty("text-align","center"),D.style.setProperty("color","var(--text-muted)"),D.style.setProperty("padding","2rem"),s(D,()=>t("entryBooks.noEntriesMatch","No journal entries match your current filters."),M),s(D,_(De,{variant:"primary",style:{"margin-top":"1rem"},onClick:W,get children(){return t("entryBooks.createFirstEntry","Create First Entry")}}),null),D}}):(()=>{var D=pn();return d(D,S),s(D,_(xt,{each:O,children:M=>_(ox,{entry:M,onViewDetails:se})})),D})()),_(gg,{get isOpen(){return e()},onClose:k,get editEntry(){return n()}}),_(Ex,{get isOpen(){return o()},onClose:()=>{a(!1),u(null)},get entryId(){return c()}})]}})};var am=G("<div>"),Nx=G("<div>$23,450"),Lx=G("<div>$87,230"),Mx=G("<div>$5,670"),Ox=G("<div><div><div><div>INV-2024-001</div><div>Acme Corporation</div></div><div>$5,250.00</div><div></div></div><div><div><div>INV-2024-002</div><div>Tech Solutions Inc.</div></div><div>$3,750.00</div><div></div></div><div><div><div>INV-2024-003</div><div>Global Services Ltd.</div></div><div>$8,900.00</div><div></div></div><div><div><div>INV-2024-004</div><div>StartUp Co.</div></div><div>$2,100.00</div><div>");const Vx=()=>{const{t}=ot(),e={display:"flex","flex-direction":"column",gap:"1rem"},r={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},n={flex:"1"},i={"font-weight":"600","margin-bottom":"0.25rem"},o={color:"var(--text-muted)","font-size":"0.875rem"},a={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},c=h=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:h==="paid"?"#d4edda":h==="pending"?"#fff3cd":"#f8d7da",color:h==="paid"?"#155724":h==="pending"?"#856404":"#721c24"}),u={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"};return _(Dr,{get title(){return t("invoices.title","Invoices")},get children(){return[(()=>{var h=am();return h.style.setProperty("margin-bottom","2rem"),s(h,_(De,{variant:"primary",get children(){return t("invoices.createNew","Create New Invoice")}})),h})(),(()=>{var h=am();return d(h,u),s(h,_(We,{get title(){return t("invoices.totalOutstanding","Total Outstanding")},get subtitle(){return t("invoices.unpaidInvoices","Unpaid invoices")},get children(){var f=Nx();return f.style.setProperty("font-size","1.5rem"),f.style.setProperty("font-weight","600"),f.style.setProperty("color","var(--primary-color)"),f}}),null),s(h,_(We,{get title(){return t("invoices.thisMonth","This Month")},get subtitle(){return t("invoices.revenueCollected","Revenue collected")},get children(){var f=Lx();return f.style.setProperty("font-size","1.5rem"),f.style.setProperty("font-weight","600"),f.style.setProperty("color","var(--primary-color)"),f}}),null),s(h,_(We,{get title(){return t("invoices.overdue","Overdue")},get subtitle(){return t("invoices.pastDueInvoices","Past due invoices")},get children(){var f=Mx();return f.style.setProperty("font-size","1.5rem"),f.style.setProperty("font-weight","600"),f.style.setProperty("color","var(--primary-color)"),f}}),null),h})(),_(We,{get title(){return t("invoices.recentInvoices","Recent Invoices")},get subtitle(){return t("invoices.latestBillingActivity","Latest billing activity")},get children(){var h=Ox(),f=h.firstChild,g=f.firstChild,b=g.firstChild,C=b.nextSibling,R=g.nextSibling,T=R.nextSibling,E=f.nextSibling,$=E.firstChild,K=$.firstChild,Z=K.nextSibling,J=$.nextSibling,de=J.nextSibling,re=E.nextSibling,I=re.firstChild,S=I.firstChild,v=S.nextSibling,w=I.nextSibling,P=w.nextSibling,A=re.nextSibling,y=A.firstChild,se=y.firstChild,W=se.nextSibling,k=y.nextSibling,H=k.nextSibling;return d(h,e),s(T,()=>t("invoices.paid","Paid")),s(de,()=>t("invoices.pending","Pending")),s(P,()=>t("invoices.overdue","Overdue")),s(H,()=>t("invoices.paid","Paid")),ie(V=>{var O=r,D=n,M=i,he=o,z=a,pe=c("paid"),x=r,F=n,ee=i,Q=o,ue=a,te=c("pending"),B=r,ae=n,ve=i,be=o,oe=a,ce=c("overdue"),Y=r,q=n,N=i,ne=o,fe=a,U=c("paid");return V.e=d(f,O,V.e),V.t=d(g,D,V.t),V.a=d(b,M,V.a),V.o=d(C,he,V.o),V.i=d(R,z,V.i),V.n=d(T,pe,V.n),V.s=d(E,x,V.s),V.h=d($,F,V.h),V.r=d(K,ee,V.r),V.d=d(Z,Q,V.d),V.l=d(J,ue,V.l),V.u=d(de,te,V.u),V.c=d(re,B,V.c),V.w=d(I,ae,V.w),V.m=d(S,ve,V.m),V.f=d(v,be,V.f),V.y=d(w,oe,V.y),V.g=d(P,ce,V.g),V.p=d(A,Y,V.p),V.b=d(y,q,V.b),V.T=d(se,N,V.T),V.A=d(W,ne,V.A),V.O=d(k,fe,V.O),V.I=d(H,U,V.I),V},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0}),h}})]}})};var lm=G("<div>"),Bx=G("<div><div><div><strong>Display Name:</strong> </div><div><strong>UID:</strong> </div></div><div><strong>Created:</strong> "),Fx=G("<div><h3>Store Access</h3><div></div><div>No store access granted"),Ux=G("<div><h3>Permissions</h3><div>"),jx=G('<div><div><input type=text placeholder="Search users..."></div><div>'),zx=G("<div>⚠️ You need administrator privileges to access this page."),qx=G("<div>Loading users..."),Hx=G("<div><div></div><div></div><div> stores"),Gx=G("<div>Select a user to view and edit their profile"),Wx=G("<div><input type=checkbox><label>"),Yx=G("<div><input type=checkbox><div><div></div><div>");const Kx=()=>{const[t,e]=ge([]),[r,n]=ge(null),[i,o]=ge(!1),[a,c]=ge(!1),[u,h]=ge(""),[f,g]=ge(null),b=[{id:"YY_8802",name:"Store 8802"},{id:"YY_8803",name:"Store 8803"},{id:"YY_8804",name:"Store 8804"},{id:"YY_8805",name:"Store 8805"},{id:"YY_8816",name:"Store 8816"},{id:"YY_8818",name:"Store 8818"},{id:"YY_8847",name:"Store 8847"},{id:"YY_3251",name:"Store 3251"},{id:"YY_32",name:"Store 32"},{id:"YY_76",name:"Store 76"},{id:"YY_79",name:"Store 79"},{id:"YY_8635",name:"Store 8635"},{id:"YY_8665",name:"Store 8665"},{id:"YY_8901",name:"Store 8901"}],C=[{key:"AccountAccess",label:"Account Access",description:"Access to accounting features"},{key:"BankingAccess",label:"Banking Access",description:"Access to banking operations"},{key:"InventoryAccess",label:"Inventory Access",description:"Access to inventory management"},{key:"JournalAccess",label:"Journal Access",description:"Access to journal entries"},{key:"inventoryDownsection",label:"Inventory Downsection",description:"Access to inventory downsection"},{key:"onlyRead",label:"Read Only",description:"Limited to read-only access"},{key:"read_write",label:"Read/Write",description:"Full read and write permissions"},{key:"isAdmin",label:"Administrator",description:"Full system administration rights"}];let R={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};Qr(async()=>{await T()});const T=async()=>{try{o(!0);const y=DP(yc,"users"),se=GP(y,WP("createdAt","desc")),W=await XP(se),k=[];W.forEach(H=>{let V=H.data();Object.keys(R).map(O=>{let D=R?.[O];V.hasOwnProperty(O)||(V[O]=D)}),k.push({uid:H.id,...V})}),e(k)}catch(y){console.error("Error loading users:",y),g({type:"error",text:"Failed to load users"})}finally{o(!1)}},E=qe(()=>{const y=u().toLowerCase();return y?t().filter(se=>se.email?.toLowerCase().includes(y)||se.displayName?.toLowerCase().includes(y)||se.uid?.toLowerCase().includes(y)):t()}),$=y=>{r()&&n(se=>({...se,stores:{...se.stores,[y]:!se.stores[y]}}))},K=y=>{r()&&n(se=>({...se,[y]:!se[y]}))};qe(()=>r()?r().stores&&Object.values(r().stores).some(y=>y):!1);const Z=async()=>{if(r())try{c(!0),g(null);const y=Xy(yc,"users",r().uid);let se={stores:r().stores,AccountAccess:r().AccountAccess,BankingAccess:r().BankingAccess,InventoryAccess:r().InventoryAccess,JournalAccess:r().JournalAccess,inventoryDownsection:r().inventoryDownsection,onlyRead:r().onlyRead,read_write:r().read_write,isAdmin:r().isAdmin||!1};await lg(y,se),e(W=>W.map(k=>k.uid===r().uid?r():k)),g({type:"success",text:"User profile updated successfully"})}catch(y){console.error("Error saving user profile:",y),g({type:"error",text:"Failed to save user profile"})}finally{c(!1)}},J={display:"grid","grid-template-columns":"350px 1fr",gap:"2rem",height:"calc(100vh - 200px)"},de={"max-height":"100%","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)",background:"var(--surface-color)"},re=y=>({padding:"1rem","border-bottom":"1px solid var(--border-color)",cursor:"pointer",background:y?"var(--primary-color-light)":"transparent",transition:"background 0.2s"}),I={padding:"0.75rem",border:"none","border-bottom":"1px solid var(--border-color)",background:"var(--surface-color)",width:"100%","font-size":"1rem"},S={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem"},v={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.75rem"},w={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",transition:"all 0.2s"},P=y=>({padding:"1rem","margin-bottom":"1rem","border-radius":"var(--border-radius)",background:y==="success"?"#d4edda":"#f8d7da",color:y==="success"?"#155724":"#721c24",border:`1px solid ${y==="success"?"#c3e6cb":"#f5c6cb"}`}),A=qe(()=>Et.state.profile?.isAdmin===!0);return _(Dr,{title:"User Profile Administration",get children(){return _(Le,{get when(){return A()},get fallback(){return _(We,{get children(){var y=zx();return y.style.setProperty("text-align","center"),y.style.setProperty("padding","2rem"),y.style.setProperty("color","var(--text-muted)"),y}})},get children(){var y=jx(),se=y.firstChild,W=se.firstChild,k=se.nextSibling;return d(y,J),d(se,de),W.$$input=H=>h(H.currentTarget.value),d(W,I),s(se,_(Le,{get when(){return!i()},get fallback(){return(()=>{var H=qx();return H.style.setProperty("padding","2rem"),H.style.setProperty("text-align","center"),H})()},get children(){return _(xt,{get each(){return E()},children:H=>(()=>{var V=Hx(),O=V.firstChild,D=O.nextSibling,M=D.nextSibling,he=M.firstChild;return V.$$click=()=>n(H),O.style.setProperty("font-weight","600"),s(O,()=>H.displayName||"No Name"),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("color","var(--text-muted)"),s(D,()=>H.email),M.style.setProperty("font-size","0.75rem"),M.style.setProperty("color","var(--text-muted)"),M.style.setProperty("margin-top","0.25rem"),s(M,()=>H.isAdmin&&"👑 Admin • ",he),s(M,()=>Object.values(H.stores||{}).filter(Boolean).length,he),ie(z=>d(V,re(r()?.uid===H.uid),z)),V})()})}}),null),s(k,_(Le,{get when(){return r()},get fallback(){return _(We,{get children(){var H=Gx();return H.style.setProperty("text-align","center"),H.style.setProperty("padding","2rem"),H.style.setProperty("color","var(--text-muted)"),H}})},get children(){return[_(Le,{get when(){return f()},get children(){var H=lm();return s(H,()=>f().text),ie(V=>d(H,P(f().type),V)),H}}),_(We,{title:"User Information",get subtitle(){return r().email},get children(){return[(()=>{var H=Bx(),V=H.firstChild,O=V.firstChild,D=O.firstChild;D.nextSibling;var M=O.nextSibling,he=M.firstChild;he.nextSibling;var z=V.nextSibling,pe=z.firstChild;return pe.nextSibling,H.style.setProperty("margin-bottom","2rem"),V.style.setProperty("display","flex"),V.style.setProperty("justify-content","space-between"),V.style.setProperty("margin-bottom","1rem"),s(O,()=>r().displayName||"Not set",null),s(M,()=>r().uid,null),s(z,()=>new Date(r().createdAt?.toDate?.()||r().createdAt).toLocaleDateString(),null),H})(),(()=>{var H=Fx(),V=H.firstChild,O=V.nextSibling,D=O.nextSibling;return H.style.setProperty("margin-bottom","2rem"),V.style.setProperty("margin-bottom","1rem"),d(O,v),s(O,_(xt,{each:b,children:M=>{let he=Re.getLocationById(M?.id);return(()=>{var z=Wx(),pe=z.firstChild,x=pe.nextSibling;return z.$$click=()=>$(M?.id),pe.style.setProperty("cursor","pointer"),x.style.setProperty("cursor","pointer"),x.style.setProperty("user-select","none"),s(x,()=>he?.name),ie(F=>d(z,{...w,background:r().stores?.[M?.id]?"var(--primary-color-light)":"transparent"},F)),ie(()=>pe.checked=r().stores?.[M?.id]||!1),z})()}})),D.style.setProperty("margin-top","0.5rem"),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("color","var(--text-muted)"),H})(),(()=>{var H=Ux(),V=H.firstChild,O=V.nextSibling;return H.style.setProperty("margin-bottom","2rem"),V.style.setProperty("margin-bottom","1rem"),d(O,S),s(O,_(xt,{each:C,children:D=>(()=>{var M=Yx(),he=M.firstChild,z=he.nextSibling,pe=z.firstChild,x=pe.nextSibling;return M.$$click=()=>K(D.key),he.style.setProperty("cursor","pointer"),z.style.setProperty("flex","1"),z.style.setProperty("cursor","pointer"),z.style.setProperty("user-select","none"),pe.style.setProperty("font-weight","500"),s(pe,()=>D.label),x.style.setProperty("font-size","0.75rem"),x.style.setProperty("color","var(--text-muted)"),s(x,()=>D.description),ie(F=>d(M,{...w,background:r()[D.key]?"var(--primary-color-light)":"transparent"},F)),ie(()=>he.checked=!!r()[D.key]),M})()})),H})(),(()=>{var H=lm();return H.style.setProperty("display","flex"),H.style.setProperty("gap","1rem"),H.style.setProperty("justify-content","flex-end"),s(H,_(De,{variant:"secondary",onClick:()=>n(null),children:"Cancel"}),null),s(H,_(De,{variant:"primary",onClick:Z,get disabled(){return a()},get children(){return a()?"Saving...":"Save Changes"}}),null),H})()]}})]}})),ie(()=>W.value=u()),y}})}})};_t(["input","click"]);var Qx=G("<div><main>");const Jx=t=>[_(Ow,{}),me(()=>t.children)],Xx=()=>_(pw,{get children(){var t=Qx(),e=t.firstChild;return s(e,_(Vp,{root:Jx,get children(){return[_(Hr,{path:"/",component:rC}),_(Hr,{path:"/accounts",component:()=>_(Zr,{permission:"AccountAccess",featureName:"Accounts",get children(){return _(zC,{})}})}),_(Hr,{path:"/accounts/:id",component:()=>_(Zr,{permission:"AccountAccess",featureName:"Account Details",get children(){return _(QC,{})}})}),_(Hr,{path:"/entry-books",component:()=>_(Zr,{permission:"JournalAccess",featureName:"Entry Books",get children(){return _(Dx,{})}})}),_(Hr,{path:"/employees",component:()=>_(Zr,{permission:"EmployeeAccess",featureName:"Employee Management",get children(){return _(wE,{})}})}),_(Hr,{path:"/bank-consolidations",component:()=>_(Zr,{permission:"BankingAccess",featureName:"Bank Consolidations",get children(){return _(JE,{})}})}),_(Hr,{path:"/balance-sheet",component:()=>_(Zr,{permission:"AccountAccess",featureName:"Balance Sheet",get children(){return _(rA,{})}})}),_(Hr,{path:"/invoices",component:()=>_(Zr,{permission:"JournalAccess",featureName:"Invoices",get children(){return _(Vx,{})}})}),_(Hr,{path:"/inventory",component:()=>_(Zr,{permission:"InventoryAccess",featureName:"Inventory Management",get children(){return _(fE,{})}})}),_(Hr,{path:"/products",component:()=>_(Zr,{permission:"InventoryAccess",featureName:"Product Management",get children(){return _(fg,{})}})}),_(Hr,{path:"/admin/users",component:()=>_(Zr,{permission:"isAdmin",featureName:"User Administration",get children(){return _(Kx,{})}})})]}})),s(t,(()=>{var r=me(()=>!1);return()=>r()&&_(Kw,{})})(),null),t}}),Zx=document.getElementById("root");Zg(()=>_(Xx,{}),Zx);
