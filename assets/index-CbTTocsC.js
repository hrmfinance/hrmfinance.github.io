(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const rg=!1,ng=(t,e)=>t===e,Gr=Symbol("solid-proxy"),zh=typeof Proxy=="function",El=Symbol("solid-track"),Zs={equals:ng};let qh=Xh;const Zn=1,ea=2,Hh={owned:null,cleanups:null,context:null,owner:null};var Ct=null;let Qa=null,ig=null,Lt=null,Pr=null,Sn=null,xa=0;function Ro(t,e){const r=Lt,n=Ct,i=t.length===0,o=e===void 0?n:e,a=i?Hh:{owned:null,cleanups:null,context:o?o.context:null,owner:o},c=i?t:()=>t(()=>Vr(()=>Fo(a)));Ct=a,Lt=null;try{return ti(c,!0)}finally{Lt=r,Ct=n}}function ye(t,e){e=e?Object.assign({},Zs,e):Zs;const r={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},n=i=>(typeof i=="function"&&(i=i(r.value)),Jh(r,i));return[Qh.bind(r),n]}function ne(t,e,r){const n=cc(t,e,!1,Zn);ts(n)}function ei(t,e,r){qh=lg;const n=cc(t,e,!1,Zn);n.user=!0,Sn?Sn.push(n):ts(n)}function qe(t,e,r){r=r?Object.assign({},Zs,r):Zs;const n=cc(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,ts(n),Qh.bind(n)}function Wh(t){return ti(t,!1)}function Vr(t){if(Lt===null)return t();const e=Lt;Lt=null;try{return t()}finally{Lt=e}}function sc(t,e,r){const n=Array.isArray(t);let i,o=r&&r.defer;return a=>{let c;if(n){c=Array(t.length);for(let h=0;h<t.length;h++)c[h]=t[h]()}else c=t();if(o)return o=!1,a;const u=Vr(()=>e(c,i,a));return i=c,u}}function cn(t){ei(()=>Vr(t))}function to(t){return Ct===null||(Ct.cleanups===null?Ct.cleanups=[t]:Ct.cleanups.push(t)),t}function xl(){return Lt}function Gh(){return Ct}function Kh(t,e){const r=Ct,n=Lt;Ct=t,Lt=null;try{return ti(e,!0)}catch(i){uc(i)}finally{Ct=r,Lt=n}}function og(t){const e=Lt,r=Ct;return Promise.resolve().then(()=>{Lt=e,Ct=r;let n;return ti(t,!1),Lt=Ct=null,n?n.done:void 0})}const[vx,bx]=ye(!1);function Yh(t,e){const r=Symbol("context");return{id:r,Provider:ug(r),defaultValue:t}}function ac(t){let e;return Ct&&Ct.context&&(e=Ct.context[t.id])!==void 0?e:t.defaultValue}function lc(t){const e=qe(t),r=qe(()=>Tl(e()));return r.toArray=()=>{const n=r();return Array.isArray(n)?n:n!=null?[n]:[]},r}function Qh(){if(this.sources&&this.state)if(this.state===Zn)ts(this);else{const t=Pr;Pr=null,ti(()=>ra(this),!1),Pr=t}if(Lt){const t=this.observers?this.observers.length:0;Lt.sources?(Lt.sources.push(this),Lt.sourceSlots.push(t)):(Lt.sources=[this],Lt.sourceSlots=[t]),this.observers?(this.observers.push(Lt),this.observerSlots.push(Lt.sources.length-1)):(this.observers=[Lt],this.observerSlots=[Lt.sources.length-1])}return this.value}function Jh(t,e,r){let n=t.value;return(!t.comparator||!t.comparator(n,e))&&(t.value=e,t.observers&&t.observers.length&&ti(()=>{for(let i=0;i<t.observers.length;i+=1){const o=t.observers[i],a=Qa&&Qa.running;a&&Qa.disposed.has(o),(a?!o.tState:!o.state)&&(o.pure?Pr.push(o):Sn.push(o),o.observers&&Zh(o)),a||(o.state=Zn)}if(Pr.length>1e6)throw Pr=[],new Error},!1)),e}function ts(t){if(!t.fn)return;Fo(t);const e=xa;sg(t,t.value,e)}function sg(t,e,r){let n;const i=Ct,o=Lt;Lt=Ct=t;try{n=t.fn(e)}catch(a){return t.pure&&(t.state=Zn,t.owned&&t.owned.forEach(Fo),t.owned=null),t.updatedAt=r+1,uc(a)}finally{Lt=o,Ct=i}(!t.updatedAt||t.updatedAt<=r)&&(t.updatedAt!=null&&"observers"in t?Jh(t,n):t.value=n,t.updatedAt=r)}function cc(t,e,r,n=Zn,i){const o={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:Ct,context:Ct?Ct.context:null,pure:r};return Ct===null||Ct!==Hh&&(Ct.owned?Ct.owned.push(o):Ct.owned=[o]),o}function ta(t){if(t.state===0)return;if(t.state===ea)return ra(t);if(t.suspense&&Vr(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<xa);)t.state&&e.push(t);for(let r=e.length-1;r>=0;r--)if(t=e[r],t.state===Zn)ts(t);else if(t.state===ea){const n=Pr;Pr=null,ti(()=>ra(t,e[0]),!1),Pr=n}}function ti(t,e){if(Pr)return t();let r=!1;e||(Pr=[]),Sn?r=!0:Sn=[],xa++;try{const n=t();return ag(r),n}catch(n){r||(Sn=null),Pr=null,uc(n)}}function ag(t){if(Pr&&(Xh(Pr),Pr=null),t)return;const e=Sn;Sn=null,e.length&&ti(()=>qh(e),!1)}function Xh(t){for(let e=0;e<t.length;e++)ta(t[e])}function lg(t){let e,r=0;for(e=0;e<t.length;e++){const n=t[e];n.user?t[r++]=n:ta(n)}for(e=0;e<r;e++)ta(t[e])}function ra(t,e){t.state=0;for(let r=0;r<t.sources.length;r+=1){const n=t.sources[r];if(n.sources){const i=n.state;i===Zn?n!==e&&(!n.updatedAt||n.updatedAt<xa)&&ta(n):i===ea&&ra(n,e)}}}function Zh(t){for(let e=0;e<t.observers.length;e+=1){const r=t.observers[e];r.state||(r.state=ea,r.pure?Pr.push(r):Sn.push(r),r.observers&&Zh(r))}}function Fo(t){let e;if(t.sources)for(;t.sources.length;){const r=t.sources.pop(),n=t.sourceSlots.pop(),i=r.observers;if(i&&i.length){const o=i.pop(),a=r.observerSlots.pop();n<i.length&&(o.sourceSlots[a]=n,i[n]=o,r.observerSlots[n]=a)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)Fo(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)Fo(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function cg(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function uc(t,e=Ct){throw cg(t)}function Tl(t){if(typeof t=="function"&&!t.length)return Tl(t());if(Array.isArray(t)){const e=[];for(let r=0;r<t.length;r++){const n=Tl(t[r]);Array.isArray(n)?e.push.apply(e,n):e.push(n)}return e}return t}function ug(t,e){return function(n){let i;return ne(()=>i=Vr(()=>(Ct.context={...Ct.context,[t]:n.value},lc(()=>n.children))),void 0),i}}const dg=Symbol("fallback");function Du(t){for(let e=0;e<t.length;e++)t[e]()}function hg(t,e,r={}){let n=[],i=[],o=[],a=0,c=e.length>1?[]:null;return to(()=>Du(o)),()=>{let u=t()||[],h=u.length,f,p;return u[El],Vr(()=>{let C,N,E,T,x,q,ee,Y,ue;if(h===0)a!==0&&(Du(o),o=[],n=[],i=[],a=0,c&&(c=[])),r.fallback&&(n=[dg],i[0]=Ro(ie=>(o[0]=ie,r.fallback())),a=1);else if(a===0){for(i=new Array(h),p=0;p<h;p++)n[p]=u[p],i[p]=Ro(_);a=h}else{for(E=new Array(h),T=new Array(h),c&&(x=new Array(h)),q=0,ee=Math.min(a,h);q<ee&&n[q]===u[q];q++);for(ee=a-1,Y=h-1;ee>=q&&Y>=q&&n[ee]===u[Y];ee--,Y--)E[Y]=i[ee],T[Y]=o[ee],c&&(x[Y]=c[ee]);for(C=new Map,N=new Array(Y+1),p=Y;p>=q;p--)ue=u[p],f=C.get(ue),N[p]=f===void 0?-1:f,C.set(ue,p);for(f=q;f<=ee;f++)ue=n[f],p=C.get(ue),p!==void 0&&p!==-1?(E[p]=i[f],T[p]=o[f],c&&(x[p]=c[f]),p=N[p],C.set(ue,p)):o[f]();for(p=q;p<h;p++)p in E?(i[p]=E[p],o[p]=T[p],c&&(c[p]=x[p],c[p](p))):i[p]=Ro(_);i=i.slice(0,a=h),n=u.slice(0)}return i});function _(C){if(o[p]=C,c){const[N,E]=ye(p);return c[p]=E,e(u[p],N)}return e(u[p])}}}function S(t,e){return Vr(()=>t(e||{}))}function Cs(){return!0}const $l={get(t,e,r){return e===Gr?r:t.get(e)},has(t,e){return e===Gr?!0:t.has(e)},set:Cs,deleteProperty:Cs,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:Cs,deleteProperty:Cs}},ownKeys(t){return t.keys()}};function Ja(t){return(t=typeof t=="function"?t():t)?t:{}}function mg(){for(let t=0,e=this.length;t<e;++t){const r=this[t]();if(r!==void 0)return r}}function kl(...t){let e=!1;for(let a=0;a<t.length;a++){const c=t[a];e=e||!!c&&Gr in c,t[a]=typeof c=="function"?(e=!0,qe(c)):c}if(zh&&e)return new Proxy({get(a){for(let c=t.length-1;c>=0;c--){const u=Ja(t[c])[a];if(u!==void 0)return u}},has(a){for(let c=t.length-1;c>=0;c--)if(a in Ja(t[c]))return!0;return!1},keys(){const a=[];for(let c=0;c<t.length;c++)a.push(...Object.keys(Ja(t[c])));return[...new Set(a)]}},$l);const r={},n=Object.create(null);for(let a=t.length-1;a>=0;a--){const c=t[a];if(!c)continue;const u=Object.getOwnPropertyNames(c);for(let h=u.length-1;h>=0;h--){const f=u[h];if(f==="__proto__"||f==="constructor")continue;const p=Object.getOwnPropertyDescriptor(c,f);if(!n[f])n[f]=p.get?{enumerable:!0,configurable:!0,get:mg.bind(r[f]=[p.get.bind(c)])}:p.value!==void 0?p:void 0;else{const _=r[f];_&&(p.get?_.push(p.get.bind(c)):p.value!==void 0&&_.push(()=>p.value))}}}const i={},o=Object.keys(n);for(let a=o.length-1;a>=0;a--){const c=o[a],u=n[c];u&&u.get?Object.defineProperty(i,c,u):i[c]=u?u.value:void 0}return i}function fg(t,...e){if(zh&&Gr in t){const i=new Set(e.length>1?e.flat():e[0]),o=e.map(a=>new Proxy({get(c){return a.includes(c)?t[c]:void 0},has(c){return a.includes(c)&&c in t},keys(){return a.filter(c=>c in t)}},$l));return o.push(new Proxy({get(a){return i.has(a)?void 0:t[a]},has(a){return i.has(a)?!1:a in t},keys(){return Object.keys(t).filter(a=>!i.has(a))}},$l)),o}const r={},n=e.map(()=>({}));for(const i of Object.getOwnPropertyNames(t)){const o=Object.getOwnPropertyDescriptor(t,i),a=!o.get&&!o.set&&o.enumerable&&o.writable&&o.configurable;let c=!1,u=0;for(const h of e)h.includes(i)&&(c=!0,a?n[u][i]=o.value:Object.defineProperty(n[u],i,o)),++u;c||(a?r[i]=o.value:Object.defineProperty(r,i,o))}return[...n,r]}const yg=t=>`Stale read from <${t}>.`;function Mt(t){const e="fallback"in t&&{fallback:()=>t.fallback};return qe(hg(()=>t.each,t.children,e||void 0))}function Ve(t){const e=t.keyed,r=qe(()=>t.when,void 0,void 0),n=e?r:qe(r,void 0,{equals:(i,o)=>!i==!o});return qe(()=>{const i=n();if(i){const o=t.children;return typeof o=="function"&&o.length>0?Vr(()=>o(e?i:()=>{if(!Vr(n))throw yg("Show");return r()})):o}return t.fallback},void 0,void 0)}const gg=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],pg=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline",...gg]),vg=new Set(["innerHTML","textContent","innerText","children"]),bg=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),_g=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function Sg(t,e){const r=_g[t];return typeof r=="object"?r[e]?r.$:void 0:r}const Pg=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),me=t=>qe(()=>t());function wg(t,e,r){let n=r.length,i=e.length,o=n,a=0,c=0,u=e[i-1].nextSibling,h=null;for(;a<i||c<o;){if(e[a]===r[c]){a++,c++;continue}for(;e[i-1]===r[o-1];)i--,o--;if(i===a){const f=o<n?c?r[c-1].nextSibling:r[o-c]:u;for(;c<o;)t.insertBefore(r[c++],f)}else if(o===c)for(;a<i;)(!h||!h.has(e[a]))&&e[a].remove(),a++;else if(e[a]===r[o-1]&&r[c]===e[i-1]){const f=e[--i].nextSibling;t.insertBefore(r[c++],e[a++].nextSibling),t.insertBefore(r[--o],f),e[i]=r[o]}else{if(!h){h=new Map;let p=c;for(;p<o;)h.set(r[p],p++)}const f=h.get(e[a]);if(f!=null)if(c<f&&f<o){let p=a,_=1,C;for(;++p<i&&p<o&&!((C=h.get(e[p]))==null||C!==f+_);)_++;if(_>f-c){const N=e[a];for(;c<f;)t.insertBefore(r[c++],N)}else t.replaceChild(r[c++],e[a++])}else a++;else e[a++].remove()}}}const Nu="_$DX_DELEGATE";function Cg(t,e,r,n={}){let i;return Ro(o=>{i=o,e===document?t():s(e,t(),e.firstChild?null:void 0,r)},n.owner),()=>{i(),e.textContent=""}}function z(t,e,r,n){let i;const o=()=>{const c=document.createElement("template");return c.innerHTML=t,c.content.firstChild},a=()=>(i||(i=o())).cloneNode(!0);return a.cloneNode=a,a}function St(t,e=window.document){const r=e[Nu]||(e[Nu]=new Set);for(let n=0,i=t.length;n<i;n++){const o=t[n];r.has(o)||(r.add(o),e.addEventListener(o,kg))}}function lt(t,e,r){r==null?t.removeAttribute(e):t.setAttribute(e,r)}function Ag(t,e,r){r?t.setAttribute(e,""):t.removeAttribute(e)}function dc(t,e){e==null?t.removeAttribute("class"):t.className=e}function Si(t,e,r,n){if(n)Array.isArray(r)?(t[`$$${e}`]=r[0],t[`$$${e}Data`]=r[1]):t[`$$${e}`]=r;else if(Array.isArray(r)){const i=r[0];t.addEventListener(e,r[0]=o=>i.call(t,r[1],o))}else t.addEventListener(e,r,typeof r!="function"&&r)}function Ig(t,e,r={}){const n=Object.keys(e||{}),i=Object.keys(r);let o,a;for(o=0,a=i.length;o<a;o++){const c=i[o];!c||c==="undefined"||e[c]||(Lu(t,c,!1),delete r[c])}for(o=0,a=n.length;o<a;o++){const c=n[o],u=!!e[c];!c||c==="undefined"||r[c]===u||!u||(Lu(t,c,!0),r[c]=u)}return r}function d(t,e,r){if(!e)return r?lt(t,"style"):e;const n=t.style;if(typeof e=="string")return n.cssText=e;typeof r=="string"&&(n.cssText=r=void 0),r||(r={}),e||(e={});let i,o;for(o in r)e[o]==null&&n.removeProperty(o),delete r[o];for(o in e)i=e[o],i!==r[o]&&(n.setProperty(o,i),r[o]=i);return r}function Eg(t,e={},r,n){const i={};return ne(()=>i.children=Uo(t,e.children,i.children)),ne(()=>typeof e.ref=="function"&&xg(e.ref,t)),ne(()=>Tg(t,e,r,!0,i,!0)),i}function xg(t,e,r){return Vr(()=>t(e,r))}function s(t,e,r,n){if(r!==void 0&&!n&&(n=[]),typeof e!="function")return Uo(t,e,n,r);ne(i=>Uo(t,e(),i,r),n)}function Tg(t,e,r,n,i={},o=!1){e||(e={});for(const a in i)if(!(a in e)){if(a==="children")continue;i[a]=Mu(t,a,null,i[a],r,o,e)}for(const a in e){if(a==="children")continue;const c=e[a];i[a]=Mu(t,a,c,i[a],r,o,e)}}function $g(t){return t.toLowerCase().replace(/-([a-z])/g,(e,r)=>r.toUpperCase())}function Lu(t,e,r){const n=e.trim().split(/\s+/);for(let i=0,o=n.length;i<o;i++)t.classList.toggle(n[i],r)}function Mu(t,e,r,n,i,o,a){let c,u,h,f,p;if(e==="style")return d(t,r,n);if(e==="classList")return Ig(t,r,n);if(r===n)return n;if(e==="ref")o||r(t);else if(e.slice(0,3)==="on:"){const _=e.slice(3);n&&t.removeEventListener(_,n,typeof n!="function"&&n),r&&t.addEventListener(_,r,typeof r!="function"&&r)}else if(e.slice(0,10)==="oncapture:"){const _=e.slice(10);n&&t.removeEventListener(_,n,!0),r&&t.addEventListener(_,r,!0)}else if(e.slice(0,2)==="on"){const _=e.slice(2).toLowerCase(),C=Pg.has(_);if(!C&&n){const N=Array.isArray(n)?n[0]:n;t.removeEventListener(_,N)}(C||r)&&(Si(t,_,r,C),C&&St([_]))}else e.slice(0,5)==="attr:"?lt(t,e.slice(5),r):e.slice(0,5)==="bool:"?Ag(t,e.slice(5),r):(p=e.slice(0,5)==="prop:")||(h=vg.has(e))||(f=Sg(e,t.tagName))||(u=pg.has(e))||(c=t.nodeName.includes("-")||"is"in a)?(p&&(e=e.slice(5),u=!0),e==="class"||e==="className"?dc(t,r):c&&!u&&!h?t[$g(e)]=r:t[f||e]=r):lt(t,bg[e]||e,r);return r}function kg(t){let e=t.target;const r=`$$${t.type}`,n=t.target,i=t.currentTarget,o=u=>Object.defineProperty(t,"target",{configurable:!0,value:u}),a=()=>{const u=e[r];if(u&&!e.disabled){const h=e[`${r}Data`];if(h!==void 0?u.call(e,h,t):u.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&o(e.host),!0},c=()=>{for(;a()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const u=t.composedPath();o(u[0]);for(let h=0;h<u.length-2&&(e=u[h],!!a());h++){if(e._$host){e=e._$host,c();break}if(e.parentNode===i)break}}else c();o(n)}function Uo(t,e,r,n,i){for(;typeof r=="function";)r=r();if(e===r)return r;const o=typeof e,a=n!==void 0;if(t=a&&r[0]&&r[0].parentNode||t,o==="string"||o==="number"){if(o==="number"&&(e=e.toString(),e===r))return r;if(a){let c=r[0];c&&c.nodeType===3?c.data!==e&&(c.data=e):c=document.createTextNode(e),r=Di(t,r,n,c)}else r!==""&&typeof r=="string"?r=t.firstChild.data=e:r=t.textContent=e}else if(e==null||o==="boolean")r=Di(t,r,n);else{if(o==="function")return ne(()=>{let c=e();for(;typeof c=="function";)c=c();r=Uo(t,c,r,n)}),()=>r;if(Array.isArray(e)){const c=[],u=r&&Array.isArray(r);if(Rl(c,e,r,i))return ne(()=>r=Uo(t,c,r,n,!0)),()=>r;if(c.length===0){if(r=Di(t,r,n),a)return r}else u?r.length===0?Ou(t,c,n):wg(t,r,c):(r&&Di(t),Ou(t,c));r=c}else if(e.nodeType){if(Array.isArray(r)){if(a)return r=Di(t,r,n,e);Di(t,r,null,e)}else r==null||r===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);r=e}}return r}function Rl(t,e,r,n){let i=!1;for(let o=0,a=e.length;o<a;o++){let c=e[o],u=r&&r[t.length],h;if(!(c==null||c===!0||c===!1))if((h=typeof c)=="object"&&c.nodeType)t.push(c);else if(Array.isArray(c))i=Rl(t,c,u)||i;else if(h==="function")if(n){for(;typeof c=="function";)c=c();i=Rl(t,Array.isArray(c)?c:[c],Array.isArray(u)?u:[u])||i}else t.push(c),i=!0;else{const f=String(c);u&&u.nodeType===3&&u.data===f?t.push(u):t.push(document.createTextNode(f))}}return i}function Ou(t,e,r=null){for(let n=0,i=e.length;n<i;n++)t.insertBefore(e[n],r)}function Di(t,e,r,n){if(r===void 0)return t.textContent="";const i=n||document.createTextNode("");if(e.length){let o=!1;for(let a=e.length-1;a>=0;a--){const c=e[a];if(i!==c){const u=c.parentNode===t;!o&&!a?u?t.replaceChild(i,c):t.insertBefore(i,r):u&&c.remove()}else o=!0}}else t.insertBefore(i,r);return[i]}const Rg=!1;function em(){let t=new Set;function e(i){return t.add(i),()=>t.delete(i)}let r=!1;function n(i,o){if(r)return!(r=!1);const a={to:i,options:o,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const c of t)c.listener({...a,from:c.location,retry:u=>{u&&(r=!0),c.navigate(i,{...o,resolve:!1})}});return!a.defaultPrevented}return{subscribe:e,confirm:n}}let Dl;function hc(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Dl=window.history.state._depth}hc();function Dg(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function Ng(t,e){let r=!1;return()=>{const n=Dl;hc();const i=n==null?null:Dl-n;if(r){r=!1;return}i&&e(i)?(r=!0,window.history.go(-i)):t()}}const Lg=/^(?:[a-z0-9]+:)?\/\//i,Mg=/^\/+|(\/)\/+$/g,tm="http://sr";function fi(t,e=!1){const r=t.replace(Mg,"$1");return r?e||/^[?#]/.test(r)?r:"/"+r:""}function Us(t,e,r){if(Lg.test(e))return;const n=fi(t),i=r&&fi(r);let o="";return!i||e.startsWith("/")?o=n:i.toLowerCase().indexOf(n.toLowerCase())!==0?o=n+i:o=i,(o||"/")+fi(e,!o)}function Og(t,e){if(t==null)throw new Error(e);return t}function Vg(t,e){return fi(t).replace(/\/*(\*.*)?$/g,"")+fi(e)}function rm(t){const e={};return t.searchParams.forEach((r,n)=>{n in e?Array.isArray(e[n])?e[n].push(r):e[n]=[e[n],r]:e[n]=r}),e}function Bg(t,e,r){const[n,i]=t.split("/*",2),o=n.split("/").filter(Boolean),a=o.length;return c=>{const u=c.split("/").filter(Boolean),h=u.length-a;if(h<0||h>0&&i===void 0&&!e)return null;const f={path:a?"":"/",params:{}},p=_=>r===void 0?void 0:r[_];for(let _=0;_<a;_++){const C=o[_],N=C[0]===":",E=N?u[_]:u[_].toLowerCase(),T=N?C.slice(1):C.toLowerCase();if(N&&Xa(E,p(T)))f.params[T]=E;else if(N||!Xa(E,T))return null;f.path+=`/${E}`}if(i){const _=h?u.slice(-h).join("/"):"";if(Xa(_,p(i)))f.params[i]=_;else return null}return f}}function Xa(t,e){const r=n=>n===t;return e===void 0?!0:typeof e=="string"?r(e):typeof e=="function"?e(t):Array.isArray(e)?e.some(r):e instanceof RegExp?e.test(t):!1}function Fg(t){const[e,r]=t.pattern.split("/*",2),n=e.split("/").filter(Boolean);return n.reduce((i,o)=>i+(o.startsWith(":")?2:3),n.length-(r===void 0?0:1))}function nm(t){const e=new Map,r=Gh();return new Proxy({},{get(n,i){return e.has(i)||Kh(r,()=>e.set(i,qe(()=>t()[i]))),e.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function im(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let r=t.slice(0,e.index),n=t.slice(e.index+e[0].length);const i=[r,r+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(n);)i.push(r+=e[1]),n=n.slice(e[0].length);return im(n).reduce((o,a)=>[...o,...i.map(c=>c+a)],[])}const Ug=100,om=Yh(),mc=Yh(),rs=()=>Og(ac(om),"<A> and 'use' router primitives can be only used inside a Route."),jg=()=>ac(mc)||rs().base,zg=t=>{const e=jg();return qe(()=>e.resolvePath(t()))},qg=t=>{const e=rs();return qe(()=>{const r=t();return r!==void 0?e.renderPath(r):r})},fc=()=>rs().navigatorFactory(),Hg=()=>rs().location,Wg=()=>rs().params;function Gg(t,e=""){const{component:r,preload:n,load:i,children:o,info:a}=t,c=!o||Array.isArray(o)&&!o.length,u={key:t,component:r,preload:n||i,info:a};return sm(t.path).reduce((h,f)=>{for(const p of im(f)){const _=Vg(e,p);let C=c?_:_.split("/*",1)[0];C=C.split("/").map(N=>N.startsWith(":")||N.startsWith("*")?N:encodeURIComponent(N)).join("/"),h.push({...u,originalPath:f,pattern:C,matcher:Bg(C,!c,t.matchFilters)})}return h},[])}function Kg(t,e=0){return{routes:t,score:Fg(t[t.length-1])*1e4-e,matcher(r){const n=[];for(let i=t.length-1;i>=0;i--){const o=t[i],a=o.matcher(r);if(!a)return null;n.unshift({...a,route:o})}return n}}}function sm(t){return Array.isArray(t)?t:[t]}function am(t,e="",r=[],n=[]){const i=sm(t);for(let o=0,a=i.length;o<a;o++){const c=i[o];if(c&&typeof c=="object"){c.hasOwnProperty("path")||(c.path="");const u=Gg(c,e);for(const h of u){r.push(h);const f=Array.isArray(c.children)&&c.children.length===0;if(c.children&&!f)am(c.children,h.pattern,r,n);else{const p=Kg([...r],n.length);n.push(p)}r.pop()}}}return r.length?n:n.sort((o,a)=>a.score-o.score)}function Za(t,e){for(let r=0,n=t.length;r<n;r++){const i=t[r].matcher(e);if(i)return i}return[]}function Yg(t,e,r){const n=new URL(tm),i=qe(f=>{const p=t();try{return new URL(p,n)}catch{return console.error(`Invalid path ${p}`),f}},n,{equals:(f,p)=>f.href===p.href}),o=qe(()=>i().pathname),a=qe(()=>i().search,!0),c=qe(()=>i().hash),u=()=>"",h=sc(a,()=>rm(i()));return{get pathname(){return o()},get search(){return a()},get hash(){return c()},get state(){return e()},get key(){return u()},query:r?r(h):nm(h)}}let ci;function Qg(){return ci}function Jg(t,e,r,n={}){const{signal:[i,o],utils:a={}}=t,c=a.parsePath||(de=>de),u=a.renderPath||(de=>de),h=a.beforeLeave||em(),f=Us("",n.base||"");if(f===void 0)throw new Error(`${f} is not a valid base path`);f&&!i().value&&o({value:f,replace:!0,scroll:!1});const[p,_]=ye(!1);let C;const N=(de,H)=>{H.value===E()&&H.state===x()||(C===void 0&&_(!0),ci=de,C=H,og(()=>{C===H&&(T(C.value),q(C.state),ue[1]($=>$.filter(Z=>Z.pending)))}).finally(()=>{C===H&&Wh(()=>{ci=void 0,de==="navigate"&&A(C),_(!1),C=void 0})}))},[E,T]=ye(i().value),[x,q]=ye(i().state),ee=Yg(E,x,a.queryWrapper),Y=[],ue=ye([]),ie=qe(()=>typeof n.transformUrl=="function"?Za(e(),n.transformUrl(ee.pathname)):Za(e(),ee.pathname)),I=()=>{const de=ie(),H={};for(let $=0;$<de.length;$++)Object.assign(H,de[$].params);return H},b=a.paramsWrapper?a.paramsWrapper(I,e):nm(I),v={pattern:f,path:()=>f,outlet:()=>null,resolvePath(de){return Us(f,de)}};return ne(sc(i,de=>N("native",de),{defer:!0})),{base:v,location:ee,params:b,isRouting:p,renderPath:u,parsePath:c,navigatorFactory:w,matches:ie,beforeLeave:h,preloadRoute:y,singleFlight:n.singleFlight===void 0?!0:n.singleFlight,submissions:ue};function P(de,H,$){Vr(()=>{if(typeof H=="number"){H&&(a.go?a.go(H):console.warn("Router integration does not support relative routing"));return}const Z=!H||H[0]==="?",{replace:k,resolve:F,scroll:B,state:W}={replace:!1,resolve:!Z,scroll:!0,...$},fe=F?de.resolvePath(H):Us(Z&&ee.pathname||"",H);if(fe===void 0)throw new Error(`Path '${H}' is not a routable path`);if(Y.length>=Ug)throw new Error("Too many redirects");const K=E();(fe!==K||W!==x())&&(Rg||h.confirm(fe,$)&&(Y.push({value:K,replace:k,scroll:B,state:x()}),N("navigate",{value:fe,state:W})))})}function w(de){return de=de||ac(mc)||v,(H,$)=>P(de,H,$)}function A(de){const H=Y[0];H&&(o({...de,replace:H.replace,scroll:H.scroll}),Y.length=0)}function y(de,H){const $=Za(e(),de.pathname),Z=ci;ci="preload";for(let k in $){const{route:F,params:B}=$[k];F.component&&F.component.preload&&F.component.preload();const{preload:W}=F;H&&W&&Kh(r(),()=>W({params:B,location:{pathname:de.pathname,search:de.search,hash:de.hash,query:rm(de),state:null,key:""},intent:"preload"}))}ci=Z}}function Xg(t,e,r,n){const{base:i,location:o,params:a}=t,{pattern:c,component:u,preload:h}=n().route,f=qe(()=>n().path);u&&u.preload&&u.preload();const p=h?h({params:a,location:o,intent:ci||"initial"}):void 0;return{parent:e,pattern:c,path:f,outlet:()=>u?S(u,{params:a,location:o,data:p,get children(){return r()}}):r(),resolvePath(C){return Us(i.path(),C,f())}}}const Zg=t=>e=>{const{base:r}=e,n=lc(()=>e.children),i=qe(()=>am(n(),e.base||""));let o;const a=Jg(t,i,()=>o,{base:r,singleFlight:e.singleFlight,transformUrl:e.transformUrl});return t.create&&t.create(a),S(om.Provider,{value:a,get children(){return S(ep,{routerState:a,get root(){return e.root},get preload(){return e.rootPreload||e.rootLoad},get children(){return[me(()=>(o=Gh())&&null),S(tp,{routerState:a,get branches(){return i()}})]}})}})};function ep(t){const e=t.routerState.location,r=t.routerState.params,n=qe(()=>t.preload&&Vr(()=>{t.preload({params:r,location:e,intent:Qg()||"initial"})}));return S(Ve,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:i=>S(i,{params:r,location:e,get data(){return n()},get children(){return t.children}})})}function tp(t){const e=[];let r;const n=qe(sc(t.routerState.matches,(i,o,a)=>{let c=o&&i.length===o.length;const u=[];for(let h=0,f=i.length;h<f;h++){const p=o&&o[h],_=i[h];a&&p&&_.route.key===p.route.key?u[h]=a[h]:(c=!1,e[h]&&e[h](),Ro(C=>{e[h]=C,u[h]=Xg(t.routerState,u[h-1]||t.routerState.base,Vu(()=>n()[h+1]),()=>t.routerState.matches()[h])}))}return e.splice(i.length).forEach(h=>h()),a&&c?a:(r=u[0],u)}));return Vu(()=>n()&&r)()}const Vu=t=>()=>S(Ve,{get when(){return t()},keyed:!0,children:e=>S(mc.Provider,{value:e,get children(){return e.outlet()}})}),Qr=t=>{const e=lc(()=>t.children);return kl(t,{get children(){return e()}})};function rp([t,e],r,n){return[t,n?i=>e(n(i)):e]}function np(t){let e=!1;const r=i=>typeof i=="string"?{value:i}:i,n=rp(ye(r(t.get()),{equals:(i,o)=>i.value===o.value&&i.state===o.state}),void 0,i=>(!e&&t.set(i),i));return t.init&&to(t.init((i=t.get())=>{e=!0,n[1](r(i)),e=!1})),Zg({signal:n,create:t.create,utils:t.utils})}function ip(t,e,r){return t.addEventListener(e,r),()=>t.removeEventListener(e,r)}function op(t,e){const r=t&&document.getElementById(t);r?r.scrollIntoView():e&&window.scrollTo(0,0)}const sp=new Map;function ap(t=!0,e=!1,r="/_server",n){return i=>{const o=i.base.path(),a=i.navigatorFactory(i.base);let c,u;function h(E){return E.namespaceURI==="http://www.w3.org/2000/svg"}function f(E){if(E.defaultPrevented||E.button!==0||E.metaKey||E.altKey||E.ctrlKey||E.shiftKey)return;const T=E.composedPath().find(ie=>ie instanceof Node&&ie.nodeName.toUpperCase()==="A");if(!T||e&&!T.hasAttribute("link"))return;const x=h(T),q=x?T.href.baseVal:T.href;if((x?T.target.baseVal:T.target)||!q&&!T.hasAttribute("state"))return;const Y=(T.getAttribute("rel")||"").split(/\s+/);if(T.hasAttribute("download")||Y&&Y.includes("external"))return;const ue=x?new URL(q,document.baseURI):new URL(q);if(!(ue.origin!==window.location.origin||o&&ue.pathname&&!ue.pathname.toLowerCase().startsWith(o.toLowerCase())))return[T,ue]}function p(E){const T=f(E);if(!T)return;const[x,q]=T,ee=i.parsePath(q.pathname+q.search+q.hash),Y=x.getAttribute("state");E.preventDefault(),a(ee,{resolve:!1,replace:x.hasAttribute("replace"),scroll:!x.hasAttribute("noscroll"),state:Y?JSON.parse(Y):void 0})}function _(E){const T=f(E);if(!T)return;const[x,q]=T;i.preloadRoute(q,x.getAttribute("preload")!=="false")}function C(E){clearTimeout(c);const T=f(E);if(!T)return u=null;const[x,q]=T;u!==x&&(c=setTimeout(()=>{i.preloadRoute(q,x.getAttribute("preload")!=="false"),u=x},20))}function N(E){if(E.defaultPrevented)return;let T=E.submitter&&E.submitter.hasAttribute("formaction")?E.submitter.getAttribute("formaction"):E.target.getAttribute("action");if(!T)return;if(!T.startsWith("https://action/")){const q=new URL(T,tm);if(T=i.parsePath(q.pathname+q.search),!T.startsWith(r))return}if(E.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const x=sp.get(T);if(x){E.preventDefault();const q=new FormData(E.target,E.submitter);x.call({r:i,f:E.target},E.target.enctype==="multipart/form-data"?q:new URLSearchParams(q))}}St(["click","submit"]),document.addEventListener("click",p),t&&(document.addEventListener("mousemove",C,{passive:!0}),document.addEventListener("focusin",_,{passive:!0}),document.addEventListener("touchstart",_,{passive:!0})),document.addEventListener("submit",N),to(()=>{document.removeEventListener("click",p),t&&(document.removeEventListener("mousemove",C),document.removeEventListener("focusin",_),document.removeEventListener("touchstart",_)),document.removeEventListener("submit",N)})}}function lp(t){const e=t.replace(/^.*?#/,"");if(!e.startsWith("/")){const[,r="/"]=window.location.hash.split("#",2);return`${r}#${e}`}return e}function cp(t){const e=()=>window.location.hash.slice(1),r=em();return np({get:e,set({value:n,replace:i,scroll:o,state:a}){i?window.history.replaceState(Dg(a),"","#"+n):window.history.pushState(a,"","#"+n);const c=n.indexOf("#"),u=c>=0?n.slice(c+1):"";op(u,o),hc()},init:n=>ip(window,"hashchange",Ng(n,i=>!r.confirm(i&&i<0?i:e()))),create:ap(t.preload,t.explicitLinks,t.actionBase),utils:{go:n=>window.history.go(n),renderPath:n=>`#${n}`,parsePath:lp,beforeLeave:r}})(t)}var up=z("<a>");function gn(t){t=kl({inactiveClass:"inactive",activeClass:"active"},t);const[,e]=fg(t,["href","state","class","activeClass","inactiveClass","end"]),r=zg(()=>t.href),n=qg(r),i=Hg(),o=qe(()=>{const a=r();if(a===void 0)return[!1,!1];const c=fi(a.split(/[?#]/,1)[0]).toLowerCase(),u=decodeURI(fi(i.pathname).toLowerCase());return[t.end?c===u:u.startsWith(c+"/")||u===c,c===u]});return(()=>{var a=up();return Eg(a,kl(e,{get href(){return n()||t.href},get state(){return JSON.stringify(t.state)},get classList(){return{...t.class&&{[t.class]:!0},[t.inactiveClass]:!o()[0],[t.activeClass]:o()[0],...e.classList}},link:"",get"aria-current"(){return o()[1]?"page":void 0}}),!1),a})()}const Nl=Symbol("store-raw"),ji=Symbol("store-node"),pn=Symbol("store-has"),lm=Symbol("store-self");function cm(t){let e=t[Gr];if(!e&&(Object.defineProperty(t,Gr,{value:e=new Proxy(t,mp)}),!Array.isArray(t))){const r=Object.keys(t),n=Object.getOwnPropertyDescriptors(t);for(let i=0,o=r.length;i<o;i++){const a=r[i];n[a].get&&Object.defineProperty(t,a,{enumerable:n[a].enumerable,get:n[a].get.bind(e)})}}return e}function na(t){let e;return t!=null&&typeof t=="object"&&(t[Gr]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function jo(t,e=new Set){let r,n,i,o;if(r=t!=null&&t[Nl])return r;if(!na(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let a=0,c=t.length;a<c;a++)i=t[a],(n=jo(i,e))!==i&&(t[a]=n)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const a=Object.keys(t),c=Object.getOwnPropertyDescriptors(t);for(let u=0,h=a.length;u<h;u++)o=a[u],!c[o].get&&(i=t[o],(n=jo(i,e))!==i&&(t[o]=n))}return t}function ia(t,e){let r=t[e];return r||Object.defineProperty(t,e,{value:r=Object.create(null)}),r}function zo(t,e,r){if(t[e])return t[e];const[n,i]=ye(r,{equals:!1,internal:!0});return n.$=i,t[e]=n}function dp(t,e){const r=Reflect.getOwnPropertyDescriptor(t,e);return!r||r.get||!r.configurable||e===Gr||e===ji||(delete r.value,delete r.writable,r.get=()=>t[Gr][e]),r}function um(t){xl()&&zo(ia(t,ji),lm)()}function hp(t){return um(t),Reflect.ownKeys(t)}const mp={get(t,e,r){if(e===Nl)return t;if(e===Gr)return r;if(e===El)return um(t),r;const n=ia(t,ji),i=n[e];let o=i?i():t[e];if(e===ji||e===pn||e==="__proto__")return o;if(!i){const a=Object.getOwnPropertyDescriptor(t,e);xl()&&(typeof o!="function"||t.hasOwnProperty(e))&&!(a&&a.get)&&(o=zo(n,e,o)())}return na(o)?cm(o):o},has(t,e){return e===Nl||e===Gr||e===El||e===ji||e===pn||e==="__proto__"?!0:(xl()&&zo(ia(t,pn),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:hp,getOwnPropertyDescriptor:dp};function oa(t,e,r,n=!1){if(!n&&t[e]===r)return;const i=t[e],o=t.length;r===void 0?(delete t[e],t[pn]&&t[pn][e]&&i!==void 0&&t[pn][e].$()):(t[e]=r,t[pn]&&t[pn][e]&&i===void 0&&t[pn][e].$());let a=ia(t,ji),c;if((c=zo(a,e,i))&&c.$(()=>r),Array.isArray(t)&&t.length!==o){for(let u=t.length;u<o;u++)(c=a[u])&&c.$();(c=zo(a,"length",o))&&c.$(t.length)}(c=a[lm])&&c.$()}function dm(t,e){const r=Object.keys(e);for(let n=0;n<r.length;n+=1){const i=r[n];oa(t,i,e[i])}}function fp(t,e){if(typeof e=="function"&&(e=e(t)),e=jo(e),Array.isArray(e)){if(t===e)return;let r=0,n=e.length;for(;r<n;r++){const i=e[r];t[r]!==i&&oa(t,r,i)}oa(t,"length",n)}else dm(t,e)}function Ao(t,e,r=[]){let n,i=t;if(e.length>1){n=e.shift();const a=typeof n,c=Array.isArray(t);if(Array.isArray(n)){for(let u=0;u<n.length;u++)Ao(t,[n[u]].concat(e),r);return}else if(c&&a==="function"){for(let u=0;u<t.length;u++)n(t[u],u)&&Ao(t,[u].concat(e),r);return}else if(c&&a==="object"){const{from:u=0,to:h=t.length-1,by:f=1}=n;for(let p=u;p<=h;p+=f)Ao(t,[p].concat(e),r);return}else if(e.length>1){Ao(t[n],e,[n].concat(r));return}i=t[n],r=[n].concat(r)}let o=e[0];typeof o=="function"&&(o=o(i,r),o===i)||n===void 0&&o==null||(o=jo(o),n===void 0||na(i)&&na(o)&&!Array.isArray(o)?dm(i,o):oa(t,n,o))}function hm(...[t,e]){const r=jo(t||{}),n=Array.isArray(r),i=cm(r);function o(...a){Wh(()=>{n&&a.length===1?fp(r,a[0]):Ao(r,a)})}return[i,o]}const wt=(t=300+Math.random()*700)=>new Promise(e=>setTimeout(e,t)),ii=(t="")=>`${t}${Date.now()}-${Math.random().toString(36).substr(2,9)}`;let Me={products:[{id:"prod-001",name:"Wireless Headphones",sku:"WH-001",productCode:"WH-001",productName:"Wireless Headphones",description:"High-quality wireless bluetooth headphones",category:"Electronics",unitOfMeasure:"pcs",unitCost:45,sellingPrice:89.99,minStockLevel:10,maxStockLevel:100,isActive:!0,createdDate:"2024-01-15T10:00:00Z",lastModified:"2024-01-15T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-002",name:"USB-C Cable",sku:"USB-001",description:"3ft USB-C charging cable",category:"Accessories",unitOfMeasure:"pcs",unitCost:8.5,sellingPrice:19.99,minStockLevel:25,maxStockLevel:200,isActive:!0,createdDate:"2024-01-16T10:00:00Z",lastModified:"2024-01-16T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-003",name:"Laptop Stand",sku:"LS-001",description:"Adjustable aluminum laptop stand",category:"Office",unitOfMeasure:"pcs",unitCost:25,sellingPrice:49.99,minStockLevel:5,maxStockLevel:50,isActive:!0,createdDate:"2024-01-17T10:00:00Z",lastModified:"2024-01-17T10:00:00Z",businessId:"YB100423253156428"}],locations:[{id:"loc-001",name:"Main Warehouse",code:"WH-001",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-002",name:"Retail Store - Downtown",code:"ST-001",type:"store",address:"456 Main St, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-003",name:"Retail Store - Mall",code:"ST-002",type:"store",address:"789 Mall Blvd, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"}],movements:[{id:"mov-001",productId:"prod-001",productName:"Wireless Headphones",productSku:"WH-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:50,unitCost:45,totalCost:2250,referenceNumber:"PO-001",notes:"Initial stock purchase",createdBy:"admin",createdDate:"2024-01-15T10:00:00Z",invoiceId:"INV-1000001"},{id:"mov-002",productId:"prod-002",productName:"USB-C Cable",productSku:"USB-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:100,unitCost:8.5,totalCost:850,referenceNumber:"PO-001",notes:"Bulk purchase",createdBy:"admin",createdDate:"2024-01-15T10:05:00Z",invoiceId:"INV-1000001"}],accounts:[{id:"acc-001",accountNumber:"1000",accountName:"Cash",accountType:"asset",category:"currentAssets",balance:5e4,parentAccountId:null,description:"Cash and cash equivalents",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"},{id:"acc-002",accountNumber:"1100",accountName:"Accounts Receivable",accountType:"asset",category:"currentAssets",balance:25e3,parentAccountId:null,description:"Money owed by customers",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"}],journalEntries:[{id:"je-001",entryNumber:"JE-001",date:"2024-01-15",description:"Initial cash deposit",reference:"DEP-001",status:"posted",createdBy:"admin",createdAt:"2024-01-15T10:00:00Z",postedAt:"2024-01-15T10:05:00Z",lines:[{id:"jel-001",accountId:"acc-001",accountName:"Cash",description:"Initial deposit",debitAmount:5e4,creditAmount:0},{id:"jel-002",accountId:"acc-003",accountName:"Owner Equity",description:"Initial capital",debitAmount:0,creditAmount:5e4}]}]};const Jt=(t=.05)=>Math.random()<t,Xt=()=>{const t=["Network timeout","Connection refused","Server temporarily unavailable","Invalid request"];throw new Error(t[Math.floor(Math.random()*t.length)])},$r={products:{async getAll(t,e){await wt(),Jt()&&Xt();let r=[...Me.products];if(t&&t.trim()){const n=t.toLowerCase();r=r.filter(i=>i.name.toLowerCase().includes(n)||i.sku.toLowerCase().includes(n)||i.category.toLowerCase().includes(n)||i.description.toLowerCase().includes(n))}return e?.category&&(r=r.filter(n=>n.category===e.category)),e?.isActive!==void 0&&(r=r.filter(n=>n.isActive===e.isActive)),r},async getById(t){return await wt(),Jt()&&Xt(),Me.products.find(e=>e.id===t)||null},async create(t){if(await wt(),Jt()&&Xt(),Me.products.some(r=>r.sku===t.sku))throw new Error("SKU already exists");const e={...t,id:ii("prod-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return Me.products.push(e),e},async update(t,e){await wt(),Jt()&&Xt();const r=Me.products.findIndex(i=>i.id===t);if(r===-1)throw new Error("Product not found");if(e.sku&&Me.products.some(i=>i.id!==t&&i.sku===e.sku))throw new Error("SKU already exists");const n={...Me.products[r],...e,lastModified:new Date().toISOString()};return Me.products[r]=n,n},async delete(t){await wt(),Jt()&&Xt();const e=Me.products.findIndex(n=>n.id===t);if(e===-1)throw new Error("Product not found");return Me.movements.some(n=>n.productId===t)?{success:!1,message:"Cannot delete product with existing movements"}:(Me.products.splice(e,1),{success:!0,message:"Product deleted successfully"})}},locations:{async getAll(t){await wt(),Jt()&&Xt();let e=[...Me.locations];return t?.type&&(e=e.filter(r=>r.type===t.type)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await wt(),Me.locations.find(e=>e.id===t)||null},async create(t){if(await wt(),Jt()&&Xt(),Me.locations.some(r=>r.code===t.code))throw new Error("Location code already exists");const e={...t,id:ii("loc-"),createdDate:new Date().toISOString()};return Me.locations.push(e),e},async update(t,e){await wt(),Jt()&&Xt();const r=Me.locations.findIndex(n=>n.id===t);if(r===-1)throw new Error("Location not found");if(e.code&&Me.locations.some(n=>n.id!==t&&n.code===e.code))throw new Error("Location code already exists");return Me.locations[r]={...Me.locations[r],...e},Me.locations[r]}},movements:{async getAll(t){await wt(),Jt()&&Xt();let e=[...Me.movements];if(t?.productId&&(e=e.filter(r=>r.productId===t.productId)),t?.locationId&&(e=e.filter(r=>r.locationId===t.locationId)),t?.movementType&&(e=e.filter(r=>r.movementType===t.movementType)),t?.dateFrom&&(e=e.filter(r=>r.createdDate>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.createdDate<=t.dateTo)),t?.search){const r=t.search.toLowerCase();e=e.filter(n=>n.productName.toLowerCase().includes(r)||n.productSku.toLowerCase().includes(r)||n.referenceNumber.toLowerCase().includes(r)||n.notes.toLowerCase().includes(r))}return e.sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime()),e},async getById(t){return await wt(),Me.movements.find(e=>e.id===t)||null},async create(t){if(await wt(),Jt()&&Xt(),!Me.products.find(i=>i.id===t.productId))throw new Error("Product not found");if(!Me.locations.find(i=>i.id===t.locationId))throw new Error("Location not found");if(t.movementType==="out"){const i=await this.getStockLevel(t.productId,t.locationId);if(i<t.quantity)throw new Error(`Insufficient stock. Available: ${i}, Requested: ${t.quantity}`)}const n={...t,id:ii("mov-"),createdDate:new Date().toISOString()};return Me.movements.push(n),n},async update(t,e){await wt(),Jt()&&Xt();const r=Me.movements.findIndex(i=>i.id===t);if(r===-1)throw new Error("Movement not found");const n={...Me.movements[r],...e,lastModified:new Date().toISOString()};return Me.movements[r]=n,n},async delete(t){await wt(),Jt()&&Xt();const e=Me.movements.findIndex(r=>r.id===t);if(e===-1)throw new Error("Movement not found");return Me.movements.splice(e,1),{success:!0,message:"Movement deleted successfully"}},async createBulk(t){await wt(),Jt()&&Xt();const e=[],r=[],n=new Date().toISOString(),i=Me.locations.find(o=>o.id===t.locationId);if(!i)return{success:!1,movements:[],errors:["Invalid location"]};for(let o=0;o<t.items.length;o++){const a=t.items[o],c=Me.products.find(f=>f.id===a.productId);if(!c){e.push(`Item ${o+1}: Product not found`);continue}if(a.quantity<=0){e.push(`Item ${o+1}: Quantity must be greater than 0`);continue}if(t.movementType==="out"){const f=await this.getStockLevel(a.productId,t.locationId);if(a.quantity>f){e.push(`Item ${o+1}: Insufficient stock. Available: ${f}, Requested: ${a.quantity}`);continue}}const u=a.unitCost||c.unitCost,h={id:ii("mov-"),productId:c.id,productName:c.name,productSku:c.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:a.quantity,unitCost:u,totalCost:a.quantity*u,referenceNumber:t.referenceNumber,notes:a.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:t.fromLocationId?Me.locations.find(f=>f.id===t.fromLocationId)?.name:void 0};r.push(h)}return e.length>0?{success:!1,movements:[],errors:e}:(Me.movements.push(...r),{success:!0,movements:r,errors:[]})},async getStockLevel(t,e){return await wt(50),Me.movements.filter(r=>r.productId===t&&r.locationId===e).reduce((r,n)=>{switch(n.movementType){case"in":case"adjustment":return r+n.quantity;case"out":return r-n.quantity;case"transfer":return n.locationId===e?r+n.quantity:r;default:return r}},0)},async getStockLevels(){await wt();const t=new Map;for(const e of Me.movements){const r=`${e.productId}-${e.locationId}`;let n=t.get(r);switch(n||(n={id:r,productId:e.productId,locationId:e.locationId,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType){case"in":case"adjustment":n.quantity+=e.quantity;break;case"out":n.quantity-=e.quantity;break;case"transfer":e.locationId===e.locationId&&(n.quantity+=e.quantity);break}new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost,n.availableQuantity=n.quantity-n.reservedQuantity}return Array.from(t.values())}},accounts:{async getAll(t){await wt(),Jt()&&Xt();let e=[...Me.accounts];return t?.accountType&&(e=e.filter(r=>r.accountType===t.accountType)),t?.category&&(e=e.filter(r=>r.category===t.category)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await wt(),Me.accounts.find(e=>e.id===t)||null},async create(t){if(await wt(),Jt()&&Xt(),Me.accounts.some(r=>r.accountNumber===t.accountNumber))throw new Error("Account number already exists");const e={...t,id:ii("acc-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return Me.accounts.push(e),e},async update(t,e){await wt(),Jt()&&Xt();const r=Me.accounts.findIndex(n=>n.id===t);if(r===-1)throw new Error("Account not found");if(e.accountNumber&&Me.accounts.some(n=>n.id!==t&&n.accountNumber===e.accountNumber))throw new Error("Account number already exists");return Me.accounts[r]={...Me.accounts[r],...e,lastModified:new Date().toISOString()},Me.accounts[r]}},journal:{async getAll(t){await wt(),Jt()&&Xt();let e=[...Me.journalEntries];return t?.status&&(e=e.filter(r=>r.status===t.status)),t?.accountId&&(e=e.filter(r=>r.lines.some(n=>n.accountId===t.accountId))),t?.dateFrom&&(e=e.filter(r=>r.date>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.date<=t.dateTo)),e.sort((r,n)=>new Date(n.createdAt).getTime()-new Date(r.createdAt).getTime())},async getById(t){return await wt(),Me.journalEntries.find(e=>e.id===t)||null},async create(t){await wt(),Jt()&&Xt();const e=t.lines.reduce((c,u)=>c+(u.debitAmount||0),0),r=t.lines.reduce((c,u)=>c+(u.creditAmount||0),0);if(Math.abs(e-r)>.01)throw new Error(`Entry is not balanced. Debit: ${e}, Credit: ${r}`);const n=Me.journalEntries.sort((c,u)=>u.entryNumber.localeCompare(c.entryNumber))[0],o=`JE-${((n?parseInt(n.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`,a={...t,id:ii("je-"),entryNumber:o,createdAt:new Date().toISOString(),lines:t.lines.map(c=>({...c,id:ii("jel-")}))};return Me.journalEntries.push(a),a},async update(t,e){await wt(),Jt()&&Xt();const r=Me.journalEntries.findIndex(n=>n.id===t);if(r===-1)throw new Error("Journal entry not found");if(Me.journalEntries[r].status==="posted")throw new Error("Cannot modify posted entries");return Me.journalEntries[r]={...Me.journalEntries[r],...e},Me.journalEntries[r]},async post(t){await wt(),Jt()&&Xt();const e=Me.journalEntries.findIndex(o=>o.id===t);if(e===-1)throw new Error("Journal entry not found");const r=Me.journalEntries[e];if(r.status==="posted")throw new Error("Entry is already posted");const n=r.lines.reduce((o,a)=>o+(a.debitAmount||0),0),i=r.lines.reduce((o,a)=>o+(a.creditAmount||0),0);if(Math.abs(n-i)>.01)throw new Error("Entry must be balanced before posting");return Me.journalEntries[e]={...r,status:"posted",postedAt:new Date().toISOString()},r.lines.forEach(o=>{const a=Me.accounts.findIndex(c=>c.id===o.accountId);if(a!==-1){const c=Me.accounts[a],u=o.debitAmount||0,h=o.creditAmount||0;["asset","expense"].includes(c.accountType)?c.balance+=u-h:c.balance+=h-u}}),Me.journalEntries[e]}},utils:{async getNextEntryNumber(){await wt(100);const t=Me.journalEntries.sort((r,n)=>n.entryNumber.localeCompare(r.entryNumber))[0];return`JE-${((t?parseInt(t.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`},async getNextProductCode(t){await wt(100);const e=t.toUpperCase().slice(0,3),r=Me.products.filter(i=>i.productCode?.startsWith(e)).sort((i,o)=>(o.productCode||"").localeCompare(i.productCode||""));if(r.length===0)return`${e}001`;const n=parseInt(r[0].productCode?.slice(-3)||"0");return`${e}${(n+1).toString().padStart(3,"0")}`},async healthCheck(){return await wt(50),{status:"healthy",timestamp:new Date().toISOString(),version:"1.0.0"}},async resetDatabase(){return await wt(200),Me={products:[...Me.products.slice(0,3)],locations:[...Me.locations.slice(0,3)],movements:[...Me.movements.slice(0,2)],accounts:[...Me.accounts.slice(0,2)],journalEntries:[...Me.journalEntries.slice(0,1)]},{success:!0,message:"Database reset to initial state"}},async getStats(){return await wt(100),{products:Me.products.length,locations:Me.locations.length,movements:Me.movements.length,accounts:Me.accounts.length,journalEntries:Me.journalEntries.length,totalStockValue:Me.movements.reduce((t,e)=>e.movementType==="in"?t+e.totalCost:e.movementType==="out"?t-e.totalCost:t,0)}}}},js=(t=16)=>{const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},Bn=async t=>{const n=await fetch("https://qvamarkets.com/gql_api",{method:"POST",headers:{"Content-Type":"application/json","Accept-Encoding":"gzip, deflate, br",Authorization:"eyJhbGciOiJSUzI1NiIsImtpZCI6IjhlOGZjOGU1NTZmN2E3NmQwOGQzNTgyOWQ2ZjkwYWUyZTEyY2ZkMGQiLCJ0eXAiOiJKV1QifQ"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const i=await n.json();if(i.errors)throw new Error(i.errors[0]?.message||"GraphQL error");return i.data},yp=t=>({ENTRY:"in",in:"in",TRANSFER:"transfer",transfer:"transfer",SALES:"out",out:"out",adjustment:"adjustment"})[t],Ll=t=>({ENTRY:"ENTRY",in:"ENTRY",TRANSFER:"TRANSFER",transfer:"TRANSFER",SALES:"SALES",out:"SALES",adjustment:"adjustment"})[t];function gp(t){var e=[];return t&&Object.keys(t).map(r=>{e.push(t[r])}),e}function pp(t){if(!/^[a-z0-9+/]+={0,2}$/i.test(t)||t.length%4!=0)throw Error("Not base64 string");for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,n,i,o,a,c,u,h,f=[],p=0;p<t.length;p+=4)o=e.indexOf(t.charAt(p)),a=e.indexOf(t.charAt(p+1)),c=e.indexOf(t.charAt(p+2)),u=e.indexOf(t.charAt(p+3)),h=o<<18|a<<12|c<<6|u,r=h>>>16&255,n=h>>>8&255,i=h&255,f[p/4]=String.fromCharCode(r,n,i),u==64&&(f[p/4]=String.fromCharCode(r,n)),c==64&&(f[p/4]=String.fromCharCode(r));return t=f.join(""),t}const vp=async()=>({}),bp=()=>(typeof window<"u"&&localStorage.getItem("hrmfinance-api-mode"),"real");let ui=bp();const qo={getMode(){return ui},setMode(t){ui=t,typeof window<"u"&&localStorage.setItem("hrmfinance-api-mode",t)},isFakeMode(){return ui==="fake"},isRealMode(){return ui==="real"},isHybridMode(){return ui==="hybrid"}},Or=async(t,e,r=!0)=>{if(ui==="fake")return e();if(ui==="real")return t();try{return await t()}catch(n){if(console.warn("Real API failed, falling back to fake server:",n),r)return e();throw n}},Bu={async getAll(t,e){const r=await Bn({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:{businessId:"YB100423253156428",":search0":"produ"}});return gp(r)},async getById(t){return Or(async()=>(await this.getAll()).find(r=>r.id===t)||null,()=>$r.products.getById(t))},async create(t){return Or(async()=>{throw console.log("Creating product via real API:",t),new Error("Real API not implemented yet")},()=>$r.products.create(t))},async update(t,e){return Or(async()=>{throw console.log("Updating product via real API:",t,e),new Error("Real API not implemented yet")},()=>$r.products.update(t,e))},async delete(t){return Or(async()=>{throw console.log("Deleting product via real API:",t),new Error("Real API not implemented yet")},()=>$r.products.delete(t))}},Fn={async getInventory(t,e){if(!(t&&t?.trim()))return[];let r={businessId:"YB100423253156428"};return t&&t.split(" ").map((o,a)=>{o&&(r[":search"+a]=o.trim())}),await Bn({query:"getScanYabaInventory",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async getProducts(t){if(!(t&&t?.trim()))return[];let e={businessId:"YB100423253156428"};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await Bn({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async addInventory(t){let r={query:"addYabaInventory",params:{businessId:"YB100423253156428"},form:t};const n=await Bn(r);return console.log(r),console.log(n),n},async updInventory(t){return await vp()}},Fu={async getAll(t){return Or(async()=>{throw console.log("Getting accounts via real API:",t),new Error("Real API not implemented yet")},()=>$r.accounts.getAll(t))},async getById(t){return Or(async()=>{throw console.log("Getting account by ID via real API:",t),new Error("Real API not implemented yet")},()=>$r.accounts.getById(t))},async create(t){return Or(async()=>{throw console.log("Creating account via real API:",t),new Error("Real API not implemented yet")},()=>$r.accounts.create(t))},async update(t,e){return Or(async()=>{throw console.log("Updating account via real API:",t,e),new Error("Real API not implemented yet")},()=>$r.accounts.update(t,e))}},Uu={async getNextEntryNumber(){return Or(async()=>{throw console.log("Getting next entry number via real API"),new Error("Real API not implemented yet")},()=>$r.utils.getNextEntryNumber())},async getNextProductCode(t){return Or(async()=>{throw console.log("Getting next product code via real API:",t),new Error("Real API not implemented yet")},()=>$r.utils.getNextProductCode(t))},async healthCheck(){return Or(async()=>{const t=await fetch("/api/health");if(!t.ok)throw new Error("Health check failed");return t.json()},()=>$r.utils.healthCheck())},async getStats(){return Or(async()=>{throw console.log("Getting stats via real API"),new Error("Real API not implemented yet")},()=>$r.utils.getStats())}},_p=()=>{qo.setMode("real"),console.log("🚀 HRM Finance initialized in REAL API mode for production")};_p();const Sp=()=>{};var ju={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mm=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},Pp=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[r++];e[n++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[r++],a=t[r++],c=t[r++],u=((i&7)<<18|(o&63)<<12|(a&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const o=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},fm={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const o=t[i],a=i+1<t.length,c=a?t[i+1]:0,u=i+2<t.length,h=u?t[i+2]:0,f=o>>2,p=(o&3)<<4|c>>4;let _=(c&15)<<2|h>>6,C=h&63;u||(C=64,a||(_=64)),n.push(r[f],r[p],r[_],r[C])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(mm(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Pp(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const o=r[t.charAt(i++)],c=i<t.length?r[t.charAt(i)]:0;++i;const h=i<t.length?r[t.charAt(i)]:64;++i;const p=i<t.length?r[t.charAt(i)]:64;if(++i,o==null||c==null||h==null||p==null)throw new wp;const _=o<<2|c>>4;if(n.push(_),h!==64){const C=c<<4&240|h>>2;if(n.push(C),p!==64){const N=h<<6&192|p;n.push(N)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class wp extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Cp=function(t){const e=mm(t);return fm.encodeByteArray(e,!0)},sa=function(t){return Cp(t).replace(/\./g,"")},ym=function(t){try{return fm.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ap(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ip=()=>Ap().__FIREBASE_DEFAULTS__,Ep=()=>{if(typeof process>"u"||typeof ju>"u")return;const t=ju.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},xp=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&ym(t[1]);return e&&JSON.parse(e)},Ta=()=>{try{return Sp()||Ip()||Ep()||xp()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},gm=t=>Ta()?.emulatorHosts?.[t],Tp=t=>{const e=gm(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},pm=()=>Ta()?.config,vm=t=>Ta()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $p{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ro(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function bm(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kp(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[sa(JSON.stringify(r)),sa(JSON.stringify(a)),""].join(".")}const Do={};function Rp(){const t={prod:[],emulator:[]};for(const e of Object.keys(Do))Do[e]?t.emulator.push(e):t.prod.push(e);return t}function Dp(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let zu=!1;function _m(t,e){if(typeof window>"u"||typeof document>"u"||!ro(window.location.host)||Do[t]===e||Do[t]||zu)return;Do[t]=e;function r(_){return`__firebase__banner__${_}`}const n="__firebase__banner",o=Rp().prod.length>0;function a(){const _=document.getElementById(n);_&&_.remove()}function c(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function u(_,C){_.setAttribute("width","24"),_.setAttribute("id",C),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function h(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{zu=!0,a()},_}function f(_,C){_.setAttribute("id",C),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function p(){const _=Dp(n),C=r("text"),N=document.getElementById(C)||document.createElement("span"),E=r("learnmore"),T=document.getElementById(E)||document.createElement("a"),x=r("preprendIcon"),q=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const ee=_.element;c(ee),f(T,E);const Y=h();u(q,x),ee.append(q,N,T,Y),document.body.appendChild(ee)}o?(N.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,N.innerText="Preview backend running in this workspace."),N.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Np(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(wr())}function Lp(){const t=Ta()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Mp(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Op(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Vp(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Bp(){const t=wr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Fp(){return!Lp()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Up(){try{return typeof indexedDB=="object"}catch{return!1}}function jp(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zp="FirebaseError";class En extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=zp,Object.setPrototypeOf(this,En.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ns.prototype.create)}}class ns{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?qp(o,n):"Error",c=`${this.serviceName}: ${a} (${i}).`;return new En(i,c,n)}}function qp(t,e){return t.replace(Hp,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const Hp=/\{\$([^}]+)}/g;function Wp(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function gi(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const o=t[i],a=e[i];if(qu(o)&&qu(a)){if(!gi(o,a))return!1}else if(o!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function qu(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function is(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Gp(t,e){const r=new Kp(t,e);return r.subscribe.bind(r)}class Kp{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");Yp(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=el),i.error===void 0&&(i.error=el),i.complete===void 0&&(i.complete=el);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Yp(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function el(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Br(t){return t&&t._delegate?t._delegate:t}class pi{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const li="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new $p;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Xp(e))try{this.getOrInitializeService({instanceIdentifier:li})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=li){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=li){return this.instances.has(e)}getOptions(e=li){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(o);n===c&&a.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const o=this.instances.get(n);return o&&e(o,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Jp(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=li){return this.component?this.component.multipleInstances?e:li:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Jp(t){return t===li?void 0:t}function Xp(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zp{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new Qp(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ht;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ht||(ht={}));const ev={debug:ht.DEBUG,verbose:ht.VERBOSE,info:ht.INFO,warn:ht.WARN,error:ht.ERROR,silent:ht.SILENT},tv=ht.INFO,rv={[ht.DEBUG]:"log",[ht.VERBOSE]:"log",[ht.INFO]:"info",[ht.WARN]:"warn",[ht.ERROR]:"error"},nv=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=rv[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class yc{constructor(e){this.name=e,this._logLevel=tv,this._logHandler=nv,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ht))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?ev[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ht.DEBUG,...e),this._logHandler(this,ht.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ht.VERBOSE,...e),this._logHandler(this,ht.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ht.INFO,...e),this._logHandler(this,ht.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ht.WARN,...e),this._logHandler(this,ht.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ht.ERROR,...e),this._logHandler(this,ht.ERROR,...e)}}const iv=(t,e)=>e.some(r=>t instanceof r);let Hu,Wu;function ov(){return Hu||(Hu=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function sv(){return Wu||(Wu=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Sm=new WeakMap,Ml=new WeakMap,Pm=new WeakMap,tl=new WeakMap,gc=new WeakMap;function av(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",a)},o=()=>{r(Un(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&Sm.set(r,t)}).catch(()=>{}),gc.set(e,t),e}function lv(t){if(Ml.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",a),t.removeEventListener("abort",a)},o=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",a),t.addEventListener("abort",a)});Ml.set(t,e)}let Ol={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Ml.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Pm.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Un(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function cv(t){Ol=t(Ol)}function uv(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(rl(this),e,...r);return Pm.set(n,e.sort?e.sort():[e]),Un(n)}:sv().includes(t)?function(...e){return t.apply(rl(this),e),Un(Sm.get(this))}:function(...e){return Un(t.apply(rl(this),e))}}function dv(t){return typeof t=="function"?uv(t):(t instanceof IDBTransaction&&lv(t),iv(t,ov())?new Proxy(t,Ol):t)}function Un(t){if(t instanceof IDBRequest)return av(t);if(tl.has(t))return tl.get(t);const e=dv(t);return e!==t&&(tl.set(t,e),gc.set(e,t)),e}const rl=t=>gc.get(t);function hv(t,e,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const a=indexedDB.open(t,e),c=Un(a);return n&&a.addEventListener("upgradeneeded",u=>{n(Un(a.result),u.oldVersion,u.newVersion,Un(a.transaction),u)}),r&&a.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),c.then(u=>{o&&u.addEventListener("close",()=>o()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const mv=["get","getKey","getAll","getAllKeys","count"],fv=["put","add","delete","clear"],nl=new Map;function Gu(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(nl.get(e))return nl.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=fv.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||mv.includes(r)))return;const o=async function(a,...c){const u=this.transaction(a,i?"readwrite":"readonly");let h=u.store;return n&&(h=h.index(c.shift())),(await Promise.all([h[r](...c),i&&u.done]))[0]};return nl.set(e,o),o}cv(t=>({...t,get:(e,r,n)=>Gu(e,r)||t.get(e,r,n),has:(e,r)=>!!Gu(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yv{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(gv(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function gv(t){return t.getComponent()?.type==="VERSION"}const Vl="@firebase/app",Ku="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wn=new yc("@firebase/app"),pv="@firebase/app-compat",vv="@firebase/analytics-compat",bv="@firebase/analytics",_v="@firebase/app-check-compat",Sv="@firebase/app-check",Pv="@firebase/auth",wv="@firebase/auth-compat",Cv="@firebase/database",Av="@firebase/data-connect",Iv="@firebase/database-compat",Ev="@firebase/functions",xv="@firebase/functions-compat",Tv="@firebase/installations",$v="@firebase/installations-compat",kv="@firebase/messaging",Rv="@firebase/messaging-compat",Dv="@firebase/performance",Nv="@firebase/performance-compat",Lv="@firebase/remote-config",Mv="@firebase/remote-config-compat",Ov="@firebase/storage",Vv="@firebase/storage-compat",Bv="@firebase/firestore",Fv="@firebase/ai",Uv="@firebase/firestore-compat",jv="firebase",zv="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bl="[DEFAULT]",qv={[Vl]:"fire-core",[pv]:"fire-core-compat",[bv]:"fire-analytics",[vv]:"fire-analytics-compat",[Sv]:"fire-app-check",[_v]:"fire-app-check-compat",[Pv]:"fire-auth",[wv]:"fire-auth-compat",[Cv]:"fire-rtdb",[Av]:"fire-data-connect",[Iv]:"fire-rtdb-compat",[Ev]:"fire-fn",[xv]:"fire-fn-compat",[Tv]:"fire-iid",[$v]:"fire-iid-compat",[kv]:"fire-fcm",[Rv]:"fire-fcm-compat",[Dv]:"fire-perf",[Nv]:"fire-perf-compat",[Lv]:"fire-rc",[Mv]:"fire-rc-compat",[Ov]:"fire-gcs",[Vv]:"fire-gcs-compat",[Bv]:"fire-fst",[Uv]:"fire-fst-compat",[Fv]:"fire-vertex","fire-js":"fire-js",[jv]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aa=new Map,Hv=new Map,Fl=new Map;function Yu(t,e){try{t.container.addComponent(e)}catch(r){wn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Gi(t){const e=t.name;if(Fl.has(e))return wn.debug(`There were multiple attempts to register component ${e}.`),!1;Fl.set(e,t);for(const r of aa.values())Yu(r,t);for(const r of Hv.values())Yu(r,t);return!0}function pc(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Nr(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wv={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},jn=new ns("app","Firebase",Wv);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gv{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new pi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw jn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const no=zv;function wm(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Bl,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw jn.create("bad-app-name",{appName:String(i)});if(r||(r=pm()),!r)throw jn.create("no-options");const o=aa.get(i);if(o){if(gi(r,o.options)&&gi(n,o.config))return o;throw jn.create("duplicate-app",{appName:i})}const a=new Zp(i);for(const u of Fl.values())a.addComponent(u);const c=new Gv(r,n,a);return aa.set(i,c),c}function Cm(t=Bl){const e=aa.get(t);if(!e&&t===Bl&&pm())return wm();if(!e)throw jn.create("no-app",{appName:t});return e}function zn(t,e,r){let n=qv[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${n}" with version "${e}":`];i&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),wn.warn(a.join(" "));return}Gi(new pi(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kv="firebase-heartbeat-database",Yv=1,Ho="firebase-heartbeat-store";let il=null;function Am(){return il||(il=hv(Kv,Yv,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ho)}catch(r){console.warn(r)}}}}).catch(t=>{throw jn.create("idb-open",{originalErrorMessage:t.message})})),il}async function Qv(t){try{const r=(await Am()).transaction(Ho),n=await r.objectStore(Ho).get(Im(t));return await r.done,n}catch(e){if(e instanceof En)wn.warn(e.message);else{const r=jn.create("idb-get",{originalErrorMessage:e?.message});wn.warn(r.message)}}}async function Qu(t,e){try{const n=(await Am()).transaction(Ho,"readwrite");await n.objectStore(Ho).put(e,Im(t)),await n.done}catch(r){if(r instanceof En)wn.warn(r.message);else{const n=jn.create("idb-set",{originalErrorMessage:r?.message});wn.warn(n.message)}}}function Im(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jv=1024,Xv=30;class Zv{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new tb(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Ju();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>Xv){const i=rb(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){wn.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Ju(),{heartbeatsToSend:r,unsentEntries:n}=eb(this._heartbeatsCache.heartbeats),i=sa(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return wn.warn(e),""}}}function Ju(){return new Date().toISOString().substring(0,10)}function eb(t,e=Jv){const r=[];let n=t.slice();for(const i of t){const o=r.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),Xu(r)>e){o.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Xu(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class tb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Up()?jp().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Qv(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Qu(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Qu(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Xu(t){return sa(JSON.stringify({version:2,heartbeats:t})).length}function rb(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nb(t){Gi(new pi("platform-logger",e=>new yv(e),"PRIVATE")),Gi(new pi("heartbeat",e=>new Zv(e),"PRIVATE")),zn(Vl,Ku,t),zn(Vl,Ku,"esm2020"),zn("fire-js","")}nb("");function Em(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ib=Em,xm=new ns("auth","Firebase",Em());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const la=new yc("@firebase/auth");function ob(t,...e){la.logLevel<=ht.WARN&&la.warn(`Auth (${no}): ${t}`,...e)}function zs(t,...e){la.logLevel<=ht.ERROR&&la.error(`Auth (${no}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sn(t,...e){throw bc(t,...e)}function Wr(t,...e){return bc(t,...e)}function vc(t,e,r){const n={...ib(),[e]:r};return new ns("auth","Firebase",n).create(e,{appName:t.name})}function qn(t){return vc(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Tm(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&sn(t,"argument-error"),vc(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function bc(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return xm.create(t,...e)}function tt(t,e,...r){if(!t)throw bc(e,...r)}function vn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw zs(e),new Error(e)}function Cn(t,e){t||vn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ul(){return typeof self<"u"&&self.location?.href||""}function sb(){return Zu()==="http:"||Zu()==="https:"}function Zu(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ab(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(sb()||Op()||"connection"in navigator)?navigator.onLine:!0}function lb(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e,r){this.shortDelay=e,this.longDelay=r,Cn(r>e,"Short delay should be less than long delay!"),this.isMobile=Np()||Vp()}get(){return ab()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _c(t,e){Cn(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $m{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;vn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;vn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;vn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cb={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ub=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],db=new os(3e4,6e4);function Sc(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function io(t,e,r,n,i={}){return km(t,i,async()=>{let o={},a={};n&&(e==="GET"?a=n:o={body:JSON.stringify(n)});const c=is({key:t.config.apiKey,...a}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const h={method:e,headers:u,...o};return Mp()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&ro(t.emulatorConfig.host)&&(h.credentials="include"),$m.fetch()(await Rm(t,t.config.apiHost,r,c),h)})}async function km(t,e,r){t._canInitEmulator=!1;const n={...cb,...e};try{const i=new mb(t),o=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw As(t,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const c=o.ok?a.errorMessage:a.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw As(t,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw As(t,"email-already-in-use",a);if(u==="USER_DISABLED")throw As(t,"user-disabled",a);const f=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw vc(t,f,h);sn(t,f)}}catch(i){if(i instanceof En)throw i;sn(t,"network-request-failed",{message:String(i)})}}async function hb(t,e,r,n,i={}){const o=await io(t,e,r,n,i);return"mfaPendingCredential"in o&&sn(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function Rm(t,e,r,n){const i=`${e}${r}?${n}`,o=t,a=o.config.emulator?_c(t.config,i):`${t.config.apiScheme}://${i}`;return ub.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(a).toString():a}class mb{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Wr(this.auth,"network-request-failed")),db.get())})}}function As(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Wr(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fb(t,e){return io(t,"POST","/v1/accounts:delete",e)}async function ca(t,e){return io(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function No(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function yb(t,e=!1){const r=Br(t),n=await r.getIdToken(e),i=Pc(n);tt(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:n,authTime:No(ol(i.auth_time)),issuedAtTime:No(ol(i.iat)),expirationTime:No(ol(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}}function ol(t){return Number(t)*1e3}function Pc(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return zs("JWT malformed, contained fewer than 3 sections"),null;try{const i=ym(r);return i?JSON.parse(i):(zs("Failed to decode base64 JWT payload"),null)}catch(i){return zs("Caught error parsing JWT payload as JSON",i?.toString()),null}}function ed(t){const e=Pc(t);return tt(e,"internal-error"),tt(typeof e.exp<"u","internal-error"),tt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wo(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof En&&gb(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function gb({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pb{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jl{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=No(this.lastLoginAt),this.creationTime=No(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ua(t){const e=t.auth,r=await t.getIdToken(),n=await Wo(t,ca(e,{idToken:r}));tt(n?.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const o=i.providerUserInfo?.length?Dm(i.providerUserInfo):[],a=bb(t.providerData,o),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!a?.length,h=c?u:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new jl(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(t,f)}async function vb(t){const e=Br(t);await ua(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function bb(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function Dm(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _b(t,e){const r=await km(t,{},async()=>{const n=is({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,a=await Rm(t,i,"/v1/token",`key=${o}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:n};return t.emulatorConfig&&ro(t.emulatorConfig.host)&&(u.credentials="include"),$m.fetch()(a,u)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function Sb(t,e){return io(t,"POST","/v2/accounts:revokeToken",Sc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){tt(e.idToken,"internal-error"),tt(typeof e.idToken<"u","internal-error"),tt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ed(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){tt(e.length!==0,"internal-error");const r=ed(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(tt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:o}=await _b(e,r);this.updateTokensAndExpiration(n,i,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:o}=r,a=new zi;return n&&(tt(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(tt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(tt(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new zi,this.toJSON())}_performRefresh(){return vn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kn(t,e){tt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class qr{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new pb(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new jl(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Wo(this,this.stsTokenManager.getToken(this.auth,e));return tt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return yb(this,e)}reload(){return vb(this)}_assign(e){this!==e&&(tt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new qr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){tt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await ua(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Nr(this.auth.app))return Promise.reject(qn(this.auth));const e=await this.getIdToken();return await Wo(this,fb(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,o=r.phoneNumber??void 0,a=r.photoURL??void 0,c=r.tenantId??void 0,u=r._redirectEventId??void 0,h=r.createdAt??void 0,f=r.lastLoginAt??void 0,{uid:p,emailVerified:_,isAnonymous:C,providerData:N,stsTokenManager:E}=r;tt(p&&E,e,"internal-error");const T=zi.fromJSON(this.name,E);tt(typeof p=="string",e,"internal-error"),kn(n,e.name),kn(i,e.name),tt(typeof _=="boolean",e,"internal-error"),tt(typeof C=="boolean",e,"internal-error"),kn(o,e.name),kn(a,e.name),kn(c,e.name),kn(u,e.name),kn(h,e.name),kn(f,e.name);const x=new qr({uid:p,auth:e,email:i,emailVerified:_,displayName:n,isAnonymous:C,photoURL:a,phoneNumber:o,tenantId:c,stsTokenManager:T,createdAt:h,lastLoginAt:f});return N&&Array.isArray(N)&&(x.providerData=N.map(q=>({...q}))),u&&(x._redirectEventId=u),x}static async _fromIdTokenResponse(e,r,n=!1){const i=new zi;i.updateFromServerResponse(r);const o=new qr({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await ua(o),o}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];tt(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?Dm(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!o?.length,c=new zi;c.updateFromIdToken(n);const u=new qr({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:a}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new jl(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(u,h),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const td=new Map;function bn(t){Cn(t instanceof Function,"Expected a class definition");let e=td.get(t);return e?(Cn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,td.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}Nm.type="NONE";const rd=Nm;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qs(t,e,r){return`firebase:${t}:${e}:${r}`}class qi{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:o}=this.auth;this.fullUserKey=qs(this.userKey,i.apiKey,o),this.fullPersistenceKey=qs("persistence",i.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await ca(this.auth,{idToken:e}).catch(()=>{});return r?qr._fromGetAccountInfoResponse(this.auth,r,e):null}return qr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new qi(bn(rd),e,n);const i=(await Promise.all(r.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let o=i[0]||bn(rd);const a=qs(n,e.config.apiKey,e.name);let c=null;for(const h of r)try{const f=await h._get(a);if(f){let p;if(typeof f=="string"){const _=await ca(e,{idToken:f}).catch(()=>{});if(!_)break;p=await qr._fromGetAccountInfoResponse(e,_,f)}else p=qr._fromJSON(e,f);h!==o&&(c=p),o=h;break}}catch{}const u=i.filter(h=>h._shouldAllowMigration);return!o._shouldAllowMigration||!u.length?new qi(o,e,n):(o=u[0],c&&await o._set(a,c.toJSON()),await Promise.all(r.map(async h=>{if(h!==o)try{await h._remove(a)}catch{}})),new qi(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nd(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Vm(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Lm(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Fm(e))return"Blackberry";if(Um(e))return"Webos";if(Mm(e))return"Safari";if((e.includes("chrome/")||Om(e))&&!e.includes("edge/"))return"Chrome";if(Bm(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function Lm(t=wr()){return/firefox\//i.test(t)}function Mm(t=wr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Om(t=wr()){return/crios\//i.test(t)}function Vm(t=wr()){return/iemobile/i.test(t)}function Bm(t=wr()){return/android/i.test(t)}function Fm(t=wr()){return/blackberry/i.test(t)}function Um(t=wr()){return/webos/i.test(t)}function wc(t=wr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Pb(t=wr()){return wc(t)&&!!window.navigator?.standalone}function wb(){return Bp()&&document.documentMode===10}function jm(t=wr()){return wc(t)||Bm(t)||Um(t)||Fm(t)||/windows phone/i.test(t)||Vm(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zm(t,e=[]){let r;switch(t){case"Browser":r=nd(wr());break;case"Worker":r=`${nd(wr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${no}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cb{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((a,c)=>{try{const u=e(o);a(u)}catch(u){c(u)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ab(t,e={}){return io(t,"GET","/v2/passwordPolicy",Sc(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ib=6;class Eb{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??Ib,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xb{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new id(this),this.idTokenSubscription=new id(this),this.beforeStateQueue=new Cb(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=xm,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=bn(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await qi.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await ca(this,{idToken:e}),n=await qr._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Nr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,a=n?._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(n=c.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return tt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await ua(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=lb()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Nr(this.app))return Promise.reject(qn(this));const r=e?Br(e):null;return r&&tt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&tt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Nr(this.app)?Promise.reject(qn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Nr(this.app)?Promise.reject(qn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(bn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Ab(this),r=new Eb(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ns("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await Sb(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&bn(e)||this._popupRedirectResolver;tt(r,this,"argument-error"),this.redirectPersistenceManager=await qi.create(this,[bn(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(tt(c,this,"internal-error"),c.then(()=>{a||o(this.currentUser)}),typeof r=="function"){const u=e.addObserver(r,n,i);return()=>{a=!0,u()}}else{const u=e.addObserver(r);return()=>{a=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return tt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=zm(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(Nr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&ob(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Pi(t){return Br(t)}class id{constructor(e){this.auth=e,this.observer=null,this.addObserver=Gp(r=>this.observer=r)}get next(){return tt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Tb(t){Cc=t}function $b(t){return Cc.loadJS(t)}function kb(){return Cc.gapiScript}function Rb(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Db(t,e){const r=pc(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),o=r.getOptions();if(gi(o,e??{}))return i;sn(i,"already-initialized")}return r.initialize({options:e})}function Nb(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(bn);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function Lb(t,e,r){const n=Pi(t);tt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,o=qm(e),{host:a,port:c}=Mb(e),u=c===null?"":`:${c}`,h={url:`${o}//${a}${u}/`},f=Object.freeze({host:a,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){tt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),tt(gi(h,n.config.emulator)&&gi(f,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=f,n.settings.appVerificationDisabledForTesting=!0,ro(a)?(bm(`${o}//${a}${u}`),_m("Auth",!0)):Ob()}function qm(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Mb(t){const e=qm(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const o=i[1];return{host:o,port:od(n.substr(o.length+1))}}else{const[o,a]=n.split(":");return{host:o,port:od(a)}}}function od(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Ob(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hm{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return vn("not implemented")}_getIdTokenResponse(e){return vn("not implemented")}_linkToIdToken(e,r){return vn("not implemented")}_getReauthenticationResolver(e){return vn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hi(t,e){return hb(t,"POST","/v1/accounts:signInWithIdp",Sc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vb="http://localhost";class vi extends Hm{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new vi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):sn("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...o}=r;if(!n||!i)return null;const a=new vi(n,i);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return Hi(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Hi(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Hi(e,r)}buildRequest(){const e={requestUri:Vb,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=is(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss extends $a{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln extends ss{constructor(){super("facebook.com")}static credential(e){return vi._fromParams({providerId:Ln.PROVIDER_ID,signInMethod:Ln.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ln.credentialFromTaggedObject(e)}static credentialFromError(e){return Ln.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ln.credential(e.oauthAccessToken)}catch{return null}}}Ln.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ln.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr extends ss{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return vi._fromParams({providerId:Zr.PROVIDER_ID,signInMethod:Zr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Zr.credentialFromTaggedObject(e)}static credentialFromError(e){return Zr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Zr.credential(r,n)}catch{return null}}}Zr.GOOGLE_SIGN_IN_METHOD="google.com";Zr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn extends ss{constructor(){super("github.com")}static credential(e){return vi._fromParams({providerId:Mn.PROVIDER_ID,signInMethod:Mn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Mn.credentialFromTaggedObject(e)}static credentialFromError(e){return Mn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Mn.credential(e.oauthAccessToken)}catch{return null}}}Mn.GITHUB_SIGN_IN_METHOD="github.com";Mn.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On extends ss{constructor(){super("twitter.com")}static credential(e,r){return vi._fromParams({providerId:On.PROVIDER_ID,signInMethod:On.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return On.credentialFromTaggedObject(e)}static credentialFromError(e){return On.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return On.credential(r,n)}catch{return null}}}On.TWITTER_SIGN_IN_METHOD="twitter.com";On.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const o=await qr._fromIdTokenResponse(e,n,i),a=sd(n);return new Ki({user:o,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=sd(n);return new Ki({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function sd(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da extends En{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,da.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new da(e,r,n,i)}}function Wm(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?da._fromErrorAndOperation(t,o,e,n):o})}async function Bb(t,e,r=!1){const n=await Wo(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Ki._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fb(t,e,r=!1){const{auth:n}=t;if(Nr(n.app))return Promise.reject(qn(n));const i="reauthenticate";try{const o=await Wo(t,Wm(n,i,e,t),r);tt(o.idToken,n,"internal-error");const a=Pc(o.idToken);tt(a,n,"internal-error");const{sub:c}=a;return tt(t.uid===c,n,"user-mismatch"),Ki._forOperation(t,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&sn(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gm(t,e,r=!1){if(Nr(t.app))return Promise.reject(qn(t));const n="signIn",i=await Wm(t,n,e),o=await Ki._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(o.user),o}async function Ub(t,e){return Gm(Pi(t),e)}function jb(t,e,r,n){return Br(t).onIdTokenChanged(e,r,n)}function zb(t,e,r){return Br(t).beforeAuthStateChanged(e,r)}function qb(t,e,r,n){return Br(t).onAuthStateChanged(e,r,n)}function Hb(t){return Br(t).signOut()}const ha="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(ha,"1"),this.storage.removeItem(ha),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wb=1e3,Gb=10;class Ym extends Km{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=jm(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,c,u)=>{this.notifyListeners(a,u)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},o=this.storage.getItem(n);wb()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Gb):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},Wb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ym.type="LOCAL";const Kb=Ym;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm extends Km{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}Qm.type="SESSION";const Jm=Qm;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yb(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new ka(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:o}=r.data,a=this.handlersMap[i];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const c=Array.from(a).map(async h=>h(r.origin,o)),u=await Yb(c);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:u})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ka.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ac(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qb{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,a;return new Promise((c,u)=>{const h=Ac("",20);i.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(p){const _=p;if(_.data.eventId===h)switch(_.data.status){case"ack":clearTimeout(f),o=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),c(_.data.response);break;default:clearTimeout(f),clearTimeout(o),u(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(){return window}function Jb(t){en().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xm(){return typeof en().WorkerGlobalScope<"u"&&typeof en().importScripts=="function"}async function Xb(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Zb(){return navigator?.serviceWorker?.controller||null}function e0(){return Xm()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zm="firebaseLocalStorageDb",t0=1,ma="firebaseLocalStorage",ef="fbase_key";class as{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Ra(t,e){return t.transaction([ma],e?"readwrite":"readonly").objectStore(ma)}function r0(){const t=indexedDB.deleteDatabase(Zm);return new as(t).toPromise()}function zl(){const t=indexedDB.open(Zm,t0);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(ma,{keyPath:ef})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(ma)?e(n):(n.close(),await r0(),e(await zl()))})})}async function ad(t,e,r){const n=Ra(t,!0).put({[ef]:e,value:r});return new as(n).toPromise()}async function n0(t,e){const r=Ra(t,!1).get(e),n=await new as(r).toPromise();return n===void 0?null:n.value}function ld(t,e){const r=Ra(t,!0).delete(e);return new as(r).toPromise()}const i0=800,o0=3;class tf{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await zl(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>o0)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Xm()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ka._getInstance(e0()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await Xb(),!this.activeServiceWorker)return;this.sender=new Qb(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Zb()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await zl();return await ad(e,ha,"1"),await ld(e,ha),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>ad(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>n0(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>ld(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=Ra(i,!1).getAll();return new as(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),i0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}tf.type="LOCAL";const s0=tf;new os(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ic(t,e){return e?bn(e):(tt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec extends Hm{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Hi(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Hi(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Hi(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function a0(t){return Gm(t.auth,new Ec(t),t.bypassAuthState)}function l0(t){const{auth:e,user:r}=t;return tt(r,e,"internal-error"),Fb(r,new Ec(t),t.bypassAuthState)}async function c0(t){const{auth:e,user:r}=t;return tt(r,e,"internal-error"),Bb(r,new Ec(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf{constructor(e,r,n,i,o=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:o,error:a,type:c}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return a0;case"linkViaPopup":case"linkViaRedirect":return c0;case"reauthViaPopup":case"reauthViaRedirect":return l0;default:sn(this.auth,"internal-error")}}resolve(e){Cn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Cn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u0=new os(2e3,1e4);async function d0(t,e,r){if(Nr(t.app))return Promise.reject(Wr(t,"operation-not-supported-in-this-environment"));const n=Pi(t);Tm(t,e,$a);const i=Ic(n,r);return new hi(n,"signInViaPopup",e,i).executeNotNull()}class hi extends rf{constructor(e,r,n,i,o){super(e,r,i,o),this.provider=n,this.authWindow=null,this.pollId=null,hi.currentPopupAction&&hi.currentPopupAction.cancel(),hi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return tt(e,this.auth,"internal-error"),e}async onExecution(){Cn(this.filter.length===1,"Popup operations only handle one event");const e=Ac();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Wr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Wr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,hi.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Wr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,u0.get())};e()}}hi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h0="pendingRedirect",Hs=new Map;class m0 extends rf{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Hs.get(this.auth._key());if(!e){try{const n=await f0(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Hs.set(this.auth._key(),e)}return this.bypassAuthState||Hs.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function f0(t,e){const r=of(e),n=nf(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}async function y0(t,e){return nf(t)._set(of(e),"true")}function g0(t,e){Hs.set(t._key(),e)}function nf(t){return bn(t._redirectPersistence)}function of(t){return qs(h0,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p0(t,e,r){return v0(t,e,r)}async function v0(t,e,r){if(Nr(t.app))return Promise.reject(qn(t));const n=Pi(t);Tm(t,e,$a),await n._initializationPromise;const i=Ic(n,r);return await y0(i,n),i._openRedirect(n,e,"signInViaRedirect")}async function b0(t,e){return await Pi(t)._initializationPromise,sf(t,e,!1)}async function sf(t,e,r=!1){if(Nr(t.app))return Promise.reject(qn(t));const n=Pi(t),i=Ic(n,e),a=await new m0(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _0=10*60*1e3;class S0{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!P0(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!af(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Wr(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=_0&&this.cachedEventUids.clear(),this.cachedEventUids.has(cd(e))}saveEventToCache(e){this.cachedEventUids.add(cd(e)),this.lastProcessedEventTime=Date.now()}}function cd(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function af({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function P0(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return af(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w0(t,e={}){return io(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C0=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,A0=/^https?/;async function I0(t){if(t.config.emulator)return;const{authorizedDomains:e}=await w0(t);for(const r of e)try{if(E0(r))return}catch{}sn(t,"unauthorized-domain")}function E0(t){const e=Ul(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!A0.test(r))return!1;if(C0.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x0=new os(3e4,6e4);function ud(){const t=en().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function T0(t){return new Promise((e,r)=>{function n(){ud(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ud(),r(Wr(t,"network-request-failed"))},timeout:x0.get()})}if(en().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(en().gapi?.load)n();else{const i=Rb("iframefcb");return en()[i]=()=>{gapi.load?n():r(Wr(t,"network-request-failed"))},$b(`${kb()}?onload=${i}`).catch(o=>r(o))}}).catch(e=>{throw Ws=null,e})}let Ws=null;function $0(t){return Ws=Ws||T0(t),Ws}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k0=new os(5e3,15e3),R0="__/auth/iframe",D0="emulator/auth/iframe",N0={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},L0=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function M0(t){const e=t.config;tt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?_c(e,D0):`https://${t.config.authDomain}/${R0}`,n={apiKey:e.apiKey,appName:t.name,v:no},i=L0.get(t.config.apiHost);i&&(n.eid=i);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${is(n).slice(1)}`}async function O0(t){const e=await $0(t),r=en().gapi;return tt(r,t,"internal-error"),e.open({where:document.body,url:M0(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:N0,dontclear:!0},n=>new Promise(async(i,o)=>{await n.restyle({setHideOnLeave:!1});const a=Wr(t,"network-request-failed"),c=en().setTimeout(()=>{o(a)},k0.get());function u(){en().clearTimeout(c),i(n)}n.ping(u).then(u,()=>{o(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V0={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},B0=500,F0=600,U0="_blank",j0="http://localhost";class dd{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function z0(t,e,r,n=B0,i=F0){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const u={...V0,width:n.toString(),height:i.toString(),top:o,left:a},h=wr().toLowerCase();r&&(c=Om(h)?U0:r),Lm(h)&&(e=e||j0,u.scrollbars="yes");const f=Object.entries(u).reduce((_,[C,N])=>`${_}${C}=${N},`,"");if(Pb(h)&&c!=="_self")return q0(e||"",c),new dd(null);const p=window.open(e||"",c,f);tt(p,t,"popup-blocked");try{p.focus()}catch{}return new dd(p)}function q0(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H0="__/auth/handler",W0="emulator/auth/handler",G0=encodeURIComponent("fac");async function hd(t,e,r,n,i,o){tt(t.config.authDomain,t,"auth-domain-config-required"),tt(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:no,eventId:i};if(e instanceof $a){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",Wp(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))a[f]=p}if(e instanceof ss){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const c=a;for(const f of Object.keys(c))c[f]===void 0&&delete c[f];const u=await t._getAppCheckToken(),h=u?`#${G0}=${encodeURIComponent(u)}`:"";return`${K0(t)}?${is(c).slice(1)}${h}`}function K0({config:t}){return t.emulator?_c(t,W0):`https://${t.authDomain}/${H0}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sl="webStorageSupport";class Y0{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Jm,this._completeRedirectFn=sf,this._overrideRedirectResult=g0}async _openPopup(e,r,n,i){Cn(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await hd(e,r,n,Ul(),i);return z0(e,o,Ac())}async _openRedirect(e,r,n,i){await this._originValidation(e);const o=await hd(e,r,n,Ul(),i);return Jb(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:o}=this.eventManagers[r];return i?Promise.resolve(i):(Cn(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await O0(e),n=new S0(e);return r.register("authEvent",i=>(tt(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(sl,{type:sl},i=>{const o=i?.[0]?.[sl];o!==void 0&&r(!!o),sn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=I0(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return jm()||Mm()||wc()}}const Q0=Y0;var md="@firebase/auth",fd="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){tt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X0(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Z0(t){Gi(new pi("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=n.options;tt(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:a,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:zm(t)},h=new xb(n,i,o,u);return Nb(h,r),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Gi(new pi("auth-internal",e=>{const r=Pi(e.getProvider("auth").getImmediate());return(n=>new J0(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),zn(md,fd,X0(t)),zn(md,fd,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e_=5*60,t_=vm("authIdTokenMaxAge")||e_;let yd=null;const r_=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>t_)return;const i=r?.token;yd!==i&&(yd=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function n_(t=Cm()){const e=pc(t,"auth");if(e.isInitialized())return e.getImmediate();const r=Db(t,{popupRedirectResolver:Q0,persistence:[s0,Kb,Jm]}),n=vm("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const a=r_(o.toString());zb(r,a,()=>a(r.currentUser)),jb(r,c=>a(c))}}const i=gm("auth");return i&&Lb(r,`http://${i}`),r}function i_(){return document.getElementsByTagName("head")?.[0]??document}Tb({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const o=Wr("internal-error");o.customData=i,r(o)},n.type="text/javascript",n.charset="UTF-8",i_().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Z0("Browser");var o_="firebase",s_="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zn(o_,s_,"app");var gd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Hn,lf;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,b){function v(){}v.prototype=b.prototype,I.D=b.prototype,I.prototype=new v,I.prototype.constructor=I,I.C=function(P,w,A){for(var y=Array(arguments.length-2),de=2;de<arguments.length;de++)y[de-2]=arguments[de];return b.prototype[w].apply(P,y)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,b,v){v||(v=0);var P=Array(16);if(typeof b=="string")for(var w=0;16>w;++w)P[w]=b.charCodeAt(v++)|b.charCodeAt(v++)<<8|b.charCodeAt(v++)<<16|b.charCodeAt(v++)<<24;else for(w=0;16>w;++w)P[w]=b[v++]|b[v++]<<8|b[v++]<<16|b[v++]<<24;b=I.g[0],v=I.g[1],w=I.g[2];var A=I.g[3],y=b+(A^v&(w^A))+P[0]+3614090360&4294967295;b=v+(y<<7&4294967295|y>>>25),y=A+(w^b&(v^w))+P[1]+3905402710&4294967295,A=b+(y<<12&4294967295|y>>>20),y=w+(v^A&(b^v))+P[2]+606105819&4294967295,w=A+(y<<17&4294967295|y>>>15),y=v+(b^w&(A^b))+P[3]+3250441966&4294967295,v=w+(y<<22&4294967295|y>>>10),y=b+(A^v&(w^A))+P[4]+4118548399&4294967295,b=v+(y<<7&4294967295|y>>>25),y=A+(w^b&(v^w))+P[5]+1200080426&4294967295,A=b+(y<<12&4294967295|y>>>20),y=w+(v^A&(b^v))+P[6]+2821735955&4294967295,w=A+(y<<17&4294967295|y>>>15),y=v+(b^w&(A^b))+P[7]+4249261313&4294967295,v=w+(y<<22&4294967295|y>>>10),y=b+(A^v&(w^A))+P[8]+1770035416&4294967295,b=v+(y<<7&4294967295|y>>>25),y=A+(w^b&(v^w))+P[9]+2336552879&4294967295,A=b+(y<<12&4294967295|y>>>20),y=w+(v^A&(b^v))+P[10]+4294925233&4294967295,w=A+(y<<17&4294967295|y>>>15),y=v+(b^w&(A^b))+P[11]+2304563134&4294967295,v=w+(y<<22&4294967295|y>>>10),y=b+(A^v&(w^A))+P[12]+1804603682&4294967295,b=v+(y<<7&4294967295|y>>>25),y=A+(w^b&(v^w))+P[13]+4254626195&4294967295,A=b+(y<<12&4294967295|y>>>20),y=w+(v^A&(b^v))+P[14]+2792965006&4294967295,w=A+(y<<17&4294967295|y>>>15),y=v+(b^w&(A^b))+P[15]+1236535329&4294967295,v=w+(y<<22&4294967295|y>>>10),y=b+(w^A&(v^w))+P[1]+4129170786&4294967295,b=v+(y<<5&4294967295|y>>>27),y=A+(v^w&(b^v))+P[6]+3225465664&4294967295,A=b+(y<<9&4294967295|y>>>23),y=w+(b^v&(A^b))+P[11]+643717713&4294967295,w=A+(y<<14&4294967295|y>>>18),y=v+(A^b&(w^A))+P[0]+3921069994&4294967295,v=w+(y<<20&4294967295|y>>>12),y=b+(w^A&(v^w))+P[5]+3593408605&4294967295,b=v+(y<<5&4294967295|y>>>27),y=A+(v^w&(b^v))+P[10]+38016083&4294967295,A=b+(y<<9&4294967295|y>>>23),y=w+(b^v&(A^b))+P[15]+3634488961&4294967295,w=A+(y<<14&4294967295|y>>>18),y=v+(A^b&(w^A))+P[4]+3889429448&4294967295,v=w+(y<<20&4294967295|y>>>12),y=b+(w^A&(v^w))+P[9]+568446438&4294967295,b=v+(y<<5&4294967295|y>>>27),y=A+(v^w&(b^v))+P[14]+3275163606&4294967295,A=b+(y<<9&4294967295|y>>>23),y=w+(b^v&(A^b))+P[3]+4107603335&4294967295,w=A+(y<<14&4294967295|y>>>18),y=v+(A^b&(w^A))+P[8]+1163531501&4294967295,v=w+(y<<20&4294967295|y>>>12),y=b+(w^A&(v^w))+P[13]+2850285829&4294967295,b=v+(y<<5&4294967295|y>>>27),y=A+(v^w&(b^v))+P[2]+4243563512&4294967295,A=b+(y<<9&4294967295|y>>>23),y=w+(b^v&(A^b))+P[7]+1735328473&4294967295,w=A+(y<<14&4294967295|y>>>18),y=v+(A^b&(w^A))+P[12]+2368359562&4294967295,v=w+(y<<20&4294967295|y>>>12),y=b+(v^w^A)+P[5]+4294588738&4294967295,b=v+(y<<4&4294967295|y>>>28),y=A+(b^v^w)+P[8]+2272392833&4294967295,A=b+(y<<11&4294967295|y>>>21),y=w+(A^b^v)+P[11]+1839030562&4294967295,w=A+(y<<16&4294967295|y>>>16),y=v+(w^A^b)+P[14]+4259657740&4294967295,v=w+(y<<23&4294967295|y>>>9),y=b+(v^w^A)+P[1]+2763975236&4294967295,b=v+(y<<4&4294967295|y>>>28),y=A+(b^v^w)+P[4]+1272893353&4294967295,A=b+(y<<11&4294967295|y>>>21),y=w+(A^b^v)+P[7]+4139469664&4294967295,w=A+(y<<16&4294967295|y>>>16),y=v+(w^A^b)+P[10]+3200236656&4294967295,v=w+(y<<23&4294967295|y>>>9),y=b+(v^w^A)+P[13]+681279174&4294967295,b=v+(y<<4&4294967295|y>>>28),y=A+(b^v^w)+P[0]+3936430074&4294967295,A=b+(y<<11&4294967295|y>>>21),y=w+(A^b^v)+P[3]+3572445317&4294967295,w=A+(y<<16&4294967295|y>>>16),y=v+(w^A^b)+P[6]+76029189&4294967295,v=w+(y<<23&4294967295|y>>>9),y=b+(v^w^A)+P[9]+3654602809&4294967295,b=v+(y<<4&4294967295|y>>>28),y=A+(b^v^w)+P[12]+3873151461&4294967295,A=b+(y<<11&4294967295|y>>>21),y=w+(A^b^v)+P[15]+530742520&4294967295,w=A+(y<<16&4294967295|y>>>16),y=v+(w^A^b)+P[2]+3299628645&4294967295,v=w+(y<<23&4294967295|y>>>9),y=b+(w^(v|~A))+P[0]+4096336452&4294967295,b=v+(y<<6&4294967295|y>>>26),y=A+(v^(b|~w))+P[7]+1126891415&4294967295,A=b+(y<<10&4294967295|y>>>22),y=w+(b^(A|~v))+P[14]+2878612391&4294967295,w=A+(y<<15&4294967295|y>>>17),y=v+(A^(w|~b))+P[5]+4237533241&4294967295,v=w+(y<<21&4294967295|y>>>11),y=b+(w^(v|~A))+P[12]+1700485571&4294967295,b=v+(y<<6&4294967295|y>>>26),y=A+(v^(b|~w))+P[3]+2399980690&4294967295,A=b+(y<<10&4294967295|y>>>22),y=w+(b^(A|~v))+P[10]+4293915773&4294967295,w=A+(y<<15&4294967295|y>>>17),y=v+(A^(w|~b))+P[1]+2240044497&4294967295,v=w+(y<<21&4294967295|y>>>11),y=b+(w^(v|~A))+P[8]+1873313359&4294967295,b=v+(y<<6&4294967295|y>>>26),y=A+(v^(b|~w))+P[15]+4264355552&4294967295,A=b+(y<<10&4294967295|y>>>22),y=w+(b^(A|~v))+P[6]+2734768916&4294967295,w=A+(y<<15&4294967295|y>>>17),y=v+(A^(w|~b))+P[13]+1309151649&4294967295,v=w+(y<<21&4294967295|y>>>11),y=b+(w^(v|~A))+P[4]+4149444226&4294967295,b=v+(y<<6&4294967295|y>>>26),y=A+(v^(b|~w))+P[11]+3174756917&4294967295,A=b+(y<<10&4294967295|y>>>22),y=w+(b^(A|~v))+P[2]+718787259&4294967295,w=A+(y<<15&4294967295|y>>>17),y=v+(A^(w|~b))+P[9]+3951481745&4294967295,I.g[0]=I.g[0]+b&4294967295,I.g[1]=I.g[1]+(w+(y<<21&4294967295|y>>>11))&4294967295,I.g[2]=I.g[2]+w&4294967295,I.g[3]=I.g[3]+A&4294967295}n.prototype.u=function(I,b){b===void 0&&(b=I.length);for(var v=b-this.blockSize,P=this.B,w=this.h,A=0;A<b;){if(w==0)for(;A<=v;)i(this,I,A),A+=this.blockSize;if(typeof I=="string"){for(;A<b;)if(P[w++]=I.charCodeAt(A++),w==this.blockSize){i(this,P),w=0;break}}else for(;A<b;)if(P[w++]=I[A++],w==this.blockSize){i(this,P),w=0;break}}this.h=w,this.o+=b},n.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var b=1;b<I.length-8;++b)I[b]=0;var v=8*this.o;for(b=I.length-8;b<I.length;++b)I[b]=v&255,v/=256;for(this.u(I),I=Array(16),b=v=0;4>b;++b)for(var P=0;32>P;P+=8)I[v++]=this.g[b]>>>P&255;return I};function o(I,b){var v=c;return Object.prototype.hasOwnProperty.call(v,I)?v[I]:v[I]=b(I)}function a(I,b){this.h=b;for(var v=[],P=!0,w=I.length-1;0<=w;w--){var A=I[w]|0;P&&A==b||(v[w]=A,P=!1)}this.g=v}var c={};function u(I){return-128<=I&&128>I?o(I,function(b){return new a([b|0],0>b?-1:0)}):new a([I|0],0>I?-1:0)}function h(I){if(isNaN(I)||!isFinite(I))return p;if(0>I)return T(h(-I));for(var b=[],v=1,P=0;I>=v;P++)b[P]=I/v|0,v*=4294967296;return new a(b,0)}function f(I,b){if(I.length==0)throw Error("number format error: empty string");if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(I.charAt(0)=="-")return T(f(I.substring(1),b));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=h(Math.pow(b,8)),P=p,w=0;w<I.length;w+=8){var A=Math.min(8,I.length-w),y=parseInt(I.substring(w,w+A),b);8>A?(A=h(Math.pow(b,A)),P=P.j(A).add(h(y))):(P=P.j(v),P=P.add(h(y)))}return P}var p=u(0),_=u(1),C=u(16777216);t=a.prototype,t.m=function(){if(E(this))return-T(this).m();for(var I=0,b=1,v=0;v<this.g.length;v++){var P=this.i(v);I+=(0<=P?P:4294967296+P)*b,b*=4294967296}return I},t.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(N(this))return"0";if(E(this))return"-"+T(this).toString(I);for(var b=h(Math.pow(I,6)),v=this,P="";;){var w=Y(v,b).g;v=x(v,w.j(b));var A=((0<v.g.length?v.g[0]:v.h)>>>0).toString(I);if(v=w,N(v))return A+P;for(;6>A.length;)A="0"+A;P=A+P}},t.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function N(I){if(I.h!=0)return!1;for(var b=0;b<I.g.length;b++)if(I.g[b]!=0)return!1;return!0}function E(I){return I.h==-1}t.l=function(I){return I=x(this,I),E(I)?-1:N(I)?0:1};function T(I){for(var b=I.g.length,v=[],P=0;P<b;P++)v[P]=~I.g[P];return new a(v,~I.h).add(_)}t.abs=function(){return E(this)?T(this):this},t.add=function(I){for(var b=Math.max(this.g.length,I.g.length),v=[],P=0,w=0;w<=b;w++){var A=P+(this.i(w)&65535)+(I.i(w)&65535),y=(A>>>16)+(this.i(w)>>>16)+(I.i(w)>>>16);P=y>>>16,A&=65535,y&=65535,v[w]=y<<16|A}return new a(v,v[v.length-1]&-2147483648?-1:0)};function x(I,b){return I.add(T(b))}t.j=function(I){if(N(this)||N(I))return p;if(E(this))return E(I)?T(this).j(T(I)):T(T(this).j(I));if(E(I))return T(this.j(T(I)));if(0>this.l(C)&&0>I.l(C))return h(this.m()*I.m());for(var b=this.g.length+I.g.length,v=[],P=0;P<2*b;P++)v[P]=0;for(P=0;P<this.g.length;P++)for(var w=0;w<I.g.length;w++){var A=this.i(P)>>>16,y=this.i(P)&65535,de=I.i(w)>>>16,H=I.i(w)&65535;v[2*P+2*w]+=y*H,q(v,2*P+2*w),v[2*P+2*w+1]+=A*H,q(v,2*P+2*w+1),v[2*P+2*w+1]+=y*de,q(v,2*P+2*w+1),v[2*P+2*w+2]+=A*de,q(v,2*P+2*w+2)}for(P=0;P<b;P++)v[P]=v[2*P+1]<<16|v[2*P];for(P=b;P<2*b;P++)v[P]=0;return new a(v,0)};function q(I,b){for(;(I[b]&65535)!=I[b];)I[b+1]+=I[b]>>>16,I[b]&=65535,b++}function ee(I,b){this.g=I,this.h=b}function Y(I,b){if(N(b))throw Error("division by zero");if(N(I))return new ee(p,p);if(E(I))return b=Y(T(I),b),new ee(T(b.g),T(b.h));if(E(b))return b=Y(I,T(b)),new ee(T(b.g),b.h);if(30<I.g.length){if(E(I)||E(b))throw Error("slowDivide_ only works with positive integers.");for(var v=_,P=b;0>=P.l(I);)v=ue(v),P=ue(P);var w=ie(v,1),A=ie(P,1);for(P=ie(P,2),v=ie(v,2);!N(P);){var y=A.add(P);0>=y.l(I)&&(w=w.add(v),A=y),P=ie(P,1),v=ie(v,1)}return b=x(I,w.j(b)),new ee(w,b)}for(w=p;0<=I.l(b);){for(v=Math.max(1,Math.floor(I.m()/b.m())),P=Math.ceil(Math.log(v)/Math.LN2),P=48>=P?1:Math.pow(2,P-48),A=h(v),y=A.j(b);E(y)||0<y.l(I);)v-=P,A=h(v),y=A.j(b);N(A)&&(A=_),w=w.add(A),I=x(I,y)}return new ee(w,I)}t.A=function(I){return Y(this,I).h},t.and=function(I){for(var b=Math.max(this.g.length,I.g.length),v=[],P=0;P<b;P++)v[P]=this.i(P)&I.i(P);return new a(v,this.h&I.h)},t.or=function(I){for(var b=Math.max(this.g.length,I.g.length),v=[],P=0;P<b;P++)v[P]=this.i(P)|I.i(P);return new a(v,this.h|I.h)},t.xor=function(I){for(var b=Math.max(this.g.length,I.g.length),v=[],P=0;P<b;P++)v[P]=this.i(P)^I.i(P);return new a(v,this.h^I.h)};function ue(I){for(var b=I.g.length+1,v=[],P=0;P<b;P++)v[P]=I.i(P)<<1|I.i(P-1)>>>31;return new a(v,I.h)}function ie(I,b){var v=b>>5;b%=32;for(var P=I.g.length-v,w=[],A=0;A<P;A++)w[A]=0<b?I.i(A+v)>>>b|I.i(A+v+1)<<32-b:I.i(A+v);return new a(w,I.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,lf=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=f,Hn=a}).apply(typeof gd<"u"?gd:typeof self<"u"?self:typeof window<"u"?window:{});var Is=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var cf,Io,uf,Gs,ql,df,hf,mf;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,m,g){return l==Array.prototype||l==Object.prototype||(l[m]=g.value),l};function r(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Is=="object"&&Is];for(var m=0;m<l.length;++m){var g=l[m];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var n=r(this);function i(l,m){if(m)e:{var g=n;l=l.split(".");for(var L=0;L<l.length-1;L++){var Se=l[L];if(!(Se in g))break e;g=g[Se]}l=l[l.length-1],L=g[l],m=m(L),m!=L&&m!=null&&e(g,l,{configurable:!0,writable:!0,value:m})}}function o(l,m){l instanceof String&&(l+="");var g=0,L=!1,Se={next:function(){if(!L&&g<l.length){var we=g++;return{value:m(we,l[we]),done:!1}}return L=!0,{done:!0,value:void 0}}};return Se[Symbol.iterator]=function(){return Se},Se}i("Array.prototype.values",function(l){return l||function(){return o(this,function(m,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},c=this||self;function u(l){var m=typeof l;return m=m!="object"?m:l?Array.isArray(l)?"array":m:"null",m=="array"||m=="object"&&typeof l.length=="number"}function h(l){var m=typeof l;return m=="object"&&l!=null||m=="function"}function f(l,m,g){return l.call.apply(l.bind,arguments)}function p(l,m,g){if(!l)throw Error();if(2<arguments.length){var L=Array.prototype.slice.call(arguments,2);return function(){var Se=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Se,L),l.apply(m,Se)}}return function(){return l.apply(m,arguments)}}function _(l,m,g){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,_.apply(null,arguments)}function C(l,m){var g=Array.prototype.slice.call(arguments,1);return function(){var L=g.slice();return L.push.apply(L,arguments),l.apply(this,L)}}function N(l,m){function g(){}g.prototype=m.prototype,l.aa=m.prototype,l.prototype=new g,l.prototype.constructor=l,l.Qb=function(L,Se,we){for(var Ne=Array(arguments.length-2),Nt=2;Nt<arguments.length;Nt++)Ne[Nt-2]=arguments[Nt];return m.prototype[Se].apply(L,Ne)}}function E(l){const m=l.length;if(0<m){const g=Array(m);for(let L=0;L<m;L++)g[L]=l[L];return g}return[]}function T(l,m){for(let g=1;g<arguments.length;g++){const L=arguments[g];if(u(L)){const Se=l.length||0,we=L.length||0;l.length=Se+we;for(let Ne=0;Ne<we;Ne++)l[Se+Ne]=L[Ne]}else l.push(L)}}class x{constructor(m,g){this.i=m,this.j=g,this.h=0,this.g=null}get(){let m;return 0<this.h?(this.h--,m=this.g,this.g=m.next,m.next=null):m=this.i(),m}}function q(l){return/^[\s\xa0]*$/.test(l)}function ee(){var l=c.navigator;return l&&(l=l.userAgent)?l:""}function Y(l){return Y[" "](l),l}Y[" "]=function(){};var ue=ee().indexOf("Gecko")!=-1&&!(ee().toLowerCase().indexOf("webkit")!=-1&&ee().indexOf("Edge")==-1)&&!(ee().indexOf("Trident")!=-1||ee().indexOf("MSIE")!=-1)&&ee().indexOf("Edge")==-1;function ie(l,m,g){for(const L in l)m.call(g,l[L],L,l)}function I(l,m){for(const g in l)m.call(void 0,l[g],g,l)}function b(l){const m={};for(const g in l)m[g]=l[g];return m}const v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(l,m){let g,L;for(let Se=1;Se<arguments.length;Se++){L=arguments[Se];for(g in L)l[g]=L[g];for(let we=0;we<v.length;we++)g=v[we],Object.prototype.hasOwnProperty.call(L,g)&&(l[g]=L[g])}}function w(l){var m=1;l=l.split(":");const g=[];for(;0<m&&l.length;)g.push(l.shift()),m--;return l.length&&g.push(l.join(":")),g}function A(l){c.setTimeout(()=>{throw l},0)}function y(){var l=F;let m=null;return l.g&&(m=l.g,l.g=l.g.next,l.g||(l.h=null),m.next=null),m}class de{constructor(){this.h=this.g=null}add(m,g){const L=H.get();L.set(m,g),this.h?this.h.next=L:this.g=L,this.h=L}}var H=new x(()=>new $,l=>l.reset());class ${constructor(){this.next=this.g=this.h=null}set(m,g){this.h=m,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let Z,k=!1,F=new de,B=()=>{const l=c.Promise.resolve(void 0);Z=()=>{l.then(W)}};var W=()=>{for(var l;l=y();){try{l.h.call(l.g)}catch(g){A(g)}var m=H;m.j(l),100>m.h&&(m.h++,l.next=m.g,m.g=l)}k=!1};function fe(){this.s=this.s,this.C=this.C}fe.prototype.s=!1,fe.prototype.ma=function(){this.s||(this.s=!0,this.N())},fe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function K(l,m){this.type=l,this.g=this.target=m,this.defaultPrevented=!1}K.prototype.h=function(){this.defaultPrevented=!0};var he=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var l=!1,m=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const g=()=>{};c.addEventListener("test",g,m),c.removeEventListener("test",g,m)}catch{}return l}();function D(l,m){if(K.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var g=this.type=l.type,L=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=m,m=l.relatedTarget){if(ue){e:{try{Y(m.nodeName);var Se=!0;break e}catch{}Se=!1}Se||(m=null)}}else g=="mouseover"?m=l.fromElement:g=="mouseout"&&(m=l.toElement);this.relatedTarget=m,L?(this.clientX=L.clientX!==void 0?L.clientX:L.pageX,this.clientY=L.clientY!==void 0?L.clientY:L.pageY,this.screenX=L.screenX||0,this.screenY=L.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:U[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&D.aa.h.call(this)}}N(D,K);var U={2:"touch",3:"pen",4:"mouse"};D.prototype.h=function(){D.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Q="closure_listenable_"+(1e6*Math.random()|0),J=0;function ce(l,m,g,L,Se){this.listener=l,this.proxy=null,this.src=m,this.type=g,this.capture=!!L,this.ha=Se,this.key=++J,this.da=this.fa=!1}function oe(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function O(l){this.src=l,this.g={},this.h=0}O.prototype.add=function(l,m,g,L,Se){var we=l.toString();l=this.g[we],l||(l=this.g[we]=[],this.h++);var Ne=pe(l,m,L,Se);return-1<Ne?(m=l[Ne],g||(m.fa=!1)):(m=new ce(m,this.src,we,!!L,Se),m.fa=g,l.push(m)),m};function re(l,m){var g=m.type;if(g in l.g){var L=l.g[g],Se=Array.prototype.indexOf.call(L,m,void 0),we;(we=0<=Se)&&Array.prototype.splice.call(L,Se,1),we&&(oe(m),l.g[g].length==0&&(delete l.g[g],l.h--))}}function pe(l,m,g,L){for(var Se=0;Se<l.length;++Se){var we=l[Se];if(!we.da&&we.listener==m&&we.capture==!!g&&we.ha==L)return Se}return-1}var ve="closure_lm_"+(1e6*Math.random()|0),te={};function se(l,m,g,L,Se){if(Array.isArray(m)){for(var we=0;we<m.length;we++)se(l,m[we],g,L,Se);return null}return g=_e(g),l&&l[Q]?l.K(m,g,h(L)?!!L.capture:!1,Se):R(l,m,g,!1,L,Se)}function R(l,m,g,L,Se,we){if(!m)throw Error("Invalid event type");var Ne=h(Se)?!!Se.capture:!!Se,Nt=G(l);if(Nt||(l[ve]=Nt=new O(l)),g=Nt.add(m,g,L,Ne,we),g.proxy)return g;if(L=M(),g.proxy=L,L.src=l,L.listener=g,l.addEventListener)he||(Se=Ne),Se===void 0&&(Se=!1),l.addEventListener(m.toString(),L,Se);else if(l.attachEvent)l.attachEvent(le(m.toString()),L);else if(l.addListener&&l.removeListener)l.addListener(L);else throw Error("addEventListener and attachEvent are unavailable.");return g}function M(){function l(g){return m.call(l.src,l.listener,g)}const m=j;return l}function V(l,m,g,L,Se){if(Array.isArray(m))for(var we=0;we<m.length;we++)V(l,m[we],g,L,Se);else L=h(L)?!!L.capture:!!L,g=_e(g),l&&l[Q]?(l=l.i,m=String(m).toString(),m in l.g&&(we=l.g[m],g=pe(we,g,L,Se),-1<g&&(oe(we[g]),Array.prototype.splice.call(we,g,1),we.length==0&&(delete l.g[m],l.h--)))):l&&(l=G(l))&&(m=l.g[m.toString()],l=-1,m&&(l=pe(m,g,L,Se)),(g=-1<l?m[l]:null)&&ge(g))}function ge(l){if(typeof l!="number"&&l&&!l.da){var m=l.src;if(m&&m[Q])re(m.i,l);else{var g=l.type,L=l.proxy;m.removeEventListener?m.removeEventListener(g,L,l.capture):m.detachEvent?m.detachEvent(le(g),L):m.addListener&&m.removeListener&&m.removeListener(L),(g=G(m))?(re(g,l),g.h==0&&(g.src=null,m[ve]=null)):oe(l)}}}function le(l){return l in te?te[l]:te[l]="on"+l}function j(l,m){if(l.da)l=!0;else{m=new D(m,this);var g=l.listener,L=l.ha||l.src;l.fa&&ge(l),l=g.call(L,m)}return l}function G(l){return l=l[ve],l instanceof O?l:null}var Pe="__closure_events_fn_"+(1e9*Math.random()>>>0);function _e(l){return typeof l=="function"?l:(l[Pe]||(l[Pe]=function(m){return l.handleEvent(m)}),l[Pe])}function ae(){fe.call(this),this.i=new O(this),this.M=this,this.F=null}N(ae,fe),ae.prototype[Q]=!0,ae.prototype.removeEventListener=function(l,m,g,L){V(this,l,m,g,L)};function be(l,m){var g,L=l.F;if(L)for(g=[];L;L=L.F)g.push(L);if(l=l.M,L=m.type||m,typeof m=="string")m=new K(m,l);else if(m instanceof K)m.target=m.target||l;else{var Se=m;m=new K(L,l),P(m,Se)}if(Se=!0,g)for(var we=g.length-1;0<=we;we--){var Ne=m.g=g[we];Se=X(Ne,L,!0,m)&&Se}if(Ne=m.g=l,Se=X(Ne,L,!0,m)&&Se,Se=X(Ne,L,!1,m)&&Se,g)for(we=0;we<g.length;we++)Ne=m.g=g[we],Se=X(Ne,L,!1,m)&&Se}ae.prototype.N=function(){if(ae.aa.N.call(this),this.i){var l=this.i,m;for(m in l.g){for(var g=l.g[m],L=0;L<g.length;L++)oe(g[L]);delete l.g[m],l.h--}}this.F=null},ae.prototype.K=function(l,m,g,L){return this.i.add(String(l),m,!1,g,L)},ae.prototype.L=function(l,m,g,L){return this.i.add(String(l),m,!0,g,L)};function X(l,m,g,L){if(m=l.i.g[String(m)],!m)return!0;m=m.concat();for(var Se=!0,we=0;we<m.length;++we){var Ne=m[we];if(Ne&&!Ne.da&&Ne.capture==g){var Nt=Ne.listener,lr=Ne.ha||Ne.src;Ne.fa&&re(l.i,Ne),Se=Nt.call(lr,L)!==!1&&Se}}return Se&&!L.defaultPrevented}function Ce(l,m,g){if(typeof l=="function")g&&(l=_(l,g));else if(l&&typeof l.handleEvent=="function")l=_(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(m)?-1:c.setTimeout(l,m||0)}function $e(l){l.g=Ce(()=>{l.g=null,l.i&&(l.i=!1,$e(l))},l.l);const m=l.h;l.h=null,l.m.apply(null,m)}class Ee extends fe{constructor(m,g){super(),this.m=m,this.l=g,this.h=null,this.i=!1,this.g=null}j(m){this.h=arguments,this.g?this.i=!0:$e(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function xe(l){fe.call(this),this.h=l,this.g={}}N(xe,fe);var Oe=[];function He(l){ie(l.g,function(m,g){this.g.hasOwnProperty(g)&&ge(m)},l),l.g={}}xe.prototype.N=function(){xe.aa.N.call(this),He(this)},xe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var je=c.JSON.stringify,Ie=c.JSON.parse,Be=class{stringify(l){return c.JSON.stringify(l,void 0)}parse(l){return c.JSON.parse(l,void 0)}};function We(){}We.prototype.h=null;function ze(l){return l.h||(l.h=l.i())}function Ge(){}var Ae={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function nt(){K.call(this,"d")}N(nt,K);function et(){K.call(this,"c")}N(et,K);var dt={},xt=null;function Tt(){return xt=xt||new ae}dt.La="serverreachability";function Gt(l){K.call(this,dt.La,l)}N(Gt,K);function vt(l){const m=Tt();be(m,new Gt(m))}dt.STAT_EVENT="statevent";function tr(l,m){K.call(this,dt.STAT_EVENT,l),this.stat=m}N(tr,K);function yt(l){const m=Tt();be(m,new tr(m,l))}dt.Ma="timingevent";function At(l,m){K.call(this,dt.Ma,l),this.size=m}N(At,K);function qt(l,m){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){l()},m)}function Ot(){this.g=!0}Ot.prototype.xa=function(){this.g=!1};function Le(l,m,g,L,Se,we){l.info(function(){if(l.g)if(we)for(var Ne="",Nt=we.split("&"),lr=0;lr<Nt.length;lr++){var bt=Nt[lr].split("=");if(1<bt.length){var gr=bt[0];bt=bt[1];var pr=gr.split("_");Ne=2<=pr.length&&pr[1]=="type"?Ne+(gr+"="+bt+"&"):Ne+(gr+"=redacted&")}}else Ne=null;else Ne=we;return"XMLHTTP REQ ("+L+") [attempt "+Se+"]: "+m+`
`+g+`
`+Ne})}function Fe(l,m,g,L,Se,we,Ne){l.info(function(){return"XMLHTTP RESP ("+L+") [ attempt "+Se+"]: "+m+`
`+g+`
`+we+" "+Ne})}function Ke(l,m,g,L){l.info(function(){return"XMLHTTP TEXT ("+m+"): "+Vt(l,g)+(L?" "+L:"")})}function st(l,m){l.info(function(){return"TIMEOUT: "+m})}Ot.prototype.info=function(){};function Vt(l,m){if(!l.g)return m;if(!m)return null;try{var g=JSON.parse(m);if(g){for(l=0;l<g.length;l++)if(Array.isArray(g[l])){var L=g[l];if(!(2>L.length)){var Se=L[1];if(Array.isArray(Se)&&!(1>Se.length)){var we=Se[0];if(we!="noop"&&we!="stop"&&we!="close")for(var Ne=1;Ne<Se.length;Ne++)Se[Ne]=""}}}}return je(g)}catch{return m}}var Je={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},gt={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Pt;function ct(){}N(ct,We),ct.prototype.g=function(){return new XMLHttpRequest},ct.prototype.i=function(){return{}},Pt=new ct;function It(l,m,g,L){this.j=l,this.i=m,this.l=g,this.R=L||1,this.U=new xe(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Cr}function Cr(){this.i=null,this.g="",this.h=!1}var $t={},jt={};function fr(l,m,g){l.L=1,l.v=Ti(Ar(m)),l.m=g,l.P=!0,kt(l,null)}function kt(l,m){l.F=Date.now(),zt(l),l.A=Ar(l.v);var g=l.A,L=l.R;Array.isArray(L)||(L=[String(L)]),du(g.i,"t",L),l.C=0,g=l.j.J,l.h=new Cr,l.g=Tu(l.j,g?m:null,!l.m),0<l.O&&(l.M=new Ee(_(l.Y,l,l.g),l.O)),m=l.U,g=l.g,L=l.ca;var Se="readystatechange";Array.isArray(Se)||(Se&&(Oe[0]=Se.toString()),Se=Oe);for(var we=0;we<Se.length;we++){var Ne=se(g,Se[we],L||m.handleEvent,!1,m.h||m);if(!Ne)break;m.g[Ne.key]=Ne}m=l.H?b(l.H):{},l.m?(l.u||(l.u="POST"),m["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,m)):(l.u="GET",l.g.ea(l.A,l.u,null,m)),vt(),Le(l.i,l.u,l.A,l.l,l.R,l.m)}It.prototype.ca=function(l){l=l.target;const m=this.M;m&&hn(l)==3?m.j():this.Y(l)},It.prototype.Y=function(l){try{if(l==this.g)e:{const pr=hn(this.g);var m=this.g.Ba();const Ri=this.g.Z();if(!(3>pr)&&(pr!=3||this.g&&(this.h.h||this.g.oa()||vu(this.g)))){this.J||pr!=4||m==7||(m==8||0>=Ri?vt(3):vt(2)),kr(this);var g=this.g.Z();this.X=g;t:if(Qt(this)){var L=vu(this.g);l="";var Se=L.length,we=hn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Rr(this),un(this);var Ne="";break t}this.h.i=new c.TextDecoder}for(m=0;m<Se;m++)this.h.h=!0,l+=this.h.i.decode(L[m],{stream:!(we&&m==Se-1)});L.length=0,this.h.g+=l,this.C=0,Ne=this.h.g}else Ne=this.g.oa();if(this.o=g==200,Fe(this.i,this.u,this.A,this.l,this.R,pr,g),this.o){if(this.T&&!this.K){t:{if(this.g){var Nt,lr=this.g;if((Nt=lr.g?lr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!q(Nt)){var bt=Nt;break t}}bt=null}if(g=bt)Ke(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ri(this,g);else{this.o=!1,this.s=3,yt(12),Rr(this),un(this);break e}}if(this.P){g=!0;let zr;for(;!this.J&&this.C<Ne.length;)if(zr=Ur(this,Ne),zr==jt){pr==4&&(this.s=4,yt(14),g=!1),Ke(this.i,this.l,null,"[Incomplete Response]");break}else if(zr==$t){this.s=4,yt(15),Ke(this.i,this.l,Ne,"[Invalid Chunk]"),g=!1;break}else Ke(this.i,this.l,zr,null),ri(this,zr);if(Qt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),pr!=4||Ne.length!=0||this.h.h||(this.s=1,yt(16),g=!1),this.o=this.o&&g,!g)Ke(this.i,this.l,Ne,"[Invalid Chunked Response]"),Rr(this),un(this);else if(0<Ne.length&&!this.W){this.W=!0;var gr=this.j;gr.g==this&&gr.ba&&!gr.M&&(gr.j.info("Great, no buffering proxy detected. Bytes received: "+Ne.length),Ka(gr),gr.M=!0,yt(11))}}else Ke(this.i,this.l,Ne,null),ri(this,Ne);pr==4&&Rr(this),this.o&&!this.J&&(pr==4?Au(this.j,this):(this.o=!1,zt(this)))}else eg(this.g),g==400&&0<Ne.indexOf("Unknown SID")?(this.s=3,yt(12)):(this.s=0,yt(13)),Rr(this),un(this)}}}catch{}finally{}};function Qt(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function Ur(l,m){var g=l.C,L=m.indexOf(`
`,g);return L==-1?jt:(g=Number(m.substring(g,L)),isNaN(g)?$t:(L+=1,L+g>m.length?jt:(m=m.slice(L,L+g),l.C=L+g,m)))}It.prototype.cancel=function(){this.J=!0,Rr(this)};function zt(l){l.S=Date.now()+l.I,ar(l,l.I)}function ar(l,m){if(l.B!=null)throw Error("WatchDog timer not null");l.B=qt(_(l.ba,l),m)}function kr(l){l.B&&(c.clearTimeout(l.B),l.B=null)}It.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(st(this.i,this.A),this.L!=2&&(vt(),yt(17)),Rr(this),this.s=2,un(this)):ar(this,this.S-l)};function un(l){l.j.G==0||l.J||Au(l.j,l)}function Rr(l){kr(l);var m=l.M;m&&typeof m.ma=="function"&&m.ma(),l.M=null,He(l.U),l.g&&(m=l.g,l.g=null,m.abort(),m.ma())}function ri(l,m){try{var g=l.j;if(g.G!=0&&(g.g==l||xi(g.h,l))){if(!l.K&&xi(g.h,l)&&g.G==3){try{var L=g.Da.g.parse(m)}catch{L=null}if(Array.isArray(L)&&L.length==3){var Se=L;if(Se[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<l.F)Ss(g),bs(g);else break e;Ga(g),yt(18)}}else g.za=Se[1],0<g.za-g.T&&37500>Se[2]&&g.F&&g.v==0&&!g.C&&(g.C=qt(_(g.Za,g),6e3));if(1>=uo(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else ni(g,11)}else if((l.K||g.g==l)&&Ss(g),!q(m))for(Se=g.Da.g.parse(m),m=0;m<Se.length;m++){let bt=Se[m];if(g.T=bt[0],bt=bt[1],g.G==2)if(bt[0]=="c"){g.K=bt[1],g.ia=bt[2];const gr=bt[3];gr!=null&&(g.la=gr,g.j.info("VER="+g.la));const pr=bt[4];pr!=null&&(g.Aa=pr,g.j.info("SVER="+g.Aa));const Ri=bt[5];Ri!=null&&typeof Ri=="number"&&0<Ri&&(L=1.5*Ri,g.L=L,g.j.info("backChannelRequestTimeoutMs_="+L)),L=g;const zr=l.g;if(zr){const ws=zr.g?zr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ws){var we=L.h;we.g||ws.indexOf("spdy")==-1&&ws.indexOf("quic")==-1&&ws.indexOf("h2")==-1||(we.j=we.l,we.g=new Set,we.h&&(xn(we,we.h),we.h=null))}if(L.D){const Ya=zr.g?zr.g.getResponseHeader("X-HTTP-Session-Id"):null;Ya&&(L.ya=Ya,Dt(L.I,L.D,Ya))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-l.F,g.j.info("Handshake RTT: "+g.R+"ms")),L=g;var Ne=l;if(L.qa=xu(L,L.J?L.ia:null,L.W),Ne.K){fs(L.h,Ne);var Nt=Ne,lr=L.L;lr&&(Nt.I=lr),Nt.B&&(kr(Nt),zt(Nt)),L.g=Ne}else wu(L);0<g.i.length&&_s(g)}else bt[0]!="stop"&&bt[0]!="close"||ni(g,7);else g.G==3&&(bt[0]=="stop"||bt[0]=="close"?bt[0]=="stop"?ni(g,7):Wa(g):bt[0]!="noop"&&g.l&&g.l.ta(bt),g.v=0)}}vt(4)}catch{}}var Ei=class{constructor(l,m){this.g=l,this.map=m}};function ms(l){this.l=l||10,c.PerformanceNavigationTiming?(l=c.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function co(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function uo(l){return l.h?1:l.g?l.g.size:0}function xi(l,m){return l.h?l.h==m:l.g?l.g.has(m):!1}function xn(l,m){l.g?l.g.add(m):l.h=m}function fs(l,m){l.h&&l.h==m?l.h=null:l.g&&l.g.has(m)&&l.g.delete(m)}ms.prototype.cancel=function(){if(this.i=ho(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function ho(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let m=l.i;for(const g of l.g.values())m=m.concat(g.D);return m}return E(l.i)}function at(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var m=[],g=l.length,L=0;L<g;L++)m.push(l[L]);return m}m=[],g=0;for(L in l)m[g++]=l[L];return m}function Rt(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var m=[];l=l.length;for(var g=0;g<l;g++)m.push(g);return m}m=[],g=0;for(const L in l)m[g++]=L;return m}}}function yr(l,m){if(l.forEach&&typeof l.forEach=="function")l.forEach(m,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,m,void 0);else for(var g=Rt(l),L=at(l),Se=L.length,we=0;we<Se;we++)m.call(void 0,L[we],g&&g[we],l)}var jr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function dn(l,m){if(l){l=l.split("&");for(var g=0;g<l.length;g++){var L=l[g].indexOf("="),Se=null;if(0<=L){var we=l[g].substring(0,L);Se=l[g].substring(L+1)}else we=l[g];m(we,Se?decodeURIComponent(Se.replace(/\+/g," ")):"")}}}function Bt(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Bt){this.h=l.h,Kr(this,l.j),this.o=l.o,this.g=l.g,Yr(this,l.s),this.l=l.l;var m=l.i,g=new yo;g.i=m.i,m.g&&(g.g=new Map(m.g),g.h=m.h),ys(this,g),this.m=l.m}else l&&(m=String(l).match(jr))?(this.h=!1,Kr(this,m[1]||"",!0),this.o=mo(m[2]||""),this.g=mo(m[3]||"",!0),Yr(this,m[4]),this.l=mo(m[5]||"",!0),ys(this,m[6]||"",!0),this.m=mo(m[7]||"")):(this.h=!1,this.i=new yo(null,this.h))}Bt.prototype.toString=function(){var l=[],m=this.j;m&&l.push(fo(m,lu,!0),":");var g=this.g;return(g||m=="file")&&(l.push("//"),(m=this.o)&&l.push(fo(m,lu,!0),"@"),l.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&l.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&l.push("/"),l.push(fo(g,g.charAt(0)=="/"?qy:zy,!0))),(g=this.i.toString())&&l.push("?",g),(g=this.m)&&l.push("#",fo(g,Wy)),l.join("")};function Ar(l){return new Bt(l)}function Kr(l,m,g){l.j=g?mo(m,!0):m,l.j&&(l.j=l.j.replace(/:$/,""))}function Yr(l,m){if(m){if(m=Number(m),isNaN(m)||0>m)throw Error("Bad port number "+m);l.s=m}else l.s=null}function ys(l,m,g){m instanceof yo?(l.i=m,Gy(l.i,l.h)):(g||(m=fo(m,Hy)),l.i=new yo(m,l.h))}function Dt(l,m,g){l.i.set(m,g)}function Ti(l){return Dt(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function mo(l,m){return l?m?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function fo(l,m,g){return typeof l=="string"?(l=encodeURI(l).replace(m,jy),g&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function jy(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var lu=/[#\/\?@]/g,zy=/[#\?:]/g,qy=/[#\?]/g,Hy=/[#\?@]/g,Wy=/#/g;function yo(l,m){this.h=this.g=null,this.i=l||null,this.j=!!m}function Tn(l){l.g||(l.g=new Map,l.h=0,l.i&&dn(l.i,function(m,g){l.add(decodeURIComponent(m.replace(/\+/g," ")),g)}))}t=yo.prototype,t.add=function(l,m){Tn(this),this.i=null,l=$i(this,l);var g=this.g.get(l);return g||this.g.set(l,g=[]),g.push(m),this.h+=1,this};function cu(l,m){Tn(l),m=$i(l,m),l.g.has(m)&&(l.i=null,l.h-=l.g.get(m).length,l.g.delete(m))}function uu(l,m){return Tn(l),m=$i(l,m),l.g.has(m)}t.forEach=function(l,m){Tn(this),this.g.forEach(function(g,L){g.forEach(function(Se){l.call(m,Se,L,this)},this)},this)},t.na=function(){Tn(this);const l=Array.from(this.g.values()),m=Array.from(this.g.keys()),g=[];for(let L=0;L<m.length;L++){const Se=l[L];for(let we=0;we<Se.length;we++)g.push(m[L])}return g},t.V=function(l){Tn(this);let m=[];if(typeof l=="string")uu(this,l)&&(m=m.concat(this.g.get($i(this,l))));else{l=Array.from(this.g.values());for(let g=0;g<l.length;g++)m=m.concat(l[g])}return m},t.set=function(l,m){return Tn(this),this.i=null,l=$i(this,l),uu(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[m]),this.h+=1,this},t.get=function(l,m){return l?(l=this.V(l),0<l.length?String(l[0]):m):m};function du(l,m,g){cu(l,m),0<g.length&&(l.i=null,l.g.set($i(l,m),E(g)),l.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],m=Array.from(this.g.keys());for(var g=0;g<m.length;g++){var L=m[g];const we=encodeURIComponent(String(L)),Ne=this.V(L);for(L=0;L<Ne.length;L++){var Se=we;Ne[L]!==""&&(Se+="="+encodeURIComponent(String(Ne[L]))),l.push(Se)}}return this.i=l.join("&")};function $i(l,m){return m=String(m),l.j&&(m=m.toLowerCase()),m}function Gy(l,m){m&&!l.j&&(Tn(l),l.i=null,l.g.forEach(function(g,L){var Se=L.toLowerCase();L!=Se&&(cu(this,L),du(this,Se,g))},l)),l.j=m}function Ky(l,m){const g=new Ot;if(c.Image){const L=new Image;L.onload=C($n,g,"TestLoadImage: loaded",!0,m,L),L.onerror=C($n,g,"TestLoadImage: error",!1,m,L),L.onabort=C($n,g,"TestLoadImage: abort",!1,m,L),L.ontimeout=C($n,g,"TestLoadImage: timeout",!1,m,L),c.setTimeout(function(){L.ontimeout&&L.ontimeout()},1e4),L.src=l}else m(!1)}function Yy(l,m){const g=new Ot,L=new AbortController,Se=setTimeout(()=>{L.abort(),$n(g,"TestPingServer: timeout",!1,m)},1e4);fetch(l,{signal:L.signal}).then(we=>{clearTimeout(Se),we.ok?$n(g,"TestPingServer: ok",!0,m):$n(g,"TestPingServer: server error",!1,m)}).catch(()=>{clearTimeout(Se),$n(g,"TestPingServer: error",!1,m)})}function $n(l,m,g,L,Se){try{Se&&(Se.onload=null,Se.onerror=null,Se.onabort=null,Se.ontimeout=null),L(g)}catch{}}function Qy(){this.g=new Be}function Jy(l,m,g){const L=g||"";try{yr(l,function(Se,we){let Ne=Se;h(Se)&&(Ne=je(Se)),m.push(L+we+"="+encodeURIComponent(Ne))})}catch(Se){throw m.push(L+"type="+encodeURIComponent("_badmap")),Se}}function gs(l){this.l=l.Ub||null,this.j=l.eb||!1}N(gs,We),gs.prototype.g=function(){return new ps(this.l,this.j)},gs.prototype.i=function(l){return function(){return l}}({});function ps(l,m){ae.call(this),this.D=l,this.o=m,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}N(ps,ae),t=ps.prototype,t.open=function(l,m){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=m,this.readyState=1,po(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const m={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(m.body=l),(this.D||c).fetch(new Request(this.A,m)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,go(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,po(this)),this.g&&(this.readyState=3,po(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;hu(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function hu(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var m=l.value?l.value:new Uint8Array(0);(m=this.v.decode(m,{stream:!l.done}))&&(this.response=this.responseText+=m)}l.done?go(this):po(this),this.readyState==3&&hu(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,go(this))},t.Qa=function(l){this.g&&(this.response=l,go(this))},t.ga=function(){this.g&&go(this)};function go(l){l.readyState=4,l.l=null,l.j=null,l.v=null,po(l)}t.setRequestHeader=function(l,m){this.u.append(l,m)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],m=this.h.entries();for(var g=m.next();!g.done;)g=g.value,l.push(g[0]+": "+g[1]),g=m.next();return l.join(`\r
`)};function po(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(ps.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function mu(l){let m="";return ie(l,function(g,L){m+=L,m+=":",m+=g,m+=`\r
`}),m}function Ha(l,m,g){e:{for(L in g){var L=!1;break e}L=!0}L||(g=mu(g),typeof l=="string"?g!=null&&encodeURIComponent(String(g)):Dt(l,m,g))}function Kt(l){ae.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}N(Kt,ae);var Xy=/^https?$/i,Zy=["POST","PUT"];t=Kt.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,m,g,L){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);m=m?m.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Pt.g(),this.v=this.o?ze(this.o):ze(Pt),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(m,String(l),!0),this.B=!1}catch(we){fu(this,we);return}if(l=g||"",g=new Map(this.headers),L)if(Object.getPrototypeOf(L)===Object.prototype)for(var Se in L)g.set(Se,L[Se]);else if(typeof L.keys=="function"&&typeof L.get=="function")for(const we of L.keys())g.set(we,L.get(we));else throw Error("Unknown input type for opt_headers: "+String(L));L=Array.from(g.keys()).find(we=>we.toLowerCase()=="content-type"),Se=c.FormData&&l instanceof c.FormData,!(0<=Array.prototype.indexOf.call(Zy,m,void 0))||L||Se||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[we,Ne]of g)this.g.setRequestHeader(we,Ne);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{pu(this),this.u=!0,this.g.send(l),this.u=!1}catch(we){fu(this,we)}};function fu(l,m){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=m,l.m=5,yu(l),vs(l)}function yu(l){l.A||(l.A=!0,be(l,"complete"),be(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,be(this,"complete"),be(this,"abort"),vs(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),vs(this,!0)),Kt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?gu(this):this.bb())},t.bb=function(){gu(this)};function gu(l){if(l.h&&typeof a<"u"&&(!l.v[1]||hn(l)!=4||l.Z()!=2)){if(l.u&&hn(l)==4)Ce(l.Ea,0,l);else if(be(l,"readystatechange"),hn(l)==4){l.h=!1;try{const Ne=l.Z();e:switch(Ne){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var m=!0;break e;default:m=!1}var g;if(!(g=m)){var L;if(L=Ne===0){var Se=String(l.D).match(jr)[1]||null;!Se&&c.self&&c.self.location&&(Se=c.self.location.protocol.slice(0,-1)),L=!Xy.test(Se?Se.toLowerCase():"")}g=L}if(g)be(l,"complete"),be(l,"success");else{l.m=6;try{var we=2<hn(l)?l.g.statusText:""}catch{we=""}l.l=we+" ["+l.Z()+"]",yu(l)}}finally{vs(l)}}}}function vs(l,m){if(l.g){pu(l);const g=l.g,L=l.v[0]?()=>{}:null;l.g=null,l.v=null,m||be(l,"ready");try{g.onreadystatechange=L}catch{}}}function pu(l){l.I&&(c.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function hn(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<hn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var m=this.g.responseText;return l&&m.indexOf(l)==0&&(m=m.substring(l.length)),Ie(m)}};function vu(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function eg(l){const m={};l=(l.g&&2<=hn(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let L=0;L<l.length;L++){if(q(l[L]))continue;var g=w(l[L]);const Se=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const we=m[Se]||[];m[Se]=we,we.push(g)}I(m,function(L){return L.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function vo(l,m,g){return g&&g.internalChannelParams&&g.internalChannelParams[l]||m}function bu(l){this.Aa=0,this.i=[],this.j=new Ot,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=vo("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=vo("baseRetryDelayMs",5e3,l),this.cb=vo("retryDelaySeedMs",1e4,l),this.Wa=vo("forwardChannelMaxRetries",2,l),this.wa=vo("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new ms(l&&l.concurrentRequestLimit),this.Da=new Qy,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=bu.prototype,t.la=8,t.G=1,t.connect=function(l,m,g,L){yt(0),this.W=l,this.H=m||{},g&&L!==void 0&&(this.H.OSID=g,this.H.OAID=L),this.F=this.X,this.I=xu(this,null,this.W),_s(this)};function Wa(l){if(_u(l),l.G==3){var m=l.U++,g=Ar(l.I);if(Dt(g,"SID",l.K),Dt(g,"RID",m),Dt(g,"TYPE","terminate"),bo(l,g),m=new It(l,l.j,m),m.L=2,m.v=Ti(Ar(g)),g=!1,c.navigator&&c.navigator.sendBeacon)try{g=c.navigator.sendBeacon(m.v.toString(),"")}catch{}!g&&c.Image&&(new Image().src=m.v,g=!0),g||(m.g=Tu(m.j,null),m.g.ea(m.v)),m.F=Date.now(),zt(m)}Eu(l)}function bs(l){l.g&&(Ka(l),l.g.cancel(),l.g=null)}function _u(l){bs(l),l.u&&(c.clearTimeout(l.u),l.u=null),Ss(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&c.clearTimeout(l.s),l.s=null)}function _s(l){if(!co(l.h)&&!l.s){l.s=!0;var m=l.Ga;Z||B(),k||(Z(),k=!0),F.add(m,l),l.B=0}}function tg(l,m){return uo(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=m.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=qt(_(l.Ga,l,m),Iu(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const Se=new It(this,this.j,l);let we=this.o;if(this.S&&(we?(we=b(we),P(we,this.S)):we=this.S),this.m!==null||this.O||(Se.H=we,we=null),this.P)e:{for(var m=0,g=0;g<this.i.length;g++){t:{var L=this.i[g];if("__data__"in L.map&&(L=L.map.__data__,typeof L=="string")){L=L.length;break t}L=void 0}if(L===void 0)break;if(m+=L,4096<m){m=g;break e}if(m===4096||g===this.i.length-1){m=g+1;break e}}m=1e3}else m=1e3;m=Pu(this,Se,m),g=Ar(this.I),Dt(g,"RID",l),Dt(g,"CVER",22),this.D&&Dt(g,"X-HTTP-Session-Id",this.D),bo(this,g),we&&(this.O?m="headers="+encodeURIComponent(String(mu(we)))+"&"+m:this.m&&Ha(g,this.m,we)),xn(this.h,Se),this.Ua&&Dt(g,"TYPE","init"),this.P?(Dt(g,"$req",m),Dt(g,"SID","null"),Se.T=!0,fr(Se,g,null)):fr(Se,g,m),this.G=2}}else this.G==3&&(l?Su(this,l):this.i.length==0||co(this.h)||Su(this))};function Su(l,m){var g;m?g=m.l:g=l.U++;const L=Ar(l.I);Dt(L,"SID",l.K),Dt(L,"RID",g),Dt(L,"AID",l.T),bo(l,L),l.m&&l.o&&Ha(L,l.m,l.o),g=new It(l,l.j,g,l.B+1),l.m===null&&(g.H=l.o),m&&(l.i=m.D.concat(l.i)),m=Pu(l,g,1e3),g.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),xn(l.h,g),fr(g,L,m)}function bo(l,m){l.H&&ie(l.H,function(g,L){Dt(m,L,g)}),l.l&&yr({},function(g,L){Dt(m,L,g)})}function Pu(l,m,g){g=Math.min(l.i.length,g);var L=l.l?_(l.l.Na,l.l,l):null;e:{var Se=l.i;let we=-1;for(;;){const Ne=["count="+g];we==-1?0<g?(we=Se[0].g,Ne.push("ofs="+we)):we=0:Ne.push("ofs="+we);let Nt=!0;for(let lr=0;lr<g;lr++){let bt=Se[lr].g;const gr=Se[lr].map;if(bt-=we,0>bt)we=Math.max(0,Se[lr].g-100),Nt=!1;else try{Jy(gr,Ne,"req"+bt+"_")}catch{L&&L(gr)}}if(Nt){L=Ne.join("&");break e}}}return l=l.i.splice(0,g),m.D=l,L}function wu(l){if(!l.g&&!l.u){l.Y=1;var m=l.Fa;Z||B(),k||(Z(),k=!0),F.add(m,l),l.v=0}}function Ga(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=qt(_(l.Fa,l),Iu(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Cu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=qt(_(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,yt(10),bs(this),Cu(this))};function Ka(l){l.A!=null&&(c.clearTimeout(l.A),l.A=null)}function Cu(l){l.g=new It(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var m=Ar(l.qa);Dt(m,"RID","rpc"),Dt(m,"SID",l.K),Dt(m,"AID",l.T),Dt(m,"CI",l.F?"0":"1"),!l.F&&l.ja&&Dt(m,"TO",l.ja),Dt(m,"TYPE","xmlhttp"),bo(l,m),l.m&&l.o&&Ha(m,l.m,l.o),l.L&&(l.g.I=l.L);var g=l.g;l=l.ia,g.L=1,g.v=Ti(Ar(m)),g.m=null,g.P=!0,kt(g,l)}t.Za=function(){this.C!=null&&(this.C=null,bs(this),Ga(this),yt(19))};function Ss(l){l.C!=null&&(c.clearTimeout(l.C),l.C=null)}function Au(l,m){var g=null;if(l.g==m){Ss(l),Ka(l),l.g=null;var L=2}else if(xi(l.h,m))g=m.D,fs(l.h,m),L=1;else return;if(l.G!=0){if(m.o)if(L==1){g=m.m?m.m.length:0,m=Date.now()-m.F;var Se=l.B;L=Tt(),be(L,new At(L,g)),_s(l)}else wu(l);else if(Se=m.s,Se==3||Se==0&&0<m.X||!(L==1&&tg(l,m)||L==2&&Ga(l)))switch(g&&0<g.length&&(m=l.h,m.i=m.i.concat(g)),Se){case 1:ni(l,5);break;case 4:ni(l,10);break;case 3:ni(l,6);break;default:ni(l,2)}}}function Iu(l,m){let g=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(g*=2),g*m}function ni(l,m){if(l.j.info("Error code "+m),m==2){var g=_(l.fb,l),L=l.Xa;const Se=!L;L=new Bt(L||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Kr(L,"https"),Ti(L),Se?Ky(L.toString(),g):Yy(L.toString(),g)}else yt(2);l.G=0,l.l&&l.l.sa(m),Eu(l),_u(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),yt(2)):(this.j.info("Failed to ping google.com"),yt(1))};function Eu(l){if(l.G=0,l.ka=[],l.l){const m=ho(l.h);(m.length!=0||l.i.length!=0)&&(T(l.ka,m),T(l.ka,l.i),l.h.i.length=0,E(l.i),l.i.length=0),l.l.ra()}}function xu(l,m,g){var L=g instanceof Bt?Ar(g):new Bt(g);if(L.g!="")m&&(L.g=m+"."+L.g),Yr(L,L.s);else{var Se=c.location;L=Se.protocol,m=m?m+"."+Se.hostname:Se.hostname,Se=+Se.port;var we=new Bt(null);L&&Kr(we,L),m&&(we.g=m),Se&&Yr(we,Se),g&&(we.l=g),L=we}return g=l.D,m=l.ya,g&&m&&Dt(L,g,m),Dt(L,"VER",l.la),bo(l,L),L}function Tu(l,m,g){if(m&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return m=l.Ca&&!l.pa?new Kt(new gs({eb:g})):new Kt(l.pa),m.Ha(l.J),m}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function $u(){}t=$u.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Ps(){}Ps.prototype.g=function(l,m){return new xr(l,m)};function xr(l,m){ae.call(this),this.g=new bu(m),this.l=l,this.h=m&&m.messageUrlParams||null,l=m&&m.messageHeaders||null,m&&m.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=m&&m.initMessageHeaders||null,m&&m.messageContentType&&(l?l["X-WebChannel-Content-Type"]=m.messageContentType:l={"X-WebChannel-Content-Type":m.messageContentType}),m&&m.va&&(l?l["X-WebChannel-Client-Profile"]=m.va:l={"X-WebChannel-Client-Profile":m.va}),this.g.S=l,(l=m&&m.Sb)&&!q(l)&&(this.g.m=l),this.v=m&&m.supportsCrossDomainXhr||!1,this.u=m&&m.sendRawJson||!1,(m=m&&m.httpSessionIdParam)&&!q(m)&&(this.g.D=m,l=this.h,l!==null&&m in l&&(l=this.h,m in l&&delete l[m])),this.j=new ki(this)}N(xr,ae),xr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},xr.prototype.close=function(){Wa(this.g)},xr.prototype.o=function(l){var m=this.g;if(typeof l=="string"){var g={};g.__data__=l,l=g}else this.u&&(g={},g.__data__=je(l),l=g);m.i.push(new Ei(m.Ya++,l)),m.G==3&&_s(m)},xr.prototype.N=function(){this.g.l=null,delete this.j,Wa(this.g),delete this.g,xr.aa.N.call(this)};function ku(l){nt.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var m=l.__sm__;if(m){e:{for(const g in m){l=g;break e}l=void 0}(this.i=l)&&(l=this.i,m=m!==null&&l in m?m[l]:void 0),this.data=m}else this.data=l}N(ku,nt);function Ru(){et.call(this),this.status=1}N(Ru,et);function ki(l){this.g=l}N(ki,$u),ki.prototype.ua=function(){be(this.g,"a")},ki.prototype.ta=function(l){be(this.g,new ku(l))},ki.prototype.sa=function(l){be(this.g,new Ru)},ki.prototype.ra=function(){be(this.g,"b")},Ps.prototype.createWebChannel=Ps.prototype.g,xr.prototype.send=xr.prototype.o,xr.prototype.open=xr.prototype.m,xr.prototype.close=xr.prototype.close,mf=function(){return new Ps},hf=function(){return Tt()},df=dt,ql={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Je.NO_ERROR=0,Je.TIMEOUT=8,Je.HTTP_ERROR=6,Gs=Je,gt.COMPLETE="complete",uf=gt,Ge.EventType=Ae,Ae.OPEN="a",Ae.CLOSE="b",Ae.ERROR="c",Ae.MESSAGE="d",ae.prototype.listen=ae.prototype.K,Io=Ge,Kt.prototype.listenOnce=Kt.prototype.L,Kt.prototype.getLastError=Kt.prototype.Ka,Kt.prototype.getLastErrorCode=Kt.prototype.Ba,Kt.prototype.getStatus=Kt.prototype.Z,Kt.prototype.getResponseJson=Kt.prototype.Oa,Kt.prototype.getResponseText=Kt.prototype.oa,Kt.prototype.send=Kt.prototype.ea,Kt.prototype.setWithCredentials=Kt.prototype.Ha,cf=Kt}).apply(typeof Is<"u"?Is:typeof self<"u"?self:typeof window<"u"?window:{});const pd="@firebase/firestore",vd="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}_r.UNAUTHENTICATED=new _r(null),_r.GOOGLE_CREDENTIALS=new _r("google-credentials-uid"),_r.FIRST_PARTY=new _r("first-party-uid"),_r.MOCK_USER=new _r("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oo="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bi=new yc("@firebase/firestore");function Vi(){return bi.logLevel}function Ue(t,...e){if(bi.logLevel<=ht.DEBUG){const r=e.map(xc);bi.debug(`Firestore (${oo}): ${t}`,...r)}}function An(t,...e){if(bi.logLevel<=ht.ERROR){const r=e.map(xc);bi.error(`Firestore (${oo}): ${t}`,...r)}}function Yi(t,...e){if(bi.logLevel<=ht.WARN){const r=e.map(xc);bi.warn(`Firestore (${oo}): ${t}`,...r)}}function xc(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ze(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,ff(t,n,r)}function ff(t,e,r){let n=`FIRESTORE (${oo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw An(n),new Error(n)}function Et(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||ff(e,i,n)}function it(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ke={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ye extends En{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class a_{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(_r.UNAUTHENTICATED))}shutdown(){}}class l_{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class c_{constructor(e){this.t=e,this.currentUser=_r.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Et(this.o===void 0,42304);let n=this.i;const i=u=>this.i!==n?(n=this.i,r(u)):Promise.resolve();let o=new Wn;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Wn,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const u=o;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},c=u=>{Ue("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(Ue("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Wn)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Ue("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Et(typeof n.accessToken=="string",31837,{l:n}),new yf(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Et(e===null||typeof e=="string",2055,{h:e}),new _r(e)}}class u_{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=_r.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class d_{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new u_(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(_r.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class bd{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class h_{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Nr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Et(this.o===void 0,3512);const n=o=>{o.error!=null&&Ue("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const a=o.token!==this.m;return this.m=o.token,Ue("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const i=o=>{Ue("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):Ue("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new bd(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Et(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new bd(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m_(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=m_(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<r&&(n+=e.charAt(i[o]%62))}return n}}function mt(t,e){return t<e?-1:t>e?1:0}function Hl(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),o=e.charAt(n);if(i!==o)return al(i)===al(o)?mt(i,o):al(i)?1:-1}return mt(t.length,e.length)}const f_=55296,y_=57343;function al(t){const e=t.charCodeAt(0);return e>=f_&&e<=y_}function Qi(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _d="__name__";class Xr{constructor(e,r,n){r===void 0?r=0:r>e.length&&Ze(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&Ze(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Xr.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Xr?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const o=Xr.compareSegments(e.get(i),r.get(i));if(o!==0)return o}return mt(e.length,r.length)}static compareSegments(e,r){const n=Xr.isNumericId(e),i=Xr.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?Xr.extractNumericId(e).compare(Xr.extractNumericId(r)):Hl(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Hn.fromString(e.substring(4,e.length-2))}}class Ht extends Xr{construct(e,r,n){return new Ht(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ye(ke.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Ht(r)}static emptyPath(){return new Ht([])}}const g_=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ur extends Xr{construct(e,r,n){return new ur(e,r,n)}static isValidIdentifier(e){return g_.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ur.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===_d}static keyField(){return new ur([_d])}static fromServerFormat(e){const r=[];let n="",i=0;const o=()=>{if(n.length===0)throw new Ye(ke.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new Ye(ke.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Ye(ke.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,i+=2}else c==="`"?(a=!a,i++):c!=="."||a?(n+=c,i++):(o(),i++)}if(o(),a)throw new Ye(ke.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ur(r)}static emptyPath(){return new ur([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e){this.path=e}static fromPath(e){return new Xe(Ht.fromString(e))}static fromName(e){return new Xe(Ht.fromString(e).popFirst(5))}static empty(){return new Xe(Ht.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ht.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Ht.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Xe(new Ht(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p_(t,e,r){if(!r)throw new Ye(ke.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function v_(t,e,r,n){if(e===!0&&n===!0)throw new Ye(ke.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function Sd(t){if(!Xe.isDocumentKey(t))throw new Ye(ke.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function gf(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function $c(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ze(12329,{type:typeof t})}function Go(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ye(ke.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=$c(t);throw new Ye(ke.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function er(t,e){const r={typeString:t};return e&&(r.value=e),r}function ls(t,e){if(!gf(t))throw new Ye(ke.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const a=t[n];if(i&&typeof a!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(o!==void 0&&a!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new Ye(ke.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pd=-62135596800,wd=1e6;class Ft{static now(){return Ft.fromMillis(Date.now())}static fromDate(e){return Ft.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*wd);return new Ft(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Ye(ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ye(ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<Pd)throw new Ye(ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ye(ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/wd}_compareTo(e){return this.seconds===e.seconds?mt(this.nanoseconds,e.nanoseconds):mt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ft._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ls(e,Ft._jsonSchema))return new Ft(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Pd;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ft._jsonSchemaVersion="firestore/timestamp/1.0",Ft._jsonSchema={type:er("string",Ft._jsonSchemaVersion),seconds:er("number"),nanoseconds:er("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{static fromTimestamp(e){return new rt(e)}static min(){return new rt(new Ft(0,0))}static max(){return new rt(new Ft(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ko=-1;function b_(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=rt.fromTimestamp(n===1e9?new Ft(r+1,0):new Ft(r,n));return new Gn(i,Xe.empty(),e)}function __(t){return new Gn(t.readTime,t.key,Ko)}class Gn{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Gn(rt.min(),Xe.empty(),Ko)}static max(){return new Gn(rt.max(),Xe.empty(),Ko)}}function S_(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Xe.comparator(t.documentKey,e.documentKey),r!==0?r:mt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P_="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class w_{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function so(t){if(t.code!==ke.FAILED_PRECONDITION||t.message!==P_)throw t;Ue("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Ze(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Te((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Te?r:Te.resolve(r)}catch(r){return Te.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Te.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Te.reject(r)}static resolve(e){return new Te((r,n)=>{r(e)})}static reject(e){return new Te((r,n)=>{n(e)})}static waitFor(e){return new Te((r,n)=>{let i=0,o=0,a=!1;e.forEach(c=>{++i,c.next(()=>{++o,a&&o===i&&r()},u=>n(u))}),a=!0,o===i&&r()})}static or(e){let r=Te.resolve(!1);for(const n of e)r=r.next(i=>i?Te.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,o)=>{n.push(r.call(this,i,o))}),this.waitFor(n)}static mapArray(e,r){return new Te((n,i)=>{const o=e.length,a=new Array(o);let c=0;for(let u=0;u<o;u++){const h=u;r(e[h]).next(f=>{a[h]=f,++c,c===o&&n(a)},f=>i(f))}})}static doWhile(e,r){return new Te((n,i)=>{const o=()=>{e()===!0?r().next(()=>{o()},i):n()};o()})}}function C_(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function ao(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Da.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kc=-1;function Na(t){return t==null}function fa(t){return t===0&&1/t==-1/0}function A_(t){return typeof t=="number"&&Number.isInteger(t)&&!fa(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pf="";function I_(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=Cd(e)),e=E_(t.get(r),e);return Cd(e)}function E_(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const o=t.charAt(i);switch(o){case"\0":r+="";break;case pf:r+="";break;default:r+=o}}return r}function Cd(t){return t+pf+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ad(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function wi(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function vf(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e,r){this.comparator=e,this.root=r||cr.EMPTY}insert(e,r){return new Wt(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,cr.BLACK,null,null))}remove(e){return new Wt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,cr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Es(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Es(this.root,e,this.comparator,!1)}getReverseIterator(){return new Es(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Es(this.root,e,this.comparator,!0)}}class Es{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class cr{constructor(e,r,n,i,o){this.key=e,this.value=r,this.color=n??cr.RED,this.left=i??cr.EMPTY,this.right=o??cr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,o){return new cr(e??this.key,r??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,r,n),null):o===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return cr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return cr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,cr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,cr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ze(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ze(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ze(27949);return e+(this.isRed()?0:1)}}cr.EMPTY=null,cr.RED=!0,cr.BLACK=!1;cr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ze(57766)}get value(){throw Ze(16141)}get color(){throw Ze(16727)}get left(){throw Ze(29726)}get right(){throw Ze(36894)}copy(e,r,n,i,o){return this}insert(e,r,n){return new cr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(e){this.comparator=e,this.data=new Wt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Id(this.data.getIterator())}getIteratorFrom(e){return new Id(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof ir)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new ir(this.comparator);return r.data=e,r}}class Id{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr{constructor(e){this.fields=e,e.sort(ur.comparator)}static empty(){return new Hr([])}unionWith(e){let r=new ir(ur.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Hr(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Qi(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new bf("Invalid base64 string: "+o):o}}(e);return new hr(r)}static fromUint8Array(e){const r=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new hr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return mt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}hr.EMPTY_BYTE_STRING=new hr("");const x_=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Kn(t){if(Et(!!t,39018),typeof t=="string"){let e=0;const r=x_.exec(t);if(Et(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Yt(t.seconds),nanos:Yt(t.nanos)}}function Yt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Yn(t){return typeof t=="string"?hr.fromBase64String(t):hr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _f="server_timestamp",Sf="__type__",Pf="__previous_value__",wf="__local_write_time__";function Rc(t){return(t?.mapValue?.fields||{})[Sf]?.stringValue===_f}function La(t){const e=t.mapValue.fields[Pf];return Rc(e)?La(e):e}function Yo(t){const e=Kn(t.mapValue.fields[wf].timestampValue);return new Ft(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T_{constructor(e,r,n,i,o,a,c,u,h,f){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}}const ya="(default)";class Qo{constructor(e,r){this.projectId=e,this.database=r||ya}static empty(){return new Qo("","")}get isDefaultDatabase(){return this.database===ya}isEqual(e){return e instanceof Qo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cf="__type__",$_="__max__",xs={mapValue:{}},Af="__vector__",ga="value";function Qn(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Rc(t)?4:R_(t)?9007199254740991:k_(t)?10:11:Ze(28295,{value:t})}function an(t,e){if(t===e)return!0;const r=Qn(t);if(r!==Qn(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Yo(t).isEqual(Yo(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const a=Kn(i.timestampValue),c=Kn(o.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return Yn(i.bytesValue).isEqual(Yn(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return Yt(i.geoPointValue.latitude)===Yt(o.geoPointValue.latitude)&&Yt(i.geoPointValue.longitude)===Yt(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return Yt(i.integerValue)===Yt(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const a=Yt(i.doubleValue),c=Yt(o.doubleValue);return a===c?fa(a)===fa(c):isNaN(a)&&isNaN(c)}return!1}(t,e);case 9:return Qi(t.arrayValue.values||[],e.arrayValue.values||[],an);case 10:case 11:return function(i,o){const a=i.mapValue.fields||{},c=o.mapValue.fields||{};if(Ad(a)!==Ad(c))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(c[u]===void 0||!an(a[u],c[u])))return!1;return!0}(t,e);default:return Ze(52216,{left:t})}}function Jo(t,e){return(t.values||[]).find(r=>an(r,e))!==void 0}function Ji(t,e){if(t===e)return 0;const r=Qn(t),n=Qn(e);if(r!==n)return mt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return mt(t.booleanValue,e.booleanValue);case 2:return function(o,a){const c=Yt(o.integerValue||o.doubleValue),u=Yt(a.integerValue||a.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return Ed(t.timestampValue,e.timestampValue);case 4:return Ed(Yo(t),Yo(e));case 5:return Hl(t.stringValue,e.stringValue);case 6:return function(o,a){const c=Yn(o),u=Yn(a);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(o,a){const c=o.split("/"),u=a.split("/");for(let h=0;h<c.length&&h<u.length;h++){const f=mt(c[h],u[h]);if(f!==0)return f}return mt(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,a){const c=mt(Yt(o.latitude),Yt(a.latitude));return c!==0?c:mt(Yt(o.longitude),Yt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return xd(t.arrayValue,e.arrayValue);case 10:return function(o,a){const c=o.fields||{},u=a.fields||{},h=c[ga]?.arrayValue,f=u[ga]?.arrayValue,p=mt(h?.values?.length||0,f?.values?.length||0);return p!==0?p:xd(h,f)}(t.mapValue,e.mapValue);case 11:return function(o,a){if(o===xs.mapValue&&a===xs.mapValue)return 0;if(o===xs.mapValue)return 1;if(a===xs.mapValue)return-1;const c=o.fields||{},u=Object.keys(c),h=a.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let p=0;p<u.length&&p<f.length;++p){const _=Hl(u[p],f[p]);if(_!==0)return _;const C=Ji(c[u[p]],h[f[p]]);if(C!==0)return C}return mt(u.length,f.length)}(t.mapValue,e.mapValue);default:throw Ze(23264,{he:r})}}function Ed(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return mt(t,e);const r=Kn(t),n=Kn(e),i=mt(r.seconds,n.seconds);return i!==0?i:mt(r.nanos,n.nanos)}function xd(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const o=Ji(r[i],n[i]);if(o)return o}return mt(r.length,n.length)}function Xi(t){return Wl(t)}function Wl(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Kn(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Yn(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Xe.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const o of r.values||[])i?i=!1:n+=",",n+=Wl(o);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const a of n)o?o=!1:i+=",",i+=`${a}:${Wl(r.fields[a])}`;return i+"}"}(t.mapValue):Ze(61005,{value:t})}function Ks(t){switch(Qn(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=La(t);return e?16+Ks(e):16;case 5:return 2*t.stringValue.length;case 6:return Yn(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,o)=>i+Ks(o),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return wi(n.fields,(o,a)=>{i+=o.length+Ks(a)}),i}(t.mapValue);default:throw Ze(13486,{value:t})}}function Gl(t){return!!t&&"integerValue"in t}function Dc(t){return!!t&&"arrayValue"in t}function Td(t){return!!t&&"nullValue"in t}function $d(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ys(t){return!!t&&"mapValue"in t}function k_(t){return(t?.mapValue?.fields||{})[Cf]?.stringValue===Af}function Lo(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return wi(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Lo(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Lo(t.arrayValue.values[r]);return e}return{...t}}function R_(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===$_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e){this.value=e}static empty(){return new Lr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Ys(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Lo(r)}setAll(e){let r=ur.emptyPath(),n={},i=[];e.forEach((a,c)=>{if(!r.isImmediateParentOf(c)){const u=this.getFieldsMap(r);this.applyChanges(u,n,i),n={},i=[],r=c.popLast()}a?n[c.lastSegment()]=Lo(a):i.push(c.lastSegment())});const o=this.getFieldsMap(r);this.applyChanges(o,n,i)}delete(e){const r=this.field(e.popLast());Ys(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return an(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];Ys(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){wi(r,(i,o)=>e[i]=o);for(const i of n)delete e[i]}clone(){return new Lr(Lo(this.value))}}function If(t){const e=[];return wi(t.fields,(r,n)=>{const i=new ur([r]);if(Ys(n)){const o=If(n.mapValue).fields;if(o.length===0)e.push(i);else for(const a of o)e.push(i.child(a))}else e.push(i)}),new Hr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e,r,n,i,o,a,c){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=o,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Sr(e,0,rt.min(),rt.min(),rt.min(),Lr.empty(),0)}static newFoundDocument(e,r,n,i){return new Sr(e,1,r,rt.min(),n,i,0)}static newNoDocument(e,r){return new Sr(e,2,r,rt.min(),rt.min(),Lr.empty(),0)}static newUnknownDocument(e,r){return new Sr(e,3,r,rt.min(),rt.min(),Lr.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(rt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Lr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Lr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=rt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Sr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Sr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{constructor(e,r){this.position=e,this.inclusive=r}}function kd(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const o=e[i],a=t.position[i];if(o.field.isKeyField()?n=Xe.comparator(Xe.fromName(a.referenceValue),r.key):n=Ji(a,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function Rd(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!an(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(e,r="asc"){this.field=e,this.dir=r}}function D_(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{}class nr extends Ef{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new L_(e,r,n):r==="array-contains"?new V_(e,n):r==="in"?new B_(e,n):r==="not-in"?new F_(e,n):r==="array-contains-any"?new U_(e,n):new nr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new M_(e,n):new O_(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Ji(r,this.value)):r!==null&&Qn(this.value)===Qn(r)&&this.matchesComparison(Ji(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ze(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ln extends Ef{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new ln(e,r)}matches(e){return xf(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function xf(t){return t.op==="and"}function Tf(t){return N_(t)&&xf(t)}function N_(t){for(const e of t.filters)if(e instanceof ln)return!1;return!0}function Kl(t){if(t instanceof nr)return t.field.canonicalString()+t.op.toString()+Xi(t.value);if(Tf(t))return t.filters.map(e=>Kl(e)).join(",");{const e=t.filters.map(r=>Kl(r)).join(",");return`${t.op}(${e})`}}function $f(t,e){return t instanceof nr?function(n,i){return i instanceof nr&&n.op===i.op&&n.field.isEqual(i.field)&&an(n.value,i.value)}(t,e):t instanceof ln?function(n,i){return i instanceof ln&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((o,a,c)=>o&&$f(a,i.filters[c]),!0):!1}(t,e):void Ze(19439)}function kf(t){return t instanceof nr?function(r){return`${r.field.canonicalString()} ${r.op} ${Xi(r.value)}`}(t):t instanceof ln?function(r){return r.op.toString()+" {"+r.getFilters().map(kf).join(" ,")+"}"}(t):"Filter"}class L_ extends nr{constructor(e,r,n){super(e,r,n),this.key=Xe.fromName(n.referenceValue)}matches(e){const r=Xe.comparator(e.key,this.key);return this.matchesComparison(r)}}class M_ extends nr{constructor(e,r){super(e,"in",r),this.keys=Rf("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class O_ extends nr{constructor(e,r){super(e,"not-in",r),this.keys=Rf("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function Rf(t,e){return(e.arrayValue?.values||[]).map(r=>Xe.fromName(r.referenceValue))}class V_ extends nr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Dc(r)&&Jo(r.arrayValue,this.value)}}class B_ extends nr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Jo(this.value.arrayValue,r)}}class F_ extends nr{constructor(e,r){super(e,"not-in",r)}matches(e){if(Jo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Jo(this.value.arrayValue,r)}}class U_ extends nr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Dc(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Jo(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j_{constructor(e,r=null,n=[],i=[],o=null,a=null,c=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=a,this.endAt=c,this.Te=null}}function Dd(t,e=null,r=[],n=[],i=null,o=null,a=null){return new j_(t,e,r,n,i,o,a)}function Nc(t){const e=it(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Kl(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),Na(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Xi(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Xi(n)).join(",")),e.Te=r}return e.Te}function Lc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!D_(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!$f(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Rd(t.startAt,e.startAt)&&Rd(t.endAt,e.endAt)}function Yl(t){return Xe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e,r=null,n=[],i=[],o=null,a="F",c=null,u=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=a,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function z_(t,e,r,n,i,o,a,c){return new Ma(t,e,r,n,i,o,a,c)}function Mc(t){return new Ma(t)}function Nd(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function q_(t){return t.collectionGroup!==null}function Mo(t){const e=it(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new ir(ur.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(o=>{r.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new va(o,n))}),r.has(ur.keyField().canonicalString())||e.Ie.push(new va(ur.keyField(),n))}return e.Ie}function tn(t){const e=it(t);return e.Ee||(e.Ee=H_(e,Mo(t))),e.Ee}function H_(t,e){if(t.limitType==="F")return Dd(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new va(i.field,o)});const r=t.endAt?new pa(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new pa(t.startAt.position,t.startAt.inclusive):null;return Dd(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Ql(t,e,r){return new Ma(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Oa(t,e){return Lc(tn(t),tn(e))&&t.limitType===e.limitType}function Df(t){return`${Nc(tn(t))}|lt:${t.limitType}`}function Bi(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>kf(i)).join(", ")}]`),Na(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Xi(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Xi(i)).join(",")),`Target(${n})`}(tn(t))}; limitType=${t.limitType})`}function Va(t,e){return e.isFoundDocument()&&function(n,i){const o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):Xe.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(t,e)&&function(n,i){for(const o of Mo(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,c,u){const h=kd(a,c,u);return a.inclusive?h<=0:h<0}(n.startAt,Mo(n),i)||n.endAt&&!function(a,c,u){const h=kd(a,c,u);return a.inclusive?h>=0:h>0}(n.endAt,Mo(n),i))}(t,e)}function W_(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Nf(t){return(e,r)=>{let n=!1;for(const i of Mo(t)){const o=G_(i,e,r);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function G_(t,e,r){const n=t.field.isKeyField()?Xe.comparator(e.key,r.key):function(o,a,c){const u=a.data.field(o),h=c.data.field(o);return u!==null&&h!==null?Ji(u,h):Ze(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Ze(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,o]of n)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){wi(this.inner,(r,n)=>{for(const[i,o]of n)e(i,o)})}isEmpty(){return vf(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K_=new Wt(Xe.comparator);function In(){return K_}const Lf=new Wt(Xe.comparator);function Eo(...t){let e=Lf;for(const r of t)e=e.insert(r.key,r);return e}function Mf(t){let e=Lf;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function mi(){return Oo()}function Of(){return Oo()}function Oo(){return new Ci(t=>t.toString(),(t,e)=>t.isEqual(e))}const Y_=new Wt(Xe.comparator),Q_=new ir(Xe.comparator);function ft(...t){let e=Q_;for(const r of t)e=e.add(r);return e}const J_=new ir(mt);function X_(){return J_}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oc(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fa(e)?"-0":e}}function Vf(t){return{integerValue:""+t}}function Z_(t,e){return A_(e)?Vf(e):Oc(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba{constructor(){this._=void 0}}function eS(t,e,r){return t instanceof ba?function(i,o){const a={fields:{[Sf]:{stringValue:_f},[wf]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Rc(o)&&(o=La(o)),o&&(a.fields[Pf]=o),{mapValue:a}}(r,e):t instanceof Xo?Ff(t,e):t instanceof Zo?Uf(t,e):function(i,o){const a=Bf(i,o),c=Ld(a)+Ld(i.Ae);return Gl(a)&&Gl(i.Ae)?Vf(c):Oc(i.serializer,c)}(t,e)}function tS(t,e,r){return t instanceof Xo?Ff(t,e):t instanceof Zo?Uf(t,e):r}function Bf(t,e){return t instanceof _a?function(n){return Gl(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}class ba extends Ba{}class Xo extends Ba{constructor(e){super(),this.elements=e}}function Ff(t,e){const r=jf(e);for(const n of t.elements)r.some(i=>an(i,n))||r.push(n);return{arrayValue:{values:r}}}class Zo extends Ba{constructor(e){super(),this.elements=e}}function Uf(t,e){let r=jf(e);for(const n of t.elements)r=r.filter(i=>!an(i,n));return{arrayValue:{values:r}}}class _a extends Ba{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function Ld(t){return Yt(t.integerValue||t.doubleValue)}function jf(t){return Dc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function rS(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Xo&&i instanceof Xo||n instanceof Zo&&i instanceof Zo?Qi(n.elements,i.elements,an):n instanceof _a&&i instanceof _a?an(n.Ae,i.Ae):n instanceof ba&&i instanceof ba}(t.transform,e.transform)}class nS{constructor(e,r){this.version=e,this.transformResults=r}}class Pn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Pn}static exists(e){return new Pn(void 0,e)}static updateTime(e){return new Pn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Qs(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Fa{}function zf(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Hf(t.key,Pn.none()):new cs(t.key,t.data,Pn.none());{const r=t.data,n=Lr.empty();let i=new ir(ur.comparator);for(let o of e.fields)if(!i.has(o)){let a=r.field(o);a===null&&o.length>1&&(o=o.popLast(),a=r.field(o)),a===null?n.delete(o):n.set(o,a),i=i.add(o)}return new Ai(t.key,n,new Hr(i.toArray()),Pn.none())}}function iS(t,e,r){t instanceof cs?function(i,o,a){const c=i.value.clone(),u=Od(i.fieldTransforms,o,a.transformResults);c.setAll(u),o.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,r):t instanceof Ai?function(i,o,a){if(!Qs(i.precondition,o))return void o.convertToUnknownDocument(a.version);const c=Od(i.fieldTransforms,o,a.transformResults),u=o.data;u.setAll(qf(i)),u.setAll(c),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,r):function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Vo(t,e,r,n){return t instanceof cs?function(o,a,c,u){if(!Qs(o.precondition,a))return c;const h=o.value.clone(),f=Vd(o.fieldTransforms,u,a);return h.setAll(f),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(t,e,r,n):t instanceof Ai?function(o,a,c,u){if(!Qs(o.precondition,a))return c;const h=Vd(o.fieldTransforms,u,a),f=a.data;return f.setAll(qf(o)),f.setAll(h),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),c===null?null:c.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(p=>p.field))}(t,e,r,n):function(o,a,c){return Qs(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(t,e,r)}function oS(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),o=Bf(n.transform,i||null);o!=null&&(r===null&&(r=Lr.empty()),r.set(n.field,o))}return r||null}function Md(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Qi(n,i,(o,a)=>rS(o,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class cs extends Fa{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ai extends Fa{constructor(e,r,n,i,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function qf(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function Od(t,e,r){const n=new Map;Et(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const o=t[i],a=o.transform,c=e.data.field(o.field);n.set(o.field,tS(a,c,r[i]))}return n}function Vd(t,e,r){const n=new Map;for(const i of t){const o=i.transform,a=r.data.field(i.field);n.set(i.field,eS(o,a,e))}return n}class Hf extends Fa{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class sS extends Fa{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aS{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&iS(o,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Vo(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Vo(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=Of();return this.mutations.forEach(i=>{const o=e.get(i.key),a=o.overlayedDocument;let c=this.applyToLocalView(a,o.mutatedFields);c=r.has(i.key)?null:c;const u=zf(a,c);u!==null&&n.set(i.key,u),a.isValidDocument()||a.convertToNoDocument(rt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),ft())}isEqual(e){return this.batchId===e.batchId&&Qi(this.mutations,e.mutations,(r,n)=>Md(r,n))&&Qi(this.baseMutations,e.baseMutations,(r,n)=>Md(r,n))}}class Vc{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Et(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return Y_}();const o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,n[a].version);return new Vc(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cS{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zt,pt;function uS(t){switch(t){case ke.OK:return Ze(64938);case ke.CANCELLED:case ke.UNKNOWN:case ke.DEADLINE_EXCEEDED:case ke.RESOURCE_EXHAUSTED:case ke.INTERNAL:case ke.UNAVAILABLE:case ke.UNAUTHENTICATED:return!1;case ke.INVALID_ARGUMENT:case ke.NOT_FOUND:case ke.ALREADY_EXISTS:case ke.PERMISSION_DENIED:case ke.FAILED_PRECONDITION:case ke.ABORTED:case ke.OUT_OF_RANGE:case ke.UNIMPLEMENTED:case ke.DATA_LOSS:return!0;default:return Ze(15467,{code:t})}}function Wf(t){if(t===void 0)return An("GRPC error has no .code"),ke.UNKNOWN;switch(t){case Zt.OK:return ke.OK;case Zt.CANCELLED:return ke.CANCELLED;case Zt.UNKNOWN:return ke.UNKNOWN;case Zt.DEADLINE_EXCEEDED:return ke.DEADLINE_EXCEEDED;case Zt.RESOURCE_EXHAUSTED:return ke.RESOURCE_EXHAUSTED;case Zt.INTERNAL:return ke.INTERNAL;case Zt.UNAVAILABLE:return ke.UNAVAILABLE;case Zt.UNAUTHENTICATED:return ke.UNAUTHENTICATED;case Zt.INVALID_ARGUMENT:return ke.INVALID_ARGUMENT;case Zt.NOT_FOUND:return ke.NOT_FOUND;case Zt.ALREADY_EXISTS:return ke.ALREADY_EXISTS;case Zt.PERMISSION_DENIED:return ke.PERMISSION_DENIED;case Zt.FAILED_PRECONDITION:return ke.FAILED_PRECONDITION;case Zt.ABORTED:return ke.ABORTED;case Zt.OUT_OF_RANGE:return ke.OUT_OF_RANGE;case Zt.UNIMPLEMENTED:return ke.UNIMPLEMENTED;case Zt.DATA_LOSS:return ke.DATA_LOSS;default:return Ze(39323,{code:t})}}(pt=Zt||(Zt={}))[pt.OK=0]="OK",pt[pt.CANCELLED=1]="CANCELLED",pt[pt.UNKNOWN=2]="UNKNOWN",pt[pt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pt[pt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pt[pt.NOT_FOUND=5]="NOT_FOUND",pt[pt.ALREADY_EXISTS=6]="ALREADY_EXISTS",pt[pt.PERMISSION_DENIED=7]="PERMISSION_DENIED",pt[pt.UNAUTHENTICATED=16]="UNAUTHENTICATED",pt[pt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pt[pt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pt[pt.ABORTED=10]="ABORTED",pt[pt.OUT_OF_RANGE=11]="OUT_OF_RANGE",pt[pt.UNIMPLEMENTED=12]="UNIMPLEMENTED",pt[pt.INTERNAL=13]="INTERNAL",pt[pt.UNAVAILABLE=14]="UNAVAILABLE",pt[pt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dS(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hS=new Hn([4294967295,4294967295],0);function Bd(t){const e=dS().encode(t),r=new lf;return r.update(e),new Uint8Array(r.digest())}function Fd(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Hn([r,n],0),new Hn([i,o],0)]}class Bc{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new xo(`Invalid padding: ${r}`);if(n<0)throw new xo(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new xo(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new xo(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Hn.fromNumber(this.ge)}ye(e,r,n){let i=e.add(r.multiply(Hn.fromNumber(n)));return i.compare(hS)===1&&(i=new Hn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=Bd(e),[n,i]=Fd(r);for(let o=0;o<this.hashCount;o++){const a=this.ye(n,i,o);if(!this.we(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new Bc(o,i,r);return n.forEach(c=>a.insert(c)),a}insert(e){if(this.ge===0)return;const r=Bd(e),[n,i]=Fd(r);for(let o=0;o<this.hashCount;o++){const a=this.ye(n,i,o);this.Se(a)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class xo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e,r,n,i,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,us.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Ua(rt.min(),i,new Wt(mt),In(),ft())}}class us{constructor(e,r,n,i,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new us(n,r,ft(),ft(),ft())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(e,r,n,i){this.be=e,this.removedTargetIds=r,this.key=n,this.De=i}}class Gf{constructor(e,r){this.targetId=e,this.Ce=r}}class Kf{constructor(e,r,n=hr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class Ud{constructor(){this.ve=0,this.Fe=jd(),this.Me=hr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ft(),r=ft(),n=ft();return this.Fe.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:Ze(38017,{changeType:o})}}),new us(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=jd()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Et(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class mS{constructor(e){this.Ge=e,this.ze=new Map,this.je=In(),this.Je=Ts(),this.He=Ts(),this.Ye=new Wt(mt)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:Ze(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,i)=>{this.rt(i)&&r(i)})}st(e){const r=e.targetId,n=e.Ce.count,i=this.ot(r);if(i){const o=i.target;if(Yl(o))if(n===0){const a=new Xe(o.path);this.et(r,a,Sr.newNoDocument(a,rt.min()))}else Et(n===1,20013,{expectedCount:n});else{const a=this._t(r);if(a!==n){const c=this.ut(e),u=c?this.ct(c,e,a):1;if(u!==0){this.it(r);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,h)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=r;let a,c;try{a=Yn(n).toUint8Array()}catch(u){if(u instanceof bf)return Yi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Bc(a,i,o)}catch(u){return Yi(u instanceof xo?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let i=0;return n.forEach(o=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(c)||(this.et(r,o,null),i++)}),i}Tt(e){const r=new Map;this.ze.forEach((o,a)=>{const c=this.ot(a);if(c){if(o.current&&Yl(c.target)){const u=new Xe(c.target.path);this.It(u).has(a)||this.Et(a,u)||this.et(a,u,Sr.newNoDocument(u,e))}o.Be&&(r.set(a,o.ke()),o.qe())}});let n=ft();this.He.forEach((o,a)=>{let c=!0;a.forEachWhile(u=>{const h=this.ot(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(o))}),this.je.forEach((o,a)=>a.setReadTime(e));const i=new Ua(e,r,this.Ye,this.je,n);return this.je=In(),this.Je=Ts(),this.He=Ts(),this.Ye=new Wt(mt),i}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,r)?i.Qe(r,1):i.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new Ud,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new ir(mt),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new ir(mt),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Ue("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Ud),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Ts(){return new Wt(Xe.comparator)}function jd(){return new Wt(Xe.comparator)}const fS={asc:"ASCENDING",desc:"DESCENDING"},yS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},gS={and:"AND",or:"OR"};class pS{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Jl(t,e){return t.useProto3Json||Na(e)?e:{value:e}}function Sa(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Yf(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function vS(t,e){return Sa(t,e.toTimestamp())}function rn(t){return Et(!!t,49232),rt.fromTimestamp(function(r){const n=Kn(r);return new Ft(n.seconds,n.nanos)}(t))}function Fc(t,e){return Xl(t,e).canonicalString()}function Xl(t,e){const r=function(i){return new Ht(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function Qf(t){const e=Ht.fromString(t);return Et(ty(e),10190,{key:e.toString()}),e}function Zl(t,e){return Fc(t.databaseId,e.path)}function ll(t,e){const r=Qf(e);if(r.get(1)!==t.databaseId.projectId)throw new Ye(ke.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Ye(ke.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Xe(Xf(r))}function Jf(t,e){return Fc(t.databaseId,e)}function bS(t){const e=Qf(t);return e.length===4?Ht.emptyPath():Xf(e)}function ec(t){return new Ht(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Xf(t){return Et(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function zd(t,e,r){return{name:Zl(t,e),fields:r.value.mapValue.fields}}function _S(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Ze(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(h,f){return h.useProto3Json?(Et(f===void 0||typeof f=="string",58123),hr.fromBase64String(f||"")):(Et(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),hr.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(h){const f=h.code===void 0?ke.UNKNOWN:Wf(h.code);return new Ye(f,h.message||"")}(a);r=new Kf(n,i,o,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=ll(t,n.document.name),o=rn(n.document.updateTime),a=n.document.createTime?rn(n.document.createTime):rt.min(),c=new Lr({mapValue:{fields:n.document.fields}}),u=Sr.newFoundDocument(i,o,a,c),h=n.targetIds||[],f=n.removedTargetIds||[];r=new Js(h,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=ll(t,n.document),o=n.readTime?rn(n.readTime):rt.min(),a=Sr.newNoDocument(i,o),c=n.removedTargetIds||[];r=new Js([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=ll(t,n.document),o=n.removedTargetIds||[];r=new Js([],o,i,null)}else{if(!("filter"in e))return Ze(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:o}=n,a=new cS(i,o),c=n.targetId;r=new Gf(c,a)}}return r}function SS(t,e){let r;if(e instanceof cs)r={update:zd(t,e.key,e.value)};else if(e instanceof Hf)r={delete:Zl(t,e.key)};else if(e instanceof Ai)r={update:zd(t,e.key,e.data),updateMask:$S(e.fieldMask)};else{if(!(e instanceof sS))return Ze(16599,{Vt:e.type});r={verify:Zl(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(o,a){const c=a.transform;if(c instanceof ba)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Xo)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Zo)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof _a)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw Ze(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:vS(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Ze(27497)}(t,e.precondition)),r}function PS(t,e){return t&&t.length>0?(Et(e!==void 0,14353),t.map(r=>function(i,o){let a=i.updateTime?rn(i.updateTime):rn(o);return a.isEqual(rt.min())&&(a=rn(o)),new nS(a,i.transformResults||[])}(r,e))):[]}function wS(t,e){return{documents:[Jf(t,e.path)]}}function CS(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Jf(t,i);const o=function(h){if(h.length!==0)return ey(ln.create(h,"and"))}(e.filters);o&&(r.structuredQuery.where=o);const a=function(h){if(h.length!==0)return h.map(f=>function(_){return{field:Fi(_.field),direction:ES(_.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const c=Jl(t,e.limit);return c!==null&&(r.structuredQuery.limit=c),e.startAt&&(r.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ft:r,parent:i}}function AS(t){let e=bS(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Et(n===1,65062);const f=r.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let o=[];r.where&&(o=function(p){const _=Zf(p);return _ instanceof ln&&Tf(_)?_.getFilters():[_]}(r.where));let a=[];r.orderBy&&(a=function(p){return p.map(_=>function(N){return new va(Ui(N.field),function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(N.direction))}(_))}(r.orderBy));let c=null;r.limit&&(c=function(p){let _;return _=typeof p=="object"?p.value:p,Na(_)?null:_}(r.limit));let u=null;r.startAt&&(u=function(p){const _=!!p.before,C=p.values||[];return new pa(C,_)}(r.startAt));let h=null;return r.endAt&&(h=function(p){const _=!p.before,C=p.values||[];return new pa(C,_)}(r.endAt)),z_(e,i,a,o,c,"F",u,h)}function IS(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ze(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Zf(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Ui(r.unaryFilter.field);return nr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Ui(r.unaryFilter.field);return nr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Ui(r.unaryFilter.field);return nr.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Ui(r.unaryFilter.field);return nr.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ze(61313);default:return Ze(60726)}}(t):t.fieldFilter!==void 0?function(r){return nr.create(Ui(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ze(58110);default:return Ze(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return ln.create(r.compositeFilter.filters.map(n=>Zf(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ze(1026)}}(r.compositeFilter.op))}(t):Ze(30097,{filter:t})}function ES(t){return fS[t]}function xS(t){return yS[t]}function TS(t){return gS[t]}function Fi(t){return{fieldPath:t.canonicalString()}}function Ui(t){return ur.fromServerFormat(t.fieldPath)}function ey(t){return t instanceof nr?function(r){if(r.op==="=="){if($d(r.value))return{unaryFilter:{field:Fi(r.field),op:"IS_NAN"}};if(Td(r.value))return{unaryFilter:{field:Fi(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if($d(r.value))return{unaryFilter:{field:Fi(r.field),op:"IS_NOT_NAN"}};if(Td(r.value))return{unaryFilter:{field:Fi(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fi(r.field),op:xS(r.op),value:r.value}}}(t):t instanceof ln?function(r){const n=r.getFilters().map(i=>ey(i));return n.length===1?n[0]:{compositeFilter:{op:TS(r.op),filters:n}}}(t):Ze(54877,{filter:t})}function $S(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function ty(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e,r,n,i,o=rt.min(),a=rt.min(),c=hr.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Vn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Vn(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Vn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Vn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kS{constructor(e){this.yt=e}}function RS(t){const e=AS({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ql(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DS{constructor(){this.Cn=new NS}addToCollectionParentIndex(e,r){return this.Cn.add(r),Te.resolve()}getCollectionParents(e,r){return Te.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return Te.resolve()}deleteFieldIndex(e,r){return Te.resolve()}deleteAllFieldIndexes(e){return Te.resolve()}createTargetIndexes(e,r){return Te.resolve()}getDocumentsMatchingTarget(e,r){return Te.resolve(null)}getIndexType(e,r){return Te.resolve(0)}getFieldIndexes(e,r){return Te.resolve([])}getNextCollectionGroupToUpdate(e){return Te.resolve(null)}getMinOffset(e,r){return Te.resolve(Gn.min())}getMinOffsetFromCollectionGroup(e,r){return Te.resolve(Gn.min())}updateCollectionGroup(e,r,n){return Te.resolve()}updateIndexEntries(e,r){return Te.resolve()}}class NS{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new ir(Ht.comparator),o=!i.has(n);return this.index[r]=i.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new ir(Ht.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qd={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ry=41943040;class Er{static withCacheSize(e){return new Er(e,Er.DEFAULT_COLLECTION_PERCENTILE,Er.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Er.DEFAULT_COLLECTION_PERCENTILE=10,Er.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Er.DEFAULT=new Er(ry,Er.DEFAULT_COLLECTION_PERCENTILE,Er.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Er.DISABLED=new Er(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Zi(0)}static cr(){return new Zi(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hd="LruGarbageCollector",LS=1048576;function Wd([t,e],[r,n]){const i=mt(t,r);return i===0?mt(e,n):i}class MS{constructor(e){this.Ir=e,this.buffer=new ir(Wd),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();Wd(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class OS{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ue(Hd,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){ao(r)?Ue(Hd,"Ignoring IndexedDB error during garbage collection: ",r):await so(r)}await this.Vr(3e5)})}}class VS{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Te.resolve(Da.ce);const n=new MS(r);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Ue("LruGarbageCollector","Garbage collection skipped; disabled"),Te.resolve(qd)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ue("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),qd):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,o,a,c,u,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(Ue("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,a=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(n=p,c=Date.now(),this.removeTargets(e,n,r))).next(p=>(o=p,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(p=>(h=Date.now(),Vi()<=ht.DEBUG&&Ue("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-f}ms
	Determined least recently used ${i} in `+(c-a)+`ms
	Removed ${o} targets in `+(u-c)+`ms
	Removed ${p} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),Te.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:p})))}}function BS(t,e){return new VS(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(){this.changes=new Ci(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Sr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Te.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Vo(n.mutation,i,Hr.empty(),Ft.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,ft()).next(()=>n))}getLocalViewOfDocuments(e,r,n=ft()){const i=mi();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(o=>{let a=Eo();return o.forEach((c,u)=>{a=a.insert(c,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=mi();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,ft()))}populateOverlays(e,r,n){const i=[];return n.forEach(o=>{r.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,c)=>{r.set(a,c)})})}computeViews(e,r,n,i){let o=In();const a=Oo(),c=function(){return Oo()}();return r.forEach((u,h)=>{const f=n.get(h.key);i.has(h.key)&&(f===void 0||f.mutation instanceof Ai)?o=o.insert(h.key,h):f!==void 0?(a.set(h.key,f.mutation.getFieldMask()),Vo(f.mutation,h,f.mutation.getFieldMask(),Ft.now())):a.set(h.key,Hr.empty())}),this.recalculateAndSaveOverlays(e,o).next(u=>(u.forEach((h,f)=>a.set(h,f)),r.forEach((h,f)=>c.set(h,new US(f,a.get(h)??null))),c))}recalculateAndSaveOverlays(e,r){const n=Oo();let i=new Wt((a,c)=>a-c),o=ft();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const c of a)c.keys().forEach(u=>{const h=r.get(u);if(h===null)return;let f=n.get(u)||Hr.empty();f=c.applyToLocalView(h,f),n.set(u,f);const p=(i.get(c.batchId)||ft()).add(u);i=i.insert(c.batchId,p)})}).next(()=>{const a=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,f=u.value,p=Of();f.forEach(_=>{if(!o.has(_)){const C=zf(r.get(_),n.get(_));C!==null&&p.set(_,C),o=o.add(_)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,p))}return Te.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return Xe.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):q_(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(o=>{const a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-o.size):Te.resolve(mi());let c=Ko,u=o;return a.next(h=>Te.forEach(h,(f,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),o.get(f)?Te.resolve():this.remoteDocumentCache.getEntry(e,f).next(_=>{u=u.insert(f,_)}))).next(()=>this.populateOverlays(e,h,o)).next(()=>this.computeViews(e,u,h,ft())).next(f=>({batchId:c,changes:Mf(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Xe(r)).next(n=>{let i=Eo();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const o=r.collectionGroup;let a=Eo();return this.indexManager.getCollectionParents(e,o).next(c=>Te.forEach(c,u=>{const h=function(p,_){return new Ma(_,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(r,u.child(o));return this.getDocumentsMatchingCollectionQuery(e,h,n,i).next(f=>{f.forEach((p,_)=>{a=a.insert(p,_)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,i))).next(a=>{o.forEach((u,h)=>{const f=h.getKey();a.get(f)===null&&(a=a.insert(f,Sr.newInvalidDocument(f)))});let c=Eo();return a.forEach((u,h)=>{const f=o.get(u);f!==void 0&&Vo(f.mutation,h,Hr.empty(),Ft.now()),Va(r,h)&&(c=c.insert(u,h))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zS{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return Te.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:rn(i.createTime)}}(r)),Te.resolve()}getNamedQuery(e,r){return Te.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(i){return{name:i.name,query:RS(i.bundledQuery),readTime:rn(i.readTime)}}(r)),Te.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qS{constructor(){this.overlays=new Wt(Xe.comparator),this.qr=new Map}getOverlay(e,r){return Te.resolve(this.overlays.get(r))}getOverlays(e,r){const n=mi();return Te.forEach(r,i=>this.getOverlay(e,i).next(o=>{o!==null&&n.set(i,o)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,o)=>{this.St(e,r,o)}),Te.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.qr.delete(n)),Te.resolve()}getOverlaysForCollection(e,r,n){const i=mi(),o=r.length+1,a=new Xe(r.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!r.isPrefixOf(h.path))break;h.path.length===o&&u.largestBatchId>n&&i.set(u.getKey(),u)}return Te.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let o=new Wt((h,f)=>h-f);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===r&&h.largestBatchId>n){let f=o.get(h.largestBatchId);f===null&&(f=mi(),o=o.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const c=mi(),u=o.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,f)=>c.set(h,f)),!(c.size()>=i)););return Te.resolve(c)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new lS(r,n));let o=this.qr.get(r);o===void 0&&(o=ft(),this.qr.set(r,o)),this.qr.set(r,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS{constructor(){this.sessionToken=hr.EMPTY_BYTE_STRING}getSessionToken(e){return Te.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Te.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(){this.Qr=new ir(or.$r),this.Ur=new ir(or.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new or(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new or(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new Xe(new Ht([])),n=new or(r,e),i=new or(r,e+1),o=[];return this.Ur.forEachInRange([n,i],a=>{this.Gr(a),o.push(a.key)}),o}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new Xe(new Ht([])),n=new or(r,e),i=new or(r,e+1);let o=ft();return this.Ur.forEachInRange([n,i],a=>{o=o.add(a.key)}),o}containsKey(e){const r=new or(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class or{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return Xe.comparator(e.key,r.key)||mt(e.Yr,r.Yr)}static Kr(e,r){return mt(e.Yr,r.Yr)||Xe.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WS{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new ir(or.$r)}checkEmpty(e){return Te.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new aS(o,r,n,i);this.mutationQueue.push(a);for(const c of i)this.Zr=this.Zr.add(new or(c.key,o)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return Te.resolve(a)}lookupMutationBatch(e,r){return Te.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),o=i<0?0:i;return Te.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return Te.resolve(this.mutationQueue.length===0?kc:this.tr-1)}getAllMutationBatches(e){return Te.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new or(r,0),i=new or(r,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,i],a=>{const c=this.Xr(a.Yr);o.push(c)}),Te.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new ir(mt);return r.forEach(i=>{const o=new or(i,0),a=new or(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,a],c=>{n=n.add(c.Yr)})}),Te.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let o=n;Xe.isDocumentKey(o)||(o=o.child(""));const a=new or(new Xe(o),0);let c=new ir(mt);return this.Zr.forEachWhile(u=>{const h=u.key.path;return!!n.isPrefixOf(h)&&(h.length===i&&(c=c.add(u.Yr)),!0)},a),Te.resolve(this.ti(c))}ti(e){const r=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Et(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return Te.forEach(r.mutations,i=>{const o=new or(i.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new or(r,0),i=this.Zr.firstAfterOrEqual(n);return Te.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Te.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e){this.ri=e,this.docs=function(){return new Wt(Xe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),o=i?i.size:0,a=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Te.resolve(n?n.document.mutableCopy():Sr.newInvalidDocument(r))}getEntries(e,r){let n=In();return r.forEach(i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():Sr.newInvalidDocument(i))}),Te.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let o=In();const a=r.path,c=new Xe(a.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||S_(__(f),n)<=0||(i.has(f.key)||Va(r,f))&&(o=o.insert(f.key,f.mutableCopy()))}return Te.resolve(o)}getAllFromCollectionGroup(e,r,n,i){Ze(9500)}ii(e,r){return Te.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new KS(this)}getSize(e){return Te.resolve(this.size)}}class KS extends FS{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),Te.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{constructor(e){this.persistence=e,this.si=new Ci(r=>Nc(r),Lc),this.lastRemoteSnapshotVersion=rt.min(),this.highestTargetId=0,this.oi=0,this._i=new Uc,this.targetCount=0,this.ai=Zi.ur()}forEachTarget(e,r){return this.si.forEach((n,i)=>r(i)),Te.resolve()}getLastRemoteSnapshotVersion(e){return Te.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Te.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Te.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),Te.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Zi(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,Te.resolve()}updateTargetData(e,r){return this.Pr(r),Te.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,Te.resolve()}removeTargets(e,r,n){let i=0;const o=[];return this.si.forEach((a,c)=>{c.sequenceNumber<=r&&n.get(c.targetId)===null&&(this.si.delete(a),o.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),Te.waitFor(o).next(()=>i)}getTargetCount(e){return Te.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return Te.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),Te.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,o=[];return i&&r.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),Te.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),Te.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return Te.resolve(n)}containsKey(e,r){return Te.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny{constructor(e,r){this.ui={},this.overlays={},this.ci=new Da(0),this.li=!1,this.li=!0,this.hi=new HS,this.referenceDelegate=e(this),this.Pi=new YS(this),this.indexManager=new DS,this.remoteDocumentCache=function(i){return new GS(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new kS(r),this.Ii=new zS(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new qS,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new WS(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Ue("MemoryPersistence","Starting transaction:",e);const i=new QS(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ai(e,r){return Te.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class QS extends w_{constructor(e){super(),this.currentSequenceNumber=e}}class jc{constructor(e){this.persistence=e,this.Ri=new Uc,this.Vi=null}static mi(e){return new jc(e)}get fi(){if(this.Vi)return this.Vi;throw Ze(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),Te.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),Te.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),Te.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(o=>this.fi.add(o.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Te.forEach(this.fi,n=>{const i=Xe.fromPath(n);return this.gi(e,i).next(o=>{o||r.removeEntry(i,rt.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return Te.or([()=>Te.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Pa{constructor(e,r){this.persistence=e,this.pi=new Ci(n=>I_(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=BS(this,r)}static mi(e,r){return new Pa(e,r)}Ei(){}di(e){return Te.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return Te.forEach(this.pi,(n,i)=>this.br(e,n,i).next(o=>o?Te.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(e,a=>this.br(e,a,r).next(c=>{c||(n++,o.removeEntry(a,rt.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),Te.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Te.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Te.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),Te.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Ks(e.data.value)),r}br(e,r,n){return Te.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.pi.get(r);return Te.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=ft(),i=ft();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new zc(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Fp()?8:C_(wr())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const o={result:null};return this.ys(e,r).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.ws(e,r,i,n).next(a=>{o.result=a})}).next(()=>{if(o.result)return;const a=new JS;return this.Ss(e,r,a).next(c=>{if(o.result=c,this.Vs)return this.bs(e,r,a,c.size)})}).next(()=>o.result)}bs(e,r,n,i){return n.documentReadCount<this.fs?(Vi()<=ht.DEBUG&&Ue("QueryEngine","SDK will not create cache indexes for query:",Bi(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Te.resolve()):(Vi()<=ht.DEBUG&&Ue("QueryEngine","Query:",Bi(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(Vi()<=ht.DEBUG&&Ue("QueryEngine","The SDK decides to create cache indexes for query:",Bi(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,tn(r))):Te.resolve())}ys(e,r){if(Nd(r))return Te.resolve(null);let n=tn(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Ql(r,null,"F"),n=tn(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const a=ft(...o);return this.ps.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,n).next(u=>{const h=this.Ds(r,c);return this.Cs(r,h,a,u.readTime)?this.ys(e,Ql(r,null,"F")):this.vs(e,h,r,u)}))})))}ws(e,r,n,i){return Nd(r)||i.isEqual(rt.min())?Te.resolve(null):this.ps.getDocuments(e,n).next(o=>{const a=this.Ds(r,o);return this.Cs(r,a,n,i)?Te.resolve(null):(Vi()<=ht.DEBUG&&Ue("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Bi(r)),this.vs(e,a,r,b_(i,Ko)).next(c=>c))})}Ds(e,r){let n=new ir(Nf(e));return r.forEach((i,o)=>{Va(e,o)&&(n=n.add(o))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(e,r,n){return Vi()<=ht.DEBUG&&Ue("QueryEngine","Using full collection scan to execute query:",Bi(r)),this.ps.getDocumentsMatchingQuery(e,r,Gn.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(o=>(r.forEach(a=>{o=o.insert(a.key,a)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qc="LocalStore",ZS=3e8;class e1{constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new Wt(mt),this.xs=new Ci(o=>Nc(o),Lc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new jS(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function t1(t,e,r,n){return new e1(t,e,r,n)}async function iy(t,e){const r=it(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(o=>{const a=[],c=[];let u=ft();for(const h of i){a.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}for(const h of o){c.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}return r.localDocuments.getDocuments(n,u).next(h=>({Ls:h,removedBatchIds:a,addedBatchIds:c}))})})}function r1(t,e){const r=it(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),o=r.Ns.newChangeBuffer({trackRemovals:!0});return function(c,u,h,f){const p=h.batch,_=p.keys();let C=Te.resolve();return _.forEach(N=>{C=C.next(()=>f.getEntry(u,N)).next(E=>{const T=h.docVersions.get(N);Et(T!==null,48541),E.version.compareTo(T)<0&&(p.applyToRemoteDocument(E,h),E.isValidDocument()&&(E.setReadTime(h.commitVersion),f.addEntry(E)))})}),C.next(()=>c.mutationQueue.removeMutationBatch(u,p))}(r,n,e,o).next(()=>o.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let u=ft();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function oy(t){const e=it(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function n1(t,e){const r=it(t),n=e.snapshotVersion;let i=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const a=r.Ns.newChangeBuffer({trackRemovals:!0});i=r.Ms;const c=[];e.targetChanges.forEach((f,p)=>{const _=i.get(p);if(!_)return;c.push(r.Pi.removeMatchingKeys(o,f.removedDocuments,p).next(()=>r.Pi.addMatchingKeys(o,f.addedDocuments,p)));let C=_.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(p)!==null?C=C.withResumeToken(hr.EMPTY_BYTE_STRING,rt.min()).withLastLimboFreeSnapshotVersion(rt.min()):f.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(f.resumeToken,n)),i=i.insert(p,C),function(E,T,x){return E.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=ZS?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(_,C,f)&&c.push(r.Pi.updateTargetData(o,C))});let u=In(),h=ft();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(r.persistence.referenceDelegate.updateLimboDocument(o,f))}),c.push(i1(o,a,e.documentUpdates).next(f=>{u=f.ks,h=f.qs})),!n.isEqual(rt.min())){const f=r.Pi.getLastRemoteSnapshotVersion(o).next(p=>r.Pi.setTargetsMetadata(o,o.currentSequenceNumber,n));c.push(f)}return Te.waitFor(c).next(()=>a.apply(o)).next(()=>r.localDocuments.getLocalViewOfDocuments(o,u,h)).next(()=>u)}).then(o=>(r.Ms=i,o))}function i1(t,e,r){let n=ft(),i=ft();return r.forEach(o=>n=n.add(o)),e.getEntries(t,n).next(o=>{let a=In();return r.forEach((c,u)=>{const h=o.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(rt.min())?(e.removeEntry(c,u.readTime),a=a.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),a=a.insert(c,u)):Ue(qc,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{ks:a,qs:i}})}function o1(t,e){const r=it(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=kc),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function s1(t,e){const r=it(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Pi.getTargetData(n,e).next(o=>o?(i=o,Te.resolve(i)):r.Pi.allocateTargetId(n).next(a=>(i=new Vn(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function tc(t,e,r){const n=it(t),i=n.Ms.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!ao(a))throw a;Ue(qc,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function Gd(t,e,r){const n=it(t);let i=rt.min(),o=ft();return n.persistence.runTransaction("Execute query","readwrite",a=>function(u,h,f){const p=it(u),_=p.xs.get(f);return _!==void 0?Te.resolve(p.Ms.get(_)):p.Pi.getTargetData(h,f)}(n,a,tn(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,c.targetId).next(u=>{o=u})}).next(()=>n.Fs.getDocumentsMatchingQuery(a,e,r?i:rt.min(),r?o:ft())).next(c=>(a1(n,W_(e),c),{documents:c,Qs:o})))}function a1(t,e,r){let n=t.Os.get(e)||rt.min();r.forEach((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),t.Os.set(e,n)}class Kd{constructor(){this.activeTargetIds=X_()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class l1{constructor(){this.Mo=new Kd,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Kd,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c1{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yd="ConnectivityMonitor";class Qd{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ue(Yd,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ue(Yd,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $s=null;function rc(){return $s===null?$s=function(){return 268435456+Math.round(2147483648*Math.random())}():$s++,"0x"+$s.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cl="RestConnection",u1={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class d1{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===ya?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,o){const a=rc(),c=this.zo(e,r.toUriEncodedString());Ue(cl,`Sending RPC '${e}' ${a}:`,c,n);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,o);const{host:h}=new URL(c),f=ro(h);return this.Jo(e,c,u,n,f).then(p=>(Ue(cl,`Received RPC '${e}' ${a}: `,p),p),p=>{throw Yi(cl,`RPC '${e}' ${a} failed with error: `,p,"url: ",c,"request:",n),p})}Ho(e,r,n,i,o,a){return this.Go(e,r,n,i,o)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+oo}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>e[o]=i),n&&n.headers.forEach((i,o)=>e[o]=i)}zo(e,r){const n=u1[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vr="WebChannelConnection";class m1 extends d1{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,o){const a=rc();return new Promise((c,u)=>{const h=new cf;h.setWithCredentials(!0),h.listenOnce(uf.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Gs.NO_ERROR:const p=h.getResponseJson();Ue(vr,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(p)),c(p);break;case Gs.TIMEOUT:Ue(vr,`RPC '${e}' ${a} timed out`),u(new Ye(ke.DEADLINE_EXCEEDED,"Request time out"));break;case Gs.HTTP_ERROR:const _=h.getStatus();if(Ue(vr,`RPC '${e}' ${a} failed with status:`,_,"response text:",h.getResponseText()),_>0){let C=h.getResponseJson();Array.isArray(C)&&(C=C[0]);const N=C?.error;if(N&&N.status&&N.message){const E=function(x){const q=x.toLowerCase().replace(/_/g,"-");return Object.values(ke).indexOf(q)>=0?q:ke.UNKNOWN}(N.status);u(new Ye(E,N.message))}else u(new Ye(ke.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new Ye(ke.UNAVAILABLE,"Connection failed."));break;default:Ze(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{Ue(vr,`RPC '${e}' ${a} completed.`)}});const f=JSON.stringify(i);Ue(vr,`RPC '${e}' ${a} sending request:`,i),h.send(r,"POST",f,n,15)})}T_(e,r,n){const i=rc(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=mf(),c=hf(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,r,n),u.encodeInitMessageHeaders=!0;const f=o.join("");Ue(vr,`Creating RPC '${e}' stream ${i}: ${f}`,u);const p=a.createWebChannel(f,u);this.I_(p);let _=!1,C=!1;const N=new h1({Yo:T=>{C?Ue(vr,`Not sending because RPC '${e}' stream ${i} is closed:`,T):(_||(Ue(vr,`Opening RPC '${e}' stream ${i} transport.`),p.open(),_=!0),Ue(vr,`RPC '${e}' stream ${i} sending:`,T),p.send(T))},Zo:()=>p.close()}),E=(T,x,q)=>{T.listen(x,ee=>{try{q(ee)}catch(Y){setTimeout(()=>{throw Y},0)}})};return E(p,Io.EventType.OPEN,()=>{C||(Ue(vr,`RPC '${e}' stream ${i} transport opened.`),N.o_())}),E(p,Io.EventType.CLOSE,()=>{C||(C=!0,Ue(vr,`RPC '${e}' stream ${i} transport closed`),N.a_(),this.E_(p))}),E(p,Io.EventType.ERROR,T=>{C||(C=!0,Yi(vr,`RPC '${e}' stream ${i} transport errored. Name:`,T.name,"Message:",T.message),N.a_(new Ye(ke.UNAVAILABLE,"The operation could not be completed")))}),E(p,Io.EventType.MESSAGE,T=>{if(!C){const x=T.data[0];Et(!!x,16349);const q=x,ee=q?.error||q[0]?.error;if(ee){Ue(vr,`RPC '${e}' stream ${i} received error:`,ee);const Y=ee.status;let ue=function(b){const v=Zt[b];if(v!==void 0)return Wf(v)}(Y),ie=ee.message;ue===void 0&&(ue=ke.INTERNAL,ie="Unknown error status: "+Y+" with message "+ee.message),C=!0,N.a_(new Ye(ue,ie)),p.close()}else Ue(vr,`RPC '${e}' stream ${i} received:`,x),N.u_(x)}}),E(c,df.STAT_EVENT,T=>{T.stat===ql.PROXY?Ue(vr,`RPC '${e}' stream ${i} detected buffering proxy`):T.stat===ql.NOPROXY&&Ue(vr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{N.__()},0),N}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function ul(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ja(t){return new pS(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy{constructor(e,r,n=1e3,i=1.5,o=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&Ue("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jd="PersistentStream";class ay{constructor(e,r,n,i,o,a,c,u){this.Mi=e,this.S_=n,this.b_=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new sy(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===ke.RESOURCE_EXHAUSTED?(An(r.toString()),An("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===ke.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===r&&this.G_(n,i)},n=>{e(()=>{const i=new Ye(ke.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Ue(Jd,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(Ue(Jd,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class f1 extends ay{constructor(e,r,n,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=o}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=_S(this.serializer,e),n=function(o){if(!("targetChange"in o))return rt.min();const a=o.targetChange;return a.targetIds&&a.targetIds.length?rt.min():a.readTime?rn(a.readTime):rt.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=ec(this.serializer),r.addTarget=function(o,a){let c;const u=a.target;if(c=Yl(u)?{documents:wS(o,u)}:{query:CS(o,u).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Yf(o,a.resumeToken);const h=Jl(o,a.expectedCount);h!==null&&(c.expectedCount=h)}else if(a.snapshotVersion.compareTo(rt.min())>0){c.readTime=Sa(o,a.snapshotVersion.toTimestamp());const h=Jl(o,a.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);const n=IS(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=ec(this.serializer),r.removeTarget=e,this.q_(r)}}class y1 extends ay{constructor(e,r,n,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Et(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Et(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Et(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=PS(e.writeResults,e.commitTime),n=rn(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=ec(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>SS(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g1{}class p1 extends g1{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Ye(ke.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Go(e,Xl(r,n),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ye(ke.UNKNOWN,o.toString())})}Ho(e,r,n,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Ho(e,Xl(r,n),i,a,c,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ye(ke.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class v1{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(An(r),this.aa=!1):Ue("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _i="RemoteStore";class b1{constructor(e,r,n,i,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo(a=>{n.enqueueAndForget(async()=>{Ii(this)&&(Ue(_i,"Restarting streams for network reachability change."),await async function(u){const h=it(u);h.Ea.add(4),await ds(h),h.Ra.set("Unknown"),h.Ea.delete(4),await za(h)}(this))})}),this.Ra=new v1(n,i)}}async function za(t){if(Ii(t))for(const e of t.da)await e(!0)}async function ds(t){for(const e of t.da)await e(!1)}function ly(t,e){const r=it(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Kc(r)?Gc(r):lo(r).O_()&&Wc(r,e))}function Hc(t,e){const r=it(t),n=lo(r);r.Ia.delete(e),n.O_()&&cy(r,e),r.Ia.size===0&&(n.O_()?n.L_():Ii(r)&&r.Ra.set("Unknown"))}function Wc(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(rt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}lo(t).Y_(e)}function cy(t,e){t.Va.Ue(e),lo(t).Z_(e)}function Gc(t){t.Va=new mS({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),lo(t).start(),t.Ra.ua()}function Kc(t){return Ii(t)&&!lo(t).x_()&&t.Ia.size>0}function Ii(t){return it(t).Ea.size===0}function uy(t){t.Va=void 0}async function _1(t){t.Ra.set("Online")}async function S1(t){t.Ia.forEach((e,r)=>{Wc(t,e)})}async function P1(t,e){uy(t),Kc(t)?(t.Ra.ha(e),Gc(t)):t.Ra.set("Unknown")}async function w1(t,e,r){if(t.Ra.set("Online"),e instanceof Kf&&e.state===2&&e.cause)try{await async function(i,o){const a=o.cause;for(const c of o.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,a),i.Ia.delete(c),i.Va.removeTarget(c))}(t,e)}catch(n){Ue(_i,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await wa(t,n)}else if(e instanceof Js?t.Va.Ze(e):e instanceof Gf?t.Va.st(e):t.Va.tt(e),!r.isEqual(rt.min()))try{const n=await oy(t.localStore);r.compareTo(n)>=0&&await function(o,a){const c=o.Va.Tt(a);return c.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const f=o.Ia.get(h);f&&o.Ia.set(h,f.withResumeToken(u.resumeToken,a))}}),c.targetMismatches.forEach((u,h)=>{const f=o.Ia.get(u);if(!f)return;o.Ia.set(u,f.withResumeToken(hr.EMPTY_BYTE_STRING,f.snapshotVersion)),cy(o,u);const p=new Vn(f.target,u,h,f.sequenceNumber);Wc(o,p)}),o.remoteSyncer.applyRemoteEvent(c)}(t,r)}catch(n){Ue(_i,"Failed to raise snapshot:",n),await wa(t,n)}}async function wa(t,e,r){if(!ao(e))throw e;t.Ea.add(1),await ds(t),t.Ra.set("Offline"),r||(r=()=>oy(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ue(_i,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await za(t)})}function dy(t,e){return e().catch(r=>wa(t,r,e))}async function qa(t){const e=it(t),r=Jn(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:kc;for(;C1(e);)try{const i=await o1(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,A1(e,i)}catch(i){await wa(e,i)}hy(e)&&my(e)}function C1(t){return Ii(t)&&t.Ta.length<10}function A1(t,e){t.Ta.push(e);const r=Jn(t);r.O_()&&r.X_&&r.ea(e.mutations)}function hy(t){return Ii(t)&&!Jn(t).x_()&&t.Ta.length>0}function my(t){Jn(t).start()}async function I1(t){Jn(t).ra()}async function E1(t){const e=Jn(t);for(const r of t.Ta)e.ea(r.mutations)}async function x1(t,e,r){const n=t.Ta.shift(),i=Vc.from(n,e,r);await dy(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await qa(t)}async function T1(t,e){e&&Jn(t).X_&&await async function(n,i){if(function(a){return uS(a)&&a!==ke.ABORTED}(i.code)){const o=n.Ta.shift();Jn(n).B_(),await dy(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i)),await qa(n)}}(t,e),hy(t)&&my(t)}async function Xd(t,e){const r=it(t);r.asyncQueue.verifyOperationInProgress(),Ue(_i,"RemoteStore received new credentials");const n=Ii(r);r.Ea.add(3),await ds(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await za(r)}async function $1(t,e){const r=it(t);e?(r.Ea.delete(2),await za(r)):e||(r.Ea.add(2),await ds(r),r.Ra.set("Unknown"))}function lo(t){return t.ma||(t.ma=function(r,n,i){const o=it(r);return o.sa(),new f1(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:_1.bind(null,t),t_:S1.bind(null,t),r_:P1.bind(null,t),H_:w1.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Kc(t)?Gc(t):t.Ra.set("Unknown")):(await t.ma.stop(),uy(t))})),t.ma}function Jn(t){return t.fa||(t.fa=function(r,n,i){const o=it(r);return o.sa(),new y1(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:I1.bind(null,t),r_:T1.bind(null,t),ta:E1.bind(null,t),na:x1.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await qa(t)):(await t.fa.stop(),t.Ta.length>0&&(Ue(_i,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc{constructor(e,r,n,i,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new Wn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,o){const a=Date.now()+n,c=new Yc(e,r,a,i,o);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ye(ke.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Qc(t,e){if(An("AsyncQueue",`${e}: ${t}`),ao(t))return new Ye(ke.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{static emptySet(e){return new Wi(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||Xe.comparator(r.key,n.key):(r,n)=>Xe.comparator(r.key,n.key),this.keyedMap=Eo(),this.sortedSet=new Wt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Wi)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Wi;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zd{constructor(){this.ga=new Wt(Xe.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):Ze(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class eo{constructor(e,r,n,i,o,a,c,u,h){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,r,n,i,o){const a=[];return r.forEach(c=>{a.push({type:0,doc:c})}),new eo(e,r,Wi.emptySet(r),a,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Oa(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class R1{constructor(){this.queries=eh(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=it(r),o=i.queries;i.queries=eh(),o.forEach((a,c)=>{for(const u of c.Sa)u.onError(n)})})(this,new Ye(ke.ABORTED,"Firestore shutting down"))}}function eh(){return new Ci(t=>Df(t),Oa)}async function D1(t,e){const r=it(t);let n=3;const i=e.query;let o=r.queries.get(i);o?!o.ba()&&e.Da()&&(n=2):(o=new k1,n=e.Da()?0:1);try{switch(n){case 0:o.wa=await r.onListen(i,!0);break;case 1:o.wa=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const c=Qc(a,`Initialization of query '${Bi(e.query)}' failed`);return void e.onError(c)}r.queries.set(i,o),o.Sa.push(e),e.va(r.onlineState),o.wa&&e.Fa(o.wa)&&Jc(r)}async function N1(t,e){const r=it(t),n=e.query;let i=3;const o=r.queries.get(n);if(o){const a=o.Sa.indexOf(e);a>=0&&(o.Sa.splice(a,1),o.Sa.length===0?i=e.Da()?0:1:!o.ba()&&e.Da()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function L1(t,e){const r=it(t);let n=!1;for(const i of e){const o=i.query,a=r.queries.get(o);if(a){for(const c of a.Sa)c.Fa(i)&&(n=!0);a.wa=i}}n&&Jc(r)}function M1(t,e,r){const n=it(t),i=n.queries.get(e);if(i)for(const o of i.Sa)o.onError(r);n.queries.delete(e)}function Jc(t){t.Ca.forEach(e=>{e.next()})}var nc,th;(th=nc||(nc={})).Ma="default",th.Cache="cache";class O1{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new eo(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=eo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==nc.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fy{constructor(e){this.key=e}}class yy{constructor(e){this.key=e}}class V1{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ft(),this.mutatedKeys=ft(),this.eu=Nf(e),this.tu=new Wi(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new Zd,i=r?r.tu:this.tu;let o=r?r.mutatedKeys:this.mutatedKeys,a=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,p)=>{const _=i.get(f),C=Va(this.query,p)?p:null,N=!!_&&this.mutatedKeys.has(_.key),E=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let T=!1;_&&C?_.data.isEqual(C.data)?N!==E&&(n.track({type:3,doc:C}),T=!0):this.su(_,C)||(n.track({type:2,doc:C}),T=!0,(u&&this.eu(C,u)>0||h&&this.eu(C,h)<0)&&(c=!0)):!_&&C?(n.track({type:0,doc:C}),T=!0):_&&!C&&(n.track({type:1,doc:_}),T=!0,(u||h)&&(c=!0)),T&&(C?(a=a.add(C),o=E?o.add(f):o.delete(f)):(a=a.delete(f),o=o.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),o=o.delete(f.key),n.track({type:1,doc:f})}return{tu:a,iu:n,Cs:c,mutatedKeys:o}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((f,p)=>function(C,N){const E=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ze(20277,{Rt:T})}};return E(C)-E(N)}(f.type,p.type)||this.eu(f.doc,p.doc)),this.ou(n),i=i??!1;const c=r&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,h=u!==this.Za;return this.Za=u,a.length!==0||h?{snapshot:new eo(this.query,e.tu,o,a,e.mutatedKeys,u===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Zd,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ft(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new yy(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new fy(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=ft();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return eo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Xc="SyncEngine";class B1{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class F1{constructor(e){this.key=e,this.hu=!1}}class U1{constructor(e,r,n,i,o,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Ci(c=>Df(c),Oa),this.Iu=new Map,this.Eu=new Set,this.du=new Wt(Xe.comparator),this.Au=new Map,this.Ru=new Uc,this.Vu={},this.mu=new Map,this.fu=Zi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function j1(t,e,r=!0){const n=Sy(t);let i;const o=n.Tu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await gy(n,e,r,!0),i}async function z1(t,e){const r=Sy(t);await gy(r,e,!0,!1)}async function gy(t,e,r,n){const i=await s1(t.localStore,tn(e)),o=i.targetId,a=t.sharedClientState.addLocalQueryTarget(o,r);let c;return n&&(c=await q1(t,e,o,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&ly(t.remoteStore,i),c}async function q1(t,e,r,n,i){t.pu=(p,_,C)=>async function(E,T,x,q){let ee=T.view.ru(x);ee.Cs&&(ee=await Gd(E.localStore,T.query,!1).then(({documents:I})=>T.view.ru(I,ee)));const Y=q&&q.targetChanges.get(T.targetId),ue=q&&q.targetMismatches.get(T.targetId)!=null,ie=T.view.applyChanges(ee,E.isPrimaryClient,Y,ue);return nh(E,T.targetId,ie.au),ie.snapshot}(t,p,_,C);const o=await Gd(t.localStore,e,!0),a=new V1(e,o.Qs),c=a.ru(o.documents),u=us.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),h=a.applyChanges(c,t.isPrimaryClient,u);nh(t,r,h.au);const f=new B1(e,r,a);return t.Tu.set(e,f),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),h.snapshot}async function H1(t,e,r){const n=it(t),i=n.Tu.get(e),o=n.Iu.get(i.targetId);if(o.length>1)return n.Iu.set(i.targetId,o.filter(a=>!Oa(a,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await tc(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Hc(n.remoteStore,i.targetId),ic(n,i.targetId)}).catch(so)):(ic(n,i.targetId),await tc(n.localStore,i.targetId,!0))}async function W1(t,e){const r=it(t),n=r.Tu.get(e),i=r.Iu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Hc(r.remoteStore,n.targetId))}async function G1(t,e,r){const n=eP(t);try{const i=await function(a,c){const u=it(a),h=Ft.now(),f=c.reduce((C,N)=>C.add(N.key),ft());let p,_;return u.persistence.runTransaction("Locally write mutations","readwrite",C=>{let N=In(),E=ft();return u.Ns.getEntries(C,f).next(T=>{N=T,N.forEach((x,q)=>{q.isValidDocument()||(E=E.add(x))})}).next(()=>u.localDocuments.getOverlayedDocuments(C,N)).next(T=>{p=T;const x=[];for(const q of c){const ee=oS(q,p.get(q.key).overlayedDocument);ee!=null&&x.push(new Ai(q.key,ee,If(ee.value.mapValue),Pn.exists(!0)))}return u.mutationQueue.addMutationBatch(C,h,x,c)}).next(T=>{_=T;const x=T.applyToLocalDocumentSet(p,E);return u.documentOverlayCache.saveOverlays(C,T.batchId,x)})}).then(()=>({batchId:_.batchId,changes:Mf(p)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,c,u){let h=a.Vu[a.currentUser.toKey()];h||(h=new Wt(mt)),h=h.insert(c,u),a.Vu[a.currentUser.toKey()]=h}(n,i.batchId,r),await hs(n,i.changes),await qa(n.remoteStore)}catch(i){const o=Qc(i,"Failed to persist write");r.reject(o)}}async function py(t,e){const r=it(t);try{const n=await n1(r.localStore,e);e.targetChanges.forEach((i,o)=>{const a=r.Au.get(o);a&&(Et(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?Et(a.hu,14607):i.removedDocuments.size>0&&(Et(a.hu,42227),a.hu=!1))}),await hs(r,n,e)}catch(n){await so(n)}}function rh(t,e,r){const n=it(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach((o,a)=>{const c=a.view.va(e);c.snapshot&&i.push(c.snapshot)}),function(a,c){const u=it(a);u.onlineState=c;let h=!1;u.queries.forEach((f,p)=>{for(const _ of p.Sa)_.va(c)&&(h=!0)}),h&&Jc(u)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function K1(t,e,r){const n=it(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Au.get(e),o=i&&i.key;if(o){let a=new Wt(Xe.comparator);a=a.insert(o,Sr.newNoDocument(o,rt.min()));const c=ft().add(o),u=new Ua(rt.min(),new Map,new Wt(mt),a,c);await py(n,u),n.du=n.du.remove(o),n.Au.delete(e),Zc(n)}else await tc(n.localStore,e,!1).then(()=>ic(n,e,r)).catch(so)}async function Y1(t,e){const r=it(t),n=e.batch.batchId;try{const i=await r1(r.localStore,e);by(r,n,null),vy(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await hs(r,i)}catch(i){await so(i)}}async function Q1(t,e,r){const n=it(t);try{const i=await function(a,c){const u=it(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let f;return u.mutationQueue.lookupMutationBatch(h,c).next(p=>(Et(p!==null,37113),f=p.keys(),u.mutationQueue.removeMutationBatch(h,p))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f)).next(()=>u.localDocuments.getDocuments(h,f))})}(n.localStore,e);by(n,e,r),vy(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await hs(n,i)}catch(i){await so(i)}}function vy(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function by(t,e,r){const n=it(t);let i=n.Vu[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(r?o.reject(r):o.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function ic(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||_y(t,n)})}function _y(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Hc(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),Zc(t))}function nh(t,e,r){for(const n of r)n instanceof fy?(t.Ru.addReference(n.key,e),J1(t,n)):n instanceof yy?(Ue(Xc,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||_y(t,n.key)):Ze(19791,{wu:n})}function J1(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Ue(Xc,"New document in limbo: "+r),t.Eu.add(n),Zc(t))}function Zc(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new Xe(Ht.fromString(e)),n=t.fu.next();t.Au.set(n,new F1(r)),t.du=t.du.insert(r,n),ly(t.remoteStore,new Vn(tn(Mc(r.path)),n,"TargetPurposeLimboResolution",Da.ce))}}async function hs(t,e,r){const n=it(t),i=[],o=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach((c,u)=>{a.push(n.pu(u,e,r).then(h=>{if((h||r)&&n.isPrimaryClient){const f=h?!h.fromCache:r?.targetChanges.get(u.targetId)?.current;n.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(h){i.push(h);const f=zc.As(u.targetId,h);o.push(f)}}))}),await Promise.all(a),n.Pu.H_(i),await async function(u,h){const f=it(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>Te.forEach(h,_=>Te.forEach(_.Es,C=>f.persistence.referenceDelegate.addReference(p,_.targetId,C)).next(()=>Te.forEach(_.ds,C=>f.persistence.referenceDelegate.removeReference(p,_.targetId,C)))))}catch(p){if(!ao(p))throw p;Ue(qc,"Failed to update sequence numbers: "+p)}for(const p of h){const _=p.targetId;if(!p.fromCache){const C=f.Ms.get(_),N=C.snapshotVersion,E=C.withLastLimboFreeSnapshotVersion(N);f.Ms=f.Ms.insert(_,E)}}}(n.localStore,o))}async function X1(t,e){const r=it(t);if(!r.currentUser.isEqual(e)){Ue(Xc,"User change. New user:",e.toKey());const n=await iy(r.localStore,e);r.currentUser=e,function(o,a){o.mu.forEach(c=>{c.forEach(u=>{u.reject(new Ye(ke.CANCELLED,a))})}),o.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await hs(r,n.Ls)}}function Z1(t,e){const r=it(t),n=r.Au.get(e);if(n&&n.hu)return ft().add(n.key);{let i=ft();const o=r.Iu.get(e);if(!o)return i;for(const a of o){const c=r.Tu.get(a);i=i.unionWith(c.view.nu)}return i}}function Sy(t){const e=it(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=py.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Z1.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=K1.bind(null,e),e.Pu.H_=L1.bind(null,e.eventManager),e.Pu.yu=M1.bind(null,e.eventManager),e}function eP(t){const e=it(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Y1.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Q1.bind(null,e),e}class Ca{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ja(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return t1(this.persistence,new XS,e.initialUser,this.serializer)}Cu(e){return new ny(jc.mi,this.serializer)}Du(e){return new l1}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ca.provider={build:()=>new Ca};class tP extends Ca{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Et(this.persistence.referenceDelegate instanceof Pa,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new OS(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?Er.withCacheSize(this.cacheSizeBytes):Er.DEFAULT;return new ny(n=>Pa.mi(n,r),this.serializer)}}class oc{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>rh(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=X1.bind(null,this.syncEngine),await $1(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new R1}()}createDatastore(e){const r=ja(e.databaseInfo.databaseId),n=function(o){return new m1(o)}(e.databaseInfo);return function(o,a,c,u){return new p1(o,a,c,u)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,o,a,c){return new b1(n,i,o,a,c)}(this.localStore,this.datastore,e.asyncQueue,r=>rh(this.syncEngine,r,0),function(){return Qd.v()?new Qd:new c1}())}createSyncEngine(e,r){return function(i,o,a,c,u,h,f){const p=new U1(i,o,a,c,u,h);return f&&(p.gu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(r){const n=it(r);Ue(_i,"RemoteStore shutting down."),n.Ea.add(5),await ds(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}oc.provider={build:()=>new oc};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):An("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xn="FirestoreClient";class nP{constructor(e,r,n,i,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=_r.UNAUTHENTICATED,this.clientId=Tc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,async a=>{Ue(Xn,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Ue(Xn,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Wn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Qc(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function dl(t,e){t.asyncQueue.verifyOperationInProgress(),Ue(Xn,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await iy(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function ih(t,e){t.asyncQueue.verifyOperationInProgress();const r=await iP(t);Ue(Xn,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>Xd(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>Xd(e.remoteStore,i)),t._onlineComponents=e}async function iP(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ue(Xn,"Using user provided OfflineComponentProvider");try{await dl(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===ke.FAILED_PRECONDITION||i.code===ke.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Yi("Error using user provided cache. Falling back to memory cache: "+r),await dl(t,new Ca)}}else Ue(Xn,"Using default OfflineComponentProvider"),await dl(t,new tP(void 0));return t._offlineComponents}async function Py(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ue(Xn,"Using user provided OnlineComponentProvider"),await ih(t,t._uninitializedComponentsProvider._online)):(Ue(Xn,"Using default OnlineComponentProvider"),await ih(t,new oc))),t._onlineComponents}function oP(t){return Py(t).then(e=>e.syncEngine)}async function sP(t){const e=await Py(t),r=e.eventManager;return r.onListen=j1.bind(null,e.syncEngine),r.onUnlisten=H1.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=z1.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=W1.bind(null,e.syncEngine),r}function aP(t,e,r={}){const n=new Wn;return t.asyncQueue.enqueueAndForget(async()=>function(o,a,c,u,h){const f=new rP({next:_=>{f.Nu(),a.enqueueAndForget(()=>N1(o,p));const C=_.docs.has(c);!C&&_.fromCache?h.reject(new Ye(ke.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&_.fromCache&&u&&u.source==="server"?h.reject(new Ye(ke.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(_)},error:_=>h.reject(_)}),p=new O1(Mc(c.path),f,{includeMetadataChanges:!0,qa:!0});return D1(o,p)}(await sP(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wy(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oh=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cy="firestore.googleapis.com",sh=!0;class ah{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ye(ke.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Cy,this.ssl=sh}else this.host=e.host,this.ssl=e.ssl??sh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=ry;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<LS)throw new Ye(ke.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}v_("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=wy(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Ye(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Ye(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Ye(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class eu{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ah({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ye(ke.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ye(ke.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ah(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new a_;switch(n.type){case"firstParty":return new d_(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ye(ke.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=oh.get(r);n&&(Ue("ComponentProvider","Removing Datastore"),oh.delete(r),n.terminate())}(this),Promise.resolve()}}function lP(t,e,r,n={}){t=Go(t,eu);const i=ro(e),o=t._getSettings(),a={...o,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${r}`;i&&(bm(`https://${c}`),_m("Firestore",!0)),o.host!==Cy&&o.host!==c&&Yi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...o,host:c,ssl:i,emulatorOptions:n};if(!gi(u,a)&&(t._setSettings(u),n.mockUserToken)){let h,f;if(typeof n.mockUserToken=="string")h=n.mockUserToken,f=_r.MOCK_USER;else{h=kp(n.mockUserToken,t._app?.options.projectId);const p=n.mockUserToken.sub||n.mockUserToken.user_id;if(!p)throw new Ye(ke.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new _r(p)}t._authCredentials=new l_(new yf(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new tu(this.firestore,e,this._query)}}class sr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new es(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new sr(this.firestore,e,this._key)}toJSON(){return{type:sr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(ls(r,sr._jsonSchema))return new sr(e,n||null,new Xe(Ht.fromString(r.referencePath)))}}sr._jsonSchemaVersion="firestore/documentReference/1.0",sr._jsonSchema={type:er("string",sr._jsonSchemaVersion),referencePath:er("string")};class es extends tu{constructor(e,r,n){super(e,r,Mc(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new sr(this.firestore,null,new Xe(e))}withConverter(e){return new es(this.firestore,e,this._path)}}function cP(t,e,...r){if(t=Br(t),arguments.length===1&&(e=Tc.newId()),p_("doc","path",e),t instanceof eu){const n=Ht.fromString(e,...r);return Sd(n),new sr(t,null,new Xe(n))}{if(!(t instanceof sr||t instanceof es))throw new Ye(ke.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Ht.fromString(e,...r));return Sd(n),new sr(t.firestore,t instanceof es?t.converter:null,new Xe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lh="AsyncQueue";class ch{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new sy(this,"async_queue_retry"),this._c=()=>{const n=ul();n&&Ue(lh,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=ul();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=ul();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Wn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ao(e))throw e;Ue(lh,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,An("INTERNAL UNHANDLED ERROR: ",uh(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=Yc.createAndSchedule(this,e,r,n,o=>this.hc(o));return this.tc.push(i),i}uc(){this.nc&&Ze(47125,{Pc:uh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function uh(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class ru extends eu{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new ch,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ch(e),this._firestoreClient=void 0,await e}}}function uP(t,e){const r=typeof t=="object"?t:Cm(),n=typeof t=="string"?t:ya,i=pc(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const o=Tp("firestore");o&&lP(i,...o)}return i}function Ay(t){if(t._terminated)throw new Ye(ke.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||dP(t),t._firestoreClient}function dP(t){const e=t._freezeSettings(),r=function(i,o,a,c){return new T_(i,o,a,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,wy(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new nP(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(i){const o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Mr(hr.fromBase64String(e))}catch(r){throw new Ye(ke.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Mr(hr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Mr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ls(e,Mr._jsonSchema))return Mr.fromBase64String(e.bytes)}}Mr._jsonSchemaVersion="firestore/bytes/1.0",Mr._jsonSchema={type:er("string",Mr._jsonSchemaVersion),bytes:er("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Ye(ke.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ur(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iy{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Ye(ke.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Ye(ke.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return mt(this._lat,e._lat)||mt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:nn._jsonSchemaVersion}}static fromJSON(e){if(ls(e,nn._jsonSchema))return new nn(e.latitude,e.longitude)}}nn._jsonSchemaVersion="firestore/geoPoint/1.0",nn._jsonSchema={type:er("string",nn._jsonSchemaVersion),latitude:er("number"),longitude:er("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:on._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ls(e,on._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new on(e.vectorValues);throw new Ye(ke.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}on._jsonSchemaVersion="firestore/vectorValue/1.0",on._jsonSchema={type:er("string",on._jsonSchemaVersion),vectorValues:er("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hP=/^__.*__$/;class mP{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Ai(e,this.data,this.fieldMask,r,this.fieldTransforms):new cs(e,this.data,r,this.fieldTransforms)}}function Ey(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ze(40011,{Ac:t})}}class iu{constructor(e,r,n,i,o,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new iu({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Aa(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Ey(this.Ac)&&hP.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class fP{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||ja(e)}Cc(e,r,n,i=!1){return new iu({Ac:e,methodName:r,Dc:n,path:ur.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function yP(t){const e=t._freezeSettings(),r=ja(t._databaseId);return new fP(t._databaseId,!!e.ignoreUndefinedProperties,r)}function gP(t,e,r,n,i,o={}){const a=t.Cc(o.merge||o.mergeFields?2:0,e,r,i);ky("Data must be an object, but it was:",a,n);const c=Ty(n,a);let u,h;if(o.merge)u=new Hr(a.fieldMask),h=a.fieldTransforms;else if(o.mergeFields){const f=[];for(const p of o.mergeFields){const _=pP(e,p,r);if(!a.contains(_))throw new Ye(ke.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);bP(f,_)||f.push(_)}u=new Hr(f),h=a.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,h=a.fieldTransforms;return new mP(new Lr(c),u,h)}function xy(t,e){if($y(t=Br(t)))return ky("Unsupported field value:",e,t),Ty(t,e);if(t instanceof Iy)return function(n,i){if(!Ey(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const o=[];let a=0;for(const c of n){let u=xy(c,i.wc(a));u==null&&(u={nullValue:"NULL_VALUE"}),o.push(u),a++}return{arrayValue:{values:o}}}(t,e)}return function(n,i){if((n=Br(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Z_(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=Ft.fromDate(n);return{timestampValue:Sa(i.serializer,o)}}if(n instanceof Ft){const o=new Ft(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Sa(i.serializer,o)}}if(n instanceof nn)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Mr)return{bytesValue:Yf(i.serializer,n._byteString)};if(n instanceof sr){const o=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(o))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Fc(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof on)return function(a,c){return{mapValue:{fields:{[Cf]:{stringValue:Af},[ga]:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return Oc(c.serializer,h)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${$c(n)}`)}(t,e)}function Ty(t,e){const r={};return vf(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):wi(t,(n,i)=>{const o=xy(i,e.mc(n));o!=null&&(r[n]=o)}),{mapValue:{fields:r}}}function $y(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ft||t instanceof nn||t instanceof Mr||t instanceof sr||t instanceof Iy||t instanceof on)}function ky(t,e,r){if(!$y(r)||!gf(r)){const n=$c(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function pP(t,e,r){if((e=Br(e))instanceof nu)return e._internalPath;if(typeof e=="string")return Ry(t,e);throw Aa("Field path arguments must be of type string or ",t,!1,void 0,r)}const vP=new RegExp("[~\\*/\\[\\]]");function Ry(t,e,r){if(e.search(vP)>=0)throw Aa(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new nu(...e.split("."))._internalPath}catch{throw Aa(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Aa(t,e,r,n,i){const o=n&&!n.isEmpty(),a=i!==void 0;let c=`Function ${e}() called with invalid data`;r&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(o||a)&&(u+=" (found",o&&(u+=` in field ${n}`),a&&(u+=` in document ${i}`),u+=")"),new Ye(ke.INVALID_ARGUMENT,c+t+u)}function bP(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dy{constructor(e,r,n,i,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new sr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new _P(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Ny("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class _P extends Dy{data(){return super.data()}}function Ny(t,e){return typeof e=="string"?Ry(t,e):e instanceof nu?e._internalPath:e._delegate._internalPath}class SP{convertValue(e,r="none"){switch(Qn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Yt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Yn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Ze(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return wi(e,(i,o)=>{n[i]=this.convertValue(o,r)}),n}convertVectorValue(e){const r=e.fields?.[ga].arrayValue?.values?.map(n=>Yt(n.doubleValue));return new on(r)}convertGeoPoint(e){return new nn(Yt(e.latitude),Yt(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=La(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Yo(e));default:return null}}convertTimestamp(e){const r=Kn(e);return new Ft(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Ht.fromString(e);Et(ty(n),9688,{name:e});const i=new Qo(n.get(1),n.get(3)),o=new Xe(n.popFirst(5));return i.isEqual(r)||An(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PP(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class To{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class yi extends Dy{constructor(e,r,n,i,o,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Xs(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Ny("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ye(ke.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=yi._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}yi._jsonSchemaVersion="firestore/documentSnapshot/1.0",yi._jsonSchema={type:er("string",yi._jsonSchemaVersion),bundleSource:er("string","DocumentSnapshot"),bundleName:er("string"),bundle:er("string")};class Xs extends yi{data(e={}){return super.data(e)}}class Bo{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new To(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Xs(this._firestore,this._userDataWriter,n.key,n,new To(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Ye(ke.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(c=>{const u=new Xs(i._firestore,i._userDataWriter,c.doc.key,c.doc,new To(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>o||c.type!==3).map(c=>{const u=new Xs(i._firestore,i._userDataWriter,c.doc.key,c.doc,new To(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,f=-1;return c.type!==0&&(h=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),f=a.indexOf(c.doc.key)),{type:wP(c.type),doc:u,oldIndex:h,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ye(ke.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Bo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Tc.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function wP(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ze(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CP(t){t=Go(t,sr);const e=Go(t.firestore,ru);return aP(Ay(e),t._key).then(r=>xP(e,t,r))}Bo._jsonSchemaVersion="firestore/querySnapshot/1.0",Bo._jsonSchema={type:er("string",Bo._jsonSchemaVersion),bundleSource:er("string","QuerySnapshot"),bundleName:er("string"),bundle:er("string")};class AP extends SP{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mr(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new sr(this.firestore,null,r)}}function IP(t,e,r){t=Go(t,sr);const n=Go(t.firestore,ru),i=PP(t.converter,e);return EP(n,[gP(yP(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Pn.none())])}function EP(t,e){return function(n,i){const o=new Wn;return n.asyncQueue.enqueueAndForget(async()=>G1(await oP(n),i,o)),o.promise}(Ay(t),e)}function xP(t,e,r){const n=r.docs.get(e._key),i=new AP(t);return new yi(t,i,e._key,n,new To(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){oo=i})(no),Gi(new pi("firestore",(n,{instanceIdentifier:i,options:o})=>{const a=n.getProvider("app").getImmediate(),c=new ru(new c_(n.getProvider("auth-internal")),new h_(a,n.getProvider("app-check-internal")),function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Ye(ke.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Qo(h.options.projectId,f)}(a,i),a);return o={useFetchStreams:r,...o},c._setSettings(o),c},"PUBLIC").setMultipleInstances(!0)),zn(pd,vd,e),zn(pd,vd,"esm2020")})();let TP="eyAiYXBpS2V5IjogIkFJemFTeUJBbGN2WlRMMXRsQ05LRExENEJpTWJhR01iTnhCRjQtTSIsICAiYXV0aERvbWFpbiI6ICJocm0tMTEyOC5maXJlYmFzZWFwcC5jb20iLCAgImRhdGFiYXNlVVJMIjogImh0dHBzOi8vaHJtLTExMjguZmlyZWJhc2Vpby5jb20iLCAgInByb2plY3RJZCI6ICJocm0tMTEyOCIsICAic3RvcmFnZUJ1Y2tldCI6ICJocm0tMTEyOC5hcHBzcG90LmNvbSIsICAibWVzc2FnaW5nU2VuZGVySWQiOiAiMTA0OTI1MDU4NTI0NSIsICAiYXBwSWQiOiAiMToxMDQ5MjUwNTg1MjQ1OndlYjowZGFkMDAyMDI3MjM1MTRjY2M1Mjc0In0=";const Ly=wm(JSON.parse(pp(TP))),di=n_(Ly),Ia=new Zr,$P=uP(Ly);Ia.addScope("profile");Ia.addScope("email");class $o extends Error{}$o.prototype.name="InvalidTokenError";function kP(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function RP(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return kP(e)}catch{return atob(e)}}function DP(t,e){if(typeof t!="string")throw new $o("Invalid token specified: must be a string");e||(e={});const r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new $o(`Invalid token specified: missing part #${r+1}`);let i;try{i=RP(n)}catch(o){throw new $o(`Invalid token specified: invalid base64 for part #${r+1} (${o.message})`)}try{return JSON.parse(i)}catch(o){throw new $o(`Invalid token specified: invalid json for part #${r+1} (${o.message})`)}}const NP={clientId:"195275085181-8ccjpgp8v1g80qhnlk6v4lpgid7n81gr.apps.googleusercontent.com"},LP=t=>{const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>{window.google&&window.google.accounts.id.initialize({client_id:NP.clientId,callback:r=>{t(r.credential)},auto_select:!1,cancel_on_tap_outside:!0})},document.head.appendChild(e)},MP=t=>DP(t),OP=()=>{window.google&&window.google.accounts.id.disableAutoSelect()},[VP,BP]=hm({}),FP=async()=>{const e=await Bn({query:"qcm42351987"});if(e&&!e.error){let n=Object.assign({},{},e);BP(n)}return 1},UP=async t=>{let e=VP?.[992002];e&&(e.params={tkn:t},await Bn(e))},[Ni,br]=hm({user:null,loading:!0,error:null,authMethod:null}),[My,dh]=ye(null);qb(di,t=>{t?br({user:t,loading:!1,error:null,authMethod:"firebase"}):My()||br({user:null,loading:!1,error:null,authMethod:null})});b0(di).then(t=>{t&&br({user:t.user,loading:!1,error:null,authMethod:"firebase"})}).catch(t=>{console.error("Redirect sign-in error:",t),br({loading:!1,error:t.message})});const Ut={get state(){return Ni},async getUserProfile(t){try{const e=cP($P,"users",t),r=await CP(e);if(r.exists())return br("profile",r.data()),r.data();{let n=Ut?.state?.user;return await IP(e,{uid:n?.uid,email:n?.email,displayName:n?.displayName,createdAt:new Date}),console.log("No such user profile!"),null}}catch(e){return console.error("Error fetching user profile:",e),null}},hasPermission:t=>{const e=Ut.state?.profile;return e?e[t]===!0:!1},async signInWithGoogle(){try{br("loading",!0),br("error",null);try{const t=await d0(di,Ia);br({user:t.user,loading:!1,error:null,authMethod:"firebase"});try{Ut.getUserProfile(t.user.uid)}catch(e){console.error("firestore error:",e)}}catch(t){if(t.code==="auth/popup-blocked")await p0(di,Ia);else throw t}}catch(t){console.error("Sign-in error:",t),br({loading:!1,error:t.message||"Failed to sign in with Google"})}},async signInWithGoogleP(t){const r=await Bn({params:{id_token:t},query:"getGoogleUserbyToken"});if(r&&r){let n=new Date().getTime(),i=new Date(n+6e4*60*24*365),o="hrm_tkn_acc";document.cookie=`${o}=${r.data}; expires=${i}; path=/;g_state = {"i_l":1,"i_p":${i}}; ssgl_access_tkn = ${t}`,document.cookie=`ssgl_access_tkn = ${t}; expires=${i};`,await FP(),UP(r.data)}},async signInWithGoogleCloud(t){try{br("loading",!0),br("error",null);const e=MP(t),r={uid:e.sub,email:e.email,displayName:e.name,photoURL:e.picture};dh(r);const n={uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,emailVerified:!0};br({user:n,loading:!1,error:null,authMethod:"google-cloud"});try{const i=Zr.credential(t);await Ub(di,i)}catch{console.log("Firebase sign-in optional, continuing with Google Cloud auth")}}catch(e){console.error("Google Cloud sign-in error:",e),br({loading:!1,error:e.message||"Failed to sign in with Google Cloud"})}},async signOut(){try{br("loading",!0),(Ni.authMethod==="firebase"||di.currentUser)&&await Hb(di),Ni.authMethod==="google-cloud"&&(OP(),dh(null)),br({user:null,loading:!1,error:null,authMethod:null})}catch(t){console.error("Sign-out error:",t),br({loading:!1,error:t.message||"Failed to sign out"})}},get isAuthenticated(){return!!Ni.user||!!My()},get currentUser(){return Ni.user},get authMethod(){return Ni.authMethod}};var jP=z("<p>"),zP=z('<div><div><div><h1>HRM Finance</h1><p>Complete Business Management Solution</p><div><div><button><svg width=24 height=24 viewBox="0 0 24 24"><path fill=#4285F4 d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path><path fill=#34A853 d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path><path fill=#FBBC05 d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path><path fill=#EA4335 d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path></svg></button><p>Firebase Authentication</p></div></div></div><div><div><div>💰</div><h3>Financial Management</h3><p>Complete chart of accounts, balance sheets, journal entries, and invoice management in one place.</p></div><div><div>👥</div><h3>HR Management</h3><p>Track employees, manage onboarding, and monitor your workforce with powerful analytics.</p></div><div><div>📦</div><h3>Inventory Control</h3><p>Real-time inventory tracking, product management, and movement history across multiple locations.</p></div><div><div>🏦</div><h3>Banking Integration</h3><p>Streamline bank reconciliation with CSV imports and automated consolidation features.</p></div><div><div>📊</div><h3>Real-time Analytics</h3><p>Get instant insights with dashboards showing revenue, cash flow, and business performance.</p></div><div><div>🌐</div><h3>Multi-language Support</h3><p>Available in multiple languages to support your global business operations.</p></div></div><div><p>Secure authentication powered by Google • Your data is encrypted and protected</p><p>Choose your preferred authentication method above');const qP=()=>{cn(()=>{LP(T=>{Ut.signInWithGoogleP(T)}),setTimeout(()=>{},100)});const t={"min-height":"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},e={background:"white","border-radius":"1rem","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","max-width":"1200px",width:"100%",overflow:"hidden"},r={padding:"3rem","text-align":"center","border-bottom":"1px solid #e2e8f0"},n={"font-size":"2.5rem","font-weight":"800",color:"#1a202c","margin-bottom":"1rem"},i={"font-size":"1.125rem",color:"#718096","margin-bottom":"2rem"},o={display:"flex","flex-direction":"column",gap:"1rem","align-items":"center","margin-bottom":"1rem"},a={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"2rem",padding:"3rem"},c={"text-align":"center",padding:"2rem","border-radius":"0.5rem",background:"#f7fafc",transition:"transform 0.2s",cursor:"default"},u={"font-size":"3rem","margin-bottom":"1rem"},h={"font-size":"1.25rem","font-weight":"600",color:"#2d3748","margin-bottom":"0.5rem"},f={color:"#718096","line-height":"1.6"},p={display:"inline-flex","align-items":"center",gap:"0.75rem",background:"white",color:"#4285f4",border:"2px solid #4285f4",padding:"0.75rem 2rem","font-size":"1.125rem","font-weight":"500","border-radius":"0.5rem",cursor:"pointer",transition:"all 0.2s","min-width":"250px","justify-content":"center"},_={color:"#e53e3e","margin-top":"1rem","font-size":"0.875rem"},C={background:"#f7fafc",padding:"2rem","text-align":"center",color:"#718096","font-size":"0.875rem"},N={"font-size":"0.75rem",color:"#718096","margin-top":"0.25rem","font-style":"italic"},E=()=>{Ut.signInWithGoogle()};return(()=>{var T=zP(),x=T.firstChild,q=x.firstChild,ee=q.firstChild,Y=ee.nextSibling,ue=Y.nextSibling,ie=ue.firstChild,I=ie.firstChild;I.firstChild;var b=I.nextSibling,v=q.nextSibling,P=v.firstChild,w=P.firstChild,A=w.nextSibling,y=A.nextSibling,de=P.nextSibling,H=de.firstChild,$=H.nextSibling,Z=$.nextSibling,k=de.nextSibling,F=k.firstChild,B=F.nextSibling,W=B.nextSibling,fe=k.nextSibling,K=fe.firstChild,he=K.nextSibling,D=he.nextSibling,U=fe.nextSibling,Q=U.firstChild,J=Q.nextSibling,ce=J.nextSibling,oe=U.nextSibling,O=oe.firstChild,re=O.nextSibling,pe=re.nextSibling,ve=v.nextSibling,te=ve.firstChild,se=te.nextSibling;return d(T,t),d(x,e),d(q,r),d(ee,n),d(Y,i),d(ue,o),I.addEventListener("mouseleave",R=>{R.currentTarget.style.background="white",R.currentTarget.style.color="#4285f4"}),I.addEventListener("mouseenter",R=>{R.currentTarget.style.background="#4285f4",R.currentTarget.style.color="white"}),I.$$click=E,d(I,p),s(I,S(Ve,{get when(){return Ut.state.loading},fallback:"Sign in with Google",children:"Signing in..."}),null),d(b,N),s(q,S(Ve,{get when(){return Ut.state.error},get children(){var R=jP();return d(R,_),s(R,()=>Ut.state.error),R}}),null),d(v,a),d(ve,C),se.style.setProperty("margin-top","0.5rem"),se.style.setProperty("font-size","0.75rem"),ne(R=>{var M=Ut.state.loading,V=c,ge=u,le=h,j=f,G=c,Pe=u,_e=h,ae=f,be=c,X=u,Ce=h,$e=f,Ee=c,xe=u,Oe=h,He=f,je=c,Ie=u,Be=h,We=f,ze=c,Ge=u,Ae=h,nt=f;return M!==R.e&&(I.disabled=R.e=M),R.t=d(P,V,R.t),R.a=d(w,ge,R.a),R.o=d(A,le,R.o),R.i=d(y,j,R.i),R.n=d(de,G,R.n),R.s=d(H,Pe,R.s),R.h=d($,_e,R.h),R.r=d(Z,ae,R.r),R.d=d(k,be,R.d),R.l=d(F,X,R.l),R.u=d(B,Ce,R.u),R.c=d(W,$e,R.c),R.w=d(fe,Ee,R.w),R.m=d(K,xe,R.m),R.f=d(he,Oe,R.f),R.y=d(D,He,R.y),R.g=d(U,je,R.g),R.p=d(Q,Ie,R.p),R.b=d(J,Be,R.b),R.T=d(ce,We,R.T),R.A=d(oe,ze,R.A),R.O=d(O,Ge,R.O),R.I=d(re,Ae,R.I),R.S=d(pe,nt,R.S),R},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0}),T})()};St(["click"]);var HP=z("<div><div>");const WP=t=>{const e={"min-height":"100vh",display:"flex","align-items":"center","justify-content":"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},r={width:"50px",height:"50px",border:"3px solid rgba(255, 255, 255, 0.3)","border-top-color":"white","border-radius":"50%",animation:"spin 1s linear infinite"},n=document.createElement("style");return n.textContent=`
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  `,document.head.appendChild(n),ei(()=>{Ut.state?.user?.uid&&Ut.getUserProfile(Ut.state?.user?.uid)}),cn(()=>{}),S(Ve,{get when(){return!Ut.state.loading},get fallback(){return(()=>{var i=HP(),o=i.firstChild;return d(i,e),d(o,r),i})()},get children(){return S(Ve,{get when(){return Ut.isAuthenticated},get fallback(){return S(qP,{})},get children(){return t.children}})}})};var GP=z("<button>");const De=t=>{const e=()=>{const r={"font-family":"inherit",cursor:t.disabled?"not-allowed":"pointer",border:"none","border-radius":"var(--border-radius-sm)","font-weight":"500",transition:"all 0.2s ease","text-decoration":"none",display:"inline-flex","align-items":"center","justify-content":"center",gap:"0.5rem",opacity:t.disabled?"0.6":"1"},n={sm:{padding:"0.5rem 1rem","font-size":"0.875rem"},md:{padding:"0.75rem 1.5rem","font-size":"1rem"},lg:{padding:"1rem 2rem","font-size":"1.125rem"}},i={primary:{background:"linear-gradient(135deg, var(--primary-color), var(--primary-dark))",color:"white","box-shadow":"var(--shadow-sm)"},secondary:{background:"var(--surface-color)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},outline:{background:"transparent",color:"var(--primary-color)",border:"1px solid var(--primary-color)"}};return{...r,...n[t.size||"md"],...i[t.variant||"primary"]}};return(()=>{var r=GP();return Si(r,"click",t.onClick,!0),s(r,()=>t.children),ne(n=>{var i=e(),o=t.disabled,a=t.type||"button",c=`btn btn-${t.variant||"primary"} ${t.className||""}`;return n.e=d(r,i,n.e),o!==n.t&&(r.disabled=n.t=o),a!==n.a&&lt(r,"type",n.a=a),c!==n.o&&dc(r,n.o=c),n},{e:void 0,t:void 0,a:void 0,o:void 0}),r})()};St(["click"]);var KP=z("<div><div><div><h2></h2><button>×</button></div><div>");const mr=t=>{const e={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},r={background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","max-width":"920px",width:"90%","max-height":"80vh",overflow:"auto",position:"relative"},n={padding:"1.5rem","border-bottom":"1px solid var(--border-color)",display:"flex","justify-content":"space-between","align-items":"center"},i={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},o={background:"none",border:"none","font-size":"1.5rem",cursor:"pointer",color:"var(--text-muted)",padding:"0.5rem","border-radius":"var(--border-radius-sm)"},a={padding:"1.5rem"},c=u=>{u.target===u.currentTarget&&t.onClose()};return S(Ve,{get when(){return t.isOpen},get children(){var u=KP(),h=u.firstChild,f=h.firstChild,p=f.firstChild,_=p.nextSibling,C=f.nextSibling;return u.$$click=c,d(f,n),d(p,i),s(p,()=>t.title),_.addEventListener("mouseleave",N=>N.target.style.background="none"),_.addEventListener("mouseenter",N=>N.target.style.background="var(--background-color)"),Si(_,"click",t.onClose,!0),d(_,o),d(C,a),s(C,()=>t.children),ne(N=>{var E=e,T=r;return N.e=d(u,E,N.e),N.t=d(h,T,N.t),N},{e:void 0,t:void 0}),u}})};St(["click"]);var hh=z("<div>"),YP=z("<h3>"),QP=z("<p>");const Qe=t=>{const e={background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"1.5rem","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",transition:"all 0.2s ease",cursor:t.onClick?"pointer":"default"},r={"margin-bottom":"1rem"},n={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0 0 0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)",margin:"0"};return(()=>{var o=hh();return Si(o,"click",t.onClick,!0),s(o,(()=>{var a=me(()=>!!(t.title||t.subtitle));return()=>a()&&(()=>{var c=hh();return d(c,r),s(c,(()=>{var u=me(()=>!!t.title);return()=>u()&&(()=>{var h=YP();return d(h,n),s(h,()=>t.title),h})()})(),null),s(c,(()=>{var u=me(()=>!!t.subtitle);return()=>u()&&(()=>{var h=QP();return d(h,i),s(h,()=>t.subtitle),h})()})(),null),c})()})(),null),s(o,()=>t.children,null),ne(a=>{var c=e,u=`card ${t.className||""}`;return a.e=d(o,c,a.e),u!==a.t&&dc(o,a.t=u),a},{e:void 0,t:void 0}),o})()};St(["click"]);var JP=z("<div><label></label><input>"),XP=z("<span>*");const _t=t=>{const e={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},r={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},n={"margin-bottom":"1rem"};return(()=>{var i=JP(),o=i.firstChild,a=o.nextSibling;return d(i,n),d(o,e),s(o,()=>t.label,null),s(o,(()=>{var c=me(()=>!!t.required);return()=>c()&&(()=>{var u=XP();return u.style.setProperty("color","var(--primary-color)"),u})()})(),null),a.addEventListener("blur",c=>c.target.style.borderColor="var(--border-color)"),a.addEventListener("focus",c=>c.target.style.borderColor="var(--primary-color)"),a.$$input=c=>t.onChange(c.target.value),d(a,r),ne(c=>{var u=t.type||"text",h=t.placeholder,f=t.required,p=t.disabled;return u!==c.e&&lt(a,"type",c.e=u),h!==c.t&&lt(a,"placeholder",c.t=h),f!==c.a&&(a.required=c.a=f),p!==c.o&&(a.disabled=c.o=p),c},{e:void 0,t:void 0,a:void 0,o:void 0}),ne(()=>a.value=t.value),i})()};St(["input"]);const ZP={en:{common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",close:"Close",search:"Search",filter:"Filter",reset:"Reset",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",actions:"Actions",status:"Status",active:"Active",inactive:"Inactive",date:"Date",time:"Time",description:"Description",notes:"Notes",amount:"Amount",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Language",english:"English",spanish:"Spanish",noDataFound:"No data found",required:"Required",optional:"Optional",all:"All",none:"None",select:"Select",clear:"Clear",searching:"Searching...",refresh:"Refresh",showAll:"Show All",products:"products",filtered:"Filtered",view:"View",suggested:"Suggested",clearFilters:"Clear Filters",enhanced:"Enhanced",legacy:"Legacy",email:"Email",phone:"Phone",address:"Address",name:"Name",code:"Code",category:"Category",type:"Type",quantity:"Quantity",price:"Price",cost:"Cost",value:"Value",balance:"Balance",created:"Created",modified:"Modified",details:"Details",summary:"Summary",history:"History",new:"New",addNew:"Add New",unknown:"Unknown",notAvailable:"N/A",remove:"Remove",startDate:"Start Date",endDate:"End Date",from:"From",invoice:"Invoice",reference:"Reference",createdBy:"Created By",units:"units",invoiceDocumentId:"Invoice/Document ID",referenceNumber:"Reference Number",referenceNumberPlaceholder:"Enter reference number...",generalNotes:"General Notes",auto:"Auto",optionalNotes:"Optional notes...",showPerPage:"Show per page",first:"First",last:"Last",pageOfPages:"Page {{current}} of {{total}}",showingXofY:"Showing {{start}}-{{end}} of {{total}}",page:"Page",of:"of"},forms:{referenceNumberRequired:"Reference number is required",locationRequired:"Location is required",fromLocationRequired:"From location is required for transfers",atLeastOneProduct:"At least one product is required",itemProductRequired:"Product is required for item {{index}}",itemQuantityRequired:"Quantity must be greater than 0 for item {{index}}"},navigation:{dashboard:"Dashboard",accounts:"Chart of Accounts",balanceSheet:"Balance Sheet",inventory:"Inventory",employees:"Employees",entryBooks:"Entry Books",consolidate:"Bank Consolidation",reports:"Reports",settings:"Settings"},dashboard:{title:"Dashboard",welcome:"Welcome to HRM Finance",totalRevenue:"Total Revenue",overview:"Overview",recentActivity:"Recent Activity",quickActions:"Quick Actions",employeeCount:"Employee Count",pendingInvoices:"Pending Invoices",cashBalance:"Cash Balance",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalExpenses:"Total Expenses",netIncome:"Net Income",netLoss:"Net Loss",monthlyPayroll:"Monthly Payroll",current:"Current",newHires:"+3 new hires",outstanding:"Outstanding",totalOutstanding:"$23,450 total",lastUpdatedToday:"Last updated today",commonTasks:"Common tasks",generateReport:"Generate Report",latestUpdates:"Latest updates",invoicePaid:"Invoice #1234 paid",hoursAgo:"2 hours ago",newEmployeeOnboarded:"New employee onboarded",dayAgo:"1 day ago",monthlyReportGenerated:"Monthly report generated",daysAgo:"2 days ago"},accounts:{title:"Chart of Accounts",accountNumber:"Account Number",accountName:"Account Name",accountType:"Account Type",category:"Category",balance:"Balance",parentAccount:"Parent Account",subAccounts:"Sub-accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",transactions:"Transactions",accountHistory:"Account History",backToAccounts:"Back to Accounts",accountNotFound:"Account not found",accountInformation:"Account Information",accountPurpose:"Account purpose",transactionHistory:"Transaction History",noTransactions:"No transactions found for this account",createdDate:"Created Date",lastModified:"Last Modified",noDescription:"No description provided.",totalCount:"Total count",basicDetails:"Basic details",currentBalance:"Current balance",classification:"Classification",allTransactions:"All account transactions",reference:"Reference",allAccounts:"All Accounts",types:{asset:"Asset",liability:"Liability",equity:"Equity",revenue:"Revenue",expense:"Expense"},categories:{currentAssets:"Current Assets",fixedAssets:"Fixed Assets",currentLiabilities:"Current Liabilities",longTermLiabilities:"Long-term Liabilities",ownersEquity:"Owner's Equity",operatingRevenue:"Operating Revenue",operatingExpenses:"Operating Expenses"}},inventory:{title:"Inventory Management",overview:"Overview",products:"Products & Stock",movements:"Movements",locations:"Locations",bulkMovement:"Bulk Movement",addMovement:"Add Movement",addProduct:"Add Product",addLocation:"Add Location",singleMovement:"Add Single Movement",addNewItem:"Add New Item",activeProducts:"Active Products",lowStockAlert:"Low Stock Items",totalValue:"Total Stock Value",activeLocations:"Active Locations",productsNeedRestocking:"products need restocking",recentMovements:"Recent Movements",noProducts:"No products at this location",productName:"Product Name",productCode:"Product Code",sku:"SKU",unitOfMeasure:"Unit of Measure",unitCost:"Unit Cost",minStockLevel:"Min Stock Level",maxStockLevel:"Max Stock Level",locationName:"Location Name",locationType:"Location Type",locationCode:"Location Code",movementType:"Movement Type",referenceNumber:"Reference Number",invoiceNumber:"Invoice Number",fromLocation:"From Location",toLocation:"To Location",stockIn:"Stock In",stockOut:"Stock Out",transfer:"Transfer",adjustment:"Adjustment",inStock:"In Stock",lowStock:"Low Stock",outOfStock:"Out of Stock",stockLevels:"Stock Levels",stockByLocation:"Stock by Location",searchProducts:"Search products by name, SKU, or category...",searchProductsStock:"Search products and check stock levels...",searchResult:"Search Result",searchResults:"Search Results",searchFallback:"Showing local results",tryDifferentTerm:"Try a different search term or check spelling.",showingTopResults:"Showing top {{count}} results",searchLocations:"Search locations...",noMovements:"No movements found",productDetails:"Product Details",locationDetails:"Location Details",movementDetails:"Movement Details",totalProducts:"Total Products",totalLocations:"Total Locations",lastSeen:"Last seen",warehouseType:"Warehouse",storeType:"Store",supplierType:"Supplier",customerType:"Customer",currentlyManaged:"Currently managed",needAttention:"Need attention",currentWorth:"Current worth",warehousesStores:"Warehouses & stores",thisMonth:"This Month",latestActivities:"Latest inventory activities",searchMovements:"Search Movements",countingSheet:"Counting Sheet",physicalCount:"Physical Count",physicalInventoryCount:"Physical Inventory Count",setupPhysicalCount:"Setup Physical Inventory Count",setupDescription:"Configure your physical inventory count settings and begin the counting process.",countWillInclude:"This count will include {{count}} products from {{location}} in {{category}} category.",startCounting:"Start Physical Count",counted:"Counted",remaining:"Remaining",variances:"Variances",complete:"Complete",systemQty:"System Qty",variance:"Variance",addNotes:"Add notes...",reviewAndConfirm:"Review and Confirm Adjustments",reviewDescription:"Review the inventory adjustments below and confirm to update your system.",stockIncreases:"Stock Increases",stockDecreases:"Stock Decreases",totalAdjustments:"Total Adjustments",confirmAdjustments:"Confirm Adjustments",perfectCount:"Perfect Count!",noVariances:"No variances found. Your physical count matches the system exactly.",physicalCountAdjustment:"Physical count adjustment",inventoryCountingSheetTitle:"INVENTORY COUNTING SHEET",location:"Location",allCategories:"All Categories",countedBy:"Counted by",verifiedBy:"Verified by",instructions:"Instructions",countInstructions:["Count all items physically present at this location",'Write the actual count in the "Physical Count" column',"Leave blank if item is not found",'Note any discrepancies in the "Notes" column',"Sign and date when complete"],productName:"Product Name",unit:"Unit",totalProductsListed:"Total Products Listed",itemsCounted:"Items Counted",discrepanciesFound:"Discrepancies Found",counterSignature:"Counter Signature",supervisorSignature:"Supervisor Signature",downloadCSV:"Download CSV",noAdjustmentsToDownload:"No adjustments to download",stockIncrease:"Stock Increase",stockDecrease:"Stock Decrease",purchaseReceive:"Purchase/Receive",saleIssue:"Sale/Issue",transfer:"Transfer",adjustment:"Adjustment",movementType:"Movement Type",fromLocation:"From Location",toLocation:"To Location",searchSourceLocation:"Search source location...",searchDestinationLocation:"Search destination location...",searchLocation:"Search location...",addProduct:"Add Product",searchProduct:"Search product...",unitCost:"Unit Cost",noProductsAdded:'No products added yet. Click "Add Product" to get started.',createMovement:"Create Movement",generalNotesPlaceholder:"Enter general notes for this movement...",sortBy:"Sort By",allLocations:"All Locations",searchByProduct:"Search by product, location, reference, notes, invoice...",allProducts:"All Products",allTypes:"All Types",startDate:"Start Date",endDate:"End Date",totalMovements:"Total Movements",totalItems:"Total Items",adjustMovements:"Try adjusting your filters or check back later.",inventoryMovements:"Inventory Movements",createdBy:"Created By",view:"View",enhanced:"Enhanced",legacy:"Legacy",addSingleMovement:"Add Single Movement",inStockSubtitle:"In stock",itemsBelowThreshold:"Items below threshold",inventoryWorth:"Inventory worth",quantity:"Quantity",units:"units",normal:"Normal",productsAndStock:"Products & Stock",lowStockItems:"Low Stock Items",totalStockValue:"Total Stock Value",warehousesAndStores:"Warehouses & stores",andMore:"...and {count} more",latestInventoryActivities:"Latest inventory activities",min:"Min",max:"Max",cost:"Cost",noProductsFound:"No products found matching your search.",noProductsAvailable:"No products available.",noLocationsFound:"No locations found matching your search.",noLocationsAvailable:"No locations available.",searchPlaceholder:"Search by product, location, reference, notes, invoice...",noMovementsFound:"No movements found",tryAdjustingFilters:"Try adjusting your filters or check back later.",transfers:"Transfers",adjustments:"Adjustments",bulk:"Bulk",product:"Product",location:"Location",store:"Store",supplier:"Supplier",warehouse:"Warehouse",movement:"Movement",editMovement:"Edit Movement",updateMovement:"Update Movement",movementInformation:"Movement Information",locationInformation:"Location Information"},employees:{title:"Employee Management",employeeList:"Employee List",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",payrollInfo:"Payroll Information",firstName:"First Name",lastName:"Last Name",fullName:"Full Name",email:"Email",phone:"Phone",address:"Address",dateOfBirth:"Date of Birth",employeeId:"Employee ID",department:"Department",position:"Position",hireDate:"Hire Date",employmentStatus:"Employment Status",salary:"Salary",payFrequency:"Pay Frequency",taxId:"Tax ID",bankAccount:"Bank Account",emergencyContact:"Emergency Contact",activeEmployees:"Active Employees",inactiveEmployees:"Inactive Employees",totalPayroll:"Total Payroll",searchEmployees:"Search employees...",enterFullName:"Enter employee's full name",enterPosition:"Enter job position",enterEmail:"Enter email address",enterPhone:"Enter phone number",enterSalary:"Enter annual salary",departments:{engineering:"Engineering",product:"Product",design:"Design",marketing:"Marketing",sales:"Sales",humanResources:"Human Resources",finance:"Finance",operations:"Operations",analytics:"Analytics"}},entryBooks:{title:"Entry Books",bookName:"Book Name",bookType:"Book Type",createBook:"Create Book",editBook:"Edit Book",salesBook:"Sales Book",purchaseBook:"Purchase Book",cashBook:"Cash Book",generalBook:"General Book",entries:"Entries",addEntry:"Add Entry",period:"Period",startDate:"Start Date",endDate:"End Date",bookBalance:"Book Balance",reconciledBalance:"Reconciled Balance",difference:"Difference",reconcile:"Reconcile",isReconciled:"Is Reconciled",noBooks:"No entry books found",createFirst:"Create your first entry book to get started",bookDetails:"Book Details",entriesCount:"entries",bookOverview:"Book overview and details",bookEntries:"Book Entries",allEntries:"All entries in this book",noEntries:"No entries found",addFirst:"Add your first entry to this book",entryDate:"Entry Date",entryDescription:"Entry Description",entryAmount:"Entry Amount",entryReference:"Entry Reference",subtitle:"Manage accounting entries and general ledger records",viewReconciliation:"View Reconciliation",totalEntries:"Total Entries",allJournalEntries:"All journal entries",postedEntriesOnly:"Posted entries only",fromPostedEntries:"From {count} posted entries",needBankReconciliation:"Need bank reconciliation",allReconciled:"All reconciled",sortBy:"Sort By",fromDate:"From Date",toDate:"To Date",order:"Order",newest:"Newest",oldest:"Oldest",resetFilters:"Reset Filters",activeFilters:"Active filters",from:"From",to:"To",entriesFound:"{count} entries found",noJournalEntries:"No Journal Entries",startByCreating:"Start by creating your first entry",noEntriesMatch:"No journal entries match your current filters.",createFirstEntry:"Create First Entry",void:"Void",confirmVoid:"Are you sure you want to void this journal entry?",entryBookRecords:"Entry Book Records"},banking:{title:"Bank Consolidation",bankAccount:"Bank Account",statementDate:"Statement Date",beginningBalance:"Beginning Balance",endingBalance:"Ending Balance",deposits:"Deposits",withdrawals:"Withdrawals",bankCharges:"Bank Charges",interest:"Interest",reconcile:"Reconcile",matched:"Matched",unmatched:"Unmatched",importStatement:"Import Statement",manualEntry:"Manual Entry",autoMatch:"Auto Match",clearAll:"Clear All",reconciliationStatus:"Reconciliation Status",difference:"Difference",bookBalance:"Book Balance",statementBalance:"Statement Balance",outstandingChecks:"Outstanding Checks",depositsInTransit:"Deposits in Transit",reconciled:"Reconciled",notReconciled:"Not Reconciled",unreconciled:"Unreconciled",reconciliation:"Reconciliation",compareStatements:"Compare bank statements with entry book records",importCSV:"Import CSV",startNewReconciliation:"Start New Reconciliation",bankAccountInfo:"Bank Account Info",currentAccountDetails:"Current account details",lastReconciled:"Last reconciled",bankTransactions:"Bank Transactions",selectedPeriod:"Selected period",pending:"pending",bookEntriesForComparison:"Book entries for comparison",reconciliationRate:"Reconciliation Rate",completionStatus:"Completion status",recentReconciliationSessions:"Recent Reconciliation Sessions",latestActivity:"Latest activity",noRecentSessions:"No recent reconciliation sessions found.",startFirstReconciliation:"Start First Reconciliation",entryBookRecords:"Entry Book Records",pleaseUploadCSV:"Please upload a CSV file",csvRequiresHeaderAndData:"CSV file must have at least a header and one data row",successfullyParsed:"Successfully parsed {count} rows",errorParsingCSV:"Error parsing CSV file. Please check the format.",dateDescriptionRequired:"Date and Description columns are required",importedTransaction:"Imported transaction",successfullyImported:"Successfully imported {count} bank transactions",errorImportingTransactions:"Error importing transactions. Please check your data.",importBankStatementCSV:"Import Bank Statement CSV",dropCSVHere:"Drop CSV file here",clickToUploadCSV:"Click to upload or drag and drop CSV file",supportedFormat:"Supported format: CSV with Date, Description, and Amount columns",mapCSVColumns:"Map CSV Columns",dateColumn:"Date Column",selectColumn:"Select column...",descriptionColumn:"Description Column",referenceColumn:"Reference Column",amountDebitColumn:"Amount/Debit Column",creditColumn:"Credit Column",balanceColumn:"Balance Column",andMoreRows:"... and {count} more rows",importing:"Importing...",importTransactions:"Import {count} Transactions",reconciliationComparison:"Reconciliation Comparison",bankStatements:"Bank Statements",totalTransactions:"Total transactions",totalEntries:"Total entries",unreconciledBank:"Unreconciled Bank",unreconciledBooks:"Unreconciled Books",needAttention:"Need attention",unreconcile:"Unreconcile",clickToReconcile:"Click to reconcile",potentialMatchesFound:"Potential Matches Found",clickRecordToReconcile:"Click on a record below to reconcile",exactMatch:"Exact Match",possibleMatch:"Possible Match",selected:"Selected",clearSelection:"Clear Selection"},journal:{title:"Journal Entries",entryNumber:"Entry Number",entryDate:"Entry Date",debit:"Debit",credit:"Credit",account:"Account",memo:"Memo",reference:"Reference",createEntry:"Create Entry",editEntry:"Edit Entry",deleteEntry:"Delete Entry",posted:"Posted",draft:"Draft",reversed:"Reversed",recurringEntry:"Recurring Entry",attachments:"Attachments",totalDebits:"Total Debits",totalCredits:"Total Credits",outOfBalance:"Out of Balance",balanced:"Balanced",addEntry:"Add Journal Entry",allEntries:"All Entries",totalDebit:"Total Debit",totalCredit:"Total Credit",debitShort:"Dr.",creditShort:"Cr.",noReference:"No reference",createdBy:"By",totalAmount:"Total Amount",lines:"Lines",entryNotBalancedShort:"Entry is not balanced",accountLines:"Account Lines",noDescription:"No description",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryLines:"Journal Entry Lines",addLine:"Add Line",lineDescription:"Line description",notBalanced:"Not Balanced",updateEntry:"Update Entry",saveAsDraft:"Save as Draft",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",editEntryTooltip:"Edit this journal entry",post:"Post",entryMustBeBalanced:"Entry must be balanced to post",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",journalLines:"Journal Lines",balanceStatus:"Balance Status",unbalanced:"Unbalanced",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",postEntry:"Post Entry",fixBalance:"Fix Balance",voidEntry:"Void Entry",draftEntry:"Draft Entry",draftEntryDescription:"This entry can be edited and posted.",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",postedEntry:"Posted Entry",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",minTwoLinesRequired:"At least 2 line items are required",entryNotBalanced:"Entry is not balanced. Debit: ${debit}, Credit: ${credit}",lineAccountRequired:"Line {lineNumber}: Account is required",lineAmountRequired:"Line {lineNumber}: Either debit or credit amount must be provided",lineBothAmounts:"Line {lineNumber}: Cannot have both debit and credit amounts",enterEntryDescription:"Enter journal entry description",enterReferenceNumber:"Enter reference number"},forms:{requiredField:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",selectOption:"Please select an option",enterValue:"Please enter a value",confirmDelete:"Are you sure you want to delete this item?",unsavedChanges:"You have unsaved changes. Do you want to continue?",saveSuccess:"Saved successfully",saveError:"Error saving data",deleteSuccess:"Deleted successfully",deleteError:"Error deleting item",duplicateAccountNumber:"Account number already exists",descriptionRequired:"Description is required",errorOccurred:"An error occurred",errorPostingEntry:"An error occurred while posting the entry"},modals:{addInventory:"Add Inventory Movement",bulkMovement:"Bulk Inventory Movement",addProduct:"Add New Product",addLocation:"Add New Location",inventoryDetail:"Inventory Item Details",quickAdd:"Quick Add",selectProduct:"Select Product",selectLocation:"Select Location",enterQuantity:"Enter quantity",enterCost:"Enter unit cost",enterReference:"Enter reference number",addNotes:"Add notes (optional)",generalInformation:"General Information",stockInformation:"Stock Information",locationInformation:"Location Information",movementInformation:"Movement Information",addToInventory:"Add to Inventory",createProduct:"Create Product",createLocation:"Create Location",processing:"Processing...",addingMovement:"Adding movement...",creatingProduct:"Creating product...",creatingLocation:"Creating location..."},products:{title:"Products",addNew:"Add New Product",totalProducts:"Total Products",inCatalog:"In catalog",activeProducts:"Active Products",currentlyAvailable:"Currently available",outOfStock:"Out of Stock",needsRestock:"Needs restock",productCatalog:"Product Catalog",manageYourProducts:"Manage your products and pricing",inStock:"In Stock",furniture:"Furniture",electronics:"Electronics",supplies:"Supplies",lighting:"Lighting",searchPlaceholder:"Search products by name, SKU, or category...",allCategories:"All Categories",clearFilters:"Clear filters",noResults:"No products found matching your criteria.",noProducts:"No products available.",showing:"Showing",filtered:"Filtered results",allProducts:"All products",searchResult:"Search Result",stock:"Stock",lowStock:"Low Stock"},invoices:{title:"Invoices",createNew:"Create New Invoice",totalOutstanding:"Total Outstanding",unpaidInvoices:"Unpaid invoices",thisMonth:"This Month",revenueCollected:"Revenue collected",overdue:"Overdue",pastDueInvoices:"Past due invoices",recentInvoices:"Recent Invoices",latestBillingActivity:"Latest billing activity",paid:"Paid",pending:"Pending"},unauthorized:{title:"Access Restricted",accessDenied:"Access Denied",noPermission:"You don't have permission to access",thisFeature:"this feature",whySeeing:"Why am I seeing this?",explanation:"Your account doesn't have the necessary permissions to view this content.",requiredPermission:"Required permission:",goToDashboard:"Go to Dashboard",goBack:"Go Back",featuresCanAccess:"Features you can access:",dashboardAccess:"Dashboard and overview statistics",profileAccess:"Your profile and settings",roleBasedAccess:"Features enabled for your role",needAccess:"Need access? Contact your administrator or manager to request the appropriate permissions.",permissions:{accountAccess:"Account Management Access",inventoryAccess:"Inventory Access",employeeAccess:"HR Access",bankingAccess:"Banking Access",journalAccess:"Journal Entry Access",adminAccess:"Administrative Access",financialReporting:"Financial Reporting Access",invoiceManagement:"Invoice Management Access",productManagement:"Product Management Access"}}},es:{common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",add:"Agregar",close:"Cerrar",search:"Buscar",filter:"Filtrar",reset:"Restablecer",back:"Atrás",next:"Siguiente",previous:"Anterior",yes:"Sí",no:"No",loading:"Cargando...",error:"Error",success:"Éxito",warning:"Advertencia",info:"Información",confirm:"Confirmar",actions:"Acciones",status:"Estado",active:"Activo",inactive:"Inactivo",date:"Fecha",time:"Hora",description:"Descripción",notes:"Notas",amount:"Monto",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Idioma",english:"Inglés",spanish:"Español",noDataFound:"No se encontraron datos",required:"Requerido",optional:"Opcional",all:"Todos",none:"Ninguno",select:"Seleccionar",clear:"Limpiar",view:"Ver",suggested:"Sugerido",clearFilters:"Limpiar Filtros",enhanced:"Mejorado",legacy:"Clásico",email:"Correo Electrónico",phone:"Teléfono",address:"Dirección",name:"Nombre",code:"Código",category:"Categoría",type:"Tipo",quantity:"Cantidad",price:"Precio",cost:"Costo",value:"Valor",balance:"Saldo",created:"Creado",modified:"Modificado",details:"Detalles",summary:"Resumen",history:"Historial",new:"Nuevo",addNew:"Agregar Nuevo",unknown:"Desconocido",notAvailable:"N/A",remove:"Remover",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",from:"De",invoice:"Factura",reference:"Referencia",createdBy:"Creado Por",units:"unidades",invoiceDocumentId:"ID de Factura/Documento",referenceNumber:"Número de Referencia",referenceNumberPlaceholder:"Ingrese número de referencia...",generalNotes:"Notas Generales",auto:"Auto",optionalNotes:"Notas opcionales...",showPerPage:"Mostrar por página",first:"Primera",last:"Última",pageOfPages:"Página {{current}} de {{total}}",showingXofY:"Mostrando {{start}}-{{end}} de {{total}}",page:"Página",of:"de"},forms:{referenceNumberRequired:"El número de referencia es requerido",locationRequired:"La ubicación es requerida",fromLocationRequired:"La ubicación de origen es requerida para transferencias",atLeastOneProduct:"Al menos un producto es requerido",itemProductRequired:"El producto es requerido para el artículo {{index}}",itemQuantityRequired:"La cantidad debe ser mayor que 0 para el artículo {{index}}"},navigation:{dashboard:"Panel de Control",accounts:"Plan de Cuentas",balanceSheet:"Balance General",inventory:"Inventario",employees:"Empleados",entryBooks:"Libros de Entrada",consolidate:"Consolidación Bancaria",reports:"Reportes",settings:"Configuración"},dashboard:{title:"Panel de Control",welcome:"Bienvenido a HRM Finance",totalRevenue:"Ingresos Totales",overview:"Resumen",recentActivity:"Actividad Reciente",quickActions:"Acciones Rápidas",employeeCount:"Número de Empleados",pendingInvoices:"Facturas Pendientes",cashBalance:"Saldo en Efectivo",totalAssets:"Activos Totales",totalLiabilities:"Pasivos Totales",totalExpenses:"Gastos Totales",netIncome:"Ingreso Neto",netLoss:"Pérdida Neta",monthlyPayroll:"Nómina Mensual",current:"Actual",newHires:"+3 nuevas contrataciones",outstanding:"Pendiente",totalOutstanding:"$23,450 total",lastUpdatedToday:"Última actualización hoy",commonTasks:"Tareas comunes",generateReport:"Generar Reporte",latestUpdates:"Últimas actualizaciones",invoicePaid:"Factura #1234 pagada",hoursAgo:"hace 2 horas",newEmployeeOnboarded:"Nuevo empleado incorporado",dayAgo:"hace 1 día",monthlyReportGenerated:"Reporte mensual generado",daysAgo:"hace 2 días"},accounts:{title:"Plan de Cuentas",accountNumber:"Número de Cuenta",accountName:"Nombre de Cuenta",accountType:"Tipo de Cuenta",category:"Categoría",balance:"Saldo",parentAccount:"Cuenta Padre",subAccounts:"Subcuentas",addAccount:"Agregar Cuenta",editAccount:"Editar Cuenta",deleteAccount:"Eliminar Cuenta",accountDetails:"Detalles de Cuenta",transactions:"Transacciones",accountHistory:"Historial de Cuenta",backToAccounts:"Volver a Cuentas",accountNotFound:"Cuenta no encontrada",accountInformation:"Información de Cuenta",accountPurpose:"Propósito de la cuenta",transactionHistory:"Historial de Transacciones",noTransactions:"No se encontraron transacciones para esta cuenta",createdDate:"Fecha de Creación",lastModified:"Última Modificación",noDescription:"No se proporcionó descripción.",totalCount:"Conteo total",basicDetails:"Detalles básicos",currentBalance:"Saldo actual",classification:"Clasificación",allTransactions:"Todas las transacciones de la cuenta",reference:"Referencia",types:{asset:"Activo",liability:"Pasivo",equity:"Patrimonio",revenue:"Ingreso",expense:"Gasto"},categories:{currentAssets:"Activos Corrientes",fixedAssets:"Activos Fijos",currentLiabilities:"Pasivos Corrientes",longTermLiabilities:"Pasivos a Largo Plazo",ownersEquity:"Patrimonio del Propietario",operatingRevenue:"Ingresos Operacionales",operatingExpenses:"Gastos Operacionales"}},inventory:{title:"Gestión de Inventario",overview:"Resumen",products:"Productos y Stock",movements:"Movimientos",locations:"Ubicaciones",bulkMovement:"Movimiento Masivo",addMovement:"Agregar Movimiento",addProduct:"Agregar Producto",addLocation:"Agregar Ubicación",singleMovement:"Agregar Movimiento Individual",addNewItem:"Agregar Nuevo Artículo",activeProducts:"Productos Activos",lowStockAlert:"Artículos con Stock Bajo",totalValue:"Valor Total del Stock",activeLocations:"Ubicaciones Activas",productsNeedRestocking:"productos necesitan reabastecimiento",recentMovements:"Movimientos Recientes",noProducts:"No hay productos en esta ubicación",productName:"Nombre del Producto",productCode:"Código del Producto",sku:"SKU",unitOfMeasure:"Unidad de Medida",unitCost:"Costo Unitario",minStockLevel:"Nivel Mínimo de Stock",maxStockLevel:"Nivel Máximo de Stock",locationName:"Nombre de Ubicación",locationType:"Tipo de Ubicación",locationCode:"Código de Ubicación",movementType:"Tipo de Movimiento",referenceNumber:"Número de Referencia",invoiceNumber:"Número de Factura",fromLocation:"Desde Ubicación",toLocation:"Hacia Ubicación",stockIn:"Entrada de Stock",stockOut:"Salida de Stock",transfer:"Transferencia",adjustment:"Ajuste",inStock:"En Stock",lowStock:"Stock Bajo",outOfStock:"Sin Stock",stockLevels:"Niveles de Stock",stockByLocation:"Stock por Ubicación",searchProducts:"Buscar productos...",searchLocations:"Buscar ubicaciones...",noMovements:"No se encontraron movimientos",productDetails:"Detalles del Producto",locationDetails:"Detalles de Ubicación",movementDetails:"Detalles del Movimiento",totalProducts:"Total de Productos",totalLocations:"Total de Ubicaciones",lastSeen:"Visto por última vez",warehouseType:"Almacén",storeType:"Tienda",supplierType:"Proveedor",customerType:"Cliente",currentlyManaged:"Gestionados actualmente",needAttention:"Necesitan atención",currentWorth:"Valor actual",warehousesStores:"Almacenes y tiendas",thisMonth:"Este Mes",latestActivities:"Últimas actividades de inventario",searchMovements:"Buscar Movimientos",countingSheet:"Hoja de Conteo",physicalCount:"Conteo Físico",physicalInventoryCount:"Conteo Físico de Inventario",setupPhysicalCount:"Configurar Conteo Físico de Inventario",setupDescription:"Configure los ajustes de su conteo físico de inventario y comience el proceso de conteo.",countWillInclude:"Este conteo incluirá {{count}} productos de {{location}} en la categoría {{category}}.",startCounting:"Iniciar Conteo Físico",counted:"Contado",remaining:"Restante",variances:"Variaciones",complete:"Completo",systemQty:"Cant. Sistema",variance:"Variación",addNotes:"Agregar notas...",reviewAndConfirm:"Revisar y Confirmar Ajustes",reviewDescription:"Revise los ajustes de inventario a continuación y confirme para actualizar su sistema.",stockIncreases:"Aumentos de Stock",stockDecreases:"Disminuciones de Stock",totalAdjustments:"Ajustes Totales",confirmAdjustments:"Confirmar Ajustes",adjustment:"Ajuste",perfectCount:"¡Conteo Perfecto!",noVariances:"No se encontraron variaciones. Su conteo físico coincide exactamente con el sistema.",physicalCountAdjustment:"Ajuste de conteo físico",inventoryCountingSheetTitle:"HOJA DE CONTEO DE INVENTARIO",location:"Ubicación",allCategories:"Todas las Categorías",countedBy:"Contado por",verifiedBy:"Verificado por",instructions:"Instrucciones",countInstructions:["Contar todos los artículos físicamente presentes en esta ubicación",'Escribir el conteo real en la columna "Conteo Físico"',"Dejar en blanco si el artículo no se encuentra",'Anotar cualquier discrepancia en la columna "Notas"',"Firmar y fechar cuando esté completo"],productName:"Nombre del Producto",unit:"Unidad",totalProductsListed:"Total de Productos Listados",itemsCounted:"Artículos Contados",discrepanciesFound:"Discrepancias Encontradas",counterSignature:"Firma del Contador",supervisorSignature:"Firma del Supervisor",downloadCSV:"Descargar CSV",noAdjustmentsToDownload:"No hay ajustes para descargar",stockIncrease:"Aumento de Stock",stockDecrease:"Disminución de Stock",purchaseReceive:"Compra/Recepción",saleIssue:"Venta/Emisión",transfer:"Transferencia",adjustment:"Ajuste",movementType:"Tipo de Movimiento",fromLocation:"Ubicación de Origen",toLocation:"Ubicación de Destino",searchSourceLocation:"Buscar ubicación de origen...",searchDestinationLocation:"Buscar ubicación de destino...",searchLocation:"Buscar ubicación...",addProduct:"Agregar Producto",searchProduct:"Buscar producto...",unitCost:"Costo Unitario",noProductsAdded:'No se han agregado productos aún. Haga clic en "Agregar Producto" para comenzar.',createMovement:"Crear Movimiento",generalNotesPlaceholder:"Ingrese notas generales para este movimiento...",sortBy:"Ordenar Por",allLocations:"Todas las Ubicaciones",searchByProduct:"Buscar por producto, ubicación, referencia, notas, factura...",allProducts:"Todos los Productos",allTypes:"Todos los Tipos",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",totalMovements:"Movimientos Totales",totalItems:"Artículos Totales",adjustMovements:"Intenta ajustar tus filtros o revisa más tarde.",inventoryMovements:"Movimientos de Inventario",createdBy:"Creado Por",view:"Ver",enhanced:"Mejorado",legacy:"Clásico",addSingleMovement:"Agregar Movimiento Individual",inStockSubtitle:"En stock",itemsBelowThreshold:"Artículos bajo el umbral",inventoryWorth:"Valor del inventario",quantity:"Cantidad",units:"unidades",normal:"Normal",productsAndStock:"Productos y Stock",lowStockItems:"Artículos con Stock Bajo",totalStockValue:"Valor Total del Stock",warehousesAndStores:"Almacenes y tiendas",andMore:"...y {count} más",latestInventoryActivities:"Últimas actividades de inventario",min:"Mín",max:"Máx",cost:"Costo",noProductsFound:"No se encontraron productos que coincidan con su búsqueda.",noProductsAvailable:"No hay productos disponibles.",noLocationsFound:"No se encontraron ubicaciones que coincidan con su búsqueda.",noLocationsAvailable:"No hay ubicaciones disponibles.",searchPlaceholder:"Buscar por producto, ubicación, referencia, notas, factura...",noMovementsFound:"No se encontraron movimientos",tryAdjustingFilters:"Intenta ajustar tus filtros o revisa más tarde.",transfers:"Transferencias",adjustments:"Ajustes",bulk:"Masivo",product:"Producto",location:"Ubicación",store:"Tienda",supplier:"Proveedor",warehouse:"Almacén",movement:"Movimiento",editMovement:"Editar Movimiento",updateMovement:"Actualizar Movimiento",movementInformation:"Información del Movimiento",locationInformation:"Información de Ubicación"},employees:{title:"Gestión de Empleados",employeeList:"Lista de Empleados",addEmployee:"Agregar Empleado",editEmployee:"Editar Empleado",employeeDetails:"Detalles del Empleado",personalInfo:"Información Personal",employmentInfo:"Información Laboral",payrollInfo:"Información de Nómina",firstName:"Nombre",lastName:"Apellido",fullName:"Nombre Completo",email:"Correo Electrónico",phone:"Teléfono",address:"Dirección",dateOfBirth:"Fecha de Nacimiento",employeeId:"ID de Empleado",department:"Departamento",position:"Puesto",hireDate:"Fecha de Contratación",employmentStatus:"Estado Laboral",salary:"Salario",payFrequency:"Frecuencia de Pago",taxId:"ID Fiscal",bankAccount:"Cuenta Bancaria",emergencyContact:"Contacto de Emergencia",activeEmployees:"Empleados Activos",inactiveEmployees:"Empleados Inactivos",totalPayroll:"Nómina Total",searchEmployees:"Buscar empleados...",enterFullName:"Ingrese el nombre completo del empleado",enterPosition:"Ingrese el puesto de trabajo",enterEmail:"Ingrese la dirección de correo electrónico",enterPhone:"Ingrese el número de teléfono",enterSalary:"Ingrese el salario anual",departments:{engineering:"Ingeniería",product:"Producto",design:"Diseño",marketing:"Marketing",sales:"Ventas",humanResources:"Recursos Humanos",finance:"Finanzas",operations:"Operaciones",analytics:"Analítica"}},entryBooks:{title:"Libros de Entrada",bookName:"Nombre del Libro",bookType:"Tipo de Libro",createBook:"Crear Libro",editBook:"Editar Libro",salesBook:"Libro de Ventas",purchaseBook:"Libro de Compras",cashBook:"Libro de Caja",generalBook:"Libro General",entries:"Entradas",addEntry:"Agregar Entrada",period:"Período",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",bookBalance:"Saldo del Libro",reconciledBalance:"Saldo Conciliado",difference:"Diferencia",reconcile:"Conciliar",isReconciled:"Está Conciliado",noBooks:"No se encontraron libros de entrada",createFirst:"Crea tu primer libro de entrada para comenzar",bookDetails:"Detalles del Libro",entriesCount:"entradas",bookOverview:"Resumen y detalles del libro",bookEntries:"Entradas del Libro",allEntries:"Todas las entradas en este libro",noEntries:"No se encontraron entradas",addFirst:"Agrega tu primera entrada a este libro",entryDate:"Fecha de Entrada",entryDescription:"Descripción de Entrada",entryAmount:"Monto de Entrada",entryReference:"Referencia de Entrada"},banking:{title:"Consolidación Bancaria",bankAccount:"Cuenta Bancaria",statementDate:"Fecha del Estado",beginningBalance:"Saldo Inicial",endingBalance:"Saldo Final",deposits:"Depósitos",withdrawals:"Retiros",bankCharges:"Cargos Bancarios",interest:"Intereses",reconcile:"Conciliar",matched:"Conciliado",unmatched:"No Conciliado",importStatement:"Importar Estado",manualEntry:"Entrada Manual",autoMatch:"Coincidencia Automática",clearAll:"Limpiar Todo",reconciliationStatus:"Estado de Conciliación",difference:"Diferencia",bookBalance:"Saldo en Libros",statementBalance:"Saldo del Estado",outstandingChecks:"Cheques Pendientes",depositsInTransit:"Depósitos en Tránsito",reconciled:"Conciliado",notReconciled:"No Conciliado",unreconciled:"No Conciliado",reconciliation:"Conciliación",compareStatements:"Comparar estados bancarios con registros de libros de entrada",importCSV:"Importar CSV",startNewReconciliation:"Iniciar Nueva Conciliación",bankAccountInfo:"Información de Cuenta Bancaria",currentAccountDetails:"Detalles de cuenta actual",lastReconciled:"Última conciliación",bankTransactions:"Transacciones Bancarias",selectedPeriod:"Período seleccionado",pending:"pendiente",bookEntriesForComparison:"Entradas de libros para comparación",reconciliationRate:"Tasa de Conciliación",completionStatus:"Estado de finalización",recentReconciliationSessions:"Sesiones de Conciliación Recientes",latestActivity:"Actividad reciente",noRecentSessions:"No se encontraron sesiones de conciliación recientes.",startFirstReconciliation:"Iniciar Primera Conciliación",entryBookRecords:"Registros de Libros de Entrada",pleaseUploadCSV:"Por favor suba un archivo CSV",csvRequiresHeaderAndData:"El archivo CSV debe tener al menos un encabezado y una fila de datos",successfullyParsed:"Se analizaron exitosamente {count} filas",errorParsingCSV:"Error al analizar el archivo CSV. Verifique el formato.",dateDescriptionRequired:"Las columnas de Fecha y Descripción son requeridas",importedTransaction:"Transacción importada",successfullyImported:"Se importaron exitosamente {count} transacciones bancarias",errorImportingTransactions:"Error al importar transacciones. Verifique sus datos.",importBankStatementCSV:"Importar CSV de Estado Bancario",dropCSVHere:"Suelte el archivo CSV aquí",clickToUploadCSV:"Haga clic para cargar o arrastre y suelte el archivo CSV",supportedFormat:"Formato soportado: CSV con columnas de Fecha, Descripción y Monto",mapCSVColumns:"Mapear Columnas CSV",dateColumn:"Columna de Fecha",selectColumn:"Seleccionar columna...",descriptionColumn:"Columna de Descripción",referenceColumn:"Columna de Referencia",amountDebitColumn:"Columna de Monto/Débito",creditColumn:"Columna de Crédito",balanceColumn:"Columna de Saldo",andMoreRows:"... y {count} filas más",importing:"Importando...",importTransactions:"Importar {count} Transacciones",reconciliationComparison:"Comparación de Conciliación",bankStatements:"Estados Bancarios",totalTransactions:"Transacciones totales",totalEntries:"Entradas totales",unreconciledBank:"Banco No Conciliado",unreconciledBooks:"Libros No Conciliados",needAttention:"Necesitan atención",unreconcile:"Desconciliar",clickToReconcile:"Hacer clic para conciliar",potentialMatchesFound:"Coincidencias Potenciales Encontradas",clickRecordToReconcile:"Haga clic en un registro a continuación para conciliar",exactMatch:"Coincidencia Exacta",possibleMatch:"Posible Coincidencia",selected:"Seleccionado",clearSelection:"Limpiar Selección"},journal:{title:"Asientos Contables",entryNumber:"Número de Asiento",entryDate:"Fecha del Asiento",debit:"Débito",credit:"Crédito",account:"Cuenta",memo:"Memo",reference:"Referencia",createEntry:"Crear Asiento",editEntry:"Editar Asiento",deleteEntry:"Eliminar Asiento",posted:"Registrado",draft:"Borrador",reversed:"Revertido",recurringEntry:"Asiento Recurrente",attachments:"Adjuntos",totalDebits:"Débitos Totales",totalCredits:"Créditos Totales",outOfBalance:"Desbalanceado",balanced:"Balanceado"},forms:{requiredField:"Este campo es requerido",invalidEmail:"Dirección de correo inválida",invalidNumber:"Número inválido",invalidDate:"Fecha inválida",selectOption:"Por favor seleccione una opción",enterValue:"Por favor ingrese un valor",confirmDelete:"¿Está seguro de que desea eliminar este elemento?",unsavedChanges:"Tiene cambios sin guardar. ¿Desea continuar?",saveSuccess:"Guardado exitosamente",saveError:"Error al guardar datos",deleteSuccess:"Eliminado exitosamente",deleteError:"Error al eliminar elemento",duplicateAccountNumber:"El número de cuenta ya existe"},modals:{addInventory:"Agregar Movimiento de Inventario",bulkMovement:"Movimiento Masivo de Inventario",addProduct:"Agregar Nuevo Producto",addLocation:"Agregar Nueva Ubicación",inventoryDetail:"Detalles del Artículo de Inventario",quickAdd:"Agregar Rápido",selectProduct:"Seleccionar Producto",selectLocation:"Seleccionar Ubicación",enterQuantity:"Ingresar cantidad",enterCost:"Ingresar costo unitario",enterReference:"Ingresar número de referencia",addNotes:"Agregar notas (opcional)",generalInformation:"Información General",stockInformation:"Información de Stock",locationInformation:"Información de Ubicación",movementInformation:"Información de Movimiento",addToInventory:"Agregar al Inventario",createProduct:"Crear Producto",createLocation:"Crear Ubicación",processing:"Procesando...",addingMovement:"Agregando movimiento...",creatingProduct:"Creando producto...",creatingLocation:"Creando ubicación..."},products:{title:"Productos",addNew:"Agregar Nuevo Producto",totalProducts:"Total de Productos",inCatalog:"En catálogo",activeProducts:"Productos Activos",currentlyAvailable:"Actualmente disponibles",outOfStock:"Sin Stock",needsRestock:"Necesita reabastecimiento",productCatalog:"Catálogo de Productos",manageYourProducts:"Gestiona tus productos y precios",inStock:"En Stock",furniture:"Muebles",electronics:"Electrónicos",supplies:"Suministros",lighting:"Iluminación"},invoices:{title:"Facturas",createNew:"Crear Nueva Factura",totalOutstanding:"Total Pendiente",unpaidInvoices:"Facturas no pagadas",thisMonth:"Este Mes",revenueCollected:"Ingresos recaudados",overdue:"Vencidas",pastDueInvoices:"Facturas vencidas",recentInvoices:"Facturas Recientes",latestBillingActivity:"Actividad de facturación reciente",paid:"Pagado",pending:"Pendiente"},unauthorized:{title:"Acceso Restringido",accessDenied:"Acceso Denegado",noPermission:"No tienes permisos para acceder a",thisFeature:"esta funcionalidad",whySeeing:"¿Por qué veo esto?",explanation:"Tu cuenta no tiene los permisos necesarios para ver este contenido.",requiredPermission:"Permiso requerido:",goToDashboard:"Ir al Panel de Control",goBack:"Regresar",featuresCanAccess:"Funcionalidades a las que puedes acceder:",dashboardAccess:"Panel de control y estadísticas generales",profileAccess:"Tu perfil y configuraciones",roleBasedAccess:"Funcionalidades habilitadas para tu rol",needAccess:"¿Necesitas acceso? Contacta a tu administrador o gerente para solicitar los permisos apropiados.",permissions:{accountAccess:"Acceso a Gestión de Cuentas",inventoryAccess:"Acceso a Inventario",employeeAccess:"Acceso a Recursos Humanos",bankingAccess:"Acceso Bancario",journalAccess:"Acceso a Asientos Contables",adminAccess:"Acceso Administrativo",financialReporting:"Acceso a Reportes Financieros",invoiceManagement:"Acceso a Gestión de Facturas",productManagement:"Acceso a Gestión de Productos"}}}},ew=()=>{if(typeof window<"u"){const t=localStorage.getItem("hrmfinance-language");if(t&&["en","es"].includes(t))return t}return"en"},[mh,tw]=ye(ew()),ot=()=>({t:(n,i,o)=>{const a=mh(),c=n.split(".");let u=ZP[a];for(const f of c)if(u&&typeof u=="object"&&f in u)u=u[f];else return i||n;let h=typeof u=="string"?u:i||n;return o&&typeof h=="string"&&Object.keys(o).forEach(f=>{const p=o[f],_=`{{${f}}}`;h=h.replace(new RegExp(_,"g"),String(p))}),h},language:()=>mh(),setLanguage:n=>{tw(n),typeof window<"u"&&localStorage.setItem("hrmfinance-language",n)}});var rw=z("<div><label></label><select><option value>"),nw=z("<span>*"),iw=z("<option>");const dr=t=>{const{t:e}=ot(),r={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},n={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},i={"margin-bottom":"1rem"};return(()=>{var o=rw(),a=o.firstChild,c=a.nextSibling,u=c.firstChild;return d(o,i),d(a,r),s(a,()=>t.label,null),s(a,(()=>{var h=me(()=>!!t.required);return()=>h()&&(()=>{var f=nw();return f.style.setProperty("color","var(--primary-color)"),f})()})(),null),c.addEventListener("blur",h=>h.target.style.borderColor="var(--border-color)"),c.addEventListener("focus",h=>h.target.style.borderColor="var(--primary-color)"),c.addEventListener("change",h=>t.onChange(h.target.value)),d(c,n),s(u,()=>e("forms.selectOption")),s(c,()=>t.options.map(h=>(()=>{var f=iw();return s(f,()=>h.label),ne(()=>f.value=h.value),f})()),null),ne(h=>{var f=t.required,p=t.disabled;return f!==h.e&&(c.required=h.e=f),p!==h.t&&(c.disabled=h.t=p),h},{e:void 0,t:void 0}),ne(()=>c.value=t.value),o})()};var ow=z("<div><span></span><select><option value=en>🇺🇸 </option><option value=es>🇪🇸 ");const Oy=()=>{const{t,language:e,setLanguage:r}=ot(),n={display:"flex","align-items":"center",gap:"0.5rem","margin-left":"auto"},i={padding:"0.5rem 1rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",background:"var(--surface-color)",color:"var(--text-primary)",cursor:"pointer","font-size":"0.875rem","font-weight":"500",transition:"all 0.2s ease","min-width":"120px"},o={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},a=c=>{const u=c.target;r(u.value)};return(()=>{var c=ow(),u=c.firstChild,h=u.nextSibling,f=h.firstChild;f.firstChild;var p=f.nextSibling;return p.firstChild,d(c,n),d(u,o),h.addEventListener("change",a),d(h,i),s(f,()=>t("common.english"),null),s(p,()=>t("common.spanish"),null),ne(()=>h.value=e()),c})()};var sw=z("<main><div>"),aw=z("<header><h1>");const Fr=t=>{const e={"min-height":"100vh",background:"var(--background-color)"},r={"max-width":"1200px",margin:"0 auto",padding:"2rem"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},i={"font-size":"2rem","font-weight":"700",color:"var(--text-primary)",margin:"0"};return(()=>{var o=sw(),a=o.firstChild;return d(o,e),d(a,r),s(a,(()=>{var c=me(()=>!!t.title);return()=>c()&&(()=>{var u=aw(),h=u.firstChild;return d(u,n),d(h,i),s(h,()=>t.title),s(u,S(Oy,{}),null),u})()})(),null),s(a,()=>t.children,null),o})()};var lw=z('<img alt="User avatar">'),cw=z("<div><span>"),uw=z("<button>Sign Out"),dw=z(`<nav><div><div><div></div></div><div></div></div><style>
        .nav-active {
          background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)) !important;
          color: white !important;
          box-shadow: var(--shadow-sm);
        }
        
        nav a:hover:not(.nav-active) {
          background: var(--background-color);
          color: var(--text-primary);
        }
        
        @media (max-width: 768px) {
          nav div:first-child {
            flex-direction: column;
            gap: 1rem;
            padding: 1rem;
          }
          
          nav div:last-child {
            flex-wrap: wrap;
            justify-content: center;
          }
        }
      `);const hw=()=>{const{t}=ot(),e={background:"var(--surface-color)","border-bottom":"1px solid var(--border-color)","box-shadow":"var(--shadow-sm)","backdrop-filter":"blur(10px)",position:"sticky",top:"0","z-index":"100"},r={display:"flex","align-items":"center","justify-content":"space-between",padding:"1rem 2rem",margin:"0 auto"},n={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","text-decoration":"none","margin-right":"2rem"},i={display:"flex",gap:"0.5rem","align-items":"center"},o={"text-decoration":"none",color:"var(--text-secondary)",padding:"0.5rem 1rem","border-radius":"var(--border-radius-sm)","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease","white-space":"nowrap"},a={display:"flex","align-items":"center",gap:"1rem"},c={display:"flex","align-items":"center",gap:"0.75rem",padding:"0.5rem 1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",color:"var(--text-primary)"},u={width:"32px",height:"32px","border-radius":"50%","object-fit":"cover"},h={...o,cursor:"pointer",border:"1px solid var(--border-color)",background:"transparent"},f=()=>{Ut.signOut()},p=_=>{const C=Ut.state?.profile;return C?C[_]===!0:!1};return(()=>{var _=dw(),C=_.firstChild,N=C.firstChild,E=N.firstChild,T=N.nextSibling;return d(C,r),N.style.setProperty("display","flex"),N.style.setProperty("align-items","center"),N.style.setProperty("flex","1"),s(N,S(gn,{href:"/",style:n,children:"HRM Finance"}),E),d(E,i),s(E,S(gn,{href:"/",style:o,activeClass:"nav-active",get children(){return t("navigation.dashboard")}}),null),s(E,S(Ve,{get when(){return p("AccountAccess")},get children(){return S(gn,{href:"/accounts",style:o,activeClass:"nav-active",get children(){return t("navigation.accounts")}})}}),null),s(E,S(Ve,{get when(){return p("JournalAccess")},get children(){return S(gn,{href:"/entry-books",style:o,activeClass:"nav-active",get children(){return t("navigation.entryBooks")}})}}),null),s(E,S(Ve,{get when(){return p("EmployeeAccess")},get children(){return S(gn,{href:"/employees",style:o,activeClass:"nav-active",get children(){return t("navigation.employees")}})}}),null),s(E,S(Ve,{get when(){return p("BankingAccess")},get children(){return S(gn,{href:"/bank-consolidations",style:o,activeClass:"nav-active",get children(){return t("navigation.consolidate")}})}}),null),s(E,S(Ve,{get when(){return p("AccountAccess")},get children(){return S(gn,{href:"/balance-sheet",style:o,activeClass:"nav-active",get children(){return t("navigation.balanceSheet")}})}}),null),s(E,S(Ve,{get when(){return p("InventoryAccess")},get children(){return S(gn,{href:"/inventory",style:o,activeClass:"nav-active",get children(){return t("navigation.inventory")}})}}),null),d(T,a),s(T,S(Oy,{}),null),s(T,S(Ve,{get when(){return Ut.currentUser},get children(){return[(()=>{var x=cw(),q=x.firstChild;return d(x,c),s(x,S(Ve,{get when(){return Ut.currentUser?.photoURL},get children(){var ee=lw();return ne(Y=>{var ue=Ut.currentUser.photoURL,ie=u;return ue!==Y.e&&lt(ee,"src",Y.e=ue),Y.t=d(ee,ie,Y.t),Y},{e:void 0,t:void 0}),ee}}),q),x})(),(()=>{var x=uw();return x.addEventListener("mouseleave",q=>{q.currentTarget.style.background="transparent",q.currentTarget.style.color="var(--text-secondary)"}),x.addEventListener("mouseenter",q=>{q.currentTarget.style.background="var(--background-color)",q.currentTarget.style.color="var(--text-primary)"}),x.$$click=f,ne(q=>d(x,h,q)),x})()]}}),null),ne(x=>d(_,e,x)),_})()};St(["click"]);var mw=z("<div><div><div>🔒</div><h1></h1><p>.</p><div><p><strong></strong><br></p></div><div><button></button></div><div><h3></h3><div><span>✓</span><span></span></div><div><span>✓</span><span></span></div><div><span>✓</span><span></span></div></div><div><p>"),fh=z("<br>"),fw=z("<strong>");const yw=t=>{const{t:e}=ot(),r={"min-height":"calc(100vh - 200px)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},n={"text-align":"center","max-width":"600px",width:"100%"},i={"font-size":"5rem",color:"#e53e3e","margin-bottom":"2rem"},o={"font-size":"2.5rem","font-weight":"700",color:"#1a202c","margin-bottom":"1rem"},a={"font-size":"1.25rem",color:"#718096","margin-bottom":"2rem","line-height":"1.6"},c={background:"#f7fafc",border:"1px solid #e2e8f0","border-radius":"0.5rem",padding:"1.5rem","margin-bottom":"2rem"},u={color:"#4a5568","font-size":"1rem","line-height":"1.6"},h={display:"flex",gap:"1rem","justify-content":"center","flex-wrap":"wrap"},f={padding:"0.75rem 2rem","border-radius":"0.5rem","text-decoration":"none","font-weight":"500",transition:"all 0.2s",display:"inline-block"},p={...f,background:"var(--primary-color)",color:"white",border:"2px solid var(--primary-color)"},_={...f,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},C={"text-align":"left","margin-top":"2rem",padding:"0 2rem"},N={display:"flex","align-items":"center",gap:"0.75rem","margin-bottom":"1rem",color:"#4a5568"},E={color:"#48bb78","font-size":"1.25rem"};return S(Fr,{get title(){return e("unauthorized.title")},get children(){var T=mw(),x=T.firstChild,q=x.firstChild,ee=q.nextSibling,Y=ee.nextSibling,ue=Y.firstChild,ie=Y.nextSibling,I=ie.firstChild,b=I.firstChild;b.nextSibling;var v=ie.nextSibling,P=v.firstChild,w=v.nextSibling,A=w.firstChild,y=A.nextSibling,de=y.firstChild,H=de.nextSibling,$=y.nextSibling,Z=$.firstChild,k=Z.nextSibling,F=$.nextSibling,B=F.firstChild,W=B.nextSibling,fe=w.nextSibling,K=fe.firstChild;return d(T,r),d(x,n),d(q,i),d(ee,o),s(ee,()=>e("unauthorized.accessDenied")),d(Y,a),s(Y,()=>e("unauthorized.noPermission"),ue),s(Y,(()=>{var he=me(()=>!!t.featureName);return()=>he()?` ${t.featureName}`:` ${e("unauthorized.thisFeature")}`})(),ue),d(ie,c),d(I,u),s(b,()=>e("unauthorized.whySeeing")),s(I,()=>e("unauthorized.explanation"),null),s(I,(()=>{var he=me(()=>!!t.requiredPermission);return()=>he()&&[fh(),fh(),(()=>{var D=fw();return s(D,()=>e("unauthorized.requiredPermission")),D})()," ",me(()=>t.requiredPermission)]})(),null),d(v,h),s(v,S(gn,{href:"/",style:p,get children(){return e("unauthorized.goToDashboard")}}),P),P.$$click=()=>window.history.back(),s(P,()=>e("unauthorized.goBack")),d(w,C),A.style.setProperty("margin-bottom","1rem"),A.style.setProperty("color","#2d3748"),s(A,()=>e("unauthorized.featuresCanAccess")),s(H,()=>e("unauthorized.dashboardAccess")),s(k,()=>e("unauthorized.profileAccess")),s(W,()=>e("unauthorized.roleBasedAccess")),fe.style.setProperty("margin-top","3rem"),fe.style.setProperty("padding","1.5rem"),fe.style.setProperty("background","#edf2f7"),fe.style.setProperty("border-radius","0.5rem"),K.style.setProperty("color","#4a5568"),K.style.setProperty("font-size","0.875rem"),s(K,()=>e("unauthorized.needAccess")),ne(he=>{var D=_,U=N,Q=E,J=N,ce=E,oe=N,O=E;return he.e=d(P,D,he.e),he.t=d(y,U,he.t),he.a=d(de,Q,he.a),he.o=d($,J,he.o),he.i=d(Z,ce,he.i),he.n=d(F,oe,he.n),he.s=d(B,O,he.s),he},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),T}})};St(["click"]);const mn=t=>{const{t:e}=ot(),r=()=>{if(!t.permission)return!0;const i=Ut.state?.profile;if(!i)return!1;switch(t.permission){case"AccountAccess":return i.AccountAccess===!0;case"InventoryAccess":return i.InventoryAccess===!0;case"EmployeeAccess":return i.EmployeeAccess===!0;case"BankingAccess":return i.BankingAccess===!0;case"JournalAccess":return i.JournalAccess===!0;case"AdminAccess":return i.isAdmin===!0;default:return i[t.permission]===!0}},n=()=>{if(t.requiredPermission)return t.requiredPermission;switch(t.permission){case"AccountAccess":return e("unauthorized.permissions.accountAccess");case"InventoryAccess":return e("unauthorized.permissions.inventoryAccess");case"EmployeeAccess":return e("unauthorized.permissions.employeeAccess");case"BankingAccess":return e("unauthorized.permissions.bankingAccess");case"JournalAccess":return e("unauthorized.permissions.journalAccess");case"AdminAccess":return e("unauthorized.permissions.adminAccess");default:return t.permission}};return S(Ve,{get when(){return r()},get fallback(){return t.fallback||S(yw,{get featureName(){return t.featureName},get requiredPermission(){return n()}})},get children(){return t.children}})};var gw=z('<button title="Open Dev Tools">🛠️'),pw=z("<span>(<!>)"),vw=z("<div><span></span><span>"),yh=z("<div>"),bw=z("<div>Database reset only available in fake mode"),_w=z("<div><div>Loading..."),Sw=z("<div><div><h3>🛠️ Dev Tools</h3><button>✕</button></div><div><div>API Mode</div><div><button>Fake Server</button><button>Real API</button><button>Hybrid</button></div><div>Current: <strong></strong></div></div><div><div>Health Status</div></div><div><div>Database Stats</div></div><div><div>Actions</div><div><button>🔄 Refresh Stats</button><button>💊 Health Check</button></div><div><button>🗑️ Reset DB</button></div></div><div><div>Info</div><div>• <strong>Fake Server:</strong> Uses local mock data<br>• <strong>Real API:</strong> Connects to actual backend<br>• <strong>Hybrid:</strong> Real API with fake fallback<br>• Settings are saved in localStorage"),Pw=z("<div>Loading..."),ww=z("<div><span>:</span><span>");const Cw=()=>{const[t,e]=ye(!1),[r,n]=ye(qo.getMode()),[i,o]=ye({}),[a,c]=ye(null),[u,h]=ye(!1);cn(async()=>{await f(),await p()});const f=async()=>{try{const I=await Uu.getStats();o(I)}catch(I){console.error("Failed to load stats:",I)}},p=async()=>{try{const I=await Uu.healthCheck();c(I)}catch(I){console.error("Health check failed:",I),c({status:"error",error:I.message})}},_=async I=>{h(!0);try{qo.setMode(I),n(I),await f(),await p()}catch(b){console.error("Failed to change API mode:",b)}finally{h(!1)}},C=async()=>{if(confirm("Are you sure you want to reset the fake database to its initial state?")){h(!0);try{const I=await $r.utils.resetDatabase();alert(I.message),await f()}catch(I){console.error("Failed to reset database:",I),alert("Failed to reset database")}finally{h(!1)}}},N={position:"fixed",bottom:"20px",right:"20px","z-index":"10000","font-family":"monospace"},E={background:"#1a1a1a",color:"#fff",border:"1px solid #333","border-radius":"8px",padding:"16px","min-width":"300px","max-width":"400px","box-shadow":"0 4px 20px rgba(0,0,0,0.3)"},T={background:"#007acc",color:"#fff",border:"none","border-radius":"50%",width:"50px",height:"50px",cursor:"pointer","font-size":"20px","box-shadow":"0 2px 10px rgba(0,0,0,0.2)",display:"flex","align-items":"center","justify-content":"center"},x={background:"#333",color:"#fff",border:"1px solid #555","border-radius":"4px",padding:"6px 12px",cursor:"pointer","font-size":"12px","margin-right":"8px","margin-bottom":"8px"},q={...x,background:"#007acc","border-color":"#007acc"},ee={"margin-bottom":"16px","padding-bottom":"12px","border-bottom":"1px solid #333"},Y={"font-size":"14px","font-weight":"bold","margin-bottom":"8px",color:"#007acc"},ue={display:"flex","justify-content":"space-between","font-size":"12px","margin-bottom":"4px"},ie=I=>({display:"inline-block",width:"8px",height:"8px","border-radius":"50%","margin-right":"8px",background:I==="healthy"?"#00ff00":I==="error"?"#ff0000":"#ffff00"});return(()=>{var I=yh();return s(I,S(Ve,{get when(){return!t()},get children(){var b=gw();return b.$$click=()=>e(!0),d(b,T),b}}),null),s(I,S(Ve,{get when(){return t()},get children(){var b=Sw(),v=b.firstChild,P=v.firstChild,w=P.nextSibling,A=v.nextSibling,y=A.firstChild,de=y.nextSibling,H=de.firstChild,$=H.nextSibling,Z=$.nextSibling,k=de.nextSibling,F=k.firstChild,B=F.nextSibling,W=A.nextSibling,fe=W.firstChild,K=W.nextSibling,he=K.firstChild,D=K.nextSibling,U=D.firstChild,Q=U.nextSibling,J=Q.firstChild,ce=J.nextSibling,oe=Q.nextSibling,O=oe.firstChild,re=D.nextSibling,pe=re.firstChild,ve=pe.nextSibling;return d(b,E),v.style.setProperty("display","flex"),v.style.setProperty("justify-content","space-between"),v.style.setProperty("align-items","center"),v.style.setProperty("margin-bottom","16px"),P.style.setProperty("margin","0"),P.style.setProperty("color","#007acc"),P.style.setProperty("font-size","16px"),w.$$click=()=>e(!1),H.$$click=()=>_("fake"),$.$$click=()=>_("real"),Z.$$click=()=>_("hybrid"),k.style.setProperty("font-size","11px"),k.style.setProperty("color","#888"),k.style.setProperty("margin-top","4px"),s(B,r),s(k,()=>r()==="fake"&&" (Using fake server)",null),s(k,()=>r()==="real"&&" (Using real API)",null),s(k,()=>r()==="hybrid"&&" (Real API with fallback)",null),s(W,S(Ve,{get when(){return a()},get fallback(){return(()=>{var te=Pw();return te.style.setProperty("font-size","12px"),te})()},get children(){return[(()=>{var te=vw(),se=te.firstChild,R=se.nextSibling;return te.style.setProperty("display","flex"),te.style.setProperty("align-items","center"),te.style.setProperty("font-size","12px"),s(R,()=>a()?.status||"Unknown"),s(te,S(Ve,{get when(){return a()?.timestamp},get children(){var M=pw(),V=M.firstChild,ge=V.nextSibling;return ge.nextSibling,M.style.setProperty("margin-left","8px"),M.style.setProperty("color","#888"),s(M,()=>new Date(a().timestamp).toLocaleTimeString(),ge),M}}),null),ne(M=>d(se,ie(a()?.status||"unknown"),M)),te})(),S(Ve,{get when(){return a()?.error},get children(){var te=yh();return te.style.setProperty("font-size","11px"),te.style.setProperty("color","#ff6666"),te.style.setProperty("margin-top","4px"),s(te,()=>a().error),te}})]}}),null),s(K,S(Mt,{get each(){return Object.entries(i())},children:([te,se])=>(()=>{var R=ww(),M=R.firstChild,V=M.firstChild,ge=M.nextSibling;return d(R,ue),M.style.setProperty("text-transform","capitalize"),s(M,te,V),ge.style.setProperty("color","#00ff00"),s(ge,se),R})()}),null),J.$$click=f,ce.$$click=p,oe.style.setProperty("margin-top","8px"),O.$$click=C,s(D,S(Ve,{get when(){return r()!=="fake"},get children(){var te=bw();return te.style.setProperty("font-size","11px"),te.style.setProperty("color","#888"),te.style.setProperty("margin-top","4px"),te}}),null),ve.style.setProperty("font-size","11px"),ve.style.setProperty("color","#888"),ve.style.setProperty("line-height","1.4"),s(b,S(Ve,{get when(){return u()},get children(){var te=_w(),se=te.firstChild;return te.style.setProperty("position","absolute"),te.style.setProperty("top","0"),te.style.setProperty("left","0"),te.style.setProperty("right","0"),te.style.setProperty("bottom","0"),te.style.setProperty("background","rgba(0,0,0,0.7)"),te.style.setProperty("display","flex"),te.style.setProperty("align-items","center"),te.style.setProperty("justify-content","center"),te.style.setProperty("border-radius","8px"),se.style.setProperty("color","#fff"),se.style.setProperty("font-size","14px"),te}}),null),ne(te=>{var se={...x,padding:"4px 8px"},R=ee,M=Y,V=r()==="fake"?q:x,ge=u(),le=r()==="real"?q:x,j=u(),G=r()==="hybrid"?q:x,Pe=u(),_e=ee,ae=Y,be=ee,X=Y,Ce=ee,$e=Y,Ee=x,xe=u(),Oe=x,He=u(),je={...x,background:"#cc4400","border-color":"#cc4400"},Ie=u()||r()!=="fake",Be=Y;return te.e=d(w,se,te.e),te.t=d(A,R,te.t),te.a=d(y,M,te.a),te.o=d(H,V,te.o),ge!==te.i&&(H.disabled=te.i=ge),te.n=d($,le,te.n),j!==te.s&&($.disabled=te.s=j),te.h=d(Z,G,te.h),Pe!==te.r&&(Z.disabled=te.r=Pe),te.d=d(W,_e,te.d),te.l=d(fe,ae,te.l),te.u=d(K,be,te.u),te.c=d(he,X,te.c),te.w=d(D,Ce,te.w),te.m=d(U,$e,te.m),te.f=d(J,Ee,te.f),xe!==te.y&&(J.disabled=te.y=xe),te.g=d(ce,Oe,te.g),He!==te.p&&(ce.disabled=te.p=He),te.b=d(O,je,te.b),Ie!==te.T&&(O.disabled=te.T=Ie),te.A=d(pe,Be,te.A),te},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),b}}),null),ne(b=>d(I,N,b)),I})()};St(["click"]);var Aw=z("<div>$124,350"),Iw=z("<div>+12% from last month"),Ew=z("<div>247"),Li=z("<div>"),xw=z("<div>18"),Tw=z("<div>$89,250"),$w=z("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const kw=()=>{const{t}=ot(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},n={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)",margin:"0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"};return S(Fr,{get title(){return t("dashboard.title")},get children(){return[(()=>{var o=Li();return d(o,e),s(o,S(Qe,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var a=Aw();return ne(c=>d(a,n,c)),a})(),(()=>{var a=Iw();return ne(c=>d(a,i,c)),a})()]}}),null),s(o,S(Qe,{get title(){return t("dashboard.employeeCount")},get subtitle(){return t("dashboard.current")},get children(){return[(()=>{var a=Ew();return ne(c=>d(a,n,c)),a})(),(()=>{var a=Li();return s(a,()=>t("dashboard.newHires")),ne(c=>d(a,i,c)),a})()]}}),null),s(o,S(Qe,{get title(){return t("dashboard.pendingInvoices")},get subtitle(){return t("dashboard.outstanding")},get children(){return[(()=>{var a=xw();return ne(c=>d(a,n,c)),a})(),(()=>{var a=Li();return s(a,()=>t("dashboard.totalOutstanding")),ne(c=>d(a,i,c)),a})()]}}),null),s(o,S(Qe,{get title(){return t("dashboard.cashBalance")},get subtitle(){return t("accounts.title")},get children(){return[(()=>{var a=Tw();return ne(c=>d(a,n,c)),a})(),(()=>{var a=Li();return s(a,()=>t("dashboard.lastUpdatedToday")),ne(c=>d(a,i,c)),a})()]}}),null),o})(),(()=>{var o=Li();return d(o,r),s(o,S(Qe,{get title(){return t("dashboard.quickActions")},get subtitle(){return t("dashboard.commonTasks")},get children(){var a=Li();return a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("gap","1rem"),s(a,S(De,{variant:"primary",get children(){return t("invoices.createNew")}}),null),s(a,S(De,{variant:"secondary",get children(){return t("employees.addEmployee")}}),null),s(a,S(De,{variant:"outline",get children(){return t("dashboard.generateReport")}}),null),a}}),null),s(o,S(Qe,{get title(){return t("dashboard.recentActivity")},get subtitle(){return t("dashboard.latestUpdates")},get children(){var a=$w(),c=a.firstChild,u=c.firstChild,h=u.nextSibling,f=c.nextSibling,p=f.firstChild,_=p.nextSibling,C=f.nextSibling,N=C.firstChild,E=N.nextSibling;return a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("gap","0.75rem"),c.style.setProperty("border-bottom","1px solid var(--border-color)"),c.style.setProperty("padding-bottom","0.5rem"),u.style.setProperty("font-weight","500"),s(u,()=>t("dashboard.invoicePaid")),h.style.setProperty("font-size","0.875rem"),h.style.setProperty("color","var(--text-muted)"),s(h,()=>t("dashboard.hoursAgo")),f.style.setProperty("border-bottom","1px solid var(--border-color)"),f.style.setProperty("padding-bottom","0.5rem"),p.style.setProperty("font-weight","500"),s(p,()=>t("dashboard.newEmployeeOnboarded")),_.style.setProperty("font-size","0.875rem"),_.style.setProperty("color","var(--text-muted)"),s(_,()=>t("dashboard.dayAgo")),N.style.setProperty("font-weight","500"),s(N,()=>t("dashboard.monthlyReportGenerated")),E.style.setProperty("font-size","0.875rem"),E.style.setProperty("color","var(--text-muted)"),s(E,()=>t("dashboard.daysAgo")),a}}),null),o})()]}})},Rw=[{id:"1",accountNumber:"1000",name:"Cash and Cash Equivalents",type:"Asset",category:"Current Assets",description:"Cash on hand and in bank accounts",balance:45230.5,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1001",accountNumber:"1001",name:"Petty Cash",type:"Asset",category:"Current Assets",description:"Small amounts of cash for minor expenses",balance:500,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1002",accountNumber:"1002",name:"Bank - Checking Account",type:"Asset",category:"Current Assets",description:"Main operating checking account",balance:32730.5,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1003",accountNumber:"1003",name:"Bank - Savings Account",type:"Asset",category:"Current Assets",description:"Interest-bearing savings account",balance:12e3,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"2",accountNumber:"1100",name:"Accounts Receivable",type:"Asset",category:"Current Assets",description:"Money owed by customers",balance:23450.75,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2001",accountNumber:"1101",name:"Trade Receivables",type:"Asset",category:"Current Assets",description:"Receivables from regular customers",balance:18450.75,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2002",accountNumber:"1102",name:"Employee Advances",type:"Asset",category:"Current Assets",description:"Money advanced to employees",balance:5e3,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"3",accountNumber:"1200",name:"Inventory",type:"Asset",category:"Current Assets",description:"Products held for sale",balance:78920.25,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-13"},{id:"4",accountNumber:"1500",name:"Equipment",type:"Asset",category:"Fixed Assets",description:"Office equipment and machinery",balance:125e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-12"},{id:"5",accountNumber:"2000",name:"Accounts Payable",type:"Liability",category:"Current Liabilities",description:"Money owed to suppliers",balance:15670.3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-11"},{id:"6",accountNumber:"2100",name:"Accrued Expenses",type:"Liability",category:"Current Liabilities",description:"Expenses incurred but not yet paid",balance:8945.6,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-10"},{id:"7",accountNumber:"2500",name:"Long-term Debt",type:"Liability",category:"Long-term Liabilities",description:"Long-term loans and mortgages",balance:85e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-09"},{id:"8",accountNumber:"3000",name:"Owner's Equity",type:"Equity",category:"Owner's Equity",description:"Owner's investment in the business",balance:15e4,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-08"},{id:"9",accountNumber:"3100",name:"Retained Earnings",type:"Equity",category:"Owner's Equity",description:"Accumulated profits retained in business",balance:32450.8,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-07"},{id:"10",accountNumber:"4000",name:"Sales Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from product sales",balance:245678.9,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-06"},{id:"11",accountNumber:"4100",name:"Service Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from services provided",balance:89432.15,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-05"},{id:"12",accountNumber:"5000",name:"Cost of Goods Sold",type:"Expense",category:"Operating Expenses",description:"Direct costs of producing goods",balance:125678.45,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-04"},{id:"13",accountNumber:"5100",name:"Salaries Expense",type:"Expense",category:"Operating Expenses",description:"Employee salary expenses",balance:98765.32,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-03"},{id:"14",accountNumber:"5200",name:"Rent Expense",type:"Expense",category:"Operating Expenses",description:"Office rent expenses",balance:24e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-02"}],Dw=[{id:"1",accountId:"1",date:"2024-01-15",description:"Customer payment received",debitAmount:5e3,creditAmount:0,reference:"INV-2024-001",type:"debit"},{id:"2",accountId:"2",date:"2024-01-15",description:"Customer payment received",debitAmount:0,creditAmount:5e3,reference:"INV-2024-001",type:"credit"},{id:"3",accountId:"5",date:"2024-01-14",description:"Office supplies purchased",debitAmount:0,creditAmount:1250,reference:"PO-2024-001",type:"credit"}],[Jr,ks]=ye(Rw),[hl,Nw]=ye(Dw),ut={get accounts(){return Jr()},get transactions(){return hl()},fetchAllAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return ks([...Jr(),e]),e},addAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return ks([...Jr(),e]),e},updateAccount(t,e){ks(Jr().map(r=>r.id===t?{...r,...e,lastModified:new Date().toISOString().split("T")[0]}:r))},deleteAccount(t){ks(Jr().filter(e=>e.id!==t))},getAccountById(t){return Jr().find(e=>e.id===t)},getAccountsByType(t){return Jr().filter(e=>e.type===t)},getAccountTransactions(t){return hl().filter(e=>e.accountId===t)},addTransaction(t){const e={...t,id:Date.now().toString()};Nw([...hl(),e]);const r=this.getAccountById(t.accountId);if(r){const n=t.type==="debit"?t.debitAmount:-t.creditAmount;this.updateAccount(t.accountId,{balance:r.balance+n})}return e},getTotalByType(t){return Jr().filter(e=>e.type===t&&e.isActive).reduce((e,r)=>e+r.balance,0)},getAccountCategories(t){const e=this.getAccountsByType(t);return[...new Set(e.map(r=>r.category))]},getSubAccounts(t){return Jr().filter(e=>e.parentAccountId===t)},getParentAccounts(){return Jr().filter(t=>!t.parentAccountId)},getAccountHierarchy(){return this.getParentAccounts().map(e=>({...e,subAccounts:this.getSubAccounts(e.id)}))},getAccountWithSubAccounts(t){const e=this.getAccountById(t);return e?{...e,subAccounts:this.getSubAccounts(t),parentAccount:e.parentAccountId?this.getAccountById(e.parentAccountId):null}:null},getAccountPath(t){const e=this.getAccountById(t);if(!e)return[];const r=[e];let n=e;for(;n.parentAccountId;){const i=this.getAccountById(n.parentAccountId);if(i)r.unshift(i),n=i;else break}return r},getTotalBalanceWithSubAccounts(t){const e=this.getAccountById(t);if(!e)return 0;const n=this.getSubAccounts(t).reduce((i,o)=>i+this.getTotalBalanceWithSubAccounts(o.id),0);return e.balance+n},canDeleteAccount(t){const e=this.getSubAccounts(t);if(e.length>0)return{canDelete:!1,reason:`Account has ${e.length} sub-account(s). Delete or move sub-accounts first.`};const r=this.getAccountTransactions(t);return r.length>0?{canDelete:!1,reason:`Account has ${r.length} transaction(s). Cannot delete account with transaction history.`}:{canDelete:!0}}};var Rn=z("<div>"),_o=z("<div> ");const Lw=()=>{const{t}=ot(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},n={"font-size":"0.875rem",color:"var(--text-muted)"},i=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E),o=ut.getTotalByType("Asset"),a=ut.getTotalByType("Liability"),c=ut.getTotalByType("Equity"),u=ut.getTotalByType("Revenue"),h=ut.getTotalByType("Expense"),f=ut.getAccountsByType("Asset").length,p=ut.getAccountsByType("Liability").length,_=ut.getAccountsByType("Equity").length,C=ut.getAccountsByType("Revenue").length,N=ut.getAccountsByType("Expense").length;return(()=>{var E=Rn();return d(E,e),s(E,S(Qe,{get title(){return t("dashboard.totalAssets")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var T=Rn();return s(T,()=>i(o)),ne(x=>d(T,r,x)),T})(),(()=>{var T=_o(),x=T.firstChild;return s(T,f,x),s(T,()=>t("navigation.accounts"),null),ne(q=>d(T,n,q)),T})()]}}),null),s(E,S(Qe,{get title(){return t("dashboard.totalLiabilities")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var T=Rn();return s(T,()=>i(a)),ne(x=>d(T,r,x)),T})(),(()=>{var T=_o(),x=T.firstChild;return s(T,p,x),s(T,()=>t("navigation.accounts"),null),ne(q=>d(T,n,q)),T})()]}}),null),s(E,S(Qe,{get title(){return t("dashboard.totalEquity")},get subtitle(){return t("accounts.categories.ownersEquity")},get children(){return[(()=>{var T=Rn();return s(T,()=>i(c)),ne(x=>d(T,r,x)),T})(),(()=>{var T=_o(),x=T.firstChild;return s(T,_,x),s(T,()=>t("navigation.accounts"),null),ne(q=>d(T,n,q)),T})()]}}),null),s(E,S(Qe,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("accounts.categories.operatingRevenue")},get children(){return[(()=>{var T=Rn();return s(T,()=>i(u)),ne(x=>d(T,r,x)),T})(),(()=>{var T=_o(),x=T.firstChild;return s(T,C,x),s(T,()=>t("navigation.accounts"),null),ne(q=>d(T,n,q)),T})()]}}),null),s(E,S(Qe,{get title(){return t("dashboard.totalExpenses")},get subtitle(){return t("accounts.categories.operatingExpenses")},get children(){return[(()=>{var T=Rn();return s(T,()=>i(h)),ne(x=>d(T,r,x)),T})(),(()=>{var T=_o(),x=T.firstChild;return s(T,N,x),s(T,()=>t("navigation.accounts"),null),ne(q=>d(T,n,q)),T})()]}}),null),s(E,S(Qe,{get title(){return t("dashboard.netIncome")},get subtitle(){return`${t("dashboard.totalRevenue")} - ${t("dashboard.totalExpenses")}`},get children(){return[(()=>{var T=Rn();return s(T,()=>i(u-h)),ne(x=>d(T,{...r,color:u-h>=0?"#4caf50":"#f44336"},x)),T})(),(()=>{var T=Rn();return s(T,()=>u-h>=0?t("dashboard.netIncome"):t("dashboard.netLoss")),ne(x=>d(T,n,x)),T})()]}}),null),E})()};var Mw=z("<div><div></div><div>"),Ow=z("<h3>"),So=z("<div>");const Vw=t=>{const{t:e}=ot();fc();const r={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},i={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"},o={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},a={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},c={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem"},u={"font-size":"0.875rem",color:"var(--text-secondary)","line-height":"1.4"},h=_=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[_]||{bg:"#f5f5f5",color:"#666"},f=_=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(_),p=h(t.account.type);return S(Qe,{get children(){return[(()=>{var _=Mw(),C=_.firstChild,N=C.nextSibling;return d(_,n),d(C,i),s(C,()=>t.account.accountNumber),s(N,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),ne(E=>d(N,{...o,background:p.bg,color:p.color},E)),_})(),(()=>{var _=Ow();return _.style.setProperty("margin","0 0 0.5rem 0"),_.style.setProperty("font-size","1.1rem"),s(_,()=>t.account.name),_})(),(()=>{var _=So();return d(_,c),s(_,()=>t.account.category),_})(),(()=>{var _=So();return d(_,a),s(_,()=>f(t.account.balance)),_})(),(()=>{var _=So();return d(_,u),s(_,()=>t.account.description),_})(),me(()=>me(()=>!t.account.isActive)()&&(()=>{var _=So();return _.style.setProperty("margin-top","0.5rem"),_.style.setProperty("padding","0.25rem 0.75rem"),_.style.setProperty("border-radius","9999px"),_.style.setProperty("font-size","0.75rem"),_.style.setProperty("font-weight","500"),_.style.setProperty("background","#ffebee"),_.style.setProperty("color","#d32f2f"),_.style.setProperty("text-align","center"),s(_,()=>e("common.inactive")),_})()),(()=>{var _=So();return d(_,r),s(_,S(De,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.account),get children(){return[me(()=>e("common.view"))," ",me(()=>e("accounts.accountDetails"))]}})),_})()]}})};var Bw=z("<div><div><div><div></div><h3></h3></div></div><div><div></div><div>"),Fw=z("<div>"),Uw=z("<button>"),jw=z("<div><h4> (<!>)"),zw=z("<div><div><div></div><div> • </div></div><div>");const qw=t=>{const{t:e}=ot(),r=fc(),[n,i]=ye(!0),o={"margin-bottom":"1rem"},a={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},c={display:"flex","align-items":"center",gap:"1rem"},u={background:"none",border:"none",cursor:"pointer","font-size":"1.2rem",color:"var(--text-muted)",padding:"0.25rem","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease"},h={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},f={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},p={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},_={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},C={"margin-left":"1rem","border-left":"2px solid var(--border-color)","padding-left":"1rem","margin-top":"1rem"},N={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem","margin-bottom":"0.5rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},E={flex:"1"},T={"font-weight":"500","margin-bottom":"0.25rem"},x={"font-size":"0.875rem",color:"var(--text-muted)"},q={"font-weight":"600",color:"var(--primary-color)"},ee={display:"flex",gap:"0.5rem"},Y=P=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[P]||{bg:"#f5f5f5",color:"#666"},ue=P=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(P),ie=P=>{t.onViewDetails?t.onViewDetails(P):r(`/accounts/${P.id}`)},I=()=>{t.onAddSubAccount&&t.onAddSubAccount(t.account)},b=t.account.balance+t.account.subAccounts.reduce((P,w)=>P+w.balance,0),v=Y(t.account.type);return S(Qe,{className:"account-hierarchy-card",style:o,get children(){return[(()=>{var P=Bw(),w=P.firstChild,A=w.firstChild,y=A.firstChild,de=y.nextSibling,H=w.nextSibling,$=H.firstChild,Z=$.nextSibling;return d(P,a),d(w,c),s(w,(()=>{var k=me(()=>t.account.subAccounts.length>0);return()=>k()&&(()=>{var F=Uw();return F.addEventListener("mouseleave",B=>B.target.style.background="none"),F.addEventListener("mouseenter",B=>B.target.style.background="var(--background-color)"),F.$$click=()=>i(!n()),d(F,u),s(F,()=>n()?"▼":"▶"),F})()})(),A),A.$$click=()=>ie(t.account),A.style.setProperty("cursor","pointer"),d(y,h),s(y,()=>t.account.accountNumber),d(de,f),s(de,()=>t.account.name),H.style.setProperty("text-align","right"),d($,p),s($,()=>ue(b)),s(Z,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),ne(k=>d(Z,{..._,background:v.bg,color:v.color},k)),P})(),(()=>{var P=Fw();return d(P,ee),s(P,S(De,{variant:"secondary",size:"sm",onClick:()=>ie(t.account),get children(){return[me(()=>e("common.view"))," ",me(()=>e("accounts.accountDetails"))]}}),null),s(P,S(De,{variant:"outline",size:"sm",onClick:I,get children(){return[me(()=>e("common.add"))," ",me(()=>e("accounts.subAccounts"))]}}),null),P})(),me(()=>me(()=>!!(n()&&t.account.subAccounts.length>0))()&&(()=>{var P=jw(),w=P.firstChild,A=w.firstChild,y=A.nextSibling;return y.nextSibling,d(P,C),w.style.setProperty("margin","0 0 1rem 0"),w.style.setProperty("font-size","1rem"),w.style.setProperty("color","var(--text-muted)"),s(w,()=>e("accounts.subAccounts"),A),s(w,()=>t.account.subAccounts.length,y),s(P,()=>t.account.subAccounts.map(de=>(()=>{var H=zw(),$=H.firstChild,Z=$.firstChild,k=Z.nextSibling,F=k.firstChild,B=$.nextSibling;return H.addEventListener("mouseleave",W=>{W.currentTarget.style.background="var(--background-color)",W.currentTarget.style.transform="translateY(0)"}),H.addEventListener("mouseenter",W=>{W.currentTarget.style.background="var(--surface-color)",W.currentTarget.style.transform="translateY(-1px)"}),H.$$click=()=>ie(de),d(H,N),d($,E),d(Z,T),s(Z,()=>de.name),d(k,x),s(k,()=>de.accountNumber,F),s(k,()=>de.description,null),d(B,q),s(B,()=>ue(de.balance)),H})()),null),P})())]}})};St(["click"]);var Hw=z("<form><div>");const Ww=t=>{const{t:e}=ot(),[r,n]=ye({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),i=[{value:"Asset",label:e("accounts.types.asset"),type:"debit",classification:"real"},{value:"Liability",label:e("accounts.types.liability"),type:"credit",classification:"real"},{value:"Equity",label:e("accounts.types.equity"),type:"credit",classification:"real"},{value:"Revenue",label:e("accounts.types.revenue"),type:"credit",classification:"nominal"},{value:"Expense",label:e("accounts.types.expense"),type:"debit",classification:"nominal"}],o=()=>{const f=r().type;return f?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")},{value:"Sales Revenue",label:e("accounts.categories.salesRevenue")},{value:"Service Revenue",label:e("accounts.categories.servicesRevenue")},{value:"Subscription Revenue",label:e("accounts.categories.subscriptionRevenue")},{value:"Rental Revenue",label:e("accounts.categories.rentalRevenue")},{value:"Commission Revenue",label:e("accounts.categories.commissionRevenue")},{value:"Franchise Revenue",label:e("accounts.categories.franchiseRevenue")},{value:"Licensing Revenue",label:e("accounts.categories.licensingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[f]||[]:[]},a=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],c={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},u=f=>{f.preventDefault();const p=r();if(!p.accountNumber||!p.name||!p.type||!p.category){alert(e("forms.requiredField"));return}if(ut.accounts.find(N=>N.accountNumber===p.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const C={accountNumber:p.accountNumber,name:p.name,type:p.type,category:p.category,description:p.description,balance:parseFloat(p.balance)||0,isActive:p.isActive==="true"};ut.addAccount(C),n({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},h=(f,p)=>{n(_=>{const C={..._,[f]:p};return f==="type"&&(C.category=""),C})};return S(mr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.addAccount")},get children(){var f=Hw(),p=f.firstChild;return f.addEventListener("submit",u),s(f,S(_t,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:_=>h("accountNumber",_),get placeholder(){return e("accounts.accountNumber")},required:!0}),p),s(f,S(_t,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:_=>h("name",_),get placeholder(){return e("accounts.accountName")},required:!0}),p),s(f,S(dr,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:_=>h("type",_),options:i,required:!0}),p),s(f,S(dr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:_=>h("category",_),get options(){return o()},required:!0}),p),s(f,S(_t,{get label(){return e("common.description")},get value(){return r().description},onChange:_=>h("description",_),get placeholder(){return e("common.description")}}),p),s(f,S(_t,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:_=>h("balance",_),get placeholder(){return e("accounts.balance")}}),p),s(f,S(dr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:_=>h("isActive",_),options:a,required:!0}),p),d(p,c),s(p,S(De,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(p,S(De,{variant:"primary",type:"submit",get children(){return e("accounts.addAccount")}}),null),f}})};var Gw=z("<form><div>"),Kw=z("<div><div></div><div> - </div><div> • ");const Yw=t=>{const{t:e}=ot(),[r,n]=ye({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),i=()=>t.parentAccount?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[t.parentAccount.type]||[]:[],o=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],a={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},c={background:"var(--background-color)",padding:"1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1.5rem",border:"1px solid var(--border-color)"},u={"font-size":"0.875rem","font-weight":"500",color:"var(--text-muted)","margin-bottom":"0.5rem"},h={"font-weight":"600",color:"var(--text-primary)"},f={"font-size":"0.875rem",color:"var(--text-secondary)"},p=E=>{E.preventDefault();const T=r();if(!T.accountNumber||!T.name||!T.category||!t.parentAccount){alert(e("forms.requiredField"));return}if(ut.accounts.find(ee=>ee.accountNumber===T.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const q={accountNumber:T.accountNumber,name:T.name,type:t.parentAccount.type,category:T.category,description:T.description,balance:parseFloat(T.balance)||0,isActive:T.isActive==="true",parentAccountId:t.parentAccount.id};ut.addAccount(q),n({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},_=(E,T)=>{n(x=>({...x,[E]:T}))},C=()=>{if(!t.parentAccount)return"";const E=t.parentAccount.accountNumber,x=ut.getSubAccounts(t.parentAccount.id).length+1;return(parseInt(E)+x).toString()},N=()=>r().accountNumber===""&&t.parentAccount?C():r().accountNumber;return S(mr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return`${e("common.add")} ${e("accounts.subAccounts")}`},get children(){return[me(()=>me(()=>!!t.parentAccount)()&&(()=>{var E=Kw(),T=E.firstChild,x=T.nextSibling,q=x.firstChild,ee=x.nextSibling,Y=ee.firstChild;return d(E,c),d(T,u),s(T,()=>e("accounts.parentAccount")),d(x,h),s(x,()=>t.parentAccount.accountNumber,q),s(x,()=>t.parentAccount.name,null),d(ee,f),s(ee,()=>e(`accounts.types.${t.parentAccount.type.toLowerCase()}`),Y),s(ee,()=>t.parentAccount.category,null),E})()),(()=>{var E=Gw(),T=E.firstChild;return E.addEventListener("submit",p),s(E,S(_t,{get label(){return e("accounts.accountNumber")},get value(){return N()},onChange:x=>_("accountNumber",x),get placeholder(){return`${e("common.suggested")}: ${C()}`},required:!0}),T),s(E,S(_t,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:x=>_("name",x),get placeholder(){return e("accounts.accountName")},required:!0}),T),s(E,S(dr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:x=>_("category",x),get options(){return i()},required:!0}),T),s(E,S(_t,{get label(){return e("common.description")},get value(){return r().description},onChange:x=>_("description",x),get placeholder(){return e("common.description")}}),T),s(E,S(_t,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:x=>_("balance",x),get placeholder(){return e("accounts.balance")}}),T),s(E,S(dr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:x=>_("isActive",x),options:o,required:!0}),T),d(T,a),s(T,S(De,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(T,S(De,{variant:"primary",type:"submit",get children(){return[me(()=>e("common.add"))," ",me(()=>e("accounts.subAccounts"))]}}),null),E})()]}})};var Qw=z("<form><div>"),Jw=z("<div>");const Xw=t=>{const{t:e}=ot(),[r,n]=ye({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),[i,o]=ye(null);ei(()=>{t.account&&(n({accountNumber:t.account.accountNumber,name:t.account.name,type:t.account.type,category:t.account.category,description:t.account.description,balance:t.account.balance.toString(),isActive:t.account.isActive.toString()}),o(null))});const a=[{value:"Asset",label:e("accounts.types.asset")},{value:"Liability",label:e("accounts.types.liability")},{value:"Equity",label:e("accounts.types.equity")},{value:"Revenue",label:e("accounts.types.revenue")},{value:"Expense",label:e("accounts.types.expense")}],c=()=>{const C=r().type;return C?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[C]||[]:[]},u=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},f=C=>{if(C.preventDefault(),o(null),!t.account)return;const N=r();if(!N.accountNumber||!N.name||!N.type||!N.category){o(e("forms.requiredField"));return}if(ut.accounts.find(x=>x.accountNumber===N.accountNumber&&x.id!==t.account.id)){o(e("forms.duplicateAccountNumber"));return}const T={accountNumber:N.accountNumber,name:N.name,type:N.type,category:N.category,description:N.description,balance:parseFloat(N.balance)||0,isActive:N.isActive==="true"};try{ut.updateAccount(t.account.id,T),t.onClose()}catch(x){o(x instanceof Error?x.message:e("forms.saveError"))}},p=()=>{if(!t.account)return;const C=ut.canDeleteAccount(t.account.id);if(!C.canDelete){o(C.reason||e("forms.deleteError"));return}const N=e("forms.confirmDelete");if(confirm(N))try{ut.deleteAccount(t.account.id),t.onClose()}catch(E){o(E instanceof Error?E.message:e("forms.deleteError"))}},_=(C,N)=>{n(E=>{const T={...E,[C]:N};return C==="type"&&(T.category=""),T}),i()&&o(null)};return t.account?S(mr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.editAccount")},get children(){var C=Qw(),N=C.firstChild;return C.addEventListener("submit",f),s(C,S(_t,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:E=>_("accountNumber",E),get placeholder(){return e("accounts.accountNumber")},required:!0}),N),s(C,S(_t,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:E=>_("name",E),get placeholder(){return e("accounts.accountName")},required:!0}),N),s(C,S(dr,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:E=>_("type",E),options:a,required:!0}),N),s(C,S(dr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:E=>_("category",E),get options(){return c()},required:!0}),N),s(C,S(_t,{get label(){return e("common.description")},get value(){return r().description},onChange:E=>_("description",E),get placeholder(){return e("common.description")}}),N),s(C,S(_t,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:E=>_("balance",E),get placeholder(){return e("accounts.balance")}}),N),s(C,S(dr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:E=>_("isActive",E),options:u,required:!0}),N),s(C,(()=>{var E=me(()=>!!i());return()=>E()&&(()=>{var T=Jw();return T.style.setProperty("padding","1rem"),T.style.setProperty("border-radius","var(--border-radius-sm)"),T.style.setProperty("margin-top","1rem"),T.style.setProperty("background","#f8d7da"),T.style.setProperty("color","#721c24"),T.style.setProperty("border","1px solid #f5c6cb"),s(T,i),T})()})(),N),d(N,h),s(N,S(De,{variant:"outline",type:"button",onClick:p,style:{color:"#dc3545","border-color":"#dc3545","margin-right":"auto"},get children(){return e("accounts.deleteAccount")}}),null),s(N,S(De,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(N,S(De,{variant:"primary",type:"submit",get children(){return e("common.save")}}),null),C}}):null};var Zw=z("<div><div>⚠️</div><div></div><div></div><div>"),eC=z("<div><div></div><div></div><div>"),tC=z("<div><button></button><button> (<!>)"),ml=z("<div>"),rC=z("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),nC=z("<div><div><div></div><div> • </div></div><div>");const iC=t=>{const{t:e}=ot(),[r,n]=ye("details"),[i,o]=ye(!1),a=qe(()=>t.account?ut.getAccountById(t.account.id)||t.account:null),c={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},u={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},h={"font-weight":"600",color:"var(--text-primary)"},f={"text-align":"center","margin-bottom":"2rem"},p={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},_={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},C={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem"},N={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},E=v=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:v?"var(--primary-color)":"var(--text-muted)","border-bottom":v?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),T={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},x={flex:"1"},q={"font-size":"0.875rem",color:"var(--text-muted)"},ee={"font-weight":"500","margin-bottom":"0.25rem"},Y=v=>({"font-weight":"600",color:v==="debit"?"#4caf50":"#f44336"}),ue={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ie=v=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[v]||{bg:"#f5f5f5",color:"#666"},I=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(v),b=v=>new Date(v).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return S(mr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.accountDetails")},get children(){return[me(()=>me(()=>!a())()?(()=>{var v=Zw(),P=v.firstChild,w=P.nextSibling,A=w.nextSibling,y=A.nextSibling;return v.style.setProperty("text-align","center"),v.style.setProperty("padding","3rem"),v.style.setProperty("color","var(--text-muted)"),P.style.setProperty("font-size","1.5rem"),P.style.setProperty("margin-bottom","1rem"),w.style.setProperty("font-size","1.1rem"),w.style.setProperty("margin-bottom","0.5rem"),s(w,()=>e("common.error")),A.style.setProperty("font-size","0.875rem"),s(A,()=>e("common.noDataFound")),y.style.setProperty("margin-top","2rem"),s(y,S(De,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),v})():(()=>{const v=qe(()=>ie(a().type)),P=qe(()=>ut.getAccountTransactions(a().id));return[(()=>{var w=eC(),A=w.firstChild,y=A.nextSibling,de=y.nextSibling;return d(w,f),d(A,p),s(A,()=>a().name),d(y,_),s(y,()=>I(a().balance)),s(de,()=>e(`accounts.types.${a().type.toLowerCase()}`)),ne(H=>d(de,{...C,background:v().bg,color:v().color},H)),w})(),(()=>{var w=tC(),A=w.firstChild,y=A.nextSibling,de=y.firstChild,H=de.nextSibling;return H.nextSibling,d(w,N),A.$$click=()=>n("details"),s(A,()=>e("accounts.accountDetails")),y.$$click=()=>n("transactions"),s(y,()=>e("accounts.transactions"),de),s(y,()=>P().length,H),ne($=>{var Z=E(r()==="details"),k=E(r()==="transactions");return $.e=d(A,Z,$.e),$.t=d(y,k,$.t),$},{e:void 0,t:void 0}),w})(),me(()=>me(()=>r()==="details")()&&(()=>{var w=rC(),A=w.firstChild,y=A.firstChild,de=y.nextSibling,H=A.nextSibling,$=H.firstChild,Z=$.nextSibling,k=H.nextSibling,F=k.firstChild,B=F.nextSibling,W=k.nextSibling,fe=W.firstChild,K=fe.nextSibling,he=W.nextSibling,D=he.firstChild,U=D.nextSibling,Q=he.nextSibling,J=Q.firstChild,ce=J.nextSibling;return s(y,()=>e("accounts.accountNumber")),s(de,()=>a().accountNumber),s($,()=>e("accounts.category")),s(Z,()=>a().category),s(F,()=>e("common.description")),s(B,()=>a().description),s(fe,()=>e("common.status")),s(K,(()=>{var oe=me(()=>!!a().isActive);return()=>oe()?e("common.active"):e("common.inactive")})()),s(D,()=>e("accounts.createdDate")),s(U,()=>b(a().createdDate)),s(J,()=>e("accounts.lastModified")),s(ce,()=>b(a().lastModified)),ne(oe=>{var O=c,re=u,pe=h,ve=c,te=u,se=h,R=c,M=u,V=h,ge=c,le=u,j=h,G=c,Pe=u,_e=h,ae=c,be=u,X=h;return oe.e=d(A,O,oe.e),oe.t=d(y,re,oe.t),oe.a=d(de,pe,oe.a),oe.o=d(H,ve,oe.o),oe.i=d($,te,oe.i),oe.n=d(Z,se,oe.n),oe.s=d(k,R,oe.s),oe.h=d(F,M,oe.h),oe.r=d(B,V,oe.r),oe.d=d(W,ge,oe.d),oe.l=d(fe,le,oe.l),oe.u=d(K,j,oe.u),oe.c=d(he,G,oe.c),oe.w=d(D,Pe,oe.w),oe.m=d(U,_e,oe.m),oe.f=d(Q,ae,oe.f),oe.y=d(J,be,oe.y),oe.g=d(ce,X,oe.g),oe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),w})()),me(()=>me(()=>r()==="transactions")()&&(()=>{var w=ml();return s(w,(()=>{var A=me(()=>P().length===0);return()=>A()?(()=>{var y=ml();return y.style.setProperty("text-align","center"),y.style.setProperty("color","var(--text-muted)"),y.style.setProperty("padding","2rem"),s(y,()=>e("common.noDataFound")),y})():P().map(y=>(()=>{var de=nC(),H=de.firstChild,$=H.firstChild,Z=$.nextSibling,k=Z.firstChild,F=H.nextSibling;return d(de,T),d(H,x),d($,ee),s($,()=>y.description),d(Z,q),s(Z,()=>b(y.date),k),s(Z,()=>y.reference,null),s(F,()=>y.type==="debit"?"+":"-",null),s(F,()=>I(y.type==="debit"?y.debitAmount:y.creditAmount),null),ne(B=>d(F,Y(y.type),B)),de})())})()),w})()),(()=>{var w=ml();return d(w,ue),s(w,S(De,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(w,S(De,{variant:"primary",onClick:()=>o(!0),get children(){return e("accounts.editAccount")}}),null),w})()]})()),me(()=>me(()=>!!a())()&&S(Xw,{get isOpen(){return i()},onClose:()=>{o(!1)},get account(){return a()}}))]}})};St(["click"]);const oC="https://qvamarkets.com/gql_api",[sC,gh]=ye(!1),[aC,fl]=ye(null);class lC{baseUrl;constructor(e=oC){this.baseUrl=e}async request(e,r,n,i){gh(!0),fl(null);try{const o=r.startsWith("http")?r:`${this.baseUrl}${r}`,a={method:e,headers:{"Content-Type":"application/json",Accept:"application/json",...i}};n&&(e==="POST"||e==="PUT"||e==="PATCH")&&(a.body=JSON.stringify(n));const c=await fetch(o,a);if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);const u=await c.json();if(u.errors&&u.errors.length>0)throw new Error(u.errors[0].message);return u.data||u}catch(o){const a=o instanceof Error?o.message:"Unknown error occurred";throw fl(a),o}finally{gh(!1)}}async graphql(e){return this.request("POST","",e)}async get(e,r){return this.request("GET",e,void 0,r)}async post(e,r,n){return this.request("POST",e,r,n)}async put(e,r,n){return this.request("PUT",e,r,n)}async patch(e,r,n){return this.request("PATCH",e,r,n)}async delete(e,r){return this.request("DELETE",e,void 0,r)}getLoadingState(){return sC()}getErrorState(){return aC()}clearError(){fl(null)}}const Rs=new lC,ou=`
  fragment AccountFields on Account {
    id
    accountNumber
    name
    type
    category
    description
    balance
    isActive
    parentAccountId
    createdDate
    lastModified
  }
`,cC=`
  query GetAccountById($id: ID!) {
    account(id: $id) {
      ...AccountFields
    }
  }
  ${ou}
`,uC=`
  mutation CreateAccount($input: CreateAccountInput!) {
    createAccount(input: $input) {
      ...AccountFields
    }
  }
  ${ou}
`,dC=`
  mutation UpdateAccount($id: ID!, $input: UpdateAccountInput!) {
    updateAccount(id: $id, input: $input) {
      ...AccountFields
    }
  }
  ${ou}
`,hC=`
  mutation DeleteAccount($id: ID!) {
    deleteAccount(id: $id) {
      success
      message
    }
  }
`;class mC{async getAccounts(e,r){try{if(qo.isFakeMode())return await Fu.getAll(e);const n=await Bn({query:"getAllYabaProducts",params:{businessId:"YB100423253156428"}});return console.log("Real API accounts response:",n),n?.accounts||[]}catch(n){if(console.error("Error fetching accounts:",n),qo.isHybridMode())return console.warn("Falling back to fake API for accounts"),await Fu.getAll(e);throw n}}async getAccountById(e){try{return(await Rs.graphql({query:cC,variables:{id:e}})).account}catch(r){throw console.error("Error fetching account:",r),r}}async createAccount(e){try{return(await Rs.graphql({query:uC,variables:{input:e}})).createAccount}catch(r){throw console.error("Error creating account:",r),r}}async updateAccount(e,r){try{return(await Rs.graphql({query:dC,variables:{id:e,input:r}})).updateAccount}catch(n){throw console.error("Error updating account:",n),n}}async deleteAccount(e){try{return(await Rs.graphql({query:hC,variables:{id:e}})).deleteAccount}catch(r){throw console.error("Error deleting account:",r),r}}async getAccountsByType(e){return this.getAccounts({type:e})}async getAccountHierarchy(){const e=await this.getAccounts();return this.buildHierarchy(e)}buildHierarchy(e){const r=new Map,n=[];return e.forEach(i=>{r.set(i.id,{...i,subAccounts:[]})}),e.forEach(i=>{const o=r.get(i.id);if(i.parentAccountId){const a=r.get(i.parentAccountId);a&&(a.subAccounts=a.subAccounts||[],a.subAccounts.push(o))}else n.push(o)}),n}async getAccountBalance(e){const r=await this.getAccountById(e);return r?r.balance:0}async searchAccounts(e){return this.getAccounts({search:e})}}const fC=new mC;var yC=z("<div><h2></h2><div><span>:</span><button></button><button>"),gC=z("<div><span>:"),ph=z("<div>"),pC=z("<button>");const vC=()=>{const{t}=ot(),[e,r]=ye(!1),[n,i]=ye(!1),[o,a]=ye(!1),[c,u]=ye(null),[h,f]=ye(null),[p,_]=ye("All"),[C,N]=ye("hierarchy"),E=b=>{u(b),a(!0)},T=b=>{f(b),i(!0)},x=()=>p()==="All"?C()==="hierarchy"?ut.getAccountHierarchy():ut.accounts:C()==="hierarchy"?ut.getAccountHierarchy().filter(b=>b.type===p()):ut.getAccountsByType(p()),q={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},ee={display:"flex",gap:"1rem","margin-bottom":"2rem","align-items":"center"},Y=b=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:b?"var(--primary-color)":"var(--surface-color)",color:b?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500",transition:"all 0.2s ease"}),ue={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},ie={display:"flex",gap:"0.5rem","align-items":"center","margin-left":"auto","margin-right":"1rem"},I=b=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:b?"var(--primary-color)":"var(--surface-color)",color:b?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"});return S(Fr,{get title(){return t("accounts.title")},get children(){return[S(Lw,{}),(()=>{var b=yC(),v=b.firstChild,P=v.nextSibling,w=P.firstChild,A=w.firstChild,y=w.nextSibling,de=y.nextSibling;return d(b,ue),v.style.setProperty("margin","0"),v.style.setProperty("font-size","1.5rem"),s(v,()=>t("accounts.title")),d(P,ie),w.style.setProperty("font-weight","500"),w.style.setProperty("color","var(--text-muted)"),w.style.setProperty("font-size","0.875rem"),s(w,()=>t("common.view"),A),y.$$click=()=>N("hierarchy"),s(y,()=>t("accounts.accountHierarchy")),de.$$click=()=>{N("flat"),fC.getAccounts()},s(de,()=>t("common.all")),s(b,S(De,{variant:"primary",onClick:()=>r(!0),get children(){return t("accounts.addAccount")}}),null),ne(H=>{var $=I(C()==="hierarchy"),Z=I(C()==="flat");return H.e=d(y,$,H.e),H.t=d(de,Z,H.t),H},{e:void 0,t:void 0}),b})(),(()=>{var b=gC(),v=b.firstChild,P=v.firstChild;return d(b,ee),v.style.setProperty("font-weight","500"),v.style.setProperty("color","var(--text-muted)"),s(v,()=>t("common.filter"),P),s(b,()=>[t("common.all"),t("accounts.types.asset"),t("accounts.types.liability"),t("accounts.types.equity"),t("accounts.types.revenue"),t("accounts.types.expense")].map((w,A)=>{const de=["All","Asset","Liability","Equity","Revenue","Expense"][A];return(()=>{var H=pC();return H.$$click=()=>_(de),s(H,w),ne($=>d(H,Y(p()===de),$)),H})()}),null),b})(),(()=>{var b=ph();return s(b,(()=>{var v=me(()=>C()==="hierarchy");return()=>v()?x().map(P=>S(qw,{account:P,onAddSubAccount:T,onViewDetails:E})):x().map(P=>S(Vw,{account:P,onViewDetails:E}))})()),ne(v=>d(b,C()==="hierarchy"?{display:"flex","flex-direction":"column",gap:"1rem"}:q,v)),b})(),me(()=>me(()=>x().length===0)()&&(()=>{var b=ph();return b.style.setProperty("text-align","center"),b.style.setProperty("color","var(--text-muted)"),b.style.setProperty("padding","3rem"),b.style.setProperty("font-size","1.1rem"),s(b,()=>t("common.noDataFound")),b})()),S(Ww,{get isOpen(){return e()},onClose:()=>r(!1)}),S(Yw,{get isOpen(){return n()},onClose:()=>i(!1),get parentAccount(){return h()}}),S(iC,{get isOpen(){return o()},onClose:()=>a(!1),get account(){return c()}})]}})};St(["click"]);var bC=z("<div><h2>"),Mi=z("<div>"),_C=z("<div><div><div></div><h1></h1><div></div></div><div>"),SC=z("<div><button></button><button> (<!>)"),Ds=z("<div><span></span><span>"),PC=z("<p>"),wC=z("<div><div></div><div>"),CC=z("<div><div><div></div><div> • </div></div><div>");const AC=()=>{const{t}=ot(),e=Wg(),r=fc(),[n,i]=ye(null),[o,a]=ye("overview");cn(()=>{const y=ut.getAccountById(e.id);y?i(y):r("/accounts")});const c={display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"1rem"},u={display:"flex","align-items":"center",gap:"1rem","margin-bottom":"2rem"},h={"font-size":"1rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},f={"font-size":"2.5rem","font-weight":"700",color:"var(--primary-color)"},p={padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},_={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},C=y=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:y?"var(--primary-color)":"var(--text-muted)","border-bottom":y?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),N={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},E={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},T={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},x={"font-weight":"500",color:"var(--text-muted)"},q={"font-weight":"600",color:"var(--text-primary)"},ee={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},Y={flex:"1"},ue={"font-weight":"500","margin-bottom":"0.25rem"},ie={"font-size":"0.875rem",color:"var(--text-muted)"},I=y=>({"font-weight":"600",color:y==="debit"?"#4caf50":"#f44336"});if(!n())return S(Fr,{get title(){return t("accounts.accountDetails")},get children(){var y=bC(),de=y.firstChild;return y.style.setProperty("text-align","center"),y.style.setProperty("padding","3rem"),s(de,()=>t("common.error")),s(y,S(De,{variant:"primary",onClick:()=>r("/accounts"),get children(){return[me(()=>t("common.back"))," ",me(()=>t("navigation.accounts"))]}}),null),y}});const b=y=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[y]||{bg:"#f5f5f5",color:"#666"},v=y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(y),P=y=>new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),w=b(n().type),A=ut.getAccountTransactions(n().id);return S(Fr,{get title(){return n().name},get children(){return[(()=>{var y=Mi();return d(y,c),s(y,S(De,{variant:"secondary",onClick:()=>r("/accounts"),get children(){return["← ",me(()=>t("common.back"))," ",me(()=>t("navigation.accounts"))]}})),y})(),(()=>{var y=_C(),de=y.firstChild,H=de.firstChild,$=H.nextSibling,Z=$.nextSibling,k=de.nextSibling;return d(y,u),d(H,h),s(H,()=>n().accountNumber),$.style.setProperty("margin","0.5rem 0"),$.style.setProperty("font-size","2rem"),s($,()=>n().name),d(Z,f),s(Z,()=>v(n().balance)),s(k,()=>n().type),ne(F=>d(k,{...p,background:w.bg,color:w.color},F)),y})(),(()=>{var y=SC(),de=y.firstChild,H=de.nextSibling,$=H.firstChild,Z=$.nextSibling;return Z.nextSibling,d(y,_),de.$$click=()=>a("overview"),s(de,()=>t("dashboard.overview")),H.$$click=()=>a("transactions"),s(H,()=>t("accounts.transactions"),$),s(H,()=>A.length,Z),ne(k=>{var F=C(o()==="overview"),B=C(o()==="transactions");return k.e=d(de,F,k.e),k.t=d(H,B,k.t),k},{e:void 0,t:void 0}),y})(),me(()=>me(()=>o()==="overview")()&&(()=>{var y=wC(),de=y.firstChild,H=de.nextSibling;return d(de,N),s(de,S(Qe,{get title(){return t("accounts.balance")},get subtitle(){return t("dashboard.overview")},get children(){var $=Mi();return $.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","600"),$.style.setProperty("color","var(--primary-color)"),s($,()=>v(n().balance)),$}}),null),s(de,S(Qe,{get title(){return t("accounts.accountType")},get subtitle(){return t("accounts.category")},get children(){var $=Mi();return $.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","600"),$.style.setProperty("color","var(--primary-color)"),s($,()=>t(`accounts.types.${n().type.toLowerCase()}`)),$}}),null),s(de,S(Qe,{get title(){return t("common.status")},get subtitle(){return t("accounts.accountDetails")},get children(){var $=Mi();return $.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","600"),s($,(()=>{var Z=me(()=>!!n().isActive);return()=>Z()?t("common.active"):t("common.inactive")})()),ne(Z=>(Z=n().isActive?"#4caf50":"#f44336")!=null?$.style.setProperty("color",Z):$.style.removeProperty("color")),$}}),null),s(de,S(Qe,{get title(){return t("accounts.transactions")},get subtitle(){return t("common.total")},get children(){var $=Mi();return $.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","600"),$.style.setProperty("color","var(--primary-color)"),s($,()=>A.length),$}}),null),d(H,E),s(H,S(Qe,{get title(){return t("accounts.accountDetails")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var $=Ds(),Z=$.firstChild,k=Z.nextSibling;return s(Z,()=>t("accounts.accountNumber")),s(k,()=>n().accountNumber),ne(F=>{var B=T,W=x,fe=q;return F.e=d($,B,F.e),F.t=d(Z,W,F.t),F.a=d(k,fe,F.a),F},{e:void 0,t:void 0,a:void 0}),$})(),(()=>{var $=Ds(),Z=$.firstChild,k=Z.nextSibling;return s(Z,()=>t("accounts.category")),s(k,()=>n().category),ne(F=>{var B=T,W=x,fe=q;return F.e=d($,B,F.e),F.t=d(Z,W,F.t),F.a=d(k,fe,F.a),F},{e:void 0,t:void 0,a:void 0}),$})(),(()=>{var $=Ds(),Z=$.firstChild,k=Z.nextSibling;return s(Z,()=>t("common.date")),s(k,()=>P(n().createdDate)),ne(F=>{var B=T,W=x,fe=q;return F.e=d($,B,F.e),F.t=d(Z,W,F.t),F.a=d(k,fe,F.a),F},{e:void 0,t:void 0,a:void 0}),$})(),(()=>{var $=Ds(),Z=$.firstChild,k=Z.nextSibling;return s(Z,()=>t("common.date")),s(k,()=>P(n().lastModified)),ne(F=>{var B=T,W=x,fe=q;return F.e=d($,B,F.e),F.t=d(Z,W,F.t),F.a=d(k,fe,F.a),F},{e:void 0,t:void 0,a:void 0}),$})()]}}),null),s(H,S(Qe,{get title(){return t("common.description")},get subtitle(){return t("accounts.accountDetails")},get children(){var $=PC();return $.style.setProperty("margin","0"),$.style.setProperty("color","var(--text-secondary)"),s($,()=>n().description||t("common.noDataFound")),$}}),null),y})()),me(()=>me(()=>o()==="transactions")()&&S(Qe,{get title(){return t("accounts.accountHistory")},get subtitle(){return t("accounts.transactions")},get children(){return me(()=>A.length===0)()?(()=>{var y=Mi();return y.style.setProperty("text-align","center"),y.style.setProperty("color","var(--text-muted)"),y.style.setProperty("padding","2rem"),s(y,()=>t("common.noDataFound")),y})():A.map(y=>(()=>{var de=CC(),H=de.firstChild,$=H.firstChild,Z=$.nextSibling,k=Z.firstChild,F=H.nextSibling;return d(de,ee),d(H,Y),d($,ue),s($,()=>y.description),d(Z,ie),s(Z,()=>P(y.date),k),s(Z,()=>y.reference,null),s(F,()=>y.type==="debit"?"+":"-",null),s(F,()=>v(y.type==="debit"?y.debitAmount:y.creditAmount),null),ne(B=>d(F,I(y.type),B)),de})())}}))]}})};St(["click"]);var IC=z("<div><div><h1></h1><p> </p></div><div><input type=date>"),fn=z("<div><span></span><span>"),EC=z("<div><div></div><div>"),xC=z("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),TC=z("<div><div> (<!> = <!> + <!>)</div><div> = "),$C=z("<span>(<!>: <!>)");const kC=()=>{const{t}=ot(),[e,r]=ye(new Date().toISOString().split("T")[0]),[n,i]=ye(0),[o,a]=ye(0),[c,u]=ye(0);cn(()=>{h()});const h=()=>{const N=ut.getAccountsByType("Asset"),E=ut.getAccountsByType("Liability"),T=ut.getAccountsByType("Equity"),x=N.reduce((Y,ue)=>Y+ue.balance,0),q=E.reduce((Y,ue)=>Y+ue.balance,0),ee=T.reduce((Y,ue)=>Y+ue.balance,0);i(x),a(q),u(ee)},f=N=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(N),p={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},_={"margin-bottom":"2rem"},C={"font-weight":"bold","font-size":"1.1rem","border-top":"2px solid var(--border-color)","padding-top":"0.5rem","margin-top":"1rem"};return S(Fr,{get title(){return t("balanceSheet.title")},get children(){return[(()=>{var N=IC(),E=N.firstChild,T=E.firstChild,x=T.nextSibling,q=x.firstChild,ee=E.nextSibling,Y=ee.firstChild;return d(N,p),T.style.setProperty("margin","0"),s(T,()=>t("balanceSheet.title")),x.style.setProperty("margin","0.5rem 0 0 0"),x.style.setProperty("color","var(--text-muted)"),s(x,()=>t("balanceSheet.asOf"),q),s(x,()=>new Date(e()).toLocaleDateString(),null),ee.style.setProperty("display","flex"),ee.style.setProperty("gap","1rem"),Y.addEventListener("change",ue=>r(ue.target.value)),Y.style.setProperty("padding","0.5rem"),Y.style.setProperty("border","1px solid var(--border-color)"),Y.style.setProperty("border-radius","var(--border-radius-sm)"),s(ee,S(De,{variant:"primary",onClick:h,get children(){return t("balanceSheet.generateReport")}}),null),ne(()=>Y.value=e()),N})(),(()=>{var N=EC(),E=N.firstChild,T=E.nextSibling;return N.style.setProperty("display","grid"),N.style.setProperty("grid-template-columns","1fr 1fr"),N.style.setProperty("gap","2rem"),s(E,S(Qe,{get title(){return t("balanceSheet.assets")},style:_,get children(){return[(()=>{var x=fn(),q=x.firstChild,ee=q.nextSibling;return x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),s(q,()=>t("balanceSheet.currentAssets")),s(ee,()=>f(n()*.6)),x})(),(()=>{var x=fn(),q=x.firstChild,ee=q.nextSibling;return x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),s(q,()=>t("balanceSheet.nonCurrentAssets")),s(ee,()=>f(n()*.4)),x})(),(()=>{var x=fn(),q=x.firstChild,ee=q.nextSibling;return s(q,()=>t("balanceSheet.totalAssets")),s(ee,()=>f(n())),ne(Y=>d(x,{...C,display:"flex","justify-content":"space-between"},Y)),x})()]}})),s(T,S(Qe,{get title(){return t("balanceSheet.liabilities")},style:_,get children(){return[(()=>{var x=fn(),q=x.firstChild,ee=q.nextSibling;return x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),s(q,()=>t("balanceSheet.currentLiabilities")),s(ee,()=>f(o()*.7)),x})(),(()=>{var x=fn(),q=x.firstChild,ee=q.nextSibling;return x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),s(q,()=>t("balanceSheet.nonCurrentLiabilities")),s(ee,()=>f(o()*.3)),x})(),(()=>{var x=fn(),q=x.firstChild,ee=q.nextSibling;return s(q,()=>t("balanceSheet.totalLiabilities")),s(ee,()=>f(o())),ne(Y=>d(x,{...C,display:"flex","justify-content":"space-between"},Y)),x})()]}}),null),s(T,S(Qe,{get title(){return t("balanceSheet.equity")},get children(){return[(()=>{var x=fn(),q=x.firstChild,ee=q.nextSibling;return x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),s(q,()=>t("balanceSheet.commonStock")),s(ee,()=>f(c()*.8)),x})(),(()=>{var x=fn(),q=x.firstChild,ee=q.nextSibling;return x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),s(q,()=>t("balanceSheet.retainedEarnings")),s(ee,()=>f(c()*.2)),x})(),(()=>{var x=fn(),q=x.firstChild,ee=q.nextSibling;return s(q,()=>t("balanceSheet.totalEquity")),s(ee,()=>f(c())),ne(Y=>d(x,{...C,display:"flex","justify-content":"space-between"},Y)),x})()]}}),null),N})(),S(Qe,{get title(){return t("dashboard.overview")},style:{"margin-top":"2rem"},get children(){return[(()=>{var N=xC(),E=N.firstChild,T=E.firstChild,x=T.nextSibling,q=E.nextSibling,ee=q.firstChild,Y=ee.nextSibling,ue=q.nextSibling,ie=ue.firstChild,I=ie.nextSibling;return N.style.setProperty("display","grid"),N.style.setProperty("grid-template-columns","repeat(3, 1fr)"),N.style.setProperty("gap","2rem"),E.style.setProperty("text-align","center"),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","var(--text-muted)"),T.style.setProperty("margin-bottom","0.5rem"),s(T,()=>t("balanceSheet.totalAssets")),x.style.setProperty("font-size","1.5rem"),x.style.setProperty("font-weight","bold"),x.style.setProperty("color","var(--primary-color)"),s(x,()=>f(n())),q.style.setProperty("text-align","center"),ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),ee.style.setProperty("margin-bottom","0.5rem"),s(ee,()=>t("balanceSheet.totalLiabilities")),Y.style.setProperty("font-size","1.5rem"),Y.style.setProperty("font-weight","bold"),Y.style.setProperty("color","#f44336"),s(Y,()=>f(o())),ue.style.setProperty("text-align","center"),ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-muted)"),ie.style.setProperty("margin-bottom","0.5rem"),s(ie,()=>t("balanceSheet.totalEquity")),I.style.setProperty("font-size","1.5rem"),I.style.setProperty("font-weight","bold"),I.style.setProperty("color","#4caf50"),s(I,()=>f(c())),N})(),(()=>{var N=TC(),E=N.firstChild,T=E.firstChild,x=T.nextSibling,q=x.nextSibling,ee=q.nextSibling,Y=ee.nextSibling,ue=Y.nextSibling;ue.nextSibling;var ie=E.nextSibling,I=ie.firstChild;return N.style.setProperty("margin-top","2rem"),N.style.setProperty("text-align","center"),E.style.setProperty("font-size","0.875rem"),E.style.setProperty("color","var(--text-muted)"),E.style.setProperty("margin-bottom","0.5rem"),s(E,()=>t("common.total"),T),s(E,()=>t("balanceSheet.totalAssets"),x),s(E,()=>t("balanceSheet.totalLiabilities"),ee),s(E,()=>t("balanceSheet.totalEquity"),ue),ie.style.setProperty("font-size","1.2rem"),ie.style.setProperty("font-weight","bold"),s(ie,()=>f(n()),I),s(ie,()=>f(o()+c()),null),s(ie,(()=>{var b=me(()=>Math.abs(n()-(o()+c()))>.01);return()=>b()&&(()=>{var v=$C(),P=v.firstChild,w=P.nextSibling,A=w.nextSibling,y=A.nextSibling;return y.nextSibling,v.style.setProperty("font-size","0.875rem"),v.style.setProperty("color","#f44336"),v.style.setProperty("display","block"),s(v,()=>t("common.error"),w),s(v,()=>f(n()-(o()+c())),y),v})()})(),null),ne(b=>(b=Math.abs(n()-(o()+c()))<.01?"#4caf50":"#f44336")!=null?ie.style.setProperty("color",b):ie.style.removeProperty("color")),N})()]}})]}})};St(["click"]);const RC=[{id:"YY_8801",code:"YY_8801",name:"YABA SUR",bussinesId:"YB100423253156428",type:"store",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8802",code:"YY_8802",name:"CENTER",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8803",code:"YY_8803",name:"BISONET",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8804",code:"YY_8804",name:"IRVIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8805",code:"YY_8805",name:"KATTY",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8814",code:"YY_8814",name:"YABASUR OR",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8816",code:"YY_8816",name:"YABA GLOBAL",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8818",code:"YY_8818",name:"YABASURAUSTIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8844",code:"YY_8844",name:"YABANEBRASKA",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8847",code:"YY_8847",name:"YABAOFICINA AZ",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_3251",code:"YY_3251",name:"YABA FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_32",code:"YY_32",name:"YABA MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_33",code:"YY_33",name:"YABASUR ARIZONA",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8635",code:"YY_8635",name:"FASHION MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8665",code:"YY_8665",name:"IRVIN FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8901",code:"YY_8901",name:"ALMACEN CENTRAL YABA",bussinesId:"YB100423253156428",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01"}],DC=[{id:"1",name:'MacBook Pro 16"',price:2399,quantity:75,category:"Electronics",description:"Apple MacBook Pro 16-inch with M2 Pro chip",sku:"MBP-16-M2P",supplier:"Apple Inc.",minStock:10,location:"Warehouse A",lastUpdated:"2024-01-15"},{id:"2",name:'Dell Monitor 27"',price:299,quantity:35,category:"Electronics",description:"Dell 27-inch 4K UHD Monitor",sku:"DELL-MON-27-4K",supplier:"Dell Technologies",minStock:15,location:"Warehouse B",lastUpdated:"2024-01-14"},{id:"3",name:"Wireless Mouse",price:49.99,quantity:12,category:"Accessories",description:"Ergonomic wireless mouse with precision tracking",sku:"MOUSE-WL-001",supplier:"Logitech",minStock:25,location:"Warehouse A",lastUpdated:"2024-01-13"}],Ns=()=>{const t=new Map;return Dr().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=Re.getLocationById(e.locationId),i=t.get(r);i||(i={id:r,productId:e.productId,locationId:e.locationId,locationName:n?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,i)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(i.quantity+=e.quantity*1):e.movementType==="out"?i.quantity-=e.quantity*1:e.movementType==="adjustment"&&(i.quantity=e.quantity*1),new Date(e.createdDate)>new Date(i.lastMovementDate)&&(i.lastMovementDate=e.createdDate,i.lastMovementType=e.movementType),i.averageCost=e.unitCost*1,i.availableQuantity=i.quantity*1-i.reservedQuantity*1}),Array.from(t.values())},[oi,yl]=ye([]),[si,vh]=ye(RC),[Dr,Ls]=ye([]),[Dn,ko]=ye([]),NC=()=>{const t=new Map;return Dr().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=t.get(r),i=Re.getLocationById(e.locationId);n||(n={id:r,productId:e.productId,locationId:e.locationId,locationName:i?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(n.quantity+=e.quantity*1):e.movementType==="out"?n.quantity-=e.quantity*1:e.movementType==="adjustment"&&(n.quantity=e.quantity*1),new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost*1,n.availableQuantity=n.quantity*1-n.reservedQuantity*1}),Array.from(t.values())};ko(NC());const[Ms,gl]=ye(DC),LC={TRANSFER:1,transfer:1},bh=173442384e4,Re={get products(){return oi()},get locations(){return si()},get movements(){return Dr()},get stockLevels(){return Dn()},parseInventoryData:t=>{const e=Object.keys(t).slice(0,900),r=[],n=i=>{let o=t;o[i]?.products&&o[i]?.products?.map(a=>{let c=yp(o[i]?.type),u=a?.price*1||a?.unitCost*1,h=a?.qty*1||a?.quantity*1;u=isNaN(u)?0:u,h=isNaN(h)?0:h;let f={id:o[i]?.ssg_inventory_key,productId:a?.product?.id,productName:a?.product?.label,productSku:a?.product?.code,locationId:o[i]?.store,locationName:o[i]?.store,location:o[i]?.store,movementType:c,quantity:h,unitCost:u,totalCost:u*1*h,minStock:10,referenceNumber:"PO-001",notes:o[i]?.description||o[i]?.notes,createdBy:"admin",createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(bh).toISOString(),invoiceId:o[i]?.invoice};if(r.push(f),LC[o[i].movementType]&&o[i]?.fromLocationId){let p=Re.getLocationById(o[i]?.fromLocationId);const _={id:o[i]?.ssg_inventory_key,productId:a?.product?.id,productName:a?.product?.label,productSku:a?.product?.code,locationId:o[i]?.fromLocationId,locationName:p?.name||"",movementType:"out",quantity:h*-1,unitCost:u,totalCost:u*-1*h,minStock:10,referenceNumber:o[i]?.referenceNumber,notes:`Transfer to ${o[i]?.locationName}`+(o[i].notes?` - ${o[i].notes}`:""),createdBy:o[i].createdBy,createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(bh).toISOString(),invoiceId:o[i]?.invoiceId,toLocationId:o[i]?.locationId,toLocationName:o[i]?.locationName};r.push(_)}})};return e.map(n),r},fecthInventory:async t=>{const e=await Fn.getInventory(t),r=Re.parseInventoryData(e);Re.updMovements(r)},fecthProduct:async t=>{const e=await Fn.getProducts(t),r=Object.keys(e),n=o=>{let a=e;return console.log(a[o]),{id:o,name:a[o].name,businessId:a[o].businessId,sku:a[o].code,UPC:a[o].UPC,numCode:a[o].codeN,category:a[o].category,unitCost:a[o].unitCost||0,unitOfMeasure:a[o].unitOfMeasure||a[o].unit,minStockLevel:a[o].minStockLevel,maxStockLevel:a[o].maxStockLevel,isActive:a[o].isActive,description:a[o].description||"",createdDate:a[o].createdAt||new Date().toISOString(),lastModified:a[o].updatedAt||new Date().toISOString()}},i=r.map(n);return Re.updProduct(i),i},getProductById:t=>oi().find(e=>e.id===t),updProduct:t=>{yl(t)},getProductsBySku:t=>oi().filter(e=>e.sku.toLowerCase().includes(t.toLowerCase())),getProductsByCategory:t=>oi().filter(e=>e.category===t),getActiveProducts:()=>oi().filter(t=>t.name),getLocationById:t=>si().find(e=>e.id===t),getLocationsByType:t=>si().filter(e=>e.type===t),getActiveLocations:()=>si().filter(t=>t.isActive),getMovementsByProduct:t=>Dr().filter(e=>e.productId===t),updMovements:t=>{Ls([...t]),ko(Ns())},getMovementsByLocation:t=>Dr().filter(e=>e.locationId===t),getMovementsByDateRange:(t,e)=>Dr().filter(r=>r.createdDate>=t&&r.createdDate<=e),getStockByProduct:t=>Dn().filter(e=>e.productId===t),getStockByLocation:t=>Dn().filter(e=>e.locationId===t),getStockByProductAndLocation:(t,e)=>Dn().find(r=>r.productId===t&&r.locationId===e),getTotalStockByProduct:t=>Dn().filter(e=>e.productId===t).reduce((e,r)=>e*1+r.quantity*1,0),getLastLocationByProduct:t=>{const e=Dr().filter(r=>r.productId===t).sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime());if(e.length>0)return si().find(r=>r.id===e[0].locationId)},getLowStockProducts:()=>(oi()||[])?.map(t=>{const e=Dn().filter(r=>r.productId===t.id).reduce((r,n)=>r+n.quantity,0);return{...t,currentStock:e}}).filter(t=>t.currentStock<=t.minStockLevel),addInventoryMovement:t=>{const e={...t,id:`mov-${Date.now()}`,createdDate:new Date().toISOString()};Ls(r=>[...r,e]),ko(Ns())},addBulkInventoryMovements:async t=>{const e=[],r=[],n=new Date().toISOString(),i=si().find(c=>c.id===t.locationId);if(!i)return{success:!1,errors:["Invalid location"]};let o;if(t.movementType==="transfer"){if(!t.fromLocationId)return{success:!1,errors:["From location required for transfers"]};if(o=si().find(c=>c.id===t.fromLocationId),!o)return{success:!1,errors:["Invalid from location"]};if(t.fromLocationId===t.locationId)return{success:!1,errors:["From and to locations cannot be the same"]}}if(t.items.forEach((c,u)=>{const h=oi().find(C=>C.id===c.productId);if(!h){e.push(`Item ${u+1}: Product not found`);return}if(c.quantity<=0){e.push(`Item ${u+1}: Quantity must be greater than 0`);return}if(t.movementType==="out"){const C=Dn().filter(N=>N.productId===c.productId&&N.locationId===t.locationId).reduce((N,E)=>N+E.quantity,0);if(c.quantity>C){e.push(`Item ${u+1}: Insufficient stock. Available: ${C}, Requested: ${c.quantity}`);return}}if(t.movementType==="transfer"){const C=Dn().filter(N=>N.productId===c.productId&&N.locationId===t.fromLocationId).reduce((N,E)=>N+E.quantity,0);if(c.quantity>C){e.push(`Item ${u+1}: Insufficient stock at ${o?.name}. Available: ${C}, Requested: ${c.quantity}`);return}}const f=c.unitCost||h.unitCost,p=c.quantity*f,_={id:`mov-${Date.now()}-${u}`,productId:h.id,productName:h.name,productSku:h.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:c.quantity,unitCost:f,totalCost:p,minStock:10,referenceNumber:t.referenceNumber||"",notes:c.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:o?.name};if(r.push(_),t.movementType==="transfer"&&o){const C={id:`mov-${Date.now()}-${u}-out`,productId:h.id,productName:h.name,productSku:h.sku,locationId:t.fromLocationId,locationName:o.name,movementType:"out",quantity:c.quantity,unitCost:f,totalCost:p,minStock:10,referenceNumber:t.referenceNumber||"",notes:`Transfer to ${i.name}`+(c.notes?` - ${c.notes}`:""),createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,toLocationId:t.locationId,toLocationName:i.name};r.push(C)}}),e.length>0)return{success:!1,errors:e};Ls(c=>[...c,...r]),ko(Ns()),console.log({bulkRequest:t});const a=await Fn.addInventory(t);return console.log({prodResults:a}),{success:!0,errors:[]}},getMovementsByInvoice:t=>Dr().filter(e=>e.invoiceId===t),getInvoiceSummary:t=>{const e=Dr().filter(o=>o.invoiceId===t);if(e.length===0)return null;const r=e.reduce((o,a)=>o+a.totalCost,0),n=new Set(e.map(o=>o.productId)).size,i=e[0];return{invoiceId:t,referenceNumber:i.referenceNumber,movementType:i.movementType,location:i.locationName,fromLocation:i.fromLocationName,productCount:n,totalItems:e.reduce((o,a)=>o+a.quantity,0),totalValue:r,createdDate:i.createdDate,createdBy:i.createdBy}},addProduct:t=>{const e={...t,id:`prod-${Date.now()}`,createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};yl(r=>[...r,e])},addLocation:t=>{const e={...t,id:`loc-${Date.now()}`,createdDate:new Date().toISOString()};vh(r=>[...r,e])},updateProduct:(t,e)=>{yl(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n))},updateLocation:(t,e)=>{vh(r=>r.map(n=>n.id===t?{...n,...e}:n))},updateMovement:(t,e)=>{Ls(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n)),ko(Ns())},get inventory(){return Ms()},addItem(t){const e={...t,id:Date.now().toString(),lastUpdated:new Date().toISOString().split("T")[0]};return gl([...Ms(),e]),e},updateItem(t,e){gl(Ms().map(r=>r.id===t?{...r,...e,lastUpdated:new Date().toISOString().split("T")[0]}:r))},deleteItem(t){gl(Ms().filter(e=>e.id!==t))},getItemById(t){return Dr().find(e=>e.id===t)},getLowStockItems(){return Dr().filter(t=>t.quantity*1<=t.minStock*1)},getTotalValue(){return Dr().reduce((t,e)=>t*1+e.unitCost*1*e.quantity*1,0)}};var _h=z("<div>"),MC=z("<div><div><input type=text autocomplete=off>"),OC=z("<button type=button>+"),VC=z("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>");const Vy=t=>{const{t:e}=ot(),[r,n]=ye(!1),[i,o]=ye(""),[a,c]=ye(-1),u=qe(()=>t.value?Re.getProductById(t.value):null),h=qe(()=>{const H=i().toLowerCase();return H?Re.getActiveProducts().filter($=>$.name.toLowerCase().includes(H)||$.sku.toLowerCase().includes(H)||$.category.toLowerCase().includes(H)):Re.getActiveProducts()}),f=()=>{n(!0),o(""),c(-1)},p=H=>{const $=H.target;o($.value),n(!0),c(-1)},_=H=>{t.onChange(H),n(!1),o(""),c(-1)},C=H=>{const $=h();switch(H.key){case"ArrowDown":H.preventDefault(),c(Z=>Math.min(Z+1,$.length-1));break;case"ArrowUp":H.preventDefault(),c(Z=>Math.max(Z-1,-1));break;case"Enter":H.preventDefault(),a()>=0&&$[a()]&&_($[a()]);break;case"Escape":n(!1),o(""),c(-1);break}},N=H=>{setTimeout(()=>{n(!1),o(""),c(-1)},150)},E=H=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(H),T=H=>Re.stockLevels.filter($=>$.productId===H).reduce(($,Z)=>$+Z.quantity,0),x={position:"relative",width:"100%",...t.style},q={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},ee={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},Y=H=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid "+H?"var(--primary-color)":"var(--border-color)",background:H?"var(--strip-color)":"transparent",color:H?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),ue={display:"flex","justify-content":"space-between","align-items":"center"},ie={flex:"1"},I={"font-weight":"500","margin-bottom":"0.25rem"},b={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},v={"text-align":"right","font-size":"0.875rem"},P={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},w=()=>r()&&i()?i():u()?`${u().name} (${u().sku})`:"",A={display:"flex","align-items":"stretch",width:"100%"},y={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},de={...q,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"};return(()=>{var H=MC(),$=H.firstChild,Z=$.firstChild;return d($,A),Z.addEventListener("blur",N),Z.$$keydown=C,Z.$$click=f,Z.$$input=p,s($,(()=>{var k=me(()=>!!t.onAddNew);return()=>k()&&(()=>{var F=OC();return F.addEventListener("mouseleave",B=>{B.currentTarget.style.background="var(--surface-color)",B.currentTarget.style.color="var(--primary-color)"}),F.addEventListener("mouseenter",B=>{B.currentTarget.style.background="var(--primary-color)",B.currentTarget.style.color="white"}),Si(F,"click",t.onAddNew,!0),d(F,y),ne(()=>lt(F,"title",e("inventory.addProduct","Add new product"))),F})()})(),null),s(H,S(Ve,{get when(){return r()},get children(){var k=_h();return s(k,S(Ve,{get when(){return h().length>0},get fallback(){return(()=>{var F=_h();return d(F,P),s(F,(()=>{var B=me(()=>!!i());return()=>B()?e("inventory.noProductsFound","No products found matching your search."):e("inventory.noProductsAvailable","No products available.")})()),F})()},get children(){return S(Mt,{get each(){return h()},children:(F,B)=>{const W=T(F.id),fe=W<=F.minStockLevel;return(()=>{var K=VC(),he=K.firstChild,D=he.firstChild,U=D.firstChild,Q=U.nextSibling,J=Q.firstChild,ce=J.firstChild,oe=J.nextSibling,O=oe.nextSibling,re=O.nextSibling,pe=re.nextSibling,ve=D.nextSibling,te=ve.firstChild,se=te.firstChild,R=te.nextSibling;return K.addEventListener("mouseenter",()=>c(B())),K.$$click=()=>_(F),d(he,ue),d(D,ie),d(U,I),s(U,()=>F.name),d(Q,b),s(J,()=>e("inventory.sku","SKU"),ce),s(J,()=>F.sku,null),s(O,()=>F.category),s(pe,()=>E(F.unitCost)),d(ve,v),te.style.setProperty("font-weight","600"),(fe?"#f44336":"var(--text-primary)")!=null?te.style.setProperty("color",fe?"#f44336":"var(--text-primary)"):te.style.removeProperty("color"),s(te,W,se),s(te,()=>F.unitOfMeasure,null),R.style.setProperty("color","var(--text-muted)"),s(R,()=>fe?e("inventory.lowStock","Low Stock"):e("inventory.inStock","In Stock")),ne(M=>d(K,Y(B()===a()),M)),K})()}})}})),ne(F=>d(k,ee,F)),k}}),null),ne(k=>{var F=x,B=de,W=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),fe=t.disabled,K=t.required;return k.e=d(H,F,k.e),k.t=d(Z,B,k.t),W!==k.a&&lt(Z,"placeholder",k.a=W),fe!==k.o&&(Z.disabled=k.o=fe),K!==k.i&&(Z.required=k.i=K),k},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ne(()=>Z.value=w()),H})()};St(["input","click","keydown"]);var Sh=z("<div>"),BC=z("<div><div><input type=text autocomplete=off>"),FC=z("<button type=button>+"),UC=z("<div><div><div><div> </div><div><span>: </span><span></span></div><div>");const Ea=t=>{const{t:e}=ot(),[r,n]=ye(!1),[i,o]=ye(""),[a,c]=ye(-1),u=qe(()=>t.value?Re.getLocationById(t.value):null),h=qe(()=>{let H=Re.getActiveLocations();t.filterType&&(H=H.filter(Z=>Z.type===t.filterType));const $=i().toLowerCase();return $?H.filter(Z=>Z.name.toLowerCase().includes($)||Z?.code?.toLowerCase().includes($)||Z?.type?.toLowerCase().includes($)||Z?.address?.toLowerCase().includes($)):H}),f=()=>{n(!0),o(""),c(-1)},p=H=>{const $=H.target;o($.value),n(!0),c(-1)},_=H=>{t.onChange(H.id),n(!1),o(""),c(-1)},C=H=>{const $=h();switch(H.key){case"ArrowDown":H.preventDefault(),c(Z=>Math.min(Z+1,$.length-1));break;case"ArrowUp":H.preventDefault(),c(Z=>Math.max(Z-1,-1));break;case"Enter":H.preventDefault(),a()>=0&&$[a()]&&_($[a()]);break;case"Escape":n(!1),o(""),c(-1);break}},N=H=>{setTimeout(()=>{n(!1),o(""),c(-1)},150)},E=H=>({warehouse:"🏭",store:"🏪",supplier:"🚚",customer:"👥"})[H]||"📍",T=H=>({warehouse:"#2196F3",store:"#4CAF50",supplier:"#FF9800",customer:"#9C27B0"})[H]||"#757575",x={position:"relative",width:"100%",...t.style},q={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},ee={display:"flex","align-items":"stretch",width:"100%"},Y={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},ue={...q,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},ie={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},I=H=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:H?"var(--strip-color)":"transparent",color:H?"var(--primary-dark)":"var(--text-primary)",transition:"all 0.2s ease"}),b={display:"flex","justify-content":"space-between","align-items":"center"},v={flex:"1"},P={"font-weight":"500","margin-bottom":"0.25rem"},w={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","align-items":"center"},A=H=>({padding:"0.2rem 0.5rem","border-radius":"var(--border-radius-sm)","font-size":"0.7rem","font-weight":"500",background:T(H),color:"white","text-transform":"uppercase"}),y={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},de=()=>r()&&i()?i():u()?`${u().name} (${u().code})`:"";return(()=>{var H=BC(),$=H.firstChild,Z=$.firstChild;return d($,ee),Z.addEventListener("blur",N),Z.$$keydown=C,Z.$$click=f,Z.$$input=p,s($,(()=>{var k=me(()=>!!t.onAddNew);return()=>k()&&(()=>{var F=FC();return F.addEventListener("mouseleave",B=>{B.currentTarget.style.background="var(--surface-color)",B.currentTarget.style.color="var(--primary-color)"}),F.addEventListener("mouseenter",B=>{B.currentTarget.style.background="var(--primary-color)",B.currentTarget.style.color="white"}),Si(F,"click",t.onAddNew,!0),d(F,Y),ne(()=>lt(F,"title",e("inventory.addLocation","Add new location"))),F})()})(),null),s(H,S(Ve,{get when(){return r()},get children(){var k=Sh();return s(k,S(Ve,{get when(){return h().length>0},get fallback(){return(()=>{var F=Sh();return d(F,y),s(F,(()=>{var B=me(()=>!!i());return()=>B()?e("inventory.noLocationsFound","No locations found matching your search."):e("inventory.noLocationsAvailable","No locations available.")})()),F})()},get children(){return S(Mt,{get each(){return h()},children:(F,B)=>(()=>{var W=UC(),fe=W.firstChild,K=fe.firstChild,he=K.firstChild,D=he.firstChild,U=he.nextSibling,Q=U.firstChild,J=Q.firstChild,ce=Q.nextSibling,oe=U.nextSibling;return W.addEventListener("mouseenter",()=>c(B())),W.$$click=()=>_(F),d(fe,b),d(K,v),d(he,P),s(he,()=>E(F.type),D),s(he,()=>F.name,null),d(U,w),s(Q,()=>e("inventory.locationCode","Code"),J),s(Q,()=>F.code,null),s(ce,()=>F.type),oe.style.setProperty("font-size","0.75rem"),oe.style.setProperty("color","var(--text-muted)"),oe.style.setProperty("margin-top","0.25rem"),s(oe,()=>F.address),ne(O=>{var re=I(B()===a()),pe=A(F.type);return O.e=d(W,re,O.e),O.t=d(ce,pe,O.t),O},{e:void 0,t:void 0}),W})()})}})),ne(F=>d(k,ie,F)),k}}),null),ne(k=>{var F=x,B=ue,W=t.placeholder||e("inventory.searchLocations","Search locations by name, code, or type..."),fe=t.disabled,K=t.required;return k.e=d(H,F,k.e),k.t=d(Z,B,k.t),W!==k.a&&lt(Z,"placeholder",k.a=W),fe!==k.o&&(Z.disabled=k.o=fe),K!==k.i&&(Z.required=k.i=K),k},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ne(()=>Z.value=de()),H})()};St(["input","click","keydown"]);var jC=z("<form><div><label> *</label><input type=text required></div><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text list=categories required><datalist id=categories><option value=Electronics></option><option value=Accessories></option><option value=Office></option><option value=Furniture></option><option value=Software></option><option value=Hardware></option></datalist></div></div><div><label></label><textarea></textarea></div><div><div><label></label><select><option value=pcs></option><option value=kg></option><option value=lbs></option><option value=m></option><option value=ft></option><option value=l></option><option value=gal></option><option value=box></option><option value=pack></option></select></div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div></div><div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div><div></div></div><div><div><label></label><input type=number min=0 step=1></div><div><label></label><input type=number min=1 step=1></div></div><div>"),zC=z("<div>");const su=t=>{const{t:e}=ot(),[r,n]=ye(""),[i,o]=ye(""),[a,c]=ye(""),[u,h]=ye(""),[f,p]=ye("pcs"),[_,C]=ye(0),[N,E]=ye(0),[T,x]=ye(10),[q,ee]=ye(100),[Y,ue]=ye(""),ie=()=>{n(""),o(""),c(""),h(""),p("pcs"),C(0),E(0),x(10),ee(100),ue("")},I=$=>{if($.preventDefault(),ue(""),!r().trim()){ue(e("forms.productNameRequired"));return}if(!i().trim()){ue(e("forms.skuRequired"));return}if(!u().trim()){ue(e("forms.categoryRequired"));return}if(_()<0){ue(e("forms.unitCostNotNegative"));return}if(N()<0){ue(e("forms.sellingPriceNotNegative"));return}if(T()<0){ue(e("forms.minStockNotNegative"));return}if(q()<=T()){ue(e("forms.maxStockGreaterThanMin"));return}if(Re.getProductsBySku(i()).length>0){ue(e("forms.skuAlreadyExists"));return}const k={name:r().trim(),sku:i().trim().toUpperCase(),description:a().trim(),category:u().trim(),unitOfMeasure:f(),unitCost:_(),sellingPrice:N(),minStockLevel:T(),maxStockLevel:q(),isActive:!0,businessId:"default-business"};Re.addProduct(k);const F=`prod-${Date.now()}`;t.onProductAdded&&t.onProductAdded(F),ie(),t.onClose()},b=()=>{ie(),t.onClose()},v={"margin-bottom":"1.5rem"},P={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},w={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},A={...w,cursor:"pointer"},y={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},de={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},H={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"};return S(mr,{get isOpen(){return t.isOpen},onClose:b,get title(){return e("inventory.addNewProduct")},get children(){var $=jC(),Z=$.firstChild,k=Z.firstChild,F=k.firstChild,B=k.nextSibling,W=Z.nextSibling,fe=W.firstChild,K=fe.firstChild,he=K.firstChild,D=K.nextSibling,U=fe.nextSibling,Q=U.firstChild,J=Q.firstChild,ce=Q.nextSibling,oe=W.nextSibling,O=oe.firstChild,re=O.nextSibling,pe=oe.nextSibling,ve=pe.firstChild,te=ve.firstChild,se=te.nextSibling,R=se.firstChild,M=R.nextSibling,V=M.nextSibling,ge=V.nextSibling,le=ge.nextSibling,j=le.nextSibling,G=j.nextSibling,Pe=G.nextSibling,_e=Pe.nextSibling,ae=ve.nextSibling,be=ae.firstChild,X=be.nextSibling,Ce=pe.nextSibling,$e=Ce.firstChild,Ee=$e.firstChild,xe=Ee.nextSibling,Oe=Ce.nextSibling,He=Oe.firstChild,je=He.firstChild,Ie=je.nextSibling,Be=He.nextSibling,We=Be.firstChild,ze=We.nextSibling,Ge=Oe.nextSibling;return $.addEventListener("submit",I),s(k,()=>e("inventory.productName"),F),B.addEventListener("change",Ae=>n(Ae.target.value)),s(K,()=>e("inventory.sku"),he),D.addEventListener("change",Ae=>o(Ae.target.value)),s(Q,()=>e("inventory.category"),J),ce.addEventListener("change",Ae=>h(Ae.target.value)),s(O,()=>e("common.description")),re.addEventListener("change",Ae=>c(Ae.target.value)),s(te,()=>e("inventory.unitOfMeasure")),se.addEventListener("change",Ae=>p(Ae.target.value)),s(R,()=>e("inventory.pieces")),s(M,()=>e("inventory.kilograms")),s(V,()=>e("inventory.pounds")),s(ge,()=>e("inventory.meters")),s(le,()=>e("inventory.feet")),s(j,()=>e("inventory.liters")),s(G,()=>e("inventory.gallons")),s(Pe,()=>e("inventory.boxes")),s(_e,()=>e("inventory.packs")),s(be,()=>e("inventory.unitCost")),X.addEventListener("change",Ae=>C(Number(Ae.target.value))),s(Ee,()=>e("inventory.sellingPrice")),xe.addEventListener("change",Ae=>E(Number(Ae.target.value))),s(je,()=>e("inventory.minimumStockLevel")),Ie.addEventListener("change",Ae=>x(Number(Ae.target.value))),s(We,()=>e("inventory.maximumStockLevel")),ze.addEventListener("change",Ae=>ee(Number(Ae.target.value))),s($,(()=>{var Ae=me(()=>!!Y());return()=>Ae()&&(()=>{var nt=zC();return d(nt,y),s(nt,Y),nt})()})(),Ge),d(Ge,de),s(Ge,S(De,{variant:"secondary",type:"button",onClick:b,get children(){return e("common.cancel")}}),null),s(Ge,S(De,{variant:"primary",type:"submit",get children(){return e("inventory.addProduct")}}),null),ne(Ae=>{var nt=v,et=P,dt=w,xt=e("inventory.enterProductName"),Tt=H,Gt=P,vt=w,tr=e("inventory.enterSkuCode"),yt=P,At=w,qt=e("inventory.enterCategory"),Ot=v,Le=P,Fe={...w,"min-height":"80px",resize:"vertical"},Ke=e("inventory.enterProductDescription"),st=H,Vt=P,Je=A,gt=P,Pt=w,ct=H,It=P,Cr=w,$t=H,jt=P,fr=w,kt=P,Qt=w;return Ae.e=d(Z,nt,Ae.e),Ae.t=d(k,et,Ae.t),Ae.a=d(B,dt,Ae.a),xt!==Ae.o&&lt(B,"placeholder",Ae.o=xt),Ae.i=d(W,Tt,Ae.i),Ae.n=d(K,Gt,Ae.n),Ae.s=d(D,vt,Ae.s),tr!==Ae.h&&lt(D,"placeholder",Ae.h=tr),Ae.r=d(Q,yt,Ae.r),Ae.d=d(ce,At,Ae.d),qt!==Ae.l&&lt(ce,"placeholder",Ae.l=qt),Ae.u=d(oe,Ot,Ae.u),Ae.c=d(O,Le,Ae.c),Ae.w=d(re,Fe,Ae.w),Ke!==Ae.m&&lt(re,"placeholder",Ae.m=Ke),Ae.f=d(pe,st,Ae.f),Ae.y=d(te,Vt,Ae.y),Ae.g=d(se,Je,Ae.g),Ae.p=d(be,gt,Ae.p),Ae.b=d(X,Pt,Ae.b),Ae.T=d(Ce,ct,Ae.T),Ae.A=d(Ee,It,Ae.A),Ae.O=d(xe,Cr,Ae.O),Ae.I=d(Oe,$t,Ae.I),Ae.S=d(je,jt,Ae.S),Ae.W=d(Ie,fr,Ae.W),Ae.C=d(We,kt,Ae.C),Ae.B=d(ze,Qt,Ae.B),Ae},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),ne(()=>B.value=r()),ne(()=>D.value=i()),ne(()=>ce.value=u()),ne(()=>re.value=a()),ne(()=>se.value=f()),ne(()=>X.value=_()),ne(()=>xe.value=N()),ne(()=>Ie.value=T()),ne(()=>ze.value=q()),$}})};var qC=z('<form><div><label> *</label><input type=text required></div><div><div><label> *<button type=button title="Generate code automatically"></button></label><input type=text required><div></div></div><div><label> *</label><select required><option value=warehouse> </option><option value=store> </option><option value=supplier> </option><option value=customer> </option></select><div></div></div></div><div><label> *</label><textarea required></textarea></div><div>'),HC=z("<div><div>:</div><div><span></span><div><div></div><div>"),WC=z("<div>");const au=t=>{const{t:e}=ot(),[r,n]=ye(""),[i,o]=ye(""),[a,c]=ye("warehouse"),[u,h]=ye(""),[f,p]=ye(""),_=()=>{n(""),o(""),c("warehouse"),h(""),p("")},C=()=>{if(r()){const w=a()==="warehouse"?"WH":a()==="store"?"ST":a()==="supplier"?"SUP":"CUST",A=r().toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,3),y=String(Math.floor(Math.random()*1e3)).padStart(3,"0");o(`${w}-${A}-${y}`)}},N=w=>{if(w.preventDefault(),p(""),!r().trim()){p(e("forms.locationNameRequired"));return}if(!i().trim()){p(e("forms.locationCodeRequired"));return}if(!u().trim()){p(e("forms.addressRequired"));return}if(Re.locations.filter(H=>H.code.toLowerCase()===i().toLowerCase()).length>0){p(e("forms.locationCodeExists"));return}const y={name:r().trim(),code:i().trim().toUpperCase(),type:a(),address:u().trim(),isActive:!0};Re.addLocation(y);const de=`loc-${Date.now()}`;t.onLocationAdded&&t.onLocationAdded(de),_(),t.onClose()},E=()=>{_(),t.onClose()},T={"margin-bottom":"1.5rem"},x={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},q={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},ee={...q,cursor:"pointer"},Y={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},ue={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ie={display:"grid","grid-template-columns":"2fr 1fr",gap:"1rem"},I={"font-size":"0.875rem",color:"var(--text-muted)","margin-top":"0.25rem"},b={padding:"0.25rem 0.5rem","font-size":"0.75rem","margin-left":"0.5rem",background:"var(--background-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",color:"var(--text-muted)"},v=w=>({warehouse:"🏭",store:"🏪",supplier:"🚚",customer:"👥"})[w]||"📍",P=w=>({warehouse:e("inventory.warehouseDescription"),store:e("inventory.storeDescription"),supplier:e("inventory.supplierDescription"),customer:e("inventory.customerDescription")})[w]||"";return S(mr,{get isOpen(){return t.isOpen},onClose:E,get title(){return e("inventory.addNewLocation")},get children(){var w=qC(),A=w.firstChild,y=A.firstChild,de=y.firstChild,H=y.nextSibling,$=A.nextSibling,Z=$.firstChild,k=Z.firstChild,F=k.firstChild,B=F.nextSibling,W=k.nextSibling,fe=W.nextSibling,K=Z.nextSibling,he=K.firstChild,D=he.firstChild,U=he.nextSibling,Q=U.firstChild,J=Q.firstChild,ce=Q.nextSibling,oe=ce.firstChild,O=ce.nextSibling,re=O.firstChild,pe=O.nextSibling,ve=pe.firstChild,te=U.nextSibling,se=$.nextSibling,R=se.firstChild,M=R.firstChild,V=R.nextSibling,ge=se.nextSibling;return w.addEventListener("submit",N),s(y,()=>e("inventory.locationName"),de),H.addEventListener("change",le=>n(le.target.value)),d($,ie),s(k,()=>e("inventory.locationCode"),F),B.$$click=C,d(B,b),s(B,()=>e("common.generate")),W.addEventListener("change",le=>o(le.target.value)),s(fe,()=>e("inventory.uniqueIdentifierHelp")),s(he,()=>e("inventory.locationType"),D),U.addEventListener("change",le=>c(le.target.value)),s(Q,()=>v("warehouse"),J),s(Q,()=>e("inventory.warehouse"),null),s(ce,()=>v("store"),oe),s(ce,()=>e("inventory.store"),null),s(O,()=>v("supplier"),re),s(O,()=>e("inventory.supplier"),null),s(pe,()=>v("customer"),ve),s(pe,()=>e("inventory.customer"),null),s(te,()=>P(a())),s(R,()=>e("common.address"),M),V.addEventListener("change",le=>h(le.target.value)),s(w,(()=>{var le=me(()=>!!r());return()=>le()&&(()=>{var j=HC(),G=j.firstChild,Pe=G.firstChild,_e=G.nextSibling,ae=_e.firstChild,be=ae.nextSibling,X=be.firstChild,Ce=X.nextSibling;return j.style.setProperty("padding","1rem"),j.style.setProperty("background","var(--background-color)"),j.style.setProperty("border-radius","var(--border-radius-sm)"),j.style.setProperty("border","1px solid var(--border-color)"),j.style.setProperty("margin-bottom","1rem"),G.style.setProperty("font-weight","500"),G.style.setProperty("margin-bottom","0.5rem"),s(G,()=>e("common.preview"),Pe),_e.style.setProperty("display","flex"),_e.style.setProperty("align-items","center"),_e.style.setProperty("gap","0.5rem"),ae.style.setProperty("font-size","1.2rem"),s(ae,()=>v(a())),X.style.setProperty("font-weight","600"),s(X,r),Ce.style.setProperty("font-size","0.875rem"),Ce.style.setProperty("color","var(--text-muted)"),s(Ce,(()=>{var $e=me(()=>!!i());return()=>$e()&&`${i()} • `})(),null),s(Ce,a,null),j})()})(),ge),s(w,(()=>{var le=me(()=>!!f());return()=>le()&&(()=>{var j=WC();return d(j,Y),s(j,f),j})()})(),ge),d(ge,ue),s(ge,S(De,{variant:"secondary",type:"button",onClick:E,get children(){return e("common.cancel")}}),null),s(ge,S(De,{variant:"primary",type:"submit",get children(){return e("inventory.addLocation")}}),null),ne(le=>{var j=T,G=x,Pe=q,_e=e("inventory.enterLocationName"),ae=x,be=q,X=e("inventory.enterUniqueCode"),Ce=I,$e=x,Ee=ee,xe=I,Oe=T,He=x,je={...q,"min-height":"100px",resize:"vertical"},Ie=e("inventory.enterCompleteAddress");return le.e=d(A,j,le.e),le.t=d(y,G,le.t),le.a=d(H,Pe,le.a),_e!==le.o&&lt(H,"placeholder",le.o=_e),le.i=d(k,ae,le.i),le.n=d(W,be,le.n),X!==le.s&&lt(W,"placeholder",le.s=X),le.h=d(fe,Ce,le.h),le.r=d(he,$e,le.r),le.d=d(U,Ee,le.d),le.l=d(te,xe,le.l),le.u=d(se,Oe,le.u),le.c=d(R,He,le.c),le.w=d(V,je,le.w),Ie!==le.m&&lt(V,"placeholder",le.m=Ie),le},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),ne(()=>H.value=r()),ne(()=>W.value=i()),ne(()=>U.value=a()),ne(()=>V.value=u()),w}})};St(["click"]);var GC=z("<form><div>"),Ph=z("<div><label> *"),KC=z("<div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment>"),YC=z("<div><label>"),QC=z("<div><label> *</label><input type=number min=0 step=1 required>"),JC=z("<div><label></label><input type=number min=0 step=0.01>"),XC=z("<div><label></label><input type=text>"),ZC=z("<div><label></label><textarea>"),eA=z("<div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span>:</span><span> "),tA=z("<div><div><span>:</span><span>"),rA=z("<div>");const nA=t=>{const{t:e}=ot(),[r,n]=ye({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""}),[i,o]=ye(""),[a,c]=ye(""),[u,h]=ye("in"),[f,p]=ye(0),[_,C]=ye(0),[N,E]=ye(""),[T,x]=ye(""),[q,ee]=ye(""),[Y,ue]=ye(""),[ie,I]=ye(!1),[b,v]=ye(!1),P=()=>t.mode==="movement",w=qe(()=>i()?Re.getProductById(i()):null),A=qe(()=>a()?Re.getLocationById(a()):null),y=qe(()=>q()?Re.getLocationById(q()):null),de=qe(()=>f()*_()),H=qe(()=>!i()||!a()?0:Re.getStockByProductAndLocation(i(),a())?.quantity||0),$=[{value:"Electronics",label:"Electronics"},{value:"Accessories",label:"Accessories"},{value:"Furniture",label:"Furniture"},{value:"Office Supplies",label:"Office Supplies"},{value:"Software",label:"Software"},{value:"Hardware",label:"Hardware"},{value:"Consumables",label:"Consumables"}],Z=[{value:"Warehouse A",label:"Warehouse A"},{value:"Warehouse B",label:"Warehouse B"},{value:"Warehouse C",label:"Warehouse C"},{value:"Storage Room",label:"Storage Room"},{value:"Main Office",label:"Main Office"}],k={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},F=()=>{o(""),c(""),h("in"),p(0),C(0),E(""),x(""),ee(""),ue("")},B=()=>{n({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""})},W=pe=>{if(pe.preventDefault(),P()){if(ue(""),!i()){ue(e("forms.selectProduct"));return}if(!a()){ue(e("forms.selectLocation"));return}if(f()<=0){ue(e("forms.quantityGreaterThanZero"));return}if(_()<0){ue(e("forms.unitCostNotNegative"));return}if(u()==="transfer"&&!q()){ue(e("forms.selectFromLocation"));return}if(u()==="transfer"&&q()===a()){ue(e("forms.sameLocationError"));return}if(u()==="out"&&f()>H()){ue(e("forms.insufficientStock",{currentStock:H()}));return}const ve=w(),te=A(),se={productId:ve.id,productName:ve.name,productSku:ve.sku,locationId:te.id,locationName:te.name,movementType:u(),quantity:f(),unitCost:_()||ve.unitCost,totalCost:de()||f()*ve.unitCost,referenceNumber:N()||`AUTO-${Date.now()}`,notes:T(),createdBy:"admin",fromLocationId:u()==="transfer"?q():void 0,fromLocationName:u()==="transfer"?y()?.name:void 0};Re.addInventoryMovement(se),F()}else{const ve=r();if(!ve.name||!ve.price||!ve.quantity||!ve.category||!ve.sku||!ve.supplier||!ve.minStock||!ve.location){alert(e("forms.fillAllRequired"));return}const te={name:ve.name,price:parseFloat(ve.price),quantity:parseInt(ve.quantity),category:ve.category,description:ve.description,sku:ve.sku,supplier:ve.supplier,minStock:parseInt(ve.minStock),location:ve.location};Re.addItem(te),B()}t.onClose()},fe=(pe,ve)=>{n(te=>({...te,[pe]:ve}))},K=()=>{P()?F():B(),t.onClose()},he=pe=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(pe),D={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},U={...D,cursor:"pointer"},Q={color:"#f44336","font-size":"0.875rem","margin-top":"0.5rem"},J={padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},ce={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},oe={"font-weight":"500",color:"var(--text-muted)"},O={"font-weight":"600",color:"var(--text-primary)"},re=()=>P()?e("inventory.addMovement"):e("inventory.addNewItem");return S(mr,{get isOpen(){return t.isOpen},onClose:K,get title(){return re()},get children(){return[(()=>{var pe=GC(),ve=pe.firstChild;return pe.addEventListener("submit",W),s(pe,(()=>{var te=me(()=>!!P());return()=>te()?[(()=>{var se=Ph(),R=se.firstChild,M=R.firstChild;return se.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,()=>e("inventory.product"),M),s(se,S(Vy,{get value(){return i()},onChange:V=>{o(V);const ge=Re.getProductById(V);ge&&C(ge.unitCost)},get placeholder(){return e("inventory.searchProductsPlaceholder")},onAddNew:()=>I(!0),required:!0}),null),se})(),(()=>{var se=KC(),R=se.firstChild,M=R.firstChild,V=R.nextSibling,ge=V.firstChild,le=ge.nextSibling,j=le.nextSibling,G=j.nextSibling;return se.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,()=>e("inventory.movementType"),M),V.addEventListener("change",Pe=>h(Pe.target.value)),s(ge,()=>e("inventory.stockInPurchase")),s(le,()=>e("inventory.stockOutSale")),s(j,()=>e("inventory.transferBetween")),s(G,()=>e("inventory.stockAdjustment")),ne(Pe=>d(V,U,Pe)),ne(()=>V.value=u()),se})(),me(()=>me(()=>u()==="transfer")()&&(()=>{var se=Ph(),R=se.firstChild,M=R.firstChild;return se.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,()=>e("inventory.fromLocation"),M),s(se,S(Ea,{get value(){return q()},onChange:V=>ee(V),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>v(!0),required:!0}),null),se})()),(()=>{var se=YC(),R=se.firstChild;return se.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,(()=>{var M=me(()=>u()==="transfer");return()=>M()?e("inventory.toLocation")+" *":e("inventory.locationName")+" *"})()),s(se,S(Ea,{get value(){return a()},onChange:M=>c(M),get placeholder(){return me(()=>u()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>v(!0),required:!0}),null),se})(),me(()=>me(()=>!!(w()&&A()))()&&(()=>{var se=eA(),R=se.firstChild,M=R.firstChild,V=M.firstChild,ge=M.nextSibling,le=ge.firstChild,j=R.nextSibling,G=j.firstChild,Pe=G.firstChild,_e=G.nextSibling,ae=j.nextSibling,be=ae.firstChild,X=be.firstChild,Ce=be.nextSibling,$e=Ce.firstChild;return s(M,()=>e("inventory.currentStockAt",{location:A()?.name}),V),s(ge,H,le),s(ge,()=>w()?.unitOfMeasure,null),s(G,()=>e("inventory.productCost"),Pe),s(_e,()=>he(w()?.unitCost||0)),s(be,()=>e("inventory.minStockLevel"),X),s(Ce,()=>w()?.minStockLevel,$e),s(Ce,()=>w()?.unitOfMeasure,null),ne(Ee=>{var xe=J,Oe=ce,He=oe,je=O,Ie=ce,Be=oe,We=O,ze=ce,Ge=oe,Ae=O;return Ee.e=d(se,xe,Ee.e),Ee.t=d(R,Oe,Ee.t),Ee.a=d(M,He,Ee.a),Ee.o=d(ge,je,Ee.o),Ee.i=d(j,Ie,Ee.i),Ee.n=d(G,Be,Ee.n),Ee.s=d(_e,We,Ee.s),Ee.h=d(ae,ze,Ee.h),Ee.r=d(be,Ge,Ee.r),Ee.d=d(Ce,Ae,Ee.d),Ee},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),se})()),(()=>{var se=QC(),R=se.firstChild,M=R.firstChild,V=R.nextSibling;return se.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,()=>e("inventory.quantity"),M),V.addEventListener("change",ge=>p(Number(ge.target.value))),ne(ge=>d(V,D,ge)),ne(()=>V.value=f()),se})(),(()=>{var se=JC(),R=se.firstChild,M=R.nextSibling;return se.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,()=>e("inventory.unitCost")),M.addEventListener("change",V=>C(Number(V.target.value))),ne(V=>{var ge=D,le=e("inventory.willUseDefaultCost");return V.e=d(M,ge,V.e),le!==V.t&&lt(M,"placeholder",V.t=le),V},{e:void 0,t:void 0}),ne(()=>M.value=_()),se})(),me(()=>me(()=>f()>0&&_()>0)()&&(()=>{var se=tA(),R=se.firstChild,M=R.firstChild,V=M.firstChild,ge=M.nextSibling;return s(M,()=>e("inventory.totalCost"),V),s(ge,()=>he(de())),ne(le=>{var j=J,G=ce,Pe=oe,_e={...O,"font-size":"1.2rem",color:"var(--primary-color)"};return le.e=d(se,j,le.e),le.t=d(R,G,le.t),le.a=d(M,Pe,le.a),le.o=d(ge,_e,le.o),le},{e:void 0,t:void 0,a:void 0,o:void 0}),se})()),(()=>{var se=XC(),R=se.firstChild,M=R.nextSibling;return se.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,()=>e("common.referenceNumber")),M.addEventListener("change",V=>E(V.target.value)),ne(V=>{var ge=D,le=e("common.referenceNumberPlaceholder");return V.e=d(M,ge,V.e),le!==V.t&&lt(M,"placeholder",V.t=le),V},{e:void 0,t:void 0}),ne(()=>M.value=N()),se})(),(()=>{var se=ZC(),R=se.firstChild,M=R.nextSibling;return se.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),s(R,()=>e("common.notes")),M.addEventListener("change",V=>x(V.target.value)),ne(V=>{var ge={...D,"min-height":"100px",resize:"vertical"},le=e("inventory.additionalNotesPlaceholder");return V.e=d(M,ge,V.e),le!==V.t&&lt(M,"placeholder",V.t=le),V},{e:void 0,t:void 0}),ne(()=>M.value=T()),se})(),me(()=>me(()=>!!Y())()&&(()=>{var se=rA();return d(se,Q),s(se,Y),se})())]:[S(_t,{get label(){return e("inventory.itemName")},get value(){return r().name},onChange:se=>fe("name",se),get placeholder(){return e("inventory.enterItemName")},required:!0}),S(_t,{get label(){return e("inventory.sku")},get value(){return r().sku},onChange:se=>fe("sku",se),get placeholder(){return e("inventory.enterSkuCode")},required:!0}),S(dr,{get label(){return e("inventory.category")},get value(){return r().category},onChange:se=>fe("category",se),options:$,required:!0}),S(_t,{get label(){return e("common.description")},get value(){return r().description},onChange:se=>fe("description",se),get placeholder(){return e("inventory.enterItemDescription")}}),S(_t,{get label(){return e("common.price")},type:"number",get value(){return r().price},onChange:se=>fe("price",se),get placeholder(){return e("common.enterPrice")},required:!0}),S(_t,{get label(){return e("inventory.quantity")},type:"number",get value(){return r().quantity},onChange:se=>fe("quantity",se),get placeholder(){return e("inventory.enterQuantity")},required:!0}),S(_t,{get label(){return e("inventory.minimumStock")},type:"number",get value(){return r().minStock},onChange:se=>fe("minStock",se),get placeholder(){return e("inventory.enterMinStockLevel")},required:!0}),S(_t,{get label(){return e("inventory.supplier")},get value(){return r().supplier},onChange:se=>fe("supplier",se),get placeholder(){return e("inventory.enterSupplierName")},required:!0}),S(dr,{get label(){return e("inventory.location")},get value(){return r().location},onChange:se=>fe("location",se),options:Z,required:!0})]})(),ve),d(ve,k),s(ve,S(De,{variant:"secondary",type:"button",onClick:K,get children(){return e("common.cancel")}}),null),s(ve,S(De,{variant:"primary",type:"submit",get children(){return me(()=>!!P())()?e("inventory.addMovement"):e("inventory.addItem")}}),null),pe})(),S(su,{get isOpen(){return ie()},onClose:()=>I(!1),onProductAdded:pe=>{o(pe),I(!1)}}),S(au,{get isOpen(){return b()},onClose:()=>v(!1),onLocationAdded:pe=>{u()==="transfer"&&!q()?ee(pe):c(pe),v(!1)}})]}})};St(["input","keydown"]);var iA=z("<form><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text required></div></div><div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><div><label></label></div></div><div><div><h3></h3></div></div><div><label></label><textarea></textarea></div><div>"),oA=z("<div><label> *"),sA=z("<div><div></div><div></div><div></div><div></div><div>"),pl=z("<div>"),aA=z("<div><input type=number min=0 step=1 required><input type=number min=0 step=0.01><input type=text>"),lA=z("<div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span>"),cA=z("<div>• ");const uA=t=>{const{t:e}=ot(),[r,n]=ye(`INV-${Date.now()}`),[i,o]=ye(""),[a,c]=ye("in"),[u,h]=ye(""),[f,p]=ye(""),[_,C]=ye(""),[N,E]=ye([]),[T,x]=ye([]),[q,ee]=ye(!1),[Y,ue]=ye(!1),ie=()=>{E(J=>[...J,{productId:"",quantity:0,unitCost:0,notes:""}])},I=J=>{E(ce=>ce.filter((oe,O)=>O!==J))},b=(J,ce,oe)=>{E(O=>O.map((re,pe)=>pe===J?{...re,[ce]:oe}:re))},v=()=>{n(`INV-${Date.now()}`),o(""),c("in"),h(""),p(""),C(""),E([]),x([])},P=async J=>{J.preventDefault(),x([]);const ce=[];if(i()||ce.push(e("forms.referenceNumberRequired")),u()||ce.push(e("forms.locationRequired")),a()==="transfer"&&!f()&&ce.push(e("forms.fromLocationRequired")),N().length===0&&ce.push(e("forms.atLeastOneProduct")),N().forEach((re,pe)=>{re.productId||ce.push(e("forms.itemProductRequired","Product is required for item {{index}}",{index:pe+1})),re.quantity<=0&&ce.push(e("forms.itemQuantityRequired","Quantity must be greater than 0 for item {{index}}",{index:pe+1}))}),ce.length>0){x(ce);return}const oe={ssg_inventory_key:js(),invoiceId:r(),referenceNumber:i(),movementType:a(),type:Ll(a()),locationId:u(),fromLocationId:a()==="transfer"?f():void 0,items:N(),products:N(),generalNotes:_(),description:_(),invoice:i(),store:u(),createdBy:"admin",createDate:new Date().toISOString()};console.log(oe);const O=await Re.addBulkInventoryMovements(oe);console.log(O),O.success?(v(),t.onClose()):x(O.errors)},w=()=>{v(),t.onClose()},A=qe(()=>N().reduce((J,ce)=>{const oe=Re.getProductById(ce.productId),O=ce.unitCost||oe?.unitCost||0;return J+ce.quantity*O},0)),y=qe(()=>N().reduce((J,ce)=>J+ce.quantity,0)),de={"margin-bottom":"1.5rem"},H={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},$={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},Z={...$,cursor:"pointer"},k={display:"grid",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},F={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},B={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem","padding-left":"0.75rem"},W={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},fe={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},K={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},he={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},D=J=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(J),U=J=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[J]||J,Q=async J=>{await Re.fecthInventory(J),await Re.fecthProduct(J)};return cn(()=>{Q("prod")}),S(mr,{get isOpen(){return t.isOpen},onClose:w,get title(){return e("inventory.bulkMovement")},get children(){return[(()=>{var J=iA(),ce=J.firstChild,oe=ce.firstChild,O=oe.firstChild,re=O.firstChild,pe=O.nextSibling,ve=oe.nextSibling,te=ve.firstChild,se=te.firstChild,R=te.nextSibling,M=ce.nextSibling,V=M.firstChild,ge=V.firstChild,le=V.nextSibling,j=le.firstChild,G=j.nextSibling,Pe=G.nextSibling,_e=Pe.nextSibling,ae=M.nextSibling,be=ae.firstChild,X=be.firstChild,Ce=ae.nextSibling,$e=Ce.firstChild,Ee=$e.firstChild,xe=Ce.nextSibling,Oe=xe.firstChild,He=Oe.nextSibling,je=xe.nextSibling;return J.addEventListener("submit",P),ce.style.setProperty("display","grid"),ce.style.setProperty("grid-template-columns","1fr 1fr"),ce.style.setProperty("gap","1rem"),ce.style.setProperty("margin-bottom","1.5rem"),s(O,()=>e("common.invoiceDocumentId"),re),pe.addEventListener("change",Ie=>n(Ie.target.value)),s(te,()=>e("common.referenceNumber"),se),R.addEventListener("change",Ie=>o(Ie.target.value)),s(V,()=>e("inventory.movementType"),ge),le.addEventListener("change",Ie=>c(Ie.target.value)),s(j,()=>e("inventory.purchaseReceive")),s(G,()=>e("inventory.saleIssue")),s(Pe,()=>e("inventory.transfer")),s(_e,()=>e("inventory.adjustment")),ae.style.setProperty("display","grid"),ae.style.setProperty("gap","1rem"),ae.style.setProperty("margin-bottom","1.5rem"),s(ae,(()=>{var Ie=me(()=>a()==="transfer");return()=>Ie()&&(()=>{var Be=oA(),We=Be.firstChild,ze=We.firstChild;return s(We,()=>e("inventory.fromLocation"),ze),s(Be,S(Ea,{get value(){return f()},onChange:Ge=>p(Ge),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>ue(!0),required:!0}),null),ne(Ge=>d(We,H,Ge)),Be})()})(),be),s(X,(()=>{var Ie=me(()=>a()==="transfer");return()=>Ie()?e("inventory.toLocation")+" *":e("inventory.location")+" *"})()),s(be,S(Ea,{get value(){return u()},onChange:Ie=>h(Ie),get placeholder(){return me(()=>a()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>ue(!0),required:!0}),null),$e.style.setProperty("display","flex"),$e.style.setProperty("justify-content","space-between"),$e.style.setProperty("align-items","center"),$e.style.setProperty("margin-bottom","1rem"),Ee.style.setProperty("margin","0"),Ee.style.setProperty("font-size","1.1rem"),s(Ee,()=>e("inventory.products")),s($e,S(De,{variant:"outline",type:"button",onClick:ie,get children(){return e("inventory.addProduct")}}),null),s(Ce,(()=>{var Ie=me(()=>N().length>0);return()=>Ie()&&[(()=>{var Be=sA(),We=Be.firstChild,ze=We.nextSibling,Ge=ze.nextSibling,Ae=Ge.nextSibling;return d(Be,B),s(We,()=>e("inventory.product")),s(ze,()=>e("inventory.quantity")),s(Ge,()=>e("inventory.unitCost")),s(Ae,()=>e("common.notes")),Be})(),S(Mt,{get each(){return N()},children:(Be,We)=>[(()=>{var ze=pl();return d(ze,k),s(ze,S(Vy,{get value(){return Be.productId},onChange:Ge=>{b(We(),"productId",Ge.id);let Ae={id:Ge.id,label:Ge.name,code:Ge.sku};b(We(),"product",Ae);const nt=Re.getProductById(Ge.id);nt&&!Be.unitCost&&b(We(),"unitCost",nt.unitCost)},get placeholder(){return e("inventory.searchProduct")},onAddNew:()=>ee(!0),required:!0})),ze})(),(()=>{var ze=aA(),Ge=ze.firstChild,Ae=Ge.nextSibling,nt=Ae.nextSibling;return d(ze,F),Ge.addEventListener("change",et=>b(We(),"quantity",Number(et.target.value))),Ae.addEventListener("change",et=>b(We(),"unitCost",Number(et.target.value))),nt.addEventListener("change",et=>b(We(),"notes",et.target.value)),s(ze,S(De,{variant:"outline",size:"sm",type:"button",onClick:()=>I(We()),style:{color:"#f44336","border-color":"#f44336"},get children(){return e("common.remove")}}),null),ne(et=>{var dt=$,xt=$,Tt=e("common.auto"),Gt=$,vt=e("common.optionalNotes");return et.e=d(Ge,dt,et.e),et.t=d(Ae,xt,et.t),Tt!==et.a&&lt(Ae,"placeholder",et.a=Tt),et.o=d(nt,Gt,et.o),vt!==et.i&&lt(nt,"placeholder",et.i=vt),et},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ne(()=>Ge.value=Be.quantity),ne(()=>Ae.value=Be.unitCost),ne(()=>nt.value=Be.notes),ze})()]})]})(),null),s(Ce,(()=>{var Ie=me(()=>N().length===0);return()=>Ie()&&(()=>{var Be=pl();return Be.style.setProperty("text-align","center"),Be.style.setProperty("padding","2rem"),Be.style.setProperty("background","var(--background-color)"),Be.style.setProperty("border-radius","var(--border-radius-sm)"),Be.style.setProperty("border","1px solid var(--border-color)"),Be.style.setProperty("color","var(--text-muted)"),s(Be,()=>e("inventory.noProductsAdded")),Be})()})(),null),s(J,(()=>{var Ie=me(()=>N().length>0);return()=>Ie()&&(()=>{var Be=lA(),We=Be.firstChild,ze=We.nextSibling,Ge=ze.firstChild,Ae=Ge.firstChild,nt=Ge.nextSibling,et=ze.nextSibling,dt=et.firstChild,xt=dt.firstChild,Tt=dt.nextSibling,Gt=et.nextSibling,vt=Gt.firstChild,tr=vt.firstChild,yt=vt.nextSibling,At=Gt.nextSibling,qt=At.firstChild,Ot=qt.firstChild,Le=qt.nextSibling;return d(Be,W),We.style.setProperty("margin","0 0 1rem 0"),We.style.setProperty("font-size","1rem"),s(We,()=>e("common.summary")),s(Ge,()=>e("inventory.totalProducts"),Ae),nt.style.setProperty("font-weight","600"),s(nt,()=>N().length),s(dt,()=>e("inventory.totalItems"),xt),Tt.style.setProperty("font-weight","600"),s(Tt,y),s(vt,()=>e("inventory.totalValue"),tr),yt.style.setProperty("font-weight","600"),yt.style.setProperty("color","var(--primary-color)"),s(yt,()=>D(A())),s(qt,()=>e("inventory.movementType"),Ot),Le.style.setProperty("font-weight","600"),s(Le,()=>U(a())),ne(Fe=>{var Ke=fe,st=fe,Vt=fe,Je=fe;return Fe.e=d(ze,Ke,Fe.e),Fe.t=d(et,st,Fe.t),Fe.a=d(Gt,Vt,Fe.a),Fe.o=d(At,Je,Fe.o),Fe},{e:void 0,t:void 0,a:void 0,o:void 0}),Be})()})(),xe),s(Oe,()=>e("common.generalNotes")),He.addEventListener("change",Ie=>C(Ie.target.value)),s(J,(()=>{var Ie=me(()=>T().length>0);return()=>Ie()&&(()=>{var Be=pl();return d(Be,K),s(Be,S(Mt,{get each(){return T()},children:We=>(()=>{var ze=cA();return ze.firstChild,s(ze,We,null),ze})()})),Be})()})(),je),d(je,he),s(je,S(De,{variant:"secondary",type:"button",onClick:w,get children(){return e("common.cancel")}}),null),s(je,S(De,{variant:"primary",type:"submit",get children(){return e("inventory.createMovement")}}),null),ne(Ie=>{var Be=H,We=$,ze=H,Ge=$,Ae=e("common.referenceNumberPlaceholder"),nt=de,et=H,dt=Z,xt=a()==="transfer"?"1fr 1fr":"1fr",Tt=H,Gt=de,vt=de,tr=H,yt={...$,"min-height":"80px",resize:"vertical"},At=e("inventory.generalNotesPlaceholder");return Ie.e=d(O,Be,Ie.e),Ie.t=d(pe,We,Ie.t),Ie.a=d(te,ze,Ie.a),Ie.o=d(R,Ge,Ie.o),Ae!==Ie.i&&lt(R,"placeholder",Ie.i=Ae),Ie.n=d(M,nt,Ie.n),Ie.s=d(V,et,Ie.s),Ie.h=d(le,dt,Ie.h),xt!==Ie.r&&((Ie.r=xt)!=null?ae.style.setProperty("grid-template-columns",xt):ae.style.removeProperty("grid-template-columns")),Ie.d=d(X,Tt,Ie.d),Ie.l=d(Ce,Gt,Ie.l),Ie.u=d(xe,vt,Ie.u),Ie.c=d(Oe,tr,Ie.c),Ie.w=d(He,yt,Ie.w),At!==Ie.m&&lt(He,"placeholder",Ie.m=At),Ie},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),ne(()=>pe.value=r()),ne(()=>R.value=i()),ne(()=>le.value=a()),ne(()=>He.value=_()),J})(),S(su,{get isOpen(){return q()},onClose:()=>ee(!1),onProductAdded:J=>{ee(!1)}}),S(au,{get isOpen(){return Y()},onClose:()=>ue(!1),onLocationAdded:J=>{a()==="transfer"&&!f()?p(J):h(J),ue(!1)}})]}})};var dA=z("<div><div></div><div></div><div></div><div>"),hA=z("<div><strong>:</strong> "),mA=z("<div><div><span></span><span></span></div><div><span></span><span> </span></div><div><span></span><span> </span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),fA=z("<div>");const yA=t=>{const{t:e}=ot(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={"text-align":"center","margin-bottom":"2rem"},a={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},c={color:"var(--text-muted)","font-size":"1rem"},u={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"1rem"},h=(E,T)=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:E>T?"#d4edda":"#f8d7da",color:E>T?"#155724":"#721c24"}),f={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},p={"margin-bottom":"1.5rem",padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",color:"var(--text-secondary)"};if(!t.item)return null;const _=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E),C=E=>new Date(E).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),N=t.item.price*t.item.quantity;return S(mr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.itemDetails")},get children(){return[(()=>{var E=dA(),T=E.firstChild,x=T.nextSibling,q=x.nextSibling,ee=q.nextSibling;return d(E,o),d(T,a),s(T,()=>t.item.name),d(x,c),s(x,()=>t.item.category),d(q,u),s(q,()=>_(t.item.price)),s(ee,(()=>{var Y=me(()=>t.item.quantity>t.item.minStock);return()=>Y()?e("inventory.inStock"):e("inventory.lowStockAlert")})()),ne(Y=>d(ee,h(t.item.quantity,t.item.minStock),Y)),E})(),(()=>{var E=hA(),T=E.firstChild,x=T.firstChild;return T.nextSibling,d(E,p),s(T,()=>e("common.description"),x),s(E,()=>t.item.description,null),E})(),(()=>{var E=mA(),T=E.firstChild,x=T.firstChild,q=x.nextSibling,ee=T.nextSibling,Y=ee.firstChild,ue=Y.nextSibling,ie=ue.firstChild,I=ee.nextSibling,b=I.firstChild,v=b.nextSibling,P=v.firstChild,w=I.nextSibling,A=w.firstChild,y=A.nextSibling,de=w.nextSibling,H=de.firstChild,$=H.nextSibling,Z=de.nextSibling,k=Z.firstChild,F=k.nextSibling,B=Z.nextSibling,W=B.firstChild,fe=W.nextSibling;return s(x,()=>e("inventory.sku")),s(q,()=>t.item.sku),s(Y,()=>e("inventory.quantity")),s(ue,()=>t.item.quantity,ie),s(ue,()=>e("common.units"),null),s(b,()=>e("inventory.minimumStock")),s(v,()=>t.item.minStock,P),s(v,()=>e("common.units"),null),s(A,()=>e("inventory.totalValue")),s(y,()=>_(N)),s(H,()=>e("inventory.supplier")),s($,()=>t.item.supplier),s(k,()=>e("inventory.location")),s(F,()=>t.item.location),s(W,()=>e("common.lastUpdated")),s(fe,()=>C(t.item.lastUpdated)),ne(K=>{var he=r,D=n,U=i,Q=r,J=n,ce=i,oe=r,O=n,re=i,pe=r,ve=n,te=i,se=r,R=n,M=i,V=r,ge=n,le=i,j=r,G=n,Pe=i;return K.e=d(T,he,K.e),K.t=d(x,D,K.t),K.a=d(q,U,K.a),K.o=d(ee,Q,K.o),K.i=d(Y,J,K.i),K.n=d(ue,ce,K.n),K.s=d(I,oe,K.s),K.h=d(b,O,K.h),K.r=d(v,re,K.r),K.d=d(w,pe,K.d),K.l=d(A,ve,K.l),K.u=d(y,te,K.u),K.c=d(de,se,K.c),K.w=d(H,R,K.w),K.m=d($,M,K.m),K.f=d(Z,V,K.f),K.y=d(k,ge,K.y),K.g=d(F,le,K.g),K.p=d(B,j,K.p),K.b=d(W,G,K.b),K.T=d(fe,Pe,K.T),K},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),E})(),(()=>{var E=fA();return d(E,f),s(E,S(De,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(E,S(De,{variant:"primary",onClick:()=>{console.log("Edit item:",t.item.id)},get children(){return e("common.editItem")}}),null),E})()]}})};var gA=z("<div>🔄"),pA=z("<button type=button>×"),vA=z("<div>⚠️ "),wh=z("<div>"),bA=z("<div><div><input type=text autocomplete=off>"),_A=z("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>"),SA=z("<span>⚠️ ");const PA=t=>{const{t:e}=ot(),[r,n]=ye(""),[i,o]=ye(!1),[a,c]=ye(null),[u,h]=ye([]),[f,p]=ye(!1),[_,C]=ye(-1),[N,E]=ye(null),T=t.searchDelay||300;t.maxResults;const x=async he=>{if(!he.trim()||he.trim().length<3){h([]),t.onSearchResults?.([]);return}try{o(!0),c(null);try{console.log("apiResults",he),t.onSearchResults?.(he)}catch(D){console.warn("API search failed, using local fallback:",D),c("API search failed, showing local results")}}catch(D){const U=D instanceof Error?D.message:"Search failed";c(U),h([]),t.onSearchResults?.([])}finally{o(!1)}},q=he=>{const U=he.target.value;n(U),c(null),console.log(),t.showResults,N()&&clearTimeout(N());const Q=setTimeout(()=>{x(U)},T);E(Q)},ee=he=>{n(he.name),p(!1),C(-1),t.onInventorySelect?.(he)},Y=he=>{if(!(!f()||u().length===0))switch(he.key){case"ArrowDown":he.preventDefault(),C(D=>Math.min(D+1,u().length-1));break;case"ArrowUp":he.preventDefault(),C(D=>Math.max(D-1,-1));break;case"Enter":he.preventDefault(),_()>=0&&u()[_()]&&ee(u()[_()]);break;case"Escape":p(!1),C(-1);break}},ue=()=>{t.showResults!==!1&&u().length>0&&p(!0)},ie=()=>{setTimeout(()=>{p(!1),C(-1)},150)},I=()=>{n(""),h([]),c(null),p(!1),C(-1),t.onSearchResults?.([]),N()&&(clearTimeout(N()),E(null))},b=he=>Re.stockLevels.filter(D=>D.inventoryId===he).reduce((D,U)=>D+U.quantity,0),v=he=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(he),P={position:"relative",width:"100%",...t.style},w={position:"relative",display:"flex","align-items":"center"},A={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},y={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},de={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},H={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},$=he=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:he?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),Z={display:"flex","justify-content":"space-between","align-items":"center"},k={flex:"1"},F={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},B={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},W={"text-align":"right","font-size":"0.875rem"},fe={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},K={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var he=bA(),D=he.firstChild,U=D.firstChild;return U.addEventListener("blur",ie),U.addEventListener("focus",ue),U.$$keydown=Y,U.$$input=q,s(D,S(Ve,{get when(){return i()},get children(){var Q=gA();return ne(J=>d(Q,de,J)),Q}}),null),s(D,S(Ve,{get when(){return me(()=>!!r())()&&!i()},get children(){var Q=pA();return Q.addEventListener("mouseleave",J=>{J.currentTarget.style.background="none",J.currentTarget.style.color="var(--text-muted)"}),Q.addEventListener("mouseenter",J=>{J.currentTarget.style.background="var(--border-color)",J.currentTarget.style.color="var(--text-primary)"}),Q.$$click=I,ne(J=>{var ce=y,oe=e("common.clear","Clear search");return J.e=d(Q,ce,J.e),oe!==J.t&&lt(Q,"title",J.t=oe),J},{e:void 0,t:void 0}),Q}}),null),s(he,S(Ve,{get when(){return f()&&t.showResults!==!1},get children(){var Q=wh();return s(Q,S(Ve,{get when(){return a()},get children(){var J=vA();return J.firstChild,d(J,K),s(J,a,null),J}}),null),s(Q,S(Ve,{get when(){return u().length>0},get fallback(){return me(()=>!!(r()&&!i()))()&&(()=>{var J=wh();return d(J,fe),s(J,()=>e("inventory.noInventorysFound","No inventorys found matching your search.")),J})()},get children(){return S(Mt,{get each(){return u()},children:(J,ce)=>{const oe=b(J.id),O=oe<=J.minStockLevel;return(()=>{var re=_A(),pe=re.firstChild,ve=pe.firstChild,te=ve.firstChild,se=te.nextSibling,R=se.firstChild,M=R.firstChild,V=R.nextSibling,ge=V.nextSibling,le=ge.nextSibling,j=le.nextSibling,G=ve.nextSibling,Pe=G.firstChild,_e=Pe.firstChild,ae=Pe.nextSibling;return re.addEventListener("mouseenter",()=>C(ce())),re.$$click=()=>ee(J),d(pe,Z),d(ve,k),d(te,F),s(te,()=>J.name),d(se,B),s(R,()=>e("inventory.sku","SKU"),M),s(R,()=>J.sku,null),s(ge,()=>J.category),s(j,()=>v(J.unitCost)),d(G,W),Pe.style.setProperty("font-weight","600"),(O?"#f44336":"var(--text-primary)")!=null?Pe.style.setProperty("color",O?"#f44336":"var(--text-primary)"):Pe.style.removeProperty("color"),s(Pe,oe,_e),s(Pe,()=>J.unitOfMeasure,null),ae.style.setProperty("color","var(--text-muted)"),s(ae,()=>O?(()=>{var be=SA();return be.firstChild,be.style.setProperty("color","#f44336"),s(be,()=>e("inventory.lowStock","Low Stock"),null),be})():e("inventory.inStock","In Stock")),ne(be=>d(re,$(ce()===_()),be)),re})()}})}}),null),ne(J=>d(Q,H,J)),Q}}),null),ne(Q=>{var J=P,ce=w,oe=A,O=t.placeholder||e("inventory.searchInventorys","Search inventorys by name, SKU, or category..."),re=t.disabled;return Q.e=d(he,J,Q.e),Q.t=d(D,ce,Q.t),Q.a=d(U,oe,Q.a),O!==Q.o&&lt(U,"placeholder",Q.o=O),re!==Q.i&&(U.disabled=Q.i=re),Q},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ne(()=>U.value=r()),he})()};St(["input","keydown","click"]);var wA=z("<div>"),vl=z("<div><span>:</span><span>"),CA=z("<div><button> "),AA=z("<div><div><div><h3></h3><div>: </div></div><div><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span> <!>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span>");const IA=t=>{const{t:e}=ot(),r=C=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(C),n=C=>new Date(C).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),i=C=>({in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}})[C]||{bg:"#f5f5f5",color:"#666"},o=C=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[C]||"📋",a=()=>t.movement,c={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},u={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},h={"font-weight":"600",color:"var(--text-primary)","text-align":"right"},f={"margin-bottom":"1.5rem"},p={"font-weight":"600","margin-bottom":"0.75rem","padding-bottom":"0.5rem","border-bottom":"2px solid var(--border-color)"},_=C=>({display:"inline-flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"600","text-transform":"uppercase","letter-spacing":"0.5px",background:i(C).bg,color:i(C).color});return S(mr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.movementDetails")},size:"lg",get children(){return S(Ve,{get when(){return a()},get fallback(){return(()=>{var C=wA();return s(C,()=>e("common.noDataFound")),C})()},children:C=>(()=>{var N=AA(),E=N.firstChild,T=E.firstChild,x=T.firstChild,q=x.nextSibling,ee=q.firstChild,Y=T.nextSibling,ue=Y.firstChild,ie=E.nextSibling,I=ie.firstChild,b=I.nextSibling,v=b.firstChild,P=v.firstChild,w=v.nextSibling,A=b.nextSibling,y=A.firstChild,de=y.firstChild,H=y.nextSibling,$=H.firstChild,Z=A.nextSibling,k=Z.firstChild,F=k.firstChild,B=k.nextSibling,W=Z.nextSibling,fe=W.firstChild,K=fe.firstChild,he=K.nextSibling;he.nextSibling;var D=fe.nextSibling,U=ie.nextSibling,Q=U.firstChild,J=Q.nextSibling,ce=J.firstChild,oe=ce.firstChild,O=ce.nextSibling,re=U.nextSibling,pe=re.firstChild,ve=pe.nextSibling,te=ve.firstChild,se=te.firstChild,R=te.nextSibling,M=ve.nextSibling,V=M.firstChild,ge=V.firstChild,le=V.nextSibling;return E.style.setProperty("display","flex"),E.style.setProperty("justify-content","space-between"),E.style.setProperty("align-items","center"),E.style.setProperty("margin-bottom","1.5rem"),E.style.setProperty("padding-bottom","1rem"),E.style.setProperty("border-bottom","2px solid var(--border-color)"),x.style.setProperty("margin","0 0 0.5rem 0"),x.style.setProperty("font-size","1.25rem"),s(x,()=>C().productName),q.style.setProperty("font-size","0.875rem"),q.style.setProperty("color","var(--text-muted)"),s(q,()=>e("inventory.sku"),ee),s(q,()=>C().productSku,null),ue.style.setProperty("font-size","1.2rem"),s(ue,()=>o(C().movementType)),s(Y,()=>C().movementType,null),s(I,()=>e("inventory.movementInformation")),s(v,()=>e("inventory.referenceNumber"),P),s(w,()=>C().referenceNumber),s(y,()=>e("common.quantity"),de),s(H,()=>C().quantity,$),s(H,()=>e("common.units"),null),s(k,()=>e("inventory.unitCost"),F),s(B,()=>r(C().unitCost)),s(fe,()=>e("common.total"),K),s(fe,()=>e("common.value"),he),s(D,()=>r(C().totalCost)),s(Q,()=>e("inventory.locationInformation")),s(ce,()=>e("inventory.location"),oe),s(O,()=>C().locationName),s(U,S(Ve,{get when(){return C().fromLocationName},get children(){var j=vl(),G=j.firstChild,Pe=G.firstChild,_e=G.nextSibling;return s(G,()=>e("common.from"),Pe),s(_e,()=>C().fromLocationName),ne(ae=>{var be=c,X=u,Ce=h;return ae.e=d(j,be,ae.e),ae.t=d(G,X,ae.t),ae.a=d(_e,Ce,ae.a),ae},{e:void 0,t:void 0,a:void 0}),j}}),null),s(U,S(Ve,{get when(){return C().invoiceId},get children(){var j=vl(),G=j.firstChild,Pe=G.firstChild,_e=G.nextSibling;return s(G,()=>e("common.invoice"),Pe),s(_e,()=>C().invoiceId),ne(ae=>{var be=c,X=u,Ce={...h,color:"var(--primary-color)"};return ae.e=d(j,be,ae.e),ae.t=d(G,X,ae.t),ae.a=d(_e,Ce,ae.a),ae},{e:void 0,t:void 0,a:void 0}),j}}),null),s(pe,()=>e("common.details")),s(te,()=>e("common.createdBy"),se),s(R,()=>C().createdBy),s(V,()=>e("common.created"),ge),s(le,()=>n(C().createdDate)),s(re,S(Ve,{get when(){return C().notes},get children(){var j=vl(),G=j.firstChild,Pe=G.firstChild,_e=G.nextSibling;return s(G,()=>e("common.notes"),Pe),s(_e,()=>C().notes),ne(ae=>{var be={...c,"border-bottom":"none"},X=u,Ce={...h,"font-style":"italic","max-width":"60%","white-space":"pre-wrap"};return ae.e=d(j,be,ae.e),ae.t=d(G,X,ae.t),ae.a=d(_e,Ce,ae.a),ae},{e:void 0,t:void 0,a:void 0}),j}}),null),s(N,S(Ve,{get when(){return t.onEdit},get children(){var j=CA(),G=j.firstChild,Pe=G.firstChild;return j.style.setProperty("display","flex"),j.style.setProperty("justify-content","flex-end"),j.style.setProperty("margin-top","1.5rem"),j.style.setProperty("padding-top","1rem"),j.style.setProperty("border-top","1px solid var(--border-color)"),G.addEventListener("mouseleave",_e=>{_e.currentTarget.style.transform="translateY(0)",_e.currentTarget.style.boxShadow="none"}),G.addEventListener("mouseenter",_e=>{_e.currentTarget.style.transform="translateY(-1px)",_e.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)"}),G.$$click=()=>t.onEdit?.(C()),G.style.setProperty("padding","0.5rem 1.5rem"),G.style.setProperty("border-radius","var(--border-radius-sm)"),G.style.setProperty("border","1px solid var(--primary-color)"),G.style.setProperty("background","var(--primary-color)"),G.style.setProperty("color","white"),G.style.setProperty("cursor","pointer"),G.style.setProperty("font-weight","500"),G.style.setProperty("transition","all 0.2s ease"),s(G,()=>e("common.edit"),Pe),s(G,()=>e("inventory.movement"),null),j}}),null),ne(j=>{var G=_(C().movementType),Pe=f,_e=p,ae=c,be=u,X=h,Ce=c,$e=u,Ee={...h,"font-size":"1.1rem",color:"var(--primary-color)"},xe=c,Oe=u,He=h,je=c,Ie=u,Be={...h,"font-size":"1.1rem",color:"var(--primary-color)"},We=f,ze=p,Ge=c,Ae=u,nt=h,et=f,dt=p,xt=c,Tt=u,Gt=h,vt=c,tr=u,yt=h;return j.e=d(Y,G,j.e),j.t=d(ie,Pe,j.t),j.a=d(I,_e,j.a),j.o=d(b,ae,j.o),j.i=d(v,be,j.i),j.n=d(w,X,j.n),j.s=d(A,Ce,j.s),j.h=d(y,$e,j.h),j.r=d(H,Ee,j.r),j.d=d(Z,xe,j.d),j.l=d(k,Oe,j.l),j.u=d(B,He,j.u),j.c=d(W,je,j.c),j.w=d(fe,Ie,j.w),j.m=d(D,Be,j.m),j.f=d(U,We,j.f),j.y=d(Q,ze,j.y),j.g=d(J,Ge,j.g),j.p=d(ce,Ae,j.p),j.b=d(O,nt,j.b),j.T=d(re,et,j.T),j.A=d(pe,dt,j.A),j.O=d(ve,xt,j.O),j.I=d(te,Tt,j.I),j.S=d(R,Gt,j.S),j.W=d(M,vt,j.W),j.C=d(V,tr,j.C),j.B=d(le,yt,j.B),j},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),N})()})}})};St(["click"]);var ai=z("<div>"),EA=z("<div><label></label><select><option value>"),xA=z("<div><div><span>:</span><span>$"),TA=z("<form><div><label></label><select><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><input type=number min=0.01 step=0.01></div><div><label></label><input type=number min=0 step=0.01></div><div><label></label><input type=text></div><div><label> (<!>)</label><input type=text></div><div><label> (<!>)</label><textarea></textarea></div><div><button type=button></button><button type=submit>"),Ch=z("<option> (<!>)");const $A=t=>{const{t:e}=ot(),[r,n]=ye("in"),[i,o]=ye(""),[a,c]=ye(""),[u,h]=ye(""),[f,p]=ye(""),[_,C]=ye(""),[N,E]=ye(""),[T,x]=ye(""),[q,ee]=ye(!1),[Y,ue]=ye({});ei(()=>{const de=t.movement;de&&t.isOpen&&(n(de.movementType),o(de.quantity.toString()),c(de.unitCost.toString()),h(de.referenceNumber),p(de.notes),E(de.locationId),C(de.fromLocationId||""),x(de.invoiceId||""),ue({}))});const ie=()=>{const de={};return(!i()||parseFloat(i())<=0)&&(de.quantity=e("forms.requiredField")),(!a()||parseFloat(a())<0)&&(de.unitCost=e("forms.requiredField")),u().trim()||(de.referenceNumber=e("forms.requiredField")),N()||(de.locationId=e("forms.requiredField")),r()==="transfer"&&!_()&&(de.fromLocationId=e("forms.requiredField")),ue(de),Object.keys(de).length===0},I=async de=>{if(de.preventDefault(),!(!ie()||!t.movement)){ee(!0);try{const H=t.movement,$=Re.getProductById(H.productId),Z=Re.getLocationById(N()),k=_()?Re.getLocationById(_()):null;if(!$||!Z)throw new Error("Product or location not found");const F={...H,movementType:r(),quantity:parseFloat(i()),unitCost:parseFloat(a()),totalCost:parseFloat(i())*parseFloat(a()),referenceNumber:u().trim(),notes:f().trim(),locationId:N(),locationName:Z.name,fromLocationId:_()||void 0,fromLocationName:k?.name,invoiceId:T().trim()||void 0,lastModified:new Date().toISOString()};Re.updateMovement(H.id,F),t.onMovementUpdated?.(),t.onClose(),b()}catch(H){console.error("Error updating movement:",H),ue({submit:e("forms.saveError")})}finally{ee(!1)}}},b=()=>{n("in"),o(""),c(""),h(""),p(""),C(""),E(""),x(""),ue({})},v=()=>{b(),t.onClose()},P={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",transition:"border-color 0.2s ease"},w={display:"block","margin-bottom":"0.25rem","font-weight":"500","font-size":"0.875rem"},A={color:"#d32f2f","font-size":"0.75rem","margin-top":"0.25rem"},y={"margin-bottom":"1rem"};return S(mr,{get isOpen(){return t.isOpen},onClose:v,get title(){return e("inventory.editMovement","Edit Movement")},get children(){return S(Ve,{get when(){return t.movement},get fallback(){return(()=>{var de=ai();return s(de,()=>e("common.loading")),de})()},get children(){var de=TA(),H=de.firstChild,$=H.firstChild,Z=$.nextSibling,k=Z.firstChild,F=k.nextSibling,B=F.nextSibling,W=B.nextSibling,fe=H.nextSibling,K=fe.firstChild,he=K.nextSibling,D=he.firstChild,U=fe.nextSibling,Q=U.firstChild,J=Q.nextSibling,ce=U.nextSibling,oe=ce.firstChild,O=oe.nextSibling,re=ce.nextSibling,pe=re.firstChild,ve=pe.nextSibling,te=re.nextSibling,se=te.firstChild,R=se.firstChild,M=R.nextSibling;M.nextSibling;var V=se.nextSibling,ge=te.nextSibling,le=ge.firstChild,j=le.firstChild,G=j.nextSibling;G.nextSibling;var Pe=le.nextSibling,_e=ge.nextSibling,ae=_e.firstChild,be=ae.nextSibling;return de.addEventListener("submit",I),s($,()=>e("inventory.movementType")),Z.addEventListener("change",X=>n(X.target.value)),s(k,()=>e("inventory.stockIn")),s(F,()=>e("inventory.stockOut")),s(B,()=>e("inventory.transfer")),s(W,()=>e("inventory.adjustment")),s(K,(()=>{var X=me(()=>r()==="transfer");return()=>X()?e("inventory.toLocation"):e("inventory.location")})()),he.addEventListener("change",X=>E(X.target.value)),s(D,()=>e("modals.selectLocation")),s(he,S(Mt,{get each(){return Re.getActiveLocations()},children:X=>(()=>{var Ce=Ch(),$e=Ce.firstChild,Ee=$e.nextSibling;return Ee.nextSibling,s(Ce,()=>X.name,$e),s(Ce,()=>X.type,Ee),ne(()=>Ce.value=X.id),Ce})()}),null),s(fe,S(Ve,{get when(){return Y().locationId},get children(){var X=ai();return s(X,()=>Y().locationId),ne(Ce=>d(X,A,Ce)),X}}),null),s(de,S(Ve,{get when(){return r()==="transfer"},get children(){var X=EA(),Ce=X.firstChild,$e=Ce.nextSibling,Ee=$e.firstChild;return s(Ce,()=>e("inventory.fromLocation")),$e.addEventListener("change",xe=>C(xe.target.value)),s(Ee,()=>e("modals.selectLocation")),s($e,S(Mt,{get each(){return Re.getActiveLocations().filter(xe=>xe.id!==N())},children:xe=>(()=>{var Oe=Ch(),He=Oe.firstChild,je=He.nextSibling;return je.nextSibling,s(Oe,()=>xe.name,He),s(Oe,()=>xe.type,je),ne(()=>Oe.value=xe.id),Oe})()}),null),s(X,S(Ve,{get when(){return Y().fromLocationId},get children(){var xe=ai();return s(xe,()=>Y().fromLocationId),ne(Oe=>d(xe,A,Oe)),xe}}),null),ne(xe=>{var Oe=y,He=w,je={...P,"border-color":Y().fromLocationId?"#d32f2f":"var(--border-color)"},Ie=q();return xe.e=d(X,Oe,xe.e),xe.t=d(Ce,He,xe.t),xe.a=d($e,je,xe.a),Ie!==xe.o&&($e.disabled=xe.o=Ie),xe},{e:void 0,t:void 0,a:void 0,o:void 0}),ne(()=>$e.value=_()),X}}),U),s(Q,()=>e("common.quantity")),J.$$input=X=>o(X.target.value),s(U,S(Ve,{get when(){return Y().quantity},get children(){var X=ai();return s(X,()=>Y().quantity),ne(Ce=>d(X,A,Ce)),X}}),null),s(oe,()=>e("inventory.unitCost")),O.$$input=X=>c(X.target.value),s(ce,S(Ve,{get when(){return Y().unitCost},get children(){var X=ai();return s(X,()=>Y().unitCost),ne(Ce=>d(X,A,Ce)),X}}),null),s(de,S(Ve,{get when(){return me(()=>!!i())()&&a()},get children(){var X=xA(),Ce=X.firstChild,$e=Ce.firstChild,Ee=$e.firstChild,xe=$e.nextSibling;return xe.firstChild,Ce.style.setProperty("display","flex"),Ce.style.setProperty("justify-content","space-between"),$e.style.setProperty("font-weight","500"),s($e,()=>e("common.total"),Ee),xe.style.setProperty("font-weight","600"),xe.style.setProperty("color","var(--primary-color)"),s(xe,()=>(parseFloat(i()||"0")*parseFloat(a()||"0")).toFixed(2),null),ne(Oe=>d(X,{...y,padding:"0.75rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)"},Oe)),X}}),re),s(pe,()=>e("inventory.referenceNumber")),ve.$$input=X=>h(X.target.value),s(re,S(Ve,{get when(){return Y().referenceNumber},get children(){var X=ai();return s(X,()=>Y().referenceNumber),ne(Ce=>d(X,A,Ce)),X}}),null),s(se,()=>e("inventory.invoiceNumber"),R),s(se,()=>e("common.optional"),M),V.$$input=X=>x(X.target.value),s(le,()=>e("common.notes"),j),s(le,()=>e("common.optional"),G),Pe.$$input=X=>p(X.target.value),s(de,S(Ve,{get when(){return Y().submit},get children(){var X=ai();return s(X,()=>Y().submit),ne(Ce=>d(X,{...A,"margin-bottom":"1rem"},Ce)),X}}),_e),_e.style.setProperty("display","flex"),_e.style.setProperty("gap","1rem"),_e.style.setProperty("justify-content","flex-end"),ae.$$click=v,ae.style.setProperty("padding","0.5rem 1rem"),ae.style.setProperty("border","1px solid var(--border-color)"),ae.style.setProperty("border-radius","var(--border-radius-sm)"),ae.style.setProperty("background","white"),ae.style.setProperty("cursor","pointer"),s(ae,()=>e("common.cancel")),be.style.setProperty("padding","0.5rem 1rem"),be.style.setProperty("border","none"),be.style.setProperty("border-radius","var(--border-radius-sm)"),be.style.setProperty("background","var(--primary-color)"),be.style.setProperty("color","white"),be.style.setProperty("cursor","pointer"),be.style.setProperty("font-weight","500"),s(be,(()=>{var X=me(()=>!!q());return()=>X()?e("modals.processing"):e("inventory.updateMovement","Update Movement")})()),ne(X=>{var Ce=y,$e=w,Ee=P,xe=q(),Oe=y,He=w,je={...P,"border-color":Y().locationId?"#d32f2f":"var(--border-color)"},Ie=q(),Be=y,We=w,ze={...P,"border-color":Y().quantity?"#d32f2f":"var(--border-color)"},Ge=e("modals.enterQuantity"),Ae=q(),nt=y,et=w,dt={...P,"border-color":Y().unitCost?"#d32f2f":"var(--border-color)"},xt=e("modals.enterCost"),Tt=q(),Gt=y,vt=w,tr={...P,"border-color":Y().referenceNumber?"#d32f2f":"var(--border-color)"},yt=e("modals.enterReference"),At=q(),qt=y,Ot=w,Le=P,Fe=e("inventory.invoiceNumber"),Ke=q(),st=y,Vt=w,Je={...P,resize:"vertical","min-height":"80px"},gt=e("modals.addNotes"),Pt=q(),ct=q(),It=q();return X.e=d(H,Ce,X.e),X.t=d($,$e,X.t),X.a=d(Z,Ee,X.a),xe!==X.o&&(Z.disabled=X.o=xe),X.i=d(fe,Oe,X.i),X.n=d(K,He,X.n),X.s=d(he,je,X.s),Ie!==X.h&&(he.disabled=X.h=Ie),X.r=d(U,Be,X.r),X.d=d(Q,We,X.d),X.l=d(J,ze,X.l),Ge!==X.u&&lt(J,"placeholder",X.u=Ge),Ae!==X.c&&(J.disabled=X.c=Ae),X.w=d(ce,nt,X.w),X.m=d(oe,et,X.m),X.f=d(O,dt,X.f),xt!==X.y&&lt(O,"placeholder",X.y=xt),Tt!==X.g&&(O.disabled=X.g=Tt),X.p=d(re,Gt,X.p),X.b=d(pe,vt,X.b),X.T=d(ve,tr,X.T),yt!==X.A&&lt(ve,"placeholder",X.A=yt),At!==X.O&&(ve.disabled=X.O=At),X.I=d(te,qt,X.I),X.S=d(se,Ot,X.S),X.W=d(V,Le,X.W),Fe!==X.C&&lt(V,"placeholder",X.C=Fe),Ke!==X.B&&(V.disabled=X.B=Ke),X.v=d(ge,st,X.v),X.k=d(le,Vt,X.k),X.x=d(Pe,Je,X.x),gt!==X.j&&lt(Pe,"placeholder",X.j=gt),Pt!==X.q&&(Pe.disabled=X.q=Pt),ct!==X.z&&(ae.disabled=X.z=ct),It!==X.P&&(be.disabled=X.P=It),X},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0,z:void 0,P:void 0}),ne(()=>Z.value=r()),ne(()=>he.value=N()),ne(()=>J.value=i()),ne(()=>O.value=a()),ne(()=>ve.value=u()),ne(()=>V.value=T()),ne(()=>Pe.value=f()),de}})}})};St(["input","click"]);var kA=z("<div><div></div><div><div><label></label><select><option value=all></option><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),RA=z("<div><h2>"),Ah=z("<div><label></label><select><option value>"),DA=z("<option> (<!>)"),NA=z("<option>"),LA=z("<div><div>📦</div><div></div><div>"),MA=z("<div><div><div><div><span></span><h3></h3><span></span></div><div> • </div></div><div><div></div><div> <!> @ </div></div></div><div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div><span>:</span><span>"),OA=z("<span>"),VA=z("<span>• <!>: "),Ih=z("<div><span>:</span><span>"),BA=z("<div><div><span>:</span><select><option value=10>10</option><option value=25>25</option><option value=50>50</option><option value=100>100</option></select><span></span></div><div><div><span>:</span><input type=number min=1><span> "),FA=z("<span>..."),UA=z("<button>");const jA=t=>{const{t:e}=ot(),[r,n]=ye(""),[i,o]=ye(""),[a,c]=ye("all"),[u,h]=ye({start:"",end:""}),[f,p]=ye(""),[_,C]=ye(""),[N,E]=ye(1),[T,x]=ye(25),[q,ee]=ye(null),[Y,ue]=ye(!1),[ie,I]=ye(!1),b=qe(()=>{let M=Re.movements;if(t.filterBy==="product"&&t.filterId?M=M.filter(V=>V.productId===t.filterId):t.filterBy==="location"&&t.filterId&&(M=M.filter(V=>V.locationId===t.filterId)),r()&&(M=M.filter(V=>V.productId===r())),i()&&(M=M.filter(V=>V.locationId===i())),a()!=="all"&&(M=M.filter(V=>V.movementType===a())),u().start&&(M=M.filter(V=>V.createdDate>=u().start)),u().end&&(M=M.filter(V=>V.createdDate<=u().end+"T23:59:59Z")),f()){const V=f().toLowerCase();M=M.filter(ge=>ge.productName.toLowerCase().includes(V)||ge.productSku.toLowerCase().includes(V)||ge.locationName.toLowerCase().includes(V)||ge.referenceNumber.toLowerCase().includes(V)||ge.notes.toLowerCase().includes(V)||ge.createdBy.toLowerCase().includes(V)||ge.invoiceId&&ge.invoiceId.toLowerCase().includes(V)||ge.fromLocationName&&ge.fromLocationName.toLowerCase().includes(V)||ge.movementType.toLowerCase().includes(V))}return M.sort((V,ge)=>new Date(ge.createdDate).getTime()-new Date(V.createdDate).getTime())});ei(()=>{r(),i(),a(),u(),f(),E(1)});const v=qe(()=>{const M=(N()-1)*T(),V=M+T();return b().slice(M,V)}),P=qe(()=>Math.ceil(b().length/T())),w=qe(()=>{const M=b();return{total:M.length,stockIn:M.filter(V=>V.movementType==="in").length,stockOut:M.filter(V=>V.movementType==="out").length,transfers:M.filter(V=>V.movementType==="transfer").length,adjustments:M.filter(V=>V.movementType==="adjustment").length,totalValue:M.reduce((V,ge)=>V+ge.totalCost,0)}}),A={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},y={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},de={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)",cursor:"pointer"},H={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},$={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem","margin-bottom":"2rem"},Z={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","text-align":"center"},k={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},F={"font-size":"0.875rem",color:"var(--text-muted)","font-weight":"500"},B={padding:"1.5rem","margin-bottom":"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",transition:"all 0.2s ease"},W={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"1rem"};function fe(M){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[M]||{bg:"#f5f5f5",color:"#666"}}const K=M=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:fe(M).bg,color:fe(M).color}),he={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"1rem"},D={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.5rem 0","border-bottom":"1px solid var(--border-color)"},U={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},Q={"font-weight":"600",color:"var(--text-primary)"},J={display:"flex","justify-content":"space-between","align-items":"center","margin-top":"2rem",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},ce=M=>({padding:"0.25rem 0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:M?"var(--primary-color)":"var(--surface-color)",color:M?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),oe=M=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(M),O=M=>new Date(M).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),re=M=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[M]||"📋",pe=()=>{n(""),o(""),c("all"),h({start:"",end:""}),p(""),E(1)},ve=M=>{ee(M),ue(!0)},te=M=>{ee(M),ue(!1),I(!0)},se=()=>{I(!1),ee(null)},R=async M=>{i()&&(M+=" "+i()),Ll(a())&&(M+=" "+Ll(a()));const V=await Fn.getInventory(M),ge=Re.parseInventoryData(V);Re.updMovements(ge)};return(()=>{var M=kA(),V=M.firstChild,ge=V.nextSibling,le=ge.firstChild,j=le.firstChild,G=j.nextSibling,Pe=G.firstChild,_e=Pe.nextSibling,ae=_e.nextSibling,be=ae.nextSibling,X=be.nextSibling,Ce=le.nextSibling,$e=Ce.firstChild,Ee=$e.nextSibling,xe=Ce.nextSibling,Oe=xe.firstChild,He=Oe.nextSibling,je=ge.nextSibling,Ie=je.firstChild,Be=Ie.firstChild,We=Be.nextSibling,ze=Ie.nextSibling,Ge=ze.firstChild,Ae=Ge.nextSibling,nt=ze.nextSibling,et=nt.firstChild,dt=et.nextSibling,xt=nt.nextSibling,Tt=xt.firstChild,Gt=Tt.nextSibling,vt=xt.nextSibling,tr=vt.firstChild,yt=tr.nextSibling,At=vt.nextSibling,qt=At.firstChild,Ot=qt.nextSibling;return s(M,(()=>{var Le=me(()=>!t.filterBy);return()=>Le()&&(()=>{var Fe=RA(),Ke=Fe.firstChild;return d(Fe,A),Ke.style.setProperty("margin","0"),Ke.style.setProperty("font-size","1.5rem"),s(Ke,()=>e("inventory.movements")),s(Fe,S(De,{variant:"outline",onClick:pe,get children(){return e("common.clearFilters")}}),null),Fe})()})(),V),s(M,S(PA,{filters:{selectedLocation:i,movementType:a},onSearchResults:Le=>{C(Le),R(Le)},get placeholder(){return e("inventory.searchProductsStock","Search inventories...")},showResults:!1,maxResults:20}),V),V.style.setProperty("margin","20px"),d(ge,y),s(ge,(()=>{var Le=me(()=>!t.filterBy);return()=>Le()&&[(()=>{var Fe=Ah(),Ke=Fe.firstChild,st=Ke.nextSibling,Vt=st.firstChild;return Ke.style.setProperty("display","block"),Ke.style.setProperty("margin-bottom","0.5rem"),Ke.style.setProperty("font-weight","500"),s(Ke,()=>e("inventory.product")),st.addEventListener("change",Je=>n(Je.target.value)),s(Vt,()=>e("inventory.allProducts")),s(st,S(Mt,{get each(){return Re.products},children:Je=>(()=>{var gt=DA(),Pt=gt.firstChild,ct=Pt.nextSibling;return ct.nextSibling,s(gt,()=>Je.name,Pt),s(gt,()=>Je.sku,ct),ne(()=>gt.value=Je.id),gt})()}),null),ne(Je=>d(st,de,Je)),ne(()=>st.value=r()),Fe})(),(()=>{var Fe=Ah(),Ke=Fe.firstChild,st=Ke.nextSibling,Vt=st.firstChild;return Ke.style.setProperty("display","block"),Ke.style.setProperty("margin-bottom","0.5rem"),Ke.style.setProperty("font-weight","500"),s(Ke,()=>e("inventory.location")),st.addEventListener("change",Je=>o(Je.target.value)),s(Vt,()=>e("inventory.allLocations")),s(st,S(Mt,{get each(){return Re.locations},children:Je=>(()=>{var gt=NA();return s(gt,()=>Je.name),ne(()=>gt.value=Je.id),gt})()}),null),ne(Je=>d(st,de,Je)),ne(()=>st.value=i()),Fe})()]})(),le),j.style.setProperty("display","block"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-weight","500"),s(j,()=>e("inventory.movementType")),G.addEventListener("change",Le=>{c(Le.target.value),R(_())}),s(Pe,()=>e("inventory.allTypes")),s(_e,()=>e("inventory.stockIn")),s(ae,()=>e("inventory.stockOut")),s(be,()=>e("inventory.transfer")),s(X,()=>e("inventory.adjustment")),$e.style.setProperty("display","block"),$e.style.setProperty("margin-bottom","0.5rem"),$e.style.setProperty("font-weight","500"),s($e,()=>e("common.startDate")),Ee.addEventListener("change",Le=>h(Fe=>({...Fe,start:Le.target.value}))),Oe.style.setProperty("display","block"),Oe.style.setProperty("margin-bottom","0.5rem"),Oe.style.setProperty("font-weight","500"),s(Oe,()=>e("common.endDate")),He.addEventListener("change",Le=>h(Fe=>({...Fe,end:Le.target.value}))),d(je,$),s(Be,()=>w().total),s(We,()=>e("inventory.totalMovements")),s(Ge,()=>w().stockIn),s(Ae,()=>e("inventory.stockIn")),s(et,()=>w().stockOut),s(dt,()=>e("inventory.stockOut")),s(Tt,()=>w().transfers),s(Gt,()=>e("inventory.transfers")),s(tr,()=>w().adjustments),s(yt,()=>e("inventory.adjustments")),s(qt,()=>oe(w().totalValue)),s(Ot,()=>e("inventory.totalValue")),s(M,(()=>{var Le=me(()=>v().length===0);return()=>Le()?(()=>{var Fe=LA(),Ke=Fe.firstChild,st=Ke.nextSibling,Vt=st.nextSibling;return Fe.style.setProperty("text-align","center"),Fe.style.setProperty("padding","3rem"),Fe.style.setProperty("color","var(--text-muted)"),Fe.style.setProperty("background","var(--surface-color)"),Fe.style.setProperty("border-radius","var(--border-radius)"),Fe.style.setProperty("border","1px solid var(--border-color)"),Ke.style.setProperty("font-size","1.5rem"),Ke.style.setProperty("margin-bottom","1rem"),st.style.setProperty("font-size","1.1rem"),st.style.setProperty("margin-bottom","0.5rem"),s(st,()=>e("inventory.noMovementsFound")),Vt.style.setProperty("font-size","0.875rem"),s(Vt,()=>e("inventory.tryAdjustingFilters")),Fe})():[S(Mt,{get each(){return v()},children:Fe=>(()=>{var Ke=MA(),st=Ke.firstChild,Vt=st.firstChild,Je=Vt.firstChild,gt=Je.firstChild,Pt=gt.nextSibling,ct=Pt.nextSibling,It=Je.nextSibling,Cr=It.firstChild,$t=Vt.nextSibling,jt=$t.firstChild,fr=jt.nextSibling,kt=fr.firstChild,Qt=kt.nextSibling;Qt.nextSibling;var Ur=st.nextSibling,zt=Ur.firstChild,ar=zt.firstChild,kr=ar.firstChild,un=kr.firstChild,Rr=kr.nextSibling,ri=ar.nextSibling,Ei=ri.firstChild,ms=Ei.firstChild,co=Ei.nextSibling,uo=zt.nextSibling,xi=uo.firstChild,xn=xi.firstChild,fs=xn.firstChild,ho=xn.nextSibling;return Ke.addEventListener("mouseleave",at=>{at.currentTarget.style.transform="translateY(0)",at.currentTarget.style.boxShadow="none"}),Ke.addEventListener("mouseenter",at=>{at.currentTarget.style.transform="translateY(-2px)",at.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),Ke.$$click=()=>ve(Fe),d(st,W),Je.style.setProperty("display","flex"),Je.style.setProperty("align-items","center"),Je.style.setProperty("gap","0.5rem"),Je.style.setProperty("margin-bottom","0.5rem"),gt.style.setProperty("font-size","1.2rem"),s(gt,()=>re(Fe.movementType)),Pt.style.setProperty("margin","0"),Pt.style.setProperty("font-size","1.1rem"),s(Pt,()=>Fe.productName),s(ct,()=>Fe.movementType),s(Je,(()=>{var at=me(()=>!!Fe.invoiceId);return()=>at()&&(()=>{var Rt=OA();return Rt.style.setProperty("padding","0.2rem 0.5rem"),Rt.style.setProperty("border-radius","var(--border-radius-sm)"),Rt.style.setProperty("font-size","0.7rem"),Rt.style.setProperty("font-weight","500"),Rt.style.setProperty("background","var(--primary-color)"),Rt.style.setProperty("color","white"),s(Rt,()=>e("inventory.bulk")),Rt})()})(),null),It.style.setProperty("font-size","0.875rem"),It.style.setProperty("color","var(--text-muted)"),s(It,()=>Fe.productSku,Cr),s(It,()=>O(Fe.createdDate),null),s(It,(()=>{var at=me(()=>!!Fe.invoiceId);return()=>at()&&(()=>{var Rt=VA(),yr=Rt.firstChild,jr=yr.nextSibling;return jr.nextSibling,Rt.style.setProperty("margin-left","0.5rem"),Rt.style.setProperty("font-weight","500"),s(Rt,()=>e("common.invoice"),jr),s(Rt,()=>Fe.invoiceId,null),Rt})()})(),null),$t.style.setProperty("text-align","right"),jt.style.setProperty("font-size","1.25rem"),jt.style.setProperty("font-weight","700"),jt.style.setProperty("color","var(--primary-color)"),s(jt,()=>oe(Fe.totalCost)),fr.style.setProperty("font-size","0.875rem"),fr.style.setProperty("color","var(--text-muted)"),s(fr,()=>Fe.quantity,kt),s(fr,()=>e("common.units"),Qt),s(fr,()=>oe(Fe.unitCost),null),d(Ur,he),s(kr,()=>e("inventory.location"),un),s(Rr,()=>Fe.locationName),s(zt,(()=>{var at=me(()=>!!Fe.fromLocationName);return()=>at()&&(()=>{var Rt=Ih(),yr=Rt.firstChild,jr=yr.firstChild,dn=yr.nextSibling;return s(yr,()=>e("common.from"),jr),s(dn,()=>Fe.fromLocationName),ne(Bt=>{var Ar=D,Kr=U,Yr=Q;return Bt.e=d(Rt,Ar,Bt.e),Bt.t=d(yr,Kr,Bt.t),Bt.a=d(dn,Yr,Bt.a),Bt},{e:void 0,t:void 0,a:void 0}),Rt})()})(),ri),s(Ei,()=>e("common.reference"),ms),s(co,()=>Fe.referenceNumber),s(xn,()=>e("common.createdBy"),fs),s(ho,()=>Fe.createdBy),s(uo,(()=>{var at=me(()=>!!Fe.notes);return()=>at()&&(()=>{var Rt=Ih(),yr=Rt.firstChild,jr=yr.firstChild,dn=yr.nextSibling;return s(yr,()=>e("common.notes"),jr),s(dn,()=>Fe.notes),ne(Bt=>{var Ar={...D,"border-bottom":"none"},Kr=U,Yr={...Q,"max-width":"200px","text-align":"right","font-style":"italic"};return Bt.e=d(Rt,Ar,Bt.e),Bt.t=d(yr,Kr,Bt.t),Bt.a=d(dn,Yr,Bt.a),Bt},{e:void 0,t:void 0,a:void 0}),Rt})()})(),null),ne(at=>{var Rt={...B,"border-left":Fe.invoiceId?"4px solid var(--primary-color)":"1px solid var(--border-color)",cursor:"pointer"},yr=K(Fe.movementType),jr=D,dn=U,Bt=Q,Ar=D,Kr=U,Yr=Q,ys=D,Dt=U,Ti=Q;return at.e=d(Ke,Rt,at.e),at.t=d(ct,yr,at.t),at.a=d(ar,jr,at.a),at.o=d(kr,dn,at.o),at.i=d(Rr,Bt,at.i),at.n=d(ri,Ar,at.n),at.s=d(Ei,Kr,at.s),at.h=d(co,Yr,at.h),at.r=d(xi,ys,at.r),at.d=d(xn,Dt,at.d),at.l=d(ho,Ti,at.l),at},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),Ke})()}),me(()=>me(()=>P()>1)()&&(()=>{var Fe=BA(),Ke=Fe.firstChild,st=Ke.firstChild,Vt=st.firstChild,Je=st.nextSibling,gt=Je.nextSibling,Pt=Ke.nextSibling,ct=Pt.firstChild,It=ct.firstChild,Cr=It.firstChild,$t=It.nextSibling,jt=$t.nextSibling,fr=jt.firstChild;return d(Fe,J),Ke.style.setProperty("display","flex"),Ke.style.setProperty("align-items","center"),Ke.style.setProperty("gap","0.5rem"),st.style.setProperty("font-size","0.875rem"),st.style.setProperty("color","var(--text-muted)"),s(st,()=>e("common.showPerPage","Show per page"),Vt),Je.addEventListener("change",kt=>{x(Number(kt.target.value)),E(1)}),Je.style.setProperty("padding","0.25rem 0.5rem"),Je.style.setProperty("border","1px solid var(--border-color)"),Je.style.setProperty("border-radius","var(--border-radius-sm)"),Je.style.setProperty("background","var(--surface-color)"),Je.style.setProperty("cursor","pointer"),Je.style.setProperty("font-size","0.875rem"),gt.style.setProperty("font-size","0.875rem"),gt.style.setProperty("color","var(--text-muted)"),gt.style.setProperty("margin-left","1rem"),s(gt,()=>e("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:(N()-1)*T()+1,end:Math.min(N()*T(),b().length),total:b().length})),Pt.style.setProperty("display","flex"),Pt.style.setProperty("align-items","center"),Pt.style.setProperty("gap","0.5rem"),s(Pt,S(De,{variant:"outline",size:"sm",onClick:()=>E(1),get disabled(){return N()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.first","First")}}),ct),s(Pt,S(De,{variant:"outline",size:"sm",onClick:()=>E(kt=>Math.max(1,kt-1)),get disabled(){return N()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.previous")}}),ct),s(Pt,()=>{const kt=[],Qt=P(),Ur=N();if(Qt<=7)for(let zt=1;zt<=Qt;zt++)kt.push(zt);else{kt.push(1),Ur>3&&kt.push("...");for(let zt=Math.max(2,Ur-1);zt<=Math.min(Qt-1,Ur+1);zt++)kt.includes(zt)||kt.push(zt);Ur<Qt-2&&kt.push("..."),kt.includes(Qt)||kt.push(Qt)}return S(Mt,{each:kt,children:zt=>zt==="..."?(()=>{var ar=FA();return ar.style.setProperty("padding","0 0.5rem"),ar.style.setProperty("color","var(--text-muted)"),ar})():(()=>{var ar=UA();return ar.$$click=()=>E(zt),s(ar,zt),ne(kr=>d(ar,ce(zt===N()),kr)),ar})()})},ct),s(Pt,S(De,{variant:"outline",size:"sm",onClick:()=>E(kt=>Math.min(P(),kt+1)),get disabled(){return N()===P()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.next")}}),ct),s(Pt,S(De,{variant:"outline",size:"sm",onClick:()=>E(P()),get disabled(){return N()===P()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.last","Last")}}),ct),ct.style.setProperty("display","flex"),ct.style.setProperty("align-items","center"),ct.style.setProperty("gap","0.5rem"),ct.style.setProperty("margin-left","1rem"),It.style.setProperty("font-size","0.875rem"),It.style.setProperty("color","var(--text-muted)"),s(It,()=>e("common.page","Page"),Cr),$t.addEventListener("change",kt=>{const Qt=Number(kt.target.value);Qt>=1&&Qt<=P()&&E(Qt)}),$t.style.setProperty("width","4rem"),$t.style.setProperty("padding","0.25rem 0.5rem"),$t.style.setProperty("border","1px solid var(--border-color)"),$t.style.setProperty("border-radius","var(--border-radius-sm)"),$t.style.setProperty("background","var(--surface-color)"),$t.style.setProperty("text-align","center"),$t.style.setProperty("font-size","0.875rem"),jt.style.setProperty("font-size","0.875rem"),jt.style.setProperty("color","var(--text-muted)"),s(jt,()=>e("common.of","of"),fr),s(jt,P,null),ne(()=>lt($t,"max",P())),ne(()=>Je.value=T()),ne(()=>$t.value=N()),Fe})())]})(),null),s(M,S(IA,{get isOpen(){return Y()},onClose:()=>{ue(!1),ee(null)},get movement(){return q()},onEdit:te}),null),s(M,S(Ve,{get when(){return Ut.hasPermission("read_write")},get children(){return S($A,{get isOpen(){return ie()},onClose:()=>{I(!1),ee(null)},get movement(){return q()},onMovementUpdated:se})}}),null),ne(Le=>{var Fe=de,Ke=H,st=H,Vt=Z,Je=k,gt=F,Pt=Z,ct={...k,color:"#2d7d32"},It=F,Cr=Z,$t={...k,color:"#d32f2f"},jt=F,fr=Z,kt={...k,color:"#1976d2"},Qt=F,Ur=Z,zt={...k,color:"#f57c00"},ar=F,kr=Z,un=k,Rr=F;return Le.e=d(G,Fe,Le.e),Le.t=d(Ee,Ke,Le.t),Le.a=d(He,st,Le.a),Le.o=d(Ie,Vt,Le.o),Le.i=d(Be,Je,Le.i),Le.n=d(We,gt,Le.n),Le.s=d(ze,Pt,Le.s),Le.h=d(Ge,ct,Le.h),Le.r=d(Ae,It,Le.r),Le.d=d(nt,Cr,Le.d),Le.l=d(et,$t,Le.l),Le.u=d(dt,jt,Le.u),Le.c=d(xt,fr,Le.c),Le.w=d(Tt,kt,Le.w),Le.m=d(Gt,Qt,Le.m),Le.f=d(vt,Ur,Le.f),Le.y=d(tr,zt,Le.y),Le.g=d(yt,ar,Le.g),Le.p=d(At,kr,Le.p),Le.b=d(qt,un,Le.b),Le.T=d(Ot,Rr,Le.T),Le},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),ne(()=>G.value=a()),ne(()=>Ee.value=u().start),ne(()=>He.value=u().end),M})()};St(["click"]);var zA=z("<div><p>📋 "),qA=z("<div>"),HA=z("<div><div>📊</div><h3></h3><p></p><div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=name></option><option value=sku></option><option value=category>"),WA=z("<div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div>%</div><div></div></div></div><div></div><div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),GA=z("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),KA=z("<div><div>✅</div><h3></h3><p>"),YA=z("<div><div><h3>📋 </h3><p></p></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div></div><div>"),QA=z("<div><div><div><h2>📋 </h2><button>×"),Eh=z("<option>"),JA=z("<div>..."),XA=z("<tr><td><div></div><div> • </div></td><td><div></div></td><td><div></div></td><td><div></div></td><td><div>"),ZA=z("<tr><td><div></div></td><td><div></div><div> • <!> • </div></td><td><div></div></td><td><input type=number placeholder=0 min=0 step=0.01></td><td><div></div></td><td><input type=text>");const eI=t=>{const{t:e}=ot(),[r,n]=ye([]),[i,o]=ye(!1),[a,c]=ye(!1),[u,h]=ye("all"),[f,p]=ye("all"),[_,C]=ye("name"),[N,E]=ye([]),[T,x]=ye("setup");cn(async()=>{await q(),t.selectedLocationId&&h(t.selectedLocationId)});const q=async()=>{try{o(!0);const k=await Fn.getProducts("prod");if(!k||typeof k!="object"){console.warn("No API results, using local store"),n(Re.products);return}const F=Object.keys(k),B=fe=>{let he=k[fe];return{id:fe,name:he.name||"Unknown Product",businessId:he.businessId||"",sku:he.code||he.sku||"",UPC:he.UPC||"",numCode:he.codeN||"",category:he.category||"General",unitCost:he.unitCost||0,unitOfMeasure:he.unitOfMeasure||"pcs",minStockLevel:he.minStockLevel||0,maxStockLevel:he.maxStockLevel||100,isActive:he.isActive!==!1,description:he.description||"",createdDate:he.createdAt||new Date().toISOString(),lastModified:he.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(he.sellingPrice||he.price||"0")}},W=F.map(B);n(W)}catch(k){console.error("Failed to load products from API:",k),n(Re.products)}finally{o(!1)}},ee=qe(()=>[...new Set(r().map(F=>F.category).filter(F=>F))].sort()),Y=qe(()=>{let k=r().filter(F=>F.isActive);return f()!=="all"&&(k=k.filter(F=>F.category===f())),k.sort((F,B)=>{switch(_()){case"name":return F.name.localeCompare(B.name);case"sku":return F.sku.localeCompare(B.sku);case"category":return F.category.localeCompare(B.category)||F.name.localeCompare(B.name);default:return 0}}),k}),ue=qe(()=>Re.getActiveLocations()),ie=(k,F)=>F&&F!=="all"?Re.getStockByProductAndLocation(k,F)?.quantity||0:Re.getTotalStockByProduct(k),I=()=>{const k=Y().map(F=>{const B=ie(F.id,u()!=="all"?u():void 0);return{productId:F.id,systemQuantity:B,physicalCount:null,notes:"",variance:0,product:F}});E(k),x("counting")},b=(k,F)=>{E(B=>B.map(W=>{if(W.productId===k){const fe=F,K=fe!==null?fe-W.systemQuantity:0;return{...W,physicalCount:fe,variance:K}}return W}))},v=(k,F)=>{E(B=>B.map(W=>W.productId===k?{...W,notes:F}:W))},P=qe(()=>{const k=N(),F=k.length,B=k.filter(he=>he.physicalCount!==null).length,W=k.filter(he=>he.variance!==0).length,fe=k.filter(he=>he.variance>0).length,K=k.filter(he=>he.variance<0).length;return{totalProducts:F,countedProducts:B,remainingProducts:F-B,variances:W,positiveVariances:fe,negativeVariances:K,isComplete:B===F}}),w=()=>{const k=N().filter(fe=>fe.physicalCount!==null&&fe.variance!==0);if(k.length===0)return null;const F=[e("inventory.product","Product"),e("inventory.sku","SKU"),e("inventory.category","Category"),e("inventory.location","Location"),e("inventory.systemQty","System Qty"),e("inventory.physicalCount","Physical Count"),e("inventory.variance","Variance"),e("inventory.adjustment","Adjustment"),e("common.notes","Notes"),e("common.date","Date")],B=k.map(fe=>[`"${fe.product.name}"`,`"${fe.product.sku}"`,`"${fe.product.category}"`,`"${de()}"`,fe.systemQuantity,fe.physicalCount,fe.variance,fe.variance>0?e("inventory.stockIncrease","Stock Increase"):e("inventory.stockDecrease","Stock Decrease"),`"${fe.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")}"`,`"${H()}"`]);return[F.join(","),...B.map(fe=>fe.join(","))].join(`
`)},A=()=>{const k=w();if(!k){alert(e("inventory.noAdjustmentsToDownload","No adjustments to download"));return}const F=new Blob([k],{type:"text/csv;charset=utf-8;"}),B=document.createElement("a");if(B.download!==void 0){const W=URL.createObjectURL(F);B.setAttribute("href",W),B.setAttribute("download",`inventory-adjustments-${H().replace(/[/:,\s]/g,"-")}.csv`),B.style.visibility="hidden",document.body.appendChild(B),B.click(),document.body.removeChild(B)}},y=async(k=!0)=>{try{c(!0),console.log(N());const F=D=>{let U=Re.getProductById(D.productId),Q=Re.getStockByProductAndLocation(D.productId,u()),J=parseFloat(Q?.averageCost+""),ce=parseFloat(Q?.quantity+"");return{product:{id:D.productId,label:U?.name,code:U?.code},productId:D?.productId,reason:"Physical Count Adjustment",notes:D?.notes||"Physical inventory adjustment",quantity:D?.variance,unitCost:J}},B=N().filter(D=>D.physicalCount!==null&&D.variance!==0).map(F);let W="ADJ_"+js();const fe=new Date().toISOString(),K={ssg_inventory_key:js(),invoiceId:W,referenceNumber:js(),movementType:"adjustment",type:"adjustment",locationId:u(),items:B,products:B,generalNotes:"Physical inventory adjustment",description:"Physical Count Adjustment",invoice:W,store:u(),createdBy:"admin",createDate:fe};console.log("Saving inventory bulkRequest:",K);const he=await Fn.addInventory(K);k&&B.length>0&&A(),console.log("Saving inventory adjustments:",B),await new Promise(D=>setTimeout(D,1e3)),t.onClose()}catch(F){console.error("Failed to save inventory adjustments:",F)}finally{c(!1)}},de=qe(()=>u()==="all"?"All Locations":ue().find(F=>F.id===u())?.name||"Unknown Location"),H=()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),$=()=>{const k=window.open("","_blank");if(!k){alert("Please allow pop-ups to print the counting sheet");return}const F=Z();k.document.write(F),k.document.close(),k.onload=()=>{k.print(),k.onafterprint=()=>{k.close()}}},Z=()=>{const k=Y().map((F,B)=>{const W=ie(F.id,u()!=="all"?u():void 0);return`
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${B+1}</td>
          <td style="border: 1px solid #000; padding: 8px; font-family: monospace;">${F.sku}</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 500;">${F.name}</div>
            ${F.UPC?`<div style="font-size: 0.8em; color: #666;">UPC: ${F.UPC}</div>`:""}
          </td>
          <td style="border: 1px solid #000; padding: 8px;">${F.category}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${F.unitOfMeasure}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">${W}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; background-color: #f9f9f9;">________</td>
          <td style="border: 1px solid #000; padding: 8px;">_______________</td>
        </tr>
      `}).join("");return`
      <!DOCTYPE html>
      <html>
      <head>
        <title> ${de()}_${f()}_${e("inventory.countingSheet","Inventory Counting Sheet")} - ${H()}</title>
        <style>
          @page {
            size: letter;
            margin: 0.5in;
          }
          body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            margin: 0;
            padding: 0;
          }
          h1 {
            text-align: center;
            margin: 0 0 10px 0;
            font-size: 24px;
          }
          .header-info {
            text-align: center;
            margin-bottom: 20px;
          }
          .instructions {
            background-color: #f0f0f0;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
          }
          th {
            background-color: #333;
            color: white;
            padding: 8px;
            text-align: left;
            font-weight: bold;
            border: 1px solid #000;
          }
          .summary-table {
            width: 50%;
            margin: 20px auto;
          }
          .signature-section {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
          }
          .signature-box {
            width: 45%;
            text-align: center;
          }
          .signature-line {
            border-bottom: 1px solid #000;
            margin-bottom: 5px;
            height: 30px;
          }
          @media print {
            tr { page-break-inside: avoid; }
          }
        </style>
      </head>
      <body>
        <h1>${e("inventory.inventoryCountingSheetTitle","INVENTORY COUNTING SHEET")}</h1>
        <div class="header-info">
          <p><strong>${e("inventory.location","Location")}:</strong> ${de()}</p>
          <p><strong>${e("common.category","Category")}:</strong> ${f()==="all"?e("inventory.allCategories","All Categories"):f()}</p>
          <p><strong>${e("common.date","Date")}:</strong> ${H()}</p>
          <p style="margin-top: 10px;">
            <span style="margin-right: 30px;">${e("inventory.countedBy","Counted by")}: _________________________</span>
            <span>${e("inventory.verifiedBy","Verified by")}: _________________________</span>
          </p>
        </div>

        <table>
          <thead>
            <tr>
              <th style="width: 5%; text-align: center;">#</th>
              <th style="width: 12%;">${e("inventory.sku","SKU")}</th>
              <th style="width: 25%;">${e("inventory.productName","Product Name")}</th>
              <th style="width: 12%;">${e("common.category","Category")}</th>
              <th style="width: 8%; text-align: center;">${e("inventory.unit","Unit")}</th>
              <th style="width: 10%; text-align: center;">${e("inventory.systemQty","System Qty")}</th>
              <th style="width: 12%; text-align: center; background-color: #f0f0f0;">${e("inventory.physicalCount","Physical Count")}</th>
              <th style="width: 16%;">${e("common.notes","Notes")}</th>
            </tr>
          </thead>
          <tbody>
            ${k}
          </tbody>
        </table>
        
        <table class="summary-table">
          <tr>
            <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
              ${e("inventory.totalProductsListed","Total Products Listed")}:
            </td>
            <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">
              ${Y().length}
            </td>
          </tr>
          <tr>
            <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
              ${e("inventory.itemsCounted","Items Counted")}:
            </td>
            <td style="border: 1px solid #000; padding: 8px; text-align: center;">
              ___________
            </td>
          </tr>
          <tr>
            <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
              ${e("inventory.discrepanciesFound","Discrepancies Found")}:
            </td>
            <td style="border: 1px solid #000; padding: 8px; text-align: center;">
              ___________
            </td>
          </tr>
        </table>
        
        <div class="signature-section">
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.counterSignature","Counter Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.supervisorSignature","Supervisor Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
        </div>
      </body>
      </html>
    `};return S(Ve,{get when(){return t.isOpen},get children(){var k=QA(),F=k.firstChild,B=F.firstChild,W=B.firstChild;W.firstChild;var fe=W.nextSibling;return k.style.setProperty("position","fixed"),k.style.setProperty("top","0"),k.style.setProperty("left","0"),k.style.setProperty("right","0"),k.style.setProperty("bottom","0"),k.style.setProperty("background","rgba(0, 0, 0, 0.5)"),k.style.setProperty("z-index","1000"),k.style.setProperty("display","flex"),k.style.setProperty("align-items","center"),k.style.setProperty("justify-content","center"),F.style.setProperty("background","white"),F.style.setProperty("border-radius","var(--border-radius)"),F.style.setProperty("padding","2rem"),F.style.setProperty("width","95%"),F.style.setProperty("height","95%"),F.style.setProperty("max-width","1400px"),F.style.setProperty("overflow-y","auto"),F.style.setProperty("position","relative"),B.style.setProperty("display","flex"),B.style.setProperty("justify-content","space-between"),B.style.setProperty("align-items","center"),B.style.setProperty("margin-bottom","2rem"),B.style.setProperty("border-bottom","1px solid var(--border-color)"),B.style.setProperty("padding-bottom","1rem"),W.style.setProperty("margin","0"),W.style.setProperty("font-size","1.5rem"),s(W,()=>e("inventory.physicalInventoryCount","Physical Inventory Count"),null),Si(fe,"click",t.onClose,!0),fe.style.setProperty("background","none"),fe.style.setProperty("border","none"),fe.style.setProperty("font-size","1.5rem"),fe.style.setProperty("cursor","pointer"),fe.style.setProperty("padding","0.5rem"),s(F,S(Ve,{get when(){return T()==="setup"},get children(){var K=HA(),he=K.firstChild,D=he.nextSibling,U=D.nextSibling,Q=U.nextSibling,J=Q.firstChild,ce=J.firstChild,oe=ce.firstChild,O=ce.nextSibling,re=O.firstChild,pe=J.nextSibling,ve=pe.firstChild,te=ve.firstChild,se=ve.nextSibling,R=se.firstChild,M=pe.nextSibling,V=M.firstChild,ge=V.firstChild,le=V.nextSibling,j=le.firstChild,G=j.nextSibling,Pe=G.nextSibling;return K.style.setProperty("text-align","center"),K.style.setProperty("padding","2rem"),K.style.setProperty("max-width","600px"),K.style.setProperty("margin","0 auto"),he.style.setProperty("font-size","3rem"),he.style.setProperty("margin-bottom","1rem"),D.style.setProperty("margin-bottom","1rem"),s(D,()=>e("inventory.setupPhysicalCount","Setup Physical Inventory Count")),U.style.setProperty("margin-bottom","2rem"),U.style.setProperty("color","var(--text-muted)"),s(U,()=>e("inventory.setupDescription","Configure your physical inventory count settings and begin the counting process.")),Q.style.setProperty("display","grid"),Q.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),Q.style.setProperty("gap","1rem"),Q.style.setProperty("margin-bottom","2rem"),Q.style.setProperty("padding","1rem"),Q.style.setProperty("background","var(--surface-color)"),Q.style.setProperty("border-radius","var(--border-radius)"),Q.style.setProperty("text-align","left"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),s(ce,()=>e("inventory.location","Location"),oe),O.addEventListener("change",_e=>h(_e.target.value)),O.style.setProperty("width","100%"),O.style.setProperty("padding","0.5rem"),O.style.setProperty("border","1px solid var(--border-color)"),O.style.setProperty("border-radius","var(--border-radius-sm)"),s(re,()=>e("inventory.allLocations","All Locations")),s(O,S(Mt,{get each(){return ue()},children:_e=>(()=>{var ae=Eh();return s(ae,()=>_e.name),ne(()=>ae.value=_e.id),ae})()}),null),ve.style.setProperty("display","block"),ve.style.setProperty("margin-bottom","0.5rem"),ve.style.setProperty("font-weight","500"),s(ve,()=>e("inventory.category","Category"),te),se.addEventListener("change",_e=>p(_e.target.value)),se.style.setProperty("width","100%"),se.style.setProperty("padding","0.5rem"),se.style.setProperty("border","1px solid var(--border-color)"),se.style.setProperty("border-radius","var(--border-radius-sm)"),s(R,()=>e("products.allCategories","All Categories")),s(se,S(Mt,{get each(){return ee()},children:_e=>(()=>{var ae=Eh();return ae.value=_e,s(ae,_e),ae})()}),null),V.style.setProperty("display","block"),V.style.setProperty("margin-bottom","0.5rem"),V.style.setProperty("font-weight","500"),s(V,()=>e("inventory.sortBy","Sort By"),ge),le.addEventListener("change",_e=>C(_e.target.value)),le.style.setProperty("width","100%"),le.style.setProperty("padding","0.5rem"),le.style.setProperty("border","1px solid var(--border-color)"),le.style.setProperty("border-radius","var(--border-radius-sm)"),s(j,()=>e("inventory.productName","Product Name")),s(G,()=>e("inventory.sku","SKU")),s(Pe,()=>e("inventory.category","Category")),s(K,S(Ve,{get when(){return!i()},get fallback(){return(()=>{var _e=JA(),ae=_e.firstChild;return _e.style.setProperty("padding","2rem"),s(_e,()=>e("common.loading","Loading"),ae),_e})()},get children(){return[(()=>{var _e=zA(),ae=_e.firstChild;return ae.firstChild,_e.style.setProperty("padding","1rem"),_e.style.setProperty("background","#fff3cd"),_e.style.setProperty("border-radius","var(--border-radius-sm)"),_e.style.setProperty("margin-bottom","2rem"),ae.style.setProperty("margin","0"),ae.style.setProperty("color","#856404"),s(ae,()=>e("inventory.countWillInclude","This count will include {{count}} products from {{location}} in {{category}} category.",{count:Y().length,location:de(),category:f()==="all"?e("inventory.allCategories","all categories"):f()}),null),_e})(),(()=>{var _e=qA();return _e.style.setProperty("display","grid"),_e.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),_e.style.setProperty("gap","1rem"),_e.style.setProperty("margin-bottom","2rem"),_e.style.setProperty("padding","1rem"),_e.style.setProperty("background","var(--surface-color)"),_e.style.setProperty("border-radius","var(--border-radius)"),s(_e,S(De,{variant:"primary",size:"large",onClick:I,get disabled(){return i()||Y().length===0},get children(){return["🚀 ",me(()=>e("inventory.startCounting","Start Physical Count"))]}}),null),s(_e,S(De,{variant:"primary",onClick:$,get disabled(){return i()},get children(){return["🖨️ ",me(()=>e("common.print","Print"))]}}),null),_e})()]}}),null),ne(()=>O.value=u()),ne(()=>se.value=f()),ne(()=>le.value=_()),K}}),null),s(F,S(Ve,{get when(){return T()==="counting"},get children(){var K=WA(),he=K.firstChild,D=he.firstChild,U=D.firstChild,Q=U.nextSibling,J=D.nextSibling,ce=J.firstChild,oe=ce.nextSibling,O=J.nextSibling,re=O.firstChild,pe=re.nextSibling,ve=O.nextSibling,te=ve.firstChild,se=te.firstChild,R=te.nextSibling,M=he.nextSibling,V=M.nextSibling,ge=V.firstChild,le=ge.firstChild,j=le.firstChild,G=j.firstChild,Pe=G.nextSibling,_e=Pe.nextSibling,ae=_e.nextSibling,be=ae.nextSibling,X=be.nextSibling,Ce=le.nextSibling;return he.style.setProperty("display","grid"),he.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),he.style.setProperty("gap","1rem"),he.style.setProperty("margin-bottom","2rem"),he.style.setProperty("padding","1rem"),he.style.setProperty("background","var(--surface-color)"),he.style.setProperty("border-radius","var(--border-radius)"),D.style.setProperty("text-align","center"),U.style.setProperty("font-size","1.5rem"),U.style.setProperty("font-weight","700"),U.style.setProperty("color","var(--primary-color)"),s(U,()=>P().countedProducts),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),s(Q,()=>e("inventory.counted","Counted")),J.style.setProperty("text-align","center"),ce.style.setProperty("font-size","1.5rem"),ce.style.setProperty("font-weight","700"),ce.style.setProperty("color","#ff9800"),s(ce,()=>P().remainingProducts),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),s(oe,()=>e("inventory.remaining","Remaining")),O.style.setProperty("text-align","center"),re.style.setProperty("font-size","1.5rem"),re.style.setProperty("font-weight","700"),re.style.setProperty("color","#f44336"),s(re,()=>P().variances),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),s(pe,()=>e("inventory.variances","Variances")),ve.style.setProperty("text-align","center"),te.style.setProperty("font-size","1.5rem"),te.style.setProperty("font-weight","700"),s(te,()=>Math.round(P().countedProducts/P().totalProducts*100),se),R.style.setProperty("font-size","0.875rem"),R.style.setProperty("color","var(--text-muted)"),s(R,()=>e("inventory.complete","Complete")),M.style.setProperty("display","flex"),M.style.setProperty("gap","1rem"),M.style.setProperty("margin-bottom","2rem"),M.style.setProperty("justify-content","center"),s(M,S(De,{variant:"outline",onClick:()=>x("setup"),get children(){return["⬅️ ",me(()=>e("common.back","Back to Setup"))]}}),null),s(M,S(De,{variant:"primary",onClick:()=>x("review"),get children(){return["📋 ",me(()=>e("inventory.reviewAdjustments","Review Adjustments"))]}}),null),V.style.setProperty("border","1px solid var(--border-color)"),V.style.setProperty("border-radius","var(--border-radius)"),V.style.setProperty("overflow-x","auto"),ge.style.setProperty("width","100%"),ge.style.setProperty("border-collapse","collapse"),j.style.setProperty("background","var(--surface-color)"),G.style.setProperty("padding","1rem"),G.style.setProperty("text-align","left"),G.style.setProperty("border-bottom","1px solid var(--border-color)"),s(G,()=>e("inventory.no","No")),Pe.style.setProperty("padding","1rem"),Pe.style.setProperty("text-align","left"),Pe.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Pe,()=>e("inventory.product","Product")),_e.style.setProperty("padding","1rem"),_e.style.setProperty("text-align","center"),_e.style.setProperty("border-bottom","1px solid var(--border-color)"),s(_e,()=>e("inventory.systemQty","System Qty")),ae.style.setProperty("padding","1rem"),ae.style.setProperty("text-align","center"),ae.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ae,()=>e("inventory.physicalCount","Physical Count")),be.style.setProperty("padding","1rem"),be.style.setProperty("text-align","center"),be.style.setProperty("border-bottom","1px solid var(--border-color)"),s(be,()=>e("inventory.variance","Variance")),X.style.setProperty("padding","1rem"),X.style.setProperty("text-align","left"),X.style.setProperty("border-bottom","1px solid var(--border-color)"),s(X,()=>e("common.notes","Notes")),s(Ce,S(Mt,{get each(){return N()},children:($e,Ee)=>S(tI,{get index(){return Ee()},updatePhysicalCount:b,entry:$e,updateNotes:v})})),ne($e=>($e=P().isComplete?"#4caf50":"#ff9800")!=null?te.style.setProperty("color",$e):te.style.removeProperty("color")),K}}),null),s(F,S(Ve,{get when(){return T()==="review"},get children(){var K=YA(),he=K.firstChild,D=he.firstChild;D.firstChild;var U=D.nextSibling,Q=he.nextSibling,J=Q.firstChild,ce=J.firstChild,oe=ce.nextSibling,O=J.nextSibling,re=O.firstChild,pe=re.nextSibling,ve=O.nextSibling,te=ve.firstChild,se=te.nextSibling,R=Q.nextSibling;return he.style.setProperty("text-align","center"),he.style.setProperty("margin-bottom","2rem"),D.style.setProperty("margin-bottom","1rem"),s(D,()=>e("inventory.reviewAndConfirm","Review and Confirm Adjustments"),null),U.style.setProperty("color","var(--text-muted)"),s(U,()=>e("inventory.reviewDescription","Review the inventory adjustments below and confirm to update your system.")),Q.style.setProperty("display","grid"),Q.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),Q.style.setProperty("gap","1rem"),Q.style.setProperty("margin-bottom","2rem"),Q.style.setProperty("padding","1rem"),Q.style.setProperty("background","var(--surface-color)"),Q.style.setProperty("border-radius","var(--border-radius)"),J.style.setProperty("text-align","center"),ce.style.setProperty("font-size","1.5rem"),ce.style.setProperty("font-weight","700"),ce.style.setProperty("color","#4caf50"),s(ce,()=>P().positiveVariances),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),s(oe,()=>e("inventory.stockIncreases","Stock Increases")),O.style.setProperty("text-align","center"),re.style.setProperty("font-size","1.5rem"),re.style.setProperty("font-weight","700"),re.style.setProperty("color","#f44336"),s(re,()=>P().negativeVariances),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),s(pe,()=>e("inventory.stockDecreases","Stock Decreases")),ve.style.setProperty("text-align","center"),te.style.setProperty("font-size","1.5rem"),te.style.setProperty("font-weight","700"),te.style.setProperty("color","var(--primary-color)"),s(te,()=>P().variances),se.style.setProperty("font-size","0.875rem"),se.style.setProperty("color","var(--text-muted)"),s(se,()=>e("inventory.totalAdjustments","Total Adjustments")),R.style.setProperty("display","flex"),R.style.setProperty("gap","1rem"),R.style.setProperty("margin-bottom","2rem"),R.style.setProperty("justify-content","center"),R.style.setProperty("flex-wrap","wrap"),s(R,S(De,{variant:"outline",onClick:()=>x("counting"),get children(){return["⬅️ ",me(()=>e("common.back","Back to Counting"))]}}),null),s(R,S(De,{variant:"outline",onClick:A,get disabled(){return P().variances===0},get children(){return["📥 ",me(()=>e("inventory.downloadCSV","Download CSV"))]}}),null),s(R,S(De,{variant:"primary",onClick:y,get disabled(){return a()||P().variances===0},get children(){return me(()=>!!a())()?"💾 "+e("common.saving","Saving")+"...":"✅ "+e("inventory.confirmAdjustments","Confirm Adjustments")}}),null),s(K,S(Ve,{get when(){return P().variances>0},get children(){var M=GA(),V=M.firstChild,ge=V.firstChild,le=ge.firstChild,j=le.firstChild,G=j.nextSibling,Pe=G.nextSibling,_e=Pe.nextSibling,ae=_e.nextSibling,be=ge.nextSibling;return M.style.setProperty("border","1px solid var(--border-color)"),M.style.setProperty("border-radius","var(--border-radius)"),M.style.setProperty("overflow-x","auto"),V.style.setProperty("width","100%"),V.style.setProperty("border-collapse","collapse"),le.style.setProperty("background","var(--surface-color)"),j.style.setProperty("padding","1rem"),j.style.setProperty("text-align","left"),j.style.setProperty("border-bottom","1px solid var(--border-color)"),s(j,()=>e("inventory.product","Product")),G.style.setProperty("padding","1rem"),G.style.setProperty("text-align","center"),G.style.setProperty("border-bottom","1px solid var(--border-color)"),s(G,()=>e("inventory.systemQty","System Qty")),Pe.style.setProperty("padding","1rem"),Pe.style.setProperty("text-align","center"),Pe.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Pe,()=>e("inventory.physicalCount","Physical Count")),_e.style.setProperty("padding","1rem"),_e.style.setProperty("text-align","center"),_e.style.setProperty("border-bottom","1px solid var(--border-color)"),s(_e,()=>e("inventory.adjustment","Adjustment")),ae.style.setProperty("padding","1rem"),ae.style.setProperty("text-align","left"),ae.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ae,()=>e("common.notes","Notes")),s(be,S(Mt,{get each(){return N().filter(X=>X.variance!==0)},children:X=>(()=>{var Ce=XA(),$e=Ce.firstChild,Ee=$e.firstChild,xe=Ee.nextSibling,Oe=xe.firstChild,He=$e.nextSibling,je=He.firstChild,Ie=He.nextSibling,Be=Ie.firstChild,We=Ie.nextSibling,ze=We.firstChild,Ge=We.nextSibling,Ae=Ge.firstChild;return Ce.style.setProperty("border-bottom","1px solid var(--border-color)"),$e.style.setProperty("padding","1rem"),Ee.style.setProperty("font-weight","500"),s(Ee,()=>X.product.name),xe.style.setProperty("font-size","0.875rem"),xe.style.setProperty("color","var(--text-muted)"),s(xe,()=>X.product.sku,Oe),s(xe,()=>X.product.category,null),He.style.setProperty("padding","1rem"),He.style.setProperty("text-align","center"),je.style.setProperty("font-weight","600"),s(je,()=>X.systemQuantity),Ie.style.setProperty("padding","1rem"),Ie.style.setProperty("text-align","center"),Be.style.setProperty("font-weight","600"),s(Be,()=>X.physicalCount),We.style.setProperty("padding","1rem"),We.style.setProperty("text-align","center"),ze.style.setProperty("font-weight","700"),s(ze,()=>X.variance>0?"+":"",null),s(ze,()=>X.variance,null),Ge.style.setProperty("padding","1rem"),Ae.style.setProperty("font-size","0.875rem"),s(Ae,()=>X.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")),ne(nt=>{var et=X.variance>0?"#d4edda":"#f8d7da",dt=X.variance>0?"#4caf50":"#f44336";return et!==nt.e&&((nt.e=et)!=null?Ce.style.setProperty("background",et):Ce.style.removeProperty("background")),dt!==nt.t&&((nt.t=dt)!=null?ze.style.setProperty("color",dt):ze.style.removeProperty("color")),nt},{e:void 0,t:void 0}),Ce})()})),M}}),null),s(K,S(Ve,{get when(){return P().variances===0},get children(){var M=KA(),V=M.firstChild,ge=V.nextSibling,le=ge.nextSibling;return M.style.setProperty("text-align","center"),M.style.setProperty("padding","3rem"),M.style.setProperty("background","var(--surface-color)"),M.style.setProperty("border-radius","var(--border-radius)"),V.style.setProperty("font-size","3rem"),V.style.setProperty("margin-bottom","1rem"),ge.style.setProperty("margin-bottom","0.5rem"),s(ge,()=>e("inventory.perfectCount","Perfect Count!")),le.style.setProperty("color","var(--text-muted)"),s(le,()=>e("inventory.noVariances","No variances found. Your physical count matches the system exactly.")),M}}),null),K}}),null),k}})},tI=t=>{const{t:e}=ot(),[r,n]=ye(""),[i,o]=ye("");let{entry:a,updatePhysicalCount:c,updateNotes:u,index:h}=t;return cn(()=>{o(a?.notes),n(a?.physicalCount)}),(()=>{var f=ZA(),p=f.firstChild,_=p.firstChild,C=p.nextSibling,N=C.firstChild,E=N.nextSibling,T=E.firstChild,x=T.nextSibling;x.nextSibling;var q=C.nextSibling,ee=q.firstChild,Y=q.nextSibling,ue=Y.firstChild,ie=Y.nextSibling,I=ie.firstChild,b=ie.nextSibling,v=b.firstChild;return f.style.setProperty("border-bottom","1px solid var(--border-color)"),p.style.setProperty("padding","1rem"),p.style.setProperty("text-align","center"),_.style.setProperty("font-weight","600"),s(_,h+1),C.style.setProperty("padding","1rem"),N.style.setProperty("font-weight","500"),s(N,()=>a?.product.name),E.style.setProperty("font-size","0.875rem"),E.style.setProperty("color","var(--text-muted)"),s(E,()=>a?.product.sku,T),s(E,()=>a?.product.category,x),s(E,()=>a?.product.unitOfMeasure,null),q.style.setProperty("padding","1rem"),q.style.setProperty("text-align","center"),ee.style.setProperty("font-weight","600"),s(ee,()=>a?.systemQuantity),Y.style.setProperty("padding","1rem"),Y.style.setProperty("text-align","center"),ue.addEventListener("blur",()=>{c(a?.productId,r()===""?null:parseFloat(r()))}),ue.$$keydown=P=>{P.keyCode===13&&c(a?.productId,r()===""?null:parseFloat(r())),P.keyCode===27&&c(a?.productId,r()===""?null:parseFloat(r())),P.keyCode===9&&c(a?.productId,r()===""?null:parseFloat(r()))},ue.$$input=P=>{const w=P.target.value;n(w)},lt(ue,"tabindex",h),ue.style.setProperty("width","100px"),ue.style.setProperty("padding","0.5rem"),ue.style.setProperty("border","1px solid var(--border-color)"),ue.style.setProperty("border-radius","var(--border-radius-sm)"),ue.style.setProperty("text-align","center"),ie.style.setProperty("padding","1rem"),ie.style.setProperty("text-align","center"),I.style.setProperty("font-weight","600"),s(I,()=>a?.variance>0?"+":"",null),s(I,()=>a?.variance||"—",null),b.style.setProperty("padding","1rem"),v.addEventListener("blur",P=>{u(a?.productId,i())}),v.$$keydown=P=>{P.keyCode===13&&u(a?.productId,i()),P.keyCode===27&&u(a?.productId,i()),P.keyCode===9&&u(a?.productId,i())},v.$$input=P=>{const w=P.target.value;o(w)},v.style.setProperty("width","200px"),v.style.setProperty("padding","0.5rem"),v.style.setProperty("border","1px solid var(--border-color)"),v.style.setProperty("border-radius","var(--border-radius-sm)"),ne(P=>{var w=a?.physicalCount!==null?a?.variance!==0?"#fff3cd":"#d4edda":"transparent",A=a?.variance>0?"#4caf50":a?.variance<0?"#f44336":"var(--text-muted)",y=e("inventory.addNotes","Add notes...");return w!==P.e&&((P.e=w)!=null?f.style.setProperty("background",w):f.style.removeProperty("background")),A!==P.t&&((P.t=A)!=null?I.style.setProperty("color",A):I.style.removeProperty("color")),y!==P.a&&lt(v,"placeholder",P.a=y),P},{e:void 0,t:void 0,a:void 0}),ne(()=>ue.value=r()||""),ne(()=>v.value=i()||""),f})()};St(["click","input","keydown"]);function rI(t,e=300,r=!1){let n,i;const o=()=>{n!==void 0&&(clearTimeout(n),n=void 0),i=void 0},a=()=>{n!==void 0&&i!==void 0&&(clearTimeout(n),n=void 0,t(...i),i=void 0)},c=(...u)=>{i=u,n!==void 0&&clearTimeout(n),r&&n===void 0&&t(...u),n=window.setTimeout(()=>{r||t(...u),n=void 0,i=void 0},e)};return to(()=>{o()}),{debounced:c,cancel:o,flush:a}}function nI(t,e=300){const[r,n]=ye(!1);let i;const o=async h=>{if(i&&i.abort(),!h.trim()){n(!1);return}i=new AbortController,n(!0);try{await t(h)}catch(f){f instanceof Error&&f.name!=="AbortError"&&console.error("Search error:",f)}finally{i.signal.aborted||n(!1)}},{debounced:a,cancel:c}=rI(o,e,!1),u=()=>{c(),i&&i.abort(),n(!1)};return to(()=>{u()}),{search:a,isSearching:r,cancel:u}}var xh=z("<div>"),iI=z("<div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),oI=z("<div><h3></h3><div><div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><div><span></span><span></span></div><div><span></span><span>%"),sI=z("<div><h4>"),aI=z("<div><h3></h3><div><div><div><span></span><span> </span></div><div><span></span><span> </span></div></div><div><div><span></span><span> </span></div><div><span></span><span>"),lI=z("<div><h3></h3><div><span></span><span></span></div><div><span></span><span>"),Th=z("<div><h3>"),cI=z("<div><div><div><h2></h2><div>SKU: <!> • </div></div><div></div></div><div><button></button><button></button><button></button></div><div>"),uI=z("<span>✓ "),dI=z("<span>✗ "),hI=z("<div><div><span><span> • </span></span><span> </span></div><div>: <!> • <!>: "),mI=z("<div>📦 "),fI=z("<div>Ref: "),yI=z("<div><div><div><span></span><span></span><span></span></div><div><span></span></div></div><div><div> </div><div>"),gI=z("<div><h4></h4><div></div><div>"),pI=z("<div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div> <!> × </div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div>Min: <!> • Max: ");const vI=t=>{const{t:e}=ot(),[r,n]=ye("details"),i=qe(()=>{if(!t.product)return null;const v=Re.getTotalStockByProduct(t.product.id),P=Re.getStockByProduct(t.product.id),w=v<=t.product.minStockLevel,A=v===0,y=v>=t.product.maxStockLevel;return{total:v,byLocation:P,status:A?"out":w?"low":y?"over":"good",statusText:A?e("products.outOfStock","Out of Stock"):w?e("products.lowStock","Low Stock"):y?e("products.overStock","Over Stock"):e("products.inStock","In Stock")}}),o=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(v),a=v=>new Date(v).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),c=qe(()=>!t.product||t.product.unitCost===0?0:((t.product.sellingPrice-t.product.unitCost)/t.product.unitCost*100).toFixed(2)),u=qe(()=>t.product?Re.movements.filter(v=>v.productId===t.product.id).sort((v,P)=>new Date(P.createdDate).getTime()-new Date(v.createdDate).getTime()):[]),h=qe(()=>{if(!t.product)return null;const v=u(),P=i(),w=new Date;w.setDate(w.getDate()-30);const A=v.filter(de=>new Date(de.createdDate)>=w),y=v.reduce((de,H)=>{const $=H.productId===t.product.id?H:null;return de+($?$.quantity*$.unitCost:0)},0);return{recentMovements:v.length,movements30Days:A.length,totalValue:(P?.total||0)*t.product.unitCost,averageMovementValue:v.length>0?y/v.length:0,lastMovementDate:v.length>0?v[0].createdDate:null}}),f={"margin-bottom":"2rem"},p={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},_={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},C={"font-weight":"400",color:"var(--text-primary)","font-size":"1rem"},N=v=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[v]||"📋";function E(v){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[v]||{bg:"#f5f5f5",color:"#666"}}const T=v=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:E(v).bg,color:E(v).color}),x=v=>{const P={good:{background:"#d4edda",color:"#155724"},low:{background:"#fff3cd",color:"#856404"},out:{background:"#f8d7da",color:"#721c24"},over:{background:"#cce5ff",color:"#004085"}};return{display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500",...P[v]||P.good}},q={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"},ee={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-bottom":"0.75rem"},Y={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem","padding-bottom":"1rem","border-bottom":"2px solid var(--border-color)"},ue={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},ie=v=>({padding:"0.75rem 1.5rem",background:"none",border:"none","border-bottom":v?"2px solid var(--primary-color)":"2px solid transparent",color:v?"var(--primary-color)":"var(--text-muted)","font-weight":v?"600":"400",cursor:"pointer",transition:"all 0.2s","font-size":"0.875rem"}),I={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-bottom":"0.5rem"},b={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1.5rem","margin-bottom":"1rem"};return S(mr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("products.productDetails","Product Details")},size:"large",get children(){return S(Ve,{get when(){return t.product},get fallback(){return(()=>{var v=xh();return v.style.setProperty("text-align","center"),v.style.setProperty("padding","2rem"),v.style.setProperty("color","var(--text-muted)"),s(v,()=>e("products.noProductSelected","No product selected")),v})()},children:v=>(()=>{var P=cI(),w=P.firstChild,A=w.firstChild,y=A.firstChild,de=y.nextSibling,H=de.firstChild,$=H.nextSibling;$.nextSibling;var Z=A.nextSibling,k=w.nextSibling,F=k.firstChild,B=F.nextSibling,W=B.nextSibling,fe=k.nextSibling;return s(P,()=>JSON.stringify(v),w),d(w,Y),y.style.setProperty("margin","0"),y.style.setProperty("font-size","1.5rem"),y.style.setProperty("margin-bottom","0.25rem"),s(y,()=>v().name),de.style.setProperty("color","var(--text-muted)"),s(de,()=>v().sku,$),s(de,()=>v().category,null),s(Z,()=>i()?.statusText),d(k,ue),F.$$click=()=>n("details"),s(F,()=>e("products.details","Details")),B.$$click=()=>n("movements"),s(B,()=>e("products.movements","Movements")),W.$$click=()=>n("analytics"),s(W,()=>e("products.analytics","Analytics")),s(P,S(Ve,{get when(){return r()==="details"},get children(){return[(()=>{var K=iI(),he=K.firstChild,D=he.nextSibling,U=D.firstChild,Q=U.nextSibling,J=D.nextSibling,ce=J.firstChild,oe=ce.nextSibling,O=J.nextSibling,re=O.firstChild,pe=re.nextSibling;return he.style.setProperty("margin-bottom","1rem"),he.style.setProperty("font-size","1.1rem"),s(he,()=>e("products.basicInformation","Basic Information")),s(U,()=>e("products.description","Description")),s(Q,()=>v().description||e("common.notAvailable","N/A")),s(ce,()=>e("products.unitOfMeasure","Unit of Measure")),s(oe,()=>v().unitOfMeasure),s(re,()=>e("products.status","Status")),s(pe,(()=>{var ve=me(()=>!!v().isActive);return()=>ve()?(()=>{var te=uI();return te.firstChild,te.style.setProperty("color","#2e7d32"),s(te,()=>e("common.active","Active"),null),te})():(()=>{var te=dI();return te.firstChild,te.style.setProperty("color","#d32f2f"),s(te,()=>e("common.inactive","Inactive"),null),te})()})()),ne(ve=>{var te=f,se=p,R=_,M=C,V=p,ge=_,le=C,j=p,G=_,Pe=C;return ve.e=d(K,te,ve.e),ve.t=d(D,se,ve.t),ve.a=d(U,R,ve.a),ve.o=d(Q,M,ve.o),ve.i=d(J,V,ve.i),ve.n=d(ce,ge,ve.n),ve.s=d(oe,le,ve.s),ve.h=d(O,j,ve.h),ve.r=d(re,G,ve.r),ve.d=d(pe,Pe,ve.d),ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),K})(),(()=>{var K=oI(),he=K.firstChild,D=he.nextSibling,U=D.firstChild,Q=U.firstChild,J=Q.firstChild,ce=J.nextSibling,oe=Q.nextSibling,O=oe.firstChild,re=O.nextSibling,pe=U.nextSibling,ve=pe.firstChild,te=ve.firstChild,se=te.nextSibling,R=ve.nextSibling,M=R.firstChild,V=M.nextSibling,ge=V.firstChild;return he.style.setProperty("margin-bottom","1rem"),he.style.setProperty("font-size","1.1rem"),s(he,()=>e("products.pricingInformation","Pricing Information")),s(J,()=>e("products.unitCost","Unit Cost")),s(ce,()=>o(v().unitCost)),s(O,()=>e("products.sellingPrice","Selling Price")),s(re,()=>o(v().sellingPrice)),s(te,()=>e("products.profit","Profit")),s(se,()=>o(v().sellingPrice-v().unitCost)),s(M,()=>e("products.profitMargin","Profit Margin")),s(V,c,ge),ne(le=>{var j=f,G=q,Pe=p,_e=_,ae=C,be=p,X=_,Ce=C,$e=p,Ee=_,xe=C,Oe=p,He=_,je=C;return le.e=d(K,j,le.e),le.t=d(D,G,le.t),le.a=d(Q,Pe,le.a),le.o=d(J,_e,le.o),le.i=d(ce,ae,le.i),le.n=d(oe,be,le.n),le.s=d(O,X,le.s),le.h=d(re,Ce,le.h),le.r=d(ve,$e,le.r),le.d=d(te,Ee,le.d),le.l=d(se,xe,le.l),le.u=d(R,Oe,le.u),le.c=d(M,He,le.c),le.w=d(V,je,le.w),le},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),K})(),(()=>{var K=aI(),he=K.firstChild,D=he.nextSibling,U=D.firstChild,Q=U.firstChild,J=Q.firstChild,ce=J.nextSibling,oe=ce.firstChild,O=Q.nextSibling,re=O.firstChild,pe=re.nextSibling,ve=pe.firstChild,te=U.nextSibling,se=te.firstChild,R=se.firstChild,M=R.nextSibling,V=M.firstChild,ge=se.nextSibling,le=ge.firstChild,j=le.nextSibling;return he.style.setProperty("margin-bottom","1rem"),he.style.setProperty("font-size","1.1rem"),s(he,()=>e("products.stockInformation","Stock Information")),s(J,()=>e("products.totalStock","Total Stock")),s(ce,()=>i()?.total||0,oe),s(ce,()=>v().unitOfMeasure,null),s(re,()=>e("products.minStockLevel","Min Stock Level")),s(pe,()=>v().minStockLevel,ve),s(pe,()=>v().unitOfMeasure,null),s(R,()=>e("products.maxStockLevel","Max Stock Level")),s(M,()=>v().maxStockLevel,V),s(M,()=>v().unitOfMeasure,null),s(le,()=>e("products.stockValue","Stock Value")),s(j,()=>o((i()?.total||0)*v().unitCost)),s(K,S(Ve,{get when(){return me(()=>!!i()?.byLocation)()&&i().byLocation.length>0},get children(){var G=sI(),Pe=G.firstChild;return G.style.setProperty("margin-top","1.5rem"),Pe.style.setProperty("margin-bottom","1rem"),Pe.style.setProperty("font-size","1rem"),s(Pe,()=>e("products.stockByLocation","Stock by Location")),s(G,()=>i().byLocation.map(_e=>(()=>{var ae=hI(),be=ae.firstChild,X=be.firstChild,Ce=X.firstChild;Ce.firstChild;var $e=X.nextSibling,Ee=$e.firstChild,xe=be.nextSibling,Oe=xe.firstChild,He=Oe.nextSibling,je=He.nextSibling,Ie=je.nextSibling;return Ie.nextSibling,d(ae,ee),be.style.setProperty("display","flex"),be.style.setProperty("justify-content","space-between"),be.style.setProperty("align-items","center"),X.style.setProperty("font-weight","500"),X.style.setProperty("color","var(--primary-color)"),s(X,()=>_e.locationId,Ce),Ce.style.setProperty("font-weight","500"),Ce.style.setProperty("color","var(--text-muted)"),s(Ce,()=>_e.locationName,null),$e.style.setProperty("font-weight","600"),s($e,()=>_e.quantity,Ee),s($e,()=>v().unitOfMeasure,null),xe.style.setProperty("margin-top","0.5rem"),xe.style.setProperty("font-size","0.875rem"),xe.style.setProperty("color","var(--text-muted)"),s(xe,()=>e("products.available","Available"),Oe),s(xe,()=>_e.availableQuantity,He),s(xe,()=>e("products.reserved","Reserved"),Ie),s(xe,()=>_e.reservedQuantity,null),ne(Be=>(Be=_e.quantity>0?"var(--primary-color)":"var(--text-muted)")!=null?$e.style.setProperty("color",Be):$e.style.removeProperty("color")),ae})()),null),G}}),null),ne(G=>{var Pe=f,_e=q,ae=p,be=_,X=C,Ce=p,$e=_,Ee=C,xe=p,Oe=_,He=C,je=p,Ie=_,Be=C;return G.e=d(K,Pe,G.e),G.t=d(D,_e,G.t),G.a=d(Q,ae,G.a),G.o=d(J,be,G.o),G.i=d(ce,X,G.i),G.n=d(O,Ce,G.n),G.s=d(re,$e,G.s),G.h=d(pe,Ee,G.h),G.r=d(se,xe,G.r),G.d=d(R,Oe,G.d),G.l=d(M,He,G.l),G.u=d(ge,je,G.u),G.c=d(le,Ie,G.c),G.w=d(j,Be,G.w),G},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),K})(),(()=>{var K=lI(),he=K.firstChild,D=he.nextSibling,U=D.firstChild,Q=U.nextSibling,J=D.nextSibling,ce=J.firstChild,oe=ce.nextSibling;return he.style.setProperty("margin-bottom","1rem"),he.style.setProperty("font-size","1.1rem"),s(he,()=>e("products.timestamps","Timestamps")),s(U,()=>e("common.createdDate","Created Date")),s(Q,()=>a(v().createdDate)),s(ce,()=>e("common.lastModified","Last Modified")),s(oe,()=>a(v().lastModified)),ne(O=>{var re=f,pe=p,ve=_,te=C,se=p,R=_,M=C;return O.e=d(K,re,O.e),O.t=d(D,pe,O.t),O.a=d(U,ve,O.a),O.o=d(Q,te,O.o),O.i=d(J,se,O.i),O.n=d(ce,R,O.n),O.s=d(oe,M,O.s),O},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),K})()]}}),fe),s(P,S(Ve,{get when(){return r()==="movements"},get children(){var K=Th(),he=K.firstChild;return he.style.setProperty("margin-bottom","1rem"),he.style.setProperty("font-size","1.1rem"),s(he,()=>e("products.recentMovements","Recent Movements")),s(K,S(Ve,{get when(){return u().length>0},get fallback(){return(()=>{var D=mI();return D.firstChild,D.style.setProperty("text-align","center"),D.style.setProperty("padding","2rem"),D.style.setProperty("color","var(--text-muted)"),D.style.setProperty("background","var(--surface-color)"),D.style.setProperty("border-radius","var(--border-radius-sm)"),D.style.setProperty("border","1px solid var(--border-color)"),s(D,()=>e("products.noMovements","No movements found for this product"),null),D})()},get children(){return S(Mt,{get each(){return u()},children:D=>{const U=D.productId===v().id?D:null;if(!U)return null;let Q=Re.getLocationById(D.locationId);return(()=>{var J=yI(),ce=J.firstChild,oe=ce.firstChild,O=oe.firstChild,re=O.nextSibling,pe=re.nextSibling,ve=oe.nextSibling,te=ve.firstChild,se=ce.nextSibling,R=se.firstChild,M=R.firstChild,V=R.nextSibling;return d(J,I),oe.style.setProperty("font-weight","600"),oe.style.setProperty("margin-bottom","0.25rem"),O.style.setProperty("font-size","1.2rem"),s(O,()=>N(D.movementType)),re.style.setProperty("padding","0 6px"),s(pe,()=>D.movementType),ve.style.setProperty("font-size","0.875rem"),ve.style.setProperty("color","var(--text-muted)"),s(ve,()=>` ${a(D?.createdDate)} • `,te),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("font-weight","600"),te.style.setProperty("color","var(--primary-color)"),s(te,()=>D?.locationId),s(ve,()=>` • ${Q?.name}`,null),s(ce,S(Ve,{get when(){return D.referenceNumber},get children(){var ge=fI();return ge.firstChild,ge.style.setProperty("font-size","0.75rem"),ge.style.setProperty("color","var(--text-muted)"),ge.style.setProperty("margin-top","0.25rem"),s(ge,()=>D?.referenceNumber,null),ge}}),null),se.style.setProperty("text-align","right"),R.style.setProperty("font-weight","600"),R.style.setProperty("font-size","1rem"),s(R,()=>D?.movementType==="in"?"+":"",M),s(R,()=>U.quantity,M),s(R,()=>v().unitOfMeasure,null),V.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","var(--text-muted)"),s(V,()=>o(U.unitCost)),ne(ge=>{var le=T(D.movementType),j=D?.movementType==="in"?"#2e7d32":"#d32f2f";return ge.e=d(pe,le,ge.e),j!==ge.t&&((ge.t=j)!=null?R.style.setProperty("color",j):R.style.removeProperty("color")),ge},{e:void 0,t:void 0}),J})()}})}}),null),ne(D=>d(K,f,D)),K}}),fe),s(P,S(Ve,{get when(){return r()==="analytics"},get children(){var K=Th(),he=K.firstChild;return he.style.setProperty("margin-bottom","1rem"),he.style.setProperty("font-size","1.1rem"),s(he,()=>e("products.analytics","Analytics")),s(K,S(Ve,{get when(){return h()},get fallback(){return(()=>{var D=xh();return D.style.setProperty("text-align","center"),D.style.setProperty("padding","2rem"),D.style.setProperty("color","var(--text-muted)"),s(D,()=>e("products.noAnalytics","No analytics data available")),D})()},children:D=>(()=>{var U=pI(),Q=U.firstChild,J=Q.firstChild,ce=J.nextSibling,oe=ce.nextSibling,O=Q.nextSibling,re=O.firstChild,pe=re.nextSibling,ve=pe.nextSibling,te=O.nextSibling,se=te.firstChild,R=se.nextSibling,M=R.nextSibling,V=M.firstChild,ge=V.nextSibling;ge.nextSibling;var le=te.nextSibling,j=le.firstChild,G=j.nextSibling,Pe=G.nextSibling,_e=le.nextSibling,ae=_e.firstChild,be=ae.nextSibling,X=be.nextSibling,Ce=X.firstChild,$e=Ce.nextSibling;return $e.nextSibling,J.style.setProperty("margin","0 0 0.5rem 0"),J.style.setProperty("color","var(--primary-color)"),s(J,()=>e("products.totalMovements","Total Movements")),ce.style.setProperty("font-size","1.5rem"),ce.style.setProperty("font-weight","600"),s(ce,()=>D().recentMovements),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),oe.style.setProperty("margin-top","0.25rem"),s(oe,()=>e("products.allTime","All time")),re.style.setProperty("margin","0 0 0.5rem 0"),re.style.setProperty("color","var(--primary-color)"),s(re,()=>e("products.last30Days","Last 30 Days")),pe.style.setProperty("font-size","1.5rem"),pe.style.setProperty("font-weight","600"),s(pe,()=>D().movements30Days),ve.style.setProperty("font-size","0.875rem"),ve.style.setProperty("color","var(--text-muted)"),ve.style.setProperty("margin-top","0.25rem"),s(ve,()=>e("products.movements","movements")),se.style.setProperty("margin","0 0 0.5rem 0"),se.style.setProperty("color","var(--primary-color)"),s(se,()=>e("products.currentValue","Current Stock Value")),R.style.setProperty("font-size","1.5rem"),R.style.setProperty("font-weight","600"),s(R,()=>o(D().totalValue)),M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),M.style.setProperty("margin-top","0.25rem"),s(M,()=>i()?.total||0,V),s(M,()=>v().unitOfMeasure,ge),s(M,()=>o(v().unitCost),null),j.style.setProperty("margin","0 0 0.5rem 0"),j.style.setProperty("color","var(--primary-color)"),s(j,()=>e("products.avgMovementValue","Avg Movement Value")),G.style.setProperty("font-size","1.5rem"),G.style.setProperty("font-weight","600"),s(G,()=>o(D().averageMovementValue)),Pe.style.setProperty("font-size","0.875rem"),Pe.style.setProperty("color","var(--text-muted)"),Pe.style.setProperty("margin-top","0.25rem"),s(Pe,()=>e("products.perMovement","per movement")),s(U,S(Ve,{get when(){return D().lastMovementDate},get children(){var Ee=gI(),xe=Ee.firstChild,Oe=xe.nextSibling,He=Oe.nextSibling;return xe.style.setProperty("margin","0 0 0.5rem 0"),xe.style.setProperty("color","var(--primary-color)"),s(xe,()=>e("products.lastMovement","Last Movement")),Oe.style.setProperty("font-size","1.25rem"),Oe.style.setProperty("font-weight","600"),s(Oe,()=>a(D().lastMovementDate)),He.style.setProperty("font-size","0.875rem"),He.style.setProperty("color","var(--text-muted)"),He.style.setProperty("margin-top","0.25rem"),s(He,()=>e("products.mostRecent","Most recent activity")),ne(je=>d(Ee,b,je)),Ee}}),_e),ae.style.setProperty("margin","0 0 0.5rem 0"),ae.style.setProperty("color","var(--primary-color)"),s(ae,()=>e("products.stockStatus","Stock Status")),be.style.setProperty("font-size","1.25rem"),be.style.setProperty("font-weight","600"),s(be,()=>i()?.statusText),X.style.setProperty("font-size","0.875rem"),X.style.setProperty("color","var(--text-muted)"),X.style.setProperty("margin-top","0.25rem"),s(X,()=>v().minStockLevel,$e),s(X,()=>v().maxStockLevel,null),ne(Ee=>{var xe=q,Oe=b,He=b,je=b,Ie=b,Be=b;return Ee.e=d(U,xe,Ee.e),Ee.t=d(Q,Oe,Ee.t),Ee.a=d(O,He,Ee.a),Ee.o=d(te,je,Ee.o),Ee.i=d(le,Ie,Ee.i),Ee.n=d(_e,Be,Ee.n),Ee},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),U})()}),null),ne(D=>d(K,f,D)),K}}),fe),fe.style.setProperty("display","flex"),fe.style.setProperty("gap","1rem"),fe.style.setProperty("justify-content","flex-end"),fe.style.setProperty("margin-top","2rem"),s(fe,S(De,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close","Close")}}),null),s(fe,S(Ve,{get when(){return t.onEdit},get children(){return S(De,{variant:"primary",get onClick(){return t.onEdit},get children(){return e("common.edit","Edit")}})}}),null),ne(K=>{var he=x(i()?.status||"good"),D=ie(r()==="details"),U=ie(r()==="movements"),Q=ie(r()==="analytics");return K.e=d(Z,he,K.e),K.t=d(F,D,K.t),K.a=d(B,U,K.a),K.o=d(W,Q,K.o),K},{e:void 0,t:void 0,a:void 0,o:void 0}),P})()})}})};St(["click"]);var bI=z("<div>🔄"),_I=z("<button type=button>×"),SI=z("<div>⚠️ "),$h=z("<div>"),PI=z("<div><div><input type=text autocomplete=off>"),wI=z("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>"),CI=z("<span>⚠️ ");const AI=t=>{const{t:e}=ot(),[r,n]=ye(""),[i,o]=ye(!1),[a,c]=ye(null),[u,h]=ye([]),[f,p]=ye(!1),[_,C]=ye(-1),[N,E]=ye(null),T=t.searchDelay||300,x=t.maxResults||900,q=async D=>{if(!D.trim()||D.trim().length<3){h([]),t.onSearchResults?.([]);return}try{o(!0),c(null);try{const U=await Fn.getProducts(D),Q=Object.keys(U),J=oe=>{let O=U;return{id:oe,name:O[oe].name,businessId:O[oe].businessId,sku:O[oe].code,UPC:O[oe].UPC,numCode:O[oe].codeN,category:O[oe].category,unitCost:O[oe].unitCost||0,unitOfMeasure:O[oe].unitOfMeasure,minStockLevel:O[oe].minStockLevel,maxStockLevel:O[oe].maxStockLevel,isActive:O[oe].isActive,description:O[oe].description||"",createdDate:O[oe].createdAt||new Date().toISOString(),lastModified:O[oe].updatedAt||new Date().toISOString()}},ce=Q.map(J);h(ce),Re.updProduct(ce),t.onSearchResults?.(ce)}catch(U){console.warn("API search failed, using local fallback:",U),c("API search failed, showing local results");const Q=Re.getActiveProducts().filter(J=>J.name.toLowerCase().includes(D.toLowerCase())||J.sku.toLowerCase().includes(D.toLowerCase())||J.category.toLowerCase().includes(D.toLowerCase())).slice(0,x);h(Q),t.onSearchResults?.(Q)}}catch(U){const Q=U instanceof Error?U.message:"Search failed";c(Q),h([]),t.onSearchResults?.([])}finally{o(!1)}},ee=D=>{const Q=D.target.value;n(Q),c(null),t.showResults!==!1&&p(!0),N()&&clearTimeout(N());const J=setTimeout(()=>{q(Q)},T);E(J)},Y=D=>{n(D.name),p(!1),C(-1),t.onProductSelect?.(D)},ue=D=>{if(!(!f()||u().length===0))switch(D.key){case"ArrowDown":D.preventDefault(),C(U=>Math.min(U+1,u().length-1));break;case"ArrowUp":D.preventDefault(),C(U=>Math.max(U-1,-1));break;case"Enter":D.preventDefault(),_()>=0&&u()[_()]&&Y(u()[_()]);break;case"Escape":p(!1),C(-1);break}},ie=()=>{t.showResults!==!1&&u().length>0&&p(!0)},I=()=>{setTimeout(()=>{p(!1),C(-1)},150)},b=()=>{n(""),h([]),c(null),p(!1),C(-1),t.onSearchResults?.([]),N()&&(clearTimeout(N()),E(null))},v=D=>Re.stockLevels.filter(U=>U.productId===D).reduce((U,Q)=>U+Q.quantity,0),P=D=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(D),w={position:"relative",width:"100%",...t.style},A={position:"relative",display:"flex","align-items":"center"},y={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},de={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},H={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},$={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},Z=D=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:D?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),k={display:"flex","justify-content":"space-between","align-items":"center"},F={flex:"1"},B={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},W={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},fe={"text-align":"right","font-size":"0.875rem"},K={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},he={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var D=PI(),U=D.firstChild,Q=U.firstChild;return Q.addEventListener("blur",I),Q.addEventListener("focus",ie),Q.$$keydown=ue,Q.$$input=ee,s(U,S(Ve,{get when(){return i()},get children(){var J=bI();return ne(ce=>d(J,H,ce)),J}}),null),s(U,S(Ve,{get when(){return me(()=>!!r())()&&!i()},get children(){var J=_I();return J.addEventListener("mouseleave",ce=>{ce.currentTarget.style.background="none",ce.currentTarget.style.color="var(--text-muted)"}),J.addEventListener("mouseenter",ce=>{ce.currentTarget.style.background="var(--border-color)",ce.currentTarget.style.color="var(--text-primary)"}),J.$$click=b,ne(ce=>{var oe=de,O=e("common.clear","Clear search");return ce.e=d(J,oe,ce.e),O!==ce.t&&lt(J,"title",ce.t=O),ce},{e:void 0,t:void 0}),J}}),null),s(D,S(Ve,{get when(){return f()&&t.showResults!==!1},get children(){var J=$h();return s(J,S(Ve,{get when(){return a()},get children(){var ce=SI();return ce.firstChild,d(ce,he),s(ce,a,null),ce}}),null),s(J,S(Ve,{get when(){return u().length>0},get fallback(){return me(()=>!!(r()&&!i()))()&&(()=>{var ce=$h();return d(ce,K),s(ce,()=>e("inventory.noProductsFound","No products found matching your search.")),ce})()},get children(){return S(Mt,{get each(){return u()},children:(ce,oe)=>{const O=v(ce.id),re=O<=ce.minStockLevel;return(()=>{var pe=wI(),ve=pe.firstChild,te=ve.firstChild,se=te.firstChild,R=se.nextSibling,M=R.firstChild,V=M.firstChild,ge=M.nextSibling,le=ge.nextSibling,j=le.nextSibling,G=j.nextSibling,Pe=te.nextSibling,_e=Pe.firstChild,ae=_e.firstChild,be=_e.nextSibling;return pe.addEventListener("mouseenter",()=>C(oe())),pe.$$click=()=>Y(ce),d(ve,k),d(te,F),d(se,B),s(se,()=>ce.name),d(R,W),s(M,()=>e("inventory.sku","SKU"),V),s(M,()=>ce.sku,null),s(le,()=>ce.category),s(G,()=>P(ce.unitCost)),d(Pe,fe),_e.style.setProperty("font-weight","600"),(re?"#f44336":"var(--text-primary)")!=null?_e.style.setProperty("color",re?"#f44336":"var(--text-primary)"):_e.style.removeProperty("color"),s(_e,O,ae),s(_e,()=>ce.unitOfMeasure,null),be.style.setProperty("color","var(--text-muted)"),s(be,()=>re?(()=>{var X=CI();return X.firstChild,X.style.setProperty("color","#f44336"),s(X,()=>e("inventory.lowStock","Low Stock"),null),X})():e("inventory.inStock","In Stock")),ne(X=>d(pe,Z(oe()===_()),X)),pe})()}})}}),null),ne(ce=>d(J,$,ce)),J}}),null),ne(J=>{var ce=w,oe=A,O=y,re=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),pe=t.disabled;return J.e=d(D,ce,J.e),J.t=d(U,oe,J.t),J.a=d(Q,O,J.a),re!==J.o&&lt(Q,"placeholder",J.o=re),pe!==J.i&&(Q.disabled=J.i=pe),J},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ne(()=>Q.value=r()),D})()};St(["input","keydown","click"]);var II=z("<div><div><h2></h2><div><div>"),EI=z("<div><span>"),xI=z("<span>🔍 "),TI=z("<div><div><div><div><h3></h3><span></span></div><div></div><div>: </div></div><div><div> </div><div>: <!> • <!>: </div><div>: "),$I=z("<div><div>:</div><div>"),kI=z("<div>: "),RI=z("<div><div><span>:</span><select><option value=10>10</option><option value=20>20</option><option value=50>50</option><option value=100>100</option></select></div><div><div><span></span><input type=number min=1><span> </span></div></div><div>");const By=()=>{const{t}=ot(),[e,r]=ye(""),[n,i]=ye(""),[o,a]=ye([]),[c,u]=ye(!1),[h,f]=ye(null),[p,_]=ye(!1),[C,N]=ye(!1),[E,T]=ye(!1),[x,q]=ye(null),[ee,Y]=ye(!1),[ue,ie]=ye([]),[I,b]=ye(!1),[v,P]=ye(1),[w,A]=ye(20);cn(async()=>{await y()});const y=async()=>{try{u(!0),f(null);try{const D=await Bu.getAll();a(D.map(U=>({id:U.id||`prod-${Date.now()}-${Math.random()}`,name:U.productName||U.name||"Unknown Product",sku:U.sku||U.productCode||"",description:U.description||"",category:U.category||"General",unitOfMeasure:U.unitOfMeasure||"pcs",unitCost:parseFloat(U.unitCost||U.cost||"0"),sellingPrice:parseFloat(U.sellingPrice||U.price||"0"),minStockLevel:parseInt(U.minStockLevel||"0"),maxStockLevel:parseInt(U.maxStockLevel||"100"),isActive:U.isActive!==!1,createdDate:U.createdDate||new Date().toISOString(),lastModified:U.lastModified||new Date().toISOString(),businessId:U.businessId||"YB100423253156428"})))}catch(D){console.warn("API failed, using local store:",D),a(Re.products)}}catch(D){f(D instanceof Error?D.message:"Failed to load products")}finally{u(!1)}},de=async()=>{try{u(!0),f(null);try{const D=await Fn.getProducts("prod"),U=Object.keys(D),Q=ce=>{let O=D[ce];return{id:O.id,name:O.name,businessId:O.businessId,sku:O.code,numCode:O.codeN,category:O.category,unitCost:O.unitCost||0,unitOfMeasure:O.unitOfMeasure,minStockLevel:O.minStockLevel,maxStockLevel:O.maxStockLevel,isActive:O.isActive,description:O.description||"",createdDate:O.createdAt||new Date().toISOString(),lastModified:O.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(O.sellingPrice||O.price||"0")}},J=U.map(Q);a(J)}catch(D){console.warn("API failed, using local store:",D),a(Re.products)}}catch(D){f(D instanceof Error?D.message:"Failed to load products")}finally{u(!1)}},{cancel:H}=nI(async D=>{if(!D.trim()){await y();return}try{f(null);const U=await Bu.getAll(D);a(U.map(Q=>({id:Q.id||`prod-${Date.now()}-${Math.random()}`,name:Q.productName||Q.name||"Unknown Product",sku:Q.sku||Q.productCode||"",description:Q.description||"",category:Q.category||"General",unitOfMeasure:Q.unitOfMeasure||"pcs",unitCost:parseFloat(Q.unitCost||Q.cost||"0"),sellingPrice:parseFloat(Q.sellingPrice||Q.price||"0"),minStockLevel:parseInt(Q.minStockLevel||"0"),maxStockLevel:parseInt(Q.maxStockLevel||"100"),isActive:Q.isActive!==!1,createdDate:Q.createdDate||new Date().toISOString(),lastModified:Q.lastModified||new Date().toISOString(),businessId:Q.businessId||"YB100423253156428"})))}catch(U){f(U instanceof Error?U.message:"Search failed");const Q=Re.products.filter(J=>J.name.toLowerCase().includes(D.toLowerCase())||J.sku.toLowerCase().includes(D.toLowerCase())||J.category.toLowerCase().includes(D.toLowerCase()));a(Q)}},300);to(()=>{H()}),qe(()=>{let D=o();return n()&&(D=D.filter(U=>U.category===n())),D}),qe(()=>[...new Set(o().map(U=>U.category))].sort()),qe(()=>{const D=o().filter(J=>J.isActive),U=o().length,Q=o().filter(J=>Re.getTotalStockByProduct(J.id)===0);return{total:U,active:D.length,outOfStock:Q.length}});const $=D=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(D),Z={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},k={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},F=D=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:D?"#ffebee":"#e8f5e8",color:D?"#d32f2f":"#2d7d32"});qe(()=>{const D=Re.products||[],U=Re.movements||[],Q=Re.stockLevels||[],J=Re.getLowStockProducts(),ce=D?.length||0,oe=D?.filter(pe=>pe.isActive).length,O=Q.reduce((pe,ve)=>pe*1+ve.quantity*1*ve.averageCost*1,0),re=U?.filter(pe=>{const ve=new Date(pe.createdDate),te=new Date;return ve.getMonth()===te.getMonth()&&ve.getFullYear()===te.getFullYear()}).length;return{totalProducts:ce,activeProducts:oe,lowStockProducts:J.length,totalStockValue:O,totalMovementsThisMonth:re,totalLocations:Re.locations.length,activeLocations:Re.getActiveLocations().length}});const B=qe(()=>Re.products.map(D=>{const U=Re.getStockByProduct(D.id),Q=Re.getTotalStockByProduct(D.id),J=Re.getLastLocationByProduct(D.id);return{...D,totalStock:Q,stockByLocation:U,lastLocation:J,isLowStock:Q<=D.minStockLevel}})),W=qe(()=>ue().map(D=>{const U=Re.getStockByProduct(D.id),Q=Re.getTotalStockByProduct(D.id),J=Re.getLastLocationByProduct(D.id);return{...D,totalStock:Q,stockByLocation:U,lastLocation:J,isLowStock:Q<=D.minStockLevel}})),fe=qe(()=>{const D=I()?W():B(),U=(v()-1)*w(),Q=U+w();return D.slice(U,Q)}),K=qe(()=>{const D=I()?W():B();return Math.ceil(D.length/w())}),he=D=>{q(D),N(!0)};return S(Fr,{get title(){return t("products.title","Products")},get children(){return[(()=>{var D=II(),U=D.firstChild,Q=U.firstChild,J=Q.nextSibling,ce=J.firstChild;return D.style.setProperty("display","flex"),D.style.setProperty("justify-content","space-between"),D.style.setProperty("align-items","flex-start"),D.style.setProperty("margin-bottom","1.5rem"),D.style.setProperty("flex-wrap","wrap"),D.style.setProperty("gap","1rem"),U.style.setProperty("flex","1"),U.style.setProperty("min-width","300px"),Q.style.setProperty("margin","0 0 1rem 0"),Q.style.setProperty("font-size","1.5rem"),s(Q,()=>t("inventory.products")),J.style.setProperty("display","flex"),J.style.setProperty("gap","1rem"),J.style.setProperty("align-items","center"),J.style.setProperty("flex-wrap","wrap"),ce.style.setProperty("flex","1"),ce.style.setProperty("min-width","250px"),s(ce,S(AI,{onSearchResults:oe=>{ie(oe),b(oe.length>0)},get placeholder(){return t("inventory.searchProductsStock","Search products and check stock levels...")},showResults:!1,maxResults:20})),s(J,S(De,{variant:"outline",onClick:()=>{de(),b(!1)},get children(){return["🔄 ",me(()=>t("common.showAll","Show All"))]}}),null),s(D,S(Ve,{get when(){return Ut.hasPermission("read_write")},get children(){return S(De,{variant:"primary",onClick:()=>Y(!0),get children(){return["➕ ",me(()=>t("inventory.addProduct"))]}})}}),null),D})(),(()=>{var D=EI(),U=D.firstChild;return D.style.setProperty("margin-bottom","1rem"),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("color","var(--text-muted)"),D.style.setProperty("display","flex"),D.style.setProperty("justify-content","space-between"),D.style.setProperty("align-items","center"),s(U,(()=>{var Q=me(()=>!!I());return()=>Q()?`${t("inventory.searchResults","Search Results")}: ${W().length} ${t("common.products","products")}`:`${t("inventory.totalProducts","Total Products")}: ${B().length} ${t("common.products","products")}`})()),s(D,(()=>{var Q=me(()=>!!I());return()=>Q()&&(()=>{var J=xI();return J.firstChild,J.style.setProperty("color","var(--primary-color)"),s(J,()=>t("inventory.filtered","Filtered view"),null),J})()})(),null),D})(),S(Mt,{get each(){return fe()},children:D=>(()=>{var U=TI(),Q=U.firstChild,J=Q.firstChild,ce=J.firstChild,oe=ce.firstChild,O=oe.nextSibling,re=ce.nextSibling,pe=re.nextSibling,ve=pe.firstChild,te=J.nextSibling,se=te.firstChild,R=se.firstChild,M=se.nextSibling,V=M.firstChild,ge=V.nextSibling,le=ge.nextSibling,j=le.nextSibling;j.nextSibling;var G=M.nextSibling,Pe=G.firstChild;return U.$$click=()=>he(D),U.addEventListener("mouseleave",_e=>{_e.currentTarget.style.transform="translateY(0)",_e.currentTarget.style.boxShadow="none"}),U.addEventListener("mouseenter",_e=>{_e.currentTarget.style.transform="translateY(-2px)",_e.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),d(U,Z),d(Q,k),ce.style.setProperty("display","flex"),ce.style.setProperty("align-items","center"),ce.style.setProperty("gap","0.5rem"),ce.style.setProperty("margin-bottom","0.5rem"),oe.style.setProperty("margin","0"),oe.style.setProperty("font-size","1.1rem"),s(oe,()=>D.name),s(O,(()=>{var _e=me(()=>!!D.isLowStock);return()=>_e()?t("inventory.lowStockAlert"):t("inventory.inStock")})()),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),s(re,()=>D.sku,null),s(re,()=>D.UPC?" • "+D.UPC:"",null),s(re,()=>D.category?" • "+D.category:"",null),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),s(pe,()=>t("inventory.lastSeen"),ve),s(pe,()=>D.lastLocation?.name||t("inventory.noMovements"),null),te.style.setProperty("text-align","right"),se.style.setProperty("font-size","1.25rem"),se.style.setProperty("font-weight","700"),se.style.setProperty("color","var(--primary-color)"),s(se,()=>D.totalStock,R),s(se,()=>D.unitOfMeasure,null),M.style.setProperty("font-size","0.875rem"),M.style.setProperty("color","var(--text-muted)"),s(M,()=>t("inventory.min"),V),s(M,()=>D.minStockLevel,ge),s(M,()=>t("inventory.max"),j),s(M,()=>D.maxStockLevel,null),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-muted)"),s(G,()=>t("inventory.cost"),Pe),s(G,()=>$(D.unitCost),null),s(U,(()=>{var _e=me(()=>D.stockByLocation.length>0);return()=>_e()&&(()=>{var ae=$I(),be=ae.firstChild,X=be.firstChild,Ce=be.nextSibling;return ae.style.setProperty("margin-top","1rem"),be.style.setProperty("font-weight","500"),be.style.setProperty("margin-bottom","0.5rem"),be.style.setProperty("font-size","0.875rem"),s(be,()=>t("inventory.stockByLocation"),X),Ce.style.setProperty("display","flex"),Ce.style.setProperty("flex-wrap","wrap"),Ce.style.setProperty("gap","0.5rem"),s(Ce,S(Mt,{get each(){return D.stockByLocation},children:$e=>{const Ee=Re.getLocationById($e.locationId);return(()=>{var xe=kI(),Oe=xe.firstChild;return xe.style.setProperty("padding","0.25rem 0.5rem"),xe.style.setProperty("background","var(--background-color)"),xe.style.setProperty("border-radius","var(--border-radius-sm)"),xe.style.setProperty("font-size","0.75rem"),xe.style.setProperty("border","1px solid var(--border-color)"),s(xe,()=>Ee?.name,Oe),s(xe,()=>$e.quantity,null),xe})()}})),ae})()})(),null),ne(_e=>d(O,F(D.isLowStock),_e)),U})()}),me(()=>me(()=>K()>1)()&&(()=>{var D=RI(),U=D.firstChild,Q=U.firstChild,J=Q.firstChild,ce=Q.nextSibling,oe=U.nextSibling,O=oe.firstChild,re=O.firstChild,pe=re.nextSibling,ve=pe.nextSibling,te=ve.firstChild,se=oe.nextSibling;return D.style.setProperty("display","flex"),D.style.setProperty("justify-content","space-between"),D.style.setProperty("align-items","center"),D.style.setProperty("margin-top","2rem"),D.style.setProperty("padding","1rem"),D.style.setProperty("background","var(--surface-color)"),D.style.setProperty("border-radius","var(--border-radius)"),D.style.setProperty("border","1px solid var(--border-color)"),U.style.setProperty("display","flex"),U.style.setProperty("align-items","center"),U.style.setProperty("gap","0.5rem"),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),s(Q,()=>t("common.showPerPage","Show per page"),J),ce.addEventListener("change",R=>{A(parseInt(R.target.value)),P(1)}),ce.style.setProperty("padding","0.25rem 0.5rem"),ce.style.setProperty("border","1px solid var(--border-color)"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),ce.style.setProperty("background","var(--background-color)"),ce.style.setProperty("cursor","pointer"),oe.style.setProperty("display","flex"),oe.style.setProperty("align-items","center"),oe.style.setProperty("gap","0.5rem"),s(oe,S(De,{variant:"outline",size:"sm",onClick:()=>P(1),get disabled(){return v()===1},get children(){return t("common.first","First")}}),O),s(oe,S(De,{variant:"outline",size:"sm",onClick:()=>P(R=>Math.max(1,R-1)),get disabled(){return v()===1},get children(){return t("common.previous","Previous")}}),O),O.style.setProperty("display","flex"),O.style.setProperty("align-items","center"),O.style.setProperty("gap","0.25rem"),re.style.setProperty("font-size","0.875rem"),s(re,()=>t("common.page","Page")),pe.addEventListener("change",R=>{const M=parseInt(R.target.value);M>=1&&M<=K()&&P(M)}),pe.style.setProperty("width","60px"),pe.style.setProperty("padding","0.25rem 0.5rem"),pe.style.setProperty("border","1px solid var(--border-color)"),pe.style.setProperty("border-radius","var(--border-radius-sm)"),pe.style.setProperty("text-align","center"),pe.style.setProperty("font-size","0.875rem"),ve.style.setProperty("font-size","0.875rem"),s(ve,()=>t("common.of","of"),te),s(ve,K,null),s(oe,S(De,{variant:"outline",size:"sm",onClick:()=>P(R=>Math.min(K(),R+1)),get disabled(){return v()===K()},get children(){return t("common.next","Next")}}),null),s(oe,S(De,{variant:"outline",size:"sm",onClick:()=>P(K()),get disabled(){return v()===K()},get children(){return t("common.last","Last")}}),null),se.style.setProperty("font-size","0.875rem"),se.style.setProperty("color","var(--text-muted)"),s(se,()=>{const R=I()?W():B(),M=(v()-1)*w()+1,V=Math.min(v()*w(),R.length);return t("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:M,end:V,total:R.length})}),ne(()=>lt(pe,"max",K())),ne(()=>ce.value=w()),ne(()=>pe.value=v()),D})()),S(su,{get isOpen(){return p()},onClose:()=>_(!1),onProductAdded:()=>{y()}}),S(vI,{get isOpen(){return C()},onClose:()=>{N(!1),q(null)},get product(){return x()},onEdit:()=>{N(!1),T(!0)}})]}})};St(["click"]);var DI=z("<div><h1></h1><div><div><span>View:</span><button> 1</button><button> 2"),Ir=z("<div>"),NI=z("<div><h3></h3><div>"),LI=z("<div>: <!> "),MI=z("<div><button></button><button></button><button></button><button>"),OI=z("<div><div>"),VI=z("<div><span> (<!>)</span><span> / <!> "),BI=z("<div><div><h2></h2></div><div>"),FI=z("<div><div><div><span></span><h3></h3></div><div> • </div><div></div></div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div>:"),UI=z("<div><div><div><div></div><div></div></div><div><div> </div><div></div><div>Min: "),jI=z("<span>⚠️ LOW");const zI=()=>{const{t}=ot(),[e,r]=ye(!1),[n,i]=ye(!1),[o,a]=ye(!1),[c,u]=ye(null),[h,f]=ye("overview"),[p,_]=ye("new"),[C,N]=ye(""),[E,T]=ye(""),[x,q]=ye([]),[ee,Y]=ye(!1),[ue,ie]=ye(!1),[I,b]=ye(!1),[v,P]=ye(!1),[w,A]=ye(!1),[y,de]=ye(1),[H,$]=ye(20),Z=R=>{u(R),a(!0)},k=qe(()=>{const R=Re.products||[],M=Re.movements||[],V=Re.stockLevels||[],ge=Re.getLowStockProducts(),le=R?.length||0,j=R?.filter(_e=>_e.isActive).length,G=V.reduce((_e,ae)=>_e*1+ae.quantity*1*ae.averageCost*1,0),Pe=M?.filter(_e=>{const ae=new Date(_e.createdDate),be=new Date;return ae.getMonth()===be.getMonth()&&ae.getFullYear()===be.getFullYear()}).length;return{totalProducts:le,activeProducts:j,lowStockProducts:ge.length,totalStockValue:G,totalMovementsThisMonth:Pe,totalLocations:Re.locations.length,activeLocations:Re.getActiveLocations().length}});qe(()=>Re.products.map(R=>{const M=Re.getStockByProduct(R.id),V=Re.getTotalStockByProduct(R.id),ge=Re.getLastLocationByProduct(R.id);return{...R,totalStock:V,stockByLocation:M,lastLocation:ge,isLowStock:V<=R.minStockLevel}})),qe(()=>{ue(),de(1)});const F=(R,M)=>R<=M?t("inventory.lowStockAlert"):R<=M*2?t("inventory.normalStock"):t("inventory.inStock"),B=R=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(R),W=R=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(R),fe=R=>{switch(R){case"warehouse":return t("inventory.warehouse");case"store":return t("inventory.store");case"supplier":return t("inventory.supplier");case"customer":return t("inventory.customer");default:return R}},K={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},he={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},D=R=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500",background:R>50?"#d4edda":R>20?"#fff3cd":"#f8d7da",color:R>50?"#155724":R>20?"#856404":"#721c24"}),U={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},Q={color:"var(--text-muted)","font-size":"0.875rem"},J={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},ce={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},oe={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},O=R=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:R?"var(--primary-color)":"var(--text-muted)","border-bottom":R?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),re={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem","margin-bottom":"2rem"},pe={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},ve={display:"flex",gap:"0.5rem","align-items":"center","margin-left":"auto","margin-right":"1rem"},te=R=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:R?"var(--primary-color)":"var(--surface-color)",color:R?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),se=qe(()=>{const R=Re.movements;return{total:R.length,stockIn:R.filter(M=>M.movementType==="in").length,stockOut:R.filter(M=>M.movementType==="out").length,transfers:R.filter(M=>M.movementType==="transfer").length,adjustments:R.filter(M=>M.movementType==="adjustment").length,totalValue:R.reduce((M,V)=>M+V.totalCost,0)}});return cn(()=>{}),S(Fr,{get title(){return t("inventory.title")},get children(){return[(()=>{var R=DI(),M=R.firstChild,V=M.nextSibling,ge=V.firstChild,le=ge.firstChild,j=le.nextSibling,G=j.firstChild,Pe=j.nextSibling,_e=Pe.firstChild;return d(R,ce),M.style.setProperty("margin","0"),M.style.setProperty("font-size","1.75rem"),V.style.setProperty("display","flex"),V.style.setProperty("align-items","center"),V.style.setProperty("gap","1rem"),d(ge,ve),le.style.setProperty("font-weight","500"),le.style.setProperty("color","var(--text-muted)"),le.style.setProperty("font-size","0.875rem"),j.$$click=()=>_("new"),s(j,()=>t("common.view"),G),Pe.$$click=()=>_("legacy"),s(Pe,()=>t("common.view"),_e),s(V,(()=>{var ae=me(()=>p()==="new");return()=>ae()&&S(De,{variant:"outline",onClick:()=>A(!0),get children(){return["🔢 ",me(()=>t("inventory.physicalCount","Physical Count"))]}})})(),null),s(V,S(Ve,{get when(){return Ut.hasPermission("read_write")},get children(){return S(De,{variant:"primary",onClick:()=>i(!0),get children(){return me(()=>p()==="new")()?t("inventory.addMovement"):t("common.add")}})}}),null),ne(ae=>{var be=te(p()==="new"),X=te(p()==="legacy");return ae.e=d(j,be,ae.e),ae.t=d(Pe,X,ae.t),ae},{e:void 0,t:void 0}),R})(),me(()=>me(()=>p()==="legacy")()?[(()=>{var R=Ir();return s(R,S(Qe,{get title(){return t("inventory.totalItems")},get subtitle(){return t("inventory.inStock")},get children(){var M=Ir();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","var(--primary-color)"),s(M,()=>Re.inventory.length),M}}),null),s(R,S(Qe,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.itemsBelowThreshold")},get children(){var M=Ir();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","var(--primary-color)"),s(M,()=>Re.getLowStockItems().length),M}}),null),s(R,S(Qe,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.inventoryWorth")},get children(){var M=Ir();return M.style.setProperty("font-size","1.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","var(--primary-color)"),s(M,()=>B(Re.getTotalValue())),M}}),null),ne(M=>d(R,J,M)),R})(),(()=>{var R=Ir();return d(R,K),s(R,S(Mt,{get each(){return Re.inventory},children:M=>{const V=F(M.quantity,M.minStock),ge=M.quantity<=M.minStock?8:M.quantity<=M.minStock*2?35:75;return S(Qe,{onClick:()=>Z(M),get children(){return[(()=>{var le=NI(),j=le.firstChild,G=j.nextSibling;return d(le,he),j.style.setProperty("margin","0"),j.style.setProperty("font-size","1.1rem"),s(j,()=>M.name),s(G,V),ne(Pe=>d(G,D(ge),Pe)),le})(),(()=>{var le=Ir();return d(le,U),s(le,()=>B(M.price)),le})(),(()=>{var le=LI(),j=le.firstChild,G=j.nextSibling;return G.nextSibling,d(le,Q),s(le,()=>t("inventory.quantity"),j),s(le,()=>M.quantity,G),s(le,()=>t("common.units"),null),le})()]}})}})),R})()]:[(()=>{var R=MI(),M=R.firstChild,V=M.nextSibling,ge=V.nextSibling,le=ge.nextSibling;return d(R,oe),M.$$click=()=>f("overview"),s(M,()=>t("inventory.overview")),V.$$click=()=>f("products"),s(V,()=>t("inventory.products")),ge.$$click=()=>f("movements"),s(ge,()=>t("inventory.movements")),le.$$click=()=>f("locations"),s(le,()=>t("inventory.locations")),ne(j=>{var G=O(h()==="overview"),Pe=O(h()==="products"),_e=O(h()==="movements"),ae=O(h()==="locations");return j.e=d(M,G,j.e),j.t=d(V,Pe,j.t),j.a=d(ge,_e,j.a),j.o=d(le,ae,j.o),j},{e:void 0,t:void 0,a:void 0,o:void 0}),R})(),me(()=>me(()=>h()==="overview")()&&(()=>{var R=OI(),M=R.firstChild;return s(M,S(Qe,{get title(){return t("inventory.activeProducts")},get subtitle(){return t("inventory.currentlyManaged")},get children(){var V=Ir();return V.style.setProperty("font-size","1.5rem"),V.style.setProperty("font-weight","600"),V.style.setProperty("color","var(--primary-color)"),s(V,()=>k().activeProducts),V}}),null),s(M,S(Qe,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.needAttention")},get children(){var V=Ir();return V.style.setProperty("font-size","1.5rem"),V.style.setProperty("font-weight","600"),V.style.setProperty("color","#d32f2f"),s(V,()=>k().lowStockProducts),V}}),null),s(M,S(Qe,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.currentWorth")},get children(){var V=Ir();return V.style.setProperty("font-size","1.5rem"),V.style.setProperty("font-weight","600"),V.style.setProperty("color","var(--primary-color)"),s(V,()=>W(se().totalValue)),V}}),null),s(M,S(Qe,{get title(){return t("inventory.movements")},get subtitle(){return t("inventory.thisMonth")},get children(){var V=Ir();return V.style.setProperty("font-size","1.5rem"),V.style.setProperty("font-weight","600"),V.style.setProperty("color","var(--primary-color)"),s(V,()=>k().totalMovementsThisMonth),V}}),null),s(M,S(Qe,{get title(){return t("inventory.activeLocations")},get subtitle(){return t("inventory.warehousesStores")},get children(){var V=Ir();return V.style.setProperty("font-size","1.5rem"),V.style.setProperty("font-weight","600"),V.style.setProperty("color","var(--primary-color)"),s(V,()=>k().activeLocations),V}}),null),s(R,(()=>{var V=me(()=>k().lowStockProducts>0);return()=>V()&&S(Qe,{get title(){return`⚠️ ${t("inventory.lowStockAlert")}`},get subtitle(){return`${k().lowStockProducts} ${t("inventory.productsNeedRestocking")}`},style:{"margin-bottom":"2rem","border-color":"#ffcdd2",background:"#ffebee"},get children(){var ge=Ir();return ge.style.setProperty("margin-top","1rem"),s(ge,S(Mt,{get each(){return Re.getLowStockProducts().slice(0,9)},children:le=>(()=>{var j=VI(),G=j.firstChild,Pe=G.firstChild,_e=Pe.nextSibling;_e.nextSibling;var ae=G.nextSibling,be=ae.firstChild,X=be.nextSibling;return X.nextSibling,j.style.setProperty("display","flex"),j.style.setProperty("justify-content","space-between"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-size","0.875rem"),s(G,()=>le.name,Pe),s(G,()=>le?.sku,_e),ae.style.setProperty("color","#d32f2f"),ae.style.setProperty("font-weight","600"),s(ae,()=>le.currentStock,be),s(ae,()=>le.minStockLevel,X),s(ae,()=>t("inventory.min"),null),j})()}),null),s(ge,(()=>{var le=me(()=>Re.getLowStockProducts().length>5);return()=>le()&&(()=>{var j=Ir();return j.style.setProperty("font-size","0.875rem"),j.style.setProperty("color","var(--text-muted)"),j.style.setProperty("font-style","italic"),s(j,()=>t("common.andMore",{count:Re.getLowStockProducts().length-9})),j})()})(),null),ge}})})(),null),ne(V=>d(M,J,V)),R})()),me(()=>me(()=>h()==="products")()&&S(By,{})),me(()=>me(()=>h()==="movements")()&&S(jA,{})),me(()=>me(()=>h()==="locations")()&&(()=>{var R=BI(),M=R.firstChild,V=M.firstChild,ge=M.nextSibling;return M.style.setProperty("display","flex"),M.style.setProperty("justify-content","space-between"),M.style.setProperty("align-items","center"),M.style.setProperty("margin-bottom","1.5rem"),V.style.setProperty("margin","0"),V.style.setProperty("font-size","1.5rem"),s(V,()=>t("inventory.locations")),s(M,S(Ve,{get when(){return Ut.hasPermission("read_write")},get children(){return S(De,{variant:"primary",onClick:()=>b(!0),get children(){return["🏭 ",me(()=>t("inventory.addLocation"))]}})}}),null),d(ge,re),s(ge,S(Mt,{get each(){return Re.getActiveLocations()},children:le=>{const j=Re.getStockByLocation(le.id),G=j.length,Pe=j.reduce((ae,be)=>ae*1+be.quantity*1,0),_e=j.reduce((ae,be)=>(Re.getProductById(be.productId),ae+(be?.averageCost||0)),0);return(()=>{var ae=FI(),be=ae.firstChild,X=be.firstChild,Ce=X.firstChild,$e=Ce.nextSibling,Ee=X.nextSibling,xe=Ee.firstChild,Oe=Ee.nextSibling,He=be.nextSibling,je=He.firstChild,Ie=je.firstChild,Be=Ie.firstChild,We=Ie.nextSibling,ze=je.nextSibling,Ge=ze.firstChild,Ae=Ge.firstChild,nt=Ge.nextSibling,et=ze.nextSibling,dt=et.firstChild,xt=dt.firstChild,Tt=dt.nextSibling,Gt=He.nextSibling,vt=Gt.firstChild,tr=vt.firstChild;return be.style.setProperty("margin-bottom","1rem"),be.style.setProperty("padding-bottom","1rem"),be.style.setProperty("border-bottom","1px solid var(--border-color)"),X.style.setProperty("display","flex"),X.style.setProperty("align-items","center"),X.style.setProperty("gap","0.5rem"),X.style.setProperty("margin-bottom","0.5rem"),Ce.style.setProperty("font-size","1.2rem"),s(Ce,()=>le.type==="warehouse"?"🏭":le.type==="store"?"🏪":le.type==="supplier"?"🚚":"👥"),$e.style.setProperty("margin","0"),$e.style.setProperty("font-size","1.1rem"),s($e,()=>le.name),Ee.style.setProperty("font-size","0.875rem"),Ee.style.setProperty("color","var(--text-muted)"),s(Ee,()=>le.code,xe),s(Ee,()=>fe(le.type),null),Oe.style.setProperty("font-size","0.75rem"),Oe.style.setProperty("color","var(--text-muted)"),Oe.style.setProperty("margin-top","0.25rem"),s(Oe,()=>le.address),He.style.setProperty("margin-bottom","1rem"),je.style.setProperty("display","flex"),je.style.setProperty("justify-content","space-between"),je.style.setProperty("margin-bottom","0.5rem"),Ie.style.setProperty("font-size","0.875rem"),Ie.style.setProperty("font-weight","500"),s(Ie,()=>t("inventory.products"),Be),We.style.setProperty("font-weight","600"),s(We,G),ze.style.setProperty("display","flex"),ze.style.setProperty("justify-content","space-between"),ze.style.setProperty("margin-bottom","0.5rem"),Ge.style.setProperty("font-size","0.875rem"),Ge.style.setProperty("font-weight","500"),s(Ge,()=>t("inventory.totalItems"),Ae),nt.style.setProperty("font-weight","600"),nt.style.setProperty("color","var(--primary-color)"),s(nt,Pe),et.style.setProperty("display","flex"),et.style.setProperty("justify-content","space-between"),et.style.setProperty("margin-bottom","1rem"),dt.style.setProperty("font-size","0.875rem"),dt.style.setProperty("font-weight","500"),s(dt,()=>t("inventory.totalValue"),xt),Tt.style.setProperty("font-weight","600"),Tt.style.setProperty("color","var(--primary-color)"),s(Tt,()=>W(_e)),vt.style.setProperty("font-weight","600"),vt.style.setProperty("margin-bottom","0.75rem"),vt.style.setProperty("font-size","0.875rem"),vt.style.setProperty("color","var(--text-primary)"),vt.style.setProperty("border-bottom","1px solid var(--border-color)"),vt.style.setProperty("padding-bottom","0.5rem"),s(vt,()=>t("inventory.productDetails"),tr),s(Gt,(()=>{var yt=me(()=>j.length===0);return()=>yt()?(()=>{var At=Ir();return At.style.setProperty("text-align","center"),At.style.setProperty("color","var(--text-muted)"),At.style.setProperty("font-style","italic"),At.style.setProperty("padding","1rem"),s(At,()=>t("inventory.noProducts")),At})():(()=>{var At=Ir();return At.style.setProperty("max-height","200px"),At.style.setProperty("overflow-y","auto"),At.style.setProperty("border","1px solid var(--border-color)"),At.style.setProperty("border-radius","var(--border-radius-sm)"),s(At,S(Mt,{each:j,children:qt=>{const Ot=Re.getProductById(qt.productId);if(!Ot)return null;const Le=qt.quantity<=Ot.minStockLevel,Fe=qt.averageCost;return(()=>{var Ke=UI(),st=Ke.firstChild,Vt=st.firstChild,Je=Vt.firstChild,gt=Je.nextSibling,Pt=Vt.nextSibling,ct=Pt.firstChild,It=ct.firstChild,Cr=ct.nextSibling,$t=Cr.nextSibling;return $t.firstChild,Ke.style.setProperty("padding","0.75rem"),Ke.style.setProperty("border-bottom","1px solid var(--border-color)"),(Le?"#fff5f5":"transparent")!=null?Ke.style.setProperty("background",Le?"#fff5f5":"transparent"):Ke.style.removeProperty("background"),Ke.style.setProperty("transition","background-color 0.2s ease"),st.style.setProperty("display","flex"),st.style.setProperty("justify-content","space-between"),st.style.setProperty("align-items","flex-start"),st.style.setProperty("margin-bottom","0.25rem"),Vt.style.setProperty("flex","1"),Je.style.setProperty("font-weight","500"),Je.style.setProperty("font-size","0.875rem"),(Le?"#d32f2f":"var(--text-primary)")!=null?Je.style.setProperty("color",Le?"#d32f2f":"var(--text-primary)"):Je.style.removeProperty("color"),s(Je,()=>Ot.name,null),s(Je,Le&&(()=>{var jt=jI();return jt.style.setProperty("margin-left","0.5rem"),jt.style.setProperty("font-size","0.7rem"),jt.style.setProperty("color","#d32f2f"),jt})(),null),gt.style.setProperty("font-size","0.75rem"),gt.style.setProperty("color","var(--text-muted)"),gt.style.setProperty("margin-top","0.1rem"),s(gt,()=>Ot.sku,null),s(gt,()=>Ot.UPC?" • "+Ot.UPC:"",null),s(gt,()=>Ot.category?" • "+Ot.category:"",null),Pt.style.setProperty("text-align","right"),ct.style.setProperty("font-weight","600"),ct.style.setProperty("font-size","0.875rem"),(Le?"#d32f2f":"var(--primary-color)")!=null?ct.style.setProperty("color",Le?"#d32f2f":"var(--primary-color)"):ct.style.removeProperty("color"),s(ct,()=>qt.quantity,It),s(ct,()=>Ot.unitOfMeasure,null),Cr.style.setProperty("font-size","0.75rem"),Cr.style.setProperty("color","var(--text-muted)"),s(Cr,()=>W(Fe)),$t.style.setProperty("font-size","0.7rem"),$t.style.setProperty("color","var(--text-muted)"),$t.style.setProperty("margin-top","0.1rem"),s($t,()=>Ot.minStockLevel,null),Ke})()}})),At})()})(),null),ne(yt=>d(ae,{...pe,"min-height":"400px"},yt)),ae})()}})),R})())]),S(Ve,{get when(){return Ut.hasPermission("read_write")},get children(){return[S(nA,{get isOpen(){return e()},onClose:()=>r(!1),get mode(){return p()==="new"?"movement":"legacy"}}),S(uA,{get isOpen(){return n()},onClose:()=>i(!1)}),S(yA,{get isOpen(){return o()},onClose:()=>a(!1),get item(){return c()}}),S(au,{get isOpen(){return I()},onClose:()=>b(!1),onLocationAdded:()=>{b(!1)}})]}}),S(eI,{get isOpen(){return w()},onClose:()=>A(!1)})]}})};St(["click"]);const qI=[{id:"1",name:"John Doe",position:"Software Engineer",salary:85e3,email:"john.doe@company.com",phone:"+1 (555) 123-4567",department:"Engineering",startDate:"2023-01-15"},{id:"2",name:"Jane Smith",position:"Product Manager",salary:95e3,email:"jane.smith@company.com",phone:"+1 (555) 234-5678",department:"Product",startDate:"2022-08-20"},{id:"3",name:"Mike Brown",position:"Designer",salary:7e4,email:"mike.brown@company.com",phone:"+1 (555) 345-6789",department:"Design",startDate:"2023-03-10"},{id:"4",name:"Sarah Kim",position:"HR Manager",salary:78e3,email:"sarah.kim@company.com",phone:"+1 (555) 456-7890",department:"Human Resources",startDate:"2022-11-05"},{id:"5",name:"Alex Lee",position:"Data Analyst",salary:72e3,email:"alex.lee@company.com",phone:"+1 (555) 567-8901",department:"Analytics",startDate:"2023-02-28"},{id:"6",name:"Emma Wilson",position:"Marketing Manager",salary:82e3,email:"emma.wilson@company.com",phone:"+1 (555) 678-9012",department:"Marketing",startDate:"2022-09-15"}],[Po,bl]=ye(qI),Fy={get employees(){return Po()},addEmployee(t){const e={...t,id:Date.now().toString()};return bl([...Po(),e]),e},updateEmployee(t,e){bl(Po().map(r=>r.id===t?{...r,...e}:r))},deleteEmployee(t){bl(Po().filter(e=>e.id!==t))},getEmployeeById(t){return Po().find(e=>e.id===t)}};var HI=z("<form><div>");const WI=t=>{const{t:e}=ot(),[r,n]=ye({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),i=[{value:"Engineering",label:e("employees.departments.engineering","Engineering")},{value:"Product",label:e("employees.departments.product","Product")},{value:"Design",label:e("employees.departments.design","Design")},{value:"Marketing",label:e("employees.departments.marketing","Marketing")},{value:"Sales",label:e("employees.departments.sales","Sales")},{value:"Human Resources",label:e("employees.departments.humanResources","Human Resources")},{value:"Finance",label:e("employees.departments.finance","Finance")},{value:"Operations",label:e("employees.departments.operations","Operations")},{value:"Analytics",label:e("employees.departments.analytics","Analytics")}],o={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},a=u=>{u.preventDefault();const h=r();if(!h.name||!h.position||!h.salary||!h.email||!h.department||!h.startDate){alert(e("forms.requiredField"));return}const f={name:h.name,position:h.position,salary:parseFloat(h.salary),email:h.email,phone:h.phone,department:h.department,startDate:h.startDate};Fy.addEmployee(f),n({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),t.onClose()},c=(u,h)=>{n(f=>({...f,[u]:h}))};return S(mr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.addEmployee")},get children(){var u=HI(),h=u.firstChild;return u.addEventListener("submit",a),s(u,S(_t,{get label(){return e("employees.fullName")},get value(){return r().name},onChange:f=>c("name",f),get placeholder(){return e("employees.enterFullName","Enter employee's full name")},required:!0}),h),s(u,S(_t,{get label(){return e("employees.position")},get value(){return r().position},onChange:f=>c("position",f),get placeholder(){return e("employees.enterPosition","Enter job position")},required:!0}),h),s(u,S(dr,{get label(){return e("employees.department")},get value(){return r().department},onChange:f=>c("department",f),options:i,required:!0}),h),s(u,S(_t,{get label(){return e("employees.email")},type:"email",get value(){return r().email},onChange:f=>c("email",f),get placeholder(){return e("employees.enterEmail","Enter email address")},required:!0}),h),s(u,S(_t,{get label(){return e("employees.phone")},type:"tel",get value(){return r().phone},onChange:f=>c("phone",f),get placeholder(){return e("employees.enterPhone","Enter phone number")}}),h),s(u,S(_t,{get label(){return e("employees.salary")},type:"number",get value(){return r().salary},onChange:f=>c("salary",f),get placeholder(){return e("employees.enterSalary","Enter annual salary")},required:!0}),h),s(u,S(_t,{get label(){return e("employees.hireDate")},type:"date",get value(){return r().startDate},onChange:f=>c("startDate",f),required:!0}),h),d(h,o),s(h,S(De,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(h,S(De,{variant:"primary",type:"submit",get children(){return e("employees.addEmployee")}}),null),u}})};var GI=z("<div><div></div><div></div><div>"),KI=z("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),YI=z("<div>");const QI=t=>{const{t:e}=ot(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={width:"80px",height:"80px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.5rem",margin:"0 auto 1.5rem auto"},a={"text-align":"center","margin-bottom":"2rem"},c={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},u={color:"var(--text-muted)","font-size":"1rem"},h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"};if(!t.employee)return null;const f=C=>C.split(" ").map(N=>N[0]).join("").toUpperCase(),p=C=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(C),_=C=>new Date(C).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return S(mr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.employeeDetails")},get children(){return[(()=>{var C=GI(),N=C.firstChild,E=N.nextSibling,T=E.nextSibling;return d(C,a),d(N,o),s(N,()=>f(t.employee.name)),d(E,c),s(E,()=>t.employee.name),d(T,u),s(T,()=>t.employee.position),C})(),(()=>{var C=KI(),N=C.firstChild,E=N.firstChild,T=E.nextSibling,x=N.nextSibling,q=x.firstChild,ee=q.nextSibling,Y=x.nextSibling,ue=Y.firstChild,ie=ue.nextSibling,I=Y.nextSibling,b=I.firstChild,v=b.nextSibling,P=I.nextSibling,w=P.firstChild,A=w.nextSibling,y=P.nextSibling,de=y.firstChild,H=de.nextSibling;return s(E,()=>e("employees.employeeId")),s(T,()=>t.employee.id),s(q,()=>e("employees.department")),s(ee,()=>t.employee.department),s(ue,()=>e("employees.email")),s(ie,()=>t.employee.email),s(b,()=>e("employees.phone")),s(v,()=>t.employee.phone),s(w,()=>e("employees.salary")),s(A,()=>p(t.employee.salary)),s(de,()=>e("employees.hireDate")),s(H,()=>_(t.employee.startDate)),ne($=>{var Z=r,k=n,F=i,B=r,W=n,fe=i,K=r,he=n,D=i,U=r,Q=n,J=i,ce=r,oe=n,O=i,re=r,pe=n,ve=i;return $.e=d(N,Z,$.e),$.t=d(E,k,$.t),$.a=d(T,F,$.a),$.o=d(x,B,$.o),$.i=d(q,W,$.i),$.n=d(ee,fe,$.n),$.s=d(Y,K,$.s),$.h=d(ue,he,$.h),$.r=d(ie,D,$.r),$.d=d(I,U,$.d),$.l=d(b,Q,$.l),$.u=d(v,J,$.u),$.c=d(P,ce,$.c),$.w=d(w,oe,$.w),$.m=d(A,O,$.m),$.f=d(y,re,$.f),$.y=d(de,pe,$.y),$.g=d(H,ve,$.g),$},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),C})(),(()=>{var C=YI();return d(C,h),s(C,S(De,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(C,S(De,{variant:"primary",onClick:()=>{console.log("Edit employee:",t.employee.id)},get children(){return e("employees.editEmployee")}}),null),C})()]}})};var kh=z("<div>"),JI=z("<div><div></div><div><div></div><div></div><div>/year");const XI=()=>{const{t}=ot(),[e,r]=ye(!1),[n,i]=ye(!1),[o,a]=ye(null),c=E=>{a(E),i(!0)},u={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},h={display:"flex","align-items":"center",gap:"1rem"},f={width:"60px",height:"60px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.2rem"},p={flex:"1"},_={"font-weight":"600","margin-bottom":"0.25rem"},C={color:"var(--text-muted)","font-size":"0.875rem","margin-bottom":"0.5rem"},N={color:"var(--primary-color)","font-weight":"500"};return S(Fr,{get title(){return t("employees.title")},get children(){return[(()=>{var E=kh();return E.style.setProperty("margin-bottom","2rem"),s(E,S(De,{variant:"primary",onClick:()=>r(!0),get children(){return t("employees.addEmployee")}})),E})(),(()=>{var E=kh();return d(E,u),s(E,()=>Fy.employees.map(T=>{const x=ee=>ee.split(" ").map(Y=>Y[0]).join("").toUpperCase(),q=ee=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ee);return S(Qe,{onClick:()=>c(T),get children(){var ee=JI(),Y=ee.firstChild,ue=Y.nextSibling,ie=ue.firstChild,I=ie.nextSibling,b=I.nextSibling,v=b.firstChild;return d(ee,h),d(Y,f),s(Y,()=>x(T.name)),d(ue,p),d(ie,_),s(ie,()=>T.name),d(I,C),s(I,()=>T.position),d(b,N),s(b,()=>q(T.salary),v),ee}})})),E})(),S(WI,{get isOpen(){return e()},onClose:()=>r(!1)}),S(QI,{get isOpen(){return n()},onClose:()=>i(!1),get employee(){return o()}})]}})},ZI=[{id:"1",accountId:"1002",bankName:"First National Bank",accountNumber:"****1234",accountType:"checking",currency:"USD",currentBalance:32730.5,lastReconciledDate:"2024-01-01",lastReconciledBalance:3e4,isActive:!0},{id:"2",accountId:"1003",bankName:"First National Bank",accountNumber:"****5678",accountType:"savings",currency:"USD",currentBalance:12e3,lastReconciledDate:"2024-01-01",lastReconciledBalance:1e4,isActive:!0}],eE=[{id:"1",accountId:"1002",date:"2024-01-15",description:"Customer Payment - ABC Corp",reference:"CHK001234",debitAmount:5e3,creditAmount:0,balance:35730.5,category:"Customer Payment",isReconciled:!0,reconciledWith:"eb1",importedAt:"2024-01-16",source:"csv_import"},{id:"2",accountId:"1002",date:"2024-01-14",description:"Office Supplies - Staples",reference:"CHK001235",debitAmount:0,creditAmount:250,balance:30730.5,category:"Office Expenses",isReconciled:!0,reconciledWith:"eb2",importedAt:"2024-01-16",source:"csv_import"},{id:"3",accountId:"1002",date:"2024-01-13",description:"Monthly Rent Payment",reference:"CHK001236",debitAmount:0,creditAmount:2e3,balance:28730.5,category:"Rent",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"},{id:"4",accountId:"1002",date:"2024-01-12",description:"Wire Transfer In",reference:"WIRE001",debitAmount:1e4,creditAmount:0,balance:38730.5,category:"Wire Transfer",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"}],tE=[{id:"eb1",accountId:"1002",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",debitAmount:5e3,creditAmount:0,category:"Accounts Receivable",isReconciled:!0,reconciledWith:"1",createdAt:"2024-01-15"},{id:"eb2",accountId:"1002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",debitAmount:0,creditAmount:250,category:"Office Expenses",isReconciled:!0,reconciledWith:"2",createdAt:"2024-01-14"},{id:"eb3",accountId:"1002",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",debitAmount:0,creditAmount:3500,category:"Salary Expense",isReconciled:!1,createdAt:"2024-01-11"}],rE=[{id:"1",bankAccountId:"1",periodStart:"2024-01-01",periodEnd:"2024-01-15",startingBalance:3e4,endingBalance:35730.5,status:"in_progress",totalBankTransactions:4,totalEntryBookRecords:3,reconciledTransactions:2,unreconciledTransactions:2,discrepancyAmount:1500,createdAt:"2024-01-16",notes:"Wire transfer and rent payment need investigation"}],[Os,Rh]=ye(ZI),[Nn,_l]=ye(eE),[wo,Dh]=ye(tE),[Vs,Nh]=ye(rE),rr={get bankAccounts(){return Os()},addBankAccount(t){const e={...t,id:Date.now().toString()};return Rh([...Os(),e]),e},updateBankAccount(t,e){Rh(Os().map(r=>r.id===t?{...r,...e}:r))},getBankAccountById(t){return Os().find(e=>e.id===t)},get bankStatements(){return Nn()},addBankStatement(t){const e={...t,id:Date.now().toString(),importedAt:new Date().toISOString()};return _l([...Nn(),e]),e},addBankStatementsFromCSV(t){const e=t.map(r=>({...r,id:`csv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,importedAt:new Date().toISOString(),source:"csv_import",isReconciled:!1}));return _l([...Nn(),...e]),e},updateBankStatement(t,e){_l(Nn().map(r=>r.id===t?{...r,...e}:r))},getBankStatementsByAccount(t){return Nn().filter(e=>e.accountId===t)},getUnreconciledBankStatements(t){return(t?this.getBankStatementsByAccount(t):Nn()).filter(r=>!r.isReconciled)},get entryBookRecords(){return wo()},addEntryBookRecord(t){const e={...t,id:Date.now().toString(),createdAt:new Date().toISOString()};return Dh([...wo(),e]),e},updateEntryBookRecord(t,e){Dh(wo().map(r=>r.id===t?{...r,...e}:r))},getEntryBookRecordsByAccount(t){return wo().filter(e=>e.accountId===t)},getUnreconciledEntryBookRecords(t){return(t?this.getEntryBookRecordsByAccount(t):wo()).filter(r=>!r.isReconciled)},reconcileTransaction(t,e){this.updateBankStatement(t,{isReconciled:!0,reconciledWith:e}),this.updateEntryBookRecord(e,{isReconciled:!0,reconciledWith:t})},unreconciledTransaction(t){const e=Nn().find(r=>r.id===t);e?.reconciledWith&&this.updateEntryBookRecord(e.reconciledWith,{isReconciled:!1,reconciledWith:void 0}),this.updateBankStatement(t,{isReconciled:!1,reconciledWith:void 0})},findPotentialMatches(t){const e=Nn().find(n=>n.id===t);return e?this.getUnreconciledEntryBookRecords(e.accountId).filter(n=>{const i=Math.abs(e.debitAmount-n.debitAmount)<.01||Math.abs(e.creditAmount-n.creditAmount)<.01,o=new Date(e.date),a=new Date(n.date),u=Math.abs((o.getTime()-a.getTime())/(1e3*60*60*24))<=3,h=e.reference===n.reference||e.description.toLowerCase().includes(n.description.toLowerCase())||n.description.toLowerCase().includes(e.description.toLowerCase());return i&&(u||h)}).sort((n,i)=>{const o=(n.date===e.date?2:0)+(n.reference===e.reference?1:0);return(i.date===e.date?2:0)+(i.reference===e.reference?1:0)-o}):[]},get reconciliationSessions(){return Vs()},startReconciliationSession(t,e,r){const n=this.getBankStatementsByAccount(t).filter(h=>h.date>=e&&h.date<=r),i=this.getEntryBookRecordsByAccount(t).filter(h=>h.date>=e&&h.date<=r),o=n.filter(h=>h.isReconciled).length,a=this.getBankAccountById(t)?.lastReconciledBalance||0,c=this.getBankAccountById(t)?.currentBalance||0,u={id:Date.now().toString(),bankAccountId:t,periodStart:e,periodEnd:r,startingBalance:a,endingBalance:c,status:"in_progress",totalBankTransactions:n.length,totalEntryBookRecords:i.length,reconciledTransactions:o,unreconciledTransactions:n.length-o,discrepancyAmount:0,createdAt:new Date().toISOString()};return Nh([...Vs(),u]),u},updateReconciliationSession(t,e){Nh(Vs().map(r=>r.id===t?{...r,...e}:r))},getReconciliationSessionsByAccount(t){return Vs().filter(e=>e.bankAccountId===t)}};var Sl=z("<div>"),nE=z("<div><strong>:</strong> <!> - "),iE=z("<div><div><div>📄</div><div></div><div></div></div><input id=csvFileInput type=file accept=.csv>"),oE=z("<div><h4></h4><div><div><label> *</label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value>"),Oi=z("<option>"),sE=z("<div><table><thead><tr></tr></thead><tbody>"),aE=z("<th>"),lE=z("<tr>"),cE=z("<td>");const uE=t=>{const{t:e}=ot(),[r,n]=ye(!1),[i,o]=ye(!1),[a,c]=ye(null),[u,h]=ye([]),[f,p]=ye({date:"",description:"",reference:"",debit:"",credit:"",balance:""}),_={border:`2px dashed ${r()?"var(--primary-color)":"var(--border-color)"}`,"border-radius":"var(--border-radius)",padding:"2rem","text-align":"center","background-color":r()?"var(--background-color)":"transparent",transition:"all 0.2s ease",cursor:"pointer"},C={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem","margin-top":"1.5rem"},N={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-family":"inherit"},E={"max-height":"200px","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},T={width:"100%","border-collapse":"collapse","font-size":"0.875rem"},x={padding:"0.5rem","border-bottom":"1px solid var(--border-color)","text-align":"left"},q={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ee=A=>{A.preventDefault(),n(!0)},Y=A=>{A.preventDefault(),n(!1)},ue=A=>{A.preventDefault(),n(!1);const y=A.dataTransfer?.files;y&&y.length>0&&I(y[0])},ie=A=>{const y=A.target;y.files&&y.files.length>0&&I(y.files[0])},I=A=>{if(!A.name.toLowerCase().endsWith(".csv")){c({success:!1,message:e("banking.pleaseUploadCSV")});return}o(!0);const y=new FileReader;y.onload=de=>{try{const $=(de.target?.result).split(`
`).filter(B=>B.trim());if($.length<2){c({success:!1,message:e("banking.csvRequiresHeaderAndData")}),o(!1);return}const Z=$[0].split(",").map(B=>B.trim().replace(/[\"\']/g,"")),k=$.slice(1).map(B=>{const W=B.split(",").map(K=>K.trim().replace(/[\"\']/g,"")),fe={};return Z.forEach((K,he)=>{fe[K]=W[he]||""}),fe});h(k),c({success:!0,message:e("banking.successfullyParsed").replace("{count}",k.length.toString()),count:k.length});const F={...f()};Z.forEach(B=>{const W=B.toLowerCase();W.includes("date")&&(F.date=B),(W.includes("description")||W.includes("memo"))&&(F.description=B),(W.includes("reference")||W.includes("check")||W.includes("ref"))&&(F.reference=B),(W.includes("debit")||W.includes("deposit"))&&(F.debit=B),(W.includes("credit")||W.includes("withdrawal")||W.includes("amount"))&&(F.debit?F.credit=B:F.debit=B),W.includes("balance")&&(F.balance=B)}),p(F)}catch{c({success:!1,message:e("banking.errorParsingCSV")})}o(!1)},y.readAsText(A)},b=(A,y)=>{p(de=>({...de,[A]:y}))},v=()=>u().length===0?[]:Object.keys(u()[0]),P=()=>{if(!t.bankAccount||u().length===0)return;const A=f();if(!A.date||!A.description){c({success:!1,message:e("banking.dateDescriptionRequired")});return}o(!0);try{const y=u().map(H=>{const $=B=>B&&parseFloat(B.replace(/[^0-9.-]/g,""))||0,Z=B=>{const W=new Date(B);if(isNaN(W.getTime())){const fe=B.split("/");if(fe.length===3)return new Date(parseInt(fe[2]),parseInt(fe[0])-1,parseInt(fe[1])).toISOString().split("T")[0]}return W.toISOString().split("T")[0]};let k=0,F=0;if(A.debit&&A.credit)k=$(H[A.debit]),F=$(H[A.credit]);else if(A.debit){const B=$(H[A.debit]);B>0?k=B:F=Math.abs(B)}return{accountId:t.bankAccount.accountId,date:Z(H[A.date]),description:H[A.description]||e("banking.importedTransaction"),reference:H[A.reference]||"",debitAmount:k,creditAmount:F,balance:A.balance?$(H[A.balance]):0,isReconciled:!1}}),de=rr.addBankStatementsFromCSV(y);c({success:!0,message:e("banking.successfullyImported").replace("{count}",de.length.toString()),count:de.length}),h([]),p({date:"",description:"",reference:"",debit:"",credit:"",balance:""})}catch{c({success:!1,message:e("banking.errorImportingTransactions")})}o(!1)},w=()=>{h([]),c(null),p({date:"",description:"",reference:"",debit:"",credit:"",balance:""})};return S(mr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("banking.importBankStatementCSV")},get children(){return[me(()=>me(()=>!!t.bankAccount)()&&(()=>{var A=nE(),y=A.firstChild,de=y.firstChild,H=y.nextSibling,$=H.nextSibling;return $.nextSibling,A.style.setProperty("margin-bottom","1.5rem"),A.style.setProperty("padding","1rem"),A.style.setProperty("background","var(--background-color)"),A.style.setProperty("border-radius","var(--border-radius-sm)"),A.style.setProperty("border","1px solid var(--border-color)"),s(y,()=>e("banking.bankAccount"),de),s(A,()=>t.bankAccount.bankName,$),s(A,()=>t.bankAccount.accountNumber,null),A})()),me(()=>me(()=>u().length===0)()?(()=>{var A=iE(),y=A.firstChild,de=y.firstChild,H=de.nextSibling,$=H.nextSibling,Z=y.nextSibling;return y.$$click=()=>document.getElementById("csvFileInput")?.click(),y.addEventListener("drop",ue),y.addEventListener("dragleave",Y),y.addEventListener("dragover",ee),de.style.setProperty("font-size","2rem"),de.style.setProperty("margin-bottom","1rem"),H.style.setProperty("font-weight","500"),H.style.setProperty("margin-bottom","0.5rem"),s(H,(()=>{var k=me(()=>!!r());return()=>k()?e("banking.dropCSVHere"):e("banking.clickToUploadCSV")})()),$.style.setProperty("font-size","0.875rem"),$.style.setProperty("color","var(--text-muted)"),s($,()=>e("banking.supportedFormat")),Z.addEventListener("change",ie),Z.style.setProperty("display","none"),ne(k=>d(y,_,k)),A})():(()=>{var A=oE(),y=A.firstChild,de=y.nextSibling,H=de.firstChild,$=H.firstChild,Z=$.firstChild,k=$.nextSibling,F=k.firstChild,B=H.nextSibling,W=B.firstChild,fe=W.firstChild,K=W.nextSibling,he=K.firstChild,D=B.nextSibling,U=D.firstChild,Q=U.nextSibling,J=Q.firstChild,ce=D.nextSibling,oe=ce.firstChild,O=oe.firstChild,re=oe.nextSibling,pe=re.firstChild,ve=ce.nextSibling,te=ve.firstChild,se=te.nextSibling,R=se.firstChild,M=ve.nextSibling,V=M.firstChild,ge=V.nextSibling,le=ge.firstChild;return y.style.setProperty("margin","0 0 1rem 0"),s(y,()=>e("banking.mapCSVColumns")),d(de,C),$.style.setProperty("display","block"),$.style.setProperty("margin-bottom","0.5rem"),$.style.setProperty("font-weight","500"),s($,()=>e("banking.dateColumn"),Z),k.addEventListener("change",j=>b("date",j.target.value)),s(F,()=>e("banking.selectColumn")),s(k,()=>v().map(j=>(()=>{var G=Oi();return G.value=j,s(G,j),G})()),null),W.style.setProperty("display","block"),W.style.setProperty("margin-bottom","0.5rem"),W.style.setProperty("font-weight","500"),s(W,()=>e("banking.descriptionColumn"),fe),K.addEventListener("change",j=>b("description",j.target.value)),s(he,()=>e("banking.selectColumn")),s(K,()=>v().map(j=>(()=>{var G=Oi();return G.value=j,s(G,j),G})()),null),U.style.setProperty("display","block"),U.style.setProperty("margin-bottom","0.5rem"),U.style.setProperty("font-weight","500"),s(U,()=>e("banking.referenceColumn")),Q.addEventListener("change",j=>b("reference",j.target.value)),s(J,()=>e("banking.selectColumn")),s(Q,()=>v().map(j=>(()=>{var G=Oi();return G.value=j,s(G,j),G})()),null),oe.style.setProperty("display","block"),oe.style.setProperty("margin-bottom","0.5rem"),oe.style.setProperty("font-weight","500"),s(oe,()=>e("banking.amountDebitColumn"),O),re.addEventListener("change",j=>b("debit",j.target.value)),s(pe,()=>e("banking.selectColumn")),s(re,()=>v().map(j=>(()=>{var G=Oi();return G.value=j,s(G,j),G})()),null),te.style.setProperty("display","block"),te.style.setProperty("margin-bottom","0.5rem"),te.style.setProperty("font-weight","500"),s(te,()=>e("banking.creditColumn")),se.addEventListener("change",j=>b("credit",j.target.value)),s(R,()=>e("banking.selectColumn")),s(se,()=>v().map(j=>(()=>{var G=Oi();return G.value=j,s(G,j),G})()),null),V.style.setProperty("display","block"),V.style.setProperty("margin-bottom","0.5rem"),V.style.setProperty("font-weight","500"),s(V,()=>e("banking.balanceColumn")),ge.addEventListener("change",j=>b("balance",j.target.value)),s(le,()=>e("banking.selectColumn")),s(ge,()=>v().map(j=>(()=>{var G=Oi();return G.value=j,s(G,j),G})()),null),s(A,(()=>{var j=me(()=>u().length>0);return()=>j()&&(()=>{var G=sE(),Pe=G.firstChild,_e=Pe.firstChild,ae=_e.firstChild,be=_e.nextSibling;return d(G,E),ae.style.setProperty("background-color","var(--background-color)"),s(ae,()=>v().slice(0,6).map(X=>(()=>{var Ce=aE();return s(Ce,X),ne($e=>d(Ce,x,$e)),Ce})())),s(be,()=>u().slice(0,3).map(X=>(()=>{var Ce=lE();return s(Ce,()=>v().slice(0,6).map($e=>(()=>{var Ee=cE();return s(Ee,()=>X[$e]),ne(xe=>d(Ee,x,xe)),Ee})())),Ce})())),s(G,(()=>{var X=me(()=>u().length>3);return()=>X()&&(()=>{var Ce=Sl();return Ce.style.setProperty("padding","0.5rem"),Ce.style.setProperty("text-align","center"),Ce.style.setProperty("color","var(--text-muted)"),s(Ce,()=>e("banking.andMoreRows").replace("{count}",(u().length-3).toString())),Ce})()})(),null),ne(X=>d(Pe,T,X)),G})()})(),null),ne(j=>{var G=N,Pe=N,_e=N,ae=N,be=N,X=N;return j.e=d(k,G,j.e),j.t=d(K,Pe,j.t),j.a=d(Q,_e,j.a),j.o=d(re,ae,j.o),j.i=d(se,be,j.i),j.n=d(ge,X,j.n),j},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),ne(()=>k.value=f().date),ne(()=>K.value=f().description),ne(()=>Q.value=f().reference),ne(()=>re.value=f().debit),ne(()=>se.value=f().credit),ne(()=>ge.value=f().balance),A})()),me(()=>me(()=>!!a())()&&(()=>{var A=Sl();return A.style.setProperty("padding","1rem"),A.style.setProperty("border-radius","var(--border-radius-sm)"),A.style.setProperty("margin-top","1rem"),s(A,()=>a().message),ne(y=>{var de=a().success?"#d4edda":"#f8d7da",H=a().success?"#155724":"#721c24",$=`1px solid ${a().success?"#c3e6cb":"#f5c6cb"}`;return de!==y.e&&((y.e=de)!=null?A.style.setProperty("background",de):A.style.removeProperty("background")),H!==y.t&&((y.t=H)!=null?A.style.setProperty("color",H):A.style.removeProperty("color")),$!==y.a&&((y.a=$)!=null?A.style.setProperty("border",$):A.style.removeProperty("border")),y},{e:void 0,t:void 0,a:void 0}),A})()),(()=>{var A=Sl();return d(A,q),s(A,S(De,{variant:"secondary",onClick:()=>{w(),t.onClose()},get children(){return e("common.cancel")}}),null),s(A,(()=>{var y=me(()=>u().length>0);return()=>y()&&S(De,{variant:"outline",onClick:w,get children(){return e("common.reset")}})})(),null),s(A,(()=>{var y=me(()=>u().length>0);return()=>y()&&S(De,{variant:"primary",onClick:P,get disabled(){return i()||!f().date||!f().description},get children(){return me(()=>!!i())()?e("banking.importing"):e("banking.importTransactions").replace("{count}",u().length.toString())}})})(),null),A})()]}})};St(["click"]);var Lh=z("<span>"),Bs=z("<div>"),Mh=z("<div> "),dE=z("<div><div><h3></h3><div><button></button><button></button><button></button></div></div><div></div><div><div><h4></h4><div></div></div><div><h4></h4><div>"),hE=z("<div><div><div></div><div> • </div></div><div><div>"),Pl=z("<span>✓ "),mE=z("<span>(<!>)"),fE=z("<div><strong>:</strong> "),Oh=z("<div><div><div></div><div> • </div></div><div>"),yE=z("<div><div>:</div><div></div><div>");const gE=t=>{const{t:e}=ot(),[r,n]=ye([]),[i,o]=ye([]),[a,c]=ye(null),[u,h]=ye([]),[f,p]=ye("unreconciled");ei(()=>{const $=rr.getBankAccountById(t.bankAccountId);if($){const Z=rr.getBankStatementsByAccount($.accountId).filter(F=>F.date>=t.selectedPeriod.start&&F.date<=t.selectedPeriod.end),k=rr.getEntryBookRecordsByAccount($.accountId).filter(F=>F.date>=t.selectedPeriod.start&&F.date<=t.selectedPeriod.end);n(Z),o(k)}});const _=()=>{const $=r();switch(f()){case"reconciled":return $.filter(Z=>Z.isReconciled);case"unreconciled":return $.filter(Z=>!Z.isReconciled);default:return $}},C=()=>{const $=i();switch(f()){case"reconciled":return $.filter(Z=>Z.isReconciled);case"unreconciled":return $.filter(Z=>!Z.isReconciled);default:return $}},N=$=>{if(c($),$.isReconciled)h([]);else{const Z=rr.findPotentialMatches($.id);h(Z)}},E=$=>{const Z=a();if(Z){rr.reconcileTransaction(Z.id,$.id);const k=rr.getBankAccountById(t.bankAccountId);if(k){const F=rr.getBankStatementsByAccount(k.accountId).filter(W=>W.date>=t.selectedPeriod.start&&W.date<=t.selectedPeriod.end),B=rr.getEntryBookRecordsByAccount(k.accountId).filter(W=>W.date>=t.selectedPeriod.start&&W.date<=t.selectedPeriod.end);n(F),o(B)}c(null),h([])}},T=$=>{rr.unreconciledTransaction($.id);const Z=rr.getBankAccountById(t.bankAccountId);if(Z){const k=rr.getBankStatementsByAccount(Z.accountId).filter(B=>B.date>=t.selectedPeriod.start&&B.date<=t.selectedPeriod.end),F=rr.getEntryBookRecordsByAccount(Z.accountId).filter(B=>B.date>=t.selectedPeriod.start&&B.date<=t.selectedPeriod.end);n(k),o(F)}},x={display:"grid","grid-template-columns":"1fr 1fr",gap:"2rem","margin-top":"2rem"},q={height:"600px","overflow-y":"auto"},ee={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},Y=$=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:$?"var(--primary-color)":"var(--surface-color)",color:$?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),ue=($,Z)=>({display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem","margin-bottom":"0.5rem",background:$?"var(--primary-color)":Z?"#e8f5e8":"var(--surface-color)",color:$?"white":"var(--text-primary)","border-radius":"var(--border-radius-sm)",border:`1px solid ${$?"var(--primary-color)":Z?"#c3e6cb":"var(--border-color)"}`,cursor:"pointer",transition:"all 0.2s ease"}),ie={flex:"1"},I={"font-weight":"500","margin-bottom":"0.25rem"},b={"font-size":"0.875rem",opacity:"0.8"},v=$=>({"font-weight":"600",color:$?"#4caf50":"#f44336"}),P={padding:"0.25rem 0.5rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","margin-left":"0.5rem"},w=$=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format($),A=$=>new Date($).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),y=$=>{if(!a())return null;const Z=a();return(Math.abs(Z.debitAmount-$.debitAmount)<.01||Math.abs(Z.creditAmount-$.creditAmount)<.01)&&Z.date===$.date?(()=>{var B=Lh();return s(B,()=>e("banking.exactMatch")),ne(W=>d(B,{...P,background:"#d4edda",color:"#155724"},W)),B})():u().includes($)?(()=>{var B=Lh();return s(B,()=>e("banking.possibleMatch")),ne(W=>d(B,{...P,background:"#fff3cd",color:"#856404"},W)),B})():null},H=(()=>{const $=r(),Z=i(),k=$.filter(B=>B.isReconciled).length,F=Z.filter(B=>B.isReconciled).length;return{totalStatements:$.length,totalRecords:Z.length,reconciledStatements:k,reconciledRecords:F,unreconciledStatements:$.length-k,unreconciledRecords:Z.length-F}})();return(()=>{var $=dE(),Z=$.firstChild,k=Z.firstChild,F=k.nextSibling,B=F.firstChild,W=B.nextSibling,fe=W.nextSibling,K=Z.nextSibling,he=K.nextSibling,D=he.firstChild,U=D.firstChild,Q=U.nextSibling,J=D.nextSibling,ce=J.firstChild,oe=ce.nextSibling;return d(Z,ee),k.style.setProperty("margin","0"),k.style.setProperty("font-size","1.25rem"),s(k,()=>e("banking.reconciliationComparison")),F.style.setProperty("display","flex"),F.style.setProperty("gap","0.5rem"),B.$$click=()=>p("all"),s(B,()=>e("common.all")),W.$$click=()=>p("unreconciled"),s(W,()=>e("banking.unreconciled")),fe.$$click=()=>p("reconciled"),s(fe,()=>e("banking.reconciled")),K.style.setProperty("display","grid"),K.style.setProperty("grid-template-columns","repeat(4, 1fr)"),K.style.setProperty("gap","1rem"),K.style.setProperty("margin-bottom","2rem"),s(K,S(Qe,{get title(){return e("banking.bankStatements")},get subtitle(){return e("banking.totalTransactions")},get children(){return[(()=>{var O=Bs();return O.style.setProperty("font-size","1.5rem"),O.style.setProperty("font-weight","600"),O.style.setProperty("color","var(--primary-color)"),s(O,()=>H.totalStatements),O})(),(()=>{var O=Mh(),re=O.firstChild;return O.style.setProperty("font-size","0.875rem"),O.style.setProperty("color","var(--text-muted)"),s(O,()=>H.reconciledStatements,re),s(O,()=>e("banking.reconciled"),null),O})()]}}),null),s(K,S(Qe,{get title(){return e("banking.entryBookRecords")},get subtitle(){return e("banking.totalEntries")},get children(){return[(()=>{var O=Bs();return O.style.setProperty("font-size","1.5rem"),O.style.setProperty("font-weight","600"),O.style.setProperty("color","var(--primary-color)"),s(O,()=>H.totalRecords),O})(),(()=>{var O=Mh(),re=O.firstChild;return O.style.setProperty("font-size","0.875rem"),O.style.setProperty("color","var(--text-muted)"),s(O,()=>H.reconciledRecords,re),s(O,()=>e("banking.reconciled"),null),O})()]}}),null),s(K,S(Qe,{get title(){return e("banking.unreconciledBank")},get subtitle(){return e("banking.needAttention")},get children(){var O=Bs();return O.style.setProperty("font-size","1.5rem"),O.style.setProperty("font-weight","600"),O.style.setProperty("color","#f44336"),s(O,()=>H.unreconciledStatements),O}}),null),s(K,S(Qe,{get title(){return e("banking.unreconciledBooks")},get subtitle(){return e("banking.needAttention")},get children(){var O=Bs();return O.style.setProperty("font-size","1.5rem"),O.style.setProperty("font-weight","600"),O.style.setProperty("color","#f44336"),s(O,()=>H.unreconciledRecords),O}}),null),d(he,x),U.style.setProperty("margin","0 0 1rem 0"),s(U,()=>e("banking.bankStatements")),s(Q,()=>_().map(O=>(()=>{var re=hE(),pe=re.firstChild,ve=pe.firstChild,te=ve.nextSibling,se=te.firstChild,R=pe.nextSibling,M=R.firstChild;return re.$$click=()=>N(O),s(ve,()=>O.description),s(te,()=>A(O.date),se),s(te,()=>O.reference,null),s(te,(()=>{var V=me(()=>!!O.isReconciled);return()=>V()&&(()=>{var ge=Pl();return ge.firstChild,ge.style.setProperty("color","#4caf50"),ge.style.setProperty("margin-left","0.5rem"),s(ge,()=>e("banking.reconciled"),null),ge})()})(),null),s(M,()=>O.debitAmount>0?"+":"-",null),s(M,()=>w(O.debitAmount||O.creditAmount),null),s(R,(()=>{var V=me(()=>!!O.isReconciled);return()=>V()&&S(De,{variant:"outline",size:"sm",onClick:ge=>{ge.stopPropagation(),T(O)},style:{"margin-top":"0.5rem"},get children(){return e("banking.unreconcile")}})})(),null),ne(V=>{var ge=ue(a()?.id===O.id,O.isReconciled),le=ie,j=I,G=b,Pe=v(O.debitAmount>0);return V.e=d(re,ge,V.e),V.t=d(pe,le,V.t),V.a=d(ve,j,V.a),V.o=d(te,G,V.o),V.i=d(M,Pe,V.i),V},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),re})())),ce.style.setProperty("margin","0 0 1rem 0"),s(ce,()=>e("banking.entryBookRecords"),null),s(ce,(()=>{var O=me(()=>!!(a()&&!a().isReconciled));return()=>O()&&(()=>{var re=mE(),pe=re.firstChild,ve=pe.nextSibling;return ve.nextSibling,re.style.setProperty("font-weight","400"),re.style.setProperty("color","var(--text-muted)"),re.style.setProperty("margin-left","0.5rem"),s(re,()=>e("banking.clickToReconcile"),ve),re})()})(),null),s(oe,(()=>{var O=me(()=>!!(a()&&!a().isReconciled));return()=>O()?[me(()=>me(()=>u().length>0)()&&(()=>{var re=fE(),pe=re.firstChild,ve=pe.firstChild;return pe.nextSibling,re.style.setProperty("margin-bottom","1rem"),re.style.setProperty("padding","0.75rem"),re.style.setProperty("background","#fff3cd"),re.style.setProperty("border-radius","var(--border-radius-sm)"),s(pe,()=>e("banking.potentialMatchesFound"),ve),s(re,()=>e("banking.clickRecordToReconcile"),null),re})()),me(()=>C().map(re=>(u().includes(re),(()=>{var pe=Oh(),ve=pe.firstChild,te=ve.firstChild,se=te.nextSibling,R=se.firstChild,M=ve.nextSibling;return pe.$$click=()=>{re.isReconciled||E(re)},s(te,()=>re.description,null),s(te,()=>y(re),null),s(se,()=>A(re.date),R),s(se,()=>re.reference,null),s(se,(()=>{var V=me(()=>!!re.isReconciled);return()=>V()&&(()=>{var ge=Pl();return ge.firstChild,ge.style.setProperty("color","#4caf50"),ge.style.setProperty("margin-left","0.5rem"),s(ge,()=>e("banking.reconciled"),null),ge})()})(),null),s(M,()=>re.debitAmount>0?"+":"-",null),s(M,()=>w(re.debitAmount||re.creditAmount),null),ne(V=>{var ge={...ue(!1,re.isReconciled),opacity:re.isReconciled?.6:1,cursor:re.isReconciled?"not-allowed":"pointer"},le=ie,j=I,G=b,Pe=v(re.debitAmount>0);return V.e=d(pe,ge,V.e),V.t=d(ve,le,V.t),V.a=d(te,j,V.a),V.o=d(se,G,V.o),V.i=d(M,Pe,V.i),V},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),pe})())))]:C().map(re=>(()=>{var pe=Oh(),ve=pe.firstChild,te=ve.firstChild,se=te.nextSibling,R=se.firstChild,M=ve.nextSibling;return s(te,()=>re.description),s(se,()=>A(re.date),R),s(se,()=>re.reference,null),s(se,(()=>{var V=me(()=>!!re.isReconciled);return()=>V()&&(()=>{var ge=Pl();return ge.firstChild,ge.style.setProperty("color","#4caf50"),ge.style.setProperty("margin-left","0.5rem"),s(ge,()=>e("banking.reconciled"),null),ge})()})(),null),s(M,()=>re.debitAmount>0?"+":"-",null),s(M,()=>w(re.debitAmount||re.creditAmount),null),ne(V=>{var ge=ue(!1,re.isReconciled),le=ie,j=I,G=b,Pe=v(re.debitAmount>0);return V.e=d(pe,ge,V.e),V.t=d(ve,le,V.t),V.a=d(te,j,V.a),V.o=d(se,G,V.o),V.i=d(M,Pe,V.i),V},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),pe})())})()),s($,(()=>{var O=me(()=>!!(a()&&!a().isReconciled));return()=>O()&&(()=>{var re=yE(),pe=re.firstChild,ve=pe.firstChild,te=pe.nextSibling,se=te.nextSibling;return re.style.setProperty("position","fixed"),re.style.setProperty("bottom","2rem"),re.style.setProperty("right","2rem"),re.style.setProperty("background","var(--surface-color)"),re.style.setProperty("padding","1rem"),re.style.setProperty("border-radius","var(--border-radius)"),re.style.setProperty("box-shadow","var(--shadow-lg)"),re.style.setProperty("border","1px solid var(--border-color)"),re.style.setProperty("max-width","300px"),pe.style.setProperty("font-weight","500"),pe.style.setProperty("margin-bottom","0.5rem"),s(pe,()=>e("banking.selected"),ve),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("margin-bottom","0.5rem"),s(te,()=>a().description),se.style.setProperty("font-weight","600"),se.style.setProperty("color","var(--primary-color)"),s(se,()=>w(a().debitAmount||a().creditAmount)),s(re,S(De,{variant:"secondary",size:"sm",onClick:()=>{c(null),h([])},style:{"margin-top":"0.5rem"},get children(){return e("banking.clearSelection")}}),null),re})()})(),null),ne(O=>{var re=Y(f()==="all"),pe=Y(f()==="unreconciled"),ve=Y(f()==="reconciled"),te=q,se=q;return O.e=d(B,re,O.e),O.t=d(W,pe,O.t),O.a=d(fe,ve,O.a),O.o=d(Q,te,O.o),O.i=d(oe,se,O.i),O},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),$})()};St(["click"]);var pE=z("<div><div><h2></h2><p></p></div><div>"),vE=z("<div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date>"),bE=z("<div><button></button><button>"),_E=z("<div><br>"),Co=z("<div>"),SE=z("<div><div></div><div> • </div><div>"),PE=z("<div>: "),wE=z("<div> <!> • <!> "),CE=z("<div>%"),AE=z("<div> of <!> transactions");const IE=()=>{const{t}=ot(),[e,r]=ye(null),[n,i]=ye({start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[o,a]=ye(!1),[c,u]=ye("overview");ei(()=>{!e()&&rr.bankAccounts.length>0&&r(rr.bankAccounts[0])});const h={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},f={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},p={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},_=ee=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:ee?"var(--primary-color)":"var(--text-muted)","border-bottom":ee?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),C={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},N=ee=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ee),E=ee=>new Date(ee).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),T=()=>rr.bankAccounts.map(ee=>({value:ee.id,label:`${ee.bankName} - ${ee.accountNumber} (${ee.accountType})`})),q=(()=>{if(!e())return null;const ee=rr.getBankStatementsByAccount(e().accountId).filter(ie=>ie.date>=n().start&&ie.date<=n().end),Y=rr.getEntryBookRecordsByAccount(e().accountId).filter(ie=>ie.date>=n().start&&ie.date<=n().end),ue=ee.filter(ie=>ie.isReconciled).length;return Y.filter(ie=>ie.isReconciled).length,{totalBankTransactions:ee.length,totalEntryBookRecords:Y.length,reconciledTransactions:ue,unreconciledTransactions:ee.length-ue,reconciliationRate:ee.length>0?ue/ee.length*100:0}})();return S(Fr,{get title(){return t("banking.title")},get children(){return[(()=>{var ee=pE(),Y=ee.firstChild,ue=Y.firstChild,ie=ue.nextSibling,I=Y.nextSibling;return d(ee,h),ue.style.setProperty("margin","0 0 0.5rem 0"),ue.style.setProperty("font-size","1.5rem"),s(ue,()=>t("banking.reconciliation")),ie.style.setProperty("margin","0"),ie.style.setProperty("color","var(--text-muted)"),s(ie,()=>t("banking.compareStatements")),I.style.setProperty("display","flex"),I.style.setProperty("gap","1rem"),s(I,S(De,{variant:"secondary",onClick:()=>a(!0),get disabled(){return!e()},get children(){return t("banking.importCSV")}}),null),s(I,S(De,{variant:"primary",get children(){return t("banking.startNewReconciliation")}}),null),ee})(),(()=>{var ee=vE(),Y=ee.firstChild,ue=Y.firstChild,ie=Y.nextSibling,I=ie.firstChild,b=I.nextSibling,v=ie.nextSibling,P=v.firstChild,w=P.nextSibling;return d(ee,f),Y.style.setProperty("flex","1"),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("font-weight","500"),s(ue,()=>t("banking.bankAccount")),s(Y,S(dr,{label:"",get value(){return e()?.id||""},onChange:A=>{const y=rr.getBankAccountById(A);r(y||null)},get options(){return T()}}),null),I.style.setProperty("display","block"),I.style.setProperty("margin-bottom","0.5rem"),I.style.setProperty("font-weight","500"),s(I,()=>t("entryBooks.startDate")),b.addEventListener("change",A=>i(y=>({...y,start:A.target.value}))),b.style.setProperty("padding","0.75rem"),b.style.setProperty("border","1px solid var(--border-color)"),b.style.setProperty("border-radius","var(--border-radius-sm)"),b.style.setProperty("font-family","inherit"),P.style.setProperty("display","block"),P.style.setProperty("margin-bottom","0.5rem"),P.style.setProperty("font-weight","500"),s(P,()=>t("entryBooks.endDate")),w.addEventListener("change",A=>i(y=>({...y,end:A.target.value}))),w.style.setProperty("padding","0.75rem"),w.style.setProperty("border","1px solid var(--border-color)"),w.style.setProperty("border-radius","var(--border-radius-sm)"),w.style.setProperty("font-family","inherit"),ne(()=>b.value=n().start),ne(()=>w.value=n().end),ee})(),(()=>{var ee=bE(),Y=ee.firstChild,ue=Y.nextSibling;return d(ee,p),Y.$$click=()=>u("overview"),s(Y,()=>t("common.overview")),ue.$$click=()=>u("reconciliation"),s(ue,()=>t("banking.reconciliation")),ne(ie=>{var I=_(c()==="overview"),b=_(c()==="reconciliation");return ie.e=d(Y,I,ie.e),ie.t=d(ue,b,ie.t),ie},{e:void 0,t:void 0}),ee})(),me(()=>me(()=>c()==="overview")()&&(()=>{var ee=Co();return s(ee,(()=>{var Y=me(()=>!!e());return()=>Y()&&(()=>{var ue=Co();return d(ue,C),s(ue,S(Qe,{get title(){return t("banking.bankAccountInfo")},get subtitle(){return t("banking.currentAccountDetails")},get children(){return[(()=>{var ie=SE(),I=ie.firstChild,b=I.nextSibling,v=b.firstChild,P=b.nextSibling;return ie.style.setProperty("margin-bottom","1rem"),I.style.setProperty("font-weight","600"),I.style.setProperty("margin-bottom","0.5rem"),s(I,()=>e().bankName),b.style.setProperty("color","var(--text-muted)"),b.style.setProperty("margin-bottom","0.5rem"),s(b,()=>e().accountNumber,v),s(b,()=>e().accountType,null),P.style.setProperty("font-size","1.25rem"),P.style.setProperty("font-weight","600"),P.style.setProperty("color","var(--primary-color)"),s(P,()=>N(e().currentBalance)),ie})(),me(()=>me(()=>!!e().lastReconciledDate)()&&(()=>{var ie=PE(),I=ie.firstChild;return ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-muted)"),s(ie,()=>t("banking.lastReconciled"),I),s(ie,()=>E(e().lastReconciledDate),null),ie})())]}}),null),s(ue,q&&[S(Qe,{get title(){return t("banking.bankTransactions")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var ie=Co();return ie.style.setProperty("font-size","1.5rem"),ie.style.setProperty("font-weight","600"),ie.style.setProperty("color","var(--primary-color)"),ie.style.setProperty("margin-bottom","0.5rem"),s(ie,()=>q.totalBankTransactions),ie})(),(()=>{var ie=wE(),I=ie.firstChild,b=I.nextSibling,v=b.nextSibling,P=v.nextSibling;return P.nextSibling,ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-muted)"),s(ie,()=>q.reconciledTransactions,I),s(ie,()=>t("banking.reconciled"),b),s(ie,()=>q.unreconciledTransactions,P),s(ie,()=>t("banking.pending"),null),ie})()]}}),S(Qe,{get title(){return t("entryBooks.entryBookRecords")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var ie=Co();return ie.style.setProperty("font-size","1.5rem"),ie.style.setProperty("font-weight","600"),ie.style.setProperty("color","var(--primary-color)"),ie.style.setProperty("margin-bottom","0.5rem"),s(ie,()=>q.totalEntryBookRecords),ie})(),(()=>{var ie=Co();return ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-muted)"),s(ie,()=>t("banking.bookEntriesForComparison")),ie})()]}}),S(Qe,{get title(){return t("banking.reconciliationRate")},get subtitle(){return t("banking.completionStatus")},get children(){return[(()=>{var ie=CE(),I=ie.firstChild;return ie.style.setProperty("font-size","1.5rem"),ie.style.setProperty("font-weight","600"),ie.style.setProperty("margin-bottom","0.5rem"),s(ie,()=>Math.round(q.reconciliationRate),I),ne(b=>(b=q.reconciliationRate>80?"#4caf50":q.reconciliationRate>50?"#ff9800":"#f44336")!=null?ie.style.setProperty("color",b):ie.style.removeProperty("color")),ie})(),(()=>{var ie=AE(),I=ie.firstChild,b=I.nextSibling;return b.nextSibling,ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-muted)"),s(ie,()=>q.reconciledTransactions,I),s(ie,()=>q.totalBankTransactions,b),ie})()]}})],null),ue})()})(),null),s(ee,S(Qe,{get title(){return t("banking.recentReconciliationSessions")},get subtitle(){return t("banking.latestActivity")},get children(){var Y=_E(),ue=Y.firstChild;return Y.style.setProperty("text-align","center"),Y.style.setProperty("color","var(--text-muted)"),Y.style.setProperty("padding","2rem"),s(Y,()=>t("banking.noRecentSessions"),ue),s(Y,S(De,{variant:"primary",style:{"margin-top":"1rem"},onClick:()=>u("reconciliation"),get children(){return t("banking.startFirstReconciliation")}}),null),Y}}),null),ee})()),me(()=>me(()=>!!(c()==="reconciliation"&&e()))()&&S(gE,{get bankAccountId(){return e().id},get selectedPeriod(){return n()}})),S(uE,{get isOpen(){return o()},onClose:()=>a(!1),get bankAccount(){return e()}})]}})};St(["click"]);var EE=z("<div><div></div><div>"),wl=z("<div>"),xE=z("<div> • <!> • <!> "),TE=z("<div><div><div></div><div></div></div><div><div></div><div>"),$E=z("<div><div>:"),kE=z("<div>⚠️ <!>: <!> <!>, <!> "),RE=z("<div><div><div></div><div></div></div><div>"),Vh=z("<div> "),DE=z("<div>✓ ");const NE=t=>{const{t:e}=ot(),r={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},n={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},i={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},o={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"0.5rem"},a={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"1rem"},c={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},u={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},h={"max-height":"100px","overflow-y":"auto","border-top":"1px solid var(--border-color)","padding-top":"1rem"},f={display:"flex","justify-content":"space-between","align-items":"center","font-size":"0.875rem","margin-bottom":"0.5rem"},p={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},_=x=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[x],C=x=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(x),N=x=>new Date(x).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),E=_(t.entry.status),T=Math.abs(t.entry.totalDebit-t.entry.totalCredit)<.01;return S(Qe,{get children(){return[(()=>{var x=EE(),q=x.firstChild,ee=q.nextSibling;return d(x,r),d(q,n),s(q,()=>t.entry.entryNumber),s(ee,()=>t.entry.status),ne(Y=>d(ee,{...i,background:E.bg,color:E.color},Y)),x})(),(()=>{var x=wl();return d(x,o),s(x,()=>t.entry.description),x})(),(()=>{var x=xE(),q=x.firstChild,ee=q.nextSibling,Y=ee.nextSibling,ue=Y.nextSibling;return ue.nextSibling,d(x,a),s(x,()=>N(t.entry.date),q),s(x,()=>t.entry.reference||e("journal.noReference","No reference"),ee),s(x,()=>e("journal.createdBy","By"),ue),s(x,()=>t.entry.createdBy,null),x})(),(()=>{var x=TE(),q=x.firstChild,ee=q.firstChild,Y=ee.nextSibling,ue=q.nextSibling,ie=ue.firstChild,I=ie.nextSibling;return d(x,c),ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),s(ee,()=>e("journal.totalAmount","Total Amount")),d(Y,u),s(Y,()=>C(t.entry.totalDebit)),ue.style.setProperty("text-align","right"),ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-muted)"),s(ie,()=>e("journal.lines","Lines")),I.style.setProperty("font-weight","600"),s(I,()=>t.entry.lines.length),x})(),me(()=>!T&&(()=>{var x=kE(),q=x.firstChild,ee=q.nextSibling,Y=ee.nextSibling,ue=Y.nextSibling,ie=ue.nextSibling,I=ie.nextSibling,b=I.nextSibling,v=b.nextSibling;return v.nextSibling,x.style.setProperty("padding","0.5rem"),x.style.setProperty("border-radius","var(--border-radius-sm)"),x.style.setProperty("background","#f8d7da"),x.style.setProperty("color","#721c24"),x.style.setProperty("font-size","0.875rem"),x.style.setProperty("margin-bottom","1rem"),s(x,()=>e("journal.entryNotBalancedShort","Entry is not balanced"),ee),s(x,()=>e("journal.debit"),ue),s(x,()=>C(t.entry.totalDebit),I),s(x,()=>e("journal.credit"),v),s(x,()=>C(t.entry.totalCredit),null),x})()),(()=>{var x=$E(),q=x.firstChild,ee=q.firstChild;return d(x,h),q.style.setProperty("font-weight","500"),q.style.setProperty("margin-bottom","0.5rem"),q.style.setProperty("font-size","0.875rem"),s(q,()=>e("journal.accountLines","Account Lines"),ee),s(x,()=>t.entry.lines.slice(0,3).map(Y=>(()=>{var ue=RE(),ie=ue.firstChild,I=ie.firstChild,b=I.nextSibling,v=ie.nextSibling;return d(ue,f),ie.style.setProperty("flex","1"),I.style.setProperty("font-weight","500"),s(I,()=>Y.accountName),b.style.setProperty("font-size","0.75rem"),b.style.setProperty("color","var(--text-muted)"),s(b,()=>Y.description||e("journal.noDescription","No description")),v.style.setProperty("text-align","right"),s(v,(()=>{var P=me(()=>Y.debitAmount>0);return()=>P()&&(()=>{var w=Vh(),A=w.firstChild;return w.style.setProperty("color","#4caf50"),w.style.setProperty("font-weight","500"),s(w,()=>e("journal.debitShort","Dr."),A),s(w,()=>C(Y.debitAmount),null),w})()})(),null),s(v,(()=>{var P=me(()=>Y.creditAmount>0);return()=>P()&&(()=>{var w=Vh(),A=w.firstChild;return w.style.setProperty("color","#f44336"),w.style.setProperty("font-weight","500"),s(w,()=>e("journal.creditShort","Cr."),A),s(w,()=>C(Y.creditAmount),null),w})()})(),null),s(v,(()=>{var P=me(()=>!!Y.reconciled);return()=>P()&&(()=>{var w=DE();return w.firstChild,w.style.setProperty("font-size","0.75rem"),w.style.setProperty("color","#4caf50"),s(w,()=>e("banking.reconciled","Reconciled"),null),w})()})(),null),ue})()),null),s(x,(()=>{var Y=me(()=>t.entry.lines.length>3);return()=>Y()&&(()=>{var ue=wl();return ue.style.setProperty("text-align","center"),ue.style.setProperty("color","var(--text-muted)"),ue.style.setProperty("font-size","0.875rem"),s(ue,()=>e("journal.andMoreLines","... and {count} more lines").replace("{count}",(t.entry.lines.length-3).toString())),ue})()})(),null),x})(),(()=>{var x=wl();return d(x,p),s(x,S(De,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.entry),get children(){return e("journal.viewDetails","View Details")}})),x})()]}})},LE=[{id:"je1",entryNumber:"JE-2024-001",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",status:"posted",createdBy:"John Doe",createdAt:"2024-01-15T09:00:00Z",postedAt:"2024-01-15T09:05:00Z",totalDebit:5e3,totalCredit:5e3,lines:[{id:"jel1",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment from ABC Corp",debitAmount:5e3,creditAmount:0,reconciled:!0,reconciledWith:"eb1"},{id:"jel2",accountId:"2001",accountName:"Trade Receivables",description:"Payment received for INV-2024-001",debitAmount:0,creditAmount:5e3}]},{id:"je2",entryNumber:"JE-2024-002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",status:"posted",createdBy:"Jane Smith",createdAt:"2024-01-14T10:00:00Z",postedAt:"2024-01-14T10:15:00Z",totalDebit:250,totalCredit:250,lines:[{id:"jel3",accountId:"5200",accountName:"Office Expenses",description:"Office supplies from Staples",debitAmount:250,creditAmount:0},{id:"jel4",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment to Staples",debitAmount:0,creditAmount:250,reconciled:!0,reconciledWith:"eb2"}]},{id:"je3",entryNumber:"JE-2024-003",date:"2024-01-13",description:"Monthly Rent Payment",reference:"RENT-2024-01",status:"posted",createdBy:"John Doe",createdAt:"2024-01-13T08:00:00Z",postedAt:"2024-01-13T08:30:00Z",totalDebit:2e3,totalCredit:2e3,lines:[{id:"jel5",accountId:"5200",accountName:"Rent Expense",description:"January office rent",debitAmount:2e3,creditAmount:0},{id:"jel6",accountId:"1002",accountName:"Bank - Checking Account",description:"Rent payment",debitAmount:0,creditAmount:2e3,reconciled:!1}]},{id:"je4",entryNumber:"JE-2024-004",date:"2024-01-12",description:"Wire Transfer - Capital Investment",reference:"WIRE-001",status:"posted",createdBy:"Admin",createdAt:"2024-01-12T14:00:00Z",postedAt:"2024-01-12T14:30:00Z",totalDebit:1e4,totalCredit:1e4,lines:[{id:"jel7",accountId:"1002",accountName:"Bank - Checking Account",description:"Wire transfer received",debitAmount:1e4,creditAmount:0,reconciled:!1},{id:"jel8",accountId:"8",accountName:"Owner's Equity",description:"Capital investment",debitAmount:0,creditAmount:1e4}]},{id:"je5",entryNumber:"JE-2024-005",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",status:"posted",createdBy:"HR Manager",createdAt:"2024-01-11T16:00:00Z",postedAt:"2024-01-11T16:30:00Z",totalDebit:3500,totalCredit:3500,lines:[{id:"jel9",accountId:"13",accountName:"Salaries Expense",description:"Monthly salary - John Doe",debitAmount:3500,creditAmount:0},{id:"jel10",accountId:"1002",accountName:"Bank - Checking Account",description:"Salary payment",debitAmount:0,creditAmount:3500,reconciled:!1}]},{id:"je6",entryNumber:"JE-2024-006",date:"2024-01-10",description:"Product Sales - Multiple Customers",reference:"SALES-2024-010",status:"posted",createdBy:"Sales Manager",createdAt:"2024-01-10T11:00:00Z",postedAt:"2024-01-10T11:30:00Z",totalDebit:8500,totalCredit:8500,lines:[{id:"jel11",accountId:"1001",accountName:"Petty Cash",description:"Cash sales",debitAmount:1500,creditAmount:0},{id:"jel12",accountId:"2001",accountName:"Trade Receivables",description:"Credit sales",debitAmount:7e3,creditAmount:0},{id:"jel13",accountId:"10",accountName:"Sales Revenue",description:"Product sales revenue",debitAmount:0,creditAmount:8500}]},{id:"je7",entryNumber:"JE-2024-007",date:"2024-01-09",description:"Inventory Purchase",reference:"PO-2024-002",status:"draft",createdBy:"Warehouse Manager",createdAt:"2024-01-09T15:00:00Z",totalDebit:15e3,totalCredit:15e3,lines:[{id:"jel14",accountId:"3",accountName:"Inventory",description:"Product inventory purchase",debitAmount:15e3,creditAmount:0},{id:"jel15",accountId:"5",accountName:"Accounts Payable",description:"Amount owed to supplier",debitAmount:0,creditAmount:15e3}]},{id:"je8",entryNumber:"JE-2024-008",date:"2024-01-08",description:"Utility Bills Payment",reference:"UTIL-2024-01",status:"posted",createdBy:"Admin",createdAt:"2024-01-08T09:00:00Z",postedAt:"2024-01-08T09:30:00Z",totalDebit:450,totalCredit:450,lines:[{id:"jel16",accountId:"14",accountName:"Operating Expenses",description:"Electricity and water bills",debitAmount:450,creditAmount:0},{id:"jel17",accountId:"1003",accountName:"Bank - Savings Account",description:"Utility payment",debitAmount:0,creditAmount:450}]}],[Tr,Cl]=ye(LE),Bh=()=>Tr().filter(e=>e.status==="posted").flatMap(e=>e.lines.filter(r=>["1001","1002","1003"].includes(r.accountId))).map(e=>{const r=Tr().find(n=>n.lines.some(i=>i.id===e.id));return r?{id:`eb_${e.id}`,accountId:e.accountId,date:r.date,description:r.description,reference:r.reference,debitAmount:e.debitAmount,creditAmount:e.creditAmount,category:e.accountName,isReconciled:e.reconciled||!1,reconciledWith:e.reconciledWith,createdAt:r.createdAt}:null}).filter(e=>e!==null),_n={get journalEntries(){return Tr()},addJournalEntry(t){const e={...t,id:Date.now().toString()};return Cl([...Tr(),e]),e},updateJournalEntry(t,e){Cl(Tr().map(r=>r.id===t?{...r,...e}:r))},deleteJournalEntry(t){const e=Tr().find(r=>r.id===t);if(e&&e.status==="posted")throw new Error("Cannot delete posted journal entries. Void them instead.");Cl(Tr().filter(r=>r.id!==t))},voidJournalEntry(t){this.updateJournalEntry(t,{status:"void"})},postJournalEntry(t){const e=Tr().find(r=>r.id===t);if(!e)throw new Error("Journal entry not found");if(Math.abs(e.totalDebit-e.totalCredit)>.01)throw new Error("Journal entry is not balanced. Debits must equal credits.");this.updateJournalEntry(t,{status:"posted",postedAt:new Date().toISOString()}),Bh()},getJournalEntryById(t){return Tr().find(e=>e.id===t)},getJournalEntriesByStatus(t){return Tr().filter(e=>e.status===t)},getJournalEntriesByDateRange(t,e){return Tr().filter(r=>r.date>=t&&r.date<=e)},getJournalEntriesByAccount(t){return Tr().filter(e=>e.lines.some(r=>r.accountId===t))},getNextEntryNumber(){const t=new Date().getFullYear(),r=Tr().filter(n=>n.entryNumber.includes(t.toString())).reduce((n,i)=>{const o=parseInt(i.entryNumber.split("-").pop()||"0");return o>n?o:n},0);return`JE-${t}-${String(r+1).padStart(3,"0")}`},validateJournalEntry(t){const e=[];if(t.date||e.push("Date is required"),t.description||e.push("Description is required"),(!t.lines||t.lines.length===0)&&e.push("At least one line item is required"),t.lines){const r=t.lines.reduce((i,o)=>i+(o.debitAmount||0),0),n=t.lines.reduce((i,o)=>i+(o.creditAmount||0),0);Math.abs(r-n)>.01&&e.push(`Entry is not balanced. Debit: ${r}, Credit: ${n}`),t.lines.forEach((i,o)=>{i.accountId||e.push(`Line ${o+1}: Account is required`),i.debitAmount===0&&i.creditAmount===0&&e.push(`Line ${o+1}: Either debit or credit amount must be provided`),i.debitAmount>0&&i.creditAmount>0&&e.push(`Line ${o+1}: Cannot have both debit and credit amounts`)})}return{isValid:e.length===0,errors:e}},getBankRelatedEntries(){return Bh()}};var ME=z("<form><div></div><div><div><h4></h4></div><div><div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div></div></div><div><div><strong>: </strong></div><div><strong>: </strong></div><div></div></div></div><div>"),Fh=z("<div>");const Uy=t=>{const{t:e}=ot(),[r,n]=ye({entryNumber:"",date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),[i,o]=ye([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),[a,c]=ye(null);ei(()=>{if(t.isOpen){if(t.editEntry)n({entryNumber:t.editEntry.entryNumber,date:t.editEntry.date,description:t.editEntry.description,reference:t.editEntry.reference,createdBy:t.editEntry.createdBy}),o(t.editEntry.lines.map((Y,ue)=>({...Y,tempId:`line_${Date.now()}_${ue}`})));else{const Y=_n.getNextEntryNumber();n({entryNumber:Y,date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),o([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])}c(null)}});const u={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},h={display:"grid","grid-template-columns":"2fr 2fr 1fr 1fr 1fr",gap:"1rem","align-items":"end","margin-bottom":"1rem",padding:"1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},f={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},p=()=>ut.accounts.map(Y=>({value:Y.id,label:`${Y.accountNumber} - ${Y.name}`})),_=(Y,ue)=>{n(ie=>({...ie,[Y]:ue}))},C=(Y,ue,ie)=>{o(I=>I.map(b=>{if(b.tempId===Y){const v={...b,[ue]:ie};if(ue==="accountId"&&typeof ie=="string"){const P=ut.getAccountById(ie);P&&(v.accountName=P.name)}return v}return b}))},N=()=>{o(Y=>[...Y,{tempId:`line_${Date.now()}_${Y.length}`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])},E=Y=>{i().length>2&&o(ue=>ue.filter(ie=>ie.tempId!==Y))},T=()=>{const Y=i().reduce((ie,I)=>ie+(I.debitAmount||0),0),ue=i().reduce((ie,I)=>ie+(I.creditAmount||0),0);return{totalDebit:Y,totalCredit:ue,isBalanced:Math.abs(Y-ue)<.01}},x=Y=>{Y.preventDefault(),c(null);const ue=r(),ie=i(),{totalDebit:I,totalCredit:b,isBalanced:v}=T();if(!ue.description){c(e("forms.descriptionRequired","Description is required"));return}if(ie.length<2){c(e("journal.minTwoLinesRequired","At least 2 line items are required"));return}if(!v){c(e("journal.entryNotBalanced","Entry is not balanced. Debit: ${debit}, Credit: ${credit}").replace("${debit}",`$${I.toFixed(2)}`).replace("${credit}",`$${b.toFixed(2)}`));return}for(let w=0;w<ie.length;w++){const A=ie[w];if(!A.accountId){c(e("journal.lineAccountRequired","Line {lineNumber}: Account is required").replace("{lineNumber}",(w+1).toString()));return}if(A.debitAmount===0&&A.creditAmount===0){c(e("journal.lineAmountRequired","Line {lineNumber}: Either debit or credit amount must be provided").replace("{lineNumber}",(w+1).toString()));return}if((A.debitAmount||0)>0&&(A.creditAmount||0)>0){c(e("journal.lineBothAmounts","Line {lineNumber}: Cannot have both debit and credit amounts").replace("{lineNumber}",(w+1).toString()));return}}const P={entryNumber:ue.entryNumber,date:ue.date,description:ue.description,reference:ue.reference,status:"draft",createdBy:ue.createdBy,createdAt:new Date().toISOString(),totalDebit:I,totalCredit:b,lines:ie.map((w,A)=>{const{tempId:y,...de}=w;return{id:`jel_${Date.now()}_${A}`,...de}})};try{t.editEntry?_n.updateJournalEntry(t.editEntry.id,P):_n.addJournalEntry(P),n({entryNumber:_n.getNextEntryNumber(),date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),o([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),t.onClose()}catch(w){c(w instanceof Error?w.message:e("forms.errorOccurred","An error occurred"))}},q=Y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Y),ee=T();return S(mr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return me(()=>!!t.editEntry)()?e("journal.editEntry"):e("journal.addEntry","Add Journal Entry")},get children(){var Y=ME(),ue=Y.firstChild,ie=ue.nextSibling,I=ie.firstChild,b=I.firstChild,v=I.nextSibling,P=v.firstChild,w=P.firstChild,A=w.firstChild,y=w.nextSibling,de=y.firstChild,H=y.nextSibling,$=H.firstChild,Z=H.nextSibling,k=Z.firstChild,F=Z.nextSibling,B=F.firstChild,W=v.nextSibling,fe=W.firstChild,K=fe.firstChild,he=K.firstChild,D=fe.nextSibling,U=D.firstChild,Q=U.firstChild,J=D.nextSibling,ce=ie.nextSibling;return Y.addEventListener("submit",x),ue.style.setProperty("display","grid"),ue.style.setProperty("grid-template-columns","1fr 1fr"),ue.style.setProperty("gap","1rem"),s(ue,S(_t,{get label(){return e("journal.entryNumber")},get value(){return r().entryNumber},onChange:oe=>_("entryNumber",oe),get disabled(){return!!t.editEntry},required:!0}),null),s(ue,S(_t,{get label(){return e("common.date")},type:"date",get value(){return r().date},onChange:oe=>_("date",oe),required:!0}),null),s(Y,S(_t,{get label(){return e("common.description")},get value(){return r().description},onChange:oe=>_("description",oe),get placeholder(){return e("journal.enterEntryDescription","Enter journal entry description")},required:!0}),ie),s(Y,S(_t,{get label(){return e("journal.reference")},get value(){return r().reference},onChange:oe=>_("reference",oe),get placeholder(){return e("journal.enterReferenceNumber","Enter reference number")}}),ie),ie.style.setProperty("margin-top","2rem"),I.style.setProperty("display","flex"),I.style.setProperty("justify-content","space-between"),I.style.setProperty("align-items","center"),I.style.setProperty("margin-bottom","1rem"),b.style.setProperty("margin","0"),s(b,()=>e("journal.entryLines","Journal Entry Lines")),s(I,S(De,{type:"button",variant:"secondary",size:"sm",onClick:N,get children(){return e("journal.addLine","Add Line")}}),null),v.style.setProperty("margin-bottom","1rem"),v.style.setProperty("font-size","0.875rem"),v.style.setProperty("color","var(--text-muted)"),P.style.setProperty("display","grid"),P.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1fr"),P.style.setProperty("gap","1rem"),s(A,()=>e("journal.account")),s(de,()=>e("common.description")),s($,()=>e("journal.debit")),s(k,()=>e("journal.credit")),s(B,()=>e("common.actions")),s(ie,S(Mt,{get each(){return i()},children:oe=>(()=>{var O=Fh();return d(O,h),s(O,S(dr,{label:"",get value(){return oe.accountId||""},onChange:re=>C(oe.tempId,"accountId",re),get options(){return p()}}),null),s(O,S(_t,{label:"",get value(){return oe.description||""},onChange:re=>C(oe.tempId,"description",re),get placeholder(){return e("journal.lineDescription","Line description")}}),null),s(O,S(_t,{label:"",type:"number",get value(){return oe.debitAmount?.toString()||"0"},onChange:re=>{C(oe.tempId,"debitAmount",parseFloat(re)||0),parseFloat(re)>0&&C(oe.tempId,"creditAmount",0)},placeholder:"0.00"}),null),s(O,S(_t,{label:"",type:"number",get value(){return oe.creditAmount?.toString()||"0"},onChange:re=>{C(oe.tempId,"creditAmount",parseFloat(re)||0),parseFloat(re)>0&&C(oe.tempId,"debitAmount",0)},placeholder:"0.00"}),null),s(O,S(De,{type:"button",variant:"outline",size:"sm",onClick:()=>E(oe.tempId),get disabled(){return i().length<=2},get children(){return e("common.remove","Remove")}}),null),O})()}),W),d(W,f),s(K,()=>e("journal.totalDebit","Total Debit"),he),s(K,()=>q(ee.totalDebit),null),s(U,()=>e("journal.totalCredit","Total Credit"),Q),s(U,()=>q(ee.totalCredit),null),J.style.setProperty("font-weight","600"),s(J,(()=>{var oe=me(()=>!!ee.isBalanced);return()=>oe()?`✓ ${e("journal.balanced")}`:`⚠️ ${e("journal.notBalanced","Not Balanced")}`})()),s(Y,(()=>{var oe=me(()=>!!a());return()=>oe()&&(()=>{var O=Fh();return O.style.setProperty("padding","1rem"),O.style.setProperty("border-radius","var(--border-radius-sm)"),O.style.setProperty("margin-top","1rem"),O.style.setProperty("background","#f8d7da"),O.style.setProperty("color","#721c24"),O.style.setProperty("border","1px solid #f5c6cb"),s(O,a),O})()})(),ce),d(ce,u),s(ce,S(De,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(ce,S(De,{variant:"primary",type:"submit",get disabled(){return!ee.isBalanced},get children(){return me(()=>!!t.editEntry)()?e("journal.updateEntry","Update Entry"):e("journal.saveAsDraft","Save as Draft")}}),null),ne(oe=>(oe=ee.isBalanced?"#4caf50":"#f44336")!=null?J.style.setProperty("color",oe):J.style.removeProperty("color")),Y}})};var OE=z("<div><div>⚠️</div><div></div><div></div><div>"),VE=z("<div><div></div><div></div><div></div><div></div><div>"),BE=z("<div><button></button><button> (<!>)</button><button> (<!>/<!>)"),Uh=z("<div>"),FE=z("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><div><h4></h4><div></div></div><div>"),Al=z("<div><span></span><span>"),Il=z("<div><strong>:</strong> "),UE=z("<div><div><div></div><div></div><div></div><div></div><div></div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div></div></div><div><div><strong>🔗 Reconciliation Summary</strong></div><div><div><div><strong>Total Lines:</strong> </div><div><strong>Reconciled:</strong> </div><div><strong>Unreconciled:</strong> </div></div><div><div><strong>Bank Accounts:</strong> </div><div><strong>Bank Reconciled:</strong> "),jE=z("<div><div><div></div><div></div></div><div></div><div></div><div></div><div>"),zE=z("<div><span>✓ "),qE=z("<span>(<!>)"),HE=z("<div><strong>Bank Pending:</strong> "),WE=z("<div><div>Reconciled Lines:"),GE=z("<div><div>⚠️ Pending Bank Reconciliation:</div><div>Visit Bank Consolidations to reconcile these transactions"),KE=z("<div><div><div><span></span><h3></h3></div><div><div><div></div><div>Total Lines</div></div><div><div></div><div>Reconciled</div></div><div><div></div><div>Pending"),YE=z("<div><h4>✅ Reconciled Lines (<!>)"),QE=z("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div>✓ Matched"),JE=z("<div>→ "),XE=z("<div><h4>⏳ Unreconciled Lines (<!>)"),ZE=z("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div>⏳ Pending"),ex=z("<div>Bank account"),tx=z("<div><div>💡 Reconciliation Tip</div><div>This entry has unreconciled bank account transactions. Visit <strong>Bank Consolidations</strong> to match these with bank statements.");const rx=t=>{const{t:e}=ot(),[r,n]=ye("details"),[i,o]=ye(!1),a=qe(()=>t.entryId?_n.getJournalEntryById(t.entryId):null),c={"text-align":"center","margin-bottom":"2rem",position:"relative"},u={position:"absolute",top:"0",right:"0",display:"flex",gap:"0.5rem"},h={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","margin-bottom":"0.5rem"},f={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},p={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},_={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem",display:"inline-block"},C={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},N={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},E={"font-weight":"600",color:"var(--text-primary)"},T={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},x=y=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:y?"var(--primary-color)":"var(--text-muted)","border-bottom":y?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),q={display:"grid","grid-template-columns":"2fr 2.5fr 1fr 1fr 1.5fr",gap:"1rem",padding:"1rem 0","border-bottom":"1px solid var(--border-color)","align-items":"center"},ee={...q,"font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","border-bottom":"2px solid var(--border-color)"},Y={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},ue={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ie=y=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[y],I=y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(y),b=y=>new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),v=y=>new Date(y).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),P=()=>{entry.status==="posted"&&!confirm(e("journal.confirmEditPosted","This entry has been posted. Editing will create a new draft copy. Continue?"))||o(!0)},w=()=>{if(a()&&confirm(e("journal.confirmPost","Are you sure you want to post this journal entry? This action cannot be undone.")))try{_n.postJournalEntry(a().id)}catch(y){alert(y instanceof Error?y.message:e("forms.errorPostingEntry","An error occurred while posting the entry"))}},A=()=>{a()&&confirm(e("journal.confirmVoid","Are you sure you want to void this journal entry?"))&&_n.voidJournalEntry(a().id)};return[S(mr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.entryDetails","Journal Entry Details")},get children(){return me(()=>!a())()?(()=>{var y=OE(),de=y.firstChild,H=de.nextSibling,$=H.nextSibling,Z=$.nextSibling;return y.style.setProperty("text-align","center"),y.style.setProperty("padding","3rem"),y.style.setProperty("color","var(--text-muted)"),de.style.setProperty("font-size","1.5rem"),de.style.setProperty("margin-bottom","1rem"),H.style.setProperty("font-size","1.1rem"),H.style.setProperty("margin-bottom","0.5rem"),s(H,()=>e("journal.entryNotFound","Entry Not Found")),$.style.setProperty("font-size","0.875rem"),s($,()=>e("journal.entryNotFoundMessage","The journal entry you're looking for could not be found or may have been deleted.")),Z.style.setProperty("margin-top","2rem"),s(Z,S(De,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),y})():(()=>{const y=a(),de=ie(y.status),H=Math.abs(y.totalDebit-y.totalCredit)<.01;return[(()=>{var $=VE(),Z=$.firstChild,k=Z.nextSibling,F=k.nextSibling,B=F.nextSibling,W=B.nextSibling;return d($,c),s(Z,S(De,{variant:"outline",size:"sm",onClick:P,get title(){return e("journal.editEntryTooltip","Edit this journal entry")},get children(){return e("common.edit")}}),null),s(Z,(()=>{var fe=me(()=>y.status==="draft");return()=>fe()&&S(De,{variant:"primary",size:"sm",onClick:w,disabled:!H,get title(){return H?e("journal.postEntryTooltip","Post this journal entry"):e("journal.entryMustBeBalanced","Entry must be balanced to post")},get children(){return e("journal.post","Post")}})})(),null),s(Z,(()=>{var fe=me(()=>y.status==="posted");return()=>fe()&&S(De,{variant:"outline",size:"sm",onClick:A,style:{color:"#dc3545","border-color":"#dc3545"},get title(){return e("journal.voidEntryTooltip","Void this journal entry")},get children(){return e("entryBooks.void","Void")}})})(),null),d(k,h),s(k,()=>y.entryNumber),d(F,f),s(F,()=>y.description),d(B,p),s(B,()=>I(y.totalDebit)),s(W,()=>y.status),ne(fe=>{var K=u,he={..._,background:de.bg,color:de.color};return fe.e=d(Z,K,fe.e),fe.t=d(W,he,fe.t),fe},{e:void 0,t:void 0}),$})(),(()=>{var $=BE(),Z=$.firstChild,k=Z.nextSibling,F=k.firstChild,B=F.nextSibling;B.nextSibling;var W=k.nextSibling,fe=W.firstChild,K=fe.nextSibling,he=K.nextSibling,D=he.nextSibling;return D.nextSibling,d($,T),Z.$$click=()=>n("details"),s(Z,()=>e("common.details")),k.$$click=()=>n("lines"),s(k,()=>e("journal.journalLines","Journal Lines"),F),s(k,()=>y.lines.length,B),W.$$click=()=>n("reconciliation"),s(W,()=>e("banking.reconciliation","Reconciliation"),fe),s(W,()=>y.lines.filter(U=>U.reconciled).length,K),s(W,()=>y.lines.length,D),ne(U=>{var Q=x(r()==="details"),J=x(r()==="lines"),ce=x(r()==="reconciliation");return U.e=d(Z,Q,U.e),U.t=d(k,J,U.t),U.a=d(W,ce,U.a),U},{e:void 0,t:void 0,a:void 0}),$})(),me(()=>me(()=>r()==="details")()&&(()=>{var $=FE(),Z=$.firstChild,k=Z.firstChild,F=k.nextSibling,B=Z.nextSibling,W=B.firstChild,fe=W.nextSibling,K=B.nextSibling,he=K.firstChild,D=he.nextSibling,U=K.nextSibling,Q=U.firstChild,J=Q.nextSibling,ce=U.nextSibling,oe=ce.firstChild,O=oe.nextSibling,re=ce.nextSibling,pe=re.firstChild,ve=pe.nextSibling,te=re.nextSibling,se=te.firstChild,R=se.nextSibling,M=te.nextSibling,V=M.firstChild,ge=V.firstChild,le=ge.nextSibling,j=V.nextSibling;return s(k,()=>e("common.date")),s(F,()=>b(y.date)),s(W,()=>e("journal.reference")),s(fe,()=>y.reference||e("common.notAvailable","N/A")),s(he,()=>e("journal.totalDebit")),s(D,()=>I(y.totalDebit)),s(Q,()=>e("journal.totalCredit")),s(J,()=>I(y.totalCredit)),s(oe,()=>e("journal.balanceStatus","Balance Status")),s(O,()=>H?`${e("journal.balanced")} ✓`:`${e("journal.unbalanced","Unbalanced")} (${I(Math.abs(y.totalDebit-y.totalCredit))} ${e("journal.difference","difference")})`),s(pe,()=>e("journal.createdBy")),s(ve,()=>y.createdBy),s(se,()=>e("journal.createdAt","Created At")),s(R,()=>v(y.createdAt)),s($,(()=>{var G=me(()=>!!y.postedAt);return()=>G()&&(()=>{var Pe=Al(),_e=Pe.firstChild,ae=_e.nextSibling;return s(_e,()=>e("journal.postedAt","Posted At")),s(ae,()=>v(y.postedAt)),ne(be=>{var X=C,Ce=N,$e=E;return be.e=d(Pe,X,be.e),be.t=d(_e,Ce,be.t),be.a=d(ae,$e,be.a),be},{e:void 0,t:void 0,a:void 0}),Pe})()})(),M),M.style.setProperty("margin-top","2rem"),M.style.setProperty("padding-top","1rem"),M.style.setProperty("border-top","2px solid var(--border-color)"),V.style.setProperty("display","flex"),V.style.setProperty("justify-content","space-between"),V.style.setProperty("align-items","center"),V.style.setProperty("margin-bottom","1rem"),ge.style.setProperty("margin","0"),ge.style.setProperty("font-size","1rem"),s(ge,()=>e("journal.quickActions","Quick Actions")),le.style.setProperty("display","flex"),le.style.setProperty("gap","0.5rem"),s(le,S(De,{variant:"primary",size:"sm",onClick:P,get children(){return["✏️ ",me(()=>e("journal.editEntry"))]}}),null),s(le,(()=>{var G=me(()=>y.status==="draft");return()=>G()&&S(De,{variant:"outline",size:"sm",onClick:w,disabled:!H,style:{"border-color":H?"#4caf50":"#f44336",color:H?"#4caf50":"#f44336"},get children(){return H?`✓ ${e("journal.postEntry","Post Entry")}`:`⚠️ ${e("journal.fixBalance","Fix Balance")}`}})})(),null),s(le,(()=>{var G=me(()=>y.status==="posted");return()=>G()&&S(De,{variant:"outline",size:"sm",onClick:A,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return["🗑️ ",me(()=>e("journal.voidEntry","Void Entry"))]}})})(),null),j.style.setProperty("padding","1rem"),j.style.setProperty("border-radius","var(--border-radius-sm)"),j.style.setProperty("font-size","0.875rem"),s(j,(()=>{var G=me(()=>y.status==="draft");return()=>G()&&(()=>{var Pe=Il(),_e=Pe.firstChild,ae=_e.firstChild;return _e.nextSibling,s(_e,()=>e("journal.draftEntry","Draft Entry"),ae),s(Pe,()=>e("journal.draftEntryDescription","This entry can be edited and posted."),null),s(Pe,()=>!H&&` ⚠️ ${e("journal.entryMustBeBalancedBeforePosting","Entry must be balanced before posting.")}`,null),Pe})()})(),null),s(j,(()=>{var G=me(()=>y.status==="posted");return()=>G()&&(()=>{var Pe=Il(),_e=Pe.firstChild,ae=_e.firstChild;return _e.nextSibling,s(_e,()=>e("journal.postedEntry","Posted Entry"),ae),s(Pe,()=>e("journal.postedEntryDescription","This entry has been posted to the general ledger. Editing will create a new draft copy."),null),Pe})()})(),null),s(j,(()=>{var G=me(()=>y.status==="void");return()=>G()&&(()=>{var Pe=Il(),_e=Pe.firstChild,ae=_e.firstChild;return _e.nextSibling,s(_e,()=>e("journal.voidEntry"),ae),s(Pe,()=>e("journal.voidEntryDescription","This entry has been voided and cannot be modified."),null),Pe})()})(),null),ne(G=>{var Pe=C,_e=N,ae=E,be=C,X=N,Ce=E,$e=C,Ee=N,xe=E,Oe=C,He=N,je=E,Ie=C,Be=N,We={...E,color:H?"#4caf50":"#f44336"},ze=C,Ge=N,Ae=E,nt=C,et=N,dt=E,xt=y.status==="draft"?"#fff3cd":y.status==="posted"?"#d4edda":"#f8d7da";return G.e=d(Z,Pe,G.e),G.t=d(k,_e,G.t),G.a=d(F,ae,G.a),G.o=d(B,be,G.o),G.i=d(W,X,G.i),G.n=d(fe,Ce,G.n),G.s=d(K,$e,G.s),G.h=d(he,Ee,G.h),G.r=d(D,xe,G.r),G.d=d(U,Oe,G.d),G.l=d(Q,He,G.l),G.u=d(J,je,G.u),G.c=d(ce,Ie,G.c),G.w=d(oe,Be,G.w),G.m=d(O,We,G.m),G.f=d(re,ze,G.f),G.y=d(pe,Ge,G.y),G.g=d(ve,Ae,G.g),G.p=d(te,nt,G.p),G.b=d(se,et,G.b),G.T=d(R,dt,G.T),xt!==G.A&&((G.A=xt)!=null?j.style.setProperty("background",xt):j.style.removeProperty("background")),G},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),$})()),me(()=>me(()=>r()==="lines")()&&(()=>{var $=UE(),Z=$.firstChild,k=Z.firstChild,F=k.nextSibling,B=F.nextSibling,W=B.nextSibling,fe=W.nextSibling,K=Z.nextSibling,he=K.firstChild,D=he.firstChild,U=D.firstChild;D.nextSibling;var Q=he.nextSibling,J=Q.firstChild,ce=J.firstChild;J.nextSibling;var oe=Q.nextSibling,O=K.nextSibling,re=O.firstChild,pe=re.nextSibling,ve=pe.firstChild,te=ve.firstChild,se=te.firstChild;se.nextSibling;var R=te.nextSibling,M=R.firstChild;M.nextSibling;var V=R.nextSibling,ge=V.firstChild;ge.nextSibling;var le=ve.nextSibling,j=le.firstChild,G=j.firstChild;G.nextSibling;var Pe=j.nextSibling,_e=Pe.firstChild;return _e.nextSibling,s(k,()=>e("journal.account")),s(F,()=>e("common.description")),s(B,()=>e("journal.debit")),s(W,()=>e("journal.credit")),s(fe,()=>e("banking.reconciliation")),s($,S(Mt,{get each(){return y.lines},children:ae=>(()=>{var be=jE(),X=be.firstChild,Ce=X.firstChild,$e=Ce.nextSibling,Ee=X.nextSibling,xe=Ee.nextSibling,Oe=xe.nextSibling,He=Oe.nextSibling;return Ce.style.setProperty("font-weight","500"),s(Ce,()=>ae.accountName),$e.style.setProperty("font-size","0.75rem"),$e.style.setProperty("color","var(--text-muted)"),s($e,()=>ut.getAccountById(ae.accountId)?.accountNumber||ae.accountId),Ee.style.setProperty("font-size","0.875rem"),s(Ee,()=>ae.description||"-"),xe.style.setProperty("font-weight","600"),s(xe,(()=>{var je=me(()=>ae.debitAmount>0);return()=>je()?I(ae.debitAmount):"-"})()),Oe.style.setProperty("font-weight","600"),s(Oe,(()=>{var je=me(()=>ae.creditAmount>0);return()=>je()?I(ae.creditAmount):"-"})()),s(He,(()=>{var je=me(()=>!!ae.reconciled);return()=>je()?(()=>{var Ie=zE(),Be=Ie.firstChild;return Be.firstChild,Ie.style.setProperty("display","flex"),Ie.style.setProperty("align-items","center"),Ie.style.setProperty("gap","0.5rem"),Ie.style.setProperty("color","#4caf50"),Ie.style.setProperty("font-size","0.875rem"),Be.style.setProperty("font-weight","600"),s(Be,()=>e("banking.reconciled"),null),s(Ie,(()=>{var We=me(()=>!!ae.reconciledWith);return()=>We()&&(()=>{var ze=qE(),Ge=ze.firstChild,Ae=Ge.nextSibling;return Ae.nextSibling,ze.style.setProperty("font-size","0.75rem"),ze.style.setProperty("color","var(--text-muted)"),ze.style.setProperty("font-style","italic"),s(ze,()=>ae.reconciledWith,Ae),ze})()})(),null),Ie})():(()=>{var Ie=Uh();return Ie.style.setProperty("color","var(--text-muted)"),Ie.style.setProperty("font-size","0.875rem"),s(Ie,()=>e("banking.notReconciled","Not Reconciled")),Ie})()})()),ne(je=>{var Ie=q,Be=ae.debitAmount>0?"#4caf50":"var(--text-muted)",We=ae.creditAmount>0?"#f44336":"var(--text-muted)";return je.e=d(be,Ie,je.e),Be!==je.t&&((je.t=Be)!=null?xe.style.setProperty("color",Be):xe.style.removeProperty("color")),We!==je.a&&((je.a=We)!=null?Oe.style.setProperty("color",We):Oe.style.removeProperty("color")),je},{e:void 0,t:void 0,a:void 0}),be})()}),K),d(K,Y),s(D,()=>e("journal.totalDebit"),U),s(he,()=>I(y.totalDebit),null),s(J,()=>e("journal.totalCredit"),ce),s(Q,()=>I(y.totalCredit),null),(H?"#4caf50":"#f44336")!=null?oe.style.setProperty("color",H?"#4caf50":"#f44336"):oe.style.removeProperty("color"),oe.style.setProperty("font-weight","600"),s(oe,()=>H?`✓ ${e("journal.balanced")}`:`⚠️ ${e("journal.notBalanced","Not Balanced")}`),O.style.setProperty("margin-top","1rem"),O.style.setProperty("padding","1rem"),O.style.setProperty("border-radius","var(--border-radius-sm)"),O.style.setProperty("font-size","0.875rem"),re.style.setProperty("margin-bottom","0.5rem"),pe.style.setProperty("display","grid"),pe.style.setProperty("grid-template-columns","1fr 1fr"),pe.style.setProperty("gap","1rem"),te.style.setProperty("margin-bottom","0.25rem"),s(te,()=>y.lines.length,null),R.style.setProperty("margin-bottom","0.25rem"),R.style.setProperty("color","#4caf50"),s(R,()=>y.lines.filter(ae=>ae.reconciled).length,null),V.style.setProperty("color","#f44336"),s(V,()=>y.lines.filter(ae=>!ae.reconciled).length,null),j.style.setProperty("margin-bottom","0.25rem"),s(j,()=>y.lines.filter(ae=>["1001","1002","1003"].includes(ae.accountId)).length,null),Pe.style.setProperty("margin-bottom","0.25rem"),Pe.style.setProperty("color","#4caf50"),s(Pe,()=>y.lines.filter(ae=>["1001","1002","1003"].includes(ae.accountId)&&ae.reconciled).length,null),s(le,(()=>{var ae=me(()=>y.lines.filter(be=>["1001","1002","1003"].includes(be.accountId)&&!be.reconciled).length>0);return()=>ae()&&(()=>{var be=HE(),X=be.firstChild;return X.nextSibling,be.style.setProperty("color","#f44336"),s(be,()=>y.lines.filter(Ce=>["1001","1002","1003"].includes(Ce.accountId)&&!Ce.reconciled).length,null),be})()})(),null),s(O,(()=>{var ae=me(()=>y.lines.filter(be=>be.reconciled).length>0);return()=>ae()&&(()=>{var be=WE(),X=be.firstChild;return be.style.setProperty("margin-top","0.75rem"),be.style.setProperty("padding-top","0.75rem"),be.style.setProperty("border-top","1px solid var(--border-color)"),X.style.setProperty("margin-bottom","0.5rem"),X.style.setProperty("font-weight","500"),s(be,()=>y.lines.filter(Ce=>Ce.reconciled).map(Ce=>(()=>{var $e=Al(),Ee=$e.firstChild,xe=Ee.nextSibling;return $e.style.setProperty("display","flex"),$e.style.setProperty("justify-content","space-between"),$e.style.setProperty("margin-bottom","0.25rem"),$e.style.setProperty("font-size","0.8rem"),s(Ee,()=>Ce.accountName),xe.style.setProperty("color","var(--text-muted)"),s(xe,()=>Ce.reconciledWith?`→ ${Ce.reconciledWith}`:"Manual"),$e})()),null),be})()})(),null),s(O,(()=>{var ae=me(()=>y.lines.filter(be=>!be.reconciled&&["1001","1002","1003"].includes(be.accountId)).length>0);return()=>ae()&&(()=>{var be=GE(),X=be.firstChild,Ce=X.nextSibling;return be.style.setProperty("margin-top","0.75rem"),be.style.setProperty("padding-top","0.75rem"),be.style.setProperty("border-top","1px solid var(--border-color)"),X.style.setProperty("margin-bottom","0.5rem"),X.style.setProperty("font-weight","500"),X.style.setProperty("color","#f44336"),s(be,()=>y.lines.filter($e=>!$e.reconciled&&["1001","1002","1003"].includes($e.accountId)).map($e=>(()=>{var Ee=Al(),xe=Ee.firstChild,Oe=xe.nextSibling;return Ee.style.setProperty("display","flex"),Ee.style.setProperty("justify-content","space-between"),Ee.style.setProperty("margin-bottom","0.25rem"),Ee.style.setProperty("font-size","0.8rem"),Ee.style.setProperty("color","#f44336"),s(xe,()=>$e.accountName),s(Oe,()=>I($e.debitAmount||$e.creditAmount)),Ee})()),Ce),Ce.style.setProperty("margin-top","0.5rem"),Ce.style.setProperty("font-size","0.75rem"),Ce.style.setProperty("color","var(--text-muted)"),Ce.style.setProperty("font-style","italic"),be})()})(),null),ne(ae=>{var be=ee,X=y.lines.some(Ce=>Ce.reconciled)?"#e8f5e8":"#fff3cd";return ae.e=d(Z,be,ae.e),X!==ae.t&&((ae.t=X)!=null?O.style.setProperty("background",X):O.style.removeProperty("background")),ae},{e:void 0,t:void 0}),$})()),me(()=>me(()=>r()==="reconciliation")()&&(()=>{var $=KE(),Z=$.firstChild,k=Z.firstChild,F=k.firstChild,B=F.nextSibling,W=k.nextSibling,fe=W.firstChild,K=fe.firstChild,he=K.nextSibling,D=fe.nextSibling,U=D.firstChild,Q=U.nextSibling,J=D.nextSibling,ce=J.firstChild,oe=ce.nextSibling;return Z.style.setProperty("margin-bottom","1.5rem"),Z.style.setProperty("padding","1rem"),Z.style.setProperty("border-radius","var(--border-radius)"),Z.style.setProperty("border","1px solid var(--border-color)"),k.style.setProperty("display","flex"),k.style.setProperty("align-items","center"),k.style.setProperty("gap","0.5rem"),k.style.setProperty("margin-bottom","1rem"),F.style.setProperty("font-size","1.5rem"),s(F,(()=>{var O=me(()=>!!y.lines.every(re=>re.reconciled));return()=>O()?"✅":y.lines.some(re=>re.reconciled)?"🔄":"⏳"})()),B.style.setProperty("margin","0"),B.style.setProperty("font-size","1.2rem"),s(B,(()=>{var O=me(()=>!!y.lines.every(re=>re.reconciled));return()=>O()?"Fully Reconciled":y.lines.some(re=>re.reconciled)?"Partially Reconciled":"Unreconciled"})()),W.style.setProperty("display","grid"),W.style.setProperty("grid-template-columns","1fr 1fr 1fr"),W.style.setProperty("gap","1rem"),fe.style.setProperty("text-align","center"),K.style.setProperty("font-size","2rem"),K.style.setProperty("font-weight","700"),K.style.setProperty("color","var(--primary-color)"),s(K,()=>y.lines.length),he.style.setProperty("font-size","0.875rem"),he.style.setProperty("color","var(--text-muted)"),D.style.setProperty("text-align","center"),U.style.setProperty("font-size","2rem"),U.style.setProperty("font-weight","700"),U.style.setProperty("color","#4caf50"),s(U,()=>y.lines.filter(O=>O.reconciled).length),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),J.style.setProperty("text-align","center"),ce.style.setProperty("font-size","2rem"),ce.style.setProperty("font-weight","700"),ce.style.setProperty("color","#f44336"),s(ce,()=>y.lines.filter(O=>!O.reconciled).length),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),s($,(()=>{var O=me(()=>y.lines.filter(re=>re.reconciled).length>0);return()=>O()&&(()=>{var re=YE(),pe=re.firstChild,ve=pe.firstChild,te=ve.nextSibling;return te.nextSibling,re.style.setProperty("margin-bottom","1.5rem"),pe.style.setProperty("margin","0 0 1rem 0"),pe.style.setProperty("font-size","1.1rem"),pe.style.setProperty("color","#4caf50"),pe.style.setProperty("display","flex"),pe.style.setProperty("align-items","center"),pe.style.setProperty("gap","0.5rem"),s(pe,()=>y.lines.filter(se=>se.reconciled).length,te),s(re,()=>y.lines.filter(se=>se.reconciled).map(se=>(()=>{var R=QE(),M=R.firstChild,V=M.firstChild,ge=V.nextSibling,le=M.nextSibling,j=le.nextSibling,G=j.nextSibling,Pe=G.nextSibling,_e=Pe.firstChild;return R.style.setProperty("display","grid"),R.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),R.style.setProperty("gap","1rem"),R.style.setProperty("padding","0.75rem"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("background","#f0f9f0"),R.style.setProperty("border-radius","var(--border-radius-sm)"),R.style.setProperty("align-items","center"),R.style.setProperty("font-size","0.875rem"),V.style.setProperty("font-weight","500"),s(V,()=>se.accountName),ge.style.setProperty("font-size","0.75rem"),ge.style.setProperty("color","var(--text-muted)"),s(ge,()=>ut.getAccountById(se.accountId)?.accountNumber),le.style.setProperty("color","var(--text-muted)"),s(le,()=>se.description||"No description"),j.style.setProperty("font-weight","600"),s(j,(()=>{var ae=me(()=>se.debitAmount>0);return()=>ae()?I(se.debitAmount):"-"})()),G.style.setProperty("font-weight","600"),s(G,(()=>{var ae=me(()=>se.creditAmount>0);return()=>ae()?I(se.creditAmount):"-"})()),Pe.style.setProperty("color","#4caf50"),_e.style.setProperty("font-weight","500"),s(Pe,(()=>{var ae=me(()=>!!se.reconciledWith);return()=>ae()&&(()=>{var be=JE();return be.firstChild,be.style.setProperty("font-size","0.75rem"),be.style.setProperty("font-style","italic"),s(be,()=>se.reconciledWith,null),be})()})(),null),ne(ae=>{var be=se.debitAmount>0?"#4caf50":"var(--text-muted)",X=se.creditAmount>0?"#f44336":"var(--text-muted)";return be!==ae.e&&((ae.e=be)!=null?j.style.setProperty("color",be):j.style.removeProperty("color")),X!==ae.t&&((ae.t=X)!=null?G.style.setProperty("color",X):G.style.removeProperty("color")),ae},{e:void 0,t:void 0}),R})()),null),re})()})(),null),s($,(()=>{var O=me(()=>y.lines.filter(re=>!re.reconciled).length>0);return()=>O()&&(()=>{var re=XE(),pe=re.firstChild,ve=pe.firstChild,te=ve.nextSibling;return te.nextSibling,re.style.setProperty("margin-bottom","1.5rem"),pe.style.setProperty("margin","0 0 1rem 0"),pe.style.setProperty("font-size","1.1rem"),pe.style.setProperty("color","#f44336"),pe.style.setProperty("display","flex"),pe.style.setProperty("align-items","center"),pe.style.setProperty("gap","0.5rem"),s(pe,()=>y.lines.filter(se=>!se.reconciled).length,te),s(re,()=>y.lines.filter(se=>!se.reconciled).map(se=>(()=>{var R=ZE(),M=R.firstChild,V=M.firstChild,ge=V.nextSibling,le=M.nextSibling,j=le.nextSibling,G=j.nextSibling,Pe=G.nextSibling,_e=Pe.firstChild;return R.style.setProperty("display","grid"),R.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),R.style.setProperty("gap","1rem"),R.style.setProperty("padding","0.75rem"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("background","#fff9f0"),R.style.setProperty("border-radius","var(--border-radius-sm)"),R.style.setProperty("align-items","center"),R.style.setProperty("font-size","0.875rem"),R.style.setProperty("border","1px solid #ffe0b3"),V.style.setProperty("font-weight","500"),s(V,()=>se.accountName),ge.style.setProperty("font-size","0.75rem"),ge.style.setProperty("color","var(--text-muted)"),s(ge,()=>ut.getAccountById(se.accountId)?.accountNumber),le.style.setProperty("color","var(--text-muted)"),s(le,()=>se.description||"No description"),j.style.setProperty("font-weight","600"),s(j,(()=>{var ae=me(()=>se.debitAmount>0);return()=>ae()?I(se.debitAmount):"-"})()),G.style.setProperty("font-weight","600"),s(G,(()=>{var ae=me(()=>se.creditAmount>0);return()=>ae()?I(se.creditAmount):"-"})()),Pe.style.setProperty("color","#f44336"),_e.style.setProperty("font-weight","500"),s(Pe,(()=>{var ae=me(()=>!!["1001","1002","1003"].includes(se.accountId));return()=>ae()&&(()=>{var be=ex();return be.style.setProperty("font-size","0.75rem"),be.style.setProperty("font-style","italic"),be})()})(),null),ne(ae=>{var be=se.debitAmount>0?"#4caf50":"var(--text-muted)",X=se.creditAmount>0?"#f44336":"var(--text-muted)";return be!==ae.e&&((ae.e=be)!=null?j.style.setProperty("color",be):j.style.removeProperty("color")),X!==ae.t&&((ae.t=X)!=null?G.style.setProperty("color",X):G.style.removeProperty("color")),ae},{e:void 0,t:void 0}),R})()),null),s(re,(()=>{var se=me(()=>y.lines.filter(R=>!R.reconciled&&["1001","1002","1003"].includes(R.accountId)).length>0);return()=>se()&&(()=>{var R=tx(),M=R.firstChild,V=M.nextSibling;return R.style.setProperty("padding","0.75rem"),R.style.setProperty("background","#ffebee"),R.style.setProperty("border-radius","var(--border-radius-sm)"),R.style.setProperty("margin-top","1rem"),R.style.setProperty("border","1px solid #ffcdd2"),M.style.setProperty("font-weight","500"),M.style.setProperty("margin-bottom","0.5rem"),M.style.setProperty("color","#f44336"),V.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","var(--text-muted)"),R})()})(),null),re})()})(),null),ne(O=>(O=y.lines.every(re=>re.reconciled)?"#e8f5e8":y.lines.some(re=>re.reconciled)?"#fff3cd":"#ffebee")!=null?Z.style.setProperty("background",O):Z.style.removeProperty("background")),$})()),(()=>{var $=Uh();return d($,ue),s($,S(De,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s($,S(De,{variant:"primary",onClick:P,get children(){return e("journal.editEntry")}}),null),s($,(()=>{var Z=me(()=>y.status==="draft");return()=>Z()&&S(De,{variant:"outline",onClick:w,disabled:!H,style:{"border-color":"#4caf50",color:H?"#4caf50":"var(--text-muted)"},get children(){return H?e("journal.postEntry","Post Entry"):e("journal.entryNotBalanced","Entry Not Balanced")}})})(),null),s($,(()=>{var Z=me(()=>y.status==="posted");return()=>Z()&&S(De,{variant:"outline",onClick:A,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return e("journal.voidEntry","Void Entry")}})})(),null),$})()]})()}}),me(()=>me(()=>!!a())()&&S(Uy,{get isOpen(){return i()},onClose:()=>{o(!1)},get editEntry(){return a()}}))]};St(["click"]);var nx=z("<div><div><h2></h2><p></p></div><div>"),yn=z("<div>"),ix=z("<div> <!> • <!> "),ox=z("<div><div><label></label></div><div><label></label></div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label></div><div>"),sx=z("<div><span>:</span><span> "),Fs=z("<span>: "),ax=z("<div><br>");const lx=()=>{const{t}=ot(),[e,r]=ye(!1),[n,i]=ye(null),[o,a]=ye(!1),[c,u]=ye(null),[h,f]=ye("all"),[p,_]=ye("all"),[C,N]=ye(""),[E,T]=ye(""),[x,q]=ye("date"),[ee,Y]=ye("desc"),ue={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},ie={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)","flex-wrap":"wrap"},I={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem"},b={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(400px, 1fr))",gap:"1.5rem"},v=()=>[{value:"all",label:t("journal.allEntries","All Entries")},{value:"draft",label:t("journal.draft")},{value:"posted",label:t("journal.posted")},{value:"void",label:t("entryBooks.void","Void")}],P=()=>[{value:"all",label:t("accounts.allAccounts","All Accounts")},...ut.accounts.map(B=>({value:B.id,label:`${B.accountNumber} - ${B.name}`}))],w=()=>[{value:"date",label:t("common.date")},{value:"entryNumber",label:t("journal.entryNumber")},{value:"amount",label:t("common.amount")}],A=()=>{let B=_n.journalEntries;return h()!=="all"&&(B=B.filter(W=>W.status===h())),p()!=="all"&&(B=B.filter(W=>W.lines.some(fe=>fe.accountId===p()))),C()&&(B=B.filter(W=>W.date>=C())),E()&&(B=B.filter(W=>W.date<=E())),B=[...B].sort((W,fe)=>{let K=0;switch(x()){case"date":K=new Date(W.date).getTime()-new Date(fe.date).getTime();break;case"entryNumber":K=W.entryNumber.localeCompare(fe.entryNumber);break;case"amount":K=W.totalDebit-fe.totalDebit;break}return ee()==="asc"?K:-K}),B},y=()=>{const B=_n.journalEntries,W=B.filter(Q=>Q.status==="draft"),fe=B.filter(Q=>Q.status==="posted"),K=B.filter(Q=>Q.status==="void"),he=fe.reduce((Q,J)=>Q+J.totalDebit,0),D=fe.reduce((Q,J)=>Q+J.totalCredit,0),U=B.filter(Q=>Q.lines.some(J=>["1001","1002","1003"].includes(J.accountId)&&!J.reconciled)).length;return{totalEntries:B.length,draftEntries:W.length,postedEntries:fe.length,voidEntries:K.length,totalDebit:he,totalCredit:D,unreconciledEntries:U}},de=B=>{u(B.id),a(!0)},H=()=>{i(null),r(!0)},$=()=>{r(!1),i(null)},Z=B=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(B),k=y(),F=A();return S(Fr,{get title(){return t("entryBooks.title")},get children(){return[(()=>{var B=nx(),W=B.firstChild,fe=W.firstChild,K=fe.nextSibling,he=W.nextSibling;return d(B,ue),fe.style.setProperty("margin","0 0 0.5rem 0"),fe.style.setProperty("font-size","1.5rem"),s(fe,()=>t("journal.title")),K.style.setProperty("margin","0"),K.style.setProperty("color","var(--text-muted)"),s(K,()=>t("entryBooks.subtitle","Manage accounting entries and general ledger records")),he.style.setProperty("display","flex"),he.style.setProperty("gap","1rem"),s(he,S(De,{variant:"secondary",onClick:()=>window.location.href="/bank-consolidations",get children(){return t("entryBooks.viewReconciliation","View Reconciliation")}}),null),s(he,S(De,{variant:"primary",onClick:H,get children(){return t("journal.addEntry","Add Journal Entry")}}),null),B})(),(()=>{var B=yn();return d(B,I),s(B,S(Qe,{get title(){return t("entryBooks.totalEntries","Total Entries")},get subtitle(){return t("entryBooks.allJournalEntries","All journal entries")},get children(){return[(()=>{var W=yn();return W.style.setProperty("font-size","1.5rem"),W.style.setProperty("font-weight","600"),W.style.setProperty("color","var(--primary-color)"),W.style.setProperty("margin-bottom","0.5rem"),s(W,()=>k.totalEntries),W})(),(()=>{var W=ix(),fe=W.firstChild,K=fe.nextSibling,he=K.nextSibling,D=he.nextSibling;return D.nextSibling,W.style.setProperty("font-size","0.875rem"),W.style.setProperty("color","var(--text-muted)"),s(W,()=>k.postedEntries,fe),s(W,()=>t("journal.posted").toLowerCase(),K),s(W,()=>k.draftEntries,D),s(W,()=>t("journal.draft").toLowerCase(),null),s(W,(()=>{var U=me(()=>k.voidEntries>0);return()=>U()&&` • ${k.voidEntries} ${t("entryBooks.void","void").toLowerCase()}`})(),null),W})()]}}),null),s(B,S(Qe,{get title(){return t("journal.totalDebits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var W=yn();return W.style.setProperty("font-size","1.5rem"),W.style.setProperty("font-weight","600"),W.style.setProperty("color","#4caf50"),W.style.setProperty("margin-bottom","0.5rem"),s(W,()=>Z(k.totalDebit)),W})(),(()=>{var W=yn();return W.style.setProperty("font-size","0.875rem"),W.style.setProperty("color","var(--text-muted)"),s(W,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",k.postedEntries.toString())),W})()]}}),null),s(B,S(Qe,{get title(){return t("journal.totalCredits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var W=yn();return W.style.setProperty("font-size","1.5rem"),W.style.setProperty("font-weight","600"),W.style.setProperty("color","#f44336"),W.style.setProperty("margin-bottom","0.5rem"),s(W,()=>Z(k.totalCredit)),W})(),(()=>{var W=yn();return W.style.setProperty("font-size","0.875rem"),W.style.setProperty("color","var(--text-muted)"),s(W,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",k.postedEntries.toString())),W})()]}}),null),s(B,S(Qe,{get title(){return t("banking.unreconciled","Unreconciled")},get subtitle(){return t("banking.title")},get children(){return[(()=>{var W=yn();return W.style.setProperty("font-size","1.5rem"),W.style.setProperty("font-weight","600"),W.style.setProperty("margin-bottom","0.5rem"),s(W,()=>k.unreconciledEntries),ne(fe=>(fe=k.unreconciledEntries>0?"#ff9800":"#4caf50")!=null?W.style.setProperty("color",fe):W.style.removeProperty("color")),W})(),(()=>{var W=yn();return W.style.setProperty("font-size","0.875rem"),W.style.setProperty("color","var(--text-muted)"),s(W,(()=>{var fe=me(()=>k.unreconciledEntries>0);return()=>fe()?t("entryBooks.needBankReconciliation","Need bank reconciliation"):t("entryBooks.allReconciled","All reconciled")})()),W})()]}}),null),B})(),(()=>{var B=ox(),W=B.firstChild,fe=W.firstChild,K=W.nextSibling,he=K.firstChild,D=K.nextSibling,U=D.firstChild,Q=D.nextSibling,J=Q.firstChild,ce=J.nextSibling,oe=Q.nextSibling,O=oe.firstChild,re=O.nextSibling,pe=oe.nextSibling,ve=pe.firstChild,te=pe.nextSibling;return d(B,ie),W.style.setProperty("min-width","150px"),fe.style.setProperty("display","block"),fe.style.setProperty("margin-bottom","0.5rem"),fe.style.setProperty("font-weight","500"),fe.style.setProperty("font-size","0.875rem"),s(fe,()=>t("common.status")),s(W,S(dr,{label:"",get value(){return h()},onChange:f,get options(){return v()}}),null),K.style.setProperty("min-width","200px"),he.style.setProperty("display","block"),he.style.setProperty("margin-bottom","0.5rem"),he.style.setProperty("font-weight","500"),he.style.setProperty("font-size","0.875rem"),s(he,()=>t("journal.account")),s(K,S(dr,{label:"",get value(){return p()},onChange:_,get options(){return P()}}),null),D.style.setProperty("min-width","120px"),U.style.setProperty("display","block"),U.style.setProperty("margin-bottom","0.5rem"),U.style.setProperty("font-weight","500"),U.style.setProperty("font-size","0.875rem"),s(U,()=>t("entryBooks.sortBy","Sort By")),s(D,S(dr,{label:"",get value(){return x()},onChange:q,get options(){return w()}}),null),Q.style.setProperty("min-width","130px"),J.style.setProperty("display","block"),J.style.setProperty("margin-bottom","0.5rem"),J.style.setProperty("font-weight","500"),J.style.setProperty("font-size","0.875rem"),s(J,()=>t("entryBooks.fromDate","From Date")),ce.addEventListener("change",se=>N(se.target.value)),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("border","1px solid var(--border-color)"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),ce.style.setProperty("font-family","inherit"),ce.style.setProperty("width","100%"),oe.style.setProperty("min-width","130px"),O.style.setProperty("display","block"),O.style.setProperty("margin-bottom","0.5rem"),O.style.setProperty("font-weight","500"),O.style.setProperty("font-size","0.875rem"),s(O,()=>t("entryBooks.toDate","To Date")),re.addEventListener("change",se=>T(se.target.value)),re.style.setProperty("padding","0.75rem"),re.style.setProperty("border","1px solid var(--border-color)"),re.style.setProperty("border-radius","var(--border-radius-sm)"),re.style.setProperty("font-family","inherit"),re.style.setProperty("width","100%"),pe.style.setProperty("min-width","100px"),ve.style.setProperty("display","block"),ve.style.setProperty("margin-bottom","0.5rem"),ve.style.setProperty("font-weight","500"),ve.style.setProperty("font-size","0.875rem"),s(ve,()=>t("entryBooks.order","Order")),s(pe,S(dr,{label:"",get value(){return ee()},onChange:Y,get options(){return[{value:"desc",label:t("entryBooks.newest","Newest")},{value:"asc",label:t("entryBooks.oldest","Oldest")}]}}),null),te.style.setProperty("display","flex"),te.style.setProperty("align-items","end"),te.style.setProperty("gap","0.5rem"),s(te,S(De,{variant:"outline",size:"sm",onClick:()=>{f("all"),_("all"),N(""),T(""),q("date"),Y("desc")},get children(){return t("entryBooks.resetFilters","Reset Filters")}})),ne(()=>ce.value=C()),ne(()=>re.value=E()),B})(),me(()=>me(()=>!!(h()!=="all"||p()!=="all"||C()||E()))()&&(()=>{var B=sx(),W=B.firstChild,fe=W.firstChild,K=W.nextSibling,he=K.firstChild;return B.style.setProperty("display","flex"),B.style.setProperty("gap","0.5rem"),B.style.setProperty("align-items","center"),B.style.setProperty("margin-bottom","1rem"),B.style.setProperty("padding","0.75rem"),B.style.setProperty("background","var(--surface-color)"),B.style.setProperty("border-radius","var(--border-radius-sm)"),B.style.setProperty("border","1px solid var(--border-color)"),W.style.setProperty("font-size","0.875rem"),W.style.setProperty("font-weight","500"),s(W,()=>t("entryBooks.activeFilters","Active filters"),fe),s(B,(()=>{var D=me(()=>h()!=="all");return()=>D()&&(()=>{var U=Fs(),Q=U.firstChild;return U.style.setProperty("padding","0.25rem 0.5rem"),U.style.setProperty("background","var(--primary-color)"),U.style.setProperty("color","white"),U.style.setProperty("border-radius","12px"),U.style.setProperty("font-size","0.75rem"),s(U,()=>t("common.status"),Q),s(U,h,null),U})()})(),K),s(B,(()=>{var D=me(()=>p()!=="all");return()=>D()&&(()=>{var U=Fs(),Q=U.firstChild;return U.style.setProperty("padding","0.25rem 0.5rem"),U.style.setProperty("background","var(--primary-color)"),U.style.setProperty("color","white"),U.style.setProperty("border-radius","12px"),U.style.setProperty("font-size","0.75rem"),s(U,()=>t("journal.account"),Q),s(U,()=>ut.getAccountById(p())?.name||t("common.unknown","Unknown"),null),U})()})(),K),s(B,(()=>{var D=me(()=>!!C());return()=>D()&&(()=>{var U=Fs(),Q=U.firstChild;return U.style.setProperty("padding","0.25rem 0.5rem"),U.style.setProperty("background","var(--primary-color)"),U.style.setProperty("color","white"),U.style.setProperty("border-radius","12px"),U.style.setProperty("font-size","0.75rem"),s(U,()=>t("entryBooks.from","From"),Q),s(U,C,null),U})()})(),K),s(B,(()=>{var D=me(()=>!!E());return()=>D()&&(()=>{var U=Fs(),Q=U.firstChild;return U.style.setProperty("padding","0.25rem 0.5rem"),U.style.setProperty("background","var(--primary-color)"),U.style.setProperty("color","white"),U.style.setProperty("border-radius","12px"),U.style.setProperty("font-size","0.75rem"),s(U,()=>t("entryBooks.to","To"),Q),s(U,E,null),U})()})(),K),K.style.setProperty("margin-left","auto"),K.style.setProperty("font-size","0.875rem"),K.style.setProperty("color","var(--text-muted)"),s(K,()=>F.length,he),s(K,()=>t("entryBooks.entriesFound","{count} entries found").replace("{count}",F.length.toString()),null),B})()),me(()=>me(()=>F.length===0)()?S(Qe,{get title(){return t("entryBooks.noJournalEntries","No Journal Entries")},get subtitle(){return t("entryBooks.startByCreating","Start by creating your first entry")},get children(){var B=ax(),W=B.firstChild;return B.style.setProperty("text-align","center"),B.style.setProperty("color","var(--text-muted)"),B.style.setProperty("padding","2rem"),s(B,()=>t("entryBooks.noEntriesMatch","No journal entries match your current filters."),W),s(B,S(De,{variant:"primary",style:{"margin-top":"1rem"},onClick:H,get children(){return t("entryBooks.createFirstEntry","Create First Entry")}}),null),B}}):(()=>{var B=yn();return d(B,b),s(B,S(Mt,{each:F,children:W=>S(NE,{entry:W,onViewDetails:de})})),B})()),S(Uy,{get isOpen(){return e()},onClose:$,get editEntry(){return n()}}),S(rx,{get isOpen(){return o()},onClose:()=>{a(!1),u(null)},get entryId(){return c()}})]}})};var jh=z("<div>"),cx=z("<div>$23,450"),ux=z("<div>$87,230"),dx=z("<div>$5,670"),hx=z("<div><div><div><div>INV-2024-001</div><div>Acme Corporation</div></div><div>$5,250.00</div><div></div></div><div><div><div>INV-2024-002</div><div>Tech Solutions Inc.</div></div><div>$3,750.00</div><div></div></div><div><div><div>INV-2024-003</div><div>Global Services Ltd.</div></div><div>$8,900.00</div><div></div></div><div><div><div>INV-2024-004</div><div>StartUp Co.</div></div><div>$2,100.00</div><div>");const mx=()=>{const{t}=ot(),e={display:"flex","flex-direction":"column",gap:"1rem"},r={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},n={flex:"1"},i={"font-weight":"600","margin-bottom":"0.25rem"},o={color:"var(--text-muted)","font-size":"0.875rem"},a={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},c=h=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:h==="paid"?"#d4edda":h==="pending"?"#fff3cd":"#f8d7da",color:h==="paid"?"#155724":h==="pending"?"#856404":"#721c24"}),u={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"};return S(Fr,{get title(){return t("invoices.title","Invoices")},get children(){return[(()=>{var h=jh();return h.style.setProperty("margin-bottom","2rem"),s(h,S(De,{variant:"primary",get children(){return t("invoices.createNew","Create New Invoice")}})),h})(),(()=>{var h=jh();return d(h,u),s(h,S(Qe,{get title(){return t("invoices.totalOutstanding","Total Outstanding")},get subtitle(){return t("invoices.unpaidInvoices","Unpaid invoices")},get children(){var f=cx();return f.style.setProperty("font-size","1.5rem"),f.style.setProperty("font-weight","600"),f.style.setProperty("color","var(--primary-color)"),f}}),null),s(h,S(Qe,{get title(){return t("invoices.thisMonth","This Month")},get subtitle(){return t("invoices.revenueCollected","Revenue collected")},get children(){var f=ux();return f.style.setProperty("font-size","1.5rem"),f.style.setProperty("font-weight","600"),f.style.setProperty("color","var(--primary-color)"),f}}),null),s(h,S(Qe,{get title(){return t("invoices.overdue","Overdue")},get subtitle(){return t("invoices.pastDueInvoices","Past due invoices")},get children(){var f=dx();return f.style.setProperty("font-size","1.5rem"),f.style.setProperty("font-weight","600"),f.style.setProperty("color","var(--primary-color)"),f}}),null),h})(),S(Qe,{get title(){return t("invoices.recentInvoices","Recent Invoices")},get subtitle(){return t("invoices.latestBillingActivity","Latest billing activity")},get children(){var h=hx(),f=h.firstChild,p=f.firstChild,_=p.firstChild,C=_.nextSibling,N=p.nextSibling,E=N.nextSibling,T=f.nextSibling,x=T.firstChild,q=x.firstChild,ee=q.nextSibling,Y=x.nextSibling,ue=Y.nextSibling,ie=T.nextSibling,I=ie.firstChild,b=I.firstChild,v=b.nextSibling,P=I.nextSibling,w=P.nextSibling,A=ie.nextSibling,y=A.firstChild,de=y.firstChild,H=de.nextSibling,$=y.nextSibling,Z=$.nextSibling;return d(h,e),s(E,()=>t("invoices.paid","Paid")),s(ue,()=>t("invoices.pending","Pending")),s(w,()=>t("invoices.overdue","Overdue")),s(Z,()=>t("invoices.paid","Paid")),ne(k=>{var F=r,B=n,W=i,fe=o,K=a,he=c("paid"),D=r,U=n,Q=i,J=o,ce=a,oe=c("pending"),O=r,re=n,pe=i,ve=o,te=a,se=c("overdue"),R=r,M=n,V=i,ge=o,le=a,j=c("paid");return k.e=d(f,F,k.e),k.t=d(p,B,k.t),k.a=d(_,W,k.a),k.o=d(C,fe,k.o),k.i=d(N,K,k.i),k.n=d(E,he,k.n),k.s=d(T,D,k.s),k.h=d(x,U,k.h),k.r=d(q,Q,k.r),k.d=d(ee,J,k.d),k.l=d(Y,ce,k.l),k.u=d(ue,oe,k.u),k.c=d(ie,O,k.c),k.w=d(I,re,k.w),k.m=d(b,pe,k.m),k.f=d(v,ve,k.f),k.y=d(P,te,k.y),k.g=d(w,se,k.g),k.p=d(A,R,k.p),k.b=d(y,M,k.b),k.T=d(de,V,k.T),k.A=d(H,ge,k.A),k.O=d($,le,k.O),k.I=d(Z,j,k.I),k},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0}),h}})]}})};var fx=z("<div><main>");const yx=t=>[S(hw,{}),me(()=>t.children)],gx=()=>S(WP,{get children(){var t=fx(),e=t.firstChild;return s(e,S(cp,{root:yx,get children(){return[S(Qr,{path:"/",component:kw}),S(Qr,{path:"/accounts",component:()=>S(mn,{permission:"AccountAccess",featureName:"Accounts",get children(){return S(vC,{})}})}),S(Qr,{path:"/accounts/:id",component:()=>S(mn,{permission:"AccountAccess",featureName:"Account Details",get children(){return S(AC,{})}})}),S(Qr,{path:"/entry-books",component:()=>S(mn,{permission:"JournalAccess",featureName:"Entry Books",get children(){return S(lx,{})}})}),S(Qr,{path:"/employees",component:()=>S(mn,{permission:"EmployeeAccess",featureName:"Employee Management",get children(){return S(XI,{})}})}),S(Qr,{path:"/bank-consolidations",component:()=>S(mn,{permission:"BankingAccess",featureName:"Bank Consolidations",get children(){return S(IE,{})}})}),S(Qr,{path:"/balance-sheet",component:()=>S(mn,{permission:"AccountAccess",featureName:"Balance Sheet",get children(){return S(kC,{})}})}),S(Qr,{path:"/invoices",component:()=>S(mn,{permission:"JournalAccess",featureName:"Invoices",get children(){return S(mx,{})}})}),S(Qr,{path:"/inventory",component:()=>S(mn,{permission:"InventoryAccess",featureName:"Inventory Management",get children(){return S(zI,{})}})}),S(Qr,{path:"/products",component:()=>S(mn,{permission:"InventoryAccess",featureName:"Product Management",get children(){return S(By,{})}})})]}})),s(t,(()=>{var r=me(()=>!1);return()=>r()&&S(Cw,{})})(),null),t}}),px=document.getElementById("root");Cg(()=>S(gx,{}),px);
