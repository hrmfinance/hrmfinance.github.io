import{J as At,K as Tt,N as Et,h as Ye,O as jt,P as Ft,Q as ar,R as er,T as Yt,c as H,U as dr,V as cr,u as zt,o as Bt,D as Vt,g as Ot,t as E,i as r,a as f,w as qe,b as te,S as Q,j as L,F as Oe,W as Dt,d as Lt,X as tr,Y as pr,Z as Gt,v as yr,_ as ur,$ as mr,a0 as gr,a1 as fr}from"./index-Bg2EUb5G.js";const Pt={async getAll(e,t){let l={businessId:Ye.getBusinessId(),":search4":Ye.getBusinessId()};return t?.search,e&&e.trim()&&e.split(" ").map((U,m)=>{U&&(l[":search"+m]=U.trim())}),(await Ft({query:"getAutomaticRules",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4 AND createdTimeStamp > :date1 AND createdTimeStamp < :date2 AND account contain :account AND subAccount contain :subAccount AND status = :status",params:l})).data||[]},async getById(e){return At(async()=>{const t=await Et({query:"getEventRules",queryString:"businessId = :businessId AND id = :ruleId",params:{":businessId":Ye.getBusinessId(),":ruleId":e}});return jt(t)[0]||null},()=>Tt.eventRules.getById(e))},async getByEventType(e){return At(async()=>{const t=await Et({query:"getEventRules",queryString:"businessId = :businessId AND eventType = :eventType AND isActive = true",params:{":businessId":Ye.getBusinessId(),":eventType":e}});return jt(t)},()=>Tt.eventRules.getByEventType(e))},async create(e){const t={...e,id:`rule_${ar()}`,businessId:Ye.getBusinessId(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};let n={query:"addAutomaticRule",params:{businessId:Ye.getBusinessId()},form:t};return await Ft(n)},async update(e,t){const l={...t,updatedAt:new Date().toISOString()};let C={query:"updateAutomaticRule",params:{businessId:Ye.getBusinessId(),id:e},form:l};const U=await Ft(C);return console.log(JSON.stringify(C,null,4)),U},async delete(e){return At(async()=>{if((await Et({query:"deleteEventRules",params:{id:e,businessId:Ye.getBusinessId()}}))?.deleteEventRules)return{success:!0,message:"Event rule deleted successfully"};throw new Error("Failed to delete event rule")},()=>Tt.eventRules.delete(e))},async toggleActive(e,t){return this.update(e,{isActive:t})},async testRule(e,t){let n={query:"executeRuleFromConnector",params:{businessId:Ye.getBusinessId()},...t};return await Ft(n)},async getExecutionHistory(e,t=100){return At(async()=>{const l=e?"businessId = :businessId AND ruleId = :ruleId":"businessId = :businessId",n={":businessId":Ye.getBusinessId()};e&&(n[":ruleId"]=e);const C=await Et({query:"getEventRuleHistory",queryString:l,params:n,form:{limit:t}});return jt(C)},()=>Tt.eventRules.getExecutionHistory(e,t))},async bulkToggle(e,t){return At(async()=>(await Et({query:"bulkUpdateEventRules",form:{ruleIds:e,updates:{isActive:t,updatedAt:new Date().toISOString()},businessId:Ye.getBusinessId()}}))?.bulkUpdateEventRules||{success:!1,updated:0,failed:e},()=>Tt.eventRules.bulkToggle(e,t))},async exportRules(){return(await this.getAll()).map(t=>({...t,id:void 0,businessId:void 0}))},async importRules(e){return At(async()=>(await Et({query:"importEventRules",form:{rules:e.map(l=>({...l,businessId:Ye.getBusinessId()})),businessId:Ye.getBusinessId()}}))?.importEventRules||{success:!1,imported:0,failed:e.length,errors:["Import failed"]},()=>Tt.eventRules.importRules(e))}};class vr{rules=new Map;auditLog=[];constructor(){er.on(["invoice_completed","invoice_created","invoice_updated","invoice_cancelled","payment_received","payment_refunded","inventory_received","inventory_sold","inventory_adjusted","expense_created","expense_approved","expense_paid","service_rendered","freight_processed","customs_cleared","bank_transaction_imported"],this.handleEvent.bind(this),{id:"automation_service",priority:50}),this.loadRulesFromApi()}addRule(t){const l={...t,id:`rule_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,createdAt:new Date,updatedAt:new Date};return this.rules.set(l.id,l),l.id}updateRule(t,l){const n=this.rules.get(t);if(!n)return!1;const C={...n,...l,id:t,updatedAt:new Date};return this.rules.set(t,C),!0}removeRule(t){return this.rules.delete(t)}getRules(){return Array.from(this.rules.values())}getRulesForEvent(t){return this.getRules().filter(l=>l.eventType===t&&l.isActive).sort((l,n)=>n.priority-l.priority)}async handleEvent(t){const l=this.getRulesForEvent(t.type);if(l.length===0)return;const n=[],C=[];let U=!0,m;try{for(const q of l)try{if(this.evaluateConditions(q.conditions,t)){const O=await this.createJournalEntry(q,t);n.push(q.name),C.push(O)}}catch(ae){console.error(`Error executing rule ${q.name}:`,ae),m=ae instanceof Error?ae.message:"Unknown error",U=!1}}catch(q){console.error("Error processing event automation:",q),m=q instanceof Error?q.message:"Unknown error",U=!1}this.auditLog.unshift({timestamp:new Date,eventId:t.id,eventType:t.type,rulesTriggered:n,entriesCreated:C,success:U,error:m}),this.auditLog.length>1e3&&(this.auditLog=this.auditLog.slice(0,1e3))}evaluateConditions(t,l){return t.length===0?!0:t.every(n=>{const C=this.getNestedValue(l,n.field);return this.evaluateCondition(C,n)})}evaluateCondition(t,l){const{operator:n,value:C,dataType:U}=l,m=this.convertValue(t,U),q=this.convertValue(C,U);switch(n){case"equals":return m===q;case"notEquals":return m!==q;case"greaterThan":return m>q;case"lessThan":return m<q;case"greaterThanOrEqual":return m>=q;case"lessThanOrEqual":return m<=q;case"contains":return String(m).toLowerCase().includes(String(q).toLowerCase());case"notContains":return!String(m).toLowerCase().includes(String(q).toLowerCase());case"in":return Array.isArray(q)&&q.includes(m);case"notIn":return Array.isArray(q)&&!q.includes(m);case"exists":return t!=null;case"notExists":return t==null;default:return!1}}convertValue(t,l){if(t==null)return t;switch(l){case"number":return Number(t);case"string":return String(t);case"boolean":return!!t;case"date":return new Date(t);case"array":return Array.isArray(t)?t:[t];default:return t}}async createJournalEntry(t,l){const{journalEntryTemplate:n}=t,C=this.processTemplate(n.description,l),U=this.processTemplate(n.reference,l),m=[];for(const K of n.lines){if(K.conditions&&K.conditions.length>0&&!this.evaluateConditions(K.conditions,l))continue;const Z=this.evaluateAmountExpression(K.amountExpression,l);if(Z===0)continue;const ce=this.processTemplate(K.accountExpression,l),oe=K.subAccountExpression?this.processTemplate(K.subAccountExpression,l):void 0,A=this.processTemplate(K.descriptionTemplate,l),V={id:`line_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,accountId:ce,accountName:this.getAccountName(ce),subAccountId:oe,subAccountName:oe?this.getAccountName(oe):void 0,description:A,debitAmount:K.isDebit?Z:0,creditAmount:K.isDebit?0:Z,reference:U};m.push(V)}if(m.length===0)throw new Error("No valid journal entry lines generated");const q=m.reduce((K,Z)=>K+Z.debitAmount,0),ae=m.reduce((K,Z)=>K+Z.creditAmount,0);if(Math.abs(q-ae)>.01)throw new Error(`Journal entry not balanced. Debits: ${q}, Credits: ${ae}`);const O={entryNumber:Yt.getNextEntryNumber(),date:new Date().toISOString().split("T")[0],description:C,reference:U,status:"draft",createdBy:"automation",createdAt:new Date().toISOString(),totalDebit:q,totalCredit:ae,lines:m};return await Yt.addJournalEntry(O)}processTemplate(t,l){return t.replace(/\{([^}]+)\}/g,(n,C)=>{const U=this.getNestedValue(l,C);return String(U||n)})}evaluateAmountExpression(t,l){try{if(!isNaN(Number(t)))return Number(t);const n=this.getNestedValue(l,t);return Number(n)||0}catch(n){return console.error(`Error evaluating amount expression: ${t}`,n),0}}getNestedValue(t,l){return l.split(".").reduce((n,C)=>n?.[C],t)}getAccountName(t){return{1001:"Cash - Operating Account",1002:"Cash - Zelle Account",1003:"Cash - Credit Card Processing",1101:"Accounts Receivable - Customers",1102:"Accounts Receivable - Freight Charges",1201:"Inventory - Products",1202:"Inventory - Packaging Materials",1301:"Prepaid Expenses",1401:"Customs Fees Receivable",1402:"Transit Insurance Receivable",2001:"Accounts Payable",2002:"Freight Payable",2101:"Accrued Salaries",2102:"Accrued Rent",2301:"Sales Tax Payable",2302:"Customs Fees Payable",2303:"Transit Insurance Payable",3001:"Owner's Equity",3101:"Retained Earnings",4001:"Sales Revenue - Products",4101:"Service Revenue - General",4201:"Transport Service Revenue",4202:"Freight Revenue - Air",4203:"Freight Revenue - Sea",4301:"Processing Revenue - Packaging",4302:"Processing Revenue - Storage",5001:"Cost of Goods Sold - Products",5002:"Cost of Goods Sold - Packaging",5101:"Freight Expense - Air",5102:"Freight Expense - Sea",5103:"Local Transport Expense",5201:"Salaries and Wages",5202:"Rent Expense - Office",5203:"Rent Expense - Warehouse",5301:"Utilities Expense",5302:"Insurance Expense",5303:"Office Supplies",5401:"Professional Fees",5402:"Bank Fees",5403:"Credit Card Processing Fees",5501:"Vehicle Expenses",5502:"Equipment Maintenance",5601:"Depreciation Expense"}[t]||`Account ${t}`}getAuditLog(t=100){return this.auditLog.slice(0,t)}clearAuditLog(){this.auditLog=[]}exportRules(){return this.getRules()}importRules(t){this.rules.clear(),t.forEach(l=>{this.rules.set(l.id,l)})}syncRules(t){this.rules.clear(),t.forEach(l=>{this.rules.set(l.id,l)})}async loadRulesFromApi(){try{const t=await Pt.getAll();this.syncRules(t)}catch(t){console.error("Failed to load event rules from API:",t)}}testRule(t,l){const n=t.conditions.map(m=>({condition:m,result:this.evaluateCondition(this.getNestedValue(l,m.field),m)})),C=n.every(m=>m.result),U={wouldTrigger:C,conditionResults:n};if(C)try{const m=this.processTemplate(t.journalEntryTemplate.description,l),q=this.processTemplate(t.journalEntryTemplate.reference,l),ae=t.journalEntryTemplate.lines.map(O=>{const ve=this.evaluateAmountExpression(O.amountExpression,l),K=this.processTemplate(O.accountExpression,l),Z=this.processTemplate(O.descriptionTemplate,l);return{accountId:K,accountName:this.getAccountName(K),description:Z,debitAmount:O.isDebit?ve:0,creditAmount:O.isDebit?0:ve}});U.estimatedJournalEntry={description:m,reference:q,lines:ae}}catch(m){U.errors=[m instanceof Error?m.message:"Unknown error"]}return U}}const Nt=new vr,a=(e,t,l=!1,n)=>({type:e,description:t,required:l,...n}),rr={eventType:"invoice_completed",displayName:"Invoice Completed",description:"Triggered when an invoice is marked as completed",category:"financial",dataStructure:{"data.invoice":a("string","Invoice number",!0,{example:"B47G1D-YY_8635-20250810"}),"data.description":a("string","Invoice description",!1,{example:"Customer order description"}),"data.store":a("string","Store code",!0,{example:"YY_8665"}),"data.guide":a("string","Guide number",!0,{example:"2521"}),"data.createDate":a("date","Invoice creation date",!0,{example:"2025-08-13"}),"data.type":a("string","Invoice type",!0,{example:"SALES"}),"data.isCompleted":a("boolean","Invoice completion status",!0,{example:!0}),"data.shipper_consignee.name":a("string","Full name",!0,{example:"SUCEL NUNEZ JORGE"}),"data.shipper_consignee.firstName":a("string","First name",!1,{example:"YASEL"}),"data.shipper_consignee.middleName":a("string","Middle name",!1,{example:""}),"data.shipper_consignee.lastName":a("string","Last name",!1,{example:"VASQUES JORGE"}),"data.shipper_consignee.lastName2":a("string","Second last name",!1,{example:""}),"data.shipper_consignee.phoneNumber":a("string","Primary phone number",!1,{example:"531101638"}),"data.shipper_consignee.phoneNumberS":a("string","Secondary phone number",!1,{example:""}),"data.shipper_consignee.cid":a("string","Customer ID number",!1,{example:"82072829422"}),"data.shipper_consignee.passport":a("string","Passport number",!1,{example:""}),"data.shipper_consignee.address":a("string","Full address",!1,{example:"Calle undefined"}),"data.products[0].id":a("string","Product line item ID",!1,{example:"1755310725671"}),"data.products[0].product.id":a("string","Product ID",!1,{example:"AjlXorLU63dtPDrm"}),"data.products[0].product.code":a("string","Product code",!1,{example:"K89G06815"}),"data.products[0].product.label":a("string","Product label/name",!1,{example:"SAZON COMPLETO BADIA 7 OZ"}),"data.products[0].product.price":a("number","Product base price",!1,{format:"currency",example:0}),"data.products[0].qty":a("number","Product quantity",!1,{example:4}),"data.products[0].salePrice":a("number","Product sale price",!1,{format:"currency",example:8}),"data.products[0].total":a("number","Product line total",!1,{format:"currency",example:32}),"data.reservas[0].id":a("string","Reserva line item ID",!1,{example:"1755276669614"}),"data.reservas[0].type":a("string","Reserva type",!1,{example:"Ropa"}),"data.reservas[0].qty":a("number","Reserva quantity in lbs",!1,{example:120}),"data.reservas[0].price":a("number","Reserva price per lb",!1,{format:"currency",example:4}),"data.reservas[0].arancel":a("number","Reserva customs fee",!1,{format:"currency",example:0}),"data.reservas[0].total":a("number","Reserva line total",!1,{format:"currency",example:480}),"data.services[0].id":a("string","Service line item ID",!1,{example:"1755395460664"}),"data.services[0].type":a("string","Service type",!1,{example:"ğŸš› TransportaciÃ³n"}),"data.services[0].qty":a("number","Service quantity",!1,{example:3}),"data.services[0].price":a("number","Service base price",!1,{format:"currency",example:0}),"data.services[0].arancel":a("number","Service fee per unit",!1,{format:"currency",example:20}),"data.services[0].total":a("number","Service line total",!1,{format:"currency",example:60}),"data.packagesOrder":a("boolean","Is packages order",!1,{example:!1}),"data.shippingMethod":a("string","Shipping method",!0,{example:"AEREO",options:[{value:"AEREO",label:"Air"},{value:"MARITIMO",label:"Maritime"}]}),"data.paymentMethods.taxOnTotal":a("boolean","Tax applied on total",!1,{example:!1}),"data.paymentMethods.taxPercent":a("number","Tax percentage",!1,{example:7}),"data.paymentMethods.exemptTaxOnCash":a("boolean","Cash payment tax exempt",!1,{example:!0}),"data.paymentMethods.cash":a("number","Cash payment amount",!1,{format:"currency",example:300}),"data.paymentMethods.zelle":a("number","Zelle payment amount",!1,{format:"currency",example:292}),"data.paymentMethods.creditCard":a("number","Credit card payment amount",!1,{format:"currency",example:0}),"data.businessId":a("string","Business ID",!0,{example:"YB100423253156428"}),"data.ssg_inventory_key":a("string","Inventory system key",!1,{example:"INVOICE-1755395719878"}),"data.ssg_sorder_key":a("string","Sales order key",!1,{example:"SO-1755395719878"}),"data.referenceHId":a("string","Reference hash ID",!1,{example:"xxhdlfvvmgvsn87q_1755395721386"}),"data.productSubtotal":a("number","Products subtotal",!0,{format:"currency",example:32}),"data.reservaSubtotal":a("number","Reservas subtotal",!0,{format:"currency",example:480}),"data.serviceSubtotal":a("number","Services subtotal",!0,{format:"currency",example:60}),"data.transportTotal":a("number","Transporte subtotal",!0,{format:"currency",example:20}),"data.subtotalBeforeTax":a("number","Subtotal before tax",!0,{format:"currency",example:572}),"data.taxAmount":a("number","Total tax amount",!0,{format:"currency",example:19.75}),"data.taxSavings":a("number","Tax savings amount",!1,{format:"currency",example:20.29}),"data.total":a("number","Final total amount",!0,{format:"currency",example:591.75}),"data.taxCalculationMethod":a("string","Tax calculation method",!1,{example:"subtotal"}),"data.cashPaymentRatio":a("number","Cash payment ratio",!1,{example:.51})},examples:[{name:"Cash Sale Invoice",description:"Invoice paid entirely in cash",sampleData:{invoice:"INV-2024-001",customerId:"CUST-001",customerName:"ABC Corporation",totalAmount:1500,subtotalAmount:1300,taxAmount:200,paymentMethods:{cash:1500,zelle:0,creditCard:0,check:0,bankTransfer:0},currency:"USD",status:"completed"}},{name:"Mixed Payment Invoice",description:"Invoice with cash and Zelle payments",sampleData:{invoice:"INV-2024-002",customerId:"CUST-002",customerName:"XYZ Inc",totalAmount:2e3,subtotalAmount:1800,taxAmount:200,paymentMethods:{cash:1200,zelle:800,creditCard:0,check:0,bankTransfer:0},currency:"USD",status:"completed"}}]},br={eventType:"payment_received",displayName:"Payment Received",description:"Triggered when a payment is received from a customer",category:"financial",dataStructure:{"data.paymentId":a("string","Payment ID",!0,{example:"PAY-2024-001"}),"data.invoiceId":a("string","Related invoice ID",!1,{example:"INV-2024-001"}),"data.customerId":a("string","Customer ID",!0),"data.customerName":a("string","Customer name",!0,{example:"ABC Corporation"}),"data.amount":a("number","Payment amount",!0,{format:"currency",example:1500}),"data.paymentMethod":a("string","Payment method",!0,{options:[{value:"cash",label:"Cash"},{value:"zelle",label:"Zelle"},{value:"creditCard",label:"Credit Card"},{value:"check",label:"Check"},{value:"bankTransfer",label:"Bank Transfer"}],example:"cash"}),"data.currency":a("string","Currency code",!0,{example:"USD"}),"data.exchangeRate":a("number","Exchange rate",!1,{example:1}),"data.reference":a("string","Payment reference",!0,{example:"REF-001"}),"data.bankAccount":a("string","Bank account used",!1,{example:"BOA-Checking-001"}),"data.depositDate":a("date","Date payment was deposited",!1,{format:"date",example:"2024-01-15"})},examples:[{name:"Cash Payment",description:"Cash payment for an invoice",sampleData:{paymentId:"PAY-2024-001",invoiceId:"INV-2024-001",customerId:"CUST-001",customerName:"ABC Corporation",amount:1500,paymentMethod:"cash",currency:"USD",reference:"CASH-001"}}]},Zt={eventType:"inventory_received",displayName:"Inventory Received",description:"Triggered when inventory is received from suppliers",category:"inventory",dataStructure:{"data.movementId":a("string","Movement ID",!0,{example:"MOV-2024-001"}),"data.productId":a("string","Product ID",!0,{example:"PROD-001"}),"data.productName":a("string","Product name",!0,{example:"Widget A"}),"data.sku":a("string","Product SKU",!0,{example:"WID-A-001"}),"data.category":a("string","Product category",!0,{example:"Electronics"}),"data.quantity":a("number","Quantity received",!0,{example:100}),"data.unitCost":a("number","Cost per unit",!0,{format:"currency",example:25}),"data.totalCost":a("number","Total cost",!0,{format:"currency",example:2500}),"data.supplierId":a("string","Supplier ID",!1,{example:"SUPP-001"}),"data.supplierName":a("string","Supplier name",!1,{example:"Acme Supplies"}),"data.purchaseOrderId":a("string","Purchase order ID",!1,{example:"PO-2024-001"}),"data.warehouseLocation":a("string","Warehouse location",!0,{example:"WH-A-001"}),"data.movementType":a("string","Type of movement",!0,{options:[{value:"purchase",label:"Purchase"},{value:"sale",label:"Sale"},{value:"adjustment",label:"Adjustment"},{value:"transfer",label:"Transfer"}],example:"purchase"})},examples:[{name:"Product Purchase",description:"Products received from supplier",sampleData:{movementId:"MOV-2024-001",productId:"PROD-001",productName:"Widget A",sku:"WID-A-001",category:"Electronics",quantity:100,unitCost:25,totalCost:2500,supplierId:"SUPP-001",supplierName:"Acme Supplies",movementType:"purchase"}}]},Ht={eventType:"expense_created",displayName:"Expense Created",description:"Triggered when a new expense is created",category:"financial",dataStructure:{"data.expenseId":a("string","Expense ID",!0,{example:"EXP-2024-001"}),"data.category":a("string","Expense category",!0,{options:[{value:"office_supplies",label:"Office Supplies"},{value:"travel",label:"Travel"},{value:"utilities",label:"Utilities"},{value:"rent",label:"Rent"},{value:"equipment",label:"Equipment"},{value:"marketing",label:"Marketing"},{value:"professional_services",label:"Professional Services"}],example:"office_supplies"}),"data.subcategory":a("string","Expense subcategory",!1,{example:"Stationery"}),"data.description":a("string","Expense description",!0,{example:"Office supplies from Staples"}),"data.amount":a("number","Expense amount",!0,{format:"currency",example:250}),"data.currency":a("string","Currency code",!0,{example:"USD"}),"data.vendorId":a("string","Vendor ID",!1,{example:"VEND-001"}),"data.vendorName":a("string","Vendor name",!1,{example:"Staples Inc"}),"data.employeeId":a("string","Employee ID",!1,{example:"EMP-001"}),"data.employeeName":a("string","Employee name",!1,{example:"John Doe"}),"data.departmentId":a("string","Department ID",!1,{example:"DEPT-001"}),"data.departmentName":a("string","Department name",!1,{example:"Administration"}),"data.paymentMethod":a("string","Payment method",!0,{options:[{value:"cash",label:"Cash"},{value:"check",label:"Check"},{value:"creditCard",label:"Credit Card"},{value:"bankTransfer",label:"Bank Transfer"}],example:"creditCard"}),"data.reference":a("string","Reference number",!0,{example:"REF-001"}),"data.receiptAttached":a("boolean","Receipt attached",!1,{example:!0})},examples:[{name:"Office Supplies Expense",description:"Office supplies purchased with credit card",sampleData:{expenseId:"EXP-2024-001",category:"office_supplies",description:"Office supplies from Staples",amount:250,currency:"USD",vendorName:"Staples Inc",paymentMethod:"creditCard",reference:"CC-001",receiptAttached:!0}}]},hr={eventType:"service_rendered",displayName:"Service Rendered",description:"Triggered when a service is completed for a customer",category:"operational",dataStructure:{"data.serviceId":a("string","Service ID",!0,{example:"SRV-2024-001"}),"data.serviceType":a("string","Type of service",!0,{options:[{value:"transport",label:"Transportation"},{value:"packaging",label:"Packaging"},{value:"storage",label:"Storage"},{value:"customs",label:"Customs Clearance"},{value:"processing",label:"Processing"},{value:"other",label:"Other"}],example:"transport"}),"data.description":a("string","Service description",!0,{example:"Transportation from Miami to NYC"}),"data.customerId":a("string","Customer ID",!0,{example:"CUST-001"}),"data.customerName":a("string","Customer name",!0,{example:"ABC Corporation"}),"data.amount":a("number","Service amount",!0,{format:"currency",example:500}),"data.currency":a("string","Currency code",!0,{example:"USD"}),"data.quantity":a("number","Service quantity",!1,{example:1}),"data.unitPrice":a("number","Price per unit",!1,{format:"currency",example:500}),"data.invoiceId":a("string","Related invoice ID",!1,{example:"INV-2024-001"}),"data.reference":a("string","Service reference",!0,{example:"TRANS-001"}),"data.serviceDate":a("date","Date service was performed",!0,{format:"date",example:"2024-01-15"}),"data.location":a("string","Service location",!1,{example:"Miami, FL"}),"data.weight":a("number","Weight (if applicable)",!1,{example:150.5}),"data.trackingNumber":a("string","Tracking number",!1,{example:"TRK-123456"})},examples:[{name:"Transportation Service",description:"Freight transportation service",sampleData:{serviceId:"SRV-2024-001",serviceType:"transport",description:"Transportation from Miami to NYC",customerId:"CUST-001",customerName:"ABC Corporation",amount:500,currency:"USD",reference:"TRANS-001",serviceDate:"2024-01-15",weight:150.5}}]},Pr={...rr,eventType:"invoice_created",displayName:"Invoice Created",description:"Triggered when a new invoice is created"},xr={invoice_completed:rr,invoice_created:Pr,payment_received:br,inventory_received:Zt,inventory_sold:Zt,expense_created:Ht,expense_approved:Ht,service_rendered:hr},sr=e=>xr[e]||null,or=e=>{const t=sr(e);return t?Object.entries(t.dataStructure).map(([l,n])=>({path:l,definition:n})):[]},$r=["inventory_received","inventory_sold","inventory_adjusted"],_r=["expense_created","expense_approved","expense_paid"],Sr=["service_rendered","freight_processed","customs_cleared"],wr=["payment_received","payment_refunded"],Cr=e=>e==null?"string":Array.isArray(e)?"array":typeof e=="object"?"object":typeof e=="boolean"?"boolean":typeof e=="number"?"number":typeof e=="string"&&(/^\d{4}-\d{2}-\d{2}/.test(e)||!isNaN(Date.parse(e)))?"date":"string",Ar=(e,t,l="invoice")=>{const n=e.split(".").pop()||e,C={id:"Unique identifier",businessId:"Business identifier",userId:"User identifier",createDate:"Creation timestamp",createdDate:"Creation timestamp",updatedDate:"Last update timestamp",description:"Description",notes:"Additional notes",reference:"Reference number",category:"Category classification",total:"Total amount",name:"Name"};return(l==="inventory"?{...C,...{referenceNumber:"Movement reference number",document:"Document/reference number",movementType:"Movement type (in/out/adjustment/transfer)",type:"Movement type filter",locationId:"Warehouse/location identifier",fromLocationId:"Source location (for transfers)",store:"Store/location identifier",items:"List of items in movement",products:"List of products in movement",generalNotes:"General notes for movement",invoice:"Related invoice reference",entityId:"Provider/Customer identifier",entityName:"Provider/Customer name",entityType:"Entity type (provider/customer)",createdBy:"User who created the movement",productId:"Product identifier",productName:"Product name",productCode:"Product code/SKU",sku:"Stock keeping unit",quantity:"Quantity moved",qty:"Quantity",unitCost:"Cost per unit",totalCost:"Total cost of movement",unitPrice:"Price per unit",totalPrice:"Total price",price:"Price",cost:"Cost",batchNumber:"Batch/lot number",expirationDate:"Expiration date",serialNumber:"Serial number",reason:"Movement reason",adjustmentReason:"Reason for adjustment"}}:{...C,...{invoice:"Invoice number/identifier",type:"Invoice type (SALES, INTERNATIONAL_SHIPPING)",store:"Store identifier",isCompleted:"Whether invoice is completed",subtotal:"Subtotal before tax",taxAmount:"Tax amount",taxPercent:"Tax percentage",cash:"Cash payment amount",zelle:"Zelle payment amount",creditCard:"Credit card payment amount",qty:"Quantity",price:"Unit price",salePrice:"Sale price",weight:"Weight in pounds",arancel:"Tariff/duty amount",firstName:"First name",lastName:"Last name",email:"Email address",phoneNumber:"Phone number",address:"Address",shippingMethod:"Shipping method (aereo/maritimo)",packagesOrder:"Package order flag",code:"Product code",label:"Display label"}})[n]||`${n} (${t})`},qt=(e,t="data",l,n=0,C=!0)=>{if(!(n>10||!e||typeof e!="object"))for(const[U,m]of Object.entries(e)){const q=`${t}.${U}`,ae=Cr(m);l.has(q)||l.set(q,{type:ae,examples:[],count:0});const O=l.get(q);if(O.count++,O.examples.length<5&&m!==null&&m!==void 0){const ve=ae==="object"||ae==="array"?JSON.stringify(m).slice(0,100)+(JSON.stringify(m).length>100?"...":""):m;O.examples.includes(ve)||O.examples.push(ve)}ae==="object"&&m&&qt(m,q,l,n+1,C),ae==="array"&&Array.isArray(m)&&m.length>0&&(l.has(`${q}[0]`)||l.set(`${q}[0]`,{type:"object",examples:[],count:0}),l.get(`${q}[0]`).count++,(C?m:m.slice(0,5)).forEach(K=>{K&&typeof K=="object"&&qt(K,`${q}[0]`,l,n+1,C)}))}},Tr=e=>{const t=[{name:"Basic Info",icon:"ğŸ“‹",fields:[]},{name:"Customer",icon:"ğŸ‘¤",fields:[]},{name:"Products",icon:"ğŸ“¦",fields:[]},{name:"Reservas",icon:"ğŸ·ï¸",fields:[]},{name:"Services",icon:"ğŸ”§",fields:[]},{name:"Payments",icon:"ğŸ’³",fields:[]},{name:"Shipping",icon:"ğŸšš",fields:[]},{name:"Amounts",icon:"ğŸ’°",fields:[]},{name:"System",icon:"âš™ï¸",fields:[]}];return e.forEach(l=>{const n=l.path.toLowerCase();n.includes("shipper_consignee")||n.includes("customer")?t[1].fields.push(l):n.includes("products")?t[2].fields.push(l):n.includes("reservas")?t[3].fields.push(l):n.includes("services")?t[4].fields.push(l):n.includes("payment")||n.includes("cash")||n.includes("zelle")||n.includes("credit")?t[5].fields.push(l):n.includes("shipping")||n.includes("bulk")||n.includes("transport")?t[6].fields.push(l):n.includes("total")||n.includes("subtotal")||n.includes("amount")||n.includes("price")||n.includes("tax")?t[7].fields.push(l):n.includes("id")||n.includes("key")||n.includes("business")||n.includes("user")?t[8].fields.push(l):t[0].fields.push(l)}),t.filter(l=>l.fields.length>0)},Er=e=>{const t=[{name:"Movement Info",icon:"ğŸ“‹",fields:[]},{name:"Items/Products",icon:"ğŸ“¦",fields:[]},{name:"Location",icon:"ğŸ“",fields:[]},{name:"Entity",icon:"ğŸ‘¤",fields:[]},{name:"Amounts",icon:"ğŸ’°",fields:[]},{name:"Reference",icon:"ğŸ”—",fields:[]},{name:"Notes",icon:"ğŸ“",fields:[]},{name:"System",icon:"âš™ï¸",fields:[]}];return e.forEach(l=>{const n=l.path.toLowerCase();n.includes("items")||n.includes("products")||n.includes("product")||n.includes("sku")?t[1].fields.push(l):n.includes("location")||n.includes("store")||n.includes("warehouse")||n.includes("fromlocation")?t[2].fields.push(l):n.includes("entity")||n.includes("provider")||n.includes("customer")||n.includes("supplier")?t[3].fields.push(l):n.includes("cost")||n.includes("price")||n.includes("total")||n.includes("quantity")||n.includes("qty")||n.includes("amount")?t[4].fields.push(l):n.includes("reference")||n.includes("document")||n.includes("invoice")||n.includes("batch")||n.includes("serial")?t[5].fields.push(l):n.includes("note")||n.includes("description")||n.includes("reason")?t[6].fields.push(l):n.includes("id")||n.includes("business")||n.includes("user")||n.includes("date")||n.includes("created")||n.includes("type")?t[7].fields.push(l):t[0].fields.push(l)}),t.filter(l=>l.fields.length>0)},Dr=(e,t="invoice")=>t==="inventory"?Er(e):Tr(e),kr=e=>e?$r.includes(e)?"inventory":_r.includes(e)?"expense":Sr.includes(e)?"service":wr.includes(e)?"payment":"invoice":"invoice",Ir=()=>{const[e,t]=H(!1),[l,n]=H(0),[C,U]=H(null),[m,q]=H(null),[ae,O]=H(void 0);return{extractFields:async(Z,ce)=>{t(!0),n(0),U(null),O(ce);const oe=kr(ce);try{n(5);const A=Ye.getBusinessId();let V=[];if(oe==="inventory"?(console.log("[FieldExtractor] Fetching ALL inventory movements for event type:",ce),V=await dr.getAll()||[],console.log("[FieldExtractor] Found",V.length,"inventory movements")):(console.log("[FieldExtractor] Fetching ALL invoices for event type:",ce),V=await cr.getInvoice(A)||[],console.log("[FieldExtractor] Found",V.length,"invoices")),!V||!Array.isArray(V)||V.length===0)throw new Error(oe==="inventory"?"No inventory movements found":"No invoices found");const me=Z?V.slice(0,Z):V,ne=me.length;console.log(`[FieldExtractor] Processing ${ne} records to build complete schema...`),n(10);const we=new Map;me.forEach((D,W)=>{qt(D,"data",we,0,!0);const $e=10+Math.floor(W/ne*70);W%Math.max(1,Math.floor(ne/20))===0&&n($e)}),console.log(`[FieldExtractor] Extracted ${we.size} unique fields from ${ne} records`),n(85);const Ce=Array.from(we.entries()).map(([D,W])=>({path:D,type:W.type,description:Ar(D,W.type,oe),example:W.examples[0]||null,occurrences:W.count,totalInvoices:ne,coverage:Math.round(W.count/ne*100),isNested:D.split(".").length>2,parentPath:D.split(".").slice(0,-1).join(".")||void 0}));Ce.sort((D,W)=>W.coverage!==D.coverage?W.coverage-D.coverage:D.path.localeCompare(W.path)),n(95);const Fe=Dr(Ce,oe),De={fields:Ce,categories:Fe,totalInvoices:ne,extractedAt:new Date,sampleInvoices:me.slice(0,3)};return q(De),n(100),De}catch(A){const V=A instanceof Error?A.message:"Failed to extract fields";throw U(V),A}finally{t(!1)}},isExtracting:e,progress:l,error:C,schema:m,getDraggableFields:()=>{const Z=m();return Z?Z.fields.map(ce=>({...ce,draggable:!0,categoryIcon:Z.categories.find(oe=>oe.fields.includes(ce))?.icon||"ğŸ“„"})):[]}}};var Lr=E("<div><div><div><div></div></div></div><p>"),Rr=E("<div><p>Error: </p><button>Reintentar"),Fr=E("<div>No hay lÃ­neas. Crea una abajo."),Nr=E("<button>â• Crear (con condiciÃ³n >0)"),zr=E("<button>âš™ï¸ Crear: "),jr=E("<div><div>âœ… Mapeos (<!>)"),Mr=E('<div><div><h4><span>(<!> campos)</span></h4><input type=text placeholder="Buscar campos..."><div><button>Todos</button></div><div></div></div><div><h4>ğŸ¯ Arrastra campos aquÃ­</h4><div><div><div>ğŸ“‹ LÃ­neas de Asiento (<!>)</div></div><div><div>â• Nueva LÃ­nea</div><div><div><div>ğŸ’° Monto*</div><div></div></div><div><div>ğŸ“ Desc</div><div></div></div></div></div><div><div>âš™ï¸ Campo Personalizado</div><input type=text placeholder="Nombre (auto desde campo)"><div></div></div><div><div>ğŸ“‹ Campos Generales</div><div><div><span>ğŸ” </span></div></div><div><div><span>ğŸ“ </span></div><div><span>ğŸ”— '),Or=E("<div>"),qr=E("<button> "),Br=E("<div><span></span><div><div></div></div><span>%"),Vr=E("<div><div><span></span><span>L</span></div><div><div>ğŸ’° </div><div>ğŸ“ "),Ur=E("<span>Arrastra campos (se suman con +)"),Wr=E("<div><span><strong></strong> â†’ <span></span></span><button>âœ•");const Jr=e=>{zt();const{extractFields:t,isExtracting:l,progress:n,error:C,schema:U}=Ir(),[m,q]=H(""),[ae,O]=H(null),[ve,K]=H(null),[Z,ce]=H(null),[oe,A]=H([]),[V,me]=H(!1),[ne,we]=H(""),[Ce,Fe]=H(""),[De,D]=H(""),[W,$e]=H(""),[tt,be]=H(""),[Ee,He]=H(void 0);Bt(()=>{console.log("[VisualRuleMapper] onMount - loading ALL fields for eventType:",e.eventType),t(void 0,e.eventType),He(e.eventType)}),Vt(()=>{const d=e.eventType,i=Ee();i!==void 0&&d!==i&&(console.log("[VisualRuleMapper] eventType changed from",i,"to",d),t(void 0,d),He(d))});const ke=Ot(()=>{const d=U();if(!d)return[];let i=d.fields;if(m()){const _=m().toLowerCase();i=i.filter(j=>j.path.toLowerCase().includes(_)||j.description.toLowerCase().includes(_))}if(ae()){const _=d.categories.find(j=>j.name===ae());_&&(i=_.fields)}return V()&&(i=i.filter(_=>_.coverage>=50)),i}),Ie=(d,i)=>{K(d),i.dataTransfer.effectAllowed="copy",i.dataTransfer.setData("text/plain",d.path),i.dataTransfer.setData("application/json",JSON.stringify(d)),i.target.style.opacity="0.5"},Ne=d=>{K(null),d.target.style.opacity="1"},k=(d,i)=>{i.preventDefault(),i.dataTransfer.dropEffect="copy",ce(d)},P=()=>{ce(null)},I=d=>{d.preventDefault(),ce(null);const i=d.dataTransfer.getData("text/plain");i&&(e.onAddCondition?.(i),e.onFieldSelect(i,"condition"),Y(i,"condition"))},le=(d,i)=>{i.preventDefault(),ce(null);const _=i.dataTransfer.getData("text/plain");_&&(e.onSetLineAmount?.(_,d),e.onFieldSelect(_,"amount",d),Y(_,"lineAmount",d))},J=(d,i)=>{i.preventDefault(),ce(null);const _=i.dataTransfer.getData("text/plain");_&&(e.onSetLineDescription?.(_,d),e.onFieldSelect(_,"lineDescription",d),Y(_,"lineDescription",d))},pe=d=>{d.preventDefault(),ce(null);const i=d.dataTransfer.getData("text/plain");i&&we(i)},ge=d=>{d.preventDefault(),ce(null);const i=d.dataTransfer.getData("text/plain");i&&Fe(i)},ue=d=>{d.preventDefault(),ce(null);const i=d.dataTransfer.getData("text/plain");i&&(e.onSetReference?.(i),e.onFieldSelect(i,"reference"),Y(i,"reference"))},g=d=>{d.preventDefault(),ce(null);const i=d.dataTransfer.getData("text/plain");i&&(e.onSetDescription?.(i),e.onFieldSelect(i,"description"),Y(i,"description"))},x=()=>{if(ne()){const d={field:ne(),operator:"greaterThan",value:0,dataType:"number"};e.onCreateNewLine?.(ne(),Ce()||void 0,[d]),we(""),Fe("")}},h=()=>{De()&&W()&&(e.onCreateCustomField?.(De(),W(),tt()||void 0),D(""),$e(""),be(""))},T=d=>{d.preventDefault(),ce(null);const i=d.dataTransfer.getData("text/plain");if(i){const _=W();if(!_){const j=i.split(".").pop()||i;De()||D(j)}$e(_?`${_} + ${i}`:i)}},Y=(d,i,_)=>{const j=ve();j&&(A(ye=>[...ye,{sourceField:j,targetType:i,targetIndex:_}]),e.onMappingsChange?.(oe()))},de=d=>{A(i=>i.filter((_,j)=>j!==d)),e.onMappingsChange?.(oe())},G={display:"grid","grid-template-columns":"1fr 1.2fr",gap:"1rem",padding:"1rem","background-color":"#f9fafb","min-height":"500px"},fe={"background-color":"white","border-radius":"0.5rem",padding:".71rem","box-shadow":"0 1px 3px rgba(0,0,0,0.1)","overflow-y":"auto","max-height":"540px"},c=d=>({display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 0.75rem","background-color":d?"#e0f2fe":"white",border:"1px solid #e5e7eb","border-radius":"0.375rem",cursor:"grab","font-size":"0.8rem","margin-bottom":"0.375rem",transition:"all 0.2s",opacity:d?.5:1}),w={string:{bg:"#fef3c7",text:"#92400e"},number:{bg:"#dbeafe",text:"#1e40af"},boolean:{bg:"#dcfce7",text:"#166534"},date:{bg:"#f3e8ff",text:"#7c3aed"},array:{bg:"#fee2e2",text:"#991b1b"},object:{bg:"#e0e7ff",text:"#3730a3"}},z=(d,i="#3b82f6")=>({padding:"0.75rem",border:Z()===d?`2px dashed ${i}`:"2px dashed #d1d5db","border-radius":"0.5rem","background-color":Z()===d?`${i}10`:"#fafafa","min-height":"60px",display:"flex","flex-direction":"column","align-items":"center","justify-content":"center","text-align":"center",transition:"all 0.2s",cursor:"pointer"}),R=d=>({padding:"0.25rem 0.5rem","background-color":d?"#3b82f6":"transparent",color:d?"white":"#6b7280",border:"none","border-radius":"0.25rem",cursor:"pointer","font-size":"0.7rem","font-weight":"500","white-space":"nowrap"});return(()=>{var d=Or();return r(d,f(Q,{get when(){return l()},get children(){var i=Lr(),_=i.firstChild,j=_.firstChild,ye=j.firstChild,rt=_.nextSibling;return i.style.setProperty("text-align","center"),i.style.setProperty("padding","2rem"),_.style.setProperty("margin-bottom","1rem"),j.style.setProperty("width","100%"),j.style.setProperty("height","8px"),j.style.setProperty("background-color","#e5e7eb"),j.style.setProperty("border-radius","4px"),j.style.setProperty("overflow","hidden"),ye.style.setProperty("height","100%"),ye.style.setProperty("background-color","#3b82f6"),ye.style.setProperty("transition","width 0.3s"),rt.style.setProperty("color","#6b7280"),rt.style.setProperty("font-size","0.875rem"),r(rt,(()=>{var Be=qe(()=>!!e.eventType?.includes("inventory"));return()=>Be()?`Analizando movimientos de inventario... ${n()}%`:`Analizando facturas... ${n()}%`})()),te(Be=>(Be=`${n()}%`)!=null?ye.style.setProperty("width",Be):ye.style.removeProperty("width")),i}}),null),r(d,f(Q,{get when(){return C()},get children(){var i=Rr(),_=i.firstChild;_.firstChild;var j=_.nextSibling;return i.style.setProperty("text-align","center"),i.style.setProperty("padding","2rem"),i.style.setProperty("color","#dc2626"),r(_,C,null),j.$$click=()=>t(void 0,e.eventType),j.style.setProperty("margin-top","1rem"),j.style.setProperty("padding","0.5rem 1rem"),j.style.setProperty("background-color","#3b82f6"),j.style.setProperty("color","white"),j.style.setProperty("border","none"),j.style.setProperty("border-radius","0.375rem"),j.style.setProperty("cursor","pointer"),i}}),null),r(d,f(Q,{get when(){return qe(()=>!l())()&&U()},get children(){var i=Mr(),_=i.firstChild,j=_.firstChild,ye=j.firstChild,rt=ye.firstChild,Be=rt.nextSibling;Be.nextSibling;var se=j.nextSibling,_e=se.nextSibling,Le=_e.firstChild,Ue=_e.nextSibling,Ge=_.nextSibling,gt=Ge.firstChild,st=gt.nextSibling,ze=st.firstChild,ft=ze.firstChild,xt=ft.firstChild,Rt=xt.nextSibling;Rt.nextSibling;var Qe=ze.nextSibling,St=Qe.firstChild,lt=St.nextSibling,Ve=lt.firstChild,vt=Ve.firstChild,at=vt.nextSibling,je=Ve.nextSibling,$t=je.firstChild,dt=$t.nextSibling,We=Qe.nextSibling,ct=We.firstChild,Ke=ct.nextSibling,Re=Ke.nextSibling,Ze=We.nextSibling,pt=Ze.firstChild,_t=pt.nextSibling,it=_t.firstChild,ot=it.firstChild;ot.firstChild;var wt=_t.nextSibling,yt=wt.firstChild,bt=yt.firstChild;bt.firstChild;var ht=yt.nextSibling,o=ht.firstChild;return o.firstChild,L(i,G),j.style.setProperty("font-size","0.9rem"),j.style.setProperty("font-weight","600"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("display","flex"),j.style.setProperty("align-items","center"),j.style.setProperty("gap","0.5rem"),r(j,()=>e.eventType?.includes("inventory")?"ğŸ“¦ Campos de Movimiento":"ğŸ“Š Campos Disponibles",ye),ye.style.setProperty("font-size","0.7rem"),ye.style.setProperty("color","#6b7280"),ye.style.setProperty("font-weight","normal"),r(ye,()=>U()?.fields.length,Be),se.$$input=s=>q(s.currentTarget.value),se.style.setProperty("width","100%"),se.style.setProperty("padding","0.375rem 0.5rem"),se.style.setProperty("border","1px solid #d1d5db"),se.style.setProperty("border-radius","0.375rem"),se.style.setProperty("font-size","0.75rem"),se.style.setProperty("margin-bottom","0.5rem"),_e.style.setProperty("display","flex"),_e.style.setProperty("gap","0.25rem"),_e.style.setProperty("flex-wrap","wrap"),_e.style.setProperty("margin-bottom","0.5rem"),Le.$$click=()=>O(null),r(_e,f(Oe,{get each(){return U()?.categories},children:s=>(()=>{var p=qr(),y=p.firstChild;return p.$$click=()=>O(s.name),r(p,()=>s.icon,y),r(p,()=>s.name,null),te(F=>L(p,R(ae()===s.name),F)),p})()}),null),Ue.style.setProperty("max-height","400px"),Ue.style.setProperty("overflow-y","auto"),r(Ue,f(Oe,{get each(){return ke()},children:s=>(()=>{var p=Br(),y=p.firstChild,F=y.nextSibling,b=F.firstChild,B=F.nextSibling,N=B.firstChild;return p.addEventListener("dragend",Ne),p.addEventListener("dragstart",v=>Ie(s,v)),Dt(p,"draggable",!0),y.style.setProperty("padding","0.125rem 0.25rem"),y.style.setProperty("border-radius","0.25rem"),y.style.setProperty("font-size","0.55rem"),y.style.setProperty("font-weight","600"),y.style.setProperty("text-transform","uppercase"),r(y,()=>s.type),F.style.setProperty("flex","1"),F.style.setProperty("min-width","0"),b.style.setProperty("font-weight","500"),b.style.setProperty("font-size","0.75rem"),b.style.setProperty("overflow","hidden"),b.style.setProperty("text-overflow","ellipsis"),b.style.setProperty("white-space","nowrap"),r(b,()=>s.path.replace("data.","")),B.style.setProperty("font-size","0.6rem"),B.style.setProperty("font-weight","500"),r(B,()=>s.coverage,N),te(v=>{var S=c(ve()?.path===s.path),$=w[s.type]?.bg||"#f3f4f6",re=w[s.type]?.text||"#374151",ee=s.coverage>=80?"#059669":s.coverage>=50?"#d97706":"#9ca3af";return v.e=L(p,S,v.e),$!==v.t&&((v.t=$)!=null?y.style.setProperty("background-color",$):y.style.removeProperty("background-color")),re!==v.a&&((v.a=re)!=null?y.style.setProperty("color",re):y.style.removeProperty("color")),ee!==v.o&&((v.o=ee)!=null?B.style.setProperty("color",ee):B.style.removeProperty("color")),v},{e:void 0,t:void 0,a:void 0,o:void 0}),p})()})),gt.style.setProperty("font-size","0.9rem"),gt.style.setProperty("font-weight","600"),gt.style.setProperty("margin-bottom","0.5rem"),gt.style.setProperty("padding","0 0.25rem"),st.style.setProperty("flex","1"),st.style.setProperty("overflow-y","auto"),st.style.setProperty("padding-right","0.25rem"),st.style.setProperty("max-height","540px"),ze.style.setProperty("background-color","#f0fdf4"),ze.style.setProperty("border-radius","0.375rem"),ze.style.setProperty("padding","0.5rem"),ze.style.setProperty("margin-bottom","0.75rem"),ze.style.setProperty("border","1px solid #bbf7d0"),ze.style.setProperty("max-height","200px"),ze.style.setProperty("overflow-y","auto"),ft.style.setProperty("font-size","0.7rem"),ft.style.setProperty("font-weight","600"),ft.style.setProperty("margin-bottom","0.5rem"),ft.style.setProperty("color","#166534"),r(ft,()=>e.journalLines?.length||0,Rt),r(ze,f(Q,{get when(){return!e.journalLines||e.journalLines.length===0},get children(){var s=Fr();return s.style.setProperty("font-size","0.65rem"),s.style.setProperty("color","#6b7280"),s.style.setProperty("font-style","italic"),s.style.setProperty("text-align","center"),s.style.setProperty("padding","0.5rem"),s}}),null),r(ze,f(Oe,{get each(){return e.journalLines},children:(s,p)=>(()=>{var y=Vr(),F=y.firstChild,b=F.firstChild,B=b.nextSibling;B.firstChild;var N=F.nextSibling,v=N.firstChild;v.firstChild;var S=v.nextSibling;return S.firstChild,y.style.setProperty("border","1px solid #d1d5db"),y.style.setProperty("border-radius","0.375rem"),y.style.setProperty("padding","0.375rem"),y.style.setProperty("margin-bottom","0.375rem"),y.style.setProperty("background-color","white"),F.style.setProperty("font-size","0.6rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("margin-bottom","0.25rem"),F.style.setProperty("display","flex"),F.style.setProperty("align-items","center"),F.style.setProperty("gap","0.25rem"),b.style.setProperty("padding","0.0625rem 0.25rem"),b.style.setProperty("border-radius","0.125rem"),b.style.setProperty("font-size","0.5rem"),r(b,()=>s.isDebit?"D":"C"),r(B,()=>p()+1,null),N.style.setProperty("display","grid"),N.style.setProperty("grid-template-columns","1fr 1fr"),N.style.setProperty("gap","0.25rem"),v.addEventListener("drop",$=>le(p(),$)),v.addEventListener("dragleave",P),v.addEventListener("dragover",$=>k(`line-${p()}-amount`,$)),v.style.setProperty("padding","0.25rem"),v.style.setProperty("border-radius","0.25rem"),v.style.setProperty("text-align","center"),v.style.setProperty("font-size","0.55rem"),r(v,()=>s.amountExpression?.replace("data.","").slice(0,12)||"Monto",null),S.addEventListener("drop",$=>J(p(),$)),S.addEventListener("dragleave",P),S.addEventListener("dragover",$=>k(`line-${p()}-desc`,$)),S.style.setProperty("padding","0.25rem"),S.style.setProperty("border-radius","0.25rem"),S.style.setProperty("text-align","center"),S.style.setProperty("font-size","0.55rem"),r(S,()=>s.descriptionTemplate?.slice(0,10)||"Desc",null),te($=>{var re=s.isDebit?"#dcfce7":"#fee2e2",ee=s.isDebit?"#166534":"#991b1b",Ae=Z()===`line-${p()}-amount`?"2px dashed #059669":"1px dashed #d1d5db",he=Z()===`line-${p()}-amount`?"#dcfce7":"#fafafa",X=Z()===`line-${p()}-desc`?"2px dashed #7c3aed":"1px dashed #d1d5db",Pe=Z()===`line-${p()}-desc`?"#f3e8ff":"#fafafa";return re!==$.e&&(($.e=re)!=null?b.style.setProperty("background-color",re):b.style.removeProperty("background-color")),ee!==$.t&&(($.t=ee)!=null?b.style.setProperty("color",ee):b.style.removeProperty("color")),Ae!==$.a&&(($.a=Ae)!=null?v.style.setProperty("border",Ae):v.style.removeProperty("border")),he!==$.o&&(($.o=he)!=null?v.style.setProperty("background-color",he):v.style.removeProperty("background-color")),X!==$.i&&(($.i=X)!=null?S.style.setProperty("border",X):S.style.removeProperty("border")),Pe!==$.n&&(($.n=Pe)!=null?S.style.setProperty("background-color",Pe):S.style.removeProperty("background-color")),$},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),y})()}),null),Qe.style.setProperty("background-color","#fffbeb"),Qe.style.setProperty("border-radius","0.375rem"),Qe.style.setProperty("padding","0.5rem"),Qe.style.setProperty("margin-bottom","0.75rem"),Qe.style.setProperty("border","1px solid #fcd34d"),St.style.setProperty("font-size","0.7rem"),St.style.setProperty("font-weight","600"),St.style.setProperty("margin-bottom","0.5rem"),St.style.setProperty("color","#d97706"),lt.style.setProperty("display","grid"),lt.style.setProperty("grid-template-columns","1fr 1fr"),lt.style.setProperty("gap","0.375rem"),lt.style.setProperty("margin-bottom","0.375rem"),Ve.addEventListener("drop",pe),Ve.addEventListener("dragleave",P),Ve.addEventListener("dragover",s=>k("newline-amount",s)),Ve.style.setProperty("padding","0.375rem"),Ve.style.setProperty("border-radius","0.25rem"),Ve.style.setProperty("text-align","center"),Ve.style.setProperty("font-size","0.65rem"),vt.style.setProperty("font-weight","600"),vt.style.setProperty("color","#059669"),at.style.setProperty("font-size","0.6rem"),r(at,()=>ne()?.replace("data.","")||"Arrastra"),je.addEventListener("drop",ge),je.addEventListener("dragleave",P),je.addEventListener("dragover",s=>k("newline-desc",s)),je.style.setProperty("padding","0.375rem"),je.style.setProperty("border-radius","0.25rem"),je.style.setProperty("text-align","center"),je.style.setProperty("font-size","0.65rem"),$t.style.setProperty("font-weight","600"),$t.style.setProperty("color","#7c3aed"),dt.style.setProperty("font-size","0.6rem"),r(dt,()=>Ce()?.replace("data.","")||"Opcional"),r(Qe,f(Q,{get when(){return ne()},get children(){var s=Nr();return s.$$click=x,s.style.setProperty("width","100%"),s.style.setProperty("padding","0.25rem"),s.style.setProperty("background-color","#d97706"),s.style.setProperty("color","white"),s.style.setProperty("border","none"),s.style.setProperty("border-radius","0.25rem"),s.style.setProperty("font-size","0.65rem"),s.style.setProperty("font-weight","600"),s.style.setProperty("cursor","pointer"),s}}),null),We.style.setProperty("background-color","#faf5ff"),We.style.setProperty("border-radius","0.375rem"),We.style.setProperty("padding","0.5rem"),We.style.setProperty("margin-bottom","0.75rem"),We.style.setProperty("border","1px solid #e9d5ff"),ct.style.setProperty("font-size","0.7rem"),ct.style.setProperty("font-weight","600"),ct.style.setProperty("margin-bottom","0.5rem"),ct.style.setProperty("color","#7c3aed"),Ke.$$input=s=>D(s.currentTarget.value),Ke.style.setProperty("width","100%"),Ke.style.setProperty("padding","0.25rem 0.375rem"),Ke.style.setProperty("border","1px solid #d1d5db"),Ke.style.setProperty("border-radius","0.25rem"),Ke.style.setProperty("font-size","0.65rem"),Ke.style.setProperty("margin-bottom","0.25rem"),Re.addEventListener("drop",T),Re.addEventListener("dragleave",P),Re.addEventListener("dragover",s=>k("custom-expr",s)),Re.style.setProperty("padding","0.375rem"),Re.style.setProperty("border-radius","0.25rem"),Re.style.setProperty("min-height","35px"),Re.style.setProperty("font-size","0.6rem"),Re.style.setProperty("font-family","monospace"),Re.style.setProperty("margin-bottom","0.25rem"),Re.style.setProperty("word-break","break-all"),r(Re,()=>W()||(()=>{var s=Ur();return s.style.setProperty("color","#9ca3af"),s})()),r(We,f(Q,{get when(){return qe(()=>!!De())()&&W()},get children(){var s=zr();return s.firstChild,s.$$click=h,s.style.setProperty("width","100%"),s.style.setProperty("padding","0.25rem"),s.style.setProperty("background-color","#7c3aed"),s.style.setProperty("color","white"),s.style.setProperty("border","none"),s.style.setProperty("border-radius","0.25rem"),s.style.setProperty("font-size","0.65rem"),s.style.setProperty("font-weight","600"),s.style.setProperty("cursor","pointer"),r(s,De,null),s}}),null),Ze.style.setProperty("background-color","#f9fafb"),Ze.style.setProperty("border-radius","0.375rem"),Ze.style.setProperty("padding","0.5rem"),Ze.style.setProperty("margin-bottom","0.75rem"),Ze.style.setProperty("border","1px solid #e5e7eb"),pt.style.setProperty("font-size","0.7rem"),pt.style.setProperty("font-weight","600"),pt.style.setProperty("margin-bottom","0.5rem"),pt.style.setProperty("color","#374151"),_t.style.setProperty("margin-bottom","0.5rem"),it.addEventListener("drop",I),it.addEventListener("dragleave",P),it.addEventListener("dragover",s=>k("condition",s)),ot.style.setProperty("font-size","0.7rem"),ot.style.setProperty("color","#6b7280"),r(ot,()=>Z()==="condition"?"Soltar":"CondiciÃ³n",null),wt.style.setProperty("display","grid"),wt.style.setProperty("grid-template-columns","1fr 1fr"),wt.style.setProperty("gap","0.375rem"),yt.addEventListener("drop",g),yt.addEventListener("dragleave",P),yt.addEventListener("dragover",s=>k("description",s)),bt.style.setProperty("font-size","0.65rem"),bt.style.setProperty("color","#6b7280"),r(bt,()=>Z()==="description"?"Soltar":"DescripciÃ³n",null),ht.addEventListener("drop",ue),ht.addEventListener("dragleave",P),ht.addEventListener("dragover",s=>k("reference",s)),o.style.setProperty("font-size","0.65rem"),o.style.setProperty("color","#6b7280"),r(o,()=>Z()==="reference"?"Soltar":"Referencia",null),r(Ze,f(Q,{get when(){return oe().length>0},get children(){var s=jr(),p=s.firstChild,y=p.firstChild,F=y.nextSibling;return F.nextSibling,s.style.setProperty("background-color","#f9fafb"),s.style.setProperty("border-radius","0.375rem"),s.style.setProperty("padding","0.5rem"),s.style.setProperty("border","1px solid #e5e7eb"),s.style.setProperty("max-height","100px"),s.style.setProperty("overflow-y","auto"),p.style.setProperty("font-size","0.7rem"),p.style.setProperty("font-weight","600"),p.style.setProperty("margin-bottom","0.375rem"),p.style.setProperty("color","#374151"),r(p,()=>oe().length,F),r(s,f(Oe,{get each(){return oe()},children:(b,B)=>(()=>{var N=Wr(),v=N.firstChild,S=v.firstChild,$=S.nextSibling,re=$.nextSibling,ee=v.nextSibling;return N.style.setProperty("display","flex"),N.style.setProperty("align-items","center"),N.style.setProperty("justify-content","space-between"),N.style.setProperty("padding","0.125rem 0.25rem"),N.style.setProperty("background-color","white"),N.style.setProperty("border-radius","0.125rem"),N.style.setProperty("margin-bottom","0.125rem"),N.style.setProperty("font-size","0.55rem"),r(S,()=>b.sourceField.path.replace("data.","")),re.style.setProperty("color","#6b7280"),r(re,()=>b.targetType),ee.$$click=()=>de(B()),ee.style.setProperty("background","none"),ee.style.setProperty("border","none"),ee.style.setProperty("color","#dc2626"),ee.style.setProperty("cursor","pointer"),ee.style.setProperty("padding","0"),ee.style.setProperty("font-size","0.6rem"),N})()}),null),s}}),null),te(s=>{var p=fe,y=R(ae()===null),F={...fe,display:"flex","flex-direction":"column",padding:"0.75rem"},b=Z()==="newline-amount"?"2px dashed #059669":"1px dashed #d1d5db",B=ne()||Z()==="newline-amount"?"#dcfce7":"white",N=ne()?"#166534":"#9ca3af",v=Z()==="newline-desc"?"2px dashed #7c3aed":"1px dashed #d1d5db",S=Ce()||Z()==="newline-desc"?"#f3e8ff":"white",$=Ce()?"#7c3aed":"#9ca3af",re=Z()==="custom-expr"?"2px dashed #7c3aed":"1px dashed #d1d5db",ee=W()||Z()==="custom-expr"?"#f3e8ff":"white",Ae={...z("condition","#dc2626"),"min-height":"45px",padding:"0.5rem"},he={...z("description","#7c3aed"),"min-height":"40px",padding:"0.375rem"},X={...z("reference","#0891b2"),"min-height":"40px",padding:"0.375rem"};return s.e=L(_,p,s.e),s.t=L(Le,y,s.t),s.a=L(Ge,F,s.a),b!==s.o&&((s.o=b)!=null?Ve.style.setProperty("border",b):Ve.style.removeProperty("border")),B!==s.i&&((s.i=B)!=null?Ve.style.setProperty("background-color",B):Ve.style.removeProperty("background-color")),N!==s.n&&((s.n=N)!=null?at.style.setProperty("color",N):at.style.removeProperty("color")),v!==s.s&&((s.s=v)!=null?je.style.setProperty("border",v):je.style.removeProperty("border")),S!==s.h&&((s.h=S)!=null?je.style.setProperty("background-color",S):je.style.removeProperty("background-color")),$!==s.r&&((s.r=$)!=null?dt.style.setProperty("color",$):dt.style.removeProperty("color")),re!==s.d&&((s.d=re)!=null?Re.style.setProperty("border",re):Re.style.removeProperty("border")),ee!==s.l&&((s.l=ee)!=null?Re.style.setProperty("background-color",ee):Re.style.removeProperty("background-color")),s.u=L(it,Ae,s.u),s.c=L(yt,he,s.c),s.w=L(ht,X,s.w),s},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),te(()=>se.value=m()),te(()=>Ke.value=De()),i}}),null),d})()};Lt(["click","input"]);var Yr=E("<button>âœ• "),Gr=E("<div><div><div><h2>ğŸš€ </h2><p></p></div><div><div><span>:</span><select><option value=append></option><option value=replace></option></select></div></div></div><div></div><div><div></div><div><span>ğŸ” </span><span>ğŸ“ </span><span>ğŸ’° </span><span>ğŸ”— ");const Zr=e=>{const{t}=zt(),[l,n]=H("visual"),[C,U]=H("append"),[m,q]=H(0),[ae,O]=H("amount"),ve=(oe,A)=>{switch(A){case"condition":e.onAddCondition(oe);break;case"description":e.onSetDescription(`{${oe}}`);break;case"amount":e.onSetAmount(oe,m());break;case"lineDescription":e.onSetLineDescription(`{${oe}}`,m());break;case"reference":e.onSetReference(`{${oe}}`);break}},K={"background-color":"white","border-radius":"0.75rem","box-shadow":"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",overflow:"hidden","max-height":"96vh",display:"flex","flex-direction":"column"},Z={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 1.25rem",background:"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)",color:"white"},ce={flex:1,overflow:"auto",padding:"0"};return(()=>{var oe=Gr(),A=oe.firstChild,V=A.firstChild,me=V.firstChild;me.firstChild;var ne=me.nextSibling,we=V.nextSibling,Ce=we.firstChild,Fe=Ce.firstChild,De=Fe.firstChild,D=Fe.nextSibling,W=D.firstChild,$e=W.nextSibling,tt=A.nextSibling,be=tt.nextSibling,Ee=be.firstChild,He=Ee.nextSibling,ke=He.firstChild;ke.firstChild;var Ie=ke.nextSibling;Ie.firstChild;var Ne=Ie.nextSibling;Ne.firstChild;var k=Ne.nextSibling;return k.firstChild,L(oe,K),L(A,Z),me.style.setProperty("margin","0"),me.style.setProperty("font-size","1.25rem"),me.style.setProperty("font-weight","700"),r(me,()=>t("fieldAssistant.title"),null),ne.style.setProperty("margin","0.25rem 0 0"),ne.style.setProperty("font-size","0.8rem"),ne.style.setProperty("opacity","0.9"),r(ne,()=>t("fieldAssistant.subtitle")),we.style.setProperty("display","flex"),we.style.setProperty("align-items","center"),we.style.setProperty("gap","1rem"),Ce.style.setProperty("display","flex"),Ce.style.setProperty("align-items","center"),Ce.style.setProperty("gap","0.5rem"),Ce.style.setProperty("font-size","0.75rem"),r(Fe,()=>t("fieldAssistant.mode"),De),D.addEventListener("change",P=>U(P.currentTarget.value)),D.style.setProperty("padding","0.25rem 0.5rem"),D.style.setProperty("border-radius","0.25rem"),D.style.setProperty("border","none"),D.style.setProperty("font-size","0.75rem"),D.style.setProperty("cursor","pointer"),r(W,()=>t("fieldAssistant.append")),r($e,()=>t("fieldAssistant.replace")),r(we,f(Q,{get when(){return e.onClose},get children(){var P=Yr();return P.firstChild,tr(P,"click",e.onClose,!0),P.style.setProperty("background","rgba(255,255,255,0.2)"),P.style.setProperty("border","none"),P.style.setProperty("color","white"),P.style.setProperty("padding","0.375rem 0.75rem"),P.style.setProperty("border-radius","0.375rem"),P.style.setProperty("cursor","pointer"),P.style.setProperty("font-size","0.875rem"),r(P,()=>t("common.close"),null),P}}),null),L(tt,ce),r(tt,f(Q,{get when(){return l()==="visual"},get children(){return f(Jr,{get eventType(){return e.eventType},get journalLines(){return e.journalLines},onFieldSelect:(P,I,le)=>{I==="amount"&&le!==void 0?e.onSetAmount(P,le):I==="lineDescription"&&le!==void 0?e.onSetLineDescription(`{${P}}`,le):I==="amount"&&ae()==="lineDescription"?ve(P,"lineDescription"):ve(P,I)},onAddCondition:P=>e.onAddCondition(P),onSetLineAmount:(P,I)=>e.onSetAmount(P,I),onSetLineDescription:(P,I)=>e.onSetLineDescription(`{${P}}`,I),onSetReference:P=>e.onSetReference(`{${P}}`),onSetDescription:P=>e.onSetDescription(`{${P}}`),onCreateNewLine:(P,I,le)=>{e.onAddLine&&e.onAddLine(P,I?`{${I}}`:void 0,le)},onCreateCustomField:(P,I,le)=>{e.onAddCustomField&&e.onAddCustomField(P,I,le)}})}})),be.style.setProperty("padding","0.75rem 1rem"),be.style.setProperty("background-color","#f9fafb"),be.style.setProperty("border-top","1px solid #e5e7eb"),be.style.setProperty("display","flex"),be.style.setProperty("justify-content","space-between"),be.style.setProperty("align-items","center"),be.style.setProperty("font-size","0.75rem"),be.style.setProperty("color","#6b7280"),r(Ee,f(Q,{get when(){return l()==="smart"},get children(){return["ğŸ’¡ ",qe(()=>t("fieldAssistant.tips.smart"))]}}),null),r(Ee,f(Q,{get when(){return l()==="visual"},get children(){return["ğŸ’¡ ",qe(()=>t("fieldAssistant.tips.visual"))]}}),null),r(Ee,f(Q,{get when(){return l()==="analyzer"},get children(){return["ğŸ’¡ ",qe(()=>t("fieldAssistant.tips.analyzer"))]}}),null),He.style.setProperty("display","flex"),He.style.setProperty("gap","0.5rem"),ke.style.setProperty("padding","0.125rem 0.375rem"),ke.style.setProperty("background-color","#fee2e2"),ke.style.setProperty("border-radius","0.25rem"),ke.style.setProperty("font-size","0.625rem"),r(ke,()=>t("fieldAssistant.targets.condition"),null),Ie.style.setProperty("padding","0.125rem 0.375rem"),Ie.style.setProperty("background-color","#fef3c7"),Ie.style.setProperty("border-radius","0.25rem"),Ie.style.setProperty("font-size","0.625rem"),r(Ie,()=>t("fieldAssistant.targets.description"),null),Ne.style.setProperty("padding","0.125rem 0.375rem"),Ne.style.setProperty("background-color","#dbeafe"),Ne.style.setProperty("border-radius","0.25rem"),Ne.style.setProperty("font-size","0.625rem"),r(Ne,()=>t("fieldAssistant.targets.amount"),null),k.style.setProperty("padding","0.125rem 0.375rem"),k.style.setProperty("background-color","#f3e8ff"),k.style.setProperty("border-radius","0.25rem"),k.style.setProperty("font-size","0.625rem"),r(k,()=>t("fieldAssistant.targets.reference"),null),te(()=>D.value=C()),oe})()};Lt(["click"]);var Hr=E("<div><div><span>â†‘â†“ Navegar</span><span>Tab/Enter Seleccionar</span><span>Esc Cerrar"),Qr=E("<div><input type=text autocomplete=off>"),Kr=E("<div>"),Xr=E("<div><span></span><div><div></div></div><span>");const kt=e=>{const t=pr(),[l,n]=H(e.value||""),[C,U]=H(!1),[m,q]=H([]),[ae,O]=H(0),[ve,K]=H(0),[Z,ce]=H(!1),[oe,A]=H({top:0,left:0,width:0});let V,me;const ne=()=>{if(V){const g=V.getBoundingClientRect();A({top:g.bottom+4,left:g.left+window.scrollX,width:g.width})}};Vt(()=>{const g=e.value;Z()||n(g||"")});const we=()=>{const g=or(e.eventType),x=(e.customFields||[]).map(h=>({path:`custom.${h.name}`,definition:{type:"expression",description:h.description||`Custom: ${h.expression}`,example:h.expression}}));return[...g,...x]},Ce=[{value:"data.totalAmount",label:"data.totalAmount",description:"Total amount",type:"field",icon:"ğŸ’°"},{value:"data.subtotal",label:"data.subtotal",description:"Subtotal before tax",type:"field",icon:"ğŸ“Š"},{value:"data.tax",label:"data.tax",description:"Tax amount",type:"field",icon:"ğŸ“‹"},{value:"data.discount",label:"data.discount",description:"Discount amount",type:"field",icon:"ğŸ·ï¸"},{value:"data.quantity",label:"data.quantity",description:"Item quantity",type:"field",icon:"ğŸ“¦"},{value:"data.unitPrice",label:"data.unitPrice",description:"Unit price",type:"field",icon:"ğŸ’µ"}],Fe=[{value:" + ",label:"+",description:"Addition",type:"operator",icon:"â•"},{value:" - ",label:"-",description:"Subtraction",type:"operator",icon:"â–"},{value:" * ",label:"*",description:"Multiplication",type:"operator",icon:"âœ–ï¸"},{value:" / ",label:"/",description:"Division",type:"operator",icon:"â—"},{value:"()",label:"()",description:"Parentheses",type:"operator",icon:"ğŸ”¢"}],De=[{value:"Math.abs()",label:"Math.abs()",description:"Absolute value",type:"function",icon:"ğŸ“"},{value:"Math.round()",label:"Math.round()",description:"Round to nearest integer",type:"function",icon:"ğŸ”„"},{value:"Math.floor()",label:"Math.floor()",description:"Round down",type:"function",icon:"â¬‡ï¸"},{value:"Math.ceil()",label:"Math.ceil()",description:"Round up",type:"function",icon:"â¬†ï¸"},{value:"Math.max(a, b)",label:"Math.max()",description:"Maximum value",type:"function",icon:"ğŸ“ˆ"},{value:"Math.min(a, b)",label:"Math.min()",description:"Minimum value",type:"function",icon:"ğŸ“‰"}],D=[{value:"{data.customerName}",label:"{data.customerName}",description:"Customer name",type:"template",icon:"ğŸ‘¤"},{value:"{data.invoiceNumber}",label:"{data.invoiceNumber}",description:"Invoice number",type:"template",icon:"ğŸ“„"},{value:"{data.date}",label:"{data.date}",description:"Transaction date",type:"template",icon:"ğŸ“…"},{value:"{data.totalAmount}",label:"{data.totalAmount}",description:"Total amount",type:"template",icon:"ğŸ’°"},{value:"{data.reference}",label:"{data.reference}",description:"Reference number",type:"template",icon:"ğŸ”—"}],W=(g,x)=>{let h=x,T=x;for(;h>0&&!/[\s,;+\-*/(){}]/.test(g[h-1]);)h--;for(;T<g.length&&!/[\s,;+\-*/(){}]/.test(g[T]);)T++;return{word:g.substring(h,x),start:h,end:T}},$e=(g,x)=>{const{word:h}=W(g,x),T=h.toLowerCase();let Y=[];if(!h||h.length===0)e.type==="template"?Y=[...D]:Y=[...Ce.slice(0,5),...Fe];else if(T.startsWith("data.")||T.startsWith("d"))Y=we().filter(G=>G.path.toLowerCase().includes(T)).slice(0,10).map(G=>({value:e.type==="template"?`{${G.path}}`:G.path,label:G.path,description:G.definition.description,type:"field",icon:G.definition.type==="number"?"ğŸ”¢":G.definition.type==="string"?"ğŸ“":"ğŸ“‹"}));else if(h.startsWith("{")||e.type==="template"&&T.length>0){const de=h.replace(/[{}]/g,"").toLowerCase();Y=we().filter(fe=>fe.path.toLowerCase().includes(de)).slice(0,10).map(fe=>({value:`{${fe.path}}`,label:`{${fe.path}}`,description:fe.definition.description,type:"template",icon:"ğŸ“‹"}))}else if(T.startsWith("math")||T.startsWith("m"))Y=De.filter(de=>de.label.toLowerCase().includes(T));else if(T.startsWith("custom")||T.startsWith("c"))Y=(e.customFields||[]).map(G=>({value:e.type==="template"?`{custom.${G.name}}`:`custom.${G.name}`,label:`custom.${G.name}`,description:G.description||G.expression,type:"field",icon:"âš™ï¸"}));else{const G=we().filter(c=>c.path.toLowerCase().includes(T)||c.definition.description?.toLowerCase().includes(T)).slice(0,6).map(c=>({value:e.type==="template"?`{${c.path}}`:c.path,label:e.type==="template"?`{${c.path}}`:c.path,description:c.definition.description,type:"field",icon:c.definition.type==="number"?"ğŸ”¢":"ğŸ“"})),fe=De.filter(c=>c.label.toLowerCase().includes(T));Y=[...G,...fe]}return Y.slice(0,8)},tt=g=>{const x=g.currentTarget,h=x.value,T=x.selectionStart||0;n(h),K(T);const Y=$e(h,T);q(Y),U(Y.length>0),O(0),ne()},be=g=>{if(C())switch(g.key){case"ArrowDown":g.preventDefault(),O(x=>Math.min(x+1,m().length-1));break;case"ArrowUp":g.preventDefault(),O(x=>Math.max(x-1,0));break;case"Enter":case"Tab":m().length>0&&ae()<m().length&&(g.preventDefault(),Ee(m()[ae()]));break;case"Escape":g.preventDefault(),U(!1);break}},Ee=g=>{if(!V)return;const x=l(),h=ve(),{start:T}=W(x,h),Y=g.value,de=x.substring(0,T)+Y+x.substring(h);n(de),U(!1),e.onChange(de),requestAnimationFrame(()=>{if(V){const G=T+Y.length;V.focus(),V.setSelectionRange(G,G),K(G)}})},He=()=>{ce(!0);const g=V?.selectionStart||0;K(g);const x=$e(l(),g);q(x),U(x.length>0),ne()},ke=g=>{const x=g.relatedTarget;me&&me.contains(x)||setTimeout(()=>{U(!1)},150)},Ie=()=>{if(V){const g=V.selectionStart||0;K(g)}},Ne={position:"relative",width:"100%"},k={width:"100%",padding:"0.5rem 0.75rem",border:"1px solid #d1d5db","border-radius":"0.375rem","font-size":"0.875rem","font-family":"monospace","background-color":e.disabled?"#f3f4f6":"white",...e.style},P=()=>({position:"fixed",top:`${oe().top}px`,left:`${oe().left}px`,width:`${oe().width}px`,"background-color":"white",border:"1px solid #d1d5db","border-radius":"0.375rem","box-shadow":"0 10px 25px -5px rgba(0, 0, 0, 0.15), 0 8px 10px -6px rgba(0, 0, 0, 0.1)","max-height":"240px","overflow-y":"auto","z-index":"9999"}),I=g=>({padding:"0.5rem 0.75rem",cursor:"pointer",display:"flex","align-items":"center",gap:"0.5rem","background-color":g?"#eff6ff":"transparent","border-left":g?"3px solid #3b82f6":"3px solid transparent",transition:"background-color 0.15s"}),le={"font-size":"0.875rem","flex-shrink":"0"},J={flex:"1","min-width":"0"},pe={"font-family":"monospace","font-size":"0.8rem","font-weight":"500",color:"#1f2937"},ge={"font-size":"0.7rem",color:"#6b7280","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"},ue=g=>({"font-size":"0.6rem",padding:"0.125rem 0.375rem","border-radius":"0.25rem","font-weight":"500","background-color":g==="field"?"#dbeafe":g==="function"?"#fef3c7":g==="operator"?"#dcfce7":"#f3e8ff",color:g==="field"?"#1e40af":g==="function"?"#92400e":g==="operator"?"#166534":"#7c3aed"});return(()=>{var g=Qr(),x=g.firstChild;return Gt(h=>me=h,g),Dt(g,"data-autocomplete-id",t),x.$$click=Ie,x.addEventListener("blur",ke),x.addEventListener("focus",He),x.$$keydown=be,x.$$input=tt,Gt(h=>V=h,x),Dt(x,"data-instance",t),r(g,f(Q,{get when(){return qe(()=>!!C())()&&m().length>0},get children(){var h=Hr(),T=h.firstChild;return r(h,f(Oe,{get each(){return m()},children:(Y,de)=>(()=>{var G=Xr(),fe=G.firstChild,c=fe.nextSibling,w=c.firstChild,z=c.nextSibling;return G.addEventListener("mouseenter",()=>O(de())),G.$$mousedown=R=>{R.preventDefault(),Ee(Y)},L(fe,le),r(fe,()=>Y.icon||"ğŸ“‹"),L(c,J),L(w,pe),r(w,()=>Y.label),r(c,f(Q,{get when(){return Y.description},get children(){var R=Kr();return L(R,ge),r(R,()=>Y.description),R}}),null),r(z,()=>Y.type),te(R=>{var d=I(ae()===de()),i=ue(Y.type);return R.e=L(G,d,R.e),R.t=L(z,i,R.t),R},{e:void 0,t:void 0}),G})()}),T),T.style.setProperty("padding","0.375rem 0.75rem"),T.style.setProperty("background-color","#f9fafb"),T.style.setProperty("border-top","1px solid #e5e7eb"),T.style.setProperty("font-size","0.65rem"),T.style.setProperty("color","#6b7280"),T.style.setProperty("display","flex"),T.style.setProperty("gap","0.75rem"),te(Y=>L(h,P(),Y)),h}}),null),te(h=>{var T=Ne,Y=e.placeholder,de=e.disabled,G=k;return h.e=L(g,T,h.e),Y!==h.t&&Dt(x,"placeholder",h.t=Y),de!==h.a&&(x.disabled=h.a=de),h.o=L(x,G,h.o),h},{e:void 0,t:void 0,a:void 0,o:void 0}),te(()=>x.value=l()),g})()};Lt(["input","keydown","click","mousedown"]);const It="hrm_rule_draft",nr=1,[Ut,Wt]=H(null),[es,Jt]=H(null),lr=()=>{try{const e=localStorage.getItem(It);if(e){const t=JSON.parse(e);if(t.version===nr)return Wt(t),Jt(new Date(t.timestamp)),t;localStorage.removeItem(It)}}catch(e){console.error("Error loading rule draft from localStorage:",e),localStorage.removeItem(It)}return null};lr();const ts=e=>{try{const t={...e,version:nr,timestamp:Date.now()};localStorage.setItem(It,JSON.stringify(t)),Wt(t),Jt(new Date),console.log("[RuleDraft] Draft saved at",new Date().toLocaleTimeString(),{name:e.formData.name,lines:e.formData.journalEntryTemplate?.lines?.length||0,conditions:e.formData.conditions?.length||0,customFields:e.customFields?.length||0})}catch(t){console.error("Error saving rule draft to localStorage:",t)}},rs=()=>lr(),ss=()=>{try{localStorage.removeItem(It),Wt(null),Jt(null),console.log("[RuleDraft] Draft cleared")}catch(e){console.error("Error clearing rule draft from localStorage:",e)}},os=()=>{const e=Ut();if(!e)return null;const l=Date.now()-e.timestamp,n=Math.floor(l/6e4),C=Math.floor(l/36e5),U=Math.floor(l/864e5);return U>0?`${U} dÃ­a${U>1?"s":""}`:C>0?`${C} hora${C>1?"s":""}`:n>0?`${n} minuto${n>1?"s":""}`:"hace un momento"},ns=()=>{const e=Ut();if(!e)return!1;const t=!!e.formData.name,l=(e.formData.conditions?.length||0)>0,n=(e.formData.journalEntryTemplate?.lines?.length||0)>0,C=(e.customFields?.length||0)>0;return t||l||n||C},nt={hasDraft:ns,draft:Ut,lastSaved:es,saveDraft:ts,loadDraft:rs,clearDraft:ss,getDraftAge:os},ls=(e,t,l,n,C,U)=>{let m=null;return()=>{m&&clearTimeout(m),m=setTimeout(()=>{nt.saveDraft({ruleId:U,formData:e(),customFields:t(),activeLineIndex:l(),showFieldAssistant:n(),showCustomFields:C()})},1e3)}};var is=E("<div><div><div><span>ğŸ’¾</span><div><h3></h3><p> </p></div></div><div><div></div><div> <!> &bull;  <!> <!> &bull;  <!> </div></div><div><button>âœ“ </button><button>"),as=E("<div><span>â—"),ds=E("<p> <!> events"),cs=E("<div><h4>âš™ï¸ Campos Personalizados (<!>)</h4><div></div><p>ğŸ’¡ Usa el Field Assistant â†’ Visual para agregar mÃ¡s campos personalizados"),ps=E("<div><div>ğŸ“‹</div><p></p><p>Agrega lÃ­neas de dÃ©bito y crÃ©dito para crear el asiento"),ys=E("<p>âš ï¸ Recuerda guardar la regla para persistir todos los cambios incluyendo campos personalizados"),us=E("<div><div>"),ms=E("<div><div><div><h2></h2></div><div><h3></h3><div><div><label> *</label><input type=text></div><div><label></label><input type=number min=1 max=1000></div></div><div><label> *</label><textarea></textarea></div><div><div><label> *</label><select></select></div><div><label><input type=checkbox></label></div></div></div><div><div><h3></h3><button>+ </button></div></div><div><div><h3></h3><div><button type=button>ğŸš€ Field Assistant</button></div></div><div><h4></h4><button>+ </button></div><div></div></div><div><div></div><div><button></button><button>"),Mt=E("<option>"),gs=E("<div><div><div><label></label><select><option value></option></select></div><div><label></label><select></select></div><div><label></label></div><div><button>"),fs=E("<option> (<!>)"),Qt=E("<input type=text value=N/A disabled>"),vs=E('<div><div><span></span><code></code></div><button type=button title="Eliminar campo">âœ•'),bs=E("<span>Cuenta: <strong>"),hs=E("<div><div><label>ğŸ“ DescripciÃ³n</label></div><div><label>ğŸ’° Monto</label></div><div><label>ğŸ“„ Documento"),Ps=E("<span>"),xs=E("<div>Sin condiciones - Esta lÃ­nea siempre se incluirÃ¡"),$s=E("<div>"),_s=E("<code>: "),Ss=E("<code>ğŸ“„ "),ws=E("<div><span>Vista previa:"),Cs=E("<div><div><div><div></div><div><button type=button>â†“ DÃ©bito</button><button type=button>â†‘ CrÃ©dito</button></div></div><button type=button><span>âœ•</span> Eliminar</button></div><div><div><label></label></div><div><div><div><span>ğŸ”’</span><span>Condiciones</span></div><button type=button>+ Agregar"),As=E("<div><div></div><div><select></select></div><div></div><button type=button>âœ•");const Ts=e=>{const{t}=zt(),l=()=>e.rule&&e.rule.id,[n,C]=H(!1),[U,m]=H(0),[q,ae]=H(!1),[O,ve]=H(e.rule?.customFields||[]),[K,Z]=H(!1),[ce,oe]=H(null),[A,V]=H({name:e.rule?.name||"",description:e.rule?.description||"",eventType:e.rule?.eventType||"invoice_completed",isActive:e.rule?.isActive??!0,priority:e.rule?.priority||100,conditions:e.rule?.conditions||[],customFields:e.rule?.customFields||[],journalEntryTemplate:e.rule?.journalEntryTemplate||{description:"",reference:"",lines:[]},createdBy:e.rule?.createdBy||"user"}),[me,ne]=H(!1),[we,Ce]=H(!1);Bt(()=>{if(!l()&&nt.hasDraft()){const c=nt.draft();c&&!c.ruleId&&ne(!0)}Ce(!0)});const Fe=()=>{const c=nt.draft();c&&(V(c.formData),ve(c.customFields||[]),c.activeLineIndex!==null&&oe(c.activeLineIndex),Z(c.showFieldAssistant||!1),ae(c.showCustomFields||!1)),ne(!1)},De=()=>{nt.clearDraft(),ne(!1)},D=ls(A,O,ce,K,q,e.rule?.id);Vt(()=>{we()&&(A(),O(),ce(),K(),q(),D())});const W=Ot(()=>{const c=A().eventType;if(!c)return[];const w=or(c),z=O().map(R=>({path:`custom.${R.name}`,definition:{type:"expression",description:R.description||`Custom field: ${R.expression}`,example:R.expression}}));return[...w,...z]});Ot(()=>{const c=A().eventType;return c?sr(c):null});const $e=[{value:"equals",label:t("eventAutomation.operators.equals")},{value:"notEquals",label:t("eventAutomation.operators.notEquals")},{value:"greaterThan",label:t("eventAutomation.operators.greaterThan")},{value:"lessThan",label:t("eventAutomation.operators.lessThan")},{value:"greaterThanOrEqual",label:t("eventAutomation.operators.greaterThanOrEqual")},{value:"lessThanOrEqual",label:t("eventAutomation.operators.lessThanOrEqual")},{value:"contains",label:t("eventAutomation.operators.contains")},{value:"notContains",label:t("eventAutomation.operators.notContains")},{value:"exists",label:t("eventAutomation.operators.exists")},{value:"notExists",label:t("eventAutomation.operators.notExists")}],tt=[{value:"invoice_completed",label:t("eventAutomation.eventTypes.invoice_completed")},{value:"invoice_created",label:t("eventAutomation.eventTypes.invoice_created")},{value:"payment_received",label:t("eventAutomation.eventTypes.payment_received")},{value:"inventory_received",label:t("eventAutomation.eventTypes.inventory_received")},{value:"inventory_sold",label:t("eventAutomation.eventTypes.inventory_sold")},{value:"expense_created",label:t("eventAutomation.eventTypes.expense_created")},{value:"expense_approved",label:t("eventAutomation.eventTypes.expense_approved")},{value:"service_rendered",label:t("eventAutomation.eventTypes.service_rendered")}],be=(c,w)=>{V(z=>({...z,[c]:w}))},Ee=(c,w)=>{V(z=>({...z,journalEntryTemplate:{...z.journalEntryTemplate,[c]:w}}))},He=()=>{const c={field:W()[0]?.path||"",operator:"equals",value:"",dataType:"string"};V(w=>({...w,conditions:[...w.conditions||[],c]}))},ke=(c,w,z)=>{const R=[...A().conditions||[]];if(R[c]={...R[c],[w]:z},w==="field"){const d=W().find(i=>i.path===z);d&&(R[c].dataType=d.definition.type)}V(d=>({...d,conditions:R}))},Ie=c=>{V(w=>({...w,conditions:w.conditions?.filter((z,R)=>R!==c)||[]}))},Ne=()=>{const c={accountExpression:"1001",descriptionTemplate:"",amountExpression:"",documentExpression:"",isDebit:!0,conditions:[]};V(w=>({...w,journalEntryTemplate:{...w.journalEntryTemplate,lines:[...w.journalEntryTemplate?.lines||[],c]}}))},k=(c,w,z)=>{const R=[...A().journalEntryTemplate?.lines||[]];R[c]={...R[c],[w]:z},V(d=>({...d,journalEntryTemplate:{...d.journalEntryTemplate,lines:R}}))},P=c=>{const w={field:W()[0]?.path||"",operator:"greaterThan",value:"0",dataType:"number"},z=[...A().journalEntryTemplate?.lines||[]];z[c]={...z[c],conditions:[...z[c].conditions||[],w]},V(R=>({...R,journalEntryTemplate:{...R.journalEntryTemplate,lines:z}}))},I=(c,w,z,R)=>{const d=[...A().journalEntryTemplate?.lines||[]],i=[...d[c].conditions||[]];if(i[w]={...i[w],[z]:R},z==="field"){const _=W().find(j=>j.path===R);_&&(i[w].dataType=_.definition.type)}d[c]={...d[c],conditions:i},V(_=>({..._,journalEntryTemplate:{..._.journalEntryTemplate,lines:d}}))},le=(c,w)=>{const z=[...A().journalEntryTemplate?.lines||[]];z[c]={...z[c],conditions:z[c].conditions?.filter((R,d)=>d!==w)||[]},V(R=>({...R,journalEntryTemplate:{...R.journalEntryTemplate,lines:z}}))},J=c=>{ve(w=>w.filter(z=>z.id!==c))},pe=c=>{V(w=>({...w,journalEntryTemplate:{...w.journalEntryTemplate,lines:w.journalEntryTemplate?.lines.filter((z,R)=>R!==c)||[]}}))},ge=()=>{const c=A();if(!c.name||!c.description||!c.eventType){alert("Por favor complete todos los campos requeridos");return}if(!c.journalEntryTemplate?.lines.length){alert("Por favor agregue al menos una lÃ­nea de asiento contable");return}const w=c.journalEntryTemplate.lines.filter(d=>!d.accountExpression||!d.amountExpression||!d.descriptionTemplate);if(console.log({invalidLines:w}),w.length>0){alert("Por favor complete todos los campos de las lÃ­neas de asiento contable");return}const z=c.journalEntryTemplate.lines.filter(d=>d.conditions?.some(i=>!i.field||!i.operator||i.operator!=="exists"&&i.operator!=="notExists"&&!i.value));console.log({linesWithInvalidConditions:z}),z.length>0;const R={...c,customFields:O()};nt.clearDraft(),e.onSave(R)},ue={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000",overflow:"auto",padding:"2rem"},g={"background-color":"white","border-radius":"0.5rem",padding:"2rem","max-width":"1440px","max-height":"96vh","overflow-y":"auto",width:"100%"},x={width:"100%",padding:"0.5rem",border:"1px solid #d1d5db","border-radius":"0.375rem","font-size":"0.875rem"},h={...x,"background-color":"white"},T={padding:"0.5rem 1rem","border-radius":"0.375rem",cursor:"pointer","font-weight":"500",border:"1px solid #d1d5db"},Y={...T,"background-color":"#3b82f6",color:"white",border:"none"},de={...T,"background-color":"white",color:"#374151"},G={...T,"background-color":"#ef4444",color:"white",border:"none"},fe={"margin-bottom":"2rem","border-bottom":"1px solid #e5e7eb","padding-bottom":"2rem"};return(()=>{var c=ms(),w=c.firstChild,z=w.firstChild,R=z.firstChild,d=z.nextSibling,i=d.firstChild,_=i.nextSibling,j=_.firstChild,ye=j.firstChild,rt=ye.firstChild,Be=ye.nextSibling,se=j.nextSibling,_e=se.firstChild,Le=_e.nextSibling,Ue=_.nextSibling,Ge=Ue.firstChild,gt=Ge.firstChild,st=Ge.nextSibling,ze=Ue.nextSibling,ft=ze.firstChild,xt=ft.firstChild,Rt=xt.firstChild,Qe=xt.nextSibling,St=ft.nextSibling,lt=St.firstChild,Ve=lt.firstChild,vt=d.nextSibling,at=vt.firstChild,je=at.firstChild,$t=je.nextSibling;$t.firstChild;var dt=vt.nextSibling,We=dt.firstChild,ct=We.firstChild,Ke=ct.nextSibling,Re=Ke.firstChild,Ze=We.nextSibling,pt=Ze.firstChild,_t=pt.nextSibling;_t.firstChild;var it=Ze.nextSibling,ot=dt.nextSibling,wt=ot.firstChild,yt=wt.nextSibling,bt=yt.firstChild,ht=bt.nextSibling;return r(c,f(Q,{get when(){return me()},get children(){var o=is(),s=o.firstChild,p=s.firstChild,y=p.firstChild,F=y.nextSibling,b=F.firstChild,B=b.nextSibling,N=B.firstChild,v=p.nextSibling,S=v.firstChild,$=S.nextSibling,re=$.firstChild,ee=re.nextSibling,Ae=ee.nextSibling,he=Ae.nextSibling,X=he.nextSibling,Pe=X.nextSibling,ut=Pe.nextSibling,Te=ut.nextSibling;Te.nextSibling;var u=v.nextSibling,M=u.firstChild;M.firstChild;var ie=M.nextSibling;return o.style.setProperty("position","fixed"),o.style.setProperty("top","0"),o.style.setProperty("left","0"),o.style.setProperty("right","0"),o.style.setProperty("bottom","0"),o.style.setProperty("background-color","rgba(0, 0, 0, 0.7)"),o.style.setProperty("display","flex"),o.style.setProperty("align-items","center"),o.style.setProperty("justify-content","center"),o.style.setProperty("z-index","1100"),s.style.setProperty("background-color","white"),s.style.setProperty("border-radius","0.75rem"),s.style.setProperty("padding","1.5rem"),s.style.setProperty("max-width","450px"),s.style.setProperty("width","90%"),s.style.setProperty("box-shadow","0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"),p.style.setProperty("display","flex"),p.style.setProperty("align-items","center"),p.style.setProperty("gap","0.75rem"),p.style.setProperty("margin-bottom","1rem"),y.style.setProperty("font-size","2rem"),b.style.setProperty("font-size","1.125rem"),b.style.setProperty("font-weight","700"),b.style.setProperty("margin","0"),r(b,()=>t("eventAutomation.draft.foundTitle")),B.style.setProperty("font-size","0.875rem"),B.style.setProperty("color","#6b7280"),B.style.setProperty("margin","0.25rem 0 0"),r(B,()=>t("eventAutomation.draft.foundDescription"),N),r(B,()=>nt.getDraftAge(),null),v.style.setProperty("background-color","#f0f9ff"),v.style.setProperty("border","1px solid #bae6fd"),v.style.setProperty("border-radius","0.5rem"),v.style.setProperty("padding","0.75rem"),v.style.setProperty("margin-bottom","1rem"),v.style.setProperty("font-size","0.875rem"),S.style.setProperty("font-weight","600"),S.style.setProperty("color","#0369a1"),S.style.setProperty("margin-bottom","0.25rem"),r(S,()=>nt.draft()?.formData.name||t("eventAutomation.draft.untitled")),$.style.setProperty("color","#0c4a6e"),$.style.setProperty("font-size","0.75rem"),r($,()=>nt.draft()?.formData.journalEntryTemplate?.lines?.length||0,re),r($,()=>t("eventAutomation.draft.lines"),ee),r($,()=>nt.draft()?.formData.conditions?.length||0,he),r($,()=>t("eventAutomation.draft.conditions"),Pe),r($,()=>nt.draft()?.customFields?.length||0,Te),r($,()=>t("eventAutomation.draft.customFields"),null),u.style.setProperty("display","flex"),u.style.setProperty("gap","0.75rem"),M.$$click=Fe,M.style.setProperty("flex","1"),M.style.setProperty("padding","0.625rem 1rem"),M.style.setProperty("background-color","#3b82f6"),M.style.setProperty("color","white"),M.style.setProperty("border","none"),M.style.setProperty("border-radius","0.5rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("cursor","pointer"),M.style.setProperty("display","flex"),M.style.setProperty("align-items","center"),M.style.setProperty("justify-content","center"),M.style.setProperty("gap","0.5rem"),r(M,()=>t("eventAutomation.draft.restore"),null),ie.$$click=De,ie.style.setProperty("flex","1"),ie.style.setProperty("padding","0.625rem 1rem"),ie.style.setProperty("background-color","#f3f4f6"),ie.style.setProperty("color","#374151"),ie.style.setProperty("border","1px solid #d1d5db"),ie.style.setProperty("border-radius","0.5rem"),ie.style.setProperty("font-weight","600"),ie.style.setProperty("cursor","pointer"),r(ie,()=>t("eventAutomation.draft.startFresh")),o}}),w),L(w,g),z.style.setProperty("display","flex"),z.style.setProperty("justify-content","space-between"),z.style.setProperty("align-items","center"),z.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("font-size","1.5rem"),R.style.setProperty("font-weight","700"),R.style.setProperty("margin","0"),r(R,(()=>{var o=qe(()=>!!l());return()=>o()?t("eventAutomation.builder.editTitle"):t("eventAutomation.builder.createTitle")})()),r(z,f(Q,{get when(){return nt.lastSaved()},get children(){var o=as(),s=o.firstChild;return o.style.setProperty("display","flex"),o.style.setProperty("align-items","center"),o.style.setProperty("gap","0.375rem"),o.style.setProperty("font-size","0.75rem"),o.style.setProperty("color","#059669"),o.style.setProperty("background-color","#ecfdf5"),o.style.setProperty("padding","0.25rem 0.625rem"),o.style.setProperty("border-radius","9999px"),s.style.setProperty("font-size","0.625rem"),r(o,()=>t("eventAutomation.draft.autoSaved"),null),o}}),null),i.style.setProperty("font-size","1.125rem"),i.style.setProperty("font-weight","600"),i.style.setProperty("margin-bottom","1rem"),r(i,()=>t("eventAutomation.builder.basicInfo")),_.style.setProperty("display","grid"),_.style.setProperty("grid-template-columns","1fr 1fr"),_.style.setProperty("gap","1rem"),_.style.setProperty("margin-bottom","1rem"),ye.style.setProperty("display","block"),ye.style.setProperty("font-weight","500"),ye.style.setProperty("margin-bottom","0.5rem"),r(ye,()=>t("eventAutomation.builder.ruleName"),rt),Be.$$input=o=>be("name",o.currentTarget.value),_e.style.setProperty("display","block"),_e.style.setProperty("font-weight","500"),_e.style.setProperty("margin-bottom","0.5rem"),r(_e,()=>t("eventAutomation.builder.priority")),Le.$$input=o=>be("priority",parseInt(o.currentTarget.value)||100),Ue.style.setProperty("margin-bottom","1rem"),Ge.style.setProperty("display","block"),Ge.style.setProperty("font-weight","500"),Ge.style.setProperty("margin-bottom","0.5rem"),r(Ge,()=>t("eventAutomation.builder.description"),gt),st.$$input=o=>be("description",o.currentTarget.value),ze.style.setProperty("display","grid"),ze.style.setProperty("grid-template-columns","1fr auto"),ze.style.setProperty("gap","1rem"),ze.style.setProperty("align-items","end"),xt.style.setProperty("display","block"),xt.style.setProperty("font-weight","500"),xt.style.setProperty("margin-bottom","0.5rem"),r(xt,()=>t("eventAutomation.builder.eventType"),Rt),Qe.addEventListener("change",o=>be("eventType",o.currentTarget.value)),r(Qe,f(Oe,{each:tt,children:o=>(()=>{var s=Mt();return r(s,()=>o.label),te(()=>s.value=o.value),s})()})),lt.style.setProperty("display","flex"),lt.style.setProperty("align-items","center"),lt.style.setProperty("gap","0.5rem"),Ve.addEventListener("change",o=>be("isActive",o.currentTarget.checked)),r(lt,()=>t("eventAutomation.builder.active"),null),at.style.setProperty("display","flex"),at.style.setProperty("justify-content","space-between"),at.style.setProperty("align-items","center"),at.style.setProperty("margin-bottom","1rem"),je.style.setProperty("font-size","1.125rem"),je.style.setProperty("font-weight","600"),r(je,()=>t("eventAutomation.builder.conditions.title")),$t.$$click=He,r($t,()=>t("eventAutomation.builder.conditions.add"),null),r(vt,f(Q,{get when(){return(A().conditions?.length||0)===0},get children(){var o=ds(),s=o.firstChild,p=s.nextSibling;return p.nextSibling,o.style.setProperty("color","#6b7280"),o.style.setProperty("font-style","italic"),r(o,()=>t("eventAutomation.builder.conditions.noConditions"),s),r(o,()=>A().eventType,p),o}}),null),r(vt,f(Oe,{get each(){return A().conditions||[]},children:(o,s)=>(()=>{var p=gs(),y=p.firstChild,F=y.firstChild,b=F.firstChild,B=b.nextSibling,N=B.firstChild,v=F.nextSibling,S=v.firstChild,$=S.nextSibling,re=v.nextSibling,ee=re.firstChild,Ae=re.nextSibling,he=Ae.firstChild;return p.style.setProperty("border","1px solid #d1d5db"),p.style.setProperty("border-radius","0.375rem"),p.style.setProperty("padding","1rem"),p.style.setProperty("margin-bottom","1rem"),y.style.setProperty("display","grid"),y.style.setProperty("grid-template-columns","2fr 1fr 1fr auto"),y.style.setProperty("gap","1rem"),y.style.setProperty("align-items","end"),b.style.setProperty("display","block"),b.style.setProperty("font-weight","500"),b.style.setProperty("margin-bottom","0.5rem"),r(b,()=>t("eventAutomation.builder.conditions.field")),B.addEventListener("change",X=>ke(s(),"field",X.currentTarget.value)),r(N,()=>t("eventAutomation.builder.conditions.selectField")),r(B,f(Oe,{get each(){return W()},children:X=>(()=>{var Pe=fs(),ut=Pe.firstChild,Te=ut.nextSibling;return Te.nextSibling,r(Pe,()=>X.path,ut),r(Pe,()=>X.definition.description,Te),te(()=>Pe.value=X.path),Pe})()}),null),S.style.setProperty("display","block"),S.style.setProperty("font-weight","500"),S.style.setProperty("margin-bottom","0.5rem"),r(S,()=>t("eventAutomation.builder.conditions.operator")),$.addEventListener("change",X=>ke(s(),"operator",X.currentTarget.value)),r($,f(Oe,{each:$e,children:X=>(()=>{var Pe=Mt();return r(Pe,()=>X.label),te(()=>Pe.value=X.value),Pe})()})),ee.style.setProperty("display","block"),ee.style.setProperty("font-weight","500"),ee.style.setProperty("margin-bottom","0.5rem"),r(ee,()=>t("eventAutomation.builder.conditions.value")),r(re,f(Q,{get when(){return o.operator!=="exists"&&o.operator!=="notExists"},get fallback(){return(()=>{var X=Qt();return te(Pe=>L(X,x,Pe)),X})()},get children(){return f(yr,{get type(){return o.dataType==="number"?"number":"text"},style:x,get value(){return o.value},onChange:X=>ke(s(),"value",o.dataType==="number"?parseFloat(X)||0:X),get placeholder(){return qe(()=>o.dataType==="number")()?"0":t("eventAutomation.builder.conditions.enterValue")}})}}),null),he.$$click=()=>Ie(s()),r(he,()=>t("eventAutomation.builder.conditions.remove")),te(X=>{var Pe=h,ut=h,Te=G;return X.e=L(B,Pe,X.e),X.t=L($,ut,X.t),X.a=L(he,Te,X.a),X},{e:void 0,t:void 0,a:void 0}),te(()=>B.value=o.field),te(()=>$.value=o.operator),p})()}),null),r(w,f(Q,{get when(){return O().length>0},get children(){var o=cs(),s=o.firstChild,p=s.firstChild,y=p.nextSibling;y.nextSibling;var F=s.nextSibling,b=F.nextSibling;return o.style.setProperty("margin-bottom","1.5rem"),o.style.setProperty("padding","1rem"),o.style.setProperty("background-color","#faf5ff"),o.style.setProperty("border","1px solid #e9d5ff"),o.style.setProperty("border-radius","0.5rem"),s.style.setProperty("font-size","0.875rem"),s.style.setProperty("font-weight","600"),s.style.setProperty("color","#7c3aed"),s.style.setProperty("margin-bottom","0.75rem"),s.style.setProperty("display","flex"),s.style.setProperty("align-items","center"),s.style.setProperty("gap","0.5rem"),r(s,()=>O().length,y),F.style.setProperty("display","flex"),F.style.setProperty("flex-direction","column"),F.style.setProperty("gap","0.5rem"),r(F,f(Oe,{get each(){return O()},children:B=>(()=>{var N=vs(),v=N.firstChild,S=v.firstChild,$=S.nextSibling,re=v.nextSibling;return N.style.setProperty("display","flex"),N.style.setProperty("align-items","center"),N.style.setProperty("justify-content","space-between"),N.style.setProperty("padding","0.5rem 0.75rem"),N.style.setProperty("background-color","white"),N.style.setProperty("border","1px solid #e5e7eb"),N.style.setProperty("border-radius","0.375rem"),N.style.setProperty("font-size","0.8rem"),v.style.setProperty("display","flex"),v.style.setProperty("align-items","center"),v.style.setProperty("gap","0.75rem"),S.style.setProperty("font-weight","600"),S.style.setProperty("color","#7c3aed"),S.style.setProperty("background-color","#f3e8ff"),S.style.setProperty("padding","0.125rem 0.5rem"),S.style.setProperty("border-radius","0.25rem"),r(S,()=>B.name),$.style.setProperty("font-size","0.7rem"),$.style.setProperty("color","#6b7280"),$.style.setProperty("background-color","#f3f4f6"),$.style.setProperty("padding","0.125rem 0.375rem"),$.style.setProperty("border-radius","0.25rem"),r($,()=>B.expression),re.$$click=()=>J(B.id),re.style.setProperty("background","none"),re.style.setProperty("border","none"),re.style.setProperty("color","#dc2626"),re.style.setProperty("cursor","pointer"),re.style.setProperty("padding","0.25rem"),re.style.setProperty("font-size","0.75rem"),N})()})),b.style.setProperty("font-size","0.7rem"),b.style.setProperty("color","#9ca3af"),b.style.setProperty("margin-top","0.5rem"),b.style.setProperty("font-style","italic"),o}}),dt),dt.style.setProperty("margin-bottom","2rem"),We.style.setProperty("display","flex"),We.style.setProperty("justify-content","space-between"),We.style.setProperty("align-items","center"),We.style.setProperty("margin-bottom","1rem"),ct.style.setProperty("font-size","1.125rem"),ct.style.setProperty("font-weight","600"),r(ct,()=>t("eventAutomation.builder.journalTemplate.title")),Ke.style.setProperty("display","flex"),Ke.style.setProperty("gap","0.5rem"),Re.$$click=()=>Z(!0),Ze.style.setProperty("display","flex"),Ze.style.setProperty("justify-content","space-between"),Ze.style.setProperty("align-items","center"),Ze.style.setProperty("margin-bottom","1rem"),pt.style.setProperty("font-size","1rem"),pt.style.setProperty("font-weight","600"),r(pt,()=>t("eventAutomation.builder.journalTemplate.lines")),_t.$$click=Ne,r(_t,()=>t("eventAutomation.builder.journalTemplate.addLine"),null),r(dt,f(Q,{get when(){return(A().journalEntryTemplate?.lines.length||0)===0},get children(){var o=ps(),s=o.firstChild,p=s.nextSibling,y=p.nextSibling;return o.style.setProperty("text-align","center"),o.style.setProperty("padding","2rem"),o.style.setProperty("background","linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)"),o.style.setProperty("border-radius","0.75rem"),o.style.setProperty("border","2px dashed #cbd5e1"),o.style.setProperty("margin-bottom","1rem"),s.style.setProperty("font-size","2rem"),s.style.setProperty("margin-bottom","0.5rem"),p.style.setProperty("color","#64748b"),p.style.setProperty("font-size","0.875rem"),p.style.setProperty("margin","0"),r(p,()=>t("eventAutomation.builder.journalTemplate.noLines")),y.style.setProperty("color","#94a3b8"),y.style.setProperty("font-size","0.75rem"),y.style.setProperty("margin-top","0.25rem"),o}}),it),it.style.setProperty("display","flex"),it.style.setProperty("flex-direction","column"),it.style.setProperty("gap","1rem"),r(it,f(Oe,{get each(){return A().journalEntryTemplate?.lines||[]},children:(o,s)=>(()=>{var p=Cs(),y=p.firstChild,F=y.firstChild,b=F.firstChild,B=b.nextSibling,N=B.firstChild,v=N.nextSibling,S=F.nextSibling,$=y.nextSibling,re=$.firstChild,ee=re.firstChild,Ae=re.nextSibling,he=Ae.firstChild,X=he.firstChild,Pe=X.firstChild,ut=Pe.nextSibling,Te=X.nextSibling;return p.style.setProperty("border-radius","0.75rem"),p.style.setProperty("box-shadow","0 1px 3px rgba(0,0,0,0.1), 0 1px 2px rgba(0,0,0,0.06)"),p.style.setProperty("overflow","hidden"),p.style.setProperty("background-color","white"),y.style.setProperty("display","flex"),y.style.setProperty("justify-content","space-between"),y.style.setProperty("align-items","center"),y.style.setProperty("padding","0.75rem 1rem"),F.style.setProperty("display","flex"),F.style.setProperty("align-items","center"),F.style.setProperty("gap","0.75rem"),b.style.setProperty("width","28px"),b.style.setProperty("height","28px"),b.style.setProperty("border-radius","50%"),b.style.setProperty("color","white"),b.style.setProperty("display","flex"),b.style.setProperty("align-items","center"),b.style.setProperty("justify-content","center"),b.style.setProperty("font-weight","700"),b.style.setProperty("font-size","0.875rem"),r(b,()=>s()+1),B.style.setProperty("display","flex"),B.style.setProperty("background-color","rgba(255,255,255,0.8)"),B.style.setProperty("border-radius","9999px"),B.style.setProperty("padding","2px"),B.style.setProperty("gap","2px"),N.$$click=()=>k(s(),"isDebit",!0),N.style.setProperty("padding","0.375rem 0.75rem"),N.style.setProperty("border-radius","9999px"),N.style.setProperty("border","none"),N.style.setProperty("font-size","0.75rem"),N.style.setProperty("font-weight","600"),N.style.setProperty("cursor","pointer"),N.style.setProperty("transition","all 0.2s"),v.$$click=()=>k(s(),"isDebit",!1),v.style.setProperty("padding","0.375rem 0.75rem"),v.style.setProperty("border-radius","9999px"),v.style.setProperty("border","none"),v.style.setProperty("font-size","0.75rem"),v.style.setProperty("font-weight","600"),v.style.setProperty("cursor","pointer"),v.style.setProperty("transition","all 0.2s"),r(F,f(Q,{get when(){return o.accountExpression},get children(){var u=bs(),M=u.firstChild,ie=M.nextSibling;return u.style.setProperty("font-size","0.75rem"),u.style.setProperty("color","#64748b"),u.style.setProperty("background-color","rgba(255,255,255,0.8)"),u.style.setProperty("padding","0.25rem 0.5rem"),u.style.setProperty("border-radius","0.375rem"),r(ie,()=>o.accountExpression),u}}),null),S.$$click=()=>pe(s()),S.style.setProperty("background","rgba(239, 68, 68, 0.1)"),S.style.setProperty("border","none"),S.style.setProperty("color","#dc2626"),S.style.setProperty("padding","0.375rem 0.625rem"),S.style.setProperty("border-radius","0.375rem"),S.style.setProperty("cursor","pointer"),S.style.setProperty("font-size","0.75rem"),S.style.setProperty("font-weight","500"),S.style.setProperty("display","flex"),S.style.setProperty("align-items","center"),S.style.setProperty("gap","0.25rem"),S.style.setProperty("transition","all 0.2s"),$.style.setProperty("padding","1rem"),re.style.setProperty("margin-bottom","1rem"),ee.style.setProperty("display","block"),ee.style.setProperty("font-size","0.75rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","#374151"),ee.style.setProperty("margin-bottom","0.375rem"),ee.style.setProperty("text-transform","uppercase"),ee.style.setProperty("letter-spacing","0.025em"),r(ee,()=>t("eventAutomation.builder.journalTemplate.account")),r(re,f(ur,{get selectedAccountId(){return o.accountId},onSelect:u=>{k(s(),"accountExpression",u?.accountNumber),k(s(),"accountId",u?.id)},get placeholder(){return t("eventAutomation.builder.journalTemplate.selectAccount")}}),null),r($,f(Q,{get when(){return A().eventType},get children(){var u=hs(),M=u.firstChild,ie=M.firstChild,Me=M.nextSibling,Je=Me.firstChild,mt=Me.nextSibling,Se=mt.firstChild;return u.style.setProperty("display","grid"),u.style.setProperty("grid-template-columns","1fr 1fr 1fr"),u.style.setProperty("gap","1rem"),ie.style.setProperty("display","block"),ie.style.setProperty("font-size","0.75rem"),ie.style.setProperty("font-weight","600"),ie.style.setProperty("color","#374151"),ie.style.setProperty("margin-bottom","0.375rem"),ie.style.setProperty("text-transform","uppercase"),ie.style.setProperty("letter-spacing","0.025em"),r(M,f(kt,{get value(){return o.descriptionTemplate},onChange:Xe=>k(s(),"descriptionTemplate",Xe),get eventType(){return A().eventType},placeholder:"ej: Venta {data.customerName}",type:"template",get customFields(){return O()}}),null),Je.style.setProperty("display","block"),Je.style.setProperty("font-size","0.75rem"),Je.style.setProperty("font-weight","600"),Je.style.setProperty("color","#374151"),Je.style.setProperty("margin-bottom","0.375rem"),Je.style.setProperty("text-transform","uppercase"),Je.style.setProperty("letter-spacing","0.025em"),r(Me,f(kt,{get value(){return o.amountExpression},onChange:Xe=>k(s(),"amountExpression",Xe),get eventType(){return A().eventType},placeholder:"ej: data.total",type:"expression",get customFields(){return O()}}),null),Se.style.setProperty("display","block"),Se.style.setProperty("font-size","0.75rem"),Se.style.setProperty("font-weight","600"),Se.style.setProperty("color","#374151"),Se.style.setProperty("margin-bottom","0.375rem"),Se.style.setProperty("text-transform","uppercase"),Se.style.setProperty("letter-spacing","0.025em"),r(mt,f(kt,{get value(){return o.documentExpression||""},onChange:Xe=>k(s(),"documentExpression",Xe),get eventType(){return A().eventType},placeholder:"ej: {data.invoice}",type:"template",get customFields(){return O()}}),null),u}}),Ae),Ae.style.setProperty("margin-top","1rem"),Ae.style.setProperty("background-color","#f8fafc"),Ae.style.setProperty("border-radius","0.5rem"),Ae.style.setProperty("overflow","hidden"),he.style.setProperty("display","flex"),he.style.setProperty("justify-content","space-between"),he.style.setProperty("align-items","center"),he.style.setProperty("padding","0.625rem 0.75rem"),he.style.setProperty("background-color","#f1f5f9"),X.style.setProperty("display","flex"),X.style.setProperty("align-items","center"),X.style.setProperty("gap","0.5rem"),Pe.style.setProperty("font-size","0.8rem"),ut.style.setProperty("font-size","0.75rem"),ut.style.setProperty("font-weight","600"),ut.style.setProperty("color","#475569"),r(X,f(Q,{get when(){return(o.conditions?.length||0)>0},get children(){var u=Ps();return u.style.setProperty("background-color","#3b82f6"),u.style.setProperty("color","white"),u.style.setProperty("font-size","0.625rem"),u.style.setProperty("padding","0.125rem 0.375rem"),u.style.setProperty("border-radius","9999px"),u.style.setProperty("font-weight","600"),r(u,()=>o.conditions?.length),u}}),null),Te.$$click=()=>P(s()),Te.style.setProperty("background","linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)"),Te.style.setProperty("border","none"),Te.style.setProperty("color","white"),Te.style.setProperty("padding","0.25rem 0.625rem"),Te.style.setProperty("border-radius","0.375rem"),Te.style.setProperty("font-size","0.7rem"),Te.style.setProperty("font-weight","600"),Te.style.setProperty("cursor","pointer"),Te.style.setProperty("display","flex"),Te.style.setProperty("align-items","center"),Te.style.setProperty("gap","0.25rem"),r(Ae,f(Q,{get when(){return(o.conditions?.length||0)===0},get children(){var u=xs();return u.style.setProperty("padding","0.75rem"),u.style.setProperty("text-align","center"),u.style.setProperty("color","#94a3b8"),u.style.setProperty("font-size","0.75rem"),u}}),null),r(Ae,f(Q,{get when(){return(o.conditions?.length||0)>0},get children(){var u=$s();return u.style.setProperty("padding","0.75rem"),u.style.setProperty("display","flex"),u.style.setProperty("flex-direction","column"),u.style.setProperty("gap","0.5rem"),r(u,f(Oe,{get each(){return o.conditions||[]},children:(M,ie)=>(()=>{var Me=As(),Je=Me.firstChild,mt=Je.nextSibling,Se=mt.firstChild,Xe=mt.nextSibling,et=Xe.nextSibling;return Me.style.setProperty("display","flex"),Me.style.setProperty("align-items","center"),Me.style.setProperty("gap","0.5rem"),Me.style.setProperty("padding","0.5rem"),Me.style.setProperty("background-color","white"),Me.style.setProperty("border-radius","0.375rem"),Me.style.setProperty("border","1px solid #e2e8f0"),Je.style.setProperty("flex","2"),r(Je,f(kt,{get value(){return M.field},onChange:xe=>{I(s(),ie(),"field",xe);const Ct=W().find(ir=>ir.path===xe);Ct&&I(s(),ie(),"dataType",Ct.definition.type)},get eventType(){return A().eventType},placeholder:"Campo",type:"expression",get customFields(){return O()},style:{"font-size":"0.75rem"}})),mt.style.setProperty("flex","1"),Se.addEventListener("change",xe=>I(s(),ie(),"operator",xe.currentTarget.value)),Se.style.setProperty("width","100%"),Se.style.setProperty("padding","0.5rem"),Se.style.setProperty("border","1px solid #d1d5db"),Se.style.setProperty("border-radius","0.375rem"),Se.style.setProperty("font-size","0.75rem"),Se.style.setProperty("background-color","white"),r(Se,f(Oe,{each:$e,children:xe=>(()=>{var Ct=Mt();return r(Ct,()=>xe.label),te(()=>Ct.value=xe.value),Ct})()})),Xe.style.setProperty("flex","1"),r(Xe,f(Q,{get when(){return M.operator!=="exists"&&M.operator!=="notExists"},get fallback(){return(()=>{var xe=Qt();return xe.style.setProperty("width","100%"),xe.style.setProperty("padding","0.5rem"),xe.style.setProperty("border","1px solid #d1d5db"),xe.style.setProperty("border-radius","0.375rem"),xe.style.setProperty("font-size","0.75rem"),xe.style.setProperty("background-color","#f3f4f6"),xe.style.setProperty("color","#9ca3af"),xe})()},get children(){return f(kt,{get value(){return String(M.value||"")},onChange:xe=>I(s(),ie(),"value",M.dataType==="number"?parseFloat(xe)||0:xe),get eventType(){return A().eventType},get placeholder(){return M.dataType==="number"?"0":"Valor"},type:"expression",get customFields(){return O()},style:{"font-size":"0.75rem"}})}})),et.$$click=()=>le(s(),ie()),et.style.setProperty("background","none"),et.style.setProperty("border","none"),et.style.setProperty("color","#ef4444"),et.style.setProperty("cursor","pointer"),et.style.setProperty("padding","0.375rem"),et.style.setProperty("border-radius","0.25rem"),et.style.setProperty("font-size","0.875rem"),et.style.setProperty("line-height","1"),te(()=>Se.value=M.operator),Me})()})),u}}),null),r(p,f(Q,{get when(){return o.amountExpression||o.documentExpression},get children(){var u=ws();return u.firstChild,u.style.setProperty("padding","0.5rem 1rem"),u.style.setProperty("background-color","#f8fafc"),u.style.setProperty("border-top","1px solid #e2e8f0"),u.style.setProperty("display","flex"),u.style.setProperty("align-items","center"),u.style.setProperty("gap","0.75rem"),u.style.setProperty("font-size","0.75rem"),u.style.setProperty("color","#64748b"),r(u,f(Q,{get when(){return o.amountExpression},get children(){var M=_s(),ie=M.firstChild;return M.style.setProperty("background-color","#e2e8f0"),M.style.setProperty("padding","0.125rem 0.375rem"),M.style.setProperty("border-radius","0.25rem"),M.style.setProperty("font-size","0.7rem"),r(M,()=>o.isDebit?"DÃ©bito":"CrÃ©dito",ie),r(M,()=>o.amountExpression,null),M}}),null),r(u,f(Q,{get when(){return o.documentExpression},get children(){var M=Ss();return M.firstChild,M.style.setProperty("background-color","#dbeafe"),M.style.setProperty("padding","0.125rem 0.375rem"),M.style.setProperty("border-radius","0.25rem"),M.style.setProperty("font-size","0.7rem"),M.style.setProperty("color","#1e40af"),r(M,()=>o.documentExpression,null),M}}),null),u}}),null),te(u=>{var M=`2px solid ${o.isDebit?"#10b981":"#f59e0b"}`,ie=o.isDebit?"linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%)":"linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%)",Me=`1px solid ${o.isDebit?"#a7f3d0":"#fde68a"}`,Je=o.isDebit?"#10b981":"#f59e0b",mt=o.isDebit?"#10b981":"transparent",Se=o.isDebit?"white":"#6b7280",Xe=o.isDebit?"transparent":"#f59e0b",et=o.isDebit?"#6b7280":"white",xe=(o.conditions?.length||0)>0?"1px solid #e2e8f0":"none";return M!==u.e&&((u.e=M)!=null?p.style.setProperty("border",M):p.style.removeProperty("border")),ie!==u.t&&((u.t=ie)!=null?y.style.setProperty("background",ie):y.style.removeProperty("background")),Me!==u.a&&((u.a=Me)!=null?y.style.setProperty("border-bottom",Me):y.style.removeProperty("border-bottom")),Je!==u.o&&((u.o=Je)!=null?b.style.setProperty("background-color",Je):b.style.removeProperty("background-color")),mt!==u.i&&((u.i=mt)!=null?N.style.setProperty("background-color",mt):N.style.removeProperty("background-color")),Se!==u.n&&((u.n=Se)!=null?N.style.setProperty("color",Se):N.style.removeProperty("color")),Xe!==u.s&&((u.s=Xe)!=null?v.style.setProperty("background-color",Xe):v.style.removeProperty("background-color")),et!==u.h&&((u.h=et)!=null?v.style.setProperty("color",et):v.style.removeProperty("color")),xe!==u.r&&((u.r=xe)!=null?he.style.setProperty("border-bottom",xe):he.style.removeProperty("border-bottom")),u},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),p})()})),ot.style.setProperty("display","flex"),ot.style.setProperty("justify-content","space-between"),ot.style.setProperty("align-items","center"),ot.style.setProperty("border-top","1px solid #e5e7eb"),ot.style.setProperty("padding-top","1.5rem"),ot.style.setProperty("margin-top","2rem"),r(wt,f(Q,{get when(){return O().length>0||A().journalEntryTemplate?.lines.length>0},get children(){var o=ys();return o.style.setProperty("font-size","0.875rem"),o.style.setProperty("color","#6b7280"),o}})),yt.style.setProperty("display","flex"),yt.style.setProperty("gap","1rem"),tr(bt,"click",e.onCancel,!0),r(bt,()=>t("eventAutomation.builder.cancel")),ht.$$click=ge,r(ht,(()=>{var o=qe(()=>!!l());return()=>o()?t("eventAutomation.builder.update"):t("eventAutomation.builder.save")})()),r(c,f(Q,{get when(){return K()},get children(){var o=us(),s=o.firstChild;return o.style.setProperty("position","fixed"),o.style.setProperty("top","0"),o.style.setProperty("left","0"),o.style.setProperty("right","0"),o.style.setProperty("bottom","0"),o.style.setProperty("background-color","rgba(0, 0, 0, 0.6)"),o.style.setProperty("display","flex"),o.style.setProperty("align-items","center"),o.style.setProperty("justify-content","center"),o.style.setProperty("z-index","1100"),o.style.setProperty("padding","2rem"),s.style.setProperty("width","100%"),s.style.setProperty("max-width","1440px"),s.style.setProperty("max-height","96vh"),r(s,f(Zr,{get eventType(){return A().eventType||"invoice_completed"},get journalLines(){return A().journalEntryTemplate?.lines||[]},onAddCondition:p=>{const y={field:p,operator:"exists",value:"",dataType:"string"};V(F=>({...F,conditions:[...F.conditions||[],y]}))},onSetDescription:p=>{const y=A().journalEntryTemplate?.description||"";Ee("description",y?`${y} ${p}`:p)},onSetAmount:(p,y)=>{const F=A().journalEntryTemplate?.lines||[];y>=0&&y<F.length&&k(y,"amountExpression",p)},onSetLineDescription:(p,y)=>{const F=A().journalEntryTemplate?.lines||[];if(y>=0&&y<F.length){const b=F[y].descriptionTemplate||"";k(y,"descriptionTemplate",b?`${b} ${p}`:p)}},onSetReference:p=>{const y=A().journalEntryTemplate?.reference||"";Ee("reference",y?`${y} ${p}`:p)},onAddLine:(p,y,F)=>{const b={accountExpression:"1001",descriptionTemplate:y||"",amountExpression:p,documentExpression:"",isDebit:!0,conditions:F||[]};V(B=>({...B,journalEntryTemplate:{...B.journalEntryTemplate,lines:[...B.journalEntryTemplate?.lines||[],b]}})),console.log("[RuleDraft] New line added with amount:",p)},onAddCustomField:(p,y,F)=>{const b={id:`custom_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:p,expression:y,description:F||""};ve(B=>[...B,b]),V(B=>({...B,customFields:[...B.customFields||[],b]})),console.log("[RuleDraft] Custom field added:",b.name)},onClose:()=>Z(!1)})),o}}),null),te(o=>{var s=ue,p=fe,y=x,F=t("eventAutomation.builder.ruleNamePlaceholder"),b=x,B={...x,height:"4rem",resize:"vertical"},N=t("eventAutomation.builder.descriptionPlaceholder"),v=h,S=fe,$=de,re={...Y,"font-size":"0.875rem",background:"linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%)"},ee=de,Ae=de,he=Y;return o.e=L(c,s,o.e),o.t=L(d,p,o.t),o.a=L(Be,y,o.a),F!==o.o&&Dt(Be,"placeholder",o.o=F),o.i=L(Le,b,o.i),o.n=L(st,B,o.n),N!==o.s&&Dt(st,"placeholder",o.s=N),o.h=L(Qe,v,o.h),o.r=L(vt,S,o.r),o.d=L($t,$,o.d),o.l=L(Re,re,o.l),o.u=L(_t,ee,o.u),o.c=L(bt,Ae,o.c),o.w=L(ht,he,o.w),o},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),te(()=>Be.value=A().name||""),te(()=>Le.value=A().priority||100),te(()=>st.value=A().description||""),te(()=>Qe.value=A().eventType||""),te(()=>Ve.checked=A().isActive??!0),c})()};Lt(["click","input"]);var Es=E("<div><p>Loading rules..."),Ds=E("<div><p>Failed to load rules. Please refresh the page."),ks=E("<div><p></p><button>"),Is=E("<div><div><h2></h2><button>+ "),Kt=E("<div>"),Xt=E("<div><h2>"),Ls=E("<div><div><h1></h1><p></p></div><div><button> (<!>)</button><button></button><button>"),Rs=E("<div><div><div><div><h3></h3><span></span><span></span></div><p></p><div><div><strong>:</strong></div><div><strong>:</strong><div> <!> - </div></div></div></div><div><button></button><button></button><button>"),Fs=E("<div> <!> "),Ns=E("<span>"),zs=E("<div><div><h3></h3><span></span></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><details><summary></summary><pre>"),js=E("<div><strong>:</strong> "),Ms=E("<div><div><div><h3></h3><span></span></div><span></span></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> <!> ");const qs=()=>{const{t:e}=zt(),[t,l]=H("rules"),[n,C]=H(null),[U,m]=H(!1),[q,ae]=H(""),[O,{refetch:ve}]=mr(()=>Pt.getAll(),{initialValue:[]}),K=()=>er.getHistory(50),Z=()=>Nt.getAuditLog(50);e("eventAutomation.eventTypes.invoice_completed"),e("eventAutomation.categories.financial"),e("eventAutomation.eventTypes.invoice_created"),e("eventAutomation.categories.financial"),e("eventAutomation.eventTypes.invoice_updated"),e("eventAutomation.categories.financial"),e("eventAutomation.eventTypes.payment_received"),e("eventAutomation.categories.financial"),e("eventAutomation.eventTypes.inventory_received"),e("eventAutomation.categories.inventory"),e("eventAutomation.eventTypes.inventory_sold"),e("eventAutomation.categories.inventory"),e("eventAutomation.eventTypes.inventory_adjusted"),e("eventAutomation.categories.inventory"),e("eventAutomation.eventTypes.expense_created"),e("eventAutomation.categories.financial"),e("eventAutomation.eventTypes.expense_approved"),e("eventAutomation.categories.financial"),e("eventAutomation.eventTypes.expense_paid"),e("eventAutomation.categories.financial"),e("eventAutomation.eventTypes.service_rendered"),e("eventAutomation.categories.operational"),e("eventAutomation.eventTypes.freight_processed"),e("eventAutomation.categories.operational"),e("eventAutomation.eventTypes.customs_cleared"),e("eventAutomation.categories.operational");const ce=async D=>{try{console.log(D,n()),n()?await Pt.update(n().id,D):await Pt.create(D),await ve();const W=await Pt.getAll();console.log(W),Nt.syncRules(W),C(null),m(!1)}catch(W){console.error("Failed to save rule:",W),alert("Failed to save rule. Please try again.")}},oe=async D=>{if(confirm(e("common.confirmDelete")))try{await Pt.delete(D),await ve();const W=await Pt.getAll();Nt.syncRules(W)}catch(W){console.error("Failed to delete rule:",W),alert("Failed to delete rule. Please try again.")}},A=D=>new Date(D).toLocaleString(),V=D=>({padding:"0.75rem 1.5rem","background-color":D?"#3b82f6":"transparent",color:D?"white":"#6b7280",border:"none","border-radius":"0.5rem",cursor:"pointer","font-weight":"500",transition:"all 0.2s"}),me={"background-color":"white","border-radius":"0.5rem",padding:"1.5rem","box-shadow":"0 1px 3px 0 rgba(0, 0, 0, 0.1)","margin-bottom":"1rem"},ne={padding:"0.5rem 1rem","background-color":"#3b82f6",color:"white",border:"none","border-radius":"0.375rem",cursor:"pointer","font-weight":"500"},we={...ne,"background-color":"#6b7280"},Ce={...ne,"background-color":"#ef4444"},Fe=async()=>{let D=await gr.getAlls(Ye.getBusinessId());fr.updAccount(D)};Bt(()=>{Fe()});const De=async(D,W)=>{try{await Pt.toggleActive(D,W),await ve();const $e=await Pt.getAll();Nt.syncRules($e)}catch($e){console.error("Failed to toggle rule:",$e),alert("Failed to update rule status. Please try again.")}};return(()=>{var D=Ls(),W=D.firstChild,$e=W.firstChild,tt=$e.nextSibling,be=W.nextSibling,Ee=be.firstChild,He=Ee.firstChild,ke=He.nextSibling;ke.nextSibling;var Ie=Ee.nextSibling,Ne=Ie.nextSibling;return D.style.setProperty("max-width","1200px"),D.style.setProperty("margin","0 auto"),D.style.setProperty("padding","2rem"),W.style.setProperty("margin-bottom","2rem"),$e.style.setProperty("font-size","2rem"),$e.style.setProperty("font-weight","700"),$e.style.setProperty("margin-bottom","0.5rem"),r($e,()=>e("eventAutomation.title")),tt.style.setProperty("color","#6b7280"),r(tt,()=>e("eventAutomation.subtitle")),be.style.setProperty("display","flex"),be.style.setProperty("gap","0.5rem"),be.style.setProperty("margin-bottom","2rem"),Ee.$$click=()=>l("rules"),r(Ee,()=>e("eventAutomation.tabs.rules"),He),r(Ee,(()=>{var k=qe(()=>!O.loading&&!O.error);return()=>k()?O().length:0})(),ke),Ie.$$click=()=>l("events"),r(Ie,()=>e("eventAutomation.tabs.events")),Ne.$$click=()=>l("audit"),r(Ne,()=>e("eventAutomation.tabs.audit")),r(D,f(Q,{get when(){return t()==="rules"},get children(){var k=Is(),P=k.firstChild,I=P.firstChild,le=I.nextSibling;return le.firstChild,P.style.setProperty("display","flex"),P.style.setProperty("justify-content","space-between"),P.style.setProperty("margin-bottom","1.5rem"),I.style.setProperty("font-size","1.25rem"),I.style.setProperty("font-weight","600"),r(I,()=>e("eventAutomation.rules.title")),le.$$click=()=>{Fe(),m(!0)},r(le,()=>e("eventAutomation.rules.createNew"),null),r(k,f(Q,{get when(){return O.loading},get children(){var J=Es(),pe=J.firstChild;return pe.style.setProperty("text-align","center"),pe.style.setProperty("color","#6b7280"),te(ge=>L(J,me,ge)),J}}),null),r(k,f(Q,{get when(){return O.error},get children(){var J=Ds(),pe=J.firstChild;return pe.style.setProperty("text-align","center"),pe.style.setProperty("color","#ef4444"),te(ge=>L(J,me,ge)),J}}),null),r(k,f(Q,{get when(){return qe(()=>!O.loading&&!O.error)()&&O().length===0},get children(){var J=ks(),pe=J.firstChild,ge=pe.nextSibling;return pe.style.setProperty("margin-bottom","1rem"),r(pe,()=>e("eventAutomation.rules.noRules")),ge.$$click=()=>{Fe(),m(!0)},r(ge,()=>e("eventAutomation.rules.createFirst")),te(ue=>{var g={...me,"text-align":"center",padding:"3rem",color:"#6b7280"},x=ne;return ue.e=L(J,g,ue.e),ue.t=L(ge,x,ue.t),ue},{e:void 0,t:void 0}),J}}),null),r(k,f(Oe,{get each(){return qe(()=>!O.loading&&!O.error)()?O():[]},children:J=>(()=>{var pe=Rs(),ge=pe.firstChild,ue=ge.firstChild,g=ue.firstChild,x=g.firstChild,h=x.nextSibling,T=h.nextSibling,Y=g.nextSibling,de=Y.nextSibling,G=de.firstChild,fe=G.firstChild,c=fe.firstChild,w=G.nextSibling,z=w.firstChild,R=z.firstChild,d=z.nextSibling,i=d.firstChild,_=i.nextSibling;_.nextSibling;var j=ue.nextSibling,ye=j.firstChild,rt=ye.nextSibling,Be=rt.nextSibling;return ge.style.setProperty("display","flex"),ge.style.setProperty("justify-content","space-between"),ge.style.setProperty("align-items","start"),ue.style.setProperty("flex","1"),g.style.setProperty("display","flex"),g.style.setProperty("align-items","center"),g.style.setProperty("gap","1rem"),g.style.setProperty("margin-bottom","0.5rem"),x.style.setProperty("font-size","1.125rem"),x.style.setProperty("font-weight","600"),r(x,()=>J.name),h.style.setProperty("padding","0.25rem 0.75rem"),h.style.setProperty("border-radius","0.375rem"),h.style.setProperty("font-size","0.875rem"),h.style.setProperty("font-weight","500"),r(h,(()=>{var se=qe(()=>!!J.isActive);return()=>se()?e("common.active"):e("common.inactive")})()),T.style.setProperty("padding","0.25rem 0.75rem"),T.style.setProperty("background-color","#e5e7eb"),T.style.setProperty("color","#374151"),T.style.setProperty("border-radius","0.375rem"),T.style.setProperty("font-size","0.875rem"),r(T,()=>J.eventType),Y.style.setProperty("color","#6b7280"),Y.style.setProperty("margin-bottom","1rem"),r(Y,()=>J.description),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("color","#4b5563"),G.style.setProperty("margin-bottom","0.5rem"),r(fe,()=>e("eventAutomation.rules.conditions"),c),r(G,f(Oe,{get each(){return J.conditions},children:(se,_e)=>(()=>{var Le=Fs(),Ue=Le.firstChild,Ge=Ue.nextSibling;return Ge.nextSibling,Le.style.setProperty("margin-left","1rem"),r(Le,()=>_e()>0&&"AND ",Ue),r(Le,()=>se.field,Ue),r(Le,()=>se.operator,Ge),r(Le,()=>se.value,null),Le})()}),null),r(G,(()=>{var se=qe(()=>J?.conditions?.length===0);return()=>se()&&(()=>{var _e=Ns();return _e.style.setProperty("margin-left","1rem"),r(_e,()=>e("eventAutomation.rules.alwaysTriggers")),_e})()})(),null),r(z,()=>e("eventAutomation.rules.journalEntry"),R),d.style.setProperty("margin-left","1rem"),r(d,()=>J.journalEntryTemplate?.lines?.length,i),r(d,()=>e("eventAutomation.rules.lines"),_),r(d,()=>J?.journalEntryTemplate?.description,null),j.style.setProperty("display","flex"),j.style.setProperty("gap","0.5rem"),ye.$$click=()=>De(J.id,!J.isActive),r(ye,(()=>{var se=qe(()=>!!J.isActive);return()=>se()?e("eventAutomation.rules.disable"):e("eventAutomation.rules.enable")})()),rt.$$click=()=>{Fe(),C(J)},r(rt,()=>e("common.edit")),Be.$$click=()=>oe(J.id),r(Be,()=>e("common.delete")),te(se=>{var _e=me,Le=J.isActive?"#d1fae5":"#fee2e2",Ue=J.isActive?"#065f46":"#991b1b",Ge=we,gt=ne,st=Ce;return se.e=L(pe,_e,se.e),Le!==se.t&&((se.t=Le)!=null?h.style.setProperty("background-color",Le):h.style.removeProperty("background-color")),Ue!==se.a&&((se.a=Ue)!=null?h.style.setProperty("color",Ue):h.style.removeProperty("color")),se.o=L(ye,Ge,se.o),se.i=L(rt,gt,se.i),se.n=L(Be,st,se.n),se},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),pe})()}),null),te(J=>L(le,ne,J)),k}}),null),r(D,f(Q,{get when(){return t()==="events"},get children(){var k=Xt(),P=k.firstChild;return P.style.setProperty("font-size","1.25rem"),P.style.setProperty("font-weight","600"),P.style.setProperty("margin-bottom","1.5rem"),r(P,()=>e("eventAutomation.events.title")),r(k,f(Q,{get when(){return K().length===0},get children(){var I=Kt();return r(I,()=>e("eventAutomation.events.noEvents")),te(le=>L(I,{...me,"text-align":"center",color:"#6b7280"},le)),I}}),null),r(k,f(Oe,{get each(){return K()},children:I=>(()=>{var le=zs(),J=le.firstChild,pe=J.firstChild,ge=pe.nextSibling,ue=J.nextSibling,g=ue.firstChild,x=g.firstChild,h=x.firstChild;x.nextSibling;var T=g.nextSibling,Y=T.firstChild,de=Y.firstChild;Y.nextSibling;var G=T.nextSibling,fe=G.firstChild,c=fe.nextSibling;return J.style.setProperty("display","flex"),J.style.setProperty("justify-content","space-between"),J.style.setProperty("margin-bottom","0.5rem"),pe.style.setProperty("font-size","1rem"),pe.style.setProperty("font-weight","600"),r(pe,()=>I.type),ge.style.setProperty("font-size","0.875rem"),ge.style.setProperty("color","#6b7280"),r(ge,()=>A(I.timestamp)),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("color","#4b5563"),r(x,()=>e("eventAutomation.events.source"),h),r(g,()=>I.source,null),r(Y,()=>e("eventAutomation.events.eventId"),de),r(T,()=>I.id,null),G.style.setProperty("margin-top","0.5rem"),fe.style.setProperty("cursor","pointer"),r(fe,()=>e("eventAutomation.events.viewData")),c.style.setProperty("margin-top","0.5rem"),c.style.setProperty("padding","0.5rem"),c.style.setProperty("background-color","#f3f4f6"),c.style.setProperty("border-radius","0.25rem"),c.style.setProperty("overflow","auto"),c.style.setProperty("font-size","0.75rem"),r(c,()=>JSON.stringify(I.data,null,2)),te(w=>L(le,me,w)),le})()}),null),k}}),null),r(D,f(Q,{get when(){return t()==="audit"},get children(){var k=Xt(),P=k.firstChild;return P.style.setProperty("font-size","1.25rem"),P.style.setProperty("font-weight","600"),P.style.setProperty("margin-bottom","1.5rem"),r(P,()=>e("eventAutomation.audit.title")),r(k,f(Q,{get when(){return Z().length===0},get children(){var I=Kt();return r(I,()=>e("eventAutomation.audit.noActivity")),te(le=>L(I,{...me,"text-align":"center",color:"#6b7280"},le)),I}}),null),r(k,f(Oe,{get each(){return Z()},children:I=>(()=>{var le=Ms(),J=le.firstChild,pe=J.firstChild,ge=pe.firstChild,ue=ge.nextSibling,g=pe.nextSibling,x=J.nextSibling,h=x.firstChild,T=h.firstChild,Y=T.firstChild;T.nextSibling;var de=h.nextSibling,G=de.firstChild,fe=G.firstChild;G.nextSibling;var c=de.nextSibling,w=c.firstChild,z=w.firstChild,R=w.nextSibling,d=R.nextSibling;return d.nextSibling,J.style.setProperty("display","flex"),J.style.setProperty("justify-content","space-between"),J.style.setProperty("margin-bottom","0.5rem"),pe.style.setProperty("display","flex"),pe.style.setProperty("align-items","center"),pe.style.setProperty("gap","1rem"),ge.style.setProperty("font-size","1rem"),ge.style.setProperty("font-weight","600"),r(ge,()=>I.eventType),ue.style.setProperty("padding","0.25rem 0.75rem"),ue.style.setProperty("border-radius","0.375rem"),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("font-weight","500"),r(ue,(()=>{var i=qe(()=>!!I.success);return()=>i()?e("eventAutomation.audit.success"):e("eventAutomation.audit.failed")})()),g.style.setProperty("font-size","0.875rem"),g.style.setProperty("color","#6b7280"),r(g,()=>A(I.timestamp)),x.style.setProperty("font-size","0.875rem"),x.style.setProperty("color","#4b5563"),r(T,()=>e("eventAutomation.audit.eventId"),Y),r(h,()=>I.eventId,null),r(G,()=>e("eventAutomation.audit.rulesTriggered"),fe),r(de,()=>I.rulesTriggered.join(", ")||e("common.none"),null),r(w,()=>e("eventAutomation.audit.entriesCreated"),z),r(c,()=>I.entriesCreated.length,d),r(c,()=>e("eventAutomation.audit.journalEntries"),null),r(x,f(Q,{get when(){return I.error},get children(){var i=js(),_=i.firstChild,j=_.firstChild;return _.nextSibling,i.style.setProperty("color","#dc2626"),i.style.setProperty("margin-top","0.5rem"),r(_,()=>e("eventAutomation.audit.error"),j),r(i,()=>I.error,null),i}}),null),te(i=>{var _=me,j=I.success?"#d1fae5":"#fee2e2",ye=I.success?"#065f46":"#991b1b";return i.e=L(le,_,i.e),j!==i.t&&((i.t=j)!=null?ue.style.setProperty("background-color",j):ue.style.removeProperty("background-color")),ye!==i.a&&((i.a=ye)!=null?ue.style.setProperty("color",ye):ue.style.removeProperty("color")),i},{e:void 0,t:void 0,a:void 0}),le})()}),null),k}}),null),r(D,f(Q,{get when(){return U()||n()},get children(){return f(Ts,{get rule(){return n()},onSave:ce,onCancel:()=>{m(!1),C(null)}})}}),null),te(k=>{var P=V(t()==="rules"),I=V(t()==="events"),le=V(t()==="audit");return k.e=L(Ee,P,k.e),k.t=L(Ie,I,k.t),k.a=L(Ne,le,k.a),k},{e:void 0,t:void 0,a:void 0}),D})()};Lt(["click"]);export{qs as default};
