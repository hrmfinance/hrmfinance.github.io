(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const J_=!1,Q_=(t,e)=>t===e,Do=Symbol("solid-proxy"),b1=typeof Proxy=="function",$p=Symbol("solid-track"),uh={equals:Q_};let _1=$1;const Oa=1,dh=2,w1={owned:null,cleanups:null,context:null,owner:null};var Jr=null;let Nf=null,X_=null,un=null,xi=null,Ts=null,Vh=0;function cu(t,e){const r=un,n=Jr,i=t.length===0,o=e===void 0?n:e,s=i?w1:{owned:null,cleanups:null,context:o?o.context:null,owner:o},a=i?t:()=>t(()=>to(()=>xu(s)));Jr=s,un=null;try{return Ba(a,!0)}finally{un=r,Jr=n}}function $e(t,e){e=e?Object.assign({},uh,e):uh;const r={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},n=i=>(typeof i=="function"&&(i=i(r.value)),I1(r,i));return[C1.bind(r),n]}function Se(t,e,r){const n=$m(t,e,!1,Oa);Vu(n)}function vo(t,e,r){_1=rw;const n=$m(t,e,!1,Oa);n.user=!0,Ts?Ts.push(n):Vu(n)}function Nt(t,e,r){r=r?Object.assign({},uh,r):uh;const n=$m(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,Vu(n),C1.bind(n)}function S1(t){return Ba(t,!1)}function to(t){if(un===null)return t();const e=un;un=null;try{return t()}finally{un=e}}function Am(t,e,r){const n=Array.isArray(t);let i,o=r&&r.defer;return s=>{let a;if(n){a=Array(t.length);for(let u=0;u<t.length;u++)a[u]=t[u]()}else a=t();if(o)return o=!1,s;const c=to(()=>e(a,i,s));return i=a,c}}function Nn(t){vo(()=>to(t))}function Pc(t){return Jr===null||(Jr.cleanups===null?Jr.cleanups=[t]:Jr.cleanups.push(t)),t}function kp(){return un}function P1(){return Jr}function x1(t,e){const r=Jr,n=un;Jr=t,un=null;try{return Ba(e,!0)}catch(i){km(i)}finally{Jr=r,un=n}}function Z_(t){const e=un,r=Jr;return Promise.resolve().then(()=>{un=e,Jr=r;let n;return Ba(t,!1),un=Jr=null,n?n.done:void 0})}const[tR,rR]=$e(!1);function A1(t,e){const r=Symbol("context");return{id:r,Provider:iw(r),defaultValue:t}}function Cm(t){let e;return Jr&&Jr.context&&(e=Jr.context[t.id])!==void 0?e:t.defaultValue}function Im(t){const e=Nt(t),r=Nt(()=>Ep(e()));return r.toArray=()=>{const n=r();return Array.isArray(n)?n:n!=null?[n]:[]},r}function C1(){if(this.sources&&this.state)if(this.state===Oa)Vu(this);else{const t=xi;xi=null,Ba(()=>fh(this),!1),xi=t}if(un){const t=this.observers?this.observers.length:0;un.sources?(un.sources.push(this),un.sourceSlots.push(t)):(un.sources=[this],un.sourceSlots=[t]),this.observers?(this.observers.push(un),this.observerSlots.push(un.sources.length-1)):(this.observers=[un],this.observerSlots=[un.sources.length-1])}return this.value}function I1(t,e,r){let n=t.value;return(!t.comparator||!t.comparator(n,e))&&(t.value=e,t.observers&&t.observers.length&&Ba(()=>{for(let i=0;i<t.observers.length;i+=1){const o=t.observers[i],s=Nf&&Nf.running;s&&Nf.disposed.has(o),(s?!o.tState:!o.state)&&(o.pure?xi.push(o):Ts.push(o),o.observers&&k1(o)),s||(o.state=Oa)}if(xi.length>1e6)throw xi=[],new Error},!1)),e}function Vu(t){if(!t.fn)return;xu(t);const e=Vh;ew(t,t.value,e)}function ew(t,e,r){let n;const i=Jr,o=un;un=Jr=t;try{n=t.fn(e)}catch(s){return t.pure&&(t.state=Oa,t.owned&&t.owned.forEach(xu),t.owned=null),t.updatedAt=r+1,km(s)}finally{un=o,Jr=i}(!t.updatedAt||t.updatedAt<=r)&&(t.updatedAt!=null&&"observers"in t?I1(t,n):t.value=n,t.updatedAt=r)}function $m(t,e,r,n=Oa,i){const o={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:Jr,context:Jr?Jr.context:null,pure:r};return Jr===null||Jr!==w1&&(Jr.owned?Jr.owned.push(o):Jr.owned=[o]),o}function hh(t){if(t.state===0)return;if(t.state===dh)return fh(t);if(t.suspense&&to(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<Vh);)t.state&&e.push(t);for(let r=e.length-1;r>=0;r--)if(t=e[r],t.state===Oa)Vu(t);else if(t.state===dh){const n=xi;xi=null,Ba(()=>fh(t,e[0]),!1),xi=n}}function Ba(t,e){if(xi)return t();let r=!1;e||(xi=[]),Ts?r=!0:Ts=[],Vh++;try{const n=t();return tw(r),n}catch(n){r||(Ts=null),xi=null,km(n)}}function tw(t){if(xi&&($1(xi),xi=null),t)return;const e=Ts;Ts=null,e.length&&Ba(()=>_1(e),!1)}function $1(t){for(let e=0;e<t.length;e++)hh(t[e])}function rw(t){let e,r=0;for(e=0;e<t.length;e++){const n=t[e];n.user?t[r++]=n:hh(n)}for(e=0;e<r;e++)hh(t[e])}function fh(t,e){t.state=0;for(let r=0;r<t.sources.length;r+=1){const n=t.sources[r];if(n.sources){const i=n.state;i===Oa?n!==e&&(!n.updatedAt||n.updatedAt<Vh)&&hh(n):i===dh&&fh(n,e)}}}function k1(t){for(let e=0;e<t.observers.length;e+=1){const r=t.observers[e];r.state||(r.state=dh,r.pure?xi.push(r):Ts.push(r),r.observers&&k1(r))}}function xu(t){let e;if(t.sources)for(;t.sources.length;){const r=t.sources.pop(),n=t.sourceSlots.pop(),i=r.observers;if(i&&i.length){const o=i.pop(),s=r.observerSlots.pop();n<i.length&&(o.sourceSlots[s]=n,i[n]=o,r.observerSlots[n]=s)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)xu(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)xu(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function nw(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function km(t,e=Jr){throw nw(t)}function Ep(t){if(typeof t=="function"&&!t.length)return Ep(t());if(Array.isArray(t)){const e=[];for(let r=0;r<t.length;r++){const n=Ep(t[r]);Array.isArray(n)?e.push.apply(e,n):e.push(n)}return e}return t}function iw(t,e){return function(n){let i;return Se(()=>i=to(()=>(Jr.context={...Jr.context,[t]:n.value},Im(()=>n.children))),void 0),i}}const ow=Symbol("fallback");function pg(t){for(let e=0;e<t.length;e++)t[e]()}function sw(t,e,r={}){let n=[],i=[],o=[],s=0,a=e.length>1?[]:null;return Pc(()=>pg(o)),()=>{let c=t()||[],u=c.length,f,y;return c[$p],to(()=>{let p,I,P,w,x,j,ne,Q,K;if(u===0)s!==0&&(pg(o),o=[],n=[],i=[],s=0,a&&(a=[])),r.fallback&&(n=[ow],i[0]=cu(Z=>(o[0]=Z,r.fallback())),s=1);else if(s===0){for(i=new Array(u),y=0;y<u;y++)n[y]=c[y],i[y]=cu(v);s=u}else{for(P=new Array(u),w=new Array(u),a&&(x=new Array(u)),j=0,ne=Math.min(s,u);j<ne&&n[j]===c[j];j++);for(ne=s-1,Q=u-1;ne>=j&&Q>=j&&n[ne]===c[Q];ne--,Q--)P[Q]=i[ne],w[Q]=o[ne],a&&(x[Q]=a[ne]);for(p=new Map,I=new Array(Q+1),y=Q;y>=j;y--)K=c[y],f=p.get(K),I[y]=f===void 0?-1:f,p.set(K,y);for(f=j;f<=ne;f++)K=n[f],y=p.get(K),y!==void 0&&y!==-1?(P[y]=i[f],w[y]=o[f],a&&(x[y]=a[f]),y=I[y],p.set(K,y)):o[f]();for(y=j;y<u;y++)y in P?(i[y]=P[y],o[y]=w[y],a&&(a[y]=x[y],a[y](y))):i[y]=cu(v);i=i.slice(0,s=u),n=c.slice(0)}return i});function v(p){if(o[y]=p,a){const[I,P]=$e(y);return a[y]=P,e(c[y],I)}return e(c[y])}}}function B(t,e){return to(()=>t(e||{}))}function Ad(){return!0}const Tp={get(t,e,r){return e===Do?r:t.get(e)},has(t,e){return e===Do?!0:t.has(e)},set:Ad,deleteProperty:Ad,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:Ad,deleteProperty:Ad}},ownKeys(t){return t.keys()}};function Lf(t){return(t=typeof t=="function"?t():t)?t:{}}function aw(){for(let t=0,e=this.length;t<e;++t){const r=this[t]();if(r!==void 0)return r}}function Np(...t){let e=!1;for(let s=0;s<t.length;s++){const a=t[s];e=e||!!a&&Do in a,t[s]=typeof a=="function"?(e=!0,Nt(a)):a}if(b1&&e)return new Proxy({get(s){for(let a=t.length-1;a>=0;a--){const c=Lf(t[a])[s];if(c!==void 0)return c}},has(s){for(let a=t.length-1;a>=0;a--)if(s in Lf(t[a]))return!0;return!1},keys(){const s=[];for(let a=0;a<t.length;a++)s.push(...Object.keys(Lf(t[a])));return[...new Set(s)]}},Tp);const r={},n=Object.create(null);for(let s=t.length-1;s>=0;s--){const a=t[s];if(!a)continue;const c=Object.getOwnPropertyNames(a);for(let u=c.length-1;u>=0;u--){const f=c[u];if(f==="__proto__"||f==="constructor")continue;const y=Object.getOwnPropertyDescriptor(a,f);if(!n[f])n[f]=y.get?{enumerable:!0,configurable:!0,get:aw.bind(r[f]=[y.get.bind(a)])}:y.value!==void 0?y:void 0;else{const v=r[f];v&&(y.get?v.push(y.get.bind(a)):y.value!==void 0&&v.push(()=>y.value))}}}const i={},o=Object.keys(n);for(let s=o.length-1;s>=0;s--){const a=o[s],c=n[a];c&&c.get?Object.defineProperty(i,a,c):i[a]=c?c.value:void 0}return i}function lw(t,...e){if(b1&&Do in t){const i=new Set(e.length>1?e.flat():e[0]),o=e.map(s=>new Proxy({get(a){return s.includes(a)?t[a]:void 0},has(a){return s.includes(a)&&a in t},keys(){return s.filter(a=>a in t)}},Tp));return o.push(new Proxy({get(s){return i.has(s)?void 0:t[s]},has(s){return i.has(s)?!1:s in t},keys(){return Object.keys(t).filter(s=>!i.has(s))}},Tp)),o}const r={},n=e.map(()=>({}));for(const i of Object.getOwnPropertyNames(t)){const o=Object.getOwnPropertyDescriptor(t,i),s=!o.get&&!o.set&&o.enumerable&&o.writable&&o.configurable;let a=!1,c=0;for(const u of e)u.includes(i)&&(a=!0,s?n[c][i]=o.value:Object.defineProperty(n[c],i,o)),++c;a||(s?r[i]=o.value:Object.defineProperty(r,i,o))}return[...n,r]}const cw=t=>`Stale read from <${t}>.`;function Ht(t){const e="fallback"in t&&{fallback:()=>t.fallback};return Nt(sw(()=>t.each,t.children,e||void 0))}function Ge(t){const e=t.keyed,r=Nt(()=>t.when,void 0,void 0),n=e?r:Nt(r,void 0,{equals:(i,o)=>!i==!o});return Nt(()=>{const i=n();if(i){const o=t.children;return typeof o=="function"&&o.length>0?to(()=>o(e?i:()=>{if(!to(n))throw cw("Show");return r()})):o}return t.fallback},void 0,void 0)}const uw=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],dw=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline",...uw]),hw=new Set(["innerHTML","textContent","innerText","children"]),fw=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),pw=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function mw(t,e){const r=pw[t];return typeof r=="object"?r[e]?r.$:void 0:r}const yw=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),Te=t=>Nt(()=>t());function gw(t,e,r){let n=r.length,i=e.length,o=n,s=0,a=0,c=e[i-1].nextSibling,u=null;for(;s<i||a<o;){if(e[s]===r[a]){s++,a++;continue}for(;e[i-1]===r[o-1];)i--,o--;if(i===s){const f=o<n?a?r[a-1].nextSibling:r[o-a]:c;for(;a<o;)t.insertBefore(r[a++],f)}else if(o===a)for(;s<i;)(!u||!u.has(e[s]))&&e[s].remove(),s++;else if(e[s]===r[o-1]&&r[a]===e[i-1]){const f=e[--i].nextSibling;t.insertBefore(r[a++],e[s++].nextSibling),t.insertBefore(r[--o],f),e[i]=r[o]}else{if(!u){u=new Map;let y=a;for(;y<o;)u.set(r[y],y++)}const f=u.get(e[s]);if(f!=null)if(a<f&&f<o){let y=s,v=1,p;for(;++y<i&&y<o&&!((p=u.get(e[y]))==null||p!==f+v);)v++;if(v>f-a){const I=e[s];for(;a<f;)t.insertBefore(r[a++],I)}else t.replaceChild(r[a++],e[s++])}else s++;else e[s++].remove()}}}const mg="_$DX_DELEGATE";function vw(t,e,r,n={}){let i;return cu(o=>{i=o,e===document?t():l(e,t(),e.firstChild?null:void 0,r)},n.owner),()=>{i(),e.textContent=""}}function ue(t,e,r,n){let i;const o=()=>{const a=n?document.createElementNS("http://www.w3.org/1998/Math/MathML","template"):document.createElement("template");return a.innerHTML=t,r?a.content.firstChild.firstChild:n?a.firstChild:a.content.firstChild},s=e?()=>to(()=>document.importNode(i||(i=o()),!0)):()=>(i||(i=o())).cloneNode(!0);return s.cloneNode=s,s}function ur(t,e=window.document){const r=e[mg]||(e[mg]=new Set);for(let n=0,i=t.length;n<i;n++){const o=t[n];r.has(o)||(r.add(o),e.addEventListener(o,Aw))}}function Yt(t,e,r){r==null?t.removeAttribute(e):t.setAttribute(e,r)}function bw(t,e,r){r?t.setAttribute(e,""):t.removeAttribute(e)}function Em(t,e){e==null?t.removeAttribute("class"):t.className=e}function as(t,e,r,n){if(n)Array.isArray(r)?(t[`$$${e}`]=r[0],t[`$$${e}Data`]=r[1]):t[`$$${e}`]=r;else if(Array.isArray(r)){const i=r[0];t.addEventListener(e,r[0]=o=>i.call(t,r[1],o))}else t.addEventListener(e,r,typeof r!="function"&&r)}function _w(t,e,r={}){const n=Object.keys(e||{}),i=Object.keys(r);let o,s;for(o=0,s=i.length;o<s;o++){const a=i[o];!a||a==="undefined"||e[a]||(yg(t,a,!1),delete r[a])}for(o=0,s=n.length;o<s;o++){const a=n[o],c=!!e[a];!a||a==="undefined"||r[a]===c||!c||(yg(t,a,!0),r[a]=c)}return r}function m(t,e,r){if(!e)return r?Yt(t,"style"):e;const n=t.style;if(typeof e=="string")return n.cssText=e;typeof r=="string"&&(n.cssText=r=void 0),r||(r={}),e||(e={});let i,o;for(o in r)e[o]==null&&n.removeProperty(o),delete r[o];for(o in e)i=e[o],i!==r[o]&&(n.setProperty(o,i),r[o]=i);return r}function ww(t,e={},r,n){const i={};return Se(()=>i.children=Au(t,e.children,i.children)),Se(()=>typeof e.ref=="function"&&Sw(e.ref,t)),Se(()=>Pw(t,e,r,!0,i,!0)),i}function Sw(t,e,r){return to(()=>t(e,r))}function l(t,e,r,n){if(r!==void 0&&!n&&(n=[]),typeof e!="function")return Au(t,e,n,r);Se(i=>Au(t,e(),i,r),n)}function Pw(t,e,r,n,i={},o=!1){e||(e={});for(const s in i)if(!(s in e)){if(s==="children")continue;i[s]=gg(t,s,null,i[s],r,o,e)}for(const s in e){if(s==="children")continue;const a=e[s];i[s]=gg(t,s,a,i[s],r,o,e)}}function xw(t){return t.toLowerCase().replace(/-([a-z])/g,(e,r)=>r.toUpperCase())}function yg(t,e,r){const n=e.trim().split(/\s+/);for(let i=0,o=n.length;i<o;i++)t.classList.toggle(n[i],r)}function gg(t,e,r,n,i,o,s){let a,c,u,f,y;if(e==="style")return m(t,r,n);if(e==="classList")return _w(t,r,n);if(r===n)return n;if(e==="ref")o||r(t);else if(e.slice(0,3)==="on:"){const v=e.slice(3);n&&t.removeEventListener(v,n,typeof n!="function"&&n),r&&t.addEventListener(v,r,typeof r!="function"&&r)}else if(e.slice(0,10)==="oncapture:"){const v=e.slice(10);n&&t.removeEventListener(v,n,!0),r&&t.addEventListener(v,r,!0)}else if(e.slice(0,2)==="on"){const v=e.slice(2).toLowerCase(),p=yw.has(v);if(!p&&n){const I=Array.isArray(n)?n[0]:n;t.removeEventListener(v,I)}(p||r)&&(as(t,v,r,p),p&&ur([v]))}else e.slice(0,5)==="attr:"?Yt(t,e.slice(5),r):e.slice(0,5)==="bool:"?bw(t,e.slice(5),r):(y=e.slice(0,5)==="prop:")||(u=hw.has(e))||(f=mw(e,t.tagName))||(c=dw.has(e))||(a=t.nodeName.includes("-")||"is"in s)?(y&&(e=e.slice(5),c=!0),e==="class"||e==="className"?Em(t,r):a&&!c&&!u?t[xw(e)]=r:t[f||e]=r):Yt(t,fw[e]||e,r);return r}function Aw(t){let e=t.target;const r=`$$${t.type}`,n=t.target,i=t.currentTarget,o=c=>Object.defineProperty(t,"target",{configurable:!0,value:c}),s=()=>{const c=e[r];if(c&&!e.disabled){const u=e[`${r}Data`];if(u!==void 0?c.call(e,u,t):c.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&o(e.host),!0},a=()=>{for(;s()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const c=t.composedPath();o(c[0]);for(let u=0;u<c.length-2&&(e=c[u],!!s());u++){if(e._$host){e=e._$host,a();break}if(e.parentNode===i)break}}else a();o(n)}function Au(t,e,r,n,i){for(;typeof r=="function";)r=r();if(e===r)return r;const o=typeof e,s=n!==void 0;if(t=s&&r[0]&&r[0].parentNode||t,o==="string"||o==="number"){if(o==="number"&&(e=e.toString(),e===r))return r;if(s){let a=r[0];a&&a.nodeType===3?a.data!==e&&(a.data=e):a=document.createTextNode(e),r=Yl(t,r,n,a)}else r!==""&&typeof r=="string"?r=t.firstChild.data=e:r=t.textContent=e}else if(e==null||o==="boolean")r=Yl(t,r,n);else{if(o==="function")return Se(()=>{let a=e();for(;typeof a=="function";)a=a();r=Au(t,a,r,n)}),()=>r;if(Array.isArray(e)){const a=[],c=r&&Array.isArray(r);if(Lp(a,e,r,i))return Se(()=>r=Au(t,a,r,n,!0)),()=>r;if(a.length===0){if(r=Yl(t,r,n),s)return r}else c?r.length===0?vg(t,a,n):gw(t,r,a):(r&&Yl(t),vg(t,a));r=a}else if(e.nodeType){if(Array.isArray(r)){if(s)return r=Yl(t,r,n,e);Yl(t,r,null,e)}else r==null||r===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);r=e}}return r}function Lp(t,e,r,n){let i=!1;for(let o=0,s=e.length;o<s;o++){let a=e[o],c=r&&r[t.length],u;if(!(a==null||a===!0||a===!1))if((u=typeof a)=="object"&&a.nodeType)t.push(a);else if(Array.isArray(a))i=Lp(t,a,c)||i;else if(u==="function")if(n){for(;typeof a=="function";)a=a();i=Lp(t,Array.isArray(a)?a:[a],Array.isArray(c)?c:[c])||i}else t.push(a),i=!0;else{const f=String(a);c&&c.nodeType===3&&c.data===f?t.push(c):t.push(document.createTextNode(f))}}return i}function vg(t,e,r=null){for(let n=0,i=e.length;n<i;n++)t.insertBefore(e[n],r)}function Yl(t,e,r,n){if(r===void 0)return t.textContent="";const i=n||document.createTextNode("");if(e.length){let o=!1;for(let s=e.length-1;s>=0;s--){const a=e[s];if(i!==a){const c=a.parentNode===t;!o&&!s?c?t.replaceChild(i,a):t.insertBefore(i,r):c&&a.remove()}else o=!0}}else t.insertBefore(i,r);return[i]}const Cw=!1;function E1(){let t=new Set;function e(i){return t.add(i),()=>t.delete(i)}let r=!1;function n(i,o){if(r)return!(r=!1);const s={to:i,options:o,defaultPrevented:!1,preventDefault:()=>s.defaultPrevented=!0};for(const a of t)a.listener({...s,from:a.location,retry:c=>{c&&(r=!0),a.navigate(i,{...o,resolve:!1})}});return!s.defaultPrevented}return{subscribe:e,confirm:n}}let Dp;function Tm(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Dp=window.history.state._depth}Tm();function Iw(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function $w(t,e){let r=!1;return()=>{const n=Dp;Tm();const i=n==null?null:Dp-n;if(r){r=!1;return}i&&e(i)?(r=!0,window.history.go(-i)):t()}}const kw=/^(?:[a-z0-9]+:)?\/\//i,Ew=/^\/+|(\/)\/+$/g,T1="http://sr";function yl(t,e=!1){const r=t.replace(Ew,"$1");return r?e||/^[?#]/.test(r)?r:"/"+r:""}function Kd(t,e,r){if(kw.test(e))return;const n=yl(t),i=r&&yl(r);let o="";return!i||e.startsWith("/")?o=n:i.toLowerCase().indexOf(n.toLowerCase())!==0?o=n+i:o=i,(o||"/")+yl(e,!o)}function Tw(t,e){if(t==null)throw new Error(e);return t}function Nw(t,e){return yl(t).replace(/\/*(\*.*)?$/g,"")+yl(e)}function N1(t){const e={};return t.searchParams.forEach((r,n)=>{n in e?Array.isArray(e[n])?e[n].push(r):e[n]=[e[n],r]:e[n]=r}),e}function Lw(t,e,r){const[n,i]=t.split("/*",2),o=n.split("/").filter(Boolean),s=o.length;return a=>{const c=a.split("/").filter(Boolean),u=c.length-s;if(u<0||u>0&&i===void 0&&!e)return null;const f={path:s?"":"/",params:{}},y=v=>r===void 0?void 0:r[v];for(let v=0;v<s;v++){const p=o[v],I=p[0]===":",P=I?c[v]:c[v].toLowerCase(),w=I?p.slice(1):p.toLowerCase();if(I&&Df(P,y(w)))f.params[w]=P;else if(I||!Df(P,w))return null;f.path+=`/${P}`}if(i){const v=u?c.slice(-u).join("/"):"";if(Df(v,y(i)))f.params[i]=v;else return null}return f}}function Df(t,e){const r=n=>n===t;return e===void 0?!0:typeof e=="string"?r(e):typeof e=="function"?e(t):Array.isArray(e)?e.some(r):e instanceof RegExp?e.test(t):!1}function Dw(t){const[e,r]=t.pattern.split("/*",2),n=e.split("/").filter(Boolean);return n.reduce((i,o)=>i+(o.startsWith(":")?2:3),n.length-(r===void 0?0:1))}function L1(t){const e=new Map,r=P1();return new Proxy({},{get(n,i){return e.has(i)||x1(r,()=>e.set(i,Nt(()=>t()[i]))),e.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function D1(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let r=t.slice(0,e.index),n=t.slice(e.index+e[0].length);const i=[r,r+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(n);)i.push(r+=e[1]),n=n.slice(e[0].length);return D1(n).reduce((o,s)=>[...o,...i.map(a=>a+s)],[])}const Rw=100,R1=A1(),Nm=A1(),zu=()=>Tw(Cm(R1),"<A> and 'use' router primitives can be only used inside a Route."),Mw=()=>Cm(Nm)||zu().base,Fw=t=>{const e=Mw();return Nt(()=>e.resolvePath(t()))},Ow=t=>{const e=zu();return Nt(()=>{const r=t();return r!==void 0?e.renderPath(r):r})},Lm=()=>zu().navigatorFactory(),Bw=()=>zu().location,jw=()=>zu().params;function Vw(t,e=""){const{component:r,preload:n,load:i,children:o,info:s}=t,a=!o||Array.isArray(o)&&!o.length,c={key:t,component:r,preload:n||i,info:s};return M1(t.path).reduce((u,f)=>{for(const y of D1(f)){const v=Nw(e,y);let p=a?v:v.split("/*",1)[0];p=p.split("/").map(I=>I.startsWith(":")||I.startsWith("*")?I:encodeURIComponent(I)).join("/"),u.push({...c,originalPath:f,pattern:p,matcher:Lw(p,!a,t.matchFilters)})}return u},[])}function zw(t,e=0){return{routes:t,score:Dw(t[t.length-1])*1e4-e,matcher(r){const n=[];for(let i=t.length-1;i>=0;i--){const o=t[i],s=o.matcher(r);if(!s)return null;n.unshift({...s,route:o})}return n}}}function M1(t){return Array.isArray(t)?t:[t]}function F1(t,e="",r=[],n=[]){const i=M1(t);for(let o=0,s=i.length;o<s;o++){const a=i[o];if(a&&typeof a=="object"){a.hasOwnProperty("path")||(a.path="");const c=Vw(a,e);for(const u of c){r.push(u);const f=Array.isArray(a.children)&&a.children.length===0;if(a.children&&!f)F1(a.children,u.pattern,r,n);else{const y=zw([...r],n.length);n.push(y)}r.pop()}}}return r.length?n:n.sort((o,s)=>s.score-o.score)}function Rf(t,e){for(let r=0,n=t.length;r<n;r++){const i=t[r].matcher(e);if(i)return i}return[]}function qw(t,e,r){const n=new URL(T1),i=Nt(f=>{const y=t();try{return new URL(y,n)}catch{return console.error(`Invalid path ${y}`),f}},n,{equals:(f,y)=>f.href===y.href}),o=Nt(()=>i().pathname),s=Nt(()=>i().search,!0),a=Nt(()=>i().hash),c=()=>"",u=Am(s,()=>N1(i()));return{get pathname(){return o()},get search(){return s()},get hash(){return a()},get state(){return e()},get key(){return c()},query:r?r(u):L1(u)}}let ll;function Uw(){return ll}function Hw(t,e,r,n={}){const{signal:[i,o],utils:s={}}=t,a=s.parsePath||(Y=>Y),c=s.renderPath||(Y=>Y),u=s.beforeLeave||E1(),f=Kd("",n.base||"");if(f===void 0)throw new Error(`${f} is not a valid base path`);f&&!i().value&&o({value:f,replace:!0,scroll:!1});const[y,v]=$e(!1);let p;const I=(Y,te)=>{te.value===P()&&te.state===x()||(p===void 0&&v(!0),ll=Y,p=te,Z_(()=>{p===te&&(w(p.value),j(p.state),K[1](O=>O.filter(D=>D.pending)))}).finally(()=>{p===te&&S1(()=>{ll=void 0,Y==="navigate"&&S(p),v(!1),p=void 0})}))},[P,w]=$e(i().value),[x,j]=$e(i().state),ne=qw(P,x,s.queryWrapper),Q=[],K=$e([]),Z=Nt(()=>typeof n.transformUrl=="function"?Rf(e(),n.transformUrl(ne.pathname)):Rf(e(),ne.pathname)),k=()=>{const Y=Z(),te={};for(let O=0;O<Y.length;O++)Object.assign(te,Y[O].params);return te},C=s.paramsWrapper?s.paramsWrapper(k,e):L1(k),E={pattern:f,path:()=>f,outlet:()=>null,resolvePath(Y){return Kd(f,Y)}};return Se(Am(i,Y=>I("native",Y),{defer:!0})),{base:E,location:ne,params:C,isRouting:y,renderPath:c,parsePath:a,navigatorFactory:_,matches:Z,beforeLeave:u,preloadRoute:b,singleFlight:n.singleFlight===void 0?!0:n.singleFlight,submissions:K};function M(Y,te,O){to(()=>{if(typeof te=="number"){te&&(s.go?s.go(te):console.warn("Router integration does not support relative routing"));return}const D=!te||te[0]==="?",{replace:X,resolve:H,scroll:F,state:ie}={replace:!1,resolve:!D,scroll:!0,...O},$=H?Y.resolvePath(te):Kd(D&&ne.pathname||"",te);if($===void 0)throw new Error(`Path '${te}' is not a routable path`);if(Q.length>=Rw)throw new Error("Too many redirects");const L=P();($!==L||ie!==x())&&(Cw||u.confirm($,O)&&(Q.push({value:L,replace:X,scroll:F,state:x()}),I("navigate",{value:$,state:ie})))})}function _(Y){return Y=Y||Cm(Nm)||E,(te,O)=>M(Y,te,O)}function S(Y){const te=Q[0];te&&(o({...Y,replace:te.replace,scroll:te.scroll}),Q.length=0)}function b(Y,te){const O=Rf(e(),Y.pathname),D=ll;ll="preload";for(let X in O){const{route:H,params:F}=O[X];H.component&&H.component.preload&&H.component.preload();const{preload:ie}=H;te&&ie&&x1(r(),()=>ie({params:F,location:{pathname:Y.pathname,search:Y.search,hash:Y.hash,query:N1(Y),state:null,key:""},intent:"preload"}))}ll=D}}function Ww(t,e,r,n){const{base:i,location:o,params:s}=t,{pattern:a,component:c,preload:u}=n().route,f=Nt(()=>n().path);c&&c.preload&&c.preload();const y=u?u({params:s,location:o,intent:ll||"initial"}):void 0;return{parent:e,pattern:a,path:f,outlet:()=>c?B(c,{params:s,location:o,data:y,get children(){return r()}}):r(),resolvePath(p){return Kd(i.path(),p,f())}}}const Gw=t=>e=>{const{base:r}=e,n=Im(()=>e.children),i=Nt(()=>F1(n(),e.base||""));let o;const s=Hw(t,i,()=>o,{base:r,singleFlight:e.singleFlight,transformUrl:e.transformUrl});return t.create&&t.create(s),B(R1.Provider,{value:s,get children(){return B(Yw,{routerState:s,get root(){return e.root},get preload(){return e.rootPreload||e.rootLoad},get children(){return[Te(()=>(o=P1())&&null),B(Kw,{routerState:s,get branches(){return i()}})]}})}})};function Yw(t){const e=t.routerState.location,r=t.routerState.params,n=Nt(()=>t.preload&&to(()=>{t.preload({params:r,location:e,intent:Uw()||"initial"})}));return B(Ge,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:i=>B(i,{params:r,location:e,get data(){return n()},get children(){return t.children}})})}function Kw(t){const e=[];let r;const n=Nt(Am(t.routerState.matches,(i,o,s)=>{let a=o&&i.length===o.length;const c=[];for(let u=0,f=i.length;u<f;u++){const y=o&&o[u],v=i[u];s&&y&&v.route.key===y.route.key?c[u]=s[u]:(a=!1,e[u]&&e[u](),cu(p=>{e[u]=p,c[u]=Ww(t.routerState,c[u-1]||t.routerState.base,bg(()=>n()[u+1]),()=>t.routerState.matches()[u])}))}return e.splice(i.length).forEach(u=>u()),s&&a?s:(r=c[0],c)}));return bg(()=>n()&&r)()}const bg=t=>()=>B(Ge,{get when(){return t()},keyed:!0,children:e=>B(Nm.Provider,{value:e,get children(){return e.outlet()}})}),fo=t=>{const e=Im(()=>t.children);return Np(t,{get children(){return e()}})};function Jw([t,e],r,n){return[t,n?i=>e(n(i)):e]}function Qw(t){let e=!1;const r=i=>typeof i=="string"?{value:i}:i,n=Jw($e(r(t.get()),{equals:(i,o)=>i.value===o.value&&i.state===o.state}),void 0,i=>(!e&&t.set(i),i));return t.init&&Pc(t.init((i=t.get())=>{e=!0,n[1](r(i)),e=!1})),Gw({signal:n,create:t.create,utils:t.utils})}function Xw(t,e,r){return t.addEventListener(e,r),()=>t.removeEventListener(e,r)}function Zw(t,e){const r=t&&document.getElementById(t);r?r.scrollIntoView():e&&window.scrollTo(0,0)}const eS=new Map;function tS(t=!0,e=!1,r="/_server",n){return i=>{const o=i.base.path(),s=i.navigatorFactory(i.base);let a,c;function u(P){return P.namespaceURI==="http://www.w3.org/2000/svg"}function f(P){if(P.defaultPrevented||P.button!==0||P.metaKey||P.altKey||P.ctrlKey||P.shiftKey)return;const w=P.composedPath().find(Z=>Z instanceof Node&&Z.nodeName.toUpperCase()==="A");if(!w||e&&!w.hasAttribute("link"))return;const x=u(w),j=x?w.href.baseVal:w.href;if((x?w.target.baseVal:w.target)||!j&&!w.hasAttribute("state"))return;const Q=(w.getAttribute("rel")||"").split(/\s+/);if(w.hasAttribute("download")||Q&&Q.includes("external"))return;const K=x?new URL(j,document.baseURI):new URL(j);if(!(K.origin!==window.location.origin||o&&K.pathname&&!K.pathname.toLowerCase().startsWith(o.toLowerCase())))return[w,K]}function y(P){const w=f(P);if(!w)return;const[x,j]=w,ne=i.parsePath(j.pathname+j.search+j.hash),Q=x.getAttribute("state");P.preventDefault(),s(ne,{resolve:!1,replace:x.hasAttribute("replace"),scroll:!x.hasAttribute("noscroll"),state:Q?JSON.parse(Q):void 0})}function v(P){const w=f(P);if(!w)return;const[x,j]=w;i.preloadRoute(j,x.getAttribute("preload")!=="false")}function p(P){clearTimeout(a);const w=f(P);if(!w)return c=null;const[x,j]=w;c!==x&&(a=setTimeout(()=>{i.preloadRoute(j,x.getAttribute("preload")!=="false"),c=x},20))}function I(P){if(P.defaultPrevented)return;let w=P.submitter&&P.submitter.hasAttribute("formaction")?P.submitter.getAttribute("formaction"):P.target.getAttribute("action");if(!w)return;if(!w.startsWith("https://action/")){const j=new URL(w,T1);if(w=i.parsePath(j.pathname+j.search),!w.startsWith(r))return}if(P.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const x=eS.get(w);if(x){P.preventDefault();const j=new FormData(P.target,P.submitter);x.call({r:i,f:P.target},P.target.enctype==="multipart/form-data"?j:new URLSearchParams(j))}}ur(["click","submit"]),document.addEventListener("click",y),t&&(document.addEventListener("mousemove",p,{passive:!0}),document.addEventListener("focusin",v,{passive:!0}),document.addEventListener("touchstart",v,{passive:!0})),document.addEventListener("submit",I),Pc(()=>{document.removeEventListener("click",y),t&&(document.removeEventListener("mousemove",p),document.removeEventListener("focusin",v),document.removeEventListener("touchstart",v)),document.removeEventListener("submit",I)})}}function rS(t){const e=t.replace(/^.*?#/,"");if(!e.startsWith("/")){const[,r="/"]=window.location.hash.split("#",2);return`${r}#${e}`}return e}function nS(t){const e=()=>window.location.hash.slice(1),r=E1();return Qw({get:e,set({value:n,replace:i,scroll:o,state:s}){i?window.history.replaceState(Iw(s),"","#"+n):window.history.pushState(s,"","#"+n);const a=n.indexOf("#"),c=a>=0?n.slice(a+1):"";Zw(c,o),Tm()},init:n=>Xw(window,"hashchange",$w(n,i=>!r.confirm(i&&i<0?i:e()))),create:tS(t.preload,t.explicitLinks,t.actionBase),utils:{go:n=>window.history.go(n),renderPath:n=>`#${n}`,parsePath:rS,beforeLeave:r}})(t)}var iS=ue("<a>");function tc(t){t=Np({inactiveClass:"inactive",activeClass:"active"},t);const[,e]=lw(t,["href","state","class","activeClass","inactiveClass","end"]),r=Fw(()=>t.href),n=Ow(r),i=Bw(),o=Nt(()=>{const s=r();if(s===void 0)return[!1,!1];const a=yl(s.split(/[?#]/,1)[0]).toLowerCase(),c=decodeURI(yl(i.pathname).toLowerCase());return[t.end?a===c:c.startsWith(a+"/")||c===a,a===c]});return(()=>{var s=iS();return ww(s,Np(e,{get href(){return n()||t.href},get state(){return JSON.stringify(t.state)},get classList(){return{...t.class&&{[t.class]:!0},[t.inactiveClass]:!o()[0],[t.activeClass]:o()[0],...e.classList}},link:"",get"aria-current"(){return o()[1]?"page":void 0}}),!1),s})()}const Rp=Symbol("store-raw"),lc=Symbol("store-node"),Cs=Symbol("store-has"),O1=Symbol("store-self");function B1(t){let e=t[Do];if(!e&&(Object.defineProperty(t,Do,{value:e=new Proxy(t,aS)}),!Array.isArray(t))){const r=Object.keys(t),n=Object.getOwnPropertyDescriptors(t);for(let i=0,o=r.length;i<o;i++){const s=r[i];n[s].get&&Object.defineProperty(t,s,{enumerable:n[s].enumerable,get:n[s].get.bind(e)})}}return e}function ph(t){let e;return t!=null&&typeof t=="object"&&(t[Do]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function Cu(t,e=new Set){let r,n,i,o;if(r=t!=null&&t[Rp])return r;if(!ph(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let s=0,a=t.length;s<a;s++)i=t[s],(n=Cu(i,e))!==i&&(t[s]=n)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const s=Object.keys(t),a=Object.getOwnPropertyDescriptors(t);for(let c=0,u=s.length;c<u;c++)o=s[c],!a[o].get&&(i=t[o],(n=Cu(i,e))!==i&&(t[o]=n))}return t}function mh(t,e){let r=t[e];return r||Object.defineProperty(t,e,{value:r=Object.create(null)}),r}function Iu(t,e,r){if(t[e])return t[e];const[n,i]=$e(r,{equals:!1,internal:!0});return n.$=i,t[e]=n}function oS(t,e){const r=Reflect.getOwnPropertyDescriptor(t,e);return!r||r.get||!r.configurable||e===Do||e===lc||(delete r.value,delete r.writable,r.get=()=>t[Do][e]),r}function j1(t){kp()&&Iu(mh(t,lc),O1)()}function sS(t){return j1(t),Reflect.ownKeys(t)}const aS={get(t,e,r){if(e===Rp)return t;if(e===Do)return r;if(e===$p)return j1(t),r;const n=mh(t,lc),i=n[e];let o=i?i():t[e];if(e===lc||e===Cs||e==="__proto__")return o;if(!i){const s=Object.getOwnPropertyDescriptor(t,e);kp()&&(typeof o!="function"||t.hasOwnProperty(e))&&!(s&&s.get)&&(o=Iu(n,e,o)())}return ph(o)?B1(o):o},has(t,e){return e===Rp||e===Do||e===$p||e===lc||e===Cs||e==="__proto__"?!0:(kp()&&Iu(mh(t,Cs),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:sS,getOwnPropertyDescriptor:oS};function yh(t,e,r,n=!1){if(!n&&t[e]===r)return;const i=t[e],o=t.length;r===void 0?(delete t[e],t[Cs]&&t[Cs][e]&&i!==void 0&&t[Cs][e].$()):(t[e]=r,t[Cs]&&t[Cs][e]&&i===void 0&&t[Cs][e].$());let s=mh(t,lc),a;if((a=Iu(s,e,i))&&a.$(()=>r),Array.isArray(t)&&t.length!==o){for(let c=t.length;c<o;c++)(a=s[c])&&a.$();(a=Iu(s,"length",o))&&a.$(t.length)}(a=s[O1])&&a.$()}function V1(t,e){const r=Object.keys(e);for(let n=0;n<r.length;n+=1){const i=r[n];yh(t,i,e[i])}}function lS(t,e){if(typeof e=="function"&&(e=e(t)),e=Cu(e),Array.isArray(e)){if(t===e)return;let r=0,n=e.length;for(;r<n;r++){const i=e[r];t[r]!==i&&yh(t,r,i)}yh(t,"length",n)}else V1(t,e)}function ru(t,e,r=[]){let n,i=t;if(e.length>1){n=e.shift();const s=typeof n,a=Array.isArray(t);if(Array.isArray(n)){for(let c=0;c<n.length;c++)ru(t,[n[c]].concat(e),r);return}else if(a&&s==="function"){for(let c=0;c<t.length;c++)n(t[c],c)&&ru(t,[c].concat(e),r);return}else if(a&&s==="object"){const{from:c=0,to:u=t.length-1,by:f=1}=n;for(let y=c;y<=u;y+=f)ru(t,[y].concat(e),r);return}else if(e.length>1){ru(t[n],e,[n].concat(r));return}i=t[n],r=[n].concat(r)}let o=e[0];typeof o=="function"&&(o=o(i,r),o===i)||n===void 0&&o==null||(o=Cu(o),n===void 0||ph(i)&&ph(o)&&!Array.isArray(o)?V1(i,o):yh(t,n,o))}function zh(...[t,e]){const r=Cu(t||{}),n=Array.isArray(r),i=B1(r);function o(...s){S1(()=>{n&&s.length===1?lS(r,s[0]):ru(r,s)})}return[i,o]}const Kr=(t=300+Math.random()*700)=>new Promise(e=>setTimeout(e,t)),tl=(t="")=>`${t}${Date.now()}-${Math.random().toString(36).substr(2,9)}`;let Ot={products:[{id:"prod-001",name:"Wireless Headphones",sku:"WH-001",productCode:"WH-001",productName:"Wireless Headphones",description:"High-quality wireless bluetooth headphones",category:"Electronics",unitOfMeasure:"pcs",unitCost:45,sellingPrice:89.99,minStockLevel:10,maxStockLevel:100,isActive:!0,createdDate:"2024-01-15T10:00:00Z",lastModified:"2024-01-15T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-002",name:"USB-C Cable",sku:"USB-001",description:"3ft USB-C charging cable",category:"Accessories",unitOfMeasure:"pcs",unitCost:8.5,sellingPrice:19.99,minStockLevel:25,maxStockLevel:200,isActive:!0,createdDate:"2024-01-16T10:00:00Z",lastModified:"2024-01-16T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-003",name:"Laptop Stand",sku:"LS-001",description:"Adjustable aluminum laptop stand",category:"Office",unitOfMeasure:"pcs",unitCost:25,sellingPrice:49.99,minStockLevel:5,maxStockLevel:50,isActive:!0,createdDate:"2024-01-17T10:00:00Z",lastModified:"2024-01-17T10:00:00Z",businessId:"YB100423253156428"}],locations:[{id:"loc-001",name:"Main Warehouse",code:"WH-001",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-002",name:"Retail Store - Downtown",code:"ST-001",type:"store",address:"456 Main St, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-003",name:"Retail Store - Mall",code:"ST-002",type:"store",address:"789 Mall Blvd, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"}],movements:[{id:"mov-001",productId:"prod-001",productName:"Wireless Headphones",productSku:"WH-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:50,unitCost:45,totalCost:2250,referenceNumber:"PO-001",notes:"Initial stock purchase",createdBy:"admin",createdDate:"2024-01-15T10:00:00Z",invoiceId:"INV-1000001"},{id:"mov-002",productId:"prod-002",productName:"USB-C Cable",productSku:"USB-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:100,unitCost:8.5,totalCost:850,referenceNumber:"PO-001",notes:"Bulk purchase",createdBy:"admin",createdDate:"2024-01-15T10:05:00Z",invoiceId:"INV-1000001"}],accounts:[{id:"acc-001",accountNumber:"1000",accountName:"Cash",accountType:"asset",category:"currentAssets",balance:5e4,parentAccountId:null,description:"Cash and cash equivalents",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"},{id:"acc-002",accountNumber:"1100",accountName:"Accounts Receivable",accountType:"asset",category:"currentAssets",balance:25e3,parentAccountId:null,description:"Money owed by customers",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"}],journalEntries:[{id:"je-001",entryNumber:"JE-001",date:"2024-01-15",description:"Initial cash deposit",reference:"DEP-001",status:"posted",createdBy:"admin",createdAt:"2024-01-15T10:00:00Z",postedAt:"2024-01-15T10:05:00Z",lines:[{id:"jel-001",accountId:"acc-001",accountName:"Cash",description:"Initial deposit",debitAmount:5e4,creditAmount:0},{id:"jel-002",accountId:"acc-003",accountName:"Owner Equity",description:"Initial capital",debitAmount:0,creditAmount:5e4}]}]};const Mn=(t=.05)=>Math.random()<t,Fn=()=>{const t=["Network timeout","Connection refused","Server temporarily unavailable","Invalid request"];throw new Error(t[Math.floor(Math.random()*t.length)])},li={products:{async getAll(t,e){await Kr(),Mn()&&Fn();let r=[...Ot.products];if(t&&t.trim()){const n=t.toLowerCase();r=r.filter(i=>i.name.toLowerCase().includes(n)||i.sku.toLowerCase().includes(n)||i.category.toLowerCase().includes(n)||i.description.toLowerCase().includes(n))}return e?.category&&(r=r.filter(n=>n.category===e.category)),e?.isActive!==void 0&&(r=r.filter(n=>n.isActive===e.isActive)),r},async getById(t){return await Kr(),Mn()&&Fn(),Ot.products.find(e=>e.id===t)||null},async create(t){if(await Kr(),Mn()&&Fn(),Ot.products.some(r=>r.sku===t.sku))throw new Error("SKU already exists");const e={...t,id:tl("prod-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return Ot.products.push(e),e},async update(t,e){await Kr(),Mn()&&Fn();const r=Ot.products.findIndex(i=>i.id===t);if(r===-1)throw new Error("Product not found");if(e.sku&&Ot.products.some(i=>i.id!==t&&i.sku===e.sku))throw new Error("SKU already exists");const n={...Ot.products[r],...e,lastModified:new Date().toISOString()};return Ot.products[r]=n,n},async delete(t){await Kr(),Mn()&&Fn();const e=Ot.products.findIndex(n=>n.id===t);if(e===-1)throw new Error("Product not found");return Ot.movements.some(n=>n.productId===t)?{success:!1,message:"Cannot delete product with existing movements"}:(Ot.products.splice(e,1),{success:!0,message:"Product deleted successfully"})}},locations:{async getAll(t){await Kr(),Mn()&&Fn();let e=[...Ot.locations];return t?.type&&(e=e.filter(r=>r.type===t.type)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Kr(),Ot.locations.find(e=>e.id===t)||null},async create(t){if(await Kr(),Mn()&&Fn(),Ot.locations.some(r=>r.code===t.code))throw new Error("Location code already exists");const e={...t,id:tl("loc-"),createdDate:new Date().toISOString()};return Ot.locations.push(e),e},async update(t,e){await Kr(),Mn()&&Fn();const r=Ot.locations.findIndex(n=>n.id===t);if(r===-1)throw new Error("Location not found");if(e.code&&Ot.locations.some(n=>n.id!==t&&n.code===e.code))throw new Error("Location code already exists");return Ot.locations[r]={...Ot.locations[r],...e},Ot.locations[r]}},movements:{async getAll(t){await Kr(),Mn()&&Fn();let e=[...Ot.movements];if(t?.productId&&(e=e.filter(r=>r.productId===t.productId)),t?.locationId&&(e=e.filter(r=>r.locationId===t.locationId)),t?.movementType&&(e=e.filter(r=>r.movementType===t.movementType)),t?.dateFrom&&(e=e.filter(r=>r.createdDate>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.createdDate<=t.dateTo)),t?.search){const r=t.search.toLowerCase();e=e.filter(n=>n.productName.toLowerCase().includes(r)||n.productSku.toLowerCase().includes(r)||n.referenceNumber.toLowerCase().includes(r)||n.notes.toLowerCase().includes(r))}return e.sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime()),e},async getById(t){return await Kr(),Ot.movements.find(e=>e.id===t)||null},async create(t){if(await Kr(),Mn()&&Fn(),!Ot.products.find(i=>i.id===t.productId))throw new Error("Product not found");if(!Ot.locations.find(i=>i.id===t.locationId))throw new Error("Location not found");if(t.movementType==="out"){const i=await this.getStockLevel(t.productId,t.locationId);if(i<t.quantity)throw new Error(`Insufficient stock. Available: ${i}, Requested: ${t.quantity}`)}const n={...t,id:tl("mov-"),createdDate:new Date().toISOString()};return Ot.movements.push(n),n},async update(t,e){await Kr(),Mn()&&Fn();const r=Ot.movements.findIndex(i=>i.id===t);if(r===-1)throw new Error("Movement not found");const n={...Ot.movements[r],...e,lastModified:new Date().toISOString()};return Ot.movements[r]=n,n},async delete(t){await Kr(),Mn()&&Fn();const e=Ot.movements.findIndex(r=>r.id===t);if(e===-1)throw new Error("Movement not found");return Ot.movements.splice(e,1),{success:!0,message:"Movement deleted successfully"}},async createBulk(t){await Kr(),Mn()&&Fn();const e=[],r=[],n=new Date().toISOString(),i=Ot.locations.find(o=>o.id===t.locationId);if(!i)return{success:!1,movements:[],errors:["Invalid location"]};for(let o=0;o<t.items.length;o++){const s=t.items[o],a=Ot.products.find(f=>f.id===s.productId);if(!a){e.push(`Item ${o+1}: Product not found`);continue}if(s.quantity<=0){e.push(`Item ${o+1}: Quantity must be greater than 0`);continue}if(t.movementType==="out"){const f=await this.getStockLevel(s.productId,t.locationId);if(s.quantity>f){e.push(`Item ${o+1}: Insufficient stock. Available: ${f}, Requested: ${s.quantity}`);continue}}const c=s.unitCost||a.unitCost,u={id:tl("mov-"),productId:a.id,productName:a.name,productSku:a.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:s.quantity,unitCost:c,totalCost:s.quantity*c,referenceNumber:t.referenceNumber,notes:s.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:t.fromLocationId?Ot.locations.find(f=>f.id===t.fromLocationId)?.name:void 0};r.push(u)}return e.length>0?{success:!1,movements:[],errors:e}:(Ot.movements.push(...r),{success:!0,movements:r,errors:[]})},async getStockLevel(t,e){return await Kr(50),Ot.movements.filter(r=>r.productId===t&&r.locationId===e).reduce((r,n)=>{switch(n.movementType){case"in":case"adjustment":return r+n.quantity;case"out":return r-n.quantity;case"transfer":return n.locationId===e?r+n.quantity:r;default:return r}},0)},async getStockLevels(){await Kr();const t=new Map;for(const e of Ot.movements){const r=`${e.productId}-${e.locationId}`;let n=t.get(r);switch(n||(n={id:r,productId:e.productId,locationId:e.locationId,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType){case"in":case"adjustment":n.quantity+=e.quantity;break;case"out":n.quantity-=e.quantity;break;case"transfer":e.locationId===e.locationId&&(n.quantity+=e.quantity);break}new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost,n.availableQuantity=n.quantity-n.reservedQuantity}return Array.from(t.values())}},accounts:{async getAll(t){await Kr(),Mn()&&Fn();let e=[...Ot.accounts];return t?.accountType&&(e=e.filter(r=>r.accountType===t.accountType)),t?.category&&(e=e.filter(r=>r.category===t.category)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Kr(),Ot.accounts.find(e=>e.id===t)||null},async create(t){if(await Kr(),Mn()&&Fn(),Ot.accounts.some(r=>r.accountNumber===t.accountNumber))throw new Error("Account number already exists");const e={...t,id:tl("acc-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return Ot.accounts.push(e),e},async update(t,e){await Kr(),Mn()&&Fn();const r=Ot.accounts.findIndex(n=>n.id===t);if(r===-1)throw new Error("Account not found");if(e.accountNumber&&Ot.accounts.some(n=>n.id!==t&&n.accountNumber===e.accountNumber))throw new Error("Account number already exists");return Ot.accounts[r]={...Ot.accounts[r],...e,lastModified:new Date().toISOString()},Ot.accounts[r]}},journal:{async getAll(t){await Kr(),Mn()&&Fn();let e=[...Ot.journalEntries];return t?.status&&(e=e.filter(r=>r.status===t.status)),t?.accountId&&(e=e.filter(r=>r.lines.some(n=>n.accountId===t.accountId))),t?.dateFrom&&(e=e.filter(r=>r.date>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.date<=t.dateTo)),e.sort((r,n)=>new Date(n.createdAt).getTime()-new Date(r.createdAt).getTime())},async getById(t){return await Kr(),Ot.journalEntries.find(e=>e.id===t)||null},async create(t){await Kr(),Mn()&&Fn();const e=t.lines.reduce((a,c)=>a+(c.debitAmount||0),0),r=t.lines.reduce((a,c)=>a+(c.creditAmount||0),0);if(Math.abs(e-r)>.01)throw new Error(`Entry is not balanced. Debit: ${e}, Credit: ${r}`);const n=Ot.journalEntries.sort((a,c)=>c.entryNumber.localeCompare(a.entryNumber))[0],o=`JE-${((n?parseInt(n.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`,s={...t,id:tl("je-"),entryNumber:o,createdAt:new Date().toISOString(),lines:t.lines.map(a=>({...a,id:tl("jel-")}))};return Ot.journalEntries.push(s),s},async update(t,e){await Kr(),Mn()&&Fn();const r=Ot.journalEntries.findIndex(n=>n.id===t);if(r===-1)throw new Error("Journal entry not found");if(Ot.journalEntries[r].status==="posted")throw new Error("Cannot modify posted entries");return Ot.journalEntries[r]={...Ot.journalEntries[r],...e},Ot.journalEntries[r]},async post(t){await Kr(),Mn()&&Fn();const e=Ot.journalEntries.findIndex(o=>o.id===t);if(e===-1)throw new Error("Journal entry not found");const r=Ot.journalEntries[e];if(r.status==="posted")throw new Error("Entry is already posted");const n=r.lines.reduce((o,s)=>o+(s.debitAmount||0),0),i=r.lines.reduce((o,s)=>o+(s.creditAmount||0),0);if(Math.abs(n-i)>.01)throw new Error("Entry must be balanced before posting");return Ot.journalEntries[e]={...r,status:"posted",postedAt:new Date().toISOString()},r.lines.forEach(o=>{const s=Ot.accounts.findIndex(a=>a.id===o.accountId);if(s!==-1){const a=Ot.accounts[s],c=o.debitAmount||0,u=o.creditAmount||0;["asset","expense"].includes(a.accountType)?a.balance+=c-u:a.balance+=u-c}}),Ot.journalEntries[e]}},utils:{async getNextEntryNumber(){await Kr(100);const t=Ot.journalEntries.sort((r,n)=>n.entryNumber.localeCompare(r.entryNumber))[0];return`JE-${((t?parseInt(t.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`},async getNextProductCode(t){await Kr(100);const e=t.toUpperCase().slice(0,3),r=Ot.products.filter(i=>i.productCode?.startsWith(e)).sort((i,o)=>(o.productCode||"").localeCompare(i.productCode||""));if(r.length===0)return`${e}001`;const n=parseInt(r[0].productCode?.slice(-3)||"0");return`${e}${(n+1).toString().padStart(3,"0")}`},async healthCheck(){return await Kr(50),{status:"healthy",timestamp:new Date().toISOString(),version:"1.0.0"}},async resetDatabase(){return await Kr(200),Ot={products:[...Ot.products.slice(0,3)],locations:[...Ot.locations.slice(0,3)],movements:[...Ot.movements.slice(0,2)],accounts:[...Ot.accounts.slice(0,2)],journalEntries:[...Ot.journalEntries.slice(0,1)]},{success:!0,message:"Database reset to initial state"}},async getStats(){return await Kr(100),{products:Ot.products.length,locations:Ot.locations.length,movements:Ot.movements.length,accounts:Ot.accounts.length,journalEntries:Ot.journalEntries.length,totalStockValue:Ot.movements.reduce((t,e)=>e.movementType==="in"?t+e.totalCost:e.movementType==="out"?t-e.totalCost:t,0)}}}},z1=t=>t===null||typeof t!="object"?t:t instanceof Date?new Date(t.getTime()):Array.isArray(t)?t.map(e=>z1(e)):JSON.parse(JSON.stringify(t)),Dm=(t=16)=>{const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},_g=(t=16)=>{const e="123456789";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},cS=(t=4)=>{const e="0123456789BCDFGKSY";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},uu=t=>typeof t=="string"&&t.trim().length>0,Vi=async t=>{const n=await fetch("https://qvamarkets.com/gql_api",{method:"POST",headers:{"Content-Type":"application/json","Accept-Encoding":"gzip, deflate, br",Authorization:"eyJhbGciOiJSUzI1NiIsImtpZCI6IjhlOGZjOGU1NTZmN2E3NmQwOGQzNTgyOWQ2ZjkwYWUyZTEyY2ZkMGQiLCJ0eXAiOiJKV1QifQ"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const i=await n.json();if(i.errors)throw new Error(i.errors[0]?.message||"GraphQL error");return i.data},uS=t=>({ENTRY:"in",in:"in",TRANSFER:"transfer",transfer:"transfer",SALES:"out",out:"out",adjustment:"adjustment"})[t],Mp=t=>({ENTRY:"ENTRY",in:"ENTRY",TRANSFER:"TRANSFER",transfer:"TRANSFER",SALES:"SALES",out:"SALES",adjustment:"adjustment"})[t];function Fp(t){var e=[];return t&&Object.keys(t).map(r=>{e.push(t[r])}),e}function dS(t){if(!/^[a-z0-9+/]+={0,2}$/i.test(t)||t.length%4!=0)throw Error("Not base64 string");for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,n,i,o,s,a,c,u,f=[],y=0;y<t.length;y+=4)o=e.indexOf(t.charAt(y)),s=e.indexOf(t.charAt(y+1)),a=e.indexOf(t.charAt(y+2)),c=e.indexOf(t.charAt(y+3)),u=o<<18|s<<12|a<<6|c,r=u>>>16&255,n=u>>>8&255,i=u&255,f[y/4]=String.fromCharCode(r,n,i),c==64&&(f[y/4]=String.fromCharCode(r,n)),a==64&&(f[y/4]=String.fromCharCode(r));return t=f.join(""),t}const hS=async()=>({}),fS=()=>(typeof window<"u"&&localStorage.getItem("hrmfinance-api-mode"),"real");let cl=fS();const $u={getMode(){return cl},setMode(t){cl=t,typeof window<"u"&&localStorage.setItem("hrmfinance-api-mode",t)},isFakeMode(){return cl==="fake"},isRealMode(){return cl==="real"},isHybridMode(){return cl==="hybrid"}},Pi=async(t,e,r=!0)=>{if(cl==="fake")return e();if(cl==="real")return t();try{return await t()}catch(n){if(console.warn("Real API failed, falling back to fake server:",n),r)return e();throw n}},wg={async getAll(t,e){const r=await Vi({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:{businessId:"YB100423253156428",":search0":"produ"}});return Fp(r)},async getById(t){return Pi(async()=>(await this.getAll()).find(r=>r.id===t)||null,()=>li.products.getById(t))},async create(t){return Pi(async()=>{throw console.log("Creating product via real API:",t),new Error("Real API not implemented yet")},()=>li.products.create(t))},async update(t,e){return Pi(async()=>{throw console.log("Updating product via real API:",t,e),new Error("Real API not implemented yet")},()=>li.products.update(t,e))},async delete(t){return Pi(async()=>{throw console.log("Deleting product via real API:",t),new Error("Real API not implemented yet")},()=>li.products.delete(t))}},Ai={async getInventory(t,e){if(!(t&&t?.trim()))return[];let r={businessId:"YB100423253156428"};return t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())}),await Vi({query:"getScanYabaInventory",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async getProducts(t){if(!(t&&t?.trim()))return[];let e={businessId:"YB100423253156428"};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await Vi({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getConsigee(t){if(!(t&&t?.trim()))return[];let e={businessId:"all"};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await Vi({query:"getScanConsigneeYabaExpress",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getShipper(t){if(!(t&&t?.trim()))return[];let e={businessId:"all"};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await Vi({query:"getScanShipperYabaExpress",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getInvoice(t,e){if(!(t&&t?.trim()))return[];let r={businessId:"YB100423253156428"};return t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())}),await Vi({query:"getScanYabaSalesOrders",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async addInventory(t){return await Vi({query:"addYabaInventory",params:{businessId:"YB100423253156428"},form:t})},async updInventory(t){return await hS()},async addInvoice(t){return await Vi({query:"addYabaSalesOrders",params:{businessId:"YB100423253156428"},form:t})},async getHBLS(t,e){if(!(t&&t?.trim()))return[];let r={businessId:"YB100423253156428"};return e?.search,e?.guia&&e.guia!=="all"&&(r.guia=e.guia),t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())}),await Vi({query:"getScanYabaHbls",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4 AND guia = guia",params:r})}},Rm={async getAll(t){return Ai.getInventory("ref")},async getById(t){return Pi(async()=>{throw console.log("Getting movement by ID via real API:",t),new Error("Real API not implemented yet")},()=>li.movements.getById(t))},async create(t){return Pi(async()=>{throw console.log("Creating movement via real API:",t),new Error("Real API not implemented yet")},()=>li.movements.create(t))},async update(t,e){return Pi(async()=>{throw console.log("Updating movement via real API:",t,e),new Error("Real API not implemented yet")},()=>li.movements.update(t,e))},async createBulk(t){return Pi(async()=>{throw console.log("Creating bulk movements via real API:",t),new Error("Real API not implemented yet")},()=>li.movements.createBulk(t))},async getStockLevels(t){return await Vi({query:"calculateInventoryStock",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:t})},async calcStockLevels(){return[]}},Sg={async getAll(t){return Pi(async()=>{throw console.log("Getting accounts via real API:",t),new Error("Real API not implemented yet")},()=>li.accounts.getAll(t))},async getById(t){return Pi(async()=>{throw console.log("Getting account by ID via real API:",t),new Error("Real API not implemented yet")},()=>li.accounts.getById(t))},async create(t){return Pi(async()=>{throw console.log("Creating account via real API:",t),new Error("Real API not implemented yet")},()=>li.accounts.create(t))},async update(t,e){return Pi(async()=>{throw console.log("Updating account via real API:",t,e),new Error("Real API not implemented yet")},()=>li.accounts.update(t,e))}},Pg={async getNextEntryNumber(){return Pi(async()=>{throw console.log("Getting next entry number via real API"),new Error("Real API not implemented yet")},()=>li.utils.getNextEntryNumber())},async getNextProductCode(t){return Pi(async()=>{throw console.log("Getting next product code via real API:",t),new Error("Real API not implemented yet")},()=>li.utils.getNextProductCode(t))},async healthCheck(){return Pi(async()=>{const t=await fetch("/api/health");if(!t.ok)throw new Error("Health check failed");return t.json()},()=>li.utils.healthCheck())},async getStats(){return Pi(async()=>{throw console.log("Getting stats via real API"),new Error("Real API not implemented yet")},()=>li.utils.getStats())}},pS=()=>{$u.setMode("real"),console.log(" HRM Finance initialized in REAL API mode for production")};pS();const mS=()=>{};var xg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q1=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},yS=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[r++];e[n++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[r++],s=t[r++],a=t[r++],c=((i&7)<<18|(o&63)<<12|(s&63)<<6|a&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const o=t[r++],s=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(o&63)<<6|s&63)}}return e.join("")},U1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const o=t[i],s=i+1<t.length,a=s?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,f=o>>2,y=(o&3)<<4|a>>4;let v=(a&15)<<2|u>>6,p=u&63;c||(p=64,s||(v=64)),n.push(r[f],r[y],r[v],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(q1(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):yS(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const o=r[t.charAt(i++)],a=i<t.length?r[t.charAt(i)]:0;++i;const u=i<t.length?r[t.charAt(i)]:64;++i;const y=i<t.length?r[t.charAt(i)]:64;if(++i,o==null||a==null||u==null||y==null)throw new gS;const v=o<<2|a>>4;if(n.push(v),u!==64){const p=a<<4&240|u>>2;if(n.push(p),y!==64){const I=u<<6&192|y;n.push(I)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class gS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const vS=function(t){const e=q1(t);return U1.encodeByteArray(e,!0)},gh=function(t){return vS(t).replace(/\./g,"")},H1=function(t){try{return U1.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _S=()=>bS().__FIREBASE_DEFAULTS__,wS=()=>{if(typeof process>"u"||typeof xg>"u")return;const t=xg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},SS=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&H1(t[1]);return e&&JSON.parse(e)},qh=()=>{try{return mS()||_S()||wS()||SS()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},W1=t=>qh()?.emulatorHosts?.[t],PS=t=>{const e=W1(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},G1=()=>qh()?.config,Y1=t=>qh()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xc(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function K1(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AS(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[gh(JSON.stringify(r)),gh(JSON.stringify(s)),""].join(".")}const du={};function CS(){const t={prod:[],emulator:[]};for(const e of Object.keys(du))du[e]?t.emulator.push(e):t.prod.push(e);return t}function IS(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let Ag=!1;function J1(t,e){if(typeof window>"u"||typeof document>"u"||!xc(window.location.host)||du[t]===e||du[t]||Ag)return;du[t]=e;function r(v){return`__firebase__banner__${v}`}const n="__firebase__banner",o=CS().prod.length>0;function s(){const v=document.getElementById(n);v&&v.remove()}function a(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function c(v,p){v.setAttribute("width","24"),v.setAttribute("id",p),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function u(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{Ag=!0,s()},v}function f(v,p){v.setAttribute("id",p),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function y(){const v=IS(n),p=r("text"),I=document.getElementById(p)||document.createElement("span"),P=r("learnmore"),w=document.getElementById(P)||document.createElement("a"),x=r("preprendIcon"),j=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const ne=v.element;a(ne),f(w,P);const Q=u();c(j,x),ne.append(j,I,w,Q),document.body.appendChild(ne)}o?(I.innerText="Preview backend disconnected.",j.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(j.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,I.innerText="Preview backend running in this workspace."),I.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ci(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function $S(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ci())}function kS(){const t=qh()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ES(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function TS(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function NS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function LS(){const t=Ci();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function DS(){return!kS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function RS(){try{return typeof indexedDB=="object"}catch{return!1}}function MS(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FS="FirebaseError";class Bs extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=FS,Object.setPrototypeOf(this,Bs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,qu.prototype.create)}}class qu{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,o=this.errors[e],s=o?OS(o,n):"Error",a=`${this.serviceName}: ${s} (${i}).`;return new Bs(i,a,n)}}function OS(t,e){return t.replace(BS,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const BS=/\{\$([^}]+)}/g;function jS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Sl(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const o=t[i],s=e[i];if(Cg(o)&&Cg(s)){if(!Sl(o,s))return!1}else if(o!==s)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function Cg(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uu(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function VS(t,e){const r=new zS(t,e);return r.subscribe.bind(r)}class zS{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");qS(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Mf),i.error===void 0&&(i.error=Mf),i.complete===void 0&&(i.complete=Mf);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function qS(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Mf(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ui(t){return t&&t._delegate?t._delegate:t}class Pl{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new xS;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(WS(e))try{this.getOrInitializeService({instanceIdentifier:sl})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=sl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=sl){return this.instances.has(e)}getOptions(e=sl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(o);n===a&&s.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const o=this.instances.get(n);return o&&e(o,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:HS(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=sl){return this.component?this.component.multipleInstances?e:sl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function HS(t){return t===sl?void 0:t}function WS(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new US(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dr;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Dr||(Dr={}));const YS={debug:Dr.DEBUG,verbose:Dr.VERBOSE,info:Dr.INFO,warn:Dr.WARN,error:Dr.ERROR,silent:Dr.SILENT},KS=Dr.INFO,JS={[Dr.DEBUG]:"log",[Dr.VERBOSE]:"log",[Dr.INFO]:"info",[Dr.WARN]:"warn",[Dr.ERROR]:"error"},QS=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=JS[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Mm{constructor(e){this.name=e,this._logLevel=KS,this._logHandler=QS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Dr))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?YS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Dr.DEBUG,...e),this._logHandler(this,Dr.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Dr.VERBOSE,...e),this._logHandler(this,Dr.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Dr.INFO,...e),this._logHandler(this,Dr.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Dr.WARN,...e),this._logHandler(this,Dr.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Dr.ERROR,...e),this._logHandler(this,Dr.ERROR,...e)}}const XS=(t,e)=>e.some(r=>t instanceof r);let Ig,$g;function ZS(){return Ig||(Ig=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function eP(){return $g||($g=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Q1=new WeakMap,Op=new WeakMap,X1=new WeakMap,Ff=new WeakMap,Fm=new WeakMap;function tP(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",s)},o=()=>{r(Pa(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",s)});return e.then(r=>{r instanceof IDBCursor&&Q1.set(r,t)}).catch(()=>{}),Fm.set(e,t),e}function rP(t){if(Op.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",s),t.removeEventListener("abort",s)},o=()=>{r(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",s),t.addEventListener("abort",s)});Op.set(t,e)}let Bp={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Op.get(t);if(e==="objectStoreNames")return t.objectStoreNames||X1.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Pa(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function nP(t){Bp=t(Bp)}function iP(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Of(this),e,...r);return X1.set(n,e.sort?e.sort():[e]),Pa(n)}:eP().includes(t)?function(...e){return t.apply(Of(this),e),Pa(Q1.get(this))}:function(...e){return Pa(t.apply(Of(this),e))}}function oP(t){return typeof t=="function"?iP(t):(t instanceof IDBTransaction&&rP(t),XS(t,ZS())?new Proxy(t,Bp):t)}function Pa(t){if(t instanceof IDBRequest)return tP(t);if(Ff.has(t))return Ff.get(t);const e=oP(t);return e!==t&&(Ff.set(t,e),Fm.set(e,t)),e}const Of=t=>Fm.get(t);function sP(t,e,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const s=indexedDB.open(t,e),a=Pa(s);return n&&s.addEventListener("upgradeneeded",c=>{n(Pa(s.result),c.oldVersion,c.newVersion,Pa(s.transaction),c)}),r&&s.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),a.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const aP=["get","getKey","getAll","getAllKeys","count"],lP=["put","add","delete","clear"],Bf=new Map;function kg(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Bf.get(e))return Bf.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=lP.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||aP.includes(r)))return;const o=async function(s,...a){const c=this.transaction(s,i?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(a.shift())),(await Promise.all([u[r](...a),i&&c.done]))[0]};return Bf.set(e,o),o}nP(t=>({...t,get:(e,r,n)=>kg(e,r)||t.get(e,r,n),has:(e,r)=>!!kg(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(uP(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function uP(t){return t.getComponent()?.type==="VERSION"}const jp="@firebase/app",Eg="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ls=new Mm("@firebase/app"),dP="@firebase/app-compat",hP="@firebase/analytics-compat",fP="@firebase/analytics",pP="@firebase/app-check-compat",mP="@firebase/app-check",yP="@firebase/auth",gP="@firebase/auth-compat",vP="@firebase/database",bP="@firebase/data-connect",_P="@firebase/database-compat",wP="@firebase/functions",SP="@firebase/functions-compat",PP="@firebase/installations",xP="@firebase/installations-compat",AP="@firebase/messaging",CP="@firebase/messaging-compat",IP="@firebase/performance",$P="@firebase/performance-compat",kP="@firebase/remote-config",EP="@firebase/remote-config-compat",TP="@firebase/storage",NP="@firebase/storage-compat",LP="@firebase/firestore",DP="@firebase/ai",RP="@firebase/firestore-compat",MP="firebase",FP="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vp="[DEFAULT]",OP={[jp]:"fire-core",[dP]:"fire-core-compat",[fP]:"fire-analytics",[hP]:"fire-analytics-compat",[mP]:"fire-app-check",[pP]:"fire-app-check-compat",[yP]:"fire-auth",[gP]:"fire-auth-compat",[vP]:"fire-rtdb",[bP]:"fire-data-connect",[_P]:"fire-rtdb-compat",[wP]:"fire-fn",[SP]:"fire-fn-compat",[PP]:"fire-iid",[xP]:"fire-iid-compat",[AP]:"fire-fcm",[CP]:"fire-fcm-compat",[IP]:"fire-perf",[$P]:"fire-perf-compat",[kP]:"fire-rc",[EP]:"fire-rc-compat",[TP]:"fire-gcs",[NP]:"fire-gcs-compat",[LP]:"fire-fst",[RP]:"fire-fst-compat",[DP]:"fire-vertex","fire-js":"fire-js",[MP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vh=new Map,BP=new Map,zp=new Map;function Tg(t,e){try{t.container.addComponent(e)}catch(r){Ls.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function mc(t){const e=t.name;if(zp.has(e))return Ls.debug(`There were multiple attempts to register component ${e}.`),!1;zp.set(e,t);for(const r of vh.values())Tg(r,t);for(const r of BP.values())Tg(r,t);return!0}function Om(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function yo(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xa=new qu("app","Firebase",jP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Pl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xa.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ac=FP;function Z1(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Vp,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw xa.create("bad-app-name",{appName:String(i)});if(r||(r=G1()),!r)throw xa.create("no-options");const o=vh.get(i);if(o){if(Sl(r,o.options)&&Sl(n,o.config))return o;throw xa.create("duplicate-app",{appName:i})}const s=new GS(i);for(const c of zp.values())s.addComponent(c);const a=new VP(r,n,s);return vh.set(i,a),a}function eb(t=Vp){const e=vh.get(t);if(!e&&t===Vp&&G1())return Z1();if(!e)throw xa.create("no-app",{appName:t});return e}function Aa(t,e,r){let n=OP[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const s=[`Unable to register library "${n}" with version "${e}":`];i&&s.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&o&&s.push("and"),o&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ls.warn(s.join(" "));return}mc(new Pl(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zP="firebase-heartbeat-database",qP=1,ku="firebase-heartbeat-store";let jf=null;function tb(){return jf||(jf=sP(zP,qP,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ku)}catch(r){console.warn(r)}}}}).catch(t=>{throw xa.create("idb-open",{originalErrorMessage:t.message})})),jf}async function UP(t){try{const r=(await tb()).transaction(ku),n=await r.objectStore(ku).get(rb(t));return await r.done,n}catch(e){if(e instanceof Bs)Ls.warn(e.message);else{const r=xa.create("idb-get",{originalErrorMessage:e?.message});Ls.warn(r.message)}}}async function Ng(t,e){try{const n=(await tb()).transaction(ku,"readwrite");await n.objectStore(ku).put(e,rb(t)),await n.done}catch(r){if(r instanceof Bs)Ls.warn(r.message);else{const n=xa.create("idb-set",{originalErrorMessage:r?.message});Ls.warn(n.message)}}}function rb(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HP=1024,WP=30;class GP{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new KP(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Lg();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>WP){const i=JP(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Ls.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Lg(),{heartbeatsToSend:r,unsentEntries:n}=YP(this._heartbeatsCache.heartbeats),i=gh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Ls.warn(e),""}}}function Lg(){return new Date().toISOString().substring(0,10)}function YP(t,e=HP){const r=[];let n=t.slice();for(const i of t){const o=r.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),Dg(r)>e){o.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Dg(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class KP{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return RS()?MS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await UP(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Ng(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Ng(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Dg(t){return gh(JSON.stringify({version:2,heartbeats:t})).length}function JP(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QP(t){mc(new Pl("platform-logger",e=>new cP(e),"PRIVATE")),mc(new Pl("heartbeat",e=>new GP(e),"PRIVATE")),Aa(jp,Eg,t),Aa(jp,Eg,"esm2020"),Aa("fire-js","")}QP("");function nb(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const XP=nb,ib=new qu("auth","Firebase",nb());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bh=new Mm("@firebase/auth");function ZP(t,...e){bh.logLevel<=Dr.WARN&&bh.warn(`Auth (${Ac}): ${t}`,...e)}function Jd(t,...e){bh.logLevel<=Dr.ERROR&&bh.error(`Auth (${Ac}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function os(t,...e){throw jm(t,...e)}function Lo(t,...e){return jm(t,...e)}function Bm(t,e,r){const n={...XP(),[e]:r};return new qu("auth","Firebase",n).create(e,{appName:t.name})}function Ca(t){return Bm(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ob(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&os(t,"argument-error"),Bm(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function jm(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return ib.create(t,...e)}function fr(t,e,...r){if(!t)throw jm(e,...r)}function Is(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Jd(e),new Error(e)}function Ds(t,e){t||Is(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qp(){return typeof self<"u"&&self.location?.href||""}function ex(){return Rg()==="http:"||Rg()==="https:"}function Rg(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tx(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ex()||TS()||"connection"in navigator)?navigator.onLine:!0}function rx(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hu{constructor(e,r){this.shortDelay=e,this.longDelay=r,Ds(r>e,"Short delay should be less than long delay!"),this.isMobile=$S()||NS()}get(){return tx()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vm(t,e){Ds(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Is("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Is("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Is("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nx={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ix=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],ox=new Hu(3e4,6e4);function zm(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Cc(t,e,r,n,i={}){return ab(t,i,async()=>{let o={},s={};n&&(e==="GET"?s=n:o={body:JSON.stringify(n)});const a=Uu({key:t.config.apiKey,...s}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:c,...o};return ES()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&xc(t.emulatorConfig.host)&&(u.credentials="include"),sb.fetch()(await lb(t,t.config.apiHost,r,a),u)})}async function ab(t,e,r){t._canInitEmulator=!1;const n={...nx,...e};try{const i=new ax(t),o=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const s=await o.json();if("needConfirmation"in s)throw Cd(t,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{const a=o.ok?s.errorMessage:s.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Cd(t,"credential-already-in-use",s);if(c==="EMAIL_EXISTS")throw Cd(t,"email-already-in-use",s);if(c==="USER_DISABLED")throw Cd(t,"user-disabled",s);const f=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Bm(t,f,u);os(t,f)}}catch(i){if(i instanceof Bs)throw i;os(t,"network-request-failed",{message:String(i)})}}async function sx(t,e,r,n,i={}){const o=await Cc(t,e,r,n,i);return"mfaPendingCredential"in o&&os(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function lb(t,e,r,n){const i=`${e}${r}?${n}`,o=t,s=o.config.emulator?Vm(t.config,i):`${t.config.apiScheme}://${i}`;return ix.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(s).toString():s}class ax{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Lo(this.auth,"network-request-failed")),ox.get())})}}function Cd(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Lo(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lx(t,e){return Cc(t,"POST","/v1/accounts:delete",e)}async function _h(t,e){return Cc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function cx(t,e=!1){const r=ui(t),n=await r.getIdToken(e),i=qm(n);fr(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,s=o?.sign_in_provider;return{claims:i,token:n,authTime:hu(Vf(i.auth_time)),issuedAtTime:hu(Vf(i.iat)),expirationTime:hu(Vf(i.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}}function Vf(t){return Number(t)*1e3}function qm(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Jd("JWT malformed, contained fewer than 3 sections"),null;try{const i=H1(r);return i?JSON.parse(i):(Jd("Failed to decode base64 JWT payload"),null)}catch(i){return Jd("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Mg(t){const e=qm(t);return fr(e,"internal-error"),fr(typeof e.exp<"u","internal-error"),fr(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Eu(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Bs&&ux(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function ux({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dx{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Up{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=hu(this.lastLoginAt),this.creationTime=hu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wh(t){const e=t.auth,r=await t.getIdToken(),n=await Eu(t,_h(e,{idToken:r}));fr(n?.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const o=i.providerUserInfo?.length?cb(i.providerUserInfo):[],s=fx(t.providerData,o),a=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!s?.length,u=a?c:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Up(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,f)}async function hx(t){const e=ui(t);await wh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function fx(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function cb(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function px(t,e){const r=await ab(t,{},async()=>{const n=Uu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,s=await lb(t,i,"/v1/token",`key=${o}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:n};return t.emulatorConfig&&xc(t.emulatorConfig.host)&&(c.credentials="include"),sb.fetch()(s,c)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function mx(t,e){return Cc(t,"POST","/v2/accounts:revokeToken",zm(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){fr(e.idToken,"internal-error"),fr(typeof e.idToken<"u","internal-error"),fr(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Mg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){fr(e.length!==0,"internal-error");const r=Mg(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(fr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:o}=await px(e,r);this.updateTokensAndExpiration(n,i,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:o}=r,s=new cc;return n&&(fr(typeof n=="string","internal-error",{appName:e}),s.refreshToken=n),i&&(fr(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),o&&(fr(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new cc,this.toJSON())}_performRefresh(){return Is("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ca(t,e){fr(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class No{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new dx(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Up(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Eu(this,this.stsTokenManager.getToken(this.auth,e));return fr(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return cx(this,e)}reload(){return hx(this)}_assign(e){this!==e&&(fr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new No({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){fr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await wh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(yo(this.auth.app))return Promise.reject(Ca(this.auth));const e=await this.getIdToken();return await Eu(this,lx(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,o=r.phoneNumber??void 0,s=r.photoURL??void 0,a=r.tenantId??void 0,c=r._redirectEventId??void 0,u=r.createdAt??void 0,f=r.lastLoginAt??void 0,{uid:y,emailVerified:v,isAnonymous:p,providerData:I,stsTokenManager:P}=r;fr(y&&P,e,"internal-error");const w=cc.fromJSON(this.name,P);fr(typeof y=="string",e,"internal-error"),ca(n,e.name),ca(i,e.name),fr(typeof v=="boolean",e,"internal-error"),fr(typeof p=="boolean",e,"internal-error"),ca(o,e.name),ca(s,e.name),ca(a,e.name),ca(c,e.name),ca(u,e.name),ca(f,e.name);const x=new No({uid:y,auth:e,email:i,emailVerified:v,displayName:n,isAnonymous:p,photoURL:s,phoneNumber:o,tenantId:a,stsTokenManager:w,createdAt:u,lastLoginAt:f});return I&&Array.isArray(I)&&(x.providerData=I.map(j=>({...j}))),c&&(x._redirectEventId=c),x}static async _fromIdTokenResponse(e,r,n=!1){const i=new cc;i.updateFromServerResponse(r);const o=new No({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await wh(o),o}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];fr(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?cb(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!o?.length,a=new cc;a.updateFromIdToken(n);const c=new No({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:s}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Up(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fg=new Map;function $s(t){Ds(t instanceof Function,"Expected a class definition");let e=Fg.get(t);return e?(Ds(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Fg.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}ub.type="NONE";const Og=ub;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qd(t,e,r){return`firebase:${t}:${e}:${r}`}class uc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:o}=this.auth;this.fullUserKey=Qd(this.userKey,i.apiKey,o),this.fullPersistenceKey=Qd("persistence",i.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await _h(this.auth,{idToken:e}).catch(()=>{});return r?No._fromGetAccountInfoResponse(this.auth,r,e):null}return No._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new uc($s(Og),e,n);const i=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let o=i[0]||$s(Og);const s=Qd(n,e.config.apiKey,e.name);let a=null;for(const u of r)try{const f=await u._get(s);if(f){let y;if(typeof f=="string"){const v=await _h(e,{idToken:f}).catch(()=>{});if(!v)break;y=await No._fromGetAccountInfoResponse(e,v,f)}else y=No._fromJSON(e,f);u!==o&&(a=y),o=u;break}}catch{}const c=i.filter(u=>u._shouldAllowMigration);return!o._shouldAllowMigration||!c.length?new uc(o,e,n):(o=c[0],a&&await o._set(s,a.toJSON()),await Promise.all(r.map(async u=>{if(u!==o)try{await u._remove(s)}catch{}})),new uc(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bg(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(pb(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(db(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(yb(e))return"Blackberry";if(gb(e))return"Webos";if(hb(e))return"Safari";if((e.includes("chrome/")||fb(e))&&!e.includes("edge/"))return"Chrome";if(mb(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function db(t=Ci()){return/firefox\//i.test(t)}function hb(t=Ci()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function fb(t=Ci()){return/crios\//i.test(t)}function pb(t=Ci()){return/iemobile/i.test(t)}function mb(t=Ci()){return/android/i.test(t)}function yb(t=Ci()){return/blackberry/i.test(t)}function gb(t=Ci()){return/webos/i.test(t)}function Um(t=Ci()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function yx(t=Ci()){return Um(t)&&!!window.navigator?.standalone}function gx(){return LS()&&document.documentMode===10}function vb(t=Ci()){return Um(t)||mb(t)||gb(t)||yb(t)||/windows phone/i.test(t)||pb(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bb(t,e=[]){let r;switch(t){case"Browser":r=Bg(Ci());break;case"Worker":r=`${Bg(Ci())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Ac}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vx{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((s,a)=>{try{const c=e(o);s(c)}catch(c){a(c)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bx(t,e={}){return Cc(t,"GET","/v2/passwordPolicy",zm(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _x=6;class wx{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??_x,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sx{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new jg(this),this.idTokenSubscription=new jg(this),this.beforeStateQueue=new vx(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ib,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=$s(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await uc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await _h(this,{idToken:e}),n=await No._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(yo(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(s,s))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,s=n?._redirectEventId,a=await this.tryRedirectSignIn(e);(!o||o===s)&&a?.user&&(n=a.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return fr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await wh(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=rx()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(yo(this.app))return Promise.reject(Ca(this));const r=e?ui(e):null;return r&&fr(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&fr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return yo(this.app)?Promise.reject(Ca(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return yo(this.app)?Promise.reject(Ca(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence($s(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await bx(this),r=new wx(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new qu("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await mx(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&$s(e)||this._popupRedirectResolver;fr(r,this,"argument-error"),this.redirectPersistenceManager=await uc.create(this,[$s(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let s=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(fr(a,this,"internal-error"),a.then(()=>{s||o(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,i);return()=>{s=!0,c()}}else{const c=e.addObserver(r);return()=>{s=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return fr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=bb(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(yo(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&ZP(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Il(t){return ui(t)}class jg{constructor(e){this.auth=e,this.observer=null,this.addObserver=VS(r=>this.observer=r)}get next(){return fr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Px(t){Hm=t}function xx(t){return Hm.loadJS(t)}function Ax(){return Hm.gapiScript}function Cx(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ix(t,e){const r=Om(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),o=r.getOptions();if(Sl(o,e??{}))return i;os(i,"already-initialized")}return r.initialize({options:e})}function $x(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map($s);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function kx(t,e,r){const n=Il(t);fr(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,o=_b(e),{host:s,port:a}=Ex(e),c=a===null?"":`:${a}`,u={url:`${o}//${s}${c}/`},f=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){fr(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),fr(Sl(u,n.config.emulator)&&Sl(f,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=u,n.emulatorConfig=f,n.settings.appVerificationDisabledForTesting=!0,xc(s)?(K1(`${o}//${s}${c}`),J1("Auth",!0)):Tx()}function _b(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Ex(t){const e=_b(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const o=i[1];return{host:o,port:Vg(n.substr(o.length+1))}}else{const[o,s]=n.split(":");return{host:o,port:Vg(s)}}}function Vg(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Tx(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wb{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Is("not implemented")}_getIdTokenResponse(e){return Is("not implemented")}_linkToIdToken(e,r){return Is("not implemented")}_getReauthenticationResolver(e){return Is("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dc(t,e){return sx(t,"POST","/v1/accounts:signInWithIdp",zm(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nx="http://localhost";class xl extends wb{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new xl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):os("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...o}=r;if(!n||!i)return null;const s=new xl(n,i);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){const r=this.buildRequest();return dc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,dc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,dc(e,r)}buildRequest(){const e={requestUri:Nx,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Uu(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu extends Uh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya extends Wu{constructor(){super("facebook.com")}static credential(e){return xl._fromParams({providerId:ya.PROVIDER_ID,signInMethod:ya.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ya.credentialFromTaggedObject(e)}static credentialFromError(e){return ya.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ya.credential(e.oauthAccessToken)}catch{return null}}}ya.FACEBOOK_SIGN_IN_METHOD="facebook.com";ya.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo extends Wu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return xl._fromParams({providerId:Jo.PROVIDER_ID,signInMethod:Jo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Jo.credentialFromTaggedObject(e)}static credentialFromError(e){return Jo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Jo.credential(r,n)}catch{return null}}}Jo.GOOGLE_SIGN_IN_METHOD="google.com";Jo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga extends Wu{constructor(){super("github.com")}static credential(e){return xl._fromParams({providerId:ga.PROVIDER_ID,signInMethod:ga.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ga.credentialFromTaggedObject(e)}static credentialFromError(e){return ga.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ga.credential(e.oauthAccessToken)}catch{return null}}}ga.GITHUB_SIGN_IN_METHOD="github.com";ga.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va extends Wu{constructor(){super("twitter.com")}static credential(e,r){return xl._fromParams({providerId:va.PROVIDER_ID,signInMethod:va.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return va.credentialFromTaggedObject(e)}static credentialFromError(e){return va.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return va.credential(r,n)}catch{return null}}}va.TWITTER_SIGN_IN_METHOD="twitter.com";va.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const o=await No._fromIdTokenResponse(e,n,i),s=zg(n);return new yc({user:o,providerId:s,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=zg(n);return new yc({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function zg(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh extends Bs{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Sh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new Sh(e,r,n,i)}}function Sb(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Sh._fromErrorAndOperation(t,o,e,n):o})}async function Lx(t,e,r=!1){const n=await Eu(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return yc._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dx(t,e,r=!1){const{auth:n}=t;if(yo(n.app))return Promise.reject(Ca(n));const i="reauthenticate";try{const o=await Eu(t,Sb(n,i,e,t),r);fr(o.idToken,n,"internal-error");const s=qm(o.idToken);fr(s,n,"internal-error");const{sub:a}=s;return fr(t.uid===a,n,"user-mismatch"),yc._forOperation(t,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&os(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pb(t,e,r=!1){if(yo(t.app))return Promise.reject(Ca(t));const n="signIn",i=await Sb(t,n,e),o=await yc._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(o.user),o}async function Rx(t,e){return Pb(Il(t),e)}function Mx(t,e,r,n){return ui(t).onIdTokenChanged(e,r,n)}function Fx(t,e,r){return ui(t).beforeAuthStateChanged(e,r)}function Ox(t,e,r,n){return ui(t).onAuthStateChanged(e,r,n)}function Bx(t){return ui(t).signOut()}const Ph="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xb{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Ph,"1"),this.storage.removeItem(Ph),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jx=1e3,Vx=10;class Ab extends xb{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=vb(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((s,a,c)=>{this.notifyListeners(s,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const s=this.storage.getItem(n);!r&&this.localCache[n]===s||this.notifyListeners(n,s)},o=this.storage.getItem(n);gx()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Vx):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},jx)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ab.type="LOCAL";const zx=Ab;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cb extends xb{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}Cb.type="SESSION";const Ib=Cb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qx(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new Hh(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:o}=r.data,s=this.handlersMap[i];if(!s?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const a=Array.from(s).map(async u=>u(r.origin,o)),c=await qx(a);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Hh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wm(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,s;return new Promise((a,c)=>{const u=Wm("",20);i.port1.start();const f=setTimeout(()=>{c(new Error("unsupported_event"))},n);s={messageChannel:i,onMessage(y){const v=y;if(v.data.eventId===u)switch(v.data.status){case"ack":clearTimeout(f),o=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(v.data.response);break;default:clearTimeout(f),clearTimeout(o),c(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xo(){return window}function Hx(t){Xo().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $b(){return typeof Xo().WorkerGlobalScope<"u"&&typeof Xo().importScripts=="function"}async function Wx(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Gx(){return navigator?.serviceWorker?.controller||null}function Yx(){return $b()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kb="firebaseLocalStorageDb",Kx=1,xh="firebaseLocalStorage",Eb="fbase_key";class Gu{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Wh(t,e){return t.transaction([xh],e?"readwrite":"readonly").objectStore(xh)}function Jx(){const t=indexedDB.deleteDatabase(kb);return new Gu(t).toPromise()}function Hp(){const t=indexedDB.open(kb,Kx);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(xh,{keyPath:Eb})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(xh)?e(n):(n.close(),await Jx(),e(await Hp()))})})}async function qg(t,e,r){const n=Wh(t,!0).put({[Eb]:e,value:r});return new Gu(n).toPromise()}async function Qx(t,e){const r=Wh(t,!1).get(e),n=await new Gu(r).toPromise();return n===void 0?null:n.value}function Ug(t,e){const r=Wh(t,!0).delete(e);return new Gu(r).toPromise()}const Xx=800,Zx=3;class Tb{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Hp(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>Zx)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return $b()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Hh._getInstance(Yx()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await Wx(),!this.activeServiceWorker)return;this.sender=new Ux(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Gx()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Hp();return await qg(e,Ph,"1"),await Ug(e,Ph),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>qg(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>Qx(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>Ug(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=Wh(i,!1).getAll();return new Gu(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Xx)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Tb.type="LOCAL";const eA=Tb;new Hu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gm(t,e){return e?$s(e):(fr(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ym extends wb{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return dc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return dc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return dc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function tA(t){return Pb(t.auth,new Ym(t),t.bypassAuthState)}function rA(t){const{auth:e,user:r}=t;return fr(r,e,"internal-error"),Dx(r,new Ym(t),t.bypassAuthState)}async function nA(t){const{auth:e,user:r}=t;return fr(r,e,"internal-error"),Lx(r,new Ym(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nb{constructor(e,r,n,i,o=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:o,error:s,type:a}=e;if(s){this.reject(s);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return tA;case"linkViaPopup":case"linkViaRedirect":return nA;case"reauthViaPopup":case"reauthViaRedirect":return rA;default:os(this.auth,"internal-error")}}resolve(e){Ds(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ds(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iA=new Hu(2e3,1e4);async function oA(t,e,r){if(yo(t.app))return Promise.reject(Lo(t,"operation-not-supported-in-this-environment"));const n=Il(t);ob(t,e,Uh);const i=Gm(n,r);return new fl(n,"signInViaPopup",e,i).executeNotNull()}class fl extends Nb{constructor(e,r,n,i,o){super(e,r,i,o),this.provider=n,this.authWindow=null,this.pollId=null,fl.currentPopupAction&&fl.currentPopupAction.cancel(),fl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return fr(e,this.auth,"internal-error"),e}async onExecution(){Ds(this.filter.length===1,"Popup operations only handle one event");const e=Wm();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Lo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Lo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,fl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Lo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,iA.get())};e()}}fl.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sA="pendingRedirect",Xd=new Map;class aA extends Nb{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Xd.get(this.auth._key());if(!e){try{const n=await lA(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Xd.set(this.auth._key(),e)}return this.bypassAuthState||Xd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function lA(t,e){const r=Db(e),n=Lb(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}async function cA(t,e){return Lb(t)._set(Db(e),"true")}function uA(t,e){Xd.set(t._key(),e)}function Lb(t){return $s(t._redirectPersistence)}function Db(t){return Qd(sA,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dA(t,e,r){return hA(t,e,r)}async function hA(t,e,r){if(yo(t.app))return Promise.reject(Ca(t));const n=Il(t);ob(t,e,Uh),await n._initializationPromise;const i=Gm(n,r);return await cA(i,n),i._openRedirect(n,e,"signInViaRedirect")}async function fA(t,e){return await Il(t)._initializationPromise,Rb(t,e,!1)}async function Rb(t,e,r=!1){if(yo(t.app))return Promise.reject(Ca(t));const n=Il(t),i=Gm(n,e),s=await new aA(n,i,r).execute();return s&&!r&&(delete s.user._redirectEventId,await n._persistUserIfCurrent(s.user),await n._setRedirectUser(null,e)),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA=10*60*1e3;class mA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!yA(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!Mb(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Lo(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=pA&&this.cachedEventUids.clear(),this.cachedEventUids.has(Hg(e))}saveEventToCache(e){this.cachedEventUids.add(Hg(e)),this.lastProcessedEventTime=Date.now()}}function Hg(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Mb({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function yA(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Mb(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gA(t,e={}){return Cc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vA=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,bA=/^https?/;async function _A(t){if(t.config.emulator)return;const{authorizedDomains:e}=await gA(t);for(const r of e)try{if(wA(r))return}catch{}os(t,"unauthorized-domain")}function wA(t){const e=qp(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return s.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&s.hostname===n}if(!bA.test(r))return!1;if(vA.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SA=new Hu(3e4,6e4);function Wg(){const t=Xo().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function PA(t){return new Promise((e,r)=>{function n(){Wg(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Wg(),r(Lo(t,"network-request-failed"))},timeout:SA.get()})}if(Xo().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Xo().gapi?.load)n();else{const i=Cx("iframefcb");return Xo()[i]=()=>{gapi.load?n():r(Lo(t,"network-request-failed"))},xx(`${Ax()}?onload=${i}`).catch(o=>r(o))}}).catch(e=>{throw Zd=null,e})}let Zd=null;function xA(t){return Zd=Zd||PA(t),Zd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AA=new Hu(5e3,15e3),CA="__/auth/iframe",IA="emulator/auth/iframe",$A={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},kA=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function EA(t){const e=t.config;fr(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Vm(e,IA):`https://${t.config.authDomain}/${CA}`,n={apiKey:e.apiKey,appName:t.name,v:Ac},i=kA.get(t.config.apiHost);i&&(n.eid=i);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${Uu(n).slice(1)}`}async function TA(t){const e=await xA(t),r=Xo().gapi;return fr(r,t,"internal-error"),e.open({where:document.body,url:EA(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:$A,dontclear:!0},n=>new Promise(async(i,o)=>{await n.restyle({setHideOnLeave:!1});const s=Lo(t,"network-request-failed"),a=Xo().setTimeout(()=>{o(s)},AA.get());function c(){Xo().clearTimeout(a),i(n)}n.ping(c).then(c,()=>{o(s)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NA={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},LA=500,DA=600,RA="_blank",MA="http://localhost";class Gg{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function FA(t,e,r,n=LA,i=DA){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-n)/2,0).toString();let a="";const c={...NA,width:n.toString(),height:i.toString(),top:o,left:s},u=Ci().toLowerCase();r&&(a=fb(u)?RA:r),db(u)&&(e=e||MA,c.scrollbars="yes");const f=Object.entries(c).reduce((v,[p,I])=>`${v}${p}=${I},`,"");if(yx(u)&&a!=="_self")return OA(e||"",a),new Gg(null);const y=window.open(e||"",a,f);fr(y,t,"popup-blocked");try{y.focus()}catch{}return new Gg(y)}function OA(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BA="__/auth/handler",jA="emulator/auth/handler",VA=encodeURIComponent("fac");async function Yg(t,e,r,n,i,o){fr(t.config.authDomain,t,"auth-domain-config-required"),fr(t.config.apiKey,t,"invalid-api-key");const s={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Ac,eventId:i};if(e instanceof Uh){e.setDefaultLanguage(t.languageCode),s.providerId=e.providerId||"",jS(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,y]of Object.entries({}))s[f]=y}if(e instanceof Wu){const f=e.getScopes().filter(y=>y!=="");f.length>0&&(s.scopes=f.join(","))}t.tenantId&&(s.tid=t.tenantId);const a=s;for(const f of Object.keys(a))a[f]===void 0&&delete a[f];const c=await t._getAppCheckToken(),u=c?`#${VA}=${encodeURIComponent(c)}`:"";return`${zA(t)}?${Uu(a).slice(1)}${u}`}function zA({config:t}){return t.emulator?Vm(t,jA):`https://${t.authDomain}/${BA}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zf="webStorageSupport";class qA{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ib,this._completeRedirectFn=Rb,this._overrideRedirectResult=uA}async _openPopup(e,r,n,i){Ds(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await Yg(e,r,n,qp(),i);return FA(e,o,Wm())}async _openRedirect(e,r,n,i){await this._originValidation(e);const o=await Yg(e,r,n,qp(),i);return Hx(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:o}=this.eventManagers[r];return i?Promise.resolve(i):(Ds(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await TA(e),n=new mA(e);return r.register("authEvent",i=>(fr(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(zf,{type:zf},i=>{const o=i?.[0]?.[zf];o!==void 0&&r(!!o),os(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=_A(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return vb()||hb()||Um()}}const UA=qA;var Kg="@firebase/auth",Jg="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HA{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){fr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WA(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function GA(t){mc(new Pl("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=n.options;fr(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:s,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:bb(t)},u=new Sx(n,i,o,c);return $x(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),mc(new Pl("auth-internal",e=>{const r=Il(e.getProvider("auth").getImmediate());return(n=>new HA(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Aa(Kg,Jg,WA(t)),Aa(Kg,Jg,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YA=5*60,KA=Y1("authIdTokenMaxAge")||YA;let Qg=null;const JA=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>KA)return;const i=r?.token;Qg!==i&&(Qg=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function QA(t=eb()){const e=Om(t,"auth");if(e.isInitialized())return e.getImmediate();const r=Ix(t,{popupRedirectResolver:UA,persistence:[eA,zx,Ib]}),n=Y1("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const s=JA(o.toString());Fx(r,s,()=>s(r.currentUser)),Mx(r,a=>s(a))}}const i=W1("auth");return i&&kx(r,`http://${i}`),r}function XA(){return document.getElementsByTagName("head")?.[0]??document}Px({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const o=Lo("internal-error");o.customData=i,r(o)},n.type="text/javascript",n.charset="UTF-8",XA().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});GA("Browser");var ZA="firebase",eC="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Aa(ZA,eC,"app");var Xg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ia,Fb;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,C){function E(){}E.prototype=C.prototype,k.D=C.prototype,k.prototype=new E,k.prototype.constructor=k,k.C=function(M,_,S){for(var b=Array(arguments.length-2),Y=2;Y<arguments.length;Y++)b[Y-2]=arguments[Y];return C.prototype[_].apply(M,b)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(k,C,E){E||(E=0);var M=Array(16);if(typeof C=="string")for(var _=0;16>_;++_)M[_]=C.charCodeAt(E++)|C.charCodeAt(E++)<<8|C.charCodeAt(E++)<<16|C.charCodeAt(E++)<<24;else for(_=0;16>_;++_)M[_]=C[E++]|C[E++]<<8|C[E++]<<16|C[E++]<<24;C=k.g[0],E=k.g[1],_=k.g[2];var S=k.g[3],b=C+(S^E&(_^S))+M[0]+3614090360&4294967295;C=E+(b<<7&4294967295|b>>>25),b=S+(_^C&(E^_))+M[1]+3905402710&4294967295,S=C+(b<<12&4294967295|b>>>20),b=_+(E^S&(C^E))+M[2]+606105819&4294967295,_=S+(b<<17&4294967295|b>>>15),b=E+(C^_&(S^C))+M[3]+3250441966&4294967295,E=_+(b<<22&4294967295|b>>>10),b=C+(S^E&(_^S))+M[4]+4118548399&4294967295,C=E+(b<<7&4294967295|b>>>25),b=S+(_^C&(E^_))+M[5]+1200080426&4294967295,S=C+(b<<12&4294967295|b>>>20),b=_+(E^S&(C^E))+M[6]+2821735955&4294967295,_=S+(b<<17&4294967295|b>>>15),b=E+(C^_&(S^C))+M[7]+4249261313&4294967295,E=_+(b<<22&4294967295|b>>>10),b=C+(S^E&(_^S))+M[8]+1770035416&4294967295,C=E+(b<<7&4294967295|b>>>25),b=S+(_^C&(E^_))+M[9]+2336552879&4294967295,S=C+(b<<12&4294967295|b>>>20),b=_+(E^S&(C^E))+M[10]+4294925233&4294967295,_=S+(b<<17&4294967295|b>>>15),b=E+(C^_&(S^C))+M[11]+2304563134&4294967295,E=_+(b<<22&4294967295|b>>>10),b=C+(S^E&(_^S))+M[12]+1804603682&4294967295,C=E+(b<<7&4294967295|b>>>25),b=S+(_^C&(E^_))+M[13]+4254626195&4294967295,S=C+(b<<12&4294967295|b>>>20),b=_+(E^S&(C^E))+M[14]+2792965006&4294967295,_=S+(b<<17&4294967295|b>>>15),b=E+(C^_&(S^C))+M[15]+1236535329&4294967295,E=_+(b<<22&4294967295|b>>>10),b=C+(_^S&(E^_))+M[1]+4129170786&4294967295,C=E+(b<<5&4294967295|b>>>27),b=S+(E^_&(C^E))+M[6]+3225465664&4294967295,S=C+(b<<9&4294967295|b>>>23),b=_+(C^E&(S^C))+M[11]+643717713&4294967295,_=S+(b<<14&4294967295|b>>>18),b=E+(S^C&(_^S))+M[0]+3921069994&4294967295,E=_+(b<<20&4294967295|b>>>12),b=C+(_^S&(E^_))+M[5]+3593408605&4294967295,C=E+(b<<5&4294967295|b>>>27),b=S+(E^_&(C^E))+M[10]+38016083&4294967295,S=C+(b<<9&4294967295|b>>>23),b=_+(C^E&(S^C))+M[15]+3634488961&4294967295,_=S+(b<<14&4294967295|b>>>18),b=E+(S^C&(_^S))+M[4]+3889429448&4294967295,E=_+(b<<20&4294967295|b>>>12),b=C+(_^S&(E^_))+M[9]+568446438&4294967295,C=E+(b<<5&4294967295|b>>>27),b=S+(E^_&(C^E))+M[14]+3275163606&4294967295,S=C+(b<<9&4294967295|b>>>23),b=_+(C^E&(S^C))+M[3]+4107603335&4294967295,_=S+(b<<14&4294967295|b>>>18),b=E+(S^C&(_^S))+M[8]+1163531501&4294967295,E=_+(b<<20&4294967295|b>>>12),b=C+(_^S&(E^_))+M[13]+2850285829&4294967295,C=E+(b<<5&4294967295|b>>>27),b=S+(E^_&(C^E))+M[2]+4243563512&4294967295,S=C+(b<<9&4294967295|b>>>23),b=_+(C^E&(S^C))+M[7]+1735328473&4294967295,_=S+(b<<14&4294967295|b>>>18),b=E+(S^C&(_^S))+M[12]+2368359562&4294967295,E=_+(b<<20&4294967295|b>>>12),b=C+(E^_^S)+M[5]+4294588738&4294967295,C=E+(b<<4&4294967295|b>>>28),b=S+(C^E^_)+M[8]+2272392833&4294967295,S=C+(b<<11&4294967295|b>>>21),b=_+(S^C^E)+M[11]+1839030562&4294967295,_=S+(b<<16&4294967295|b>>>16),b=E+(_^S^C)+M[14]+4259657740&4294967295,E=_+(b<<23&4294967295|b>>>9),b=C+(E^_^S)+M[1]+2763975236&4294967295,C=E+(b<<4&4294967295|b>>>28),b=S+(C^E^_)+M[4]+1272893353&4294967295,S=C+(b<<11&4294967295|b>>>21),b=_+(S^C^E)+M[7]+4139469664&4294967295,_=S+(b<<16&4294967295|b>>>16),b=E+(_^S^C)+M[10]+3200236656&4294967295,E=_+(b<<23&4294967295|b>>>9),b=C+(E^_^S)+M[13]+681279174&4294967295,C=E+(b<<4&4294967295|b>>>28),b=S+(C^E^_)+M[0]+3936430074&4294967295,S=C+(b<<11&4294967295|b>>>21),b=_+(S^C^E)+M[3]+3572445317&4294967295,_=S+(b<<16&4294967295|b>>>16),b=E+(_^S^C)+M[6]+76029189&4294967295,E=_+(b<<23&4294967295|b>>>9),b=C+(E^_^S)+M[9]+3654602809&4294967295,C=E+(b<<4&4294967295|b>>>28),b=S+(C^E^_)+M[12]+3873151461&4294967295,S=C+(b<<11&4294967295|b>>>21),b=_+(S^C^E)+M[15]+530742520&4294967295,_=S+(b<<16&4294967295|b>>>16),b=E+(_^S^C)+M[2]+3299628645&4294967295,E=_+(b<<23&4294967295|b>>>9),b=C+(_^(E|~S))+M[0]+4096336452&4294967295,C=E+(b<<6&4294967295|b>>>26),b=S+(E^(C|~_))+M[7]+1126891415&4294967295,S=C+(b<<10&4294967295|b>>>22),b=_+(C^(S|~E))+M[14]+2878612391&4294967295,_=S+(b<<15&4294967295|b>>>17),b=E+(S^(_|~C))+M[5]+4237533241&4294967295,E=_+(b<<21&4294967295|b>>>11),b=C+(_^(E|~S))+M[12]+1700485571&4294967295,C=E+(b<<6&4294967295|b>>>26),b=S+(E^(C|~_))+M[3]+2399980690&4294967295,S=C+(b<<10&4294967295|b>>>22),b=_+(C^(S|~E))+M[10]+4293915773&4294967295,_=S+(b<<15&4294967295|b>>>17),b=E+(S^(_|~C))+M[1]+2240044497&4294967295,E=_+(b<<21&4294967295|b>>>11),b=C+(_^(E|~S))+M[8]+1873313359&4294967295,C=E+(b<<6&4294967295|b>>>26),b=S+(E^(C|~_))+M[15]+4264355552&4294967295,S=C+(b<<10&4294967295|b>>>22),b=_+(C^(S|~E))+M[6]+2734768916&4294967295,_=S+(b<<15&4294967295|b>>>17),b=E+(S^(_|~C))+M[13]+1309151649&4294967295,E=_+(b<<21&4294967295|b>>>11),b=C+(_^(E|~S))+M[4]+4149444226&4294967295,C=E+(b<<6&4294967295|b>>>26),b=S+(E^(C|~_))+M[11]+3174756917&4294967295,S=C+(b<<10&4294967295|b>>>22),b=_+(C^(S|~E))+M[2]+718787259&4294967295,_=S+(b<<15&4294967295|b>>>17),b=E+(S^(_|~C))+M[9]+3951481745&4294967295,k.g[0]=k.g[0]+C&4294967295,k.g[1]=k.g[1]+(_+(b<<21&4294967295|b>>>11))&4294967295,k.g[2]=k.g[2]+_&4294967295,k.g[3]=k.g[3]+S&4294967295}n.prototype.u=function(k,C){C===void 0&&(C=k.length);for(var E=C-this.blockSize,M=this.B,_=this.h,S=0;S<C;){if(_==0)for(;S<=E;)i(this,k,S),S+=this.blockSize;if(typeof k=="string"){for(;S<C;)if(M[_++]=k.charCodeAt(S++),_==this.blockSize){i(this,M),_=0;break}}else for(;S<C;)if(M[_++]=k[S++],_==this.blockSize){i(this,M),_=0;break}}this.h=_,this.o+=C},n.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var C=1;C<k.length-8;++C)k[C]=0;var E=8*this.o;for(C=k.length-8;C<k.length;++C)k[C]=E&255,E/=256;for(this.u(k),k=Array(16),C=E=0;4>C;++C)for(var M=0;32>M;M+=8)k[E++]=this.g[C]>>>M&255;return k};function o(k,C){var E=a;return Object.prototype.hasOwnProperty.call(E,k)?E[k]:E[k]=C(k)}function s(k,C){this.h=C;for(var E=[],M=!0,_=k.length-1;0<=_;_--){var S=k[_]|0;M&&S==C||(E[_]=S,M=!1)}this.g=E}var a={};function c(k){return-128<=k&&128>k?o(k,function(C){return new s([C|0],0>C?-1:0)}):new s([k|0],0>k?-1:0)}function u(k){if(isNaN(k)||!isFinite(k))return y;if(0>k)return w(u(-k));for(var C=[],E=1,M=0;k>=E;M++)C[M]=k/E|0,E*=4294967296;return new s(C,0)}function f(k,C){if(k.length==0)throw Error("number format error: empty string");if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(k.charAt(0)=="-")return w(f(k.substring(1),C));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=u(Math.pow(C,8)),M=y,_=0;_<k.length;_+=8){var S=Math.min(8,k.length-_),b=parseInt(k.substring(_,_+S),C);8>S?(S=u(Math.pow(C,S)),M=M.j(S).add(u(b))):(M=M.j(E),M=M.add(u(b)))}return M}var y=c(0),v=c(1),p=c(16777216);t=s.prototype,t.m=function(){if(P(this))return-w(this).m();for(var k=0,C=1,E=0;E<this.g.length;E++){var M=this.i(E);k+=(0<=M?M:4294967296+M)*C,C*=4294967296}return k},t.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(I(this))return"0";if(P(this))return"-"+w(this).toString(k);for(var C=u(Math.pow(k,6)),E=this,M="";;){var _=Q(E,C).g;E=x(E,_.j(C));var S=((0<E.g.length?E.g[0]:E.h)>>>0).toString(k);if(E=_,I(E))return S+M;for(;6>S.length;)S="0"+S;M=S+M}},t.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function I(k){if(k.h!=0)return!1;for(var C=0;C<k.g.length;C++)if(k.g[C]!=0)return!1;return!0}function P(k){return k.h==-1}t.l=function(k){return k=x(this,k),P(k)?-1:I(k)?0:1};function w(k){for(var C=k.g.length,E=[],M=0;M<C;M++)E[M]=~k.g[M];return new s(E,~k.h).add(v)}t.abs=function(){return P(this)?w(this):this},t.add=function(k){for(var C=Math.max(this.g.length,k.g.length),E=[],M=0,_=0;_<=C;_++){var S=M+(this.i(_)&65535)+(k.i(_)&65535),b=(S>>>16)+(this.i(_)>>>16)+(k.i(_)>>>16);M=b>>>16,S&=65535,b&=65535,E[_]=b<<16|S}return new s(E,E[E.length-1]&-2147483648?-1:0)};function x(k,C){return k.add(w(C))}t.j=function(k){if(I(this)||I(k))return y;if(P(this))return P(k)?w(this).j(w(k)):w(w(this).j(k));if(P(k))return w(this.j(w(k)));if(0>this.l(p)&&0>k.l(p))return u(this.m()*k.m());for(var C=this.g.length+k.g.length,E=[],M=0;M<2*C;M++)E[M]=0;for(M=0;M<this.g.length;M++)for(var _=0;_<k.g.length;_++){var S=this.i(M)>>>16,b=this.i(M)&65535,Y=k.i(_)>>>16,te=k.i(_)&65535;E[2*M+2*_]+=b*te,j(E,2*M+2*_),E[2*M+2*_+1]+=S*te,j(E,2*M+2*_+1),E[2*M+2*_+1]+=b*Y,j(E,2*M+2*_+1),E[2*M+2*_+2]+=S*Y,j(E,2*M+2*_+2)}for(M=0;M<C;M++)E[M]=E[2*M+1]<<16|E[2*M];for(M=C;M<2*C;M++)E[M]=0;return new s(E,0)};function j(k,C){for(;(k[C]&65535)!=k[C];)k[C+1]+=k[C]>>>16,k[C]&=65535,C++}function ne(k,C){this.g=k,this.h=C}function Q(k,C){if(I(C))throw Error("division by zero");if(I(k))return new ne(y,y);if(P(k))return C=Q(w(k),C),new ne(w(C.g),w(C.h));if(P(C))return C=Q(k,w(C)),new ne(w(C.g),C.h);if(30<k.g.length){if(P(k)||P(C))throw Error("slowDivide_ only works with positive integers.");for(var E=v,M=C;0>=M.l(k);)E=K(E),M=K(M);var _=Z(E,1),S=Z(M,1);for(M=Z(M,2),E=Z(E,2);!I(M);){var b=S.add(M);0>=b.l(k)&&(_=_.add(E),S=b),M=Z(M,1),E=Z(E,1)}return C=x(k,_.j(C)),new ne(_,C)}for(_=y;0<=k.l(C);){for(E=Math.max(1,Math.floor(k.m()/C.m())),M=Math.ceil(Math.log(E)/Math.LN2),M=48>=M?1:Math.pow(2,M-48),S=u(E),b=S.j(C);P(b)||0<b.l(k);)E-=M,S=u(E),b=S.j(C);I(S)&&(S=v),_=_.add(S),k=x(k,b)}return new ne(_,k)}t.A=function(k){return Q(this,k).h},t.and=function(k){for(var C=Math.max(this.g.length,k.g.length),E=[],M=0;M<C;M++)E[M]=this.i(M)&k.i(M);return new s(E,this.h&k.h)},t.or=function(k){for(var C=Math.max(this.g.length,k.g.length),E=[],M=0;M<C;M++)E[M]=this.i(M)|k.i(M);return new s(E,this.h|k.h)},t.xor=function(k){for(var C=Math.max(this.g.length,k.g.length),E=[],M=0;M<C;M++)E[M]=this.i(M)^k.i(M);return new s(E,this.h^k.h)};function K(k){for(var C=k.g.length+1,E=[],M=0;M<C;M++)E[M]=k.i(M)<<1|k.i(M-1)>>>31;return new s(E,k.h)}function Z(k,C){var E=C>>5;C%=32;for(var M=k.g.length-E,_=[],S=0;S<M;S++)_[S]=0<C?k.i(S+E)>>>C|k.i(S+E+1)<<32-C:k.i(S+E);return new s(_,k.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Fb=n,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=u,s.fromString=f,Ia=s}).apply(typeof Xg<"u"?Xg:typeof self<"u"?self:typeof window<"u"?window:{});var Id=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ob,nu,Bb,eh,Wp,jb,Vb,zb;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,R,se){return h==Array.prototype||h==Object.prototype||(h[R]=se.value),h};function r(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Id=="object"&&Id];for(var R=0;R<h.length;++R){var se=h[R];if(se&&se.Math==Math)return se}throw Error("Cannot find global object")}var n=r(this);function i(h,R){if(R)e:{var se=n;h=h.split(".");for(var _e=0;_e<h.length-1;_e++){var Ve=h[_e];if(!(Ve in se))break e;se=se[Ve]}h=h[h.length-1],_e=se[h],R=R(_e),R!=_e&&R!=null&&e(se,h,{configurable:!0,writable:!0,value:R})}}function o(h,R){h instanceof String&&(h+="");var se=0,_e=!1,Ve={next:function(){if(!_e&&se<h.length){var Qe=se++;return{value:R(Qe,h[Qe]),done:!1}}return _e=!0,{done:!0,value:void 0}}};return Ve[Symbol.iterator]=function(){return Ve},Ve}i("Array.prototype.values",function(h){return h||function(){return o(this,function(R,se){return se})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},a=this||self;function c(h){var R=typeof h;return R=R!="object"?R:h?Array.isArray(h)?"array":R:"null",R=="array"||R=="object"&&typeof h.length=="number"}function u(h){var R=typeof h;return R=="object"&&h!=null||R=="function"}function f(h,R,se){return h.call.apply(h.bind,arguments)}function y(h,R,se){if(!h)throw Error();if(2<arguments.length){var _e=Array.prototype.slice.call(arguments,2);return function(){var Ve=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Ve,_e),h.apply(R,Ve)}}return function(){return h.apply(R,arguments)}}function v(h,R,se){return v=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:y,v.apply(null,arguments)}function p(h,R){var se=Array.prototype.slice.call(arguments,1);return function(){var _e=se.slice();return _e.push.apply(_e,arguments),h.apply(this,_e)}}function I(h,R){function se(){}se.prototype=R.prototype,h.aa=R.prototype,h.prototype=new se,h.prototype.constructor=h,h.Qb=function(_e,Ve,Qe){for(var $t=Array(arguments.length-2),vr=2;vr<arguments.length;vr++)$t[vr-2]=arguments[vr];return R.prototype[Ve].apply(_e,$t)}}function P(h){const R=h.length;if(0<R){const se=Array(R);for(let _e=0;_e<R;_e++)se[_e]=h[_e];return se}return[]}function w(h,R){for(let se=1;se<arguments.length;se++){const _e=arguments[se];if(c(_e)){const Ve=h.length||0,Qe=_e.length||0;h.length=Ve+Qe;for(let $t=0;$t<Qe;$t++)h[Ve+$t]=_e[$t]}else h.push(_e)}}class x{constructor(R,se){this.i=R,this.j=se,this.h=0,this.g=null}get(){let R;return 0<this.h?(this.h--,R=this.g,this.g=R.next,R.next=null):R=this.i(),R}}function j(h){return/^[\s\xa0]*$/.test(h)}function ne(){var h=a.navigator;return h&&(h=h.userAgent)?h:""}function Q(h){return Q[" "](h),h}Q[" "]=function(){};var K=ne().indexOf("Gecko")!=-1&&!(ne().toLowerCase().indexOf("webkit")!=-1&&ne().indexOf("Edge")==-1)&&!(ne().indexOf("Trident")!=-1||ne().indexOf("MSIE")!=-1)&&ne().indexOf("Edge")==-1;function Z(h,R,se){for(const _e in h)R.call(se,h[_e],_e,h)}function k(h,R){for(const se in h)R.call(void 0,h[se],se,h)}function C(h){const R={};for(const se in h)R[se]=h[se];return R}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(h,R){let se,_e;for(let Ve=1;Ve<arguments.length;Ve++){_e=arguments[Ve];for(se in _e)h[se]=_e[se];for(let Qe=0;Qe<E.length;Qe++)se=E[Qe],Object.prototype.hasOwnProperty.call(_e,se)&&(h[se]=_e[se])}}function _(h){var R=1;h=h.split(":");const se=[];for(;0<R&&h.length;)se.push(h.shift()),R--;return h.length&&se.push(h.join(":")),se}function S(h){a.setTimeout(()=>{throw h},0)}function b(){var h=H;let R=null;return h.g&&(R=h.g,h.g=h.g.next,h.g||(h.h=null),R.next=null),R}class Y{constructor(){this.h=this.g=null}add(R,se){const _e=te.get();_e.set(R,se),this.h?this.h.next=_e:this.g=_e,this.h=_e}}var te=new x(()=>new O,h=>h.reset());class O{constructor(){this.next=this.g=this.h=null}set(R,se){this.h=R,this.g=se,this.next=null}reset(){this.next=this.g=this.h=null}}let D,X=!1,H=new Y,F=()=>{const h=a.Promise.resolve(void 0);D=()=>{h.then(ie)}};var ie=()=>{for(var h;h=b();){try{h.h.call(h.g)}catch(se){S(se)}var R=te;R.j(h),100>R.h&&(R.h++,h.next=R.g,R.g=h)}X=!1};function $(){this.s=this.s,this.C=this.C}$.prototype.s=!1,$.prototype.ma=function(){this.s||(this.s=!0,this.N())},$.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(h,R){this.type=h,this.g=this.target=R,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var U=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var h=!1,R=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const se=()=>{};a.addEventListener("test",se,R),a.removeEventListener("test",se,R)}catch{}return h}();function N(h,R){if(L.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var se=this.type=h.type,_e=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=R,R=h.relatedTarget){if(K){e:{try{Q(R.nodeName);var Ve=!0;break e}catch{}Ve=!1}Ve||(R=null)}}else se=="mouseover"?R=h.fromElement:se=="mouseout"&&(R=h.toElement);this.relatedTarget=R,_e?(this.clientX=_e.clientX!==void 0?_e.clientX:_e.pageX,this.clientY=_e.clientY!==void 0?_e.clientY:_e.pageY,this.screenX=_e.screenX||0,this.screenY=_e.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:z[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&N.aa.h.call(this)}}I(N,L);var z={2:"touch",3:"pen",4:"mouse"};N.prototype.h=function(){N.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var oe="closure_listenable_"+(1e6*Math.random()|0),G=0;function ee(h,R,se,_e,Ve){this.listener=h,this.proxy=null,this.src=R,this.type=se,this.capture=!!_e,this.ha=Ve,this.key=++G,this.da=this.fa=!1}function J(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function W(h){this.src=h,this.g={},this.h=0}W.prototype.add=function(h,R,se,_e,Ve){var Qe=h.toString();h=this.g[Qe],h||(h=this.g[Qe]=[],this.h++);var $t=ae(h,R,_e,Ve);return-1<$t?(R=h[$t],se||(R.fa=!1)):(R=new ee(R,this.src,Qe,!!_e,Ve),R.fa=se,h.push(R)),R};function q(h,R){var se=R.type;if(se in h.g){var _e=h.g[se],Ve=Array.prototype.indexOf.call(_e,R,void 0),Qe;(Qe=0<=Ve)&&Array.prototype.splice.call(_e,Ve,1),Qe&&(J(R),h.g[se].length==0&&(delete h.g[se],h.h--))}}function ae(h,R,se,_e){for(var Ve=0;Ve<h.length;++Ve){var Qe=h[Ve];if(!Qe.da&&Qe.listener==R&&Qe.capture==!!se&&Qe.ha==_e)return Ve}return-1}var de="closure_lm_"+(1e6*Math.random()|0),le={};function V(h,R,se,_e,Ve){if(Array.isArray(R)){for(var Qe=0;Qe<R.length;Qe++)V(h,R[Qe],se,_e,Ve);return null}return se=Ee(se),h&&h[oe]?h.K(R,se,u(_e)?!!_e.capture:!1,Ve):ce(h,R,se,!1,_e,Ve)}function ce(h,R,se,_e,Ve,Qe){if(!R)throw Error("Invalid event type");var $t=u(Ve)?!!Ve.capture:!!Ve,vr=ve(h);if(vr||(h[de]=vr=new W(h)),se=vr.add(R,se,_e,$t,Qe),se.proxy)return se;if(_e=Pe(),se.proxy=_e,_e.src=h,_e.listener=se,h.addEventListener)U||(Ve=$t),Ve===void 0&&(Ve=!1),h.addEventListener(R.toString(),_e,Ve);else if(h.attachEvent)h.attachEvent(xe(R.toString()),_e);else if(h.addListener&&h.removeListener)h.addListener(_e);else throw Error("addEventListener and attachEvent are unavailable.");return se}function Pe(){function h(se){return R.call(h.src,h.listener,se)}const R=he;return h}function fe(h,R,se,_e,Ve){if(Array.isArray(R))for(var Qe=0;Qe<R.length;Qe++)fe(h,R[Qe],se,_e,Ve);else _e=u(_e)?!!_e.capture:!!_e,se=Ee(se),h&&h[oe]?(h=h.i,R=String(R).toString(),R in h.g&&(Qe=h.g[R],se=ae(Qe,se,_e,Ve),-1<se&&(J(Qe[se]),Array.prototype.splice.call(Qe,se,1),Qe.length==0&&(delete h.g[R],h.h--)))):h&&(h=ve(h))&&(R=h.g[R.toString()],h=-1,R&&(h=ae(R,se,_e,Ve)),(se=-1<h?R[h]:null)&&be(se))}function be(h){if(typeof h!="number"&&h&&!h.da){var R=h.src;if(R&&R[oe])q(R.i,h);else{var se=h.type,_e=h.proxy;R.removeEventListener?R.removeEventListener(se,_e,h.capture):R.detachEvent?R.detachEvent(xe(se),_e):R.addListener&&R.removeListener&&R.removeListener(_e),(se=ve(R))?(q(se,h),se.h==0&&(se.src=null,R[de]=null)):J(h)}}}function xe(h){return h in le?le[h]:le[h]="on"+h}function he(h,R){if(h.da)h=!0;else{R=new N(R,this);var se=h.listener,_e=h.ha||h.src;h.fa&&be(h),h=se.call(_e,R)}return h}function ve(h){return h=h[de],h instanceof W?h:null}var De="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ee(h){return typeof h=="function"?h:(h[De]||(h[De]=function(R){return h.handleEvent(R)}),h[De])}function Ce(){$.call(this),this.i=new W(this),this.M=this,this.F=null}I(Ce,$),Ce.prototype[oe]=!0,Ce.prototype.removeEventListener=function(h,R,se,_e){fe(this,h,R,se,_e)};function Ne(h,R){var se,_e=h.F;if(_e)for(se=[];_e;_e=_e.F)se.push(_e);if(h=h.M,_e=R.type||R,typeof R=="string")R=new L(R,h);else if(R instanceof L)R.target=R.target||h;else{var Ve=R;R=new L(_e,h),M(R,Ve)}if(Ve=!0,se)for(var Qe=se.length-1;0<=Qe;Qe--){var $t=R.g=se[Qe];Ve=Ie($t,_e,!0,R)&&Ve}if($t=R.g=h,Ve=Ie($t,_e,!0,R)&&Ve,Ve=Ie($t,_e,!1,R)&&Ve,se)for(Qe=0;Qe<se.length;Qe++)$t=R.g=se[Qe],Ve=Ie($t,_e,!1,R)&&Ve}Ce.prototype.N=function(){if(Ce.aa.N.call(this),this.i){var h=this.i,R;for(R in h.g){for(var se=h.g[R],_e=0;_e<se.length;_e++)J(se[_e]);delete h.g[R],h.h--}}this.F=null},Ce.prototype.K=function(h,R,se,_e){return this.i.add(String(h),R,!1,se,_e)},Ce.prototype.L=function(h,R,se,_e){return this.i.add(String(h),R,!0,se,_e)};function Ie(h,R,se,_e){if(R=h.i.g[String(R)],!R)return!0;R=R.concat();for(var Ve=!0,Qe=0;Qe<R.length;++Qe){var $t=R[Qe];if($t&&!$t.da&&$t.capture==se){var vr=$t.listener,Nr=$t.ha||$t.src;$t.fa&&q(h.i,$t),Ve=vr.call(Nr,_e)!==!1&&Ve}}return Ve&&!_e.defaultPrevented}function Re(h,R,se){if(typeof h=="function")se&&(h=v(h,se));else if(h&&typeof h.handleEvent=="function")h=v(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(R)?-1:a.setTimeout(h,R||0)}function We(h){h.g=Re(()=>{h.g=null,h.i&&(h.i=!1,We(h))},h.l);const R=h.h;h.h=null,h.m.apply(null,R)}class Fe extends ${constructor(R,se){super(),this.m=R,this.l=se,this.h=null,this.i=!1,this.g=null}j(R){this.h=arguments,this.g?this.i=!0:We(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Xe(h){$.call(this),this.h=h,this.g={}}I(Xe,$);var tt=[];function At(h){Z(h.g,function(R,se){this.g.hasOwnProperty(se)&&be(R)},h),h.g={}}Xe.prototype.N=function(){Xe.aa.N.call(this),At(this)},Xe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var rt=a.JSON.stringify,He=a.JSON.parse,xt=class{stringify(h){return a.JSON.stringify(h,void 0)}parse(h){return a.JSON.parse(h,void 0)}};function _t(){}_t.prototype.h=null;function mt(h){return h.h||(h.h=h.i())}function Et(){}var et={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function qe(){L.call(this,"d")}I(qe,L);function ot(){L.call(this,"c")}I(ot,L);var Je={},at=null;function dt(){return at=at||new Ce}Je.La="serverreachability";function It(h){L.call(this,Je.La,h)}I(It,L);function jt(h){const R=dt();Ne(R,new It(R))}Je.STAT_EVENT="statevent";function Gt(h,R){L.call(this,Je.STAT_EVENT,h),this.stat=R}I(Gt,L);function yt(h){const R=dt();Ne(R,new Gt(R,h))}Je.Ma="timingevent";function Qt(h,R){L.call(this,Je.Ma,h),this.size=R}I(Qt,L);function Mt(h,R){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){h()},R)}function Kt(){this.g=!0}Kt.prototype.xa=function(){this.g=!1};function Xt(h,R,se,_e,Ve,Qe){h.info(function(){if(h.g)if(Qe)for(var $t="",vr=Qe.split("&"),Nr=0;Nr<vr.length;Nr++){var br=vr[Nr].split("=");if(1<br.length){var Xr=br[0];br=br[1];var an=Xr.split("_");$t=2<=an.length&&an[1]=="type"?$t+(Xr+"="+br+"&"):$t+(Xr+"=redacted&")}}else $t=null;else $t=Qe;return"XMLHTTP REQ ("+_e+") [attempt "+Ve+"]: "+R+`
`+se+`
`+$t})}function ht(h,R,se,_e,Ve,Qe,$t){h.info(function(){return"XMLHTTP RESP ("+_e+") [ attempt "+Ve+"]: "+R+`
`+se+`
`+Qe+" "+$t})}function wt(h,R,se,_e){h.info(function(){return"XMLHTTP TEXT ("+R+"): "+Ze(h,se)+(_e?" "+_e:"")})}function Ut(h,R){h.info(function(){return"TIMEOUT: "+R})}Kt.prototype.info=function(){};function Ze(h,R){if(!h.g)return R;if(!R)return null;try{var se=JSON.parse(R);if(se){for(h=0;h<se.length;h++)if(Array.isArray(se[h])){var _e=se[h];if(!(2>_e.length)){var Ve=_e[1];if(Array.isArray(Ve)&&!(1>Ve.length)){var Qe=Ve[0];if(Qe!="noop"&&Qe!="stop"&&Qe!="close")for(var $t=1;$t<Ve.length;$t++)Ve[$t]=""}}}}return rt(se)}catch{return R}}var Vt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ft={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Jt;function er(){}I(er,_t),er.prototype.g=function(){return new XMLHttpRequest},er.prototype.i=function(){return{}},Jt=new er;function gt(h,R,se,_e){this.j=h,this.i=R,this.l=se,this.R=_e||1,this.U=new Xe(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new dr}function dr(){this.i=null,this.g="",this.h=!1}var Er={},mr={};function xr(h,R,se){h.L=1,h.v=Gn(pr(R)),h.m=se,h.P=!0,Vr(h,null)}function Vr(h,R){h.F=Date.now(),$r(h),h.A=pr(h.v);var se=h.A,_e=h.R;Array.isArray(_e)||(_e=[String(_e)]),ir(se.i,"t",_e),h.C=0,se=h.j.J,h.h=new dr,h.g=pe(h.j,se?R:null,!h.m),0<h.O&&(h.M=new Fe(v(h.Y,h,h.g),h.O)),R=h.U,se=h.g,_e=h.ca;var Ve="readystatechange";Array.isArray(Ve)||(Ve&&(tt[0]=Ve.toString()),Ve=tt);for(var Qe=0;Qe<Ve.length;Qe++){var $t=V(se,Ve[Qe],_e||R.handleEvent,!1,R.h||R);if(!$t)break;R.g[$t.key]=$t}R=h.H?C(h.H):{},h.m?(h.u||(h.u="POST"),R["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,R)):(h.u="GET",h.g.ea(h.A,h.u,null,R)),jt(),Xt(h.i,h.u,h.A,h.l,h.R,h.m)}gt.prototype.ca=function(h){h=h.target;const R=this.M;R&&zn(h)==3?R.j():this.Y(h)},gt.prototype.Y=function(h){try{if(h==this.g)e:{const an=zn(this.g);var R=this.g.Ba();const xo=this.g.Z();if(!(3>an)&&(an!=3||this.g&&(this.h.h||this.g.oa()||Ll(this.g)))){this.J||an!=4||R==7||(R==8||0>=xo?jt(3):jt(2)),yr(this);var se=this.g.Z();this.X=se;t:if(kt(this)){var _e=Ll(this.g);h="";var Ve=_e.length,Qe=zn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Hr(this),Ir(this);var $t="";break t}this.h.i=new a.TextDecoder}for(R=0;R<Ve;R++)this.h.h=!0,h+=this.h.i.decode(_e[R],{stream:!(Qe&&R==Ve-1)});_e.length=0,this.h.g+=h,this.C=0,$t=this.h.g}else $t=this.g.oa();if(this.o=se==200,ht(this.i,this.u,this.A,this.l,this.R,an,se),this.o){if(this.T&&!this.K){t:{if(this.g){var vr,Nr=this.g;if((vr=Nr.g?Nr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(vr)){var br=vr;break t}}br=null}if(se=br)wt(this.i,this.l,se,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,rr(this,se);else{this.o=!1,this.s=3,yt(12),Hr(this),Ir(this);break e}}if(this.P){se=!0;let ni;for(;!this.J&&this.C<$t.length;)if(ni=Cr(this,$t),ni==mr){an==4&&(this.s=4,yt(14),se=!1),wt(this.i,this.l,null,"[Incomplete Response]");break}else if(ni==Er){this.s=4,yt(15),wt(this.i,this.l,$t,"[Invalid Chunk]"),se=!1;break}else wt(this.i,this.l,ni,null),rr(this,ni);if(kt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),an!=4||$t.length!=0||this.h.h||(this.s=1,yt(16),se=!1),this.o=this.o&&se,!se)wt(this.i,this.l,$t,"[Invalid Chunked Response]"),Hr(this),Ir(this);else if(0<$t.length&&!this.W){this.W=!0;var Xr=this.j;Xr.g==this&&Xr.ba&&!Xr.M&&(Xr.j.info("Great, no buffering proxy detected. Bytes received: "+$t.length),Ks(Xr),Xr.M=!0,yt(11))}}else wt(this.i,this.l,$t,null),rr(this,$t);an==4&&Hr(this),this.o&&!this.J&&(an==4?zo(this.j,this):(this.o=!1,$r(this)))}else jo(this.g),se==400&&0<$t.indexOf("Unknown SID")?(this.s=3,yt(12)):(this.s=0,yt(13)),Hr(this),Ir(this)}}}catch{}finally{}};function kt(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function Cr(h,R){var se=h.C,_e=R.indexOf(`
`,se);return _e==-1?mr:(se=Number(R.substring(se,_e)),isNaN(se)?Er:(_e+=1,_e+se>R.length?mr:(R=R.slice(_e,_e+se),h.C=_e+se,R)))}gt.prototype.cancel=function(){this.J=!0,Hr(this)};function $r(h){h.S=Date.now()+h.I,hr(h,h.I)}function hr(h,R){if(h.B!=null)throw Error("WatchDog timer not null");h.B=Mt(v(h.ba,h),R)}function yr(h){h.B&&(a.clearTimeout(h.B),h.B=null)}gt.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(Ut(this.i,this.A),this.L!=2&&(jt(),yt(17)),Hr(this),this.s=2,Ir(this)):hr(this,this.S-h)};function Ir(h){h.j.G==0||h.J||zo(h.j,h)}function Hr(h){yr(h);var R=h.M;R&&typeof R.ma=="function"&&R.ma(),h.M=null,At(h.U),h.g&&(R=h.g,h.g=null,R.abort(),R.ma())}function rr(h,R){try{var se=h.j;if(se.G!=0&&(se.g==h||gn(se.h,h))){if(!h.K&&gn(se.h,h)&&se.G==3){try{var _e=se.Da.g.parse(R)}catch{_e=null}if(Array.isArray(_e)&&_e.length==3){var Ve=_e;if(Ve[0]==0){e:if(!se.u){if(se.g)if(se.g.F+3e3<h.F)Po(se),Hs(se);else break e;fs(se),yt(18)}}else se.za=Ve[1],0<se.za-se.T&&37500>Ve[2]&&se.F&&se.v==0&&!se.C&&(se.C=Mt(v(se.Za,se),6e3));if(1>=bn(se.h)&&se.ca){try{se.ca()}catch{}se.ca=void 0}}else fi(se,11)}else if((h.K||se.g==h)&&Po(se),!j(R))for(Ve=se.Da.g.parse(R),R=0;R<Ve.length;R++){let br=Ve[R];if(se.T=br[0],br=br[1],se.G==2)if(br[0]=="c"){se.K=br[1],se.ia=br[2];const Xr=br[3];Xr!=null&&(se.la=Xr,se.j.info("VER="+se.la));const an=br[4];an!=null&&(se.Aa=an,se.j.info("SVER="+se.Aa));const xo=br[5];xo!=null&&typeof xo=="number"&&0<xo&&(_e=1.5*xo,se.L=_e,se.j.info("backChannelRequestTimeoutMs_="+_e)),_e=se;const ni=h.g;if(ni){const qo=ni.g?ni.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(qo){var Qe=_e.h;Qe.g||qo.indexOf("spdy")==-1&&qo.indexOf("quic")==-1&&qo.indexOf("h2")==-1||(Qe.j=Qe.l,Qe.g=new Set,Qe.h&&(Br(Qe,Qe.h),Qe.h=null))}if(_e.D){const Uo=ni.g?ni.g.getResponseHeader("X-HTTP-Session-Id"):null;Uo&&(_e.ya=Uo,Sr(_e.I,_e.D,Uo))}}se.G=3,se.l&&se.l.ua(),se.ba&&(se.R=Date.now()-h.F,se.j.info("Handshake RTT: "+se.R+"ms")),_e=se;var $t=h;if(_e.qa=A(_e,_e.J?_e.ia:null,_e.W),$t.K){Vn(_e.h,$t);var vr=$t,Nr=_e.L;Nr&&(vr.I=Nr),vr.B&&(yr(vr),$r(vr)),_e.g=$t}else Ys(_e);0<se.i.length&&Ws(se)}else br[0]!="stop"&&br[0]!="close"||fi(se,7);else se.G==3&&(br[0]=="stop"||br[0]=="close"?br[0]=="stop"?fi(se,7):So(se):br[0]!="noop"&&se.l&&se.l.ta(br),se.v=0)}}jt(4)}catch{}}var on=class{constructor(h,R){this.g=h,this.map=R}};function vn(h){this.l=h||10,a.PerformanceNavigationTiming?(h=a.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ln(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function bn(h){return h.h?1:h.g?h.g.size:0}function gn(h,R){return h.h?h.h==R:h.g?h.g.has(R):!1}function Br(h,R){h.g?h.g.add(R):h.h=R}function Vn(h,R){h.h&&h.h==R?h.h=null:h.g&&h.g.has(R)&&h.g.delete(R)}vn.prototype.cancel=function(){if(this.i=Xn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Xn(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let R=h.i;for(const se of h.g.values())R=R.concat(se.D);return R}return P(h.i)}function Ni(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(c(h)){for(var R=[],se=h.length,_e=0;_e<se;_e++)R.push(h[_e]);return R}R=[],se=0;for(_e in h)R[se++]=h[_e];return R}function nr(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(c(h)||typeof h=="string"){var R=[];h=h.length;for(var se=0;se<h;se++)R.push(se);return R}R=[],se=0;for(const _e in h)R[se++]=_e;return R}}}function Tr(h,R){if(h.forEach&&typeof h.forEach=="function")h.forEach(R,void 0);else if(c(h)||typeof h=="string")Array.prototype.forEach.call(h,R,void 0);else for(var se=nr(h),_e=Ni(h),Ve=_e.length,Qe=0;Qe<Ve;Qe++)R.call(void 0,_e[Qe],se&&se[Qe],h)}var Gr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function bt(h,R){if(h){h=h.split("&");for(var se=0;se<h.length;se++){var _e=h[se].indexOf("="),Ve=null;if(0<=_e){var Qe=h[se].substring(0,_e);Ve=h[se].substring(_e+1)}else Qe=h[se];R(Qe,Ve?decodeURIComponent(Ve.replace(/\+/g," ")):"")}}}function ar(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof ar){this.h=h.h,Wr(this,h.j),this.o=h.o,this.g=h.g,Fr(this,h.s),this.l=h.l;var R=h.i,se=new no;se.i=R.i,R.g&&(se.g=new Map(R.g),se.h=R.h),dn(this,se),this.m=h.m}else h&&(R=String(h).match(Gr))?(this.h=!1,Wr(this,R[1]||"",!0),this.o=wn(R[2]||""),this.g=wn(R[3]||"",!0),Fr(this,R[4]),this.l=wn(R[5]||"",!0),dn(this,R[6]||"",!0),this.m=wn(R[7]||"")):(this.h=!1,this.i=new no(null,this.h))}ar.prototype.toString=function(){var h=[],R=this.j;R&&h.push(Zn(R,hi,!0),":");var se=this.g;return(se||R=="file")&&(h.push("//"),(R=this.o)&&h.push(Zn(R,hi,!0),"@"),h.push(encodeURIComponent(String(se)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),se=this.s,se!=null&&h.push(":",String(se))),(se=this.l)&&(this.g&&se.charAt(0)!="/"&&h.push("/"),h.push(Zn(se,se.charAt(0)=="/"?xn:ei,!0))),(se=this.i.toString())&&h.push("?",se),(se=this.m)&&h.push("#",Zn(se,Li)),h.join("")};function pr(h){return new ar(h)}function Wr(h,R,se){h.j=se?wn(R,!0):R,h.j&&(h.j=h.j.replace(/:$/,""))}function Fr(h,R){if(R){if(R=Number(R),isNaN(R)||0>R)throw Error("Bad port number "+R);h.s=R}else h.s=null}function dn(h,R,se){R instanceof no?(h.i=R,za(h.i,h.h)):(se||(R=Zn(R,ti)),h.i=new no(R,h.h))}function Sr(h,R,se){h.i.set(R,se)}function Gn(h){return Sr(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function wn(h,R){return h?R?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Zn(h,R,se){return typeof h=="string"?(h=encodeURI(h).replace(R,Wi),se&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Wi(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var hi=/[#\/\?@]/g,ei=/[#\?:]/g,xn=/[#\?]/g,ti=/[#\?@]/g,Li=/#/g;function no(h,R){this.h=this.g=null,this.i=h||null,this.j=!!R}function sn(h){h.g||(h.g=new Map,h.h=0,h.i&&bt(h.i,function(R,se){h.add(decodeURIComponent(R.replace(/\+/g," ")),se)}))}t=no.prototype,t.add=function(h,R){sn(this),this.i=null,h=io(this,h);var se=this.g.get(h);return se||this.g.set(h,se=[]),se.push(R),this.h+=1,this};function js(h,R){sn(h),R=io(h,R),h.g.has(R)&&(h.i=null,h.h-=h.g.get(R).length,h.g.delete(R))}function bo(h,R){return sn(h),R=io(h,R),h.g.has(R)}t.forEach=function(h,R){sn(this),this.g.forEach(function(se,_e){se.forEach(function(Ve){h.call(R,Ve,_e,this)},this)},this)},t.na=function(){sn(this);const h=Array.from(this.g.values()),R=Array.from(this.g.keys()),se=[];for(let _e=0;_e<R.length;_e++){const Ve=h[_e];for(let Qe=0;Qe<Ve.length;Qe++)se.push(R[_e])}return se},t.V=function(h){sn(this);let R=[];if(typeof h=="string")bo(this,h)&&(R=R.concat(this.g.get(io(this,h))));else{h=Array.from(this.g.values());for(let se=0;se<h.length;se++)R=R.concat(h[se])}return R},t.set=function(h,R){return sn(this),this.i=null,h=io(this,h),bo(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[R]),this.h+=1,this},t.get=function(h,R){return h?(h=this.V(h),0<h.length?String(h[0]):R):R};function ir(h,R,se){js(h,R),0<se.length&&(h.i=null,h.g.set(io(h,R),P(se)),h.h+=se.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],R=Array.from(this.g.keys());for(var se=0;se<R.length;se++){var _e=R[se];const Qe=encodeURIComponent(String(_e)),$t=this.V(_e);for(_e=0;_e<$t.length;_e++){var Ve=Qe;$t[_e]!==""&&(Ve+="="+encodeURIComponent(String($t[_e]))),h.push(Ve)}}return this.i=h.join("&")};function io(h,R){return R=String(R),h.j&&(R=R.toLowerCase()),R}function za(h,R){R&&!h.j&&(sn(h),h.i=null,h.g.forEach(function(se,_e){var Ve=_e.toLowerCase();_e!=Ve&&(js(this,_e),ir(this,Ve,se))},h)),h.j=R}function Di(h,R){const se=new Kt;if(a.Image){const _e=new Image;_e.onload=p(Ii,se,"TestLoadImage: loaded",!0,R,_e),_e.onerror=p(Ii,se,"TestLoadImage: error",!1,R,_e),_e.onabort=p(Ii,se,"TestLoadImage: abort",!1,R,_e),_e.ontimeout=p(Ii,se,"TestLoadImage: timeout",!1,R,_e),a.setTimeout(function(){_e.ontimeout&&_e.ontimeout()},1e4),_e.src=h}else R(!1)}function Vs(h,R){const se=new Kt,_e=new AbortController,Ve=setTimeout(()=>{_e.abort(),Ii(se,"TestPingServer: timeout",!1,R)},1e4);fetch(h,{signal:_e.signal}).then(Qe=>{clearTimeout(Ve),Qe.ok?Ii(se,"TestPingServer: ok",!0,R):Ii(se,"TestPingServer: server error",!1,R)}).catch(()=>{clearTimeout(Ve),Ii(se,"TestPingServer: error",!1,R)})}function Ii(h,R,se,_e,Ve){try{Ve&&(Ve.onload=null,Ve.onerror=null,Ve.onabort=null,Ve.ontimeout=null),_e(se)}catch{}}function Oo(){this.g=new xt}function cs(h,R,se){const _e=se||"";try{Tr(h,function(Ve,Qe){let $t=Ve;u(Ve)&&($t=rt(Ve)),R.push(_e+Qe+"="+encodeURIComponent($t))})}catch(Ve){throw R.push(_e+"type="+encodeURIComponent("_badmap")),Ve}}function Bo(h){this.l=h.Ub||null,this.j=h.eb||!1}I(Bo,_t),Bo.prototype.g=function(){return new zs(this.l,this.j)},Bo.prototype.i=function(h){return function(){return h}}({});function zs(h,R){Ce.call(this),this.D=h,this.o=R,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}I(zs,Ce),t=zs.prototype,t.open=function(h,R){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=R,this.readyState=1,Gi(this)},t.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const R={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(R.body=h),(this.D||a).fetch(new Request(this.A,R)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,_o(this)),this.readyState=0},t.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Gi(this)),this.g&&(this.readyState=3,Gi(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Nl(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Nl(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}t.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var R=h.value?h.value:new Uint8Array(0);(R=this.v.decode(R,{stream:!h.done}))&&(this.response=this.responseText+=R)}h.done?_o(this):Gi(this),this.readyState==3&&Nl(this)}},t.Ra=function(h){this.g&&(this.response=this.responseText=h,_o(this))},t.Qa=function(h){this.g&&(this.response=h,_o(this))},t.ga=function(){this.g&&_o(this)};function _o(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Gi(h)}t.setRequestHeader=function(h,R){this.u.append(h,R)},t.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],R=this.h.entries();for(var se=R.next();!se.done;)se=se.value,h.push(se[0]+": "+se[1]),se=R.next();return h.join(`\r
`)};function Gi(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(zs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function wo(h){let R="";return Z(h,function(se,_e){R+=_e,R+=":",R+=se,R+=`\r
`}),R}function qa(h,R,se){e:{for(_e in se){var _e=!1;break e}_e=!0}_e||(se=wo(se),typeof h=="string"?se!=null&&encodeURIComponent(String(se)):Sr(h,R,se))}function Qr(h){Ce.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}I(Qr,Ce);var Ua=/^https?$/i,qs=["POST","PUT"];t=Qr.prototype,t.Ha=function(h){this.J=h},t.ea=function(h,R,se,_e){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);R=R?R.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Jt.g(),this.v=this.o?mt(this.o):mt(Jt),this.g.onreadystatechange=v(this.Ea,this);try{this.B=!0,this.g.open(R,String(h),!0),this.B=!1}catch(Qe){Ha(this,Qe);return}if(h=se||"",se=new Map(this.headers),_e)if(Object.getPrototypeOf(_e)===Object.prototype)for(var Ve in _e)se.set(Ve,_e[Ve]);else if(typeof _e.keys=="function"&&typeof _e.get=="function")for(const Qe of _e.keys())se.set(Qe,_e.get(Qe));else throw Error("Unknown input type for opt_headers: "+String(_e));_e=Array.from(se.keys()).find(Qe=>Qe.toLowerCase()=="content-type"),Ve=a.FormData&&h instanceof a.FormData,!(0<=Array.prototype.indexOf.call(qs,R,void 0))||_e||Ve||se.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Qe,$t]of se)this.g.setRequestHeader(Qe,$t);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Yi(this),this.u=!0,this.g.send(h),this.u=!1}catch(Qe){Ha(this,Qe)}};function Ha(h,R){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=R,h.m=5,Wa(h),us(h)}function Wa(h){h.A||(h.A=!0,Ne(h,"complete"),Ne(h,"error"))}t.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,Ne(this,"complete"),Ne(this,"abort"),us(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),us(this,!0)),Qr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Ga(this):this.bb())},t.bb=function(){Ga(this)};function Ga(h){if(h.h&&typeof s<"u"&&(!h.v[1]||zn(h)!=4||h.Z()!=2)){if(h.u&&zn(h)==4)Re(h.Ea,0,h);else if(Ne(h,"readystatechange"),zn(h)==4){h.h=!1;try{const $t=h.Z();e:switch($t){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var R=!0;break e;default:R=!1}var se;if(!(se=R)){var _e;if(_e=$t===0){var Ve=String(h.D).match(Gr)[1]||null;!Ve&&a.self&&a.self.location&&(Ve=a.self.location.protocol.slice(0,-1)),_e=!Ua.test(Ve?Ve.toLowerCase():"")}se=_e}if(se)Ne(h,"complete"),Ne(h,"success");else{h.m=6;try{var Qe=2<zn(h)?h.g.statusText:""}catch{Qe=""}h.l=Qe+" ["+h.Z()+"]",Wa(h)}}finally{us(h)}}}}function us(h,R){if(h.g){Yi(h);const se=h.g,_e=h.v[0]?()=>{}:null;h.g=null,h.v=null,R||Ne(h,"ready");try{se.onreadystatechange=_e}catch{}}}function Yi(h){h.I&&(a.clearTimeout(h.I),h.I=null)}t.isActive=function(){return!!this.g};function zn(h){return h.g?h.g.readyState:0}t.Z=function(){try{return 2<zn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(h){if(this.g){var R=this.g.responseText;return h&&R.indexOf(h)==0&&(R=R.substring(h.length)),He(R)}};function Ll(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function jo(h){const R={};h=(h.g&&2<=zn(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let _e=0;_e<h.length;_e++){if(j(h[_e]))continue;var se=_(h[_e]);const Ve=se[0];if(se=se[1],typeof se!="string")continue;se=se.trim();const Qe=R[Ve]||[];R[Ve]=Qe,Qe.push(se)}k(R,function(_e){return _e.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ri(h,R,se){return se&&se.internalChannelParams&&se.internalChannelParams[h]||R}function Us(h){this.Aa=0,this.i=[],this.j=new Kt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ri("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ri("baseRetryDelayMs",5e3,h),this.cb=ri("retryDelaySeedMs",1e4,h),this.Wa=ri("forwardChannelMaxRetries",2,h),this.wa=ri("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new vn(h&&h.concurrentRequestLimit),this.Da=new Oo,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Us.prototype,t.la=8,t.G=1,t.connect=function(h,R,se,_e){yt(0),this.W=h,this.H=R||{},se&&_e!==void 0&&(this.H.OSID=se,this.H.OAID=_e),this.F=this.X,this.I=A(this,null,this.W),Ws(this)};function So(h){if(ds(h),h.G==3){var R=h.U++,se=pr(h.I);if(Sr(se,"SID",h.K),Sr(se,"RID",R),Sr(se,"TYPE","terminate"),Vo(h,se),R=new gt(h,h.j,R),R.L=2,R.v=Gn(pr(se)),se=!1,a.navigator&&a.navigator.sendBeacon)try{se=a.navigator.sendBeacon(R.v.toString(),"")}catch{}!se&&a.Image&&(new Image().src=R.v,se=!0),se||(R.g=pe(R.j,null),R.g.ea(R.v)),R.F=Date.now(),$r(R)}Qs(h)}function Hs(h){h.g&&(Ks(h),h.g.cancel(),h.g=null)}function ds(h){Hs(h),h.u&&(a.clearTimeout(h.u),h.u=null),Po(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&a.clearTimeout(h.s),h.s=null)}function Ws(h){if(!Ln(h.h)&&!h.s){h.s=!0;var R=h.Ga;D||F(),X||(D(),X=!0),H.add(R,h),h.B=0}}function Ya(h,R){return bn(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=R.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=Mt(v(h.Ga,h,R),Js(h,h.B)),h.B++,!0)}t.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const Ve=new gt(this,this.j,h);let Qe=this.o;if(this.S&&(Qe?(Qe=C(Qe),M(Qe,this.S)):Qe=this.S),this.m!==null||this.O||(Ve.H=Qe,Qe=null),this.P)e:{for(var R=0,se=0;se<this.i.length;se++){t:{var _e=this.i[se];if("__data__"in _e.map&&(_e=_e.map.__data__,typeof _e=="string")){_e=_e.length;break t}_e=void 0}if(_e===void 0)break;if(R+=_e,4096<R){R=se;break e}if(R===4096||se===this.i.length-1){R=se+1;break e}}R=1e3}else R=1e3;R=hs(this,Ve,R),se=pr(this.I),Sr(se,"RID",h),Sr(se,"CVER",22),this.D&&Sr(se,"X-HTTP-Session-Id",this.D),Vo(this,se),Qe&&(this.O?R="headers="+encodeURIComponent(String(wo(Qe)))+"&"+R:this.m&&qa(se,this.m,Qe)),Br(this.h,Ve),this.Ua&&Sr(se,"TYPE","init"),this.P?(Sr(se,"$req",R),Sr(se,"SID","null"),Ve.T=!0,xr(Ve,se,null)):xr(Ve,se,R),this.G=2}}else this.G==3&&(h?Gs(this,h):this.i.length==0||Ln(this.h)||Gs(this))};function Gs(h,R){var se;R?se=R.l:se=h.U++;const _e=pr(h.I);Sr(_e,"SID",h.K),Sr(_e,"RID",se),Sr(_e,"AID",h.T),Vo(h,_e),h.m&&h.o&&qa(_e,h.m,h.o),se=new gt(h,h.j,se,h.B+1),h.m===null&&(se.H=h.o),R&&(h.i=R.D.concat(h.i)),R=hs(h,se,1e3),se.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Br(h.h,se),xr(se,_e,R)}function Vo(h,R){h.H&&Z(h.H,function(se,_e){Sr(R,_e,se)}),h.l&&Tr({},function(se,_e){Sr(R,_e,se)})}function hs(h,R,se){se=Math.min(h.i.length,se);var _e=h.l?v(h.l.Na,h.l,h):null;e:{var Ve=h.i;let Qe=-1;for(;;){const $t=["count="+se];Qe==-1?0<se?(Qe=Ve[0].g,$t.push("ofs="+Qe)):Qe=0:$t.push("ofs="+Qe);let vr=!0;for(let Nr=0;Nr<se;Nr++){let br=Ve[Nr].g;const Xr=Ve[Nr].map;if(br-=Qe,0>br)Qe=Math.max(0,Ve[Nr].g-100),vr=!1;else try{cs(Xr,$t,"req"+br+"_")}catch{_e&&_e(Xr)}}if(vr){_e=$t.join("&");break e}}}return h=h.i.splice(0,se),R.D=h,_e}function Ys(h){if(!h.g&&!h.u){h.Y=1;var R=h.Fa;D||F(),X||(D(),X=!0),H.add(R,h),h.v=0}}function fs(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=Mt(v(h.Fa,h),Js(h,h.v)),h.v++,!0)}t.Fa=function(){if(this.u=null,Dl(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=Mt(v(this.ab,this),h)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,yt(10),Hs(this),Dl(this))};function Ks(h){h.A!=null&&(a.clearTimeout(h.A),h.A=null)}function Dl(h){h.g=new gt(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var R=pr(h.qa);Sr(R,"RID","rpc"),Sr(R,"SID",h.K),Sr(R,"AID",h.T),Sr(R,"CI",h.F?"0":"1"),!h.F&&h.ja&&Sr(R,"TO",h.ja),Sr(R,"TYPE","xmlhttp"),Vo(h,R),h.m&&h.o&&qa(R,h.m,h.o),h.L&&(h.g.I=h.L);var se=h.g;h=h.ia,se.L=1,se.v=Gn(pr(R)),se.m=null,se.P=!0,Vr(se,h)}t.Za=function(){this.C!=null&&(this.C=null,Hs(this),fs(this),yt(19))};function Po(h){h.C!=null&&(a.clearTimeout(h.C),h.C=null)}function zo(h,R){var se=null;if(h.g==R){Po(h),Ks(h),h.g=null;var _e=2}else if(gn(h.h,R))se=R.D,Vn(h.h,R),_e=1;else return;if(h.G!=0){if(R.o)if(_e==1){se=R.m?R.m.length:0,R=Date.now()-R.F;var Ve=h.B;_e=dt(),Ne(_e,new Qt(_e,se)),Ws(h)}else Ys(h);else if(Ve=R.s,Ve==3||Ve==0&&0<R.X||!(_e==1&&Ya(h,R)||_e==2&&fs(h)))switch(se&&0<se.length&&(R=h.h,R.i=R.i.concat(se)),Ve){case 1:fi(h,5);break;case 4:fi(h,10);break;case 3:fi(h,6);break;default:fi(h,2)}}}function Js(h,R){let se=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(se*=2),se*R}function fi(h,R){if(h.j.info("Error code "+R),R==2){var se=v(h.fb,h),_e=h.Xa;const Ve=!_e;_e=new ar(_e||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Wr(_e,"https"),Gn(_e),Ve?Di(_e.toString(),se):Vs(_e.toString(),se)}else yt(2);h.G=0,h.l&&h.l.sa(R),Qs(h),ds(h)}t.fb=function(h){h?(this.j.info("Successfully pinged google.com"),yt(2)):(this.j.info("Failed to ping google.com"),yt(1))};function Qs(h){if(h.G=0,h.ka=[],h.l){const R=Xn(h.h);(R.length!=0||h.i.length!=0)&&(w(h.ka,R),w(h.ka,h.i),h.h.i.length=0,P(h.i),h.i.length=0),h.l.ra()}}function A(h,R,se){var _e=se instanceof ar?pr(se):new ar(se);if(_e.g!="")R&&(_e.g=R+"."+_e.g),Fr(_e,_e.s);else{var Ve=a.location;_e=Ve.protocol,R=R?R+"."+Ve.hostname:Ve.hostname,Ve=+Ve.port;var Qe=new ar(null);_e&&Wr(Qe,_e),R&&(Qe.g=R),Ve&&Fr(Qe,Ve),se&&(Qe.l=se),_e=Qe}return se=h.D,R=h.ya,se&&R&&Sr(_e,se,R),Sr(_e,"VER",h.la),Vo(h,_e),_e}function pe(h,R,se){if(R&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return R=h.Ca&&!h.pa?new Qr(new Bo({eb:se})):new Qr(h.pa),R.Ha(h.J),R}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Le(){}t=Le.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Me(){}Me.prototype.g=function(h,R){return new ze(h,R)};function ze(h,R){Ce.call(this),this.g=new Us(R),this.l=h,this.h=R&&R.messageUrlParams||null,h=R&&R.messageHeaders||null,R&&R.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=R&&R.initMessageHeaders||null,R&&R.messageContentType&&(h?h["X-WebChannel-Content-Type"]=R.messageContentType:h={"X-WebChannel-Content-Type":R.messageContentType}),R&&R.va&&(h?h["X-WebChannel-Client-Profile"]=R.va:h={"X-WebChannel-Client-Profile":R.va}),this.g.S=h,(h=R&&R.Sb)&&!j(h)&&(this.g.m=h),this.v=R&&R.supportsCrossDomainXhr||!1,this.u=R&&R.sendRawJson||!1,(R=R&&R.httpSessionIdParam)&&!j(R)&&(this.g.D=R,h=this.h,h!==null&&R in h&&(h=this.h,R in h&&delete h[R])),this.j=new Dt(this)}I(ze,Ce),ze.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ze.prototype.close=function(){So(this.g)},ze.prototype.o=function(h){var R=this.g;if(typeof h=="string"){var se={};se.__data__=h,h=se}else this.u&&(se={},se.__data__=rt(h),h=se);R.i.push(new on(R.Ya++,h)),R.G==3&&Ws(R)},ze.prototype.N=function(){this.g.l=null,delete this.j,So(this.g),delete this.g,ze.aa.N.call(this)};function it(h){qe.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var R=h.__sm__;if(R){e:{for(const se in R){h=se;break e}h=void 0}(this.i=h)&&(h=this.i,R=R!==null&&h in R?R[h]:void 0),this.data=R}else this.data=h}I(it,qe);function Ct(){ot.call(this),this.status=1}I(Ct,ot);function Dt(h){this.g=h}I(Dt,Le),Dt.prototype.ua=function(){Ne(this.g,"a")},Dt.prototype.ta=function(h){Ne(this.g,new it(h))},Dt.prototype.sa=function(h){Ne(this.g,new Ct)},Dt.prototype.ra=function(){Ne(this.g,"b")},Me.prototype.createWebChannel=Me.prototype.g,ze.prototype.send=ze.prototype.o,ze.prototype.open=ze.prototype.m,ze.prototype.close=ze.prototype.close,zb=function(){return new Me},Vb=function(){return dt()},jb=Je,Wp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Vt.NO_ERROR=0,Vt.TIMEOUT=8,Vt.HTTP_ERROR=6,eh=Vt,Ft.COMPLETE="complete",Bb=Ft,Et.EventType=et,et.OPEN="a",et.CLOSE="b",et.ERROR="c",et.MESSAGE="d",Ce.prototype.listen=Ce.prototype.K,nu=Et,Qr.prototype.listenOnce=Qr.prototype.L,Qr.prototype.getLastError=Qr.prototype.Ka,Qr.prototype.getLastErrorCode=Qr.prototype.Ba,Qr.prototype.getStatus=Qr.prototype.Z,Qr.prototype.getResponseJson=Qr.prototype.Oa,Qr.prototype.getResponseText=Qr.prototype.oa,Qr.prototype.send=Qr.prototype.ea,Qr.prototype.setWithCredentials=Qr.prototype.Ha,Ob=Qr}).apply(typeof Id<"u"?Id:typeof self<"u"?self:typeof window<"u"?window:{});const Zg="@firebase/firestore",ev="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}_i.UNAUTHENTICATED=new _i(null),_i.GOOGLE_CREDENTIALS=new _i("google-credentials-uid"),_i.FIRST_PARTY=new _i("first-party-uid"),_i.MOCK_USER=new _i("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ic="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Al=new Mm("@firebase/firestore");function rc(){return Al.logLevel}function qt(t,...e){if(Al.logLevel<=Dr.DEBUG){const r=e.map(Km);Al.debug(`Firestore (${Ic}): ${t}`,...r)}}function Rs(t,...e){if(Al.logLevel<=Dr.ERROR){const r=e.map(Km);Al.error(`Firestore (${Ic}): ${t}`,...r)}}function gc(t,...e){if(Al.logLevel<=Dr.WARN){const r=e.map(Km);Al.warn(`Firestore (${Ic}): ${t}`,...r)}}function Km(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cr(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,qb(t,n,r)}function qb(t,e,r){let n=`FIRESTORE (${Ic}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Rs(n),new Error(n)}function Zr(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||qb(e,i,n)}function wr(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ct={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Bt extends Bs{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class tC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(_i.UNAUTHENTICATED))}shutdown(){}}class rC{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class nC{constructor(e){this.t=e,this.currentUser=_i.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Zr(this.o===void 0,42304);let n=this.i;const i=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let o=new Ns;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ns,e.enqueueRetryable(()=>i(this.currentUser))};const s=()=>{const c=o;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},a=c=>{qt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(qt("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ns)}},0),s()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(qt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Zr(typeof n.accessToken=="string",31837,{l:n}),new Ub(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Zr(e===null||typeof e=="string",2055,{h:e}),new _i(e)}}class iC{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=_i.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class oC{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new iC(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(_i.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class tv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class sC{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,yo(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Zr(this.o===void 0,3512);const n=o=>{o.error!=null&&qt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const s=o.token!==this.m;return this.m=o.token,qt("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const i=o=>{qt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):qt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new tv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Zr(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new tv(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aC(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=aC(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<r&&(n+=e.charAt(i[o]%62))}return n}}function Rr(t,e){return t<e?-1:t>e?1:0}function Gp(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),o=e.charAt(n);if(i!==o)return qf(i)===qf(o)?Rr(i,o):qf(i)?1:-1}return Rr(t.length,e.length)}const lC=55296,cC=57343;function qf(t){const e=t.charCodeAt(0);return e>=lC&&e<=cC}function vc(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rv="__name__";class Ko{constructor(e,r,n){r===void 0?r=0:r>e.length&&cr(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&cr(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Ko.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Ko?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const o=Ko.compareSegments(e.get(i),r.get(i));if(o!==0)return o}return Rr(e.length,r.length)}static compareSegments(e,r){const n=Ko.isNumericId(e),i=Ko.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?Ko.extractNumericId(e).compare(Ko.extractNumericId(r)):Gp(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ia.fromString(e.substring(4,e.length-2))}}class pn extends Ko{construct(e,r,n){return new pn(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Bt(ct.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new pn(r)}static emptyPath(){return new pn([])}}const uC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ai extends Ko{construct(e,r,n){return new ai(e,r,n)}static isValidIdentifier(e){return uC.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ai.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===rv}static keyField(){return new ai([rv])}static fromServerFormat(e){const r=[];let n="",i=0;const o=()=>{if(n.length===0)throw new Bt(ct.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let s=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new Bt(ct.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Bt(ct.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(n+=a,i++):(o(),i++)}if(o(),s)throw new Bt(ct.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ai(r)}static emptyPath(){return new ai([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.path=e}static fromPath(e){return new Zt(pn.fromString(e))}static fromName(e){return new Zt(pn.fromString(e).popFirst(5))}static empty(){return new Zt(pn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return pn.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Zt(new pn(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hb(t,e,r){if(!r)throw new Bt(ct.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function dC(t,e,r,n){if(e===!0&&n===!0)throw new Bt(ct.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function nv(t){if(!Zt.isDocumentKey(t))throw new Bt(ct.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function iv(t){if(Zt.isDocumentKey(t))throw new Bt(ct.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Wb(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Gh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":cr(12329,{type:typeof t})}function Ms(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Bt(ct.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Gh(t);throw new Bt(ct.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jn(t,e){const r={typeString:t};return e&&(r.value=e),r}function Yu(t,e){if(!Wb(t))throw new Bt(ct.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const s=t[n];if(i&&typeof s!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(o!==void 0&&s!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new Bt(ct.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ov=-62135596800,sv=1e6;class mn{static now(){return mn.fromMillis(Date.now())}static fromDate(e){return mn.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*sv);return new mn(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Bt(ct.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Bt(ct.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<ov)throw new Bt(ct.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Bt(ct.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/sv}_compareTo(e){return this.seconds===e.seconds?Rr(this.nanoseconds,e.nanoseconds):Rr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:mn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Yu(e,mn._jsonSchema))return new mn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-ov;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}mn._jsonSchemaVersion="firestore/timestamp/1.0",mn._jsonSchema={type:jn("string",mn._jsonSchemaVersion),seconds:jn("number"),nanoseconds:jn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{static fromTimestamp(e){return new gr(e)}static min(){return new gr(new mn(0,0))}static max(){return new gr(new mn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tu=-1;function hC(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=gr.fromTimestamp(n===1e9?new mn(r+1,0):new mn(r,n));return new Ea(i,Zt.empty(),e)}function fC(t){return new Ea(t.readTime,t.key,Tu)}class Ea{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Ea(gr.min(),Zt.empty(),Tu)}static max(){return new Ea(gr.max(),Zt.empty(),Tu)}}function pC(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Zt.comparator(t.documentKey,e.documentKey),r!==0?r:Rr(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class yC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $c(t){if(t.code!==ct.FAILED_PRECONDITION||t.message!==mC)throw t;qt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&cr(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new vt((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof vt?r:vt.resolve(r)}catch(r){return vt.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):vt.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):vt.reject(r)}static resolve(e){return new vt((r,n)=>{r(e)})}static reject(e){return new vt((r,n)=>{n(e)})}static waitFor(e){return new vt((r,n)=>{let i=0,o=0,s=!1;e.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&r()},c=>n(c))}),s=!0,o===i&&r()})}static or(e){let r=vt.resolve(!1);for(const n of e)r=r.next(i=>i?vt.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,o)=>{n.push(r.call(this,i,o))}),this.waitFor(n)}static mapArray(e,r){return new vt((n,i)=>{const o=e.length,s=new Array(o);let a=0;for(let c=0;c<o;c++){const u=c;r(e[u]).next(f=>{s[u]=f,++a,a===o&&n(s)},f=>i(f))}})}static doWhile(e,r){return new vt((n,i)=>{const o=()=>{e()===!0?r().next(()=>{o()},i):n()};o()})}}function gC(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function kc(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Yh.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qm=-1;function Kh(t){return t==null}function Ah(t){return t===0&&1/t==-1/0}function vC(t){return typeof t=="number"&&Number.isInteger(t)&&!Ah(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gb="";function bC(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=av(e)),e=_C(t.get(r),e);return av(e)}function _C(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const o=t.charAt(i);switch(o){case"\0":r+="";break;case Gb:r+="";break;default:r+=o}}return r}function av(t){return t+Gb+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lv(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function ja(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function Yb(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e,r){this.comparator=e,this.root=r||si.EMPTY}insert(e,r){return new _n(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,si.BLACK,null,null))}remove(e){return new _n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,si.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $d(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $d(this.root,e,this.comparator,!1)}getReverseIterator(){return new $d(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $d(this.root,e,this.comparator,!0)}}class $d{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class si{constructor(e,r,n,i,o){this.key=e,this.value=r,this.color=n??si.RED,this.left=i??si.EMPTY,this.right=o??si.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,o){return new si(e??this.key,r??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,r,n),null):o===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return si.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return si.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,si.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,si.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw cr(43730,{key:this.key,value:this.value});if(this.right.isRed())throw cr(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw cr(27949);return e+(this.isRed()?0:1)}}si.EMPTY=null,si.RED=!0,si.BLACK=!1;si.EMPTY=new class{constructor(){this.size=0}get key(){throw cr(57766)}get value(){throw cr(16141)}get color(){throw cr(16727)}get left(){throw cr(29726)}get right(){throw cr(36894)}copy(e,r,n,i,o){return this}insert(e,r,n){return new si(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.comparator=e,this.data=new _n(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new cv(this.data.getIterator())}getIteratorFrom(e){return new cv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Wn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Wn(this.comparator);return r.data=e,r}}class cv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e){this.fields=e,e.sort(ai.comparator)}static empty(){return new Zi([])}unionWith(e){let r=new Wn(ai.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Zi(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return vc(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kb extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Kb("Invalid base64 string: "+o):o}}(e);return new di(r)}static fromUint8Array(e){const r=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new di(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Rr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}di.EMPTY_BYTE_STRING=new di("");const wC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ta(t){if(Zr(!!t,39018),typeof t=="string"){let e=0;const r=wC.exec(t);if(Zr(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:In(t.seconds),nanos:In(t.nanos)}}function In(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Na(t){return typeof t=="string"?di.fromBase64String(t):di.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jb="server_timestamp",Qb="__type__",Xb="__previous_value__",Zb="__local_write_time__";function Xm(t){return(t?.mapValue?.fields||{})[Qb]?.stringValue===Jb}function Jh(t){const e=t.mapValue.fields[Xb];return Xm(e)?Jh(e):e}function Nu(t){const e=Ta(t.mapValue.fields[Zb].timestampValue);return new mn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(e,r,n,i,o,s,a,c,u,f){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=f}}const Ch="(default)";class Lu{constructor(e,r){this.projectId=e,this.database=r||Ch}static empty(){return new Lu("","")}get isDefaultDatabase(){return this.database===Ch}isEqual(e){return e instanceof Lu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e2="__type__",PC="__max__",kd={mapValue:{}},t2="__vector__",Ih="value";function La(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Xm(t)?4:AC(t)?9007199254740991:xC(t)?10:11:cr(28295,{value:t})}function ss(t,e){if(t===e)return!0;const r=La(t);if(r!==La(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Nu(t).isEqual(Nu(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const s=Ta(i.timestampValue),a=Ta(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return Na(i.bytesValue).isEqual(Na(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return In(i.geoPointValue.latitude)===In(o.geoPointValue.latitude)&&In(i.geoPointValue.longitude)===In(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return In(i.integerValue)===In(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const s=In(i.doubleValue),a=In(o.doubleValue);return s===a?Ah(s)===Ah(a):isNaN(s)&&isNaN(a)}return!1}(t,e);case 9:return vc(t.arrayValue.values||[],e.arrayValue.values||[],ss);case 10:case 11:return function(i,o){const s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(lv(s)!==lv(a))return!1;for(const c in s)if(s.hasOwnProperty(c)&&(a[c]===void 0||!ss(s[c],a[c])))return!1;return!0}(t,e);default:return cr(52216,{left:t})}}function Du(t,e){return(t.values||[]).find(r=>ss(r,e))!==void 0}function bc(t,e){if(t===e)return 0;const r=La(t),n=La(e);if(r!==n)return Rr(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Rr(t.booleanValue,e.booleanValue);case 2:return function(o,s){const a=In(o.integerValue||o.doubleValue),c=In(s.integerValue||s.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return uv(t.timestampValue,e.timestampValue);case 4:return uv(Nu(t),Nu(e));case 5:return Gp(t.stringValue,e.stringValue);case 6:return function(o,s){const a=Na(o),c=Na(s);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(o,s){const a=o.split("/"),c=s.split("/");for(let u=0;u<a.length&&u<c.length;u++){const f=Rr(a[u],c[u]);if(f!==0)return f}return Rr(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,s){const a=Rr(In(o.latitude),In(s.latitude));return a!==0?a:Rr(In(o.longitude),In(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return dv(t.arrayValue,e.arrayValue);case 10:return function(o,s){const a=o.fields||{},c=s.fields||{},u=a[Ih]?.arrayValue,f=c[Ih]?.arrayValue,y=Rr(u?.values?.length||0,f?.values?.length||0);return y!==0?y:dv(u,f)}(t.mapValue,e.mapValue);case 11:return function(o,s){if(o===kd.mapValue&&s===kd.mapValue)return 0;if(o===kd.mapValue)return 1;if(s===kd.mapValue)return-1;const a=o.fields||{},c=Object.keys(a),u=s.fields||{},f=Object.keys(u);c.sort(),f.sort();for(let y=0;y<c.length&&y<f.length;++y){const v=Gp(c[y],f[y]);if(v!==0)return v;const p=bc(a[c[y]],u[f[y]]);if(p!==0)return p}return Rr(c.length,f.length)}(t.mapValue,e.mapValue);default:throw cr(23264,{he:r})}}function uv(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Rr(t,e);const r=Ta(t),n=Ta(e),i=Rr(r.seconds,n.seconds);return i!==0?i:Rr(r.nanos,n.nanos)}function dv(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const o=bc(r[i],n[i]);if(o)return o}return Rr(r.length,n.length)}function _c(t){return Yp(t)}function Yp(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Ta(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Na(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Zt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const o of r.values||[])i?i=!1:n+=",",n+=Yp(o);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const s of n)o?o=!1:i+=",",i+=`${s}:${Yp(r.fields[s])}`;return i+"}"}(t.mapValue):cr(61005,{value:t})}function th(t){switch(La(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Jh(t);return e?16+th(e):16;case 5:return 2*t.stringValue.length;case 6:return Na(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,o)=>i+th(o),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return ja(n.fields,(o,s)=>{i+=o.length+th(s)}),i}(t.mapValue);default:throw cr(13486,{value:t})}}function hv(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Kp(t){return!!t&&"integerValue"in t}function Zm(t){return!!t&&"arrayValue"in t}function fv(t){return!!t&&"nullValue"in t}function pv(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function rh(t){return!!t&&"mapValue"in t}function xC(t){return(t?.mapValue?.fields||{})[e2]?.stringValue===t2}function fu(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ja(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=fu(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=fu(t.arrayValue.values[r]);return e}return{...t}}function AC(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===PC}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(e){this.value=e}static empty(){return new qi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!rh(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=fu(r)}setAll(e){let r=ai.emptyPath(),n={},i=[];e.forEach((s,a)=>{if(!r.isImmediateParentOf(a)){const c=this.getFieldsMap(r);this.applyChanges(c,n,i),n={},i=[],r=a.popLast()}s?n[a.lastSegment()]=fu(s):i.push(a.lastSegment())});const o=this.getFieldsMap(r);this.applyChanges(o,n,i)}delete(e){const r=this.field(e.popLast());rh(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ss(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];rh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){ja(r,(i,o)=>e[i]=o);for(const i of n)delete e[i]}clone(){return new qi(fu(this.value))}}function r2(t){const e=[];return ja(t.fields,(r,n)=>{const i=new ai([r]);if(rh(n)){const o=r2(n.mapValue).fields;if(o.length===0)e.push(i);else for(const s of o)e.push(i.child(s))}else e.push(i)}),new Zi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(e,r,n,i,o,s,a){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new wi(e,0,gr.min(),gr.min(),gr.min(),qi.empty(),0)}static newFoundDocument(e,r,n,i){return new wi(e,1,r,gr.min(),n,i,0)}static newNoDocument(e,r){return new wi(e,2,r,gr.min(),gr.min(),qi.empty(),0)}static newUnknownDocument(e,r){return new wi(e,3,r,gr.min(),gr.min(),qi.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(gr.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=qi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=qi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=gr.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof wi&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new wi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(e,r){this.position=e,this.inclusive=r}}function mv(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const o=e[i],s=t.position[i];if(o.field.isKeyField()?n=Zt.comparator(Zt.fromName(s.referenceValue),r.key):n=bc(s,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function yv(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ss(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(e,r="asc"){this.field=e,this.dir=r}}function CC(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{}class Bn extends n2{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new $C(e,r,n):r==="array-contains"?new TC(e,n):r==="in"?new NC(e,n):r==="not-in"?new LC(e,n):r==="array-contains-any"?new DC(e,n):new Bn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new kC(e,n):new EC(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(bc(r,this.value)):r!==null&&La(this.value)===La(r)&&this.matchesComparison(bc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return cr(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ro extends n2{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Ro(e,r)}matches(e){return i2(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function i2(t){return t.op==="and"}function o2(t){return IC(t)&&i2(t)}function IC(t){for(const e of t.filters)if(e instanceof Ro)return!1;return!0}function Jp(t){if(t instanceof Bn)return t.field.canonicalString()+t.op.toString()+_c(t.value);if(o2(t))return t.filters.map(e=>Jp(e)).join(",");{const e=t.filters.map(r=>Jp(r)).join(",");return`${t.op}(${e})`}}function s2(t,e){return t instanceof Bn?function(n,i){return i instanceof Bn&&n.op===i.op&&n.field.isEqual(i.field)&&ss(n.value,i.value)}(t,e):t instanceof Ro?function(n,i){return i instanceof Ro&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((o,s,a)=>o&&s2(s,i.filters[a]),!0):!1}(t,e):void cr(19439)}function a2(t){return t instanceof Bn?function(r){return`${r.field.canonicalString()} ${r.op} ${_c(r.value)}`}(t):t instanceof Ro?function(r){return r.op.toString()+" {"+r.getFilters().map(a2).join(" ,")+"}"}(t):"Filter"}class $C extends Bn{constructor(e,r,n){super(e,r,n),this.key=Zt.fromName(n.referenceValue)}matches(e){const r=Zt.comparator(e.key,this.key);return this.matchesComparison(r)}}class kC extends Bn{constructor(e,r){super(e,"in",r),this.keys=l2("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class EC extends Bn{constructor(e,r){super(e,"not-in",r),this.keys=l2("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function l2(t,e){return(e.arrayValue?.values||[]).map(r=>Zt.fromName(r.referenceValue))}class TC extends Bn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Zm(r)&&Du(r.arrayValue,this.value)}}class NC extends Bn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Du(this.value.arrayValue,r)}}class LC extends Bn{constructor(e,r){super(e,"not-in",r)}matches(e){if(Du(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Du(this.value.arrayValue,r)}}class DC extends Bn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Zm(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Du(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC{constructor(e,r=null,n=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.Te=null}}function gv(t,e=null,r=[],n=[],i=null,o=null,s=null){return new RC(t,e,r,n,i,o,s)}function ey(t){const e=wr(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Jp(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),Kh(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>_c(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>_c(n)).join(",")),e.Te=r}return e.Te}function ty(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!CC(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!s2(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!yv(t.startAt,e.startAt)&&yv(t.endAt,e.endAt)}function Qp(t){return Zt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec{constructor(e,r=null,n=[],i=[],o=null,s="F",a=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function MC(t,e,r,n,i,o,s,a){return new Ec(t,e,r,n,i,o,s,a)}function ry(t){return new Ec(t)}function vv(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function c2(t){return t.collectionGroup!==null}function pu(t){const e=wr(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Wn(ai.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(o=>{r.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new Ru(o,n))}),r.has(ai.keyField().canonicalString())||e.Ie.push(new Ru(ai.keyField(),n))}return e.Ie}function Zo(t){const e=wr(t);return e.Ee||(e.Ee=FC(e,pu(t))),e.Ee}function FC(t,e){if(t.limitType==="F")return gv(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new Ru(i.field,o)});const r=t.endAt?new $h(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new $h(t.startAt.position,t.startAt.inclusive):null;return gv(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Xp(t,e){const r=t.filters.concat([e]);return new Ec(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Zp(t,e,r){return new Ec(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Qh(t,e){return ty(Zo(t),Zo(e))&&t.limitType===e.limitType}function u2(t){return`${ey(Zo(t))}|lt:${t.limitType}`}function nc(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>a2(i)).join(", ")}]`),Kh(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>_c(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>_c(i)).join(",")),`Target(${n})`}(Zo(t))}; limitType=${t.limitType})`}function Xh(t,e){return e.isFoundDocument()&&function(n,i){const o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):Zt.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(t,e)&&function(n,i){for(const o of pu(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(s,a,c){const u=mv(s,a,c);return s.inclusive?u<=0:u<0}(n.startAt,pu(n),i)||n.endAt&&!function(s,a,c){const u=mv(s,a,c);return s.inclusive?u>=0:u>0}(n.endAt,pu(n),i))}(t,e)}function OC(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function d2(t){return(e,r)=>{let n=!1;for(const i of pu(t)){const o=BC(i,e,r);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function BC(t,e,r){const n=t.field.isKeyField()?Zt.comparator(e.key,r.key):function(o,s,a){const c=s.data.field(o),u=a.data.field(o);return c!==null&&u!==null?bc(c,u):cr(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return cr(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,o]of n)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ja(this.inner,(r,n)=>{for(const[i,o]of n)e(i,o)})}isEmpty(){return Yb(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jC=new _n(Zt.comparator);function Fs(){return jC}const h2=new _n(Zt.comparator);function iu(...t){let e=h2;for(const r of t)e=e.insert(r.key,r);return e}function f2(t){let e=h2;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function pl(){return mu()}function p2(){return mu()}function mu(){return new $l(t=>t.toString(),(t,e)=>t.isEqual(e))}const VC=new _n(Zt.comparator),zC=new Wn(Zt.comparator);function Mr(...t){let e=zC;for(const r of t)e=e.add(r);return e}const qC=new Wn(Rr);function UC(){return qC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ny(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ah(e)?"-0":e}}function m2(t){return{integerValue:""+t}}function HC(t,e){return vC(e)?m2(e):ny(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(){this._=void 0}}function WC(t,e,r){return t instanceof kh?function(i,o){const s={fields:{[Qb]:{stringValue:Jb},[Zb]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Xm(o)&&(o=Jh(o)),o&&(s.fields[Xb]=o),{mapValue:s}}(r,e):t instanceof Mu?g2(t,e):t instanceof Fu?v2(t,e):function(i,o){const s=y2(i,o),a=bv(s)+bv(i.Ae);return Kp(s)&&Kp(i.Ae)?m2(a):ny(i.serializer,a)}(t,e)}function GC(t,e,r){return t instanceof Mu?g2(t,e):t instanceof Fu?v2(t,e):r}function y2(t,e){return t instanceof Eh?function(n){return Kp(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}class kh extends Zh{}class Mu extends Zh{constructor(e){super(),this.elements=e}}function g2(t,e){const r=b2(e);for(const n of t.elements)r.some(i=>ss(i,n))||r.push(n);return{arrayValue:{values:r}}}class Fu extends Zh{constructor(e){super(),this.elements=e}}function v2(t,e){let r=b2(e);for(const n of t.elements)r=r.filter(i=>!ss(i,n));return{arrayValue:{values:r}}}class Eh extends Zh{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function bv(t){return In(t.integerValue||t.doubleValue)}function b2(t){return Zm(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function YC(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Mu&&i instanceof Mu||n instanceof Fu&&i instanceof Fu?vc(n.elements,i.elements,ss):n instanceof Eh&&i instanceof Eh?ss(n.Ae,i.Ae):n instanceof kh&&i instanceof kh}(t.transform,e.transform)}class KC{constructor(e,r){this.version=e,this.transformResults=r}}class es{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new es}static exists(e){return new es(void 0,e)}static updateTime(e){return new es(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function nh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ef{}function _2(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new S2(t.key,es.none()):new Ku(t.key,t.data,es.none());{const r=t.data,n=qi.empty();let i=new Wn(ai.comparator);for(let o of e.fields)if(!i.has(o)){let s=r.field(o);s===null&&o.length>1&&(o=o.popLast(),s=r.field(o)),s===null?n.delete(o):n.set(o,s),i=i.add(o)}return new Va(t.key,n,new Zi(i.toArray()),es.none())}}function JC(t,e,r){t instanceof Ku?function(i,o,s){const a=i.value.clone(),c=wv(i.fieldTransforms,o,s.transformResults);a.setAll(c),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(t,e,r):t instanceof Va?function(i,o,s){if(!nh(i.precondition,o))return void o.convertToUnknownDocument(s.version);const a=wv(i.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(w2(i)),c.setAll(a),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(t,e,r):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,r)}function yu(t,e,r,n){return t instanceof Ku?function(o,s,a,c){if(!nh(o.precondition,s))return a;const u=o.value.clone(),f=Sv(o.fieldTransforms,c,s);return u.setAll(f),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof Va?function(o,s,a,c){if(!nh(o.precondition,s))return a;const u=Sv(o.fieldTransforms,c,s),f=s.data;return f.setAll(w2(o)),f.setAll(u),s.convertToFoundDocument(s.version,f).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(y=>y.field))}(t,e,r,n):function(o,s,a){return nh(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a}(t,e,r)}function QC(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),o=y2(n.transform,i||null);o!=null&&(r===null&&(r=qi.empty()),r.set(n.field,o))}return r||null}function _v(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&vc(n,i,(o,s)=>YC(o,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ku extends ef{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Va extends ef{constructor(e,r,n,i,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function w2(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function wv(t,e,r){const n=new Map;Zr(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const o=t[i],s=o.transform,a=e.data.field(o.field);n.set(o.field,GC(s,a,r[i]))}return n}function Sv(t,e,r){const n=new Map;for(const i of t){const o=i.transform,s=r.data.field(i.field);n.set(i.field,WC(o,s,e))}return n}class S2 extends ef{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class XC extends ef{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&JC(o,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=yu(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=yu(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=p2();return this.mutations.forEach(i=>{const o=e.get(i.key),s=o.overlayedDocument;let a=this.applyToLocalView(s,o.mutatedFields);a=r.has(i.key)?null:a;const c=_2(s,a);c!==null&&n.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(gr.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Mr())}isEqual(e){return this.batchId===e.batchId&&vc(this.mutations,e.mutations,(r,n)=>_v(r,n))&&vc(this.baseMutations,e.baseMutations,(r,n)=>_v(r,n))}}class iy{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Zr(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return VC}();const o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,n[s].version);return new iy(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e3{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t3{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var On,jr;function r3(t){switch(t){case ct.OK:return cr(64938);case ct.CANCELLED:case ct.UNKNOWN:case ct.DEADLINE_EXCEEDED:case ct.RESOURCE_EXHAUSTED:case ct.INTERNAL:case ct.UNAVAILABLE:case ct.UNAUTHENTICATED:return!1;case ct.INVALID_ARGUMENT:case ct.NOT_FOUND:case ct.ALREADY_EXISTS:case ct.PERMISSION_DENIED:case ct.FAILED_PRECONDITION:case ct.ABORTED:case ct.OUT_OF_RANGE:case ct.UNIMPLEMENTED:case ct.DATA_LOSS:return!0;default:return cr(15467,{code:t})}}function P2(t){if(t===void 0)return Rs("GRPC error has no .code"),ct.UNKNOWN;switch(t){case On.OK:return ct.OK;case On.CANCELLED:return ct.CANCELLED;case On.UNKNOWN:return ct.UNKNOWN;case On.DEADLINE_EXCEEDED:return ct.DEADLINE_EXCEEDED;case On.RESOURCE_EXHAUSTED:return ct.RESOURCE_EXHAUSTED;case On.INTERNAL:return ct.INTERNAL;case On.UNAVAILABLE:return ct.UNAVAILABLE;case On.UNAUTHENTICATED:return ct.UNAUTHENTICATED;case On.INVALID_ARGUMENT:return ct.INVALID_ARGUMENT;case On.NOT_FOUND:return ct.NOT_FOUND;case On.ALREADY_EXISTS:return ct.ALREADY_EXISTS;case On.PERMISSION_DENIED:return ct.PERMISSION_DENIED;case On.FAILED_PRECONDITION:return ct.FAILED_PRECONDITION;case On.ABORTED:return ct.ABORTED;case On.OUT_OF_RANGE:return ct.OUT_OF_RANGE;case On.UNIMPLEMENTED:return ct.UNIMPLEMENTED;case On.DATA_LOSS:return ct.DATA_LOSS;default:return cr(39323,{code:t})}}(jr=On||(On={}))[jr.OK=0]="OK",jr[jr.CANCELLED=1]="CANCELLED",jr[jr.UNKNOWN=2]="UNKNOWN",jr[jr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",jr[jr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",jr[jr.NOT_FOUND=5]="NOT_FOUND",jr[jr.ALREADY_EXISTS=6]="ALREADY_EXISTS",jr[jr.PERMISSION_DENIED=7]="PERMISSION_DENIED",jr[jr.UNAUTHENTICATED=16]="UNAUTHENTICATED",jr[jr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",jr[jr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",jr[jr.ABORTED=10]="ABORTED",jr[jr.OUT_OF_RANGE=11]="OUT_OF_RANGE",jr[jr.UNIMPLEMENTED=12]="UNIMPLEMENTED",jr[jr.INTERNAL=13]="INTERNAL",jr[jr.UNAVAILABLE=14]="UNAVAILABLE",jr[jr.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n3(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i3=new Ia([4294967295,4294967295],0);function Pv(t){const e=n3().encode(t),r=new Fb;return r.update(e),new Uint8Array(r.digest())}function xv(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Ia([r,n],0),new Ia([i,o],0)]}class oy{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new ou(`Invalid padding: ${r}`);if(n<0)throw new ou(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new ou(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new ou(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Ia.fromNumber(this.ge)}ye(e,r,n){let i=e.add(r.multiply(Ia.fromNumber(n)));return i.compare(i3)===1&&(i=new Ia([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=Pv(e),[n,i]=xv(r);for(let o=0;o<this.hashCount;o++){const s=this.ye(n,i,o);if(!this.we(s))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new oy(o,i,r);return n.forEach(a=>s.insert(a)),s}insert(e){if(this.ge===0)return;const r=Pv(e),[n,i]=xv(r);for(let o=0;o<this.hashCount;o++){const s=this.ye(n,i,o);this.Se(s)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class ou extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(e,r,n,i,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Ju.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new tf(gr.min(),i,new _n(Rr),Fs(),Mr())}}class Ju{constructor(e,r,n,i,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Ju(n,r,Mr(),Mr(),Mr())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ih{constructor(e,r,n,i){this.be=e,this.removedTargetIds=r,this.key=n,this.De=i}}class x2{constructor(e,r){this.targetId=e,this.Ce=r}}class A2{constructor(e,r,n=di.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class Av{constructor(){this.ve=0,this.Fe=Cv(),this.Me=di.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Mr(),r=Mr(),n=Mr();return this.Fe.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:cr(38017,{changeType:o})}}),new Ju(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=Cv()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Zr(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class o3{constructor(e){this.Ge=e,this.ze=new Map,this.je=Fs(),this.Je=Ed(),this.He=Ed(),this.Ye=new _n(Rr)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:cr(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,i)=>{this.rt(i)&&r(i)})}st(e){const r=e.targetId,n=e.Ce.count,i=this.ot(r);if(i){const o=i.target;if(Qp(o))if(n===0){const s=new Zt(o.path);this.et(r,s,wi.newNoDocument(s,gr.min()))}else Zr(n===1,20013,{expectedCount:n});else{const s=this._t(r);if(s!==n){const a=this.ut(e),c=a?this.ct(a,e,s):1;if(c!==0){this.it(r);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,u)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=r;let s,a;try{s=Na(n).toUint8Array()}catch(c){if(c instanceof Kb)return gc("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new oy(s,i,o)}catch(c){return gc(c instanceof ou?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let i=0;return n.forEach(o=>{const s=this.Ge.ht(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.et(r,o,null),i++)}),i}Tt(e){const r=new Map;this.ze.forEach((o,s)=>{const a=this.ot(s);if(a){if(o.current&&Qp(a.target)){const c=new Zt(a.target.path);this.It(c).has(s)||this.Et(s,c)||this.et(s,c,wi.newNoDocument(c,e))}o.Be&&(r.set(s,o.ke()),o.qe())}});let n=Mr();this.He.forEach((o,s)=>{let a=!0;s.forEachWhile(c=>{const u=this.ot(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(n=n.add(o))}),this.je.forEach((o,s)=>s.setReadTime(e));const i=new tf(e,r,this.Ye,this.je,n);return this.je=Fs(),this.Je=Ed(),this.He=Ed(),this.Ye=new _n(Rr),i}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,r)?i.Qe(r,1):i.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new Av,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new Wn(Rr),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new Wn(Rr),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||qt("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Av),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Ed(){return new _n(Zt.comparator)}function Cv(){return new _n(Zt.comparator)}const s3={asc:"ASCENDING",desc:"DESCENDING"},a3={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},l3={and:"AND",or:"OR"};class c3{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function em(t,e){return t.useProto3Json||Kh(e)?e:{value:e}}function Th(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function C2(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function u3(t,e){return Th(t,e.toTimestamp())}function ts(t){return Zr(!!t,49232),gr.fromTimestamp(function(r){const n=Ta(r);return new mn(n.seconds,n.nanos)}(t))}function sy(t,e){return tm(t,e).canonicalString()}function tm(t,e){const r=function(i){return new pn(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function I2(t){const e=pn.fromString(t);return Zr(N2(e),10190,{key:e.toString()}),e}function rm(t,e){return sy(t.databaseId,e.path)}function Uf(t,e){const r=I2(e);if(r.get(1)!==t.databaseId.projectId)throw new Bt(ct.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Bt(ct.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Zt(k2(r))}function $2(t,e){return sy(t.databaseId,e)}function d3(t){const e=I2(t);return e.length===4?pn.emptyPath():k2(e)}function nm(t){return new pn(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function k2(t){return Zr(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Iv(t,e,r){return{name:rm(t,e),fields:r.value.mapValue.fields}}function h3(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:cr(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(u,f){return u.useProto3Json?(Zr(f===void 0||typeof f=="string",58123),di.fromBase64String(f||"")):(Zr(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),di.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(u){const f=u.code===void 0?ct.UNKNOWN:P2(u.code);return new Bt(f,u.message||"")}(s);r=new A2(n,i,o,a||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Uf(t,n.document.name),o=ts(n.document.updateTime),s=n.document.createTime?ts(n.document.createTime):gr.min(),a=new qi({mapValue:{fields:n.document.fields}}),c=wi.newFoundDocument(i,o,s,a),u=n.targetIds||[],f=n.removedTargetIds||[];r=new ih(u,f,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Uf(t,n.document),o=n.readTime?ts(n.readTime):gr.min(),s=wi.newNoDocument(i,o),a=n.removedTargetIds||[];r=new ih([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Uf(t,n.document),o=n.removedTargetIds||[];r=new ih([],o,i,null)}else{if(!("filter"in e))return cr(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:o}=n,s=new t3(i,o),a=n.targetId;r=new x2(a,s)}}return r}function f3(t,e){let r;if(e instanceof Ku)r={update:Iv(t,e.key,e.value)};else if(e instanceof S2)r={delete:rm(t,e.key)};else if(e instanceof Va)r={update:Iv(t,e.key,e.data),updateMask:S3(e.fieldMask)};else{if(!(e instanceof XC))return cr(16599,{Vt:e.type});r={verify:rm(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(o,s){const a=s.transform;if(a instanceof kh)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Mu)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Fu)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Eh)return{fieldPath:s.field.canonicalString(),increment:a.Ae};throw cr(20930,{transform:s.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:u3(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:cr(27497)}(t,e.precondition)),r}function p3(t,e){return t&&t.length>0?(Zr(e!==void 0,14353),t.map(r=>function(i,o){let s=i.updateTime?ts(i.updateTime):ts(o);return s.isEqual(gr.min())&&(s=ts(o)),new KC(s,i.transformResults||[])}(r,e))):[]}function m3(t,e){return{documents:[$2(t,e.path)]}}function y3(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=$2(t,i);const o=function(u){if(u.length!==0)return T2(Ro.create(u,"and"))}(e.filters);o&&(r.structuredQuery.where=o);const s=function(u){if(u.length!==0)return u.map(f=>function(v){return{field:ic(v.field),direction:b3(v.dir)}}(f))}(e.orderBy);s&&(r.structuredQuery.orderBy=s);const a=em(t,e.limit);return a!==null&&(r.structuredQuery.limit=a),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:r,parent:i}}function g3(t){let e=d3(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Zr(n===1,65062);const f=r.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let o=[];r.where&&(o=function(y){const v=E2(y);return v instanceof Ro&&o2(v)?v.getFilters():[v]}(r.where));let s=[];r.orderBy&&(s=function(y){return y.map(v=>function(I){return new Ru(oc(I.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(I.direction))}(v))}(r.orderBy));let a=null;r.limit&&(a=function(y){let v;return v=typeof y=="object"?y.value:y,Kh(v)?null:v}(r.limit));let c=null;r.startAt&&(c=function(y){const v=!!y.before,p=y.values||[];return new $h(p,v)}(r.startAt));let u=null;return r.endAt&&(u=function(y){const v=!y.before,p=y.values||[];return new $h(p,v)}(r.endAt)),MC(e,i,s,o,a,"F",c,u)}function v3(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return cr(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function E2(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=oc(r.unaryFilter.field);return Bn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=oc(r.unaryFilter.field);return Bn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=oc(r.unaryFilter.field);return Bn.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=oc(r.unaryFilter.field);return Bn.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return cr(61313);default:return cr(60726)}}(t):t.fieldFilter!==void 0?function(r){return Bn.create(oc(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return cr(58110);default:return cr(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Ro.create(r.compositeFilter.filters.map(n=>E2(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return cr(1026)}}(r.compositeFilter.op))}(t):cr(30097,{filter:t})}function b3(t){return s3[t]}function _3(t){return a3[t]}function w3(t){return l3[t]}function ic(t){return{fieldPath:t.canonicalString()}}function oc(t){return ai.fromServerFormat(t.fieldPath)}function T2(t){return t instanceof Bn?function(r){if(r.op==="=="){if(pv(r.value))return{unaryFilter:{field:ic(r.field),op:"IS_NAN"}};if(fv(r.value))return{unaryFilter:{field:ic(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(pv(r.value))return{unaryFilter:{field:ic(r.field),op:"IS_NOT_NAN"}};if(fv(r.value))return{unaryFilter:{field:ic(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ic(r.field),op:_3(r.op),value:r.value}}}(t):t instanceof Ro?function(r){const n=r.getFilters().map(i=>T2(i));return n.length===1?n[0]:{compositeFilter:{op:w3(r.op),filters:n}}}(t):cr(54877,{filter:t})}function S3(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function N2(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(e,r,n,i,o=gr.min(),s=gr.min(),a=di.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new _a(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new _a(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _a(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _a(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P3{constructor(e){this.yt=e}}function x3(t){const e=g3({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Zp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A3{constructor(){this.Cn=new C3}addToCollectionParentIndex(e,r){return this.Cn.add(r),vt.resolve()}getCollectionParents(e,r){return vt.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return vt.resolve()}deleteFieldIndex(e,r){return vt.resolve()}deleteAllFieldIndexes(e){return vt.resolve()}createTargetIndexes(e,r){return vt.resolve()}getDocumentsMatchingTarget(e,r){return vt.resolve(null)}getIndexType(e,r){return vt.resolve(0)}getFieldIndexes(e,r){return vt.resolve([])}getNextCollectionGroupToUpdate(e){return vt.resolve(null)}getMinOffset(e,r){return vt.resolve(Ea.min())}getMinOffsetFromCollectionGroup(e,r){return vt.resolve(Ea.min())}updateCollectionGroup(e,r,n){return vt.resolve()}updateIndexEntries(e,r){return vt.resolve()}}class C3{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Wn(pn.comparator),o=!i.has(n);return this.index[r]=i.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Wn(pn.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $v={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},L2=41943040;class zi{static withCacheSize(e){return new zi(e,zi.DEFAULT_COLLECTION_PERCENTILE,zi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zi.DEFAULT_COLLECTION_PERCENTILE=10,zi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,zi.DEFAULT=new zi(L2,zi.DEFAULT_COLLECTION_PERCENTILE,zi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),zi.DISABLED=new zi(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new wc(0)}static cr(){return new wc(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kv="LruGarbageCollector",I3=1048576;function Ev([t,e],[r,n]){const i=Rr(t,r);return i===0?Rr(e,n):i}class $3{constructor(e){this.Ir=e,this.buffer=new Wn(Ev),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();Ev(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class k3{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){qt(kv,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){kc(r)?qt(kv,"Ignoring IndexedDB error during garbage collection: ",r):await $c(r)}await this.Vr(3e5)})}}class E3{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return vt.resolve(Yh.ce);const n=new $3(r);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(qt("LruGarbageCollector","Garbage collection skipped; disabled"),vt.resolve($v)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(qt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),$v):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,o,s,a,c,u;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(qt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),i=this.params.maximumSequenceNumbersToCollect):i=y,s=Date.now(),this.nthSequenceNumber(e,i))).next(y=>(n=y,a=Date.now(),this.removeTargets(e,n,r))).next(y=>(o=y,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(y=>(u=Date.now(),rc()<=Dr.DEBUG&&qt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-f}ms
	Determined least recently used ${i} in `+(a-s)+`ms
	Removed ${o} targets in `+(c-a)+`ms
	Removed ${y} documents in `+(u-c)+`ms
Total Duration: ${u-f}ms`),vt.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:y})))}}function T3(t,e){return new E3(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N3{constructor(){this.changes=new $l(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,wi.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?vt.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L3{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D3{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&yu(n.mutation,i,Zi.empty(),mn.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Mr()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Mr()){const i=pl();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(o=>{let s=iu();return o.forEach((a,c)=>{s=s.insert(a,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,r){const n=pl();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Mr()))}populateOverlays(e,r,n){const i=[];return n.forEach(o=>{r.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,a)=>{r.set(s,a)})})}computeViews(e,r,n,i){let o=Fs();const s=mu(),a=function(){return mu()}();return r.forEach((c,u)=>{const f=n.get(u.key);i.has(u.key)&&(f===void 0||f.mutation instanceof Va)?o=o.insert(u.key,u):f!==void 0?(s.set(u.key,f.mutation.getFieldMask()),yu(f.mutation,u,f.mutation.getFieldMask(),mn.now())):s.set(u.key,Zi.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((u,f)=>s.set(u,f)),r.forEach((u,f)=>a.set(u,new L3(f,s.get(u)??null))),a))}recalculateAndSaveOverlays(e,r){const n=mu();let i=new _n((s,a)=>s-a),o=Mr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(s=>{for(const a of s)a.keys().forEach(c=>{const u=r.get(c);if(u===null)return;let f=n.get(c)||Zi.empty();f=a.applyToLocalView(u,f),n.set(c,f);const y=(i.get(a.batchId)||Mr()).add(c);i=i.insert(a.batchId,y)})}).next(()=>{const s=[],a=i.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),u=c.key,f=c.value,y=p2();f.forEach(v=>{if(!o.has(v)){const p=_2(r.get(v),n.get(v));p!==null&&y.set(v,p),o=o.add(v)}}),s.push(this.documentOverlayCache.saveOverlays(e,u,y))}return vt.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(s){return Zt.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):c2(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(o=>{const s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-o.size):vt.resolve(pl());let a=Tu,c=o;return s.next(u=>vt.forEach(u,(f,y)=>(a<y.largestBatchId&&(a=y.largestBatchId),o.get(f)?vt.resolve():this.remoteDocumentCache.getEntry(e,f).next(v=>{c=c.insert(f,v)}))).next(()=>this.populateOverlays(e,u,o)).next(()=>this.computeViews(e,c,u,Mr())).next(f=>({batchId:a,changes:f2(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Zt(r)).next(n=>{let i=iu();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const o=r.collectionGroup;let s=iu();return this.indexManager.getCollectionParents(e,o).next(a=>vt.forEach(a,c=>{const u=function(y,v){return new Ec(v,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(r,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,u,n,i).next(f=>{f.forEach((y,v)=>{s=s.insert(y,v)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,r,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,i))).next(s=>{o.forEach((c,u)=>{const f=u.getKey();s.get(f)===null&&(s=s.insert(f,wi.newInvalidDocument(f)))});let a=iu();return s.forEach((c,u)=>{const f=o.get(c);f!==void 0&&yu(f.mutation,u,Zi.empty(),mn.now()),Xh(r,u)&&(a=a.insert(c,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R3{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return vt.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:ts(i.createTime)}}(r)),vt.resolve()}getNamedQuery(e,r){return vt.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(i){return{name:i.name,query:x3(i.bundledQuery),readTime:ts(i.readTime)}}(r)),vt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M3{constructor(){this.overlays=new _n(Zt.comparator),this.qr=new Map}getOverlay(e,r){return vt.resolve(this.overlays.get(r))}getOverlays(e,r){const n=pl();return vt.forEach(r,i=>this.getOverlay(e,i).next(o=>{o!==null&&n.set(i,o)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,o)=>{this.St(e,r,o)}),vt.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.qr.delete(n)),vt.resolve()}getOverlaysForCollection(e,r,n){const i=pl(),o=r.length+1,s=new Zt(r.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){const c=a.getNext().value,u=c.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===o&&c.largestBatchId>n&&i.set(c.getKey(),c)}return vt.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let o=new _n((u,f)=>u-f);const s=this.overlays.getIterator();for(;s.hasNext();){const u=s.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let f=o.get(u.largestBatchId);f===null&&(f=pl(),o=o.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const a=pl(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,f)=>a.set(u,f)),!(a.size()>=i)););return vt.resolve(a)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const s=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(n.key,new e3(r,n));let o=this.qr.get(r);o===void 0&&(o=Mr(),this.qr.set(r,o)),this.qr.set(r,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F3{constructor(){this.sessionToken=di.EMPTY_BYTE_STRING}getSessionToken(e){return vt.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,vt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(){this.Qr=new Wn(Jn.$r),this.Ur=new Wn(Jn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new Jn(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new Jn(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new Zt(new pn([])),n=new Jn(r,e),i=new Jn(r,e+1),o=[];return this.Ur.forEachInRange([n,i],s=>{this.Gr(s),o.push(s.key)}),o}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new Zt(new pn([])),n=new Jn(r,e),i=new Jn(r,e+1);let o=Mr();return this.Ur.forEachInRange([n,i],s=>{o=o.add(s.key)}),o}containsKey(e){const r=new Jn(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Jn{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return Zt.comparator(e.key,r.key)||Rr(e.Yr,r.Yr)}static Kr(e,r){return Rr(e.Yr,r.Yr)||Zt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O3{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new Wn(Jn.$r)}checkEmpty(e){return vt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new ZC(o,r,n,i);this.mutationQueue.push(s);for(const a of i)this.Zr=this.Zr.add(new Jn(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return vt.resolve(s)}lookupMutationBatch(e,r){return vt.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),o=i<0?0:i;return vt.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return vt.resolve(this.mutationQueue.length===0?Qm:this.tr-1)}getAllMutationBatches(e){return vt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Jn(r,0),i=new Jn(r,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,i],s=>{const a=this.Xr(s.Yr);o.push(a)}),vt.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Wn(Rr);return r.forEach(i=>{const o=new Jn(i,0),s=new Jn(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,s],a=>{n=n.add(a.Yr)})}),vt.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let o=n;Zt.isDocumentKey(o)||(o=o.child(""));const s=new Jn(new Zt(o),0);let a=new Wn(Rr);return this.Zr.forEachWhile(c=>{const u=c.key.path;return!!n.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.Yr)),!0)},s),vt.resolve(this.ti(a))}ti(e){const r=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Zr(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return vt.forEach(r.mutations,i=>{const o=new Jn(i.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new Jn(r,0),i=this.Zr.firstAfterOrEqual(n);return vt.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,vt.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B3{constructor(e){this.ri=e,this.docs=function(){return new _n(Zt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),o=i?i.size:0,s=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return vt.resolve(n?n.document.mutableCopy():wi.newInvalidDocument(r))}getEntries(e,r){let n=Fs();return r.forEach(i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():wi.newInvalidDocument(i))}),vt.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let o=Fs();const s=r.path,a=new Zt(s.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:u,value:{document:f}}=c.getNext();if(!s.isPrefixOf(u.path))break;u.path.length>s.length+1||pC(fC(f),n)<=0||(i.has(f.key)||Xh(r,f))&&(o=o.insert(f.key,f.mutableCopy()))}return vt.resolve(o)}getAllFromCollectionGroup(e,r,n,i){cr(9500)}ii(e,r){return vt.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new j3(this)}getSize(e){return vt.resolve(this.size)}}class j3 extends N3{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),vt.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V3{constructor(e){this.persistence=e,this.si=new $l(r=>ey(r),ty),this.lastRemoteSnapshotVersion=gr.min(),this.highestTargetId=0,this.oi=0,this._i=new ay,this.targetCount=0,this.ai=wc.ur()}forEachTarget(e,r){return this.si.forEach((n,i)=>r(i)),vt.resolve()}getLastRemoteSnapshotVersion(e){return vt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return vt.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),vt.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),vt.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new wc(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,vt.resolve()}updateTargetData(e,r){return this.Pr(r),vt.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,vt.resolve()}removeTargets(e,r,n){let i=0;const o=[];return this.si.forEach((s,a)=>{a.sequenceNumber<=r&&n.get(a.targetId)===null&&(this.si.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),vt.waitFor(o).next(()=>i)}getTargetCount(e){return vt.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return vt.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),vt.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,o=[];return i&&r.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),vt.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),vt.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return vt.resolve(n)}containsKey(e,r){return vt.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D2{constructor(e,r){this.ui={},this.overlays={},this.ci=new Yh(0),this.li=!1,this.li=!0,this.hi=new F3,this.referenceDelegate=e(this),this.Pi=new V3(this),this.indexManager=new A3,this.remoteDocumentCache=function(i){return new B3(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new P3(r),this.Ii=new R3(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new M3,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new O3(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){qt("MemoryPersistence","Starting transaction:",e);const i=new z3(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ai(e,r){return vt.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class z3 extends yC{constructor(e){super(),this.currentSequenceNumber=e}}class ly{constructor(e){this.persistence=e,this.Ri=new ay,this.Vi=null}static mi(e){return new ly(e)}get fi(){if(this.Vi)return this.Vi;throw cr(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),vt.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),vt.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),vt.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(o=>this.fi.add(o.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return vt.forEach(this.fi,n=>{const i=Zt.fromPath(n);return this.gi(e,i).next(o=>{o||r.removeEntry(i,gr.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return vt.or([()=>vt.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Nh{constructor(e,r){this.persistence=e,this.pi=new $l(n=>bC(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=T3(this,r)}static mi(e,r){return new Nh(e,r)}Ei(){}di(e){return vt.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return vt.forEach(this.pi,(n,i)=>this.br(e,n,i).next(o=>o?vt.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(e,s=>this.br(e,s,r).next(a=>{a||(n++,o.removeEntry(s,gr.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),vt.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),vt.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),vt.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),vt.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=th(e.data.value)),r}br(e,r,n){return vt.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.pi.get(r);return vt.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cy{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=Mr(),i=Mr();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new cy(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q3{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U3{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return DS()?8:gC(Ci())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const o={result:null};return this.ys(e,r).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.ws(e,r,i,n).next(s=>{o.result=s})}).next(()=>{if(o.result)return;const s=new q3;return this.Ss(e,r,s).next(a=>{if(o.result=a,this.Vs)return this.bs(e,r,s,a.size)})}).next(()=>o.result)}bs(e,r,n,i){return n.documentReadCount<this.fs?(rc()<=Dr.DEBUG&&qt("QueryEngine","SDK will not create cache indexes for query:",nc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),vt.resolve()):(rc()<=Dr.DEBUG&&qt("QueryEngine","Query:",nc(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(rc()<=Dr.DEBUG&&qt("QueryEngine","The SDK decides to create cache indexes for query:",nc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Zo(r))):vt.resolve())}ys(e,r){if(vv(r))return vt.resolve(null);let n=Zo(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Zp(r,null,"F"),n=Zo(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const s=Mr(...o);return this.ps.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,n).next(c=>{const u=this.Ds(r,a);return this.Cs(r,u,s,c.readTime)?this.ys(e,Zp(r,null,"F")):this.vs(e,u,r,c)}))})))}ws(e,r,n,i){return vv(r)||i.isEqual(gr.min())?vt.resolve(null):this.ps.getDocuments(e,n).next(o=>{const s=this.Ds(r,o);return this.Cs(r,s,n,i)?vt.resolve(null):(rc()<=Dr.DEBUG&&qt("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),nc(r)),this.vs(e,s,r,hC(i,Tu)).next(a=>a))})}Ds(e,r){let n=new Wn(d2(e));return r.forEach((i,o)=>{Xh(e,o)&&(n=n.add(o))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(e,r,n){return rc()<=Dr.DEBUG&&qt("QueryEngine","Using full collection scan to execute query:",nc(r)),this.ps.getDocumentsMatchingQuery(e,r,Ea.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(o=>(r.forEach(s=>{o=o.insert(s.key,s)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uy="LocalStore",H3=3e8;class W3{constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new _n(Rr),this.xs=new $l(o=>ey(o),ty),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new D3(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function G3(t,e,r,n){return new W3(t,e,r,n)}async function R2(t,e){const r=wr(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(o=>{const s=[],a=[];let c=Mr();for(const u of i){s.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}for(const u of o){a.push(u.batchId);for(const f of u.mutations)c=c.add(f.key)}return r.localDocuments.getDocuments(n,c).next(u=>({Ls:u,removedBatchIds:s,addedBatchIds:a}))})})}function Y3(t,e){const r=wr(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),o=r.Ns.newChangeBuffer({trackRemovals:!0});return function(a,c,u,f){const y=u.batch,v=y.keys();let p=vt.resolve();return v.forEach(I=>{p=p.next(()=>f.getEntry(c,I)).next(P=>{const w=u.docVersions.get(I);Zr(w!==null,48541),P.version.compareTo(w)<0&&(y.applyToRemoteDocument(P,u),P.isValidDocument()&&(P.setReadTime(u.commitVersion),f.addEntry(P)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(c,y))}(r,n,e,o).next(()=>o.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(a){let c=Mr();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function M2(t){const e=wr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function K3(t,e){const r=wr(t),n=e.snapshotVersion;let i=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const s=r.Ns.newChangeBuffer({trackRemovals:!0});i=r.Ms;const a=[];e.targetChanges.forEach((f,y)=>{const v=i.get(y);if(!v)return;a.push(r.Pi.removeMatchingKeys(o,f.removedDocuments,y).next(()=>r.Pi.addMatchingKeys(o,f.addedDocuments,y)));let p=v.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(y)!==null?p=p.withResumeToken(di.EMPTY_BYTE_STRING,gr.min()).withLastLimboFreeSnapshotVersion(gr.min()):f.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(f.resumeToken,n)),i=i.insert(y,p),function(P,w,x){return P.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=H3?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(v,p,f)&&a.push(r.Pi.updateTargetData(o,p))});let c=Fs(),u=Mr();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&a.push(r.persistence.referenceDelegate.updateLimboDocument(o,f))}),a.push(J3(o,s,e.documentUpdates).next(f=>{c=f.ks,u=f.qs})),!n.isEqual(gr.min())){const f=r.Pi.getLastRemoteSnapshotVersion(o).next(y=>r.Pi.setTargetsMetadata(o,o.currentSequenceNumber,n));a.push(f)}return vt.waitFor(a).next(()=>s.apply(o)).next(()=>r.localDocuments.getLocalViewOfDocuments(o,c,u)).next(()=>c)}).then(o=>(r.Ms=i,o))}function J3(t,e,r){let n=Mr(),i=Mr();return r.forEach(o=>n=n.add(o)),e.getEntries(t,n).next(o=>{let s=Fs();return r.forEach((a,c)=>{const u=o.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(gr.min())?(e.removeEntry(a,c.readTime),s=s.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),s=s.insert(a,c)):qt(uy,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{ks:s,qs:i}})}function Q3(t,e){const r=wr(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Qm),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function X3(t,e){const r=wr(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Pi.getTargetData(n,e).next(o=>o?(i=o,vt.resolve(i)):r.Pi.allocateTargetId(n).next(s=>(i=new _a(e,s,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function im(t,e,r){const n=wr(t),i=n.Ms.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,s=>n.persistence.referenceDelegate.removeTarget(s,i))}catch(s){if(!kc(s))throw s;qt(uy,`Failed to update sequence numbers for target ${e}: ${s}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function Tv(t,e,r){const n=wr(t);let i=gr.min(),o=Mr();return n.persistence.runTransaction("Execute query","readwrite",s=>function(c,u,f){const y=wr(c),v=y.xs.get(f);return v!==void 0?vt.resolve(y.Ms.get(v)):y.Pi.getTargetData(u,f)}(n,s,Zo(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(s,a.targetId).next(c=>{o=c})}).next(()=>n.Fs.getDocumentsMatchingQuery(s,e,r?i:gr.min(),r?o:Mr())).next(a=>(Z3(n,OC(e),a),{documents:a,Qs:o})))}function Z3(t,e,r){let n=t.Os.get(e)||gr.min();r.forEach((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),t.Os.set(e,n)}class Nv{constructor(){this.activeTargetIds=UC()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class e4{constructor(){this.Mo=new Nv,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Nv,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t4{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lv="ConnectivityMonitor";class Dv{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){qt(Lv,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){qt(Lv,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Td=null;function om(){return Td===null?Td=function(){return 268435456+Math.round(2147483648*Math.random())}():Td++,"0x"+Td.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hf="RestConnection",r4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class n4{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===Ch?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,o){const s=om(),a=this.zo(e,r.toUriEncodedString());qt(Hf,`Sending RPC '${e}' ${s}:`,a,n);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,i,o);const{host:u}=new URL(a),f=xc(u);return this.Jo(e,a,c,n,f).then(y=>(qt(Hf,`Received RPC '${e}' ${s}: `,y),y),y=>{throw gc(Hf,`RPC '${e}' ${s} failed with error: `,y,"url: ",a,"request:",n),y})}Ho(e,r,n,i,o,s){return this.Go(e,r,n,i,o)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ic}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>e[o]=i),n&&n.headers.forEach((i,o)=>e[o]=i)}zo(e,r){const n=r4[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i4{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pi="WebChannelConnection";class o4 extends n4{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,o){const s=om();return new Promise((a,c)=>{const u=new Ob;u.setWithCredentials(!0),u.listenOnce(Bb.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case eh.NO_ERROR:const y=u.getResponseJson();qt(pi,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(y)),a(y);break;case eh.TIMEOUT:qt(pi,`RPC '${e}' ${s} timed out`),c(new Bt(ct.DEADLINE_EXCEEDED,"Request time out"));break;case eh.HTTP_ERROR:const v=u.getStatus();if(qt(pi,`RPC '${e}' ${s} failed with status:`,v,"response text:",u.getResponseText()),v>0){let p=u.getResponseJson();Array.isArray(p)&&(p=p[0]);const I=p?.error;if(I&&I.status&&I.message){const P=function(x){const j=x.toLowerCase().replace(/_/g,"-");return Object.values(ct).indexOf(j)>=0?j:ct.UNKNOWN}(I.status);c(new Bt(P,I.message))}else c(new Bt(ct.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new Bt(ct.UNAVAILABLE,"Connection failed."));break;default:cr(9055,{l_:e,streamId:s,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{qt(pi,`RPC '${e}' ${s} completed.`)}});const f=JSON.stringify(i);qt(pi,`RPC '${e}' ${s} sending request:`,i),u.send(r,"POST",f,n,15)})}T_(e,r,n){const i=om(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=zb(),a=Vb(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const f=o.join("");qt(pi,`Creating RPC '${e}' stream ${i}: ${f}`,c);const y=s.createWebChannel(f,c);this.I_(y);let v=!1,p=!1;const I=new i4({Yo:w=>{p?qt(pi,`Not sending because RPC '${e}' stream ${i} is closed:`,w):(v||(qt(pi,`Opening RPC '${e}' stream ${i} transport.`),y.open(),v=!0),qt(pi,`RPC '${e}' stream ${i} sending:`,w),y.send(w))},Zo:()=>y.close()}),P=(w,x,j)=>{w.listen(x,ne=>{try{j(ne)}catch(Q){setTimeout(()=>{throw Q},0)}})};return P(y,nu.EventType.OPEN,()=>{p||(qt(pi,`RPC '${e}' stream ${i} transport opened.`),I.o_())}),P(y,nu.EventType.CLOSE,()=>{p||(p=!0,qt(pi,`RPC '${e}' stream ${i} transport closed`),I.a_(),this.E_(y))}),P(y,nu.EventType.ERROR,w=>{p||(p=!0,gc(pi,`RPC '${e}' stream ${i} transport errored. Name:`,w.name,"Message:",w.message),I.a_(new Bt(ct.UNAVAILABLE,"The operation could not be completed")))}),P(y,nu.EventType.MESSAGE,w=>{if(!p){const x=w.data[0];Zr(!!x,16349);const j=x,ne=j?.error||j[0]?.error;if(ne){qt(pi,`RPC '${e}' stream ${i} received error:`,ne);const Q=ne.status;let K=function(C){const E=On[C];if(E!==void 0)return P2(E)}(Q),Z=ne.message;K===void 0&&(K=ct.INTERNAL,Z="Unknown error status: "+Q+" with message "+ne.message),p=!0,I.a_(new Bt(K,Z)),y.close()}else qt(pi,`RPC '${e}' stream ${i} received:`,x),I.u_(x)}}),P(a,jb.STAT_EVENT,w=>{w.stat===Wp.PROXY?qt(pi,`RPC '${e}' stream ${i} detected buffering proxy`):w.stat===Wp.NOPROXY&&qt(pi,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{I.__()},0),I}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function Wf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rf(t){return new c3(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F2{constructor(e,r,n=1e3,i=1.5,o=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&qt("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rv="PersistentStream";class O2{constructor(e,r,n,i,o,s,a,c){this.Mi=e,this.S_=n,this.b_=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new F2(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===ct.RESOURCE_EXHAUSTED?(Rs(r.toString()),Rs("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===ct.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===r&&this.G_(n,i)},n=>{e(()=>{const i=new Bt(ct.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return qt(Rv,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(qt(Rv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class s4 extends O2{constructor(e,r,n,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,s),this.serializer=o}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=h3(this.serializer,e),n=function(o){if(!("targetChange"in o))return gr.min();const s=o.targetChange;return s.targetIds&&s.targetIds.length?gr.min():s.readTime?ts(s.readTime):gr.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=nm(this.serializer),r.addTarget=function(o,s){let a;const c=s.target;if(a=Qp(c)?{documents:m3(o,c)}:{query:y3(o,c).ft},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=C2(o,s.resumeToken);const u=em(o,s.expectedCount);u!==null&&(a.expectedCount=u)}else if(s.snapshotVersion.compareTo(gr.min())>0){a.readTime=Th(o,s.snapshotVersion.toTimestamp());const u=em(o,s.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const n=v3(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=nm(this.serializer),r.removeTarget=e,this.q_(r)}}class a4 extends O2{constructor(e,r,n,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,s),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Zr(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Zr(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Zr(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=p3(e.writeResults,e.commitTime),n=ts(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=nm(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>f3(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l4{}class c4 extends l4{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Bt(ct.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Go(e,tm(r,n),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ct.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Bt(ct.UNKNOWN,o.toString())})}Ho(e,r,n,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Ho(e,tm(r,n),i,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ct.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Bt(ct.UNKNOWN,s.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class u4{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Rs(r),this.aa=!1):qt("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cl="RemoteStore";class d4{constructor(e,r,n,i,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo(s=>{n.enqueueAndForget(async()=>{kl(this)&&(qt(Cl,"Restarting streams for network reachability change."),await async function(c){const u=wr(c);u.Ea.add(4),await Qu(u),u.Ra.set("Unknown"),u.Ea.delete(4),await nf(u)}(this))})}),this.Ra=new u4(n,i)}}async function nf(t){if(kl(t))for(const e of t.da)await e(!0)}async function Qu(t){for(const e of t.da)await e(!1)}function B2(t,e){const r=wr(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),py(r)?fy(r):Tc(r).O_()&&hy(r,e))}function dy(t,e){const r=wr(t),n=Tc(r);r.Ia.delete(e),n.O_()&&j2(r,e),r.Ia.size===0&&(n.O_()?n.L_():kl(r)&&r.Ra.set("Unknown"))}function hy(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(gr.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Tc(t).Y_(e)}function j2(t,e){t.Va.Ue(e),Tc(t).Z_(e)}function fy(t){t.Va=new o3({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Tc(t).start(),t.Ra.ua()}function py(t){return kl(t)&&!Tc(t).x_()&&t.Ia.size>0}function kl(t){return wr(t).Ea.size===0}function V2(t){t.Va=void 0}async function h4(t){t.Ra.set("Online")}async function f4(t){t.Ia.forEach((e,r)=>{hy(t,e)})}async function p4(t,e){V2(t),py(t)?(t.Ra.ha(e),fy(t)):t.Ra.set("Unknown")}async function m4(t,e,r){if(t.Ra.set("Online"),e instanceof A2&&e.state===2&&e.cause)try{await async function(i,o){const s=o.cause;for(const a of o.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,s),i.Ia.delete(a),i.Va.removeTarget(a))}(t,e)}catch(n){qt(Cl,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Lh(t,n)}else if(e instanceof ih?t.Va.Ze(e):e instanceof x2?t.Va.st(e):t.Va.tt(e),!r.isEqual(gr.min()))try{const n=await M2(t.localStore);r.compareTo(n)>=0&&await function(o,s){const a=o.Va.Tt(s);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const f=o.Ia.get(u);f&&o.Ia.set(u,f.withResumeToken(c.resumeToken,s))}}),a.targetMismatches.forEach((c,u)=>{const f=o.Ia.get(c);if(!f)return;o.Ia.set(c,f.withResumeToken(di.EMPTY_BYTE_STRING,f.snapshotVersion)),j2(o,c);const y=new _a(f.target,c,u,f.sequenceNumber);hy(o,y)}),o.remoteSyncer.applyRemoteEvent(a)}(t,r)}catch(n){qt(Cl,"Failed to raise snapshot:",n),await Lh(t,n)}}async function Lh(t,e,r){if(!kc(e))throw e;t.Ea.add(1),await Qu(t),t.Ra.set("Offline"),r||(r=()=>M2(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{qt(Cl,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await nf(t)})}function z2(t,e){return e().catch(r=>Lh(t,r,e))}async function of(t){const e=wr(t),r=Da(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Qm;for(;y4(e);)try{const i=await Q3(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,g4(e,i)}catch(i){await Lh(e,i)}q2(e)&&U2(e)}function y4(t){return kl(t)&&t.Ta.length<10}function g4(t,e){t.Ta.push(e);const r=Da(t);r.O_()&&r.X_&&r.ea(e.mutations)}function q2(t){return kl(t)&&!Da(t).x_()&&t.Ta.length>0}function U2(t){Da(t).start()}async function v4(t){Da(t).ra()}async function b4(t){const e=Da(t);for(const r of t.Ta)e.ea(r.mutations)}async function _4(t,e,r){const n=t.Ta.shift(),i=iy.from(n,e,r);await z2(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await of(t)}async function w4(t,e){e&&Da(t).X_&&await async function(n,i){if(function(s){return r3(s)&&s!==ct.ABORTED}(i.code)){const o=n.Ta.shift();Da(n).B_(),await z2(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i)),await of(n)}}(t,e),q2(t)&&U2(t)}async function Mv(t,e){const r=wr(t);r.asyncQueue.verifyOperationInProgress(),qt(Cl,"RemoteStore received new credentials");const n=kl(r);r.Ea.add(3),await Qu(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await nf(r)}async function S4(t,e){const r=wr(t);e?(r.Ea.delete(2),await nf(r)):e||(r.Ea.add(2),await Qu(r),r.Ra.set("Unknown"))}function Tc(t){return t.ma||(t.ma=function(r,n,i){const o=wr(r);return o.sa(),new s4(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:h4.bind(null,t),t_:f4.bind(null,t),r_:p4.bind(null,t),H_:m4.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),py(t)?fy(t):t.Ra.set("Unknown")):(await t.ma.stop(),V2(t))})),t.ma}function Da(t){return t.fa||(t.fa=function(r,n,i){const o=wr(r);return o.sa(),new a4(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:v4.bind(null,t),r_:w4.bind(null,t),ta:b4.bind(null,t),na:_4.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await of(t)):(await t.fa.stop(),t.Ta.length>0&&(qt(Cl,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class my{constructor(e,r,n,i,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new Ns,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,o){const s=Date.now()+n,a=new my(e,r,s,i,o);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Bt(ct.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function yy(t,e){if(Rs("AsyncQueue",`${e}: ${t}`),kc(t))return new Bt(ct.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hc{static emptySet(e){return new hc(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||Zt.comparator(r.key,n.key):(r,n)=>Zt.comparator(r.key,n.key),this.keyedMap=iu(),this.sortedSet=new _n(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof hc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new hc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(){this.ga=new _n(Zt.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):cr(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class Sc{constructor(e,r,n,i,o,s,a,c,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,i,o){const s=[];return r.forEach(a=>{s.push({type:0,doc:a})}),new Sc(e,r,hc.emptySet(r),s,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Qh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P4{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class x4{constructor(){this.queries=Ov(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=wr(r),o=i.queries;i.queries=Ov(),o.forEach((s,a)=>{for(const c of a.Sa)c.onError(n)})})(this,new Bt(ct.ABORTED,"Firestore shutting down"))}}function Ov(){return new $l(t=>u2(t),Qh)}async function H2(t,e){const r=wr(t);let n=3;const i=e.query;let o=r.queries.get(i);o?!o.ba()&&e.Da()&&(n=2):(o=new P4,n=e.Da()?0:1);try{switch(n){case 0:o.wa=await r.onListen(i,!0);break;case 1:o.wa=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(s){const a=yy(s,`Initialization of query '${nc(e.query)}' failed`);return void e.onError(a)}r.queries.set(i,o),o.Sa.push(e),e.va(r.onlineState),o.wa&&e.Fa(o.wa)&&gy(r)}async function W2(t,e){const r=wr(t),n=e.query;let i=3;const o=r.queries.get(n);if(o){const s=o.Sa.indexOf(e);s>=0&&(o.Sa.splice(s,1),o.Sa.length===0?i=e.Da()?0:1:!o.ba()&&e.Da()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function A4(t,e){const r=wr(t);let n=!1;for(const i of e){const o=i.query,s=r.queries.get(o);if(s){for(const a of s.Sa)a.Fa(i)&&(n=!0);s.wa=i}}n&&gy(r)}function C4(t,e,r){const n=wr(t),i=n.queries.get(e);if(i)for(const o of i.Sa)o.onError(r);n.queries.delete(e)}function gy(t){t.Ca.forEach(e=>{e.next()})}var sm,Bv;(Bv=sm||(sm={})).Ma="default",Bv.Cache="cache";class G2{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Sc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=Sc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==sm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y2{constructor(e){this.key=e}}class K2{constructor(e){this.key=e}}class I4{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Mr(),this.mutatedKeys=Mr(),this.eu=d2(e),this.tu=new hc(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new Fv,i=r?r.tu:this.tu;let o=r?r.mutatedKeys:this.mutatedKeys,s=i,a=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,y)=>{const v=i.get(f),p=Xh(this.query,y)?y:null,I=!!v&&this.mutatedKeys.has(v.key),P=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let w=!1;v&&p?v.data.isEqual(p.data)?I!==P&&(n.track({type:3,doc:p}),w=!0):this.su(v,p)||(n.track({type:2,doc:p}),w=!0,(c&&this.eu(p,c)>0||u&&this.eu(p,u)<0)&&(a=!0)):!v&&p?(n.track({type:0,doc:p}),w=!0):v&&!p&&(n.track({type:1,doc:v}),w=!0,(c||u)&&(a=!0)),w&&(p?(s=s.add(p),o=P?o.add(f):o.delete(f)):(s=s.delete(f),o=o.delete(f)))}),this.query.limit!==null)for(;s.size>this.query.limit;){const f=this.query.limitType==="F"?s.last():s.first();s=s.delete(f.key),o=o.delete(f.key),n.track({type:1,doc:f})}return{tu:s,iu:n,Cs:a,mutatedKeys:o}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort((f,y)=>function(p,I){const P=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return cr(20277,{Rt:w})}};return P(p)-P(I)}(f.type,y.type)||this.eu(f.doc,y.doc)),this.ou(n),i=i??!1;const a=r&&!i?this._u():[],c=this.Xa.size===0&&this.current&&!i?1:0,u=c!==this.Za;return this.Za=c,s.length!==0||u?{snapshot:new Sc(this.query,e.tu,o,s,e.mutatedKeys,c===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Fv,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Mr(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new K2(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new Y2(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=Mr();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return Sc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const vy="SyncEngine";class $4{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class k4{constructor(e){this.key=e,this.hu=!1}}class E4{constructor(e,r,n,i,o,s){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new $l(a=>u2(a),Qh),this.Iu=new Map,this.Eu=new Set,this.du=new _n(Zt.comparator),this.Au=new Map,this.Ru=new ay,this.Vu={},this.mu=new Map,this.fu=wc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function T4(t,e,r=!0){const n=t5(t);let i;const o=n.Tu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await J2(n,e,r,!0),i}async function N4(t,e){const r=t5(t);await J2(r,e,!0,!1)}async function J2(t,e,r,n){const i=await X3(t.localStore,Zo(e)),o=i.targetId,s=t.sharedClientState.addLocalQueryTarget(o,r);let a;return n&&(a=await L4(t,e,o,s==="current",i.resumeToken)),t.isPrimaryClient&&r&&B2(t.remoteStore,i),a}async function L4(t,e,r,n,i){t.pu=(y,v,p)=>async function(P,w,x,j){let ne=w.view.ru(x);ne.Cs&&(ne=await Tv(P.localStore,w.query,!1).then(({documents:k})=>w.view.ru(k,ne)));const Q=j&&j.targetChanges.get(w.targetId),K=j&&j.targetMismatches.get(w.targetId)!=null,Z=w.view.applyChanges(ne,P.isPrimaryClient,Q,K);return Vv(P,w.targetId,Z.au),Z.snapshot}(t,y,v,p);const o=await Tv(t.localStore,e,!0),s=new I4(e,o.Qs),a=s.ru(o.documents),c=Ju.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),u=s.applyChanges(a,t.isPrimaryClient,c);Vv(t,r,u.au);const f=new $4(e,r,s);return t.Tu.set(e,f),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),u.snapshot}async function D4(t,e,r){const n=wr(t),i=n.Tu.get(e),o=n.Iu.get(i.targetId);if(o.length>1)return n.Iu.set(i.targetId,o.filter(s=>!Qh(s,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await im(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&dy(n.remoteStore,i.targetId),am(n,i.targetId)}).catch($c)):(am(n,i.targetId),await im(n.localStore,i.targetId,!0))}async function R4(t,e){const r=wr(t),n=r.Tu.get(e),i=r.Iu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),dy(r.remoteStore,n.targetId))}async function M4(t,e,r){const n=q4(t);try{const i=await function(s,a){const c=wr(s),u=mn.now(),f=a.reduce((p,I)=>p.add(I.key),Mr());let y,v;return c.persistence.runTransaction("Locally write mutations","readwrite",p=>{let I=Fs(),P=Mr();return c.Ns.getEntries(p,f).next(w=>{I=w,I.forEach((x,j)=>{j.isValidDocument()||(P=P.add(x))})}).next(()=>c.localDocuments.getOverlayedDocuments(p,I)).next(w=>{y=w;const x=[];for(const j of a){const ne=QC(j,y.get(j.key).overlayedDocument);ne!=null&&x.push(new Va(j.key,ne,r2(ne.value.mapValue),es.exists(!0)))}return c.mutationQueue.addMutationBatch(p,u,x,a)}).next(w=>{v=w;const x=w.applyToLocalDocumentSet(y,P);return c.documentOverlayCache.saveOverlays(p,w.batchId,x)})}).then(()=>({batchId:v.batchId,changes:f2(y)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(s,a,c){let u=s.Vu[s.currentUser.toKey()];u||(u=new _n(Rr)),u=u.insert(a,c),s.Vu[s.currentUser.toKey()]=u}(n,i.batchId,r),await Xu(n,i.changes),await of(n.remoteStore)}catch(i){const o=yy(i,"Failed to persist write");r.reject(o)}}async function Q2(t,e){const r=wr(t);try{const n=await K3(r.localStore,e);e.targetChanges.forEach((i,o)=>{const s=r.Au.get(o);s&&(Zr(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.hu=!0:i.modifiedDocuments.size>0?Zr(s.hu,14607):i.removedDocuments.size>0&&(Zr(s.hu,42227),s.hu=!1))}),await Xu(r,n,e)}catch(n){await $c(n)}}function jv(t,e,r){const n=wr(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach((o,s)=>{const a=s.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(s,a){const c=wr(s);c.onlineState=a;let u=!1;c.queries.forEach((f,y)=>{for(const v of y.Sa)v.va(a)&&(u=!0)}),u&&gy(c)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function F4(t,e,r){const n=wr(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Au.get(e),o=i&&i.key;if(o){let s=new _n(Zt.comparator);s=s.insert(o,wi.newNoDocument(o,gr.min()));const a=Mr().add(o),c=new tf(gr.min(),new Map,new _n(Rr),s,a);await Q2(n,c),n.du=n.du.remove(o),n.Au.delete(e),by(n)}else await im(n.localStore,e,!1).then(()=>am(n,e,r)).catch($c)}async function O4(t,e){const r=wr(t),n=e.batch.batchId;try{const i=await Y3(r.localStore,e);Z2(r,n,null),X2(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Xu(r,i)}catch(i){await $c(i)}}async function B4(t,e,r){const n=wr(t);try{const i=await function(s,a){const c=wr(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return c.mutationQueue.lookupMutationBatch(u,a).next(y=>(Zr(y!==null,37113),f=y.keys(),c.mutationQueue.removeMutationBatch(u,y))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,f,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>c.localDocuments.getDocuments(u,f))})}(n.localStore,e);Z2(n,e,r),X2(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Xu(n,i)}catch(i){await $c(i)}}function X2(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function Z2(t,e,r){const n=wr(t);let i=n.Vu[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(r?o.reject(r):o.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function am(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||e5(t,n)})}function e5(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(dy(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),by(t))}function Vv(t,e,r){for(const n of r)n instanceof Y2?(t.Ru.addReference(n.key,e),j4(t,n)):n instanceof K2?(qt(vy,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||e5(t,n.key)):cr(19791,{wu:n})}function j4(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(qt(vy,"New document in limbo: "+r),t.Eu.add(n),by(t))}function by(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new Zt(pn.fromString(e)),n=t.fu.next();t.Au.set(n,new k4(r)),t.du=t.du.insert(r,n),B2(t.remoteStore,new _a(Zo(ry(r.path)),n,"TargetPurposeLimboResolution",Yh.ce))}}async function Xu(t,e,r){const n=wr(t),i=[],o=[],s=[];n.Tu.isEmpty()||(n.Tu.forEach((a,c)=>{s.push(n.pu(c,e,r).then(u=>{if((u||r)&&n.isPrimaryClient){const f=u?!u.fromCache:r?.targetChanges.get(c.targetId)?.current;n.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(u){i.push(u);const f=cy.As(c.targetId,u);o.push(f)}}))}),await Promise.all(s),n.Pu.H_(i),await async function(c,u){const f=wr(c);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>vt.forEach(u,v=>vt.forEach(v.Es,p=>f.persistence.referenceDelegate.addReference(y,v.targetId,p)).next(()=>vt.forEach(v.ds,p=>f.persistence.referenceDelegate.removeReference(y,v.targetId,p)))))}catch(y){if(!kc(y))throw y;qt(uy,"Failed to update sequence numbers: "+y)}for(const y of u){const v=y.targetId;if(!y.fromCache){const p=f.Ms.get(v),I=p.snapshotVersion,P=p.withLastLimboFreeSnapshotVersion(I);f.Ms=f.Ms.insert(v,P)}}}(n.localStore,o))}async function V4(t,e){const r=wr(t);if(!r.currentUser.isEqual(e)){qt(vy,"User change. New user:",e.toKey());const n=await R2(r.localStore,e);r.currentUser=e,function(o,s){o.mu.forEach(a=>{a.forEach(c=>{c.reject(new Bt(ct.CANCELLED,s))})}),o.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Xu(r,n.Ls)}}function z4(t,e){const r=wr(t),n=r.Au.get(e);if(n&&n.hu)return Mr().add(n.key);{let i=Mr();const o=r.Iu.get(e);if(!o)return i;for(const s of o){const a=r.Tu.get(s);i=i.unionWith(a.view.nu)}return i}}function t5(t){const e=wr(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Q2.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=z4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=F4.bind(null,e),e.Pu.H_=A4.bind(null,e.eventManager),e.Pu.yu=C4.bind(null,e.eventManager),e}function q4(t){const e=wr(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=O4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=B4.bind(null,e),e}class Dh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=rf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return G3(this.persistence,new U3,e.initialUser,this.serializer)}Cu(e){return new D2(ly.mi,this.serializer)}Du(e){return new e4}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Dh.provider={build:()=>new Dh};class U4 extends Dh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Zr(this.persistence.referenceDelegate instanceof Nh,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new k3(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?zi.withCacheSize(this.cacheSizeBytes):zi.DEFAULT;return new D2(n=>Nh.mi(n,r),this.serializer)}}class lm{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>jv(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=V4.bind(null,this.syncEngine),await S4(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new x4}()}createDatastore(e){const r=rf(e.databaseInfo.databaseId),n=function(o){return new o4(o)}(e.databaseInfo);return function(o,s,a,c){return new c4(o,s,a,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,o,s,a){return new d4(n,i,o,s,a)}(this.localStore,this.datastore,e.asyncQueue,r=>jv(this.syncEngine,r,0),function(){return Dv.v()?new Dv:new t4}())}createSyncEngine(e,r){return function(i,o,s,a,c,u,f){const y=new E4(i,o,s,a,c,u);return f&&(y.gu=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(r){const n=wr(r);qt(Cl,"RemoteStore shutting down."),n.Ea.add(5),await Qu(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}lm.provider={build:()=>new lm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r5{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Rs("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ra="FirestoreClient";class H4{constructor(e,r,n,i,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=_i.UNAUTHENTICATED,this.clientId=Jm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,async s=>{qt(Ra,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(n,s=>(qt(Ra,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ns;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=yy(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Gf(t,e){t.asyncQueue.verifyOperationInProgress(),qt(Ra,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await R2(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function zv(t,e){t.asyncQueue.verifyOperationInProgress();const r=await W4(t);qt(Ra,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>Mv(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>Mv(e.remoteStore,i)),t._onlineComponents=e}async function W4(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){qt(Ra,"Using user provided OfflineComponentProvider");try{await Gf(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===ct.FAILED_PRECONDITION||i.code===ct.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;gc("Error using user provided cache. Falling back to memory cache: "+r),await Gf(t,new Dh)}}else qt(Ra,"Using default OfflineComponentProvider"),await Gf(t,new U4(void 0));return t._offlineComponents}async function n5(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(qt(Ra,"Using user provided OnlineComponentProvider"),await zv(t,t._uninitializedComponentsProvider._online)):(qt(Ra,"Using default OnlineComponentProvider"),await zv(t,new lm))),t._onlineComponents}function G4(t){return n5(t).then(e=>e.syncEngine)}async function i5(t){const e=await n5(t),r=e.eventManager;return r.onListen=T4.bind(null,e.syncEngine),r.onUnlisten=D4.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=N4.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=R4.bind(null,e.syncEngine),r}function Y4(t,e,r={}){const n=new Ns;return t.asyncQueue.enqueueAndForget(async()=>function(o,s,a,c,u){const f=new r5({next:v=>{f.Nu(),s.enqueueAndForget(()=>W2(o,y));const p=v.docs.has(a);!p&&v.fromCache?u.reject(new Bt(ct.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&v.fromCache&&c&&c.source==="server"?u.reject(new Bt(ct.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(v)},error:v=>u.reject(v)}),y=new G2(ry(a.path),f,{includeMetadataChanges:!0,qa:!0});return H2(o,y)}(await i5(t),t.asyncQueue,e,r,n)),n.promise}function K4(t,e,r={}){const n=new Ns;return t.asyncQueue.enqueueAndForget(async()=>function(o,s,a,c,u){const f=new r5({next:v=>{f.Nu(),s.enqueueAndForget(()=>W2(o,y)),v.fromCache&&c.source==="server"?u.reject(new Bt(ct.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(v)},error:v=>u.reject(v)}),y=new G2(a,f,{includeMetadataChanges:!0,qa:!0});return H2(o,y)}(await i5(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o5(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qv=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s5="firestore.googleapis.com",Uv=!0;class Hv{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Bt(ct.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=s5,this.ssl=Uv}else this.host=e.host,this.ssl=e.ssl??Uv;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=L2;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<I3)throw new Bt(ct.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}dC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=o5(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Bt(ct.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Bt(ct.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Bt(ct.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class sf{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Hv({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Bt(ct.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Bt(ct.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Hv(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new tC;switch(n.type){case"firstParty":return new oC(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Bt(ct.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=qv.get(r);n&&(qt("ComponentProvider","Removing Datastore"),qv.delete(r),n.terminate())}(this),Promise.resolve()}}function J4(t,e,r,n={}){t=Ms(t,sf);const i=xc(e),o=t._getSettings(),s={...o,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${r}`;i&&(K1(`https://${a}`),J1("Firestore",!0)),o.host!==s5&&o.host!==a&&gc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...o,host:a,ssl:i,emulatorOptions:n};if(!Sl(c,s)&&(t._setSettings(c),n.mockUserToken)){let u,f;if(typeof n.mockUserToken=="string")u=n.mockUserToken,f=_i.MOCK_USER;else{u=AS(n.mockUserToken,t._app?.options.projectId);const y=n.mockUserToken.sub||n.mockUserToken.user_id;if(!y)throw new Bt(ct.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new _i(y)}t._authCredentials=new rC(new Ub(u,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class El{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new El(this.firestore,e,this._query)}}class Tn{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new $a(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Tn(this.firestore,e,this._key)}toJSON(){return{type:Tn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(Yu(r,Tn._jsonSchema))return new Tn(e,n||null,new Zt(pn.fromString(r.referencePath)))}}Tn._jsonSchemaVersion="firestore/documentReference/1.0",Tn._jsonSchema={type:jn("string",Tn._jsonSchemaVersion),referencePath:jn("string")};class $a extends El{constructor(e,r,n){super(e,r,ry(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Tn(this.firestore,null,new Zt(e))}withConverter(e){return new $a(this.firestore,e,this._path)}}function Q4(t,e,...r){if(t=ui(t),Hb("collection","path",e),t instanceof sf){const n=pn.fromString(e,...r);return iv(n),new $a(t,null,n)}{if(!(t instanceof Tn||t instanceof $a))throw new Bt(ct.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(pn.fromString(e,...r));return iv(n),new $a(t.firestore,null,n)}}function a5(t,e,...r){if(t=ui(t),arguments.length===1&&(e=Jm.newId()),Hb("doc","path",e),t instanceof sf){const n=pn.fromString(e,...r);return nv(n),new Tn(t,null,new Zt(n))}{if(!(t instanceof Tn||t instanceof $a))throw new Bt(ct.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(pn.fromString(e,...r));return nv(n),new Tn(t.firestore,t instanceof $a?t.converter:null,new Zt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wv="AsyncQueue";class Gv{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new F2(this,"async_queue_retry"),this._c=()=>{const n=Wf();n&&qt(Wv,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Wf();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Wf();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Ns;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!kc(e))throw e;qt(Wv,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Rs("INTERNAL UNHANDLED ERROR: ",Yv(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=my.createAndSchedule(this,e,r,n,o=>this.hc(o));return this.tc.push(i),i}uc(){this.nc&&cr(47125,{Pc:Yv(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function Yv(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Zu extends sf{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new Gv,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Gv(e),this._firestoreClient=void 0,await e}}}function X4(t,e){const r=typeof t=="object"?t:eb(),n=typeof t=="string"?t:Ch,i=Om(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const o=PS("firestore");o&&J4(i,...o)}return i}function _y(t){if(t._terminated)throw new Bt(ct.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Z4(t),t._firestoreClient}function Z4(t){const e=t._freezeSettings(),r=function(i,o,s,a){return new SC(i,o,s,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,o5(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new H4(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(i){const o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(e){this._byteString=e}static fromBase64String(e){try{return new go(di.fromBase64String(e))}catch(r){throw new Bt(ct.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new go(di.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:go._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Yu(e,go._jsonSchema))return go.fromBase64String(e.bytes)}}go._jsonSchemaVersion="firestore/bytes/1.0",go._jsonSchema={type:jn("string",go._jsonSchemaVersion),bytes:jn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Bt(ct.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ai(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Bt(ct.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Bt(ct.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Rr(this._lat,e._lat)||Rr(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:rs._jsonSchemaVersion}}static fromJSON(e){if(Yu(e,rs._jsonSchema))return new rs(e.latitude,e.longitude)}}rs._jsonSchemaVersion="firestore/geoPoint/1.0",rs._jsonSchema={type:jn("string",rs._jsonSchemaVersion),latitude:jn("number"),longitude:jn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ns._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Yu(e,ns._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new ns(e.vectorValues);throw new Bt(ct.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ns._jsonSchemaVersion="firestore/vectorValue/1.0",ns._jsonSchema={type:jn("string",ns._jsonSchemaVersion),vectorValues:jn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI=/^__.*__$/;class tI{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Va(e,this.data,this.fieldMask,r,this.fieldTransforms):new Ku(e,this.data,r,this.fieldTransforms)}}class l5{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Va(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function c5(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw cr(40011,{Ac:t})}}class Sy{constructor(e,r,n,i,o,s){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Sy({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Rh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(c5(this.Ac)&&eI.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class rI{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||rf(e)}Cc(e,r,n,i=!1){return new Sy({Ac:e,methodName:r,Dc:n,path:ai.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Py(t){const e=t._freezeSettings(),r=rf(t._databaseId);return new rI(t._databaseId,!!e.ignoreUndefinedProperties,r)}function nI(t,e,r,n,i,o={}){const s=t.Cc(o.merge||o.mergeFields?2:0,e,r,i);xy("Data must be an object, but it was:",s,n);const a=u5(n,s);let c,u;if(o.merge)c=new Zi(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){const f=[];for(const y of o.mergeFields){const v=cm(e,y,r);if(!s.contains(v))throw new Bt(ct.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);h5(f,v)||f.push(v)}c=new Zi(f),u=s.fieldTransforms.filter(y=>c.covers(y.field))}else c=null,u=s.fieldTransforms;return new tI(new qi(a),c,u)}class lf extends wy{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof lf}}function iI(t,e,r,n){const i=t.Cc(1,e,r);xy("Data must be an object, but it was:",i,n);const o=[],s=qi.empty();ja(n,(c,u)=>{const f=Ay(e,c,r);u=ui(u);const y=i.yc(f);if(u instanceof lf)o.push(f);else{const v=ed(u,y);v!=null&&(o.push(f),s.set(f,v))}});const a=new Zi(o);return new l5(s,a,i.fieldTransforms)}function oI(t,e,r,n,i,o){const s=t.Cc(1,e,r),a=[cm(e,n,r)],c=[i];if(o.length%2!=0)throw new Bt(ct.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let v=0;v<o.length;v+=2)a.push(cm(e,o[v])),c.push(o[v+1]);const u=[],f=qi.empty();for(let v=a.length-1;v>=0;--v)if(!h5(u,a[v])){const p=a[v];let I=c[v];I=ui(I);const P=s.yc(p);if(I instanceof lf)u.push(p);else{const w=ed(I,P);w!=null&&(u.push(p),f.set(p,w))}}const y=new Zi(u);return new l5(f,y,s.fieldTransforms)}function sI(t,e,r,n=!1){return ed(r,t.Cc(n?4:3,e))}function ed(t,e){if(d5(t=ui(t)))return xy("Unsupported field value:",e,t),u5(t,e);if(t instanceof wy)return function(n,i){if(!c5(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const o=[];let s=0;for(const a of n){let c=ed(a,i.wc(s));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),s++}return{arrayValue:{values:o}}}(t,e)}return function(n,i){if((n=ui(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return HC(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=mn.fromDate(n);return{timestampValue:Th(i.serializer,o)}}if(n instanceof mn){const o=new mn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Th(i.serializer,o)}}if(n instanceof rs)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof go)return{bytesValue:C2(i.serializer,n._byteString)};if(n instanceof Tn){const o=i.databaseId,s=n.firestore._databaseId;if(!s.isEqual(o))throw i.Sc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:sy(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof ns)return function(s,a){return{mapValue:{fields:{[e2]:{stringValue:t2},[Ih]:{arrayValue:{values:s.toArray().map(u=>{if(typeof u!="number")throw a.Sc("VectorValues must only contain numeric values.");return ny(a.serializer,u)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${Gh(n)}`)}(t,e)}function u5(t,e){const r={};return Yb(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ja(t,(n,i)=>{const o=ed(i,e.mc(n));o!=null&&(r[n]=o)}),{mapValue:{fields:r}}}function d5(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof mn||t instanceof rs||t instanceof go||t instanceof Tn||t instanceof wy||t instanceof ns)}function xy(t,e,r){if(!d5(r)||!Wb(r)){const n=Gh(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function cm(t,e,r){if((e=ui(e))instanceof af)return e._internalPath;if(typeof e=="string")return Ay(t,e);throw Rh("Field path arguments must be of type string or ",t,!1,void 0,r)}const aI=new RegExp("[~\\*/\\[\\]]");function Ay(t,e,r){if(e.search(aI)>=0)throw Rh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new af(...e.split("."))._internalPath}catch{throw Rh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Rh(t,e,r,n,i){const o=n&&!n.isEmpty(),s=i!==void 0;let a=`Function ${e}() called with invalid data`;r&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${n}`),s&&(c+=` in document ${i}`),c+=")"),new Bt(ct.INVALID_ARGUMENT,a+t+c)}function h5(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f5{constructor(e,r,n,i,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Tn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new lI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Cy("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class lI extends f5{data(){return super.data()}}function Cy(t,e){return typeof e=="string"?Ay(t,e):e instanceof af?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cI(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Bt(ct.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Iy{}class p5 extends Iy{}function uI(t,e,...r){let n=[];e instanceof Iy&&n.push(e),n=n.concat(r),function(o){const s=o.filter(c=>c instanceof ky).length,a=o.filter(c=>c instanceof $y).length;if(s>1||s>0&&a>0)throw new Bt(ct.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class $y extends p5{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new $y(e,r,n)}_apply(e){const r=this._parse(e);return m5(e._query,r),new El(e.firestore,e.converter,Xp(e._query,r))}_parse(e){const r=Py(e.firestore);return function(o,s,a,c,u,f,y){let v;if(u.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new Bt(ct.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){Jv(y,f);const I=[];for(const P of y)I.push(Kv(c,o,P));v={arrayValue:{values:I}}}else v=Kv(c,o,y)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||Jv(y,f),v=sI(a,s,y,f==="in"||f==="not-in");return Bn.create(u,f,v)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}class ky extends Iy{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new ky(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Ro.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,o){let s=i;const a=o.getFlattenedFilters();for(const c of a)m5(s,c),s=Xp(s,c)}(e._query,r),new El(e.firestore,e.converter,Xp(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Ey extends p5{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new Ey(e,r)}_apply(e){const r=function(i,o,s){if(i.startAt!==null)throw new Bt(ct.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Bt(ct.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ru(o,s)}(e._query,this._field,this._direction);return new El(e.firestore,e.converter,function(i,o){const s=i.explicitOrderBy.concat([o]);return new Ec(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}function dI(t,e="asc"){const r=e,n=Cy("orderBy",t);return Ey._create(n,r)}function Kv(t,e,r){if(typeof(r=ui(r))=="string"){if(r==="")throw new Bt(ct.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!c2(e)&&r.indexOf("/")!==-1)throw new Bt(ct.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(pn.fromString(r));if(!Zt.isDocumentKey(n))throw new Bt(ct.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return hv(t,new Zt(n))}if(r instanceof Tn)return hv(t,r._key);throw new Bt(ct.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Gh(r)}.`)}function Jv(t,e){if(!Array.isArray(t)||t.length===0)throw new Bt(ct.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function m5(t,e){const r=function(i,o){for(const s of i)for(const a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Bt(ct.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Bt(ct.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class hI{convertValue(e,r="none"){switch(La(e)){case 0:return null;case 1:return e.booleanValue;case 2:return In(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Na(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw cr(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return ja(e,(i,o)=>{n[i]=this.convertValue(o,r)}),n}convertVectorValue(e){const r=e.fields?.[Ih].arrayValue?.values?.map(n=>In(n.doubleValue));return new ns(r)}convertGeoPoint(e){return new rs(In(e.latitude),In(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Jh(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Nu(e));default:return null}}convertTimestamp(e){const r=Ta(e);return new mn(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=pn.fromString(e);Zr(N2(n),9688,{name:e});const i=new Lu(n.get(1),n.get(3)),o=new Zt(n.popFirst(5));return i.isEqual(r)||Rs(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fI(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class su{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class gl extends f5{constructor(e,r,n,i,o,s){super(e,r,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new oh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Cy("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Bt(ct.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=gl._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}gl._jsonSchemaVersion="firestore/documentSnapshot/1.0",gl._jsonSchema={type:jn("string",gl._jsonSchemaVersion),bundleSource:jn("string","DocumentSnapshot"),bundleName:jn("string"),bundle:jn("string")};class oh extends gl{data(e={}){return super.data(e)}}class fc{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new su(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new oh(this._firestore,this._userDataWriter,n.key,n,new su(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Bt(ct.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>{const c=new oh(i._firestore,i._userDataWriter,a.doc.key,a.doc,new su(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{const c=new oh(i._firestore,i._userDataWriter,a.doc.key,a.doc,new su(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,f=-1;return a.type!==0&&(u=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),f=s.indexOf(a.doc.key)),{type:pI(a.type),doc:c,oldIndex:u,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Bt(ct.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=fc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Jm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function pI(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return cr(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mI(t){t=Ms(t,Tn);const e=Ms(t.firestore,Zu);return Y4(_y(e),t._key).then(r=>vI(e,t,r))}fc._jsonSchemaVersion="firestore/querySnapshot/1.0",fc._jsonSchema={type:jn("string",fc._jsonSchemaVersion),bundleSource:jn("string","QuerySnapshot"),bundleName:jn("string"),bundle:jn("string")};class y5 extends hI{constructor(e){super(),this.firestore=e}convertBytes(e){return new go(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Tn(this.firestore,null,r)}}function yI(t){t=Ms(t,El);const e=Ms(t.firestore,Zu),r=_y(e),n=new y5(e);return cI(t._query),K4(r,t._query).then(i=>new fc(e,n,t,i))}function gI(t,e,r){t=Ms(t,Tn);const n=Ms(t.firestore,Zu),i=fI(t.converter,e);return v5(n,[nI(Py(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,es.none())])}function g5(t,e,r,...n){t=Ms(t,Tn);const i=Ms(t.firestore,Zu),o=Py(i);let s;return s=typeof(e=ui(e))=="string"||e instanceof af?oI(o,"updateDoc",t._key,e,r,n):iI(o,"updateDoc",t._key,e),v5(i,[s.toMutation(t._key,es.exists(!0))])}function v5(t,e){return function(n,i){const o=new Ns;return n.asyncQueue.enqueueAndForget(async()=>M4(await G4(n),i,o)),o.promise}(_y(t),e)}function vI(t,e,r){const n=r.docs.get(e._key),i=new y5(t);return new gl(t,i,e._key,n,new su(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){Ic=i})(Ac),mc(new Pl("firestore",(n,{instanceIdentifier:i,options:o})=>{const s=n.getProvider("app").getImmediate(),a=new Zu(new nC(n.getProvider("auth-internal")),new sC(s,n.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Bt(ct.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Lu(u.options.projectId,f)}(s,i),s);return o={useFetchStreams:r,...o},a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),Aa(Zg,ev,e),Aa(Zg,ev,"esm2020")})();let bI="eyAiYXBpS2V5IjogIkFJemFTeUJBbGN2WlRMMXRsQ05LRExENEJpTWJhR01iTnhCRjQtTSIsICAiYXV0aERvbWFpbiI6ICJocm0tMTEyOC5maXJlYmFzZWFwcC5jb20iLCAgImRhdGFiYXNlVVJMIjogImh0dHBzOi8vaHJtLTExMjguZmlyZWJhc2Vpby5jb20iLCAgInByb2plY3RJZCI6ICJocm0tMTEyOCIsICAic3RvcmFnZUJ1Y2tldCI6ICJocm0tMTEyOC5hcHBzcG90LmNvbSIsICAibWVzc2FnaW5nU2VuZGVySWQiOiAiMTA0OTI1MDU4NTI0NSIsICAiYXBwSWQiOiAiMToxMDQ5MjUwNTg1MjQ1OndlYjowZGFkMDAyMDI3MjM1MTRjY2M1Mjc0In0=";const b5=Z1(JSON.parse(dS(bI))),ul=QA(b5),Mh=new Jo,um=X4(b5);Mh.addScope("profile");Mh.addScope("email");class au extends Error{}au.prototype.name="InvalidTokenError";function _I(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function wI(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return _I(e)}catch{return atob(e)}}function SI(t,e){if(typeof t!="string")throw new au("Invalid token specified: must be a string");e||(e={});const r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new au(`Invalid token specified: missing part #${r+1}`);let i;try{i=wI(n)}catch(o){throw new au(`Invalid token specified: invalid base64 for part #${r+1} (${o.message})`)}try{return JSON.parse(i)}catch(o){throw new au(`Invalid token specified: invalid json for part #${r+1} (${o.message})`)}}const PI={clientId:"195275085181-8ccjpgp8v1g80qhnlk6v4lpgid7n81gr.apps.googleusercontent.com"},xI=t=>{const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>{window.google&&window.google.accounts.id.initialize({client_id:PI.clientId,callback:r=>{t(r.credential)},auto_select:!1,cancel_on_tap_outside:!0})},document.head.appendChild(e)},AI=t=>SI(t),CI=()=>{window.google&&window.google.accounts.id.disableAutoSelect()},[II,$I]=zh({}),kI=async()=>{const e=await Vi({query:"qcm42351987"});if(e&&!e.error){let n=Object.assign({},{},e);$I(n)}return 1},EI=async t=>{let e=II?.[992002];e&&(e.params={tkn:t})},[Kl,bi]=zh({user:null,loading:!0,error:null,authMethod:null}),[_5,Qv]=$e(null);Ox(ul,t=>{t?bi({user:t,loading:!1,error:null,authMethod:"firebase"}):_5()||bi({user:null,loading:!1,error:null,authMethod:null})});fA(ul).then(t=>{t&&bi({user:t.user,loading:!1,error:null,authMethod:"firebase"})}).catch(t=>{console.error("Redirect sign-in error:",t),bi({loading:!1,error:t.message})});const Ar={get state(){return Kl},async getUserProfile(t){try{const e=a5(um,"users",t),r=await mI(e);if(r.exists()){bi("profile",r.data());let n={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1},i=r.data(),o={};return Object.keys(n).map(s=>{let a=n?.[s];i.hasOwnProperty(s)||(o[s]=a)}),Object.keys(o).length>0&&g5(e,o),r.data()}else{let n=Ar?.state?.user,i={uid:n?.uid,email:n?.email,displayName:n?.displayName,createdAt:new Date,stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};return await gI(e,i),console.log("No such user profile!"),null}}catch(e){return console.error("Error fetching user profile:",e),null}},hasPermission:t=>{const e=Ar.state?.profile;return e?.isAdmin?!0:e?e?.[t]===!0:!1},async signInWithGoogle(){try{bi("loading",!0),bi("error",null);try{const t=await oA(ul,Mh);bi({user:t.user,loading:!1,error:null,authMethod:"firebase"});try{Ar.getUserProfile(t.user.uid)}catch(e){console.error("firestore error:",e)}}catch(t){if(t.code==="auth/popup-blocked")await dA(ul,Mh);else throw t}}catch(t){console.error("Sign-in error:",t),bi({loading:!1,error:t.message||"Failed to sign in with Google"})}},async signInWithGoogleP(t){const r=await Vi({params:{id_token:t},query:"getGoogleUserbyToken"});if(r&&r){let n=new Date().getTime(),i=new Date(n+6e4*60*24*365),o="hrm_tkn_acc";document.cookie=`${o}=${r.data}; expires=${i}; path=/;g_state = {"i_l":1,"i_p":${i}}; ssgl_access_tkn = ${t}`,document.cookie=`ssgl_access_tkn = ${t}; expires=${i};`,await kI(),EI(r.data)}},async signInWithGoogleCloud(t){try{bi("loading",!0),bi("error",null);const e=AI(t),r={uid:e.sub,email:e.email,displayName:e.name,photoURL:e.picture};Qv(r);const n={uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,emailVerified:!0};bi({user:n,loading:!1,error:null,authMethod:"google-cloud"});try{const i=Jo.credential(t);await Rx(ul,i)}catch{console.log("Firebase sign-in optional, continuing with Google Cloud auth")}}catch(e){console.error("Google Cloud sign-in error:",e),bi({loading:!1,error:e.message||"Failed to sign in with Google Cloud"})}},async signOut(){try{bi("loading",!0),(Kl.authMethod==="firebase"||ul.currentUser)&&await Bx(ul),Kl.authMethod==="google-cloud"&&(CI(),Qv(null)),bi({user:null,loading:!1,error:null,authMethod:null})}catch(t){console.error("Sign-out error:",t),bi({loading:!1,error:t.message||"Failed to sign out"})}},get isAuthenticated(){return!!Kl.user||!!_5()},get currentUser(){return Kl.user},get authMethod(){return Kl.authMethod}};var TI=ue("<p>"),NI=ue('<div><div><div><h1>HRM Finance</h1><p>Complete Business Management Solution</p><div><div><button><svg width=24 height=24 viewBox="0 0 24 24"><path fill=#4285F4 d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path><path fill=#34A853 d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path><path fill=#FBBC05 d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path><path fill=#EA4335 d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path></svg></button><p>Firebase Authentication</p></div></div></div><div><div><div></div><h3>Financial Management</h3><p>Complete chart of accounts, balance sheets, journal entries, and invoice management in one place.</p></div><div><div></div><h3>HR Management</h3><p>Track employees, manage onboarding, and monitor your workforce with powerful analytics.</p></div><div><div></div><h3>Inventory Control</h3><p>Real-time inventory tracking, product management, and movement history across multiple locations.</p></div><div><div></div><h3>Banking Integration</h3><p>Streamline bank reconciliation with CSV imports and automated consolidation features.</p></div><div><div></div><h3>Real-time Analytics</h3><p>Get instant insights with dashboards showing revenue, cash flow, and business performance.</p></div><div><div></div><h3>Multi-language Support</h3><p>Available in multiple languages to support your global business operations.</p></div></div><div><p>Secure authentication powered by Google  Your data is encrypted and protected</p><p>Choose your preferred authentication method above');const LI=()=>{Nn(()=>{xI(w=>{Ar.signInWithGoogleP(w)}),setTimeout(()=>{},100)});const t={"min-height":"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},e={background:"white","border-radius":"1rem","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","max-width":"1200px",width:"100%",overflow:"hidden"},r={padding:"3rem","text-align":"center","border-bottom":"1px solid #e2e8f0"},n={"font-size":"2.5rem","font-weight":"800",color:"#1a202c","margin-bottom":"1rem"},i={"font-size":"1.125rem",color:"#718096","margin-bottom":"2rem"},o={display:"flex","flex-direction":"column",gap:"1rem","align-items":"center","margin-bottom":"1rem"},s={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"2rem",padding:"3rem"},a={"text-align":"center",padding:"2rem","border-radius":"0.5rem",background:"#f7fafc",transition:"transform 0.2s",cursor:"default"},c={"font-size":"3rem","margin-bottom":"1rem"},u={"font-size":"1.25rem","font-weight":"600",color:"#2d3748","margin-bottom":"0.5rem"},f={color:"#718096","line-height":"1.6"},y={display:"inline-flex","align-items":"center",gap:"0.75rem",background:"white",color:"#4285f4",border:"2px solid #4285f4",padding:"0.75rem 2rem","font-size":"1.125rem","font-weight":"500","border-radius":"0.5rem",cursor:"pointer",transition:"all 0.2s","min-width":"250px","justify-content":"center"},v={color:"#e53e3e","margin-top":"1rem","font-size":"0.875rem"},p={background:"#f7fafc",padding:"2rem","text-align":"center",color:"#718096","font-size":"0.875rem"},I={"font-size":"0.75rem",color:"#718096","margin-top":"0.25rem","font-style":"italic"},P=()=>{Ar.signInWithGoogle()};return(()=>{var w=NI(),x=w.firstChild,j=x.firstChild,ne=j.firstChild,Q=ne.nextSibling,K=Q.nextSibling,Z=K.firstChild,k=Z.firstChild;k.firstChild;var C=k.nextSibling,E=j.nextSibling,M=E.firstChild,_=M.firstChild,S=_.nextSibling,b=S.nextSibling,Y=M.nextSibling,te=Y.firstChild,O=te.nextSibling,D=O.nextSibling,X=Y.nextSibling,H=X.firstChild,F=H.nextSibling,ie=F.nextSibling,$=X.nextSibling,L=$.firstChild,U=L.nextSibling,N=U.nextSibling,z=$.nextSibling,oe=z.firstChild,G=oe.nextSibling,ee=G.nextSibling,J=z.nextSibling,W=J.firstChild,q=W.nextSibling,ae=q.nextSibling,de=E.nextSibling,le=de.firstChild,V=le.nextSibling;return m(w,t),m(x,e),m(j,r),m(ne,n),m(Q,i),m(K,o),k.addEventListener("mouseleave",ce=>{ce.currentTarget.style.background="white",ce.currentTarget.style.color="#4285f4"}),k.addEventListener("mouseenter",ce=>{ce.currentTarget.style.background="#4285f4",ce.currentTarget.style.color="white"}),k.$$click=P,m(k,y),l(k,B(Ge,{get when(){return Ar.state.loading},fallback:"Sign in with Google",children:"Signing in..."}),null),m(C,I),l(j,B(Ge,{get when(){return Ar.state.error},get children(){var ce=TI();return m(ce,v),l(ce,()=>Ar.state.error),ce}}),null),m(E,s),m(de,p),V.style.setProperty("margin-top","0.5rem"),V.style.setProperty("font-size","0.75rem"),Se(ce=>{var Pe=Ar.state.loading,fe=a,be=c,xe=u,he=f,ve=a,De=c,Ee=u,Ce=f,Ne=a,Ie=c,Re=u,We=f,Fe=a,Xe=c,tt=u,At=f,rt=a,He=c,xt=u,_t=f,mt=a,Et=c,et=u,qe=f;return Pe!==ce.e&&(k.disabled=ce.e=Pe),ce.t=m(M,fe,ce.t),ce.a=m(_,be,ce.a),ce.o=m(S,xe,ce.o),ce.i=m(b,he,ce.i),ce.n=m(Y,ve,ce.n),ce.s=m(te,De,ce.s),ce.h=m(O,Ee,ce.h),ce.r=m(D,Ce,ce.r),ce.d=m(X,Ne,ce.d),ce.l=m(H,Ie,ce.l),ce.u=m(F,Re,ce.u),ce.c=m(ie,We,ce.c),ce.w=m($,Fe,ce.w),ce.m=m(L,Xe,ce.m),ce.f=m(U,tt,ce.f),ce.y=m(N,At,ce.y),ce.g=m(z,rt,ce.g),ce.p=m(oe,He,ce.p),ce.b=m(G,xt,ce.b),ce.T=m(ee,_t,ce.T),ce.A=m(J,mt,ce.A),ce.O=m(W,Et,ce.O),ce.I=m(q,et,ce.I),ce.S=m(ae,qe,ce.S),ce},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0}),w})()};ur(["click"]);var DI=ue("<div><div>");const RI=t=>{const e={"min-height":"100vh",display:"flex","align-items":"center","justify-content":"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},r={width:"50px",height:"50px",border:"3px solid rgba(255, 255, 255, 0.3)","border-top-color":"white","border-radius":"50%",animation:"spin 1s linear infinite"},n=document.createElement("style");return n.textContent=`
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  `,document.head.appendChild(n),vo(async()=>{Ar.state?.user?.uid&&Ar.getUserProfile(Ar.state?.user?.uid)}),Nn(()=>{}),B(Ge,{get when(){return!Ar.state.loading},get fallback(){return(()=>{var i=DI(),o=i.firstChild;return m(i,e),m(o,r),i})()},get children(){return B(Ge,{get when(){return Ar.isAuthenticated},get fallback(){return B(LI,{})},get children(){return t.children}})}})};var MI=ue("<button>");const Pt=t=>{const e=()=>{const r={"font-family":"inherit",cursor:t.disabled?"not-allowed":"pointer",border:"none","border-radius":"var(--border-radius-sm)","font-weight":"500",transition:"all 0.2s ease","text-decoration":"none",display:"inline-flex","align-items":"center","justify-content":"center",gap:"0.5rem",opacity:t.disabled?"0.6":"1"},n={sm:{padding:"0.5rem 1rem","font-size":"0.875rem"},md:{padding:"0.75rem 1.5rem","font-size":"1rem"},lg:{padding:"1rem 2rem","font-size":"1.125rem"}},i={primary:{background:"linear-gradient(135deg, var(--primary-color), var(--primary-dark))",color:"white","box-shadow":"var(--shadow-sm)"},secondary:{background:"var(--surface-color)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},outline:{background:"transparent",color:"var(--primary-color)",border:"1px solid var(--primary-color)"}};return{...r,...n[t.size||"md"],...i[t.variant||"primary"]}};return(()=>{var r=MI();return as(r,"click",t.onClick,!0),l(r,()=>t.children),Se(n=>{var i=e(),o=t.disabled,s=t.type||"button",a=`btn btn-${t.variant||"primary"} ${t.className||""}`;return n.e=m(r,i,n.e),o!==n.t&&(r.disabled=n.t=o),s!==n.a&&Yt(r,"type",n.a=s),a!==n.o&&Em(r,n.o=a),n},{e:void 0,t:void 0,a:void 0,o:void 0}),r})()};ur(["click"]);var FI=ue("<div><div><div><h2></h2><button></button></div><div>");const Qn=t=>{const e={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},r={background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","max-width":"920px",width:"90%","max-height":"80vh",overflow:"auto",position:"relative"},n={padding:"1.5rem","border-bottom":"1px solid var(--border-color)",display:"flex","justify-content":"space-between","align-items":"center"},i={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},o={background:"none",border:"none","font-size":"1.5rem",cursor:"pointer",color:"var(--text-muted)",padding:"0.5rem","border-radius":"var(--border-radius-sm)"},s={padding:"1.5rem"},a=c=>{c.target===c.currentTarget&&t.onClose()};return B(Ge,{get when(){return t.isOpen},get children(){var c=FI(),u=c.firstChild,f=u.firstChild,y=f.firstChild,v=y.nextSibling,p=f.nextSibling;return c.$$click=a,m(f,n),m(y,i),l(y,()=>t.title),v.addEventListener("mouseleave",I=>I.target.style.background="none"),v.addEventListener("mouseenter",I=>I.target.style.background="var(--background-color)"),as(v,"click",t.onClose,!0),m(v,o),m(p,s),l(p,()=>t.children),Se(I=>{var P=e,w=r;return I.e=m(c,P,I.e),I.t=m(u,w,I.t),I},{e:void 0,t:void 0}),c}})};ur(["click"]);var Xv=ue("<div>"),OI=ue("<h3>"),BI=ue("<p>");const Tt=t=>{const e={background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"1.5rem","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",transition:"all 0.2s ease",cursor:t.onClick?"pointer":"default",margin:"9px"},r={"margin-bottom":"1rem"},n={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0 0 0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)",margin:"0"};return(()=>{var o=Xv();return as(o,"click",t.onClick,!0),l(o,(()=>{var s=Te(()=>!!(t.title||t.subtitle));return()=>s()&&(()=>{var a=Xv();return m(a,r),l(a,(()=>{var c=Te(()=>!!t.title);return()=>c()&&(()=>{var u=OI();return m(u,n),l(u,()=>t.title),u})()})(),null),l(a,(()=>{var c=Te(()=>!!t.subtitle);return()=>c()&&(()=>{var u=BI();return m(u,i),l(u,()=>t.subtitle),u})()})(),null),a})()})(),null),l(o,()=>t.children,null),Se(s=>{var a=e,c=`card ${t.className||""}`;return s.e=m(o,a,s.e),c!==s.t&&Em(o,s.t=c),s},{e:void 0,t:void 0}),o})()};ur(["click"]);var jI=ue("<div><label></label><input>"),VI=ue("<span>*");const Or=t=>{const e={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},r={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},n={"margin-bottom":"1rem"};return(()=>{var i=jI(),o=i.firstChild,s=o.nextSibling;return m(i,n),m(o,e),l(o,()=>t.label,null),l(o,(()=>{var a=Te(()=>!!t.required);return()=>a()&&(()=>{var c=VI();return c.style.setProperty("color","var(--primary-color)"),c})()})(),null),s.addEventListener("blur",a=>a.target.style.borderColor="var(--border-color)"),s.addEventListener("focus",a=>a.target.style.borderColor="var(--primary-color)"),s.$$input=a=>t.onChange(a.target.value),m(s,r),Se(a=>{var c=t.type||"text",u=t.placeholder,f=t.required,y=t.disabled;return c!==a.e&&Yt(s,"type",a.e=c),u!==a.t&&Yt(s,"placeholder",a.t=u),f!==a.a&&(s.required=a.a=f),y!==a.o&&(s.disabled=a.o=y),a},{e:void 0,t:void 0,a:void 0,o:void 0}),Se(()=>s.value=t.value),i})()};ur(["input"]);const zI={en:{common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",close:"Close",search:"Search",filter:"Filter",reset:"Reset",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",actions:"Actions",status:"Status",active:"Active",inactive:"Inactive",date:"Date",time:"Time",description:"Description",notes:"Notes",amount:"Amount",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Language",english:"English",spanish:"Spanish",noDataFound:"No data found",required:"Required",optional:"Optional",all:"All",none:"None",select:"Select",clear:"Clear",searching:"Searching...",refresh:"Refresh",showAll:"Show All",products:"products",filtered:"Filtered",view:"View",suggested:"Suggested",clearFilters:"Clear Filters",enhanced:"Enhanced",legacy:"Legacy",email:"Email",phone:"Phone",address:"Address",name:"Name",code:"Code",category:"Category",type:"Type",quantity:"Quantity",price:"Price",cost:"Cost",value:"Value",balance:"Balance",created:"Created",modified:"Modified",details:"Details",summary:"Summary",history:"History",new:"New",addNew:"Add New",unknown:"Unknown",notAvailable:"N/A",remove:"Remove",startDate:"Start Date",endDate:"End Date",from:"From",invoice:"Invoice",invoices:"invoices",reference:"Reference",createdBy:"Created By",units:"units",invoiceDocumentId:"Invoice/Document ID",referenceNumber:"Reference Number",referenceNumberPlaceholder:"Enter reference number...",generalNotes:"General Notes",auto:"Auto",optionalNotes:"Optional notes...",showPerPage:"Show per page",first:"First",last:"Last",store:"Store",orderId:"Order ID",tax:"Tax",paymentMethods:"Payment Methods",cash:"Cash",creditCard:"Credit Card",shipping:"Shipping",air:"Air",sea:"Sea",thankYouBusiness:"Thank you for your business!",thankForChoosingUs:"Thank you for choosing us!",taxExemptNote:"Tax exempted on cash payment.",youSaved:"You saved",generatedOn:"Generated on",printSavePDF:"Print / Save as PDF",pageOfPages:"Page {{current}} of {{total}}",showingXofY:"Showing {{start}}-{{end}} of {{total}}",page:"Page",of:"of",print:"Print",export:"Export",pending:"Pending",completed:"Completed",customer:"Customer",location:"Location",reservations:"Reservations",backToDashboard:"Back to Dashboard",lbs:"pounds"},navigation:{dashboard:"Dashboard",accounts:"Chart of Accounts",balanceSheet:"Balance Sheet",inventory:"Inventory",employees:"Employees",entryBooks:"Entry Books",consolidate:"Bank Consolidation",reports:"Reports",settings:"Settings"},dashboard:{title:"Dashboard",welcome:"Welcome to HRM Finance",totalRevenue:"Total Revenue",overview:"Overview",recentActivity:"Recent Activity",quickActions:"Quick Actions",employeeCount:"Employee Count",pendingInvoices:"Pending Invoices",cashBalance:"Cash Balance",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalExpenses:"Total Expenses",netIncome:"Net Income",netLoss:"Net Loss",monthlyPayroll:"Monthly Payroll",current:"Current",newHires:"+3 new hires",outstanding:"Outstanding",totalOutstanding:"$23,450 total",lastUpdatedToday:"Last updated today",commonTasks:"Common tasks",generateReport:"Generate Report",latestUpdates:"Latest updates",invoicePaid:"Invoice #1234 paid",hoursAgo:"2 hours ago",newEmployeeOnboarded:"New employee onboarded",dayAgo:"1 day ago",monthlyReportGenerated:"Monthly report generated",daysAgo:"2 days ago"},accounts:{title:"Chart of Accounts",accountNumber:"Account Number",accountName:"Account Name",accountType:"Account Type",category:"Category",balance:"Balance",parentAccount:"Parent Account",subAccounts:"Sub-accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",transactions:"Transactions",accountHistory:"Account History",backToAccounts:"Back to Accounts",accountNotFound:"Account not found",accountInformation:"Account Information",accountPurpose:"Account purpose",transactionHistory:"Transaction History",noTransactions:"No transactions found for this account",createdDate:"Created Date",lastModified:"Last Modified",noDescription:"No description provided.",totalCount:"Total count",basicDetails:"Basic details",currentBalance:"Current balance",classification:"Classification",allTransactions:"All account transactions",reference:"Reference",allAccounts:"All Accounts",types:{asset:"Asset",liability:"Liability",equity:"Equity",revenue:"Revenue",expense:"Expense"},categories:{currentAssets:"Current Assets",fixedAssets:"Fixed Assets",currentLiabilities:"Current Liabilities",longTermLiabilities:"Long-term Liabilities",ownersEquity:"Owner's Equity",operatingRevenue:"Operating Revenue",operatingExpenses:"Operating Expenses"}},inventory:{title:"Inventory Management",overview:"Overview",products:"Products & Stock",movements:"Movements",locations:"Locations",bulkMovement:"Bulk Movement",addMovement:"Add Movement",addProduct:"Add Product",addLocation:"Add Location",singleMovement:"Add Single Movement",addNewItem:"Add New Item",activeProducts:"Active Products",lowStockAlert:"Low Stock Items",totalValue:"Total Stock Value",activeLocations:"Active Locations",productsNeedRestocking:"products need restocking",recentMovements:"Recent Movements",noProducts:"No products at this location",productName:"Product Name",productCode:"Product Code",sku:"SKU",unitOfMeasure:"Unit of Measure",unitCost:"Unit Cost",minStockLevel:"Min Stock Level",maxStockLevel:"Max Stock Level",locationName:"Location Name",locationType:"Location Type",locationCode:"Location Code",movementType:"Movement Type",referenceNumber:"Reference Number",invoiceNumber:"Invoice Number",fromLocation:"From Location",toLocation:"To Location",stockIn:"Stock In",stockOut:"Stock Out",transfer:"Transfer",adjustment:"Adjustment",inStock:"In Stock",lowStock:"Low Stock",outOfStock:"Out of Stock",stockLevels:"Stock Levels",stockByLocation:"Stock by Location",searchProducts:"Search products by name, SKU, or category...",searchProductsStock:"Search products and check stock levels...",searchResult:"Search Result",searchResults:"Search Results",searchFallback:"Showing local results",tryDifferentTerm:"Try a different search term or check spelling.",showingTopResults:"Showing top {{count}} results",searchLocations:"Search locations...",noMovements:"No movements found",productDetails:"Product Details",locationDetails:"Location Details",movementDetails:"Movement Details",totalProducts:"Total Products",totalLocations:"Total Locations",lastSeen:"Last seen",warehouseType:"Warehouse",storeType:"Store",supplierType:"Supplier",customerType:"Customer",currentlyManaged:"Currently managed",needAttention:"Need attention",currentWorth:"Current worth",warehousesStores:"Warehouses & stores",thisMonth:"This Month",latestActivities:"Latest inventory activities",searchMovements:"Search Movements",countingSheet:"Counting Sheet",physicalCount:"Physical Count",physicalInventoryCount:"Physical Inventory Count",setupPhysicalCount:"Setup Physical Inventory Count",setupDescription:"Configure your physical inventory count settings and begin the counting process.",countWillInclude:"This count will include {{count}} products from {{location}} in {{category}} category.",startCounting:"Start Physical Count",counted:"Counted",remaining:"Remaining",variances:"Variances",complete:"Complete",systemQty:"System Qty",variance:"Variance",addNotes:"Add notes...",reviewAndConfirm:"Review and Confirm Adjustments",reviewDescription:"Review the inventory adjustments below and confirm to update your system.",stockIncreases:"Stock Increases",stockDecreases:"Stock Decreases",totalAdjustments:"Total Adjustments",confirmAdjustments:"Confirm Adjustments",perfectCount:"Perfect Count!",noVariances:"No variances found. Your physical count matches the system exactly.",physicalCountAdjustment:"Physical count adjustment",inventoryCountingSheetTitle:"INVENTORY COUNTING SHEET",location:"Location",allCategories:"All Categories",countedBy:"Counted by",verifiedBy:"Verified by",instructions:"Instructions",countInstructions:["Count all items physically present at this location",'Write the actual count in the "Physical Count" column',"Leave blank if item is not found",'Note any discrepancies in the "Notes" column',"Sign and date when complete"],productName:"Product Name",unit:"Unit",totalProductsListed:"Total Products Listed",itemsCounted:"Items Counted",summaryFor:"SUMMARY FOR",discrepanciesFound:"Discrepancies Found",counterSignature:"Counter Signature",supervisorSignature:"Supervisor Signature",downloadCSV:"Download CSV",noAdjustmentsToDownload:"No adjustments to download",stockIncrease:"Stock Increase",stockDecrease:"Stock Decrease",purchaseReceive:"Purchase/Receive",saleIssue:"Sale/Issue",transfer:"Transfer",adjustment:"Adjustment",movementType:"Movement Type",fromLocation:"From Location",toLocation:"To Location",searchSourceLocation:"Search source location...",searchDestinationLocation:"Search destination location...",searchLocation:"Search location...",addProduct:"Add Product",searchProduct:"Search product...",unitCost:"Unit Cost",noProductsAdded:'No products added yet. Click "Add Product" to get started.',createMovement:"Create Movement",generalNotesPlaceholder:"Enter general notes for this movement...",sortBy:"Sort By",allLocations:"All Locations",searchByProduct:"Search by product, location, reference, notes, invoice...",allProducts:"All Products",bulkMovementReport:"Bulk Movement Report",movementDetails:"Movement Details",referenceNumber:"Reference Number",invoiceId:"Invoice ID",totalItems:"Total Items",totalQuantity:"Total Quantity",estimatedValue:"Estimated Value",viewHistoricalReports:"View Historical Reports",noBulkReportsFound:"No bulk movement reports found",bulkReportsAppearHere:"Bulk movement reports will appear here after you create bulk movements",allTypes:"All Types",startDate:"Start Date",endDate:"End Date",totalMovements:"Total Movements",totalItems:"Total Items",adjustMovements:"Try adjusting your filters or check back later.",inventoryMovements:"Inventory Movements",createdBy:"Created By",view:"View",enhanced:"Enhanced",legacy:"Legacy",addSingleMovement:"Add Single Movement",inStockSubtitle:"In stock",itemsBelowThreshold:"Items below threshold",inventoryWorth:"Inventory worth",quantity:"Quantity",units:"units",normal:"Normal",productsAndStock:"Products & Stock",lowStockItems:"Low Stock Items",totalStockValue:"Total Stock Value",warehousesAndStores:"Warehouses & stores",andMore:"...and {count} more",latestInventoryActivities:"Latest inventory activities",min:"Min",max:"Max",cost:"Cost",noProductsFound:"No products found matching your search.",noProductsAvailable:"No products available.",noLocationsFound:"No locations found matching your search.",noLocationsAvailable:"No locations available.",searchPlaceholder:"Search by product, location, reference, notes, invoice...",noMovementsFound:"No movements found",tryAdjustingFilters:"Try adjusting your filters or check back later.",transfers:"Transfers",adjustments:"Adjustments",bulk:"Bulk",product:"Product",location:"Location",store:"Store",supplier:"Supplier",warehouse:"Warehouse",movement:"Movement",editMovement:"Edit Movement",updateMovement:"Update Movement",movementInformation:"Movement Information",locationInformation:"Location Information",searchProductsImages:"Search products to view images...",searchForProducts:"Search for Products",startTypingToSearch:"Start typing to search and view product images",tryDifferentSearch:"Try a different search term"},employees:{title:"Employee Management",employeeList:"Employee List",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",payrollInfo:"Payroll Information",firstName:"First Name",lastName:"Last Name",fullName:"Full Name",email:"Email",phone:"Phone",address:"Address",dateOfBirth:"Date of Birth",employeeId:"Employee ID",department:"Department",position:"Position",hireDate:"Hire Date",employmentStatus:"Employment Status",salary:"Salary",payFrequency:"Pay Frequency",taxId:"Tax ID",bankAccount:"Bank Account",emergencyContact:"Emergency Contact",activeEmployees:"Active Employees",inactiveEmployees:"Inactive Employees",totalPayroll:"Total Payroll",searchEmployees:"Search employees...",enterFullName:"Enter employee's full name",enterPosition:"Enter job position",enterEmail:"Enter email address",enterPhone:"Enter phone number",enterSalary:"Enter annual salary",departments:{engineering:"Engineering",product:"Product",design:"Design",marketing:"Marketing",sales:"Sales",humanResources:"Human Resources",finance:"Finance",operations:"Operations",analytics:"Analytics"}},entryBooks:{title:"Entry Books",bookName:"Book Name",bookType:"Book Type",createBook:"Create Book",editBook:"Edit Book",salesBook:"Sales Book",purchaseBook:"Purchase Book",cashBook:"Cash Book",generalBook:"General Book",entries:"Entries",addEntry:"Add Entry",period:"Period",startDate:"Start Date",endDate:"End Date",bookBalance:"Book Balance",reconciledBalance:"Reconciled Balance",difference:"Difference",reconcile:"Reconcile",isReconciled:"Is Reconciled",noBooks:"No entry books found",createFirst:"Create your first entry book to get started",bookDetails:"Book Details",entriesCount:"entries",bookOverview:"Book overview and details",bookEntries:"Book Entries",allEntries:"All entries in this book",noEntries:"No entries found",addFirst:"Add your first entry to this book",entryDate:"Entry Date",entryDescription:"Entry Description",entryAmount:"Entry Amount",entryReference:"Entry Reference",subtitle:"Manage accounting entries and general ledger records",viewReconciliation:"View Reconciliation",totalEntries:"Total Entries",allJournalEntries:"All journal entries",postedEntriesOnly:"Posted entries only",fromPostedEntries:"From {count} posted entries",needBankReconciliation:"Need bank reconciliation",allReconciled:"All reconciled",sortBy:"Sort By",fromDate:"From Date",toDate:"To Date",order:"Order",newest:"Newest",oldest:"Oldest",resetFilters:"Reset Filters",activeFilters:"Active filters",from:"From",to:"To",entriesFound:"{count} entries found",noJournalEntries:"No Journal Entries",startByCreating:"Start by creating your first entry",noEntriesMatch:"No journal entries match your current filters.",createFirstEntry:"Create First Entry",void:"Void",confirmVoid:"Are you sure you want to void this journal entry?",entryBookRecords:"Entry Book Records"},banking:{title:"Bank Consolidation",bankAccount:"Bank Account",statementDate:"Statement Date",beginningBalance:"Beginning Balance",endingBalance:"Ending Balance",deposits:"Deposits",withdrawals:"Withdrawals",bankCharges:"Bank Charges",interest:"Interest",reconcile:"Reconcile",matched:"Matched",unmatched:"Unmatched",importStatement:"Import Statement",manualEntry:"Manual Entry",autoMatch:"Auto Match",clearAll:"Clear All",reconciliationStatus:"Reconciliation Status",difference:"Difference",bookBalance:"Book Balance",statementBalance:"Statement Balance",outstandingChecks:"Outstanding Checks",depositsInTransit:"Deposits in Transit",reconciled:"Reconciled",notReconciled:"Not Reconciled",unreconciled:"Unreconciled",reconciliation:"Reconciliation",compareStatements:"Compare bank statements with entry book records",importCSV:"Import CSV",startNewReconciliation:"Start New Reconciliation",bankAccountInfo:"Bank Account Info",currentAccountDetails:"Current account details",lastReconciled:"Last reconciled",bankTransactions:"Bank Transactions",selectedPeriod:"Selected period",pending:"pending",bookEntriesForComparison:"Book entries for comparison",reconciliationRate:"Reconciliation Rate",completionStatus:"Completion status",recentReconciliationSessions:"Recent Reconciliation Sessions",latestActivity:"Latest activity",noRecentSessions:"No recent reconciliation sessions found.",startFirstReconciliation:"Start First Reconciliation",entryBookRecords:"Entry Book Records",pleaseUploadCSV:"Please upload a CSV file",csvRequiresHeaderAndData:"CSV file must have at least a header and one data row",successfullyParsed:"Successfully parsed {count} rows",errorParsingCSV:"Error parsing CSV file. Please check the format.",dateDescriptionRequired:"Date and Description columns are required",importedTransaction:"Imported transaction",successfullyImported:"Successfully imported {count} bank transactions",errorImportingTransactions:"Error importing transactions. Please check your data.",importBankStatementCSV:"Import Bank Statement CSV",dropCSVHere:"Drop CSV file here",clickToUploadCSV:"Click to upload or drag and drop CSV file",supportedFormat:"Supported format: CSV with Date, Description, and Amount columns",mapCSVColumns:"Map CSV Columns",dateColumn:"Date Column",selectColumn:"Select column...",descriptionColumn:"Description Column",referenceColumn:"Reference Column",amountDebitColumn:"Amount/Debit Column",creditColumn:"Credit Column",balanceColumn:"Balance Column",andMoreRows:"... and {count} more rows",importing:"Importing...",importTransactions:"Import {count} Transactions",reconciliationComparison:"Reconciliation Comparison",bankStatements:"Bank Statements",totalTransactions:"Total transactions",totalEntries:"Total entries",unreconciledBank:"Unreconciled Bank",unreconciledBooks:"Unreconciled Books",needAttention:"Need attention",unreconcile:"Unreconcile",clickToReconcile:"Click to reconcile",potentialMatchesFound:"Potential Matches Found",clickRecordToReconcile:"Click on a record below to reconcile",exactMatch:"Exact Match",possibleMatch:"Possible Match",selected:"Selected",clearSelection:"Clear Selection"},journal:{title:"Journal Entries",entryNumber:"Entry Number",entryDate:"Entry Date",debit:"Debit",credit:"Credit",account:"Account",memo:"Memo",reference:"Reference",createEntry:"Create Entry",editEntry:"Edit Entry",deleteEntry:"Delete Entry",posted:"Posted",draft:"Draft",reversed:"Reversed",recurringEntry:"Recurring Entry",attachments:"Attachments",totalDebits:"Total Debits",totalCredits:"Total Credits",outOfBalance:"Out of Balance",balanced:"Balanced",addEntry:"Add Journal Entry",allEntries:"All Entries",totalDebit:"Total Debit",totalCredit:"Total Credit",debitShort:"Dr.",creditShort:"Cr.",noReference:"No reference",createdBy:"By",totalAmount:"Total Amount",lines:"Lines",entryNotBalancedShort:"Entry is not balanced",accountLines:"Account Lines",noDescription:"No description",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryLines:"Journal Entry Lines",addLine:"Add Line",lineDescription:"Line description",notBalanced:"Not Balanced",updateEntry:"Update Entry",saveAsDraft:"Save as Draft",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",editEntryTooltip:"Edit this journal entry",post:"Post",entryMustBeBalanced:"Entry must be balanced to post",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",journalLines:"Journal Lines",balanceStatus:"Balance Status",unbalanced:"Unbalanced",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",postEntry:"Post Entry",fixBalance:"Fix Balance",voidEntry:"Void Entry",draftEntry:"Draft Entry",draftEntryDescription:"This entry can be edited and posted.",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",postedEntry:"Posted Entry",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",minTwoLinesRequired:"At least 2 line items are required",entryNotBalanced:"Entry is not balanced. Debit: ${debit}, Credit: ${credit}",lineAccountRequired:"Line {lineNumber}: Account is required",lineAmountRequired:"Line {lineNumber}: Either debit or credit amount must be provided",lineBothAmounts:"Line {lineNumber}: Cannot have both debit and credit amounts",enterEntryDescription:"Enter journal entry description",enterReferenceNumber:"Enter reference number"},invoices:{title:"Invoice Dashboard",invoice:"Invoice",invoices:"Invoices",invoiceNumber:"Invoice Number",invoiceDetails:"Invoice Details",customerInformation:"Customer Information",customerName:"Customer Name",legalName:"Legal Name",contactInformation:"Contact Information",idPassport:"ID/Passport",phoneNumber:"Phone Number",altPhone:"Alt Phone",address:"Address",between:"Between",and:"and",products:"Products",reservations:"Reservations",unitPrice:"Unit Price",total:"Total",subtotal:"Subtotal",totalRevenue:"Total Revenue",totalProducts:"Total Products",totalReservations:"Total Reservations",aranceles:"Aranceles (Customs)",uniqueCustomers:"Unique Customers",averageInvoice:"Average Invoice",completed:"Completed",pending:"Pending",storesActive:"Stores Active",topProducts:"Top Products",mostSoldProducts:"Most sold products by quantity",reservationsByType:"Reservations by Type",distributionOfCategories:"Distribution of reservation categories",recentInvoices:"Recent Invoices",showingInvoices:"Showing {{count}} invoices",date:"Date",customer:"Customer",store:"Store",actions:"Actions",view:"View",status:"Status",printInvoice:"Print Invoice",exportPdf:"Export PDF",backToDashboard:"Back to Dashboard",fromInvoices:"From {{count}} invoices",value:"value",activeCustomers:"Active customers",perInvoiceValue:"Per invoice value",locations:"Locations",mostRecentActivity:"Most recent activity",storeLocation:"Store Location",allStores:"All Stores",fromDate:"From Date",toDate:"To Date",clearFilters:"Clear Filters",search:"Search",searchPlaceholder:"Search by invoice #, customer, store...",customsFees:"Total customs fees",salesType:"SALES",packagesOrder:"Packages Order",businessId:"Business ID",orderKey:"Order Key",reservationType:"Reservation Type",arancel:"Arancel",key:"Key",noInvoicesFound:"No invoices found",loadingInvoices:"Loading invoices...",errorLoadingInvoices:"Error loading invoices",refreshData:"Refresh Data",currentStockValue:"Current Stock Value",filterByStore:"Filter by store",filterByDate:"Filter by date range",totalCustomsFees:"Total customs fees",averageValue:"Average value",senderInformation:"Sender Information",receiptInformation:"Receipt Information",productsSubtotal:"Products Subtotal",reservationsSubtotal:"Reservations Subtotal",code:"Code",description:"Description",qty:"Qty",type:"Type",id:"ID",passport:"Passport",createNew:"Create New Invoice",totalOutstanding:"Total Outstanding",unpaidInvoices:"Unpaid invoices",thisMonth:"This Month",revenueCollected:"Revenue collected",overdue:"Overdue",pastDueInvoices:"Past due invoices",latestBillingActivity:"Latest billing activity",paid:"Paid"},forms:{requiredField:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",selectOption:"Please select an option",enterValue:"Please enter a value",confirmDelete:"Are you sure you want to delete this item?",unsavedChanges:"You have unsaved changes. Do you want to continue?",saveSuccess:"Saved successfully",saveError:"Error saving data",deleteSuccess:"Deleted successfully",deleteError:"Error deleting item",duplicateAccountNumber:"Account number already exists",descriptionRequired:"Description is required",errorOccurred:"An error occurred",errorPostingEntry:"An error occurred while posting the entry",referenceNumberRequired:"Reference number is required",locationRequired:"Location is required",fromLocationRequired:"From location is required for transfers",atLeastOneProduct:"At least one product is required",itemProductRequired:"Product is required for item {{index}}",itemQuantityRequired:"Quantity must be greater than 0 for item {{index}}"},modals:{addInventory:"Add Inventory Movement",bulkMovement:"Bulk Inventory Movement",addProduct:"Add New Product",addLocation:"Add New Location",inventoryDetail:"Inventory Item Details",quickAdd:"Quick Add",selectProduct:"Select Product",selectLocation:"Select Location",enterQuantity:"Enter quantity",enterCost:"Enter unit cost",enterReference:"Enter reference number",addNotes:"Add notes (optional)",generalInformation:"General Information",stockInformation:"Stock Information",locationInformation:"Location Information",movementInformation:"Movement Information",addToInventory:"Add to Inventory",createProduct:"Create Product",createLocation:"Create Location",processing:"Processing...",addingMovement:"Adding movement...",creatingProduct:"Creating product...",creatingLocation:"Creating location..."},products:{title:"Products",addNew:"Add New Product",totalProducts:"Total Products",inCatalog:"In catalog",activeProducts:"Active Products",currentlyAvailable:"Currently available",outOfStock:"Out of Stock",needsRestock:"Needs restock",productCatalog:"Product Catalog",manageYourProducts:"Manage your products and pricing",inStock:"In Stock",furniture:"Furniture",electronics:"Electronics",supplies:"Supplies",lighting:"Lighting",searchPlaceholder:"Search products by name, SKU, or category...",allCategories:"All Categories",clearFilters:"Clear filters",noResults:"No products found matching your criteria.",noProducts:"No products available.",showing:"Showing",filtered:"Filtered results",allProducts:"All products",searchResult:"Search Result",stock:"Stock",lowStock:"Low Stock"},unauthorized:{title:"Access Restricted",accessDenied:"Access Denied",noPermission:"You don't have permission to access",thisFeature:"this feature",whySeeing:"Why am I seeing this?",explanation:"Your account doesn't have the necessary permissions to view this content.",requiredPermission:"Required permission:",goToDashboard:"Go to Dashboard",goBack:"Go Back",featuresCanAccess:"Features you can access:",dashboardAccess:"Dashboard and overview statistics",profileAccess:"Your profile and settings",roleBasedAccess:"Features enabled for your role",needAccess:"Need access? Contact your administrator or manager to request the appropriate permissions.",permissions:{accountAccess:"Account Management Access",inventoryAccess:"Inventory Access",employeeAccess:"HR Access",bankingAccess:"Banking Access",journalAccess:"Journal Entry Access",adminAccess:"Administrative Access",financialReporting:"Financial Reporting Access",invoiceManagement:"Invoice Management Access",productManagement:"Product Management Access"}}},es:{common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",add:"Agregar",close:"Cerrar",search:"Buscar",filter:"Filtrar",reset:"Restablecer",back:"Atrs",next:"Siguiente",previous:"Anterior",yes:"S",no:"No",loading:"Cargando...",error:"Error",success:"xito",warning:"Advertencia",info:"Informacin",confirm:"Confirmar",actions:"Acciones",status:"Estado",active:"Activo",inactive:"Inactivo",date:"Fecha",time:"Hora",description:"Descripcin",notes:"Notas",amount:"Monto",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Idioma",english:"Ingls",spanish:"Espaol",noDataFound:"No se encontraron datos",required:"Requerido",optional:"Opcional",all:"Todos",none:"Ninguno",select:"Seleccionar",clear:"Limpiar",view:"Ver",suggested:"Sugerido",clearFilters:"Limpiar Filtros",enhanced:"Mejorado",legacy:"Clsico",email:"Correo Electrnico",phone:"Telfono",address:"Direccin",name:"Nombre",code:"Cdigo",category:"Categora",type:"Tipo",quantity:"Cantidad",price:"Precio",cost:"Costo",value:"Valor",balance:"Saldo",created:"Creado",modified:"Modificado",details:"Detalles",summary:"Resumen",history:"Historial",new:"Nuevo",addNew:"Agregar Nuevo",unknown:"Desconocido",notAvailable:"N/A",remove:"Remover",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",from:"De",invoice:"Factura",invoices:"facturas",reference:"Referencia",createdBy:"Creado Por",units:"unidades",invoiceDocumentId:"ID de Factura/Documento",referenceNumber:"Nmero de Referencia",referenceNumberPlaceholder:"Ingrese nmero de referencia...",generalNotes:"Notas Generales",auto:"Auto",optionalNotes:"Notas opcionales...",showPerPage:"Mostrar por pgina",first:"Primera",last:"ltima",store:"Tienda",orderId:"ID de Orden",tax:"Impuesto",paymentMethods:"Mtodos de Pago",cash:"Efectivo",creditCard:"Tarjeta de Crdito",shipping:"Envo",air:"Areo",sea:"Martimo",thankYouBusiness:"Gracias por su negocio!",thankForChoosingUs:"Gracias por elejirnos!",taxExemptNote:"Impuesto exento en pago en efectivo.",youSaved:"Usted ahorr",generatedOn:"Generado el",printSavePDF:"Imprimir / Guardar como PDF",pageOfPages:"Pgina {{current}} de {{total}}",showingXofY:"Mostrando {{start}}-{{end}} de {{total}}",page:"Pgina",of:"de",lbs:"libras"},navigation:{dashboard:"Panel de Control",accounts:"Plan de Cuentas",balanceSheet:"Balance General",inventory:"Inventario",employees:"Empleados",entryBooks:"Libros de Entrada",consolidate:"Consolidacin Bancaria",reports:"Reportes",settings:"Configuracin"},dashboard:{title:"Panel de Control",welcome:"Bienvenido a HRM Finance",totalRevenue:"Ingresos Totales",overview:"Resumen",recentActivity:"Actividad Reciente",quickActions:"Acciones Rpidas",employeeCount:"Nmero de Empleados",pendingInvoices:"Facturas Pendientes",cashBalance:"Saldo en Efectivo",totalAssets:"Activos Totales",totalLiabilities:"Pasivos Totales",totalExpenses:"Gastos Totales",netIncome:"Ingreso Neto",netLoss:"Prdida Neta",monthlyPayroll:"Nmina Mensual",current:"Actual",newHires:"+3 nuevas contrataciones",outstanding:"Pendiente",totalOutstanding:"$23,450 total",lastUpdatedToday:"ltima actualizacin hoy",commonTasks:"Tareas comunes",generateReport:"Generar Reporte",latestUpdates:"ltimas actualizaciones",invoicePaid:"Factura #1234 pagada",hoursAgo:"hace 2 horas",newEmployeeOnboarded:"Nuevo empleado incorporado",dayAgo:"hace 1 da",monthlyReportGenerated:"Reporte mensual generado",daysAgo:"hace 2 das"},accounts:{title:"Plan de Cuentas",accountNumber:"Nmero de Cuenta",accountName:"Nombre de Cuenta",accountType:"Tipo de Cuenta",category:"Categora",balance:"Saldo",parentAccount:"Cuenta Padre",subAccounts:"Subcuentas",addAccount:"Agregar Cuenta",editAccount:"Editar Cuenta",deleteAccount:"Eliminar Cuenta",accountDetails:"Detalles de Cuenta",transactions:"Transacciones",accountHistory:"Historial de Cuenta",backToAccounts:"Volver a Cuentas",accountNotFound:"Cuenta no encontrada",accountInformation:"Informacin de Cuenta",accountPurpose:"Propsito de la cuenta",transactionHistory:"Historial de Transacciones",noTransactions:"No se encontraron transacciones para esta cuenta",createdDate:"Fecha de Creacin",lastModified:"ltima Modificacin",noDescription:"No se proporcion descripcin.",totalCount:"Conteo total",basicDetails:"Detalles bsicos",currentBalance:"Saldo actual",classification:"Clasificacin",allTransactions:"Todas las transacciones de la cuenta",reference:"Referencia",types:{asset:"Activo",liability:"Pasivo",equity:"Patrimonio",revenue:"Ingreso",expense:"Gasto"},categories:{currentAssets:"Activos Corrientes",fixedAssets:"Activos Fijos",currentLiabilities:"Pasivos Corrientes",longTermLiabilities:"Pasivos a Largo Plazo",ownersEquity:"Patrimonio del Propietario",operatingRevenue:"Ingresos Operacionales",operatingExpenses:"Gastos Operacionales"}},inventory:{title:"Gestin de Inventario",overview:"Resumen",products:"Productos y Stock",movements:"Movimientos",locations:"Ubicaciones",bulkMovement:"Movimiento Masivo",addMovement:"Agregar Movimiento",addProduct:"Agregar Producto",addLocation:"Agregar Ubicacin",singleMovement:"Agregar Movimiento Individual",addNewItem:"Agregar Nuevo Artculo",activeProducts:"Productos Activos",lowStockAlert:"Artculos con Stock Bajo",totalValue:"Valor Total del Stock",activeLocations:"Ubicaciones Activas",productsNeedRestocking:"productos necesitan reabastecimiento",recentMovements:"Movimientos Recientes",noProducts:"No hay productos en esta ubicacin",productName:"Nombre del Producto",productCode:"Cdigo del Producto",sku:"SKU",category:"Categoria",unitOfMeasure:"Unidad de Medida",unitCost:"Costo Unitario",minStockLevel:"Nivel Mnimo de Stock",maxStockLevel:"Nivel Mximo de Stock",locationName:"Nombre de Ubicacin",locationType:"Tipo de Ubicacin",locationCode:"Cdigo de Ubicacin",movementType:"Tipo de Movimiento",referenceNumber:"Nmero de Referencia",invoiceNumber:"Nmero de Factura",fromLocation:"Desde Ubicacin",toLocation:"Hacia Ubicacin",stockIn:"Entrada de Stock",stockOut:"Salida de Stock",transfer:"Transferencia",adjustment:"Ajuste",inStock:"En Stock",lowStock:"Stock Bajo",outOfStock:"Sin Stock",stockLevels:"Niveles de Stock",stockByLocation:"Stock por Ubicacin",searchProducts:"Buscar productos...",searchLocations:"Buscar ubicaciones...",noMovements:"No se encontraron movimientos",productDetails:"Detalles del Producto",locationDetails:"Detalles de Ubicacin",movementDetails:"Detalles del Movimiento",totalProducts:"Total de Productos",totalLocations:"Total de Ubicaciones",lastSeen:"Visto por ltima vez",warehouseType:"Almacn",storeType:"Tienda",supplierType:"Proveedor",customerType:"Cliente",currentlyManaged:"Gestionados actualmente",needAttention:"Necesitan atencin",currentWorth:"Valor actual",warehousesStores:"Almacenes y tiendas",thisMonth:"Este Mes",latestActivities:"ltimas actividades de inventario",searchMovements:"Buscar Movimientos",countingSheet:"Hoja de Conteo",physicalCount:"Conteo Fsico",physicalInventoryCount:"Conteo Fsico de Inventario",setupPhysicalCount:"Configurar Conteo Fsico de Inventario",setupDescription:"Configure los ajustes de su conteo fsico de inventario y comience el proceso de conteo.",countWillInclude:"Este conteo incluir {{count}} productos de {{location}} en la categora {{category}}.",startCounting:"Iniciar Conteo Fsico",counted:"Contado",remaining:"Restante",variances:"Variaciones",complete:"Completo",systemQty:"Cant. Sistema",variance:"Variacin",addNotes:"Agregar notas...",reviewAndConfirm:"Revisar y Confirmar Ajustes",reviewDescription:"Revise los ajustes de inventario a continuacin y confirme para actualizar su sistema.",stockIncreases:"Aumentos de Stock",stockDecreases:"Disminuciones de Stock",totalAdjustments:"Ajustes Totales",confirmAdjustments:"Confirmar Ajustes",adjustment:"Ajuste",perfectCount:"Conteo Perfecto!",noVariances:"No se encontraron variaciones. Su conteo fsico coincide exactamente con el sistema.",physicalCountAdjustment:"Ajuste de conteo fsico",inventoryCountingSheetTitle:"HOJA DE CONTEO DE INVENTARIO",location:"Ubicacin",allCategories:"Todas las Categoras",countedBy:"Contado por",verifiedBy:"Verificado por",instructions:"Instrucciones",countInstructions:["Contar todos los artculos fsicamente presentes en esta ubicacin",'Escribir el conteo real en la columna "Conteo Fsico"',"Dejar en blanco si el artculo no se encuentra",'Anotar cualquier discrepancia en la columna "Notas"',"Firmar y fechar cuando est completo"],productName:"Nombre del Producto",unit:"Unidad",totalProductsListed:"Total de Productos Listados",itemsCounted:"Artculos Contados",summaryFor:"RESUMEN PARA",discrepanciesFound:"Discrepancias Encontradas",counterSignature:"Firma del Contador",supervisorSignature:"Firma del Supervisor",downloadCSV:"Descargar CSV",noAdjustmentsToDownload:"No hay ajustes para descargar",stockIncrease:"Aumento de Stock",stockDecrease:"Disminucin de Stock",purchaseReceive:"Compra/Recepcin",saleIssue:"Venta/Emisin",transfer:"Transferencia",adjustment:"Ajuste",movementType:"Tipo de Movimiento",fromLocation:"Ubicacin de Origen",toLocation:"Ubicacin de Destino",searchSourceLocation:"Buscar ubicacin de origen...",searchDestinationLocation:"Buscar ubicacin de destino...",searchLocation:"Buscar ubicacin...",addProduct:"Agregar Producto",searchProduct:"Buscar producto...",unitCost:"Costo Unitario",noProductsAdded:'No se han agregado productos an. Haga clic en "Agregar Producto" para comenzar.',createMovement:"Crear Movimiento",generalNotesPlaceholder:"Ingrese notas generales para este movimiento...",sortBy:"Ordenar Por",allLocations:"Todas las Ubicaciones",searchByProduct:"Buscar por producto, ubicacin, referencia, notas, factura...",allProducts:"Todos los Productos",bulkMovementReport:"Reporte de Movimiento en Lote",movementDetails:"Detalles del Movimiento",referenceNumber:"Nmero de Referencia",invoiceId:"ID de Factura",totalItems:"Total de Artculos",totalQuantity:"Cantidad Total",estimatedValue:"Valor Estimado",viewHistoricalReports:"Ver Reportes Histricos",noBulkReportsFound:"No se encontraron reportes de movimientos en lote",bulkReportsAppearHere:"Los reportes de movimientos en lote aparecern aqu despus de crear movimientos en lote",allTypes:"Todos los Tipos",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",totalMovements:"Movimientos Totales",totalItems:"Artculos Totales",adjustMovements:"Intenta ajustar tus filtros o revisa ms tarde.",inventoryMovements:"Movimientos de Inventario",createdBy:"Creado Por",view:"Ver",enhanced:"Mejorado",legacy:"Clsico",addSingleMovement:"Agregar Movimiento Individual",inStockSubtitle:"En stock",itemsBelowThreshold:"Artculos bajo el umbral",inventoryWorth:"Valor del inventario",quantity:"Cantidad",units:"unidades",normal:"Normal",productsAndStock:"Productos y Stock",lowStockItems:"Artculos con Stock Bajo",totalStockValue:"Valor Total del Stock",warehousesAndStores:"Almacenes y tiendas",andMore:"...y {count} ms",latestInventoryActivities:"ltimas actividades de inventario",min:"Mn",max:"Mx",cost:"Costo",noProductsFound:"No se encontraron productos que coincidan con su bsqueda.",noProductsAvailable:"No hay productos disponibles.",noLocationsFound:"No se encontraron ubicaciones que coincidan con su bsqueda.",noLocationsAvailable:"No hay ubicaciones disponibles.",searchPlaceholder:"Buscar por producto, ubicacin, referencia, notas, factura...",noMovementsFound:"No se encontraron movimientos",tryAdjustingFilters:"Intenta ajustar tus filtros o revisa ms tarde.",transfers:"Transferencias",adjustments:"Ajustes",bulk:"Masivo",product:"Producto",location:"Ubicacin",store:"Tienda",supplier:"Proveedor",warehouse:"Almacn",movement:"Movimiento",editMovement:"Editar Movimiento",updateMovement:"Actualizar Movimiento",movementInformation:"Informacin del Movimiento",locationInformation:"Informacin de Ubicacin",searchProductsImages:"Buscar productos para ver imgenes...",searchForProducts:"Buscar Productos",startTypingToSearch:"Comienza a escribir para buscar y ver imgenes de productos",tryDifferentSearch:"Prueba con un trmino de bsqueda diferente"},employees:{title:"Gestin de Empleados",employeeList:"Lista de Empleados",addEmployee:"Agregar Empleado",editEmployee:"Editar Empleado",employeeDetails:"Detalles del Empleado",personalInfo:"Informacin Personal",employmentInfo:"Informacin Laboral",payrollInfo:"Informacin de Nmina",firstName:"Nombre",lastName:"Apellido",fullName:"Nombre Completo",email:"Correo Electrnico",phone:"Telfono",address:"Direccin",dateOfBirth:"Fecha de Nacimiento",employeeId:"ID de Empleado",department:"Departamento",position:"Puesto",hireDate:"Fecha de Contratacin",employmentStatus:"Estado Laboral",salary:"Salario",payFrequency:"Frecuencia de Pago",taxId:"ID Fiscal",bankAccount:"Cuenta Bancaria",emergencyContact:"Contacto de Emergencia",activeEmployees:"Empleados Activos",inactiveEmployees:"Empleados Inactivos",totalPayroll:"Nmina Total",searchEmployees:"Buscar empleados...",enterFullName:"Ingrese el nombre completo del empleado",enterPosition:"Ingrese el puesto de trabajo",enterEmail:"Ingrese la direccin de correo electrnico",enterPhone:"Ingrese el nmero de telfono",enterSalary:"Ingrese el salario anual",departments:{engineering:"Ingeniera",product:"Producto",design:"Diseo",marketing:"Marketing",sales:"Ventas",humanResources:"Recursos Humanos",finance:"Finanzas",operations:"Operaciones",analytics:"Analtica"}},entryBooks:{title:"Libros de Entrada",bookName:"Nombre del Libro",bookType:"Tipo de Libro",createBook:"Crear Libro",editBook:"Editar Libro",salesBook:"Libro de Ventas",purchaseBook:"Libro de Compras",cashBook:"Libro de Caja",generalBook:"Libro General",entries:"Entradas",addEntry:"Agregar Entrada",period:"Perodo",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",bookBalance:"Saldo del Libro",reconciledBalance:"Saldo Conciliado",difference:"Diferencia",reconcile:"Conciliar",isReconciled:"Est Conciliado",noBooks:"No se encontraron libros de entrada",createFirst:"Crea tu primer libro de entrada para comenzar",bookDetails:"Detalles del Libro",entriesCount:"entradas",bookOverview:"Resumen y detalles del libro",bookEntries:"Entradas del Libro",allEntries:"Todas las entradas en este libro",noEntries:"No se encontraron entradas",addFirst:"Agrega tu primera entrada a este libro",entryDate:"Fecha de Entrada",entryDescription:"Descripcin de Entrada",entryAmount:"Monto de Entrada",entryReference:"Referencia de Entrada"},banking:{title:"Consolidacin Bancaria",bankAccount:"Cuenta Bancaria",statementDate:"Fecha del Estado",beginningBalance:"Saldo Inicial",endingBalance:"Saldo Final",deposits:"Depsitos",withdrawals:"Retiros",bankCharges:"Cargos Bancarios",interest:"Intereses",reconcile:"Conciliar",matched:"Conciliado",unmatched:"No Conciliado",importStatement:"Importar Estado",manualEntry:"Entrada Manual",autoMatch:"Coincidencia Automtica",clearAll:"Limpiar Todo",reconciliationStatus:"Estado de Conciliacin",difference:"Diferencia",bookBalance:"Saldo en Libros",statementBalance:"Saldo del Estado",outstandingChecks:"Cheques Pendientes",depositsInTransit:"Depsitos en Trnsito",reconciled:"Conciliado",notReconciled:"No Conciliado",unreconciled:"No Conciliado",reconciliation:"Conciliacin",compareStatements:"Comparar estados bancarios con registros de libros de entrada",importCSV:"Importar CSV",startNewReconciliation:"Iniciar Nueva Conciliacin",bankAccountInfo:"Informacin de Cuenta Bancaria",currentAccountDetails:"Detalles de cuenta actual",lastReconciled:"ltima conciliacin",bankTransactions:"Transacciones Bancarias",selectedPeriod:"Perodo seleccionado",pending:"pendiente",bookEntriesForComparison:"Entradas de libros para comparacin",reconciliationRate:"Tasa de Conciliacin",completionStatus:"Estado de finalizacin",recentReconciliationSessions:"Sesiones de Conciliacin Recientes",latestActivity:"Actividad reciente",noRecentSessions:"No se encontraron sesiones de conciliacin recientes.",startFirstReconciliation:"Iniciar Primera Conciliacin",entryBookRecords:"Registros de Libros de Entrada",pleaseUploadCSV:"Por favor suba un archivo CSV",csvRequiresHeaderAndData:"El archivo CSV debe tener al menos un encabezado y una fila de datos",successfullyParsed:"Se analizaron exitosamente {count} filas",errorParsingCSV:"Error al analizar el archivo CSV. Verifique el formato.",dateDescriptionRequired:"Las columnas de Fecha y Descripcin son requeridas",importedTransaction:"Transaccin importada",successfullyImported:"Se importaron exitosamente {count} transacciones bancarias",errorImportingTransactions:"Error al importar transacciones. Verifique sus datos.",importBankStatementCSV:"Importar CSV de Estado Bancario",dropCSVHere:"Suelte el archivo CSV aqu",clickToUploadCSV:"Haga clic para cargar o arrastre y suelte el archivo CSV",supportedFormat:"Formato soportado: CSV con columnas de Fecha, Descripcin y Monto",mapCSVColumns:"Mapear Columnas CSV",dateColumn:"Columna de Fecha",selectColumn:"Seleccionar columna...",descriptionColumn:"Columna de Descripcin",referenceColumn:"Columna de Referencia",amountDebitColumn:"Columna de Monto/Dbito",creditColumn:"Columna de Crdito",balanceColumn:"Columna de Saldo",andMoreRows:"... y {count} filas ms",importing:"Importando...",importTransactions:"Importar {count} Transacciones",reconciliationComparison:"Comparacin de Conciliacin",bankStatements:"Estados Bancarios",totalTransactions:"Transacciones totales",totalEntries:"Entradas totales",unreconciledBank:"Banco No Conciliado",unreconciledBooks:"Libros No Conciliados",needAttention:"Necesitan atencin",unreconcile:"Desconciliar",clickToReconcile:"Hacer clic para conciliar",potentialMatchesFound:"Coincidencias Potenciales Encontradas",clickRecordToReconcile:"Haga clic en un registro a continuacin para conciliar",exactMatch:"Coincidencia Exacta",possibleMatch:"Posible Coincidencia",selected:"Seleccionado",clearSelection:"Limpiar Seleccin"},journal:{title:"Asientos Contables",entryNumber:"Nmero de Asiento",entryDate:"Fecha del Asiento",debit:"Dbito",credit:"Crdito",account:"Cuenta",memo:"Memo",reference:"Referencia",createEntry:"Crear Asiento",editEntry:"Editar Asiento",deleteEntry:"Eliminar Asiento",posted:"Registrado",draft:"Borrador",reversed:"Revertido",recurringEntry:"Asiento Recurrente",attachments:"Adjuntos",totalDebits:"Dbitos Totales",totalCredits:"Crditos Totales",outOfBalance:"Desbalanceado",balanced:"Balanceado"},forms:{requiredField:"Este campo es requerido",invalidEmail:"Direccin de correo invlida",invalidNumber:"Nmero invlido",invalidDate:"Fecha invlida",selectOption:"Por favor seleccione una opcin",enterValue:"Por favor ingrese un valor",confirmDelete:"Est seguro de que desea eliminar este elemento?",unsavedChanges:"Tiene cambios sin guardar. Desea continuar?",saveSuccess:"Guardado exitosamente",saveError:"Error al guardar datos",deleteSuccess:"Eliminado exitosamente",deleteError:"Error al eliminar elemento",duplicateAccountNumber:"El nmero de cuenta ya existe",referenceNumberRequired:"El nmero de referencia es requerido",locationRequired:"La ubicacin es requerida",fromLocationRequired:"La ubicacin de origen es requerida para transferencias",atLeastOneProduct:"Al menos un producto es requerido",itemProductRequired:"El producto es requerido para el artculo {{index}}",itemQuantityRequired:"La cantidad debe ser mayor que 0 para el artculo {{index}}"},modals:{addInventory:"Agregar Movimiento de Inventario",bulkMovement:"Movimiento Masivo de Inventario",addProduct:"Agregar Nuevo Producto",addLocation:"Agregar Nueva Ubicacin",inventoryDetail:"Detalles del Artculo de Inventario",quickAdd:"Agregar Rpido",selectProduct:"Seleccionar Producto",selectLocation:"Seleccionar Ubicacin",enterQuantity:"Ingresar cantidad",enterCost:"Ingresar costo unitario",enterReference:"Ingresar nmero de referencia",addNotes:"Agregar notas (opcional)",generalInformation:"Informacin General",stockInformation:"Informacin de Stock",locationInformation:"Informacin de Ubicacin",movementInformation:"Informacin de Movimiento",addToInventory:"Agregar al Inventario",createProduct:"Crear Producto",createLocation:"Crear Ubicacin",processing:"Procesando...",addingMovement:"Agregando movimiento...",creatingProduct:"Creando producto...",creatingLocation:"Creando ubicacin..."},products:{title:"Productos",addNew:"Agregar Nuevo Producto",totalProducts:"Total de Productos",inCatalog:"En catlogo",activeProducts:"Productos Activos",currentlyAvailable:"Actualmente disponibles",outOfStock:"Sin Stock",needsRestock:"Necesita reabastecimiento",productCatalog:"Catlogo de Productos",manageYourProducts:"Gestiona tus productos y precios",inStock:"En Stock",furniture:"Muebles",electronics:"Electrnicos",supplies:"Suministros",lighting:"Iluminacin"},invoices:{title:"Panel de Facturas",invoice:"Factura",invoices:"Facturas",invoiceNumber:"Nmero de Factura",invoiceDetails:"Detalles de Factura",customerInformation:"Informacin del Cliente",customerName:"Nombre del Cliente",legalName:"Nombre Legal",contactInformation:"Informacin de Contacto",idPassport:"ID/Pasaporte",phoneNumber:"Nmero de Telfono",altPhone:"Telfono Alt.",address:"Direccin",between:"Entre",and:"y",products:"Productos",reservations:"Reservaciones",unitPrice:"Precio Unitario",total:"Total",subtotal:"Subtotal",category:"Categoria",totalRevenue:"Ingresos Totales",totalProducts:"Total de Productos",totalReservations:"Total de Reservaciones",aranceles:"Aranceles (Aduanas)",uniqueCustomers:"Clientes nicos",averageInvoice:"Factura Promedio",completed:"Completada",pending:"Pendiente",storesActive:"Tiendas Activas",topProducts:"Productos Principales",mostSoldProducts:"Productos ms vendidos por cantidad",reservationsByType:"Reservaciones por Tipo",distributionOfCategories:"Distribucin de categoras de reservaciones",recentInvoices:"Facturas Recientes",showingInvoices:"Mostrando {{count}} facturas",date:"Fecha",customer:"Cliente",store:"Tienda",actions:"Acciones",view:"Ver",status:"Estado",printInvoice:"Imprimir Factura",exportPdf:"Exportar PDF",backToDashboard:"Volver al Panel",fromInvoices:"De {{count}} facturas",value:"valor",activeCustomers:"Clientes activos",perInvoiceValue:"Valor por factura",locations:"Ubicaciones",mostRecentActivity:"Actividad ms reciente",storeLocation:"Ubicacin de Tienda",allStores:"Todas las Tiendas",fromDate:"Fecha Desde",toDate:"Fecha Hasta",clearFilters:"Limpiar Filtros",search:"Buscar",searchPlaceholder:"Buscar por # factura, cliente, tienda...",customsFees:"Aranceles totales",salesType:"VENTAS",packagesOrder:"Orden de Paquetes",businessId:"ID de Negocio",orderKey:"Clave de Orden",reservationType:"Tipo de Reservacin",arancel:"Arancel",key:"Clave",noInvoicesFound:"No se encontraron facturas",loadingInvoices:"Cargando facturas...",errorLoadingInvoices:"Error al cargar facturas",refreshData:"Actualizar Datos",currentStockValue:"Valor de Stock Actual",filterByStore:"Filtrar por tienda",filterByDate:"Filtrar por rango de fechas",totalCustomsFees:"Aranceles totales",averageValue:"Valor promedio",senderInformation:"Informacin del Remitente",receiptInformation:"Informacin del Destinatario",productsSubtotal:"Subtotal de Productos",reservationsSubtotal:"Subtotal de Reservaciones",code:"Cdigo",description:"Descripcin",qty:"Cant.",type:"Tipo",id:"ID",passport:"Pasaporte"},unauthorized:{title:"Acceso Restringido",accessDenied:"Acceso Denegado",noPermission:"No tienes permisos para acceder a",thisFeature:"esta funcionalidad",whySeeing:"Por qu veo esto?",explanation:"Tu cuenta no tiene los permisos necesarios para ver este contenido.",requiredPermission:"Permiso requerido:",goToDashboard:"Ir al Panel de Control",goBack:"Regresar",featuresCanAccess:"Funcionalidades a las que puedes acceder:",dashboardAccess:"Panel de control y estadsticas generales",profileAccess:"Tu perfil y configuraciones",roleBasedAccess:"Funcionalidades habilitadas para tu rol",needAccess:"Necesitas acceso? Contacta a tu administrador o gerente para solicitar los permisos apropiados.",permissions:{accountAccess:"Acceso a Gestin de Cuentas",inventoryAccess:"Acceso a Inventario",employeeAccess:"Acceso a Recursos Humanos",bankingAccess:"Acceso Bancario",journalAccess:"Acceso a Asientos Contables",adminAccess:"Acceso Administrativo",financialReporting:"Acceso a Reportes Financieros",invoiceManagement:"Acceso a Gestin de Facturas",productManagement:"Acceso a Gestin de Productos"}}}},qI=()=>{if(typeof window<"u"){const t=localStorage.getItem("hrmfinance-language");if(t&&["en","es"].includes(t))return t}return"en"},[Zv,UI]=$e(qI()),tr=()=>({t:(n,i,o)=>{const s=Zv(),a=n.split(".");let c=zI[s];for(const f of a)if(c&&typeof c=="object"&&f in c)c=c[f];else return i||n;let u=typeof c=="string"?c:i||n;return o&&typeof u=="string"&&Object.keys(o).forEach(f=>{const y=o[f],v=`{{${f}}}`;u=u.replace(new RegExp(v,"g"),String(y))}),u},language:()=>Zv(),setLanguage:n=>{UI(n),typeof window<"u"&&localStorage.setItem("hrmfinance-language",n)}});var HI=ue("<div><label></label><select><option value>"),WI=ue("<span>*"),GI=ue("<option>");const ci=t=>{const{t:e}=tr(),r={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},n={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},i={"margin-bottom":"1rem"};return(()=>{var o=HI(),s=o.firstChild,a=s.nextSibling,c=a.firstChild;return m(o,i),m(s,r),l(s,()=>t.label,null),l(s,(()=>{var u=Te(()=>!!t.required);return()=>u()&&(()=>{var f=WI();return f.style.setProperty("color","var(--primary-color)"),f})()})(),null),a.addEventListener("blur",u=>u.target.style.borderColor="var(--border-color)"),a.addEventListener("focus",u=>u.target.style.borderColor="var(--primary-color)"),a.addEventListener("change",u=>t.onChange(u.target.value)),m(a,n),l(c,()=>e("forms.selectOption")),l(a,()=>t.options.map(u=>(()=>{var f=GI();return l(f,()=>u.label),Se(()=>f.value=u.value),f})()),null),Se(u=>{var f=t.required,y=t.disabled;return f!==u.e&&(a.required=u.e=f),y!==u.t&&(a.disabled=u.t=y),u},{e:void 0,t:void 0}),Se(()=>a.value=t.value),o})()};var YI=ue("<main><div>"),KI=ue("<header><h1>");const ro=t=>{const e={"min-height":"100vh",background:"var(--background-color)"},r={"max-width":"1200px",margin:"0 auto",padding:"2rem"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},i={"font-size":"2rem","font-weight":"700",color:"var(--text-primary)",margin:"0"};return(()=>{var o=YI(),s=o.firstChild;return m(o,e),m(s,r),l(s,(()=>{var a=Te(()=>!!t.title);return()=>a()&&(()=>{var c=KI(),u=c.firstChild;return m(c,n),m(u,i),l(u,()=>t.title),c})()})(),null),l(s,()=>t.children,null),o})()};var JI=ue("<div><span></span><select><option value=en> </option><option value=es> ");const QI=()=>{const{t,language:e,setLanguage:r}=tr(),n={display:"flex","align-items":"center",gap:"0.5rem","margin-left":"auto"},i={padding:"0.5rem 1rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",background:"var(--surface-color)",color:"var(--text-primary)",cursor:"pointer","font-size":"0.875rem","font-weight":"500",transition:"all 0.2s ease","min-width":"120px"},o={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},s=a=>{const c=a.target;r(c.value)};return(()=>{var a=JI(),c=a.firstChild,u=c.nextSibling,f=u.firstChild;f.firstChild;var y=f.nextSibling;return y.firstChild,m(a,n),m(c,o),u.addEventListener("change",s),m(u,i),l(f,()=>t("common.english"),null),l(y,()=>t("common.spanish"),null),Se(()=>u.value=e()),a})()};var e0=ue('<img alt="User avatar">'),XI=ue("<div class=user-info-desktop><span>"),ZI=ue("<button class=sign-out-desktop>Sign Out"),e$=ue("<div><div><span></span></div><button>Sign Out"),t$=ue(`<nav><div><div class=desktop-nav></div><div><button class=mobile-menu-button><svg width=24 height=24 viewBox="0 0 24 24"fill=currentColor><path></path></svg></button></div></div><div class=mobile-nav></div><style>
        .nav-active {
          background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)) !important;
          color: white !important;
          box-shadow: var(--shadow-sm);
        }
        
        .desktop-nav a:hover:not(.nav-active),
        .nav-group button:hover {
          background: var(--background-color);
          color: var(--text-primary);
        }
        
        .mobile-nav a:hover:not(.nav-active) {
          background: var(--background-color);
          color: var(--text-primary);
        }

        /* Create invisible bridge to prevent gap issues */
        .nav-group::before {
          content: '';
          position: absolute;
          top: 100%;
          left: 0;
          right: 0;
          height: 0.5rem;
          z-index: 9;
        }
        
        @media (max-width: 768px) {
          .desktop-nav {
            display: none !important;
          }
          
          .mobile-menu-button {
            display: block !important;
          }
          
          .user-info-desktop,
          .sign-out-desktop {
            display: none !important;
          }
          
          nav > div:first-child {
            padding: 1rem;
          }
        }
        
        @media (min-width: 769px) {
          .mobile-nav {
            display: none !important;
          }
        }
      `),r$=ue("<div class=nav-group><button> <span></span></button><div>"),n$=ue("<div>"),i$=ue("<div><div><span> </span><span>");const o$=()=>{const{t}=tr(),[e,r]=$e(!1),[n,i]=$e(null),[o,s]=$e(null),a={background:"var(--surface-color)","border-bottom":"1px solid var(--border-color)","box-shadow":"var(--shadow-sm)","backdrop-filter":"blur(10px)",position:"sticky",top:"0","z-index":"100"},c={display:"flex","align-items":"center","justify-content":"space-between",padding:"1rem 2rem",margin:"0 auto",position:"relative"},u={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","text-decoration":"none"},f={display:"flex",gap:"1rem","align-items":"center",flex:"1","margin-left":"2rem"},y={display:"none",position:"absolute",top:"100%",left:"0",right:"0",background:"var(--surface-color)","border-top":"1px solid var(--border-color)","box-shadow":"var(--shadow-md)","max-height":"70vh","overflow-y":"auto"},v={position:"relative",display:"flex","align-items":"center"},p={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem",background:"transparent",border:"none",color:"var(--text-secondary)","font-weight":"500","font-size":"0.875rem",cursor:"pointer","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease","white-space":"nowrap"},I={position:"absolute",top:"100%",left:"0",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","min-width":"200px","margin-top":"0.25rem","z-index":"10",display:"none","padding-top":"0.25rem"},P={"border-bottom":"1px solid var(--border-color)"},w={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",cursor:"pointer","font-weight":"600",color:"var(--text-primary)"},x={display:"block","text-decoration":"none",color:"var(--text-secondary)",padding:"0.75rem 1rem","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease","white-space":"nowrap"},j={...x,padding:"0.75rem 1.5rem","border-bottom":"1px solid var(--border-light)"},ne={display:"none",background:"transparent",border:"none",padding:"0.5rem",cursor:"pointer",color:"var(--text-primary)"},Q={display:"flex","align-items":"center",gap:"1rem"},K={display:"flex","align-items":"center",gap:"0.75rem",padding:"0.5rem 1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",color:"var(--text-primary)"},Z={width:"32px",height:"32px","border-radius":"50%","object-fit":"cover"},k={...x,cursor:"pointer",border:"1px solid var(--border-color)",background:"transparent","border-radius":"var(--border-radius-sm)"},C=()=>{Ar.signOut()},E=O=>{const D=Ar.state?.profile;return D?D[O]===!0||D.isAdmin===!0:!1},M=()=>{r(!e())},_=O=>{i(n()===O?null:O)},S=O=>{const D=o();D&&(clearTimeout(D),s(null)),i(O)},b=()=>{const O=setTimeout(()=>{i(null)},300);s(O)},Y=[{name:"Finance",icon:"",items:[{path:"/accounts",label:t("navigation.accounts"),permission:"AccountAccess",icon:""},{path:"/entry-books",label:t("navigation.entryBooks"),permission:"JournalAccess",icon:""},{path:"/balance-sheet",label:t("navigation.balanceSheet"),permission:"AccountAccess",icon:""},{path:"/bank-consolidations",label:t("navigation.consolidate"),permission:"BankingAccess",icon:""}]},{name:"Operations",icon:"",items:[{path:"/inventory",label:t("navigation.inventory"),permission:"InventoryAccess",icon:""},{path:"/invoices",label:t("invoices.invoices"),permission:"invoiceAccess",icon:""},{path:"/hbl",label:t("navigation.hbl"),permission:"HBLAccess",icon:""}]},{name:"Management",icon:"",items:[{path:"/employees",label:t("navigation.employees"),permission:"EmployeeAccess",icon:""},{path:"/admin/users",label:"Admin",permission:"isAdmin",icon:"",adminOnly:!0}]}],te=()=>Y.map(O=>({...O,items:O.items.filter(D=>D.adminOnly?Ar.state?.profile?.isAdmin:E(D.permission))})).filter(O=>O.items.length>0);return(()=>{var O=t$(),D=O.firstChild,X=D.firstChild,H=X.nextSibling,F=H.firstChild,ie=F.firstChild,$=ie.firstChild,L=D.nextSibling;return l(D,B(tc,{href:"/",style:u,children:"HRM Finance"}),X),m(X,f),l(X,B(tc,{href:"/",style:x,activeClass:"nav-active",get children(){return[" ",Te(()=>t("navigation.dashboard"))]}}),null),l(X,B(Ht,{get each(){return te()},children:U=>(()=>{var N=r$(),z=N.firstChild,oe=z.firstChild,G=oe.nextSibling,ee=z.nextSibling;return N.addEventListener("mouseleave",b),N.addEventListener("mouseenter",()=>S(U.name)),l(z,()=>U.icon,oe),l(z,()=>U.name,G),G.style.setProperty("font-size","0.75rem"),ee.addEventListener("mouseleave",b),ee.addEventListener("mouseenter",()=>S(U.name)),l(ee,B(Ht,{get each(){return U.items},children:J=>B(tc,{get href(){return J.path},style:x,activeClass:"nav-active",onClick:()=>i(null),get children(){return[Te(()=>J.icon)," ",Te(()=>J.label)]}})})),Se(J=>{var W=v,q=p,ae={...I,display:n()===U.name?"block":"none"};return J.e=m(N,W,J.e),J.t=m(z,q,J.t),J.a=m(ee,ae,J.a),J},{e:void 0,t:void 0,a:void 0}),N})()}),null),m(H,Q),l(H,B(QI,{}),F),l(H,B(Ge,{get when(){return Ar.currentUser},get children(){return[(()=>{var U=XI(),N=U.firstChild;return l(U,B(Ge,{get when(){return Ar.currentUser?.photoURL},get children(){var z=e0();return Se(oe=>{var G=Ar.currentUser.photoURL,ee=Z;return G!==oe.e&&Yt(z,"src",oe.e=G),oe.t=m(z,ee,oe.t),oe},{e:void 0,t:void 0}),z}}),N),l(N,()=>Ar.currentUser?.displayName||Ar.currentUser?.email),Se(z=>m(U,K,z)),U})(),(()=>{var U=ZI();return U.addEventListener("mouseleave",N=>{N.currentTarget.style.background="transparent",N.currentTarget.style.color="var(--text-secondary)"}),U.addEventListener("mouseenter",N=>{N.currentTarget.style.background="var(--background-color)",N.currentTarget.style.color="var(--text-primary)"}),U.$$click=C,Se(N=>m(U,k,N)),U})()]}}),F),F.$$click=M,m(F,ne),l(L,B(tc,{href:"/",style:j,activeClass:"nav-active",onClick:()=>r(!1),get children(){return[" ",Te(()=>t("navigation.dashboard"))]}}),null),l(L,B(Ht,{get each(){return te()},children:U=>(()=>{var N=i$(),z=N.firstChild,oe=z.firstChild,G=oe.firstChild,ee=oe.nextSibling;return m(N,P),z.$$click=()=>_(U.name),m(z,w),l(oe,()=>U.icon,G),l(oe,()=>U.name,null),ee.style.setProperty("transition","transform 0.2s"),l(N,B(Ge,{get when(){return n()===U.name},get children(){var J=n$();return J.style.setProperty("background","var(--background-color)"),l(J,B(Ht,{get each(){return U.items},children:W=>B(tc,{get href(){return W.path},get style(){return{...j,"padding-left":"3rem"}},activeClass:"nav-active",onClick:()=>r(!1),get children(){return[Te(()=>W.icon)," ",Te(()=>W.label)]}})})),J}}),null),Se(J=>(J=n()===U.name?"rotate(180deg)":"none")!=null?ee.style.setProperty("transform",J):ee.style.removeProperty("transform")),N})()}),null),l(L,B(Ge,{get when(){return Ar.currentUser},get children(){var U=e$(),N=U.firstChild,z=N.firstChild,oe=N.nextSibling;return U.style.setProperty("padding","1rem"),U.style.setProperty("border-top","2px solid var(--border-color)"),l(N,B(Ge,{get when(){return Ar.currentUser?.photoURL},get children(){var G=e0();return Se(ee=>{var J=Ar.currentUser.photoURL,W=Z;return J!==ee.e&&Yt(G,"src",ee.e=J),ee.t=m(G,W,ee.t),ee},{e:void 0,t:void 0}),G}}),z),l(z,()=>Ar.currentUser?.displayName||Ar.currentUser?.email),oe.$$click=()=>{C(),r(!1)},Se(G=>{var ee={...K,"margin-bottom":"1rem"},J={...k,width:"100%"};return G.e=m(N,ee,G.e),G.t=m(oe,J,G.t),G},{e:void 0,t:void 0}),U}}),null),Se(U=>{var N=a,z=c,oe=e()?"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z":"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z",G={...y,display:e()?"block":"none"};return U.e=m(O,N,U.e),U.t=m(D,z,U.t),oe!==U.a&&Yt($,"d",U.a=oe),U.o=m(L,G,U.o),U},{e:void 0,t:void 0,a:void 0,o:void 0}),O})()};ur(["click"]);var s$=ue("<div><div><div></div><h1></h1><p>.</p><div><p><strong></strong><br></p></div><div><button></button></div><div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><p>"),t0=ue("<br>"),a$=ue("<strong>");const l$=t=>{const{t:e}=tr(),r={"min-height":"calc(100vh - 200px)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},n={"text-align":"center","max-width":"600px",width:"100%"},i={"font-size":"5rem",color:"#e53e3e","margin-bottom":"2rem"},o={"font-size":"2.5rem","font-weight":"700",color:"#1a202c","margin-bottom":"1rem"},s={"font-size":"1.25rem",color:"#718096","margin-bottom":"2rem","line-height":"1.6"},a={background:"#f7fafc",border:"1px solid #e2e8f0","border-radius":"0.5rem",padding:"1.5rem","margin-bottom":"2rem"},c={color:"#4a5568","font-size":"1rem","line-height":"1.6"},u={display:"flex",gap:"1rem","justify-content":"center","flex-wrap":"wrap"},f={padding:"0.75rem 2rem","border-radius":"0.5rem","text-decoration":"none","font-weight":"500",transition:"all 0.2s",display:"inline-block"},y={...f,background:"var(--primary-color)",color:"white",border:"2px solid var(--primary-color)"},v={...f,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},p={"text-align":"left","margin-top":"2rem",padding:"0 2rem"},I={display:"flex","align-items":"center",gap:"0.75rem","margin-bottom":"1rem",color:"#4a5568"},P={color:"#48bb78","font-size":"1.25rem"};return B(ro,{get title(){return e("unauthorized.title")},get children(){var w=s$(),x=w.firstChild,j=x.firstChild,ne=j.nextSibling,Q=ne.nextSibling,K=Q.firstChild,Z=Q.nextSibling,k=Z.firstChild,C=k.firstChild;C.nextSibling;var E=Z.nextSibling,M=E.firstChild,_=E.nextSibling,S=_.firstChild,b=S.nextSibling,Y=b.firstChild,te=Y.nextSibling,O=b.nextSibling,D=O.firstChild,X=D.nextSibling,H=O.nextSibling,F=H.firstChild,ie=F.nextSibling,$=_.nextSibling,L=$.firstChild;return m(w,r),m(x,n),m(j,i),m(ne,o),l(ne,()=>e("unauthorized.accessDenied")),m(Q,s),l(Q,()=>e("unauthorized.noPermission"),K),l(Q,(()=>{var U=Te(()=>!!t.featureName);return()=>U()?` ${t.featureName}`:` ${e("unauthorized.thisFeature")}`})(),K),m(Z,a),m(k,c),l(C,()=>e("unauthorized.whySeeing")),l(k,()=>e("unauthorized.explanation"),null),l(k,(()=>{var U=Te(()=>!!t.requiredPermission);return()=>U()&&[t0(),t0(),(()=>{var N=a$();return l(N,()=>e("unauthorized.requiredPermission")),N})()," ",Te(()=>t.requiredPermission)]})(),null),m(E,u),l(E,B(tc,{href:"/",style:y,get children(){return e("unauthorized.goToDashboard")}}),M),M.$$click=()=>window.history.back(),l(M,()=>e("unauthorized.goBack")),m(_,p),S.style.setProperty("margin-bottom","1rem"),S.style.setProperty("color","#2d3748"),l(S,()=>e("unauthorized.featuresCanAccess")),l(te,()=>e("unauthorized.dashboardAccess")),l(X,()=>e("unauthorized.profileAccess")),l(ie,()=>e("unauthorized.roleBasedAccess")),$.style.setProperty("margin-top","3rem"),$.style.setProperty("padding","1.5rem"),$.style.setProperty("background","#edf2f7"),$.style.setProperty("border-radius","0.5rem"),L.style.setProperty("color","#4a5568"),L.style.setProperty("font-size","0.875rem"),l(L,()=>e("unauthorized.needAccess")),Se(U=>{var N=v,z=I,oe=P,G=I,ee=P,J=I,W=P;return U.e=m(M,N,U.e),U.t=m(b,z,U.t),U.a=m(Y,oe,U.a),U.o=m(O,G,U.o),U.i=m(D,ee,U.i),U.n=m(H,J,U.n),U.s=m(F,W,U.s),U},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),w}})};ur(["click"]);const Io=t=>{const{t:e}=tr(),r=()=>{if(!t.permission)return!0;const i=Ar.state?.profile;if(!i)return!1;if(i.isAdmin)return!0;switch(t.permission){case"AccountAccess":return i.AccountAccess===!0;case"InventoryAccess":return i.InventoryAccess===!0;case"EmployeeAccess":return i.EmployeeAccess===!0;case"BankingAccess":return i.BankingAccess===!0;case"JournalAccess":return i.JournalAccess===!0;case"AdminAccess":return i.isAdmin===!0;default:return i[t.permission]===!0}},n=()=>{if(t.requiredPermission)return t.requiredPermission;switch(t.permission){case"AccountAccess":return e("unauthorized.permissions.accountAccess");case"InventoryAccess":return e("unauthorized.permissions.inventoryAccess");case"EmployeeAccess":return e("unauthorized.permissions.employeeAccess");case"BankingAccess":return e("unauthorized.permissions.bankingAccess");case"JournalAccess":return e("unauthorized.permissions.journalAccess");case"AdminAccess":return e("unauthorized.permissions.adminAccess");default:return t.permission}};return B(Ge,{get when(){return r()},get fallback(){return t.fallback||B(l$,{get featureName(){return t.featureName},get requiredPermission(){return n()}})},get children(){return t.children}})};var c$=ue('<button title="Open Dev Tools">'),u$=ue("<span>(<!>)"),d$=ue("<div><span></span><span>"),r0=ue("<div>"),h$=ue("<div>Database reset only available in fake mode"),f$=ue("<div><div>Loading..."),p$=ue("<div><div><h3> Dev Tools</h3><button></button></div><div><div>API Mode</div><div><button>Fake Server</button><button>Real API</button><button>Hybrid</button></div><div>Current: <strong></strong></div></div><div><div>Health Status</div></div><div><div>Database Stats</div></div><div><div>Actions</div><div><button> Refresh Stats</button><button> Health Check</button></div><div><button> Reset DB</button></div></div><div><div>Info</div><div> <strong>Fake Server:</strong> Uses local mock data<br> <strong>Real API:</strong> Connects to actual backend<br> <strong>Hybrid:</strong> Real API with fake fallback<br> Settings are saved in localStorage"),m$=ue("<div>Loading..."),y$=ue("<div><span>:</span><span>");const g$=()=>{const[t,e]=$e(!1),[r,n]=$e($u.getMode()),[i,o]=$e({}),[s,a]=$e(null),[c,u]=$e(!1);Nn(async()=>{await f(),await y()});const f=async()=>{try{const k=await Pg.getStats();o(k)}catch(k){console.error("Failed to load stats:",k)}},y=async()=>{try{const k=await Pg.healthCheck();a(k)}catch(k){console.error("Health check failed:",k),a({status:"error",error:k.message})}},v=async k=>{u(!0);try{$u.setMode(k),n(k),await f(),await y()}catch(C){console.error("Failed to change API mode:",C)}finally{u(!1)}},p=async()=>{if(confirm("Are you sure you want to reset the fake database to its initial state?")){u(!0);try{const k=await li.utils.resetDatabase();alert(k.message),await f()}catch(k){console.error("Failed to reset database:",k),alert("Failed to reset database")}finally{u(!1)}}},I={position:"fixed",bottom:"20px",right:"20px","z-index":"10000","font-family":"monospace"},P={background:"#1a1a1a",color:"#fff",border:"1px solid #333","border-radius":"8px",padding:"16px","min-width":"300px","max-width":"400px","box-shadow":"0 4px 20px rgba(0,0,0,0.3)"},w={background:"#007acc",color:"#fff",border:"none","border-radius":"50%",width:"50px",height:"50px",cursor:"pointer","font-size":"20px","box-shadow":"0 2px 10px rgba(0,0,0,0.2)",display:"flex","align-items":"center","justify-content":"center"},x={background:"#333",color:"#fff",border:"1px solid #555","border-radius":"4px",padding:"6px 12px",cursor:"pointer","font-size":"12px","margin-right":"8px","margin-bottom":"8px"},j={...x,background:"#007acc","border-color":"#007acc"},ne={"margin-bottom":"16px","padding-bottom":"12px","border-bottom":"1px solid #333"},Q={"font-size":"14px","font-weight":"bold","margin-bottom":"8px",color:"#007acc"},K={display:"flex","justify-content":"space-between","font-size":"12px","margin-bottom":"4px"},Z=k=>({display:"inline-block",width:"8px",height:"8px","border-radius":"50%","margin-right":"8px",background:k==="healthy"?"#00ff00":k==="error"?"#ff0000":"#ffff00"});return(()=>{var k=r0();return l(k,B(Ge,{get when(){return!t()},get children(){var C=c$();return C.$$click=()=>e(!0),m(C,w),C}}),null),l(k,B(Ge,{get when(){return t()},get children(){var C=p$(),E=C.firstChild,M=E.firstChild,_=M.nextSibling,S=E.nextSibling,b=S.firstChild,Y=b.nextSibling,te=Y.firstChild,O=te.nextSibling,D=O.nextSibling,X=Y.nextSibling,H=X.firstChild,F=H.nextSibling,ie=S.nextSibling,$=ie.firstChild,L=ie.nextSibling,U=L.firstChild,N=L.nextSibling,z=N.firstChild,oe=z.nextSibling,G=oe.firstChild,ee=G.nextSibling,J=oe.nextSibling,W=J.firstChild,q=N.nextSibling,ae=q.firstChild,de=ae.nextSibling;return m(C,P),E.style.setProperty("display","flex"),E.style.setProperty("justify-content","space-between"),E.style.setProperty("align-items","center"),E.style.setProperty("margin-bottom","16px"),M.style.setProperty("margin","0"),M.style.setProperty("color","#007acc"),M.style.setProperty("font-size","16px"),_.$$click=()=>e(!1),te.$$click=()=>v("fake"),O.$$click=()=>v("real"),D.$$click=()=>v("hybrid"),X.style.setProperty("font-size","11px"),X.style.setProperty("color","#888"),X.style.setProperty("margin-top","4px"),l(F,r),l(X,()=>r()==="fake"&&" (Using fake server)",null),l(X,()=>r()==="real"&&" (Using real API)",null),l(X,()=>r()==="hybrid"&&" (Real API with fallback)",null),l(ie,B(Ge,{get when(){return s()},get fallback(){return(()=>{var le=m$();return le.style.setProperty("font-size","12px"),le})()},get children(){return[(()=>{var le=d$(),V=le.firstChild,ce=V.nextSibling;return le.style.setProperty("display","flex"),le.style.setProperty("align-items","center"),le.style.setProperty("font-size","12px"),l(ce,()=>s()?.status||"Unknown"),l(le,B(Ge,{get when(){return s()?.timestamp},get children(){var Pe=u$(),fe=Pe.firstChild,be=fe.nextSibling;return be.nextSibling,Pe.style.setProperty("margin-left","8px"),Pe.style.setProperty("color","#888"),l(Pe,()=>new Date(s().timestamp).toLocaleTimeString(),be),Pe}}),null),Se(Pe=>m(V,Z(s()?.status||"unknown"),Pe)),le})(),B(Ge,{get when(){return s()?.error},get children(){var le=r0();return le.style.setProperty("font-size","11px"),le.style.setProperty("color","#ff6666"),le.style.setProperty("margin-top","4px"),l(le,()=>s().error),le}})]}}),null),l(L,B(Ht,{get each(){return Object.entries(i())},children:([le,V])=>(()=>{var ce=y$(),Pe=ce.firstChild,fe=Pe.firstChild,be=Pe.nextSibling;return m(ce,K),Pe.style.setProperty("text-transform","capitalize"),l(Pe,le,fe),be.style.setProperty("color","#00ff00"),l(be,V),ce})()}),null),G.$$click=f,ee.$$click=y,J.style.setProperty("margin-top","8px"),W.$$click=p,l(N,B(Ge,{get when(){return r()!=="fake"},get children(){var le=h$();return le.style.setProperty("font-size","11px"),le.style.setProperty("color","#888"),le.style.setProperty("margin-top","4px"),le}}),null),de.style.setProperty("font-size","11px"),de.style.setProperty("color","#888"),de.style.setProperty("line-height","1.4"),l(C,B(Ge,{get when(){return c()},get children(){var le=f$(),V=le.firstChild;return le.style.setProperty("position","absolute"),le.style.setProperty("top","0"),le.style.setProperty("left","0"),le.style.setProperty("right","0"),le.style.setProperty("bottom","0"),le.style.setProperty("background","rgba(0,0,0,0.7)"),le.style.setProperty("display","flex"),le.style.setProperty("align-items","center"),le.style.setProperty("justify-content","center"),le.style.setProperty("border-radius","8px"),V.style.setProperty("color","#fff"),V.style.setProperty("font-size","14px"),le}}),null),Se(le=>{var V={...x,padding:"4px 8px"},ce=ne,Pe=Q,fe=r()==="fake"?j:x,be=c(),xe=r()==="real"?j:x,he=c(),ve=r()==="hybrid"?j:x,De=c(),Ee=ne,Ce=Q,Ne=ne,Ie=Q,Re=ne,We=Q,Fe=x,Xe=c(),tt=x,At=c(),rt={...x,background:"#cc4400","border-color":"#cc4400"},He=c()||r()!=="fake",xt=Q;return le.e=m(_,V,le.e),le.t=m(S,ce,le.t),le.a=m(b,Pe,le.a),le.o=m(te,fe,le.o),be!==le.i&&(te.disabled=le.i=be),le.n=m(O,xe,le.n),he!==le.s&&(O.disabled=le.s=he),le.h=m(D,ve,le.h),De!==le.r&&(D.disabled=le.r=De),le.d=m(ie,Ee,le.d),le.l=m($,Ce,le.l),le.u=m(L,Ne,le.u),le.c=m(U,Ie,le.c),le.w=m(N,Re,le.w),le.m=m(z,We,le.m),le.f=m(G,Fe,le.f),Xe!==le.y&&(G.disabled=le.y=Xe),le.g=m(ee,tt,le.g),At!==le.p&&(ee.disabled=le.p=At),le.b=m(W,rt,le.b),He!==le.T&&(W.disabled=le.T=He),le.A=m(ae,xt,le.A),le},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),C}}),null),Se(C=>m(k,I,C)),k})()};ur(["click"]);const v$=[{id:"1",accountNumber:"1000",name:"Cash and Cash Equivalents",type:"Asset",category:"Current Assets",description:"Cash on hand and in bank accounts",balance:45230.5,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1001",accountNumber:"1001",name:"Petty Cash",type:"Asset",category:"Current Assets",description:"Small amounts of cash for minor expenses",balance:500,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1002",accountNumber:"1002",name:"Bank - Checking Account",type:"Asset",category:"Current Assets",description:"Main operating checking account",balance:32730.5,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1003",accountNumber:"1003",name:"Bank - Savings Account",type:"Asset",category:"Current Assets",description:"Interest-bearing savings account",balance:12e3,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"2",accountNumber:"1100",name:"Accounts Receivable",type:"Asset",category:"Current Assets",description:"Money owed by customers",balance:23450.75,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2001",accountNumber:"1101",name:"Trade Receivables",type:"Asset",category:"Current Assets",description:"Receivables from regular customers",balance:18450.75,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2002",accountNumber:"1102",name:"Employee Advances",type:"Asset",category:"Current Assets",description:"Money advanced to employees",balance:5e3,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"3",accountNumber:"1200",name:"Inventory",type:"Asset",category:"Current Assets",description:"Products held for sale",balance:78920.25,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-13"},{id:"4",accountNumber:"1500",name:"Equipment",type:"Asset",category:"Fixed Assets",description:"Office equipment and machinery",balance:125e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-12"},{id:"5",accountNumber:"2000",name:"Accounts Payable",type:"Liability",category:"Current Liabilities",description:"Money owed to suppliers",balance:15670.3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-11"},{id:"6",accountNumber:"2100",name:"Accrued Expenses",type:"Liability",category:"Current Liabilities",description:"Expenses incurred but not yet paid",balance:8945.6,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-10"},{id:"7",accountNumber:"2500",name:"Long-term Debt",type:"Liability",category:"Long-term Liabilities",description:"Long-term loans and mortgages",balance:85e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-09"},{id:"8",accountNumber:"3000",name:"Owner's Equity",type:"Equity",category:"Owner's Equity",description:"Owner's investment in the business",balance:15e4,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-08"},{id:"9",accountNumber:"3100",name:"Retained Earnings",type:"Equity",category:"Owner's Equity",description:"Accumulated profits retained in business",balance:32450.8,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-07"},{id:"10",accountNumber:"4000",name:"Sales Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from product sales",balance:245678.9,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-06"},{id:"11",accountNumber:"4100",name:"Service Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from services provided",balance:89432.15,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-05"},{id:"12",accountNumber:"5000",name:"Cost of Goods Sold",type:"Expense",category:"Operating Expenses",description:"Direct costs of producing goods",balance:125678.45,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-04"},{id:"13",accountNumber:"5100",name:"Salaries Expense",type:"Expense",category:"Operating Expenses",description:"Employee salary expenses",balance:98765.32,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-03"},{id:"14",accountNumber:"5200",name:"Rent Expense",type:"Expense",category:"Operating Expenses",description:"Office rent expenses",balance:24e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-02"}],b$=[{id:"1",accountId:"1",date:"2024-01-15",description:"Customer payment received",debitAmount:5e3,creditAmount:0,reference:"INV-2024-001",type:"debit"},{id:"2",accountId:"2",date:"2024-01-15",description:"Customer payment received",debitAmount:0,creditAmount:5e3,reference:"INV-2024-001",type:"credit"},{id:"3",accountId:"5",date:"2024-01-14",description:"Office supplies purchased",debitAmount:0,creditAmount:1250,reference:"PO-2024-001",type:"credit"}],[Wo,Nd]=$e(v$),[Yf,_$]=$e(b$),kr={get accounts(){return Wo()},get transactions(){return Yf()},fetchAllAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return Nd([...Wo(),e]),e},addAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return Nd([...Wo(),e]),e},updateAccount(t,e){Nd(Wo().map(r=>r.id===t?{...r,...e,lastModified:new Date().toISOString().split("T")[0]}:r))},deleteAccount(t){Nd(Wo().filter(e=>e.id!==t))},getAccountById(t){return Wo().find(e=>e.id===t)},getAccountsByType(t){return Wo().filter(e=>e.type===t)},getAccountTransactions(t){return Yf().filter(e=>e.accountId===t)},addTransaction(t){const e={...t,id:Date.now().toString()};_$([...Yf(),e]);const r=this.getAccountById(t.accountId);if(r){const n=t.type==="debit"?t.debitAmount:-t.creditAmount;this.updateAccount(t.accountId,{balance:r.balance+n})}return e},getTotalByType(t){return Wo().filter(e=>e.type===t&&e.isActive).reduce((e,r)=>e+r.balance,0)},getAccountCategories(t){const e=this.getAccountsByType(t);return[...new Set(e.map(r=>r.category))]},getSubAccounts(t){return Wo().filter(e=>e.parentAccountId===t)},getParentAccounts(){return Wo().filter(t=>!t.parentAccountId)},getAccountHierarchy(){return this.getParentAccounts().map(e=>({...e,subAccounts:this.getSubAccounts(e.id)}))},getAccountWithSubAccounts(t){const e=this.getAccountById(t);return e?{...e,subAccounts:this.getSubAccounts(t),parentAccount:e.parentAccountId?this.getAccountById(e.parentAccountId):null}:null},getAccountPath(t){const e=this.getAccountById(t);if(!e)return[];const r=[e];let n=e;for(;n.parentAccountId;){const i=this.getAccountById(n.parentAccountId);if(i)r.unshift(i),n=i;else break}return r},getTotalBalanceWithSubAccounts(t){const e=this.getAccountById(t);if(!e)return 0;const n=this.getSubAccounts(t).reduce((i,o)=>i+this.getTotalBalanceWithSubAccounts(o.id),0);return e.balance+n},canDeleteAccount(t){const e=this.getSubAccounts(t);if(e.length>0)return{canDelete:!1,reason:`Account has ${e.length} sub-account(s). Delete or move sub-accounts first.`};const r=this.getAccountTransactions(t);return r.length>0?{canDelete:!1,reason:`Account has ${r.length} transaction(s). Cannot delete account with transaction history.`}:{canDelete:!0}}};var ua=ue("<div>"),Wc=ue("<div> ");const w$=()=>{const{t}=tr(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},n={"font-size":"0.875rem",color:"var(--text-muted)"},i=P=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(P),o=kr.getTotalByType("Asset"),s=kr.getTotalByType("Liability"),a=kr.getTotalByType("Equity"),c=kr.getTotalByType("Revenue"),u=kr.getTotalByType("Expense"),f=kr.getAccountsByType("Asset").length,y=kr.getAccountsByType("Liability").length,v=kr.getAccountsByType("Equity").length,p=kr.getAccountsByType("Revenue").length,I=kr.getAccountsByType("Expense").length;return(()=>{var P=ua();return m(P,e),l(P,B(Tt,{get title(){return t("dashboard.totalAssets")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var w=ua();return l(w,()=>i(o)),Se(x=>m(w,r,x)),w})(),(()=>{var w=Wc(),x=w.firstChild;return l(w,f,x),l(w,()=>t("navigation.accounts"),null),Se(j=>m(w,n,j)),w})()]}}),null),l(P,B(Tt,{get title(){return t("dashboard.totalLiabilities")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var w=ua();return l(w,()=>i(s)),Se(x=>m(w,r,x)),w})(),(()=>{var w=Wc(),x=w.firstChild;return l(w,y,x),l(w,()=>t("navigation.accounts"),null),Se(j=>m(w,n,j)),w})()]}}),null),l(P,B(Tt,{get title(){return t("dashboard.totalEquity")},get subtitle(){return t("accounts.categories.ownersEquity")},get children(){return[(()=>{var w=ua();return l(w,()=>i(a)),Se(x=>m(w,r,x)),w})(),(()=>{var w=Wc(),x=w.firstChild;return l(w,v,x),l(w,()=>t("navigation.accounts"),null),Se(j=>m(w,n,j)),w})()]}}),null),l(P,B(Tt,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("accounts.categories.operatingRevenue")},get children(){return[(()=>{var w=ua();return l(w,()=>i(c)),Se(x=>m(w,r,x)),w})(),(()=>{var w=Wc(),x=w.firstChild;return l(w,p,x),l(w,()=>t("navigation.accounts"),null),Se(j=>m(w,n,j)),w})()]}}),null),l(P,B(Tt,{get title(){return t("dashboard.totalExpenses")},get subtitle(){return t("accounts.categories.operatingExpenses")},get children(){return[(()=>{var w=ua();return l(w,()=>i(u)),Se(x=>m(w,r,x)),w})(),(()=>{var w=Wc(),x=w.firstChild;return l(w,I,x),l(w,()=>t("navigation.accounts"),null),Se(j=>m(w,n,j)),w})()]}}),null),l(P,B(Tt,{get title(){return t("dashboard.netIncome")},get subtitle(){return`${t("dashboard.totalRevenue")} - ${t("dashboard.totalExpenses")}`},get children(){return[(()=>{var w=ua();return l(w,()=>i(c-u)),Se(x=>m(w,{...r,color:c-u>=0?"#4caf50":"#f44336"},x)),w})(),(()=>{var w=ua();return l(w,()=>c-u>=0?t("dashboard.netIncome"):t("dashboard.netLoss")),Se(x=>m(w,n,x)),w})()]}}),null),P})()};var S$=ue("<div><div></div><div>"),P$=ue("<h3>"),Gc=ue("<div>");const x$=t=>{const{t:e}=tr();Lm();const r={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},i={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"},o={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},s={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},a={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem"},c={"font-size":"0.875rem",color:"var(--text-secondary)","line-height":"1.4"},u=v=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[v]||{bg:"#f5f5f5",color:"#666"},f=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(v),y=u(t.account.type);return B(Tt,{get children(){return[(()=>{var v=S$(),p=v.firstChild,I=p.nextSibling;return m(v,n),m(p,i),l(p,()=>t.account.accountNumber),l(I,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),Se(P=>m(I,{...o,background:y.bg,color:y.color},P)),v})(),(()=>{var v=P$();return v.style.setProperty("margin","0 0 0.5rem 0"),v.style.setProperty("font-size","1.1rem"),l(v,()=>t.account.name),v})(),(()=>{var v=Gc();return m(v,a),l(v,()=>t.account.category),v})(),(()=>{var v=Gc();return m(v,s),l(v,()=>f(t.account.balance)),v})(),(()=>{var v=Gc();return m(v,c),l(v,()=>t.account.description),v})(),Te(()=>Te(()=>!t.account.isActive)()&&(()=>{var v=Gc();return v.style.setProperty("margin-top","0.5rem"),v.style.setProperty("padding","0.25rem 0.75rem"),v.style.setProperty("border-radius","9999px"),v.style.setProperty("font-size","0.75rem"),v.style.setProperty("font-weight","500"),v.style.setProperty("background","#ffebee"),v.style.setProperty("color","#d32f2f"),v.style.setProperty("text-align","center"),l(v,()=>e("common.inactive")),v})()),(()=>{var v=Gc();return m(v,r),l(v,B(Pt,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.account),get children(){return[Te(()=>e("common.view"))," ",Te(()=>e("accounts.accountDetails"))]}})),v})()]}})};var A$=ue("<div><div><div><div></div><h3></h3></div></div><div><div></div><div>"),C$=ue("<div>"),I$=ue("<button>"),$$=ue("<div><h4> (<!>)"),k$=ue("<div><div><div></div><div>  </div></div><div>");const E$=t=>{const{t:e}=tr(),r=Lm(),[n,i]=$e(!0),o={"margin-bottom":"1rem"},s={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},a={display:"flex","align-items":"center",gap:"1rem"},c={background:"none",border:"none",cursor:"pointer","font-size":"1.2rem",color:"var(--text-muted)",padding:"0.25rem","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease"},u={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},f={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},y={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},v={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},p={"margin-left":"1rem","border-left":"2px solid var(--border-color)","padding-left":"1rem","margin-top":"1rem"},I={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem","margin-bottom":"0.5rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},P={flex:"1"},w={"font-weight":"500","margin-bottom":"0.25rem"},x={"font-size":"0.875rem",color:"var(--text-muted)"},j={"font-weight":"600",color:"var(--primary-color)"},ne={display:"flex",gap:"0.5rem"},Q=M=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[M]||{bg:"#f5f5f5",color:"#666"},K=M=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(M),Z=M=>{t.onViewDetails?t.onViewDetails(M):r(`/accounts/${M.id}`)},k=()=>{t.onAddSubAccount&&t.onAddSubAccount(t.account)},C=t.account.balance+t.account.subAccounts.reduce((M,_)=>M+_.balance,0),E=Q(t.account.type);return B(Tt,{className:"account-hierarchy-card",style:o,get children(){return[(()=>{var M=A$(),_=M.firstChild,S=_.firstChild,b=S.firstChild,Y=b.nextSibling,te=_.nextSibling,O=te.firstChild,D=O.nextSibling;return m(M,s),m(_,a),l(_,(()=>{var X=Te(()=>t.account.subAccounts.length>0);return()=>X()&&(()=>{var H=I$();return H.addEventListener("mouseleave",F=>F.target.style.background="none"),H.addEventListener("mouseenter",F=>F.target.style.background="var(--background-color)"),H.$$click=()=>i(!n()),m(H,c),l(H,()=>n()?"":""),H})()})(),S),S.$$click=()=>Z(t.account),S.style.setProperty("cursor","pointer"),m(b,u),l(b,()=>t.account.accountNumber),m(Y,f),l(Y,()=>t.account.name),te.style.setProperty("text-align","right"),m(O,y),l(O,()=>K(C)),l(D,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),Se(X=>m(D,{...v,background:E.bg,color:E.color},X)),M})(),(()=>{var M=C$();return m(M,ne),l(M,B(Pt,{variant:"secondary",size:"sm",onClick:()=>Z(t.account),get children(){return[Te(()=>e("common.view"))," ",Te(()=>e("accounts.accountDetails"))]}}),null),l(M,B(Pt,{variant:"outline",size:"sm",onClick:k,get children(){return[Te(()=>e("common.add"))," ",Te(()=>e("accounts.subAccounts"))]}}),null),M})(),Te(()=>Te(()=>!!(n()&&t.account.subAccounts.length>0))()&&(()=>{var M=$$(),_=M.firstChild,S=_.firstChild,b=S.nextSibling;return b.nextSibling,m(M,p),_.style.setProperty("margin","0 0 1rem 0"),_.style.setProperty("font-size","1rem"),_.style.setProperty("color","var(--text-muted)"),l(_,()=>e("accounts.subAccounts"),S),l(_,()=>t.account.subAccounts.length,b),l(M,()=>t.account.subAccounts.map(Y=>(()=>{var te=k$(),O=te.firstChild,D=O.firstChild,X=D.nextSibling,H=X.firstChild,F=O.nextSibling;return te.addEventListener("mouseleave",ie=>{ie.currentTarget.style.background="var(--background-color)",ie.currentTarget.style.transform="translateY(0)"}),te.addEventListener("mouseenter",ie=>{ie.currentTarget.style.background="var(--surface-color)",ie.currentTarget.style.transform="translateY(-1px)"}),te.$$click=()=>Z(Y),m(te,I),m(O,P),m(D,w),l(D,()=>Y.name),m(X,x),l(X,()=>Y.accountNumber,H),l(X,()=>Y.description,null),m(F,j),l(F,()=>K(Y.balance)),te})()),null),M})())]}})};ur(["click"]);var T$=ue("<form><div>");const N$=t=>{const{t:e}=tr(),[r,n]=$e({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),i=[{value:"Asset",label:e("accounts.types.asset"),type:"debit",classification:"real"},{value:"Liability",label:e("accounts.types.liability"),type:"credit",classification:"real"},{value:"Equity",label:e("accounts.types.equity"),type:"credit",classification:"real"},{value:"Revenue",label:e("accounts.types.revenue"),type:"credit",classification:"nominal"},{value:"Expense",label:e("accounts.types.expense"),type:"debit",classification:"nominal"}],o=()=>{const f=r().type;return f?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")},{value:"Sales Revenue",label:e("accounts.categories.salesRevenue")},{value:"Service Revenue",label:e("accounts.categories.servicesRevenue")},{value:"Subscription Revenue",label:e("accounts.categories.subscriptionRevenue")},{value:"Rental Revenue",label:e("accounts.categories.rentalRevenue")},{value:"Commission Revenue",label:e("accounts.categories.commissionRevenue")},{value:"Franchise Revenue",label:e("accounts.categories.franchiseRevenue")},{value:"Licensing Revenue",label:e("accounts.categories.licensingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[f]||[]:[]},s=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],a={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},c=f=>{f.preventDefault();const y=r();if(!y.accountNumber||!y.name||!y.type||!y.category){alert(e("forms.requiredField"));return}if(kr.accounts.find(I=>I.accountNumber===y.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const p={accountNumber:y.accountNumber,name:y.name,type:y.type,category:y.category,description:y.description,balance:parseFloat(y.balance)||0,isActive:y.isActive==="true"};kr.addAccount(p),n({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},u=(f,y)=>{n(v=>{const p={...v,[f]:y};return f==="type"&&(p.category=""),p})};return B(Qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.addAccount")},get children(){var f=T$(),y=f.firstChild;return f.addEventListener("submit",c),l(f,B(Or,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:v=>u("accountNumber",v),get placeholder(){return e("accounts.accountNumber")},required:!0}),y),l(f,B(Or,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:v=>u("name",v),get placeholder(){return e("accounts.accountName")},required:!0}),y),l(f,B(ci,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:v=>u("type",v),options:i,required:!0}),y),l(f,B(ci,{get label(){return e("accounts.category")},get value(){return r().category},onChange:v=>u("category",v),get options(){return o()},required:!0}),y),l(f,B(Or,{get label(){return e("common.description")},get value(){return r().description},onChange:v=>u("description",v),get placeholder(){return e("common.description")}}),y),l(f,B(Or,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:v=>u("balance",v),get placeholder(){return e("accounts.balance")}}),y),l(f,B(ci,{get label(){return e("common.status")},get value(){return r().isActive},onChange:v=>u("isActive",v),options:s,required:!0}),y),m(y,a),l(y,B(Pt,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),l(y,B(Pt,{variant:"primary",type:"submit",get children(){return e("accounts.addAccount")}}),null),f}})};var L$=ue("<form><div>"),D$=ue("<div><div></div><div> - </div><div>  ");const R$=t=>{const{t:e}=tr(),[r,n]=$e({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),i=()=>t.parentAccount?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[t.parentAccount.type]||[]:[],o=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],s={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},a={background:"var(--background-color)",padding:"1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1.5rem",border:"1px solid var(--border-color)"},c={"font-size":"0.875rem","font-weight":"500",color:"var(--text-muted)","margin-bottom":"0.5rem"},u={"font-weight":"600",color:"var(--text-primary)"},f={"font-size":"0.875rem",color:"var(--text-secondary)"},y=P=>{P.preventDefault();const w=r();if(!w.accountNumber||!w.name||!w.category||!t.parentAccount){alert(e("forms.requiredField"));return}if(kr.accounts.find(ne=>ne.accountNumber===w.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const j={accountNumber:w.accountNumber,name:w.name,type:t.parentAccount.type,category:w.category,description:w.description,balance:parseFloat(w.balance)||0,isActive:w.isActive==="true",parentAccountId:t.parentAccount.id};kr.addAccount(j),n({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},v=(P,w)=>{n(x=>({...x,[P]:w}))},p=()=>{if(!t.parentAccount)return"";const P=t.parentAccount.accountNumber,x=kr.getSubAccounts(t.parentAccount.id).length+1;return(parseInt(P)+x).toString()},I=()=>r().accountNumber===""&&t.parentAccount?p():r().accountNumber;return B(Qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return`${e("common.add")} ${e("accounts.subAccounts")}`},get children(){return[Te(()=>Te(()=>!!t.parentAccount)()&&(()=>{var P=D$(),w=P.firstChild,x=w.nextSibling,j=x.firstChild,ne=x.nextSibling,Q=ne.firstChild;return m(P,a),m(w,c),l(w,()=>e("accounts.parentAccount")),m(x,u),l(x,()=>t.parentAccount.accountNumber,j),l(x,()=>t.parentAccount.name,null),m(ne,f),l(ne,()=>e(`accounts.types.${t.parentAccount.type.toLowerCase()}`),Q),l(ne,()=>t.parentAccount.category,null),P})()),(()=>{var P=L$(),w=P.firstChild;return P.addEventListener("submit",y),l(P,B(Or,{get label(){return e("accounts.accountNumber")},get value(){return I()},onChange:x=>v("accountNumber",x),get placeholder(){return`${e("common.suggested")}: ${p()}`},required:!0}),w),l(P,B(Or,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:x=>v("name",x),get placeholder(){return e("accounts.accountName")},required:!0}),w),l(P,B(ci,{get label(){return e("accounts.category")},get value(){return r().category},onChange:x=>v("category",x),get options(){return i()},required:!0}),w),l(P,B(Or,{get label(){return e("common.description")},get value(){return r().description},onChange:x=>v("description",x),get placeholder(){return e("common.description")}}),w),l(P,B(Or,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:x=>v("balance",x),get placeholder(){return e("accounts.balance")}}),w),l(P,B(ci,{get label(){return e("common.status")},get value(){return r().isActive},onChange:x=>v("isActive",x),options:o,required:!0}),w),m(w,s),l(w,B(Pt,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),l(w,B(Pt,{variant:"primary",type:"submit",get children(){return[Te(()=>e("common.add"))," ",Te(()=>e("accounts.subAccounts"))]}}),null),P})()]}})};var M$=ue("<form><div>"),F$=ue("<div>");const O$=t=>{const{t:e}=tr(),[r,n]=$e({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),[i,o]=$e(null);vo(()=>{t.account&&(n({accountNumber:t.account.accountNumber,name:t.account.name,type:t.account.type,category:t.account.category,description:t.account.description,balance:t.account.balance.toString(),isActive:t.account.isActive.toString()}),o(null))});const s=[{value:"Asset",label:e("accounts.types.asset")},{value:"Liability",label:e("accounts.types.liability")},{value:"Equity",label:e("accounts.types.equity")},{value:"Revenue",label:e("accounts.types.revenue")},{value:"Expense",label:e("accounts.types.expense")}],a=()=>{const p=r().type;return p?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[p]||[]:[]},c=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],u={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},f=p=>{if(p.preventDefault(),o(null),!t.account)return;const I=r();if(!I.accountNumber||!I.name||!I.type||!I.category){o(e("forms.requiredField"));return}if(kr.accounts.find(x=>x.accountNumber===I.accountNumber&&x.id!==t.account.id)){o(e("forms.duplicateAccountNumber"));return}const w={accountNumber:I.accountNumber,name:I.name,type:I.type,category:I.category,description:I.description,balance:parseFloat(I.balance)||0,isActive:I.isActive==="true"};try{kr.updateAccount(t.account.id,w),t.onClose()}catch(x){o(x instanceof Error?x.message:e("forms.saveError"))}},y=()=>{if(!t.account)return;const p=kr.canDeleteAccount(t.account.id);if(!p.canDelete){o(p.reason||e("forms.deleteError"));return}const I=e("forms.confirmDelete");if(confirm(I))try{kr.deleteAccount(t.account.id),t.onClose()}catch(P){o(P instanceof Error?P.message:e("forms.deleteError"))}},v=(p,I)=>{n(P=>{const w={...P,[p]:I};return p==="type"&&(w.category=""),w}),i()&&o(null)};return t.account?B(Qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.editAccount")},get children(){var p=M$(),I=p.firstChild;return p.addEventListener("submit",f),l(p,B(Or,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:P=>v("accountNumber",P),get placeholder(){return e("accounts.accountNumber")},required:!0}),I),l(p,B(Or,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:P=>v("name",P),get placeholder(){return e("accounts.accountName")},required:!0}),I),l(p,B(ci,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:P=>v("type",P),options:s,required:!0}),I),l(p,B(ci,{get label(){return e("accounts.category")},get value(){return r().category},onChange:P=>v("category",P),get options(){return a()},required:!0}),I),l(p,B(Or,{get label(){return e("common.description")},get value(){return r().description},onChange:P=>v("description",P),get placeholder(){return e("common.description")}}),I),l(p,B(Or,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:P=>v("balance",P),get placeholder(){return e("accounts.balance")}}),I),l(p,B(ci,{get label(){return e("common.status")},get value(){return r().isActive},onChange:P=>v("isActive",P),options:c,required:!0}),I),l(p,(()=>{var P=Te(()=>!!i());return()=>P()&&(()=>{var w=F$();return w.style.setProperty("padding","1rem"),w.style.setProperty("border-radius","var(--border-radius-sm)"),w.style.setProperty("margin-top","1rem"),w.style.setProperty("background","#f8d7da"),w.style.setProperty("color","#721c24"),w.style.setProperty("border","1px solid #f5c6cb"),l(w,i),w})()})(),I),m(I,u),l(I,B(Pt,{variant:"outline",type:"button",onClick:y,style:{color:"#dc3545","border-color":"#dc3545","margin-right":"auto"},get children(){return e("accounts.deleteAccount")}}),null),l(I,B(Pt,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),l(I,B(Pt,{variant:"primary",type:"submit",get children(){return e("common.save")}}),null),p}}):null};var B$=ue("<div><div></div><div></div><div></div><div>"),j$=ue("<div><div></div><div></div><div>"),V$=ue("<div><button></button><button> (<!>)"),Kf=ue("<div>"),z$=ue("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),q$=ue("<div><div><div></div><div>  </div></div><div>");const U$=t=>{const{t:e}=tr(),[r,n]=$e("details"),[i,o]=$e(!1),s=Nt(()=>t.account?kr.getAccountById(t.account.id)||t.account:null),a={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},c={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},u={"font-weight":"600",color:"var(--text-primary)"},f={"text-align":"center","margin-bottom":"2rem"},y={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},v={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},p={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem"},I={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},P=E=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:E?"var(--primary-color)":"var(--text-muted)","border-bottom":E?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),w={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},x={flex:"1"},j={"font-size":"0.875rem",color:"var(--text-muted)"},ne={"font-weight":"500","margin-bottom":"0.25rem"},Q=E=>({"font-weight":"600",color:E==="debit"?"#4caf50":"#f44336"}),K={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},Z=E=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[E]||{bg:"#f5f5f5",color:"#666"},k=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E),C=E=>new Date(E).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return B(Qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.accountDetails")},get children(){return[Te(()=>Te(()=>!s())()?(()=>{var E=B$(),M=E.firstChild,_=M.nextSibling,S=_.nextSibling,b=S.nextSibling;return E.style.setProperty("text-align","center"),E.style.setProperty("padding","3rem"),E.style.setProperty("color","var(--text-muted)"),M.style.setProperty("font-size","1.5rem"),M.style.setProperty("margin-bottom","1rem"),_.style.setProperty("font-size","1.1rem"),_.style.setProperty("margin-bottom","0.5rem"),l(_,()=>e("common.error")),S.style.setProperty("font-size","0.875rem"),l(S,()=>e("common.noDataFound")),b.style.setProperty("margin-top","2rem"),l(b,B(Pt,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),E})():(()=>{const E=Nt(()=>Z(s().type)),M=Nt(()=>kr.getAccountTransactions(s().id));return[(()=>{var _=j$(),S=_.firstChild,b=S.nextSibling,Y=b.nextSibling;return m(_,f),m(S,y),l(S,()=>s().name),m(b,v),l(b,()=>k(s().balance)),l(Y,()=>e(`accounts.types.${s().type.toLowerCase()}`)),Se(te=>m(Y,{...p,background:E().bg,color:E().color},te)),_})(),(()=>{var _=V$(),S=_.firstChild,b=S.nextSibling,Y=b.firstChild,te=Y.nextSibling;return te.nextSibling,m(_,I),S.$$click=()=>n("details"),l(S,()=>e("accounts.accountDetails")),b.$$click=()=>n("transactions"),l(b,()=>e("accounts.transactions"),Y),l(b,()=>M().length,te),Se(O=>{var D=P(r()==="details"),X=P(r()==="transactions");return O.e=m(S,D,O.e),O.t=m(b,X,O.t),O},{e:void 0,t:void 0}),_})(),Te(()=>Te(()=>r()==="details")()&&(()=>{var _=z$(),S=_.firstChild,b=S.firstChild,Y=b.nextSibling,te=S.nextSibling,O=te.firstChild,D=O.nextSibling,X=te.nextSibling,H=X.firstChild,F=H.nextSibling,ie=X.nextSibling,$=ie.firstChild,L=$.nextSibling,U=ie.nextSibling,N=U.firstChild,z=N.nextSibling,oe=U.nextSibling,G=oe.firstChild,ee=G.nextSibling;return l(b,()=>e("accounts.accountNumber")),l(Y,()=>s().accountNumber),l(O,()=>e("accounts.category")),l(D,()=>s().category),l(H,()=>e("common.description")),l(F,()=>s().description),l($,()=>e("common.status")),l(L,(()=>{var J=Te(()=>!!s().isActive);return()=>J()?e("common.active"):e("common.inactive")})()),l(N,()=>e("accounts.createdDate")),l(z,()=>C(s().createdDate)),l(G,()=>e("accounts.lastModified")),l(ee,()=>C(s().lastModified)),Se(J=>{var W=a,q=c,ae=u,de=a,le=c,V=u,ce=a,Pe=c,fe=u,be=a,xe=c,he=u,ve=a,De=c,Ee=u,Ce=a,Ne=c,Ie=u;return J.e=m(S,W,J.e),J.t=m(b,q,J.t),J.a=m(Y,ae,J.a),J.o=m(te,de,J.o),J.i=m(O,le,J.i),J.n=m(D,V,J.n),J.s=m(X,ce,J.s),J.h=m(H,Pe,J.h),J.r=m(F,fe,J.r),J.d=m(ie,be,J.d),J.l=m($,xe,J.l),J.u=m(L,he,J.u),J.c=m(U,ve,J.c),J.w=m(N,De,J.w),J.m=m(z,Ee,J.m),J.f=m(oe,Ce,J.f),J.y=m(G,Ne,J.y),J.g=m(ee,Ie,J.g),J},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),_})()),Te(()=>Te(()=>r()==="transactions")()&&(()=>{var _=Kf();return l(_,(()=>{var S=Te(()=>M().length===0);return()=>S()?(()=>{var b=Kf();return b.style.setProperty("text-align","center"),b.style.setProperty("color","var(--text-muted)"),b.style.setProperty("padding","2rem"),l(b,()=>e("common.noDataFound")),b})():M().map(b=>(()=>{var Y=q$(),te=Y.firstChild,O=te.firstChild,D=O.nextSibling,X=D.firstChild,H=te.nextSibling;return m(Y,w),m(te,x),m(O,ne),l(O,()=>b.description),m(D,j),l(D,()=>C(b.date),X),l(D,()=>b.reference,null),l(H,()=>b.type==="debit"?"+":"-",null),l(H,()=>k(b.type==="debit"?b.debitAmount:b.creditAmount),null),Se(F=>m(H,Q(b.type),F)),Y})())})()),_})()),(()=>{var _=Kf();return m(_,K),l(_,B(Pt,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),l(_,B(Pt,{variant:"primary",onClick:()=>o(!0),get children(){return e("accounts.editAccount")}}),null),_})()]})()),Te(()=>Te(()=>!!s())()&&B(O$,{get isOpen(){return i()},onClose:()=>{o(!1)},get account(){return s()}}))]}})};ur(["click"]);const H$="https://qvamarkets.com/gql_api",[W$,n0]=$e(!1),[G$,Jf]=$e(null);class Y${baseUrl;constructor(e=H$){this.baseUrl=e}async request(e,r,n,i){n0(!0),Jf(null);try{const o=r.startsWith("http")?r:`${this.baseUrl}${r}`,s={method:e,headers:{"Content-Type":"application/json",Accept:"application/json",...i}};n&&(e==="POST"||e==="PUT"||e==="PATCH")&&(s.body=JSON.stringify(n));const a=await fetch(o,s);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const c=await a.json();if(c.errors&&c.errors.length>0)throw new Error(c.errors[0].message);return c.data||c}catch(o){const s=o instanceof Error?o.message:"Unknown error occurred";throw Jf(s),o}finally{n0(!1)}}async graphql(e){return this.request("POST","",e)}async get(e,r){return this.request("GET",e,void 0,r)}async post(e,r,n){return this.request("POST",e,r,n)}async put(e,r,n){return this.request("PUT",e,r,n)}async patch(e,r,n){return this.request("PATCH",e,r,n)}async delete(e,r){return this.request("DELETE",e,void 0,r)}getLoadingState(){return W$()}getErrorState(){return G$()}clearError(){Jf(null)}}const Ld=new Y$,Ty=`
  fragment AccountFields on Account {
    id
    accountNumber
    name
    type
    category
    description
    balance
    isActive
    parentAccountId
    createdDate
    lastModified
  }
`,K$=`
  query GetAccountById($id: ID!) {
    account(id: $id) {
      ...AccountFields
    }
  }
  ${Ty}
`,J$=`
  mutation CreateAccount($input: CreateAccountInput!) {
    createAccount(input: $input) {
      ...AccountFields
    }
  }
  ${Ty}
`,Q$=`
  mutation UpdateAccount($id: ID!, $input: UpdateAccountInput!) {
    updateAccount(id: $id, input: $input) {
      ...AccountFields
    }
  }
  ${Ty}
`,X$=`
  mutation DeleteAccount($id: ID!) {
    deleteAccount(id: $id) {
      success
      message
    }
  }
`;class Z${async getAccounts(e,r){try{if($u.isFakeMode())return await Sg.getAll(e);const n=await Vi({query:"getAllYabaProducts",params:{businessId:"YB100423253156428"}});return console.log("Real API accounts response:",n),n?.accounts||[]}catch(n){if(console.error("Error fetching accounts:",n),$u.isHybridMode())return console.warn("Falling back to fake API for accounts"),await Sg.getAll(e);throw n}}async getAccountById(e){try{return(await Ld.graphql({query:K$,variables:{id:e}})).account}catch(r){throw console.error("Error fetching account:",r),r}}async createAccount(e){try{return(await Ld.graphql({query:J$,variables:{input:e}})).createAccount}catch(r){throw console.error("Error creating account:",r),r}}async updateAccount(e,r){try{return(await Ld.graphql({query:Q$,variables:{id:e,input:r}})).updateAccount}catch(n){throw console.error("Error updating account:",n),n}}async deleteAccount(e){try{return(await Ld.graphql({query:X$,variables:{id:e}})).deleteAccount}catch(r){throw console.error("Error deleting account:",r),r}}async getAccountsByType(e){return this.getAccounts({type:e})}async getAccountHierarchy(){const e=await this.getAccounts();return this.buildHierarchy(e)}buildHierarchy(e){const r=new Map,n=[];return e.forEach(i=>{r.set(i.id,{...i,subAccounts:[]})}),e.forEach(i=>{const o=r.get(i.id);if(i.parentAccountId){const s=r.get(i.parentAccountId);s&&(s.subAccounts=s.subAccounts||[],s.subAccounts.push(o))}else n.push(o)}),n}async getAccountBalance(e){const r=await this.getAccountById(e);return r?r.balance:0}async searchAccounts(e){return this.getAccounts({search:e})}}const ek=new Z$;var tk=ue("<div><h2></h2><div><span>:</span><button></button><button>"),rk=ue("<div><span>:"),i0=ue("<div>"),nk=ue("<button>");const ik=()=>{const{t}=tr(),[e,r]=$e(!1),[n,i]=$e(!1),[o,s]=$e(!1),[a,c]=$e(null),[u,f]=$e(null),[y,v]=$e("All"),[p,I]=$e("hierarchy"),P=C=>{c(C),s(!0)},w=C=>{f(C),i(!0)},x=()=>y()==="All"?p()==="hierarchy"?kr.getAccountHierarchy():kr.accounts:p()==="hierarchy"?kr.getAccountHierarchy().filter(C=>C.type===y()):kr.getAccountsByType(y()),j={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},ne={display:"flex",gap:"1rem","margin-bottom":"2rem","align-items":"center"},Q=C=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:C?"var(--primary-color)":"var(--surface-color)",color:C?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500",transition:"all 0.2s ease"}),K={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},Z={display:"flex",gap:"0.5rem","align-items":"center","margin-left":"auto","margin-right":"1rem"},k=C=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:C?"var(--primary-color)":"var(--surface-color)",color:C?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"});return B(ro,{get title(){return t("accounts.title")},get children(){return[B(w$,{}),(()=>{var C=tk(),E=C.firstChild,M=E.nextSibling,_=M.firstChild,S=_.firstChild,b=_.nextSibling,Y=b.nextSibling;return m(C,K),E.style.setProperty("margin","0"),E.style.setProperty("font-size","1.5rem"),l(E,()=>t("accounts.title")),m(M,Z),_.style.setProperty("font-weight","500"),_.style.setProperty("color","var(--text-muted)"),_.style.setProperty("font-size","0.875rem"),l(_,()=>t("common.view"),S),b.$$click=()=>I("hierarchy"),l(b,()=>t("accounts.accountHierarchy")),Y.$$click=()=>{I("flat"),ek.getAccounts()},l(Y,()=>t("common.all")),l(C,B(Pt,{variant:"primary",onClick:()=>r(!0),get children(){return t("accounts.addAccount")}}),null),Se(te=>{var O=k(p()==="hierarchy"),D=k(p()==="flat");return te.e=m(b,O,te.e),te.t=m(Y,D,te.t),te},{e:void 0,t:void 0}),C})(),(()=>{var C=rk(),E=C.firstChild,M=E.firstChild;return m(C,ne),E.style.setProperty("font-weight","500"),E.style.setProperty("color","var(--text-muted)"),l(E,()=>t("common.filter"),M),l(C,()=>[t("common.all"),t("accounts.types.asset"),t("accounts.types.liability"),t("accounts.types.equity"),t("accounts.types.revenue"),t("accounts.types.expense")].map((_,S)=>{const Y=["All","Asset","Liability","Equity","Revenue","Expense"][S];return(()=>{var te=nk();return te.$$click=()=>v(Y),l(te,_),Se(O=>m(te,Q(y()===Y),O)),te})()}),null),C})(),(()=>{var C=i0();return l(C,(()=>{var E=Te(()=>p()==="hierarchy");return()=>E()?x().map(M=>B(E$,{account:M,onAddSubAccount:w,onViewDetails:P})):x().map(M=>B(x$,{account:M,onViewDetails:P}))})()),Se(E=>m(C,p()==="hierarchy"?{display:"flex","flex-direction":"column",gap:"1rem"}:j,E)),C})(),Te(()=>Te(()=>x().length===0)()&&(()=>{var C=i0();return C.style.setProperty("text-align","center"),C.style.setProperty("color","var(--text-muted)"),C.style.setProperty("padding","3rem"),C.style.setProperty("font-size","1.1rem"),l(C,()=>t("common.noDataFound")),C})()),B(N$,{get isOpen(){return e()},onClose:()=>r(!1)}),B(R$,{get isOpen(){return n()},onClose:()=>i(!1),get parentAccount(){return u()}}),B(U$,{get isOpen(){return o()},onClose:()=>s(!1),get account(){return a()}})]}})};ur(["click"]);var ok=ue("<div><h2>"),Jl=ue("<div>"),sk=ue("<div><div><div></div><h1></h1><div></div></div><div>"),ak=ue("<div><button></button><button> (<!>)"),Dd=ue("<div><span></span><span>"),lk=ue("<p>"),ck=ue("<div><div></div><div>"),uk=ue("<div><div><div></div><div>  </div></div><div>");const dk=()=>{const{t}=tr(),e=jw(),r=Lm(),[n,i]=$e(null),[o,s]=$e("overview");Nn(()=>{const b=kr.getAccountById(e.id);b?i(b):r("/accounts")});const a={display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"1rem"},c={display:"flex","align-items":"center",gap:"1rem","margin-bottom":"2rem"},u={"font-size":"1rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},f={"font-size":"2.5rem","font-weight":"700",color:"var(--primary-color)"},y={padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},v={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},p=b=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:b?"var(--primary-color)":"var(--text-muted)","border-bottom":b?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),I={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},P={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},w={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},x={"font-weight":"500",color:"var(--text-muted)"},j={"font-weight":"600",color:"var(--text-primary)"},ne={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},Q={flex:"1"},K={"font-weight":"500","margin-bottom":"0.25rem"},Z={"font-size":"0.875rem",color:"var(--text-muted)"},k=b=>({"font-weight":"600",color:b==="debit"?"#4caf50":"#f44336"});if(!n())return B(ro,{get title(){return t("accounts.accountDetails")},get children(){var b=ok(),Y=b.firstChild;return b.style.setProperty("text-align","center"),b.style.setProperty("padding","3rem"),l(Y,()=>t("common.error")),l(b,B(Pt,{variant:"primary",onClick:()=>r("/accounts"),get children(){return[Te(()=>t("common.back"))," ",Te(()=>t("navigation.accounts"))]}}),null),b}});const C=b=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[b]||{bg:"#f5f5f5",color:"#666"},E=b=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(b),M=b=>new Date(b).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),_=C(n().type),S=kr.getAccountTransactions(n().id);return B(ro,{get title(){return n().name},get children(){return[(()=>{var b=Jl();return m(b,a),l(b,B(Pt,{variant:"secondary",onClick:()=>r("/accounts"),get children(){return[" ",Te(()=>t("common.back"))," ",Te(()=>t("navigation.accounts"))]}})),b})(),(()=>{var b=sk(),Y=b.firstChild,te=Y.firstChild,O=te.nextSibling,D=O.nextSibling,X=Y.nextSibling;return m(b,c),m(te,u),l(te,()=>n().accountNumber),O.style.setProperty("margin","0.5rem 0"),O.style.setProperty("font-size","2rem"),l(O,()=>n().name),m(D,f),l(D,()=>E(n().balance)),l(X,()=>n().type),Se(H=>m(X,{...y,background:_.bg,color:_.color},H)),b})(),(()=>{var b=ak(),Y=b.firstChild,te=Y.nextSibling,O=te.firstChild,D=O.nextSibling;return D.nextSibling,m(b,v),Y.$$click=()=>s("overview"),l(Y,()=>t("dashboard.overview")),te.$$click=()=>s("transactions"),l(te,()=>t("accounts.transactions"),O),l(te,()=>S.length,D),Se(X=>{var H=p(o()==="overview"),F=p(o()==="transactions");return X.e=m(Y,H,X.e),X.t=m(te,F,X.t),X},{e:void 0,t:void 0}),b})(),Te(()=>Te(()=>o()==="overview")()&&(()=>{var b=ck(),Y=b.firstChild,te=Y.nextSibling;return m(Y,I),l(Y,B(Tt,{get title(){return t("accounts.balance")},get subtitle(){return t("dashboard.overview")},get children(){var O=Jl();return O.style.setProperty("font-size","1.5rem"),O.style.setProperty("font-weight","600"),O.style.setProperty("color","var(--primary-color)"),l(O,()=>E(n().balance)),O}}),null),l(Y,B(Tt,{get title(){return t("accounts.accountType")},get subtitle(){return t("accounts.category")},get children(){var O=Jl();return O.style.setProperty("font-size","1.5rem"),O.style.setProperty("font-weight","600"),O.style.setProperty("color","var(--primary-color)"),l(O,()=>t(`accounts.types.${n().type.toLowerCase()}`)),O}}),null),l(Y,B(Tt,{get title(){return t("common.status")},get subtitle(){return t("accounts.accountDetails")},get children(){var O=Jl();return O.style.setProperty("font-size","1.5rem"),O.style.setProperty("font-weight","600"),l(O,(()=>{var D=Te(()=>!!n().isActive);return()=>D()?t("common.active"):t("common.inactive")})()),Se(D=>(D=n().isActive?"#4caf50":"#f44336")!=null?O.style.setProperty("color",D):O.style.removeProperty("color")),O}}),null),l(Y,B(Tt,{get title(){return t("accounts.transactions")},get subtitle(){return t("common.total")},get children(){var O=Jl();return O.style.setProperty("font-size","1.5rem"),O.style.setProperty("font-weight","600"),O.style.setProperty("color","var(--primary-color)"),l(O,()=>S.length),O}}),null),m(te,P),l(te,B(Tt,{get title(){return t("accounts.accountDetails")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var O=Dd(),D=O.firstChild,X=D.nextSibling;return l(D,()=>t("accounts.accountNumber")),l(X,()=>n().accountNumber),Se(H=>{var F=w,ie=x,$=j;return H.e=m(O,F,H.e),H.t=m(D,ie,H.t),H.a=m(X,$,H.a),H},{e:void 0,t:void 0,a:void 0}),O})(),(()=>{var O=Dd(),D=O.firstChild,X=D.nextSibling;return l(D,()=>t("accounts.category")),l(X,()=>n().category),Se(H=>{var F=w,ie=x,$=j;return H.e=m(O,F,H.e),H.t=m(D,ie,H.t),H.a=m(X,$,H.a),H},{e:void 0,t:void 0,a:void 0}),O})(),(()=>{var O=Dd(),D=O.firstChild,X=D.nextSibling;return l(D,()=>t("common.date")),l(X,()=>M(n().createdDate)),Se(H=>{var F=w,ie=x,$=j;return H.e=m(O,F,H.e),H.t=m(D,ie,H.t),H.a=m(X,$,H.a),H},{e:void 0,t:void 0,a:void 0}),O})(),(()=>{var O=Dd(),D=O.firstChild,X=D.nextSibling;return l(D,()=>t("common.date")),l(X,()=>M(n().lastModified)),Se(H=>{var F=w,ie=x,$=j;return H.e=m(O,F,H.e),H.t=m(D,ie,H.t),H.a=m(X,$,H.a),H},{e:void 0,t:void 0,a:void 0}),O})()]}}),null),l(te,B(Tt,{get title(){return t("common.description")},get subtitle(){return t("accounts.accountDetails")},get children(){var O=lk();return O.style.setProperty("margin","0"),O.style.setProperty("color","var(--text-secondary)"),l(O,()=>n().description||t("common.noDataFound")),O}}),null),b})()),Te(()=>Te(()=>o()==="transactions")()&&B(Tt,{get title(){return t("accounts.accountHistory")},get subtitle(){return t("accounts.transactions")},get children(){return Te(()=>S.length===0)()?(()=>{var b=Jl();return b.style.setProperty("text-align","center"),b.style.setProperty("color","var(--text-muted)"),b.style.setProperty("padding","2rem"),l(b,()=>t("common.noDataFound")),b})():S.map(b=>(()=>{var Y=uk(),te=Y.firstChild,O=te.firstChild,D=O.nextSibling,X=D.firstChild,H=te.nextSibling;return m(Y,ne),m(te,Q),m(O,K),l(O,()=>b.description),m(D,Z),l(D,()=>M(b.date),X),l(D,()=>b.reference,null),l(H,()=>b.type==="debit"?"+":"-",null),l(H,()=>E(b.type==="debit"?b.debitAmount:b.creditAmount),null),Se(F=>m(H,k(b.type),F)),Y})())}}))]}})};ur(["click"]);var hk=ue("<div><div><h1></h1><p> </p></div><div><input type=date>"),ws=ue("<div><span></span><span>"),fk=ue("<div><div></div><div>"),pk=ue("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),mk=ue("<div><div> (<!> = <!> + <!>)</div><div> = "),yk=ue("<span>(<!>: <!>)");const gk=()=>{const{t}=tr(),[e,r]=$e(new Date().toISOString().split("T")[0]),[n,i]=$e(0),[o,s]=$e(0),[a,c]=$e(0);Nn(()=>{u()});const u=()=>{const I=kr.getAccountsByType("Asset"),P=kr.getAccountsByType("Liability"),w=kr.getAccountsByType("Equity"),x=I.reduce((Q,K)=>Q+K.balance,0),j=P.reduce((Q,K)=>Q+K.balance,0),ne=w.reduce((Q,K)=>Q+K.balance,0);i(x),s(j),c(ne)},f=I=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(I),y={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},v={"margin-bottom":"2rem"},p={"font-weight":"bold","font-size":"1.1rem","border-top":"2px solid var(--border-color)","padding-top":"0.5rem","margin-top":"1rem"};return B(ro,{get title(){return t("balanceSheet.title")},get children(){return[(()=>{var I=hk(),P=I.firstChild,w=P.firstChild,x=w.nextSibling,j=x.firstChild,ne=P.nextSibling,Q=ne.firstChild;return m(I,y),w.style.setProperty("margin","0"),l(w,()=>t("balanceSheet.title")),x.style.setProperty("margin","0.5rem 0 0 0"),x.style.setProperty("color","var(--text-muted)"),l(x,()=>t("balanceSheet.asOf"),j),l(x,()=>new Date(e()).toLocaleDateString(),null),ne.style.setProperty("display","flex"),ne.style.setProperty("gap","1rem"),Q.addEventListener("change",K=>r(K.target.value)),Q.style.setProperty("padding","0.5rem"),Q.style.setProperty("border","1px solid var(--border-color)"),Q.style.setProperty("border-radius","var(--border-radius-sm)"),l(ne,B(Pt,{variant:"primary",onClick:u,get children(){return t("balanceSheet.generateReport")}}),null),Se(()=>Q.value=e()),I})(),(()=>{var I=fk(),P=I.firstChild,w=P.nextSibling;return I.style.setProperty("display","grid"),I.style.setProperty("grid-template-columns","1fr 1fr"),I.style.setProperty("gap","2rem"),l(P,B(Tt,{get title(){return t("balanceSheet.assets")},style:v,get children(){return[(()=>{var x=ws(),j=x.firstChild,ne=j.nextSibling;return x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),l(j,()=>t("balanceSheet.currentAssets")),l(ne,()=>f(n()*.6)),x})(),(()=>{var x=ws(),j=x.firstChild,ne=j.nextSibling;return x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),l(j,()=>t("balanceSheet.nonCurrentAssets")),l(ne,()=>f(n()*.4)),x})(),(()=>{var x=ws(),j=x.firstChild,ne=j.nextSibling;return l(j,()=>t("balanceSheet.totalAssets")),l(ne,()=>f(n())),Se(Q=>m(x,{...p,display:"flex","justify-content":"space-between"},Q)),x})()]}})),l(w,B(Tt,{get title(){return t("balanceSheet.liabilities")},style:v,get children(){return[(()=>{var x=ws(),j=x.firstChild,ne=j.nextSibling;return x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),l(j,()=>t("balanceSheet.currentLiabilities")),l(ne,()=>f(o()*.7)),x})(),(()=>{var x=ws(),j=x.firstChild,ne=j.nextSibling;return x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),l(j,()=>t("balanceSheet.nonCurrentLiabilities")),l(ne,()=>f(o()*.3)),x})(),(()=>{var x=ws(),j=x.firstChild,ne=j.nextSibling;return l(j,()=>t("balanceSheet.totalLiabilities")),l(ne,()=>f(o())),Se(Q=>m(x,{...p,display:"flex","justify-content":"space-between"},Q)),x})()]}}),null),l(w,B(Tt,{get title(){return t("balanceSheet.equity")},get children(){return[(()=>{var x=ws(),j=x.firstChild,ne=j.nextSibling;return x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),l(j,()=>t("balanceSheet.commonStock")),l(ne,()=>f(a()*.8)),x})(),(()=>{var x=ws(),j=x.firstChild,ne=j.nextSibling;return x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),l(j,()=>t("balanceSheet.retainedEarnings")),l(ne,()=>f(a()*.2)),x})(),(()=>{var x=ws(),j=x.firstChild,ne=j.nextSibling;return l(j,()=>t("balanceSheet.totalEquity")),l(ne,()=>f(a())),Se(Q=>m(x,{...p,display:"flex","justify-content":"space-between"},Q)),x})()]}}),null),I})(),B(Tt,{get title(){return t("dashboard.overview")},style:{"margin-top":"2rem"},get children(){return[(()=>{var I=pk(),P=I.firstChild,w=P.firstChild,x=w.nextSibling,j=P.nextSibling,ne=j.firstChild,Q=ne.nextSibling,K=j.nextSibling,Z=K.firstChild,k=Z.nextSibling;return I.style.setProperty("display","grid"),I.style.setProperty("grid-template-columns","repeat(3, 1fr)"),I.style.setProperty("gap","2rem"),P.style.setProperty("text-align","center"),w.style.setProperty("font-size","0.875rem"),w.style.setProperty("color","var(--text-muted)"),w.style.setProperty("margin-bottom","0.5rem"),l(w,()=>t("balanceSheet.totalAssets")),x.style.setProperty("font-size","1.5rem"),x.style.setProperty("font-weight","bold"),x.style.setProperty("color","var(--primary-color)"),l(x,()=>f(n())),j.style.setProperty("text-align","center"),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-muted)"),ne.style.setProperty("margin-bottom","0.5rem"),l(ne,()=>t("balanceSheet.totalLiabilities")),Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","bold"),Q.style.setProperty("color","#f44336"),l(Q,()=>f(o())),K.style.setProperty("text-align","center"),Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-muted)"),Z.style.setProperty("margin-bottom","0.5rem"),l(Z,()=>t("balanceSheet.totalEquity")),k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","bold"),k.style.setProperty("color","#4caf50"),l(k,()=>f(a())),I})(),(()=>{var I=mk(),P=I.firstChild,w=P.firstChild,x=w.nextSibling,j=x.nextSibling,ne=j.nextSibling,Q=ne.nextSibling,K=Q.nextSibling;K.nextSibling;var Z=P.nextSibling,k=Z.firstChild;return I.style.setProperty("margin-top","2rem"),I.style.setProperty("text-align","center"),P.style.setProperty("font-size","0.875rem"),P.style.setProperty("color","var(--text-muted)"),P.style.setProperty("margin-bottom","0.5rem"),l(P,()=>t("common.total"),w),l(P,()=>t("balanceSheet.totalAssets"),x),l(P,()=>t("balanceSheet.totalLiabilities"),ne),l(P,()=>t("balanceSheet.totalEquity"),K),Z.style.setProperty("font-size","1.2rem"),Z.style.setProperty("font-weight","bold"),l(Z,()=>f(n()),k),l(Z,()=>f(o()+a()),null),l(Z,(()=>{var C=Te(()=>Math.abs(n()-(o()+a()))>.01);return()=>C()&&(()=>{var E=yk(),M=E.firstChild,_=M.nextSibling,S=_.nextSibling,b=S.nextSibling;return b.nextSibling,E.style.setProperty("font-size","0.875rem"),E.style.setProperty("color","#f44336"),E.style.setProperty("display","block"),l(E,()=>t("common.error"),_),l(E,()=>f(n()-(o()+a())),b),E})()})(),null),Se(C=>(C=Math.abs(n()-(o()+a()))<.01?"#4caf50":"#f44336")!=null?Z.style.setProperty("color",C):Z.style.removeProperty("color")),I})()]}})]}})};ur(["click"]);const vk="modulepreload",bk=function(t){return"/"+t},o0={},Ui=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){let s=function(u){return Promise.all(u.map(f=>Promise.resolve(f).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=a?.nonce||a?.getAttribute("nonce");i=s(r.map(u=>{if(u=bk(u),u in o0)return;o0[u]=!0;const f=u.endsWith(".css"),y=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${y}`))return;const v=document.createElement("link");if(v.rel=f?"stylesheet":vk,f||(v.as="script"),v.crossOrigin="",v.href=u,c&&v.setAttribute("nonce",c),document.head.appendChild(v),f)return new Promise((p,I)=>{v.addEventListener("load",p),v.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return i.then(s=>{for(const a of s||[])a.status==="rejected"&&o(a.reason);return e().catch(o)})},_k=[{id:"YY_8802",code:"YY_8802",name:"CENTER",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8803",code:"YY_8803",name:"BISSONNET",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8804",code:"YY_8804",name:"IRVIN",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8805",code:"YY_8805",name:"KATTY",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8816",code:"YY_8816",type:"store",name:"YABA GLOBAL",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8818",code:"YY_8818",type:"store",name:"YABASURAUSTIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8847",code:"YY_8847",type:"store",name:"YABAOFICINA AZ",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_3251",code:"YY_3251",type:"store",name:"YABA FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_32",code:"YY_32",type:"store",name:"YABA MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_76",code:"YY_76",type:"store",name:"YABA DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_79",code:"YY_79",type:"warehouse",name:"ALMACEN DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8635",code:"YY_8635",type:"store",name:"FASHION MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8665",code:"YY_8665",name:"IRVIN FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,type:"store",createdDate:"2024-01-01"},{id:"YY_8901",code:"YY_8901",name:"ALMACEN CENTRAL YABA",bussinesId:"YB100423253156428",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01"}],wk=[{id:"1",name:'MacBook Pro 16"',price:2399,quantity:75,category:"Electronics",description:"Apple MacBook Pro 16-inch with M2 Pro chip",sku:"MBP-16-M2P",supplier:"Apple Inc.",minStock:10,location:"Warehouse A",lastUpdated:"2024-01-15"},{id:"2",name:'Dell Monitor 27"',price:299,quantity:35,category:"Electronics",description:"Dell 27-inch 4K UHD Monitor",sku:"DELL-MON-27-4K",supplier:"Dell Technologies",minStock:15,location:"Warehouse B",lastUpdated:"2024-01-14"},{id:"3",name:"Wireless Mouse",price:49.99,quantity:12,category:"Accessories",description:"Ergonomic wireless mouse with precision tracking",sku:"MOUSE-WL-001",supplier:"Logitech",minStock:25,location:"Warehouse A",lastUpdated:"2024-01-13"}],Rd=()=>{const t=new Map;return Bi().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=lt.getLocationById(e.locationId),i=t.get(r);i||(i={id:r,productId:e.productId,locationId:e.locationId,locationName:n?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,i)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(i.quantity+=e.quantity*1):e.movementType==="out"?i.quantity-=e.quantity*1:e.movementType==="adjustment"&&(i.quantity=e.quantity*1),new Date(e.createdDate)>new Date(i.lastMovementDate)&&(i.lastMovementDate=e.createdDate,i.lastMovementType=e.movementType),i.averageCost=e.unitCost*1,i.availableQuantity=i.quantity*1-i.reservedQuantity*1}),Array.from(t.values())},[rl,Qf]=$e([]),[nl,s0]=$e(_k),[Bi,Md]=$e([]),[da,Yc]=$e([]),[Fd,Xf]=$e(wk),Sk={TRANSFER:1,transfer:1},a0=173442384e4,lt={get products(){return rl()},get locations(){return nl()},get movements(){return Bi()},get stockLevels(){return da()},parseInventoryData:t=>{const e=Object.keys(t).slice(0,900),r=[],n=i=>{let o=t;o[i]?.products&&o[i]?.products?.map(s=>{let a=uS(o[i]?.type),c=s?.price*1||s?.unitCost*1,u=s?.qty*1||s?.quantity*1;c=isNaN(c)?0:c,u=isNaN(u)?0:u;let f={id:o[i]?.ssg_inventory_key,productId:s?.product?.id,productName:s?.product?.label,productSku:s?.product?.code,locationId:o[i]?.store,locationName:o[i]?.store,location:o[i]?.store,movementType:a,quantity:u,unitCost:c,totalCost:c*1*u,minStock:10,referenceNumber:"PO-001",notes:o[i]?.description||o[i]?.notes,createdBy:"admin",createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(a0).toISOString(),invoiceId:o[i]?.invoice};if(r.push(f),Sk[o[i].movementType]&&o[i]?.fromLocationId){let y=lt.getLocationById(o[i]?.fromLocationId);const v={id:o[i]?.ssg_inventory_key,productId:s?.product?.id,productName:s?.product?.label,productSku:s?.product?.code,locationId:o[i]?.fromLocationId,locationName:y?.name||"",movementType:"out",quantity:u*-1,unitCost:c,totalCost:c*-1*u,minStock:10,referenceNumber:o[i]?.referenceNumber,notes:`Transfer to ${o[i]?.locationName}`+(o[i].notes?` - ${o[i].notes}`:""),createdBy:o[i].createdBy,createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(a0).toISOString(),invoiceId:o[i]?.invoiceId,toLocationId:o[i]?.locationId,toLocationName:o[i]?.locationName};r.push(v)}})};return e.map(n),r},fecthInventory:async t=>{const e=await Ai.getInventory(t),r=lt.parseInventoryData(e);lt.updMovements(r)},getStockLevels:async t=>{const e=await Rm.getStockLevels(t);Yc(e)},fecthProduct:async t=>{const e=await Ai.getProducts(t),r=Object.keys(e),n=o=>{let s=e;return{id:o,name:s[o].name,businessId:s[o].businessId,sku:s[o].code,UPC:s[o].UPC,numCode:s[o].codeN,category:s[o].category,unitCost:s[o].unitCost||0,unitOfMeasure:s[o].unitOfMeasure||s[o].unit,minStockLevel:s[o].minStockLevel,maxStockLevel:s[o].maxStockLevel,isActive:s[o].isActive,productImageUrl:s[o].productImageUrl,description:s[o].description||"",createdDate:s[o].createdAt||new Date().toISOString(),lastModified:s[o].updatedAt||new Date().toISOString()}},i=r.map(n);return lt.updProduct(i),i},getProductById:t=>rl().find(e=>e.id===t),updProduct:t=>{Qf(t)},getProductsBySku:t=>rl().filter(e=>e.sku.toLowerCase().includes(t.toLowerCase())),getProductsByCategory:t=>rl().filter(e=>e.category===t),getActiveProducts:()=>rl().filter(t=>t.name),getLocationById:t=>nl().find(e=>e.id===t),getLocationsByType:t=>nl().filter(e=>e.type===t),getActiveLocations:()=>{let t=Ar?.state?.profile?.stores;return nl().filter(e=>t?.[e?.id])},getMovementsByProduct:t=>Bi().filter(e=>e.productId===t),updMovements:t=>{Md([...t]),Yc(Rd())},getMovementsByLocation:t=>Bi()?.filter(e=>e.locationId===t),getMovementsByDateRange:(t,e)=>Bi()?.filter(r=>r.createdDate>=t&&r.createdDate<=e),getStockByProduct:t=>da()?.filter(e=>e.productId===t),getStockByLocation:t=>da()?.filter(e=>e.locationId===t),getStockByProductAndLocation:(t,e)=>da()?.find(r=>r.productId===t&&r.locationId===e),getTotalStockByProduct:t=>da()?.filter(e=>e.productId===t).reduce((e,r)=>e*1+r.quantity*1,0),getLastLocationByProduct:t=>{const e=Bi()?.filter(r=>r.productId===t).sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime());if(e.length>0)return nl().find(r=>r.id===e[0].locationId)},getLowStockProducts:()=>(rl()||[])?.map(t=>{const e=da()?.filter(r=>r.productId===t.id).reduce((r,n)=>r+n.quantity,0)||0;return{...t,currentStock:e}}).filter(t=>t.currentStock<=t.minStockLevel),generateMovementInvoice:async(t,e,r,n="compact")=>{try{const{getUserLanguage:i}=await Ui(async()=>{const{getUserLanguage:f}=await import("./languageUtils-BVmHbHaj.js");return{getUserLanguage:f}},[]),o=r||i();let s;switch(n){case"compact":const{generateCompactModernInvoicePDF:f}=await Ui(async()=>{const{generateCompactModernInvoicePDF:p}=await import("./compactModernInvoicePdfGenerator-DgXvPNGp.js");return{generateCompactModernInvoicePDF:p}},[]);s=f;break;case"modern":const{generateModernMovementInvoicePDF:y}=await Ui(async()=>{const{generateModernMovementInvoicePDF:p}=await import("./modernMovementInvoicePdfGenerator-PwSmiRga.js");return{generateModernMovementInvoicePDF:p}},[]);s=y;break;case"classic":default:const{generateMovementInvoicePDF:v}=await Ui(async()=>{const{generateMovementInvoicePDF:p}=await import("./movementInvoicePdfGenerator-DVRDLcse.js");return{generateMovementInvoicePDF:p}},[]);s=v;break}const a=Bi().filter(f=>f.invoiceId===t||f.id===t);if(a.length===0)throw new Error(`No movements found with ID: ${t}`);const c=a.reduce((f,y)=>{const v=y.invoiceId||y.id;return f[v]||(f[v]={invoiceId:v,movementType:y.movementType,referenceNumber:y.referenceNumber,createdBy:y.createdBy,createdDate:y.createdDate,locationName:y.locationName,fromLocationName:y.fromLocationName,toLocationName:y.toLocationName,notes:y.notes,items:[]}),f[v].items.push({productSku:y.productSku,productName:y.productName,quantity:y.quantity,unitCost:y.unitCost,totalCost:y.totalCost,receivedQuantity:y.movementType==="transfer"?null:void 0}),f},{}),u=[];for(const[f,y]of Object.entries(c)){const v=await s(y,e,o);u.push(v)}return u}catch(i){throw console.error("Error generating movement invoice:",i),i}},getMovementsByInvoiceId:t=>Bi().filter(e=>e.invoiceId===t),generateCompactMovementInvoice:async(t,e,r)=>lt.generateMovementInvoice(t,e,r,"compact"),generateModernMovementInvoice:async(t,e,r)=>lt.generateMovementInvoice(t,e,r,"modern"),generateClassicMovementInvoice:async(t,e,r)=>lt.generateMovementInvoice(t,e,r,"classic"),getMovementInvoiceData:t=>{const e=Bi().filter(i=>i.invoiceId===t||i.id===t);if(e.length===0)return null;const r=e[0],n=e.reduce((i,o)=>i+(o.totalCost||o.quantity*o.unitCost),0);return{invoiceId:r.invoiceId||r.id,movementType:r.movementType,referenceNumber:r.referenceNumber,createdBy:r.createdBy,createdDate:r.createdDate,locationName:r.locationName,fromLocationName:r.fromLocationName,toLocationName:r.toLocationName,notes:r.notes,totalValue:n,itemCount:e.length,items:e.map(i=>({productSku:i.productSku,productName:i.productName,quantity:i.quantity,unitCost:i.unitCost,totalCost:i.totalCost||i.quantity*i.unitCost}))}},addInventoryMovement:t=>{const e={...t,id:`mov-${Date.now()}`,createdDate:new Date().toISOString()};Md(r=>[...r,e]),Yc(Rd())},addBulkInventoryMovements:async t=>{const e=[],r=[],n=new Date().toISOString(),i=nl().find(a=>a.id===t.locationId);if(!i)return{success:!1,errors:["Invalid location"]};let o;if(t.movementType==="transfer"){if(!t.fromLocationId)return{success:!1,errors:["From location required for transfers"]};if(o=nl().find(a=>a.id===t.fromLocationId),!o)return{success:!1,errors:["Invalid from location"]};if(t.fromLocationId===t.locationId)return{success:!1,errors:["From and to locations cannot be the same"]}}if(t.items.forEach((a,c)=>{const u=rl().find(p=>p.id===a.productId);if(!u){e.push(`Item ${c+1}: Product not found`);return}if(a.quantity<=0){e.push(`Item ${c+1}: Quantity must be greater than 0`);return}if(t.movementType==="out"){const p=da().filter(I=>I.productId===a.productId&&I.locationId===t.locationId).reduce((I,P)=>I+P.quantity,0);if(a.quantity>p){e.push(`Item ${c+1}: Insufficient stock. Available: ${p}, Requested: ${a.quantity}`);return}}if(t.movementType==="transfer"){const p=da().filter(I=>I.productId===a.productId&&I.locationId===t.fromLocationId).reduce((I,P)=>I+P.quantity,0);if(a.quantity>p){e.push(`Item ${c+1}: Insufficient stock at ${o?.name}. Available: ${p}, Requested: ${a.quantity}`);return}}const f=a.unitCost||u.unitCost,y=a.quantity*f,v={id:`mov-${Date.now()}-${c}`,productId:u.id,productName:u.name,productSku:u.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:a.quantity,unitCost:f,totalCost:y,minStock:10,referenceNumber:t.referenceNumber||"",notes:a.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:o?.name};if(r.push(v),t.movementType==="transfer"&&o){const p={id:`mov-${Date.now()}-${c}-out`,productId:u.id,productName:u.name,productSku:u.sku,locationId:t.fromLocationId,locationName:o.name,movementType:"out",quantity:a.quantity,unitCost:f,totalCost:y,minStock:10,referenceNumber:t.referenceNumber||"",notes:`Transfer to ${i.name}`+(a.notes?` - ${a.notes}`:""),createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,toLocationId:t.locationId,toLocationName:i.name};r.push(p)}}),e.length>0)return{success:!1,errors:e};Md(a=>[...a,...r]),Yc(Rd()),console.log({bulkRequest:t});const s=await Ai.addInventory(t);return console.log({prodResults:s}),{success:!0,errors:[]}},getMovementsByInvoice:t=>Bi().filter(e=>e.invoiceId===t),getInvoiceSummary:t=>{const e=Bi().filter(o=>o.invoiceId===t);if(e.length===0)return null;const r=e.reduce((o,s)=>o+s.totalCost,0),n=new Set(e.map(o=>o.productId)).size,i=e[0];return{invoiceId:t,referenceNumber:i.referenceNumber,movementType:i.movementType,location:i.locationName,fromLocation:i.fromLocationName,productCount:n,totalItems:e.reduce((o,s)=>o+s.quantity,0),totalValue:r,createdDate:i.createdDate,createdBy:i.createdBy}},addProduct:t=>{const e={...t,id:`prod-${Date.now()}`,createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};Qf(r=>[...r,e])},addLocation:t=>{const e={...t,id:`loc-${Date.now()}`,createdDate:new Date().toISOString()};s0(r=>[...r,e])},updateProduct:(t,e)=>{Qf(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n))},updateLocation:(t,e)=>{s0(r=>r.map(n=>n.id===t?{...n,...e}:n))},updateMovement:(t,e)=>{Md(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n)),Yc(Rd())},get inventory(){return Fd()},addItem(t){const e={...t,id:Date.now().toString(),lastUpdated:new Date().toISOString().split("T")[0]};return Xf([...Fd(),e]),e},updateItem(t,e){Xf(Fd().map(r=>r.id===t?{...r,...e,lastUpdated:new Date().toISOString().split("T")[0]}:r))},deleteItem(t){Xf(Fd().filter(e=>e.id!==t))},getItemById(t){return Bi().find(e=>e.id===t)},getLowStockItems(){return Bi().filter(t=>t.quantity*1<=t.minStock*1)},getTotalValue(){return Bi().reduce((t,e)=>t*1+e.unitCost*1*e.quantity*1,0)}};var l0=ue("<div>"),Pk=ue("<div><div><input type=text autocomplete=off>"),xk=ue("<button type=button>+"),Ak=ue("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>");const cf=t=>{const{t:e}=tr(),[r,n]=$e(!1),[i,o]=$e(""),[s,a]=$e(-1),c=Nt(()=>t.value?lt.getProductById(t.value):null),u=Nt(()=>{const te=i().toLowerCase();return te?lt.getActiveProducts().filter(O=>O.name.toLowerCase().includes(te)||O.sku.toLowerCase().includes(te)||O?.UPC?.toLowerCase().includes(te)||O.category.toLowerCase().includes(te)):lt.getActiveProducts()}),f=()=>{n(!0),o(""),a(-1)},y=te=>{const O=te.target;o(O.value),n(!0),a(-1)},v=te=>{t.onChange(te),n(!1),o(""),a(-1)},p=te=>{const O=u();switch(te.key){case"ArrowDown":te.preventDefault(),a(D=>Math.min(D+1,O.length-1));break;case"ArrowUp":te.preventDefault(),a(D=>Math.max(D-1,-1));break;case"Enter":te.preventDefault(),s()>=0&&O[s()]&&v(O[s()]);break;case"Escape":n(!1),o(""),a(-1);break}},I=te=>{setTimeout(()=>{n(!1),o(""),a(-1)},150)},P=te=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(te),w=te=>lt.stockLevels.filter(O=>O.productId===te).reduce((O,D)=>O+D.quantity,0),x={position:"relative",width:"100%",...t.style},j={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},ne={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},Q=te=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid "+te?"var(--primary-color)":"var(--border-color)",background:te?"var(--strip-color)":"transparent",color:te?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),K={display:"flex","justify-content":"space-between","align-items":"center"},Z={flex:"1"},k={"font-weight":"500","margin-bottom":"0.25rem"},C={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},E={"text-align":"right","font-size":"0.875rem"},M={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},_=()=>r()&&i()?i():c()?`${c().name} (${c().sku})`:"",S={display:"flex","align-items":"stretch",width:"100%"},b={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},Y={...j,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"};return(()=>{var te=Pk(),O=te.firstChild,D=O.firstChild;return m(O,S),D.addEventListener("blur",I),D.$$keydown=p,D.$$click=f,D.$$input=y,l(O,(()=>{var X=Te(()=>!!t.onAddNew);return()=>X()&&(()=>{var H=xk();return H.addEventListener("mouseleave",F=>{F.currentTarget.style.background="var(--surface-color)",F.currentTarget.style.color="var(--primary-color)"}),H.addEventListener("mouseenter",F=>{F.currentTarget.style.background="var(--primary-color)",F.currentTarget.style.color="white"}),as(H,"click",t.onAddNew,!0),m(H,b),Se(()=>Yt(H,"title",e("inventory.addProduct","Add new product"))),H})()})(),null),l(te,B(Ge,{get when(){return r()},get children(){var X=l0();return l(X,B(Ge,{get when(){return u().length>0},get fallback(){return(()=>{var H=l0();return m(H,M),l(H,(()=>{var F=Te(()=>!!i());return()=>F()?e("inventory.noProductsFound","No products found matching your search."):e("inventory.noProductsAvailable","No products available.")})()),H})()},get children(){return B(Ht,{get each(){return u()},children:(H,F)=>{const ie=w(H.id),$=ie<=H.minStockLevel;return(()=>{var L=Ak(),U=L.firstChild,N=U.firstChild,z=N.firstChild,oe=z.nextSibling,G=oe.firstChild,ee=G.firstChild,J=G.nextSibling,W=J.nextSibling,q=W.nextSibling,ae=q.nextSibling,de=N.nextSibling,le=de.firstChild,V=le.firstChild,ce=le.nextSibling;return L.addEventListener("mouseenter",()=>a(F())),L.$$click=()=>v(H),m(U,K),m(N,Z),m(z,k),l(z,()=>H.name),m(oe,C),l(G,()=>e("inventory.sku","SKU"),ee),l(G,()=>H.sku,null),l(W,()=>H.category),l(ae,()=>P(H.unitCost)),m(de,E),le.style.setProperty("font-weight","600"),($?"#f44336":"var(--text-primary)")!=null?le.style.setProperty("color",$?"#f44336":"var(--text-primary)"):le.style.removeProperty("color"),l(le,ie,V),l(le,()=>H.unitOfMeasure,null),ce.style.setProperty("color","var(--text-muted)"),l(ce,()=>$?e("inventory.lowStock","Low Stock"):e("inventory.inStock","In Stock")),Se(Pe=>m(L,Q(F()===s()),Pe)),L})()}})}})),Se(H=>m(X,ne,H)),X}}),null),Se(X=>{var H=x,F=Y,ie=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),$=t.disabled,L=t.required;return X.e=m(te,H,X.e),X.t=m(D,F,X.t),ie!==X.a&&Yt(D,"placeholder",X.a=ie),$!==X.o&&(D.disabled=X.o=$),L!==X.i&&(D.required=X.i=L),X},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>D.value=_()),te})()};ur(["input","click","keydown"]);var c0=ue("<div>"),Ck=ue("<div><div><input type=text autocomplete=off>"),Ik=ue("<button type=button>+"),$k=ue("<div><div><div><div> </div><div><span>: </span><span></span></div><div>");const Ou=t=>{const{t:e}=tr(),[r,n]=$e(!1),[i,o]=$e(""),[s,a]=$e(-1),c=Nt(()=>t.value?lt.getLocationById(t.value):null),u=Nt(()=>{let te=lt.getActiveLocations();t.filterType&&(te=te.filter(D=>D.type===t.filterType));const O=i().toLowerCase();return O?te.filter(D=>D.name.toLowerCase().includes(O)||D?.code?.toLowerCase().includes(O)||D?.type?.toLowerCase().includes(O)||D?.address?.toLowerCase().includes(O)):te}),f=()=>{n(!0),o(""),a(-1)},y=te=>{const O=te.target;o(O.value),n(!0),a(-1)},v=te=>{t.onChange(te.id),n(!1),o(""),a(-1)},p=te=>{const O=u();switch(te.key){case"ArrowDown":te.preventDefault(),a(D=>Math.min(D+1,O.length-1));break;case"ArrowUp":te.preventDefault(),a(D=>Math.max(D-1,-1));break;case"Enter":te.preventDefault(),s()>=0&&O[s()]&&v(O[s()]);break;case"Escape":n(!1),o(""),a(-1);break}},I=te=>{setTimeout(()=>{n(!1),o(""),a(-1)},150)},P=te=>({warehouse:"",store:"",supplier:"",customer:""})[te]||"",w=te=>({warehouse:"#2196F3",store:"#4CAF50",supplier:"#FF9800",customer:"#9C27B0"})[te]||"#757575",x={position:"relative",width:"100%",...t.style},j={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},ne={display:"flex","align-items":"stretch",width:"100%"},Q={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},K={...j,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},Z={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},k=te=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:te?"var(--strip-color)":"transparent",color:te?"var(--primary-dark)":"var(--text-primary)",transition:"all 0.2s ease"}),C={display:"flex","justify-content":"space-between","align-items":"center"},E={flex:"1"},M={"font-weight":"500","margin-bottom":"0.25rem"},_={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","align-items":"center"},S=te=>({padding:"0.2rem 0.5rem","border-radius":"var(--border-radius-sm)","font-size":"0.7rem","font-weight":"500",background:w(te),color:"white","text-transform":"uppercase"}),b={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},Y=()=>r()&&i()?i():c()?`${c().name} (${c().code})`:"";return(()=>{var te=Ck(),O=te.firstChild,D=O.firstChild;return m(O,ne),D.addEventListener("blur",I),D.$$keydown=p,D.$$click=f,D.$$input=y,l(O,(()=>{var X=Te(()=>!!t.onAddNew);return()=>X()&&(()=>{var H=Ik();return H.addEventListener("mouseleave",F=>{F.currentTarget.style.background="var(--surface-color)",F.currentTarget.style.color="var(--primary-color)"}),H.addEventListener("mouseenter",F=>{F.currentTarget.style.background="var(--primary-color)",F.currentTarget.style.color="white"}),as(H,"click",t.onAddNew,!0),m(H,Q),Se(()=>Yt(H,"title",e("inventory.addLocation","Add new location"))),H})()})(),null),l(te,B(Ge,{get when(){return r()},get children(){var X=c0();return l(X,B(Ge,{get when(){return u().length>0},get fallback(){return(()=>{var H=c0();return m(H,b),l(H,(()=>{var F=Te(()=>!!i());return()=>F()?e("inventory.noLocationsFound","No locations found matching your search."):e("inventory.noLocationsAvailable","No locations available.")})()),H})()},get children(){return B(Ht,{get each(){return u()},children:(H,F)=>(()=>{var ie=$k(),$=ie.firstChild,L=$.firstChild,U=L.firstChild,N=U.firstChild,z=U.nextSibling,oe=z.firstChild,G=oe.firstChild,ee=oe.nextSibling,J=z.nextSibling;return ie.addEventListener("mouseenter",()=>a(F())),ie.$$click=()=>v(H),m($,C),m(L,E),m(U,M),l(U,()=>P(H.type),N),l(U,()=>H.name,null),m(z,_),l(oe,()=>e("inventory.locationCode","Code"),G),l(oe,()=>H.code,null),l(ee,()=>H.type),J.style.setProperty("font-size","0.75rem"),J.style.setProperty("color","var(--text-muted)"),J.style.setProperty("margin-top","0.25rem"),l(J,()=>H.address),Se(W=>{var q=k(F()===s()),ae=S(H.type);return W.e=m(ie,q,W.e),W.t=m(ee,ae,W.t),W},{e:void 0,t:void 0}),ie})()})}})),Se(H=>m(X,Z,H)),X}}),null),Se(X=>{var H=x,F=K,ie=t.placeholder||e("inventory.searchLocations","Search locations by name, code, or type..."),$=t.disabled,L=t.required;return X.e=m(te,H,X.e),X.t=m(D,F,X.t),ie!==X.a&&Yt(D,"placeholder",X.a=ie),$!==X.o&&(D.disabled=X.o=$),L!==X.i&&(D.required=X.i=L),X},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>D.value=Y()),te})()};ur(["input","click","keydown"]);var kk=ue("<form><div><label> *</label><input type=text required></div><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text list=categories required><datalist id=categories><option value=Electronics></option><option value=Accessories></option><option value=Office></option><option value=Furniture></option><option value=Software></option><option value=Hardware></option></datalist></div></div><div><label></label><textarea></textarea></div><div><div><label></label><select><option value=pcs></option><option value=kg></option><option value=lbs></option><option value=m></option><option value=ft></option><option value=l></option><option value=gal></option><option value=box></option><option value=pack></option></select></div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div></div><div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div><div></div></div><div><div><label></label><input type=number min=0 step=1></div><div><label></label><input type=number min=1 step=1></div></div><div>"),Ek=ue("<div>");const Ny=t=>{const{t:e}=tr(),[r,n]=$e(""),[i,o]=$e(""),[s,a]=$e(""),[c,u]=$e(""),[f,y]=$e("pcs"),[v,p]=$e(0),[I,P]=$e(0),[w,x]=$e(10),[j,ne]=$e(100),[Q,K]=$e(""),Z=()=>{n(""),o(""),a(""),u(""),y("pcs"),p(0),P(0),x(10),ne(100),K("")},k=O=>{if(O.preventDefault(),K(""),!r().trim()){K(e("forms.productNameRequired"));return}if(!i().trim()){K(e("forms.skuRequired"));return}if(!c().trim()){K(e("forms.categoryRequired"));return}if(v()<0){K(e("forms.unitCostNotNegative"));return}if(I()<0){K(e("forms.sellingPriceNotNegative"));return}if(w()<0){K(e("forms.minStockNotNegative"));return}if(j()<=w()){K(e("forms.maxStockGreaterThanMin"));return}if(lt.getProductsBySku(i()).length>0){K(e("forms.skuAlreadyExists"));return}const X={name:r().trim(),sku:i().trim().toUpperCase(),description:s().trim(),category:c().trim(),unitOfMeasure:f(),unitCost:v(),sellingPrice:I(),minStockLevel:w(),maxStockLevel:j(),isActive:!0,businessId:"default-business"};lt.addProduct(X);const H=`prod-${Date.now()}`;t.onProductAdded&&t.onProductAdded(H),Z(),t.onClose()},C=()=>{Z(),t.onClose()},E={"margin-bottom":"1.5rem"},M={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},_={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},S={..._,cursor:"pointer"},b={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},Y={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},te={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"};return B(Qn,{get isOpen(){return t.isOpen},onClose:C,get title(){return e("inventory.addNewProduct")},get children(){var O=kk(),D=O.firstChild,X=D.firstChild,H=X.firstChild,F=X.nextSibling,ie=D.nextSibling,$=ie.firstChild,L=$.firstChild,U=L.firstChild,N=L.nextSibling,z=$.nextSibling,oe=z.firstChild,G=oe.firstChild,ee=oe.nextSibling,J=ie.nextSibling,W=J.firstChild,q=W.nextSibling,ae=J.nextSibling,de=ae.firstChild,le=de.firstChild,V=le.nextSibling,ce=V.firstChild,Pe=ce.nextSibling,fe=Pe.nextSibling,be=fe.nextSibling,xe=be.nextSibling,he=xe.nextSibling,ve=he.nextSibling,De=ve.nextSibling,Ee=De.nextSibling,Ce=de.nextSibling,Ne=Ce.firstChild,Ie=Ne.nextSibling,Re=ae.nextSibling,We=Re.firstChild,Fe=We.firstChild,Xe=Fe.nextSibling,tt=Re.nextSibling,At=tt.firstChild,rt=At.firstChild,He=rt.nextSibling,xt=At.nextSibling,_t=xt.firstChild,mt=_t.nextSibling,Et=tt.nextSibling;return O.addEventListener("submit",k),l(X,()=>e("inventory.productName"),H),F.addEventListener("change",et=>n(et.target.value)),l(L,()=>e("inventory.sku"),U),N.addEventListener("change",et=>o(et.target.value)),l(oe,()=>e("inventory.category"),G),ee.addEventListener("change",et=>u(et.target.value)),l(W,()=>e("common.description")),q.addEventListener("change",et=>a(et.target.value)),l(le,()=>e("inventory.unitOfMeasure")),V.addEventListener("change",et=>y(et.target.value)),l(ce,()=>e("inventory.pieces")),l(Pe,()=>e("inventory.kilograms")),l(fe,()=>e("inventory.pounds")),l(be,()=>e("inventory.meters")),l(xe,()=>e("inventory.feet")),l(he,()=>e("inventory.liters")),l(ve,()=>e("inventory.gallons")),l(De,()=>e("inventory.boxes")),l(Ee,()=>e("inventory.packs")),l(Ne,()=>e("inventory.unitCost")),Ie.addEventListener("change",et=>p(Number(et.target.value))),l(Fe,()=>e("inventory.sellingPrice")),Xe.addEventListener("change",et=>P(Number(et.target.value))),l(rt,()=>e("inventory.minimumStockLevel")),He.addEventListener("change",et=>x(Number(et.target.value))),l(_t,()=>e("inventory.maximumStockLevel")),mt.addEventListener("change",et=>ne(Number(et.target.value))),l(O,(()=>{var et=Te(()=>!!Q());return()=>et()&&(()=>{var qe=Ek();return m(qe,b),l(qe,Q),qe})()})(),Et),m(Et,Y),l(Et,B(Pt,{variant:"secondary",type:"button",onClick:C,get children(){return e("common.cancel")}}),null),l(Et,B(Pt,{variant:"primary",type:"submit",get children(){return e("inventory.addProduct")}}),null),Se(et=>{var qe=E,ot=M,Je=_,at=e("inventory.enterProductName"),dt=te,It=M,jt=_,Gt=e("inventory.enterSkuCode"),yt=M,Qt=_,Mt=e("inventory.enterCategory"),Kt=E,Xt=M,ht={..._,"min-height":"80px",resize:"vertical"},wt=e("inventory.enterProductDescription"),Ut=te,Ze=M,Vt=S,Ft=M,Jt=_,er=te,gt=M,dr=_,Er=te,mr=M,xr=_,Vr=M,kt=_;return et.e=m(D,qe,et.e),et.t=m(X,ot,et.t),et.a=m(F,Je,et.a),at!==et.o&&Yt(F,"placeholder",et.o=at),et.i=m(ie,dt,et.i),et.n=m(L,It,et.n),et.s=m(N,jt,et.s),Gt!==et.h&&Yt(N,"placeholder",et.h=Gt),et.r=m(oe,yt,et.r),et.d=m(ee,Qt,et.d),Mt!==et.l&&Yt(ee,"placeholder",et.l=Mt),et.u=m(J,Kt,et.u),et.c=m(W,Xt,et.c),et.w=m(q,ht,et.w),wt!==et.m&&Yt(q,"placeholder",et.m=wt),et.f=m(ae,Ut,et.f),et.y=m(le,Ze,et.y),et.g=m(V,Vt,et.g),et.p=m(Ne,Ft,et.p),et.b=m(Ie,Jt,et.b),et.T=m(Re,er,et.T),et.A=m(Fe,gt,et.A),et.O=m(Xe,dr,et.O),et.I=m(tt,Er,et.I),et.S=m(rt,mr,et.S),et.W=m(He,xr,et.W),et.C=m(_t,Vr,et.C),et.B=m(mt,kt,et.B),et},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),Se(()=>F.value=r()),Se(()=>N.value=i()),Se(()=>ee.value=c()),Se(()=>q.value=s()),Se(()=>V.value=f()),Se(()=>Ie.value=v()),Se(()=>Xe.value=I()),Se(()=>He.value=w()),Se(()=>mt.value=j()),O}})};var Tk=ue('<form><div><label> *</label><input type=text required></div><div><div><label> *<button type=button title="Generate code automatically"></button></label><input type=text required><div></div></div><div><label> *</label><select required><option value=warehouse> </option><option value=store> </option><option value=supplier> </option><option value=customer> </option></select><div></div></div></div><div><label> *</label><textarea required></textarea></div><div>'),Nk=ue("<div><div>:</div><div><span></span><div><div></div><div>"),Lk=ue("<div>");const Ly=t=>{const{t:e}=tr(),[r,n]=$e(""),[i,o]=$e(""),[s,a]=$e("warehouse"),[c,u]=$e(""),[f,y]=$e(""),v=()=>{n(""),o(""),a("warehouse"),u(""),y("")},p=()=>{if(r()){const _=s()==="warehouse"?"WH":s()==="store"?"ST":s()==="supplier"?"SUP":"CUST",S=r().toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,3),b=String(Math.floor(Math.random()*1e3)).padStart(3,"0");o(`${_}-${S}-${b}`)}},I=_=>{if(_.preventDefault(),y(""),!r().trim()){y(e("forms.locationNameRequired"));return}if(!i().trim()){y(e("forms.locationCodeRequired"));return}if(!c().trim()){y(e("forms.addressRequired"));return}if(lt.locations.filter(te=>te.code.toLowerCase()===i().toLowerCase()).length>0){y(e("forms.locationCodeExists"));return}const b={name:r().trim(),code:i().trim().toUpperCase(),type:s(),address:c().trim(),isActive:!0};lt.addLocation(b);const Y=`loc-${Date.now()}`;t.onLocationAdded&&t.onLocationAdded(Y),v(),t.onClose()},P=()=>{v(),t.onClose()},w={"margin-bottom":"1.5rem"},x={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},j={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},ne={...j,cursor:"pointer"},Q={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},K={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},Z={display:"grid","grid-template-columns":"2fr 1fr",gap:"1rem"},k={"font-size":"0.875rem",color:"var(--text-muted)","margin-top":"0.25rem"},C={padding:"0.25rem 0.5rem","font-size":"0.75rem","margin-left":"0.5rem",background:"var(--background-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",color:"var(--text-muted)"},E=_=>({warehouse:"",store:"",supplier:"",customer:""})[_]||"",M=_=>({warehouse:e("inventory.warehouseDescription"),store:e("inventory.storeDescription"),supplier:e("inventory.supplierDescription"),customer:e("inventory.customerDescription")})[_]||"";return B(Qn,{get isOpen(){return t.isOpen},onClose:P,get title(){return e("inventory.addNewLocation")},get children(){var _=Tk(),S=_.firstChild,b=S.firstChild,Y=b.firstChild,te=b.nextSibling,O=S.nextSibling,D=O.firstChild,X=D.firstChild,H=X.firstChild,F=H.nextSibling,ie=X.nextSibling,$=ie.nextSibling,L=D.nextSibling,U=L.firstChild,N=U.firstChild,z=U.nextSibling,oe=z.firstChild,G=oe.firstChild,ee=oe.nextSibling,J=ee.firstChild,W=ee.nextSibling,q=W.firstChild,ae=W.nextSibling,de=ae.firstChild,le=z.nextSibling,V=O.nextSibling,ce=V.firstChild,Pe=ce.firstChild,fe=ce.nextSibling,be=V.nextSibling;return _.addEventListener("submit",I),l(b,()=>e("inventory.locationName"),Y),te.addEventListener("change",xe=>n(xe.target.value)),m(O,Z),l(X,()=>e("inventory.locationCode"),H),F.$$click=p,m(F,C),l(F,()=>e("common.generate")),ie.addEventListener("change",xe=>o(xe.target.value)),l($,()=>e("inventory.uniqueIdentifierHelp")),l(U,()=>e("inventory.locationType"),N),z.addEventListener("change",xe=>a(xe.target.value)),l(oe,()=>E("warehouse"),G),l(oe,()=>e("inventory.warehouse"),null),l(ee,()=>E("store"),J),l(ee,()=>e("inventory.store"),null),l(W,()=>E("supplier"),q),l(W,()=>e("inventory.supplier"),null),l(ae,()=>E("customer"),de),l(ae,()=>e("inventory.customer"),null),l(le,()=>M(s())),l(ce,()=>e("common.address"),Pe),fe.addEventListener("change",xe=>u(xe.target.value)),l(_,(()=>{var xe=Te(()=>!!r());return()=>xe()&&(()=>{var he=Nk(),ve=he.firstChild,De=ve.firstChild,Ee=ve.nextSibling,Ce=Ee.firstChild,Ne=Ce.nextSibling,Ie=Ne.firstChild,Re=Ie.nextSibling;return he.style.setProperty("padding","1rem"),he.style.setProperty("background","var(--background-color)"),he.style.setProperty("border-radius","var(--border-radius-sm)"),he.style.setProperty("border","1px solid var(--border-color)"),he.style.setProperty("margin-bottom","1rem"),ve.style.setProperty("font-weight","500"),ve.style.setProperty("margin-bottom","0.5rem"),l(ve,()=>e("common.preview"),De),Ee.style.setProperty("display","flex"),Ee.style.setProperty("align-items","center"),Ee.style.setProperty("gap","0.5rem"),Ce.style.setProperty("font-size","1.2rem"),l(Ce,()=>E(s())),Ie.style.setProperty("font-weight","600"),l(Ie,r),Re.style.setProperty("font-size","0.875rem"),Re.style.setProperty("color","var(--text-muted)"),l(Re,(()=>{var We=Te(()=>!!i());return()=>We()&&`${i()}  `})(),null),l(Re,s,null),he})()})(),be),l(_,(()=>{var xe=Te(()=>!!f());return()=>xe()&&(()=>{var he=Lk();return m(he,Q),l(he,f),he})()})(),be),m(be,K),l(be,B(Pt,{variant:"secondary",type:"button",onClick:P,get children(){return e("common.cancel")}}),null),l(be,B(Pt,{variant:"primary",type:"submit",get children(){return e("inventory.addLocation")}}),null),Se(xe=>{var he=w,ve=x,De=j,Ee=e("inventory.enterLocationName"),Ce=x,Ne=j,Ie=e("inventory.enterUniqueCode"),Re=k,We=x,Fe=ne,Xe=k,tt=w,At=x,rt={...j,"min-height":"100px",resize:"vertical"},He=e("inventory.enterCompleteAddress");return xe.e=m(S,he,xe.e),xe.t=m(b,ve,xe.t),xe.a=m(te,De,xe.a),Ee!==xe.o&&Yt(te,"placeholder",xe.o=Ee),xe.i=m(X,Ce,xe.i),xe.n=m(ie,Ne,xe.n),Ie!==xe.s&&Yt(ie,"placeholder",xe.s=Ie),xe.h=m($,Re,xe.h),xe.r=m(U,We,xe.r),xe.d=m(z,Fe,xe.d),xe.l=m(le,Xe,xe.l),xe.u=m(V,tt,xe.u),xe.c=m(ce,At,xe.c),xe.w=m(fe,rt,xe.w),He!==xe.m&&Yt(fe,"placeholder",xe.m=He),xe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),Se(()=>te.value=r()),Se(()=>ie.value=i()),Se(()=>z.value=s()),Se(()=>fe.value=c()),_}})};ur(["click"]);var Dk=ue("<form><div>"),u0=ue("<div><label> *"),Rk=ue("<div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment>"),Mk=ue("<div><label>"),Fk=ue("<div><label> *</label><input type=number min=0 step=1 required>"),Ok=ue("<div><label></label><input type=number min=0 step=0.01>"),Bk=ue("<div><label></label><input type=text>"),jk=ue("<div><label></label><textarea>"),Vk=ue("<div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span>:</span><span> "),zk=ue("<div><div><span>:</span><span>"),qk=ue("<div>");const Uk=t=>{const{t:e}=tr(),[r,n]=$e({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""}),[i,o]=$e(""),[s,a]=$e(""),[c,u]=$e("in"),[f,y]=$e(0),[v,p]=$e(0),[I,P]=$e(""),[w,x]=$e(""),[j,ne]=$e(""),[Q,K]=$e(""),[Z,k]=$e(!1),[C,E]=$e(!1),M=()=>t.mode==="movement",_=Nt(()=>i()?lt.getProductById(i()):null),S=Nt(()=>s()?lt.getLocationById(s()):null),b=Nt(()=>j()?lt.getLocationById(j()):null),Y=Nt(()=>f()*v()),te=Nt(()=>!i()||!s()?0:lt.getStockByProductAndLocation(i(),s())?.quantity||0),O=[{value:"Electronics",label:"Electronics"},{value:"Accessories",label:"Accessories"},{value:"Furniture",label:"Furniture"},{value:"Office Supplies",label:"Office Supplies"},{value:"Software",label:"Software"},{value:"Hardware",label:"Hardware"},{value:"Consumables",label:"Consumables"}],D=[{value:"Warehouse A",label:"Warehouse A"},{value:"Warehouse B",label:"Warehouse B"},{value:"Warehouse C",label:"Warehouse C"},{value:"Storage Room",label:"Storage Room"},{value:"Main Office",label:"Main Office"}],X={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},H=()=>{o(""),a(""),u("in"),y(0),p(0),P(""),x(""),ne(""),K("")},F=()=>{n({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""})},ie=ae=>{if(ae.preventDefault(),M()){if(K(""),!i()){K(e("forms.selectProduct"));return}if(!s()){K(e("forms.selectLocation"));return}if(f()<=0){K(e("forms.quantityGreaterThanZero"));return}if(v()<0){K(e("forms.unitCostNotNegative"));return}if(c()==="transfer"&&!j()){K(e("forms.selectFromLocation"));return}if(c()==="transfer"&&j()===s()){K(e("forms.sameLocationError"));return}if(c()==="out"&&f()>te()){K(e("forms.insufficientStock",{currentStock:te()}));return}const de=_(),le=S(),V={productId:de.id,productName:de.name,productSku:de.sku,locationId:le.id,locationName:le.name,movementType:c(),quantity:f(),unitCost:v()||de.unitCost,totalCost:Y()||f()*de.unitCost,referenceNumber:I()||`AUTO-${Date.now()}`,notes:w(),createdBy:"admin",fromLocationId:c()==="transfer"?j():void 0,fromLocationName:c()==="transfer"?b()?.name:void 0};lt.addInventoryMovement(V),H()}else{const de=r();if(!de.name||!de.price||!de.quantity||!de.category||!de.sku||!de.supplier||!de.minStock||!de.location){alert(e("forms.fillAllRequired"));return}const le={name:de.name,price:parseFloat(de.price),quantity:parseInt(de.quantity),category:de.category,description:de.description,sku:de.sku,supplier:de.supplier,minStock:parseInt(de.minStock),location:de.location};lt.addItem(le),F()}t.onClose()},$=(ae,de)=>{n(le=>({...le,[ae]:de}))},L=()=>{M()?H():F(),t.onClose()},U=ae=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ae),N={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},z={...N,cursor:"pointer"},oe={color:"#f44336","font-size":"0.875rem","margin-top":"0.5rem"},G={padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},ee={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},J={"font-weight":"500",color:"var(--text-muted)"},W={"font-weight":"600",color:"var(--text-primary)"},q=()=>M()?e("inventory.addMovement"):e("inventory.addNewItem");return B(Qn,{get isOpen(){return t.isOpen},onClose:L,get title(){return q()},get children(){return[(()=>{var ae=Dk(),de=ae.firstChild;return ae.addEventListener("submit",ie),l(ae,(()=>{var le=Te(()=>!!M());return()=>le()?[(()=>{var V=u0(),ce=V.firstChild,Pe=ce.firstChild;return V.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),l(ce,()=>e("inventory.product"),Pe),l(V,B(cf,{get value(){return i()},onChange:fe=>{o(fe);const be=lt.getProductById(fe);be&&p(be.unitCost)},get placeholder(){return e("inventory.searchProductsPlaceholder")},onAddNew:()=>k(!0),required:!0}),null),V})(),(()=>{var V=Rk(),ce=V.firstChild,Pe=ce.firstChild,fe=ce.nextSibling,be=fe.firstChild,xe=be.nextSibling,he=xe.nextSibling,ve=he.nextSibling;return V.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),l(ce,()=>e("inventory.movementType"),Pe),fe.addEventListener("change",De=>u(De.target.value)),l(be,()=>e("inventory.stockInPurchase")),l(xe,()=>e("inventory.stockOutSale")),l(he,()=>e("inventory.transferBetween")),l(ve,()=>e("inventory.stockAdjustment")),Se(De=>m(fe,z,De)),Se(()=>fe.value=c()),V})(),Te(()=>Te(()=>c()==="transfer")()&&(()=>{var V=u0(),ce=V.firstChild,Pe=ce.firstChild;return V.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),l(ce,()=>e("inventory.fromLocation"),Pe),l(V,B(Ou,{get value(){return j()},onChange:fe=>ne(fe),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>E(!0),required:!0}),null),V})()),(()=>{var V=Mk(),ce=V.firstChild;return V.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),l(ce,(()=>{var Pe=Te(()=>c()==="transfer");return()=>Pe()?e("inventory.toLocation")+" *":e("inventory.locationName")+" *"})()),l(V,B(Ou,{get value(){return s()},onChange:Pe=>a(Pe),get placeholder(){return Te(()=>c()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>E(!0),required:!0}),null),V})(),Te(()=>Te(()=>!!(_()&&S()))()&&(()=>{var V=Vk(),ce=V.firstChild,Pe=ce.firstChild,fe=Pe.firstChild,be=Pe.nextSibling,xe=be.firstChild,he=ce.nextSibling,ve=he.firstChild,De=ve.firstChild,Ee=ve.nextSibling,Ce=he.nextSibling,Ne=Ce.firstChild,Ie=Ne.firstChild,Re=Ne.nextSibling,We=Re.firstChild;return l(Pe,()=>e("inventory.currentStockAt",{location:S()?.name}),fe),l(be,te,xe),l(be,()=>_()?.unitOfMeasure,null),l(ve,()=>e("inventory.productCost"),De),l(Ee,()=>U(_()?.unitCost||0)),l(Ne,()=>e("inventory.minStockLevel"),Ie),l(Re,()=>_()?.minStockLevel,We),l(Re,()=>_()?.unitOfMeasure,null),Se(Fe=>{var Xe=G,tt=ee,At=J,rt=W,He=ee,xt=J,_t=W,mt=ee,Et=J,et=W;return Fe.e=m(V,Xe,Fe.e),Fe.t=m(ce,tt,Fe.t),Fe.a=m(Pe,At,Fe.a),Fe.o=m(be,rt,Fe.o),Fe.i=m(he,He,Fe.i),Fe.n=m(ve,xt,Fe.n),Fe.s=m(Ee,_t,Fe.s),Fe.h=m(Ce,mt,Fe.h),Fe.r=m(Ne,Et,Fe.r),Fe.d=m(Re,et,Fe.d),Fe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),V})()),(()=>{var V=Fk(),ce=V.firstChild,Pe=ce.firstChild,fe=ce.nextSibling;return V.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),l(ce,()=>e("inventory.quantity"),Pe),fe.addEventListener("change",be=>y(Number(be.target.value))),Se(be=>m(fe,N,be)),Se(()=>fe.value=f()),V})(),(()=>{var V=Ok(),ce=V.firstChild,Pe=ce.nextSibling;return V.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),l(ce,()=>e("inventory.unitCost")),Pe.addEventListener("change",fe=>p(Number(fe.target.value))),Se(fe=>{var be=N,xe=e("inventory.willUseDefaultCost");return fe.e=m(Pe,be,fe.e),xe!==fe.t&&Yt(Pe,"placeholder",fe.t=xe),fe},{e:void 0,t:void 0}),Se(()=>Pe.value=v()),V})(),Te(()=>Te(()=>f()>0&&v()>0)()&&(()=>{var V=zk(),ce=V.firstChild,Pe=ce.firstChild,fe=Pe.firstChild,be=Pe.nextSibling;return l(Pe,()=>e("inventory.totalCost"),fe),l(be,()=>U(Y())),Se(xe=>{var he=G,ve=ee,De=J,Ee={...W,"font-size":"1.2rem",color:"var(--primary-color)"};return xe.e=m(V,he,xe.e),xe.t=m(ce,ve,xe.t),xe.a=m(Pe,De,xe.a),xe.o=m(be,Ee,xe.o),xe},{e:void 0,t:void 0,a:void 0,o:void 0}),V})()),(()=>{var V=Bk(),ce=V.firstChild,Pe=ce.nextSibling;return V.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),l(ce,()=>e("common.referenceNumber")),Pe.addEventListener("change",fe=>P(fe.target.value)),Se(fe=>{var be=N,xe=e("common.referenceNumberPlaceholder");return fe.e=m(Pe,be,fe.e),xe!==fe.t&&Yt(Pe,"placeholder",fe.t=xe),fe},{e:void 0,t:void 0}),Se(()=>Pe.value=I()),V})(),(()=>{var V=jk(),ce=V.firstChild,Pe=ce.nextSibling;return V.style.setProperty("margin-bottom","1.5rem"),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),l(ce,()=>e("common.notes")),Pe.addEventListener("change",fe=>x(fe.target.value)),Se(fe=>{var be={...N,"min-height":"100px",resize:"vertical"},xe=e("inventory.additionalNotesPlaceholder");return fe.e=m(Pe,be,fe.e),xe!==fe.t&&Yt(Pe,"placeholder",fe.t=xe),fe},{e:void 0,t:void 0}),Se(()=>Pe.value=w()),V})(),Te(()=>Te(()=>!!Q())()&&(()=>{var V=qk();return m(V,oe),l(V,Q),V})())]:[B(Or,{get label(){return e("inventory.itemName")},get value(){return r().name},onChange:V=>$("name",V),get placeholder(){return e("inventory.enterItemName")},required:!0}),B(Or,{get label(){return e("inventory.sku")},get value(){return r().sku},onChange:V=>$("sku",V),get placeholder(){return e("inventory.enterSkuCode")},required:!0}),B(ci,{get label(){return e("inventory.category")},get value(){return r().category},onChange:V=>$("category",V),options:O,required:!0}),B(Or,{get label(){return e("common.description")},get value(){return r().description},onChange:V=>$("description",V),get placeholder(){return e("inventory.enterItemDescription")}}),B(Or,{get label(){return e("common.price")},type:"number",get value(){return r().price},onChange:V=>$("price",V),get placeholder(){return e("common.enterPrice")},required:!0}),B(Or,{get label(){return e("inventory.quantity")},type:"number",get value(){return r().quantity},onChange:V=>$("quantity",V),get placeholder(){return e("inventory.enterQuantity")},required:!0}),B(Or,{get label(){return e("inventory.minimumStock")},type:"number",get value(){return r().minStock},onChange:V=>$("minStock",V),get placeholder(){return e("inventory.enterMinStockLevel")},required:!0}),B(Or,{get label(){return e("inventory.supplier")},get value(){return r().supplier},onChange:V=>$("supplier",V),get placeholder(){return e("inventory.enterSupplierName")},required:!0}),B(ci,{get label(){return e("inventory.location")},get value(){return r().location},onChange:V=>$("location",V),options:D,required:!0})]})(),de),m(de,X),l(de,B(Pt,{variant:"secondary",type:"button",onClick:L,get children(){return e("common.cancel")}}),null),l(de,B(Pt,{variant:"primary",type:"submit",get children(){return Te(()=>!!M())()?e("inventory.addMovement"):e("inventory.addItem")}}),null),ae})(),B(Ny,{get isOpen(){return Z()},onClose:()=>k(!1),onProductAdded:ae=>{o(ae),k(!1)}}),B(Ly,{get isOpen(){return C()},onClose:()=>E(!1),onLocationAdded:ae=>{c()==="transfer"&&!j()?ne(ae):a(ae),E(!1)}})]}})};ur(["input","keydown"]);var Hk=ue("<form><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text required></div></div><div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><div><label></label></div></div><div><div><h3></h3></div></div><div><label></label><textarea></textarea></div><div>"),Wk=ue("<div><label> *"),Gk=ue("<div><div></div><div></div><div></div><div></div><div>"),Zf=ue("<div>"),Yk=ue("<div><input type=number min=0 step=1 required><input type=number min=0 step=0.01><input type=text>"),Kk=ue("<div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span>"),Jk=ue("<div> ");const Qk=t=>{const{t:e}=tr(),[r,n]=$e(`INV-${Date.now()}`),[i,o]=$e(""),[s,a]=$e("in"),[c,u]=$e(""),[f,y]=$e(""),[v,p]=$e(""),[I,P]=$e([]),[w,x]=$e([]),[j,ne]=$e(!1),[Q,K]=$e(!1),Z=()=>{P(G=>[...G,{productId:"",quantity:0,unitCost:0,notes:""}])},k=G=>{P(ee=>ee.filter((J,W)=>W!==G))},C=(G,ee,J)=>{P(W=>W.map((q,ae)=>ae===G?{...q,[ee]:J}:q))},E=()=>{n(`INV-${Date.now()}`),o(""),a("in"),u(""),y(""),p(""),P([]),x([])},M=async G=>{G.preventDefault(),x([]);const ee=[];if(i()||ee.push(e("forms.referenceNumberRequired")),c()||ee.push(e("forms.locationRequired")),s()==="transfer"&&!f()&&ee.push(e("forms.fromLocationRequired")),I().length===0&&ee.push(e("forms.atLeastOneProduct")),I().forEach((q,ae)=>{q.productId||ee.push(e("forms.itemProductRequired","Product is required for item {{index}}",{index:ae+1})),q.quantity<=0&&ee.push(e("forms.itemQuantityRequired","Quantity must be greater than 0 for item {{index}}",{index:ae+1}))}),ee.length>0){x(ee);return}const J={ssg_inventory_key:Dm(),invoiceId:r(),referenceNumber:i(),movementType:s(),type:Mp(s()),locationId:c(),fromLocationId:s()==="transfer"?f():void 0,items:I(),products:I(),generalNotes:v(),description:v(),invoice:i(),store:c(),createdBy:"admin",createDate:new Date().toISOString()};console.log(J);const W=await lt.addBulkInventoryMovements(J);console.log(W),W.success?t.onMovementComplete?t.onMovementComplete(i()):(E(),t.onClose()):x(W.errors)},_=()=>{E(),t.onClose()},S=Nt(()=>I().reduce((G,ee)=>{const J=lt.getProductById(ee.productId),W=ee.unitCost||J?.unitCost||0;return G+ee.quantity*W},0)),b=Nt(()=>I().reduce((G,ee)=>G+ee.quantity,0)),Y={"margin-bottom":"1.5rem"},te={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},O={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},D={...O,cursor:"pointer"},X={display:"grid",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},H={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},F={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem","padding-left":"0.75rem"},ie={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},$={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},L={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},U={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},N=G=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(G),z=G=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[G]||G,oe=async G=>{await lt.fecthInventory(G),await lt.fecthProduct(G)};return Nn(()=>{oe("prod")}),B(Qn,{get isOpen(){return t.isOpen},onClose:_,get title(){return e("inventory.bulkMovement")},get children(){return[(()=>{var G=Hk(),ee=G.firstChild,J=ee.firstChild,W=J.firstChild,q=W.firstChild,ae=W.nextSibling,de=J.nextSibling,le=de.firstChild,V=le.firstChild,ce=le.nextSibling,Pe=ee.nextSibling,fe=Pe.firstChild,be=fe.firstChild,xe=fe.nextSibling,he=xe.firstChild,ve=he.nextSibling,De=ve.nextSibling,Ee=De.nextSibling,Ce=Pe.nextSibling,Ne=Ce.firstChild,Ie=Ne.firstChild,Re=Ce.nextSibling,We=Re.firstChild,Fe=We.firstChild,Xe=Re.nextSibling,tt=Xe.firstChild,At=tt.nextSibling,rt=Xe.nextSibling;return G.addEventListener("submit",M),ee.style.setProperty("display","grid"),ee.style.setProperty("grid-template-columns","1fr 1fr"),ee.style.setProperty("gap","1rem"),ee.style.setProperty("margin-bottom","1.5rem"),l(W,()=>e("common.invoiceDocumentId"),q),ae.addEventListener("change",He=>n(He.target.value)),l(le,()=>e("common.referenceNumber"),V),ce.addEventListener("change",He=>o(He.target.value)),l(fe,()=>e("inventory.movementType"),be),xe.addEventListener("change",He=>a(He.target.value)),l(he,()=>e("inventory.purchaseReceive")),l(ve,()=>e("inventory.saleIssue")),l(De,()=>e("inventory.transfer")),l(Ee,()=>e("inventory.adjustment")),Ce.style.setProperty("display","grid"),Ce.style.setProperty("gap","1rem"),Ce.style.setProperty("margin-bottom","1.5rem"),l(Ce,(()=>{var He=Te(()=>s()==="transfer");return()=>He()&&(()=>{var xt=Wk(),_t=xt.firstChild,mt=_t.firstChild;return l(_t,()=>e("inventory.fromLocation"),mt),l(xt,B(Ou,{get value(){return f()},onChange:Et=>y(Et),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>K(!0),required:!0}),null),Se(Et=>m(_t,te,Et)),xt})()})(),Ne),l(Ie,(()=>{var He=Te(()=>s()==="transfer");return()=>He()?e("inventory.toLocation")+" *":e("inventory.location")+" *"})()),l(Ne,B(Ou,{get value(){return c()},onChange:He=>u(He),get placeholder(){return Te(()=>s()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>K(!0),required:!0}),null),We.style.setProperty("display","flex"),We.style.setProperty("justify-content","space-between"),We.style.setProperty("align-items","center"),We.style.setProperty("margin-bottom","1rem"),Fe.style.setProperty("margin","0"),Fe.style.setProperty("font-size","1.1rem"),l(Fe,()=>e("inventory.products")),l(We,B(Pt,{variant:"outline",type:"button",onClick:Z,get children(){return e("inventory.addProduct")}}),null),l(Re,(()=>{var He=Te(()=>I().length>0);return()=>He()&&[(()=>{var xt=Gk(),_t=xt.firstChild,mt=_t.nextSibling,Et=mt.nextSibling,et=Et.nextSibling;return m(xt,F),l(_t,()=>e("inventory.product")),l(mt,()=>e("inventory.quantity")),l(Et,()=>e("inventory.unitCost")),l(et,()=>e("common.notes")),xt})(),B(Ht,{get each(){return I()},children:(xt,_t)=>[(()=>{var mt=Zf();return m(mt,X),l(mt,B(cf,{get value(){return xt.productId},onChange:Et=>{C(_t(),"productId",Et.id);let et={id:Et.id,label:Et.name,code:Et.sku};C(_t(),"product",et);const qe=lt.getProductById(Et.id);qe&&!xt.unitCost&&C(_t(),"unitCost",qe.unitCost)},get placeholder(){return e("inventory.searchProduct")},onAddNew:()=>ne(!0),required:!0})),mt})(),(()=>{var mt=Yk(),Et=mt.firstChild,et=Et.nextSibling,qe=et.nextSibling;return m(mt,H),Et.addEventListener("change",ot=>C(_t(),"quantity",Number(ot.target.value))),et.addEventListener("change",ot=>C(_t(),"unitCost",Number(ot.target.value))),qe.addEventListener("change",ot=>C(_t(),"notes",ot.target.value)),l(mt,B(Pt,{variant:"outline",size:"sm",type:"button",onClick:()=>k(_t()),style:{color:"#f44336","border-color":"#f44336"},get children(){return e("common.remove")}}),null),Se(ot=>{var Je=O,at=O,dt=e("common.auto"),It=O,jt=e("common.optionalNotes");return ot.e=m(Et,Je,ot.e),ot.t=m(et,at,ot.t),dt!==ot.a&&Yt(et,"placeholder",ot.a=dt),ot.o=m(qe,It,ot.o),jt!==ot.i&&Yt(qe,"placeholder",ot.i=jt),ot},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>Et.value=xt.quantity),Se(()=>et.value=xt.unitCost),Se(()=>qe.value=xt.notes),mt})()]})]})(),null),l(Re,(()=>{var He=Te(()=>I().length===0);return()=>He()&&(()=>{var xt=Zf();return xt.style.setProperty("text-align","center"),xt.style.setProperty("padding","2rem"),xt.style.setProperty("background","var(--background-color)"),xt.style.setProperty("border-radius","var(--border-radius-sm)"),xt.style.setProperty("border","1px solid var(--border-color)"),xt.style.setProperty("color","var(--text-muted)"),l(xt,()=>e("inventory.noProductsAdded")),xt})()})(),null),l(G,(()=>{var He=Te(()=>I().length>0);return()=>He()&&(()=>{var xt=Kk(),_t=xt.firstChild,mt=_t.nextSibling,Et=mt.firstChild,et=Et.firstChild,qe=Et.nextSibling,ot=mt.nextSibling,Je=ot.firstChild,at=Je.firstChild,dt=Je.nextSibling,It=ot.nextSibling,jt=It.firstChild,Gt=jt.firstChild,yt=jt.nextSibling,Qt=It.nextSibling,Mt=Qt.firstChild,Kt=Mt.firstChild,Xt=Mt.nextSibling;return m(xt,ie),_t.style.setProperty("margin","0 0 1rem 0"),_t.style.setProperty("font-size","1rem"),l(_t,()=>e("common.summary")),l(Et,()=>e("inventory.totalProducts"),et),qe.style.setProperty("font-weight","600"),l(qe,()=>I().length),l(Je,()=>e("inventory.totalItems"),at),dt.style.setProperty("font-weight","600"),l(dt,b),l(jt,()=>e("inventory.totalValue"),Gt),yt.style.setProperty("font-weight","600"),yt.style.setProperty("color","var(--primary-color)"),l(yt,()=>N(S())),l(Mt,()=>e("inventory.movementType"),Kt),Xt.style.setProperty("font-weight","600"),l(Xt,()=>z(s())),Se(ht=>{var wt=$,Ut=$,Ze=$,Vt=$;return ht.e=m(mt,wt,ht.e),ht.t=m(ot,Ut,ht.t),ht.a=m(It,Ze,ht.a),ht.o=m(Qt,Vt,ht.o),ht},{e:void 0,t:void 0,a:void 0,o:void 0}),xt})()})(),Xe),l(tt,()=>e("common.generalNotes")),At.addEventListener("change",He=>p(He.target.value)),l(G,(()=>{var He=Te(()=>w().length>0);return()=>He()&&(()=>{var xt=Zf();return m(xt,L),l(xt,B(Ht,{get each(){return w()},children:_t=>(()=>{var mt=Jk();return mt.firstChild,l(mt,_t,null),mt})()})),xt})()})(),rt),m(rt,U),l(rt,B(Pt,{variant:"secondary",type:"button",onClick:_,get children(){return e("common.cancel")}}),null),l(rt,B(Pt,{variant:"primary",type:"submit",get children(){return e("inventory.createMovement")}}),null),Se(He=>{var xt=te,_t=O,mt=te,Et=O,et=e("common.referenceNumberPlaceholder"),qe=Y,ot=te,Je=D,at=s()==="transfer"?"1fr 1fr":"1fr",dt=te,It=Y,jt=Y,Gt=te,yt={...O,"min-height":"80px",resize:"vertical"},Qt=e("inventory.generalNotesPlaceholder");return He.e=m(W,xt,He.e),He.t=m(ae,_t,He.t),He.a=m(le,mt,He.a),He.o=m(ce,Et,He.o),et!==He.i&&Yt(ce,"placeholder",He.i=et),He.n=m(Pe,qe,He.n),He.s=m(fe,ot,He.s),He.h=m(xe,Je,He.h),at!==He.r&&((He.r=at)!=null?Ce.style.setProperty("grid-template-columns",at):Ce.style.removeProperty("grid-template-columns")),He.d=m(Ie,dt,He.d),He.l=m(Re,It,He.l),He.u=m(Xe,jt,He.u),He.c=m(tt,Gt,He.c),He.w=m(At,yt,He.w),Qt!==He.m&&Yt(At,"placeholder",He.m=Qt),He},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),Se(()=>ae.value=r()),Se(()=>ce.value=i()),Se(()=>xe.value=s()),Se(()=>At.value=v()),G})(),B(Ny,{get isOpen(){return j()},onClose:()=>ne(!1),onProductAdded:G=>{ne(!1)}}),B(Ly,{get isOpen(){return Q()},onClose:()=>K(!1),onLocationAdded:G=>{s()==="transfer"&&!f()?y(G):u(G),K(!1)}})]}})};var Xk=ue("<button>"),Zk=ue("<div><h3></h3><button> "),eE=ue("<div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),ep=ue("<div><strong>:</strong> "),tE=ue("<div>"),rE=ue("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),nE=ue("<div><div><h2></h2><div><select><option value=date></option><option value=quantity></option><option value=value></option></select></div></div><div>"),iE=ue("<div><div><h3></h3><div></div></div><div><span></span><div>"),oE=ue("<div><div><strong>:</strong> "),sE=ue("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),aE=ue("<div><button></button><button>"),lE=ue("<tr><td></td><td></td><td></td><td></td><td></td><td>");const w5=t=>{const{t:e}=tr(),[r,n]=$e(null),[i,o]=$e("date"),s=Nt(()=>{const v=t.movements||lt.movements,p=new Map;return v.forEach(I=>{const P=I.referenceNumber||I.ssg_inventory_key||I.invoiceId||"UNKNOWN";if(!p.has(P)){const j=lt.getLocationById(I.locationId);p.set(P,{referenceNumber:I.referenceNumber||"",invoiceId:I.invoiceId||"",ssg_inventory_key:I.ssg_inventory_key||"",movementType:I.movementType||"unknown",locationId:I.locationId||"",locationName:j?.name||"Unknown Location",totalItems:0,totalQuantity:0,createDate:I.createDate||new Date().toISOString(),description:I.description||"",generalNotes:I.generalNotes||"",movements:[],totalValue:0})}const w=p.get(P);w.movements.push(I),w.totalItems++,w.totalQuantity+=Math.abs(I.quantity||0);const x=lt.getProductById(I.productId);x&&x.unitCost&&(w.totalValue+=Math.abs(I.quantity||0)*x.unitCost)}),Array.from(p.values()).sort((I,P)=>{switch(i()){case"quantity":return P.totalQuantity-I.totalQuantity;case"value":return P.totalValue-I.totalValue;case"date":default:return new Date(P.createDate).getTime()-new Date(I.createDate).getTime()}})}),a=v=>new Date(v).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),c=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(v),u=v=>{switch(v.toLowerCase()){case"in":case"stock_in":return"#22c55e";case"out":case"stock_out":return"#ef4444";case"transfer":return"#3b82f6";case"adjustment":return"#f59e0b";default:return"#6b7280"}},f=v=>{switch(v.toLowerCase()){case"in":case"stock_in":return"";case"out":case"stock_out":return"";case"transfer":return"";case"adjustment":return"";default:return""}},y=v=>{const p=v||r();if(!p)return;const I=window.open("","_blank");if(!I)return;const P=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Bulk Movement Report - ${p.referenceNumber||p.invoiceId}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 20px; }
          .group-info { background: #f8f9fa; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
          .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
          table { width: 100%; border-collapse: collapse; margin-top: 15px; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background-color: #f2f2f2; font-weight: bold; }
          .summary { background: #e8f4fd; padding: 15px; margin-top: 20px; border-radius: 5px; }
          @media print { body { margin: 0; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>BULK MOVEMENT REPORT</h1>
          <h2>${p.referenceNumber||p.invoiceId}</h2>
          <p>Generated: ${a(new Date().toISOString())}</p>
        </div>
        
        <div class="group-info">
          <div class="info-grid">
            <div>
              <strong>Reference Number:</strong> ${p.referenceNumber||"N/A"}<br>
              <strong>Invoice ID:</strong> ${p.invoiceId||"N/A"}<br>
              <strong>Movement Type:</strong> ${p.movementType.toUpperCase()}<br>
              <strong>Location:</strong> ${p.locationName}
            </div>
            <div>
              <strong>Date:</strong> ${a(p.createDate)}<br>
              <strong>Total Items:</strong> ${p.totalItems}<br>
              <strong>Total Quantity:</strong> ${p.totalQuantity}<br>
              <strong>Estimated Value:</strong> ${c(p.totalValue)}
            </div>
          </div>
          ${p.description?`<p><strong>Description:</strong> ${p.description}</p>`:""}
          ${p.generalNotes?`<p><strong>Notes:</strong> ${p.generalNotes}</p>`:""}
        </div>
        
        <table>
          <thead>
            <tr>
              <th>Product Code</th>
              <th>Product Name</th>
              <th>Quantity</th>
              <th>Unit Cost</th>
              <th>Total Value</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody>
            ${p.movements.map(w=>{const x=lt.getProductById(w.productId),j=x?.unitCost||0,ne=Math.abs(w.quantity||0)*j;return`
                <tr>
                  <td>${x?.code||w.productId}</td>
                  <td>${x?.name||"Unknown Product"}</td>
                  <td>${w.quantity||0}</td>
                  <td>${c(j)}</td>
                  <td>${c(ne)}</td>
                  <td>${w.notes||"-"}</td>
                </tr>
              `}).join("")}
          </tbody>
        </table>
        
        <div class="summary">
          <h3>SUMMARY</h3>
          <p><strong>Total Products:</strong> ${p.totalItems}</p>
          <p><strong>Total Quantity Moved:</strong> ${p.totalQuantity}</p>
          <p><strong>Total Estimated Value:</strong> ${c(p.totalValue)}</p>
          <p><strong>Movement Impact:</strong> ${p.movementType==="in"?"Increased":p.movementType==="out"?"Decreased":"Adjusted"} inventory</p>
        </div>
      </body>
      </html>
    `;I.document.write(P),I.document.close(),I.print()};return(()=>{var v=nE(),p=v.firstChild,I=p.firstChild,P=I.nextSibling,w=P.firstChild,x=w.firstChild,j=x.nextSibling,ne=j.nextSibling,Q=p.nextSibling;return v.style.setProperty("padding","1rem"),p.style.setProperty("display","flex"),p.style.setProperty("justify-content","space-between"),p.style.setProperty("align-items","center"),p.style.setProperty("margin-bottom","2rem"),l(I,()=>e("inventory.bulkMovementReport","Bulk Movement Report")),P.style.setProperty("display","flex"),P.style.setProperty("gap","1rem"),w.addEventListener("change",K=>o(K.currentTarget.value)),w.style.setProperty("padding","0.5rem"),l(x,()=>e("common.sortByDate","Sort by Date")),l(j,()=>e("common.sortByQuantity","Sort by Quantity")),l(ne,()=>e("common.sortByValue","Sort by Value")),l(P,B(Ge,{get when(){return t.onClose},get children(){var K=Xk();return as(K,"click",t.onClose,!0),K.style.setProperty("padding","0.5rem 1rem"),K.style.setProperty("background","#6c757d"),K.style.setProperty("color","white"),K.style.setProperty("border","none"),K.style.setProperty("border-radius","var(--border-radius-sm)"),K.style.setProperty("cursor","pointer"),l(K,()=>e("common.close","Close")),K}}),null),Q.style.setProperty("display","grid"),Q.style.setProperty("grid-template-columns","repeat(auto-fill, minmax(400px, 1fr))"),Q.style.setProperty("gap","1rem"),Q.style.setProperty("margin-bottom","2rem"),l(Q,B(Ht,{get each(){return s()},children:K=>B(Tt,{get style(){return{cursor:"pointer",border:r()===K?"2px solid var(--primary-color)":"1px solid #e9ecef",transition:"all 0.2s"}},onClick:()=>n(K),get children(){return[(()=>{var Z=iE(),k=Z.firstChild,C=k.firstChild,E=C.nextSibling,M=k.nextSibling,_=M.firstChild,S=_.nextSibling;return Z.style.setProperty("display","flex"),Z.style.setProperty("justify-content","space-between"),Z.style.setProperty("align-items","flex-start"),Z.style.setProperty("margin-bottom","1rem"),C.style.setProperty("margin","0 0 0.5rem 0"),C.style.setProperty("font-size","1.1rem"),l(C,()=>K.referenceNumber||K.invoiceId||"No Reference"),E.style.setProperty("font-size","0.875rem"),E.style.setProperty("color","#6c757d"),l(E,()=>a(K.createDate)),M.style.setProperty("text-align","center"),_.style.setProperty("font-size","1.5rem"),l(_,()=>f(K.movementType)),S.style.setProperty("font-size","0.75rem"),S.style.setProperty("font-weight","bold"),l(S,()=>K.movementType.toUpperCase()),Se(b=>(b=u(K.movementType))!=null?S.style.setProperty("color",b):S.style.removeProperty("color")),Z})(),(()=>{var Z=oE(),k=Z.firstChild,C=k.firstChild,E=C.firstChild;return C.nextSibling,Z.style.setProperty("margin-bottom","1rem"),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("margin-bottom","0.25rem"),l(C,()=>e("inventory.location","Location"),E),l(k,()=>K.locationName,null),l(Z,B(Ge,{get when(){return K.description},get children(){var M=ep(),_=M.firstChild,S=_.firstChild;return _.nextSibling,M.style.setProperty("font-size","0.875rem"),M.style.setProperty("margin-bottom","0.25rem"),l(_,()=>e("common.description","Description"),S),l(M,()=>K.description,null),M}}),null),Z})(),(()=>{var Z=sE(),k=Z.firstChild,C=k.firstChild,E=C.nextSibling,M=k.nextSibling,_=M.firstChild,S=_.nextSibling,b=M.nextSibling,Y=b.firstChild,te=Y.nextSibling;return Z.style.setProperty("display","grid"),Z.style.setProperty("grid-template-columns","repeat(3, 1fr)"),Z.style.setProperty("gap","0.5rem"),Z.style.setProperty("margin-bottom","1rem"),k.style.setProperty("text-align","center"),k.style.setProperty("padding","0.5rem"),k.style.setProperty("background","#f8f9fa"),k.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("font-weight","bold"),C.style.setProperty("color","#3b82f6"),l(C,()=>K.totalItems),E.style.setProperty("font-size","0.75rem"),E.style.setProperty("color","#6c757d"),l(E,()=>e("inventory.items","Items")),M.style.setProperty("text-align","center"),M.style.setProperty("padding","0.5rem"),M.style.setProperty("background","#f8f9fa"),M.style.setProperty("border-radius","var(--border-radius-sm)"),_.style.setProperty("font-weight","bold"),_.style.setProperty("color","#22c55e"),l(_,()=>K.totalQuantity),S.style.setProperty("font-size","0.75rem"),S.style.setProperty("color","#6c757d"),l(S,()=>e("inventory.quantity","Quantity")),b.style.setProperty("text-align","center"),b.style.setProperty("padding","0.5rem"),b.style.setProperty("background","#f8f9fa"),b.style.setProperty("border-radius","var(--border-radius-sm)"),Y.style.setProperty("font-weight","bold"),Y.style.setProperty("color","#f59e0b"),l(Y,()=>c(K.totalValue)),te.style.setProperty("font-size","0.75rem"),te.style.setProperty("color","#6c757d"),l(te,()=>e("common.value","Value")),Z})(),(()=>{var Z=aE(),k=Z.firstChild,C=k.nextSibling;return Z.style.setProperty("display","flex"),Z.style.setProperty("gap","0.5rem"),k.$$click=E=>{E.stopPropagation(),n(K)},k.style.setProperty("flex","1"),k.style.setProperty("padding","0.5rem"),k.style.setProperty("background","var(--primary-color)"),k.style.setProperty("color","white"),k.style.setProperty("border","none"),k.style.setProperty("border-radius","var(--border-radius-sm)"),k.style.setProperty("cursor","pointer"),k.style.setProperty("font-size","0.875rem"),l(k,()=>e("common.viewDetails","View Details")),C.$$click=E=>{E.stopPropagation(),y(K)},C.style.setProperty("padding","0.5rem"),C.style.setProperty("background","#22c55e"),C.style.setProperty("color","white"),C.style.setProperty("border","none"),C.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("cursor","pointer"),C.style.setProperty("font-size","0.875rem"),Z})()]}})})),l(v,B(Ge,{get when(){return r()},get children(){return B(Tt,{get children(){return[(()=>{var K=Zk(),Z=K.firstChild,k=Z.nextSibling;return k.firstChild,K.style.setProperty("display","flex"),K.style.setProperty("justify-content","space-between"),K.style.setProperty("align-items","center"),K.style.setProperty("margin-bottom","1rem"),l(Z,()=>e("inventory.movementDetails","Movement Details")),k.$$click=()=>y(),k.style.setProperty("padding","0.5rem 1rem"),k.style.setProperty("background","#22c55e"),k.style.setProperty("color","white"),k.style.setProperty("border","none"),k.style.setProperty("border-radius","var(--border-radius-sm)"),k.style.setProperty("cursor","pointer"),l(k,()=>e("common.print","Print Report"),null),K})(),(()=>{var K=eE(),Z=K.firstChild,k=Z.firstChild,C=k.firstChild,E=C.firstChild;C.nextSibling;var M=k.nextSibling,_=M.firstChild,S=_.firstChild;_.nextSibling;var b=M.nextSibling,Y=b.firstChild,te=Y.firstChild;Y.nextSibling;var O=b.nextSibling,D=O.firstChild,X=D.firstChild;D.nextSibling;var H=Z.nextSibling,F=H.firstChild,ie=F.firstChild,$=ie.firstChild;ie.nextSibling;var L=F.nextSibling,U=L.firstChild,N=U.firstChild;U.nextSibling;var z=L.nextSibling,oe=z.firstChild,G=oe.firstChild;oe.nextSibling;var ee=z.nextSibling,J=ee.firstChild,W=J.firstChild;return J.nextSibling,K.style.setProperty("display","grid"),K.style.setProperty("grid-template-columns","repeat(2, 1fr)"),K.style.setProperty("gap","1rem"),K.style.setProperty("margin-bottom","2rem"),K.style.setProperty("padding","1rem"),K.style.setProperty("background","#f8f9fa"),K.style.setProperty("border-radius","var(--border-radius-sm)"),l(C,()=>e("inventory.referenceNumber","Reference"),E),l(k,()=>r()?.referenceNumber||"N/A",null),l(_,()=>e("inventory.invoiceId","Invoice ID"),S),l(M,()=>r()?.invoiceId||"N/A",null),l(Y,()=>e("inventory.movementType","Type"),te),l(b,()=>r()?.movementType.toUpperCase(),null),l(D,()=>e("inventory.location","Location"),X),l(O,()=>r()?.locationName,null),l(ie,()=>e("common.date","Date"),$),l(F,(()=>{var q=Te(()=>!!r());return()=>q()?a(r().createDate):""})(),null),l(U,()=>e("inventory.totalItems","Total Items"),N),l(L,()=>r()?.totalItems,null),l(oe,()=>e("inventory.totalQuantity","Total Quantity"),G),l(z,()=>r()?.totalQuantity,null),l(J,()=>e("common.estimatedValue","Estimated Value"),W),l(ee,(()=>{var q=Te(()=>!!r());return()=>q()?c(r().totalValue):""})(),null),K})(),B(Ge,{get when(){return r()?.description||r()?.generalNotes},get children(){var K=tE();return K.style.setProperty("margin-bottom","2rem"),K.style.setProperty("padding","1rem"),K.style.setProperty("background","#e8f4fd"),K.style.setProperty("border-radius","var(--border-radius-sm)"),l(K,B(Ge,{get when(){return r()?.description},get children(){var Z=ep(),k=Z.firstChild,C=k.firstChild;return k.nextSibling,l(k,()=>e("common.description","Description"),C),l(Z,()=>r()?.description,null),Z}}),null),l(K,B(Ge,{get when(){return r()?.generalNotes},get children(){var Z=ep(),k=Z.firstChild,C=k.firstChild;return k.nextSibling,l(k,()=>e("common.notes","Notes"),C),l(Z,()=>r()?.generalNotes,null),Z}}),null),K}}),(()=>{var K=rE(),Z=K.firstChild,k=Z.firstChild,C=k.firstChild,E=C.firstChild,M=E.nextSibling,_=M.nextSibling,S=_.nextSibling,b=S.nextSibling,Y=b.nextSibling,te=k.nextSibling;return K.style.setProperty("overflow-x","auto"),Z.style.setProperty("width","100%"),Z.style.setProperty("border-collapse","collapse"),C.style.setProperty("border-bottom","2px solid #dee2e6"),E.style.setProperty("padding","0.75rem"),E.style.setProperty("text-align","left"),l(E,()=>e("inventory.productCode","Code")),M.style.setProperty("padding","0.75rem"),M.style.setProperty("text-align","left"),l(M,()=>e("inventory.productName","Product")),_.style.setProperty("padding","0.75rem"),_.style.setProperty("text-align","center"),l(_,()=>e("inventory.quantity","Quantity")),S.style.setProperty("padding","0.75rem"),S.style.setProperty("text-align","right"),l(S,()=>e("inventory.unitCost","Unit Cost")),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","right"),l(b,()=>e("common.totalValue","Total Value")),Y.style.setProperty("padding","0.75rem"),Y.style.setProperty("text-align","left"),l(Y,()=>e("common.notes","Notes")),l(te,B(Ht,{get each(){return r()?.movements||[]},children:O=>{const D=lt.getProductById(O.productId),X=D?.unitCost||0,H=Math.abs(O.quantity||0)*X;return(()=>{var F=lE(),ie=F.firstChild,$=ie.nextSibling,L=$.nextSibling,U=L.nextSibling,N=U.nextSibling,z=N.nextSibling;return F.style.setProperty("border-bottom","1px solid #dee2e6"),ie.style.setProperty("padding","0.75rem"),ie.style.setProperty("font-family","monospace"),l(ie,()=>D?.code||O.productId),$.style.setProperty("padding","0.75rem"),l($,()=>D?.name||"Unknown Product"),L.style.setProperty("padding","0.75rem"),L.style.setProperty("text-align","center"),L.style.setProperty("font-weight","bold"),l(L,()=>O.quantity||0),U.style.setProperty("padding","0.75rem"),U.style.setProperty("text-align","right"),l(U,()=>c(X)),N.style.setProperty("padding","0.75rem"),N.style.setProperty("text-align","right"),N.style.setProperty("font-weight","bold"),l(N,()=>c(H)),z.style.setProperty("padding","0.75rem"),z.style.setProperty("font-size","0.875rem"),z.style.setProperty("color","#6c757d"),l(z,()=>O.notes||"-"),Se(oe=>(oe=(O.quantity||0)>=0?"#22c55e":"#ef4444")!=null?L.style.setProperty("color",oe):L.style.removeProperty("color")),F})()}})),K})()]}})}}),null),Se(()=>w.value=i()),v})()};ur(["click"]);var cE=ue("<div><div><div><h2>Bulk Movement Report - </h2><button></button></div><div>");const uE=t=>{const[e,r]=$e(!0),[n,i]=$e(!1),[o,s]=$e([]),[a,c]=$e(""),u=v=>{const p=lt.movements.filter(I=>I.referenceNumber===v||I.invoiceId===v||I.ssg_inventory_key===v);s(p),c(v),r(!1),i(!0)},f=()=>{r(!1),t.onClose()},y=()=>{i(!1),t.onClose()};return[B(Ge,{get when(){return e()},get children(){return B(Qk,{get isOpen(){return Te(()=>!!t.isOpen)()&&e()},onClose:f,onMovementComplete:u})}}),B(Ge,{get when(){return n()},get children(){var v=cE(),p=v.firstChild,I=p.firstChild,P=I.firstChild;P.firstChild;var w=P.nextSibling,x=I.nextSibling;return v.style.setProperty("position","fixed"),v.style.setProperty("top","0"),v.style.setProperty("left","0"),v.style.setProperty("right","0"),v.style.setProperty("bottom","0"),v.style.setProperty("background","rgba(0, 0, 0, 0.5)"),v.style.setProperty("z-index","1000"),v.style.setProperty("display","flex"),v.style.setProperty("align-items","center"),v.style.setProperty("justify-content","center"),v.style.setProperty("padding","2rem"),p.style.setProperty("background","white"),p.style.setProperty("border-radius","var(--border-radius)"),p.style.setProperty("width","95%"),p.style.setProperty("max-width","1200px"),p.style.setProperty("max-height","90vh"),p.style.setProperty("overflow-y","auto"),p.style.setProperty("position","relative"),I.style.setProperty("padding","1rem 2rem"),I.style.setProperty("border-bottom","1px solid #e9ecef"),I.style.setProperty("display","flex"),I.style.setProperty("justify-content","space-between"),I.style.setProperty("align-items","center"),I.style.setProperty("background","#f8f9fa"),P.style.setProperty("margin","0"),l(P,a,null),w.$$click=y,w.style.setProperty("background","none"),w.style.setProperty("border","none"),w.style.setProperty("font-size","1.5rem"),w.style.setProperty("cursor","pointer"),w.style.setProperty("padding","0.5rem"),w.style.setProperty("line-height","1"),x.style.setProperty("padding","1rem"),l(x,B(w5,{get movements(){return o()},onClose:y})),v}})]};ur(["click"]);var dE=ue("<div><div></div><div></div><div></div><div>"),hE=ue("<div><strong>:</strong> "),fE=ue("<div><div><span></span><span></span></div><div><span></span><span> </span></div><div><span></span><span> </span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),pE=ue("<div>");const mE=t=>{const{t:e}=tr(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={"text-align":"center","margin-bottom":"2rem"},s={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},a={color:"var(--text-muted)","font-size":"1rem"},c={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"1rem"},u=(P,w)=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:P>w?"#d4edda":"#f8d7da",color:P>w?"#155724":"#721c24"}),f={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},y={"margin-bottom":"1.5rem",padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",color:"var(--text-secondary)"};if(!t.item)return null;const v=P=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(P),p=P=>new Date(P).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),I=t.item.price*t.item.quantity;return B(Qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.itemDetails")},get children(){return[(()=>{var P=dE(),w=P.firstChild,x=w.nextSibling,j=x.nextSibling,ne=j.nextSibling;return m(P,o),m(w,s),l(w,()=>t.item.name),m(x,a),l(x,()=>t.item.category),m(j,c),l(j,()=>v(t.item.price)),l(ne,(()=>{var Q=Te(()=>t.item.quantity>t.item.minStock);return()=>Q()?e("inventory.inStock"):e("inventory.lowStockAlert")})()),Se(Q=>m(ne,u(t.item.quantity,t.item.minStock),Q)),P})(),(()=>{var P=hE(),w=P.firstChild,x=w.firstChild;return w.nextSibling,m(P,y),l(w,()=>e("common.description"),x),l(P,()=>t.item.description,null),P})(),(()=>{var P=fE(),w=P.firstChild,x=w.firstChild,j=x.nextSibling,ne=w.nextSibling,Q=ne.firstChild,K=Q.nextSibling,Z=K.firstChild,k=ne.nextSibling,C=k.firstChild,E=C.nextSibling,M=E.firstChild,_=k.nextSibling,S=_.firstChild,b=S.nextSibling,Y=_.nextSibling,te=Y.firstChild,O=te.nextSibling,D=Y.nextSibling,X=D.firstChild,H=X.nextSibling,F=D.nextSibling,ie=F.firstChild,$=ie.nextSibling;return l(x,()=>e("inventory.sku")),l(j,()=>t.item.sku),l(Q,()=>e("inventory.quantity")),l(K,()=>t.item.quantity,Z),l(K,()=>e("common.units"),null),l(C,()=>e("inventory.minimumStock")),l(E,()=>t.item.minStock,M),l(E,()=>e("common.units"),null),l(S,()=>e("inventory.totalValue")),l(b,()=>v(I)),l(te,()=>e("inventory.supplier")),l(O,()=>t.item.supplier),l(X,()=>e("inventory.location")),l(H,()=>t.item.location),l(ie,()=>e("common.lastUpdated")),l($,()=>p(t.item.lastUpdated)),Se(L=>{var U=r,N=n,z=i,oe=r,G=n,ee=i,J=r,W=n,q=i,ae=r,de=n,le=i,V=r,ce=n,Pe=i,fe=r,be=n,xe=i,he=r,ve=n,De=i;return L.e=m(w,U,L.e),L.t=m(x,N,L.t),L.a=m(j,z,L.a),L.o=m(ne,oe,L.o),L.i=m(Q,G,L.i),L.n=m(K,ee,L.n),L.s=m(k,J,L.s),L.h=m(C,W,L.h),L.r=m(E,q,L.r),L.d=m(_,ae,L.d),L.l=m(S,de,L.l),L.u=m(b,le,L.u),L.c=m(Y,V,L.c),L.w=m(te,ce,L.w),L.m=m(O,Pe,L.m),L.f=m(D,fe,L.f),L.y=m(X,be,L.y),L.g=m(H,xe,L.g),L.p=m(F,he,L.p),L.b=m(ie,ve,L.b),L.T=m($,De,L.T),L},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),P})(),(()=>{var P=pE();return m(P,f),l(P,B(Pt,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),l(P,B(Pt,{variant:"primary",onClick:()=>{console.log("Edit item:",t.item.id)},get children(){return e("common.editItem")}}),null),P})()]}})};var yE=ue("<div>"),gE=ue("<button type=button>"),vE=ue("<div> "),d0=ue("<div>"),bE=ue("<div><div><input type=text autocomplete=off>"),_E=ue("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>"),wE=ue("<span> ");const SE=t=>{const{t:e}=tr(),[r,n]=$e(""),[i,o]=$e(!1),[s,a]=$e(null),[c,u]=$e([]),[f,y]=$e(!1),[v,p]=$e(-1),[I,P]=$e(null),w=t.searchDelay||300;t.maxResults;const x=async U=>{if(!U.trim()||U.trim().length<3){u([]),t.onSearchResults?.([]);return}try{o(!0),a(null);try{console.log("apiResults",U),t.onSearchResults?.(U)}catch(N){console.warn("API search failed, using local fallback:",N),a("API search failed, showing local results")}}catch(N){const z=N instanceof Error?N.message:"Search failed";a(z),u([]),t.onSearchResults?.([])}finally{o(!1)}},j=U=>{const z=U.target.value;n(z),a(null),console.log(),t.showResults,I()&&clearTimeout(I());const oe=setTimeout(()=>{x(z)},w);P(oe)},ne=U=>{n(U.name),y(!1),p(-1),t.onInventorySelect?.(U)},Q=U=>{if(!(!f()||c().length===0))switch(U.key){case"ArrowDown":U.preventDefault(),p(N=>Math.min(N+1,c().length-1));break;case"ArrowUp":U.preventDefault(),p(N=>Math.max(N-1,-1));break;case"Enter":U.preventDefault(),v()>=0&&c()[v()]&&ne(c()[v()]);break;case"Escape":y(!1),p(-1);break}},K=()=>{t.showResults!==!1&&c().length>0&&y(!0)},Z=()=>{setTimeout(()=>{y(!1),p(-1)},150)},k=()=>{n(""),u([]),a(null),y(!1),p(-1),t.onSearchResults?.([]),I()&&(clearTimeout(I()),P(null))},C=U=>lt.stockLevels.filter(N=>N.inventoryId===U).reduce((N,z)=>N+z.quantity,0),E=U=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(U),M={position:"relative",width:"100%",...t.style},_={position:"relative",display:"flex","align-items":"center"},S={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},b={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},Y={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},te={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},O=U=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:U?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),D={display:"flex","justify-content":"space-between","align-items":"center"},X={flex:"1"},H={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},F={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},ie={"text-align":"right","font-size":"0.875rem"},$={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},L={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var U=bE(),N=U.firstChild,z=N.firstChild;return z.addEventListener("blur",Z),z.addEventListener("focus",K),z.$$keydown=Q,z.$$input=j,l(N,B(Ge,{get when(){return i()},get children(){var oe=yE();return Se(G=>m(oe,Y,G)),oe}}),null),l(N,B(Ge,{get when(){return Te(()=>!!r())()&&!i()},get children(){var oe=gE();return oe.addEventListener("mouseleave",G=>{G.currentTarget.style.background="none",G.currentTarget.style.color="var(--text-muted)"}),oe.addEventListener("mouseenter",G=>{G.currentTarget.style.background="var(--border-color)",G.currentTarget.style.color="var(--text-primary)"}),oe.$$click=k,Se(G=>{var ee=b,J=e("common.clear","Clear search");return G.e=m(oe,ee,G.e),J!==G.t&&Yt(oe,"title",G.t=J),G},{e:void 0,t:void 0}),oe}}),null),l(U,B(Ge,{get when(){return f()&&t.showResults!==!1},get children(){var oe=d0();return l(oe,B(Ge,{get when(){return s()},get children(){var G=vE();return G.firstChild,m(G,L),l(G,s,null),G}}),null),l(oe,B(Ge,{get when(){return c().length>0},get fallback(){return Te(()=>!!(r()&&!i()))()&&(()=>{var G=d0();return m(G,$),l(G,()=>e("inventory.noInventorysFound","No inventorys found matching your search.")),G})()},get children(){return B(Ht,{get each(){return c()},children:(G,ee)=>{const J=C(G.id),W=J<=G.minStockLevel;return(()=>{var q=_E(),ae=q.firstChild,de=ae.firstChild,le=de.firstChild,V=le.nextSibling,ce=V.firstChild,Pe=ce.firstChild,fe=ce.nextSibling,be=fe.nextSibling,xe=be.nextSibling,he=xe.nextSibling,ve=de.nextSibling,De=ve.firstChild,Ee=De.firstChild,Ce=De.nextSibling;return q.addEventListener("mouseenter",()=>p(ee())),q.$$click=()=>ne(G),m(ae,D),m(de,X),m(le,H),l(le,()=>G.name),m(V,F),l(ce,()=>e("inventory.sku","SKU"),Pe),l(ce,()=>G.sku,null),l(be,()=>G.category),l(he,()=>E(G.unitCost)),m(ve,ie),De.style.setProperty("font-weight","600"),(W?"#f44336":"var(--text-primary)")!=null?De.style.setProperty("color",W?"#f44336":"var(--text-primary)"):De.style.removeProperty("color"),l(De,J,Ee),l(De,()=>G.unitOfMeasure,null),Ce.style.setProperty("color","var(--text-muted)"),l(Ce,()=>W?(()=>{var Ne=wE();return Ne.firstChild,Ne.style.setProperty("color","#f44336"),l(Ne,()=>e("inventory.lowStock","Low Stock"),null),Ne})():e("inventory.inStock","In Stock")),Se(Ne=>m(q,O(ee()===v()),Ne)),q})()}})}}),null),Se(G=>m(oe,te,G)),oe}}),null),Se(oe=>{var G=M,ee=_,J=S,W=t.placeholder||e("inventory.searchInventorys","Search inventorys by name, SKU, or category..."),q=t.disabled;return oe.e=m(U,G,oe.e),oe.t=m(N,ee,oe.t),oe.a=m(z,J,oe.a),W!==oe.o&&Yt(z,"placeholder",oe.o=W),q!==oe.i&&(z.disabled=oe.i=q),oe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>z.value=r()),U})()};ur(["input","keydown","click"]);var PE=ue("<div>"),tp=ue("<div><span>:</span><span>"),xE=ue("<div><button> "),AE=ue("<div><div><div><h3></h3><div>: </div></div><div><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span> <!>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span>");const CE=t=>{const{t:e}=tr(),r=p=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(p),n=p=>new Date(p).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),i=p=>({in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}})[p]||{bg:"#f5f5f5",color:"#666"},o=p=>({in:"",out:"",transfer:"",adjustment:""})[p]||"",s=()=>t.movement,a={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},c={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},u={"font-weight":"600",color:"var(--text-primary)","text-align":"right"},f={"margin-bottom":"1.5rem"},y={"font-weight":"600","margin-bottom":"0.75rem","padding-bottom":"0.5rem","border-bottom":"2px solid var(--border-color)"},v=p=>({display:"inline-flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"600","text-transform":"uppercase","letter-spacing":"0.5px",background:i(p).bg,color:i(p).color});return B(Qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.movementDetails")},size:"lg",get children(){return B(Ge,{get when(){return s()},get fallback(){return(()=>{var p=PE();return l(p,()=>e("common.noDataFound")),p})()},children:p=>(()=>{var I=AE(),P=I.firstChild,w=P.firstChild,x=w.firstChild,j=x.nextSibling,ne=j.firstChild,Q=w.nextSibling,K=Q.firstChild,Z=P.nextSibling,k=Z.firstChild,C=k.nextSibling,E=C.firstChild,M=E.firstChild,_=E.nextSibling,S=C.nextSibling,b=S.firstChild,Y=b.firstChild,te=b.nextSibling,O=te.firstChild,D=S.nextSibling,X=D.firstChild,H=X.firstChild,F=X.nextSibling,ie=D.nextSibling,$=ie.firstChild,L=$.firstChild,U=L.nextSibling;U.nextSibling;var N=$.nextSibling,z=Z.nextSibling,oe=z.firstChild,G=oe.nextSibling,ee=G.firstChild,J=ee.firstChild,W=ee.nextSibling,q=z.nextSibling,ae=q.firstChild,de=ae.nextSibling,le=de.firstChild,V=le.firstChild,ce=le.nextSibling,Pe=de.nextSibling,fe=Pe.firstChild,be=fe.firstChild,xe=fe.nextSibling;return P.style.setProperty("display","flex"),P.style.setProperty("justify-content","space-between"),P.style.setProperty("align-items","center"),P.style.setProperty("margin-bottom","1.5rem"),P.style.setProperty("padding-bottom","1rem"),P.style.setProperty("border-bottom","2px solid var(--border-color)"),x.style.setProperty("margin","0 0 0.5rem 0"),x.style.setProperty("font-size","1.25rem"),l(x,()=>p().productName),j.style.setProperty("font-size","0.875rem"),j.style.setProperty("color","var(--text-muted)"),l(j,()=>e("inventory.sku"),ne),l(j,()=>p().productSku,null),Q.$$click=()=>lt.generateMovementInvoice(p().id,e),K.style.setProperty("font-size","1.2rem"),l(K,()=>o(p().movementType)),l(Q,()=>p().movementType,null),l(k,()=>e("inventory.movementInformation")),l(E,()=>e("inventory.referenceNumber"),M),l(_,()=>p().referenceNumber),l(b,()=>e("common.quantity"),Y),l(te,()=>p().quantity,O),l(te,()=>e("common.units"),null),l(X,()=>e("inventory.unitCost"),H),l(F,()=>r(p().unitCost)),l($,()=>e("common.total"),L),l($,()=>e("common.value"),U),l(N,()=>r(p().totalCost)),l(oe,()=>e("inventory.locationInformation")),l(ee,()=>e("inventory.location"),J),l(W,()=>p().locationName),l(z,B(Ge,{get when(){return p().fromLocationName},get children(){var he=tp(),ve=he.firstChild,De=ve.firstChild,Ee=ve.nextSibling;return l(ve,()=>e("common.from"),De),l(Ee,()=>p().fromLocationName),Se(Ce=>{var Ne=a,Ie=c,Re=u;return Ce.e=m(he,Ne,Ce.e),Ce.t=m(ve,Ie,Ce.t),Ce.a=m(Ee,Re,Ce.a),Ce},{e:void 0,t:void 0,a:void 0}),he}}),null),l(z,B(Ge,{get when(){return p().invoiceId},get children(){var he=tp(),ve=he.firstChild,De=ve.firstChild,Ee=ve.nextSibling;return l(ve,()=>e("common.invoice"),De),l(Ee,()=>p().invoiceId),Se(Ce=>{var Ne=a,Ie=c,Re={...u,color:"var(--primary-color)"};return Ce.e=m(he,Ne,Ce.e),Ce.t=m(ve,Ie,Ce.t),Ce.a=m(Ee,Re,Ce.a),Ce},{e:void 0,t:void 0,a:void 0}),he}}),null),l(ae,()=>e("common.details")),l(le,()=>e("common.createdBy"),V),l(ce,()=>p().createdBy),l(fe,()=>e("common.created"),be),l(xe,()=>n(p().createdDate)),l(q,B(Ge,{get when(){return p().notes},get children(){var he=tp(),ve=he.firstChild,De=ve.firstChild,Ee=ve.nextSibling;return l(ve,()=>e("common.notes"),De),l(Ee,()=>p().notes),Se(Ce=>{var Ne={...a,"border-bottom":"none"},Ie=c,Re={...u,"font-style":"italic","max-width":"60%","white-space":"pre-wrap"};return Ce.e=m(he,Ne,Ce.e),Ce.t=m(ve,Ie,Ce.t),Ce.a=m(Ee,Re,Ce.a),Ce},{e:void 0,t:void 0,a:void 0}),he}}),null),l(I,B(Ge,{get when(){return t.onEdit},get children(){var he=xE(),ve=he.firstChild,De=ve.firstChild;return he.style.setProperty("display","flex"),he.style.setProperty("justify-content","flex-end"),he.style.setProperty("margin-top","1.5rem"),he.style.setProperty("padding-top","1rem"),he.style.setProperty("border-top","1px solid var(--border-color)"),ve.addEventListener("mouseleave",Ee=>{Ee.currentTarget.style.transform="translateY(0)",Ee.currentTarget.style.boxShadow="none"}),ve.addEventListener("mouseenter",Ee=>{Ee.currentTarget.style.transform="translateY(-1px)",Ee.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)"}),ve.$$click=()=>t.onEdit?.(p()),ve.style.setProperty("padding","0.5rem 1.5rem"),ve.style.setProperty("border-radius","var(--border-radius-sm)"),ve.style.setProperty("border","1px solid var(--primary-color)"),ve.style.setProperty("background","var(--primary-color)"),ve.style.setProperty("color","white"),ve.style.setProperty("cursor","pointer"),ve.style.setProperty("font-weight","500"),ve.style.setProperty("transition","all 0.2s ease"),l(ve,()=>e("common.edit"),De),l(ve,()=>e("inventory.movement"),null),he}}),null),Se(he=>{var ve=v(p().movementType),De=f,Ee=y,Ce=a,Ne=c,Ie=u,Re=a,We=c,Fe={...u,"font-size":"1.1rem",color:"var(--primary-color)"},Xe=a,tt=c,At=u,rt=a,He=c,xt={...u,"font-size":"1.1rem",color:"var(--primary-color)"},_t=f,mt=y,Et=a,et=c,qe=u,ot=f,Je=y,at=a,dt=c,It=u,jt=a,Gt=c,yt=u;return he.e=m(Q,ve,he.e),he.t=m(Z,De,he.t),he.a=m(k,Ee,he.a),he.o=m(C,Ce,he.o),he.i=m(E,Ne,he.i),he.n=m(_,Ie,he.n),he.s=m(S,Re,he.s),he.h=m(b,We,he.h),he.r=m(te,Fe,he.r),he.d=m(D,Xe,he.d),he.l=m(X,tt,he.l),he.u=m(F,At,he.u),he.c=m(ie,rt,he.c),he.w=m($,He,he.w),he.m=m(N,xt,he.m),he.f=m(z,_t,he.f),he.y=m(oe,mt,he.y),he.g=m(G,Et,he.g),he.p=m(ee,et,he.p),he.b=m(W,qe,he.b),he.T=m(q,ot,he.T),he.A=m(ae,Je,he.A),he.O=m(de,at,he.O),he.I=m(le,dt,he.I),he.S=m(ce,It,he.S),he.W=m(Pe,jt,he.W),he.C=m(fe,Gt,he.C),he.B=m(xe,yt,he.B),he},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),I})()})}})};ur(["click"]);var il=ue("<div>"),IE=ue("<div><label></label><select><option value>"),$E=ue("<div><div><span>:</span><span>$"),kE=ue("<form><div><label></label><select><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><input type=number min=0.01 step=0.01></div><div><label></label><input type=number min=0 step=0.01></div><div><label></label><input type=text></div><div><label> (<!>)</label><input type=text></div><div><label> (<!>)</label><textarea></textarea></div><div><button type=button></button><button type=submit>"),h0=ue("<option> (<!>)");const EE=t=>{const{t:e}=tr(),[r,n]=$e("in"),[i,o]=$e(""),[s,a]=$e(""),[c,u]=$e(""),[f,y]=$e(""),[v,p]=$e(""),[I,P]=$e(""),[w,x]=$e(""),[j,ne]=$e(!1),[Q,K]=$e({});vo(()=>{const Y=t.movement;Y&&t.isOpen&&(n(Y.movementType),o(Y.quantity.toString()),a(Y.unitCost.toString()),u(Y.referenceNumber),y(Y.notes),P(Y.locationId),p(Y.fromLocationId||""),x(Y.invoiceId||""),K({}))});const Z=()=>{const Y={};return(!i()||parseFloat(i())<=0)&&(Y.quantity=e("forms.requiredField")),(!s()||parseFloat(s())<0)&&(Y.unitCost=e("forms.requiredField")),c().trim()||(Y.referenceNumber=e("forms.requiredField")),I()||(Y.locationId=e("forms.requiredField")),r()==="transfer"&&!v()&&(Y.fromLocationId=e("forms.requiredField")),K(Y),Object.keys(Y).length===0},k=async Y=>{if(Y.preventDefault(),!(!Z()||!t.movement)){ne(!0);try{const te=t.movement,O=lt.getProductById(te.productId),D=lt.getLocationById(I()),X=v()?lt.getLocationById(v()):null;if(!O||!D)throw new Error("Product or location not found");const H={...te,movementType:r(),quantity:parseFloat(i()),unitCost:parseFloat(s()),totalCost:parseFloat(i())*parseFloat(s()),referenceNumber:c().trim(),notes:f().trim(),locationId:I(),locationName:D.name,fromLocationId:v()||void 0,fromLocationName:X?.name,invoiceId:w().trim()||void 0,lastModified:new Date().toISOString()};lt.updateMovement(te.id,H),t.onMovementUpdated?.(),t.onClose(),C()}catch(te){console.error("Error updating movement:",te),K({submit:e("forms.saveError")})}finally{ne(!1)}}},C=()=>{n("in"),o(""),a(""),u(""),y(""),p(""),P(""),x(""),K({})},E=()=>{C(),t.onClose()},M={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",transition:"border-color 0.2s ease"},_={display:"block","margin-bottom":"0.25rem","font-weight":"500","font-size":"0.875rem"},S={color:"#d32f2f","font-size":"0.75rem","margin-top":"0.25rem"},b={"margin-bottom":"1rem"};return B(Qn,{get isOpen(){return t.isOpen},onClose:E,get title(){return e("inventory.editMovement","Edit Movement")},get children(){return B(Ge,{get when(){return t.movement},get fallback(){return(()=>{var Y=il();return l(Y,()=>e("common.loading")),Y})()},get children(){var Y=kE(),te=Y.firstChild,O=te.firstChild,D=O.nextSibling,X=D.firstChild,H=X.nextSibling,F=H.nextSibling,ie=F.nextSibling,$=te.nextSibling,L=$.firstChild,U=L.nextSibling,N=U.firstChild,z=$.nextSibling,oe=z.firstChild,G=oe.nextSibling,ee=z.nextSibling,J=ee.firstChild,W=J.nextSibling,q=ee.nextSibling,ae=q.firstChild,de=ae.nextSibling,le=q.nextSibling,V=le.firstChild,ce=V.firstChild,Pe=ce.nextSibling;Pe.nextSibling;var fe=V.nextSibling,be=le.nextSibling,xe=be.firstChild,he=xe.firstChild,ve=he.nextSibling;ve.nextSibling;var De=xe.nextSibling,Ee=be.nextSibling,Ce=Ee.firstChild,Ne=Ce.nextSibling;return Y.addEventListener("submit",k),l(O,()=>e("inventory.movementType")),D.addEventListener("change",Ie=>n(Ie.target.value)),l(X,()=>e("inventory.stockIn")),l(H,()=>e("inventory.stockOut")),l(F,()=>e("inventory.transfer")),l(ie,()=>e("inventory.adjustment")),l(L,(()=>{var Ie=Te(()=>r()==="transfer");return()=>Ie()?e("inventory.toLocation"):e("inventory.location")})()),U.addEventListener("change",Ie=>P(Ie.target.value)),l(N,()=>e("modals.selectLocation")),l(U,B(Ht,{get each(){return lt.getActiveLocations()},children:Ie=>(()=>{var Re=h0(),We=Re.firstChild,Fe=We.nextSibling;return Fe.nextSibling,l(Re,()=>Ie.name,We),l(Re,()=>Ie.type,Fe),Se(()=>Re.value=Ie.id),Re})()}),null),l($,B(Ge,{get when(){return Q().locationId},get children(){var Ie=il();return l(Ie,()=>Q().locationId),Se(Re=>m(Ie,S,Re)),Ie}}),null),l(Y,B(Ge,{get when(){return r()==="transfer"},get children(){var Ie=IE(),Re=Ie.firstChild,We=Re.nextSibling,Fe=We.firstChild;return l(Re,()=>e("inventory.fromLocation")),We.addEventListener("change",Xe=>p(Xe.target.value)),l(Fe,()=>e("modals.selectLocation")),l(We,B(Ht,{get each(){return lt.getActiveLocations().filter(Xe=>Xe.id!==I())},children:Xe=>(()=>{var tt=h0(),At=tt.firstChild,rt=At.nextSibling;return rt.nextSibling,l(tt,()=>Xe.name,At),l(tt,()=>Xe.type,rt),Se(()=>tt.value=Xe.id),tt})()}),null),l(Ie,B(Ge,{get when(){return Q().fromLocationId},get children(){var Xe=il();return l(Xe,()=>Q().fromLocationId),Se(tt=>m(Xe,S,tt)),Xe}}),null),Se(Xe=>{var tt=b,At=_,rt={...M,"border-color":Q().fromLocationId?"#d32f2f":"var(--border-color)"},He=j();return Xe.e=m(Ie,tt,Xe.e),Xe.t=m(Re,At,Xe.t),Xe.a=m(We,rt,Xe.a),He!==Xe.o&&(We.disabled=Xe.o=He),Xe},{e:void 0,t:void 0,a:void 0,o:void 0}),Se(()=>We.value=v()),Ie}}),z),l(oe,()=>e("common.quantity")),G.$$input=Ie=>o(Ie.target.value),l(z,B(Ge,{get when(){return Q().quantity},get children(){var Ie=il();return l(Ie,()=>Q().quantity),Se(Re=>m(Ie,S,Re)),Ie}}),null),l(J,()=>e("inventory.unitCost")),W.$$input=Ie=>a(Ie.target.value),l(ee,B(Ge,{get when(){return Q().unitCost},get children(){var Ie=il();return l(Ie,()=>Q().unitCost),Se(Re=>m(Ie,S,Re)),Ie}}),null),l(Y,B(Ge,{get when(){return Te(()=>!!i())()&&s()},get children(){var Ie=$E(),Re=Ie.firstChild,We=Re.firstChild,Fe=We.firstChild,Xe=We.nextSibling;return Xe.firstChild,Re.style.setProperty("display","flex"),Re.style.setProperty("justify-content","space-between"),We.style.setProperty("font-weight","500"),l(We,()=>e("common.total"),Fe),Xe.style.setProperty("font-weight","600"),Xe.style.setProperty("color","var(--primary-color)"),l(Xe,()=>(parseFloat(i()||"0")*parseFloat(s()||"0")).toFixed(2),null),Se(tt=>m(Ie,{...b,padding:"0.75rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)"},tt)),Ie}}),q),l(ae,()=>e("inventory.referenceNumber")),de.$$input=Ie=>u(Ie.target.value),l(q,B(Ge,{get when(){return Q().referenceNumber},get children(){var Ie=il();return l(Ie,()=>Q().referenceNumber),Se(Re=>m(Ie,S,Re)),Ie}}),null),l(V,()=>e("inventory.invoiceNumber"),ce),l(V,()=>e("common.optional"),Pe),fe.$$input=Ie=>x(Ie.target.value),l(xe,()=>e("common.notes"),he),l(xe,()=>e("common.optional"),ve),De.$$input=Ie=>y(Ie.target.value),l(Y,B(Ge,{get when(){return Q().submit},get children(){var Ie=il();return l(Ie,()=>Q().submit),Se(Re=>m(Ie,{...S,"margin-bottom":"1rem"},Re)),Ie}}),Ee),Ee.style.setProperty("display","flex"),Ee.style.setProperty("gap","1rem"),Ee.style.setProperty("justify-content","flex-end"),Ce.$$click=E,Ce.style.setProperty("padding","0.5rem 1rem"),Ce.style.setProperty("border","1px solid var(--border-color)"),Ce.style.setProperty("border-radius","var(--border-radius-sm)"),Ce.style.setProperty("background","white"),Ce.style.setProperty("cursor","pointer"),l(Ce,()=>e("common.cancel")),Ne.style.setProperty("padding","0.5rem 1rem"),Ne.style.setProperty("border","none"),Ne.style.setProperty("border-radius","var(--border-radius-sm)"),Ne.style.setProperty("background","var(--primary-color)"),Ne.style.setProperty("color","white"),Ne.style.setProperty("cursor","pointer"),Ne.style.setProperty("font-weight","500"),l(Ne,(()=>{var Ie=Te(()=>!!j());return()=>Ie()?e("modals.processing"):e("inventory.updateMovement","Update Movement")})()),Se(Ie=>{var Re=b,We=_,Fe=M,Xe=j(),tt=b,At=_,rt={...M,"border-color":Q().locationId?"#d32f2f":"var(--border-color)"},He=j(),xt=b,_t=_,mt={...M,"border-color":Q().quantity?"#d32f2f":"var(--border-color)"},Et=e("modals.enterQuantity"),et=j(),qe=b,ot=_,Je={...M,"border-color":Q().unitCost?"#d32f2f":"var(--border-color)"},at=e("modals.enterCost"),dt=j(),It=b,jt=_,Gt={...M,"border-color":Q().referenceNumber?"#d32f2f":"var(--border-color)"},yt=e("modals.enterReference"),Qt=j(),Mt=b,Kt=_,Xt=M,ht=e("inventory.invoiceNumber"),wt=j(),Ut=b,Ze=_,Vt={...M,resize:"vertical","min-height":"80px"},Ft=e("modals.addNotes"),Jt=j(),er=j(),gt=j();return Ie.e=m(te,Re,Ie.e),Ie.t=m(O,We,Ie.t),Ie.a=m(D,Fe,Ie.a),Xe!==Ie.o&&(D.disabled=Ie.o=Xe),Ie.i=m($,tt,Ie.i),Ie.n=m(L,At,Ie.n),Ie.s=m(U,rt,Ie.s),He!==Ie.h&&(U.disabled=Ie.h=He),Ie.r=m(z,xt,Ie.r),Ie.d=m(oe,_t,Ie.d),Ie.l=m(G,mt,Ie.l),Et!==Ie.u&&Yt(G,"placeholder",Ie.u=Et),et!==Ie.c&&(G.disabled=Ie.c=et),Ie.w=m(ee,qe,Ie.w),Ie.m=m(J,ot,Ie.m),Ie.f=m(W,Je,Ie.f),at!==Ie.y&&Yt(W,"placeholder",Ie.y=at),dt!==Ie.g&&(W.disabled=Ie.g=dt),Ie.p=m(q,It,Ie.p),Ie.b=m(ae,jt,Ie.b),Ie.T=m(de,Gt,Ie.T),yt!==Ie.A&&Yt(de,"placeholder",Ie.A=yt),Qt!==Ie.O&&(de.disabled=Ie.O=Qt),Ie.I=m(le,Mt,Ie.I),Ie.S=m(V,Kt,Ie.S),Ie.W=m(fe,Xt,Ie.W),ht!==Ie.C&&Yt(fe,"placeholder",Ie.C=ht),wt!==Ie.B&&(fe.disabled=Ie.B=wt),Ie.v=m(be,Ut,Ie.v),Ie.k=m(xe,Ze,Ie.k),Ie.x=m(De,Vt,Ie.x),Ft!==Ie.j&&Yt(De,"placeholder",Ie.j=Ft),Jt!==Ie.q&&(De.disabled=Ie.q=Jt),er!==Ie.z&&(Ce.disabled=Ie.z=er),gt!==Ie.P&&(Ne.disabled=Ie.P=gt),Ie},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0,z:void 0,P:void 0}),Se(()=>D.value=r()),Se(()=>U.value=I()),Se(()=>G.value=i()),Se(()=>W.value=s()),Se(()=>de.value=c()),Se(()=>fe.value=w()),Se(()=>De.value=f()),Y}})}})};ur(["input","click"]);var TE=ue("<div><div></div><div><div><label></label><select><option value=all></option><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),NE=ue("<div><h2>"),LE=ue("<div><label>"),DE=ue("<div><label></label><select><option value>"),RE=ue("<option>"),ME=ue("<div><div></div><div></div><div>"),FE=ue("<div><div><div><div><span></span><h3></h3><span></span></div><div>  </div></div><div><div></div><div> <!> @ </div></div></div><div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div><span>:</span><span>"),OE=ue("<span>"),BE=ue("<span> <!>: "),f0=ue("<div><span>:</span><span>"),jE=ue("<div><div><span>:</span><select><option value=10>10</option><option value=25>25</option><option value=50>50</option><option value=100>100</option></select><span></span></div><div><div><span>:</span><input type=number min=1><span> "),VE=ue("<span>..."),zE=ue("<button>");const qE=t=>{const{t:e}=tr(),[r,n]=$e(""),[i,o]=$e(""),[s,a]=$e("all"),[c,u]=$e({start:"",end:""}),[f,y]=$e(""),[v,p]=$e(""),[I,P]=$e(1),[w,x]=$e(25),[j,ne]=$e(null),[Q,K]=$e(!1),[Z,k]=$e(!1),C=Nt(()=>{let fe=lt.movements;if(t.filterBy==="product"&&t.filterId?fe=fe.filter(be=>be.productId===t.filterId):t.filterBy==="location"&&t.filterId&&(fe=fe.filter(be=>be.locationId===t.filterId)),r()&&(fe=fe.filter(be=>be.productId===r())),i()&&(fe=fe.filter(be=>be.locationId===i())),s()!=="all"&&(fe=fe.filter(be=>be.movementType===s())),c().start&&(fe=fe.filter(be=>be.createdDate>=c().start)),c().end&&(fe=fe.filter(be=>be.createdDate<=c().end+"T23:59:59Z")),f()){const be=f().toLowerCase();fe=fe.filter(xe=>xe.productName.toLowerCase().includes(be)||xe.productSku.toLowerCase().includes(be)||xe.locationName.toLowerCase().includes(be)||xe.referenceNumber.toLowerCase().includes(be)||xe.notes.toLowerCase().includes(be)||xe.createdBy.toLowerCase().includes(be)||xe.invoiceId&&xe.invoiceId.toLowerCase().includes(be)||xe.fromLocationName&&xe.fromLocationName.toLowerCase().includes(be)||xe.movementType.toLowerCase().includes(be))}return fe.sort((be,xe)=>new Date(xe.createdDate).getTime()-new Date(be.createdDate).getTime())});vo(()=>{r(),i(),s(),c(),f(),P(1)});const E=Nt(()=>{const fe=(I()-1)*w(),be=fe+w();return C().slice(fe,be)}),M=Nt(()=>Math.ceil(C().length/w())),_=Nt(()=>{const fe=C();return{total:fe.length,stockIn:fe.filter(be=>be.movementType==="in").length,stockOut:fe.filter(be=>be.movementType==="out").length,transfers:fe.filter(be=>be.movementType==="transfer").length,adjustments:fe.filter(be=>be.movementType==="adjustment").length,totalValue:fe.reduce((be,xe)=>be+xe.totalCost,0)}}),S={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},b={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},Y={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)",cursor:"pointer"},te={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},O={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem","margin-bottom":"2rem"},D={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","text-align":"center"},X={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},H={"font-size":"0.875rem",color:"var(--text-muted)","font-weight":"500"},F={padding:"1.5rem","margin-bottom":"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",transition:"all 0.2s ease"},ie={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"1rem"};function $(fe){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[fe]||{bg:"#f5f5f5",color:"#666"}}const L=fe=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:$(fe).bg,color:$(fe).color}),U={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"1rem"},N={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.5rem 0","border-bottom":"1px solid var(--border-color)"},z={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},oe={"font-weight":"600",color:"var(--text-primary)"},G={display:"flex","justify-content":"space-between","align-items":"center","margin-top":"2rem",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},ee=fe=>({padding:"0.25rem 0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:fe?"var(--primary-color)":"var(--surface-color)",color:fe?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),J=fe=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(fe),W=fe=>new Date(fe).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),q=fe=>({in:"",out:"",transfer:"",adjustment:""})[fe]||"",ae=()=>{n(""),o(""),a("all"),u({start:"",end:""}),y(""),P(1)},de=fe=>{ne(fe),K(!0)},le=fe=>{ne(fe),K(!1),k(!0)},V=()=>{k(!1),ne(null)},ce=async fe=>{i()&&(fe+=" "+i()),Mp(s())&&(fe+=" "+Mp(s()));const be=await Ai.getInventory(fe),xe=lt.parseInventoryData(be);lt.updMovements(xe)},Pe=()=>{};return(()=>{var fe=TE(),be=fe.firstChild,xe=be.nextSibling,he=xe.firstChild,ve=he.firstChild,De=ve.nextSibling,Ee=De.firstChild,Ce=Ee.nextSibling,Ne=Ce.nextSibling,Ie=Ne.nextSibling,Re=Ie.nextSibling,We=he.nextSibling,Fe=We.firstChild,Xe=Fe.nextSibling,tt=We.nextSibling,At=tt.firstChild,rt=At.nextSibling,He=xe.nextSibling,xt=He.firstChild,_t=xt.firstChild,mt=_t.nextSibling,Et=xt.nextSibling,et=Et.firstChild,qe=et.nextSibling,ot=Et.nextSibling,Je=ot.firstChild,at=Je.nextSibling,dt=ot.nextSibling,It=dt.firstChild,jt=It.nextSibling,Gt=dt.nextSibling,yt=Gt.firstChild,Qt=yt.nextSibling,Mt=Gt.nextSibling,Kt=Mt.firstChild,Xt=Kt.nextSibling;return l(fe,(()=>{var ht=Te(()=>!t.filterBy);return()=>ht()&&(()=>{var wt=NE(),Ut=wt.firstChild;return m(wt,S),Ut.style.setProperty("margin","0"),Ut.style.setProperty("font-size","1.5rem"),l(Ut,()=>e("inventory.movements")),l(wt,B(Pt,{variant:"outline",onClick:ae,get children(){return e("common.clearFilters")}}),null),wt})()})(),be),l(fe,B(SE,{filters:{selectedLocation:i,movementType:s},onSearchResults:ht=>{p(ht),ce(ht)},get placeholder(){return e("inventory.searchProductsStock","Search inventories...")},showResults:!1,maxResults:20}),be),be.style.setProperty("margin","20px"),m(xe,b),l(xe,(()=>{var ht=Te(()=>!t.filterBy);return()=>ht()&&[(()=>{var wt=LE(),Ut=wt.firstChild;return Ut.style.setProperty("display","block"),Ut.style.setProperty("margin-bottom","0.5rem"),Ut.style.setProperty("font-weight","500"),l(Ut,()=>e("inventory.product")),l(wt,B(cf,{onChange:Ze=>{console.log(Ze),n(Ze.id)},get placeholder(){return e("inventory.searchProductsImages","Search products to view images...")}}),null),wt})(),(()=>{var wt=DE(),Ut=wt.firstChild,Ze=Ut.nextSibling,Vt=Ze.firstChild;return Ut.style.setProperty("display","block"),Ut.style.setProperty("margin-bottom","0.5rem"),Ut.style.setProperty("font-weight","500"),l(Ut,()=>e("inventory.location")),Ze.addEventListener("change",Ft=>o(Ft.target.value)),l(Vt,()=>e("inventory.allLocations")),l(Ze,B(Ht,{get each(){return lt.locations},children:Ft=>(()=>{var Jt=RE();return l(Jt,()=>Ft.name),Se(()=>Jt.value=Ft.id),Jt})()}),null),Se(Ft=>m(Ze,Y,Ft)),Se(()=>Ze.value=i()),wt})()]})(),he),ve.style.setProperty("display","block"),ve.style.setProperty("margin-bottom","0.5rem"),ve.style.setProperty("font-weight","500"),l(ve,()=>e("inventory.movementType")),De.addEventListener("change",ht=>{a(ht.target.value),ce(v())}),l(Ee,()=>e("inventory.allTypes")),l(Ce,()=>e("inventory.stockIn")),l(Ne,()=>e("inventory.stockOut")),l(Ie,()=>e("inventory.transfer")),l(Re,()=>e("inventory.adjustment")),Fe.style.setProperty("display","block"),Fe.style.setProperty("margin-bottom","0.5rem"),Fe.style.setProperty("font-weight","500"),l(Fe,()=>e("common.startDate")),Xe.addEventListener("change",ht=>u(wt=>({...wt,start:ht.target.value}))),At.style.setProperty("display","block"),At.style.setProperty("margin-bottom","0.5rem"),At.style.setProperty("font-weight","500"),l(At,()=>e("common.endDate")),rt.addEventListener("change",ht=>u(wt=>({...wt,end:ht.target.value}))),m(He,O),l(_t,()=>_().total),l(mt,()=>e("inventory.totalMovements")),l(et,()=>_().stockIn),l(qe,()=>e("inventory.stockIn")),l(Je,()=>_().stockOut),l(at,()=>e("inventory.stockOut")),l(It,()=>_().transfers),l(jt,()=>e("inventory.transfers")),l(yt,()=>_().adjustments),l(Qt,()=>e("inventory.adjustments")),Kt.$$click=Pe,l(Kt,()=>J(_().totalValue)),l(Xt,()=>e("inventory.totalValue")),l(fe,(()=>{var ht=Te(()=>E().length===0);return()=>ht()?(()=>{var wt=ME(),Ut=wt.firstChild,Ze=Ut.nextSibling,Vt=Ze.nextSibling;return wt.style.setProperty("text-align","center"),wt.style.setProperty("padding","3rem"),wt.style.setProperty("color","var(--text-muted)"),wt.style.setProperty("background","var(--surface-color)"),wt.style.setProperty("border-radius","var(--border-radius)"),wt.style.setProperty("border","1px solid var(--border-color)"),Ut.style.setProperty("font-size","1.5rem"),Ut.style.setProperty("margin-bottom","1rem"),Ze.style.setProperty("font-size","1.1rem"),Ze.style.setProperty("margin-bottom","0.5rem"),l(Ze,()=>e("inventory.noMovementsFound")),Vt.style.setProperty("font-size","0.875rem"),l(Vt,()=>e("inventory.tryAdjustingFilters")),wt})():[B(Ht,{get each(){return E()},children:wt=>(()=>{var Ut=FE(),Ze=Ut.firstChild,Vt=Ze.firstChild,Ft=Vt.firstChild,Jt=Ft.firstChild,er=Jt.nextSibling,gt=er.nextSibling,dr=Ft.nextSibling,Er=dr.firstChild,mr=Vt.nextSibling,xr=mr.firstChild,Vr=xr.nextSibling,kt=Vr.firstChild,Cr=kt.nextSibling;Cr.nextSibling;var $r=Ze.nextSibling,hr=$r.firstChild,yr=hr.firstChild,Ir=yr.firstChild,Hr=Ir.firstChild,rr=Ir.nextSibling,on=yr.nextSibling,vn=on.firstChild,Ln=vn.firstChild,bn=vn.nextSibling,gn=hr.nextSibling,Br=gn.firstChild,Vn=Br.firstChild,Xn=Vn.firstChild,Ni=Vn.nextSibling;return Ut.addEventListener("mouseleave",nr=>{nr.currentTarget.style.transform="translateY(0)",nr.currentTarget.style.boxShadow="none"}),Ut.addEventListener("mouseenter",nr=>{nr.currentTarget.style.transform="translateY(-2px)",nr.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),Ut.$$click=()=>de(wt),m(Ze,ie),Ft.style.setProperty("display","flex"),Ft.style.setProperty("align-items","center"),Ft.style.setProperty("gap","0.5rem"),Ft.style.setProperty("margin-bottom","0.5rem"),Jt.style.setProperty("font-size","1.2rem"),l(Jt,()=>q(wt.movementType)),er.style.setProperty("margin","0"),er.style.setProperty("font-size","1.1rem"),l(er,()=>wt.productName),l(gt,()=>wt.movementType),l(Ft,(()=>{var nr=Te(()=>!!wt.invoiceId);return()=>nr()&&(()=>{var Tr=OE();return Tr.style.setProperty("padding","0.2rem 0.5rem"),Tr.style.setProperty("border-radius","var(--border-radius-sm)"),Tr.style.setProperty("font-size","0.7rem"),Tr.style.setProperty("font-weight","500"),Tr.style.setProperty("background","var(--primary-color)"),Tr.style.setProperty("color","white"),l(Tr,()=>e("inventory.bulk")),Tr})()})(),null),dr.style.setProperty("font-size","0.875rem"),dr.style.setProperty("color","var(--text-muted)"),l(dr,()=>wt.productSku,Er),l(dr,()=>W(wt.createdDate),null),l(dr,(()=>{var nr=Te(()=>!!wt.invoiceId);return()=>nr()&&(()=>{var Tr=BE(),Gr=Tr.firstChild,bt=Gr.nextSibling;return bt.nextSibling,Tr.style.setProperty("margin-left","0.5rem"),Tr.style.setProperty("font-weight","500"),l(Tr,()=>e("common.invoice"),bt),l(Tr,()=>wt.invoiceId,null),Tr})()})(),null),mr.style.setProperty("text-align","right"),xr.style.setProperty("font-size","1.25rem"),xr.style.setProperty("font-weight","700"),xr.style.setProperty("color","var(--primary-color)"),l(xr,()=>J(wt.totalCost)),Vr.style.setProperty("font-size","0.875rem"),Vr.style.setProperty("color","var(--text-muted)"),l(Vr,()=>wt.quantity,kt),l(Vr,()=>e("common.units"),Cr),l(Vr,()=>J(wt.unitCost),null),m($r,U),l(Ir,()=>e("inventory.location"),Hr),l(rr,()=>wt.locationName),l(hr,(()=>{var nr=Te(()=>!!wt.fromLocationName);return()=>nr()&&(()=>{var Tr=f0(),Gr=Tr.firstChild,bt=Gr.firstChild,ar=Gr.nextSibling;return l(Gr,()=>e("common.from"),bt),l(ar,()=>wt.fromLocationName),Se(pr=>{var Wr=N,Fr=z,dn=oe;return pr.e=m(Tr,Wr,pr.e),pr.t=m(Gr,Fr,pr.t),pr.a=m(ar,dn,pr.a),pr},{e:void 0,t:void 0,a:void 0}),Tr})()})(),on),l(vn,()=>e("common.reference"),Ln),l(bn,()=>wt.referenceNumber),l(Vn,()=>e("common.createdBy"),Xn),l(Ni,()=>wt.createdBy),l(gn,(()=>{var nr=Te(()=>!!wt.notes);return()=>nr()&&(()=>{var Tr=f0(),Gr=Tr.firstChild,bt=Gr.firstChild,ar=Gr.nextSibling;return l(Gr,()=>e("common.notes"),bt),l(ar,()=>wt.notes),Se(pr=>{var Wr={...N,"border-bottom":"none"},Fr=z,dn={...oe,"max-width":"200px","text-align":"right","font-style":"italic"};return pr.e=m(Tr,Wr,pr.e),pr.t=m(Gr,Fr,pr.t),pr.a=m(ar,dn,pr.a),pr},{e:void 0,t:void 0,a:void 0}),Tr})()})(),null),Se(nr=>{var Tr={...F,"border-left":wt.invoiceId?"4px solid var(--primary-color)":"1px solid var(--border-color)",cursor:"pointer"},Gr=L(wt.movementType),bt=N,ar=z,pr=oe,Wr=N,Fr=z,dn=oe,Sr=N,Gn=z,wn=oe;return nr.e=m(Ut,Tr,nr.e),nr.t=m(gt,Gr,nr.t),nr.a=m(yr,bt,nr.a),nr.o=m(Ir,ar,nr.o),nr.i=m(rr,pr,nr.i),nr.n=m(on,Wr,nr.n),nr.s=m(vn,Fr,nr.s),nr.h=m(bn,dn,nr.h),nr.r=m(Br,Sr,nr.r),nr.d=m(Vn,Gn,nr.d),nr.l=m(Ni,wn,nr.l),nr},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),Ut})()}),Te(()=>Te(()=>M()>1)()&&(()=>{var wt=jE(),Ut=wt.firstChild,Ze=Ut.firstChild,Vt=Ze.firstChild,Ft=Ze.nextSibling,Jt=Ft.nextSibling,er=Ut.nextSibling,gt=er.firstChild,dr=gt.firstChild,Er=dr.firstChild,mr=dr.nextSibling,xr=mr.nextSibling,Vr=xr.firstChild;return m(wt,G),Ut.style.setProperty("display","flex"),Ut.style.setProperty("align-items","center"),Ut.style.setProperty("gap","0.5rem"),Ze.style.setProperty("font-size","0.875rem"),Ze.style.setProperty("color","var(--text-muted)"),l(Ze,()=>e("common.showPerPage","Show per page"),Vt),Ft.addEventListener("change",kt=>{x(Number(kt.target.value)),P(1)}),Ft.style.setProperty("padding","0.25rem 0.5rem"),Ft.style.setProperty("border","1px solid var(--border-color)"),Ft.style.setProperty("border-radius","var(--border-radius-sm)"),Ft.style.setProperty("background","var(--surface-color)"),Ft.style.setProperty("cursor","pointer"),Ft.style.setProperty("font-size","0.875rem"),Jt.style.setProperty("font-size","0.875rem"),Jt.style.setProperty("color","var(--text-muted)"),Jt.style.setProperty("margin-left","1rem"),l(Jt,()=>e("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:(I()-1)*w()+1,end:Math.min(I()*w(),C().length),total:C().length})),er.style.setProperty("display","flex"),er.style.setProperty("align-items","center"),er.style.setProperty("gap","0.5rem"),l(er,B(Pt,{variant:"outline",size:"sm",onClick:()=>P(1),get disabled(){return I()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.first","First")}}),gt),l(er,B(Pt,{variant:"outline",size:"sm",onClick:()=>P(kt=>Math.max(1,kt-1)),get disabled(){return I()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.previous")}}),gt),l(er,()=>{const kt=[],Cr=M(),$r=I();if(Cr<=7)for(let hr=1;hr<=Cr;hr++)kt.push(hr);else{kt.push(1),$r>3&&kt.push("...");for(let hr=Math.max(2,$r-1);hr<=Math.min(Cr-1,$r+1);hr++)kt.includes(hr)||kt.push(hr);$r<Cr-2&&kt.push("..."),kt.includes(Cr)||kt.push(Cr)}return B(Ht,{each:kt,children:hr=>hr==="..."?(()=>{var yr=VE();return yr.style.setProperty("padding","0 0.5rem"),yr.style.setProperty("color","var(--text-muted)"),yr})():(()=>{var yr=zE();return yr.$$click=()=>P(hr),l(yr,hr),Se(Ir=>m(yr,ee(hr===I()),Ir)),yr})()})},gt),l(er,B(Pt,{variant:"outline",size:"sm",onClick:()=>P(kt=>Math.min(M(),kt+1)),get disabled(){return I()===M()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.next")}}),gt),l(er,B(Pt,{variant:"outline",size:"sm",onClick:()=>P(M()),get disabled(){return I()===M()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.last","Last")}}),gt),gt.style.setProperty("display","flex"),gt.style.setProperty("align-items","center"),gt.style.setProperty("gap","0.5rem"),gt.style.setProperty("margin-left","1rem"),dr.style.setProperty("font-size","0.875rem"),dr.style.setProperty("color","var(--text-muted)"),l(dr,()=>e("common.page","Page"),Er),mr.addEventListener("change",kt=>{const Cr=Number(kt.target.value);Cr>=1&&Cr<=M()&&P(Cr)}),mr.style.setProperty("width","4rem"),mr.style.setProperty("padding","0.25rem 0.5rem"),mr.style.setProperty("border","1px solid var(--border-color)"),mr.style.setProperty("border-radius","var(--border-radius-sm)"),mr.style.setProperty("background","var(--surface-color)"),mr.style.setProperty("text-align","center"),mr.style.setProperty("font-size","0.875rem"),xr.style.setProperty("font-size","0.875rem"),xr.style.setProperty("color","var(--text-muted)"),l(xr,()=>e("common.of","of"),Vr),l(xr,M,null),Se(()=>Yt(mr,"max",M())),Se(()=>Ft.value=w()),Se(()=>mr.value=I()),wt})())]})(),null),l(fe,B(CE,{get isOpen(){return Q()},onClose:()=>{K(!1),ne(null)},get movement(){return j()},onEdit:le}),null),l(fe,B(Ge,{get when(){return Ar.hasPermission("read_write")},get children(){return B(EE,{get isOpen(){return Z()},onClose:()=>{k(!1),ne(null)},get movement(){return j()},onMovementUpdated:V})}}),null),Se(ht=>{var wt=Y,Ut=te,Ze=te,Vt=D,Ft=X,Jt=H,er=D,gt={...X,color:"#2d7d32"},dr=H,Er=D,mr={...X,color:"#d32f2f"},xr=H,Vr=D,kt={...X,color:"#1976d2"},Cr=H,$r=D,hr={...X,color:"#f57c00"},yr=H,Ir=D,Hr=X,rr=H;return ht.e=m(De,wt,ht.e),ht.t=m(Xe,Ut,ht.t),ht.a=m(rt,Ze,ht.a),ht.o=m(xt,Vt,ht.o),ht.i=m(_t,Ft,ht.i),ht.n=m(mt,Jt,ht.n),ht.s=m(Et,er,ht.s),ht.h=m(et,gt,ht.h),ht.r=m(qe,dr,ht.r),ht.d=m(ot,Er,ht.d),ht.l=m(Je,mr,ht.l),ht.u=m(at,xr,ht.u),ht.c=m(dt,Vr,ht.c),ht.w=m(It,kt,ht.w),ht.m=m(jt,Cr,ht.m),ht.f=m(Gt,$r,ht.f),ht.y=m(yt,hr,ht.y),ht.g=m(Qt,yr,ht.g),ht.p=m(Mt,Ir,ht.p),ht.b=m(Kt,Hr,ht.b),ht.T=m(Xt,rr,ht.T),ht},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),Se(()=>De.value=s()),Se(()=>Xe.value=c().start),Se(()=>rt.value=c().end),fe})()};ur(["click"]);var UE=ue("<div><p> "),HE=ue("<div>"),WE=ue("<div><div></div><h3></h3><p></p><div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=name></option><option value=sku></option><option value=category>"),GE=ue("<div><div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div>%</div><div></div></div></div><div></div><div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),YE=ue("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),KE=ue("<div><div></div><h3></h3><p>"),JE=ue("<div><div><h3> </h3><p></p></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div></div><div>"),QE=ue("<div><div><div><h2> </h2><button>"),p0=ue("<option>"),XE=ue("<div>..."),ZE=ue("<tr><td><div></div><div>  </div></td><td><div></div></td><td><div></div></td><td><div></div></td><td><div>"),eT=ue("<tr><td><div></div></td><td><div></div><div>  <!>  </div></td><td><div></div></td><td><input type=number placeholder=0 min=0 step=0.01></td><td><div></div></td><td><input type=text>");const tT=t=>{const{t:e}=tr(),[r,n]=$e([]),[i,o]=$e(!1),[s,a]=$e(!1),[c,u]=$e("all"),[f,y]=$e("all"),[v,p]=$e("name"),[I,P]=$e([]),[w,x]=$e("setup"),j=async()=>{try{o(!0);const H=await Ai.getProducts("prod");if(!H||typeof H!="object"){console.warn("No API results, using local store"),n(lt.products);return}const F=Object.keys(H),ie=L=>{let N=H[L];return{id:L,name:N.name||"Unknown Product",businessId:N.businessId||"",sku:N.code||N.sku||"",UPC:N.UPC||"",numCode:N.codeN||"",category:N.category||"General",unitCost:N.unitCost||0,unitOfMeasure:N.unitOfMeasure||"pcs",minStockLevel:N.minStockLevel||0,maxStockLevel:N.maxStockLevel||100,isActive:N.isActive!==!1,description:N.description||"",createdDate:N.createdAt||new Date().toISOString(),lastModified:N.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(N.sellingPrice||N.price||"0")}},$=F.map(ie);n($)}catch(H){console.error("Failed to load products from API:",H),n(lt.products)}finally{o(!1)}},ne=Nt(()=>[...new Set(r().map(F=>F.category).filter(F=>F))].sort()),Q=Nt(()=>{let H=r().filter(F=>F.isActive);return f()!=="all"&&(H=H.filter(F=>F.category===f())),H.sort((F,ie)=>{switch(v()){case"name":return F.name.localeCompare(ie.name);case"sku":return F.sku.localeCompare(ie.sku);case"category":return F.category.localeCompare(ie.category)||F.name.localeCompare(ie.name);default:return 0}}),H}),K=Nt(()=>lt.getActiveLocations()),Z=(H,F)=>F&&F!=="all"?lt.getStockByProductAndLocation(H,F)?.quantity||0:lt.getTotalStockByProduct(H),k=()=>{const H=Q().map(F=>{const ie=Z(F.id,c()!=="all"?c():void 0);return{productId:F.id,systemQuantity:ie,physicalCount:null,notes:"",variance:0,product:F}});P(H),x("counting")},C=(H,F)=>{P(ie=>ie.map($=>{if($.productId===H){const L=F,U=L!==null?L-$.systemQuantity:0;return{...$,physicalCount:L,variance:U}}return $}))},E=(H,F)=>{P(ie=>ie.map($=>$.productId===H?{...$,notes:F}:$))},M=Nt(()=>{const H=I(),F=H.length,ie=H.filter(N=>N.physicalCount!==null).length,$=H.filter(N=>N.variance!==0).length,L=H.filter(N=>N.variance>0).length,U=H.filter(N=>N.variance<0).length;return{totalProducts:F,countedProducts:ie,remainingProducts:F-ie,variances:$,positiveVariances:L,negativeVariances:U,isComplete:ie===F}}),_=()=>{const H=I().filter(L=>L.physicalCount!==null&&L.variance!==0);if(H.length===0)return null;const F=[e("inventory.product","Product"),e("inventory.sku","SKU"),e("inventory.category","Category"),e("inventory.location","Location"),e("inventory.systemQty","System Qty"),e("inventory.physicalCount","Physical Count"),e("inventory.variance","Variance"),e("inventory.adjustment","Adjustment"),e("common.notes","Notes"),e("common.date","Date")],ie=H.map(L=>[`"${L.product.name}"`,`"${L.product.sku}"`,`"${L.product.category}"`,`"${Y()}"`,L.systemQuantity,L.physicalCount,L.variance,L.variance>0?e("inventory.stockIncrease","Stock Increase"):e("inventory.stockDecrease","Stock Decrease"),`"${L.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")}"`,`"${te()}"`]);return[F.join(","),...ie.map(L=>L.join(","))].join(`
`)},S=()=>{const H=_();if(!H){alert(e("inventory.noAdjustmentsToDownload","No adjustments to download"));return}const F=new Blob([H],{type:"text/csv;charset=utf-8;"}),ie=document.createElement("a");if(ie.download!==void 0){const $=URL.createObjectURL(F);ie.setAttribute("href",$),ie.setAttribute("download",`inventory-adjustments-${te().replace(/[/:,\s]/g,"-")}.csv`),ie.style.visibility="hidden",document.body.appendChild(ie),ie.click(),document.body.removeChild(ie)}},b=async(H=!0)=>{try{a(!0),console.log(I());const F=z=>{let oe=lt.getProductById(z.productId),G=lt.getStockByProductAndLocation(z.productId,c()),ee=parseFloat(G?.averageCost+""),J=parseFloat(G?.quantity+"");return{product:{id:z.productId,label:oe?.name,code:oe?.code},productId:z?.productId,reason:"Physical Count Adjustment",notes:z?.notes||"Physical inventory adjustment",quantity:z?.variance,unitCost:ee}},ie=I().filter(z=>z.physicalCount!==null&&z.variance!==0).map(F);let $="ADJ_"+_g();const L=new Date().toISOString(),U={ssg_inventory_key:Dm(),invoiceId:$,referenceNumber:_g(),movementType:"adjustment",type:"adjustment",locationId:c(),items:ie,products:ie,generalNotes:"Physical inventory adjustment",description:"Physical Count Adjustment",invoice:$,store:c(),createdBy:"admin",createDate:L};console.log("Saving inventory bulkRequest:",U);const N=await Ai.addInventory(U);H&&ie.length>0&&S(),console.log("Saving inventory adjustments:",ie),await new Promise(z=>setTimeout(z,1e3)),t.onClose()}catch(F){console.error("Failed to save inventory adjustments:",F)}finally{a(!1)}},Y=Nt(()=>c()==="all"?"All Locations":K().find(F=>F.id===c())?.name||"Unknown Location"),te=()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),O=async()=>{await lt.fecthInventory("prod"),await j()};Nn(async()=>{t.selectedLocationId&&u(t.selectedLocationId),O()});const D=()=>{const H=window.open("","_blank");if(!H){alert("Please allow pop-ups to print the counting sheet");return}const F=X();H.document.write(F),H.document.close(),H.onload=()=>{H.print(),H.onafterprint=()=>{H.close()}}},X=()=>{const H=Q().map((F,ie)=>{const $=Z(F.id,c()!=="all"?c():void 0);return`
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${ie+1}</td>
          <td style="border: 1px solid #000; padding: 8px; font-family: monospace;">${F.sku}</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 500;">${F.name}</div>
            ${F.UPC?`<div style="font-size: 0.8em; color: #666;">UPC: ${F.UPC}</div>`:""}
          </td>
         
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${F.unitOfMeasure}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">${$}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; background-color: #f9f9f9;"></td>
          <td style="border: 1px solid #000; padding: 8px;"></td>
        </tr>
      `}).join("");return`
      <!DOCTYPE html>
      <html>
      <head>
        <title> ${Y()}_${f()}_${e("inventory.countingSheet","Inventory Counting Sheet")} - ${te()}</title>
        <style>
          @page {
            size: letter;
            margin: 0.5in 0.8in 0.5in 0.8in;
            @top-center {
              content: "${Y()} | ${f()==="all"?e("inventory.allCategories","All Categories"):f()} | Page " counter(page);
              font-size: 10px;
              font-weight: bold;
              border-bottom: 1px solid #ccc;
              padding-bottom: 5px;
            }
          }
          body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            margin: 0;
            padding: 0;
            position: relative;
          }
          .page-identifier {
            position: fixed;
            left: 5px;
            top: 50%;
            transform: rotate(-90deg) translateX(-50%);
            transform-origin: left center;
            background: #f0f0f0;
            padding: 5px 15px;
            border: 1px solid #ccc;
            font-weight: bold;
            font-size: 10px;
            color: #333;
            z-index: 100;
          }
          .page-identifier-right {
            position: fixed;
            right: 5px;
            top: 50%;
            transform: rotate(90deg) translateX(50%);
            transform-origin: right center;
            background: #f0f0f0;
            padding: 5px 15px;
            border: 1px solid #ccc;
            font-weight: bold;
            font-size: 10px;
            color: #333;
            z-index: 100;
          }
          h1 {
            text-align: center;
            margin: 0 0 10px 0;
            font-size: 22px;
            page-break-after: avoid;
          }
          .header-info {
            text-align: center;
            margin-bottom: 20px;
            background: #f8f8f8;
            padding: 10px;
            border: 2px solid #333;
            page-break-after: avoid;
          }
          .page-header {
            display: none;
            text-align: center;
            background: #e0e0e0;
            padding: 8px;
            border: 1px solid #333;
            margin-bottom: 10px;
            font-weight: bold;
            font-size: 11px;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
          }
          th {
            background-color: #333;
            color: white;
            padding: 8px;
            text-align: left;
            font-weight: bold;
            border: 1px solid #000;
          }
          .summary-table {
            width: 50%;
            margin: 20px auto;
            /*page-break-before: auto;*/
          }
          .signature-section {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
            page-break-before: auto;
          }
          .signature-box {
            width: 45%;
            text-align: center;
          }
          .signature-line {
            border-bottom: 1px solid #000;
            margin-bottom: 5px;
            height: 30px;
          }
          @media print {
            body { margin: 0; }
            .page-identifier, .page-identifier-right { display: block; }
            .page-header { display: block; }
            tr { page-break-inside: avoid; }
            thead { display: table-header-group; }
            tfoot { display: table-footer-group; }
            .header-info { page-break-after: avoid; }
            h1 { page-break-after: avoid; }
            table { page-break-before: auto; }
            /*.summary-table { page-break-before: always; }*/
            .signature-section { page-break-before: avoid; }
            
            /* Repeat headers on each page */
            @page :first {
              @top-center { content: none; }
            }
            
            /* Force page headers to show on continuation pages */
            tbody::before {
              content: "";
              display: block;
              height: 0;
            }
          }
        </style>
      </head>
      <body>
        <!-- Page identifiers for multi-page documents -->
        <div class="page-identifier-right">
          ${Y()} - ${f()==="all"?e("inventory.allCategories","All Categories"):f()} - ${te()} 
        </div>
       
        
        <h1>${e("inventory.inventoryCountingSheetTitle","INVENTORY COUNTING SHEET")}</h1>
        <div class="header-info">
          <p><strong>${e("inventory.location","Location")}:</strong> ${Y()}</p>
          <p><strong>${e("common.category","Category")}:</strong> ${f()==="all"?e("inventory.allCategories","All Categories"):f()}</p>
          <p><strong>${e("common.date","Date")}:</strong> ${te()}</p>
          <p style="margin-top: 10px;">
            <span style="margin-right: 30px;">${e("inventory.countedBy","Counted by")}: _________________________</span>
            <span>${e("inventory.verifiedBy","Verified by")}: _________________________</span>
          </p>
        </div>

        <!-- Page header for continuation pages (hidden on first page) -->
        <div class="page-header">
          ${Y()} | ${f()==="all"?e("inventory.allCategories","All Categories"):f()} | ${te()} 
        </div>

        <table>
          <thead>
            <tr>
              <th style="width: 5%; text-align: center;">#</th>
              <th style="width: 12%;">${e("inventory.sku","SKU")}</th>
              <th style="width: 25%;">${e("inventory.productName","Product Name")}</th>
              <th style="width: 8%; text-align: center;">${e("inventory.unit","Unit")}</th>
              <th style="width: 10%; text-align: center;">${e("inventory.systemQty","System Qty")}</th>
              <th style="width: 12%; text-align: center; background-color: #f0f0f0;">${e("inventory.physicalCount","Physical Count")}</th>
              <th style="width: 28%;">${e("common.notes","Notes")}</th>
            </tr>
            <!-- Repeat header info row for clarity -->
            <tr style="background-color: #f8f8f8; font-size: 10px;">
              <td colspan="8" style="text-align: center; padding: 4px; border: 1px solid #000; font-weight: bold;">
                 ${Y()} |  ${f()==="all"?e("inventory.allCategories","All Categories"):f()} |  ${te()}
              </td>
            </tr>
          </thead>
          <tbody>
            ${H}
          </tbody>
        </table>
        
        <!-- Summary section with location/category context -->
        <div style="margin: 30px 0; padding: 15px; background: #f8f8f8;">
          <h3 style="text-align: center; margin: 0 0 15px 0; font-size: 16px;">
            ${e("inventory.summaryFor","SUMMARY FOR")}: ${Y()} - ${f()==="all"?e("inventory.allCategories","All Categories"):f()}
          </h3>
          
          <table class="summary-table">
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.totalProductsListed","Total Products Listed")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">
                ${Q().length}
              </td>
            </tr>
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.itemsCounted","Items Counted")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center;">
                ___________
              </td>
            </tr>
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.discrepanciesFound","Discrepancies Found")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center;">
                ___________
              </td>
            </tr>
          </table>
        </div>
        
        <div class="signature-section">
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.counterSignature","Counter Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.supervisorSignature","Supervisor Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
        </div>
      </body>
      </html>
    `};return B(Ge,{get when(){return t.isOpen},get children(){var H=QE(),F=H.firstChild,ie=F.firstChild,$=ie.firstChild;$.firstChild;var L=$.nextSibling;return H.style.setProperty("position","fixed"),H.style.setProperty("top","0"),H.style.setProperty("left","0"),H.style.setProperty("right","0"),H.style.setProperty("bottom","0"),H.style.setProperty("background","rgba(0, 0, 0, 0.5)"),H.style.setProperty("z-index","1000"),H.style.setProperty("display","flex"),H.style.setProperty("align-items","center"),H.style.setProperty("justify-content","center"),F.style.setProperty("background","white"),F.style.setProperty("border-radius","var(--border-radius)"),F.style.setProperty("padding","2rem"),F.style.setProperty("width","95%"),F.style.setProperty("height","95%"),F.style.setProperty("max-width","1400px"),F.style.setProperty("overflow-y","auto"),F.style.setProperty("position","relative"),ie.style.setProperty("display","flex"),ie.style.setProperty("justify-content","space-between"),ie.style.setProperty("align-items","center"),ie.style.setProperty("margin-bottom","2rem"),ie.style.setProperty("border-bottom","1px solid var(--border-color)"),ie.style.setProperty("padding-bottom","1rem"),$.style.setProperty("margin","0"),$.style.setProperty("font-size","1.5rem"),l($,()=>e("inventory.physicalInventoryCount","Physical Inventory Count"),null),as(L,"click",t.onClose,!0),L.style.setProperty("background","none"),L.style.setProperty("border","none"),L.style.setProperty("font-size","1.5rem"),L.style.setProperty("cursor","pointer"),L.style.setProperty("padding","0.5rem"),l(F,B(Ge,{get when(){return w()==="setup"},get children(){var U=WE(),N=U.firstChild,z=N.nextSibling,oe=z.nextSibling,G=oe.nextSibling,ee=G.firstChild,J=ee.firstChild,W=J.firstChild,q=J.nextSibling,ae=q.firstChild,de=ee.nextSibling,le=de.firstChild,V=le.firstChild,ce=le.nextSibling,Pe=ce.firstChild,fe=de.nextSibling,be=fe.firstChild,xe=be.firstChild,he=be.nextSibling,ve=he.firstChild,De=ve.nextSibling,Ee=De.nextSibling;return U.style.setProperty("text-align","center"),U.style.setProperty("padding","2rem"),U.style.setProperty("max-width","600px"),U.style.setProperty("margin","0 auto"),N.style.setProperty("font-size","3rem"),N.style.setProperty("margin-bottom","1rem"),z.style.setProperty("margin-bottom","1rem"),l(z,()=>e("inventory.setupPhysicalCount","Setup Physical Inventory Count")),oe.style.setProperty("margin-bottom","2rem"),oe.style.setProperty("color","var(--text-muted)"),l(oe,()=>e("inventory.setupDescription","Configure your physical inventory count settings and begin the counting process.")),G.style.setProperty("display","grid"),G.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),G.style.setProperty("gap","1rem"),G.style.setProperty("margin-bottom","2rem"),G.style.setProperty("padding","1rem"),G.style.setProperty("background","var(--surface-color)"),G.style.setProperty("border-radius","var(--border-radius)"),G.style.setProperty("text-align","left"),J.style.setProperty("display","block"),J.style.setProperty("margin-bottom","0.5rem"),J.style.setProperty("font-weight","500"),l(J,()=>e("inventory.location","Location"),W),q.addEventListener("change",Ce=>u(Ce.target.value)),q.style.setProperty("width","100%"),q.style.setProperty("padding","0.5rem"),q.style.setProperty("border","1px solid var(--border-color)"),q.style.setProperty("border-radius","var(--border-radius-sm)"),l(ae,()=>e("inventory.allLocations","All Locations")),l(q,B(Ht,{get each(){return K()},children:Ce=>(()=>{var Ne=p0();return l(Ne,()=>Ce.name),Se(()=>Ne.value=Ce.id),Ne})()}),null),le.style.setProperty("display","block"),le.style.setProperty("margin-bottom","0.5rem"),le.style.setProperty("font-weight","500"),l(le,()=>e("inventory.category","Category"),V),ce.addEventListener("change",Ce=>y(Ce.target.value)),ce.style.setProperty("width","100%"),ce.style.setProperty("padding","0.5rem"),ce.style.setProperty("border","1px solid var(--border-color)"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),l(Pe,()=>e("products.allCategories","All Categories")),l(ce,B(Ht,{get each(){return ne()},children:Ce=>(()=>{var Ne=p0();return Ne.value=Ce,l(Ne,Ce),Ne})()}),null),be.style.setProperty("display","block"),be.style.setProperty("margin-bottom","0.5rem"),be.style.setProperty("font-weight","500"),l(be,()=>e("inventory.sortBy","Sort By"),xe),he.addEventListener("change",Ce=>p(Ce.target.value)),he.style.setProperty("width","100%"),he.style.setProperty("padding","0.5rem"),he.style.setProperty("border","1px solid var(--border-color)"),he.style.setProperty("border-radius","var(--border-radius-sm)"),l(ve,()=>e("inventory.productName","Product Name")),l(De,()=>e("inventory.sku","SKU")),l(Ee,()=>e("inventory.category","Category")),l(U,B(Ge,{get when(){return!i()},get fallback(){return(()=>{var Ce=XE(),Ne=Ce.firstChild;return Ce.style.setProperty("padding","2rem"),l(Ce,()=>e("common.loading","Loading"),Ne),Ce})()},get children(){return[(()=>{var Ce=UE(),Ne=Ce.firstChild;return Ne.firstChild,Ce.style.setProperty("padding","1rem"),Ce.style.setProperty("background","#fff3cd"),Ce.style.setProperty("border-radius","var(--border-radius-sm)"),Ce.style.setProperty("margin-bottom","2rem"),Ne.style.setProperty("margin","0"),Ne.style.setProperty("color","#856404"),l(Ne,()=>e("inventory.countWillInclude","This count will include {{count}} products from {{location}} in {{category}} category.",{count:Q().length,location:Y(),category:f()==="all"?e("inventory.allCategories","all categories"):f()}),null),Ce})(),B(Ge,{get when(){return Te(()=>f()!=="all")()&&c()!=="all"},get children(){var Ce=HE();return Ce.style.setProperty("display","grid"),Ce.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),Ce.style.setProperty("gap","1rem"),Ce.style.setProperty("margin-bottom","2rem"),Ce.style.setProperty("padding","1rem"),Ce.style.setProperty("background","var(--surface-color)"),Ce.style.setProperty("border-radius","var(--border-radius)"),l(Ce,B(Ge,{get when(){return Ar.hasPermission("physicalInventoryCountingForm")},get children(){return B(Pt,{variant:"primary",size:"large",onClick:k,get disabled(){return i()||Q().length===0},get children(){return[" ",Te(()=>e("inventory.startCounting","Start Physical Count"))]}})}}),null),l(Ce,B(Pt,{variant:"primary",onClick:D,get disabled(){return i()},get children(){return[" ",Te(()=>e("common.print","Print"))]}}),null),Ce}})]}}),null),Se(()=>q.value=c()),Se(()=>ce.value=f()),Se(()=>he.value=v()),U}}),null),l(F,B(Ge,{get when(){return w()==="counting"},get children(){var U=GE(),N=U.firstChild,z=N.nextSibling,oe=z.firstChild,G=oe.firstChild,ee=G.nextSibling,J=oe.nextSibling,W=J.firstChild,q=W.nextSibling,ae=J.nextSibling,de=ae.firstChild,le=de.nextSibling,V=ae.nextSibling,ce=V.firstChild,Pe=ce.firstChild,fe=ce.nextSibling,be=z.nextSibling,xe=be.nextSibling,he=xe.firstChild,ve=he.firstChild,De=ve.firstChild,Ee=De.firstChild,Ce=Ee.nextSibling,Ne=Ce.nextSibling,Ie=Ne.nextSibling,Re=Ie.nextSibling,We=Re.nextSibling,Fe=ve.nextSibling;return N.style.setProperty("display","grid"),N.style.setProperty("grid-template-columns","repeat(auto-fit)"),N.style.setProperty("gap","1rem"),N.style.setProperty("margin-bottom","2rem"),N.style.setProperty("padding","1rem"),N.style.setProperty("background","var(--surface-color)"),N.style.setProperty("border-radius","var(--border-radius)"),l(N,Y),z.style.setProperty("display","grid"),z.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),z.style.setProperty("gap","1rem"),z.style.setProperty("margin-bottom","2rem"),z.style.setProperty("padding","1rem"),z.style.setProperty("background","var(--surface-color)"),z.style.setProperty("border-radius","var(--border-radius)"),oe.style.setProperty("text-align","center"),G.style.setProperty("font-size","1.5rem"),G.style.setProperty("font-weight","700"),G.style.setProperty("color","var(--primary-color)"),l(G,()=>M().countedProducts),ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),l(ee,()=>e("inventory.counted","Counted")),J.style.setProperty("text-align","center"),W.style.setProperty("font-size","1.5rem"),W.style.setProperty("font-weight","700"),W.style.setProperty("color","#ff9800"),l(W,()=>M().remainingProducts),q.style.setProperty("font-size","0.875rem"),q.style.setProperty("color","var(--text-muted)"),l(q,()=>e("inventory.remaining","Remaining")),ae.style.setProperty("text-align","center"),de.style.setProperty("font-size","1.5rem"),de.style.setProperty("font-weight","700"),de.style.setProperty("color","#f44336"),l(de,()=>M().variances),le.style.setProperty("font-size","0.875rem"),le.style.setProperty("color","var(--text-muted)"),l(le,()=>e("inventory.variances","Variances")),V.style.setProperty("text-align","center"),ce.style.setProperty("font-size","1.5rem"),ce.style.setProperty("font-weight","700"),l(ce,()=>Math.round(M().countedProducts/M().totalProducts*100),Pe),fe.style.setProperty("font-size","0.875rem"),fe.style.setProperty("color","var(--text-muted)"),l(fe,()=>e("inventory.complete","Complete")),be.style.setProperty("display","flex"),be.style.setProperty("gap","1rem"),be.style.setProperty("margin-bottom","2rem"),be.style.setProperty("justify-content","center"),l(be,B(Pt,{variant:"outline",onClick:()=>x("setup"),get children(){return[" ",Te(()=>e("common.back","Back to Setup"))]}}),null),l(be,B(Pt,{variant:"primary",onClick:()=>x("review"),get children(){return[" ",Te(()=>e("inventory.reviewAdjustments","Review Adjustments"))]}}),null),xe.style.setProperty("border","1px solid var(--border-color)"),xe.style.setProperty("border-radius","var(--border-radius)"),xe.style.setProperty("overflow-x","auto"),he.style.setProperty("width","100%"),he.style.setProperty("border-collapse","collapse"),De.style.setProperty("background","var(--surface-color)"),Ee.style.setProperty("padding","1rem"),Ee.style.setProperty("text-align","left"),Ee.style.setProperty("border-bottom","1px solid var(--border-color)"),l(Ee,()=>e("inventory.no","No")),Ce.style.setProperty("padding","1rem"),Ce.style.setProperty("text-align","left"),Ce.style.setProperty("border-bottom","1px solid var(--border-color)"),l(Ce,()=>e("inventory.product","Product")),Ne.style.setProperty("padding","1rem"),Ne.style.setProperty("text-align","center"),Ne.style.setProperty("border-bottom","1px solid var(--border-color)"),l(Ne,()=>e("inventory.systemQty","System Qty")),Ie.style.setProperty("padding","1rem"),Ie.style.setProperty("text-align","center"),Ie.style.setProperty("border-bottom","1px solid var(--border-color)"),l(Ie,()=>e("inventory.physicalCount","Physical Count")),Re.style.setProperty("padding","1rem"),Re.style.setProperty("text-align","center"),Re.style.setProperty("border-bottom","1px solid var(--border-color)"),l(Re,()=>e("inventory.variance","Variance")),We.style.setProperty("padding","1rem"),We.style.setProperty("text-align","left"),We.style.setProperty("border-bottom","1px solid var(--border-color)"),l(We,()=>e("common.notes","Notes")),l(Fe,B(Ht,{get each(){return I()},children:(Xe,tt)=>B(rT,{get index(){return tt()},updatePhysicalCount:C,entry:Xe,updateNotes:E})})),Se(Xe=>(Xe=M().isComplete?"#4caf50":"#ff9800")!=null?ce.style.setProperty("color",Xe):ce.style.removeProperty("color")),U}}),null),l(F,B(Ge,{get when(){return w()==="review"},get children(){var U=JE(),N=U.firstChild,z=N.firstChild;z.firstChild;var oe=z.nextSibling,G=N.nextSibling,ee=G.firstChild,J=ee.firstChild,W=J.nextSibling,q=ee.nextSibling,ae=q.firstChild,de=ae.nextSibling,le=q.nextSibling,V=le.firstChild,ce=V.nextSibling,Pe=G.nextSibling;return N.style.setProperty("text-align","center"),N.style.setProperty("margin-bottom","2rem"),z.style.setProperty("margin-bottom","1rem"),l(z,()=>e("inventory.reviewAndConfirm","Review and Confirm Adjustments"),null),oe.style.setProperty("color","var(--text-muted)"),l(oe,()=>e("inventory.reviewDescription","Review the inventory adjustments below and confirm to update your system.")),G.style.setProperty("display","grid"),G.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),G.style.setProperty("gap","1rem"),G.style.setProperty("margin-bottom","2rem"),G.style.setProperty("padding","1rem"),G.style.setProperty("background","var(--surface-color)"),G.style.setProperty("border-radius","var(--border-radius)"),ee.style.setProperty("text-align","center"),J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","700"),J.style.setProperty("color","#4caf50"),l(J,()=>M().positiveVariances),W.style.setProperty("font-size","0.875rem"),W.style.setProperty("color","var(--text-muted)"),l(W,()=>e("inventory.stockIncreases","Stock Increases")),q.style.setProperty("text-align","center"),ae.style.setProperty("font-size","1.5rem"),ae.style.setProperty("font-weight","700"),ae.style.setProperty("color","#f44336"),l(ae,()=>M().negativeVariances),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("color","var(--text-muted)"),l(de,()=>e("inventory.stockDecreases","Stock Decreases")),le.style.setProperty("text-align","center"),V.style.setProperty("font-size","1.5rem"),V.style.setProperty("font-weight","700"),V.style.setProperty("color","var(--primary-color)"),l(V,()=>M().variances),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("color","var(--text-muted)"),l(ce,()=>e("inventory.totalAdjustments","Total Adjustments")),Pe.style.setProperty("display","flex"),Pe.style.setProperty("gap","1rem"),Pe.style.setProperty("margin-bottom","2rem"),Pe.style.setProperty("justify-content","center"),Pe.style.setProperty("flex-wrap","wrap"),l(Pe,B(Pt,{variant:"outline",onClick:()=>x("counting"),get children(){return[" ",Te(()=>e("common.back","Back to Counting"))]}}),null),l(Pe,B(Pt,{variant:"outline",onClick:S,get disabled(){return M().variances===0},get children(){return[" ",Te(()=>e("inventory.downloadCSV","Download CSV"))]}}),null),l(Pe,B(Pt,{variant:"primary",onClick:b,get disabled(){return s()||M().variances===0},get children(){return Te(()=>!!s())()?" "+e("common.saving","Saving")+"...":" "+e("inventory.confirmAdjustments","Confirm Adjustments")}}),null),l(U,B(Ge,{get when(){return M().variances>0},get children(){var fe=YE(),be=fe.firstChild,xe=be.firstChild,he=xe.firstChild,ve=he.firstChild,De=ve.nextSibling,Ee=De.nextSibling,Ce=Ee.nextSibling,Ne=Ce.nextSibling,Ie=xe.nextSibling;return fe.style.setProperty("border","1px solid var(--border-color)"),fe.style.setProperty("border-radius","var(--border-radius)"),fe.style.setProperty("overflow-x","auto"),be.style.setProperty("width","100%"),be.style.setProperty("border-collapse","collapse"),he.style.setProperty("background","var(--surface-color)"),ve.style.setProperty("padding","1rem"),ve.style.setProperty("text-align","left"),ve.style.setProperty("border-bottom","1px solid var(--border-color)"),l(ve,()=>e("inventory.product","Product")),De.style.setProperty("padding","1rem"),De.style.setProperty("text-align","center"),De.style.setProperty("border-bottom","1px solid var(--border-color)"),l(De,()=>e("inventory.systemQty","System Qty")),Ee.style.setProperty("padding","1rem"),Ee.style.setProperty("text-align","center"),Ee.style.setProperty("border-bottom","1px solid var(--border-color)"),l(Ee,()=>e("inventory.physicalCount","Physical Count")),Ce.style.setProperty("padding","1rem"),Ce.style.setProperty("text-align","center"),Ce.style.setProperty("border-bottom","1px solid var(--border-color)"),l(Ce,()=>e("inventory.adjustment","Adjustment")),Ne.style.setProperty("padding","1rem"),Ne.style.setProperty("text-align","left"),Ne.style.setProperty("border-bottom","1px solid var(--border-color)"),l(Ne,()=>e("common.notes","Notes")),l(Ie,B(Ht,{get each(){return I().filter(Re=>Re.variance!==0)},children:Re=>(()=>{var We=ZE(),Fe=We.firstChild,Xe=Fe.firstChild,tt=Xe.nextSibling,At=tt.firstChild,rt=Fe.nextSibling,He=rt.firstChild,xt=rt.nextSibling,_t=xt.firstChild,mt=xt.nextSibling,Et=mt.firstChild,et=mt.nextSibling,qe=et.firstChild;return We.style.setProperty("border-bottom","1px solid var(--border-color)"),Fe.style.setProperty("padding","1rem"),Xe.style.setProperty("font-weight","500"),l(Xe,()=>Re.product.name),tt.style.setProperty("font-size","0.875rem"),tt.style.setProperty("color","var(--text-muted)"),l(tt,()=>Re.product.sku,At),l(tt,()=>Re.product.category,null),rt.style.setProperty("padding","1rem"),rt.style.setProperty("text-align","center"),He.style.setProperty("font-weight","600"),l(He,()=>Re.systemQuantity),xt.style.setProperty("padding","1rem"),xt.style.setProperty("text-align","center"),_t.style.setProperty("font-weight","600"),l(_t,()=>Re.physicalCount),mt.style.setProperty("padding","1rem"),mt.style.setProperty("text-align","center"),Et.style.setProperty("font-weight","700"),l(Et,()=>Re.variance>0?"+":"",null),l(Et,()=>Re.variance,null),et.style.setProperty("padding","1rem"),qe.style.setProperty("font-size","0.875rem"),l(qe,()=>Re.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")),Se(ot=>{var Je=Re.variance>0?"#d4edda":"#f8d7da",at=Re.variance>0?"#4caf50":"#f44336";return Je!==ot.e&&((ot.e=Je)!=null?We.style.setProperty("background",Je):We.style.removeProperty("background")),at!==ot.t&&((ot.t=at)!=null?Et.style.setProperty("color",at):Et.style.removeProperty("color")),ot},{e:void 0,t:void 0}),We})()})),fe}}),null),l(U,B(Ge,{get when(){return M().variances===0},get children(){var fe=KE(),be=fe.firstChild,xe=be.nextSibling,he=xe.nextSibling;return fe.style.setProperty("text-align","center"),fe.style.setProperty("padding","3rem"),fe.style.setProperty("background","var(--surface-color)"),fe.style.setProperty("border-radius","var(--border-radius)"),be.style.setProperty("font-size","3rem"),be.style.setProperty("margin-bottom","1rem"),xe.style.setProperty("margin-bottom","0.5rem"),l(xe,()=>e("inventory.perfectCount","Perfect Count!")),he.style.setProperty("color","var(--text-muted)"),l(he,()=>e("inventory.noVariances","No variances found. Your physical count matches the system exactly.")),fe}}),null),U}}),null),H}})},rT=t=>{const{t:e}=tr(),[r,n]=$e(""),[i,o]=$e("");let{entry:s,updatePhysicalCount:a,updateNotes:c,index:u}=t;Nn(()=>{o(s?.notes),n(s?.physicalCount)});const f=()=>{let y=document.getElementById(`physicalCountInput_${u+2}`);if(console.log(uu(r()),!y),uu(r())&&!y){a(s?.productId,r()===""?null:parseFloat(r()));return}if(uu(r())&&y){y.focus(),a(s?.productId,r()===""?null:parseFloat(r()));return}};return(()=>{var y=eT(),v=y.firstChild,p=v.firstChild,I=v.nextSibling,P=I.firstChild,w=P.nextSibling,x=w.firstChild,j=x.nextSibling;j.nextSibling;var ne=I.nextSibling,Q=ne.firstChild,K=ne.nextSibling,Z=K.firstChild,k=K.nextSibling,C=k.firstChild,E=k.nextSibling,M=E.firstChild;return y.style.setProperty("border-bottom","1px solid var(--border-color)"),v.style.setProperty("padding","1rem"),v.style.setProperty("text-align","center"),p.style.setProperty("font-weight","600"),l(p,u+1),I.style.setProperty("padding","1rem"),P.style.setProperty("font-weight","500"),l(P,()=>s?.product.name),w.style.setProperty("font-size","0.875rem"),w.style.setProperty("color","var(--text-muted)"),l(w,()=>s?.product.sku,x),l(w,()=>s?.product.category,j),l(w,()=>s?.product.unitOfMeasure,null),ne.style.setProperty("padding","1rem"),ne.style.setProperty("text-align","center"),Q.style.setProperty("font-weight","600"),l(Q,()=>s?.systemQuantity),K.style.setProperty("padding","1rem"),K.style.setProperty("text-align","center"),Z.addEventListener("blur",()=>{f()}),Z.$$keydown=_=>{_.keyCode===13&&f(),_.keyCode===27&&f(),_.keyCode},Z.$$input=_=>{const S=_.target.value;n(S)},Yt(Z,"id",`physicalCountInput_${u+1}`),Yt(Z,"tabindex",u),Z.style.setProperty("width","100px"),Z.style.setProperty("padding","0.5rem"),Z.style.setProperty("border","1px solid var(--border-color)"),Z.style.setProperty("border-radius","var(--border-radius-sm)"),Z.style.setProperty("text-align","center"),k.style.setProperty("padding","1rem"),k.style.setProperty("text-align","center"),C.style.setProperty("font-weight","600"),l(C,()=>s?.variance>0?"+":"",null),l(C,()=>s?.variance||"",null),E.style.setProperty("padding","1rem"),M.addEventListener("blur",_=>{c(s?.productId,i())}),M.$$keydown=_=>{_.keyCode===13&&c(s?.productId,i()),_.keyCode===27&&c(s?.productId,i()),_.keyCode===9&&c(s?.productId,i())},M.$$input=_=>{const S=_.target.value;o(S)},M.style.setProperty("width","200px"),M.style.setProperty("padding","0.5rem"),M.style.setProperty("border","1px solid var(--border-color)"),M.style.setProperty("border-radius","var(--border-radius-sm)"),Se(_=>{var S=s?.physicalCount!==null?s?.variance!==0?"#fff3cd":"#d4edda":"transparent",b=s?.variance>0?"#4caf50":s?.variance<0?"#f44336":"var(--text-muted)",Y=e("inventory.addNotes","Add notes...");return S!==_.e&&((_.e=S)!=null?y.style.setProperty("background",S):y.style.removeProperty("background")),b!==_.t&&((_.t=b)!=null?C.style.setProperty("color",b):C.style.removeProperty("color")),Y!==_.a&&Yt(M,"placeholder",_.a=Y),_},{e:void 0,t:void 0,a:void 0}),Se(()=>Z.value=r()||""),Se(()=>M.value=i()||""),y})()};ur(["click","input","keydown"]);function nT(t,e=300,r=!1){let n,i;const o=()=>{n!==void 0&&(clearTimeout(n),n=void 0),i=void 0},s=()=>{n!==void 0&&i!==void 0&&(clearTimeout(n),n=void 0,t(...i),i=void 0)},a=(...c)=>{i=c,n!==void 0&&clearTimeout(n),r&&n===void 0&&t(...c),n=window.setTimeout(()=>{r||t(...c),n=void 0,i=void 0},e)};return Pc(()=>{o()}),{debounced:a,cancel:o,flush:s}}function iT(t,e=300){const[r,n]=$e(!1);let i;const o=async u=>{if(i&&i.abort(),!u.trim()){n(!1);return}i=new AbortController,n(!0);try{await t(u)}catch(f){f instanceof Error&&f.name!=="AbortError"&&console.error("Search error:",f)}finally{i.signal.aborted||n(!1)}},{debounced:s,cancel:a}=nT(o,e,!1),c=()=>{a(),i&&i.abort(),n(!1)};return Pc(()=>{c()}),{search:s,isSearching:r,cancel:c}}var m0=ue("<div>"),oT=ue("<div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),sT=ue("<div><h3></h3><div><div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><div><span></span><span></span></div><div><span></span><span>%"),aT=ue("<div><h4>"),lT=ue("<div><h3></h3><div><div><div><span></span><span> </span></div><div><span></span><span> </span></div></div><div><div><span></span><span> </span></div><div><span></span><span>"),cT=ue("<div><h3></h3><div><span></span><span></span></div><div><span></span><span>"),y0=ue("<div><h3>"),uT=ue("<div><div><div><h2></h2><div>SKU: <!>  </div></div><div></div></div><div><button></button><button></button><button></button></div><div>"),dT=ue("<span> "),hT=ue("<span> "),fT=ue("<div><div><span><span>  </span></span><span> </span></div><div>: <!>  <!>: "),pT=ue("<div> "),mT=ue("<div>Ref: "),yT=ue("<div><div><div><span></span><span></span><span></span></div><div><span></span></div></div><div><div> </div><div>"),gT=ue("<div><h4></h4><div></div><div>"),vT=ue("<div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div> <!>  </div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div>Min: <!>  Max: ");const bT=t=>{const{t:e}=tr(),[r,n]=$e("details"),i=Nt(()=>{if(!t.product)return null;const E=lt.getTotalStockByProduct(t.product.id),M=lt.getStockByProduct(t.product.id),_=E<=t.product.minStockLevel,S=E===0,b=E>=t.product.maxStockLevel;return{total:E,byLocation:M,status:S?"out":_?"low":b?"over":"good",statusText:S?e("products.outOfStock","Out of Stock"):_?e("products.lowStock","Low Stock"):b?e("products.overStock","Over Stock"):e("products.inStock","In Stock")}}),o=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E),s=E=>new Date(E).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),a=Nt(()=>!t.product||t.product.unitCost===0?0:((t.product.sellingPrice-t.product.unitCost)/t.product.unitCost*100).toFixed(2)),c=Nt(()=>t.product?lt.movements.filter(E=>E.productId===t.product.id).sort((E,M)=>new Date(M.createdDate).getTime()-new Date(E.createdDate).getTime()):[]),u=Nt(()=>{if(!t.product)return null;const E=c(),M=i(),_=new Date;_.setDate(_.getDate()-30);const S=E.filter(Y=>new Date(Y.createdDate)>=_),b=E.reduce((Y,te)=>{const O=te.productId===t.product.id?te:null;return Y+(O?O.quantity*O.unitCost:0)},0);return{recentMovements:E.length,movements30Days:S.length,totalValue:(M?.total||0)*t.product.unitCost,averageMovementValue:E.length>0?b/E.length:0,lastMovementDate:E.length>0?E[0].createdDate:null}}),f={"margin-bottom":"2rem"},y={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},v={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},p={"font-weight":"400",color:"var(--text-primary)","font-size":"1rem"},I=E=>({in:"",out:"",transfer:"",adjustment:""})[E]||"";function P(E){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[E]||{bg:"#f5f5f5",color:"#666"}}const w=E=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:P(E).bg,color:P(E).color}),x=E=>{const M={good:{background:"#d4edda",color:"#155724"},low:{background:"#fff3cd",color:"#856404"},out:{background:"#f8d7da",color:"#721c24"},over:{background:"#cce5ff",color:"#004085"}};return{display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500",...M[E]||M.good}},j={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"},ne={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-bottom":"0.75rem"},Q={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem","padding-bottom":"1rem","border-bottom":"2px solid var(--border-color)"},K={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},Z=E=>({padding:"0.75rem 1.5rem",background:"none",border:"none","border-bottom":E?"2px solid var(--primary-color)":"2px solid transparent",color:E?"var(--primary-color)":"var(--text-muted)","font-weight":E?"600":"400",cursor:"pointer",transition:"all 0.2s","font-size":"0.875rem"}),k={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-bottom":"0.5rem"},C={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1.5rem","margin-bottom":"1rem"};return B(Qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("products.productDetails","Product Details")},size:"large",get children(){return B(Ge,{get when(){return t.product},get fallback(){return(()=>{var E=m0();return E.style.setProperty("text-align","center"),E.style.setProperty("padding","2rem"),E.style.setProperty("color","var(--text-muted)"),l(E,()=>e("products.noProductSelected","No product selected")),E})()},children:E=>(()=>{var M=uT(),_=M.firstChild,S=_.firstChild,b=S.firstChild,Y=b.nextSibling,te=Y.firstChild,O=te.nextSibling;O.nextSibling;var D=S.nextSibling,X=_.nextSibling,H=X.firstChild,F=H.nextSibling,ie=F.nextSibling,$=X.nextSibling;return l(M,()=>JSON.stringify(E),_),m(_,Q),b.style.setProperty("margin","0"),b.style.setProperty("font-size","1.5rem"),b.style.setProperty("margin-bottom","0.25rem"),l(b,()=>E().name),Y.style.setProperty("color","var(--text-muted)"),l(Y,()=>E().sku,O),l(Y,()=>E().category,null),l(D,()=>i()?.statusText),m(X,K),H.$$click=()=>n("details"),l(H,()=>e("products.details","Details")),F.$$click=()=>n("movements"),l(F,()=>e("products.movements","Movements")),ie.$$click=()=>n("analytics"),l(ie,()=>e("products.analytics","Analytics")),l(M,B(Ge,{get when(){return r()==="details"},get children(){return[(()=>{var L=oT(),U=L.firstChild,N=U.nextSibling,z=N.firstChild,oe=z.nextSibling,G=N.nextSibling,ee=G.firstChild,J=ee.nextSibling,W=G.nextSibling,q=W.firstChild,ae=q.nextSibling;return U.style.setProperty("margin-bottom","1rem"),U.style.setProperty("font-size","1.1rem"),l(U,()=>e("products.basicInformation","Basic Information")),l(z,()=>e("products.description","Description")),l(oe,()=>E().description||e("common.notAvailable","N/A")),l(ee,()=>e("products.unitOfMeasure","Unit of Measure")),l(J,()=>E().unitOfMeasure),l(q,()=>e("products.status","Status")),l(ae,(()=>{var de=Te(()=>!!E().isActive);return()=>de()?(()=>{var le=dT();return le.firstChild,le.style.setProperty("color","#2e7d32"),l(le,()=>e("common.active","Active"),null),le})():(()=>{var le=hT();return le.firstChild,le.style.setProperty("color","#d32f2f"),l(le,()=>e("common.inactive","Inactive"),null),le})()})()),Se(de=>{var le=f,V=y,ce=v,Pe=p,fe=y,be=v,xe=p,he=y,ve=v,De=p;return de.e=m(L,le,de.e),de.t=m(N,V,de.t),de.a=m(z,ce,de.a),de.o=m(oe,Pe,de.o),de.i=m(G,fe,de.i),de.n=m(ee,be,de.n),de.s=m(J,xe,de.s),de.h=m(W,he,de.h),de.r=m(q,ve,de.r),de.d=m(ae,De,de.d),de},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),L})(),(()=>{var L=sT(),U=L.firstChild,N=U.nextSibling,z=N.firstChild,oe=z.firstChild,G=oe.firstChild,ee=G.nextSibling,J=oe.nextSibling,W=J.firstChild,q=W.nextSibling,ae=z.nextSibling,de=ae.firstChild,le=de.firstChild,V=le.nextSibling,ce=de.nextSibling,Pe=ce.firstChild,fe=Pe.nextSibling,be=fe.firstChild;return U.style.setProperty("margin-bottom","1rem"),U.style.setProperty("font-size","1.1rem"),l(U,()=>e("products.pricingInformation","Pricing Information")),l(G,()=>e("products.unitCost","Unit Cost")),l(ee,()=>o(E().unitCost)),l(W,()=>e("products.sellingPrice","Selling Price")),l(q,()=>o(E().sellingPrice)),l(le,()=>e("products.profit","Profit")),l(V,()=>o(E().sellingPrice-E().unitCost)),l(Pe,()=>e("products.profitMargin","Profit Margin")),l(fe,a,be),Se(xe=>{var he=f,ve=j,De=y,Ee=v,Ce=p,Ne=y,Ie=v,Re=p,We=y,Fe=v,Xe=p,tt=y,At=v,rt=p;return xe.e=m(L,he,xe.e),xe.t=m(N,ve,xe.t),xe.a=m(oe,De,xe.a),xe.o=m(G,Ee,xe.o),xe.i=m(ee,Ce,xe.i),xe.n=m(J,Ne,xe.n),xe.s=m(W,Ie,xe.s),xe.h=m(q,Re,xe.h),xe.r=m(de,We,xe.r),xe.d=m(le,Fe,xe.d),xe.l=m(V,Xe,xe.l),xe.u=m(ce,tt,xe.u),xe.c=m(Pe,At,xe.c),xe.w=m(fe,rt,xe.w),xe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),L})(),(()=>{var L=lT(),U=L.firstChild,N=U.nextSibling,z=N.firstChild,oe=z.firstChild,G=oe.firstChild,ee=G.nextSibling,J=ee.firstChild,W=oe.nextSibling,q=W.firstChild,ae=q.nextSibling,de=ae.firstChild,le=z.nextSibling,V=le.firstChild,ce=V.firstChild,Pe=ce.nextSibling,fe=Pe.firstChild,be=V.nextSibling,xe=be.firstChild,he=xe.nextSibling;return U.style.setProperty("margin-bottom","1rem"),U.style.setProperty("font-size","1.1rem"),l(U,()=>e("products.stockInformation","Stock Information")),l(G,()=>e("products.totalStock","Total Stock")),l(ee,()=>i()?.total||0,J),l(ee,()=>E().unitOfMeasure,null),l(q,()=>e("products.minStockLevel","Min Stock Level")),l(ae,()=>E().minStockLevel,de),l(ae,()=>E().unitOfMeasure,null),l(ce,()=>e("products.maxStockLevel","Max Stock Level")),l(Pe,()=>E().maxStockLevel,fe),l(Pe,()=>E().unitOfMeasure,null),l(xe,()=>e("products.stockValue","Stock Value")),l(he,()=>o((i()?.total||0)*E().unitCost)),l(L,B(Ge,{get when(){return Te(()=>!!i()?.byLocation)()&&i().byLocation.length>0},get children(){var ve=aT(),De=ve.firstChild;return ve.style.setProperty("margin-top","1.5rem"),De.style.setProperty("margin-bottom","1rem"),De.style.setProperty("font-size","1rem"),l(De,()=>e("products.stockByLocation","Stock by Location")),l(ve,()=>i().byLocation.map(Ee=>(()=>{var Ce=fT(),Ne=Ce.firstChild,Ie=Ne.firstChild,Re=Ie.firstChild;Re.firstChild;var We=Ie.nextSibling,Fe=We.firstChild,Xe=Ne.nextSibling,tt=Xe.firstChild,At=tt.nextSibling,rt=At.nextSibling,He=rt.nextSibling;return He.nextSibling,m(Ce,ne),Ne.style.setProperty("display","flex"),Ne.style.setProperty("justify-content","space-between"),Ne.style.setProperty("align-items","center"),Ie.style.setProperty("font-weight","500"),Ie.style.setProperty("color","var(--primary-color)"),l(Ie,()=>Ee.locationId,Re),Re.style.setProperty("font-weight","500"),Re.style.setProperty("color","var(--text-muted)"),l(Re,()=>Ee.locationName,null),We.style.setProperty("font-weight","600"),l(We,()=>Ee.quantity,Fe),l(We,()=>E().unitOfMeasure,null),Xe.style.setProperty("margin-top","0.5rem"),Xe.style.setProperty("font-size","0.875rem"),Xe.style.setProperty("color","var(--text-muted)"),l(Xe,()=>e("products.available","Available"),tt),l(Xe,()=>Ee.availableQuantity,At),l(Xe,()=>e("products.reserved","Reserved"),He),l(Xe,()=>Ee.reservedQuantity,null),Se(xt=>(xt=Ee.quantity>0?"var(--primary-color)":"var(--text-muted)")!=null?We.style.setProperty("color",xt):We.style.removeProperty("color")),Ce})()),null),ve}}),null),Se(ve=>{var De=f,Ee=j,Ce=y,Ne=v,Ie=p,Re=y,We=v,Fe=p,Xe=y,tt=v,At=p,rt=y,He=v,xt=p;return ve.e=m(L,De,ve.e),ve.t=m(N,Ee,ve.t),ve.a=m(oe,Ce,ve.a),ve.o=m(G,Ne,ve.o),ve.i=m(ee,Ie,ve.i),ve.n=m(W,Re,ve.n),ve.s=m(q,We,ve.s),ve.h=m(ae,Fe,ve.h),ve.r=m(V,Xe,ve.r),ve.d=m(ce,tt,ve.d),ve.l=m(Pe,At,ve.l),ve.u=m(be,rt,ve.u),ve.c=m(xe,He,ve.c),ve.w=m(he,xt,ve.w),ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),L})(),(()=>{var L=cT(),U=L.firstChild,N=U.nextSibling,z=N.firstChild,oe=z.nextSibling,G=N.nextSibling,ee=G.firstChild,J=ee.nextSibling;return U.style.setProperty("margin-bottom","1rem"),U.style.setProperty("font-size","1.1rem"),l(U,()=>e("products.timestamps","Timestamps")),l(z,()=>e("common.createdDate","Created Date")),l(oe,()=>s(E().createdDate)),l(ee,()=>e("common.lastModified","Last Modified")),l(J,()=>s(E().lastModified)),Se(W=>{var q=f,ae=y,de=v,le=p,V=y,ce=v,Pe=p;return W.e=m(L,q,W.e),W.t=m(N,ae,W.t),W.a=m(z,de,W.a),W.o=m(oe,le,W.o),W.i=m(G,V,W.i),W.n=m(ee,ce,W.n),W.s=m(J,Pe,W.s),W},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),L})()]}}),$),l(M,B(Ge,{get when(){return r()==="movements"},get children(){var L=y0(),U=L.firstChild;return U.style.setProperty("margin-bottom","1rem"),U.style.setProperty("font-size","1.1rem"),l(U,()=>e("products.recentMovements","Recent Movements")),l(L,B(Ge,{get when(){return c().length>0},get fallback(){return(()=>{var N=pT();return N.firstChild,N.style.setProperty("text-align","center"),N.style.setProperty("padding","2rem"),N.style.setProperty("color","var(--text-muted)"),N.style.setProperty("background","var(--surface-color)"),N.style.setProperty("border-radius","var(--border-radius-sm)"),N.style.setProperty("border","1px solid var(--border-color)"),l(N,()=>e("products.noMovements","No movements found for this product"),null),N})()},get children(){return B(Ht,{get each(){return c()},children:N=>{const z=N.productId===E().id?N:null;if(!z)return null;let oe=lt.getLocationById(N.locationId);return(()=>{var G=yT(),ee=G.firstChild,J=ee.firstChild,W=J.firstChild,q=W.nextSibling,ae=q.nextSibling,de=J.nextSibling,le=de.firstChild,V=ee.nextSibling,ce=V.firstChild,Pe=ce.firstChild,fe=ce.nextSibling;return m(G,k),J.style.setProperty("font-weight","600"),J.style.setProperty("margin-bottom","0.25rem"),W.style.setProperty("font-size","1.2rem"),l(W,()=>I(N.movementType)),q.style.setProperty("padding","0 6px"),l(ae,()=>N.movementType),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("color","var(--text-muted)"),l(de,()=>` ${s(N?.createdDate)}  `,le),le.style.setProperty("font-size","0.875rem"),le.style.setProperty("font-weight","600"),le.style.setProperty("color","var(--primary-color)"),l(le,()=>N?.locationId),l(de,()=>`  ${oe?.name}`,null),l(ee,B(Ge,{get when(){return N.referenceNumber},get children(){var be=mT();return be.firstChild,be.style.setProperty("font-size","0.75rem"),be.style.setProperty("color","var(--text-muted)"),be.style.setProperty("margin-top","0.25rem"),l(be,()=>N?.referenceNumber,null),be}}),null),V.style.setProperty("text-align","right"),ce.style.setProperty("font-weight","600"),ce.style.setProperty("font-size","1rem"),l(ce,()=>N?.movementType==="in"?"+":"",Pe),l(ce,()=>z.quantity,Pe),l(ce,()=>E().unitOfMeasure,null),fe.style.setProperty("font-size","0.875rem"),fe.style.setProperty("color","var(--text-muted)"),l(fe,()=>o(z.unitCost)),Se(be=>{var xe=w(N.movementType),he=N?.movementType==="in"?"#2e7d32":"#d32f2f";return be.e=m(ae,xe,be.e),he!==be.t&&((be.t=he)!=null?ce.style.setProperty("color",he):ce.style.removeProperty("color")),be},{e:void 0,t:void 0}),G})()}})}}),null),Se(N=>m(L,f,N)),L}}),$),l(M,B(Ge,{get when(){return r()==="analytics"},get children(){var L=y0(),U=L.firstChild;return U.style.setProperty("margin-bottom","1rem"),U.style.setProperty("font-size","1.1rem"),l(U,()=>e("products.analytics","Analytics")),l(L,B(Ge,{get when(){return u()},get fallback(){return(()=>{var N=m0();return N.style.setProperty("text-align","center"),N.style.setProperty("padding","2rem"),N.style.setProperty("color","var(--text-muted)"),l(N,()=>e("products.noAnalytics","No analytics data available")),N})()},children:N=>(()=>{var z=vT(),oe=z.firstChild,G=oe.firstChild,ee=G.nextSibling,J=ee.nextSibling,W=oe.nextSibling,q=W.firstChild,ae=q.nextSibling,de=ae.nextSibling,le=W.nextSibling,V=le.firstChild,ce=V.nextSibling,Pe=ce.nextSibling,fe=Pe.firstChild,be=fe.nextSibling;be.nextSibling;var xe=le.nextSibling,he=xe.firstChild,ve=he.nextSibling,De=ve.nextSibling,Ee=xe.nextSibling,Ce=Ee.firstChild,Ne=Ce.nextSibling,Ie=Ne.nextSibling,Re=Ie.firstChild,We=Re.nextSibling;return We.nextSibling,G.style.setProperty("margin","0 0 0.5rem 0"),G.style.setProperty("color","var(--primary-color)"),l(G,()=>e("products.totalMovements","Total Movements")),ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","600"),l(ee,()=>N().recentMovements),J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-muted)"),J.style.setProperty("margin-top","0.25rem"),l(J,()=>e("products.allTime","All time")),q.style.setProperty("margin","0 0 0.5rem 0"),q.style.setProperty("color","var(--primary-color)"),l(q,()=>e("products.last30Days","Last 30 Days")),ae.style.setProperty("font-size","1.5rem"),ae.style.setProperty("font-weight","600"),l(ae,()=>N().movements30Days),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("color","var(--text-muted)"),de.style.setProperty("margin-top","0.25rem"),l(de,()=>e("products.movements","movements")),V.style.setProperty("margin","0 0 0.5rem 0"),V.style.setProperty("color","var(--primary-color)"),l(V,()=>e("products.currentValue","Current Stock Value")),ce.style.setProperty("font-size","1.5rem"),ce.style.setProperty("font-weight","600"),l(ce,()=>o(N().totalValue)),Pe.style.setProperty("font-size","0.875rem"),Pe.style.setProperty("color","var(--text-muted)"),Pe.style.setProperty("margin-top","0.25rem"),l(Pe,()=>i()?.total||0,fe),l(Pe,()=>E().unitOfMeasure,be),l(Pe,()=>o(E().unitCost),null),he.style.setProperty("margin","0 0 0.5rem 0"),he.style.setProperty("color","var(--primary-color)"),l(he,()=>e("products.avgMovementValue","Avg Movement Value")),ve.style.setProperty("font-size","1.5rem"),ve.style.setProperty("font-weight","600"),l(ve,()=>o(N().averageMovementValue)),De.style.setProperty("font-size","0.875rem"),De.style.setProperty("color","var(--text-muted)"),De.style.setProperty("margin-top","0.25rem"),l(De,()=>e("products.perMovement","per movement")),l(z,B(Ge,{get when(){return N().lastMovementDate},get children(){var Fe=gT(),Xe=Fe.firstChild,tt=Xe.nextSibling,At=tt.nextSibling;return Xe.style.setProperty("margin","0 0 0.5rem 0"),Xe.style.setProperty("color","var(--primary-color)"),l(Xe,()=>e("products.lastMovement","Last Movement")),tt.style.setProperty("font-size","1.25rem"),tt.style.setProperty("font-weight","600"),l(tt,()=>s(N().lastMovementDate)),At.style.setProperty("font-size","0.875rem"),At.style.setProperty("color","var(--text-muted)"),At.style.setProperty("margin-top","0.25rem"),l(At,()=>e("products.mostRecent","Most recent activity")),Se(rt=>m(Fe,C,rt)),Fe}}),Ee),Ce.style.setProperty("margin","0 0 0.5rem 0"),Ce.style.setProperty("color","var(--primary-color)"),l(Ce,()=>e("products.stockStatus","Stock Status")),Ne.style.setProperty("font-size","1.25rem"),Ne.style.setProperty("font-weight","600"),l(Ne,()=>i()?.statusText),Ie.style.setProperty("font-size","0.875rem"),Ie.style.setProperty("color","var(--text-muted)"),Ie.style.setProperty("margin-top","0.25rem"),l(Ie,()=>E().minStockLevel,We),l(Ie,()=>E().maxStockLevel,null),Se(Fe=>{var Xe=j,tt=C,At=C,rt=C,He=C,xt=C;return Fe.e=m(z,Xe,Fe.e),Fe.t=m(oe,tt,Fe.t),Fe.a=m(W,At,Fe.a),Fe.o=m(le,rt,Fe.o),Fe.i=m(xe,He,Fe.i),Fe.n=m(Ee,xt,Fe.n),Fe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),z})()}),null),Se(N=>m(L,f,N)),L}}),$),$.style.setProperty("display","flex"),$.style.setProperty("gap","1rem"),$.style.setProperty("justify-content","flex-end"),$.style.setProperty("margin-top","2rem"),l($,B(Pt,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close","Close")}}),null),l($,B(Ge,{get when(){return t.onEdit},get children(){return B(Pt,{variant:"primary",get onClick(){return t.onEdit},get children(){return e("common.edit","Edit")}})}}),null),Se(L=>{var U=x(i()?.status||"good"),N=Z(r()==="details"),z=Z(r()==="movements"),oe=Z(r()==="analytics");return L.e=m(D,U,L.e),L.t=m(H,N,L.t),L.a=m(F,z,L.a),L.o=m(ie,oe,L.o),L},{e:void 0,t:void 0,a:void 0,o:void 0}),M})()})}})};ur(["click"]);var _T=ue("<div>"),wT=ue("<button type=button>"),ST=ue("<div> "),g0=ue("<div>"),PT=ue("<div><div><input type=text autocomplete=off>"),xT=ue("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>"),AT=ue("<span> ");const CT=t=>{const{t:e}=tr(),[r,n]=$e(""),[i,o]=$e(!1),[s,a]=$e(null),[c,u]=$e([]),[f,y]=$e(!1),[v,p]=$e(-1),[I,P]=$e(null),w=t.searchDelay||300,x=t.maxResults||900,j=async N=>{if(!N.trim()||N.trim().length<3){u([]),t.onSearchResults?.([]);return}try{o(!0),a(null);try{const z=await Ai.getProducts(N),oe=Object.keys(z),G=J=>{let W=z;return{id:J,name:W[J].name,businessId:W[J].businessId,sku:W[J].code,UPC:W[J].UPC,numCode:W[J].codeN,category:W[J].category,unitCost:W[J].unitCost||0,unitOfMeasure:W[J].unitOfMeasure,minStockLevel:W[J].minStockLevel,maxStockLevel:W[J].maxStockLevel,isActive:W[J].isActive,description:W[J].description||"",createdDate:W[J].createdAt||new Date().toISOString(),lastModified:W[J].updatedAt||new Date().toISOString()}},ee=oe.map(G);u(ee),lt.updProduct(ee),t.onSearchResults?.(ee)}catch(z){console.warn("API search failed, using local fallback:",z),a("API search failed, showing local results");const oe=lt.getActiveProducts().filter(G=>G.name.toLowerCase().includes(N.toLowerCase())||G.sku.toLowerCase().includes(N.toLowerCase())||G.category.toLowerCase().includes(N.toLowerCase())).slice(0,x);u(oe),t.onSearchResults?.(oe)}}catch(z){const oe=z instanceof Error?z.message:"Search failed";a(oe),u([]),t.onSearchResults?.([])}finally{o(!1)}},ne=N=>{const oe=N.target.value;n(oe),a(null),t.showResults!==!1&&y(!0),I()&&clearTimeout(I());const G=setTimeout(()=>{j(oe)},w);P(G)},Q=N=>{n(N.name),y(!1),p(-1),t.onProductSelect?.(N)},K=N=>{if(!(!f()||c().length===0))switch(N.key){case"ArrowDown":N.preventDefault(),p(z=>Math.min(z+1,c().length-1));break;case"ArrowUp":N.preventDefault(),p(z=>Math.max(z-1,-1));break;case"Enter":N.preventDefault(),v()>=0&&c()[v()]&&Q(c()[v()]);break;case"Escape":y(!1),p(-1);break}},Z=()=>{t.showResults!==!1&&c().length>0&&y(!0)},k=()=>{setTimeout(()=>{y(!1),p(-1)},150)},C=()=>{n(""),u([]),a(null),y(!1),p(-1),t.onSearchResults?.([]),I()&&(clearTimeout(I()),P(null))},E=N=>lt.stockLevels.filter(z=>z.productId===N).reduce((z,oe)=>z+oe.quantity,0),M=N=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(N),_={position:"relative",width:"100%",...t.style},S={position:"relative",display:"flex","align-items":"center"},b={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},Y={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},te={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},O={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},D=N=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:N?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),X={display:"flex","justify-content":"space-between","align-items":"center"},H={flex:"1"},F={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},ie={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},$={"text-align":"right","font-size":"0.875rem"},L={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},U={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var N=PT(),z=N.firstChild,oe=z.firstChild;return oe.addEventListener("blur",k),oe.addEventListener("focus",Z),oe.$$keydown=K,oe.$$input=ne,l(z,B(Ge,{get when(){return i()},get children(){var G=_T();return Se(ee=>m(G,te,ee)),G}}),null),l(z,B(Ge,{get when(){return Te(()=>!!r())()&&!i()},get children(){var G=wT();return G.addEventListener("mouseleave",ee=>{ee.currentTarget.style.background="none",ee.currentTarget.style.color="var(--text-muted)"}),G.addEventListener("mouseenter",ee=>{ee.currentTarget.style.background="var(--border-color)",ee.currentTarget.style.color="var(--text-primary)"}),G.$$click=C,Se(ee=>{var J=Y,W=e("common.clear","Clear search");return ee.e=m(G,J,ee.e),W!==ee.t&&Yt(G,"title",ee.t=W),ee},{e:void 0,t:void 0}),G}}),null),l(N,B(Ge,{get when(){return f()&&t.showResults!==!1},get children(){var G=g0();return l(G,B(Ge,{get when(){return s()},get children(){var ee=ST();return ee.firstChild,m(ee,U),l(ee,s,null),ee}}),null),l(G,B(Ge,{get when(){return c().length>0},get fallback(){return Te(()=>!!(r()&&!i()))()&&(()=>{var ee=g0();return m(ee,L),l(ee,()=>e("inventory.noProductsFound","No products found matching your search.")),ee})()},get children(){return B(Ht,{get each(){return c()},children:(ee,J)=>{const W=E(ee.id),q=W<=ee.minStockLevel;return(()=>{var ae=xT(),de=ae.firstChild,le=de.firstChild,V=le.firstChild,ce=V.nextSibling,Pe=ce.firstChild,fe=Pe.firstChild,be=Pe.nextSibling,xe=be.nextSibling,he=xe.nextSibling,ve=he.nextSibling,De=le.nextSibling,Ee=De.firstChild,Ce=Ee.firstChild,Ne=Ee.nextSibling;return ae.addEventListener("mouseenter",()=>p(J())),ae.$$click=()=>Q(ee),m(de,X),m(le,H),m(V,F),l(V,()=>ee.name),m(ce,ie),l(Pe,()=>e("inventory.sku","SKU"),fe),l(Pe,()=>ee.sku,null),l(xe,()=>ee.category),l(ve,()=>M(ee.unitCost)),m(De,$),Ee.style.setProperty("font-weight","600"),(q?"#f44336":"var(--text-primary)")!=null?Ee.style.setProperty("color",q?"#f44336":"var(--text-primary)"):Ee.style.removeProperty("color"),l(Ee,W,Ce),l(Ee,()=>ee.unitOfMeasure,null),Ne.style.setProperty("color","var(--text-muted)"),l(Ne,()=>q?(()=>{var Ie=AT();return Ie.firstChild,Ie.style.setProperty("color","#f44336"),l(Ie,()=>e("inventory.lowStock","Low Stock"),null),Ie})():e("inventory.inStock","In Stock")),Se(Ie=>m(ae,D(J()===v()),Ie)),ae})()}})}}),null),Se(ee=>m(G,O,ee)),G}}),null),Se(G=>{var ee=_,J=S,W=b,q=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),ae=t.disabled;return G.e=m(N,ee,G.e),G.t=m(z,J,G.t),G.a=m(oe,W,G.a),q!==G.o&&Yt(oe,"placeholder",G.o=q),ae!==G.i&&(oe.disabled=G.i=ae),G},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>oe.value=r()),N})()};ur(["input","keydown","click"]);var IT=ue("<div><div><h2></h2><div><div>"),$T=ue("<div><span>"),kT=ue("<span> "),ET=ue("<div><div><div><div><h3></h3><span></span></div><div></div><div>: </div></div><div><div></div><div>  <!>: </div><div>: "),TT=ue("<div><div>:</div><div>"),NT=ue("<div>: "),LT=ue("<div><div><span>:</span><select><option value=10>10</option><option value=20>20</option><option value=50>50</option><option value=100>100</option></select></div><div><div><span></span><input type=number min=1><span> </span></div></div><div>");const S5=()=>{const{t}=tr(),[e,r]=$e(""),[n,i]=$e(""),[o,s]=$e([]),[a,c]=$e(!1),[u,f]=$e(null),[y,v]=$e(!1),[p,I]=$e(!1),[P,w]=$e(!1),[x,j]=$e(null),[ne,Q]=$e(!1),[K,Z]=$e([]),[k,C]=$e(!1),[E,M]=$e(1),[_,S]=$e(20);Nn(async()=>{await b()});const b=async()=>{try{c(!0),f(null);try{const N=await wg.getAll();s(N.map(z=>({id:z.id||`prod-${Date.now()}-${Math.random()}`,name:z.productName||z.name||"Unknown Product",sku:z.sku||z.productCode||"",description:z.description||"",category:z.category||"General",unitOfMeasure:z.unitOfMeasure||"pcs",unitCost:parseFloat(z.unitCost||z.cost||"0"),sellingPrice:parseFloat(z.sellingPrice||z.price||"0"),minStockLevel:parseInt(z.minStockLevel||"0"),maxStockLevel:parseInt(z.maxStockLevel||"100"),isActive:z.isActive!==!1,createdDate:z.createdDate||new Date().toISOString(),lastModified:z.lastModified||new Date().toISOString(),businessId:z.businessId||"YB100423253156428"})))}catch(N){console.warn("API failed, using local store:",N),s(lt.products)}}catch(N){f(N instanceof Error?N.message:"Failed to load products")}finally{c(!1)}},Y=async()=>{try{c(!0),f(null);try{const N=await Ai.getProducts("prod"),z=Object.keys(N),oe=ee=>{let W=N[ee];return{id:W.id,name:W.name,businessId:W.businessId,sku:W.code,numCode:W.codeN,category:W.category,unitCost:W.unitCost||0,unitOfMeasure:W.unitOfMeasure,minStockLevel:W.minStockLevel,maxStockLevel:W.maxStockLevel,isActive:W.isActive,description:W.description||"",createdDate:W.createdAt||new Date().toISOString(),lastModified:W.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(W.sellingPrice||W.price||"0")}},G=z.map(oe);s(G)}catch(N){console.warn("API failed, using local store:",N),s(lt.products)}}catch(N){f(N instanceof Error?N.message:"Failed to load products")}finally{c(!1)}},{cancel:te}=iT(async N=>{if(!N.trim()){await b();return}try{f(null);const z=await wg.getAll(N);s(z.map(oe=>({id:oe.id||`prod-${Date.now()}-${Math.random()}`,name:oe.productName||oe.name||"Unknown Product",sku:oe.sku||oe.productCode||"",description:oe.description||"",category:oe.category||"General",unitOfMeasure:oe.unitOfMeasure||"pcs",unitCost:parseFloat(oe.unitCost||oe.cost||"0"),sellingPrice:parseFloat(oe.sellingPrice||oe.price||"0"),minStockLevel:parseInt(oe.minStockLevel||"0"),maxStockLevel:parseInt(oe.maxStockLevel||"100"),isActive:oe.isActive!==!1,createdDate:oe.createdDate||new Date().toISOString(),lastModified:oe.lastModified||new Date().toISOString(),businessId:oe.businessId||"YB100423253156428"})))}catch(z){f(z instanceof Error?z.message:"Search failed");const oe=lt.products.filter(G=>G.name.toLowerCase().includes(N.toLowerCase())||G.sku.toLowerCase().includes(N.toLowerCase())||G.category.toLowerCase().includes(N.toLowerCase()));s(oe)}},300);Pc(()=>{te()}),Nt(()=>{let N=o();return n()&&(N=N.filter(z=>z.category===n())),N}),Nt(()=>[...new Set(o().map(z=>z.category))].sort()),Nt(()=>{const N=o().filter(G=>G.isActive),z=o().length,oe=o().filter(G=>lt.getTotalStockByProduct(G.id)===0);return{total:z,active:N.length,outOfStock:oe.length}});const O=N=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(N),D={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},X={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},H=N=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:N?"#ffebee":"#e8f5e8",color:N?"#d32f2f":"#2d7d32"});Nt(()=>{const N=lt.products||[],z=lt.movements||[],oe=lt.stockLevels||[],G=lt.getLowStockProducts(),ee=N?.length||0,J=N?.filter(ae=>ae.isActive).length,W=oe.reduce((ae,de)=>ae*1+de.quantity*1*de.averageCost*1,0),q=z?.filter(ae=>{const de=new Date(ae.createdDate),le=new Date;return de.getMonth()===le.getMonth()&&de.getFullYear()===le.getFullYear()}).length;return{totalProducts:ee,activeProducts:J,lowStockProducts:G.length,totalStockValue:W,totalMovementsThisMonth:q,totalLocations:lt.locations.length,activeLocations:lt.getActiveLocations().length}});const F=Nt(()=>lt.products.map(N=>{const z=lt.getStockByProduct(N.id),oe=lt.getTotalStockByProduct(N.id),G=lt.getLastLocationByProduct(N.id);return{...N,totalStock:oe,stockByLocation:z,lastLocation:G,isLowStock:oe<=N.minStockLevel}})),ie=Nt(()=>K().map(N=>{const z=lt.getStockByProduct(N.id),oe=lt.getTotalStockByProduct(N.id),G=lt.getLastLocationByProduct(N.id);return{...N,totalStock:oe,stockByLocation:z,lastLocation:G,isLowStock:oe<=N.minStockLevel}})),$=Nt(()=>{const N=k()?ie():F(),z=(E()-1)*_(),oe=z+_();return N.slice(z,oe)}),L=Nt(()=>{const N=k()?ie():F();return Math.ceil(N.length/_())}),U=N=>{j(N),I(!0)};return B(ro,{get title(){return t("products.title","Products")},get children(){return[(()=>{var N=IT(),z=N.firstChild,oe=z.firstChild,G=oe.nextSibling,ee=G.firstChild;return N.style.setProperty("display","flex"),N.style.setProperty("justify-content","space-between"),N.style.setProperty("align-items","flex-start"),N.style.setProperty("margin-bottom","1.5rem"),N.style.setProperty("flex-wrap","wrap"),N.style.setProperty("gap","1rem"),z.style.setProperty("flex","1"),z.style.setProperty("min-width","300px"),oe.style.setProperty("margin","0 0 1rem 0"),oe.style.setProperty("font-size","1.5rem"),l(oe,()=>t("inventory.products")),G.style.setProperty("display","flex"),G.style.setProperty("gap","1rem"),G.style.setProperty("align-items","center"),G.style.setProperty("flex-wrap","wrap"),ee.style.setProperty("flex","1"),ee.style.setProperty("min-width","250px"),l(ee,B(CT,{onSearchResults:J=>{Z(J),C(J.length>0)},get placeholder(){return t("inventory.searchProductsStock","Search products and check stock levels...")},showResults:!1,maxResults:20})),l(G,B(Pt,{variant:"outline",onClick:()=>{Y(),C(!1)},get children(){return[" ",Te(()=>t("common.showAll","Show All"))]}}),null),l(N,B(Ge,{get when(){return Ar.hasPermission("read_write")},get children(){return B(Pt,{variant:"primary",onClick:()=>Q(!0),get children(){return[" ",Te(()=>t("inventory.addProduct"))]}})}}),null),N})(),(()=>{var N=$T(),z=N.firstChild;return N.style.setProperty("margin-bottom","1rem"),N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),N.style.setProperty("display","flex"),N.style.setProperty("justify-content","space-between"),N.style.setProperty("align-items","center"),l(z,(()=>{var oe=Te(()=>!!k());return()=>oe()?`${t("inventory.searchResults","Search Results")}: ${ie().length} ${t("common.products","products")}`:`${t("inventory.totalProducts","Total Products")}: ${F().length} ${t("common.products","products")}`})()),l(N,(()=>{var oe=Te(()=>!!k());return()=>oe()&&(()=>{var G=kT();return G.firstChild,G.style.setProperty("color","var(--primary-color)"),l(G,()=>t("inventory.filtered","Filtered view"),null),G})()})(),null),N})(),B(Ht,{get each(){return $()},children:N=>(()=>{var z=ET(),oe=z.firstChild,G=oe.firstChild,ee=G.firstChild,J=ee.firstChild,W=J.nextSibling,q=ee.nextSibling,ae=q.nextSibling,de=ae.firstChild,le=G.nextSibling,V=le.firstChild,ce=V.nextSibling,Pe=ce.firstChild,fe=Pe.nextSibling;fe.nextSibling;var be=ce.nextSibling,xe=be.firstChild;return z.$$click=()=>U(N),z.addEventListener("mouseleave",he=>{he.currentTarget.style.transform="translateY(0)",he.currentTarget.style.boxShadow="none"}),z.addEventListener("mouseenter",he=>{he.currentTarget.style.transform="translateY(-2px)",he.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),m(z,D),m(oe,X),ee.style.setProperty("display","flex"),ee.style.setProperty("align-items","center"),ee.style.setProperty("gap","0.5rem"),ee.style.setProperty("margin-bottom","0.5rem"),J.style.setProperty("margin","0"),J.style.setProperty("font-size","1.1rem"),l(J,()=>N.name),l(W,(()=>{var he=Te(()=>!!N.isLowStock);return()=>he()?t("inventory.lowStockAlert"):t("inventory.inStock")})()),q.style.setProperty("font-size","0.875rem"),q.style.setProperty("color","var(--text-muted)"),l(q,()=>N.sku,null),l(q,()=>N.UPC?"  "+N.UPC:"",null),l(q,()=>N.category?"  "+N.category:"",null),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),l(ae,()=>t("inventory.lastSeen"),de),l(ae,()=>N.lastLocation?.name||t("inventory.noMovements"),null),le.style.setProperty("text-align","right"),V.style.setProperty("font-size","1.25rem"),V.style.setProperty("font-weight","700"),V.style.setProperty("color","var(--primary-color)"),l(V,()=>N.totalStock),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("color","var(--text-muted)"),l(ce,()=>N.unitOfMeasure,Pe),l(ce,()=>t("inventory.min"),fe),l(ce,()=>N.minStockLevel,null),be.style.setProperty("font-size","0.875rem"),be.style.setProperty("color","var(--text-muted)"),l(be,()=>t("inventory.cost"),xe),l(be,()=>O(N.unitCost),null),l(z,(()=>{var he=Te(()=>N?.stockByLocation?.length>0);return()=>he()&&(()=>{var ve=TT(),De=ve.firstChild,Ee=De.firstChild,Ce=De.nextSibling;return ve.style.setProperty("margin-top","1rem"),De.style.setProperty("font-weight","500"),De.style.setProperty("margin-bottom","0.5rem"),De.style.setProperty("font-size","0.875rem"),l(De,()=>t("inventory.stockByLocation"),Ee),Ce.style.setProperty("display","flex"),Ce.style.setProperty("flex-wrap","wrap"),Ce.style.setProperty("gap","0.5rem"),l(Ce,B(Ht,{get each(){return N.stockByLocation},children:Ne=>{const Ie=lt.getLocationById(Ne.locationId);return(()=>{var Re=NT(),We=Re.firstChild;return Re.style.setProperty("padding","0.25rem 0.5rem"),Re.style.setProperty("background","var(--background-color)"),Re.style.setProperty("border-radius","var(--border-radius-sm)"),Re.style.setProperty("font-size","0.75rem"),Re.style.setProperty("border","1px solid var(--border-color)"),l(Re,()=>Ie?.name,We),l(Re,()=>Ne.quantity,null),Re})()}})),ve})()})(),null),Se(he=>m(W,H(N.isLowStock),he)),z})()}),Te(()=>Te(()=>L()>1)()&&(()=>{var N=LT(),z=N.firstChild,oe=z.firstChild,G=oe.firstChild,ee=oe.nextSibling,J=z.nextSibling,W=J.firstChild,q=W.firstChild,ae=q.nextSibling,de=ae.nextSibling,le=de.firstChild,V=J.nextSibling;return N.style.setProperty("display","flex"),N.style.setProperty("justify-content","space-between"),N.style.setProperty("align-items","center"),N.style.setProperty("margin-top","2rem"),N.style.setProperty("padding","1rem"),N.style.setProperty("background","var(--surface-color)"),N.style.setProperty("border-radius","var(--border-radius)"),N.style.setProperty("border","1px solid var(--border-color)"),z.style.setProperty("display","flex"),z.style.setProperty("align-items","center"),z.style.setProperty("gap","0.5rem"),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),l(oe,()=>t("common.showPerPage","Show per page"),G),ee.addEventListener("change",ce=>{S(parseInt(ce.target.value)),M(1)}),ee.style.setProperty("padding","0.25rem 0.5rem"),ee.style.setProperty("border","1px solid var(--border-color)"),ee.style.setProperty("border-radius","var(--border-radius-sm)"),ee.style.setProperty("background","var(--background-color)"),ee.style.setProperty("cursor","pointer"),J.style.setProperty("display","flex"),J.style.setProperty("align-items","center"),J.style.setProperty("gap","0.5rem"),l(J,B(Pt,{variant:"outline",size:"sm",onClick:()=>M(1),get disabled(){return E()===1},get children(){return t("common.first","First")}}),W),l(J,B(Pt,{variant:"outline",size:"sm",onClick:()=>M(ce=>Math.max(1,ce-1)),get disabled(){return E()===1},get children(){return t("common.previous","Previous")}}),W),W.style.setProperty("display","flex"),W.style.setProperty("align-items","center"),W.style.setProperty("gap","0.25rem"),q.style.setProperty("font-size","0.875rem"),l(q,()=>t("common.page","Page")),ae.addEventListener("change",ce=>{const Pe=parseInt(ce.target.value);Pe>=1&&Pe<=L()&&M(Pe)}),ae.style.setProperty("width","60px"),ae.style.setProperty("padding","0.25rem 0.5rem"),ae.style.setProperty("border","1px solid var(--border-color)"),ae.style.setProperty("border-radius","var(--border-radius-sm)"),ae.style.setProperty("text-align","center"),ae.style.setProperty("font-size","0.875rem"),de.style.setProperty("font-size","0.875rem"),l(de,()=>t("common.of","of"),le),l(de,L,null),l(J,B(Pt,{variant:"outline",size:"sm",onClick:()=>M(ce=>Math.min(L(),ce+1)),get disabled(){return E()===L()},get children(){return t("common.next","Next")}}),null),l(J,B(Pt,{variant:"outline",size:"sm",onClick:()=>M(L()),get disabled(){return E()===L()},get children(){return t("common.last","Last")}}),null),V.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","var(--text-muted)"),l(V,()=>{const ce=k()?ie():F(),Pe=(E()-1)*_()+1,fe=Math.min(E()*_(),ce.length);return t("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:Pe,end:fe,total:ce.length})}),Se(()=>Yt(ae,"max",L())),Se(()=>ee.value=_()),Se(()=>ae.value=E()),N})()),B(Ny,{get isOpen(){return y()},onClose:()=>v(!1),onProductAdded:()=>{b()}}),B(bT,{get isOpen(){return p()},onClose:()=>{I(!1),j(null)},get product(){return x()},onEdit:()=>{I(!1),w(!0)}})]}})};ur(["click"]);var DT=ue("<div><div></div><div>"),RT=ue("<div><div><img></div><div>X</div><div><div><h2></h2><div></div></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),MT=ue("<div>"),FT=ue("<div><div></div><h3></h3><p>"),OT=ue("<div><div>"),BT=ue("<div>"),jT=ue("<div><div><img loading=lazy></div><div><div></div><div>  </div><div></div><div>",!0,!1,!1);const VT=t=>{const{t:e}=tr(),[r,n]=$e(null),[i,o]=$e([]),[s,a]=$e(!1),c=D=>{n(D),t.onProductSelect?.(D)},u=()=>{n(null),t.onProductSelect?.(null),o([]),a(!1)},f=D=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(D),y=()=>"YABABYSSolution",v=()=>"https://qvamarkets.s3.us-east-2.amazonaws.com/V2_images/7258/",p=D=>{if(D.productImageUrl)return v()+y()+"/"+D?.productImageUrl;const X={Electronics:"https://via.placeholder.com/400x300/4F46E5/FFFFFF?text=Electronics",Furniture:"https://via.placeholder.com/400x300/059669/FFFFFF?text=Furniture",Food:"https://via.placeholder.com/400x300/DC2626/FFFFFF?text=Food",Clothing:"https://via.placeholder.com/400x300/7C3AED/FFFFFF?text=Clothing",Tools:"https://via.placeholder.com/400x300/EA580C/FFFFFF?text=Tools",General:"https://via.placeholder.com/400x300/6B7280/FFFFFF?text=Product"};return X[D.category]||X.General},I={padding:"2rem"},P={"max-width":"600px",margin:"0 auto 2rem",position:"relative"},w={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},x={background:"var(--surface-color)","border-radius":"var(--border-radius)",overflow:"hidden","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.3s ease"},j={position:"relative",width:"100%",height:"200px",overflow:"hidden",background:"#f5f5f5"},ne={width:"100%",height:"100%","object-fit":"cover",transition:"transform 0.3s ease"},Q={padding:"1rem"},K={"font-size":"1rem","font-weight":"600","margin-bottom":"0.5rem",color:"var(--text-primary)",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},Z={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.25rem"},k={"font-size":"1.25rem","font-weight":"700",color:"var(--primary-color)","margin-top":"0.5rem"},C={display:"flex",gap:"2rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"2rem","box-shadow":"var(--shadow-md)","margin-bottom":"2rem",position:"relative"},E={width:"400px",height:"300px","border-radius":"var(--border-radius)",overflow:"hidden",background:"#f5f5f5"},M={flex:"1",display:"flex","flex-direction":"column",gap:"1rem"},_={display:"flex","justify-content":"space-between","padding-bottom":"0.5rem","border-bottom":"1px solid var(--border-light)"},S={"font-weight":"500",color:"var(--text-muted)"},b={"font-weight":"600",color:"var(--text-primary)"},Y=D=>({display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600",background:"#d4edda",color:"#155724"}),te={"text-align":"center",padding:"4rem 2rem",color:"var(--text-muted)"},O={"font-size":"3rem","margin-bottom":"1rem",opacity:"0.5"};return(()=>{var D=OT(),X=D.firstChild;return m(D,I),l(X,B(cf,{onChange:H=>{console.log(H);let F=H;a(!0),c(F)},get placeholder(){return e("inventory.searchProductsImages","Search products to view images...")}})),l(D,B(Ge,{get when(){return r()&&t.showDetails!==!1},get children(){var H=RT(),F=H.firstChild,ie=F.firstChild,$=F.nextSibling,L=$.nextSibling,U=L.firstChild,N=U.firstChild,z=N.nextSibling,oe=U.nextSibling,G=oe.firstChild,ee=G.nextSibling,J=oe.nextSibling,W=J.firstChild,q=W.nextSibling,ae=J.nextSibling,de=ae.firstChild,le=de.nextSibling,V=ae.nextSibling,ce=V.firstChild,Pe=ce.nextSibling,fe=V.nextSibling,be=fe.firstChild,xe=be.nextSibling;return m(H,C),m(F,E),ie.style.setProperty("width","100%"),ie.style.setProperty("height","100%"),ie.style.setProperty("object-fit","contain"),ie.style.setProperty("aspect-ratio","1 / 1"),$.$$click=()=>{u()},$.style.setProperty("position","absolute"),$.style.setProperty("top","0.5rem"),$.style.setProperty("right","0.5rem"),$.style.setProperty("color","#3d3d3d"),$.style.setProperty("border-radius","50%"),$.style.setProperty("width","2rem"),$.style.setProperty("height","2rem"),$.style.setProperty("display","flex"),$.style.setProperty("align-items","center"),$.style.setProperty("justify-content","center"),$.style.setProperty("font-size","1.25rem"),$.style.setProperty("box-shadow","var(--shadow-sm)"),$.style.setProperty("cursor","pointer"),m(L,M),N.style.setProperty("margin","0 0 0.5rem 0"),N.style.setProperty("font-size","1.5rem"),l(N,()=>r().name),l(z,()=>e("products.inStock","In Stock")),l(G,()=>e("products.sku","SKU")),l(ee,()=>r().sku),l(W,()=>e("inventory.category","Category")),l(q,()=>r().category),l(de,()=>e("inventory.unitOfMeasure","Unit")),l(le,()=>r().unitOfMeasure),l(ce,()=>e("inventory.unitCost","Cost")),l(Pe,()=>f(r().unitCost)),l(be,()=>e("inventory.UPC","UPC")),l(xe,()=>r().UPC),l(L,B(Ge,{get when(){return r().description},get children(){var he=DT(),ve=he.firstChild,De=ve.nextSibling;return he.style.setProperty("margin-top","1rem"),l(ve,()=>e("common.description","Description")),De.style.setProperty("margin-top","0.5rem"),De.style.setProperty("color","var(--text-primary)"),l(De,()=>r().description),Se(Ee=>m(ve,S,Ee)),he}}),null),Se(he=>{var ve=p(r()),De=r().name,Ee=Y(),Ce=_,Ne=S,Ie=b,Re=_,We=S,Fe=b,Xe=_,tt=S,At=b,rt=_,He=S,xt=b,_t=_,mt=S,Et=b;return ve!==he.e&&Yt(ie,"src",he.e=ve),De!==he.t&&Yt(ie,"alt",he.t=De),he.a=m(z,Ee,he.a),he.o=m(oe,Ce,he.o),he.i=m(G,Ne,he.i),he.n=m(ee,Ie,he.n),he.s=m(J,Re,he.s),he.h=m(W,We,he.h),he.r=m(q,Fe,he.r),he.d=m(ae,Xe,he.d),he.l=m(de,tt,he.l),he.u=m(le,At,he.u),he.c=m(V,rt,he.c),he.w=m(ce,He,he.w),he.m=m(Pe,xt,he.m),he.f=m(fe,_t,he.f),he.y=m(be,mt,he.y),he.g=m(xe,Et,he.g),he},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),H}}),null),l(D,B(Ge,{get when(){return i().length>0},get children(){var H=MT();return m(H,w),l(H,B(Ht,{get each(){return i()},children:F=>(()=>{var ie=jT(),$=ie.firstChild,L=$.firstChild,U=$.nextSibling,N=U.firstChild,z=N.nextSibling,oe=z.firstChild,G=z.nextSibling,ee=G.nextSibling;return ie.addEventListener("mouseleave",J=>{J.currentTarget.style.transform="translateY(0)",J.currentTarget.style.boxShadow="var(--shadow-sm)";const W=J.currentTarget.querySelector("img");W&&(W.style.transform="scale(1)")}),ie.addEventListener("mouseenter",J=>{J.currentTarget.style.transform="translateY(-4px)",J.currentTarget.style.boxShadow="var(--shadow-lg)";const W=J.currentTarget.querySelector("img");W&&(W.style.transform="scale(1.05)")}),ie.$$click=()=>c(F),m(ie,x),l($,B(Ge,{get when(){return F===r()},get children(){var J=BT();return J.style.setProperty("position","absolute"),J.style.setProperty("top","0.5rem"),J.style.setProperty("right","0.5rem"),J.style.setProperty("background","var(--primary-color)"),J.style.setProperty("color","white"),J.style.setProperty("border-radius","50%"),J.style.setProperty("width","2rem"),J.style.setProperty("height","2rem"),J.style.setProperty("display","flex"),J.style.setProperty("align-items","center"),J.style.setProperty("justify-content","center"),J.style.setProperty("font-size","1.25rem"),J}}),null),m(U,Q),l(N,()=>F.name),l(z,()=>F.sku,oe),l(z,()=>F.category,null),l(G,()=>F.unitOfMeasure),m(ee,k),l(ee,()=>f(F.sellingPrice)),Se(J=>{var W=j,q=p(F),ae=F.name,de=ne,le=K,V=F.name,ce=Z,Pe=Z;return J.e=m($,W,J.e),q!==J.t&&Yt(L,"src",J.t=q),ae!==J.a&&Yt(L,"alt",J.a=ae),J.o=m(L,de,J.o),J.i=m(N,le,J.i),V!==J.n&&Yt(N,"title",J.n=V),J.s=m(z,ce,J.s),J.h=m(G,Pe,J.h),J},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),ie})()})),H}}),null),l(D,B(Ge,{get when(){return!r()},get children(){var H=FT(),F=H.firstChild,ie=F.nextSibling,$=ie.nextSibling;return m(F,O),ie.style.setProperty("margin-bottom","0.5rem"),l(ie,()=>e("inventory.noProductsFound","No Products Found")),l($,()=>e("inventory.tryDifferentSearch","Try a different search term")),Se(L=>m(H,te,L)),H}}),null),Se(H=>m(X,P,H)),D})()};ur(["click"]);var zT=ue("<div><div></div><div></div><div>"),v0=ue("<div>"),qT=ue("<div><div><div><h2> - </h2><button></button></div><div>"),UT=ue("<div><div><div><div><h3></h3><span></span></div><div></div></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const HT=t=>{const{t:e}=tr(),[r,n]=$e(""),[i,o]=$e(!1),s=Nt(()=>{const I=lt.movements,P=new Map;return I.forEach(w=>{const x=w.referenceNumber||w.invoiceId||w.ssg_inventory_key||"UNKNOWN";P.has(x)||P.set(x,{referenceNumber:x,movements:[],totalItems:0,totalValue:0,createdDate:w.createdDate,movementType:w.movementType});const j=P.get(x);j.movements.push(w),j.totalItems+=w.quantity,j.totalValue+=w.totalCost,new Date(w.createdDate)<new Date(j.createdDate)&&(j.createdDate=w.createdDate)}),Array.from(P.values()).filter(w=>w.movements.length>1).sort((w,x)=>new Date(x.createdDate).getTime()-new Date(w.createdDate).getTime())}),a=Nt(()=>{const I=s().find(P=>P.referenceNumber===r());return I?I.movements:[]}),c=I=>{n(I),o(!0)},u=()=>{o(!1),n("")},f=I=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(I),y=I=>new Date(I).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),v=I=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[I]||I,p=I=>({in:"#4caf50",out:"#f44336",transfer:"#2196f3",adjustment:"#ff9800"})[I]||"#666";return[B(Qn,{get isOpen(){return Te(()=>!!t.isOpen)()&&!i()},get onClose(){return t.onClose},get title(){return e("inventory.viewHistoricalReports")},size:"large",get children(){var I=v0();return I.style.setProperty("max-height","70vh"),I.style.setProperty("overflow-y","auto"),l(I,B(Ge,{get when(){return s().length===0},get children(){var P=zT(),w=P.firstChild,x=w.nextSibling,j=x.nextSibling;return P.style.setProperty("text-align","center"),P.style.setProperty("padding","3rem"),P.style.setProperty("color","var(--text-muted)"),w.style.setProperty("font-size","2rem"),w.style.setProperty("margin-bottom","1rem"),x.style.setProperty("font-size","1.1rem"),x.style.setProperty("margin-bottom","0.5rem"),l(x,()=>e("inventory.noBulkReportsFound","No bulk movement reports found")),j.style.setProperty("font-size","0.9rem"),l(j,()=>e("inventory.bulkReportsAppearHere","Bulk movement reports will appear here after you create bulk movements")),P}}),null),l(I,B(Ge,{get when(){return s().length>0},get children(){var P=v0();return P.style.setProperty("display","grid"),P.style.setProperty("gap","1rem"),l(P,B(Ht,{get each(){return s()},children:w=>(()=>{var x=UT(),j=x.firstChild,ne=j.firstChild,Q=ne.firstChild,K=Q.firstChild,Z=K.nextSibling,k=Q.nextSibling,C=j.nextSibling,E=C.firstChild,M=E.firstChild,_=M.nextSibling,S=E.nextSibling,b=S.firstChild,Y=b.nextSibling,te=S.nextSibling,O=te.firstChild,D=O.nextSibling;return x.style.setProperty("padding","1.5rem"),x.style.setProperty("border","1px solid var(--border-color)"),x.style.setProperty("border-radius","var(--border-radius)"),x.style.setProperty("background","var(--surface-color)"),x.style.setProperty("transition","all 0.2s ease"),j.style.setProperty("display","flex"),j.style.setProperty("justify-content","space-between"),j.style.setProperty("align-items","flex-start"),j.style.setProperty("margin-bottom","1rem"),ne.style.setProperty("flex","1"),Q.style.setProperty("display","flex"),Q.style.setProperty("align-items","center"),Q.style.setProperty("gap","1rem"),Q.style.setProperty("margin-bottom","0.5rem"),K.style.setProperty("margin","0"),K.style.setProperty("font-size","1.1rem"),K.style.setProperty("color","var(--text-primary)"),l(K,()=>w.referenceNumber),Z.style.setProperty("padding","0.25rem 0.75rem"),Z.style.setProperty("border-radius","1rem"),Z.style.setProperty("font-size","0.75rem"),Z.style.setProperty("font-weight","500"),l(Z,()=>v(w.movementType)),k.style.setProperty("color","var(--text-muted)"),k.style.setProperty("font-size","0.875rem"),l(k,()=>y(w.createdDate)),l(j,B(Pt,{variant:"outline",size:"sm",onClick:()=>c(w.referenceNumber),get children(){return e("common.view")}}),null),C.style.setProperty("display","grid"),C.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),C.style.setProperty("gap","1rem"),C.style.setProperty("margin-bottom","1rem"),M.style.setProperty("font-size","0.75rem"),M.style.setProperty("font-weight","500"),M.style.setProperty("text-transform","uppercase"),M.style.setProperty("color","var(--text-muted)"),M.style.setProperty("margin-bottom","0.25rem"),l(M,()=>e("inventory.totalProducts")),_.style.setProperty("font-size","1.25rem"),_.style.setProperty("font-weight","600"),_.style.setProperty("color","var(--primary-color)"),l(_,()=>w.movements.length),b.style.setProperty("font-size","0.75rem"),b.style.setProperty("font-weight","500"),b.style.setProperty("text-transform","uppercase"),b.style.setProperty("color","var(--text-muted)"),b.style.setProperty("margin-bottom","0.25rem"),l(b,()=>e("inventory.totalItems")),Y.style.setProperty("font-size","1.25rem"),Y.style.setProperty("font-weight","600"),Y.style.setProperty("color","var(--primary-color)"),l(Y,()=>w.totalItems),O.style.setProperty("font-size","0.75rem"),O.style.setProperty("font-weight","500"),O.style.setProperty("text-transform","uppercase"),O.style.setProperty("color","var(--text-muted)"),O.style.setProperty("margin-bottom","0.25rem"),l(O,()=>e("inventory.estimatedValue")),D.style.setProperty("font-size","1.25rem"),D.style.setProperty("font-weight","600"),D.style.setProperty("color","var(--primary-color)"),l(D,()=>f(w.totalValue)),Se(X=>{var H=p(w.movementType)+"20",F=p(w.movementType);return H!==X.e&&((X.e=H)!=null?Z.style.setProperty("background",H):Z.style.removeProperty("background")),F!==X.t&&((X.t=F)!=null?Z.style.setProperty("color",F):Z.style.removeProperty("color")),X},{e:void 0,t:void 0}),x})()})),P}}),null),I}}),B(Ge,{get when(){return i()},get children(){var I=qT(),P=I.firstChild,w=P.firstChild,x=w.firstChild,j=x.firstChild,ne=x.nextSibling,Q=w.nextSibling;return I.style.setProperty("position","fixed"),I.style.setProperty("top","0"),I.style.setProperty("left","0"),I.style.setProperty("right","0"),I.style.setProperty("bottom","0"),I.style.setProperty("background","rgba(0, 0, 0, 0.5)"),I.style.setProperty("z-index","1000"),I.style.setProperty("display","flex"),I.style.setProperty("align-items","center"),I.style.setProperty("justify-content","center"),I.style.setProperty("padding","2rem"),P.style.setProperty("background","white"),P.style.setProperty("border-radius","var(--border-radius)"),P.style.setProperty("width","95%"),P.style.setProperty("max-width","1200px"),P.style.setProperty("max-height","90vh"),P.style.setProperty("overflow-y","auto"),P.style.setProperty("position","relative"),w.style.setProperty("padding","1rem 2rem"),w.style.setProperty("border-bottom","1px solid #e9ecef"),w.style.setProperty("display","flex"),w.style.setProperty("justify-content","space-between"),w.style.setProperty("align-items","center"),w.style.setProperty("background","#f8f9fa"),x.style.setProperty("margin","0"),l(x,()=>e("inventory.bulkMovementReport"),j),l(x,r,null),ne.$$click=u,ne.style.setProperty("background","none"),ne.style.setProperty("border","none"),ne.style.setProperty("font-size","1.5rem"),ne.style.setProperty("cursor","pointer"),ne.style.setProperty("padding","0.5rem"),ne.style.setProperty("line-height","1"),Q.style.setProperty("padding","1rem"),l(Q,B(w5,{get movements(){return a()},onClose:u})),I}})]};ur(["click"]);var WT=ue("<div><h1></h1><div>"),Ti=ue("<div>"),GT=ue("<div><h3></h3><div>"),YT=ue("<div>: <!> "),KT=ue("<div><button></button><button></button><button></button><button>"),JT=ue("<div><div>"),QT=ue("<div><span> (<!>)</span><span> / <!> "),XT=ue("<div><div><h2></h2></div><div>"),ZT=ue("<div><div><div><span></span><h3></h3></div><div>  </div><div></div></div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div>:"),e6=ue("<div><div><div><div></div><div></div></div><div><div> </div><div></div><div>Min: "),t6=ue("<span> LOW");const r6=()=>{const{t}=tr(),[e,r]=$e(!1),[n,i]=$e(!1),[o,s]=$e(!1),[a,c]=$e(null),[u,f]=$e("overview"),[y,v]=$e("new"),[p,I]=$e([]),[P,w]=$e(!1),[x,j]=$e(!1),[ne,Q]=$e(!1),[K,Z]=$e(!1),[k,C]=$e(1),E=G=>{c(G),s(!0)},M=Nt(()=>{const G=lt.products||[],ee=lt.movements||[],J=lt.stockLevels||[],W=lt.getLowStockProducts(),q=G?.length||0,ae=G?.filter(V=>V.isActive).length,de=J.reduce((V,ce)=>V*1+ce.quantity*1*ce.averageCost*1,0),le=ee?.filter(V=>{const ce=new Date(V.createdDate),Pe=new Date;return ce.getMonth()===Pe.getMonth()&&ce.getFullYear()===Pe.getFullYear()}).length;return{totalProducts:q,activeProducts:ae,lowStockProducts:W.length,totalStockValue:de,totalMovementsThisMonth:le,totalLocations:lt.locations.length,activeLocations:lt.getActiveLocations().length}});Nt(()=>lt.products.map(G=>{const ee=lt.getStockByProduct(G.id),J=lt.getTotalStockByProduct(G.id),W=lt.getLastLocationByProduct(G.id);return{...G,totalStock:J,stockByLocation:ee,lastLocation:W,isLowStock:J<=G.minStockLevel}})),Nt(()=>{P(),C(1)});const _=(G,ee)=>G<=ee?t("inventory.lowStockAlert"):G<=ee*2?t("inventory.normalStock"):t("inventory.inStock"),S=G=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(G),b=G=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(G),Y=G=>{switch(G){case"warehouse":return t("inventory.warehouse");case"store":return t("inventory.store");case"supplier":return t("inventory.supplier");case"customer":return t("inventory.customer");default:return G}},te={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},O={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},D=G=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500",background:G>50?"#d4edda":G>20?"#fff3cd":"#f8d7da",color:G>50?"#155724":G>20?"#856404":"#721c24"}),X={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},H={color:"var(--text-muted)","font-size":"0.875rem"},F={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},ie={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},$={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},L=G=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:G?"var(--primary-color)":"var(--text-muted)","border-bottom":G?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),U={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem","margin-bottom":"2rem"},N={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},z=Nt(()=>{const G=lt.movements;return{total:G.length,stockIn:G.filter(ee=>ee.movementType==="in").length,stockOut:G.filter(ee=>ee.movementType==="out").length,transfers:G.filter(ee=>ee.movementType==="transfer").length,adjustments:G.filter(ee=>ee.movementType==="adjustment").length,totalValue:G.reduce((ee,J)=>ee+J.totalCost,0)}}),oe=async()=>{let G=Ar.state?.profile?.businessId;setTimeout(async()=>{await lt.getStockLevels("YY_")},2300),Rm.calcStockLevels(),await lt.fecthProduct(G),await lt.fecthInventory(G)};return Nn(()=>{oe()}),B(ro,{get title(){return t("inventory.title")},get children(){return[(()=>{var G=WT(),ee=G.firstChild,J=ee.nextSibling;return m(G,ie),ee.style.setProperty("margin","0"),ee.style.setProperty("font-size","1.75rem"),J.style.setProperty("display","flex"),J.style.setProperty("align-items","center"),J.style.setProperty("gap","1rem"),l(J,(()=>{var W=Te(()=>y()==="new");return()=>W()&&B(Pt,{variant:"outline",onClick:()=>Q(!0),get children(){return[" ",Te(()=>t("inventory.physicalCount","Physical Count"))]}})})(),null),l(J,B(Ge,{get when(){return Ar.hasPermission("read_write")},get children(){return[B(Pt,{variant:"outline",onClick:()=>Z(!0),get children(){return[" ",Te(()=>t("inventory.viewHistoricalReports"))]}}),B(Pt,{variant:"primary",onClick:()=>i(!0),get children(){return Te(()=>y()==="new")()?t("inventory.addMovement"):t("common.add")}})]}}),null),G})(),B(VT,{}),B(Ge,{get when(){return Ar.hasPermission("inventoryDownsection")},get children(){return Te(()=>y()==="legacy")()?[(()=>{var G=Ti();return l(G,B(Tt,{get title(){return t("inventory.totalItems")},get subtitle(){return t("inventory.inStock")},get children(){var ee=Ti();return ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","var(--primary-color)"),l(ee,()=>lt.inventory.length),ee}}),null),l(G,B(Tt,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.itemsBelowThreshold")},get children(){var ee=Ti();return ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","var(--primary-color)"),l(ee,()=>lt.getLowStockItems().length),ee}}),null),l(G,B(Tt,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.inventoryWorth")},get children(){var ee=Ti();return ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","var(--primary-color)"),l(ee,()=>S(lt.getTotalValue())),ee}}),null),Se(ee=>m(G,F,ee)),G})(),(()=>{var G=Ti();return m(G,te),l(G,B(Ht,{get each(){return lt.inventory},children:ee=>{const J=_(ee.quantity,ee.minStock),W=ee.quantity<=ee.minStock?8:ee.quantity<=ee.minStock*2?35:75;return B(Tt,{onClick:()=>E(ee),get children(){return[(()=>{var q=GT(),ae=q.firstChild,de=ae.nextSibling;return m(q,O),ae.style.setProperty("margin","0"),ae.style.setProperty("font-size","1.1rem"),l(ae,()=>ee.name),l(de,J),Se(le=>m(de,D(W),le)),q})(),(()=>{var q=Ti();return m(q,X),l(q,()=>S(ee.price)),q})(),(()=>{var q=YT(),ae=q.firstChild,de=ae.nextSibling;return de.nextSibling,m(q,H),l(q,()=>t("inventory.quantity"),ae),l(q,()=>ee.quantity,de),l(q,()=>t("common.units"),null),q})()]}})}})),G})()]:[(()=>{var G=KT(),ee=G.firstChild,J=ee.nextSibling,W=J.nextSibling,q=W.nextSibling;return m(G,$),ee.$$click=()=>f("overview"),l(ee,()=>t("inventory.overview")),J.$$click=()=>f("products"),l(J,()=>t("inventory.products")),W.$$click=()=>f("movements"),l(W,()=>t("inventory.movements")),q.$$click=()=>f("locations"),l(q,()=>t("inventory.locations")),Se(ae=>{var de=L(u()==="overview"),le=L(u()==="products"),V=L(u()==="movements"),ce=L(u()==="locations");return ae.e=m(ee,de,ae.e),ae.t=m(J,le,ae.t),ae.a=m(W,V,ae.a),ae.o=m(q,ce,ae.o),ae},{e:void 0,t:void 0,a:void 0,o:void 0}),G})(),Te(()=>Te(()=>u()==="overview")()&&(()=>{var G=JT(),ee=G.firstChild;return l(ee,B(Tt,{get title(){return t("inventory.activeProducts")},get subtitle(){return t("inventory.currentlyManaged")},get children(){var J=Ti();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","var(--primary-color)"),l(J,()=>M().activeProducts),J}}),null),l(ee,B(Tt,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.needAttention")},get children(){var J=Ti();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","#d32f2f"),l(J,()=>M().lowStockProducts),J}}),null),l(ee,B(Tt,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.currentWorth")},get children(){var J=Ti();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","var(--primary-color)"),l(J,()=>b(z().totalValue)),J}}),null),l(ee,B(Tt,{get title(){return t("inventory.movements")},get subtitle(){return t("inventory.thisMonth")},get children(){var J=Ti();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","var(--primary-color)"),l(J,()=>M().totalMovementsThisMonth),J}}),null),l(ee,B(Tt,{get title(){return t("inventory.activeLocations")},get subtitle(){return t("inventory.warehousesStores")},get children(){var J=Ti();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","var(--primary-color)"),l(J,()=>M().activeLocations),J}}),null),l(G,(()=>{var J=Te(()=>M().lowStockProducts>0);return()=>J()&&B(Tt,{get title(){return` ${t("inventory.lowStockAlert")}`},get subtitle(){return`${M().lowStockProducts} ${t("inventory.productsNeedRestocking")}`},style:{"margin-bottom":"2rem","border-color":"#ffcdd2",background:"#ffebee"},get children(){var W=Ti();return W.style.setProperty("margin-top","1rem"),l(W,B(Ht,{get each(){return lt.getLowStockProducts().slice(0,9)},children:q=>(()=>{var ae=QT(),de=ae.firstChild,le=de.firstChild,V=le.nextSibling;V.nextSibling;var ce=de.nextSibling,Pe=ce.firstChild,fe=Pe.nextSibling;return fe.nextSibling,ae.style.setProperty("display","flex"),ae.style.setProperty("justify-content","space-between"),ae.style.setProperty("margin-bottom","0.5rem"),ae.style.setProperty("font-size","0.875rem"),l(de,()=>q.name,le),l(de,()=>q?.sku,V),ce.style.setProperty("color","#d32f2f"),ce.style.setProperty("font-weight","600"),l(ce,()=>q.currentStock,Pe),l(ce,()=>q.minStockLevel,fe),l(ce,()=>t("inventory.min"),null),ae})()}),null),l(W,(()=>{var q=Te(()=>lt.getLowStockProducts().length>5);return()=>q()&&(()=>{var ae=Ti();return ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),ae.style.setProperty("font-style","italic"),l(ae,()=>t("common.andMore",{count:lt.getLowStockProducts().length-9})),ae})()})(),null),W}})})(),null),Se(J=>m(ee,F,J)),G})()),Te(()=>Te(()=>u()==="products")()&&B(S5,{})),Te(()=>Te(()=>u()==="movements")()&&B(qE,{})),Te(()=>Te(()=>u()==="locations")()&&(()=>{var G=XT(),ee=G.firstChild,J=ee.firstChild,W=ee.nextSibling;return ee.style.setProperty("display","flex"),ee.style.setProperty("justify-content","space-between"),ee.style.setProperty("align-items","center"),ee.style.setProperty("margin-bottom","1.5rem"),J.style.setProperty("margin","0"),J.style.setProperty("font-size","1.5rem"),l(J,()=>t("inventory.locations")),l(ee,B(Ge,{get when(){return Ar.hasPermission("read_write")},get children(){return B(Pt,{variant:"primary",onClick:()=>j(!0),get children(){return[" ",Te(()=>t("inventory.addLocation"))]}})}}),null),m(W,U),l(W,B(Ht,{get each(){return lt.getActiveLocations()},children:q=>{const ae=lt.getStockByLocation(q.id),de=ae?.length,le=ae?.reduce((ce,Pe)=>ce*1+Pe.quantity*1,0),V=ae?.reduce((ce,Pe)=>(lt?.getProductById(Pe.productId),ce+(Pe?.averageCost||0)),0);return(()=>{var ce=ZT(),Pe=ce.firstChild,fe=Pe.firstChild,be=fe.firstChild,xe=be.nextSibling,he=fe.nextSibling,ve=he.firstChild,De=he.nextSibling,Ee=Pe.nextSibling,Ce=Ee.firstChild,Ne=Ce.firstChild,Ie=Ne.firstChild,Re=Ne.nextSibling,We=Ce.nextSibling,Fe=We.firstChild,Xe=Fe.firstChild,tt=Fe.nextSibling,At=We.nextSibling,rt=At.firstChild,He=rt.firstChild,xt=rt.nextSibling,_t=Ee.nextSibling,mt=_t.firstChild,Et=mt.firstChild;return Pe.style.setProperty("margin-bottom","1rem"),Pe.style.setProperty("padding-bottom","1rem"),Pe.style.setProperty("border-bottom","1px solid var(--border-color)"),fe.style.setProperty("display","flex"),fe.style.setProperty("align-items","center"),fe.style.setProperty("gap","0.5rem"),fe.style.setProperty("margin-bottom","0.5rem"),be.style.setProperty("font-size","1.2rem"),l(be,()=>q.type==="warehouse"?"":q.type==="store"?"":q.type==="supplier"?"":""),xe.style.setProperty("margin","0"),xe.style.setProperty("font-size","1.1rem"),l(xe,()=>q.name),he.style.setProperty("font-size","0.875rem"),he.style.setProperty("color","var(--text-muted)"),l(he,()=>q.code,ve),l(he,()=>Y(q.type),null),De.style.setProperty("font-size","0.75rem"),De.style.setProperty("color","var(--text-muted)"),De.style.setProperty("margin-top","0.25rem"),l(De,()=>q.address),Ee.style.setProperty("margin-bottom","1rem"),Ce.style.setProperty("display","flex"),Ce.style.setProperty("justify-content","space-between"),Ce.style.setProperty("margin-bottom","0.5rem"),Ne.style.setProperty("font-size","0.875rem"),Ne.style.setProperty("font-weight","500"),l(Ne,()=>t("inventory.products"),Ie),Re.style.setProperty("font-weight","600"),l(Re,de),We.style.setProperty("display","flex"),We.style.setProperty("justify-content","space-between"),We.style.setProperty("margin-bottom","0.5rem"),Fe.style.setProperty("font-size","0.875rem"),Fe.style.setProperty("font-weight","500"),l(Fe,()=>t("inventory.totalItems"),Xe),tt.style.setProperty("font-weight","600"),tt.style.setProperty("color","var(--primary-color)"),l(tt,le),At.style.setProperty("display","flex"),At.style.setProperty("justify-content","space-between"),At.style.setProperty("margin-bottom","1rem"),rt.style.setProperty("font-size","0.875rem"),rt.style.setProperty("font-weight","500"),l(rt,()=>t("inventory.totalValue"),He),xt.style.setProperty("font-weight","600"),xt.style.setProperty("color","var(--primary-color)"),l(xt,()=>b(V)),mt.style.setProperty("font-weight","600"),mt.style.setProperty("margin-bottom","0.75rem"),mt.style.setProperty("font-size","0.875rem"),mt.style.setProperty("color","var(--text-primary)"),mt.style.setProperty("border-bottom","1px solid var(--border-color)"),mt.style.setProperty("padding-bottom","0.5rem"),l(mt,()=>t("inventory.productDetails"),Et),l(_t,(()=>{var et=Te(()=>ae?.length===0);return()=>et()?(()=>{var qe=Ti();return qe.style.setProperty("text-align","center"),qe.style.setProperty("color","var(--text-muted)"),qe.style.setProperty("font-style","italic"),qe.style.setProperty("padding","1rem"),l(qe,()=>t("inventory.noProducts")),qe})():(()=>{var qe=Ti();return qe.style.setProperty("max-height","200px"),qe.style.setProperty("overflow-y","auto"),qe.style.setProperty("border","1px solid var(--border-color)"),qe.style.setProperty("border-radius","var(--border-radius-sm)"),l(qe,B(Ht,{each:ae,children:ot=>{const Je=lt.getProductById(ot.productId);if(!Je)return null;const at=ot.quantity<=Je.minStockLevel,dt=ot.averageCost;return ot.quantity?(()=>{var It=e6(),jt=It.firstChild,Gt=jt.firstChild,yt=Gt.firstChild,Qt=yt.nextSibling,Mt=Gt.nextSibling,Kt=Mt.firstChild,Xt=Kt.firstChild,ht=Kt.nextSibling,wt=ht.nextSibling;return wt.firstChild,It.style.setProperty("padding","0.75rem"),It.style.setProperty("border-bottom","1px solid var(--border-color)"),(at?"#fff5f5":"transparent")!=null?It.style.setProperty("background",at?"#fff5f5":"transparent"):It.style.removeProperty("background"),It.style.setProperty("transition","background-color 0.2s ease"),jt.style.setProperty("display","flex"),jt.style.setProperty("justify-content","space-between"),jt.style.setProperty("align-items","flex-start"),jt.style.setProperty("margin-bottom","0.25rem"),Gt.style.setProperty("flex","1"),yt.style.setProperty("font-weight","500"),yt.style.setProperty("font-size","0.875rem"),(at?"#d32f2f":"var(--text-primary)")!=null?yt.style.setProperty("color",at?"#d32f2f":"var(--text-primary)"):yt.style.removeProperty("color"),l(yt,()=>Je.name,null),l(yt,at&&(()=>{var Ut=t6();return Ut.style.setProperty("margin-left","0.5rem"),Ut.style.setProperty("font-size","0.7rem"),Ut.style.setProperty("color","#d32f2f"),Ut})(),null),Qt.style.setProperty("font-size","0.75rem"),Qt.style.setProperty("color","var(--text-muted)"),Qt.style.setProperty("margin-top","0.1rem"),l(Qt,()=>Je.sku,null),l(Qt,()=>Je.UPC?"  "+Je.UPC:"",null),l(Qt,()=>Je.category?"  "+Je.category:"",null),Mt.style.setProperty("text-align","right"),Kt.style.setProperty("font-weight","600"),Kt.style.setProperty("font-size","0.875rem"),(at?"#d32f2f":"var(--primary-color)")!=null?Kt.style.setProperty("color",at?"#d32f2f":"var(--primary-color)"):Kt.style.removeProperty("color"),l(Kt,()=>ot.quantity,Xt),l(Kt,()=>Je.unitOfMeasure,null),ht.style.setProperty("font-size","0.75rem"),ht.style.setProperty("color","var(--text-muted)"),l(ht,()=>b(dt)),wt.style.setProperty("font-size","0.7rem"),wt.style.setProperty("color","var(--text-muted)"),wt.style.setProperty("margin-top","0.1rem"),l(wt,()=>Je.minStockLevel,null),It})():null}})),qe})()})(),null),Se(et=>m(ce,{...N,"min-height":"400px"},et)),ce})()}})),G})())]}}),B(Ge,{get when(){return Ar.hasPermission("read_write")},get children(){return[B(Uk,{get isOpen(){return e()},onClose:()=>r(!1),get mode(){return y()==="new"?"movement":"legacy"}}),B(uE,{get isOpen(){return n()},onClose:()=>i(!1)}),B(mE,{get isOpen(){return o()},onClose:()=>s(!1),get item(){return a()}}),B(Ly,{get isOpen(){return x()},onClose:()=>j(!1),onLocationAdded:()=>{j(!1)}})]}}),B(tT,{get isOpen(){return ne()},onClose:()=>Q(!1)}),B(HT,{get isOpen(){return K()},onClose:()=>Z(!1)})]}})};ur(["click"]);const n6=[{id:"1",name:"John Doe",position:"Software Engineer",salary:85e3,email:"john.doe@company.com",phone:"+1 (555) 123-4567",department:"Engineering",startDate:"2023-01-15"},{id:"2",name:"Jane Smith",position:"Product Manager",salary:95e3,email:"jane.smith@company.com",phone:"+1 (555) 234-5678",department:"Product",startDate:"2022-08-20"},{id:"3",name:"Mike Brown",position:"Designer",salary:7e4,email:"mike.brown@company.com",phone:"+1 (555) 345-6789",department:"Design",startDate:"2023-03-10"},{id:"4",name:"Sarah Kim",position:"HR Manager",salary:78e3,email:"sarah.kim@company.com",phone:"+1 (555) 456-7890",department:"Human Resources",startDate:"2022-11-05"},{id:"5",name:"Alex Lee",position:"Data Analyst",salary:72e3,email:"alex.lee@company.com",phone:"+1 (555) 567-8901",department:"Analytics",startDate:"2023-02-28"},{id:"6",name:"Emma Wilson",position:"Marketing Manager",salary:82e3,email:"emma.wilson@company.com",phone:"+1 (555) 678-9012",department:"Marketing",startDate:"2022-09-15"}],[Kc,rp]=$e(n6),P5={get employees(){return Kc()},addEmployee(t){const e={...t,id:Date.now().toString()};return rp([...Kc(),e]),e},updateEmployee(t,e){rp(Kc().map(r=>r.id===t?{...r,...e}:r))},deleteEmployee(t){rp(Kc().filter(e=>e.id!==t))},getEmployeeById(t){return Kc().find(e=>e.id===t)}};var i6=ue("<form><div>");const o6=t=>{const{t:e}=tr(),[r,n]=$e({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),i=[{value:"Engineering",label:e("employees.departments.engineering","Engineering")},{value:"Product",label:e("employees.departments.product","Product")},{value:"Design",label:e("employees.departments.design","Design")},{value:"Marketing",label:e("employees.departments.marketing","Marketing")},{value:"Sales",label:e("employees.departments.sales","Sales")},{value:"Human Resources",label:e("employees.departments.humanResources","Human Resources")},{value:"Finance",label:e("employees.departments.finance","Finance")},{value:"Operations",label:e("employees.departments.operations","Operations")},{value:"Analytics",label:e("employees.departments.analytics","Analytics")}],o={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},s=c=>{c.preventDefault();const u=r();if(!u.name||!u.position||!u.salary||!u.email||!u.department||!u.startDate){alert(e("forms.requiredField"));return}const f={name:u.name,position:u.position,salary:parseFloat(u.salary),email:u.email,phone:u.phone,department:u.department,startDate:u.startDate};P5.addEmployee(f),n({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),t.onClose()},a=(c,u)=>{n(f=>({...f,[c]:u}))};return B(Qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.addEmployee")},get children(){var c=i6(),u=c.firstChild;return c.addEventListener("submit",s),l(c,B(Or,{get label(){return e("employees.fullName")},get value(){return r().name},onChange:f=>a("name",f),get placeholder(){return e("employees.enterFullName","Enter employee's full name")},required:!0}),u),l(c,B(Or,{get label(){return e("employees.position")},get value(){return r().position},onChange:f=>a("position",f),get placeholder(){return e("employees.enterPosition","Enter job position")},required:!0}),u),l(c,B(ci,{get label(){return e("employees.department")},get value(){return r().department},onChange:f=>a("department",f),options:i,required:!0}),u),l(c,B(Or,{get label(){return e("employees.email")},type:"email",get value(){return r().email},onChange:f=>a("email",f),get placeholder(){return e("employees.enterEmail","Enter email address")},required:!0}),u),l(c,B(Or,{get label(){return e("employees.phone")},type:"tel",get value(){return r().phone},onChange:f=>a("phone",f),get placeholder(){return e("employees.enterPhone","Enter phone number")}}),u),l(c,B(Or,{get label(){return e("employees.salary")},type:"number",get value(){return r().salary},onChange:f=>a("salary",f),get placeholder(){return e("employees.enterSalary","Enter annual salary")},required:!0}),u),l(c,B(Or,{get label(){return e("employees.hireDate")},type:"date",get value(){return r().startDate},onChange:f=>a("startDate",f),required:!0}),u),m(u,o),l(u,B(Pt,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),l(u,B(Pt,{variant:"primary",type:"submit",get children(){return e("employees.addEmployee")}}),null),c}})};var s6=ue("<div><div></div><div></div><div>"),a6=ue("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),l6=ue("<div>");const c6=t=>{const{t:e}=tr(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={width:"80px",height:"80px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.5rem",margin:"0 auto 1.5rem auto"},s={"text-align":"center","margin-bottom":"2rem"},a={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},c={color:"var(--text-muted)","font-size":"1rem"},u={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"};if(!t.employee)return null;const f=p=>p.split(" ").map(I=>I[0]).join("").toUpperCase(),y=p=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(p),v=p=>new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return B(Qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.employeeDetails")},get children(){return[(()=>{var p=s6(),I=p.firstChild,P=I.nextSibling,w=P.nextSibling;return m(p,s),m(I,o),l(I,()=>f(t.employee.name)),m(P,a),l(P,()=>t.employee.name),m(w,c),l(w,()=>t.employee.position),p})(),(()=>{var p=a6(),I=p.firstChild,P=I.firstChild,w=P.nextSibling,x=I.nextSibling,j=x.firstChild,ne=j.nextSibling,Q=x.nextSibling,K=Q.firstChild,Z=K.nextSibling,k=Q.nextSibling,C=k.firstChild,E=C.nextSibling,M=k.nextSibling,_=M.firstChild,S=_.nextSibling,b=M.nextSibling,Y=b.firstChild,te=Y.nextSibling;return l(P,()=>e("employees.employeeId")),l(w,()=>t.employee.id),l(j,()=>e("employees.department")),l(ne,()=>t.employee.department),l(K,()=>e("employees.email")),l(Z,()=>t.employee.email),l(C,()=>e("employees.phone")),l(E,()=>t.employee.phone),l(_,()=>e("employees.salary")),l(S,()=>y(t.employee.salary)),l(Y,()=>e("employees.hireDate")),l(te,()=>v(t.employee.startDate)),Se(O=>{var D=r,X=n,H=i,F=r,ie=n,$=i,L=r,U=n,N=i,z=r,oe=n,G=i,ee=r,J=n,W=i,q=r,ae=n,de=i;return O.e=m(I,D,O.e),O.t=m(P,X,O.t),O.a=m(w,H,O.a),O.o=m(x,F,O.o),O.i=m(j,ie,O.i),O.n=m(ne,$,O.n),O.s=m(Q,L,O.s),O.h=m(K,U,O.h),O.r=m(Z,N,O.r),O.d=m(k,z,O.d),O.l=m(C,oe,O.l),O.u=m(E,G,O.u),O.c=m(M,ee,O.c),O.w=m(_,J,O.w),O.m=m(S,W,O.m),O.f=m(b,q,O.f),O.y=m(Y,ae,O.y),O.g=m(te,de,O.g),O},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),p})(),(()=>{var p=l6();return m(p,u),l(p,B(Pt,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),l(p,B(Pt,{variant:"primary",onClick:()=>{console.log("Edit employee:",t.employee.id)},get children(){return e("employees.editEmployee")}}),null),p})()]}})};var b0=ue("<div>"),u6=ue("<div><div></div><div><div></div><div></div><div>/year");const d6=()=>{const{t}=tr(),[e,r]=$e(!1),[n,i]=$e(!1),[o,s]=$e(null),a=P=>{s(P),i(!0)},c={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},u={display:"flex","align-items":"center",gap:"1rem"},f={width:"60px",height:"60px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.2rem"},y={flex:"1"},v={"font-weight":"600","margin-bottom":"0.25rem"},p={color:"var(--text-muted)","font-size":"0.875rem","margin-bottom":"0.5rem"},I={color:"var(--primary-color)","font-weight":"500"};return B(ro,{get title(){return t("employees.title")},get children(){return[(()=>{var P=b0();return P.style.setProperty("margin-bottom","2rem"),l(P,B(Pt,{variant:"primary",onClick:()=>r(!0),get children(){return t("employees.addEmployee")}})),P})(),(()=>{var P=b0();return m(P,c),l(P,()=>P5.employees.map(w=>{const x=ne=>ne.split(" ").map(Q=>Q[0]).join("").toUpperCase(),j=ne=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ne);return B(Tt,{onClick:()=>a(w),get children(){var ne=u6(),Q=ne.firstChild,K=Q.nextSibling,Z=K.firstChild,k=Z.nextSibling,C=k.nextSibling,E=C.firstChild;return m(ne,u),m(Q,f),l(Q,()=>x(w.name)),m(K,y),m(Z,v),l(Z,()=>w.name),m(k,p),l(k,()=>w.position),m(C,I),l(C,()=>j(w.salary),E),ne}})})),P})(),B(o6,{get isOpen(){return e()},onClose:()=>r(!1)}),B(c6,{get isOpen(){return n()},onClose:()=>i(!1),get employee(){return o()}})]}})},h6=[{id:"1",accountId:"1002",bankName:"First National Bank",accountNumber:"****1234",accountType:"checking",currency:"USD",currentBalance:32730.5,lastReconciledDate:"2024-01-01",lastReconciledBalance:3e4,isActive:!0},{id:"2",accountId:"1003",bankName:"First National Bank",accountNumber:"****5678",accountType:"savings",currency:"USD",currentBalance:12e3,lastReconciledDate:"2024-01-01",lastReconciledBalance:1e4,isActive:!0}],f6=[{id:"1",accountId:"1002",date:"2024-01-15",description:"Customer Payment - ABC Corp",reference:"CHK001234",debitAmount:5e3,creditAmount:0,balance:35730.5,category:"Customer Payment",isReconciled:!0,reconciledWith:"eb1",importedAt:"2024-01-16",source:"csv_import"},{id:"2",accountId:"1002",date:"2024-01-14",description:"Office Supplies - Staples",reference:"CHK001235",debitAmount:0,creditAmount:250,balance:30730.5,category:"Office Expenses",isReconciled:!0,reconciledWith:"eb2",importedAt:"2024-01-16",source:"csv_import"},{id:"3",accountId:"1002",date:"2024-01-13",description:"Monthly Rent Payment",reference:"CHK001236",debitAmount:0,creditAmount:2e3,balance:28730.5,category:"Rent",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"},{id:"4",accountId:"1002",date:"2024-01-12",description:"Wire Transfer In",reference:"WIRE001",debitAmount:1e4,creditAmount:0,balance:38730.5,category:"Wire Transfer",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"}],p6=[{id:"eb1",accountId:"1002",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",debitAmount:5e3,creditAmount:0,category:"Accounts Receivable",isReconciled:!0,reconciledWith:"1",createdAt:"2024-01-15"},{id:"eb2",accountId:"1002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",debitAmount:0,creditAmount:250,category:"Office Expenses",isReconciled:!0,reconciledWith:"2",createdAt:"2024-01-14"},{id:"eb3",accountId:"1002",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",debitAmount:0,creditAmount:3500,category:"Salary Expense",isReconciled:!1,createdAt:"2024-01-11"}],m6=[{id:"1",bankAccountId:"1",periodStart:"2024-01-01",periodEnd:"2024-01-15",startingBalance:3e4,endingBalance:35730.5,status:"in_progress",totalBankTransactions:4,totalEntryBookRecords:3,reconciledTransactions:2,unreconciledTransactions:2,discrepancyAmount:1500,createdAt:"2024-01-16",notes:"Wire transfer and rent payment need investigation"}],[Od,_0]=$e(h6),[ha,np]=$e(f6),[Jc,w0]=$e(p6),[Bd,S0]=$e(m6),Un={get bankAccounts(){return Od()},addBankAccount(t){const e={...t,id:Date.now().toString()};return _0([...Od(),e]),e},updateBankAccount(t,e){_0(Od().map(r=>r.id===t?{...r,...e}:r))},getBankAccountById(t){return Od().find(e=>e.id===t)},get bankStatements(){return ha()},addBankStatement(t){const e={...t,id:Date.now().toString(),importedAt:new Date().toISOString()};return np([...ha(),e]),e},addBankStatementsFromCSV(t){const e=t.map(r=>({...r,id:`csv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,importedAt:new Date().toISOString(),source:"csv_import",isReconciled:!1}));return np([...ha(),...e]),e},updateBankStatement(t,e){np(ha().map(r=>r.id===t?{...r,...e}:r))},getBankStatementsByAccount(t){return ha().filter(e=>e.accountId===t)},getUnreconciledBankStatements(t){return(t?this.getBankStatementsByAccount(t):ha()).filter(r=>!r.isReconciled)},get entryBookRecords(){return Jc()},addEntryBookRecord(t){const e={...t,id:Date.now().toString(),createdAt:new Date().toISOString()};return w0([...Jc(),e]),e},updateEntryBookRecord(t,e){w0(Jc().map(r=>r.id===t?{...r,...e}:r))},getEntryBookRecordsByAccount(t){return Jc().filter(e=>e.accountId===t)},getUnreconciledEntryBookRecords(t){return(t?this.getEntryBookRecordsByAccount(t):Jc()).filter(r=>!r.isReconciled)},reconcileTransaction(t,e){this.updateBankStatement(t,{isReconciled:!0,reconciledWith:e}),this.updateEntryBookRecord(e,{isReconciled:!0,reconciledWith:t})},unreconciledTransaction(t){const e=ha().find(r=>r.id===t);e?.reconciledWith&&this.updateEntryBookRecord(e.reconciledWith,{isReconciled:!1,reconciledWith:void 0}),this.updateBankStatement(t,{isReconciled:!1,reconciledWith:void 0})},findPotentialMatches(t){const e=ha().find(n=>n.id===t);return e?this.getUnreconciledEntryBookRecords(e.accountId).filter(n=>{const i=Math.abs(e.debitAmount-n.debitAmount)<.01||Math.abs(e.creditAmount-n.creditAmount)<.01,o=new Date(e.date),s=new Date(n.date),c=Math.abs((o.getTime()-s.getTime())/(1e3*60*60*24))<=3,u=e.reference===n.reference||e.description.toLowerCase().includes(n.description.toLowerCase())||n.description.toLowerCase().includes(e.description.toLowerCase());return i&&(c||u)}).sort((n,i)=>{const o=(n.date===e.date?2:0)+(n.reference===e.reference?1:0);return(i.date===e.date?2:0)+(i.reference===e.reference?1:0)-o}):[]},get reconciliationSessions(){return Bd()},startReconciliationSession(t,e,r){const n=this.getBankStatementsByAccount(t).filter(u=>u.date>=e&&u.date<=r),i=this.getEntryBookRecordsByAccount(t).filter(u=>u.date>=e&&u.date<=r),o=n.filter(u=>u.isReconciled).length,s=this.getBankAccountById(t)?.lastReconciledBalance||0,a=this.getBankAccountById(t)?.currentBalance||0,c={id:Date.now().toString(),bankAccountId:t,periodStart:e,periodEnd:r,startingBalance:s,endingBalance:a,status:"in_progress",totalBankTransactions:n.length,totalEntryBookRecords:i.length,reconciledTransactions:o,unreconciledTransactions:n.length-o,discrepancyAmount:0,createdAt:new Date().toISOString()};return S0([...Bd(),c]),c},updateReconciliationSession(t,e){S0(Bd().map(r=>r.id===t?{...r,...e}:r))},getReconciliationSessionsByAccount(t){return Bd().filter(e=>e.bankAccountId===t)}};var ip=ue("<div>"),y6=ue("<div><strong>:</strong> <!> - "),g6=ue("<div><div><div></div><div></div><div></div></div><input id=csvFileInput type=file accept=.csv>"),v6=ue("<div><h4></h4><div><div><label> *</label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value>"),Ql=ue("<option>"),b6=ue("<div><table><thead><tr></tr></thead><tbody>"),_6=ue("<th>"),w6=ue("<tr>"),S6=ue("<td>");const P6=t=>{const{t:e}=tr(),[r,n]=$e(!1),[i,o]=$e(!1),[s,a]=$e(null),[c,u]=$e([]),[f,y]=$e({date:"",description:"",reference:"",debit:"",credit:"",balance:""}),v={border:`2px dashed ${r()?"var(--primary-color)":"var(--border-color)"}`,"border-radius":"var(--border-radius)",padding:"2rem","text-align":"center","background-color":r()?"var(--background-color)":"transparent",transition:"all 0.2s ease",cursor:"pointer"},p={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem","margin-top":"1.5rem"},I={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-family":"inherit"},P={"max-height":"200px","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},w={width:"100%","border-collapse":"collapse","font-size":"0.875rem"},x={padding:"0.5rem","border-bottom":"1px solid var(--border-color)","text-align":"left"},j={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ne=S=>{S.preventDefault(),n(!0)},Q=S=>{S.preventDefault(),n(!1)},K=S=>{S.preventDefault(),n(!1);const b=S.dataTransfer?.files;b&&b.length>0&&k(b[0])},Z=S=>{const b=S.target;b.files&&b.files.length>0&&k(b.files[0])},k=S=>{if(!S.name.toLowerCase().endsWith(".csv")){a({success:!1,message:e("banking.pleaseUploadCSV")});return}o(!0);const b=new FileReader;b.onload=Y=>{try{const O=(Y.target?.result).split(`
`).filter(F=>F.trim());if(O.length<2){a({success:!1,message:e("banking.csvRequiresHeaderAndData")}),o(!1);return}const D=O[0].split(",").map(F=>F.trim().replace(/[\"\']/g,"")),X=O.slice(1).map(F=>{const ie=F.split(",").map(L=>L.trim().replace(/[\"\']/g,"")),$={};return D.forEach((L,U)=>{$[L]=ie[U]||""}),$});u(X),a({success:!0,message:e("banking.successfullyParsed").replace("{count}",X.length.toString()),count:X.length});const H={...f()};D.forEach(F=>{const ie=F.toLowerCase();ie.includes("date")&&(H.date=F),(ie.includes("description")||ie.includes("memo"))&&(H.description=F),(ie.includes("reference")||ie.includes("check")||ie.includes("ref"))&&(H.reference=F),(ie.includes("debit")||ie.includes("deposit"))&&(H.debit=F),(ie.includes("credit")||ie.includes("withdrawal")||ie.includes("amount"))&&(H.debit?H.credit=F:H.debit=F),ie.includes("balance")&&(H.balance=F)}),y(H)}catch{a({success:!1,message:e("banking.errorParsingCSV")})}o(!1)},b.readAsText(S)},C=(S,b)=>{y(Y=>({...Y,[S]:b}))},E=()=>c().length===0?[]:Object.keys(c()[0]),M=()=>{if(!t.bankAccount||c().length===0)return;const S=f();if(!S.date||!S.description){a({success:!1,message:e("banking.dateDescriptionRequired")});return}o(!0);try{const b=c().map(te=>{const O=F=>F&&parseFloat(F.replace(/[^0-9.-]/g,""))||0,D=F=>{const ie=new Date(F);if(isNaN(ie.getTime())){const $=F.split("/");if($.length===3)return new Date(parseInt($[2]),parseInt($[0])-1,parseInt($[1])).toISOString().split("T")[0]}return ie.toISOString().split("T")[0]};let X=0,H=0;if(S.debit&&S.credit)X=O(te[S.debit]),H=O(te[S.credit]);else if(S.debit){const F=O(te[S.debit]);F>0?X=F:H=Math.abs(F)}return{accountId:t.bankAccount.accountId,date:D(te[S.date]),description:te[S.description]||e("banking.importedTransaction"),reference:te[S.reference]||"",debitAmount:X,creditAmount:H,balance:S.balance?O(te[S.balance]):0,isReconciled:!1}}),Y=Un.addBankStatementsFromCSV(b);a({success:!0,message:e("banking.successfullyImported").replace("{count}",Y.length.toString()),count:Y.length}),u([]),y({date:"",description:"",reference:"",debit:"",credit:"",balance:""})}catch{a({success:!1,message:e("banking.errorImportingTransactions")})}o(!1)},_=()=>{u([]),a(null),y({date:"",description:"",reference:"",debit:"",credit:"",balance:""})};return B(Qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("banking.importBankStatementCSV")},get children(){return[Te(()=>Te(()=>!!t.bankAccount)()&&(()=>{var S=y6(),b=S.firstChild,Y=b.firstChild,te=b.nextSibling,O=te.nextSibling;return O.nextSibling,S.style.setProperty("margin-bottom","1.5rem"),S.style.setProperty("padding","1rem"),S.style.setProperty("background","var(--background-color)"),S.style.setProperty("border-radius","var(--border-radius-sm)"),S.style.setProperty("border","1px solid var(--border-color)"),l(b,()=>e("banking.bankAccount"),Y),l(S,()=>t.bankAccount.bankName,O),l(S,()=>t.bankAccount.accountNumber,null),S})()),Te(()=>Te(()=>c().length===0)()?(()=>{var S=g6(),b=S.firstChild,Y=b.firstChild,te=Y.nextSibling,O=te.nextSibling,D=b.nextSibling;return b.$$click=()=>document.getElementById("csvFileInput")?.click(),b.addEventListener("drop",K),b.addEventListener("dragleave",Q),b.addEventListener("dragover",ne),Y.style.setProperty("font-size","2rem"),Y.style.setProperty("margin-bottom","1rem"),te.style.setProperty("font-weight","500"),te.style.setProperty("margin-bottom","0.5rem"),l(te,(()=>{var X=Te(()=>!!r());return()=>X()?e("banking.dropCSVHere"):e("banking.clickToUploadCSV")})()),O.style.setProperty("font-size","0.875rem"),O.style.setProperty("color","var(--text-muted)"),l(O,()=>e("banking.supportedFormat")),D.addEventListener("change",Z),D.style.setProperty("display","none"),Se(X=>m(b,v,X)),S})():(()=>{var S=v6(),b=S.firstChild,Y=b.nextSibling,te=Y.firstChild,O=te.firstChild,D=O.firstChild,X=O.nextSibling,H=X.firstChild,F=te.nextSibling,ie=F.firstChild,$=ie.firstChild,L=ie.nextSibling,U=L.firstChild,N=F.nextSibling,z=N.firstChild,oe=z.nextSibling,G=oe.firstChild,ee=N.nextSibling,J=ee.firstChild,W=J.firstChild,q=J.nextSibling,ae=q.firstChild,de=ee.nextSibling,le=de.firstChild,V=le.nextSibling,ce=V.firstChild,Pe=de.nextSibling,fe=Pe.firstChild,be=fe.nextSibling,xe=be.firstChild;return b.style.setProperty("margin","0 0 1rem 0"),l(b,()=>e("banking.mapCSVColumns")),m(Y,p),O.style.setProperty("display","block"),O.style.setProperty("margin-bottom","0.5rem"),O.style.setProperty("font-weight","500"),l(O,()=>e("banking.dateColumn"),D),X.addEventListener("change",he=>C("date",he.target.value)),l(H,()=>e("banking.selectColumn")),l(X,()=>E().map(he=>(()=>{var ve=Ql();return ve.value=he,l(ve,he),ve})()),null),ie.style.setProperty("display","block"),ie.style.setProperty("margin-bottom","0.5rem"),ie.style.setProperty("font-weight","500"),l(ie,()=>e("banking.descriptionColumn"),$),L.addEventListener("change",he=>C("description",he.target.value)),l(U,()=>e("banking.selectColumn")),l(L,()=>E().map(he=>(()=>{var ve=Ql();return ve.value=he,l(ve,he),ve})()),null),z.style.setProperty("display","block"),z.style.setProperty("margin-bottom","0.5rem"),z.style.setProperty("font-weight","500"),l(z,()=>e("banking.referenceColumn")),oe.addEventListener("change",he=>C("reference",he.target.value)),l(G,()=>e("banking.selectColumn")),l(oe,()=>E().map(he=>(()=>{var ve=Ql();return ve.value=he,l(ve,he),ve})()),null),J.style.setProperty("display","block"),J.style.setProperty("margin-bottom","0.5rem"),J.style.setProperty("font-weight","500"),l(J,()=>e("banking.amountDebitColumn"),W),q.addEventListener("change",he=>C("debit",he.target.value)),l(ae,()=>e("banking.selectColumn")),l(q,()=>E().map(he=>(()=>{var ve=Ql();return ve.value=he,l(ve,he),ve})()),null),le.style.setProperty("display","block"),le.style.setProperty("margin-bottom","0.5rem"),le.style.setProperty("font-weight","500"),l(le,()=>e("banking.creditColumn")),V.addEventListener("change",he=>C("credit",he.target.value)),l(ce,()=>e("banking.selectColumn")),l(V,()=>E().map(he=>(()=>{var ve=Ql();return ve.value=he,l(ve,he),ve})()),null),fe.style.setProperty("display","block"),fe.style.setProperty("margin-bottom","0.5rem"),fe.style.setProperty("font-weight","500"),l(fe,()=>e("banking.balanceColumn")),be.addEventListener("change",he=>C("balance",he.target.value)),l(xe,()=>e("banking.selectColumn")),l(be,()=>E().map(he=>(()=>{var ve=Ql();return ve.value=he,l(ve,he),ve})()),null),l(S,(()=>{var he=Te(()=>c().length>0);return()=>he()&&(()=>{var ve=b6(),De=ve.firstChild,Ee=De.firstChild,Ce=Ee.firstChild,Ne=Ee.nextSibling;return m(ve,P),Ce.style.setProperty("background-color","var(--background-color)"),l(Ce,()=>E().slice(0,6).map(Ie=>(()=>{var Re=_6();return l(Re,Ie),Se(We=>m(Re,x,We)),Re})())),l(Ne,()=>c().slice(0,3).map(Ie=>(()=>{var Re=w6();return l(Re,()=>E().slice(0,6).map(We=>(()=>{var Fe=S6();return l(Fe,()=>Ie[We]),Se(Xe=>m(Fe,x,Xe)),Fe})())),Re})())),l(ve,(()=>{var Ie=Te(()=>c().length>3);return()=>Ie()&&(()=>{var Re=ip();return Re.style.setProperty("padding","0.5rem"),Re.style.setProperty("text-align","center"),Re.style.setProperty("color","var(--text-muted)"),l(Re,()=>e("banking.andMoreRows").replace("{count}",(c().length-3).toString())),Re})()})(),null),Se(Ie=>m(De,w,Ie)),ve})()})(),null),Se(he=>{var ve=I,De=I,Ee=I,Ce=I,Ne=I,Ie=I;return he.e=m(X,ve,he.e),he.t=m(L,De,he.t),he.a=m(oe,Ee,he.a),he.o=m(q,Ce,he.o),he.i=m(V,Ne,he.i),he.n=m(be,Ie,he.n),he},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),Se(()=>X.value=f().date),Se(()=>L.value=f().description),Se(()=>oe.value=f().reference),Se(()=>q.value=f().debit),Se(()=>V.value=f().credit),Se(()=>be.value=f().balance),S})()),Te(()=>Te(()=>!!s())()&&(()=>{var S=ip();return S.style.setProperty("padding","1rem"),S.style.setProperty("border-radius","var(--border-radius-sm)"),S.style.setProperty("margin-top","1rem"),l(S,()=>s().message),Se(b=>{var Y=s().success?"#d4edda":"#f8d7da",te=s().success?"#155724":"#721c24",O=`1px solid ${s().success?"#c3e6cb":"#f5c6cb"}`;return Y!==b.e&&((b.e=Y)!=null?S.style.setProperty("background",Y):S.style.removeProperty("background")),te!==b.t&&((b.t=te)!=null?S.style.setProperty("color",te):S.style.removeProperty("color")),O!==b.a&&((b.a=O)!=null?S.style.setProperty("border",O):S.style.removeProperty("border")),b},{e:void 0,t:void 0,a:void 0}),S})()),(()=>{var S=ip();return m(S,j),l(S,B(Pt,{variant:"secondary",onClick:()=>{_(),t.onClose()},get children(){return e("common.cancel")}}),null),l(S,(()=>{var b=Te(()=>c().length>0);return()=>b()&&B(Pt,{variant:"outline",onClick:_,get children(){return e("common.reset")}})})(),null),l(S,(()=>{var b=Te(()=>c().length>0);return()=>b()&&B(Pt,{variant:"primary",onClick:M,get disabled(){return i()||!f().date||!f().description},get children(){return Te(()=>!!i())()?e("banking.importing"):e("banking.importTransactions").replace("{count}",c().length.toString())}})})(),null),S})()]}})};ur(["click"]);var P0=ue("<span>"),jd=ue("<div>"),x0=ue("<div> "),x6=ue("<div><div><h3></h3><div><button></button><button></button><button></button></div></div><div></div><div><div><h4></h4><div></div></div><div><h4></h4><div>"),A6=ue("<div><div><div></div><div>  </div></div><div><div>"),op=ue("<span> "),C6=ue("<span>(<!>)"),I6=ue("<div><strong>:</strong> "),A0=ue("<div><div><div></div><div>  </div></div><div>"),$6=ue("<div><div>:</div><div></div><div>");const k6=t=>{const{t:e}=tr(),[r,n]=$e([]),[i,o]=$e([]),[s,a]=$e(null),[c,u]=$e([]),[f,y]=$e("unreconciled");vo(()=>{const O=Un.getBankAccountById(t.bankAccountId);if(O){const D=Un.getBankStatementsByAccount(O.accountId).filter(H=>H.date>=t.selectedPeriod.start&&H.date<=t.selectedPeriod.end),X=Un.getEntryBookRecordsByAccount(O.accountId).filter(H=>H.date>=t.selectedPeriod.start&&H.date<=t.selectedPeriod.end);n(D),o(X)}});const v=()=>{const O=r();switch(f()){case"reconciled":return O.filter(D=>D.isReconciled);case"unreconciled":return O.filter(D=>!D.isReconciled);default:return O}},p=()=>{const O=i();switch(f()){case"reconciled":return O.filter(D=>D.isReconciled);case"unreconciled":return O.filter(D=>!D.isReconciled);default:return O}},I=O=>{if(a(O),O.isReconciled)u([]);else{const D=Un.findPotentialMatches(O.id);u(D)}},P=O=>{const D=s();if(D){Un.reconcileTransaction(D.id,O.id);const X=Un.getBankAccountById(t.bankAccountId);if(X){const H=Un.getBankStatementsByAccount(X.accountId).filter(ie=>ie.date>=t.selectedPeriod.start&&ie.date<=t.selectedPeriod.end),F=Un.getEntryBookRecordsByAccount(X.accountId).filter(ie=>ie.date>=t.selectedPeriod.start&&ie.date<=t.selectedPeriod.end);n(H),o(F)}a(null),u([])}},w=O=>{Un.unreconciledTransaction(O.id);const D=Un.getBankAccountById(t.bankAccountId);if(D){const X=Un.getBankStatementsByAccount(D.accountId).filter(F=>F.date>=t.selectedPeriod.start&&F.date<=t.selectedPeriod.end),H=Un.getEntryBookRecordsByAccount(D.accountId).filter(F=>F.date>=t.selectedPeriod.start&&F.date<=t.selectedPeriod.end);n(X),o(H)}},x={display:"grid","grid-template-columns":"1fr 1fr",gap:"2rem","margin-top":"2rem"},j={height:"600px","overflow-y":"auto"},ne={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},Q=O=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:O?"var(--primary-color)":"var(--surface-color)",color:O?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),K=(O,D)=>({display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem","margin-bottom":"0.5rem",background:O?"var(--primary-color)":D?"#e8f5e8":"var(--surface-color)",color:O?"white":"var(--text-primary)","border-radius":"var(--border-radius-sm)",border:`1px solid ${O?"var(--primary-color)":D?"#c3e6cb":"var(--border-color)"}`,cursor:"pointer",transition:"all 0.2s ease"}),Z={flex:"1"},k={"font-weight":"500","margin-bottom":"0.25rem"},C={"font-size":"0.875rem",opacity:"0.8"},E=O=>({"font-weight":"600",color:O?"#4caf50":"#f44336"}),M={padding:"0.25rem 0.5rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","margin-left":"0.5rem"},_=O=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(O),S=O=>new Date(O).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),b=O=>{if(!s())return null;const D=s();return(Math.abs(D.debitAmount-O.debitAmount)<.01||Math.abs(D.creditAmount-O.creditAmount)<.01)&&D.date===O.date?(()=>{var F=P0();return l(F,()=>e("banking.exactMatch")),Se(ie=>m(F,{...M,background:"#d4edda",color:"#155724"},ie)),F})():c().includes(O)?(()=>{var F=P0();return l(F,()=>e("banking.possibleMatch")),Se(ie=>m(F,{...M,background:"#fff3cd",color:"#856404"},ie)),F})():null},te=(()=>{const O=r(),D=i(),X=O.filter(F=>F.isReconciled).length,H=D.filter(F=>F.isReconciled).length;return{totalStatements:O.length,totalRecords:D.length,reconciledStatements:X,reconciledRecords:H,unreconciledStatements:O.length-X,unreconciledRecords:D.length-H}})();return(()=>{var O=x6(),D=O.firstChild,X=D.firstChild,H=X.nextSibling,F=H.firstChild,ie=F.nextSibling,$=ie.nextSibling,L=D.nextSibling,U=L.nextSibling,N=U.firstChild,z=N.firstChild,oe=z.nextSibling,G=N.nextSibling,ee=G.firstChild,J=ee.nextSibling;return m(D,ne),X.style.setProperty("margin","0"),X.style.setProperty("font-size","1.25rem"),l(X,()=>e("banking.reconciliationComparison")),H.style.setProperty("display","flex"),H.style.setProperty("gap","0.5rem"),F.$$click=()=>y("all"),l(F,()=>e("common.all")),ie.$$click=()=>y("unreconciled"),l(ie,()=>e("banking.unreconciled")),$.$$click=()=>y("reconciled"),l($,()=>e("banking.reconciled")),L.style.setProperty("display","grid"),L.style.setProperty("grid-template-columns","repeat(4, 1fr)"),L.style.setProperty("gap","1rem"),L.style.setProperty("margin-bottom","2rem"),l(L,B(Tt,{get title(){return e("banking.bankStatements")},get subtitle(){return e("banking.totalTransactions")},get children(){return[(()=>{var W=jd();return W.style.setProperty("font-size","1.5rem"),W.style.setProperty("font-weight","600"),W.style.setProperty("color","var(--primary-color)"),l(W,()=>te.totalStatements),W})(),(()=>{var W=x0(),q=W.firstChild;return W.style.setProperty("font-size","0.875rem"),W.style.setProperty("color","var(--text-muted)"),l(W,()=>te.reconciledStatements,q),l(W,()=>e("banking.reconciled"),null),W})()]}}),null),l(L,B(Tt,{get title(){return e("banking.entryBookRecords")},get subtitle(){return e("banking.totalEntries")},get children(){return[(()=>{var W=jd();return W.style.setProperty("font-size","1.5rem"),W.style.setProperty("font-weight","600"),W.style.setProperty("color","var(--primary-color)"),l(W,()=>te.totalRecords),W})(),(()=>{var W=x0(),q=W.firstChild;return W.style.setProperty("font-size","0.875rem"),W.style.setProperty("color","var(--text-muted)"),l(W,()=>te.reconciledRecords,q),l(W,()=>e("banking.reconciled"),null),W})()]}}),null),l(L,B(Tt,{get title(){return e("banking.unreconciledBank")},get subtitle(){return e("banking.needAttention")},get children(){var W=jd();return W.style.setProperty("font-size","1.5rem"),W.style.setProperty("font-weight","600"),W.style.setProperty("color","#f44336"),l(W,()=>te.unreconciledStatements),W}}),null),l(L,B(Tt,{get title(){return e("banking.unreconciledBooks")},get subtitle(){return e("banking.needAttention")},get children(){var W=jd();return W.style.setProperty("font-size","1.5rem"),W.style.setProperty("font-weight","600"),W.style.setProperty("color","#f44336"),l(W,()=>te.unreconciledRecords),W}}),null),m(U,x),z.style.setProperty("margin","0 0 1rem 0"),l(z,()=>e("banking.bankStatements")),l(oe,()=>v().map(W=>(()=>{var q=A6(),ae=q.firstChild,de=ae.firstChild,le=de.nextSibling,V=le.firstChild,ce=ae.nextSibling,Pe=ce.firstChild;return q.$$click=()=>I(W),l(de,()=>W.description),l(le,()=>S(W.date),V),l(le,()=>W.reference,null),l(le,(()=>{var fe=Te(()=>!!W.isReconciled);return()=>fe()&&(()=>{var be=op();return be.firstChild,be.style.setProperty("color","#4caf50"),be.style.setProperty("margin-left","0.5rem"),l(be,()=>e("banking.reconciled"),null),be})()})(),null),l(Pe,()=>W.debitAmount>0?"+":"-",null),l(Pe,()=>_(W.debitAmount||W.creditAmount),null),l(ce,(()=>{var fe=Te(()=>!!W.isReconciled);return()=>fe()&&B(Pt,{variant:"outline",size:"sm",onClick:be=>{be.stopPropagation(),w(W)},style:{"margin-top":"0.5rem"},get children(){return e("banking.unreconcile")}})})(),null),Se(fe=>{var be=K(s()?.id===W.id,W.isReconciled),xe=Z,he=k,ve=C,De=E(W.debitAmount>0);return fe.e=m(q,be,fe.e),fe.t=m(ae,xe,fe.t),fe.a=m(de,he,fe.a),fe.o=m(le,ve,fe.o),fe.i=m(Pe,De,fe.i),fe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),q})())),ee.style.setProperty("margin","0 0 1rem 0"),l(ee,()=>e("banking.entryBookRecords"),null),l(ee,(()=>{var W=Te(()=>!!(s()&&!s().isReconciled));return()=>W()&&(()=>{var q=C6(),ae=q.firstChild,de=ae.nextSibling;return de.nextSibling,q.style.setProperty("font-weight","400"),q.style.setProperty("color","var(--text-muted)"),q.style.setProperty("margin-left","0.5rem"),l(q,()=>e("banking.clickToReconcile"),de),q})()})(),null),l(J,(()=>{var W=Te(()=>!!(s()&&!s().isReconciled));return()=>W()?[Te(()=>Te(()=>c().length>0)()&&(()=>{var q=I6(),ae=q.firstChild,de=ae.firstChild;return ae.nextSibling,q.style.setProperty("margin-bottom","1rem"),q.style.setProperty("padding","0.75rem"),q.style.setProperty("background","#fff3cd"),q.style.setProperty("border-radius","var(--border-radius-sm)"),l(ae,()=>e("banking.potentialMatchesFound"),de),l(q,()=>e("banking.clickRecordToReconcile"),null),q})()),Te(()=>p().map(q=>(c().includes(q),(()=>{var ae=A0(),de=ae.firstChild,le=de.firstChild,V=le.nextSibling,ce=V.firstChild,Pe=de.nextSibling;return ae.$$click=()=>{q.isReconciled||P(q)},l(le,()=>q.description,null),l(le,()=>b(q),null),l(V,()=>S(q.date),ce),l(V,()=>q.reference,null),l(V,(()=>{var fe=Te(()=>!!q.isReconciled);return()=>fe()&&(()=>{var be=op();return be.firstChild,be.style.setProperty("color","#4caf50"),be.style.setProperty("margin-left","0.5rem"),l(be,()=>e("banking.reconciled"),null),be})()})(),null),l(Pe,()=>q.debitAmount>0?"+":"-",null),l(Pe,()=>_(q.debitAmount||q.creditAmount),null),Se(fe=>{var be={...K(!1,q.isReconciled),opacity:q.isReconciled?.6:1,cursor:q.isReconciled?"not-allowed":"pointer"},xe=Z,he=k,ve=C,De=E(q.debitAmount>0);return fe.e=m(ae,be,fe.e),fe.t=m(de,xe,fe.t),fe.a=m(le,he,fe.a),fe.o=m(V,ve,fe.o),fe.i=m(Pe,De,fe.i),fe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ae})())))]:p().map(q=>(()=>{var ae=A0(),de=ae.firstChild,le=de.firstChild,V=le.nextSibling,ce=V.firstChild,Pe=de.nextSibling;return l(le,()=>q.description),l(V,()=>S(q.date),ce),l(V,()=>q.reference,null),l(V,(()=>{var fe=Te(()=>!!q.isReconciled);return()=>fe()&&(()=>{var be=op();return be.firstChild,be.style.setProperty("color","#4caf50"),be.style.setProperty("margin-left","0.5rem"),l(be,()=>e("banking.reconciled"),null),be})()})(),null),l(Pe,()=>q.debitAmount>0?"+":"-",null),l(Pe,()=>_(q.debitAmount||q.creditAmount),null),Se(fe=>{var be=K(!1,q.isReconciled),xe=Z,he=k,ve=C,De=E(q.debitAmount>0);return fe.e=m(ae,be,fe.e),fe.t=m(de,xe,fe.t),fe.a=m(le,he,fe.a),fe.o=m(V,ve,fe.o),fe.i=m(Pe,De,fe.i),fe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ae})())})()),l(O,(()=>{var W=Te(()=>!!(s()&&!s().isReconciled));return()=>W()&&(()=>{var q=$6(),ae=q.firstChild,de=ae.firstChild,le=ae.nextSibling,V=le.nextSibling;return q.style.setProperty("position","fixed"),q.style.setProperty("bottom","2rem"),q.style.setProperty("right","2rem"),q.style.setProperty("background","var(--surface-color)"),q.style.setProperty("padding","1rem"),q.style.setProperty("border-radius","var(--border-radius)"),q.style.setProperty("box-shadow","var(--shadow-lg)"),q.style.setProperty("border","1px solid var(--border-color)"),q.style.setProperty("max-width","300px"),ae.style.setProperty("font-weight","500"),ae.style.setProperty("margin-bottom","0.5rem"),l(ae,()=>e("banking.selected"),de),le.style.setProperty("font-size","0.875rem"),le.style.setProperty("margin-bottom","0.5rem"),l(le,()=>s().description),V.style.setProperty("font-weight","600"),V.style.setProperty("color","var(--primary-color)"),l(V,()=>_(s().debitAmount||s().creditAmount)),l(q,B(Pt,{variant:"secondary",size:"sm",onClick:()=>{a(null),u([])},style:{"margin-top":"0.5rem"},get children(){return e("banking.clearSelection")}}),null),q})()})(),null),Se(W=>{var q=Q(f()==="all"),ae=Q(f()==="unreconciled"),de=Q(f()==="reconciled"),le=j,V=j;return W.e=m(F,q,W.e),W.t=m(ie,ae,W.t),W.a=m($,de,W.a),W.o=m(oe,le,W.o),W.i=m(J,V,W.i),W},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),O})()};ur(["click"]);var E6=ue("<div><div><h2></h2><p></p></div><div>"),T6=ue("<div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date>"),N6=ue("<div><button></button><button>"),L6=ue("<div><br>"),Qc=ue("<div>"),D6=ue("<div><div></div><div>  </div><div>"),R6=ue("<div>: "),M6=ue("<div> <!>  <!> "),F6=ue("<div>%"),O6=ue("<div> of <!> transactions");const B6=()=>{const{t}=tr(),[e,r]=$e(null),[n,i]=$e({start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[o,s]=$e(!1),[a,c]=$e("overview");vo(()=>{!e()&&Un.bankAccounts.length>0&&r(Un.bankAccounts[0])});const u={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},f={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},y={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},v=ne=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:ne?"var(--primary-color)":"var(--text-muted)","border-bottom":ne?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),p={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},I=ne=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ne),P=ne=>new Date(ne).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),w=()=>Un.bankAccounts.map(ne=>({value:ne.id,label:`${ne.bankName} - ${ne.accountNumber} (${ne.accountType})`})),j=(()=>{if(!e())return null;const ne=Un.getBankStatementsByAccount(e().accountId).filter(Z=>Z.date>=n().start&&Z.date<=n().end),Q=Un.getEntryBookRecordsByAccount(e().accountId).filter(Z=>Z.date>=n().start&&Z.date<=n().end),K=ne.filter(Z=>Z.isReconciled).length;return Q.filter(Z=>Z.isReconciled).length,{totalBankTransactions:ne.length,totalEntryBookRecords:Q.length,reconciledTransactions:K,unreconciledTransactions:ne.length-K,reconciliationRate:ne.length>0?K/ne.length*100:0}})();return B(ro,{get title(){return t("banking.title")},get children(){return[(()=>{var ne=E6(),Q=ne.firstChild,K=Q.firstChild,Z=K.nextSibling,k=Q.nextSibling;return m(ne,u),K.style.setProperty("margin","0 0 0.5rem 0"),K.style.setProperty("font-size","1.5rem"),l(K,()=>t("banking.reconciliation")),Z.style.setProperty("margin","0"),Z.style.setProperty("color","var(--text-muted)"),l(Z,()=>t("banking.compareStatements")),k.style.setProperty("display","flex"),k.style.setProperty("gap","1rem"),l(k,B(Pt,{variant:"secondary",onClick:()=>s(!0),get disabled(){return!e()},get children(){return t("banking.importCSV")}}),null),l(k,B(Pt,{variant:"primary",get children(){return t("banking.startNewReconciliation")}}),null),ne})(),(()=>{var ne=T6(),Q=ne.firstChild,K=Q.firstChild,Z=Q.nextSibling,k=Z.firstChild,C=k.nextSibling,E=Z.nextSibling,M=E.firstChild,_=M.nextSibling;return m(ne,f),Q.style.setProperty("flex","1"),K.style.setProperty("display","block"),K.style.setProperty("margin-bottom","0.5rem"),K.style.setProperty("font-weight","500"),l(K,()=>t("banking.bankAccount")),l(Q,B(ci,{label:"",get value(){return e()?.id||""},onChange:S=>{const b=Un.getBankAccountById(S);r(b||null)},get options(){return w()}}),null),k.style.setProperty("display","block"),k.style.setProperty("margin-bottom","0.5rem"),k.style.setProperty("font-weight","500"),l(k,()=>t("entryBooks.startDate")),C.addEventListener("change",S=>i(b=>({...b,start:S.target.value}))),C.style.setProperty("padding","0.75rem"),C.style.setProperty("border","1px solid var(--border-color)"),C.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("font-family","inherit"),M.style.setProperty("display","block"),M.style.setProperty("margin-bottom","0.5rem"),M.style.setProperty("font-weight","500"),l(M,()=>t("entryBooks.endDate")),_.addEventListener("change",S=>i(b=>({...b,end:S.target.value}))),_.style.setProperty("padding","0.75rem"),_.style.setProperty("border","1px solid var(--border-color)"),_.style.setProperty("border-radius","var(--border-radius-sm)"),_.style.setProperty("font-family","inherit"),Se(()=>C.value=n().start),Se(()=>_.value=n().end),ne})(),(()=>{var ne=N6(),Q=ne.firstChild,K=Q.nextSibling;return m(ne,y),Q.$$click=()=>c("overview"),l(Q,()=>t("common.overview")),K.$$click=()=>c("reconciliation"),l(K,()=>t("banking.reconciliation")),Se(Z=>{var k=v(a()==="overview"),C=v(a()==="reconciliation");return Z.e=m(Q,k,Z.e),Z.t=m(K,C,Z.t),Z},{e:void 0,t:void 0}),ne})(),Te(()=>Te(()=>a()==="overview")()&&(()=>{var ne=Qc();return l(ne,(()=>{var Q=Te(()=>!!e());return()=>Q()&&(()=>{var K=Qc();return m(K,p),l(K,B(Tt,{get title(){return t("banking.bankAccountInfo")},get subtitle(){return t("banking.currentAccountDetails")},get children(){return[(()=>{var Z=D6(),k=Z.firstChild,C=k.nextSibling,E=C.firstChild,M=C.nextSibling;return Z.style.setProperty("margin-bottom","1rem"),k.style.setProperty("font-weight","600"),k.style.setProperty("margin-bottom","0.5rem"),l(k,()=>e().bankName),C.style.setProperty("color","var(--text-muted)"),C.style.setProperty("margin-bottom","0.5rem"),l(C,()=>e().accountNumber,E),l(C,()=>e().accountType,null),M.style.setProperty("font-size","1.25rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","var(--primary-color)"),l(M,()=>I(e().currentBalance)),Z})(),Te(()=>Te(()=>!!e().lastReconciledDate)()&&(()=>{var Z=R6(),k=Z.firstChild;return Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-muted)"),l(Z,()=>t("banking.lastReconciled"),k),l(Z,()=>P(e().lastReconciledDate),null),Z})())]}}),null),l(K,j&&[B(Tt,{get title(){return t("banking.bankTransactions")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var Z=Qc();return Z.style.setProperty("font-size","1.5rem"),Z.style.setProperty("font-weight","600"),Z.style.setProperty("color","var(--primary-color)"),Z.style.setProperty("margin-bottom","0.5rem"),l(Z,()=>j.totalBankTransactions),Z})(),(()=>{var Z=M6(),k=Z.firstChild,C=k.nextSibling,E=C.nextSibling,M=E.nextSibling;return M.nextSibling,Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-muted)"),l(Z,()=>j.reconciledTransactions,k),l(Z,()=>t("banking.reconciled"),C),l(Z,()=>j.unreconciledTransactions,M),l(Z,()=>t("banking.pending"),null),Z})()]}}),B(Tt,{get title(){return t("entryBooks.entryBookRecords")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var Z=Qc();return Z.style.setProperty("font-size","1.5rem"),Z.style.setProperty("font-weight","600"),Z.style.setProperty("color","var(--primary-color)"),Z.style.setProperty("margin-bottom","0.5rem"),l(Z,()=>j.totalEntryBookRecords),Z})(),(()=>{var Z=Qc();return Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-muted)"),l(Z,()=>t("banking.bookEntriesForComparison")),Z})()]}}),B(Tt,{get title(){return t("banking.reconciliationRate")},get subtitle(){return t("banking.completionStatus")},get children(){return[(()=>{var Z=F6(),k=Z.firstChild;return Z.style.setProperty("font-size","1.5rem"),Z.style.setProperty("font-weight","600"),Z.style.setProperty("margin-bottom","0.5rem"),l(Z,()=>Math.round(j.reconciliationRate),k),Se(C=>(C=j.reconciliationRate>80?"#4caf50":j.reconciliationRate>50?"#ff9800":"#f44336")!=null?Z.style.setProperty("color",C):Z.style.removeProperty("color")),Z})(),(()=>{var Z=O6(),k=Z.firstChild,C=k.nextSibling;return C.nextSibling,Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-muted)"),l(Z,()=>j.reconciledTransactions,k),l(Z,()=>j.totalBankTransactions,C),Z})()]}})],null),K})()})(),null),l(ne,B(Tt,{get title(){return t("banking.recentReconciliationSessions")},get subtitle(){return t("banking.latestActivity")},get children(){var Q=L6(),K=Q.firstChild;return Q.style.setProperty("text-align","center"),Q.style.setProperty("color","var(--text-muted)"),Q.style.setProperty("padding","2rem"),l(Q,()=>t("banking.noRecentSessions"),K),l(Q,B(Pt,{variant:"primary",style:{"margin-top":"1rem"},onClick:()=>c("reconciliation"),get children(){return t("banking.startFirstReconciliation")}}),null),Q}}),null),ne})()),Te(()=>Te(()=>!!(a()==="reconciliation"&&e()))()&&B(k6,{get bankAccountId(){return e().id},get selectedPeriod(){return n()}})),B(P6,{get isOpen(){return o()},onClose:()=>s(!1),get bankAccount(){return e()}})]}})};ur(["click"]);ur(["input","click"]);var j6=ue("<h2>Upload Bank Statement CSV"),V6=ue("<input type=file accept=.csv>"),z6=ue("<h3>Filters"),q6=ue('<div><input type=text placeholder="Search transactions..."><input type=date placeholder="Start Date"><input type=date placeholder="End Date"><button>Download Detailed Report'),U6=ue("<div><button>Summary</button><button>Deposits</button><button>Payments</button><button>Timeline"),H6=ue("<h3>Total Deposits"),Vd=ue("<p>"),C0=ue("<p> transactions"),W6=ue("<h3>Total Payments"),G6=ue("<h3>Net Cash Flow"),Y6=ue("<h3>Check Payments"),K6=ue("<p> checks"),Xc=ue("<div>"),J6=ue("<h3>Accounts & Payment Methods Used"),Q6=ue("<h3>Monthly Cash Flow Trend"),X6=ue("<div><table><thead><tr><th>Month</th><th>Deposits</th><th>Payments</th><th>Net</th></tr></thead><tbody>"),Z6=ue("<h2>Deposits by Type"),eN=ue("<h2>Top Depositors"),tN=ue("<div><table><thead><tr><th>Depositor</th><th>Total Amount</th><th>Count</th><th>Actions</th></tr></thead><tbody>"),rN=ue("<h2>Payments by Category"),nN=ue("<h2>Top Payees"),iN=ue("<div><table><thead><tr><th>Payee</th><th>Category</th><th>Total Amount</th><th>Count</th></tr></thead><tbody>"),oN=ue("<h2>Transaction Timeline"),sN=ue("<div><h1>Detailed Bank Statement Analyzer"),aN=ue("<span>"),lN=ue("<tr><td></td><td></td><td></td><td>"),I0=ue("<div><h4></h4><p></p><p> transactions"),cN=ue("<tr><td></td><td></td><td></td><td><details><summary>View</summary><div>"),uN=ue("<div> - "),dN=ue("<tr><td></td><td><span></span></td><td></td><td>"),hN=ue("<div><div><div></div><div>  </div></div><div><div>");const fN=()=>{const[t,e]=$e(""),[r,n]=$e("summary"),[i,o]=$e(""),[s,a]=$e({start:"",end:""}),[c,u]=zh({list:[]}),f={Utilities:["AT&T","METRO BY T-MOBILE","COMCAST","STREAM ENERGY","NETFLIX","SPECTRUM"],checks:["CHECK"],JPM:["JPM","POVBR"],Transportation:["DRIVE AWAY","TRANPORT","QUICKQUACK","EXXON","SHELL","CHEVRON","UBER","LYFT","U-HAUL","UHAL","LOVE'S"],Lodging:["HOLIDAY INN","MARRIOTT","HILTON","AIRBNB","HOTEL","MOTEL"],"Food & Dining":["GOLDEN CORRAL","MOCTEZUMA","CHINA STAR","RESTAURANT","CAFE","STARBUCKS","BUFFET","GRILL","MARKET","SEAFOOD"],Shopping:["BURLINGTON","WALMART","TARGET","AMAZON","ROSS","KROGER","PUBLIC","AMZN","AMZ"],Financial:["AMERICANFIRSTFIN","LOAN","CREDIT"],Insurance:["INSURANCE","GEICO","STATE FARM"],Rent:["SHAFAII INVESTME"],Medical:["PHARMACY","CVS","WALGREENS","HOSPITAL","CLINIC"],Entertainment:["CINEMA","THEATER","CONCERT"],"Other Services":["BARBER","SALON","SPA","GYM"],Return:["RETURN ITEM "]},y=Q=>{const K=Q.toUpperCase();for(const[Z,k]of Object.entries(f))for(const C of k)if(K.includes(C.toUpperCase()))return Z;return"Other"},v=Q=>{const K=Q.match(/Zelle payment from ([^0-9]+)/i);if(K)return K[1].trim().replace(/[A-Z0-9]{10,}$/,"").trim();if(Q.includes("CHECK"))return"Check Payment";const Z=Q.match(/^([^0-9]+)/);return Z?Z[1].trim():Q.substring(0,30)},p=Q=>{const K=Q.trim().split(`
`),Z=[];console.log(K);for(let k=1;k<K.length;k++){const C=K[k].split(",");if(console.log(C),C.length>=3){const E=parseFloat(C[2]);let M={postingDate:C[0],description:C[1],amount:E};Z.push(M)}}return console.log({transactions:Z}),u("list",Z),Z};Nt(()=>t()?p(t()):[]);const I=Nt(()=>{let Q=c?.list;if((s().start||s().end)&&(Q=Q.filter(K=>{const Z=new Date(K.postingDate),k=s().start?new Date(s().start):new Date("2024-01-01"),C=s().end?new Date(s().end):new Date("2024-12-31");return Z>=k&&Z<=C})),i()){const K=i().toLowerCase();Q=Q.filter(Z=>Z.description.toLowerCase().includes(K)||Math.abs(Z.amount).toString().includes(K))}return Q}),P=Nt(()=>{const Q={deposits:{total:0,count:0,byType:new Map,byPayee:new Map},payments:{total:0,count:0,byType:new Map,byPayee:new Map},checks:{total:0,count:0,transactions:[]},transfers:{total:0,count:0,transactions:[]},dailyBalances:new Map,accountsAffected:new Set};return I().forEach(K=>{const Z=v(K.description);if(console.log({transaction:K}),Q.dailyBalances.set(K.postingDate,K.amount),(K.description.includes("ZELLE")||K.description.includes("QUICKPAY"))&&Q.accountsAffected.add("Zelle Account"),K.description.includes("ACH")&&Q.accountsAffected.add("ACH Network"),K?.description.includes("DEBIT_CARD")&&Q.accountsAffected.add("Debit Card"),K?.description.includes("CHECK")&&Q.accountsAffected.add("Checking Account"),K?.description.includes("TRANSFER")&&Q.accountsAffected.add("Savings Account"),K.amount>0){Q.deposits.total+=K.amount,Q.deposits.count++,Q.deposits.byType.has(K.description)||Q.deposits.byType.set(K.description,{total:0,count:0,transactions:[]});const k=Q.deposits.byType.get(K.description);k.total+=K.amount,k.count++,k.transactions.push(K),Q.deposits.byPayee.has(Z)||Q.deposits.byPayee.set(Z,{name:Z,totalAmount:0,transactionCount:0,transactions:[]});const C=Q.deposits.byPayee.get(Z);C.totalAmount+=K.amount,C.transactionCount++,C.transactions.push(K)}if(K.amount<0){Q.payments.total+=Math.abs(K.amount),Q.payments.count++,Q.payments.byType.has(K.description)||Q.payments.byType.set(K.description,{total:0,count:0,transactions:[]});const k=Q.payments.byType.get(K.description);k.total+=Math.abs(K.amount),k.count++,k.transactions.push(K);const C=y(K.description);Q.payments.byPayee.has(Z)||Q.payments.byPayee.set(Z,{name:Z,totalAmount:0,transactionCount:0,transactions:[],category:C});const E=Q.payments.byPayee.get(Z);E.totalAmount+=Math.abs(K.amount),E.transactionCount++,E.transactions.push(K)}(K.type==="CHECK_PAID"||K.checkNumber)&&(Q.checks.total+=Math.abs(K.amount),Q.checks.count++,Q.checks.transactions.push(K)),(K.description.includes("TRANSFER")||K.description==="ACCT_XFER")&&(Q.transfers.total+=Math.abs(K.amount),Q.transfers.count++,Q.transfers.transactions.push(K))}),console.log(Q),Q}),w=Nt(()=>{const Q=new Map;return I().forEach(K=>{const Z=K.postingDate.substring(0,7);Q.has(Z)||Q.set(Z,{deposits:0,payments:0,net:0});const k=Q.get(Z);K.amount>0?k.deposits+=K.amount:k.payments+=Math.abs(K.amount),k.net=k.deposits-k.payments}),Array.from(Q.entries()).sort((K,Z)=>K[0].localeCompare(Z[0]))}),x=Q=>{const Z=Q.target.files?.[0];if(Z){const k=new FileReader;k.onload=C=>{console.log(C.target?.result),p(C.target?.result)},k.readAsText(Z)}},j=()=>{const Q=P();let K=`# DETAILED BANK STATEMENT ANALYSIS
`;K+=`Generated: ${new Date().toLocaleDateString()}

`,K+=`## EXECUTIVE SUMMARY

`,K+=`- **Total Deposits:** $${Q.deposits.total.toFixed(2)} (${Q.deposits.count} transactions)
`,K+=`- **Total Payments:** $${Q.payments.total.toFixed(2)} (${Q.payments.count} transactions)
`,K+=`- **Net Cash Flow:** $${(Q.deposits.total-Q.payments.total).toFixed(2)}
`,K+=`- **Check Payments:** $${Q.checks.total.toFixed(2)} (${Q.checks.count} checks)
`,K+=`- **Transfers:** $${Q.transfers.total.toFixed(2)} (${Q.transfers.count} transfers)

`,K+=`## ACCOUNTS AFFECTED

`,Q.accountsAffected.forEach(S=>{K+=`- ${S}
`}),K+=`
`,K+=`## DEPOSITS DETAIL

`,K+=`### By Type
`,Q.deposits.byType.forEach((S,b)=>{K+=`- **${b}**: $${S.total.toFixed(2)} (${S.count} transactions)
`}),K+=`
### Top Depositors
`,Array.from(Q.deposits.byPayee.entries()).sort((S,b)=>b[1].totalAmount-S[1].totalAmount).slice(0,20).forEach(([S,b])=>{K+=`- **${S}**: $${b.totalAmount.toFixed(2)} (${b.transactionCount} transactions)
`}),K+=`
## PAYMENTS DETAIL

`,K+=`### By Type
`,Q.payments.byType.forEach((S,b)=>{K+=`- **${b}**: $${S.total.toFixed(2)} (${S.count} transactions)
`}),K+=`
### By Category
`;const k=new Map;Q.payments.byPayee.forEach(S=>{const b=S.category||"Other";k.set(b,(k.get(b)||0)+S.totalAmount)}),Array.from(k.entries()).sort((S,b)=>b[1]-S[1]).forEach(([S,b])=>{K+=`- **${S}**: $${b.toFixed(2)}
`}),K+=`
### Top Payees
`,Array.from(Q.payments.byPayee.entries()).sort((S,b)=>b[1].totalAmount-S[1].totalAmount).slice(0,20).forEach(([S,b])=>{K+=`- **${S}** (${b.category}): $${b.totalAmount.toFixed(2)} (${b.transactionCount} transactions)
`}),K+=`
## MONTHLY CASH FLOW TREND

`,w().forEach(([S,b])=>{K+=`- **${S}**: Deposits: $${b.deposits.toFixed(2)} | Payments: $${b.payments.toFixed(2)} | Net: $${b.net.toFixed(2)}
`}),Q.checks.transactions.length>0&&(K+=`
## CHECK PAYMENTS DETAIL

`,Q.checks.transactions.forEach(S=>{K+=`- Check #${S.checkNumber||"N/A"} - ${S.postingDate} - $${Math.abs(S.amount).toFixed(2)}
`}));const E=new Blob([K],{type:"text/markdown"}),M=URL.createObjectURL(E),_=document.createElement("a");_.href=M,_.download=`detailed_bank_analysis_${new Date().toISOString().split("T")[0]}.md`,_.click(),URL.revokeObjectURL(M)},ne=Q=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Q);return(()=>{var Q=sN(),K=Q.firstChild;return Q.style.setProperty("padding","2rem"),K.style.setProperty("margin-bottom","2rem"),l(Q,B(Tt,{style:{"margin-bottom":"2rem"},get children(){return[j6(),(()=>{var Z=V6();return Z.addEventListener("change",x),Z.style.setProperty("margin-top","1rem"),Z})()]}}),null),l(Q,B(Ge,{get when(){return c?.list},get children(){return[B(Tt,{style:{"margin-bottom":"2rem"},get children(){return[z6(),(()=>{var Z=q6(),k=Z.firstChild,C=k.nextSibling,E=C.nextSibling,M=E.nextSibling;return Z.style.setProperty("display","flex"),Z.style.setProperty("gap","1rem"),Z.style.setProperty("margin-top","1rem"),Z.style.setProperty("flex-wrap","wrap"),k.$$input=_=>o(_.currentTarget.value),k.style.setProperty("flex","1"),k.style.setProperty("min-width","200px"),k.style.setProperty("padding","0.5rem"),C.$$input=_=>a({...s(),start:_.currentTarget.value}),E.$$input=_=>a({...s(),end:_.currentTarget.value}),M.$$click=j,M.style.setProperty("padding","0.5rem 1rem"),M.style.setProperty("background","var(--primary-color)"),M.style.setProperty("color","white"),M.style.setProperty("border","none"),M.style.setProperty("border-radius","var(--border-radius-sm)"),M.style.setProperty("cursor","pointer"),Se(()=>k.value=i()),Se(()=>C.value=s().start),Se(()=>E.value=s().end),Z})()]}}),(()=>{var Z=U6(),k=Z.firstChild,C=k.nextSibling,E=C.nextSibling,M=E.nextSibling;return Z.style.setProperty("display","flex"),Z.style.setProperty("gap","1rem"),Z.style.setProperty("margin-bottom","2rem"),k.$$click=()=>n("summary"),k.style.setProperty("padding","0.5rem 1rem"),k.style.setProperty("border","none"),k.style.setProperty("border-radius","var(--border-radius-sm)"),k.style.setProperty("cursor","pointer"),C.$$click=()=>n("deposits"),C.style.setProperty("padding","0.5rem 1rem"),C.style.setProperty("border","none"),C.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("cursor","pointer"),E.$$click=()=>n("payments"),E.style.setProperty("padding","0.5rem 1rem"),E.style.setProperty("border","none"),E.style.setProperty("border-radius","var(--border-radius-sm)"),E.style.setProperty("cursor","pointer"),M.$$click=()=>n("timeline"),M.style.setProperty("padding","0.5rem 1rem"),M.style.setProperty("border","none"),M.style.setProperty("border-radius","var(--border-radius-sm)"),M.style.setProperty("cursor","pointer"),Se(_=>{var S=r()==="summary"?"var(--primary-color)":"#e9ecef",b=r()==="summary"?"white":"black",Y=r()==="deposits"?"var(--primary-color)":"#e9ecef",te=r()==="deposits"?"white":"black",O=r()==="payments"?"var(--primary-color)":"#e9ecef",D=r()==="payments"?"white":"black",X=r()==="timeline"?"var(--primary-color)":"#e9ecef",H=r()==="timeline"?"white":"black";return S!==_.e&&((_.e=S)!=null?k.style.setProperty("background",S):k.style.removeProperty("background")),b!==_.t&&((_.t=b)!=null?k.style.setProperty("color",b):k.style.removeProperty("color")),Y!==_.a&&((_.a=Y)!=null?C.style.setProperty("background",Y):C.style.removeProperty("background")),te!==_.o&&((_.o=te)!=null?C.style.setProperty("color",te):C.style.removeProperty("color")),O!==_.i&&((_.i=O)!=null?E.style.setProperty("background",O):E.style.removeProperty("background")),D!==_.n&&((_.n=D)!=null?E.style.setProperty("color",D):E.style.removeProperty("color")),X!==_.s&&((_.s=X)!=null?M.style.setProperty("background",X):M.style.removeProperty("background")),H!==_.h&&((_.h=H)!=null?M.style.setProperty("color",H):M.style.removeProperty("color")),_},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),Z})(),B(Ge,{get when(){return r()==="summary"},get children(){return[(()=>{var Z=Xc();return Z.style.setProperty("display","grid"),Z.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),Z.style.setProperty("gap","1rem"),Z.style.setProperty("margin-bottom","2rem"),l(Z,B(Tt,{get children(){return[H6(),(()=>{var k=Vd();return k.style.setProperty("font-size","2rem"),k.style.setProperty("font-weight","bold"),k.style.setProperty("color","#22c55e"),l(k,()=>ne(P().deposits.total)),k})(),(()=>{var k=C0(),C=k.firstChild;return k.style.setProperty("color","#6c757d"),l(k,()=>P().deposits.count,C),k})()]}}),null),l(Z,B(Tt,{get children(){return[W6(),(()=>{var k=Vd();return k.style.setProperty("font-size","2rem"),k.style.setProperty("font-weight","bold"),k.style.setProperty("color","#ef4444"),l(k,()=>ne(P().payments.total)),k})(),(()=>{var k=C0(),C=k.firstChild;return k.style.setProperty("color","#6c757d"),l(k,()=>P().payments.count,C),k})()]}}),null),l(Z,B(Tt,{get children(){return[G6(),(()=>{var k=Vd();return k.style.setProperty("font-size","2rem"),k.style.setProperty("font-weight","bold"),l(k,()=>ne(P().deposits.total-P().payments.total)),Se(C=>(C=P().deposits.total-P().payments.total>=0?"#22c55e":"#ef4444")!=null?k.style.setProperty("color",C):k.style.removeProperty("color")),k})()]}}),null),l(Z,B(Tt,{get children(){return[Y6(),(()=>{var k=Vd();return k.style.setProperty("font-size","2rem"),k.style.setProperty("font-weight","bold"),k.style.setProperty("color","#3b82f6"),l(k,()=>ne(P().checks.total)),k})(),(()=>{var k=K6(),C=k.firstChild;return k.style.setProperty("color","#6c757d"),l(k,()=>P().checks.count,C),k})()]}}),null),Z})(),B(Tt,{style:{"margin-bottom":"2rem"},get children(){return[J6(),(()=>{var Z=Xc();return Z.style.setProperty("display","flex"),Z.style.setProperty("flex-wrap","wrap"),Z.style.setProperty("gap","0.5rem"),Z.style.setProperty("margin-top","1rem"),l(Z,B(Ht,{get each(){return Array.from(P().accountsAffected)},children:k=>(()=>{var C=aN();return C.style.setProperty("padding","0.25rem 0.75rem"),C.style.setProperty("background","#e9ecef"),C.style.setProperty("border-radius","9999px"),C.style.setProperty("font-size","0.875rem"),l(C,k),C})()})),Z})()]}}),B(Tt,{get children(){return[Q6(),(()=>{var Z=X6(),k=Z.firstChild,C=k.firstChild,E=C.firstChild,M=E.firstChild,_=M.nextSibling,S=_.nextSibling,b=S.nextSibling,Y=C.nextSibling;return Z.style.setProperty("overflow-x","auto"),k.style.setProperty("width","100%"),k.style.setProperty("border-collapse","collapse"),k.style.setProperty("margin-top","1rem"),E.style.setProperty("border-bottom","2px solid #dee2e6"),M.style.setProperty("padding","0.75rem"),M.style.setProperty("text-align","left"),_.style.setProperty("padding","0.75rem"),_.style.setProperty("text-align","right"),S.style.setProperty("padding","0.75rem"),S.style.setProperty("text-align","right"),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","right"),l(Y,B(Ht,{get each(){return w()},children:([te,O])=>(()=>{var D=lN(),X=D.firstChild,H=X.nextSibling,F=H.nextSibling,ie=F.nextSibling;return D.style.setProperty("border-bottom","1px solid #dee2e6"),X.style.setProperty("padding","0.75rem"),l(X,te),H.style.setProperty("padding","0.75rem"),H.style.setProperty("text-align","right"),H.style.setProperty("color","#22c55e"),l(H,()=>ne(isNaN(O.deposits)?0:O.deposits)),F.style.setProperty("padding","0.75rem"),F.style.setProperty("text-align","right"),F.style.setProperty("color","#ef4444"),l(F,()=>ne(isNaN(O.payments)?0:O.payments)),ie.style.setProperty("padding","0.75rem"),ie.style.setProperty("text-align","right"),ie.style.setProperty("font-weight","bold"),l(ie,()=>ne(O.net)),Se($=>($=O.net>=0?"#22c55e":"#ef4444")!=null?ie.style.setProperty("color",$):ie.style.removeProperty("color")),D})()})),Z})()]}})]}}),B(Ge,{get when(){return r()==="deposits"},get children(){return[B(Tt,{style:{"margin-bottom":"2rem"},get children(){return[Z6(),(()=>{var Z=Xc();return Z.style.setProperty("display","grid"),Z.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(300px, 1fr))"),Z.style.setProperty("gap","1rem"),Z.style.setProperty("margin-top","1rem"),l(Z,B(Ht,{get each(){return Array.from(P().deposits.byType.entries())},children:([k,C])=>(()=>{var E=I0(),M=E.firstChild,_=M.nextSibling,S=_.nextSibling,b=S.firstChild;return E.style.setProperty("padding","1rem"),E.style.setProperty("background","#f8f9fa"),E.style.setProperty("border-radius","var(--border-radius-sm)"),E.style.setProperty("border","1px solid #e9ecef"),l(M,k),_.style.setProperty("font-size","1.5rem"),_.style.setProperty("font-weight","bold"),_.style.setProperty("color","#22c55e"),l(_,()=>ne(C.total)),S.style.setProperty("color","#6c757d"),l(S,()=>C.count,b),E})()})),Z})()]}}),B(Tt,{get children(){return[eN(),(()=>{var Z=tN(),k=Z.firstChild,C=k.firstChild,E=C.firstChild,M=E.firstChild,_=M.nextSibling,S=_.nextSibling,b=S.nextSibling,Y=C.nextSibling;return Z.style.setProperty("overflow-x","auto"),k.style.setProperty("width","100%"),k.style.setProperty("border-collapse","collapse"),k.style.setProperty("margin-top","1rem"),E.style.setProperty("border-bottom","2px solid #dee2e6"),M.style.setProperty("padding","0.75rem"),M.style.setProperty("text-align","left"),_.style.setProperty("padding","0.75rem"),_.style.setProperty("text-align","right"),S.style.setProperty("padding","0.75rem"),S.style.setProperty("text-align","center"),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","center"),l(Y,B(Ht,{get each(){return Array.from(P().deposits.byPayee.entries()).sort((te,O)=>O[1].totalAmount-te[1].totalAmount).slice(0,20)},children:([te,O])=>(()=>{var D=cN(),X=D.firstChild,H=X.nextSibling,F=H.nextSibling,ie=F.nextSibling,$=ie.firstChild,L=$.firstChild,U=L.nextSibling;return D.style.setProperty("border-bottom","1px solid #dee2e6"),X.style.setProperty("padding","0.75rem"),l(X,te),H.style.setProperty("padding","0.75rem"),H.style.setProperty("text-align","right"),H.style.setProperty("color","#22c55e"),H.style.setProperty("font-weight","bold"),l(H,()=>ne(O.totalAmount)),F.style.setProperty("padding","0.75rem"),F.style.setProperty("text-align","center"),l(F,()=>O.transactionCount),ie.style.setProperty("padding","0.75rem"),ie.style.setProperty("text-align","center"),L.style.setProperty("cursor","pointer"),U.style.setProperty("margin-top","0.5rem"),U.style.setProperty("font-size","0.875rem"),l(U,B(Ht,{get each(){return O.transactions.slice(0,5)},children:N=>(()=>{var z=uN(),oe=z.firstChild;return z.style.setProperty("padding","0.25rem"),l(z,()=>N.postingDate,oe),l(z,()=>ne(N.amount),null),z})()})),D})()})),Z})()]}})]}}),B(Ge,{get when(){return r()==="payments"},get children(){return[B(Tt,{style:{"margin-bottom":"2rem"},get children(){return[rN(),(()=>{var Z=Xc();return Z.style.setProperty("display","grid"),Z.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),Z.style.setProperty("gap","1rem"),Z.style.setProperty("margin-top","1rem"),l(Z,()=>{const k=new Map;return P().payments.byPayee.forEach(C=>{const E=C.category||"Other";k.has(E)||k.set(E,{total:0,count:0});const M=k.get(E);M.total+=C.totalAmount,M.count+=C.transactionCount}),Array.from(k.entries()).sort((C,E)=>E[1].total-C[1].total).map(([C,E])=>(()=>{var M=I0(),_=M.firstChild,S=_.nextSibling,b=S.nextSibling,Y=b.firstChild;return M.style.setProperty("padding","1rem"),M.style.setProperty("background","#f8f9fa"),M.style.setProperty("border-radius","var(--border-radius-sm)"),M.style.setProperty("border","1px solid #e9ecef"),l(_,C),S.style.setProperty("font-size","1.5rem"),S.style.setProperty("font-weight","bold"),S.style.setProperty("color","#ef4444"),l(S,()=>ne(E.total)),b.style.setProperty("color","#6c757d"),l(b,()=>E.count,Y),M})())}),Z})()]}}),B(Tt,{get children(){return[nN(),(()=>{var Z=iN(),k=Z.firstChild,C=k.firstChild,E=C.firstChild,M=E.firstChild,_=M.nextSibling,S=_.nextSibling,b=S.nextSibling,Y=C.nextSibling;return Z.style.setProperty("overflow-x","auto"),k.style.setProperty("width","100%"),k.style.setProperty("border-collapse","collapse"),k.style.setProperty("margin-top","1rem"),E.style.setProperty("border-bottom","2px solid #dee2e6"),M.style.setProperty("padding","0.75rem"),M.style.setProperty("text-align","left"),_.style.setProperty("padding","0.75rem"),_.style.setProperty("text-align","left"),S.style.setProperty("padding","0.75rem"),S.style.setProperty("text-align","right"),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","center"),l(Y,B(Ht,{get each(){return Array.from(P().payments.byPayee.entries()).sort((te,O)=>O[1].totalAmount-te[1].totalAmount).slice(0,130)},children:([te,O])=>(()=>{var D=dN(),X=D.firstChild,H=X.nextSibling,F=H.firstChild,ie=H.nextSibling,$=ie.nextSibling;return D.style.setProperty("border-bottom","1px solid #dee2e6"),X.style.setProperty("padding","0.75rem"),l(X,te),H.style.setProperty("padding","0.75rem"),F.style.setProperty("padding","0.25rem 0.5rem"),F.style.setProperty("background","#e9ecef"),F.style.setProperty("border-radius","4px"),F.style.setProperty("font-size","0.875rem"),l(F,()=>O.category),ie.style.setProperty("padding","0.75rem"),ie.style.setProperty("text-align","right"),ie.style.setProperty("color","#ef4444"),ie.style.setProperty("font-weight","bold"),l(ie,()=>ne(O.totalAmount)),$.style.setProperty("padding","0.75rem"),$.style.setProperty("text-align","center"),l($,()=>O.transactionCount),D})()})),Z})()]}})]}}),B(Ge,{get when(){return r()==="timeline"},get children(){return B(Tt,{get children(){return[oN(),(()=>{var Z=Xc();return Z.style.setProperty("max-height","600px"),Z.style.setProperty("overflow-y","auto"),Z.style.setProperty("margin-top","1rem"),l(Z,B(Ht,{get each(){return I().slice(0,100)},children:k=>(()=>{var C=hN(),E=C.firstChild,M=E.firstChild,_=M.nextSibling,S=_.firstChild,b=E.nextSibling,Y=b.firstChild;return C.style.setProperty("padding","1rem"),C.style.setProperty("border-bottom","1px solid #e9ecef"),C.style.setProperty("display","flex"),C.style.setProperty("justify-content","space-between"),C.style.setProperty("align-items","center"),E.style.setProperty("flex","1"),M.style.setProperty("font-weight","bold"),l(M,()=>k.description),_.style.setProperty("font-size","0.875rem"),_.style.setProperty("color","#6c757d"),l(_,()=>k.postingDate,S),l(_,()=>k.type,null),l(_,()=>k.checkNumber&&`  Check #${k.checkNumber}`,null),b.style.setProperty("text-align","right"),Y.style.setProperty("font-weight","bold"),Y.style.setProperty("font-size","1.1rem"),l(Y,()=>ne(Math.abs(k.amount)),null),l(Y,()=>k.amount>=0?" ":" ",null),Se(te=>(te=k.amount>=0?"#22c55e":"#ef4444")!=null?Y.style.setProperty("color",te):Y.style.removeProperty("color")),C})()})),Z})()]}})}})]}}),null),Q})()};ur(["input","click"]);var pN=ue("<div><div></div><div>"),sp=ue("<div>"),mN=ue("<div>  <!>  <!> "),yN=ue("<div><div><div></div><div></div></div><div><div></div><div>"),gN=ue("<div><div>:"),vN=ue("<div> <!>: <!> <!>, <!> "),bN=ue("<div><div><div></div><div></div></div><div>"),$0=ue("<div> "),_N=ue("<div> ");const wN=t=>{const{t:e}=tr(),r={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},n={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},i={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},o={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"0.5rem"},s={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"1rem"},a={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},c={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},u={"max-height":"100px","overflow-y":"auto","border-top":"1px solid var(--border-color)","padding-top":"1rem"},f={display:"flex","justify-content":"space-between","align-items":"center","font-size":"0.875rem","margin-bottom":"0.5rem"},y={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},v=x=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[x],p=x=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(x),I=x=>new Date(x).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),P=v(t.entry.status),w=Math.abs(t.entry.totalDebit-t.entry.totalCredit)<.01;return B(Tt,{get children(){return[(()=>{var x=pN(),j=x.firstChild,ne=j.nextSibling;return m(x,r),m(j,n),l(j,()=>t.entry.entryNumber),l(ne,()=>t.entry.status),Se(Q=>m(ne,{...i,background:P.bg,color:P.color},Q)),x})(),(()=>{var x=sp();return m(x,o),l(x,()=>t.entry.description),x})(),(()=>{var x=mN(),j=x.firstChild,ne=j.nextSibling,Q=ne.nextSibling,K=Q.nextSibling;return K.nextSibling,m(x,s),l(x,()=>I(t.entry.date),j),l(x,()=>t.entry.reference||e("journal.noReference","No reference"),ne),l(x,()=>e("journal.createdBy","By"),K),l(x,()=>t.entry.createdBy,null),x})(),(()=>{var x=yN(),j=x.firstChild,ne=j.firstChild,Q=ne.nextSibling,K=j.nextSibling,Z=K.firstChild,k=Z.nextSibling;return m(x,a),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-muted)"),l(ne,()=>e("journal.totalAmount","Total Amount")),m(Q,c),l(Q,()=>p(t.entry.totalDebit)),K.style.setProperty("text-align","right"),Z.style.setProperty("font-size","0.875rem"),Z.style.setProperty("color","var(--text-muted)"),l(Z,()=>e("journal.lines","Lines")),k.style.setProperty("font-weight","600"),l(k,()=>t.entry.lines.length),x})(),Te(()=>!w&&(()=>{var x=vN(),j=x.firstChild,ne=j.nextSibling,Q=ne.nextSibling,K=Q.nextSibling,Z=K.nextSibling,k=Z.nextSibling,C=k.nextSibling,E=C.nextSibling;return E.nextSibling,x.style.setProperty("padding","0.5rem"),x.style.setProperty("border-radius","var(--border-radius-sm)"),x.style.setProperty("background","#f8d7da"),x.style.setProperty("color","#721c24"),x.style.setProperty("font-size","0.875rem"),x.style.setProperty("margin-bottom","1rem"),l(x,()=>e("journal.entryNotBalancedShort","Entry is not balanced"),ne),l(x,()=>e("journal.debit"),K),l(x,()=>p(t.entry.totalDebit),k),l(x,()=>e("journal.credit"),E),l(x,()=>p(t.entry.totalCredit),null),x})()),(()=>{var x=gN(),j=x.firstChild,ne=j.firstChild;return m(x,u),j.style.setProperty("font-weight","500"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-size","0.875rem"),l(j,()=>e("journal.accountLines","Account Lines"),ne),l(x,()=>t.entry.lines.slice(0,3).map(Q=>(()=>{var K=bN(),Z=K.firstChild,k=Z.firstChild,C=k.nextSibling,E=Z.nextSibling;return m(K,f),Z.style.setProperty("flex","1"),k.style.setProperty("font-weight","500"),l(k,()=>Q.accountName),C.style.setProperty("font-size","0.75rem"),C.style.setProperty("color","var(--text-muted)"),l(C,()=>Q.description||e("journal.noDescription","No description")),E.style.setProperty("text-align","right"),l(E,(()=>{var M=Te(()=>Q.debitAmount>0);return()=>M()&&(()=>{var _=$0(),S=_.firstChild;return _.style.setProperty("color","#4caf50"),_.style.setProperty("font-weight","500"),l(_,()=>e("journal.debitShort","Dr."),S),l(_,()=>p(Q.debitAmount),null),_})()})(),null),l(E,(()=>{var M=Te(()=>Q.creditAmount>0);return()=>M()&&(()=>{var _=$0(),S=_.firstChild;return _.style.setProperty("color","#f44336"),_.style.setProperty("font-weight","500"),l(_,()=>e("journal.creditShort","Cr."),S),l(_,()=>p(Q.creditAmount),null),_})()})(),null),l(E,(()=>{var M=Te(()=>!!Q.reconciled);return()=>M()&&(()=>{var _=_N();return _.firstChild,_.style.setProperty("font-size","0.75rem"),_.style.setProperty("color","#4caf50"),l(_,()=>e("banking.reconciled","Reconciled"),null),_})()})(),null),K})()),null),l(x,(()=>{var Q=Te(()=>t.entry.lines.length>3);return()=>Q()&&(()=>{var K=sp();return K.style.setProperty("text-align","center"),K.style.setProperty("color","var(--text-muted)"),K.style.setProperty("font-size","0.875rem"),l(K,()=>e("journal.andMoreLines","... and {count} more lines").replace("{count}",(t.entry.lines.length-3).toString())),K})()})(),null),x})(),(()=>{var x=sp();return m(x,y),l(x,B(Pt,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.entry),get children(){return e("journal.viewDetails","View Details")}})),x})()]}})},SN=[{id:"je1",entryNumber:"JE-2024-001",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",status:"posted",createdBy:"John Doe",createdAt:"2024-01-15T09:00:00Z",postedAt:"2024-01-15T09:05:00Z",totalDebit:5e3,totalCredit:5e3,lines:[{id:"jel1",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment from ABC Corp",debitAmount:5e3,creditAmount:0,reconciled:!0,reconciledWith:"eb1"},{id:"jel2",accountId:"2001",accountName:"Trade Receivables",description:"Payment received for INV-2024-001",debitAmount:0,creditAmount:5e3}]},{id:"je2",entryNumber:"JE-2024-002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",status:"posted",createdBy:"Jane Smith",createdAt:"2024-01-14T10:00:00Z",postedAt:"2024-01-14T10:15:00Z",totalDebit:250,totalCredit:250,lines:[{id:"jel3",accountId:"5200",accountName:"Office Expenses",description:"Office supplies from Staples",debitAmount:250,creditAmount:0},{id:"jel4",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment to Staples",debitAmount:0,creditAmount:250,reconciled:!0,reconciledWith:"eb2"}]},{id:"je3",entryNumber:"JE-2024-003",date:"2024-01-13",description:"Monthly Rent Payment",reference:"RENT-2024-01",status:"posted",createdBy:"John Doe",createdAt:"2024-01-13T08:00:00Z",postedAt:"2024-01-13T08:30:00Z",totalDebit:2e3,totalCredit:2e3,lines:[{id:"jel5",accountId:"5200",accountName:"Rent Expense",description:"January office rent",debitAmount:2e3,creditAmount:0},{id:"jel6",accountId:"1002",accountName:"Bank - Checking Account",description:"Rent payment",debitAmount:0,creditAmount:2e3,reconciled:!1}]},{id:"je4",entryNumber:"JE-2024-004",date:"2024-01-12",description:"Wire Transfer - Capital Investment",reference:"WIRE-001",status:"posted",createdBy:"Admin",createdAt:"2024-01-12T14:00:00Z",postedAt:"2024-01-12T14:30:00Z",totalDebit:1e4,totalCredit:1e4,lines:[{id:"jel7",accountId:"1002",accountName:"Bank - Checking Account",description:"Wire transfer received",debitAmount:1e4,creditAmount:0,reconciled:!1},{id:"jel8",accountId:"8",accountName:"Owner's Equity",description:"Capital investment",debitAmount:0,creditAmount:1e4}]},{id:"je5",entryNumber:"JE-2024-005",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",status:"posted",createdBy:"HR Manager",createdAt:"2024-01-11T16:00:00Z",postedAt:"2024-01-11T16:30:00Z",totalDebit:3500,totalCredit:3500,lines:[{id:"jel9",accountId:"13",accountName:"Salaries Expense",description:"Monthly salary - John Doe",debitAmount:3500,creditAmount:0},{id:"jel10",accountId:"1002",accountName:"Bank - Checking Account",description:"Salary payment",debitAmount:0,creditAmount:3500,reconciled:!1}]},{id:"je6",entryNumber:"JE-2024-006",date:"2024-01-10",description:"Product Sales - Multiple Customers",reference:"SALES-2024-010",status:"posted",createdBy:"Sales Manager",createdAt:"2024-01-10T11:00:00Z",postedAt:"2024-01-10T11:30:00Z",totalDebit:8500,totalCredit:8500,lines:[{id:"jel11",accountId:"1001",accountName:"Petty Cash",description:"Cash sales",debitAmount:1500,creditAmount:0},{id:"jel12",accountId:"2001",accountName:"Trade Receivables",description:"Credit sales",debitAmount:7e3,creditAmount:0},{id:"jel13",accountId:"10",accountName:"Sales Revenue",description:"Product sales revenue",debitAmount:0,creditAmount:8500}]},{id:"je7",entryNumber:"JE-2024-007",date:"2024-01-09",description:"Inventory Purchase",reference:"PO-2024-002",status:"draft",createdBy:"Warehouse Manager",createdAt:"2024-01-09T15:00:00Z",totalDebit:15e3,totalCredit:15e3,lines:[{id:"jel14",accountId:"3",accountName:"Inventory",description:"Product inventory purchase",debitAmount:15e3,creditAmount:0},{id:"jel15",accountId:"5",accountName:"Accounts Payable",description:"Amount owed to supplier",debitAmount:0,creditAmount:15e3}]},{id:"je8",entryNumber:"JE-2024-008",date:"2024-01-08",description:"Utility Bills Payment",reference:"UTIL-2024-01",status:"posted",createdBy:"Admin",createdAt:"2024-01-08T09:00:00Z",postedAt:"2024-01-08T09:30:00Z",totalDebit:450,totalCredit:450,lines:[{id:"jel16",accountId:"14",accountName:"Operating Expenses",description:"Electricity and water bills",debitAmount:450,creditAmount:0},{id:"jel17",accountId:"1003",accountName:"Bank - Savings Account",description:"Utility payment",debitAmount:0,creditAmount:450}]}],[Xi,ap]=$e(SN),k0=()=>Xi().filter(e=>e.status==="posted").flatMap(e=>e.lines.filter(r=>["1001","1002","1003"].includes(r.accountId))).map(e=>{const r=Xi().find(n=>n.lines.some(i=>i.id===e.id));return r?{id:`eb_${e.id}`,accountId:e.accountId,date:r.date,description:r.description,reference:r.reference,debitAmount:e.debitAmount,creditAmount:e.creditAmount,category:e.accountName,isReconciled:e.reconciled||!1,reconciledWith:e.reconciledWith,createdAt:r.createdAt}:null}).filter(e=>e!==null),ks={get journalEntries(){return Xi()},addJournalEntry(t){const e={...t,id:Date.now().toString()};return ap([...Xi(),e]),e},updateJournalEntry(t,e){ap(Xi().map(r=>r.id===t?{...r,...e}:r))},deleteJournalEntry(t){const e=Xi().find(r=>r.id===t);if(e&&e.status==="posted")throw new Error("Cannot delete posted journal entries. Void them instead.");ap(Xi().filter(r=>r.id!==t))},voidJournalEntry(t){this.updateJournalEntry(t,{status:"void"})},postJournalEntry(t){const e=Xi().find(r=>r.id===t);if(!e)throw new Error("Journal entry not found");if(Math.abs(e.totalDebit-e.totalCredit)>.01)throw new Error("Journal entry is not balanced. Debits must equal credits.");this.updateJournalEntry(t,{status:"posted",postedAt:new Date().toISOString()}),k0()},getJournalEntryById(t){return Xi().find(e=>e.id===t)},getJournalEntriesByStatus(t){return Xi().filter(e=>e.status===t)},getJournalEntriesByDateRange(t,e){return Xi().filter(r=>r.date>=t&&r.date<=e)},getJournalEntriesByAccount(t){return Xi().filter(e=>e.lines.some(r=>r.accountId===t))},getNextEntryNumber(){const t=new Date().getFullYear(),r=Xi().filter(n=>n.entryNumber.includes(t.toString())).reduce((n,i)=>{const o=parseInt(i.entryNumber.split("-").pop()||"0");return o>n?o:n},0);return`JE-${t}-${String(r+1).padStart(3,"0")}`},validateJournalEntry(t){const e=[];if(t.date||e.push("Date is required"),t.description||e.push("Description is required"),(!t.lines||t.lines.length===0)&&e.push("At least one line item is required"),t.lines){const r=t.lines.reduce((i,o)=>i+(o.debitAmount||0),0),n=t.lines.reduce((i,o)=>i+(o.creditAmount||0),0);Math.abs(r-n)>.01&&e.push(`Entry is not balanced. Debit: ${r}, Credit: ${n}`),t.lines.forEach((i,o)=>{i.accountId||e.push(`Line ${o+1}: Account is required`),i.debitAmount===0&&i.creditAmount===0&&e.push(`Line ${o+1}: Either debit or credit amount must be provided`),i.debitAmount>0&&i.creditAmount>0&&e.push(`Line ${o+1}: Cannot have both debit and credit amounts`)})}return{isValid:e.length===0,errors:e}},getBankRelatedEntries(){return k0()}};var PN=ue("<form><div></div><div><div><h4></h4></div><div><div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div></div></div><div><div><strong>: </strong></div><div><strong>: </strong></div><div></div></div></div><div>"),E0=ue("<div>");const x5=t=>{const{t:e}=tr(),[r,n]=$e({entryNumber:"",date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),[i,o]=$e([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),[s,a]=$e(null);vo(()=>{if(t.isOpen){if(t.editEntry)n({entryNumber:t.editEntry.entryNumber,date:t.editEntry.date,description:t.editEntry.description,reference:t.editEntry.reference,createdBy:t.editEntry.createdBy}),o(t.editEntry.lines.map((Q,K)=>({...Q,tempId:`line_${Date.now()}_${K}`})));else{const Q=ks.getNextEntryNumber();n({entryNumber:Q,date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),o([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])}a(null)}});const c={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},u={display:"grid","grid-template-columns":"2fr 2fr 1fr 1fr 1fr",gap:"1rem","align-items":"end","margin-bottom":"1rem",padding:"1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},f={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},y=()=>kr.accounts.map(Q=>({value:Q.id,label:`${Q.accountNumber} - ${Q.name}`})),v=(Q,K)=>{n(Z=>({...Z,[Q]:K}))},p=(Q,K,Z)=>{o(k=>k.map(C=>{if(C.tempId===Q){const E={...C,[K]:Z};if(K==="accountId"&&typeof Z=="string"){const M=kr.getAccountById(Z);M&&(E.accountName=M.name)}return E}return C}))},I=()=>{o(Q=>[...Q,{tempId:`line_${Date.now()}_${Q.length}`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])},P=Q=>{i().length>2&&o(K=>K.filter(Z=>Z.tempId!==Q))},w=()=>{const Q=i().reduce((Z,k)=>Z+(k.debitAmount||0),0),K=i().reduce((Z,k)=>Z+(k.creditAmount||0),0);return{totalDebit:Q,totalCredit:K,isBalanced:Math.abs(Q-K)<.01}},x=Q=>{Q.preventDefault(),a(null);const K=r(),Z=i(),{totalDebit:k,totalCredit:C,isBalanced:E}=w();if(!K.description){a(e("forms.descriptionRequired","Description is required"));return}if(Z.length<2){a(e("journal.minTwoLinesRequired","At least 2 line items are required"));return}if(!E){a(e("journal.entryNotBalanced","Entry is not balanced. Debit: ${debit}, Credit: ${credit}").replace("${debit}",`$${k.toFixed(2)}`).replace("${credit}",`$${C.toFixed(2)}`));return}for(let _=0;_<Z.length;_++){const S=Z[_];if(!S.accountId){a(e("journal.lineAccountRequired","Line {lineNumber}: Account is required").replace("{lineNumber}",(_+1).toString()));return}if(S.debitAmount===0&&S.creditAmount===0){a(e("journal.lineAmountRequired","Line {lineNumber}: Either debit or credit amount must be provided").replace("{lineNumber}",(_+1).toString()));return}if((S.debitAmount||0)>0&&(S.creditAmount||0)>0){a(e("journal.lineBothAmounts","Line {lineNumber}: Cannot have both debit and credit amounts").replace("{lineNumber}",(_+1).toString()));return}}const M={entryNumber:K.entryNumber,date:K.date,description:K.description,reference:K.reference,status:"draft",createdBy:K.createdBy,createdAt:new Date().toISOString(),totalDebit:k,totalCredit:C,lines:Z.map((_,S)=>{const{tempId:b,...Y}=_;return{id:`jel_${Date.now()}_${S}`,...Y}})};try{t.editEntry?ks.updateJournalEntry(t.editEntry.id,M):ks.addJournalEntry(M),n({entryNumber:ks.getNextEntryNumber(),date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),o([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),t.onClose()}catch(_){a(_ instanceof Error?_.message:e("forms.errorOccurred","An error occurred"))}},j=Q=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Q),ne=w();return B(Qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return Te(()=>!!t.editEntry)()?e("journal.editEntry"):e("journal.addEntry","Add Journal Entry")},get children(){var Q=PN(),K=Q.firstChild,Z=K.nextSibling,k=Z.firstChild,C=k.firstChild,E=k.nextSibling,M=E.firstChild,_=M.firstChild,S=_.firstChild,b=_.nextSibling,Y=b.firstChild,te=b.nextSibling,O=te.firstChild,D=te.nextSibling,X=D.firstChild,H=D.nextSibling,F=H.firstChild,ie=E.nextSibling,$=ie.firstChild,L=$.firstChild,U=L.firstChild,N=$.nextSibling,z=N.firstChild,oe=z.firstChild,G=N.nextSibling,ee=Z.nextSibling;return Q.addEventListener("submit",x),K.style.setProperty("display","grid"),K.style.setProperty("grid-template-columns","1fr 1fr"),K.style.setProperty("gap","1rem"),l(K,B(Or,{get label(){return e("journal.entryNumber")},get value(){return r().entryNumber},onChange:J=>v("entryNumber",J),get disabled(){return!!t.editEntry},required:!0}),null),l(K,B(Or,{get label(){return e("common.date")},type:"date",get value(){return r().date},onChange:J=>v("date",J),required:!0}),null),l(Q,B(Or,{get label(){return e("common.description")},get value(){return r().description},onChange:J=>v("description",J),get placeholder(){return e("journal.enterEntryDescription","Enter journal entry description")},required:!0}),Z),l(Q,B(Or,{get label(){return e("journal.reference")},get value(){return r().reference},onChange:J=>v("reference",J),get placeholder(){return e("journal.enterReferenceNumber","Enter reference number")}}),Z),Z.style.setProperty("margin-top","2rem"),k.style.setProperty("display","flex"),k.style.setProperty("justify-content","space-between"),k.style.setProperty("align-items","center"),k.style.setProperty("margin-bottom","1rem"),C.style.setProperty("margin","0"),l(C,()=>e("journal.entryLines","Journal Entry Lines")),l(k,B(Pt,{type:"button",variant:"secondary",size:"sm",onClick:I,get children(){return e("journal.addLine","Add Line")}}),null),E.style.setProperty("margin-bottom","1rem"),E.style.setProperty("font-size","0.875rem"),E.style.setProperty("color","var(--text-muted)"),M.style.setProperty("display","grid"),M.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1fr"),M.style.setProperty("gap","1rem"),l(S,()=>e("journal.account")),l(Y,()=>e("common.description")),l(O,()=>e("journal.debit")),l(X,()=>e("journal.credit")),l(F,()=>e("common.actions")),l(Z,B(Ht,{get each(){return i()},children:J=>(()=>{var W=E0();return m(W,u),l(W,B(ci,{label:"",get value(){return J.accountId||""},onChange:q=>p(J.tempId,"accountId",q),get options(){return y()}}),null),l(W,B(Or,{label:"",get value(){return J.description||""},onChange:q=>p(J.tempId,"description",q),get placeholder(){return e("journal.lineDescription","Line description")}}),null),l(W,B(Or,{label:"",type:"number",get value(){return J.debitAmount?.toString()||"0"},onChange:q=>{p(J.tempId,"debitAmount",parseFloat(q)||0),parseFloat(q)>0&&p(J.tempId,"creditAmount",0)},placeholder:"0.00"}),null),l(W,B(Or,{label:"",type:"number",get value(){return J.creditAmount?.toString()||"0"},onChange:q=>{p(J.tempId,"creditAmount",parseFloat(q)||0),parseFloat(q)>0&&p(J.tempId,"debitAmount",0)},placeholder:"0.00"}),null),l(W,B(Pt,{type:"button",variant:"outline",size:"sm",onClick:()=>P(J.tempId),get disabled(){return i().length<=2},get children(){return e("common.remove","Remove")}}),null),W})()}),ie),m(ie,f),l(L,()=>e("journal.totalDebit","Total Debit"),U),l(L,()=>j(ne.totalDebit),null),l(z,()=>e("journal.totalCredit","Total Credit"),oe),l(z,()=>j(ne.totalCredit),null),G.style.setProperty("font-weight","600"),l(G,(()=>{var J=Te(()=>!!ne.isBalanced);return()=>J()?` ${e("journal.balanced")}`:` ${e("journal.notBalanced","Not Balanced")}`})()),l(Q,(()=>{var J=Te(()=>!!s());return()=>J()&&(()=>{var W=E0();return W.style.setProperty("padding","1rem"),W.style.setProperty("border-radius","var(--border-radius-sm)"),W.style.setProperty("margin-top","1rem"),W.style.setProperty("background","#f8d7da"),W.style.setProperty("color","#721c24"),W.style.setProperty("border","1px solid #f5c6cb"),l(W,s),W})()})(),ee),m(ee,c),l(ee,B(Pt,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),l(ee,B(Pt,{variant:"primary",type:"submit",get disabled(){return!ne.isBalanced},get children(){return Te(()=>!!t.editEntry)()?e("journal.updateEntry","Update Entry"):e("journal.saveAsDraft","Save as Draft")}}),null),Se(J=>(J=ne.isBalanced?"#4caf50":"#f44336")!=null?G.style.setProperty("color",J):G.style.removeProperty("color")),Q}})};var xN=ue("<div><div></div><div></div><div></div><div>"),AN=ue("<div><div></div><div></div><div></div><div></div><div>"),CN=ue("<div><button></button><button> (<!>)</button><button> (<!>/<!>)"),T0=ue("<div>"),IN=ue("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><div><h4></h4><div></div></div><div>"),lp=ue("<div><span></span><span>"),cp=ue("<div><strong>:</strong> "),$N=ue("<div><div><div></div><div></div><div></div><div></div><div></div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div></div></div><div><div><strong> Reconciliation Summary</strong></div><div><div><div><strong>Total Lines:</strong> </div><div><strong>Reconciled:</strong> </div><div><strong>Unreconciled:</strong> </div></div><div><div><strong>Bank Accounts:</strong> </div><div><strong>Bank Reconciled:</strong> "),kN=ue("<div><div><div></div><div></div></div><div></div><div></div><div></div><div>"),EN=ue("<div><span> "),TN=ue("<span>(<!>)"),NN=ue("<div><strong>Bank Pending:</strong> "),LN=ue("<div><div>Reconciled Lines:"),DN=ue("<div><div> Pending Bank Reconciliation:</div><div>Visit Bank Consolidations to reconcile these transactions"),RN=ue("<div><div><div><span></span><h3></h3></div><div><div><div></div><div>Total Lines</div></div><div><div></div><div>Reconciled</div></div><div><div></div><div>Pending"),MN=ue("<div><h4> Reconciled Lines (<!>)"),FN=ue("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div> Matched"),ON=ue("<div> "),BN=ue("<div><h4> Unreconciled Lines (<!>)"),jN=ue("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div> Pending"),VN=ue("<div>Bank account"),zN=ue("<div><div> Reconciliation Tip</div><div>This entry has unreconciled bank account transactions. Visit <strong>Bank Consolidations</strong> to match these with bank statements.");const qN=t=>{const{t:e}=tr(),[r,n]=$e("details"),[i,o]=$e(!1),s=Nt(()=>t.entryId?ks.getJournalEntryById(t.entryId):null),a={"text-align":"center","margin-bottom":"2rem",position:"relative"},c={position:"absolute",top:"0",right:"0",display:"flex",gap:"0.5rem"},u={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","margin-bottom":"0.5rem"},f={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},y={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},v={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem",display:"inline-block"},p={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},I={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},P={"font-weight":"600",color:"var(--text-primary)"},w={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},x=b=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:b?"var(--primary-color)":"var(--text-muted)","border-bottom":b?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),j={display:"grid","grid-template-columns":"2fr 2.5fr 1fr 1fr 1.5fr",gap:"1rem",padding:"1rem 0","border-bottom":"1px solid var(--border-color)","align-items":"center"},ne={...j,"font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","border-bottom":"2px solid var(--border-color)"},Q={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},K={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},Z=b=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[b],k=b=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(b),C=b=>new Date(b).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),E=b=>new Date(b).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),M=()=>{entry.status==="posted"&&!confirm(e("journal.confirmEditPosted","This entry has been posted. Editing will create a new draft copy. Continue?"))||o(!0)},_=()=>{if(s()&&confirm(e("journal.confirmPost","Are you sure you want to post this journal entry? This action cannot be undone.")))try{ks.postJournalEntry(s().id)}catch(b){alert(b instanceof Error?b.message:e("forms.errorPostingEntry","An error occurred while posting the entry"))}},S=()=>{s()&&confirm(e("journal.confirmVoid","Are you sure you want to void this journal entry?"))&&ks.voidJournalEntry(s().id)};return[B(Qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.entryDetails","Journal Entry Details")},get children(){return Te(()=>!s())()?(()=>{var b=xN(),Y=b.firstChild,te=Y.nextSibling,O=te.nextSibling,D=O.nextSibling;return b.style.setProperty("text-align","center"),b.style.setProperty("padding","3rem"),b.style.setProperty("color","var(--text-muted)"),Y.style.setProperty("font-size","1.5rem"),Y.style.setProperty("margin-bottom","1rem"),te.style.setProperty("font-size","1.1rem"),te.style.setProperty("margin-bottom","0.5rem"),l(te,()=>e("journal.entryNotFound","Entry Not Found")),O.style.setProperty("font-size","0.875rem"),l(O,()=>e("journal.entryNotFoundMessage","The journal entry you're looking for could not be found or may have been deleted.")),D.style.setProperty("margin-top","2rem"),l(D,B(Pt,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),b})():(()=>{const b=s(),Y=Z(b.status),te=Math.abs(b.totalDebit-b.totalCredit)<.01;return[(()=>{var O=AN(),D=O.firstChild,X=D.nextSibling,H=X.nextSibling,F=H.nextSibling,ie=F.nextSibling;return m(O,a),l(D,B(Pt,{variant:"outline",size:"sm",onClick:M,get title(){return e("journal.editEntryTooltip","Edit this journal entry")},get children(){return e("common.edit")}}),null),l(D,(()=>{var $=Te(()=>b.status==="draft");return()=>$()&&B(Pt,{variant:"primary",size:"sm",onClick:_,disabled:!te,get title(){return te?e("journal.postEntryTooltip","Post this journal entry"):e("journal.entryMustBeBalanced","Entry must be balanced to post")},get children(){return e("journal.post","Post")}})})(),null),l(D,(()=>{var $=Te(()=>b.status==="posted");return()=>$()&&B(Pt,{variant:"outline",size:"sm",onClick:S,style:{color:"#dc3545","border-color":"#dc3545"},get title(){return e("journal.voidEntryTooltip","Void this journal entry")},get children(){return e("entryBooks.void","Void")}})})(),null),m(X,u),l(X,()=>b.entryNumber),m(H,f),l(H,()=>b.description),m(F,y),l(F,()=>k(b.totalDebit)),l(ie,()=>b.status),Se($=>{var L=c,U={...v,background:Y.bg,color:Y.color};return $.e=m(D,L,$.e),$.t=m(ie,U,$.t),$},{e:void 0,t:void 0}),O})(),(()=>{var O=CN(),D=O.firstChild,X=D.nextSibling,H=X.firstChild,F=H.nextSibling;F.nextSibling;var ie=X.nextSibling,$=ie.firstChild,L=$.nextSibling,U=L.nextSibling,N=U.nextSibling;return N.nextSibling,m(O,w),D.$$click=()=>n("details"),l(D,()=>e("common.details")),X.$$click=()=>n("lines"),l(X,()=>e("journal.journalLines","Journal Lines"),H),l(X,()=>b.lines.length,F),ie.$$click=()=>n("reconciliation"),l(ie,()=>e("banking.reconciliation","Reconciliation"),$),l(ie,()=>b.lines.filter(z=>z.reconciled).length,L),l(ie,()=>b.lines.length,N),Se(z=>{var oe=x(r()==="details"),G=x(r()==="lines"),ee=x(r()==="reconciliation");return z.e=m(D,oe,z.e),z.t=m(X,G,z.t),z.a=m(ie,ee,z.a),z},{e:void 0,t:void 0,a:void 0}),O})(),Te(()=>Te(()=>r()==="details")()&&(()=>{var O=IN(),D=O.firstChild,X=D.firstChild,H=X.nextSibling,F=D.nextSibling,ie=F.firstChild,$=ie.nextSibling,L=F.nextSibling,U=L.firstChild,N=U.nextSibling,z=L.nextSibling,oe=z.firstChild,G=oe.nextSibling,ee=z.nextSibling,J=ee.firstChild,W=J.nextSibling,q=ee.nextSibling,ae=q.firstChild,de=ae.nextSibling,le=q.nextSibling,V=le.firstChild,ce=V.nextSibling,Pe=le.nextSibling,fe=Pe.firstChild,be=fe.firstChild,xe=be.nextSibling,he=fe.nextSibling;return l(X,()=>e("common.date")),l(H,()=>C(b.date)),l(ie,()=>e("journal.reference")),l($,()=>b.reference||e("common.notAvailable","N/A")),l(U,()=>e("journal.totalDebit")),l(N,()=>k(b.totalDebit)),l(oe,()=>e("journal.totalCredit")),l(G,()=>k(b.totalCredit)),l(J,()=>e("journal.balanceStatus","Balance Status")),l(W,()=>te?`${e("journal.balanced")} `:`${e("journal.unbalanced","Unbalanced")} (${k(Math.abs(b.totalDebit-b.totalCredit))} ${e("journal.difference","difference")})`),l(ae,()=>e("journal.createdBy")),l(de,()=>b.createdBy),l(V,()=>e("journal.createdAt","Created At")),l(ce,()=>E(b.createdAt)),l(O,(()=>{var ve=Te(()=>!!b.postedAt);return()=>ve()&&(()=>{var De=lp(),Ee=De.firstChild,Ce=Ee.nextSibling;return l(Ee,()=>e("journal.postedAt","Posted At")),l(Ce,()=>E(b.postedAt)),Se(Ne=>{var Ie=p,Re=I,We=P;return Ne.e=m(De,Ie,Ne.e),Ne.t=m(Ee,Re,Ne.t),Ne.a=m(Ce,We,Ne.a),Ne},{e:void 0,t:void 0,a:void 0}),De})()})(),Pe),Pe.style.setProperty("margin-top","2rem"),Pe.style.setProperty("padding-top","1rem"),Pe.style.setProperty("border-top","2px solid var(--border-color)"),fe.style.setProperty("display","flex"),fe.style.setProperty("justify-content","space-between"),fe.style.setProperty("align-items","center"),fe.style.setProperty("margin-bottom","1rem"),be.style.setProperty("margin","0"),be.style.setProperty("font-size","1rem"),l(be,()=>e("journal.quickActions","Quick Actions")),xe.style.setProperty("display","flex"),xe.style.setProperty("gap","0.5rem"),l(xe,B(Pt,{variant:"primary",size:"sm",onClick:M,get children(){return[" ",Te(()=>e("journal.editEntry"))]}}),null),l(xe,(()=>{var ve=Te(()=>b.status==="draft");return()=>ve()&&B(Pt,{variant:"outline",size:"sm",onClick:_,disabled:!te,style:{"border-color":te?"#4caf50":"#f44336",color:te?"#4caf50":"#f44336"},get children(){return te?` ${e("journal.postEntry","Post Entry")}`:` ${e("journal.fixBalance","Fix Balance")}`}})})(),null),l(xe,(()=>{var ve=Te(()=>b.status==="posted");return()=>ve()&&B(Pt,{variant:"outline",size:"sm",onClick:S,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return[" ",Te(()=>e("journal.voidEntry","Void Entry"))]}})})(),null),he.style.setProperty("padding","1rem"),he.style.setProperty("border-radius","var(--border-radius-sm)"),he.style.setProperty("font-size","0.875rem"),l(he,(()=>{var ve=Te(()=>b.status==="draft");return()=>ve()&&(()=>{var De=cp(),Ee=De.firstChild,Ce=Ee.firstChild;return Ee.nextSibling,l(Ee,()=>e("journal.draftEntry","Draft Entry"),Ce),l(De,()=>e("journal.draftEntryDescription","This entry can be edited and posted."),null),l(De,()=>!te&&`  ${e("journal.entryMustBeBalancedBeforePosting","Entry must be balanced before posting.")}`,null),De})()})(),null),l(he,(()=>{var ve=Te(()=>b.status==="posted");return()=>ve()&&(()=>{var De=cp(),Ee=De.firstChild,Ce=Ee.firstChild;return Ee.nextSibling,l(Ee,()=>e("journal.postedEntry","Posted Entry"),Ce),l(De,()=>e("journal.postedEntryDescription","This entry has been posted to the general ledger. Editing will create a new draft copy."),null),De})()})(),null),l(he,(()=>{var ve=Te(()=>b.status==="void");return()=>ve()&&(()=>{var De=cp(),Ee=De.firstChild,Ce=Ee.firstChild;return Ee.nextSibling,l(Ee,()=>e("journal.voidEntry"),Ce),l(De,()=>e("journal.voidEntryDescription","This entry has been voided and cannot be modified."),null),De})()})(),null),Se(ve=>{var De=p,Ee=I,Ce=P,Ne=p,Ie=I,Re=P,We=p,Fe=I,Xe=P,tt=p,At=I,rt=P,He=p,xt=I,_t={...P,color:te?"#4caf50":"#f44336"},mt=p,Et=I,et=P,qe=p,ot=I,Je=P,at=b.status==="draft"?"#fff3cd":b.status==="posted"?"#d4edda":"#f8d7da";return ve.e=m(D,De,ve.e),ve.t=m(X,Ee,ve.t),ve.a=m(H,Ce,ve.a),ve.o=m(F,Ne,ve.o),ve.i=m(ie,Ie,ve.i),ve.n=m($,Re,ve.n),ve.s=m(L,We,ve.s),ve.h=m(U,Fe,ve.h),ve.r=m(N,Xe,ve.r),ve.d=m(z,tt,ve.d),ve.l=m(oe,At,ve.l),ve.u=m(G,rt,ve.u),ve.c=m(ee,He,ve.c),ve.w=m(J,xt,ve.w),ve.m=m(W,_t,ve.m),ve.f=m(q,mt,ve.f),ve.y=m(ae,Et,ve.y),ve.g=m(de,et,ve.g),ve.p=m(le,qe,ve.p),ve.b=m(V,ot,ve.b),ve.T=m(ce,Je,ve.T),at!==ve.A&&((ve.A=at)!=null?he.style.setProperty("background",at):he.style.removeProperty("background")),ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),O})()),Te(()=>Te(()=>r()==="lines")()&&(()=>{var O=$N(),D=O.firstChild,X=D.firstChild,H=X.nextSibling,F=H.nextSibling,ie=F.nextSibling,$=ie.nextSibling,L=D.nextSibling,U=L.firstChild,N=U.firstChild,z=N.firstChild;N.nextSibling;var oe=U.nextSibling,G=oe.firstChild,ee=G.firstChild;G.nextSibling;var J=oe.nextSibling,W=L.nextSibling,q=W.firstChild,ae=q.nextSibling,de=ae.firstChild,le=de.firstChild,V=le.firstChild;V.nextSibling;var ce=le.nextSibling,Pe=ce.firstChild;Pe.nextSibling;var fe=ce.nextSibling,be=fe.firstChild;be.nextSibling;var xe=de.nextSibling,he=xe.firstChild,ve=he.firstChild;ve.nextSibling;var De=he.nextSibling,Ee=De.firstChild;return Ee.nextSibling,l(X,()=>e("journal.account")),l(H,()=>e("common.description")),l(F,()=>e("journal.debit")),l(ie,()=>e("journal.credit")),l($,()=>e("banking.reconciliation")),l(O,B(Ht,{get each(){return b.lines},children:Ce=>(()=>{var Ne=kN(),Ie=Ne.firstChild,Re=Ie.firstChild,We=Re.nextSibling,Fe=Ie.nextSibling,Xe=Fe.nextSibling,tt=Xe.nextSibling,At=tt.nextSibling;return Re.style.setProperty("font-weight","500"),l(Re,()=>Ce.accountName),We.style.setProperty("font-size","0.75rem"),We.style.setProperty("color","var(--text-muted)"),l(We,()=>kr.getAccountById(Ce.accountId)?.accountNumber||Ce.accountId),Fe.style.setProperty("font-size","0.875rem"),l(Fe,()=>Ce.description||"-"),Xe.style.setProperty("font-weight","600"),l(Xe,(()=>{var rt=Te(()=>Ce.debitAmount>0);return()=>rt()?k(Ce.debitAmount):"-"})()),tt.style.setProperty("font-weight","600"),l(tt,(()=>{var rt=Te(()=>Ce.creditAmount>0);return()=>rt()?k(Ce.creditAmount):"-"})()),l(At,(()=>{var rt=Te(()=>!!Ce.reconciled);return()=>rt()?(()=>{var He=EN(),xt=He.firstChild;return xt.firstChild,He.style.setProperty("display","flex"),He.style.setProperty("align-items","center"),He.style.setProperty("gap","0.5rem"),He.style.setProperty("color","#4caf50"),He.style.setProperty("font-size","0.875rem"),xt.style.setProperty("font-weight","600"),l(xt,()=>e("banking.reconciled"),null),l(He,(()=>{var _t=Te(()=>!!Ce.reconciledWith);return()=>_t()&&(()=>{var mt=TN(),Et=mt.firstChild,et=Et.nextSibling;return et.nextSibling,mt.style.setProperty("font-size","0.75rem"),mt.style.setProperty("color","var(--text-muted)"),mt.style.setProperty("font-style","italic"),l(mt,()=>Ce.reconciledWith,et),mt})()})(),null),He})():(()=>{var He=T0();return He.style.setProperty("color","var(--text-muted)"),He.style.setProperty("font-size","0.875rem"),l(He,()=>e("banking.notReconciled","Not Reconciled")),He})()})()),Se(rt=>{var He=j,xt=Ce.debitAmount>0?"#4caf50":"var(--text-muted)",_t=Ce.creditAmount>0?"#f44336":"var(--text-muted)";return rt.e=m(Ne,He,rt.e),xt!==rt.t&&((rt.t=xt)!=null?Xe.style.setProperty("color",xt):Xe.style.removeProperty("color")),_t!==rt.a&&((rt.a=_t)!=null?tt.style.setProperty("color",_t):tt.style.removeProperty("color")),rt},{e:void 0,t:void 0,a:void 0}),Ne})()}),L),m(L,Q),l(N,()=>e("journal.totalDebit"),z),l(U,()=>k(b.totalDebit),null),l(G,()=>e("journal.totalCredit"),ee),l(oe,()=>k(b.totalCredit),null),(te?"#4caf50":"#f44336")!=null?J.style.setProperty("color",te?"#4caf50":"#f44336"):J.style.removeProperty("color"),J.style.setProperty("font-weight","600"),l(J,()=>te?` ${e("journal.balanced")}`:` ${e("journal.notBalanced","Not Balanced")}`),W.style.setProperty("margin-top","1rem"),W.style.setProperty("padding","1rem"),W.style.setProperty("border-radius","var(--border-radius-sm)"),W.style.setProperty("font-size","0.875rem"),q.style.setProperty("margin-bottom","0.5rem"),ae.style.setProperty("display","grid"),ae.style.setProperty("grid-template-columns","1fr 1fr"),ae.style.setProperty("gap","1rem"),le.style.setProperty("margin-bottom","0.25rem"),l(le,()=>b.lines.length,null),ce.style.setProperty("margin-bottom","0.25rem"),ce.style.setProperty("color","#4caf50"),l(ce,()=>b.lines.filter(Ce=>Ce.reconciled).length,null),fe.style.setProperty("color","#f44336"),l(fe,()=>b.lines.filter(Ce=>!Ce.reconciled).length,null),he.style.setProperty("margin-bottom","0.25rem"),l(he,()=>b.lines.filter(Ce=>["1001","1002","1003"].includes(Ce.accountId)).length,null),De.style.setProperty("margin-bottom","0.25rem"),De.style.setProperty("color","#4caf50"),l(De,()=>b.lines.filter(Ce=>["1001","1002","1003"].includes(Ce.accountId)&&Ce.reconciled).length,null),l(xe,(()=>{var Ce=Te(()=>b.lines.filter(Ne=>["1001","1002","1003"].includes(Ne.accountId)&&!Ne.reconciled).length>0);return()=>Ce()&&(()=>{var Ne=NN(),Ie=Ne.firstChild;return Ie.nextSibling,Ne.style.setProperty("color","#f44336"),l(Ne,()=>b.lines.filter(Re=>["1001","1002","1003"].includes(Re.accountId)&&!Re.reconciled).length,null),Ne})()})(),null),l(W,(()=>{var Ce=Te(()=>b.lines.filter(Ne=>Ne.reconciled).length>0);return()=>Ce()&&(()=>{var Ne=LN(),Ie=Ne.firstChild;return Ne.style.setProperty("margin-top","0.75rem"),Ne.style.setProperty("padding-top","0.75rem"),Ne.style.setProperty("border-top","1px solid var(--border-color)"),Ie.style.setProperty("margin-bottom","0.5rem"),Ie.style.setProperty("font-weight","500"),l(Ne,()=>b.lines.filter(Re=>Re.reconciled).map(Re=>(()=>{var We=lp(),Fe=We.firstChild,Xe=Fe.nextSibling;return We.style.setProperty("display","flex"),We.style.setProperty("justify-content","space-between"),We.style.setProperty("margin-bottom","0.25rem"),We.style.setProperty("font-size","0.8rem"),l(Fe,()=>Re.accountName),Xe.style.setProperty("color","var(--text-muted)"),l(Xe,()=>Re.reconciledWith?` ${Re.reconciledWith}`:"Manual"),We})()),null),Ne})()})(),null),l(W,(()=>{var Ce=Te(()=>b.lines.filter(Ne=>!Ne.reconciled&&["1001","1002","1003"].includes(Ne.accountId)).length>0);return()=>Ce()&&(()=>{var Ne=DN(),Ie=Ne.firstChild,Re=Ie.nextSibling;return Ne.style.setProperty("margin-top","0.75rem"),Ne.style.setProperty("padding-top","0.75rem"),Ne.style.setProperty("border-top","1px solid var(--border-color)"),Ie.style.setProperty("margin-bottom","0.5rem"),Ie.style.setProperty("font-weight","500"),Ie.style.setProperty("color","#f44336"),l(Ne,()=>b.lines.filter(We=>!We.reconciled&&["1001","1002","1003"].includes(We.accountId)).map(We=>(()=>{var Fe=lp(),Xe=Fe.firstChild,tt=Xe.nextSibling;return Fe.style.setProperty("display","flex"),Fe.style.setProperty("justify-content","space-between"),Fe.style.setProperty("margin-bottom","0.25rem"),Fe.style.setProperty("font-size","0.8rem"),Fe.style.setProperty("color","#f44336"),l(Xe,()=>We.accountName),l(tt,()=>k(We.debitAmount||We.creditAmount)),Fe})()),Re),Re.style.setProperty("margin-top","0.5rem"),Re.style.setProperty("font-size","0.75rem"),Re.style.setProperty("color","var(--text-muted)"),Re.style.setProperty("font-style","italic"),Ne})()})(),null),Se(Ce=>{var Ne=ne,Ie=b.lines.some(Re=>Re.reconciled)?"#e8f5e8":"#fff3cd";return Ce.e=m(D,Ne,Ce.e),Ie!==Ce.t&&((Ce.t=Ie)!=null?W.style.setProperty("background",Ie):W.style.removeProperty("background")),Ce},{e:void 0,t:void 0}),O})()),Te(()=>Te(()=>r()==="reconciliation")()&&(()=>{var O=RN(),D=O.firstChild,X=D.firstChild,H=X.firstChild,F=H.nextSibling,ie=X.nextSibling,$=ie.firstChild,L=$.firstChild,U=L.nextSibling,N=$.nextSibling,z=N.firstChild,oe=z.nextSibling,G=N.nextSibling,ee=G.firstChild,J=ee.nextSibling;return D.style.setProperty("margin-bottom","1.5rem"),D.style.setProperty("padding","1rem"),D.style.setProperty("border-radius","var(--border-radius)"),D.style.setProperty("border","1px solid var(--border-color)"),X.style.setProperty("display","flex"),X.style.setProperty("align-items","center"),X.style.setProperty("gap","0.5rem"),X.style.setProperty("margin-bottom","1rem"),H.style.setProperty("font-size","1.5rem"),l(H,(()=>{var W=Te(()=>!!b.lines.every(q=>q.reconciled));return()=>W()?"":b.lines.some(q=>q.reconciled)?"":""})()),F.style.setProperty("margin","0"),F.style.setProperty("font-size","1.2rem"),l(F,(()=>{var W=Te(()=>!!b.lines.every(q=>q.reconciled));return()=>W()?"Fully Reconciled":b.lines.some(q=>q.reconciled)?"Partially Reconciled":"Unreconciled"})()),ie.style.setProperty("display","grid"),ie.style.setProperty("grid-template-columns","1fr 1fr 1fr"),ie.style.setProperty("gap","1rem"),$.style.setProperty("text-align","center"),L.style.setProperty("font-size","2rem"),L.style.setProperty("font-weight","700"),L.style.setProperty("color","var(--primary-color)"),l(L,()=>b.lines.length),U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-muted)"),N.style.setProperty("text-align","center"),z.style.setProperty("font-size","2rem"),z.style.setProperty("font-weight","700"),z.style.setProperty("color","#4caf50"),l(z,()=>b.lines.filter(W=>W.reconciled).length),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),G.style.setProperty("text-align","center"),ee.style.setProperty("font-size","2rem"),ee.style.setProperty("font-weight","700"),ee.style.setProperty("color","#f44336"),l(ee,()=>b.lines.filter(W=>!W.reconciled).length),J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-muted)"),l(O,(()=>{var W=Te(()=>b.lines.filter(q=>q.reconciled).length>0);return()=>W()&&(()=>{var q=MN(),ae=q.firstChild,de=ae.firstChild,le=de.nextSibling;return le.nextSibling,q.style.setProperty("margin-bottom","1.5rem"),ae.style.setProperty("margin","0 0 1rem 0"),ae.style.setProperty("font-size","1.1rem"),ae.style.setProperty("color","#4caf50"),ae.style.setProperty("display","flex"),ae.style.setProperty("align-items","center"),ae.style.setProperty("gap","0.5rem"),l(ae,()=>b.lines.filter(V=>V.reconciled).length,le),l(q,()=>b.lines.filter(V=>V.reconciled).map(V=>(()=>{var ce=FN(),Pe=ce.firstChild,fe=Pe.firstChild,be=fe.nextSibling,xe=Pe.nextSibling,he=xe.nextSibling,ve=he.nextSibling,De=ve.nextSibling,Ee=De.firstChild;return ce.style.setProperty("display","grid"),ce.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),ce.style.setProperty("gap","1rem"),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("background","#f0f9f0"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),ce.style.setProperty("align-items","center"),ce.style.setProperty("font-size","0.875rem"),fe.style.setProperty("font-weight","500"),l(fe,()=>V.accountName),be.style.setProperty("font-size","0.75rem"),be.style.setProperty("color","var(--text-muted)"),l(be,()=>kr.getAccountById(V.accountId)?.accountNumber),xe.style.setProperty("color","var(--text-muted)"),l(xe,()=>V.description||"No description"),he.style.setProperty("font-weight","600"),l(he,(()=>{var Ce=Te(()=>V.debitAmount>0);return()=>Ce()?k(V.debitAmount):"-"})()),ve.style.setProperty("font-weight","600"),l(ve,(()=>{var Ce=Te(()=>V.creditAmount>0);return()=>Ce()?k(V.creditAmount):"-"})()),De.style.setProperty("color","#4caf50"),Ee.style.setProperty("font-weight","500"),l(De,(()=>{var Ce=Te(()=>!!V.reconciledWith);return()=>Ce()&&(()=>{var Ne=ON();return Ne.firstChild,Ne.style.setProperty("font-size","0.75rem"),Ne.style.setProperty("font-style","italic"),l(Ne,()=>V.reconciledWith,null),Ne})()})(),null),Se(Ce=>{var Ne=V.debitAmount>0?"#4caf50":"var(--text-muted)",Ie=V.creditAmount>0?"#f44336":"var(--text-muted)";return Ne!==Ce.e&&((Ce.e=Ne)!=null?he.style.setProperty("color",Ne):he.style.removeProperty("color")),Ie!==Ce.t&&((Ce.t=Ie)!=null?ve.style.setProperty("color",Ie):ve.style.removeProperty("color")),Ce},{e:void 0,t:void 0}),ce})()),null),q})()})(),null),l(O,(()=>{var W=Te(()=>b.lines.filter(q=>!q.reconciled).length>0);return()=>W()&&(()=>{var q=BN(),ae=q.firstChild,de=ae.firstChild,le=de.nextSibling;return le.nextSibling,q.style.setProperty("margin-bottom","1.5rem"),ae.style.setProperty("margin","0 0 1rem 0"),ae.style.setProperty("font-size","1.1rem"),ae.style.setProperty("color","#f44336"),ae.style.setProperty("display","flex"),ae.style.setProperty("align-items","center"),ae.style.setProperty("gap","0.5rem"),l(ae,()=>b.lines.filter(V=>!V.reconciled).length,le),l(q,()=>b.lines.filter(V=>!V.reconciled).map(V=>(()=>{var ce=jN(),Pe=ce.firstChild,fe=Pe.firstChild,be=fe.nextSibling,xe=Pe.nextSibling,he=xe.nextSibling,ve=he.nextSibling,De=ve.nextSibling,Ee=De.firstChild;return ce.style.setProperty("display","grid"),ce.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),ce.style.setProperty("gap","1rem"),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("background","#fff9f0"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),ce.style.setProperty("align-items","center"),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("border","1px solid #ffe0b3"),fe.style.setProperty("font-weight","500"),l(fe,()=>V.accountName),be.style.setProperty("font-size","0.75rem"),be.style.setProperty("color","var(--text-muted)"),l(be,()=>kr.getAccountById(V.accountId)?.accountNumber),xe.style.setProperty("color","var(--text-muted)"),l(xe,()=>V.description||"No description"),he.style.setProperty("font-weight","600"),l(he,(()=>{var Ce=Te(()=>V.debitAmount>0);return()=>Ce()?k(V.debitAmount):"-"})()),ve.style.setProperty("font-weight","600"),l(ve,(()=>{var Ce=Te(()=>V.creditAmount>0);return()=>Ce()?k(V.creditAmount):"-"})()),De.style.setProperty("color","#f44336"),Ee.style.setProperty("font-weight","500"),l(De,(()=>{var Ce=Te(()=>!!["1001","1002","1003"].includes(V.accountId));return()=>Ce()&&(()=>{var Ne=VN();return Ne.style.setProperty("font-size","0.75rem"),Ne.style.setProperty("font-style","italic"),Ne})()})(),null),Se(Ce=>{var Ne=V.debitAmount>0?"#4caf50":"var(--text-muted)",Ie=V.creditAmount>0?"#f44336":"var(--text-muted)";return Ne!==Ce.e&&((Ce.e=Ne)!=null?he.style.setProperty("color",Ne):he.style.removeProperty("color")),Ie!==Ce.t&&((Ce.t=Ie)!=null?ve.style.setProperty("color",Ie):ve.style.removeProperty("color")),Ce},{e:void 0,t:void 0}),ce})()),null),l(q,(()=>{var V=Te(()=>b.lines.filter(ce=>!ce.reconciled&&["1001","1002","1003"].includes(ce.accountId)).length>0);return()=>V()&&(()=>{var ce=zN(),Pe=ce.firstChild,fe=Pe.nextSibling;return ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("background","#ffebee"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),ce.style.setProperty("margin-top","1rem"),ce.style.setProperty("border","1px solid #ffcdd2"),Pe.style.setProperty("font-weight","500"),Pe.style.setProperty("margin-bottom","0.5rem"),Pe.style.setProperty("color","#f44336"),fe.style.setProperty("font-size","0.875rem"),fe.style.setProperty("color","var(--text-muted)"),ce})()})(),null),q})()})(),null),Se(W=>(W=b.lines.every(q=>q.reconciled)?"#e8f5e8":b.lines.some(q=>q.reconciled)?"#fff3cd":"#ffebee")!=null?D.style.setProperty("background",W):D.style.removeProperty("background")),O})()),(()=>{var O=T0();return m(O,K),l(O,B(Pt,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),l(O,B(Pt,{variant:"primary",onClick:M,get children(){return e("journal.editEntry")}}),null),l(O,(()=>{var D=Te(()=>b.status==="draft");return()=>D()&&B(Pt,{variant:"outline",onClick:_,disabled:!te,style:{"border-color":"#4caf50",color:te?"#4caf50":"var(--text-muted)"},get children(){return te?e("journal.postEntry","Post Entry"):e("journal.entryNotBalanced","Entry Not Balanced")}})})(),null),l(O,(()=>{var D=Te(()=>b.status==="posted");return()=>D()&&B(Pt,{variant:"outline",onClick:S,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return e("journal.voidEntry","Void Entry")}})})(),null),O})()]})()}}),Te(()=>Te(()=>!!s())()&&B(x5,{get isOpen(){return i()},onClose:()=>{o(!1)},get editEntry(){return s()}}))]};ur(["click"]);var UN=ue("<div><div><h2></h2><p></p></div><div>"),Ss=ue("<div>"),HN=ue("<div> <!>  <!> "),WN=ue("<div><div><label></label></div><div><label></label></div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label></div><div>"),GN=ue("<div><span>:</span><span> "),zd=ue("<span>: "),YN=ue("<div><br>");const KN=()=>{const{t}=tr(),[e,r]=$e(!1),[n,i]=$e(null),[o,s]=$e(!1),[a,c]=$e(null),[u,f]=$e("all"),[y,v]=$e("all"),[p,I]=$e(""),[P,w]=$e(""),[x,j]=$e("date"),[ne,Q]=$e("desc"),K={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},Z={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)","flex-wrap":"wrap"},k={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem"},C={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(400px, 1fr))",gap:"1.5rem"},E=()=>[{value:"all",label:t("journal.allEntries","All Entries")},{value:"draft",label:t("journal.draft")},{value:"posted",label:t("journal.posted")},{value:"void",label:t("entryBooks.void","Void")}],M=()=>[{value:"all",label:t("accounts.allAccounts","All Accounts")},...kr.accounts.map(F=>({value:F.id,label:`${F.accountNumber} - ${F.name}`}))],_=()=>[{value:"date",label:t("common.date")},{value:"entryNumber",label:t("journal.entryNumber")},{value:"amount",label:t("common.amount")}],S=()=>{let F=ks.journalEntries;return u()!=="all"&&(F=F.filter(ie=>ie.status===u())),y()!=="all"&&(F=F.filter(ie=>ie.lines.some($=>$.accountId===y()))),p()&&(F=F.filter(ie=>ie.date>=p())),P()&&(F=F.filter(ie=>ie.date<=P())),F=[...F].sort((ie,$)=>{let L=0;switch(x()){case"date":L=new Date(ie.date).getTime()-new Date($.date).getTime();break;case"entryNumber":L=ie.entryNumber.localeCompare($.entryNumber);break;case"amount":L=ie.totalDebit-$.totalDebit;break}return ne()==="asc"?L:-L}),F},b=()=>{const F=ks.journalEntries,ie=F.filter(oe=>oe.status==="draft"),$=F.filter(oe=>oe.status==="posted"),L=F.filter(oe=>oe.status==="void"),U=$.reduce((oe,G)=>oe+G.totalDebit,0),N=$.reduce((oe,G)=>oe+G.totalCredit,0),z=F.filter(oe=>oe.lines.some(G=>["1001","1002","1003"].includes(G.accountId)&&!G.reconciled)).length;return{totalEntries:F.length,draftEntries:ie.length,postedEntries:$.length,voidEntries:L.length,totalDebit:U,totalCredit:N,unreconciledEntries:z}},Y=F=>{c(F.id),s(!0)},te=()=>{i(null),r(!0)},O=()=>{r(!1),i(null)},D=F=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(F),X=b(),H=S();return B(ro,{get title(){return t("entryBooks.title")},get children(){return[(()=>{var F=UN(),ie=F.firstChild,$=ie.firstChild,L=$.nextSibling,U=ie.nextSibling;return m(F,K),$.style.setProperty("margin","0 0 0.5rem 0"),$.style.setProperty("font-size","1.5rem"),l($,()=>t("journal.title")),L.style.setProperty("margin","0"),L.style.setProperty("color","var(--text-muted)"),l(L,()=>t("entryBooks.subtitle","Manage accounting entries and general ledger records")),U.style.setProperty("display","flex"),U.style.setProperty("gap","1rem"),l(U,B(Pt,{variant:"secondary",onClick:()=>window.location.href="/bank-consolidations",get children(){return t("entryBooks.viewReconciliation","View Reconciliation")}}),null),l(U,B(Pt,{variant:"primary",onClick:te,get children(){return t("journal.addEntry","Add Journal Entry")}}),null),F})(),(()=>{var F=Ss();return m(F,k),l(F,B(Tt,{get title(){return t("entryBooks.totalEntries","Total Entries")},get subtitle(){return t("entryBooks.allJournalEntries","All journal entries")},get children(){return[(()=>{var ie=Ss();return ie.style.setProperty("font-size","1.5rem"),ie.style.setProperty("font-weight","600"),ie.style.setProperty("color","var(--primary-color)"),ie.style.setProperty("margin-bottom","0.5rem"),l(ie,()=>X.totalEntries),ie})(),(()=>{var ie=HN(),$=ie.firstChild,L=$.nextSibling,U=L.nextSibling,N=U.nextSibling;return N.nextSibling,ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-muted)"),l(ie,()=>X.postedEntries,$),l(ie,()=>t("journal.posted").toLowerCase(),L),l(ie,()=>X.draftEntries,N),l(ie,()=>t("journal.draft").toLowerCase(),null),l(ie,(()=>{var z=Te(()=>X.voidEntries>0);return()=>z()&&`  ${X.voidEntries} ${t("entryBooks.void","void").toLowerCase()}`})(),null),ie})()]}}),null),l(F,B(Tt,{get title(){return t("journal.totalDebits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var ie=Ss();return ie.style.setProperty("font-size","1.5rem"),ie.style.setProperty("font-weight","600"),ie.style.setProperty("color","#4caf50"),ie.style.setProperty("margin-bottom","0.5rem"),l(ie,()=>D(X.totalDebit)),ie})(),(()=>{var ie=Ss();return ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-muted)"),l(ie,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",X.postedEntries.toString())),ie})()]}}),null),l(F,B(Tt,{get title(){return t("journal.totalCredits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var ie=Ss();return ie.style.setProperty("font-size","1.5rem"),ie.style.setProperty("font-weight","600"),ie.style.setProperty("color","#f44336"),ie.style.setProperty("margin-bottom","0.5rem"),l(ie,()=>D(X.totalCredit)),ie})(),(()=>{var ie=Ss();return ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-muted)"),l(ie,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",X.postedEntries.toString())),ie})()]}}),null),l(F,B(Tt,{get title(){return t("banking.unreconciled","Unreconciled")},get subtitle(){return t("banking.title")},get children(){return[(()=>{var ie=Ss();return ie.style.setProperty("font-size","1.5rem"),ie.style.setProperty("font-weight","600"),ie.style.setProperty("margin-bottom","0.5rem"),l(ie,()=>X.unreconciledEntries),Se($=>($=X.unreconciledEntries>0?"#ff9800":"#4caf50")!=null?ie.style.setProperty("color",$):ie.style.removeProperty("color")),ie})(),(()=>{var ie=Ss();return ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-muted)"),l(ie,(()=>{var $=Te(()=>X.unreconciledEntries>0);return()=>$()?t("entryBooks.needBankReconciliation","Need bank reconciliation"):t("entryBooks.allReconciled","All reconciled")})()),ie})()]}}),null),F})(),(()=>{var F=WN(),ie=F.firstChild,$=ie.firstChild,L=ie.nextSibling,U=L.firstChild,N=L.nextSibling,z=N.firstChild,oe=N.nextSibling,G=oe.firstChild,ee=G.nextSibling,J=oe.nextSibling,W=J.firstChild,q=W.nextSibling,ae=J.nextSibling,de=ae.firstChild,le=ae.nextSibling;return m(F,Z),ie.style.setProperty("min-width","150px"),$.style.setProperty("display","block"),$.style.setProperty("margin-bottom","0.5rem"),$.style.setProperty("font-weight","500"),$.style.setProperty("font-size","0.875rem"),l($,()=>t("common.status")),l(ie,B(ci,{label:"",get value(){return u()},onChange:f,get options(){return E()}}),null),L.style.setProperty("min-width","200px"),U.style.setProperty("display","block"),U.style.setProperty("margin-bottom","0.5rem"),U.style.setProperty("font-weight","500"),U.style.setProperty("font-size","0.875rem"),l(U,()=>t("journal.account")),l(L,B(ci,{label:"",get value(){return y()},onChange:v,get options(){return M()}}),null),N.style.setProperty("min-width","120px"),z.style.setProperty("display","block"),z.style.setProperty("margin-bottom","0.5rem"),z.style.setProperty("font-weight","500"),z.style.setProperty("font-size","0.875rem"),l(z,()=>t("entryBooks.sortBy","Sort By")),l(N,B(ci,{label:"",get value(){return x()},onChange:j,get options(){return _()}}),null),oe.style.setProperty("min-width","130px"),G.style.setProperty("display","block"),G.style.setProperty("margin-bottom","0.5rem"),G.style.setProperty("font-weight","500"),G.style.setProperty("font-size","0.875rem"),l(G,()=>t("entryBooks.fromDate","From Date")),ee.addEventListener("change",V=>I(V.target.value)),ee.style.setProperty("padding","0.75rem"),ee.style.setProperty("border","1px solid var(--border-color)"),ee.style.setProperty("border-radius","var(--border-radius-sm)"),ee.style.setProperty("font-family","inherit"),ee.style.setProperty("width","100%"),J.style.setProperty("min-width","130px"),W.style.setProperty("display","block"),W.style.setProperty("margin-bottom","0.5rem"),W.style.setProperty("font-weight","500"),W.style.setProperty("font-size","0.875rem"),l(W,()=>t("entryBooks.toDate","To Date")),q.addEventListener("change",V=>w(V.target.value)),q.style.setProperty("padding","0.75rem"),q.style.setProperty("border","1px solid var(--border-color)"),q.style.setProperty("border-radius","var(--border-radius-sm)"),q.style.setProperty("font-family","inherit"),q.style.setProperty("width","100%"),ae.style.setProperty("min-width","100px"),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),de.style.setProperty("font-size","0.875rem"),l(de,()=>t("entryBooks.order","Order")),l(ae,B(ci,{label:"",get value(){return ne()},onChange:Q,get options(){return[{value:"desc",label:t("entryBooks.newest","Newest")},{value:"asc",label:t("entryBooks.oldest","Oldest")}]}}),null),le.style.setProperty("display","flex"),le.style.setProperty("align-items","end"),le.style.setProperty("gap","0.5rem"),l(le,B(Pt,{variant:"outline",size:"sm",onClick:()=>{f("all"),v("all"),I(""),w(""),j("date"),Q("desc")},get children(){return t("entryBooks.resetFilters","Reset Filters")}})),Se(()=>ee.value=p()),Se(()=>q.value=P()),F})(),Te(()=>Te(()=>!!(u()!=="all"||y()!=="all"||p()||P()))()&&(()=>{var F=GN(),ie=F.firstChild,$=ie.firstChild,L=ie.nextSibling,U=L.firstChild;return F.style.setProperty("display","flex"),F.style.setProperty("gap","0.5rem"),F.style.setProperty("align-items","center"),F.style.setProperty("margin-bottom","1rem"),F.style.setProperty("padding","0.75rem"),F.style.setProperty("background","var(--surface-color)"),F.style.setProperty("border-radius","var(--border-radius-sm)"),F.style.setProperty("border","1px solid var(--border-color)"),ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("font-weight","500"),l(ie,()=>t("entryBooks.activeFilters","Active filters"),$),l(F,(()=>{var N=Te(()=>u()!=="all");return()=>N()&&(()=>{var z=zd(),oe=z.firstChild;return z.style.setProperty("padding","0.25rem 0.5rem"),z.style.setProperty("background","var(--primary-color)"),z.style.setProperty("color","white"),z.style.setProperty("border-radius","12px"),z.style.setProperty("font-size","0.75rem"),l(z,()=>t("common.status"),oe),l(z,u,null),z})()})(),L),l(F,(()=>{var N=Te(()=>y()!=="all");return()=>N()&&(()=>{var z=zd(),oe=z.firstChild;return z.style.setProperty("padding","0.25rem 0.5rem"),z.style.setProperty("background","var(--primary-color)"),z.style.setProperty("color","white"),z.style.setProperty("border-radius","12px"),z.style.setProperty("font-size","0.75rem"),l(z,()=>t("journal.account"),oe),l(z,()=>kr.getAccountById(y())?.name||t("common.unknown","Unknown"),null),z})()})(),L),l(F,(()=>{var N=Te(()=>!!p());return()=>N()&&(()=>{var z=zd(),oe=z.firstChild;return z.style.setProperty("padding","0.25rem 0.5rem"),z.style.setProperty("background","var(--primary-color)"),z.style.setProperty("color","white"),z.style.setProperty("border-radius","12px"),z.style.setProperty("font-size","0.75rem"),l(z,()=>t("entryBooks.from","From"),oe),l(z,p,null),z})()})(),L),l(F,(()=>{var N=Te(()=>!!P());return()=>N()&&(()=>{var z=zd(),oe=z.firstChild;return z.style.setProperty("padding","0.25rem 0.5rem"),z.style.setProperty("background","var(--primary-color)"),z.style.setProperty("color","white"),z.style.setProperty("border-radius","12px"),z.style.setProperty("font-size","0.75rem"),l(z,()=>t("entryBooks.to","To"),oe),l(z,P,null),z})()})(),L),L.style.setProperty("margin-left","auto"),L.style.setProperty("font-size","0.875rem"),L.style.setProperty("color","var(--text-muted)"),l(L,()=>H.length,U),l(L,()=>t("entryBooks.entriesFound","{count} entries found").replace("{count}",H.length.toString()),null),F})()),Te(()=>Te(()=>H.length===0)()?B(Tt,{get title(){return t("entryBooks.noJournalEntries","No Journal Entries")},get subtitle(){return t("entryBooks.startByCreating","Start by creating your first entry")},get children(){var F=YN(),ie=F.firstChild;return F.style.setProperty("text-align","center"),F.style.setProperty("color","var(--text-muted)"),F.style.setProperty("padding","2rem"),l(F,()=>t("entryBooks.noEntriesMatch","No journal entries match your current filters."),ie),l(F,B(Pt,{variant:"primary",style:{"margin-top":"1rem"},onClick:te,get children(){return t("entryBooks.createFirstEntry","Create First Entry")}}),null),F}}):(()=>{var F=Ss();return m(F,C),l(F,B(Ht,{each:H,children:ie=>B(wN,{entry:ie,onViewDetails:Y})})),F})()),B(x5,{get isOpen(){return e()},onClose:O,get editEntry(){return n()}}),B(qN,{get isOpen(){return o()},onClose:()=>{s(!1),c(null)},get entryId(){return a()}})]}})};function rn(t){"@babel/helpers - typeof";return rn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rn(t)}var Si=Uint8Array,eo=Uint16Array,Dy=Int32Array,uf=new Si([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),df=new Si([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),dm=new Si([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),A5=function(t,e){for(var r=new eo(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var i=new Dy(r[30]),n=1;n<30;++n)for(var o=r[n];o<r[n+1];++o)i[o]=o-r[n]<<5|n;return{b:r,r:i}},C5=A5(uf,2),I5=C5.b,hm=C5.r;I5[28]=258,hm[258]=28;var $5=A5(df,0),JN=$5.b,N0=$5.r,fm=new eo(32768);for(var yn=0;yn<32768;++yn){var fa=(yn&43690)>>1|(yn&21845)<<1;fa=(fa&52428)>>2|(fa&13107)<<2,fa=(fa&61680)>>4|(fa&3855)<<4,fm[yn]=((fa&65280)>>8|(fa&255)<<8)>>1}var is=function(t,e,r){for(var n=t.length,i=0,o=new eo(e);i<n;++i)t[i]&&++o[t[i]-1];var s=new eo(e);for(i=1;i<e;++i)s[i]=s[i-1]+o[i-1]<<1;var a;if(r){a=new eo(1<<e);var c=15-e;for(i=0;i<n;++i)if(t[i])for(var u=i<<4|t[i],f=e-t[i],y=s[t[i]-1]++<<f,v=y|(1<<f)-1;y<=v;++y)a[fm[y]>>c]=u}else for(a=new eo(n),i=0;i<n;++i)t[i]&&(a[i]=fm[s[t[i]-1]++]>>15-t[i]);return a},Ma=new Si(288);for(var yn=0;yn<144;++yn)Ma[yn]=8;for(var yn=144;yn<256;++yn)Ma[yn]=9;for(var yn=256;yn<280;++yn)Ma[yn]=7;for(var yn=280;yn<288;++yn)Ma[yn]=8;var Bu=new Si(32);for(var yn=0;yn<32;++yn)Bu[yn]=5;var QN=is(Ma,9,0),XN=is(Ma,9,1),ZN=is(Bu,5,0),eL=is(Bu,5,1),up=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},$o=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},dp=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},Ry=function(t){return(t+7)/8|0},k5=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new Si(t.subarray(e,r))},tL=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],To=function(t,e,r){var n=new Error(e||tL[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,To),!r)throw n;return n},rL=function(t,e,r,n){var i=t.length,o=0;if(!i||e.f&&!e.l)return r||new Si(0);var s=!r,a=s||e.i!=2,c=e.i;s&&(r=new Si(i*3));var u=function(W){var q=r.length;if(W>q){var ae=new Si(Math.max(q*2,W));ae.set(r),r=ae}},f=e.f||0,y=e.p||0,v=e.b||0,p=e.l,I=e.d,P=e.m,w=e.n,x=i*8;do{if(!p){f=$o(t,y,1);var j=$o(t,y+1,3);if(y+=3,j)if(j==1)p=XN,I=eL,P=9,w=5;else if(j==2){var Z=$o(t,y,31)+257,k=$o(t,y+10,15)+4,C=Z+$o(t,y+5,31)+1;y+=14;for(var E=new Si(C),M=new Si(19),_=0;_<k;++_)M[dm[_]]=$o(t,y+_*3,7);y+=k*3;for(var S=up(M),b=(1<<S)-1,Y=is(M,S,1),_=0;_<C;){var te=Y[$o(t,y,b)];y+=te&15;var ne=te>>4;if(ne<16)E[_++]=ne;else{var O=0,D=0;for(ne==16?(D=3+$o(t,y,3),y+=2,O=E[_-1]):ne==17?(D=3+$o(t,y,7),y+=3):ne==18&&(D=11+$o(t,y,127),y+=7);D--;)E[_++]=O}}var X=E.subarray(0,Z),H=E.subarray(Z);P=up(X),w=up(H),p=is(X,P,1),I=is(H,w,1)}else To(1);else{var ne=Ry(y)+4,Q=t[ne-4]|t[ne-3]<<8,K=ne+Q;if(K>i){c&&To(0);break}a&&u(v+Q),r.set(t.subarray(ne,K),v),e.b=v+=Q,e.p=y=K*8,e.f=f;continue}if(y>x){c&&To(0);break}}a&&u(v+131072);for(var F=(1<<P)-1,ie=(1<<w)-1,$=y;;$=y){var O=p[dp(t,y)&F],L=O>>4;if(y+=O&15,y>x){c&&To(0);break}if(O||To(2),L<256)r[v++]=L;else if(L==256){$=y,p=null;break}else{var U=L-254;if(L>264){var _=L-257,N=uf[_];U=$o(t,y,(1<<N)-1)+I5[_],y+=N}var z=I[dp(t,y)&ie],oe=z>>4;z||To(3),y+=z&15;var H=JN[oe];if(oe>3){var N=df[oe];H+=dp(t,y)&(1<<N)-1,y+=N}if(y>x){c&&To(0);break}a&&u(v+131072);var G=v+U;if(v<H){var ee=o-H,J=Math.min(H,G);for(ee+v<0&&To(3);v<J;++v)r[v]=n[ee+v]}for(;v<G;++v)r[v]=r[v-H]}}e.l=p,e.p=$,e.b=v,e.f=f,p&&(f=1,e.m=P,e.d=I,e.n=w)}while(!f);return v!=r.length&&s?k5(r,0,v):r.subarray(0,v)},Ps=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},Zc=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},hp=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var i=r.length,o=r.slice();if(!i)return{t:T5,l:0};if(i==1){var s=new Si(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(K,Z){return K.f-Z.f}),r.push({s:-1,f:25001});var a=r[0],c=r[1],u=0,f=1,y=2;for(r[0]={s:-1,f:a.f+c.f,l:a,r:c};f!=i-1;)a=r[r[u].f<r[y].f?u++:y++],c=r[u!=f&&r[u].f<r[y].f?u++:y++],r[f++]={s:-1,f:a.f+c.f,l:a,r:c};for(var v=o[0].s,n=1;n<i;++n)o[n].s>v&&(v=o[n].s);var p=new eo(v+1),I=pm(r[f-1],p,0);if(I>e){var n=0,P=0,w=I-e,x=1<<w;for(o.sort(function(Z,k){return p[k.s]-p[Z.s]||Z.f-k.f});n<i;++n){var j=o[n].s;if(p[j]>e)P+=x-(1<<I-p[j]),p[j]=e;else break}for(P>>=w;P>0;){var ne=o[n].s;p[ne]<e?P-=1<<e-p[ne]++-1:++n}for(;n>=0&&P;--n){var Q=o[n].s;p[Q]==e&&(--p[Q],++P)}I=e}return{t:new Si(p),l:I}},pm=function(t,e,r){return t.s==-1?Math.max(pm(t.l,e,r+1),pm(t.r,e,r+1)):e[t.s]=r},L0=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new eo(++e),n=0,i=t[0],o=1,s=function(c){r[n++]=c},a=1;a<=e;++a)if(t[a]==i&&a!=e)++o;else{if(!i&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(i),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(i);o=1,i=t[a]}return{c:r.subarray(0,n),n:e}},eu=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},E5=function(t,e,r){var n=r.length,i=Ry(e+2);t[i]=n&255,t[i+1]=n>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var o=0;o<n;++o)t[i+o+4]=r[o];return(i+4+n)*8},D0=function(t,e,r,n,i,o,s,a,c,u,f){Ps(e,f++,r),++i[256];for(var y=hp(i,15),v=y.t,p=y.l,I=hp(o,15),P=I.t,w=I.l,x=L0(v),j=x.c,ne=x.n,Q=L0(P),K=Q.c,Z=Q.n,k=new eo(19),C=0;C<j.length;++C)++k[j[C]&31];for(var C=0;C<K.length;++C)++k[K[C]&31];for(var E=hp(k,7),M=E.t,_=E.l,S=19;S>4&&!M[dm[S-1]];--S);var b=u+5<<3,Y=eu(i,Ma)+eu(o,Bu)+s,te=eu(i,v)+eu(o,P)+s+14+3*S+eu(k,M)+2*k[16]+3*k[17]+7*k[18];if(c>=0&&b<=Y&&b<=te)return E5(e,f,t.subarray(c,c+u));var O,D,X,H;if(Ps(e,f,1+(te<Y)),f+=2,te<Y){O=is(v,p,0),D=v,X=is(P,w,0),H=P;var F=is(M,_,0);Ps(e,f,ne-257),Ps(e,f+5,Z-1),Ps(e,f+10,S-4),f+=14;for(var C=0;C<S;++C)Ps(e,f+3*C,M[dm[C]]);f+=3*S;for(var ie=[j,K],$=0;$<2;++$)for(var L=ie[$],C=0;C<L.length;++C){var U=L[C]&31;Ps(e,f,F[U]),f+=M[U],U>15&&(Ps(e,f,L[C]>>5&127),f+=L[C]>>12)}}else O=QN,D=Ma,X=ZN,H=Bu;for(var C=0;C<a;++C){var N=n[C];if(N>255){var U=N>>18&31;Zc(e,f,O[U+257]),f+=D[U+257],U>7&&(Ps(e,f,N>>23&31),f+=uf[U]);var z=N&31;Zc(e,f,X[z]),f+=H[z],z>3&&(Zc(e,f,N>>5&8191),f+=df[z])}else Zc(e,f,O[N]),f+=D[N]}return Zc(e,f,O[256]),f+D[256]},nL=new Dy([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),T5=new Si(0),iL=function(t,e,r,n,i,o){var s=o.z||t.length,a=new Si(n+s+5*(1+Math.ceil(s/7e3))+i),c=a.subarray(n,a.length-i),u=o.l,f=(o.r||0)&7;if(e){f&&(c[0]=o.r>>3);for(var y=nL[e-1],v=y>>13,p=y&8191,I=(1<<r)-1,P=o.p||new eo(32768),w=o.h||new eo(I+1),x=Math.ceil(r/3),j=2*x,ne=function(de){return(t[de]^t[de+1]<<x^t[de+2]<<j)&I},Q=new Dy(25e3),K=new eo(288),Z=new eo(32),k=0,C=0,E=o.i||0,M=0,_=o.w||0,S=0;E+2<s;++E){var b=ne(E),Y=E&32767,te=w[b];if(P[Y]=te,w[b]=Y,_<=E){var O=s-E;if((k>7e3||M>24576)&&(O>423||!u)){f=D0(t,c,0,Q,K,Z,C,M,S,E-S,f),M=k=C=0,S=E;for(var D=0;D<286;++D)K[D]=0;for(var D=0;D<30;++D)Z[D]=0}var X=2,H=0,F=p,ie=Y-te&32767;if(O>2&&b==ne(E-ie))for(var $=Math.min(v,O)-1,L=Math.min(32767,E),U=Math.min(258,O);ie<=L&&--F&&Y!=te;){if(t[E+X]==t[E+X-ie]){for(var N=0;N<U&&t[E+N]==t[E+N-ie];++N);if(N>X){if(X=N,H=ie,N>$)break;for(var z=Math.min(ie,N-2),oe=0,D=0;D<z;++D){var G=E-ie+D&32767,ee=P[G],J=G-ee&32767;J>oe&&(oe=J,te=G)}}}Y=te,te=P[Y],ie+=Y-te&32767}if(H){Q[M++]=268435456|hm[X]<<18|N0[H];var W=hm[X]&31,q=N0[H]&31;C+=uf[W]+df[q],++K[257+W],++Z[q],_=E+X,++k}else Q[M++]=t[E],++K[t[E]]}}for(E=Math.max(E,_);E<s;++E)Q[M++]=t[E],++K[t[E]];f=D0(t,c,u,Q,K,Z,C,M,S,E-S,f),u||(o.r=f&7|c[f/8|0]<<3,f-=7,o.h=w,o.p=P,o.i=E,o.w=_)}else{for(var E=o.w||0;E<s+u;E+=65535){var ae=E+65535;ae>=s&&(c[f/8|0]=u,ae=s),f=E5(c,f+1,t.subarray(E,ae))}o.i=s}return k5(a,0,n+Ry(f)+i)},N5=function(){var t=1,e=0;return{p:function(r){for(var n=t,i=e,o=r.length|0,s=0;s!=o;){for(var a=Math.min(s+2655,o);s<a;++s)i+=n+=r[s];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}t=n,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},oL=function(t,e,r,n,i){if(!i&&(i={l:1},e.dictionary)){var o=e.dictionary.subarray(-32768),s=new Si(o.length+t.length);s.set(o),s.set(t,o.length),t=s,i.w=o.length}return iL(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,i)},L5=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},sL=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=N5();i.p(e.dictionary),L5(t,2,i.d())}},aL=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&To(6,"invalid zlib data"),(t[1]>>5&1)==1&&To(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function mm(t,e){e||(e={});var r=N5();r.p(t);var n=oL(t,e,e.dictionary?6:2,4);return sL(n,e),L5(n,n.length-4,r.d()),n}function lL(t,e){return rL(t.subarray(aL(t),-4),{i:2},e,e)}var cL=typeof TextDecoder<"u"&&new TextDecoder,uL=0;try{cL.decode(T5,{stream:!0}),uL=1}catch{}var lr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function fp(){lr.console&&typeof lr.console.log=="function"&&lr.console.log.apply(lr.console,arguments)}var cn={log:fp,warn:function(t){lr.console&&(typeof lr.console.warn=="function"?lr.console.warn.apply(lr.console,arguments):fp.call(null,arguments))},error:function(t){lr.console&&(typeof lr.console.error=="function"?lr.console.error.apply(lr.console,arguments):fp(t))}};function pp(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){al(n.response,e,r)},n.onerror=function(){cn.error("could not download file")},n.send()}function R0(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function qd(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var gu,ym,al=lr.saveAs||((typeof window>"u"?"undefined":rn(window))!=="object"||window!==lr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=lr.URL||lr.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?R0(i.href)?pp(t,e,r):qd(i,i.target="_blank"):qd(i)):(i.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){qd(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(R0(t))pp(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){qd(n)})}else navigator.msSaveOrOpenBlob(function(i,o){return o===void 0?o={autoBom:!1}:rn(o)!=="object"&&(cn.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return pp(t,e,r);var i=t.type==="application/octet-stream",o=/constructor/i.test(lr.HTMLElement)||lr.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&o)&&(typeof FileReader>"u"?"undefined":rn(FileReader))==="object"){var a=new FileReader;a.onloadend=function(){var f=a.result;f=s?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=f:location=f,n=null},a.readAsDataURL(t)}else{var c=lr.URL||lr.webkitURL,u=c.createObjectURL(t);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function D5(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,o=r[n].process,s=i.exec(t);s&&(e=o(s),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return a.length==1&&(a="0"+a),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+a+c+u}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function mp(t,e){var r=t[0],n=t[1],i=t[2],o=t[3];r=mi(r,n,i,o,e[0],7,-680876936),o=mi(o,r,n,i,e[1],12,-389564586),i=mi(i,o,r,n,e[2],17,606105819),n=mi(n,i,o,r,e[3],22,-1044525330),r=mi(r,n,i,o,e[4],7,-176418897),o=mi(o,r,n,i,e[5],12,1200080426),i=mi(i,o,r,n,e[6],17,-1473231341),n=mi(n,i,o,r,e[7],22,-45705983),r=mi(r,n,i,o,e[8],7,1770035416),o=mi(o,r,n,i,e[9],12,-1958414417),i=mi(i,o,r,n,e[10],17,-42063),n=mi(n,i,o,r,e[11],22,-1990404162),r=mi(r,n,i,o,e[12],7,1804603682),o=mi(o,r,n,i,e[13],12,-40341101),i=mi(i,o,r,n,e[14],17,-1502002290),r=yi(r,n=mi(n,i,o,r,e[15],22,1236535329),i,o,e[1],5,-165796510),o=yi(o,r,n,i,e[6],9,-1069501632),i=yi(i,o,r,n,e[11],14,643717713),n=yi(n,i,o,r,e[0],20,-373897302),r=yi(r,n,i,o,e[5],5,-701558691),o=yi(o,r,n,i,e[10],9,38016083),i=yi(i,o,r,n,e[15],14,-660478335),n=yi(n,i,o,r,e[4],20,-405537848),r=yi(r,n,i,o,e[9],5,568446438),o=yi(o,r,n,i,e[14],9,-1019803690),i=yi(i,o,r,n,e[3],14,-187363961),n=yi(n,i,o,r,e[8],20,1163531501),r=yi(r,n,i,o,e[13],5,-1444681467),o=yi(o,r,n,i,e[2],9,-51403784),i=yi(i,o,r,n,e[7],14,1735328473),r=gi(r,n=yi(n,i,o,r,e[12],20,-1926607734),i,o,e[5],4,-378558),o=gi(o,r,n,i,e[8],11,-2022574463),i=gi(i,o,r,n,e[11],16,1839030562),n=gi(n,i,o,r,e[14],23,-35309556),r=gi(r,n,i,o,e[1],4,-1530992060),o=gi(o,r,n,i,e[4],11,1272893353),i=gi(i,o,r,n,e[7],16,-155497632),n=gi(n,i,o,r,e[10],23,-1094730640),r=gi(r,n,i,o,e[13],4,681279174),o=gi(o,r,n,i,e[0],11,-358537222),i=gi(i,o,r,n,e[3],16,-722521979),n=gi(n,i,o,r,e[6],23,76029189),r=gi(r,n,i,o,e[9],4,-640364487),o=gi(o,r,n,i,e[12],11,-421815835),i=gi(i,o,r,n,e[15],16,530742520),r=vi(r,n=gi(n,i,o,r,e[2],23,-995338651),i,o,e[0],6,-198630844),o=vi(o,r,n,i,e[7],10,1126891415),i=vi(i,o,r,n,e[14],15,-1416354905),n=vi(n,i,o,r,e[5],21,-57434055),r=vi(r,n,i,o,e[12],6,1700485571),o=vi(o,r,n,i,e[3],10,-1894986606),i=vi(i,o,r,n,e[10],15,-1051523),n=vi(n,i,o,r,e[1],21,-2054922799),r=vi(r,n,i,o,e[8],6,1873313359),o=vi(o,r,n,i,e[15],10,-30611744),i=vi(i,o,r,n,e[6],15,-1560198380),n=vi(n,i,o,r,e[13],21,1309151649),r=vi(r,n,i,o,e[4],6,-145523070),o=vi(o,r,n,i,e[11],10,-1120210379),i=vi(i,o,r,n,e[2],15,718787259),n=vi(n,i,o,r,e[9],21,-343485551),t[0]=wa(r,t[0]),t[1]=wa(n,t[1]),t[2]=wa(i,t[2]),t[3]=wa(o,t[3])}function hf(t,e,r,n,i,o){return e=wa(wa(e,t),wa(n,o)),wa(e<<i|e>>>32-i,r)}function mi(t,e,r,n,i,o,s){return hf(e&r|~e&n,t,e,i,o,s)}function yi(t,e,r,n,i,o,s){return hf(e&n|r&~n,t,e,i,o,s)}function gi(t,e,r,n,i,o,s){return hf(e^r^n,t,e,i,o,s)}function vi(t,e,r,n,i,o,s){return hf(r^(e|~n),t,e,i,o,s)}function R5(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)mp(n,dL(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(mp(n,i),e=0;e<16;e++)i[e]=0;return i[14]=8*r,mp(n,i),n}function dL(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}gu=lr.atob.bind(lr),ym=lr.btoa.bind(lr);var M0="0123456789abcdef".split("");function hL(t){for(var e="",r=0;r<4;r++)e+=M0[t>>8*r+4&15]+M0[t>>8*r&15];return e}function fL(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function gm(t){return R5(t).map(fL).join("")}var pL=function(t){for(var e=0;e<t.length;e++)t[e]=hL(t[e]);return t.join("")}(R5("hello"))!="5d41402abc4b2a76b9719d911017c592";function wa(t,e){if(pL){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function vm(t,e){var r,n,i,o;if(t!==r){for(var s=(i=t,o=1+(256/t.length>>0),new Array(o+1).join(i)),a=[],c=0;c<256;c++)a[c]=c;var u=0;for(c=0;c<256;c++){var f=a[c];u=(u+f+s.charCodeAt(c))%256,a[c]=a[u],a[u]=f}r=t,n=a}else a=n;var y=e.length,v=0,p=0,I="";for(c=0;c<y;c++)p=(p+(f=a[v=(v+1)%256]))%256,a[v]=a[p],a[p]=f,s=a[(a[v]+a[p])%256],I+=String.fromCharCode(e.charCodeAt(c)^s);return I}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var F0={print:4,modify:8,copy:16,"annot-forms":32};function sc(t,e,r,n){this.v=1,this.r=2;var i=192;t.forEach(function(a){if(F0.perm!==void 0)throw new Error("Invalid permission: "+a);i+=F0[a]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var o=(e+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,s),this.P=-(1+(255^i)),this.encryptionKey=gm(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=vm(this.encryptionKey,this.padding)}function ac(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var i=t.charCodeAt(n);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?e+="#"+("0"+i.toString(16)).slice(-2):e+=t[n]}return e}function O0(t){if(rn(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var o=Math.random().toString(35);return e[r][o]=[n,!!i],o},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var o in e[r]){var s=e[r][o];try{s[0].apply(t,n)}catch(a){lr.console&&cn.error("jsPDF PubSub Error",a.message,a)}s[1]&&i.push(o)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function ju(t){if(!(this instanceof ju))return new ju(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function M5(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function ba(t,e,r,n,i){if(!(this instanceof ba))return new ba(t,e,r,n,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,M5.call(this,n,i)}function ml(t,e,r,n,i){if(!(this instanceof ml))return new ml(t,e,r,n,i);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,M5.call(this,n,i)}function sr(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],o=arguments[3],s=[],a=1,c=16,u="S",f=null;rn(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,i=t.format||i,o=t.compress||t.compressPdf||o,(f=t.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),a=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),u=t.defaultPathOperation||"S"),s=t.filters||(o===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var y=t.putOnlyUsedFonts||!1,v={},p={internal:{},__private__:{}};p.__private__.PubSub=O0;var I="1.3",P=p.__private__.getPdfVersion=function(){return I};p.__private__.setPdfVersion=function(A){I=A};var w={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return w};var x=p.__private__.getPageFormat=function(A){return w[A]};i=i||"a4";var j={COMPAT:"compat",ADVANCED:"advanced"},ne=j.COMPAT;function Q(){this.saveGraphicsState(),V(new yt(Fe,0,0,-Fe,0,fi()*Fe).toString()+" cm"),this.setFontSize(this.getFontSize()/Fe),u="n",ne=j.ADVANCED}function K(){this.restoreGraphicsState(),u="S",ne=j.COMPAT}var Z=p.__private__.combineFontStyleAndFontWeight=function(A,pe){if(A=="bold"&&pe=="normal"||A=="bold"&&pe==400||A=="normal"&&pe=="italic"||A=="bold"&&pe=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return pe&&(A=pe==400||pe==="normal"?A==="italic"?"italic":"normal":pe!=700&&pe!=="bold"||A!=="normal"?(pe==700?"bold":pe)+""+A:"bold"),A};p.advancedAPI=function(A){var pe=ne===j.COMPAT;return pe&&Q.call(this),typeof A!="function"||(A(this),pe&&K.call(this)),this},p.compatAPI=function(A){var pe=ne===j.ADVANCED;return pe&&K.call(this),typeof A!="function"||(A(this),pe&&Q.call(this)),this},p.isAdvancedAPI=function(){return ne===j.ADVANCED};var k,C=function(A){if(ne!==j.ADVANCED)throw new Error(A+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},E=p.roundToPrecision=p.__private__.roundToPrecision=function(A,pe){var Le=e||pe;if(isNaN(A)||isNaN(Le))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return A.toFixed(Le).replace(/0+$/,"")};k=p.hpf=p.__private__.hpf=typeof c=="number"?function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.hpf");return E(A,c)}:c==="smart"?function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.hpf");return E(A,A>-1&&A<1?16:5)}:function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.hpf");return E(A,16)};var M=p.f2=p.__private__.f2=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.f2");return E(A,2)},_=p.__private__.f3=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.f3");return E(A,3)},S=p.scale=p.__private__.scale=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.scale");return ne===j.COMPAT?A*Fe:ne===j.ADVANCED?A:void 0},b=function(A){return ne===j.COMPAT?fi()-A:ne===j.ADVANCED?A:void 0},Y=function(A){return S(b(A))};p.__private__.setPrecision=p.setPrecision=function(A){typeof parseInt(A,10)=="number"&&(e=parseInt(A,10))};var te,O="00000000000000000000000000000000",D=p.__private__.getFileId=function(){return O},X=p.__private__.setFileId=function(A){return O=A!==void 0&&/^[a-fA-F0-9]{32}$/.test(A)?A.toUpperCase():O.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(sn=new sc(f.userPermissions,f.userPassword,f.ownerPassword,O)),O};p.setFileId=function(A){return X(A),this},p.getFileId=function(){return D()};var H=p.__private__.convertDateToPDFDate=function(A){var pe=A.getTimezoneOffset(),Le=pe<0?"+":"-",Me=Math.floor(Math.abs(pe/60)),ze=Math.abs(pe%60),it=[Le,U(Me),"'",U(ze),"'"].join("");return["D:",A.getFullYear(),U(A.getMonth()+1),U(A.getDate()),U(A.getHours()),U(A.getMinutes()),U(A.getSeconds()),it].join("")},F=p.__private__.convertPDFDateToDate=function(A){var pe=parseInt(A.substr(2,4),10),Le=parseInt(A.substr(6,2),10)-1,Me=parseInt(A.substr(8,2),10),ze=parseInt(A.substr(10,2),10),it=parseInt(A.substr(12,2),10),Ct=parseInt(A.substr(14,2),10);return new Date(pe,Le,Me,ze,it,Ct,0)},ie=p.__private__.setCreationDate=function(A){var pe;if(A===void 0&&(A=new Date),A instanceof Date)pe=H(A);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(A))throw new Error("Invalid argument passed to jsPDF.setCreationDate");pe=A}return te=pe},$=p.__private__.getCreationDate=function(A){var pe=te;return A==="jsDate"&&(pe=F(te)),pe};p.setCreationDate=function(A){return ie(A),this},p.getCreationDate=function(A){return $(A)};var L,U=p.__private__.padd2=function(A){return("0"+parseInt(A)).slice(-2)},N=p.__private__.padd2Hex=function(A){return("00"+(A=A.toString())).substr(A.length)},z=0,oe=[],G=[],ee=0,J=[],W=[],q=!1,ae=G,de=function(){z=0,ee=0,G=[],oe=[],J=[],Ze=ht(),Vt=ht()};p.__private__.setCustomOutputDestination=function(A){q=!0,ae=A};var le=function(A){q||(ae=A)};p.__private__.resetCustomOutputDestination=function(){q=!1,ae=G};var V=p.__private__.out=function(A){return A=A.toString(),ee+=A.length+1,ae.push(A),ae},ce=p.__private__.write=function(A){return V(arguments.length===1?A.toString():Array.prototype.join.call(arguments," "))},Pe=p.__private__.getArrayBuffer=function(A){for(var pe=A.length,Le=new ArrayBuffer(pe),Me=new Uint8Array(Le);pe--;)Me[pe]=A.charCodeAt(pe);return Le},fe=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return fe};var be=t.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(A){return be=ne===j.ADVANCED?A/Fe:A,this};var xe,he=p.__private__.getFontSize=p.getFontSize=function(){return ne===j.COMPAT?be:be*Fe},ve=t.R2L||!1;p.__private__.setR2L=p.setR2L=function(A){return ve=A,this},p.__private__.getR2L=p.getR2L=function(){return ve};var De,Ee=p.__private__.setZoomMode=function(A){var pe=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(A))xe=A;else if(isNaN(A)){if(pe.indexOf(A)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+A+'" is not recognized.');xe=A}else xe=parseInt(A,10)};p.__private__.getZoomMode=function(){return xe};var Ce,Ne=p.__private__.setPageMode=function(A){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(A)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+A+'" is not recognized.');De=A};p.__private__.getPageMode=function(){return De};var Ie=p.__private__.setLayoutMode=function(A){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(A)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+A+'" is not recognized.');Ce=A};p.__private__.getLayoutMode=function(){return Ce},p.__private__.setDisplayMode=p.setDisplayMode=function(A,pe,Le){return Ee(A),Ie(pe),Ne(Le),this};var Re={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(A){if(Object.keys(Re).indexOf(A)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Re[A]},p.__private__.getDocumentProperties=function(){return Re},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(A){for(var pe in Re)Re.hasOwnProperty(pe)&&A[pe]&&(Re[pe]=A[pe]);return this},p.__private__.setDocumentProperty=function(A,pe){if(Object.keys(Re).indexOf(A)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Re[A]=pe};var We,Fe,Xe,tt,At,rt={},He={},xt=[],_t={},mt={},Et={},et={},qe=null,ot=0,Je=[],at=new O0(p),dt=t.hotfixes||[],It={},jt={},Gt=[],yt=function A(pe,Le,Me,ze,it,Ct){if(!(this instanceof A))return new A(pe,Le,Me,ze,it,Ct);isNaN(pe)&&(pe=1),isNaN(Le)&&(Le=0),isNaN(Me)&&(Me=0),isNaN(ze)&&(ze=1),isNaN(it)&&(it=0),isNaN(Ct)&&(Ct=0),this._matrix=[pe,Le,Me,ze,it,Ct]};Object.defineProperty(yt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(A){this._matrix[0]=A}}),Object.defineProperty(yt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(A){this._matrix[1]=A}}),Object.defineProperty(yt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(A){this._matrix[2]=A}}),Object.defineProperty(yt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(A){this._matrix[3]=A}}),Object.defineProperty(yt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(A){this._matrix[4]=A}}),Object.defineProperty(yt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(A){this._matrix[5]=A}}),Object.defineProperty(yt.prototype,"a",{get:function(){return this._matrix[0]},set:function(A){this._matrix[0]=A}}),Object.defineProperty(yt.prototype,"b",{get:function(){return this._matrix[1]},set:function(A){this._matrix[1]=A}}),Object.defineProperty(yt.prototype,"c",{get:function(){return this._matrix[2]},set:function(A){this._matrix[2]=A}}),Object.defineProperty(yt.prototype,"d",{get:function(){return this._matrix[3]},set:function(A){this._matrix[3]=A}}),Object.defineProperty(yt.prototype,"e",{get:function(){return this._matrix[4]},set:function(A){this._matrix[4]=A}}),Object.defineProperty(yt.prototype,"f",{get:function(){return this._matrix[5]},set:function(A){this._matrix[5]=A}}),Object.defineProperty(yt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(yt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(yt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(yt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),yt.prototype.join=function(A){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(k).join(A)},yt.prototype.multiply=function(A){var pe=A.sx*this.sx+A.shy*this.shx,Le=A.sx*this.shy+A.shy*this.sy,Me=A.shx*this.sx+A.sy*this.shx,ze=A.shx*this.shy+A.sy*this.sy,it=A.tx*this.sx+A.ty*this.shx+this.tx,Ct=A.tx*this.shy+A.ty*this.sy+this.ty;return new yt(pe,Le,Me,ze,it,Ct)},yt.prototype.decompose=function(){var A=this.sx,pe=this.shy,Le=this.shx,Me=this.sy,ze=this.tx,it=this.ty,Ct=Math.sqrt(A*A+pe*pe),Dt=(A/=Ct)*Le+(pe/=Ct)*Me;Le-=A*Dt,Me-=pe*Dt;var h=Math.sqrt(Le*Le+Me*Me);return Dt/=h,A*(Me/=h)<pe*(Le/=h)&&(A=-A,pe=-pe,Dt=-Dt,Ct=-Ct),{scale:new yt(Ct,0,0,h,0,0),translate:new yt(1,0,0,1,ze,it),rotate:new yt(A,pe,-pe,A,0,0),skew:new yt(1,0,Dt,1,0,0)}},yt.prototype.toString=function(A){return this.join(" ")},yt.prototype.inversed=function(){var A=this.sx,pe=this.shy,Le=this.shx,Me=this.sy,ze=this.tx,it=this.ty,Ct=1/(A*Me-pe*Le),Dt=Me*Ct,h=-pe*Ct,R=-Le*Ct,se=A*Ct;return new yt(Dt,h,R,se,-Dt*ze-R*it,-h*ze-se*it)},yt.prototype.applyToPoint=function(A){var pe=A.x*this.sx+A.y*this.shx+this.tx,Le=A.x*this.shy+A.y*this.sy+this.ty;return new hs(pe,Le)},yt.prototype.applyToRectangle=function(A){var pe=this.applyToPoint(A),Le=this.applyToPoint(new hs(A.x+A.w,A.y+A.h));return new Ys(pe.x,pe.y,Le.x-pe.x,Le.y-pe.y)},yt.prototype.clone=function(){var A=this.sx,pe=this.shy,Le=this.shx,Me=this.sy,ze=this.tx,it=this.ty;return new yt(A,pe,Le,Me,ze,it)},p.Matrix=yt;var Qt=p.matrixMult=function(A,pe){return pe.multiply(A)},Mt=new yt(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=Mt;var Kt=function(A,pe){if(!mt[A]){var Le=(pe instanceof ba?"Sh":"P")+(Object.keys(_t).length+1).toString(10);pe.id=Le,mt[A]=Le,_t[Le]=pe,at.publish("addPattern",pe)}};p.ShadingPattern=ba,p.TilingPattern=ml,p.addShadingPattern=function(A,pe){return C("addShadingPattern()"),Kt(A,pe),this},p.beginTilingPattern=function(A){C("beginTilingPattern()"),Ks(A.boundingBox[0],A.boundingBox[1],A.boundingBox[2]-A.boundingBox[0],A.boundingBox[3]-A.boundingBox[1],A.matrix)},p.endTilingPattern=function(A,pe){C("endTilingPattern()"),pe.stream=W[L].join(`
`),Kt(A,pe),at.publish("endTilingPattern",pe),Gt.pop().restore()};var Xt=p.__private__.newObject=function(){var A=ht();return wt(A,!0),A},ht=p.__private__.newObjectDeferred=function(){return z++,oe[z]=function(){return ee},z},wt=function(A,pe){return pe=typeof pe=="boolean"&&pe,oe[A]=ee,pe&&V(A+" 0 obj"),A},Ut=p.__private__.newAdditionalObject=function(){var A={objId:ht(),content:""};return J.push(A),A},Ze=ht(),Vt=ht(),Ft=p.__private__.decodeColorString=function(A){var pe=A.split(" ");if(pe.length!==2||pe[1]!=="g"&&pe[1]!=="G")pe.length===5&&(pe[4]==="k"||pe[4]==="K")&&(pe=[(1-pe[0])*(1-pe[3]),(1-pe[1])*(1-pe[3]),(1-pe[2])*(1-pe[3]),"r"]);else{var Le=parseFloat(pe[0]);pe=[Le,Le,Le,"r"]}for(var Me="#",ze=0;ze<3;ze++)Me+=("0"+Math.floor(255*parseFloat(pe[ze])).toString(16)).slice(-2);return Me},Jt=p.__private__.encodeColorString=function(A){var pe;typeof A=="string"&&(A={ch1:A});var Le=A.ch1,Me=A.ch2,ze=A.ch3,it=A.ch4,Ct=A.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Le=="string"&&Le.charAt(0)!=="#"){var Dt=new D5(Le);if(Dt.ok)Le=Dt.toHex();else if(!/^\d*\.?\d*$/.test(Le))throw new Error('Invalid color "'+Le+'" passed to jsPDF.encodeColorString.')}if(typeof Le=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Le)&&(Le="#"+Le[1]+Le[1]+Le[2]+Le[2]+Le[3]+Le[3]),typeof Le=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Le)){var h=parseInt(Le.substr(1),16);Le=h>>16&255,Me=h>>8&255,ze=255&h}if(Me===void 0||it===void 0&&Le===Me&&Me===ze)if(typeof Le=="string")pe=Le+" "+Ct[0];else switch(A.precision){case 2:pe=M(Le/255)+" "+Ct[0];break;case 3:default:pe=_(Le/255)+" "+Ct[0]}else if(it===void 0||rn(it)==="object"){if(it&&!isNaN(it.a)&&it.a===0)return pe=["1.","1.","1.",Ct[1]].join(" ");if(typeof Le=="string")pe=[Le,Me,ze,Ct[1]].join(" ");else switch(A.precision){case 2:pe=[M(Le/255),M(Me/255),M(ze/255),Ct[1]].join(" ");break;default:case 3:pe=[_(Le/255),_(Me/255),_(ze/255),Ct[1]].join(" ")}}else if(typeof Le=="string")pe=[Le,Me,ze,it,Ct[2]].join(" ");else switch(A.precision){case 2:pe=[M(Le),M(Me),M(ze),M(it),Ct[2]].join(" ");break;case 3:default:pe=[_(Le),_(Me),_(ze),_(it),Ct[2]].join(" ")}return pe},er=p.__private__.getFilters=function(){return s},gt=p.__private__.putStream=function(A){var pe=(A=A||{}).data||"",Le=A.filters||er(),Me=A.alreadyAppliedFilters||[],ze=A.addLength1||!1,it=pe.length,Ct=A.objectId,Dt=function(vr){return vr};if(f!==null&&Ct===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(Dt=sn.encryptor(Ct,0));var h={};Le===!0&&(Le=["FlateEncode"]);var R=A.additionalKeyValues||[],se=(h=sr.API.processDataByFilters!==void 0?sr.API.processDataByFilters(pe,Le):{data:pe,reverseChain:[]}).reverseChain+(Array.isArray(Me)?Me.join(" "):Me.toString());if(h.data.length!==0&&(R.push({key:"Length",value:h.data.length}),ze===!0&&R.push({key:"Length1",value:it})),se.length!=0)if(se.split("/").length-1==1)R.push({key:"Filter",value:se});else{R.push({key:"Filter",value:"["+se+"]"});for(var _e=0;_e<R.length;_e+=1)if(R[_e].key==="DecodeParms"){for(var Ve=[],Qe=0;Qe<h.reverseChain.split("/").length-1;Qe+=1)Ve.push("null");Ve.push(R[_e].value),R[_e].value="["+Ve.join(" ")+"]"}}V("<<");for(var $t=0;$t<R.length;$t++)V("/"+R[$t].key+" "+R[$t].value);V(">>"),h.data.length!==0&&(V("stream"),V(Dt(h.data)),V("endstream"))},dr=p.__private__.putPage=function(A){var pe=A.number,Le=A.data,Me=A.objId,ze=A.contentsObjId;wt(Me,!0),V("<</Type /Page"),V("/Parent "+A.rootDictionaryObjId+" 0 R"),V("/Resources "+A.resourceDictionaryObjId+" 0 R"),V("/MediaBox ["+parseFloat(k(A.mediaBox.bottomLeftX))+" "+parseFloat(k(A.mediaBox.bottomLeftY))+" "+k(A.mediaBox.topRightX)+" "+k(A.mediaBox.topRightY)+"]"),A.cropBox!==null&&V("/CropBox ["+k(A.cropBox.bottomLeftX)+" "+k(A.cropBox.bottomLeftY)+" "+k(A.cropBox.topRightX)+" "+k(A.cropBox.topRightY)+"]"),A.bleedBox!==null&&V("/BleedBox ["+k(A.bleedBox.bottomLeftX)+" "+k(A.bleedBox.bottomLeftY)+" "+k(A.bleedBox.topRightX)+" "+k(A.bleedBox.topRightY)+"]"),A.trimBox!==null&&V("/TrimBox ["+k(A.trimBox.bottomLeftX)+" "+k(A.trimBox.bottomLeftY)+" "+k(A.trimBox.topRightX)+" "+k(A.trimBox.topRightY)+"]"),A.artBox!==null&&V("/ArtBox ["+k(A.artBox.bottomLeftX)+" "+k(A.artBox.bottomLeftY)+" "+k(A.artBox.topRightX)+" "+k(A.artBox.topRightY)+"]"),typeof A.userUnit=="number"&&A.userUnit!==1&&V("/UserUnit "+A.userUnit),at.publish("putPage",{objId:Me,pageContext:Je[pe],pageNumber:pe,page:Le}),V("/Contents "+ze+" 0 R"),V(">>"),V("endobj");var it=Le.join(`
`);return ne===j.ADVANCED&&(it+=`
Q`),wt(ze,!0),gt({data:it,filters:er(),objectId:ze}),V("endobj"),Me},Er=p.__private__.putPages=function(){var A,pe,Le=[];for(A=1;A<=ot;A++)Je[A].objId=ht(),Je[A].contentsObjId=ht();for(A=1;A<=ot;A++)Le.push(dr({number:A,data:W[A],objId:Je[A].objId,contentsObjId:Je[A].contentsObjId,mediaBox:Je[A].mediaBox,cropBox:Je[A].cropBox,bleedBox:Je[A].bleedBox,trimBox:Je[A].trimBox,artBox:Je[A].artBox,userUnit:Je[A].userUnit,rootDictionaryObjId:Ze,resourceDictionaryObjId:Vt}));wt(Ze,!0),V("<</Type /Pages");var Me="/Kids [";for(pe=0;pe<ot;pe++)Me+=Le[pe]+" 0 R ";V(Me+"]"),V("/Count "+ot),V(">>"),V("endobj"),at.publish("postPutPages")},mr=function(A){at.publish("putFont",{font:A,out:V,newObject:Xt,putStream:gt}),A.isAlreadyPutted!==!0&&(A.objectNumber=Xt(),V("<<"),V("/Type /Font"),V("/BaseFont /"+ac(A.postScriptName)),V("/Subtype /Type1"),typeof A.encoding=="string"&&V("/Encoding /"+A.encoding),V("/FirstChar 32"),V("/LastChar 255"),V(">>"),V("endobj"))},xr=function(){for(var A in rt)rt.hasOwnProperty(A)&&(y===!1||y===!0&&v.hasOwnProperty(A))&&mr(rt[A])},Vr=function(A){A.objectNumber=Xt();var pe=[];pe.push({key:"Type",value:"/XObject"}),pe.push({key:"Subtype",value:"/Form"}),pe.push({key:"BBox",value:"["+[k(A.x),k(A.y),k(A.x+A.width),k(A.y+A.height)].join(" ")+"]"}),pe.push({key:"Matrix",value:"["+A.matrix.toString()+"]"});var Le=A.pages[1].join(`
`);gt({data:Le,additionalKeyValues:pe,objectId:A.objectNumber}),V("endobj")},kt=function(){for(var A in It)It.hasOwnProperty(A)&&Vr(It[A])},Cr=function(A,pe){var Le,Me=[],ze=1/(pe-1);for(Le=0;Le<1;Le+=ze)Me.push(Le);if(Me.push(1),A[0].offset!=0){var it={offset:0,color:A[0].color};A.unshift(it)}if(A[A.length-1].offset!=1){var Ct={offset:1,color:A[A.length-1].color};A.push(Ct)}for(var Dt="",h=0,R=0;R<Me.length;R++){for(Le=Me[R];Le>A[h+1].offset;)h++;var se=A[h].offset,_e=(Le-se)/(A[h+1].offset-se),Ve=A[h].color,Qe=A[h+1].color;Dt+=N(Math.round((1-_e)*Ve[0]+_e*Qe[0]).toString(16))+N(Math.round((1-_e)*Ve[1]+_e*Qe[1]).toString(16))+N(Math.round((1-_e)*Ve[2]+_e*Qe[2]).toString(16))}return Dt.trim()},$r=function(A,pe){pe||(pe=21);var Le=Xt(),Me=Cr(A.colors,pe),ze=[];ze.push({key:"FunctionType",value:"0"}),ze.push({key:"Domain",value:"[0.0 1.0]"}),ze.push({key:"Size",value:"["+pe+"]"}),ze.push({key:"BitsPerSample",value:"8"}),ze.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ze.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),gt({data:Me,additionalKeyValues:ze,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Le}),V("endobj"),A.objectNumber=Xt(),V("<< /ShadingType "+A.type),V("/ColorSpace /DeviceRGB");var it="/Coords ["+k(parseFloat(A.coords[0]))+" "+k(parseFloat(A.coords[1]))+" ";A.type===2?it+=k(parseFloat(A.coords[2]))+" "+k(parseFloat(A.coords[3])):it+=k(parseFloat(A.coords[2]))+" "+k(parseFloat(A.coords[3]))+" "+k(parseFloat(A.coords[4]))+" "+k(parseFloat(A.coords[5])),V(it+="]"),A.matrix&&V("/Matrix ["+A.matrix.toString()+"]"),V("/Function "+Le+" 0 R"),V("/Extend [true true]"),V(">>"),V("endobj")},hr=function(A,pe){var Le=ht(),Me=Xt();pe.push({resourcesOid:Le,objectOid:Me}),A.objectNumber=Me;var ze=[];ze.push({key:"Type",value:"/Pattern"}),ze.push({key:"PatternType",value:"1"}),ze.push({key:"PaintType",value:"1"}),ze.push({key:"TilingType",value:"1"}),ze.push({key:"BBox",value:"["+A.boundingBox.map(k).join(" ")+"]"}),ze.push({key:"XStep",value:k(A.xStep)}),ze.push({key:"YStep",value:k(A.yStep)}),ze.push({key:"Resources",value:Le+" 0 R"}),A.matrix&&ze.push({key:"Matrix",value:"["+A.matrix.toString()+"]"}),gt({data:A.stream,additionalKeyValues:ze,objectId:A.objectNumber}),V("endobj")},yr=function(A){var pe;for(pe in _t)_t.hasOwnProperty(pe)&&(_t[pe]instanceof ba?$r(_t[pe]):_t[pe]instanceof ml&&hr(_t[pe],A))},Ir=function(A){for(var pe in A.objectNumber=Xt(),V("<<"),A)switch(pe){case"opacity":V("/ca "+M(A[pe]));break;case"stroke-opacity":V("/CA "+M(A[pe]))}V(">>"),V("endobj")},Hr=function(){var A;for(A in Et)Et.hasOwnProperty(A)&&Ir(Et[A])},rr=function(){for(var A in V("/XObject <<"),It)It.hasOwnProperty(A)&&It[A].objectNumber>=0&&V("/"+A+" "+It[A].objectNumber+" 0 R");at.publish("putXobjectDict"),V(">>")},on=function(){sn.oid=Xt(),V("<<"),V("/Filter /Standard"),V("/V "+sn.v),V("/R "+sn.r),V("/U <"+sn.toHexString(sn.U)+">"),V("/O <"+sn.toHexString(sn.O)+">"),V("/P "+sn.P),V(">>"),V("endobj")},vn=function(){for(var A in V("/Font <<"),rt)rt.hasOwnProperty(A)&&(y===!1||y===!0&&v.hasOwnProperty(A))&&V("/"+A+" "+rt[A].objectNumber+" 0 R");V(">>")},Ln=function(){if(Object.keys(_t).length>0){for(var A in V("/Shading <<"),_t)_t.hasOwnProperty(A)&&_t[A]instanceof ba&&_t[A].objectNumber>=0&&V("/"+A+" "+_t[A].objectNumber+" 0 R");at.publish("putShadingPatternDict"),V(">>")}},bn=function(A){if(Object.keys(_t).length>0){for(var pe in V("/Pattern <<"),_t)_t.hasOwnProperty(pe)&&_t[pe]instanceof p.TilingPattern&&_t[pe].objectNumber>=0&&_t[pe].objectNumber<A&&V("/"+pe+" "+_t[pe].objectNumber+" 0 R");at.publish("putTilingPatternDict"),V(">>")}},gn=function(){if(Object.keys(Et).length>0){var A;for(A in V("/ExtGState <<"),Et)Et.hasOwnProperty(A)&&Et[A].objectNumber>=0&&V("/"+A+" "+Et[A].objectNumber+" 0 R");at.publish("putGStateDict"),V(">>")}},Br=function(A){wt(A.resourcesOid,!0),V("<<"),V("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),vn(),Ln(),bn(A.objectOid),gn(),rr(),V(">>"),V("endobj")},Vn=function(){var A=[];xr(),Hr(),kt(),yr(A),at.publish("putResources"),A.forEach(Br),Br({resourcesOid:Vt,objectOid:Number.MAX_SAFE_INTEGER}),at.publish("postPutResources")},Xn=function(){at.publish("putAdditionalObjects");for(var A=0;A<J.length;A++){var pe=J[A];wt(pe.objId,!0),V(pe.content),V("endobj")}at.publish("postPutAdditionalObjects")},Ni=function(A){He[A.fontName]=He[A.fontName]||{},He[A.fontName][A.fontStyle]=A.id},nr=function(A,pe,Le,Me,ze){var it={id:"F"+(Object.keys(rt).length+1).toString(10),postScriptName:A,fontName:pe,fontStyle:Le,encoding:Me,isStandardFont:ze||!1,metadata:{}};return at.publish("addFont",{font:it,instance:this}),rt[it.id]=it,Ni(it),it.id},Tr=function(A){for(var pe=0,Le=fe.length;pe<Le;pe++){var Me=nr.call(this,A[pe][0],A[pe][1],A[pe][2],fe[pe][3],!0);y===!1&&(v[Me]=!0);var ze=A[pe][0].split("-");Ni({id:Me,fontName:ze[0],fontStyle:ze[1]||""})}at.publish("addFonts",{fonts:rt,dictionary:He})},Gr=function(A){return A.foo=function(){try{return A.apply(this,arguments)}catch(Me){var pe=Me.stack||"";~pe.indexOf(" at ")&&(pe=pe.split(" at ")[1]);var Le="Error in function "+pe.split(`
`)[0].split("<")[0]+": "+Me.message;if(!lr.console)throw new Error(Le);lr.console.error(Le,Me),lr.alert&&alert(Le)}},A.foo.bar=A,A.foo},bt=function(A,pe){var Le,Me,ze,it,Ct,Dt,h,R,se;if(ze=(pe=pe||{}).sourceEncoding||"Unicode",Ct=pe.outputEncoding,(pe.autoencode||Ct)&&rt[We].metadata&&rt[We].metadata[ze]&&rt[We].metadata[ze].encoding&&(it=rt[We].metadata[ze].encoding,!Ct&&rt[We].encoding&&(Ct=rt[We].encoding),!Ct&&it.codePages&&(Ct=it.codePages[0]),typeof Ct=="string"&&(Ct=it[Ct]),Ct)){for(h=!1,Dt=[],Le=0,Me=A.length;Le<Me;Le++)(R=Ct[A.charCodeAt(Le)])?Dt.push(String.fromCharCode(R)):Dt.push(A[Le]),Dt[Le].charCodeAt(0)>>8&&(h=!0);A=Dt.join("")}for(Le=A.length;h===void 0&&Le!==0;)A.charCodeAt(Le-1)>>8&&(h=!0),Le--;if(!h)return A;for(Dt=pe.noBOM?[]:[254,255],Le=0,Me=A.length;Le<Me;Le++){if((se=(R=A.charCodeAt(Le))>>8)>>8)throw new Error("Character at position "+Le+" of string '"+A+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Dt.push(se),Dt.push(R-(se<<8))}return String.fromCharCode.apply(void 0,Dt)},ar=p.__private__.pdfEscape=p.pdfEscape=function(A,pe){return bt(A,pe).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},pr=p.__private__.beginPage=function(A){W[++ot]=[],Je[ot]={objId:0,contentsObjId:0,userUnit:Number(a),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(A[0]),topRightY:Number(A[1])}},dn(ot),le(W[L])},Wr=function(A,pe){var Le,Me,ze;switch(r=pe||r,typeof A=="string"&&(Le=x(A.toLowerCase()),Array.isArray(Le)&&(Me=Le[0],ze=Le[1])),Array.isArray(A)&&(Me=A[0]*Fe,ze=A[1]*Fe),isNaN(Me)&&(Me=i[0],ze=i[1]),(Me>14400||ze>14400)&&(cn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Me=Math.min(14400,Me),ze=Math.min(14400,ze)),i=[Me,ze],r.substr(0,1)){case"l":ze>Me&&(i=[ze,Me]);break;case"p":Me>ze&&(i=[ze,Me])}pr(i),Ha(Ua),V(ri),Ya!==0&&V(Ya+" J"),Gs!==0&&V(Gs+" j"),at.publish("addPage",{pageNumber:ot})},Fr=function(A){A>0&&A<=ot&&(W.splice(A,1),Je.splice(A,1),ot--,L>ot&&(L=ot),this.setPage(L))},dn=function(A){A>0&&A<=ot&&(L=A)},Sr=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return W.length-1},Gn=function(A,pe,Le){var Me,ze=void 0;return Le=Le||{},A=A!==void 0?A:rt[We].fontName,pe=pe!==void 0?pe:rt[We].fontStyle,Me=A.toLowerCase(),He[Me]!==void 0&&He[Me][pe]!==void 0?ze=He[Me][pe]:He[A]!==void 0&&He[A][pe]!==void 0?ze=He[A][pe]:Le.disableWarning===!1&&cn.warn("Unable to look up font label for font '"+A+"', '"+pe+"'. Refer to getFontList() for available fonts."),ze||Le.noFallback||(ze=He.times[pe])==null&&(ze=He.times.normal),ze},wn=p.__private__.putInfo=function(){var A=Xt(),pe=function(Me){return Me};for(var Le in f!==null&&(pe=sn.encryptor(A,0)),V("<<"),V("/Producer ("+ar(pe("jsPDF "+sr.version))+")"),Re)Re.hasOwnProperty(Le)&&Re[Le]&&V("/"+Le.substr(0,1).toUpperCase()+Le.substr(1)+" ("+ar(pe(Re[Le]))+")");V("/CreationDate ("+ar(pe(te))+")"),V(">>"),V("endobj")},Zn=p.__private__.putCatalog=function(A){var pe=(A=A||{}).rootDictionaryObjId||Ze;switch(Xt(),V("<<"),V("/Type /Catalog"),V("/Pages "+pe+" 0 R"),xe||(xe="fullwidth"),xe){case"fullwidth":V("/OpenAction [3 0 R /FitH null]");break;case"fullheight":V("/OpenAction [3 0 R /FitV null]");break;case"fullpage":V("/OpenAction [3 0 R /Fit]");break;case"original":V("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Le=""+xe;Le.substr(Le.length-1)==="%"&&(xe=parseInt(xe)/100),typeof xe=="number"&&V("/OpenAction [3 0 R /XYZ null null "+M(xe)+"]")}switch(Ce||(Ce="continuous"),Ce){case"continuous":V("/PageLayout /OneColumn");break;case"single":V("/PageLayout /SinglePage");break;case"two":case"twoleft":V("/PageLayout /TwoColumnLeft");break;case"tworight":V("/PageLayout /TwoColumnRight")}De&&V("/PageMode /"+De),at.publish("putCatalog"),V(">>"),V("endobj")},Wi=p.__private__.putTrailer=function(){V("trailer"),V("<<"),V("/Size "+(z+1)),V("/Root "+z+" 0 R"),V("/Info "+(z-1)+" 0 R"),f!==null&&V("/Encrypt "+sn.oid+" 0 R"),V("/ID [ <"+O+"> <"+O+"> ]"),V(">>")},hi=p.__private__.putHeader=function(){V("%PDF-"+I),V("%")},ei=p.__private__.putXRef=function(){var A="0000000000";V("xref"),V("0 "+(z+1)),V("0000000000 65535 f ");for(var pe=1;pe<=z;pe++)typeof oe[pe]=="function"?V((A+oe[pe]()).slice(-10)+" 00000 n "):oe[pe]!==void 0?V((A+oe[pe]).slice(-10)+" 00000 n "):V("0000000000 00000 n ")},xn=p.__private__.buildDocument=function(){de(),le(G),at.publish("buildDocument"),hi(),Er(),Xn(),Vn(),f!==null&&on(),wn(),Zn();var A=ee;return ei(),Wi(),V("startxref"),V(""+A),V("%%EOF"),le(W[L]),G.join(`
`)},ti=p.__private__.getBlob=function(A){return new Blob([Pe(A)],{type:"application/pdf"})},Li=p.output=p.__private__.output=Gr(function(A,pe){switch(typeof(pe=pe||{})=="string"?pe={filename:pe}:pe.filename=pe.filename||"generated.pdf",A){case void 0:return xn();case"save":p.save(pe.filename);break;case"arraybuffer":return Pe(xn());case"blob":return ti(xn());case"bloburi":case"bloburl":if(lr.URL!==void 0&&typeof lr.URL.createObjectURL=="function")return lr.URL&&lr.URL.createObjectURL(ti(xn()))||void 0;cn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Le="",Me=xn();try{Le=ym(Me)}catch{Le=ym(unescape(encodeURIComponent(Me)))}return"data:application/pdf;filename="+pe.filename+";base64,"+Le;case"pdfobjectnewwindow":if(Object.prototype.toString.call(lr)==="[object Window]"){var ze="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",it=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';pe.pdfObjectUrl&&(ze=pe.pdfObjectUrl,it="");var Ct='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ze+'"'+it+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(pe)+");<\/script></body></html>",Dt=lr.open();return Dt!==null&&Dt.document.write(Ct),Dt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(lr)==="[object Window]"){var h='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(pe.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+pe.filename+'" width="500px" height="400px" /></body></html>',R=lr.open();if(R!==null){R.document.write(h);var se=this;R.document.documentElement.querySelector("#pdfViewer").onload=function(){R.document.title=pe.filename,R.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(se.output("bloburl"))}}return R}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(lr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var _e='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",pe)+'"></iframe></body></html>',Ve=lr.open();if(Ve!==null&&(Ve.document.write(_e),Ve.document.title=pe.filename),Ve||typeof safari>"u")return Ve;break;case"datauri":case"dataurl":return lr.document.location.href=this.output("datauristring",pe);default:return null}}),no=function(A){return Array.isArray(dt)===!0&&dt.indexOf(A)>-1};switch(n){case"pt":Fe=1;break;case"mm":Fe=72/25.4;break;case"cm":Fe=72/2.54;break;case"in":Fe=72;break;case"px":Fe=no("px_scaling")==1?.75:96/72;break;case"pc":case"em":Fe=12;break;case"ex":Fe=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Fe=n}var sn=null;ie(),X();var js=function(A){return f!==null?sn.encryptor(A,0):function(pe){return pe}},bo=p.__private__.getPageInfo=p.getPageInfo=function(A){if(isNaN(A)||A%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Je[A].objId,pageNumber:A,pageContext:Je[A]}},ir=p.__private__.getPageInfoByObjId=function(A){if(isNaN(A)||A%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var pe in Je)if(Je[pe].objId===A)break;return bo(pe)},io=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:Je[L].objId,pageNumber:L,pageContext:Je[L]}};p.addPage=function(){return Wr.apply(this,arguments),this},p.setPage=function(){return dn.apply(this,arguments),le.call(this,W[L]),this},p.insertPage=function(A){return this.addPage(),this.movePage(L,A),this},p.movePage=function(A,pe){var Le,Me;if(A>pe){Le=W[A],Me=Je[A];for(var ze=A;ze>pe;ze--)W[ze]=W[ze-1],Je[ze]=Je[ze-1];W[pe]=Le,Je[pe]=Me,this.setPage(pe)}else if(A<pe){Le=W[A],Me=Je[A];for(var it=A;it<pe;it++)W[it]=W[it+1],Je[it]=Je[it+1];W[pe]=Le,Je[pe]=Me,this.setPage(pe)}return this},p.deletePage=function(){return Fr.apply(this,arguments),this},p.__private__.text=p.text=function(A,pe,Le,Me,ze){var it,Ct,Dt,h,R,se,_e,Ve,Qe,$t=(Me=Me||{}).scope||this;if(typeof A=="number"&&typeof pe=="number"&&(typeof Le=="string"||Array.isArray(Le))){var vr=Le;Le=pe,pe=A,A=vr}if(arguments[3]instanceof yt?(C("The transform parameter of text() with a Matrix value"),Qe=ze):(Dt=arguments[4],h=arguments[5],rn(_e=arguments[3])==="object"&&_e!==null||(typeof Dt=="string"&&(h=Dt,Dt=null),typeof _e=="string"&&(h=_e,_e=null),typeof _e=="number"&&(Dt=_e,_e=null),Me={flags:_e,angle:Dt,align:h})),isNaN(pe)||isNaN(Le)||A==null)throw new Error("Invalid arguments passed to jsPDF.text");if(A.length===0)return $t;var Nr="",br=!1,Xr=typeof Me.lineHeightFactor=="number"?Me.lineHeightFactor:Qr,an=$t.internal.scaleFactor;function xo(hn){return hn=hn.split("	").join(Array(Me.TabLen||9).join(" ")),ar(hn,_e)}function ni(hn){for(var fn,Cn=hn.concat(),qn=[],gs=Cn.length;gs--;)typeof(fn=Cn.shift())=="string"?qn.push(fn):Array.isArray(hn)&&(fn.length===1||fn[1]===void 0&&fn[2]===void 0)?qn.push(fn[0]):qn.push([fn[0],fn[1],fn[2]]);return qn}function qo(hn,fn){var Cn;if(typeof hn=="string")Cn=fn(hn)[0];else if(Array.isArray(hn)){for(var qn,gs,Bc=hn.concat(),ql=[],od=Bc.length;od--;)typeof(qn=Bc.shift())=="string"?ql.push(fn(qn)[0]):Array.isArray(qn)&&typeof qn[0]=="string"&&(gs=fn(qn[0],qn[1],qn[2]),ql.push([gs[0],gs[1],gs[2]]));Cn=ql}return Cn}var Uo=!1,Nc=!0;if(typeof A=="string")Uo=!0;else if(Array.isArray(A)){var Lc=A.concat();Ct=[];for(var Rl,ii=Lc.length;ii--;)(typeof(Rl=Lc.shift())!="string"||Array.isArray(Rl)&&typeof Rl[0]!="string")&&(Nc=!1);Uo=Nc}if(Uo===!1)throw new Error('Type of text must be string or Array. "'+A+'" is not recognized.');typeof A=="string"&&(A=A.match(/[\r?\n]/)?A.split(/\r\n|\r|\n/g):[A]);var Ml=be/$t.internal.scaleFactor,Fl=Ml*(Xr-1);switch(Me.baseline){case"bottom":Le-=Fl;break;case"top":Le+=Ml-Fl;break;case"hanging":Le+=Ml-2*Fl;break;case"middle":Le+=Ml/2-Fl}if((se=Me.maxWidth||0)>0&&(typeof A=="string"?A=$t.splitTextToSize(A,se):Object.prototype.toString.call(A)==="[object Array]"&&(A=A.reduce(function(hn,fn){return hn.concat($t.splitTextToSize(fn,se))},[]))),it={text:A,x:pe,y:Le,options:Me,mutex:{pdfEscape:ar,activeFontKey:We,fonts:rt,activeFontSize:be}},at.publish("preProcessText",it),A=it.text,Dt=(Me=it.options).angle,!(Qe instanceof yt)&&Dt&&typeof Dt=="number"){Dt*=Math.PI/180,Me.rotationDirection===0&&(Dt=-Dt),ne===j.ADVANCED&&(Dt=-Dt);var Ol=Math.cos(Dt),Dc=Math.sin(Dt);Qe=new yt(Ol,Dc,-Dc,Ol,0,0)}else Dt&&Dt instanceof yt&&(Qe=Dt);ne!==j.ADVANCED||Qe||(Qe=Mt),(R=Me.charSpace||ds)!==void 0&&(Nr+=k(S(R))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Ve=Me.horizontalScale)!==void 0&&(Nr+=k(100*Ve)+` Tz
`),Me.lang;var Ri=-1,pf=Me.renderingMode!==void 0?Me.renderingMode:Me.stroke,Rc=$t.internal.getCurrentPageInfo().pageContext;switch(pf){case 0:case!1:case"fill":Ri=0;break;case 1:case!0:case"stroke":Ri=1;break;case 2:case"fillThenStroke":Ri=2;break;case 3:case"invisible":Ri=3;break;case 4:case"fillAndAddForClipping":Ri=4;break;case 5:case"strokeAndAddPathForClipping":Ri=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ri=6;break;case 7:case"addToPathForClipping":Ri=7}var td=Rc.usedRenderingMode!==void 0?Rc.usedRenderingMode:-1;Ri!==-1?Nr+=Ri+` Tr
`:td!==-1&&(Nr+=`0 Tr
`),Ri!==-1&&(Rc.usedRenderingMode=Ri),h=Me.align||"left";var oo,Bl=be*Xr,rd=$t.internal.pageSize.getWidth(),nd=rt[We];R=Me.charSpace||ds,se=Me.maxWidth||0,_e=Object.assign({autoencode:!0,noBOM:!0},Me.flags);var Xs=[],Ka=function(hn){return $t.getStringUnitWidth(hn,{font:nd,charSpace:R,fontSize:be,doKerning:!1})*be/an};if(Object.prototype.toString.call(A)==="[object Array]"){var Mi;Ct=ni(A),h!=="left"&&(oo=Ct.map(Ka));var $i,Zs=0;if(h==="right"){pe-=oo[0],A=[],ii=Ct.length;for(var ps=0;ps<ii;ps++)ps===0?($i=Yi(pe),Mi=zn(Le)):($i=S(Zs-oo[ps]),Mi=-Bl),A.push([Ct[ps],$i,Mi]),Zs=oo[ps]}else if(h==="center"){pe-=oo[0]/2,A=[],ii=Ct.length;for(var ms=0;ms<ii;ms++)ms===0?($i=Yi(pe),Mi=zn(Le)):($i=S((Zs-oo[ms])/2),Mi=-Bl),A.push([Ct[ms],$i,Mi]),Zs=oo[ms]}else if(h==="left"){A=[],ii=Ct.length;for(var jl=0;jl<ii;jl++)A.push(Ct[jl])}else if(h==="justify"&&nd.encoding==="Identity-H"){A=[],ii=Ct.length,se=se!==0?se:rd;for(var ys=0,An=0;An<ii;An++)if(Mi=An===0?zn(Le):-Bl,$i=An===0?Yi(pe):ys,An<ii-1){var Mc=S((se-oo[An])/(Ct[An].split(" ").length-1)),ki=Ct[An].split(" ");A.push([ki[0]+" ",$i,Mi]),ys=0;for(var so=1;so<ki.length;so++){var Vl=(Ka(ki[so-1]+" "+ki[so])-Ka(ki[so]))*an+Mc;so==ki.length-1?A.push([ki[so],Vl,0]):A.push([ki[so]+" ",Vl,0]),ys-=Vl}}else A.push([Ct[An],$i,Mi]);A.push(["",ys,0])}else{if(h!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(A=[],ii=Ct.length,se=se!==0?se:rd,An=0;An<ii;An++)Mi=An===0?zn(Le):-Bl,$i=An===0?Yi(pe):0,An<ii-1?Xs.push(k(S((se-oo[An])/(Ct[An].split(" ").length-1)))):Xs.push(0),A.push([Ct[An],$i,Mi])}}var id=typeof Me.R2L=="boolean"?Me.R2L:ve;id===!0&&(A=qo(A,function(hn,fn,Cn){return[hn.split("").reverse().join(""),fn,Cn]})),it={text:A,x:pe,y:Le,options:Me,mutex:{pdfEscape:ar,activeFontKey:We,fonts:rt,activeFontSize:be}},at.publish("postProcessText",it),A=it.text,br=it.mutex.isHex||!1;var Fc=rt[We].encoding;Fc!=="WinAnsiEncoding"&&Fc!=="StandardEncoding"||(A=qo(A,function(hn,fn,Cn){return[xo(hn),fn,Cn]})),Ct=ni(A),A=[];for(var Ja,Qa,ea,Xa=0,zl=1,Za=Array.isArray(Ct[0])?zl:Xa,ta="",Oc=function(hn,fn,Cn){var qn="";return Cn instanceof yt?(Cn=typeof Me.angle=="number"?Qt(Cn,new yt(1,0,0,1,hn,fn)):Qt(new yt(1,0,0,1,hn,fn),Cn),ne===j.ADVANCED&&(Cn=Qt(new yt(1,0,0,-1,0,0),Cn)),qn=Cn.join(" ")+` Tm
`):qn=k(hn)+" "+k(fn)+` Td
`,qn},ao=0;ao<Ct.length;ao++){switch(ta="",Za){case zl:ea=(br?"<":"(")+Ct[ao][0]+(br?">":")"),Ja=parseFloat(Ct[ao][1]),Qa=parseFloat(Ct[ao][2]);break;case Xa:ea=(br?"<":"(")+Ct[ao]+(br?">":")"),Ja=Yi(pe),Qa=zn(Le)}Xs!==void 0&&Xs[ao]!==void 0&&(ta=Xs[ao]+` Tw
`),ao===0?A.push(ta+Oc(Ja,Qa,Qe)+ea):Za===Xa?A.push(ta+ea):Za===zl&&A.push(ta+Oc(Ja,Qa,Qe)+ea)}A=Za===Xa?A.join(` Tj
T* `):A.join(` Tj
`),A+=` Tj
`;var lo=`BT
/`;return lo+=We+" "+be+` Tf
`,lo+=k(be*Xr)+` TL
`,lo+=So+`
`,lo+=Nr,lo+=A,V(lo+="ET"),v[We]=!0,$t};var za=p.__private__.clip=p.clip=function(A){return V(A==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return za("evenodd")},p.__private__.discardPath=p.discardPath=function(){return V("n"),this};var Di=p.__private__.isValidStyle=function(A){var pe=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(A)!==-1&&(pe=!0),pe};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(A){return Di(A)&&(u=A),this};var Vs=p.__private__.getStyle=p.getStyle=function(A){var pe=u;switch(A){case"D":case"S":pe="S";break;case"F":pe="f";break;case"FD":case"DF":pe="B";break;case"f":case"f*":case"B":case"B*":pe=A}return pe},Ii=p.close=function(){return V("h"),this};p.stroke=function(){return V("S"),this},p.fill=function(A){return Oo("f",A),this},p.fillEvenOdd=function(A){return Oo("f*",A),this},p.fillStroke=function(A){return Oo("B",A),this},p.fillStrokeEvenOdd=function(A){return Oo("B*",A),this};var Oo=function(A,pe){rn(pe)==="object"?zs(pe,A):V(A)},cs=function(A){A===null||ne===j.ADVANCED&&A===void 0||(A=Vs(A),V(A))};function Bo(A,pe,Le,Me,ze){var it=new ml(pe||this.boundingBox,Le||this.xStep,Me||this.yStep,this.gState,ze||this.matrix);it.stream=this.stream;var Ct=A+"$$"+this.cloneIndex+++"$$";return Kt(Ct,it),it}var zs=function(A,pe){var Le=mt[A.key],Me=_t[Le];if(Me instanceof ba)V("q"),V(Nl(pe)),Me.gState&&p.setGState(Me.gState),V(A.matrix.toString()+" cm"),V("/"+Le+" sh"),V("Q");else if(Me instanceof ml){var ze=new yt(1,0,0,-1,0,fi());A.matrix&&(ze=ze.multiply(A.matrix||Mt),Le=Bo.call(Me,A.key,A.boundingBox,A.xStep,A.yStep,ze).id),V("q"),V("/Pattern cs"),V("/"+Le+" scn"),Me.gState&&p.setGState(Me.gState),V(pe),V("Q")}},Nl=function(A){switch(A){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},_o=p.moveTo=function(A,pe){return V(k(S(A))+" "+k(Y(pe))+" m"),this},Gi=p.lineTo=function(A,pe){return V(k(S(A))+" "+k(Y(pe))+" l"),this},wo=p.curveTo=function(A,pe,Le,Me,ze,it){return V([k(S(A)),k(Y(pe)),k(S(Le)),k(Y(Me)),k(S(ze)),k(Y(it)),"c"].join(" ")),this};p.__private__.line=p.line=function(A,pe,Le,Me,ze){if(isNaN(A)||isNaN(pe)||isNaN(Le)||isNaN(Me)||!Di(ze))throw new Error("Invalid arguments passed to jsPDF.line");return ne===j.COMPAT?this.lines([[Le-A,Me-pe]],A,pe,[1,1],ze||"S"):this.lines([[Le-A,Me-pe]],A,pe,[1,1]).stroke()},p.__private__.lines=p.lines=function(A,pe,Le,Me,ze,it){var Ct,Dt,h,R,se,_e,Ve,Qe,$t,vr,Nr,br;if(typeof A=="number"&&(br=Le,Le=pe,pe=A,A=br),Me=Me||[1,1],it=it||!1,isNaN(pe)||isNaN(Le)||!Array.isArray(A)||!Array.isArray(Me)||!Di(ze)||typeof it!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(_o(pe,Le),Ct=Me[0],Dt=Me[1],R=A.length,vr=pe,Nr=Le,h=0;h<R;h++)(se=A[h]).length===2?(vr=se[0]*Ct+vr,Nr=se[1]*Dt+Nr,Gi(vr,Nr)):(_e=se[0]*Ct+vr,Ve=se[1]*Dt+Nr,Qe=se[2]*Ct+vr,$t=se[3]*Dt+Nr,vr=se[4]*Ct+vr,Nr=se[5]*Dt+Nr,wo(_e,Ve,Qe,$t,vr,Nr));return it&&Ii(),cs(ze),this},p.path=function(A){for(var pe=0;pe<A.length;pe++){var Le=A[pe],Me=Le.c;switch(Le.op){case"m":_o(Me[0],Me[1]);break;case"l":Gi(Me[0],Me[1]);break;case"c":wo.apply(this,Me);break;case"h":Ii()}}return this},p.__private__.rect=p.rect=function(A,pe,Le,Me,ze){if(isNaN(A)||isNaN(pe)||isNaN(Le)||isNaN(Me)||!Di(ze))throw new Error("Invalid arguments passed to jsPDF.rect");return ne===j.COMPAT&&(Me=-Me),V([k(S(A)),k(Y(pe)),k(S(Le)),k(S(Me)),"re"].join(" ")),cs(ze),this},p.__private__.triangle=p.triangle=function(A,pe,Le,Me,ze,it,Ct){if(isNaN(A)||isNaN(pe)||isNaN(Le)||isNaN(Me)||isNaN(ze)||isNaN(it)||!Di(Ct))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Le-A,Me-pe],[ze-Le,it-Me],[A-ze,pe-it]],A,pe,[1,1],Ct,!0),this},p.__private__.roundedRect=p.roundedRect=function(A,pe,Le,Me,ze,it,Ct){if(isNaN(A)||isNaN(pe)||isNaN(Le)||isNaN(Me)||isNaN(ze)||isNaN(it)||!Di(Ct))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Dt=4/3*(Math.SQRT2-1);return ze=Math.min(ze,.5*Le),it=Math.min(it,.5*Me),this.lines([[Le-2*ze,0],[ze*Dt,0,ze,it-it*Dt,ze,it],[0,Me-2*it],[0,it*Dt,-ze*Dt,it,-ze,it],[2*ze-Le,0],[-ze*Dt,0,-ze,-it*Dt,-ze,-it],[0,2*it-Me],[0,-it*Dt,ze*Dt,-it,ze,-it]],A+ze,pe,[1,1],Ct,!0),this},p.__private__.ellipse=p.ellipse=function(A,pe,Le,Me,ze){if(isNaN(A)||isNaN(pe)||isNaN(Le)||isNaN(Me)||!Di(ze))throw new Error("Invalid arguments passed to jsPDF.ellipse");var it=4/3*(Math.SQRT2-1)*Le,Ct=4/3*(Math.SQRT2-1)*Me;return _o(A+Le,pe),wo(A+Le,pe-Ct,A+it,pe-Me,A,pe-Me),wo(A-it,pe-Me,A-Le,pe-Ct,A-Le,pe),wo(A-Le,pe+Ct,A-it,pe+Me,A,pe+Me),wo(A+it,pe+Me,A+Le,pe+Ct,A+Le,pe),cs(ze),this},p.__private__.circle=p.circle=function(A,pe,Le,Me){if(isNaN(A)||isNaN(pe)||isNaN(Le)||!Di(Me))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(A,pe,Le,Le,Me)},p.setFont=function(A,pe,Le){return Le&&(pe=Z(pe,Le)),We=Gn(A,pe,{disableWarning:!1}),this};var qa=p.__private__.getFont=p.getFont=function(){return rt[Gn.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var A,pe,Le={};for(A in He)if(He.hasOwnProperty(A))for(pe in Le[A]=[],He[A])He[A].hasOwnProperty(pe)&&Le[A].push(pe);return Le},p.addFont=function(A,pe,Le,Me,ze){var it=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&it.indexOf(arguments[3])!==-1?ze=arguments[3]:arguments[3]&&it.indexOf(arguments[3])==-1&&(Le=Z(Le,Me)),ze=ze||"Identity-H",nr.call(this,A,pe,Le,ze)};var Qr,Ua=t.lineWidth||.200025,qs=p.__private__.getLineWidth=p.getLineWidth=function(){return Ua},Ha=p.__private__.setLineWidth=p.setLineWidth=function(A){return Ua=A,V(k(S(A))+" w"),this};p.__private__.setLineDash=sr.API.setLineDash=sr.API.setLineDashPattern=function(A,pe){if(A=A||[],pe=pe||0,isNaN(pe)||!Array.isArray(A))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return A=A.map(function(Le){return k(S(Le))}).join(" "),pe=k(S(pe)),V("["+A+"] "+pe+" d"),this};var Wa=p.__private__.getLineHeight=p.getLineHeight=function(){return be*Qr};p.__private__.getLineHeight=p.getLineHeight=function(){return be*Qr};var Ga=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(A){return typeof(A=A||1.15)=="number"&&(Qr=A),this},us=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return Qr};Ga(t.lineHeight);var Yi=p.__private__.getHorizontalCoordinate=function(A){return S(A)},zn=p.__private__.getVerticalCoordinate=function(A){return ne===j.ADVANCED?A:Je[L].mediaBox.topRightY-Je[L].mediaBox.bottomLeftY-S(A)},Ll=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(A){return k(Yi(A))},jo=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(A){return k(zn(A))},ri=t.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return Ft(ri)},p.__private__.setStrokeColor=p.setDrawColor=function(A,pe,Le,Me){return ri=Jt({ch1:A,ch2:pe,ch3:Le,ch4:Me,pdfColorType:"draw",precision:2}),V(ri),this};var Us=t.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return Ft(Us)},p.__private__.setFillColor=p.setFillColor=function(A,pe,Le,Me){return Us=Jt({ch1:A,ch2:pe,ch3:Le,ch4:Me,pdfColorType:"fill",precision:2}),V(Us),this};var So=t.textColor||"0 g",Hs=p.__private__.getTextColor=p.getTextColor=function(){return Ft(So)};p.__private__.setTextColor=p.setTextColor=function(A,pe,Le,Me){return So=Jt({ch1:A,ch2:pe,ch3:Le,ch4:Me,pdfColorType:"text",precision:3}),this};var ds=t.charSpace,Ws=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(ds||0)};p.__private__.setCharSpace=p.setCharSpace=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ds=A,this};var Ya=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(A){var pe=p.CapJoinStyles[A];if(pe===void 0)throw new Error("Line cap style of '"+A+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ya=pe,V(pe+" J"),this};var Gs=0;p.__private__.setLineJoin=p.setLineJoin=function(A){var pe=p.CapJoinStyles[A];if(pe===void 0)throw new Error("Line join style of '"+A+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Gs=pe,V(pe+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(A){if(A=A||0,isNaN(A))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return V(k(S(A))+" M"),this},p.GState=ju,p.setGState=function(A){(A=typeof A=="string"?Et[et[A]]:Vo(null,A)).equals(qe)||(V("/"+A.id+" gs"),qe=A)};var Vo=function(A,pe){if(!A||!et[A]){var Le=!1;for(var Me in Et)if(Et.hasOwnProperty(Me)&&Et[Me].equals(pe)){Le=!0;break}if(Le)pe=Et[Me];else{var ze="GS"+(Object.keys(Et).length+1).toString(10);Et[ze]=pe,pe.id=ze}return A&&(et[A]=pe.id),at.publish("addGState",pe),pe}};p.addGState=function(A,pe){return Vo(A,pe),this},p.saveGraphicsState=function(){return V("q"),xt.push({key:We,size:be,color:So}),this},p.restoreGraphicsState=function(){V("Q");var A=xt.pop();return We=A.key,be=A.size,So=A.color,qe=null,this},p.setCurrentTransformationMatrix=function(A){return V(A.toString()+" cm"),this},p.comment=function(A){return V("#"+A),this};var hs=function(A,pe){var Le=A||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Le},set:function(it){isNaN(it)||(Le=parseFloat(it))}});var Me=pe||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Me},set:function(it){isNaN(it)||(Me=parseFloat(it))}});var ze="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ze},set:function(it){ze=it.toString()}}),this},Ys=function(A,pe,Le,Me){hs.call(this,A,pe),this.type="rect";var ze=Le||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ze},set:function(Ct){isNaN(Ct)||(ze=parseFloat(Ct))}});var it=Me||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return it},set:function(Ct){isNaN(Ct)||(it=parseFloat(Ct))}}),this},fs=function(){this.page=ot,this.currentPage=L,this.pages=W.slice(0),this.pagesContext=Je.slice(0),this.x=Xe,this.y=tt,this.matrix=At,this.width=zo(L),this.height=fi(L),this.outputDestination=ae,this.id="",this.objectNumber=-1};fs.prototype.restore=function(){ot=this.page,L=this.currentPage,Je=this.pagesContext,W=this.pages,Xe=this.x,tt=this.y,At=this.matrix,Js(L,this.width),Qs(L,this.height),ae=this.outputDestination};var Ks=function(A,pe,Le,Me,ze){Gt.push(new fs),ot=L=0,W=[],Xe=A,tt=pe,At=ze,pr([Le,Me])},Dl=function(A){if(jt[A])Gt.pop().restore();else{var pe=new fs,Le="Xo"+(Object.keys(It).length+1).toString(10);pe.id=Le,jt[A]=Le,It[Le]=pe,at.publish("addFormObject",pe),Gt.pop().restore()}};for(var Po in p.beginFormObject=function(A,pe,Le,Me,ze){return Ks(A,pe,Le,Me,ze),this},p.endFormObject=function(A){return Dl(A),this},p.doFormObject=function(A,pe){var Le=It[jt[A]];return V("q"),V(pe.toString()+" cm"),V("/"+Le.id+" Do"),V("Q"),this},p.getFormObject=function(A){var pe=It[jt[A]];return{x:pe.x,y:pe.y,width:pe.width,height:pe.height,matrix:pe.matrix}},p.save=function(A,pe){return A=A||"generated.pdf",(pe=pe||{}).returnPromise=pe.returnPromise||!1,pe.returnPromise===!1?(al(ti(xn()),A),typeof al.unload=="function"&&lr.setTimeout&&setTimeout(al.unload,911),this):new Promise(function(Le,Me){try{var ze=al(ti(xn()),A);typeof al.unload=="function"&&lr.setTimeout&&setTimeout(al.unload,911),Le(ze)}catch(it){Me(it.message)}})},sr.API)sr.API.hasOwnProperty(Po)&&(Po==="events"&&sr.API.events.length?function(A,pe){var Le,Me,ze;for(ze=pe.length-1;ze!==-1;ze--)Le=pe[ze][0],Me=pe[ze][1],A.subscribe.apply(A,[Le].concat(typeof Me=="function"?[Me]:Me))}(at,sr.API.events):p[Po]=sr.API[Po]);var zo=p.getPageWidth=function(A){return(Je[A=A||L].mediaBox.topRightX-Je[A].mediaBox.bottomLeftX)/Fe},Js=p.setPageWidth=function(A,pe){Je[A].mediaBox.topRightX=pe*Fe+Je[A].mediaBox.bottomLeftX},fi=p.getPageHeight=function(A){return(Je[A=A||L].mediaBox.topRightY-Je[A].mediaBox.bottomLeftY)/Fe},Qs=p.setPageHeight=function(A,pe){Je[A].mediaBox.topRightY=pe*Fe+Je[A].mediaBox.bottomLeftY};return p.internal={pdfEscape:ar,getStyle:Vs,getFont:qa,getFontSize:he,getCharSpace:Ws,getTextColor:Hs,getLineHeight:Wa,getLineHeightFactor:us,getLineWidth:qs,write:ce,getHorizontalCoordinate:Yi,getVerticalCoordinate:zn,getCoordinateString:Ll,getVerticalCoordinateString:jo,collections:{},newObject:Xt,newAdditionalObject:Ut,newObjectDeferred:ht,newObjectDeferredBegin:wt,getFilters:er,putStream:gt,events:at,scaleFactor:Fe,pageSize:{getWidth:function(){return zo(L)},setWidth:function(A){Js(L,A)},getHeight:function(){return fi(L)},setHeight:function(A){Qs(L,A)}},encryptionOptions:f,encryption:sn,getEncryptor:js,output:Li,getNumberOfPages:Sr,pages:W,out:V,f2:M,f3:_,getPageInfo:bo,getPageInfoByObjId:ir,getCurrentPageInfo:io,getPDFVersion:P,Point:hs,Rectangle:Ys,Matrix:yt,hasHotfix:no},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return zo(L)},set:function(A){Js(L,A)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return fi(L)},set:function(A){Qs(L,A)},enumerable:!0,configurable:!0}),Tr.call(p,fe),We="F1",Wr(i,r),at.publish("initialized"),p}sc.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},sc.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},sc.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},sc.prototype.processOwnerPassword=function(t,e){return vm(gm(e).substr(0,5),t)},sc.prototype.encryptor=function(t,e){var r=gm(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return vm(r,n)}},ju.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||rn(t)!==rn(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},sr.API={events:[]},sr.version="3.0.1";var Pn=sr.API,My=1,Tl=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Xl=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},_r=function(t){return t.toFixed(2)},pa=function(t){return t.toFixed(5)};Pn.__acroform__={};var Hi=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},B0=function(t){return t*My},Yo=function(t){var e=new O5,r=Wt.internal.getHeight(t)||0,n=Wt.internal.getWidth(t)||0;return e.BBox=[0,0,Number(_r(n)),Number(_r(r))],e},mL=Pn.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<e},yL=Pn.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<e)},gL=Pn.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(t&1<<e)==0?0:1},$n=Pn.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return gL(t,e-1)},kn=Pn.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return mL(t,e-1)},En=Pn.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return yL(t,e-1)},vL=Pn.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,i=t[0],o=t[1],s=t[2],a=t[3],c={};return c.lowerLeft_X=r(i)||0,c.lowerLeft_Y=n(o+a)||0,c.upperRight_X=r(i+s)||0,c.upperRight_Y=n(o)||0,[Number(_r(c.lowerLeft_X)),Number(_r(c.lowerLeft_Y)),Number(_r(c.upperRight_X)),Number(_r(c.upperRight_Y))]},bL=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=bm(t,r),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+_r(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var o=Yo(t);return o.scope=t.scope,o.stream=e.join(`
`),o}},bm=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(_){return _.split(`
`)}):i.map(function(_){return[_]});var o=r,s=Wt.internal.getHeight(t)||0;s=s<0?-s:s;var a=Wt.internal.getWidth(t)||0;a=a<0?-a:a;var c=function(_,S,b){if(_+1<i.length){var Y=S+" "+i[_+1][0];return Ud(Y,t,b).width<=a-4}return!1};o++;e:for(;o>0;){e="",o--;var u,f,y=Ud("3",t,o).height,v=t.multiline?s-o:(s-y)/2,p=v+=2,I=0,P=0,w=0;if(o<=0){e=`(...) Tj
`,e+="% Width of Text: "+Ud(e,t,o=12).width+", FieldWidth:"+a+`
`;break}for(var x="",j=0,ne=0;ne<i.length;ne++)if(i.hasOwnProperty(ne)){var Q=!1;if(i[ne].length!==1&&w!==i[ne].length-1){if((y+2)*(j+2)+2>s)continue e;x+=i[ne][w],Q=!0,P=ne,ne--}else{x=(x+=i[ne][w]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var K=parseInt(ne),Z=c(K,x,o),k=ne>=i.length-1;if(Z&&!k){x+=" ",w=0;continue}if(Z||k){if(k)P=K;else if(t.multiline&&(y+2)*(j+2)+2>s)continue e}else{if(!t.multiline||(y+2)*(j+2)+2>s)continue e;P=K}}for(var C="",E=I;E<=P;E++){var M=i[E];if(t.multiline){if(E===P){C+=M[w]+" ",w=(w+1)%M.length;continue}if(E===I){C+=M[M.length-1]+" ";continue}}C+=M[0]+" "}switch(C=C.substr(C.length-1)==" "?C.substr(0,C.length-1):C,f=Ud(C,t,o).width,t.textAlign){case"right":u=a-f-2;break;case"center":u=(a-f)/2;break;case"left":default:u=2}e+=_r(u)+" "+_r(p)+` Td
`,e+="("+Tl(C)+`) Tj
`,e+=-_r(u)+` 0 Td
`,p=-(o+2),f=0,I=Q?P:P+1,j++,x=""}break}return n.text=e,n.fontSize=o,n},Ud=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},_L={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},wL=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},SL=function(t,e){for(var r in t)if(t.hasOwnProperty(r)){var n=r,i=t[r];e.internal.newObjectDeferredBegin(i.objId,!0),rn(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete t[n]}},PL=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Mo.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(_L)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");My=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new B5,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var o=n[i];o.objId=void 0,o.hasAnnotation&&wL(o,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,i){var o=!n;for(var s in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var a=n[s],c=[],u=a.Rect;if(a.Rect&&(a.Rect=vL(a.Rect,i)),i.internal.newObjectDeferredBegin(a.objId,!0),a.DA=Wt.createDefaultAppearanceStream(a),rn(a)==="object"&&typeof a.getKeyValueListForStream=="function"&&(c=a.getKeyValueListForStream()),a.Rect=u,a.hasAppearanceStream&&!a.appearanceStreamContent){var f=bL(a);c.push({key:"AP",value:"<</N "+f+">>"}),i.internal.acroformPlugin.xForms.push(f)}if(a.appearanceStreamContent){var y="";for(var v in a.appearanceStreamContent)if(a.appearanceStreamContent.hasOwnProperty(v)){var p=a.appearanceStreamContent[v];if(y+="/"+v+" ",y+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var s in p)if(p.hasOwnProperty(s)){var I=p[s];typeof I=="function"&&(I=I.call(i,a)),y+="/"+s+" "+I+" ",i.internal.acroformPlugin.xForms.indexOf(I)>=0||i.internal.acroformPlugin.xForms.push(I)}}else typeof(I=p)=="function"&&(I=I.call(i,a)),y+="/"+s+" "+I,i.internal.acroformPlugin.xForms.indexOf(I)>=0||i.internal.acroformPlugin.xForms.push(I);y+=">>"}c.push({key:"AP",value:`<<
`+y+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:a.objId}),i.internal.out("endobj")}o&&SL(i.internal.acroformPlugin.xForms,i)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},F5=Pn.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(s){return s};if(Array.isArray(t)){for(var i="[",o=0;o<t.length;o++)switch(o!==0&&(i+=" "),rn(t[o])){case"boolean":case"number":case"object":i+=t[o].toString();break;case"string":t[o].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),i+="("+Tl(n(t[o].toString()))+")"):i+=t[o].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},yp=function(t,e,r){var n=function(i){return i};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),t="("+Tl(n(t))+")"},Qo=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Qo.prototype.toString=function(){return this.objId+" 0 R"},Qo.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Qo.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],i=this[n];i&&(Array.isArray(i)?t.push({key:n,value:F5(i,this.objId,this.scope)}):i instanceof Qo?(i.scope=this.scope,t.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:n,value:i}))}return t};var O5=function(){Qo.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};Hi(O5,Qo);var B5=function(){Qo.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Tl(r(t))+")"}},set:function(r){t=r}})};Hi(B5,Qo);var Mo=function t(){Qo.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');e=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!$n(e,3)},set:function(x){x?this.F=kn(e,3):this.F=En(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');r=x}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(x){n=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(x){n[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(x){n[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(x){n[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(x){n[3]=x}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof Fh)return;o="FieldObject"+t.FieldNum++}var x=function(j){return j};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+Tl(x(o))+")"},set:function(x){o=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(x){o=x}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(x){s=x}});var a="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return a},set:function(x){a=x}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(x){c=x}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/My:u},set:function(x){u=x}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(x){f=x}});var y="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!y||this instanceof Fh||this instanceof ka))return yp(y,this.objId,this.scope)},set:function(x){x=x.toString(),y=x}});var v=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(v)return this instanceof Hn?v:yp(v,this.objId,this.scope)},set:function(x){x=x.toString(),v=this instanceof Hn?x:x.substr(0,1)==="("?Xl(x.substr(1,x.length-2)):Xl(x)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Hn?Xl(v.substr(1,v.length-1)):v},set:function(x){x=x.toString(),v=this instanceof Hn?"/"+x:x}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Hn?p:yp(p,this.objId,this.scope)},set:function(x){x=x.toString(),p=this instanceof Hn?x:x.substr(0,1)==="("?Xl(x.substr(1,x.length-2)):Xl(x)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Hn?Xl(p.substr(1,p.length-1)):p},set:function(x){x=x.toString(),p=this instanceof Hn?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var I,P=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return P},set:function(x){x=!!x,P=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(I)return I},set:function(x){I=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!$n(this.Ff,1)},set:function(x){x?this.Ff=kn(this.Ff,1):this.Ff=En(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!$n(this.Ff,2)},set:function(x){x?this.Ff=kn(this.Ff,2):this.Ff=En(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!$n(this.Ff,3)},set:function(x){x?this.Ff=kn(this.Ff,3):this.Ff=En(this.Ff,3)}});var w=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(w!==null)return w},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');w=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(w){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:w=2;break;case"center":case 1:w=1;break;case"left":case 0:default:w=0}}})};Hi(Mo,Qo);var vl=function(){Mo.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return F5(e,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=function(o,s,a){a||(a=1);for(var c,u=[];c=s.exec(o);)u.push(c[a]);return u}(n,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!$n(this.Ff,18)},set:function(r){r?this.Ff=kn(this.Ff,18):this.Ff=En(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!$n(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=kn(this.Ff,19):this.Ff=En(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!$n(this.Ff,20)},set:function(r){r?(this.Ff=kn(this.Ff,20),e.sort()):this.Ff=En(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!$n(this.Ff,22)},set:function(r){r?this.Ff=kn(this.Ff,22):this.Ff=En(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!$n(this.Ff,23)},set:function(r){r?this.Ff=kn(this.Ff,23):this.Ff=En(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!$n(this.Ff,27)},set:function(r){r?this.Ff=kn(this.Ff,27):this.Ff=En(this.Ff,27)}}),this.hasAppearanceStream=!1};Hi(vl,Mo);var bl=function(){vl.call(this),this.fontName="helvetica",this.combo=!1};Hi(bl,vl);var _l=function(){bl.call(this),this.combo=!0};Hi(_l,bl);var vu=function(){_l.call(this),this.edit=!0};Hi(vu,_l);var Hn=function(){Mo.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!$n(this.Ff,15)},set:function(r){r?this.Ff=kn(this.Ff,15):this.Ff=En(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!$n(this.Ff,16)},set:function(r){r?this.Ff=kn(this.Ff,16):this.Ff=En(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!$n(this.Ff,17)},set:function(r){r?this.Ff=kn(this.Ff,17):this.Ff=En(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!$n(this.Ff,26)},set:function(r){r?this.Ff=kn(this.Ff,26):this.Ff=En(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(o){return o};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,i=[];for(n in i.push("<<"),e)i.push("/"+n+" ("+Tl(r(e[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){rn(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};Hi(Hn,Mo);var bu=function(){Hn.call(this),this.pushButton=!0};Hi(bu,Hn);var wl=function(){Hn.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Hi(wl,Hn);var Fh=function(){var t,e;Mo.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(a){return a};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var o,s=[];for(o in s.push("<<"),n)s.push("/"+o+" ("+Tl(i(n[o]))+")");return s.push(">>"),s.join(`
`)},set:function(i){rn(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Wt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Hi(Fh,Mo),wl.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},wl.prototype.createOption=function(t){var e=new Fh;return e.Parent=this,e.optionName=t,this.Kids.push(e),xL.call(this.scope,e),e};var _u=function(){Hn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Wt.CheckBox.createAppearanceStream()};Hi(_u,Hn);var ka=function(){Mo.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!$n(this.Ff,13)},set:function(e){e?this.Ff=kn(this.Ff,13):this.Ff=En(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!$n(this.Ff,21)},set:function(e){e?this.Ff=kn(this.Ff,21):this.Ff=En(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!$n(this.Ff,23)},set:function(e){e?this.Ff=kn(this.Ff,23):this.Ff=En(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!$n(this.Ff,24)},set:function(e){e?this.Ff=kn(this.Ff,24):this.Ff=En(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!$n(this.Ff,25)},set:function(e){e?this.Ff=kn(this.Ff,25):this.Ff=En(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!$n(this.Ff,26)},set:function(e){e?this.Ff=kn(this.Ff,26):this.Ff=En(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Hi(ka,Mo);var wu=function(){ka.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!$n(this.Ff,14)},set:function(t){t?this.Ff=kn(this.Ff,14):this.Ff=En(this.Ff,14)}}),this.password=!0};Hi(wu,ka);var Wt={CheckBox:{createAppearanceStream:function(){return{N:{On:Wt.CheckBox.YesNormal},D:{On:Wt.CheckBox.YesPushDown,Off:Wt.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Yo(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),o=bm(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+_r(Wt.internal.getWidth(t))+" "+_r(Wt.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+_r(o.fontSize)+" Tf "+i),r.push("BT"),r.push(o.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=Yo(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),i=[],o=Wt.internal.getHeight(t),s=Wt.internal.getWidth(t),a=bm(t,t.caption);return i.push("1 g"),i.push("0 0 "+_r(s)+" "+_r(o)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+_r(s-1)+" "+_r(o-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+_r(a.fontSize)+" Tf "+n),i.push(a.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=Yo(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+_r(Wt.internal.getWidth(t))+" "+_r(Wt.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Wt.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Wt.RadioButton.Circle.YesNormal,e.D[t]=Wt.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Yo(t);e.scope=t.scope;var r=[],n=Wt.internal.getWidth(t)<=Wt.internal.getHeight(t)?Wt.internal.getWidth(t)/4:Wt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Wt.internal.Bezier_C,o=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+pa(Wt.internal.getWidth(t)/2)+" "+pa(Wt.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Yo(t);e.scope=t.scope;var r=[],n=Wt.internal.getWidth(t)<=Wt.internal.getHeight(t)?Wt.internal.getWidth(t)/4:Wt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),o=Number((i*Wt.internal.Bezier_C).toFixed(5)),s=Number((n*Wt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+pa(Wt.internal.getWidth(t)/2)+" "+pa(Wt.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),r.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),r.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),r.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+pa(Wt.internal.getWidth(t)/2)+" "+pa(Wt.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Yo(t);e.scope=t.scope;var r=[],n=Wt.internal.getWidth(t)<=Wt.internal.getHeight(t)?Wt.internal.getWidth(t)/4:Wt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),o=Number((i*Wt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+pa(Wt.internal.getWidth(t)/2)+" "+pa(Wt.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),r.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),r.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),r.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Wt.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Wt.RadioButton.Cross.YesNormal,e.D[t]=Wt.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Yo(t);e.scope=t.scope;var r=[],n=Wt.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+_r(Wt.internal.getWidth(t)-2)+" "+_r(Wt.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(_r(n.x1.x)+" "+_r(n.x1.y)+" m"),r.push(_r(n.x2.x)+" "+_r(n.x2.y)+" l"),r.push(_r(n.x4.x)+" "+_r(n.x4.y)+" m"),r.push(_r(n.x3.x)+" "+_r(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Yo(t);e.scope=t.scope;var r=Wt.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+_r(Wt.internal.getWidth(t))+" "+_r(Wt.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+_r(Wt.internal.getWidth(t)-2)+" "+_r(Wt.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(_r(r.x1.x)+" "+_r(r.x1.y)+" m"),n.push(_r(r.x2.x)+" "+_r(r.x2.y)+" l"),n.push(_r(r.x4.x)+" "+_r(r.x4.y)+" m"),n.push(_r(r.x3.x)+" "+_r(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Yo(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+_r(Wt.internal.getWidth(t))+" "+_r(Wt.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};Wt.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Wt.internal.getWidth(t),r=Wt.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},Wt.internal.getWidth=function(t){var e=0;return rn(t)==="object"&&(e=B0(t.Rect[2])),e},Wt.internal.getHeight=function(t){var e=0;return rn(t)==="object"&&(e=B0(t.Rect[3])),e};var xL=Pn.addField=function(t){if(PL(this,t),!(t instanceof Mo))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Pn.AcroFormChoiceField=vl,Pn.AcroFormListBox=bl,Pn.AcroFormComboBox=_l,Pn.AcroFormEditBox=vu,Pn.AcroFormButton=Hn,Pn.AcroFormPushButton=bu,Pn.AcroFormRadioButton=wl,Pn.AcroFormCheckBox=_u,Pn.AcroFormTextField=ka,Pn.AcroFormPasswordField=wu,Pn.AcroFormAppearance=Wt,Pn.AcroForm={ChoiceField:vl,ListBox:bl,ComboBox:_l,EditBox:vu,Button:Hn,PushButton:bu,RadioButton:wl,CheckBox:_u,TextField:ka,PasswordField:wu,Appearance:Wt},sr.AcroForm={ChoiceField:vl,ListBox:bl,ComboBox:_l,EditBox:vu,Button:Hn,PushButton:bu,RadioButton:wl,CheckBox:_u,TextField:ka,PasswordField:wu,Appearance:Wt};var AL=sr.AcroForm;function j5(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){t.__addimage__={};var e="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=t.__addimage__.getImageFileTypeByImageData=function(_,S){var b,Y,te,O,D,X=e;if((S=S||e)==="RGBA"||_.data!==void 0&&_.data instanceof Uint8ClampedArray&&"height"in _&&"width"in _)return"RGBA";if(Z(_))for(D in r)for(te=r[D],b=0;b<te.length;b+=1){for(O=!0,Y=0;Y<te[b].length;Y+=1)if(te[b][Y]!==void 0&&te[b][Y]!==_[Y]){O=!1;break}if(O===!0){X=D;break}}else for(D in r)for(te=r[D],b=0;b<te.length;b+=1){for(O=!0,Y=0;Y<te[b].length;Y+=1)if(te[b][Y]!==void 0&&te[b][Y]!==_.charCodeAt(Y)){O=!1;break}if(O===!0){X=D;break}}return X===e&&S!==e&&(X=S),X},i=function _(S){for(var b=this.internal.write,Y=this.internal.putStream,te=(0,this.internal.getFilters)();te.indexOf("FlateEncode")!==-1;)te.splice(te.indexOf("FlateEncode"),1);S.objectId=this.internal.newObject();var O=[];if(O.push({key:"Type",value:"/XObject"}),O.push({key:"Subtype",value:"/Image"}),O.push({key:"Width",value:S.width}),O.push({key:"Height",value:S.height}),S.colorSpace===w.INDEXED?O.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(S.palette.length/3-1)+" "+("sMask"in S&&S.sMask!==void 0?S.objectId+2:S.objectId+1)+" 0 R]"}):(O.push({key:"ColorSpace",value:"/"+S.colorSpace}),S.colorSpace===w.DEVICE_CMYK&&O.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),O.push({key:"BitsPerComponent",value:S.bitsPerComponent}),"decodeParameters"in S&&S.decodeParameters!==void 0&&O.push({key:"DecodeParms",value:"<<"+S.decodeParameters+">>"}),"transparency"in S&&Array.isArray(S.transparency)){for(var D="",X=0,H=S.transparency.length;X<H;X++)D+=S.transparency[X]+" "+S.transparency[X]+" ";O.push({key:"Mask",value:"["+D+"]"})}S.sMask!==void 0&&O.push({key:"SMask",value:S.objectId+1+" 0 R"});var F=S.filter!==void 0?["/"+S.filter]:void 0;if(Y({data:S.data,additionalKeyValues:O,alreadyAppliedFilters:F,objectId:S.objectId}),b("endobj"),"sMask"in S&&S.sMask!==void 0){var ie="/Predictor "+S.predictor+" /Colors 1 /BitsPerComponent "+S.bitsPerComponent+" /Columns "+S.width,$={width:S.width,height:S.height,colorSpace:"DeviceGray",bitsPerComponent:S.bitsPerComponent,decodeParameters:ie,data:S.sMask};"filter"in S&&($.filter=S.filter),_.call(this,$)}if(S.colorSpace===w.INDEXED){var L=this.internal.newObject();Y({data:C(new Uint8Array(S.palette)),objectId:L}),b("endobj")}},o=function(){var _=this.internal.collections.addImage_images;for(var S in _)i.call(this,_[S])},s=function(){var _,S=this.internal.collections.addImage_images,b=this.internal.write;for(var Y in S)b("/I"+(_=S[Y]).index,_.objectId,"0","R")},a=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",s))},c=function(){var _=this.internal.collections.addImage_images;return a.call(this),_},u=function(){return Object.keys(this.internal.collections.addImage_images).length},f=function(_){return typeof t["process"+_.toUpperCase()]=="function"},y=function(_){return rn(_)==="object"&&_.nodeType===1},v=function(_,S){if(_.nodeName==="IMG"&&_.hasAttribute("src")){var b=""+_.getAttribute("src");if(b.indexOf("data:image/")===0)return gu(unescape(b).split("base64,").pop());var Y=t.loadFile(b,!0);if(Y!==void 0)return Y}if(_.nodeName==="CANVAS"){if(_.width===0||_.height===0)throw new Error("Given canvas must have data. Canvas width: "+_.width+", height: "+_.height);var te;switch(S){case"PNG":te="image/png";break;case"WEBP":te="image/webp";break;case"JPEG":case"JPG":default:te="image/jpeg"}return gu(_.toDataURL(te,1).split("base64,").pop())}},p=function(_){var S=this.internal.collections.addImage_images;if(S){for(var b in S)if(_===S[b].alias)return S[b]}},I=function(_,S,b){return _||S||(_=-96,S=-96),_<0&&(_=-1*b.width*72/_/this.internal.scaleFactor),S<0&&(S=-1*b.height*72/S/this.internal.scaleFactor),_===0&&(_=S*b.width/b.height),S===0&&(S=_*b.height/b.width),[_,S]},P=function(_,S,b,Y,te,O){var D=I.call(this,b,Y,te),X=this.internal.getCoordinateString,H=this.internal.getVerticalCoordinateString,F=c.call(this);if(b=D[0],Y=D[1],F[te.index]=te,O){O*=Math.PI/180;var ie=Math.cos(O),$=Math.sin(O),L=function(N){return N.toFixed(4)},U=[L(ie),L($),L(-1*$),L(ie),0,0,"cm"]}this.internal.write("q"),O?(this.internal.write([1,"0","0",1,X(_),H(S+Y),"cm"].join(" ")),this.internal.write(U.join(" ")),this.internal.write([X(b),"0","0",X(Y),"0","0","cm"].join(" "))):this.internal.write([X(b),"0","0",X(Y),X(_),H(S+Y),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+te.index+" Do"),this.internal.write("Q")},w=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var x=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},j=t.__addimage__.sHashCode=function(_){var S,b,Y=0;if(typeof _=="string")for(b=_.length,S=0;S<b;S++)Y=(Y<<5)-Y+_.charCodeAt(S),Y|=0;else if(Z(_))for(b=_.byteLength/2,S=0;S<b;S++)Y=(Y<<5)-Y+_[S],Y|=0;return Y},ne=t.__addimage__.validateStringAsBase64=function(_){(_=_||"").toString().trim();var S=!0;return _.length===0&&(S=!1),_.length%4!=0&&(S=!1),/^[A-Za-z0-9+/]+$/.test(_.substr(0,_.length-2))===!1&&(S=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(_.substr(-2))===!1&&(S=!1),S},Q=t.__addimage__.extractImageFromDataUrl=function(_){if(_==null||!(_=_.trim()).startsWith("data:"))return null;var S=_.indexOf(",");return S<0?null:_.substring(0,S).trim().endsWith("base64")?_.substring(S+1):null},K=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(_){return K()&&_ instanceof ArrayBuffer};var Z=t.__addimage__.isArrayBufferView=function(_){return K()&&typeof Uint32Array<"u"&&(_ instanceof Int8Array||_ instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&_ instanceof Uint8ClampedArray||_ instanceof Int16Array||_ instanceof Uint16Array||_ instanceof Int32Array||_ instanceof Uint32Array||_ instanceof Float32Array||_ instanceof Float64Array)},k=t.__addimage__.binaryStringToUint8Array=function(_){for(var S=_.length,b=new Uint8Array(S),Y=0;Y<S;Y++)b[Y]=_.charCodeAt(Y);return b},C=t.__addimage__.arrayBufferToBinaryString=function(_){for(var S="",b=Z(_)?_:new Uint8Array(_),Y=0;Y<b.length;Y+=8192)S+=String.fromCharCode.apply(null,b.subarray(Y,Y+8192));return S};t.addImage=function(){var _,S,b,Y,te,O,D,X,H;if(typeof arguments[1]=="number"?(S=e,b=arguments[1],Y=arguments[2],te=arguments[3],O=arguments[4],D=arguments[5],X=arguments[6],H=arguments[7]):(S=arguments[1],b=arguments[2],Y=arguments[3],te=arguments[4],O=arguments[5],D=arguments[6],X=arguments[7],H=arguments[8]),rn(_=arguments[0])==="object"&&!y(_)&&"imageData"in _){var F=_;_=F.imageData,S=F.format||S||e,b=F.x||b||0,Y=F.y||Y||0,te=F.w||F.width||te,O=F.h||F.height||O,D=F.alias||D,X=F.compression||X,H=F.rotation||F.angle||H}var ie=this.internal.getFilters();if(X===void 0&&ie.indexOf("FlateEncode")!==-1&&(X="SLOW"),isNaN(b)||isNaN(Y))throw new Error("Invalid coordinates passed to jsPDF.addImage");a.call(this);var $=E.call(this,_,S,D,X);return P.call(this,b,Y,te,O,$,H),this};var E=function(_,S,b,Y){var te,O,D;if(typeof _=="string"&&n(_)===e){_=unescape(_);var X=M(_,!1);(X!==""||(X=t.loadFile(_,!0))!==void 0)&&(_=X)}if(y(_)&&(_=v(_,S)),S=n(_,S),!f(S))throw new Error("addImage does not support files of type '"+S+"', please ensure that a plugin for '"+S+"' support is added.");if(((D=b)==null||D.length===0)&&(b=function(H){return typeof H=="string"||Z(H)?j(H):Z(H.data)?j(H.data):null}(_)),(te=p.call(this,b))||(K()&&(_ instanceof Uint8Array||S==="RGBA"||(O=_,_=k(_))),te=this["process"+S.toUpperCase()](_,u.call(this),b,function(H){return H&&typeof H=="string"&&(H=H.toUpperCase()),H in t.image_compression?H:x.NONE}(Y),O)),!te)throw new Error("An unknown error occurred whilst processing the image.");return te},M=t.__addimage__.convertBase64ToBinaryString=function(_,S){S=typeof S!="boolean"||S;var b,Y="";if(typeof _=="string"){var te;b=(te=Q(_))!==null&&te!==void 0?te:_;try{Y=gu(b)}catch(O){if(S)throw ne(b)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+O.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Y};t.getImageProperties=function(_){var S,b,Y="";if(y(_)&&(_=v(_)),typeof _=="string"&&n(_)===e&&((Y=M(_,!1))===""&&(Y=t.loadFile(_)||""),_=Y),b=n(_),!f(b))throw new Error("addImage does not support files of type '"+b+"', please ensure that a plugin for '"+b+"' support is added.");if(!K()||_ instanceof Uint8Array||(_=k(_)),!(S=this["process"+b.toUpperCase()](_)))throw new Error("An unknown error occurred whilst processing the image");return S.fileType=b,S}})(sr.API),function(t){var e=function(r){if(r!==void 0&&r!="")return!0};sr.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,i,o,s=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,f=!1,y=0;y<u.length&&!f;y++)switch((n=u[y]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var v=0;v<u.length;v++){n=u[v];var p=this.internal.pdfEscape,I=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var P=this.internal.newAdditionalObject(),w=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(P.objId),j=n.title||"Note";o="<</Type /Annot /Subtype /Text "+(i="/Rect ["+s(n.bounds.x)+" "+a(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+a(n.bounds.y)+"] ")+"/Contents ("+p(x(n.contents))+")",o+=" /Popup "+w.objId+" 0 R",o+=" /P "+c.objId+" 0 R",o+=" /T ("+p(x(j))+") >>",P.content=o;var ne=P.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+s(n.bounds.x+30)+" "+a(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+a(n.bounds.y)+"] ")+" /Parent "+ne,n.open&&(o+=" /Open true"),o+=" >>",w.content=o,this.internal.write(P.objId,"0 R",w.objId,"0 R");break;case"freetext":i="/Rect ["+s(n.bounds.x)+" "+a(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+a(n.bounds.y+n.bounds.h)+"] ";var Q=n.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+p(I(n.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+Q+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(n.options.name){var K=this.annotations._nameMap[n.options.name];n.options.pageNumber=K.page,n.options.top=K.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",o="",n.options.url)o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+p(I(n.options.url))+") >>";else if(n.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,o+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var Z=a(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),o+=" /XYZ "+n.options.left+" "+Z+" "+n.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,i,o,s){var a=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;a.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+i),h:u(n+o)},options:s,type:"link"})},t.textWithLink=function(r,n,i,o){var s,a,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){a=o.maxWidth;var f=this.splitTextToSize(r,a).length;s=Math.ceil(u*f)}else a=c,s=u;return this.text(r,n,i,o),i+=.2*u,o.align==="center"&&(n-=c/2),o.align==="right"&&(n-=c),this.link(n,i-u,a,s,o),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(sr.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var o=t.__arabicParser__.isInArabicSubstitutionA=function(P){return e[P.charCodeAt(0)]!==void 0},s=t.__arabicParser__.isArabicLetter=function(P){return typeof P=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(P)},a=t.__arabicParser__.isArabicEndLetter=function(P){return s(P)&&o(P)&&e[P.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(P){return s(P)&&i.indexOf(P.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(P){return s(P)&&o(P)&&e[P.charCodeAt(0)].length>=1};var u=t.__arabicParser__.arabicLetterHasFinalForm=function(P){return s(P)&&o(P)&&e[P.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(P){return s(P)&&o(P)&&e[P.charCodeAt(0)].length>=3};var f=t.__arabicParser__.arabicLetterHasMedialForm=function(P){return s(P)&&o(P)&&e[P.charCodeAt(0)].length==4},y=t.__arabicParser__.resolveLigatures=function(P){var w=0,x=r,j="",ne=0;for(w=0;w<P.length;w+=1)x[P.charCodeAt(w)]!==void 0?(ne++,typeof(x=x[P.charCodeAt(w)])=="number"&&(j+=String.fromCharCode(x),x=r,ne=0),w===P.length-1&&(x=r,j+=P.charAt(w-(ne-1)),w-=ne-1,ne=0)):(x=r,j+=P.charAt(w-ne),w-=ne,ne=0);return j};t.__arabicParser__.isArabicDiacritic=function(P){return P!==void 0&&n[P.charCodeAt(0)]!==void 0};var v=t.__arabicParser__.getCorrectForm=function(P,w,x){return s(P)?o(P)===!1?-1:!u(P)||!s(w)&&!s(x)||!s(x)&&a(w)||a(P)&&!s(w)||a(P)&&c(w)||a(P)&&a(w)?0:f(P)&&s(w)&&!a(w)&&s(x)&&u(x)?3:a(P)||!s(x)?1:2:-1},p=function(P){var w=0,x=0,j=0,ne="",Q="",K="",Z=(P=P||"").split("\\s+"),k=[];for(w=0;w<Z.length;w+=1){for(k.push(""),x=0;x<Z[w].length;x+=1)ne=Z[w][x],Q=Z[w][x-1],K=Z[w][x+1],s(ne)?(j=v(ne,Q,K),k[w]+=j!==-1?String.fromCharCode(e[ne.charCodeAt(0)][j]):ne):k[w]+=ne;k[w]=y(k[w])}return k.join(" ")},I=t.__arabicParser__.processArabic=t.processArabic=function(){var P,w=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(w)){var j=0;for(x=[],j=0;j<w.length;j+=1)Array.isArray(w[j])?x.push([p(w[j][0]),w[j][1],w[j][2]]):x.push([p(w[j])]);P=x}else P=p(w);return typeof arguments[0]=="string"?P:(arguments[0].text=P,arguments[0])};t.events.push(["preProcessText",I])}(sr.API),sr.API.autoPrint=function(t){var e;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(a){r=a}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(a){n=isNaN(a)||Number.isInteger(a)===!1||a<0?150:a,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(a){i=isNaN(a)||Number.isInteger(a)===!1||a<0?300:a,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(a){o=a}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(a){s=a}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(sr.API),function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(P){c=P}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(P){u=P}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(P){f=P}});var y=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return y},set:function(P){y=P}});var v=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return v},set:function(P){v=P}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(P){p=P}});var I=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return I},set:function(P){I=P}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,u){n.call(this);var f=(u=u||{}).fontSize||this.getFontSize(),y=u.font||this.getFont(),v=u.scaleFactor||this.internal.scaleFactor,p=0,I=0,P=0,w=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var x=u.maxWidth;x>0?typeof c=="string"?c=this.splitTextToSize(c,x):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(ne,Q){return ne.concat(w.splitTextToSize(Q,x))},[])):c=Array.isArray(c)?c:[c];for(var j=0;j<c.length;j++)p<(P=this.getStringUnitWidth(c[j],{font:y})*f)&&(p=P);return p!==0&&(I=c.length),{w:p/=v,h:Math.max((I*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/v,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new o(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=t.cell=function(){var c;c=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var u=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,y=this.internal.__cell__.margins||e,v=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+y.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=y.top,p&&v&&(this.printHeaderRow(c.lineNumber,!0),c.y+=v[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-f,c.y+f,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+f,{align:"center",baseline:"top",maxWidth:c.width-f-f}):this.text(c.text,c.x+f,c.y+f,{align:"left",baseline:"top",maxWidth:c.width-f-f})),this.internal.__cell__.lastCell=c,this};t.table=function(c,u,f,y,v){if(n.call(this),!f)throw new Error("No data for PDF table.");var p,I,P,w,x=[],j=[],ne=[],Q={},K={},Z=[],k=[],C=(v=v||{}).autoSize||!1,E=v.printHeaders!==!1,M=v.css&&v.css["font-size"]!==void 0?16*v.css["font-size"]:v.fontSize||12,_=v.margins||Object.assign({width:this.getPageWidth()},e),S=typeof v.padding=="number"?v.padding:3,b=v.headerBackgroundColor||"#c8c8c8",Y=v.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=E,this.internal.__cell__.margins=_,this.internal.__cell__.table_font_size=M,this.internal.__cell__.padding=S,this.internal.__cell__.headerBackgroundColor=b,this.internal.__cell__.headerTextColor=Y,this.setFontSize(M),y==null)j=x=Object.keys(f[0]),ne=x.map(function(){return"left"});else if(Array.isArray(y)&&rn(y[0])==="object")for(x=y.map(function(F){return F.name}),j=y.map(function(F){return F.prompt||F.name||""}),ne=y.map(function(F){return F.align||"left"}),p=0;p<y.length;p+=1)K[y[p].name]=y[p].width*(19.049976/25.4);else Array.isArray(y)&&typeof y[0]=="string"&&(j=x=y,ne=x.map(function(){return"left"}));if(C||Array.isArray(y)&&typeof y[0]=="string")for(p=0;p<x.length;p+=1){for(Q[w=x[p]]=f.map(function(F){return F[w]}),this.setFont(void 0,"bold"),Z.push(this.getTextDimensions(j[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),I=Q[w],this.setFont(void 0,"normal"),P=0;P<I.length;P+=1)Z.push(this.getTextDimensions(I[P],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);K[w]=Math.max.apply(null,Z)+S+S,Z=[]}if(E){var te={};for(p=0;p<x.length;p+=1)te[x[p]]={},te[x[p]].text=j[p],te[x[p]].align=ne[p];var O=a.call(this,te,K);k=x.map(function(F){return new o(c,u,K[F],O,te[F].text,void 0,te[F].align)}),this.setTableHeaderRow(k),this.printHeaderRow(1,!1)}var D=y.reduce(function(F,ie){return F[ie.name]=ie.align,F},{});for(p=0;p<f.length;p+=1){"rowStart"in v&&v.rowStart instanceof Function&&v.rowStart({row:p,data:f[p]},this);var X=a.call(this,f[p],K);for(P=0;P<x.length;P+=1){var H=f[p][x[P]];"cellStart"in v&&v.cellStart instanceof Function&&v.cellStart({row:p,col:P,data:H},this),s.call(this,new o(c,u,K[x[P]],X,H,p+2,D[x[P]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var a=function(c,u){var f=this.internal.__cell__.padding,y=this.internal.__cell__.table_font_size,v=this.internal.scaleFactor;return Object.keys(c).map(function(p){var I=c[p];return this.splitTextToSize(I.hasOwnProperty("text")?I.text:I,u[p]-f-f)},this).map(function(p){return this.getLineHeightFactor()*p.length*y/v+f+f},this).reduce(function(p,I){return Math.max(p,I)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var y=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(y[0],y[1],y[2],y[3],void 0,-1)}this.setFont(void 0,"bold");for(var v=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){f=this.internal.__cell__.tableHeaderRow[p].clone(),u&&(f.y=this.internal.__cell__.margins.top||0,v.push(f)),f.lineNumber=c;var I=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,f),this.setTextColor(I)}v.length>0&&this.setTableHeaderRow(v),this.setFont(void 0,"normal"),r=!1}}(sr.API);var V5={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},z5=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],_m=j5(z5),q5=[100,200,300,400,500,600,700,800,900],CL=j5(q5);function wm(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=function(o){return V5[o=o||"normal"]?o:"normal"}(t.style),n=function(o){if(!o)return 400;if(typeof o=="number")return o>=100&&o<=900&&o%100==0?o:400;if(/^\d00$/.test(o))return parseInt(o);switch(o){case"bold":return 700;case"normal":default:return 400}}(t.weight),i=function(o){return typeof _m[o=o||"normal"]=="number"?o:"normal"}(t.stretch);return{family:e,style:r,weight:n,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,r,n].join(" ")}}}function j0(t,e,r,n){var i;for(i=r;i>=0&&i<e.length;i+=n)if(t[e[i]])return t[e[i]];for(i=r;i>=0&&i<e.length;i-=n)if(t[e[i]])return t[e[i]]}var IL={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},V0={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function z0(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function $L(t,e,r){for(var n=(r=r||{}).defaultFontFamily||"times",i=Object.assign({},IL,r.genericFontFamilies||{}),o=null,s=null,a=0;a<e.length;++a)if(i[(o=wm(e[a])).family]&&(o.family=i[o.family]),t.hasOwnProperty(o.family)){s=t[o.family];break}if(!(s=s||t[n]))throw new Error("Could not find a font-family for the rule '"+z0(o)+"' and default family '"+n+"'.");if(s=function(c,u){if(u[c])return u[c];var f=_m[c],y=f<=_m.normal?-1:1,v=j0(u,z5,f,y);if(!v)throw new Error("Could not find a matching font-stretch value for "+c);return v}(o.stretch,s),s=function(c,u){if(u[c])return u[c];for(var f=V5[c],y=0;y<f.length;++y)if(u[f[y]])return u[f[y]];throw new Error("Could not find a matching font-style for "+c)}(o.style,s),!(s=function(c,u){if(u[c])return u[c];if(c===400&&u[500])return u[500];if(c===500&&u[400])return u[400];var f=CL[c],y=j0(u,q5,f,c<400?-1:1);if(!y)throw new Error("Could not find a matching font-weight for value "+c);return y}(o.weight,s)))throw new Error("Failed to resolve a font for the rule '"+z0(o)+"'.");return s}function q0(t){return t.trimLeft()}function kL(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function EL(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var Hd,U0,H0,gp=["times"];(function(t){var e,r,n,i,o,s,a,c,u,f=function($){return $=$||{},this.isStrokeTransparent=$.isStrokeTransparent||!1,this.strokeOpacity=$.strokeOpacity||1,this.strokeStyle=$.strokeStyle||"#000000",this.fillStyle=$.fillStyle||"#000000",this.isFillTransparent=$.isFillTransparent||!1,this.fillOpacity=$.fillOpacity||1,this.font=$.font||"10px sans-serif",this.textBaseline=$.textBaseline||"alphabetic",this.textAlign=$.textAlign||"left",this.lineWidth=$.lineWidth||1,this.lineJoin=$.lineJoin||"miter",this.lineCap=$.lineCap||"butt",this.path=$.path||[],this.transform=$.transform!==void 0?$.transform.clone():new c,this.globalCompositeOperation=$.globalCompositeOperation||"normal",this.globalAlpha=$.globalAlpha||1,this.clip_path=$.clip_path||[],this.currentPoint=$.currentPoint||new s,this.miterLimit=$.miterLimit||10,this.lastPoint=$.lastPoint||new s,this.lineDashOffset=$.lineDashOffset||0,this.lineDash=$.lineDash||[],this.margin=$.margin||[0,0,0,0],this.prevPageLastElemOffset=$.prevPageLastElemOffset||0,this.ignoreClearRect=typeof $.ignoreClearRect!="boolean"||$.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new y(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,s=this.internal.Point,a=this.internal.Rectangle,c=this.internal.Matrix,u=new f}]);var y=function($){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var L=$;Object.defineProperty(this,"pdf",{get:function(){return L}});var U=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return U},set:function(le){U=!!le}});var N=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return N},set:function(le){N=!!le}});var z=0;Object.defineProperty(this,"posX",{get:function(){return z},set:function(le){isNaN(le)||(z=le)}});var oe=0;Object.defineProperty(this,"posY",{get:function(){return oe},set:function(le){isNaN(le)||(oe=le)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(le){var V;typeof le=="number"?V=[le,le,le,le]:((V=new Array(4))[0]=le[0],V[1]=le.length>=2?le[1]:V[0],V[2]=le.length>=3?le[2]:V[0],V[3]=le.length>=4?le[3]:V[1]),u.margin=V}});var G=!1;Object.defineProperty(this,"autoPaging",{get:function(){return G},set:function(le){G=le}});var ee=0;Object.defineProperty(this,"lastBreak",{get:function(){return ee},set:function(le){ee=le}});var J=[];Object.defineProperty(this,"pageBreaks",{get:function(){return J},set:function(le){J=le}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(le){le instanceof f&&(u=le)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(le){u.path=le}});var W=[];Object.defineProperty(this,"ctxStack",{get:function(){return W},set:function(le){W=le}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(le){var V;V=v(le),this.ctx.fillStyle=V.style,this.ctx.isFillTransparent=V.a===0,this.ctx.fillOpacity=V.a,this.pdf.setFillColor(V.r,V.g,V.b,{a:V.a}),this.pdf.setTextColor(V.r,V.g,V.b,{a:V.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(le){var V=v(le);this.ctx.strokeStyle=V.style,this.ctx.isStrokeTransparent=V.a===0,this.ctx.strokeOpacity=V.a,V.a===0?this.pdf.setDrawColor(255,255,255):(V.a,this.pdf.setDrawColor(V.r,V.g,V.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(le){["butt","round","square"].indexOf(le)!==-1&&(this.ctx.lineCap=le,this.pdf.setLineCap(le))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(le){isNaN(le)||(this.ctx.lineWidth=le,this.pdf.setLineWidth(le))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(le){["bevel","round","miter"].indexOf(le)!==-1&&(this.ctx.lineJoin=le,this.pdf.setLineJoin(le))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(le){isNaN(le)||(this.ctx.miterLimit=le,this.pdf.setMiterLimit(le))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(le){this.ctx.textBaseline=le}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(le){["right","end","center","left","start"].indexOf(le)!==-1&&(this.ctx.textAlign=le)}});var q=null;function ae(le,V){if(q===null){var ce=function(Pe){var fe=[];return Object.keys(Pe).forEach(function(be){Pe[be].forEach(function(xe){var he=null;switch(xe){case"bold":he={family:be,weight:"bold"};break;case"italic":he={family:be,style:"italic"};break;case"bolditalic":he={family:be,weight:"bold",style:"italic"};break;case"":case"normal":he={family:be}}he!==null&&(he.ref={name:be,style:xe},fe.push(he))})}),fe}(le.getFontList());q=function(Pe){for(var fe={},be=0;be<Pe.length;++be){var xe=wm(Pe[be]),he=xe.family,ve=xe.stretch,De=xe.style,Ee=xe.weight;fe[he]=fe[he]||{},fe[he][ve]=fe[he][ve]||{},fe[he][ve][De]=fe[he][ve][De]||{},fe[he][ve][De][Ee]=xe}return fe}(ce.concat(V))}return q}var de=null;Object.defineProperty(this,"fontFaces",{get:function(){return de},set:function(le){q=null,de=le}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(le){var V;if(this.ctx.font=le,(V=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(le))!==null){var ce=V[1];V[2];var Pe=V[3],fe=V[4];V[5];var be=V[6],xe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(fe)[2];fe=Math.floor(xe==="px"?parseFloat(fe)*this.pdf.internal.scaleFactor:xe==="em"?parseFloat(fe)*this.pdf.getFontSize():parseFloat(fe)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(fe);var he=function(Re){var We,Fe,Xe=[],tt=Re.trim();if(tt==="")return gp;if(tt in V0)return[V0[tt]];for(;tt!=="";){switch(Fe=null,We=(tt=q0(tt)).charAt(0)){case'"':case"'":Fe=kL(tt.substring(1),We);break;default:Fe=EL(tt)}if(Fe===null||(Xe.push(Fe[0]),(tt=q0(Fe[1]))!==""&&tt.charAt(0)!==","))return gp;tt=tt.replace(/^,/,"")}return Xe}(be);if(this.fontFaces){var ve=$L(ae(this.pdf,this.fontFaces),he.map(function(Re){return{family:Re,stretch:"normal",weight:Pe,style:ce}}));this.pdf.setFont(ve.ref.name,ve.ref.style)}else{var De="";(Pe==="bold"||parseInt(Pe,10)>=700||ce==="bold")&&(De="bold"),ce==="italic"&&(De+="italic"),De.length===0&&(De="normal");for(var Ee="",Ce={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ne=0;Ne<he.length;Ne++){if(this.pdf.internal.getFont(he[Ne],De,{noFallback:!0,disableWarning:!0})!==void 0){Ee=he[Ne];break}if(De==="bolditalic"&&this.pdf.internal.getFont(he[Ne],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Ee=he[Ne],De="bold";else if(this.pdf.internal.getFont(he[Ne],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Ee=he[Ne],De="normal";break}}if(Ee===""){for(var Ie=0;Ie<he.length;Ie++)if(Ce[he[Ie]]){Ee=Ce[he[Ie]];break}}Ee=Ee===""?"Times":Ee,this.pdf.setFont(Ee,De)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(le){this.ctx.globalCompositeOperation=le}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(le){this.ctx.globalAlpha=le}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(le){this.ctx.lineDashOffset=le,ie.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(le){this.ctx.lineDash=le,ie.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(le){this.ctx.ignoreClearRect=!!le}})};y.prototype.setLineDash=function($){this.lineDash=$},y.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},y.prototype.fill=function(){Q.call(this,"fill",!1)},y.prototype.stroke=function(){Q.call(this,"stroke",!1)},y.prototype.beginPath=function(){this.path=[{type:"begin"}]},y.prototype.moveTo=function($,L){if(isNaN($)||isNaN(L))throw cn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var U=this.ctx.transform.applyToPoint(new s($,L));this.path.push({type:"mt",x:U.x,y:U.y}),this.ctx.lastPoint=new s($,L)},y.prototype.closePath=function(){var $=new s(0,0),L=0;for(L=this.path.length-1;L!==-1;L--)if(this.path[L].type==="begin"&&rn(this.path[L+1])==="object"&&typeof this.path[L+1].x=="number"){$=new s(this.path[L+1].x,this.path[L+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s($.x,$.y)},y.prototype.lineTo=function($,L){if(isNaN($)||isNaN(L))throw cn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var U=this.ctx.transform.applyToPoint(new s($,L));this.path.push({type:"lt",x:U.x,y:U.y}),this.ctx.lastPoint=new s(U.x,U.y)},y.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),Q.call(this,null,!0)},y.prototype.quadraticCurveTo=function($,L,U,N){if(isNaN(U)||isNaN(N)||isNaN($)||isNaN(L))throw cn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var z=this.ctx.transform.applyToPoint(new s(U,N)),oe=this.ctx.transform.applyToPoint(new s($,L));this.path.push({type:"qct",x1:oe.x,y1:oe.y,x:z.x,y:z.y}),this.ctx.lastPoint=new s(z.x,z.y)},y.prototype.bezierCurveTo=function($,L,U,N,z,oe){if(isNaN(z)||isNaN(oe)||isNaN($)||isNaN(L)||isNaN(U)||isNaN(N))throw cn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var G=this.ctx.transform.applyToPoint(new s(z,oe)),ee=this.ctx.transform.applyToPoint(new s($,L)),J=this.ctx.transform.applyToPoint(new s(U,N));this.path.push({type:"bct",x1:ee.x,y1:ee.y,x2:J.x,y2:J.y,x:G.x,y:G.y}),this.ctx.lastPoint=new s(G.x,G.y)},y.prototype.arc=function($,L,U,N,z,oe){if(isNaN($)||isNaN(L)||isNaN(U)||isNaN(N)||isNaN(z))throw cn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(oe=!!oe,!this.ctx.transform.isIdentity){var G=this.ctx.transform.applyToPoint(new s($,L));$=G.x,L=G.y;var ee=this.ctx.transform.applyToPoint(new s(0,U)),J=this.ctx.transform.applyToPoint(new s(0,0));U=Math.sqrt(Math.pow(ee.x-J.x,2)+Math.pow(ee.y-J.y,2))}Math.abs(z-N)>=2*Math.PI&&(N=0,z=2*Math.PI),this.path.push({type:"arc",x:$,y:L,radius:U,startAngle:N,endAngle:z,counterclockwise:oe})},y.prototype.arcTo=function($,L,U,N,z){throw new Error("arcTo not implemented.")},y.prototype.rect=function($,L,U,N){if(isNaN($)||isNaN(L)||isNaN(U)||isNaN(N))throw cn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo($,L),this.lineTo($+U,L),this.lineTo($+U,L+N),this.lineTo($,L+N),this.lineTo($,L),this.lineTo($+U,L),this.lineTo($,L)},y.prototype.fillRect=function($,L,U,N){if(isNaN($)||isNaN(L)||isNaN(U)||isNaN(N))throw cn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var z={};this.lineCap!=="butt"&&(z.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(z.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect($,L,U,N),this.fill(),z.hasOwnProperty("lineCap")&&(this.lineCap=z.lineCap),z.hasOwnProperty("lineJoin")&&(this.lineJoin=z.lineJoin)}},y.prototype.strokeRect=function($,L,U,N){if(isNaN($)||isNaN(L)||isNaN(U)||isNaN(N))throw cn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");I.call(this)||(this.beginPath(),this.rect($,L,U,N),this.stroke())},y.prototype.clearRect=function($,L,U,N){if(isNaN($)||isNaN(L)||isNaN(U)||isNaN(N))throw cn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect($,L,U,N))},y.prototype.save=function($){$=typeof $!="boolean"||$;for(var L=this.pdf.internal.getCurrentPageInfo().pageNumber,U=0;U<this.pdf.internal.getNumberOfPages();U++)this.pdf.setPage(U+1),this.pdf.internal.out("q");if(this.pdf.setPage(L),$){this.ctx.fontSize=this.pdf.internal.getFontSize();var N=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=N}},y.prototype.restore=function($){$=typeof $!="boolean"||$;for(var L=this.pdf.internal.getCurrentPageInfo().pageNumber,U=0;U<this.pdf.internal.getNumberOfPages();U++)this.pdf.setPage(U+1),this.pdf.internal.out("Q");this.pdf.setPage(L),$&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},y.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var v=function($){var L,U,N,z;if($.isCanvasGradient===!0&&($=$.getColor()),!$)return{r:0,g:0,b:0,a:0,style:$};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test($))L=0,U=0,N=0,z=0;else{var oe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec($);if(oe!==null)L=parseInt(oe[1]),U=parseInt(oe[2]),N=parseInt(oe[3]),z=1;else if((oe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec($))!==null)L=parseInt(oe[1]),U=parseInt(oe[2]),N=parseInt(oe[3]),z=parseFloat(oe[4]);else{if(z=1,typeof $=="string"&&$.charAt(0)!=="#"){var G=new D5($);$=G.ok?G.toHex():"#000000"}$.length===4?(L=$.substring(1,2),L+=L,U=$.substring(2,3),U+=U,N=$.substring(3,4),N+=N):(L=$.substring(1,3),U=$.substring(3,5),N=$.substring(5,7)),L=parseInt(L,16),U=parseInt(U,16),N=parseInt(N,16)}}return{r:L,g:U,b:N,a:z,style:$}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},I=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};y.prototype.fillText=function($,L,U,N){if(isNaN(L)||isNaN(U)||typeof $!="string")throw cn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(N=isNaN(N)?void 0:N,!p.call(this)){var z=X(this.ctx.transform.rotation),oe=this.ctx.transform.scaleX;S.call(this,{text:$,x:L,y:U,scale:oe,angle:z,align:this.textAlign,maxWidth:N})}},y.prototype.strokeText=function($,L,U,N){if(isNaN(L)||isNaN(U)||typeof $!="string")throw cn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!I.call(this)){N=isNaN(N)?void 0:N;var z=X(this.ctx.transform.rotation),oe=this.ctx.transform.scaleX;S.call(this,{text:$,x:L,y:U,scale:oe,renderingMode:"stroke",angle:z,align:this.textAlign,maxWidth:N})}},y.prototype.measureText=function($){if(typeof $!="string")throw cn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var L=this.pdf,U=this.pdf.internal.scaleFactor,N=L.internal.getFontSize(),z=L.getStringUnitWidth($)*N/L.internal.scaleFactor,oe=function(G){var ee=(G=G||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ee}}),this};return new oe({width:z*=Math.round(96*U/72*1e4)/1e4})},y.prototype.scale=function($,L){if(isNaN($)||isNaN(L))throw cn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var U=new c($,0,0,L,0,0);this.ctx.transform=this.ctx.transform.multiply(U)},y.prototype.rotate=function($){if(isNaN($))throw cn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var L=new c(Math.cos($),Math.sin($),-Math.sin($),Math.cos($),0,0);this.ctx.transform=this.ctx.transform.multiply(L)},y.prototype.translate=function($,L){if(isNaN($)||isNaN(L))throw cn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var U=new c(1,0,0,1,$,L);this.ctx.transform=this.ctx.transform.multiply(U)},y.prototype.transform=function($,L,U,N,z,oe){if(isNaN($)||isNaN(L)||isNaN(U)||isNaN(N)||isNaN(z)||isNaN(oe))throw cn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var G=new c($,L,U,N,z,oe);this.ctx.transform=this.ctx.transform.multiply(G)},y.prototype.setTransform=function($,L,U,N,z,oe){$=isNaN($)?1:$,L=isNaN(L)?0:L,U=isNaN(U)?0:U,N=isNaN(N)?1:N,z=isNaN(z)?0:z,oe=isNaN(oe)?0:oe,this.ctx.transform=new c($,L,U,N,z,oe)};var P=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};y.prototype.drawImage=function($,L,U,N,z,oe,G,ee,J){var W=this.pdf.getImageProperties($),q=1,ae=1,de=1,le=1;N!==void 0&&ee!==void 0&&(de=ee/N,le=J/z,q=W.width/N*ee/N,ae=W.height/z*J/z),oe===void 0&&(oe=L,G=U,L=0,U=0),N!==void 0&&ee===void 0&&(ee=N,J=z),N===void 0&&ee===void 0&&(ee=W.width,J=W.height);for(var V,ce=this.ctx.transform.decompose(),Pe=X(ce.rotate.shx),fe=new c,be=(fe=(fe=(fe=fe.multiply(ce.translate)).multiply(ce.skew)).multiply(ce.scale)).applyToRectangle(new a(oe-L*de,G-U*le,N*q,z*ae)),xe=w.call(this,be),he=[],ve=0;ve<xe.length;ve+=1)he.indexOf(xe[ve])===-1&&he.push(xe[ve]);if(ne(he),this.autoPaging)for(var De=he[0],Ee=he[he.length-1],Ce=De;Ce<Ee+1;Ce++){this.pdf.setPage(Ce);var Ne=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ie=Ce===1?this.posY+this.margin[0]:this.margin[0],Re=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],We=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Fe=Ce===1?0:Re+(Ce-2)*We;if(this.ctx.clip_path.length!==0){var Xe=this.path;V=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=j(V,this.posX+this.margin[3],-Fe+Ie+this.ctx.prevPageLastElemOffset),K.call(this,"fill",!0),this.path=Xe}var tt=JSON.parse(JSON.stringify(be));tt=j([tt],this.posX+this.margin[3],-Fe+Ie+this.ctx.prevPageLastElemOffset)[0];var At=(Ce>De||Ce<Ee)&&P.call(this);At&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ne,We,null).clip().discardPath()),this.pdf.addImage($,"JPEG",tt.x,tt.y,tt.w,tt.h,null,null,Pe),At&&this.pdf.restoreGraphicsState()}else this.pdf.addImage($,"JPEG",be.x,be.y,be.w,be.h,null,null,Pe)};var w=function($,L,U){var N=[];L=L||this.pdf.internal.pageSize.width,U=U||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var z=this.posY+this.ctx.prevPageLastElemOffset;switch($.type){default:case"mt":case"lt":N.push(Math.floor(($.y+z)/U)+1);break;case"arc":N.push(Math.floor(($.y+z-$.radius)/U)+1),N.push(Math.floor(($.y+z+$.radius)/U)+1);break;case"qct":var oe=H(this.ctx.lastPoint.x,this.ctx.lastPoint.y,$.x1,$.y1,$.x,$.y);N.push(Math.floor((oe.y+z)/U)+1),N.push(Math.floor((oe.y+oe.h+z)/U)+1);break;case"bct":var G=F(this.ctx.lastPoint.x,this.ctx.lastPoint.y,$.x1,$.y1,$.x2,$.y2,$.x,$.y);N.push(Math.floor((G.y+z)/U)+1),N.push(Math.floor((G.y+G.h+z)/U)+1);break;case"rect":N.push(Math.floor(($.y+z)/U)+1),N.push(Math.floor(($.y+$.h+z)/U)+1)}for(var ee=0;ee<N.length;ee+=1)for(;this.pdf.internal.getNumberOfPages()<N[ee];)x.call(this);return N},x=function(){var $=this.fillStyle,L=this.strokeStyle,U=this.font,N=this.lineCap,z=this.lineWidth,oe=this.lineJoin;this.pdf.addPage(),this.fillStyle=$,this.strokeStyle=L,this.font=U,this.lineCap=N,this.lineWidth=z,this.lineJoin=oe},j=function($,L,U){for(var N=0;N<$.length;N++)switch($[N].type){case"bct":$[N].x2+=L,$[N].y2+=U;case"qct":$[N].x1+=L,$[N].y1+=U;case"mt":case"lt":case"arc":default:$[N].x+=L,$[N].y+=U}return $},ne=function($){return $.sort(function(L,U){return L-U})},Q=function($,L){for(var U,N,z=this.fillStyle,oe=this.strokeStyle,G=this.lineCap,ee=this.lineWidth,J=Math.abs(ee*this.ctx.transform.scaleX),W=this.lineJoin,q=JSON.parse(JSON.stringify(this.path)),ae=JSON.parse(JSON.stringify(this.path)),de=[],le=0;le<ae.length;le++)if(ae[le].x!==void 0)for(var V=w.call(this,ae[le]),ce=0;ce<V.length;ce+=1)de.indexOf(V[ce])===-1&&de.push(V[ce]);for(var Pe=0;Pe<de.length;Pe++)for(;this.pdf.internal.getNumberOfPages()<de[Pe];)x.call(this);if(ne(de),this.autoPaging)for(var fe=de[0],be=de[de.length-1],xe=fe;xe<be+1;xe++){this.pdf.setPage(xe),this.fillStyle=z,this.strokeStyle=oe,this.lineCap=G,this.lineWidth=J,this.lineJoin=W;var he=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ve=xe===1?this.posY+this.margin[0]:this.margin[0],De=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ee=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ce=xe===1?0:De+(xe-2)*Ee;if(this.ctx.clip_path.length!==0){var Ne=this.path;U=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=j(U,this.posX+this.margin[3],-Ce+ve+this.ctx.prevPageLastElemOffset),K.call(this,$,!0),this.path=Ne}if(N=JSON.parse(JSON.stringify(q)),this.path=j(N,this.posX+this.margin[3],-Ce+ve+this.ctx.prevPageLastElemOffset),L===!1||xe===0){var Ie=(xe>fe||xe<be)&&P.call(this);Ie&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],he,Ee,null).clip().discardPath()),K.call(this,$,L),Ie&&this.pdf.restoreGraphicsState()}this.lineWidth=ee}else this.lineWidth=J,K.call(this,$,L),this.lineWidth=ee;this.path=q},K=function($,L){if(($!=="stroke"||L||!I.call(this))&&($==="stroke"||L||!p.call(this))){for(var U,N,z=[],oe=this.path,G=0;G<oe.length;G++){var ee=oe[G];switch(ee.type){case"begin":z.push({begin:!0});break;case"close":z.push({close:!0});break;case"mt":z.push({start:ee,deltas:[],abs:[]});break;case"lt":var J=z.length;if(oe[G-1]&&!isNaN(oe[G-1].x)&&(U=[ee.x-oe[G-1].x,ee.y-oe[G-1].y],J>0)){for(;J>=0;J--)if(z[J-1].close!==!0&&z[J-1].begin!==!0){z[J-1].deltas.push(U),z[J-1].abs.push(ee);break}}break;case"bct":U=[ee.x1-oe[G-1].x,ee.y1-oe[G-1].y,ee.x2-oe[G-1].x,ee.y2-oe[G-1].y,ee.x-oe[G-1].x,ee.y-oe[G-1].y],z[z.length-1].deltas.push(U);break;case"qct":var W=oe[G-1].x+2/3*(ee.x1-oe[G-1].x),q=oe[G-1].y+2/3*(ee.y1-oe[G-1].y),ae=ee.x+2/3*(ee.x1-ee.x),de=ee.y+2/3*(ee.y1-ee.y),le=ee.x,V=ee.y;U=[W-oe[G-1].x,q-oe[G-1].y,ae-oe[G-1].x,de-oe[G-1].y,le-oe[G-1].x,V-oe[G-1].y],z[z.length-1].deltas.push(U);break;case"arc":z.push({deltas:[],abs:[],arc:!0}),Array.isArray(z[z.length-1].abs)&&z[z.length-1].abs.push(ee)}}N=L?null:$==="stroke"?"stroke":"fill";for(var ce=!1,Pe=0;Pe<z.length;Pe++)if(z[Pe].arc)for(var fe=z[Pe].abs,be=0;be<fe.length;be++){var xe=fe[be];xe.type==="arc"?C.call(this,xe.x,xe.y,xe.radius,xe.startAngle,xe.endAngle,xe.counterclockwise,void 0,L,!ce):b.call(this,xe.x,xe.y),ce=!0}else if(z[Pe].close===!0)this.pdf.internal.out("h"),ce=!1;else if(z[Pe].begin!==!0){var he=z[Pe].start.x,ve=z[Pe].start.y;Y.call(this,z[Pe].deltas,he,ve),ce=!0}N&&E.call(this,N),L&&M.call(this)}},Z=function($){var L=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,U=L*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return $-U;case"top":return $+L-U;case"hanging":return $+L-2*U;case"middle":return $+L/2-U;case"ideographic":return $;case"alphabetic":default:return $}},k=function($){return $+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};y.prototype.createLinearGradient=function(){var $=function(){};return $.colorStops=[],$.addColorStop=function(L,U){this.colorStops.push([L,U])},$.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},$.isCanvasGradient=!0,$},y.prototype.createPattern=function(){return this.createLinearGradient()},y.prototype.createRadialGradient=function(){return this.createLinearGradient()};var C=function($,L,U,N,z,oe,G,ee,J){for(var W=O.call(this,U,N,z,oe),q=0;q<W.length;q++){var ae=W[q];q===0&&(J?_.call(this,ae.x1+$,ae.y1+L):b.call(this,ae.x1+$,ae.y1+L)),te.call(this,$,L,ae.x2,ae.y2,ae.x3,ae.y3,ae.x4,ae.y4)}ee?M.call(this):E.call(this,G)},E=function($){switch($){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},M=function(){this.pdf.clip(),this.pdf.discardPath()},_=function($,L){this.pdf.internal.out(r($)+" "+n(L)+" m")},S=function($){var L;switch($.align){case"right":case"end":L="right";break;case"center":L="center";break;case"left":case"start":default:L="left"}var U=this.pdf.getTextDimensions($.text),N=Z.call(this,$.y),z=k.call(this,N)-U.h,oe=this.ctx.transform.applyToPoint(new s($.x,N)),G=this.ctx.transform.decompose(),ee=new c;ee=(ee=(ee=ee.multiply(G.translate)).multiply(G.skew)).multiply(G.scale);for(var J,W,q,ae=this.ctx.transform.applyToRectangle(new a($.x,N,U.w,U.h)),de=ee.applyToRectangle(new a($.x,z,U.w,U.h)),le=w.call(this,de),V=[],ce=0;ce<le.length;ce+=1)V.indexOf(le[ce])===-1&&V.push(le[ce]);if(ne(V),this.autoPaging)for(var Pe=V[0],fe=V[V.length-1],be=Pe;be<fe+1;be++){this.pdf.setPage(be);var xe=be===1?this.posY+this.margin[0]:this.margin[0],he=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ve=this.pdf.internal.pageSize.height-this.margin[2],De=ve-this.margin[0],Ee=this.pdf.internal.pageSize.width-this.margin[1],Ce=Ee-this.margin[3],Ne=be===1?0:he+(be-2)*De;if(this.ctx.clip_path.length!==0){var Ie=this.path;J=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=j(J,this.posX+this.margin[3],-1*Ne+xe),K.call(this,"fill",!0),this.path=Ie}var Re=j([JSON.parse(JSON.stringify(de))],this.posX+this.margin[3],-Ne+xe+this.ctx.prevPageLastElemOffset)[0];$.scale>=.01&&(W=this.pdf.internal.getFontSize(),this.pdf.setFontSize(W*$.scale),q=this.lineWidth,this.lineWidth=q*$.scale);var We=this.autoPaging!=="text";if(We||Re.y+Re.h<=ve){if(We||Re.y>=xe&&Re.x<=Ee){var Fe=We?$.text:this.pdf.splitTextToSize($.text,$.maxWidth||Ee-Re.x)[0],Xe=j([JSON.parse(JSON.stringify(ae))],this.posX+this.margin[3],-Ne+xe+this.ctx.prevPageLastElemOffset)[0],tt=We&&(be>Pe||be<fe)&&P.call(this);tt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ce,De,null).clip().discardPath()),this.pdf.text(Fe,Xe.x,Xe.y,{angle:$.angle,align:L,renderingMode:$.renderingMode}),tt&&this.pdf.restoreGraphicsState()}}else Re.y<ve&&(this.ctx.prevPageLastElemOffset+=ve-Re.y);$.scale>=.01&&(this.pdf.setFontSize(W),this.lineWidth=q)}else $.scale>=.01&&(W=this.pdf.internal.getFontSize(),this.pdf.setFontSize(W*$.scale),q=this.lineWidth,this.lineWidth=q*$.scale),this.pdf.text($.text,oe.x+this.posX,oe.y+this.posY,{angle:$.angle,align:L,renderingMode:$.renderingMode,maxWidth:$.maxWidth}),$.scale>=.01&&(this.pdf.setFontSize(W),this.lineWidth=q)},b=function($,L,U,N){U=U||0,N=N||0,this.pdf.internal.out(r($+U)+" "+n(L+N)+" l")},Y=function($,L,U){return this.pdf.lines($,L,U,null,null)},te=function($,L,U,N,z,oe,G,ee){this.pdf.internal.out([e(i(U+$)),e(o(N+L)),e(i(z+$)),e(o(oe+L)),e(i(G+$)),e(o(ee+L)),"c"].join(" "))},O=function($,L,U,N){for(var z=2*Math.PI,oe=Math.PI/2;L>U;)L-=z;var G=Math.abs(U-L);G<z&&N&&(G=z-G);for(var ee=[],J=N?-1:1,W=L;G>1e-5;){var q=W+J*Math.min(G,oe);ee.push(D.call(this,$,W,q)),G-=Math.abs(q-W),W=q}return ee},D=function($,L,U){var N=(U-L)/2,z=$*Math.cos(N),oe=$*Math.sin(N),G=z,ee=-oe,J=G*G+ee*ee,W=J+G*z+ee*oe,q=4/3*(Math.sqrt(2*J*W)-W)/(G*oe-ee*z),ae=G-q*ee,de=ee+q*G,le=ae,V=-de,ce=N+L,Pe=Math.cos(ce),fe=Math.sin(ce);return{x1:$*Math.cos(L),y1:$*Math.sin(L),x2:ae*Pe-de*fe,y2:ae*fe+de*Pe,x3:le*Pe-V*fe,y3:le*fe+V*Pe,x4:$*Math.cos(U),y4:$*Math.sin(U)}},X=function($){return 180*$/Math.PI},H=function($,L,U,N,z,oe){var G=$+.5*(U-$),ee=L+.5*(N-L),J=z+.5*(U-z),W=oe+.5*(N-oe),q=Math.min($,z,G,J),ae=Math.max($,z,G,J),de=Math.min(L,oe,ee,W),le=Math.max(L,oe,ee,W);return new a(q,de,ae-q,le-de)},F=function($,L,U,N,z,oe,G,ee){var J,W,q,ae,de,le,V,ce,Pe,fe,be,xe,he,ve,De=U-$,Ee=N-L,Ce=z-U,Ne=oe-N,Ie=G-z,Re=ee-oe;for(W=0;W<41;W++)Pe=(V=(q=$+(J=W/40)*De)+J*((de=U+J*Ce)-q))+J*(de+J*(z+J*Ie-de)-V),fe=(ce=(ae=L+J*Ee)+J*((le=N+J*Ne)-ae))+J*(le+J*(oe+J*Re-le)-ce),W==0?(be=Pe,xe=fe,he=Pe,ve=fe):(be=Math.min(be,Pe),xe=Math.min(xe,fe),he=Math.max(he,Pe),ve=Math.max(ve,fe));return new a(Math.round(be),Math.round(xe),Math.round(he-be),Math.round(ve-xe))},ie=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var $,L,U=($=this.ctx.lineDash,L=this.ctx.lineDashOffset,JSON.stringify({lineDash:$,lineDashOffset:L}));this.prevLineDash!==U&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=U)}}})(sr.API),function(t){var e=function(o){var s,a,c,u,f,y,v,p,I,P;for(a=[],c=0,u=(o+=s="\0\0\0\0".slice(o.length%4||4)).length;u>c;c+=4)(f=(o.charCodeAt(c)<<24)+(o.charCodeAt(c+1)<<16)+(o.charCodeAt(c+2)<<8)+o.charCodeAt(c+3))!==0?(y=(f=((f=((f=((f=(f-(P=f%85))/85)-(I=f%85))/85)-(p=f%85))/85)-(v=f%85))/85)%85,a.push(y+33,v+33,p+33,I+33,P+33)):a.push(122);return function(w,x){for(var j=x;j>0;j--)w.pop()}(a,s.length),String.fromCharCode.apply(String,a)+"~>"},r=function(o){var s,a,c,u,f,y=String,v="length",p=255,I="charCodeAt",P="slice",w="replace";for(o[P](-2),o=o[P](0,-2)[w](/\s/g,"")[w]("z","!!!!!"),c=[],u=0,f=(o+=s="uuuuu"[P](o[v]%5||5))[v];f>u;u+=5)a=52200625*(o[I](u)-33)+614125*(o[I](u+1)-33)+7225*(o[I](u+2)-33)+85*(o[I](u+3)-33)+(o[I](u+4)-33),c.push(p&a>>24,p&a>>16,p&a>>8,p&a);return function(x,j){for(var ne=j;ne>0;ne--)x.pop()}(c,s[v]),y.fromCharCode.apply(y,c)},n=function(o){var s=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),s.test(o)===!1)return"";for(var a="",c=0;c<o.length;c+=2)a+=String.fromCharCode("0x"+(o[c]+o[c+1]));return a},i=function(o){for(var s=new Uint8Array(o.length),a=o.length;a--;)s[a]=o.charCodeAt(a);return o=(s=mm(s)).reduce(function(c,u){return c+String.fromCharCode(u)},"")};t.processDataByFilters=function(o,s){var a=0,c=o||"",u=[];for(typeof(s=s||[])=="string"&&(s=[s]),a=0;a<s.length;a+=1)switch(s[a]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=n(c),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(f){return("0"+f.charCodeAt().toString(16)).slice(-2)}).join("")+">",u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=i(c),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[a]+'" is not implemented')}return{data:c,reverseChain:u.reverse().join(" ")}}}(sr.API),function(t){t.loadFile=function(e,r,n){return function(i,o,s){o=o!==!1,s=typeof s=="function"?s:function(){};var a=void 0;try{a=function(c,u,f){var y=new XMLHttpRequest,v=0,p=function(I){var P=I.length,w=[],x=String.fromCharCode;for(v=0;v<P;v+=1)w.push(x(255&I.charCodeAt(v)));return w.join("")};if(y.open("GET",c,!u),y.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(y.onload=function(){y.status===200?f(p(this.responseText)):f(void 0)}),y.send(null),u&&y.status===200)return p(y.responseText)}(i,o,s)}catch{}return a}(e,r,n)},t.loadImageFile=t.loadFile}(sr.API),function(t){function e(){return(lr.html2canvas?Promise.resolve(lr.html2canvas):Ui(()=>import("./html2canvas.esm-BfxBtG_O.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load html2canvas: "+s))}).then(function(s){return s.default?s.default:s})}function r(){return(lr.DOMPurify?Promise.resolve(lr.DOMPurify):Ui(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load dompurify: "+s))}).then(function(s){return s.default?s.default:s})}var n=function(s){var a=rn(s);return a==="undefined"?"undefined":a==="string"||s instanceof String?"string":a==="number"||s instanceof Number?"number":a==="function"||s instanceof Function?"function":s&&s.constructor===Array?"array":s&&s.nodeType===1?"element":a==="object"?"object":"unknown"},i=function(s,a){var c=document.createElement(s);for(var u in a.className&&(c.className=a.className),a.innerHTML&&a.dompurify&&(c.innerHTML=a.dompurify.sanitize(a.innerHTML)),a.style)c.style[u]=a.style[u];return c},o=function s(a){var c=Object.assign(s.convert(Promise.resolve()),JSON.parse(JSON.stringify(s.template))),u=s.convert(Promise.resolve(),c);return u=(u=u.setProgress(1,s,1,[s])).set(a)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(s,a){return s.__proto__=a||o.prototype,s},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(s,a){return this.then(function(){switch(a=a||function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(s)){case"string":return this.then(r).then(function(c){return this.set({src:i("div",{innerHTML:s,dompurify:c})})});case"element":return this.set({src:s});case"canvas":return this.set({canvas:s});case"img":return this.set({img:s});default:return this.error("Unknown source type.")}})},o.prototype.to=function(s){switch(s){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var s={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},a=function c(u,f){for(var y=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),v=u.firstChild;v;v=v.nextSibling)f!==!0&&v.nodeType===1&&v.nodeName==="SCRIPT"||y.appendChild(c(v,f));return u.nodeType===1&&(u.nodeName==="CANVAS"?(y.width=u.width,y.height=u.height,y.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(y.value=u.value),y.addEventListener("load",function(){y.scrollTop=u.scrollTop,y.scrollLeft=u.scrollLeft},!0)),y}(this.prop.src,this.opt.html2canvas.javascriptEnabled);a.tagName==="BODY"&&(s.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:s}),this.prop.container.appendChild(a),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(e).then(function(a){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,a(this.prop.container,c)}).then(function(a){(this.opt.html2canvas.onrendered||function(){})(a),this.prop.canvas=a,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(e).then(function(a){var c=this.opt.jsPDF,u=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,y=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete y.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=u,u)for(var v=0;v<u.length;++v){var p=u[v],I=p.src.find(function(P){return P.format==="truetype"});I&&c.addFont(I.url,p.ref.name,p.ref.style)}return y.windowHeight=y.windowHeight||0,y.windowHeight=y.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):y.windowHeight,c.context2d.save(!0),a(this.prop.container,y)}).then(function(a){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(a),this.prop.canvas=a,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var s=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=s})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(s,a,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(s,a):this.outputPdf(s,a)},o.prototype.outputPdf=function(s,a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(s,a)})},o.prototype.outputImg=function(s){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(s){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+s+'" is not supported.'}})},o.prototype.save=function(s){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(s?{filename:s}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(s){if(n(s)!=="object")return this;var a=Object.keys(s||{}).map(function(c){if(c in o.template.prop)return function(){this.prop[c]=s[c]};switch(c){case"margin":return this.setMargin.bind(this,s.margin);case"jsPDF":return function(){return this.opt.jsPDF=s.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,s.pageSize);default:return function(){this.opt[c]=s[c]}}},this);return this.then(function(){return this.thenList(a)})},o.prototype.get=function(s,a){return this.then(function(){var c=s in o.template.prop?this.prop[s]:this.opt[s];return a?a(c):c})},o.prototype.setMargin=function(s){return this.then(function(){switch(n(s)){case"number":s=[s,s,s,s];case"array":if(s.length===2&&(s=[s[0],s[1],s[0],s[1]]),s.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=s}).then(this.setPageSize)},o.prototype.setPageSize=function(s){function a(c,u){return Math.floor(c*u/72*96)}return this.then(function(){(s=s||sr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(s.inner={width:s.width-this.opt.margin[1]-this.opt.margin[3],height:s.height-this.opt.margin[0]-this.opt.margin[2]},s.inner.px={width:a(s.inner.width,s.k),height:a(s.inner.height,s.k)},s.inner.ratio=s.inner.height/s.inner.width),this.prop.pageSize=s})},o.prototype.setProgress=function(s,a,c,u){return s!=null&&(this.progress.val=s),a!=null&&(this.progress.state=a),c!=null&&(this.progress.n=c),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(s,a,c,u){return this.setProgress(s?this.progress.val+s:null,a||null,c?this.progress.n+c:null,u?this.progress.stack.concat(u):null)},o.prototype.then=function(s,a){var c=this;return this.thenCore(s,a,function(u,f){return c.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(y){return c.updateProgress(null,u),y}).then(u,f).then(function(y){return c.updateProgress(1),y})})},o.prototype.thenCore=function(s,a,c){c=c||Promise.prototype.then,s&&(s=s.bind(this)),a&&(a=a.bind(this));var u=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:o.convert(Object.assign({},this),Promise.prototype),f=c.call(u,s,a);return o.convert(f,this.__proto__)},o.prototype.thenExternal=function(s,a){return Promise.prototype.then.call(this,s,a)},o.prototype.thenList=function(s){var a=this;return s.forEach(function(c){a=a.thenCore(c)}),a},o.prototype.catch=function(s){s&&(s=s.bind(this));var a=Promise.prototype.catch.call(this,s);return o.convert(a,this)},o.prototype.catchExternal=function(s){return Promise.prototype.catch.call(this,s)},o.prototype.error=function(s){return this.then(function(){throw new Error(s)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,sr.getPageSize=function(s,a,c){if(rn(s)==="object"){var u=s;s=u.orientation,a=u.unit||a,c=u.format||c}a=a||"mm",c=c||"a4",s=(""+(s||"P")).toLowerCase();var f,y=(""+c).toLowerCase(),v={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(a){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+a}var p,I=0,P=0;if(v.hasOwnProperty(y))I=v[y][1]/f,P=v[y][0]/f;else try{I=c[1],P=c[0]}catch{throw new Error("Invalid format: "+c)}if(s==="p"||s==="portrait")s="p",P>I&&(p=P,P=I,I=p);else{if(s!=="l"&&s!=="landscape")throw"Invalid orientation: "+s;s="l",I>P&&(p=P,P=I,I=p)}return{width:P,height:I,unit:a,k:f,orientation:s}},t.html=function(s,a){(a=a||{}).callback=a.callback||function(){},a.html2canvas=a.html2canvas||{},a.html2canvas.canvas=a.html2canvas.canvas||this.canvas,a.jsPDF=a.jsPDF||this,a.fontFaces=a.fontFaces?a.fontFaces.map(wm):null;var c=new o(a);return a.worker?c:c.from(s).doCallback()}}(sr.API),sr.API.addJS=function(t){return H0=t,this.internal.events.subscribe("postPutResources",function(){Hd=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Hd+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),U0=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+H0+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Hd!==void 0&&U0!==void 0&&this.internal.out("/Names <</JavaScript "+Hd+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),o=0;o<i.length;o++){var s=i[o],a=n.exec(s);if(a!=null){var c=a[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,f=[];for(o=0;o<u;o++){var y=r.internal.newObject();f.push(y);var v=r.internal.getPageInfo(o+1);r.internal.write("<< /D["+v.objId+" 0 R /XYZ null null null]>> endobj")}var p=r.internal.newObject();for(r.internal.write("<< /Names [ "),o=0;o<f.length;o++)r.internal.write("(page_"+(o+1)+")"+f[o]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+p+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,o){var s={title:i,options:o,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<n.children.length;o++){var s=n.children[o];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),o>0&&this.line("/Prev "+this.makeRef(n.children[o-1])),o<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[o+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var a=this.count=this.count_r({count:0},s);if(a>0&&this.line("/Count "+a),s.options&&s.options.pageNumber){var c=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var o=0;o<i.children.length;o++)n.count++,this.count_r(n,i.children[o]);return n.count}}])}(sr.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,i,o,s,a){var c,u=this.decode.DCT_DECODE,f=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(c=function(y){for(var v,p=256*y.charCodeAt(4)+y.charCodeAt(5),I=y.length,P={width:0,height:0,numcomponents:1},w=4;w<I;w+=2){if(w+=p,e.indexOf(y.charCodeAt(w+1))!==-1){v=256*y.charCodeAt(w+5)+y.charCodeAt(w+6),P={width:256*y.charCodeAt(w+7)+y.charCodeAt(w+8),height:v,numcomponents:y.charCodeAt(w+9)};break}p=256*y.charCodeAt(w+2)+y.charCodeAt(w+3)}return P}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;case 3:a=this.color_spaces.DEVICE_RGB}f={data:r,width:c.width,height:c.height,colorSpace:a,bitsPerComponent:8,filter:u,index:n,alias:i}}return f}}(sr.API);var Zl,Wd,W0,G0,Y0,TL=function(){var t,e,r;function n(o){var s,a,c,u,f,y,v,p,I,P,w,x,j,ne;for(this.data=o,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},y=null;;){switch(s=this.readUInt32(),I=function(){var Q,K;for(K=[],Q=0;Q<4;++Q)K.push(String.fromCharCode(this.data[this.pos++]));return K}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(s);break;case"fcTL":y&&this.animation.frames.push(y),this.pos+=4,y={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},f=this.readUInt16(),u=this.readUInt16()||100,y.delay=1e3*f/u,y.disposeOp=this.data[this.pos++],y.blendOp=this.data[this.pos++],y.data=[];break;case"IDAT":case"fdAT":for(I==="fdAT"&&(this.pos+=4,s-=4),o=y?.data||this.imgData,x=0;0<=s?x<s:x>s;0<=s?++x:--x)o.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(s),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((P=c-this.transparency.indexed.length)>0)for(j=0;0<=P?j<P:j>P;0<=P?++j:--j)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(s)[0];break;case 2:this.transparency.rgb=this.read(s)}break;case"tEXt":v=(w=this.read(s)).indexOf(0),p=String.fromCharCode.apply(String,w.slice(0,v)),this.text[p]=String.fromCharCode.apply(String,w.slice(v+1));break;case"IEND":return y&&this.animation.frames.push(y),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=(ne=this.colorType)===4||ne===6,a=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*a,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=s}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(o){var s,a;for(a=[],s=0;0<=o?s<o:s>o;0<=o?++s:--s)a.push(this.data[this.pos++]);return a},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(o){var s=this.pixelBitlength/8,a=new Uint8Array(this.width*this.height*s),c=0,u=this;if(o==null&&(o=this.imgData),o.length===0)return new Uint8Array(0);function f(y,v,p,I){var P,w,x,j,ne,Q,K,Z,k,C,E,M,_,S,b,Y,te,O,D,X,H,F=Math.ceil((u.width-y)/p),ie=Math.ceil((u.height-v)/I),$=u.width==F&&u.height==ie;for(S=s*F,M=$?a:new Uint8Array(S*ie),Q=o.length,_=0,w=0;_<ie&&c<Q;){switch(o[c++]){case 0:for(j=te=0;te<S;j=te+=1)M[w++]=o[c++];break;case 1:for(j=O=0;O<S;j=O+=1)P=o[c++],ne=j<s?0:M[w-s],M[w++]=(P+ne)%256;break;case 2:for(j=D=0;D<S;j=D+=1)P=o[c++],x=(j-j%s)/s,b=_&&M[(_-1)*S+x*s+j%s],M[w++]=(b+P)%256;break;case 3:for(j=X=0;X<S;j=X+=1)P=o[c++],x=(j-j%s)/s,ne=j<s?0:M[w-s],b=_&&M[(_-1)*S+x*s+j%s],M[w++]=(P+Math.floor((ne+b)/2))%256;break;case 4:for(j=H=0;H<S;j=H+=1)P=o[c++],x=(j-j%s)/s,ne=j<s?0:M[w-s],_===0?b=Y=0:(b=M[(_-1)*S+x*s+j%s],Y=x&&M[(_-1)*S+(x-1)*s+j%s]),K=ne+b-Y,Z=Math.abs(K-ne),C=Math.abs(K-b),E=Math.abs(K-Y),k=Z<=C&&Z<=E?ne:C<=E?b:Y,M[w++]=(P+k)%256;break;default:throw new Error("Invalid filter algorithm: "+o[c-1])}if(!$){var L=((v+_*I)*u.width+y)*s,U=_*S;for(j=0;j<F;j+=1){for(var N=0;N<s;N+=1)a[L++]=M[U++];L+=(p-1)*s}}_++}}return o=lL(o),u.interlaceMethod==1?(f(0,0,8,8),f(4,0,8,8),f(0,4,4,8),f(2,0,4,4),f(0,2,2,4),f(1,0,2,2),f(0,1,1,2)):f(0,0,1,1),a},n.prototype.decodePalette=function(){var o,s,a,c,u,f,y,v,p;for(a=this.palette,f=this.transparency.indexed||[],u=new Uint8Array((f.length||0)+a.length),c=0,o=0,s=y=0,v=a.length;y<v;s=y+=3)u[c++]=a[s],u[c++]=a[s+1],u[c++]=a[s+2],u[c++]=(p=f[o++])!=null?p:255;return u},n.prototype.copyToImageData=function(o,s){var a,c,u,f,y,v,p,I,P,w,x;if(c=this.colors,P=null,a=this.hasAlphaChannel,this.palette.length&&(P=(x=this._decodedPalette)!=null?x:this._decodedPalette=this.decodePalette(),c=4,a=!0),I=(u=o.data||o).length,y=P||s,f=v=0,c===1)for(;f<I;)p=P?4*s[f/4]:v,w=y[p++],u[f++]=w,u[f++]=w,u[f++]=w,u[f++]=a?y[p++]:255,v=p;else for(;f<I;)p=P?4*s[f/4]:v,u[f++]=y[p++],u[f++]=y[p++],u[f++]=y[p++],u[f++]=a?y[p++]:255,v=p},n.prototype.decode=function(){var o;return o=new Uint8Array(this.width*this.height*4),this.copyToImageData(o,this.decodePixels()),o};var i=function(){if(Object.prototype.toString.call(lr)==="[object Window]"){try{e=lr.document.createElement("canvas"),r=e.getContext("2d")}catch{return!1}return!0}return!1};return i(),t=function(o){var s;if(i()===!0)return r.width=o.width,r.height=o.height,r.clearRect(0,0,o.width,o.height),r.putImageData(o,0,0),(s=new Image).src=e.toDataURL(),s;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(o){var s,a,c,u,f,y,v,p;if(this.animation){for(p=[],a=f=0,y=(v=this.animation.frames).length;f<y;a=++f)s=v[a],c=o.createImageData(s.width,s.height),u=this.decodePixels(new Uint8Array(s.data)),this.copyToImageData(c,u),s.imageData=c,p.push(s.image=t(c));return p}},n.prototype.renderFrame=function(o,s){var a,c,u;return a=(c=this.animation.frames)[s],u=c[s-1],s===0&&o.clearRect(0,0,this.width,this.height),u?.disposeOp===1?o.clearRect(u.xOffset,u.yOffset,u.width,u.height):u?.disposeOp===2&&o.putImageData(u.imageData,u.xOffset,u.yOffset),a.blendOp===0&&o.clearRect(a.xOffset,a.yOffset,a.width,a.height),o.drawImage(a.image,a.xOffset,a.yOffset)},n.prototype.animate=function(o){var s,a,c,u,f,y,v=this;return a=0,y=this.animation,u=y.numFrames,c=y.frames,f=y.numPlays,(s=function(){var p,I;if(p=a++%u,I=c[p],v.renderFrame(o,p),u>1&&a/u<f)return v.animation._timeout=setTimeout(s,I.delay)})()},n.prototype.stopAnimation=function(){var o;return clearTimeout((o=this.animation)!=null?o._timeout:void 0)},n.prototype.render=function(o){var s,a;return o._png&&o._png.stopAnimation(),o._png=this,o.width=this.width,o.height=this.height,s=o.getContext("2d"),this.animation?(this.decodeFrames(s),this.animate(s)):(a=s.createImageData(this.width,this.height),this.copyToImageData(a,this.decodePixels()),s.putImageData(a,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function NL(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,i=t[e++],o=i>>7,s=1<<(7&i)+1;t[e++],t[e++];var a=null,c=null;o&&(a=e,c=s,e+=3*s);var u=!0,f=[],y=0,v=null,p=0,I=null;for(this.width=r,this.height=n;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,I=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((_=t[e++])>=0))throw Error("Invalid block size");if(_===0)break;e+=_}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var P=t[e++];y=t[e++]|t[e++]<<8,v=t[e++],(1&P)==0&&(v=null),p=P>>2&7,e++;break;case 254:for(;;){if(!((_=t[e++])>=0))throw Error("Invalid block size");if(_===0)break;e+=_}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var w=t[e++]|t[e++]<<8,x=t[e++]|t[e++]<<8,j=t[e++]|t[e++]<<8,ne=t[e++]|t[e++]<<8,Q=t[e++],K=Q>>6&1,Z=1<<(7&Q)+1,k=a,C=c,E=!1;Q>>7&&(E=!0,k=e,C=Z,e+=3*Z);var M=e;for(e++;;){var _;if(!((_=t[e++])>=0))throw Error("Invalid block size");if(_===0)break;e+=_}f.push({x:w,y:x,width:j,height:ne,has_local_palette:E,palette_offset:k,palette_size:C,data_offset:M,data_length:e-M,transparent_index:v,interlaced:!!K,delay:y,disposal:p});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return I},this.frameInfo=function(S){if(S<0||S>=f.length)throw new Error("Frame index out of range.");return f[S]},this.decodeAndBlitFrameBGRA=function(S,b){var Y=this.frameInfo(S),te=Y.width*Y.height,O=new Uint8Array(te);K0(t,Y.data_offset,O,te);var D=Y.palette_offset,X=Y.transparent_index;X===null&&(X=256);var H=Y.width,F=r-H,ie=H,$=4*(Y.y*r+Y.x),L=4*((Y.y+Y.height)*r+Y.x),U=$,N=4*F;Y.interlaced===!0&&(N+=4*r*7);for(var z=8,oe=0,G=O.length;oe<G;++oe){var ee=O[oe];if(ie===0&&(ie=H,(U+=N)>=L&&(N=4*F+4*r*(z-1),U=$+(H+F)*(z<<1),z>>=1)),ee===X)U+=4;else{var J=t[D+3*ee],W=t[D+3*ee+1],q=t[D+3*ee+2];b[U++]=q,b[U++]=W,b[U++]=J,b[U++]=255}--ie}},this.decodeAndBlitFrameRGBA=function(S,b){var Y=this.frameInfo(S),te=Y.width*Y.height,O=new Uint8Array(te);K0(t,Y.data_offset,O,te);var D=Y.palette_offset,X=Y.transparent_index;X===null&&(X=256);var H=Y.width,F=r-H,ie=H,$=4*(Y.y*r+Y.x),L=4*((Y.y+Y.height)*r+Y.x),U=$,N=4*F;Y.interlaced===!0&&(N+=4*r*7);for(var z=8,oe=0,G=O.length;oe<G;++oe){var ee=O[oe];if(ie===0&&(ie=H,(U+=N)>=L&&(N=4*F+4*r*(z-1),U=$+(H+F)*(z<<1),z>>=1)),ee===X)U+=4;else{var J=t[D+3*ee],W=t[D+3*ee+1],q=t[D+3*ee+2];b[U++]=J,b[U++]=W,b[U++]=q,b[U++]=255}--ie}}}function K0(t,e,r,n){for(var i=t[e++],o=1<<i,s=o+1,a=s+1,c=i+1,u=(1<<c)-1,f=0,y=0,v=0,p=t[e++],I=new Int32Array(4096),P=null;;){for(;f<16&&p!==0;)y|=t[e++]<<f,f+=8,p===1?p=t[e++]:--p;if(f<c)break;var w=y&u;if(y>>=c,f-=c,w!==o){if(w===s)break;for(var x=w<a?w:P,j=0,ne=x;ne>o;)ne=I[ne]>>8,++j;var Q=ne;if(v+j+(x!==w?1:0)>n)return void cn.log("Warning, gif stream longer than expected.");r[v++]=Q;var K=v+=j;for(x!==w&&(r[v++]=Q),ne=x;j--;)ne=I[ne],r[--K]=255&ne,ne>>=8;P!==null&&a<4096&&(I[a++]=P<<8|Q,a>=u+1&&c<12&&(++c,u=u<<1|1)),P=w}else a=s+1,u=(1<<(c=i+1))-1,P=null}return v!==n&&cn.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function vp(t){var e,r,n,i,o,s=Math.floor,a=new Array(64),c=new Array(64),u=new Array(64),f=new Array(64),y=new Array(65535),v=new Array(65535),p=new Array(64),I=new Array(64),P=[],w=0,x=7,j=new Array(64),ne=new Array(64),Q=new Array(64),K=new Array(256),Z=new Array(2048),k=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],C=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],E=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],_=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],S=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],b=[0,1,2,3,4,5,6,7,8,9,10,11],Y=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],te=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function O($,L){for(var U=0,N=0,z=new Array,oe=1;oe<=16;oe++){for(var G=1;G<=$[oe];G++)z[L[N]]=[],z[L[N]][0]=U,z[L[N]][1]=oe,N++,U++;U*=2}return z}function D($){for(var L=$[0],U=$[1]-1;U>=0;)L&1<<U&&(w|=1<<x),U--,--x<0&&(w==255?(X(255),X(0)):X(w),x=7,w=0)}function X($){P.push($)}function H($){X($>>8&255),X(255&$)}function F($,L,U,N,z){for(var oe,G=z[0],ee=z[240],J=function(fe,be){var xe,he,ve,De,Ee,Ce,Ne,Ie,Re,We,Fe=0;for(Re=0;Re<8;++Re){xe=fe[Fe],he=fe[Fe+1],ve=fe[Fe+2],De=fe[Fe+3],Ee=fe[Fe+4],Ce=fe[Fe+5],Ne=fe[Fe+6];var Xe=xe+(Ie=fe[Fe+7]),tt=xe-Ie,At=he+Ne,rt=he-Ne,He=ve+Ce,xt=ve-Ce,_t=De+Ee,mt=De-Ee,Et=Xe+_t,et=Xe-_t,qe=At+He,ot=At-He;fe[Fe]=Et+qe,fe[Fe+4]=Et-qe;var Je=.707106781*(ot+et);fe[Fe+2]=et+Je,fe[Fe+6]=et-Je;var at=.382683433*((Et=mt+xt)-(ot=rt+tt)),dt=.5411961*Et+at,It=1.306562965*ot+at,jt=.707106781*(qe=xt+rt),Gt=tt+jt,yt=tt-jt;fe[Fe+5]=yt+dt,fe[Fe+3]=yt-dt,fe[Fe+1]=Gt+It,fe[Fe+7]=Gt-It,Fe+=8}for(Fe=0,Re=0;Re<8;++Re){xe=fe[Fe],he=fe[Fe+8],ve=fe[Fe+16],De=fe[Fe+24],Ee=fe[Fe+32],Ce=fe[Fe+40],Ne=fe[Fe+48];var Qt=xe+(Ie=fe[Fe+56]),Mt=xe-Ie,Kt=he+Ne,Xt=he-Ne,ht=ve+Ce,wt=ve-Ce,Ut=De+Ee,Ze=De-Ee,Vt=Qt+Ut,Ft=Qt-Ut,Jt=Kt+ht,er=Kt-ht;fe[Fe]=Vt+Jt,fe[Fe+32]=Vt-Jt;var gt=.707106781*(er+Ft);fe[Fe+16]=Ft+gt,fe[Fe+48]=Ft-gt;var dr=.382683433*((Vt=Ze+wt)-(er=Xt+Mt)),Er=.5411961*Vt+dr,mr=1.306562965*er+dr,xr=.707106781*(Jt=wt+Xt),Vr=Mt+xr,kt=Mt-xr;fe[Fe+40]=kt+Er,fe[Fe+24]=kt-Er,fe[Fe+8]=Vr+mr,fe[Fe+56]=Vr-mr,Fe++}for(Re=0;Re<64;++Re)We=fe[Re]*be[Re],p[Re]=We>0?We+.5|0:We-.5|0;return p}($,L),W=0;W<64;++W)I[k[W]]=J[W];var q=I[0]-U;U=I[0],q==0?D(N[0]):(D(N[v[oe=32767+q]]),D(y[oe]));for(var ae=63;ae>0&&I[ae]==0;)ae--;if(ae==0)return D(G),U;for(var de,le=1;le<=ae;){for(var V=le;I[le]==0&&le<=ae;)++le;var ce=le-V;if(ce>=16){de=ce>>4;for(var Pe=1;Pe<=de;++Pe)D(ee);ce&=15}oe=32767+I[le],D(z[(ce<<4)+v[oe]]),D(y[oe]),le++}return ae!=63&&D(G),U}function ie($){$=Math.min(Math.max($,1),100),o!=$&&(function(L){for(var U=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],N=0;N<64;N++){var z=s((U[N]*L+50)/100);z=Math.min(Math.max(z,1),255),a[k[N]]=z}for(var oe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],G=0;G<64;G++){var ee=s((oe[G]*L+50)/100);ee=Math.min(Math.max(ee,1),255),c[k[G]]=ee}for(var J=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],W=0,q=0;q<8;q++)for(var ae=0;ae<8;ae++)u[W]=1/(a[k[W]]*J[q]*J[ae]*8),f[W]=1/(c[k[W]]*J[q]*J[ae]*8),W++}($<50?Math.floor(5e3/$):Math.floor(200-2*$)),o=$)}this.encode=function($,L){L&&ie(L),P=new Array,w=0,x=7,H(65496),H(65504),H(16),X(74),X(70),X(73),X(70),X(0),X(1),X(1),X(0),H(1),H(1),X(0),X(0),function(){H(65499),H(132),X(0);for(var he=0;he<64;he++)X(a[he]);X(1);for(var ve=0;ve<64;ve++)X(c[ve])}(),function(he,ve){H(65472),H(17),X(8),H(ve),H(he),X(3),X(1),X(17),X(0),X(2),X(17),X(1),X(3),X(17),X(1)}($.width,$.height),function(){H(65476),H(418),X(0);for(var he=0;he<16;he++)X(C[he+1]);for(var ve=0;ve<=11;ve++)X(E[ve]);X(16);for(var De=0;De<16;De++)X(M[De+1]);for(var Ee=0;Ee<=161;Ee++)X(_[Ee]);X(1);for(var Ce=0;Ce<16;Ce++)X(S[Ce+1]);for(var Ne=0;Ne<=11;Ne++)X(b[Ne]);X(17);for(var Ie=0;Ie<16;Ie++)X(Y[Ie+1]);for(var Re=0;Re<=161;Re++)X(te[Re])}(),H(65498),H(12),X(3),X(1),X(0),X(2),X(17),X(3),X(17),X(0),X(63),X(0);var U=0,N=0,z=0;w=0,x=7,this.encode.displayName="_encode_";for(var oe,G,ee,J,W,q,ae,de,le,V=$.data,ce=$.width,Pe=$.height,fe=4*ce,be=0;be<Pe;){for(oe=0;oe<fe;){for(W=fe*be+oe,ae=-1,de=0,le=0;le<64;le++)q=W+(de=le>>3)*fe+(ae=4*(7&le)),be+de>=Pe&&(q-=fe*(be+1+de-Pe)),oe+ae>=fe&&(q-=oe+ae-fe+4),G=V[q++],ee=V[q++],J=V[q++],j[le]=(Z[G]+Z[ee+256>>0]+Z[J+512>>0]>>16)-128,ne[le]=(Z[G+768>>0]+Z[ee+1024>>0]+Z[J+1280>>0]>>16)-128,Q[le]=(Z[G+1280>>0]+Z[ee+1536>>0]+Z[J+1792>>0]>>16)-128;U=F(j,u,U,e,n),N=F(ne,f,N,r,i),z=F(Q,f,z,r,i),oe+=32}be+=8}if(x>=0){var xe=[];xe[1]=x+1,xe[0]=(1<<x+1)-1,D(xe)}return H(65497),new Uint8Array(P)},t=t||50,function(){for(var $=String.fromCharCode,L=0;L<256;L++)K[L]=$(L)}(),e=O(C,E),r=O(S,b),n=O(M,_),i=O(Y,te),function(){for(var $=1,L=2,U=1;U<=15;U++){for(var N=$;N<L;N++)v[32767+N]=U,y[32767+N]=[],y[32767+N][1]=U,y[32767+N][0]=N;for(var z=-(L-1);z<=-$;z++)v[32767+z]=U,y[32767+z]=[],y[32767+z][1]=U,y[32767+z][0]=L-1+z;$<<=1,L<<=1}}(),function(){for(var $=0;$<256;$++)Z[$]=19595*$,Z[$+256>>0]=38470*$,Z[$+512>>0]=7471*$+32768,Z[$+768>>0]=-11059*$,Z[$+1024>>0]=-21709*$,Z[$+1280>>0]=32768*$+8421375,Z[$+1536>>0]=-27439*$,Z[$+1792>>0]=-5329*$}(),ie(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function ko(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function J0(t){function e(C){if(!C)throw Error("assert :P")}function r(C,E,M){for(var _=0;4>_;_++)if(C[E+_]!=M.charCodeAt(_))return!0;return!1}function n(C,E,M,_,S){for(var b=0;b<S;b++)C[E+b]=M[_+b]}function i(C,E,M,_){for(var S=0;S<_;S++)C[E+S]=M}function o(C){return new Int32Array(C)}function s(C,E){for(var M=[],_=0;_<C;_++)M.push(new E);return M}function a(C,E){var M=[];return function _(S,b,Y){for(var te=Y[b],O=0;O<te&&(S.push(Y.length>b+1?[]:new E),!(Y.length<b+1));O++)_(S[O],b+1,Y)}(M,0,C),M}var c=function(){var C=this;function E(d,g){for(var T=1<<g-1>>>0;d&T;)T>>>=1;return T?(d&T-1)+T:d}function M(d,g,T,re,me){e(!(re%T));do d[g+(re-=T)]=me;while(0<re)}function _(d,g,T,re,me){if(e(2328>=me),512>=me)var ye=o(512);else if((ye=o(me))==null)return 0;return function(ge,we,Ae,ke,Oe,Ye){var Ke,Ue,pt=we,nt=1<<Ae,Be=o(16),je=o(16);for(e(Oe!=0),e(ke!=null),e(ge!=null),e(0<Ae),Ue=0;Ue<Oe;++Ue){if(15<ke[Ue])return 0;++Be[ke[Ue]]}if(Be[0]==Oe)return 0;for(je[1]=0,Ke=1;15>Ke;++Ke){if(Be[Ke]>1<<Ke)return 0;je[Ke+1]=je[Ke]+Be[Ke]}for(Ue=0;Ue<Oe;++Ue)Ke=ke[Ue],0<ke[Ue]&&(Ye[je[Ke]++]=Ue);if(je[15]==1)return(ke=new S).g=0,ke.value=Ye[0],M(ge,pt,1,nt,ke),nt;var ut,St=-1,ft=nt-1,zt=0,Lt=1,or=1,Rt=1<<Ae;for(Ue=0,Ke=1,Oe=2;Ke<=Ae;++Ke,Oe<<=1){if(Lt+=or<<=1,0>(or-=Be[Ke]))return 0;for(;0<Be[Ke];--Be[Ke])(ke=new S).g=Ke,ke.value=Ye[Ue++],M(ge,pt+zt,Oe,Rt,ke),zt=E(zt,Ke)}for(Ke=Ae+1,Oe=2;15>=Ke;++Ke,Oe<<=1){if(Lt+=or<<=1,0>(or-=Be[Ke]))return 0;for(;0<Be[Ke];--Be[Ke]){if(ke=new S,(zt&ft)!=St){for(pt+=Rt,ut=1<<(St=Ke)-Ae;15>St&&!(0>=(ut-=Be[St]));)++St,ut<<=1;nt+=Rt=1<<(ut=St-Ae),ge[we+(St=zt&ft)].g=ut+Ae,ge[we+St].value=pt-we-St}ke.g=Ke-Ae,ke.value=Ye[Ue++],M(ge,pt+(zt>>Ae),Oe,Rt,ke),zt=E(zt,Ke)}}return Lt!=2*je[15]-1?0:nt}(d,g,T,re,me,ye)}function S(){this.value=this.g=0}function b(){this.value=this.g=0}function Y(){this.G=s(5,S),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(ii,b)}function te(d,g,T,re){e(d!=null),e(g!=null),e(2147483648>re),d.Ca=254,d.I=0,d.b=-8,d.Ka=0,d.oa=g,d.pa=T,d.Jd=g,d.Yc=T+re,d.Zc=4<=re?T+re-4+1:T,oe(d)}function O(d,g){for(var T=0;0<g--;)T|=ee(d,128)<<g;return T}function D(d,g){var T=O(d,g);return G(d)?-T:T}function X(d,g,T,re){var me,ye=0;for(e(d!=null),e(g!=null),e(4294967288>re),d.Sb=re,d.Ra=0,d.u=0,d.h=0,4<re&&(re=4),me=0;me<re;++me)ye+=g[T+me]<<8*me;d.Ra=ye,d.bb=re,d.oa=g,d.pa=T}function H(d){for(;8<=d.u&&d.bb<d.Sb;)d.Ra>>>=8,d.Ra+=d.oa[d.pa+d.bb]<<Ol-8>>>0,++d.bb,d.u-=8;U(d)&&(d.h=1,d.u=0)}function F(d,g){if(e(0<=g),!d.h&&g<=Fl){var T=L(d)&Ml[g];return d.u+=g,H(d),T}return d.h=1,d.u=0}function ie(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function $(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function L(d){return d.Ra>>>(d.u&Ol-1)>>>0}function U(d){return e(d.bb<=d.Sb),d.h||d.bb==d.Sb&&d.u>Ol}function N(d,g){d.u=g,d.h=U(d)}function z(d){d.u>=Dc&&(e(d.u>=Dc),H(d))}function oe(d){e(d!=null&&d.oa!=null),d.pa<d.Zc?(d.I=(d.oa[d.pa++]|d.I<<8)>>>0,d.b+=8):(e(d!=null&&d.oa!=null),d.pa<d.Yc?(d.b+=8,d.I=d.oa[d.pa++]|d.I<<8):d.Ka?d.b=0:(d.I<<=8,d.b+=8,d.Ka=1))}function G(d){return O(d,1)}function ee(d,g){var T=d.Ca;0>d.b&&oe(d);var re=d.b,me=T*g>>>8,ye=(d.I>>>re>me)+0;for(ye?(T-=me,d.I-=me+1<<re>>>0):T=me+1,re=T,me=0;256<=re;)me+=8,re>>=8;return re=7^me+Ri[re],d.b-=re,d.Ca=(T<<re)-1,ye}function J(d,g,T){d[g+0]=T>>24&255,d[g+1]=T>>16&255,d[g+2]=T>>8&255,d[g+3]=T>>0&255}function W(d,g){return d[g+0]<<0|d[g+1]<<8}function q(d,g){return W(d,g)|d[g+2]<<16}function ae(d,g){return W(d,g)|W(d,g+2)<<16}function de(d,g){var T=1<<g;return e(d!=null),e(0<g),d.X=o(T),d.X==null?0:(d.Mb=32-g,d.Xa=g,1)}function le(d,g){e(d!=null),e(g!=null),e(d.Xa==g.Xa),n(g.X,0,d.X,0,1<<g.Xa)}function V(){this.X=[],this.Xa=this.Mb=0}function ce(d,g,T,re){e(T!=null),e(re!=null);var me=T[0],ye=re[0];return me==0&&(me=(d*ye+g/2)/g),ye==0&&(ye=(g*me+d/2)/d),0>=me||0>=ye?0:(T[0]=me,re[0]=ye,1)}function Pe(d,g){return d+(1<<g)-1>>>g}function fe(d,g){return((4278255360&d)+(4278255360&g)>>>0&4278255360)+((16711935&d)+(16711935&g)>>>0&16711935)>>>0}function be(d,g){C[g]=function(T,re,me,ye,ge,we,Ae){var ke;for(ke=0;ke<ge;++ke){var Oe=C[d](we[Ae+ke-1],me,ye+ke);we[Ae+ke]=fe(T[re+ke],Oe)}}}function xe(){this.ud=this.hd=this.jd=0}function he(d,g){return((4278124286&(d^g))>>>1)+(d&g)>>>0}function ve(d){return 0<=d&&256>d?d:0>d?0:255<d?255:void 0}function De(d,g){return ve(d+(d-g+.5>>1))}function Ee(d,g,T){return Math.abs(g-T)-Math.abs(d-T)}function Ce(d,g,T,re,me,ye,ge){for(re=ye[ge-1],T=0;T<me;++T)ye[ge+T]=re=fe(d[g+T],re)}function Ne(d,g,T,re,me){var ye;for(ye=0;ye<T;++ye){var ge=d[g+ye],we=ge>>8&255,Ae=16711935&(Ae=(Ae=16711935&ge)+((we<<16)+we));re[me+ye]=(4278255360&ge)+Ae>>>0}}function Ie(d,g){g.jd=d>>0&255,g.hd=d>>8&255,g.ud=d>>16&255}function Re(d,g,T,re,me,ye){var ge;for(ge=0;ge<re;++ge){var we=g[T+ge],Ae=we>>>8,ke=we,Oe=255&(Oe=(Oe=we>>>16)+((d.jd<<24>>24)*(Ae<<24>>24)>>>5));ke=255&(ke=(ke=ke+((d.hd<<24>>24)*(Ae<<24>>24)>>>5))+((d.ud<<24>>24)*(Oe<<24>>24)>>>5)),me[ye+ge]=(4278255360&we)+(Oe<<16)+ke}}function We(d,g,T,re,me){C[g]=function(ye,ge,we,Ae,ke,Oe,Ye,Ke,Ue){for(Ae=Ye;Ae<Ke;++Ae)for(Ye=0;Ye<Ue;++Ye)ke[Oe++]=me(we[re(ye[ge++])])},C[d]=function(ye,ge,we,Ae,ke,Oe,Ye){var Ke=8>>ye.b,Ue=ye.Ea,pt=ye.K[0],nt=ye.w;if(8>Ke)for(ye=(1<<ye.b)-1,nt=(1<<Ke)-1;ge<we;++ge){var Be,je=0;for(Be=0;Be<Ue;++Be)Be&ye||(je=re(Ae[ke++])),Oe[Ye++]=me(pt[je&nt]),je>>=Ke}else C["VP8LMapColor"+T](Ae,ke,pt,nt,Oe,Ye,ge,we,Ue)}}function Fe(d,g,T,re,me){for(T=g+T;g<T;){var ye=d[g++];re[me++]=ye>>16&255,re[me++]=ye>>8&255,re[me++]=ye>>0&255}}function Xe(d,g,T,re,me){for(T=g+T;g<T;){var ye=d[g++];re[me++]=ye>>16&255,re[me++]=ye>>8&255,re[me++]=ye>>0&255,re[me++]=ye>>24&255}}function tt(d,g,T,re,me){for(T=g+T;g<T;){var ye=(ge=d[g++])>>16&240|ge>>12&15,ge=ge>>0&240|ge>>28&15;re[me++]=ye,re[me++]=ge}}function At(d,g,T,re,me){for(T=g+T;g<T;){var ye=(ge=d[g++])>>16&248|ge>>13&7,ge=ge>>5&224|ge>>3&31;re[me++]=ye,re[me++]=ge}}function rt(d,g,T,re,me){for(T=g+T;g<T;){var ye=d[g++];re[me++]=ye>>0&255,re[me++]=ye>>8&255,re[me++]=ye>>16&255}}function He(d,g,T,re,me,ye){if(ye==0)for(T=g+T;g<T;)J(re,((ye=d[g++])[0]>>24|ye[1]>>8&65280|ye[2]<<8&16711680|ye[3]<<24)>>>0),me+=32;else n(re,me,d,g,T)}function xt(d,g){C[g][0]=C[d+"0"],C[g][1]=C[d+"1"],C[g][2]=C[d+"2"],C[g][3]=C[d+"3"],C[g][4]=C[d+"4"],C[g][5]=C[d+"5"],C[g][6]=C[d+"6"],C[g][7]=C[d+"7"],C[g][8]=C[d+"8"],C[g][9]=C[d+"9"],C[g][10]=C[d+"10"],C[g][11]=C[d+"11"],C[g][12]=C[d+"12"],C[g][13]=C[d+"13"],C[g][14]=C[d+"0"],C[g][15]=C[d+"0"]}function _t(d){return d==gf||d==vf||d==dd||d==bf}function mt(){this.eb=[],this.size=this.A=this.fb=0}function Et(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function et(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new mt,this.f.kb=new Et,this.sd=null}function qe(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function ot(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Je(d){return alert("todo:WebPSamplerProcessPlane"),d.T}function at(d,g){var T=d.T,re=g.ba.f.RGBA,me=re.eb,ye=re.fb+d.ka*re.A,ge=uo[g.ba.S],we=d.y,Ae=d.O,ke=d.f,Oe=d.N,Ye=d.ea,Ke=d.W,Ue=g.cc,pt=g.dc,nt=g.Mc,Be=g.Nc,je=d.ka,ut=d.ka+d.T,St=d.U,ft=St+1>>1;for(je==0?ge(we,Ae,null,null,ke,Oe,Ye,Ke,ke,Oe,Ye,Ke,me,ye,null,null,St):(ge(g.ec,g.fc,we,Ae,Ue,pt,nt,Be,ke,Oe,Ye,Ke,me,ye-re.A,me,ye,St),++T);je+2<ut;je+=2)Ue=ke,pt=Oe,nt=Ye,Be=Ke,Oe+=d.Rc,Ke+=d.Rc,ye+=2*re.A,ge(we,(Ae+=2*d.fa)-d.fa,we,Ae,Ue,pt,nt,Be,ke,Oe,Ye,Ke,me,ye-re.A,me,ye,St);return Ae+=d.fa,d.j+ut<d.o?(n(g.ec,g.fc,we,Ae,St),n(g.cc,g.dc,ke,Oe,ft),n(g.Mc,g.Nc,Ye,Ke,ft),T--):1&ut||ge(we,Ae,null,null,ke,Oe,Ye,Ke,ke,Oe,Ye,Ke,me,ye+re.A,null,null,St),T}function dt(d,g,T){var re=d.F,me=[d.J];if(re!=null){var ye=d.U,ge=g.ba.S,we=ge==ud||ge==dd;g=g.ba.f.RGBA;var Ae=[0],ke=d.ka;Ae[0]=d.T,d.Kb&&(ke==0?--Ae[0]:(--ke,me[0]-=d.width),d.j+d.ka+d.T==d.o&&(Ae[0]=d.o-d.j-ke));var Oe=g.eb;ke=g.fb+ke*g.A,d=fn(re,me[0],d.width,ye,Ae,Oe,ke+(we?0:3),g.A),e(T==Ae),d&&_t(ge)&&lo(Oe,ke,we,ye,Ae,g.A)}return 0}function It(d){var g=d.ma,T=g.ba.S,re=11>T,me=T==ld||T==cd||T==ud||T==yf||T==12||_t(T);if(g.memory=null,g.Ib=null,g.Jb=null,g.Nd=null,!Nc(g.Oa,d,me?11:12))return 0;if(me&&_t(T)&&Ct(),d.da)alert("todo:use_scaling");else{if(re){if(g.Ib=Je,d.Kb){if(T=d.U+1>>1,g.memory=o(d.U+2*T),g.memory==null)return 0;g.ec=g.memory,g.fc=0,g.cc=g.ec,g.dc=g.fc+d.U,g.Mc=g.cc,g.Nc=g.dc+T,g.Ib=at,Ct()}}else alert("todo:EmitYUV");me&&(g.Jb=dt,re&&ze())}if(re&&!Jy){for(d=0;256>d;++d)T_[d]=89858*(d-128)+fd>>hd,D_[d]=-22014*(d-128)+fd,L_[d]=-45773*(d-128),N_[d]=113618*(d-128)+fd>>hd;for(d=Vc;d<Sf;++d)g=76283*(d-16)+fd>>hd,R_[d-Vc]=Xr(g,255),M_[d-Vc]=Xr(g+8>>4,15);Jy=1}return 1}function jt(d){var g=d.ma,T=d.U,re=d.T;return e(!(1&d.ka)),0>=T||0>=re?0:(T=g.Ib(d,g),g.Jb!=null&&g.Jb(d,g,T),g.Dc+=T,1)}function Gt(d){d.ma.memory=null}function yt(d,g,T,re){return F(d,8)!=47?0:(g[0]=F(d,14)+1,T[0]=F(d,14)+1,re[0]=F(d,1),F(d,3)!=0?0:!d.h)}function Qt(d,g){if(4>d)return d+1;var T=d-2>>1;return(2+(1&d)<<T)+F(g,T)+1}function Mt(d,g){return 120<g?g-120:1<=(T=((T=g_[g-1])>>4)*d+(8-(15&T)))?T:1;var T}function Kt(d,g,T){var re=L(T),me=d[g+=255&re].g-8;return 0<me&&(N(T,T.u+8),re=L(T),g+=d[g].value,g+=re&(1<<me)-1),N(T,T.u+d[g].g),d[g].value}function Xt(d,g,T){return T.g+=d.g,T.value+=d.value<<g>>>0,e(8>=T.g),d.g}function ht(d,g,T){var re=d.xc;return e((g=re==0?0:d.vc[d.md*(T>>re)+(g>>re)])<d.Wb),d.Ya[g]}function wt(d,g,T,re){var me=d.ab,ye=d.c*g,ge=d.C;g=ge+g;var we=T,Ae=re;for(re=d.Ta,T=d.Ua;0<me--;){var ke=d.gc[me],Oe=ge,Ye=g,Ke=we,Ue=Ae,pt=(Ae=re,we=T,ke.Ea);switch(e(Oe<Ye),e(Ye<=ke.nc),ke.hc){case 2:td(Ke,Ue,(Ye-Oe)*pt,Ae,we);break;case 0:var nt=Oe,Be=Ye,je=Ae,ut=we,St=(Rt=ke).Ea;nt==0&&(pf(Ke,Ue,null,null,1,je,ut),Ce(Ke,Ue+1,0,0,St-1,je,ut+1),Ue+=St,ut+=St,++nt);for(var ft=1<<Rt.b,zt=ft-1,Lt=Pe(St,Rt.b),or=Rt.K,Rt=Rt.w+(nt>>Rt.b)*Lt;nt<Be;){var Yr=or,en=Rt,zr=1;for(Rc(Ke,Ue,je,ut-St,1,je,ut);zr<St;){var Lr=(zr&~zt)+ft;Lr>St&&(Lr=St),(0,Xs[Yr[en++]>>8&15])(Ke,Ue+ +zr,je,ut+zr-St,Lr-zr,je,ut+zr),zr=Lr}Ue+=St,ut+=St,++nt&zt||(Rt+=Lt)}Ye!=ke.nc&&n(Ae,we-pt,Ae,we+(Ye-Oe-1)*pt,pt);break;case 1:for(pt=Ke,Be=Ue,St=(Ke=ke.Ea)-(ut=Ke&~(je=(Ue=1<<ke.b)-1)),nt=Pe(Ke,ke.b),ft=ke.K,ke=ke.w+(Oe>>ke.b)*nt;Oe<Ye;){for(zt=ft,Lt=ke,or=new xe,Rt=Be+ut,Yr=Be+Ke;Be<Rt;)Ie(zt[Lt++],or),Ka(or,pt,Be,Ue,Ae,we),Be+=Ue,we+=Ue;Be<Yr&&(Ie(zt[Lt++],or),Ka(or,pt,Be,St,Ae,we),Be+=St,we+=St),++Oe&je||(ke+=nt)}break;case 3:if(Ke==Ae&&Ue==we&&0<ke.b){for(Be=Ae,Ke=pt=we+(Ye-Oe)*pt-(ut=(Ye-Oe)*Pe(ke.Ea,ke.b)),Ue=Ae,je=we,nt=[],ut=(St=ut)-1;0<=ut;--ut)nt[ut]=Ue[je+ut];for(ut=St-1;0<=ut;--ut)Be[Ke+ut]=nt[ut];oo(ke,Oe,Ye,Ae,pt,Ae,we)}else oo(ke,Oe,Ye,Ke,Ue,Ae,we)}we=re,Ae=T}Ae!=T&&n(re,T,we,Ae,ye)}function Ut(d,g){var T=d.V,re=d.Ba+d.c*d.C,me=g-d.C;if(e(g<=d.l.o),e(16>=me),0<me){var ye=d.l,ge=d.Ta,we=d.Ua,Ae=ye.width;if(wt(d,me,T,re),me=we=[we],e((T=d.C)<(re=g)),e(ye.v<ye.va),re>ye.o&&(re=ye.o),T<ye.j){var ke=ye.j-T;T=ye.j,me[0]+=ke*Ae}if(T>=re?T=0:(me[0]+=4*ye.v,ye.ka=T-ye.j,ye.U=ye.va-ye.v,ye.T=re-T,T=1),T){if(we=we[0],11>(T=d.ca).S){var Oe=T.f.RGBA,Ye=(re=T.S,me=ye.U,ye=ye.T,ke=Oe.eb,Oe.A),Ke=ye;for(Oe=Oe.fb+d.Ma*Oe.A;0<Ke--;){var Ue=ge,pt=we,nt=me,Be=ke,je=Oe;switch(re){case ad:Mi(Ue,pt,nt,Be,je);break;case ld:$i(Ue,pt,nt,Be,je);break;case gf:$i(Ue,pt,nt,Be,je),lo(Be,je,0,nt,1,0);break;case Vy:ms(Ue,pt,nt,Be,je);break;case cd:He(Ue,pt,nt,Be,je,1);break;case vf:He(Ue,pt,nt,Be,je,1),lo(Be,je,0,nt,1,0);break;case ud:He(Ue,pt,nt,Be,je,0);break;case dd:He(Ue,pt,nt,Be,je,0),lo(Be,je,1,nt,1,0);break;case yf:Zs(Ue,pt,nt,Be,je);break;case bf:Zs(Ue,pt,nt,Be,je),hn(Be,je,nt,1,0);break;case zy:ps(Ue,pt,nt,Be,je);break;default:e(0)}we+=Ae,Oe+=Ye}d.Ma+=ye}else alert("todo:EmitRescaledRowsYUVA");e(d.Ma<=T.height)}}d.C=g,e(d.C<=d.i)}function Ze(d){var g;if(0<d.ua)return 0;for(g=0;g<d.Wb;++g){var T=d.Ya[g].G,re=d.Ya[g].H;if(0<T[1][re[1]+0].g||0<T[2][re[2]+0].g||0<T[3][re[3]+0].g)return 0}return 1}function Vt(d,g,T,re,me,ye){if(d.Z!=0){var ge=d.qd,we=d.rd;for(e(na[d.Z]!=null);g<T;++g)na[d.Z](ge,we,re,me,re,me,ye),ge=re,we=me,me+=ye;d.qd=ge,d.rd=we}}function Ft(d,g){var T=d.l.ma,re=T.Z==0||T.Z==1?d.l.j:d.C;if(re=d.C<re?re:d.C,e(g<=d.l.o),g>re){var me=d.l.width,ye=T.ca,ge=T.tb+me*re,we=d.V,Ae=d.Ba+d.c*re,ke=d.gc;e(d.ab==1),e(ke[0].hc==3),rd(ke[0],re,g,we,Ae,ye,ge),Vt(T,re,g,ye,ge,me)}d.C=d.Ma=g}function Jt(d,g,T,re,me,ye,ge){var we=d.$/re,Ae=d.$%re,ke=d.m,Oe=d.s,Ye=T+d.$,Ke=Ye;me=T+re*me;var Ue=T+re*ye,pt=280+Oe.ua,nt=d.Pb?we:16777216,Be=0<Oe.ua?Oe.Wa:null,je=Oe.wc,ut=Ye<Ue?ht(Oe,Ae,we):null;e(d.C<ye),e(Ue<=me);var St=!1;e:for(;;){for(;St||Ye<Ue;){var ft=0;if(we>=nt){var zt=Ye-T;e((nt=d).Pb),nt.wd=nt.m,nt.xd=zt,0<nt.s.ua&&le(nt.s.Wa,nt.s.vb),nt=we+b_}if(Ae&je||(ut=ht(Oe,Ae,we)),e(ut!=null),ut.Qb&&(g[Ye]=ut.qb,St=!0),!St)if(z(ke),ut.jc){ft=ke,zt=g;var Lt=Ye,or=ut.pd[L(ft)&ii-1];e(ut.jc),256>or.g?(N(ft,ft.u+or.g),zt[Lt]=or.value,ft=0):(N(ft,ft.u+or.g-256),e(256<=or.value),ft=or.value),ft==0&&(St=!0)}else ft=Kt(ut.G[0],ut.H[0],ke);if(ke.h)break;if(St||256>ft){if(!St)if(ut.nd)g[Ye]=(ut.qb|ft<<8)>>>0;else{if(z(ke),St=Kt(ut.G[1],ut.H[1],ke),z(ke),zt=Kt(ut.G[2],ut.H[2],ke),Lt=Kt(ut.G[3],ut.H[3],ke),ke.h)break;g[Ye]=(Lt<<24|St<<16|ft<<8|zt)>>>0}if(St=!1,++Ye,++Ae>=re&&(Ae=0,++we,ge!=null&&we<=ye&&!(we%16)&&ge(d,we),Be!=null))for(;Ke<Ye;)ft=g[Ke++],Be.X[(506832829*ft&4294967295)>>>Be.Mb]=ft}else if(280>ft){if(ft=Qt(ft-256,ke),zt=Kt(ut.G[4],ut.H[4],ke),z(ke),zt=Mt(re,zt=Qt(zt,ke)),ke.h)break;if(Ye-T<zt||me-Ye<ft)break e;for(Lt=0;Lt<ft;++Lt)g[Ye+Lt]=g[Ye+Lt-zt];for(Ye+=ft,Ae+=ft;Ae>=re;)Ae-=re,++we,ge!=null&&we<=ye&&!(we%16)&&ge(d,we);if(e(Ye<=me),Ae&je&&(ut=ht(Oe,Ae,we)),Be!=null)for(;Ke<Ye;)ft=g[Ke++],Be.X[(506832829*ft&4294967295)>>>Be.Mb]=ft}else{if(!(ft<pt))break e;for(St=ft-280,e(Be!=null);Ke<Ye;)ft=g[Ke++],Be.X[(506832829*ft&4294967295)>>>Be.Mb]=ft;ft=Ye,e(!(St>>>(zt=Be).Xa)),g[ft]=zt.X[St],St=!0}St||e(ke.h==U(ke))}if(d.Pb&&ke.h&&Ye<me)e(d.m.h),d.a=5,d.m=d.wd,d.$=d.xd,0<d.s.ua&&le(d.s.vb,d.s.Wa);else{if(ke.h)break e;ge?.(d,we>ye?ye:we),d.a=0,d.$=Ye-T}return 1}return d.a=3,0}function er(d){e(d!=null),d.vc=null,d.yc=null,d.Ya=null;var g=d.Wa;g!=null&&(g.X=null),d.vb=null,e(d!=null)}function gt(){var d=new Dl;return d==null?null:(d.a=0,d.xb=Hy,xt("Predictor","VP8LPredictors"),xt("Predictor","VP8LPredictors_C"),xt("PredictorAdd","VP8LPredictorsAdd"),xt("PredictorAdd","VP8LPredictorsAdd_C"),td=Ne,Ka=Re,Mi=Fe,$i=Xe,Zs=tt,ps=At,ms=rt,C.VP8LMapColor32b=Bl,C.VP8LMapColor8b=nd,d)}function dr(d,g,T,re,me){var ye=1,ge=[d],we=[g],Ae=re.m,ke=re.s,Oe=null,Ye=0;e:for(;;){if(T)for(;ye&&F(Ae,1);){var Ke=ge,Ue=we,pt=re,nt=1,Be=pt.m,je=pt.gc[pt.ab],ut=F(Be,2);if(pt.Oc&1<<ut)ye=0;else{switch(pt.Oc|=1<<ut,je.hc=ut,je.Ea=Ke[0],je.nc=Ue[0],je.K=[null],++pt.ab,e(4>=pt.ab),ut){case 0:case 1:je.b=F(Be,3)+2,nt=dr(Pe(je.Ea,je.b),Pe(je.nc,je.b),0,pt,je.K),je.K=je.K[0];break;case 3:var St,ft=F(Be,8)+1,zt=16<ft?0:4<ft?1:2<ft?2:3;if(Ke[0]=Pe(je.Ea,zt),je.b=zt,St=nt=dr(ft,1,0,pt,je.K)){var Lt,or=ft,Rt=je,Yr=1<<(8>>Rt.b),en=o(Yr);if(en==null)St=0;else{var zr=Rt.K[0],Lr=Rt.w;for(en[0]=Rt.K[0][0],Lt=1;Lt<1*or;++Lt)en[Lt]=fe(zr[Lr+Lt],en[Lt-1]);for(;Lt<4*Yr;++Lt)en[Lt]=0;Rt.K[0]=null,Rt.K[0]=en,St=1}}nt=St;break;case 2:break;default:e(0)}ye=nt}}if(ge=ge[0],we=we[0],ye&&F(Ae,1)&&!(ye=1<=(Ye=F(Ae,4))&&11>=Ye)){re.a=3;break e}var ln;if(ln=ye)t:{var nn,Pr,Dn,Fi=re,Rn=ge,Oi=we,tn=Ye,Ji=T,Qi=Fi.m,Yn=Fi.s,oi=[null],Ei=1,ho=0,Ho=v_[tn];r:for(;;){if(Ji&&F(Qi,1)){var Kn=F(Qi,3)+2,bs=Pe(Rn,Kn),el=Pe(Oi,Kn),Ul=bs*el;if(!dr(bs,el,0,Fi,oi))break r;for(oi=oi[0],Yn.xc=Kn,nn=0;nn<Ul;++nn){var ia=oi[nn]>>8&65535;oi[nn]=ia,ia>=Ei&&(Ei=ia+1)}}if(Qi.h)break r;for(Pr=0;5>Pr;++Pr){var Sn=qy[Pr];!Pr&&0<tn&&(Sn+=1<<tn),ho<Sn&&(ho=Sn)}var Pf=s(Ei*Ho,S),Zy=Ei,eg=s(Zy,Y);if(eg==null)var md=null;else e(65536>=Zy),md=eg;var zc=o(ho);if(md==null||zc==null||Pf==null){Fi.a=1;break r}var yd=Pf;for(nn=Dn=0;nn<Ei;++nn){var Co=md[nn],Hl=Co.G,Wl=Co.H,tg=0,gd=1,rg=0;for(Pr=0;5>Pr;++Pr){Sn=qy[Pr],Hl[Pr]=yd,Wl[Pr]=Dn,!Pr&&0<tn&&(Sn+=1<<tn);i:{var vd,xf=Sn,bd=Fi,qc=zc,B_=yd,j_=Dn,Af=0,oa=bd.m,V_=F(oa,1);if(i(qc,0,0,xf),V_){var z_=F(oa,1)+1,q_=F(oa,1),ng=F(oa,q_==0?1:8);qc[ng]=1,z_==2&&(qc[ng=F(oa,8)]=1);var _d=1}else{var ig=o(19),og=F(oa,4)+4;if(19<og){bd.a=3;var wd=0;break i}for(vd=0;vd<og;++vd)ig[y_[vd]]=F(oa,3);var Cf=void 0,Uc=void 0,sg=bd,U_=ig,Sd=xf,ag=qc,If=0,sa=sg.m,lg=8,cg=s(128,S);n:for(;_(cg,0,7,U_,19);){if(F(sa,1)){var H_=2+2*F(sa,3);if((Cf=2+F(sa,H_))>Sd)break n}else Cf=Sd;for(Uc=0;Uc<Sd&&Cf--;){z(sa);var ug=cg[0+(127&L(sa))];N(sa,sa.u+ug.g);var Gl=ug.value;if(16>Gl)ag[Uc++]=Gl,Gl!=0&&(lg=Gl);else{var W_=Gl==16,dg=Gl-16,G_=p_[dg],hg=F(sa,f_[dg])+G_;if(Uc+hg>Sd)break n;for(var Y_=W_?lg:0;0<hg--;)ag[Uc++]=Y_}}If=1;break n}If||(sg.a=3),_d=If}(_d=_d&&!oa.h)&&(Af=_(B_,j_,8,qc,xf)),_d&&Af!=0?wd=Af:(bd.a=3,wd=0)}if(wd==0)break r;if(gd&&m_[Pr]==1&&(gd=yd[Dn].g==0),tg+=yd[Dn].g,Dn+=wd,3>=Pr){var Hc,$f=zc[0];for(Hc=1;Hc<Sn;++Hc)zc[Hc]>$f&&($f=zc[Hc]);rg+=$f}}if(Co.nd=gd,Co.Qb=0,gd&&(Co.qb=(Hl[3][Wl[3]+0].value<<24|Hl[1][Wl[1]+0].value<<16|Hl[2][Wl[2]+0].value)>>>0,tg==0&&256>Hl[0][Wl[0]+0].value&&(Co.Qb=1,Co.qb+=Hl[0][Wl[0]+0].value<<8)),Co.jc=!Co.Qb&&6>rg,Co.jc){var Pd,_s=Co;for(Pd=0;Pd<ii;++Pd){var aa=Pd,la=_s.pd[aa],xd=_s.G[0][_s.H[0]+aa];256<=xd.value?(la.g=xd.g+256,la.value=xd.value):(la.g=0,la.value=0,aa>>=Xt(xd,8,la),aa>>=Xt(_s.G[1][_s.H[1]+aa],16,la),aa>>=Xt(_s.G[2][_s.H[2]+aa],0,la),Xt(_s.G[3][_s.H[3]+aa],24,la))}}}Yn.vc=oi,Yn.Wb=Ei,Yn.Ya=md,Yn.yc=Pf,ln=1;break t}ln=0}if(!(ye=ln)){re.a=3;break e}if(0<Ye){if(ke.ua=1<<Ye,!de(ke.Wa,Ye)){re.a=1,ye=0;break e}}else ke.ua=0;var kf=re,fg=ge,K_=we,Ef=kf.s,Tf=Ef.xc;if(kf.c=fg,kf.i=K_,Ef.md=Pe(fg,Tf),Ef.wc=Tf==0?-1:(1<<Tf)-1,T){re.xb=C_;break e}if((Oe=o(ge*we))==null){re.a=1,ye=0;break e}ye=(ye=Jt(re,Oe,0,ge,we,we,null))&&!Ae.h;break e}return ye?(me!=null?me[0]=Oe:(e(Oe==null),e(T)),re.$=0,T||er(ke)):er(ke),ye}function Er(d,g){var T=d.c*d.i,re=T+g+16*g;return e(d.c<=g),d.V=o(re),d.V==null?(d.Ta=null,d.Ua=0,d.a=1,0):(d.Ta=d.V,d.Ua=d.Ba+T+g,1)}function mr(d,g){var T=d.C,re=g-T,me=d.V,ye=d.Ba+d.c*T;for(e(g<=d.l.o);0<re;){var ge=16<re?16:re,we=d.l.ma,Ae=d.l.width,ke=Ae*ge,Oe=we.ca,Ye=we.tb+Ae*T,Ke=d.Ta,Ue=d.Ua;wt(d,ge,me,ye),Cn(Ke,Ue,Oe,Ye,ke),Vt(we,T,T+ge,Oe,Ye,Ae),re-=ge,me+=ge*d.c,T+=ge}e(T==g),d.C=d.Ma=g}function xr(){this.ub=this.yd=this.td=this.Rb=0}function Vr(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function kt(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function Cr(){this.Yb=function(){var d=[];return function g(T,re,me){for(var ye=me[re],ge=0;ge<ye&&(T.push(me.length>re+1?[]:0),!(me.length<re+1));ge++)g(T[ge],re+1,me)}(d,0,[3,11]),d}()}function $r(){this.jb=o(3),this.Wc=a([4,8],Cr),this.Xc=a([4,17],Cr)}function hr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function yr(){this.ld=this.La=this.dd=this.tc=0}function Ir(){this.Na=this.la=0}function Hr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function rr(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function on(){this.uc=this.M=this.Nb=0,this.wa=Array(new yr),this.Y=0,this.ya=Array(new rr),this.aa=0,this.l=new bn}function vn(){this.y=o(16),this.f=o(8),this.ea=o(8)}function Ln(){this.cb=this.a=0,this.sc="",this.m=new ie,this.Od=new xr,this.Kc=new Vr,this.ed=new hr,this.Qa=new kt,this.Ic=this.$c=this.Aa=0,this.D=new on,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,ie),this.ia=0,this.pb=s(4,Hr),this.Pa=new $r,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new vn),this.Hd=0,this.rb=Array(new Ir),this.sb=0,this.wa=Array(new yr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new rr),this.L=this.aa=0,this.gd=a([4,2],yr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function bn(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function gn(){var d=new Ln;return d!=null&&(d.a=0,d.sc="OK",d.cb=0,d.Xb=0,jc||(jc=Ni)),d}function Br(d,g,T){return d.a==0&&(d.a=g,d.sc=T,d.cb=0),0}function Vn(d,g,T){return 3<=T&&d[g+0]==157&&d[g+1]==1&&d[g+2]==42}function Xn(d,g){if(d==null)return 0;if(d.a=0,d.sc="OK",g==null)return Br(d,2,"null VP8Io passed to VP8GetHeaders()");var T=g.data,re=g.w,me=g.ha;if(4>me)return Br(d,7,"Truncated header.");var ye=T[re+0]|T[re+1]<<8|T[re+2]<<16,ge=d.Od;if(ge.Rb=!(1&ye),ge.td=ye>>1&7,ge.yd=ye>>4&1,ge.ub=ye>>5,3<ge.td)return Br(d,3,"Incorrect keyframe parameters.");if(!ge.yd)return Br(d,4,"Frame not displayable.");re+=3,me-=3;var we=d.Kc;if(ge.Rb){if(7>me)return Br(d,7,"cannot parse picture header");if(!Vn(T,re,me))return Br(d,3,"Bad code word");we.c=16383&(T[re+4]<<8|T[re+3]),we.Td=T[re+4]>>6,we.i=16383&(T[re+6]<<8|T[re+5]),we.Ud=T[re+6]>>6,re+=7,me-=7,d.za=we.c+15>>4,d.Ub=we.i+15>>4,g.width=we.c,g.height=we.i,g.Da=0,g.j=0,g.v=0,g.va=g.width,g.o=g.height,g.da=0,g.ib=g.width,g.hb=g.height,g.U=g.width,g.T=g.height,i((ye=d.Pa).jb,0,255,ye.jb.length),e((ye=d.Qa)!=null),ye.Cb=0,ye.Bb=0,ye.Fb=1,i(ye.Zb,0,0,ye.Zb.length),i(ye.Lb,0,0,ye.Lb)}if(ge.ub>me)return Br(d,7,"bad partition length");te(ye=d.m,T,re,ge.ub),re+=ge.ub,me-=ge.ub,ge.Rb&&(we.Ld=G(ye),we.Kd=G(ye)),we=d.Qa;var Ae,ke=d.Pa;if(e(ye!=null),e(we!=null),we.Cb=G(ye),we.Cb){if(we.Bb=G(ye),G(ye)){for(we.Fb=G(ye),Ae=0;4>Ae;++Ae)we.Zb[Ae]=G(ye)?D(ye,7):0;for(Ae=0;4>Ae;++Ae)we.Lb[Ae]=G(ye)?D(ye,6):0}if(we.Bb)for(Ae=0;3>Ae;++Ae)ke.jb[Ae]=G(ye)?O(ye,8):255}else we.Bb=0;if(ye.Ka)return Br(d,3,"cannot parse segment header");if((we=d.ed).zd=G(ye),we.Tb=O(ye,6),we.wb=O(ye,3),we.Pc=G(ye),we.Pc&&G(ye)){for(ke=0;4>ke;++ke)G(ye)&&(we.vd[ke]=D(ye,6));for(ke=0;4>ke;++ke)G(ye)&&(we.od[ke]=D(ye,6))}if(d.L=we.Tb==0?0:we.zd?1:2,ye.Ka)return Br(d,3,"cannot parse filter header");var Oe=me;if(me=Ae=re,re=Ae+Oe,we=Oe,d.Xb=(1<<O(d.m,2))-1,Oe<3*(ke=d.Xb))T=7;else{for(Ae+=3*ke,we-=3*ke,Oe=0;Oe<ke;++Oe){var Ye=T[me+0]|T[me+1]<<8|T[me+2]<<16;Ye>we&&(Ye=we),te(d.Jc[+Oe],T,Ae,Ye),Ae+=Ye,we-=Ye,me+=3}te(d.Jc[+ke],T,Ae,we),T=Ae<re?0:5}if(T!=0)return Br(d,T,"cannot parse partitions");for(T=O(Ae=d.m,7),me=G(Ae)?D(Ae,4):0,re=G(Ae)?D(Ae,4):0,we=G(Ae)?D(Ae,4):0,ke=G(Ae)?D(Ae,4):0,Ae=G(Ae)?D(Ae,4):0,Oe=d.Qa,Ye=0;4>Ye;++Ye){if(Oe.Cb){var Ke=Oe.Zb[Ye];Oe.Fb||(Ke+=T)}else{if(0<Ye){d.pb[Ye]=d.pb[0];continue}Ke=T}var Ue=d.pb[Ye];Ue.Sc[0]=_f[Xr(Ke+me,127)],Ue.Sc[1]=wf[Xr(Ke+0,127)],Ue.Eb[0]=2*_f[Xr(Ke+re,127)],Ue.Eb[1]=101581*wf[Xr(Ke+we,127)]>>16,8>Ue.Eb[1]&&(Ue.Eb[1]=8),Ue.Qc[0]=_f[Xr(Ke+ke,117)],Ue.Qc[1]=wf[Xr(Ke+Ae,127)],Ue.lc=Ke+Ae}if(!ge.Rb)return Br(d,4,"Not a key frame.");for(G(ye),ge=d.Pa,T=0;4>T;++T){for(me=0;8>me;++me)for(re=0;3>re;++re)for(we=0;11>we;++we)ke=ee(ye,x_[T][me][re][we])?O(ye,8):S_[T][me][re][we],ge.Wc[T][me].Yb[re][we]=ke;for(me=0;17>me;++me)ge.Xc[T][me]=ge.Wc[T][A_[me]]}return d.kc=G(ye),d.kc&&(d.Bd=O(ye,8)),d.cb=1}function Ni(d,g,T,re,me,ye,ge){var we=g[me].Yb[T];for(T=0;16>me;++me){if(!ee(d,we[T+0]))return me;for(;!ee(d,we[T+1]);)if(we=g[++me].Yb[0],T=0,me==16)return 16;var Ae=g[me+1].Yb;if(ee(d,we[T+2])){var ke=d,Oe=0;if(ee(ke,(Ke=we)[(Ye=T)+3]))if(ee(ke,Ke[Ye+6])){for(we=0,Ye=2*(Oe=ee(ke,Ke[Ye+8]))+(Ke=ee(ke,Ke[Ye+9+Oe])),Oe=0,Ke=__[Ye];Ke[we];++we)Oe+=Oe+ee(ke,Ke[we]);Oe+=3+(8<<Ye)}else ee(ke,Ke[Ye+7])?(Oe=7+2*ee(ke,165),Oe+=ee(ke,145)):Oe=5+ee(ke,159);else Oe=ee(ke,Ke[Ye+4])?3+ee(ke,Ke[Ye+5]):2;we=Ae[2]}else Oe=1,we=Ae[1];Ae=ge+w_[me],0>(ke=d).b&&oe(ke);var Ye,Ke=ke.b,Ue=(Ye=ke.Ca>>1)-(ke.I>>Ke)>>31;--ke.b,ke.Ca+=Ue,ke.Ca|=1,ke.I-=(Ye+1&Ue)<<Ke,ye[Ae]=((Oe^Ue)-Ue)*re[(0<me)+0]}return 16}function nr(d){var g=d.rb[d.sb-1];g.la=0,g.Na=0,i(d.zc,0,0,d.zc.length),d.ja=0}function Tr(d,g){if(d==null)return 0;if(g==null)return Br(d,2,"NULL VP8Io parameter in VP8Decode().");if(!d.cb&&!Xn(d,g))return 0;if(e(d.cb),g.ac==null||g.ac(g)){g.ob&&(d.L=0);var T=pd[d.L];if(d.L==2?(d.yb=0,d.zb=0):(d.yb=g.v-T>>4,d.zb=g.j-T>>4,0>d.yb&&(d.yb=0),0>d.zb&&(d.zb=0)),d.Va=g.o+15+T>>4,d.Hb=g.va+15+T>>4,d.Hb>d.za&&(d.Hb=d.za),d.Va>d.Ub&&(d.Va=d.Ub),0<d.L){var re=d.ed;for(T=0;4>T;++T){var me;if(d.Qa.Cb){var ye=d.Qa.Lb[T];d.Qa.Fb||(ye+=re.Tb)}else ye=re.Tb;for(me=0;1>=me;++me){var ge=d.gd[T][me],we=ye;if(re.Pc&&(we+=re.vd[0],me&&(we+=re.od[0])),0<(we=0>we?0:63<we?63:we)){var Ae=we;0<re.wb&&(Ae=4<re.wb?Ae>>2:Ae>>1)>9-re.wb&&(Ae=9-re.wb),1>Ae&&(Ae=1),ge.dd=Ae,ge.tc=2*we+Ae,ge.ld=40<=we?2:15<=we?1:0}else ge.tc=0;ge.La=me}}}T=0}else Br(d,6,"Frame setup failed"),T=d.a;if(T=T==0){if(T){d.$c=0,0<d.Aa||(d.Ic=O_);e:{T=d.Ic,re=4*(Ae=d.za);var ke=32*Ae,Oe=Ae+1,Ye=0<d.L?Ae*(0<d.Aa?2:1):0,Ke=(d.Aa==2?2:1)*Ae;if((ge=re+832+(me=3*(16*T+pd[d.L])/2*ke)+(ye=d.Fa!=null&&0<d.Fa.length?d.Kc.c*d.Kc.i:0))!=ge)T=0;else{if(ge>d.Vb){if(d.Vb=0,d.Ec=o(ge),d.Fc=0,d.Ec==null){T=Br(d,1,"no memory during frame initialization.");break e}d.Vb=ge}ge=d.Ec,we=d.Fc,d.Ac=ge,d.Bc=we,we+=re,d.Gd=s(ke,vn),d.Hd=0,d.rb=s(Oe+1,Ir),d.sb=1,d.wa=Ye?s(Ye,yr):null,d.Y=0,d.D.Nb=0,d.D.wa=d.wa,d.D.Y=d.Y,0<d.Aa&&(d.D.Y+=Ae),e(!0),d.oc=ge,d.pc=we,we+=832,d.ya=s(Ke,rr),d.aa=0,d.D.ya=d.ya,d.D.aa=d.aa,d.Aa==2&&(d.D.aa+=Ae),d.R=16*Ae,d.B=8*Ae,Ae=(ke=pd[d.L])*d.R,ke=ke/2*d.B,d.sa=ge,d.ta=we+Ae,d.qa=d.sa,d.ra=d.ta+16*T*d.R+ke,d.Ha=d.qa,d.Ia=d.ra+8*T*d.B+ke,d.$c=0,we+=me,d.mb=ye?ge:null,d.nb=ye?we:null,e(we+ye<=d.Fc+d.Vb),nr(d),i(d.Ac,d.Bc,0,re),T=1}}if(T){if(g.ka=0,g.y=d.sa,g.O=d.ta,g.f=d.qa,g.N=d.ra,g.ea=d.Ha,g.Vd=d.Ia,g.fa=d.R,g.Rc=d.B,g.F=null,g.J=0,!od){for(T=-255;255>=T;++T)qn[255+T]=0>T?-T:T;for(T=-1020;1020>=T;++T)gs[1020+T]=-128>T?-128:127<T?127:T;for(T=-112;112>=T;++T)Bc[112+T]=-16>T?-16:15<T?15:T;for(T=-255;510>=T;++T)ql[255+T]=0>T?0:255<T?255:T;od=1}jl=wn,ys=Fr,Mc=dn,ki=Sr,so=Gn,An=Wr,Vl=Us,id=So,Fc=Ws,Ja=Ya,Qa=Hs,ea=ds,Xa=Gs,zl=Vo,Za=us,ta=Yi,Oc=zn,ao=Ll,Ao[0]=Di,Ao[1]=Wi,Ao[2]=io,Ao[3]=za,Ao[4]=Vs,Ao[5]=Oo,Ao[6]=Ii,Ao[7]=cs,Ao[8]=zs,Ao[9]=Bo,ra[0]=no,ra[1]=ei,ra[2]=xn,ra[3]=ti,ra[4]=sn,ra[5]=js,ra[6]=bo,vs[0]=wo,vs[1]=hi,vs[2]=Nl,vs[3]=_o,vs[4]=Qr,vs[5]=qa,vs[6]=Ua,T=1}else T=0}T&&(T=function(Ue,pt){for(Ue.M=0;Ue.M<Ue.Va;++Ue.M){var nt,Be=Ue.Jc[Ue.M&Ue.Xb],je=Ue.m,ut=Ue;for(nt=0;nt<ut.za;++nt){var St=je,ft=ut,zt=ft.Ac,Lt=ft.Bc+4*nt,or=ft.zc,Rt=ft.ya[ft.aa+nt];if(ft.Qa.Bb?Rt.$b=ee(St,ft.Pa.jb[0])?2+ee(St,ft.Pa.jb[2]):ee(St,ft.Pa.jb[1]):Rt.$b=0,ft.kc&&(Rt.Ad=ee(St,ft.Bd)),Rt.Za=!ee(St,145)+0,Rt.Za){var Yr=Rt.Ob,en=0;for(ft=0;4>ft;++ft){var zr,Lr=or[0+ft];for(zr=0;4>zr;++zr){Lr=P_[zt[Lt+zr]][Lr];for(var ln=Uy[ee(St,Lr[0])];0<ln;)ln=Uy[2*ln+ee(St,Lr[ln])];Lr=-ln,zt[Lt+zr]=Lr}n(Yr,en,zt,Lt,4),en+=4,or[0+ft]=Lr}}else Lr=ee(St,156)?ee(St,128)?1:3:ee(St,163)?2:0,Rt.Ob[0]=Lr,i(zt,Lt,Lr,4),i(or,0,Lr,4);Rt.Dd=ee(St,142)?ee(St,114)?ee(St,183)?1:3:2:0}if(ut.m.Ka)return Br(Ue,7,"Premature end-of-partition0 encountered.");for(;Ue.ja<Ue.za;++Ue.ja){if(ut=Be,St=(je=Ue).rb[je.sb-1],zt=je.rb[je.sb+je.ja],nt=je.ya[je.aa+je.ja],Lt=je.kc?nt.Ad:0)St.la=zt.la=0,nt.Za||(St.Na=zt.Na=0),nt.Hc=0,nt.Gc=0,nt.ia=0;else{var nn,Pr;if(St=zt,zt=ut,Lt=je.Pa.Xc,or=je.ya[je.aa+je.ja],Rt=je.pb[or.$b],ft=or.ad,Yr=0,en=je.rb[je.sb-1],Lr=zr=0,i(ft,Yr,0,384),or.Za)var Dn=0,Fi=Lt[3];else{ln=o(16);var Rn=St.Na+en.Na;if(Rn=jc(zt,Lt[1],Rn,Rt.Eb,0,ln,0),St.Na=en.Na=(0<Rn)+0,1<Rn)jl(ln,0,ft,Yr);else{var Oi=ln[0]+3>>3;for(ln=0;256>ln;ln+=16)ft[Yr+ln]=Oi}Dn=1,Fi=Lt[0]}var tn=15&St.la,Ji=15&en.la;for(ln=0;4>ln;++ln){var Qi=1&Ji;for(Oi=Pr=0;4>Oi;++Oi)tn=tn>>1|(Qi=(Rn=jc(zt,Fi,Rn=Qi+(1&tn),Rt.Sc,Dn,ft,Yr))>Dn)<<7,Pr=Pr<<2|(3<Rn?3:1<Rn?2:ft[Yr+0]!=0),Yr+=16;tn>>=4,Ji=Ji>>1|Qi<<7,zr=(zr<<8|Pr)>>>0}for(Fi=tn,Dn=Ji>>4,nn=0;4>nn;nn+=2){for(Pr=0,tn=St.la>>4+nn,Ji=en.la>>4+nn,ln=0;2>ln;++ln){for(Qi=1&Ji,Oi=0;2>Oi;++Oi)Rn=Qi+(1&tn),tn=tn>>1|(Qi=0<(Rn=jc(zt,Lt[2],Rn,Rt.Qc,0,ft,Yr)))<<3,Pr=Pr<<2|(3<Rn?3:1<Rn?2:ft[Yr+0]!=0),Yr+=16;tn>>=2,Ji=Ji>>1|Qi<<5}Lr|=Pr<<4*nn,Fi|=tn<<4<<nn,Dn|=(240&Ji)<<nn}St.la=Fi,en.la=Dn,or.Hc=zr,or.Gc=Lr,or.ia=43690&Lr?0:Rt.ia,Lt=!(zr|Lr)}if(0<je.L&&(je.wa[je.Y+je.ja]=je.gd[nt.$b][nt.Za],je.wa[je.Y+je.ja].La|=!Lt),ut.Ka)return Br(Ue,7,"Premature end-of-file encountered.")}if(nr(Ue),je=pt,ut=1,nt=(Be=Ue).D,St=0<Be.L&&Be.M>=Be.zb&&Be.M<=Be.Va,Be.Aa==0)e:{if(nt.M=Be.M,nt.uc=St,qo(Be,nt),ut=1,nt=(Pr=Be.D).Nb,St=(Lr=pd[Be.L])*Be.R,zt=Lr/2*Be.B,ln=16*nt*Be.R,Oi=8*nt*Be.B,Lt=Be.sa,or=Be.ta-St+ln,Rt=Be.qa,ft=Be.ra-zt+Oi,Yr=Be.Ha,en=Be.Ia-zt+Oi,Ji=(tn=Pr.M)==0,zr=tn>=Be.Va-1,Be.Aa==2&&qo(Be,Pr),Pr.uc)for(Qi=(Rn=Be).D.M,e(Rn.D.uc),Pr=Rn.yb;Pr<Rn.Hb;++Pr){Dn=Pr,Fi=Qi;var Yn=(oi=(Sn=Rn).D).Nb;nn=Sn.R;var oi=oi.wa[oi.Y+Dn],Ei=Sn.sa,ho=Sn.ta+16*Yn*nn+16*Dn,Ho=oi.dd,Kn=oi.tc;if(Kn!=0)if(e(3<=Kn),Sn.L==1)0<Dn&&ta(Ei,ho,nn,Kn+4),oi.La&&ao(Ei,ho,nn,Kn),0<Fi&&Za(Ei,ho,nn,Kn+4),oi.La&&Oc(Ei,ho,nn,Kn);else{var bs=Sn.B,el=Sn.qa,Ul=Sn.ra+8*Yn*bs+8*Dn,ia=Sn.Ha,Sn=Sn.Ia+8*Yn*bs+8*Dn;Yn=oi.ld,0<Dn&&(id(Ei,ho,nn,Kn+4,Ho,Yn),Ja(el,Ul,ia,Sn,bs,Kn+4,Ho,Yn)),oi.La&&(ea(Ei,ho,nn,Kn,Ho,Yn),zl(el,Ul,ia,Sn,bs,Kn,Ho,Yn)),0<Fi&&(Vl(Ei,ho,nn,Kn+4,Ho,Yn),Fc(el,Ul,ia,Sn,bs,Kn+4,Ho,Yn)),oi.La&&(Qa(Ei,ho,nn,Kn,Ho,Yn),Xa(el,Ul,ia,Sn,bs,Kn,Ho,Yn))}}if(Be.ia&&alert("todo:DitherRow"),je.put!=null){if(Pr=16*tn,tn=16*(tn+1),Ji?(je.y=Be.sa,je.O=Be.ta+ln,je.f=Be.qa,je.N=Be.ra+Oi,je.ea=Be.Ha,je.W=Be.Ia+Oi):(Pr-=Lr,je.y=Lt,je.O=or,je.f=Rt,je.N=ft,je.ea=Yr,je.W=en),zr||(tn-=Lr),tn>je.o&&(tn=je.o),je.F=null,je.J=null,Be.Fa!=null&&0<Be.Fa.length&&Pr<tn&&(je.J=Qs(Be,je,Pr,tn-Pr),je.F=Be.mb,je.F==null&&je.F.length==0)){ut=Br(Be,3,"Could not decode alpha data.");break e}Pr<je.j&&(Lr=je.j-Pr,Pr=je.j,e(!(1&Lr)),je.O+=Be.R*Lr,je.N+=Be.B*(Lr>>1),je.W+=Be.B*(Lr>>1),je.F!=null&&(je.J+=je.width*Lr)),Pr<tn&&(je.O+=je.v,je.N+=je.v>>1,je.W+=je.v>>1,je.F!=null&&(je.J+=je.v),je.ka=Pr-je.j,je.U=je.va-je.v,je.T=tn-Pr,ut=je.put(je))}nt+1!=Be.Ic||zr||(n(Be.sa,Be.ta-St,Lt,or+16*Be.R,St),n(Be.qa,Be.ra-zt,Rt,ft+8*Be.B,zt),n(Be.Ha,Be.Ia-zt,Yr,en+8*Be.B,zt))}if(!ut)return Br(Ue,6,"Output aborted.")}return 1}(d,g)),g.bc!=null&&g.bc(g),T&=1}return T?(d.cb=0,T):0}function Gr(d,g,T,re,me){me=d[g+T+32*re]+(me>>3),d[g+T+32*re]=-256&me?0>me?0:255:me}function bt(d,g,T,re,me,ye){Gr(d,g,0,T,re+me),Gr(d,g,1,T,re+ye),Gr(d,g,2,T,re-ye),Gr(d,g,3,T,re-me)}function ar(d){return(20091*d>>16)+d}function pr(d,g,T,re){var me,ye=0,ge=o(16);for(me=0;4>me;++me){var we=d[g+0]+d[g+8],Ae=d[g+0]-d[g+8],ke=(35468*d[g+4]>>16)-ar(d[g+12]),Oe=ar(d[g+4])+(35468*d[g+12]>>16);ge[ye+0]=we+Oe,ge[ye+1]=Ae+ke,ge[ye+2]=Ae-ke,ge[ye+3]=we-Oe,ye+=4,g++}for(me=ye=0;4>me;++me)we=(d=ge[ye+0]+4)+ge[ye+8],Ae=d-ge[ye+8],ke=(35468*ge[ye+4]>>16)-ar(ge[ye+12]),Gr(T,re,0,0,we+(Oe=ar(ge[ye+4])+(35468*ge[ye+12]>>16))),Gr(T,re,1,0,Ae+ke),Gr(T,re,2,0,Ae-ke),Gr(T,re,3,0,we-Oe),ye++,re+=32}function Wr(d,g,T,re){var me=d[g+0]+4,ye=35468*d[g+4]>>16,ge=ar(d[g+4]),we=35468*d[g+1]>>16;bt(T,re,0,me+ge,d=ar(d[g+1]),we),bt(T,re,1,me+ye,d,we),bt(T,re,2,me-ye,d,we),bt(T,re,3,me-ge,d,we)}function Fr(d,g,T,re,me){pr(d,g,T,re),me&&pr(d,g+16,T,re+4)}function dn(d,g,T,re){ys(d,g+0,T,re,1),ys(d,g+32,T,re+128,1)}function Sr(d,g,T,re){var me;for(d=d[g+0]+4,me=0;4>me;++me)for(g=0;4>g;++g)Gr(T,re,g,me,d)}function Gn(d,g,T,re){d[g+0]&&ki(d,g+0,T,re),d[g+16]&&ki(d,g+16,T,re+4),d[g+32]&&ki(d,g+32,T,re+128),d[g+48]&&ki(d,g+48,T,re+128+4)}function wn(d,g,T,re){var me,ye=o(16);for(me=0;4>me;++me){var ge=d[g+0+me]+d[g+12+me],we=d[g+4+me]+d[g+8+me],Ae=d[g+4+me]-d[g+8+me],ke=d[g+0+me]-d[g+12+me];ye[0+me]=ge+we,ye[8+me]=ge-we,ye[4+me]=ke+Ae,ye[12+me]=ke-Ae}for(me=0;4>me;++me)ge=(d=ye[0+4*me]+3)+ye[3+4*me],we=ye[1+4*me]+ye[2+4*me],Ae=ye[1+4*me]-ye[2+4*me],ke=d-ye[3+4*me],T[re+0]=ge+we>>3,T[re+16]=ke+Ae>>3,T[re+32]=ge-we>>3,T[re+48]=ke-Ae>>3,re+=64}function Zn(d,g,T){var re,me=g-32,ye=Ki,ge=255-d[me-1];for(re=0;re<T;++re){var we,Ae=ye,ke=ge+d[g-1];for(we=0;we<T;++we)d[g+we]=Ae[ke+d[me+we]];g+=32}}function Wi(d,g){Zn(d,g,4)}function hi(d,g){Zn(d,g,8)}function ei(d,g){Zn(d,g,16)}function xn(d,g){var T;for(T=0;16>T;++T)n(d,g+32*T,d,g-32,16)}function ti(d,g){var T;for(T=16;0<T;--T)i(d,g,d[g-1],16),g+=32}function Li(d,g,T){var re;for(re=0;16>re;++re)i(g,T+32*re,d,16)}function no(d,g){var T,re=16;for(T=0;16>T;++T)re+=d[g-1+32*T]+d[g+T-32];Li(re>>5,d,g)}function sn(d,g){var T,re=8;for(T=0;16>T;++T)re+=d[g-1+32*T];Li(re>>4,d,g)}function js(d,g){var T,re=8;for(T=0;16>T;++T)re+=d[g+T-32];Li(re>>4,d,g)}function bo(d,g){Li(128,d,g)}function ir(d,g,T){return d+2*g+T+2>>2}function io(d,g){var T,re=g-32;for(re=new Uint8Array([ir(d[re-1],d[re+0],d[re+1]),ir(d[re+0],d[re+1],d[re+2]),ir(d[re+1],d[re+2],d[re+3]),ir(d[re+2],d[re+3],d[re+4])]),T=0;4>T;++T)n(d,g+32*T,re,0,re.length)}function za(d,g){var T=d[g-1],re=d[g-1+32],me=d[g-1+64],ye=d[g-1+96];J(d,g+0,16843009*ir(d[g-1-32],T,re)),J(d,g+32,16843009*ir(T,re,me)),J(d,g+64,16843009*ir(re,me,ye)),J(d,g+96,16843009*ir(me,ye,ye))}function Di(d,g){var T,re=4;for(T=0;4>T;++T)re+=d[g+T-32]+d[g-1+32*T];for(re>>=3,T=0;4>T;++T)i(d,g+32*T,re,4)}function Vs(d,g){var T=d[g-1+0],re=d[g-1+32],me=d[g-1+64],ye=d[g-1-32],ge=d[g+0-32],we=d[g+1-32],Ae=d[g+2-32],ke=d[g+3-32];d[g+0+96]=ir(re,me,d[g-1+96]),d[g+1+96]=d[g+0+64]=ir(T,re,me),d[g+2+96]=d[g+1+64]=d[g+0+32]=ir(ye,T,re),d[g+3+96]=d[g+2+64]=d[g+1+32]=d[g+0+0]=ir(ge,ye,T),d[g+3+64]=d[g+2+32]=d[g+1+0]=ir(we,ge,ye),d[g+3+32]=d[g+2+0]=ir(Ae,we,ge),d[g+3+0]=ir(ke,Ae,we)}function Ii(d,g){var T=d[g+1-32],re=d[g+2-32],me=d[g+3-32],ye=d[g+4-32],ge=d[g+5-32],we=d[g+6-32],Ae=d[g+7-32];d[g+0+0]=ir(d[g+0-32],T,re),d[g+1+0]=d[g+0+32]=ir(T,re,me),d[g+2+0]=d[g+1+32]=d[g+0+64]=ir(re,me,ye),d[g+3+0]=d[g+2+32]=d[g+1+64]=d[g+0+96]=ir(me,ye,ge),d[g+3+32]=d[g+2+64]=d[g+1+96]=ir(ye,ge,we),d[g+3+64]=d[g+2+96]=ir(ge,we,Ae),d[g+3+96]=ir(we,Ae,Ae)}function Oo(d,g){var T=d[g-1+0],re=d[g-1+32],me=d[g-1+64],ye=d[g-1-32],ge=d[g+0-32],we=d[g+1-32],Ae=d[g+2-32],ke=d[g+3-32];d[g+0+0]=d[g+1+64]=ye+ge+1>>1,d[g+1+0]=d[g+2+64]=ge+we+1>>1,d[g+2+0]=d[g+3+64]=we+Ae+1>>1,d[g+3+0]=Ae+ke+1>>1,d[g+0+96]=ir(me,re,T),d[g+0+64]=ir(re,T,ye),d[g+0+32]=d[g+1+96]=ir(T,ye,ge),d[g+1+32]=d[g+2+96]=ir(ye,ge,we),d[g+2+32]=d[g+3+96]=ir(ge,we,Ae),d[g+3+32]=ir(we,Ae,ke)}function cs(d,g){var T=d[g+0-32],re=d[g+1-32],me=d[g+2-32],ye=d[g+3-32],ge=d[g+4-32],we=d[g+5-32],Ae=d[g+6-32],ke=d[g+7-32];d[g+0+0]=T+re+1>>1,d[g+1+0]=d[g+0+64]=re+me+1>>1,d[g+2+0]=d[g+1+64]=me+ye+1>>1,d[g+3+0]=d[g+2+64]=ye+ge+1>>1,d[g+0+32]=ir(T,re,me),d[g+1+32]=d[g+0+96]=ir(re,me,ye),d[g+2+32]=d[g+1+96]=ir(me,ye,ge),d[g+3+32]=d[g+2+96]=ir(ye,ge,we),d[g+3+64]=ir(ge,we,Ae),d[g+3+96]=ir(we,Ae,ke)}function Bo(d,g){var T=d[g-1+0],re=d[g-1+32],me=d[g-1+64],ye=d[g-1+96];d[g+0+0]=T+re+1>>1,d[g+2+0]=d[g+0+32]=re+me+1>>1,d[g+2+32]=d[g+0+64]=me+ye+1>>1,d[g+1+0]=ir(T,re,me),d[g+3+0]=d[g+1+32]=ir(re,me,ye),d[g+3+32]=d[g+1+64]=ir(me,ye,ye),d[g+3+64]=d[g+2+64]=d[g+0+96]=d[g+1+96]=d[g+2+96]=d[g+3+96]=ye}function zs(d,g){var T=d[g-1+0],re=d[g-1+32],me=d[g-1+64],ye=d[g-1+96],ge=d[g-1-32],we=d[g+0-32],Ae=d[g+1-32],ke=d[g+2-32];d[g+0+0]=d[g+2+32]=T+ge+1>>1,d[g+0+32]=d[g+2+64]=re+T+1>>1,d[g+0+64]=d[g+2+96]=me+re+1>>1,d[g+0+96]=ye+me+1>>1,d[g+3+0]=ir(we,Ae,ke),d[g+2+0]=ir(ge,we,Ae),d[g+1+0]=d[g+3+32]=ir(T,ge,we),d[g+1+32]=d[g+3+64]=ir(re,T,ge),d[g+1+64]=d[g+3+96]=ir(me,re,T),d[g+1+96]=ir(ye,me,re)}function Nl(d,g){var T;for(T=0;8>T;++T)n(d,g+32*T,d,g-32,8)}function _o(d,g){var T;for(T=0;8>T;++T)i(d,g,d[g-1],8),g+=32}function Gi(d,g,T){var re;for(re=0;8>re;++re)i(g,T+32*re,d,8)}function wo(d,g){var T,re=8;for(T=0;8>T;++T)re+=d[g+T-32]+d[g-1+32*T];Gi(re>>4,d,g)}function qa(d,g){var T,re=4;for(T=0;8>T;++T)re+=d[g+T-32];Gi(re>>3,d,g)}function Qr(d,g){var T,re=4;for(T=0;8>T;++T)re+=d[g-1+32*T];Gi(re>>3,d,g)}function Ua(d,g){Gi(128,d,g)}function qs(d,g,T){var re=d[g-T],me=d[g+0],ye=3*(me-re)+mf[1020+d[g-2*T]-d[g+T]],ge=sd[112+(ye+4>>3)];d[g-T]=Ki[255+re+sd[112+(ye+3>>3)]],d[g+0]=Ki[255+me-ge]}function Ha(d,g,T,re){var me=d[g+0],ye=d[g+T];return co[255+d[g-2*T]-d[g-T]]>re||co[255+ye-me]>re}function Wa(d,g,T,re){return 4*co[255+d[g-T]-d[g+0]]+co[255+d[g-2*T]-d[g+T]]<=re}function Ga(d,g,T,re,me){var ye=d[g-3*T],ge=d[g-2*T],we=d[g-T],Ae=d[g+0],ke=d[g+T],Oe=d[g+2*T],Ye=d[g+3*T];return 4*co[255+we-Ae]+co[255+ge-ke]>re?0:co[255+d[g-4*T]-ye]<=me&&co[255+ye-ge]<=me&&co[255+ge-we]<=me&&co[255+Ye-Oe]<=me&&co[255+Oe-ke]<=me&&co[255+ke-Ae]<=me}function us(d,g,T,re){var me=2*re+1;for(re=0;16>re;++re)Wa(d,g+re,T,me)&&qs(d,g+re,T)}function Yi(d,g,T,re){var me=2*re+1;for(re=0;16>re;++re)Wa(d,g+re*T,1,me)&&qs(d,g+re*T,1)}function zn(d,g,T,re){var me;for(me=3;0<me;--me)us(d,g+=4*T,T,re)}function Ll(d,g,T,re){var me;for(me=3;0<me;--me)Yi(d,g+=4,T,re)}function jo(d,g,T,re,me,ye,ge,we){for(ye=2*ye+1;0<me--;){if(Ga(d,g,T,ye,ge))if(Ha(d,g,T,we))qs(d,g,T);else{var Ae=d,ke=g,Oe=T,Ye=Ae[ke-2*Oe],Ke=Ae[ke-Oe],Ue=Ae[ke+0],pt=Ae[ke+Oe],nt=Ae[ke+2*Oe],Be=27*(ut=mf[1020+3*(Ue-Ke)+mf[1020+Ye-pt]])+63>>7,je=18*ut+63>>7,ut=9*ut+63>>7;Ae[ke-3*Oe]=Ki[255+Ae[ke-3*Oe]+ut],Ae[ke-2*Oe]=Ki[255+Ye+je],Ae[ke-Oe]=Ki[255+Ke+Be],Ae[ke+0]=Ki[255+Ue-Be],Ae[ke+Oe]=Ki[255+pt-je],Ae[ke+2*Oe]=Ki[255+nt-ut]}g+=re}}function ri(d,g,T,re,me,ye,ge,we){for(ye=2*ye+1;0<me--;){if(Ga(d,g,T,ye,ge))if(Ha(d,g,T,we))qs(d,g,T);else{var Ae=d,ke=g,Oe=T,Ye=Ae[ke-Oe],Ke=Ae[ke+0],Ue=Ae[ke+Oe],pt=sd[112+((nt=3*(Ke-Ye))+4>>3)],nt=sd[112+(nt+3>>3)],Be=pt+1>>1;Ae[ke-2*Oe]=Ki[255+Ae[ke-2*Oe]+Be],Ae[ke-Oe]=Ki[255+Ye+nt],Ae[ke+0]=Ki[255+Ke-pt],Ae[ke+Oe]=Ki[255+Ue-Be]}g+=re}}function Us(d,g,T,re,me,ye){jo(d,g,T,1,16,re,me,ye)}function So(d,g,T,re,me,ye){jo(d,g,1,T,16,re,me,ye)}function Hs(d,g,T,re,me,ye){var ge;for(ge=3;0<ge;--ge)ri(d,g+=4*T,T,1,16,re,me,ye)}function ds(d,g,T,re,me,ye){var ge;for(ge=3;0<ge;--ge)ri(d,g+=4,1,T,16,re,me,ye)}function Ws(d,g,T,re,me,ye,ge,we){jo(d,g,me,1,8,ye,ge,we),jo(T,re,me,1,8,ye,ge,we)}function Ya(d,g,T,re,me,ye,ge,we){jo(d,g,1,me,8,ye,ge,we),jo(T,re,1,me,8,ye,ge,we)}function Gs(d,g,T,re,me,ye,ge,we){ri(d,g+4*me,me,1,8,ye,ge,we),ri(T,re+4*me,me,1,8,ye,ge,we)}function Vo(d,g,T,re,me,ye,ge,we){ri(d,g+4,1,me,8,ye,ge,we),ri(T,re+4,1,me,8,ye,ge,we)}function hs(){this.ba=new et,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new ot,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ys(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function fs(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ks(){this.ua=0,this.Wa=new V,this.vb=new V,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new Y,this.yc=new S}function Dl(){this.xb=this.a=0,this.l=new bn,this.ca=new et,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new $,this.Pb=0,this.wd=new $,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ks,this.ab=0,this.gc=s(4,fs),this.Oc=0}function Po(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new bn,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function zo(d,g,T,re,me,ye,ge){for(d=d==null?0:d[g+0],g=0;g<ge;++g)me[ye+g]=d+T[re+g]&255,d=me[ye+g]}function Js(d,g,T,re,me,ye,ge){var we;if(d==null)zo(null,null,T,re,me,ye,ge);else for(we=0;we<ge;++we)me[ye+we]=d[g+we]+T[re+we]&255}function fi(d,g,T,re,me,ye,ge){if(d==null)zo(null,null,T,re,me,ye,ge);else{var we,Ae=d[g+0],ke=Ae,Oe=Ae;for(we=0;we<ge;++we)ke=Oe+(Ae=d[g+we])-ke,Oe=T[re+we]+(-256&ke?0>ke?0:255:ke)&255,ke=Ae,me[ye+we]=Oe}}function Qs(d,g,T,re){var me=g.width,ye=g.o;if(e(d!=null&&g!=null),0>T||0>=re||T+re>ye)return null;if(!d.Cc){if(d.ga==null){var ge;if(d.ga=new Po,(ge=d.ga==null)||(ge=g.width*g.o,e(d.Gb.length==0),d.Gb=o(ge),d.Uc=0,d.Gb==null?ge=0:(d.mb=d.Gb,d.nb=d.Uc,d.rc=null,ge=1),ge=!ge),!ge){ge=d.ga;var we=d.Fa,Ae=d.P,ke=d.qc,Oe=d.mb,Ye=d.nb,Ke=Ae+1,Ue=ke-1,pt=ge.l;if(e(we!=null&&Oe!=null&&g!=null),na[0]=null,na[1]=zo,na[2]=Js,na[3]=fi,ge.ca=Oe,ge.tb=Ye,ge.c=g.width,ge.i=g.height,e(0<ge.c&&0<ge.i),1>=ke)g=0;else if(ge.$a=we[Ae+0]>>0&3,ge.Z=we[Ae+0]>>2&3,ge.Lc=we[Ae+0]>>4&3,Ae=we[Ae+0]>>6&3,0>ge.$a||1<ge.$a||4<=ge.Z||1<ge.Lc||Ae)g=0;else if(pt.put=jt,pt.ac=It,pt.bc=Gt,pt.ma=ge,pt.width=g.width,pt.height=g.height,pt.Da=g.Da,pt.v=g.v,pt.va=g.va,pt.j=g.j,pt.o=g.o,ge.$a)e:{e(ge.$a==1),g=gt();t:for(;;){if(g==null){g=0;break e}if(e(ge!=null),ge.mc=g,g.c=ge.c,g.i=ge.i,g.l=ge.l,g.l.ma=ge,g.l.width=ge.c,g.l.height=ge.i,g.a=0,X(g.m,we,Ke,Ue),!dr(ge.c,ge.i,1,g,null)||(g.ab==1&&g.gc[0].hc==3&&Ze(g.s)?(ge.ic=1,we=g.c*g.i,g.Ta=null,g.Ua=0,g.V=o(we),g.Ba=0,g.V==null?(g.a=1,g=0):g=1):(ge.ic=0,g=Er(g,ge.c)),!g))break t;g=1;break e}ge.mc=null,g=0}else g=Ue>=ge.c*ge.i;ge=!g}if(ge)return null;d.ga.Lc!=1?d.Ga=0:re=ye-T}e(d.ga!=null),e(T+re<=ye);e:{if(g=(we=d.ga).c,ye=we.l.o,we.$a==0){if(Ke=d.rc,Ue=d.Vc,pt=d.Fa,Ae=d.P+1+T*g,ke=d.mb,Oe=d.nb+T*g,e(Ae<=d.P+d.qc),we.Z!=0)for(e(na[we.Z]!=null),ge=0;ge<re;++ge)na[we.Z](Ke,Ue,pt,Ae,ke,Oe,g),Ke=ke,Ue=Oe,Oe+=g,Ae+=g;else for(ge=0;ge<re;++ge)n(ke,Oe,pt,Ae,g),Ke=ke,Ue=Oe,Oe+=g,Ae+=g;d.rc=Ke,d.Vc=Ue}else{if(e(we.mc!=null),g=T+re,e((ge=we.mc)!=null),e(g<=ge.i),ge.C>=g)g=1;else if(we.ic||ze(),we.ic){we=ge.V,Ke=ge.Ba,Ue=ge.c;var nt=ge.i,Be=(pt=1,Ae=ge.$/Ue,ke=ge.$%Ue,Oe=ge.m,Ye=ge.s,ge.$),je=Ue*nt,ut=Ue*g,St=Ye.wc,ft=Be<ut?ht(Ye,ke,Ae):null;e(Be<=je),e(g<=nt),e(Ze(Ye));t:for(;;){for(;!Oe.h&&Be<ut;){if(ke&St||(ft=ht(Ye,ke,Ae)),e(ft!=null),z(Oe),256>(nt=Kt(ft.G[0],ft.H[0],Oe)))we[Ke+Be]=nt,++Be,++ke>=Ue&&(ke=0,++Ae<=g&&!(Ae%16)&&Ft(ge,Ae));else{if(!(280>nt)){pt=0;break t}nt=Qt(nt-256,Oe);var zt,Lt=Kt(ft.G[4],ft.H[4],Oe);if(z(Oe),!(Be>=(Lt=Mt(Ue,Lt=Qt(Lt,Oe)))&&je-Be>=nt)){pt=0;break t}for(zt=0;zt<nt;++zt)we[Ke+Be+zt]=we[Ke+Be+zt-Lt];for(Be+=nt,ke+=nt;ke>=Ue;)ke-=Ue,++Ae<=g&&!(Ae%16)&&Ft(ge,Ae);Be<ut&&ke&St&&(ft=ht(Ye,ke,Ae))}e(Oe.h==U(Oe))}Ft(ge,Ae>g?g:Ae);break t}!pt||Oe.h&&Be<je?(pt=0,ge.a=Oe.h?5:3):ge.$=Be,g=pt}else g=Jt(ge,ge.V,ge.Ba,ge.c,ge.i,g,mr);if(!g){re=0;break e}}T+re>=ye&&(d.Cc=1),re=1}if(!re)return null;if(d.Cc&&((re=d.ga)!=null&&(re.mc=null),d.ga=null,0<d.Ga))return alert("todo:WebPDequantizeLevels"),null}return d.nb+T*me}function A(d,g,T,re,me,ye){for(;0<me--;){var ge,we=d,Ae=g+(T?1:0),ke=d,Oe=g+(T?0:3);for(ge=0;ge<re;++ge){var Ye=ke[Oe+4*ge];Ye!=255&&(Ye*=32897,we[Ae+4*ge+0]=we[Ae+4*ge+0]*Ye>>23,we[Ae+4*ge+1]=we[Ae+4*ge+1]*Ye>>23,we[Ae+4*ge+2]=we[Ae+4*ge+2]*Ye>>23)}g+=ye}}function pe(d,g,T,re,me){for(;0<re--;){var ye;for(ye=0;ye<T;++ye){var ge=d[g+2*ye+0],we=15&(ke=d[g+2*ye+1]),Ae=4369*we,ke=(240&ke|ke>>4)*Ae>>16;d[g+2*ye+0]=(240&ge|ge>>4)*Ae>>16&240|(15&ge|ge<<4)*Ae>>16>>4&15,d[g+2*ye+1]=240&ke|we}g+=me}}function Le(d,g,T,re,me,ye,ge,we){var Ae,ke,Oe=255;for(ke=0;ke<me;++ke){for(Ae=0;Ae<re;++Ae){var Ye=d[g+Ae];ye[ge+4*Ae]=Ye,Oe&=Ye}g+=T,ge+=we}return Oe!=255}function Me(d,g,T,re,me){var ye;for(ye=0;ye<me;++ye)T[re+ye]=d[g+ye]>>8}function ze(){lo=A,hn=pe,fn=Le,Cn=Me}function it(d,g,T){C[d]=function(re,me,ye,ge,we,Ae,ke,Oe,Ye,Ke,Ue,pt,nt,Be,je,ut,St){var ft,zt=St-1>>1,Lt=we[Ae+0]|ke[Oe+0]<<16,or=Ye[Ke+0]|Ue[pt+0]<<16;e(re!=null);var Rt=3*Lt+or+131074>>2;for(g(re[me+0],255&Rt,Rt>>16,nt,Be),ye!=null&&(Rt=3*or+Lt+131074>>2,g(ye[ge+0],255&Rt,Rt>>16,je,ut)),ft=1;ft<=zt;++ft){var Yr=we[Ae+ft]|ke[Oe+ft]<<16,en=Ye[Ke+ft]|Ue[pt+ft]<<16,zr=Lt+Yr+or+en+524296,Lr=zr+2*(Yr+or)>>3;Rt=Lr+Lt>>1,Lt=(zr=zr+2*(Lt+en)>>3)+Yr>>1,g(re[me+2*ft-1],255&Rt,Rt>>16,nt,Be+(2*ft-1)*T),g(re[me+2*ft-0],255&Lt,Lt>>16,nt,Be+(2*ft-0)*T),ye!=null&&(Rt=zr+or>>1,Lt=Lr+en>>1,g(ye[ge+2*ft-1],255&Rt,Rt>>16,je,ut+(2*ft-1)*T),g(ye[ge+2*ft+0],255&Lt,Lt>>16,je,ut+(2*ft+0)*T)),Lt=Yr,or=en}1&St||(Rt=3*Lt+or+131074>>2,g(re[me+St-1],255&Rt,Rt>>16,nt,Be+(St-1)*T),ye!=null&&(Rt=3*or+Lt+131074>>2,g(ye[ge+St-1],255&Rt,Rt>>16,je,ut+(St-1)*T)))}}function Ct(){uo[ad]=I_,uo[ld]=Wy,uo[Vy]=$_,uo[cd]=Gy,uo[ud]=Yy,uo[yf]=Ky,uo[zy]=k_,uo[gf]=Wy,uo[vf]=Gy,uo[dd]=Yy,uo[bf]=Ky}function Dt(d){return d&-16384?0>d?0:255:d>>E_}function h(d,g){return Dt((19077*d>>8)+(26149*g>>8)-14234)}function R(d,g,T){return Dt((19077*d>>8)-(6419*g>>8)-(13320*T>>8)+8708)}function se(d,g){return Dt((19077*d>>8)+(33050*g>>8)-17685)}function _e(d,g,T,re,me){re[me+0]=h(d,T),re[me+1]=R(d,g,T),re[me+2]=se(d,g)}function Ve(d,g,T,re,me){re[me+0]=se(d,g),re[me+1]=R(d,g,T),re[me+2]=h(d,T)}function Qe(d,g,T,re,me){var ye=R(d,g,T);g=ye<<3&224|se(d,g)>>3,re[me+0]=248&h(d,T)|ye>>5,re[me+1]=g}function $t(d,g,T,re,me){var ye=240&se(d,g)|15;re[me+0]=240&h(d,T)|R(d,g,T)>>4,re[me+1]=ye}function vr(d,g,T,re,me){re[me+0]=255,_e(d,g,T,re,me+1)}function Nr(d,g,T,re,me){Ve(d,g,T,re,me),re[me+3]=255}function br(d,g,T,re,me){_e(d,g,T,re,me),re[me+3]=255}function Xr(d,g){return 0>d?0:d>g?g:d}function an(d,g,T){C[d]=function(re,me,ye,ge,we,Ae,ke,Oe,Ye){for(var Ke=Oe+(-2&Ye)*T;Oe!=Ke;)g(re[me+0],ye[ge+0],we[Ae+0],ke,Oe),g(re[me+1],ye[ge+0],we[Ae+0],ke,Oe+T),me+=2,++ge,++Ae,Oe+=2*T;1&Ye&&g(re[me+0],ye[ge+0],we[Ae+0],ke,Oe)}}function xo(d,g,T){return T==0?d==0?g==0?6:5:g==0?4:0:T}function ni(d,g,T,re,me){switch(d>>>30){case 3:ys(g,T,re,me,0);break;case 2:An(g,T,re,me);break;case 1:ki(g,T,re,me)}}function qo(d,g){var T,re,me=g.M,ye=g.Nb,ge=d.oc,we=d.pc+40,Ae=d.oc,ke=d.pc+584,Oe=d.oc,Ye=d.pc+600;for(T=0;16>T;++T)ge[we+32*T-1]=129;for(T=0;8>T;++T)Ae[ke+32*T-1]=129,Oe[Ye+32*T-1]=129;for(0<me?ge[we-1-32]=Ae[ke-1-32]=Oe[Ye-1-32]=129:(i(ge,we-32-1,127,21),i(Ae,ke-32-1,127,9),i(Oe,Ye-32-1,127,9)),re=0;re<d.za;++re){var Ke=g.ya[g.aa+re];if(0<re){for(T=-1;16>T;++T)n(ge,we+32*T-4,ge,we+32*T+12,4);for(T=-1;8>T;++T)n(Ae,ke+32*T-4,Ae,ke+32*T+4,4),n(Oe,Ye+32*T-4,Oe,Ye+32*T+4,4)}var Ue=d.Gd,pt=d.Hd+re,nt=Ke.ad,Be=Ke.Hc;if(0<me&&(n(ge,we-32,Ue[pt].y,0,16),n(Ae,ke-32,Ue[pt].f,0,8),n(Oe,Ye-32,Ue[pt].ea,0,8)),Ke.Za){var je=ge,ut=we-32+16;for(0<me&&(re>=d.za-1?i(je,ut,Ue[pt].y[15],4):n(je,ut,Ue[pt+1].y,0,4)),T=0;4>T;T++)je[ut+128+T]=je[ut+256+T]=je[ut+384+T]=je[ut+0+T];for(T=0;16>T;++T,Be<<=2)je=ge,ut=we+Qy[T],Ao[Ke.Ob[T]](je,ut),ni(Be,nt,16*+T,je,ut)}else if(je=xo(re,me,Ke.Ob[0]),ra[je](ge,we),Be!=0)for(T=0;16>T;++T,Be<<=2)ni(Be,nt,16*+T,ge,we+Qy[T]);for(T=Ke.Gc,je=xo(re,me,Ke.Dd),vs[je](Ae,ke),vs[je](Oe,Ye),Be=nt,je=Ae,ut=ke,255&(Ke=T>>0)&&(170&Ke?Mc(Be,256,je,ut):so(Be,256,je,ut)),Ke=Oe,Be=Ye,255&(T>>=8)&&(170&T?Mc(nt,320,Ke,Be):so(nt,320,Ke,Be)),me<d.Ub-1&&(n(Ue[pt].y,0,ge,we+480,16),n(Ue[pt].f,0,Ae,ke+224,8),n(Ue[pt].ea,0,Oe,Ye+224,8)),T=8*ye*d.B,Ue=d.sa,pt=d.ta+16*re+16*ye*d.R,nt=d.qa,Ke=d.ra+8*re+T,Be=d.Ha,je=d.Ia+8*re+T,T=0;16>T;++T)n(Ue,pt+T*d.R,ge,we+32*T,16);for(T=0;8>T;++T)n(nt,Ke+T*d.B,Ae,ke+32*T,8),n(Be,je+T*d.B,Oe,Ye+32*T,8)}}function Uo(d,g,T,re,me,ye,ge,we,Ae){var ke=[0],Oe=[0],Ye=0,Ke=Ae!=null?Ae.kd:0,Ue=Ae??new Ys;if(d==null||12>T)return 7;Ue.data=d,Ue.w=g,Ue.ha=T,g=[g],T=[T],Ue.gb=[Ue.gb];e:{var pt=g,nt=T,Be=Ue.gb;if(e(d!=null),e(nt!=null),e(Be!=null),Be[0]=0,12<=nt[0]&&!r(d,pt[0],"RIFF")){if(r(d,pt[0]+8,"WEBP")){Be=3;break e}var je=ae(d,pt[0]+4);if(12>je||4294967286<je){Be=3;break e}if(Ke&&je>nt[0]-8){Be=7;break e}Be[0]=je,pt[0]+=12,nt[0]-=12}Be=0}if(Be!=0)return Be;for(je=0<Ue.gb[0],T=T[0];;){e:{var ut=d;nt=g,Be=T;var St=ke,ft=Oe,zt=pt=[0];if((Rt=Ye=[Ye])[0]=0,8>Be[0])Be=7;else{if(!r(ut,nt[0],"VP8X")){if(ae(ut,nt[0]+4)!=10){Be=3;break e}if(18>Be[0]){Be=7;break e}var Lt=ae(ut,nt[0]+8),or=1+q(ut,nt[0]+12);if(2147483648<=or*(ut=1+q(ut,nt[0]+15))){Be=3;break e}zt!=null&&(zt[0]=Lt),St!=null&&(St[0]=or),ft!=null&&(ft[0]=ut),nt[0]+=18,Be[0]-=18,Rt[0]=1}Be=0}}if(Ye=Ye[0],pt=pt[0],Be!=0)return Be;if(nt=!!(2&pt),!je&&Ye)return 3;if(ye!=null&&(ye[0]=!!(16&pt)),ge!=null&&(ge[0]=nt),we!=null&&(we[0]=0),ge=ke[0],pt=Oe[0],Ye&&nt&&Ae==null){Be=0;break}if(4>T){Be=7;break}if(je&&Ye||!je&&!Ye&&!r(d,g[0],"ALPH")){T=[T],Ue.na=[Ue.na],Ue.P=[Ue.P],Ue.Sa=[Ue.Sa];e:{Lt=d,Be=g,je=T;var Rt=Ue.gb;St=Ue.na,ft=Ue.P,zt=Ue.Sa,or=22,e(Lt!=null),e(je!=null),ut=Be[0];var Yr=je[0];for(e(St!=null),e(zt!=null),St[0]=null,ft[0]=null,zt[0]=0;;){if(Be[0]=ut,je[0]=Yr,8>Yr){Be=7;break e}var en=ae(Lt,ut+4);if(4294967286<en){Be=3;break e}var zr=8+en+1&-2;if(or+=zr,0<Rt&&or>Rt){Be=3;break e}if(!r(Lt,ut,"VP8 ")||!r(Lt,ut,"VP8L")){Be=0;break e}if(Yr[0]<zr){Be=7;break e}r(Lt,ut,"ALPH")||(St[0]=Lt,ft[0]=ut+8,zt[0]=en),ut+=zr,Yr-=zr}}if(T=T[0],Ue.na=Ue.na[0],Ue.P=Ue.P[0],Ue.Sa=Ue.Sa[0],Be!=0)break}T=[T],Ue.Ja=[Ue.Ja],Ue.xa=[Ue.xa];e:if(Rt=d,Be=g,je=T,St=Ue.gb[0],ft=Ue.Ja,zt=Ue.xa,Lt=Be[0],ut=!r(Rt,Lt,"VP8 "),or=!r(Rt,Lt,"VP8L"),e(Rt!=null),e(je!=null),e(ft!=null),e(zt!=null),8>je[0])Be=7;else{if(ut||or){if(Rt=ae(Rt,Lt+4),12<=St&&Rt>St-12){Be=3;break e}if(Ke&&Rt>je[0]-8){Be=7;break e}ft[0]=Rt,Be[0]+=8,je[0]-=8,zt[0]=or}else zt[0]=5<=je[0]&&Rt[Lt+0]==47&&!(Rt[Lt+4]>>5),ft[0]=je[0];Be=0}if(T=T[0],Ue.Ja=Ue.Ja[0],Ue.xa=Ue.xa[0],g=g[0],Be!=0)break;if(4294967286<Ue.Ja)return 3;if(we==null||nt||(we[0]=Ue.xa?2:1),ge=[ge],pt=[pt],Ue.xa){if(5>T){Be=7;break}we=ge,Ke=pt,nt=ye,d==null||5>T?d=0:5<=T&&d[g+0]==47&&!(d[g+4]>>5)?(je=[0],Rt=[0],St=[0],X(ft=new $,d,g,T),yt(ft,je,Rt,St)?(we!=null&&(we[0]=je[0]),Ke!=null&&(Ke[0]=Rt[0]),nt!=null&&(nt[0]=St[0]),d=1):d=0):d=0}else{if(10>T){Be=7;break}we=pt,d==null||10>T||!Vn(d,g+3,T-3)?d=0:(Ke=d[g+0]|d[g+1]<<8|d[g+2]<<16,nt=16383&(d[g+7]<<8|d[g+6]),d=16383&(d[g+9]<<8|d[g+8]),1&Ke||3<(Ke>>1&7)||!(Ke>>4&1)||Ke>>5>=Ue.Ja||!nt||!d?d=0:(ge&&(ge[0]=nt),we&&(we[0]=d),d=1))}if(!d||(ge=ge[0],pt=pt[0],Ye&&(ke[0]!=ge||Oe[0]!=pt)))return 3;Ae!=null&&(Ae[0]=Ue,Ae.offset=g-Ae.w,e(4294967286>g-Ae.w),e(Ae.offset==Ae.ha-T));break}return Be==0||Be==7&&Ye&&Ae==null?(ye!=null&&(ye[0]|=Ue.na!=null&&0<Ue.na.length),re!=null&&(re[0]=ge),me!=null&&(me[0]=pt),0):Be}function Nc(d,g,T){var re=g.width,me=g.height,ye=0,ge=0,we=re,Ae=me;if(g.Da=d!=null&&0<d.Da,g.Da&&(we=d.cd,Ae=d.bd,ye=d.v,ge=d.j,11>T||(ye&=-2,ge&=-2),0>ye||0>ge||0>=we||0>=Ae||ye+we>re||ge+Ae>me))return 0;if(g.v=ye,g.j=ge,g.va=ye+we,g.o=ge+Ae,g.U=we,g.T=Ae,g.da=d!=null&&0<d.da,g.da){if(!ce(we,Ae,T=[d.ib],ye=[d.hb]))return 0;g.ib=T[0],g.hb=ye[0]}return g.ob=d!=null&&d.ob,g.Kb=d==null||!d.Sd,g.da&&(g.ob=g.ib<3*re/4&&g.hb<3*me/4,g.Kb=0),1}function Lc(d){if(d==null)return 2;if(11>d.S){var g=d.f.RGBA;g.fb+=(d.height-1)*g.A,g.A=-g.A}else g=d.f.kb,d=d.height,g.O+=(d-1)*g.fa,g.fa=-g.fa,g.N+=(d-1>>1)*g.Ab,g.Ab=-g.Ab,g.W+=(d-1>>1)*g.Db,g.Db=-g.Db,g.F!=null&&(g.J+=(d-1)*g.lb,g.lb=-g.lb);return 0}function Rl(d,g,T,re){if(re==null||0>=d||0>=g)return 2;if(T!=null){if(T.Da){var me=T.cd,ye=T.bd,ge=-2&T.v,we=-2&T.j;if(0>ge||0>we||0>=me||0>=ye||ge+me>d||we+ye>g)return 2;d=me,g=ye}if(T.da){if(!ce(d,g,me=[T.ib],ye=[T.hb]))return 2;d=me[0],g=ye[0]}}re.width=d,re.height=g;e:{var Ae=re.width,ke=re.height;if(d=re.S,0>=Ae||0>=ke||!(d>=ad&&13>d))d=2;else{if(0>=re.Rd&&re.sd==null){ge=ye=me=g=0;var Oe=(we=Ae*Xy[d])*ke;if(11>d||(ye=(ke+1)/2*(g=(Ae+1)/2),d==12&&(ge=(me=Ae)*ke)),(ke=o(Oe+2*ye+ge))==null){d=1;break e}re.sd=ke,11>d?((Ae=re.f.RGBA).eb=ke,Ae.fb=0,Ae.A=we,Ae.size=Oe):((Ae=re.f.kb).y=ke,Ae.O=0,Ae.fa=we,Ae.Fd=Oe,Ae.f=ke,Ae.N=0+Oe,Ae.Ab=g,Ae.Cd=ye,Ae.ea=ke,Ae.W=0+Oe+ye,Ae.Db=g,Ae.Ed=ye,d==12&&(Ae.F=ke,Ae.J=0+Oe+2*ye),Ae.Tc=ge,Ae.lb=me)}if(g=1,me=re.S,ye=re.width,ge=re.height,me>=ad&&13>me)if(11>me)d=re.f.RGBA,g&=(we=Math.abs(d.A))*(ge-1)+ye<=d.size,g&=we>=ye*Xy[me],g&=d.eb!=null;else{d=re.f.kb,we=(ye+1)/2,Oe=(ge+1)/2,Ae=Math.abs(d.fa),ke=Math.abs(d.Ab);var Ye=Math.abs(d.Db),Ke=Math.abs(d.lb),Ue=Ke*(ge-1)+ye;g&=Ae*(ge-1)+ye<=d.Fd,g&=ke*(Oe-1)+we<=d.Cd,g=(g&=Ye*(Oe-1)+we<=d.Ed)&Ae>=ye&ke>=we&Ye>=we,g&=d.y!=null,g&=d.f!=null,g&=d.ea!=null,me==12&&(g&=Ke>=ye,g&=Ue<=d.Tc,g&=d.F!=null)}else g=0;d=g?0:2}}return d!=0||T!=null&&T.fd&&(d=Lc(re)),d}var ii=64,Ml=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Fl=24,Ol=32,Dc=8,Ri=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];be("Predictor0","PredictorAdd0"),C.Predictor0=function(){return 4278190080},C.Predictor1=function(d){return d},C.Predictor2=function(d,g,T){return g[T+0]},C.Predictor3=function(d,g,T){return g[T+1]},C.Predictor4=function(d,g,T){return g[T-1]},C.Predictor5=function(d,g,T){return he(he(d,g[T+1]),g[T+0])},C.Predictor6=function(d,g,T){return he(d,g[T-1])},C.Predictor7=function(d,g,T){return he(d,g[T+0])},C.Predictor8=function(d,g,T){return he(g[T-1],g[T+0])},C.Predictor9=function(d,g,T){return he(g[T+0],g[T+1])},C.Predictor10=function(d,g,T){return he(he(d,g[T-1]),he(g[T+0],g[T+1]))},C.Predictor11=function(d,g,T){var re=g[T+0];return 0>=Ee(re>>24&255,d>>24&255,(g=g[T-1])>>24&255)+Ee(re>>16&255,d>>16&255,g>>16&255)+Ee(re>>8&255,d>>8&255,g>>8&255)+Ee(255&re,255&d,255&g)?re:d},C.Predictor12=function(d,g,T){var re=g[T+0];return(ve((d>>24&255)+(re>>24&255)-((g=g[T-1])>>24&255))<<24|ve((d>>16&255)+(re>>16&255)-(g>>16&255))<<16|ve((d>>8&255)+(re>>8&255)-(g>>8&255))<<8|ve((255&d)+(255&re)-(255&g)))>>>0},C.Predictor13=function(d,g,T){var re=g[T-1];return(De((d=he(d,g[T+0]))>>24&255,re>>24&255)<<24|De(d>>16&255,re>>16&255)<<16|De(d>>8&255,re>>8&255)<<8|De(d>>0&255,re>>0&255))>>>0};var pf=C.PredictorAdd0;C.PredictorAdd1=Ce,be("Predictor2","PredictorAdd2"),be("Predictor3","PredictorAdd3"),be("Predictor4","PredictorAdd4"),be("Predictor5","PredictorAdd5"),be("Predictor6","PredictorAdd6"),be("Predictor7","PredictorAdd7"),be("Predictor8","PredictorAdd8"),be("Predictor9","PredictorAdd9"),be("Predictor10","PredictorAdd10"),be("Predictor11","PredictorAdd11"),be("Predictor12","PredictorAdd12"),be("Predictor13","PredictorAdd13");var Rc=C.PredictorAdd2;We("ColorIndexInverseTransform","MapARGB","32b",function(d){return d>>8&255},function(d){return d}),We("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(d){return d},function(d){return d>>8&255});var td,oo=C.ColorIndexInverseTransform,Bl=C.MapARGB,rd=C.VP8LColorIndexInverseTransformAlpha,nd=C.MapAlpha,Xs=C.VP8LPredictorsAdd=[];Xs.length=16,(C.VP8LPredictors=[]).length=16,(C.VP8LPredictorsAdd_C=[]).length=16,(C.VP8LPredictors_C=[]).length=16;var Ka,Mi,$i,Zs,ps,ms,jl,ys,An,Mc,ki,so,Vl,id,Fc,Ja,Qa,ea,Xa,zl,Za,ta,Oc,ao,lo,hn,fn,Cn,qn=o(511),gs=o(2041),Bc=o(225),ql=o(767),od=0,mf=gs,sd=Bc,Ki=ql,co=qn,ad=0,ld=1,Vy=2,cd=3,ud=4,yf=5,zy=6,gf=7,vf=8,dd=9,bf=10,f_=[2,3,7],p_=[3,3,11],qy=[280,256,256,256,40],m_=[0,1,1,1,0],y_=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],g_=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],v_=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],b_=8,_f=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],wf=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],jc=null,__=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],w_=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Uy=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],S_=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],P_=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],x_=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],A_=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ra=[],Ao=[],vs=[],C_=1,Hy=2,na=[],uo=[];it("UpsampleRgbLinePair",_e,3),it("UpsampleBgrLinePair",Ve,3),it("UpsampleRgbaLinePair",br,4),it("UpsampleBgraLinePair",Nr,4),it("UpsampleArgbLinePair",vr,4),it("UpsampleRgba4444LinePair",$t,2),it("UpsampleRgb565LinePair",Qe,2);var I_=C.UpsampleRgbLinePair,$_=C.UpsampleBgrLinePair,Wy=C.UpsampleRgbaLinePair,Gy=C.UpsampleBgraLinePair,Yy=C.UpsampleArgbLinePair,Ky=C.UpsampleRgba4444LinePair,k_=C.UpsampleRgb565LinePair,hd=16,fd=1<<hd-1,Vc=-227,Sf=482,E_=6,Jy=0,T_=o(256),N_=o(256),L_=o(256),D_=o(256),R_=o(Sf-Vc),M_=o(Sf-Vc);an("YuvToRgbRow",_e,3),an("YuvToBgrRow",Ve,3),an("YuvToRgbaRow",br,4),an("YuvToBgraRow",Nr,4),an("YuvToArgbRow",vr,4),an("YuvToRgba4444Row",$t,2),an("YuvToRgb565Row",Qe,2);var Qy=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],pd=[0,2,8],F_=[8,7,6,4,4,2,2,2,1,1,1,1],O_=1;this.WebPDecodeRGBA=function(d,g,T,re,me){var ye=ld,ge=new hs,we=new et;ge.ba=we,we.S=ye,we.width=[we.width],we.height=[we.height];var Ae=we.width,ke=we.height,Oe=new qe;if(Oe==null||d==null)var Ye=2;else e(Oe!=null),Ye=Uo(d,g,T,Oe.width,Oe.height,Oe.Pd,Oe.Qd,Oe.format,null);if(Ye!=0?Ae=0:(Ae!=null&&(Ae[0]=Oe.width[0]),ke!=null&&(ke[0]=Oe.height[0]),Ae=1),Ae){we.width=we.width[0],we.height=we.height[0],re!=null&&(re[0]=we.width),me!=null&&(me[0]=we.height);e:{if(re=new bn,(me=new Ys).data=d,me.w=g,me.ha=T,me.kd=1,g=[0],e(me!=null),((d=Uo(me.data,me.w,me.ha,null,null,null,g,null,me))==0||d==7)&&g[0]&&(d=4),(g=d)==0){if(e(ge!=null),re.data=me.data,re.w=me.w+me.offset,re.ha=me.ha-me.offset,re.put=jt,re.ac=It,re.bc=Gt,re.ma=ge,me.xa){if((d=gt())==null){ge=1;break e}if(function(Ke,Ue){var pt=[0],nt=[0],Be=[0];t:for(;;){if(Ke==null)return 0;if(Ue==null)return Ke.a=2,0;if(Ke.l=Ue,Ke.a=0,X(Ke.m,Ue.data,Ue.w,Ue.ha),!yt(Ke.m,pt,nt,Be)){Ke.a=3;break t}if(Ke.xb=Hy,Ue.width=pt[0],Ue.height=nt[0],!dr(pt[0],nt[0],1,Ke,null))break t;return 1}return e(Ke.a!=0),0}(d,re)){if(re=(g=Rl(re.width,re.height,ge.Oa,ge.ba))==0){t:{re=d;r:for(;;){if(re==null){re=0;break t}if(e(re.s.yc!=null),e(re.s.Ya!=null),e(0<re.s.Wb),e((T=re.l)!=null),e((me=T.ma)!=null),re.xb!=0){if(re.ca=me.ba,re.tb=me.tb,e(re.ca!=null),!Nc(me.Oa,T,cd)){re.a=2;break r}if(!Er(re,T.width)||T.da)break r;if((T.da||_t(re.ca.S))&&ze(),11>re.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),re.ca.f.kb.F!=null&&ze()),re.Pb&&0<re.s.ua&&re.s.vb.X==null&&!de(re.s.vb,re.s.Wa.Xa)){re.a=1;break r}re.xb=0}if(!Jt(re,re.V,re.Ba,re.c,re.i,T.o,Ut))break r;me.Dc=re.Ma,re=1;break t}e(re.a!=0),re=0}re=!re}re&&(g=d.a)}else g=d.a}else{if((d=new gn)==null){ge=1;break e}if(d.Fa=me.na,d.P=me.P,d.qc=me.Sa,Xn(d,re)){if((g=Rl(re.width,re.height,ge.Oa,ge.ba))==0){if(d.Aa=0,T=ge.Oa,e((me=d)!=null),T!=null){if(0<(Ae=0>(Ae=T.Md)?0:100<Ae?255:255*Ae/100)){for(ke=Oe=0;4>ke;++ke)12>(Ye=me.pb[ke]).lc&&(Ye.ia=Ae*F_[0>Ye.lc?0:Ye.lc]>>3),Oe|=Ye.ia;Oe&&(alert("todo:VP8InitRandom"),me.ia=1)}me.Ga=T.Id,100<me.Ga?me.Ga=100:0>me.Ga&&(me.Ga=0)}Tr(d,re)||(g=d.a)}}else g=d.a}g==0&&ge.Oa!=null&&ge.Oa.fd&&(g=Lc(ge.ba))}ge=g}ye=ge!=0?null:11>ye?we.f.RGBA.eb:we.f.kb.y}else ye=null;return ye};var Xy=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(C,E){for(var M="",_=0;_<4;_++)M+=String.fromCharCode(C[E++]);return M}function f(C,E){return(C[E+0]<<0|C[E+1]<<8|C[E+2]<<16)>>>0}function y(C,E){return(C[E+0]<<0|C[E+1]<<8|C[E+2]<<16|C[E+3]<<24)>>>0}new c;var v=[0],p=[0],I=[],P=new c,w=t,x=function(C,E){var M={},_=0,S=!1,b=0,Y=0;if(M.frames=[],!function(L,U,N,z){for(var oe=0;oe<z;oe++)if(L[U+oe]!=N.charCodeAt(oe))return!0;return!1}(C,E,"RIFF",4)){for(y(C,E+=4),E+=8;E<C.length;){var te=u(C,E),O=y(C,E+=4);E+=4;var D=O+(1&O);switch(te){case"VP8 ":case"VP8L":M.frames[_]===void 0&&(M.frames[_]={}),(F=M.frames[_]).src_off=S?Y:E-8,F.src_size=b+O+8,_++,S&&(S=!1,b=0,Y=0);break;case"VP8X":(F=M.header={}).feature_flags=C[E];var X=E+4;F.canvas_width=1+f(C,X),X+=3,F.canvas_height=1+f(C,X),X+=3;break;case"ALPH":S=!0,b=D+8,Y=E-8;break;case"ANIM":(F=M.header).bgcolor=y(C,E),X=E+4,F.loop_count=(ie=C)[($=X)+0]<<0|ie[$+1]<<8,X+=2;break;case"ANMF":var H,F;(F=M.frames[_]={}).offset_x=2*f(C,E),E+=3,F.offset_y=2*f(C,E),E+=3,F.width=1+f(C,E),E+=3,F.height=1+f(C,E),E+=3,F.duration=f(C,E),E+=3,H=C[E++],F.dispose=1&H,F.blend=H>>1&1}te!="ANMF"&&(E+=D)}var ie,$;return M}}(w,0);x.response=w,x.rgbaoutput=!0,x.dataurl=!1;var j=x.header?x.header:null,ne=x.frames?x.frames:null;if(j){j.loop_counter=j.loop_count,v=[j.canvas_height],p=[j.canvas_width];for(var Q=0;Q<ne.length&&ne[Q].blend!=0;Q++);}var K=ne[0],Z=P.WebPDecodeRGBA(w,K.src_off,K.src_size,p,v);K.rgba=Z,K.imgwidth=p[0],K.imgheight=v[0];for(var k=0;k<p[0]*v[0]*4;k++)I[k]=Z[k];return this.width=p,this.height=v,this.data=I,this}(function(t){var e=function(){return typeof mm=="function"},r=function(v,p,I,P){var w=4,x=s;switch(P){case t.image_compression.FAST:w=1,x=o;break;case t.image_compression.MEDIUM:w=6,x=a;break;case t.image_compression.SLOW:w=9,x=c}v=n(v,p,I,x);var j=mm(v,{level:w});return t.__addimage__.arrayBufferToBinaryString(j)},n=function(v,p,I,P){for(var w,x,j,ne=v.length/p,Q=new Uint8Array(v.length+ne),K=f(),Z=0;Z<ne;Z+=1){if(j=Z*p,w=v.subarray(j,j+p),P)Q.set(P(w,I,x),j+Z);else{for(var k,C=K.length,E=[];k<C;k+=1)E[k]=K[k](w,I,x);var M=y(E.concat());Q.set(E[M],j+Z)}x=w}return Q},i=function(v){var p=Array.apply([],v);return p.unshift(0),p},o=function(v,p){var I,P=[],w=v.length;P[0]=1;for(var x=0;x<w;x+=1)I=v[x-p]||0,P[x+1]=v[x]-I+256&255;return P},s=function(v,p,I){var P,w=[],x=v.length;w[0]=2;for(var j=0;j<x;j+=1)P=I&&I[j]||0,w[j+1]=v[j]-P+256&255;return w},a=function(v,p,I){var P,w,x=[],j=v.length;x[0]=3;for(var ne=0;ne<j;ne+=1)P=v[ne-p]||0,w=I&&I[ne]||0,x[ne+1]=v[ne]+256-(P+w>>>1)&255;return x},c=function(v,p,I){var P,w,x,j,ne=[],Q=v.length;ne[0]=4;for(var K=0;K<Q;K+=1)P=v[K-p]||0,w=I&&I[K]||0,x=I&&I[K-p]||0,j=u(P,w,x),ne[K+1]=v[K]-j+256&255;return ne},u=function(v,p,I){if(v===p&&p===I)return v;var P=Math.abs(p-I),w=Math.abs(v-I),x=Math.abs(v+p-I-I);return P<=w&&P<=x?v:w<=x?p:I},f=function(){return[i,o,s,a,c]},y=function(v){var p=v.map(function(I){return I.reduce(function(P,w){return P+Math.abs(w)},0)});return p.indexOf(Math.min.apply(null,p))};t.processPNG=function(v,p,I,P){var w,x,j,ne,Q,K,Z,k,C,E,M,_,S,b,Y,te=this.decode.FLATE_DECODE,O="";if(this.__addimage__.isArrayBuffer(v)&&(v=new Uint8Array(v)),this.__addimage__.isArrayBufferView(v)){if(v=(j=new TL(v)).imgData,x=j.bits,w=j.colorSpace,Q=j.colors,[4,6].indexOf(j.colorType)!==-1){if(j.bits===8){C=(k=j.pixelBitlength==32?new Uint32Array(j.decodePixels().buffer):j.pixelBitlength==16?new Uint16Array(j.decodePixels().buffer):new Uint8Array(j.decodePixels().buffer)).length,M=new Uint8Array(C*j.colors),E=new Uint8Array(C);var D,X=j.pixelBitlength-j.bits;for(b=0,Y=0;b<C;b++){for(S=k[b],D=0;D<X;)M[Y++]=S>>>D&255,D+=j.bits;E[b]=S>>>D&255}}if(j.bits===16){C=(k=new Uint32Array(j.decodePixels().buffer)).length,M=new Uint8Array(C*(32/j.pixelBitlength)*j.colors),E=new Uint8Array(C*(32/j.pixelBitlength)),_=j.colors>1,b=0,Y=0;for(var H=0;b<C;)S=k[b++],M[Y++]=S>>>0&255,_&&(M[Y++]=S>>>16&255,S=k[b++],M[Y++]=S>>>0&255),E[H++]=S>>>16&255;x=8}P!==t.image_compression.NONE&&e()?(v=r(M,j.width*j.colors,j.colors,P),Z=r(E,j.width,1,P)):(v=M,Z=E,te=void 0)}if(j.colorType===3&&(w=this.color_spaces.INDEXED,K=j.palette,j.transparency.indexed)){var F=j.transparency.indexed,ie=0;for(b=0,C=F.length;b<C;++b)ie+=F[b];if((ie/=255)===C-1&&F.indexOf(0)!==-1)ne=[F.indexOf(0)];else if(ie!==C){for(k=j.decodePixels(),E=new Uint8Array(k.length),b=0,C=k.length;b<C;b++)E[b]=F[k[b]];Z=r(E,j.width,1)}}var $=function(L){var U;switch(L){case t.image_compression.FAST:U=11;break;case t.image_compression.MEDIUM:U=13;break;case t.image_compression.SLOW:U=14;break;default:U=12}return U}(P);return te===this.decode.FLATE_DECODE&&(O="/Predictor "+$+" "),O+="/Colors "+Q+" /BitsPerComponent "+x+" /Columns "+j.width,(this.__addimage__.isArrayBuffer(v)||this.__addimage__.isArrayBufferView(v))&&(v=this.__addimage__.arrayBufferToBinaryString(v)),(Z&&this.__addimage__.isArrayBuffer(Z)||this.__addimage__.isArrayBufferView(Z))&&(Z=this.__addimage__.arrayBufferToBinaryString(Z)),{alias:I,data:v,index:p,filter:te,decodeParameters:O,transparency:ne,palette:K,sMask:Z,predictor:$,width:j.width,height:j.height,bitsPerComponent:x,colorSpace:w}}}})(sr.API),function(t){t.processGIF89A=function(e,r,n,i){var o=new NL(e),s=o.width,a=o.height,c=[];o.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:s,height:a},f=new vp(100).encode(u,100);return t.processJPEG.call(this,f,r,n,i)},t.processGIF87A=t.processGIF89A}(sr.API),ko.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:n,blue:r,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},ko.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){cn.log("bit decode error:"+r)}},ko.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var o=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*i*4,a=0;a<8&&8*i+a<this.width;a++){var c=this.palette[o>>7-a&1];this.data[s+4*a]=c.blue,this.data[s+4*a+1]=c.green,this.data[s+4*a+2]=c.red,this.data[s+4*a+3]=255}r!==0&&(this.pos+=4-r)}},ko.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<t;i++){var o=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*i*4,a=o>>4,c=15&o,u=this.palette[a];if(this.data[s]=u.blue,this.data[s+1]=u.green,this.data[s+2]=u.red,this.data[s+3]=255,2*i+1>=this.width)break;u=this.palette[c],this.data[s+4]=u.blue,this.data[s+4+1]=u.green,this.data[s+4+2]=u.red,this.data[s+4+3]=255}e!==0&&(this.pos+=4-e)}},ko.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+4*n;if(i<this.palette.length){var s=this.palette[i];this.data[o]=s.red,this.data[o+1]=s.green,this.data[o+2]=s.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}t!==0&&(this.pos+=4-t)}},ko.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(o&e)/e*255|0,a=(o>>5&e)/e*255|0,c=(o>>10&e)/e*255|0,u=o>>15?255:0,f=n*this.width*4+4*i;this.data[f]=c,this.data[f+1]=a,this.data[f+2]=s,this.data[f+3]=u}this.pos+=t}},ko.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&e)/e*255|0,c=(s>>5&r)/r*255|0,u=(s>>11)/e*255|0,f=i*this.width*4+4*o;this.data[f]=u,this.data[f+1]=c,this.data[f+2]=a,this.data[f+3]=255}this.pos+=t}},ko.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*r;this.data[s]=o,this.data[s+1]=i,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},ko.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*r;this.data[a]=o,this.data[a+1]=i,this.data[a+2]=n,this.data[a+3]=s}},ko.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,r,n,i){var o=new ko(e,!1),s=o.width,a=o.height,c={data:o.getData(),width:s,height:a},u=new vp(100).encode(c,100);return t.processJPEG.call(this,u,r,n,i)}}(sr.API),J0.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,r,n,i){var o=new J0(e),s=o.width,a=o.height,c={data:o.getData(),width:s,height:a},u=new vp(100).encode(c,100);return t.processJPEG.call(this,u,r,n,i)}}(sr.API),sr.API.processRGBA=function(t,e,r){for(var n=t.data,i=n.length,o=new Uint8Array(i/4*3),s=new Uint8Array(i/4),a=0,c=0,u=0;u<i;u+=4){var f=n[u],y=n[u+1],v=n[u+2],p=n[u+3];o[a++]=f,o[a++]=y,o[a++]=v,s[c++]=p}var I=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:I,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},sr.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Zl=sr.API,Wd=Zl.getCharWidthsArray=function(t,e){var r,n,i=(e=e||{}).font||this.internal.getFont(),o=e.fontSize||this.internal.getFontSize(),s=e.charSpace||this.internal.getCharSpace(),a=e.widths?e.widths:i.metadata.Unicode.widths,c=a.fof?a.fof:1,u=e.kerning?e.kerning:i.metadata.Unicode.kerning,f=u.fof?u.fof:1,y=e.doKerning!==!1,v=0,p=t.length,I=0,P=a[0]||c,w=[];for(r=0;r<p;r++)n=t.charCodeAt(r),typeof i.metadata.widthOfString=="function"?w.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+s*(1e3/o)||0)/1e3):(v=y&&rn(u[n])==="object"&&!isNaN(parseInt(u[n][I],10))?u[n][I]/f:0,w.push((a[n]||P)/c+v)),I=n;return w},W0=Zl.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return Zl.processArabic&&(t=Zl.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,i)/r:Wd.apply(this,arguments).reduce(function(o,s){return o+s},0)},G0=function(t,e,r,n){for(var i=[],o=0,s=t.length,a=0;o!==s&&a+e[o]<r;)a+=e[o],o++;i.push(t.slice(0,o));var c=o;for(a=0;o!==s;)a+e[o]>n&&(i.push(t.slice(c,o)),a=0,c=o),a+=e[o],o++;return c!==o&&i.push(t.slice(c,o)),i},Y0=function(t,e,r){r||(r={});var n,i,o,s,a,c,u,f=[],y=[f],v=r.textIndent||0,p=0,I=0,P=t.split(" "),w=Wd.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?P[0].length+2:r.lineIndent||0){var x=Array(c).join(" "),j=[];P.map(function(Q){(Q=Q.split(/\s*\n/)).length>1?j=j.concat(Q.map(function(K,Z){return(Z&&K.length?`
`:"")+K})):j.push(Q[0])}),P=j,c=W0.apply(this,[x,r])}for(o=0,s=P.length;o<s;o++){var ne=0;if(n=P[o],c&&n[0]==`
`&&(n=n.substr(1),ne=1),v+p+(I=(i=Wd.apply(this,[n,r])).reduce(function(Q,K){return Q+K},0))>e||ne){if(I>e){for(a=G0.apply(this,[n,i,e-(v+p),e]),f.push(a.shift()),f=[a.pop()];a.length;)y.push([a.shift()]);I=i.slice(n.length-(f[0]?f[0].length:0)).reduce(function(Q,K){return Q+K},0)}else f=[n];y.push(f),v=I+c,p=w}else f.push(n),v+=p+I,p=w}return u=c?function(Q,K){return(K?x:"")+Q.join(" ")}:function(Q){return Q.join(" ")},y.map(u)},Zl.splitTextToSize=function(t,e,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),o=function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var y=this.internal.getFont(f.fontName,f.fontStyle);return y.metadata.Unicode?{widths:y.metadata.Unicode.widths||{0:1},kerning:y.metadata.Unicode.kerning||{}}:{font:y.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var s=1*this.internal.scaleFactor*e/i;o.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,o.lineIndent=r.lineIndent;var a,c,u=[];for(a=0,c=n.length;a<c;a++)u=u.concat(Y0.apply(this,[n[a],s,o]));return u},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",r={},n={},i=0;i<e.length;i++)r[e[i]]="0123456789abcdef"[i],n["0123456789abcdef"[i]]=e[i];var o=function(y){return"0x"+parseInt(y,10).toString(16)},s=t.__fontmetrics__.compress=function(y){var v,p,I,P,w=["{"];for(var x in y){if(v=y[x],isNaN(parseInt(x,10))?p="'"+x+"'":(x=parseInt(x,10),p=(p=o(x).slice(2)).slice(0,-1)+n[p.slice(-1)]),typeof v=="number")v<0?(I=o(v).slice(3),P="-"):(I=o(v).slice(2),P=""),I=P+I.slice(0,-1)+n[I.slice(-1)];else{if(rn(v)!=="object")throw new Error("Don't know what to do with value type "+rn(v)+".");I=s(v)}w.push(p+I)}return w.push("}"),w.join("")},a=t.__fontmetrics__.uncompress=function(y){if(typeof y!="string")throw new Error("Invalid argument passed to uncompress.");for(var v,p,I,P,w={},x=1,j=w,ne=[],Q="",K="",Z=y.length-1,k=1;k<Z;k+=1)(P=y[k])=="'"?v?(I=v.join(""),v=void 0):v=[]:v?v.push(P):P=="{"?(ne.push([j,I]),j={},I=void 0):P=="}"?((p=ne.pop())[0][p[1]]=j,I=void 0,j=p[0]):P=="-"?x=-1:I===void 0?r.hasOwnProperty(P)?(Q+=r[P],I=parseInt(Q,16)*x,x=1,Q=""):Q+=P:r.hasOwnProperty(P)?(K+=r[P],j[I]=parseInt(K,16)*x,x=1,I=void 0,K=""):K+=P;return w},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:a("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},f={Unicode:{"Courier-Oblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":a("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":a("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:a("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:a("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":a("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":a("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(y){var v=y.font,p=f.Unicode[v.postScriptName];p&&(v.metadata.Unicode={},v.metadata.Unicode.widths=p.widths,v.metadata.Unicode.kerning=p.kerning);var I=u.Unicode[v.postScriptName];I&&(v.metadata.Unicode.encoding=I,v.encoding=I.codePages[0])}])}(sr.API),function(t){var e=function(r){for(var n=r.length,i=new Uint8Array(n),o=0;o<n;o++)i[o]=r.charCodeAt(o);return i};t.API.events.push(["addFont",function(r){var n=void 0,i=r.font,o=r.instance;if(!i.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=o.existsFileInVFS(i.postScriptName)===!1?o.loadFile(i.postScriptName):o.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(s,a){a=/^\x00\x01\x00\x00/.test(a)?e(a):e(gu(a)),s.metadata=t.API.TTFFont.open(a),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(i,n)}}])}(sr),function(t){function e(){return(lr.canvg?Promise.resolve(lr.canvg):Ui(()=>import("./index.es-DA2tlJqs.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}sr.API.addSvgAsImage=function(r,n,i,o,s,a,c,u){if(isNaN(n)||isNaN(i))throw cn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(o)||isNaN(s))throw cn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var f=document.createElement("canvas");f.width=o,f.height=s;var y=f.getContext("2d");y.fillStyle="#fff",y.fillRect(0,0,f.width,f.height);var v={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},p=this;return e().then(function(I){return I.fromString(y,r,v)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(I){return I.render(v)}).then(function(){p.addImage(f.toDataURL("image/jpeg",1),n,i,o,s,c,u)})}}(),sr.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(e,r);return this},sr.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,i,o,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},a=Object.keys(s),c=[],u=0,f=0,y=0;function v(I,P){var w,x=!1;for(w=0;w<I.length;w+=1)I[w]===P&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var p=a.length;for(y=0;y<p;y+=1)r[a[y]].value=r[a[y]].defaultValue,r[a[y]].explicitSet=!1}if(rn(t)==="object"){for(i in t)if(o=t[i],v(a,i)&&o!==void 0){if(r[i].type==="boolean"&&typeof o=="boolean")r[i].value=o;else if(r[i].type==="name"&&v(r[i].valueSet,o))r[i].value=o;else if(r[i].type==="integer"&&Number.isInteger(o))r[i].value=o;else if(r[i].type==="array"){for(u=0;u<o.length;u+=1)if(n=!0,o[u].length===1&&typeof o[u][0]=="number")c.push(String(o[u]-1));else if(o[u].length>1){for(f=0;f<o[u].length;f+=1)typeof o[u][f]!="number"&&(n=!1);n===!0&&c.push([o[u][0]-1,o[u][1]-1].join(" "))}r[i].value="["+c.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var I,P=[];for(I in r)r[I].explicitSet===!0&&(r[I].type==="name"?P.push("/"+I+" /"+r[I].value):P.push("/"+I+" "+r[I].value));P.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+P.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=o.length+s.length+a.length+i.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(i+o+s+a+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}(sr.API),function(t){var e=t.API,r=e.pdfEscape16=function(o,s){for(var a,c=s.metadata.Unicode.widths,u=["","0","00","000","0000"],f=[""],y=0,v=o.length;y<v;++y){if(a=s.metadata.characterToGlyph(o.charCodeAt(y)),s.metadata.glyIdsUsed.push(a),s.metadata.toUnicode[a]=o.charCodeAt(y),c.indexOf(a)==-1&&(c.push(a),c.push([parseInt(s.metadata.widthOfGlyph(a),10)])),a=="0")return f.join("");a=a.toString(16),f.push(u[4-a.length],a)}return f.join("")},n=function(o){var s,a,c,u,f,y,v;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],y=0,v=(a=Object.keys(o).sort(function(p,I){return p-I})).length;y<v;y++)s=a[y],c.length>=100&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),o[s]!==void 0&&o[s]!==null&&typeof o[s].toString=="function"&&(u=("0000"+o[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),c.push("<"+s+"><"+u+">"));return c.length&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),f+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(o){(function(s){var a=s.font,c=s.out,u=s.newObject,f=s.putStream;if(a.metadata instanceof t.API.TTFFont&&a.encoding==="Identity-H"){for(var y=a.metadata.Unicode.widths,v=a.metadata.subset.encode(a.metadata.glyIdsUsed,1),p="",I=0;I<v.length;I++)p+=String.fromCharCode(v[I]);var P=u();f({data:p,addLength1:!0,objectId:P}),c("endobj");var w=u();f({data:n(a.metadata.toUnicode),addLength1:!0,objectId:w}),c("endobj");var x=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+ac(a.fontName)),c("/FontFile2 "+P+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(a.metadata.bbox)),c("/Flags "+a.metadata.flags),c("/StemV "+a.metadata.stemV),c("/ItalicAngle "+a.metadata.italicAngle),c("/Ascent "+a.metadata.ascender),c("/Descent "+a.metadata.decender),c("/CapHeight "+a.metadata.capHeight),c(">>"),c("endobj");var j=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+ac(a.fontName)),c("/FontDescriptor "+x+" 0 R"),c("/W "+t.API.PDFObject.convert(y)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+a.encoding+")"),c(">>"),c(">>"),c("endobj"),a.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+w+" 0 R"),c("/BaseFont /"+ac(a.fontName)),c("/Encoding /"+a.encoding),c("/DescendantFonts ["+j+" 0 R]"),c(">>"),c("endobj"),a.isAlreadyPutted=!0}})(o)}]),e.events.push(["putFont",function(o){(function(s){var a=s.font,c=s.out,u=s.newObject,f=s.putStream;if(a.metadata instanceof t.API.TTFFont&&a.encoding==="WinAnsiEncoding"){for(var y=a.metadata.rawData,v="",p=0;p<y.length;p++)v+=String.fromCharCode(y[p]);var I=u();f({data:v,addLength1:!0,objectId:I}),c("endobj");var P=u();f({data:n(a.metadata.toUnicode),addLength1:!0,objectId:P}),c("endobj");var w=u();c("<<"),c("/Descent "+a.metadata.decender),c("/CapHeight "+a.metadata.capHeight),c("/StemV "+a.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+I+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(a.metadata.bbox)),c("/FontName /"+ac(a.fontName)),c("/ItalicAngle "+a.metadata.italicAngle),c("/Ascent "+a.metadata.ascender),c(">>"),c("endobj"),a.objectNumber=u();for(var x=0;x<a.metadata.hmtx.widths.length;x++)a.metadata.hmtx.widths[x]=parseInt(a.metadata.hmtx.widths[x]*(1e3/a.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+P+" 0 R/BaseFont/"+ac(a.fontName)+"/FontDescriptor "+w+" 0 R/Encoding/"+a.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(a.metadata.hmtx.widths)+">>"),c("endobj"),a.isAlreadyPutted=!0}})(o)}]);var i=function(o){var s,a=o.text||"",c=o.x,u=o.y,f=o.options||{},y=o.mutex||{},v=y.pdfEscape,p=y.activeFontKey,I=y.fonts,P=p,w="",x=0,j="",ne=I[P].encoding;if(I[P].encoding!=="Identity-H")return{text:a,x:c,y:u,options:f,mutex:y};for(j=a,P=p,Array.isArray(a)&&(j=a[0]),x=0;x<j.length;x+=1)I[P].metadata.hasOwnProperty("cmap")&&(s=I[P].metadata.cmap.unicode.codeMap[j[x].charCodeAt(0)]),s||j[x].charCodeAt(0)<256&&I[P].metadata.hasOwnProperty("Unicode")?w+=j[x]:w+="";var Q="";return parseInt(P.slice(1))<14||ne==="WinAnsiEncoding"?Q=v(w,P).split("").map(function(K){return K.charCodeAt(0).toString(16)}).join(""):ne==="Identity-H"&&(Q=r(w,I[P])),y.isHex=!0,{text:Q,x:c,y:u,options:f,mutex:y}};e.events.push(["postProcessText",function(o){var s=o.text||"",a=[],c={text:s,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(s)){var u=0;for(u=0;u<s.length;u+=1)Array.isArray(s[u])&&s[u].length===3?a.push([i(Object.assign({},c,{text:s[u][0]})).text,s[u][1],s[u][2]]):a.push(i(Object.assign({},c,{text:s[u]})).text);o.text=a}else o.text=i(Object.assign({},c,{text:s})).text}])}(sr),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(sr.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var i,o,s,a,c,u,f,y=e,v=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],I={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},P={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},w=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),j=!1,ne=0;this.__bidiEngine__={};var Q=function(_){var S=_.charCodeAt(),b=S>>8,Y=P[b];return Y!==void 0?y[256*Y+(255&S)]:b===252||b===253?"AL":x.test(b)?"L":b===8?"R":"N"},K=function(_){for(var S,b=0;b<_.length;b++){if((S=Q(_.charAt(b)))==="L")return!1;if(S==="R")return!0}return!1},Z=function(_,S,b,Y){var te,O,D,X,H=S[Y];switch(H){case"L":case"R":j=!1;break;case"N":case"AN":break;case"EN":j&&(H="AN");break;case"AL":j=!0,H="R";break;case"WS":H="N";break;case"CS":Y<1||Y+1>=S.length||(te=b[Y-1])!=="EN"&&te!=="AN"||(O=S[Y+1])!=="EN"&&O!=="AN"?H="N":j&&(O="AN"),H=O===te?O:"N";break;case"ES":H=(te=Y>0?b[Y-1]:"B")==="EN"&&Y+1<S.length&&S[Y+1]==="EN"?"EN":"N";break;case"ET":if(Y>0&&b[Y-1]==="EN"){H="EN";break}if(j){H="N";break}for(D=Y+1,X=S.length;D<X&&S[D]==="ET";)D++;H=D<X&&S[D]==="EN"?"EN":"N";break;case"NSM":if(s&&!a){for(X=S.length,D=Y+1;D<X&&S[D]==="NSM";)D++;if(D<X){var F=_[Y],ie=F>=1425&&F<=2303||F===64286;if(te=S[D],ie&&(te==="R"||te==="AL")){H="R";break}}}H=Y<1||(te=S[Y-1])==="B"?"N":b[Y-1];break;case"B":j=!1,i=!0,H=ne;break;case"S":o=!0,H="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":j=!1;break;case"BN":H="N"}return H},k=function(_,S,b){var Y=_.split("");return b&&C(Y,b,{hiLevel:ne}),Y.reverse(),S&&S.reverse(),Y.join("")},C=function(_,S,b){var Y,te,O,D,X,H=-1,F=_.length,ie=0,$=[],L=ne?p:v,U=[];for(j=!1,i=!1,o=!1,te=0;te<F;te++)U[te]=Q(_[te]);for(O=0;O<F;O++){if(X=ie,$[O]=Z(_,U,$,O),Y=240&(ie=L[X][I[$[O]]]),ie&=15,S[O]=D=L[ie][5],Y>0)if(Y===16){for(te=H;te<O;te++)S[te]=1;H=-1}else H=-1;if(L[ie][6])H===-1&&(H=O);else if(H>-1){for(te=H;te<O;te++)S[te]=D;H=-1}U[O]==="B"&&(S[O]=0),b.hiLevel|=D}o&&function(N,z,oe){for(var G=0;G<oe;G++)if(N[G]==="S"){z[G]=ne;for(var ee=G-1;ee>=0&&N[ee]==="WS";ee--)z[ee]=ne}}(U,S,F)},E=function(_,S,b,Y,te){if(!(te.hiLevel<_)){if(_===1&&ne===1&&!i)return S.reverse(),void(b&&b.reverse());for(var O,D,X,H,F=S.length,ie=0;ie<F;){if(Y[ie]>=_){for(X=ie+1;X<F&&Y[X]>=_;)X++;for(H=ie,D=X-1;H<D;H++,D--)O=S[H],S[H]=S[D],S[D]=O,b&&(O=b[H],b[H]=b[D],b[D]=O);ie=X}ie++}}},M=function(_,S,b){var Y=_.split(""),te={hiLevel:ne};return b||(b=[]),C(Y,b,te),function(O,D,X){if(X.hiLevel!==0&&f)for(var H,F=0;F<O.length;F++)D[F]===1&&(H=w.indexOf(O[F]))>=0&&(O[F]=w[H+1])}(Y,b,te),E(2,Y,S,b,te),E(1,Y,S,b,te),Y.join("")};return this.__bidiEngine__.doBidiReorder=function(_,S,b){if(function(te,O){if(O)for(var D=0;D<te.length;D++)O[D]=D;a===void 0&&(a=K(te)),u===void 0&&(u=K(te))}(_,S),s||!c||u)if(s&&c&&a^u)ne=a?1:0,_=k(_,S,b);else if(!s&&c&&u)ne=a?1:0,_=M(_,S,b),_=k(_,S);else if(!s||a||c||u){if(s&&!c&&a^u)_=k(_,S),a?(ne=0,_=M(_,S,b)):(ne=1,_=M(_,S,b),_=k(_,S));else if(s&&a&&!c&&u)ne=1,_=M(_,S,b),_=k(_,S);else if(!s&&!c&&a^u){var Y=f;a?(ne=1,_=M(_,S,b),ne=0,f=!1,_=M(_,S,b),f=Y):(ne=0,_=M(_,S,b),_=k(_,S),ne=1,f=!1,_=M(_,S,b),f=Y,_=k(_,S))}}else ne=0,_=M(_,S,b);else ne=a?1:0,_=M(_,S,b);return _},this.__bidiEngine__.setOptions=function(_){_&&(s=_.isInputVisual,c=_.isOutputVisual,a=_.isInputRtl,u=_.isOutputRtl,f=_.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var o=n.options||{};n.mutex,o.lang;var s=[];if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,r.setOptions(o),Object.prototype.toString.call(i)==="[object Array]"){var a=0;for(s=[],a=0;a<i.length;a+=1)Object.prototype.toString.call(i[a])==="[object Array]"?s.push([r.doBidiReorder(i[a][0]),i[a][1],i[a][2]]):s.push([r.doBidiReorder(i[a])]);n.text=s}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])}(sr),sr.API.TTFFont=function(){function t(e){var r;if(this.rawData=e,r=this.contents=new Fa(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new GL(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new LL(this.contents),this.head=new RL(this),this.name=new jL(this),this.cmap=new U5(this),this.toUnicode={},this.hhea=new ML(this),this.maxp=new VL(this),this.hmtx=new zL(this),this.post=new OL(this),this.os2=new FL(this),this.loca=new WL(this),this.glyf=new qL(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,i,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var s,a,c,u;for(u=[],s=0,a=(c=this.bbox).length;s<a;s++)e=c[s],u.push(Math.round(e*this.scaleFactor));return u}.call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),(32768&(r=i>>16))!=0&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var i,o,s,a;for(s=0,o=0,a=(e=""+e).length;0<=a?o<a:o>a;o=0<=a?++o:--o)i=e.charCodeAt(o),s+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return s*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t}();var Fo,Fa=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,i;for(i=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(e.charCodeAt(r)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,i,o,s,a,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),o=this.readByte(),s=this.readByte(),a=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^o)+65536*(255^s)+256*(255^a)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*i+16777216*o+65536*s+256*a+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,i,o;for(o=[],n=0,i=e.length;n<i;n++)r=e[n],o.push(this.writeByte(r));return o},t}(),LL=function(){var t;function e(r){var n,i,o;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,o=this.tableCount;0<=o?i<o:i>o;i=0<=o?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,i,o,s,a,c,u,f,y,v,p,I,P;for(P in p=Object.keys(r).length,c=Math.log(2),y=16*Math.floor(Math.log(p)/c),s=Math.floor(y/c),f=16*p-y,(i=new Fa).writeInt(this.scalarType),i.writeShort(p),i.writeShort(y),i.writeShort(s),i.writeShort(f),o=16*p,u=i.pos+o,a=null,I=[],r)for(v=r[P],i.writeString(P),i.writeInt(t(v)),i.writeInt(u),i.writeInt(v.length),I=I.concat(v),P==="head"&&(a=u),u+=v.length;u%4;)I.push(0),u++;return i.write(I),n=2981146554-t(i.data),i.pos=a+8,i.writeUInt32(n),i.data},t=function(r){var n,i,o,s;for(r=H5.call(r);r.length%4;)r.push(0);for(o=new Fa(r),i=0,n=0,s=r.length;n<s;n=n+=4)i+=o.readUInt32();return 4294967295&i},e}(),DL={}.hasOwnProperty,ls=function(t,e){for(var r in e)DL.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Fo=function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var RL=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Fo),e.prototype.tag="head",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},e.prototype.encode=function(r){var n;return(n=new Fa).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},e}(),Q0=function(){function t(e,r){var n,i,o,s,a,c,u,f,y,v,p,I,P,w,x,j,ne;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),y=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(p=e.readUInt16(),v=p/2,e.pos+=6,o=function(){var Q,K;for(K=[],c=Q=0;0<=v?Q<v:Q>v;c=0<=v?++Q:--Q)K.push(e.readUInt16());return K}(),e.pos+=2,P=function(){var Q,K;for(K=[],c=Q=0;0<=v?Q<v:Q>v;c=0<=v?++Q:--Q)K.push(e.readUInt16());return K}(),u=function(){var Q,K;for(K=[],c=Q=0;0<=v?Q<v:Q>v;c=0<=v?++Q:--Q)K.push(e.readUInt16());return K}(),f=function(){var Q,K;for(K=[],c=Q=0;0<=v?Q<v:Q>v;c=0<=v?++Q:--Q)K.push(e.readUInt16());return K}(),i=(this.length-e.pos+this.offset)/2,a=function(){var Q,K;for(K=[],c=Q=0;0<=i?Q<i:Q>i;c=0<=i?++Q:--Q)K.push(e.readUInt16());return K}(),c=x=0,ne=o.length;x<ne;c=++x)for(w=o[c],n=j=I=P[c];I<=w?j<=w:j>=w;n=I<=w?++j:--j)f[c]===0?s=n+u[c]:(s=a[f[c]/2+(n-I)-(v-c)]||0)!==0&&(s+=u[c]),this.codeMap[n]=65535&s}e.pos=y}return t.encode=function(e,r){var n,i,o,s,a,c,u,f,y,v,p,I,P,w,x,j,ne,Q,K,Z,k,C,E,M,_,S,b,Y,te,O,D,X,H,F,ie,$,L,U,N,z,oe,G,ee,J,W,q;switch(Y=new Fa,s=Object.keys(e).sort(function(ae,de){return ae-de}),r){case"macroman":for(P=0,w=function(){var ae=[];for(I=0;I<256;++I)ae.push(0);return ae}(),j={0:0},o={},te=0,H=s.length;te<H;te++)j[ee=e[i=s[te]]]==null&&(j[ee]=++P),o[i]={old:e[i],new:j[e[i]]},w[i]=j[e[i]];return Y.writeUInt16(1),Y.writeUInt16(0),Y.writeUInt32(12),Y.writeUInt16(0),Y.writeUInt16(262),Y.writeUInt16(0),Y.write(w),{charMap:o,subtable:Y.data,maxGlyphID:P+1};case"unicode":for(S=[],y=[],ne=0,j={},n={},x=u=null,O=0,F=s.length;O<F;O++)j[K=e[i=s[O]]]==null&&(j[K]=++ne),n[i]={old:K,new:j[K]},a=j[K]-i,x!=null&&a===u||(x&&y.push(x),S.push(i),u=a),x=i;for(x&&y.push(x),y.push(65535),S.push(65535),M=2*(E=S.length),C=2*Math.pow(Math.log(E)/Math.LN2,2),v=Math.log(C/2)/Math.LN2,k=2*E-C,c=[],Z=[],p=[],I=D=0,ie=S.length;D<ie;I=++D){if(_=S[I],f=y[I],_===65535){c.push(0),Z.push(0);break}if(_-(b=n[_].new)>=32768)for(c.push(0),Z.push(2*(p.length+E-I)),i=X=_;_<=f?X<=f:X>=f;i=_<=f?++X:--X)p.push(n[i].new);else c.push(b-_),Z.push(0)}for(Y.writeUInt16(3),Y.writeUInt16(1),Y.writeUInt32(12),Y.writeUInt16(4),Y.writeUInt16(16+8*E+2*p.length),Y.writeUInt16(0),Y.writeUInt16(M),Y.writeUInt16(C),Y.writeUInt16(v),Y.writeUInt16(k),oe=0,$=y.length;oe<$;oe++)i=y[oe],Y.writeUInt16(i);for(Y.writeUInt16(0),G=0,L=S.length;G<L;G++)i=S[G],Y.writeUInt16(i);for(J=0,U=c.length;J<U;J++)a=c[J],Y.writeUInt16(a);for(W=0,N=Z.length;W<N;W++)Q=Z[W],Y.writeUInt16(Q);for(q=0,z=p.length;q<z;q++)P=p[q],Y.writeUInt16(P);return{charMap:n,subtable:Y.data,maxGlyphID:ne+1}}},t}(),U5=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Fo),e.prototype.tag="cmap",e.prototype.parse=function(r){var n,i,o;for(r.pos=this.offset,this.version=r.readUInt16(),o=r.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=o?i<o:i>o;i=0<=o?++i:--i)n=new Q0(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},e.encode=function(r,n){var i,o;return n==null&&(n="macroman"),i=Q0.encode(r,n),(o=new Fa).writeUInt16(0),o.writeUInt16(1),i.table=o.data.concat(i.subtable),i},e}(),ML=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Fo),e.prototype.tag="hhea",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},e}(),FL=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Fo),e.prototype.tag="OS/2",e.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var n,i;for(i=[],n=0;n<10;++n)i.push(r.readByte());return i}(),this.charRange=function(){var n,i;for(i=[],n=0;n<4;++n)i.push(r.readInt());return i}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var n,i;for(i=[],n=0;n<2;n=++n)i.push(r.readInt());return i}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},e}(),OL=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Fo),e.prototype.tag="post",e.prototype.parse=function(r){var n,i,o;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var s;for(i=r.readUInt16(),this.glyphNameIndex=[],s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],o=[];r.pos<this.offset+this.length;)n=r.readByte(),o.push(this.names.push(r.readString(n)));return o;case 151552:return i=r.readUInt16(),this.offsets=r.read(i);case 196608:break;case 262144:return this.map=function(){var a,c,u;for(u=[],s=a=0,c=this.file.maxp.numGlyphs;0<=c?a<c:a>c;s=0<=c?++a:--a)u.push(r.readUInt32());return u}.call(this)}},e}(),BL=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},jL=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Fo),e.prototype.tag="name",e.prototype.parse=function(r){var n,i,o,s,a,c,u,f,y,v,p;for(r.pos=this.offset,r.readShort(),n=r.readShort(),c=r.readShort(),i=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)i.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+c+r.readShort()});for(u={},s=y=0,v=i.length;y<v;s=++y)o=i[s],r.pos=o.offset,f=r.readString(o.length),a=new BL(f,o),u[p=o.nameID]==null&&(u[p]=[]),u[o.nameID].push(a);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},e}(),VL=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Fo),e.prototype.tag="maxp",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},e}(),zL=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Fo),e.prototype.tag="hmtx",e.prototype.parse=function(r){var n,i,o,s,a,c,u;for(r.pos=this.offset,this.metrics=[],n=0,c=this.file.hhea.numberOfMetrics;0<=c?n<c:n>c;n=0<=c?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(o=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var f,y;for(y=[],n=f=0;0<=o?f<o:f>o;n=0<=o?++f:--f)y.push(r.readInt16());return y}(),this.widths=function(){var f,y,v,p;for(p=[],f=0,y=(v=this.metrics).length;f<y;f++)s=v[f],p.push(s.advance);return p}.call(this),i=this.widths[this.widths.length-1],u=[],n=a=0;0<=o?a<o:a>o;n=0<=o?++a:--a)u.push(this.widths.push(i));return u},e.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},e}(),H5=[].slice,qL=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Fo),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(r){var n,i,o,s,a,c,u,f,y,v;return r in this.cache?this.cache[r]:(s=this.file.loca,n=this.file.contents,i=s.indexOf(r),(o=s.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+i,a=(c=new Fa(n.read(o))).readShort(),f=c.readShort(),v=c.readShort(),u=c.readShort(),y=c.readShort(),this.cache[r]=a===-1?new HL(c,f,v,u,y):new UL(c,a,f,v,u,y),this.cache[r]))},e.prototype.encode=function(r,n,i){var o,s,a,c,u;for(a=[],s=[],c=0,u=n.length;c<u;c++)o=r[n[c]],s.push(a.length),o&&(a=a.concat(o.encode(i)));return s.push(a.length),{table:a,offsets:s}},e}(),UL=function(){function t(e,r,n,i,o,s){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=o,this.yMax=s,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),HL=function(){function t(e,r,n,i,o){var s,a;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;a=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&a;)s.pos+=1&a?4:2,128&a?s.pos+=8:64&a?s.pos+=4:8&a&&(s.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new Fa(H5.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t}(),WL=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Fo),e.prototype.tag="loca",e.prototype.parse=function(r){var n,i;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?function(){var o,s;for(s=[],i=0,o=this.length;i<o;i+=2)s.push(2*r.readUInt16());return s}.call(this):function(){var o,s;for(s=[],i=0,o=this.length;i<o;i+=4)s.push(r.readUInt32());return s}.call(this)},e.prototype.indexOf=function(r){return this.offsets[r]},e.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},e.prototype.encode=function(r,n){for(var i=new Uint32Array(this.offsets.length),o=0,s=0,a=0;a<i.length;++a)if(i[a]=o,s<n.length&&n[s]==a){++s,i[a]=o;var c=this.offsets[a],u=this.offsets[a+1]-c;u>0&&(o+=u)}for(var f=new Array(4*i.length),y=0;y<i.length;++y)f[4*y+3]=255&i[y],f[4*y+2]=(65280&i[y])>>8,f[4*y+1]=(16711680&i[y])>>16,f[4*y]=(4278190080&i[y])>>24;return f},e}(),GL=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,i,o;for(r in i=this.font.cmap.tables[0].codeMap,e={},o=this.subset)n=o[r],e[r]=i[n];return e},t.prototype.glyphsFor=function(e){var r,n,i,o,s,a,c;for(i={},s=0,a=e.length;s<a;s++)i[o=e[s]]=this.font.glyf.glyphFor(o);for(o in r=[],i)(n=i[o])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(o in c=this.glyphsFor(r))n=c[o],i[o]=n;return i},t.prototype.encode=function(e,r){var n,i,o,s,a,c,u,f,y,v,p,I,P,w,x;for(i in n=U5.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),p={0:0},x=n.charMap)p[(c=x[i]).old]=c.new;for(I in v=n.maxGlyphID,s)I in p||(p[I]=v++);return f=function(j){var ne,Q;for(ne in Q={},j)Q[j[ne]]=ne;return Q}(p),y=Object.keys(f).sort(function(j,ne){return j-ne}),P=function(){var j,ne,Q;for(Q=[],j=0,ne=y.length;j<ne;j++)a=y[j],Q.push(f[a]);return Q}(),o=this.font.glyf.encode(s,P,p),u=this.font.loca.encode(o.offsets,P),w={cmap:this.font.cmap.raw(),glyf:o.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(w["OS/2"]=this.font.os2.raw()),this.font.directory.encode(w)},t}();sr.API.PDFObject=function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,i,o,s;if(Array.isArray(r))return"["+function(){var a,c,u;for(u=[],a=0,c=r.length;a<c;a++)n=r[a],u.push(e.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in o=["<<"],r)s=r[i],o.push("/"+i+" "+e.convert(s));return o.push(">>"),o.join(`
`)}return""+r},e}();const W5=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:AL,AcroFormAppearance:Wt,AcroFormButton:Hn,AcroFormCheckBox:_u,AcroFormChoiceField:vl,AcroFormComboBox:_l,AcroFormEditBox:vu,AcroFormListBox:bl,AcroFormPasswordField:wu,AcroFormPushButton:bu,AcroFormRadioButton:wl,AcroFormTextField:ka,GState:ju,ShadingPattern:ba,TilingPattern:ml,default:sr,jsPDF:sr},Symbol.toStringTag,{value:"Module"}));function G5(t,e,r,n,i){n=n||{};var o=1.15,s=i.internal.scaleFactor,a=i.internal.getFontSize()/s,c=i.getLineHeightFactor?i.getLineHeightFactor():o,u=a*c,f=/\r\n|\r|\n/g,y="",v=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(y=typeof t=="string"?t.split(f):t,v=y.length||1),r+=a*(2-o),n.valign==="middle"?r-=v/2*u:n.valign==="bottom"&&(r-=v*u),n.halign==="center"||n.halign==="right"){var p=a;if(n.halign==="center"&&(p*=.5),y&&v>=1){for(var I=0;I<y.length;I++)i.text(y[I],e-i.getStringUnitWidth(y[I])*p,r),r+=u;return i}e-=i.getStringUnitWidth(t)*p}return n.halign==="justify"?i.text(t,e,r,{maxWidth:n.maxWidth||100,align:"justify"}):i.text(t,e,r),i}var X0={},pc=function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:X0=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var n,i,o;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var s=this.jsPDFDocument.internal.getFont(),a=s.fontStyle,c=s.fontName;if(e.font&&(c=e.font),e.fontStyle){a=e.fontStyle;var u=this.getFontList()[c];u&&u.indexOf(a)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(u[0]),a=u[0])}if(this.jsPDFDocument.setFont(c,a),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var f=t.unifyColor(e.fillColor);f&&(n=this.jsPDFDocument).setFillColor.apply(n,f),f=t.unifyColor(e.textColor),f&&(i=this.jsPDFDocument).setTextColor.apply(i,f),f=t.unifyColor(e.lineColor),f&&(o=this.jsPDFDocument).setDrawColor.apply(o,f),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,n){return this.jsPDFDocument.splitTextToSize(e,r,n)},t.prototype.rect=function(e,r,n,i,o){return this.jsPDFDocument.rect(e,r,n,i,o)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return X0||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t}(),Sm=function(t,e){return Sm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},Sm(t,e)};function Y5(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Sm(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var K5=function(t){Y5(e,t);function e(r){var n=t.call(this)||this;return n._element=r,n}return e}(Array);function YL(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function KL(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function Oh(t,e,r){r.applyStyles(e,!0);var n=Array.isArray(t)?t:[t],i=n.map(function(o){return r.getTextWidth(o)}).reduce(function(o,s){return Math.max(o,s)},0);return i}function J5(t,e,r,n){var i=e.settings.tableLineWidth,o=e.settings.tableLineColor;t.applyStyles({lineWidth:i,lineColor:o});var s=Q5(i,!1);s&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),n.y-r.y,s)}function Q5(t,e){var r=t>0,n=e||e===0;return r&&n?"DF":r?"S":n?"F":null}function ff(t,e){var r,n,i,o;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(n=t.top)!==null&&n!==void 0?n:e,right:(i=t.right)!==null&&i!==void 0?i:e,bottom:(o=t.bottom)!==null&&o!==void 0?o:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function X5(t,e){var r=ff(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function JL(t,e,r,n,i){var o={},s=1.3333333333333333,a=bp(e,function(ne){return i.getComputedStyle(ne).backgroundColor});a!=null&&(o.fillColor=a);var c=bp(e,function(ne){return i.getComputedStyle(ne).color});c!=null&&(o.textColor=c);var u=XL(n,r);u&&(o.cellPadding=u);var f="borderTopColor",y=s*r,v=n.borderTopWidth;if(n.borderBottomWidth===v&&n.borderRightWidth===v&&n.borderLeftWidth===v){var p=(parseFloat(v)||0)/y;p&&(o.lineWidth=p)}else o.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/y,right:(parseFloat(n.borderRightWidth)||0)/y,bottom:(parseFloat(n.borderBottomWidth)||0)/y,left:(parseFloat(n.borderLeftWidth)||0)/y},o.lineWidth.top||(o.lineWidth.right?f="borderRightColor":o.lineWidth.bottom?f="borderBottomColor":o.lineWidth.left&&(f="borderLeftColor"));var I=bp(e,function(ne){return i.getComputedStyle(ne)[f]});I!=null&&(o.lineColor=I);var P=["left","right","center","justify"];P.indexOf(n.textAlign)!==-1&&(o.halign=n.textAlign),P=["middle","bottom","top"],P.indexOf(n.verticalAlign)!==-1&&(o.valign=n.verticalAlign);var w=parseInt(n.fontSize||"");isNaN(w)||(o.fontSize=w/s);var x=QL(n);x&&(o.fontStyle=x);var j=(n.fontFamily||"").toLowerCase();return t.indexOf(j)!==-1&&(o.font=j),o}function QL(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function bp(t,e){var r=Z5(t,e);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var i=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],o=parseInt(n[4]);return o===0||isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function Z5(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:Z5(t.parentElement,e):r}function XL(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],n=96/(72/e),i=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,o=r.map(function(a){return parseInt(a||"0")/n}),s=ff(o,0);return i>s.top&&(s.top=i),i>s.bottom&&(s.bottom=i),s}function e_(t,e,r,n,i){var o,s;n===void 0&&(n=!1),i===void 0&&(i=!1);var a;typeof e=="string"?a=r.document.querySelector(e):a=e;var c=Object.keys(t.getFontList()),u=t.scaleFactor(),f=[],y=[],v=[];if(!a)return console.error("Html table could not be found with input: ",e),{head:f,body:y,foot:v};for(var p=0;p<a.rows.length;p++){var I=a.rows[p],P=(s=(o=I?.parentElement)===null||o===void 0?void 0:o.tagName)===null||s===void 0?void 0:s.toLowerCase(),w=ZL(c,u,r,I,n,i);w&&(P==="thead"?f.push(w):P==="tfoot"?v.push(w):y.push(w))}return{head:f,body:y,foot:v}}function ZL(t,e,r,n,i,o){for(var s=new K5(n),a=0;a<n.cells.length;a++){var c=n.cells[a],u=r.getComputedStyle(c);if(i||u.display!=="none"){var f=void 0;o&&(f=JL(t,c,e,u,r)),s.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:f,_element:c,content:e7(c)})}}var y=r.getComputedStyle(n);if(s.length>0&&(i||y.display!=="none"))return s}function e7(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function t7(t,e,r){for(var n=0,i=[t,e,r];n<i.length;n++){var o=i[n];o&&typeof o!="object"&&console.error("The options parameter should be of type object, is: "+typeof o),o.startY&&typeof o.startY!="number"&&(console.error("Invalid value for startY option",o.startY),delete o.startY)}}function Es(t,e,r,n,i){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(t),s=1;s<arguments.length;s++){var a=arguments[s];if(a!=null)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(o[c]=a[c])}return o}function t_(t,e){var r=new pc(t),n=r.getDocumentOptions(),i=r.getGlobalOptions();t7(i,n,e);var o=Es({},i,n,e),s;typeof window<"u"&&(s=window);var a=r7(i,n,e),c=n7(i,n,e),u=i7(r,o),f=s7(r,o,s);return{id:e.tableId,content:f,hooks:c,styles:a,settings:u}}function r7(t,e,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},i=function(c){if(c==="columnStyles"){var u=t[c],f=e[c],y=r[c];n.columnStyles=Es({},u,f,y)}else{var v=[t,e,r],p=v.map(function(I){return I[c]||{}});n[c]=Es({},p[0],p[1],p[2])}},o=0,s=Object.keys(n);o<s.length;o++){var a=s[o];i(a)}return n}function n7(t,e,r){for(var n=[t,e,r],i={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},o=0,s=n;o<s.length;o++){var a=s[o];a.didParseCell&&i.didParseCell.push(a.didParseCell),a.willDrawCell&&i.willDrawCell.push(a.willDrawCell),a.didDrawCell&&i.didDrawCell.push(a.didDrawCell),a.willDrawPage&&i.willDrawPage.push(a.willDrawPage),a.didDrawPage&&i.didDrawPage.push(a.didDrawPage)}return i}function i7(t,e){var r,n,i,o,s,a,c,u,f,y,v,p,I=ff(e.margin,40/t.scaleFactor()),P=(r=o7(t,e.startY))!==null&&r!==void 0?r:I.top,w;e.showFoot===!0?w="everyPage":e.showFoot===!1?w="never":w=(n=e.showFoot)!==null&&n!==void 0?n:"everyPage";var x;e.showHead===!0?x="everyPage":e.showHead===!1?x="never":x=(i=e.showHead)!==null&&i!==void 0?i:"everyPage";var j=(o=e.useCss)!==null&&o!==void 0?o:!1,ne=e.theme||(j?"plain":"striped"),Q=!!e.horizontalPageBreak,K=(s=e.horizontalPageBreakRepeat)!==null&&s!==void 0?s:null;return{includeHiddenHtml:(a=e.includeHiddenHtml)!==null&&a!==void 0?a:!1,useCss:j,theme:ne,startY:P,margin:I,pageBreak:(c=e.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(u=e.rowPageBreak)!==null&&u!==void 0?u:"auto",tableWidth:(f=e.tableWidth)!==null&&f!==void 0?f:"auto",showHead:x,showFoot:w,tableLineWidth:(y=e.tableLineWidth)!==null&&y!==void 0?y:0,tableLineColor:(v=e.tableLineColor)!==null&&v!==void 0?v:200,horizontalPageBreak:Q,horizontalPageBreakRepeat:K,horizontalPageBreakBehaviour:(p=e.horizontalPageBreakBehaviour)!==null&&p!==void 0?p:"afterAllRows"}}function o7(t,e){var r=t.getLastAutoTable(),n=t.scaleFactor(),i=t.pageNumber(),o=!1;if(r&&r.startPageNumber){var s=r.startPageNumber+r.pageNumber-1;o=s===i}return typeof e=="number"?e:(e==null||e===!1)&&o&&r?.finalY!=null?r.finalY+20/n:null}function s7(t,e,r){var n=e.head||[],i=e.body||[],o=e.foot||[];if(e.html){var s=e.includeHiddenHtml;if(r){var a=e_(t,e.html,r,s,e.useCss)||{};n=a.head||n,i=a.body||n,o=a.foot||n}else console.error("Cannot parse html in non browser environment")}var c=e.columns||a7(n,i,o);return{columns:c,head:n,body:i,foot:o}}function a7(t,e,r){var n=t[0]||e[0]||r[0]||[],i=[];return Object.keys(n).filter(function(o){return o!=="_element"}).forEach(function(o){var s=1,a;Array.isArray(n)?a=n[parseInt(o)]:a=n[o],typeof a=="object"&&!Array.isArray(a)&&(s=a?.colSpan||1);for(var c=0;c<s;c++){var u=void 0;Array.isArray(n)?u=i.length:u=o+(c>0?"_".concat(c):"");var f={dataKey:u};i.push(f)}}),i}var Pm=function(){function t(e,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=e.getDocument()}return t}(),l7=function(t){Y5(e,t);function e(r,n,i,o,s,a){var c=t.call(this,r,n,a)||this;return c.cell=i,c.row=o,c.column=s,c.section=o.section,c}return e}(Pm),c7=function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,n,i,o,s){for(var a=0,c=r;a<c.length;a++){var u=c[a],f=new l7(e,this,n,i,o,s),y=u(f)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],y)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var n=0,i=this.hooks.didDrawPage;n<i.length;n++){var o=i[n];o(new Pm(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var n=0,i=this.hooks.willDrawPage;n<i.length;n++){var o=i[n];o(new Pm(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(i,o){return i+o.wrappedWidth},0);return r}else{var n=this.settings.margin;return e-n.left-n.right}},t}(),r_=function(){function t(e,r,n,i,o){o===void 0&&(o=!1),this.height=0,this.raw=e,e instanceof K5&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=n,this.cells=i,this.spansMultiplePages=o}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(n,i){var o;return Math.max(n,((o=r.cells[i.index])===null||o===void 0?void 0:o.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(n){var i=r.cells[n.index];return i?i.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var n=this;return e.reduce(function(i,o){var s=n.cells[o.index];if(!s)return 0;var a=r.getLineHeight(s.styles.fontSize),c=s.padding("vertical"),u=c+a;return u>i?u:i},0)},t}(),n_=function(){function t(e,r,n){var i;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=e;var o=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,o=(i=e.content)!==null&&i!==void 0?i:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var s=o!=null?""+o:"",a=/\r\n|\r|\n/g;this.text=s.split(a)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var i=this.width-this.padding("horizontal");n=this.x+i/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,i=this.styles.fontSize/e*r,o=n*i+this.padding("vertical");return Math.max(o,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=ff(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t}(),u7=function(){function t(e,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=n}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,n=0,i=e.allRows();n<i.length;n++){var o=i[n],s=o.cells[this.index];s&&typeof s.styles.cellWidth=="number"&&(r=Math.max(r,s.styles.cellWidth))}return r},t}();function d7(t,e){h7(t,e);var r=[],n=0;e.columns.forEach(function(o){var s=o.getMaxCustomCellWidth(e);s?o.width=s:(o.width=o.wrappedWidth,r.push(o)),n+=o.width});var i=e.getWidth(t.pageSize().width)-n;i&&(i=xm(r,i,function(o){return Math.max(o.minReadableWidth,o.minWidth)})),i&&(i=xm(r,i,function(o){return o.minWidth})),i=Math.abs(i),!e.settings.horizontalPageBreak&&i>.1/t.scaleFactor()&&(i=i<1?i:Math.round(i),console.warn("Of the table content, ".concat(i," units width could not fit page"))),p7(e),m7(e,t),f7(e)}function h7(t,e){var r=t.scaleFactor(),n=e.settings.horizontalPageBreak,i=X5(t,e);e.allRows().forEach(function(o){for(var s=0,a=e.columns;s<a.length;s++){var c=a[s],u=o.cells[c.index];if(u){var f=e.hooks.didParseCell;e.callCellHooks(t,f,u,o,c,null);var y=u.padding("horizontal");u.contentWidth=Oh(u.text,u.styles,t)+y;var v=Oh(u.text.join(" ").split(/[^\S\u00A0]+/),u.styles,t);if(u.minReadableWidth=v+u.padding("horizontal"),typeof u.styles.cellWidth=="number")u.minWidth=u.styles.cellWidth,u.wrappedWidth=u.styles.cellWidth;else if(u.styles.cellWidth==="wrap"||n===!0)u.contentWidth>i?(u.minWidth=i,u.wrappedWidth=i):(u.minWidth=u.contentWidth,u.wrappedWidth=u.contentWidth);else{var p=10/r;u.minWidth=u.styles.minCellWidth||p,u.wrappedWidth=u.contentWidth,u.minWidth>u.wrappedWidth&&(u.wrappedWidth=u.minWidth)}}}}),e.allRows().forEach(function(o){for(var s=0,a=e.columns;s<a.length;s++){var c=a[s],u=o.cells[c.index];if(u&&u.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,u.wrappedWidth),c.minWidth=Math.max(c.minWidth,u.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,u.minReadableWidth);else{var f=e.styles.columnStyles[c.dataKey]||e.styles.columnStyles[c.index]||{},y=f.cellWidth||f.minCellWidth;y&&typeof y=="number"&&(c.minWidth=y,c.wrappedWidth=y)}u&&(u.colSpan>1&&!c.minWidth&&(c.minWidth=u.minWidth),u.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=u.minWidth))}})}function xm(t,e,r){for(var n=e,i=t.reduce(function(p,I){return p+I.wrappedWidth},0),o=0;o<t.length;o++){var s=t[o],a=s.wrappedWidth/i,c=n*a,u=s.width+c,f=r(s),y=u<f?f:u;e-=y-s.width,s.width=y}if(e=Math.round(e*1e10)/1e10,e){var v=t.filter(function(p){return e<0?p.width>r(p):!0});v.length&&(e=xm(v,e,r))}return e}function f7(t){for(var e={},r=1,n=t.allRows(),i=0;i<n.length;i++)for(var o=n[i],s=0,a=t.columns;s<a.length;s++){var c=a[s],u=e[c.index];if(r>1)r--,delete o.cells[c.index];else if(u)u.cell.height+=o.height,r=u.cell.colSpan,delete o.cells[c.index],u.left--,u.left<=1&&delete e[c.index];else{var f=o.cells[c.index];if(!f)continue;if(f.height=o.height,f.rowSpan>1){var y=n.length-i,v=f.rowSpan>y?y:f.rowSpan;e[c.index]={cell:f,left:v,row:o}}}}}function p7(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var n=e[r],i=null,o=0,s=0,a=0;a<t.columns.length;a++){var c=t.columns[a];if(s-=1,s>1&&t.columns[a+1])o+=c.width,delete n.cells[c.index];else if(i){var u=i;delete n.cells[c.index],i=null,u.width=c.width+o}else{var u=n.cells[c.index];if(!u)continue;if(s=u.colSpan,o=0,u.colSpan>1){i=u,o+=c.width;continue}u.width=c.width+o}}}function m7(t,e){for(var r={count:0,height:0},n=0,i=t.allRows();n<i.length;n++){for(var o=i[n],s=0,a=t.columns;s<a.length;s++){var c=a[s],u=o.cells[c.index];if(u){e.applyStyles(u.styles,!0);var f=u.width-u.padding("horizontal");if(u.styles.overflow==="linebreak")u.text=e.splitTextToSize(u.text,f+1/e.scaleFactor(),{fontSize:u.styles.fontSize});else if(u.styles.overflow==="ellipsize")u.text=Z0(u.text,f,u.styles,e,"...");else if(u.styles.overflow==="hidden")u.text=Z0(u.text,f,u.styles,e,"");else if(typeof u.styles.overflow=="function"){var y=u.styles.overflow(u.text,f);typeof y=="string"?u.text=[y]:u.text=y}u.contentHeight=u.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var v=u.contentHeight/u.rowSpan;u.rowSpan>1&&r.count*r.height<v*u.rowSpan?r={height:v,count:u.rowSpan}:r&&r.count>0&&r.height>v&&(v=r.height),v>o.height&&(o.height=v)}}r.count--}}function Z0(t,e,r,n,i){return t.map(function(o){return y7(o,e,r,n,i)})}function y7(t,e,r,n,i){var o=1e4*n.scaleFactor();if(e=Math.ceil(e*o)/o,e>=Oh(t,r,n))return t;for(;e<Oh(t+i,r,n)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+i}function i_(t,e){var r=new pc(t),n=g7(e,r.scaleFactor()),i=new c7(e,n);return d7(r,i),r.applyStyles(r.userStyles),i}function g7(t,e){var r=t.content,n=b7(r.columns);if(r.head.length===0){var i=e1(n,"head");i&&r.head.push(i)}if(r.foot.length===0){var i=e1(n,"foot");i&&r.foot.push(i)}var o=t.settings.theme,s=t.styles;return{columns:n,head:_p("head",r.head,n,s,o,e),body:_p("body",r.body,n,s,o,e),foot:_p("foot",r.foot,n,s,o,e)}}function _p(t,e,r,n,i,o){var s={},a=e.map(function(c,u){for(var f=0,y={},v=0,p=0,I=0,P=r;I<P.length;I++){var w=P[I];if(s[w.index]==null||s[w.index].left===0)if(p===0){var x=void 0;Array.isArray(c)?x=c[w.index-v-f]:x=c[w.dataKey];var j={};typeof x=="object"&&!Array.isArray(x)&&(j=x?.styles||{});var ne=_7(t,w,u,i,n,o,j),Q=new n_(x,ne,t);y[w.dataKey]=Q,y[w.index]=Q,p=Q.colSpan-1,s[w.index]={left:Q.rowSpan-1,times:p}}else p--,v++;else s[w.index].left--,p=s[w.index].times,f++}return new r_(c,u,t,y)});return a}function e1(t,e){var r={};return t.forEach(function(n){if(n.raw!=null){var i=v7(e,n.raw);i!=null&&(r[n.dataKey]=i)}}),Object.keys(r).length>0?r:null}function v7(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function b7(t){return t.map(function(e,r){var n,i;return typeof e=="object"?i=(n=e.dataKey)!==null&&n!==void 0?n:r:i=r,new u7(i,e,r)})}function _7(t,e,r,n,i,o,s){var a=KL(n),c;t==="head"?c=i.headStyles:t==="body"?c=i.bodyStyles:t==="foot"&&(c=i.footStyles);var u=Es({},a.table,a[t],i.styles,c),f=i.columnStyles[e.dataKey]||i.columnStyles[e.index]||{},y=t==="body"?f:{},v=t==="body"&&r%2===0?Es({},a.alternateRow,i.alternateRowStyles):{},p=YL(o),I=Es({},p,u,v,y);return Es(I,s)}function w7(t,e,r){var n;r===void 0&&(r={});var i=X5(t,e),o=new Map,s=[],a=[],c=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?c=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(c=[e.settings.horizontalPageBreakRepeat]),c.forEach(function(v){var p=e.columns.find(function(I){return I.dataKey===v||I.index===v});p&&!o.has(p.index)&&(o.set(p.index,!0),s.push(p.index),a.push(e.columns[p.index]),i-=p.wrappedWidth)});for(var u=!0,f=(n=r?.start)!==null&&n!==void 0?n:0;f<e.columns.length;){if(o.has(f)){f++;continue}var y=e.columns[f].wrappedWidth;if(u||i>=y)u=!1,s.push(f),a.push(e.columns[f]),i-=y;else break;f++}return{colIndexes:s,columns:a,lastIndex:f-1}}function S7(t,e){for(var r=[],n=0;n<e.columns.length;n++){var i=w7(t,e,{start:n});i.columns.length&&(r.push(i),n=i.lastIndex)}return r}function o_(t,e){var r=e.settings,n=r.startY,i=r.margin,o={x:i.left,y:n},s=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),a=n+i.bottom+s;if(r.pageBreak==="avoid"){var c=e.body,u=c.reduce(function(v,p){return v+p.height},0);a+=u}var f=new pc(t);(r.pageBreak==="always"||r.startY!=null&&a>f.pageSize().height)&&(a_(f),o.y=i.top),e.callWillDrawPageHooks(f,o);var y=Es({},o);e.startPageNumber=f.pageNumber(),r.horizontalPageBreak?P7(f,e,y,o):(f.applyStyles(f.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(v){return Os(f,e,v,o,e.columns)}),f.applyStyles(f.userStyles),e.body.forEach(function(v,p){var I=p===e.body.length-1;Bh(f,e,v,I,y,o,e.columns)}),f.applyStyles(f.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(v){return Os(f,e,v,o,e.columns)})),J5(f,e,y,o),e.callEndPageHooks(f,o),e.finalY=o.y,t.lastAutoTable=e,f.applyStyles(f.userStyles)}function P7(t,e,r,n){var i=S7(t,e),o=e.settings;if(o.horizontalPageBreakBehaviour==="afterAllRows")i.forEach(function(u,f){t.applyStyles(t.userStyles),f>0?Su(t,e,r,n,u.columns,!0):t1(t,e,n,u.columns),x7(t,e,r,n,u.columns),wp(t,e,n,u.columns)});else for(var s=-1,a=i[0],c=function(){var u=s;if(a){t.applyStyles(t.userStyles);var f=a.columns;s>=0?Su(t,e,r,n,f,!0):t1(t,e,n,f),u=r1(t,e,s+1,n,f),wp(t,e,n,f)}var y=u-s;i.slice(1).forEach(function(v){t.applyStyles(t.userStyles),Su(t,e,r,n,v.columns,!0),r1(t,e,s+1,n,v.columns,y),wp(t,e,n,v.columns)}),s=u};s<e.body.length-1;)c()}function t1(t,e,r,n){var i=e.settings;t.applyStyles(t.userStyles),(i.showHead==="firstPage"||i.showHead==="everyPage")&&e.head.forEach(function(o){return Os(t,e,o,r,n)})}function x7(t,e,r,n,i){t.applyStyles(t.userStyles),e.body.forEach(function(o,s){var a=s===e.body.length-1;Bh(t,e,o,a,r,n,i)})}function r1(t,e,r,n,i,o){t.applyStyles(t.userStyles),o=o??e.body.length;var s=Math.min(r+o,e.body.length),a=-1;return e.body.slice(r,s).forEach(function(c,u){var f=r+u===e.body.length-1,y=s_(t,e,f,n);c.canEntireRowFit(y,i)&&(Os(t,e,c,n,i),a=r+u)}),a}function wp(t,e,r,n){var i=e.settings;t.applyStyles(t.userStyles),(i.showFoot==="lastPage"||i.showFoot==="everyPage")&&e.foot.forEach(function(o){return Os(t,e,o,r,n)})}function A7(t,e,r){var n=r.getLineHeight(t.styles.fontSize),i=t.padding("vertical"),o=Math.floor((e-i)/n);return Math.max(0,o)}function C7(t,e,r,n){var i={};t.spansMultiplePages=!0,t.height=0;for(var o=0,s=0,a=r.columns;s<a.length;s++){var c=a[s],u=t.cells[c.index];if(u){Array.isArray(u.text)||(u.text=[u.text]);var f=new n_(u.raw,u.styles,u.section);f=Es(f,u),f.text=[];var y=A7(u,e,n);u.text.length>y&&(f.text=u.text.splice(y,u.text.length));var v=n.scaleFactor(),p=n.getLineHeightFactor();u.contentHeight=u.getContentHeight(v,p),u.contentHeight>=e&&(u.contentHeight=e,f.styles.minCellHeight-=e),u.contentHeight>t.height&&(t.height=u.contentHeight),f.contentHeight=f.getContentHeight(v,p),f.contentHeight>o&&(o=f.contentHeight),i[c.index]=f}}var I=new r_(t.raw,-1,t.section,i,!0);I.height=o;for(var P=0,w=r.columns;P<w.length;P++){var c=w[P],f=I.cells[c.index];f&&(f.height=I.height);var u=t.cells[c.index];u&&(u.height=t.height)}return I}function I7(t,e,r,n){var i=t.pageSize().height,o=n.settings.margin,s=o.top+o.bottom,a=i-s;e.section==="body"&&(a-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=e.getMinimumRowHeight(n.columns,t),u=c<r;if(c>a)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!u)return!1;var f=e.hasRowSpan(n.columns),y=e.getMaxCellHeight(n.columns)>a;return y?(f&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(f||n.settings.rowPageBreak==="avoid")}function Bh(t,e,r,n,i,o,s){var a=s_(t,e,n,o);if(r.canEntireRowFit(a,s))Os(t,e,r,o,s);else if(I7(t,r,a,e)){var c=C7(r,a,e,t);Os(t,e,r,o,s),Su(t,e,i,o,s),Bh(t,e,c,n,i,o,s)}else Su(t,e,i,o,s),Bh(t,e,r,n,i,o,s)}function Os(t,e,r,n,i){n.x=e.settings.margin.left;for(var o=0,s=i;o<s.length;o++){var a=s[o],c=r.cells[a.index];if(!c){n.x+=a.width;continue}t.applyStyles(c.styles),c.x=n.x,c.y=n.y;var u=e.callCellHooks(t,e.hooks.willDrawCell,c,r,a,n);if(u===!1){n.x+=a.width;continue}$7(t,c,n);var f=c.getTextPos();G5(c.text,f.x,f.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,c,r,a,n),n.x+=a.width}n.y+=r.height}function $7(t,e,r){var n=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof n.lineWidth=="number"){var i=Q5(n.lineWidth,n.fillColor);i&&t.rect(e.x,r.y,e.width,e.height,i)}else typeof n.lineWidth=="object"&&(n.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),k7(t,e,r,n.lineWidth))}function k7(t,e,r,n){var i,o,s,a;n.top&&(i=r.x,o=r.y,s=r.x+e.width,a=r.y,n.right&&(s+=.5*n.right),n.left&&(i-=.5*n.left),c(n.top,i,o,s,a)),n.bottom&&(i=r.x,o=r.y+e.height,s=r.x+e.width,a=r.y+e.height,n.right&&(s+=.5*n.right),n.left&&(i-=.5*n.left),c(n.bottom,i,o,s,a)),n.left&&(i=r.x,o=r.y,s=r.x,a=r.y+e.height,n.top&&(o-=.5*n.top),n.bottom&&(a+=.5*n.bottom),c(n.left,i,o,s,a)),n.right&&(i=r.x+e.width,o=r.y,s=r.x+e.width,a=r.y+e.height,n.top&&(o-=.5*n.top),n.bottom&&(a+=.5*n.bottom),c(n.right,i,o,s,a));function c(u,f,y,v,p){t.getDocument().setLineWidth(u),t.getDocument().line(f,y,v,p,"S")}}function s_(t,e,r,n){var i=e.settings.margin.bottom,o=e.settings.showFoot;return(o==="everyPage"||o==="lastPage"&&r)&&(i+=e.getFootHeight(e.columns)),t.pageSize().height-n.y-i}function Su(t,e,r,n,i,o){i===void 0&&(i=[]),o===void 0&&(o=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!o&&e.foot.forEach(function(a){return Os(t,e,a,n,i)}),e.callEndPageHooks(t,n);var s=e.settings.margin;J5(t,e,r,n),a_(t),e.pageNumber++,n.x=s.left,n.y=s.top,r.y=s.top,e.callWillDrawPageHooks(t,n),e.settings.showHead==="everyPage"&&(e.head.forEach(function(a){return Os(t,e,a,n,i)}),t.applyStyles(t.userStyles))}function a_(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function E7(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e[0],i=t_(this,n),o=i_(this,i);return o_(this,o),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,n,i){G5(e,r,n,i,this)},t.API.autoTableSetDefaults=function(e){return pc.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){pc.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var i=new pc(this),o=e_(i,e,window,r,!1),s=o.head,a=o.body,c=((n=s[0])===null||n===void 0?void 0:n.map(function(u){return u.content}))||[];return{columns:c,rows:a,data:a}}}var Sp;function iR(t,e){var r=t_(t,e),n=i_(t,r);o_(t,n)}try{if(typeof window<"u"&&window){var n1=window,i1=n1.jsPDF||((Sp=n1.jspdf)===null||Sp===void 0?void 0:Sp.jsPDF);i1&&E7(i1)}}catch(t){console.error("Could not apply autoTable plugin",t)}var T7=ue("<div><div><label></label><select><option value=all></option></select></div><div><label></label><select><option value=all></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label></div><div><label>"),N7=ue("<div><div><div></div></div><div><div> <!> <!> <!> </div><div>"),L7=ue("<div><div>"),Gd=ue("<option>"),D7=ue("<div><div><div><div></div><div></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div></div><div><div></div><div></div></div></div><div><div><span>: </span><span></span></div><div><span>: </span><span></span></div><div><span>: </span><span></span></div><div><span>: </span><span> kg</span></div><div><span>: </span><span></span></div><div><span>: </span><span>");const R7=t=>{const{t:e}=tr(),[r,n]=$e(""),[i,o]=$e("all"),[s,a]=$e({start:"",end:""}),[c,u]=$e(""),[f,y]=$e(""),[v,p]=$e(!1),[I,P]=$e("all"),w=Nt(()=>{let _=t.hbls;var S="";if(r()&&(S+=r().toLowerCase()),r()){const b=r().toLowerCase();_=_.filter(Y=>Y.hbl.toLowerCase().includes(b)||Y.idairguide.toLowerCase().includes(b)||Y.nameshipper.toLowerCase().includes(b)||Y.consigneeName.toLowerCase().includes(b)||Y.namegood.toLowerCase().includes(b)||Y.bagnumber.toLowerCase().includes(b)||Y.cidentity.toLowerCase().includes(b))}return i()!=="all"&&(_=_.filter(b=>b.idguidestate===i())),I()!=="all"&&(_=_.filter(b=>b.idclasification===I())),(s().start||s().end)&&(_=_.filter(b=>{const Y=new Date(b.datereserve),te=s().start?new Date(s().start):new Date("1900-01-01"),O=s().end?new Date(s().end):new Date("2100-12-31");return Y>=te&&Y<=O})),c()&&(_=_?.filter(b=>b.nameshipper.toLowerCase().includes(c().toLowerCase()))),f()&&(_=_?.filter(b=>b.consigneeName.toLowerCase().includes(f().toLowerCase()))),_=_?.sort((b,Y)=>new Date(Y.datereserve).getTime()-new Date(b.datereserve).getTime()),t.onFilterChange?.(_),_}),x=Nt(()=>{const _=new Set(t.hbls.map(S=>S.nameshipper));return Array.from(_).sort()}),j=Nt(()=>{const _=new Set(t.hbls.map(S=>S.consigneeName));return Array.from(_).sort()}),ne=Nt(()=>{const _=new Set(t.hbls.map(S=>S.idguidestate));return Array.from(_).sort()}),Q=Nt(()=>{const _=new Set(t.hbls.map(S=>S.idclasification));return Array.from(_).sort()}),K=()=>{n(""),o("all"),a({start:"",end:""}),u(""),y(""),P("all")},Z=()=>{const _=["HBL Number","Air Guide","Status","Classification","Shipper","Consignee","Identity","Phone","City","Commodity","Weight (kg)","Quantity","Bag Number","Reserve Date"],S=w().map(D=>[D.hbl,D.idairguide,D.idguidestate,D.idclasification,D.nameshipper,D.consigneeName,D.cidentity,D.phoneshipper,D.address.city,D.namegood,D.weight,D.quantity,D.bagnumber,new Date(D.datereserve).toLocaleDateString()]),b=[_.join(","),...S.map(D=>D.map(X=>`"${X}"`).join(","))].join(`
`),Y=new Blob([b],{type:"text/csv"}),te=URL.createObjectURL(Y),O=document.createElement("a");O.href=te,O.download=`HBL_List_${new Date().toISOString().split("T")[0]}.csv`,O.click(),URL.revokeObjectURL(te)},k=()=>{const _=["HBL Number","Air Guide","Air Number","Status","Classification","Shipper","Consignee","Identity","Shipper Phone","Consignee Phone","Street","City","State","Commodity","Weight (kg)","Quantity","Bag Number","Agency","Guide","Reserve Date"];w().map(D=>[D.hbl,D.idairguide,D.idairnumber,D.idguidestate,D.idclasification,D.nameshipper,D.consigneeName,D.cidentity,D.phoneshipper,D.ctelephone,D.street,D.address.city,D.address.estate,D.namegood,D.weight,D.quantity,D.bagnumber,D.agency,D.guia,new Date(D.datereserve).toLocaleDateString()]);const S=w().map(D=>[D.hbl,D.idclasification,D.idairguide,D.idairnumber,D.idguidestate,D.nameshipper,D.consigneeName,D.cidentity,D.phoneshipper,D.ctelephone,D.street,D.address.city,D.address.estate,D.namegood,D.weight,D.quantity,D.bagnumber,D.agency,D.guia,new Date(D.datereserve).toLocaleDateString()]),b=[_.join("	"),...S.map(D=>D.join("	"))].join(`
`),Y=new Blob([b],{type:"application/vnd.ms-excel"}),te=URL.createObjectURL(Y),O=document.createElement("a");O.href=te,O.download=`HBL_List_${new Date().toISOString().split("T")[0]}.xls`,O.click(),URL.revokeObjectURL(te)},C=()=>{const _=new sr;_.setFontSize(16),_.text("House Bill of Lading List",14,15),_.setFontSize(10),_.text(`Generated: ${new Date().toLocaleString()}`,14,25),_.setFontSize(10);let S=35;r()&&(_.text(`Search: ${r()}`,14,S),S+=5),i()!=="all"&&(_.text(`Status: ${i()}`,14,S),S+=5);const b=["HBL#","Status","Shipper","Consignee","City","Weight","Commodity"],Y=w().map(te=>[te.hbl,te.idguidestate,te.nameshipper.substring(0,20)+(te.nameshipper.length>20?"...":""),te.consigneeName.substring(0,20)+(te.consigneeName.length>20?"...":""),te.address.city,te.weight+" kg",te.namegood.substring(0,15)+(te.namegood.length>15?"...":"")]);_.autoTable({head:[b],body:Y,startY:S+5,styles:{fontSize:8},headStyles:{fillColor:[0,123,255]}}),_.save(`HBL_List_${new Date().toISOString().split("T")[0]}.pdf`)},E=_=>_?new Date(_).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-",M=_=>({"EN BODEGA":"#17a2b8",ENVIADO:"#007bff",ENTREGADO:"#28a745",CANCELADO:"#dc3545",PENDIENTE:"#ffc107"})[_]||"#6c757d";return(()=>{var _=L7(),S=_.firstChild;return l(_,B(Tt,{get children(){var b=N7(),Y=b.firstChild,te=Y.firstChild,O=Y.nextSibling,D=O.firstChild,X=D.firstChild,H=X.nextSibling,F=H.nextSibling,ie=F.nextSibling,$=ie.nextSibling,L=$.nextSibling;L.nextSibling;var U=D.nextSibling;return b.style.setProperty("padding","1rem"),Y.style.setProperty("display","grid"),Y.style.setProperty("grid-template-columns","1fr auto"),Y.style.setProperty("gap","1rem"),Y.style.setProperty("margin-bottom","1rem"),l(Y,B(Or,{type:"text",get placeholder(){return e("hbl.searchPlaceholder","Search by HBL#, air guide, shipper, consignee, commodity, bag#, identity...")},get value(){return r()},onInput:N=>n(N.currentTarget.value)}),te),te.style.setProperty("display","flex"),te.style.setProperty("gap","0.5rem"),l(te,B(Pt,{variant:"outline",size:"sm",onClick:()=>p(!v()),get children(){return Te(()=>!!v())()?e("common.hideFilters","Hide Filters"):e("common.showFilters","Show Filters")}}),null),l(te,B(Pt,{variant:"outline",size:"sm",onClick:K,get children(){return e("common.clearFilters","Clear Filters")}}),null),l(b,B(Ge,{get when(){return v()},get children(){var N=T7(),z=N.firstChild,oe=z.firstChild,G=oe.nextSibling,ee=G.firstChild,J=z.nextSibling,W=J.firstChild,q=W.nextSibling,ae=q.firstChild,de=J.nextSibling,le=de.firstChild,V=le.nextSibling,ce=V.firstChild,Pe=de.nextSibling,fe=Pe.firstChild,be=fe.nextSibling,xe=be.firstChild,he=Pe.nextSibling,ve=he.firstChild,De=he.nextSibling,Ee=De.firstChild;return N.style.setProperty("display","grid"),N.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),N.style.setProperty("gap","1rem"),N.style.setProperty("margin-bottom","1rem"),N.style.setProperty("padding","1rem"),N.style.setProperty("background","var(--background-color)"),N.style.setProperty("border-radius","var(--border-radius-sm)"),oe.style.setProperty("display","block"),oe.style.setProperty("margin-bottom","0.25rem"),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),l(oe,()=>e("common.status","Status")),G.addEventListener("change",Ce=>o(Ce.currentTarget.value)),G.style.setProperty("width","100%"),G.style.setProperty("padding","0.5rem"),G.style.setProperty("border","1px solid var(--border-color)"),G.style.setProperty("border-radius","var(--border-radius-sm)"),G.style.setProperty("background","var(--surface-color)"),l(ee,()=>e("common.all","All")),l(G,B(Ht,{get each(){return ne()},children:Ce=>(()=>{var Ne=Gd();return Ne.value=Ce,l(Ne,Ce),Ne})()}),null),W.style.setProperty("display","block"),W.style.setProperty("margin-bottom","0.25rem"),W.style.setProperty("font-size","0.875rem"),W.style.setProperty("color","var(--text-muted)"),l(W,()=>e("hbl.classification","Classification")),q.addEventListener("change",Ce=>P(Ce.currentTarget.value)),q.style.setProperty("width","100%"),q.style.setProperty("padding","0.5rem"),q.style.setProperty("border","1px solid var(--border-color)"),q.style.setProperty("border-radius","var(--border-radius-sm)"),q.style.setProperty("background","var(--surface-color)"),l(ae,()=>e("common.all","All")),l(q,B(Ht,{get each(){return Q()},children:Ce=>(()=>{var Ne=Gd();return Ne.value=Ce,l(Ne,Ce),Ne})()}),null),le.style.setProperty("display","block"),le.style.setProperty("margin-bottom","0.25rem"),le.style.setProperty("font-size","0.875rem"),le.style.setProperty("color","var(--text-muted)"),l(le,()=>e("hbl.shipper","Shipper")),V.addEventListener("change",Ce=>u(Ce.currentTarget.value)),V.style.setProperty("width","100%"),V.style.setProperty("padding","0.5rem"),V.style.setProperty("border","1px solid var(--border-color)"),V.style.setProperty("border-radius","var(--border-radius-sm)"),V.style.setProperty("background","var(--surface-color)"),l(ce,()=>e("common.all","All")),l(V,B(Ht,{get each(){return x()},children:Ce=>(()=>{var Ne=Gd();return Ne.value=Ce,l(Ne,Ce),Ne})()}),null),fe.style.setProperty("display","block"),fe.style.setProperty("margin-bottom","0.25rem"),fe.style.setProperty("font-size","0.875rem"),fe.style.setProperty("color","var(--text-muted)"),l(fe,()=>e("hbl.consignee","Consignee")),be.addEventListener("change",Ce=>y(Ce.currentTarget.value)),be.style.setProperty("width","100%"),be.style.setProperty("padding","0.5rem"),be.style.setProperty("border","1px solid var(--border-color)"),be.style.setProperty("border-radius","var(--border-radius-sm)"),be.style.setProperty("background","var(--surface-color)"),l(xe,()=>e("common.all","All")),l(be,B(Ht,{get each(){return j()},children:Ce=>(()=>{var Ne=Gd();return Ne.value=Ce,l(Ne,Ce),Ne})()}),null),ve.style.setProperty("display","block"),ve.style.setProperty("margin-bottom","0.25rem"),ve.style.setProperty("font-size","0.875rem"),ve.style.setProperty("color","var(--text-muted)"),l(ve,()=>e("common.dateFrom","Date From")),l(he,B(Or,{type:"date",get value(){return s().start},onInput:Ce=>a({...s(),start:Ce.currentTarget.value})}),null),Ee.style.setProperty("display","block"),Ee.style.setProperty("margin-bottom","0.25rem"),Ee.style.setProperty("font-size","0.875rem"),Ee.style.setProperty("color","var(--text-muted)"),l(Ee,()=>e("common.dateTo","Date To")),l(De,B(Or,{type:"date",get value(){return s().end},onInput:Ce=>a({...s(),end:Ce.currentTarget.value})}),null),Se(()=>G.value=i()),Se(()=>q.value=I()),Se(()=>V.value=c()),Se(()=>be.value=f()),N}}),O),O.style.setProperty("display","flex"),O.style.setProperty("justify-content","space-between"),O.style.setProperty("align-items","center"),O.style.setProperty("margin-bottom","1rem"),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("color","var(--text-muted)"),l(D,()=>e("common.showing","Showing"),X),l(D,()=>w().length,H),l(D,()=>e("common.of","of"),ie),l(D,()=>t.hbls.length,L),l(D,()=>e("hbl.records","records"),null),U.style.setProperty("display","flex"),U.style.setProperty("gap","0.5rem"),l(U,B(Pt,{variant:"outline",size:"sm",onClick:C,get children(){return e("common.print","Print")}}),null),l(U,B(Pt,{variant:"outline",size:"sm",onClick:Z,get children(){return e("common.exportCSV","Export CSV")}}),null),l(U,B(Pt,{variant:"outline",size:"sm",onClick:k,get children(){return e("common.exportExcel","Export Excel")}}),null),b}}),S),S.style.setProperty("margin-top","1rem"),l(S,B(Ht,{get each(){return w()},children:b=>B(Tt,{style:{"margin-bottom":"0.5rem"},get children(){var Y=D7(),te=Y.firstChild,O=te.firstChild,D=O.firstChild,X=D.nextSibling,H=O.nextSibling,F=H.firstChild,ie=F.firstChild,$=ie.nextSibling,L=F.nextSibling,U=L.firstChild,N=U.nextSibling,z=H.nextSibling,oe=z.firstChild,G=oe.nextSibling,ee=te.nextSibling,J=ee.firstChild,W=J.firstChild,q=W.firstChild,ae=W.nextSibling,de=J.nextSibling,le=de.firstChild,V=le.firstChild,ce=le.nextSibling,Pe=de.nextSibling,fe=Pe.firstChild,be=fe.firstChild,xe=fe.nextSibling,he=Pe.nextSibling,ve=he.firstChild,De=ve.firstChild,Ee=ve.nextSibling,Ce=Ee.firstChild,Ne=he.nextSibling,Ie=Ne.firstChild,Re=Ie.firstChild,We=Ie.nextSibling,Fe=Ne.nextSibling,Xe=Fe.firstChild,tt=Xe.firstChild,At=Xe.nextSibling;return Y.addEventListener("mouseleave",rt=>{rt.currentTarget.style.backgroundColor="transparent"}),Y.addEventListener("mouseenter",rt=>{rt.currentTarget.style.backgroundColor="var(--strip-color)"}),Y.$$click=()=>t.onHBLSelect?.(b),Y.style.setProperty("padding","1rem"),Y.style.setProperty("cursor","pointer"),Y.style.setProperty("transition","background-color 0.2s"),te.style.setProperty("display","grid"),te.style.setProperty("grid-template-columns","150px 1fr auto"),te.style.setProperty("gap","1rem"),te.style.setProperty("align-items","center"),D.style.setProperty("font-weight","600"),D.style.setProperty("color","var(--primary-color)"),l(D,()=>b.hbl),X.style.setProperty("font-size","0.75rem"),X.style.setProperty("color","var(--text-muted)"),l(X,()=>b.idairguide),H.style.setProperty("display","grid"),H.style.setProperty("grid-template-columns","1fr 1fr"),H.style.setProperty("gap","1rem"),ie.style.setProperty("font-size","0.75rem"),ie.style.setProperty("color","var(--text-muted)"),l(ie,()=>e("hbl.shipper","Shipper")),$.style.setProperty("font-weight","500"),l($,()=>b.nameshipper),U.style.setProperty("font-size","0.75rem"),U.style.setProperty("color","var(--text-muted)"),l(U,()=>e("hbl.consignee","Consignee")),N.style.setProperty("font-weight","500"),l(N,()=>b.consigneeName),z.style.setProperty("text-align","right"),oe.style.setProperty("display","inline-block"),oe.style.setProperty("padding","0.25rem 0.75rem"),oe.style.setProperty("border-radius","var(--border-radius-sm)"),oe.style.setProperty("font-size","0.75rem"),oe.style.setProperty("font-weight","500"),oe.style.setProperty("color","white"),l(oe,()=>b.idguidestate),G.style.setProperty("font-size","0.75rem"),G.style.setProperty("color","var(--text-muted)"),G.style.setProperty("margin-top","0.25rem"),l(G,()=>E(b.datereserve)),ee.style.setProperty("margin-top","0.75rem"),ee.style.setProperty("display","grid"),ee.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),ee.style.setProperty("gap","0.5rem"),ee.style.setProperty("font-size","0.875rem"),W.style.setProperty("color","var(--text-muted)"),l(W,()=>e("hbl.city","City"),q),ae.style.setProperty("font-weight","500"),l(ae,()=>b.address.city),le.style.setProperty("color","var(--text-muted)"),l(le,()=>e("hbl.classification","Class"),V),ce.style.setProperty("font-weight","500"),l(ce,()=>b.idclasification),fe.style.setProperty("color","var(--text-muted)"),l(fe,()=>e("hbl.commodity","Commodity"),be),xe.style.setProperty("font-weight","500"),l(xe,()=>b.namegood),ve.style.setProperty("color","var(--text-muted)"),l(ve,()=>e("hbl.weight","Weight"),De),Ee.style.setProperty("font-weight","500"),l(Ee,()=>b.weight,Ce),Ie.style.setProperty("color","var(--text-muted)"),l(Ie,()=>e("hbl.bagNumber","Bag#"),Re),We.style.setProperty("font-weight","500"),l(We,()=>b.bagnumber),Xe.style.setProperty("color","var(--text-muted)"),l(Xe,()=>e("hbl.guideNo","Guide No."),tt),At.style.setProperty("font-weight","500"),l(At,()=>b.guia),Se(rt=>(rt=M(b.idguidestate))!=null?oe.style.setProperty("background-color",rt):oe.style.removeProperty("background-color")),Y}})})),_})()};ur(["click"]);var M7=ue("<div><div><label></label><select><option value=all>"),F7=ue("<div><div><h2>HBL: </h2><button></button></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong><span></span></div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> <!>, </div><div><strong>:</strong> </div><div><strong>:</strong> <!> kg</div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),O7=ue("<div>"),B7=ue("<div><div><h1></h1><button>"),j7=ue("<option> ");const V7=()=>{const{t}=tr(),[e,r]=$e([]),[n,i]=$e(null),[o,s]=$e([]),[a,c]=$e("all"),u=I=>{i(I)},f=I=>{s(I)},y=I=>{c(I),v()},v=async()=>{let I=await Ai.getHBLS("230",{guia:a()});I?.error?r([]):r(Object.values(I))};Nn(()=>{});const p=Nt(()=>{const I=new Set([2516,2517,2518,2519,2520,2521].map(P=>P));return Array.from(I).sort((P,w)=>P-w)});return(()=>{var I=B7(),P=I.firstChild,w=P.firstChild,x=w.nextSibling;return I.style.setProperty("padding","1rem"),P.style.setProperty("margin-bottom","2rem"),P.style.setProperty("display","flex"),P.style.setProperty("justify-content","space-between"),P.style.setProperty("align-items","center"),w.style.setProperty("font-size","1.5rem"),w.style.setProperty("font-weight","600"),w.style.setProperty("color","var(--text-primary)"),l(w,()=>t("hbl.title","House Bill of Lading Management")),x.style.setProperty("padding","0.75rem 1.5rem"),x.style.setProperty("background","var(--primary-color)"),x.style.setProperty("color","white"),x.style.setProperty("border","none"),x.style.setProperty("border-radius","var(--border-radius-sm)"),x.style.setProperty("cursor","pointer"),x.style.setProperty("font-weight","500"),l(x,()=>t("hbl.addNew","Add New HBL")),l(I,B(Tt,{get children(){var j=M7(),ne=j.firstChild,Q=ne.firstChild,K=Q.nextSibling,Z=K.firstChild;return j.style.setProperty("padding","1rem"),ne.style.setProperty("width","13rem"),Q.style.setProperty("display","block"),Q.style.setProperty("margin-bottom","0.25rem"),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),l(Q,()=>t("hbl.guideNumber","Guide Number")),K.addEventListener("change",k=>y(k.currentTarget.value)),K.style.setProperty("width","100%"),K.style.setProperty("padding","0.5rem"),K.style.setProperty("border","1px solid var(--border-color)"),K.style.setProperty("border-radius","var(--border-radius-sm)"),K.style.setProperty("background","var(--surface-color)"),l(Z,()=>t("common.all","All")),l(K,B(Ht,{get each(){return p()},children:k=>(()=>{var C=j7(),E=C.firstChild;return C.value=k,l(C,()=>t("hbl.guideNo","Guide No."),E),l(C,k,null),C})()}),null),Se(()=>K.value=a()),j}}),null),l(I,B(R7,{get hbls(){return e()},onFilterChange:f,onHBLSelect:u}),null),l(I,B(Ge,{get when(){return n()},get children(){var j=O7();return j.style.setProperty("position","fixed"),j.style.setProperty("top","0"),j.style.setProperty("left","0"),j.style.setProperty("right","0"),j.style.setProperty("bottom","0"),j.style.setProperty("background","rgba(0, 0, 0, 0.5)"),j.style.setProperty("display","flex"),j.style.setProperty("align-items","center"),j.style.setProperty("justify-content","center"),j.style.setProperty("z-index","1000"),l(j,B(Tt,{style:{width:"90%","max-width":"600px","max-height":"90vh","overflow-y":"auto"},get children(){var ne=F7(),Q=ne.firstChild,K=Q.firstChild;K.firstChild;var Z=K.nextSibling,k=Q.nextSibling,C=k.firstChild,E=C.firstChild,M=E.firstChild;E.nextSibling;var _=C.nextSibling,S=_.firstChild,b=S.firstChild;S.nextSibling;var Y=_.nextSibling,te=Y.firstChild,O=te.firstChild,D=te.nextSibling,X=Y.nextSibling,H=X.firstChild,F=H.firstChild;H.nextSibling;var ie=X.nextSibling,$=ie.firstChild,L=$.firstChild;$.nextSibling;var U=ie.nextSibling,N=U.firstChild,z=N.firstChild;N.nextSibling;var oe=U.nextSibling,G=oe.firstChild,ee=G.firstChild;G.nextSibling;var J=oe.nextSibling,W=J.firstChild,q=W.firstChild;W.nextSibling;var ae=J.nextSibling,de=ae.firstChild,le=de.firstChild;de.nextSibling;var V=ae.nextSibling,ce=V.firstChild,Pe=ce.firstChild;ce.nextSibling;var fe=V.nextSibling,be=fe.firstChild,xe=be.firstChild,he=be.nextSibling,ve=he.nextSibling;ve.nextSibling;var De=fe.nextSibling,Ee=De.firstChild,Ce=Ee.firstChild;Ee.nextSibling;var Ne=De.nextSibling,Ie=Ne.firstChild,Re=Ie.firstChild,We=Ie.nextSibling,Fe=We.nextSibling;Fe.nextSibling;var Xe=Ne.nextSibling,tt=Xe.firstChild,At=tt.firstChild;tt.nextSibling;var rt=Xe.nextSibling,He=rt.firstChild,xt=He.firstChild;He.nextSibling;var _t=rt.nextSibling,mt=_t.firstChild,Et=mt.firstChild;mt.nextSibling;var et=_t.nextSibling,qe=et.firstChild,ot=qe.firstChild;qe.nextSibling;var Je=et.nextSibling,at=Je.firstChild,dt=at.firstChild;return at.nextSibling,ne.style.setProperty("padding","2rem"),Q.style.setProperty("display","flex"),Q.style.setProperty("justify-content","space-between"),Q.style.setProperty("align-items","center"),Q.style.setProperty("margin-bottom","1.5rem"),K.style.setProperty("font-size","1.25rem"),K.style.setProperty("font-weight","600"),l(K,()=>n().hbl,null),Z.$$click=()=>i(null),Z.style.setProperty("background","none"),Z.style.setProperty("border","none"),Z.style.setProperty("font-size","1.5rem"),Z.style.setProperty("cursor","pointer"),Z.style.setProperty("color","var(--text-muted)"),k.style.setProperty("display","grid"),k.style.setProperty("gap","1rem"),l(E,()=>t("hbl.airGuide","Air Guide"),M),l(C,()=>n().idairguide,null),l(S,()=>t("hbl.airNumber","Air Number"),b),l(_,()=>n().idairnumber,null),l(te,()=>t("hbl.status","Status"),O),D.style.setProperty("margin-left","0.5rem"),D.style.setProperty("padding","0.25rem 0.75rem"),D.style.setProperty("border-radius","var(--border-radius-sm)"),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("color","white"),l(D,()=>n().idguidestate),l(H,()=>t("hbl.classification","Classification"),F),l(X,()=>n().idclasification,null),l($,()=>t("hbl.shipper","Shipper"),L),l(ie,()=>n().nameshipper,null),l(N,()=>t("hbl.shipperPhone","Shipper Phone"),z),l(U,()=>n().phoneshipper,null),l(G,()=>t("hbl.consignee","Consignee"),ee),l(oe,()=>n().consigneeName,null),l(W,()=>t("hbl.consigneePhone","Consignee Phone"),q),l(J,()=>n().ctelephone,null),l(de,()=>t("hbl.identity","Identity"),le),l(ae,()=>n().cidentity,null),l(ce,()=>t("hbl.address","Address"),Pe),l(V,()=>n().street,null),l(be,()=>t("hbl.city","City"),xe),l(fe,()=>n().address.city,ve),l(fe,()=>n().address.estate,null),l(Ee,()=>t("hbl.commodity","Commodity"),Ce),l(De,()=>n().namegood,null),l(Ie,()=>t("hbl.weight","Weight"),Re),l(Ne,()=>n().weight,Fe),l(tt,()=>t("hbl.quantity","Quantity"),At),l(Xe,()=>n().quantity,null),l(He,()=>t("hbl.bagNumber","Bag Number"),xt),l(rt,()=>n().bagnumber,null),l(mt,()=>t("hbl.agency","Agency"),Et),l(_t,()=>n().agency,null),l(qe,()=>t("hbl.guide","Guide"),ot),l(et,()=>n().guia,null),l(at,()=>t("hbl.reserveDate","Reserve Date"),dt),l(Je,()=>new Date(n().datereserve).toLocaleDateString(),null),Se(It=>(It=n().idguidestate==="ENTREGADO"?"#28a745":n().idguidestate==="ENVIADO"?"#17a2b8":n().idguidestate==="EN BODEGA"?"#007bff":"#6c757d")!=null?D.style.setProperty("background-color",It):D.style.removeProperty("background-color")),ne}})),j}}),null),I})()};ur(["click"]);var z7=ue("<div>$124,350"),q7=ue("<div>+12% from last month"),U7=ue("<div>247"),ec=ue("<div>"),H7=ue("<div>18"),W7=ue("<div>$89,250"),G7=ue("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const Y7=()=>{const{t}=tr(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},n={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)",margin:"0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"};return B(ro,{get title(){return t("dashboard.title")},get children(){return[(()=>{var o=ec();return m(o,e),l(o,B(Tt,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var s=z7();return Se(a=>m(s,n,a)),s})(),(()=>{var s=q7();return Se(a=>m(s,i,a)),s})()]}}),null),l(o,B(Tt,{get title(){return t("dashboard.employeeCount")},get subtitle(){return t("dashboard.current")},get children(){return[(()=>{var s=U7();return Se(a=>m(s,n,a)),s})(),(()=>{var s=ec();return l(s,()=>t("dashboard.newHires")),Se(a=>m(s,i,a)),s})()]}}),null),l(o,B(Tt,{get title(){return t("dashboard.pendingInvoices")},get subtitle(){return t("dashboard.outstanding")},get children(){return[(()=>{var s=H7();return Se(a=>m(s,n,a)),s})(),(()=>{var s=ec();return l(s,()=>t("dashboard.totalOutstanding")),Se(a=>m(s,i,a)),s})()]}}),null),l(o,B(Tt,{get title(){return t("dashboard.cashBalance")},get subtitle(){return t("accounts.title")},get children(){return[(()=>{var s=W7();return Se(a=>m(s,n,a)),s})(),(()=>{var s=ec();return l(s,()=>t("dashboard.lastUpdatedToday")),Se(a=>m(s,i,a)),s})()]}}),null),o})(),(()=>{var o=ec();return m(o,r),l(o,B(Tt,{get title(){return t("dashboard.quickActions")},get subtitle(){return t("dashboard.commonTasks")},get children(){var s=ec();return s.style.setProperty("display","flex"),s.style.setProperty("flex-direction","column"),s.style.setProperty("gap","1rem"),l(s,B(Pt,{variant:"primary",get children(){return t("invoices.createNew")}}),null),l(s,B(Pt,{variant:"secondary",get children(){return t("employees.addEmployee")}}),null),l(s,B(Pt,{variant:"outline",get children(){return t("dashboard.generateReport")}}),null),s}}),null),l(o,B(Tt,{get title(){return t("dashboard.recentActivity")},get subtitle(){return t("dashboard.latestUpdates")},get children(){var s=G7(),a=s.firstChild,c=a.firstChild,u=c.nextSibling,f=a.nextSibling,y=f.firstChild,v=y.nextSibling,p=f.nextSibling,I=p.firstChild,P=I.nextSibling;return s.style.setProperty("display","flex"),s.style.setProperty("flex-direction","column"),s.style.setProperty("gap","0.75rem"),a.style.setProperty("border-bottom","1px solid var(--border-color)"),a.style.setProperty("padding-bottom","0.5rem"),c.style.setProperty("font-weight","500"),l(c,()=>t("dashboard.invoicePaid")),u.style.setProperty("font-size","0.875rem"),u.style.setProperty("color","var(--text-muted)"),l(u,()=>t("dashboard.hoursAgo")),f.style.setProperty("border-bottom","1px solid var(--border-color)"),f.style.setProperty("padding-bottom","0.5rem"),y.style.setProperty("font-weight","500"),l(y,()=>t("dashboard.newEmployeeOnboarded")),v.style.setProperty("font-size","0.875rem"),v.style.setProperty("color","var(--text-muted)"),l(v,()=>t("dashboard.dayAgo")),I.style.setProperty("font-weight","500"),l(I,()=>t("dashboard.monthlyReportGenerated")),P.style.setProperty("font-size","0.875rem"),P.style.setProperty("color","var(--text-muted)"),l(P,()=>t("dashboard.daysAgo")),s}}),null),o})(),B(Ge,{get when(){return Ar.hasPermission("invoiceAccess")},get children(){return B(fN,{})}})]}})};var o1=ue("<div>"),K7=ue("<div><div><div><strong>Display Name:</strong> </div><div><strong>UID:</strong> </div></div><div><strong>Created:</strong> "),J7=ue("<div><h3>Store Access</h3><div></div><div>No store access granted"),Q7=ue("<div><h3>Permissions</h3><div>"),X7=ue('<div><div><input type=text placeholder="Search users..."></div><div>'),Z7=ue("<div> You need administrator privileges to access this page."),e8=ue("<div>Loading users..."),t8=ue("<div><div></div><div></div><div> stores"),r8=ue("<div>Select a user to view and edit their profile"),n8=ue("<div><input type=checkbox><label>"),i8=ue("<div><input type=checkbox><div><div></div><div>");const o8=()=>{const[t,e]=$e([]),[r,n]=$e(null),[i,o]=$e(!1),[s,a]=$e(!1),[c,u]=$e(""),[f,y]=$e(null),v=[{id:"YY_8802",name:"Store 8802"},{id:"YY_8803",name:"Store 8803"},{id:"YY_8804",name:"Store 8804"},{id:"YY_8805",name:"Store 8805"},{id:"YY_8816",name:"Store 8816"},{id:"YY_8818",name:"Store 8818"},{id:"YY_8847",name:"Store 8847"},{id:"YY_3251",name:"Store 3251"},{id:"YY_32",name:"Store 32"},{id:"YY_76",name:"Store 76"},{id:"YY_79",name:"Store 79"},{id:"YY_8635",name:"Store 8635"},{id:"YY_8665",name:"Store 8665"},{id:"YY_8901",name:"Store 8901"}],p=[{key:"AccountAccess",label:"Account Access",description:"Access to accounting features"},{key:"BankingAccess",label:"Banking Access",description:"Access to banking operations"},{key:"InventoryAccess",label:"Inventory Access",description:"Access to inventory management"},{key:"JournalAccess",label:"Journal Access",description:"Access to journal entries"},{key:"invoiceAccess",label:"invoice Access",description:"Access to Invoices"},{key:"inventoryDownsection",label:"Inventory Downsection",description:"Access to inventory downsection"},{key:"onlyRead",label:"Read Only",description:"Limited to read-only access"},{key:"read_write",label:"Read/Write",description:"Full read and write permissions"},{key:"isAdmin",label:"Administrator",description:"Full system administration rights"}];let I={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,invoiceAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};Nn(async()=>{await P()});const P=async()=>{try{o(!0);const b=Q4(um,"users"),Y=uI(b,dI("createdAt","desc")),te=await yI(Y),O=[];te.forEach(D=>{let X=D.data();Object.keys(I).map(H=>{let F=I?.[H];X.hasOwnProperty(H)||(X[H]=F)}),O.push({uid:D.id,...X})}),e(O)}catch(b){console.error("Error loading users:",b),y({type:"error",text:"Failed to load users"})}finally{o(!1)}},w=Nt(()=>{const b=c().toLowerCase();return b?t().filter(Y=>Y.email?.toLowerCase().includes(b)||Y.displayName?.toLowerCase().includes(b)||Y.uid?.toLowerCase().includes(b)):t()}),x=b=>{r()&&n(Y=>({...Y,stores:{...Y.stores,[b]:!Y.stores[b]}}))},j=b=>{r()&&n(Y=>({...Y,[b]:!Y[b]}))};Nt(()=>r()?r().stores&&Object.values(r().stores).some(b=>b):!1);const ne=async()=>{if(r())try{a(!0),y(null);const b=a5(um,"users",r().uid);let Y={stores:r().stores,AccountAccess:r().AccountAccess,BankingAccess:r().BankingAccess,InventoryAccess:r().InventoryAccess,invoiceAccess:r().invoiceAccess,JournalAccess:r().JournalAccess,inventoryDownsection:r().inventoryDownsection,onlyRead:r().onlyRead,read_write:r().read_write,isAdmin:r().isAdmin||!1};await g5(b,Y),e(te=>te.map(O=>O.uid===r().uid?r():O)),y({type:"success",text:"User profile updated successfully"})}catch(b){console.error("Error saving user profile:",b),y({type:"error",text:"Failed to save user profile"})}finally{a(!1)}},Q={display:"grid","grid-template-columns":"350px 1fr",gap:"2rem",height:"calc(100vh - 200px)"},K={"max-height":"100%","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)",background:"var(--surface-color)"},Z=b=>({padding:"1rem","border-bottom":"1px solid var(--border-color)",cursor:"pointer",background:b?"var(--primary-color-light)":"transparent",transition:"background 0.2s"}),k={padding:"0.75rem",border:"none","border-bottom":"1px solid var(--border-color)",background:"var(--surface-color)",width:"100%","font-size":"1rem"},C={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem"},E={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.75rem"},M={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",transition:"all 0.2s"},_=b=>({padding:"1rem","margin-bottom":"1rem","border-radius":"var(--border-radius)",background:b==="success"?"#d4edda":"#f8d7da",color:b==="success"?"#155724":"#721c24",border:`1px solid ${b==="success"?"#c3e6cb":"#f5c6cb"}`}),S=Nt(()=>Ar.state.profile?.isAdmin===!0);return B(ro,{title:"User Profile Administration",get children(){return B(Ge,{get when(){return S()},get fallback(){return B(Tt,{get children(){var b=Z7();return b.style.setProperty("text-align","center"),b.style.setProperty("padding","2rem"),b.style.setProperty("color","var(--text-muted)"),b}})},get children(){var b=X7(),Y=b.firstChild,te=Y.firstChild,O=Y.nextSibling;return m(b,Q),m(Y,K),te.$$input=D=>u(D.currentTarget.value),m(te,k),l(Y,B(Ge,{get when(){return!i()},get fallback(){return(()=>{var D=e8();return D.style.setProperty("padding","2rem"),D.style.setProperty("text-align","center"),D})()},get children(){return B(Ht,{get each(){return w()},children:D=>(()=>{var X=t8(),H=X.firstChild,F=H.nextSibling,ie=F.nextSibling,$=ie.firstChild;return X.$$click=()=>n(D),H.style.setProperty("font-weight","600"),l(H,()=>D.displayName||"No Name"),F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),l(F,()=>D.email),ie.style.setProperty("font-size","0.75rem"),ie.style.setProperty("color","var(--text-muted)"),ie.style.setProperty("margin-top","0.25rem"),l(ie,()=>D.isAdmin&&" Admin  ",$),l(ie,()=>Object.values(D.stores||{}).filter(Boolean).length,$),Se(L=>m(X,Z(r()?.uid===D.uid),L)),X})()})}}),null),l(O,B(Ge,{get when(){return r()},get fallback(){return B(Tt,{get children(){var D=r8();return D.style.setProperty("text-align","center"),D.style.setProperty("padding","2rem"),D.style.setProperty("color","var(--text-muted)"),D}})},get children(){return[B(Ge,{get when(){return f()},get children(){var D=o1();return l(D,()=>f().text),Se(X=>m(D,_(f().type),X)),D}}),B(Tt,{title:"User Information",get subtitle(){return r().email},get children(){return[(()=>{var D=K7(),X=D.firstChild,H=X.firstChild,F=H.firstChild;F.nextSibling;var ie=H.nextSibling,$=ie.firstChild;$.nextSibling;var L=X.nextSibling,U=L.firstChild;return U.nextSibling,D.style.setProperty("margin-bottom","2rem"),X.style.setProperty("display","flex"),X.style.setProperty("justify-content","space-between"),X.style.setProperty("margin-bottom","1rem"),l(H,()=>r().displayName||"Not set",null),l(ie,()=>r().uid,null),l(L,()=>new Date(r().createdAt?.toDate?.()||r().createdAt).toLocaleDateString(),null),D})(),(()=>{var D=J7(),X=D.firstChild,H=X.nextSibling,F=H.nextSibling;return D.style.setProperty("margin-bottom","2rem"),X.style.setProperty("margin-bottom","1rem"),m(H,E),l(H,B(Ht,{each:v,children:ie=>{let $=lt.getLocationById(ie?.id);return(()=>{var L=n8(),U=L.firstChild,N=U.nextSibling;return L.$$click=()=>x(ie?.id),U.style.setProperty("cursor","pointer"),N.style.setProperty("cursor","pointer"),N.style.setProperty("user-select","none"),l(N,()=>$?.name),Se(z=>m(L,{...M,background:r().stores?.[ie?.id]?"var(--primary-color-light)":"transparent"},z)),Se(()=>U.checked=r().stores?.[ie?.id]||!1),L})()}})),F.style.setProperty("margin-top","0.5rem"),F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),D})(),(()=>{var D=Q7(),X=D.firstChild,H=X.nextSibling;return D.style.setProperty("margin-bottom","2rem"),X.style.setProperty("margin-bottom","1rem"),m(H,C),l(H,B(Ht,{each:p,children:F=>(()=>{var ie=i8(),$=ie.firstChild,L=$.nextSibling,U=L.firstChild,N=U.nextSibling;return ie.$$click=()=>j(F.key),$.style.setProperty("cursor","pointer"),L.style.setProperty("flex","1"),L.style.setProperty("cursor","pointer"),L.style.setProperty("user-select","none"),U.style.setProperty("font-weight","500"),l(U,()=>F.label),N.style.setProperty("font-size","0.75rem"),N.style.setProperty("color","var(--text-muted)"),l(N,()=>F.description),Se(z=>m(ie,{...M,background:r()[F.key]?"var(--primary-color-light)":"transparent"},z)),Se(()=>$.checked=!!r()[F.key]),ie})()})),D})(),(()=>{var D=o1();return D.style.setProperty("display","flex"),D.style.setProperty("gap","1rem"),D.style.setProperty("justify-content","flex-end"),l(D,B(Pt,{variant:"secondary",onClick:()=>n(null),children:"Cancel"}),null),l(D,B(Pt,{variant:"primary",onClick:ne,get disabled(){return s()},get children(){return s()?"Saving...":"Save Changes"}}),null),D})()]}})]}})),Se(()=>te.value=c()),b}})}})};ur(["input","click"]);const s8=async()=>{try{console.log("Testing PDF generation...");const e=(await Ui(()=>Promise.resolve().then(()=>W5),void 0)).default;console.log("jsPDF imported successfully");const r=new e;console.log("PDF document created"),r.setFontSize(20),r.text("Test PDF",20,20),r.setFontSize(12),r.text("This is a test PDF to verify the library works.",20,40),console.log("Text added to PDF"),r.save("test.pdf"),console.log("PDF saved successfully"),alert("Test PDF generated successfully!")}catch(t){console.error("Test PDF generation failed:",t),alert(`Test PDF failed: ${t.message}`)}},Pp=(t,e)=>{try{console.log("Generating printable PDF...");const r=window.open("","_blank","width=800,height=600");if(!r){alert("Please allow popups to generate PDF");return}const n=t.shipper_consignee||{};let i=lt.getLocationById(t?.store);const o=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Invoice ${t.invoice||"N/A"}</title>
        <style>
          body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
          }
          .header {
            display: flex;
            justify-content: space-between;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
            margin-bottom: 20px;
          }
          .company {
            font-size: 24px;
            font-weight: bold;
            color: #2563eb;
          }
          .invoice-info {
            text-align: right;
          }
          .section {
            margin: 20px 0;
          }
          .section-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
          }
          .customer-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
             font-size: 13px;
          }
          .flex{
            display: flex;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
          }
          th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
          }
          th {
            background-color: #f2f2f2;
            font-weight: bold;
            font-size: 13px;
          }
          td{
           font-size: 12px;
          }
          .total-row {
            font-weight: bold;
            font-size: 16px;
            background-color: #e8f4fd;
          }
          .certification-section {
            page-break-inside: avoid;
            break-inside: avoid;
            orphans: 3;
            widows: 3;
          }
          .page-break-before {
            page-break-before: always;
            break-before: page;
          }
          @media print {
            body { margin: 0; }
            .no-print { display: none; }
            .certification-section {
              page-break-inside: avoid !important;
              break-inside: avoid !important;
              orphans: 3;
              widows: 3;
            }
            .page-break-before {
              page-break-before: always !important;
              break-before: page !important;
            }
            /* Force page break if certification section would be split */
            @page {
              margin: 0.5in;
              orphans: 3;
              widows: 3;
            }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <div>
            <div class="company">HRM FINANCE</div>
            <div>${e("common.store")}: ${i?.name||t?.store||"N/A"}</div>
            <div>${e("common.orderId")}: ${t.ssg_sorder_key||"N/A"}</div>
            ${t.shippingMethod?`<div>${e("common.shipping")}: ${t.shippingMethod==="aereo"?e("common.air"):e("common.sea")}</div>`:""}
          </div>
          <div class="invoice-info">
            <div style="font-size: 18px; font-weight: bold;">${e("common.invoice").toUpperCase()}</div>
            <div style="font-size: 16px; margin: 5px 0;">${t.invoice||"N/A"}</div>
            <div>${t.createDate?new Date(t.createDate).toLocaleDateString():"N/A"}</div>
            <div style="margin-top: 10px;">
              <span style="padding: 4px 8px; background: ${t.isCompleted?"#d4edda":"#fff3cd"}; border-radius: 10px; font-size: 12px;">
                ${t.isCompleted?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase()}
              </span>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="customer-info">
            <div><strong>${e("invoices.senderInformation")}:</strong> ${n.name||"N/A"}</div>
            ${n.phoneNumberS?`<div><strong>${e("invoices.phoneNumber")}:</strong> ${n.phoneNumberS}</div>`:""}
          
          </div>
          <div class="customer-info">
            <div><strong>${e("invoices.receiptInformation")}:</strong> ${[n.firstName,n.middleName,n.lastName,n.lastName2].filter(Boolean).join(" ")||"N/A"}</div>
            <div><strong>${e("invoices.phoneNumber")}:</strong> ${n.phoneNumber||"N/A"}</div>
            <div><strong>${e("invoices.id")}:</strong> ${n.cid||"N/A"}</div>
            ${n.address?`<div><strong>${e("invoices.address")}:</strong> ${n.address}</div>`:""}
          </div>
        </div>

        ${t.products&&t.products.length>0?`
        <div class="section">
          <div class="section-title">${e("invoices.products")}</div>
          <table>
            <thead>
              <tr>
                <th>${e("invoices.code")}</th>
                <th>${e("invoices.description")}</th>
                <th>${e("invoices.qty")}</th>
                <th>${e("invoices.unitPrice")}</th>
                <th>${e("invoices.total")}</th>
              </tr>
            </thead>
            <tbody>
              ${t.products.map(s=>`
                <tr>
                  <td>${s.product?.code||"N/A"}</td>
                  <td>${s.product?.label||"N/A"}</td>
                  <td>${Math.abs(s.qty||0)}</td>
                  <td>$${parseFloat(s.salePrice||0).toFixed(2)}</td>
                  <td>$${(s.total||Math.abs(s.qty||0)*parseFloat(s.salePrice||0)).toFixed(2)}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </div>
        `:""}

        ${t.reservas&&t.reservas.length>0?`
        <div class="section">
          <div class="section-title">${e("invoices.reservations")}</div>
          <table>
            <thead>
              <tr>
                <th>${e("invoices.type")}</th>
                <th>${e("invoices.qty")}</th>
                <th>${e("invoices.unitPrice")}</th>
                <th>${e("invoices.arancel")}</th>
                <th>${e("invoices.total")}</th>
              </tr>
            </thead>
            <tbody>
              ${t.reservas.map(s=>{const a=parseFloat(s.qty||0),c=parseFloat(s.price||0),u=parseFloat(s.arancel||0),f=s.total||a*c+u;return`
                  <tr>
                    <td>${s.type||"N/A"}</td>
                    <td>${a.toFixed(2)}</td>
                    <td>$${c.toFixed(2)}</td>
                    <td>$${u.toFixed(2)}</td>
                    <td>$${f.toFixed(2)}</td>
                  </tr>
                `}).join("")}
            </tbody>
          </table>
        </div>
        `:""}

        <div class="section flex">
          ${t.paymentMethods?`
        <div class="section" style="margin-right: auto; width: 48%">
          <div class="section-title">${e("common.paymentMethods")}</div>
          <div class="customer-info">
            ${t.paymentMethods.cash>0?`<div><strong> ${e("common.cash")}:</strong> $${t.paymentMethods.cash.toFixed(2)}</div>`:""}
            ${t.paymentMethods.zelle>0?`<div><strong> Zelle:</strong> $${t.paymentMethods.zelle.toFixed(2)}</div>`:""}
            ${t.paymentMethods.creditCard>0?`<div><strong> ${e("common.creditCard")}:</strong> $${t.paymentMethods.creditCard.toFixed(2)}</div>`:""}
            ${t.paymentMethods.exemptTaxOnCash&&t.paymentMethods.cash>0&&t.taxSavings>0?`
              <div style="margin-top: 10px; padding: 8px; background-color: #e7f5ff; border-radius: 4px; font-size: 12px; font-style: italic;">
                * ${e("common.taxExemptNote")} ${e("common.youSaved")} $${t.taxSavings.toFixed(2)}!
              </div>
            `:""}
          </div>
        </div>
        `:""}
        <div class="section ">
          <table style="margin-left: auto; width: width: 48%">
            ${t.productSubtotal?`
            <tr>
              <td><strong>${e("invoices.productsSubtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${t.productSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            ${t.reservaSubtotal?`
            <tr>
              <td><strong>${e("invoices.reservationsSubtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${t.reservaSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            ${t.taxAmount&&t.taxAmount>0?`
            <tr>
              <td><strong>${e("common.subtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${(t.subtotalBeforeTax||0).toFixed(2)}</strong></td>
            </tr>
            <tr>
              <td><strong>${e("common.tax")} (${t.paymentMethods?.taxPercent||7}%):</strong></td>
              <td style="text-align: right;"><strong>$${t.taxAmount.toFixed(2)}</strong></td>
            </tr>
            `:""}
            <tr class="total-row">
              <td><strong>${e("invoices.total").toUpperCase()}:</strong></td>
              <td style="text-align: right;"><strong>$${(t.total||0).toFixed(2)}</strong></td>
            </tr>
          </table>
        </div>
        </div>
        
       

        <!-- Certification Section -->
        <div class="certification-section" style="margin-top: 40px; padding: 20px; border: 2px solid #333; background: #f9f9f9;">
          <div style="text-align: center; font-weight: bold; font-size: 14px; margin-bottom: 15px; text-transform: uppercase;">
            CERTIFICACIN DEL EMBARCADOR
          </div>
          <div style="font-size: 11px; line-height: 1.4; text-align: justify; margin-bottom: 20px;">
            <p><strong>Certifico que no envo sustancias ni productos prohibidos por las leyes y las aduanas de USA y Cuba, como por ejemplo:</strong> drogas, armas, explosivos, cigarrillos electrnicos, drones profesionales, joyas, prendas, dinero en efectivo, semillas, narcticos, frmacos controlados, productos agrcolas de tipo herbicidas o antifngicidas, ningn tipo de producto perecedero que necesite refrigeracin.</p>
            
            <p><strong>Entiendo que al llenar este formulario, al enviar alguna de las sustancias o productos antes descritos mi carga puede ser decamisada completa o parcialmente por las aduanas de Cuba o USA sin derecho a reclamo ni compensacin,</strong> de parte ma como embarcador, ni de la persona a quien envo (consignatario).</p>
            
           </div>
          
          <!-- Signature Section -->
          <div style="display: flex; justify-content: space-between; margin-top: 30px;">
            <div style="width: 45%; text-align: center;">
              <div style="border-bottom: 2px solid #333; margin-bottom: 10px; height: 40px;"></div>
              <div style="font-size: 10px; font-weight: bold;">FIRMA DEL EMBARCADOR / SHIPPER SIGNATURE</div>
              <div style="font-size: 10px; margin-top: 5px;">${n.name||"N/A"}</div>
            </div>
            <div style="width: 45%; text-align: center;">
              <div style="border-bottom: 2px solid #333; margin-bottom: 10px; height: 40px;"></div>
              <div style="font-size: 10px; font-weight: bold;">FECHA / DATE</div>
              <div style="font-size: 10px; margin-top: 5px;">${new Date().toLocaleDateString()}</div>
            </div>
          </div>
        </div>

        <div style="margin-top: 40px; text-align: center; color: #666; font-size: 12px;">
          <p>${e("common.thankForChoosingUs")}</p>
          <p>${e("common.generatedOn")} ${new Date().toLocaleDateString()}</p>
        </div>

        <script>
          // Check if certification section needs page break
          function checkCertificationPageBreak() {
            const certSection = document.querySelector('.certification-section');
            if (!certSection) return;
            
            // Reset any previous page break class to get accurate measurements
            certSection.classList.remove('page-break-before');
            
            // Force a layout recalculation
            certSection.offsetHeight;
            
            const rect = certSection.getBoundingClientRect();
            const certHeight = rect.height;
            const certTop = rect.top;
            
            // Estimate print page height (assuming standard letter size at 96 DPI)
            // Standard letter: 11 inches - 1 inch margins = 10 inches usable
            // At 96 DPI: 10 * 96 = 960px usable height per page
            const printPageHeight = 960;
            const pageMargin = 48; // 0.5 inch margins
            
            // Calculate current position on the page
            const currentPagePosition = certTop % printPageHeight;
            const remainingPageSpace = printPageHeight - currentPagePosition - pageMargin;
            
            // Add some buffer space (50px) to ensure comfortable fit
            const requiredSpace = certHeight + 50;
            
            false && console.log('Certification section analysis:', {
              certHeight,
              certTop,
              currentPagePosition,
              remainingPageSpace,
              requiredSpace,
              needsPageBreak: requiredSpace > remainingPageSpace
            });
            
            // Only add page break if certification truly won't fit
            if (requiredSpace > remainingPageSpace && remainingPageSpace < printPageHeight * 0.4) {
              // console.log('Adding page break for certification section');
              certSection.classList.add('page-break-before');
            }
          }
          
          // Run check when page loads and before printing
          document.addEventListener('DOMContentLoaded', function() {
            // Delay to ensure all content is rendered
            setTimeout(checkCertificationPageBreak, 100);
          });
          window.addEventListener('beforeprint', checkCertificationPageBreak);
        <\/script>

        <div class="no-print" style="margin-top: 30px; text-align: center;">
          <button onclick="window.print()" style="padding: 10px 20px; font-size: 16px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
            ${e("common.printSavePDF")}
          </button>
          <button onclick="window.close()" style="padding: 10px 20px; font-size: 16px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer; margin-left: 10px;">
            ${e("common.close")}
          </button>
        </div>
      </body>
      </html>
    `;r.document.write(o),r.document.close(),r.focus(),console.log("Printable PDF window opened")}catch(r){console.error("Error generating printable PDF:",r),alert("Error generating printable PDF: "+r.message)}},a8=async(t,e)=>{try{console.log("Starting professional PDF generation...");const n=(await Ui(()=>Promise.resolve().then(()=>W5),void 0)).default,i=new n,o=210,s=297,a=15,c=o-a*2,u={r:180,g:180,b:180},f={r:80,g:80,b:80},y={r:130,g:130,b:130},v={r:248,g:248,b:248},p={r:252,g:252,b:252},I={r:120,g:120,b:120},P={r:150,g:150,b:150};let w=a;const x=q=>{i.setTextColor(q.r,q.g,q.b)},j=q=>{i.setFillColor(q.r,q.g,q.b)},ne=(q,ae,de,le,V,ce=!1)=>{i.roundedRect(q,ae,de,le,V,V,ce?"F":"S")};j(p),i.rect(0,0,o,50,"F"),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.5),i.line(0,50,o,50),x(f),i.setFontSize(32),i.setFont("helvetica","bold"),i.text("HRM",a,25),x(y),i.setFontSize(32),i.setFont("helvetica","normal");const Q=i.getTextWidth("HRM ");i.text("FINANCE",a+Q,25),x(y),i.setFontSize(9),i.setFont("helvetica","normal"),i.text("Professional Business Solutions",a,35);const K=70,Z=o-a-K;i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.5),ne(Z,12,K,26,2,!1),x(f),i.setFontSize(14),i.setFont("helvetica","bold");const k=e("common.invoice").toUpperCase(),C=i.getTextWidth(k);i.text(k,Z+(K-C)/2,22),i.setFontSize(11),i.setFont("helvetica","normal");const E=t.invoice||"N/A",M=i.getTextWidth(E);i.text(E,Z+(K-M)/2,32),w=60,j(p),i.rect(0,50,o,20,"F");const _=t.isCompleted,S=_?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase();x(_?f:y),i.setFontSize(8),i.setFont("helvetica","bold"),i.text(`STATUS: ${S}`,a,58),x(y),i.setFontSize(9),i.setFont("helvetica","normal");const Y=t.createDate?new Date(t.createDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A";i.text(Y,o-a-i.getTextWidth(Y),58),w=58,i.text(`${e("common.store")}: ${t.store||"N/A"}`,a+60,w),w+=5,i.text(`${e("common.orderId")}: ${t.ssg_sorder_key||"N/A"}`,a+60,w),t.shippingMethod&&i.text(`${e("common.shipping")}: ${t.shippingMethod==="aereo"?e("common.air"):e("common.sea")}`,o-a-50,w),w=80,x(f),i.setFontSize(14),i.setFont("helvetica","bold"),i.text(e("invoices.customerInformation"),a,w),w+=10;const te=45,O=10,D=(c-O)/2;j(p),ne(a,w,D,te,3,!0),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),ne(a,w,D,te,3);const X=t.shipper_consignee||{};let H=w+8;x(y),i.setFontSize(9),i.text(e("invoices.senderInformation"),a+5,H),H+=7,x(f),i.setFontSize(11),i.setFont("helvetica","bold"),i.text(X.name||"N/A",a+5,H),X.phoneNumberS&&(H+=6,i.setFont("helvetica","normal"),i.setFontSize(9),x(y),i.text(`${e("invoices.altPhone")}: ${X.phoneNumberS}`,a+5,H)),j(p),ne(a+D+O,w,D,te,3,!0),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),ne(a+D+O,w,D,te,3),H=w+8,x(y),i.setFontSize(9),i.text(e("invoices.receiptInformation"),a+D+O+5,H),H+=7;const F=[X.firstName,X.middleName,X.lastName,X.lastName2].filter(Boolean).join(" ")||"N/A";if(x(f),i.setFontSize(11),i.setFont("helvetica","bold"),i.text(F,a+D+O+5,H),H+=6,i.setFont("helvetica","normal"),i.setFontSize(9),x(y),i.text(`${e("invoices.phoneNumber")}: ${X.phoneNumber||"N/A"}`,a+D+O+5,H),H+=5,i.text(`${e("invoices.id")}: ${X.cid||"N/A"}`,a+D+O+5,H),X.address)H+=5,X.address.split(",").map(ae=>ae.trim()).forEach((ae,de)=>{de<2&&ae&&(i.text(ae,a+D+O+5,H),H+=5)});else{let q=`${X.ybstreet||""} #${X.ybstreetNo||""} ${e("invoices.between")} ${X.ybbetwen1||""} ${e("invoices.and")} ${X.ybbetwen2||""}`,ae=`${X.ybreparto||""}, ${X.ybcity||""}, ${X.ybestate||""}`;H+=5,i.text(q,a+D+O+5,H),H+=5,i.text(ae,a+D+O+5,H)}if(w+=te+15,t?.products&&t?.products?.length>0){x(f),i.setFontSize(14),i.setFont("helvetica","bold"),i.text(e("invoices.products"),a,w),w+=10,j(v),i.rect(a,w-6,c,10,"F"),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(a,w+4,o-a,w+4),i.setFontSize(9),i.setFont("helvetica","bold"),x(f);const q={code:a+5,description:a+35,qty:a+115,price:a+135,total:a+160};i.text(e("invoices.code"),q.code,w),i.text(e("invoices.description"),q.description,w),i.text(e("invoices.qty"),q.qty,w),i.text(e("invoices.unitPrice"),q.price,w),i.text(e("invoices.total"),q.total,w),w+=10,i.setFont("helvetica","normal"),i.setFontSize(9),t.products.forEach((ae,de)=>{w>250&&(i.addPage(),w=a),de%2===0&&(j(p),i.rect(a,w-4,c,8,"F")),x(f),i.text(ae.product?.code||"N/A",q.code,w);let le=ae.product?.label||"N/A";i.getTextWidth(le)>70&&(le=le.substring(0,40)+"..."),i.text(le,q.description,w);const V=Math.abs(ae.qty||0),ce=parseFloat(ae.salePrice||0),Pe=ae.total||V*ce;i.text(V.toString(),q.qty,w),i.text(`$${ce.toFixed(2)}`,q.price,w),i.setFont("helvetica","bold"),i.text(`$${Pe.toFixed(2)}`,q.total,w),i.setFont("helvetica","normal"),w+=8}),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(a,w,o-a,w),w+=15}if(t.reservas&&t.reservas.length>0){w>200&&(i.addPage(),w=a),x(f),i.setFontSize(14),i.setFont("helvetica","bold"),i.text(e("invoices.reservations"),a,w),w+=10,j(v),i.rect(a,w-6,c,10,"F"),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(a,w+4,o-a,w+4),i.setFontSize(9),i.setFont("helvetica","bold"),x(f);const q={type:a+5,qty:a+65,price:a+95,arancel:a+125,total:a+160};i.text(e("invoices.type"),q.type,w),i.text(e("invoices.qty"),q.qty,w),i.text(e("invoices.unitPrice"),q.price,w),i.text(e("invoices.arancel"),q.arancel,w),i.text(e("invoices.total"),q.total,w),w+=10,i.setFont("helvetica","normal"),i.setFontSize(9),t.reservas.forEach((ae,de)=>{w>250&&(i.addPage(),w=a),de%2===0&&(j(p),i.rect(a,w-4,c,8,"F")),x(f),i.text(ae.type||"N/A",q.type,w);const le=parseFloat(ae.qty||0),V=parseFloat(ae.price||0),ce=parseFloat(ae.arancel||0),Pe=ae.total||le*V+ce;i.text(le.toString(),q.qty,w),i.text(`$${V.toFixed(2)}`,q.price,w),i.text(`$${ce.toFixed(2)}`,q.arancel,w),i.setFont("helvetica","bold"),i.text(`$${Pe.toFixed(2)}`,q.total,w),i.setFont("helvetica","normal"),w+=8}),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(a,w,o-a,w),w+=15}w>210&&(i.addPage(),w=a);const ie=o-a-80,$=80;let L=60;t.taxAmount&&t.taxAmount>0&&(L+=16),j(p),ne(ie-10,w,$+10,L,3,!0),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),ne(ie-10,w,$+10,L,3);let U=w+10;if(i.setFontSize(10),x(y),t.productSubtotal!==void 0&&t.productSubtotal>0&&(i.text(e("invoices.productsSubtotal"),ie,U),i.text(`$${t.productSubtotal.toFixed(2)}`,ie+$-15,U,{align:"right"}),U+=8),t.reservaSubtotal!==void 0&&t.reservaSubtotal>0&&(i.text(e("invoices.reservationsSubtotal"),ie,U),i.text(`$${t.reservaSubtotal.toFixed(2)}`,ie+$-15,U,{align:"right"}),U+=8),t.taxAmount&&t.taxAmount>0){i.text(e("common.subtotal"),ie,U),i.text(`$${(t.subtotalBeforeTax||0).toFixed(2)}`,ie+$-15,U,{align:"right"}),U+=8;const q=t.paymentMethods?.taxPercent||7;i.text(`${e("common.tax")} (${q}%)`,ie,U),i.text(`$${t.taxAmount.toFixed(2)}`,ie+$-15,U,{align:"right"}),U+=8}if(i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(ie,U+2,ie+$-10,U+2),U+=10,i.setFontSize(14),i.setFont("helvetica","bold"),x(f),i.text(e("invoices.total"),ie,U),i.text(`$${(t.total||0).toFixed(2)}`,ie+$-15,U,{align:"right"}),t.paymentMethods){w+=L+20,x(f),i.setFontSize(12),i.setFont("helvetica","bold"),i.text(e("common.paymentMethods"),a,w),w+=10,i.setFontSize(10),i.setFont("helvetica","normal"),x(y);const q=t.paymentMethods;let ae=w;q.cash&&q.cash>0&&(i.text(`${e("common.cash")}:`,a+5,ae),i.text(`$${q.cash.toFixed(2)}`,a+50,ae),ae+=6),q.zelle&&q.zelle>0&&(i.text("Zelle:",a+5,ae),i.text(`$${q.zelle.toFixed(2)}`,a+50,ae),ae+=6),q.creditCard&&q.creditCard>0&&(i.text(`${e("common.creditCard")}:`,a+5,ae),i.text(`$${q.creditCard.toFixed(2)}`,a+50,ae),ae+=6),q.exemptTaxOnCash&&q.cash>0&&t.taxSavings>0&&(ae+=4,i.setFontSize(9),i.setFont("helvetica","italic"),i.text(`* Tax exempted on cash payment. You saved $${t.taxSavings.toFixed(2)}!`,a+5,ae)),w=ae+10}w=s-30,j(p),i.rect(0,w-10,o,40,"F"),i.setFontSize(12),i.setFont("helvetica","italic"),x(y);const N=e("common.thankYouBusiness"),z=i.getTextWidth(N);i.text(N,(o-z)/2,w),w+=8,i.setFontSize(9),i.setFont("helvetica","normal");const oe="www.hrmfinance.com | info@hrmfinance.com | +1 (555) 123-4567",G=i.getTextWidth(oe);i.text(oe,(o-G)/2,w),w+=8,i.setFontSize(8);const ee=`Generated on ${new Date().toLocaleString("en-US")}`,J=i.getTextWidth(ee);i.text(ee,(o-J)/2,w);const W=`invoice-${t.invoice||"unknown"}.pdf`;i.save(W),console.log("Professional PDF saved successfully:",W)}catch(r){throw console.error("Error in generateProfessionalInvoicePDF:",r),r}},Sa=t=>parseFloat(t?.toString()||"0")||0,l8=t=>{if(t?.includes("/")){const[e,r,n]=t.split("/");return`${n}-${e.padStart(2,"0")}-${r.padStart(2,"0")}`}if(t?.includes("-")){const[e,r,n]=t.split("-");return`${n}-${e.padStart(2,"0")}-${r.padStart(2,"0")}`}return t},c8=t=>{const e=[];return t.ybstreet&&(e.push(t.ybstreet),t.ybstreetNo&&e.push(`# ${t.ybstreetNo}`)),t.ybbetwen1&&t.ybbetwen2&&e.push(`/ ${t.ybbetwen1} y ${t.ybbetwen2}`),t.ybreparto&&e.push(`, Rpto ${t.ybreparto}`),t.ybcity&&e.push(`, ${t.ybcity}`),t.ybestate&&e.push(`, ${t.ybestate}`),e.join(" ")},s1=t=>{const e=Sa(t.qty),r=Sa(t.price),n=Sa(t.arancel);return t.onlyTariff?n:e*r+n},a1=t=>{const e=Math.abs(t.qty),r=Sa(t.salePrice);return e*r},u8=(t,e)=>{const r=t.split("-");if(r.length>=3){const n=r[0];return{YY_8803:"BISSONNET"}[n]||e}return e},l1=t=>{const e=t?.products?.reduce((w,x)=>w+a1(x),0),r=t?.reservas?.reduce((w,x)=>w+s1(x),0),n=e+r,i=7,o=.93,a=n*(1-o)*(i/100),c=n*i/100-a,u=n+a,y=(t?.products||[])?.map((w,x)=>({id:Date.now().toString()+x,product:{id:w.product.id,code:w.product.code,label:w.product.label,price:0},qty:Math.abs(w.qty),salePrice:Sa(w.salePrice),total:a1(w)})),v=t?.reservas?.map((w,x)=>({id:Date.now().toString()+x+1e3,type:w.type,qty:Sa(w.qty),price:Sa(w.price),arancel:Sa(w.arancel),total:s1(w)})),p={name:t.shipper_consignee.name,firstName:t.shipper_consignee.firstName,middleName:t.shipper_consignee.middleName||"",lastName:t.shipper_consignee.lastName,lastName2:t.shipper_consignee.lastName2||"",phoneNumber:t.shipper_consignee.phoneNumber,cid:t.shipper_consignee.cid,passport:t.shipper_consignee.passport||"",address:c8(t.shipper_consignee),phoneNumberS:t.shipper_consignee.phoneNumberS,dob:l8(t.shipper_consignee.dob)},I=u8(t.invoice,t.store),P=t.shipper_consignee.shipping?.toLowerCase()==="aereo"?"aereo":"maritimo";return{invoice:t.invoice,description:t.description||"",store:I,shipper_consignee:p,products:y,reservas:v,packagesOrder:t.packagesOrder,shippingMethod:P,paymentMethods:t?.paymentMethods,type:t.type,ssg_inventory_key:t.ssg_inventory_key,ssg_sorder_key:t.ssg_sorder_key,createDate:t.createDate,businessId:t.businessId,isCompleted:t.isCompleted,productSubtotal:e,reservaSubtotal:r,subtotalBeforeTax:n,taxAmount:a,taxSavings:c,total:u,taxCalculationMethod:"subtotal",cashPaymentRatio:o}},[tu,qr]=zh({invoices:[],selectedInvoice:null,loading:!1,error:null,lastUpdated:null}),[d8,po]=$e({fetchAll:!1,fetchById:!1,create:!1,update:!1,delete:!1,generatePDF:!1}),ji={get state(){return tu},get loadingStates(){return d8()},async fetchInvoices(t){try{po(s=>({...s,fetchAll:!0})),qr("loading",!0),qr("error",null);let e="SALES";if(t?.search&&(e+=" "+t.search),t?.store&&t.store!=="all")e+=" "+t.store;else if(!Ar.state?.profile?.isAdmin)return e+=" "+Dm(32),qr("invoices",[]),qr("lastUpdated",new Date),[];t?.status&&t.status!=="all"&&(e+=" "+t.status);const r=e.toString(),n=await Ai.getInvoice(r);let i=[];if(t?.dateFrom&&t?.dateTo){const s=a=>{let c=new Date(n[a].createDate).getTime(),u=new Date(t?.dateFrom).getTime(),f=new Date(t?.dateTo).getTime();c>=u&&c<=f&&i.push(n[a])};Object.keys(n).map(s)}else i=Fp(n);const o=Array.isArray(i)?i:i||[];return qr("invoices",o),qr("lastUpdated",new Date),o}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoices";throw qr("error",r),console.error("Error fetching invoices:",e),e}finally{qr("loading",!1),po(e=>({...e,fetchAll:!1}))}},fecthInventory:async t=>{},async fetchInvoiceById(t){try{po(n=>({...n,fetchById:!0})),qr("error",null);const e=await Ai.getInvoice(t),r=Fp(e);return qr("selectedInvoice",r[0]),r}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice";throw qr("error",r),console.error("Error fetching invoice:",e),e}finally{po(e=>({...e,fetchById:!1}))}},async createInvoice(t){try{po(r=>({...r,create:!0})),qr("error",null);const e={type:t.type||"SALES",invoice:t.invoice,description:t.description||"",store:t.store||"",ssg_inventory_key:t.ssg_inventory_key||`INV-${Date.now()}`,ssg_sorder_key:t.ssg_sorder_key||`SO-${Date.now()}`,createDate:t.createDate||Date.now(),shipper_consignee:t.shipper_consignee,packagesOrder:t.packagesOrder||!1,businessId:t.businessId||"YB100423253156428",userId:t.userId||"current-user",reservas:t.reservas||[],products:t.products||[],isCompleted:t.isCompleted||!0};return e.products&&e.products.length>0&&(e.productSubtotal=e.products.reduce((r,n)=>r+n.qty*n.salePrice,0)),e.reservas&&e.reservas.length>0&&(e.reservaSubtotal=e.reservas.reduce((r,n)=>r+n.total,0)),e.total=(e.productSubtotal||0)+(e.reservaSubtotal||0),qr("invoices",r=>[e,...r]),qr("lastUpdated",new Date),e}catch(e){const r=e instanceof Error?e.message:"Failed to create invoice";throw qr("error",r),console.error("Error creating invoice:",e),e}finally{po(e=>({...e,create:!1}))}},async generateInvoicePDF(t,e="compact",r="es"){try{po(a=>({...a,generatePDF:!0})),qr("error",null);const n=tu.invoices.find(a=>a.invoice===t);if(!n)throw new Error("Invoice not found");let i;switch(e){case"compact":const{generateCompactModernInvoicePDF:a}=await Ui(async()=>{const{generateCompactModernInvoicePDF:f}=await import("./compactModernInvoicePdfGenerator-DgXvPNGp.js");return{generateCompactModernInvoicePDF:f}},[]);i=a;break;case"modern":const{generateModernMovementInvoicePDF:c}=await Ui(async()=>{const{generateModernMovementInvoicePDF:f}=await import("./modernMovementInvoicePdfGenerator-PwSmiRga.js");return{generateModernMovementInvoicePDF:f}},[]);i=c;break;case"classic":default:const{generateWorkingInvoicePDF:u}=await Ui(async()=>{const{generateWorkingInvoicePDF:f}=await import("./workingPdfGenerator-MIhJFjLy.js");return{generateWorkingInvoicePDF:f}},[]);i=u;break}const o={...n,movementType:"sales",items:n.products||[],invoiceId:n.invoice,id:n.invoice};return await i(o,null,r)}catch(n){const i=n instanceof Error?n.message:"Failed to generate PDF";throw qr("error",i),console.error("Error generating invoice PDF:",n),n}finally{po(n=>({...n,generatePDF:!1}))}},async updateInvoice(t,e){try{po(n=>({...n,update:!0})),qr("error",null);const r={};return qr("invoices",n=>n.map(i=>i.invoice===t?r:i)),tu.selectedInvoice?.invoice===t&&qr("selectedInvoice",r),qr("lastUpdated",new Date),r}catch(r){const n=r instanceof Error?r.message:"Failed to update invoice";throw qr("error",n),console.error("Error updating invoice:",r),r}finally{po(r=>({...r,update:!1}))}},async deleteInvoice(t){try{po(i=>({...i,delete:!0})),qr("error",null),qr("invoices",i=>i.filter(o=>o.invoice!==t)),tu.selectedInvoice?.invoice===t&&qr("selectedInvoice",null),qr("lastUpdated",new Date);const n=await Vi({query:"deleteYabaSalesOrders",params:{businessId:"YB100423253156428",id:t}});return!0}catch(e){const r=e instanceof Error?e.message:"Failed to delete invoice";throw qr("error",r),console.error("Error deleting invoice:",e),e}finally{po(e=>({...e,delete:!1}))}},async fetchInvoiceStats(t){try{qr("error",null);const e=new URLSearchParams;t?.store&&t.store!=="all"&&e.append("store",t.store),t?.dateFrom&&e.append("dateFrom",t.dateFrom),t?.dateTo&&e.append("dateTo",t.dateTo);const r=e.toString();return[]}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice statistics";throw qr("error",r),console.error("Error fetching invoice stats:",e),e}},async fetchStores(){try{return qr("error",null),[]}catch(t){const e=t instanceof Error?t.message:"Failed to fetch stores";throw qr("error",e),console.error("Error fetching stores:",t),t}},setSelectedInvoice(t){qr("selectedInvoice",t)},clearError(){qr("error",null)},getFilteredInvoices(t){let e=tu.invoices;if(t.store&&t.store!=="all"&&(e=e.filter(r=>r.store===t.store)),t.dateFrom){const r=new Date(t.dateFrom).getTime();e=e.filter(n=>n.createDate>=r)}if(t.dateTo){const r=new Date(t.dateTo).setHours(23,59,59,999);e=e.filter(n=>n.createDate<=r)}if(t.status&&t.status!=="all"){const r=t.status==="completed";e=e.filter(n=>n.isCompleted===r)}return e},calculateSummary(t){let e=t.length,r=t.filter(v=>v.isCompleted).length,n=0,i=0,o=0,s=0,a=0,c=0,u=new Set,f=new Set;t?.forEach(v=>{u.add(v?.shipper_consignee?.cid),f.add(v.store),v?.products?.length>0&&v?.products?.forEach(p=>{const I=Math.abs(p?.qty);n+=I,o+=I*(parseFloat(p?.salePrice)||1)}),v?.reservas?.length>0&&v?.reservas?.forEach(p=>{let I=parseInt(p?.qty);isNaN(I)&&(I=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[p.type]||p?.onlyTariff?(I=parseFloat(p.arancel)||parseFloat(p.qty)*parseFloat(p.price),c+=I):(p?.arancel&&(a+=parseFloat(p?.arancel)),i+=I,s+=I*parseFloat(p?.price))})});const y=o+s+c;return{totalInvoices:e,completedInvoices:r,pendingInvoices:e-r,totalProducts:n,totalReservas:i,totalProductAmount:o,totalReservaAmount:s,totalAranceles:a,grandTotal:y,totalOther:c,uniqueCustomers:u.size,uniqueStores:f.size,avgInvoiceValue:e>0?y/e:0}},async refreshData(t){return this.fetchInvoices(t)}};var h8=ue("<br>"),c1=ue("<div><h3></h3><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),u1=ue("<div><span>:</span><span>"),f8=ue("<button>remove"),p8=ue("<div class=invoice-display><div><div><div>:<span></span></div><div>: <span></span></div></div><div><div></div><h2></h2><div></div><div></div></div></div><div><h3></h3><div><div><div></div><div></div></div></div><div></div><h3></h3><div><div><div></div><div> <!> <!> </div><div></div><div></div><div></div><div></div></div><div><div></div><div></div><div></div><div></div><div> #<br> <!> <!> <br>, <br>, </div></div></div></div><div><div><div><span>:</span><span></span></div></div></div><div></div><div><button> </button><button> Test PDF</button><button> </button></div><style>"),d1=ue("<tr><td></td><td></td><td></td><td></td><td>");const m8=t=>{const{t:e}=tr(),[r,n]=$e(""),[i,o]=$e(!1),s=te=>new Date(te).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),a=te=>{const O=typeof te=="string"?parseFloat(te):te;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(O)},c=Nt(()=>{let te=0,O=0,D=0,X=0;t.invoice?.products?.forEach($=>{const L=Math.abs($?.qty),U=parseFloat($?.salePrice?.toString())||1;te+=L*U}),t.invoice?.reservas?.forEach($=>{let L=parseFloat($?.qty?.toString());isNaN(L)&&(L=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[$.type]||$?.onlyTariff?(L=parseFloat($.arancel?.toString())||parseFloat($.qty?.toString())*parseFloat($.price?.toString()),D+=L):($?.arancel&&(X+=parseFloat($?.arancel?.toString())),O+=L*parseFloat($?.price?.toString()))});const H=te+O+X+D,F=0,ie=H+F;return{productSubtotal:te,reservaSubtotal:O,tariffSubtotal:X,subtotal:H,tax:F,total:ie}}),u={"max-width":"800px",margin:"0 auto",padding:"2rem",background:"white","box-shadow":"0 0 20px rgba(0,0,0,0.1)","border-radius":"var(--border-radius)"},f={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"2rem","padding-bottom":"2rem","border-bottom":"2px solid #e0e0e0"},y={"text-align":"right",flex:"1"},v={display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600","text-transform":"uppercase",background:t.invoice.isCompleted?"#d4edda":"#fff3cd",color:t.invoice.isCompleted?"#155724":"#856404","margin-bottom":"0.5rem"},p={"margin-bottom":"2rem"},I={"font-size":"1.1rem","font-weight":"600","margin-bottom":"1rem",color:"#333"},P={display:"grid","grid-template-columns":"1fr 1fr",gap:"1.5rem"},w={background:"#f8f9fa",padding:"1rem","border-radius":"var(--border-radius-sm)",border:"1px solid #e9ecef"},x={"font-size":"0.875rem",color:"#666","margin-bottom":"0.25rem"},j={"font-size":"1rem",color:"#333","font-weight":"500"},ne={width:"100%","border-collapse":"collapse","margin-top":"1rem"},Q={"text-align":"left",padding:"0.75rem","border-bottom":"2px solid #dee2e6","font-weight":"600",color:"#495057","font-size":"0.875rem","text-transform":"uppercase"},K={padding:"0.75rem","border-bottom":"1px solid #dee2e6",color:"#212529"},Z={"font-weight":"600","font-size":"1.1rem"},k={display:"flex",gap:"1rem","justify-content":"center","margin-top":"2rem","padding-top":"2rem","border-top":"2px solid #e0e0e0"},C={padding:"0.75rem 1.5rem","border-radius":"var(--border-radius-sm)",border:"none","font-weight":"500",cursor:"pointer",transition:"all 0.2s",display:"flex","align-items":"center",gap:"0.5rem"},E={...C,background:"var(--primary-color)",color:"white"},M={...C,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},_=Nt(()=>lt.getLocationById(t.invoice.store)),S=async()=>{console.log("Starting PDF export...");try{if(!t.invoice){console.error("No invoice data available"),alert("No invoice data available");return}const te={...t.invoice,storeName:_()?.name||t.invoice.store,storeType:_()?.type,productSubtotal:c().productSubtotal,reservaSubtotal:c().reservaSubtotal,total:c().total};let O=l1(t.invoice);console.log("Using minimal ink PDF generator...");try{await a8(O,e),console.log("Minimal ink PDF generation completed successfully")}catch(D){console.error("PDF generation failed:",D),console.log("Trying printable PDF fallback..."),Pp(O,e),console.log("Printable PDF fallback completed")}}catch(te){console.error("Error in handleExportPDF:",te),console.error("Error stack:",te.stack),alert(`Error generating PDF: ${te.message}`)}},b=async()=>{console.log("Starting PDF export...");try{if(!t.invoice){console.error("No invoice data available"),alert("No invoice data available");return}const te={...t.invoice,storeName:_()?.name||t.invoice.store,storeType:_()?.type,productSubtotal:c().productSubtotal,reservaSubtotal:c().reservaSubtotal,total:c().total};let O=l1(t.invoice);console.log("Using minimal ink PDF generator...");try{Pp(O,e),console.log("Minimal ink PDF generation completed successfully")}catch(D){console.error("PDF generation failed:",D),console.log("Trying printable PDF fallback..."),Pp(O,e),console.log("Printable PDF fallback completed")}}catch(te){console.error("Error in handleExportPDF:",te),console.error("Error stack:",te.stack),alert(`Error generating PDF: ${te.message}`)}},Y=te=>{ji.deleteInvoice(t.invoice.ssg_sorder_key),t.goBack()};return(()=>{var te=p8(),O=te.firstChild,D=O.firstChild,X=D.firstChild,H=X.firstChild,F=H.nextSibling,ie=X.nextSibling,$=ie.firstChild,L=$.nextSibling,U=D.nextSibling,N=U.firstChild,z=N.nextSibling,oe=z.nextSibling,G=oe.nextSibling,ee=O.nextSibling,J=ee.firstChild,W=J.nextSibling,q=W.firstChild,ae=q.firstChild,de=ae.nextSibling,le=W.nextSibling,V=le.nextSibling,ce=V.nextSibling,Pe=ce.firstChild,fe=Pe.firstChild,be=fe.nextSibling,xe=be.firstChild,he=xe.nextSibling,ve=he.nextSibling,De=ve.nextSibling;De.nextSibling;var Ee=be.nextSibling,Ce=Ee.nextSibling,Ne=Ce.nextSibling,Ie=Ne.nextSibling,Re=Pe.nextSibling,We=Re.firstChild,Fe=We.nextSibling,Xe=Fe.nextSibling,tt=Xe.nextSibling,At=tt.nextSibling,rt=At.firstChild,He=rt.nextSibling,xt=He.nextSibling,_t=xt.nextSibling,mt=_t.nextSibling,Et=mt.nextSibling,et=Et.nextSibling,qe=et.nextSibling,ot=qe.nextSibling,Je=ot.nextSibling,at=Je.nextSibling,dt=ee.nextSibling,It=dt.firstChild,jt=It.firstChild,Gt=jt.firstChild,yt=Gt.firstChild,Qt=Gt.nextSibling,Mt=dt.nextSibling,Kt=Mt.nextSibling,Xt=Kt.firstChild;Xt.firstChild;var ht=Xt.nextSibling,wt=ht.nextSibling;wt.firstChild;var Ut=Kt.nextSibling;return m(te,u),m(O,f),X.style.setProperty("color","#666"),X.style.setProperty("margin-top","0.25rem"),l(X,()=>e(`inventory.${_()?.type}Type`),H),F.style.setProperty("font-size","1.1rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","#444"),l(F,()=>_()?.name),ie.style.setProperty("font-size",".91rem"),ie.style.setProperty("font-weight","400"),ie.style.setProperty("color","#666"),l(ie,()=>e("invoices.id"),$),L.style.setProperty("font-size","1.1rem"),L.style.setProperty("font-weight","600"),L.style.setProperty("color","#444"),l(L,()=>t.invoice.ssg_sorder_key),m(U,y),l(N,(()=>{var Ze=Te(()=>!!t.invoice.isCompleted);return()=>Ze()?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase()})()),z.style.setProperty("margin","0 0 0.5rem 0"),z.style.setProperty("font-size","1.5rem"),l(z,()=>e("common.invoice").toUpperCase()),oe.style.setProperty("font-size","1.1rem"),oe.style.setProperty("font-weight","600"),oe.style.setProperty("color","#333"),l(oe,()=>t.invoice.invoice),G.style.setProperty("color","#666"),G.style.setProperty("margin-top","0.5rem"),l(G,()=>s(t.invoice.createDate)),l(J,()=>e("invoices.senderInformation")),l(ae,()=>e("invoices.customerName")),l(de,()=>t.invoice.shipper_consignee.name),l(q,B(Ge,{get when(){return t.invoice.shipper_consignee.phoneNumberS},get children(){return[h8(),Te(()=>e("invoices.altPhone")),": ",Te(()=>t.invoice.shipper_consignee.phoneNumberS)]}}),null),le.style.setProperty("margin","20px"),l(V,()=>e("invoices.receiptInformation")),l(fe,()=>e("invoices.customerName")),l(be,()=>t.invoice.shipper_consignee.firstName,xe),l(be,()=>t.invoice.shipper_consignee.middleName,he),l(be,()=>t.invoice.shipper_consignee.lastName,De),l(be,()=>t.invoice.shipper_consignee.lastName2,null),l(Ee,()=>e("invoices.id")),l(Ce,()=>t.invoice.shipper_consignee.cid),l(Ne,()=>e("invoices.passport")),l(Ie,()=>t.invoice.shipper_consignee.passport),l(We,()=>e("invoices.contactInformation")),l(Fe,()=>e("invoices.phoneNumber")),l(Xe,()=>t.invoice.shipper_consignee.phoneNumber),l(tt,()=>e("invoices.address")),l(At,()=>t.invoice.shipper_consignee.ybstreet,rt),l(At,()=>t.invoice.shipper_consignee.ybstreetNo,He),l(At,()=>e("invoices.between"),xt),l(At,()=>t.invoice.shipper_consignee.ybbetwen1,_t),l(At,()=>e("invoices.and"),Et),l(At,()=>t.invoice.shipper_consignee.ybbetwen2,qe),l(At,()=>t.invoice.shipper_consignee.ybreparto,ot),l(At,()=>t.invoice.shipper_consignee.ybcity,Je),l(At,()=>t.invoice.shipper_consignee.ybestate,at),l(At,()=>t.invoice.shipper_consignee.nacionality,null),l(te,B(Ge,{get when(){return t.invoice?.products?.length>0},get children(){var Ze=c1(),Vt=Ze.firstChild,Ft=Vt.nextSibling,Jt=Ft.firstChild,er=Jt.firstChild,gt=er.firstChild,dr=gt.nextSibling,Er=dr.nextSibling,mr=Er.nextSibling,xr=mr.nextSibling,Vr=Jt.nextSibling;return l(Vt,()=>e("invoices.products")),l(gt,()=>e("invoices.code")),l(dr,()=>e("invoices.description")),l(Er,()=>e("invoices.qty")),l(mr,()=>e("invoices.unitPrice")),l(xr,()=>e("invoices.total")),l(Vr,B(Ht,{get each(){return t.invoice?.products},children:kt=>(()=>{var Cr=d1(),$r=Cr.firstChild,hr=$r.nextSibling,yr=hr.nextSibling,Ir=yr.nextSibling,Hr=Ir.nextSibling;return l($r,()=>kt.product.code),l(hr,()=>kt.product.label),l(yr,()=>Math.abs(kt.qty)),l(Ir,()=>a(kt.salePrice)),l(Hr,()=>a(Math.abs(kt.qty)*parseFloat(kt.salePrice))),Se(rr=>{var on=K,vn=K,Ln={...K,"text-align":"center"},bn={...K,"text-align":"right"},gn={...K,"text-align":"right"};return rr.e=m($r,on,rr.e),rr.t=m(hr,vn,rr.t),rr.a=m(yr,Ln,rr.a),rr.o=m(Ir,bn,rr.o),rr.i=m(Hr,gn,rr.i),rr},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Cr})()})),Se(kt=>{var Cr=p,$r=I,hr=ne,yr=Q,Ir=Q,Hr={...Q,"text-align":"center"},rr={...Q,"text-align":"right"},on={...Q,"text-align":"right"};return kt.e=m(Ze,Cr,kt.e),kt.t=m(Vt,$r,kt.t),kt.a=m(Ft,hr,kt.a),kt.o=m(gt,yr,kt.o),kt.i=m(dr,Ir,kt.i),kt.n=m(Er,Hr,kt.n),kt.s=m(mr,rr,kt.s),kt.h=m(xr,on,kt.h),kt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),Ze}}),dt),l(te,B(Ge,{get when(){return t.invoice?.reservas?.length>0},get children(){var Ze=c1(),Vt=Ze.firstChild,Ft=Vt.nextSibling,Jt=Ft.firstChild,er=Jt.firstChild,gt=er.firstChild,dr=gt.nextSibling,Er=dr.nextSibling,mr=Er.nextSibling,xr=mr.nextSibling,Vr=Jt.nextSibling;return l(Vt,()=>e("invoices.reservations")),l(gt,()=>e("invoices.type")),l(dr,()=>e("invoices.qty")),l(Er,()=>e("invoices.unitPrice")),l(mr,()=>e("invoices.arancel")),l(xr,()=>e("invoices.total")),l(Vr,B(Ht,{get each(){return t.invoice?.reservas},children:kt=>(()=>{var Cr=d1(),$r=Cr.firstChild,hr=$r.nextSibling,yr=hr.nextSibling,Ir=yr.nextSibling,Hr=Ir.nextSibling;return l($r,()=>kt.type),l(hr,()=>kt.qty),l(yr,()=>a(kt.price)),l(Ir,()=>kt.arancel||"-"),l(Hr,()=>a(parseInt(kt.qty)*parseFloat(kt.price)+(kt.arancel?parseFloat(kt.arancel):0))),Se(rr=>{var on=K,vn={...K,"text-align":"center"},Ln={...K,"text-align":"right"},bn={...K,"text-align":"right"},gn={...K,"text-align":"right"};return rr.e=m($r,on,rr.e),rr.t=m(hr,vn,rr.t),rr.a=m(yr,Ln,rr.a),rr.o=m(Ir,bn,rr.o),rr.i=m(Hr,gn,rr.i),rr},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Cr})()})),Se(kt=>{var Cr=p,$r=I,hr=ne,yr=Q,Ir={...Q,"text-align":"center"},Hr={...Q,"text-align":"right"},rr={...Q,"text-align":"right"},on={...Q,"text-align":"right"};return kt.e=m(Ze,Cr,kt.e),kt.t=m(Vt,$r,kt.t),kt.a=m(Ft,hr,kt.a),kt.o=m(gt,yr,kt.o),kt.i=m(dr,Ir,kt.i),kt.n=m(Er,Hr,kt.n),kt.s=m(mr,rr,kt.s),kt.h=m(xr,on,kt.h),kt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),Ze}}),dt),It.style.setProperty("display","inline-block"),It.style.setProperty("min-width","250px"),l(It,B(Ge,{get when(){return t.invoice?.products?.length>0},get children(){var Ze=u1(),Vt=Ze.firstChild,Ft=Vt.firstChild,Jt=Vt.nextSibling;return Ze.style.setProperty("display","flex"),Ze.style.setProperty("justify-content","space-between"),Ze.style.setProperty("margin-bottom","0.5rem"),l(Vt,()=>e("invoices.productsSubtotal"),Ft),l(Jt,()=>a(c().productSubtotal)),Ze}}),jt),l(It,B(Ge,{get when(){return t.invoice?.reservas?.length>0},get children(){var Ze=u1(),Vt=Ze.firstChild,Ft=Vt.firstChild,Jt=Vt.nextSibling;return Ze.style.setProperty("display","flex"),Ze.style.setProperty("justify-content","space-between"),Ze.style.setProperty("margin-bottom","0.5rem"),l(Vt,()=>e("invoices.subtotal"),Ft),l(Jt,()=>a(c().reservaSubtotal)),Ze}}),jt),l(Gt,()=>e("invoices.total"),yt),Qt.style.setProperty("color","var(--primary-color)"),l(Qt,()=>a(c().total)),Xt.addEventListener("mouseleave",Ze=>Ze.currentTarget.style.opacity="1"),Xt.addEventListener("mouseenter",Ze=>Ze.currentTarget.style.opacity="0.9"),Xt.$$click=b,l(Xt,()=>e("invoices.printInvoice"),null),as(ht,"click",s8,!0),wt.addEventListener("mouseleave",Ze=>{Ze.currentTarget.style.background="white",Ze.currentTarget.style.color="var(--primary-color)"}),wt.addEventListener("mouseenter",Ze=>{Ze.currentTarget.style.background="var(--primary-color)",Ze.currentTarget.style.color="white"}),wt.$$click=S,l(wt,()=>e("invoices.exportPdf"),null),l(Kt,B(Ge,{get when(){return Ar.state?.profile?.isAdmin},get children(){var Ze=f8();return Ze.$$click=Y,Ze.addEventListener("mouseleave",Vt=>Vt.currentTarget.style.opacity="1"),Ze.addEventListener("mouseenter",Vt=>Vt.currentTarget.style.opacity="0.9"),Se(Vt=>m(Ze,E,Vt)),Ze}}),null),l(Ut,`
        @media print {
          .invoice-display {
            box-shadow: none !important;
            padding: 0 !important;
          }
          
          ${k} {
            display: none !important;
          }
        }
      `),Se(Ze=>{var Vt=v,Ft=p,Jt=I,er=P,gt=w,dr=x,Er=j,mr=I,xr=P,Vr=w,kt=x,Cr=j,$r={...x,"margin-top":"0.75rem"},hr=j,yr={...x,"margin-top":"0.75rem"},Ir=j,Hr=w,rr=x,on={...x,"margin-top":"0.75rem"},vn=j,Ln={...x,"margin-top":"0.75rem"},bn=j,gn={...p,"text-align":"right"},Br={...Z,display:"flex","justify-content":"space-between","padding-top":"0.75rem","border-top":"2px solid #dee2e6"},Vn={...p,"text-align":"center",color:"#666","font-size":"0.875rem"},Xn=k,Ni=E,nr={...E,background:"#28a745"},Tr=M;return Ze.e=m(N,Vt,Ze.e),Ze.t=m(ee,Ft,Ze.t),Ze.a=m(J,Jt,Ze.a),Ze.o=m(W,er,Ze.o),Ze.i=m(q,gt,Ze.i),Ze.n=m(ae,dr,Ze.n),Ze.s=m(de,Er,Ze.s),Ze.h=m(V,mr,Ze.h),Ze.r=m(ce,xr,Ze.r),Ze.d=m(Pe,Vr,Ze.d),Ze.l=m(fe,kt,Ze.l),Ze.u=m(be,Cr,Ze.u),Ze.c=m(Ee,$r,Ze.c),Ze.w=m(Ce,hr,Ze.w),Ze.m=m(Ne,yr,Ze.m),Ze.f=m(Ie,Ir,Ze.f),Ze.y=m(Re,Hr,Ze.y),Ze.g=m(We,rr,Ze.g),Ze.p=m(Fe,on,Ze.p),Ze.b=m(Xe,vn,Ze.b),Ze.T=m(tt,Ln,Ze.T),Ze.A=m(At,bn,Ze.A),Ze.O=m(dt,gn,Ze.O),Ze.I=m(jt,Br,Ze.I),Ze.S=m(Mt,Vn,Ze.S),Ze.W=m(Kt,Xn,Ze.W),Ze.C=m(Xt,Ni,Ze.C),Ze.B=m(ht,nr,Ze.B),Ze.v=m(wt,Tr,Ze.v),Ze},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0}),te})()};ur(["click"]);const lu={invoice:"",description:"",store:"",shipper_consignee:{name:"",firstName:"",middleName:"",lastName:"",lastName2:"",phoneNumber:"",cid:"",passport:"",address:""},products:[],reservas:[],packagesOrder:!1,shippingMethod:"",paymentMethods:{taxOnTotal:!1,taxPercent:0,exemptTaxOnCash:!1,cash:0,zelle:0,creditCard:0}},Fy="invoice_styled_form_draft",y8=()=>{try{const t=localStorage.getItem(Fy);if(t){const e=JSON.parse(t);return{...lu,...e,shipper_consignee:{...lu.shipper_consignee,...e.shipper_consignee||{}},paymentMethods:{...lu.paymentMethods,...e.paymentMethods||{}},products:e.products||[],reservas:e.reservas||[]}}}catch(t){console.warn("Failed to load styled invoice form from storage:",t)}return console.log("No saved data found, using default form data"),{...lu}},Oy=t=>{try{localStorage.setItem(Fy,JSON.stringify(t))}catch(e){console.warn("Failed to save styled invoice form to storage:",e)}},h1=()=>{try{localStorage.removeItem(Fy)}catch(t){console.warn("Failed to clear styled invoice form from storage:",t)}},[dl,Go]=$e(y8()),[l_,mo]=$e(!1),[g8,sh]=$e(null);let xp=null;const xs=()=>{xp&&clearTimeout(xp),xp=setTimeout(()=>{const t=dl();Oy(t),sh(new Date),console.log("Styled invoice form auto-saved at",new Date().toLocaleTimeString())},1e3)},Ur={formData:dl,get isDirty(){return l_()},get lastSaved(){return g8()},updateForm:t=>{Go(e=>{const r={...e,...t};return mo(!0),xs(),r})},updateShipperConsignee:t=>{Go(e=>{const r={...e,shipper_consignee:{...e.shipper_consignee,...t}};return mo(!0),xs(),r})},updatePaymentMethods:t=>{Go(e=>{const r={...e,paymentMethods:{...e.paymentMethods,...t}};return mo(!0),xs(),r})},addProduct:t=>{Go(e=>{const r={...e,products:[...e.products,t]};return mo(!0),xs(),r})},updateProduct:(t,e)=>{Go(r=>{const n=[...r.products];n[t]={...n[t],...e};const i={...r,products:n};return mo(!0),xs(),i})},removeProduct:t=>{Go(e=>{const r=e.products.filter((i,o)=>o!==t),n={...e,products:r};return mo(!0),xs(),n})},addReserva:t=>{Go(e=>{const r={...e,reservas:[...e.reservas,t]};return mo(!0),xs(),r})},updateReserva:(t,e)=>{Go(r=>{const n=[...r.reservas];n[t]={...n[t],...e};const i={...r,reservas:n};return mo(!0),xs(),i})},removeReserva:t=>{Go(e=>{const r=e.reservas.filter((i,o)=>o!==t),n={...e,reservas:r};return mo(!0),xs(),n})},clearForm:()=>{Go({...lu}),mo(!1),h1(),sh(null)},markCompleted:()=>{h1(),mo(!1),sh(null)},forceSave:()=>{Oy(dl()),sh(new Date),mo(!1)},hasData:()=>{const t=dl();return t.invoice!==""||t.description!==""||t.store!==""||t.shipper_consignee.name!==""||t.shipper_consignee.firstName!==""||t.shipper_consignee.cid!==""||t.products.length>0||t.reservas.length>0||t.paymentMethods.cash>0||t.paymentMethods.zelle>0||t.paymentMethods.creditCard>0},isValid:()=>{const t=dl();return t.invoice.trim()!==""&&t.shipper_consignee.firstName.trim()!==""&&t.shipper_consignee.lastName.trim()!==""&&t.shipper_consignee.cid.trim()!==""&&(t.products.length>0||t.reservas.length>0)},getFormData:()=>dl()};typeof window<"u"&&window.addEventListener("beforeunload",t=>{if(l_()&&(Oy(dl()),Ur.hasData()))return t.preventDefault(),t.returnValue="You have unsaved changes in your invoice. Are you sure you want to leave?",t.returnValue});var v8=ue("<div> "),b8=ue("<div> <div>"),_8=ue("<div><span></span><span>"),Yd=ue("<div>"),w8=ue("<div><div><div><input type=text autocomplete=off>"),S8=ue("<button type=button>+"),P8=ue("<div><div></div><div>"),x8=ue("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div></div><div>: "),A8=ue("<span>"),C8=ue("<span> ");const I8=t=>{const{t:e}=tr(),[r,n]=$e(!1),[i,o]=$e(""),[s,a]=$e(-1),[c,u]=$e(!1),[f,y]=$e(null),[v,p]=$e([]),[I,P]=$e(null),w=t.searchDelay||300,x=t.maxResults||40,j=Nt(()=>{if(!t.value)return null;const ee=v().find(J=>J.id===t.value);return ee||lt.getProductById(t.value)}),ne=async ee=>{if(!ee.trim()){p([]);return}u(!0),y(null);const J=lt.getActiveProducts().filter(W=>W.name.toLowerCase().includes(ee.toLowerCase())||W.sku.toLowerCase().includes(ee.toLowerCase())||W?.UPC?.toLowerCase().includes(ee?.toLowerCase())||W.category.toLowerCase().includes(ee.toLowerCase())).slice(0,x);p(J),u(!1)},Q=Nt(()=>i().toLowerCase()?v():lt.getActiveProducts().slice(0,10)),K=()=>{n(!0),o(""),a(-1),y(null),i()||p(lt.getActiveProducts().slice(0,10))},Z=ee=>{const W=ee.target.value;o(W),n(!0),a(-1),y(null),I()&&clearTimeout(I());const q=setTimeout(()=>{ne(W)},w);P(q)},k=ee=>{t.onChange(ee.id),n(!1),o(""),a(-1),y(null),I()&&(clearTimeout(I()),P(null))},C=ee=>{const J=Q();switch(ee.key){case"ArrowDown":ee.preventDefault(),a(W=>Math.min(W+1,J.length-1));break;case"ArrowUp":ee.preventDefault(),a(W=>Math.max(W-1,-1));break;case"Enter":ee.preventDefault(),s()>=0&&J[s()]&&k(J[s()]);break;case"Escape":n(!1),o(""),a(-1),y(null),I()&&(clearTimeout(I()),P(null));break}},E=ee=>{setTimeout(()=>{n(!1),o(""),a(-1),I()&&(clearTimeout(I()),P(null))},150)},M=ee=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ee),_=ee=>lt.stockLevels.filter(J=>J.productId===ee).reduce((J,W)=>J+W.quantity,0);Nn(()=>()=>{I()&&clearTimeout(I())});const S={position:"relative",width:"100%",...t.style},b={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},Y={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"400px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},te=ee=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:ee?"var(--strip-color)":"transparent",color:ee?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),O={display:"flex","justify-content":"space-between","align-items":"center"},D={flex:"1"},X={"font-weight":"500","margin-bottom":"0.25rem"},H={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","flex-wrap":"wrap"},F={"text-align":"right","font-size":"0.875rem"},ie={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},$={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"},L={padding:"1rem","text-align":"center",color:"#d32f2f",background:"#ffebee","border-radius":"var(--border-radius-sm)",margin:"0.5rem","font-size":"0.875rem"},U=()=>r()&&i()?i():j()?`${j().name} (${j().sku})`:"",N={display:"flex","align-items":"stretch",width:"100%"},z={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},oe={...b,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},G={position:"absolute",right:t.onAddNew?"50px":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)","pointer-events":"none"};return(()=>{var ee=w8(),J=ee.firstChild,W=J.firstChild,q=W.firstChild;return m(J,N),W.style.setProperty("position","relative"),W.style.setProperty("flex","1"),q.addEventListener("blur",E),q.$$keydown=C,q.$$click=K,q.$$input=Z,l(W,B(Ge,{get when(){return c()},get children(){var ae=v8();return ae.firstChild,l(ae,()=>e("common.searching","Searching..."),null),Se(de=>m(ae,G,de)),ae}}),null),l(J,(()=>{var ae=Te(()=>!!t.onAddNew);return()=>ae()&&(()=>{var de=S8();return de.addEventListener("mouseleave",le=>{le.currentTarget.style.background="var(--surface-color)",le.currentTarget.style.color="var(--primary-color)"}),de.addEventListener("mouseenter",le=>{le.currentTarget.style.background="var(--primary-color)",le.currentTarget.style.color="white"}),as(de,"click",t.onAddNew,!0),m(de,z),Se(()=>Yt(de,"title",e("inventory.addProduct","Add new product"))),de})()})(),null),l(ee,B(Ge,{get when(){return r()},get children(){var ae=Yd();return l(ae,B(Ge,{get when(){return f()},get children(){var de=b8(),le=de.firstChild,V=le.nextSibling;return m(de,L),l(de,f,V),V.style.setProperty("margin-top","0.5rem"),V.style.setProperty("font-size","0.75rem"),l(V,()=>e("inventory.searchFallback","Showing local results")),de}}),null),l(ae,B(Ge,{get when(){return c()},get children(){var de=_8(),le=de.firstChild,V=le.nextSibling;return m(de,$),l(V,()=>e("common.searching","Searching products...")),de}}),null),l(ae,B(Ge,{get when(){return Te(()=>!c())()&&Q().length>0},get fallback(){return Te(()=>!c())()&&(()=>{var de=Yd();return m(de,ie),l(de,(()=>{var le=Te(()=>!!i());return()=>le()?(()=>{var V=P8(),ce=V.firstChild,Pe=ce.nextSibling;return l(ce,()=>e("inventory.noProductsFound","No products found matching your search.")),Pe.style.setProperty("margin-top","0.5rem"),Pe.style.setProperty("font-size","0.75rem"),l(Pe,()=>e("inventory.tryDifferentTerm","Try a different search term or check spelling.")),V})():e("inventory.noProductsAvailable","No products available.")})()),de})()},get children(){return[B(Ht,{get each(){return Q()},children:(de,le)=>{const V=_(de.id),ce=V<=de.minStockLevel;return(()=>{var Pe=x8(),fe=Pe.firstChild,be=fe.firstChild,xe=be.firstChild,he=xe.nextSibling,ve=he.firstChild,De=ve.firstChild,Ee=ve.nextSibling,Ce=Ee.nextSibling,Ne=Ce.nextSibling,Ie=Ne.nextSibling,Re=be.nextSibling,We=Re.firstChild,Fe=We.firstChild,Xe=We.nextSibling,tt=Xe.nextSibling,At=tt.firstChild;return Pe.addEventListener("mouseenter",()=>a(le())),Pe.$$click=()=>k(de),m(fe,O),m(be,D),m(xe,X),l(xe,()=>de.name,null),l(xe,(()=>{var rt=Te(()=>!!i());return()=>rt()&&(()=>{var He=A8();return He.style.setProperty("margin-left","0.5rem"),He.style.setProperty("font-size","0.75rem"),He.style.setProperty("color","var(--primary-color)"),He.style.setProperty("font-weight","normal"),l(He,()=>v().includes(de)?" API":" Local"),He})()})(),null),m(he,H),l(ve,()=>e("inventory.sku","SKU"),De),l(ve,()=>de.sku,null),l(Ce,()=>de.category),l(Ie,()=>M(de.unitCost)),l(be,(()=>{var rt=Te(()=>!!de.description);return()=>rt()&&(()=>{var He=Yd();return He.style.setProperty("font-size","0.75rem"),He.style.setProperty("color","var(--text-muted)"),He.style.setProperty("margin-top","0.25rem"),He.style.setProperty("font-style","italic"),l(He,(()=>{var xt=Te(()=>de.description.length>60);return()=>xt()?`${de.description.substring(0,60)}...`:de.description})()),He})()})(),null),m(Re,F),We.style.setProperty("font-weight","600"),(ce?"#f44336":"var(--text-primary)")!=null?We.style.setProperty("color",ce?"#f44336":"var(--text-primary)"):We.style.removeProperty("color"),l(We,V,Fe),l(We,()=>de.unitOfMeasure,null),Xe.style.setProperty("color","var(--text-muted)"),l(Xe,()=>ce?(()=>{var rt=C8();return rt.firstChild,rt.style.setProperty("color","#f44336"),l(rt,()=>e("inventory.lowStock","Low Stock"),null),rt})():e("inventory.inStock","In Stock")),tt.style.setProperty("font-size","0.75rem"),tt.style.setProperty("color","var(--text-muted)"),tt.style.setProperty("margin-top","0.25rem"),l(tt,()=>e("inventory.min","Min"),At),l(tt,()=>de.minStockLevel,null),Se(rt=>m(Pe,te(le()===s()),rt)),Pe})()}}),Te(()=>Te(()=>Q().length===x)()&&(()=>{var de=Yd();return de.style.setProperty("padding","0.5rem"),de.style.setProperty("text-align","center"),de.style.setProperty("font-size","0.75rem"),de.style.setProperty("color","var(--text-muted)"),de.style.setProperty("border-top","1px solid var(--border-color)"),de.style.setProperty("font-style","italic"),l(de,()=>e("inventory.showingTopResults","Showing top {{count}} results",{count:x})),de})())]}}),null),Se(de=>m(ae,Y,de)),ae}}),null),Se(ae=>{var de=S,le=oe,V=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),ce=t.disabled,Pe=t.required;return ae.e=m(ee,de,ae.e),ae.t=m(q,le,ae.t),V!==ae.a&&Yt(q,"placeholder",ae.a=V),ce!==ae.o&&(q.disabled=ae.o=ce),Pe!==ae.i&&(q.required=ae.i=Pe),ae},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>q.value=U()),ee})()};ur(["input","click","keydown"]);var $8=ue("<label>"),Ap=ue("<div>"),k8=ue("<div><span></span><span>"),E8=ue("<div><input type=text autocomplete=off>"),T8=ue("<span> "),N8=ue("<span> "),L8=ue("<span> "),D8=ue("<div><div><div><div> </div><div>");const R8=t=>{const{t:e}=tr(),[r,n]=$e(!1),[i,o]=$e(""),[s,a]=$e(-1),[c,u]=$e(!1),[f,y]=$e([]),[v,p]=$e(null),I=async D=>{if(!D.trim()||D.trim().length<6){y([]);return}try{u(!0);const X=await Ai.getConsigee(D);console.log(X);const H=Object.values(X).map(F=>({id:F.consigneeId,firstName:F.firstName+(F.middleName?" "+F.middleName:""),fullName:F.firstName+(F.middleName?" "+F.middleName:"")+" "+F.lastName+" "+F.lastName2,lastName:F.lastName+" "+F.lastName2,cid:F.cid,phoneNumber:F.phoneNumber,ybbetwen1:F.ybbetwen1,ybcity:F.ybcity,ybestate:F.ybestate,ybreparto:F.ybreparto,ybstreet:F.ybstreet,ybstreetNo:F.ybstreetNo,address:`Calle ${F.ybstreet}${F.ybstreetNo?" # "+F.ybstreetNo:""}${F.ybbetwen1?" / "+F.ybbetwen1:""}${F.ybbetwen2?" y "+F.ybbetwen2:""}${F.ybreparto?", Rpto "+F.ybreparto:""}, ${F.ybcity?F.ybcity:""}, ${F.ybestate?F.ybestate:""}`}));y(H)}catch(X){console.warn("API search failed, falling back to local search:",X)}finally{u(!1)}},P=()=>{n(!0),o(""),a(-1),i()||I("")},w=D=>{const H=D.target.value;o(H),n(!0),a(-1),v()&&clearTimeout(v());const F=setTimeout(()=>{I(H)},600);p(F)},x=D=>{t.onChange(D),n(!1),o(""),a(-1),v()&&(clearTimeout(v()),p(null))},j=D=>{const X=f();switch(D.key){case"ArrowDown":D.preventDefault(),a(H=>Math.min(H+1,X.length-1));break;case"ArrowUp":D.preventDefault(),a(H=>Math.max(H-1,-1));break;case"Enter":D.preventDefault(),s()>=0&&X[s()]&&x(X[s()]);break;case"Escape":n(!1),o(""),a(-1),v()&&(clearTimeout(v()),p(null));break}},ne=D=>{setTimeout(()=>{n(!1),o(""),a(-1),v()&&(clearTimeout(v()),p(null))},150)},Q=()=>r()&&i()?i():t.value?t.value.cid:"";Nn(()=>(I(""),()=>{v()&&clearTimeout(v())}));const K={position:"relative",width:"100%",...t.style},Z={display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},k={"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","font-style":"italic"},C={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},E={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},M=D=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:D?"var(--strip-color)":"transparent",color:D?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),_={display:"flex","justify-content":"space-between","align-items":"flex-start"},S={flex:"1"},b={"font-weight":"500","margin-bottom":"0.25rem"},Y={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex","flex-direction":"column",gap:"0.125rem"},te={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},O={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"};return(()=>{var D=E8(),X=D.firstChild;return l(D,B(Ge,{get when(){return t.label},get children(){var H=$8();return m(H,Z),l(H,()=>t.label),H}}),X),l(D,B(Ge,{get when(){return t.description},get children(){var H=Ap();return m(H,k),l(H,()=>t.description),H}}),X),X.addEventListener("blur",ne),X.$$keydown=j,X.$$click=P,X.$$input=w,l(D,B(Ge,{get when(){return r()},get children(){var H=Ap();return l(H,B(Ge,{get when(){return c()},get children(){var F=k8(),ie=F.firstChild,$=ie.nextSibling;return m(F,O),l($,()=>e("common.searching","Buscando clientes...")),F}}),null),l(H,B(Ge,{get when(){return Te(()=>!c())()&&f().length>0},get fallback(){return Te(()=>!c())()&&(()=>{var F=Ap();return m(F,te),l(F,(()=>{var ie=Te(()=>!!i());return()=>ie()?e("customer.noCustomersFound","No se encontraron clientes. Puede crear un nuevo cliente llenando el formulario."):e("customer.noCustomersAvailable","No se encontraron clientes previos. Se crear un nuevo cliente.")})()),F})()},get children(){return B(Ht,{get each(){return f()},children:(F,ie)=>(()=>{var $=D8(),L=$.firstChild,U=L.firstChild,N=U.firstChild;N.firstChild;var z=N.nextSibling;return $.addEventListener("mouseenter",()=>a(ie())),$.$$click=()=>x(F),m(L,_),m(U,S),m(N,b),l(N,()=>F.fullName,null),m(z,Y),l(z,B(Ge,{get when(){return F.phoneNumber},get children(){var oe=T8();return oe.firstChild,l(oe,()=>F.phoneNumber,null),oe}}),null),l(z,B(Ge,{get when(){return F.cid},get children(){var oe=N8();return oe.firstChild,l(oe,()=>F.cid,null),oe}}),null),l(z,B(Ge,{get when(){return F.email},get children(){var oe=L8();return oe.firstChild,l(oe,()=>F.email,null),oe}}),null),Se(oe=>m($,M(ie()===s()),oe)),$})()})}}),null),Se(F=>m(H,E,F)),H}}),null),Se(H=>{var F=K,ie=C,$=t.placeholder||e("customer.searchPlaceholder","Buscar clientes por nombre, telfono, ID..."),L=t.disabled,U=t.required;return H.e=m(D,F,H.e),H.t=m(X,ie,H.t),$!==H.a&&Yt(X,"placeholder",H.a=$),L!==H.o&&(X.disabled=H.o=L),U!==H.i&&(X.required=H.i=U),H},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>X.value=Q()),D})()};ur(["input","click","keydown"]);var M8=ue("<label>"),Cp=ue("<div>"),F8=ue("<div><span></span><span>"),O8=ue("<div><input type=text autocomplete=off>"),B8=ue("<span> "),j8=ue("<div><div><div><div> </div><div>");const V8=t=>{const{t:e}=tr(),[r,n]=$e(!1),[i,o]=$e(""),[s,a]=$e(-1),[c,u]=$e(!1),[f,y]=$e([]),[v,p]=$e(null),I=600,P=async X=>{if(!X.trim()||X.trim().length<6){y([]);return}try{u(!0);const H=await Ai.getShipper(X),F=Object.values(H).map(ie=>({id:ie.shipperId,name:ie.name,dob:ie.dob,phoneNumberS:ie.phoneNumber}));y(F)}catch(H){console.warn("API search failed, falling back to local search:",H)}finally{u(!1)}},w=X=>{const F=X.target.value;o(F),n(!0),a(-1),v()&&clearTimeout(v());const ie=setTimeout(()=>{P(F)},I);p(ie)},x=()=>{n(!0),o(""),a(-1),i()||P("")},j=X=>{t.onChange(X),n(!1),o(""),a(-1),v()&&(clearTimeout(v()),p(null))},ne=X=>{const H=f();switch(X.key){case"ArrowDown":X.preventDefault(),a(F=>Math.min(F+1,H.length-1));break;case"ArrowUp":X.preventDefault(),a(F=>Math.max(F-1,-1));break;case"Enter":X.preventDefault(),s()>=0&&H[s()]&&j(H[s()]);break;case"Escape":n(!1),o(""),a(-1),v()&&(clearTimeout(v()),p(null));break}},Q=X=>{setTimeout(()=>{n(!1),o(""),a(-1),v()&&(clearTimeout(v()),p(null))},150)},K=()=>r()&&i()?i():t.value?t.value.name:"";Nn(()=>(P(""),()=>{v()&&clearTimeout(v())}));const Z={position:"relative",width:"100%",...t.style},k={display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},C={"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","font-style":"italic"},E={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},M={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},_=X=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:X?"var(--strip-color)":"transparent",color:X?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),S={display:"flex","justify-content":"space-between","align-items":"flex-start"},b={flex:"1"},Y={"font-weight":"500","margin-bottom":"0.25rem"},te={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex","flex-direction":"column",gap:"0.125rem"},O={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},D={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"};return(()=>{var X=O8(),H=X.firstChild;return l(X,B(Ge,{get when(){return t.label},get children(){var F=M8();return m(F,k),l(F,()=>t.label),F}}),H),l(X,B(Ge,{get when(){return t.description},get children(){var F=Cp();return m(F,C),l(F,()=>t.description),F}}),H),H.addEventListener("blur",Q),H.$$keydown=ne,H.$$click=x,H.$$input=w,l(X,B(Ge,{get when(){return r()},get children(){var F=Cp();return l(F,B(Ge,{get when(){return c()},get children(){var ie=F8(),$=ie.firstChild,L=$.nextSibling;return m(ie,D),l(L,()=>e("common.searching","Buscando clientes...")),ie}}),null),l(F,B(Ge,{get when(){return Te(()=>!c())()&&f().length>0},get fallback(){return Te(()=>!c())()&&(()=>{var ie=Cp();return m(ie,O),l(ie,(()=>{var $=Te(()=>!!i());return()=>$()?e("customer.noShippersFound","No se encontraron clientes. Puede crear un nuevo cliente llenando el formulario."):e("customer.noShippersAvailable","No se encontraron clientes previos. Se crear un nuevo cliente.")})()),ie})()},get children(){return B(Ht,{get each(){return f()},children:(ie,$)=>(()=>{var L=j8(),U=L.firstChild,N=U.firstChild,z=N.firstChild;z.firstChild;var oe=z.nextSibling;return L.addEventListener("mouseenter",()=>a($())),L.$$click=()=>j(ie),m(U,S),m(N,b),m(z,Y),l(z,()=>ie.name,null),m(oe,te),l(oe,B(Ge,{get when(){return ie.phoneNumberS},get children(){var G=B8();return G.firstChild,l(G,()=>ie.phoneNumberS,null),G}})),Se(G=>m(L,_($()===s()),G)),L})()})}}),null),Se(ie=>m(F,M,ie)),F}}),null),Se(F=>{var ie=Z,$=E,L=t.placeholder||e("customer.searchPlaceholder","Buscar clientes por nombre, telfono, ID..."),U=t.disabled,N=t.required;return F.e=m(X,ie,F.e),F.t=m(H,$,F.t),L!==F.a&&Yt(H,"placeholder",F.a=L),U!==F.o&&(H.disabled=F.o=U),N!==F.i&&(H.required=F.i=N),F},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>H.value=K()),X})()};ur(["input","click","keydown"]);var z8=ue("<div> "),jh=ue("<div>"),q8=ue('<div><h3> Informacin del Cliente</h3><div></div><div><div><label>Nombre del Cliente/Empresa *</label><input type=text placeholder="ej., Juan Prez o Empresa ABC"required></div><div><label>Nmero de Telfono Principal</label><input type=tel placeholder="ej., +53-5-123-4567">'),U8=ue('<div><h3> Informacin del Destinatario</h3><div></div><div><label>Primer Nombre</label><input type=text placeholder="ej., Juan"></div><div><label>Apellido</label><input type=text placeholder="ej., Prez"></div><div><label>Nmero de Identificacin</label><input type=text placeholder="ej., 12345678901 o A1234567"></div><div><label>Nmero de Pasaporte</label><input type=text placeholder="ej., AB1234567"></div><div><label>Nmero de Telfono Principal</label><input type=tel placeholder="ej., +53-5-123-4567"></div><div><label>Direccin de Entrega/Facturacin</label><textarea placeholder="ej., Calle 23 #456, Apto 4B, Vedado, La Habana, 10400">'),f1=ue("<div><strong>Subtotal: $"),H8=ue("<div><div><span> Reservas y Servicios</span><button> Agregar Servicio/Reserva"),W8=ue("<div><div><span> Productos y Artculos</span></div><div><label>Agregar Productos a la Factura"),G8=ue("<span> Sin impuesto"),Y8=ue("<div><div>Vista previa del clculo:</div><div>Subtotal: $</div><div> Del Subtotal: $<!>(Total: $<!>)</div><div> Del Total: $<!>(Total: $<!>)"),K8=ue("<div><div> Beneficio por Pago en Efectivo:</div><div>Efectivo: $<!> (<!>% del pago)</div><div>Ahorro en impuestos: $</div><div>Impuesto original: $<!>  Impuesto final: $"),J8=ue("<div><label><input type=checkbox><span> Exencin de Impuesto por Pago en Efectivo</span></label><div>Los pagos en efectivo estarn exentos de impuestos. Mientras mayor sea el porcentaje pagado en efectivo, mayor ser la exencin."),Q8=ue('<div><div><span> Mtodos de Pago</span></div><div>Distribuya el pago total entre los diferentes mtodos de pago disponibles.</div><div><button type=button> Todo Efectivo</button><button type=button title="Pagar todo por Zelle"> Todo Zelle</button><button type=button title="Pagar todo con tarjeta"> Todo Tarjeta</button><button type=button title="Limpiar todos los pagos"> Limpiar</button></div><div><div><label> Efectivo</label><input type=text placeholder=0.00 min=0 step=0.01></div><div><label> Zelle</label><input type=text placeholder=0.00 min=0 step=0.01></div></div><div><label> Tarjeta de Crdito</label><input type=text placeholder=0.00 min=0 step=0.01></div><div><div><div>Total de Pagos: <strong>$</strong></div><div>Balance: <strong>$</strong></div></div><div><div>Total a Pagar: <strong>$</strong></div><div></div></div></div><div><label>Impuesto (%)</label><div>Porcentaje de impuesto. Puede aplicarse sobre el subtotal o como porcentaje del total final.</div><input type=number placeholder=0 min=0 max=99 step=0.01><div><div><label><input type=radio name=taxMethod><span>Del Subtotal (tradicional)</span></label><div>Impuesto = Subtotal  <!>%</div><label><input type=radio name=taxMethod><span>Del Total Final</span></label><div>El impuesto representa el <!>% del total final'),X8=ue("<span>(Ahorro: $<!>)"),Z8=ue("<div>Impuesto (<!>% <!>): $"),eD=ue("<div>Envo: "),tD=ue("<div><div>Productos: $</div><div>Reservas: $</div><div>Subtotal: $</div><div>Total: $"),rD=ue("<span><span></span>Auto-guardando cambios..."),nD=ue("<span><span></span>Guardado: "),iD=ue("<button>Limpiar Formulario"),oD=ue("<div><div>"),sD=ue("<button>"),aD=ue("<div><button></button><button> Nueva Factura"),lD=ue('<div><h2> Crear Nueva Factura</h2><div><div><div><h3> Informacin de Factura</h3><div><div><label>Nmero de Factura *</label><input type=text></div><div><label>Ubicacin de Tienda *</label></div></div><div><div><label>Mtodo de Envo</label><div>Seleccione el mtodo de transporte para esta orden.</div><select><option value>Seleccionar mtodo...</option><option value=AEREO> Areo (Avin)</option><option value=SEA> Martimo (Barco)</option></select></div><div><label>fecha</label><div>Seleccione una fecha si es diferente al dia de hoy.</div><input type=date></div></div><div><label>Descripcin de Factura</label><textarea placeholder="ej., Venta regular, pedido mayorista, descuento especial aplicado..."></textarea></div><label><input type=checkbox><div><span>Orden de Paquete/Envo</span><div>Marque esto si esta factura incluye servicios de envo o manejo de paquetes.</div></div></label></div></div><div>'),p1=ue("<span> ($<!>)"),cD=ue("<div>(<!><!>+<!>)"),uD=ue("<div><div><button></button></div><div><div><label>Cant (lbs)</label></div><div><label>Precio</label></div><div><label>Arancel</label></div><div>$"),dD=ue("<div><div><div><div></div><div></div></div><button></button></div><div><div>$"),hD=ue("<input step=0.01>"),fD=ue("<div><div><input type=text autocomplete=off><div>");const m1=[" Ropa"," Zapatos"," Ventilador"," tiles del Hogar"," TV"," Telfono Mvil"," Computadora/Laptop"," Audfonos"," Reloj"," Joyera"," Productos de Belleza"," Medicamentos"," Alimentos"," Juguetes"," Libros"," Videojuegos"," Herramientas"," Repuestos de Auto"," Artculos Deportivos"," Instrumentos Musicales"," Electrnicos"," Maletas"," Lentes"," Cables y Accesorios"," Equipos Mdicos"," Materiales de Arte"," Cmaras"," Bateras"," Productos de Limpieza"," Artculos para el Hogar","Transportacion","Cajas","Servicio de Rapeado"],pD={padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--background-color)"},st={container:{padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)"},header:{"font-size":"1.5rem","font-weight":"700",color:"var(--text-primary)","margin-bottom":"1.5rem"},grid:{display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem"},section:{background:"var(--background-color)",padding:"1.25rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},sectionTitle:{"font-size":"1.125rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"1rem",display:"flex","align-items":"center",gap:"0.5rem"},formGroup:{"margin-bottom":"1rem"},label:{display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},fieldDescription:{"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","line-height":"1.4","font-style":"italic"},input:{width:"100%",padding:"0.625rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",background:"var(--surface-color)",transition:"border-color 0.2s",outline:"none"},textarea:{width:"100%",padding:"0.625rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",background:"var(--surface-color)",resize:"vertical","min-height":"60px"},button:{padding:"0.625rem 1.25rem",border:"none","border-radius":"var(--border-radius-sm)","font-size":"0.875rem","font-weight":"500",cursor:"pointer",transition:"all 0.2s",display:"inline-flex","align-items":"center",gap:"0.5rem"},primaryButton:{background:"var(--primary-color)",color:"white"},secondaryButton:{background:"var(--secondary-color)",color:"white"},successButton:{background:"#4CAF50",color:"white"},alert:{padding:"0.75rem 1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1rem","font-size":"0.875rem",display:"flex","align-items":"center",gap:"0.5rem"},errorAlert:{background:"#ffebee",border:"1px solid #ffcdd2",color:"#d32f2f"},successAlert:{background:"#e8f5e9",border:"1px solid #c8e6c9",color:"#2e7d32"},productWrapItem:{padding:"0.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"0.5rem"},productItem:{display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem","margin-bottom":"0.5rem"},smallInput:{width:"70px",padding:"0.375rem 0.5rem","font-size":"0.8125rem"},removeButton:{background:"none",border:"none",color:"#f44336",cursor:"pointer","font-size":"1.25rem",padding:"0.25rem"},totalSection:{background:"var(--primary-color)",color:"white",padding:"1rem","border-radius":"var(--border-radius-sm)","text-align":"right"},gridTwo:{display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"}},mD=()=>{const{t}=tr(),e=Ur.formData,r=q=>Ur.updateForm(q),[n,i]=$e(null),[o,s]=$e(""),[a,c]=$e(""),[u,f]=$e(null);Nn(()=>{console.log("Styled invoice form mounted, loaded data:",e()),Ur.hasData()&&(w("Form data restored from previous session"),setTimeout(()=>w(""),3e3))});const[y,v]=$e(!1),[p,I]=$e(""),[P,w]=$e(""),[x,j]=$e(""),[ne,Q]=$e(!1),K=q=>{if(!q)return"";const ae=lt.getLocationById(q),de=ae?.code||ae?.name?.substring(0,3).toUpperCase()||"INV",V=new Date().toISOString().slice(0,10).replace(/-/g,"");return`${cS(6)}-${de}-${V}`};vo(()=>{const q=o();if(q&&!e().invoice.trim()){const ae=K(q);c(ae),r({invoice:ae})}}),vo(()=>{const q=n();q&&Ur.updateShipperConsignee({name:q.name,firstName:q.firstName||"",lastName:q.lastName||"",phoneNumber:q.phoneNumber||"",cid:q.cid||"",passport:q.passport||"",address:q.address||""})}),vo(()=>{});const Z=q=>{const ae=lt.getProductById(q);if(!ae)return;const de={id:Date.now().toString(),product:{id:ae.id,code:ae.sku||"",label:ae.name||"",price:ae.unitCost||0},qty:1,salePrice:ae.unitCost||0,total:ae.unitCost||0};Ur.addProduct(de)},k=q=>{s(q),r({store:q})},C=q=>{i(ae=>({...ae,...q}))},E=q=>{f({name:q?.name}),i(ae=>({...ae,phoneNumberS:q?.phoneNumberS,name:q?.name,dob:q?.dob}))},M=(q,ae,de)=>{const le=e().products,V=le.findIndex(ce=>ce.id===q);if(V!==-1){const ce={...le[V],[ae]:de};ce.total=ce.qty*ce.salePrice,Ur.updateProduct(V,ce)}},_=q=>{const ae=e().products.findIndex(de=>de.id===q);ae!==-1&&Ur.removeProduct(ae)},S=()=>{const q={id:Date.now().toString(),type:"",qty:1,price:0,arancel:0,total:0};Ur.addReserva(q)},b=(q,ae,de)=>{const le=e().reservas,V=le.findIndex(ce=>ce.id===q);if(V!==-1){const ce={...le[V],[ae]:de};(ae==="qty"||ae==="price"||ae==="arancel")&&(ce.total=Number(ce.qty)*Number(ce.price)+Number(ce.arancel)),Ur.updateReserva(V,ce)}},Y=q=>{const ae=e().reservas.findIndex(de=>de.id===q);ae!==-1&&Ur.removeReserva(ae)},te=()=>e().products.reduce((q,ae)=>q+ae.total,0),O=()=>e().reservas.reduce((q,ae)=>q+ae.total,0),D=()=>te()+O(),X=()=>{if(e()?.paymentMethods.taxPercent===0)return 0;if(e()?.paymentMethods.exemptTaxOnCash){const q=ie()>0?e().paymentMethods.cash/ie():0,ae=Math.min(q,1);let de;return e()?.paymentMethods.taxOnTotal?de=D()/(1-e()?.paymentMethods.taxPercent/100)-D():de=D()*(e()?.paymentMethods.taxPercent/100),de*(1-ae)}return e()?.paymentMethods.taxOnTotal?D()/(1-e()?.paymentMethods?.taxPercent/100)-D():D()*(e()?.paymentMethods?.taxPercent/100)},H=()=>{if(!e()?.paymentMethods.exemptTaxOnCash||e()?.paymentMethods.taxPercent===0)return 0;const q=ie()>0?e().paymentMethods.cash/ie():0,ae=Math.min(q,1);let de;return e()?.paymentMethods.taxOnTotal?de=D()/(1-e()?.paymentMethods?.taxPercent/100)-D():de=D()*(e()?.paymentMethods?.taxPercent/100),de*ae},F=()=>D()+X(),ie=()=>{const q=e().paymentMethods;return q.cash+q.zelle+q.creditCard},$=()=>F()-ie(),L=(q,ae)=>{Ur.updatePaymentMethods({[q]:ae})},U=(q,ae)=>{Ur.updatePaymentMethods({[q]:ae})},N=q=>{const ae=F();Ur.updatePaymentMethods({cash:q==="cash"?ae:0,zelle:q==="zelle"?ae:0,creditCard:q==="creditCard"?ae:0})},z=()=>{Ur.updatePaymentMethods({cash:0,zelle:0,creditCard:0})},oe=async()=>{v(!0),I(""),w("");try{if(!e().invoice.trim())throw new Error("Nmero de factura es requerido");if(!e().shipper_consignee.name.trim())throw new Error("Nombre del cliente es requerido");if(e().products.length===0&&e().reservas.length===0)throw new Error("Al menos un producto o reserva es requerido");if(Math.round($())>.01)throw new Error(`El total de pagos (${ie().toFixed()}) no coincide con el total de la factura (${F().toFixed()})`);const q={...e(),type:"SALES",ssg_inventory_key:`INVOICE-${Date.now()}`,ssg_sorder_key:`SO-${Date.now()}`,createDate:e().createDate||Date.now(),businessId:"YB100423253156428",isCompleted:!0,productSubtotal:te(),reservaSubtotal:O(),subtotalBeforeTax:D(),taxAmount:X(),taxSavings:H(),total:F(),shippingMethod:e().shippingMethod,taxCalculationMethod:e()?.paymentMethods.taxOnTotal?"total":"subtotal",cashPaymentRatio:ie()>0?e().paymentMethods.cash/ie():0,paymentMethods:e().paymentMethods};console.log("createInvoice",JSON.stringify(q,null,4));const ae=await Ai.addInventory(q);Ai.addInvoice(ae),j(ae.data),w(" Invoice created successfully! You can now generate a PDF."),Ur.markCompleted(),ee()}catch(q){I(q.message||"Error creating invoice")}finally{v(!1)}},G=async()=>{if(x()){Q(!0),I("");try{const{generateEnhancedInvoicePDF:q}=await Ui(async()=>{const{generateEnhancedInvoicePDF:V}=await import("./enhancedInvoicePdfGenerator-eWidPn1o.js");return{generateEnhancedInvoicePDF:V}},[]);console.log(JSON.stringify(e()));const de={invoiceId:x(),shippingMethod:e().shippingMethod,taxPercent:e()?.paymentMethods.taxPercent,taxOnTotal:e()?.paymentMethods.taxOnTotal,exemptTaxOnCash:e()?.paymentMethods.exemptTaxOnCash,paymentMethods:e().paymentMethods,productSubtotal:te(),reservaSubtotal:O(),subtotalBeforeTax:D(),taxAmount:X(),taxSavings:e()?.paymentMethods.exemptTaxOnCash?D()*e()?.paymentMethods.taxPercent/100-X():0,total:F(),cashPaymentRatio:ie()>0?e().paymentMethods.cash/ie():0};console.log(JSON.stringify(de));const le=await q({...e(),...de},"es","modern");w(` PDF generated successfully: ${le}`)}catch(q){I(q.message||"Error generating PDF")}finally{Q(!1)}}},ee=()=>{Ur.clearForm(),j(""),w(""),I("")},J=()=>Ur.hasData()&&Ur.isDirty,W=()=>{J()?confirm("Are you sure you want to clear the form? All unsaved changes will be lost.")&&ee():ee()};return Nn(()=>{}),(()=>{var q=lD(),ae=q.firstChild,de=ae.nextSibling,le=de.firstChild,V=le.firstChild,ce=V.firstChild,Pe=ce.nextSibling,fe=Pe.firstChild,be=fe.firstChild,xe=be.nextSibling,he=fe.nextSibling,ve=he.firstChild,De=Pe.nextSibling,Ee=De.firstChild,Ce=Ee.firstChild,Ne=Ce.nextSibling,Ie=Ne.nextSibling,Re=Ee.nextSibling,We=Re.firstChild,Fe=We.nextSibling,Xe=Fe.nextSibling,tt=De.nextSibling,At=tt.firstChild,rt=At.nextSibling,He=tt.nextSibling,xt=He.firstChild,_t=xt.nextSibling,mt=_t.firstChild,Et=mt.nextSibling,et=le.nextSibling;return l(q,B(Ge,{get when(){return p()},get children(){var qe=z8();return qe.firstChild,l(qe,p,null),Se(ot=>m(qe,{...st.alert,...st.errorAlert},ot)),qe}}),de),l(q,B(Ge,{get when(){return P()},get children(){var qe=jh();return l(qe,P),Se(ot=>m(qe,{...st.alert,...st.successAlert},ot)),qe}}),de),xe.$$input=qe=>r({invoice:qe.target.value}),l(he,B(Ou,{get value(){return o()},onChange:k,get placeholder(){return t("inventory.selectStoreLocation","Buscar y seleccionar ubicacin de tienda...")},filterType:"store",required:!0}),null),Ie.addEventListener("change",qe=>r({shippingMethod:qe.currentTarget.value})),Xe.addEventListener("change",qe=>r({createDate:qe.currentTarget.value})),m(Xe,pD),rt.$$input=qe=>r({description:qe.target.value}),xt.addEventListener("change",qe=>r({packagesOrder:qe.target.checked})),l(le,B(Ge,{get when(){return Te(()=>!!(e().shippingMethod&&e().invoice))()&&o()},get children(){return[(()=>{var qe=q8(),ot=qe.firstChild,Je=ot.nextSibling,at=Je.nextSibling,dt=at.firstChild,It=dt.firstChild,jt=It.nextSibling,Gt=dt.nextSibling,yt=Gt.firstChild,Qt=yt.nextSibling;return l(Je,B(V8,{get value(){return u()},onChange:E,label:"Buscar Cliente Existente",description:"Busque clientes existentes por nombre, telfono o ID. Si no se encuentra, complete el formulario a continuacin para crear un nuevo cliente.",placeholder:"Escriba nombre del cliente, nmero de telfono o ID para buscar..."})),jt.$$input=Mt=>Ur.updateShipperConsignee({name:Mt.target.value}),Qt.$$input=Mt=>Ur.updateShipperConsignee({phoneNumber:Mt.target.value}),Se(Mt=>{var Kt={...st.section,"margin-top":"1rem"},Xt=st.sectionTitle,ht=st.formGroup,wt=st.gridTwo,Ut=st.formGroup,Ze=st.label,Vt=st.input,Ft=st.formGroup,Jt=st.label,er=st.input;return Mt.e=m(qe,Kt,Mt.e),Mt.t=m(ot,Xt,Mt.t),Mt.a=m(Je,ht,Mt.a),Mt.o=m(at,wt,Mt.o),Mt.i=m(dt,Ut,Mt.i),Mt.n=m(It,Ze,Mt.n),Mt.s=m(jt,Vt,Mt.s),Mt.h=m(Gt,Ft,Mt.h),Mt.r=m(yt,Jt,Mt.r),Mt.d=m(Qt,er,Mt.d),Mt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),Se(()=>jt.value=e().shipper_consignee.name),Se(()=>Qt.value=e().shipper_consignee.phoneNumber||""),qe})(),(()=>{var qe=U8(),ot=qe.firstChild,Je=ot.nextSibling,at=Je.nextSibling,dt=at.firstChild,It=dt.nextSibling,jt=at.nextSibling,Gt=jt.firstChild,yt=Gt.nextSibling,Qt=jt.nextSibling,Mt=Qt.firstChild,Kt=Mt.nextSibling,Xt=Qt.nextSibling,ht=Xt.firstChild,wt=ht.nextSibling,Ut=Xt.nextSibling,Ze=Ut.firstChild,Vt=Ze.nextSibling,Ft=Ut.nextSibling,Jt=Ft.firstChild,er=Jt.nextSibling;return l(Je,B(R8,{get value(){return n()},onChange:C,label:"Buscar Destinatario Existente",description:"Busque Destinatario existentes por telfono o ID. Si no se encuentra, complete el formulario a continuacin para crear un nuevo destinatario.",placeholder:"Escriba nombre del destinatario, nmero de telfono o ID para buscar..."})),It.$$input=gt=>Ur.updateShipperConsignee({firstName:gt.target.value}),yt.$$input=gt=>Ur.updateShipperConsignee({lastName:gt.target.value}),Kt.$$input=gt=>Ur.updateShipperConsignee({cid:gt.target.value}),wt.$$input=gt=>Ur.updateShipperConsignee({passport:gt.target.value}),Vt.$$input=gt=>Ur.updateShipperConsignee({phoneNumber:gt.target.value}),er.$$input=gt=>Ur.updateShipperConsignee({address:gt.target.value}),Se(gt=>{var dr={...st.section,"margin-top":"1rem"},Er=st.sectionTitle,mr=st.formGroup,xr=st.formGroup,Vr=st.label,kt=st.input,Cr=st.formGroup,$r=st.label,hr=st.input,yr=st.formGroup,Ir=st.label,Hr=st.input,rr=st.formGroup,on=st.label,vn=st.input,Ln=st.formGroup,bn=st.label,gn=st.input,Br=st.formGroup,Vn=st.label,Xn=st.textarea;return gt.e=m(qe,dr,gt.e),gt.t=m(ot,Er,gt.t),gt.a=m(Je,mr,gt.a),gt.o=m(at,xr,gt.o),gt.i=m(dt,Vr,gt.i),gt.n=m(It,kt,gt.n),gt.s=m(jt,Cr,gt.s),gt.h=m(Gt,$r,gt.h),gt.r=m(yt,hr,gt.r),gt.d=m(Qt,yr,gt.d),gt.l=m(Mt,Ir,gt.l),gt.u=m(Kt,Hr,gt.u),gt.c=m(Xt,rr,gt.c),gt.w=m(ht,on,gt.w),gt.m=m(wt,vn,gt.m),gt.f=m(Ut,Ln,gt.f),gt.y=m(Ze,bn,gt.y),gt.g=m(Vt,gn,gt.g),gt.p=m(Ft,Br,gt.p),gt.b=m(Jt,Vn,gt.b),gt.T=m(er,Xn,gt.T),gt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),Se(()=>It.value=e().shipper_consignee.firstName||""),Se(()=>yt.value=e().shipper_consignee.lastName||""),Se(()=>Kt.value=e().shipper_consignee.cid||""),Se(()=>wt.value=e().shipper_consignee.passport||""),Se(()=>Vt.value=e().shipper_consignee.phoneNumber||""),Se(()=>er.value=e().shipper_consignee.address||""),qe})()]}}),null),l(et,B(Ge,{get when(){return Te(()=>!!(e().shippingMethod&&e().invoice&&e().shipper_consignee?.cid))()&&e().shipper_consignee?.name},get children(){return[(()=>{var qe=H8(),ot=qe.firstChild,Je=ot.firstChild,at=Je.nextSibling;return at.$$click=S,l(qe,B(Ht,{get each(){return e().reservas},children:dt=>B(yD,{updateReserva:b,reserva:dt,removeReserva:Y})}),null),l(qe,B(Ge,{get when(){return e().reservas.length>0},get children(){var dt=f1(),It=dt.firstChild;return It.firstChild,dt.style.setProperty("margin-top","0.75rem"),dt.style.setProperty("padding-top","0.75rem"),dt.style.setProperty("border-top","1px solid var(--border-color)"),dt.style.setProperty("text-align","right"),l(It,()=>O().toFixed(),null),dt}}),null),Se(dt=>{var It={...st.section,"margin-top":"1rem"},jt={...st.sectionTitle,"justify-content":"space-between"},Gt={...st.button,...st.successButton};return dt.e=m(qe,It,dt.e),dt.t=m(ot,jt,dt.t),dt.a=m(at,Gt,dt.a),dt},{e:void 0,t:void 0,a:void 0}),qe})(),(()=>{var qe=W8(),ot=qe.firstChild,Je=ot.nextSibling,at=Je.firstChild;return l(Je,B(I8,{value:"",onChange:Z,get placeholder(){return t("inventory.searchProductsToAdd","Buscar productos por nombre, SKU o categora para agregar a la factura...")},searchDelay:300,maxResults:15}),null),l(qe,B(Ht,{get each(){return e().products},children:dt=>B(gD,{product:dt,updateProduct:M,removeProduct:_})}),null),l(qe,B(Ge,{get when(){return e().products.length>0},get children(){var dt=f1(),It=dt.firstChild;return It.firstChild,dt.style.setProperty("margin-top","0.75rem"),dt.style.setProperty("padding-top","0.75rem"),dt.style.setProperty("border-top","1px solid var(--border-color)"),dt.style.setProperty("text-align","right"),l(It,()=>te().toFixed(),null),dt}}),null),Se(dt=>{var It={...st.section,"margin-top":"1rem"},jt={...st.sectionTitle,"justify-content":"space-between"},Gt=st.formGroup,yt=st.label;return dt.e=m(qe,It,dt.e),dt.t=m(ot,jt,dt.t),dt.a=m(Je,Gt,dt.a),dt.o=m(at,yt,dt.o),dt},{e:void 0,t:void 0,a:void 0,o:void 0}),qe})(),(()=>{var qe=Q8(),ot=qe.firstChild,Je=ot.nextSibling,at=Je.nextSibling,dt=at.firstChild;dt.firstChild;var It=dt.nextSibling,jt=It.nextSibling,Gt=jt.nextSibling,yt=at.nextSibling,Qt=yt.firstChild,Mt=Qt.firstChild,Kt=Mt.nextSibling,Xt=Qt.nextSibling,ht=Xt.firstChild,wt=ht.nextSibling,Ut=yt.nextSibling,Ze=Ut.firstChild,Vt=Ze.nextSibling,Ft=Ut.nextSibling,Jt=Ft.firstChild,er=Jt.firstChild,gt=er.firstChild,dr=gt.nextSibling;dr.firstChild;var Er=er.nextSibling,mr=Er.firstChild,xr=mr.nextSibling;xr.firstChild;var Vr=Jt.nextSibling,kt=Vr.firstChild,Cr=kt.firstChild,$r=Cr.nextSibling;$r.firstChild;var hr=kt.nextSibling,yr=Ft.nextSibling,Ir=yr.firstChild,Hr=Ir.nextSibling,rr=Hr.nextSibling,on=rr.nextSibling,vn=on.firstChild,Ln=vn.firstChild,bn=Ln.firstChild,gn=Ln.nextSibling,Br=gn.firstChild,Vn=Br.nextSibling;Vn.nextSibling;var Xn=gn.nextSibling,Ni=Xn.firstChild,nr=Xn.nextSibling,Tr=nr.firstChild,Gr=Tr.nextSibling;return Gr.nextSibling,at.style.setProperty("display","flex"),at.style.setProperty("gap","0.5rem"),at.style.setProperty("margin-bottom","1rem"),at.style.setProperty("flex-wrap","wrap"),dt.$$click=()=>N("cash"),l(dt,B(Ge,{get when(){return Te(()=>!!e()?.paymentMethods.exemptTaxOnCash)()&&e()?.paymentMethods.taxPercent>0},get children(){var bt=G8();return bt.style.setProperty("font-size","0.6rem"),bt.style.setProperty("display","block"),bt.style.setProperty("line-height","1"),bt}}),null),It.$$click=()=>N("zelle"),jt.$$click=()=>N("creditCard"),Gt.$$click=z,Kt.$$input=bt=>L("cash",parseFloat(bt.target.value)||0),wt.$$input=bt=>L("zelle",parseFloat(bt.target.value)||0),Vt.$$input=bt=>L("creditCard",parseFloat(bt.target.value)||0),Ft.style.setProperty("margin-top","1rem"),Ft.style.setProperty("padding-top","1rem"),Ft.style.setProperty("border-top","1px solid var(--border-color)"),Ft.style.setProperty("display","grid"),Ft.style.setProperty("grid-template-columns","1fr 1fr"),Ft.style.setProperty("gap","1rem"),Ft.style.setProperty("font-size","0.875rem"),l(dr,()=>ie().toFixed(),null),l(xr,()=>$().toFixed(),null),Vr.style.setProperty("text-align","right"),l($r,()=>F().toFixed(),null),hr.style.setProperty("font-weight","500"),l(hr,(()=>{var bt=Te(()=>Math.round($())===0);return()=>bt()?" Pagado Completo":$()>0?"Falta Pagar":"Sobrepago"})()),l(yr,B(Ge,{get when(){return Te(()=>e()?.paymentMethods.taxPercent>0)()&&D()>0},get children(){var bt=Y8(),ar=bt.firstChild,pr=ar.nextSibling;pr.firstChild;var Wr=pr.nextSibling,Fr=Wr.firstChild,dn=Fr.nextSibling,Sr=dn.nextSibling,Gn=Sr.nextSibling;Gn.nextSibling;var wn=Wr.nextSibling,Zn=wn.firstChild,Wi=Zn.nextSibling,hi=Wi.nextSibling,ei=hi.nextSibling;return ei.nextSibling,bt.style.setProperty("margin-top","0.5rem"),bt.style.setProperty("padding","0.5rem"),bt.style.setProperty("background","var(--strip-color)"),bt.style.setProperty("border-radius","var(--border-radius-sm)"),bt.style.setProperty("font-size","0.75rem"),bt.style.setProperty("border","1px solid var(--border-color)"),ar.style.setProperty("font-weight","500"),ar.style.setProperty("margin-bottom","0.25rem"),l(pr,()=>D().toFixed(2),null),l(Wr,()=>(D()*e()?.paymentMethods?.taxPercent/100).toFixed(2),dn),l(Wr,()=>(D()+D()*e()?.paymentMethods?.taxPercent/100).toFixed(2),Gn),l(wn,()=>X().toFixed(2),Wi),l(wn,()=>F().toFixed(2),ei),Se(xn=>{var ti=e()?.paymentMethods?.taxOnTotal?"var(--primary-color)":"var(--text-muted)",Li=e()?.paymentMethods?.taxOnTotal?"var(--text-muted)":"var(--primary-color)";return ti!==xn.e&&((xn.e=ti)!=null?Wr.style.setProperty("color",ti):Wr.style.removeProperty("color")),Li!==xn.t&&((xn.t=Li)!=null?wn.style.setProperty("color",Li):wn.style.removeProperty("color")),xn},{e:void 0,t:void 0}),bt}}),rr),rr.$$input=bt=>L("taxPercent",parseFloat(bt.target.value)||0),on.style.setProperty("margin-top","0.5rem"),on.style.setProperty("align-items","center"),on.style.setProperty("gap","0.5rem"),vn.style.setProperty("margin-top","0.5rem"),bn.addEventListener("change",()=>L("taxOnTotal",!1)),l(gn,()=>e()?.paymentMethods?.taxPercent,Vn),l(gn,(()=>{var bt=Te(()=>e()?.paymentMethods?.taxPercent>0&&!e()?.paymentMethods?.taxOnTotal);return()=>bt()&&(()=>{var ar=p1(),pr=ar.firstChild,Wr=pr.nextSibling;return Wr.nextSibling,ar.style.setProperty("color","var(--primary-color)"),l(ar,()=>(D()*e()?.paymentMethods?.taxPercent/100).toFixed(2),Wr),ar})()})(),null),Ni.addEventListener("change",()=>L("taxOnTotal",!0)),l(nr,()=>e()?.paymentMethods?.taxPercent,Gr),l(nr,(()=>{var bt=Te(()=>!!(e()?.paymentMethods?.taxPercent>0&&e()?.paymentMethods?.taxOnTotal));return()=>bt()&&(()=>{var ar=p1(),pr=ar.firstChild,Wr=pr.nextSibling;return Wr.nextSibling,ar.style.setProperty("color","var(--primary-color)"),l(ar,()=>X().toFixed(2),Wr),ar})()})(),null),l(on,B(Ge,{get when(){return e()?.paymentMethods?.taxPercent>0},get children(){var bt=J8(),ar=bt.firstChild,pr=ar.firstChild,Wr=ar.nextSibling;return bt.style.setProperty("margin-top","1rem"),bt.style.setProperty("padding-top","1rem"),bt.style.setProperty("border-top","1px solid var(--border-color)"),pr.addEventListener("change",Fr=>U("exemptTaxOnCash",Fr.target.checked)),l(bt,B(Ge,{get when(){return Te(()=>!!e()?.paymentMethods?.exemptTaxOnCash)()&&ie()>0},get children(){var Fr=K8(),dn=Fr.firstChild,Sr=dn.nextSibling,Gn=Sr.firstChild,wn=Gn.nextSibling,Zn=wn.nextSibling,Wi=Zn.nextSibling;Wi.nextSibling;var hi=Sr.nextSibling;hi.firstChild;var ei=hi.nextSibling,xn=ei.firstChild,ti=xn.nextSibling;return ti.nextSibling,Fr.style.setProperty("margin-top","0.5rem"),Fr.style.setProperty("padding","0.75rem"),Fr.style.setProperty("background","#e8f5e9"),Fr.style.setProperty("border-radius","var(--border-radius-sm)"),Fr.style.setProperty("font-size","0.875rem"),Fr.style.setProperty("border","1px solid #c8e6c9"),dn.style.setProperty("font-weight","500"),dn.style.setProperty("color","#2e7d32"),dn.style.setProperty("margin-bottom","0.5rem"),l(Sr,()=>e().paymentMethods.cash.toFixed(2),wn),l(Sr,()=>(e().paymentMethods.cash/ie()*100).toFixed(1),Wi),hi.style.setProperty("color","#4CAF50"),hi.style.setProperty("font-weight","500"),l(hi,()=>H().toFixed(2),null),ei.style.setProperty("font-size","0.8rem"),ei.style.setProperty("color","#666"),ei.style.setProperty("margin-top","0.25rem"),l(ei,()=>(X()+H()).toFixed(2),ti),l(ei,()=>X().toFixed(2),null),Fr}}),null),Se(Fr=>{var dn={...st.label,display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"0.5rem"},Sr=st.fieldDescription;return Fr.e=m(ar,dn,Fr.e),Fr.t=m(Wr,Sr,Fr.t),Fr},{e:void 0,t:void 0}),Se(()=>pr.checked=e()?.paymentMethods?.exemptTaxOnCash),bt}}),null),Se(bt=>{var ar={...st.section,"margin-top":"1rem"},pr=st.sectionTitle,Wr=st.fieldDescription,Fr={...st.button,...e()?.paymentMethods.exemptTaxOnCash&&e()?.paymentMethods.taxPercent>0?{background:"#4CAF50",color:"white"}:st.secondaryButton,"font-size":"0.75rem",padding:"0.5rem 0.75rem",position:"relative"},dn=e()?.paymentMethods.exemptTaxOnCash&&e()?.paymentMethods.taxPercent>0?`Pagar todo en efectivo (Ahorro: $${(D()*e()?.paymentMethods.taxPercent/100).toFixed(2)})`:"Pagar todo en efectivo",Sr={...st.button,...st.secondaryButton,"font-size":"0.75rem",padding:"0.5rem 0.75rem"},Gn={...st.button,...st.secondaryButton,"font-size":"0.75rem",padding:"0.5rem 0.75rem"},wn={...st.button,background:"#f44336",color:"white","font-size":"0.75rem",padding:"0.5rem 0.75rem"},Zn=st.gridTwo,Wi=st.formGroup,hi=st.label,ei=st.input,xn=st.formGroup,ti=st.label,Li=st.input,no=st.formGroup,sn=st.label,js=st.input,bo=parseFloat($().toFixed())===0?"#4CAF50":$()>0?"#f44336":"#FF9800",ir=parseFloat($().toFixed())===0?"#4CAF50":"#f44336",io=st.formGroup,za=st.label,Di=st.fieldDescription,Vs=st.input,Ii={...st.label,display:"flex","align-items":"center",gap:"0.5rem","font-size":"0.8rem","margin-bottom":"0.25rem"},Oo={...st.fieldDescription,"margin-left":"1.5rem","margin-bottom":"0.5rem"},cs={...st.label,display:"flex","align-items":"center",gap:"0.5rem","font-size":"0.8rem","margin-bottom":"0.25rem"},Bo={...st.fieldDescription,"margin-left":"1.5rem"};return bt.e=m(qe,ar,bt.e),bt.t=m(ot,pr,bt.t),bt.a=m(Je,Wr,bt.a),bt.o=m(dt,Fr,bt.o),dn!==bt.i&&Yt(dt,"title",bt.i=dn),bt.n=m(It,Sr,bt.n),bt.s=m(jt,Gn,bt.s),bt.h=m(Gt,wn,bt.h),bt.r=m(yt,Zn,bt.r),bt.d=m(Qt,Wi,bt.d),bt.l=m(Mt,hi,bt.l),bt.u=m(Kt,ei,bt.u),bt.c=m(Xt,xn,bt.c),bt.w=m(ht,ti,bt.w),bt.m=m(wt,Li,bt.m),bt.f=m(Ut,no,bt.f),bt.y=m(Ze,sn,bt.y),bt.g=m(Vt,js,bt.g),bo!==bt.p&&((bt.p=bo)!=null?Er.style.setProperty("color",bo):Er.style.removeProperty("color")),ir!==bt.b&&((bt.b=ir)!=null?hr.style.setProperty("color",ir):hr.style.removeProperty("color")),bt.T=m(yr,io,bt.T),bt.A=m(Ir,za,bt.A),bt.O=m(Hr,Di,bt.O),bt.I=m(rr,Vs,bt.I),bt.S=m(Ln,Ii,bt.S),bt.W=m(gn,Oo,bt.W),bt.C=m(Xn,cs,bt.C),bt.B=m(nr,Bo,bt.B),bt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),Se(()=>Kt.value=e().paymentMethods.cash),Se(()=>wt.value=e().paymentMethods.zelle),Se(()=>Vt.value=e().paymentMethods.creditCard),Se(()=>rr.value=e()?.paymentMethods?.taxPercent),Se(()=>bn.checked=!e()?.paymentMethods?.taxOnTotal),Se(()=>Ni.checked=e()?.paymentMethods?.taxOnTotal),qe})(),(()=>{var qe=tD(),ot=qe.firstChild;ot.firstChild;var Je=ot.nextSibling;Je.firstChild;var at=Je.nextSibling;at.firstChild;var dt=at.nextSibling;return dt.firstChild,ot.style.setProperty("font-size","0.875rem"),ot.style.setProperty("opacity","0.9"),l(ot,()=>te().toFixed(),null),Je.style.setProperty("font-size","0.875rem"),Je.style.setProperty("opacity","0.9"),l(Je,()=>O().toFixed(),null),at.style.setProperty("font-size","0.875rem"),at.style.setProperty("opacity","0.9"),at.style.setProperty("border-top","1px solid rgba(255,255,255,0.2)"),at.style.setProperty("padding-top","0.5rem"),at.style.setProperty("margin-top","0.5rem"),l(at,()=>D().toFixed(2),null),l(qe,B(Ge,{get when(){return e()?.paymentMethods?.taxPercent>0},get children(){var It=Z8(),jt=It.firstChild,Gt=jt.nextSibling,yt=Gt.nextSibling,Qt=yt.nextSibling;return Qt.nextSibling,It.style.setProperty("font-size","0.875rem"),It.style.setProperty("opacity","0.9"),l(It,()=>e()?.paymentMethods?.taxPercent,Gt),l(It,()=>e()?.paymentMethods?.taxOnTotal?"del total":"del subtotal",Qt),l(It,()=>X().toFixed(2),null),l(It,B(Ge,{get when(){return Te(()=>!!e()?.paymentMethods?.exemptTaxOnCash)()&&H()>0},get children(){var Mt=X8(),Kt=Mt.firstChild,Xt=Kt.nextSibling;return Xt.nextSibling,Mt.style.setProperty("color","#4CAF50"),Mt.style.setProperty("margin-left","0.5rem"),l(Mt,()=>H().toFixed(2),Xt),Mt}}),null),It}}),dt),l(qe,B(Ge,{get when(){return e().shippingMethod},get children(){var It=eD();return It.firstChild,It.style.setProperty("font-size","0.875rem"),It.style.setProperty("opacity","0.9"),l(It,()=>e().shippingMethod==="aereo"?" Areo":" Martimo",null),It}}),dt),dt.style.setProperty("font-size","1.5rem"),dt.style.setProperty("font-weight","700"),dt.style.setProperty("margin-top","0.5rem"),dt.style.setProperty("border-top","1px solid rgba(255,255,255,0.3)"),dt.style.setProperty("padding-top","0.5rem"),l(dt,()=>F().toFixed(0),null),Se(It=>m(qe,st.totalSection,It)),qe})(),B(Ge,{get when(){return Ur.isDirty||Ur.lastSaved},get children(){var qe=oD(),ot=qe.firstChild;return qe.style.setProperty("margin-top","1rem"),qe.style.setProperty("background","rgba(76, 175, 80, 0.1)"),qe.style.setProperty("border","1px solid rgba(76, 175, 80, 0.3)"),qe.style.setProperty("border-radius","var(--border-radius-sm)"),qe.style.setProperty("padding","0.75rem"),ot.style.setProperty("display","flex"),ot.style.setProperty("align-items","center"),ot.style.setProperty("justify-content","space-between"),ot.style.setProperty("font-size","0.875rem"),l(ot,B(Ge,{get when(){return Ur.isDirty},get children(){var Je=rD(),at=Je.firstChild;return Je.style.setProperty("color","#4CAF50"),Je.style.setProperty("display","flex"),Je.style.setProperty("align-items","center"),Je.style.setProperty("gap","0.5rem"),at.style.setProperty("width","8px"),at.style.setProperty("height","8px"),at.style.setProperty("background","#4CAF50"),at.style.setProperty("border-radius","50%"),at.style.setProperty("display","inline-block"),at.style.setProperty("animation","pulse 2s infinite"),Je}}),null),l(ot,B(Ge,{get when(){return!Ur.isDirty&&Ur.lastSaved},get children(){var Je=nD(),at=Je.firstChild;return at.nextSibling,Je.style.setProperty("color","#4CAF50"),Je.style.setProperty("display","flex"),Je.style.setProperty("align-items","center"),Je.style.setProperty("gap","0.5rem"),at.style.setProperty("width","8px"),at.style.setProperty("height","8px"),at.style.setProperty("background","#4CAF50"),at.style.setProperty("border-radius","50%"),at.style.setProperty("display","inline-block"),l(Je,()=>Ur.lastSaved?.toLocaleTimeString(),null),Je}}),null),l(ot,B(Ge,{get when(){return J()},get children(){var Je=iD();return Je.$$click=W,Je.style.setProperty("background","none"),Je.style.setProperty("border","none"),Je.style.setProperty("color","#f44336"),Je.style.setProperty("cursor","pointer"),Je.style.setProperty("font-size","0.75rem"),Je.style.setProperty("text-decoration","underline"),Je}}),null),qe}}),(()=>{var qe=jh();return qe.style.setProperty("margin-top","1rem"),l(qe,B(Ge,{get when(){return!x()},get children(){var ot=sD();return ot.$$click=oe,l(ot,()=>y()?" Creando Factura...":" Crear Factura"),Se(Je=>{var at=y()||!e().invoice.trim()||!e().shipper_consignee.name.trim()||Math.round($())>.01,dt={...st.button,...st.primaryButton,width:"100%","justify-content":"center",padding:"0.875rem","font-size":"1rem",opacity:y()||!e().invoice.trim()||!e().shipper_consignee.name.trim()||Math.round($())>.01?"0.6":"1"},It=e().invoice.trim()?e().shipper_consignee.name.trim()?Math.abs($())>.01?`El balance de pago debe ser $0.00 (actual: $${$().toFixed(2)})`:"Crear esta factura":"Por favor ingrese el nombre del cliente":"Por favor ingrese un nmero de factura";return at!==Je.e&&(ot.disabled=Je.e=at),Je.t=m(ot,dt,Je.t),It!==Je.a&&Yt(ot,"title",Je.a=It),Je},{e:void 0,t:void 0,a:void 0}),ot}}),null),l(qe,B(Ge,{get when(){return x()},get children(){var ot=aD(),Je=ot.firstChild,at=Je.nextSibling;return ot.style.setProperty("display","grid"),ot.style.setProperty("grid-template-columns","1fr 1fr"),ot.style.setProperty("gap","0.75rem"),Je.$$click=G,l(Je,()=>ne()?" Generando...":" Generar PDF"),at.$$click=W,Se(dt=>{var It=ne(),jt={...st.button,...st.successButton,"justify-content":"center",opacity:ne()?"0.6":"1"},Gt={...st.button,...st.secondaryButton,"justify-content":"center"};return It!==dt.e&&(Je.disabled=dt.e=It),dt.t=m(Je,jt,dt.t),dt.a=m(at,Gt,dt.a),dt},{e:void 0,t:void 0,a:void 0}),ot}}),null),qe})()]}})),Se(qe=>{var ot=st.container,Je=st.header,at=st.grid,dt=st.section,It=st.sectionTitle,jt=st.gridTwo,Gt=st.formGroup,yt=st.label,Qt=st.input,Mt=a()||"INV-20241201-1234",Kt=st.formGroup,Xt=st.label,ht=st.gridTwo,wt=st.formGroup,Ut=st.label,Ze=st.fieldDescription,Vt=st.input,Ft=st.formGroup,Jt=st.label,er=st.fieldDescription,gt=st.formGroup,dr=st.label,Er=st.textarea,mr={...st.label,display:"flex","align-items":"center",gap:"0.5rem"},xr=st.fieldDescription;return qe.e=m(q,ot,qe.e),qe.t=m(ae,Je,qe.t),qe.a=m(de,at,qe.a),qe.o=m(V,dt,qe.o),qe.i=m(ce,It,qe.i),qe.n=m(Pe,jt,qe.n),qe.s=m(fe,Gt,qe.s),qe.h=m(be,yt,qe.h),qe.r=m(xe,Qt,qe.r),Mt!==qe.d&&Yt(xe,"placeholder",qe.d=Mt),qe.l=m(he,Kt,qe.l),qe.u=m(ve,Xt,qe.u),qe.c=m(De,ht,qe.c),qe.w=m(Ee,wt,qe.w),qe.m=m(Ce,Ut,qe.m),qe.f=m(Ne,Ze,qe.f),qe.y=m(Ie,Vt,qe.y),qe.g=m(Re,Ft,qe.g),qe.p=m(We,Jt,qe.p),qe.b=m(Fe,er,qe.b),qe.T=m(tt,gt,qe.T),qe.A=m(At,dr,qe.A),qe.O=m(rt,Er,qe.O),qe.I=m(He,mr,qe.I),qe.S=m(Et,xr,qe.S),qe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0}),Se(()=>xe.value=e().invoice),Se(()=>Ie.value=e().shippingMethod),Se(()=>Xe.value=e().createDate),Se(()=>rt.value=e().description),Se(()=>xt.checked=e().packagesOrder),q})()},yD=t=>{let{reserva:e,updateReserva:r,removeReserva:n}=t;return(()=>{var i=uD(),o=i.firstChild,s=o.firstChild,a=o.nextSibling,c=a.firstChild,u=c.firstChild,f=c.nextSibling,y=f.firstChild,v=f.nextSibling,p=v.firstChild,I=v.nextSibling;return I.firstChild,l(o,B(vD,{get value(){return e.type},onChange:P=>r(e.id,"type",P),placeholder:"ej., Ropa, Zapatos, TV, tiles del Hogar...",width:"80%",index:1}),s),s.$$click=()=>n(e.id),l(c,B(Pu,{type:"number",get value(){return e.qty},update:P=>r(e.id,"qty",parseFloat(P)||0),get style(){return{...st.input,...st.smallInput,width:"60px"}},placeholder:"Cant",min:"1",step:"0.01",index:2}),null),l(f,B(Pu,{type:"number",get value(){return e.price},update:P=>r(e.id,"price",parseFloat(P)||0),get style(){return{...st.input,...st.smallInput}},placeholder:"Precio",step:"0.01",index:3}),null),l(v,B(Pu,{type:"number",get value(){return e.arancel},update:P=>r(e.id,"arancel",parseFloat(P)||0),get style(){return{...st.input,...st.smallInput}},placeholder:"Arancel",step:"0.01",index:4}),null),I.style.setProperty("width","80px"),I.style.setProperty("text-align","right"),I.style.setProperty("font-weight","500"),l(I,()=>e.total?.toFixed(2)||"0.00",null),l(I,B(Ge,{get when(){return!1},get children(){var P=cD(),w=P.firstChild,x=w.nextSibling,j=x.nextSibling,ne=j.nextSibling,Q=ne.nextSibling,K=Q.nextSibling;return K.nextSibling,P.style.setProperty("font-size","0.6rem"),P.style.setProperty("color","var(--text-muted)"),l(P,()=>e.qty,x),l(P,()=>e.price,ne),l(P,()=>e.arancel,K),P}}),null),Se(P=>{var w=st.productWrapItem,x={...st.productItem,"justify-content":"space-around"},j=st.removeButton,ne=st.productItem,Q=st.formGroup,K=st.label,Z=st.formGroup,k=st.label,C=st.formGroup,E=st.label;return P.e=m(i,w,P.e),P.t=m(o,x,P.t),P.a=m(s,j,P.a),P.o=m(a,ne,P.o),P.i=m(c,Q,P.i),P.n=m(u,K,P.n),P.s=m(f,Z,P.s),P.h=m(y,k,P.h),P.r=m(v,C,P.r),P.d=m(p,E,P.d),P},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),i})()},gD=t=>{let{product:e,updateProduct:r,removeProduct:n}=t;return(()=>{var i=dD(),o=i.firstChild,s=o.firstChild,a=s.firstChild,c=a.nextSibling,u=s.nextSibling,f=o.nextSibling,y=f.firstChild;return y.firstChild,s.style.setProperty("flex","1"),a.style.setProperty("font-weight","500"),a.style.setProperty("font-size","0.875rem"),l(a,()=>e?.product.label),c.style.setProperty("font-size","0.75rem"),c.style.setProperty("color","var(--text-muted)"),l(c,()=>e?.product.code),u.$$click=()=>n(e?.id),l(f,B(Pu,{type:"number",get value(){return e?.qty},placeholder:"Cant",update:v=>r(e?.id,"qty",parseFloat(v)||0)}),y),l(f,B(Pu,{type:"number",get value(){return e?.salePrice},placeholder:"Precio",update:v=>r(e?.id,"salePrice",parseFloat(v)||0)}),y),y.style.setProperty("width","80px"),y.style.setProperty("text-align","right"),y.style.setProperty("font-weight","500"),l(y,()=>e?.total.toFixed(2),null),Se(v=>{var p=st.productWrapItem,I=st.productItem,P=st.removeButton,w=st.productItem;return v.e=m(i,p,v.e),v.t=m(o,I,v.t),v.a=m(u,P,v.a),v.o=m(f,w,v.o),v},{e:void 0,t:void 0,a:void 0,o:void 0}),i})()},Pu=t=>{const[e,r]=$e("");Nn(()=>{t?.value!==void 0&&r(t.value.toString())});const n=o=>{(o.key==="Enter"||o.key==="Escape"||o.key==="Tab")&&t.update&&uu(e())&&t.update(e())},i=()=>{t.update&&uu(e())&&t.update(e())};return(()=>{var o=hD();return o.addEventListener("blur",i),o.$$keydown=n,o.$$input=s=>r(s.target.value),Se(s=>{var a=t?.type,c={...st.input,...st.smallInput,width:t?.width||"90px"},u=t.placeholder,f=t.title,y=t?.index;return a!==s.e&&Yt(o,"type",s.e=a),s.t=m(o,c,s.t),u!==s.a&&Yt(o,"placeholder",s.a=u),f!==s.o&&Yt(o,"title",s.o=f),y!==s.i&&Yt(o,"tabindex",s.i=y),s},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>o.value=e()),o})()},vD=t=>{const[e,r]=$e(!1),[n,i]=$e(""),[o,s]=$e(-1),a=()=>{const ne=n().toLowerCase();if(!ne)return m1;const Q=m1.filter(K=>K.toLowerCase().includes(ne));return Q.length===0&&ne.length>0?[` Agregar "${n()}"`]:Q},c=()=>{r(!0),i(""),s(-1)},u=ne=>{const K=ne.target.value;i(K),r(K.length>0),s(-1)},f=ne=>{let Q;ne.startsWith(" Agregar")?Q=n():Q=ne.replace(/^[\u{1F000}-\u{1F9FF}\u{2600}-\u{27BF}]\s*/u,""),t.onChange(Q),r(!1),i(""),s(-1)},y=ne=>{const Q=a();switch(ne.key){case"ArrowDown":ne.preventDefault(),s(K=>Math.min(K+1,Q.length-1));break;case"ArrowUp":ne.preventDefault(),s(K=>Math.max(K-1,-1));break;case"Enter":ne.preventDefault(),o()>=0&&Q[o()]?f(Q[o()]):(t.onChange(n()||t.value),r(!1));break;case"Escape":r(!1),i(""),s(-1);break}},v=()=>{setTimeout(()=>{n()&&n()!==t.value&&t.onChange(n()),r(!1),i(""),s(-1)},150)},p=()=>e()&&n()?n():t.value||"",I={position:"relative",width:t.width||"100%",flex:t.width?void 0:"1"},P={...st.input,width:"100%","padding-right":"2rem"},w={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"200px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},x=ne=>({padding:"0.5rem 0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:ne?"var(--strip-color)":"transparent",color:ne?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease","font-size":"0.875rem"}),j={position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)","pointer-events":"none",color:"var(--text-muted)","font-size":"0.75rem"};return(()=>{var ne=fD(),Q=ne.firstChild,K=Q.firstChild,Z=K.nextSibling;return Q.style.setProperty("position","relative"),K.addEventListener("blur",v),K.$$keydown=y,K.$$click=c,K.$$input=u,l(Z,()=>e()?"":""),l(ne,B(Ge,{get when(){return Te(()=>!!e())()&&a().length>0},get children(){var k=jh();return l(k,B(Ht,{get each(){return a()},children:(C,E)=>{const M=C.startsWith(" Agregar");return(()=>{var _=jh();return _.addEventListener("mouseenter",()=>s(E())),_.$$click=()=>f(C),l(_,C),Se(S=>m(_,{...x(E()===o()),...M&&{"font-style":"italic","border-left":"3px solid var(--primary-color)",background:E()===o()?"var(--primary-color)":"#f0f8ff",color:E()===o()?"white":"var(--primary-color)"}},S)),_})()}})),Se(C=>m(k,w,C)),k}}),null),Se(k=>{var C=I,E=P,M=t.placeholder,_=t?.index,S=j;return k.e=m(ne,C,k.e),k.t=m(K,E,k.t),M!==k.a&&Yt(K,"placeholder",k.a=M),_!==k.o&&Yt(K,"tabindex",k.o=_),k.i=m(Z,S,k.i),k},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>K.value=p()),ne})()};ur(["input","click","keydown"]);var bD=ue("<div><div><label>Store Location</label><select><option value=all>All Stores</option></select></div><div><label>From Date</label><input type=date></div><div><label>To Date</label><input type=date></div><div><label>Payment Method</label><select><option value=all>All Methods</option><option value=cash>Cash</option><option value=zelle>Zelle</option><option value=other>Other</option></select></div><div><label>Shipping Type</label><select><option value=all>All Types</option><option value=SEA> Maritimo</option><option value=AEREO> Aereo"),_D=ue("<div><div><strong>Total Invoices:</strong> </div><div><strong>Date Range:</strong> <!> to </div><div><strong>Store:</strong> </div><div><strong>Shipping Type:</strong> "),wD=ue("<div><div><strong>Cash:</strong> </div><div><strong>Zelle:</strong> </div><div><strong>Other:</strong> </div><div><strong>Total:</strong> "),SD=ue("<div><div><strong>Transport:</strong> </div><div><strong>Aranceles:</strong> </div><div><strong>Tax:</strong> "),y1=ue("<div>"),PD=ue("<div><table><thead><tr><th>Product Type</th><th>Quantity</th><th>Total Value</th><th>Avg Price</th></tr></thead><tbody>"),xD=ue("<div><table><thead><tr><th>Reserva Type</th><th>Total Qty (lbs)</th><th>Price Groups (Price  Qty)</th><th>Total</th></tr></thead><tbody>"),AD=ue("<div><table><thead><tr><th>Service Type</th><th>Total</th></tr></thead><tbody><tr><td colspan=4><strong>Total Other Services:</strong></td><td>"),CD=ue("<div><div><div>Products Total</div><div></div></div><div><div>Reservas Total</div><div></div></div><div><div>Transport & Services</div><div></div></div><div><div>GRAND TOTAL</div><div>"),ID=ue("<div><div>Generating report..."),$D=ue("<div><div><div><h3>Invoice References</h3><button></button></div><div><div>Type: <strong></strong></div><div>Price per pound: <strong></strong></div><div>Total invoices: <strong></strong></div></div><div><div>Invoice Numbers:</div><div></div></div><div>"),kD=ue("<div><div class=print-only><h1>Invoice Resume Report</h1><div></div><div>Generated on: </div></div><div class=no-print><h1>Invoice Resume Report</h1><div>"),ED=ue("<option>"),TD=ue("<tr><td></td><td></td><td></td><td>"),ND=ue("<tr><td></td><td></td><td><div></div></td><td>"),LD=ue("<div><span>  <!> lbs</span><button> <!> invoice"),DD=ue("<tr><td><div><span></span></div></td><td>");const RD=t=>{const[e,r]=$e(!1),[n,i]=$e(""),[o,s]=$e(""),[a,c]=$e("all"),[u,f]=$e("all"),[y,v]=$e("all"),[p,I]=$e("all"),[P,w]=$e(null),[x,j]=$e([]),[ne,Q]=$e(!1),[K,Z]=$e(null);Nn(async()=>{await C()});const k=()=>lt.getActiveLocations(),C=async()=>{r(!0);try{let Y=a()!=="all"?a():void 0;const te={store:Y,dateFrom:n()||void 0,dateTo:o()||void 0};Y&&(await ji.fetchInvoices(te),E())}catch(Y){console.error("Error loading report data:",Y)}finally{r(!1)}},E=()=>{let Y=ji.getFilteredInvoices({store:a(),dateFrom:n(),dateTo:o()});p()!=="all"&&(Y=Y.filter(z=>z.shippingType===p()||!z.shippingType&&p()==="SEA")),j(Y);let te=0,O=0,D=0,X=new Map,H=new Map,F=new Map,ie=0,$=0,L=0;Y.forEach(z=>{const oe=d_(z),G=parseFloat(oe.total),ee=Math.random();ee<.6?te+=G:ee<.9?O+=G:D+=G,z.products?.forEach(J=>{const W=J.product.label,q=Math.abs(J.qty),ae=parseFloat(u_(J));if(X.has(W)){const de=X.get(W);X.set(W,{qty:de.qty+q,total:de.total+ae})}else X.set(W,{qty:q,total:ae})}),z.reservas?.forEach(J=>{const W=J.type,q=parseInt(J.qty)||0,ae=parseFloat(J.price)||0,de=parseFloat(J.arancel)||0,le=parseFloat(c_(J));if(["TRANSPORTACION","OTROS SERVICIO","OTROS","SERVICIO DE RAPEADO","CAJAS"].includes(W)||q===0)if(ie+=le,F.has(W)){const ce=F.get(W);F.set(W,{qty:ce.qty+q,price:ce.price,arancel:ce.arancel+de,total:ce.total+le})}else F.set(W,{qty:q,price:ae,arancel:de,total:le});else{const ce=W;if(H.has(ce)){const Pe=H.get(ce);H.set(ce,{qty:Pe.qty+q,price:Pe.price,total:Pe.total+le,priceGroups:Pe.priceGroups});const fe=Pe.priceGroups.get(ae)||{qty:0,invoices:[]};fe.qty+=q,fe.invoices.includes(z.invoice)||fe.invoices.push(z.invoice),Pe.priceGroups.set(ae,fe)}else{const Pe=new Map;Pe.set(ae,{qty:q,invoices:[z.invoice]}),H.set(ce,{qty:q,price:ae,arancel:de,total:le,priceGroups:Pe})}}$+=de})});const U=te+O+D;L=U*.1;const N={dateRange:{from:n(),to:o()},store:a(),shippingType:p(),totalInvoices:Y.length,paymentMethods:{cash:te,zelle:O,other:D,total:te+O+D},productsByType:X,reservasByTypeAndPrice:H,otherServicesByType:F,transportTotal:ie,arancelesTotal:$,taxTotal:L,grandTotal:U+L};w(N)},M=Y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Y),_=()=>{document.body.classList.add("printing"),setTimeout(()=>{window.print(),document.body.classList.remove("printing")},100)},S=async()=>{try{const Y=b();if(Y){Q(!0);const{generateInvoiceResumePDF:te}=await Ui(async()=>{const{generateInvoiceResumePDF:D}=await import("./invoiceResumePdfGenerator-BpnXrGfm.js");return{generateInvoiceResumePDF:D}},[]),O=`invoice-resume-report-${new Date().toISOString().split("T")[0]}.pdf`;await te(Y,O),console.log(`PDF generated successfully: ${O}`)}}catch(Y){console.error("Error generating PDF:",Y),alert("PDF generation failed. Using print instead."),_()}finally{Q(!1)}},b=Nt(()=>P());return(()=>{var Y=kD(),te=Y.firstChild,O=te.firstChild,D=O.nextSibling,X=D.nextSibling;X.firstChild;var H=te.nextSibling,F=H.firstChild,ie=F.nextSibling;return Y.style.setProperty("padding","2rem"),Y.style.setProperty("max-width","1200px"),Y.style.setProperty("margin","0 auto"),te.style.setProperty("text-align","center"),te.style.setProperty("margin-bottom","2rem"),te.style.setProperty("border-bottom","2px solid #333"),te.style.setProperty("padding-bottom","1rem"),D.style.setProperty("font-size","12pt"),D.style.setProperty("margin-top","0.5rem"),D.style.setProperty("color","#666"),l(D,B(Ge,{get when(){return Te(()=>!!b()?.dateRange?.from)()&&b()?.dateRange?.to},get children(){return["Report Period: ",Te(()=>b()?.dateRange?.from)," to ",Te(()=>b()?.dateRange?.to)]}}),null),l(D,B(Ge,{get when(){return!b()?.dateRange?.from||!b()?.dateRange?.to},children:"All Time Report"}),null),X.style.setProperty("font-size","10pt"),X.style.setProperty("margin-top","0.5rem"),l(X,()=>new Date().toLocaleDateString(),null),H.style.setProperty("display","flex"),H.style.setProperty("justify-content","space-between"),H.style.setProperty("align-items","center"),H.style.setProperty("margin-bottom","2rem"),F.style.setProperty("font-size","1.75rem"),F.style.setProperty("font-weight","bold"),ie.style.setProperty("display","flex"),ie.style.setProperty("gap","1rem"),l(ie,B(Pt,{variant:"outline",onClick:_,children:" Print"}),null),l(ie,B(Pt,{variant:"outline",onClick:S,get disabled(){return ne()},get children(){return ne()?" Generating...":" Export PDF"}}),null),l(ie,B(Ge,{get when(){return t.onClose},get children(){return B(Pt,{variant:"secondary",get onClick(){return t.onClose},children:"Close"})}}),null),l(Y,B(Tt,{title:"Filters",style:{"margin-bottom":"2rem"},class:"no-print",get children(){var $=bD(),L=$.firstChild,U=L.firstChild,N=U.nextSibling;N.firstChild;var z=L.nextSibling,oe=z.firstChild,G=oe.nextSibling,ee=z.nextSibling,J=ee.firstChild,W=J.nextSibling,q=ee.nextSibling,ae=q.firstChild,de=ae.nextSibling,le=q.nextSibling,V=le.firstChild,ce=V.nextSibling;return $.style.setProperty("display","grid"),$.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),$.style.setProperty("gap","1rem"),$.style.setProperty("align-items","end"),U.style.setProperty("display","block"),U.style.setProperty("margin-bottom","0.5rem"),U.style.setProperty("font-weight","500"),N.addEventListener("change",Pe=>c(Pe.currentTarget.value)),N.style.setProperty("width","100%"),N.style.setProperty("padding","0.75rem"),N.style.setProperty("border","1px solid var(--border-color)"),N.style.setProperty("border-radius","var(--border-radius-sm)"),l(N,B(Ht,{get each(){return k()},children:Pe=>(()=>{var fe=ED();return l(fe,()=>Pe.name),Se(()=>fe.value=Pe.id),fe})()}),null),oe.style.setProperty("display","block"),oe.style.setProperty("margin-bottom","0.5rem"),oe.style.setProperty("font-weight","500"),G.addEventListener("change",Pe=>i(Pe.currentTarget.value)),G.style.setProperty("width","100%"),G.style.setProperty("padding","0.75rem"),G.style.setProperty("border","1px solid var(--border-color)"),G.style.setProperty("border-radius","var(--border-radius-sm)"),J.style.setProperty("display","block"),J.style.setProperty("margin-bottom","0.5rem"),J.style.setProperty("font-weight","500"),W.addEventListener("change",Pe=>s(Pe.currentTarget.value)),W.style.setProperty("width","100%"),W.style.setProperty("padding","0.75rem"),W.style.setProperty("border","1px solid var(--border-color)"),W.style.setProperty("border-radius","var(--border-radius-sm)"),ae.style.setProperty("display","block"),ae.style.setProperty("margin-bottom","0.5rem"),ae.style.setProperty("font-weight","500"),de.addEventListener("change",Pe=>v(Pe.currentTarget.value)),de.style.setProperty("width","100%"),de.style.setProperty("padding","0.75rem"),de.style.setProperty("border","1px solid var(--border-color)"),de.style.setProperty("border-radius","var(--border-radius-sm)"),V.style.setProperty("display","block"),V.style.setProperty("margin-bottom","0.5rem"),V.style.setProperty("font-weight","500"),ce.addEventListener("change",Pe=>I(Pe.currentTarget.value)),ce.style.setProperty("width","100%"),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("border","1px solid var(--border-color)"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),l($,B(Ge,{get when(){return a()!=="all"},get children(){return B(Pt,{variant:"primary",onClick:C,get disabled(){return Te(()=>a()==="all")()&&e()},get children(){return e()?"Loading...":"Generate Report"}})}}),null),Se(()=>N.value=a()),Se(()=>G.value=n()),Se(()=>W.value=o()),Se(()=>de.value=y()),Se(()=>ce.value=p()),$}}),null),l(Y,B(Ge,{get when(){return Te(()=>!!(a()!=="all"&&b()))()&&!e()},get children(){return[(()=>{var $=y1();return $.style.setProperty("display","grid"),$.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),$.style.setProperty("gap","1.5rem"),$.style.setProperty("margin-bottom","2rem"),l($,B(Tt,{title:"Invoice Summary",get children(){var L=_D(),U=L.firstChild,N=U.firstChild;N.nextSibling;var z=U.nextSibling,oe=z.firstChild,G=oe.nextSibling,ee=G.nextSibling;ee.nextSibling;var J=z.nextSibling,W=J.firstChild;W.nextSibling;var q=J.nextSibling,ae=q.firstChild;return ae.nextSibling,L.style.setProperty("padding","1rem"),U.style.setProperty("margin-bottom","0.5rem"),l(U,()=>b().totalInvoices,null),z.style.setProperty("margin-bottom","0.5rem"),l(z,()=>b().dateRange.from||"All",ee),l(z,()=>b().dateRange.to||"All",null),J.style.setProperty("margin-bottom","0.5rem"),l(J,(()=>{var de=Te(()=>b().store==="all");return()=>de()?"All Stores":b().store})(),null),l(q,(()=>{var de=Te(()=>b().shippingType==="all");return()=>de()?"All Types":Te(()=>b().shippingType==="SEA")()?" Maritimo":b().shippingType==="AEREO"?" Aereo":"Not Set"})(),null),L}}),null),l($,B(Tt,{title:"Payment Methods",get children(){var L=wD(),U=L.firstChild,N=U.firstChild;N.nextSibling;var z=U.nextSibling,oe=z.firstChild;oe.nextSibling;var G=z.nextSibling,ee=G.firstChild;ee.nextSibling;var J=G.nextSibling,W=J.firstChild;return W.nextSibling,L.style.setProperty("padding","1rem"),U.style.setProperty("margin-bottom","0.5rem"),l(U,()=>M(b().paymentMethods.cash),null),z.style.setProperty("margin-bottom","0.5rem"),l(z,()=>M(b().paymentMethods.zelle),null),G.style.setProperty("margin-bottom","0.5rem"),l(G,()=>M(b().paymentMethods.other),null),J.style.setProperty("border-top","1px solid var(--border-color)"),J.style.setProperty("padding-top","0.5rem"),J.style.setProperty("font-weight","bold"),l(J,()=>M(b().paymentMethods.total),null),L}}),null),l($,B(Tt,{title:"Additional Charges",get children(){var L=SD(),U=L.firstChild,N=U.firstChild;N.nextSibling;var z=U.nextSibling,oe=z.firstChild;oe.nextSibling;var G=z.nextSibling,ee=G.firstChild;return ee.nextSibling,L.style.setProperty("padding","1rem"),U.style.setProperty("margin-bottom","0.5rem"),l(U,()=>M(b().transportTotal),null),z.style.setProperty("margin-bottom","0.5rem"),l(z,()=>M(b().arancelesTotal),null),G.style.setProperty("margin-bottom","0.5rem"),l(G,()=>M(b().taxTotal),null),L}}),null),$})(),B(Ge,{get when(){return b().productsByType?.size>0},get children(){return B(Tt,{title:"Products Summary",style:{"margin-bottom":"2rem"},get children(){var $=PD(),L=$.firstChild,U=L.firstChild,N=U.firstChild,z=N.firstChild,oe=z.nextSibling,G=oe.nextSibling,ee=G.nextSibling,J=U.nextSibling;return $.style.setProperty("overflow-x","auto"),L.style.setProperty("width","100%"),L.style.setProperty("border-collapse","collapse"),N.style.setProperty("background","var(--background-color)"),z.style.setProperty("padding","1rem"),z.style.setProperty("text-align","left"),z.style.setProperty("border-bottom","2px solid var(--border-color)"),oe.style.setProperty("padding","1rem"),oe.style.setProperty("text-align","right"),oe.style.setProperty("border-bottom","2px solid var(--border-color)"),G.style.setProperty("padding","1rem"),G.style.setProperty("text-align","right"),G.style.setProperty("border-bottom","2px solid var(--border-color)"),ee.style.setProperty("padding","1rem"),ee.style.setProperty("text-align","right"),ee.style.setProperty("border-bottom","2px solid var(--border-color)"),l(J,B(Ht,{get each(){return Array.from(b().productsByType.entries()).sort((W,q)=>q[1].total-W[1].total)},children:([W,q])=>(()=>{var ae=TD(),de=ae.firstChild,le=de.nextSibling,V=le.nextSibling,ce=V.nextSibling;return de.style.setProperty("padding","0.75rem"),de.style.setProperty("border-bottom","1px solid var(--border-color)"),l(de,W),le.style.setProperty("padding","0.75rem"),le.style.setProperty("text-align","right"),le.style.setProperty("border-bottom","1px solid var(--border-color)"),l(le,()=>q.qty),V.style.setProperty("padding","0.75rem"),V.style.setProperty("text-align","right"),V.style.setProperty("border-bottom","1px solid var(--border-color)"),V.style.setProperty("font-weight","600"),l(V,()=>M(q.total)),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("text-align","right"),ce.style.setProperty("border-bottom","1px solid var(--border-color)"),l(ce,()=>M(q.total/q.qty)),ae})()})),$}})}}),B(Ge,{get when(){return b().reservasByTypeAndPrice?.size>0},get children(){return B(Tt,{title:"Reservas Summary (Grouped by Price)",style:{"margin-bottom":"2rem"},get children(){var $=xD(),L=$.firstChild,U=L.firstChild,N=U.firstChild,z=N.firstChild,oe=z.nextSibling,G=oe.nextSibling,ee=G.nextSibling,J=U.nextSibling;return $.style.setProperty("overflow-x","auto"),L.style.setProperty("width","100%"),L.style.setProperty("border-collapse","collapse"),N.style.setProperty("background","var(--background-color)"),z.style.setProperty("padding","1rem"),z.style.setProperty("text-align","left"),z.style.setProperty("border-bottom","2px solid var(--border-color)"),oe.style.setProperty("padding","1rem"),oe.style.setProperty("text-align","right"),oe.style.setProperty("border-bottom","2px solid var(--border-color)"),G.style.setProperty("padding","1rem"),G.style.setProperty("text-align","left"),G.style.setProperty("border-bottom","2px solid var(--border-color)"),ee.style.setProperty("padding","1rem"),ee.style.setProperty("text-align","right"),ee.style.setProperty("border-bottom","2px solid var(--border-color)"),l(J,B(Ht,{get each(){return Array.from(b().reservasByTypeAndPrice.entries()).sort((W,q)=>q[1].total-W[1].total)},children:([W,q])=>(()=>{var ae=ND(),de=ae.firstChild,le=de.nextSibling,V=le.nextSibling,ce=V.firstChild,Pe=V.nextSibling;return de.style.setProperty("padding","0.75rem"),de.style.setProperty("border-bottom","1px solid var(--border-color)"),l(de,W),le.style.setProperty("padding","0.75rem"),le.style.setProperty("text-align","right"),le.style.setProperty("border-bottom","1px solid var(--border-color)"),le.style.setProperty("font-weight","600"),l(le,()=>q.qty),V.style.setProperty("padding","0.75rem"),V.style.setProperty("border-bottom","1px solid var(--border-color)"),ce.style.setProperty("font-size","0.875rem"),l(ce,B(Ht,{get each(){return Array.from(q.priceGroups.entries()).sort((fe,be)=>fe[0]-be[0])},children:([fe,be])=>(()=>{var xe=LD(),he=xe.firstChild,ve=he.firstChild,De=ve.nextSibling;De.nextSibling;var Ee=he.nextSibling,Ce=Ee.firstChild,Ne=Ce.nextSibling;return Ne.nextSibling,xe.style.setProperty("margin-bottom","0.5rem"),xe.style.setProperty("display","flex"),xe.style.setProperty("align-items","center"),xe.style.setProperty("gap","0.5rem"),l(he,()=>M(fe),ve),l(he,()=>be.qty,De),Ee.addEventListener("mouseleave",Ie=>Ie.currentTarget.style.background="#3498db"),Ee.addEventListener("mouseenter",Ie=>Ie.currentTarget.style.background="#2980b9"),Ee.$$click=()=>Z({price:fe,invoices:be.invoices,type:W}),Ee.style.setProperty("background","#3498db"),Ee.style.setProperty("color","white"),Ee.style.setProperty("border","none"),Ee.style.setProperty("border-radius","4px"),Ee.style.setProperty("padding","0.25rem 0.5rem"),Ee.style.setProperty("font-size","0.75rem"),Ee.style.setProperty("cursor","pointer"),Ee.style.setProperty("transition","background 0.2s"),l(Ee,()=>be.invoices.length,Ne),l(Ee,()=>be.invoices.length>1?"s":"",null),xe})()})),Pe.style.setProperty("padding","0.75rem"),Pe.style.setProperty("text-align","right"),Pe.style.setProperty("border-bottom","1px solid var(--border-color)"),Pe.style.setProperty("font-weight","600"),l(Pe,()=>M(q.total)),ae})()})),$}})}}),B(Ge,{get when(){return b().otherServicesByType?.size>0},get children(){return B(Tt,{title:"Other Services & Charges",style:{"margin-bottom":"2rem"},get children(){var $=AD(),L=$.firstChild,U=L.firstChild,N=U.firstChild,z=N.firstChild,oe=z.nextSibling,G=U.nextSibling,ee=G.firstChild,J=ee.firstChild,W=J.nextSibling;return $.style.setProperty("overflow-x","auto"),L.style.setProperty("width","100%"),L.style.setProperty("border-collapse","collapse"),N.style.setProperty("background","var(--background-color)"),z.style.setProperty("padding","1rem"),z.style.setProperty("text-align","left"),z.style.setProperty("border-bottom","2px solid var(--border-color)"),oe.style.setProperty("padding","1rem"),oe.style.setProperty("text-align","right"),oe.style.setProperty("border-bottom","2px solid var(--border-color)"),l(G,B(Ht,{get each(){return Array.from(b().otherServicesByType.entries()).sort((q,ae)=>ae[1].total-q[1].total)},children:([q,ae])=>(()=>{var de=DD(),le=de.firstChild,V=le.firstChild,ce=V.firstChild,Pe=le.nextSibling;return le.style.setProperty("padding","0.75rem"),le.style.setProperty("border-bottom","1px solid var(--border-color)"),V.style.setProperty("display","flex"),V.style.setProperty("align-items","center"),V.style.setProperty("gap","0.5rem"),(q==="TRANSPORTACION"?"#e3f2fd":q==="CAJAS"?"#f3e5f5":"#fff3e0")!=null?ce.style.setProperty("background",q==="TRANSPORTACION"?"#e3f2fd":q==="CAJAS"?"#f3e5f5":"#fff3e0"):ce.style.removeProperty("background"),(q==="TRANSPORTACION"?"#1976d2":q==="CAJAS"?"#7b1fa2":"#f57c00")!=null?ce.style.setProperty("color",q==="TRANSPORTACION"?"#1976d2":q==="CAJAS"?"#7b1fa2":"#f57c00"):ce.style.removeProperty("color"),ce.style.setProperty("padding","0.25rem 0.5rem"),ce.style.setProperty("border-radius","4px"),ce.style.setProperty("font-size","0.75rem"),ce.style.setProperty("font-weight","600"),l(ce,q==="TRANSPORTACION"?"":q==="CAJAS"?"":q==="SERVICIO DE RAPEADO"?"":""),l(V,q,null),Pe.style.setProperty("padding","0.75rem"),Pe.style.setProperty("text-align","right"),Pe.style.setProperty("border-bottom","1px solid var(--border-color)"),Pe.style.setProperty("font-weight","600"),l(Pe,()=>M(ae.total)),de})()}),ee),ee.style.setProperty("background","var(--strip-color)"),ee.style.setProperty("font-weight","bold"),J.style.setProperty("padding","0.75rem"),J.style.setProperty("text-align","right"),J.style.setProperty("border-top","2px solid var(--border-color)"),W.style.setProperty("padding","0.75rem"),W.style.setProperty("text-align","right"),W.style.setProperty("border-top","2px solid var(--border-color)"),W.style.setProperty("font-weight","700"),l(W,()=>M(b().transportTotal)),$}})}}),B(Tt,{title:"Total Summary",get children(){var $=CD(),L=$.firstChild,U=L.firstChild,N=U.nextSibling,z=L.nextSibling,oe=z.firstChild,G=oe.nextSibling,ee=z.nextSibling,J=ee.firstChild,W=J.nextSibling,q=ee.nextSibling,ae=q.firstChild,de=ae.nextSibling;return $.style.setProperty("display","grid"),$.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),$.style.setProperty("gap","2rem"),$.style.setProperty("padding","2rem"),L.style.setProperty("text-align","center"),U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-secondary)"),U.style.setProperty("margin-bottom","0.5rem"),N.style.setProperty("font-size","1.5rem"),N.style.setProperty("font-weight","bold"),N.style.setProperty("color","var(--primary-color)"),l(N,()=>M(Array.from(b().productsByType.values()).reduce((le,V)=>le+V.total,0))),z.style.setProperty("text-align","center"),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-secondary)"),oe.style.setProperty("margin-bottom","0.5rem"),G.style.setProperty("font-size","1.5rem"),G.style.setProperty("font-weight","bold"),G.style.setProperty("color","var(--primary-color)"),l(G,()=>M(Array.from(b().reservasByTypeAndPrice.values()).reduce((le,V)=>le+V.total,0))),ee.style.setProperty("text-align","center"),J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-secondary)"),J.style.setProperty("margin-bottom","0.5rem"),W.style.setProperty("font-size","1.5rem"),W.style.setProperty("font-weight","bold"),W.style.setProperty("color","var(--primary-color)"),l(W,()=>M(b().transportTotal)),q.style.setProperty("text-align","center"),q.style.setProperty("border-left","2px solid var(--primary-color)"),q.style.setProperty("padding-left","2rem"),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-secondary)"),ae.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-size","2rem"),de.style.setProperty("font-weight","bold"),de.style.setProperty("color","var(--primary-color)"),l(de,()=>M(b().paymentMethods.total)),$}})]}}),null),l(Y,B(Ge,{get when(){return e()},get children(){var $=ID(),L=$.firstChild;return $.style.setProperty("text-align","center"),$.style.setProperty("padding","3rem"),L.style.setProperty("font-size","1.25rem"),L.style.setProperty("margin-bottom","1rem"),$}}),null),l(Y,B(Ge,{get when(){return K()},get children(){var $=$D(),L=$.firstChild,U=L.firstChild,N=U.firstChild,z=N.nextSibling,oe=U.nextSibling,G=oe.firstChild,ee=G.firstChild,J=ee.nextSibling,W=G.nextSibling,q=W.firstChild,ae=q.nextSibling,de=W.nextSibling,le=de.firstChild,V=le.nextSibling,ce=oe.nextSibling,Pe=ce.firstChild,fe=Pe.nextSibling,be=ce.nextSibling;return $.$$click=()=>Z(null),$.style.setProperty("position","fixed"),$.style.setProperty("top","0"),$.style.setProperty("left","0"),$.style.setProperty("right","0"),$.style.setProperty("bottom","0"),$.style.setProperty("background","rgba(0, 0, 0, 0.5)"),$.style.setProperty("display","flex"),$.style.setProperty("align-items","center"),$.style.setProperty("justify-content","center"),$.style.setProperty("z-index","1000"),L.$$click=xe=>xe.stopPropagation(),L.style.setProperty("background","white"),L.style.setProperty("padding","2rem"),L.style.setProperty("border-radius","var(--border-radius)"),L.style.setProperty("max-width","600px"),L.style.setProperty("max-height","80vh"),L.style.setProperty("overflow-y","auto"),L.style.setProperty("box-shadow","var(--shadow-lg)"),U.style.setProperty("display","flex"),U.style.setProperty("justify-content","space-between"),U.style.setProperty("align-items","center"),U.style.setProperty("margin-bottom","1.5rem"),N.style.setProperty("font-size","1.25rem"),N.style.setProperty("font-weight","bold"),z.$$click=()=>Z(null),z.style.setProperty("background","none"),z.style.setProperty("border","none"),z.style.setProperty("font-size","1.5rem"),z.style.setProperty("cursor","pointer"),z.style.setProperty("color","#666"),oe.style.setProperty("margin-bottom","1rem"),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-secondary)"),l(J,()=>K().type),W.style.setProperty("font-size","0.875rem"),W.style.setProperty("color","var(--text-secondary)"),l(ae,()=>M(K().price)),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("color","var(--text-secondary)"),l(V,()=>K().invoices.length),ce.style.setProperty("border","1px solid var(--border-color)"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),ce.style.setProperty("padding","1rem"),ce.style.setProperty("background","var(--background-color)"),Pe.style.setProperty("font-weight","600"),Pe.style.setProperty("margin-bottom","0.75rem"),fe.style.setProperty("display","grid"),fe.style.setProperty("grid-template-columns","repeat(auto-fill, minmax(120px, 1fr))"),fe.style.setProperty("gap","0.5rem"),l(fe,B(Ht,{get each(){return K().invoices},children:xe=>(()=>{var he=y1();return he.$$click=()=>{const ve=x().find(De=>De.invoice===xe);ve&&console.log("Invoice details:",ve)},he.addEventListener("mouseleave",ve=>{ve.currentTarget.style.background="white",ve.currentTarget.style.borderColor="var(--border-color)"}),he.addEventListener("mouseenter",ve=>{ve.currentTarget.style.background="#e3f2fd",ve.currentTarget.style.borderColor="#2196f3"}),he.style.setProperty("padding","0.5rem"),he.style.setProperty("background","white"),he.style.setProperty("border","1px solid var(--border-color)"),he.style.setProperty("border-radius","var(--border-radius-sm)"),he.style.setProperty("font-family","monospace"),he.style.setProperty("font-size","0.875rem"),he.style.setProperty("text-align","center"),he.style.setProperty("transition","all 0.2s"),he.style.setProperty("cursor","pointer"),l(he,xe),he})()})),be.style.setProperty("margin-top","1.5rem"),be.style.setProperty("display","flex"),be.style.setProperty("justify-content","flex-end"),be.style.setProperty("gap","1rem"),l(be,B(Pt,{variant:"outline",onClick:()=>{const xe=K().invoices.join(", ");navigator.clipboard.writeText(xe).then(()=>{alert("Invoice numbers copied to clipboard!")})},children:" Copy Invoice Numbers"}),null),l(be,B(Pt,{variant:"primary",onClick:()=>Z(null),children:"Close"}),null),$}}),null),Y})()};ur(["click"]);var MD=ue("<div><div>"),FD=ue("<div> "),OD=ue("<div><div><label></label><select><option value=all></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label><input type=text>"),BD=ue("<div><button></button><button></button><button> Crear Nueva Factura</button><button> Resume Report"),ol=ue("<div>"),jD=ue("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),VD=ue("<button> "),zD=ue("<option>"),qD=ue("<div><div></div><div></div><div></div><div>"),g1=ue("<div><span></span><span> "),UD=ue("<div><span></span><span> $"),HD=ue("<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td><span></span></td><td><button>");const ah=t=>parseFloat(t?.toString())||0,c_=t=>{let e=ah(t.qty),r=ah(t.price),n=ah(t.arancel);return`${(e*r+n)?.toFixed(2)}`},u_=t=>{let e=Math.abs(t.qty),r=ah(t.salePrice);return`${(e*r)?.toFixed(2)}`},d_=t=>{let e=0;t?.reservas?.forEach(i=>{e+=parseFloat(c_(i))});let r=0;t?.products?.forEach(i=>{r+=parseFloat(u_(i))});let n={};return n.reservaSubtotal=e.toFixed(2),n.productSubtotal=r.toFixed(2),n.subtotalBeforeTax=(r+e).toFixed(2),n.total=n.subtotalBeforeTax,n},WD=t=>{const{t:e}=tr(),[r,n]=$e(!1),[i,o]=$e("all"),[s,a]=$e(""),[c,u]=$e(""),[f,y]=$e(null),[v,p]=$e("dashboard"),[I,P]=$e([]),[w,x]=$e(""),[j,ne]=$e("overview");Nn(async()=>{try{t.invoices;try{const J=await ji.fetchStores();let W=Array.isArray(J)?J:Object.keys(J)||[]}catch{const W=ji.state.invoices||t.invoices,q=[...new Set(W.map(ae=>ae.store))];P(q.sort())}}catch(J){console.error("Error loading dashboard data:",J)}}),Nt(()=>ji.state.invoices||t.invoices);const Q=Nt(()=>{let J;return t.invoices?J=ji.getFilteredInvoices({store:i(),dateFrom:s(),dateTo:c()}):J=ji.getFilteredInvoices({store:i(),dateFrom:s(),dateTo:c()}),J}),K=async()=>{try{t.invoices,n(!0),await ji.refreshData({store:i()!=="all"?i():void 0,dateFrom:s()||void 0,dateTo:c()||void 0,search:w()}),n(!1)}catch(J){console.error("Error refreshing data:",J)}},Z=Nt(()=>{r();const J=Q(),W=ji.calculateSummary(J);let q=new Map,ae=new Map,de=new Map;return J.forEach(le=>{le?.products?.length>0&&le?.products?.forEach(V=>{const ce=Math.abs(V.qty),Pe=V.product.label;q.set(Pe,(q.get(Pe)||0)+ce)}),le?.reservas?.length>0&&le?.reservas?.forEach(V=>{let ce=parseInt(V.qty);isNaN(ce)&&(ce=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[V.type]||V?.onlyTariff?(ce=parseFloat(V.arancel)||parseFloat(V.qty)*parseFloat(V.price),de.set(V.type,(ae.get(V.type)||0)+ce)):ae.set(V.type,(ae.get(V.type)||0)+ce)})}),{...W,productsByCategory:q,reservasByType:ae,othersByType:de}}),k=J=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(J),C=J=>new Date(J).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),E={padding:"2rem"},M={display:"flex",gap:"1rem","align-items":"flex-end","margin-bottom":"2rem","flex-wrap":"wrap",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)"},_={display:"flex","flex-direction":"column",gap:"0.5rem",flex:"1","min-width":"200px"},S={"font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)"},b={padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--background-color)"},Y={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(280px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},te={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)"},O={width:"48px",height:"48px","border-radius":"12px",display:"flex","align-items":"center","justify-content":"center","font-size":"1.5rem","margin-bottom":"1rem"},D={"font-size":"0.875rem",color:"var(--text-secondary)","margin-bottom":"0.5rem"},X={"font-size":"1.75rem","font-weight":"700",color:"var(--text-primary)","margin-bottom":"0.25rem"},H={"font-size":"0.75rem",color:"var(--text-muted)"},F={width:"100%",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",overflow:"hidden"},ie={padding:"1rem","text-align":"left",background:"var(--background-color)","font-weight":"600",color:"var(--text-secondary)","font-size":"0.875rem","border-bottom":"2px solid var(--border-color)"},$={padding:"1rem","border-bottom":"1px solid var(--border-color)"},L={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},U=J=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:J?"var(--primary-color)":"var(--text-muted)","border-bottom":J?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),N={padding:"0.5rem 1rem",background:"var(--primary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","font-size":"0.875rem",transition:"opacity 0.2s"},z={padding:"0.75rem 1.5rem",background:"var(--secondary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","margin-bottom":"1rem",display:"flex","align-items":"center",gap:"0.5rem"},oe=()=>[{title:e("invoices.totalRevenue"),value:Z().grandTotal,icon:"",color:"#4CAF50",subtext:`${e("common.of")} ${Z().totalInvoices} ${e("common.invoice")} `},{title:e("invoices.totalProducts"),value:Z().totalProducts,icon:"",color:"#2196F3",subtext:`${k(Z().totalProductAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.totalReservations"),value:Z().totalReservas,icon:"",color:"#FF9800",subtext:`${k(Z().totalReservaAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.aranceles"),value:Z().totalAranceles,icon:"",color:"#9C27B0",subtext:e("invoices.customsFees")},{title:e("invoices.uniqueCustomers"),value:Z().uniqueCustomers,icon:"",color:"#00BCD4",subtext:e("invoices.activeCustomers"),isNumber:!0},{title:e("invoices.averageInvoice"),value:Z().avgInvoiceValue,icon:"",color:"#FF5722",subtext:e("invoices.perInvoiceValue")},{title:e("invoices.completed"),value:Z().completedInvoices,icon:"",color:"#4CAF50",subtext:`${Z().pendingInvoices} ${e("invoices.pending")}`,isNumber:!0},{title:e("invoices.storesActive"),value:I().length,icon:"",color:"#795548",subtext:e("invoices.locations"),isNumber:!0}],G=()=>lt.getActiveLocations();vo(()=>{});const ee=async()=>{let J="YB1";Rm.calcStockLevels(),await lt.fecthProduct(J),await lt.fecthInventory(J)};return Nn(()=>{ee()}),B(ro,{get title(){return e("invoices.title")},get children(){var J=ol();return m(J,E),l(J,B(Ge,{get when(){return v()==="dashboard"},get children(){return[B(Ge,{get when(){return!t.invoices&&ji.state.loading},get children(){var W=MD(),q=W.firstChild;return W.style.setProperty("text-align","center"),W.style.setProperty("padding","2rem"),q.style.setProperty("font-size","1.25rem"),q.style.setProperty("margin-bottom","1rem"),l(q,()=>e("invoices.loadingInvoices")),W}}),B(Ge,{get when(){return ji.state.error},get children(){var W=FD();return W.firstChild,W.style.setProperty("padding","1rem"),W.style.setProperty("margin-bottom","1rem"),W.style.setProperty("background","#ffebee"),W.style.setProperty("border","1px solid #ffcdd2"),W.style.setProperty("border-radius","var(--border-radius)"),W.style.setProperty("color","#d32f2f"),l(W,()=>ji.state.error,null),l(W,B(Pt,{variant:"outline",size:"sm",onClick:K,style:{"margin-left":"1rem"},get children(){return e("invoices.refreshData")}}),null),W}}),(()=>{var W=OD(),q=W.firstChild,ae=q.firstChild,de=ae.nextSibling,le=de.firstChild,V=q.nextSibling,ce=V.firstChild,Pe=ce.nextSibling,fe=V.nextSibling,be=fe.firstChild,xe=be.nextSibling,he=fe.nextSibling,ve=he.firstChild,De=ve.nextSibling;return m(W,M),l(ae,()=>e("invoices.storeLocation")),de.addEventListener("change",Ee=>o(Ee.currentTarget.value)),l(le,()=>e("invoices.allStores")),l(de,B(Ht,{get each(){return G()},children:Ee=>(()=>{var Ce=zD();return l(Ce,()=>Ee.name),Se(()=>Ce.value=Ee.id),Ce})()}),null),l(ce,()=>e("invoices.fromDate")),Pe.addEventListener("change",Ee=>a(Ee.currentTarget.value)),l(be,()=>e("invoices.toDate")),xe.addEventListener("change",Ee=>u(Ee.currentTarget.value)),l(ve,()=>e("invoices.search")),De.addEventListener("change",Ee=>x(Ee.currentTarget.value)),l(W,B(Pt,{variant:"secondary",onClick:()=>{o("all"),a(""),u(""),x("")},get children(){return e("invoices.clearFilters")}}),null),l(W,B(Pt,{variant:"primary",onClick:K,get disabled(){return!t.invoices&&ji.state.loading},get children(){return[" ",Te(()=>e("invoices.refreshData"))]}}),null),Se(Ee=>{var Ce=_,Ne=S,Ie=b,Re=_,We=S,Fe=b,Xe=_,tt=S,At=b,rt=_,He=S,xt=b,_t=e("invoices.searchPlaceholder");return Ee.e=m(q,Ce,Ee.e),Ee.t=m(ae,Ne,Ee.t),Ee.a=m(de,Ie,Ee.a),Ee.o=m(V,Re,Ee.o),Ee.i=m(ce,We,Ee.i),Ee.n=m(Pe,Fe,Ee.n),Ee.s=m(fe,Xe,Ee.s),Ee.h=m(be,tt,Ee.h),Ee.r=m(xe,At,Ee.r),Ee.d=m(he,rt,Ee.d),Ee.l=m(ve,He,Ee.l),Ee.u=m(De,xt,Ee.u),_t!==Ee.c&&Yt(De,"placeholder",Ee.c=_t),Ee},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0}),Se(()=>de.value=i()),Se(()=>Pe.value=s()),Se(()=>xe.value=c()),Se(()=>De.value=w()),W})(),(()=>{var W=BD(),q=W.firstChild,ae=q.nextSibling,de=ae.nextSibling,le=de.nextSibling;return m(W,L),q.$$click=()=>ne("overview"),l(q,()=>e("inventory.overview")),ae.$$click=()=>ne("invoices"),l(ae,()=>e("invoices.invoices")),de.$$click=()=>ne("add"),le.$$click=()=>ne("report"),Se(V=>{var ce=U(j()==="overview"),Pe=U(j()==="invoices"),fe=U(j()==="add"),be=U(j()==="report");return V.e=m(q,ce,V.e),V.t=m(ae,Pe,V.t),V.a=m(de,fe,V.a),V.o=m(le,be,V.o),V},{e:void 0,t:void 0,a:void 0,o:void 0}),W})(),B(Ge,{get when(){return j()==="overview"},get children(){return[(()=>{var W=ol();return m(W,Y),l(W,B(Ht,{get each(){return oe()},children:q=>(()=>{var ae=qD(),de=ae.firstChild,le=de.nextSibling,V=le.nextSibling,ce=V.nextSibling;return m(ae,te),l(de,()=>q?.icon),m(le,D),l(le,()=>q?.title),m(V,X),l(V,(()=>{var Pe=Te(()=>!!q.isNumber);return()=>Pe()?q.value:k(q.value)})()),m(ce,H),l(ce,()=>q.subtext),Se(Pe=>m(de,{...O,background:`${q?.color}20`,color:q?.color},Pe)),ae})()})),W})(),B(Ge,{get when(){return Z()?.productsByCategory?.size>0},get children(){return B(Tt,{get title(){return e("invoices.topProducts")},get subtitle(){return e("invoices.mostSoldProducts")},get children(){var W=ol();return W.style.setProperty("max-height","300px"),W.style.setProperty("overflow-y","auto"),l(W,()=>Array.from(Z().productsByCategory.entries()).sort((q,ae)=>ae[1]-q[1]).slice(0,10).map(([q,ae])=>(()=>{var de=g1(),le=de.firstChild,V=le.nextSibling,ce=V.firstChild;return de.style.setProperty("display","flex"),de.style.setProperty("justify-content","space-between"),de.style.setProperty("padding","0.75rem"),de.style.setProperty("border-bottom","1px solid var(--border-color)"),l(le,q),V.style.setProperty("font-weight","600"),l(V,ae,ce),l(V,()=>e("common.units"),null),de})())),W}})}}),(()=>{var W=ol();return W.style.setProperty("margin","19px"),W})(),B(Ge,{get when(){return Z()?.reservasByType?.size>0},get children(){return B(Tt,{get title(){return e("invoices.reservationsByType")},get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var W=ol();return W.style.setProperty("max-height","300px"),W.style.setProperty("overflow-y","auto"),l(W,()=>Array.from(Z().reservasByType.entries()).sort((q,ae)=>ae[1]-q[1]).map(([q,ae])=>(()=>{var de=g1(),le=de.firstChild,V=le.nextSibling,ce=V.firstChild;return de.style.setProperty("display","flex"),de.style.setProperty("justify-content","space-between"),de.style.setProperty("padding","0.75rem"),de.style.setProperty("border-bottom","1px solid var(--border-color)"),l(le,q),V.style.setProperty("font-weight","600"),l(V,ae,ce),l(V,()=>e("common.lbs"),null),de})())),W}})}}),(()=>{var W=ol();return W.style.setProperty("margin","19px"),W})(),B(Ge,{get when(){return Z()?.othersByType?.size>0},get children(){return B(Tt,{title:"Aranceles y otros servicios",get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var W=ol();return W.style.setProperty("max-height","300px"),W.style.setProperty("overflow-y","auto"),l(W,()=>Array.from(Z().othersByType.entries()).sort((q,ae)=>ae[1]-q[1]).map(([q,ae])=>(()=>{var de=UD(),le=de.firstChild,V=le.nextSibling,ce=V.firstChild;return de.style.setProperty("display","flex"),de.style.setProperty("justify-content","space-between"),de.style.setProperty("padding","0.75rem"),de.style.setProperty("border-bottom","1px solid var(--border-color)"),l(le,q),V.style.setProperty("font-weight","600"),l(V,ae,ce),de})())),W}})}})]}})]}}),null),l(J,B(Ge,{get when(){return j()==="invoices"},get children(){return[B(Ge,{get when(){return v()!=="detail"},get children(){return B(Tt,{get title(){return e("invoices.recentInvoices")},get subtitle(){return`Mostrando ${Q().length} facturas`},style:{"margin-top":"1.5rem"},get children(){var W=jD(),q=W.firstChild,ae=q.firstChild,de=ae.firstChild,le=de.firstChild,V=le.nextSibling,ce=V.nextSibling,Pe=ce.nextSibling,fe=Pe.nextSibling,be=fe.nextSibling,xe=be.nextSibling,he=xe.nextSibling,ve=he.nextSibling,De=ae.nextSibling;return W.style.setProperty("overflow-x","auto"),m(q,F),l(le,()=>e("invoices.invoiceNumber")),l(V,()=>e("invoices.date")),l(ce,()=>e("invoices.customer")),l(Pe,()=>e("invoices.store")),l(fe,()=>e("invoices.products")),l(be,()=>e("invoices.reservations")),l(xe,()=>e("invoices.total")),l(he,()=>e("invoices.status")),l(ve,()=>e("invoices.actions")),l(De,B(Ht,{get each(){return Q().slice(0,50)},children:Ee=>{const Ce=()=>{let Ne=d_(z1(Ee)),Ie=Ne.productSubtotal,Re=Ne.reservaSubtotal;return{total:Ne.total,totalProductAmount:Ie,totalReservaAmount:Re,totalOther:0}};return(()=>{var Ne=HD(),Ie=Ne.firstChild,Re=Ie.nextSibling,We=Re.nextSibling,Fe=We.nextSibling,Xe=Fe.nextSibling,tt=Xe.nextSibling,At=tt.nextSibling,rt=At.nextSibling,He=rt.firstChild,xt=rt.nextSibling,_t=xt.firstChild;return l(Ie,()=>Ee?.invoice),l(Re,()=>C(Ee?.createDate)),l(We,()=>Ee?.shipper_consignee?.name),l(Fe,()=>Ee?.store),l(Xe,()=>Ce()?.totalProductAmount),l(tt,()=>Ce()?.totalReservaAmount),l(At,()=>k(Ce()?.total)),He.style.setProperty("padding","0.25rem 0.75rem"),He.style.setProperty("border-radius","9999px"),He.style.setProperty("font-size","0.75rem"),He.style.setProperty("font-weight","600"),l(He,(()=>{var mt=Te(()=>!!Ee.isCompleted);return()=>mt()?e("invoices.completed"):e("invoices.pending")})()),_t.addEventListener("mouseleave",mt=>mt.currentTarget.style.opacity="1"),_t.addEventListener("mouseenter",mt=>mt.currentTarget.style.opacity="0.8"),_t.$$click=()=>{y(Ee),p("detail")},m(_t,N),l(_t,()=>e("invoices.view")),Se(mt=>{var Et=$,et=$,qe=$,ot=$,Je=$,at=$,dt={...$,"text-align":"right","font-weight":"600"},It=$,jt=Ee.isCompleted?"#d4edda":"#fff3cd",Gt=Ee.isCompleted?"#155724":"#856404",yt=$;return mt.e=m(Ie,Et,mt.e),mt.t=m(Re,et,mt.t),mt.a=m(We,qe,mt.a),mt.o=m(Fe,ot,mt.o),mt.i=m(Xe,Je,mt.i),mt.n=m(tt,at,mt.n),mt.s=m(At,dt,mt.s),mt.h=m(rt,It,mt.h),jt!==mt.r&&((mt.r=jt)!=null?He.style.setProperty("background",jt):He.style.removeProperty("background")),Gt!==mt.d&&((mt.d=Gt)!=null?He.style.setProperty("color",Gt):He.style.removeProperty("color")),mt.l=m(xt,yt,mt.l),mt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),Ne})()}})),Se(Ee=>{var Ce=ie,Ne=ie,Ie=ie,Re=ie,We=ie,Fe=ie,Xe={...ie,"text-align":"right"},tt=ie,At=ie;return Ee.e=m(le,Ce,Ee.e),Ee.t=m(V,Ne,Ee.t),Ee.a=m(ce,Ie,Ee.a),Ee.o=m(Pe,Re,Ee.o),Ee.i=m(fe,We,Ee.i),Ee.n=m(be,Fe,Ee.n),Ee.s=m(xe,Xe,Ee.s),Ee.h=m(he,tt,Ee.h),Ee.r=m(ve,At,Ee.r),Ee},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),W}})}}),B(Ge,{get when(){return Te(()=>v()==="detail")()&&f()},get children(){return[(()=>{var W=VD();return W.firstChild,W.$$click=()=>{p("dashboard"),y(null)},m(W,z),l(W,()=>e("invoices.backToDashboard"),null),W})(),B(m8,{get invoice(){return f()},onPrint:()=>window.print(),goBack:()=>{p("dashboard"),y(null)}})]}})]}}),null),l(J,B(Ge,{get when(){return j()==="add"},get children(){return B(mD,{})}}),null),l(J,B(Ge,{get when(){return j()==="report"},get children(){return B(RD,{})}}),null),J}})};ur(["click"]);const GD=()=>B(WD,{invoices:[{type:"SALES",invoice:"20255FK6S4B43SSS",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCim",ssg_sorder_key:"JqdrRwGBpdBfRCim",createDate:1736132690425,shipper_consignee:{name:"Yudith Perez Medero",phoneNumberS:"5022408378",dob:"1982-07-23",firstName:"RAUL",lastName:"BATISTA",lastName2:"ESPOSITO",middleName:"",email:"",phoneNumber:"52393232",altPhoneNumber:"",cid:"48121007305",ybstreetNo:"9",ybstreet:"10",ybbetwen1:"CARRALERO",ybbetwen2:"3RA",ybapt:"",ybreparto:"PUEBLO NUEVO",consigneeId:"26144",ssg_consignee_key:"26144",passport:"NA",nacionality:"CUB",ybcity:"HOLGUIN",ybestate:"HOLGUIN",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534800",reservas:[{type:"UTILES DEL HOGAR",qty:"15",arancel:"10",price:"5",key:"1GB16SD80"},{type:"MISCELANEAS",qty:"19",arancel:"",price:"4",key:"0DS6K14Y2"}],products:[{product:{id:"CmrhMfVjLR9HxT6P",label:"FOGONES ELECTRICO DOBLE RESISTENCIA DE ALAMBRE",code:"978Y82K94"},qty:-1,price:23.696296296296296,salePrice:"34"},{product:{id:"ov56aPYGbXIq4XGy",label:"Caramelos",code:"C852CSKB5"},qty:-2,price:5.990000000000001,salePrice:"10"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43TTT",description:"",store:"YY_8803",ssg_inventory_key:"JqdrRwGBpdBfRCin",ssg_sorder_key:"JqdrRwGBpdBfRCin",createDate:1736032690425,shipper_consignee:{name:"Maria Rodriguez Santos",phoneNumberS:"5024567890",dob:"1990-03-15",firstName:"MARIA",lastName:"RODRIGUEZ",lastName2:"SANTOS",middleName:"ELENA",email:"maria@email.com",phoneNumber:"52987654",altPhoneNumber:"",cid:"90031507890",ybstreetNo:"15",ybstreet:"23",ybbetwen1:"MARTI",ybbetwen2:"CESPEDES",ybapt:"2A",ybreparto:"CENTRO",consigneeId:"26145",ssg_consignee_key:"26145",passport:"A1234567",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534801",reservas:[{type:"ELECTRONICOS",qty:"5",arancel:"15",price:"12",key:"2GB16SD81"},{type:"ROPA Y CALZADO",qty:"8",arancel:"8",price:"7",key:"0DS6K14Y3"}],products:[{product:{id:"XmrhMfVjLR9HxT6Q",label:"TELEVISOR LED 32 PULGADAS",code:"TV32LED01"},qty:-1,price:150.5,salePrice:"220"},{product:{id:"Yv56aPYGbXIq4XGz",label:"Zapatos Deportivos Nike",code:"ZAP001"},qty:-1,price:45.99,salePrice:"75"}],isCompleted:!1},{type:"SALES",invoice:"20255FK6S4B43UUU",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCio",ssg_sorder_key:"JqdrRwGBpdBfRCio",createDate:1735932690425,shipper_consignee:{name:"Carlos Mendez Perez",phoneNumberS:"5025678901",dob:"1975-12-08",firstName:"CARLOS",lastName:"MENDEZ",lastName2:"PEREZ",middleName:"ANTONIO",email:"",phoneNumber:"52876543",altPhoneNumber:"",cid:"75120878901",ybstreetNo:"7",ybstreet:"45",ybbetwen1:"LINEA",ybbetwen2:"PASEO",ybapt:"",ybreparto:"VEDADO",consigneeId:"26146",ssg_consignee_key:"26146",passport:"NA",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534802",reservas:[{type:"ALIMENTOS",qty:"25",arancel:"5",price:"3",key:"3GB16SD82"}],products:[{product:{id:"ZmrhMfVjLR9HxT6R",label:"ARROZ ESPECIAL 5LB",code:"ARZ005"},qty:-5,price:2.5,salePrice:"4"},{product:{id:"Av56aPYGbXIq4XG1",label:"ACEITE DE COCINA 1L",code:"ACE001"},qty:-3,price:3.75,salePrice:"6"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43VVV",description:"",store:"YY_8802",ssg_inventory_key:"JqdrRwGBpdBfRCip",ssg_sorder_key:"JqdrRwGBpdBfRCip",createDate:1735832690425,shipper_consignee:{name:"Ana Lucia Fernandez",phoneNumberS:"5026789012",dob:"1988-06-20",firstName:"ANA",lastName:"FERNANDEZ",lastName2:"LOPEZ",middleName:"LUCIA",email:"ana.lucia@email.com",phoneNumber:"52765432",altPhoneNumber:"52111222",cid:"88062076789",ybstreetNo:"12",ybstreet:"18",ybbetwen1:"CALZADA",ybbetwen2:"SAN LAZARO",ybapt:"3B",ybreparto:"CENTRO HABANA",consigneeId:"26147",ssg_consignee_key:"26147",passport:"B9876543",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:"Entrega en horario de oficina"},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534803",reservas:[{type:"MEDICINA Y SALUD",qty:"10",arancel:"12",price:"8",key:"4GB16SD83"},{type:"UTILES DEL HOGAR",qty:"6",arancel:"6",price:"4",key:"5GB16SD84"}],products:[{product:{id:"BmrhMfVjLR9HxT6S",label:"VITAMINAS MULTIPLES 60 CAP",code:"VIT001"},qty:-2,price:12.5,salePrice:"18"}],isCompleted:!0}]}),lh={invoice:"",description:"",store:"",shipper_consignee:{name:"",firstName:"",middleName:"",lastName:"",lastName2:"",phoneNumber:"",cid:"",passport:"",address:""},products:[],reservas:[],packagesOrder:!1,shippingType:"SEA"},By="invoice_form_draft",YD=()=>{try{const t=localStorage.getItem(By);if(t){const e=JSON.parse(t),r={...lh,...e,shipper_consignee:{...lh.shipper_consignee,...e.shipper_consignee||{}},products:e.products||[],reservas:e.reservas||[]};return console.log("Loaded form data from storage:",r),r}}catch(t){console.warn("Failed to load invoice form from storage:",t)}return console.log("No saved data found, using default form data"),{...lh}},jy=t=>{try{localStorage.setItem(By,JSON.stringify(t))}catch(e){console.warn("Failed to save invoice form to storage:",e)}},v1=()=>{try{localStorage.removeItem(By)}catch(t){console.warn("Failed to clear invoice form from storage:",t)}},[hl,As]=$e(YD()),[h_,Eo]=$e(!1),[KD,ch]=$e(null);let Ip=null;const ma=()=>{Ip&&clearTimeout(Ip),Ip=setTimeout(()=>{const t=hl();jy(t),ch(new Date),console.log("Invoice form auto-saved at",new Date().toLocaleTimeString())},1e3)},JD={formData:hl,get isDirty(){return h_()},get lastSaved(){return KD()},updateForm:t=>{As(e=>{const r={...e,...t};return Eo(!0),ma(),r})},updateShipperConsignee:t=>{As(e=>{const r={...e,shipper_consignee:{...e.shipper_consignee,...t}};return Eo(!0),ma(),r})},addProduct:t=>{As(e=>{const r={...e,products:[...e.products,t]};return Eo(!0),ma(),r})},updateProduct:(t,e)=>{As(r=>{const n=[...r.products];n[t]={...n[t],...e};const i={...r,products:n};return Eo(!0),ma(),i})},removeProduct:t=>{As(e=>{const r=e.products.filter((i,o)=>o!==t),n={...e,products:r};return Eo(!0),ma(),n})},addReserva:t=>{As(e=>{const r={...e,reservas:[...e.reservas,t]};return Eo(!0),ma(),r})},updateReserva:(t,e)=>{As(r=>{const n=[...r.reservas];n[t]={...n[t],...e};const i={...r,reservas:n};return Eo(!0),ma(),i})},removeReserva:t=>{As(e=>{const r=e.reservas.filter((i,o)=>o!==t),n={...e,reservas:r};return Eo(!0),ma(),n})},clearForm:()=>{As({...lh}),Eo(!1),v1(),ch(null)},markCompleted:()=>{v1(),Eo(!1),ch(null)},forceSave:()=>{jy(hl()),ch(new Date),Eo(!1)},hasData:()=>{const t=hl();return t.invoice!==""||t.description!==""||t.store!==""||t.shipper_consignee.name!==""||t.shipper_consignee.firstName!==""||t.shipper_consignee.cid!==""||t.products.length>0||t.reservas.length>0},isValid:()=>{const t=hl();return t.invoice.trim()!==""&&t.shipper_consignee.firstName.trim()!==""&&t.shipper_consignee.lastName.trim()!==""&&t.shipper_consignee.cid.trim()!==""&&(t.products.length>0||t.reservas.length>0)},getFormData:()=>hl()};typeof window<"u"&&window.addEventListener("beforeunload",t=>{if(h_()&&(jy(hl()),JD.hasData()))return t.preventDefault(),t.returnValue="You have unsaved changes in your invoice. Are you sure you want to leave?",t.returnValue});var QD=ue("<div><main>");const XD=t=>[B(o$,{}),Te(()=>t.children)],ZD=()=>B(RI,{get children(){var t=QD(),e=t.firstChild;return l(e,B(nS,{root:XD,get children(){return[B(fo,{path:"/",component:Y7}),B(fo,{path:"/accounts",component:()=>B(Io,{permission:"AccountAccess",featureName:"Accounts",get children(){return B(ik,{})}})}),B(fo,{path:"/accounts/:id",component:()=>B(Io,{permission:"AccountAccess",featureName:"Account Details",get children(){return B(dk,{})}})}),B(fo,{path:"/entry-books",component:()=>B(Io,{permission:"JournalAccess",featureName:"Entry Books",get children(){return B(KN,{})}})}),B(fo,{path:"/employees",component:()=>B(Io,{permission:"EmployeeAccess",featureName:"Employee Management",get children(){return B(d6,{})}})}),B(fo,{path:"/bank-consolidations",component:()=>B(Io,{permission:"BankingAccess",featureName:"Bank Consolidations",get children(){return B(B6,{})}})}),B(fo,{path:"/balance-sheet",component:()=>B(Io,{permission:"AccountAccess",featureName:"Balance Sheet",get children(){return B(gk,{})}})}),B(fo,{path:"/invoices",component:()=>B(Io,{permission:"invoiceAccess",featureName:"Invoices",get children(){return B(GD,{})}})}),B(fo,{path:"/inventory",component:()=>B(Io,{permission:"InventoryAccess",featureName:"Inventory Management",get children(){return B(r6,{})}})}),B(fo,{path:"/products",component:()=>B(Io,{permission:"InventoryAccess",featureName:"Product Management",get children(){return B(S5,{})}})}),B(fo,{path:"/hbl",component:()=>B(Io,{permission:"HBLAccess",featureName:"HBL Management",get children(){return B(V7,{})}})}),B(fo,{path:"/admin/users",component:()=>B(Io,{permission:"isAdmin",featureName:"User Administration",get children(){return B(o8,{})}})})]}})),l(t,(()=>{var r=Te(()=>!1);return()=>r()&&B(g$,{})})(),null),t}}),eR=document.getElementById("root");vw(()=>B(ZD,{}),eR);export{sr as E,Ui as _,rn as a,iR as b,W5 as j};
