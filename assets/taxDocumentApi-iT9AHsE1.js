import{O as c,g as d}from"./index-CPuBG4SZ.js";async function p(a,i,n,t){try{const r=await a.arrayBuffer(),s=Array.from(new Uint8Array(r)),o=await c({query:"uploadTaxDocument",params:{businessId:d.getBusinessId()},form:{fileBuffer:s,fileName:a.name,mimeType:a.type,fileSize:a.size,taxPortalId:i,taxYear:n,documentType:t?.documentType,tags:t?.tags,notes:t?.notes,businessId:d.getBusinessId()}});return o?.success&&o?.documentId?{success:!0,documentId:o.documentId,document:o.document}:{success:!1,error:o?.error||"Failed to upload document"}}catch(r){return console.error("Error uploading tax document:",r),{success:!1,error:r.message}}}async function y(a){try{const i=await c({query:"processTaxDocument",params:{businessId:d.getBusinessId()},form:{documentId:a,options:{forceReprocess:!0}}});return i?.success&&i?.document?{success:!0,document:i.document}:{success:!1,error:i?.error||"Failed to process document"}}catch(i){return console.error("Error processing tax document:",i),{success:!1,error:i.message}}}async function g(a){try{const i=await c({query:"batchProcessTaxDocuments",params:{businessId:d.getBusinessId()},form:{documentIds:a}});return{success:i?.success||!1,results:i?.results||[],totalProcessed:i?.totalProcessed||0,totalFailed:i?.totalFailed||0}}catch(i){return console.error("Error batch processing tax documents:",i),{success:!1,results:[],totalProcessed:0,totalFailed:a.length}}}async function h(a,i){try{const n=await c({query:"getTaxDocuments",params:{businessId:d.getBusinessId()},form:{taxPortalId:a,taxYear:i}});return(n?.data?.data||n?.data||[]).map(r=>m(r))}catch(n){return console.error("Error getting client tax documents:",n),[]}}async function T(a){try{const i=await c({query:"deleteTaxDocument",params:{businessId:d.getBusinessId(),id:a},form:{documentId:a,id:a}});return{success:i?.success||!1,error:i?.error}}catch(i){return console.error("Error deleting tax document:",i),{success:!1,error:i.message}}}function m(a){const i={pending:"pending",processing:"analyzing",processed:"analyzed",complete:"analyzed",verified:"verified",error:"error",flagged:"error"},n={"w-2":"w2",w2:"w2",form_w2:"w2","1099-misc":"1099_misc","1099_misc":"1099_misc",form_1099_misc:"1099_misc","1099-nec":"1099_nec","1099_nec":"1099_nec",form_1099_nec:"1099_nec","1099-int":"1099_int","1099_int":"1099_int",form_1099_int:"1099_int","1099-div":"1099_div","1099_div":"1099_div",form_1099_div:"1099_div",1098:"1098",form_1098:"1098","1098-t":"1098_t","1098_t":"1098_t",form_1098_t:"1098_t",schedule_k1:"schedule_k1","schedule k-1":"schedule_k1","k-1":"schedule_k1",k1:"schedule_k1",receipt:"receipt"},t={},r=a.extractedData;if(r?.w2Data){const e=r.w2Data;t.wages=e.wagesTipsCompensation,t.federalTaxWithheld=e.federalTaxWithheld,t.socialSecurityWages=e.socialSecurityWages,t.socialSecurityTax=e.socialSecurityTax,t.medicareWages=e.medicareWages,t.medicareTax=e.medicareTax,t.socialSecurityTips=e.socialSecurityTips,t.allocatedTips=e.allocatedTips,t.dependentCareBenefits=e.dependentCareBenefits,t.nonqualifiedPlans=e.nonqualifiedPlans,t.stateWages=e.stateWages,t.stateTaxWithheld=e.stateTax,t.localWages=e.localWages,t.localTaxWithheld=e.localTax}if(r?.form1099necData){const e=r.form1099necData;t.nonEmployeeCompensation=e.nonEmployeeCompensation,t.federalTaxWithheld1099=e.federalTaxWithheld}if(r?.form1099miscData){const e=r.form1099miscData;t.rents=e.rents,t.royalties=e.royalties,t.otherIncome=e.otherIncome,t.fishingBoatProceeds=e.fishingBoatProceeds,t.medicalPayments=e.medicalPayments,t.cropInsurance=e.cropInsurance,t.grossProceeds=e.grossProceeds,t.federalTaxWithheld1099=e.federalTaxWithheld}if(r?.form1099intData){const e=r.form1099intData;t.interestIncome=e.interestIncome,t.earlyWithdrawalPenalty=e.earlyWithdrawalPenalty,t.usSavingsBondInterest=e.usSavingsBondInterest,t.taxExemptInterest=e.taxExemptInterest,t.privateBondInterest=e.privateBondInterest,t.foreignTaxPaid=e.foreignTaxPaid,t.federalTaxWithheld1099=e.federalTaxWithheld}if(r?.form1099divData){const e=r.form1099divData;t.ordinaryDividends=e.ordinaryDividends,t.qualifiedDividends=e.qualifiedDividends,t.capitalGainDistributions=e.capitalGainDistributions,t.unrecaptured1250Gain=e.unrecaptured1250Gain,t.section1202Gain=e.section1202Gain,t.collectiblesGain=e.collectiblesGain,t.nondividendDistributions=e.nondividendDistributions,t.section199ADividends=e.section199ADividends,t.investmentExpenses=e.investmentExpenses,t.foreignTaxPaid=e.foreignTaxPaid,t.exemptInterestDividends=e.exemptInterestDividends,t.federalTaxWithheld1099=e.federalTaxWithheld}if(r?.form1098Data){const e=r.form1098Data;t.mortgageInterest=e.mortgageInterest,t.outstandingPrincipal=e.outstandingPrincipal,t.mortgageOriginationDate=e.mortgageOriginationDate,t.refundOfOverpaidInterest=e.refundOfOverpaidInterest,t.mortgageInsurancePremiums=e.mortgageInsurancePremiums,t.pointsPaid=e.pointsPaid,t.propertyAddress=e.propertyAddress,t.propertyTaxes=e.propertyTax}if(r?.form1098tData){const e=r.form1098tData;t.paymentsReceived=e.paymentsReceived,t.amountsBilled=e.amountsBilled,t.adjustmentsPriorYear=e.adjustmentsPriorYear,t.scholarshipsGrants=e.scholarshipsGrants,t.adjustmentsScholarships=e.adjustmentsScholarships,t.includesJanMarch=e.includesJanMarch,t.halfTimeStudent=e.halfTimeStudent,t.graduateStudent=e.graduateStudent}if(r?.scheduleK1Data){const e=r.scheduleK1Data;t.ordinaryBusinessIncome=e.ordinaryBusinessIncome,t.rentalRealEstateIncome=e.rentalRealEstateIncome,t.otherRentalIncome=e.otherRentalIncome,t.guaranteedPayments=e.guaranteedPayments,t.interestIncomeK1=e.interestIncome,t.dividendIncomeK1=e.ordinaryDividends,t.qualifiedDividendsK1=e.qualifiedDividends,t.royaltiesK1=e.royalties,t.shortTermCapitalGain=e.shortTermCapitalGain,t.longTermCapitalGain=e.longTermCapitalGain,t.unrecaptured1250GainK1=e.unrecaptured1250Gain,t.section1231Gain=e.section1231Gain,t.section179Deduction=e.section179Deduction,t.selfEmploymentEarnings=e.selfEmploymentEarnings}const s={};(r?.payerName||r?.payerTIN||r?.payerAddress)&&(s.name=r.payerName,s.ein=r.payerTIN,r.payerAddress&&(s.address=r.payerAddress.street,s.city=r.payerAddress.city,s.state=r.payerAddress.state,s.zip=r.payerAddress.zipCode));const o=a.uploadedAt?new Date(a.uploadedAt).getTime():a.createdAt?new Date(a.createdAt).getTime():Date.now(),l=a.documentType||a.classification?.documentType||"other",u=a.ocrConfidence?a.ocrConfidence<=1?Math.round(a.ocrConfidence*100):a.ocrConfidence:void 0;return{id:a.id,clientNotaryId:a.taxPortalId||a.clientNotaryId||"",documentType:l,drakeFormType:n[l.toLowerCase()]||"other",fileUrl:a.fileUrl||a.filePath||"",originalFileName:a.originalName||a.fileName||"",fileSize:a.fileSize,mimeType:a.mimeType,uploadedAt:o,uploadStatus:i[a.status]||i[a.processingStage||""]||"pending",aiConfidence:u,aiAnalyzedAt:a.updatedAt?new Date(a.updatedAt).getTime():void 0,extractedAmounts:Object.keys(t).length>0?t:void 0,payerInfo:Object.keys(s).length>0?s:void 0,taxYear:a.taxYear||r?.taxYear,verified:a.verified||a.validationStatus==="valid",verifiedBy:a.verifiedBy,verifiedAt:a.verifiedAt,notes:a.notes,errorMessage:a.errorMessage||(a.validationErrors?.length?a.validationErrors.map(e=>e.message).join("; "):void 0)}}export{m as a,g as b,T as d,h as g,y as p,p as u};
