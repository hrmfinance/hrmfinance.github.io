import{c as P,o as Ce,g as B,k as Ie,l as ce,q as _e,m as xe,n as Be,w as E,t as f,i as s,a as r,I as Y,B as C,S as k,b as ye,F as $e,j as R,r as A,x as oe,v as we,M as De,y as Oe,z as Ee}from"./index-DJQ7h4gy.js";var Te=f("<div><strong></strong> "),Me=f("<div><p>Loading stores..."),Ne=f("<div>"),ke=f("<div><h3>Basic Information</h3><div>"),ze=f("<div><h3>Address</h3><div><div>"),Fe=f("<div><h3>Contact Information</h3><div>"),Ue=f("<div><h2></h2><div>"),Le=f("<div><div><h1>Store Management</h1><p>Manage stores, locations, and their configurations</p></div><div><div>"),Re=f("<div><table><thead><tr><th>Store ID</th><th>Name</th><th>Type</th><th>Business</th><th>Status</th><th>Actions</th></tr></thead><tbody>"),qe=f("<div><p>No stores found. Create your first store."),He=f("<tr><td></td><td><div></div><div></div></td><td><span></span></td><td></td><td><span></span></td><td><div>");const je=()=>{const[q,ue]=P([]),[I,_]=P(!1),[pe,H]=P(!1),[$,J]=P(null),[y,j]=P({id:"",name:"",description:"",address:{street:"",city:"",state:"",zipCode:"",country:"US"},contact:{phone:"",email:"",manager:""},storeType:"store",businessId:""}),[w,G]=P({}),[T,p]=P(null),[V,me]=P([]),[F,U]=P(!1);Ce(()=>{M(),le()});const le=async()=>{try{const e=[];if(B.isAdmin()){const t=Ie(ce,"businesses"),a=_e(t,xe("name"));(await Be(a)).forEach(u=>{const S=u.data();S.isActive&&e.push({id:u.id,name:S.name})})}else{const t=B.getBusinessId()||"default";e.push({id:t,name:`Current Business (${t})`})}if(e.length===0){const t=[{id:"SS695841584167881",name:"Stephanie S"},{id:"YB100423253156428",name:"YABA"},{id:"JJCM23753J15918M",name:"GUANCHO"},{id:"LMR470531564CT28",name:"LUISCUETO"}];e.push(...t)}me(e)}catch(e){console.error("Error loading businesses:",e)}},M=async()=>{try{_(!0);let e=[];if(B.isAdmin())e=await E.getAllStores();else{const t=B.getBusinessId();t&&(e=await E.getStoresByBusiness(t))}ue(e)}catch(e){console.error("Error loading stores:",e),p({type:"error",text:"Failed to load stores"})}finally{_(!1)}},ge=()=>{const e={},t=y();return console.log("Validating form data:",t),t.name.trim()||(e.name="Store name is required"),t.id.trim()?/^[A-Za-z0-9_-]{2,20}$/.test(t.id)||(e.id="Store ID must be 2-20 characters, letters, numbers, underscore or dash only"):e.id="Store ID is required",(!t.businessId||!t.businessId.trim())&&(e.businessId="Business ID is required",console.log("Business ID validation failed:",t.businessId)),(!t.address||!t.address.street.trim())&&(e.street="Street address is required"),(!t.address||!t.address.city.trim())&&(e.city="City is required"),t.contact&&t.contact.email&&!/\S+@\S+\.\S+/.test(t.contact.email)&&(e.email="Invalid email format"),!$()&&q().find(a=>a.id===t.id)&&(e.id="Store ID already exists"),console.log("Validation errors:",e),G(e),Object.keys(e).length===0},Se=async()=>{if(console.log("Form data before validation:",y()),!ge()){console.log("Form validation failed, errors:",w());return}try{_(!0),p(null);const e=y(),t=B.state.user;console.log("Proceeding with form submission:",e);const a={id:e.id,name:e.name,code:e.id,type:e.storeType,description:e.description,address:e.address,contact:e.contact,storeType:e.storeType,businessId:e.businessId,isActive:!0,createdBy:t?.uid||"unknown",createdDate:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};$()?(await E.updateStore($().id,a),p({type:"success",text:"Store updated successfully"})):(await E.addStore(a),p({type:"success",text:"Store created successfully"})),await M(),Z()}catch(e){console.error("Error saving store:",e),p({type:"error",text:$()?"Failed to update store":"Failed to create store"})}finally{_(!1)}},ve=e=>{J(e),j({id:e.id,name:e.name,description:e.description||"",address:e.address||{street:"",city:"",state:"",zipCode:"",country:"US"},contact:e.contact||{phone:"",email:"",manager:""},storeType:e.storeType,businessId:e.businessId}),H(!0)},he=async e=>{if(confirm(`Are you sure you want to delete "${e.name}"?`))try{_(!0),await E.deleteStore(e.id),p({type:"success",text:"Store deleted successfully"}),await M()}catch(t){console.error("Error deleting store:",t),p({type:"error",text:"Failed to delete store"})}finally{_(!1)}},be=async e=>{try{_(!0);const t={...e,isActive:!e.isActive,updatedAt:new Date().toISOString()};await E.updateStore(e.id,t),p({type:"success",text:`Store ${e.isActive?"deactivated":"activated"} successfully`}),await M()}catch(t){console.error("Error toggling store status:",t),p({type:"error",text:"Failed to update store status"})}finally{_(!1)}},fe=()=>{J(null);const e=V()[0]?.id||B.getBusinessId()||"";j({id:"",name:"",description:"",address:{street:"",city:"",state:"",zipCode:"",country:"US"},contact:{phone:"",email:"",manager:""},storeType:"store",businessId:e}),G({}),H(!0)},Z=()=>{H(!1),J(null),G({})},v=(e,t)=>{j(a=>{const g={...a};let u=g;for(let S=0;S<e.length-1;S++)u=u[e[S]]={...u[e[S]]};return u[e[e.length-1]]=t,g})},Ae=async()=>{if(!B.isAdmin()){p({type:"error",text:"Only admins can seed business data"});return}U(!0);try{const e=[{id:"SS695841584167881",name:"Stephanie S",description:"Stephanie S Business",isActive:!0,createdAt:new Date().toISOString(),createdBy:"system",updatedAt:new Date().toISOString()},{id:"YB100423253156428",name:"YABA",description:"YABA Business Group",isActive:!0,createdAt:new Date().toISOString(),createdBy:"system",updatedAt:new Date().toISOString()},{id:"JJCM23753J15918M",name:"GUANCHO",description:"GUANCHO Business",isActive:!0,createdAt:new Date().toISOString(),createdBy:"system",updatedAt:new Date().toISOString()},{id:"LMR470531564CT28",name:"LUISCUETO",description:"LUISCUETO Business",isActive:!0,createdAt:new Date().toISOString(),createdBy:"system",updatedAt:new Date().toISOString()}];let t=0;for(const a of e)try{const g=Oe(ce,"businesses",a.id);await Ee(g,a),t++}catch(g){console.error(`Error seeding business ${a.name}:`,g)}p({type:"success",text:`Successfully seeded ${t} businesses to Firestore`}),await le()}catch(e){console.error("Error seeding businesses:",e),p({type:"error",text:"Failed to seed businesses"})}finally{U(!1)}},Pe=async()=>{if(!B.isAdmin()){p({type:"error",text:"Only admins can seed location data"});return}U(!0);try{const e=[{id:"YY_8802",code:"YY_8802",name:"CENTER",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8803",code:"YY_8803",name:"BISSONNET",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8804",code:"YY_8804",name:"IRVIN",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8805",code:"YY_8805",name:"KATTY",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8816",code:"YY_8816",type:"store",name:"YABA GLOBAL",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8818",code:"YY_8818",type:"store",name:"YABASURAUSTIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8847",code:"YY_8847",type:"store",name:"YABAOFICINA AZ",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_3251",code:"YY_3251",type:"store",name:"YABA FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_32",code:"YY_32",type:"store",name:"YABA MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_76",code:"YY_76",type:"store",name:"YABA DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_2376",code:"YY_2376",type:"store",name:"YABA SAN ANTONIO",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2025-08-14"},{id:"YY_79",code:"YY_79",type:"warehouse",name:"ALMACEN DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8635",code:"YY_8635",type:"store",name:"FASHION MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8665",code:"YY_8665",name:"IRVIN FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,type:"store",createdDate:"2024-01-01"},{id:"YY_3303",code:"YY_3303",name:"YABA MIAMI",bussinesId:"YB100423253156428",address:"Miami",isActive:!0,type:"store",createdDate:"2025-08-01"},{id:"YY_3329",code:"YY_3329",name:"YABA MIAMI 29",bussinesId:"YB100423253156428",address:"Miami",isActive:!0,type:"store",createdDate:"2025-08-01"},{id:"YY_8901",code:"YY_8901",name:"ALMACEN CENTRAL YABA",bussinesId:"YB100423253156428",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"SS_42",code:"SS_42",name:"STEPHANIE SOLUTION",bussinesId:"SS695841584167881",type:"store",address:"5520 Fern Valley Rd, Ste 108, Louisville, KY 40228",isActive:!0,createdDate:"2024-01-01"}];let t=0;for(const a of e)try{const g={id:a.id,name:a.name,code:a.code,type:a.type,storeType:a.type,businessId:a.bussinesId,address:typeof a.address=="string"?{street:a.address,city:"",state:"",zipCode:"",country:"US"}:a.address,isActive:a.isActive,createdDate:a.createdDate,createdAt:a.createdDate,createdBy:"system",updatedAt:a.createdDate};await E.addStore(g),t++}catch(g){console.error(`Error seeding location ${a.name}:`,g)}p({type:"success",text:`Successfully seeded ${t} stores using API`}),await M()}catch(e){console.error("Error seeding locations:",e),p({type:"error",text:"Failed to seed locations"})}finally{U(!1)}};return(()=>{var e=Le(),t=e.firstChild,a=t.firstChild,g=a.nextSibling,u=t.nextSibling,S=u.firstChild;return e.style.setProperty("padding","2rem"),e.style.setProperty("max-width","1200px"),e.style.setProperty("margin","0 auto"),t.style.setProperty("margin-bottom","2rem"),a.style.setProperty("font-size","2rem"),a.style.setProperty("font-weight","700"),a.style.setProperty("color","var(--text-primary)"),g.style.setProperty("color","var(--text-muted)"),g.style.setProperty("font-size","1.125rem"),u.style.setProperty("display","flex"),u.style.setProperty("justify-content","space-between"),u.style.setProperty("align-items","center"),u.style.setProperty("margin-bottom","2rem"),u.style.setProperty("flex-wrap","wrap"),u.style.setProperty("gap","1rem"),S.style.setProperty("display","flex"),S.style.setProperty("gap","1rem"),S.style.setProperty("align-items","center"),S.style.setProperty("flex-wrap","wrap"),s(S,r(C,{onClick:M,get disabled(){return I()},get children(){return[r(Y,{name:"search",size:"1em",style:{"margin-right":"0.5rem"}}),"Refresh"]}}),null),s(S,r(k,{get when(){return!1},get children(){return[r(C,{onClick:Ae,get disabled(){return I()||F()},variant:"outline",get children(){return[r(Y,{name:"upload",size:"1em",style:{"margin-right":"0.5rem"}}),r(k,{get when(){return F()},fallback:"Seed Businesses",children:"Seeding..."})]}}),r(C,{onClick:Pe,get disabled(){return I()||F()},variant:"outline",get children(){return[r(Y,{name:"store",size:"1em",style:{"margin-right":"0.5rem"}}),r(k,{get when(){return F()},fallback:"Seed Locations",children:"Seeding..."})]}})]}}),null),s(u,r(C,{onClick:fe,variant:"primary",get disabled(){return I()},get children(){return[r(Y,{name:"add",size:"1em",style:{"margin-right":"0.5rem"}}),"Create New Store"]}}),null),s(e,r(k,{get when(){return T()},get children(){var l=Te(),d=l.firstChild;return d.nextSibling,l.style.setProperty("padding","1rem"),l.style.setProperty("margin-bottom","1rem"),l.style.setProperty("border-radius","var(--border-radius)"),s(d,()=>T().type==="success"?"✓ Success:":"⚠ Error:"),s(l,()=>T().text,null),ye(o=>{var c=T().type==="success"?"var(--success-light)":"var(--error-light)",m=T().type==="success"?"var(--success-dark)":"var(--error-dark)",i=`1px solid ${T().type==="success"?"var(--success-color)":"var(--error-color)"}`;return c!==o.e&&((o.e=c)!=null?l.style.setProperty("background",c):l.style.removeProperty("background")),m!==o.t&&((o.t=m)!=null?l.style.setProperty("color",m):l.style.removeProperty("color")),i!==o.a&&((o.a=i)!=null?l.style.setProperty("border",i):l.style.removeProperty("border")),o},{e:void 0,t:void 0,a:void 0}),l}}),null),s(e,r(R,{get children(){var l=Ne();return l.style.setProperty("padding","1.5rem"),s(l,r(k,{get when(){return I()},get fallback(){return r(k,{get when(){return q().length>0},get fallback(){return(()=>{var d=qe(),o=d.firstChild;return d.style.setProperty("text-align","center"),d.style.setProperty("padding","2rem"),d.style.setProperty("color","var(--text-muted)"),s(d,r(Y,{name:"store",size:"3rem",style:{opacity:"0.3","margin-bottom":"1rem"}}),o),d})()},get children(){var d=Re(),o=d.firstChild,c=o.firstChild,m=c.firstChild,i=m.firstChild,n=i.nextSibling,h=n.nextSibling,K=h.nextSibling,Q=K.nextSibling,de=Q.nextSibling,Ye=c.nextSibling;return d.style.setProperty("overflow-x","auto"),o.style.setProperty("width","100%"),o.style.setProperty("border-collapse","collapse"),m.style.setProperty("border-bottom","2px solid var(--border-color)"),i.style.setProperty("padding","1rem"),i.style.setProperty("text-align","left"),n.style.setProperty("padding","1rem"),n.style.setProperty("text-align","left"),h.style.setProperty("padding","1rem"),h.style.setProperty("text-align","left"),K.style.setProperty("padding","1rem"),K.style.setProperty("text-align","left"),Q.style.setProperty("padding","1rem"),Q.style.setProperty("text-align","center"),de.style.setProperty("padding","1rem"),de.style.setProperty("text-align","center"),s(Ye,r($e,{get each(){return q()},children:b=>(()=>{var W=He(),z=W.firstChild,X=z.nextSibling,ee=X.firstChild,te=ee.nextSibling,re=X.nextSibling,D=re.firstChild,se=re.nextSibling,L=se.nextSibling,x=L.firstChild,ae=L.nextSibling,N=ae.firstChild;return W.style.setProperty("border-bottom","1px solid var(--border-light)"),z.style.setProperty("padding","1rem"),z.style.setProperty("font-family","monospace"),z.style.setProperty("font-weight","600"),s(z,()=>b.id),X.style.setProperty("padding","1rem"),ee.style.setProperty("font-weight","500"),s(ee,()=>b.name),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),s(te,()=>b.description||"No description"),re.style.setProperty("padding","1rem"),D.style.setProperty("padding","0.25rem 0.5rem"),D.style.setProperty("border-radius","4px"),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("background","var(--primary-light)"),D.style.setProperty("color","#ffffff"),D.style.setProperty("text-transform","capitalize"),s(D,()=>b.storeType),se.style.setProperty("padding","1rem"),s(se,()=>V().find(O=>O.id===b.businessId)?.name||b.businessId),L.style.setProperty("padding","1rem"),L.style.setProperty("text-align","center"),x.style.setProperty("padding","0.25rem 0.5rem"),x.style.setProperty("border-radius","4px"),x.style.setProperty("font-size","0.875rem"),s(x,()=>b.isActive?"Active":"Inactive"),ae.style.setProperty("padding","1rem"),ae.style.setProperty("text-align","center"),N.style.setProperty("display","flex"),N.style.setProperty("gap","0.5rem"),N.style.setProperty("justify-content","center"),s(N,r(C,{size:"sm",variant:"secondary",onClick:()=>ve(b),get children(){return r(Y,{name:"edit",size:"0.875rem"})}}),null),s(N,r(C,{size:"sm",variant:"secondary",onClick:()=>be(b),get children(){return r(Y,{get name(){return b.isActive?"close":"check"},size:"0.875rem"})}}),null),s(N,r(C,{size:"sm",variant:"secondary",onClick:()=>he(b),style:{color:"var(--error-color)"},get children(){return r(Y,{name:"delete",size:"0.875rem"})}}),null),ye(O=>{var ie=b.isActive?"var(--success-light)":"var(--error-light)",ne=b.isActive?"var(--success-dark)":"var(--error-dark)";return ie!==O.e&&((O.e=ie)!=null?x.style.setProperty("background",ie):x.style.removeProperty("background")),ne!==O.t&&((O.t=ne)!=null?x.style.setProperty("color",ne):x.style.removeProperty("color")),O},{e:void 0,t:void 0}),W})()})),d}})},get children(){var d=Me(),o=d.firstChild;return d.style.setProperty("text-align","center"),d.style.setProperty("padding","2rem"),s(d,r(Y,{name:"loading",size:"2rem"}),o),d}})),l}}),null),s(e,r(De,{get isOpen(){return pe()},onClose:Z,size:"large",get children(){var l=Ue(),d=l.firstChild,o=d.nextSibling;return l.style.setProperty("padding","2rem"),d.style.setProperty("margin-bottom","1.5rem"),s(d,()=>$()?"Edit Store":"Create New Store"),s(l,r(R,{style:{"margin-bottom":"1.5rem"},get children(){var c=ke(),m=c.firstChild,i=m.nextSibling;return c.style.setProperty("padding","1.5rem"),m.style.setProperty("margin-bottom","1rem"),i.style.setProperty("display","grid"),i.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(300px, 1fr))"),i.style.setProperty("gap","1rem"),s(i,r(A,{label:"Store ID *",get value(){return y().id},onChange:n=>v(["id"],n),placeholder:"e.g., STORE_001",get disabled(){return!!$()},get error(){return w().id}}),null),s(i,r(A,{label:"Store Name *",get value(){return y().name},onChange:n=>v(["name"],n),placeholder:"e.g., Main Street Store",get error(){return w().name}}),null),s(i,r(oe,{label:"Store Type *",get value(){return y().storeType},onChange:n=>v(["storeType"],n),options:[{value:"store",label:"Store"},{value:"warehouse",label:"Warehouse"},{value:"office",label:"Office"},{value:"supplier",label:"Supplier"},{value:"customer",label:"Customer"},{value:"retail",label:"Retail Store"},{value:"other",label:"Other"}]}),null),s(i,r(oe,{label:"Business *",get value(){return y().businessId},onChange:n=>v(["businessId"],n),get options(){return V().map(n=>({value:n.id,label:n.name}))},get error(){return w().businessId}}),null),s(c,r(A,{label:"Description",get value(){return y().description},onChange:n=>v(["description"],n),placeholder:"Store description",multiline:!0,rows:3,style:{"margin-top":"1rem"}}),null),c}}),o),s(l,r(R,{style:{"margin-bottom":"1.5rem"},get children(){var c=ze(),m=c.firstChild,i=m.nextSibling,n=i.firstChild;return c.style.setProperty("padding","1.5rem"),m.style.setProperty("margin-bottom","1rem"),i.style.setProperty("display","grid"),i.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(300px, 1fr))"),i.style.setProperty("gap","1rem"),n.style.setProperty("grid-column","1 / -1"),s(n,r(A,{label:"Street Address *",get value(){return y().address.street},onChange:h=>v(["address","street"],h),placeholder:"123 Main Street",get error(){return w().street}})),s(i,r(A,{label:"City *",get value(){return y().address.city},onChange:h=>v(["address","city"],h),placeholder:"New York",get error(){return w().city}}),null),s(i,r(A,{label:"State/Province",get value(){return y().address.state},onChange:h=>v(["address","state"],h),placeholder:"NY"}),null),s(i,r(A,{label:"ZIP/Postal Code",get value(){return y().address.zipCode},onChange:h=>v(["address","zipCode"],h),placeholder:"10001"}),null),s(i,r(oe,{label:"Country",get value(){return y().address.country},onChange:h=>v(["address","country"],h),options:[{value:"US",label:"United States"},{value:"CA",label:"Canada"},{value:"MX",label:"Mexico"},{value:"CU",label:"Cuba"},{value:"OTHER",label:"Other"}]}),null),c}}),o),s(l,r(R,{style:{"margin-bottom":"1.5rem"},get children(){var c=Fe(),m=c.firstChild,i=m.nextSibling;return c.style.setProperty("padding","1.5rem"),m.style.setProperty("margin-bottom","1rem"),i.style.setProperty("display","grid"),i.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(300px, 1fr))"),i.style.setProperty("gap","1rem"),s(i,r(A,{label:"Phone",get value(){return y().contact.phone},onChange:n=>v(["contact","phone"],n),placeholder:"(555) 123-4567"}),null),s(i,r(A,{label:"Email",type:"email",get value(){return y().contact.email},onChange:n=>v(["contact","email"],n),placeholder:"store@company.com",get error(){return w().email}}),null),s(i,r(A,{label:"Store Manager",get value(){return y().contact.manager},onChange:n=>v(["contact","manager"],n),placeholder:"John Doe"}),null),c}}),o),o.style.setProperty("display","flex"),o.style.setProperty("gap","1rem"),o.style.setProperty("justify-content","flex-end"),s(o,r(C,{variant:"outline",onClick:Z,get disabled(){return I()},children:"Cancel"}),null),s(o,r(C,{variant:"primary",onClick:Se,get disabled(){return I()},get children(){return we(()=>!!I())()?"Saving...":$()?"Update Store":"Create Store"}}),null),l}}),null),e})()};export{je as default};
