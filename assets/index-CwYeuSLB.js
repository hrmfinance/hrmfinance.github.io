(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const Bg=!1,Fg=(t,e)=>t===e,Jr=Symbol("solid-proxy"),_m=typeof Proxy=="function",Bl=Symbol("solid-track"),ca={equals:Fg};let Sm=Tm;const ii=1,ua=2,Pm={owned:null,cleanups:null,context:null,owner:null};var Dt=null;let ll=null,Ug=null,zt=null,Ar=null,In=null,Oa=0;function Uo(t,e){const r=zt,n=Dt,i=t.length===0,o=e===void 0?n:e,a=i?Pm:{owned:null,cleanups:null,context:o?o.context:null,owner:o},c=i?t:()=>t(()=>Mr(()=>Wo(a)));Dt=a,zt=null;try{return oi(c,!0)}finally{zt=r,Dt=n}}function ge(t,e){e=e?Object.assign({},ca,e):ca;const r={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},n=i=>(typeof i=="function"&&(i=i(r.value)),xm(r,i));return[Em.bind(r),n]}function re(t,e,r){const n=Ac(t,e,!1,ii);ls(n)}function Dn(t,e,r){Sm=Gg;const n=Ac(t,e,!1,ii);n.user=!0,In?In.push(n):ls(n)}function We(t,e,r){r=r?Object.assign({},ca,r):ca;const n=Ac(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,ls(n),Em.bind(n)}function wm(t){return oi(t,!1)}function Mr(t){if(zt===null)return t();const e=zt;zt=null;try{return t()}finally{zt=e}}function Pc(t,e,r){const n=Array.isArray(t);let i,o=r&&r.defer;return a=>{let c;if(n){c=Array(t.length);for(let h=0;h<t.length;h++)c[h]=t[h]()}else c=t();if(o)return o=!1,a;const d=Mr(()=>e(c,i,a));return i=c,d}}function qr(t){Dn(()=>Mr(t))}function co(t){return Dt===null||(Dt.cleanups===null?Dt.cleanups=[t]:Dt.cleanups.push(t)),t}function Fl(){return zt}function Cm(){return Dt}function Am(t,e){const r=Dt,n=zt;Dt=t,zt=null;try{return oi(e,!0)}catch(i){Ic(i)}finally{Dt=r,zt=n}}function jg(t){const e=zt,r=Dt;return Promise.resolve().then(()=>{zt=e,Dt=r;let n;return oi(t,!1),zt=Dt=null,n?n.done:void 0})}const[M2,O2]=ge(!1);function Im(t,e){const r=Symbol("context");return{id:r,Provider:Yg(r),defaultValue:t}}function wc(t){let e;return Dt&&Dt.context&&(e=Dt.context[t.id])!==void 0?e:t.defaultValue}function Cc(t){const e=We(t),r=We(()=>Ul(e()));return r.toArray=()=>{const n=r();return Array.isArray(n)?n:n!=null?[n]:[]},r}function Em(){if(this.sources&&this.state)if(this.state===ii)ls(this);else{const t=Ar;Ar=null,oi(()=>ha(this),!1),Ar=t}if(zt){const t=this.observers?this.observers.length:0;zt.sources?(zt.sources.push(this),zt.sourceSlots.push(t)):(zt.sources=[this],zt.sourceSlots=[t]),this.observers?(this.observers.push(zt),this.observerSlots.push(zt.sources.length-1)):(this.observers=[zt],this.observerSlots=[zt.sources.length-1])}return this.value}function xm(t,e,r){let n=t.value;return(!t.comparator||!t.comparator(n,e))&&(t.value=e,t.observers&&t.observers.length&&oi(()=>{for(let i=0;i<t.observers.length;i+=1){const o=t.observers[i],a=ll&&ll.running;a&&ll.disposed.has(o),(a?!o.tState:!o.state)&&(o.pure?Ar.push(o):In.push(o),o.observers&&$m(o)),a||(o.state=ii)}if(Ar.length>1e6)throw Ar=[],new Error},!1)),e}function ls(t){if(!t.fn)return;Wo(t);const e=Oa;zg(t,t.value,e)}function zg(t,e,r){let n;const i=Dt,o=zt;zt=Dt=t;try{n=t.fn(e)}catch(a){return t.pure&&(t.state=ii,t.owned&&t.owned.forEach(Wo),t.owned=null),t.updatedAt=r+1,Ic(a)}finally{zt=o,Dt=i}(!t.updatedAt||t.updatedAt<=r)&&(t.updatedAt!=null&&"observers"in t?xm(t,n):t.value=n,t.updatedAt=r)}function Ac(t,e,r,n=ii,i){const o={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:Dt,context:Dt?Dt.context:null,pure:r};return Dt===null||Dt!==Pm&&(Dt.owned?Dt.owned.push(o):Dt.owned=[o]),o}function da(t){if(t.state===0)return;if(t.state===ua)return ha(t);if(t.suspense&&Mr(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<Oa);)t.state&&e.push(t);for(let r=e.length-1;r>=0;r--)if(t=e[r],t.state===ii)ls(t);else if(t.state===ua){const n=Ar;Ar=null,oi(()=>ha(t,e[0]),!1),Ar=n}}function oi(t,e){if(Ar)return t();let r=!1;e||(Ar=[]),In?r=!0:In=[],Oa++;try{const n=t();return qg(r),n}catch(n){r||(In=null),Ar=null,Ic(n)}}function qg(t){if(Ar&&(Tm(Ar),Ar=null),t)return;const e=In;In=null,e.length&&oi(()=>Sm(e),!1)}function Tm(t){for(let e=0;e<t.length;e++)da(t[e])}function Gg(t){let e,r=0;for(e=0;e<t.length;e++){const n=t[e];n.user?t[r++]=n:da(n)}for(e=0;e<r;e++)da(t[e])}function ha(t,e){t.state=0;for(let r=0;r<t.sources.length;r+=1){const n=t.sources[r];if(n.sources){const i=n.state;i===ii?n!==e&&(!n.updatedAt||n.updatedAt<Oa)&&da(n):i===ua&&ha(n,e)}}}function $m(t){for(let e=0;e<t.observers.length;e+=1){const r=t.observers[e];r.state||(r.state=ua,r.pure?Ar.push(r):In.push(r),r.observers&&$m(r))}}function Wo(t){let e;if(t.sources)for(;t.sources.length;){const r=t.sources.pop(),n=t.sourceSlots.pop(),i=r.observers;if(i&&i.length){const o=i.pop(),a=r.observerSlots.pop();n<i.length&&(o.sourceSlots[a]=n,i[n]=o,r.observerSlots[n]=a)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)Wo(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)Wo(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function Hg(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function Ic(t,e=Dt){throw Hg(t)}function Ul(t){if(typeof t=="function"&&!t.length)return Ul(t());if(Array.isArray(t)){const e=[];for(let r=0;r<t.length;r++){const n=Ul(t[r]);Array.isArray(n)?e.push.apply(e,n):e.push(n)}return e}return t}function Yg(t,e){return function(n){let i;return re(()=>i=Mr(()=>(Dt.context={...Dt.context,[t]:n.value},Cc(()=>n.children))),void 0),i}}const Wg=Symbol("fallback");function rd(t){for(let e=0;e<t.length;e++)t[e]()}function Kg(t,e,r={}){let n=[],i=[],o=[],a=0,c=e.length>1?[]:null;return co(()=>rd(o)),()=>{let d=t()||[],h=d.length,m,g;return d[Bl],Mr(()=>{let A,M,L,k,R,W,ie,te,ye;if(h===0)a!==0&&(rd(o),o=[],n=[],i=[],a=0,c&&(c=[])),r.fallback&&(n=[Wg],i[0]=Uo(ae=>(o[0]=ae,r.fallback())),a=1);else if(a===0){for(i=new Array(h),g=0;g<h;g++)n[g]=d[g],i[g]=Uo(_);a=h}else{for(L=new Array(h),k=new Array(h),c&&(R=new Array(h)),W=0,ie=Math.min(a,h);W<ie&&n[W]===d[W];W++);for(ie=a-1,te=h-1;ie>=W&&te>=W&&n[ie]===d[te];ie--,te--)L[te]=i[ie],k[te]=o[ie],c&&(R[te]=c[ie]);for(A=new Map,M=new Array(te+1),g=te;g>=W;g--)ye=d[g],m=A.get(ye),M[g]=m===void 0?-1:m,A.set(ye,g);for(m=W;m<=ie;m++)ye=n[m],g=A.get(ye),g!==void 0&&g!==-1?(L[g]=i[m],k[g]=o[m],c&&(R[g]=c[m]),g=M[g],A.set(ye,g)):o[m]();for(g=W;g<h;g++)g in L?(i[g]=L[g],o[g]=k[g],c&&(c[g]=R[g],c[g](g))):i[g]=Uo(_);i=i.slice(0,a=h),n=d.slice(0)}return i});function _(A){if(o[g]=A,c){const[M,L]=ge(g);return c[g]=L,e(d[g],M)}return e(d[g])}}}function b(t,e){return Mr(()=>t(e||{}))}function Ds(){return!0}const jl={get(t,e,r){return e===Jr?r:t.get(e)},has(t,e){return e===Jr?!0:t.has(e)},set:Ds,deleteProperty:Ds,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:Ds,deleteProperty:Ds}},ownKeys(t){return t.keys()}};function cl(t){return(t=typeof t=="function"?t():t)?t:{}}function Qg(){for(let t=0,e=this.length;t<e;++t){const r=this[t]();if(r!==void 0)return r}}function zl(...t){let e=!1;for(let a=0;a<t.length;a++){const c=t[a];e=e||!!c&&Jr in c,t[a]=typeof c=="function"?(e=!0,We(c)):c}if(_m&&e)return new Proxy({get(a){for(let c=t.length-1;c>=0;c--){const d=cl(t[c])[a];if(d!==void 0)return d}},has(a){for(let c=t.length-1;c>=0;c--)if(a in cl(t[c]))return!0;return!1},keys(){const a=[];for(let c=0;c<t.length;c++)a.push(...Object.keys(cl(t[c])));return[...new Set(a)]}},jl);const r={},n=Object.create(null);for(let a=t.length-1;a>=0;a--){const c=t[a];if(!c)continue;const d=Object.getOwnPropertyNames(c);for(let h=d.length-1;h>=0;h--){const m=d[h];if(m==="__proto__"||m==="constructor")continue;const g=Object.getOwnPropertyDescriptor(c,m);if(!n[m])n[m]=g.get?{enumerable:!0,configurable:!0,get:Qg.bind(r[m]=[g.get.bind(c)])}:g.value!==void 0?g:void 0;else{const _=r[m];_&&(g.get?_.push(g.get.bind(c)):g.value!==void 0&&_.push(()=>g.value))}}}const i={},o=Object.keys(n);for(let a=o.length-1;a>=0;a--){const c=o[a],d=n[c];d&&d.get?Object.defineProperty(i,c,d):i[c]=d?d.value:void 0}return i}function Jg(t,...e){if(_m&&Jr in t){const i=new Set(e.length>1?e.flat():e[0]),o=e.map(a=>new Proxy({get(c){return a.includes(c)?t[c]:void 0},has(c){return a.includes(c)&&c in t},keys(){return a.filter(c=>c in t)}},jl));return o.push(new Proxy({get(a){return i.has(a)?void 0:t[a]},has(a){return i.has(a)?!1:a in t},keys(){return Object.keys(t).filter(a=>!i.has(a))}},jl)),o}const r={},n=e.map(()=>({}));for(const i of Object.getOwnPropertyNames(t)){const o=Object.getOwnPropertyDescriptor(t,i),a=!o.get&&!o.set&&o.enumerable&&o.writable&&o.configurable;let c=!1,d=0;for(const h of e)h.includes(i)&&(c=!0,a?n[d][i]=o.value:Object.defineProperty(n[d],i,o)),++d;c||(a?r[i]=o.value:Object.defineProperty(r,i,o))}return[...n,r]}const Xg=t=>`Stale read from <${t}>.`;function pt(t){const e="fallback"in t&&{fallback:()=>t.fallback};return We(Kg(()=>t.each,t.children,e||void 0))}function Ne(t){const e=t.keyed,r=We(()=>t.when,void 0,void 0),n=e?r:We(r,void 0,{equals:(i,o)=>!i==!o});return We(()=>{const i=n();if(i){const o=t.children;return typeof o=="function"&&o.length>0?Mr(()=>o(e?i:()=>{if(!Mr(n))throw Xg("Show");return r()})):o}return t.fallback},void 0,void 0)}const Zg=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],ep=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline",...Zg]),tp=new Set(["innerHTML","textContent","innerText","children"]),rp=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),np=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function ip(t,e){const r=np[t];return typeof r=="object"?r[e]?r.$:void 0:r}const op=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),fe=t=>We(()=>t());function sp(t,e,r){let n=r.length,i=e.length,o=n,a=0,c=0,d=e[i-1].nextSibling,h=null;for(;a<i||c<o;){if(e[a]===r[c]){a++,c++;continue}for(;e[i-1]===r[o-1];)i--,o--;if(i===a){const m=o<n?c?r[c-1].nextSibling:r[o-c]:d;for(;c<o;)t.insertBefore(r[c++],m)}else if(o===c)for(;a<i;)(!h||!h.has(e[a]))&&e[a].remove(),a++;else if(e[a]===r[o-1]&&r[c]===e[i-1]){const m=e[--i].nextSibling;t.insertBefore(r[c++],e[a++].nextSibling),t.insertBefore(r[--o],m),e[i]=r[o]}else{if(!h){h=new Map;let g=c;for(;g<o;)h.set(r[g],g++)}const m=h.get(e[a]);if(m!=null)if(c<m&&m<o){let g=a,_=1,A;for(;++g<i&&g<o&&!((A=h.get(e[g]))==null||A!==m+_);)_++;if(_>m-c){const M=e[a];for(;c<m;)t.insertBefore(r[c++],M)}else t.replaceChild(r[c++],e[a++])}else a++;else e[a++].remove()}}}const nd="_$DX_DELEGATE";function ap(t,e,r,n={}){let i;return Uo(o=>{i=o,e===document?t():s(e,t(),e.firstChild?null:void 0,r)},n.owner),()=>{i(),e.textContent=""}}function z(t,e,r,n){let i;const o=()=>{const c=n?document.createElementNS("http://www.w3.org/1998/Math/MathML","template"):document.createElement("template");return c.innerHTML=t,r?c.content.firstChild.firstChild:n?c.firstChild:c.content.firstChild},a=e?()=>Mr(()=>document.importNode(i||(i=o()),!0)):()=>(i||(i=o())).cloneNode(!0);return a.cloneNode=a,a}function At(t,e=window.document){const r=e[nd]||(e[nd]=new Set);for(let n=0,i=t.length;n<i;n++){const o=t[n];r.has(o)||(r.add(o),e.addEventListener(o,fp))}}function ct(t,e,r){r==null?t.removeAttribute(e):t.setAttribute(e,r)}function lp(t,e,r){r?t.setAttribute(e,""):t.removeAttribute(e)}function Ec(t,e){e==null?t.removeAttribute("class"):t.className=e}function xi(t,e,r,n){if(n)Array.isArray(r)?(t[`$$${e}`]=r[0],t[`$$${e}Data`]=r[1]):t[`$$${e}`]=r;else if(Array.isArray(r)){const i=r[0];t.addEventListener(e,r[0]=o=>i.call(t,r[1],o))}else t.addEventListener(e,r,typeof r!="function"&&r)}function cp(t,e,r={}){const n=Object.keys(e||{}),i=Object.keys(r);let o,a;for(o=0,a=i.length;o<a;o++){const c=i[o];!c||c==="undefined"||e[c]||(id(t,c,!1),delete r[c])}for(o=0,a=n.length;o<a;o++){const c=n[o],d=!!e[c];!c||c==="undefined"||r[c]===d||!d||(id(t,c,!0),r[c]=d)}return r}function u(t,e,r){if(!e)return r?ct(t,"style"):e;const n=t.style;if(typeof e=="string")return n.cssText=e;typeof r=="string"&&(n.cssText=r=void 0),r||(r={}),e||(e={});let i,o;for(o in r)e[o]==null&&n.removeProperty(o),delete r[o];for(o in e)i=e[o],i!==r[o]&&(n.setProperty(o,i),r[o]=i);return r}function up(t,e={},r,n){const i={};return re(()=>i.children=Ko(t,e.children,i.children)),re(()=>typeof e.ref=="function"&&dp(e.ref,t)),re(()=>hp(t,e,r,!0,i,!0)),i}function dp(t,e,r){return Mr(()=>t(e,r))}function s(t,e,r,n){if(r!==void 0&&!n&&(n=[]),typeof e!="function")return Ko(t,e,n,r);re(i=>Ko(t,e(),i,r),n)}function hp(t,e,r,n,i={},o=!1){e||(e={});for(const a in i)if(!(a in e)){if(a==="children")continue;i[a]=od(t,a,null,i[a],r,o,e)}for(const a in e){if(a==="children")continue;const c=e[a];i[a]=od(t,a,c,i[a],r,o,e)}}function mp(t){return t.toLowerCase().replace(/-([a-z])/g,(e,r)=>r.toUpperCase())}function id(t,e,r){const n=e.trim().split(/\s+/);for(let i=0,o=n.length;i<o;i++)t.classList.toggle(n[i],r)}function od(t,e,r,n,i,o,a){let c,d,h,m,g;if(e==="style")return u(t,r,n);if(e==="classList")return cp(t,r,n);if(r===n)return n;if(e==="ref")o||r(t);else if(e.slice(0,3)==="on:"){const _=e.slice(3);n&&t.removeEventListener(_,n,typeof n!="function"&&n),r&&t.addEventListener(_,r,typeof r!="function"&&r)}else if(e.slice(0,10)==="oncapture:"){const _=e.slice(10);n&&t.removeEventListener(_,n,!0),r&&t.addEventListener(_,r,!0)}else if(e.slice(0,2)==="on"){const _=e.slice(2).toLowerCase(),A=op.has(_);if(!A&&n){const M=Array.isArray(n)?n[0]:n;t.removeEventListener(_,M)}(A||r)&&(xi(t,_,r,A),A&&At([_]))}else e.slice(0,5)==="attr:"?ct(t,e.slice(5),r):e.slice(0,5)==="bool:"?lp(t,e.slice(5),r):(g=e.slice(0,5)==="prop:")||(h=tp.has(e))||(m=ip(e,t.tagName))||(d=ep.has(e))||(c=t.nodeName.includes("-")||"is"in a)?(g&&(e=e.slice(5),d=!0),e==="class"||e==="className"?Ec(t,r):c&&!d&&!h?t[mp(e)]=r:t[m||e]=r):ct(t,rp[e]||e,r);return r}function fp(t){let e=t.target;const r=`$$${t.type}`,n=t.target,i=t.currentTarget,o=d=>Object.defineProperty(t,"target",{configurable:!0,value:d}),a=()=>{const d=e[r];if(d&&!e.disabled){const h=e[`${r}Data`];if(h!==void 0?d.call(e,h,t):d.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&o(e.host),!0},c=()=>{for(;a()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const d=t.composedPath();o(d[0]);for(let h=0;h<d.length-2&&(e=d[h],!!a());h++){if(e._$host){e=e._$host,c();break}if(e.parentNode===i)break}}else c();o(n)}function Ko(t,e,r,n,i){for(;typeof r=="function";)r=r();if(e===r)return r;const o=typeof e,a=n!==void 0;if(t=a&&r[0]&&r[0].parentNode||t,o==="string"||o==="number"){if(o==="number"&&(e=e.toString(),e===r))return r;if(a){let c=r[0];c&&c.nodeType===3?c.data!==e&&(c.data=e):c=document.createTextNode(e),r=Bi(t,r,n,c)}else r!==""&&typeof r=="string"?r=t.firstChild.data=e:r=t.textContent=e}else if(e==null||o==="boolean")r=Bi(t,r,n);else{if(o==="function")return re(()=>{let c=e();for(;typeof c=="function";)c=c();r=Ko(t,c,r,n)}),()=>r;if(Array.isArray(e)){const c=[],d=r&&Array.isArray(r);if(ql(c,e,r,i))return re(()=>r=Ko(t,c,r,n,!0)),()=>r;if(c.length===0){if(r=Bi(t,r,n),a)return r}else d?r.length===0?sd(t,c,n):sp(t,r,c):(r&&Bi(t),sd(t,c));r=c}else if(e.nodeType){if(Array.isArray(r)){if(a)return r=Bi(t,r,n,e);Bi(t,r,null,e)}else r==null||r===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);r=e}}return r}function ql(t,e,r,n){let i=!1;for(let o=0,a=e.length;o<a;o++){let c=e[o],d=r&&r[t.length],h;if(!(c==null||c===!0||c===!1))if((h=typeof c)=="object"&&c.nodeType)t.push(c);else if(Array.isArray(c))i=ql(t,c,d)||i;else if(h==="function")if(n){for(;typeof c=="function";)c=c();i=ql(t,Array.isArray(c)?c:[c],Array.isArray(d)?d:[d])||i}else t.push(c),i=!0;else{const m=String(c);d&&d.nodeType===3&&d.data===m?t.push(d):t.push(document.createTextNode(m))}}return i}function sd(t,e,r=null){for(let n=0,i=e.length;n<i;n++)t.insertBefore(e[n],r)}function Bi(t,e,r,n){if(r===void 0)return t.textContent="";const i=n||document.createTextNode("");if(e.length){let o=!1;for(let a=e.length-1;a>=0;a--){const c=e[a];if(i!==c){const d=c.parentNode===t;!o&&!a?d?t.replaceChild(i,c):t.insertBefore(i,r):d&&c.remove()}else o=!0}}else t.insertBefore(i,r);return[i]}const yp=!1;function km(){let t=new Set;function e(i){return t.add(i),()=>t.delete(i)}let r=!1;function n(i,o){if(r)return!(r=!1);const a={to:i,options:o,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const c of t)c.listener({...a,from:c.location,retry:d=>{d&&(r=!0),c.navigate(i,{...o,resolve:!1})}});return!a.defaultPrevented}return{subscribe:e,confirm:n}}let Gl;function xc(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Gl=window.history.state._depth}xc();function gp(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function pp(t,e){let r=!1;return()=>{const n=Gl;xc();const i=n==null?null:Gl-n;if(r){r=!1;return}i&&e(i)?(r=!0,window.history.go(-i)):t()}}const vp=/^(?:[a-z0-9]+:)?\/\//i,bp=/^\/+|(\/)\/+$/g,Rm="http://sr";function Si(t,e=!1){const r=t.replace(bp,"$1");return r?e||/^[?#]/.test(r)?r:"/"+r:""}function Js(t,e,r){if(vp.test(e))return;const n=Si(t),i=r&&Si(r);let o="";return!i||e.startsWith("/")?o=n:i.toLowerCase().indexOf(n.toLowerCase())!==0?o=n+i:o=i,(o||"/")+Si(e,!o)}function _p(t,e){if(t==null)throw new Error(e);return t}function Sp(t,e){return Si(t).replace(/\/*(\*.*)?$/g,"")+Si(e)}function Dm(t){const e={};return t.searchParams.forEach((r,n)=>{n in e?Array.isArray(e[n])?e[n].push(r):e[n]=[e[n],r]:e[n]=r}),e}function Pp(t,e,r){const[n,i]=t.split("/*",2),o=n.split("/").filter(Boolean),a=o.length;return c=>{const d=c.split("/").filter(Boolean),h=d.length-a;if(h<0||h>0&&i===void 0&&!e)return null;const m={path:a?"":"/",params:{}},g=_=>r===void 0?void 0:r[_];for(let _=0;_<a;_++){const A=o[_],M=A[0]===":",L=M?d[_]:d[_].toLowerCase(),k=M?A.slice(1):A.toLowerCase();if(M&&ul(L,g(k)))m.params[k]=L;else if(M||!ul(L,k))return null;m.path+=`/${L}`}if(i){const _=h?d.slice(-h).join("/"):"";if(ul(_,g(i)))m.params[i]=_;else return null}return m}}function ul(t,e){const r=n=>n===t;return e===void 0?!0:typeof e=="string"?r(e):typeof e=="function"?e(t):Array.isArray(e)?e.some(r):e instanceof RegExp?e.test(t):!1}function wp(t){const[e,r]=t.pattern.split("/*",2),n=e.split("/").filter(Boolean);return n.reduce((i,o)=>i+(o.startsWith(":")?2:3),n.length-(r===void 0?0:1))}function Nm(t){const e=new Map,r=Cm();return new Proxy({},{get(n,i){return e.has(i)||Am(r,()=>e.set(i,We(()=>t()[i]))),e.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function Lm(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let r=t.slice(0,e.index),n=t.slice(e.index+e[0].length);const i=[r,r+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(n);)i.push(r+=e[1]),n=n.slice(e[0].length);return Lm(n).reduce((o,a)=>[...o,...i.map(c=>c+a)],[])}const Cp=100,Mm=Im(),Tc=Im(),cs=()=>_p(wc(Mm),"<A> and 'use' router primitives can be only used inside a Route."),Ap=()=>wc(Tc)||cs().base,Ip=t=>{const e=Ap();return We(()=>e.resolvePath(t()))},Ep=t=>{const e=cs();return We(()=>{const r=t();return r!==void 0?e.renderPath(r):r})},$c=()=>cs().navigatorFactory(),xp=()=>cs().location,Tp=()=>cs().params;function $p(t,e=""){const{component:r,preload:n,load:i,children:o,info:a}=t,c=!o||Array.isArray(o)&&!o.length,d={key:t,component:r,preload:n||i,info:a};return Om(t.path).reduce((h,m)=>{for(const g of Lm(m)){const _=Sp(e,g);let A=c?_:_.split("/*",1)[0];A=A.split("/").map(M=>M.startsWith(":")||M.startsWith("*")?M:encodeURIComponent(M)).join("/"),h.push({...d,originalPath:m,pattern:A,matcher:Pp(A,!c,t.matchFilters)})}return h},[])}function kp(t,e=0){return{routes:t,score:wp(t[t.length-1])*1e4-e,matcher(r){const n=[];for(let i=t.length-1;i>=0;i--){const o=t[i],a=o.matcher(r);if(!a)return null;n.unshift({...a,route:o})}return n}}}function Om(t){return Array.isArray(t)?t:[t]}function Vm(t,e="",r=[],n=[]){const i=Om(t);for(let o=0,a=i.length;o<a;o++){const c=i[o];if(c&&typeof c=="object"){c.hasOwnProperty("path")||(c.path="");const d=$p(c,e);for(const h of d){r.push(h);const m=Array.isArray(c.children)&&c.children.length===0;if(c.children&&!m)Vm(c.children,h.pattern,r,n);else{const g=kp([...r],n.length);n.push(g)}r.pop()}}}return r.length?n:n.sort((o,a)=>a.score-o.score)}function dl(t,e){for(let r=0,n=t.length;r<n;r++){const i=t[r].matcher(e);if(i)return i}return[]}function Rp(t,e,r){const n=new URL(Rm),i=We(m=>{const g=t();try{return new URL(g,n)}catch{return console.error(`Invalid path ${g}`),m}},n,{equals:(m,g)=>m.href===g.href}),o=We(()=>i().pathname),a=We(()=>i().search,!0),c=We(()=>i().hash),d=()=>"",h=Pc(a,()=>Dm(i()));return{get pathname(){return o()},get search(){return a()},get hash(){return c()},get state(){return e()},get key(){return d()},query:r?r(h):Nm(h)}}let gi;function Dp(){return gi}function Np(t,e,r,n={}){const{signal:[i,o],utils:a={}}=t,c=a.parsePath||(oe=>oe),d=a.renderPath||(oe=>oe),h=a.beforeLeave||km(),m=Js("",n.base||"");if(m===void 0)throw new Error(`${m} is not a valid base path`);m&&!i().value&&o({value:m,replace:!0,scroll:!1});const[g,_]=ge(!1);let A;const M=(oe,K)=>{K.value===L()&&K.state===R()||(A===void 0&&_(!0),gi=oe,A=K,jg(()=>{A===K&&(k(A.value),W(A.state),ye[1](T=>T.filter(U=>U.pending)))}).finally(()=>{A===K&&wm(()=>{gi=void 0,oe==="navigate"&&E(A),_(!1),A=void 0})}))},[L,k]=ge(i().value),[R,W]=ge(i().state),ie=Rp(L,R,a.queryWrapper),te=[],ye=ge([]),ae=We(()=>typeof n.transformUrl=="function"?dl(e(),n.transformUrl(ie.pathname)):dl(e(),ie.pathname)),$=()=>{const oe=ae(),K={};for(let T=0;T<oe.length;T++)Object.assign(K,oe[T].params);return K},S=a.paramsWrapper?a.paramsWrapper($,e):Nm($),p={pattern:m,path:()=>m,outlet:()=>null,resolvePath(oe){return Js(m,oe)}};return re(Pc(i,oe=>M("native",oe),{defer:!0})),{base:p,location:ie,params:S,isRouting:g,renderPath:d,parsePath:c,navigatorFactory:P,matches:ae,beforeLeave:h,preloadRoute:y,singleFlight:n.singleFlight===void 0?!0:n.singleFlight,submissions:ye};function C(oe,K,T){Mr(()=>{if(typeof K=="number"){K&&(a.go?a.go(K):console.warn("Router integration does not support relative routing"));return}const U=!K||K[0]==="?",{replace:B,resolve:x,scroll:I,state:N}={replace:!1,resolve:!U,scroll:!0,...T},Z=x?oe.resolvePath(K):Js(U&&ie.pathname||"",K);if(Z===void 0)throw new Error(`Path '${K}' is not a routable path`);if(te.length>=Cp)throw new Error("Too many redirects");const j=L();(Z!==j||N!==R())&&(yp||h.confirm(Z,T)&&(te.push({value:j,replace:B,scroll:I,state:R()}),M("navigate",{value:Z,state:N})))})}function P(oe){return oe=oe||wc(Tc)||p,(K,T)=>C(oe,K,T)}function E(oe){const K=te[0];K&&(o({...oe,replace:K.replace,scroll:K.scroll}),te.length=0)}function y(oe,K){const T=dl(e(),oe.pathname),U=gi;gi="preload";for(let B in T){const{route:x,params:I}=T[B];x.component&&x.component.preload&&x.component.preload();const{preload:N}=x;K&&N&&Am(r(),()=>N({params:I,location:{pathname:oe.pathname,search:oe.search,hash:oe.hash,query:Dm(oe),state:null,key:""},intent:"preload"}))}gi=U}}function Lp(t,e,r,n){const{base:i,location:o,params:a}=t,{pattern:c,component:d,preload:h}=n().route,m=We(()=>n().path);d&&d.preload&&d.preload();const g=h?h({params:a,location:o,intent:gi||"initial"}):void 0;return{parent:e,pattern:c,path:m,outlet:()=>d?b(d,{params:a,location:o,data:g,get children(){return r()}}):r(),resolvePath(A){return Js(i.path(),A,m())}}}const Mp=t=>e=>{const{base:r}=e,n=Cc(()=>e.children),i=We(()=>Vm(n(),e.base||""));let o;const a=Np(t,i,()=>o,{base:r,singleFlight:e.singleFlight,transformUrl:e.transformUrl});return t.create&&t.create(a),b(Mm.Provider,{value:a,get children(){return b(Op,{routerState:a,get root(){return e.root},get preload(){return e.rootPreload||e.rootLoad},get children(){return[fe(()=>(o=Cm())&&null),b(Vp,{routerState:a,get branches(){return i()}})]}})}})};function Op(t){const e=t.routerState.location,r=t.routerState.params,n=We(()=>t.preload&&Mr(()=>{t.preload({params:r,location:e,intent:Dp()||"initial"})}));return b(Ne,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:i=>b(i,{params:r,location:e,get data(){return n()},get children(){return t.children}})})}function Vp(t){const e=[];let r;const n=We(Pc(t.routerState.matches,(i,o,a)=>{let c=o&&i.length===o.length;const d=[];for(let h=0,m=i.length;h<m;h++){const g=o&&o[h],_=i[h];a&&g&&_.route.key===g.route.key?d[h]=a[h]:(c=!1,e[h]&&e[h](),Uo(A=>{e[h]=A,d[h]=Lp(t.routerState,d[h-1]||t.routerState.base,ad(()=>n()[h+1]),()=>t.routerState.matches()[h])}))}return e.splice(i.length).forEach(h=>h()),a&&c?a:(r=d[0],d)}));return ad(()=>n()&&r)()}const ad=t=>()=>b(Ne,{get when(){return t()},keyed:!0,children:e=>b(Tc.Provider,{value:e,get children(){return e.outlet()}})}),Wr=t=>{const e=Cc(()=>t.children);return zl(t,{get children(){return e()}})};function Bp([t,e],r,n){return[t,n?i=>e(n(i)):e]}function Fp(t){let e=!1;const r=i=>typeof i=="string"?{value:i}:i,n=Bp(ge(r(t.get()),{equals:(i,o)=>i.value===o.value&&i.state===o.state}),void 0,i=>(!e&&t.set(i),i));return t.init&&co(t.init((i=t.get())=>{e=!0,n[1](r(i)),e=!1})),Mp({signal:n,create:t.create,utils:t.utils})}function Up(t,e,r){return t.addEventListener(e,r),()=>t.removeEventListener(e,r)}function jp(t,e){const r=t&&document.getElementById(t);r?r.scrollIntoView():e&&window.scrollTo(0,0)}const zp=new Map;function qp(t=!0,e=!1,r="/_server",n){return i=>{const o=i.base.path(),a=i.navigatorFactory(i.base);let c,d;function h(L){return L.namespaceURI==="http://www.w3.org/2000/svg"}function m(L){if(L.defaultPrevented||L.button!==0||L.metaKey||L.altKey||L.ctrlKey||L.shiftKey)return;const k=L.composedPath().find(ae=>ae instanceof Node&&ae.nodeName.toUpperCase()==="A");if(!k||e&&!k.hasAttribute("link"))return;const R=h(k),W=R?k.href.baseVal:k.href;if((R?k.target.baseVal:k.target)||!W&&!k.hasAttribute("state"))return;const te=(k.getAttribute("rel")||"").split(/\s+/);if(k.hasAttribute("download")||te&&te.includes("external"))return;const ye=R?new URL(W,document.baseURI):new URL(W);if(!(ye.origin!==window.location.origin||o&&ye.pathname&&!ye.pathname.toLowerCase().startsWith(o.toLowerCase())))return[k,ye]}function g(L){const k=m(L);if(!k)return;const[R,W]=k,ie=i.parsePath(W.pathname+W.search+W.hash),te=R.getAttribute("state");L.preventDefault(),a(ie,{resolve:!1,replace:R.hasAttribute("replace"),scroll:!R.hasAttribute("noscroll"),state:te?JSON.parse(te):void 0})}function _(L){const k=m(L);if(!k)return;const[R,W]=k;i.preloadRoute(W,R.getAttribute("preload")!=="false")}function A(L){clearTimeout(c);const k=m(L);if(!k)return d=null;const[R,W]=k;d!==R&&(c=setTimeout(()=>{i.preloadRoute(W,R.getAttribute("preload")!=="false"),d=R},20))}function M(L){if(L.defaultPrevented)return;let k=L.submitter&&L.submitter.hasAttribute("formaction")?L.submitter.getAttribute("formaction"):L.target.getAttribute("action");if(!k)return;if(!k.startsWith("https://action/")){const W=new URL(k,Rm);if(k=i.parsePath(W.pathname+W.search),!k.startsWith(r))return}if(L.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const R=zp.get(k);if(R){L.preventDefault();const W=new FormData(L.target,L.submitter);R.call({r:i,f:L.target},L.target.enctype==="multipart/form-data"?W:new URLSearchParams(W))}}At(["click","submit"]),document.addEventListener("click",g),t&&(document.addEventListener("mousemove",A,{passive:!0}),document.addEventListener("focusin",_,{passive:!0}),document.addEventListener("touchstart",_,{passive:!0})),document.addEventListener("submit",M),co(()=>{document.removeEventListener("click",g),t&&(document.removeEventListener("mousemove",A),document.removeEventListener("focusin",_),document.removeEventListener("touchstart",_)),document.removeEventListener("submit",M)})}}function Gp(t){const e=t.replace(/^.*?#/,"");if(!e.startsWith("/")){const[,r="/"]=window.location.hash.split("#",2);return`${r}#${e}`}return e}function Hp(t){const e=()=>window.location.hash.slice(1),r=km();return Fp({get:e,set({value:n,replace:i,scroll:o,state:a}){i?window.history.replaceState(gp(a),"","#"+n):window.history.pushState(a,"","#"+n);const c=n.indexOf("#"),d=c>=0?n.slice(c+1):"";jp(d,o),xc()},init:n=>Up(window,"hashchange",pp(n,i=>!r.confirm(i&&i<0?i:e()))),create:qp(t.preload,t.explicitLinks,t.actionBase),utils:{go:n=>window.history.go(n),renderPath:n=>`#${n}`,parsePath:Gp,beforeLeave:r}})(t)}var Yp=z("<a>");function qi(t){t=zl({inactiveClass:"inactive",activeClass:"active"},t);const[,e]=Jg(t,["href","state","class","activeClass","inactiveClass","end"]),r=Ip(()=>t.href),n=Ep(r),i=xp(),o=We(()=>{const a=r();if(a===void 0)return[!1,!1];const c=Si(a.split(/[?#]/,1)[0]).toLowerCase(),d=decodeURI(Si(i.pathname).toLowerCase());return[t.end?c===d:d.startsWith(c+"/")||d===c,c===d]});return(()=>{var a=Yp();return up(a,zl(e,{get href(){return n()||t.href},get state(){return JSON.stringify(t.state)},get classList(){return{...t.class&&{[t.class]:!0},[t.inactiveClass]:!o()[0],[t.activeClass]:o()[0],...e.classList}},link:"",get"aria-current"(){return o()[1]?"page":void 0}}),!1),a})()}const Hl=Symbol("store-raw"),Ki=Symbol("store-node"),Sn=Symbol("store-has"),Bm=Symbol("store-self");function Fm(t){let e=t[Jr];if(!e&&(Object.defineProperty(t,Jr,{value:e=new Proxy(t,Qp)}),!Array.isArray(t))){const r=Object.keys(t),n=Object.getOwnPropertyDescriptors(t);for(let i=0,o=r.length;i<o;i++){const a=r[i];n[a].get&&Object.defineProperty(t,a,{enumerable:n[a].enumerable,get:n[a].get.bind(e)})}}return e}function ma(t){let e;return t!=null&&typeof t=="object"&&(t[Jr]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function Qo(t,e=new Set){let r,n,i,o;if(r=t!=null&&t[Hl])return r;if(!ma(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let a=0,c=t.length;a<c;a++)i=t[a],(n=Qo(i,e))!==i&&(t[a]=n)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const a=Object.keys(t),c=Object.getOwnPropertyDescriptors(t);for(let d=0,h=a.length;d<h;d++)o=a[d],!c[o].get&&(i=t[o],(n=Qo(i,e))!==i&&(t[o]=n))}return t}function fa(t,e){let r=t[e];return r||Object.defineProperty(t,e,{value:r=Object.create(null)}),r}function Jo(t,e,r){if(t[e])return t[e];const[n,i]=ge(r,{equals:!1,internal:!0});return n.$=i,t[e]=n}function Wp(t,e){const r=Reflect.getOwnPropertyDescriptor(t,e);return!r||r.get||!r.configurable||e===Jr||e===Ki||(delete r.value,delete r.writable,r.get=()=>t[Jr][e]),r}function Um(t){Fl()&&Jo(fa(t,Ki),Bm)()}function Kp(t){return Um(t),Reflect.ownKeys(t)}const Qp={get(t,e,r){if(e===Hl)return t;if(e===Jr)return r;if(e===Bl)return Um(t),r;const n=fa(t,Ki),i=n[e];let o=i?i():t[e];if(e===Ki||e===Sn||e==="__proto__")return o;if(!i){const a=Object.getOwnPropertyDescriptor(t,e);Fl()&&(typeof o!="function"||t.hasOwnProperty(e))&&!(a&&a.get)&&(o=Jo(n,e,o)())}return ma(o)?Fm(o):o},has(t,e){return e===Hl||e===Jr||e===Bl||e===Ki||e===Sn||e==="__proto__"?!0:(Fl()&&Jo(fa(t,Sn),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:Kp,getOwnPropertyDescriptor:Wp};function ya(t,e,r,n=!1){if(!n&&t[e]===r)return;const i=t[e],o=t.length;r===void 0?(delete t[e],t[Sn]&&t[Sn][e]&&i!==void 0&&t[Sn][e].$()):(t[e]=r,t[Sn]&&t[Sn][e]&&i===void 0&&t[Sn][e].$());let a=fa(t,Ki),c;if((c=Jo(a,e,i))&&c.$(()=>r),Array.isArray(t)&&t.length!==o){for(let d=t.length;d<o;d++)(c=a[d])&&c.$();(c=Jo(a,"length",o))&&c.$(t.length)}(c=a[Bm])&&c.$()}function jm(t,e){const r=Object.keys(e);for(let n=0;n<r.length;n+=1){const i=r[n];ya(t,i,e[i])}}function Jp(t,e){if(typeof e=="function"&&(e=e(t)),e=Qo(e),Array.isArray(e)){if(t===e)return;let r=0,n=e.length;for(;r<n;r++){const i=e[r];t[r]!==i&&ya(t,r,i)}ya(t,"length",n)}else jm(t,e)}function No(t,e,r=[]){let n,i=t;if(e.length>1){n=e.shift();const a=typeof n,c=Array.isArray(t);if(Array.isArray(n)){for(let d=0;d<n.length;d++)No(t,[n[d]].concat(e),r);return}else if(c&&a==="function"){for(let d=0;d<t.length;d++)n(t[d],d)&&No(t,[d].concat(e),r);return}else if(c&&a==="object"){const{from:d=0,to:h=t.length-1,by:m=1}=n;for(let g=d;g<=h;g+=m)No(t,[g].concat(e),r);return}else if(e.length>1){No(t[n],e,[n].concat(r));return}i=t[n],r=[n].concat(r)}let o=e[0];typeof o=="function"&&(o=o(i,r),o===i)||n===void 0&&o==null||(o=Qo(o),n===void 0||ma(i)&&ma(o)&&!Array.isArray(o)?jm(i,o):ya(t,n,o))}function kc(...[t,e]){const r=Qo(t||{}),n=Array.isArray(r),i=Fm(r);function o(...a){wm(()=>{n&&a.length===1?Jp(r,a[0]):No(r,a)})}return[i,o]}const Rt=(t=300+Math.random()*700)=>new Promise(e=>setTimeout(e,t)),ui=(t="")=>`${t}${Date.now()}-${Math.random().toString(36).substr(2,9)}`;let ze={products:[{id:"prod-001",name:"Wireless Headphones",sku:"WH-001",productCode:"WH-001",productName:"Wireless Headphones",description:"High-quality wireless bluetooth headphones",category:"Electronics",unitOfMeasure:"pcs",unitCost:45,sellingPrice:89.99,minStockLevel:10,maxStockLevel:100,isActive:!0,createdDate:"2024-01-15T10:00:00Z",lastModified:"2024-01-15T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-002",name:"USB-C Cable",sku:"USB-001",description:"3ft USB-C charging cable",category:"Accessories",unitOfMeasure:"pcs",unitCost:8.5,sellingPrice:19.99,minStockLevel:25,maxStockLevel:200,isActive:!0,createdDate:"2024-01-16T10:00:00Z",lastModified:"2024-01-16T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-003",name:"Laptop Stand",sku:"LS-001",description:"Adjustable aluminum laptop stand",category:"Office",unitOfMeasure:"pcs",unitCost:25,sellingPrice:49.99,minStockLevel:5,maxStockLevel:50,isActive:!0,createdDate:"2024-01-17T10:00:00Z",lastModified:"2024-01-17T10:00:00Z",businessId:"YB100423253156428"}],locations:[{id:"loc-001",name:"Main Warehouse",code:"WH-001",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-002",name:"Retail Store - Downtown",code:"ST-001",type:"store",address:"456 Main St, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-003",name:"Retail Store - Mall",code:"ST-002",type:"store",address:"789 Mall Blvd, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"}],movements:[{id:"mov-001",productId:"prod-001",productName:"Wireless Headphones",productSku:"WH-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:50,unitCost:45,totalCost:2250,referenceNumber:"PO-001",notes:"Initial stock purchase",createdBy:"admin",createdDate:"2024-01-15T10:00:00Z",invoiceId:"INV-1000001"},{id:"mov-002",productId:"prod-002",productName:"USB-C Cable",productSku:"USB-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:100,unitCost:8.5,totalCost:850,referenceNumber:"PO-001",notes:"Bulk purchase",createdBy:"admin",createdDate:"2024-01-15T10:05:00Z",invoiceId:"INV-1000001"}],accounts:[{id:"acc-001",accountNumber:"1000",accountName:"Cash",accountType:"asset",category:"currentAssets",balance:5e4,parentAccountId:null,description:"Cash and cash equivalents",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"},{id:"acc-002",accountNumber:"1100",accountName:"Accounts Receivable",accountType:"asset",category:"currentAssets",balance:25e3,parentAccountId:null,description:"Money owed by customers",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"}],journalEntries:[{id:"je-001",entryNumber:"JE-001",date:"2024-01-15",description:"Initial cash deposit",reference:"DEP-001",status:"posted",createdBy:"admin",createdAt:"2024-01-15T10:00:00Z",postedAt:"2024-01-15T10:05:00Z",lines:[{id:"jel-001",accountId:"acc-001",accountName:"Cash",description:"Initial deposit",debitAmount:5e4,creditAmount:0},{id:"jel-002",accountId:"acc-003",accountName:"Owner Equity",description:"Initial capital",debitAmount:0,creditAmount:5e4}]}]};const er=(t=.05)=>Math.random()<t,tr=()=>{const t=["Network timeout","Connection refused","Server temporarily unavailable","Invalid request"];throw new Error(t[Math.floor(Math.random()*t.length)])},Nr={products:{async getAll(t,e){await Rt(),er()&&tr();let r=[...ze.products];if(t&&t.trim()){const n=t.toLowerCase();r=r.filter(i=>i.name.toLowerCase().includes(n)||i.sku.toLowerCase().includes(n)||i.category.toLowerCase().includes(n)||i.description.toLowerCase().includes(n))}return e?.category&&(r=r.filter(n=>n.category===e.category)),e?.isActive!==void 0&&(r=r.filter(n=>n.isActive===e.isActive)),r},async getById(t){return await Rt(),er()&&tr(),ze.products.find(e=>e.id===t)||null},async create(t){if(await Rt(),er()&&tr(),ze.products.some(r=>r.sku===t.sku))throw new Error("SKU already exists");const e={...t,id:ui("prod-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return ze.products.push(e),e},async update(t,e){await Rt(),er()&&tr();const r=ze.products.findIndex(i=>i.id===t);if(r===-1)throw new Error("Product not found");if(e.sku&&ze.products.some(i=>i.id!==t&&i.sku===e.sku))throw new Error("SKU already exists");const n={...ze.products[r],...e,lastModified:new Date().toISOString()};return ze.products[r]=n,n},async delete(t){await Rt(),er()&&tr();const e=ze.products.findIndex(n=>n.id===t);if(e===-1)throw new Error("Product not found");return ze.movements.some(n=>n.productId===t)?{success:!1,message:"Cannot delete product with existing movements"}:(ze.products.splice(e,1),{success:!0,message:"Product deleted successfully"})}},locations:{async getAll(t){await Rt(),er()&&tr();let e=[...ze.locations];return t?.type&&(e=e.filter(r=>r.type===t.type)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Rt(),ze.locations.find(e=>e.id===t)||null},async create(t){if(await Rt(),er()&&tr(),ze.locations.some(r=>r.code===t.code))throw new Error("Location code already exists");const e={...t,id:ui("loc-"),createdDate:new Date().toISOString()};return ze.locations.push(e),e},async update(t,e){await Rt(),er()&&tr();const r=ze.locations.findIndex(n=>n.id===t);if(r===-1)throw new Error("Location not found");if(e.code&&ze.locations.some(n=>n.id!==t&&n.code===e.code))throw new Error("Location code already exists");return ze.locations[r]={...ze.locations[r],...e},ze.locations[r]}},movements:{async getAll(t){await Rt(),er()&&tr();let e=[...ze.movements];if(t?.productId&&(e=e.filter(r=>r.productId===t.productId)),t?.locationId&&(e=e.filter(r=>r.locationId===t.locationId)),t?.movementType&&(e=e.filter(r=>r.movementType===t.movementType)),t?.dateFrom&&(e=e.filter(r=>r.createdDate>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.createdDate<=t.dateTo)),t?.search){const r=t.search.toLowerCase();e=e.filter(n=>n.productName.toLowerCase().includes(r)||n.productSku.toLowerCase().includes(r)||n.referenceNumber.toLowerCase().includes(r)||n.notes.toLowerCase().includes(r))}return e.sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime()),e},async getById(t){return await Rt(),ze.movements.find(e=>e.id===t)||null},async create(t){if(await Rt(),er()&&tr(),!ze.products.find(i=>i.id===t.productId))throw new Error("Product not found");if(!ze.locations.find(i=>i.id===t.locationId))throw new Error("Location not found");if(t.movementType==="out"){const i=await this.getStockLevel(t.productId,t.locationId);if(i<t.quantity)throw new Error(`Insufficient stock. Available: ${i}, Requested: ${t.quantity}`)}const n={...t,id:ui("mov-"),createdDate:new Date().toISOString()};return ze.movements.push(n),n},async update(t,e){await Rt(),er()&&tr();const r=ze.movements.findIndex(i=>i.id===t);if(r===-1)throw new Error("Movement not found");const n={...ze.movements[r],...e,lastModified:new Date().toISOString()};return ze.movements[r]=n,n},async delete(t){await Rt(),er()&&tr();const e=ze.movements.findIndex(r=>r.id===t);if(e===-1)throw new Error("Movement not found");return ze.movements.splice(e,1),{success:!0,message:"Movement deleted successfully"}},async createBulk(t){await Rt(),er()&&tr();const e=[],r=[],n=new Date().toISOString(),i=ze.locations.find(o=>o.id===t.locationId);if(!i)return{success:!1,movements:[],errors:["Invalid location"]};for(let o=0;o<t.items.length;o++){const a=t.items[o],c=ze.products.find(m=>m.id===a.productId);if(!c){e.push(`Item ${o+1}: Product not found`);continue}if(a.quantity<=0){e.push(`Item ${o+1}: Quantity must be greater than 0`);continue}if(t.movementType==="out"){const m=await this.getStockLevel(a.productId,t.locationId);if(a.quantity>m){e.push(`Item ${o+1}: Insufficient stock. Available: ${m}, Requested: ${a.quantity}`);continue}}const d=a.unitCost||c.unitCost,h={id:ui("mov-"),productId:c.id,productName:c.name,productSku:c.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:a.quantity,unitCost:d,totalCost:a.quantity*d,referenceNumber:t.referenceNumber,notes:a.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:t.fromLocationId?ze.locations.find(m=>m.id===t.fromLocationId)?.name:void 0};r.push(h)}return e.length>0?{success:!1,movements:[],errors:e}:(ze.movements.push(...r),{success:!0,movements:r,errors:[]})},async getStockLevel(t,e){return await Rt(50),ze.movements.filter(r=>r.productId===t&&r.locationId===e).reduce((r,n)=>{switch(n.movementType){case"in":case"adjustment":return r+n.quantity;case"out":return r-n.quantity;case"transfer":return n.locationId===e?r+n.quantity:r;default:return r}},0)},async getStockLevels(){await Rt();const t=new Map;for(const e of ze.movements){const r=`${e.productId}-${e.locationId}`;let n=t.get(r);switch(n||(n={id:r,productId:e.productId,locationId:e.locationId,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType){case"in":case"adjustment":n.quantity+=e.quantity;break;case"out":n.quantity-=e.quantity;break;case"transfer":e.locationId===e.locationId&&(n.quantity+=e.quantity);break}new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost,n.availableQuantity=n.quantity-n.reservedQuantity}return Array.from(t.values())}},accounts:{async getAll(t){await Rt(),er()&&tr();let e=[...ze.accounts];return t?.accountType&&(e=e.filter(r=>r.accountType===t.accountType)),t?.category&&(e=e.filter(r=>r.category===t.category)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Rt(),ze.accounts.find(e=>e.id===t)||null},async create(t){if(await Rt(),er()&&tr(),ze.accounts.some(r=>r.accountNumber===t.accountNumber))throw new Error("Account number already exists");const e={...t,id:ui("acc-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return ze.accounts.push(e),e},async update(t,e){await Rt(),er()&&tr();const r=ze.accounts.findIndex(n=>n.id===t);if(r===-1)throw new Error("Account not found");if(e.accountNumber&&ze.accounts.some(n=>n.id!==t&&n.accountNumber===e.accountNumber))throw new Error("Account number already exists");return ze.accounts[r]={...ze.accounts[r],...e,lastModified:new Date().toISOString()},ze.accounts[r]}},journal:{async getAll(t){await Rt(),er()&&tr();let e=[...ze.journalEntries];return t?.status&&(e=e.filter(r=>r.status===t.status)),t?.accountId&&(e=e.filter(r=>r.lines.some(n=>n.accountId===t.accountId))),t?.dateFrom&&(e=e.filter(r=>r.date>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.date<=t.dateTo)),e.sort((r,n)=>new Date(n.createdAt).getTime()-new Date(r.createdAt).getTime())},async getById(t){return await Rt(),ze.journalEntries.find(e=>e.id===t)||null},async create(t){await Rt(),er()&&tr();const e=t.lines.reduce((c,d)=>c+(d.debitAmount||0),0),r=t.lines.reduce((c,d)=>c+(d.creditAmount||0),0);if(Math.abs(e-r)>.01)throw new Error(`Entry is not balanced. Debit: ${e}, Credit: ${r}`);const n=ze.journalEntries.sort((c,d)=>d.entryNumber.localeCompare(c.entryNumber))[0],o=`JE-${((n?parseInt(n.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`,a={...t,id:ui("je-"),entryNumber:o,createdAt:new Date().toISOString(),lines:t.lines.map(c=>({...c,id:ui("jel-")}))};return ze.journalEntries.push(a),a},async update(t,e){await Rt(),er()&&tr();const r=ze.journalEntries.findIndex(n=>n.id===t);if(r===-1)throw new Error("Journal entry not found");if(ze.journalEntries[r].status==="posted")throw new Error("Cannot modify posted entries");return ze.journalEntries[r]={...ze.journalEntries[r],...e},ze.journalEntries[r]},async post(t){await Rt(),er()&&tr();const e=ze.journalEntries.findIndex(o=>o.id===t);if(e===-1)throw new Error("Journal entry not found");const r=ze.journalEntries[e];if(r.status==="posted")throw new Error("Entry is already posted");const n=r.lines.reduce((o,a)=>o+(a.debitAmount||0),0),i=r.lines.reduce((o,a)=>o+(a.creditAmount||0),0);if(Math.abs(n-i)>.01)throw new Error("Entry must be balanced before posting");return ze.journalEntries[e]={...r,status:"posted",postedAt:new Date().toISOString()},r.lines.forEach(o=>{const a=ze.accounts.findIndex(c=>c.id===o.accountId);if(a!==-1){const c=ze.accounts[a],d=o.debitAmount||0,h=o.creditAmount||0;["asset","expense"].includes(c.accountType)?c.balance+=d-h:c.balance+=h-d}}),ze.journalEntries[e]}},utils:{async getNextEntryNumber(){await Rt(100);const t=ze.journalEntries.sort((r,n)=>n.entryNumber.localeCompare(r.entryNumber))[0];return`JE-${((t?parseInt(t.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`},async getNextProductCode(t){await Rt(100);const e=t.toUpperCase().slice(0,3),r=ze.products.filter(i=>i.productCode?.startsWith(e)).sort((i,o)=>(o.productCode||"").localeCompare(i.productCode||""));if(r.length===0)return`${e}001`;const n=parseInt(r[0].productCode?.slice(-3)||"0");return`${e}${(n+1).toString().padStart(3,"0")}`},async healthCheck(){return await Rt(50),{status:"healthy",timestamp:new Date().toISOString(),version:"1.0.0"}},async resetDatabase(){return await Rt(200),ze={products:[...ze.products.slice(0,3)],locations:[...ze.locations.slice(0,3)],movements:[...ze.movements.slice(0,2)],accounts:[...ze.accounts.slice(0,2)],journalEntries:[...ze.journalEntries.slice(0,1)]},{success:!0,message:"Database reset to initial state"}},async getStats(){return await Rt(100),{products:ze.products.length,locations:ze.locations.length,movements:ze.movements.length,accounts:ze.accounts.length,journalEntries:ze.journalEntries.length,totalStockValue:ze.movements.reduce((t,e)=>e.movementType==="in"?t+e.totalCost:e.movementType==="out"?t-e.totalCost:t,0)}}}},Xs=(t=16)=>{const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},Xp=t=>typeof t=="string"&&t.trim().length>0,Pn=async t=>{const n=await fetch("https://qvamarkets.com/gql_api",{method:"POST",headers:{"Content-Type":"application/json","Accept-Encoding":"gzip, deflate, br",Authorization:"eyJhbGciOiJSUzI1NiIsImtpZCI6IjhlOGZjOGU1NTZmN2E3NmQwOGQzNTgyOWQ2ZjkwYWUyZTEyY2ZkMGQiLCJ0eXAiOiJKV1QifQ"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const i=await n.json();if(i.errors)throw new Error(i.errors[0]?.message||"GraphQL error");return i.data},Zp=t=>({ENTRY:"in",in:"in",TRANSFER:"transfer",transfer:"transfer",SALES:"out",out:"out",adjustment:"adjustment"})[t],Yl=t=>({ENTRY:"ENTRY",in:"ENTRY",TRANSFER:"TRANSFER",transfer:"TRANSFER",SALES:"SALES",out:"SALES",adjustment:"adjustment"})[t];function Wl(t){var e=[];return t&&Object.keys(t).map(r=>{e.push(t[r])}),e}function ev(t){if(!/^[a-z0-9+/]+={0,2}$/i.test(t)||t.length%4!=0)throw Error("Not base64 string");for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,n,i,o,a,c,d,h,m=[],g=0;g<t.length;g+=4)o=e.indexOf(t.charAt(g)),a=e.indexOf(t.charAt(g+1)),c=e.indexOf(t.charAt(g+2)),d=e.indexOf(t.charAt(g+3)),h=o<<18|a<<12|c<<6|d,r=h>>>16&255,n=h>>>8&255,i=h&255,m[g/4]=String.fromCharCode(r,n,i),d==64&&(m[g/4]=String.fromCharCode(r,n)),c==64&&(m[g/4]=String.fromCharCode(r));return t=m.join(""),t}const tv=async()=>({}),rv=()=>(typeof window<"u"&&localStorage.getItem("hrmfinance-api-mode"),"real");let pi=rv();const Xo={getMode(){return pi},setMode(t){pi=t,typeof window<"u"&&localStorage.setItem("hrmfinance-api-mode",t)},isFakeMode(){return pi==="fake"},isRealMode(){return pi==="real"},isHybridMode(){return pi==="hybrid"}},zr=async(t,e,r=!0)=>{if(pi==="fake")return e();if(pi==="real")return t();try{return await t()}catch(n){if(console.warn("Real API failed, falling back to fake server:",n),r)return e();throw n}},ld={async getAll(t,e){const r=await Pn({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:{businessId:"YB100423253156428",":search0":"produ"}});return Wl(r)},async getById(t){return zr(async()=>(await this.getAll()).find(r=>r.id===t)||null,()=>Nr.products.getById(t))},async create(t){return zr(async()=>{throw console.log("Creating product via real API:",t),new Error("Real API not implemented yet")},()=>Nr.products.create(t))},async update(t,e){return zr(async()=>{throw console.log("Updating product via real API:",t,e),new Error("Real API not implemented yet")},()=>Nr.products.update(t,e))},async delete(t){return zr(async()=>{throw console.log("Deleting product via real API:",t),new Error("Real API not implemented yet")},()=>Nr.products.delete(t))}},an={async getInventory(t,e){if(!(t&&t?.trim()))return[];let r={businessId:"YB100423253156428"};return t&&t.split(" ").map((o,a)=>{o&&(r[":search"+a]=o.trim())}),await Pn({query:"getScanYabaInventory",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async getProducts(t){if(!(t&&t?.trim()))return[];let e={businessId:"YB100423253156428"};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await Pn({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getInvoice(t,e){if(!(t&&t?.trim()))return[];let r={businessId:"YB100423253156428"};return t&&t.split(" ").map((o,a)=>{o&&(r[":search"+a]=o.trim())}),await Pn({query:"getScanYabaInventory",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async addInventory(t){let r={query:"addYabaInventory",params:{businessId:"YB100423253156428"},form:t};const n=await Pn(r);return console.log(r),console.log(n),n},async updInventory(t){return await tv()}},cd={async getAll(t){return zr(async()=>{throw console.log("Getting accounts via real API:",t),new Error("Real API not implemented yet")},()=>Nr.accounts.getAll(t))},async getById(t){return zr(async()=>{throw console.log("Getting account by ID via real API:",t),new Error("Real API not implemented yet")},()=>Nr.accounts.getById(t))},async create(t){return zr(async()=>{throw console.log("Creating account via real API:",t),new Error("Real API not implemented yet")},()=>Nr.accounts.create(t))},async update(t,e){return zr(async()=>{throw console.log("Updating account via real API:",t,e),new Error("Real API not implemented yet")},()=>Nr.accounts.update(t,e))}},ud={async getNextEntryNumber(){return zr(async()=>{throw console.log("Getting next entry number via real API"),new Error("Real API not implemented yet")},()=>Nr.utils.getNextEntryNumber())},async getNextProductCode(t){return zr(async()=>{throw console.log("Getting next product code via real API:",t),new Error("Real API not implemented yet")},()=>Nr.utils.getNextProductCode(t))},async healthCheck(){return zr(async()=>{const t=await fetch("/api/health");if(!t.ok)throw new Error("Health check failed");return t.json()},()=>Nr.utils.healthCheck())},async getStats(){return zr(async()=>{throw console.log("Getting stats via real API"),new Error("Real API not implemented yet")},()=>Nr.utils.getStats())}},nv=()=>{Xo.setMode("real"),console.log(" HRM Finance initialized in REAL API mode for production")};nv();const iv=()=>{};var dd={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zm=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},ov=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[r++];e[n++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[r++],a=t[r++],c=t[r++],d=((i&7)<<18|(o&63)<<12|(a&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(d>>10)),e[n++]=String.fromCharCode(56320+(d&1023))}else{const o=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},qm={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const o=t[i],a=i+1<t.length,c=a?t[i+1]:0,d=i+2<t.length,h=d?t[i+2]:0,m=o>>2,g=(o&3)<<4|c>>4;let _=(c&15)<<2|h>>6,A=h&63;d||(A=64,a||(_=64)),n.push(r[m],r[g],r[_],r[A])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(zm(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):ov(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const o=r[t.charAt(i++)],c=i<t.length?r[t.charAt(i)]:0;++i;const h=i<t.length?r[t.charAt(i)]:64;++i;const g=i<t.length?r[t.charAt(i)]:64;if(++i,o==null||c==null||h==null||g==null)throw new sv;const _=o<<2|c>>4;if(n.push(_),h!==64){const A=c<<4&240|h>>2;if(n.push(A),g!==64){const M=h<<6&192|g;n.push(M)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class sv extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const av=function(t){const e=zm(t);return qm.encodeByteArray(e,!0)},ga=function(t){return av(t).replace(/\./g,"")},Gm=function(t){try{return qm.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lv(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cv=()=>lv().__FIREBASE_DEFAULTS__,uv=()=>{if(typeof process>"u"||typeof dd>"u")return;const t=dd.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},dv=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Gm(t[1]);return e&&JSON.parse(e)},Va=()=>{try{return iv()||cv()||uv()||dv()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Hm=t=>Va()?.emulatorHosts?.[t],hv=t=>{const e=Hm(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Ym=()=>Va()?.config,Wm=t=>Va()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mv{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uo(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Km(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fv(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[ga(JSON.stringify(r)),ga(JSON.stringify(a)),""].join(".")}const jo={};function yv(){const t={prod:[],emulator:[]};for(const e of Object.keys(jo))jo[e]?t.emulator.push(e):t.prod.push(e);return t}function gv(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let hd=!1;function Qm(t,e){if(typeof window>"u"||typeof document>"u"||!uo(window.location.host)||jo[t]===e||jo[t]||hd)return;jo[t]=e;function r(_){return`__firebase__banner__${_}`}const n="__firebase__banner",o=yv().prod.length>0;function a(){const _=document.getElementById(n);_&&_.remove()}function c(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function d(_,A){_.setAttribute("width","24"),_.setAttribute("id",A),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function h(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{hd=!0,a()},_}function m(_,A){_.setAttribute("id",A),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function g(){const _=gv(n),A=r("text"),M=document.getElementById(A)||document.createElement("span"),L=r("learnmore"),k=document.getElementById(L)||document.createElement("a"),R=r("preprendIcon"),W=document.getElementById(R)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const ie=_.element;c(ie),m(k,L);const te=h();d(W,R),ie.append(W,M,k,te),document.body.appendChild(ie)}o?(M.innerText="Preview backend disconnected.",W.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(W.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,M.innerText="Preview backend running in this workspace."),M.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ir(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function pv(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ir())}function vv(){const t=Va()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function bv(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function _v(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Sv(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Pv(){const t=Ir();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function wv(){return!vv()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Cv(){try{return typeof indexedDB=="object"}catch{return!1}}function Av(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iv="FirebaseError";class Nn extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=Iv,Object.setPrototypeOf(this,Nn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,us.prototype.create)}}class us{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?Ev(o,n):"Error",c=`${this.serviceName}: ${a} (${i}).`;return new Nn(i,c,n)}}function Ev(t,e){return t.replace(xv,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const xv=/\{\$([^}]+)}/g;function Tv(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function wi(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const o=t[i],a=e[i];if(md(o)&&md(a)){if(!wi(o,a))return!1}else if(o!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function md(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ds(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function $v(t,e){const r=new kv(t,e);return r.subscribe.bind(r)}class kv{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");Rv(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=hl),i.error===void 0&&(i.error=hl),i.complete===void 0&&(i.complete=hl);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Rv(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function hl(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fr(t){return t&&t._delegate?t._delegate:t}class Ci{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new mv;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Lv(e))try{this.getOrInitializeService({instanceIdentifier:yi})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=yi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=yi){return this.instances.has(e)}getOptions(e=yi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,a]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(o);n===c&&a.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const o=this.instances.get(n);return o&&e(o,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Nv(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=yi){return this.component?this.component.multipleInstances?e:yi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Nv(t){return t===yi?void 0:t}function Lv(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mv{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new Dv(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Pt||(Pt={}));const Ov={debug:Pt.DEBUG,verbose:Pt.VERBOSE,info:Pt.INFO,warn:Pt.WARN,error:Pt.ERROR,silent:Pt.SILENT},Vv=Pt.INFO,Bv={[Pt.DEBUG]:"log",[Pt.VERBOSE]:"log",[Pt.INFO]:"info",[Pt.WARN]:"warn",[Pt.ERROR]:"error"},Fv=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=Bv[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Rc{constructor(e){this.name=e,this._logLevel=Vv,this._logHandler=Fv,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Pt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Ov[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Pt.DEBUG,...e),this._logHandler(this,Pt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Pt.VERBOSE,...e),this._logHandler(this,Pt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Pt.INFO,...e),this._logHandler(this,Pt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Pt.WARN,...e),this._logHandler(this,Pt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Pt.ERROR,...e),this._logHandler(this,Pt.ERROR,...e)}}const Uv=(t,e)=>e.some(r=>t instanceof r);let fd,yd;function jv(){return fd||(fd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function zv(){return yd||(yd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Jm=new WeakMap,Kl=new WeakMap,Xm=new WeakMap,ml=new WeakMap,Dc=new WeakMap;function qv(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",a)},o=()=>{r(Hn(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&Jm.set(r,t)}).catch(()=>{}),Dc.set(e,t),e}function Gv(t){if(Kl.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",a),t.removeEventListener("abort",a)},o=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",a),t.addEventListener("abort",a)});Kl.set(t,e)}let Ql={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Kl.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Xm.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Hn(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Hv(t){Ql=t(Ql)}function Yv(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(fl(this),e,...r);return Xm.set(n,e.sort?e.sort():[e]),Hn(n)}:zv().includes(t)?function(...e){return t.apply(fl(this),e),Hn(Jm.get(this))}:function(...e){return Hn(t.apply(fl(this),e))}}function Wv(t){return typeof t=="function"?Yv(t):(t instanceof IDBTransaction&&Gv(t),Uv(t,jv())?new Proxy(t,Ql):t)}function Hn(t){if(t instanceof IDBRequest)return qv(t);if(ml.has(t))return ml.get(t);const e=Wv(t);return e!==t&&(ml.set(t,e),Dc.set(e,t)),e}const fl=t=>Dc.get(t);function Kv(t,e,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const a=indexedDB.open(t,e),c=Hn(a);return n&&a.addEventListener("upgradeneeded",d=>{n(Hn(a.result),d.oldVersion,d.newVersion,Hn(a.transaction),d)}),r&&a.addEventListener("blocked",d=>r(d.oldVersion,d.newVersion,d)),c.then(d=>{o&&d.addEventListener("close",()=>o()),i&&d.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const Qv=["get","getKey","getAll","getAllKeys","count"],Jv=["put","add","delete","clear"],yl=new Map;function gd(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(yl.get(e))return yl.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=Jv.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||Qv.includes(r)))return;const o=async function(a,...c){const d=this.transaction(a,i?"readwrite":"readonly");let h=d.store;return n&&(h=h.index(c.shift())),(await Promise.all([h[r](...c),i&&d.done]))[0]};return yl.set(e,o),o}Hv(t=>({...t,get:(e,r,n)=>gd(e,r)||t.get(e,r,n),has:(e,r)=>!!gd(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xv{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(Zv(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function Zv(t){return t.getComponent()?.type==="VERSION"}const Jl="@firebase/app",pd="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xn=new Rc("@firebase/app"),eb="@firebase/app-compat",tb="@firebase/analytics-compat",rb="@firebase/analytics",nb="@firebase/app-check-compat",ib="@firebase/app-check",ob="@firebase/auth",sb="@firebase/auth-compat",ab="@firebase/database",lb="@firebase/data-connect",cb="@firebase/database-compat",ub="@firebase/functions",db="@firebase/functions-compat",hb="@firebase/installations",mb="@firebase/installations-compat",fb="@firebase/messaging",yb="@firebase/messaging-compat",gb="@firebase/performance",pb="@firebase/performance-compat",vb="@firebase/remote-config",bb="@firebase/remote-config-compat",_b="@firebase/storage",Sb="@firebase/storage-compat",Pb="@firebase/firestore",wb="@firebase/ai",Cb="@firebase/firestore-compat",Ab="firebase",Ib="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xl="[DEFAULT]",Eb={[Jl]:"fire-core",[eb]:"fire-core-compat",[rb]:"fire-analytics",[tb]:"fire-analytics-compat",[ib]:"fire-app-check",[nb]:"fire-app-check-compat",[ob]:"fire-auth",[sb]:"fire-auth-compat",[ab]:"fire-rtdb",[lb]:"fire-data-connect",[cb]:"fire-rtdb-compat",[ub]:"fire-fn",[db]:"fire-fn-compat",[hb]:"fire-iid",[mb]:"fire-iid-compat",[fb]:"fire-fcm",[yb]:"fire-fcm-compat",[gb]:"fire-perf",[pb]:"fire-perf-compat",[vb]:"fire-rc",[bb]:"fire-rc-compat",[_b]:"fire-gcs",[Sb]:"fire-gcs-compat",[Pb]:"fire-fst",[Cb]:"fire-fst-compat",[wb]:"fire-vertex","fire-js":"fire-js",[Ab]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pa=new Map,xb=new Map,Zl=new Map;function vd(t,e){try{t.container.addComponent(e)}catch(r){xn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function to(t){const e=t.name;if(Zl.has(e))return xn.debug(`There were multiple attempts to register component ${e}.`),!1;Zl.set(e,t);for(const r of pa.values())vd(r,t);for(const r of xb.values())vd(r,t);return!0}function Nc(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Ur(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tb={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Yn=new us("app","Firebase",Tb);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ci("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Yn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ho=Ib;function Zm(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Xl,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw Yn.create("bad-app-name",{appName:String(i)});if(r||(r=Ym()),!r)throw Yn.create("no-options");const o=pa.get(i);if(o){if(wi(r,o.options)&&wi(n,o.config))return o;throw Yn.create("duplicate-app",{appName:i})}const a=new Mv(i);for(const d of Zl.values())a.addComponent(d);const c=new $b(r,n,a);return pa.set(i,c),c}function ef(t=Xl){const e=pa.get(t);if(!e&&t===Xl&&Ym())return Zm();if(!e)throw Yn.create("no-app",{appName:t});return e}function Wn(t,e,r){let n=Eb[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${n}" with version "${e}":`];i&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),xn.warn(a.join(" "));return}to(new Ci(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kb="firebase-heartbeat-database",Rb=1,Zo="firebase-heartbeat-store";let gl=null;function tf(){return gl||(gl=Kv(kb,Rb,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Zo)}catch(r){console.warn(r)}}}}).catch(t=>{throw Yn.create("idb-open",{originalErrorMessage:t.message})})),gl}async function Db(t){try{const r=(await tf()).transaction(Zo),n=await r.objectStore(Zo).get(rf(t));return await r.done,n}catch(e){if(e instanceof Nn)xn.warn(e.message);else{const r=Yn.create("idb-get",{originalErrorMessage:e?.message});xn.warn(r.message)}}}async function bd(t,e){try{const n=(await tf()).transaction(Zo,"readwrite");await n.objectStore(Zo).put(e,rf(t)),await n.done}catch(r){if(r instanceof Nn)xn.warn(r.message);else{const n=Yn.create("idb-set",{originalErrorMessage:r?.message});xn.warn(n.message)}}}function rf(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nb=1024,Lb=30;class Mb{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Vb(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=_d();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>Lb){const i=Bb(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){xn.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=_d(),{heartbeatsToSend:r,unsentEntries:n}=Ob(this._heartbeatsCache.heartbeats),i=ga(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return xn.warn(e),""}}}function _d(){return new Date().toISOString().substring(0,10)}function Ob(t,e=Nb){const r=[];let n=t.slice();for(const i of t){const o=r.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),Sd(r)>e){o.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Sd(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class Vb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Cv()?Av().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Db(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return bd(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return bd(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Sd(t){return ga(JSON.stringify({version:2,heartbeats:t})).length}function Bb(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fb(t){to(new Ci("platform-logger",e=>new Xv(e),"PRIVATE")),to(new Ci("heartbeat",e=>new Mb(e),"PRIVATE")),Wn(Jl,pd,t),Wn(Jl,pd,"esm2020"),Wn("fire-js","")}Fb("");function nf(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Ub=nf,of=new us("auth","Firebase",nf());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const va=new Rc("@firebase/auth");function jb(t,...e){va.logLevel<=Pt.WARN&&va.warn(`Auth (${ho}): ${t}`,...e)}function Zs(t,...e){va.logLevel<=Pt.ERROR&&va.error(`Auth (${ho}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fn(t,...e){throw Mc(t,...e)}function Qr(t,...e){return Mc(t,...e)}function Lc(t,e,r){const n={...Ub(),[e]:r};return new us("auth","Firebase",n).create(e,{appName:t.name})}function Kn(t){return Lc(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function sf(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&fn(t,"argument-error"),Lc(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Mc(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return of.create(t,...e)}function at(t,e,...r){if(!t)throw Mc(e,...r)}function wn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Zs(e),new Error(e)}function Tn(t,e){t||wn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ec(){return typeof self<"u"&&self.location?.href||""}function zb(){return Pd()==="http:"||Pd()==="https:"}function Pd(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qb(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(zb()||_v()||"connection"in navigator)?navigator.onLine:!0}function Gb(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(e,r){this.shortDelay=e,this.longDelay=r,Tn(r>e,"Short delay should be less than long delay!"),this.isMobile=pv()||Sv()}get(){return qb()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oc(t,e){Tn(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;wn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;wn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;wn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hb={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yb=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Wb=new hs(3e4,6e4);function Vc(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function mo(t,e,r,n,i={}){return lf(t,i,async()=>{let o={},a={};n&&(e==="GET"?a=n:o={body:JSON.stringify(n)});const c=ds({key:t.config.apiKey,...a}).slice(1),d=await t._getAdditionalHeaders();d["Content-Type"]="application/json",t.languageCode&&(d["X-Firebase-Locale"]=t.languageCode);const h={method:e,headers:d,...o};return bv()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&uo(t.emulatorConfig.host)&&(h.credentials="include"),af.fetch()(await cf(t,t.config.apiHost,r,c),h)})}async function lf(t,e,r){t._canInitEmulator=!1;const n={...Hb,...e};try{const i=new Qb(t),o=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw Ns(t,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const c=o.ok?a.errorMessage:a.error.message,[d,h]=c.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ns(t,"credential-already-in-use",a);if(d==="EMAIL_EXISTS")throw Ns(t,"email-already-in-use",a);if(d==="USER_DISABLED")throw Ns(t,"user-disabled",a);const m=n[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Lc(t,m,h);fn(t,m)}}catch(i){if(i instanceof Nn)throw i;fn(t,"network-request-failed",{message:String(i)})}}async function Kb(t,e,r,n,i={}){const o=await mo(t,e,r,n,i);return"mfaPendingCredential"in o&&fn(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function cf(t,e,r,n){const i=`${e}${r}?${n}`,o=t,a=o.config.emulator?Oc(t.config,i):`${t.config.apiScheme}://${i}`;return Yb.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(a).toString():a}class Qb{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Qr(this.auth,"network-request-failed")),Wb.get())})}}function Ns(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Qr(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jb(t,e){return mo(t,"POST","/v1/accounts:delete",e)}async function ba(t,e){return mo(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zo(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Xb(t,e=!1){const r=fr(t),n=await r.getIdToken(e),i=Bc(n);at(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:n,authTime:zo(pl(i.auth_time)),issuedAtTime:zo(pl(i.iat)),expirationTime:zo(pl(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}}function pl(t){return Number(t)*1e3}function Bc(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Zs("JWT malformed, contained fewer than 3 sections"),null;try{const i=Gm(r);return i?JSON.parse(i):(Zs("Failed to decode base64 JWT payload"),null)}catch(i){return Zs("Caught error parsing JWT payload as JSON",i?.toString()),null}}function wd(t){const e=Bc(t);return at(e,"internal-error"),at(typeof e.exp<"u","internal-error"),at(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function es(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Nn&&Zb(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function Zb({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e0{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=zo(this.lastLoginAt),this.creationTime=zo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _a(t){const e=t.auth,r=await t.getIdToken(),n=await es(t,ba(e,{idToken:r}));at(n?.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const o=i.providerUserInfo?.length?uf(i.providerUserInfo):[],a=r0(t.providerData,o),c=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!a?.length,h=c?d:!1,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new tc(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(t,m)}async function t0(t){const e=fr(t);await _a(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function r0(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function uf(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n0(t,e){const r=await lf(t,{},async()=>{const n=ds({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,a=await cf(t,i,"/v1/token",`key=${o}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const d={method:"POST",headers:c,body:n};return t.emulatorConfig&&uo(t.emulatorConfig.host)&&(d.credentials="include"),af.fetch()(a,d)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function i0(t,e){return mo(t,"POST","/v2/accounts:revokeToken",Vc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){at(e.idToken,"internal-error"),at(typeof e.idToken<"u","internal-error"),at(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):wd(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){at(e.length!==0,"internal-error");const r=wd(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(at(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:o}=await n0(e,r);this.updateTokensAndExpiration(n,i,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:o}=r,a=new Qi;return n&&(at(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(at(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(at(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Qi,this.toJSON())}_performRefresh(){return wn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vn(t,e){at(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Kr{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new e0(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new tc(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await es(this,this.stsTokenManager.getToken(this.auth,e));return at(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return Xb(this,e)}reload(){return t0(this)}_assign(e){this!==e&&(at(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Kr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){at(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await _a(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ur(this.auth.app))return Promise.reject(Kn(this.auth));const e=await this.getIdToken();return await es(this,Jb(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,o=r.phoneNumber??void 0,a=r.photoURL??void 0,c=r.tenantId??void 0,d=r._redirectEventId??void 0,h=r.createdAt??void 0,m=r.lastLoginAt??void 0,{uid:g,emailVerified:_,isAnonymous:A,providerData:M,stsTokenManager:L}=r;at(g&&L,e,"internal-error");const k=Qi.fromJSON(this.name,L);at(typeof g=="string",e,"internal-error"),Vn(n,e.name),Vn(i,e.name),at(typeof _=="boolean",e,"internal-error"),at(typeof A=="boolean",e,"internal-error"),Vn(o,e.name),Vn(a,e.name),Vn(c,e.name),Vn(d,e.name),Vn(h,e.name),Vn(m,e.name);const R=new Kr({uid:g,auth:e,email:i,emailVerified:_,displayName:n,isAnonymous:A,photoURL:a,phoneNumber:o,tenantId:c,stsTokenManager:k,createdAt:h,lastLoginAt:m});return M&&Array.isArray(M)&&(R.providerData=M.map(W=>({...W}))),d&&(R._redirectEventId=d),R}static async _fromIdTokenResponse(e,r,n=!1){const i=new Qi;i.updateFromServerResponse(r);const o=new Kr({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await _a(o),o}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];at(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?uf(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!o?.length,c=new Qi;c.updateFromIdToken(n);const d=new Kr({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:a}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new tc(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(d,h),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cd=new Map;function Cn(t){Tn(t instanceof Function,"Expected a class definition");let e=Cd.get(t);return e?(Tn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Cd.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}df.type="NONE";const Ad=df;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ea(t,e,r){return`firebase:${t}:${e}:${r}`}class Ji{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:o}=this.auth;this.fullUserKey=ea(this.userKey,i.apiKey,o),this.fullPersistenceKey=ea("persistence",i.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await ba(this.auth,{idToken:e}).catch(()=>{});return r?Kr._fromGetAccountInfoResponse(this.auth,r,e):null}return Kr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Ji(Cn(Ad),e,n);const i=(await Promise.all(r.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let o=i[0]||Cn(Ad);const a=ea(n,e.config.apiKey,e.name);let c=null;for(const h of r)try{const m=await h._get(a);if(m){let g;if(typeof m=="string"){const _=await ba(e,{idToken:m}).catch(()=>{});if(!_)break;g=await Kr._fromGetAccountInfoResponse(e,_,m)}else g=Kr._fromJSON(e,m);h!==o&&(c=g),o=h;break}}catch{}const d=i.filter(h=>h._shouldAllowMigration);return!o._shouldAllowMigration||!d.length?new Ji(o,e,n):(o=d[0],c&&await o._set(a,c.toJSON()),await Promise.all(r.map(async h=>{if(h!==o)try{await h._remove(a)}catch{}})),new Ji(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Id(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(yf(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(hf(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(pf(e))return"Blackberry";if(vf(e))return"Webos";if(mf(e))return"Safari";if((e.includes("chrome/")||ff(e))&&!e.includes("edge/"))return"Chrome";if(gf(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function hf(t=Ir()){return/firefox\//i.test(t)}function mf(t=Ir()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ff(t=Ir()){return/crios\//i.test(t)}function yf(t=Ir()){return/iemobile/i.test(t)}function gf(t=Ir()){return/android/i.test(t)}function pf(t=Ir()){return/blackberry/i.test(t)}function vf(t=Ir()){return/webos/i.test(t)}function Fc(t=Ir()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function o0(t=Ir()){return Fc(t)&&!!window.navigator?.standalone}function s0(){return Pv()&&document.documentMode===10}function bf(t=Ir()){return Fc(t)||gf(t)||vf(t)||pf(t)||/windows phone/i.test(t)||yf(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _f(t,e=[]){let r;switch(t){case"Browser":r=Id(Ir());break;case"Worker":r=`${Id(Ir())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${ho}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a0{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((a,c)=>{try{const d=e(o);a(d)}catch(d){c(d)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l0(t,e={}){return mo(t,"GET","/v2/passwordPolicy",Vc(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c0=6;class u0{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??c0,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d0{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ed(this),this.idTokenSubscription=new Ed(this),this.beforeStateQueue=new a0(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=of,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Cn(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ji.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await ba(this,{idToken:e}),n=await Kr._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ur(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,a=n?._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(n=c.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return at(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await _a(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Gb()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ur(this.app))return Promise.reject(Kn(this));const r=e?fr(e):null;return r&&at(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&at(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ur(this.app)?Promise.reject(Kn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ur(this.app)?Promise.reject(Kn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Cn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await l0(this),r=new u0(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new us("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await i0(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Cn(e)||this._popupRedirectResolver;at(r,this,"argument-error"),this.redirectPersistenceManager=await Ji.create(this,[Cn(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let a=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(at(c,this,"internal-error"),c.then(()=>{a||o(this.currentUser)}),typeof r=="function"){const d=e.addObserver(r,n,i);return()=>{a=!0,d()}}else{const d=e.addObserver(r);return()=>{a=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return at(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_f(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(Ur(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&jb(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Ti(t){return fr(t)}class Ed{constructor(e){this.auth=e,this.observer=null,this.addObserver=$v(r=>this.observer=r)}get next(){return at(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function h0(t){Uc=t}function m0(t){return Uc.loadJS(t)}function f0(){return Uc.gapiScript}function y0(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g0(t,e){const r=Nc(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),o=r.getOptions();if(wi(o,e??{}))return i;fn(i,"already-initialized")}return r.initialize({options:e})}function p0(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(Cn);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function v0(t,e,r){const n=Ti(t);at(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,o=Sf(e),{host:a,port:c}=b0(e),d=c===null?"":`:${c}`,h={url:`${o}//${a}${d}/`},m=Object.freeze({host:a,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){at(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),at(wi(h,n.config.emulator)&&wi(m,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=m,n.settings.appVerificationDisabledForTesting=!0,uo(a)?(Km(`${o}//${a}${d}`),Qm("Auth",!0)):_0()}function Sf(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function b0(t){const e=Sf(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const o=i[1];return{host:o,port:xd(n.substr(o.length+1))}}else{const[o,a]=n.split(":");return{host:o,port:xd(a)}}}function xd(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function _0(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pf{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return wn("not implemented")}_getIdTokenResponse(e){return wn("not implemented")}_linkToIdToken(e,r){return wn("not implemented")}_getReauthenticationResolver(e){return wn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xi(t,e){return Kb(t,"POST","/v1/accounts:signInWithIdp",Vc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S0="http://localhost";class Ai extends Pf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Ai(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):fn("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...o}=r;if(!n||!i)return null;const a=new Ai(n,i);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return Xi(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Xi(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Xi(e,r)}buildRequest(){const e={requestUri:S0,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=ds(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms extends Ba{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn extends ms{constructor(){super("facebook.com")}static credential(e){return Ai._fromParams({providerId:jn.PROVIDER_ID,signInMethod:jn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return jn.credentialFromTaggedObject(e)}static credentialFromError(e){return jn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return jn.credential(e.oauthAccessToken)}catch{return null}}}jn.FACEBOOK_SIGN_IN_METHOD="facebook.com";jn.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn extends ms{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Ai._fromParams({providerId:sn.PROVIDER_ID,signInMethod:sn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return sn.credentialFromTaggedObject(e)}static credentialFromError(e){return sn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return sn.credential(r,n)}catch{return null}}}sn.GOOGLE_SIGN_IN_METHOD="google.com";sn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn extends ms{constructor(){super("github.com")}static credential(e){return Ai._fromParams({providerId:zn.PROVIDER_ID,signInMethod:zn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zn.credentialFromTaggedObject(e)}static credentialFromError(e){return zn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zn.credential(e.oauthAccessToken)}catch{return null}}}zn.GITHUB_SIGN_IN_METHOD="github.com";zn.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn extends ms{constructor(){super("twitter.com")}static credential(e,r){return Ai._fromParams({providerId:qn.PROVIDER_ID,signInMethod:qn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return qn.credentialFromTaggedObject(e)}static credentialFromError(e){return qn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return qn.credential(r,n)}catch{return null}}}qn.TWITTER_SIGN_IN_METHOD="twitter.com";qn.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const o=await Kr._fromIdTokenResponse(e,n,i),a=Td(n);return new ro({user:o,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=Td(n);return new ro({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function Td(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa extends Nn{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Sa.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new Sa(e,r,n,i)}}function wf(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Sa._fromErrorAndOperation(t,o,e,n):o})}async function P0(t,e,r=!1){const n=await es(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return ro._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w0(t,e,r=!1){const{auth:n}=t;if(Ur(n.app))return Promise.reject(Kn(n));const i="reauthenticate";try{const o=await es(t,wf(n,i,e,t),r);at(o.idToken,n,"internal-error");const a=Bc(o.idToken);at(a,n,"internal-error");const{sub:c}=a;return at(t.uid===c,n,"user-mismatch"),ro._forOperation(t,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&fn(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cf(t,e,r=!1){if(Ur(t.app))return Promise.reject(Kn(t));const n="signIn",i=await wf(t,n,e),o=await ro._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(o.user),o}async function C0(t,e){return Cf(Ti(t),e)}function A0(t,e,r,n){return fr(t).onIdTokenChanged(e,r,n)}function I0(t,e,r){return fr(t).beforeAuthStateChanged(e,r)}function E0(t,e,r,n){return fr(t).onAuthStateChanged(e,r,n)}function x0(t){return fr(t).signOut()}const Pa="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Pa,"1"),this.storage.removeItem(Pa),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T0=1e3,$0=10;class If extends Af{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=bf(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,c,d)=>{this.notifyListeners(a,d)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},o=this.storage.getItem(n);s0()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,$0):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},T0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}If.type="LOCAL";const k0=If;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef extends Af{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}Ef.type="SESSION";const xf=Ef;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R0(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new Fa(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:o}=r.data,a=this.handlersMap[i];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const c=Array.from(a).map(async h=>h(r.origin,o)),d=await R0(c);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:d})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Fa.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jc(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,a;return new Promise((c,d)=>{const h=jc("",20);i.port1.start();const m=setTimeout(()=>{d(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(g){const _=g;if(_.data.eventId===h)switch(_.data.status){case"ack":clearTimeout(m),o=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),c(_.data.response);break;default:clearTimeout(m),clearTimeout(o),d(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ln(){return window}function N0(t){ln().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tf(){return typeof ln().WorkerGlobalScope<"u"&&typeof ln().importScripts=="function"}async function L0(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function M0(){return navigator?.serviceWorker?.controller||null}function O0(){return Tf()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $f="firebaseLocalStorageDb",V0=1,wa="firebaseLocalStorage",kf="fbase_key";class fs{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Ua(t,e){return t.transaction([wa],e?"readwrite":"readonly").objectStore(wa)}function B0(){const t=indexedDB.deleteDatabase($f);return new fs(t).toPromise()}function rc(){const t=indexedDB.open($f,V0);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(wa,{keyPath:kf})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(wa)?e(n):(n.close(),await B0(),e(await rc()))})})}async function $d(t,e,r){const n=Ua(t,!0).put({[kf]:e,value:r});return new fs(n).toPromise()}async function F0(t,e){const r=Ua(t,!1).get(e),n=await new fs(r).toPromise();return n===void 0?null:n.value}function kd(t,e){const r=Ua(t,!0).delete(e);return new fs(r).toPromise()}const U0=800,j0=3;class Rf{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await rc(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>j0)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Tf()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Fa._getInstance(O0()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await L0(),!this.activeServiceWorker)return;this.sender=new D0(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||M0()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await rc();return await $d(e,Pa,"1"),await kd(e,Pa),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>$d(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>F0(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>kd(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=Ua(i,!1).getAll();return new fs(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),U0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Rf.type="LOCAL";const z0=Rf;new hs(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zc(t,e){return e?Cn(e):(at(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc extends Pf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Xi(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Xi(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Xi(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function q0(t){return Cf(t.auth,new qc(t),t.bypassAuthState)}function G0(t){const{auth:e,user:r}=t;return at(r,e,"internal-error"),w0(r,new qc(t),t.bypassAuthState)}async function H0(t){const{auth:e,user:r}=t;return at(r,e,"internal-error"),P0(r,new qc(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df{constructor(e,r,n,i,o=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:o,error:a,type:c}=e;if(a){this.reject(a);return}const d={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(d))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return q0;case"linkViaPopup":case"linkViaRedirect":return H0;case"reauthViaPopup":case"reauthViaRedirect":return G0;default:fn(this.auth,"internal-error")}}resolve(e){Tn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Tn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y0=new hs(2e3,1e4);async function W0(t,e,r){if(Ur(t.app))return Promise.reject(Qr(t,"operation-not-supported-in-this-environment"));const n=Ti(t);sf(t,e,Ba);const i=zc(n,r);return new bi(n,"signInViaPopup",e,i).executeNotNull()}class bi extends Df{constructor(e,r,n,i,o){super(e,r,i,o),this.provider=n,this.authWindow=null,this.pollId=null,bi.currentPopupAction&&bi.currentPopupAction.cancel(),bi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return at(e,this.auth,"internal-error"),e}async onExecution(){Tn(this.filter.length===1,"Popup operations only handle one event");const e=jc();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Qr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Qr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,bi.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Qr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Y0.get())};e()}}bi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K0="pendingRedirect",ta=new Map;class Q0 extends Df{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=ta.get(this.auth._key());if(!e){try{const n=await J0(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}ta.set(this.auth._key(),e)}return this.bypassAuthState||ta.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function J0(t,e){const r=Lf(e),n=Nf(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}async function X0(t,e){return Nf(t)._set(Lf(e),"true")}function Z0(t,e){ta.set(t._key(),e)}function Nf(t){return Cn(t._redirectPersistence)}function Lf(t){return ea(K0,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e_(t,e,r){return t_(t,e,r)}async function t_(t,e,r){if(Ur(t.app))return Promise.reject(Kn(t));const n=Ti(t);sf(t,e,Ba),await n._initializationPromise;const i=zc(n,r);return await X0(i,n),i._openRedirect(n,e,"signInViaRedirect")}async function r_(t,e){return await Ti(t)._initializationPromise,Mf(t,e,!1)}async function Mf(t,e,r=!1){if(Ur(t.app))return Promise.reject(Kn(t));const n=Ti(t),i=zc(n,e),a=await new Q0(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n_=10*60*1e3;class i_{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!o_(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!Of(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Qr(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=n_&&this.cachedEventUids.clear(),this.cachedEventUids.has(Rd(e))}saveEventToCache(e){this.cachedEventUids.add(Rd(e)),this.lastProcessedEventTime=Date.now()}}function Rd(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Of({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function o_(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Of(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s_(t,e={}){return mo(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a_=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,l_=/^https?/;async function c_(t){if(t.config.emulator)return;const{authorizedDomains:e}=await s_(t);for(const r of e)try{if(u_(r))return}catch{}fn(t,"unauthorized-domain")}function u_(t){const e=ec(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!l_.test(r))return!1;if(a_.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d_=new hs(3e4,6e4);function Dd(){const t=ln().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function h_(t){return new Promise((e,r)=>{function n(){Dd(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Dd(),r(Qr(t,"network-request-failed"))},timeout:d_.get()})}if(ln().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(ln().gapi?.load)n();else{const i=y0("iframefcb");return ln()[i]=()=>{gapi.load?n():r(Qr(t,"network-request-failed"))},m0(`${f0()}?onload=${i}`).catch(o=>r(o))}}).catch(e=>{throw ra=null,e})}let ra=null;function m_(t){return ra=ra||h_(t),ra}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f_=new hs(5e3,15e3),y_="__/auth/iframe",g_="emulator/auth/iframe",p_={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},v_=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function b_(t){const e=t.config;at(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Oc(e,g_):`https://${t.config.authDomain}/${y_}`,n={apiKey:e.apiKey,appName:t.name,v:ho},i=v_.get(t.config.apiHost);i&&(n.eid=i);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${ds(n).slice(1)}`}async function __(t){const e=await m_(t),r=ln().gapi;return at(r,t,"internal-error"),e.open({where:document.body,url:b_(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:p_,dontclear:!0},n=>new Promise(async(i,o)=>{await n.restyle({setHideOnLeave:!1});const a=Qr(t,"network-request-failed"),c=ln().setTimeout(()=>{o(a)},f_.get());function d(){ln().clearTimeout(c),i(n)}n.ping(d).then(d,()=>{o(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S_={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},P_=500,w_=600,C_="_blank",A_="http://localhost";class Nd{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function I_(t,e,r,n=P_,i=w_){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const d={...S_,width:n.toString(),height:i.toString(),top:o,left:a},h=Ir().toLowerCase();r&&(c=ff(h)?C_:r),hf(h)&&(e=e||A_,d.scrollbars="yes");const m=Object.entries(d).reduce((_,[A,M])=>`${_}${A}=${M},`,"");if(o0(h)&&c!=="_self")return E_(e||"",c),new Nd(null);const g=window.open(e||"",c,m);at(g,t,"popup-blocked");try{g.focus()}catch{}return new Nd(g)}function E_(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x_="__/auth/handler",T_="emulator/auth/handler",$_=encodeURIComponent("fac");async function Ld(t,e,r,n,i,o){at(t.config.authDomain,t,"auth-domain-config-required"),at(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:ho,eventId:i};if(e instanceof Ba){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",Tv(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,g]of Object.entries({}))a[m]=g}if(e instanceof ms){const m=e.getScopes().filter(g=>g!=="");m.length>0&&(a.scopes=m.join(","))}t.tenantId&&(a.tid=t.tenantId);const c=a;for(const m of Object.keys(c))c[m]===void 0&&delete c[m];const d=await t._getAppCheckToken(),h=d?`#${$_}=${encodeURIComponent(d)}`:"";return`${k_(t)}?${ds(c).slice(1)}${h}`}function k_({config:t}){return t.emulator?Oc(t,T_):`https://${t.authDomain}/${x_}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vl="webStorageSupport";class R_{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=xf,this._completeRedirectFn=Mf,this._overrideRedirectResult=Z0}async _openPopup(e,r,n,i){Tn(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await Ld(e,r,n,ec(),i);return I_(e,o,jc())}async _openRedirect(e,r,n,i){await this._originValidation(e);const o=await Ld(e,r,n,ec(),i);return N0(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:o}=this.eventManagers[r];return i?Promise.resolve(i):(Tn(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await __(e),n=new i_(e);return r.register("authEvent",i=>(at(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(vl,{type:vl},i=>{const o=i?.[0]?.[vl];o!==void 0&&r(!!o),fn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=c_(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return bf()||mf()||Fc()}}const D_=R_;var Md="@firebase/auth",Od="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){at(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L_(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function M_(t){to(new Ci("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=n.options;at(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const d={apiKey:a,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_f(t)},h=new d0(n,i,o,d);return p0(h,r),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),to(new Ci("auth-internal",e=>{const r=Ti(e.getProvider("auth").getImmediate());return(n=>new N_(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Wn(Md,Od,L_(t)),Wn(Md,Od,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O_=5*60,V_=Wm("authIdTokenMaxAge")||O_;let Vd=null;const B_=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>V_)return;const i=r?.token;Vd!==i&&(Vd=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function F_(t=ef()){const e=Nc(t,"auth");if(e.isInitialized())return e.getImmediate();const r=g0(t,{popupRedirectResolver:D_,persistence:[z0,k0,xf]}),n=Wm("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const a=B_(o.toString());I0(r,a,()=>a(r.currentUser)),A0(r,c=>a(c))}}const i=Hm("auth");return i&&v0(r,`http://${i}`),r}function U_(){return document.getElementsByTagName("head")?.[0]??document}h0({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const o=Qr("internal-error");o.customData=i,r(o)},n.type="text/javascript",n.charset="UTF-8",U_().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});M_("Browser");var j_="firebase",z_="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Wn(j_,z_,"app");var Bd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Qn,Vf;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e($,S){function p(){}p.prototype=S.prototype,$.D=S.prototype,$.prototype=new p,$.prototype.constructor=$,$.C=function(C,P,E){for(var y=Array(arguments.length-2),oe=2;oe<arguments.length;oe++)y[oe-2]=arguments[oe];return S.prototype[P].apply(C,y)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i($,S,p){p||(p=0);var C=Array(16);if(typeof S=="string")for(var P=0;16>P;++P)C[P]=S.charCodeAt(p++)|S.charCodeAt(p++)<<8|S.charCodeAt(p++)<<16|S.charCodeAt(p++)<<24;else for(P=0;16>P;++P)C[P]=S[p++]|S[p++]<<8|S[p++]<<16|S[p++]<<24;S=$.g[0],p=$.g[1],P=$.g[2];var E=$.g[3],y=S+(E^p&(P^E))+C[0]+3614090360&4294967295;S=p+(y<<7&4294967295|y>>>25),y=E+(P^S&(p^P))+C[1]+3905402710&4294967295,E=S+(y<<12&4294967295|y>>>20),y=P+(p^E&(S^p))+C[2]+606105819&4294967295,P=E+(y<<17&4294967295|y>>>15),y=p+(S^P&(E^S))+C[3]+3250441966&4294967295,p=P+(y<<22&4294967295|y>>>10),y=S+(E^p&(P^E))+C[4]+4118548399&4294967295,S=p+(y<<7&4294967295|y>>>25),y=E+(P^S&(p^P))+C[5]+1200080426&4294967295,E=S+(y<<12&4294967295|y>>>20),y=P+(p^E&(S^p))+C[6]+2821735955&4294967295,P=E+(y<<17&4294967295|y>>>15),y=p+(S^P&(E^S))+C[7]+4249261313&4294967295,p=P+(y<<22&4294967295|y>>>10),y=S+(E^p&(P^E))+C[8]+1770035416&4294967295,S=p+(y<<7&4294967295|y>>>25),y=E+(P^S&(p^P))+C[9]+2336552879&4294967295,E=S+(y<<12&4294967295|y>>>20),y=P+(p^E&(S^p))+C[10]+4294925233&4294967295,P=E+(y<<17&4294967295|y>>>15),y=p+(S^P&(E^S))+C[11]+2304563134&4294967295,p=P+(y<<22&4294967295|y>>>10),y=S+(E^p&(P^E))+C[12]+1804603682&4294967295,S=p+(y<<7&4294967295|y>>>25),y=E+(P^S&(p^P))+C[13]+4254626195&4294967295,E=S+(y<<12&4294967295|y>>>20),y=P+(p^E&(S^p))+C[14]+2792965006&4294967295,P=E+(y<<17&4294967295|y>>>15),y=p+(S^P&(E^S))+C[15]+1236535329&4294967295,p=P+(y<<22&4294967295|y>>>10),y=S+(P^E&(p^P))+C[1]+4129170786&4294967295,S=p+(y<<5&4294967295|y>>>27),y=E+(p^P&(S^p))+C[6]+3225465664&4294967295,E=S+(y<<9&4294967295|y>>>23),y=P+(S^p&(E^S))+C[11]+643717713&4294967295,P=E+(y<<14&4294967295|y>>>18),y=p+(E^S&(P^E))+C[0]+3921069994&4294967295,p=P+(y<<20&4294967295|y>>>12),y=S+(P^E&(p^P))+C[5]+3593408605&4294967295,S=p+(y<<5&4294967295|y>>>27),y=E+(p^P&(S^p))+C[10]+38016083&4294967295,E=S+(y<<9&4294967295|y>>>23),y=P+(S^p&(E^S))+C[15]+3634488961&4294967295,P=E+(y<<14&4294967295|y>>>18),y=p+(E^S&(P^E))+C[4]+3889429448&4294967295,p=P+(y<<20&4294967295|y>>>12),y=S+(P^E&(p^P))+C[9]+568446438&4294967295,S=p+(y<<5&4294967295|y>>>27),y=E+(p^P&(S^p))+C[14]+3275163606&4294967295,E=S+(y<<9&4294967295|y>>>23),y=P+(S^p&(E^S))+C[3]+4107603335&4294967295,P=E+(y<<14&4294967295|y>>>18),y=p+(E^S&(P^E))+C[8]+1163531501&4294967295,p=P+(y<<20&4294967295|y>>>12),y=S+(P^E&(p^P))+C[13]+2850285829&4294967295,S=p+(y<<5&4294967295|y>>>27),y=E+(p^P&(S^p))+C[2]+4243563512&4294967295,E=S+(y<<9&4294967295|y>>>23),y=P+(S^p&(E^S))+C[7]+1735328473&4294967295,P=E+(y<<14&4294967295|y>>>18),y=p+(E^S&(P^E))+C[12]+2368359562&4294967295,p=P+(y<<20&4294967295|y>>>12),y=S+(p^P^E)+C[5]+4294588738&4294967295,S=p+(y<<4&4294967295|y>>>28),y=E+(S^p^P)+C[8]+2272392833&4294967295,E=S+(y<<11&4294967295|y>>>21),y=P+(E^S^p)+C[11]+1839030562&4294967295,P=E+(y<<16&4294967295|y>>>16),y=p+(P^E^S)+C[14]+4259657740&4294967295,p=P+(y<<23&4294967295|y>>>9),y=S+(p^P^E)+C[1]+2763975236&4294967295,S=p+(y<<4&4294967295|y>>>28),y=E+(S^p^P)+C[4]+1272893353&4294967295,E=S+(y<<11&4294967295|y>>>21),y=P+(E^S^p)+C[7]+4139469664&4294967295,P=E+(y<<16&4294967295|y>>>16),y=p+(P^E^S)+C[10]+3200236656&4294967295,p=P+(y<<23&4294967295|y>>>9),y=S+(p^P^E)+C[13]+681279174&4294967295,S=p+(y<<4&4294967295|y>>>28),y=E+(S^p^P)+C[0]+3936430074&4294967295,E=S+(y<<11&4294967295|y>>>21),y=P+(E^S^p)+C[3]+3572445317&4294967295,P=E+(y<<16&4294967295|y>>>16),y=p+(P^E^S)+C[6]+76029189&4294967295,p=P+(y<<23&4294967295|y>>>9),y=S+(p^P^E)+C[9]+3654602809&4294967295,S=p+(y<<4&4294967295|y>>>28),y=E+(S^p^P)+C[12]+3873151461&4294967295,E=S+(y<<11&4294967295|y>>>21),y=P+(E^S^p)+C[15]+530742520&4294967295,P=E+(y<<16&4294967295|y>>>16),y=p+(P^E^S)+C[2]+3299628645&4294967295,p=P+(y<<23&4294967295|y>>>9),y=S+(P^(p|~E))+C[0]+4096336452&4294967295,S=p+(y<<6&4294967295|y>>>26),y=E+(p^(S|~P))+C[7]+1126891415&4294967295,E=S+(y<<10&4294967295|y>>>22),y=P+(S^(E|~p))+C[14]+2878612391&4294967295,P=E+(y<<15&4294967295|y>>>17),y=p+(E^(P|~S))+C[5]+4237533241&4294967295,p=P+(y<<21&4294967295|y>>>11),y=S+(P^(p|~E))+C[12]+1700485571&4294967295,S=p+(y<<6&4294967295|y>>>26),y=E+(p^(S|~P))+C[3]+2399980690&4294967295,E=S+(y<<10&4294967295|y>>>22),y=P+(S^(E|~p))+C[10]+4293915773&4294967295,P=E+(y<<15&4294967295|y>>>17),y=p+(E^(P|~S))+C[1]+2240044497&4294967295,p=P+(y<<21&4294967295|y>>>11),y=S+(P^(p|~E))+C[8]+1873313359&4294967295,S=p+(y<<6&4294967295|y>>>26),y=E+(p^(S|~P))+C[15]+4264355552&4294967295,E=S+(y<<10&4294967295|y>>>22),y=P+(S^(E|~p))+C[6]+2734768916&4294967295,P=E+(y<<15&4294967295|y>>>17),y=p+(E^(P|~S))+C[13]+1309151649&4294967295,p=P+(y<<21&4294967295|y>>>11),y=S+(P^(p|~E))+C[4]+4149444226&4294967295,S=p+(y<<6&4294967295|y>>>26),y=E+(p^(S|~P))+C[11]+3174756917&4294967295,E=S+(y<<10&4294967295|y>>>22),y=P+(S^(E|~p))+C[2]+718787259&4294967295,P=E+(y<<15&4294967295|y>>>17),y=p+(E^(P|~S))+C[9]+3951481745&4294967295,$.g[0]=$.g[0]+S&4294967295,$.g[1]=$.g[1]+(P+(y<<21&4294967295|y>>>11))&4294967295,$.g[2]=$.g[2]+P&4294967295,$.g[3]=$.g[3]+E&4294967295}n.prototype.u=function($,S){S===void 0&&(S=$.length);for(var p=S-this.blockSize,C=this.B,P=this.h,E=0;E<S;){if(P==0)for(;E<=p;)i(this,$,E),E+=this.blockSize;if(typeof $=="string"){for(;E<S;)if(C[P++]=$.charCodeAt(E++),P==this.blockSize){i(this,C),P=0;break}}else for(;E<S;)if(C[P++]=$[E++],P==this.blockSize){i(this,C),P=0;break}}this.h=P,this.o+=S},n.prototype.v=function(){var $=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);$[0]=128;for(var S=1;S<$.length-8;++S)$[S]=0;var p=8*this.o;for(S=$.length-8;S<$.length;++S)$[S]=p&255,p/=256;for(this.u($),$=Array(16),S=p=0;4>S;++S)for(var C=0;32>C;C+=8)$[p++]=this.g[S]>>>C&255;return $};function o($,S){var p=c;return Object.prototype.hasOwnProperty.call(p,$)?p[$]:p[$]=S($)}function a($,S){this.h=S;for(var p=[],C=!0,P=$.length-1;0<=P;P--){var E=$[P]|0;C&&E==S||(p[P]=E,C=!1)}this.g=p}var c={};function d($){return-128<=$&&128>$?o($,function(S){return new a([S|0],0>S?-1:0)}):new a([$|0],0>$?-1:0)}function h($){if(isNaN($)||!isFinite($))return g;if(0>$)return k(h(-$));for(var S=[],p=1,C=0;$>=p;C++)S[C]=$/p|0,p*=4294967296;return new a(S,0)}function m($,S){if($.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if($.charAt(0)=="-")return k(m($.substring(1),S));if(0<=$.indexOf("-"))throw Error('number format error: interior "-" character');for(var p=h(Math.pow(S,8)),C=g,P=0;P<$.length;P+=8){var E=Math.min(8,$.length-P),y=parseInt($.substring(P,P+E),S);8>E?(E=h(Math.pow(S,E)),C=C.j(E).add(h(y))):(C=C.j(p),C=C.add(h(y)))}return C}var g=d(0),_=d(1),A=d(16777216);t=a.prototype,t.m=function(){if(L(this))return-k(this).m();for(var $=0,S=1,p=0;p<this.g.length;p++){var C=this.i(p);$+=(0<=C?C:4294967296+C)*S,S*=4294967296}return $},t.toString=function($){if($=$||10,2>$||36<$)throw Error("radix out of range: "+$);if(M(this))return"0";if(L(this))return"-"+k(this).toString($);for(var S=h(Math.pow($,6)),p=this,C="";;){var P=te(p,S).g;p=R(p,P.j(S));var E=((0<p.g.length?p.g[0]:p.h)>>>0).toString($);if(p=P,M(p))return E+C;for(;6>E.length;)E="0"+E;C=E+C}},t.i=function($){return 0>$?0:$<this.g.length?this.g[$]:this.h};function M($){if($.h!=0)return!1;for(var S=0;S<$.g.length;S++)if($.g[S]!=0)return!1;return!0}function L($){return $.h==-1}t.l=function($){return $=R(this,$),L($)?-1:M($)?0:1};function k($){for(var S=$.g.length,p=[],C=0;C<S;C++)p[C]=~$.g[C];return new a(p,~$.h).add(_)}t.abs=function(){return L(this)?k(this):this},t.add=function($){for(var S=Math.max(this.g.length,$.g.length),p=[],C=0,P=0;P<=S;P++){var E=C+(this.i(P)&65535)+($.i(P)&65535),y=(E>>>16)+(this.i(P)>>>16)+($.i(P)>>>16);C=y>>>16,E&=65535,y&=65535,p[P]=y<<16|E}return new a(p,p[p.length-1]&-2147483648?-1:0)};function R($,S){return $.add(k(S))}t.j=function($){if(M(this)||M($))return g;if(L(this))return L($)?k(this).j(k($)):k(k(this).j($));if(L($))return k(this.j(k($)));if(0>this.l(A)&&0>$.l(A))return h(this.m()*$.m());for(var S=this.g.length+$.g.length,p=[],C=0;C<2*S;C++)p[C]=0;for(C=0;C<this.g.length;C++)for(var P=0;P<$.g.length;P++){var E=this.i(C)>>>16,y=this.i(C)&65535,oe=$.i(P)>>>16,K=$.i(P)&65535;p[2*C+2*P]+=y*K,W(p,2*C+2*P),p[2*C+2*P+1]+=E*K,W(p,2*C+2*P+1),p[2*C+2*P+1]+=y*oe,W(p,2*C+2*P+1),p[2*C+2*P+2]+=E*oe,W(p,2*C+2*P+2)}for(C=0;C<S;C++)p[C]=p[2*C+1]<<16|p[2*C];for(C=S;C<2*S;C++)p[C]=0;return new a(p,0)};function W($,S){for(;($[S]&65535)!=$[S];)$[S+1]+=$[S]>>>16,$[S]&=65535,S++}function ie($,S){this.g=$,this.h=S}function te($,S){if(M(S))throw Error("division by zero");if(M($))return new ie(g,g);if(L($))return S=te(k($),S),new ie(k(S.g),k(S.h));if(L(S))return S=te($,k(S)),new ie(k(S.g),S.h);if(30<$.g.length){if(L($)||L(S))throw Error("slowDivide_ only works with positive integers.");for(var p=_,C=S;0>=C.l($);)p=ye(p),C=ye(C);var P=ae(p,1),E=ae(C,1);for(C=ae(C,2),p=ae(p,2);!M(C);){var y=E.add(C);0>=y.l($)&&(P=P.add(p),E=y),C=ae(C,1),p=ae(p,1)}return S=R($,P.j(S)),new ie(P,S)}for(P=g;0<=$.l(S);){for(p=Math.max(1,Math.floor($.m()/S.m())),C=Math.ceil(Math.log(p)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),E=h(p),y=E.j(S);L(y)||0<y.l($);)p-=C,E=h(p),y=E.j(S);M(E)&&(E=_),P=P.add(E),$=R($,y)}return new ie(P,$)}t.A=function($){return te(this,$).h},t.and=function($){for(var S=Math.max(this.g.length,$.g.length),p=[],C=0;C<S;C++)p[C]=this.i(C)&$.i(C);return new a(p,this.h&$.h)},t.or=function($){for(var S=Math.max(this.g.length,$.g.length),p=[],C=0;C<S;C++)p[C]=this.i(C)|$.i(C);return new a(p,this.h|$.h)},t.xor=function($){for(var S=Math.max(this.g.length,$.g.length),p=[],C=0;C<S;C++)p[C]=this.i(C)^$.i(C);return new a(p,this.h^$.h)};function ye($){for(var S=$.g.length+1,p=[],C=0;C<S;C++)p[C]=$.i(C)<<1|$.i(C-1)>>>31;return new a(p,$.h)}function ae($,S){var p=S>>5;S%=32;for(var C=$.g.length-p,P=[],E=0;E<C;E++)P[E]=0<S?$.i(E+p)>>>S|$.i(E+p+1)<<32-S:$.i(E+p);return new a(P,$.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Vf=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=m,Qn=a}).apply(typeof Bd<"u"?Bd:typeof self<"u"?self:typeof window<"u"?window:{});var Ls=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Bf,Lo,Ff,na,nc,Uf,jf,zf;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,f,v){return l==Array.prototype||l==Object.prototype||(l[f]=v.value),l};function r(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ls=="object"&&Ls];for(var f=0;f<l.length;++f){var v=l[f];if(v&&v.Math==Math)return v}throw Error("Cannot find global object")}var n=r(this);function i(l,f){if(f)e:{var v=n;l=l.split(".");for(var q=0;q<l.length-1;q++){var _e=l[q];if(!(_e in v))break e;v=v[_e]}l=l[l.length-1],q=v[l],f=f(q),f!=q&&f!=null&&e(v,l,{configurable:!0,writable:!0,value:f})}}function o(l,f){l instanceof String&&(l+="");var v=0,q=!1,_e={next:function(){if(!q&&v<l.length){var Ce=v++;return{value:f(Ce,l[Ce]),done:!1}}return q=!0,{done:!0,value:void 0}}};return _e[Symbol.iterator]=function(){return _e},_e}i("Array.prototype.values",function(l){return l||function(){return o(this,function(f,v){return v})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},c=this||self;function d(l){var f=typeof l;return f=f!="object"?f:l?Array.isArray(l)?"array":f:"null",f=="array"||f=="object"&&typeof l.length=="number"}function h(l){var f=typeof l;return f=="object"&&l!=null||f=="function"}function m(l,f,v){return l.call.apply(l.bind,arguments)}function g(l,f,v){if(!l)throw Error();if(2<arguments.length){var q=Array.prototype.slice.call(arguments,2);return function(){var _e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(_e,q),l.apply(f,_e)}}return function(){return l.apply(f,arguments)}}function _(l,f,v){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:g,_.apply(null,arguments)}function A(l,f){var v=Array.prototype.slice.call(arguments,1);return function(){var q=v.slice();return q.push.apply(q,arguments),l.apply(this,q)}}function M(l,f){function v(){}v.prototype=f.prototype,l.aa=f.prototype,l.prototype=new v,l.prototype.constructor=l,l.Qb=function(q,_e,Ce){for(var Ve=Array(arguments.length-2),jt=2;jt<arguments.length;jt++)Ve[jt-2]=arguments[jt];return f.prototype[_e].apply(q,Ve)}}function L(l){const f=l.length;if(0<f){const v=Array(f);for(let q=0;q<f;q++)v[q]=l[q];return v}return[]}function k(l,f){for(let v=1;v<arguments.length;v++){const q=arguments[v];if(d(q)){const _e=l.length||0,Ce=q.length||0;l.length=_e+Ce;for(let Ve=0;Ve<Ce;Ve++)l[_e+Ve]=q[Ve]}else l.push(q)}}class R{constructor(f,v){this.i=f,this.j=v,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function W(l){return/^[\s\xa0]*$/.test(l)}function ie(){var l=c.navigator;return l&&(l=l.userAgent)?l:""}function te(l){return te[" "](l),l}te[" "]=function(){};var ye=ie().indexOf("Gecko")!=-1&&!(ie().toLowerCase().indexOf("webkit")!=-1&&ie().indexOf("Edge")==-1)&&!(ie().indexOf("Trident")!=-1||ie().indexOf("MSIE")!=-1)&&ie().indexOf("Edge")==-1;function ae(l,f,v){for(const q in l)f.call(v,l[q],q,l)}function $(l,f){for(const v in l)f.call(void 0,l[v],v,l)}function S(l){const f={};for(const v in l)f[v]=l[v];return f}const p="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(l,f){let v,q;for(let _e=1;_e<arguments.length;_e++){q=arguments[_e];for(v in q)l[v]=q[v];for(let Ce=0;Ce<p.length;Ce++)v=p[Ce],Object.prototype.hasOwnProperty.call(q,v)&&(l[v]=q[v])}}function P(l){var f=1;l=l.split(":");const v=[];for(;0<f&&l.length;)v.push(l.shift()),f--;return l.length&&v.push(l.join(":")),v}function E(l){c.setTimeout(()=>{throw l},0)}function y(){var l=x;let f=null;return l.g&&(f=l.g,l.g=l.g.next,l.g||(l.h=null),f.next=null),f}class oe{constructor(){this.h=this.g=null}add(f,v){const q=K.get();q.set(f,v),this.h?this.h.next=q:this.g=q,this.h=q}}var K=new R(()=>new T,l=>l.reset());class T{constructor(){this.next=this.g=this.h=null}set(f,v){this.h=f,this.g=v,this.next=null}reset(){this.next=this.g=this.h=null}}let U,B=!1,x=new oe,I=()=>{const l=c.Promise.resolve(void 0);U=()=>{l.then(N)}};var N=()=>{for(var l;l=y();){try{l.h.call(l.g)}catch(v){E(v)}var f=K;f.j(l),100>f.h&&(f.h++,l.next=f.g,f.g=l)}B=!1};function Z(){this.s=this.s,this.C=this.C}Z.prototype.s=!1,Z.prototype.ma=function(){this.s||(this.s=!0,this.N())},Z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(l,f){this.type=l,this.g=this.target=f,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var J=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var l=!1,f=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const v=()=>{};c.addEventListener("test",v,f),c.removeEventListener("test",v,f)}catch{}return l}();function w(l,f){if(j.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var v=this.type=l.type,q=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=f,f=l.relatedTarget){if(ye){e:{try{te(f.nodeName);var _e=!0;break e}catch{}_e=!1}_e||(f=null)}}else v=="mouseover"?f=l.fromElement:v=="mouseout"&&(f=l.toElement);this.relatedTarget=f,q?(this.clientX=q.clientX!==void 0?q.clientX:q.pageX,this.clientY=q.clientY!==void 0?q.clientY:q.pageY,this.screenX=q.screenX||0,this.screenY=q.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:V[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&w.aa.h.call(this)}}M(w,j);var V={2:"touch",3:"pen",4:"mouse"};w.prototype.h=function(){w.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var X="closure_listenable_"+(1e6*Math.random()|0),Y=0;function se(l,f,v,q,_e){this.listener=l,this.proxy=null,this.src=f,this.type=v,this.capture=!!q,this.ha=_e,this.key=++Y,this.da=this.fa=!1}function O(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function F(l){this.src=l,this.g={},this.h=0}F.prototype.add=function(l,f,v,q,_e){var Ce=l.toString();l=this.g[Ce],l||(l=this.g[Ce]=[],this.h++);var Ve=pe(l,f,q,_e);return-1<Ve?(f=l[Ve],v||(f.fa=!1)):(f=new se(f,this.src,Ce,!!q,_e),f.fa=v,l.push(f)),f};function le(l,f){var v=f.type;if(v in l.g){var q=l.g[v],_e=Array.prototype.indexOf.call(q,f,void 0),Ce;(Ce=0<=_e)&&Array.prototype.splice.call(q,_e,1),Ce&&(O(f),l.g[v].length==0&&(delete l.g[v],l.h--))}}function pe(l,f,v,q){for(var _e=0;_e<l.length;++_e){var Ce=l[_e];if(!Ce.da&&Ce.listener==f&&Ce.capture==!!v&&Ce.ha==q)return _e}return-1}var ve="closure_lm_"+(1e6*Math.random()|0),ce={};function H(l,f,v,q,_e){if(Array.isArray(f)){for(var Ce=0;Ce<f.length;Ce++)H(l,f[Ce],v,q,_e);return null}return v=we(v),l&&l[X]?l.K(f,v,h(q)?!!q.capture:!1,_e):D(l,f,v,!1,q,_e)}function D(l,f,v,q,_e,Ce){if(!f)throw Error("Invalid event type");var Ve=h(_e)?!!_e.capture:!!_e,jt=ne(l);if(jt||(l[ve]=jt=new F(l)),v=jt.add(f,v,q,Ve,Ce),v.proxy)return v;if(q=Q(),v.proxy=q,q.src=l,q.listener=v,l.addEventListener)J||(_e=Ve),_e===void 0&&(_e=!1),l.addEventListener(f.toString(),q,_e);else if(l.attachEvent)l.attachEvent(me(f.toString()),q);else if(l.addListener&&l.removeListener)l.addListener(q);else throw Error("addEventListener and attachEvent are unavailable.");return v}function Q(){function l(v){return f.call(l.src,l.listener,v)}const f=ee;return l}function G(l,f,v,q,_e){if(Array.isArray(f))for(var Ce=0;Ce<f.length;Ce++)G(l,f[Ce],v,q,_e);else q=h(q)?!!q.capture:!!q,v=we(v),l&&l[X]?(l=l.i,f=String(f).toString(),f in l.g&&(Ce=l.g[f],v=pe(Ce,v,q,_e),-1<v&&(O(Ce[v]),Array.prototype.splice.call(Ce,v,1),Ce.length==0&&(delete l.g[f],l.h--)))):l&&(l=ne(l))&&(f=l.g[f.toString()],l=-1,f&&(l=pe(f,v,q,_e)),(v=-1<l?f[l]:null)&&he(v))}function he(l){if(typeof l!="number"&&l&&!l.da){var f=l.src;if(f&&f[X])le(f.i,l);else{var v=l.type,q=l.proxy;f.removeEventListener?f.removeEventListener(v,q,l.capture):f.detachEvent?f.detachEvent(me(v),q):f.addListener&&f.removeListener&&f.removeListener(q),(v=ne(f))?(le(v,l),v.h==0&&(v.src=null,f[ve]=null)):O(l)}}}function me(l){return l in ce?ce[l]:ce[l]="on"+l}function ee(l,f){if(l.da)l=!0;else{f=new w(f,this);var v=l.listener,q=l.ha||l.src;l.fa&&he(l),l=v.call(q,f)}return l}function ne(l){return l=l[ve],l instanceof F?l:null}var Se="__closure_events_fn_"+(1e9*Math.random()>>>0);function we(l){return typeof l=="function"?l:(l[Se]||(l[Se]=function(f){return l.handleEvent(f)}),l[Se])}function ue(){Z.call(this),this.i=new F(this),this.M=this,this.F=null}M(ue,Z),ue.prototype[X]=!0,ue.prototype.removeEventListener=function(l,f,v,q){G(this,l,f,v,q)};function be(l,f){var v,q=l.F;if(q)for(v=[];q;q=q.F)v.push(q);if(l=l.M,q=f.type||f,typeof f=="string")f=new j(f,l);else if(f instanceof j)f.target=f.target||l;else{var _e=f;f=new j(q,l),C(f,_e)}if(_e=!0,v)for(var Ce=v.length-1;0<=Ce;Ce--){var Ve=f.g=v[Ce];_e=de(Ve,q,!0,f)&&_e}if(Ve=f.g=l,_e=de(Ve,q,!0,f)&&_e,_e=de(Ve,q,!1,f)&&_e,v)for(Ce=0;Ce<v.length;Ce++)Ve=f.g=v[Ce],_e=de(Ve,q,!1,f)&&_e}ue.prototype.N=function(){if(ue.aa.N.call(this),this.i){var l=this.i,f;for(f in l.g){for(var v=l.g[f],q=0;q<v.length;q++)O(v[q]);delete l.g[f],l.h--}}this.F=null},ue.prototype.K=function(l,f,v,q){return this.i.add(String(l),f,!1,v,q)},ue.prototype.L=function(l,f,v,q){return this.i.add(String(l),f,!0,v,q)};function de(l,f,v,q){if(f=l.i.g[String(f)],!f)return!0;f=f.concat();for(var _e=!0,Ce=0;Ce<f.length;++Ce){var Ve=f[Ce];if(Ve&&!Ve.da&&Ve.capture==v){var jt=Ve.listener,ur=Ve.ha||Ve.src;Ve.fa&&le(l.i,Ve),_e=jt.call(ur,q)!==!1&&_e}}return _e&&!q.defaultPrevented}function Pe(l,f,v){if(typeof l=="function")v&&(l=_(l,v));else if(l&&typeof l.handleEvent=="function")l=_(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:c.setTimeout(l,f||0)}function $e(l){l.g=Pe(()=>{l.g=null,l.i&&(l.i=!1,$e(l))},l.l);const f=l.h;l.h=null,l.m.apply(null,f)}class xe extends Z{constructor(f,v){super(),this.m=f,this.l=v,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:$e(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ke(l){Z.call(this),this.h=l,this.g={}}M(ke,Z);var Be=[];function Qe(l){ae(l.g,function(f,v){this.g.hasOwnProperty(v)&&he(f)},l),l.g={}}ke.prototype.N=function(){ke.aa.N.call(this),Qe(this)},ke.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ue=c.JSON.stringify,Te=c.JSON.parse,Fe=class{stringify(l){return c.JSON.stringify(l,void 0)}parse(l){return c.JSON.parse(l,void 0)}};function Je(){}Je.prototype.h=null;function Ge(l){return l.h||(l.h=l.i())}function Xe(){}var Ae={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ie(){j.call(this,"d")}M(Ie,j);function Ze(){j.call(this,"c")}M(Ze,j);var dt={},ft=null;function Tt(){return ft=ft||new ue}dt.La="serverreachability";function _t(l){j.call(this,dt.La,l)}M(_t,j);function Et(l){const f=Tt();be(f,new _t(f))}dt.STAT_EVENT="statevent";function Mt(l,f){j.call(this,dt.STAT_EVENT,l),this.stat=f}M(Mt,j);function it(l){const f=Tt();be(f,new Mt(f,l))}dt.Ma="timingevent";function Vt(l,f){j.call(this,dt.Ma,l),this.size=f}M(Vt,j);function It(l,f){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){l()},f)}function je(){this.g=!0}je.prototype.xa=function(){this.g=!1};function Oe(l,f,v,q,_e,Ce){l.info(function(){if(l.g)if(Ce)for(var Ve="",jt=Ce.split("&"),ur=0;ur<jt.length;ur++){var $t=jt[ur].split("=");if(1<$t.length){var br=$t[0];$t=$t[1];var _r=br.split("_");Ve=2<=_r.length&&_r[1]=="type"?Ve+(br+"="+$t+"&"):Ve+(br+"=redacted&")}}else Ve=null;else Ve=Ce;return"XMLHTTP REQ ("+q+") [attempt "+_e+"]: "+f+`
`+v+`
`+Ve})}function Me(l,f,v,q,_e,Ce,Ve){l.info(function(){return"XMLHTTP RESP ("+q+") [ attempt "+_e+"]: "+f+`
`+v+`
`+Ce+" "+Ve})}function He(l,f,v,q){l.info(function(){return"XMLHTTP TEXT ("+f+"): "+mt(l,v)+(q?" "+q:"")})}function nt(l,f){l.info(function(){return"TIMEOUT: "+f})}je.prototype.info=function(){};function mt(l,f){if(!l.g)return f;if(!f)return null;try{var v=JSON.parse(f);if(v){for(l=0;l<v.length;l++)if(Array.isArray(v[l])){var q=v[l];if(!(2>q.length)){var _e=q[1];if(Array.isArray(_e)&&!(1>_e.length)){var Ce=_e[0];if(Ce!="noop"&&Ce!="stop"&&Ce!="close")for(var Ve=1;Ve<_e.length;Ve++)_e[Ve]=""}}}}return Ue(v)}catch{return f}}var Ke={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},et={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},st;function St(){}M(St,Je),St.prototype.g=function(){return new XMLHttpRequest},St.prototype.i=function(){return{}},st=new St;function yt(l,f,v,q){this.j=l,this.i=f,this.l=v,this.R=q||1,this.U=new ke(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Xt}function Xt(){this.i=null,this.g="",this.h=!1}var Nt={},or={};function pr(l,f,v){l.L=1,l.v=Li(Er(f)),l.m=v,l.P=!0,Bt(l,null)}function Bt(l,f){l.F=Date.now(),Yt(l),l.A=Er(l.v);var v=l.A,q=l.R;Array.isArray(q)||(q=[String(q)]),Nu(v.i,"t",q),l.C=0,v=l.j.J,l.h=new Xt,l.g=Xu(l.j,v?f:null,!l.m),0<l.O&&(l.M=new xe(_(l.Y,l,l.g),l.O)),f=l.U,v=l.g,q=l.ca;var _e="readystatechange";Array.isArray(_e)||(_e&&(Be[0]=_e.toString()),_e=Be);for(var Ce=0;Ce<_e.length;Ce++){var Ve=H(v,_e[Ce],q||f.handleEvent,!1,f.h||f);if(!Ve)break;f.g[Ve.key]=Ve}f=l.H?S(l.H):{},l.m?(l.u||(l.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,f)):(l.u="GET",l.g.ea(l.A,l.u,null,f)),Et(),Oe(l.i,l.u,l.A,l.l,l.R,l.m)}yt.prototype.ca=function(l){l=l.target;const f=this.M;f&&vn(l)==3?f.j():this.Y(l)},yt.prototype.Y=function(l){try{if(l==this.g)e:{const _r=vn(this.g);var f=this.g.Ba();const Vi=this.g.Z();if(!(3>_r)&&(_r!=3||this.g&&(this.h.h||this.g.oa()||Uu(this.g)))){this.J||_r!=4||f==7||(f==8||0>=Vi?Et(3):Et(2)),Or(this);var v=this.g.Z();this.X=v;t:if(Zt(this)){var q=Uu(this.g);l="";var _e=q.length,Ce=vn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Vr(this),gn(this);var Ve="";break t}this.h.i=new c.TextDecoder}for(f=0;f<_e;f++)this.h.h=!0,l+=this.h.i.decode(q[f],{stream:!(Ce&&f==_e-1)});q.length=0,this.h.g+=l,this.C=0,Ve=this.h.g}else Ve=this.g.oa();if(this.o=v==200,Me(this.i,this.u,this.A,this.l,this.R,_r,v),this.o){if(this.T&&!this.K){t:{if(this.g){var jt,ur=this.g;if((jt=ur.g?ur.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(jt)){var $t=jt;break t}}$t=null}if(v=$t)He(this.i,this.l,v,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,li(this,v);else{this.o=!1,this.s=3,it(12),Vr(this),gn(this);break e}}if(this.P){v=!0;let Yr;for(;!this.J&&this.C<Ve.length;)if(Yr=Gr(this,Ve),Yr==or){_r==4&&(this.s=4,it(14),v=!1),He(this.i,this.l,null,"[Incomplete Response]");break}else if(Yr==Nt){this.s=4,it(15),He(this.i,this.l,Ve,"[Invalid Chunk]"),v=!1;break}else He(this.i,this.l,Yr,null),li(this,Yr);if(Zt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),_r!=4||Ve.length!=0||this.h.h||(this.s=1,it(16),v=!1),this.o=this.o&&v,!v)He(this.i,this.l,Ve,"[Invalid Chunked Response]"),Vr(this),gn(this);else if(0<Ve.length&&!this.W){this.W=!0;var br=this.j;br.g==this&&br.ba&&!br.M&&(br.j.info("Great, no buffering proxy detected. Bytes received: "+Ve.length),sl(br),br.M=!0,it(11))}}else He(this.i,this.l,Ve,null),li(this,Ve);_r==4&&Vr(this),this.o&&!this.J&&(_r==4?Wu(this.j,this):(this.o=!1,Yt(this)))}else Og(this.g),v==400&&0<Ve.indexOf("Unknown SID")?(this.s=3,it(12)):(this.s=0,it(13)),Vr(this),gn(this)}}}catch{}finally{}};function Zt(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function Gr(l,f){var v=l.C,q=f.indexOf(`
`,v);return q==-1?or:(v=Number(f.substring(v,q)),isNaN(v)?Nt:(q+=1,q+v>f.length?or:(f=f.slice(q,q+v),l.C=q+v,f)))}yt.prototype.cancel=function(){this.J=!0,Vr(this)};function Yt(l){l.S=Date.now()+l.I,cr(l,l.I)}function cr(l,f){if(l.B!=null)throw Error("WatchDog timer not null");l.B=It(_(l.ba,l),f)}function Or(l){l.B&&(c.clearTimeout(l.B),l.B=null)}yt.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(nt(this.i,this.A),this.L!=2&&(Et(),it(17)),Vr(this),this.s=2,gn(this)):cr(this,this.S-l)};function gn(l){l.j.G==0||l.J||Wu(l.j,l)}function Vr(l){Or(l);var f=l.M;f&&typeof f.ma=="function"&&f.ma(),l.M=null,Qe(l.U),l.g&&(f=l.g,l.g=null,f.abort(),f.ma())}function li(l,f){try{var v=l.j;if(v.G!=0&&(v.g==l||Ni(v.h,l))){if(!l.K&&Ni(v.h,l)&&v.G==3){try{var q=v.Da.g.parse(f)}catch{q=null}if(Array.isArray(q)&&q.length==3){var _e=q;if(_e[0]==0){e:if(!v.u){if(v.g)if(v.g.F+3e3<l.F)$s(v),xs(v);else break e;ol(v),it(18)}}else v.za=_e[1],0<v.za-v.T&&37500>_e[2]&&v.F&&v.v==0&&!v.C&&(v.C=It(_(v.Za,v),6e3));if(1>=_o(v.h)&&v.ca){try{v.ca()}catch{}v.ca=void 0}}else ci(v,11)}else if((l.K||v.g==l)&&$s(v),!W(f))for(_e=v.Da.g.parse(f),f=0;f<_e.length;f++){let $t=_e[f];if(v.T=$t[0],$t=$t[1],v.G==2)if($t[0]=="c"){v.K=$t[1],v.ia=$t[2];const br=$t[3];br!=null&&(v.la=br,v.j.info("VER="+v.la));const _r=$t[4];_r!=null&&(v.Aa=_r,v.j.info("SVER="+v.Aa));const Vi=$t[5];Vi!=null&&typeof Vi=="number"&&0<Vi&&(q=1.5*Vi,v.L=q,v.j.info("backChannelRequestTimeoutMs_="+q)),q=v;const Yr=l.g;if(Yr){const Rs=Yr.g?Yr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Rs){var Ce=q.h;Ce.g||Rs.indexOf("spdy")==-1&&Rs.indexOf("quic")==-1&&Rs.indexOf("h2")==-1||(Ce.j=Ce.l,Ce.g=new Set,Ce.h&&(Ln(Ce,Ce.h),Ce.h=null))}if(q.D){const al=Yr.g?Yr.g.getResponseHeader("X-HTTP-Session-Id"):null;al&&(q.ya=al,Ut(q.I,q.D,al))}}v.G=3,v.l&&v.l.ua(),v.ba&&(v.R=Date.now()-l.F,v.j.info("Handshake RTT: "+v.R+"ms")),q=v;var Ve=l;if(q.qa=Ju(q,q.J?q.ia:null,q.W),Ve.K){ws(q.h,Ve);var jt=Ve,ur=q.L;ur&&(jt.I=ur),jt.B&&(Or(jt),Yt(jt)),q.g=Ve}else Hu(q);0<v.i.length&&Ts(v)}else $t[0]!="stop"&&$t[0]!="close"||ci(v,7);else v.G==3&&($t[0]=="stop"||$t[0]=="close"?$t[0]=="stop"?ci(v,7):il(v):$t[0]!="noop"&&v.l&&v.l.ta($t),v.v=0)}}Et(4)}catch{}}var Di=class{constructor(l,f){this.g=l,this.map=f}};function Ps(l){this.l=l||10,c.PerformanceNavigationTiming?(l=c.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function bo(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function _o(l){return l.h?1:l.g?l.g.size:0}function Ni(l,f){return l.h?l.h==f:l.g?l.g.has(f):!1}function Ln(l,f){l.g?l.g.add(f):l.h=f}function ws(l,f){l.h&&l.h==f?l.h=null:l.g&&l.g.has(f)&&l.g.delete(f)}Ps.prototype.cancel=function(){if(this.i=So(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function So(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let f=l.i;for(const v of l.g.values())f=f.concat(v.D);return f}return L(l.i)}function gt(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(d(l)){for(var f=[],v=l.length,q=0;q<v;q++)f.push(l[q]);return f}f=[],v=0;for(q in l)f[v++]=l[q];return f}function Ft(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(d(l)||typeof l=="string"){var f=[];l=l.length;for(var v=0;v<l;v++)f.push(v);return f}f=[],v=0;for(const q in l)f[v++]=q;return f}}}function vr(l,f){if(l.forEach&&typeof l.forEach=="function")l.forEach(f,void 0);else if(d(l)||typeof l=="string")Array.prototype.forEach.call(l,f,void 0);else for(var v=Ft(l),q=gt(l),_e=q.length,Ce=0;Ce<_e;Ce++)f.call(void 0,q[Ce],v&&v[Ce],l)}var Hr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function pn(l,f){if(l){l=l.split("&");for(var v=0;v<l.length;v++){var q=l[v].indexOf("="),_e=null;if(0<=q){var Ce=l[v].substring(0,q);_e=l[v].substring(q+1)}else Ce=l[v];f(Ce,_e?decodeURIComponent(_e.replace(/\+/g," ")):"")}}}function Gt(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Gt){this.h=l.h,Zr(this,l.j),this.o=l.o,this.g=l.g,en(this,l.s),this.l=l.l;var f=l.i,v=new Co;v.i=f.i,f.g&&(v.g=new Map(f.g),v.h=f.h),Cs(this,v),this.m=l.m}else l&&(f=String(l).match(Hr))?(this.h=!1,Zr(this,f[1]||"",!0),this.o=Po(f[2]||""),this.g=Po(f[3]||"",!0),en(this,f[4]),this.l=Po(f[5]||"",!0),Cs(this,f[6]||"",!0),this.m=Po(f[7]||"")):(this.h=!1,this.i=new Co(null,this.h))}Gt.prototype.toString=function(){var l=[],f=this.j;f&&l.push(wo(f,ku,!0),":");var v=this.g;return(v||f=="file")&&(l.push("//"),(f=this.o)&&l.push(wo(f,ku,!0),"@"),l.push(encodeURIComponent(String(v)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v=this.s,v!=null&&l.push(":",String(v))),(v=this.l)&&(this.g&&v.charAt(0)!="/"&&l.push("/"),l.push(wo(v,v.charAt(0)=="/"?Eg:Ig,!0))),(v=this.i.toString())&&l.push("?",v),(v=this.m)&&l.push("#",wo(v,Tg)),l.join("")};function Er(l){return new Gt(l)}function Zr(l,f,v){l.j=v?Po(f,!0):f,l.j&&(l.j=l.j.replace(/:$/,""))}function en(l,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);l.s=f}else l.s=null}function Cs(l,f,v){f instanceof Co?(l.i=f,$g(l.i,l.h)):(v||(f=wo(f,xg)),l.i=new Co(f,l.h))}function Ut(l,f,v){l.i.set(f,v)}function Li(l){return Ut(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function Po(l,f){return l?f?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function wo(l,f,v){return typeof l=="string"?(l=encodeURI(l).replace(f,Ag),v&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function Ag(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var ku=/[#\/\?@]/g,Ig=/[#\?:]/g,Eg=/[#\?]/g,xg=/[#\?@]/g,Tg=/#/g;function Co(l,f){this.h=this.g=null,this.i=l||null,this.j=!!f}function Mn(l){l.g||(l.g=new Map,l.h=0,l.i&&pn(l.i,function(f,v){l.add(decodeURIComponent(f.replace(/\+/g," ")),v)}))}t=Co.prototype,t.add=function(l,f){Mn(this),this.i=null,l=Mi(this,l);var v=this.g.get(l);return v||this.g.set(l,v=[]),v.push(f),this.h+=1,this};function Ru(l,f){Mn(l),f=Mi(l,f),l.g.has(f)&&(l.i=null,l.h-=l.g.get(f).length,l.g.delete(f))}function Du(l,f){return Mn(l),f=Mi(l,f),l.g.has(f)}t.forEach=function(l,f){Mn(this),this.g.forEach(function(v,q){v.forEach(function(_e){l.call(f,_e,q,this)},this)},this)},t.na=function(){Mn(this);const l=Array.from(this.g.values()),f=Array.from(this.g.keys()),v=[];for(let q=0;q<f.length;q++){const _e=l[q];for(let Ce=0;Ce<_e.length;Ce++)v.push(f[q])}return v},t.V=function(l){Mn(this);let f=[];if(typeof l=="string")Du(this,l)&&(f=f.concat(this.g.get(Mi(this,l))));else{l=Array.from(this.g.values());for(let v=0;v<l.length;v++)f=f.concat(l[v])}return f},t.set=function(l,f){return Mn(this),this.i=null,l=Mi(this,l),Du(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[f]),this.h+=1,this},t.get=function(l,f){return l?(l=this.V(l),0<l.length?String(l[0]):f):f};function Nu(l,f,v){Ru(l,f),0<v.length&&(l.i=null,l.g.set(Mi(l,f),L(v)),l.h+=v.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],f=Array.from(this.g.keys());for(var v=0;v<f.length;v++){var q=f[v];const Ce=encodeURIComponent(String(q)),Ve=this.V(q);for(q=0;q<Ve.length;q++){var _e=Ce;Ve[q]!==""&&(_e+="="+encodeURIComponent(String(Ve[q]))),l.push(_e)}}return this.i=l.join("&")};function Mi(l,f){return f=String(f),l.j&&(f=f.toLowerCase()),f}function $g(l,f){f&&!l.j&&(Mn(l),l.i=null,l.g.forEach(function(v,q){var _e=q.toLowerCase();q!=_e&&(Ru(this,q),Nu(this,_e,v))},l)),l.j=f}function kg(l,f){const v=new je;if(c.Image){const q=new Image;q.onload=A(On,v,"TestLoadImage: loaded",!0,f,q),q.onerror=A(On,v,"TestLoadImage: error",!1,f,q),q.onabort=A(On,v,"TestLoadImage: abort",!1,f,q),q.ontimeout=A(On,v,"TestLoadImage: timeout",!1,f,q),c.setTimeout(function(){q.ontimeout&&q.ontimeout()},1e4),q.src=l}else f(!1)}function Rg(l,f){const v=new je,q=new AbortController,_e=setTimeout(()=>{q.abort(),On(v,"TestPingServer: timeout",!1,f)},1e4);fetch(l,{signal:q.signal}).then(Ce=>{clearTimeout(_e),Ce.ok?On(v,"TestPingServer: ok",!0,f):On(v,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(_e),On(v,"TestPingServer: error",!1,f)})}function On(l,f,v,q,_e){try{_e&&(_e.onload=null,_e.onerror=null,_e.onabort=null,_e.ontimeout=null),q(v)}catch{}}function Dg(){this.g=new Fe}function Ng(l,f,v){const q=v||"";try{vr(l,function(_e,Ce){let Ve=_e;h(_e)&&(Ve=Ue(_e)),f.push(q+Ce+"="+encodeURIComponent(Ve))})}catch(_e){throw f.push(q+"type="+encodeURIComponent("_badmap")),_e}}function As(l){this.l=l.Ub||null,this.j=l.eb||!1}M(As,Je),As.prototype.g=function(){return new Is(this.l,this.j)},As.prototype.i=function(l){return function(){return l}}({});function Is(l,f){ue.call(this),this.D=l,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}M(Is,ue),t=Is.prototype,t.open=function(l,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=f,this.readyState=1,Io(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(f.body=l),(this.D||c).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ao(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Io(this)),this.g&&(this.readyState=3,Io(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Lu(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function Lu(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var f=l.value?l.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!l.done}))&&(this.response=this.responseText+=f)}l.done?Ao(this):Io(this),this.readyState==3&&Lu(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,Ao(this))},t.Qa=function(l){this.g&&(this.response=l,Ao(this))},t.ga=function(){this.g&&Ao(this)};function Ao(l){l.readyState=4,l.l=null,l.j=null,l.v=null,Io(l)}t.setRequestHeader=function(l,f){this.u.append(l,f)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],f=this.h.entries();for(var v=f.next();!v.done;)v=v.value,l.push(v[0]+": "+v[1]),v=f.next();return l.join(`\r
`)};function Io(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Is.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Mu(l){let f="";return ae(l,function(v,q){f+=q,f+=":",f+=v,f+=`\r
`}),f}function nl(l,f,v){e:{for(q in v){var q=!1;break e}q=!0}q||(v=Mu(v),typeof l=="string"?v!=null&&encodeURIComponent(String(v)):Ut(l,f,v))}function Kt(l){ue.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}M(Kt,ue);var Lg=/^https?$/i,Mg=["POST","PUT"];t=Kt.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,f,v,q){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);f=f?f.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():st.g(),this.v=this.o?Ge(this.o):Ge(st),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(f,String(l),!0),this.B=!1}catch(Ce){Ou(this,Ce);return}if(l=v||"",v=new Map(this.headers),q)if(Object.getPrototypeOf(q)===Object.prototype)for(var _e in q)v.set(_e,q[_e]);else if(typeof q.keys=="function"&&typeof q.get=="function")for(const Ce of q.keys())v.set(Ce,q.get(Ce));else throw Error("Unknown input type for opt_headers: "+String(q));q=Array.from(v.keys()).find(Ce=>Ce.toLowerCase()=="content-type"),_e=c.FormData&&l instanceof c.FormData,!(0<=Array.prototype.indexOf.call(Mg,f,void 0))||q||_e||v.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ce,Ve]of v)this.g.setRequestHeader(Ce,Ve);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Fu(this),this.u=!0,this.g.send(l),this.u=!1}catch(Ce){Ou(this,Ce)}};function Ou(l,f){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=f,l.m=5,Vu(l),Es(l)}function Vu(l){l.A||(l.A=!0,be(l,"complete"),be(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,be(this,"complete"),be(this,"abort"),Es(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Es(this,!0)),Kt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Bu(this):this.bb())},t.bb=function(){Bu(this)};function Bu(l){if(l.h&&typeof a<"u"&&(!l.v[1]||vn(l)!=4||l.Z()!=2)){if(l.u&&vn(l)==4)Pe(l.Ea,0,l);else if(be(l,"readystatechange"),vn(l)==4){l.h=!1;try{const Ve=l.Z();e:switch(Ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var v;if(!(v=f)){var q;if(q=Ve===0){var _e=String(l.D).match(Hr)[1]||null;!_e&&c.self&&c.self.location&&(_e=c.self.location.protocol.slice(0,-1)),q=!Lg.test(_e?_e.toLowerCase():"")}v=q}if(v)be(l,"complete"),be(l,"success");else{l.m=6;try{var Ce=2<vn(l)?l.g.statusText:""}catch{Ce=""}l.l=Ce+" ["+l.Z()+"]",Vu(l)}}finally{Es(l)}}}}function Es(l,f){if(l.g){Fu(l);const v=l.g,q=l.v[0]?()=>{}:null;l.g=null,l.v=null,f||be(l,"ready");try{v.onreadystatechange=q}catch{}}}function Fu(l){l.I&&(c.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function vn(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<vn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var f=this.g.responseText;return l&&f.indexOf(l)==0&&(f=f.substring(l.length)),Te(f)}};function Uu(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function Og(l){const f={};l=(l.g&&2<=vn(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let q=0;q<l.length;q++){if(W(l[q]))continue;var v=P(l[q]);const _e=v[0];if(v=v[1],typeof v!="string")continue;v=v.trim();const Ce=f[_e]||[];f[_e]=Ce,Ce.push(v)}$(f,function(q){return q.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Eo(l,f,v){return v&&v.internalChannelParams&&v.internalChannelParams[l]||f}function ju(l){this.Aa=0,this.i=[],this.j=new je,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Eo("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Eo("baseRetryDelayMs",5e3,l),this.cb=Eo("retryDelaySeedMs",1e4,l),this.Wa=Eo("forwardChannelMaxRetries",2,l),this.wa=Eo("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new Ps(l&&l.concurrentRequestLimit),this.Da=new Dg,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=ju.prototype,t.la=8,t.G=1,t.connect=function(l,f,v,q){it(0),this.W=l,this.H=f||{},v&&q!==void 0&&(this.H.OSID=v,this.H.OAID=q),this.F=this.X,this.I=Ju(this,null,this.W),Ts(this)};function il(l){if(zu(l),l.G==3){var f=l.U++,v=Er(l.I);if(Ut(v,"SID",l.K),Ut(v,"RID",f),Ut(v,"TYPE","terminate"),xo(l,v),f=new yt(l,l.j,f),f.L=2,f.v=Li(Er(v)),v=!1,c.navigator&&c.navigator.sendBeacon)try{v=c.navigator.sendBeacon(f.v.toString(),"")}catch{}!v&&c.Image&&(new Image().src=f.v,v=!0),v||(f.g=Xu(f.j,null),f.g.ea(f.v)),f.F=Date.now(),Yt(f)}Qu(l)}function xs(l){l.g&&(sl(l),l.g.cancel(),l.g=null)}function zu(l){xs(l),l.u&&(c.clearTimeout(l.u),l.u=null),$s(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&c.clearTimeout(l.s),l.s=null)}function Ts(l){if(!bo(l.h)&&!l.s){l.s=!0;var f=l.Ga;U||I(),B||(U(),B=!0),x.add(f,l),l.B=0}}function Vg(l,f){return _o(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=f.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=It(_(l.Ga,l,f),Ku(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const _e=new yt(this,this.j,l);let Ce=this.o;if(this.S&&(Ce?(Ce=S(Ce),C(Ce,this.S)):Ce=this.S),this.m!==null||this.O||(_e.H=Ce,Ce=null),this.P)e:{for(var f=0,v=0;v<this.i.length;v++){t:{var q=this.i[v];if("__data__"in q.map&&(q=q.map.__data__,typeof q=="string")){q=q.length;break t}q=void 0}if(q===void 0)break;if(f+=q,4096<f){f=v;break e}if(f===4096||v===this.i.length-1){f=v+1;break e}}f=1e3}else f=1e3;f=Gu(this,_e,f),v=Er(this.I),Ut(v,"RID",l),Ut(v,"CVER",22),this.D&&Ut(v,"X-HTTP-Session-Id",this.D),xo(this,v),Ce&&(this.O?f="headers="+encodeURIComponent(String(Mu(Ce)))+"&"+f:this.m&&nl(v,this.m,Ce)),Ln(this.h,_e),this.Ua&&Ut(v,"TYPE","init"),this.P?(Ut(v,"$req",f),Ut(v,"SID","null"),_e.T=!0,pr(_e,v,null)):pr(_e,v,f),this.G=2}}else this.G==3&&(l?qu(this,l):this.i.length==0||bo(this.h)||qu(this))};function qu(l,f){var v;f?v=f.l:v=l.U++;const q=Er(l.I);Ut(q,"SID",l.K),Ut(q,"RID",v),Ut(q,"AID",l.T),xo(l,q),l.m&&l.o&&nl(q,l.m,l.o),v=new yt(l,l.j,v,l.B+1),l.m===null&&(v.H=l.o),f&&(l.i=f.D.concat(l.i)),f=Gu(l,v,1e3),v.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Ln(l.h,v),pr(v,q,f)}function xo(l,f){l.H&&ae(l.H,function(v,q){Ut(f,q,v)}),l.l&&vr({},function(v,q){Ut(f,q,v)})}function Gu(l,f,v){v=Math.min(l.i.length,v);var q=l.l?_(l.l.Na,l.l,l):null;e:{var _e=l.i;let Ce=-1;for(;;){const Ve=["count="+v];Ce==-1?0<v?(Ce=_e[0].g,Ve.push("ofs="+Ce)):Ce=0:Ve.push("ofs="+Ce);let jt=!0;for(let ur=0;ur<v;ur++){let $t=_e[ur].g;const br=_e[ur].map;if($t-=Ce,0>$t)Ce=Math.max(0,_e[ur].g-100),jt=!1;else try{Ng(br,Ve,"req"+$t+"_")}catch{q&&q(br)}}if(jt){q=Ve.join("&");break e}}}return l=l.i.splice(0,v),f.D=l,q}function Hu(l){if(!l.g&&!l.u){l.Y=1;var f=l.Fa;U||I(),B||(U(),B=!0),x.add(f,l),l.v=0}}function ol(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=It(_(l.Fa,l),Ku(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Yu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=It(_(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,it(10),xs(this),Yu(this))};function sl(l){l.A!=null&&(c.clearTimeout(l.A),l.A=null)}function Yu(l){l.g=new yt(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var f=Er(l.qa);Ut(f,"RID","rpc"),Ut(f,"SID",l.K),Ut(f,"AID",l.T),Ut(f,"CI",l.F?"0":"1"),!l.F&&l.ja&&Ut(f,"TO",l.ja),Ut(f,"TYPE","xmlhttp"),xo(l,f),l.m&&l.o&&nl(f,l.m,l.o),l.L&&(l.g.I=l.L);var v=l.g;l=l.ia,v.L=1,v.v=Li(Er(f)),v.m=null,v.P=!0,Bt(v,l)}t.Za=function(){this.C!=null&&(this.C=null,xs(this),ol(this),it(19))};function $s(l){l.C!=null&&(c.clearTimeout(l.C),l.C=null)}function Wu(l,f){var v=null;if(l.g==f){$s(l),sl(l),l.g=null;var q=2}else if(Ni(l.h,f))v=f.D,ws(l.h,f),q=1;else return;if(l.G!=0){if(f.o)if(q==1){v=f.m?f.m.length:0,f=Date.now()-f.F;var _e=l.B;q=Tt(),be(q,new Vt(q,v)),Ts(l)}else Hu(l);else if(_e=f.s,_e==3||_e==0&&0<f.X||!(q==1&&Vg(l,f)||q==2&&ol(l)))switch(v&&0<v.length&&(f=l.h,f.i=f.i.concat(v)),_e){case 1:ci(l,5);break;case 4:ci(l,10);break;case 3:ci(l,6);break;default:ci(l,2)}}}function Ku(l,f){let v=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(v*=2),v*f}function ci(l,f){if(l.j.info("Error code "+f),f==2){var v=_(l.fb,l),q=l.Xa;const _e=!q;q=new Gt(q||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Zr(q,"https"),Li(q),_e?kg(q.toString(),v):Rg(q.toString(),v)}else it(2);l.G=0,l.l&&l.l.sa(f),Qu(l),zu(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),it(2)):(this.j.info("Failed to ping google.com"),it(1))};function Qu(l){if(l.G=0,l.ka=[],l.l){const f=So(l.h);(f.length!=0||l.i.length!=0)&&(k(l.ka,f),k(l.ka,l.i),l.h.i.length=0,L(l.i),l.i.length=0),l.l.ra()}}function Ju(l,f,v){var q=v instanceof Gt?Er(v):new Gt(v);if(q.g!="")f&&(q.g=f+"."+q.g),en(q,q.s);else{var _e=c.location;q=_e.protocol,f=f?f+"."+_e.hostname:_e.hostname,_e=+_e.port;var Ce=new Gt(null);q&&Zr(Ce,q),f&&(Ce.g=f),_e&&en(Ce,_e),v&&(Ce.l=v),q=Ce}return v=l.D,f=l.ya,v&&f&&Ut(q,v,f),Ut(q,"VER",l.la),xo(l,q),q}function Xu(l,f,v){if(f&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=l.Ca&&!l.pa?new Kt(new As({eb:v})):new Kt(l.pa),f.Ha(l.J),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zu(){}t=Zu.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ks(){}ks.prototype.g=function(l,f){return new Rr(l,f)};function Rr(l,f){ue.call(this),this.g=new ju(f),this.l=l,this.h=f&&f.messageUrlParams||null,l=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(l?l["X-WebChannel-Content-Type"]=f.messageContentType:l={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(l?l["X-WebChannel-Client-Profile"]=f.va:l={"X-WebChannel-Client-Profile":f.va}),this.g.S=l,(l=f&&f.Sb)&&!W(l)&&(this.g.m=l),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!W(f)&&(this.g.D=f,l=this.h,l!==null&&f in l&&(l=this.h,f in l&&delete l[f])),this.j=new Oi(this)}M(Rr,ue),Rr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Rr.prototype.close=function(){il(this.g)},Rr.prototype.o=function(l){var f=this.g;if(typeof l=="string"){var v={};v.__data__=l,l=v}else this.u&&(v={},v.__data__=Ue(l),l=v);f.i.push(new Di(f.Ya++,l)),f.G==3&&Ts(f)},Rr.prototype.N=function(){this.g.l=null,delete this.j,il(this.g),delete this.g,Rr.aa.N.call(this)};function ed(l){Ie.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var f=l.__sm__;if(f){e:{for(const v in f){l=v;break e}l=void 0}(this.i=l)&&(l=this.i,f=f!==null&&l in f?f[l]:void 0),this.data=f}else this.data=l}M(ed,Ie);function td(){Ze.call(this),this.status=1}M(td,Ze);function Oi(l){this.g=l}M(Oi,Zu),Oi.prototype.ua=function(){be(this.g,"a")},Oi.prototype.ta=function(l){be(this.g,new ed(l))},Oi.prototype.sa=function(l){be(this.g,new td)},Oi.prototype.ra=function(){be(this.g,"b")},ks.prototype.createWebChannel=ks.prototype.g,Rr.prototype.send=Rr.prototype.o,Rr.prototype.open=Rr.prototype.m,Rr.prototype.close=Rr.prototype.close,zf=function(){return new ks},jf=function(){return Tt()},Uf=dt,nc={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ke.NO_ERROR=0,Ke.TIMEOUT=8,Ke.HTTP_ERROR=6,na=Ke,et.COMPLETE="complete",Ff=et,Xe.EventType=Ae,Ae.OPEN="a",Ae.CLOSE="b",Ae.ERROR="c",Ae.MESSAGE="d",ue.prototype.listen=ue.prototype.K,Lo=Xe,Kt.prototype.listenOnce=Kt.prototype.L,Kt.prototype.getLastError=Kt.prototype.Ka,Kt.prototype.getLastErrorCode=Kt.prototype.Ba,Kt.prototype.getStatus=Kt.prototype.Z,Kt.prototype.getResponseJson=Kt.prototype.Oa,Kt.prototype.getResponseText=Kt.prototype.oa,Kt.prototype.send=Kt.prototype.ea,Kt.prototype.setWithCredentials=Kt.prototype.Ha,Bf=Kt}).apply(typeof Ls<"u"?Ls:typeof self<"u"?self:typeof window<"u"?window:{});const Fd="@firebase/firestore",Ud="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}wr.UNAUTHENTICATED=new wr(null),wr.GOOGLE_CREDENTIALS=new wr("google-credentials-uid"),wr.FIRST_PARTY=new wr("first-party-uid"),wr.MOCK_USER=new wr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fo="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ii=new Rc("@firebase/firestore");function Gi(){return Ii.logLevel}function Ye(t,...e){if(Ii.logLevel<=Pt.DEBUG){const r=e.map(Gc);Ii.debug(`Firestore (${fo}): ${t}`,...r)}}function $n(t,...e){if(Ii.logLevel<=Pt.ERROR){const r=e.map(Gc);Ii.error(`Firestore (${fo}): ${t}`,...r)}}function no(t,...e){if(Ii.logLevel<=Pt.WARN){const r=e.map(Gc);Ii.warn(`Firestore (${fo}): ${t}`,...r)}}function Gc(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ot(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,qf(t,n,r)}function qf(t,e,r){let n=`FIRESTORE (${fo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw $n(n),new Error(n)}function Lt(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||qf(e,i,n)}function ht(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ee={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class qe extends Nn{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gf{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class q_{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(wr.UNAUTHENTICATED))}shutdown(){}}class G_{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class H_{constructor(e){this.t=e,this.currentUser=wr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Lt(this.o===void 0,42304);let n=this.i;const i=d=>this.i!==n?(n=this.i,r(d)):Promise.resolve();let o=new En;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new En,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const d=o;e.enqueueRetryable(async()=>{await d.promise,await i(this.currentUser)})},c=d=>{Ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(d=>c(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?c(d):(Ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new En)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Lt(typeof n.accessToken=="string",31837,{l:n}),new Gf(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Lt(e===null||typeof e=="string",2055,{h:e}),new wr(e)}}class Y_{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=wr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class W_{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new Y_(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(wr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class jd{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class K_{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ur(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Lt(this.o===void 0,3512);const n=o=>{o.error!=null&&Ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const a=o.token!==this.m;return this.m=o.token,Ye("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const i=o=>{Ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):Ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new jd(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Lt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new jd(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q_(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hc{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=Q_(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<r&&(n+=e.charAt(i[o]%62))}return n}}function wt(t,e){return t<e?-1:t>e?1:0}function ic(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),o=e.charAt(n);if(i!==o)return bl(i)===bl(o)?wt(i,o):bl(i)?1:-1}return wt(t.length,e.length)}const J_=55296,X_=57343;function bl(t){const e=t.charCodeAt(0);return e>=J_&&e<=X_}function io(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zd="__name__";class on{constructor(e,r,n){r===void 0?r=0:r>e.length&&ot(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&ot(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return on.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof on?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const o=on.compareSegments(e.get(i),r.get(i));if(o!==0)return o}return wt(e.length,r.length)}static compareSegments(e,r){const n=on.isNumericId(e),i=on.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?on.extractNumericId(e).compare(on.extractNumericId(r)):ic(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Qn.fromString(e.substring(4,e.length-2))}}class qt extends on{construct(e,r,n){return new qt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new qe(Ee.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new qt(r)}static emptyPath(){return new qt([])}}const Z_=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class hr extends on{construct(e,r,n){return new hr(e,r,n)}static isValidIdentifier(e){return Z_.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),hr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===zd}static keyField(){return new hr([zd])}static fromServerFormat(e){const r=[];let n="",i=0;const o=()=>{if(n.length===0)throw new qe(Ee.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new qe(Ee.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[i+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new qe(Ee.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=d,i+=2}else c==="`"?(a=!a,i++):c!=="."||a?(n+=c,i++):(o(),i++)}if(o(),a)throw new qe(Ee.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new hr(r)}static emptyPath(){return new hr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e){this.path=e}static fromPath(e){return new rt(qt.fromString(e))}static fromName(e){return new rt(qt.fromString(e).popFirst(5))}static empty(){return new rt(qt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&qt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return qt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new rt(new qt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hf(t,e,r){if(!r)throw new qe(Ee.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function eS(t,e,r,n){if(e===!0&&n===!0)throw new qe(Ee.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function qd(t){if(!rt.isDocumentKey(t))throw new qe(Ee.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Gd(t){if(rt.isDocumentKey(t))throw new qe(Ee.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Yf(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function ja(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ot(12329,{type:typeof t})}function kn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new qe(Ee.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=ja(t);throw new qe(Ee.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ir(t,e){const r={typeString:t};return e&&(r.value=e),r}function ys(t,e){if(!Yf(t))throw new qe(Ee.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const a=t[n];if(i&&typeof a!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(o!==void 0&&a!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new qe(Ee.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hd=-62135596800,Yd=1e6;class Ht{static now(){return Ht.fromMillis(Date.now())}static fromDate(e){return Ht.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*Yd);return new Ht(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new qe(Ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new qe(Ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<Hd)throw new qe(Ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new qe(Ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Yd}_compareTo(e){return this.seconds===e.seconds?wt(this.nanoseconds,e.nanoseconds):wt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ht._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ys(e,Ht._jsonSchema))return new Ht(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Hd;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ht._jsonSchemaVersion="firestore/timestamp/1.0",Ht._jsonSchema={type:ir("string",Ht._jsonSchemaVersion),seconds:ir("number"),nanoseconds:ir("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{static fromTimestamp(e){return new ut(e)}static min(){return new ut(new Ht(0,0))}static max(){return new ut(new Ht(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ts=-1;function tS(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=ut.fromTimestamp(n===1e9?new Ht(r+1,0):new Ht(r,n));return new Xn(i,rt.empty(),e)}function rS(t){return new Xn(t.readTime,t.key,ts)}class Xn{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Xn(ut.min(),rt.empty(),ts)}static max(){return new Xn(ut.max(),rt.empty(),ts)}}function nS(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=rt.comparator(t.documentKey,e.documentKey),r!==0?r:wt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class oS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yo(t){if(t.code!==Ee.FAILED_PRECONDITION||t.message!==iS)throw t;Ye("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ot(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Re((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Re?r:Re.resolve(r)}catch(r){return Re.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Re.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Re.reject(r)}static resolve(e){return new Re((r,n)=>{r(e)})}static reject(e){return new Re((r,n)=>{n(e)})}static waitFor(e){return new Re((r,n)=>{let i=0,o=0,a=!1;e.forEach(c=>{++i,c.next(()=>{++o,a&&o===i&&r()},d=>n(d))}),a=!0,o===i&&r()})}static or(e){let r=Re.resolve(!1);for(const n of e)r=r.next(i=>i?Re.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,o)=>{n.push(r.call(this,i,o))}),this.waitFor(n)}static mapArray(e,r){return new Re((n,i)=>{const o=e.length,a=new Array(o);let c=0;for(let d=0;d<o;d++){const h=d;r(e[h]).next(m=>{a[h]=m,++c,c===o&&n(a)},m=>i(m))}})}static doWhile(e,r){return new Re((n,i)=>{const o=()=>{e()===!0?r().next(()=>{o()},i):n()};o()})}}function sS(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function go(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}za.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yc=-1;function qa(t){return t==null}function Ca(t){return t===0&&1/t==-1/0}function aS(t){return typeof t=="number"&&Number.isInteger(t)&&!Ca(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wf="";function lS(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=Wd(e)),e=cS(t.get(r),e);return Wd(e)}function cS(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const o=t.charAt(i);switch(o){case"\0":r+="";break;case Wf:r+="";break;default:r+=o}}return r}function Wd(t){return t+Wf+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kd(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function si(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function Kf(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e,r){this.comparator=e,this.root=r||dr.EMPTY}insert(e,r){return new Wt(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,dr.BLACK,null,null))}remove(e){return new Wt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,dr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ms(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ms(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ms(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ms(this.root,e,this.comparator,!0)}}class Ms{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class dr{constructor(e,r,n,i,o){this.key=e,this.value=r,this.color=n??dr.RED,this.left=i??dr.EMPTY,this.right=o??dr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,o){return new dr(e??this.key,r??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,r,n),null):o===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return dr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return dr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,dr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,dr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ot(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ot(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ot(27949);return e+(this.isRed()?0:1)}}dr.EMPTY=null,dr.RED=!0,dr.BLACK=!1;dr.EMPTY=new class{constructor(){this.size=0}get key(){throw ot(57766)}get value(){throw ot(16141)}get color(){throw ot(16727)}get left(){throw ot(29726)}get right(){throw ot(36894)}copy(e,r,n,i,o){return this}insert(e,r,n){return new dr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e){this.comparator=e,this.data=new Wt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Qd(this.data.getIterator())}getIteratorFrom(e){return new Qd(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof ar)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new ar(this.comparator);return r.data=e,r}}class Qd{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e){this.fields=e,e.sort(hr.comparator)}static empty(){return new Lr([])}unionWith(e){let r=new ar(hr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Lr(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return io(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Qf("Invalid base64 string: "+o):o}}(e);return new yr(r)}static fromUint8Array(e){const r=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new yr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return wt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}yr.EMPTY_BYTE_STRING=new yr("");const uS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Zn(t){if(Lt(!!t,39018),typeof t=="string"){let e=0;const r=uS.exec(t);if(Lt(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Qt(t.seconds),nanos:Qt(t.nanos)}}function Qt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ei(t){return typeof t=="string"?yr.fromBase64String(t):yr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jf="server_timestamp",Xf="__type__",Zf="__previous_value__",ey="__local_write_time__";function Wc(t){return(t?.mapValue?.fields||{})[Xf]?.stringValue===Jf}function Ga(t){const e=t.mapValue.fields[Zf];return Wc(e)?Ga(e):e}function rs(t){const e=Zn(t.mapValue.fields[ey].timestampValue);return new Ht(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{constructor(e,r,n,i,o,a,c,d,h,m){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=d,this.useFetchStreams=h,this.isUsingEmulator=m}}const Aa="(default)";class ns{constructor(e,r){this.projectId=e,this.database=r||Aa}static empty(){return new ns("","")}get isDefaultDatabase(){return this.database===Aa}isEqual(e){return e instanceof ns&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ty="__type__",hS="__max__",Os={mapValue:{}},ry="__vector__",Ia="value";function ti(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Wc(t)?4:fS(t)?9007199254740991:mS(t)?10:11:ot(28295,{value:t})}function yn(t,e){if(t===e)return!0;const r=ti(t);if(r!==ti(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return rs(t).isEqual(rs(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const a=Zn(i.timestampValue),c=Zn(o.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return ei(i.bytesValue).isEqual(ei(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return Qt(i.geoPointValue.latitude)===Qt(o.geoPointValue.latitude)&&Qt(i.geoPointValue.longitude)===Qt(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return Qt(i.integerValue)===Qt(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const a=Qt(i.doubleValue),c=Qt(o.doubleValue);return a===c?Ca(a)===Ca(c):isNaN(a)&&isNaN(c)}return!1}(t,e);case 9:return io(t.arrayValue.values||[],e.arrayValue.values||[],yn);case 10:case 11:return function(i,o){const a=i.mapValue.fields||{},c=o.mapValue.fields||{};if(Kd(a)!==Kd(c))return!1;for(const d in a)if(a.hasOwnProperty(d)&&(c[d]===void 0||!yn(a[d],c[d])))return!1;return!0}(t,e);default:return ot(52216,{left:t})}}function is(t,e){return(t.values||[]).find(r=>yn(r,e))!==void 0}function oo(t,e){if(t===e)return 0;const r=ti(t),n=ti(e);if(r!==n)return wt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return wt(t.booleanValue,e.booleanValue);case 2:return function(o,a){const c=Qt(o.integerValue||o.doubleValue),d=Qt(a.integerValue||a.doubleValue);return c<d?-1:c>d?1:c===d?0:isNaN(c)?isNaN(d)?0:-1:1}(t,e);case 3:return Jd(t.timestampValue,e.timestampValue);case 4:return Jd(rs(t),rs(e));case 5:return ic(t.stringValue,e.stringValue);case 6:return function(o,a){const c=ei(o),d=ei(a);return c.compareTo(d)}(t.bytesValue,e.bytesValue);case 7:return function(o,a){const c=o.split("/"),d=a.split("/");for(let h=0;h<c.length&&h<d.length;h++){const m=wt(c[h],d[h]);if(m!==0)return m}return wt(c.length,d.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,a){const c=wt(Qt(o.latitude),Qt(a.latitude));return c!==0?c:wt(Qt(o.longitude),Qt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Xd(t.arrayValue,e.arrayValue);case 10:return function(o,a){const c=o.fields||{},d=a.fields||{},h=c[Ia]?.arrayValue,m=d[Ia]?.arrayValue,g=wt(h?.values?.length||0,m?.values?.length||0);return g!==0?g:Xd(h,m)}(t.mapValue,e.mapValue);case 11:return function(o,a){if(o===Os.mapValue&&a===Os.mapValue)return 0;if(o===Os.mapValue)return 1;if(a===Os.mapValue)return-1;const c=o.fields||{},d=Object.keys(c),h=a.fields||{},m=Object.keys(h);d.sort(),m.sort();for(let g=0;g<d.length&&g<m.length;++g){const _=ic(d[g],m[g]);if(_!==0)return _;const A=oo(c[d[g]],h[m[g]]);if(A!==0)return A}return wt(d.length,m.length)}(t.mapValue,e.mapValue);default:throw ot(23264,{he:r})}}function Jd(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return wt(t,e);const r=Zn(t),n=Zn(e),i=wt(r.seconds,n.seconds);return i!==0?i:wt(r.nanos,n.nanos)}function Xd(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const o=oo(r[i],n[i]);if(o)return o}return wt(r.length,n.length)}function so(t){return oc(t)}function oc(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Zn(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return ei(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return rt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const o of r.values||[])i?i=!1:n+=",",n+=oc(o);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const a of n)o?o=!1:i+=",",i+=`${a}:${oc(r.fields[a])}`;return i+"}"}(t.mapValue):ot(61005,{value:t})}function ia(t){switch(ti(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ga(t);return e?16+ia(e):16;case 5:return 2*t.stringValue.length;case 6:return ei(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,o)=>i+ia(o),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return si(n.fields,(o,a)=>{i+=o.length+ia(a)}),i}(t.mapValue);default:throw ot(13486,{value:t})}}function Zd(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function sc(t){return!!t&&"integerValue"in t}function Kc(t){return!!t&&"arrayValue"in t}function eh(t){return!!t&&"nullValue"in t}function th(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function oa(t){return!!t&&"mapValue"in t}function mS(t){return(t?.mapValue?.fields||{})[ty]?.stringValue===ry}function qo(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return si(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=qo(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=qo(t.arrayValue.values[r]);return e}return{...t}}function fS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===hS}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{constructor(e){this.value=e}static empty(){return new $r({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!oa(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=qo(r)}setAll(e){let r=hr.emptyPath(),n={},i=[];e.forEach((a,c)=>{if(!r.isImmediateParentOf(c)){const d=this.getFieldsMap(r);this.applyChanges(d,n,i),n={},i=[],r=c.popLast()}a?n[c.lastSegment()]=qo(a):i.push(c.lastSegment())});const o=this.getFieldsMap(r);this.applyChanges(o,n,i)}delete(e){const r=this.field(e.popLast());oa(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return yn(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];oa(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){si(r,(i,o)=>e[i]=o);for(const i of n)delete e[i]}clone(){return new $r(qo(this.value))}}function ny(t){const e=[];return si(t.fields,(r,n)=>{const i=new hr([r]);if(oa(n)){const o=ny(n.mapValue).fields;if(o.length===0)e.push(i);else for(const a of o)e.push(i.child(a))}else e.push(i)}),new Lr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e,r,n,i,o,a,c){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=o,this.data=a,this.documentState=c}static newInvalidDocument(e){return new Cr(e,0,ut.min(),ut.min(),ut.min(),$r.empty(),0)}static newFoundDocument(e,r,n,i){return new Cr(e,1,r,ut.min(),n,i,0)}static newNoDocument(e,r){return new Cr(e,2,r,ut.min(),ut.min(),$r.empty(),0)}static newUnknownDocument(e,r){return new Cr(e,3,r,ut.min(),ut.min(),$r.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(ut.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=$r.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=$r.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ut.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Cr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Cr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(e,r){this.position=e,this.inclusive=r}}function rh(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const o=e[i],a=t.position[i];if(o.field.isKeyField()?n=rt.comparator(rt.fromName(a.referenceValue),r.key):n=oo(a,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function nh(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!yn(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e,r="asc"){this.field=e,this.dir=r}}function yS(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy{}class nr extends iy{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new pS(e,r,n):r==="array-contains"?new _S(e,n):r==="in"?new SS(e,n):r==="not-in"?new PS(e,n):r==="array-contains-any"?new wS(e,n):new nr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new vS(e,n):new bS(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(oo(r,this.value)):r!==null&&ti(this.value)===ti(r)&&this.matchesComparison(oo(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ot(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Xr extends iy{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Xr(e,r)}matches(e){return oy(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function oy(t){return t.op==="and"}function sy(t){return gS(t)&&oy(t)}function gS(t){for(const e of t.filters)if(e instanceof Xr)return!1;return!0}function ac(t){if(t instanceof nr)return t.field.canonicalString()+t.op.toString()+so(t.value);if(sy(t))return t.filters.map(e=>ac(e)).join(",");{const e=t.filters.map(r=>ac(r)).join(",");return`${t.op}(${e})`}}function ay(t,e){return t instanceof nr?function(n,i){return i instanceof nr&&n.op===i.op&&n.field.isEqual(i.field)&&yn(n.value,i.value)}(t,e):t instanceof Xr?function(n,i){return i instanceof Xr&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((o,a,c)=>o&&ay(a,i.filters[c]),!0):!1}(t,e):void ot(19439)}function ly(t){return t instanceof nr?function(r){return`${r.field.canonicalString()} ${r.op} ${so(r.value)}`}(t):t instanceof Xr?function(r){return r.op.toString()+" {"+r.getFilters().map(ly).join(" ,")+"}"}(t):"Filter"}class pS extends nr{constructor(e,r,n){super(e,r,n),this.key=rt.fromName(n.referenceValue)}matches(e){const r=rt.comparator(e.key,this.key);return this.matchesComparison(r)}}class vS extends nr{constructor(e,r){super(e,"in",r),this.keys=cy("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class bS extends nr{constructor(e,r){super(e,"not-in",r),this.keys=cy("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function cy(t,e){return(e.arrayValue?.values||[]).map(r=>rt.fromName(r.referenceValue))}class _S extends nr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Kc(r)&&is(r.arrayValue,this.value)}}class SS extends nr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&is(this.value.arrayValue,r)}}class PS extends nr{constructor(e,r){super(e,"not-in",r)}matches(e){if(is(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!is(this.value.arrayValue,r)}}class wS extends nr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Kc(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>is(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CS{constructor(e,r=null,n=[],i=[],o=null,a=null,c=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=a,this.endAt=c,this.Te=null}}function ih(t,e=null,r=[],n=[],i=null,o=null,a=null){return new CS(t,e,r,n,i,o,a)}function Qc(t){const e=ht(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>ac(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),qa(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>so(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>so(n)).join(",")),e.Te=r}return e.Te}function Jc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!yS(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!ay(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!nh(t.startAt,e.startAt)&&nh(t.endAt,e.endAt)}function lc(t){return rt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(e,r=null,n=[],i=[],o=null,a="F",c=null,d=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=a,this.startAt=c,this.endAt=d,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function AS(t,e,r,n,i,o,a,c){return new po(t,e,r,n,i,o,a,c)}function Xc(t){return new po(t)}function oh(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function uy(t){return t.collectionGroup!==null}function Go(t){const e=ht(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new ar(hr.comparator);return a.filters.forEach(d=>{d.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(o=>{r.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new os(o,n))}),r.has(hr.keyField().canonicalString())||e.Ie.push(new os(hr.keyField(),n))}return e.Ie}function cn(t){const e=ht(t);return e.Ee||(e.Ee=IS(e,Go(t))),e.Ee}function IS(t,e){if(t.limitType==="F")return ih(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new os(i.field,o)});const r=t.endAt?new Ea(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Ea(t.startAt.position,t.startAt.inclusive):null;return ih(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function cc(t,e){const r=t.filters.concat([e]);return new po(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function uc(t,e,r){return new po(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Ha(t,e){return Jc(cn(t),cn(e))&&t.limitType===e.limitType}function dy(t){return`${Qc(cn(t))}|lt:${t.limitType}`}function Hi(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>ly(i)).join(", ")}]`),qa(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>so(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>so(i)).join(",")),`Target(${n})`}(cn(t))}; limitType=${t.limitType})`}function Ya(t,e){return e.isFoundDocument()&&function(n,i){const o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):rt.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(t,e)&&function(n,i){for(const o of Go(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,c,d){const h=rh(a,c,d);return a.inclusive?h<=0:h<0}(n.startAt,Go(n),i)||n.endAt&&!function(a,c,d){const h=rh(a,c,d);return a.inclusive?h>=0:h>0}(n.endAt,Go(n),i))}(t,e)}function ES(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function hy(t){return(e,r)=>{let n=!1;for(const i of Go(t)){const o=xS(i,e,r);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function xS(t,e,r){const n=t.field.isKeyField()?rt.comparator(e.key,r.key):function(o,a,c){const d=a.data.field(o),h=c.data.field(o);return d!==null&&h!==null?oo(d,h):ot(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ot(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,o]of n)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){si(this.inner,(r,n)=>{for(const[i,o]of n)e(i,o)})}isEmpty(){return Kf(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TS=new Wt(rt.comparator);function Rn(){return TS}const my=new Wt(rt.comparator);function Mo(...t){let e=my;for(const r of t)e=e.insert(r.key,r);return e}function fy(t){let e=my;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function _i(){return Ho()}function yy(){return Ho()}function Ho(){return new $i(t=>t.toString(),(t,e)=>t.isEqual(e))}const $S=new Wt(rt.comparator),kS=new ar(rt.comparator);function Ct(...t){let e=kS;for(const r of t)e=e.add(r);return e}const RS=new ar(wt);function DS(){return RS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zc(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ca(e)?"-0":e}}function gy(t){return{integerValue:""+t}}function NS(t,e){return aS(e)?gy(e):Zc(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(){this._=void 0}}function LS(t,e,r){return t instanceof xa?function(i,o){const a={fields:{[Xf]:{stringValue:Jf},[ey]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Wc(o)&&(o=Ga(o)),o&&(a.fields[Zf]=o),{mapValue:a}}(r,e):t instanceof ss?vy(t,e):t instanceof as?by(t,e):function(i,o){const a=py(i,o),c=sh(a)+sh(i.Ae);return sc(a)&&sc(i.Ae)?gy(c):Zc(i.serializer,c)}(t,e)}function MS(t,e,r){return t instanceof ss?vy(t,e):t instanceof as?by(t,e):r}function py(t,e){return t instanceof Ta?function(n){return sc(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}class xa extends Wa{}class ss extends Wa{constructor(e){super(),this.elements=e}}function vy(t,e){const r=_y(e);for(const n of t.elements)r.some(i=>yn(i,n))||r.push(n);return{arrayValue:{values:r}}}class as extends Wa{constructor(e){super(),this.elements=e}}function by(t,e){let r=_y(e);for(const n of t.elements)r=r.filter(i=>!yn(i,n));return{arrayValue:{values:r}}}class Ta extends Wa{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function sh(t){return Qt(t.integerValue||t.doubleValue)}function _y(t){return Kc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function OS(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof ss&&i instanceof ss||n instanceof as&&i instanceof as?io(n.elements,i.elements,yn):n instanceof Ta&&i instanceof Ta?yn(n.Ae,i.Ae):n instanceof xa&&i instanceof xa}(t.transform,e.transform)}class VS{constructor(e,r){this.version=e,this.transformResults=r}}class un{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new un}static exists(e){return new un(void 0,e)}static updateTime(e){return new un(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function sa(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ka{}function Sy(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new wy(t.key,un.none()):new gs(t.key,t.data,un.none());{const r=t.data,n=$r.empty();let i=new ar(hr.comparator);for(let o of e.fields)if(!i.has(o)){let a=r.field(o);a===null&&o.length>1&&(o=o.popLast(),a=r.field(o)),a===null?n.delete(o):n.set(o,a),i=i.add(o)}return new ai(t.key,n,new Lr(i.toArray()),un.none())}}function BS(t,e,r){t instanceof gs?function(i,o,a){const c=i.value.clone(),d=lh(i.fieldTransforms,o,a.transformResults);c.setAll(d),o.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,r):t instanceof ai?function(i,o,a){if(!sa(i.precondition,o))return void o.convertToUnknownDocument(a.version);const c=lh(i.fieldTransforms,o,a.transformResults),d=o.data;d.setAll(Py(i)),d.setAll(c),o.convertToFoundDocument(a.version,d).setHasCommittedMutations()}(t,e,r):function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Yo(t,e,r,n){return t instanceof gs?function(o,a,c,d){if(!sa(o.precondition,a))return c;const h=o.value.clone(),m=ch(o.fieldTransforms,d,a);return h.setAll(m),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(t,e,r,n):t instanceof ai?function(o,a,c,d){if(!sa(o.precondition,a))return c;const h=ch(o.fieldTransforms,d,a),m=a.data;return m.setAll(Py(o)),m.setAll(h),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),c===null?null:c.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(g=>g.field))}(t,e,r,n):function(o,a,c){return sa(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(t,e,r)}function FS(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),o=py(n.transform,i||null);o!=null&&(r===null&&(r=$r.empty()),r.set(n.field,o))}return r||null}function ah(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&io(n,i,(o,a)=>OS(o,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class gs extends Ka{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ai extends Ka{constructor(e,r,n,i,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function Py(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function lh(t,e,r){const n=new Map;Lt(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const o=t[i],a=o.transform,c=e.data.field(o.field);n.set(o.field,MS(a,c,r[i]))}return n}function ch(t,e,r){const n=new Map;for(const i of t){const o=i.transform,a=r.data.field(i.field);n.set(i.field,LS(o,a,e))}return n}class wy extends Ka{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class US extends Ka{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&BS(o,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Yo(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Yo(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=yy();return this.mutations.forEach(i=>{const o=e.get(i.key),a=o.overlayedDocument;let c=this.applyToLocalView(a,o.mutatedFields);c=r.has(i.key)?null:c;const d=Sy(a,c);d!==null&&n.set(i.key,d),a.isValidDocument()||a.convertToNoDocument(ut.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Ct())}isEqual(e){return this.batchId===e.batchId&&io(this.mutations,e.mutations,(r,n)=>ah(r,n))&&io(this.baseMutations,e.baseMutations,(r,n)=>ah(r,n))}}class eu{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Lt(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return $S}();const o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,n[a].version);return new eu(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zS{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qS{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rr,xt;function GS(t){switch(t){case Ee.OK:return ot(64938);case Ee.CANCELLED:case Ee.UNKNOWN:case Ee.DEADLINE_EXCEEDED:case Ee.RESOURCE_EXHAUSTED:case Ee.INTERNAL:case Ee.UNAVAILABLE:case Ee.UNAUTHENTICATED:return!1;case Ee.INVALID_ARGUMENT:case Ee.NOT_FOUND:case Ee.ALREADY_EXISTS:case Ee.PERMISSION_DENIED:case Ee.FAILED_PRECONDITION:case Ee.ABORTED:case Ee.OUT_OF_RANGE:case Ee.UNIMPLEMENTED:case Ee.DATA_LOSS:return!0;default:return ot(15467,{code:t})}}function Cy(t){if(t===void 0)return $n("GRPC error has no .code"),Ee.UNKNOWN;switch(t){case rr.OK:return Ee.OK;case rr.CANCELLED:return Ee.CANCELLED;case rr.UNKNOWN:return Ee.UNKNOWN;case rr.DEADLINE_EXCEEDED:return Ee.DEADLINE_EXCEEDED;case rr.RESOURCE_EXHAUSTED:return Ee.RESOURCE_EXHAUSTED;case rr.INTERNAL:return Ee.INTERNAL;case rr.UNAVAILABLE:return Ee.UNAVAILABLE;case rr.UNAUTHENTICATED:return Ee.UNAUTHENTICATED;case rr.INVALID_ARGUMENT:return Ee.INVALID_ARGUMENT;case rr.NOT_FOUND:return Ee.NOT_FOUND;case rr.ALREADY_EXISTS:return Ee.ALREADY_EXISTS;case rr.PERMISSION_DENIED:return Ee.PERMISSION_DENIED;case rr.FAILED_PRECONDITION:return Ee.FAILED_PRECONDITION;case rr.ABORTED:return Ee.ABORTED;case rr.OUT_OF_RANGE:return Ee.OUT_OF_RANGE;case rr.UNIMPLEMENTED:return Ee.UNIMPLEMENTED;case rr.DATA_LOSS:return Ee.DATA_LOSS;default:return ot(39323,{code:t})}}(xt=rr||(rr={}))[xt.OK=0]="OK",xt[xt.CANCELLED=1]="CANCELLED",xt[xt.UNKNOWN=2]="UNKNOWN",xt[xt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",xt[xt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",xt[xt.NOT_FOUND=5]="NOT_FOUND",xt[xt.ALREADY_EXISTS=6]="ALREADY_EXISTS",xt[xt.PERMISSION_DENIED=7]="PERMISSION_DENIED",xt[xt.UNAUTHENTICATED=16]="UNAUTHENTICATED",xt[xt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",xt[xt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",xt[xt.ABORTED=10]="ABORTED",xt[xt.OUT_OF_RANGE=11]="OUT_OF_RANGE",xt[xt.UNIMPLEMENTED=12]="UNIMPLEMENTED",xt[xt.INTERNAL=13]="INTERNAL",xt[xt.UNAVAILABLE=14]="UNAVAILABLE",xt[xt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HS(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YS=new Qn([4294967295,4294967295],0);function uh(t){const e=HS().encode(t),r=new Vf;return r.update(e),new Uint8Array(r.digest())}function dh(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Qn([r,n],0),new Qn([i,o],0)]}class tu{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Oo(`Invalid padding: ${r}`);if(n<0)throw new Oo(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Oo(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Oo(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Qn.fromNumber(this.ge)}ye(e,r,n){let i=e.add(r.multiply(Qn.fromNumber(n)));return i.compare(YS)===1&&(i=new Qn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=uh(e),[n,i]=dh(r);for(let o=0;o<this.hashCount;o++){const a=this.ye(n,i,o);if(!this.we(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new tu(o,i,r);return n.forEach(c=>a.insert(c)),a}insert(e){if(this.ge===0)return;const r=uh(e),[n,i]=dh(r);for(let o=0;o<this.hashCount;o++){const a=this.ye(n,i,o);this.Se(a)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Oo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(e,r,n,i,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,ps.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Qa(ut.min(),i,new Wt(wt),Rn(),Ct())}}class ps{constructor(e,r,n,i,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new ps(n,r,Ct(),Ct(),Ct())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aa{constructor(e,r,n,i){this.be=e,this.removedTargetIds=r,this.key=n,this.De=i}}class Ay{constructor(e,r){this.targetId=e,this.Ce=r}}class Iy{constructor(e,r,n=yr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class hh{constructor(){this.ve=0,this.Fe=mh(),this.Me=yr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ct(),r=Ct(),n=Ct();return this.Fe.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:ot(38017,{changeType:o})}}),new ps(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=mh()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Lt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class WS{constructor(e){this.Ge=e,this.ze=new Map,this.je=Rn(),this.Je=Vs(),this.He=Vs(),this.Ye=new Wt(wt)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:ot(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,i)=>{this.rt(i)&&r(i)})}st(e){const r=e.targetId,n=e.Ce.count,i=this.ot(r);if(i){const o=i.target;if(lc(o))if(n===0){const a=new rt(o.path);this.et(r,a,Cr.newNoDocument(a,ut.min()))}else Lt(n===1,20013,{expectedCount:n});else{const a=this._t(r);if(a!==n){const c=this.ut(e),d=c?this.ct(c,e,a):1;if(d!==0){this.it(r);const h=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,h)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=r;let a,c;try{a=ei(n).toUint8Array()}catch(d){if(d instanceof Qf)return no("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{c=new tu(a,i,o)}catch(d){return no(d instanceof Oo?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return c.ge===0?null:c}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let i=0;return n.forEach(o=>{const a=this.Ge.ht(),c=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(c)||(this.et(r,o,null),i++)}),i}Tt(e){const r=new Map;this.ze.forEach((o,a)=>{const c=this.ot(a);if(c){if(o.current&&lc(c.target)){const d=new rt(c.target.path);this.It(d).has(a)||this.Et(a,d)||this.et(a,d,Cr.newNoDocument(d,e))}o.Be&&(r.set(a,o.ke()),o.qe())}});let n=Ct();this.He.forEach((o,a)=>{let c=!0;a.forEachWhile(d=>{const h=this.ot(d);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(o))}),this.je.forEach((o,a)=>a.setReadTime(e));const i=new Qa(e,r,this.Ye,this.je,n);return this.je=Rn(),this.Je=Vs(),this.He=Vs(),this.Ye=new Wt(wt),i}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,r)?i.Qe(r,1):i.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new hh,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new ar(wt),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new ar(wt),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Ye("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new hh),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Vs(){return new Wt(rt.comparator)}function mh(){return new Wt(rt.comparator)}const KS={asc:"ASCENDING",desc:"DESCENDING"},QS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},JS={and:"AND",or:"OR"};class XS{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function dc(t,e){return t.useProto3Json||qa(e)?e:{value:e}}function $a(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ey(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function ZS(t,e){return $a(t,e.toTimestamp())}function dn(t){return Lt(!!t,49232),ut.fromTimestamp(function(r){const n=Zn(r);return new Ht(n.seconds,n.nanos)}(t))}function ru(t,e){return hc(t,e).canonicalString()}function hc(t,e){const r=function(i){return new qt(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function xy(t){const e=qt.fromString(t);return Lt(Dy(e),10190,{key:e.toString()}),e}function mc(t,e){return ru(t.databaseId,e.path)}function _l(t,e){const r=xy(e);if(r.get(1)!==t.databaseId.projectId)throw new qe(Ee.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new qe(Ee.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new rt($y(r))}function Ty(t,e){return ru(t.databaseId,e)}function e1(t){const e=xy(t);return e.length===4?qt.emptyPath():$y(e)}function fc(t){return new qt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function $y(t){return Lt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function fh(t,e,r){return{name:mc(t,e),fields:r.value.mapValue.fields}}function t1(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:ot(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(h,m){return h.useProto3Json?(Lt(m===void 0||typeof m=="string",58123),yr.fromBase64String(m||"")):(Lt(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),yr.fromUint8Array(m||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(h){const m=h.code===void 0?Ee.UNKNOWN:Cy(h.code);return new qe(m,h.message||"")}(a);r=new Iy(n,i,o,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=_l(t,n.document.name),o=dn(n.document.updateTime),a=n.document.createTime?dn(n.document.createTime):ut.min(),c=new $r({mapValue:{fields:n.document.fields}}),d=Cr.newFoundDocument(i,o,a,c),h=n.targetIds||[],m=n.removedTargetIds||[];r=new aa(h,m,d.key,d)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=_l(t,n.document),o=n.readTime?dn(n.readTime):ut.min(),a=Cr.newNoDocument(i,o),c=n.removedTargetIds||[];r=new aa([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=_l(t,n.document),o=n.removedTargetIds||[];r=new aa([],o,i,null)}else{if(!("filter"in e))return ot(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:o}=n,a=new qS(i,o),c=n.targetId;r=new Ay(c,a)}}return r}function r1(t,e){let r;if(e instanceof gs)r={update:fh(t,e.key,e.value)};else if(e instanceof wy)r={delete:mc(t,e.key)};else if(e instanceof ai)r={update:fh(t,e.key,e.data),updateMask:d1(e.fieldMask)};else{if(!(e instanceof US))return ot(16599,{Vt:e.type});r={verify:mc(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(o,a){const c=a.transform;if(c instanceof xa)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof ss)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof as)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Ta)return{fieldPath:a.field.canonicalString(),increment:c.Ae};throw ot(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:ZS(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:ot(27497)}(t,e.precondition)),r}function n1(t,e){return t&&t.length>0?(Lt(e!==void 0,14353),t.map(r=>function(i,o){let a=i.updateTime?dn(i.updateTime):dn(o);return a.isEqual(ut.min())&&(a=dn(o)),new VS(a,i.transformResults||[])}(r,e))):[]}function i1(t,e){return{documents:[Ty(t,e.path)]}}function o1(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Ty(t,i);const o=function(h){if(h.length!==0)return Ry(Xr.create(h,"and"))}(e.filters);o&&(r.structuredQuery.where=o);const a=function(h){if(h.length!==0)return h.map(m=>function(_){return{field:Yi(_.field),direction:l1(_.dir)}}(m))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const c=dc(t,e.limit);return c!==null&&(r.structuredQuery.limit=c),e.startAt&&(r.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ft:r,parent:i}}function s1(t){let e=e1(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Lt(n===1,65062);const m=r.from[0];m.allDescendants?i=m.collectionId:e=e.child(m.collectionId)}let o=[];r.where&&(o=function(g){const _=ky(g);return _ instanceof Xr&&sy(_)?_.getFilters():[_]}(r.where));let a=[];r.orderBy&&(a=function(g){return g.map(_=>function(M){return new os(Wi(M.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(M.direction))}(_))}(r.orderBy));let c=null;r.limit&&(c=function(g){let _;return _=typeof g=="object"?g.value:g,qa(_)?null:_}(r.limit));let d=null;r.startAt&&(d=function(g){const _=!!g.before,A=g.values||[];return new Ea(A,_)}(r.startAt));let h=null;return r.endAt&&(h=function(g){const _=!g.before,A=g.values||[];return new Ea(A,_)}(r.endAt)),AS(e,i,a,o,c,"F",d,h)}function a1(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ot(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function ky(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Wi(r.unaryFilter.field);return nr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Wi(r.unaryFilter.field);return nr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Wi(r.unaryFilter.field);return nr.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Wi(r.unaryFilter.field);return nr.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ot(61313);default:return ot(60726)}}(t):t.fieldFilter!==void 0?function(r){return nr.create(Wi(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ot(58110);default:return ot(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Xr.create(r.compositeFilter.filters.map(n=>ky(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ot(1026)}}(r.compositeFilter.op))}(t):ot(30097,{filter:t})}function l1(t){return KS[t]}function c1(t){return QS[t]}function u1(t){return JS[t]}function Yi(t){return{fieldPath:t.canonicalString()}}function Wi(t){return hr.fromServerFormat(t.fieldPath)}function Ry(t){return t instanceof nr?function(r){if(r.op==="=="){if(th(r.value))return{unaryFilter:{field:Yi(r.field),op:"IS_NAN"}};if(eh(r.value))return{unaryFilter:{field:Yi(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(th(r.value))return{unaryFilter:{field:Yi(r.field),op:"IS_NOT_NAN"}};if(eh(r.value))return{unaryFilter:{field:Yi(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Yi(r.field),op:c1(r.op),value:r.value}}}(t):t instanceof Xr?function(r){const n=r.getFilters().map(i=>Ry(i));return n.length===1?n[0]:{compositeFilter:{op:u1(r.op),filters:n}}}(t):ot(54877,{filter:t})}function d1(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function Dy(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e,r,n,i,o=ut.min(),a=ut.min(),c=yr.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=d}withSequenceNumber(e){return new Gn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Gn(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Gn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Gn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1{constructor(e){this.yt=e}}function m1(t){const e=s1({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?uc(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f1{constructor(){this.Cn=new y1}addToCollectionParentIndex(e,r){return this.Cn.add(r),Re.resolve()}getCollectionParents(e,r){return Re.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return Re.resolve()}deleteFieldIndex(e,r){return Re.resolve()}deleteAllFieldIndexes(e){return Re.resolve()}createTargetIndexes(e,r){return Re.resolve()}getDocumentsMatchingTarget(e,r){return Re.resolve(null)}getIndexType(e,r){return Re.resolve(0)}getFieldIndexes(e,r){return Re.resolve([])}getNextCollectionGroupToUpdate(e){return Re.resolve(null)}getMinOffset(e,r){return Re.resolve(Xn.min())}getMinOffsetFromCollectionGroup(e,r){return Re.resolve(Xn.min())}updateCollectionGroup(e,r,n){return Re.resolve()}updateIndexEntries(e,r){return Re.resolve()}}class y1{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new ar(qt.comparator),o=!i.has(n);return this.index[r]=i.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new ar(qt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yh={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Ny=41943040;class Tr{static withCacheSize(e){return new Tr(e,Tr.DEFAULT_COLLECTION_PERCENTILE,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Tr.DEFAULT_COLLECTION_PERCENTILE=10,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Tr.DEFAULT=new Tr(Ny,Tr.DEFAULT_COLLECTION_PERCENTILE,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Tr.DISABLED=new Tr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ao(0)}static cr(){return new ao(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gh="LruGarbageCollector",g1=1048576;function ph([t,e],[r,n]){const i=wt(t,r);return i===0?wt(e,n):i}class p1{constructor(e){this.Ir=e,this.buffer=new ar(ph),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();ph(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class v1{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ye(gh,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){go(r)?Ye(gh,"Ignoring IndexedDB error during garbage collection: ",r):await yo(r)}await this.Vr(3e5)})}}class b1{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Re.resolve(za.ce);const n=new p1(r);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Ye("LruGarbageCollector","Garbage collection skipped; disabled"),Re.resolve(yh)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ye("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),yh):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,o,a,c,d,h;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(Ye("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,a=Date.now(),this.nthSequenceNumber(e,i))).next(g=>(n=g,c=Date.now(),this.removeTargets(e,n,r))).next(g=>(o=g,d=Date.now(),this.removeOrphanedDocuments(e,n))).next(g=>(h=Date.now(),Gi()<=Pt.DEBUG&&Ye("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-m}ms
	Determined least recently used ${i} in `+(c-a)+`ms
	Removed ${o} targets in `+(d-c)+`ms
	Removed ${g} documents in `+(h-d)+`ms
Total Duration: ${h-m}ms`),Re.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:g})))}}function _1(t,e){return new b1(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S1{constructor(){this.changes=new $i(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Cr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Re.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P1{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Yo(n.mutation,i,Lr.empty(),Ht.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Ct()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Ct()){const i=_i();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(o=>{let a=Mo();return o.forEach((c,d)=>{a=a.insert(c,d.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=_i();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Ct()))}populateOverlays(e,r,n){const i=[];return n.forEach(o=>{r.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,c)=>{r.set(a,c)})})}computeViews(e,r,n,i){let o=Rn();const a=Ho(),c=function(){return Ho()}();return r.forEach((d,h)=>{const m=n.get(h.key);i.has(h.key)&&(m===void 0||m.mutation instanceof ai)?o=o.insert(h.key,h):m!==void 0?(a.set(h.key,m.mutation.getFieldMask()),Yo(m.mutation,h,m.mutation.getFieldMask(),Ht.now())):a.set(h.key,Lr.empty())}),this.recalculateAndSaveOverlays(e,o).next(d=>(d.forEach((h,m)=>a.set(h,m)),r.forEach((h,m)=>c.set(h,new P1(m,a.get(h)??null))),c))}recalculateAndSaveOverlays(e,r){const n=Ho();let i=new Wt((a,c)=>a-c),o=Ct();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const c of a)c.keys().forEach(d=>{const h=r.get(d);if(h===null)return;let m=n.get(d)||Lr.empty();m=c.applyToLocalView(h,m),n.set(d,m);const g=(i.get(c.batchId)||Ct()).add(d);i=i.insert(c.batchId,g)})}).next(()=>{const a=[],c=i.getReverseIterator();for(;c.hasNext();){const d=c.getNext(),h=d.key,m=d.value,g=yy();m.forEach(_=>{if(!o.has(_)){const A=Sy(r.get(_),n.get(_));A!==null&&g.set(_,A),o=o.add(_)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,g))}return Re.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return rt.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):uy(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(o=>{const a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-o.size):Re.resolve(_i());let c=ts,d=o;return a.next(h=>Re.forEach(h,(m,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),o.get(m)?Re.resolve():this.remoteDocumentCache.getEntry(e,m).next(_=>{d=d.insert(m,_)}))).next(()=>this.populateOverlays(e,h,o)).next(()=>this.computeViews(e,d,h,Ct())).next(m=>({batchId:c,changes:fy(m)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new rt(r)).next(n=>{let i=Mo();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const o=r.collectionGroup;let a=Mo();return this.indexManager.getCollectionParents(e,o).next(c=>Re.forEach(c,d=>{const h=function(g,_){return new po(_,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(r,d.child(o));return this.getDocumentsMatchingCollectionQuery(e,h,n,i).next(m=>{m.forEach((g,_)=>{a=a.insert(g,_)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,i))).next(a=>{o.forEach((d,h)=>{const m=h.getKey();a.get(m)===null&&(a=a.insert(m,Cr.newInvalidDocument(m)))});let c=Mo();return a.forEach((d,h)=>{const m=o.get(d);m!==void 0&&Yo(m.mutation,h,Lr.empty(),Ht.now()),Ya(r,h)&&(c=c.insert(d,h))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C1{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return Re.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:dn(i.createTime)}}(r)),Re.resolve()}getNamedQuery(e,r){return Re.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(i){return{name:i.name,query:m1(i.bundledQuery),readTime:dn(i.readTime)}}(r)),Re.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1{constructor(){this.overlays=new Wt(rt.comparator),this.qr=new Map}getOverlay(e,r){return Re.resolve(this.overlays.get(r))}getOverlays(e,r){const n=_i();return Re.forEach(r,i=>this.getOverlay(e,i).next(o=>{o!==null&&n.set(i,o)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,o)=>{this.St(e,r,o)}),Re.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.qr.delete(n)),Re.resolve()}getOverlaysForCollection(e,r,n){const i=_i(),o=r.length+1,a=new rt(r.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const d=c.getNext().value,h=d.getKey();if(!r.isPrefixOf(h.path))break;h.path.length===o&&d.largestBatchId>n&&i.set(d.getKey(),d)}return Re.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let o=new Wt((h,m)=>h-m);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===r&&h.largestBatchId>n){let m=o.get(h.largestBatchId);m===null&&(m=_i(),o=o.insert(h.largestBatchId,m)),m.set(h.getKey(),h)}}const c=_i(),d=o.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((h,m)=>c.set(h,m)),!(c.size()>=i)););return Re.resolve(c)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new zS(r,n));let o=this.qr.get(r);o===void 0&&(o=Ct(),this.qr.set(r,o)),this.qr.set(r,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I1{constructor(){this.sessionToken=yr.EMPTY_BYTE_STRING}getSessionToken(e){return Re.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Re.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu{constructor(){this.Qr=new ar(lr.$r),this.Ur=new ar(lr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new lr(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new lr(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new rt(new qt([])),n=new lr(r,e),i=new lr(r,e+1),o=[];return this.Ur.forEachInRange([n,i],a=>{this.Gr(a),o.push(a.key)}),o}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new rt(new qt([])),n=new lr(r,e),i=new lr(r,e+1);let o=Ct();return this.Ur.forEachInRange([n,i],a=>{o=o.add(a.key)}),o}containsKey(e){const r=new lr(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class lr{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return rt.comparator(e.key,r.key)||wt(e.Yr,r.Yr)}static Kr(e,r){return wt(e.Yr,r.Yr)||rt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E1{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new ar(lr.$r)}checkEmpty(e){return Re.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new jS(o,r,n,i);this.mutationQueue.push(a);for(const c of i)this.Zr=this.Zr.add(new lr(c.key,o)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return Re.resolve(a)}lookupMutationBatch(e,r){return Re.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),o=i<0?0:i;return Re.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return Re.resolve(this.mutationQueue.length===0?Yc:this.tr-1)}getAllMutationBatches(e){return Re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new lr(r,0),i=new lr(r,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,i],a=>{const c=this.Xr(a.Yr);o.push(c)}),Re.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new ar(wt);return r.forEach(i=>{const o=new lr(i,0),a=new lr(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,a],c=>{n=n.add(c.Yr)})}),Re.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let o=n;rt.isDocumentKey(o)||(o=o.child(""));const a=new lr(new rt(o),0);let c=new ar(wt);return this.Zr.forEachWhile(d=>{const h=d.key.path;return!!n.isPrefixOf(h)&&(h.length===i&&(c=c.add(d.Yr)),!0)},a),Re.resolve(this.ti(c))}ti(e){const r=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Lt(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return Re.forEach(r.mutations,i=>{const o=new lr(i.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new lr(r,0),i=this.Zr.firstAfterOrEqual(n);return Re.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Re.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(e){this.ri=e,this.docs=function(){return new Wt(rt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),o=i?i.size:0,a=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Re.resolve(n?n.document.mutableCopy():Cr.newInvalidDocument(r))}getEntries(e,r){let n=Rn();return r.forEach(i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():Cr.newInvalidDocument(i))}),Re.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let o=Rn();const a=r.path,c=new rt(a.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(c);for(;d.hasNext();){const{key:h,value:{document:m}}=d.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||nS(rS(m),n)<=0||(i.has(m.key)||Ya(r,m))&&(o=o.insert(m.key,m.mutableCopy()))}return Re.resolve(o)}getAllFromCollectionGroup(e,r,n,i){ot(9500)}ii(e,r){return Re.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new T1(this)}getSize(e){return Re.resolve(this.size)}}class T1 extends S1{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),Re.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $1{constructor(e){this.persistence=e,this.si=new $i(r=>Qc(r),Jc),this.lastRemoteSnapshotVersion=ut.min(),this.highestTargetId=0,this.oi=0,this._i=new nu,this.targetCount=0,this.ai=ao.ur()}forEachTarget(e,r){return this.si.forEach((n,i)=>r(i)),Re.resolve()}getLastRemoteSnapshotVersion(e){return Re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Re.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Re.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),Re.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new ao(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,Re.resolve()}updateTargetData(e,r){return this.Pr(r),Re.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,Re.resolve()}removeTargets(e,r,n){let i=0;const o=[];return this.si.forEach((a,c)=>{c.sequenceNumber<=r&&n.get(c.targetId)===null&&(this.si.delete(a),o.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),Re.waitFor(o).next(()=>i)}getTargetCount(e){return Re.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return Re.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),Re.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,o=[];return i&&r.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),Re.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),Re.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return Re.resolve(n)}containsKey(e,r){return Re.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ly{constructor(e,r){this.ui={},this.overlays={},this.ci=new za(0),this.li=!1,this.li=!0,this.hi=new I1,this.referenceDelegate=e(this),this.Pi=new $1(this),this.indexManager=new f1,this.remoteDocumentCache=function(i){return new x1(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new h1(r),this.Ii=new C1(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new A1,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new E1(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Ye("MemoryPersistence","Starting transaction:",e);const i=new k1(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ai(e,r){return Re.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class k1 extends oS{constructor(e){super(),this.currentSequenceNumber=e}}class iu{constructor(e){this.persistence=e,this.Ri=new nu,this.Vi=null}static mi(e){return new iu(e)}get fi(){if(this.Vi)return this.Vi;throw ot(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),Re.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),Re.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),Re.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(o=>this.fi.add(o.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Re.forEach(this.fi,n=>{const i=rt.fromPath(n);return this.gi(e,i).next(o=>{o||r.removeEntry(i,ut.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return Re.or([()=>Re.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class ka{constructor(e,r){this.persistence=e,this.pi=new $i(n=>lS(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=_1(this,r)}static mi(e,r){return new ka(e,r)}Ei(){}di(e){return Re.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return Re.forEach(this.pi,(n,i)=>this.br(e,n,i).next(o=>o?Re.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(e,a=>this.br(e,a,r).next(c=>{c||(n++,o.removeEntry(a,ut.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),Re.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Re.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Re.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),Re.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=ia(e.data.value)),r}br(e,r,n){return Re.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.pi.get(r);return Re.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=Ct(),i=Ct();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new ou(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R1{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return wv()?8:sS(Ir())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const o={result:null};return this.ys(e,r).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.ws(e,r,i,n).next(a=>{o.result=a})}).next(()=>{if(o.result)return;const a=new R1;return this.Ss(e,r,a).next(c=>{if(o.result=c,this.Vs)return this.bs(e,r,a,c.size)})}).next(()=>o.result)}bs(e,r,n,i){return n.documentReadCount<this.fs?(Gi()<=Pt.DEBUG&&Ye("QueryEngine","SDK will not create cache indexes for query:",Hi(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Re.resolve()):(Gi()<=Pt.DEBUG&&Ye("QueryEngine","Query:",Hi(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(Gi()<=Pt.DEBUG&&Ye("QueryEngine","The SDK decides to create cache indexes for query:",Hi(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,cn(r))):Re.resolve())}ys(e,r){if(oh(r))return Re.resolve(null);let n=cn(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=uc(r,null,"F"),n=cn(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const a=Ct(...o);return this.ps.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,n).next(d=>{const h=this.Ds(r,c);return this.Cs(r,h,a,d.readTime)?this.ys(e,uc(r,null,"F")):this.vs(e,h,r,d)}))})))}ws(e,r,n,i){return oh(r)||i.isEqual(ut.min())?Re.resolve(null):this.ps.getDocuments(e,n).next(o=>{const a=this.Ds(r,o);return this.Cs(r,a,n,i)?Re.resolve(null):(Gi()<=Pt.DEBUG&&Ye("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Hi(r)),this.vs(e,a,r,tS(i,ts)).next(c=>c))})}Ds(e,r){let n=new ar(hy(e));return r.forEach((i,o)=>{Ya(e,o)&&(n=n.add(o))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(e,r,n){return Gi()<=Pt.DEBUG&&Ye("QueryEngine","Using full collection scan to execute query:",Hi(r)),this.ps.getDocumentsMatchingQuery(e,r,Xn.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(o=>(r.forEach(a=>{o=o.insert(a.key,a)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const su="LocalStore",N1=3e8;class L1{constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new Wt(wt),this.xs=new $i(o=>Qc(o),Jc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new w1(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function M1(t,e,r,n){return new L1(t,e,r,n)}async function My(t,e){const r=ht(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(o=>{const a=[],c=[];let d=Ct();for(const h of i){a.push(h.batchId);for(const m of h.mutations)d=d.add(m.key)}for(const h of o){c.push(h.batchId);for(const m of h.mutations)d=d.add(m.key)}return r.localDocuments.getDocuments(n,d).next(h=>({Ls:h,removedBatchIds:a,addedBatchIds:c}))})})}function O1(t,e){const r=ht(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),o=r.Ns.newChangeBuffer({trackRemovals:!0});return function(c,d,h,m){const g=h.batch,_=g.keys();let A=Re.resolve();return _.forEach(M=>{A=A.next(()=>m.getEntry(d,M)).next(L=>{const k=h.docVersions.get(M);Lt(k!==null,48541),L.version.compareTo(k)<0&&(g.applyToRemoteDocument(L,h),L.isValidDocument()&&(L.setReadTime(h.commitVersion),m.addEntry(L)))})}),A.next(()=>c.mutationQueue.removeMutationBatch(d,g))}(r,n,e,o).next(()=>o.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let d=Ct();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(d=d.add(c.batch.mutations[h].key));return d}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function Oy(t){const e=ht(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function V1(t,e){const r=ht(t),n=e.snapshotVersion;let i=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const a=r.Ns.newChangeBuffer({trackRemovals:!0});i=r.Ms;const c=[];e.targetChanges.forEach((m,g)=>{const _=i.get(g);if(!_)return;c.push(r.Pi.removeMatchingKeys(o,m.removedDocuments,g).next(()=>r.Pi.addMatchingKeys(o,m.addedDocuments,g)));let A=_.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(g)!==null?A=A.withResumeToken(yr.EMPTY_BYTE_STRING,ut.min()).withLastLimboFreeSnapshotVersion(ut.min()):m.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(m.resumeToken,n)),i=i.insert(g,A),function(L,k,R){return L.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-L.snapshotVersion.toMicroseconds()>=N1?!0:R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size>0}(_,A,m)&&c.push(r.Pi.updateTargetData(o,A))});let d=Rn(),h=Ct();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&c.push(r.persistence.referenceDelegate.updateLimboDocument(o,m))}),c.push(B1(o,a,e.documentUpdates).next(m=>{d=m.ks,h=m.qs})),!n.isEqual(ut.min())){const m=r.Pi.getLastRemoteSnapshotVersion(o).next(g=>r.Pi.setTargetsMetadata(o,o.currentSequenceNumber,n));c.push(m)}return Re.waitFor(c).next(()=>a.apply(o)).next(()=>r.localDocuments.getLocalViewOfDocuments(o,d,h)).next(()=>d)}).then(o=>(r.Ms=i,o))}function B1(t,e,r){let n=Ct(),i=Ct();return r.forEach(o=>n=n.add(o)),e.getEntries(t,n).next(o=>{let a=Rn();return r.forEach((c,d)=>{const h=o.get(c);d.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(c)),d.isNoDocument()&&d.version.isEqual(ut.min())?(e.removeEntry(c,d.readTime),a=a.insert(c,d)):!h.isValidDocument()||d.version.compareTo(h.version)>0||d.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(d),a=a.insert(c,d)):Ye(su,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",d.version)}),{ks:a,qs:i}})}function F1(t,e){const r=ht(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Yc),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function U1(t,e){const r=ht(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Pi.getTargetData(n,e).next(o=>o?(i=o,Re.resolve(i)):r.Pi.allocateTargetId(n).next(a=>(i=new Gn(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function yc(t,e,r){const n=ht(t),i=n.Ms.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!go(a))throw a;Ye(su,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function vh(t,e,r){const n=ht(t);let i=ut.min(),o=Ct();return n.persistence.runTransaction("Execute query","readwrite",a=>function(d,h,m){const g=ht(d),_=g.xs.get(m);return _!==void 0?Re.resolve(g.Ms.get(_)):g.Pi.getTargetData(h,m)}(n,a,cn(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,c.targetId).next(d=>{o=d})}).next(()=>n.Fs.getDocumentsMatchingQuery(a,e,r?i:ut.min(),r?o:Ct())).next(c=>(j1(n,ES(e),c),{documents:c,Qs:o})))}function j1(t,e,r){let n=t.Os.get(e)||ut.min();r.forEach((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),t.Os.set(e,n)}class bh{constructor(){this.activeTargetIds=DS()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class z1{constructor(){this.Mo=new bh,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new bh,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q1{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _h="ConnectivityMonitor";class Sh{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ye(_h,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ye(_h,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bs=null;function gc(){return Bs===null?Bs=function(){return 268435456+Math.round(2147483648*Math.random())}():Bs++,"0x"+Bs.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sl="RestConnection",G1={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class H1{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===Aa?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,o){const a=gc(),c=this.zo(e,r.toUriEncodedString());Ye(Sl,`Sending RPC '${e}' ${a}:`,c,n);const d={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(d,i,o);const{host:h}=new URL(c),m=uo(h);return this.Jo(e,c,d,n,m).then(g=>(Ye(Sl,`Received RPC '${e}' ${a}: `,g),g),g=>{throw no(Sl,`RPC '${e}' ${a} failed with error: `,g,"url: ",c,"request:",n),g})}Ho(e,r,n,i,o,a){return this.Go(e,r,n,i,o)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+fo}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>e[o]=i),n&&n.headers.forEach((i,o)=>e[o]=i)}zo(e,r){const n=G1[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sr="WebChannelConnection";class W1 extends H1{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,o){const a=gc();return new Promise((c,d)=>{const h=new Bf;h.setWithCredentials(!0),h.listenOnce(Ff.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case na.NO_ERROR:const g=h.getResponseJson();Ye(Sr,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(g)),c(g);break;case na.TIMEOUT:Ye(Sr,`RPC '${e}' ${a} timed out`),d(new qe(Ee.DEADLINE_EXCEEDED,"Request time out"));break;case na.HTTP_ERROR:const _=h.getStatus();if(Ye(Sr,`RPC '${e}' ${a} failed with status:`,_,"response text:",h.getResponseText()),_>0){let A=h.getResponseJson();Array.isArray(A)&&(A=A[0]);const M=A?.error;if(M&&M.status&&M.message){const L=function(R){const W=R.toLowerCase().replace(/_/g,"-");return Object.values(Ee).indexOf(W)>=0?W:Ee.UNKNOWN}(M.status);d(new qe(L,M.message))}else d(new qe(Ee.UNKNOWN,"Server responded with status "+h.getStatus()))}else d(new qe(Ee.UNAVAILABLE,"Connection failed."));break;default:ot(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{Ye(Sr,`RPC '${e}' ${a} completed.`)}});const m=JSON.stringify(i);Ye(Sr,`RPC '${e}' ${a} sending request:`,i),h.send(r,"POST",m,n,15)})}T_(e,r,n){const i=gc(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=zf(),c=jf(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(d.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(d.useFetchStreams=!0),this.jo(d.initMessageHeaders,r,n),d.encodeInitMessageHeaders=!0;const m=o.join("");Ye(Sr,`Creating RPC '${e}' stream ${i}: ${m}`,d);const g=a.createWebChannel(m,d);this.I_(g);let _=!1,A=!1;const M=new Y1({Yo:k=>{A?Ye(Sr,`Not sending because RPC '${e}' stream ${i} is closed:`,k):(_||(Ye(Sr,`Opening RPC '${e}' stream ${i} transport.`),g.open(),_=!0),Ye(Sr,`RPC '${e}' stream ${i} sending:`,k),g.send(k))},Zo:()=>g.close()}),L=(k,R,W)=>{k.listen(R,ie=>{try{W(ie)}catch(te){setTimeout(()=>{throw te},0)}})};return L(g,Lo.EventType.OPEN,()=>{A||(Ye(Sr,`RPC '${e}' stream ${i} transport opened.`),M.o_())}),L(g,Lo.EventType.CLOSE,()=>{A||(A=!0,Ye(Sr,`RPC '${e}' stream ${i} transport closed`),M.a_(),this.E_(g))}),L(g,Lo.EventType.ERROR,k=>{A||(A=!0,no(Sr,`RPC '${e}' stream ${i} transport errored. Name:`,k.name,"Message:",k.message),M.a_(new qe(Ee.UNAVAILABLE,"The operation could not be completed")))}),L(g,Lo.EventType.MESSAGE,k=>{if(!A){const R=k.data[0];Lt(!!R,16349);const W=R,ie=W?.error||W[0]?.error;if(ie){Ye(Sr,`RPC '${e}' stream ${i} received error:`,ie);const te=ie.status;let ye=function(S){const p=rr[S];if(p!==void 0)return Cy(p)}(te),ae=ie.message;ye===void 0&&(ye=Ee.INTERNAL,ae="Unknown error status: "+te+" with message "+ie.message),A=!0,M.a_(new qe(ye,ae)),g.close()}else Ye(Sr,`RPC '${e}' stream ${i} received:`,R),M.u_(R)}}),L(c,Uf.STAT_EVENT,k=>{k.stat===nc.PROXY?Ye(Sr,`RPC '${e}' stream ${i} detected buffering proxy`):k.stat===nc.NOPROXY&&Ye(Sr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{M.__()},0),M}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function Pl(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ja(t){return new XS(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy{constructor(e,r,n=1e3,i=1.5,o=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&Ye("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ph="PersistentStream";class By{constructor(e,r,n,i,o,a,c,d){this.Mi=e,this.S_=n,this.b_=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=d,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Vy(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===Ee.RESOURCE_EXHAUSTED?($n(r.toString()),$n("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===Ee.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===r&&this.G_(n,i)},n=>{e(()=>{const i=new qe(Ee.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Ye(Ph,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(Ye(Ph,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class K1 extends By{constructor(e,r,n,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=o}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=t1(this.serializer,e),n=function(o){if(!("targetChange"in o))return ut.min();const a=o.targetChange;return a.targetIds&&a.targetIds.length?ut.min():a.readTime?dn(a.readTime):ut.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=fc(this.serializer),r.addTarget=function(o,a){let c;const d=a.target;if(c=lc(d)?{documents:i1(o,d)}:{query:o1(o,d).ft},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Ey(o,a.resumeToken);const h=dc(o,a.expectedCount);h!==null&&(c.expectedCount=h)}else if(a.snapshotVersion.compareTo(ut.min())>0){c.readTime=$a(o,a.snapshotVersion.toTimestamp());const h=dc(o,a.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);const n=a1(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=fc(this.serializer),r.removeTarget=e,this.q_(r)}}class Q1 extends By{constructor(e,r,n,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Lt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Lt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Lt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=n1(e.writeResults,e.commitTime),n=dn(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=fc(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>r1(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1{}class X1 extends J1{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new qe(Ee.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Go(e,hc(r,n),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new qe(Ee.UNKNOWN,o.toString())})}Ho(e,r,n,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Ho(e,hc(r,n),i,a,c,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new qe(Ee.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Z1{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?($n(r),this.aa=!1):Ye("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ei="RemoteStore";class eP{constructor(e,r,n,i,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo(a=>{n.enqueueAndForget(async()=>{ki(this)&&(Ye(Ei,"Restarting streams for network reachability change."),await async function(d){const h=ht(d);h.Ea.add(4),await vs(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Xa(h)}(this))})}),this.Ra=new Z1(n,i)}}async function Xa(t){if(ki(t))for(const e of t.da)await e(!0)}async function vs(t){for(const e of t.da)await e(!1)}function Fy(t,e){const r=ht(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),uu(r)?cu(r):vo(r).O_()&&lu(r,e))}function au(t,e){const r=ht(t),n=vo(r);r.Ia.delete(e),n.O_()&&Uy(r,e),r.Ia.size===0&&(n.O_()?n.L_():ki(r)&&r.Ra.set("Unknown"))}function lu(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ut.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}vo(t).Y_(e)}function Uy(t,e){t.Va.Ue(e),vo(t).Z_(e)}function cu(t){t.Va=new WS({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),vo(t).start(),t.Ra.ua()}function uu(t){return ki(t)&&!vo(t).x_()&&t.Ia.size>0}function ki(t){return ht(t).Ea.size===0}function jy(t){t.Va=void 0}async function tP(t){t.Ra.set("Online")}async function rP(t){t.Ia.forEach((e,r)=>{lu(t,e)})}async function nP(t,e){jy(t),uu(t)?(t.Ra.ha(e),cu(t)):t.Ra.set("Unknown")}async function iP(t,e,r){if(t.Ra.set("Online"),e instanceof Iy&&e.state===2&&e.cause)try{await async function(i,o){const a=o.cause;for(const c of o.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,a),i.Ia.delete(c),i.Va.removeTarget(c))}(t,e)}catch(n){Ye(Ei,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Ra(t,n)}else if(e instanceof aa?t.Va.Ze(e):e instanceof Ay?t.Va.st(e):t.Va.tt(e),!r.isEqual(ut.min()))try{const n=await Oy(t.localStore);r.compareTo(n)>=0&&await function(o,a){const c=o.Va.Tt(a);return c.targetChanges.forEach((d,h)=>{if(d.resumeToken.approximateByteSize()>0){const m=o.Ia.get(h);m&&o.Ia.set(h,m.withResumeToken(d.resumeToken,a))}}),c.targetMismatches.forEach((d,h)=>{const m=o.Ia.get(d);if(!m)return;o.Ia.set(d,m.withResumeToken(yr.EMPTY_BYTE_STRING,m.snapshotVersion)),Uy(o,d);const g=new Gn(m.target,d,h,m.sequenceNumber);lu(o,g)}),o.remoteSyncer.applyRemoteEvent(c)}(t,r)}catch(n){Ye(Ei,"Failed to raise snapshot:",n),await Ra(t,n)}}async function Ra(t,e,r){if(!go(e))throw e;t.Ea.add(1),await vs(t),t.Ra.set("Offline"),r||(r=()=>Oy(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ye(Ei,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await Xa(t)})}function zy(t,e){return e().catch(r=>Ra(t,r,e))}async function Za(t){const e=ht(t),r=ri(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Yc;for(;oP(e);)try{const i=await F1(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,sP(e,i)}catch(i){await Ra(e,i)}qy(e)&&Gy(e)}function oP(t){return ki(t)&&t.Ta.length<10}function sP(t,e){t.Ta.push(e);const r=ri(t);r.O_()&&r.X_&&r.ea(e.mutations)}function qy(t){return ki(t)&&!ri(t).x_()&&t.Ta.length>0}function Gy(t){ri(t).start()}async function aP(t){ri(t).ra()}async function lP(t){const e=ri(t);for(const r of t.Ta)e.ea(r.mutations)}async function cP(t,e,r){const n=t.Ta.shift(),i=eu.from(n,e,r);await zy(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Za(t)}async function uP(t,e){e&&ri(t).X_&&await async function(n,i){if(function(a){return GS(a)&&a!==Ee.ABORTED}(i.code)){const o=n.Ta.shift();ri(n).B_(),await zy(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i)),await Za(n)}}(t,e),qy(t)&&Gy(t)}async function wh(t,e){const r=ht(t);r.asyncQueue.verifyOperationInProgress(),Ye(Ei,"RemoteStore received new credentials");const n=ki(r);r.Ea.add(3),await vs(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await Xa(r)}async function dP(t,e){const r=ht(t);e?(r.Ea.delete(2),await Xa(r)):e||(r.Ea.add(2),await vs(r),r.Ra.set("Unknown"))}function vo(t){return t.ma||(t.ma=function(r,n,i){const o=ht(r);return o.sa(),new K1(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:tP.bind(null,t),t_:rP.bind(null,t),r_:nP.bind(null,t),H_:iP.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),uu(t)?cu(t):t.Ra.set("Unknown")):(await t.ma.stop(),jy(t))})),t.ma}function ri(t){return t.fa||(t.fa=function(r,n,i){const o=ht(r);return o.sa(),new Q1(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:aP.bind(null,t),r_:uP.bind(null,t),ta:lP.bind(null,t),na:cP.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Za(t)):(await t.fa.stop(),t.Ta.length>0&&(Ye(Ei,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(e,r,n,i,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new En,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,o){const a=Date.now()+n,c=new du(e,r,a,i,o);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new qe(Ee.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function hu(t,e){if($n("AsyncQueue",`${e}: ${t}`),go(t))return new qe(Ee.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{static emptySet(e){return new Zi(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||rt.comparator(r.key,n.key):(r,n)=>rt.comparator(r.key,n.key),this.keyedMap=Mo(),this.sortedSet=new Wt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Zi)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Zi;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(){this.ga=new Wt(rt.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):ot(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class lo{constructor(e,r,n,i,o,a,c,d,h){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=d,this.hasCachedResults=h}static fromInitialDocuments(e,r,n,i,o){const a=[];return r.forEach(c=>{a.push({type:0,doc:c})}),new lo(e,r,Zi.emptySet(r),a,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ha(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hP{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class mP{constructor(){this.queries=Ah(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=ht(r),o=i.queries;i.queries=Ah(),o.forEach((a,c)=>{for(const d of c.Sa)d.onError(n)})})(this,new qe(Ee.ABORTED,"Firestore shutting down"))}}function Ah(){return new $i(t=>dy(t),Ha)}async function Hy(t,e){const r=ht(t);let n=3;const i=e.query;let o=r.queries.get(i);o?!o.ba()&&e.Da()&&(n=2):(o=new hP,n=e.Da()?0:1);try{switch(n){case 0:o.wa=await r.onListen(i,!0);break;case 1:o.wa=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const c=hu(a,`Initialization of query '${Hi(e.query)}' failed`);return void e.onError(c)}r.queries.set(i,o),o.Sa.push(e),e.va(r.onlineState),o.wa&&e.Fa(o.wa)&&mu(r)}async function Yy(t,e){const r=ht(t),n=e.query;let i=3;const o=r.queries.get(n);if(o){const a=o.Sa.indexOf(e);a>=0&&(o.Sa.splice(a,1),o.Sa.length===0?i=e.Da()?0:1:!o.ba()&&e.Da()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function fP(t,e){const r=ht(t);let n=!1;for(const i of e){const o=i.query,a=r.queries.get(o);if(a){for(const c of a.Sa)c.Fa(i)&&(n=!0);a.wa=i}}n&&mu(r)}function yP(t,e,r){const n=ht(t),i=n.queries.get(e);if(i)for(const o of i.Sa)o.onError(r);n.queries.delete(e)}function mu(t){t.Ca.forEach(e=>{e.next()})}var pc,Ih;(Ih=pc||(pc={})).Ma="default",Ih.Cache="cache";class Wy{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new lo(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=lo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==pc.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ky{constructor(e){this.key=e}}class Qy{constructor(e){this.key=e}}class gP{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ct(),this.mutatedKeys=Ct(),this.eu=hy(e),this.tu=new Zi(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new Ch,i=r?r.tu:this.tu;let o=r?r.mutatedKeys:this.mutatedKeys,a=i,c=!1;const d=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((m,g)=>{const _=i.get(m),A=Ya(this.query,g)?g:null,M=!!_&&this.mutatedKeys.has(_.key),L=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let k=!1;_&&A?_.data.isEqual(A.data)?M!==L&&(n.track({type:3,doc:A}),k=!0):this.su(_,A)||(n.track({type:2,doc:A}),k=!0,(d&&this.eu(A,d)>0||h&&this.eu(A,h)<0)&&(c=!0)):!_&&A?(n.track({type:0,doc:A}),k=!0):_&&!A&&(n.track({type:1,doc:_}),k=!0,(d||h)&&(c=!0)),k&&(A?(a=a.add(A),o=L?o.add(m):o.delete(m)):(a=a.delete(m),o=o.delete(m)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const m=this.query.limitType==="F"?a.last():a.first();a=a.delete(m.key),o=o.delete(m.key),n.track({type:1,doc:m})}return{tu:a,iu:n,Cs:c,mutatedKeys:o}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((m,g)=>function(A,M){const L=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ot(20277,{Rt:k})}};return L(A)-L(M)}(m.type,g.type)||this.eu(m.doc,g.doc)),this.ou(n),i=i??!1;const c=r&&!i?this._u():[],d=this.Xa.size===0&&this.current&&!i?1:0,h=d!==this.Za;return this.Za=d,a.length!==0||h?{snapshot:new lo(this.query,e.tu,o,a,e.mutatedKeys,d===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Ch,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ct(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new Qy(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new Ky(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=Ct();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return lo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const fu="SyncEngine";class pP{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class vP{constructor(e){this.key=e,this.hu=!1}}class bP{constructor(e,r,n,i,o,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new $i(c=>dy(c),Ha),this.Iu=new Map,this.Eu=new Set,this.du=new Wt(rt.comparator),this.Au=new Map,this.Ru=new nu,this.Vu={},this.mu=new Map,this.fu=ao.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function _P(t,e,r=!0){const n=rg(t);let i;const o=n.Tu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await Jy(n,e,r,!0),i}async function SP(t,e){const r=rg(t);await Jy(r,e,!0,!1)}async function Jy(t,e,r,n){const i=await U1(t.localStore,cn(e)),o=i.targetId,a=t.sharedClientState.addLocalQueryTarget(o,r);let c;return n&&(c=await PP(t,e,o,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&Fy(t.remoteStore,i),c}async function PP(t,e,r,n,i){t.pu=(g,_,A)=>async function(L,k,R,W){let ie=k.view.ru(R);ie.Cs&&(ie=await vh(L.localStore,k.query,!1).then(({documents:$})=>k.view.ru($,ie)));const te=W&&W.targetChanges.get(k.targetId),ye=W&&W.targetMismatches.get(k.targetId)!=null,ae=k.view.applyChanges(ie,L.isPrimaryClient,te,ye);return xh(L,k.targetId,ae.au),ae.snapshot}(t,g,_,A);const o=await vh(t.localStore,e,!0),a=new gP(e,o.Qs),c=a.ru(o.documents),d=ps.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),h=a.applyChanges(c,t.isPrimaryClient,d);xh(t,r,h.au);const m=new pP(e,r,a);return t.Tu.set(e,m),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),h.snapshot}async function wP(t,e,r){const n=ht(t),i=n.Tu.get(e),o=n.Iu.get(i.targetId);if(o.length>1)return n.Iu.set(i.targetId,o.filter(a=>!Ha(a,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await yc(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&au(n.remoteStore,i.targetId),vc(n,i.targetId)}).catch(yo)):(vc(n,i.targetId),await yc(n.localStore,i.targetId,!0))}async function CP(t,e){const r=ht(t),n=r.Tu.get(e),i=r.Iu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),au(r.remoteStore,n.targetId))}async function AP(t,e,r){const n=RP(t);try{const i=await function(a,c){const d=ht(a),h=Ht.now(),m=c.reduce((A,M)=>A.add(M.key),Ct());let g,_;return d.persistence.runTransaction("Locally write mutations","readwrite",A=>{let M=Rn(),L=Ct();return d.Ns.getEntries(A,m).next(k=>{M=k,M.forEach((R,W)=>{W.isValidDocument()||(L=L.add(R))})}).next(()=>d.localDocuments.getOverlayedDocuments(A,M)).next(k=>{g=k;const R=[];for(const W of c){const ie=FS(W,g.get(W.key).overlayedDocument);ie!=null&&R.push(new ai(W.key,ie,ny(ie.value.mapValue),un.exists(!0)))}return d.mutationQueue.addMutationBatch(A,h,R,c)}).next(k=>{_=k;const R=k.applyToLocalDocumentSet(g,L);return d.documentOverlayCache.saveOverlays(A,k.batchId,R)})}).then(()=>({batchId:_.batchId,changes:fy(g)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,c,d){let h=a.Vu[a.currentUser.toKey()];h||(h=new Wt(wt)),h=h.insert(c,d),a.Vu[a.currentUser.toKey()]=h}(n,i.batchId,r),await bs(n,i.changes),await Za(n.remoteStore)}catch(i){const o=hu(i,"Failed to persist write");r.reject(o)}}async function Xy(t,e){const r=ht(t);try{const n=await V1(r.localStore,e);e.targetChanges.forEach((i,o)=>{const a=r.Au.get(o);a&&(Lt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?Lt(a.hu,14607):i.removedDocuments.size>0&&(Lt(a.hu,42227),a.hu=!1))}),await bs(r,n,e)}catch(n){await yo(n)}}function Eh(t,e,r){const n=ht(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach((o,a)=>{const c=a.view.va(e);c.snapshot&&i.push(c.snapshot)}),function(a,c){const d=ht(a);d.onlineState=c;let h=!1;d.queries.forEach((m,g)=>{for(const _ of g.Sa)_.va(c)&&(h=!0)}),h&&mu(d)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function IP(t,e,r){const n=ht(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Au.get(e),o=i&&i.key;if(o){let a=new Wt(rt.comparator);a=a.insert(o,Cr.newNoDocument(o,ut.min()));const c=Ct().add(o),d=new Qa(ut.min(),new Map,new Wt(wt),a,c);await Xy(n,d),n.du=n.du.remove(o),n.Au.delete(e),yu(n)}else await yc(n.localStore,e,!1).then(()=>vc(n,e,r)).catch(yo)}async function EP(t,e){const r=ht(t),n=e.batch.batchId;try{const i=await O1(r.localStore,e);eg(r,n,null),Zy(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await bs(r,i)}catch(i){await yo(i)}}async function xP(t,e,r){const n=ht(t);try{const i=await function(a,c){const d=ht(a);return d.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let m;return d.mutationQueue.lookupMutationBatch(h,c).next(g=>(Lt(g!==null,37113),m=g.keys(),d.mutationQueue.removeMutationBatch(h,g))).next(()=>d.mutationQueue.performConsistencyCheck(h)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(h,m,c)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,m)).next(()=>d.localDocuments.getDocuments(h,m))})}(n.localStore,e);eg(n,e,r),Zy(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await bs(n,i)}catch(i){await yo(i)}}function Zy(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function eg(t,e,r){const n=ht(t);let i=n.Vu[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(r?o.reject(r):o.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function vc(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||tg(t,n)})}function tg(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(au(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),yu(t))}function xh(t,e,r){for(const n of r)n instanceof Ky?(t.Ru.addReference(n.key,e),TP(t,n)):n instanceof Qy?(Ye(fu,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||tg(t,n.key)):ot(19791,{wu:n})}function TP(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Ye(fu,"New document in limbo: "+r),t.Eu.add(n),yu(t))}function yu(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new rt(qt.fromString(e)),n=t.fu.next();t.Au.set(n,new vP(r)),t.du=t.du.insert(r,n),Fy(t.remoteStore,new Gn(cn(Xc(r.path)),n,"TargetPurposeLimboResolution",za.ce))}}async function bs(t,e,r){const n=ht(t),i=[],o=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach((c,d)=>{a.push(n.pu(d,e,r).then(h=>{if((h||r)&&n.isPrimaryClient){const m=h?!h.fromCache:r?.targetChanges.get(d.targetId)?.current;n.sharedClientState.updateQueryState(d.targetId,m?"current":"not-current")}if(h){i.push(h);const m=ou.As(d.targetId,h);o.push(m)}}))}),await Promise.all(a),n.Pu.H_(i),await async function(d,h){const m=ht(d);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>Re.forEach(h,_=>Re.forEach(_.Es,A=>m.persistence.referenceDelegate.addReference(g,_.targetId,A)).next(()=>Re.forEach(_.ds,A=>m.persistence.referenceDelegate.removeReference(g,_.targetId,A)))))}catch(g){if(!go(g))throw g;Ye(su,"Failed to update sequence numbers: "+g)}for(const g of h){const _=g.targetId;if(!g.fromCache){const A=m.Ms.get(_),M=A.snapshotVersion,L=A.withLastLimboFreeSnapshotVersion(M);m.Ms=m.Ms.insert(_,L)}}}(n.localStore,o))}async function $P(t,e){const r=ht(t);if(!r.currentUser.isEqual(e)){Ye(fu,"User change. New user:",e.toKey());const n=await My(r.localStore,e);r.currentUser=e,function(o,a){o.mu.forEach(c=>{c.forEach(d=>{d.reject(new qe(Ee.CANCELLED,a))})}),o.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await bs(r,n.Ls)}}function kP(t,e){const r=ht(t),n=r.Au.get(e);if(n&&n.hu)return Ct().add(n.key);{let i=Ct();const o=r.Iu.get(e);if(!o)return i;for(const a of o){const c=r.Tu.get(a);i=i.unionWith(c.view.nu)}return i}}function rg(t){const e=ht(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Xy.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=kP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=IP.bind(null,e),e.Pu.H_=fP.bind(null,e.eventManager),e.Pu.yu=yP.bind(null,e.eventManager),e}function RP(t){const e=ht(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=EP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=xP.bind(null,e),e}class Da{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ja(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return M1(this.persistence,new D1,e.initialUser,this.serializer)}Cu(e){return new Ly(iu.mi,this.serializer)}Du(e){return new z1}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Da.provider={build:()=>new Da};class DP extends Da{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Lt(this.persistence.referenceDelegate instanceof ka,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new v1(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?Tr.withCacheSize(this.cacheSizeBytes):Tr.DEFAULT;return new Ly(n=>ka.mi(n,r),this.serializer)}}class bc{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Eh(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=$P.bind(null,this.syncEngine),await dP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new mP}()}createDatastore(e){const r=Ja(e.databaseInfo.databaseId),n=function(o){return new W1(o)}(e.databaseInfo);return function(o,a,c,d){return new X1(o,a,c,d)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,o,a,c){return new eP(n,i,o,a,c)}(this.localStore,this.datastore,e.asyncQueue,r=>Eh(this.syncEngine,r,0),function(){return Sh.v()?new Sh:new q1}())}createSyncEngine(e,r){return function(i,o,a,c,d,h,m){const g=new bP(i,o,a,c,d,h);return m&&(g.gu=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(r){const n=ht(r);Ye(Ei,"RemoteStore shutting down."),n.Ea.add(5),await vs(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}bc.provider={build:()=>new bc};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):$n("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ni="FirestoreClient";class NP{constructor(e,r,n,i,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=wr.UNAUTHENTICATED,this.clientId=Hc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,async a=>{Ye(ni,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Ye(ni,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new En;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=hu(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function wl(t,e){t.asyncQueue.verifyOperationInProgress(),Ye(ni,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await My(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Th(t,e){t.asyncQueue.verifyOperationInProgress();const r=await LP(t);Ye(ni,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>wh(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>wh(e.remoteStore,i)),t._onlineComponents=e}async function LP(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ye(ni,"Using user provided OfflineComponentProvider");try{await wl(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===Ee.FAILED_PRECONDITION||i.code===Ee.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;no("Error using user provided cache. Falling back to memory cache: "+r),await wl(t,new Da)}}else Ye(ni,"Using default OfflineComponentProvider"),await wl(t,new DP(void 0));return t._offlineComponents}async function ig(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ye(ni,"Using user provided OnlineComponentProvider"),await Th(t,t._uninitializedComponentsProvider._online)):(Ye(ni,"Using default OnlineComponentProvider"),await Th(t,new bc))),t._onlineComponents}function MP(t){return ig(t).then(e=>e.syncEngine)}async function og(t){const e=await ig(t),r=e.eventManager;return r.onListen=_P.bind(null,e.syncEngine),r.onUnlisten=wP.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=SP.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=CP.bind(null,e.syncEngine),r}function OP(t,e,r={}){const n=new En;return t.asyncQueue.enqueueAndForget(async()=>function(o,a,c,d,h){const m=new ng({next:_=>{m.Nu(),a.enqueueAndForget(()=>Yy(o,g));const A=_.docs.has(c);!A&&_.fromCache?h.reject(new qe(Ee.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&_.fromCache&&d&&d.source==="server"?h.reject(new qe(Ee.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(_)},error:_=>h.reject(_)}),g=new Wy(Xc(c.path),m,{includeMetadataChanges:!0,qa:!0});return Hy(o,g)}(await og(t),t.asyncQueue,e,r,n)),n.promise}function VP(t,e,r={}){const n=new En;return t.asyncQueue.enqueueAndForget(async()=>function(o,a,c,d,h){const m=new ng({next:_=>{m.Nu(),a.enqueueAndForget(()=>Yy(o,g)),_.fromCache&&d.source==="server"?h.reject(new qe(Ee.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(_)},error:_=>h.reject(_)}),g=new Wy(c,m,{includeMetadataChanges:!0,qa:!0});return Hy(o,g)}(await og(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sg(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $h=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ag="firestore.googleapis.com",kh=!0;class Rh{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new qe(Ee.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=ag,this.ssl=kh}else this.host=e.host,this.ssl=e.ssl??kh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Ny;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<g1)throw new qe(Ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}eS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=sg(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new qe(Ee.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new qe(Ee.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new qe(Ee.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class el{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Rh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new qe(Ee.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new qe(Ee.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Rh(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new q_;switch(n.type){case"firstParty":return new W_(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new qe(Ee.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=$h.get(r);n&&(Ye("ComponentProvider","Removing Datastore"),$h.delete(r),n.terminate())}(this),Promise.resolve()}}function BP(t,e,r,n={}){t=kn(t,el);const i=uo(e),o=t._getSettings(),a={...o,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${r}`;i&&(Km(`https://${c}`),Qm("Firestore",!0)),o.host!==ag&&o.host!==c&&no("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d={...o,host:c,ssl:i,emulatorOptions:n};if(!wi(d,a)&&(t._setSettings(d),n.mockUserToken)){let h,m;if(typeof n.mockUserToken=="string")h=n.mockUserToken,m=wr.MOCK_USER;else{h=fv(n.mockUserToken,t._app?.options.projectId);const g=n.mockUserToken.sub||n.mockUserToken.user_id;if(!g)throw new qe(Ee.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new wr(g)}t._authCredentials=new G_(new Gf(h,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Ri(this.firestore,e,this._query)}}class Jt{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Jn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Jt(this.firestore,e,this._key)}toJSON(){return{type:Jt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(ys(r,Jt._jsonSchema))return new Jt(e,n||null,new rt(qt.fromString(r.referencePath)))}}Jt._jsonSchemaVersion="firestore/documentReference/1.0",Jt._jsonSchema={type:ir("string",Jt._jsonSchemaVersion),referencePath:ir("string")};class Jn extends Ri{constructor(e,r,n){super(e,r,Xc(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Jt(this.firestore,null,new rt(e))}withConverter(e){return new Jn(this.firestore,e,this._path)}}function FP(t,e,...r){if(t=fr(t),Hf("collection","path",e),t instanceof el){const n=qt.fromString(e,...r);return Gd(n),new Jn(t,null,n)}{if(!(t instanceof Jt||t instanceof Jn))throw new qe(Ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(qt.fromString(e,...r));return Gd(n),new Jn(t.firestore,null,n)}}function lg(t,e,...r){if(t=fr(t),arguments.length===1&&(e=Hc.newId()),Hf("doc","path",e),t instanceof el){const n=qt.fromString(e,...r);return qd(n),new Jt(t,null,new rt(n))}{if(!(t instanceof Jt||t instanceof Jn))throw new qe(Ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(qt.fromString(e,...r));return qd(n),new Jt(t.firestore,t instanceof Jn?t.converter:null,new rt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dh="AsyncQueue";class Nh{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Vy(this,"async_queue_retry"),this._c=()=>{const n=Pl();n&&Ye(Dh,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Pl();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Pl();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new En;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!go(e))throw e;Ye(Dh,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,$n("INTERNAL UNHANDLED ERROR: ",Lh(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=du.createAndSchedule(this,e,r,n,o=>this.hc(o));return this.tc.push(i),i}uc(){this.nc&&ot(47125,{Pc:Lh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function Lh(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class _s extends el{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new Nh,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Nh(e),this._firestoreClient=void 0,await e}}}function UP(t,e){const r=typeof t=="object"?t:ef(),n=typeof t=="string"?t:Aa,i=Nc(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const o=hv("firestore");o&&BP(i,...o)}return i}function gu(t){if(t._terminated)throw new qe(Ee.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||jP(t),t._firestoreClient}function jP(t){const e=t._freezeSettings(),r=function(i,o,a,c){return new dS(i,o,a,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,sg(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new NP(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(i){const o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new jr(yr.fromBase64String(e))}catch(r){throw new qe(Ee.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new jr(yr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:jr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ys(e,jr._jsonSchema))return jr.fromBase64String(e.bytes)}}jr._jsonSchemaVersion="firestore/bytes/1.0",jr._jsonSchema={type:ir("string",jr._jsonSchemaVersion),bytes:ir("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new qe(Ee.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new hr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new qe(Ee.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new qe(Ee.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return wt(this._lat,e._lat)||wt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:hn._jsonSchemaVersion}}static fromJSON(e){if(ys(e,hn._jsonSchema))return new hn(e.latitude,e.longitude)}}hn._jsonSchemaVersion="firestore/geoPoint/1.0",hn._jsonSchema={type:ir("string",hn._jsonSchemaVersion),latitude:ir("number"),longitude:ir("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:mn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ys(e,mn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new mn(e.vectorValues);throw new qe(Ee.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}mn._jsonSchemaVersion="firestore/vectorValue/1.0",mn._jsonSchema={type:ir("string",mn._jsonSchemaVersion),vectorValues:ir("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zP=/^__.*__$/;class qP{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new ai(e,this.data,this.fieldMask,r,this.fieldTransforms):new gs(e,this.data,r,this.fieldTransforms)}}class cg{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new ai(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function ug(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ot(40011,{Ac:t})}}class vu{constructor(e,r,n,i,o,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new vu({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Na(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(ug(this.Ac)&&zP.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class GP{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Ja(e)}Cc(e,r,n,i=!1){return new vu({Ac:e,methodName:r,Dc:n,path:hr.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function bu(t){const e=t._freezeSettings(),r=Ja(t._databaseId);return new GP(t._databaseId,!!e.ignoreUndefinedProperties,r)}function HP(t,e,r,n,i,o={}){const a=t.Cc(o.merge||o.mergeFields?2:0,e,r,i);_u("Data must be an object, but it was:",a,n);const c=dg(n,a);let d,h;if(o.merge)d=new Lr(a.fieldMask),h=a.fieldTransforms;else if(o.mergeFields){const m=[];for(const g of o.mergeFields){const _=_c(e,g,r);if(!a.contains(_))throw new qe(Ee.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);mg(m,_)||m.push(_)}d=new Lr(m),h=a.fieldTransforms.filter(g=>d.covers(g.field))}else d=null,h=a.fieldTransforms;return new qP(new $r(c),d,h)}class rl extends pu{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof rl}}function YP(t,e,r,n){const i=t.Cc(1,e,r);_u("Data must be an object, but it was:",i,n);const o=[],a=$r.empty();si(n,(d,h)=>{const m=Su(e,d,r);h=fr(h);const g=i.yc(m);if(h instanceof rl)o.push(m);else{const _=Ss(h,g);_!=null&&(o.push(m),a.set(m,_))}});const c=new Lr(o);return new cg(a,c,i.fieldTransforms)}function WP(t,e,r,n,i,o){const a=t.Cc(1,e,r),c=[_c(e,n,r)],d=[i];if(o.length%2!=0)throw new qe(Ee.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<o.length;_+=2)c.push(_c(e,o[_])),d.push(o[_+1]);const h=[],m=$r.empty();for(let _=c.length-1;_>=0;--_)if(!mg(h,c[_])){const A=c[_];let M=d[_];M=fr(M);const L=a.yc(A);if(M instanceof rl)h.push(A);else{const k=Ss(M,L);k!=null&&(h.push(A),m.set(A,k))}}const g=new Lr(h);return new cg(m,g,a.fieldTransforms)}function KP(t,e,r,n=!1){return Ss(r,t.Cc(n?4:3,e))}function Ss(t,e){if(hg(t=fr(t)))return _u("Unsupported field value:",e,t),dg(t,e);if(t instanceof pu)return function(n,i){if(!ug(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const o=[];let a=0;for(const c of n){let d=Ss(c,i.wc(a));d==null&&(d={nullValue:"NULL_VALUE"}),o.push(d),a++}return{arrayValue:{values:o}}}(t,e)}return function(n,i){if((n=fr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return NS(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=Ht.fromDate(n);return{timestampValue:$a(i.serializer,o)}}if(n instanceof Ht){const o=new Ht(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:$a(i.serializer,o)}}if(n instanceof hn)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof jr)return{bytesValue:Ey(i.serializer,n._byteString)};if(n instanceof Jt){const o=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(o))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:ru(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof mn)return function(a,c){return{mapValue:{fields:{[ty]:{stringValue:ry},[Ia]:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return Zc(c.serializer,h)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${ja(n)}`)}(t,e)}function dg(t,e){const r={};return Kf(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):si(t,(n,i)=>{const o=Ss(i,e.mc(n));o!=null&&(r[n]=o)}),{mapValue:{fields:r}}}function hg(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ht||t instanceof hn||t instanceof jr||t instanceof Jt||t instanceof pu||t instanceof mn)}function _u(t,e,r){if(!hg(r)||!Yf(r)){const n=ja(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function _c(t,e,r){if((e=fr(e))instanceof tl)return e._internalPath;if(typeof e=="string")return Su(t,e);throw Na("Field path arguments must be of type string or ",t,!1,void 0,r)}const QP=new RegExp("[~\\*/\\[\\]]");function Su(t,e,r){if(e.search(QP)>=0)throw Na(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new tl(...e.split("."))._internalPath}catch{throw Na(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Na(t,e,r,n,i){const o=n&&!n.isEmpty(),a=i!==void 0;let c=`Function ${e}() called with invalid data`;r&&(c+=" (via `toFirestore()`)"),c+=". ";let d="";return(o||a)&&(d+=" (found",o&&(d+=` in field ${n}`),a&&(d+=` in document ${i}`),d+=")"),new qe(Ee.INVALID_ARGUMENT,c+t+d)}function mg(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fg{constructor(e,r,n,i,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Jt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new JP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Pu("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class JP extends fg{data(){return super.data()}}function Pu(t,e){return typeof e=="string"?Su(t,e):e instanceof tl?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XP(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new qe(Ee.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class wu{}class yg extends wu{}function ZP(t,e,...r){let n=[];e instanceof wu&&n.push(e),n=n.concat(r),function(o){const a=o.filter(d=>d instanceof Au).length,c=o.filter(d=>d instanceof Cu).length;if(a>1||a>0&&c>0)throw new qe(Ee.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class Cu extends yg{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Cu(e,r,n)}_apply(e){const r=this._parse(e);return gg(e._query,r),new Ri(e.firestore,e.converter,cc(e._query,r))}_parse(e){const r=bu(e.firestore);return function(o,a,c,d,h,m,g){let _;if(h.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new qe(Ee.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){Oh(g,m);const M=[];for(const L of g)M.push(Mh(d,o,L));_={arrayValue:{values:M}}}else _=Mh(d,o,g)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||Oh(g,m),_=KP(c,a,g,m==="in"||m==="not-in");return nr.create(h,m,_)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}class Au extends wu{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Au(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Xr.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,o){let a=i;const c=o.getFlattenedFilters();for(const d of c)gg(a,d),a=cc(a,d)}(e._query,r),new Ri(e.firestore,e.converter,cc(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Iu extends yg{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new Iu(e,r)}_apply(e){const r=function(i,o,a){if(i.startAt!==null)throw new qe(Ee.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new qe(Ee.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new os(o,a)}(e._query,this._field,this._direction);return new Ri(e.firestore,e.converter,function(i,o){const a=i.explicitOrderBy.concat([o]);return new po(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}function ew(t,e="asc"){const r=e,n=Pu("orderBy",t);return Iu._create(n,r)}function Mh(t,e,r){if(typeof(r=fr(r))=="string"){if(r==="")throw new qe(Ee.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!uy(e)&&r.indexOf("/")!==-1)throw new qe(Ee.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(qt.fromString(r));if(!rt.isDocumentKey(n))throw new qe(Ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Zd(t,new rt(n))}if(r instanceof Jt)return Zd(t,r._key);throw new qe(Ee.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ja(r)}.`)}function Oh(t,e){if(!Array.isArray(t)||t.length===0)throw new qe(Ee.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function gg(t,e){const r=function(i,o){for(const a of i)for(const c of a.getFlattenedFilters())if(o.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new qe(Ee.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new qe(Ee.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class tw{convertValue(e,r="none"){switch(ti(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Qt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(ei(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ot(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return si(e,(i,o)=>{n[i]=this.convertValue(o,r)}),n}convertVectorValue(e){const r=e.fields?.[Ia].arrayValue?.values?.map(n=>Qt(n.doubleValue));return new mn(r)}convertGeoPoint(e){return new hn(Qt(e.latitude),Qt(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Ga(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(rs(e));default:return null}}convertTimestamp(e){const r=Zn(e);return new Ht(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=qt.fromString(e);Lt(Dy(n),9688,{name:e});const i=new ns(n.get(1),n.get(3)),o=new rt(n.popFirst(5));return i.isEqual(r)||$n(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rw(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class Vo{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Pi extends fg{constructor(e,r,n,i,o,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new la(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Pu("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new qe(Ee.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Pi._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Pi._jsonSchemaVersion="firestore/documentSnapshot/1.0",Pi._jsonSchema={type:ir("string",Pi._jsonSchemaVersion),bundleSource:ir("string","DocumentSnapshot"),bundleName:ir("string"),bundle:ir("string")};class la extends Pi{data(e={}){return super.data(e)}}class eo{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new Vo(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new la(this._firestore,this._userDataWriter,n.key,n,new Vo(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new qe(Ee.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(c=>{const d=new la(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Vo(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:d,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>o||c.type!==3).map(c=>{const d=new la(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Vo(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,m=-1;return c.type!==0&&(h=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),m=a.indexOf(c.doc.key)),{type:nw(c.type),doc:d,oldIndex:h,newIndex:m}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new qe(Ee.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=eo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Hc.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function nw(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ot(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iw(t){t=kn(t,Jt);const e=kn(t.firestore,_s);return OP(gu(e),t._key).then(r=>aw(e,t,r))}eo._jsonSchemaVersion="firestore/querySnapshot/1.0",eo._jsonSchema={type:ir("string",eo._jsonSchemaVersion),bundleSource:ir("string","QuerySnapshot"),bundleName:ir("string"),bundle:ir("string")};class pg extends tw{constructor(e){super(),this.firestore=e}convertBytes(e){return new jr(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Jt(this.firestore,null,r)}}function ow(t){t=kn(t,Ri);const e=kn(t.firestore,_s),r=gu(e),n=new pg(e);return XP(t._query),VP(r,t._query).then(i=>new eo(e,n,t,i))}function sw(t,e,r){t=kn(t,Jt);const n=kn(t.firestore,_s),i=rw(t.converter,e);return bg(n,[HP(bu(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,un.none())])}function vg(t,e,r,...n){t=kn(t,Jt);const i=kn(t.firestore,_s),o=bu(i);let a;return a=typeof(e=fr(e))=="string"||e instanceof tl?WP(o,"updateDoc",t._key,e,r,n):YP(o,"updateDoc",t._key,e),bg(i,[a.toMutation(t._key,un.exists(!0))])}function bg(t,e){return function(n,i){const o=new En;return n.asyncQueue.enqueueAndForget(async()=>AP(await MP(n),i,o)),o.promise}(gu(t),e)}function aw(t,e,r){const n=r.docs.get(e._key),i=new pg(t);return new Pi(t,i,e._key,n,new Vo(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){fo=i})(ho),to(new Ci("firestore",(n,{instanceIdentifier:i,options:o})=>{const a=n.getProvider("app").getImmediate(),c=new _s(new H_(n.getProvider("auth-internal")),new K_(a,n.getProvider("app-check-internal")),function(h,m){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new qe(Ee.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ns(h.options.projectId,m)}(a,i),a);return o={useFetchStreams:r,...o},c._setSettings(o),c},"PUBLIC").setMultipleInstances(!0)),Wn(Fd,Ud,e),Wn(Fd,Ud,"esm2020")})();let lw="eyAiYXBpS2V5IjogIkFJemFTeUJBbGN2WlRMMXRsQ05LRExENEJpTWJhR01iTnhCRjQtTSIsICAiYXV0aERvbWFpbiI6ICJocm0tMTEyOC5maXJlYmFzZWFwcC5jb20iLCAgImRhdGFiYXNlVVJMIjogImh0dHBzOi8vaHJtLTExMjguZmlyZWJhc2Vpby5jb20iLCAgInByb2plY3RJZCI6ICJocm0tMTEyOCIsICAic3RvcmFnZUJ1Y2tldCI6ICJocm0tMTEyOC5hcHBzcG90LmNvbSIsICAibWVzc2FnaW5nU2VuZGVySWQiOiAiMTA0OTI1MDU4NTI0NSIsICAiYXBwSWQiOiAiMToxMDQ5MjUwNTg1MjQ1OndlYjowZGFkMDAyMDI3MjM1MTRjY2M1Mjc0In0=";const _g=Zm(JSON.parse(ev(lw))),vi=F_(_g),La=new sn,Sc=UP(_g);La.addScope("profile");La.addScope("email");class Bo extends Error{}Bo.prototype.name="InvalidTokenError";function cw(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function uw(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return cw(e)}catch{return atob(e)}}function dw(t,e){if(typeof t!="string")throw new Bo("Invalid token specified: must be a string");e||(e={});const r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new Bo(`Invalid token specified: missing part #${r+1}`);let i;try{i=uw(n)}catch(o){throw new Bo(`Invalid token specified: invalid base64 for part #${r+1} (${o.message})`)}try{return JSON.parse(i)}catch(o){throw new Bo(`Invalid token specified: invalid json for part #${r+1} (${o.message})`)}}const hw={clientId:"195275085181-8ccjpgp8v1g80qhnlk6v4lpgid7n81gr.apps.googleusercontent.com"},mw=t=>{const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>{window.google&&window.google.accounts.id.initialize({client_id:hw.clientId,callback:r=>{t(r.credential)},auto_select:!1,cancel_on_tap_outside:!0})},document.head.appendChild(e)},fw=t=>dw(t),yw=()=>{window.google&&window.google.accounts.id.disableAutoSelect()},[gw,pw]=kc({}),vw=async()=>{const e=await Pn({query:"qcm42351987"});if(e&&!e.error){let n=Object.assign({},{},e);pw(n)}return 1},bw=async t=>{let e=gw?.[992002];e&&(e.params={tkn:t},await Pn(e))},[Fi,Pr]=kc({user:null,loading:!0,error:null,authMethod:null}),[Sg,Vh]=ge(null);E0(vi,t=>{t?Pr({user:t,loading:!1,error:null,authMethod:"firebase"}):Sg()||Pr({user:null,loading:!1,error:null,authMethod:null})});r_(vi).then(t=>{t&&Pr({user:t.user,loading:!1,error:null,authMethod:"firebase"})}).catch(t=>{console.error("Redirect sign-in error:",t),Pr({loading:!1,error:t.message})});const vt={get state(){return Fi},async getUserProfile(t){try{const e=lg(Sc,"users",t),r=await iw(e);if(r.exists()){Pr("profile",r.data());let n={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1},i=r.data(),o={};return Object.keys(n).map(a=>{let c=n?.[a];i.hasOwnProperty(a)||(o[a]=c)}),Object.keys(o).length>0&&vg(e,o),r.data()}else{let n=vt?.state?.user,i={uid:n?.uid,email:n?.email,displayName:n?.displayName,createdAt:new Date,stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};return await sw(e,i),console.log("No such user profile!"),null}}catch(e){return console.error("Error fetching user profile:",e),null}},hasPermission:t=>{const e=vt.state?.profile;return e.isAdmin?!0:e?e[t]===!0:!1},async signInWithGoogle(){try{Pr("loading",!0),Pr("error",null);try{const t=await W0(vi,La);Pr({user:t.user,loading:!1,error:null,authMethod:"firebase"});try{vt.getUserProfile(t.user.uid)}catch(e){console.error("firestore error:",e)}}catch(t){if(t.code==="auth/popup-blocked")await e_(vi,La);else throw t}}catch(t){console.error("Sign-in error:",t),Pr({loading:!1,error:t.message||"Failed to sign in with Google"})}},async signInWithGoogleP(t){const r=await Pn({params:{id_token:t},query:"getGoogleUserbyToken"});if(r&&r){let n=new Date().getTime(),i=new Date(n+6e4*60*24*365),o="hrm_tkn_acc";document.cookie=`${o}=${r.data}; expires=${i}; path=/;g_state = {"i_l":1,"i_p":${i}}; ssgl_access_tkn = ${t}`,document.cookie=`ssgl_access_tkn = ${t}; expires=${i};`,await vw(),bw(r.data)}},async signInWithGoogleCloud(t){try{Pr("loading",!0),Pr("error",null);const e=fw(t),r={uid:e.sub,email:e.email,displayName:e.name,photoURL:e.picture};Vh(r);const n={uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,emailVerified:!0};Pr({user:n,loading:!1,error:null,authMethod:"google-cloud"});try{const i=sn.credential(t);await C0(vi,i)}catch{console.log("Firebase sign-in optional, continuing with Google Cloud auth")}}catch(e){console.error("Google Cloud sign-in error:",e),Pr({loading:!1,error:e.message||"Failed to sign in with Google Cloud"})}},async signOut(){try{Pr("loading",!0),(Fi.authMethod==="firebase"||vi.currentUser)&&await x0(vi),Fi.authMethod==="google-cloud"&&(yw(),Vh(null)),Pr({user:null,loading:!1,error:null,authMethod:null})}catch(t){console.error("Sign-out error:",t),Pr({loading:!1,error:t.message||"Failed to sign out"})}},get isAuthenticated(){return!!Fi.user||!!Sg()},get currentUser(){return Fi.user},get authMethod(){return Fi.authMethod}};var _w=z("<p>"),Sw=z('<div><div><div><h1>HRM Finance</h1><p>Complete Business Management Solution</p><div><div><button><svg width=24 height=24 viewBox="0 0 24 24"><path fill=#4285F4 d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path><path fill=#34A853 d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path><path fill=#FBBC05 d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path><path fill=#EA4335 d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path></svg></button><p>Firebase Authentication</p></div></div></div><div><div><div></div><h3>Financial Management</h3><p>Complete chart of accounts, balance sheets, journal entries, and invoice management in one place.</p></div><div><div></div><h3>HR Management</h3><p>Track employees, manage onboarding, and monitor your workforce with powerful analytics.</p></div><div><div></div><h3>Inventory Control</h3><p>Real-time inventory tracking, product management, and movement history across multiple locations.</p></div><div><div></div><h3>Banking Integration</h3><p>Streamline bank reconciliation with CSV imports and automated consolidation features.</p></div><div><div></div><h3>Real-time Analytics</h3><p>Get instant insights with dashboards showing revenue, cash flow, and business performance.</p></div><div><div></div><h3>Multi-language Support</h3><p>Available in multiple languages to support your global business operations.</p></div></div><div><p>Secure authentication powered by Google  Your data is encrypted and protected</p><p>Choose your preferred authentication method above');const Pw=()=>{qr(()=>{mw(k=>{vt.signInWithGoogleP(k)}),setTimeout(()=>{},100)});const t={"min-height":"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},e={background:"white","border-radius":"1rem","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","max-width":"1200px",width:"100%",overflow:"hidden"},r={padding:"3rem","text-align":"center","border-bottom":"1px solid #e2e8f0"},n={"font-size":"2.5rem","font-weight":"800",color:"#1a202c","margin-bottom":"1rem"},i={"font-size":"1.125rem",color:"#718096","margin-bottom":"2rem"},o={display:"flex","flex-direction":"column",gap:"1rem","align-items":"center","margin-bottom":"1rem"},a={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"2rem",padding:"3rem"},c={"text-align":"center",padding:"2rem","border-radius":"0.5rem",background:"#f7fafc",transition:"transform 0.2s",cursor:"default"},d={"font-size":"3rem","margin-bottom":"1rem"},h={"font-size":"1.25rem","font-weight":"600",color:"#2d3748","margin-bottom":"0.5rem"},m={color:"#718096","line-height":"1.6"},g={display:"inline-flex","align-items":"center",gap:"0.75rem",background:"white",color:"#4285f4",border:"2px solid #4285f4",padding:"0.75rem 2rem","font-size":"1.125rem","font-weight":"500","border-radius":"0.5rem",cursor:"pointer",transition:"all 0.2s","min-width":"250px","justify-content":"center"},_={color:"#e53e3e","margin-top":"1rem","font-size":"0.875rem"},A={background:"#f7fafc",padding:"2rem","text-align":"center",color:"#718096","font-size":"0.875rem"},M={"font-size":"0.75rem",color:"#718096","margin-top":"0.25rem","font-style":"italic"},L=()=>{vt.signInWithGoogle()};return(()=>{var k=Sw(),R=k.firstChild,W=R.firstChild,ie=W.firstChild,te=ie.nextSibling,ye=te.nextSibling,ae=ye.firstChild,$=ae.firstChild;$.firstChild;var S=$.nextSibling,p=W.nextSibling,C=p.firstChild,P=C.firstChild,E=P.nextSibling,y=E.nextSibling,oe=C.nextSibling,K=oe.firstChild,T=K.nextSibling,U=T.nextSibling,B=oe.nextSibling,x=B.firstChild,I=x.nextSibling,N=I.nextSibling,Z=B.nextSibling,j=Z.firstChild,J=j.nextSibling,w=J.nextSibling,V=Z.nextSibling,X=V.firstChild,Y=X.nextSibling,se=Y.nextSibling,O=V.nextSibling,F=O.firstChild,le=F.nextSibling,pe=le.nextSibling,ve=p.nextSibling,ce=ve.firstChild,H=ce.nextSibling;return u(k,t),u(R,e),u(W,r),u(ie,n),u(te,i),u(ye,o),$.addEventListener("mouseleave",D=>{D.currentTarget.style.background="white",D.currentTarget.style.color="#4285f4"}),$.addEventListener("mouseenter",D=>{D.currentTarget.style.background="#4285f4",D.currentTarget.style.color="white"}),$.$$click=L,u($,g),s($,b(Ne,{get when(){return vt.state.loading},fallback:"Sign in with Google",children:"Signing in..."}),null),u(S,M),s(W,b(Ne,{get when(){return vt.state.error},get children(){var D=_w();return u(D,_),s(D,()=>vt.state.error),D}}),null),u(p,a),u(ve,A),H.style.setProperty("margin-top","0.5rem"),H.style.setProperty("font-size","0.75rem"),re(D=>{var Q=vt.state.loading,G=c,he=d,me=h,ee=m,ne=c,Se=d,we=h,ue=m,be=c,de=d,Pe=h,$e=m,xe=c,ke=d,Be=h,Qe=m,Ue=c,Te=d,Fe=h,Je=m,Ge=c,Xe=d,Ae=h,Ie=m;return Q!==D.e&&($.disabled=D.e=Q),D.t=u(C,G,D.t),D.a=u(P,he,D.a),D.o=u(E,me,D.o),D.i=u(y,ee,D.i),D.n=u(oe,ne,D.n),D.s=u(K,Se,D.s),D.h=u(T,we,D.h),D.r=u(U,ue,D.r),D.d=u(B,be,D.d),D.l=u(x,de,D.l),D.u=u(I,Pe,D.u),D.c=u(N,$e,D.c),D.w=u(Z,xe,D.w),D.m=u(j,ke,D.m),D.f=u(J,Be,D.f),D.y=u(w,Qe,D.y),D.g=u(V,Ue,D.g),D.p=u(X,Te,D.p),D.b=u(Y,Fe,D.b),D.T=u(se,Je,D.T),D.A=u(O,Ge,D.A),D.O=u(F,Xe,D.O),D.I=u(le,Ae,D.I),D.S=u(pe,Ie,D.S),D},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0}),k})()};At(["click"]);var ww=z("<div><div>");const Cw=t=>{const e={"min-height":"100vh",display:"flex","align-items":"center","justify-content":"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},r={width:"50px",height:"50px",border:"3px solid rgba(255, 255, 255, 0.3)","border-top-color":"white","border-radius":"50%",animation:"spin 1s linear infinite"},n=document.createElement("style");return n.textContent=`
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  `,document.head.appendChild(n),Dn(()=>{vt.state?.user?.uid&&vt.getUserProfile(vt.state?.user?.uid)}),qr(()=>{}),b(Ne,{get when(){return!vt.state.loading},get fallback(){return(()=>{var i=ww(),o=i.firstChild;return u(i,e),u(o,r),i})()},get children(){return b(Ne,{get when(){return vt.isAuthenticated},get fallback(){return b(Pw,{})},get children(){return t.children}})}})};var Aw=z("<button>");const Le=t=>{const e=()=>{const r={"font-family":"inherit",cursor:t.disabled?"not-allowed":"pointer",border:"none","border-radius":"var(--border-radius-sm)","font-weight":"500",transition:"all 0.2s ease","text-decoration":"none",display:"inline-flex","align-items":"center","justify-content":"center",gap:"0.5rem",opacity:t.disabled?"0.6":"1"},n={sm:{padding:"0.5rem 1rem","font-size":"0.875rem"},md:{padding:"0.75rem 1.5rem","font-size":"1rem"},lg:{padding:"1rem 2rem","font-size":"1.125rem"}},i={primary:{background:"linear-gradient(135deg, var(--primary-color), var(--primary-dark))",color:"white","box-shadow":"var(--shadow-sm)"},secondary:{background:"var(--surface-color)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},outline:{background:"transparent",color:"var(--primary-color)",border:"1px solid var(--primary-color)"}};return{...r,...n[t.size||"md"],...i[t.variant||"primary"]}};return(()=>{var r=Aw();return xi(r,"click",t.onClick,!0),s(r,()=>t.children),re(n=>{var i=e(),o=t.disabled,a=t.type||"button",c=`btn btn-${t.variant||"primary"} ${t.className||""}`;return n.e=u(r,i,n.e),o!==n.t&&(r.disabled=n.t=o),a!==n.a&&ct(r,"type",n.a=a),c!==n.o&&Ec(r,n.o=c),n},{e:void 0,t:void 0,a:void 0,o:void 0}),r})()};At(["click"]);var Iw=z("<div><div><div><h2></h2><button></button></div><div>");const gr=t=>{const e={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},r={background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","max-width":"920px",width:"90%","max-height":"80vh",overflow:"auto",position:"relative"},n={padding:"1.5rem","border-bottom":"1px solid var(--border-color)",display:"flex","justify-content":"space-between","align-items":"center"},i={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},o={background:"none",border:"none","font-size":"1.5rem",cursor:"pointer",color:"var(--text-muted)",padding:"0.5rem","border-radius":"var(--border-radius-sm)"},a={padding:"1.5rem"},c=d=>{d.target===d.currentTarget&&t.onClose()};return b(Ne,{get when(){return t.isOpen},get children(){var d=Iw(),h=d.firstChild,m=h.firstChild,g=m.firstChild,_=g.nextSibling,A=m.nextSibling;return d.$$click=c,u(m,n),u(g,i),s(g,()=>t.title),_.addEventListener("mouseleave",M=>M.target.style.background="none"),_.addEventListener("mouseenter",M=>M.target.style.background="var(--background-color)"),xi(_,"click",t.onClose,!0),u(_,o),u(A,a),s(A,()=>t.children),re(M=>{var L=e,k=r;return M.e=u(d,L,M.e),M.t=u(h,k,M.t),M},{e:void 0,t:void 0}),d}})};At(["click"]);var Bh=z("<div>"),Ew=z("<h3>"),xw=z("<p>");const tt=t=>{const e={background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"1.5rem","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",transition:"all 0.2s ease",cursor:t.onClick?"pointer":"default"},r={"margin-bottom":"1rem"},n={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0 0 0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)",margin:"0"};return(()=>{var o=Bh();return xi(o,"click",t.onClick,!0),s(o,(()=>{var a=fe(()=>!!(t.title||t.subtitle));return()=>a()&&(()=>{var c=Bh();return u(c,r),s(c,(()=>{var d=fe(()=>!!t.title);return()=>d()&&(()=>{var h=Ew();return u(h,n),s(h,()=>t.title),h})()})(),null),s(c,(()=>{var d=fe(()=>!!t.subtitle);return()=>d()&&(()=>{var h=xw();return u(h,i),s(h,()=>t.subtitle),h})()})(),null),c})()})(),null),s(o,()=>t.children,null),re(a=>{var c=e,d=`card ${t.className||""}`;return a.e=u(o,c,a.e),d!==a.t&&Ec(o,a.t=d),a},{e:void 0,t:void 0}),o})()};At(["click"]);var Tw=z("<div><label></label><input>"),$w=z("<span>*");const kt=t=>{const e={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},r={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},n={"margin-bottom":"1rem"};return(()=>{var i=Tw(),o=i.firstChild,a=o.nextSibling;return u(i,n),u(o,e),s(o,()=>t.label,null),s(o,(()=>{var c=fe(()=>!!t.required);return()=>c()&&(()=>{var d=$w();return d.style.setProperty("color","var(--primary-color)"),d})()})(),null),a.addEventListener("blur",c=>c.target.style.borderColor="var(--border-color)"),a.addEventListener("focus",c=>c.target.style.borderColor="var(--primary-color)"),a.$$input=c=>t.onChange(c.target.value),u(a,r),re(c=>{var d=t.type||"text",h=t.placeholder,m=t.required,g=t.disabled;return d!==c.e&&ct(a,"type",c.e=d),h!==c.t&&ct(a,"placeholder",c.t=h),m!==c.a&&(a.required=c.a=m),g!==c.o&&(a.disabled=c.o=g),c},{e:void 0,t:void 0,a:void 0,o:void 0}),re(()=>a.value=t.value),i})()};At(["input"]);const kw={en:{common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",close:"Close",search:"Search",filter:"Filter",reset:"Reset",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",actions:"Actions",status:"Status",active:"Active",inactive:"Inactive",date:"Date",time:"Time",description:"Description",notes:"Notes",amount:"Amount",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Language",english:"English",spanish:"Spanish",noDataFound:"No data found",required:"Required",optional:"Optional",all:"All",none:"None",select:"Select",clear:"Clear",searching:"Searching...",refresh:"Refresh",showAll:"Show All",products:"products",filtered:"Filtered",view:"View",suggested:"Suggested",clearFilters:"Clear Filters",enhanced:"Enhanced",legacy:"Legacy",email:"Email",phone:"Phone",address:"Address",name:"Name",code:"Code",category:"Category",type:"Type",quantity:"Quantity",price:"Price",cost:"Cost",value:"Value",balance:"Balance",created:"Created",modified:"Modified",details:"Details",summary:"Summary",history:"History",new:"New",addNew:"Add New",unknown:"Unknown",notAvailable:"N/A",remove:"Remove",startDate:"Start Date",endDate:"End Date",from:"From",invoice:"Invoice",invoices:"invoices",reference:"Reference",createdBy:"Created By",units:"units",invoiceDocumentId:"Invoice/Document ID",referenceNumber:"Reference Number",referenceNumberPlaceholder:"Enter reference number...",generalNotes:"General Notes",auto:"Auto",optionalNotes:"Optional notes...",showPerPage:"Show per page",first:"First",last:"Last",pageOfPages:"Page {{current}} of {{total}}",showingXofY:"Showing {{start}}-{{end}} of {{total}}",page:"Page",of:"of",print:"Print",export:"Export",pending:"Pending",completed:"Completed",customer:"Customer",store:"Store",location:"Location",reservations:"Reservations",backToDashboard:"Back to Dashboard",lbs:"pounds"},forms:{referenceNumberRequired:"Reference number is required",locationRequired:"Location is required",fromLocationRequired:"From location is required for transfers",atLeastOneProduct:"At least one product is required",itemProductRequired:"Product is required for item {{index}}",itemQuantityRequired:"Quantity must be greater than 0 for item {{index}}"},navigation:{dashboard:"Dashboard",accounts:"Chart of Accounts",balanceSheet:"Balance Sheet",inventory:"Inventory",employees:"Employees",entryBooks:"Entry Books",consolidate:"Bank Consolidation",reports:"Reports",settings:"Settings"},dashboard:{title:"Dashboard",welcome:"Welcome to HRM Finance",totalRevenue:"Total Revenue",overview:"Overview",recentActivity:"Recent Activity",quickActions:"Quick Actions",employeeCount:"Employee Count",pendingInvoices:"Pending Invoices",cashBalance:"Cash Balance",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalExpenses:"Total Expenses",netIncome:"Net Income",netLoss:"Net Loss",monthlyPayroll:"Monthly Payroll",current:"Current",newHires:"+3 new hires",outstanding:"Outstanding",totalOutstanding:"$23,450 total",lastUpdatedToday:"Last updated today",commonTasks:"Common tasks",generateReport:"Generate Report",latestUpdates:"Latest updates",invoicePaid:"Invoice #1234 paid",hoursAgo:"2 hours ago",newEmployeeOnboarded:"New employee onboarded",dayAgo:"1 day ago",monthlyReportGenerated:"Monthly report generated",daysAgo:"2 days ago"},accounts:{title:"Chart of Accounts",accountNumber:"Account Number",accountName:"Account Name",accountType:"Account Type",category:"Category",balance:"Balance",parentAccount:"Parent Account",subAccounts:"Sub-accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",transactions:"Transactions",accountHistory:"Account History",backToAccounts:"Back to Accounts",accountNotFound:"Account not found",accountInformation:"Account Information",accountPurpose:"Account purpose",transactionHistory:"Transaction History",noTransactions:"No transactions found for this account",createdDate:"Created Date",lastModified:"Last Modified",noDescription:"No description provided.",totalCount:"Total count",basicDetails:"Basic details",currentBalance:"Current balance",classification:"Classification",allTransactions:"All account transactions",reference:"Reference",allAccounts:"All Accounts",types:{asset:"Asset",liability:"Liability",equity:"Equity",revenue:"Revenue",expense:"Expense"},categories:{currentAssets:"Current Assets",fixedAssets:"Fixed Assets",currentLiabilities:"Current Liabilities",longTermLiabilities:"Long-term Liabilities",ownersEquity:"Owner's Equity",operatingRevenue:"Operating Revenue",operatingExpenses:"Operating Expenses"}},inventory:{title:"Inventory Management",overview:"Overview",products:"Products & Stock",movements:"Movements",locations:"Locations",bulkMovement:"Bulk Movement",addMovement:"Add Movement",addProduct:"Add Product",addLocation:"Add Location",singleMovement:"Add Single Movement",addNewItem:"Add New Item",activeProducts:"Active Products",lowStockAlert:"Low Stock Items",totalValue:"Total Stock Value",activeLocations:"Active Locations",productsNeedRestocking:"products need restocking",recentMovements:"Recent Movements",noProducts:"No products at this location",productName:"Product Name",productCode:"Product Code",sku:"SKU",unitOfMeasure:"Unit of Measure",unitCost:"Unit Cost",minStockLevel:"Min Stock Level",maxStockLevel:"Max Stock Level",locationName:"Location Name",locationType:"Location Type",locationCode:"Location Code",movementType:"Movement Type",referenceNumber:"Reference Number",invoiceNumber:"Invoice Number",fromLocation:"From Location",toLocation:"To Location",stockIn:"Stock In",stockOut:"Stock Out",transfer:"Transfer",adjustment:"Adjustment",inStock:"In Stock",lowStock:"Low Stock",outOfStock:"Out of Stock",stockLevels:"Stock Levels",stockByLocation:"Stock by Location",searchProducts:"Search products by name, SKU, or category...",searchProductsStock:"Search products and check stock levels...",searchResult:"Search Result",searchResults:"Search Results",searchFallback:"Showing local results",tryDifferentTerm:"Try a different search term or check spelling.",showingTopResults:"Showing top {{count}} results",searchLocations:"Search locations...",noMovements:"No movements found",productDetails:"Product Details",locationDetails:"Location Details",movementDetails:"Movement Details",totalProducts:"Total Products",totalLocations:"Total Locations",lastSeen:"Last seen",warehouseType:"Warehouse",storeType:"Store",supplierType:"Supplier",customerType:"Customer",currentlyManaged:"Currently managed",needAttention:"Need attention",currentWorth:"Current worth",warehousesStores:"Warehouses & stores",thisMonth:"This Month",latestActivities:"Latest inventory activities",searchMovements:"Search Movements",countingSheet:"Counting Sheet",physicalCount:"Physical Count",physicalInventoryCount:"Physical Inventory Count",setupPhysicalCount:"Setup Physical Inventory Count",setupDescription:"Configure your physical inventory count settings and begin the counting process.",countWillInclude:"This count will include {{count}} products from {{location}} in {{category}} category.",startCounting:"Start Physical Count",counted:"Counted",remaining:"Remaining",variances:"Variances",complete:"Complete",systemQty:"System Qty",variance:"Variance",addNotes:"Add notes...",reviewAndConfirm:"Review and Confirm Adjustments",reviewDescription:"Review the inventory adjustments below and confirm to update your system.",stockIncreases:"Stock Increases",stockDecreases:"Stock Decreases",totalAdjustments:"Total Adjustments",confirmAdjustments:"Confirm Adjustments",perfectCount:"Perfect Count!",noVariances:"No variances found. Your physical count matches the system exactly.",physicalCountAdjustment:"Physical count adjustment",inventoryCountingSheetTitle:"INVENTORY COUNTING SHEET",location:"Location",allCategories:"All Categories",countedBy:"Counted by",verifiedBy:"Verified by",instructions:"Instructions",countInstructions:["Count all items physically present at this location",'Write the actual count in the "Physical Count" column',"Leave blank if item is not found",'Note any discrepancies in the "Notes" column',"Sign and date when complete"],productName:"Product Name",unit:"Unit",totalProductsListed:"Total Products Listed",itemsCounted:"Items Counted",discrepanciesFound:"Discrepancies Found",counterSignature:"Counter Signature",supervisorSignature:"Supervisor Signature",downloadCSV:"Download CSV",noAdjustmentsToDownload:"No adjustments to download",stockIncrease:"Stock Increase",stockDecrease:"Stock Decrease",purchaseReceive:"Purchase/Receive",saleIssue:"Sale/Issue",transfer:"Transfer",adjustment:"Adjustment",movementType:"Movement Type",fromLocation:"From Location",toLocation:"To Location",searchSourceLocation:"Search source location...",searchDestinationLocation:"Search destination location...",searchLocation:"Search location...",addProduct:"Add Product",searchProduct:"Search product...",unitCost:"Unit Cost",noProductsAdded:'No products added yet. Click "Add Product" to get started.',createMovement:"Create Movement",generalNotesPlaceholder:"Enter general notes for this movement...",sortBy:"Sort By",allLocations:"All Locations",searchByProduct:"Search by product, location, reference, notes, invoice...",allProducts:"All Products",allTypes:"All Types",startDate:"Start Date",endDate:"End Date",totalMovements:"Total Movements",totalItems:"Total Items",adjustMovements:"Try adjusting your filters or check back later.",inventoryMovements:"Inventory Movements",createdBy:"Created By",view:"View",enhanced:"Enhanced",legacy:"Legacy",addSingleMovement:"Add Single Movement",inStockSubtitle:"In stock",itemsBelowThreshold:"Items below threshold",inventoryWorth:"Inventory worth",quantity:"Quantity",units:"units",normal:"Normal",productsAndStock:"Products & Stock",lowStockItems:"Low Stock Items",totalStockValue:"Total Stock Value",warehousesAndStores:"Warehouses & stores",andMore:"...and {count} more",latestInventoryActivities:"Latest inventory activities",min:"Min",max:"Max",cost:"Cost",noProductsFound:"No products found matching your search.",noProductsAvailable:"No products available.",noLocationsFound:"No locations found matching your search.",noLocationsAvailable:"No locations available.",searchPlaceholder:"Search by product, location, reference, notes, invoice...",noMovementsFound:"No movements found",tryAdjustingFilters:"Try adjusting your filters or check back later.",transfers:"Transfers",adjustments:"Adjustments",bulk:"Bulk",product:"Product",location:"Location",store:"Store",supplier:"Supplier",warehouse:"Warehouse",movement:"Movement",editMovement:"Edit Movement",updateMovement:"Update Movement",movementInformation:"Movement Information",locationInformation:"Location Information",searchProductsImages:"Search products to view images...",searchForProducts:"Search for Products",startTypingToSearch:"Start typing to search and view product images",tryDifferentSearch:"Try a different search term"},employees:{title:"Employee Management",employeeList:"Employee List",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",payrollInfo:"Payroll Information",firstName:"First Name",lastName:"Last Name",fullName:"Full Name",email:"Email",phone:"Phone",address:"Address",dateOfBirth:"Date of Birth",employeeId:"Employee ID",department:"Department",position:"Position",hireDate:"Hire Date",employmentStatus:"Employment Status",salary:"Salary",payFrequency:"Pay Frequency",taxId:"Tax ID",bankAccount:"Bank Account",emergencyContact:"Emergency Contact",activeEmployees:"Active Employees",inactiveEmployees:"Inactive Employees",totalPayroll:"Total Payroll",searchEmployees:"Search employees...",enterFullName:"Enter employee's full name",enterPosition:"Enter job position",enterEmail:"Enter email address",enterPhone:"Enter phone number",enterSalary:"Enter annual salary",departments:{engineering:"Engineering",product:"Product",design:"Design",marketing:"Marketing",sales:"Sales",humanResources:"Human Resources",finance:"Finance",operations:"Operations",analytics:"Analytics"}},entryBooks:{title:"Entry Books",bookName:"Book Name",bookType:"Book Type",createBook:"Create Book",editBook:"Edit Book",salesBook:"Sales Book",purchaseBook:"Purchase Book",cashBook:"Cash Book",generalBook:"General Book",entries:"Entries",addEntry:"Add Entry",period:"Period",startDate:"Start Date",endDate:"End Date",bookBalance:"Book Balance",reconciledBalance:"Reconciled Balance",difference:"Difference",reconcile:"Reconcile",isReconciled:"Is Reconciled",noBooks:"No entry books found",createFirst:"Create your first entry book to get started",bookDetails:"Book Details",entriesCount:"entries",bookOverview:"Book overview and details",bookEntries:"Book Entries",allEntries:"All entries in this book",noEntries:"No entries found",addFirst:"Add your first entry to this book",entryDate:"Entry Date",entryDescription:"Entry Description",entryAmount:"Entry Amount",entryReference:"Entry Reference",subtitle:"Manage accounting entries and general ledger records",viewReconciliation:"View Reconciliation",totalEntries:"Total Entries",allJournalEntries:"All journal entries",postedEntriesOnly:"Posted entries only",fromPostedEntries:"From {count} posted entries",needBankReconciliation:"Need bank reconciliation",allReconciled:"All reconciled",sortBy:"Sort By",fromDate:"From Date",toDate:"To Date",order:"Order",newest:"Newest",oldest:"Oldest",resetFilters:"Reset Filters",activeFilters:"Active filters",from:"From",to:"To",entriesFound:"{count} entries found",noJournalEntries:"No Journal Entries",startByCreating:"Start by creating your first entry",noEntriesMatch:"No journal entries match your current filters.",createFirstEntry:"Create First Entry",void:"Void",confirmVoid:"Are you sure you want to void this journal entry?",entryBookRecords:"Entry Book Records"},banking:{title:"Bank Consolidation",bankAccount:"Bank Account",statementDate:"Statement Date",beginningBalance:"Beginning Balance",endingBalance:"Ending Balance",deposits:"Deposits",withdrawals:"Withdrawals",bankCharges:"Bank Charges",interest:"Interest",reconcile:"Reconcile",matched:"Matched",unmatched:"Unmatched",importStatement:"Import Statement",manualEntry:"Manual Entry",autoMatch:"Auto Match",clearAll:"Clear All",reconciliationStatus:"Reconciliation Status",difference:"Difference",bookBalance:"Book Balance",statementBalance:"Statement Balance",outstandingChecks:"Outstanding Checks",depositsInTransit:"Deposits in Transit",reconciled:"Reconciled",notReconciled:"Not Reconciled",unreconciled:"Unreconciled",reconciliation:"Reconciliation",compareStatements:"Compare bank statements with entry book records",importCSV:"Import CSV",startNewReconciliation:"Start New Reconciliation",bankAccountInfo:"Bank Account Info",currentAccountDetails:"Current account details",lastReconciled:"Last reconciled",bankTransactions:"Bank Transactions",selectedPeriod:"Selected period",pending:"pending",bookEntriesForComparison:"Book entries for comparison",reconciliationRate:"Reconciliation Rate",completionStatus:"Completion status",recentReconciliationSessions:"Recent Reconciliation Sessions",latestActivity:"Latest activity",noRecentSessions:"No recent reconciliation sessions found.",startFirstReconciliation:"Start First Reconciliation",entryBookRecords:"Entry Book Records",pleaseUploadCSV:"Please upload a CSV file",csvRequiresHeaderAndData:"CSV file must have at least a header and one data row",successfullyParsed:"Successfully parsed {count} rows",errorParsingCSV:"Error parsing CSV file. Please check the format.",dateDescriptionRequired:"Date and Description columns are required",importedTransaction:"Imported transaction",successfullyImported:"Successfully imported {count} bank transactions",errorImportingTransactions:"Error importing transactions. Please check your data.",importBankStatementCSV:"Import Bank Statement CSV",dropCSVHere:"Drop CSV file here",clickToUploadCSV:"Click to upload or drag and drop CSV file",supportedFormat:"Supported format: CSV with Date, Description, and Amount columns",mapCSVColumns:"Map CSV Columns",dateColumn:"Date Column",selectColumn:"Select column...",descriptionColumn:"Description Column",referenceColumn:"Reference Column",amountDebitColumn:"Amount/Debit Column",creditColumn:"Credit Column",balanceColumn:"Balance Column",andMoreRows:"... and {count} more rows",importing:"Importing...",importTransactions:"Import {count} Transactions",reconciliationComparison:"Reconciliation Comparison",bankStatements:"Bank Statements",totalTransactions:"Total transactions",totalEntries:"Total entries",unreconciledBank:"Unreconciled Bank",unreconciledBooks:"Unreconciled Books",needAttention:"Need attention",unreconcile:"Unreconcile",clickToReconcile:"Click to reconcile",potentialMatchesFound:"Potential Matches Found",clickRecordToReconcile:"Click on a record below to reconcile",exactMatch:"Exact Match",possibleMatch:"Possible Match",selected:"Selected",clearSelection:"Clear Selection"},journal:{title:"Journal Entries",entryNumber:"Entry Number",entryDate:"Entry Date",debit:"Debit",credit:"Credit",account:"Account",memo:"Memo",reference:"Reference",createEntry:"Create Entry",editEntry:"Edit Entry",deleteEntry:"Delete Entry",posted:"Posted",draft:"Draft",reversed:"Reversed",recurringEntry:"Recurring Entry",attachments:"Attachments",totalDebits:"Total Debits",totalCredits:"Total Credits",outOfBalance:"Out of Balance",balanced:"Balanced",addEntry:"Add Journal Entry",allEntries:"All Entries",totalDebit:"Total Debit",totalCredit:"Total Credit",debitShort:"Dr.",creditShort:"Cr.",noReference:"No reference",createdBy:"By",totalAmount:"Total Amount",lines:"Lines",entryNotBalancedShort:"Entry is not balanced",accountLines:"Account Lines",noDescription:"No description",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryLines:"Journal Entry Lines",addLine:"Add Line",lineDescription:"Line description",notBalanced:"Not Balanced",updateEntry:"Update Entry",saveAsDraft:"Save as Draft",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",editEntryTooltip:"Edit this journal entry",post:"Post",entryMustBeBalanced:"Entry must be balanced to post",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",journalLines:"Journal Lines",balanceStatus:"Balance Status",unbalanced:"Unbalanced",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",postEntry:"Post Entry",fixBalance:"Fix Balance",voidEntry:"Void Entry",draftEntry:"Draft Entry",draftEntryDescription:"This entry can be edited and posted.",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",postedEntry:"Posted Entry",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",minTwoLinesRequired:"At least 2 line items are required",entryNotBalanced:"Entry is not balanced. Debit: ${debit}, Credit: ${credit}",lineAccountRequired:"Line {lineNumber}: Account is required",lineAmountRequired:"Line {lineNumber}: Either debit or credit amount must be provided",lineBothAmounts:"Line {lineNumber}: Cannot have both debit and credit amounts",enterEntryDescription:"Enter journal entry description",enterReferenceNumber:"Enter reference number"},invoices:{title:"Invoice Dashboard",invoice:"Invoice",invoiceNumber:"Invoice Number",invoiceDetails:"Invoice Details",customerInformation:"Customer Information",customerName:"Customer Name",legalName:"Legal Name",contactInformation:"Contact Information",idPassport:"ID/Passport",phoneNumber:"Phone Number",altPhone:"Alt Phone",address:"Address",between:"Between",and:"and",products:"Products",reservations:"Reservations",unitPrice:"Unit Price",total:"Total",subtotal:"Subtotal",totalRevenue:"Total Revenue",totalProducts:"Total Products",totalReservations:"Total Reservations",aranceles:"Aranceles (Customs)",uniqueCustomers:"Unique Customers",averageInvoice:"Average Invoice",completed:"Completed",pending:"Pending",storesActive:"Stores Active",topProducts:"Top Products",mostSoldProducts:"Most sold products by quantity",reservationsByType:"Reservations by Type",distributionOfCategories:"Distribution of reservation categories",recentInvoices:"Recent Invoices",showingInvoices:"Showing {{count}} invoices",date:"Date",customer:"Customer",store:"Store",actions:"Actions",view:"View",status:"Status",printInvoice:"Print Invoice",exportPdf:"Export PDF",backToDashboard:"Back to Dashboard",fromInvoices:"From {{count}} invoices",value:"value",activeCustomers:"Active customers",perInvoiceValue:"Per invoice value",locations:"Locations",mostRecentActivity:"Most recent activity",storeLocation:"Store Location",allStores:"All Stores",fromDate:"From Date",toDate:"To Date",clearFilters:"Clear Filters",customsFees:"Total customs fees",salesType:"SALES",packagesOrder:"Packages Order",businessId:"Business ID",orderKey:"Order Key",reservationType:"Reservation Type",arancel:"Arancel",key:"Key",noInvoicesFound:"No invoices found",loadingInvoices:"Loading invoices...",errorLoadingInvoices:"Error loading invoices",refreshData:"Refresh Data",currentStockValue:"Current Stock Value",filterByStore:"Filter by store",filterByDate:"Filter by date range",totalCustomsFees:"Total customs fees",averageValue:"Average value"},forms:{requiredField:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",selectOption:"Please select an option",enterValue:"Please enter a value",confirmDelete:"Are you sure you want to delete this item?",unsavedChanges:"You have unsaved changes. Do you want to continue?",saveSuccess:"Saved successfully",saveError:"Error saving data",deleteSuccess:"Deleted successfully",deleteError:"Error deleting item",duplicateAccountNumber:"Account number already exists",descriptionRequired:"Description is required",errorOccurred:"An error occurred",errorPostingEntry:"An error occurred while posting the entry"},modals:{addInventory:"Add Inventory Movement",bulkMovement:"Bulk Inventory Movement",addProduct:"Add New Product",addLocation:"Add New Location",inventoryDetail:"Inventory Item Details",quickAdd:"Quick Add",selectProduct:"Select Product",selectLocation:"Select Location",enterQuantity:"Enter quantity",enterCost:"Enter unit cost",enterReference:"Enter reference number",addNotes:"Add notes (optional)",generalInformation:"General Information",stockInformation:"Stock Information",locationInformation:"Location Information",movementInformation:"Movement Information",addToInventory:"Add to Inventory",createProduct:"Create Product",createLocation:"Create Location",processing:"Processing...",addingMovement:"Adding movement...",creatingProduct:"Creating product...",creatingLocation:"Creating location..."},products:{title:"Products",addNew:"Add New Product",totalProducts:"Total Products",inCatalog:"In catalog",activeProducts:"Active Products",currentlyAvailable:"Currently available",outOfStock:"Out of Stock",needsRestock:"Needs restock",productCatalog:"Product Catalog",manageYourProducts:"Manage your products and pricing",inStock:"In Stock",furniture:"Furniture",electronics:"Electronics",supplies:"Supplies",lighting:"Lighting",searchPlaceholder:"Search products by name, SKU, or category...",allCategories:"All Categories",clearFilters:"Clear filters",noResults:"No products found matching your criteria.",noProducts:"No products available.",showing:"Showing",filtered:"Filtered results",allProducts:"All products",searchResult:"Search Result",stock:"Stock",lowStock:"Low Stock"},invoices:{title:"Invoices",createNew:"Create New Invoice",totalOutstanding:"Total Outstanding",unpaidInvoices:"Unpaid invoices",thisMonth:"This Month",revenueCollected:"Revenue collected",overdue:"Overdue",pastDueInvoices:"Past due invoices",recentInvoices:"Recent Invoices",latestBillingActivity:"Latest billing activity",paid:"Paid",pending:"Pending"},unauthorized:{title:"Access Restricted",accessDenied:"Access Denied",noPermission:"You don't have permission to access",thisFeature:"this feature",whySeeing:"Why am I seeing this?",explanation:"Your account doesn't have the necessary permissions to view this content.",requiredPermission:"Required permission:",goToDashboard:"Go to Dashboard",goBack:"Go Back",featuresCanAccess:"Features you can access:",dashboardAccess:"Dashboard and overview statistics",profileAccess:"Your profile and settings",roleBasedAccess:"Features enabled for your role",needAccess:"Need access? Contact your administrator or manager to request the appropriate permissions.",permissions:{accountAccess:"Account Management Access",inventoryAccess:"Inventory Access",employeeAccess:"HR Access",bankingAccess:"Banking Access",journalAccess:"Journal Entry Access",adminAccess:"Administrative Access",financialReporting:"Financial Reporting Access",invoiceManagement:"Invoice Management Access",productManagement:"Product Management Access"}}},es:{common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",add:"Agregar",close:"Cerrar",search:"Buscar",filter:"Filtrar",reset:"Restablecer",back:"Atrs",next:"Siguiente",previous:"Anterior",yes:"S",no:"No",loading:"Cargando...",error:"Error",success:"xito",warning:"Advertencia",info:"Informacin",confirm:"Confirmar",actions:"Acciones",status:"Estado",active:"Activo",inactive:"Inactivo",date:"Fecha",time:"Hora",description:"Descripcin",notes:"Notas",amount:"Monto",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Idioma",english:"Ingls",spanish:"Espaol",noDataFound:"No se encontraron datos",required:"Requerido",optional:"Opcional",all:"Todos",none:"Ninguno",select:"Seleccionar",clear:"Limpiar",view:"Ver",suggested:"Sugerido",clearFilters:"Limpiar Filtros",enhanced:"Mejorado",legacy:"Clsico",email:"Correo Electrnico",phone:"Telfono",address:"Direccin",name:"Nombre",code:"Cdigo",category:"Categora",type:"Tipo",quantity:"Cantidad",price:"Precio",cost:"Costo",value:"Valor",balance:"Saldo",created:"Creado",modified:"Modificado",details:"Detalles",summary:"Resumen",history:"Historial",new:"Nuevo",addNew:"Agregar Nuevo",unknown:"Desconocido",notAvailable:"N/A",remove:"Remover",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",from:"De",invoice:"Factura",invoices:"facturas",reference:"Referencia",createdBy:"Creado Por",units:"unidades",invoiceDocumentId:"ID de Factura/Documento",referenceNumber:"Nmero de Referencia",referenceNumberPlaceholder:"Ingrese nmero de referencia...",generalNotes:"Notas Generales",auto:"Auto",optionalNotes:"Notas opcionales...",showPerPage:"Mostrar por pgina",first:"Primera",last:"ltima",pageOfPages:"Pgina {{current}} de {{total}}",showingXofY:"Mostrando {{start}}-{{end}} de {{total}}",page:"Pgina",of:"de",lbs:"libras"},forms:{referenceNumberRequired:"El nmero de referencia es requerido",locationRequired:"La ubicacin es requerida",fromLocationRequired:"La ubicacin de origen es requerida para transferencias",atLeastOneProduct:"Al menos un producto es requerido",itemProductRequired:"El producto es requerido para el artculo {{index}}",itemQuantityRequired:"La cantidad debe ser mayor que 0 para el artculo {{index}}"},navigation:{dashboard:"Panel de Control",accounts:"Plan de Cuentas",balanceSheet:"Balance General",inventory:"Inventario",employees:"Empleados",entryBooks:"Libros de Entrada",consolidate:"Consolidacin Bancaria",reports:"Reportes",settings:"Configuracin"},dashboard:{title:"Panel de Control",welcome:"Bienvenido a HRM Finance",totalRevenue:"Ingresos Totales",overview:"Resumen",recentActivity:"Actividad Reciente",quickActions:"Acciones Rpidas",employeeCount:"Nmero de Empleados",pendingInvoices:"Facturas Pendientes",cashBalance:"Saldo en Efectivo",totalAssets:"Activos Totales",totalLiabilities:"Pasivos Totales",totalExpenses:"Gastos Totales",netIncome:"Ingreso Neto",netLoss:"Prdida Neta",monthlyPayroll:"Nmina Mensual",current:"Actual",newHires:"+3 nuevas contrataciones",outstanding:"Pendiente",totalOutstanding:"$23,450 total",lastUpdatedToday:"ltima actualizacin hoy",commonTasks:"Tareas comunes",generateReport:"Generar Reporte",latestUpdates:"ltimas actualizaciones",invoicePaid:"Factura #1234 pagada",hoursAgo:"hace 2 horas",newEmployeeOnboarded:"Nuevo empleado incorporado",dayAgo:"hace 1 da",monthlyReportGenerated:"Reporte mensual generado",daysAgo:"hace 2 das"},accounts:{title:"Plan de Cuentas",accountNumber:"Nmero de Cuenta",accountName:"Nombre de Cuenta",accountType:"Tipo de Cuenta",category:"Categora",balance:"Saldo",parentAccount:"Cuenta Padre",subAccounts:"Subcuentas",addAccount:"Agregar Cuenta",editAccount:"Editar Cuenta",deleteAccount:"Eliminar Cuenta",accountDetails:"Detalles de Cuenta",transactions:"Transacciones",accountHistory:"Historial de Cuenta",backToAccounts:"Volver a Cuentas",accountNotFound:"Cuenta no encontrada",accountInformation:"Informacin de Cuenta",accountPurpose:"Propsito de la cuenta",transactionHistory:"Historial de Transacciones",noTransactions:"No se encontraron transacciones para esta cuenta",createdDate:"Fecha de Creacin",lastModified:"ltima Modificacin",noDescription:"No se proporcion descripcin.",totalCount:"Conteo total",basicDetails:"Detalles bsicos",currentBalance:"Saldo actual",classification:"Clasificacin",allTransactions:"Todas las transacciones de la cuenta",reference:"Referencia",types:{asset:"Activo",liability:"Pasivo",equity:"Patrimonio",revenue:"Ingreso",expense:"Gasto"},categories:{currentAssets:"Activos Corrientes",fixedAssets:"Activos Fijos",currentLiabilities:"Pasivos Corrientes",longTermLiabilities:"Pasivos a Largo Plazo",ownersEquity:"Patrimonio del Propietario",operatingRevenue:"Ingresos Operacionales",operatingExpenses:"Gastos Operacionales"}},inventory:{title:"Gestin de Inventario",overview:"Resumen",products:"Productos y Stock",movements:"Movimientos",locations:"Ubicaciones",bulkMovement:"Movimiento Masivo",addMovement:"Agregar Movimiento",addProduct:"Agregar Producto",addLocation:"Agregar Ubicacin",singleMovement:"Agregar Movimiento Individual",addNewItem:"Agregar Nuevo Artculo",activeProducts:"Productos Activos",lowStockAlert:"Artculos con Stock Bajo",totalValue:"Valor Total del Stock",activeLocations:"Ubicaciones Activas",productsNeedRestocking:"productos necesitan reabastecimiento",recentMovements:"Movimientos Recientes",noProducts:"No hay productos en esta ubicacin",productName:"Nombre del Producto",productCode:"Cdigo del Producto",sku:"SKU",category:"Categoria",unitOfMeasure:"Unidad de Medida",unitCost:"Costo Unitario",minStockLevel:"Nivel Mnimo de Stock",maxStockLevel:"Nivel Mximo de Stock",locationName:"Nombre de Ubicacin",locationType:"Tipo de Ubicacin",locationCode:"Cdigo de Ubicacin",movementType:"Tipo de Movimiento",referenceNumber:"Nmero de Referencia",invoiceNumber:"Nmero de Factura",fromLocation:"Desde Ubicacin",toLocation:"Hacia Ubicacin",stockIn:"Entrada de Stock",stockOut:"Salida de Stock",transfer:"Transferencia",adjustment:"Ajuste",inStock:"En Stock",lowStock:"Stock Bajo",outOfStock:"Sin Stock",stockLevels:"Niveles de Stock",stockByLocation:"Stock por Ubicacin",searchProducts:"Buscar productos...",searchLocations:"Buscar ubicaciones...",noMovements:"No se encontraron movimientos",productDetails:"Detalles del Producto",locationDetails:"Detalles de Ubicacin",movementDetails:"Detalles del Movimiento",totalProducts:"Total de Productos",totalLocations:"Total de Ubicaciones",lastSeen:"Visto por ltima vez",warehouseType:"Almacn",storeType:"Tienda",supplierType:"Proveedor",customerType:"Cliente",currentlyManaged:"Gestionados actualmente",needAttention:"Necesitan atencin",currentWorth:"Valor actual",warehousesStores:"Almacenes y tiendas",thisMonth:"Este Mes",latestActivities:"ltimas actividades de inventario",searchMovements:"Buscar Movimientos",countingSheet:"Hoja de Conteo",physicalCount:"Conteo Fsico",physicalInventoryCount:"Conteo Fsico de Inventario",setupPhysicalCount:"Configurar Conteo Fsico de Inventario",setupDescription:"Configure los ajustes de su conteo fsico de inventario y comience el proceso de conteo.",countWillInclude:"Este conteo incluir {{count}} productos de {{location}} en la categora {{category}}.",startCounting:"Iniciar Conteo Fsico",counted:"Contado",remaining:"Restante",variances:"Variaciones",complete:"Completo",systemQty:"Cant. Sistema",variance:"Variacin",addNotes:"Agregar notas...",reviewAndConfirm:"Revisar y Confirmar Ajustes",reviewDescription:"Revise los ajustes de inventario a continuacin y confirme para actualizar su sistema.",stockIncreases:"Aumentos de Stock",stockDecreases:"Disminuciones de Stock",totalAdjustments:"Ajustes Totales",confirmAdjustments:"Confirmar Ajustes",adjustment:"Ajuste",perfectCount:"Conteo Perfecto!",noVariances:"No se encontraron variaciones. Su conteo fsico coincide exactamente con el sistema.",physicalCountAdjustment:"Ajuste de conteo fsico",inventoryCountingSheetTitle:"HOJA DE CONTEO DE INVENTARIO",location:"Ubicacin",allCategories:"Todas las Categoras",countedBy:"Contado por",verifiedBy:"Verificado por",instructions:"Instrucciones",countInstructions:["Contar todos los artculos fsicamente presentes en esta ubicacin",'Escribir el conteo real en la columna "Conteo Fsico"',"Dejar en blanco si el artculo no se encuentra",'Anotar cualquier discrepancia en la columna "Notas"',"Firmar y fechar cuando est completo"],productName:"Nombre del Producto",unit:"Unidad",totalProductsListed:"Total de Productos Listados",itemsCounted:"Artculos Contados",discrepanciesFound:"Discrepancias Encontradas",counterSignature:"Firma del Contador",supervisorSignature:"Firma del Supervisor",downloadCSV:"Descargar CSV",noAdjustmentsToDownload:"No hay ajustes para descargar",stockIncrease:"Aumento de Stock",stockDecrease:"Disminucin de Stock",purchaseReceive:"Compra/Recepcin",saleIssue:"Venta/Emisin",transfer:"Transferencia",adjustment:"Ajuste",movementType:"Tipo de Movimiento",fromLocation:"Ubicacin de Origen",toLocation:"Ubicacin de Destino",searchSourceLocation:"Buscar ubicacin de origen...",searchDestinationLocation:"Buscar ubicacin de destino...",searchLocation:"Buscar ubicacin...",addProduct:"Agregar Producto",searchProduct:"Buscar producto...",unitCost:"Costo Unitario",noProductsAdded:'No se han agregado productos an. Haga clic en "Agregar Producto" para comenzar.',createMovement:"Crear Movimiento",generalNotesPlaceholder:"Ingrese notas generales para este movimiento...",sortBy:"Ordenar Por",allLocations:"Todas las Ubicaciones",searchByProduct:"Buscar por producto, ubicacin, referencia, notas, factura...",allProducts:"Todos los Productos",allTypes:"Todos los Tipos",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",totalMovements:"Movimientos Totales",totalItems:"Artculos Totales",adjustMovements:"Intenta ajustar tus filtros o revisa ms tarde.",inventoryMovements:"Movimientos de Inventario",createdBy:"Creado Por",view:"Ver",enhanced:"Mejorado",legacy:"Clsico",addSingleMovement:"Agregar Movimiento Individual",inStockSubtitle:"En stock",itemsBelowThreshold:"Artculos bajo el umbral",inventoryWorth:"Valor del inventario",quantity:"Cantidad",units:"unidades",normal:"Normal",productsAndStock:"Productos y Stock",lowStockItems:"Artculos con Stock Bajo",totalStockValue:"Valor Total del Stock",warehousesAndStores:"Almacenes y tiendas",andMore:"...y {count} ms",latestInventoryActivities:"ltimas actividades de inventario",min:"Mn",max:"Mx",cost:"Costo",noProductsFound:"No se encontraron productos que coincidan con su bsqueda.",noProductsAvailable:"No hay productos disponibles.",noLocationsFound:"No se encontraron ubicaciones que coincidan con su bsqueda.",noLocationsAvailable:"No hay ubicaciones disponibles.",searchPlaceholder:"Buscar por producto, ubicacin, referencia, notas, factura...",noMovementsFound:"No se encontraron movimientos",tryAdjustingFilters:"Intenta ajustar tus filtros o revisa ms tarde.",transfers:"Transferencias",adjustments:"Ajustes",bulk:"Masivo",product:"Producto",location:"Ubicacin",store:"Tienda",supplier:"Proveedor",warehouse:"Almacn",movement:"Movimiento",editMovement:"Editar Movimiento",updateMovement:"Actualizar Movimiento",movementInformation:"Informacin del Movimiento",locationInformation:"Informacin de Ubicacin",searchProductsImages:"Buscar productos para ver imgenes...",searchForProducts:"Buscar Productos",startTypingToSearch:"Comienza a escribir para buscar y ver imgenes de productos",tryDifferentSearch:"Prueba con un trmino de bsqueda diferente"},employees:{title:"Gestin de Empleados",employeeList:"Lista de Empleados",addEmployee:"Agregar Empleado",editEmployee:"Editar Empleado",employeeDetails:"Detalles del Empleado",personalInfo:"Informacin Personal",employmentInfo:"Informacin Laboral",payrollInfo:"Informacin de Nmina",firstName:"Nombre",lastName:"Apellido",fullName:"Nombre Completo",email:"Correo Electrnico",phone:"Telfono",address:"Direccin",dateOfBirth:"Fecha de Nacimiento",employeeId:"ID de Empleado",department:"Departamento",position:"Puesto",hireDate:"Fecha de Contratacin",employmentStatus:"Estado Laboral",salary:"Salario",payFrequency:"Frecuencia de Pago",taxId:"ID Fiscal",bankAccount:"Cuenta Bancaria",emergencyContact:"Contacto de Emergencia",activeEmployees:"Empleados Activos",inactiveEmployees:"Empleados Inactivos",totalPayroll:"Nmina Total",searchEmployees:"Buscar empleados...",enterFullName:"Ingrese el nombre completo del empleado",enterPosition:"Ingrese el puesto de trabajo",enterEmail:"Ingrese la direccin de correo electrnico",enterPhone:"Ingrese el nmero de telfono",enterSalary:"Ingrese el salario anual",departments:{engineering:"Ingeniera",product:"Producto",design:"Diseo",marketing:"Marketing",sales:"Ventas",humanResources:"Recursos Humanos",finance:"Finanzas",operations:"Operaciones",analytics:"Analtica"}},entryBooks:{title:"Libros de Entrada",bookName:"Nombre del Libro",bookType:"Tipo de Libro",createBook:"Crear Libro",editBook:"Editar Libro",salesBook:"Libro de Ventas",purchaseBook:"Libro de Compras",cashBook:"Libro de Caja",generalBook:"Libro General",entries:"Entradas",addEntry:"Agregar Entrada",period:"Perodo",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",bookBalance:"Saldo del Libro",reconciledBalance:"Saldo Conciliado",difference:"Diferencia",reconcile:"Conciliar",isReconciled:"Est Conciliado",noBooks:"No se encontraron libros de entrada",createFirst:"Crea tu primer libro de entrada para comenzar",bookDetails:"Detalles del Libro",entriesCount:"entradas",bookOverview:"Resumen y detalles del libro",bookEntries:"Entradas del Libro",allEntries:"Todas las entradas en este libro",noEntries:"No se encontraron entradas",addFirst:"Agrega tu primera entrada a este libro",entryDate:"Fecha de Entrada",entryDescription:"Descripcin de Entrada",entryAmount:"Monto de Entrada",entryReference:"Referencia de Entrada"},banking:{title:"Consolidacin Bancaria",bankAccount:"Cuenta Bancaria",statementDate:"Fecha del Estado",beginningBalance:"Saldo Inicial",endingBalance:"Saldo Final",deposits:"Depsitos",withdrawals:"Retiros",bankCharges:"Cargos Bancarios",interest:"Intereses",reconcile:"Conciliar",matched:"Conciliado",unmatched:"No Conciliado",importStatement:"Importar Estado",manualEntry:"Entrada Manual",autoMatch:"Coincidencia Automtica",clearAll:"Limpiar Todo",reconciliationStatus:"Estado de Conciliacin",difference:"Diferencia",bookBalance:"Saldo en Libros",statementBalance:"Saldo del Estado",outstandingChecks:"Cheques Pendientes",depositsInTransit:"Depsitos en Trnsito",reconciled:"Conciliado",notReconciled:"No Conciliado",unreconciled:"No Conciliado",reconciliation:"Conciliacin",compareStatements:"Comparar estados bancarios con registros de libros de entrada",importCSV:"Importar CSV",startNewReconciliation:"Iniciar Nueva Conciliacin",bankAccountInfo:"Informacin de Cuenta Bancaria",currentAccountDetails:"Detalles de cuenta actual",lastReconciled:"ltima conciliacin",bankTransactions:"Transacciones Bancarias",selectedPeriod:"Perodo seleccionado",pending:"pendiente",bookEntriesForComparison:"Entradas de libros para comparacin",reconciliationRate:"Tasa de Conciliacin",completionStatus:"Estado de finalizacin",recentReconciliationSessions:"Sesiones de Conciliacin Recientes",latestActivity:"Actividad reciente",noRecentSessions:"No se encontraron sesiones de conciliacin recientes.",startFirstReconciliation:"Iniciar Primera Conciliacin",entryBookRecords:"Registros de Libros de Entrada",pleaseUploadCSV:"Por favor suba un archivo CSV",csvRequiresHeaderAndData:"El archivo CSV debe tener al menos un encabezado y una fila de datos",successfullyParsed:"Se analizaron exitosamente {count} filas",errorParsingCSV:"Error al analizar el archivo CSV. Verifique el formato.",dateDescriptionRequired:"Las columnas de Fecha y Descripcin son requeridas",importedTransaction:"Transaccin importada",successfullyImported:"Se importaron exitosamente {count} transacciones bancarias",errorImportingTransactions:"Error al importar transacciones. Verifique sus datos.",importBankStatementCSV:"Importar CSV de Estado Bancario",dropCSVHere:"Suelte el archivo CSV aqu",clickToUploadCSV:"Haga clic para cargar o arrastre y suelte el archivo CSV",supportedFormat:"Formato soportado: CSV con columnas de Fecha, Descripcin y Monto",mapCSVColumns:"Mapear Columnas CSV",dateColumn:"Columna de Fecha",selectColumn:"Seleccionar columna...",descriptionColumn:"Columna de Descripcin",referenceColumn:"Columna de Referencia",amountDebitColumn:"Columna de Monto/Dbito",creditColumn:"Columna de Crdito",balanceColumn:"Columna de Saldo",andMoreRows:"... y {count} filas ms",importing:"Importando...",importTransactions:"Importar {count} Transacciones",reconciliationComparison:"Comparacin de Conciliacin",bankStatements:"Estados Bancarios",totalTransactions:"Transacciones totales",totalEntries:"Entradas totales",unreconciledBank:"Banco No Conciliado",unreconciledBooks:"Libros No Conciliados",needAttention:"Necesitan atencin",unreconcile:"Desconciliar",clickToReconcile:"Hacer clic para conciliar",potentialMatchesFound:"Coincidencias Potenciales Encontradas",clickRecordToReconcile:"Haga clic en un registro a continuacin para conciliar",exactMatch:"Coincidencia Exacta",possibleMatch:"Posible Coincidencia",selected:"Seleccionado",clearSelection:"Limpiar Seleccin"},journal:{title:"Asientos Contables",entryNumber:"Nmero de Asiento",entryDate:"Fecha del Asiento",debit:"Dbito",credit:"Crdito",account:"Cuenta",memo:"Memo",reference:"Referencia",createEntry:"Crear Asiento",editEntry:"Editar Asiento",deleteEntry:"Eliminar Asiento",posted:"Registrado",draft:"Borrador",reversed:"Revertido",recurringEntry:"Asiento Recurrente",attachments:"Adjuntos",totalDebits:"Dbitos Totales",totalCredits:"Crditos Totales",outOfBalance:"Desbalanceado",balanced:"Balanceado"},forms:{requiredField:"Este campo es requerido",invalidEmail:"Direccin de correo invlida",invalidNumber:"Nmero invlido",invalidDate:"Fecha invlida",selectOption:"Por favor seleccione una opcin",enterValue:"Por favor ingrese un valor",confirmDelete:"Est seguro de que desea eliminar este elemento?",unsavedChanges:"Tiene cambios sin guardar. Desea continuar?",saveSuccess:"Guardado exitosamente",saveError:"Error al guardar datos",deleteSuccess:"Eliminado exitosamente",deleteError:"Error al eliminar elemento",duplicateAccountNumber:"El nmero de cuenta ya existe"},modals:{addInventory:"Agregar Movimiento de Inventario",bulkMovement:"Movimiento Masivo de Inventario",addProduct:"Agregar Nuevo Producto",addLocation:"Agregar Nueva Ubicacin",inventoryDetail:"Detalles del Artculo de Inventario",quickAdd:"Agregar Rpido",selectProduct:"Seleccionar Producto",selectLocation:"Seleccionar Ubicacin",enterQuantity:"Ingresar cantidad",enterCost:"Ingresar costo unitario",enterReference:"Ingresar nmero de referencia",addNotes:"Agregar notas (opcional)",generalInformation:"Informacin General",stockInformation:"Informacin de Stock",locationInformation:"Informacin de Ubicacin",movementInformation:"Informacin de Movimiento",addToInventory:"Agregar al Inventario",createProduct:"Crear Producto",createLocation:"Crear Ubicacin",processing:"Procesando...",addingMovement:"Agregando movimiento...",creatingProduct:"Creando producto...",creatingLocation:"Creando ubicacin..."},products:{title:"Productos",addNew:"Agregar Nuevo Producto",totalProducts:"Total de Productos",inCatalog:"En catlogo",activeProducts:"Productos Activos",currentlyAvailable:"Actualmente disponibles",outOfStock:"Sin Stock",needsRestock:"Necesita reabastecimiento",productCatalog:"Catlogo de Productos",manageYourProducts:"Gestiona tus productos y precios",inStock:"En Stock",furniture:"Muebles",electronics:"Electrnicos",supplies:"Suministros",lighting:"Iluminacin"},invoices:{title:"Panel de Facturas",invoice:"Factura",invoiceNumber:"Nmero de Factura",invoiceDetails:"Detalles de Factura",customerInformation:"Informacin del Cliente",customerName:"Nombre del Cliente",legalName:"Nombre Legal",contactInformation:"Informacin de Contacto",idPassport:"ID/Pasaporte",phoneNumber:"Nmero de Telfono",altPhone:"Telfono Alt.",address:"Direccin",between:"Entre",and:"y",products:"Productos",reservations:"Reservaciones",unitPrice:"Precio Unitario",total:"Total",subtotal:"Subtotal",category:"Categoria",totalRevenue:"Ingresos Totales",totalProducts:"Total de Productos",totalReservations:"Total de Reservaciones",aranceles:"Aranceles (Aduanas)",uniqueCustomers:"Clientes nicos",averageInvoice:"Factura Promedio",completed:"Completada",pending:"Pendiente",storesActive:"Tiendas Activas",topProducts:"Productos Principales",mostSoldProducts:"Productos ms vendidos por cantidad",reservationsByType:"Reservaciones por Tipo",distributionOfCategories:"Distribucin de categoras de reservaciones",recentInvoices:"Facturas Recientes",showingInvoices:"Mostrando {{count}} facturas",date:"Fecha",customer:"Cliente",store:"Tienda",actions:"Acciones",view:"Ver",status:"Estado",printInvoice:"Imprimir Factura",exportPdf:"Exportar PDF",backToDashboard:"Volver al Panel",fromInvoices:"De {{count}} facturas",value:"valor",activeCustomers:"Clientes activos",perInvoiceValue:"Valor por factura",locations:"Ubicaciones",mostRecentActivity:"Actividad ms reciente",storeLocation:"Ubicacin de Tienda",allStores:"Todas las Tiendas",fromDate:"Fecha Desde",toDate:"Fecha Hasta",clearFilters:"Limpiar Filtros",customsFees:"Aranceles totales",salesType:"VENTAS",packagesOrder:"Orden de Paquetes",businessId:"ID de Negocio",orderKey:"Clave de Orden",reservationType:"Tipo de Reservacin",arancel:"Arancel",key:"Clave",noInvoicesFound:"No se encontraron facturas",loadingInvoices:"Cargando facturas...",errorLoadingInvoices:"Error al cargar facturas",refreshData:"Actualizar Datos",currentStockValue:"Valor de Stock Actual",filterByStore:"Filtrar por tienda",filterByDate:"Filtrar por rango de fechas",totalCustomsFees:"Aranceles totales",averageValue:"Valor promedio"},unauthorized:{title:"Acceso Restringido",accessDenied:"Acceso Denegado",noPermission:"No tienes permisos para acceder a",thisFeature:"esta funcionalidad",whySeeing:"Por qu veo esto?",explanation:"Tu cuenta no tiene los permisos necesarios para ver este contenido.",requiredPermission:"Permiso requerido:",goToDashboard:"Ir al Panel de Control",goBack:"Regresar",featuresCanAccess:"Funcionalidades a las que puedes acceder:",dashboardAccess:"Panel de control y estadsticas generales",profileAccess:"Tu perfil y configuraciones",roleBasedAccess:"Funcionalidades habilitadas para tu rol",needAccess:"Necesitas acceso? Contacta a tu administrador o gerente para solicitar los permisos apropiados.",permissions:{accountAccess:"Acceso a Gestin de Cuentas",inventoryAccess:"Acceso a Inventario",employeeAccess:"Acceso a Recursos Humanos",bankingAccess:"Acceso Bancario",journalAccess:"Acceso a Asientos Contables",adminAccess:"Acceso Administrativo",financialReporting:"Acceso a Reportes Financieros",invoiceManagement:"Acceso a Gestin de Facturas",productManagement:"Acceso a Gestin de Productos"}}}},Rw=()=>{if(typeof window<"u"){const t=localStorage.getItem("hrmfinance-language");if(t&&["en","es"].includes(t))return t}return"en"},[Fh,Dw]=ge(Rw()),lt=()=>({t:(n,i,o)=>{const a=Fh(),c=n.split(".");let d=kw[a];for(const m of c)if(d&&typeof d=="object"&&m in d)d=d[m];else return i||n;let h=typeof d=="string"?d:i||n;return o&&typeof h=="string"&&Object.keys(o).forEach(m=>{const g=o[m],_=`{{${m}}}`;h=h.replace(new RegExp(_,"g"),String(g))}),h},language:()=>Fh(),setLanguage:n=>{Dw(n),typeof window<"u"&&localStorage.setItem("hrmfinance-language",n)}});var Nw=z("<div><label></label><select><option value>"),Lw=z("<span>*"),Mw=z("<option>");const mr=t=>{const{t:e}=lt(),r={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},n={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},i={"margin-bottom":"1rem"};return(()=>{var o=Nw(),a=o.firstChild,c=a.nextSibling,d=c.firstChild;return u(o,i),u(a,r),s(a,()=>t.label,null),s(a,(()=>{var h=fe(()=>!!t.required);return()=>h()&&(()=>{var m=Lw();return m.style.setProperty("color","var(--primary-color)"),m})()})(),null),c.addEventListener("blur",h=>h.target.style.borderColor="var(--border-color)"),c.addEventListener("focus",h=>h.target.style.borderColor="var(--primary-color)"),c.addEventListener("change",h=>t.onChange(h.target.value)),u(c,n),s(d,()=>e("forms.selectOption")),s(c,()=>t.options.map(h=>(()=>{var m=Mw();return s(m,()=>h.label),re(()=>m.value=h.value),m})()),null),re(h=>{var m=t.required,g=t.disabled;return m!==h.e&&(c.required=h.e=m),g!==h.t&&(c.disabled=h.t=g),h},{e:void 0,t:void 0}),re(()=>c.value=t.value),o})()};var Ow=z("<main><div>"),Vw=z("<header><h1>");const kr=t=>{const e={"min-height":"100vh",background:"var(--background-color)"},r={"max-width":"1200px",margin:"0 auto",padding:"2rem"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},i={"font-size":"2rem","font-weight":"700",color:"var(--text-primary)",margin:"0"};return(()=>{var o=Ow(),a=o.firstChild;return u(o,e),u(a,r),s(a,(()=>{var c=fe(()=>!!t.title);return()=>c()&&(()=>{var d=Vw(),h=d.firstChild;return u(d,n),u(h,i),s(h,()=>t.title),d})()})(),null),s(a,()=>t.children,null),o})()};var Bw=z("<div><span></span><select><option value=en> </option><option value=es> ");const Fw=()=>{const{t,language:e,setLanguage:r}=lt(),n={display:"flex","align-items":"center",gap:"0.5rem","margin-left":"auto"},i={padding:"0.5rem 1rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",background:"var(--surface-color)",color:"var(--text-primary)",cursor:"pointer","font-size":"0.875rem","font-weight":"500",transition:"all 0.2s ease","min-width":"120px"},o={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},a=c=>{const d=c.target;r(d.value)};return(()=>{var c=Bw(),d=c.firstChild,h=d.nextSibling,m=h.firstChild;m.firstChild;var g=m.nextSibling;return g.firstChild,u(c,n),u(d,o),h.addEventListener("change",a),u(h,i),s(m,()=>t("common.english"),null),s(g,()=>t("common.spanish"),null),re(()=>h.value=e()),c})()};var Uh=z('<img alt="User avatar">'),Uw=z("<div class=user-info-desktop><span>"),jw=z("<button class=sign-out-desktop>Sign Out"),zw=z("<div><div><span></span></div><button>Sign Out"),qw=z(`<nav><div><div class=desktop-nav></div><div><button class=mobile-menu-button><svg width=24 height=24 viewBox="0 0 24 24"fill=currentColor><path></path></svg></button></div></div><div class=mobile-nav></div><style>
        .nav-active {
          background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)) !important;
          color: white !important;
          box-shadow: var(--shadow-sm);
        }
        
        .desktop-nav a:hover:not(.nav-active),
        .nav-group button:hover {
          background: var(--background-color);
          color: var(--text-primary);
        }
        
        .mobile-nav a:hover:not(.nav-active) {
          background: var(--background-color);
          color: var(--text-primary);
        }

        /* Create invisible bridge to prevent gap issues */
        .nav-group::before {
          content: '';
          position: absolute;
          top: 100%;
          left: 0;
          right: 0;
          height: 0.5rem;
          z-index: 9;
        }
        
        @media (max-width: 768px) {
          .desktop-nav {
            display: none !important;
          }
          
          .mobile-menu-button {
            display: block !important;
          }
          
          .user-info-desktop,
          .sign-out-desktop {
            display: none !important;
          }
          
          nav > div:first-child {
            padding: 1rem;
          }
        }
        
        @media (min-width: 769px) {
          .mobile-nav {
            display: none !important;
          }
        }
      `),Gw=z("<div class=nav-group><button> <span></span></button><div>"),Hw=z("<div>"),Yw=z("<div><div><span> </span><span>");const Ww=()=>{const{t}=lt(),[e,r]=ge(!1),[n,i]=ge(null),[o,a]=ge(null),c={background:"var(--surface-color)","border-bottom":"1px solid var(--border-color)","box-shadow":"var(--shadow-sm)","backdrop-filter":"blur(10px)",position:"sticky",top:"0","z-index":"100"},d={display:"flex","align-items":"center","justify-content":"space-between",padding:"1rem 2rem",margin:"0 auto",position:"relative"},h={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","text-decoration":"none"},m={display:"flex",gap:"1rem","align-items":"center",flex:"1","margin-left":"2rem"},g={display:"none",position:"absolute",top:"100%",left:"0",right:"0",background:"var(--surface-color)","border-top":"1px solid var(--border-color)","box-shadow":"var(--shadow-md)","max-height":"70vh","overflow-y":"auto"},_={position:"relative",display:"flex","align-items":"center"},A={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem",background:"transparent",border:"none",color:"var(--text-secondary)","font-weight":"500","font-size":"0.875rem",cursor:"pointer","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease","white-space":"nowrap"},M={position:"absolute",top:"100%",left:"0",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","min-width":"200px","margin-top":"0.25rem","z-index":"10",display:"none","padding-top":"0.25rem"},L={"border-bottom":"1px solid var(--border-color)"},k={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",cursor:"pointer","font-weight":"600",color:"var(--text-primary)"},R={display:"block","text-decoration":"none",color:"var(--text-secondary)",padding:"0.75rem 1rem","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease","white-space":"nowrap"},W={...R,padding:"0.75rem 1.5rem","border-bottom":"1px solid var(--border-light)"},ie={display:"none",background:"transparent",border:"none",padding:"0.5rem",cursor:"pointer",color:"var(--text-primary)"},te={display:"flex","align-items":"center",gap:"1rem"},ye={display:"flex","align-items":"center",gap:"0.75rem",padding:"0.5rem 1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",color:"var(--text-primary)"},ae={width:"32px",height:"32px","border-radius":"50%","object-fit":"cover"},$={...R,cursor:"pointer",border:"1px solid var(--border-color)",background:"transparent","border-radius":"var(--border-radius-sm)"},S=()=>{vt.signOut()},p=T=>{const U=vt.state?.profile;return U?U[T]===!0||U.isAdmin===!0:!1},C=()=>{r(!e())},P=T=>{i(n()===T?null:T)},E=T=>{const U=o();U&&(clearTimeout(U),a(null)),i(T)},y=()=>{const T=setTimeout(()=>{i(null)},300);a(T)},oe=[{name:"Finance",icon:"",items:[{path:"/accounts",label:t("navigation.accounts"),permission:"AccountAccess",icon:""},{path:"/balance-sheet",label:t("navigation.balanceSheet"),permission:"AccountAccess",icon:""},{path:"/bank-consolidations",label:t("navigation.consolidate"),permission:"BankingAccess",icon:""}]},{name:"Operations",icon:"",items:[{path:"/inventory",label:t("navigation.inventory"),permission:"InventoryAccess",icon:""},{path:"/entry-books",label:t("navigation.entryBooks"),permission:"JournalAccess",icon:""}]},{name:"Management",icon:"",items:[{path:"/employees",label:t("navigation.employees"),permission:"EmployeeAccess",icon:""},{path:"/admin/users",label:"Admin",permission:"isAdmin",icon:"",adminOnly:!0}]}],K=()=>oe.map(T=>({...T,items:T.items.filter(U=>U.adminOnly?vt.state?.profile?.isAdmin:p(U.permission))})).filter(T=>T.items.length>0);return(()=>{var T=qw(),U=T.firstChild,B=U.firstChild,x=B.nextSibling,I=x.firstChild,N=I.firstChild,Z=N.firstChild,j=U.nextSibling;return s(U,b(qi,{href:"/",style:h,children:"HRM Finance"}),B),u(B,m),s(B,b(qi,{href:"/",style:R,activeClass:"nav-active",get children(){return[" ",fe(()=>t("navigation.dashboard"))]}}),null),s(B,b(pt,{get each(){return K()},children:J=>(()=>{var w=Gw(),V=w.firstChild,X=V.firstChild,Y=X.nextSibling,se=V.nextSibling;return w.addEventListener("mouseleave",y),w.addEventListener("mouseenter",()=>E(J.name)),s(V,()=>J.icon,X),s(V,()=>J.name,Y),Y.style.setProperty("font-size","0.75rem"),se.addEventListener("mouseleave",y),se.addEventListener("mouseenter",()=>E(J.name)),s(se,b(pt,{get each(){return J.items},children:O=>b(qi,{get href(){return O.path},style:R,activeClass:"nav-active",onClick:()=>i(null),get children(){return[fe(()=>O.icon)," ",fe(()=>O.label)]}})})),re(O=>{var F=_,le=A,pe={...M,display:n()===J.name?"block":"none"};return O.e=u(w,F,O.e),O.t=u(V,le,O.t),O.a=u(se,pe,O.a),O},{e:void 0,t:void 0,a:void 0}),w})()}),null),u(x,te),s(x,b(Fw,{}),I),s(x,b(Ne,{get when(){return vt.currentUser},get children(){return[(()=>{var J=Uw(),w=J.firstChild;return s(J,b(Ne,{get when(){return vt.currentUser?.photoURL},get children(){var V=Uh();return re(X=>{var Y=vt.currentUser.photoURL,se=ae;return Y!==X.e&&ct(V,"src",X.e=Y),X.t=u(V,se,X.t),X},{e:void 0,t:void 0}),V}}),w),s(w,()=>vt.currentUser?.displayName||vt.currentUser?.email),re(V=>u(J,ye,V)),J})(),(()=>{var J=jw();return J.addEventListener("mouseleave",w=>{w.currentTarget.style.background="transparent",w.currentTarget.style.color="var(--text-secondary)"}),J.addEventListener("mouseenter",w=>{w.currentTarget.style.background="var(--background-color)",w.currentTarget.style.color="var(--text-primary)"}),J.$$click=S,re(w=>u(J,$,w)),J})()]}}),I),I.$$click=C,u(I,ie),s(j,b(qi,{href:"/",style:W,activeClass:"nav-active",onClick:()=>r(!1),get children(){return[" ",fe(()=>t("navigation.dashboard"))]}}),null),s(j,b(pt,{get each(){return K()},children:J=>(()=>{var w=Yw(),V=w.firstChild,X=V.firstChild,Y=X.firstChild,se=X.nextSibling;return u(w,L),V.$$click=()=>P(J.name),u(V,k),s(X,()=>J.icon,Y),s(X,()=>J.name,null),se.style.setProperty("transition","transform 0.2s"),s(w,b(Ne,{get when(){return n()===J.name},get children(){var O=Hw();return O.style.setProperty("background","var(--background-color)"),s(O,b(pt,{get each(){return J.items},children:F=>b(qi,{get href(){return F.path},get style(){return{...W,"padding-left":"3rem"}},activeClass:"nav-active",onClick:()=>r(!1),get children(){return[fe(()=>F.icon)," ",fe(()=>F.label)]}})})),O}}),null),re(O=>(O=n()===J.name?"rotate(180deg)":"none")!=null?se.style.setProperty("transform",O):se.style.removeProperty("transform")),w})()}),null),s(j,b(Ne,{get when(){return vt.currentUser},get children(){var J=zw(),w=J.firstChild,V=w.firstChild,X=w.nextSibling;return J.style.setProperty("padding","1rem"),J.style.setProperty("border-top","2px solid var(--border-color)"),s(w,b(Ne,{get when(){return vt.currentUser?.photoURL},get children(){var Y=Uh();return re(se=>{var O=vt.currentUser.photoURL,F=ae;return O!==se.e&&ct(Y,"src",se.e=O),se.t=u(Y,F,se.t),se},{e:void 0,t:void 0}),Y}}),V),s(V,()=>vt.currentUser?.displayName||vt.currentUser?.email),X.$$click=()=>{S(),r(!1)},re(Y=>{var se={...ye,"margin-bottom":"1rem"},O={...$,width:"100%"};return Y.e=u(w,se,Y.e),Y.t=u(X,O,Y.t),Y},{e:void 0,t:void 0}),J}}),null),re(J=>{var w=c,V=d,X=e()?"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z":"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z",Y={...g,display:e()?"block":"none"};return J.e=u(T,w,J.e),J.t=u(U,V,J.t),X!==J.a&&ct(Z,"d",J.a=X),J.o=u(j,Y,J.o),J},{e:void 0,t:void 0,a:void 0,o:void 0}),T})()};At(["click"]);var Kw=z("<div><div><div></div><h1></h1><p>.</p><div><p><strong></strong><br></p></div><div><button></button></div><div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><p>"),jh=z("<br>"),Qw=z("<strong>");const Jw=t=>{const{t:e}=lt(),r={"min-height":"calc(100vh - 200px)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},n={"text-align":"center","max-width":"600px",width:"100%"},i={"font-size":"5rem",color:"#e53e3e","margin-bottom":"2rem"},o={"font-size":"2.5rem","font-weight":"700",color:"#1a202c","margin-bottom":"1rem"},a={"font-size":"1.25rem",color:"#718096","margin-bottom":"2rem","line-height":"1.6"},c={background:"#f7fafc",border:"1px solid #e2e8f0","border-radius":"0.5rem",padding:"1.5rem","margin-bottom":"2rem"},d={color:"#4a5568","font-size":"1rem","line-height":"1.6"},h={display:"flex",gap:"1rem","justify-content":"center","flex-wrap":"wrap"},m={padding:"0.75rem 2rem","border-radius":"0.5rem","text-decoration":"none","font-weight":"500",transition:"all 0.2s",display:"inline-block"},g={...m,background:"var(--primary-color)",color:"white",border:"2px solid var(--primary-color)"},_={...m,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},A={"text-align":"left","margin-top":"2rem",padding:"0 2rem"},M={display:"flex","align-items":"center",gap:"0.75rem","margin-bottom":"1rem",color:"#4a5568"},L={color:"#48bb78","font-size":"1.25rem"};return b(kr,{get title(){return e("unauthorized.title")},get children(){var k=Kw(),R=k.firstChild,W=R.firstChild,ie=W.nextSibling,te=ie.nextSibling,ye=te.firstChild,ae=te.nextSibling,$=ae.firstChild,S=$.firstChild;S.nextSibling;var p=ae.nextSibling,C=p.firstChild,P=p.nextSibling,E=P.firstChild,y=E.nextSibling,oe=y.firstChild,K=oe.nextSibling,T=y.nextSibling,U=T.firstChild,B=U.nextSibling,x=T.nextSibling,I=x.firstChild,N=I.nextSibling,Z=P.nextSibling,j=Z.firstChild;return u(k,r),u(R,n),u(W,i),u(ie,o),s(ie,()=>e("unauthorized.accessDenied")),u(te,a),s(te,()=>e("unauthorized.noPermission"),ye),s(te,(()=>{var J=fe(()=>!!t.featureName);return()=>J()?` ${t.featureName}`:` ${e("unauthorized.thisFeature")}`})(),ye),u(ae,c),u($,d),s(S,()=>e("unauthorized.whySeeing")),s($,()=>e("unauthorized.explanation"),null),s($,(()=>{var J=fe(()=>!!t.requiredPermission);return()=>J()&&[jh(),jh(),(()=>{var w=Qw();return s(w,()=>e("unauthorized.requiredPermission")),w})()," ",fe(()=>t.requiredPermission)]})(),null),u(p,h),s(p,b(qi,{href:"/",style:g,get children(){return e("unauthorized.goToDashboard")}}),C),C.$$click=()=>window.history.back(),s(C,()=>e("unauthorized.goBack")),u(P,A),E.style.setProperty("margin-bottom","1rem"),E.style.setProperty("color","#2d3748"),s(E,()=>e("unauthorized.featuresCanAccess")),s(K,()=>e("unauthorized.dashboardAccess")),s(B,()=>e("unauthorized.profileAccess")),s(N,()=>e("unauthorized.roleBasedAccess")),Z.style.setProperty("margin-top","3rem"),Z.style.setProperty("padding","1.5rem"),Z.style.setProperty("background","#edf2f7"),Z.style.setProperty("border-radius","0.5rem"),j.style.setProperty("color","#4a5568"),j.style.setProperty("font-size","0.875rem"),s(j,()=>e("unauthorized.needAccess")),re(J=>{var w=_,V=M,X=L,Y=M,se=L,O=M,F=L;return J.e=u(C,w,J.e),J.t=u(y,V,J.t),J.a=u(oe,X,J.a),J.o=u(T,Y,J.o),J.i=u(U,se,J.i),J.n=u(x,O,J.n),J.s=u(I,F,J.s),J},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),k}})};At(["click"]);const tn=t=>{const{t:e}=lt(),r=()=>{if(!t.permission)return!0;const i=vt.state?.profile;if(!i)return!1;switch(t.permission){case"AccountAccess":return i.AccountAccess===!0;case"InventoryAccess":return i.InventoryAccess===!0;case"EmployeeAccess":return i.EmployeeAccess===!0;case"BankingAccess":return i.BankingAccess===!0;case"JournalAccess":return i.JournalAccess===!0;case"AdminAccess":return i.isAdmin===!0;default:return i[t.permission]===!0}},n=()=>{if(t.requiredPermission)return t.requiredPermission;switch(t.permission){case"AccountAccess":return e("unauthorized.permissions.accountAccess");case"InventoryAccess":return e("unauthorized.permissions.inventoryAccess");case"EmployeeAccess":return e("unauthorized.permissions.employeeAccess");case"BankingAccess":return e("unauthorized.permissions.bankingAccess");case"JournalAccess":return e("unauthorized.permissions.journalAccess");case"AdminAccess":return e("unauthorized.permissions.adminAccess");default:return t.permission}};return b(Ne,{get when(){return r()},get fallback(){return t.fallback||b(Jw,{get featureName(){return t.featureName},get requiredPermission(){return n()}})},get children(){return t.children}})};var Xw=z('<button title="Open Dev Tools">'),Zw=z("<span>(<!>)"),eC=z("<div><span></span><span>"),zh=z("<div>"),tC=z("<div>Database reset only available in fake mode"),rC=z("<div><div>Loading..."),nC=z("<div><div><h3> Dev Tools</h3><button></button></div><div><div>API Mode</div><div><button>Fake Server</button><button>Real API</button><button>Hybrid</button></div><div>Current: <strong></strong></div></div><div><div>Health Status</div></div><div><div>Database Stats</div></div><div><div>Actions</div><div><button> Refresh Stats</button><button> Health Check</button></div><div><button> Reset DB</button></div></div><div><div>Info</div><div> <strong>Fake Server:</strong> Uses local mock data<br> <strong>Real API:</strong> Connects to actual backend<br> <strong>Hybrid:</strong> Real API with fake fallback<br> Settings are saved in localStorage"),iC=z("<div>Loading..."),oC=z("<div><span>:</span><span>");const sC=()=>{const[t,e]=ge(!1),[r,n]=ge(Xo.getMode()),[i,o]=ge({}),[a,c]=ge(null),[d,h]=ge(!1);qr(async()=>{await m(),await g()});const m=async()=>{try{const $=await ud.getStats();o($)}catch($){console.error("Failed to load stats:",$)}},g=async()=>{try{const $=await ud.healthCheck();c($)}catch($){console.error("Health check failed:",$),c({status:"error",error:$.message})}},_=async $=>{h(!0);try{Xo.setMode($),n($),await m(),await g()}catch(S){console.error("Failed to change API mode:",S)}finally{h(!1)}},A=async()=>{if(confirm("Are you sure you want to reset the fake database to its initial state?")){h(!0);try{const $=await Nr.utils.resetDatabase();alert($.message),await m()}catch($){console.error("Failed to reset database:",$),alert("Failed to reset database")}finally{h(!1)}}},M={position:"fixed",bottom:"20px",right:"20px","z-index":"10000","font-family":"monospace"},L={background:"#1a1a1a",color:"#fff",border:"1px solid #333","border-radius":"8px",padding:"16px","min-width":"300px","max-width":"400px","box-shadow":"0 4px 20px rgba(0,0,0,0.3)"},k={background:"#007acc",color:"#fff",border:"none","border-radius":"50%",width:"50px",height:"50px",cursor:"pointer","font-size":"20px","box-shadow":"0 2px 10px rgba(0,0,0,0.2)",display:"flex","align-items":"center","justify-content":"center"},R={background:"#333",color:"#fff",border:"1px solid #555","border-radius":"4px",padding:"6px 12px",cursor:"pointer","font-size":"12px","margin-right":"8px","margin-bottom":"8px"},W={...R,background:"#007acc","border-color":"#007acc"},ie={"margin-bottom":"16px","padding-bottom":"12px","border-bottom":"1px solid #333"},te={"font-size":"14px","font-weight":"bold","margin-bottom":"8px",color:"#007acc"},ye={display:"flex","justify-content":"space-between","font-size":"12px","margin-bottom":"4px"},ae=$=>({display:"inline-block",width:"8px",height:"8px","border-radius":"50%","margin-right":"8px",background:$==="healthy"?"#00ff00":$==="error"?"#ff0000":"#ffff00"});return(()=>{var $=zh();return s($,b(Ne,{get when(){return!t()},get children(){var S=Xw();return S.$$click=()=>e(!0),u(S,k),S}}),null),s($,b(Ne,{get when(){return t()},get children(){var S=nC(),p=S.firstChild,C=p.firstChild,P=C.nextSibling,E=p.nextSibling,y=E.firstChild,oe=y.nextSibling,K=oe.firstChild,T=K.nextSibling,U=T.nextSibling,B=oe.nextSibling,x=B.firstChild,I=x.nextSibling,N=E.nextSibling,Z=N.firstChild,j=N.nextSibling,J=j.firstChild,w=j.nextSibling,V=w.firstChild,X=V.nextSibling,Y=X.firstChild,se=Y.nextSibling,O=X.nextSibling,F=O.firstChild,le=w.nextSibling,pe=le.firstChild,ve=pe.nextSibling;return u(S,L),p.style.setProperty("display","flex"),p.style.setProperty("justify-content","space-between"),p.style.setProperty("align-items","center"),p.style.setProperty("margin-bottom","16px"),C.style.setProperty("margin","0"),C.style.setProperty("color","#007acc"),C.style.setProperty("font-size","16px"),P.$$click=()=>e(!1),K.$$click=()=>_("fake"),T.$$click=()=>_("real"),U.$$click=()=>_("hybrid"),B.style.setProperty("font-size","11px"),B.style.setProperty("color","#888"),B.style.setProperty("margin-top","4px"),s(I,r),s(B,()=>r()==="fake"&&" (Using fake server)",null),s(B,()=>r()==="real"&&" (Using real API)",null),s(B,()=>r()==="hybrid"&&" (Real API with fallback)",null),s(N,b(Ne,{get when(){return a()},get fallback(){return(()=>{var ce=iC();return ce.style.setProperty("font-size","12px"),ce})()},get children(){return[(()=>{var ce=eC(),H=ce.firstChild,D=H.nextSibling;return ce.style.setProperty("display","flex"),ce.style.setProperty("align-items","center"),ce.style.setProperty("font-size","12px"),s(D,()=>a()?.status||"Unknown"),s(ce,b(Ne,{get when(){return a()?.timestamp},get children(){var Q=Zw(),G=Q.firstChild,he=G.nextSibling;return he.nextSibling,Q.style.setProperty("margin-left","8px"),Q.style.setProperty("color","#888"),s(Q,()=>new Date(a().timestamp).toLocaleTimeString(),he),Q}}),null),re(Q=>u(H,ae(a()?.status||"unknown"),Q)),ce})(),b(Ne,{get when(){return a()?.error},get children(){var ce=zh();return ce.style.setProperty("font-size","11px"),ce.style.setProperty("color","#ff6666"),ce.style.setProperty("margin-top","4px"),s(ce,()=>a().error),ce}})]}}),null),s(j,b(pt,{get each(){return Object.entries(i())},children:([ce,H])=>(()=>{var D=oC(),Q=D.firstChild,G=Q.firstChild,he=Q.nextSibling;return u(D,ye),Q.style.setProperty("text-transform","capitalize"),s(Q,ce,G),he.style.setProperty("color","#00ff00"),s(he,H),D})()}),null),Y.$$click=m,se.$$click=g,O.style.setProperty("margin-top","8px"),F.$$click=A,s(w,b(Ne,{get when(){return r()!=="fake"},get children(){var ce=tC();return ce.style.setProperty("font-size","11px"),ce.style.setProperty("color","#888"),ce.style.setProperty("margin-top","4px"),ce}}),null),ve.style.setProperty("font-size","11px"),ve.style.setProperty("color","#888"),ve.style.setProperty("line-height","1.4"),s(S,b(Ne,{get when(){return d()},get children(){var ce=rC(),H=ce.firstChild;return ce.style.setProperty("position","absolute"),ce.style.setProperty("top","0"),ce.style.setProperty("left","0"),ce.style.setProperty("right","0"),ce.style.setProperty("bottom","0"),ce.style.setProperty("background","rgba(0,0,0,0.7)"),ce.style.setProperty("display","flex"),ce.style.setProperty("align-items","center"),ce.style.setProperty("justify-content","center"),ce.style.setProperty("border-radius","8px"),H.style.setProperty("color","#fff"),H.style.setProperty("font-size","14px"),ce}}),null),re(ce=>{var H={...R,padding:"4px 8px"},D=ie,Q=te,G=r()==="fake"?W:R,he=d(),me=r()==="real"?W:R,ee=d(),ne=r()==="hybrid"?W:R,Se=d(),we=ie,ue=te,be=ie,de=te,Pe=ie,$e=te,xe=R,ke=d(),Be=R,Qe=d(),Ue={...R,background:"#cc4400","border-color":"#cc4400"},Te=d()||r()!=="fake",Fe=te;return ce.e=u(P,H,ce.e),ce.t=u(E,D,ce.t),ce.a=u(y,Q,ce.a),ce.o=u(K,G,ce.o),he!==ce.i&&(K.disabled=ce.i=he),ce.n=u(T,me,ce.n),ee!==ce.s&&(T.disabled=ce.s=ee),ce.h=u(U,ne,ce.h),Se!==ce.r&&(U.disabled=ce.r=Se),ce.d=u(N,we,ce.d),ce.l=u(Z,ue,ce.l),ce.u=u(j,be,ce.u),ce.c=u(J,de,ce.c),ce.w=u(w,Pe,ce.w),ce.m=u(V,$e,ce.m),ce.f=u(Y,xe,ce.f),ke!==ce.y&&(Y.disabled=ce.y=ke),ce.g=u(se,Be,ce.g),Qe!==ce.p&&(se.disabled=ce.p=Qe),ce.b=u(F,Ue,ce.b),Te!==ce.T&&(F.disabled=ce.T=Te),ce.A=u(pe,Fe,ce.A),ce},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),S}}),null),re(S=>u($,M,S)),$})()};At(["click"]);var aC=z("<br>"),lC=z("<div><h3>Products</h3><table><thead><tr><th>Code</th><th>Description</th><th>Qty</th><th>Unit Price</th><th>Total</th></tr></thead><tbody>"),cC=z("<div><h3>Reservations</h3><table><thead><tr><th>Type</th><th>Qty</th><th>Unit Price</th><th>Arancel</th><th>Total</th></tr></thead><tbody>"),uC=z("<div><span>Products Subtotal:</span><span>"),dC=z("<div><span>Reservations Subtotal:</span><span>"),hC=z("<div class=invoice-display><div><div><h1>HRM Finance</h1><div>Business ID: </div></div><div><div></div><h2></h2><div></div><div></div><div>: </div></div></div><div><h3></h3><div><div><div>Customer Name</div><div></div><div>Legal Name</div><div> <!> <!> </div><div>ID/Passport</div><div>CID: <!> | Passport: </div></div><div><div>Contact Information</div><div>Phone: </div><div>Address</div><div> #<br>Between <!> and <br>, <br>, </div></div></div></div><div><div><div><span>Total:</span><span></span></div></div></div><div>Store: <!> | Order Key: </div><div><button> </button><button> </button></div><style>"),qh=z("<tr><td></td><td></td><td></td><td></td><td>");const mC=t=>{const{t:e}=lt(),r=S=>new Date(S).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),n=S=>{const p=typeof S=="string"?parseFloat(S):S;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(p)},i=We(()=>{let S=0,p=0;t.invoice.products.forEach(y=>{const K=Math.abs(y.qty)*parseFloat(y.salePrice);S+=K}),t.invoice.reservas.forEach(y=>{const oe=parseInt(y.qty),K=parseFloat(y.price);p+=oe*K});const C=S+p,P=0,E=C+P;return{productSubtotal:S,reservaSubtotal:p,subtotal:C,tax:P,total:E}}),o={"max-width":"800px",margin:"0 auto",padding:"2rem",background:"white","box-shadow":"0 0 20px rgba(0,0,0,0.1)","border-radius":"var(--border-radius)"},a={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"2rem","padding-bottom":"2rem","border-bottom":"2px solid #e0e0e0"},c={flex:"1"},d={"text-align":"right",flex:"1"},h={display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600","text-transform":"uppercase",background:t.invoice.isCompleted?"#d4edda":"#fff3cd",color:t.invoice.isCompleted?"#155724":"#856404","margin-bottom":"0.5rem"},m={"margin-bottom":"2rem"},g={"font-size":"1.1rem","font-weight":"600","margin-bottom":"1rem",color:"#333"},_={display:"grid","grid-template-columns":"1fr 1fr",gap:"1.5rem"},A={background:"#f8f9fa",padding:"1rem","border-radius":"var(--border-radius-sm)",border:"1px solid #e9ecef"},M={"font-size":"0.875rem",color:"#666","margin-bottom":"0.25rem"},L={"font-size":"1rem",color:"#333","font-weight":"500"},k={width:"100%","border-collapse":"collapse","margin-top":"1rem"},R={"text-align":"left",padding:"0.75rem","border-bottom":"2px solid #dee2e6","font-weight":"600",color:"#495057","font-size":"0.875rem","text-transform":"uppercase"},W={padding:"0.75rem","border-bottom":"1px solid #dee2e6",color:"#212529"},ie={"font-weight":"600","font-size":"1.1rem"},te={display:"flex",gap:"1rem","justify-content":"center","margin-top":"2rem","padding-top":"2rem","border-top":"2px solid #e0e0e0"},ye={padding:"0.75rem 1.5rem","border-radius":"var(--border-radius-sm)",border:"none","font-weight":"500",cursor:"pointer",transition:"all 0.2s",display:"flex","align-items":"center",gap:"0.5rem"},ae={...ye,background:"var(--primary-color)",color:"white"},$={...ye,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"};return(()=>{var S=hC(),p=S.firstChild,C=p.firstChild,P=C.firstChild,E=P.nextSibling;E.firstChild;var y=C.nextSibling,oe=y.firstChild,K=oe.nextSibling,T=K.nextSibling,U=T.nextSibling,B=U.nextSibling,x=B.firstChild,I=p.nextSibling,N=I.firstChild,Z=N.nextSibling,j=Z.firstChild,J=j.firstChild,w=J.nextSibling,V=w.nextSibling,X=V.nextSibling,Y=X.firstChild,se=Y.nextSibling,O=se.nextSibling,F=O.nextSibling;F.nextSibling;var le=X.nextSibling,pe=le.nextSibling,ve=pe.firstChild,ce=ve.nextSibling;ce.nextSibling;var H=j.nextSibling,D=H.firstChild,Q=D.nextSibling;Q.firstChild;var G=Q.nextSibling,he=G.nextSibling,me=he.firstChild,ee=me.nextSibling,ne=ee.nextSibling,Se=ne.nextSibling,we=Se.nextSibling,ue=we.nextSibling,be=ue.nextSibling,de=be.nextSibling,Pe=de.nextSibling,$e=I.nextSibling,xe=$e.firstChild,ke=xe.firstChild,Be=ke.firstChild,Qe=Be.nextSibling,Ue=$e.nextSibling,Te=Ue.firstChild,Fe=Te.nextSibling;Fe.nextSibling;var Je=Ue.nextSibling,Ge=Je.firstChild;Ge.firstChild;var Xe=Ge.nextSibling;Xe.firstChild;var Ae=Je.nextSibling;return u(S,o),u(p,a),u(C,c),P.style.setProperty("margin","0 0 0.5rem 0"),P.style.setProperty("color","var(--primary-color)"),E.style.setProperty("color","#666"),E.style.setProperty("font-size","0.875rem"),s(E,()=>t.invoice.businessId,null),u(y,d),s(oe,(()=>{var Ie=fe(()=>!!t.invoice.isCompleted);return()=>Ie()?e("common.completed").toUpperCase():e("common.pending").toUpperCase()})()),K.style.setProperty("margin","0 0 0.5rem 0"),K.style.setProperty("font-size","1.5rem"),s(K,()=>e("common.invoice").toUpperCase()),T.style.setProperty("font-size","1.1rem"),T.style.setProperty("font-weight","600"),T.style.setProperty("color","#333"),s(T,()=>t.invoice.invoice),U.style.setProperty("color","#666"),U.style.setProperty("margin-top","0.5rem"),s(U,()=>r(t.invoice.createDate)),B.style.setProperty("color","#666"),B.style.setProperty("margin-top","0.25rem"),s(B,()=>e("common.type"),x),s(B,()=>t.invoice.type,null),s(N,()=>e("invoices.customerInformation")),u(Z,_),s(w,()=>t.invoice.shipper_consignee.name),s(X,()=>t.invoice.shipper_consignee.firstName,Y),s(X,()=>t.invoice.shipper_consignee.middleName,se),s(X,()=>t.invoice.shipper_consignee.lastName,F),s(X,()=>t.invoice.shipper_consignee.lastName2,null),s(pe,()=>t.invoice.shipper_consignee.cid,ce),s(pe,()=>t.invoice.shipper_consignee.passport,null),s(Q,()=>t.invoice.shipper_consignee.phoneNumber,null),s(Q,b(Ne,{get when(){return t.invoice.shipper_consignee.phoneNumberS},get children(){return[aC(),"Alt: ",fe(()=>t.invoice.shipper_consignee.phoneNumberS)]}}),null),s(he,()=>t.invoice.shipper_consignee.ybstreet,me),s(he,()=>t.invoice.shipper_consignee.ybstreetNo,ee),s(he,()=>t.invoice.shipper_consignee.ybbetwen1,Se),s(he,()=>t.invoice.shipper_consignee.ybbetwen2,ue),s(he,()=>t.invoice.shipper_consignee.ybreparto,be),s(he,()=>t.invoice.shipper_consignee.ybcity,de),s(he,()=>t.invoice.shipper_consignee.ybestate,Pe),s(he,()=>t.invoice.shipper_consignee.nacionality,null),s(S,b(Ne,{get when(){return t.invoice.products.length>0},get children(){var Ie=lC(),Ze=Ie.firstChild,dt=Ze.nextSibling,ft=dt.firstChild,Tt=ft.firstChild,_t=Tt.firstChild,Et=_t.nextSibling,Mt=Et.nextSibling,it=Mt.nextSibling,Vt=it.nextSibling,It=ft.nextSibling;return s(It,b(pt,{get each(){return t.invoice.products},children:je=>(()=>{var Oe=qh(),Me=Oe.firstChild,He=Me.nextSibling,nt=He.nextSibling,mt=nt.nextSibling,Ke=mt.nextSibling;return s(Me,()=>je.product.code),s(He,()=>je.product.label),s(nt,()=>Math.abs(je.qty)),s(mt,()=>n(je.salePrice)),s(Ke,()=>n(Math.abs(je.qty)*parseFloat(je.salePrice))),re(et=>{var st=W,St=W,yt={...W,"text-align":"center"},Xt={...W,"text-align":"right"},Nt={...W,"text-align":"right"};return et.e=u(Me,st,et.e),et.t=u(He,St,et.t),et.a=u(nt,yt,et.a),et.o=u(mt,Xt,et.o),et.i=u(Ke,Nt,et.i),et},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Oe})()})),re(je=>{var Oe=m,Me=g,He=k,nt=R,mt=R,Ke={...R,"text-align":"center"},et={...R,"text-align":"right"},st={...R,"text-align":"right"};return je.e=u(Ie,Oe,je.e),je.t=u(Ze,Me,je.t),je.a=u(dt,He,je.a),je.o=u(_t,nt,je.o),je.i=u(Et,mt,je.i),je.n=u(Mt,Ke,je.n),je.s=u(it,et,je.s),je.h=u(Vt,st,je.h),je},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),Ie}}),$e),s(S,b(Ne,{get when(){return t.invoice.reservas.length>0},get children(){var Ie=cC(),Ze=Ie.firstChild,dt=Ze.nextSibling,ft=dt.firstChild,Tt=ft.firstChild,_t=Tt.firstChild,Et=_t.nextSibling,Mt=Et.nextSibling,it=Mt.nextSibling,Vt=it.nextSibling,It=ft.nextSibling;return s(It,b(pt,{get each(){return t.invoice.reservas},children:je=>(()=>{var Oe=qh(),Me=Oe.firstChild,He=Me.nextSibling,nt=He.nextSibling,mt=nt.nextSibling,Ke=mt.nextSibling;return s(Me,()=>je.type),s(He,()=>je.qty),s(nt,()=>n(je.price)),s(mt,()=>je.arancel||"-"),s(Ke,()=>n(parseInt(je.qty)*parseFloat(je.price))),re(et=>{var st=W,St={...W,"text-align":"center"},yt={...W,"text-align":"right"},Xt={...W,"text-align":"right"},Nt={...W,"text-align":"right"};return et.e=u(Me,st,et.e),et.t=u(He,St,et.t),et.a=u(nt,yt,et.a),et.o=u(mt,Xt,et.o),et.i=u(Ke,Nt,et.i),et},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Oe})()})),re(je=>{var Oe=m,Me=g,He=k,nt=R,mt={...R,"text-align":"center"},Ke={...R,"text-align":"right"},et={...R,"text-align":"right"},st={...R,"text-align":"right"};return je.e=u(Ie,Oe,je.e),je.t=u(Ze,Me,je.t),je.a=u(dt,He,je.a),je.o=u(_t,nt,je.o),je.i=u(Et,mt,je.i),je.n=u(Mt,Ke,je.n),je.s=u(it,et,je.s),je.h=u(Vt,st,je.h),je},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),Ie}}),$e),xe.style.setProperty("display","inline-block"),xe.style.setProperty("min-width","250px"),s(xe,b(Ne,{get when(){return t.invoice.products.length>0},get children(){var Ie=uC(),Ze=Ie.firstChild,dt=Ze.nextSibling;return Ie.style.setProperty("display","flex"),Ie.style.setProperty("justify-content","space-between"),Ie.style.setProperty("margin-bottom","0.5rem"),s(dt,()=>n(i().productSubtotal)),Ie}}),ke),s(xe,b(Ne,{get when(){return t.invoice.reservas.length>0},get children(){var Ie=dC(),Ze=Ie.firstChild,dt=Ze.nextSibling;return Ie.style.setProperty("display","flex"),Ie.style.setProperty("justify-content","space-between"),Ie.style.setProperty("margin-bottom","0.5rem"),s(dt,()=>n(i().reservaSubtotal)),Ie}}),ke),Qe.style.setProperty("color","var(--primary-color)"),s(Qe,()=>n(i().total)),s(Ue,()=>t.invoice.store,Fe),s(Ue,()=>t.invoice.ssg_sorder_key,null),Ge.addEventListener("mouseleave",Ie=>Ie.currentTarget.style.opacity="1"),Ge.addEventListener("mouseenter",Ie=>Ie.currentTarget.style.opacity="0.9"),Ge.$$click=()=>t.onPrint?.(),s(Ge,()=>e("invoices.printInvoice"),null),Xe.addEventListener("mouseleave",Ie=>{Ie.currentTarget.style.background="white",Ie.currentTarget.style.color="var(--primary-color)"}),Xe.addEventListener("mouseenter",Ie=>{Ie.currentTarget.style.background="var(--primary-color)",Ie.currentTarget.style.color="white"}),Xe.$$click=()=>t.onExport?.(),s(Xe,()=>e("invoices.exportPdf"),null),s(Ae,`
        @media print {
          .invoice-display {
            box-shadow: none !important;
            padding: 0 !important;
          }
          
          ${te} {
            display: none !important;
          }
        }
      `),re(Ie=>{var Ze=h,dt=m,ft=g,Tt=A,_t=M,Et=L,Mt={...M,"margin-top":"0.75rem"},it=L,Vt={...M,"margin-top":"0.75rem"},It=L,je=A,Oe=M,Me=L,He={...M,"margin-top":"0.75rem"},nt=L,mt={...m,"text-align":"right"},Ke={...ie,display:"flex","justify-content":"space-between","padding-top":"0.75rem","border-top":"2px solid #dee2e6"},et={...m,"text-align":"center",color:"#666","font-size":"0.875rem"},st=te,St=ae,yt=$;return Ie.e=u(oe,Ze,Ie.e),Ie.t=u(I,dt,Ie.t),Ie.a=u(N,ft,Ie.a),Ie.o=u(j,Tt,Ie.o),Ie.i=u(J,_t,Ie.i),Ie.n=u(w,Et,Ie.n),Ie.s=u(V,Mt,Ie.s),Ie.h=u(X,it,Ie.h),Ie.r=u(le,Vt,Ie.r),Ie.d=u(pe,It,Ie.d),Ie.l=u(H,je,Ie.l),Ie.u=u(D,Oe,Ie.u),Ie.c=u(Q,Me,Ie.c),Ie.w=u(G,He,Ie.w),Ie.m=u(he,nt,Ie.m),Ie.f=u($e,mt,Ie.f),Ie.y=u(ke,Ke,Ie.y),Ie.g=u(Ue,et,Ie.g),Ie.p=u(Je,st,Ie.p),Ie.b=u(Ge,St,Ie.b),Ie.T=u(Xe,yt,Ie.T),Ie},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),S})()};At(["click"]);const[Fs,Ot]=kc({invoices:[],selectedInvoice:null,loading:!1,error:null,lastUpdated:null}),[fC,rn]=ge({fetchAll:!1,fetchById:!1,create:!1,update:!1,delete:!1}),Br={get state(){return Fs},get loadingStates(){return fC()},async fetchInvoices(t){try{rn(a=>({...a,fetchAll:!0})),Ot("loading",!0),Ot("error",null);let e="SALES";t?.store&&t.store!=="all"&&(e+=t.store),t?.status&&t.status!=="all"&&(e+=" "+t.status);const r=e.toString(),n=await an.getInvoice(r);let i=[];if(t?.dateFrom&&t?.dateTo){const a=c=>{let d=new Date(n[c].createDate).getTime(),h=new Date(t?.dateFrom).getTime(),m=new Date(t?.dateTo).getTime();d>=h&&d<=m&&i.push(n[c])};Object.keys(n).map(a)}else i=Wl(n);const o=Array.isArray(i)?i:i||[];return Ot("invoices",o),Ot("lastUpdated",new Date),o}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoices";throw Ot("error",r),console.error("Error fetching invoices:",e),e}finally{Ot("loading",!1),rn(e=>({...e,fetchAll:!1}))}},fecthInventory:async t=>{},async fetchInvoiceById(t){try{rn(n=>({...n,fetchById:!0})),Ot("error",null);const e=await an.getInvoice(t),r=Wl(e);return Ot("selectedInvoice",r[0]),r}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice";throw Ot("error",r),console.error("Error fetching invoice:",e),e}finally{rn(e=>({...e,fetchById:!1}))}},async createInvoice(t){try{rn(r=>({...r,create:!0})),Ot("error",null);const e={};return Ot("invoices",r=>[e,...r]),Ot("lastUpdated",new Date),e}catch(e){const r=e instanceof Error?e.message:"Failed to create invoice";throw Ot("error",r),console.error("Error creating invoice:",e),e}finally{rn(e=>({...e,create:!1}))}},async updateInvoice(t,e){try{rn(n=>({...n,update:!0})),Ot("error",null);const r={};return Ot("invoices",n=>n.map(i=>i.invoice===t?r:i)),Fs.selectedInvoice?.invoice===t&&Ot("selectedInvoice",r),Ot("lastUpdated",new Date),r}catch(r){const n=r instanceof Error?r.message:"Failed to update invoice";throw Ot("error",n),console.error("Error updating invoice:",r),r}finally{rn(r=>({...r,update:!1}))}},async deleteInvoice(t){try{return rn(e=>({...e,delete:!0})),Ot("error",null),Ot("invoices",e=>e.filter(r=>r.invoice!==t)),Fs.selectedInvoice?.invoice===t&&Ot("selectedInvoice",null),Ot("lastUpdated",new Date),!0}catch(e){const r=e instanceof Error?e.message:"Failed to delete invoice";throw Ot("error",r),console.error("Error deleting invoice:",e),e}finally{rn(e=>({...e,delete:!1}))}},async fetchInvoiceStats(t){try{Ot("error",null);const e=new URLSearchParams;t?.store&&t.store!=="all"&&e.append("store",t.store),t?.dateFrom&&e.append("dateFrom",t.dateFrom),t?.dateTo&&e.append("dateTo",t.dateTo);const r=e.toString();return[]}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice statistics";throw Ot("error",r),console.error("Error fetching invoice stats:",e),e}},async fetchStores(){try{return Ot("error",null),[]}catch(t){const e=t instanceof Error?t.message:"Failed to fetch stores";throw Ot("error",e),console.error("Error fetching stores:",t),t}},setSelectedInvoice(t){Ot("selectedInvoice",t)},clearError(){Ot("error",null)},getFilteredInvoices(t){let e=Fs.invoices;if(t.store&&t.store!=="all"&&(e=e.filter(r=>r.store===t.store)),t.dateFrom){const r=new Date(t.dateFrom).getTime();e=e.filter(n=>n.createDate>=r)}if(t.dateTo){const r=new Date(t.dateTo).setHours(23,59,59,999);e=e.filter(n=>n.createDate<=r)}if(t.status&&t.status!=="all"){const r=t.status==="completed";e=e.filter(n=>n.isCompleted===r)}return e},calculateSummary(t){let e=t.length,r=t.filter(_=>_.isCompleted).length,n=0,i=0,o=0,a=0,c=0,d=0,h=new Set,m=new Set;t?.forEach(_=>{h.add(_?.shipper_consignee?.cid),m.add(_.store),_?.products?.forEach(A=>{const M=Math.abs(A?.qty);n+=M,o+=M*(parseFloat(A?.salePrice)||1)}),_?.reservas?.forEach(A=>{let M=parseInt(A?.qty);isNaN(M)&&(M=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[A.type]||A?.onlyTariff?(M=parseFloat(A.arancel)||parseFloat(A.qty)*parseFloat(A.price),d+=M):(A?.arancel&&(c+=parseFloat(A?.arancel)),i+=M,a+=M*parseFloat(A?.price))})});const g=o+a+d;return{totalInvoices:e,completedInvoices:r,pendingInvoices:e-r,totalProducts:n,totalReservas:i,totalProductAmount:o,totalReservaAmount:a,totalAranceles:c,grandTotal:g,totalOther:d,uniqueCustomers:h.size,uniqueStores:m.size,avgInvoiceValue:e>0?g/e:0}},async refreshData(t){return console.log(" fetchInvoices {queryString}"),this.fetchInvoices(t)}},yC=[{id:"YY_8802",code:"YY_8802",name:"CENTER",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8803",code:"YY_8803",name:"BISSONNET",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8804",code:"YY_8804",name:"IRVIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8805",code:"YY_8805",name:"KATTY",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8816",code:"YY_8816",name:"YABA GLOBAL",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8818",code:"YY_8818",name:"YABASURAUSTIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8847",code:"YY_8847",name:"YABAOFICINA AZ",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_3251",code:"YY_3251",name:"YABA FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_32",code:"YY_32",name:"YABA MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_76",code:"YY_76",name:"YABA DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_79",code:"YY_79",name:"ALMACEN DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8635",code:"YY_8635",name:"FASHION MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8665",code:"YY_8665",name:"IRVIN FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8901",code:"YY_8901",name:"ALMACEN CENTRAL YABA",bussinesId:"YB100423253156428",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01"}],gC=[{id:"1",name:'MacBook Pro 16"',price:2399,quantity:75,category:"Electronics",description:"Apple MacBook Pro 16-inch with M2 Pro chip",sku:"MBP-16-M2P",supplier:"Apple Inc.",minStock:10,location:"Warehouse A",lastUpdated:"2024-01-15"},{id:"2",name:'Dell Monitor 27"',price:299,quantity:35,category:"Electronics",description:"Dell 27-inch 4K UHD Monitor",sku:"DELL-MON-27-4K",supplier:"Dell Technologies",minStock:15,location:"Warehouse B",lastUpdated:"2024-01-14"},{id:"3",name:"Wireless Mouse",price:49.99,quantity:12,category:"Accessories",description:"Ergonomic wireless mouse with precision tracking",sku:"MOUSE-WL-001",supplier:"Logitech",minStock:25,location:"Warehouse A",lastUpdated:"2024-01-13"}],Us=()=>{const t=new Map;return Fr().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=De.getLocationById(e.locationId),i=t.get(r);i||(i={id:r,productId:e.productId,locationId:e.locationId,locationName:n?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,i)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(i.quantity+=e.quantity*1):e.movementType==="out"?i.quantity-=e.quantity*1:e.movementType==="adjustment"&&(i.quantity=e.quantity*1),new Date(e.createdDate)>new Date(i.lastMovementDate)&&(i.lastMovementDate=e.createdDate,i.lastMovementType=e.movementType),i.averageCost=e.unitCost*1,i.availableQuantity=i.quantity*1-i.reservedQuantity*1}),Array.from(t.values())},[di,Cl]=ge([]),[hi,Gh]=ge(yC),[Fr,js]=ge([]),[Bn,Fo]=ge([]),pC=()=>{const t=new Map;return Fr().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=t.get(r),i=De.getLocationById(e.locationId);n||(n={id:r,productId:e.productId,locationId:e.locationId,locationName:i?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(n.quantity+=e.quantity*1):e.movementType==="out"?n.quantity-=e.quantity*1:e.movementType==="adjustment"&&(n.quantity=e.quantity*1),new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost*1,n.availableQuantity=n.quantity*1-n.reservedQuantity*1}),Array.from(t.values())};Fo(pC());const[zs,Al]=ge(gC),vC={TRANSFER:1,transfer:1},Hh=173442384e4,De={get products(){return di()},get locations(){return hi()},get movements(){return Fr()},get stockLevels(){return Bn()},parseInventoryData:t=>{const e=Object.keys(t).slice(0,900),r=[],n=i=>{let o=t;o[i]?.products&&o[i]?.products?.map(a=>{let c=Zp(o[i]?.type),d=a?.price*1||a?.unitCost*1,h=a?.qty*1||a?.quantity*1;d=isNaN(d)?0:d,h=isNaN(h)?0:h;let m={id:o[i]?.ssg_inventory_key,productId:a?.product?.id,productName:a?.product?.label,productSku:a?.product?.code,locationId:o[i]?.store,locationName:o[i]?.store,location:o[i]?.store,movementType:c,quantity:h,unitCost:d,totalCost:d*1*h,minStock:10,referenceNumber:"PO-001",notes:o[i]?.description||o[i]?.notes,createdBy:"admin",createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(Hh).toISOString(),invoiceId:o[i]?.invoice};if(r.push(m),vC[o[i].movementType]&&o[i]?.fromLocationId){let g=De.getLocationById(o[i]?.fromLocationId);const _={id:o[i]?.ssg_inventory_key,productId:a?.product?.id,productName:a?.product?.label,productSku:a?.product?.code,locationId:o[i]?.fromLocationId,locationName:g?.name||"",movementType:"out",quantity:h*-1,unitCost:d,totalCost:d*-1*h,minStock:10,referenceNumber:o[i]?.referenceNumber,notes:`Transfer to ${o[i]?.locationName}`+(o[i].notes?` - ${o[i].notes}`:""),createdBy:o[i].createdBy,createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(Hh).toISOString(),invoiceId:o[i]?.invoiceId,toLocationId:o[i]?.locationId,toLocationName:o[i]?.locationName};r.push(_)}})};return e.map(n),r},fecthInventory:async t=>{const e=await an.getInventory(t),r=De.parseInventoryData(e);De.updMovements(r)},fecthProduct:async t=>{const e=await an.getProducts(t),r=Object.keys(e),n=o=>{let a=e;return{id:o,name:a[o].name,businessId:a[o].businessId,sku:a[o].code,UPC:a[o].UPC,numCode:a[o].codeN,category:a[o].category,unitCost:a[o].unitCost||0,unitOfMeasure:a[o].unitOfMeasure||a[o].unit,minStockLevel:a[o].minStockLevel,maxStockLevel:a[o].maxStockLevel,isActive:a[o].isActive,productImageUrl:a[o].productImageUrl,description:a[o].description||"",createdDate:a[o].createdAt||new Date().toISOString(),lastModified:a[o].updatedAt||new Date().toISOString()}},i=r.map(n);return De.updProduct(i),i},getProductById:t=>di().find(e=>e.id===t),updProduct:t=>{Cl(t)},getProductsBySku:t=>di().filter(e=>e.sku.toLowerCase().includes(t.toLowerCase())),getProductsByCategory:t=>di().filter(e=>e.category===t),getActiveProducts:()=>di().filter(t=>t.name),getLocationById:t=>hi().find(e=>e.id===t),getLocationsByType:t=>hi().filter(e=>e.type===t),getActiveLocations:()=>{let t=vt?.state?.profile?.stores;return hi().filter(e=>t?.[e?.id])},getMovementsByProduct:t=>Fr().filter(e=>e.productId===t),updMovements:t=>{js([...t]),Fo(Us())},getMovementsByLocation:t=>Fr().filter(e=>e.locationId===t),getMovementsByDateRange:(t,e)=>Fr().filter(r=>r.createdDate>=t&&r.createdDate<=e),getStockByProduct:t=>Bn().filter(e=>e.productId===t),getStockByLocation:t=>Bn().filter(e=>e.locationId===t),getStockByProductAndLocation:(t,e)=>Bn().find(r=>r.productId===t&&r.locationId===e),getTotalStockByProduct:t=>Bn().filter(e=>e.productId===t).reduce((e,r)=>e*1+r.quantity*1,0),getLastLocationByProduct:t=>{const e=Fr().filter(r=>r.productId===t).sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime());if(e.length>0)return hi().find(r=>r.id===e[0].locationId)},getLowStockProducts:()=>(di()||[])?.map(t=>{const e=Bn().filter(r=>r.productId===t.id).reduce((r,n)=>r+n.quantity,0);return{...t,currentStock:e}}).filter(t=>t.currentStock<=t.minStockLevel),addInventoryMovement:t=>{const e={...t,id:`mov-${Date.now()}`,createdDate:new Date().toISOString()};js(r=>[...r,e]),Fo(Us())},addBulkInventoryMovements:async t=>{const e=[],r=[],n=new Date().toISOString(),i=hi().find(c=>c.id===t.locationId);if(!i)return{success:!1,errors:["Invalid location"]};let o;if(t.movementType==="transfer"){if(!t.fromLocationId)return{success:!1,errors:["From location required for transfers"]};if(o=hi().find(c=>c.id===t.fromLocationId),!o)return{success:!1,errors:["Invalid from location"]};if(t.fromLocationId===t.locationId)return{success:!1,errors:["From and to locations cannot be the same"]}}if(t.items.forEach((c,d)=>{const h=di().find(A=>A.id===c.productId);if(!h){e.push(`Item ${d+1}: Product not found`);return}if(c.quantity<=0){e.push(`Item ${d+1}: Quantity must be greater than 0`);return}if(t.movementType==="out"){const A=Bn().filter(M=>M.productId===c.productId&&M.locationId===t.locationId).reduce((M,L)=>M+L.quantity,0);if(c.quantity>A){e.push(`Item ${d+1}: Insufficient stock. Available: ${A}, Requested: ${c.quantity}`);return}}if(t.movementType==="transfer"){const A=Bn().filter(M=>M.productId===c.productId&&M.locationId===t.fromLocationId).reduce((M,L)=>M+L.quantity,0);if(c.quantity>A){e.push(`Item ${d+1}: Insufficient stock at ${o?.name}. Available: ${A}, Requested: ${c.quantity}`);return}}const m=c.unitCost||h.unitCost,g=c.quantity*m,_={id:`mov-${Date.now()}-${d}`,productId:h.id,productName:h.name,productSku:h.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:c.quantity,unitCost:m,totalCost:g,minStock:10,referenceNumber:t.referenceNumber||"",notes:c.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:o?.name};if(r.push(_),t.movementType==="transfer"&&o){const A={id:`mov-${Date.now()}-${d}-out`,productId:h.id,productName:h.name,productSku:h.sku,locationId:t.fromLocationId,locationName:o.name,movementType:"out",quantity:c.quantity,unitCost:m,totalCost:g,minStock:10,referenceNumber:t.referenceNumber||"",notes:`Transfer to ${i.name}`+(c.notes?` - ${c.notes}`:""),createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,toLocationId:t.locationId,toLocationName:i.name};r.push(A)}}),e.length>0)return{success:!1,errors:e};js(c=>[...c,...r]),Fo(Us()),console.log({bulkRequest:t});const a=await an.addInventory(t);return console.log({prodResults:a}),{success:!0,errors:[]}},getMovementsByInvoice:t=>Fr().filter(e=>e.invoiceId===t),getInvoiceSummary:t=>{const e=Fr().filter(o=>o.invoiceId===t);if(e.length===0)return null;const r=e.reduce((o,a)=>o+a.totalCost,0),n=new Set(e.map(o=>o.productId)).size,i=e[0];return{invoiceId:t,referenceNumber:i.referenceNumber,movementType:i.movementType,location:i.locationName,fromLocation:i.fromLocationName,productCount:n,totalItems:e.reduce((o,a)=>o+a.quantity,0),totalValue:r,createdDate:i.createdDate,createdBy:i.createdBy}},addProduct:t=>{const e={...t,id:`prod-${Date.now()}`,createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};Cl(r=>[...r,e])},addLocation:t=>{const e={...t,id:`loc-${Date.now()}`,createdDate:new Date().toISOString()};Gh(r=>[...r,e])},updateProduct:(t,e)=>{Cl(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n))},updateLocation:(t,e)=>{Gh(r=>r.map(n=>n.id===t?{...n,...e}:n))},updateMovement:(t,e)=>{js(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n)),Fo(Us())},get inventory(){return zs()},addItem(t){const e={...t,id:Date.now().toString(),lastUpdated:new Date().toISOString().split("T")[0]};return Al([...zs(),e]),e},updateItem(t,e){Al(zs().map(r=>r.id===t?{...r,...e,lastUpdated:new Date().toISOString().split("T")[0]}:r))},deleteItem(t){Al(zs().filter(e=>e.id!==t))},getItemById(t){return Fr().find(e=>e.id===t)},getLowStockItems(){return Fr().filter(t=>t.quantity*1<=t.minStock*1)},getTotalValue(){return Fr().reduce((t,e)=>t*1+e.unitCost*1*e.quantity*1,0)}};var Yh=z("<div>"),bC=z("<div><div><input type=text autocomplete=off>"),_C=z("<button type=button>+"),SC=z("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>");const Eu=t=>{const{t:e}=lt(),[r,n]=ge(!1),[i,o]=ge(""),[a,c]=ge(-1),d=We(()=>t.value?De.getProductById(t.value):null),h=We(()=>{const K=i().toLowerCase();return K?De.getActiveProducts().filter(T=>T.name.toLowerCase().includes(K)||T.sku.toLowerCase().includes(K)||T.category.toLowerCase().includes(K)):De.getActiveProducts()}),m=()=>{n(!0),o(""),c(-1)},g=K=>{const T=K.target;o(T.value),n(!0),c(-1)},_=K=>{t.onChange(K),n(!1),o(""),c(-1)},A=K=>{const T=h();switch(K.key){case"ArrowDown":K.preventDefault(),c(U=>Math.min(U+1,T.length-1));break;case"ArrowUp":K.preventDefault(),c(U=>Math.max(U-1,-1));break;case"Enter":K.preventDefault(),a()>=0&&T[a()]&&_(T[a()]);break;case"Escape":n(!1),o(""),c(-1);break}},M=K=>{setTimeout(()=>{n(!1),o(""),c(-1)},150)},L=K=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(K),k=K=>De.stockLevels.filter(T=>T.productId===K).reduce((T,U)=>T+U.quantity,0),R={position:"relative",width:"100%",...t.style},W={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},ie={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},te=K=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid "+K?"var(--primary-color)":"var(--border-color)",background:K?"var(--strip-color)":"transparent",color:K?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),ye={display:"flex","justify-content":"space-between","align-items":"center"},ae={flex:"1"},$={"font-weight":"500","margin-bottom":"0.25rem"},S={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},p={"text-align":"right","font-size":"0.875rem"},C={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},P=()=>r()&&i()?i():d()?`${d().name} (${d().sku})`:"",E={display:"flex","align-items":"stretch",width:"100%"},y={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},oe={...W,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"};return(()=>{var K=bC(),T=K.firstChild,U=T.firstChild;return u(T,E),U.addEventListener("blur",M),U.$$keydown=A,U.$$click=m,U.$$input=g,s(T,(()=>{var B=fe(()=>!!t.onAddNew);return()=>B()&&(()=>{var x=_C();return x.addEventListener("mouseleave",I=>{I.currentTarget.style.background="var(--surface-color)",I.currentTarget.style.color="var(--primary-color)"}),x.addEventListener("mouseenter",I=>{I.currentTarget.style.background="var(--primary-color)",I.currentTarget.style.color="white"}),xi(x,"click",t.onAddNew,!0),u(x,y),re(()=>ct(x,"title",e("inventory.addProduct","Add new product"))),x})()})(),null),s(K,b(Ne,{get when(){return r()},get children(){var B=Yh();return s(B,b(Ne,{get when(){return h().length>0},get fallback(){return(()=>{var x=Yh();return u(x,C),s(x,(()=>{var I=fe(()=>!!i());return()=>I()?e("inventory.noProductsFound","No products found matching your search."):e("inventory.noProductsAvailable","No products available.")})()),x})()},get children(){return b(pt,{get each(){return h()},children:(x,I)=>{const N=k(x.id),Z=N<=x.minStockLevel;return(()=>{var j=SC(),J=j.firstChild,w=J.firstChild,V=w.firstChild,X=V.nextSibling,Y=X.firstChild,se=Y.firstChild,O=Y.nextSibling,F=O.nextSibling,le=F.nextSibling,pe=le.nextSibling,ve=w.nextSibling,ce=ve.firstChild,H=ce.firstChild,D=ce.nextSibling;return j.addEventListener("mouseenter",()=>c(I())),j.$$click=()=>_(x),u(J,ye),u(w,ae),u(V,$),s(V,()=>x.name),u(X,S),s(Y,()=>e("inventory.sku","SKU"),se),s(Y,()=>x.sku,null),s(F,()=>x.category),s(pe,()=>L(x.unitCost)),u(ve,p),ce.style.setProperty("font-weight","600"),(Z?"#f44336":"var(--text-primary)")!=null?ce.style.setProperty("color",Z?"#f44336":"var(--text-primary)"):ce.style.removeProperty("color"),s(ce,N,H),s(ce,()=>x.unitOfMeasure,null),D.style.setProperty("color","var(--text-muted)"),s(D,()=>Z?e("inventory.lowStock","Low Stock"):e("inventory.inStock","In Stock")),re(Q=>u(j,te(I()===a()),Q)),j})()}})}})),re(x=>u(B,ie,x)),B}}),null),re(B=>{var x=R,I=oe,N=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),Z=t.disabled,j=t.required;return B.e=u(K,x,B.e),B.t=u(U,I,B.t),N!==B.a&&ct(U,"placeholder",B.a=N),Z!==B.o&&(U.disabled=B.o=Z),j!==B.i&&(U.required=B.i=j),B},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),re(()=>U.value=P()),K})()};At(["input","click","keydown"]);var Wh=z("<div>"),PC=z("<div><div><input type=text autocomplete=off>"),wC=z("<button type=button>+"),CC=z("<div><div><div><div> </div><div><span>: </span><span></span></div><div>");const Ma=t=>{const{t:e}=lt(),[r,n]=ge(!1),[i,o]=ge(""),[a,c]=ge(-1),d=We(()=>t.value?De.getLocationById(t.value):null),h=We(()=>{let K=De.getActiveLocations();t.filterType&&(K=K.filter(U=>U.type===t.filterType));const T=i().toLowerCase();return T?K.filter(U=>U.name.toLowerCase().includes(T)||U?.code?.toLowerCase().includes(T)||U?.type?.toLowerCase().includes(T)||U?.address?.toLowerCase().includes(T)):K}),m=()=>{n(!0),o(""),c(-1)},g=K=>{const T=K.target;o(T.value),n(!0),c(-1)},_=K=>{t.onChange(K.id),n(!1),o(""),c(-1)},A=K=>{const T=h();switch(K.key){case"ArrowDown":K.preventDefault(),c(U=>Math.min(U+1,T.length-1));break;case"ArrowUp":K.preventDefault(),c(U=>Math.max(U-1,-1));break;case"Enter":K.preventDefault(),a()>=0&&T[a()]&&_(T[a()]);break;case"Escape":n(!1),o(""),c(-1);break}},M=K=>{setTimeout(()=>{n(!1),o(""),c(-1)},150)},L=K=>({warehouse:"",store:"",supplier:"",customer:""})[K]||"",k=K=>({warehouse:"#2196F3",store:"#4CAF50",supplier:"#FF9800",customer:"#9C27B0"})[K]||"#757575",R={position:"relative",width:"100%",...t.style},W={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},ie={display:"flex","align-items":"stretch",width:"100%"},te={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},ye={...W,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},ae={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},$=K=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:K?"var(--strip-color)":"transparent",color:K?"var(--primary-dark)":"var(--text-primary)",transition:"all 0.2s ease"}),S={display:"flex","justify-content":"space-between","align-items":"center"},p={flex:"1"},C={"font-weight":"500","margin-bottom":"0.25rem"},P={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","align-items":"center"},E=K=>({padding:"0.2rem 0.5rem","border-radius":"var(--border-radius-sm)","font-size":"0.7rem","font-weight":"500",background:k(K),color:"white","text-transform":"uppercase"}),y={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},oe=()=>r()&&i()?i():d()?`${d().name} (${d().code})`:"";return(()=>{var K=PC(),T=K.firstChild,U=T.firstChild;return u(T,ie),U.addEventListener("blur",M),U.$$keydown=A,U.$$click=m,U.$$input=g,s(T,(()=>{var B=fe(()=>!!t.onAddNew);return()=>B()&&(()=>{var x=wC();return x.addEventListener("mouseleave",I=>{I.currentTarget.style.background="var(--surface-color)",I.currentTarget.style.color="var(--primary-color)"}),x.addEventListener("mouseenter",I=>{I.currentTarget.style.background="var(--primary-color)",I.currentTarget.style.color="white"}),xi(x,"click",t.onAddNew,!0),u(x,te),re(()=>ct(x,"title",e("inventory.addLocation","Add new location"))),x})()})(),null),s(K,b(Ne,{get when(){return r()},get children(){var B=Wh();return s(B,b(Ne,{get when(){return h().length>0},get fallback(){return(()=>{var x=Wh();return u(x,y),s(x,(()=>{var I=fe(()=>!!i());return()=>I()?e("inventory.noLocationsFound","No locations found matching your search."):e("inventory.noLocationsAvailable","No locations available.")})()),x})()},get children(){return b(pt,{get each(){return h()},children:(x,I)=>(()=>{var N=CC(),Z=N.firstChild,j=Z.firstChild,J=j.firstChild,w=J.firstChild,V=J.nextSibling,X=V.firstChild,Y=X.firstChild,se=X.nextSibling,O=V.nextSibling;return N.addEventListener("mouseenter",()=>c(I())),N.$$click=()=>_(x),u(Z,S),u(j,p),u(J,C),s(J,()=>L(x.type),w),s(J,()=>x.name,null),u(V,P),s(X,()=>e("inventory.locationCode","Code"),Y),s(X,()=>x.code,null),s(se,()=>x.type),O.style.setProperty("font-size","0.75rem"),O.style.setProperty("color","var(--text-muted)"),O.style.setProperty("margin-top","0.25rem"),s(O,()=>x.address),re(F=>{var le=$(I()===a()),pe=E(x.type);return F.e=u(N,le,F.e),F.t=u(se,pe,F.t),F},{e:void 0,t:void 0}),N})()})}})),re(x=>u(B,ae,x)),B}}),null),re(B=>{var x=R,I=ye,N=t.placeholder||e("inventory.searchLocations","Search locations by name, code, or type..."),Z=t.disabled,j=t.required;return B.e=u(K,x,B.e),B.t=u(U,I,B.t),N!==B.a&&ct(U,"placeholder",B.a=N),Z!==B.o&&(U.disabled=B.o=Z),j!==B.i&&(U.required=B.i=j),B},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),re(()=>U.value=oe()),K})()};At(["input","click","keydown"]);var AC=z("<form><div><label> *</label><input type=text required></div><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text list=categories required><datalist id=categories><option value=Electronics></option><option value=Accessories></option><option value=Office></option><option value=Furniture></option><option value=Software></option><option value=Hardware></option></datalist></div></div><div><label></label><textarea></textarea></div><div><div><label></label><select><option value=pcs></option><option value=kg></option><option value=lbs></option><option value=m></option><option value=ft></option><option value=l></option><option value=gal></option><option value=box></option><option value=pack></option></select></div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div></div><div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div><div></div></div><div><div><label></label><input type=number min=0 step=1></div><div><label></label><input type=number min=1 step=1></div></div><div>"),IC=z("<div>");const xu=t=>{const{t:e}=lt(),[r,n]=ge(""),[i,o]=ge(""),[a,c]=ge(""),[d,h]=ge(""),[m,g]=ge("pcs"),[_,A]=ge(0),[M,L]=ge(0),[k,R]=ge(10),[W,ie]=ge(100),[te,ye]=ge(""),ae=()=>{n(""),o(""),c(""),h(""),g("pcs"),A(0),L(0),R(10),ie(100),ye("")},$=T=>{if(T.preventDefault(),ye(""),!r().trim()){ye(e("forms.productNameRequired"));return}if(!i().trim()){ye(e("forms.skuRequired"));return}if(!d().trim()){ye(e("forms.categoryRequired"));return}if(_()<0){ye(e("forms.unitCostNotNegative"));return}if(M()<0){ye(e("forms.sellingPriceNotNegative"));return}if(k()<0){ye(e("forms.minStockNotNegative"));return}if(W()<=k()){ye(e("forms.maxStockGreaterThanMin"));return}if(De.getProductsBySku(i()).length>0){ye(e("forms.skuAlreadyExists"));return}const B={name:r().trim(),sku:i().trim().toUpperCase(),description:a().trim(),category:d().trim(),unitOfMeasure:m(),unitCost:_(),sellingPrice:M(),minStockLevel:k(),maxStockLevel:W(),isActive:!0,businessId:"default-business"};De.addProduct(B);const x=`prod-${Date.now()}`;t.onProductAdded&&t.onProductAdded(x),ae(),t.onClose()},S=()=>{ae(),t.onClose()},p={"margin-bottom":"1.5rem"},C={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},P={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},E={...P,cursor:"pointer"},y={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},oe={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},K={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"};return b(gr,{get isOpen(){return t.isOpen},onClose:S,get title(){return e("inventory.addNewProduct")},get children(){var T=AC(),U=T.firstChild,B=U.firstChild,x=B.firstChild,I=B.nextSibling,N=U.nextSibling,Z=N.firstChild,j=Z.firstChild,J=j.firstChild,w=j.nextSibling,V=Z.nextSibling,X=V.firstChild,Y=X.firstChild,se=X.nextSibling,O=N.nextSibling,F=O.firstChild,le=F.nextSibling,pe=O.nextSibling,ve=pe.firstChild,ce=ve.firstChild,H=ce.nextSibling,D=H.firstChild,Q=D.nextSibling,G=Q.nextSibling,he=G.nextSibling,me=he.nextSibling,ee=me.nextSibling,ne=ee.nextSibling,Se=ne.nextSibling,we=Se.nextSibling,ue=ve.nextSibling,be=ue.firstChild,de=be.nextSibling,Pe=pe.nextSibling,$e=Pe.firstChild,xe=$e.firstChild,ke=xe.nextSibling,Be=Pe.nextSibling,Qe=Be.firstChild,Ue=Qe.firstChild,Te=Ue.nextSibling,Fe=Qe.nextSibling,Je=Fe.firstChild,Ge=Je.nextSibling,Xe=Be.nextSibling;return T.addEventListener("submit",$),s(B,()=>e("inventory.productName"),x),I.addEventListener("change",Ae=>n(Ae.target.value)),s(j,()=>e("inventory.sku"),J),w.addEventListener("change",Ae=>o(Ae.target.value)),s(X,()=>e("inventory.category"),Y),se.addEventListener("change",Ae=>h(Ae.target.value)),s(F,()=>e("common.description")),le.addEventListener("change",Ae=>c(Ae.target.value)),s(ce,()=>e("inventory.unitOfMeasure")),H.addEventListener("change",Ae=>g(Ae.target.value)),s(D,()=>e("inventory.pieces")),s(Q,()=>e("inventory.kilograms")),s(G,()=>e("inventory.pounds")),s(he,()=>e("inventory.meters")),s(me,()=>e("inventory.feet")),s(ee,()=>e("inventory.liters")),s(ne,()=>e("inventory.gallons")),s(Se,()=>e("inventory.boxes")),s(we,()=>e("inventory.packs")),s(be,()=>e("inventory.unitCost")),de.addEventListener("change",Ae=>A(Number(Ae.target.value))),s(xe,()=>e("inventory.sellingPrice")),ke.addEventListener("change",Ae=>L(Number(Ae.target.value))),s(Ue,()=>e("inventory.minimumStockLevel")),Te.addEventListener("change",Ae=>R(Number(Ae.target.value))),s(Je,()=>e("inventory.maximumStockLevel")),Ge.addEventListener("change",Ae=>ie(Number(Ae.target.value))),s(T,(()=>{var Ae=fe(()=>!!te());return()=>Ae()&&(()=>{var Ie=IC();return u(Ie,y),s(Ie,te),Ie})()})(),Xe),u(Xe,oe),s(Xe,b(Le,{variant:"secondary",type:"button",onClick:S,get children(){return e("common.cancel")}}),null),s(Xe,b(Le,{variant:"primary",type:"submit",get children(){return e("inventory.addProduct")}}),null),re(Ae=>{var Ie=p,Ze=C,dt=P,ft=e("inventory.enterProductName"),Tt=K,_t=C,Et=P,Mt=e("inventory.enterSkuCode"),it=C,Vt=P,It=e("inventory.enterCategory"),je=p,Oe=C,Me={...P,"min-height":"80px",resize:"vertical"},He=e("inventory.enterProductDescription"),nt=K,mt=C,Ke=E,et=C,st=P,St=K,yt=C,Xt=P,Nt=K,or=C,pr=P,Bt=C,Zt=P;return Ae.e=u(U,Ie,Ae.e),Ae.t=u(B,Ze,Ae.t),Ae.a=u(I,dt,Ae.a),ft!==Ae.o&&ct(I,"placeholder",Ae.o=ft),Ae.i=u(N,Tt,Ae.i),Ae.n=u(j,_t,Ae.n),Ae.s=u(w,Et,Ae.s),Mt!==Ae.h&&ct(w,"placeholder",Ae.h=Mt),Ae.r=u(X,it,Ae.r),Ae.d=u(se,Vt,Ae.d),It!==Ae.l&&ct(se,"placeholder",Ae.l=It),Ae.u=u(O,je,Ae.u),Ae.c=u(F,Oe,Ae.c),Ae.w=u(le,Me,Ae.w),He!==Ae.m&&ct(le,"placeholder",Ae.m=He),Ae.f=u(pe,nt,Ae.f),Ae.y=u(ce,mt,Ae.y),Ae.g=u(H,Ke,Ae.g),Ae.p=u(be,et,Ae.p),Ae.b=u(de,st,Ae.b),Ae.T=u(Pe,St,Ae.T),Ae.A=u(xe,yt,Ae.A),Ae.O=u(ke,Xt,Ae.O),Ae.I=u(Be,Nt,Ae.I),Ae.S=u(Ue,or,Ae.S),Ae.W=u(Te,pr,Ae.W),Ae.C=u(Je,Bt,Ae.C),Ae.B=u(Ge,Zt,Ae.B),Ae},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),re(()=>I.value=r()),re(()=>w.value=i()),re(()=>se.value=d()),re(()=>le.value=a()),re(()=>H.value=m()),re(()=>de.value=_()),re(()=>ke.value=M()),re(()=>Te.value=k()),re(()=>Ge.value=W()),T}})};var EC=z('<form><div><label> *</label><input type=text required></div><div><div><label> *<button type=button title="Generate code automatically"></button></label><input type=text required><div></div></div><div><label> *</label><select required><option value=warehouse> </option><option value=store> </option><option value=supplier> </option><option value=customer> </option></select><div></div></div></div><div><label> *</label><textarea required></textarea></div><div>'),xC=z("<div><div>:</div><div><span></span><div><div></div><div>"),TC=z("<div>");const Tu=t=>{const{t:e}=lt(),[r,n]=ge(""),[i,o]=ge(""),[a,c]=ge("warehouse"),[d,h]=ge(""),[m,g]=ge(""),_=()=>{n(""),o(""),c("warehouse"),h(""),g("")},A=()=>{if(r()){const P=a()==="warehouse"?"WH":a()==="store"?"ST":a()==="supplier"?"SUP":"CUST",E=r().toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,3),y=String(Math.floor(Math.random()*1e3)).padStart(3,"0");o(`${P}-${E}-${y}`)}},M=P=>{if(P.preventDefault(),g(""),!r().trim()){g(e("forms.locationNameRequired"));return}if(!i().trim()){g(e("forms.locationCodeRequired"));return}if(!d().trim()){g(e("forms.addressRequired"));return}if(De.locations.filter(K=>K.code.toLowerCase()===i().toLowerCase()).length>0){g(e("forms.locationCodeExists"));return}const y={name:r().trim(),code:i().trim().toUpperCase(),type:a(),address:d().trim(),isActive:!0};De.addLocation(y);const oe=`loc-${Date.now()}`;t.onLocationAdded&&t.onLocationAdded(oe),_(),t.onClose()},L=()=>{_(),t.onClose()},k={"margin-bottom":"1.5rem"},R={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},W={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},ie={...W,cursor:"pointer"},te={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},ye={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ae={display:"grid","grid-template-columns":"2fr 1fr",gap:"1rem"},$={"font-size":"0.875rem",color:"var(--text-muted)","margin-top":"0.25rem"},S={padding:"0.25rem 0.5rem","font-size":"0.75rem","margin-left":"0.5rem",background:"var(--background-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",color:"var(--text-muted)"},p=P=>({warehouse:"",store:"",supplier:"",customer:""})[P]||"",C=P=>({warehouse:e("inventory.warehouseDescription"),store:e("inventory.storeDescription"),supplier:e("inventory.supplierDescription"),customer:e("inventory.customerDescription")})[P]||"";return b(gr,{get isOpen(){return t.isOpen},onClose:L,get title(){return e("inventory.addNewLocation")},get children(){var P=EC(),E=P.firstChild,y=E.firstChild,oe=y.firstChild,K=y.nextSibling,T=E.nextSibling,U=T.firstChild,B=U.firstChild,x=B.firstChild,I=x.nextSibling,N=B.nextSibling,Z=N.nextSibling,j=U.nextSibling,J=j.firstChild,w=J.firstChild,V=J.nextSibling,X=V.firstChild,Y=X.firstChild,se=X.nextSibling,O=se.firstChild,F=se.nextSibling,le=F.firstChild,pe=F.nextSibling,ve=pe.firstChild,ce=V.nextSibling,H=T.nextSibling,D=H.firstChild,Q=D.firstChild,G=D.nextSibling,he=H.nextSibling;return P.addEventListener("submit",M),s(y,()=>e("inventory.locationName"),oe),K.addEventListener("change",me=>n(me.target.value)),u(T,ae),s(B,()=>e("inventory.locationCode"),x),I.$$click=A,u(I,S),s(I,()=>e("common.generate")),N.addEventListener("change",me=>o(me.target.value)),s(Z,()=>e("inventory.uniqueIdentifierHelp")),s(J,()=>e("inventory.locationType"),w),V.addEventListener("change",me=>c(me.target.value)),s(X,()=>p("warehouse"),Y),s(X,()=>e("inventory.warehouse"),null),s(se,()=>p("store"),O),s(se,()=>e("inventory.store"),null),s(F,()=>p("supplier"),le),s(F,()=>e("inventory.supplier"),null),s(pe,()=>p("customer"),ve),s(pe,()=>e("inventory.customer"),null),s(ce,()=>C(a())),s(D,()=>e("common.address"),Q),G.addEventListener("change",me=>h(me.target.value)),s(P,(()=>{var me=fe(()=>!!r());return()=>me()&&(()=>{var ee=xC(),ne=ee.firstChild,Se=ne.firstChild,we=ne.nextSibling,ue=we.firstChild,be=ue.nextSibling,de=be.firstChild,Pe=de.nextSibling;return ee.style.setProperty("padding","1rem"),ee.style.setProperty("background","var(--background-color)"),ee.style.setProperty("border-radius","var(--border-radius-sm)"),ee.style.setProperty("border","1px solid var(--border-color)"),ee.style.setProperty("margin-bottom","1rem"),ne.style.setProperty("font-weight","500"),ne.style.setProperty("margin-bottom","0.5rem"),s(ne,()=>e("common.preview"),Se),we.style.setProperty("display","flex"),we.style.setProperty("align-items","center"),we.style.setProperty("gap","0.5rem"),ue.style.setProperty("font-size","1.2rem"),s(ue,()=>p(a())),de.style.setProperty("font-weight","600"),s(de,r),Pe.style.setProperty("font-size","0.875rem"),Pe.style.setProperty("color","var(--text-muted)"),s(Pe,(()=>{var $e=fe(()=>!!i());return()=>$e()&&`${i()}  `})(),null),s(Pe,a,null),ee})()})(),he),s(P,(()=>{var me=fe(()=>!!m());return()=>me()&&(()=>{var ee=TC();return u(ee,te),s(ee,m),ee})()})(),he),u(he,ye),s(he,b(Le,{variant:"secondary",type:"button",onClick:L,get children(){return e("common.cancel")}}),null),s(he,b(Le,{variant:"primary",type:"submit",get children(){return e("inventory.addLocation")}}),null),re(me=>{var ee=k,ne=R,Se=W,we=e("inventory.enterLocationName"),ue=R,be=W,de=e("inventory.enterUniqueCode"),Pe=$,$e=R,xe=ie,ke=$,Be=k,Qe=R,Ue={...W,"min-height":"100px",resize:"vertical"},Te=e("inventory.enterCompleteAddress");return me.e=u(E,ee,me.e),me.t=u(y,ne,me.t),me.a=u(K,Se,me.a),we!==me.o&&ct(K,"placeholder",me.o=we),me.i=u(B,ue,me.i),me.n=u(N,be,me.n),de!==me.s&&ct(N,"placeholder",me.s=de),me.h=u(Z,Pe,me.h),me.r=u(J,$e,me.r),me.d=u(V,xe,me.d),me.l=u(ce,ke,me.l),me.u=u(H,Be,me.u),me.c=u(D,Qe,me.c),me.w=u(G,Ue,me.w),Te!==me.m&&ct(G,"placeholder",me.m=Te),me},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),re(()=>K.value=r()),re(()=>N.value=i()),re(()=>V.value=a()),re(()=>G.value=d()),P}})};At(["click"]);var $C=z("<form><div>"),Kh=z("<div><label> *"),kC=z("<div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment>"),RC=z("<div><label>"),DC=z("<div><label> *</label><input type=number min=0 step=1 required>"),NC=z("<div><label></label><input type=number min=0 step=0.01>"),LC=z("<div><label></label><input type=text>"),MC=z("<div><label></label><textarea>"),OC=z("<div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span>:</span><span> "),VC=z("<div><div><span>:</span><span>"),BC=z("<div>");const FC=t=>{const{t:e}=lt(),[r,n]=ge({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""}),[i,o]=ge(""),[a,c]=ge(""),[d,h]=ge("in"),[m,g]=ge(0),[_,A]=ge(0),[M,L]=ge(""),[k,R]=ge(""),[W,ie]=ge(""),[te,ye]=ge(""),[ae,$]=ge(!1),[S,p]=ge(!1),C=()=>t.mode==="movement",P=We(()=>i()?De.getProductById(i()):null),E=We(()=>a()?De.getLocationById(a()):null),y=We(()=>W()?De.getLocationById(W()):null),oe=We(()=>m()*_()),K=We(()=>!i()||!a()?0:De.getStockByProductAndLocation(i(),a())?.quantity||0),T=[{value:"Electronics",label:"Electronics"},{value:"Accessories",label:"Accessories"},{value:"Furniture",label:"Furniture"},{value:"Office Supplies",label:"Office Supplies"},{value:"Software",label:"Software"},{value:"Hardware",label:"Hardware"},{value:"Consumables",label:"Consumables"}],U=[{value:"Warehouse A",label:"Warehouse A"},{value:"Warehouse B",label:"Warehouse B"},{value:"Warehouse C",label:"Warehouse C"},{value:"Storage Room",label:"Storage Room"},{value:"Main Office",label:"Main Office"}],B={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},x=()=>{o(""),c(""),h("in"),g(0),A(0),L(""),R(""),ie(""),ye("")},I=()=>{n({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""})},N=pe=>{if(pe.preventDefault(),C()){if(ye(""),!i()){ye(e("forms.selectProduct"));return}if(!a()){ye(e("forms.selectLocation"));return}if(m()<=0){ye(e("forms.quantityGreaterThanZero"));return}if(_()<0){ye(e("forms.unitCostNotNegative"));return}if(d()==="transfer"&&!W()){ye(e("forms.selectFromLocation"));return}if(d()==="transfer"&&W()===a()){ye(e("forms.sameLocationError"));return}if(d()==="out"&&m()>K()){ye(e("forms.insufficientStock",{currentStock:K()}));return}const ve=P(),ce=E(),H={productId:ve.id,productName:ve.name,productSku:ve.sku,locationId:ce.id,locationName:ce.name,movementType:d(),quantity:m(),unitCost:_()||ve.unitCost,totalCost:oe()||m()*ve.unitCost,referenceNumber:M()||`AUTO-${Date.now()}`,notes:k(),createdBy:"admin",fromLocationId:d()==="transfer"?W():void 0,fromLocationName:d()==="transfer"?y()?.name:void 0};De.addInventoryMovement(H),x()}else{const ve=r();if(!ve.name||!ve.price||!ve.quantity||!ve.category||!ve.sku||!ve.supplier||!ve.minStock||!ve.location){alert(e("forms.fillAllRequired"));return}const ce={name:ve.name,price:parseFloat(ve.price),quantity:parseInt(ve.quantity),category:ve.category,description:ve.description,sku:ve.sku,supplier:ve.supplier,minStock:parseInt(ve.minStock),location:ve.location};De.addItem(ce),I()}t.onClose()},Z=(pe,ve)=>{n(ce=>({...ce,[pe]:ve}))},j=()=>{C()?x():I(),t.onClose()},J=pe=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(pe),w={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},V={...w,cursor:"pointer"},X={color:"#f44336","font-size":"0.875rem","margin-top":"0.5rem"},Y={padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},se={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},O={"font-weight":"500",color:"var(--text-muted)"},F={"font-weight":"600",color:"var(--text-primary)"},le=()=>C()?e("inventory.addMovement"):e("inventory.addNewItem");return b(gr,{get isOpen(){return t.isOpen},onClose:j,get title(){return le()},get children(){return[(()=>{var pe=$C(),ve=pe.firstChild;return pe.addEventListener("submit",N),s(pe,(()=>{var ce=fe(()=>!!C());return()=>ce()?[(()=>{var H=Kh(),D=H.firstChild,Q=D.firstChild;return H.style.setProperty("margin-bottom","1.5rem"),D.style.setProperty("display","block"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("font-weight","500"),s(D,()=>e("inventory.product"),Q),s(H,b(Eu,{get value(){return i()},onChange:G=>{o(G);const he=De.getProductById(G);he&&A(he.unitCost)},get placeholder(){return e("inventory.searchProductsPlaceholder")},onAddNew:()=>$(!0),required:!0}),null),H})(),(()=>{var H=kC(),D=H.firstChild,Q=D.firstChild,G=D.nextSibling,he=G.firstChild,me=he.nextSibling,ee=me.nextSibling,ne=ee.nextSibling;return H.style.setProperty("margin-bottom","1.5rem"),D.style.setProperty("display","block"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("font-weight","500"),s(D,()=>e("inventory.movementType"),Q),G.addEventListener("change",Se=>h(Se.target.value)),s(he,()=>e("inventory.stockInPurchase")),s(me,()=>e("inventory.stockOutSale")),s(ee,()=>e("inventory.transferBetween")),s(ne,()=>e("inventory.stockAdjustment")),re(Se=>u(G,V,Se)),re(()=>G.value=d()),H})(),fe(()=>fe(()=>d()==="transfer")()&&(()=>{var H=Kh(),D=H.firstChild,Q=D.firstChild;return H.style.setProperty("margin-bottom","1.5rem"),D.style.setProperty("display","block"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("font-weight","500"),s(D,()=>e("inventory.fromLocation"),Q),s(H,b(Ma,{get value(){return W()},onChange:G=>ie(G),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>p(!0),required:!0}),null),H})()),(()=>{var H=RC(),D=H.firstChild;return H.style.setProperty("margin-bottom","1.5rem"),D.style.setProperty("display","block"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("font-weight","500"),s(D,(()=>{var Q=fe(()=>d()==="transfer");return()=>Q()?e("inventory.toLocation")+" *":e("inventory.locationName")+" *"})()),s(H,b(Ma,{get value(){return a()},onChange:Q=>c(Q),get placeholder(){return fe(()=>d()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>p(!0),required:!0}),null),H})(),fe(()=>fe(()=>!!(P()&&E()))()&&(()=>{var H=OC(),D=H.firstChild,Q=D.firstChild,G=Q.firstChild,he=Q.nextSibling,me=he.firstChild,ee=D.nextSibling,ne=ee.firstChild,Se=ne.firstChild,we=ne.nextSibling,ue=ee.nextSibling,be=ue.firstChild,de=be.firstChild,Pe=be.nextSibling,$e=Pe.firstChild;return s(Q,()=>e("inventory.currentStockAt",{location:E()?.name}),G),s(he,K,me),s(he,()=>P()?.unitOfMeasure,null),s(ne,()=>e("inventory.productCost"),Se),s(we,()=>J(P()?.unitCost||0)),s(be,()=>e("inventory.minStockLevel"),de),s(Pe,()=>P()?.minStockLevel,$e),s(Pe,()=>P()?.unitOfMeasure,null),re(xe=>{var ke=Y,Be=se,Qe=O,Ue=F,Te=se,Fe=O,Je=F,Ge=se,Xe=O,Ae=F;return xe.e=u(H,ke,xe.e),xe.t=u(D,Be,xe.t),xe.a=u(Q,Qe,xe.a),xe.o=u(he,Ue,xe.o),xe.i=u(ee,Te,xe.i),xe.n=u(ne,Fe,xe.n),xe.s=u(we,Je,xe.s),xe.h=u(ue,Ge,xe.h),xe.r=u(be,Xe,xe.r),xe.d=u(Pe,Ae,xe.d),xe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),H})()),(()=>{var H=DC(),D=H.firstChild,Q=D.firstChild,G=D.nextSibling;return H.style.setProperty("margin-bottom","1.5rem"),D.style.setProperty("display","block"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("font-weight","500"),s(D,()=>e("inventory.quantity"),Q),G.addEventListener("change",he=>g(Number(he.target.value))),re(he=>u(G,w,he)),re(()=>G.value=m()),H})(),(()=>{var H=NC(),D=H.firstChild,Q=D.nextSibling;return H.style.setProperty("margin-bottom","1.5rem"),D.style.setProperty("display","block"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("font-weight","500"),s(D,()=>e("inventory.unitCost")),Q.addEventListener("change",G=>A(Number(G.target.value))),re(G=>{var he=w,me=e("inventory.willUseDefaultCost");return G.e=u(Q,he,G.e),me!==G.t&&ct(Q,"placeholder",G.t=me),G},{e:void 0,t:void 0}),re(()=>Q.value=_()),H})(),fe(()=>fe(()=>m()>0&&_()>0)()&&(()=>{var H=VC(),D=H.firstChild,Q=D.firstChild,G=Q.firstChild,he=Q.nextSibling;return s(Q,()=>e("inventory.totalCost"),G),s(he,()=>J(oe())),re(me=>{var ee=Y,ne=se,Se=O,we={...F,"font-size":"1.2rem",color:"var(--primary-color)"};return me.e=u(H,ee,me.e),me.t=u(D,ne,me.t),me.a=u(Q,Se,me.a),me.o=u(he,we,me.o),me},{e:void 0,t:void 0,a:void 0,o:void 0}),H})()),(()=>{var H=LC(),D=H.firstChild,Q=D.nextSibling;return H.style.setProperty("margin-bottom","1.5rem"),D.style.setProperty("display","block"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("font-weight","500"),s(D,()=>e("common.referenceNumber")),Q.addEventListener("change",G=>L(G.target.value)),re(G=>{var he=w,me=e("common.referenceNumberPlaceholder");return G.e=u(Q,he,G.e),me!==G.t&&ct(Q,"placeholder",G.t=me),G},{e:void 0,t:void 0}),re(()=>Q.value=M()),H})(),(()=>{var H=MC(),D=H.firstChild,Q=D.nextSibling;return H.style.setProperty("margin-bottom","1.5rem"),D.style.setProperty("display","block"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("font-weight","500"),s(D,()=>e("common.notes")),Q.addEventListener("change",G=>R(G.target.value)),re(G=>{var he={...w,"min-height":"100px",resize:"vertical"},me=e("inventory.additionalNotesPlaceholder");return G.e=u(Q,he,G.e),me!==G.t&&ct(Q,"placeholder",G.t=me),G},{e:void 0,t:void 0}),re(()=>Q.value=k()),H})(),fe(()=>fe(()=>!!te())()&&(()=>{var H=BC();return u(H,X),s(H,te),H})())]:[b(kt,{get label(){return e("inventory.itemName")},get value(){return r().name},onChange:H=>Z("name",H),get placeholder(){return e("inventory.enterItemName")},required:!0}),b(kt,{get label(){return e("inventory.sku")},get value(){return r().sku},onChange:H=>Z("sku",H),get placeholder(){return e("inventory.enterSkuCode")},required:!0}),b(mr,{get label(){return e("inventory.category")},get value(){return r().category},onChange:H=>Z("category",H),options:T,required:!0}),b(kt,{get label(){return e("common.description")},get value(){return r().description},onChange:H=>Z("description",H),get placeholder(){return e("inventory.enterItemDescription")}}),b(kt,{get label(){return e("common.price")},type:"number",get value(){return r().price},onChange:H=>Z("price",H),get placeholder(){return e("common.enterPrice")},required:!0}),b(kt,{get label(){return e("inventory.quantity")},type:"number",get value(){return r().quantity},onChange:H=>Z("quantity",H),get placeholder(){return e("inventory.enterQuantity")},required:!0}),b(kt,{get label(){return e("inventory.minimumStock")},type:"number",get value(){return r().minStock},onChange:H=>Z("minStock",H),get placeholder(){return e("inventory.enterMinStockLevel")},required:!0}),b(kt,{get label(){return e("inventory.supplier")},get value(){return r().supplier},onChange:H=>Z("supplier",H),get placeholder(){return e("inventory.enterSupplierName")},required:!0}),b(mr,{get label(){return e("inventory.location")},get value(){return r().location},onChange:H=>Z("location",H),options:U,required:!0})]})(),ve),u(ve,B),s(ve,b(Le,{variant:"secondary",type:"button",onClick:j,get children(){return e("common.cancel")}}),null),s(ve,b(Le,{variant:"primary",type:"submit",get children(){return fe(()=>!!C())()?e("inventory.addMovement"):e("inventory.addItem")}}),null),pe})(),b(xu,{get isOpen(){return ae()},onClose:()=>$(!1),onProductAdded:pe=>{o(pe),$(!1)}}),b(Tu,{get isOpen(){return S()},onClose:()=>p(!1),onLocationAdded:pe=>{d()==="transfer"&&!W()?ie(pe):c(pe),p(!1)}})]}})};At(["input","keydown"]);var UC=z("<form><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text required></div></div><div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><div><label></label></div></div><div><div><h3></h3></div></div><div><label></label><textarea></textarea></div><div>"),jC=z("<div><label> *"),zC=z("<div><div></div><div></div><div></div><div></div><div>"),Il=z("<div>"),qC=z("<div><input type=number min=0 step=1 required><input type=number min=0 step=0.01><input type=text>"),GC=z("<div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span>"),HC=z("<div> ");const YC=t=>{const{t:e}=lt(),[r,n]=ge(`INV-${Date.now()}`),[i,o]=ge(""),[a,c]=ge("in"),[d,h]=ge(""),[m,g]=ge(""),[_,A]=ge(""),[M,L]=ge([]),[k,R]=ge([]),[W,ie]=ge(!1),[te,ye]=ge(!1),ae=()=>{L(Y=>[...Y,{productId:"",quantity:0,unitCost:0,notes:""}])},$=Y=>{L(se=>se.filter((O,F)=>F!==Y))},S=(Y,se,O)=>{L(F=>F.map((le,pe)=>pe===Y?{...le,[se]:O}:le))},p=()=>{n(`INV-${Date.now()}`),o(""),c("in"),h(""),g(""),A(""),L([]),R([])},C=async Y=>{Y.preventDefault(),R([]);const se=[];if(i()||se.push(e("forms.referenceNumberRequired")),d()||se.push(e("forms.locationRequired")),a()==="transfer"&&!m()&&se.push(e("forms.fromLocationRequired")),M().length===0&&se.push(e("forms.atLeastOneProduct")),M().forEach((le,pe)=>{le.productId||se.push(e("forms.itemProductRequired","Product is required for item {{index}}",{index:pe+1})),le.quantity<=0&&se.push(e("forms.itemQuantityRequired","Quantity must be greater than 0 for item {{index}}",{index:pe+1}))}),se.length>0){R(se);return}const O={ssg_inventory_key:Xs(),invoiceId:r(),referenceNumber:i(),movementType:a(),type:Yl(a()),locationId:d(),fromLocationId:a()==="transfer"?m():void 0,items:M(),products:M(),generalNotes:_(),description:_(),invoice:i(),store:d(),createdBy:"admin",createDate:new Date().toISOString()};console.log(O);const F=await De.addBulkInventoryMovements(O);console.log(F),F.success?(p(),t.onClose()):R(F.errors)},P=()=>{p(),t.onClose()},E=We(()=>M().reduce((Y,se)=>{const O=De.getProductById(se.productId),F=se.unitCost||O?.unitCost||0;return Y+se.quantity*F},0)),y=We(()=>M().reduce((Y,se)=>Y+se.quantity,0)),oe={"margin-bottom":"1.5rem"},K={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},T={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},U={...T,cursor:"pointer"},B={display:"grid",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},x={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},I={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem","padding-left":"0.75rem"},N={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},Z={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},j={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},J={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},w=Y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Y),V=Y=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[Y]||Y,X=async Y=>{await De.fecthInventory(Y),await De.fecthProduct(Y)};return qr(()=>{X("prod")}),b(gr,{get isOpen(){return t.isOpen},onClose:P,get title(){return e("inventory.bulkMovement")},get children(){return[(()=>{var Y=UC(),se=Y.firstChild,O=se.firstChild,F=O.firstChild,le=F.firstChild,pe=F.nextSibling,ve=O.nextSibling,ce=ve.firstChild,H=ce.firstChild,D=ce.nextSibling,Q=se.nextSibling,G=Q.firstChild,he=G.firstChild,me=G.nextSibling,ee=me.firstChild,ne=ee.nextSibling,Se=ne.nextSibling,we=Se.nextSibling,ue=Q.nextSibling,be=ue.firstChild,de=be.firstChild,Pe=ue.nextSibling,$e=Pe.firstChild,xe=$e.firstChild,ke=Pe.nextSibling,Be=ke.firstChild,Qe=Be.nextSibling,Ue=ke.nextSibling;return Y.addEventListener("submit",C),se.style.setProperty("display","grid"),se.style.setProperty("grid-template-columns","1fr 1fr"),se.style.setProperty("gap","1rem"),se.style.setProperty("margin-bottom","1.5rem"),s(F,()=>e("common.invoiceDocumentId"),le),pe.addEventListener("change",Te=>n(Te.target.value)),s(ce,()=>e("common.referenceNumber"),H),D.addEventListener("change",Te=>o(Te.target.value)),s(G,()=>e("inventory.movementType"),he),me.addEventListener("change",Te=>c(Te.target.value)),s(ee,()=>e("inventory.purchaseReceive")),s(ne,()=>e("inventory.saleIssue")),s(Se,()=>e("inventory.transfer")),s(we,()=>e("inventory.adjustment")),ue.style.setProperty("display","grid"),ue.style.setProperty("gap","1rem"),ue.style.setProperty("margin-bottom","1.5rem"),s(ue,(()=>{var Te=fe(()=>a()==="transfer");return()=>Te()&&(()=>{var Fe=jC(),Je=Fe.firstChild,Ge=Je.firstChild;return s(Je,()=>e("inventory.fromLocation"),Ge),s(Fe,b(Ma,{get value(){return m()},onChange:Xe=>g(Xe),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>ye(!0),required:!0}),null),re(Xe=>u(Je,K,Xe)),Fe})()})(),be),s(de,(()=>{var Te=fe(()=>a()==="transfer");return()=>Te()?e("inventory.toLocation")+" *":e("inventory.location")+" *"})()),s(be,b(Ma,{get value(){return d()},onChange:Te=>h(Te),get placeholder(){return fe(()=>a()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>ye(!0),required:!0}),null),$e.style.setProperty("display","flex"),$e.style.setProperty("justify-content","space-between"),$e.style.setProperty("align-items","center"),$e.style.setProperty("margin-bottom","1rem"),xe.style.setProperty("margin","0"),xe.style.setProperty("font-size","1.1rem"),s(xe,()=>e("inventory.products")),s($e,b(Le,{variant:"outline",type:"button",onClick:ae,get children(){return e("inventory.addProduct")}}),null),s(Pe,(()=>{var Te=fe(()=>M().length>0);return()=>Te()&&[(()=>{var Fe=zC(),Je=Fe.firstChild,Ge=Je.nextSibling,Xe=Ge.nextSibling,Ae=Xe.nextSibling;return u(Fe,I),s(Je,()=>e("inventory.product")),s(Ge,()=>e("inventory.quantity")),s(Xe,()=>e("inventory.unitCost")),s(Ae,()=>e("common.notes")),Fe})(),b(pt,{get each(){return M()},children:(Fe,Je)=>[(()=>{var Ge=Il();return u(Ge,B),s(Ge,b(Eu,{get value(){return Fe.productId},onChange:Xe=>{S(Je(),"productId",Xe.id);let Ae={id:Xe.id,label:Xe.name,code:Xe.sku};S(Je(),"product",Ae);const Ie=De.getProductById(Xe.id);Ie&&!Fe.unitCost&&S(Je(),"unitCost",Ie.unitCost)},get placeholder(){return e("inventory.searchProduct")},onAddNew:()=>ie(!0),required:!0})),Ge})(),(()=>{var Ge=qC(),Xe=Ge.firstChild,Ae=Xe.nextSibling,Ie=Ae.nextSibling;return u(Ge,x),Xe.addEventListener("change",Ze=>S(Je(),"quantity",Number(Ze.target.value))),Ae.addEventListener("change",Ze=>S(Je(),"unitCost",Number(Ze.target.value))),Ie.addEventListener("change",Ze=>S(Je(),"notes",Ze.target.value)),s(Ge,b(Le,{variant:"outline",size:"sm",type:"button",onClick:()=>$(Je()),style:{color:"#f44336","border-color":"#f44336"},get children(){return e("common.remove")}}),null),re(Ze=>{var dt=T,ft=T,Tt=e("common.auto"),_t=T,Et=e("common.optionalNotes");return Ze.e=u(Xe,dt,Ze.e),Ze.t=u(Ae,ft,Ze.t),Tt!==Ze.a&&ct(Ae,"placeholder",Ze.a=Tt),Ze.o=u(Ie,_t,Ze.o),Et!==Ze.i&&ct(Ie,"placeholder",Ze.i=Et),Ze},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),re(()=>Xe.value=Fe.quantity),re(()=>Ae.value=Fe.unitCost),re(()=>Ie.value=Fe.notes),Ge})()]})]})(),null),s(Pe,(()=>{var Te=fe(()=>M().length===0);return()=>Te()&&(()=>{var Fe=Il();return Fe.style.setProperty("text-align","center"),Fe.style.setProperty("padding","2rem"),Fe.style.setProperty("background","var(--background-color)"),Fe.style.setProperty("border-radius","var(--border-radius-sm)"),Fe.style.setProperty("border","1px solid var(--border-color)"),Fe.style.setProperty("color","var(--text-muted)"),s(Fe,()=>e("inventory.noProductsAdded")),Fe})()})(),null),s(Y,(()=>{var Te=fe(()=>M().length>0);return()=>Te()&&(()=>{var Fe=GC(),Je=Fe.firstChild,Ge=Je.nextSibling,Xe=Ge.firstChild,Ae=Xe.firstChild,Ie=Xe.nextSibling,Ze=Ge.nextSibling,dt=Ze.firstChild,ft=dt.firstChild,Tt=dt.nextSibling,_t=Ze.nextSibling,Et=_t.firstChild,Mt=Et.firstChild,it=Et.nextSibling,Vt=_t.nextSibling,It=Vt.firstChild,je=It.firstChild,Oe=It.nextSibling;return u(Fe,N),Je.style.setProperty("margin","0 0 1rem 0"),Je.style.setProperty("font-size","1rem"),s(Je,()=>e("common.summary")),s(Xe,()=>e("inventory.totalProducts"),Ae),Ie.style.setProperty("font-weight","600"),s(Ie,()=>M().length),s(dt,()=>e("inventory.totalItems"),ft),Tt.style.setProperty("font-weight","600"),s(Tt,y),s(Et,()=>e("inventory.totalValue"),Mt),it.style.setProperty("font-weight","600"),it.style.setProperty("color","var(--primary-color)"),s(it,()=>w(E())),s(It,()=>e("inventory.movementType"),je),Oe.style.setProperty("font-weight","600"),s(Oe,()=>V(a())),re(Me=>{var He=Z,nt=Z,mt=Z,Ke=Z;return Me.e=u(Ge,He,Me.e),Me.t=u(Ze,nt,Me.t),Me.a=u(_t,mt,Me.a),Me.o=u(Vt,Ke,Me.o),Me},{e:void 0,t:void 0,a:void 0,o:void 0}),Fe})()})(),ke),s(Be,()=>e("common.generalNotes")),Qe.addEventListener("change",Te=>A(Te.target.value)),s(Y,(()=>{var Te=fe(()=>k().length>0);return()=>Te()&&(()=>{var Fe=Il();return u(Fe,j),s(Fe,b(pt,{get each(){return k()},children:Je=>(()=>{var Ge=HC();return Ge.firstChild,s(Ge,Je,null),Ge})()})),Fe})()})(),Ue),u(Ue,J),s(Ue,b(Le,{variant:"secondary",type:"button",onClick:P,get children(){return e("common.cancel")}}),null),s(Ue,b(Le,{variant:"primary",type:"submit",get children(){return e("inventory.createMovement")}}),null),re(Te=>{var Fe=K,Je=T,Ge=K,Xe=T,Ae=e("common.referenceNumberPlaceholder"),Ie=oe,Ze=K,dt=U,ft=a()==="transfer"?"1fr 1fr":"1fr",Tt=K,_t=oe,Et=oe,Mt=K,it={...T,"min-height":"80px",resize:"vertical"},Vt=e("inventory.generalNotesPlaceholder");return Te.e=u(F,Fe,Te.e),Te.t=u(pe,Je,Te.t),Te.a=u(ce,Ge,Te.a),Te.o=u(D,Xe,Te.o),Ae!==Te.i&&ct(D,"placeholder",Te.i=Ae),Te.n=u(Q,Ie,Te.n),Te.s=u(G,Ze,Te.s),Te.h=u(me,dt,Te.h),ft!==Te.r&&((Te.r=ft)!=null?ue.style.setProperty("grid-template-columns",ft):ue.style.removeProperty("grid-template-columns")),Te.d=u(de,Tt,Te.d),Te.l=u(Pe,_t,Te.l),Te.u=u(ke,Et,Te.u),Te.c=u(Be,Mt,Te.c),Te.w=u(Qe,it,Te.w),Vt!==Te.m&&ct(Qe,"placeholder",Te.m=Vt),Te},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),re(()=>pe.value=r()),re(()=>D.value=i()),re(()=>me.value=a()),re(()=>Qe.value=_()),Y})(),b(xu,{get isOpen(){return W()},onClose:()=>ie(!1),onProductAdded:Y=>{ie(!1)}}),b(Tu,{get isOpen(){return te()},onClose:()=>ye(!1),onLocationAdded:Y=>{a()==="transfer"&&!m()?g(Y):h(Y),ye(!1)}})]}})};var WC=z("<div><div></div><div></div><div></div><div>"),KC=z("<div><strong>:</strong> "),QC=z("<div><div><span></span><span></span></div><div><span></span><span> </span></div><div><span></span><span> </span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),JC=z("<div>");const XC=t=>{const{t:e}=lt(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={"text-align":"center","margin-bottom":"2rem"},a={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},c={color:"var(--text-muted)","font-size":"1rem"},d={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"1rem"},h=(L,k)=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:L>k?"#d4edda":"#f8d7da",color:L>k?"#155724":"#721c24"}),m={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},g={"margin-bottom":"1.5rem",padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",color:"var(--text-secondary)"};if(!t.item)return null;const _=L=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(L),A=L=>new Date(L).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),M=t.item.price*t.item.quantity;return b(gr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.itemDetails")},get children(){return[(()=>{var L=WC(),k=L.firstChild,R=k.nextSibling,W=R.nextSibling,ie=W.nextSibling;return u(L,o),u(k,a),s(k,()=>t.item.name),u(R,c),s(R,()=>t.item.category),u(W,d),s(W,()=>_(t.item.price)),s(ie,(()=>{var te=fe(()=>t.item.quantity>t.item.minStock);return()=>te()?e("inventory.inStock"):e("inventory.lowStockAlert")})()),re(te=>u(ie,h(t.item.quantity,t.item.minStock),te)),L})(),(()=>{var L=KC(),k=L.firstChild,R=k.firstChild;return k.nextSibling,u(L,g),s(k,()=>e("common.description"),R),s(L,()=>t.item.description,null),L})(),(()=>{var L=QC(),k=L.firstChild,R=k.firstChild,W=R.nextSibling,ie=k.nextSibling,te=ie.firstChild,ye=te.nextSibling,ae=ye.firstChild,$=ie.nextSibling,S=$.firstChild,p=S.nextSibling,C=p.firstChild,P=$.nextSibling,E=P.firstChild,y=E.nextSibling,oe=P.nextSibling,K=oe.firstChild,T=K.nextSibling,U=oe.nextSibling,B=U.firstChild,x=B.nextSibling,I=U.nextSibling,N=I.firstChild,Z=N.nextSibling;return s(R,()=>e("inventory.sku")),s(W,()=>t.item.sku),s(te,()=>e("inventory.quantity")),s(ye,()=>t.item.quantity,ae),s(ye,()=>e("common.units"),null),s(S,()=>e("inventory.minimumStock")),s(p,()=>t.item.minStock,C),s(p,()=>e("common.units"),null),s(E,()=>e("inventory.totalValue")),s(y,()=>_(M)),s(K,()=>e("inventory.supplier")),s(T,()=>t.item.supplier),s(B,()=>e("inventory.location")),s(x,()=>t.item.location),s(N,()=>e("common.lastUpdated")),s(Z,()=>A(t.item.lastUpdated)),re(j=>{var J=r,w=n,V=i,X=r,Y=n,se=i,O=r,F=n,le=i,pe=r,ve=n,ce=i,H=r,D=n,Q=i,G=r,he=n,me=i,ee=r,ne=n,Se=i;return j.e=u(k,J,j.e),j.t=u(R,w,j.t),j.a=u(W,V,j.a),j.o=u(ie,X,j.o),j.i=u(te,Y,j.i),j.n=u(ye,se,j.n),j.s=u($,O,j.s),j.h=u(S,F,j.h),j.r=u(p,le,j.r),j.d=u(P,pe,j.d),j.l=u(E,ve,j.l),j.u=u(y,ce,j.u),j.c=u(oe,H,j.c),j.w=u(K,D,j.w),j.m=u(T,Q,j.m),j.f=u(U,G,j.f),j.y=u(B,he,j.y),j.g=u(x,me,j.g),j.p=u(I,ee,j.p),j.b=u(N,ne,j.b),j.T=u(Z,Se,j.T),j},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),L})(),(()=>{var L=JC();return u(L,m),s(L,b(Le,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(L,b(Le,{variant:"primary",onClick:()=>{console.log("Edit item:",t.item.id)},get children(){return e("common.editItem")}}),null),L})()]}})};var ZC=z("<div>"),eA=z("<button type=button>"),tA=z("<div> "),Qh=z("<div>"),rA=z("<div><div><input type=text autocomplete=off>"),nA=z("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>"),iA=z("<span> ");const oA=t=>{const{t:e}=lt(),[r,n]=ge(""),[i,o]=ge(!1),[a,c]=ge(null),[d,h]=ge([]),[m,g]=ge(!1),[_,A]=ge(-1),[M,L]=ge(null),k=t.searchDelay||300;t.maxResults;const R=async J=>{if(!J.trim()||J.trim().length<3){h([]),t.onSearchResults?.([]);return}try{o(!0),c(null);try{console.log("apiResults",J),t.onSearchResults?.(J)}catch(w){console.warn("API search failed, using local fallback:",w),c("API search failed, showing local results")}}catch(w){const V=w instanceof Error?w.message:"Search failed";c(V),h([]),t.onSearchResults?.([])}finally{o(!1)}},W=J=>{const V=J.target.value;n(V),c(null),console.log(),t.showResults,M()&&clearTimeout(M());const X=setTimeout(()=>{R(V)},k);L(X)},ie=J=>{n(J.name),g(!1),A(-1),t.onInventorySelect?.(J)},te=J=>{if(!(!m()||d().length===0))switch(J.key){case"ArrowDown":J.preventDefault(),A(w=>Math.min(w+1,d().length-1));break;case"ArrowUp":J.preventDefault(),A(w=>Math.max(w-1,-1));break;case"Enter":J.preventDefault(),_()>=0&&d()[_()]&&ie(d()[_()]);break;case"Escape":g(!1),A(-1);break}},ye=()=>{t.showResults!==!1&&d().length>0&&g(!0)},ae=()=>{setTimeout(()=>{g(!1),A(-1)},150)},$=()=>{n(""),h([]),c(null),g(!1),A(-1),t.onSearchResults?.([]),M()&&(clearTimeout(M()),L(null))},S=J=>De.stockLevels.filter(w=>w.inventoryId===J).reduce((w,V)=>w+V.quantity,0),p=J=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(J),C={position:"relative",width:"100%",...t.style},P={position:"relative",display:"flex","align-items":"center"},E={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},y={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},oe={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},K={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},T=J=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:J?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),U={display:"flex","justify-content":"space-between","align-items":"center"},B={flex:"1"},x={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},I={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},N={"text-align":"right","font-size":"0.875rem"},Z={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},j={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var J=rA(),w=J.firstChild,V=w.firstChild;return V.addEventListener("blur",ae),V.addEventListener("focus",ye),V.$$keydown=te,V.$$input=W,s(w,b(Ne,{get when(){return i()},get children(){var X=ZC();return re(Y=>u(X,oe,Y)),X}}),null),s(w,b(Ne,{get when(){return fe(()=>!!r())()&&!i()},get children(){var X=eA();return X.addEventListener("mouseleave",Y=>{Y.currentTarget.style.background="none",Y.currentTarget.style.color="var(--text-muted)"}),X.addEventListener("mouseenter",Y=>{Y.currentTarget.style.background="var(--border-color)",Y.currentTarget.style.color="var(--text-primary)"}),X.$$click=$,re(Y=>{var se=y,O=e("common.clear","Clear search");return Y.e=u(X,se,Y.e),O!==Y.t&&ct(X,"title",Y.t=O),Y},{e:void 0,t:void 0}),X}}),null),s(J,b(Ne,{get when(){return m()&&t.showResults!==!1},get children(){var X=Qh();return s(X,b(Ne,{get when(){return a()},get children(){var Y=tA();return Y.firstChild,u(Y,j),s(Y,a,null),Y}}),null),s(X,b(Ne,{get when(){return d().length>0},get fallback(){return fe(()=>!!(r()&&!i()))()&&(()=>{var Y=Qh();return u(Y,Z),s(Y,()=>e("inventory.noInventorysFound","No inventorys found matching your search.")),Y})()},get children(){return b(pt,{get each(){return d()},children:(Y,se)=>{const O=S(Y.id),F=O<=Y.minStockLevel;return(()=>{var le=nA(),pe=le.firstChild,ve=pe.firstChild,ce=ve.firstChild,H=ce.nextSibling,D=H.firstChild,Q=D.firstChild,G=D.nextSibling,he=G.nextSibling,me=he.nextSibling,ee=me.nextSibling,ne=ve.nextSibling,Se=ne.firstChild,we=Se.firstChild,ue=Se.nextSibling;return le.addEventListener("mouseenter",()=>A(se())),le.$$click=()=>ie(Y),u(pe,U),u(ve,B),u(ce,x),s(ce,()=>Y.name),u(H,I),s(D,()=>e("inventory.sku","SKU"),Q),s(D,()=>Y.sku,null),s(he,()=>Y.category),s(ee,()=>p(Y.unitCost)),u(ne,N),Se.style.setProperty("font-weight","600"),(F?"#f44336":"var(--text-primary)")!=null?Se.style.setProperty("color",F?"#f44336":"var(--text-primary)"):Se.style.removeProperty("color"),s(Se,O,we),s(Se,()=>Y.unitOfMeasure,null),ue.style.setProperty("color","var(--text-muted)"),s(ue,()=>F?(()=>{var be=iA();return be.firstChild,be.style.setProperty("color","#f44336"),s(be,()=>e("inventory.lowStock","Low Stock"),null),be})():e("inventory.inStock","In Stock")),re(be=>u(le,T(se()===_()),be)),le})()}})}}),null),re(Y=>u(X,K,Y)),X}}),null),re(X=>{var Y=C,se=P,O=E,F=t.placeholder||e("inventory.searchInventorys","Search inventorys by name, SKU, or category..."),le=t.disabled;return X.e=u(J,Y,X.e),X.t=u(w,se,X.t),X.a=u(V,O,X.a),F!==X.o&&ct(V,"placeholder",X.o=F),le!==X.i&&(V.disabled=X.i=le),X},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),re(()=>V.value=r()),J})()};At(["input","keydown","click"]);var sA=z("<div>"),El=z("<div><span>:</span><span>"),aA=z("<div><button> "),lA=z("<div><div><div><h3></h3><div>: </div></div><div><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span> <!>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span>");const cA=t=>{const{t:e}=lt(),r=A=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(A),n=A=>new Date(A).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),i=A=>({in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}})[A]||{bg:"#f5f5f5",color:"#666"},o=A=>({in:"",out:"",transfer:"",adjustment:""})[A]||"",a=()=>t.movement,c={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},d={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},h={"font-weight":"600",color:"var(--text-primary)","text-align":"right"},m={"margin-bottom":"1.5rem"},g={"font-weight":"600","margin-bottom":"0.75rem","padding-bottom":"0.5rem","border-bottom":"2px solid var(--border-color)"},_=A=>({display:"inline-flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"600","text-transform":"uppercase","letter-spacing":"0.5px",background:i(A).bg,color:i(A).color});return b(gr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.movementDetails")},size:"lg",get children(){return b(Ne,{get when(){return a()},get fallback(){return(()=>{var A=sA();return s(A,()=>e("common.noDataFound")),A})()},children:A=>(()=>{var M=lA(),L=M.firstChild,k=L.firstChild,R=k.firstChild,W=R.nextSibling,ie=W.firstChild,te=k.nextSibling,ye=te.firstChild,ae=L.nextSibling,$=ae.firstChild,S=$.nextSibling,p=S.firstChild,C=p.firstChild,P=p.nextSibling,E=S.nextSibling,y=E.firstChild,oe=y.firstChild,K=y.nextSibling,T=K.firstChild,U=E.nextSibling,B=U.firstChild,x=B.firstChild,I=B.nextSibling,N=U.nextSibling,Z=N.firstChild,j=Z.firstChild,J=j.nextSibling;J.nextSibling;var w=Z.nextSibling,V=ae.nextSibling,X=V.firstChild,Y=X.nextSibling,se=Y.firstChild,O=se.firstChild,F=se.nextSibling,le=V.nextSibling,pe=le.firstChild,ve=pe.nextSibling,ce=ve.firstChild,H=ce.firstChild,D=ce.nextSibling,Q=ve.nextSibling,G=Q.firstChild,he=G.firstChild,me=G.nextSibling;return L.style.setProperty("display","flex"),L.style.setProperty("justify-content","space-between"),L.style.setProperty("align-items","center"),L.style.setProperty("margin-bottom","1.5rem"),L.style.setProperty("padding-bottom","1rem"),L.style.setProperty("border-bottom","2px solid var(--border-color)"),R.style.setProperty("margin","0 0 0.5rem 0"),R.style.setProperty("font-size","1.25rem"),s(R,()=>A().productName),W.style.setProperty("font-size","0.875rem"),W.style.setProperty("color","var(--text-muted)"),s(W,()=>e("inventory.sku"),ie),s(W,()=>A().productSku,null),ye.style.setProperty("font-size","1.2rem"),s(ye,()=>o(A().movementType)),s(te,()=>A().movementType,null),s($,()=>e("inventory.movementInformation")),s(p,()=>e("inventory.referenceNumber"),C),s(P,()=>A().referenceNumber),s(y,()=>e("common.quantity"),oe),s(K,()=>A().quantity,T),s(K,()=>e("common.units"),null),s(B,()=>e("inventory.unitCost"),x),s(I,()=>r(A().unitCost)),s(Z,()=>e("common.total"),j),s(Z,()=>e("common.value"),J),s(w,()=>r(A().totalCost)),s(X,()=>e("inventory.locationInformation")),s(se,()=>e("inventory.location"),O),s(F,()=>A().locationName),s(V,b(Ne,{get when(){return A().fromLocationName},get children(){var ee=El(),ne=ee.firstChild,Se=ne.firstChild,we=ne.nextSibling;return s(ne,()=>e("common.from"),Se),s(we,()=>A().fromLocationName),re(ue=>{var be=c,de=d,Pe=h;return ue.e=u(ee,be,ue.e),ue.t=u(ne,de,ue.t),ue.a=u(we,Pe,ue.a),ue},{e:void 0,t:void 0,a:void 0}),ee}}),null),s(V,b(Ne,{get when(){return A().invoiceId},get children(){var ee=El(),ne=ee.firstChild,Se=ne.firstChild,we=ne.nextSibling;return s(ne,()=>e("common.invoice"),Se),s(we,()=>A().invoiceId),re(ue=>{var be=c,de=d,Pe={...h,color:"var(--primary-color)"};return ue.e=u(ee,be,ue.e),ue.t=u(ne,de,ue.t),ue.a=u(we,Pe,ue.a),ue},{e:void 0,t:void 0,a:void 0}),ee}}),null),s(pe,()=>e("common.details")),s(ce,()=>e("common.createdBy"),H),s(D,()=>A().createdBy),s(G,()=>e("common.created"),he),s(me,()=>n(A().createdDate)),s(le,b(Ne,{get when(){return A().notes},get children(){var ee=El(),ne=ee.firstChild,Se=ne.firstChild,we=ne.nextSibling;return s(ne,()=>e("common.notes"),Se),s(we,()=>A().notes),re(ue=>{var be={...c,"border-bottom":"none"},de=d,Pe={...h,"font-style":"italic","max-width":"60%","white-space":"pre-wrap"};return ue.e=u(ee,be,ue.e),ue.t=u(ne,de,ue.t),ue.a=u(we,Pe,ue.a),ue},{e:void 0,t:void 0,a:void 0}),ee}}),null),s(M,b(Ne,{get when(){return t.onEdit},get children(){var ee=aA(),ne=ee.firstChild,Se=ne.firstChild;return ee.style.setProperty("display","flex"),ee.style.setProperty("justify-content","flex-end"),ee.style.setProperty("margin-top","1.5rem"),ee.style.setProperty("padding-top","1rem"),ee.style.setProperty("border-top","1px solid var(--border-color)"),ne.addEventListener("mouseleave",we=>{we.currentTarget.style.transform="translateY(0)",we.currentTarget.style.boxShadow="none"}),ne.addEventListener("mouseenter",we=>{we.currentTarget.style.transform="translateY(-1px)",we.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)"}),ne.$$click=()=>t.onEdit?.(A()),ne.style.setProperty("padding","0.5rem 1.5rem"),ne.style.setProperty("border-radius","var(--border-radius-sm)"),ne.style.setProperty("border","1px solid var(--primary-color)"),ne.style.setProperty("background","var(--primary-color)"),ne.style.setProperty("color","white"),ne.style.setProperty("cursor","pointer"),ne.style.setProperty("font-weight","500"),ne.style.setProperty("transition","all 0.2s ease"),s(ne,()=>e("common.edit"),Se),s(ne,()=>e("inventory.movement"),null),ee}}),null),re(ee=>{var ne=_(A().movementType),Se=m,we=g,ue=c,be=d,de=h,Pe=c,$e=d,xe={...h,"font-size":"1.1rem",color:"var(--primary-color)"},ke=c,Be=d,Qe=h,Ue=c,Te=d,Fe={...h,"font-size":"1.1rem",color:"var(--primary-color)"},Je=m,Ge=g,Xe=c,Ae=d,Ie=h,Ze=m,dt=g,ft=c,Tt=d,_t=h,Et=c,Mt=d,it=h;return ee.e=u(te,ne,ee.e),ee.t=u(ae,Se,ee.t),ee.a=u($,we,ee.a),ee.o=u(S,ue,ee.o),ee.i=u(p,be,ee.i),ee.n=u(P,de,ee.n),ee.s=u(E,Pe,ee.s),ee.h=u(y,$e,ee.h),ee.r=u(K,xe,ee.r),ee.d=u(U,ke,ee.d),ee.l=u(B,Be,ee.l),ee.u=u(I,Qe,ee.u),ee.c=u(N,Ue,ee.c),ee.w=u(Z,Te,ee.w),ee.m=u(w,Fe,ee.m),ee.f=u(V,Je,ee.f),ee.y=u(X,Ge,ee.y),ee.g=u(Y,Xe,ee.g),ee.p=u(se,Ae,ee.p),ee.b=u(F,Ie,ee.b),ee.T=u(le,Ze,ee.T),ee.A=u(pe,dt,ee.A),ee.O=u(ve,ft,ee.O),ee.I=u(ce,Tt,ee.I),ee.S=u(D,_t,ee.S),ee.W=u(Q,Et,ee.W),ee.C=u(G,Mt,ee.C),ee.B=u(me,it,ee.B),ee},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),M})()})}})};At(["click"]);var mi=z("<div>"),uA=z("<div><label></label><select><option value>"),dA=z("<div><div><span>:</span><span>$"),hA=z("<form><div><label></label><select><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><input type=number min=0.01 step=0.01></div><div><label></label><input type=number min=0 step=0.01></div><div><label></label><input type=text></div><div><label> (<!>)</label><input type=text></div><div><label> (<!>)</label><textarea></textarea></div><div><button type=button></button><button type=submit>"),Jh=z("<option> (<!>)");const mA=t=>{const{t:e}=lt(),[r,n]=ge("in"),[i,o]=ge(""),[a,c]=ge(""),[d,h]=ge(""),[m,g]=ge(""),[_,A]=ge(""),[M,L]=ge(""),[k,R]=ge(""),[W,ie]=ge(!1),[te,ye]=ge({});Dn(()=>{const oe=t.movement;oe&&t.isOpen&&(n(oe.movementType),o(oe.quantity.toString()),c(oe.unitCost.toString()),h(oe.referenceNumber),g(oe.notes),L(oe.locationId),A(oe.fromLocationId||""),R(oe.invoiceId||""),ye({}))});const ae=()=>{const oe={};return(!i()||parseFloat(i())<=0)&&(oe.quantity=e("forms.requiredField")),(!a()||parseFloat(a())<0)&&(oe.unitCost=e("forms.requiredField")),d().trim()||(oe.referenceNumber=e("forms.requiredField")),M()||(oe.locationId=e("forms.requiredField")),r()==="transfer"&&!_()&&(oe.fromLocationId=e("forms.requiredField")),ye(oe),Object.keys(oe).length===0},$=async oe=>{if(oe.preventDefault(),!(!ae()||!t.movement)){ie(!0);try{const K=t.movement,T=De.getProductById(K.productId),U=De.getLocationById(M()),B=_()?De.getLocationById(_()):null;if(!T||!U)throw new Error("Product or location not found");const x={...K,movementType:r(),quantity:parseFloat(i()),unitCost:parseFloat(a()),totalCost:parseFloat(i())*parseFloat(a()),referenceNumber:d().trim(),notes:m().trim(),locationId:M(),locationName:U.name,fromLocationId:_()||void 0,fromLocationName:B?.name,invoiceId:k().trim()||void 0,lastModified:new Date().toISOString()};De.updateMovement(K.id,x),t.onMovementUpdated?.(),t.onClose(),S()}catch(K){console.error("Error updating movement:",K),ye({submit:e("forms.saveError")})}finally{ie(!1)}}},S=()=>{n("in"),o(""),c(""),h(""),g(""),A(""),L(""),R(""),ye({})},p=()=>{S(),t.onClose()},C={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",transition:"border-color 0.2s ease"},P={display:"block","margin-bottom":"0.25rem","font-weight":"500","font-size":"0.875rem"},E={color:"#d32f2f","font-size":"0.75rem","margin-top":"0.25rem"},y={"margin-bottom":"1rem"};return b(gr,{get isOpen(){return t.isOpen},onClose:p,get title(){return e("inventory.editMovement","Edit Movement")},get children(){return b(Ne,{get when(){return t.movement},get fallback(){return(()=>{var oe=mi();return s(oe,()=>e("common.loading")),oe})()},get children(){var oe=hA(),K=oe.firstChild,T=K.firstChild,U=T.nextSibling,B=U.firstChild,x=B.nextSibling,I=x.nextSibling,N=I.nextSibling,Z=K.nextSibling,j=Z.firstChild,J=j.nextSibling,w=J.firstChild,V=Z.nextSibling,X=V.firstChild,Y=X.nextSibling,se=V.nextSibling,O=se.firstChild,F=O.nextSibling,le=se.nextSibling,pe=le.firstChild,ve=pe.nextSibling,ce=le.nextSibling,H=ce.firstChild,D=H.firstChild,Q=D.nextSibling;Q.nextSibling;var G=H.nextSibling,he=ce.nextSibling,me=he.firstChild,ee=me.firstChild,ne=ee.nextSibling;ne.nextSibling;var Se=me.nextSibling,we=he.nextSibling,ue=we.firstChild,be=ue.nextSibling;return oe.addEventListener("submit",$),s(T,()=>e("inventory.movementType")),U.addEventListener("change",de=>n(de.target.value)),s(B,()=>e("inventory.stockIn")),s(x,()=>e("inventory.stockOut")),s(I,()=>e("inventory.transfer")),s(N,()=>e("inventory.adjustment")),s(j,(()=>{var de=fe(()=>r()==="transfer");return()=>de()?e("inventory.toLocation"):e("inventory.location")})()),J.addEventListener("change",de=>L(de.target.value)),s(w,()=>e("modals.selectLocation")),s(J,b(pt,{get each(){return De.getActiveLocations()},children:de=>(()=>{var Pe=Jh(),$e=Pe.firstChild,xe=$e.nextSibling;return xe.nextSibling,s(Pe,()=>de.name,$e),s(Pe,()=>de.type,xe),re(()=>Pe.value=de.id),Pe})()}),null),s(Z,b(Ne,{get when(){return te().locationId},get children(){var de=mi();return s(de,()=>te().locationId),re(Pe=>u(de,E,Pe)),de}}),null),s(oe,b(Ne,{get when(){return r()==="transfer"},get children(){var de=uA(),Pe=de.firstChild,$e=Pe.nextSibling,xe=$e.firstChild;return s(Pe,()=>e("inventory.fromLocation")),$e.addEventListener("change",ke=>A(ke.target.value)),s(xe,()=>e("modals.selectLocation")),s($e,b(pt,{get each(){return De.getActiveLocations().filter(ke=>ke.id!==M())},children:ke=>(()=>{var Be=Jh(),Qe=Be.firstChild,Ue=Qe.nextSibling;return Ue.nextSibling,s(Be,()=>ke.name,Qe),s(Be,()=>ke.type,Ue),re(()=>Be.value=ke.id),Be})()}),null),s(de,b(Ne,{get when(){return te().fromLocationId},get children(){var ke=mi();return s(ke,()=>te().fromLocationId),re(Be=>u(ke,E,Be)),ke}}),null),re(ke=>{var Be=y,Qe=P,Ue={...C,"border-color":te().fromLocationId?"#d32f2f":"var(--border-color)"},Te=W();return ke.e=u(de,Be,ke.e),ke.t=u(Pe,Qe,ke.t),ke.a=u($e,Ue,ke.a),Te!==ke.o&&($e.disabled=ke.o=Te),ke},{e:void 0,t:void 0,a:void 0,o:void 0}),re(()=>$e.value=_()),de}}),V),s(X,()=>e("common.quantity")),Y.$$input=de=>o(de.target.value),s(V,b(Ne,{get when(){return te().quantity},get children(){var de=mi();return s(de,()=>te().quantity),re(Pe=>u(de,E,Pe)),de}}),null),s(O,()=>e("inventory.unitCost")),F.$$input=de=>c(de.target.value),s(se,b(Ne,{get when(){return te().unitCost},get children(){var de=mi();return s(de,()=>te().unitCost),re(Pe=>u(de,E,Pe)),de}}),null),s(oe,b(Ne,{get when(){return fe(()=>!!i())()&&a()},get children(){var de=dA(),Pe=de.firstChild,$e=Pe.firstChild,xe=$e.firstChild,ke=$e.nextSibling;return ke.firstChild,Pe.style.setProperty("display","flex"),Pe.style.setProperty("justify-content","space-between"),$e.style.setProperty("font-weight","500"),s($e,()=>e("common.total"),xe),ke.style.setProperty("font-weight","600"),ke.style.setProperty("color","var(--primary-color)"),s(ke,()=>(parseFloat(i()||"0")*parseFloat(a()||"0")).toFixed(2),null),re(Be=>u(de,{...y,padding:"0.75rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)"},Be)),de}}),le),s(pe,()=>e("inventory.referenceNumber")),ve.$$input=de=>h(de.target.value),s(le,b(Ne,{get when(){return te().referenceNumber},get children(){var de=mi();return s(de,()=>te().referenceNumber),re(Pe=>u(de,E,Pe)),de}}),null),s(H,()=>e("inventory.invoiceNumber"),D),s(H,()=>e("common.optional"),Q),G.$$input=de=>R(de.target.value),s(me,()=>e("common.notes"),ee),s(me,()=>e("common.optional"),ne),Se.$$input=de=>g(de.target.value),s(oe,b(Ne,{get when(){return te().submit},get children(){var de=mi();return s(de,()=>te().submit),re(Pe=>u(de,{...E,"margin-bottom":"1rem"},Pe)),de}}),we),we.style.setProperty("display","flex"),we.style.setProperty("gap","1rem"),we.style.setProperty("justify-content","flex-end"),ue.$$click=p,ue.style.setProperty("padding","0.5rem 1rem"),ue.style.setProperty("border","1px solid var(--border-color)"),ue.style.setProperty("border-radius","var(--border-radius-sm)"),ue.style.setProperty("background","white"),ue.style.setProperty("cursor","pointer"),s(ue,()=>e("common.cancel")),be.style.setProperty("padding","0.5rem 1rem"),be.style.setProperty("border","none"),be.style.setProperty("border-radius","var(--border-radius-sm)"),be.style.setProperty("background","var(--primary-color)"),be.style.setProperty("color","white"),be.style.setProperty("cursor","pointer"),be.style.setProperty("font-weight","500"),s(be,(()=>{var de=fe(()=>!!W());return()=>de()?e("modals.processing"):e("inventory.updateMovement","Update Movement")})()),re(de=>{var Pe=y,$e=P,xe=C,ke=W(),Be=y,Qe=P,Ue={...C,"border-color":te().locationId?"#d32f2f":"var(--border-color)"},Te=W(),Fe=y,Je=P,Ge={...C,"border-color":te().quantity?"#d32f2f":"var(--border-color)"},Xe=e("modals.enterQuantity"),Ae=W(),Ie=y,Ze=P,dt={...C,"border-color":te().unitCost?"#d32f2f":"var(--border-color)"},ft=e("modals.enterCost"),Tt=W(),_t=y,Et=P,Mt={...C,"border-color":te().referenceNumber?"#d32f2f":"var(--border-color)"},it=e("modals.enterReference"),Vt=W(),It=y,je=P,Oe=C,Me=e("inventory.invoiceNumber"),He=W(),nt=y,mt=P,Ke={...C,resize:"vertical","min-height":"80px"},et=e("modals.addNotes"),st=W(),St=W(),yt=W();return de.e=u(K,Pe,de.e),de.t=u(T,$e,de.t),de.a=u(U,xe,de.a),ke!==de.o&&(U.disabled=de.o=ke),de.i=u(Z,Be,de.i),de.n=u(j,Qe,de.n),de.s=u(J,Ue,de.s),Te!==de.h&&(J.disabled=de.h=Te),de.r=u(V,Fe,de.r),de.d=u(X,Je,de.d),de.l=u(Y,Ge,de.l),Xe!==de.u&&ct(Y,"placeholder",de.u=Xe),Ae!==de.c&&(Y.disabled=de.c=Ae),de.w=u(se,Ie,de.w),de.m=u(O,Ze,de.m),de.f=u(F,dt,de.f),ft!==de.y&&ct(F,"placeholder",de.y=ft),Tt!==de.g&&(F.disabled=de.g=Tt),de.p=u(le,_t,de.p),de.b=u(pe,Et,de.b),de.T=u(ve,Mt,de.T),it!==de.A&&ct(ve,"placeholder",de.A=it),Vt!==de.O&&(ve.disabled=de.O=Vt),de.I=u(ce,It,de.I),de.S=u(H,je,de.S),de.W=u(G,Oe,de.W),Me!==de.C&&ct(G,"placeholder",de.C=Me),He!==de.B&&(G.disabled=de.B=He),de.v=u(he,nt,de.v),de.k=u(me,mt,de.k),de.x=u(Se,Ke,de.x),et!==de.j&&ct(Se,"placeholder",de.j=et),st!==de.q&&(Se.disabled=de.q=st),St!==de.z&&(ue.disabled=de.z=St),yt!==de.P&&(be.disabled=de.P=yt),de},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0,z:void 0,P:void 0}),re(()=>U.value=r()),re(()=>J.value=M()),re(()=>Y.value=i()),re(()=>F.value=a()),re(()=>ve.value=d()),re(()=>G.value=k()),re(()=>Se.value=m()),oe}})}})};At(["input","click"]);var fA=z("<div><div></div><div><div><label></label><select><option value=all></option><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),yA=z("<div><h2>"),Xh=z("<div><label></label><select><option value>"),gA=z("<option> (<!>)"),pA=z("<option>"),vA=z("<div><div></div><div></div><div>"),bA=z("<div><div><div><div><span></span><h3></h3><span></span></div><div>  </div></div><div><div></div><div> <!> @ </div></div></div><div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div><span>:</span><span>"),_A=z("<span>"),SA=z("<span> <!>: "),Zh=z("<div><span>:</span><span>"),PA=z("<div><div><span>:</span><select><option value=10>10</option><option value=25>25</option><option value=50>50</option><option value=100>100</option></select><span></span></div><div><div><span>:</span><input type=number min=1><span> "),wA=z("<span>..."),CA=z("<button>");const AA=t=>{const{t:e}=lt(),[r,n]=ge(""),[i,o]=ge(""),[a,c]=ge("all"),[d,h]=ge({start:"",end:""}),[m,g]=ge(""),[_,A]=ge(""),[M,L]=ge(1),[k,R]=ge(25),[W,ie]=ge(null),[te,ye]=ge(!1),[ae,$]=ge(!1),S=We(()=>{let Q=De.movements;if(t.filterBy==="product"&&t.filterId?Q=Q.filter(G=>G.productId===t.filterId):t.filterBy==="location"&&t.filterId&&(Q=Q.filter(G=>G.locationId===t.filterId)),r()&&(Q=Q.filter(G=>G.productId===r())),i()&&(Q=Q.filter(G=>G.locationId===i())),a()!=="all"&&(Q=Q.filter(G=>G.movementType===a())),d().start&&(Q=Q.filter(G=>G.createdDate>=d().start)),d().end&&(Q=Q.filter(G=>G.createdDate<=d().end+"T23:59:59Z")),m()){const G=m().toLowerCase();Q=Q.filter(he=>he.productName.toLowerCase().includes(G)||he.productSku.toLowerCase().includes(G)||he.locationName.toLowerCase().includes(G)||he.referenceNumber.toLowerCase().includes(G)||he.notes.toLowerCase().includes(G)||he.createdBy.toLowerCase().includes(G)||he.invoiceId&&he.invoiceId.toLowerCase().includes(G)||he.fromLocationName&&he.fromLocationName.toLowerCase().includes(G)||he.movementType.toLowerCase().includes(G))}return Q.sort((G,he)=>new Date(he.createdDate).getTime()-new Date(G.createdDate).getTime())});Dn(()=>{r(),i(),a(),d(),m(),L(1)});const p=We(()=>{const Q=(M()-1)*k(),G=Q+k();return S().slice(Q,G)}),C=We(()=>Math.ceil(S().length/k())),P=We(()=>{const Q=S();return{total:Q.length,stockIn:Q.filter(G=>G.movementType==="in").length,stockOut:Q.filter(G=>G.movementType==="out").length,transfers:Q.filter(G=>G.movementType==="transfer").length,adjustments:Q.filter(G=>G.movementType==="adjustment").length,totalValue:Q.reduce((G,he)=>G+he.totalCost,0)}}),E={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},y={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},oe={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)",cursor:"pointer"},K={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},T={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem","margin-bottom":"2rem"},U={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","text-align":"center"},B={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},x={"font-size":"0.875rem",color:"var(--text-muted)","font-weight":"500"},I={padding:"1.5rem","margin-bottom":"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",transition:"all 0.2s ease"},N={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"1rem"};function Z(Q){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[Q]||{bg:"#f5f5f5",color:"#666"}}const j=Q=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:Z(Q).bg,color:Z(Q).color}),J={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"1rem"},w={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.5rem 0","border-bottom":"1px solid var(--border-color)"},V={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},X={"font-weight":"600",color:"var(--text-primary)"},Y={display:"flex","justify-content":"space-between","align-items":"center","margin-top":"2rem",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},se=Q=>({padding:"0.25rem 0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:Q?"var(--primary-color)":"var(--surface-color)",color:Q?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),O=Q=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Q),F=Q=>new Date(Q).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),le=Q=>({in:"",out:"",transfer:"",adjustment:""})[Q]||"",pe=()=>{n(""),o(""),c("all"),h({start:"",end:""}),g(""),L(1)},ve=Q=>{ie(Q),ye(!0)},ce=Q=>{ie(Q),ye(!1),$(!0)},H=()=>{$(!1),ie(null)},D=async Q=>{i()&&(Q+=" "+i()),Yl(a())&&(Q+=" "+Yl(a()));const G=await an.getInventory(Q),he=De.parseInventoryData(G);De.updMovements(he)};return(()=>{var Q=fA(),G=Q.firstChild,he=G.nextSibling,me=he.firstChild,ee=me.firstChild,ne=ee.nextSibling,Se=ne.firstChild,we=Se.nextSibling,ue=we.nextSibling,be=ue.nextSibling,de=be.nextSibling,Pe=me.nextSibling,$e=Pe.firstChild,xe=$e.nextSibling,ke=Pe.nextSibling,Be=ke.firstChild,Qe=Be.nextSibling,Ue=he.nextSibling,Te=Ue.firstChild,Fe=Te.firstChild,Je=Fe.nextSibling,Ge=Te.nextSibling,Xe=Ge.firstChild,Ae=Xe.nextSibling,Ie=Ge.nextSibling,Ze=Ie.firstChild,dt=Ze.nextSibling,ft=Ie.nextSibling,Tt=ft.firstChild,_t=Tt.nextSibling,Et=ft.nextSibling,Mt=Et.firstChild,it=Mt.nextSibling,Vt=Et.nextSibling,It=Vt.firstChild,je=It.nextSibling;return s(Q,(()=>{var Oe=fe(()=>!t.filterBy);return()=>Oe()&&(()=>{var Me=yA(),He=Me.firstChild;return u(Me,E),He.style.setProperty("margin","0"),He.style.setProperty("font-size","1.5rem"),s(He,()=>e("inventory.movements")),s(Me,b(Le,{variant:"outline",onClick:pe,get children(){return e("common.clearFilters")}}),null),Me})()})(),G),s(Q,b(oA,{filters:{selectedLocation:i,movementType:a},onSearchResults:Oe=>{A(Oe),D(Oe)},get placeholder(){return e("inventory.searchProductsStock","Search inventories...")},showResults:!1,maxResults:20}),G),G.style.setProperty("margin","20px"),u(he,y),s(he,(()=>{var Oe=fe(()=>!t.filterBy);return()=>Oe()&&[(()=>{var Me=Xh(),He=Me.firstChild,nt=He.nextSibling,mt=nt.firstChild;return He.style.setProperty("display","block"),He.style.setProperty("margin-bottom","0.5rem"),He.style.setProperty("font-weight","500"),s(He,()=>e("inventory.product")),nt.addEventListener("change",Ke=>n(Ke.target.value)),s(mt,()=>e("inventory.allProducts")),s(nt,b(pt,{get each(){return De.products},children:Ke=>(()=>{var et=gA(),st=et.firstChild,St=st.nextSibling;return St.nextSibling,s(et,()=>Ke.name,st),s(et,()=>Ke.sku,St),re(()=>et.value=Ke.id),et})()}),null),re(Ke=>u(nt,oe,Ke)),re(()=>nt.value=r()),Me})(),(()=>{var Me=Xh(),He=Me.firstChild,nt=He.nextSibling,mt=nt.firstChild;return He.style.setProperty("display","block"),He.style.setProperty("margin-bottom","0.5rem"),He.style.setProperty("font-weight","500"),s(He,()=>e("inventory.location")),nt.addEventListener("change",Ke=>o(Ke.target.value)),s(mt,()=>e("inventory.allLocations")),s(nt,b(pt,{get each(){return De.locations},children:Ke=>(()=>{var et=pA();return s(et,()=>Ke.name),re(()=>et.value=Ke.id),et})()}),null),re(Ke=>u(nt,oe,Ke)),re(()=>nt.value=i()),Me})()]})(),me),ee.style.setProperty("display","block"),ee.style.setProperty("margin-bottom","0.5rem"),ee.style.setProperty("font-weight","500"),s(ee,()=>e("inventory.movementType")),ne.addEventListener("change",Oe=>{c(Oe.target.value),D(_())}),s(Se,()=>e("inventory.allTypes")),s(we,()=>e("inventory.stockIn")),s(ue,()=>e("inventory.stockOut")),s(be,()=>e("inventory.transfer")),s(de,()=>e("inventory.adjustment")),$e.style.setProperty("display","block"),$e.style.setProperty("margin-bottom","0.5rem"),$e.style.setProperty("font-weight","500"),s($e,()=>e("common.startDate")),xe.addEventListener("change",Oe=>h(Me=>({...Me,start:Oe.target.value}))),Be.style.setProperty("display","block"),Be.style.setProperty("margin-bottom","0.5rem"),Be.style.setProperty("font-weight","500"),s(Be,()=>e("common.endDate")),Qe.addEventListener("change",Oe=>h(Me=>({...Me,end:Oe.target.value}))),u(Ue,T),s(Fe,()=>P().total),s(Je,()=>e("inventory.totalMovements")),s(Xe,()=>P().stockIn),s(Ae,()=>e("inventory.stockIn")),s(Ze,()=>P().stockOut),s(dt,()=>e("inventory.stockOut")),s(Tt,()=>P().transfers),s(_t,()=>e("inventory.transfers")),s(Mt,()=>P().adjustments),s(it,()=>e("inventory.adjustments")),s(It,()=>O(P().totalValue)),s(je,()=>e("inventory.totalValue")),s(Q,(()=>{var Oe=fe(()=>p().length===0);return()=>Oe()?(()=>{var Me=vA(),He=Me.firstChild,nt=He.nextSibling,mt=nt.nextSibling;return Me.style.setProperty("text-align","center"),Me.style.setProperty("padding","3rem"),Me.style.setProperty("color","var(--text-muted)"),Me.style.setProperty("background","var(--surface-color)"),Me.style.setProperty("border-radius","var(--border-radius)"),Me.style.setProperty("border","1px solid var(--border-color)"),He.style.setProperty("font-size","1.5rem"),He.style.setProperty("margin-bottom","1rem"),nt.style.setProperty("font-size","1.1rem"),nt.style.setProperty("margin-bottom","0.5rem"),s(nt,()=>e("inventory.noMovementsFound")),mt.style.setProperty("font-size","0.875rem"),s(mt,()=>e("inventory.tryAdjustingFilters")),Me})():[b(pt,{get each(){return p()},children:Me=>(()=>{var He=bA(),nt=He.firstChild,mt=nt.firstChild,Ke=mt.firstChild,et=Ke.firstChild,st=et.nextSibling,St=st.nextSibling,yt=Ke.nextSibling,Xt=yt.firstChild,Nt=mt.nextSibling,or=Nt.firstChild,pr=or.nextSibling,Bt=pr.firstChild,Zt=Bt.nextSibling;Zt.nextSibling;var Gr=nt.nextSibling,Yt=Gr.firstChild,cr=Yt.firstChild,Or=cr.firstChild,gn=Or.firstChild,Vr=Or.nextSibling,li=cr.nextSibling,Di=li.firstChild,Ps=Di.firstChild,bo=Di.nextSibling,_o=Yt.nextSibling,Ni=_o.firstChild,Ln=Ni.firstChild,ws=Ln.firstChild,So=Ln.nextSibling;return He.addEventListener("mouseleave",gt=>{gt.currentTarget.style.transform="translateY(0)",gt.currentTarget.style.boxShadow="none"}),He.addEventListener("mouseenter",gt=>{gt.currentTarget.style.transform="translateY(-2px)",gt.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),He.$$click=()=>ve(Me),u(nt,N),Ke.style.setProperty("display","flex"),Ke.style.setProperty("align-items","center"),Ke.style.setProperty("gap","0.5rem"),Ke.style.setProperty("margin-bottom","0.5rem"),et.style.setProperty("font-size","1.2rem"),s(et,()=>le(Me.movementType)),st.style.setProperty("margin","0"),st.style.setProperty("font-size","1.1rem"),s(st,()=>Me.productName),s(St,()=>Me.movementType),s(Ke,(()=>{var gt=fe(()=>!!Me.invoiceId);return()=>gt()&&(()=>{var Ft=_A();return Ft.style.setProperty("padding","0.2rem 0.5rem"),Ft.style.setProperty("border-radius","var(--border-radius-sm)"),Ft.style.setProperty("font-size","0.7rem"),Ft.style.setProperty("font-weight","500"),Ft.style.setProperty("background","var(--primary-color)"),Ft.style.setProperty("color","white"),s(Ft,()=>e("inventory.bulk")),Ft})()})(),null),yt.style.setProperty("font-size","0.875rem"),yt.style.setProperty("color","var(--text-muted)"),s(yt,()=>Me.productSku,Xt),s(yt,()=>F(Me.createdDate),null),s(yt,(()=>{var gt=fe(()=>!!Me.invoiceId);return()=>gt()&&(()=>{var Ft=SA(),vr=Ft.firstChild,Hr=vr.nextSibling;return Hr.nextSibling,Ft.style.setProperty("margin-left","0.5rem"),Ft.style.setProperty("font-weight","500"),s(Ft,()=>e("common.invoice"),Hr),s(Ft,()=>Me.invoiceId,null),Ft})()})(),null),Nt.style.setProperty("text-align","right"),or.style.setProperty("font-size","1.25rem"),or.style.setProperty("font-weight","700"),or.style.setProperty("color","var(--primary-color)"),s(or,()=>O(Me.totalCost)),pr.style.setProperty("font-size","0.875rem"),pr.style.setProperty("color","var(--text-muted)"),s(pr,()=>Me.quantity,Bt),s(pr,()=>e("common.units"),Zt),s(pr,()=>O(Me.unitCost),null),u(Gr,J),s(Or,()=>e("inventory.location"),gn),s(Vr,()=>Me.locationName),s(Yt,(()=>{var gt=fe(()=>!!Me.fromLocationName);return()=>gt()&&(()=>{var Ft=Zh(),vr=Ft.firstChild,Hr=vr.firstChild,pn=vr.nextSibling;return s(vr,()=>e("common.from"),Hr),s(pn,()=>Me.fromLocationName),re(Gt=>{var Er=w,Zr=V,en=X;return Gt.e=u(Ft,Er,Gt.e),Gt.t=u(vr,Zr,Gt.t),Gt.a=u(pn,en,Gt.a),Gt},{e:void 0,t:void 0,a:void 0}),Ft})()})(),li),s(Di,()=>e("common.reference"),Ps),s(bo,()=>Me.referenceNumber),s(Ln,()=>e("common.createdBy"),ws),s(So,()=>Me.createdBy),s(_o,(()=>{var gt=fe(()=>!!Me.notes);return()=>gt()&&(()=>{var Ft=Zh(),vr=Ft.firstChild,Hr=vr.firstChild,pn=vr.nextSibling;return s(vr,()=>e("common.notes"),Hr),s(pn,()=>Me.notes),re(Gt=>{var Er={...w,"border-bottom":"none"},Zr=V,en={...X,"max-width":"200px","text-align":"right","font-style":"italic"};return Gt.e=u(Ft,Er,Gt.e),Gt.t=u(vr,Zr,Gt.t),Gt.a=u(pn,en,Gt.a),Gt},{e:void 0,t:void 0,a:void 0}),Ft})()})(),null),re(gt=>{var Ft={...I,"border-left":Me.invoiceId?"4px solid var(--primary-color)":"1px solid var(--border-color)",cursor:"pointer"},vr=j(Me.movementType),Hr=w,pn=V,Gt=X,Er=w,Zr=V,en=X,Cs=w,Ut=V,Li=X;return gt.e=u(He,Ft,gt.e),gt.t=u(St,vr,gt.t),gt.a=u(cr,Hr,gt.a),gt.o=u(Or,pn,gt.o),gt.i=u(Vr,Gt,gt.i),gt.n=u(li,Er,gt.n),gt.s=u(Di,Zr,gt.s),gt.h=u(bo,en,gt.h),gt.r=u(Ni,Cs,gt.r),gt.d=u(Ln,Ut,gt.d),gt.l=u(So,Li,gt.l),gt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),He})()}),fe(()=>fe(()=>C()>1)()&&(()=>{var Me=PA(),He=Me.firstChild,nt=He.firstChild,mt=nt.firstChild,Ke=nt.nextSibling,et=Ke.nextSibling,st=He.nextSibling,St=st.firstChild,yt=St.firstChild,Xt=yt.firstChild,Nt=yt.nextSibling,or=Nt.nextSibling,pr=or.firstChild;return u(Me,Y),He.style.setProperty("display","flex"),He.style.setProperty("align-items","center"),He.style.setProperty("gap","0.5rem"),nt.style.setProperty("font-size","0.875rem"),nt.style.setProperty("color","var(--text-muted)"),s(nt,()=>e("common.showPerPage","Show per page"),mt),Ke.addEventListener("change",Bt=>{R(Number(Bt.target.value)),L(1)}),Ke.style.setProperty("padding","0.25rem 0.5rem"),Ke.style.setProperty("border","1px solid var(--border-color)"),Ke.style.setProperty("border-radius","var(--border-radius-sm)"),Ke.style.setProperty("background","var(--surface-color)"),Ke.style.setProperty("cursor","pointer"),Ke.style.setProperty("font-size","0.875rem"),et.style.setProperty("font-size","0.875rem"),et.style.setProperty("color","var(--text-muted)"),et.style.setProperty("margin-left","1rem"),s(et,()=>e("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:(M()-1)*k()+1,end:Math.min(M()*k(),S().length),total:S().length})),st.style.setProperty("display","flex"),st.style.setProperty("align-items","center"),st.style.setProperty("gap","0.5rem"),s(st,b(Le,{variant:"outline",size:"sm",onClick:()=>L(1),get disabled(){return M()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.first","First")}}),St),s(st,b(Le,{variant:"outline",size:"sm",onClick:()=>L(Bt=>Math.max(1,Bt-1)),get disabled(){return M()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.previous")}}),St),s(st,()=>{const Bt=[],Zt=C(),Gr=M();if(Zt<=7)for(let Yt=1;Yt<=Zt;Yt++)Bt.push(Yt);else{Bt.push(1),Gr>3&&Bt.push("...");for(let Yt=Math.max(2,Gr-1);Yt<=Math.min(Zt-1,Gr+1);Yt++)Bt.includes(Yt)||Bt.push(Yt);Gr<Zt-2&&Bt.push("..."),Bt.includes(Zt)||Bt.push(Zt)}return b(pt,{each:Bt,children:Yt=>Yt==="..."?(()=>{var cr=wA();return cr.style.setProperty("padding","0 0.5rem"),cr.style.setProperty("color","var(--text-muted)"),cr})():(()=>{var cr=CA();return cr.$$click=()=>L(Yt),s(cr,Yt),re(Or=>u(cr,se(Yt===M()),Or)),cr})()})},St),s(st,b(Le,{variant:"outline",size:"sm",onClick:()=>L(Bt=>Math.min(C(),Bt+1)),get disabled(){return M()===C()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.next")}}),St),s(st,b(Le,{variant:"outline",size:"sm",onClick:()=>L(C()),get disabled(){return M()===C()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.last","Last")}}),St),St.style.setProperty("display","flex"),St.style.setProperty("align-items","center"),St.style.setProperty("gap","0.5rem"),St.style.setProperty("margin-left","1rem"),yt.style.setProperty("font-size","0.875rem"),yt.style.setProperty("color","var(--text-muted)"),s(yt,()=>e("common.page","Page"),Xt),Nt.addEventListener("change",Bt=>{const Zt=Number(Bt.target.value);Zt>=1&&Zt<=C()&&L(Zt)}),Nt.style.setProperty("width","4rem"),Nt.style.setProperty("padding","0.25rem 0.5rem"),Nt.style.setProperty("border","1px solid var(--border-color)"),Nt.style.setProperty("border-radius","var(--border-radius-sm)"),Nt.style.setProperty("background","var(--surface-color)"),Nt.style.setProperty("text-align","center"),Nt.style.setProperty("font-size","0.875rem"),or.style.setProperty("font-size","0.875rem"),or.style.setProperty("color","var(--text-muted)"),s(or,()=>e("common.of","of"),pr),s(or,C,null),re(()=>ct(Nt,"max",C())),re(()=>Ke.value=k()),re(()=>Nt.value=M()),Me})())]})(),null),s(Q,b(cA,{get isOpen(){return te()},onClose:()=>{ye(!1),ie(null)},get movement(){return W()},onEdit:ce}),null),s(Q,b(Ne,{get when(){return vt.hasPermission("read_write")},get children(){return b(mA,{get isOpen(){return ae()},onClose:()=>{$(!1),ie(null)},get movement(){return W()},onMovementUpdated:H})}}),null),re(Oe=>{var Me=oe,He=K,nt=K,mt=U,Ke=B,et=x,st=U,St={...B,color:"#2d7d32"},yt=x,Xt=U,Nt={...B,color:"#d32f2f"},or=x,pr=U,Bt={...B,color:"#1976d2"},Zt=x,Gr=U,Yt={...B,color:"#f57c00"},cr=x,Or=U,gn=B,Vr=x;return Oe.e=u(ne,Me,Oe.e),Oe.t=u(xe,He,Oe.t),Oe.a=u(Qe,nt,Oe.a),Oe.o=u(Te,mt,Oe.o),Oe.i=u(Fe,Ke,Oe.i),Oe.n=u(Je,et,Oe.n),Oe.s=u(Ge,st,Oe.s),Oe.h=u(Xe,St,Oe.h),Oe.r=u(Ae,yt,Oe.r),Oe.d=u(Ie,Xt,Oe.d),Oe.l=u(Ze,Nt,Oe.l),Oe.u=u(dt,or,Oe.u),Oe.c=u(ft,pr,Oe.c),Oe.w=u(Tt,Bt,Oe.w),Oe.m=u(_t,Zt,Oe.m),Oe.f=u(Et,Gr,Oe.f),Oe.y=u(Mt,Yt,Oe.y),Oe.g=u(it,cr,Oe.g),Oe.p=u(Vt,Or,Oe.p),Oe.b=u(It,gn,Oe.b),Oe.T=u(je,Vr,Oe.T),Oe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),re(()=>ne.value=a()),re(()=>xe.value=d().start),re(()=>Qe.value=d().end),Q})()};At(["click"]);var IA=z("<div><p> "),EA=z("<div>"),xA=z("<div><div></div><h3></h3><p></p><div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=name></option><option value=sku></option><option value=category>"),TA=z("<div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div>%</div><div></div></div></div><div></div><div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),$A=z("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),kA=z("<div><div></div><h3></h3><p>"),RA=z("<div><div><h3> </h3><p></p></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div></div><div>"),DA=z("<div><div><div><h2> </h2><button>"),em=z("<option>"),NA=z("<div>..."),LA=z("<tr><td><div></div><div>  </div></td><td><div></div></td><td><div></div></td><td><div></div></td><td><div>"),MA=z("<tr><td><div></div></td><td><div></div><div>  <!>  </div></td><td><div></div></td><td><input type=number placeholder=0 min=0 step=0.01></td><td><div></div></td><td><input type=text>");const OA=t=>{const{t:e}=lt(),[r,n]=ge([]),[i,o]=ge(!1),[a,c]=ge(!1),[d,h]=ge("all"),[m,g]=ge("all"),[_,A]=ge("name"),[M,L]=ge([]),[k,R]=ge("setup"),W=async()=>{try{o(!0);const x=await an.getProducts("prod");if(!x||typeof x!="object"){console.warn("No API results, using local store"),n(De.products);return}const I=Object.keys(x),N=j=>{let w=x[j];return{id:j,name:w.name||"Unknown Product",businessId:w.businessId||"",sku:w.code||w.sku||"",UPC:w.UPC||"",numCode:w.codeN||"",category:w.category||"General",unitCost:w.unitCost||0,unitOfMeasure:w.unitOfMeasure||"pcs",minStockLevel:w.minStockLevel||0,maxStockLevel:w.maxStockLevel||100,isActive:w.isActive!==!1,description:w.description||"",createdDate:w.createdAt||new Date().toISOString(),lastModified:w.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(w.sellingPrice||w.price||"0")}},Z=I.map(N);n(Z)}catch(x){console.error("Failed to load products from API:",x),n(De.products)}finally{o(!1)}},ie=We(()=>[...new Set(r().map(I=>I.category).filter(I=>I))].sort()),te=We(()=>{let x=r().filter(I=>I.isActive);return m()!=="all"&&(x=x.filter(I=>I.category===m())),x.sort((I,N)=>{switch(_()){case"name":return I.name.localeCompare(N.name);case"sku":return I.sku.localeCompare(N.sku);case"category":return I.category.localeCompare(N.category)||I.name.localeCompare(N.name);default:return 0}}),x}),ye=We(()=>De.getActiveLocations()),ae=(x,I)=>I&&I!=="all"?De.getStockByProductAndLocation(x,I)?.quantity||0:De.getTotalStockByProduct(x),$=()=>{const x=te().map(I=>{const N=ae(I.id,d()!=="all"?d():void 0);return{productId:I.id,systemQuantity:N,physicalCount:null,notes:"",variance:0,product:I}});L(x),R("counting")},S=(x,I)=>{L(N=>N.map(Z=>{if(Z.productId===x){const j=I,J=j!==null?j-Z.systemQuantity:0;return{...Z,physicalCount:j,variance:J}}return Z}))},p=(x,I)=>{L(N=>N.map(Z=>Z.productId===x?{...Z,notes:I}:Z))},C=We(()=>{const x=M(),I=x.length,N=x.filter(w=>w.physicalCount!==null).length,Z=x.filter(w=>w.variance!==0).length,j=x.filter(w=>w.variance>0).length,J=x.filter(w=>w.variance<0).length;return{totalProducts:I,countedProducts:N,remainingProducts:I-N,variances:Z,positiveVariances:j,negativeVariances:J,isComplete:N===I}}),P=()=>{const x=M().filter(j=>j.physicalCount!==null&&j.variance!==0);if(x.length===0)return null;const I=[e("inventory.product","Product"),e("inventory.sku","SKU"),e("inventory.category","Category"),e("inventory.location","Location"),e("inventory.systemQty","System Qty"),e("inventory.physicalCount","Physical Count"),e("inventory.variance","Variance"),e("inventory.adjustment","Adjustment"),e("common.notes","Notes"),e("common.date","Date")],N=x.map(j=>[`"${j.product.name}"`,`"${j.product.sku}"`,`"${j.product.category}"`,`"${oe()}"`,j.systemQuantity,j.physicalCount,j.variance,j.variance>0?e("inventory.stockIncrease","Stock Increase"):e("inventory.stockDecrease","Stock Decrease"),`"${j.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")}"`,`"${K()}"`]);return[I.join(","),...N.map(j=>j.join(","))].join(`
`)},E=()=>{const x=P();if(!x){alert(e("inventory.noAdjustmentsToDownload","No adjustments to download"));return}const I=new Blob([x],{type:"text/csv;charset=utf-8;"}),N=document.createElement("a");if(N.download!==void 0){const Z=URL.createObjectURL(I);N.setAttribute("href",Z),N.setAttribute("download",`inventory-adjustments-${K().replace(/[/:,\s]/g,"-")}.csv`),N.style.visibility="hidden",document.body.appendChild(N),N.click(),document.body.removeChild(N)}},y=async(x=!0)=>{try{c(!0),console.log(M());const I=V=>{let X=De.getProductById(V.productId),Y=De.getStockByProductAndLocation(V.productId,d()),se=parseFloat(Y?.averageCost+""),O=parseFloat(Y?.quantity+"");return{product:{id:V.productId,label:X?.name,code:X?.code},productId:V?.productId,reason:"Physical Count Adjustment",notes:V?.notes||"Physical inventory adjustment",quantity:V?.variance,unitCost:se}},N=M().filter(V=>V.physicalCount!==null&&V.variance!==0).map(I);let Z="ADJ_"+Xs();const j=new Date().toISOString(),J={ssg_inventory_key:Xs(),invoiceId:Z,referenceNumber:Xs(),movementType:"adjustment",type:"adjustment",locationId:d(),items:N,products:N,generalNotes:"Physical inventory adjustment",description:"Physical Count Adjustment",invoice:Z,store:d(),createdBy:"admin",createDate:j};console.log("Saving inventory bulkRequest:",J);const w=await an.addInventory(J);x&&N.length>0&&E(),console.log("Saving inventory adjustments:",N),await new Promise(V=>setTimeout(V,1e3)),t.onClose()}catch(I){console.error("Failed to save inventory adjustments:",I)}finally{c(!1)}},oe=We(()=>d()==="all"?"All Locations":ye().find(I=>I.id===d())?.name||"Unknown Location"),K=()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),T=async()=>{await De.fecthInventory("prod"),await W()};qr(async()=>{t.selectedLocationId&&h(t.selectedLocationId),T()});const U=()=>{const x=window.open("","_blank");if(!x){alert("Please allow pop-ups to print the counting sheet");return}const I=B();x.document.write(I),x.document.close(),x.onload=()=>{x.print(),x.onafterprint=()=>{x.close()}}},B=()=>{const x=te().map((I,N)=>{const Z=ae(I.id,d()!=="all"?d():void 0);return`
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${N+1}</td>
          <td style="border: 1px solid #000; padding: 8px; font-family: monospace;">${I.sku}</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 500;">${I.name}</div>
            ${I.UPC?`<div style="font-size: 0.8em; color: #666;">UPC: ${I.UPC}</div>`:""}
          </td>
          <td style="border: 1px solid #000; padding: 8px;">${I.category}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${I.unitOfMeasure}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">${Z}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; background-color: #f9f9f9;">________</td>
          <td style="border: 1px solid #000; padding: 8px;">_______________</td>
        </tr>
      `}).join("");return`
      <!DOCTYPE html>
      <html>
      <head>
        <title> ${oe()}_${m()}_${e("inventory.countingSheet","Inventory Counting Sheet")} - ${K()}</title>
        <style>
          @page {
            size: letter;
            margin: 0.5in;
          }
          body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            margin: 0;
            padding: 0;
          }
          h1 {
            text-align: center;
            margin: 0 0 10px 0;
            font-size: 24px;
          }
          .header-info {
            text-align: center;
            margin-bottom: 20px;
          }
          .instructions {
            background-color: #f0f0f0;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
          }
          th {
            background-color: #333;
            color: white;
            padding: 8px;
            text-align: left;
            font-weight: bold;
            border: 1px solid #000;
          }
          .summary-table {
            width: 50%;
            margin: 20px auto;
          }
          .signature-section {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
          }
          .signature-box {
            width: 45%;
            text-align: center;
          }
          .signature-line {
            border-bottom: 1px solid #000;
            margin-bottom: 5px;
            height: 30px;
          }
          @media print {
            tr { page-break-inside: avoid; }
          }
        </style>
      </head>
      <body>
        <h1>${e("inventory.inventoryCountingSheetTitle","INVENTORY COUNTING SHEET")}</h1>
        <div class="header-info">
          <p><strong>${e("inventory.location","Location")}:</strong> ${oe()}</p>
          <p><strong>${e("common.category","Category")}:</strong> ${m()==="all"?e("inventory.allCategories","All Categories"):m()}</p>
          <p><strong>${e("common.date","Date")}:</strong> ${K()}</p>
          <p style="margin-top: 10px;">
            <span style="margin-right: 30px;">${e("inventory.countedBy","Counted by")}: _________________________</span>
            <span>${e("inventory.verifiedBy","Verified by")}: _________________________</span>
          </p>
        </div>

        <table>
          <thead>
            <tr>
              <th style="width: 5%; text-align: center;">#</th>
              <th style="width: 12%;">${e("inventory.sku","SKU")}</th>
              <th style="width: 25%;">${e("inventory.productName","Product Name")}</th>
              <th style="width: 12%;">${e("common.category","Category")}</th>
              <th style="width: 8%; text-align: center;">${e("inventory.unit","Unit")}</th>
              <th style="width: 10%; text-align: center;">${e("inventory.systemQty","System Qty")}</th>
              <th style="width: 12%; text-align: center; background-color: #f0f0f0;">${e("inventory.physicalCount","Physical Count")}</th>
              <th style="width: 16%;">${e("common.notes","Notes")}</th>
            </tr>
          </thead>
          <tbody>
            ${x}
          </tbody>
        </table>
        
        <table class="summary-table">
          <tr>
            <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
              ${e("inventory.totalProductsListed","Total Products Listed")}:
            </td>
            <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">
              ${te().length}
            </td>
          </tr>
          <tr>
            <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
              ${e("inventory.itemsCounted","Items Counted")}:
            </td>
            <td style="border: 1px solid #000; padding: 8px; text-align: center;">
              ___________
            </td>
          </tr>
          <tr>
            <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
              ${e("inventory.discrepanciesFound","Discrepancies Found")}:
            </td>
            <td style="border: 1px solid #000; padding: 8px; text-align: center;">
              ___________
            </td>
          </tr>
        </table>
        
        <div class="signature-section">
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.counterSignature","Counter Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.supervisorSignature","Supervisor Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
        </div>
      </body>
      </html>
    `};return b(Ne,{get when(){return t.isOpen},get children(){var x=DA(),I=x.firstChild,N=I.firstChild,Z=N.firstChild;Z.firstChild;var j=Z.nextSibling;return x.style.setProperty("position","fixed"),x.style.setProperty("top","0"),x.style.setProperty("left","0"),x.style.setProperty("right","0"),x.style.setProperty("bottom","0"),x.style.setProperty("background","rgba(0, 0, 0, 0.5)"),x.style.setProperty("z-index","1000"),x.style.setProperty("display","flex"),x.style.setProperty("align-items","center"),x.style.setProperty("justify-content","center"),I.style.setProperty("background","white"),I.style.setProperty("border-radius","var(--border-radius)"),I.style.setProperty("padding","2rem"),I.style.setProperty("width","95%"),I.style.setProperty("height","95%"),I.style.setProperty("max-width","1400px"),I.style.setProperty("overflow-y","auto"),I.style.setProperty("position","relative"),N.style.setProperty("display","flex"),N.style.setProperty("justify-content","space-between"),N.style.setProperty("align-items","center"),N.style.setProperty("margin-bottom","2rem"),N.style.setProperty("border-bottom","1px solid var(--border-color)"),N.style.setProperty("padding-bottom","1rem"),Z.style.setProperty("margin","0"),Z.style.setProperty("font-size","1.5rem"),s(Z,()=>e("inventory.physicalInventoryCount","Physical Inventory Count"),null),xi(j,"click",t.onClose,!0),j.style.setProperty("background","none"),j.style.setProperty("border","none"),j.style.setProperty("font-size","1.5rem"),j.style.setProperty("cursor","pointer"),j.style.setProperty("padding","0.5rem"),s(I,b(Ne,{get when(){return k()==="setup"},get children(){var J=xA(),w=J.firstChild,V=w.nextSibling,X=V.nextSibling,Y=X.nextSibling,se=Y.firstChild,O=se.firstChild,F=O.firstChild,le=O.nextSibling,pe=le.firstChild,ve=se.nextSibling,ce=ve.firstChild,H=ce.firstChild,D=ce.nextSibling,Q=D.firstChild,G=ve.nextSibling,he=G.firstChild,me=he.firstChild,ee=he.nextSibling,ne=ee.firstChild,Se=ne.nextSibling,we=Se.nextSibling;return J.style.setProperty("text-align","center"),J.style.setProperty("padding","2rem"),J.style.setProperty("max-width","600px"),J.style.setProperty("margin","0 auto"),w.style.setProperty("font-size","3rem"),w.style.setProperty("margin-bottom","1rem"),V.style.setProperty("margin-bottom","1rem"),s(V,()=>e("inventory.setupPhysicalCount","Setup Physical Inventory Count")),X.style.setProperty("margin-bottom","2rem"),X.style.setProperty("color","var(--text-muted)"),s(X,()=>e("inventory.setupDescription","Configure your physical inventory count settings and begin the counting process.")),Y.style.setProperty("display","grid"),Y.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),Y.style.setProperty("gap","1rem"),Y.style.setProperty("margin-bottom","2rem"),Y.style.setProperty("padding","1rem"),Y.style.setProperty("background","var(--surface-color)"),Y.style.setProperty("border-radius","var(--border-radius)"),Y.style.setProperty("text-align","left"),O.style.setProperty("display","block"),O.style.setProperty("margin-bottom","0.5rem"),O.style.setProperty("font-weight","500"),s(O,()=>e("inventory.location","Location"),F),le.addEventListener("change",ue=>h(ue.target.value)),le.style.setProperty("width","100%"),le.style.setProperty("padding","0.5rem"),le.style.setProperty("border","1px solid var(--border-color)"),le.style.setProperty("border-radius","var(--border-radius-sm)"),s(pe,()=>e("inventory.allLocations","All Locations")),s(le,b(pt,{get each(){return ye()},children:ue=>(()=>{var be=em();return s(be,()=>ue.name),re(()=>be.value=ue.id),be})()}),null),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),s(ce,()=>e("inventory.category","Category"),H),D.addEventListener("change",ue=>g(ue.target.value)),D.style.setProperty("width","100%"),D.style.setProperty("padding","0.5rem"),D.style.setProperty("border","1px solid var(--border-color)"),D.style.setProperty("border-radius","var(--border-radius-sm)"),s(Q,()=>e("products.allCategories","All Categories")),s(D,b(pt,{get each(){return ie()},children:ue=>(()=>{var be=em();return be.value=ue,s(be,ue),be})()}),null),he.style.setProperty("display","block"),he.style.setProperty("margin-bottom","0.5rem"),he.style.setProperty("font-weight","500"),s(he,()=>e("inventory.sortBy","Sort By"),me),ee.addEventListener("change",ue=>A(ue.target.value)),ee.style.setProperty("width","100%"),ee.style.setProperty("padding","0.5rem"),ee.style.setProperty("border","1px solid var(--border-color)"),ee.style.setProperty("border-radius","var(--border-radius-sm)"),s(ne,()=>e("inventory.productName","Product Name")),s(Se,()=>e("inventory.sku","SKU")),s(we,()=>e("inventory.category","Category")),s(J,b(Ne,{get when(){return!i()},get fallback(){return(()=>{var ue=NA(),be=ue.firstChild;return ue.style.setProperty("padding","2rem"),s(ue,()=>e("common.loading","Loading"),be),ue})()},get children(){return[(()=>{var ue=IA(),be=ue.firstChild;return be.firstChild,ue.style.setProperty("padding","1rem"),ue.style.setProperty("background","#fff3cd"),ue.style.setProperty("border-radius","var(--border-radius-sm)"),ue.style.setProperty("margin-bottom","2rem"),be.style.setProperty("margin","0"),be.style.setProperty("color","#856404"),s(be,()=>e("inventory.countWillInclude","This count will include {{count}} products from {{location}} in {{category}} category.",{count:te().length,location:oe(),category:m()==="all"?e("inventory.allCategories","all categories"):m()}),null),ue})(),b(Ne,{get when(){return fe(()=>m()!=="all")()&&d()!=="all"},get children(){var ue=EA();return ue.style.setProperty("display","grid"),ue.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),ue.style.setProperty("gap","1rem"),ue.style.setProperty("margin-bottom","2rem"),ue.style.setProperty("padding","1rem"),ue.style.setProperty("background","var(--surface-color)"),ue.style.setProperty("border-radius","var(--border-radius)"),s(ue,b(Ne,{get when(){return vt.hasPermission("physicalInventoryCountingForm")},get children(){return b(Le,{variant:"primary",size:"large",onClick:$,get disabled(){return i()||te().length===0},get children(){return[" ",fe(()=>e("inventory.startCounting","Start Physical Count"))]}})}}),null),s(ue,b(Le,{variant:"primary",onClick:U,get disabled(){return i()},get children(){return[" ",fe(()=>e("common.print","Print"))]}}),null),ue}})]}}),null),re(()=>le.value=d()),re(()=>D.value=m()),re(()=>ee.value=_()),J}}),null),s(I,b(Ne,{get when(){return k()==="counting"},get children(){var J=TA(),w=J.firstChild,V=w.firstChild,X=V.firstChild,Y=X.nextSibling,se=V.nextSibling,O=se.firstChild,F=O.nextSibling,le=se.nextSibling,pe=le.firstChild,ve=pe.nextSibling,ce=le.nextSibling,H=ce.firstChild,D=H.firstChild,Q=H.nextSibling,G=w.nextSibling,he=G.nextSibling,me=he.firstChild,ee=me.firstChild,ne=ee.firstChild,Se=ne.firstChild,we=Se.nextSibling,ue=we.nextSibling,be=ue.nextSibling,de=be.nextSibling,Pe=de.nextSibling,$e=ee.nextSibling;return w.style.setProperty("display","grid"),w.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),w.style.setProperty("gap","1rem"),w.style.setProperty("margin-bottom","2rem"),w.style.setProperty("padding","1rem"),w.style.setProperty("background","var(--surface-color)"),w.style.setProperty("border-radius","var(--border-radius)"),V.style.setProperty("text-align","center"),X.style.setProperty("font-size","1.5rem"),X.style.setProperty("font-weight","700"),X.style.setProperty("color","var(--primary-color)"),s(X,()=>C().countedProducts),Y.style.setProperty("font-size","0.875rem"),Y.style.setProperty("color","var(--text-muted)"),s(Y,()=>e("inventory.counted","Counted")),se.style.setProperty("text-align","center"),O.style.setProperty("font-size","1.5rem"),O.style.setProperty("font-weight","700"),O.style.setProperty("color","#ff9800"),s(O,()=>C().remainingProducts),F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),s(F,()=>e("inventory.remaining","Remaining")),le.style.setProperty("text-align","center"),pe.style.setProperty("font-size","1.5rem"),pe.style.setProperty("font-weight","700"),pe.style.setProperty("color","#f44336"),s(pe,()=>C().variances),ve.style.setProperty("font-size","0.875rem"),ve.style.setProperty("color","var(--text-muted)"),s(ve,()=>e("inventory.variances","Variances")),ce.style.setProperty("text-align","center"),H.style.setProperty("font-size","1.5rem"),H.style.setProperty("font-weight","700"),s(H,()=>Math.round(C().countedProducts/C().totalProducts*100),D),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),s(Q,()=>e("inventory.complete","Complete")),G.style.setProperty("display","flex"),G.style.setProperty("gap","1rem"),G.style.setProperty("margin-bottom","2rem"),G.style.setProperty("justify-content","center"),s(G,b(Le,{variant:"outline",onClick:()=>R("setup"),get children(){return[" ",fe(()=>e("common.back","Back to Setup"))]}}),null),s(G,b(Le,{variant:"primary",onClick:()=>R("review"),get children(){return[" ",fe(()=>e("inventory.reviewAdjustments","Review Adjustments"))]}}),null),he.style.setProperty("border","1px solid var(--border-color)"),he.style.setProperty("border-radius","var(--border-radius)"),he.style.setProperty("overflow-x","auto"),me.style.setProperty("width","100%"),me.style.setProperty("border-collapse","collapse"),ne.style.setProperty("background","var(--surface-color)"),Se.style.setProperty("padding","1rem"),Se.style.setProperty("text-align","left"),Se.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Se,()=>e("inventory.no","No")),we.style.setProperty("padding","1rem"),we.style.setProperty("text-align","left"),we.style.setProperty("border-bottom","1px solid var(--border-color)"),s(we,()=>e("inventory.product","Product")),ue.style.setProperty("padding","1rem"),ue.style.setProperty("text-align","center"),ue.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ue,()=>e("inventory.systemQty","System Qty")),be.style.setProperty("padding","1rem"),be.style.setProperty("text-align","center"),be.style.setProperty("border-bottom","1px solid var(--border-color)"),s(be,()=>e("inventory.physicalCount","Physical Count")),de.style.setProperty("padding","1rem"),de.style.setProperty("text-align","center"),de.style.setProperty("border-bottom","1px solid var(--border-color)"),s(de,()=>e("inventory.variance","Variance")),Pe.style.setProperty("padding","1rem"),Pe.style.setProperty("text-align","left"),Pe.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Pe,()=>e("common.notes","Notes")),s($e,b(pt,{get each(){return M()},children:(xe,ke)=>b(VA,{get index(){return ke()},updatePhysicalCount:S,entry:xe,updateNotes:p})})),re(xe=>(xe=C().isComplete?"#4caf50":"#ff9800")!=null?H.style.setProperty("color",xe):H.style.removeProperty("color")),J}}),null),s(I,b(Ne,{get when(){return k()==="review"},get children(){var J=RA(),w=J.firstChild,V=w.firstChild;V.firstChild;var X=V.nextSibling,Y=w.nextSibling,se=Y.firstChild,O=se.firstChild,F=O.nextSibling,le=se.nextSibling,pe=le.firstChild,ve=pe.nextSibling,ce=le.nextSibling,H=ce.firstChild,D=H.nextSibling,Q=Y.nextSibling;return w.style.setProperty("text-align","center"),w.style.setProperty("margin-bottom","2rem"),V.style.setProperty("margin-bottom","1rem"),s(V,()=>e("inventory.reviewAndConfirm","Review and Confirm Adjustments"),null),X.style.setProperty("color","var(--text-muted)"),s(X,()=>e("inventory.reviewDescription","Review the inventory adjustments below and confirm to update your system.")),Y.style.setProperty("display","grid"),Y.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),Y.style.setProperty("gap","1rem"),Y.style.setProperty("margin-bottom","2rem"),Y.style.setProperty("padding","1rem"),Y.style.setProperty("background","var(--surface-color)"),Y.style.setProperty("border-radius","var(--border-radius)"),se.style.setProperty("text-align","center"),O.style.setProperty("font-size","1.5rem"),O.style.setProperty("font-weight","700"),O.style.setProperty("color","#4caf50"),s(O,()=>C().positiveVariances),F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),s(F,()=>e("inventory.stockIncreases","Stock Increases")),le.style.setProperty("text-align","center"),pe.style.setProperty("font-size","1.5rem"),pe.style.setProperty("font-weight","700"),pe.style.setProperty("color","#f44336"),s(pe,()=>C().negativeVariances),ve.style.setProperty("font-size","0.875rem"),ve.style.setProperty("color","var(--text-muted)"),s(ve,()=>e("inventory.stockDecreases","Stock Decreases")),ce.style.setProperty("text-align","center"),H.style.setProperty("font-size","1.5rem"),H.style.setProperty("font-weight","700"),H.style.setProperty("color","var(--primary-color)"),s(H,()=>C().variances),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("color","var(--text-muted)"),s(D,()=>e("inventory.totalAdjustments","Total Adjustments")),Q.style.setProperty("display","flex"),Q.style.setProperty("gap","1rem"),Q.style.setProperty("margin-bottom","2rem"),Q.style.setProperty("justify-content","center"),Q.style.setProperty("flex-wrap","wrap"),s(Q,b(Le,{variant:"outline",onClick:()=>R("counting"),get children(){return[" ",fe(()=>e("common.back","Back to Counting"))]}}),null),s(Q,b(Le,{variant:"outline",onClick:E,get disabled(){return C().variances===0},get children(){return[" ",fe(()=>e("inventory.downloadCSV","Download CSV"))]}}),null),s(Q,b(Le,{variant:"primary",onClick:y,get disabled(){return a()||C().variances===0},get children(){return fe(()=>!!a())()?" "+e("common.saving","Saving")+"...":" "+e("inventory.confirmAdjustments","Confirm Adjustments")}}),null),s(J,b(Ne,{get when(){return C().variances>0},get children(){var G=$A(),he=G.firstChild,me=he.firstChild,ee=me.firstChild,ne=ee.firstChild,Se=ne.nextSibling,we=Se.nextSibling,ue=we.nextSibling,be=ue.nextSibling,de=me.nextSibling;return G.style.setProperty("border","1px solid var(--border-color)"),G.style.setProperty("border-radius","var(--border-radius)"),G.style.setProperty("overflow-x","auto"),he.style.setProperty("width","100%"),he.style.setProperty("border-collapse","collapse"),ee.style.setProperty("background","var(--surface-color)"),ne.style.setProperty("padding","1rem"),ne.style.setProperty("text-align","left"),ne.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ne,()=>e("inventory.product","Product")),Se.style.setProperty("padding","1rem"),Se.style.setProperty("text-align","center"),Se.style.setProperty("border-bottom","1px solid var(--border-color)"),s(Se,()=>e("inventory.systemQty","System Qty")),we.style.setProperty("padding","1rem"),we.style.setProperty("text-align","center"),we.style.setProperty("border-bottom","1px solid var(--border-color)"),s(we,()=>e("inventory.physicalCount","Physical Count")),ue.style.setProperty("padding","1rem"),ue.style.setProperty("text-align","center"),ue.style.setProperty("border-bottom","1px solid var(--border-color)"),s(ue,()=>e("inventory.adjustment","Adjustment")),be.style.setProperty("padding","1rem"),be.style.setProperty("text-align","left"),be.style.setProperty("border-bottom","1px solid var(--border-color)"),s(be,()=>e("common.notes","Notes")),s(de,b(pt,{get each(){return M().filter(Pe=>Pe.variance!==0)},children:Pe=>(()=>{var $e=LA(),xe=$e.firstChild,ke=xe.firstChild,Be=ke.nextSibling,Qe=Be.firstChild,Ue=xe.nextSibling,Te=Ue.firstChild,Fe=Ue.nextSibling,Je=Fe.firstChild,Ge=Fe.nextSibling,Xe=Ge.firstChild,Ae=Ge.nextSibling,Ie=Ae.firstChild;return $e.style.setProperty("border-bottom","1px solid var(--border-color)"),xe.style.setProperty("padding","1rem"),ke.style.setProperty("font-weight","500"),s(ke,()=>Pe.product.name),Be.style.setProperty("font-size","0.875rem"),Be.style.setProperty("color","var(--text-muted)"),s(Be,()=>Pe.product.sku,Qe),s(Be,()=>Pe.product.category,null),Ue.style.setProperty("padding","1rem"),Ue.style.setProperty("text-align","center"),Te.style.setProperty("font-weight","600"),s(Te,()=>Pe.systemQuantity),Fe.style.setProperty("padding","1rem"),Fe.style.setProperty("text-align","center"),Je.style.setProperty("font-weight","600"),s(Je,()=>Pe.physicalCount),Ge.style.setProperty("padding","1rem"),Ge.style.setProperty("text-align","center"),Xe.style.setProperty("font-weight","700"),s(Xe,()=>Pe.variance>0?"+":"",null),s(Xe,()=>Pe.variance,null),Ae.style.setProperty("padding","1rem"),Ie.style.setProperty("font-size","0.875rem"),s(Ie,()=>Pe.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")),re(Ze=>{var dt=Pe.variance>0?"#d4edda":"#f8d7da",ft=Pe.variance>0?"#4caf50":"#f44336";return dt!==Ze.e&&((Ze.e=dt)!=null?$e.style.setProperty("background",dt):$e.style.removeProperty("background")),ft!==Ze.t&&((Ze.t=ft)!=null?Xe.style.setProperty("color",ft):Xe.style.removeProperty("color")),Ze},{e:void 0,t:void 0}),$e})()})),G}}),null),s(J,b(Ne,{get when(){return C().variances===0},get children(){var G=kA(),he=G.firstChild,me=he.nextSibling,ee=me.nextSibling;return G.style.setProperty("text-align","center"),G.style.setProperty("padding","3rem"),G.style.setProperty("background","var(--surface-color)"),G.style.setProperty("border-radius","var(--border-radius)"),he.style.setProperty("font-size","3rem"),he.style.setProperty("margin-bottom","1rem"),me.style.setProperty("margin-bottom","0.5rem"),s(me,()=>e("inventory.perfectCount","Perfect Count!")),ee.style.setProperty("color","var(--text-muted)"),s(ee,()=>e("inventory.noVariances","No variances found. Your physical count matches the system exactly.")),G}}),null),J}}),null),x}})},VA=t=>{const{t:e}=lt(),[r,n]=ge(""),[i,o]=ge("");let{entry:a,updatePhysicalCount:c,updateNotes:d,index:h}=t;qr(()=>{o(a?.notes),n(a?.physicalCount)});const m=()=>{let g=document.getElementById(`physicalCountInput_${h+2}`);Xp(r())&&g&&(g.focus(),c(a?.productId,r()===""?null:parseFloat(r())))};return(()=>{var g=MA(),_=g.firstChild,A=_.firstChild,M=_.nextSibling,L=M.firstChild,k=L.nextSibling,R=k.firstChild,W=R.nextSibling;W.nextSibling;var ie=M.nextSibling,te=ie.firstChild,ye=ie.nextSibling,ae=ye.firstChild,$=ye.nextSibling,S=$.firstChild,p=$.nextSibling,C=p.firstChild;return g.style.setProperty("border-bottom","1px solid var(--border-color)"),_.style.setProperty("padding","1rem"),_.style.setProperty("text-align","center"),A.style.setProperty("font-weight","600"),s(A,h+1),M.style.setProperty("padding","1rem"),L.style.setProperty("font-weight","500"),s(L,()=>a?.product.name),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("color","var(--text-muted)"),s(k,()=>a?.product.sku,R),s(k,()=>a?.product.category,W),s(k,()=>a?.product.unitOfMeasure,null),ie.style.setProperty("padding","1rem"),ie.style.setProperty("text-align","center"),te.style.setProperty("font-weight","600"),s(te,()=>a?.systemQuantity),ye.style.setProperty("padding","1rem"),ye.style.setProperty("text-align","center"),ae.addEventListener("blur",()=>{m()}),ae.$$keydown=P=>{P.keyCode===13&&m(),P.keyCode===27&&m(),P.keyCode===9&&m()},ae.$$input=P=>{const E=P.target.value;n(E)},ct(ae,"id",`physicalCountInput_${h+1}`),ct(ae,"tabindex",h),ae.style.setProperty("width","100px"),ae.style.setProperty("padding","0.5rem"),ae.style.setProperty("border","1px solid var(--border-color)"),ae.style.setProperty("border-radius","var(--border-radius-sm)"),ae.style.setProperty("text-align","center"),$.style.setProperty("padding","1rem"),$.style.setProperty("text-align","center"),S.style.setProperty("font-weight","600"),s(S,()=>a?.variance>0?"+":"",null),s(S,()=>a?.variance||"",null),p.style.setProperty("padding","1rem"),C.addEventListener("blur",P=>{d(a?.productId,i())}),C.$$keydown=P=>{P.keyCode===13&&d(a?.productId,i()),P.keyCode===27&&d(a?.productId,i()),P.keyCode===9&&d(a?.productId,i())},C.$$input=P=>{const E=P.target.value;o(E)},C.style.setProperty("width","200px"),C.style.setProperty("padding","0.5rem"),C.style.setProperty("border","1px solid var(--border-color)"),C.style.setProperty("border-radius","var(--border-radius-sm)"),re(P=>{var E=a?.physicalCount!==null?a?.variance!==0?"#fff3cd":"#d4edda":"transparent",y=a?.variance>0?"#4caf50":a?.variance<0?"#f44336":"var(--text-muted)",oe=e("inventory.addNotes","Add notes...");return E!==P.e&&((P.e=E)!=null?g.style.setProperty("background",E):g.style.removeProperty("background")),y!==P.t&&((P.t=y)!=null?S.style.setProperty("color",y):S.style.removeProperty("color")),oe!==P.a&&ct(C,"placeholder",P.a=oe),P},{e:void 0,t:void 0,a:void 0}),re(()=>ae.value=r()||""),re(()=>C.value=i()||""),g})()};At(["click","input","keydown"]);function BA(t,e=300,r=!1){let n,i;const o=()=>{n!==void 0&&(clearTimeout(n),n=void 0),i=void 0},a=()=>{n!==void 0&&i!==void 0&&(clearTimeout(n),n=void 0,t(...i),i=void 0)},c=(...d)=>{i=d,n!==void 0&&clearTimeout(n),r&&n===void 0&&t(...d),n=window.setTimeout(()=>{r||t(...d),n=void 0,i=void 0},e)};return co(()=>{o()}),{debounced:c,cancel:o,flush:a}}function FA(t,e=300){const[r,n]=ge(!1);let i;const o=async h=>{if(i&&i.abort(),!h.trim()){n(!1);return}i=new AbortController,n(!0);try{await t(h)}catch(m){m instanceof Error&&m.name!=="AbortError"&&console.error("Search error:",m)}finally{i.signal.aborted||n(!1)}},{debounced:a,cancel:c}=BA(o,e,!1),d=()=>{c(),i&&i.abort(),n(!1)};return co(()=>{d()}),{search:a,isSearching:r,cancel:d}}var tm=z("<div>"),UA=z("<div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),jA=z("<div><h3></h3><div><div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><div><span></span><span></span></div><div><span></span><span>%"),zA=z("<div><h4>"),qA=z("<div><h3></h3><div><div><div><span></span><span> </span></div><div><span></span><span> </span></div></div><div><div><span></span><span> </span></div><div><span></span><span>"),GA=z("<div><h3></h3><div><span></span><span></span></div><div><span></span><span>"),rm=z("<div><h3>"),HA=z("<div><div><div><h2></h2><div>SKU: <!>  </div></div><div></div></div><div><button></button><button></button><button></button></div><div>"),YA=z("<span> "),WA=z("<span> "),KA=z("<div><div><span><span>  </span></span><span> </span></div><div>: <!>  <!>: "),QA=z("<div> "),JA=z("<div>Ref: "),XA=z("<div><div><div><span></span><span></span><span></span></div><div><span></span></div></div><div><div> </div><div>"),ZA=z("<div><h4></h4><div></div><div>"),eI=z("<div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div> <!>  </div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div>Min: <!>  Max: ");const tI=t=>{const{t:e}=lt(),[r,n]=ge("details"),i=We(()=>{if(!t.product)return null;const p=De.getTotalStockByProduct(t.product.id),C=De.getStockByProduct(t.product.id),P=p<=t.product.minStockLevel,E=p===0,y=p>=t.product.maxStockLevel;return{total:p,byLocation:C,status:E?"out":P?"low":y?"over":"good",statusText:E?e("products.outOfStock","Out of Stock"):P?e("products.lowStock","Low Stock"):y?e("products.overStock","Over Stock"):e("products.inStock","In Stock")}}),o=p=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(p),a=p=>new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),c=We(()=>!t.product||t.product.unitCost===0?0:((t.product.sellingPrice-t.product.unitCost)/t.product.unitCost*100).toFixed(2)),d=We(()=>t.product?De.movements.filter(p=>p.productId===t.product.id).sort((p,C)=>new Date(C.createdDate).getTime()-new Date(p.createdDate).getTime()):[]),h=We(()=>{if(!t.product)return null;const p=d(),C=i(),P=new Date;P.setDate(P.getDate()-30);const E=p.filter(oe=>new Date(oe.createdDate)>=P),y=p.reduce((oe,K)=>{const T=K.productId===t.product.id?K:null;return oe+(T?T.quantity*T.unitCost:0)},0);return{recentMovements:p.length,movements30Days:E.length,totalValue:(C?.total||0)*t.product.unitCost,averageMovementValue:p.length>0?y/p.length:0,lastMovementDate:p.length>0?p[0].createdDate:null}}),m={"margin-bottom":"2rem"},g={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},_={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},A={"font-weight":"400",color:"var(--text-primary)","font-size":"1rem"},M=p=>({in:"",out:"",transfer:"",adjustment:""})[p]||"";function L(p){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[p]||{bg:"#f5f5f5",color:"#666"}}const k=p=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:L(p).bg,color:L(p).color}),R=p=>{const C={good:{background:"#d4edda",color:"#155724"},low:{background:"#fff3cd",color:"#856404"},out:{background:"#f8d7da",color:"#721c24"},over:{background:"#cce5ff",color:"#004085"}};return{display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500",...C[p]||C.good}},W={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"},ie={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-bottom":"0.75rem"},te={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem","padding-bottom":"1rem","border-bottom":"2px solid var(--border-color)"},ye={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},ae=p=>({padding:"0.75rem 1.5rem",background:"none",border:"none","border-bottom":p?"2px solid var(--primary-color)":"2px solid transparent",color:p?"var(--primary-color)":"var(--text-muted)","font-weight":p?"600":"400",cursor:"pointer",transition:"all 0.2s","font-size":"0.875rem"}),$={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-bottom":"0.5rem"},S={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1.5rem","margin-bottom":"1rem"};return b(gr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("products.productDetails","Product Details")},size:"large",get children(){return b(Ne,{get when(){return t.product},get fallback(){return(()=>{var p=tm();return p.style.setProperty("text-align","center"),p.style.setProperty("padding","2rem"),p.style.setProperty("color","var(--text-muted)"),s(p,()=>e("products.noProductSelected","No product selected")),p})()},children:p=>(()=>{var C=HA(),P=C.firstChild,E=P.firstChild,y=E.firstChild,oe=y.nextSibling,K=oe.firstChild,T=K.nextSibling;T.nextSibling;var U=E.nextSibling,B=P.nextSibling,x=B.firstChild,I=x.nextSibling,N=I.nextSibling,Z=B.nextSibling;return s(C,()=>JSON.stringify(p),P),u(P,te),y.style.setProperty("margin","0"),y.style.setProperty("font-size","1.5rem"),y.style.setProperty("margin-bottom","0.25rem"),s(y,()=>p().name),oe.style.setProperty("color","var(--text-muted)"),s(oe,()=>p().sku,T),s(oe,()=>p().category,null),s(U,()=>i()?.statusText),u(B,ye),x.$$click=()=>n("details"),s(x,()=>e("products.details","Details")),I.$$click=()=>n("movements"),s(I,()=>e("products.movements","Movements")),N.$$click=()=>n("analytics"),s(N,()=>e("products.analytics","Analytics")),s(C,b(Ne,{get when(){return r()==="details"},get children(){return[(()=>{var j=UA(),J=j.firstChild,w=J.nextSibling,V=w.firstChild,X=V.nextSibling,Y=w.nextSibling,se=Y.firstChild,O=se.nextSibling,F=Y.nextSibling,le=F.firstChild,pe=le.nextSibling;return J.style.setProperty("margin-bottom","1rem"),J.style.setProperty("font-size","1.1rem"),s(J,()=>e("products.basicInformation","Basic Information")),s(V,()=>e("products.description","Description")),s(X,()=>p().description||e("common.notAvailable","N/A")),s(se,()=>e("products.unitOfMeasure","Unit of Measure")),s(O,()=>p().unitOfMeasure),s(le,()=>e("products.status","Status")),s(pe,(()=>{var ve=fe(()=>!!p().isActive);return()=>ve()?(()=>{var ce=YA();return ce.firstChild,ce.style.setProperty("color","#2e7d32"),s(ce,()=>e("common.active","Active"),null),ce})():(()=>{var ce=WA();return ce.firstChild,ce.style.setProperty("color","#d32f2f"),s(ce,()=>e("common.inactive","Inactive"),null),ce})()})()),re(ve=>{var ce=m,H=g,D=_,Q=A,G=g,he=_,me=A,ee=g,ne=_,Se=A;return ve.e=u(j,ce,ve.e),ve.t=u(w,H,ve.t),ve.a=u(V,D,ve.a),ve.o=u(X,Q,ve.o),ve.i=u(Y,G,ve.i),ve.n=u(se,he,ve.n),ve.s=u(O,me,ve.s),ve.h=u(F,ee,ve.h),ve.r=u(le,ne,ve.r),ve.d=u(pe,Se,ve.d),ve},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),j})(),(()=>{var j=jA(),J=j.firstChild,w=J.nextSibling,V=w.firstChild,X=V.firstChild,Y=X.firstChild,se=Y.nextSibling,O=X.nextSibling,F=O.firstChild,le=F.nextSibling,pe=V.nextSibling,ve=pe.firstChild,ce=ve.firstChild,H=ce.nextSibling,D=ve.nextSibling,Q=D.firstChild,G=Q.nextSibling,he=G.firstChild;return J.style.setProperty("margin-bottom","1rem"),J.style.setProperty("font-size","1.1rem"),s(J,()=>e("products.pricingInformation","Pricing Information")),s(Y,()=>e("products.unitCost","Unit Cost")),s(se,()=>o(p().unitCost)),s(F,()=>e("products.sellingPrice","Selling Price")),s(le,()=>o(p().sellingPrice)),s(ce,()=>e("products.profit","Profit")),s(H,()=>o(p().sellingPrice-p().unitCost)),s(Q,()=>e("products.profitMargin","Profit Margin")),s(G,c,he),re(me=>{var ee=m,ne=W,Se=g,we=_,ue=A,be=g,de=_,Pe=A,$e=g,xe=_,ke=A,Be=g,Qe=_,Ue=A;return me.e=u(j,ee,me.e),me.t=u(w,ne,me.t),me.a=u(X,Se,me.a),me.o=u(Y,we,me.o),me.i=u(se,ue,me.i),me.n=u(O,be,me.n),me.s=u(F,de,me.s),me.h=u(le,Pe,me.h),me.r=u(ve,$e,me.r),me.d=u(ce,xe,me.d),me.l=u(H,ke,me.l),me.u=u(D,Be,me.u),me.c=u(Q,Qe,me.c),me.w=u(G,Ue,me.w),me},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),j})(),(()=>{var j=qA(),J=j.firstChild,w=J.nextSibling,V=w.firstChild,X=V.firstChild,Y=X.firstChild,se=Y.nextSibling,O=se.firstChild,F=X.nextSibling,le=F.firstChild,pe=le.nextSibling,ve=pe.firstChild,ce=V.nextSibling,H=ce.firstChild,D=H.firstChild,Q=D.nextSibling,G=Q.firstChild,he=H.nextSibling,me=he.firstChild,ee=me.nextSibling;return J.style.setProperty("margin-bottom","1rem"),J.style.setProperty("font-size","1.1rem"),s(J,()=>e("products.stockInformation","Stock Information")),s(Y,()=>e("products.totalStock","Total Stock")),s(se,()=>i()?.total||0,O),s(se,()=>p().unitOfMeasure,null),s(le,()=>e("products.minStockLevel","Min Stock Level")),s(pe,()=>p().minStockLevel,ve),s(pe,()=>p().unitOfMeasure,null),s(D,()=>e("products.maxStockLevel","Max Stock Level")),s(Q,()=>p().maxStockLevel,G),s(Q,()=>p().unitOfMeasure,null),s(me,()=>e("products.stockValue","Stock Value")),s(ee,()=>o((i()?.total||0)*p().unitCost)),s(j,b(Ne,{get when(){return fe(()=>!!i()?.byLocation)()&&i().byLocation.length>0},get children(){var ne=zA(),Se=ne.firstChild;return ne.style.setProperty("margin-top","1.5rem"),Se.style.setProperty("margin-bottom","1rem"),Se.style.setProperty("font-size","1rem"),s(Se,()=>e("products.stockByLocation","Stock by Location")),s(ne,()=>i().byLocation.map(we=>(()=>{var ue=KA(),be=ue.firstChild,de=be.firstChild,Pe=de.firstChild;Pe.firstChild;var $e=de.nextSibling,xe=$e.firstChild,ke=be.nextSibling,Be=ke.firstChild,Qe=Be.nextSibling,Ue=Qe.nextSibling,Te=Ue.nextSibling;return Te.nextSibling,u(ue,ie),be.style.setProperty("display","flex"),be.style.setProperty("justify-content","space-between"),be.style.setProperty("align-items","center"),de.style.setProperty("font-weight","500"),de.style.setProperty("color","var(--primary-color)"),s(de,()=>we.locationId,Pe),Pe.style.setProperty("font-weight","500"),Pe.style.setProperty("color","var(--text-muted)"),s(Pe,()=>we.locationName,null),$e.style.setProperty("font-weight","600"),s($e,()=>we.quantity,xe),s($e,()=>p().unitOfMeasure,null),ke.style.setProperty("margin-top","0.5rem"),ke.style.setProperty("font-size","0.875rem"),ke.style.setProperty("color","var(--text-muted)"),s(ke,()=>e("products.available","Available"),Be),s(ke,()=>we.availableQuantity,Qe),s(ke,()=>e("products.reserved","Reserved"),Te),s(ke,()=>we.reservedQuantity,null),re(Fe=>(Fe=we.quantity>0?"var(--primary-color)":"var(--text-muted)")!=null?$e.style.setProperty("color",Fe):$e.style.removeProperty("color")),ue})()),null),ne}}),null),re(ne=>{var Se=m,we=W,ue=g,be=_,de=A,Pe=g,$e=_,xe=A,ke=g,Be=_,Qe=A,Ue=g,Te=_,Fe=A;return ne.e=u(j,Se,ne.e),ne.t=u(w,we,ne.t),ne.a=u(X,ue,ne.a),ne.o=u(Y,be,ne.o),ne.i=u(se,de,ne.i),ne.n=u(F,Pe,ne.n),ne.s=u(le,$e,ne.s),ne.h=u(pe,xe,ne.h),ne.r=u(H,ke,ne.r),ne.d=u(D,Be,ne.d),ne.l=u(Q,Qe,ne.l),ne.u=u(he,Ue,ne.u),ne.c=u(me,Te,ne.c),ne.w=u(ee,Fe,ne.w),ne},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),j})(),(()=>{var j=GA(),J=j.firstChild,w=J.nextSibling,V=w.firstChild,X=V.nextSibling,Y=w.nextSibling,se=Y.firstChild,O=se.nextSibling;return J.style.setProperty("margin-bottom","1rem"),J.style.setProperty("font-size","1.1rem"),s(J,()=>e("products.timestamps","Timestamps")),s(V,()=>e("common.createdDate","Created Date")),s(X,()=>a(p().createdDate)),s(se,()=>e("common.lastModified","Last Modified")),s(O,()=>a(p().lastModified)),re(F=>{var le=m,pe=g,ve=_,ce=A,H=g,D=_,Q=A;return F.e=u(j,le,F.e),F.t=u(w,pe,F.t),F.a=u(V,ve,F.a),F.o=u(X,ce,F.o),F.i=u(Y,H,F.i),F.n=u(se,D,F.n),F.s=u(O,Q,F.s),F},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),j})()]}}),Z),s(C,b(Ne,{get when(){return r()==="movements"},get children(){var j=rm(),J=j.firstChild;return J.style.setProperty("margin-bottom","1rem"),J.style.setProperty("font-size","1.1rem"),s(J,()=>e("products.recentMovements","Recent Movements")),s(j,b(Ne,{get when(){return d().length>0},get fallback(){return(()=>{var w=QA();return w.firstChild,w.style.setProperty("text-align","center"),w.style.setProperty("padding","2rem"),w.style.setProperty("color","var(--text-muted)"),w.style.setProperty("background","var(--surface-color)"),w.style.setProperty("border-radius","var(--border-radius-sm)"),w.style.setProperty("border","1px solid var(--border-color)"),s(w,()=>e("products.noMovements","No movements found for this product"),null),w})()},get children(){return b(pt,{get each(){return d()},children:w=>{const V=w.productId===p().id?w:null;if(!V)return null;let X=De.getLocationById(w.locationId);return(()=>{var Y=XA(),se=Y.firstChild,O=se.firstChild,F=O.firstChild,le=F.nextSibling,pe=le.nextSibling,ve=O.nextSibling,ce=ve.firstChild,H=se.nextSibling,D=H.firstChild,Q=D.firstChild,G=D.nextSibling;return u(Y,$),O.style.setProperty("font-weight","600"),O.style.setProperty("margin-bottom","0.25rem"),F.style.setProperty("font-size","1.2rem"),s(F,()=>M(w.movementType)),le.style.setProperty("padding","0 6px"),s(pe,()=>w.movementType),ve.style.setProperty("font-size","0.875rem"),ve.style.setProperty("color","var(--text-muted)"),s(ve,()=>` ${a(w?.createdDate)}  `,ce),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("font-weight","600"),ce.style.setProperty("color","var(--primary-color)"),s(ce,()=>w?.locationId),s(ve,()=>`  ${X?.name}`,null),s(se,b(Ne,{get when(){return w.referenceNumber},get children(){var he=JA();return he.firstChild,he.style.setProperty("font-size","0.75rem"),he.style.setProperty("color","var(--text-muted)"),he.style.setProperty("margin-top","0.25rem"),s(he,()=>w?.referenceNumber,null),he}}),null),H.style.setProperty("text-align","right"),D.style.setProperty("font-weight","600"),D.style.setProperty("font-size","1rem"),s(D,()=>w?.movementType==="in"?"+":"",Q),s(D,()=>V.quantity,Q),s(D,()=>p().unitOfMeasure,null),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-muted)"),s(G,()=>o(V.unitCost)),re(he=>{var me=k(w.movementType),ee=w?.movementType==="in"?"#2e7d32":"#d32f2f";return he.e=u(pe,me,he.e),ee!==he.t&&((he.t=ee)!=null?D.style.setProperty("color",ee):D.style.removeProperty("color")),he},{e:void 0,t:void 0}),Y})()}})}}),null),re(w=>u(j,m,w)),j}}),Z),s(C,b(Ne,{get when(){return r()==="analytics"},get children(){var j=rm(),J=j.firstChild;return J.style.setProperty("margin-bottom","1rem"),J.style.setProperty("font-size","1.1rem"),s(J,()=>e("products.analytics","Analytics")),s(j,b(Ne,{get when(){return h()},get fallback(){return(()=>{var w=tm();return w.style.setProperty("text-align","center"),w.style.setProperty("padding","2rem"),w.style.setProperty("color","var(--text-muted)"),s(w,()=>e("products.noAnalytics","No analytics data available")),w})()},children:w=>(()=>{var V=eI(),X=V.firstChild,Y=X.firstChild,se=Y.nextSibling,O=se.nextSibling,F=X.nextSibling,le=F.firstChild,pe=le.nextSibling,ve=pe.nextSibling,ce=F.nextSibling,H=ce.firstChild,D=H.nextSibling,Q=D.nextSibling,G=Q.firstChild,he=G.nextSibling;he.nextSibling;var me=ce.nextSibling,ee=me.firstChild,ne=ee.nextSibling,Se=ne.nextSibling,we=me.nextSibling,ue=we.firstChild,be=ue.nextSibling,de=be.nextSibling,Pe=de.firstChild,$e=Pe.nextSibling;return $e.nextSibling,Y.style.setProperty("margin","0 0 0.5rem 0"),Y.style.setProperty("color","var(--primary-color)"),s(Y,()=>e("products.totalMovements","Total Movements")),se.style.setProperty("font-size","1.5rem"),se.style.setProperty("font-weight","600"),s(se,()=>w().recentMovements),O.style.setProperty("font-size","0.875rem"),O.style.setProperty("color","var(--text-muted)"),O.style.setProperty("margin-top","0.25rem"),s(O,()=>e("products.allTime","All time")),le.style.setProperty("margin","0 0 0.5rem 0"),le.style.setProperty("color","var(--primary-color)"),s(le,()=>e("products.last30Days","Last 30 Days")),pe.style.setProperty("font-size","1.5rem"),pe.style.setProperty("font-weight","600"),s(pe,()=>w().movements30Days),ve.style.setProperty("font-size","0.875rem"),ve.style.setProperty("color","var(--text-muted)"),ve.style.setProperty("margin-top","0.25rem"),s(ve,()=>e("products.movements","movements")),H.style.setProperty("margin","0 0 0.5rem 0"),H.style.setProperty("color","var(--primary-color)"),s(H,()=>e("products.currentValue","Current Stock Value")),D.style.setProperty("font-size","1.5rem"),D.style.setProperty("font-weight","600"),s(D,()=>o(w().totalValue)),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),Q.style.setProperty("margin-top","0.25rem"),s(Q,()=>i()?.total||0,G),s(Q,()=>p().unitOfMeasure,he),s(Q,()=>o(p().unitCost),null),ee.style.setProperty("margin","0 0 0.5rem 0"),ee.style.setProperty("color","var(--primary-color)"),s(ee,()=>e("products.avgMovementValue","Avg Movement Value")),ne.style.setProperty("font-size","1.5rem"),ne.style.setProperty("font-weight","600"),s(ne,()=>o(w().averageMovementValue)),Se.style.setProperty("font-size","0.875rem"),Se.style.setProperty("color","var(--text-muted)"),Se.style.setProperty("margin-top","0.25rem"),s(Se,()=>e("products.perMovement","per movement")),s(V,b(Ne,{get when(){return w().lastMovementDate},get children(){var xe=ZA(),ke=xe.firstChild,Be=ke.nextSibling,Qe=Be.nextSibling;return ke.style.setProperty("margin","0 0 0.5rem 0"),ke.style.setProperty("color","var(--primary-color)"),s(ke,()=>e("products.lastMovement","Last Movement")),Be.style.setProperty("font-size","1.25rem"),Be.style.setProperty("font-weight","600"),s(Be,()=>a(w().lastMovementDate)),Qe.style.setProperty("font-size","0.875rem"),Qe.style.setProperty("color","var(--text-muted)"),Qe.style.setProperty("margin-top","0.25rem"),s(Qe,()=>e("products.mostRecent","Most recent activity")),re(Ue=>u(xe,S,Ue)),xe}}),we),ue.style.setProperty("margin","0 0 0.5rem 0"),ue.style.setProperty("color","var(--primary-color)"),s(ue,()=>e("products.stockStatus","Stock Status")),be.style.setProperty("font-size","1.25rem"),be.style.setProperty("font-weight","600"),s(be,()=>i()?.statusText),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("color","var(--text-muted)"),de.style.setProperty("margin-top","0.25rem"),s(de,()=>p().minStockLevel,$e),s(de,()=>p().maxStockLevel,null),re(xe=>{var ke=W,Be=S,Qe=S,Ue=S,Te=S,Fe=S;return xe.e=u(V,ke,xe.e),xe.t=u(X,Be,xe.t),xe.a=u(F,Qe,xe.a),xe.o=u(ce,Ue,xe.o),xe.i=u(me,Te,xe.i),xe.n=u(we,Fe,xe.n),xe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),V})()}),null),re(w=>u(j,m,w)),j}}),Z),Z.style.setProperty("display","flex"),Z.style.setProperty("gap","1rem"),Z.style.setProperty("justify-content","flex-end"),Z.style.setProperty("margin-top","2rem"),s(Z,b(Le,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close","Close")}}),null),s(Z,b(Ne,{get when(){return t.onEdit},get children(){return b(Le,{variant:"primary",get onClick(){return t.onEdit},get children(){return e("common.edit","Edit")}})}}),null),re(j=>{var J=R(i()?.status||"good"),w=ae(r()==="details"),V=ae(r()==="movements"),X=ae(r()==="analytics");return j.e=u(U,J,j.e),j.t=u(x,w,j.t),j.a=u(I,V,j.a),j.o=u(N,X,j.o),j},{e:void 0,t:void 0,a:void 0,o:void 0}),C})()})}})};At(["click"]);var rI=z("<div>"),nI=z("<button type=button>"),iI=z("<div> "),nm=z("<div>"),oI=z("<div><div><input type=text autocomplete=off>"),sI=z("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>"),aI=z("<span> ");const lI=t=>{const{t:e}=lt(),[r,n]=ge(""),[i,o]=ge(!1),[a,c]=ge(null),[d,h]=ge([]),[m,g]=ge(!1),[_,A]=ge(-1),[M,L]=ge(null),k=t.searchDelay||300,R=t.maxResults||900,W=async w=>{if(!w.trim()||w.trim().length<3){h([]),t.onSearchResults?.([]);return}try{o(!0),c(null);try{const V=await an.getProducts(w),X=Object.keys(V),Y=O=>{let F=V;return{id:O,name:F[O].name,businessId:F[O].businessId,sku:F[O].code,UPC:F[O].UPC,numCode:F[O].codeN,category:F[O].category,unitCost:F[O].unitCost||0,unitOfMeasure:F[O].unitOfMeasure,minStockLevel:F[O].minStockLevel,maxStockLevel:F[O].maxStockLevel,isActive:F[O].isActive,description:F[O].description||"",createdDate:F[O].createdAt||new Date().toISOString(),lastModified:F[O].updatedAt||new Date().toISOString()}},se=X.map(Y);h(se),De.updProduct(se),t.onSearchResults?.(se)}catch(V){console.warn("API search failed, using local fallback:",V),c("API search failed, showing local results");const X=De.getActiveProducts().filter(Y=>Y.name.toLowerCase().includes(w.toLowerCase())||Y.sku.toLowerCase().includes(w.toLowerCase())||Y.category.toLowerCase().includes(w.toLowerCase())).slice(0,R);h(X),t.onSearchResults?.(X)}}catch(V){const X=V instanceof Error?V.message:"Search failed";c(X),h([]),t.onSearchResults?.([])}finally{o(!1)}},ie=w=>{const X=w.target.value;n(X),c(null),t.showResults!==!1&&g(!0),M()&&clearTimeout(M());const Y=setTimeout(()=>{W(X)},k);L(Y)},te=w=>{n(w.name),g(!1),A(-1),t.onProductSelect?.(w)},ye=w=>{if(!(!m()||d().length===0))switch(w.key){case"ArrowDown":w.preventDefault(),A(V=>Math.min(V+1,d().length-1));break;case"ArrowUp":w.preventDefault(),A(V=>Math.max(V-1,-1));break;case"Enter":w.preventDefault(),_()>=0&&d()[_()]&&te(d()[_()]);break;case"Escape":g(!1),A(-1);break}},ae=()=>{t.showResults!==!1&&d().length>0&&g(!0)},$=()=>{setTimeout(()=>{g(!1),A(-1)},150)},S=()=>{n(""),h([]),c(null),g(!1),A(-1),t.onSearchResults?.([]),M()&&(clearTimeout(M()),L(null))},p=w=>De.stockLevels.filter(V=>V.productId===w).reduce((V,X)=>V+X.quantity,0),C=w=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(w),P={position:"relative",width:"100%",...t.style},E={position:"relative",display:"flex","align-items":"center"},y={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},oe={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},K={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},T={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},U=w=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:w?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),B={display:"flex","justify-content":"space-between","align-items":"center"},x={flex:"1"},I={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},N={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},Z={"text-align":"right","font-size":"0.875rem"},j={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},J={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var w=oI(),V=w.firstChild,X=V.firstChild;return X.addEventListener("blur",$),X.addEventListener("focus",ae),X.$$keydown=ye,X.$$input=ie,s(V,b(Ne,{get when(){return i()},get children(){var Y=rI();return re(se=>u(Y,K,se)),Y}}),null),s(V,b(Ne,{get when(){return fe(()=>!!r())()&&!i()},get children(){var Y=nI();return Y.addEventListener("mouseleave",se=>{se.currentTarget.style.background="none",se.currentTarget.style.color="var(--text-muted)"}),Y.addEventListener("mouseenter",se=>{se.currentTarget.style.background="var(--border-color)",se.currentTarget.style.color="var(--text-primary)"}),Y.$$click=S,re(se=>{var O=oe,F=e("common.clear","Clear search");return se.e=u(Y,O,se.e),F!==se.t&&ct(Y,"title",se.t=F),se},{e:void 0,t:void 0}),Y}}),null),s(w,b(Ne,{get when(){return m()&&t.showResults!==!1},get children(){var Y=nm();return s(Y,b(Ne,{get when(){return a()},get children(){var se=iI();return se.firstChild,u(se,J),s(se,a,null),se}}),null),s(Y,b(Ne,{get when(){return d().length>0},get fallback(){return fe(()=>!!(r()&&!i()))()&&(()=>{var se=nm();return u(se,j),s(se,()=>e("inventory.noProductsFound","No products found matching your search.")),se})()},get children(){return b(pt,{get each(){return d()},children:(se,O)=>{const F=p(se.id),le=F<=se.minStockLevel;return(()=>{var pe=sI(),ve=pe.firstChild,ce=ve.firstChild,H=ce.firstChild,D=H.nextSibling,Q=D.firstChild,G=Q.firstChild,he=Q.nextSibling,me=he.nextSibling,ee=me.nextSibling,ne=ee.nextSibling,Se=ce.nextSibling,we=Se.firstChild,ue=we.firstChild,be=we.nextSibling;return pe.addEventListener("mouseenter",()=>A(O())),pe.$$click=()=>te(se),u(ve,B),u(ce,x),u(H,I),s(H,()=>se.name),u(D,N),s(Q,()=>e("inventory.sku","SKU"),G),s(Q,()=>se.sku,null),s(me,()=>se.category),s(ne,()=>C(se.unitCost)),u(Se,Z),we.style.setProperty("font-weight","600"),(le?"#f44336":"var(--text-primary)")!=null?we.style.setProperty("color",le?"#f44336":"var(--text-primary)"):we.style.removeProperty("color"),s(we,F,ue),s(we,()=>se.unitOfMeasure,null),be.style.setProperty("color","var(--text-muted)"),s(be,()=>le?(()=>{var de=aI();return de.firstChild,de.style.setProperty("color","#f44336"),s(de,()=>e("inventory.lowStock","Low Stock"),null),de})():e("inventory.inStock","In Stock")),re(de=>u(pe,U(O()===_()),de)),pe})()}})}}),null),re(se=>u(Y,T,se)),Y}}),null),re(Y=>{var se=P,O=E,F=y,le=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),pe=t.disabled;return Y.e=u(w,se,Y.e),Y.t=u(V,O,Y.t),Y.a=u(X,F,Y.a),le!==Y.o&&ct(X,"placeholder",Y.o=le),pe!==Y.i&&(X.disabled=Y.i=pe),Y},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),re(()=>X.value=r()),w})()};At(["input","keydown","click"]);var cI=z("<div><div><h2></h2><div><div>"),uI=z("<div><span>"),dI=z("<span> "),hI=z("<div><div><div><div><h3></h3><span></span></div><div></div><div>: </div></div><div><div></div><div>  <!>: </div><div>: "),mI=z("<div><div>:</div><div>"),fI=z("<div>: "),yI=z("<div><div><span>:</span><select><option value=10>10</option><option value=20>20</option><option value=50>50</option><option value=100>100</option></select></div><div><div><span></span><input type=number min=1><span> </span></div></div><div>");const Pg=()=>{const{t}=lt(),[e,r]=ge(""),[n,i]=ge(""),[o,a]=ge([]),[c,d]=ge(!1),[h,m]=ge(null),[g,_]=ge(!1),[A,M]=ge(!1),[L,k]=ge(!1),[R,W]=ge(null),[ie,te]=ge(!1),[ye,ae]=ge([]),[$,S]=ge(!1),[p,C]=ge(1),[P,E]=ge(20);qr(async()=>{await y()});const y=async()=>{try{d(!0),m(null);try{const w=await ld.getAll();a(w.map(V=>({id:V.id||`prod-${Date.now()}-${Math.random()}`,name:V.productName||V.name||"Unknown Product",sku:V.sku||V.productCode||"",description:V.description||"",category:V.category||"General",unitOfMeasure:V.unitOfMeasure||"pcs",unitCost:parseFloat(V.unitCost||V.cost||"0"),sellingPrice:parseFloat(V.sellingPrice||V.price||"0"),minStockLevel:parseInt(V.minStockLevel||"0"),maxStockLevel:parseInt(V.maxStockLevel||"100"),isActive:V.isActive!==!1,createdDate:V.createdDate||new Date().toISOString(),lastModified:V.lastModified||new Date().toISOString(),businessId:V.businessId||"YB100423253156428"})))}catch(w){console.warn("API failed, using local store:",w),a(De.products)}}catch(w){m(w instanceof Error?w.message:"Failed to load products")}finally{d(!1)}},oe=async()=>{try{d(!0),m(null);try{const w=await an.getProducts("prod"),V=Object.keys(w),X=se=>{let F=w[se];return{id:F.id,name:F.name,businessId:F.businessId,sku:F.code,numCode:F.codeN,category:F.category,unitCost:F.unitCost||0,unitOfMeasure:F.unitOfMeasure,minStockLevel:F.minStockLevel,maxStockLevel:F.maxStockLevel,isActive:F.isActive,description:F.description||"",createdDate:F.createdAt||new Date().toISOString(),lastModified:F.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(F.sellingPrice||F.price||"0")}},Y=V.map(X);a(Y)}catch(w){console.warn("API failed, using local store:",w),a(De.products)}}catch(w){m(w instanceof Error?w.message:"Failed to load products")}finally{d(!1)}},{cancel:K}=FA(async w=>{if(!w.trim()){await y();return}try{m(null);const V=await ld.getAll(w);a(V.map(X=>({id:X.id||`prod-${Date.now()}-${Math.random()}`,name:X.productName||X.name||"Unknown Product",sku:X.sku||X.productCode||"",description:X.description||"",category:X.category||"General",unitOfMeasure:X.unitOfMeasure||"pcs",unitCost:parseFloat(X.unitCost||X.cost||"0"),sellingPrice:parseFloat(X.sellingPrice||X.price||"0"),minStockLevel:parseInt(X.minStockLevel||"0"),maxStockLevel:parseInt(X.maxStockLevel||"100"),isActive:X.isActive!==!1,createdDate:X.createdDate||new Date().toISOString(),lastModified:X.lastModified||new Date().toISOString(),businessId:X.businessId||"YB100423253156428"})))}catch(V){m(V instanceof Error?V.message:"Search failed");const X=De.products.filter(Y=>Y.name.toLowerCase().includes(w.toLowerCase())||Y.sku.toLowerCase().includes(w.toLowerCase())||Y.category.toLowerCase().includes(w.toLowerCase()));a(X)}},300);co(()=>{K()}),We(()=>{let w=o();return n()&&(w=w.filter(V=>V.category===n())),w}),We(()=>[...new Set(o().map(V=>V.category))].sort()),We(()=>{const w=o().filter(Y=>Y.isActive),V=o().length,X=o().filter(Y=>De.getTotalStockByProduct(Y.id)===0);return{total:V,active:w.length,outOfStock:X.length}});const T=w=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(w),U={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},B={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},x=w=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:w?"#ffebee":"#e8f5e8",color:w?"#d32f2f":"#2d7d32"});We(()=>{const w=De.products||[],V=De.movements||[],X=De.stockLevels||[],Y=De.getLowStockProducts(),se=w?.length||0,O=w?.filter(pe=>pe.isActive).length,F=X.reduce((pe,ve)=>pe*1+ve.quantity*1*ve.averageCost*1,0),le=V?.filter(pe=>{const ve=new Date(pe.createdDate),ce=new Date;return ve.getMonth()===ce.getMonth()&&ve.getFullYear()===ce.getFullYear()}).length;return{totalProducts:se,activeProducts:O,lowStockProducts:Y.length,totalStockValue:F,totalMovementsThisMonth:le,totalLocations:De.locations.length,activeLocations:De.getActiveLocations().length}});const I=We(()=>De.products.map(w=>{const V=De.getStockByProduct(w.id),X=De.getTotalStockByProduct(w.id),Y=De.getLastLocationByProduct(w.id);return{...w,totalStock:X,stockByLocation:V,lastLocation:Y,isLowStock:X<=w.minStockLevel}})),N=We(()=>ye().map(w=>{const V=De.getStockByProduct(w.id),X=De.getTotalStockByProduct(w.id),Y=De.getLastLocationByProduct(w.id);return{...w,totalStock:X,stockByLocation:V,lastLocation:Y,isLowStock:X<=w.minStockLevel}})),Z=We(()=>{const w=$()?N():I(),V=(p()-1)*P(),X=V+P();return w.slice(V,X)}),j=We(()=>{const w=$()?N():I();return Math.ceil(w.length/P())}),J=w=>{W(w),M(!0)};return b(kr,{get title(){return t("products.title","Products")},get children(){return[(()=>{var w=cI(),V=w.firstChild,X=V.firstChild,Y=X.nextSibling,se=Y.firstChild;return w.style.setProperty("display","flex"),w.style.setProperty("justify-content","space-between"),w.style.setProperty("align-items","flex-start"),w.style.setProperty("margin-bottom","1.5rem"),w.style.setProperty("flex-wrap","wrap"),w.style.setProperty("gap","1rem"),V.style.setProperty("flex","1"),V.style.setProperty("min-width","300px"),X.style.setProperty("margin","0 0 1rem 0"),X.style.setProperty("font-size","1.5rem"),s(X,()=>t("inventory.products")),Y.style.setProperty("display","flex"),Y.style.setProperty("gap","1rem"),Y.style.setProperty("align-items","center"),Y.style.setProperty("flex-wrap","wrap"),se.style.setProperty("flex","1"),se.style.setProperty("min-width","250px"),s(se,b(lI,{onSearchResults:O=>{ae(O),S(O.length>0)},get placeholder(){return t("inventory.searchProductsStock","Search products and check stock levels...")},showResults:!1,maxResults:20})),s(Y,b(Le,{variant:"outline",onClick:()=>{oe(),S(!1)},get children(){return[" ",fe(()=>t("common.showAll","Show All"))]}}),null),s(w,b(Ne,{get when(){return vt.hasPermission("read_write")},get children(){return b(Le,{variant:"primary",onClick:()=>te(!0),get children(){return[" ",fe(()=>t("inventory.addProduct"))]}})}}),null),w})(),(()=>{var w=uI(),V=w.firstChild;return w.style.setProperty("margin-bottom","1rem"),w.style.setProperty("font-size","0.875rem"),w.style.setProperty("color","var(--text-muted)"),w.style.setProperty("display","flex"),w.style.setProperty("justify-content","space-between"),w.style.setProperty("align-items","center"),s(V,(()=>{var X=fe(()=>!!$());return()=>X()?`${t("inventory.searchResults","Search Results")}: ${N().length} ${t("common.products","products")}`:`${t("inventory.totalProducts","Total Products")}: ${I().length} ${t("common.products","products")}`})()),s(w,(()=>{var X=fe(()=>!!$());return()=>X()&&(()=>{var Y=dI();return Y.firstChild,Y.style.setProperty("color","var(--primary-color)"),s(Y,()=>t("inventory.filtered","Filtered view"),null),Y})()})(),null),w})(),b(pt,{get each(){return Z()},children:w=>(()=>{var V=hI(),X=V.firstChild,Y=X.firstChild,se=Y.firstChild,O=se.firstChild,F=O.nextSibling,le=se.nextSibling,pe=le.nextSibling,ve=pe.firstChild,ce=Y.nextSibling,H=ce.firstChild,D=H.nextSibling,Q=D.firstChild,G=Q.nextSibling;G.nextSibling;var he=D.nextSibling,me=he.firstChild;return V.$$click=()=>J(w),V.addEventListener("mouseleave",ee=>{ee.currentTarget.style.transform="translateY(0)",ee.currentTarget.style.boxShadow="none"}),V.addEventListener("mouseenter",ee=>{ee.currentTarget.style.transform="translateY(-2px)",ee.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),u(V,U),u(X,B),se.style.setProperty("display","flex"),se.style.setProperty("align-items","center"),se.style.setProperty("gap","0.5rem"),se.style.setProperty("margin-bottom","0.5rem"),O.style.setProperty("margin","0"),O.style.setProperty("font-size","1.1rem"),s(O,()=>w.name),s(F,(()=>{var ee=fe(()=>!!w.isLowStock);return()=>ee()?t("inventory.lowStockAlert"):t("inventory.inStock")})()),le.style.setProperty("font-size","0.875rem"),le.style.setProperty("color","var(--text-muted)"),s(le,()=>w.sku,null),s(le,()=>w.UPC?"  "+w.UPC:"",null),s(le,()=>w.category?"  "+w.category:"",null),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),s(pe,()=>t("inventory.lastSeen"),ve),s(pe,()=>w.lastLocation?.name||t("inventory.noMovements"),null),ce.style.setProperty("text-align","right"),H.style.setProperty("font-size","1.25rem"),H.style.setProperty("font-weight","700"),H.style.setProperty("color","var(--primary-color)"),s(H,()=>w.totalStock),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("color","var(--text-muted)"),s(D,()=>w.unitOfMeasure,Q),s(D,()=>t("inventory.min"),G),s(D,()=>w.minStockLevel,null),he.style.setProperty("font-size","0.875rem"),he.style.setProperty("color","var(--text-muted)"),s(he,()=>t("inventory.cost"),me),s(he,()=>T(w.unitCost),null),s(V,(()=>{var ee=fe(()=>w.stockByLocation.length>0);return()=>ee()&&(()=>{var ne=mI(),Se=ne.firstChild,we=Se.firstChild,ue=Se.nextSibling;return ne.style.setProperty("margin-top","1rem"),Se.style.setProperty("font-weight","500"),Se.style.setProperty("margin-bottom","0.5rem"),Se.style.setProperty("font-size","0.875rem"),s(Se,()=>t("inventory.stockByLocation"),we),ue.style.setProperty("display","flex"),ue.style.setProperty("flex-wrap","wrap"),ue.style.setProperty("gap","0.5rem"),s(ue,b(pt,{get each(){return w.stockByLocation},children:be=>{const de=De.getLocationById(be.locationId);return(()=>{var Pe=fI(),$e=Pe.firstChild;return Pe.style.setProperty("padding","0.25rem 0.5rem"),Pe.style.setProperty("background","var(--background-color)"),Pe.style.setProperty("border-radius","var(--border-radius-sm)"),Pe.style.setProperty("font-size","0.75rem"),Pe.style.setProperty("border","1px solid var(--border-color)"),s(Pe,()=>de?.name,$e),s(Pe,()=>be.quantity,null),Pe})()}})),ne})()})(),null),re(ee=>u(F,x(w.isLowStock),ee)),V})()}),fe(()=>fe(()=>j()>1)()&&(()=>{var w=yI(),V=w.firstChild,X=V.firstChild,Y=X.firstChild,se=X.nextSibling,O=V.nextSibling,F=O.firstChild,le=F.firstChild,pe=le.nextSibling,ve=pe.nextSibling,ce=ve.firstChild,H=O.nextSibling;return w.style.setProperty("display","flex"),w.style.setProperty("justify-content","space-between"),w.style.setProperty("align-items","center"),w.style.setProperty("margin-top","2rem"),w.style.setProperty("padding","1rem"),w.style.setProperty("background","var(--surface-color)"),w.style.setProperty("border-radius","var(--border-radius)"),w.style.setProperty("border","1px solid var(--border-color)"),V.style.setProperty("display","flex"),V.style.setProperty("align-items","center"),V.style.setProperty("gap","0.5rem"),X.style.setProperty("font-size","0.875rem"),X.style.setProperty("color","var(--text-muted)"),s(X,()=>t("common.showPerPage","Show per page"),Y),se.addEventListener("change",D=>{E(parseInt(D.target.value)),C(1)}),se.style.setProperty("padding","0.25rem 0.5rem"),se.style.setProperty("border","1px solid var(--border-color)"),se.style.setProperty("border-radius","var(--border-radius-sm)"),se.style.setProperty("background","var(--background-color)"),se.style.setProperty("cursor","pointer"),O.style.setProperty("display","flex"),O.style.setProperty("align-items","center"),O.style.setProperty("gap","0.5rem"),s(O,b(Le,{variant:"outline",size:"sm",onClick:()=>C(1),get disabled(){return p()===1},get children(){return t("common.first","First")}}),F),s(O,b(Le,{variant:"outline",size:"sm",onClick:()=>C(D=>Math.max(1,D-1)),get disabled(){return p()===1},get children(){return t("common.previous","Previous")}}),F),F.style.setProperty("display","flex"),F.style.setProperty("align-items","center"),F.style.setProperty("gap","0.25rem"),le.style.setProperty("font-size","0.875rem"),s(le,()=>t("common.page","Page")),pe.addEventListener("change",D=>{const Q=parseInt(D.target.value);Q>=1&&Q<=j()&&C(Q)}),pe.style.setProperty("width","60px"),pe.style.setProperty("padding","0.25rem 0.5rem"),pe.style.setProperty("border","1px solid var(--border-color)"),pe.style.setProperty("border-radius","var(--border-radius-sm)"),pe.style.setProperty("text-align","center"),pe.style.setProperty("font-size","0.875rem"),ve.style.setProperty("font-size","0.875rem"),s(ve,()=>t("common.of","of"),ce),s(ve,j,null),s(O,b(Le,{variant:"outline",size:"sm",onClick:()=>C(D=>Math.min(j(),D+1)),get disabled(){return p()===j()},get children(){return t("common.next","Next")}}),null),s(O,b(Le,{variant:"outline",size:"sm",onClick:()=>C(j()),get disabled(){return p()===j()},get children(){return t("common.last","Last")}}),null),H.style.setProperty("font-size","0.875rem"),H.style.setProperty("color","var(--text-muted)"),s(H,()=>{const D=$()?N():I(),Q=(p()-1)*P()+1,G=Math.min(p()*P(),D.length);return t("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:Q,end:G,total:D.length})}),re(()=>ct(pe,"max",j())),re(()=>se.value=P()),re(()=>pe.value=p()),w})()),b(xu,{get isOpen(){return g()},onClose:()=>_(!1),onProductAdded:()=>{y()}}),b(tI,{get isOpen(){return A()},onClose:()=>{M(!1),W(null)},get product(){return R()},onEdit:()=>{M(!1),k(!0)}})]}})};At(["click"]);var gI=z("<div><div></div><div>"),pI=z("<div><div><img></div><div>X</div><div><div><h2></h2><div></div></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),vI=z("<div>"),bI=z("<div><div></div><h3></h3><p>"),_I=z("<div><div>"),SI=z("<div>"),PI=z("<div><div><img loading=lazy></div><div><div></div><div>  </div><div></div><div>",!0,!1,!1);const wI=t=>{const{t:e}=lt(),[r,n]=ge(null),[i,o]=ge([]),[a,c]=ge(!1),d=U=>{n(U),t.onProductSelect?.(U)},h=()=>{n(null),t.onProductSelect?.(null),o([]),c(!1)},m=U=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(U),g=()=>"YABABYSSolution",_=()=>"https://qvamarkets.s3.us-east-2.amazonaws.com/V2_images/7258/",A=U=>{if(U.productImageUrl)return _()+g()+"/"+U?.productImageUrl;const B={Electronics:"https://via.placeholder.com/400x300/4F46E5/FFFFFF?text=Electronics",Furniture:"https://via.placeholder.com/400x300/059669/FFFFFF?text=Furniture",Food:"https://via.placeholder.com/400x300/DC2626/FFFFFF?text=Food",Clothing:"https://via.placeholder.com/400x300/7C3AED/FFFFFF?text=Clothing",Tools:"https://via.placeholder.com/400x300/EA580C/FFFFFF?text=Tools",General:"https://via.placeholder.com/400x300/6B7280/FFFFFF?text=Product"};return B[U.category]||B.General},M={padding:"2rem"},L={"max-width":"600px",margin:"0 auto 2rem",position:"relative"},k={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},R={background:"var(--surface-color)","border-radius":"var(--border-radius)",overflow:"hidden","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.3s ease"},W={position:"relative",width:"100%",height:"200px",overflow:"hidden",background:"#f5f5f5"},ie={width:"100%",height:"100%","object-fit":"cover",transition:"transform 0.3s ease"},te={padding:"1rem"},ye={"font-size":"1rem","font-weight":"600","margin-bottom":"0.5rem",color:"var(--text-primary)",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},ae={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.25rem"},$={"font-size":"1.25rem","font-weight":"700",color:"var(--primary-color)","margin-top":"0.5rem"},S={display:"flex",gap:"2rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"2rem","box-shadow":"var(--shadow-md)","margin-bottom":"2rem",position:"relative"},p={width:"400px",height:"300px","border-radius":"var(--border-radius)",overflow:"hidden",background:"#f5f5f5"},C={flex:"1",display:"flex","flex-direction":"column",gap:"1rem"},P={display:"flex","justify-content":"space-between","padding-bottom":"0.5rem","border-bottom":"1px solid var(--border-light)"},E={"font-weight":"500",color:"var(--text-muted)"},y={"font-weight":"600",color:"var(--text-primary)"},oe=U=>({display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600",background:"#d4edda",color:"#155724"}),K={"text-align":"center",padding:"4rem 2rem",color:"var(--text-muted)"},T={"font-size":"3rem","margin-bottom":"1rem",opacity:"0.5"};return(()=>{var U=_I(),B=U.firstChild;return u(U,M),s(B,b(Eu,{onChange:x=>{console.log(x);let I=x;c(!0),d(I)},get placeholder(){return e("inventory.searchProductsImages","Search products to view images...")}})),s(U,b(Ne,{get when(){return r()&&t.showDetails!==!1},get children(){var x=pI(),I=x.firstChild,N=I.firstChild,Z=I.nextSibling,j=Z.nextSibling,J=j.firstChild,w=J.firstChild,V=w.nextSibling,X=J.nextSibling,Y=X.firstChild,se=Y.nextSibling,O=X.nextSibling,F=O.firstChild,le=F.nextSibling,pe=O.nextSibling,ve=pe.firstChild,ce=ve.nextSibling,H=pe.nextSibling,D=H.firstChild,Q=D.nextSibling;return u(x,S),u(I,p),N.style.setProperty("width","100%"),N.style.setProperty("height","100%"),N.style.setProperty("object-fit","contain"),N.style.setProperty("aspect-ratio","1 / 1"),Z.$$click=()=>{h()},Z.style.setProperty("position","absolute"),Z.style.setProperty("top","0.5rem"),Z.style.setProperty("right","0.5rem"),Z.style.setProperty("color","#3d3d3d"),Z.style.setProperty("border-radius","50%"),Z.style.setProperty("width","2rem"),Z.style.setProperty("height","2rem"),Z.style.setProperty("display","flex"),Z.style.setProperty("align-items","center"),Z.style.setProperty("justify-content","center"),Z.style.setProperty("font-size","1.25rem"),Z.style.setProperty("box-shadow","var(--shadow-sm)"),Z.style.setProperty("cursor","pointer"),u(j,C),w.style.setProperty("margin","0 0 0.5rem 0"),w.style.setProperty("font-size","1.5rem"),s(w,()=>r().name),s(V,()=>e("products.inStock","In Stock")),s(Y,()=>e("products.sku","SKU")),s(se,()=>r().sku),s(F,()=>e("inventory.category","Category")),s(le,()=>r().category),s(ve,()=>e("inventory.unitOfMeasure","Unit")),s(ce,()=>r().unitOfMeasure),s(D,()=>e("inventory.unitCost","Cost")),s(Q,()=>m(r().unitCost)),s(j,b(Ne,{get when(){return r().description},get children(){var G=gI(),he=G.firstChild,me=he.nextSibling;return G.style.setProperty("margin-top","1rem"),s(he,()=>e("common.description","Description")),me.style.setProperty("margin-top","0.5rem"),me.style.setProperty("color","var(--text-primary)"),s(me,()=>r().description),re(ee=>u(he,E,ee)),G}}),null),re(G=>{var he=A(r()),me=r().name,ee=oe(),ne=P,Se=E,we=y,ue=P,be=E,de=y,Pe=P,$e=E,xe=y,ke=P,Be=E,Qe=y;return he!==G.e&&ct(N,"src",G.e=he),me!==G.t&&ct(N,"alt",G.t=me),G.a=u(V,ee,G.a),G.o=u(X,ne,G.o),G.i=u(Y,Se,G.i),G.n=u(se,we,G.n),G.s=u(O,ue,G.s),G.h=u(F,be,G.h),G.r=u(le,de,G.r),G.d=u(pe,Pe,G.d),G.l=u(ve,$e,G.l),G.u=u(ce,xe,G.u),G.c=u(H,ke,G.c),G.w=u(D,Be,G.w),G.m=u(Q,Qe,G.m),G},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),x}}),null),s(U,b(Ne,{get when(){return i().length>0},get children(){var x=vI();return u(x,k),s(x,b(pt,{get each(){return i()},children:I=>(()=>{var N=PI(),Z=N.firstChild,j=Z.firstChild,J=Z.nextSibling,w=J.firstChild,V=w.nextSibling,X=V.firstChild,Y=V.nextSibling,se=Y.nextSibling;return N.addEventListener("mouseleave",O=>{O.currentTarget.style.transform="translateY(0)",O.currentTarget.style.boxShadow="var(--shadow-sm)";const F=O.currentTarget.querySelector("img");F&&(F.style.transform="scale(1)")}),N.addEventListener("mouseenter",O=>{O.currentTarget.style.transform="translateY(-4px)",O.currentTarget.style.boxShadow="var(--shadow-lg)";const F=O.currentTarget.querySelector("img");F&&(F.style.transform="scale(1.05)")}),N.$$click=()=>d(I),u(N,R),s(Z,b(Ne,{get when(){return I===r()},get children(){var O=SI();return O.style.setProperty("position","absolute"),O.style.setProperty("top","0.5rem"),O.style.setProperty("right","0.5rem"),O.style.setProperty("background","var(--primary-color)"),O.style.setProperty("color","white"),O.style.setProperty("border-radius","50%"),O.style.setProperty("width","2rem"),O.style.setProperty("height","2rem"),O.style.setProperty("display","flex"),O.style.setProperty("align-items","center"),O.style.setProperty("justify-content","center"),O.style.setProperty("font-size","1.25rem"),O}}),null),u(J,te),s(w,()=>I.name),s(V,()=>I.sku,X),s(V,()=>I.category,null),s(Y,()=>I.unitOfMeasure),u(se,$),s(se,()=>m(I.sellingPrice)),re(O=>{var F=W,le=A(I),pe=I.name,ve=ie,ce=ye,H=I.name,D=ae,Q=ae;return O.e=u(Z,F,O.e),le!==O.t&&ct(j,"src",O.t=le),pe!==O.a&&ct(j,"alt",O.a=pe),O.o=u(j,ve,O.o),O.i=u(w,ce,O.i),H!==O.n&&ct(w,"title",O.n=H),O.s=u(V,D,O.s),O.h=u(Y,Q,O.h),O},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),N})()})),x}}),null),s(U,b(Ne,{get when(){return!r()},get children(){var x=bI(),I=x.firstChild,N=I.nextSibling,Z=N.nextSibling;return u(I,T),N.style.setProperty("margin-bottom","0.5rem"),s(N,()=>e("inventory.noProductsFound","No Products Found")),s(Z,()=>e("inventory.tryDifferentSearch","Try a different search term")),re(j=>u(x,K,j)),x}}),null),re(x=>u(B,L,x)),U})()};At(["click"]);var CI=z("<div><h1></h1><div>"),xr=z("<div>"),AI=z("<div><h3></h3><div>"),II=z("<div>: <!> "),EI=z("<div><button></button><button></button><button></button><button>"),xI=z("<div><div>"),TI=z("<div><span> (<!>)</span><span> / <!> "),$I=z("<div><div><h2></h2></div><div>"),kI=z("<div><div><div><span></span><h3></h3></div><div>  </div><div></div></div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div>:"),RI=z("<div><div><div><div></div><div></div></div><div><div> </div><div></div><div>Min: "),DI=z("<span> LOW");const NI=()=>{const{t}=lt(),[e,r]=ge(!1),[n,i]=ge(!1),[o,a]=ge(!1),[c,d]=ge(null),[h,m]=ge("overview"),[g,_]=ge("new"),[A,M]=ge(""),[L,k]=ge(""),[R,W]=ge([]),[ie,te]=ge(!1),[ye,ae]=ge(!1),[$,S]=ge(!1),[p,C]=ge(!1),[P,E]=ge(!1),[y,oe]=ge(1),[K,T]=ge(20),U=H=>{d(H),a(!0)},B=We(()=>{const H=De.products||[],D=De.movements||[],Q=De.stockLevels||[],G=De.getLowStockProducts(),he=H?.length||0,me=H?.filter(Se=>Se.isActive).length,ee=Q.reduce((Se,we)=>Se*1+we.quantity*1*we.averageCost*1,0),ne=D?.filter(Se=>{const we=new Date(Se.createdDate),ue=new Date;return we.getMonth()===ue.getMonth()&&we.getFullYear()===ue.getFullYear()}).length;return{totalProducts:he,activeProducts:me,lowStockProducts:G.length,totalStockValue:ee,totalMovementsThisMonth:ne,totalLocations:De.locations.length,activeLocations:De.getActiveLocations().length}});We(()=>De.products.map(H=>{const D=De.getStockByProduct(H.id),Q=De.getTotalStockByProduct(H.id),G=De.getLastLocationByProduct(H.id);return{...H,totalStock:Q,stockByLocation:D,lastLocation:G,isLowStock:Q<=H.minStockLevel}})),We(()=>{ye(),oe(1)});const x=(H,D)=>H<=D?t("inventory.lowStockAlert"):H<=D*2?t("inventory.normalStock"):t("inventory.inStock"),I=H=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(H),N=H=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(H),Z=H=>{switch(H){case"warehouse":return t("inventory.warehouse");case"store":return t("inventory.store");case"supplier":return t("inventory.supplier");case"customer":return t("inventory.customer");default:return H}},j={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},J={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},w=H=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500",background:H>50?"#d4edda":H>20?"#fff3cd":"#f8d7da",color:H>50?"#155724":H>20?"#856404":"#721c24"}),V={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},X={color:"var(--text-muted)","font-size":"0.875rem"},Y={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},se={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},O={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},F=H=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:H?"var(--primary-color)":"var(--text-muted)","border-bottom":H?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),le={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem","margin-bottom":"2rem"},pe={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},ve=We(()=>{const H=De.movements;return{total:H.length,stockIn:H.filter(D=>D.movementType==="in").length,stockOut:H.filter(D=>D.movementType==="out").length,transfers:H.filter(D=>D.movementType==="transfer").length,adjustments:H.filter(D=>D.movementType==="adjustment").length,totalValue:H.reduce((D,Q)=>D+Q.totalCost,0)}}),ce=async()=>{let H="prod";await De.fecthInventory(H),await De.fecthProduct(H)};return qr(()=>{ce()}),b(kr,{get title(){return t("inventory.title")},get children(){return[(()=>{var H=CI(),D=H.firstChild,Q=D.nextSibling;return u(H,se),D.style.setProperty("margin","0"),D.style.setProperty("font-size","1.75rem"),Q.style.setProperty("display","flex"),Q.style.setProperty("align-items","center"),Q.style.setProperty("gap","1rem"),s(Q,(()=>{var G=fe(()=>g()==="new");return()=>G()&&b(Le,{variant:"outline",onClick:()=>E(!0),get children(){return[" ",fe(()=>t("inventory.physicalCount","Physical Count"))]}})})(),null),s(Q,b(Ne,{get when(){return vt.hasPermission("read_write")},get children(){return b(Le,{variant:"primary",onClick:()=>i(!0),get children(){return fe(()=>g()==="new")()?t("inventory.addMovement"):t("common.add")}})}}),null),H})(),b(wI,{}),b(Ne,{get when(){return vt.hasPermission("inventoryDownsection")},get children(){return fe(()=>g()==="legacy")()?[(()=>{var H=xr();return s(H,b(tt,{get title(){return t("inventory.totalItems")},get subtitle(){return t("inventory.inStock")},get children(){var D=xr();return D.style.setProperty("font-size","1.5rem"),D.style.setProperty("font-weight","600"),D.style.setProperty("color","var(--primary-color)"),s(D,()=>De.inventory.length),D}}),null),s(H,b(tt,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.itemsBelowThreshold")},get children(){var D=xr();return D.style.setProperty("font-size","1.5rem"),D.style.setProperty("font-weight","600"),D.style.setProperty("color","var(--primary-color)"),s(D,()=>De.getLowStockItems().length),D}}),null),s(H,b(tt,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.inventoryWorth")},get children(){var D=xr();return D.style.setProperty("font-size","1.5rem"),D.style.setProperty("font-weight","600"),D.style.setProperty("color","var(--primary-color)"),s(D,()=>I(De.getTotalValue())),D}}),null),re(D=>u(H,Y,D)),H})(),(()=>{var H=xr();return u(H,j),s(H,b(pt,{get each(){return De.inventory},children:D=>{const Q=x(D.quantity,D.minStock),G=D.quantity<=D.minStock?8:D.quantity<=D.minStock*2?35:75;return b(tt,{onClick:()=>U(D),get children(){return[(()=>{var he=AI(),me=he.firstChild,ee=me.nextSibling;return u(he,J),me.style.setProperty("margin","0"),me.style.setProperty("font-size","1.1rem"),s(me,()=>D.name),s(ee,Q),re(ne=>u(ee,w(G),ne)),he})(),(()=>{var he=xr();return u(he,V),s(he,()=>I(D.price)),he})(),(()=>{var he=II(),me=he.firstChild,ee=me.nextSibling;return ee.nextSibling,u(he,X),s(he,()=>t("inventory.quantity"),me),s(he,()=>D.quantity,ee),s(he,()=>t("common.units"),null),he})()]}})}})),H})()]:[(()=>{var H=EI(),D=H.firstChild,Q=D.nextSibling,G=Q.nextSibling,he=G.nextSibling;return u(H,O),D.$$click=()=>m("overview"),s(D,()=>t("inventory.overview")),Q.$$click=()=>m("products"),s(Q,()=>t("inventory.products")),G.$$click=()=>m("movements"),s(G,()=>t("inventory.movements")),he.$$click=()=>m("locations"),s(he,()=>t("inventory.locations")),re(me=>{var ee=F(h()==="overview"),ne=F(h()==="products"),Se=F(h()==="movements"),we=F(h()==="locations");return me.e=u(D,ee,me.e),me.t=u(Q,ne,me.t),me.a=u(G,Se,me.a),me.o=u(he,we,me.o),me},{e:void 0,t:void 0,a:void 0,o:void 0}),H})(),fe(()=>fe(()=>h()==="overview")()&&(()=>{var H=xI(),D=H.firstChild;return s(D,b(tt,{get title(){return t("inventory.activeProducts")},get subtitle(){return t("inventory.currentlyManaged")},get children(){var Q=xr();return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","var(--primary-color)"),s(Q,()=>B().activeProducts),Q}}),null),s(D,b(tt,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.needAttention")},get children(){var Q=xr();return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","#d32f2f"),s(Q,()=>B().lowStockProducts),Q}}),null),s(D,b(tt,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.currentWorth")},get children(){var Q=xr();return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","var(--primary-color)"),s(Q,()=>N(ve().totalValue)),Q}}),null),s(D,b(tt,{get title(){return t("inventory.movements")},get subtitle(){return t("inventory.thisMonth")},get children(){var Q=xr();return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","var(--primary-color)"),s(Q,()=>B().totalMovementsThisMonth),Q}}),null),s(D,b(tt,{get title(){return t("inventory.activeLocations")},get subtitle(){return t("inventory.warehousesStores")},get children(){var Q=xr();return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","var(--primary-color)"),s(Q,()=>B().activeLocations),Q}}),null),s(H,(()=>{var Q=fe(()=>B().lowStockProducts>0);return()=>Q()&&b(tt,{get title(){return` ${t("inventory.lowStockAlert")}`},get subtitle(){return`${B().lowStockProducts} ${t("inventory.productsNeedRestocking")}`},style:{"margin-bottom":"2rem","border-color":"#ffcdd2",background:"#ffebee"},get children(){var G=xr();return G.style.setProperty("margin-top","1rem"),s(G,b(pt,{get each(){return De.getLowStockProducts().slice(0,9)},children:he=>(()=>{var me=TI(),ee=me.firstChild,ne=ee.firstChild,Se=ne.nextSibling;Se.nextSibling;var we=ee.nextSibling,ue=we.firstChild,be=ue.nextSibling;return be.nextSibling,me.style.setProperty("display","flex"),me.style.setProperty("justify-content","space-between"),me.style.setProperty("margin-bottom","0.5rem"),me.style.setProperty("font-size","0.875rem"),s(ee,()=>he.name,ne),s(ee,()=>he?.sku,Se),we.style.setProperty("color","#d32f2f"),we.style.setProperty("font-weight","600"),s(we,()=>he.currentStock,ue),s(we,()=>he.minStockLevel,be),s(we,()=>t("inventory.min"),null),me})()}),null),s(G,(()=>{var he=fe(()=>De.getLowStockProducts().length>5);return()=>he()&&(()=>{var me=xr();return me.style.setProperty("font-size","0.875rem"),me.style.setProperty("color","var(--text-muted)"),me.style.setProperty("font-style","italic"),s(me,()=>t("common.andMore",{count:De.getLowStockProducts().length-9})),me})()})(),null),G}})})(),null),re(Q=>u(D,Y,Q)),H})()),fe(()=>fe(()=>h()==="products")()&&b(Pg,{})),fe(()=>fe(()=>h()==="movements")()&&b(AA,{})),fe(()=>fe(()=>h()==="locations")()&&(()=>{var H=$I(),D=H.firstChild,Q=D.firstChild,G=D.nextSibling;return D.style.setProperty("display","flex"),D.style.setProperty("justify-content","space-between"),D.style.setProperty("align-items","center"),D.style.setProperty("margin-bottom","1.5rem"),Q.style.setProperty("margin","0"),Q.style.setProperty("font-size","1.5rem"),s(Q,()=>t("inventory.locations")),s(D,b(Ne,{get when(){return vt.hasPermission("read_write")},get children(){return b(Le,{variant:"primary",onClick:()=>S(!0),get children(){return[" ",fe(()=>t("inventory.addLocation"))]}})}}),null),u(G,le),s(G,b(pt,{get each(){return De.getActiveLocations()},children:he=>{const me=De.getStockByLocation(he.id),ee=me.length,ne=me.reduce((we,ue)=>we*1+ue.quantity*1,0),Se=me.reduce((we,ue)=>(De.getProductById(ue.productId),we+(ue?.averageCost||0)),0);return(()=>{var we=kI(),ue=we.firstChild,be=ue.firstChild,de=be.firstChild,Pe=de.nextSibling,$e=be.nextSibling,xe=$e.firstChild,ke=$e.nextSibling,Be=ue.nextSibling,Qe=Be.firstChild,Ue=Qe.firstChild,Te=Ue.firstChild,Fe=Ue.nextSibling,Je=Qe.nextSibling,Ge=Je.firstChild,Xe=Ge.firstChild,Ae=Ge.nextSibling,Ie=Je.nextSibling,Ze=Ie.firstChild,dt=Ze.firstChild,ft=Ze.nextSibling,Tt=Be.nextSibling,_t=Tt.firstChild,Et=_t.firstChild;return ue.style.setProperty("margin-bottom","1rem"),ue.style.setProperty("padding-bottom","1rem"),ue.style.setProperty("border-bottom","1px solid var(--border-color)"),be.style.setProperty("display","flex"),be.style.setProperty("align-items","center"),be.style.setProperty("gap","0.5rem"),be.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-size","1.2rem"),s(de,()=>he.type==="warehouse"?"":he.type==="store"?"":he.type==="supplier"?"":""),Pe.style.setProperty("margin","0"),Pe.style.setProperty("font-size","1.1rem"),s(Pe,()=>he.name),$e.style.setProperty("font-size","0.875rem"),$e.style.setProperty("color","var(--text-muted)"),s($e,()=>he.code,xe),s($e,()=>Z(he.type),null),ke.style.setProperty("font-size","0.75rem"),ke.style.setProperty("color","var(--text-muted)"),ke.style.setProperty("margin-top","0.25rem"),s(ke,()=>he.address),Be.style.setProperty("margin-bottom","1rem"),Qe.style.setProperty("display","flex"),Qe.style.setProperty("justify-content","space-between"),Qe.style.setProperty("margin-bottom","0.5rem"),Ue.style.setProperty("font-size","0.875rem"),Ue.style.setProperty("font-weight","500"),s(Ue,()=>t("inventory.products"),Te),Fe.style.setProperty("font-weight","600"),s(Fe,ee),Je.style.setProperty("display","flex"),Je.style.setProperty("justify-content","space-between"),Je.style.setProperty("margin-bottom","0.5rem"),Ge.style.setProperty("font-size","0.875rem"),Ge.style.setProperty("font-weight","500"),s(Ge,()=>t("inventory.totalItems"),Xe),Ae.style.setProperty("font-weight","600"),Ae.style.setProperty("color","var(--primary-color)"),s(Ae,ne),Ie.style.setProperty("display","flex"),Ie.style.setProperty("justify-content","space-between"),Ie.style.setProperty("margin-bottom","1rem"),Ze.style.setProperty("font-size","0.875rem"),Ze.style.setProperty("font-weight","500"),s(Ze,()=>t("inventory.totalValue"),dt),ft.style.setProperty("font-weight","600"),ft.style.setProperty("color","var(--primary-color)"),s(ft,()=>N(Se)),_t.style.setProperty("font-weight","600"),_t.style.setProperty("margin-bottom","0.75rem"),_t.style.setProperty("font-size","0.875rem"),_t.style.setProperty("color","var(--text-primary)"),_t.style.setProperty("border-bottom","1px solid var(--border-color)"),_t.style.setProperty("padding-bottom","0.5rem"),s(_t,()=>t("inventory.productDetails"),Et),s(Tt,(()=>{var Mt=fe(()=>me.length===0);return()=>Mt()?(()=>{var it=xr();return it.style.setProperty("text-align","center"),it.style.setProperty("color","var(--text-muted)"),it.style.setProperty("font-style","italic"),it.style.setProperty("padding","1rem"),s(it,()=>t("inventory.noProducts")),it})():(()=>{var it=xr();return it.style.setProperty("max-height","200px"),it.style.setProperty("overflow-y","auto"),it.style.setProperty("border","1px solid var(--border-color)"),it.style.setProperty("border-radius","var(--border-radius-sm)"),s(it,b(pt,{each:me,children:Vt=>{const It=De.getProductById(Vt.productId);if(!It)return null;const je=Vt.quantity<=It.minStockLevel,Oe=Vt.averageCost;return Vt.quantity?(()=>{var Me=RI(),He=Me.firstChild,nt=He.firstChild,mt=nt.firstChild,Ke=mt.nextSibling,et=nt.nextSibling,st=et.firstChild,St=st.firstChild,yt=st.nextSibling,Xt=yt.nextSibling;return Xt.firstChild,Me.style.setProperty("padding","0.75rem"),Me.style.setProperty("border-bottom","1px solid var(--border-color)"),(je?"#fff5f5":"transparent")!=null?Me.style.setProperty("background",je?"#fff5f5":"transparent"):Me.style.removeProperty("background"),Me.style.setProperty("transition","background-color 0.2s ease"),He.style.setProperty("display","flex"),He.style.setProperty("justify-content","space-between"),He.style.setProperty("align-items","flex-start"),He.style.setProperty("margin-bottom","0.25rem"),nt.style.setProperty("flex","1"),mt.style.setProperty("font-weight","500"),mt.style.setProperty("font-size","0.875rem"),(je?"#d32f2f":"var(--text-primary)")!=null?mt.style.setProperty("color",je?"#d32f2f":"var(--text-primary)"):mt.style.removeProperty("color"),s(mt,()=>It.name,null),s(mt,je&&(()=>{var Nt=DI();return Nt.style.setProperty("margin-left","0.5rem"),Nt.style.setProperty("font-size","0.7rem"),Nt.style.setProperty("color","#d32f2f"),Nt})(),null),Ke.style.setProperty("font-size","0.75rem"),Ke.style.setProperty("color","var(--text-muted)"),Ke.style.setProperty("margin-top","0.1rem"),s(Ke,()=>It.sku,null),s(Ke,()=>It.UPC?"  "+It.UPC:"",null),s(Ke,()=>It.category?"  "+It.category:"",null),et.style.setProperty("text-align","right"),st.style.setProperty("font-weight","600"),st.style.setProperty("font-size","0.875rem"),(je?"#d32f2f":"var(--primary-color)")!=null?st.style.setProperty("color",je?"#d32f2f":"var(--primary-color)"):st.style.removeProperty("color"),s(st,()=>Vt.quantity,St),s(st,()=>It.unitOfMeasure,null),yt.style.setProperty("font-size","0.75rem"),yt.style.setProperty("color","var(--text-muted)"),s(yt,()=>N(Oe)),Xt.style.setProperty("font-size","0.7rem"),Xt.style.setProperty("color","var(--text-muted)"),Xt.style.setProperty("margin-top","0.1rem"),s(Xt,()=>It.minStockLevel,null),Me})():null}})),it})()})(),null),re(Mt=>u(we,{...pe,"min-height":"400px"},Mt)),we})()}})),H})())]}}),b(Ne,{get when(){return vt.hasPermission("read_write")},get children(){return[b(FC,{get isOpen(){return e()},onClose:()=>r(!1),get mode(){return g()==="new"?"movement":"legacy"}}),b(YC,{get isOpen(){return n()},onClose:()=>i(!1)}),b(XC,{get isOpen(){return o()},onClose:()=>a(!1),get item(){return c()}}),b(Tu,{get isOpen(){return $()},onClose:()=>S(!1),onLocationAdded:()=>{S(!1)}})]}}),b(OA,{get isOpen(){return P()},onClose:()=>E(!1)})]}})};At(["click"]);var LI=z("<div><div>"),MI=z("<div> "),OI=z("<div><div><label></label><select><option value=all></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date>"),fi=z("<div>"),VI=z("<button> "),BI=z("<option>"),FI=z("<div><div></div><div></div><div></div><div>"),im=z("<div><span></span><span> "),UI=z("<div><span></span><span> $");const jI=t=>{const{t:e}=lt(),[r,n]=ge(!1),[i,o]=ge("all"),[a,c]=ge(""),[d,h]=ge(""),[m,g]=ge(null),[_,A]=ge("dashboard"),[M,L]=ge([]);qr(async()=>{try{t.invoices||console.log("fetchInvoices"),await Br.fetchInvoices();try{const B=await Br.fetchStores();let x=Array.isArray(B)?B:Object.keys(B)||[];console.log(x)}catch{const x=Br.state.invoices||t.invoices,I=[...new Set(x.map(N=>N.store))];L(I.sort())}}catch(B){console.error("Error loading dashboard data:",B)}}),We(()=>Br.state.invoices||t.invoices);const k=We(()=>t.invoices?Br.getFilteredInvoices({store:i(),dateFrom:a(),dateTo:d()}):Br.getFilteredInvoices({store:i(),dateFrom:a(),dateTo:d()})),R=async()=>{try{t.invoices,n(!0),await Br.refreshData({store:i()!=="all"?i():void 0,dateFrom:a()||void 0,dateTo:d()||void 0}),n(!1)}catch(B){console.error("Error refreshing data:",B)}},W=We(()=>{console.log("summary",r()),r();const B=k(),x=Br.calculateSummary(B);let I=new Map,N=new Map,Z=new Map;return B.forEach(j=>{j?.products?.forEach(J=>{const w=Math.abs(J.qty),V=J.product.label;I.set(V,(I.get(V)||0)+w)}),j?.reservas?.forEach(J=>{let w=parseInt(J.qty);isNaN(w)&&(w=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[J.type]||J?.onlyTariff?(w=parseFloat(J.arancel)||parseFloat(J.qty)*parseFloat(J.price),Z.set(J.type,(N.get(J.type)||0)+w)):N.set(J.type,(N.get(J.type)||0)+w)})}),{...x,productsByCategory:I,reservasByType:N,othersByType:Z}}),ie=B=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(B),te={padding:"2rem"},ye={display:"flex",gap:"1rem","align-items":"flex-end","margin-bottom":"2rem","flex-wrap":"wrap",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)"},ae={display:"flex","flex-direction":"column",gap:"0.5rem",flex:"1","min-width":"200px"},$={"font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)"},S={padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--background-color)"},p={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(280px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},C={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)"},P={width:"48px",height:"48px","border-radius":"12px",display:"flex","align-items":"center","justify-content":"center","font-size":"1.5rem","margin-bottom":"1rem"},E={"font-size":"0.875rem",color:"var(--text-secondary)","margin-bottom":"0.5rem"},y={"font-size":"1.75rem","font-weight":"700",color:"var(--text-primary)","margin-bottom":"0.25rem"},oe={"font-size":"0.75rem",color:"var(--text-muted)"},K={padding:"0.75rem 1.5rem",background:"var(--secondary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","margin-bottom":"1rem",display:"flex","align-items":"center",gap:"0.5rem"},T=()=>[{title:e("invoices.totalRevenue"),value:W().grandTotal,icon:"",color:"#4CAF50",subtext:`${e("common.of")} ${W().totalInvoices} ${e("common.invoice")} `},{title:e("invoices.totalProducts"),value:W().totalProducts,icon:"",color:"#2196F3",subtext:`${ie(W().totalProductAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.totalReservations"),value:W().totalReservas,icon:"",color:"#FF9800",subtext:`${ie(W().totalReservaAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.aranceles"),value:W().totalAranceles,icon:"",color:"#9C27B0",subtext:e("invoices.customsFees")},{title:e("invoices.uniqueCustomers"),value:W().uniqueCustomers,icon:"",color:"#00BCD4",subtext:e("invoices.activeCustomers"),isNumber:!0},{title:e("invoices.averageInvoice"),value:W().avgInvoiceValue,icon:"",color:"#FF5722",subtext:e("invoices.perInvoiceValue")},{title:e("invoices.completed"),value:W().completedInvoices,icon:"",color:"#4CAF50",subtext:`${W().pendingInvoices} ${e("invoices.pending")}`,isNumber:!0},{title:e("invoices.storesActive"),value:M().length,icon:"",color:"#795548",subtext:e("invoices.locations"),isNumber:!0}],U=()=>De.getActiveLocations();return Dn(()=>{}),b(kr,{get title(){return e("invoices.title")},get children(){var B=fi();return u(B,te),s(B,b(Ne,{get when(){return _()==="dashboard"},get children(){return[b(Ne,{get when(){return!t.invoices&&Br.state.loading},get children(){var x=LI(),I=x.firstChild;return x.style.setProperty("text-align","center"),x.style.setProperty("padding","2rem"),I.style.setProperty("font-size","1.25rem"),I.style.setProperty("margin-bottom","1rem"),s(I,()=>e("invoices.loadingInvoices")),x}}),b(Ne,{get when(){return Br.state.error},get children(){var x=MI();return x.firstChild,x.style.setProperty("padding","1rem"),x.style.setProperty("margin-bottom","1rem"),x.style.setProperty("background","#ffebee"),x.style.setProperty("border","1px solid #ffcdd2"),x.style.setProperty("border-radius","var(--border-radius)"),x.style.setProperty("color","#d32f2f"),s(x,()=>Br.state.error,null),s(x,b(Le,{variant:"outline",size:"sm",onClick:R,style:{"margin-left":"1rem"},get children(){return e("invoices.refreshData")}}),null),x}}),(()=>{var x=OI(),I=x.firstChild,N=I.firstChild,Z=N.nextSibling,j=Z.firstChild,J=I.nextSibling,w=J.firstChild,V=w.nextSibling,X=J.nextSibling,Y=X.firstChild,se=Y.nextSibling;return u(x,ye),s(N,()=>e("invoices.storeLocation")),Z.addEventListener("change",O=>o(O.currentTarget.value)),s(j,()=>e("invoices.allStores")),s(Z,b(pt,{get each(){return U()},children:O=>(()=>{var F=BI();return s(F,()=>O.name),re(()=>F.value=O.id),F})()}),null),s(w,()=>e("invoices.fromDate")),V.addEventListener("change",O=>c(O.currentTarget.value)),s(Y,()=>e("invoices.toDate")),se.addEventListener("change",O=>h(O.currentTarget.value)),s(x,b(Le,{variant:"secondary",onClick:()=>{o("all"),c(""),h("")},get children(){return e("invoices.clearFilters")}}),null),s(x,b(Le,{variant:"primary",onClick:R,get disabled(){return!t.invoices&&Br.state.loading},get children(){return[" ",fe(()=>e("invoices.refreshData"))]}}),null),re(O=>{var F=ae,le=$,pe=S,ve=ae,ce=$,H=S,D=ae,Q=$,G=S;return O.e=u(I,F,O.e),O.t=u(N,le,O.t),O.a=u(Z,pe,O.a),O.o=u(J,ve,O.o),O.i=u(w,ce,O.i),O.n=u(V,H,O.n),O.s=u(X,D,O.s),O.h=u(Y,Q,O.h),O.r=u(se,G,O.r),O},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),re(()=>Z.value=i()),re(()=>V.value=a()),re(()=>se.value=d()),x})(),(()=>{var x=fi();return u(x,p),s(x,b(pt,{get each(){return T()},children:I=>(()=>{var N=FI(),Z=N.firstChild,j=Z.nextSibling,J=j.nextSibling,w=J.nextSibling;return u(N,C),s(Z,()=>I?.icon),u(j,E),s(j,()=>I?.title),u(J,y),s(J,(()=>{var V=fe(()=>!!I.isNumber);return()=>V()?I.value:ie(I.value)})()),u(w,oe),s(w,()=>I.subtext),re(V=>u(Z,{...P,background:`${I?.color}20`,color:I?.color},V)),N})()})),x})(),b(Ne,{get when(){return W()?.productsByCategory?.size>0},get children(){return b(tt,{get title(){return e("invoices.topProducts")},get subtitle(){return e("invoices.mostSoldProducts")},get children(){var x=fi();return x.style.setProperty("max-height","300px"),x.style.setProperty("overflow-y","auto"),s(x,()=>Array.from(W().productsByCategory.entries()).sort((I,N)=>N[1]-I[1]).slice(0,10).map(([I,N])=>(()=>{var Z=im(),j=Z.firstChild,J=j.nextSibling,w=J.firstChild;return Z.style.setProperty("display","flex"),Z.style.setProperty("justify-content","space-between"),Z.style.setProperty("padding","0.75rem"),Z.style.setProperty("border-bottom","1px solid var(--border-color)"),s(j,I),J.style.setProperty("font-weight","600"),s(J,N,w),s(J,()=>e("common.units"),null),Z})())),x}})}}),(()=>{var x=fi();return x.style.setProperty("margin","19px"),x})(),b(Ne,{get when(){return W()?.reservasByType?.size>0},get children(){return b(tt,{get title(){return e("invoices.reservationsByType")},get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var x=fi();return x.style.setProperty("max-height","300px"),x.style.setProperty("overflow-y","auto"),s(x,()=>Array.from(W().reservasByType.entries()).sort((I,N)=>N[1]-I[1]).map(([I,N])=>(()=>{var Z=im(),j=Z.firstChild,J=j.nextSibling,w=J.firstChild;return Z.style.setProperty("display","flex"),Z.style.setProperty("justify-content","space-between"),Z.style.setProperty("padding","0.75rem"),Z.style.setProperty("border-bottom","1px solid var(--border-color)"),s(j,I),J.style.setProperty("font-weight","600"),s(J,N,w),s(J,()=>e("common.lbs"),null),Z})())),x}})}}),(()=>{var x=fi();return x.style.setProperty("margin","19px"),x})(),b(Ne,{get when(){return W()?.othersByType?.size>0},get children(){return b(tt,{title:"Aranceles y otros servicios",get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var x=fi();return x.style.setProperty("max-height","300px"),x.style.setProperty("overflow-y","auto"),s(x,()=>Array.from(W().othersByType.entries()).sort((I,N)=>N[1]-I[1]).map(([I,N])=>(()=>{var Z=UI(),j=Z.firstChild,J=j.nextSibling,w=J.firstChild;return Z.style.setProperty("display","flex"),Z.style.setProperty("justify-content","space-between"),Z.style.setProperty("padding","0.75rem"),Z.style.setProperty("border-bottom","1px solid var(--border-color)"),s(j,I),J.style.setProperty("font-weight","600"),s(J,N,w),Z})())),x}})}})]}}),null),s(B,b(Ne,{get when(){return fe(()=>_()==="detail")()&&m()},get children(){return[(()=>{var x=VI();return x.firstChild,x.$$click=()=>{A("dashboard"),g(null)},u(x,K),s(x,()=>e("invoices.backToDashboard"),null),x})(),b(mC,{get invoice(){return m()},onPrint:()=>window.print(),onExport:()=>console.log("Export PDF")})]}}),null),B}})};At(["click"]);const zI=()=>b(jI,{invoices:[{type:"SALES",invoice:"20255FK6S4B43SSS",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCim",ssg_sorder_key:"JqdrRwGBpdBfRCim",createDate:1736132690425,shipper_consignee:{name:"Yudith Perez Medero",phoneNumberS:"5022408378",dob:"1982-07-23",firstName:"RAUL",lastName:"BATISTA",lastName2:"ESPOSITO",middleName:"",email:"",phoneNumber:"52393232",altPhoneNumber:"",cid:"48121007305",ybstreetNo:"9",ybstreet:"10",ybbetwen1:"CARRALERO",ybbetwen2:"3RA",ybapt:"",ybreparto:"PUEBLO NUEVO",consigneeId:"26144",ssg_consignee_key:"26144",passport:"NA",nacionality:"CUB",ybcity:"HOLGUIN",ybestate:"HOLGUIN",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534800",reservas:[{type:"UTILES DEL HOGAR",qty:"15",arancel:"10",price:"5",key:"1GB16SD80"},{type:"MISCELANEAS",qty:"19",arancel:"",price:"4",key:"0DS6K14Y2"}],products:[{product:{id:"CmrhMfVjLR9HxT6P",label:"FOGONES ELECTRICO DOBLE RESISTENCIA DE ALAMBRE",code:"978Y82K94"},qty:-1,price:23.696296296296296,salePrice:"34"},{product:{id:"ov56aPYGbXIq4XGy",label:"Caramelos",code:"C852CSKB5"},qty:-2,price:5.990000000000001,salePrice:"10"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43TTT",description:"",store:"YY_8803",ssg_inventory_key:"JqdrRwGBpdBfRCin",ssg_sorder_key:"JqdrRwGBpdBfRCin",createDate:1736032690425,shipper_consignee:{name:"Maria Rodriguez Santos",phoneNumberS:"5024567890",dob:"1990-03-15",firstName:"MARIA",lastName:"RODRIGUEZ",lastName2:"SANTOS",middleName:"ELENA",email:"maria@email.com",phoneNumber:"52987654",altPhoneNumber:"",cid:"90031507890",ybstreetNo:"15",ybstreet:"23",ybbetwen1:"MARTI",ybbetwen2:"CESPEDES",ybapt:"2A",ybreparto:"CENTRO",consigneeId:"26145",ssg_consignee_key:"26145",passport:"A1234567",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534801",reservas:[{type:"ELECTRONICOS",qty:"5",arancel:"15",price:"12",key:"2GB16SD81"},{type:"ROPA Y CALZADO",qty:"8",arancel:"8",price:"7",key:"0DS6K14Y3"}],products:[{product:{id:"XmrhMfVjLR9HxT6Q",label:"TELEVISOR LED 32 PULGADAS",code:"TV32LED01"},qty:-1,price:150.5,salePrice:"220"},{product:{id:"Yv56aPYGbXIq4XGz",label:"Zapatos Deportivos Nike",code:"ZAP001"},qty:-1,price:45.99,salePrice:"75"}],isCompleted:!1},{type:"SALES",invoice:"20255FK6S4B43UUU",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCio",ssg_sorder_key:"JqdrRwGBpdBfRCio",createDate:1735932690425,shipper_consignee:{name:"Carlos Mendez Perez",phoneNumberS:"5025678901",dob:"1975-12-08",firstName:"CARLOS",lastName:"MENDEZ",lastName2:"PEREZ",middleName:"ANTONIO",email:"",phoneNumber:"52876543",altPhoneNumber:"",cid:"75120878901",ybstreetNo:"7",ybstreet:"45",ybbetwen1:"LINEA",ybbetwen2:"PASEO",ybapt:"",ybreparto:"VEDADO",consigneeId:"26146",ssg_consignee_key:"26146",passport:"NA",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534802",reservas:[{type:"ALIMENTOS",qty:"25",arancel:"5",price:"3",key:"3GB16SD82"}],products:[{product:{id:"ZmrhMfVjLR9HxT6R",label:"ARROZ ESPECIAL 5LB",code:"ARZ005"},qty:-5,price:2.5,salePrice:"4"},{product:{id:"Av56aPYGbXIq4XG1",label:"ACEITE DE COCINA 1L",code:"ACE001"},qty:-3,price:3.75,salePrice:"6"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43VVV",description:"",store:"YY_8802",ssg_inventory_key:"JqdrRwGBpdBfRCip",ssg_sorder_key:"JqdrRwGBpdBfRCip",createDate:1735832690425,shipper_consignee:{name:"Ana Lucia Fernandez",phoneNumberS:"5026789012",dob:"1988-06-20",firstName:"ANA",lastName:"FERNANDEZ",lastName2:"LOPEZ",middleName:"LUCIA",email:"ana.lucia@email.com",phoneNumber:"52765432",altPhoneNumber:"52111222",cid:"88062076789",ybstreetNo:"12",ybstreet:"18",ybbetwen1:"CALZADA",ybbetwen2:"SAN LAZARO",ybapt:"3B",ybreparto:"CENTRO HABANA",consigneeId:"26147",ssg_consignee_key:"26147",passport:"B9876543",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:"Entrega en horario de oficina"},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534803",reservas:[{type:"MEDICINA Y SALUD",qty:"10",arancel:"12",price:"8",key:"4GB16SD83"},{type:"UTILES DEL HOGAR",qty:"6",arancel:"6",price:"4",key:"5GB16SD84"}],products:[{product:{id:"BmrhMfVjLR9HxT6S",label:"VITAMINAS MULTIPLES 60 CAP",code:"VIT001"},qty:-2,price:12.5,salePrice:"18"}],isCompleted:!0}]});var qI=z("<div>$124,350"),GI=z("<div>+12% from last month"),HI=z("<div>247"),Ui=z("<div>"),YI=z("<div>18"),WI=z("<div>$89,250"),KI=z("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const QI=()=>{const{t}=lt(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},n={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)",margin:"0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"};return b(kr,{get title(){return t("dashboard.title")},get children(){return[(()=>{var o=Ui();return u(o,e),s(o,b(tt,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var a=qI();return re(c=>u(a,n,c)),a})(),(()=>{var a=GI();return re(c=>u(a,i,c)),a})()]}}),null),s(o,b(tt,{get title(){return t("dashboard.employeeCount")},get subtitle(){return t("dashboard.current")},get children(){return[(()=>{var a=HI();return re(c=>u(a,n,c)),a})(),(()=>{var a=Ui();return s(a,()=>t("dashboard.newHires")),re(c=>u(a,i,c)),a})()]}}),null),s(o,b(tt,{get title(){return t("dashboard.pendingInvoices")},get subtitle(){return t("dashboard.outstanding")},get children(){return[(()=>{var a=YI();return re(c=>u(a,n,c)),a})(),(()=>{var a=Ui();return s(a,()=>t("dashboard.totalOutstanding")),re(c=>u(a,i,c)),a})()]}}),null),s(o,b(tt,{get title(){return t("dashboard.cashBalance")},get subtitle(){return t("accounts.title")},get children(){return[(()=>{var a=WI();return re(c=>u(a,n,c)),a})(),(()=>{var a=Ui();return s(a,()=>t("dashboard.lastUpdatedToday")),re(c=>u(a,i,c)),a})()]}}),null),o})(),(()=>{var o=Ui();return u(o,r),s(o,b(tt,{get title(){return t("dashboard.quickActions")},get subtitle(){return t("dashboard.commonTasks")},get children(){var a=Ui();return a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("gap","1rem"),s(a,b(Le,{variant:"primary",get children(){return t("invoices.createNew")}}),null),s(a,b(Le,{variant:"secondary",get children(){return t("employees.addEmployee")}}),null),s(a,b(Le,{variant:"outline",get children(){return t("dashboard.generateReport")}}),null),a}}),null),s(o,b(tt,{get title(){return t("dashboard.recentActivity")},get subtitle(){return t("dashboard.latestUpdates")},get children(){var a=KI(),c=a.firstChild,d=c.firstChild,h=d.nextSibling,m=c.nextSibling,g=m.firstChild,_=g.nextSibling,A=m.nextSibling,M=A.firstChild,L=M.nextSibling;return a.style.setProperty("display","flex"),a.style.setProperty("flex-direction","column"),a.style.setProperty("gap","0.75rem"),c.style.setProperty("border-bottom","1px solid var(--border-color)"),c.style.setProperty("padding-bottom","0.5rem"),d.style.setProperty("font-weight","500"),s(d,()=>t("dashboard.invoicePaid")),h.style.setProperty("font-size","0.875rem"),h.style.setProperty("color","var(--text-muted)"),s(h,()=>t("dashboard.hoursAgo")),m.style.setProperty("border-bottom","1px solid var(--border-color)"),m.style.setProperty("padding-bottom","0.5rem"),g.style.setProperty("font-weight","500"),s(g,()=>t("dashboard.newEmployeeOnboarded")),_.style.setProperty("font-size","0.875rem"),_.style.setProperty("color","var(--text-muted)"),s(_,()=>t("dashboard.dayAgo")),M.style.setProperty("font-weight","500"),s(M,()=>t("dashboard.monthlyReportGenerated")),L.style.setProperty("font-size","0.875rem"),L.style.setProperty("color","var(--text-muted)"),s(L,()=>t("dashboard.daysAgo")),a}}),null),o})(),b(Ne,{get when(){return vt.hasPermission("invoiceAccess")},get children(){return b(zI,{})}})]}})},JI=[{id:"1",accountNumber:"1000",name:"Cash and Cash Equivalents",type:"Asset",category:"Current Assets",description:"Cash on hand and in bank accounts",balance:45230.5,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1001",accountNumber:"1001",name:"Petty Cash",type:"Asset",category:"Current Assets",description:"Small amounts of cash for minor expenses",balance:500,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1002",accountNumber:"1002",name:"Bank - Checking Account",type:"Asset",category:"Current Assets",description:"Main operating checking account",balance:32730.5,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1003",accountNumber:"1003",name:"Bank - Savings Account",type:"Asset",category:"Current Assets",description:"Interest-bearing savings account",balance:12e3,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"2",accountNumber:"1100",name:"Accounts Receivable",type:"Asset",category:"Current Assets",description:"Money owed by customers",balance:23450.75,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2001",accountNumber:"1101",name:"Trade Receivables",type:"Asset",category:"Current Assets",description:"Receivables from regular customers",balance:18450.75,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2002",accountNumber:"1102",name:"Employee Advances",type:"Asset",category:"Current Assets",description:"Money advanced to employees",balance:5e3,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"3",accountNumber:"1200",name:"Inventory",type:"Asset",category:"Current Assets",description:"Products held for sale",balance:78920.25,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-13"},{id:"4",accountNumber:"1500",name:"Equipment",type:"Asset",category:"Fixed Assets",description:"Office equipment and machinery",balance:125e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-12"},{id:"5",accountNumber:"2000",name:"Accounts Payable",type:"Liability",category:"Current Liabilities",description:"Money owed to suppliers",balance:15670.3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-11"},{id:"6",accountNumber:"2100",name:"Accrued Expenses",type:"Liability",category:"Current Liabilities",description:"Expenses incurred but not yet paid",balance:8945.6,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-10"},{id:"7",accountNumber:"2500",name:"Long-term Debt",type:"Liability",category:"Long-term Liabilities",description:"Long-term loans and mortgages",balance:85e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-09"},{id:"8",accountNumber:"3000",name:"Owner's Equity",type:"Equity",category:"Owner's Equity",description:"Owner's investment in the business",balance:15e4,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-08"},{id:"9",accountNumber:"3100",name:"Retained Earnings",type:"Equity",category:"Owner's Equity",description:"Accumulated profits retained in business",balance:32450.8,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-07"},{id:"10",accountNumber:"4000",name:"Sales Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from product sales",balance:245678.9,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-06"},{id:"11",accountNumber:"4100",name:"Service Revenue",type:"Revenue",category:"Operating Revenue",description:"Revenue from services provided",balance:89432.15,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-05"},{id:"12",accountNumber:"5000",name:"Cost of Goods Sold",type:"Expense",category:"Operating Expenses",description:"Direct costs of producing goods",balance:125678.45,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-04"},{id:"13",accountNumber:"5100",name:"Salaries Expense",type:"Expense",category:"Operating Expenses",description:"Employee salary expenses",balance:98765.32,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-03"},{id:"14",accountNumber:"5200",name:"Rent Expense",type:"Expense",category:"Operating Expenses",description:"Office rent expenses",balance:24e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-02"}],XI=[{id:"1",accountId:"1",date:"2024-01-15",description:"Customer payment received",debitAmount:5e3,creditAmount:0,reference:"INV-2024-001",type:"debit"},{id:"2",accountId:"2",date:"2024-01-15",description:"Customer payment received",debitAmount:0,creditAmount:5e3,reference:"INV-2024-001",type:"credit"},{id:"3",accountId:"5",date:"2024-01-14",description:"Office supplies purchased",debitAmount:0,creditAmount:1250,reference:"PO-2024-001",type:"credit"}],[nn,qs]=ge(JI),[xl,ZI]=ge(XI),bt={get accounts(){return nn()},get transactions(){return xl()},fetchAllAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return qs([...nn(),e]),e},addAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return qs([...nn(),e]),e},updateAccount(t,e){qs(nn().map(r=>r.id===t?{...r,...e,lastModified:new Date().toISOString().split("T")[0]}:r))},deleteAccount(t){qs(nn().filter(e=>e.id!==t))},getAccountById(t){return nn().find(e=>e.id===t)},getAccountsByType(t){return nn().filter(e=>e.type===t)},getAccountTransactions(t){return xl().filter(e=>e.accountId===t)},addTransaction(t){const e={...t,id:Date.now().toString()};ZI([...xl(),e]);const r=this.getAccountById(t.accountId);if(r){const n=t.type==="debit"?t.debitAmount:-t.creditAmount;this.updateAccount(t.accountId,{balance:r.balance+n})}return e},getTotalByType(t){return nn().filter(e=>e.type===t&&e.isActive).reduce((e,r)=>e+r.balance,0)},getAccountCategories(t){const e=this.getAccountsByType(t);return[...new Set(e.map(r=>r.category))]},getSubAccounts(t){return nn().filter(e=>e.parentAccountId===t)},getParentAccounts(){return nn().filter(t=>!t.parentAccountId)},getAccountHierarchy(){return this.getParentAccounts().map(e=>({...e,subAccounts:this.getSubAccounts(e.id)}))},getAccountWithSubAccounts(t){const e=this.getAccountById(t);return e?{...e,subAccounts:this.getSubAccounts(t),parentAccount:e.parentAccountId?this.getAccountById(e.parentAccountId):null}:null},getAccountPath(t){const e=this.getAccountById(t);if(!e)return[];const r=[e];let n=e;for(;n.parentAccountId;){const i=this.getAccountById(n.parentAccountId);if(i)r.unshift(i),n=i;else break}return r},getTotalBalanceWithSubAccounts(t){const e=this.getAccountById(t);if(!e)return 0;const n=this.getSubAccounts(t).reduce((i,o)=>i+this.getTotalBalanceWithSubAccounts(o.id),0);return e.balance+n},canDeleteAccount(t){const e=this.getSubAccounts(t);if(e.length>0)return{canDelete:!1,reason:`Account has ${e.length} sub-account(s). Delete or move sub-accounts first.`};const r=this.getAccountTransactions(t);return r.length>0?{canDelete:!1,reason:`Account has ${r.length} transaction(s). Cannot delete account with transaction history.`}:{canDelete:!0}}};var Fn=z("<div>"),To=z("<div> ");const eE=()=>{const{t}=lt(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},n={"font-size":"0.875rem",color:"var(--text-muted)"},i=L=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(L),o=bt.getTotalByType("Asset"),a=bt.getTotalByType("Liability"),c=bt.getTotalByType("Equity"),d=bt.getTotalByType("Revenue"),h=bt.getTotalByType("Expense"),m=bt.getAccountsByType("Asset").length,g=bt.getAccountsByType("Liability").length,_=bt.getAccountsByType("Equity").length,A=bt.getAccountsByType("Revenue").length,M=bt.getAccountsByType("Expense").length;return(()=>{var L=Fn();return u(L,e),s(L,b(tt,{get title(){return t("dashboard.totalAssets")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var k=Fn();return s(k,()=>i(o)),re(R=>u(k,r,R)),k})(),(()=>{var k=To(),R=k.firstChild;return s(k,m,R),s(k,()=>t("navigation.accounts"),null),re(W=>u(k,n,W)),k})()]}}),null),s(L,b(tt,{get title(){return t("dashboard.totalLiabilities")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var k=Fn();return s(k,()=>i(a)),re(R=>u(k,r,R)),k})(),(()=>{var k=To(),R=k.firstChild;return s(k,g,R),s(k,()=>t("navigation.accounts"),null),re(W=>u(k,n,W)),k})()]}}),null),s(L,b(tt,{get title(){return t("dashboard.totalEquity")},get subtitle(){return t("accounts.categories.ownersEquity")},get children(){return[(()=>{var k=Fn();return s(k,()=>i(c)),re(R=>u(k,r,R)),k})(),(()=>{var k=To(),R=k.firstChild;return s(k,_,R),s(k,()=>t("navigation.accounts"),null),re(W=>u(k,n,W)),k})()]}}),null),s(L,b(tt,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("accounts.categories.operatingRevenue")},get children(){return[(()=>{var k=Fn();return s(k,()=>i(d)),re(R=>u(k,r,R)),k})(),(()=>{var k=To(),R=k.firstChild;return s(k,A,R),s(k,()=>t("navigation.accounts"),null),re(W=>u(k,n,W)),k})()]}}),null),s(L,b(tt,{get title(){return t("dashboard.totalExpenses")},get subtitle(){return t("accounts.categories.operatingExpenses")},get children(){return[(()=>{var k=Fn();return s(k,()=>i(h)),re(R=>u(k,r,R)),k})(),(()=>{var k=To(),R=k.firstChild;return s(k,M,R),s(k,()=>t("navigation.accounts"),null),re(W=>u(k,n,W)),k})()]}}),null),s(L,b(tt,{get title(){return t("dashboard.netIncome")},get subtitle(){return`${t("dashboard.totalRevenue")} - ${t("dashboard.totalExpenses")}`},get children(){return[(()=>{var k=Fn();return s(k,()=>i(d-h)),re(R=>u(k,{...r,color:d-h>=0?"#4caf50":"#f44336"},R)),k})(),(()=>{var k=Fn();return s(k,()=>d-h>=0?t("dashboard.netIncome"):t("dashboard.netLoss")),re(R=>u(k,n,R)),k})()]}}),null),L})()};var tE=z("<div><div></div><div>"),rE=z("<h3>"),$o=z("<div>");const nE=t=>{const{t:e}=lt();$c();const r={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},i={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"},o={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},a={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},c={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem"},d={"font-size":"0.875rem",color:"var(--text-secondary)","line-height":"1.4"},h=_=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[_]||{bg:"#f5f5f5",color:"#666"},m=_=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(_),g=h(t.account.type);return b(tt,{get children(){return[(()=>{var _=tE(),A=_.firstChild,M=A.nextSibling;return u(_,n),u(A,i),s(A,()=>t.account.accountNumber),s(M,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),re(L=>u(M,{...o,background:g.bg,color:g.color},L)),_})(),(()=>{var _=rE();return _.style.setProperty("margin","0 0 0.5rem 0"),_.style.setProperty("font-size","1.1rem"),s(_,()=>t.account.name),_})(),(()=>{var _=$o();return u(_,c),s(_,()=>t.account.category),_})(),(()=>{var _=$o();return u(_,a),s(_,()=>m(t.account.balance)),_})(),(()=>{var _=$o();return u(_,d),s(_,()=>t.account.description),_})(),fe(()=>fe(()=>!t.account.isActive)()&&(()=>{var _=$o();return _.style.setProperty("margin-top","0.5rem"),_.style.setProperty("padding","0.25rem 0.75rem"),_.style.setProperty("border-radius","9999px"),_.style.setProperty("font-size","0.75rem"),_.style.setProperty("font-weight","500"),_.style.setProperty("background","#ffebee"),_.style.setProperty("color","#d32f2f"),_.style.setProperty("text-align","center"),s(_,()=>e("common.inactive")),_})()),(()=>{var _=$o();return u(_,r),s(_,b(Le,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.account),get children(){return[fe(()=>e("common.view"))," ",fe(()=>e("accounts.accountDetails"))]}})),_})()]}})};var iE=z("<div><div><div><div></div><h3></h3></div></div><div><div></div><div>"),oE=z("<div>"),sE=z("<button>"),aE=z("<div><h4> (<!>)"),lE=z("<div><div><div></div><div>  </div></div><div>");const cE=t=>{const{t:e}=lt(),r=$c(),[n,i]=ge(!0),o={"margin-bottom":"1rem"},a={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},c={display:"flex","align-items":"center",gap:"1rem"},d={background:"none",border:"none",cursor:"pointer","font-size":"1.2rem",color:"var(--text-muted)",padding:"0.25rem","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease"},h={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},m={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},g={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},_={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},A={"margin-left":"1rem","border-left":"2px solid var(--border-color)","padding-left":"1rem","margin-top":"1rem"},M={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem","margin-bottom":"0.5rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},L={flex:"1"},k={"font-weight":"500","margin-bottom":"0.25rem"},R={"font-size":"0.875rem",color:"var(--text-muted)"},W={"font-weight":"600",color:"var(--primary-color)"},ie={display:"flex",gap:"0.5rem"},te=C=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[C]||{bg:"#f5f5f5",color:"#666"},ye=C=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(C),ae=C=>{t.onViewDetails?t.onViewDetails(C):r(`/accounts/${C.id}`)},$=()=>{t.onAddSubAccount&&t.onAddSubAccount(t.account)},S=t.account.balance+t.account.subAccounts.reduce((C,P)=>C+P.balance,0),p=te(t.account.type);return b(tt,{className:"account-hierarchy-card",style:o,get children(){return[(()=>{var C=iE(),P=C.firstChild,E=P.firstChild,y=E.firstChild,oe=y.nextSibling,K=P.nextSibling,T=K.firstChild,U=T.nextSibling;return u(C,a),u(P,c),s(P,(()=>{var B=fe(()=>t.account.subAccounts.length>0);return()=>B()&&(()=>{var x=sE();return x.addEventListener("mouseleave",I=>I.target.style.background="none"),x.addEventListener("mouseenter",I=>I.target.style.background="var(--background-color)"),x.$$click=()=>i(!n()),u(x,d),s(x,()=>n()?"":""),x})()})(),E),E.$$click=()=>ae(t.account),E.style.setProperty("cursor","pointer"),u(y,h),s(y,()=>t.account.accountNumber),u(oe,m),s(oe,()=>t.account.name),K.style.setProperty("text-align","right"),u(T,g),s(T,()=>ye(S)),s(U,()=>e(`accounts.types.${t.account.type.toLowerCase()}`)),re(B=>u(U,{..._,background:p.bg,color:p.color},B)),C})(),(()=>{var C=oE();return u(C,ie),s(C,b(Le,{variant:"secondary",size:"sm",onClick:()=>ae(t.account),get children(){return[fe(()=>e("common.view"))," ",fe(()=>e("accounts.accountDetails"))]}}),null),s(C,b(Le,{variant:"outline",size:"sm",onClick:$,get children(){return[fe(()=>e("common.add"))," ",fe(()=>e("accounts.subAccounts"))]}}),null),C})(),fe(()=>fe(()=>!!(n()&&t.account.subAccounts.length>0))()&&(()=>{var C=aE(),P=C.firstChild,E=P.firstChild,y=E.nextSibling;return y.nextSibling,u(C,A),P.style.setProperty("margin","0 0 1rem 0"),P.style.setProperty("font-size","1rem"),P.style.setProperty("color","var(--text-muted)"),s(P,()=>e("accounts.subAccounts"),E),s(P,()=>t.account.subAccounts.length,y),s(C,()=>t.account.subAccounts.map(oe=>(()=>{var K=lE(),T=K.firstChild,U=T.firstChild,B=U.nextSibling,x=B.firstChild,I=T.nextSibling;return K.addEventListener("mouseleave",N=>{N.currentTarget.style.background="var(--background-color)",N.currentTarget.style.transform="translateY(0)"}),K.addEventListener("mouseenter",N=>{N.currentTarget.style.background="var(--surface-color)",N.currentTarget.style.transform="translateY(-1px)"}),K.$$click=()=>ae(oe),u(K,M),u(T,L),u(U,k),s(U,()=>oe.name),u(B,R),s(B,()=>oe.accountNumber,x),s(B,()=>oe.description,null),u(I,W),s(I,()=>ye(oe.balance)),K})()),null),C})())]}})};At(["click"]);var uE=z("<form><div>");const dE=t=>{const{t:e}=lt(),[r,n]=ge({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),i=[{value:"Asset",label:e("accounts.types.asset"),type:"debit",classification:"real"},{value:"Liability",label:e("accounts.types.liability"),type:"credit",classification:"real"},{value:"Equity",label:e("accounts.types.equity"),type:"credit",classification:"real"},{value:"Revenue",label:e("accounts.types.revenue"),type:"credit",classification:"nominal"},{value:"Expense",label:e("accounts.types.expense"),type:"debit",classification:"nominal"}],o=()=>{const m=r().type;return m?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")},{value:"Sales Revenue",label:e("accounts.categories.salesRevenue")},{value:"Service Revenue",label:e("accounts.categories.servicesRevenue")},{value:"Subscription Revenue",label:e("accounts.categories.subscriptionRevenue")},{value:"Rental Revenue",label:e("accounts.categories.rentalRevenue")},{value:"Commission Revenue",label:e("accounts.categories.commissionRevenue")},{value:"Franchise Revenue",label:e("accounts.categories.franchiseRevenue")},{value:"Licensing Revenue",label:e("accounts.categories.licensingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[m]||[]:[]},a=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],c={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},d=m=>{m.preventDefault();const g=r();if(!g.accountNumber||!g.name||!g.type||!g.category){alert(e("forms.requiredField"));return}if(bt.accounts.find(M=>M.accountNumber===g.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const A={accountNumber:g.accountNumber,name:g.name,type:g.type,category:g.category,description:g.description,balance:parseFloat(g.balance)||0,isActive:g.isActive==="true"};bt.addAccount(A),n({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},h=(m,g)=>{n(_=>{const A={..._,[m]:g};return m==="type"&&(A.category=""),A})};return b(gr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.addAccount")},get children(){var m=uE(),g=m.firstChild;return m.addEventListener("submit",d),s(m,b(kt,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:_=>h("accountNumber",_),get placeholder(){return e("accounts.accountNumber")},required:!0}),g),s(m,b(kt,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:_=>h("name",_),get placeholder(){return e("accounts.accountName")},required:!0}),g),s(m,b(mr,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:_=>h("type",_),options:i,required:!0}),g),s(m,b(mr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:_=>h("category",_),get options(){return o()},required:!0}),g),s(m,b(kt,{get label(){return e("common.description")},get value(){return r().description},onChange:_=>h("description",_),get placeholder(){return e("common.description")}}),g),s(m,b(kt,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:_=>h("balance",_),get placeholder(){return e("accounts.balance")}}),g),s(m,b(mr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:_=>h("isActive",_),options:a,required:!0}),g),u(g,c),s(g,b(Le,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(g,b(Le,{variant:"primary",type:"submit",get children(){return e("accounts.addAccount")}}),null),m}})};var hE=z("<form><div>"),mE=z("<div><div></div><div> - </div><div>  ");const fE=t=>{const{t:e}=lt(),[r,n]=ge({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),i=()=>t.parentAccount?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[t.parentAccount.type]||[]:[],o=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],a={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},c={background:"var(--background-color)",padding:"1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1.5rem",border:"1px solid var(--border-color)"},d={"font-size":"0.875rem","font-weight":"500",color:"var(--text-muted)","margin-bottom":"0.5rem"},h={"font-weight":"600",color:"var(--text-primary)"},m={"font-size":"0.875rem",color:"var(--text-secondary)"},g=L=>{L.preventDefault();const k=r();if(!k.accountNumber||!k.name||!k.category||!t.parentAccount){alert(e("forms.requiredField"));return}if(bt.accounts.find(ie=>ie.accountNumber===k.accountNumber)){alert(e("forms.duplicateAccountNumber"));return}const W={accountNumber:k.accountNumber,name:k.name,type:t.parentAccount.type,category:k.category,description:k.description,balance:parseFloat(k.balance)||0,isActive:k.isActive==="true",parentAccountId:t.parentAccount.id};bt.addAccount(W),n({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},_=(L,k)=>{n(R=>({...R,[L]:k}))},A=()=>{if(!t.parentAccount)return"";const L=t.parentAccount.accountNumber,R=bt.getSubAccounts(t.parentAccount.id).length+1;return(parseInt(L)+R).toString()},M=()=>r().accountNumber===""&&t.parentAccount?A():r().accountNumber;return b(gr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return`${e("common.add")} ${e("accounts.subAccounts")}`},get children(){return[fe(()=>fe(()=>!!t.parentAccount)()&&(()=>{var L=mE(),k=L.firstChild,R=k.nextSibling,W=R.firstChild,ie=R.nextSibling,te=ie.firstChild;return u(L,c),u(k,d),s(k,()=>e("accounts.parentAccount")),u(R,h),s(R,()=>t.parentAccount.accountNumber,W),s(R,()=>t.parentAccount.name,null),u(ie,m),s(ie,()=>e(`accounts.types.${t.parentAccount.type.toLowerCase()}`),te),s(ie,()=>t.parentAccount.category,null),L})()),(()=>{var L=hE(),k=L.firstChild;return L.addEventListener("submit",g),s(L,b(kt,{get label(){return e("accounts.accountNumber")},get value(){return M()},onChange:R=>_("accountNumber",R),get placeholder(){return`${e("common.suggested")}: ${A()}`},required:!0}),k),s(L,b(kt,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:R=>_("name",R),get placeholder(){return e("accounts.accountName")},required:!0}),k),s(L,b(mr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:R=>_("category",R),get options(){return i()},required:!0}),k),s(L,b(kt,{get label(){return e("common.description")},get value(){return r().description},onChange:R=>_("description",R),get placeholder(){return e("common.description")}}),k),s(L,b(kt,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:R=>_("balance",R),get placeholder(){return e("accounts.balance")}}),k),s(L,b(mr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:R=>_("isActive",R),options:o,required:!0}),k),u(k,a),s(k,b(Le,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(k,b(Le,{variant:"primary",type:"submit",get children(){return[fe(()=>e("common.add"))," ",fe(()=>e("accounts.subAccounts"))]}}),null),L})()]}})};var yE=z("<form><div>"),gE=z("<div>");const pE=t=>{const{t:e}=lt(),[r,n]=ge({accountNumber:"",name:"",type:"",category:"",description:"",balance:"0",isActive:"true"}),[i,o]=ge(null);Dn(()=>{t.account&&(n({accountNumber:t.account.accountNumber,name:t.account.name,type:t.account.type,category:t.account.category,description:t.account.description,balance:t.account.balance.toString(),isActive:t.account.isActive.toString()}),o(null))});const a=[{value:"Asset",label:e("accounts.types.asset")},{value:"Liability",label:e("accounts.types.liability")},{value:"Equity",label:e("accounts.types.equity")},{value:"Revenue",label:e("accounts.types.revenue")},{value:"Expense",label:e("accounts.types.expense")}],c=()=>{const A=r().type;return A?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[A]||[]:[]},d=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},m=A=>{if(A.preventDefault(),o(null),!t.account)return;const M=r();if(!M.accountNumber||!M.name||!M.type||!M.category){o(e("forms.requiredField"));return}if(bt.accounts.find(R=>R.accountNumber===M.accountNumber&&R.id!==t.account.id)){o(e("forms.duplicateAccountNumber"));return}const k={accountNumber:M.accountNumber,name:M.name,type:M.type,category:M.category,description:M.description,balance:parseFloat(M.balance)||0,isActive:M.isActive==="true"};try{bt.updateAccount(t.account.id,k),t.onClose()}catch(R){o(R instanceof Error?R.message:e("forms.saveError"))}},g=()=>{if(!t.account)return;const A=bt.canDeleteAccount(t.account.id);if(!A.canDelete){o(A.reason||e("forms.deleteError"));return}const M=e("forms.confirmDelete");if(confirm(M))try{bt.deleteAccount(t.account.id),t.onClose()}catch(L){o(L instanceof Error?L.message:e("forms.deleteError"))}},_=(A,M)=>{n(L=>{const k={...L,[A]:M};return A==="type"&&(k.category=""),k}),i()&&o(null)};return t.account?b(gr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.editAccount")},get children(){var A=yE(),M=A.firstChild;return A.addEventListener("submit",m),s(A,b(kt,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:L=>_("accountNumber",L),get placeholder(){return e("accounts.accountNumber")},required:!0}),M),s(A,b(kt,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:L=>_("name",L),get placeholder(){return e("accounts.accountName")},required:!0}),M),s(A,b(mr,{get label(){return e("accounts.accountType")},get value(){return r().type},onChange:L=>_("type",L),options:a,required:!0}),M),s(A,b(mr,{get label(){return e("accounts.category")},get value(){return r().category},onChange:L=>_("category",L),get options(){return c()},required:!0}),M),s(A,b(kt,{get label(){return e("common.description")},get value(){return r().description},onChange:L=>_("description",L),get placeholder(){return e("common.description")}}),M),s(A,b(kt,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:L=>_("balance",L),get placeholder(){return e("accounts.balance")}}),M),s(A,b(mr,{get label(){return e("common.status")},get value(){return r().isActive},onChange:L=>_("isActive",L),options:d,required:!0}),M),s(A,(()=>{var L=fe(()=>!!i());return()=>L()&&(()=>{var k=gE();return k.style.setProperty("padding","1rem"),k.style.setProperty("border-radius","var(--border-radius-sm)"),k.style.setProperty("margin-top","1rem"),k.style.setProperty("background","#f8d7da"),k.style.setProperty("color","#721c24"),k.style.setProperty("border","1px solid #f5c6cb"),s(k,i),k})()})(),M),u(M,h),s(M,b(Le,{variant:"outline",type:"button",onClick:g,style:{color:"#dc3545","border-color":"#dc3545","margin-right":"auto"},get children(){return e("accounts.deleteAccount")}}),null),s(M,b(Le,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(M,b(Le,{variant:"primary",type:"submit",get children(){return e("common.save")}}),null),A}}):null};var vE=z("<div><div></div><div></div><div></div><div>"),bE=z("<div><div></div><div></div><div>"),_E=z("<div><button></button><button> (<!>)"),Tl=z("<div>"),SE=z("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),PE=z("<div><div><div></div><div>  </div></div><div>");const wE=t=>{const{t:e}=lt(),[r,n]=ge("details"),[i,o]=ge(!1),a=We(()=>t.account?bt.getAccountById(t.account.id)||t.account:null),c={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},d={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},h={"font-weight":"600",color:"var(--text-primary)"},m={"text-align":"center","margin-bottom":"2rem"},g={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},_={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},A={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem"},M={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},L=p=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:p?"var(--primary-color)":"var(--text-muted)","border-bottom":p?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),k={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},R={flex:"1"},W={"font-size":"0.875rem",color:"var(--text-muted)"},ie={"font-weight":"500","margin-bottom":"0.25rem"},te=p=>({"font-weight":"600",color:p==="debit"?"#4caf50":"#f44336"}),ye={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ae=p=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[p]||{bg:"#f5f5f5",color:"#666"},$=p=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(p),S=p=>new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return b(gr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.accountDetails")},get children(){return[fe(()=>fe(()=>!a())()?(()=>{var p=vE(),C=p.firstChild,P=C.nextSibling,E=P.nextSibling,y=E.nextSibling;return p.style.setProperty("text-align","center"),p.style.setProperty("padding","3rem"),p.style.setProperty("color","var(--text-muted)"),C.style.setProperty("font-size","1.5rem"),C.style.setProperty("margin-bottom","1rem"),P.style.setProperty("font-size","1.1rem"),P.style.setProperty("margin-bottom","0.5rem"),s(P,()=>e("common.error")),E.style.setProperty("font-size","0.875rem"),s(E,()=>e("common.noDataFound")),y.style.setProperty("margin-top","2rem"),s(y,b(Le,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),p})():(()=>{const p=We(()=>ae(a().type)),C=We(()=>bt.getAccountTransactions(a().id));return[(()=>{var P=bE(),E=P.firstChild,y=E.nextSibling,oe=y.nextSibling;return u(P,m),u(E,g),s(E,()=>a().name),u(y,_),s(y,()=>$(a().balance)),s(oe,()=>e(`accounts.types.${a().type.toLowerCase()}`)),re(K=>u(oe,{...A,background:p().bg,color:p().color},K)),P})(),(()=>{var P=_E(),E=P.firstChild,y=E.nextSibling,oe=y.firstChild,K=oe.nextSibling;return K.nextSibling,u(P,M),E.$$click=()=>n("details"),s(E,()=>e("accounts.accountDetails")),y.$$click=()=>n("transactions"),s(y,()=>e("accounts.transactions"),oe),s(y,()=>C().length,K),re(T=>{var U=L(r()==="details"),B=L(r()==="transactions");return T.e=u(E,U,T.e),T.t=u(y,B,T.t),T},{e:void 0,t:void 0}),P})(),fe(()=>fe(()=>r()==="details")()&&(()=>{var P=SE(),E=P.firstChild,y=E.firstChild,oe=y.nextSibling,K=E.nextSibling,T=K.firstChild,U=T.nextSibling,B=K.nextSibling,x=B.firstChild,I=x.nextSibling,N=B.nextSibling,Z=N.firstChild,j=Z.nextSibling,J=N.nextSibling,w=J.firstChild,V=w.nextSibling,X=J.nextSibling,Y=X.firstChild,se=Y.nextSibling;return s(y,()=>e("accounts.accountNumber")),s(oe,()=>a().accountNumber),s(T,()=>e("accounts.category")),s(U,()=>a().category),s(x,()=>e("common.description")),s(I,()=>a().description),s(Z,()=>e("common.status")),s(j,(()=>{var O=fe(()=>!!a().isActive);return()=>O()?e("common.active"):e("common.inactive")})()),s(w,()=>e("accounts.createdDate")),s(V,()=>S(a().createdDate)),s(Y,()=>e("accounts.lastModified")),s(se,()=>S(a().lastModified)),re(O=>{var F=c,le=d,pe=h,ve=c,ce=d,H=h,D=c,Q=d,G=h,he=c,me=d,ee=h,ne=c,Se=d,we=h,ue=c,be=d,de=h;return O.e=u(E,F,O.e),O.t=u(y,le,O.t),O.a=u(oe,pe,O.a),O.o=u(K,ve,O.o),O.i=u(T,ce,O.i),O.n=u(U,H,O.n),O.s=u(B,D,O.s),O.h=u(x,Q,O.h),O.r=u(I,G,O.r),O.d=u(N,he,O.d),O.l=u(Z,me,O.l),O.u=u(j,ee,O.u),O.c=u(J,ne,O.c),O.w=u(w,Se,O.w),O.m=u(V,we,O.m),O.f=u(X,ue,O.f),O.y=u(Y,be,O.y),O.g=u(se,de,O.g),O},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),P})()),fe(()=>fe(()=>r()==="transactions")()&&(()=>{var P=Tl();return s(P,(()=>{var E=fe(()=>C().length===0);return()=>E()?(()=>{var y=Tl();return y.style.setProperty("text-align","center"),y.style.setProperty("color","var(--text-muted)"),y.style.setProperty("padding","2rem"),s(y,()=>e("common.noDataFound")),y})():C().map(y=>(()=>{var oe=PE(),K=oe.firstChild,T=K.firstChild,U=T.nextSibling,B=U.firstChild,x=K.nextSibling;return u(oe,k),u(K,R),u(T,ie),s(T,()=>y.description),u(U,W),s(U,()=>S(y.date),B),s(U,()=>y.reference,null),s(x,()=>y.type==="debit"?"+":"-",null),s(x,()=>$(y.type==="debit"?y.debitAmount:y.creditAmount),null),re(I=>u(x,te(y.type),I)),oe})())})()),P})()),(()=>{var P=Tl();return u(P,ye),s(P,b(Le,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(P,b(Le,{variant:"primary",onClick:()=>o(!0),get children(){return e("accounts.editAccount")}}),null),P})()]})()),fe(()=>fe(()=>!!a())()&&b(pE,{get isOpen(){return i()},onClose:()=>{o(!1)},get account(){return a()}}))]}})};At(["click"]);const CE="https://qvamarkets.com/gql_api",[AE,om]=ge(!1),[IE,$l]=ge(null);class EE{baseUrl;constructor(e=CE){this.baseUrl=e}async request(e,r,n,i){om(!0),$l(null);try{const o=r.startsWith("http")?r:`${this.baseUrl}${r}`,a={method:e,headers:{"Content-Type":"application/json",Accept:"application/json",...i}};n&&(e==="POST"||e==="PUT"||e==="PATCH")&&(a.body=JSON.stringify(n));const c=await fetch(o,a);if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);const d=await c.json();if(d.errors&&d.errors.length>0)throw new Error(d.errors[0].message);return d.data||d}catch(o){const a=o instanceof Error?o.message:"Unknown error occurred";throw $l(a),o}finally{om(!1)}}async graphql(e){return this.request("POST","",e)}async get(e,r){return this.request("GET",e,void 0,r)}async post(e,r,n){return this.request("POST",e,r,n)}async put(e,r,n){return this.request("PUT",e,r,n)}async patch(e,r,n){return this.request("PATCH",e,r,n)}async delete(e,r){return this.request("DELETE",e,void 0,r)}getLoadingState(){return AE()}getErrorState(){return IE()}clearError(){$l(null)}}const Gs=new EE,$u=`
  fragment AccountFields on Account {
    id
    accountNumber
    name
    type
    category
    description
    balance
    isActive
    parentAccountId
    createdDate
    lastModified
  }
`,xE=`
  query GetAccountById($id: ID!) {
    account(id: $id) {
      ...AccountFields
    }
  }
  ${$u}
`,TE=`
  mutation CreateAccount($input: CreateAccountInput!) {
    createAccount(input: $input) {
      ...AccountFields
    }
  }
  ${$u}
`,$E=`
  mutation UpdateAccount($id: ID!, $input: UpdateAccountInput!) {
    updateAccount(id: $id, input: $input) {
      ...AccountFields
    }
  }
  ${$u}
`,kE=`
  mutation DeleteAccount($id: ID!) {
    deleteAccount(id: $id) {
      success
      message
    }
  }
`;class RE{async getAccounts(e,r){try{if(Xo.isFakeMode())return await cd.getAll(e);const n=await Pn({query:"getAllYabaProducts",params:{businessId:"YB100423253156428"}});return console.log("Real API accounts response:",n),n?.accounts||[]}catch(n){if(console.error("Error fetching accounts:",n),Xo.isHybridMode())return console.warn("Falling back to fake API for accounts"),await cd.getAll(e);throw n}}async getAccountById(e){try{return(await Gs.graphql({query:xE,variables:{id:e}})).account}catch(r){throw console.error("Error fetching account:",r),r}}async createAccount(e){try{return(await Gs.graphql({query:TE,variables:{input:e}})).createAccount}catch(r){throw console.error("Error creating account:",r),r}}async updateAccount(e,r){try{return(await Gs.graphql({query:$E,variables:{id:e,input:r}})).updateAccount}catch(n){throw console.error("Error updating account:",n),n}}async deleteAccount(e){try{return(await Gs.graphql({query:kE,variables:{id:e}})).deleteAccount}catch(r){throw console.error("Error deleting account:",r),r}}async getAccountsByType(e){return this.getAccounts({type:e})}async getAccountHierarchy(){const e=await this.getAccounts();return this.buildHierarchy(e)}buildHierarchy(e){const r=new Map,n=[];return e.forEach(i=>{r.set(i.id,{...i,subAccounts:[]})}),e.forEach(i=>{const o=r.get(i.id);if(i.parentAccountId){const a=r.get(i.parentAccountId);a&&(a.subAccounts=a.subAccounts||[],a.subAccounts.push(o))}else n.push(o)}),n}async getAccountBalance(e){const r=await this.getAccountById(e);return r?r.balance:0}async searchAccounts(e){return this.getAccounts({search:e})}}const DE=new RE;var NE=z("<div><h2></h2><div><span>:</span><button></button><button>"),LE=z("<div><span>:"),sm=z("<div>"),ME=z("<button>");const OE=()=>{const{t}=lt(),[e,r]=ge(!1),[n,i]=ge(!1),[o,a]=ge(!1),[c,d]=ge(null),[h,m]=ge(null),[g,_]=ge("All"),[A,M]=ge("hierarchy"),L=S=>{d(S),a(!0)},k=S=>{m(S),i(!0)},R=()=>g()==="All"?A()==="hierarchy"?bt.getAccountHierarchy():bt.accounts:A()==="hierarchy"?bt.getAccountHierarchy().filter(S=>S.type===g()):bt.getAccountsByType(g()),W={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},ie={display:"flex",gap:"1rem","margin-bottom":"2rem","align-items":"center"},te=S=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:S?"var(--primary-color)":"var(--surface-color)",color:S?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500",transition:"all 0.2s ease"}),ye={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},ae={display:"flex",gap:"0.5rem","align-items":"center","margin-left":"auto","margin-right":"1rem"},$=S=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:S?"var(--primary-color)":"var(--surface-color)",color:S?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"});return b(kr,{get title(){return t("accounts.title")},get children(){return[b(eE,{}),(()=>{var S=NE(),p=S.firstChild,C=p.nextSibling,P=C.firstChild,E=P.firstChild,y=P.nextSibling,oe=y.nextSibling;return u(S,ye),p.style.setProperty("margin","0"),p.style.setProperty("font-size","1.5rem"),s(p,()=>t("accounts.title")),u(C,ae),P.style.setProperty("font-weight","500"),P.style.setProperty("color","var(--text-muted)"),P.style.setProperty("font-size","0.875rem"),s(P,()=>t("common.view"),E),y.$$click=()=>M("hierarchy"),s(y,()=>t("accounts.accountHierarchy")),oe.$$click=()=>{M("flat"),DE.getAccounts()},s(oe,()=>t("common.all")),s(S,b(Le,{variant:"primary",onClick:()=>r(!0),get children(){return t("accounts.addAccount")}}),null),re(K=>{var T=$(A()==="hierarchy"),U=$(A()==="flat");return K.e=u(y,T,K.e),K.t=u(oe,U,K.t),K},{e:void 0,t:void 0}),S})(),(()=>{var S=LE(),p=S.firstChild,C=p.firstChild;return u(S,ie),p.style.setProperty("font-weight","500"),p.style.setProperty("color","var(--text-muted)"),s(p,()=>t("common.filter"),C),s(S,()=>[t("common.all"),t("accounts.types.asset"),t("accounts.types.liability"),t("accounts.types.equity"),t("accounts.types.revenue"),t("accounts.types.expense")].map((P,E)=>{const oe=["All","Asset","Liability","Equity","Revenue","Expense"][E];return(()=>{var K=ME();return K.$$click=()=>_(oe),s(K,P),re(T=>u(K,te(g()===oe),T)),K})()}),null),S})(),(()=>{var S=sm();return s(S,(()=>{var p=fe(()=>A()==="hierarchy");return()=>p()?R().map(C=>b(cE,{account:C,onAddSubAccount:k,onViewDetails:L})):R().map(C=>b(nE,{account:C,onViewDetails:L}))})()),re(p=>u(S,A()==="hierarchy"?{display:"flex","flex-direction":"column",gap:"1rem"}:W,p)),S})(),fe(()=>fe(()=>R().length===0)()&&(()=>{var S=sm();return S.style.setProperty("text-align","center"),S.style.setProperty("color","var(--text-muted)"),S.style.setProperty("padding","3rem"),S.style.setProperty("font-size","1.1rem"),s(S,()=>t("common.noDataFound")),S})()),b(dE,{get isOpen(){return e()},onClose:()=>r(!1)}),b(fE,{get isOpen(){return n()},onClose:()=>i(!1),get parentAccount(){return h()}}),b(wE,{get isOpen(){return o()},onClose:()=>a(!1),get account(){return c()}})]}})};At(["click"]);var VE=z("<div><h2>"),ji=z("<div>"),BE=z("<div><div><div></div><h1></h1><div></div></div><div>"),FE=z("<div><button></button><button> (<!>)"),Hs=z("<div><span></span><span>"),UE=z("<p>"),jE=z("<div><div></div><div>"),zE=z("<div><div><div></div><div>  </div></div><div>");const qE=()=>{const{t}=lt(),e=Tp(),r=$c(),[n,i]=ge(null),[o,a]=ge("overview");qr(()=>{const y=bt.getAccountById(e.id);y?i(y):r("/accounts")});const c={display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"1rem"},d={display:"flex","align-items":"center",gap:"1rem","margin-bottom":"2rem"},h={"font-size":"1rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},m={"font-size":"2.5rem","font-weight":"700",color:"var(--primary-color)"},g={padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},_={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},A=y=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:y?"var(--primary-color)":"var(--text-muted)","border-bottom":y?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),M={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},L={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},k={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},R={"font-weight":"500",color:"var(--text-muted)"},W={"font-weight":"600",color:"var(--text-primary)"},ie={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},te={flex:"1"},ye={"font-weight":"500","margin-bottom":"0.25rem"},ae={"font-size":"0.875rem",color:"var(--text-muted)"},$=y=>({"font-weight":"600",color:y==="debit"?"#4caf50":"#f44336"});if(!n())return b(kr,{get title(){return t("accounts.accountDetails")},get children(){var y=VE(),oe=y.firstChild;return y.style.setProperty("text-align","center"),y.style.setProperty("padding","3rem"),s(oe,()=>t("common.error")),s(y,b(Le,{variant:"primary",onClick:()=>r("/accounts"),get children(){return[fe(()=>t("common.back"))," ",fe(()=>t("navigation.accounts"))]}}),null),y}});const S=y=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[y]||{bg:"#f5f5f5",color:"#666"},p=y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(y),C=y=>new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),P=S(n().type),E=bt.getAccountTransactions(n().id);return b(kr,{get title(){return n().name},get children(){return[(()=>{var y=ji();return u(y,c),s(y,b(Le,{variant:"secondary",onClick:()=>r("/accounts"),get children(){return[" ",fe(()=>t("common.back"))," ",fe(()=>t("navigation.accounts"))]}})),y})(),(()=>{var y=BE(),oe=y.firstChild,K=oe.firstChild,T=K.nextSibling,U=T.nextSibling,B=oe.nextSibling;return u(y,d),u(K,h),s(K,()=>n().accountNumber),T.style.setProperty("margin","0.5rem 0"),T.style.setProperty("font-size","2rem"),s(T,()=>n().name),u(U,m),s(U,()=>p(n().balance)),s(B,()=>n().type),re(x=>u(B,{...g,background:P.bg,color:P.color},x)),y})(),(()=>{var y=FE(),oe=y.firstChild,K=oe.nextSibling,T=K.firstChild,U=T.nextSibling;return U.nextSibling,u(y,_),oe.$$click=()=>a("overview"),s(oe,()=>t("dashboard.overview")),K.$$click=()=>a("transactions"),s(K,()=>t("accounts.transactions"),T),s(K,()=>E.length,U),re(B=>{var x=A(o()==="overview"),I=A(o()==="transactions");return B.e=u(oe,x,B.e),B.t=u(K,I,B.t),B},{e:void 0,t:void 0}),y})(),fe(()=>fe(()=>o()==="overview")()&&(()=>{var y=jE(),oe=y.firstChild,K=oe.nextSibling;return u(oe,M),s(oe,b(tt,{get title(){return t("accounts.balance")},get subtitle(){return t("dashboard.overview")},get children(){var T=ji();return T.style.setProperty("font-size","1.5rem"),T.style.setProperty("font-weight","600"),T.style.setProperty("color","var(--primary-color)"),s(T,()=>p(n().balance)),T}}),null),s(oe,b(tt,{get title(){return t("accounts.accountType")},get subtitle(){return t("accounts.category")},get children(){var T=ji();return T.style.setProperty("font-size","1.5rem"),T.style.setProperty("font-weight","600"),T.style.setProperty("color","var(--primary-color)"),s(T,()=>t(`accounts.types.${n().type.toLowerCase()}`)),T}}),null),s(oe,b(tt,{get title(){return t("common.status")},get subtitle(){return t("accounts.accountDetails")},get children(){var T=ji();return T.style.setProperty("font-size","1.5rem"),T.style.setProperty("font-weight","600"),s(T,(()=>{var U=fe(()=>!!n().isActive);return()=>U()?t("common.active"):t("common.inactive")})()),re(U=>(U=n().isActive?"#4caf50":"#f44336")!=null?T.style.setProperty("color",U):T.style.removeProperty("color")),T}}),null),s(oe,b(tt,{get title(){return t("accounts.transactions")},get subtitle(){return t("common.total")},get children(){var T=ji();return T.style.setProperty("font-size","1.5rem"),T.style.setProperty("font-weight","600"),T.style.setProperty("color","var(--primary-color)"),s(T,()=>E.length),T}}),null),u(K,L),s(K,b(tt,{get title(){return t("accounts.accountDetails")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var T=Hs(),U=T.firstChild,B=U.nextSibling;return s(U,()=>t("accounts.accountNumber")),s(B,()=>n().accountNumber),re(x=>{var I=k,N=R,Z=W;return x.e=u(T,I,x.e),x.t=u(U,N,x.t),x.a=u(B,Z,x.a),x},{e:void 0,t:void 0,a:void 0}),T})(),(()=>{var T=Hs(),U=T.firstChild,B=U.nextSibling;return s(U,()=>t("accounts.category")),s(B,()=>n().category),re(x=>{var I=k,N=R,Z=W;return x.e=u(T,I,x.e),x.t=u(U,N,x.t),x.a=u(B,Z,x.a),x},{e:void 0,t:void 0,a:void 0}),T})(),(()=>{var T=Hs(),U=T.firstChild,B=U.nextSibling;return s(U,()=>t("common.date")),s(B,()=>C(n().createdDate)),re(x=>{var I=k,N=R,Z=W;return x.e=u(T,I,x.e),x.t=u(U,N,x.t),x.a=u(B,Z,x.a),x},{e:void 0,t:void 0,a:void 0}),T})(),(()=>{var T=Hs(),U=T.firstChild,B=U.nextSibling;return s(U,()=>t("common.date")),s(B,()=>C(n().lastModified)),re(x=>{var I=k,N=R,Z=W;return x.e=u(T,I,x.e),x.t=u(U,N,x.t),x.a=u(B,Z,x.a),x},{e:void 0,t:void 0,a:void 0}),T})()]}}),null),s(K,b(tt,{get title(){return t("common.description")},get subtitle(){return t("accounts.accountDetails")},get children(){var T=UE();return T.style.setProperty("margin","0"),T.style.setProperty("color","var(--text-secondary)"),s(T,()=>n().description||t("common.noDataFound")),T}}),null),y})()),fe(()=>fe(()=>o()==="transactions")()&&b(tt,{get title(){return t("accounts.accountHistory")},get subtitle(){return t("accounts.transactions")},get children(){return fe(()=>E.length===0)()?(()=>{var y=ji();return y.style.setProperty("text-align","center"),y.style.setProperty("color","var(--text-muted)"),y.style.setProperty("padding","2rem"),s(y,()=>t("common.noDataFound")),y})():E.map(y=>(()=>{var oe=zE(),K=oe.firstChild,T=K.firstChild,U=T.nextSibling,B=U.firstChild,x=K.nextSibling;return u(oe,ie),u(K,te),u(T,ye),s(T,()=>y.description),u(U,ae),s(U,()=>C(y.date),B),s(U,()=>y.reference,null),s(x,()=>y.type==="debit"?"+":"-",null),s(x,()=>p(y.type==="debit"?y.debitAmount:y.creditAmount),null),re(I=>u(x,$(y.type),I)),oe})())}}))]}})};At(["click"]);var GE=z("<div><div><h1></h1><p> </p></div><div><input type=date>"),bn=z("<div><span></span><span>"),HE=z("<div><div></div><div>"),YE=z("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),WE=z("<div><div> (<!> = <!> + <!>)</div><div> = "),KE=z("<span>(<!>: <!>)");const QE=()=>{const{t}=lt(),[e,r]=ge(new Date().toISOString().split("T")[0]),[n,i]=ge(0),[o,a]=ge(0),[c,d]=ge(0);qr(()=>{h()});const h=()=>{const M=bt.getAccountsByType("Asset"),L=bt.getAccountsByType("Liability"),k=bt.getAccountsByType("Equity"),R=M.reduce((te,ye)=>te+ye.balance,0),W=L.reduce((te,ye)=>te+ye.balance,0),ie=k.reduce((te,ye)=>te+ye.balance,0);i(R),a(W),d(ie)},m=M=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(M),g={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},_={"margin-bottom":"2rem"},A={"font-weight":"bold","font-size":"1.1rem","border-top":"2px solid var(--border-color)","padding-top":"0.5rem","margin-top":"1rem"};return b(kr,{get title(){return t("balanceSheet.title")},get children(){return[(()=>{var M=GE(),L=M.firstChild,k=L.firstChild,R=k.nextSibling,W=R.firstChild,ie=L.nextSibling,te=ie.firstChild;return u(M,g),k.style.setProperty("margin","0"),s(k,()=>t("balanceSheet.title")),R.style.setProperty("margin","0.5rem 0 0 0"),R.style.setProperty("color","var(--text-muted)"),s(R,()=>t("balanceSheet.asOf"),W),s(R,()=>new Date(e()).toLocaleDateString(),null),ie.style.setProperty("display","flex"),ie.style.setProperty("gap","1rem"),te.addEventListener("change",ye=>r(ye.target.value)),te.style.setProperty("padding","0.5rem"),te.style.setProperty("border","1px solid var(--border-color)"),te.style.setProperty("border-radius","var(--border-radius-sm)"),s(ie,b(Le,{variant:"primary",onClick:h,get children(){return t("balanceSheet.generateReport")}}),null),re(()=>te.value=e()),M})(),(()=>{var M=HE(),L=M.firstChild,k=L.nextSibling;return M.style.setProperty("display","grid"),M.style.setProperty("grid-template-columns","1fr 1fr"),M.style.setProperty("gap","2rem"),s(L,b(tt,{get title(){return t("balanceSheet.assets")},style:_,get children(){return[(()=>{var R=bn(),W=R.firstChild,ie=W.nextSibling;return R.style.setProperty("display","flex"),R.style.setProperty("justify-content","space-between"),R.style.setProperty("align-items","center"),s(W,()=>t("balanceSheet.currentAssets")),s(ie,()=>m(n()*.6)),R})(),(()=>{var R=bn(),W=R.firstChild,ie=W.nextSibling;return R.style.setProperty("display","flex"),R.style.setProperty("justify-content","space-between"),R.style.setProperty("align-items","center"),s(W,()=>t("balanceSheet.nonCurrentAssets")),s(ie,()=>m(n()*.4)),R})(),(()=>{var R=bn(),W=R.firstChild,ie=W.nextSibling;return s(W,()=>t("balanceSheet.totalAssets")),s(ie,()=>m(n())),re(te=>u(R,{...A,display:"flex","justify-content":"space-between"},te)),R})()]}})),s(k,b(tt,{get title(){return t("balanceSheet.liabilities")},style:_,get children(){return[(()=>{var R=bn(),W=R.firstChild,ie=W.nextSibling;return R.style.setProperty("display","flex"),R.style.setProperty("justify-content","space-between"),R.style.setProperty("align-items","center"),s(W,()=>t("balanceSheet.currentLiabilities")),s(ie,()=>m(o()*.7)),R})(),(()=>{var R=bn(),W=R.firstChild,ie=W.nextSibling;return R.style.setProperty("display","flex"),R.style.setProperty("justify-content","space-between"),R.style.setProperty("align-items","center"),s(W,()=>t("balanceSheet.nonCurrentLiabilities")),s(ie,()=>m(o()*.3)),R})(),(()=>{var R=bn(),W=R.firstChild,ie=W.nextSibling;return s(W,()=>t("balanceSheet.totalLiabilities")),s(ie,()=>m(o())),re(te=>u(R,{...A,display:"flex","justify-content":"space-between"},te)),R})()]}}),null),s(k,b(tt,{get title(){return t("balanceSheet.equity")},get children(){return[(()=>{var R=bn(),W=R.firstChild,ie=W.nextSibling;return R.style.setProperty("display","flex"),R.style.setProperty("justify-content","space-between"),R.style.setProperty("align-items","center"),s(W,()=>t("balanceSheet.commonStock")),s(ie,()=>m(c()*.8)),R})(),(()=>{var R=bn(),W=R.firstChild,ie=W.nextSibling;return R.style.setProperty("display","flex"),R.style.setProperty("justify-content","space-between"),R.style.setProperty("align-items","center"),s(W,()=>t("balanceSheet.retainedEarnings")),s(ie,()=>m(c()*.2)),R})(),(()=>{var R=bn(),W=R.firstChild,ie=W.nextSibling;return s(W,()=>t("balanceSheet.totalEquity")),s(ie,()=>m(c())),re(te=>u(R,{...A,display:"flex","justify-content":"space-between"},te)),R})()]}}),null),M})(),b(tt,{get title(){return t("dashboard.overview")},style:{"margin-top":"2rem"},get children(){return[(()=>{var M=YE(),L=M.firstChild,k=L.firstChild,R=k.nextSibling,W=L.nextSibling,ie=W.firstChild,te=ie.nextSibling,ye=W.nextSibling,ae=ye.firstChild,$=ae.nextSibling;return M.style.setProperty("display","grid"),M.style.setProperty("grid-template-columns","repeat(3, 1fr)"),M.style.setProperty("gap","2rem"),L.style.setProperty("text-align","center"),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("color","var(--text-muted)"),k.style.setProperty("margin-bottom","0.5rem"),s(k,()=>t("balanceSheet.totalAssets")),R.style.setProperty("font-size","1.5rem"),R.style.setProperty("font-weight","bold"),R.style.setProperty("color","var(--primary-color)"),s(R,()=>m(n())),W.style.setProperty("text-align","center"),ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-muted)"),ie.style.setProperty("margin-bottom","0.5rem"),s(ie,()=>t("balanceSheet.totalLiabilities")),te.style.setProperty("font-size","1.5rem"),te.style.setProperty("font-weight","bold"),te.style.setProperty("color","#f44336"),s(te,()=>m(o())),ye.style.setProperty("text-align","center"),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),ae.style.setProperty("margin-bottom","0.5rem"),s(ae,()=>t("balanceSheet.totalEquity")),$.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","bold"),$.style.setProperty("color","#4caf50"),s($,()=>m(c())),M})(),(()=>{var M=WE(),L=M.firstChild,k=L.firstChild,R=k.nextSibling,W=R.nextSibling,ie=W.nextSibling,te=ie.nextSibling,ye=te.nextSibling;ye.nextSibling;var ae=L.nextSibling,$=ae.firstChild;return M.style.setProperty("margin-top","2rem"),M.style.setProperty("text-align","center"),L.style.setProperty("font-size","0.875rem"),L.style.setProperty("color","var(--text-muted)"),L.style.setProperty("margin-bottom","0.5rem"),s(L,()=>t("common.total"),k),s(L,()=>t("balanceSheet.totalAssets"),R),s(L,()=>t("balanceSheet.totalLiabilities"),ie),s(L,()=>t("balanceSheet.totalEquity"),ye),ae.style.setProperty("font-size","1.2rem"),ae.style.setProperty("font-weight","bold"),s(ae,()=>m(n()),$),s(ae,()=>m(o()+c()),null),s(ae,(()=>{var S=fe(()=>Math.abs(n()-(o()+c()))>.01);return()=>S()&&(()=>{var p=KE(),C=p.firstChild,P=C.nextSibling,E=P.nextSibling,y=E.nextSibling;return y.nextSibling,p.style.setProperty("font-size","0.875rem"),p.style.setProperty("color","#f44336"),p.style.setProperty("display","block"),s(p,()=>t("common.error"),P),s(p,()=>m(n()-(o()+c())),y),p})()})(),null),re(S=>(S=Math.abs(n()-(o()+c()))<.01?"#4caf50":"#f44336")!=null?ae.style.setProperty("color",S):ae.style.removeProperty("color")),M})()]}})]}})};At(["click"]);const JE=[{id:"1",name:"John Doe",position:"Software Engineer",salary:85e3,email:"john.doe@company.com",phone:"+1 (555) 123-4567",department:"Engineering",startDate:"2023-01-15"},{id:"2",name:"Jane Smith",position:"Product Manager",salary:95e3,email:"jane.smith@company.com",phone:"+1 (555) 234-5678",department:"Product",startDate:"2022-08-20"},{id:"3",name:"Mike Brown",position:"Designer",salary:7e4,email:"mike.brown@company.com",phone:"+1 (555) 345-6789",department:"Design",startDate:"2023-03-10"},{id:"4",name:"Sarah Kim",position:"HR Manager",salary:78e3,email:"sarah.kim@company.com",phone:"+1 (555) 456-7890",department:"Human Resources",startDate:"2022-11-05"},{id:"5",name:"Alex Lee",position:"Data Analyst",salary:72e3,email:"alex.lee@company.com",phone:"+1 (555) 567-8901",department:"Analytics",startDate:"2023-02-28"},{id:"6",name:"Emma Wilson",position:"Marketing Manager",salary:82e3,email:"emma.wilson@company.com",phone:"+1 (555) 678-9012",department:"Marketing",startDate:"2022-09-15"}],[ko,kl]=ge(JE),wg={get employees(){return ko()},addEmployee(t){const e={...t,id:Date.now().toString()};return kl([...ko(),e]),e},updateEmployee(t,e){kl(ko().map(r=>r.id===t?{...r,...e}:r))},deleteEmployee(t){kl(ko().filter(e=>e.id!==t))},getEmployeeById(t){return ko().find(e=>e.id===t)}};var XE=z("<form><div>");const ZE=t=>{const{t:e}=lt(),[r,n]=ge({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),i=[{value:"Engineering",label:e("employees.departments.engineering","Engineering")},{value:"Product",label:e("employees.departments.product","Product")},{value:"Design",label:e("employees.departments.design","Design")},{value:"Marketing",label:e("employees.departments.marketing","Marketing")},{value:"Sales",label:e("employees.departments.sales","Sales")},{value:"Human Resources",label:e("employees.departments.humanResources","Human Resources")},{value:"Finance",label:e("employees.departments.finance","Finance")},{value:"Operations",label:e("employees.departments.operations","Operations")},{value:"Analytics",label:e("employees.departments.analytics","Analytics")}],o={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},a=d=>{d.preventDefault();const h=r();if(!h.name||!h.position||!h.salary||!h.email||!h.department||!h.startDate){alert(e("forms.requiredField"));return}const m={name:h.name,position:h.position,salary:parseFloat(h.salary),email:h.email,phone:h.phone,department:h.department,startDate:h.startDate};wg.addEmployee(m),n({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),t.onClose()},c=(d,h)=>{n(m=>({...m,[d]:h}))};return b(gr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.addEmployee")},get children(){var d=XE(),h=d.firstChild;return d.addEventListener("submit",a),s(d,b(kt,{get label(){return e("employees.fullName")},get value(){return r().name},onChange:m=>c("name",m),get placeholder(){return e("employees.enterFullName","Enter employee's full name")},required:!0}),h),s(d,b(kt,{get label(){return e("employees.position")},get value(){return r().position},onChange:m=>c("position",m),get placeholder(){return e("employees.enterPosition","Enter job position")},required:!0}),h),s(d,b(mr,{get label(){return e("employees.department")},get value(){return r().department},onChange:m=>c("department",m),options:i,required:!0}),h),s(d,b(kt,{get label(){return e("employees.email")},type:"email",get value(){return r().email},onChange:m=>c("email",m),get placeholder(){return e("employees.enterEmail","Enter email address")},required:!0}),h),s(d,b(kt,{get label(){return e("employees.phone")},type:"tel",get value(){return r().phone},onChange:m=>c("phone",m),get placeholder(){return e("employees.enterPhone","Enter phone number")}}),h),s(d,b(kt,{get label(){return e("employees.salary")},type:"number",get value(){return r().salary},onChange:m=>c("salary",m),get placeholder(){return e("employees.enterSalary","Enter annual salary")},required:!0}),h),s(d,b(kt,{get label(){return e("employees.hireDate")},type:"date",get value(){return r().startDate},onChange:m=>c("startDate",m),required:!0}),h),u(h,o),s(h,b(Le,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(h,b(Le,{variant:"primary",type:"submit",get children(){return e("employees.addEmployee")}}),null),d}})};var ex=z("<div><div></div><div></div><div>"),tx=z("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),rx=z("<div>");const nx=t=>{const{t:e}=lt(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={width:"80px",height:"80px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.5rem",margin:"0 auto 1.5rem auto"},a={"text-align":"center","margin-bottom":"2rem"},c={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},d={color:"var(--text-muted)","font-size":"1rem"},h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"};if(!t.employee)return null;const m=A=>A.split(" ").map(M=>M[0]).join("").toUpperCase(),g=A=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(A),_=A=>new Date(A).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return b(gr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.employeeDetails")},get children(){return[(()=>{var A=ex(),M=A.firstChild,L=M.nextSibling,k=L.nextSibling;return u(A,a),u(M,o),s(M,()=>m(t.employee.name)),u(L,c),s(L,()=>t.employee.name),u(k,d),s(k,()=>t.employee.position),A})(),(()=>{var A=tx(),M=A.firstChild,L=M.firstChild,k=L.nextSibling,R=M.nextSibling,W=R.firstChild,ie=W.nextSibling,te=R.nextSibling,ye=te.firstChild,ae=ye.nextSibling,$=te.nextSibling,S=$.firstChild,p=S.nextSibling,C=$.nextSibling,P=C.firstChild,E=P.nextSibling,y=C.nextSibling,oe=y.firstChild,K=oe.nextSibling;return s(L,()=>e("employees.employeeId")),s(k,()=>t.employee.id),s(W,()=>e("employees.department")),s(ie,()=>t.employee.department),s(ye,()=>e("employees.email")),s(ae,()=>t.employee.email),s(S,()=>e("employees.phone")),s(p,()=>t.employee.phone),s(P,()=>e("employees.salary")),s(E,()=>g(t.employee.salary)),s(oe,()=>e("employees.hireDate")),s(K,()=>_(t.employee.startDate)),re(T=>{var U=r,B=n,x=i,I=r,N=n,Z=i,j=r,J=n,w=i,V=r,X=n,Y=i,se=r,O=n,F=i,le=r,pe=n,ve=i;return T.e=u(M,U,T.e),T.t=u(L,B,T.t),T.a=u(k,x,T.a),T.o=u(R,I,T.o),T.i=u(W,N,T.i),T.n=u(ie,Z,T.n),T.s=u(te,j,T.s),T.h=u(ye,J,T.h),T.r=u(ae,w,T.r),T.d=u($,V,T.d),T.l=u(S,X,T.l),T.u=u(p,Y,T.u),T.c=u(C,se,T.c),T.w=u(P,O,T.w),T.m=u(E,F,T.m),T.f=u(y,le,T.f),T.y=u(oe,pe,T.y),T.g=u(K,ve,T.g),T},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),A})(),(()=>{var A=rx();return u(A,h),s(A,b(Le,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(A,b(Le,{variant:"primary",onClick:()=>{console.log("Edit employee:",t.employee.id)},get children(){return e("employees.editEmployee")}}),null),A})()]}})};var am=z("<div>"),ix=z("<div><div></div><div><div></div><div></div><div>/year");const ox=()=>{const{t}=lt(),[e,r]=ge(!1),[n,i]=ge(!1),[o,a]=ge(null),c=L=>{a(L),i(!0)},d={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},h={display:"flex","align-items":"center",gap:"1rem"},m={width:"60px",height:"60px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.2rem"},g={flex:"1"},_={"font-weight":"600","margin-bottom":"0.25rem"},A={color:"var(--text-muted)","font-size":"0.875rem","margin-bottom":"0.5rem"},M={color:"var(--primary-color)","font-weight":"500"};return b(kr,{get title(){return t("employees.title")},get children(){return[(()=>{var L=am();return L.style.setProperty("margin-bottom","2rem"),s(L,b(Le,{variant:"primary",onClick:()=>r(!0),get children(){return t("employees.addEmployee")}})),L})(),(()=>{var L=am();return u(L,d),s(L,()=>wg.employees.map(k=>{const R=ie=>ie.split(" ").map(te=>te[0]).join("").toUpperCase(),W=ie=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ie);return b(tt,{onClick:()=>c(k),get children(){var ie=ix(),te=ie.firstChild,ye=te.nextSibling,ae=ye.firstChild,$=ae.nextSibling,S=$.nextSibling,p=S.firstChild;return u(ie,h),u(te,m),s(te,()=>R(k.name)),u(ye,g),u(ae,_),s(ae,()=>k.name),u($,A),s($,()=>k.position),u(S,M),s(S,()=>W(k.salary),p),ie}})})),L})(),b(ZE,{get isOpen(){return e()},onClose:()=>r(!1)}),b(nx,{get isOpen(){return n()},onClose:()=>i(!1),get employee(){return o()}})]}})},sx=[{id:"1",accountId:"1002",bankName:"First National Bank",accountNumber:"****1234",accountType:"checking",currency:"USD",currentBalance:32730.5,lastReconciledDate:"2024-01-01",lastReconciledBalance:3e4,isActive:!0},{id:"2",accountId:"1003",bankName:"First National Bank",accountNumber:"****5678",accountType:"savings",currency:"USD",currentBalance:12e3,lastReconciledDate:"2024-01-01",lastReconciledBalance:1e4,isActive:!0}],ax=[{id:"1",accountId:"1002",date:"2024-01-15",description:"Customer Payment - ABC Corp",reference:"CHK001234",debitAmount:5e3,creditAmount:0,balance:35730.5,category:"Customer Payment",isReconciled:!0,reconciledWith:"eb1",importedAt:"2024-01-16",source:"csv_import"},{id:"2",accountId:"1002",date:"2024-01-14",description:"Office Supplies - Staples",reference:"CHK001235",debitAmount:0,creditAmount:250,balance:30730.5,category:"Office Expenses",isReconciled:!0,reconciledWith:"eb2",importedAt:"2024-01-16",source:"csv_import"},{id:"3",accountId:"1002",date:"2024-01-13",description:"Monthly Rent Payment",reference:"CHK001236",debitAmount:0,creditAmount:2e3,balance:28730.5,category:"Rent",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"},{id:"4",accountId:"1002",date:"2024-01-12",description:"Wire Transfer In",reference:"WIRE001",debitAmount:1e4,creditAmount:0,balance:38730.5,category:"Wire Transfer",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"}],lx=[{id:"eb1",accountId:"1002",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",debitAmount:5e3,creditAmount:0,category:"Accounts Receivable",isReconciled:!0,reconciledWith:"1",createdAt:"2024-01-15"},{id:"eb2",accountId:"1002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",debitAmount:0,creditAmount:250,category:"Office Expenses",isReconciled:!0,reconciledWith:"2",createdAt:"2024-01-14"},{id:"eb3",accountId:"1002",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",debitAmount:0,creditAmount:3500,category:"Salary Expense",isReconciled:!1,createdAt:"2024-01-11"}],cx=[{id:"1",bankAccountId:"1",periodStart:"2024-01-01",periodEnd:"2024-01-15",startingBalance:3e4,endingBalance:35730.5,status:"in_progress",totalBankTransactions:4,totalEntryBookRecords:3,reconciledTransactions:2,unreconciledTransactions:2,discrepancyAmount:1500,createdAt:"2024-01-16",notes:"Wire transfer and rent payment need investigation"}],[Ys,lm]=ge(sx),[Un,Rl]=ge(ax),[Ro,cm]=ge(lx),[Ws,um]=ge(cx),sr={get bankAccounts(){return Ys()},addBankAccount(t){const e={...t,id:Date.now().toString()};return lm([...Ys(),e]),e},updateBankAccount(t,e){lm(Ys().map(r=>r.id===t?{...r,...e}:r))},getBankAccountById(t){return Ys().find(e=>e.id===t)},get bankStatements(){return Un()},addBankStatement(t){const e={...t,id:Date.now().toString(),importedAt:new Date().toISOString()};return Rl([...Un(),e]),e},addBankStatementsFromCSV(t){const e=t.map(r=>({...r,id:`csv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,importedAt:new Date().toISOString(),source:"csv_import",isReconciled:!1}));return Rl([...Un(),...e]),e},updateBankStatement(t,e){Rl(Un().map(r=>r.id===t?{...r,...e}:r))},getBankStatementsByAccount(t){return Un().filter(e=>e.accountId===t)},getUnreconciledBankStatements(t){return(t?this.getBankStatementsByAccount(t):Un()).filter(r=>!r.isReconciled)},get entryBookRecords(){return Ro()},addEntryBookRecord(t){const e={...t,id:Date.now().toString(),createdAt:new Date().toISOString()};return cm([...Ro(),e]),e},updateEntryBookRecord(t,e){cm(Ro().map(r=>r.id===t?{...r,...e}:r))},getEntryBookRecordsByAccount(t){return Ro().filter(e=>e.accountId===t)},getUnreconciledEntryBookRecords(t){return(t?this.getEntryBookRecordsByAccount(t):Ro()).filter(r=>!r.isReconciled)},reconcileTransaction(t,e){this.updateBankStatement(t,{isReconciled:!0,reconciledWith:e}),this.updateEntryBookRecord(e,{isReconciled:!0,reconciledWith:t})},unreconciledTransaction(t){const e=Un().find(r=>r.id===t);e?.reconciledWith&&this.updateEntryBookRecord(e.reconciledWith,{isReconciled:!1,reconciledWith:void 0}),this.updateBankStatement(t,{isReconciled:!1,reconciledWith:void 0})},findPotentialMatches(t){const e=Un().find(n=>n.id===t);return e?this.getUnreconciledEntryBookRecords(e.accountId).filter(n=>{const i=Math.abs(e.debitAmount-n.debitAmount)<.01||Math.abs(e.creditAmount-n.creditAmount)<.01,o=new Date(e.date),a=new Date(n.date),d=Math.abs((o.getTime()-a.getTime())/(1e3*60*60*24))<=3,h=e.reference===n.reference||e.description.toLowerCase().includes(n.description.toLowerCase())||n.description.toLowerCase().includes(e.description.toLowerCase());return i&&(d||h)}).sort((n,i)=>{const o=(n.date===e.date?2:0)+(n.reference===e.reference?1:0);return(i.date===e.date?2:0)+(i.reference===e.reference?1:0)-o}):[]},get reconciliationSessions(){return Ws()},startReconciliationSession(t,e,r){const n=this.getBankStatementsByAccount(t).filter(h=>h.date>=e&&h.date<=r),i=this.getEntryBookRecordsByAccount(t).filter(h=>h.date>=e&&h.date<=r),o=n.filter(h=>h.isReconciled).length,a=this.getBankAccountById(t)?.lastReconciledBalance||0,c=this.getBankAccountById(t)?.currentBalance||0,d={id:Date.now().toString(),bankAccountId:t,periodStart:e,periodEnd:r,startingBalance:a,endingBalance:c,status:"in_progress",totalBankTransactions:n.length,totalEntryBookRecords:i.length,reconciledTransactions:o,unreconciledTransactions:n.length-o,discrepancyAmount:0,createdAt:new Date().toISOString()};return um([...Ws(),d]),d},updateReconciliationSession(t,e){um(Ws().map(r=>r.id===t?{...r,...e}:r))},getReconciliationSessionsByAccount(t){return Ws().filter(e=>e.bankAccountId===t)}};var Dl=z("<div>"),ux=z("<div><strong>:</strong> <!> - "),dx=z("<div><div><div></div><div></div><div></div></div><input id=csvFileInput type=file accept=.csv>"),hx=z("<div><h4></h4><div><div><label> *</label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value>"),zi=z("<option>"),mx=z("<div><table><thead><tr></tr></thead><tbody>"),fx=z("<th>"),yx=z("<tr>"),gx=z("<td>");const px=t=>{const{t:e}=lt(),[r,n]=ge(!1),[i,o]=ge(!1),[a,c]=ge(null),[d,h]=ge([]),[m,g]=ge({date:"",description:"",reference:"",debit:"",credit:"",balance:""}),_={border:`2px dashed ${r()?"var(--primary-color)":"var(--border-color)"}`,"border-radius":"var(--border-radius)",padding:"2rem","text-align":"center","background-color":r()?"var(--background-color)":"transparent",transition:"all 0.2s ease",cursor:"pointer"},A={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem","margin-top":"1.5rem"},M={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-family":"inherit"},L={"max-height":"200px","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},k={width:"100%","border-collapse":"collapse","font-size":"0.875rem"},R={padding:"0.5rem","border-bottom":"1px solid var(--border-color)","text-align":"left"},W={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ie=E=>{E.preventDefault(),n(!0)},te=E=>{E.preventDefault(),n(!1)},ye=E=>{E.preventDefault(),n(!1);const y=E.dataTransfer?.files;y&&y.length>0&&$(y[0])},ae=E=>{const y=E.target;y.files&&y.files.length>0&&$(y.files[0])},$=E=>{if(!E.name.toLowerCase().endsWith(".csv")){c({success:!1,message:e("banking.pleaseUploadCSV")});return}o(!0);const y=new FileReader;y.onload=oe=>{try{const T=(oe.target?.result).split(`
`).filter(I=>I.trim());if(T.length<2){c({success:!1,message:e("banking.csvRequiresHeaderAndData")}),o(!1);return}const U=T[0].split(",").map(I=>I.trim().replace(/[\"\']/g,"")),B=T.slice(1).map(I=>{const N=I.split(",").map(j=>j.trim().replace(/[\"\']/g,"")),Z={};return U.forEach((j,J)=>{Z[j]=N[J]||""}),Z});h(B),c({success:!0,message:e("banking.successfullyParsed").replace("{count}",B.length.toString()),count:B.length});const x={...m()};U.forEach(I=>{const N=I.toLowerCase();N.includes("date")&&(x.date=I),(N.includes("description")||N.includes("memo"))&&(x.description=I),(N.includes("reference")||N.includes("check")||N.includes("ref"))&&(x.reference=I),(N.includes("debit")||N.includes("deposit"))&&(x.debit=I),(N.includes("credit")||N.includes("withdrawal")||N.includes("amount"))&&(x.debit?x.credit=I:x.debit=I),N.includes("balance")&&(x.balance=I)}),g(x)}catch{c({success:!1,message:e("banking.errorParsingCSV")})}o(!1)},y.readAsText(E)},S=(E,y)=>{g(oe=>({...oe,[E]:y}))},p=()=>d().length===0?[]:Object.keys(d()[0]),C=()=>{if(!t.bankAccount||d().length===0)return;const E=m();if(!E.date||!E.description){c({success:!1,message:e("banking.dateDescriptionRequired")});return}o(!0);try{const y=d().map(K=>{const T=I=>I&&parseFloat(I.replace(/[^0-9.-]/g,""))||0,U=I=>{const N=new Date(I);if(isNaN(N.getTime())){const Z=I.split("/");if(Z.length===3)return new Date(parseInt(Z[2]),parseInt(Z[0])-1,parseInt(Z[1])).toISOString().split("T")[0]}return N.toISOString().split("T")[0]};let B=0,x=0;if(E.debit&&E.credit)B=T(K[E.debit]),x=T(K[E.credit]);else if(E.debit){const I=T(K[E.debit]);I>0?B=I:x=Math.abs(I)}return{accountId:t.bankAccount.accountId,date:U(K[E.date]),description:K[E.description]||e("banking.importedTransaction"),reference:K[E.reference]||"",debitAmount:B,creditAmount:x,balance:E.balance?T(K[E.balance]):0,isReconciled:!1}}),oe=sr.addBankStatementsFromCSV(y);c({success:!0,message:e("banking.successfullyImported").replace("{count}",oe.length.toString()),count:oe.length}),h([]),g({date:"",description:"",reference:"",debit:"",credit:"",balance:""})}catch{c({success:!1,message:e("banking.errorImportingTransactions")})}o(!1)},P=()=>{h([]),c(null),g({date:"",description:"",reference:"",debit:"",credit:"",balance:""})};return b(gr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("banking.importBankStatementCSV")},get children(){return[fe(()=>fe(()=>!!t.bankAccount)()&&(()=>{var E=ux(),y=E.firstChild,oe=y.firstChild,K=y.nextSibling,T=K.nextSibling;return T.nextSibling,E.style.setProperty("margin-bottom","1.5rem"),E.style.setProperty("padding","1rem"),E.style.setProperty("background","var(--background-color)"),E.style.setProperty("border-radius","var(--border-radius-sm)"),E.style.setProperty("border","1px solid var(--border-color)"),s(y,()=>e("banking.bankAccount"),oe),s(E,()=>t.bankAccount.bankName,T),s(E,()=>t.bankAccount.accountNumber,null),E})()),fe(()=>fe(()=>d().length===0)()?(()=>{var E=dx(),y=E.firstChild,oe=y.firstChild,K=oe.nextSibling,T=K.nextSibling,U=y.nextSibling;return y.$$click=()=>document.getElementById("csvFileInput")?.click(),y.addEventListener("drop",ye),y.addEventListener("dragleave",te),y.addEventListener("dragover",ie),oe.style.setProperty("font-size","2rem"),oe.style.setProperty("margin-bottom","1rem"),K.style.setProperty("font-weight","500"),K.style.setProperty("margin-bottom","0.5rem"),s(K,(()=>{var B=fe(()=>!!r());return()=>B()?e("banking.dropCSVHere"):e("banking.clickToUploadCSV")})()),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","var(--text-muted)"),s(T,()=>e("banking.supportedFormat")),U.addEventListener("change",ae),U.style.setProperty("display","none"),re(B=>u(y,_,B)),E})():(()=>{var E=hx(),y=E.firstChild,oe=y.nextSibling,K=oe.firstChild,T=K.firstChild,U=T.firstChild,B=T.nextSibling,x=B.firstChild,I=K.nextSibling,N=I.firstChild,Z=N.firstChild,j=N.nextSibling,J=j.firstChild,w=I.nextSibling,V=w.firstChild,X=V.nextSibling,Y=X.firstChild,se=w.nextSibling,O=se.firstChild,F=O.firstChild,le=O.nextSibling,pe=le.firstChild,ve=se.nextSibling,ce=ve.firstChild,H=ce.nextSibling,D=H.firstChild,Q=ve.nextSibling,G=Q.firstChild,he=G.nextSibling,me=he.firstChild;return y.style.setProperty("margin","0 0 1rem 0"),s(y,()=>e("banking.mapCSVColumns")),u(oe,A),T.style.setProperty("display","block"),T.style.setProperty("margin-bottom","0.5rem"),T.style.setProperty("font-weight","500"),s(T,()=>e("banking.dateColumn"),U),B.addEventListener("change",ee=>S("date",ee.target.value)),s(x,()=>e("banking.selectColumn")),s(B,()=>p().map(ee=>(()=>{var ne=zi();return ne.value=ee,s(ne,ee),ne})()),null),N.style.setProperty("display","block"),N.style.setProperty("margin-bottom","0.5rem"),N.style.setProperty("font-weight","500"),s(N,()=>e("banking.descriptionColumn"),Z),j.addEventListener("change",ee=>S("description",ee.target.value)),s(J,()=>e("banking.selectColumn")),s(j,()=>p().map(ee=>(()=>{var ne=zi();return ne.value=ee,s(ne,ee),ne})()),null),V.style.setProperty("display","block"),V.style.setProperty("margin-bottom","0.5rem"),V.style.setProperty("font-weight","500"),s(V,()=>e("banking.referenceColumn")),X.addEventListener("change",ee=>S("reference",ee.target.value)),s(Y,()=>e("banking.selectColumn")),s(X,()=>p().map(ee=>(()=>{var ne=zi();return ne.value=ee,s(ne,ee),ne})()),null),O.style.setProperty("display","block"),O.style.setProperty("margin-bottom","0.5rem"),O.style.setProperty("font-weight","500"),s(O,()=>e("banking.amountDebitColumn"),F),le.addEventListener("change",ee=>S("debit",ee.target.value)),s(pe,()=>e("banking.selectColumn")),s(le,()=>p().map(ee=>(()=>{var ne=zi();return ne.value=ee,s(ne,ee),ne})()),null),ce.style.setProperty("display","block"),ce.style.setProperty("margin-bottom","0.5rem"),ce.style.setProperty("font-weight","500"),s(ce,()=>e("banking.creditColumn")),H.addEventListener("change",ee=>S("credit",ee.target.value)),s(D,()=>e("banking.selectColumn")),s(H,()=>p().map(ee=>(()=>{var ne=zi();return ne.value=ee,s(ne,ee),ne})()),null),G.style.setProperty("display","block"),G.style.setProperty("margin-bottom","0.5rem"),G.style.setProperty("font-weight","500"),s(G,()=>e("banking.balanceColumn")),he.addEventListener("change",ee=>S("balance",ee.target.value)),s(me,()=>e("banking.selectColumn")),s(he,()=>p().map(ee=>(()=>{var ne=zi();return ne.value=ee,s(ne,ee),ne})()),null),s(E,(()=>{var ee=fe(()=>d().length>0);return()=>ee()&&(()=>{var ne=mx(),Se=ne.firstChild,we=Se.firstChild,ue=we.firstChild,be=we.nextSibling;return u(ne,L),ue.style.setProperty("background-color","var(--background-color)"),s(ue,()=>p().slice(0,6).map(de=>(()=>{var Pe=fx();return s(Pe,de),re($e=>u(Pe,R,$e)),Pe})())),s(be,()=>d().slice(0,3).map(de=>(()=>{var Pe=yx();return s(Pe,()=>p().slice(0,6).map($e=>(()=>{var xe=gx();return s(xe,()=>de[$e]),re(ke=>u(xe,R,ke)),xe})())),Pe})())),s(ne,(()=>{var de=fe(()=>d().length>3);return()=>de()&&(()=>{var Pe=Dl();return Pe.style.setProperty("padding","0.5rem"),Pe.style.setProperty("text-align","center"),Pe.style.setProperty("color","var(--text-muted)"),s(Pe,()=>e("banking.andMoreRows").replace("{count}",(d().length-3).toString())),Pe})()})(),null),re(de=>u(Se,k,de)),ne})()})(),null),re(ee=>{var ne=M,Se=M,we=M,ue=M,be=M,de=M;return ee.e=u(B,ne,ee.e),ee.t=u(j,Se,ee.t),ee.a=u(X,we,ee.a),ee.o=u(le,ue,ee.o),ee.i=u(H,be,ee.i),ee.n=u(he,de,ee.n),ee},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),re(()=>B.value=m().date),re(()=>j.value=m().description),re(()=>X.value=m().reference),re(()=>le.value=m().debit),re(()=>H.value=m().credit),re(()=>he.value=m().balance),E})()),fe(()=>fe(()=>!!a())()&&(()=>{var E=Dl();return E.style.setProperty("padding","1rem"),E.style.setProperty("border-radius","var(--border-radius-sm)"),E.style.setProperty("margin-top","1rem"),s(E,()=>a().message),re(y=>{var oe=a().success?"#d4edda":"#f8d7da",K=a().success?"#155724":"#721c24",T=`1px solid ${a().success?"#c3e6cb":"#f5c6cb"}`;return oe!==y.e&&((y.e=oe)!=null?E.style.setProperty("background",oe):E.style.removeProperty("background")),K!==y.t&&((y.t=K)!=null?E.style.setProperty("color",K):E.style.removeProperty("color")),T!==y.a&&((y.a=T)!=null?E.style.setProperty("border",T):E.style.removeProperty("border")),y},{e:void 0,t:void 0,a:void 0}),E})()),(()=>{var E=Dl();return u(E,W),s(E,b(Le,{variant:"secondary",onClick:()=>{P(),t.onClose()},get children(){return e("common.cancel")}}),null),s(E,(()=>{var y=fe(()=>d().length>0);return()=>y()&&b(Le,{variant:"outline",onClick:P,get children(){return e("common.reset")}})})(),null),s(E,(()=>{var y=fe(()=>d().length>0);return()=>y()&&b(Le,{variant:"primary",onClick:C,get disabled(){return i()||!m().date||!m().description},get children(){return fe(()=>!!i())()?e("banking.importing"):e("banking.importTransactions").replace("{count}",d().length.toString())}})})(),null),E})()]}})};At(["click"]);var dm=z("<span>"),Ks=z("<div>"),hm=z("<div> "),vx=z("<div><div><h3></h3><div><button></button><button></button><button></button></div></div><div></div><div><div><h4></h4><div></div></div><div><h4></h4><div>"),bx=z("<div><div><div></div><div>  </div></div><div><div>"),Nl=z("<span> "),_x=z("<span>(<!>)"),Sx=z("<div><strong>:</strong> "),mm=z("<div><div><div></div><div>  </div></div><div>"),Px=z("<div><div>:</div><div></div><div>");const wx=t=>{const{t:e}=lt(),[r,n]=ge([]),[i,o]=ge([]),[a,c]=ge(null),[d,h]=ge([]),[m,g]=ge("unreconciled");Dn(()=>{const T=sr.getBankAccountById(t.bankAccountId);if(T){const U=sr.getBankStatementsByAccount(T.accountId).filter(x=>x.date>=t.selectedPeriod.start&&x.date<=t.selectedPeriod.end),B=sr.getEntryBookRecordsByAccount(T.accountId).filter(x=>x.date>=t.selectedPeriod.start&&x.date<=t.selectedPeriod.end);n(U),o(B)}});const _=()=>{const T=r();switch(m()){case"reconciled":return T.filter(U=>U.isReconciled);case"unreconciled":return T.filter(U=>!U.isReconciled);default:return T}},A=()=>{const T=i();switch(m()){case"reconciled":return T.filter(U=>U.isReconciled);case"unreconciled":return T.filter(U=>!U.isReconciled);default:return T}},M=T=>{if(c(T),T.isReconciled)h([]);else{const U=sr.findPotentialMatches(T.id);h(U)}},L=T=>{const U=a();if(U){sr.reconcileTransaction(U.id,T.id);const B=sr.getBankAccountById(t.bankAccountId);if(B){const x=sr.getBankStatementsByAccount(B.accountId).filter(N=>N.date>=t.selectedPeriod.start&&N.date<=t.selectedPeriod.end),I=sr.getEntryBookRecordsByAccount(B.accountId).filter(N=>N.date>=t.selectedPeriod.start&&N.date<=t.selectedPeriod.end);n(x),o(I)}c(null),h([])}},k=T=>{sr.unreconciledTransaction(T.id);const U=sr.getBankAccountById(t.bankAccountId);if(U){const B=sr.getBankStatementsByAccount(U.accountId).filter(I=>I.date>=t.selectedPeriod.start&&I.date<=t.selectedPeriod.end),x=sr.getEntryBookRecordsByAccount(U.accountId).filter(I=>I.date>=t.selectedPeriod.start&&I.date<=t.selectedPeriod.end);n(B),o(x)}},R={display:"grid","grid-template-columns":"1fr 1fr",gap:"2rem","margin-top":"2rem"},W={height:"600px","overflow-y":"auto"},ie={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},te=T=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:T?"var(--primary-color)":"var(--surface-color)",color:T?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),ye=(T,U)=>({display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem","margin-bottom":"0.5rem",background:T?"var(--primary-color)":U?"#e8f5e8":"var(--surface-color)",color:T?"white":"var(--text-primary)","border-radius":"var(--border-radius-sm)",border:`1px solid ${T?"var(--primary-color)":U?"#c3e6cb":"var(--border-color)"}`,cursor:"pointer",transition:"all 0.2s ease"}),ae={flex:"1"},$={"font-weight":"500","margin-bottom":"0.25rem"},S={"font-size":"0.875rem",opacity:"0.8"},p=T=>({"font-weight":"600",color:T?"#4caf50":"#f44336"}),C={padding:"0.25rem 0.5rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","margin-left":"0.5rem"},P=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T),E=T=>new Date(T).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),y=T=>{if(!a())return null;const U=a();return(Math.abs(U.debitAmount-T.debitAmount)<.01||Math.abs(U.creditAmount-T.creditAmount)<.01)&&U.date===T.date?(()=>{var I=dm();return s(I,()=>e("banking.exactMatch")),re(N=>u(I,{...C,background:"#d4edda",color:"#155724"},N)),I})():d().includes(T)?(()=>{var I=dm();return s(I,()=>e("banking.possibleMatch")),re(N=>u(I,{...C,background:"#fff3cd",color:"#856404"},N)),I})():null},K=(()=>{const T=r(),U=i(),B=T.filter(I=>I.isReconciled).length,x=U.filter(I=>I.isReconciled).length;return{totalStatements:T.length,totalRecords:U.length,reconciledStatements:B,reconciledRecords:x,unreconciledStatements:T.length-B,unreconciledRecords:U.length-x}})();return(()=>{var T=vx(),U=T.firstChild,B=U.firstChild,x=B.nextSibling,I=x.firstChild,N=I.nextSibling,Z=N.nextSibling,j=U.nextSibling,J=j.nextSibling,w=J.firstChild,V=w.firstChild,X=V.nextSibling,Y=w.nextSibling,se=Y.firstChild,O=se.nextSibling;return u(U,ie),B.style.setProperty("margin","0"),B.style.setProperty("font-size","1.25rem"),s(B,()=>e("banking.reconciliationComparison")),x.style.setProperty("display","flex"),x.style.setProperty("gap","0.5rem"),I.$$click=()=>g("all"),s(I,()=>e("common.all")),N.$$click=()=>g("unreconciled"),s(N,()=>e("banking.unreconciled")),Z.$$click=()=>g("reconciled"),s(Z,()=>e("banking.reconciled")),j.style.setProperty("display","grid"),j.style.setProperty("grid-template-columns","repeat(4, 1fr)"),j.style.setProperty("gap","1rem"),j.style.setProperty("margin-bottom","2rem"),s(j,b(tt,{get title(){return e("banking.bankStatements")},get subtitle(){return e("banking.totalTransactions")},get children(){return[(()=>{var F=Ks();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","var(--primary-color)"),s(F,()=>K.totalStatements),F})(),(()=>{var F=hm(),le=F.firstChild;return F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),s(F,()=>K.reconciledStatements,le),s(F,()=>e("banking.reconciled"),null),F})()]}}),null),s(j,b(tt,{get title(){return e("banking.entryBookRecords")},get subtitle(){return e("banking.totalEntries")},get children(){return[(()=>{var F=Ks();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","var(--primary-color)"),s(F,()=>K.totalRecords),F})(),(()=>{var F=hm(),le=F.firstChild;return F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),s(F,()=>K.reconciledRecords,le),s(F,()=>e("banking.reconciled"),null),F})()]}}),null),s(j,b(tt,{get title(){return e("banking.unreconciledBank")},get subtitle(){return e("banking.needAttention")},get children(){var F=Ks();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","#f44336"),s(F,()=>K.unreconciledStatements),F}}),null),s(j,b(tt,{get title(){return e("banking.unreconciledBooks")},get subtitle(){return e("banking.needAttention")},get children(){var F=Ks();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","#f44336"),s(F,()=>K.unreconciledRecords),F}}),null),u(J,R),V.style.setProperty("margin","0 0 1rem 0"),s(V,()=>e("banking.bankStatements")),s(X,()=>_().map(F=>(()=>{var le=bx(),pe=le.firstChild,ve=pe.firstChild,ce=ve.nextSibling,H=ce.firstChild,D=pe.nextSibling,Q=D.firstChild;return le.$$click=()=>M(F),s(ve,()=>F.description),s(ce,()=>E(F.date),H),s(ce,()=>F.reference,null),s(ce,(()=>{var G=fe(()=>!!F.isReconciled);return()=>G()&&(()=>{var he=Nl();return he.firstChild,he.style.setProperty("color","#4caf50"),he.style.setProperty("margin-left","0.5rem"),s(he,()=>e("banking.reconciled"),null),he})()})(),null),s(Q,()=>F.debitAmount>0?"+":"-",null),s(Q,()=>P(F.debitAmount||F.creditAmount),null),s(D,(()=>{var G=fe(()=>!!F.isReconciled);return()=>G()&&b(Le,{variant:"outline",size:"sm",onClick:he=>{he.stopPropagation(),k(F)},style:{"margin-top":"0.5rem"},get children(){return e("banking.unreconcile")}})})(),null),re(G=>{var he=ye(a()?.id===F.id,F.isReconciled),me=ae,ee=$,ne=S,Se=p(F.debitAmount>0);return G.e=u(le,he,G.e),G.t=u(pe,me,G.t),G.a=u(ve,ee,G.a),G.o=u(ce,ne,G.o),G.i=u(Q,Se,G.i),G},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),le})())),se.style.setProperty("margin","0 0 1rem 0"),s(se,()=>e("banking.entryBookRecords"),null),s(se,(()=>{var F=fe(()=>!!(a()&&!a().isReconciled));return()=>F()&&(()=>{var le=_x(),pe=le.firstChild,ve=pe.nextSibling;return ve.nextSibling,le.style.setProperty("font-weight","400"),le.style.setProperty("color","var(--text-muted)"),le.style.setProperty("margin-left","0.5rem"),s(le,()=>e("banking.clickToReconcile"),ve),le})()})(),null),s(O,(()=>{var F=fe(()=>!!(a()&&!a().isReconciled));return()=>F()?[fe(()=>fe(()=>d().length>0)()&&(()=>{var le=Sx(),pe=le.firstChild,ve=pe.firstChild;return pe.nextSibling,le.style.setProperty("margin-bottom","1rem"),le.style.setProperty("padding","0.75rem"),le.style.setProperty("background","#fff3cd"),le.style.setProperty("border-radius","var(--border-radius-sm)"),s(pe,()=>e("banking.potentialMatchesFound"),ve),s(le,()=>e("banking.clickRecordToReconcile"),null),le})()),fe(()=>A().map(le=>(d().includes(le),(()=>{var pe=mm(),ve=pe.firstChild,ce=ve.firstChild,H=ce.nextSibling,D=H.firstChild,Q=ve.nextSibling;return pe.$$click=()=>{le.isReconciled||L(le)},s(ce,()=>le.description,null),s(ce,()=>y(le),null),s(H,()=>E(le.date),D),s(H,()=>le.reference,null),s(H,(()=>{var G=fe(()=>!!le.isReconciled);return()=>G()&&(()=>{var he=Nl();return he.firstChild,he.style.setProperty("color","#4caf50"),he.style.setProperty("margin-left","0.5rem"),s(he,()=>e("banking.reconciled"),null),he})()})(),null),s(Q,()=>le.debitAmount>0?"+":"-",null),s(Q,()=>P(le.debitAmount||le.creditAmount),null),re(G=>{var he={...ye(!1,le.isReconciled),opacity:le.isReconciled?.6:1,cursor:le.isReconciled?"not-allowed":"pointer"},me=ae,ee=$,ne=S,Se=p(le.debitAmount>0);return G.e=u(pe,he,G.e),G.t=u(ve,me,G.t),G.a=u(ce,ee,G.a),G.o=u(H,ne,G.o),G.i=u(Q,Se,G.i),G},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),pe})())))]:A().map(le=>(()=>{var pe=mm(),ve=pe.firstChild,ce=ve.firstChild,H=ce.nextSibling,D=H.firstChild,Q=ve.nextSibling;return s(ce,()=>le.description),s(H,()=>E(le.date),D),s(H,()=>le.reference,null),s(H,(()=>{var G=fe(()=>!!le.isReconciled);return()=>G()&&(()=>{var he=Nl();return he.firstChild,he.style.setProperty("color","#4caf50"),he.style.setProperty("margin-left","0.5rem"),s(he,()=>e("banking.reconciled"),null),he})()})(),null),s(Q,()=>le.debitAmount>0?"+":"-",null),s(Q,()=>P(le.debitAmount||le.creditAmount),null),re(G=>{var he=ye(!1,le.isReconciled),me=ae,ee=$,ne=S,Se=p(le.debitAmount>0);return G.e=u(pe,he,G.e),G.t=u(ve,me,G.t),G.a=u(ce,ee,G.a),G.o=u(H,ne,G.o),G.i=u(Q,Se,G.i),G},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),pe})())})()),s(T,(()=>{var F=fe(()=>!!(a()&&!a().isReconciled));return()=>F()&&(()=>{var le=Px(),pe=le.firstChild,ve=pe.firstChild,ce=pe.nextSibling,H=ce.nextSibling;return le.style.setProperty("position","fixed"),le.style.setProperty("bottom","2rem"),le.style.setProperty("right","2rem"),le.style.setProperty("background","var(--surface-color)"),le.style.setProperty("padding","1rem"),le.style.setProperty("border-radius","var(--border-radius)"),le.style.setProperty("box-shadow","var(--shadow-lg)"),le.style.setProperty("border","1px solid var(--border-color)"),le.style.setProperty("max-width","300px"),pe.style.setProperty("font-weight","500"),pe.style.setProperty("margin-bottom","0.5rem"),s(pe,()=>e("banking.selected"),ve),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("margin-bottom","0.5rem"),s(ce,()=>a().description),H.style.setProperty("font-weight","600"),H.style.setProperty("color","var(--primary-color)"),s(H,()=>P(a().debitAmount||a().creditAmount)),s(le,b(Le,{variant:"secondary",size:"sm",onClick:()=>{c(null),h([])},style:{"margin-top":"0.5rem"},get children(){return e("banking.clearSelection")}}),null),le})()})(),null),re(F=>{var le=te(m()==="all"),pe=te(m()==="unreconciled"),ve=te(m()==="reconciled"),ce=W,H=W;return F.e=u(I,le,F.e),F.t=u(N,pe,F.t),F.a=u(Z,ve,F.a),F.o=u(X,ce,F.o),F.i=u(O,H,F.i),F},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),T})()};At(["click"]);var Cx=z("<div><div><h2></h2><p></p></div><div>"),Ax=z("<div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date>"),Ix=z("<div><button></button><button>"),Ex=z("<div><br>"),Do=z("<div>"),xx=z("<div><div></div><div>  </div><div>"),Tx=z("<div>: "),$x=z("<div> <!>  <!> "),kx=z("<div>%"),Rx=z("<div> of <!> transactions");const Dx=()=>{const{t}=lt(),[e,r]=ge(null),[n,i]=ge({start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[o,a]=ge(!1),[c,d]=ge("overview");Dn(()=>{!e()&&sr.bankAccounts.length>0&&r(sr.bankAccounts[0])});const h={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},m={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},g={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},_=ie=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:ie?"var(--primary-color)":"var(--text-muted)","border-bottom":ie?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),A={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},M=ie=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ie),L=ie=>new Date(ie).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),k=()=>sr.bankAccounts.map(ie=>({value:ie.id,label:`${ie.bankName} - ${ie.accountNumber} (${ie.accountType})`})),W=(()=>{if(!e())return null;const ie=sr.getBankStatementsByAccount(e().accountId).filter(ae=>ae.date>=n().start&&ae.date<=n().end),te=sr.getEntryBookRecordsByAccount(e().accountId).filter(ae=>ae.date>=n().start&&ae.date<=n().end),ye=ie.filter(ae=>ae.isReconciled).length;return te.filter(ae=>ae.isReconciled).length,{totalBankTransactions:ie.length,totalEntryBookRecords:te.length,reconciledTransactions:ye,unreconciledTransactions:ie.length-ye,reconciliationRate:ie.length>0?ye/ie.length*100:0}})();return b(kr,{get title(){return t("banking.title")},get children(){return[(()=>{var ie=Cx(),te=ie.firstChild,ye=te.firstChild,ae=ye.nextSibling,$=te.nextSibling;return u(ie,h),ye.style.setProperty("margin","0 0 0.5rem 0"),ye.style.setProperty("font-size","1.5rem"),s(ye,()=>t("banking.reconciliation")),ae.style.setProperty("margin","0"),ae.style.setProperty("color","var(--text-muted)"),s(ae,()=>t("banking.compareStatements")),$.style.setProperty("display","flex"),$.style.setProperty("gap","1rem"),s($,b(Le,{variant:"secondary",onClick:()=>a(!0),get disabled(){return!e()},get children(){return t("banking.importCSV")}}),null),s($,b(Le,{variant:"primary",get children(){return t("banking.startNewReconciliation")}}),null),ie})(),(()=>{var ie=Ax(),te=ie.firstChild,ye=te.firstChild,ae=te.nextSibling,$=ae.firstChild,S=$.nextSibling,p=ae.nextSibling,C=p.firstChild,P=C.nextSibling;return u(ie,m),te.style.setProperty("flex","1"),ye.style.setProperty("display","block"),ye.style.setProperty("margin-bottom","0.5rem"),ye.style.setProperty("font-weight","500"),s(ye,()=>t("banking.bankAccount")),s(te,b(mr,{label:"",get value(){return e()?.id||""},onChange:E=>{const y=sr.getBankAccountById(E);r(y||null)},get options(){return k()}}),null),$.style.setProperty("display","block"),$.style.setProperty("margin-bottom","0.5rem"),$.style.setProperty("font-weight","500"),s($,()=>t("entryBooks.startDate")),S.addEventListener("change",E=>i(y=>({...y,start:E.target.value}))),S.style.setProperty("padding","0.75rem"),S.style.setProperty("border","1px solid var(--border-color)"),S.style.setProperty("border-radius","var(--border-radius-sm)"),S.style.setProperty("font-family","inherit"),C.style.setProperty("display","block"),C.style.setProperty("margin-bottom","0.5rem"),C.style.setProperty("font-weight","500"),s(C,()=>t("entryBooks.endDate")),P.addEventListener("change",E=>i(y=>({...y,end:E.target.value}))),P.style.setProperty("padding","0.75rem"),P.style.setProperty("border","1px solid var(--border-color)"),P.style.setProperty("border-radius","var(--border-radius-sm)"),P.style.setProperty("font-family","inherit"),re(()=>S.value=n().start),re(()=>P.value=n().end),ie})(),(()=>{var ie=Ix(),te=ie.firstChild,ye=te.nextSibling;return u(ie,g),te.$$click=()=>d("overview"),s(te,()=>t("common.overview")),ye.$$click=()=>d("reconciliation"),s(ye,()=>t("banking.reconciliation")),re(ae=>{var $=_(c()==="overview"),S=_(c()==="reconciliation");return ae.e=u(te,$,ae.e),ae.t=u(ye,S,ae.t),ae},{e:void 0,t:void 0}),ie})(),fe(()=>fe(()=>c()==="overview")()&&(()=>{var ie=Do();return s(ie,(()=>{var te=fe(()=>!!e());return()=>te()&&(()=>{var ye=Do();return u(ye,A),s(ye,b(tt,{get title(){return t("banking.bankAccountInfo")},get subtitle(){return t("banking.currentAccountDetails")},get children(){return[(()=>{var ae=xx(),$=ae.firstChild,S=$.nextSibling,p=S.firstChild,C=S.nextSibling;return ae.style.setProperty("margin-bottom","1rem"),$.style.setProperty("font-weight","600"),$.style.setProperty("margin-bottom","0.5rem"),s($,()=>e().bankName),S.style.setProperty("color","var(--text-muted)"),S.style.setProperty("margin-bottom","0.5rem"),s(S,()=>e().accountNumber,p),s(S,()=>e().accountType,null),C.style.setProperty("font-size","1.25rem"),C.style.setProperty("font-weight","600"),C.style.setProperty("color","var(--primary-color)"),s(C,()=>M(e().currentBalance)),ae})(),fe(()=>fe(()=>!!e().lastReconciledDate)()&&(()=>{var ae=Tx(),$=ae.firstChild;return ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),s(ae,()=>t("banking.lastReconciled"),$),s(ae,()=>L(e().lastReconciledDate),null),ae})())]}}),null),s(ye,W&&[b(tt,{get title(){return t("banking.bankTransactions")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var ae=Do();return ae.style.setProperty("font-size","1.5rem"),ae.style.setProperty("font-weight","600"),ae.style.setProperty("color","var(--primary-color)"),ae.style.setProperty("margin-bottom","0.5rem"),s(ae,()=>W.totalBankTransactions),ae})(),(()=>{var ae=$x(),$=ae.firstChild,S=$.nextSibling,p=S.nextSibling,C=p.nextSibling;return C.nextSibling,ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),s(ae,()=>W.reconciledTransactions,$),s(ae,()=>t("banking.reconciled"),S),s(ae,()=>W.unreconciledTransactions,C),s(ae,()=>t("banking.pending"),null),ae})()]}}),b(tt,{get title(){return t("entryBooks.entryBookRecords")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var ae=Do();return ae.style.setProperty("font-size","1.5rem"),ae.style.setProperty("font-weight","600"),ae.style.setProperty("color","var(--primary-color)"),ae.style.setProperty("margin-bottom","0.5rem"),s(ae,()=>W.totalEntryBookRecords),ae})(),(()=>{var ae=Do();return ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),s(ae,()=>t("banking.bookEntriesForComparison")),ae})()]}}),b(tt,{get title(){return t("banking.reconciliationRate")},get subtitle(){return t("banking.completionStatus")},get children(){return[(()=>{var ae=kx(),$=ae.firstChild;return ae.style.setProperty("font-size","1.5rem"),ae.style.setProperty("font-weight","600"),ae.style.setProperty("margin-bottom","0.5rem"),s(ae,()=>Math.round(W.reconciliationRate),$),re(S=>(S=W.reconciliationRate>80?"#4caf50":W.reconciliationRate>50?"#ff9800":"#f44336")!=null?ae.style.setProperty("color",S):ae.style.removeProperty("color")),ae})(),(()=>{var ae=Rx(),$=ae.firstChild,S=$.nextSibling;return S.nextSibling,ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),s(ae,()=>W.reconciledTransactions,$),s(ae,()=>W.totalBankTransactions,S),ae})()]}})],null),ye})()})(),null),s(ie,b(tt,{get title(){return t("banking.recentReconciliationSessions")},get subtitle(){return t("banking.latestActivity")},get children(){var te=Ex(),ye=te.firstChild;return te.style.setProperty("text-align","center"),te.style.setProperty("color","var(--text-muted)"),te.style.setProperty("padding","2rem"),s(te,()=>t("banking.noRecentSessions"),ye),s(te,b(Le,{variant:"primary",style:{"margin-top":"1rem"},onClick:()=>d("reconciliation"),get children(){return t("banking.startFirstReconciliation")}}),null),te}}),null),ie})()),fe(()=>fe(()=>!!(c()==="reconciliation"&&e()))()&&b(wx,{get bankAccountId(){return e().id},get selectedPeriod(){return n()}})),b(px,{get isOpen(){return o()},onClose:()=>a(!1),get bankAccount(){return e()}})]}})};At(["click"]);var Nx=z("<div><div></div><div>"),Ll=z("<div>"),Lx=z("<div>  <!>  <!> "),Mx=z("<div><div><div></div><div></div></div><div><div></div><div>"),Ox=z("<div><div>:"),Vx=z("<div> <!>: <!> <!>, <!> "),Bx=z("<div><div><div></div><div></div></div><div>"),fm=z("<div> "),Fx=z("<div> ");const Ux=t=>{const{t:e}=lt(),r={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},n={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},i={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},o={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"0.5rem"},a={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"1rem"},c={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},d={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},h={"max-height":"100px","overflow-y":"auto","border-top":"1px solid var(--border-color)","padding-top":"1rem"},m={display:"flex","justify-content":"space-between","align-items":"center","font-size":"0.875rem","margin-bottom":"0.5rem"},g={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},_=R=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[R],A=R=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(R),M=R=>new Date(R).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),L=_(t.entry.status),k=Math.abs(t.entry.totalDebit-t.entry.totalCredit)<.01;return b(tt,{get children(){return[(()=>{var R=Nx(),W=R.firstChild,ie=W.nextSibling;return u(R,r),u(W,n),s(W,()=>t.entry.entryNumber),s(ie,()=>t.entry.status),re(te=>u(ie,{...i,background:L.bg,color:L.color},te)),R})(),(()=>{var R=Ll();return u(R,o),s(R,()=>t.entry.description),R})(),(()=>{var R=Lx(),W=R.firstChild,ie=W.nextSibling,te=ie.nextSibling,ye=te.nextSibling;return ye.nextSibling,u(R,a),s(R,()=>M(t.entry.date),W),s(R,()=>t.entry.reference||e("journal.noReference","No reference"),ie),s(R,()=>e("journal.createdBy","By"),ye),s(R,()=>t.entry.createdBy,null),R})(),(()=>{var R=Mx(),W=R.firstChild,ie=W.firstChild,te=ie.nextSibling,ye=W.nextSibling,ae=ye.firstChild,$=ae.nextSibling;return u(R,c),ie.style.setProperty("font-size","0.875rem"),ie.style.setProperty("color","var(--text-muted)"),s(ie,()=>e("journal.totalAmount","Total Amount")),u(te,d),s(te,()=>A(t.entry.totalDebit)),ye.style.setProperty("text-align","right"),ae.style.setProperty("font-size","0.875rem"),ae.style.setProperty("color","var(--text-muted)"),s(ae,()=>e("journal.lines","Lines")),$.style.setProperty("font-weight","600"),s($,()=>t.entry.lines.length),R})(),fe(()=>!k&&(()=>{var R=Vx(),W=R.firstChild,ie=W.nextSibling,te=ie.nextSibling,ye=te.nextSibling,ae=ye.nextSibling,$=ae.nextSibling,S=$.nextSibling,p=S.nextSibling;return p.nextSibling,R.style.setProperty("padding","0.5rem"),R.style.setProperty("border-radius","var(--border-radius-sm)"),R.style.setProperty("background","#f8d7da"),R.style.setProperty("color","#721c24"),R.style.setProperty("font-size","0.875rem"),R.style.setProperty("margin-bottom","1rem"),s(R,()=>e("journal.entryNotBalancedShort","Entry is not balanced"),ie),s(R,()=>e("journal.debit"),ye),s(R,()=>A(t.entry.totalDebit),$),s(R,()=>e("journal.credit"),p),s(R,()=>A(t.entry.totalCredit),null),R})()),(()=>{var R=Ox(),W=R.firstChild,ie=W.firstChild;return u(R,h),W.style.setProperty("font-weight","500"),W.style.setProperty("margin-bottom","0.5rem"),W.style.setProperty("font-size","0.875rem"),s(W,()=>e("journal.accountLines","Account Lines"),ie),s(R,()=>t.entry.lines.slice(0,3).map(te=>(()=>{var ye=Bx(),ae=ye.firstChild,$=ae.firstChild,S=$.nextSibling,p=ae.nextSibling;return u(ye,m),ae.style.setProperty("flex","1"),$.style.setProperty("font-weight","500"),s($,()=>te.accountName),S.style.setProperty("font-size","0.75rem"),S.style.setProperty("color","var(--text-muted)"),s(S,()=>te.description||e("journal.noDescription","No description")),p.style.setProperty("text-align","right"),s(p,(()=>{var C=fe(()=>te.debitAmount>0);return()=>C()&&(()=>{var P=fm(),E=P.firstChild;return P.style.setProperty("color","#4caf50"),P.style.setProperty("font-weight","500"),s(P,()=>e("journal.debitShort","Dr."),E),s(P,()=>A(te.debitAmount),null),P})()})(),null),s(p,(()=>{var C=fe(()=>te.creditAmount>0);return()=>C()&&(()=>{var P=fm(),E=P.firstChild;return P.style.setProperty("color","#f44336"),P.style.setProperty("font-weight","500"),s(P,()=>e("journal.creditShort","Cr."),E),s(P,()=>A(te.creditAmount),null),P})()})(),null),s(p,(()=>{var C=fe(()=>!!te.reconciled);return()=>C()&&(()=>{var P=Fx();return P.firstChild,P.style.setProperty("font-size","0.75rem"),P.style.setProperty("color","#4caf50"),s(P,()=>e("banking.reconciled","Reconciled"),null),P})()})(),null),ye})()),null),s(R,(()=>{var te=fe(()=>t.entry.lines.length>3);return()=>te()&&(()=>{var ye=Ll();return ye.style.setProperty("text-align","center"),ye.style.setProperty("color","var(--text-muted)"),ye.style.setProperty("font-size","0.875rem"),s(ye,()=>e("journal.andMoreLines","... and {count} more lines").replace("{count}",(t.entry.lines.length-3).toString())),ye})()})(),null),R})(),(()=>{var R=Ll();return u(R,g),s(R,b(Le,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.entry),get children(){return e("journal.viewDetails","View Details")}})),R})()]}})},jx=[{id:"je1",entryNumber:"JE-2024-001",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",status:"posted",createdBy:"John Doe",createdAt:"2024-01-15T09:00:00Z",postedAt:"2024-01-15T09:05:00Z",totalDebit:5e3,totalCredit:5e3,lines:[{id:"jel1",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment from ABC Corp",debitAmount:5e3,creditAmount:0,reconciled:!0,reconciledWith:"eb1"},{id:"jel2",accountId:"2001",accountName:"Trade Receivables",description:"Payment received for INV-2024-001",debitAmount:0,creditAmount:5e3}]},{id:"je2",entryNumber:"JE-2024-002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",status:"posted",createdBy:"Jane Smith",createdAt:"2024-01-14T10:00:00Z",postedAt:"2024-01-14T10:15:00Z",totalDebit:250,totalCredit:250,lines:[{id:"jel3",accountId:"5200",accountName:"Office Expenses",description:"Office supplies from Staples",debitAmount:250,creditAmount:0},{id:"jel4",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment to Staples",debitAmount:0,creditAmount:250,reconciled:!0,reconciledWith:"eb2"}]},{id:"je3",entryNumber:"JE-2024-003",date:"2024-01-13",description:"Monthly Rent Payment",reference:"RENT-2024-01",status:"posted",createdBy:"John Doe",createdAt:"2024-01-13T08:00:00Z",postedAt:"2024-01-13T08:30:00Z",totalDebit:2e3,totalCredit:2e3,lines:[{id:"jel5",accountId:"5200",accountName:"Rent Expense",description:"January office rent",debitAmount:2e3,creditAmount:0},{id:"jel6",accountId:"1002",accountName:"Bank - Checking Account",description:"Rent payment",debitAmount:0,creditAmount:2e3,reconciled:!1}]},{id:"je4",entryNumber:"JE-2024-004",date:"2024-01-12",description:"Wire Transfer - Capital Investment",reference:"WIRE-001",status:"posted",createdBy:"Admin",createdAt:"2024-01-12T14:00:00Z",postedAt:"2024-01-12T14:30:00Z",totalDebit:1e4,totalCredit:1e4,lines:[{id:"jel7",accountId:"1002",accountName:"Bank - Checking Account",description:"Wire transfer received",debitAmount:1e4,creditAmount:0,reconciled:!1},{id:"jel8",accountId:"8",accountName:"Owner's Equity",description:"Capital investment",debitAmount:0,creditAmount:1e4}]},{id:"je5",entryNumber:"JE-2024-005",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",status:"posted",createdBy:"HR Manager",createdAt:"2024-01-11T16:00:00Z",postedAt:"2024-01-11T16:30:00Z",totalDebit:3500,totalCredit:3500,lines:[{id:"jel9",accountId:"13",accountName:"Salaries Expense",description:"Monthly salary - John Doe",debitAmount:3500,creditAmount:0},{id:"jel10",accountId:"1002",accountName:"Bank - Checking Account",description:"Salary payment",debitAmount:0,creditAmount:3500,reconciled:!1}]},{id:"je6",entryNumber:"JE-2024-006",date:"2024-01-10",description:"Product Sales - Multiple Customers",reference:"SALES-2024-010",status:"posted",createdBy:"Sales Manager",createdAt:"2024-01-10T11:00:00Z",postedAt:"2024-01-10T11:30:00Z",totalDebit:8500,totalCredit:8500,lines:[{id:"jel11",accountId:"1001",accountName:"Petty Cash",description:"Cash sales",debitAmount:1500,creditAmount:0},{id:"jel12",accountId:"2001",accountName:"Trade Receivables",description:"Credit sales",debitAmount:7e3,creditAmount:0},{id:"jel13",accountId:"10",accountName:"Sales Revenue",description:"Product sales revenue",debitAmount:0,creditAmount:8500}]},{id:"je7",entryNumber:"JE-2024-007",date:"2024-01-09",description:"Inventory Purchase",reference:"PO-2024-002",status:"draft",createdBy:"Warehouse Manager",createdAt:"2024-01-09T15:00:00Z",totalDebit:15e3,totalCredit:15e3,lines:[{id:"jel14",accountId:"3",accountName:"Inventory",description:"Product inventory purchase",debitAmount:15e3,creditAmount:0},{id:"jel15",accountId:"5",accountName:"Accounts Payable",description:"Amount owed to supplier",debitAmount:0,creditAmount:15e3}]},{id:"je8",entryNumber:"JE-2024-008",date:"2024-01-08",description:"Utility Bills Payment",reference:"UTIL-2024-01",status:"posted",createdBy:"Admin",createdAt:"2024-01-08T09:00:00Z",postedAt:"2024-01-08T09:30:00Z",totalDebit:450,totalCredit:450,lines:[{id:"jel16",accountId:"14",accountName:"Operating Expenses",description:"Electricity and water bills",debitAmount:450,creditAmount:0},{id:"jel17",accountId:"1003",accountName:"Bank - Savings Account",description:"Utility payment",debitAmount:0,creditAmount:450}]}],[Dr,Ml]=ge(jx),ym=()=>Dr().filter(e=>e.status==="posted").flatMap(e=>e.lines.filter(r=>["1001","1002","1003"].includes(r.accountId))).map(e=>{const r=Dr().find(n=>n.lines.some(i=>i.id===e.id));return r?{id:`eb_${e.id}`,accountId:e.accountId,date:r.date,description:r.description,reference:r.reference,debitAmount:e.debitAmount,creditAmount:e.creditAmount,category:e.accountName,isReconciled:e.reconciled||!1,reconciledWith:e.reconciledWith,createdAt:r.createdAt}:null}).filter(e=>e!==null),An={get journalEntries(){return Dr()},addJournalEntry(t){const e={...t,id:Date.now().toString()};return Ml([...Dr(),e]),e},updateJournalEntry(t,e){Ml(Dr().map(r=>r.id===t?{...r,...e}:r))},deleteJournalEntry(t){const e=Dr().find(r=>r.id===t);if(e&&e.status==="posted")throw new Error("Cannot delete posted journal entries. Void them instead.");Ml(Dr().filter(r=>r.id!==t))},voidJournalEntry(t){this.updateJournalEntry(t,{status:"void"})},postJournalEntry(t){const e=Dr().find(r=>r.id===t);if(!e)throw new Error("Journal entry not found");if(Math.abs(e.totalDebit-e.totalCredit)>.01)throw new Error("Journal entry is not balanced. Debits must equal credits.");this.updateJournalEntry(t,{status:"posted",postedAt:new Date().toISOString()}),ym()},getJournalEntryById(t){return Dr().find(e=>e.id===t)},getJournalEntriesByStatus(t){return Dr().filter(e=>e.status===t)},getJournalEntriesByDateRange(t,e){return Dr().filter(r=>r.date>=t&&r.date<=e)},getJournalEntriesByAccount(t){return Dr().filter(e=>e.lines.some(r=>r.accountId===t))},getNextEntryNumber(){const t=new Date().getFullYear(),r=Dr().filter(n=>n.entryNumber.includes(t.toString())).reduce((n,i)=>{const o=parseInt(i.entryNumber.split("-").pop()||"0");return o>n?o:n},0);return`JE-${t}-${String(r+1).padStart(3,"0")}`},validateJournalEntry(t){const e=[];if(t.date||e.push("Date is required"),t.description||e.push("Description is required"),(!t.lines||t.lines.length===0)&&e.push("At least one line item is required"),t.lines){const r=t.lines.reduce((i,o)=>i+(o.debitAmount||0),0),n=t.lines.reduce((i,o)=>i+(o.creditAmount||0),0);Math.abs(r-n)>.01&&e.push(`Entry is not balanced. Debit: ${r}, Credit: ${n}`),t.lines.forEach((i,o)=>{i.accountId||e.push(`Line ${o+1}: Account is required`),i.debitAmount===0&&i.creditAmount===0&&e.push(`Line ${o+1}: Either debit or credit amount must be provided`),i.debitAmount>0&&i.creditAmount>0&&e.push(`Line ${o+1}: Cannot have both debit and credit amounts`)})}return{isValid:e.length===0,errors:e}},getBankRelatedEntries(){return ym()}};var zx=z("<form><div></div><div><div><h4></h4></div><div><div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div></div></div><div><div><strong>: </strong></div><div><strong>: </strong></div><div></div></div></div><div>"),gm=z("<div>");const Cg=t=>{const{t:e}=lt(),[r,n]=ge({entryNumber:"",date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),[i,o]=ge([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),[a,c]=ge(null);Dn(()=>{if(t.isOpen){if(t.editEntry)n({entryNumber:t.editEntry.entryNumber,date:t.editEntry.date,description:t.editEntry.description,reference:t.editEntry.reference,createdBy:t.editEntry.createdBy}),o(t.editEntry.lines.map((te,ye)=>({...te,tempId:`line_${Date.now()}_${ye}`})));else{const te=An.getNextEntryNumber();n({entryNumber:te,date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),o([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])}c(null)}});const d={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},h={display:"grid","grid-template-columns":"2fr 2fr 1fr 1fr 1fr",gap:"1rem","align-items":"end","margin-bottom":"1rem",padding:"1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},m={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},g=()=>bt.accounts.map(te=>({value:te.id,label:`${te.accountNumber} - ${te.name}`})),_=(te,ye)=>{n(ae=>({...ae,[te]:ye}))},A=(te,ye,ae)=>{o($=>$.map(S=>{if(S.tempId===te){const p={...S,[ye]:ae};if(ye==="accountId"&&typeof ae=="string"){const C=bt.getAccountById(ae);C&&(p.accountName=C.name)}return p}return S}))},M=()=>{o(te=>[...te,{tempId:`line_${Date.now()}_${te.length}`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])},L=te=>{i().length>2&&o(ye=>ye.filter(ae=>ae.tempId!==te))},k=()=>{const te=i().reduce((ae,$)=>ae+($.debitAmount||0),0),ye=i().reduce((ae,$)=>ae+($.creditAmount||0),0);return{totalDebit:te,totalCredit:ye,isBalanced:Math.abs(te-ye)<.01}},R=te=>{te.preventDefault(),c(null);const ye=r(),ae=i(),{totalDebit:$,totalCredit:S,isBalanced:p}=k();if(!ye.description){c(e("forms.descriptionRequired","Description is required"));return}if(ae.length<2){c(e("journal.minTwoLinesRequired","At least 2 line items are required"));return}if(!p){c(e("journal.entryNotBalanced","Entry is not balanced. Debit: ${debit}, Credit: ${credit}").replace("${debit}",`$${$.toFixed(2)}`).replace("${credit}",`$${S.toFixed(2)}`));return}for(let P=0;P<ae.length;P++){const E=ae[P];if(!E.accountId){c(e("journal.lineAccountRequired","Line {lineNumber}: Account is required").replace("{lineNumber}",(P+1).toString()));return}if(E.debitAmount===0&&E.creditAmount===0){c(e("journal.lineAmountRequired","Line {lineNumber}: Either debit or credit amount must be provided").replace("{lineNumber}",(P+1).toString()));return}if((E.debitAmount||0)>0&&(E.creditAmount||0)>0){c(e("journal.lineBothAmounts","Line {lineNumber}: Cannot have both debit and credit amounts").replace("{lineNumber}",(P+1).toString()));return}}const C={entryNumber:ye.entryNumber,date:ye.date,description:ye.description,reference:ye.reference,status:"draft",createdBy:ye.createdBy,createdAt:new Date().toISOString(),totalDebit:$,totalCredit:S,lines:ae.map((P,E)=>{const{tempId:y,...oe}=P;return{id:`jel_${Date.now()}_${E}`,...oe}})};try{t.editEntry?An.updateJournalEntry(t.editEntry.id,C):An.addJournalEntry(C),n({entryNumber:An.getNextEntryNumber(),date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:"Current User"}),o([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),t.onClose()}catch(P){c(P instanceof Error?P.message:e("forms.errorOccurred","An error occurred"))}},W=te=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(te),ie=k();return b(gr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return fe(()=>!!t.editEntry)()?e("journal.editEntry"):e("journal.addEntry","Add Journal Entry")},get children(){var te=zx(),ye=te.firstChild,ae=ye.nextSibling,$=ae.firstChild,S=$.firstChild,p=$.nextSibling,C=p.firstChild,P=C.firstChild,E=P.firstChild,y=P.nextSibling,oe=y.firstChild,K=y.nextSibling,T=K.firstChild,U=K.nextSibling,B=U.firstChild,x=U.nextSibling,I=x.firstChild,N=p.nextSibling,Z=N.firstChild,j=Z.firstChild,J=j.firstChild,w=Z.nextSibling,V=w.firstChild,X=V.firstChild,Y=w.nextSibling,se=ae.nextSibling;return te.addEventListener("submit",R),ye.style.setProperty("display","grid"),ye.style.setProperty("grid-template-columns","1fr 1fr"),ye.style.setProperty("gap","1rem"),s(ye,b(kt,{get label(){return e("journal.entryNumber")},get value(){return r().entryNumber},onChange:O=>_("entryNumber",O),get disabled(){return!!t.editEntry},required:!0}),null),s(ye,b(kt,{get label(){return e("common.date")},type:"date",get value(){return r().date},onChange:O=>_("date",O),required:!0}),null),s(te,b(kt,{get label(){return e("common.description")},get value(){return r().description},onChange:O=>_("description",O),get placeholder(){return e("journal.enterEntryDescription","Enter journal entry description")},required:!0}),ae),s(te,b(kt,{get label(){return e("journal.reference")},get value(){return r().reference},onChange:O=>_("reference",O),get placeholder(){return e("journal.enterReferenceNumber","Enter reference number")}}),ae),ae.style.setProperty("margin-top","2rem"),$.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),$.style.setProperty("margin-bottom","1rem"),S.style.setProperty("margin","0"),s(S,()=>e("journal.entryLines","Journal Entry Lines")),s($,b(Le,{type:"button",variant:"secondary",size:"sm",onClick:M,get children(){return e("journal.addLine","Add Line")}}),null),p.style.setProperty("margin-bottom","1rem"),p.style.setProperty("font-size","0.875rem"),p.style.setProperty("color","var(--text-muted)"),C.style.setProperty("display","grid"),C.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1fr"),C.style.setProperty("gap","1rem"),s(E,()=>e("journal.account")),s(oe,()=>e("common.description")),s(T,()=>e("journal.debit")),s(B,()=>e("journal.credit")),s(I,()=>e("common.actions")),s(ae,b(pt,{get each(){return i()},children:O=>(()=>{var F=gm();return u(F,h),s(F,b(mr,{label:"",get value(){return O.accountId||""},onChange:le=>A(O.tempId,"accountId",le),get options(){return g()}}),null),s(F,b(kt,{label:"",get value(){return O.description||""},onChange:le=>A(O.tempId,"description",le),get placeholder(){return e("journal.lineDescription","Line description")}}),null),s(F,b(kt,{label:"",type:"number",get value(){return O.debitAmount?.toString()||"0"},onChange:le=>{A(O.tempId,"debitAmount",parseFloat(le)||0),parseFloat(le)>0&&A(O.tempId,"creditAmount",0)},placeholder:"0.00"}),null),s(F,b(kt,{label:"",type:"number",get value(){return O.creditAmount?.toString()||"0"},onChange:le=>{A(O.tempId,"creditAmount",parseFloat(le)||0),parseFloat(le)>0&&A(O.tempId,"debitAmount",0)},placeholder:"0.00"}),null),s(F,b(Le,{type:"button",variant:"outline",size:"sm",onClick:()=>L(O.tempId),get disabled(){return i().length<=2},get children(){return e("common.remove","Remove")}}),null),F})()}),N),u(N,m),s(j,()=>e("journal.totalDebit","Total Debit"),J),s(j,()=>W(ie.totalDebit),null),s(V,()=>e("journal.totalCredit","Total Credit"),X),s(V,()=>W(ie.totalCredit),null),Y.style.setProperty("font-weight","600"),s(Y,(()=>{var O=fe(()=>!!ie.isBalanced);return()=>O()?` ${e("journal.balanced")}`:` ${e("journal.notBalanced","Not Balanced")}`})()),s(te,(()=>{var O=fe(()=>!!a());return()=>O()&&(()=>{var F=gm();return F.style.setProperty("padding","1rem"),F.style.setProperty("border-radius","var(--border-radius-sm)"),F.style.setProperty("margin-top","1rem"),F.style.setProperty("background","#f8d7da"),F.style.setProperty("color","#721c24"),F.style.setProperty("border","1px solid #f5c6cb"),s(F,a),F})()})(),se),u(se,d),s(se,b(Le,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),s(se,b(Le,{variant:"primary",type:"submit",get disabled(){return!ie.isBalanced},get children(){return fe(()=>!!t.editEntry)()?e("journal.updateEntry","Update Entry"):e("journal.saveAsDraft","Save as Draft")}}),null),re(O=>(O=ie.isBalanced?"#4caf50":"#f44336")!=null?Y.style.setProperty("color",O):Y.style.removeProperty("color")),te}})};var qx=z("<div><div></div><div></div><div></div><div>"),Gx=z("<div><div></div><div></div><div></div><div></div><div>"),Hx=z("<div><button></button><button> (<!>)</button><button> (<!>/<!>)"),pm=z("<div>"),Yx=z("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><div><h4></h4><div></div></div><div>"),Ol=z("<div><span></span><span>"),Vl=z("<div><strong>:</strong> "),Wx=z("<div><div><div></div><div></div><div></div><div></div><div></div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div></div></div><div><div><strong> Reconciliation Summary</strong></div><div><div><div><strong>Total Lines:</strong> </div><div><strong>Reconciled:</strong> </div><div><strong>Unreconciled:</strong> </div></div><div><div><strong>Bank Accounts:</strong> </div><div><strong>Bank Reconciled:</strong> "),Kx=z("<div><div><div></div><div></div></div><div></div><div></div><div></div><div>"),Qx=z("<div><span> "),Jx=z("<span>(<!>)"),Xx=z("<div><strong>Bank Pending:</strong> "),Zx=z("<div><div>Reconciled Lines:"),e2=z("<div><div> Pending Bank Reconciliation:</div><div>Visit Bank Consolidations to reconcile these transactions"),t2=z("<div><div><div><span></span><h3></h3></div><div><div><div></div><div>Total Lines</div></div><div><div></div><div>Reconciled</div></div><div><div></div><div>Pending"),r2=z("<div><h4> Reconciled Lines (<!>)"),n2=z("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div> Matched"),i2=z("<div> "),o2=z("<div><h4> Unreconciled Lines (<!>)"),s2=z("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div> Pending"),a2=z("<div>Bank account"),l2=z("<div><div> Reconciliation Tip</div><div>This entry has unreconciled bank account transactions. Visit <strong>Bank Consolidations</strong> to match these with bank statements.");const c2=t=>{const{t:e}=lt(),[r,n]=ge("details"),[i,o]=ge(!1),a=We(()=>t.entryId?An.getJournalEntryById(t.entryId):null),c={"text-align":"center","margin-bottom":"2rem",position:"relative"},d={position:"absolute",top:"0",right:"0",display:"flex",gap:"0.5rem"},h={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","margin-bottom":"0.5rem"},m={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},g={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},_={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem",display:"inline-block"},A={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},M={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},L={"font-weight":"600",color:"var(--text-primary)"},k={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},R=y=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:y?"var(--primary-color)":"var(--text-muted)","border-bottom":y?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),W={display:"grid","grid-template-columns":"2fr 2.5fr 1fr 1fr 1.5fr",gap:"1rem",padding:"1rem 0","border-bottom":"1px solid var(--border-color)","align-items":"center"},ie={...W,"font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","border-bottom":"2px solid var(--border-color)"},te={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},ye={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},ae=y=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[y],$=y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(y),S=y=>new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),p=y=>new Date(y).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),C=()=>{entry.status==="posted"&&!confirm(e("journal.confirmEditPosted","This entry has been posted. Editing will create a new draft copy. Continue?"))||o(!0)},P=()=>{if(a()&&confirm(e("journal.confirmPost","Are you sure you want to post this journal entry? This action cannot be undone.")))try{An.postJournalEntry(a().id)}catch(y){alert(y instanceof Error?y.message:e("forms.errorPostingEntry","An error occurred while posting the entry"))}},E=()=>{a()&&confirm(e("journal.confirmVoid","Are you sure you want to void this journal entry?"))&&An.voidJournalEntry(a().id)};return[b(gr,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.entryDetails","Journal Entry Details")},get children(){return fe(()=>!a())()?(()=>{var y=qx(),oe=y.firstChild,K=oe.nextSibling,T=K.nextSibling,U=T.nextSibling;return y.style.setProperty("text-align","center"),y.style.setProperty("padding","3rem"),y.style.setProperty("color","var(--text-muted)"),oe.style.setProperty("font-size","1.5rem"),oe.style.setProperty("margin-bottom","1rem"),K.style.setProperty("font-size","1.1rem"),K.style.setProperty("margin-bottom","0.5rem"),s(K,()=>e("journal.entryNotFound","Entry Not Found")),T.style.setProperty("font-size","0.875rem"),s(T,()=>e("journal.entryNotFoundMessage","The journal entry you're looking for could not be found or may have been deleted.")),U.style.setProperty("margin-top","2rem"),s(U,b(Le,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),y})():(()=>{const y=a(),oe=ae(y.status),K=Math.abs(y.totalDebit-y.totalCredit)<.01;return[(()=>{var T=Gx(),U=T.firstChild,B=U.nextSibling,x=B.nextSibling,I=x.nextSibling,N=I.nextSibling;return u(T,c),s(U,b(Le,{variant:"outline",size:"sm",onClick:C,get title(){return e("journal.editEntryTooltip","Edit this journal entry")},get children(){return e("common.edit")}}),null),s(U,(()=>{var Z=fe(()=>y.status==="draft");return()=>Z()&&b(Le,{variant:"primary",size:"sm",onClick:P,disabled:!K,get title(){return K?e("journal.postEntryTooltip","Post this journal entry"):e("journal.entryMustBeBalanced","Entry must be balanced to post")},get children(){return e("journal.post","Post")}})})(),null),s(U,(()=>{var Z=fe(()=>y.status==="posted");return()=>Z()&&b(Le,{variant:"outline",size:"sm",onClick:E,style:{color:"#dc3545","border-color":"#dc3545"},get title(){return e("journal.voidEntryTooltip","Void this journal entry")},get children(){return e("entryBooks.void","Void")}})})(),null),u(B,h),s(B,()=>y.entryNumber),u(x,m),s(x,()=>y.description),u(I,g),s(I,()=>$(y.totalDebit)),s(N,()=>y.status),re(Z=>{var j=d,J={..._,background:oe.bg,color:oe.color};return Z.e=u(U,j,Z.e),Z.t=u(N,J,Z.t),Z},{e:void 0,t:void 0}),T})(),(()=>{var T=Hx(),U=T.firstChild,B=U.nextSibling,x=B.firstChild,I=x.nextSibling;I.nextSibling;var N=B.nextSibling,Z=N.firstChild,j=Z.nextSibling,J=j.nextSibling,w=J.nextSibling;return w.nextSibling,u(T,k),U.$$click=()=>n("details"),s(U,()=>e("common.details")),B.$$click=()=>n("lines"),s(B,()=>e("journal.journalLines","Journal Lines"),x),s(B,()=>y.lines.length,I),N.$$click=()=>n("reconciliation"),s(N,()=>e("banking.reconciliation","Reconciliation"),Z),s(N,()=>y.lines.filter(V=>V.reconciled).length,j),s(N,()=>y.lines.length,w),re(V=>{var X=R(r()==="details"),Y=R(r()==="lines"),se=R(r()==="reconciliation");return V.e=u(U,X,V.e),V.t=u(B,Y,V.t),V.a=u(N,se,V.a),V},{e:void 0,t:void 0,a:void 0}),T})(),fe(()=>fe(()=>r()==="details")()&&(()=>{var T=Yx(),U=T.firstChild,B=U.firstChild,x=B.nextSibling,I=U.nextSibling,N=I.firstChild,Z=N.nextSibling,j=I.nextSibling,J=j.firstChild,w=J.nextSibling,V=j.nextSibling,X=V.firstChild,Y=X.nextSibling,se=V.nextSibling,O=se.firstChild,F=O.nextSibling,le=se.nextSibling,pe=le.firstChild,ve=pe.nextSibling,ce=le.nextSibling,H=ce.firstChild,D=H.nextSibling,Q=ce.nextSibling,G=Q.firstChild,he=G.firstChild,me=he.nextSibling,ee=G.nextSibling;return s(B,()=>e("common.date")),s(x,()=>S(y.date)),s(N,()=>e("journal.reference")),s(Z,()=>y.reference||e("common.notAvailable","N/A")),s(J,()=>e("journal.totalDebit")),s(w,()=>$(y.totalDebit)),s(X,()=>e("journal.totalCredit")),s(Y,()=>$(y.totalCredit)),s(O,()=>e("journal.balanceStatus","Balance Status")),s(F,()=>K?`${e("journal.balanced")} `:`${e("journal.unbalanced","Unbalanced")} (${$(Math.abs(y.totalDebit-y.totalCredit))} ${e("journal.difference","difference")})`),s(pe,()=>e("journal.createdBy")),s(ve,()=>y.createdBy),s(H,()=>e("journal.createdAt","Created At")),s(D,()=>p(y.createdAt)),s(T,(()=>{var ne=fe(()=>!!y.postedAt);return()=>ne()&&(()=>{var Se=Ol(),we=Se.firstChild,ue=we.nextSibling;return s(we,()=>e("journal.postedAt","Posted At")),s(ue,()=>p(y.postedAt)),re(be=>{var de=A,Pe=M,$e=L;return be.e=u(Se,de,be.e),be.t=u(we,Pe,be.t),be.a=u(ue,$e,be.a),be},{e:void 0,t:void 0,a:void 0}),Se})()})(),Q),Q.style.setProperty("margin-top","2rem"),Q.style.setProperty("padding-top","1rem"),Q.style.setProperty("border-top","2px solid var(--border-color)"),G.style.setProperty("display","flex"),G.style.setProperty("justify-content","space-between"),G.style.setProperty("align-items","center"),G.style.setProperty("margin-bottom","1rem"),he.style.setProperty("margin","0"),he.style.setProperty("font-size","1rem"),s(he,()=>e("journal.quickActions","Quick Actions")),me.style.setProperty("display","flex"),me.style.setProperty("gap","0.5rem"),s(me,b(Le,{variant:"primary",size:"sm",onClick:C,get children(){return[" ",fe(()=>e("journal.editEntry"))]}}),null),s(me,(()=>{var ne=fe(()=>y.status==="draft");return()=>ne()&&b(Le,{variant:"outline",size:"sm",onClick:P,disabled:!K,style:{"border-color":K?"#4caf50":"#f44336",color:K?"#4caf50":"#f44336"},get children(){return K?` ${e("journal.postEntry","Post Entry")}`:` ${e("journal.fixBalance","Fix Balance")}`}})})(),null),s(me,(()=>{var ne=fe(()=>y.status==="posted");return()=>ne()&&b(Le,{variant:"outline",size:"sm",onClick:E,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return[" ",fe(()=>e("journal.voidEntry","Void Entry"))]}})})(),null),ee.style.setProperty("padding","1rem"),ee.style.setProperty("border-radius","var(--border-radius-sm)"),ee.style.setProperty("font-size","0.875rem"),s(ee,(()=>{var ne=fe(()=>y.status==="draft");return()=>ne()&&(()=>{var Se=Vl(),we=Se.firstChild,ue=we.firstChild;return we.nextSibling,s(we,()=>e("journal.draftEntry","Draft Entry"),ue),s(Se,()=>e("journal.draftEntryDescription","This entry can be edited and posted."),null),s(Se,()=>!K&&`  ${e("journal.entryMustBeBalancedBeforePosting","Entry must be balanced before posting.")}`,null),Se})()})(),null),s(ee,(()=>{var ne=fe(()=>y.status==="posted");return()=>ne()&&(()=>{var Se=Vl(),we=Se.firstChild,ue=we.firstChild;return we.nextSibling,s(we,()=>e("journal.postedEntry","Posted Entry"),ue),s(Se,()=>e("journal.postedEntryDescription","This entry has been posted to the general ledger. Editing will create a new draft copy."),null),Se})()})(),null),s(ee,(()=>{var ne=fe(()=>y.status==="void");return()=>ne()&&(()=>{var Se=Vl(),we=Se.firstChild,ue=we.firstChild;return we.nextSibling,s(we,()=>e("journal.voidEntry"),ue),s(Se,()=>e("journal.voidEntryDescription","This entry has been voided and cannot be modified."),null),Se})()})(),null),re(ne=>{var Se=A,we=M,ue=L,be=A,de=M,Pe=L,$e=A,xe=M,ke=L,Be=A,Qe=M,Ue=L,Te=A,Fe=M,Je={...L,color:K?"#4caf50":"#f44336"},Ge=A,Xe=M,Ae=L,Ie=A,Ze=M,dt=L,ft=y.status==="draft"?"#fff3cd":y.status==="posted"?"#d4edda":"#f8d7da";return ne.e=u(U,Se,ne.e),ne.t=u(B,we,ne.t),ne.a=u(x,ue,ne.a),ne.o=u(I,be,ne.o),ne.i=u(N,de,ne.i),ne.n=u(Z,Pe,ne.n),ne.s=u(j,$e,ne.s),ne.h=u(J,xe,ne.h),ne.r=u(w,ke,ne.r),ne.d=u(V,Be,ne.d),ne.l=u(X,Qe,ne.l),ne.u=u(Y,Ue,ne.u),ne.c=u(se,Te,ne.c),ne.w=u(O,Fe,ne.w),ne.m=u(F,Je,ne.m),ne.f=u(le,Ge,ne.f),ne.y=u(pe,Xe,ne.y),ne.g=u(ve,Ae,ne.g),ne.p=u(ce,Ie,ne.p),ne.b=u(H,Ze,ne.b),ne.T=u(D,dt,ne.T),ft!==ne.A&&((ne.A=ft)!=null?ee.style.setProperty("background",ft):ee.style.removeProperty("background")),ne},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),T})()),fe(()=>fe(()=>r()==="lines")()&&(()=>{var T=Wx(),U=T.firstChild,B=U.firstChild,x=B.nextSibling,I=x.nextSibling,N=I.nextSibling,Z=N.nextSibling,j=U.nextSibling,J=j.firstChild,w=J.firstChild,V=w.firstChild;w.nextSibling;var X=J.nextSibling,Y=X.firstChild,se=Y.firstChild;Y.nextSibling;var O=X.nextSibling,F=j.nextSibling,le=F.firstChild,pe=le.nextSibling,ve=pe.firstChild,ce=ve.firstChild,H=ce.firstChild;H.nextSibling;var D=ce.nextSibling,Q=D.firstChild;Q.nextSibling;var G=D.nextSibling,he=G.firstChild;he.nextSibling;var me=ve.nextSibling,ee=me.firstChild,ne=ee.firstChild;ne.nextSibling;var Se=ee.nextSibling,we=Se.firstChild;return we.nextSibling,s(B,()=>e("journal.account")),s(x,()=>e("common.description")),s(I,()=>e("journal.debit")),s(N,()=>e("journal.credit")),s(Z,()=>e("banking.reconciliation")),s(T,b(pt,{get each(){return y.lines},children:ue=>(()=>{var be=Kx(),de=be.firstChild,Pe=de.firstChild,$e=Pe.nextSibling,xe=de.nextSibling,ke=xe.nextSibling,Be=ke.nextSibling,Qe=Be.nextSibling;return Pe.style.setProperty("font-weight","500"),s(Pe,()=>ue.accountName),$e.style.setProperty("font-size","0.75rem"),$e.style.setProperty("color","var(--text-muted)"),s($e,()=>bt.getAccountById(ue.accountId)?.accountNumber||ue.accountId),xe.style.setProperty("font-size","0.875rem"),s(xe,()=>ue.description||"-"),ke.style.setProperty("font-weight","600"),s(ke,(()=>{var Ue=fe(()=>ue.debitAmount>0);return()=>Ue()?$(ue.debitAmount):"-"})()),Be.style.setProperty("font-weight","600"),s(Be,(()=>{var Ue=fe(()=>ue.creditAmount>0);return()=>Ue()?$(ue.creditAmount):"-"})()),s(Qe,(()=>{var Ue=fe(()=>!!ue.reconciled);return()=>Ue()?(()=>{var Te=Qx(),Fe=Te.firstChild;return Fe.firstChild,Te.style.setProperty("display","flex"),Te.style.setProperty("align-items","center"),Te.style.setProperty("gap","0.5rem"),Te.style.setProperty("color","#4caf50"),Te.style.setProperty("font-size","0.875rem"),Fe.style.setProperty("font-weight","600"),s(Fe,()=>e("banking.reconciled"),null),s(Te,(()=>{var Je=fe(()=>!!ue.reconciledWith);return()=>Je()&&(()=>{var Ge=Jx(),Xe=Ge.firstChild,Ae=Xe.nextSibling;return Ae.nextSibling,Ge.style.setProperty("font-size","0.75rem"),Ge.style.setProperty("color","var(--text-muted)"),Ge.style.setProperty("font-style","italic"),s(Ge,()=>ue.reconciledWith,Ae),Ge})()})(),null),Te})():(()=>{var Te=pm();return Te.style.setProperty("color","var(--text-muted)"),Te.style.setProperty("font-size","0.875rem"),s(Te,()=>e("banking.notReconciled","Not Reconciled")),Te})()})()),re(Ue=>{var Te=W,Fe=ue.debitAmount>0?"#4caf50":"var(--text-muted)",Je=ue.creditAmount>0?"#f44336":"var(--text-muted)";return Ue.e=u(be,Te,Ue.e),Fe!==Ue.t&&((Ue.t=Fe)!=null?ke.style.setProperty("color",Fe):ke.style.removeProperty("color")),Je!==Ue.a&&((Ue.a=Je)!=null?Be.style.setProperty("color",Je):Be.style.removeProperty("color")),Ue},{e:void 0,t:void 0,a:void 0}),be})()}),j),u(j,te),s(w,()=>e("journal.totalDebit"),V),s(J,()=>$(y.totalDebit),null),s(Y,()=>e("journal.totalCredit"),se),s(X,()=>$(y.totalCredit),null),(K?"#4caf50":"#f44336")!=null?O.style.setProperty("color",K?"#4caf50":"#f44336"):O.style.removeProperty("color"),O.style.setProperty("font-weight","600"),s(O,()=>K?` ${e("journal.balanced")}`:` ${e("journal.notBalanced","Not Balanced")}`),F.style.setProperty("margin-top","1rem"),F.style.setProperty("padding","1rem"),F.style.setProperty("border-radius","var(--border-radius-sm)"),F.style.setProperty("font-size","0.875rem"),le.style.setProperty("margin-bottom","0.5rem"),pe.style.setProperty("display","grid"),pe.style.setProperty("grid-template-columns","1fr 1fr"),pe.style.setProperty("gap","1rem"),ce.style.setProperty("margin-bottom","0.25rem"),s(ce,()=>y.lines.length,null),D.style.setProperty("margin-bottom","0.25rem"),D.style.setProperty("color","#4caf50"),s(D,()=>y.lines.filter(ue=>ue.reconciled).length,null),G.style.setProperty("color","#f44336"),s(G,()=>y.lines.filter(ue=>!ue.reconciled).length,null),ee.style.setProperty("margin-bottom","0.25rem"),s(ee,()=>y.lines.filter(ue=>["1001","1002","1003"].includes(ue.accountId)).length,null),Se.style.setProperty("margin-bottom","0.25rem"),Se.style.setProperty("color","#4caf50"),s(Se,()=>y.lines.filter(ue=>["1001","1002","1003"].includes(ue.accountId)&&ue.reconciled).length,null),s(me,(()=>{var ue=fe(()=>y.lines.filter(be=>["1001","1002","1003"].includes(be.accountId)&&!be.reconciled).length>0);return()=>ue()&&(()=>{var be=Xx(),de=be.firstChild;return de.nextSibling,be.style.setProperty("color","#f44336"),s(be,()=>y.lines.filter(Pe=>["1001","1002","1003"].includes(Pe.accountId)&&!Pe.reconciled).length,null),be})()})(),null),s(F,(()=>{var ue=fe(()=>y.lines.filter(be=>be.reconciled).length>0);return()=>ue()&&(()=>{var be=Zx(),de=be.firstChild;return be.style.setProperty("margin-top","0.75rem"),be.style.setProperty("padding-top","0.75rem"),be.style.setProperty("border-top","1px solid var(--border-color)"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),s(be,()=>y.lines.filter(Pe=>Pe.reconciled).map(Pe=>(()=>{var $e=Ol(),xe=$e.firstChild,ke=xe.nextSibling;return $e.style.setProperty("display","flex"),$e.style.setProperty("justify-content","space-between"),$e.style.setProperty("margin-bottom","0.25rem"),$e.style.setProperty("font-size","0.8rem"),s(xe,()=>Pe.accountName),ke.style.setProperty("color","var(--text-muted)"),s(ke,()=>Pe.reconciledWith?` ${Pe.reconciledWith}`:"Manual"),$e})()),null),be})()})(),null),s(F,(()=>{var ue=fe(()=>y.lines.filter(be=>!be.reconciled&&["1001","1002","1003"].includes(be.accountId)).length>0);return()=>ue()&&(()=>{var be=e2(),de=be.firstChild,Pe=de.nextSibling;return be.style.setProperty("margin-top","0.75rem"),be.style.setProperty("padding-top","0.75rem"),be.style.setProperty("border-top","1px solid var(--border-color)"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),de.style.setProperty("color","#f44336"),s(be,()=>y.lines.filter($e=>!$e.reconciled&&["1001","1002","1003"].includes($e.accountId)).map($e=>(()=>{var xe=Ol(),ke=xe.firstChild,Be=ke.nextSibling;return xe.style.setProperty("display","flex"),xe.style.setProperty("justify-content","space-between"),xe.style.setProperty("margin-bottom","0.25rem"),xe.style.setProperty("font-size","0.8rem"),xe.style.setProperty("color","#f44336"),s(ke,()=>$e.accountName),s(Be,()=>$($e.debitAmount||$e.creditAmount)),xe})()),Pe),Pe.style.setProperty("margin-top","0.5rem"),Pe.style.setProperty("font-size","0.75rem"),Pe.style.setProperty("color","var(--text-muted)"),Pe.style.setProperty("font-style","italic"),be})()})(),null),re(ue=>{var be=ie,de=y.lines.some(Pe=>Pe.reconciled)?"#e8f5e8":"#fff3cd";return ue.e=u(U,be,ue.e),de!==ue.t&&((ue.t=de)!=null?F.style.setProperty("background",de):F.style.removeProperty("background")),ue},{e:void 0,t:void 0}),T})()),fe(()=>fe(()=>r()==="reconciliation")()&&(()=>{var T=t2(),U=T.firstChild,B=U.firstChild,x=B.firstChild,I=x.nextSibling,N=B.nextSibling,Z=N.firstChild,j=Z.firstChild,J=j.nextSibling,w=Z.nextSibling,V=w.firstChild,X=V.nextSibling,Y=w.nextSibling,se=Y.firstChild,O=se.nextSibling;return U.style.setProperty("margin-bottom","1.5rem"),U.style.setProperty("padding","1rem"),U.style.setProperty("border-radius","var(--border-radius)"),U.style.setProperty("border","1px solid var(--border-color)"),B.style.setProperty("display","flex"),B.style.setProperty("align-items","center"),B.style.setProperty("gap","0.5rem"),B.style.setProperty("margin-bottom","1rem"),x.style.setProperty("font-size","1.5rem"),s(x,(()=>{var F=fe(()=>!!y.lines.every(le=>le.reconciled));return()=>F()?"":y.lines.some(le=>le.reconciled)?"":""})()),I.style.setProperty("margin","0"),I.style.setProperty("font-size","1.2rem"),s(I,(()=>{var F=fe(()=>!!y.lines.every(le=>le.reconciled));return()=>F()?"Fully Reconciled":y.lines.some(le=>le.reconciled)?"Partially Reconciled":"Unreconciled"})()),N.style.setProperty("display","grid"),N.style.setProperty("grid-template-columns","1fr 1fr 1fr"),N.style.setProperty("gap","1rem"),Z.style.setProperty("text-align","center"),j.style.setProperty("font-size","2rem"),j.style.setProperty("font-weight","700"),j.style.setProperty("color","var(--primary-color)"),s(j,()=>y.lines.length),J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-muted)"),w.style.setProperty("text-align","center"),V.style.setProperty("font-size","2rem"),V.style.setProperty("font-weight","700"),V.style.setProperty("color","#4caf50"),s(V,()=>y.lines.filter(F=>F.reconciled).length),X.style.setProperty("font-size","0.875rem"),X.style.setProperty("color","var(--text-muted)"),Y.style.setProperty("text-align","center"),se.style.setProperty("font-size","2rem"),se.style.setProperty("font-weight","700"),se.style.setProperty("color","#f44336"),s(se,()=>y.lines.filter(F=>!F.reconciled).length),O.style.setProperty("font-size","0.875rem"),O.style.setProperty("color","var(--text-muted)"),s(T,(()=>{var F=fe(()=>y.lines.filter(le=>le.reconciled).length>0);return()=>F()&&(()=>{var le=r2(),pe=le.firstChild,ve=pe.firstChild,ce=ve.nextSibling;return ce.nextSibling,le.style.setProperty("margin-bottom","1.5rem"),pe.style.setProperty("margin","0 0 1rem 0"),pe.style.setProperty("font-size","1.1rem"),pe.style.setProperty("color","#4caf50"),pe.style.setProperty("display","flex"),pe.style.setProperty("align-items","center"),pe.style.setProperty("gap","0.5rem"),s(pe,()=>y.lines.filter(H=>H.reconciled).length,ce),s(le,()=>y.lines.filter(H=>H.reconciled).map(H=>(()=>{var D=n2(),Q=D.firstChild,G=Q.firstChild,he=G.nextSibling,me=Q.nextSibling,ee=me.nextSibling,ne=ee.nextSibling,Se=ne.nextSibling,we=Se.firstChild;return D.style.setProperty("display","grid"),D.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),D.style.setProperty("gap","1rem"),D.style.setProperty("padding","0.75rem"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("background","#f0f9f0"),D.style.setProperty("border-radius","var(--border-radius-sm)"),D.style.setProperty("align-items","center"),D.style.setProperty("font-size","0.875rem"),G.style.setProperty("font-weight","500"),s(G,()=>H.accountName),he.style.setProperty("font-size","0.75rem"),he.style.setProperty("color","var(--text-muted)"),s(he,()=>bt.getAccountById(H.accountId)?.accountNumber),me.style.setProperty("color","var(--text-muted)"),s(me,()=>H.description||"No description"),ee.style.setProperty("font-weight","600"),s(ee,(()=>{var ue=fe(()=>H.debitAmount>0);return()=>ue()?$(H.debitAmount):"-"})()),ne.style.setProperty("font-weight","600"),s(ne,(()=>{var ue=fe(()=>H.creditAmount>0);return()=>ue()?$(H.creditAmount):"-"})()),Se.style.setProperty("color","#4caf50"),we.style.setProperty("font-weight","500"),s(Se,(()=>{var ue=fe(()=>!!H.reconciledWith);return()=>ue()&&(()=>{var be=i2();return be.firstChild,be.style.setProperty("font-size","0.75rem"),be.style.setProperty("font-style","italic"),s(be,()=>H.reconciledWith,null),be})()})(),null),re(ue=>{var be=H.debitAmount>0?"#4caf50":"var(--text-muted)",de=H.creditAmount>0?"#f44336":"var(--text-muted)";return be!==ue.e&&((ue.e=be)!=null?ee.style.setProperty("color",be):ee.style.removeProperty("color")),de!==ue.t&&((ue.t=de)!=null?ne.style.setProperty("color",de):ne.style.removeProperty("color")),ue},{e:void 0,t:void 0}),D})()),null),le})()})(),null),s(T,(()=>{var F=fe(()=>y.lines.filter(le=>!le.reconciled).length>0);return()=>F()&&(()=>{var le=o2(),pe=le.firstChild,ve=pe.firstChild,ce=ve.nextSibling;return ce.nextSibling,le.style.setProperty("margin-bottom","1.5rem"),pe.style.setProperty("margin","0 0 1rem 0"),pe.style.setProperty("font-size","1.1rem"),pe.style.setProperty("color","#f44336"),pe.style.setProperty("display","flex"),pe.style.setProperty("align-items","center"),pe.style.setProperty("gap","0.5rem"),s(pe,()=>y.lines.filter(H=>!H.reconciled).length,ce),s(le,()=>y.lines.filter(H=>!H.reconciled).map(H=>(()=>{var D=s2(),Q=D.firstChild,G=Q.firstChild,he=G.nextSibling,me=Q.nextSibling,ee=me.nextSibling,ne=ee.nextSibling,Se=ne.nextSibling,we=Se.firstChild;return D.style.setProperty("display","grid"),D.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),D.style.setProperty("gap","1rem"),D.style.setProperty("padding","0.75rem"),D.style.setProperty("margin-bottom","0.5rem"),D.style.setProperty("background","#fff9f0"),D.style.setProperty("border-radius","var(--border-radius-sm)"),D.style.setProperty("align-items","center"),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("border","1px solid #ffe0b3"),G.style.setProperty("font-weight","500"),s(G,()=>H.accountName),he.style.setProperty("font-size","0.75rem"),he.style.setProperty("color","var(--text-muted)"),s(he,()=>bt.getAccountById(H.accountId)?.accountNumber),me.style.setProperty("color","var(--text-muted)"),s(me,()=>H.description||"No description"),ee.style.setProperty("font-weight","600"),s(ee,(()=>{var ue=fe(()=>H.debitAmount>0);return()=>ue()?$(H.debitAmount):"-"})()),ne.style.setProperty("font-weight","600"),s(ne,(()=>{var ue=fe(()=>H.creditAmount>0);return()=>ue()?$(H.creditAmount):"-"})()),Se.style.setProperty("color","#f44336"),we.style.setProperty("font-weight","500"),s(Se,(()=>{var ue=fe(()=>!!["1001","1002","1003"].includes(H.accountId));return()=>ue()&&(()=>{var be=a2();return be.style.setProperty("font-size","0.75rem"),be.style.setProperty("font-style","italic"),be})()})(),null),re(ue=>{var be=H.debitAmount>0?"#4caf50":"var(--text-muted)",de=H.creditAmount>0?"#f44336":"var(--text-muted)";return be!==ue.e&&((ue.e=be)!=null?ee.style.setProperty("color",be):ee.style.removeProperty("color")),de!==ue.t&&((ue.t=de)!=null?ne.style.setProperty("color",de):ne.style.removeProperty("color")),ue},{e:void 0,t:void 0}),D})()),null),s(le,(()=>{var H=fe(()=>y.lines.filter(D=>!D.reconciled&&["1001","1002","1003"].includes(D.accountId)).length>0);return()=>H()&&(()=>{var D=l2(),Q=D.firstChild,G=Q.nextSibling;return D.style.setProperty("padding","0.75rem"),D.style.setProperty("background","#ffebee"),D.style.setProperty("border-radius","var(--border-radius-sm)"),D.style.setProperty("margin-top","1rem"),D.style.setProperty("border","1px solid #ffcdd2"),Q.style.setProperty("font-weight","500"),Q.style.setProperty("margin-bottom","0.5rem"),Q.style.setProperty("color","#f44336"),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-muted)"),D})()})(),null),le})()})(),null),re(F=>(F=y.lines.every(le=>le.reconciled)?"#e8f5e8":y.lines.some(le=>le.reconciled)?"#fff3cd":"#ffebee")!=null?U.style.setProperty("background",F):U.style.removeProperty("background")),T})()),(()=>{var T=pm();return u(T,ye),s(T,b(Le,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),s(T,b(Le,{variant:"primary",onClick:C,get children(){return e("journal.editEntry")}}),null),s(T,(()=>{var U=fe(()=>y.status==="draft");return()=>U()&&b(Le,{variant:"outline",onClick:P,disabled:!K,style:{"border-color":"#4caf50",color:K?"#4caf50":"var(--text-muted)"},get children(){return K?e("journal.postEntry","Post Entry"):e("journal.entryNotBalanced","Entry Not Balanced")}})})(),null),s(T,(()=>{var U=fe(()=>y.status==="posted");return()=>U()&&b(Le,{variant:"outline",onClick:E,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return e("journal.voidEntry","Void Entry")}})})(),null),T})()]})()}}),fe(()=>fe(()=>!!a())()&&b(Cg,{get isOpen(){return i()},onClose:()=>{o(!1)},get editEntry(){return a()}}))]};At(["click"]);var u2=z("<div><div><h2></h2><p></p></div><div>"),_n=z("<div>"),d2=z("<div> <!>  <!> "),h2=z("<div><div><label></label></div><div><label></label></div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label></div><div>"),m2=z("<div><span>:</span><span> "),Qs=z("<span>: "),f2=z("<div><br>");const y2=()=>{const{t}=lt(),[e,r]=ge(!1),[n,i]=ge(null),[o,a]=ge(!1),[c,d]=ge(null),[h,m]=ge("all"),[g,_]=ge("all"),[A,M]=ge(""),[L,k]=ge(""),[R,W]=ge("date"),[ie,te]=ge("desc"),ye={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},ae={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)","flex-wrap":"wrap"},$={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem"},S={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(400px, 1fr))",gap:"1.5rem"},p=()=>[{value:"all",label:t("journal.allEntries","All Entries")},{value:"draft",label:t("journal.draft")},{value:"posted",label:t("journal.posted")},{value:"void",label:t("entryBooks.void","Void")}],C=()=>[{value:"all",label:t("accounts.allAccounts","All Accounts")},...bt.accounts.map(I=>({value:I.id,label:`${I.accountNumber} - ${I.name}`}))],P=()=>[{value:"date",label:t("common.date")},{value:"entryNumber",label:t("journal.entryNumber")},{value:"amount",label:t("common.amount")}],E=()=>{let I=An.journalEntries;return h()!=="all"&&(I=I.filter(N=>N.status===h())),g()!=="all"&&(I=I.filter(N=>N.lines.some(Z=>Z.accountId===g()))),A()&&(I=I.filter(N=>N.date>=A())),L()&&(I=I.filter(N=>N.date<=L())),I=[...I].sort((N,Z)=>{let j=0;switch(R()){case"date":j=new Date(N.date).getTime()-new Date(Z.date).getTime();break;case"entryNumber":j=N.entryNumber.localeCompare(Z.entryNumber);break;case"amount":j=N.totalDebit-Z.totalDebit;break}return ie()==="asc"?j:-j}),I},y=()=>{const I=An.journalEntries,N=I.filter(X=>X.status==="draft"),Z=I.filter(X=>X.status==="posted"),j=I.filter(X=>X.status==="void"),J=Z.reduce((X,Y)=>X+Y.totalDebit,0),w=Z.reduce((X,Y)=>X+Y.totalCredit,0),V=I.filter(X=>X.lines.some(Y=>["1001","1002","1003"].includes(Y.accountId)&&!Y.reconciled)).length;return{totalEntries:I.length,draftEntries:N.length,postedEntries:Z.length,voidEntries:j.length,totalDebit:J,totalCredit:w,unreconciledEntries:V}},oe=I=>{d(I.id),a(!0)},K=()=>{i(null),r(!0)},T=()=>{r(!1),i(null)},U=I=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(I),B=y(),x=E();return b(kr,{get title(){return t("entryBooks.title")},get children(){return[(()=>{var I=u2(),N=I.firstChild,Z=N.firstChild,j=Z.nextSibling,J=N.nextSibling;return u(I,ye),Z.style.setProperty("margin","0 0 0.5rem 0"),Z.style.setProperty("font-size","1.5rem"),s(Z,()=>t("journal.title")),j.style.setProperty("margin","0"),j.style.setProperty("color","var(--text-muted)"),s(j,()=>t("entryBooks.subtitle","Manage accounting entries and general ledger records")),J.style.setProperty("display","flex"),J.style.setProperty("gap","1rem"),s(J,b(Le,{variant:"secondary",onClick:()=>window.location.href="/bank-consolidations",get children(){return t("entryBooks.viewReconciliation","View Reconciliation")}}),null),s(J,b(Le,{variant:"primary",onClick:K,get children(){return t("journal.addEntry","Add Journal Entry")}}),null),I})(),(()=>{var I=_n();return u(I,$),s(I,b(tt,{get title(){return t("entryBooks.totalEntries","Total Entries")},get subtitle(){return t("entryBooks.allJournalEntries","All journal entries")},get children(){return[(()=>{var N=_n();return N.style.setProperty("font-size","1.5rem"),N.style.setProperty("font-weight","600"),N.style.setProperty("color","var(--primary-color)"),N.style.setProperty("margin-bottom","0.5rem"),s(N,()=>B.totalEntries),N})(),(()=>{var N=d2(),Z=N.firstChild,j=Z.nextSibling,J=j.nextSibling,w=J.nextSibling;return w.nextSibling,N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),s(N,()=>B.postedEntries,Z),s(N,()=>t("journal.posted").toLowerCase(),j),s(N,()=>B.draftEntries,w),s(N,()=>t("journal.draft").toLowerCase(),null),s(N,(()=>{var V=fe(()=>B.voidEntries>0);return()=>V()&&`  ${B.voidEntries} ${t("entryBooks.void","void").toLowerCase()}`})(),null),N})()]}}),null),s(I,b(tt,{get title(){return t("journal.totalDebits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var N=_n();return N.style.setProperty("font-size","1.5rem"),N.style.setProperty("font-weight","600"),N.style.setProperty("color","#4caf50"),N.style.setProperty("margin-bottom","0.5rem"),s(N,()=>U(B.totalDebit)),N})(),(()=>{var N=_n();return N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),s(N,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",B.postedEntries.toString())),N})()]}}),null),s(I,b(tt,{get title(){return t("journal.totalCredits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var N=_n();return N.style.setProperty("font-size","1.5rem"),N.style.setProperty("font-weight","600"),N.style.setProperty("color","#f44336"),N.style.setProperty("margin-bottom","0.5rem"),s(N,()=>U(B.totalCredit)),N})(),(()=>{var N=_n();return N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),s(N,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",B.postedEntries.toString())),N})()]}}),null),s(I,b(tt,{get title(){return t("banking.unreconciled","Unreconciled")},get subtitle(){return t("banking.title")},get children(){return[(()=>{var N=_n();return N.style.setProperty("font-size","1.5rem"),N.style.setProperty("font-weight","600"),N.style.setProperty("margin-bottom","0.5rem"),s(N,()=>B.unreconciledEntries),re(Z=>(Z=B.unreconciledEntries>0?"#ff9800":"#4caf50")!=null?N.style.setProperty("color",Z):N.style.removeProperty("color")),N})(),(()=>{var N=_n();return N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),s(N,(()=>{var Z=fe(()=>B.unreconciledEntries>0);return()=>Z()?t("entryBooks.needBankReconciliation","Need bank reconciliation"):t("entryBooks.allReconciled","All reconciled")})()),N})()]}}),null),I})(),(()=>{var I=h2(),N=I.firstChild,Z=N.firstChild,j=N.nextSibling,J=j.firstChild,w=j.nextSibling,V=w.firstChild,X=w.nextSibling,Y=X.firstChild,se=Y.nextSibling,O=X.nextSibling,F=O.firstChild,le=F.nextSibling,pe=O.nextSibling,ve=pe.firstChild,ce=pe.nextSibling;return u(I,ae),N.style.setProperty("min-width","150px"),Z.style.setProperty("display","block"),Z.style.setProperty("margin-bottom","0.5rem"),Z.style.setProperty("font-weight","500"),Z.style.setProperty("font-size","0.875rem"),s(Z,()=>t("common.status")),s(N,b(mr,{label:"",get value(){return h()},onChange:m,get options(){return p()}}),null),j.style.setProperty("min-width","200px"),J.style.setProperty("display","block"),J.style.setProperty("margin-bottom","0.5rem"),J.style.setProperty("font-weight","500"),J.style.setProperty("font-size","0.875rem"),s(J,()=>t("journal.account")),s(j,b(mr,{label:"",get value(){return g()},onChange:_,get options(){return C()}}),null),w.style.setProperty("min-width","120px"),V.style.setProperty("display","block"),V.style.setProperty("margin-bottom","0.5rem"),V.style.setProperty("font-weight","500"),V.style.setProperty("font-size","0.875rem"),s(V,()=>t("entryBooks.sortBy","Sort By")),s(w,b(mr,{label:"",get value(){return R()},onChange:W,get options(){return P()}}),null),X.style.setProperty("min-width","130px"),Y.style.setProperty("display","block"),Y.style.setProperty("margin-bottom","0.5rem"),Y.style.setProperty("font-weight","500"),Y.style.setProperty("font-size","0.875rem"),s(Y,()=>t("entryBooks.fromDate","From Date")),se.addEventListener("change",H=>M(H.target.value)),se.style.setProperty("padding","0.75rem"),se.style.setProperty("border","1px solid var(--border-color)"),se.style.setProperty("border-radius","var(--border-radius-sm)"),se.style.setProperty("font-family","inherit"),se.style.setProperty("width","100%"),O.style.setProperty("min-width","130px"),F.style.setProperty("display","block"),F.style.setProperty("margin-bottom","0.5rem"),F.style.setProperty("font-weight","500"),F.style.setProperty("font-size","0.875rem"),s(F,()=>t("entryBooks.toDate","To Date")),le.addEventListener("change",H=>k(H.target.value)),le.style.setProperty("padding","0.75rem"),le.style.setProperty("border","1px solid var(--border-color)"),le.style.setProperty("border-radius","var(--border-radius-sm)"),le.style.setProperty("font-family","inherit"),le.style.setProperty("width","100%"),pe.style.setProperty("min-width","100px"),ve.style.setProperty("display","block"),ve.style.setProperty("margin-bottom","0.5rem"),ve.style.setProperty("font-weight","500"),ve.style.setProperty("font-size","0.875rem"),s(ve,()=>t("entryBooks.order","Order")),s(pe,b(mr,{label:"",get value(){return ie()},onChange:te,get options(){return[{value:"desc",label:t("entryBooks.newest","Newest")},{value:"asc",label:t("entryBooks.oldest","Oldest")}]}}),null),ce.style.setProperty("display","flex"),ce.style.setProperty("align-items","end"),ce.style.setProperty("gap","0.5rem"),s(ce,b(Le,{variant:"outline",size:"sm",onClick:()=>{m("all"),_("all"),M(""),k(""),W("date"),te("desc")},get children(){return t("entryBooks.resetFilters","Reset Filters")}})),re(()=>se.value=A()),re(()=>le.value=L()),I})(),fe(()=>fe(()=>!!(h()!=="all"||g()!=="all"||A()||L()))()&&(()=>{var I=m2(),N=I.firstChild,Z=N.firstChild,j=N.nextSibling,J=j.firstChild;return I.style.setProperty("display","flex"),I.style.setProperty("gap","0.5rem"),I.style.setProperty("align-items","center"),I.style.setProperty("margin-bottom","1rem"),I.style.setProperty("padding","0.75rem"),I.style.setProperty("background","var(--surface-color)"),I.style.setProperty("border-radius","var(--border-radius-sm)"),I.style.setProperty("border","1px solid var(--border-color)"),N.style.setProperty("font-size","0.875rem"),N.style.setProperty("font-weight","500"),s(N,()=>t("entryBooks.activeFilters","Active filters"),Z),s(I,(()=>{var w=fe(()=>h()!=="all");return()=>w()&&(()=>{var V=Qs(),X=V.firstChild;return V.style.setProperty("padding","0.25rem 0.5rem"),V.style.setProperty("background","var(--primary-color)"),V.style.setProperty("color","white"),V.style.setProperty("border-radius","12px"),V.style.setProperty("font-size","0.75rem"),s(V,()=>t("common.status"),X),s(V,h,null),V})()})(),j),s(I,(()=>{var w=fe(()=>g()!=="all");return()=>w()&&(()=>{var V=Qs(),X=V.firstChild;return V.style.setProperty("padding","0.25rem 0.5rem"),V.style.setProperty("background","var(--primary-color)"),V.style.setProperty("color","white"),V.style.setProperty("border-radius","12px"),V.style.setProperty("font-size","0.75rem"),s(V,()=>t("journal.account"),X),s(V,()=>bt.getAccountById(g())?.name||t("common.unknown","Unknown"),null),V})()})(),j),s(I,(()=>{var w=fe(()=>!!A());return()=>w()&&(()=>{var V=Qs(),X=V.firstChild;return V.style.setProperty("padding","0.25rem 0.5rem"),V.style.setProperty("background","var(--primary-color)"),V.style.setProperty("color","white"),V.style.setProperty("border-radius","12px"),V.style.setProperty("font-size","0.75rem"),s(V,()=>t("entryBooks.from","From"),X),s(V,A,null),V})()})(),j),s(I,(()=>{var w=fe(()=>!!L());return()=>w()&&(()=>{var V=Qs(),X=V.firstChild;return V.style.setProperty("padding","0.25rem 0.5rem"),V.style.setProperty("background","var(--primary-color)"),V.style.setProperty("color","white"),V.style.setProperty("border-radius","12px"),V.style.setProperty("font-size","0.75rem"),s(V,()=>t("entryBooks.to","To"),X),s(V,L,null),V})()})(),j),j.style.setProperty("margin-left","auto"),j.style.setProperty("font-size","0.875rem"),j.style.setProperty("color","var(--text-muted)"),s(j,()=>x.length,J),s(j,()=>t("entryBooks.entriesFound","{count} entries found").replace("{count}",x.length.toString()),null),I})()),fe(()=>fe(()=>x.length===0)()?b(tt,{get title(){return t("entryBooks.noJournalEntries","No Journal Entries")},get subtitle(){return t("entryBooks.startByCreating","Start by creating your first entry")},get children(){var I=f2(),N=I.firstChild;return I.style.setProperty("text-align","center"),I.style.setProperty("color","var(--text-muted)"),I.style.setProperty("padding","2rem"),s(I,()=>t("entryBooks.noEntriesMatch","No journal entries match your current filters."),N),s(I,b(Le,{variant:"primary",style:{"margin-top":"1rem"},onClick:K,get children(){return t("entryBooks.createFirstEntry","Create First Entry")}}),null),I}}):(()=>{var I=_n();return u(I,S),s(I,b(pt,{each:x,children:N=>b(Ux,{entry:N,onViewDetails:oe})})),I})()),b(Cg,{get isOpen(){return e()},onClose:T,get editEntry(){return n()}}),b(c2,{get isOpen(){return o()},onClose:()=>{a(!1),d(null)},get entryId(){return c()}})]}})};var vm=z("<div>"),g2=z("<div>$23,450"),p2=z("<div>$87,230"),v2=z("<div>$5,670"),b2=z("<div><div><div><div>INV-2024-001</div><div>Acme Corporation</div></div><div>$5,250.00</div><div></div></div><div><div><div>INV-2024-002</div><div>Tech Solutions Inc.</div></div><div>$3,750.00</div><div></div></div><div><div><div>INV-2024-003</div><div>Global Services Ltd.</div></div><div>$8,900.00</div><div></div></div><div><div><div>INV-2024-004</div><div>StartUp Co.</div></div><div>$2,100.00</div><div>");const _2=()=>{const{t}=lt(),e={display:"flex","flex-direction":"column",gap:"1rem"},r={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},n={flex:"1"},i={"font-weight":"600","margin-bottom":"0.25rem"},o={color:"var(--text-muted)","font-size":"0.875rem"},a={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},c=h=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:h==="paid"?"#d4edda":h==="pending"?"#fff3cd":"#f8d7da",color:h==="paid"?"#155724":h==="pending"?"#856404":"#721c24"}),d={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"};return b(kr,{get title(){return t("invoices.title","Invoices")},get children(){return[(()=>{var h=vm();return h.style.setProperty("margin-bottom","2rem"),s(h,b(Le,{variant:"primary",get children(){return t("invoices.createNew","Create New Invoice")}})),h})(),(()=>{var h=vm();return u(h,d),s(h,b(tt,{get title(){return t("invoices.totalOutstanding","Total Outstanding")},get subtitle(){return t("invoices.unpaidInvoices","Unpaid invoices")},get children(){var m=g2();return m.style.setProperty("font-size","1.5rem"),m.style.setProperty("font-weight","600"),m.style.setProperty("color","var(--primary-color)"),m}}),null),s(h,b(tt,{get title(){return t("invoices.thisMonth","This Month")},get subtitle(){return t("invoices.revenueCollected","Revenue collected")},get children(){var m=p2();return m.style.setProperty("font-size","1.5rem"),m.style.setProperty("font-weight","600"),m.style.setProperty("color","var(--primary-color)"),m}}),null),s(h,b(tt,{get title(){return t("invoices.overdue","Overdue")},get subtitle(){return t("invoices.pastDueInvoices","Past due invoices")},get children(){var m=v2();return m.style.setProperty("font-size","1.5rem"),m.style.setProperty("font-weight","600"),m.style.setProperty("color","var(--primary-color)"),m}}),null),h})(),b(tt,{get title(){return t("invoices.recentInvoices","Recent Invoices")},get subtitle(){return t("invoices.latestBillingActivity","Latest billing activity")},get children(){var h=b2(),m=h.firstChild,g=m.firstChild,_=g.firstChild,A=_.nextSibling,M=g.nextSibling,L=M.nextSibling,k=m.nextSibling,R=k.firstChild,W=R.firstChild,ie=W.nextSibling,te=R.nextSibling,ye=te.nextSibling,ae=k.nextSibling,$=ae.firstChild,S=$.firstChild,p=S.nextSibling,C=$.nextSibling,P=C.nextSibling,E=ae.nextSibling,y=E.firstChild,oe=y.firstChild,K=oe.nextSibling,T=y.nextSibling,U=T.nextSibling;return u(h,e),s(L,()=>t("invoices.paid","Paid")),s(ye,()=>t("invoices.pending","Pending")),s(P,()=>t("invoices.overdue","Overdue")),s(U,()=>t("invoices.paid","Paid")),re(B=>{var x=r,I=n,N=i,Z=o,j=a,J=c("paid"),w=r,V=n,X=i,Y=o,se=a,O=c("pending"),F=r,le=n,pe=i,ve=o,ce=a,H=c("overdue"),D=r,Q=n,G=i,he=o,me=a,ee=c("paid");return B.e=u(m,x,B.e),B.t=u(g,I,B.t),B.a=u(_,N,B.a),B.o=u(A,Z,B.o),B.i=u(M,j,B.i),B.n=u(L,J,B.n),B.s=u(k,w,B.s),B.h=u(R,V,B.h),B.r=u(W,X,B.r),B.d=u(ie,Y,B.d),B.l=u(te,se,B.l),B.u=u(ye,O,B.u),B.c=u(ae,F,B.c),B.w=u($,le,B.w),B.m=u(S,pe,B.m),B.f=u(p,ve,B.f),B.y=u(C,ce,B.y),B.g=u(P,H,B.g),B.p=u(E,D,B.p),B.b=u(y,Q,B.b),B.T=u(oe,G,B.T),B.A=u(K,he,B.A),B.O=u(T,me,B.O),B.I=u(U,ee,B.I),B},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0}),h}})]}})};var bm=z("<div>"),S2=z("<div><div><div><strong>Display Name:</strong> </div><div><strong>UID:</strong> </div></div><div><strong>Created:</strong> "),P2=z("<div><h3>Store Access</h3><div></div><div>No store access granted"),w2=z("<div><h3>Permissions</h3><div>"),C2=z('<div><div><input type=text placeholder="Search users..."></div><div>'),A2=z("<div> You need administrator privileges to access this page."),I2=z("<div>Loading users..."),E2=z("<div><div></div><div></div><div> stores"),x2=z("<div>Select a user to view and edit their profile"),T2=z("<div><input type=checkbox><label>"),$2=z("<div><input type=checkbox><div><div></div><div>");const k2=()=>{const[t,e]=ge([]),[r,n]=ge(null),[i,o]=ge(!1),[a,c]=ge(!1),[d,h]=ge(""),[m,g]=ge(null),_=[{id:"YY_8802",name:"Store 8802"},{id:"YY_8803",name:"Store 8803"},{id:"YY_8804",name:"Store 8804"},{id:"YY_8805",name:"Store 8805"},{id:"YY_8816",name:"Store 8816"},{id:"YY_8818",name:"Store 8818"},{id:"YY_8847",name:"Store 8847"},{id:"YY_3251",name:"Store 3251"},{id:"YY_32",name:"Store 32"},{id:"YY_76",name:"Store 76"},{id:"YY_79",name:"Store 79"},{id:"YY_8635",name:"Store 8635"},{id:"YY_8665",name:"Store 8665"},{id:"YY_8901",name:"Store 8901"}],A=[{key:"AccountAccess",label:"Account Access",description:"Access to accounting features"},{key:"BankingAccess",label:"Banking Access",description:"Access to banking operations"},{key:"InventoryAccess",label:"Inventory Access",description:"Access to inventory management"},{key:"JournalAccess",label:"Journal Access",description:"Access to journal entries"},{key:"inventoryDownsection",label:"Inventory Downsection",description:"Access to inventory downsection"},{key:"onlyRead",label:"Read Only",description:"Limited to read-only access"},{key:"read_write",label:"Read/Write",description:"Full read and write permissions"},{key:"isAdmin",label:"Administrator",description:"Full system administration rights"}];let M={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,invoiceAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};qr(async()=>{await L()});const L=async()=>{try{o(!0);const y=FP(Sc,"users"),oe=ZP(y,ew("createdAt","desc")),K=await ow(oe),T=[];K.forEach(U=>{let B=U.data();Object.keys(M).map(x=>{let I=M?.[x];B.hasOwnProperty(x)||(B[x]=I)}),T.push({uid:U.id,...B})}),e(T)}catch(y){console.error("Error loading users:",y),g({type:"error",text:"Failed to load users"})}finally{o(!1)}},k=We(()=>{const y=d().toLowerCase();return y?t().filter(oe=>oe.email?.toLowerCase().includes(y)||oe.displayName?.toLowerCase().includes(y)||oe.uid?.toLowerCase().includes(y)):t()}),R=y=>{r()&&n(oe=>({...oe,stores:{...oe.stores,[y]:!oe.stores[y]}}))},W=y=>{r()&&n(oe=>({...oe,[y]:!oe[y]}))};We(()=>r()?r().stores&&Object.values(r().stores).some(y=>y):!1);const ie=async()=>{if(r())try{c(!0),g(null);const y=lg(Sc,"users",r().uid);let oe={stores:r().stores,AccountAccess:r().AccountAccess,BankingAccess:r().BankingAccess,InventoryAccess:r().InventoryAccess,JournalAccess:r().JournalAccess,inventoryDownsection:r().inventoryDownsection,onlyRead:r().onlyRead,read_write:r().read_write,isAdmin:r().isAdmin||!1};await vg(y,oe),e(K=>K.map(T=>T.uid===r().uid?r():T)),g({type:"success",text:"User profile updated successfully"})}catch(y){console.error("Error saving user profile:",y),g({type:"error",text:"Failed to save user profile"})}finally{c(!1)}},te={display:"grid","grid-template-columns":"350px 1fr",gap:"2rem",height:"calc(100vh - 200px)"},ye={"max-height":"100%","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)",background:"var(--surface-color)"},ae=y=>({padding:"1rem","border-bottom":"1px solid var(--border-color)",cursor:"pointer",background:y?"var(--primary-color-light)":"transparent",transition:"background 0.2s"}),$={padding:"0.75rem",border:"none","border-bottom":"1px solid var(--border-color)",background:"var(--surface-color)",width:"100%","font-size":"1rem"},S={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem"},p={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.75rem"},C={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",transition:"all 0.2s"},P=y=>({padding:"1rem","margin-bottom":"1rem","border-radius":"var(--border-radius)",background:y==="success"?"#d4edda":"#f8d7da",color:y==="success"?"#155724":"#721c24",border:`1px solid ${y==="success"?"#c3e6cb":"#f5c6cb"}`}),E=We(()=>vt.state.profile?.isAdmin===!0);return b(kr,{title:"User Profile Administration",get children(){return b(Ne,{get when(){return E()},get fallback(){return b(tt,{get children(){var y=A2();return y.style.setProperty("text-align","center"),y.style.setProperty("padding","2rem"),y.style.setProperty("color","var(--text-muted)"),y}})},get children(){var y=C2(),oe=y.firstChild,K=oe.firstChild,T=oe.nextSibling;return u(y,te),u(oe,ye),K.$$input=U=>h(U.currentTarget.value),u(K,$),s(oe,b(Ne,{get when(){return!i()},get fallback(){return(()=>{var U=I2();return U.style.setProperty("padding","2rem"),U.style.setProperty("text-align","center"),U})()},get children(){return b(pt,{get each(){return k()},children:U=>(()=>{var B=E2(),x=B.firstChild,I=x.nextSibling,N=I.nextSibling,Z=N.firstChild;return B.$$click=()=>n(U),x.style.setProperty("font-weight","600"),s(x,()=>U.displayName||"No Name"),I.style.setProperty("font-size","0.875rem"),I.style.setProperty("color","var(--text-muted)"),s(I,()=>U.email),N.style.setProperty("font-size","0.75rem"),N.style.setProperty("color","var(--text-muted)"),N.style.setProperty("margin-top","0.25rem"),s(N,()=>U.isAdmin&&" Admin  ",Z),s(N,()=>Object.values(U.stores||{}).filter(Boolean).length,Z),re(j=>u(B,ae(r()?.uid===U.uid),j)),B})()})}}),null),s(T,b(Ne,{get when(){return r()},get fallback(){return b(tt,{get children(){var U=x2();return U.style.setProperty("text-align","center"),U.style.setProperty("padding","2rem"),U.style.setProperty("color","var(--text-muted)"),U}})},get children(){return[b(Ne,{get when(){return m()},get children(){var U=bm();return s(U,()=>m().text),re(B=>u(U,P(m().type),B)),U}}),b(tt,{title:"User Information",get subtitle(){return r().email},get children(){return[(()=>{var U=S2(),B=U.firstChild,x=B.firstChild,I=x.firstChild;I.nextSibling;var N=x.nextSibling,Z=N.firstChild;Z.nextSibling;var j=B.nextSibling,J=j.firstChild;return J.nextSibling,U.style.setProperty("margin-bottom","2rem"),B.style.setProperty("display","flex"),B.style.setProperty("justify-content","space-between"),B.style.setProperty("margin-bottom","1rem"),s(x,()=>r().displayName||"Not set",null),s(N,()=>r().uid,null),s(j,()=>new Date(r().createdAt?.toDate?.()||r().createdAt).toLocaleDateString(),null),U})(),(()=>{var U=P2(),B=U.firstChild,x=B.nextSibling,I=x.nextSibling;return U.style.setProperty("margin-bottom","2rem"),B.style.setProperty("margin-bottom","1rem"),u(x,p),s(x,b(pt,{each:_,children:N=>{let Z=De.getLocationById(N?.id);return(()=>{var j=T2(),J=j.firstChild,w=J.nextSibling;return j.$$click=()=>R(N?.id),J.style.setProperty("cursor","pointer"),w.style.setProperty("cursor","pointer"),w.style.setProperty("user-select","none"),s(w,()=>Z?.name),re(V=>u(j,{...C,background:r().stores?.[N?.id]?"var(--primary-color-light)":"transparent"},V)),re(()=>J.checked=r().stores?.[N?.id]||!1),j})()}})),I.style.setProperty("margin-top","0.5rem"),I.style.setProperty("font-size","0.875rem"),I.style.setProperty("color","var(--text-muted)"),U})(),(()=>{var U=w2(),B=U.firstChild,x=B.nextSibling;return U.style.setProperty("margin-bottom","2rem"),B.style.setProperty("margin-bottom","1rem"),u(x,S),s(x,b(pt,{each:A,children:I=>(()=>{var N=$2(),Z=N.firstChild,j=Z.nextSibling,J=j.firstChild,w=J.nextSibling;return N.$$click=()=>W(I.key),Z.style.setProperty("cursor","pointer"),j.style.setProperty("flex","1"),j.style.setProperty("cursor","pointer"),j.style.setProperty("user-select","none"),J.style.setProperty("font-weight","500"),s(J,()=>I.label),w.style.setProperty("font-size","0.75rem"),w.style.setProperty("color","var(--text-muted)"),s(w,()=>I.description),re(V=>u(N,{...C,background:r()[I.key]?"var(--primary-color-light)":"transparent"},V)),re(()=>Z.checked=!!r()[I.key]),N})()})),U})(),(()=>{var U=bm();return U.style.setProperty("display","flex"),U.style.setProperty("gap","1rem"),U.style.setProperty("justify-content","flex-end"),s(U,b(Le,{variant:"secondary",onClick:()=>n(null),children:"Cancel"}),null),s(U,b(Le,{variant:"primary",onClick:ie,get disabled(){return a()},get children(){return a()?"Saving...":"Save Changes"}}),null),U})()]}})]}})),re(()=>K.value=d()),y}})}})};At(["input","click"]);var R2=z("<div><main>");const D2=t=>[b(Ww,{}),fe(()=>t.children)],N2=()=>b(Cw,{get children(){var t=R2(),e=t.firstChild;return s(e,b(Hp,{root:D2,get children(){return[b(Wr,{path:"/",component:QI}),b(Wr,{path:"/accounts",component:()=>b(tn,{permission:"AccountAccess",featureName:"Accounts",get children(){return b(OE,{})}})}),b(Wr,{path:"/accounts/:id",component:()=>b(tn,{permission:"AccountAccess",featureName:"Account Details",get children(){return b(qE,{})}})}),b(Wr,{path:"/entry-books",component:()=>b(tn,{permission:"JournalAccess",featureName:"Entry Books",get children(){return b(y2,{})}})}),b(Wr,{path:"/employees",component:()=>b(tn,{permission:"EmployeeAccess",featureName:"Employee Management",get children(){return b(ox,{})}})}),b(Wr,{path:"/bank-consolidations",component:()=>b(tn,{permission:"BankingAccess",featureName:"Bank Consolidations",get children(){return b(Dx,{})}})}),b(Wr,{path:"/balance-sheet",component:()=>b(tn,{permission:"AccountAccess",featureName:"Balance Sheet",get children(){return b(QE,{})}})}),b(Wr,{path:"/invoices",component:()=>b(tn,{permission:"JournalAccess",featureName:"Invoices",get children(){return b(_2,{})}})}),b(Wr,{path:"/inventory",component:()=>b(tn,{permission:"InventoryAccess",featureName:"Inventory Management",get children(){return b(NI,{})}})}),b(Wr,{path:"/products",component:()=>b(tn,{permission:"InventoryAccess",featureName:"Product Management",get children(){return b(Pg,{})}})}),b(Wr,{path:"/admin/users",component:()=>b(tn,{permission:"isAdmin",featureName:"User Administration",get children(){return b(k2,{})}})})]}})),s(t,(()=>{var r=fe(()=>!1);return()=>r()&&b(sC,{})})(),null),t}}),L2=document.getElementById("root");ap(()=>b(N2,{}),L2);
